{"version":3,"file":"CalculatorDialog-Z7R2w5Q2.js","sources":["../../src/components/CalculatorDialog.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Calculator, X } from 'lucide-react';\r\n\r\ninterface CalculatorDialogProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nexport function CalculatorDialog({ isOpen, onClose }: CalculatorDialogProps) {\r\n  const [display, setDisplay] = useState('0');\r\n  const [previousValue, setPreviousValue] = useState<number | null>(null);\r\n  const [operation, setOperation] = useState<string | null>(null);\r\n  const [waitingForOperand, setWaitingForOperand] = useState(false);\r\n\r\n  const inputNumber = (num: string) => {\r\n    if (waitingForOperand) {\r\n      setDisplay(num);\r\n      setWaitingForOperand(false);\r\n    } else {\r\n      setDisplay(display === '0' ? num : display + num);\r\n    }\r\n  };\r\n\r\n  const inputOperation = (nextOperation: string) => {\r\n    const inputValue = parseFloat(display);\r\n\r\n    if (previousValue === null) {\r\n      setPreviousValue(inputValue);\r\n    } else if (operation) {\r\n      const currentValue = previousValue || 0;\r\n      const newValue = calculate(currentValue, inputValue, operation);\r\n\r\n      setDisplay(String(newValue));\r\n      setPreviousValue(newValue);\r\n    }\r\n\r\n    setWaitingForOperand(true);\r\n    setOperation(nextOperation);\r\n  };\r\n\r\n  const calculate = (firstValue: number, secondValue: number, operation: string): number => {\r\n    switch (operation) {\r\n      case '+':\r\n        return firstValue + secondValue;\r\n      case '-':\r\n        return firstValue - secondValue;\r\n      case '×':\r\n        return firstValue * secondValue;\r\n      case '÷':\r\n        if (secondValue === 0) {\r\n          return 0; // أو يمكن إرجاع Infinity أو عرض رسالة خطأ\r\n        }\r\n        return firstValue / secondValue;\r\n      case '=':\r\n        return secondValue;\r\n      default:\r\n        return secondValue;\r\n    }\r\n  };\r\n\r\n  const performCalculation = () => {\r\n    const inputValue = parseFloat(display);\r\n\r\n    if (previousValue !== null && operation) {\r\n      const newValue = calculate(previousValue, inputValue, operation);\r\n      setDisplay(String(newValue));\r\n      setPreviousValue(null);\r\n      setOperation(null);\r\n      setWaitingForOperand(true);\r\n    }\r\n  };\r\n\r\n  const clearAll = () => {\r\n    setDisplay('0');\r\n    setPreviousValue(null);\r\n    setOperation(null);\r\n    setWaitingForOperand(false);\r\n  };\r\n\r\n  const clearEntry = () => {\r\n    setDisplay('0');\r\n  };\r\n\r\n  const inputDecimal = () => {\r\n    if (waitingForOperand) {\r\n      setDisplay('0.');\r\n      setWaitingForOperand(false);\r\n    } else if (display.indexOf('.') === -1) {\r\n      setDisplay(display + '.');\r\n    }\r\n  };\r\n\r\n  const toggleSign = () => {\r\n    if (display !== '0') {\r\n      setDisplay(display.charAt(0) === '-' ? display.slice(1) : '-' + display);\r\n    }\r\n  };\r\n\r\n  const percentage = () => {\r\n    const value = parseFloat(display);\r\n    setDisplay(String(value / 100));\r\n  };\r\n\r\n  // دالة معالجة الكيبورد\r\n  const handleKeyPress = (event: KeyboardEvent) => {\r\n    const key = event.key;\r\n    \r\n    // منع السلوك الافتراضي للمفاتيح\r\n    event.preventDefault();\r\n    \r\n    // الأرقام 0-9\r\n    if (key >= '0' && key <= '9') {\r\n      inputNumber(key);\r\n    }\r\n    // العمليات الحسابية\r\n    else if (key === '+') {\r\n      inputOperation('+');\r\n    }\r\n    else if (key === '-') {\r\n      inputOperation('-');\r\n    }\r\n    else if (key === '*') {\r\n      inputOperation('×');\r\n    }\r\n    else if (key === '/') {\r\n      inputOperation('÷');\r\n    }\r\n    // مفاتيح أخرى\r\n    else if (key === 'Enter' || key === '=') {\r\n      performCalculation();\r\n    }\r\n    else if (key === 'Escape' || key === 'c' || key === 'C') {\r\n      clearAll();\r\n    }\r\n    else if (key === 'Backspace') {\r\n      clearEntry();\r\n    }\r\n    else if (key === '.') {\r\n      inputDecimal();\r\n    }\r\n    else if (key === '%') {\r\n      percentage();\r\n    }\r\n  };\r\n\r\n  // إضافة وإزالة event listener عند فتح/إغلاق الآلة الحاسبة\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      document.addEventListener('keydown', handleKeyPress);\r\n    } else {\r\n      document.removeEventListener('keydown', handleKeyPress);\r\n    }\r\n\r\n    // تنظيف عند إلغاء المكون\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyPress);\r\n    };\r\n  }, [isOpen, display, previousValue, operation, waitingForOperand]);\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\r\n      <DialogContent className=\"sm:max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2 text-right\">\r\n            <Calculator className=\"h-5 w-5\" />\r\n            آلة حاسبة\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n        \r\n        <div className=\"space-y-4\">\r\n          {/* شاشة العرض */}\r\n          <div className=\"bg-gray-900 text-white p-4 rounded-lg text-right\">\r\n            <div className=\"text-3xl font-mono font-bold min-h-[3rem] flex items-center justify-end overflow-hidden\">\r\n              {display}\r\n            </div>\r\n          </div>\r\n\r\n          {/* أزرار الآلة الحاسبة */}\r\n          <div className=\"grid grid-cols-4 gap-2\">\r\n            {/* الصف الأول */}\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-sm font-semibold bg-gray-100 hover:bg-gray-200\"\r\n              onClick={clearAll}\r\n            >\r\n              AC\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-sm font-semibold bg-gray-100 hover:bg-gray-200\"\r\n              onClick={clearEntry}\r\n            >\r\n              CE\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-sm font-semibold bg-gray-100 hover:bg-gray-200\"\r\n              onClick={percentage}\r\n            >\r\n              %\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-sm font-semibold bg-orange-500 text-white hover:bg-orange-600\"\r\n              onClick={() => inputOperation('÷')}\r\n            >\r\n              ÷\r\n            </Button>\r\n\r\n            {/* الصف الثاني */}\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-lg font-semibold bg-white hover:bg-gray-50\"\r\n              onClick={() => inputNumber('7')}\r\n            >\r\n              7\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-lg font-semibold bg-white hover:bg-gray-50\"\r\n              onClick={() => inputNumber('8')}\r\n            >\r\n              8\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-lg font-semibold bg-white hover:bg-gray-50\"\r\n              onClick={() => inputNumber('9')}\r\n            >\r\n              9\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-sm font-semibold bg-orange-500 text-white hover:bg-orange-600\"\r\n              onClick={() => inputOperation('×')}\r\n            >\r\n              ×\r\n            </Button>\r\n\r\n            {/* الصف الثالث */}\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-lg font-semibold bg-white hover:bg-gray-50\"\r\n              onClick={() => inputNumber('4')}\r\n            >\r\n              4\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-lg font-semibold bg-white hover:bg-gray-50\"\r\n              onClick={() => inputNumber('5')}\r\n            >\r\n              5\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-lg font-semibold bg-white hover:bg-gray-50\"\r\n              onClick={() => inputNumber('6')}\r\n            >\r\n              6\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-sm font-semibold bg-orange-500 text-white hover:bg-orange-600\"\r\n              onClick={() => inputOperation('-')}\r\n            >\r\n              -\r\n            </Button>\r\n\r\n            {/* الصف الرابع */}\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-lg font-semibold bg-white hover:bg-gray-50\"\r\n              onClick={() => inputNumber('1')}\r\n            >\r\n              1\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-lg font-semibold bg-white hover:bg-gray-50\"\r\n              onClick={() => inputNumber('2')}\r\n            >\r\n              2\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-lg font-semibold bg-white hover:bg-gray-50\"\r\n              onClick={() => inputNumber('3')}\r\n            >\r\n              3\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-sm font-semibold bg-orange-500 text-white hover:bg-orange-600\"\r\n              onClick={() => inputOperation('+')}\r\n            >\r\n              +\r\n            </Button>\r\n\r\n            {/* الصف الخامس */}\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-lg font-semibold bg-white hover:bg-gray-50 col-span-2\"\r\n              onClick={() => inputNumber('0')}\r\n            >\r\n              0\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-lg font-semibold bg-white hover:bg-gray-50\"\r\n              onClick={inputDecimal}\r\n            >\r\n              .\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-12 text-sm font-semibold bg-orange-500 text-white hover:bg-orange-600\"\r\n              onClick={performCalculation}\r\n            >\r\n              =\r\n            </Button>\r\n          </div>\r\n\r\n          {/* زر إضافي لتغيير الإشارة */}\r\n          <Button\r\n            variant=\"outline\"\r\n            className=\"w-full h-10 text-sm font-semibold bg-gray-100 hover:bg-gray-200\"\r\n            onClick={toggleSign}\r\n          >\r\n            +/-\r\n          </Button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default CalculatorDialog;"],"names":["CalculatorDialog","isOpen","onClose","display","setDisplay","useState","previousValue","setPreviousValue","operation","setOperation","waitingForOperand","setWaitingForOperand","inputNumber","num","inputOperation","nextOperation","inputValue","newValue","calculate","firstValue","secondValue","performCalculation","clearAll","clearEntry","inputDecimal","toggleSign","percentage","value","handleKeyPress","event","key","useEffect","jsx","Dialog","open","jsxs","DialogContent","DialogHeader","DialogTitle","Calculator","Button"],"mappings":"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"}