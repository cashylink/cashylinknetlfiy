import{b as re,W as ne,C as Ue,S as n,w as Ae,d as oe,ab as Oe,bC as Fe,I as e,a as C,O as Re,a5 as $e,Q as Me,aI as le,aJ as ie,aK as ce,aL as de,aR as X,aM as We,t as H,P as T,m as q,aZ as De,aO as Ge,aQ as B,bD as Ve,bE as J,bF as He,bG as Te,bH as qe}from"./index-BsVRzvOf.js";import{f as ze,m as Qe,n as Ke,a as Je,s as z,t as W,l as Xe}from"./dropdown-menu-MkPhHRIa-C3szlXVH.js";import{u as Q}from"./label-_mnIMROJ-DudSd8Mh.js";import{E as Be}from"./MasterPinDialog-CDin1iyv-BfIYYvfI.js";import{X as Ye}from"./switch-CNGODERG-eTw8K7Ad.js";import{c as Ze}from"./shield-DSoskD-c-BzN5L-qY.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=re("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
* @license lucide-react v0.462.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const es=re("CloudDownload",[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]]);var ue={exports:{}},me={};/**
* @license React
* use-sync-external-store-shim.production.js
*
* Copyright (c) Meta Platforms, Inc. and affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var A=n;function ss(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var ts=typeof Object.is=="function"?Object.is:ss,as=A.useState,rs=A.useEffect,ns=A.useLayoutEffect,os=A.useDebugValue;function ls(r,s){var t=s(),d=as({inst:{value:t,getSnapshot:s}}),o=d[0].inst,c=d[1];return ns(function(){o.value=t,o.getSnapshot=s,K(o)&&c({inst:o})},[r,t,s]),rs(function(){return K(o)&&c({inst:o}),r(function(){K(o)&&c({inst:o})})},[r]),os(t),t}function K(r){var s=r.getSnapshot;r=r.value;try{var t=s();return!ts(r,t)}catch{return!0}}function is(r,s){return s()}var cs=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?is:ls;me.useSyncExternalStore=A.useSyncExternalStore!==void 0?A.useSyncExternalStore:cs;ue.exports=me;var ds=ue.exports;function us(){return ds.useSyncExternalStore(ms,()=>!0,()=>!1)}function ms(){return()=>{}}var Y="Avatar",[fs]=Ge(Y),[hs,fe]=fs(Y),he=n.forwardRef((r,s)=>{const{__scopeAvatar:t,...d}=r,[o,c]=n.useState("idle");return e.jsx(hs,{scope:t,imageLoadingStatus:o,onImageLoadingStatusChange:c,children:e.jsx(B.span,{...d,ref:s})})});he.displayName=Y;var pe="AvatarImage",we=n.forwardRef((r,s)=>{const{__scopeAvatar:t,src:d,onLoadingStatusChange:o=()=>{},...c}=r,b=fe(pe,t),y=ps(d,c),x=Ve(m=>{o(m),b.onImageLoadingStatusChange(m)});return J(()=>{y!=="idle"&&x(y)},[y,x]),y==="loaded"?e.jsx(B.img,{...c,ref:s,src:d}):null});we.displayName=pe;var xe="AvatarFallback",ve=n.forwardRef((r,s)=>{const{__scopeAvatar:t,delayMs:d,...o}=r,c=fe(xe,t),[b,y]=n.useState(d===void 0);return n.useEffect(()=>{if(d!==void 0){const x=window.setTimeout(()=>y(!0),d);return()=>window.clearTimeout(x)}},[d]),b&&c.imageLoadingStatus!=="loaded"?e.jsx(B.span,{...o,ref:s}):null});ve.displayName=xe;function ae(r,s){return r?s?(r.src!==s&&(r.src=s),r.complete&&r.naturalWidth>0?"loaded":"loading"):"error":"idle"}function ps(r,{referrerPolicy:s,crossOrigin:t}){const d=us(),o=n.useRef(null),c=d?(o.current||(o.current=new window.Image),o.current):null,[b,y]=n.useState(()=>ae(c,r));return J(()=>{y(ae(c,r))},[c,r]),J(()=>{const x=F=>()=>{y(F)};if(!c)return;const m=x("loaded"),E=x("error");return c.addEventListener("load",m),c.addEventListener("error",E),s&&(c.referrerPolicy=s),typeof t=="string"&&(c.crossOrigin=t),()=>{c.removeEventListener("load",m),c.removeEventListener("error",E)}},[c,t,s]),b}var ge=he,ye=we,je=ve;const Ne=n.forwardRef(({className:r,...s},t)=>e.jsx(ge,{ref:t,className:X("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...s}));Ne.displayName=ge.displayName;const be=n.forwardRef(({className:r,...s},t)=>e.jsx(ye,{ref:t,className:X("aspect-square h-full w-full",r),...s}));be.displayName=ye.displayName;const Se=n.forwardRef(({className:r,...s},t)=>e.jsx(je,{ref:t,className:X("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...s}));Se.displayName=je.displayName;function ws({open:r,onOpenChange:s}){const{user:t}=ne(),{toast:d}=oe(),[o,c]=n.useState(!1),[b,y]=n.useState(!1),[x,m]=n.useState(!1),[E,F]=n.useState(!1),[Z,L]=n.useState(!1),[ee,_]=n.useState(!1),[j,R]=n.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[i,w]=n.useState({currentPassword:"",newPassword:"",confirmPassword:""}),O=()=>{const u={currentPassword:"",newPassword:"",confirmPassword:""};return j.currentPassword||(u.currentPassword="كلمة المرور الحالية مطلوبة"),j.newPassword?j.newPassword.length<6&&(u.newPassword="كلمة المرور يجب أن تكون 6 أحرف على الأقل"):u.newPassword="كلمة المرور الجديدة مطلوبة",j.confirmPassword?j.newPassword!==j.confirmPassword&&(u.confirmPassword="كلمات المرور غير متطابقة"):u.confirmPassword="تأكيد كلمة المرور مطلوب",w(u),!Object.values(u).some(h=>h!=="")},N=async u=>{if(u.preventDefault(),!(!O()||!t||!t.email)){c(!0);try{const h=He.credential(t.email,j.currentPassword);await Te(t,h),_(!0),L(!0),d({title:"تأكيد الهوية",description:"أدخل الرقم السري الرئيسي لتأكيد تغيير كلمة المرور"})}catch(h){console.error("خطأ في تغيير كلمة المرور:",h);let P="حدث خطأ أثناء تغيير كلمة المرور";if(h.code==="auth/wrong-password"){w(k=>({...k,currentPassword:"كلمة المرور الحالية غير صحيحة"}));return}else if(h.code==="auth/weak-password"){w(k=>({...k,newPassword:"كلمة المرور ضعيفة جداً"}));return}else h.code==="auth/requires-recent-login"&&(P="يجب تسجيل الدخول مرة أخرى لتغيير كلمة المرور");d({title:"خطأ في تغيير كلمة المرور",description:P,variant:"destructive"})}finally{c(!1)}}},D=async()=>{if(t){c(!0);try{await qe(t,j.newPassword),d({title:"تم تغيير كلمة المرور بنجاح",description:"تم تحديث كلمة المرور الخاصة بك بنجاح"}),R({currentPassword:"",newPassword:"",confirmPassword:""}),w({currentPassword:"",newPassword:"",confirmPassword:""}),L(!1),_(!1),s(!1)}catch(u){console.error("خطأ في تحديث كلمة المرور:",u);let h="حدث خطأ أثناء تغيير كلمة المرور";u.code==="auth/requires-recent-login"&&(h="انتهت جلسة المصادقة. يرجى إعادة إدخال كلمة المرور الحالية"),d({title:"خطأ في تغيير كلمة المرور",description:h,variant:"destructive"})}finally{c(!1)}}},S=u=>h=>{R(P=>({...P,[u]:h.target.value})),i[u]&&w(P=>({...P,[u]:""}))},v=()=>{R({currentPassword:"",newPassword:"",confirmPassword:""}),w({currentPassword:"",newPassword:"",confirmPassword:""}),L(!1),_(!1),s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(le,{open:r,onOpenChange:v,children:e.jsxs(ie,{className:"sm:max-w-[425px]",children:[e.jsxs(ce,{children:[e.jsx(de,{children:"تغيير كلمة المرور"}),e.jsx(We,{children:"أدخل كلمة المرور الحالية وكلمة المرور الجديدة لتحديث حسابك"})]}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"currentPassword",children:"كلمة المرور الحالية"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{id:"currentPassword",type:b?"text":"password",value:j.currentPassword,onChange:S("currentPassword"),className:i.currentPassword?"border-red-500":"",autoComplete:"off",disabled:o}),e.jsx(C,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>y(!b),disabled:o,children:b?e.jsx(T,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"})})]}),i.currentPassword&&e.jsx("p",{className:"text-sm text-red-500",children:i.currentPassword})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"newPassword",children:"كلمة المرور الجديدة"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{id:"newPassword",type:x?"text":"password",value:j.newPassword,onChange:S("newPassword"),className:i.newPassword?"border-red-500":"",autoComplete:"new-password",disabled:o}),e.jsx(C,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>m(!x),disabled:o,children:x?e.jsx(T,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"})})]}),i.newPassword&&e.jsx("p",{className:"text-sm text-red-500",children:i.newPassword})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"confirmPassword",children:"تأكيد كلمة المرور الجديدة"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{id:"confirmPassword",type:E?"text":"password",value:j.confirmPassword,onChange:S("confirmPassword"),className:i.confirmPassword?"border-red-500":"",autoComplete:"new-password",disabled:o}),e.jsx(C,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>F(!E),disabled:o,children:E?e.jsx(T,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"})})]}),i.confirmPassword&&e.jsx("p",{className:"text-sm text-red-500",children:i.confirmPassword})]}),e.jsxs(De,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:v,disabled:o,children:"إلغاء"}),e.jsxs(C,{type:"submit",disabled:o,children:[o&&e.jsx(Xe,{className:"mr-2 h-4 w-4 animate-spin"}),"تغيير كلمة المرور"]})]})]})]})}),e.jsx(Be,{open:Z&&ee,onOpenChange:u=>{L(u),u||_(!1)},mode:"verify",title:"التحقق من الرقم السري الرئيسي",description:"لا يمكن تغيير كلمة المرور إلا بعد التحقق من الرقم السري الرئيسي",onSuccess:D,onCancel:()=>{L(!1),_(!1)}})]})}const xs="cashy.google.accessToken",vs="cashy.google.email",gs="cashy.google.expiresAt";function ys(){try{const r=localStorage.getItem(xs),s=localStorage.getItem(vs),t=localStorage.getItem(gs),d=t?Number(t):null;return{token:r,email:s,expiresAt:d}}catch{return{token:null,email:null,expiresAt:null}}}async function js(r,s,t){try{const d=await fetch("/user/google-backup-token",{method:"POST",headers:{"Content-Type":"application/json","X-USER-ID":r},body:JSON.stringify({email:s,refresh_token:t})}),o=await d.json().catch(()=>({}));return!!(d.ok&&o!=null&&o.ok)}catch{return!1}}function _s({className:r}){const{user:s,profile:t,signOut:d,updateUserProfile:o}=ne(),c=Ue(),[b,y]=n.useState(!1),{isShiftActive:x}=Ae(),{toast:m}=oe(),[E,F]=n.useState(!1),[Z,L]=n.useState(!1),[ee,_]=n.useState(!1),[{token:j},R]=n.useState(()=>ys()),i=typeof window<"u"?window.electronAPI:void 0,w=!!i,[O,N]=n.useState(!1),[D,S]=n.useState(!1),[v,u]=n.useState(""),[h,P]=n.useState(""),[k,G]=n.useState(0),[V,$]=n.useState(!1),[Pe,ke]=n.useState(""),[I,Ce]=n.useState(""),[Ns,bs]=n.useState(!1),U=(a,l)=>{const f=String(a||"").split(".").map(g=>parseInt(g,10)||0),p=String(l||"").split(".").map(g=>parseInt(g,10)||0);for(let g=0;g<Math.max(f.length,p.length);g++){const M=f[g]||0,te=p[g]||0;if(M>te)return 1;if(M<te)return-1}return 0};n.useEffect(()=>{if(!(!w||!i))try{i.onUpdateAvailable(a=>{var l,f;const p=String(((l=a==null?void 0:a.info)==null?void 0:l.version)||"");u(p),P(String(((f=a==null?void 0:a.info)==null?void 0:f.notes)||"")),U(p,I)>0?N(!0):N(!1)}),i.onUpdateDownloaded(a=>{var l,f;const p=String(((l=a==null?void 0:a.info)==null?void 0:l.version)||"");u(p),P(String(((f=a==null?void 0:a.info)==null?void 0:f.notes)||"")),$(!1),G(100),U(p,I)>0?N(!0):N(!1);try{w&&s!=null&&s.uid&&p&&(o==null||o({lastAckDesktopVersion:p}))}catch{}}),i.onUpdateError(a=>{try{m({title:"فشل التحديث",description:String((a==null?void 0:a.message)||(a==null?void 0:a.code)||"تعذر التحميل"),variant:"destructive"})}catch{}}),typeof i.onUpdateProgress=="function"&&i.onUpdateProgress(a=>{const l=(a==null?void 0:a.percent)==null?0:Number(a.percent);$(!0),G(Math.max(0,Math.min(100,isNaN(l)?0:l)))}),typeof i.appVersion=="function"&&i.appVersion().then(a=>{typeof a=="string"&&Ce(a);try{w&&s!=null&&s.uid&&typeof a=="string"&&a&&(o==null||o({desktopInstalledVersion:a}))}catch{}}).catch(()=>{})}catch{}},[w,i]),n.useEffect(()=>{w&&k>=100&&S(!0)},[w,k]),n.useEffect(()=>{const a=Oe(l=>{const f=String((l==null?void 0:l.version)||""),p=`desktop_update_seen_${String((s==null?void 0:s.uid)||"anon")}`;let g="";try{g=localStorage.getItem(p)||""}catch{}if(f&&f!==v){if(U(f,I)>0)if(g===f)N(!1),S(!1);else{N(!0),S(!0);try{localStorage.setItem(p,f)}catch{}}else N(!1);u(f),P(String((l==null?void 0:l.notes)||""));const M=Fe({downloadURL_64:l==null?void 0:l.downloadURL_64,downloadURL_32:l==null?void 0:l.downloadURL_32})||"";ke(M)}});return()=>{try{a()}catch{}}},[v,I,s==null?void 0:s.uid]);const Ie=async()=>{var a;try{if(i){try{await i.checkUpdate()}catch{}S(!0),$(!0),G(0);const l=await((a=i.downloadUpdate)==null?void 0:a.call(i,Pe))??await i.downloadUpdate();if(typeof l=="string"&&l.startsWith("err:")){try{m({title:"فشل التحديث",description:l.slice(4),variant:"destructive"})}catch{}$(!1)}else if(l==="noop")try{m({title:"لا يوجد تحديث",description:"لا تتوفر نسخة أحدث حالياً."})}catch{}else if(l==="manual")try{m({title:"جارٍ تنزيل التحديث",description:"سيتم تطبيق التحديث تلقائيًا بعد اكتمال التنزيل."})}catch{}else if(l==="autoUpdater")try{m({title:"تنزيل تلقائي",description:"سيتم تطبيق التحديث تلقائياً بواسطة النظام."})}catch{}}}catch(l){try{m({title:"فشل التحديث",description:(l==null?void 0:l.message)||"حدث خطأ أثناء التنزيل",variant:"destructive"})}catch{}}},Ee=async()=>{try{if(i){const a=await i.applyUpdate();if(typeof a=="string"&&a.startsWith("err:"))try{m({title:"فشل تطبيق التحديث",description:a.slice(4),variant:"destructive"})}catch{}}}catch(a){try{m({title:"فشل تطبيق التحديث",description:(a==null?void 0:a.message)||"حدث خطأ أثناء تطبيق التحديث",variant:"destructive"})}catch{}}},Le=()=>t!=null&&t.fullName?t==null?void 0:t.fullName.split(" ").map(a=>a.charAt(0)).join("").toUpperCase().slice(0,2):s.email?s.email.charAt(0).toUpperCase():"U",se=t!=null&&t.avatarId?Ye(t.avatarId):null;if(n.useEffect(()=>{console.log("Profile updated in ProfileIcon:",t==null?void 0:t.avatarId)},[t==null?void 0:t.avatarId]),n.useEffect(()=>{const a=async l=>{try{if(!(l!=null&&l.data)||typeof l.data!="object"||l.origin!=="https://cashy.link")return;const{type:f,email:p,refresh_token:g}=l.data||{};f==="cashy_oauth_token"&&s!=null&&s.uid&&p&&g&&await js(s.uid,String(p),String(g))&&m({title:"تم ربط جوجل",description:"تم حفظ توكن النسخ الاحتياطي عبر الخادم."})}catch{}};return window.addEventListener("message",a),()=>window.removeEventListener("message",a)},[s==null?void 0:s.uid]),!s)return null;const _e=async()=>{try{await d()}catch(a){console.error("خطأ في تسجيل الخروج:",a)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[w&&e.jsxs(C,{type:"button",onClick:()=>{S(!0),U(v,I)>0&&N(!0)},title:"تحديث التطبيق",className:"relative inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-blue-600 hover:bg-blue-500/10 focus:outline-none dark:text-blue-400 dark:hover:bg-blue-400/10",variant:"ghost",children:[e.jsx(es,{className:"w-5 h-5"}),O&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 inline-block w-2 h-2 rounded-full bg-red-500"})]}),e.jsxs(ze,{children:[e.jsx(Qe,{asChild:!0,children:e.jsx(C,{variant:"ghost",disabled:x,title:x?"غير متاح أثناء وجود وردية كاشير نشطة":void 0,className:`relative h-8 w-8 rounded-full p-0 hover:bg-transparent focus:ring-1 focus:ring-primary focus:ring-offset-1 transition-all duration-200 disabled:opacity-60 disabled:cursor-not-allowed ${r}`,children:e.jsx(Ne,{className:"h-8 w-8 border border-border shadow-sm hover:shadow-md transition-all duration-200 hover:scale-105 bg-white",children:se?e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-white dark:bg-neutral-900/20 rounded-full overflow-hidden",children:e.jsx("div",{className:"w-full h-full flex items-center justify-center scale-[2.5]",children:se.component})}):e.jsxs(e.Fragment,{children:[e.jsx(be,{src:s.photoURL||void 0,alt:(t==null?void 0:t.fullName)||s.email||"المستخدم",className:"object-cover"}),e.jsx(Se,{className:"bg-white text-gray-900 font-semibold text-lg border-0",children:Le()})]})})})}),e.jsxs(Ke,{className:"w-64",align:"end",forceMount:!0,children:[e.jsx(Je,{className:"font-normal",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:(t==null?void 0:t.fullName)||"المستخدم"}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:s.email}),(t==null?void 0:t.role)&&e.jsxs("p",{className:"text-xs leading-none text-muted-foreground",children:["الدور: ",t.role==="staff"?"مدير":t.role==="merchant"?"تاجر":"مستخدم"]})]})}),e.jsx(z,{}),e.jsxs(W,{onClick:async()=>{try{await o({showWithdrawNote:!((t==null?void 0:t.showWithdrawNote)??!0)})}catch{}},className:"cursor-pointer",children:[e.jsx(Re,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:(t==null?void 0:t.showWithdrawNote)??!0?"إخفاء خانة ملاحظة السحب":"إظهار خانة ملاحظة السحب"})]}),e.jsx(z,{}),e.jsxs(W,{onClick:()=>c("/profile-settings"),className:"cursor-pointer",children:[e.jsx($e,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"إعدادات البروفيل"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="staff")&&e.jsxs(W,{onClick:()=>c("/admin"),className:"cursor-pointer",children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"لوحة الإدارة"})]}),e.jsx(z,{}),e.jsxs(W,{onClick:_e,className:"cursor-pointer text-red-600 focus:text-red-600",children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"تسجيل الخروج"})]})]})]})]}),w&&e.jsx(le,{open:D,onOpenChange:a=>{if(S(a),!a){const l=`desktop_update_seen_${String((s==null?void 0:s.uid)||"anon")}`;try{v&&localStorage.setItem(l,v)}catch{}N(!1)}},children:e.jsxs(ie,{className:"sm:max-w-md",children:[e.jsx(ce,{children:e.jsx(de,{children:"يوجد تحديث جديد للبرنامج"})}),e.jsx("div",{className:"text-sm",children:V?"جارٍ تنزيل التحديث...":O&&U(v,I)>0?"هل ترغب في تنزيله الآن؟":"التطبيق مُحدَّث لآخر إصدار"}),v&&e.jsxs("div",{className:"mt-2 text-xs",children:["الإصدار الجديد: ",e.jsxs("span",{className:"font-semibold",children:["v",v]})]}),I&&e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["إصدار التطبيق لديك: ",e.jsxs("span",{className:"font-semibold",children:["v",I]})]}),h&&e.jsx("div",{className:"mt-2 text-xs text-muted-foreground whitespace-pre-line",children:h}),V&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"w-full h-2 bg-gray-200 rounded",children:e.jsx("div",{className:"h-2 bg-blue-600 rounded",style:{width:`${k}%`}})}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:[Math.round(k),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 mt-3",children:[e.jsx(C,{variant:"outline",onClick:()=>{const a=`desktop_update_seen_${String((s==null?void 0:s.uid)||"anon")}`;try{v&&localStorage.setItem(a,v)}catch{}N(!1),S(!1)},children:"إلغاء"}),!V&&k<100&&O&&U(v,I)>0&&e.jsx(C,{className:"bg-blue-600 hover:bg-blue-700",onClick:Ie,children:"بدء التنزيل"}),k>=100&&e.jsx(C,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{try{if(i!=null&&i.openUpdateFolder){const a=await i.openUpdateFolder();typeof a=="string"&&a.startsWith("err:")?m({title:"تعذر فتح مجلد التحديث",description:a.slice(4),variant:"destructive"}):m({title:"افتح ملف التثبيت",description:"تم فتح مجلد التحديث — اضغط على الملف لتثبيت."})}else await Ee()}catch(a){m({title:"تعذر فتح مجلد التحديث",description:(a==null?void 0:a.message)||"حدث خطأ غير متوقع",variant:"destructive"})}},children:"تحديث الآن"})]})]})}),e.jsx(ws,{open:b,onOpenChange:y})]})}export{Ls as I,_s as L};
//# sourceMappingURL=ProfileIcon-DCyirBaq-gWw1xk4p.js.map
