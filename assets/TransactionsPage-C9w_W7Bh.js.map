{"version":3,"mappings":"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","names":["__iconNode","BatteryCharging","createLucideIcon","CirclePlay","TotalProfitDisplayDialog","userId","transactions","isOpen","setIsOpen","useState","isMasterPinDialogOpen","setIsMasterPinDialogOpen","isAuthenticated","setIsAuthenticated","totals","setTotals","userSubscription","useFirebaseAuth","useEffect","loadTotals","formatCurrency","amount","isZeroPlan","localSub","rawLocal","planLocalStr","SubscriptionPlan","remoteSub","getUserSubscription","rawRemote","planRemoteStr","handleEyeClick","isTahweela","toast","handlePinSuccess","today","currentMonth","currentYear","visibleDaily","reportsService","visibleMonthly","dailyWithdrawProfit","dailyTransferProfit","monthlyWithdrawProfit","monthlyTransferProfit","tx","txDate","status","t","txForCalc","ProfitService","profits","e","jsxs","Fragment","jsx","Button","Eye","Dialog","DialogContent","DialogHeader","DialogTitle","DollarSign","Clock","ArrowDownLeft","ArrowRightLeft","Calendar","MasterPinDialog","TotalProfitEyeButton","props","TransactionsPage","navigate","useNavigate","user","profile","React","planRaw","_a","_b","_c","_d","isTahweelaPlan","_e","_f","_g","_h","shopName","useShop","isShiftActive","shiftUser","useShift","setTransactions","deletedTransactions","setDeletedTransactions","permDeletedSet","setPermDeletedSet","isRestoreConfirmOpen","setIsRestoreConfirmOpen","pendingRestoreTx","setPendingRestoreTx","activeTab","setActiveTab","searchPhone","setSearchPhone","selectedDate","setSelectedDate","selectedTime","setSelectedTime","isCalculatorOpen","setIsCalculatorOpen","isInstallmentPinOpen","setIsInstallmentPinOpen","isInstallmentModalOpen","setIsInstallmentModalOpen","isGuideOpen","setIsGuideOpen","guideUrl","setGuideUrl","guideTitle","setGuideTitle","guidePublishedAt","setGuidePublishedAt","lastTutorialSeenAt","setLastTutorialSeenAt","hasNewGuide","setHasNewGuide","_i","isSalesDataOpen","setIsSalesDataOpen","isDatePickerOpen","setIsDatePickerOpen","isDebtsDialogOpen","setIsDebtsDialogOpen","isDebtsPasswordDialogOpen","setIsDebtsPasswordDialogOpen","isCreditCardsOpen","setIsCreditCardsOpen","isMaintenanceOpen","setIsMaintenanceOpen","isReceiptOpen","setIsReceiptOpen","receiptTransaction","setReceiptTransaction","isResetRecentDialogOpen","setIsResetRecentDialogOpen","recentResetConfig","setRecentResetConfig","data","userDataService","raw","keep","interval","toJsDate","v","last","now","userRef","doc","db","snap","getDoc","dt","url","title","rawPub","pub","toYouTubeEmbed","u","id","openGuide","isTopUpOpen","setIsTopUpOpen","topupPhone","setTopupPhone","topupOperator","setTopupOperator","topupAmount","setTopupAmount","topupLoading","setTopupLoading","pendingDebtsCount","setPendingDebtsCount","count","d","loadTransactions","loadDeletedTransactions","q","fsQuery","collection","where","getDocs","keys","arr","prev","next","k","tid","ref","fetchedTransactions","refetchTransactions","isFetching","useQuery","primary","alt","permKeysRes","txns","permSet","filtered","locals","merged","getKey","seen","normalizeTransaction","error","distinct","deletedWithDates","auditLogService","effectiveTransactions","monthStart","nextMonthStart","a","b","hiddenCount","filteredTransactions","transaction","phoneMatch","dateMatch","timeMatch","getStatusIcon","type","CheckCircle","XCircle","getStatusText","statusRaw","normalizedStatus","normalizedType","sender","receiver","createdAtVal","createdAt","mapToReceiptTransaction","p","short","baseTitle","handleTransactionClick","receiptData","handleOpenRestoreDialog","handleConfirmRestore","restoreTransaction","transactionId","transactionToRestore","newId","restored","permanentlyDeleteTransaction","handleCompleteReceipt","plan","dailyOperationCountService","__vitePreload","opType","limitErr","userProfile","profileService","dataRef","dataSnap","cashBalance","walletBalances","fromWalletIdForLimits","alreadyReservedLimits","checkAmt","checkType","walletDailyLimitsService","n","can","didAddCashNow","fromWalletId","commission","alreadyAppliedOnCreationWallet","alreadyAppliedOnCreationCash","current","updateDoc","fee","amountToAdd","toAdd","amt","profit","handleDeleteReceipt","finalStatus","rawTx","s","originalId","linkedTxnId","linkedRef","wasAppliedOnCreation","sentAmount","ReportsService","transactionData","autoTestRanRef","useRef","location","useLocation","snapBefore","beforeCash","beforeWallets","snapAfterComplete","afterCashComplete","afterWalletsComplete","expectedCashAfter","expectedWalletAfter","snapAfterDelete","afterCashDelete","afterWalletsDelete","err","submitTopUp","allowedEmail","userEmail","auth","operatorToSend","controller","timeout","idToken","resp","rawText","ArrowLeft","Card","CardHeader","CardTitle","Search","Input","PlayCircle","BadgePercent","CreditCard","Calculator","BarChart","FileText","Wrench","Trash2","CardContent","Tabs","TabsList","TabsTrigger","TabsContent","index","formatNumberEnglish","Badge","ArrowUpRight","Check","X","MaintenanceDialog","CreditCardsDialog","PasswordConfirmDialog","resetAt","cfg","open","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","DialogDescription","ReceiptModal","InstallmentModal"],"ignoreList":[0,1],"sources":["../../node_modules/lucide-react/dist/esm/icons/battery-charging.js","../../node_modules/lucide-react/dist/esm/icons/circle-play.js","../../src/components/TotalProfitDisplayDialog.tsx","../../src/pages/TransactionsPage.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.561.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m11 7-3 5h4l-3 5\", key: \"b4a64w\" }],\n  [\"path\", { d: \"M14.856 6H16a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.935\", key: \"lre1cr\" }],\n  [\"path\", { d: \"M22 14v-4\", key: \"14q9d5\" }],\n  [\"path\", { d: \"M5.14 18H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2.936\", key: \"13q5k0\" }]\n];\nconst BatteryCharging = createLucideIcon(\"battery-charging\", __iconNode);\n\nexport { __iconNode, BatteryCharging as default };\n//# sourceMappingURL=battery-charging.js.map\n","/**\n * @license lucide-react v0.561.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z\",\n      key: \"kmsa83\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }]\n];\nconst CirclePlay = createLucideIcon(\"circle-play\", __iconNode);\n\nexport { __iconNode, CirclePlay as default };\n//# sourceMappingURL=circle-play.js.map\n","import React, { useEffect, useState } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Eye, DollarSign, ArrowDownLeft, ArrowRightLeft, Calendar, Clock } from 'lucide-react';\r\nimport { ProfitService } from '@/utils/profitService';\r\nimport { reportsService } from '@/utils/reportsService';\r\nimport { MasterPinDialog } from './MasterPinDialog';\r\nimport { toast } from '@/hooks/use-toast';\r\nimport { getUserSubscription, SubscriptionPlan } from '@/utils/subscriptionService';\r\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\r\n\r\ninterface TotalProfitDisplayDialogProps {\r\n  userId?: string;\r\n  transactions?: any[];\r\n}\r\n\r\ninterface TotalsData {\r\n  dailyWithdraw: number;\r\n  dailyTransfer: number;\r\n  monthlyWithdraw: number;\r\n  monthlyTransfer: number;\r\n  lastUpdated: Date;\r\n}\r\n\r\nconst TotalProfitDisplayDialog: React.FC<TotalProfitDisplayDialogProps> = ({ userId, transactions = [] }) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [isMasterPinDialogOpen, setIsMasterPinDialogOpen] = useState(false);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [totals, setTotals] = useState<TotalsData>({\r\n    dailyWithdraw: 0,\r\n    dailyTransfer: 0,\r\n    monthlyWithdraw: 0,\r\n    monthlyTransfer: 0,\r\n    lastUpdated: new Date(),\r\n  });\r\n  const { userSubscription } = useFirebaseAuth();\r\n\r\n  useEffect(() => {\r\n    if (userId && isOpen && isAuthenticated) {\r\n      loadTotals();\r\n    }\r\n  }, [userId, isOpen, isAuthenticated]);\r\n\r\n  const formatCurrency = (amount: number) => `${amount.toFixed(2)} .`;\r\n\r\n  const isZeroPlan = async (): Promise<boolean> => {\r\n    try {\r\n      const localSub: any = (userSubscription as any)?.subscription || null;\r\n      const rawLocal: any = localSub?.planType ?? localSub?.plan ?? null;\r\n      const planLocalStr = typeof rawLocal === 'string' ? rawLocal.toLowerCase() : null;\r\n      if (rawLocal === SubscriptionPlan.ZERO || planLocalStr === 'zero' || planLocalStr === '0' || rawLocal === 0) {\r\n        return true;\r\n      }\r\n    } catch {}\r\n\r\n    try {\r\n      if (userId) {\r\n        const remoteSub: any = await getUserSubscription(userId);\r\n        const rawRemote: any = remoteSub?.planType ?? remoteSub?.plan ?? null;\r\n        const planRemoteStr = typeof rawRemote === 'string' ? rawRemote.toLowerCase() : null;\r\n        if (rawRemote === SubscriptionPlan.ZERO || planRemoteStr === 'zero' || planRemoteStr === '0' || rawRemote === 0) {\r\n          return true;\r\n        }\r\n      }\r\n    } catch {}\r\n\r\n    return false;\r\n  };\r\n\r\n  const handleEyeClick = async () => {\r\n    try {\r\n      const isTahweela = await (async () => {\r\n        try {\r\n          const localSub: any = (userSubscription as any)?.subscription || null;\r\n          const rawLocal: any = localSub?.planType ?? localSub?.plan ?? null;\r\n          const planLocalStr = typeof rawLocal === 'string' ? rawLocal.toLowerCase() : null;\r\n          if (rawLocal === SubscriptionPlan.TAHWEELA || planLocalStr === 'tahweela') return true;\r\n        } catch {}\r\n        try {\r\n          if (userId) {\r\n            const remoteSub: any = await getUserSubscription(userId);\r\n            const rawRemote: any = remoteSub?.planType ?? remoteSub?.plan ?? null;\r\n            const planRemoteStr = typeof rawRemote === 'string' ? rawRemote.toLowerCase() : null;\r\n            if (rawRemote === SubscriptionPlan.TAHWEELA || planRemoteStr === 'tahweela') return true;\r\n          }\r\n        } catch {}\r\n        return false;\r\n      })();\r\n      if (await isZeroPlan() || isTahweela) {\r\n        toast({\r\n          title: '  ',\r\n          description: '       .',\r\n          variant: 'destructive',\r\n        });\r\n        return;\r\n      }\r\n    } catch {}\r\n    setIsMasterPinDialogOpen(true);\r\n  };\r\n\r\n  const handlePinSuccess = async () => {\r\n    try {\r\n      const isTahweela = await (async () => {\r\n        try {\r\n          const localSub: any = (userSubscription as any)?.subscription || null;\r\n          const rawLocal: any = localSub?.planType ?? localSub?.plan ?? null;\r\n          const planLocalStr = typeof rawLocal === 'string' ? rawLocal.toLowerCase() : null;\r\n          if (rawLocal === SubscriptionPlan.TAHWEELA || planLocalStr === 'tahweela') return true;\r\n        } catch {}\r\n        try {\r\n          if (userId) {\r\n            const remoteSub: any = await getUserSubscription(userId);\r\n            const rawRemote: any = remoteSub?.planType ?? remoteSub?.plan ?? null;\r\n            const planRemoteStr = typeof rawRemote === 'string' ? rawRemote.toLowerCase() : null;\r\n            if (rawRemote === SubscriptionPlan.TAHWEELA || planRemoteStr === 'tahweela') return true;\r\n          }\r\n        } catch {}\r\n        return false;\r\n      })();\r\n      if (await isZeroPlan() || isTahweela) {\r\n        toast({\r\n          title: '  ',\r\n          description: '       .',\r\n          variant: 'destructive',\r\n        });\r\n        setIsMasterPinDialogOpen(false);\r\n        return;\r\n      }\r\n    } catch {}\r\n\r\n    setIsAuthenticated(true);\r\n    setIsOpen(true);\r\n    setIsMasterPinDialogOpen(false);\r\n  };\r\n\r\n  const loadTotals = async () => {\r\n    if (!userId) return;\r\n\r\n    try {\r\n      if (Array.isArray(transactions) && transactions.length > 0) {\r\n        const today = new Date();\r\n        const currentMonth = today.getMonth();\r\n        const currentYear = today.getFullYear();\r\n\r\n        const visibleDaily = reportsService.filterVisibleTransactions(transactions as any[], 'daily', userId);\r\n        const visibleMonthly = reportsService.filterVisibleTransactions(transactions as any[], 'monthly', userId);\r\n\r\n        let dailyWithdrawProfit = 0;\r\n        let dailyTransferProfit = 0;\r\n        let monthlyWithdrawProfit = 0;\r\n        let monthlyTransferProfit = 0;\r\n\r\n        visibleDaily.forEach((tx: any) => {\r\n          const txDate = new Date(tx.createdAt);\r\n          const status = String(tx.status || 'confirmed').toLowerCase();\r\n          if (txDate.toDateString() !== today.toDateString()) return;\r\n          if (status !== 'completed' && status !== 'confirmed' && status !== 'pending') return;\r\n\r\n          const t = (tx.type || tx.txnType || '').toLowerCase();\r\n          const txForCalc = {\r\n            type: t === 'withdrawal' ? 'withdraw' : t,\r\n            amount: Number(tx.amount || 0),\r\n            commission: tx.commission,\r\n          };\r\n\r\n          if (txForCalc.type === 'withdraw') {\r\n            dailyWithdrawProfit += ProfitService.calculateProfitFromTransaction(txForCalc);\r\n          } else if (txForCalc.type === 'send' || txForCalc.type === 'receive' || txForCalc.type === 'transfer') {\r\n            dailyTransferProfit += ProfitService.calculateProfitFromTransaction(txForCalc);\r\n          }\r\n        });\r\n\r\n        visibleMonthly.forEach((tx: any) => {\r\n          const txDate = new Date(tx.createdAt);\r\n          const status = String(tx.status || 'confirmed').toLowerCase();\r\n          if (txDate.getMonth() !== currentMonth || txDate.getFullYear() !== currentYear) return;\r\n          if (status !== 'completed' && status !== 'confirmed' && status !== 'pending') return;\r\n\r\n          const t = (tx.type || tx.txnType || '').toLowerCase();\r\n          const txForCalc = {\r\n            type: t === 'withdrawal' ? 'withdraw' : t,\r\n            amount: Number(tx.amount || 0),\r\n            commission: tx.commission,\r\n          };\r\n\r\n          if (txForCalc.type === 'withdraw') {\r\n            monthlyWithdrawProfit += ProfitService.calculateProfitFromTransaction(txForCalc);\r\n          } else if (txForCalc.type === 'send' || txForCalc.type === 'receive' || txForCalc.type === 'transfer') {\r\n            monthlyTransferProfit += ProfitService.calculateProfitFromTransaction(txForCalc);\r\n          }\r\n        });\r\n\r\n        setTotals({\r\n          dailyWithdraw: Math.round(dailyWithdrawProfit * 100) / 100,\r\n          dailyTransfer: Math.round(dailyTransferProfit * 100) / 100,\r\n          monthlyWithdraw: Math.round(monthlyWithdrawProfit * 100) / 100,\r\n          monthlyTransfer: Math.round(monthlyTransferProfit * 100) / 100,\r\n          lastUpdated: new Date(),\r\n        });\r\n        return;\r\n      }\r\n\r\n      const profits = ProfitService.getWithdrawTransferProfits(userId);\r\n      setTotals({\r\n        dailyWithdraw: profits.dailyWithdrawProfit || 0,\r\n        dailyTransfer: profits.dailyTransferProfit || 0,\r\n        monthlyWithdraw: profits.monthlyWithdrawProfit || 0,\r\n        monthlyTransfer: profits.monthlyTransferProfit || 0,\r\n        lastUpdated: new Date(),\r\n      });\r\n    } catch (e) {\r\n      console.error('Error loading total profits:', e);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Button\r\n        size=\"sm\"\r\n        variant=\"ghost\"\r\n        onClick={handleEyeClick}\r\n        className=\"h-2 w-2 p-0 bg-gradient-to-r from-blue-100 to-purple-200 text-purple-700 hover:from-blue-200 hover:to-purple-300 hover:text-purple-800 rounded transition-all duration-300 hover:scale-110 shadow-sm hover:shadow-md\"\r\n        title=\"  \"\r\n      >\r\n        <Eye className=\"h-1.5 w-1.5\" />\r\n      </Button>\r\n\r\n      <Dialog open={isOpen} onOpenChange={setIsOpen}>\r\n        <DialogContent className=\"max-w-[240px] mx-auto bg-white border border-gray-200 shadow-md rounded sm:max-w-[220px] sm:bg-gradient-to-br sm:from-purple-50 sm:to-white sm:border-2 sm:border-purple-200 sm:shadow-2xl sm:rounded-2xl\">\r\n          <DialogHeader className=\"text-center pb-0 border-b-0 sm:pb-2 sm:border-b sm:border-purple-200\">\r\n            <DialogTitle className=\"text-xs font-bold text-purple-800 flex items-center justify-center gap-1 mb-0 leading-tight tracking-tight sm:text-xs sm:gap-1 sm:mb-0 sm:leading-normal sm:tracking-normal\">\r\n              <DollarSign className=\"h-2 w-2 text-purple-600 sm:h-3 sm:w-3\" />\r\n                ()\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-1 py-1 sm:space-y-2 sm:py-2\">\r\n            {/*   */}\r\n            <div className=\"bg-blue-50 p-1 rounded border border-blue-200 sm:bg-gradient-to-r sm:from-blue-50 sm:to-blue-100 sm:p-2 sm:rounded-xl sm:shadow-sm\">\r\n              <div className=\"flex items-center justify-between mb-1\">\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Clock className=\"h-2 w-2 text-blue-600\" />\r\n                  <span className=\"text-[10px] font-semibold text-blue-800\"></span>\r\n                </div>\r\n                <span className=\"text-[10px] font-bold text-blue-900\">\r\n                  {formatCurrency((totals.dailyWithdraw ?? 0) + (totals.dailyTransfer ?? 0))}\r\n                </span>\r\n              </div>\r\n              <div className=\"grid grid-cols-2 gap-1\">\r\n                <div className=\"flex items-center justify-between bg-red-50 p-0.5 rounded border border-red-200\">\r\n                  <div className=\"flex items-center gap-1\">\r\n                    <ArrowDownLeft className=\"h-2 w-2 text-red-600\" />\r\n                    <span className=\"text-[10px] text-red-800\"></span>\r\n                  </div>\r\n                  <span className=\"text-[10px] font-bold text-red-700\">{formatCurrency(totals.dailyWithdraw)}</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between bg-green-50 p-0.5 rounded border border-green-200\">\r\n                  <div className=\"flex items-center gap-1\">\r\n                    <ArrowRightLeft className=\"h-2 w-2 text-green-600\" />\r\n                    <span className=\"text-[10px] text-green-800\"></span>\r\n                  </div>\r\n                  <span className=\"text-[10px] font-bold text-green-700\">{formatCurrency(totals.dailyTransfer)}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/*   */}\r\n            <div className=\"bg-purple-50 p-1 rounded border border-purple-200 sm:bg-gradient-to-r sm:from-purple-50 sm:to-purple-100 sm:p-2 sm:rounded-xl sm:shadow-sm\">\r\n              <div className=\"flex items-center justify-between mb-1\">\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Calendar className=\"h-2 w-2 text-purple-600\" />\r\n                  <span className=\"text-[10px] font-semibold text-purple-800\"></span>\r\n                </div>\r\n                <span className=\"text-[10px] font-bold text-purple-900\">\r\n                  {formatCurrency((totals.monthlyWithdraw ?? 0) + (totals.monthlyTransfer ?? 0))}\r\n                </span>\r\n              </div>\r\n              <div className=\"grid grid-cols-2 gap-1\">\r\n                <div className=\"flex items-center justify-between bg-red-50 p-0.5 rounded border border-red-200\">\r\n                  <div className=\"flex items-center gap-1\">\r\n                    <ArrowDownLeft className=\"h-2 w-2 text-red-600\" />\r\n                    <span className=\"text-[10px] text-red-800\"></span>\r\n                  </div>\r\n                  <span className=\"text-[10px] font-bold text-red-700\">{formatCurrency(totals.monthlyWithdraw)}</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between bg-blue-50 p-0.5 rounded border border-blue-200\">\r\n                  <div className=\"flex items-center gap-1\">\r\n                    <ArrowRightLeft className=\"h-2 w-2 text-blue-600\" />\r\n                    <span className=\"text-[10px] text-blue-800\"></span>\r\n                  </div>\r\n                  <span className=\"text-[10px] font-bold text-blue-700\">{formatCurrency(totals.monthlyTransfer)}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {!isAuthenticated && (\r\n            <div className=\"absolute inset-0 bg-yellow-200/70 backdrop-blur-sm flex items-center justify-center rounded sm:rounded-2xl border border-yellow-300 pointer-events-auto\">\r\n              <Button\r\n                size=\"sm\"\r\n                variant=\"ghost\"\r\n                onClick={() => setIsMasterPinDialogOpen(true)}\r\n                className=\"p-2 bg-yellow-300/80 text-yellow-900 hover:bg-yellow-400/90 rounded-full shadow-sm hover:shadow-md transition-all duration-300\"\r\n                title=\"   \"\r\n              >\r\n                <Eye className=\"h-4 w-4\" />\r\n              </Button>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"flex justify-center pt-1 border-t-0 sm:pt-2 sm:border-t sm:border-purple-200\">\r\n            <Button\r\n              onClick={() => setIsOpen(false)}\r\n              className=\"bg-purple-600 hover:bg-purple-700 text-white px-4 py-1 rounded-xl text-xs sm:bg-gradient-to-r sm:from-purple-600 sm:to-purple-700 sm:hover:from-purple-700 sm:hover:to-purple-800 sm:px-4 sm:py-1 sm:rounded-xl sm:shadow-lg sm:hover:shadow-xl sm:transition-all sm:duration-300\"\r\n            >\r\n              \r\n            </Button>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <MasterPinDialog\r\n        open={isMasterPinDialogOpen}\r\n        onOpenChange={setIsMasterPinDialogOpen}\r\n        onSuccess={handlePinSuccess}\r\n        description=\"          \"\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport const TotalProfitEyeButton: React.FC<TotalProfitDisplayDialogProps> = (props) => {\r\n  return <TotalProfitDisplayDialog {...props} />;\r\n};\r\n\r\nexport default TotalProfitDisplayDialog;\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from '@/components/ui/dialog';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport ReceiptModal from '@/components/ReceiptModal';\r\nimport InstallmentModal from '@/components/InstallmentModal';\r\nimport CreditCardsDialog from '@/components/CreditCardsDialog';\r\nimport MaintenanceDialog from '@/components/MaintenanceDialog';\r\nimport PasswordConfirmDialog from '@/components/PasswordConfirmDialog';\r\nimport { MasterPinDialog } from '@/components/MasterPinDialog';\r\nimport { \r\n  ArrowLeft, \r\n  Search, \r\n  Calculator, \r\n  BarChart, \r\n  Calendar, \r\n  FileText, \r\n  Trash2,\r\n  CheckCircle,\r\n  Check,\r\n  Clock,\r\n  XCircle,\r\n  X,\r\n  Send,\r\n  ArrowDownLeft,\r\n  ArrowUpRight,\r\n  CreditCard,\r\n  Wrench,\r\n  BatteryCharging,\r\n  BadgePercent,\r\n  PlayCircle\r\n} from 'lucide-react';\r\nimport { TotalProfitEyeButton } from '@/components/TotalProfitDisplayDialog';\r\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\r\nimport { SubscriptionPlan } from '@/utils/subscriptionService';\r\nimport { useShift } from '@/contexts/ShiftContext';\r\nimport { useShop } from '@/hooks/useShop';\r\nimport { toast } from '@/hooks/use-toast';\r\nimport { userDataService, auditLogService } from '@/integrations/firebase/services';\r\nimport { db, auth } from '@/firebase';\r\nimport { collection, query as fsQuery, where, orderBy, doc, updateDoc, getDocs, deleteDoc, getDoc, getDocsFromCache, limit } from 'firebase/firestore';\r\nimport { formatAmount, formatNumberEnglish } from '@/utils/formatters';\r\nimport { profileService } from '@/integrations/firebase/services';\r\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\r\n\r\ninterface Transaction {\r\n  id: string;\r\n  senderPhone: string;\r\n  receiverPhone: string;\r\n  amount: number;\r\n  status: 'pending' | 'completed' | 'cancelled';\r\n  type: 'send' | 'withdraw';\r\n  createdAt: Date;\r\n  provider?: string;\r\n  reference?: string;\r\n  commission?: number;\r\n  fee?: number;\r\n  withdrawnAmount?: number;\r\n  sentAmount?: number;\r\n  fromWallet?: string;\r\n  cashierName?: string;\r\n  commissionMode?: 'add' | 'deduct';\r\n  totalCharged?: number;\r\n  walletEffectAppliedOnCreation?: boolean;\r\n  cashEffectAppliedOnCreation?: boolean;\r\n  limitsReservedOnCreation?: boolean;\r\n  limitReservedType?: 'transfer' | 'withdraw';\r\n  senderName?: string;\r\n}\r\n\r\nconst TransactionsPage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { user, profile, userSubscription } = useFirebaseAuth();\r\n\r\n  const isZeroPlan = React.useMemo(() => {\r\n    const planRaw = userSubscription?.subscription?.planType \r\n      ?? userSubscription?.subscription?.plan \r\n      ?? (profile as any)?.subscription?.planType \r\n      ?? (profile as any)?.subscription?.plan \r\n      ?? null;\r\n    return planRaw === SubscriptionPlan.ZERO || String(planRaw).toLowerCase() === 'zero';\r\n  }, [\r\n    userSubscription?.subscription?.planType,\r\n    userSubscription?.subscription?.plan,\r\n    (profile as any)?.subscription?.planType,\r\n    (profile as any)?.subscription?.plan\r\n  ]);\r\n  const isTahweelaPlan = React.useMemo(() => {\r\n    const planRaw = userSubscription?.subscription?.planType \r\n      ?? userSubscription?.subscription?.plan \r\n      ?? (profile as any)?.subscription?.planType \r\n      ?? (profile as any)?.subscription?.plan \r\n      ?? null;\r\n    return planRaw === SubscriptionPlan.TAHWEELA || String(planRaw).toLowerCase() === 'tahweela';\r\n  }, [\r\n    userSubscription?.subscription?.planType,\r\n    userSubscription?.subscription?.plan,\r\n    (profile as any)?.subscription?.planType,\r\n    (profile as any)?.subscription?.plan\r\n  ]);\r\n  const { shopName } = useShop();\r\n  const { isShiftActive, shiftUser } = useShift();\r\n  const [transactions, setTransactions] = useState<Transaction[]>([]);\r\n  const [deletedTransactions, setDeletedTransactions] = useState<Transaction[]>([]);\r\n  const [permDeletedSet, setPermDeletedSet] = useState<Set<string>>(new Set());\r\n  const [isRestoreConfirmOpen, setIsRestoreConfirmOpen] = useState(false);\r\n  const [pendingRestoreTx, setPendingRestoreTx] = useState<Transaction | null>(null);\r\n  const [activeTab, setActiveTab] = useState('all');\r\n  const [searchPhone, setSearchPhone] = useState('');\r\n  const [selectedDate, setSelectedDate] = useState('');\r\n  const [selectedTime, setSelectedTime] = useState('');\r\n  const [isCalculatorOpen, setIsCalculatorOpen] = useState(false);\r\n  const [isInstallmentPinOpen, setIsInstallmentPinOpen] = useState(false);\r\n  const [isInstallmentModalOpen, setIsInstallmentModalOpen] = useState(false);\r\n  const [isGuideOpen, setIsGuideOpen] = useState(false);\r\n  const [guideUrl, setGuideUrl] = useState<string>('');\r\n  const [guideTitle, setGuideTitle] = useState<string>(' ');\r\n  const [guidePublishedAt, setGuidePublishedAt] = useState<Date | null>(null);\r\n  const [lastTutorialSeenAt, setLastTutorialSeenAt] = useState<Date | null>(null);\r\n  const [hasNewGuide, setHasNewGuide] = useState<boolean>(false);\r\n\r\n  React.useEffect(() => {\r\n    const plan = userSubscription?.subscription?.planType;\r\n    if (plan === SubscriptionPlan.TAHWEELA) {\r\n      toast({ title: '  ', description: '      .    / .' , variant: 'destructive' });\r\n      navigate('/user/dashboard');\r\n    }\r\n  }, [userSubscription?.subscription?.planType]);\r\n  const [isSalesDataOpen, setIsSalesDataOpen] = useState(false);\r\n  const [isDatePickerOpen, setIsDatePickerOpen] = useState(false);\r\n  const [isDebtsDialogOpen, setIsDebtsDialogOpen] = useState(false);\r\nconst [isDebtsPasswordDialogOpen, setIsDebtsPasswordDialogOpen] = useState(false);\r\n  const [isCreditCardsOpen, setIsCreditCardsOpen] = useState(false);\r\n  const [isMaintenanceOpen, setIsMaintenanceOpen] = useState(false);\r\n  const [isReceiptOpen, setIsReceiptOpen] = useState(false);\r\n  const [receiptTransaction, setReceiptTransaction] = useState<any | null>(null);\r\n  const [isResetRecentDialogOpen, setIsResetRecentDialogOpen] = useState(false);\r\n\r\n  //   :   Firestore   N  \r\n  const [recentResetConfig, setRecentResetConfig] = useState<{ keepLastCount: number; intervalDays: number; lastResetAt: Date | null }>({ keepLastCount: 30, intervalDays: 7, lastResetAt: null });\r\n  useEffect(() => {\r\n    const initWeeklyReset = async () => {\r\n      if (!user?.uid) return;\r\n      try {\r\n        const data = await userDataService.getUserData(user.uid);\r\n        const raw = (data?.recentReset || {}) as any;\r\n        const keep = Number(raw?.keepLastCount) > 0 ? Number(raw.keepLastCount) : 30;\r\n        const interval = Number(raw?.intervalDays) > 0 ? Number(raw.intervalDays) : 7;\r\n        const toJsDate = (v: any) => (v instanceof Date) ? v : (typeof v?.toDate === 'function') ? v.toDate() : (v ? new Date(String(v)) : null);\r\n        const last: Date | null = raw?.lastResetAt ? toJsDate(raw.lastResetAt) : null;\r\n        const now = new Date();\r\n        const needReset = !last || (now.getTime() - last.getTime()) >= interval * 24 * 60 * 60 * 1000;\r\n        if (needReset) {\r\n          await userDataService.updateUserData(user.uid, { recentReset: { keepLastCount: keep, intervalDays: interval, lastResetAt: now } });\r\n          setRecentResetConfig({ keepLastCount: keep, intervalDays: interval, lastResetAt: now });\r\n        } else {\r\n          setRecentResetConfig({ keepLastCount: keep, intervalDays: interval, lastResetAt: last });\r\n        }\r\n      } catch {\r\n        //         \r\n        setRecentResetConfig({ keepLastCount: 30, intervalDays: 7, lastResetAt: null });\r\n      }\r\n    };\r\n    initWeeklyReset();\r\n  }, [user?.uid]);\r\n\r\n  //     ( )\r\n  useEffect(() => {\r\n    if (!user?.uid) return;\r\n    const fetchTutorialSeenAt = async () => {\r\n      try {\r\n        const userRef = doc(db, 'users', user.uid);\r\n        const snap = await getDoc(userRef);\r\n        const data: any = snap.exists() ? snap.data() : {};\r\n        const raw = data?.tutorialSeenAt;\r\n        const dt = raw?.toDate ? raw.toDate() : (raw ? new Date(raw) : null);\r\n        setLastTutorialSeenAt(dt);\r\n      } catch {}\r\n    };\r\n    fetchTutorialSeenAt();\r\n  }, [user?.uid]);\r\n\r\n  //    ( )\r\n  useEffect(() => {\r\n    const fetchGuide = async () => {\r\n      try {\r\n        const snap = await getDoc(doc(db, 'app_guides', 'latest'));\r\n        const data: any = snap.exists() ? snap.data() : null;\r\n        if (!data) { setGuideUrl(''); setGuideTitle(''); setGuidePublishedAt(null); setHasNewGuide(false); return; }\r\n        const url: string = String(data.url || '');\r\n        const title: string = String(data.title || ' ');\r\n        const rawPub = data.publishedAt;\r\n        const pub: Date | null = rawPub?.toDate ? rawPub.toDate() : (rawPub ? new Date(rawPub) : new Date());\r\n        setGuideUrl(url);\r\n        setGuideTitle(title);\r\n        setGuidePublishedAt(pub);\r\n        setHasNewGuide(pub ? (!lastTutorialSeenAt || (pub.getTime() > (lastTutorialSeenAt?.getTime() || 0))) : false);\r\n      } catch (e) {\r\n        setHasNewGuide(false);\r\n      }\r\n    };\r\n    fetchGuide();\r\n  }, [lastTutorialSeenAt]);\r\n\r\n  const toYouTubeEmbed = (url: string): string => {\r\n    try {\r\n      const u = new URL(url);\r\n      let id = '';\r\n      if (u.hostname.includes('youtube.com')) {\r\n        if (u.pathname === '/watch') id = u.searchParams.get('v') || '';\r\n        else if (u.pathname.startsWith('/embed/')) id = u.pathname.split('/').pop() || '';\r\n        else if (u.pathname.startsWith('/shorts/')) id = u.pathname.split('/').pop() || '';\r\n      } else if (u.hostname === 'youtu.be') {\r\n        id = u.pathname.replace(/^\\//, '');\r\n      }\r\n      if (!id) return url;\r\n      return `https://www.youtube.com/embed/${id}?autoplay=1&rel=0`;\r\n    } catch { return url; }\r\n  };\r\n\r\n  const openGuide = async () => {\r\n    setIsGuideOpen(true);\r\n    try {\r\n      if (user?.uid) {\r\n        await userDataService.updateUserData(user.uid, { tutorialSeenAt: new Date() });\r\n      }\r\n      setHasNewGuide(false);\r\n    } catch {}\r\n  };\r\n\r\n  // Top-up modal state\r\n  const [isTopUpOpen, setIsTopUpOpen] = useState(false);\r\n  const [topupPhone, setTopupPhone] = useState('');\r\n  const [topupOperator, setTopupOperator] = useState('');\r\n  const [topupAmount, setTopupAmount] = useState<number | ''>('');\r\n  const [topupLoading, setTopupLoading] = useState(false);\r\n\r\n  const [pendingDebtsCount, setPendingDebtsCount] = useState(0);\r\n  //    \r\n  useEffect(() => {\r\n    if (!user?.uid) { setPendingDebtsCount(0); return; }\r\n    const fetchDebts = async () => {\r\n      try {\r\n        const userRef = doc(db, 'users', user.uid);\r\n        const snap = await getDoc(userRef);\r\n        \r\n        const data: any = snap.exists() ? snap.data() : {};\r\n        const arrayDebts = Array.isArray(data?.debts) ? data.debts : [];\r\n        \r\n        //       (     )\r\n        const allDebts = arrayDebts;\r\n        \r\n        const count = allDebts.filter((d: any) => d?.status === 'pending' && ((Number(d?.amount) || 0) > 0)).length;\r\n        setPendingDebtsCount(count);\r\n      } catch {\r\n        setPendingDebtsCount(0);\r\n      }\r\n    };\r\n    fetchDebts();\r\n  }, [user?.uid]);\r\n\r\n  useEffect(() => {\r\n    loadTransactions();\r\n    loadDeletedTransactions();\r\n  }, [user]);\r\n\r\n  //     \r\n  useEffect(() => {\r\n    if (!user?.uid) return;\r\n    const syncDeleted = async () => {\r\n      try {\r\n        const q = fsQuery(collection(db, 'deletedTransactions'), where('userId', '==', user.uid));\r\n        const snap = await getDocs(q);\r\n        const keys: string[] = [];\r\n        snap.docs.forEach((doc) => {\r\n          const d: any = doc.data();\r\n          const arr = [d.originalTransactionId, d.transactionId, d.reference, doc.id]\r\n            .filter(Boolean)\r\n            .map((v) => String(v));\r\n          keys.push(...arr);\r\n        });\r\n        \r\n        if (keys.length > 0) {\r\n          setPermDeletedSet((prev) => {\r\n            const next = new Set(prev);\r\n            keys.forEach((k) => next.add(k));\r\n            return next;\r\n          });\r\n          \r\n          setTransactions((prev) => prev.filter((t) => {\r\n            const id = String(t.id || '');\r\n            const tid = String((t as any).transactionId || '');\r\n            const ref = String((t as any).reference || '');\r\n            return !(keys.includes(id) || keys.includes(tid) || keys.includes(ref));\r\n          }));\r\n        }\r\n\r\n        //    ( )\r\n        try { \r\n            //          \r\n            userDataService.subscribeDeletedTransactionsLocalSync(user.uid); \r\n        } catch {}\r\n      } catch (e) {\r\n        console.warn('deletedTransactions fetch failed:', e);\r\n      }\r\n    };\r\n    syncDeleted();\r\n  }, [user?.uid]);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        if (!user?.uid) { setPermDeletedSet(new Set()); return; }\r\n        const q = fsQuery(\r\n          collection(db, 'deletedTransactions'),\r\n          where('userId', '==', user.uid),\r\n          where('permanent', '==', true)\r\n        );\r\n        const snap = await getDocs(q);\r\n        const keys: string[] = snap.docs.flatMap(d => {\r\n          const data: any = d.data();\r\n          const arr = [data.originalTransactionId, data.transactionId, data.reference, d.id].filter(Boolean).map(String);\r\n          return arr;\r\n        });\r\n        setPermDeletedSet(new Set(keys));\r\n      } catch {\r\n        setPermDeletedSet(new Set());\r\n      }\r\n    })();\r\n  }, [user?.uid]);\r\n\r\n\r\n  //  React Query   (Cache-first strategy)\r\n  const { data: fetchedTransactions, refetch: refetchTransactions, isFetching } = useQuery({\r\n    queryKey: ['userTransactions', user?.uid],\r\n    queryFn: async () => {\r\n      if (!user?.uid) return [];\r\n      try {\r\n        const q = fsQuery(\r\n          collection(db, 'deletedTransactions'),\r\n          where('userId', '==', user.uid),\r\n          where('permanent', '==', true)\r\n        );\r\n        const [primary, alt, permKeysRes] = await Promise.all([\r\n          userDataService.getUserTransactions(user.uid).catch(() => []),\r\n          (userDataService as any).getByUserId(user.uid).catch(() => []),\r\n          getDocs(q)\r\n            .then((snap) => snap.docs.flatMap(d => {\r\n              const data: any = d.data();\r\n              const arr = [data.originalTransactionId, data.transactionId, data.reference, d.id].filter(Boolean).map(String);\r\n              return arr;\r\n            }))\r\n            .catch(() => [])\r\n        ]);\r\n        const txns = (Array.isArray(primary) && primary.length > 0) ? primary : (Array.isArray(alt) ? alt : []);\r\n        const permSet = new Set(permKeysRes as string[]);\r\n        \r\n        const transactionsWithDates = (txns || [])\r\n          .map((t: any) => ({\r\n            ...t,\r\n            createdAt: t.createdAt instanceof Date ? t.createdAt : new Date(t.createdAt)\r\n          }))\r\n          .filter((t: any) => !(t?.type === 'report' || ((t?.title || '').includes('  '))));\r\n\r\n        const filtered = transactionsWithDates.filter((t: any) => {\r\n          const id = String(t.id || '');\r\n          const tid = String(t.transactionId || '');\r\n          const ref = String(t.reference || t.transactionReference || '');\r\n          return !permSet.has(id) && (!tid || !permSet.has(tid)) && (!ref || !permSet.has(ref));\r\n        });\r\n\r\n        const locals = user?.uid ? userDataService.getLocalReceipts(user.uid) : [];\r\n        const merged = [...filtered, ...(Array.isArray(locals) ? locals : [])];\r\n        const getKey = (t: any) => String(\r\n          t?.transactionId || t?.id || t?.reference || t?.transactionReference || (t?.receipt?.reference) || `${new Date(t?.createdAt || Date.now()).getTime()}`\r\n        );\r\n        const seen = new Set<string>();\r\n        const distinct = merged.filter((t: any) => {\r\n          const k = getKey(t);\r\n          if (seen.has(k)) return false;\r\n          seen.add(k);\r\n          return true;\r\n        });\r\n        return distinct.map(normalizeTransaction) as Transaction[];\r\n      } catch (error) {\r\n        console.error('Error fetching transactions:', error);\r\n        return [];\r\n      }\r\n    },\r\n    enabled: !!user?.uid,\r\n    staleTime: 5 * 60 * 1000, // 5 \r\n  });\r\n\r\n  //         Query\r\n  useEffect(() => {\r\n    if (fetchedTransactions) {\r\n      setTransactions(fetchedTransactions);\r\n    }\r\n  }, [fetchedTransactions]);\r\n\r\n  const loadTransactions = async () => {\r\n    try {\r\n      if (!user) return;\r\n      const q = fsQuery(\r\n        collection(db, 'deletedTransactions'),\r\n        where('userId', '==', user.uid),\r\n        where('permanent', '==', true)\r\n      );\r\n      const [primary, alt, permKeysRes] = await Promise.all([\r\n        userDataService.getUserTransactions(user.uid).catch(() => []),\r\n        (userDataService as any).getByUserId(user.uid).catch(() => []),\r\n        getDocs(q)\r\n          .then((snap) => snap.docs.flatMap(d => {\r\n            const data: any = d.data();\r\n            const arr = [data.originalTransactionId, data.transactionId, data.reference, d.id].filter(Boolean).map(String);\r\n            return arr;\r\n          }))\r\n          .catch(() => [])\r\n      ]);\r\n      const txns = (Array.isArray(primary) && primary.length > 0) ? primary : (Array.isArray(alt) ? alt : []);\r\n      const permSet = new Set(permKeysRes as string[]);\r\n      const transactionsWithDates = (txns || [])\r\n        .map((t: any) => ({\r\n          ...t,\r\n          createdAt: t.createdAt instanceof Date ? t.createdAt : new Date(t.createdAt)\r\n        }))\r\n        //      \r\n        .filter((t: any) => !(t?.type === 'report' || ((t?.title || '').includes('  '))));\r\n      const filtered = transactionsWithDates.filter((t: any) => {\r\n        const id = String(t.id || '');\r\n        const tid = String(t.transactionId || '');\r\n        const ref = String(t.reference || t.transactionReference || '');\r\n        return !permSet.has(id) && (!tid || !permSet.has(tid)) && (!ref || !permSet.has(ref));\r\n      });\r\n      const locals = user?.uid ? userDataService.getLocalReceipts(user.uid) : [];\r\n      const merged = [...filtered, ...(Array.isArray(locals) ? locals : [])];\r\n      const getKey = (t: any) => String(\r\n        t?.transactionId || t?.id || t?.reference || t?.transactionReference || (t?.receipt?.reference) || `${new Date(t?.createdAt || Date.now()).getTime()}`\r\n      );\r\n      const seen = new Set<string>();\r\n      const distinct = merged.filter((t: any) => {\r\n        const k = getKey(t);\r\n        if (seen.has(k)) return false;\r\n        seen.add(k);\r\n        return true;\r\n      });\r\n      setTransactions(distinct.map(normalizeTransaction) as Transaction[]);\r\n    } catch (error) {\r\n      console.error('      Firestore:', error);\r\n      toast({\r\n        title: '   ',\r\n        description: '    Firestore   .      .         .',\r\n        variant: 'destructive'\r\n      });\r\n    }\r\n  };\r\n\r\n  const loadDeletedTransactions = async () => {\r\n    try {\r\n      if (!user) return;\r\n      const deleted = await auditLogService.getDeletedTransactionsByUser(user.uid);\r\n      const deletedWithDates = deleted.map((t: any) => ({\r\n        ...t,\r\n        createdAt: t.createdAt instanceof Date ? t.createdAt : new Date(t.createdAt)\r\n      }));\r\n      setDeletedTransactions(deletedWithDates.map(normalizeTransaction) as Transaction[]);\r\n    } catch (error) {\r\n      console.error('      Firestore:', error);\r\n      toast({\r\n        title: '   ',\r\n        description: '   .      .',\r\n        variant: 'destructive'\r\n      });\r\n    }\r\n  };\r\n\r\n  const effectiveTransactions = React.useMemo(() => {\r\n    const now = new Date();\r\n    const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);\r\n    const nextMonthStart = new Date(now.getFullYear(), now.getMonth() + 1, 1);\r\n    const sorted = [...transactions].sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime());\r\n    return sorted.filter(t => t.createdAt >= monthStart && t.createdAt < nextMonthStart);\r\n  }, [transactions]);\r\n  const hiddenCount = React.useMemo(() => {\r\n    const now = new Date();\r\n    const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);\r\n    const nextMonthStart = new Date(now.getFullYear(), now.getMonth() + 1, 1);\r\n    return Math.max(0, (transactions?.length || 0) - (transactions || []).filter(t => t.createdAt >= monthStart && t.createdAt < nextMonthStart).length);\r\n  }, [transactions?.length]);\r\n\r\n  const filteredTransactions = effectiveTransactions.filter(transaction => {\r\n    const phoneMatch = !searchPhone || \r\n      transaction.senderPhone.includes(searchPhone) || \r\n      transaction.receiverPhone.includes(searchPhone);\r\n    \r\n    const dateMatch = !selectedDate || \r\n      transaction.createdAt.toDateString() === new Date(selectedDate).toDateString();\r\n    \r\n    const timeMatch = !selectedTime || \r\n      transaction.createdAt.toTimeString().startsWith(selectedTime);\r\n    \r\n    return phoneMatch && dateMatch && timeMatch;\r\n  });\r\n\r\n  const getStatusIcon = (status: string, type?: string) => {\r\n    switch (status) {\r\n      case 'completed':\r\n        return <CheckCircle className={`h-4 w-4 ${type === 'withdraw' ? 'text-red-500' : 'text-green-500'}`} />;\r\n      case 'pending':\r\n        return <Clock className=\"h-4 w-4 text-yellow-500\" />;\r\n      case 'cancelled':\r\n        return <XCircle className=\"h-4 w-4 text-red-500\" />;\r\n      default:\r\n        return <Clock className=\"h-4 w-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const getStatusText = (status: string) => {\r\n    switch (status) {\r\n      case 'completed':\r\n        return '';\r\n      case 'pending':\r\n        return ' ';\r\n      case 'cancelled':\r\n        return '';\r\n      default:\r\n        return ' ';\r\n    }\r\n  };\r\n\r\n  //           \r\n  const normalizeTransaction = (raw: any): Transaction => {\r\n    const statusRaw = (raw?.status ?? '').toString().toLowerCase();\r\n    const normalizedStatus: Transaction['status'] =\r\n      statusRaw === 'confirmed' || statusRaw === 'success' || statusRaw === 'completed'\r\n        ? 'completed'\r\n        : statusRaw === 'failed' || statusRaw === 'error' || statusRaw === 'cancelled' || statusRaw === 'canceled'\r\n        ? 'cancelled'\r\n        : 'pending';\r\n\r\n    const typeRaw = (raw?.type ?? raw?.txnType ?? '').toString().toLowerCase();\r\n    const normalizedType: Transaction['type'] = typeRaw === 'withdraw' ? 'withdraw' : 'send';\r\n\r\n    const sender =\r\n      raw?.senderPhone ?? raw?.senderMsisdn ?? raw?.sender_msisdn ?? raw?.sender ?? raw?.from ?? '';\r\n    const receiver =\r\n      raw?.receiverPhone ?? raw?.receiverMsisdn ?? raw?.receiver_msisdn ?? raw?.receiver ?? raw?.to ?? '';\r\n\r\n    const createdAtVal = raw?.createdAt;\r\n    const createdAt =\r\n      createdAtVal instanceof Date\r\n        ? createdAtVal\r\n        : createdAtVal?.toDate\r\n        ? createdAtVal.toDate()\r\n        : new Date(createdAtVal);\r\n\r\n    return {\r\n      id: raw?.id,\r\n      senderPhone: sender || ' ',\r\n      receiverPhone: receiver || ' ',\r\n      amount: Number(raw?.amount ?? 0),\r\n      status: normalizedStatus,\r\n      type: normalizedType,\r\n      createdAt,\r\n      provider: raw?.provider ?? undefined,\r\n      commission: raw?.commission ?? undefined,\r\n      withdrawnAmount: raw?.withdrawnAmount ?? undefined,\r\n      sentAmount: raw?.sentAmount ?? undefined,\r\n      fromWallet: raw?.fromWallet ?? raw?.walletId ?? undefined,\r\n      cashierName: raw?.cashierName ?? raw?.createdByName ?? raw?.cashier ?? undefined,\r\n      commissionMode: raw?.commissionMode ?? raw?.commission_mode ?? undefined,\r\n      totalCharged: raw?.totalCharged ?? undefined,\r\n      walletEffectAppliedOnCreation: raw?.walletEffectAppliedOnCreation ?? raw?.effectsAppliedOnCreation ?? raw?.effectAppliedOnCreation ?? false,\r\n      cashEffectAppliedOnCreation: raw?.cashEffectAppliedOnCreation ?? false,\r\n      fee: raw?.fee ?? undefined,\r\n      senderName: raw?.senderName ?? raw?.customerName ?? undefined,\r\n    };\r\n  };\r\n\r\n  const mapToReceiptTransaction = (t: Transaction) => {\r\n    const p = String((t as any)?.provider || '').toLowerCase();\r\n    const short = p.includes('vodafone') ? 'vf-cash' : (p.includes('instapay') ? 'instapay' : '');\r\n    const baseTitle = t.type === 'send' ? '' : '';\r\n    const title = (t.type === 'withdraw' && short) ? `${baseTitle} ${short}` : baseTitle;\r\n    return {\r\n      id: t.id,\r\n      type: t.type === 'send' ? 'transfer' : 'withdraw',\r\n      sender_msisdn: t.senderPhone,\r\n      receiver_msisdn: t.receiverPhone,\r\n      amount: t.amount,\r\n      commission: t.commission || 0,\r\n      status: t.status === 'cancelled' ? 'failed' : t.status,\r\n      createdAt: t.createdAt.toISOString(),\r\n      updatedAt: t.createdAt.toISOString(),\r\n      shopName: shopName ?? profile?.shopName ?? user?.displayName ?? '',\r\n      //          \r\n      cashierName: (t as any)?.cashierName ?? null,\r\n      commissionMode: (t as any)?.commissionMode ?? undefined,\r\n      totalCharged: (t as any)?.totalCharged ?? undefined,\r\n      fee: (t as any)?.fee ?? undefined,\r\n      note: (t as any)?.note ?? (t as any)?.notes ?? undefined,\r\n      senderName: (t as any)?.senderName ?? undefined,\r\n      provider: (t as any)?.provider ?? undefined,\r\n      title\r\n    };\r\n  };\r\n\r\n  const handleTransactionClick = (transaction: Transaction) => {\r\n    const receiptData = mapToReceiptTransaction(transaction);\r\n    setReceiptTransaction(receiptData);\r\n    setIsReceiptOpen(true);\r\n  };\r\n\r\n  const handleOpenRestoreDialog = (tx: Transaction) => {\r\n    setPendingRestoreTx(tx);\r\n    setIsRestoreConfirmOpen(true);\r\n  };\r\n\r\n  const handleConfirmRestore = async () => {\r\n    if (!pendingRestoreTx) return;\r\n    await restoreTransaction(pendingRestoreTx.id);\r\n    setIsRestoreConfirmOpen(false);\r\n    setPendingRestoreTx(null);\r\n  };\r\n\r\n  const restoreTransaction = async (transactionId: string) => {\r\n    try {\r\n      const transactionToRestore = deletedTransactions.find(t => t.id === transactionId);\r\n      if (!transactionToRestore || !user) return;\r\n\r\n      //      Firestore  userTransactions\r\n      const newId = await userDataService.saveUserTransaction(user.uid, {\r\n        ...transactionToRestore,\r\n        userId: user.uid,\r\n        status: 'completed',\r\n        cashierName: transactionToRestore.cashierName ?? ' '\r\n      });\r\n\r\n      //      Firestore\r\n      await auditLogService.permanentlyDeleteTransaction(transactionId, user.uid);\r\n\r\n      //  \r\n      const restored = { ...transactionToRestore, id: newId } as Transaction;\r\n      setTransactions(prev => [...prev, restored]);\r\n      setDeletedTransactions(prev => prev.filter(t => t.id !== transactionId));\r\n      toast({ title: ' ', description: '    .' });\r\n    } catch (error) {\r\n      console.error('     Firestore:', error);\r\n      toast({ title: ' ', description: '     .', variant: 'destructive' });\r\n    }\r\n  };\r\n\r\n  const permanentlyDeleteTransaction = async (transactionId: string) => {\r\n    try {\r\n      if (!user) return;\r\n      //      \r\n      setDeletedTransactions(prev => prev.filter(t => t.id !== transactionId));\r\n\r\n      //    Firebase (deletedTransactions + userTransactions + transactions)\r\n      await auditLogService.permanentlyDeleteTransaction(transactionId, user.uid);\r\n      await userDataService.removeUserTransaction(user.uid, transactionId);\r\n\r\n      toast({ title: '  ', description: '    .' });\r\n    } catch (error) {\r\n      console.error('   :', error);\r\n      toast({ title: '   ', description: '     .', variant: 'destructive' });\r\n    }\r\n  };\r\n\r\n  //  :     \r\n  const handleCompleteReceipt = async (transactionId: string) => {\r\n    try {\r\n      const tx = transactions.find(t => t.id === transactionId);\r\n      if (!tx || !user) return;\r\n\r\n      //   : 5   /\r\n      try {\r\n        const plan = userSubscription?.subscription?.planType;\r\n        if (plan === SubscriptionPlan.ZERO) {\r\n          const { dailyOperationCountService } = await import('@/utils/dailyOperationCountService');\r\n          const opType = tx.type === 'send' ? 'transfer' : 'withdraw';\r\n          const res = await dailyOperationCountService.checkAndIncrement(user.uid, opType, 5);\r\n          if (!res.allowed) {\r\n            toast({\r\n              title: '    ',\r\n              description: '   5   /.     .',\r\n              variant: 'destructive',\r\n            });\r\n            return;\r\n          }\r\n        } else if (plan === SubscriptionPlan.TAHWEELA) {\r\n          const { dailyOperationCountService } = await import('@/utils/dailyOperationCountService');\r\n          const opType = tx.type === 'send' ? 'transfer' : 'withdraw';\r\n          const res = await dailyOperationCountService.checkAndIncrementCombined(user.uid, opType, 40);\r\n          if (!res.allowed) {\r\n            toast({\r\n              title: '    ',\r\n              description: '     40  / .',\r\n              variant: 'destructive',\r\n            });\r\n            return;\r\n          }\r\n        }\r\n      } catch (limitErr) {\r\n        console.warn('     :', limitErr);\r\n      }\r\n\r\n      //      Firebase    \r\n      const userProfile = await profileService.getById(user.uid);\r\n      if (!userProfile?.shopId) {\r\n        throw new Error('     (shopId) ');\r\n      }\r\n      const dataRef = doc(db, 'dashboardData', userProfile.shopId);\r\n      const dataSnap = await getDoc(dataRef);\r\n      let cashBalance = dataSnap.exists() ? Number((dataSnap.data() as any)?.cashBalance || 0) : 0;\r\n      const walletBalances: Record<string, number> = dataSnap.exists() ? ((dataSnap.data() as any)?.walletBalances || {}) : {};\r\n\r\n      const fromWalletIdForLimits = tx.fromWallet || Object.keys(walletBalances)[0];\r\n      const alreadyReservedLimits = Boolean((tx as any)?.limitsReservedOnCreation);\r\n      const checkAmt = Number(tx.withdrawnAmount ?? tx.sentAmount ?? tx.amount ?? 0);\r\n      const checkType = tx.type === 'send' ? 'transfer' : 'withdraw';\r\n      try {\r\n        const { walletDailyLimitsService } = await import('@/utils/walletDailyLimitsService');\r\n        const can = await walletDailyLimitsService.canPerformOperation(fromWalletIdForLimits, checkAmt, checkType);\r\n        if (!alreadyReservedLimits && !can.canPerform) {\r\n          toast({ title: ' ', description: String(can.message || '     /'), variant: 'destructive' });\r\n          return;\r\n        }\r\n      } catch {\r\n        toast({ title: '   ', description: '   ', variant: 'destructive' });\r\n        return;\r\n      }\r\n\r\n      //      \r\n      let didAddCashNow = false;\r\n      if (tx.type === 'withdraw') {\r\n        const fromWalletId = tx.fromWallet || Object.keys(walletBalances)[0];\r\n        const amount = Number(tx.withdrawnAmount ?? tx.amount ?? 0);\r\n        const commission = Number(tx.commission ?? 0);\r\n\r\n        //         \r\n        const alreadyAppliedOnCreationWallet = Boolean((tx as any)?.walletEffectAppliedOnCreation);\r\n        const alreadyAppliedOnCreationCash = Boolean((tx as any)?.cashEffectAppliedOnCreation);\r\n\r\n        if (!alreadyAppliedOnCreationWallet && fromWalletId && amount > 0) {\r\n          const current = walletBalances[fromWalletId] || 0;\r\n          walletBalances[fromWalletId] = current + amount; //        \r\n        }\r\n\r\n        if (alreadyAppliedOnCreationCash) {\r\n          cashBalance = cashBalance + amount; //    ()  \r\n        } else {\r\n          cashBalance = cashBalance - amount; //    ()  \r\n        }\r\n        didAddCashNow = true;\r\n\r\n        //      Firebase\r\n        await updateDoc(dataRef, { cashBalance, walletBalances });\r\n      } else if (tx.type === 'send') {\r\n        const commission = Number(tx.commission ?? 0);\r\n        const fee = Number((tx as any)?.fee ?? 0);\r\n        const amountToAdd = Number((tx as any)?.sentAmount ?? (tx as any)?.transferredAmount ?? tx.amount ?? 0);\r\n        const toAdd = Math.max(0, amountToAdd) + Math.max(0, fee); //   ()  \r\n        if (toAdd > 0) {\r\n          cashBalance = cashBalance + toAdd;\r\n          await updateDoc(dataRef, { cashBalance });\r\n          didAddCashNow = true;\r\n        }\r\n      }\r\n\r\n      await updateDoc(doc(db, 'userTransactions', transactionId), {\r\n        status: 'completed',\r\n        confirmedAt: new Date()\r\n      });\r\n\r\n      try {\r\n        const fromWalletId = tx.fromWallet || Object.keys(walletBalances)[0];\r\n        const amt = Number(tx.withdrawnAmount ?? tx.sentAmount ?? tx.amount ?? 0);\r\n        if (fromWalletId && amt > 0 && !alreadyReservedLimits) {\r\n          const { walletDailyLimitsService } = await import('@/utils/walletDailyLimitsService');\r\n          await walletDailyLimitsService.updateUsage(fromWalletId, amt, tx.type === 'send' ? 'transfer' : 'withdraw');\r\n        }\r\n      } catch {\r\n        toast({ title: '  ', description: '  /  ', variant: 'destructive' });\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const { ProfitService } = await import('@/utils/profitService');\r\n        const profit = ProfitService.calculateProfitFromTransaction({\r\n          type: tx.type === 'send' ? 'transfer' : 'withdraw',\r\n          amount: Number(tx.amount || 0),\r\n          commission: Number(tx.commission || 0),\r\n          fee: Number((tx as any)?.fee || 0)\r\n        });\r\n        const alreadyAdded = Boolean((tx as any)?.profitAddedOnCreation);\r\n        if (!alreadyAdded && profit > 0) {\r\n          ProfitService.addProfit(profit, user?.uid);\r\n        }\r\n      } catch {}\r\n\r\n      setTransactions(prev => prev.map(t => t.id === transactionId ? { ...t, status: 'completed' } : t));\r\n      toast({ title: ' ', description: '   .' });\r\n      setIsReceiptOpen(false);\r\n    } catch (error) {\r\n      console.error('   :', error);\r\n      toast({ title: ' ', description: '     .', variant: 'destructive' });\r\n    }\r\n  };\r\n\r\n  //         \r\n  const handleDeleteReceipt = async (transactionId: string) => {\r\n    try {\r\n      const tx = transactions.find(t => t.id === transactionId);\r\n      if (!tx || !user) return;\r\n\r\n      //        \r\n      setTransactions(prev => prev.filter(t => t.id !== transactionId));\r\n      setDeletedTransactions(prev => [{ ...tx }, ...prev]);\r\n\r\n      //          +   \r\n      let finalStatus = tx.status;\r\n      try {\r\n        //       transactionId/reference    \r\n        let rawTx: any = {};\r\n        try {\r\n          const snap = await getDoc(doc(db, 'userTransactions', transactionId));\r\n          rawTx = snap.exists() ? (snap.data() as any) : {};\r\n\r\n          //            \r\n          if (rawTx?.status) {\r\n            const s = String(rawTx.status).toLowerCase();\r\n            if (s === 'completed' || s === 'confirmed' || s === 'success') finalStatus = 'completed';\r\n            else if (s === 'pending') finalStatus = 'pending';\r\n            else if (s === 'cancelled' || s === 'failed') finalStatus = 'cancelled';\r\n          }\r\n        } catch {}\r\n        const originalId = transactionId;\r\n        const linkedTxnId = String(rawTx?.transactionId || (tx as any)?.transactionId || originalId);\r\n        const linkedRef = String(\r\n          rawTx?.reference || rawTx?.transactionReference ||\r\n          (tx as any)?.reference || (tx as any)?.transactionReference || ''\r\n        );\r\n\r\n        await userDataService.removeUserTransaction(user.uid, transactionId);\r\n        await auditLogService.saveDeletedTransaction({\r\n          ...tx,\r\n          userId: user.uid,\r\n          originalTransactionId: transactionId,\r\n          transactionId: linkedTxnId,\r\n          reference: linkedRef || undefined,\r\n          permanent: true\r\n        });\r\n        try {\r\n          await auditLogService.permanentlyDeleteTransaction(transactionId, user.uid);\r\n        } catch {}\r\n      } catch (e) {\r\n        console.warn('                  :', e);\r\n      }\r\n\r\n      //       Firebase    \r\n      try {\r\n        const userProfile = await profileService.getById(user.uid);\r\n        if (!userProfile?.shopId) {\r\n          throw new Error('     (shopId) ');\r\n        }\r\n        const dataRef = doc(db, 'dashboardData', userProfile.shopId);\r\n        const dataSnap = await getDoc(dataRef);\r\n        let cashBalance: number = dataSnap.exists() ? Number((dataSnap.data() as any)?.cashBalance || 0) : 0;\r\n        const walletBalances: Record<string, number> = dataSnap.exists() ? ((dataSnap.data() as any)?.walletBalances || {}) : {};\r\n\r\n        const amount = Number(tx.withdrawnAmount ?? tx.amount ?? 0);\r\n        const commission = Number(tx.commission ?? 0);\r\n        const fromWalletId = tx.fromWallet || Object.keys(walletBalances)[0];\r\n\r\n        //          \r\n        const wasAppliedOnCreation = Boolean((tx as any)?.walletEffectAppliedOnCreation);\r\n\r\n        //   /\r\n        if (tx.type === 'send') {\r\n          //  :     +  ( )    .\r\n          //  :        .\r\n          const fee = Number(tx.fee ?? 0);\r\n          const sentAmount = Number((tx as any)?.sentAmount ?? (tx as any)?.transferredAmount ?? tx.amount ?? 0);\r\n          \r\n          if (finalStatus === 'completed') {\r\n            // :         .   +  .\r\n            cashBalance = cashBalance - (sentAmount + fee);\r\n          }\r\n          if (fromWalletId && sentAmount > 0) {\r\n            const current = walletBalances[fromWalletId] || 0;\r\n            walletBalances[fromWalletId] = current + sentAmount; //   \r\n          }\r\n        } else if (tx.type === 'withdraw') {\r\n          if (finalStatus === 'completed') {\r\n            //  :    .\r\n            //  :   .       .\r\n            cashBalance = cashBalance + amount; \r\n            \r\n            if (fromWalletId && amount > 0) {\r\n              const current = walletBalances[fromWalletId] || 0;\r\n              walletBalances[fromWalletId] = current - amount; //        \r\n            }\r\n          } else {\r\n            //    ( ):       \r\n            if (fromWalletId && wasAppliedOnCreation && amount > 0) {\r\n              const current = walletBalances[fromWalletId] || 0;\r\n              walletBalances[fromWalletId] = current - amount; //     \r\n            }\r\n            //          \r\n          }\r\n        }\r\n\r\n        //      Firebase\r\n        await updateDoc(dataRef, { cashBalance, walletBalances });\r\n      } catch (e) {\r\n        console.warn('    :', e);\r\n      }\r\n\r\n      //   / \r\n      try {\r\n        const fromWalletId = tx.fromWallet;\r\n        if (fromWalletId) {\r\n          const { walletDailyLimitsService } = await import('@/utils/walletDailyLimitsService');\r\n          //  rollbackUsage       DashboardPage\r\n          const amt = Number(tx.withdrawnAmount ?? tx.sentAmount ?? tx.amount ?? 0);\r\n          const opType = tx.type === 'send' ? 'transfer' : 'withdraw';\r\n          await walletDailyLimitsService.rollbackUsage(fromWalletId, amt, opType, tx.createdAt);\r\n        }\r\n      } catch (e) {\r\n        console.warn('   :', e);\r\n      }\r\n\r\n      //      \r\n      try {\r\n        const { ProfitService } = await import('@/utils/profitService');\r\n        const { ReportsService } = await import('@/utils/reportsService');\r\n        const txnType = tx.type === 'send' ? 'send' : 'receive';\r\n        const transactionData: any = {\r\n          txnType,\r\n          amount: tx.amount,\r\n          commission: tx.commission || 0,\r\n          createdAt: tx.createdAt,\r\n          status: 'confirmed'\r\n        };\r\n        //        \r\n        const profit = ProfitService.calculateProfitFromTransaction(transactionData);\r\n        if (profit > 0) {\r\n          ProfitService.addProfit(-profit, user.uid);\r\n        }\r\n        //    / (   )\r\n        try {\r\n          ReportsService.removeTransactionEffects(tx, user.uid);\r\n        } catch {}\r\n      } catch (e) {\r\n        console.warn('  /  :', e);\r\n      }\r\n    } catch (error) {\r\n      console.error('   :', error);\r\n    }\r\n  };\r\n\r\n  //   :            Firestore \r\n  const autoTestRanRef = useRef(false);\r\n  const location = useLocation();\r\n  useEffect(() => {\r\n    const params = new URLSearchParams(location.search);\r\n    const shouldRun = params.get('autoTestBalances') === '1';\r\n    if (!shouldRun || autoTestRanRef.current) return;\r\n    autoTestRanRef.current = true;\r\n\r\n    (async () => {\r\n      try {\r\n        if (!user) return;\r\n        const profile = await profileService.getById(user.uid);\r\n        if (!profile?.shopId) {\r\n          console.warn('autoTest:   shopId    .');\r\n          return;\r\n        }\r\n\r\n        //        \r\n        const dataRef = doc(db, 'dashboardData', profile.shopId);\r\n        const snapBefore = await getDoc(dataRef);\r\n        const beforeCash = snapBefore.exists() ? Number((snapBefore.data() as any)?.cashBalance || 0) : 0;\r\n        const beforeWallets: Record<string, number> = snapBefore.exists() ? ((snapBefore.data() as any)?.walletBalances || {}) : {};\r\n        const fromWalletId = Object.keys(beforeWallets)[0] || undefined;\r\n\r\n        //            \r\n        const amount = 100;\r\n        const commission = 5;\r\n\r\n        //      pending\r\n        const newId = await userDataService.saveUserTransaction(user.uid, {\r\n          senderPhone: 'auto-test-sender',\r\n          receiverPhone: 'auto-test-receiver',\r\n          amount,\r\n          status: 'pending',\r\n          type: 'withdraw',\r\n          createdAt: new Date(),\r\n          reference: `AUTO-${Date.now()}`,\r\n          commission,\r\n          withdrawnAmount: amount,\r\n          fromWallet: fromWalletId,\r\n          cashierName: 'AutoTest',\r\n          commissionMode: 'add',\r\n          totalCharged: amount + commission,\r\n          walletEffectAppliedOnCreation: false\r\n        });\r\n\r\n        console.log('autoTest:     :', newId);\r\n\r\n        //       Firestore\r\n        await handleCompleteReceipt(newId);\r\n\r\n        const snapAfterComplete = await getDoc(dataRef);\r\n        const afterCashComplete = snapAfterComplete.exists() ? Number((snapAfterComplete.data() as any)?.cashBalance || 0) : 0;\r\n        const afterWalletsComplete: Record<string, number> = snapAfterComplete.exists() ? ((snapAfterComplete.data() as any)?.walletBalances || {}) : {};\r\n\r\n        //    \r\n        const expectedCashAfter = beforeCash - amount + commission;\r\n        const expectedWalletAfter = fromWalletId ? (Number(beforeWallets[fromWalletId] || 0) + amount) : undefined;\r\n        console.log('autoTest:    :', expectedCashAfter, ':', afterCashComplete);\r\n        if (fromWalletId) {\r\n          console.log('autoTest:    :', expectedWalletAfter, ':', afterWalletsComplete[fromWalletId]);\r\n        }\r\n\r\n        //    \r\n        await handleDeleteReceipt(newId);\r\n\r\n        const snapAfterDelete = await getDoc(dataRef);\r\n        const afterCashDelete = snapAfterDelete.exists() ? Number((snapAfterDelete.data() as any)?.cashBalance || 0) : 0;\r\n        const afterWalletsDelete: Record<string, number> = snapAfterDelete.exists() ? ((snapAfterDelete.data() as any)?.walletBalances || {}) : {};\r\n\r\n        console.log('autoTest:     / :', beforeCash, afterCashDelete);\r\n        if (fromWalletId) {\r\n          console.log('autoTest:     / :', beforeWallets[fromWalletId] || 0, afterWalletsDelete[fromWalletId] || 0);\r\n        }\r\n\r\n        toast({ title: '  (Firestore )', description: ' //     .', variant: 'default' });\r\n      } catch (err) {\r\n        console.error('autoTest:   :', err);\r\n        toast({ title: '  ', description: '    shopId   Firestore.', variant: 'destructive' });\r\n      }\r\n    })();\r\n  }, [location.search, user]);\r\n\r\n  //     API\r\n  const submitTopUp = async () => {\r\n    //        \r\n    const allowedEmail = 'alkaptin678678@gmail.com';\r\n    const userEmail = auth.currentUser?.email?.toLowerCase();\r\n    if (!userEmail || userEmail !== allowedEmail) {\r\n      toast({ title: ' ', description: '      .' });\r\n      return;\r\n    }\r\n    if (!topupPhone || !topupOperator || !topupAmount) {\r\n      toast({ title: ' ', description: '    ', variant: 'destructive' });\r\n      return;\r\n    }\r\n    setTopupLoading(true);\r\n    try {\r\n      //       \r\n      const serverOperatorNameMap: Record<string, string> = {\r\n        vodafone_eg: 'Vodafone',\r\n        orange_eg: 'Orange',\r\n        etisalat_eg: 'Etisalat',\r\n        we_eg: 'WE',\r\n      };\r\n      const operatorToSend = serverOperatorNameMap[topupOperator] ?? topupOperator;\r\n\r\n      //      \r\n      const controller = new AbortController();\r\n      const timeout = setTimeout(() => controller.abort(), 15000);\r\n\r\n      const idToken = await auth.currentUser?.getIdToken();\r\n      const resp = await fetch('/api/topup', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          ...(idToken ? { Authorization: `Bearer ${idToken}` } : {}),\r\n        },\r\n        body: JSON.stringify({\r\n          phone: topupPhone,\r\n          countryCode: 'EG',\r\n          operator: operatorToSend,\r\n          amount: Number(topupAmount),\r\n          useLocalAmount: true,\r\n        }),\r\n        signal: controller.signal,\r\n      });\r\n      clearTimeout(timeout);\r\n\r\n      //        JSON  \r\n      const rawText = await resp.text();\r\n      let data: any;\r\n      try {\r\n        data = JSON.parse(rawText);\r\n      } catch {\r\n        data = { success: false, message: rawText || '   ' };\r\n      }\r\n      if (resp.ok && data?.success) {\r\n        toast({ title: ' ', description: data?.message || '    ' });\r\n        setIsTopUpOpen(false);\r\n        setTopupPhone('');\r\n        setTopupOperator('');\r\n        setTopupAmount('');\r\n      } else {\r\n        toast({ title: ' ', description: data?.message || '    ', variant: 'destructive' });\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Topup request error:', err);\r\n      if (err?.name === 'AbortError') {\r\n        toast({ title: ' ', description: '     .    .', variant: 'destructive' });\r\n      } else {\r\n        toast({ title: '  ', description: '  .  .', variant: 'destructive' });\r\n      }\r\n    } finally {\r\n      setTopupLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 overscroll-y-none overflow-y-auto bg-background p-4\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center gap-4 mb-6\">\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            onClick={() => navigate('/user/dashboard')}\r\n            className=\"flex items-center gap-2 text-gray-600 hover:text-gray-800\"\r\n          >\r\n            <ArrowLeft className=\"h-4 w-4\" />\r\n            \r\n          </Button>\r\n          <h1 className=\"text-2xl font-bold text-gray-800\"></h1>\r\n        </div>\r\n\r\n        {/* Transactions List */}\r\n        <Card className=\"card-modern fade-in-up\">\r\n          <CardHeader className=\"pb-2 px-3 pt-3\">\r\n            <CardTitle className=\"text-sm font-bold\"> </CardTitle>\r\n            \r\n            {/*     */}\r\n            <div className=\"flex items-center gap-0.5 mt-1 relative\">\r\n              {/*    */}\r\n              <div className=\"flex items-center gap-0.5 flex-1 bg-gray-50 rounded px-1 py-0.5 border border-gray-200 hover:border-blue-300 transition-all duration-200 group relative overflow-hidden max-w-[140px] md:max-w-[220px]\">\r\n                <Search className=\"h-2 w-2 text-gray-400 group-hover:text-blue-600 transition-colors\" />\r\n                <Input\r\n                  placeholder=\"...\"\r\n                  value={searchPhone}\r\n                  onChange={(e) => setSearchPhone(e.target.value)}\r\n                  className=\"h-3 text-[8px] border-0 bg-transparent focus:ring-0 focus:outline-none text-gray-700 placeholder:text-gray-400\"\r\n                />\r\n              </div>\r\n              \r\n              \r\n              {/*         */}\r\n              <div className=\"hidden md:flex items-center gap-1\">\r\n                {/*       */}\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"relative h-5 w-5 p-0 rounded bg-red-50 text-red-600 hover:bg-red-100 border border-red-200 hover:border-red-300 transition-all duration-200 hover:scale-105\"\r\n                    onClick={openGuide}\r\n                    title=\" \"\r\n                  >\r\n                    <div className=\"relative inline-flex items-center justify-center h-full w-full\">\r\n                      <PlayCircle className=\"h-2.5 w-2.5\" />\r\n                      {hasNewGuide && (\r\n                        <div className=\"absolute -top-0.5 -right-0.5 h-1 w-1 bg-red-600 rounded-full\"></div>\r\n                      )}\r\n                    </div>\r\n                  </Button>\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n                {/*      */}\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"h-5 w-5 p-0 rounded bg-purple-50 text-purple-600 hover:bg-purple-100 border border-purple-200 hover:border-purple-300 transition-all duration-200 hover:scale-105\"\r\n                    onClick={() => {\r\n                      if (isZeroPlan || isTahweelaPlan) {\r\n                        toast({ title: ' ', description: '      .', variant: 'destructive' });\r\n                        return;\r\n                      }\r\n                      setIsInstallmentPinOpen(true);\r\n                    }}\r\n                    title=\" \"\r\n                  >\r\n                    <BadgePercent className=\"h-2.5 w-2.5\" />\r\n                  </Button>\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n                \r\n                {/*   ( + ) */}\r\n                <div className=\"flex items-center gap-1\">\r\n                  <TotalProfitEyeButton userId={user?.uid} transactions={transactions as any[]} />\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n                {/*     */}\r\n                 <div className=\"flex items-center gap-1\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"h-5 w-5 p-0 rounded bg-emerald-50 text-emerald-600 hover:bg-emerald-100 border border-emerald-200 hover:border-emerald-300 transition-all duration-200 hover:scale-105\"\r\n                    onClick={() => { toast({ title: ' ', description: '    .' }); }}\r\n                    title=\"  \"\r\n                  >\r\n                    <CreditCard className=\"h-2.5 w-2.5\" />\r\n                  </Button>\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n\r\n                {/*   */}\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"h-5 w-5 p-0 rounded bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200 hover:border-blue-300 transition-all duration-200 hover:scale-105\"\r\n                    onClick={() => setIsCalculatorOpen(true)}\r\n                    title=\" \"\r\n                  >\r\n                    <Calculator className=\"h-2.5 w-2.5\" />\r\n                  </Button>\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n                \r\n                {/*   */}\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"h-5 w-5 p-0 rounded bg-green-50 text-green-600 hover:bg-green-100 border border-green-200 hover:border-green-300 transition-all duration-200 hover:scale-105\"\r\n                    onClick={() => {\r\n                      if (isZeroPlan) {\r\n                        toast({ title: '   ', description: '      .  .' });\r\n                        return;\r\n                      }\r\n                      setIsSalesDataOpen(true);\r\n                    }}\r\n                    title=\" \"\r\n                  >\r\n                    <BarChart className=\"h-2.5 w-2.5\" />\r\n                  </Button>\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n                \r\n                {/*   */}\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className={`h-5 w-5 p-0 rounded border transition-all duration-200 hover:scale-105 ${\r\n                      selectedDate || selectedTime \r\n                        ? 'bg-purple-100 text-purple-600 border-purple-300' \r\n                        : 'bg-purple-50 text-purple-600 hover:bg-purple-100 border-purple-200 hover:border-purple-300'\r\n                    }`}\r\n                    onClick={() => setIsDatePickerOpen(true)}\r\n                    title=\" \"\r\n                  >\r\n                    <Calendar className=\"h-2.5 w-2.5\" />\r\n                    {(selectedDate || selectedTime) && (\r\n                      <div className=\"absolute -top-0.5 -right-0.5 h-1 w-1 bg-purple-500 rounded-full\"></div>\r\n                    )}\r\n                  </Button>\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n                \r\n                {/*  */}\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"relative h-5 w-5 p-0 rounded bg-orange-50 text-orange-600 hover:bg-orange-100 border border-orange-200 hover:border-orange-300 transition-all duration-200 hover:scale-105\"\r\n                    onClick={() => {\r\n                      if (isZeroPlan) {\r\n                        toast({ title: '   ', description: '      .  .' });\r\n                        return;\r\n                      }\r\n                      setIsDebtsPasswordDialogOpen(true);\r\n                    }}\r\n                    title=\" \"\r\n                  >\r\n                    <div className=\"relative inline-flex items-center justify-center h-full w-full\">\r\n                      <FileText className=\"h-2.5 w-2.5\" />\r\n                      {pendingDebtsCount > 0 && (\r\n                        <div className=\"absolute -top-1 -right-1 z-10 min-w-[12px] h-[12px] px-[2px] bg-red-600 text-white rounded-full text-[8px] leading-[12px] flex items-center justify-center pointer-events-none ring-1 ring-white\">\r\n                          {pendingDebtsCount}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </Button\r\n                  >\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n\r\n                {/*  */}\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"h-5 w-5 p-0 rounded bg-amber-50 text-amber-700 hover:bg-amber-100 border border-amber-200 hover:border-amber-300 transition-all duration-200 hover:scale-105\"\r\n                    onClick={() => {\r\n                      if (isZeroPlan) {\r\n                        toast({ title: '   ', description: '     .  .' });\r\n                        return;\r\n                      }\r\n                      setIsMaintenanceOpen(true);\r\n                    }}\r\n                    title=\"\"\r\n                  >\r\n                    <Wrench className=\"h-2.5 w-2.5\" />\r\n                  </Button>\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n                \r\n                {/*     */}\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"h-5 w-5 p-0 rounded bg-violet-50 text-violet-600 hover:bg-violet-100 border border-violet-200 hover:border-violet-300 transition-all duration-200 hover:scale-105\"\r\n                    onClick={() => {\r\n                      navigate('/user/dashboard', { state: { openCashierShiftModal: true } });\r\n                    }}\r\n                    title=\" \"\r\n                  >\r\n                    <BatteryCharging className=\"h-2.5 w-2.5\" />\r\n                  </Button>\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n                \r\n                {/*   -      */}\r\n                <div className=\"hidden sm:flex items-center gap-1\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"h-5 w-5 p-0 rounded bg-indigo-50 text-indigo-600 hover:bg-indigo-100 border border-indigo-200 hover:border-indigo-300 transition-all duration-200 hover:scale-105\"\r\n                    onClick={() => {\r\n                      if (isZeroPlan) {\r\n                        toast({ title: '   ', description: '      .  .' });\r\n                        return;\r\n                      }\r\n                      setIsCreditCardsOpen(true);\r\n                    }}\r\n                    title=\" \"\r\n                  >\r\n                    <CreditCard className=\"h-2.5 w-2.5\" />\r\n                  </Button>\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n\r\n                {/*    */}\r\n                <div className=\"flex items-center gap-1\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className={`h-5 w-5 p-0 rounded bg-red-50 text-red-600 hover:bg-red-100 border border-red-200 hover:border-red-300 transition-all duration-200 hover:scale-105 relative`}\r\n                    onClick={() => {\r\n                      setIsResetRecentDialogOpen(true);\r\n                    }}\r\n                    title=\"  \"\r\n                  >\r\n                    <Trash2 className=\"h-2.5 w-2.5\" />\r\n                    {hiddenCount > 0 && (\r\n                      <div className=\"absolute -top-0.5 -right-0.5 h-1 w-1 bg-red-500 rounded-full\"></div>\r\n                    )}\r\n                  </Button>\r\n                  <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                </div>\r\n                \r\n                {/*    */}\r\n                {(searchPhone || selectedDate || selectedTime) && (\r\n                  <div className=\"flex items-center gap-1\">\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      className=\"h-5 w-5 p-0 rounded bg-red-50 text-red-500 hover:bg-red-100 border border-red-200 hover:border-red-300 transition-all duration-200 hover:scale-105\"\r\n                      onClick={() => {\r\n                        setSearchPhone('');\r\n                        setSelectedDate('');\r\n                        setSelectedTime('');\r\n                      }}\r\n                      title=\"\"\r\n                    >\r\n                      <span className=\"text-[10px] font-bold\"></span>\r\n                    </Button>\r\n                    <span className=\"text-[10px] font-bold text-gray-700\"></span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent className=\"px-3 pb-3\">\r\n            <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n              <TabsList className=\"hidden sm:grid w-full grid-cols-4 h-10 text-sm bg-gradient-to-r from-gray-50 via-blue-50/30 to-purple-50/30 border border-gray-200/60 rounded-md p-1 shadow-sm relative overflow-hidden\">\r\n                {/*    */}\r\n                <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/5 via-purple-500/5 to-pink-500/5 opacity-0 hover:opacity-100 transition-all duration-200\"></div>\r\n                \r\n                <TabsTrigger \r\n                  value=\"all\" \r\n                  className=\"text-sm relative z-10 rounded transition-all duration-300  data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-blue-600 data-[state=active]:text-white data-[state=active]:shadow-md data-[state=active]:shadow-blue-200/50 hover:bg-blue-50/80 hover:text-blue-700 group\"\r\n                >\r\n                  <span className=\"relative z-10\"></span>\r\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 opacity-0 group-hover:opacity-100 transition-all duration-300 rounded\"></div>\r\n                </TabsTrigger>\r\n                \r\n                <TabsTrigger \r\n                  value=\"send\" \r\n                  className=\"text-sm relative z-10 rounded transition-all duration-300  data-[state=active]:bg-gradient-to-r data-[state=active]:from-green-500 data-[state=active]:to-emerald-600 data-[state=active]:text-white data-[state=active]:shadow-md data-[state=active]:shadow-green-200/50 hover:bg-green-50/80 hover:text-green-700 group\"\r\n                >\r\n                  <span className=\"relative z-10\"></span>\r\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-green-500/10 to-emerald-500/10 opacity-0 group-hover:opacity-100 transition-all duration-300 rounded\"></div>\r\n                </TabsTrigger>\r\n                \r\n                <TabsTrigger \r\n                  value=\"withdraw\" \r\n                  className=\"text-sm relative z-10 rounded transition-all duration-300  data-[state=active]:bg-gradient-to-r data-[state=active]:from-orange-500 data-[state=active]:to-amber-600 data-[state=active]:text-white data-[state=active]:shadow-md data-[state=active]:shadow-orange-200/50 hover:bg-orange-50/80 hover:text-orange-700 group\"\r\n                >\r\n                  <span className=\"relative z-10\"></span>\r\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-orange-500/10 to-amber-500/10 opacity-0 group-hover:opacity-100 transition-all duration-300 rounded\"></div>\r\n                </TabsTrigger>\r\n                \r\n                <TabsTrigger \r\n                  value=\"deleted\" \r\n                  className=\"text-sm relative z-10 rounded transition-all duration-300  data-[state=active]:bg-gradient-to-r data-[state=active]:from-red-500 data-[state=active]:to-rose-600 data-[state=active]:text-white data-[state=active]:shadow-md data-[state=active]:shadow-red-200/50 hover:bg-red-50/80 hover:text-red-700 group\"\r\n                >\r\n                  <span className=\"relative z-10\"></span>\r\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-red-500/10 to-rose-500/10 opacity-0 group-hover:opacity-100 transition-all duration-300 rounded\"></div>\r\n                </TabsTrigger>\r\n              </TabsList>\r\n              \r\n              <TabsContent value=\"all\" className=\"mt-2 receipts-list\">\r\n                {filteredTransactions.length === 0 ? (\r\n                  <div className=\"text-center py-4 text-gray-500 fade-in-up tab-stagger-item text-[10px]\">\r\n                        \r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-1 fade-in-up tab-content-smooth max-h-[600px] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400\">\r\n                    {filteredTransactions.map((transaction, index) => (\r\n                      <div \r\n                        key={transaction.id} \r\n                        className=\"receipts-row flex items-center justify-between p-3 bg-white rounded-lg border hover:shadow-md cursor-pointer transition-all duration-200\"\r\n                        onClick={() => handleTransactionClick(transaction)}\r\n                      >\r\n                        <div className=\"flex items-center gap-1\">\r\n                          {getStatusIcon(transaction.status, transaction.type)}\r\n                          <div>\r\n                            <p className={`font-medium text-sm ${transaction.type === 'withdraw' ? 'text-red-700' : 'text-green-700'}`}>\r\n                              {transaction.type === 'withdraw' \r\n                                ? transaction.receiverPhone\r\n                                : `${transaction.senderPhone}  ${transaction.receiverPhone}`\r\n                              }\r\n                            </p>\r\n                            {transaction.type === 'withdraw' && (\r\n                              <>\r\n                                <p className=\"text-sm font-semibold text-red-600\">\r\n                                  {formatNumberEnglish(transaction.amount)} \r\n                                </p>\r\n                                <p className=\"text-xs text-red-600\">\r\n                                  : {formatNumberEnglish(transaction.commission || 0)} \r\n                                </p>\r\n                              </>\r\n                            )}\r\n                            <p className={`text-[10px] ${transaction.type === 'withdraw' ? 'text-red-700' : 'text-green-700'}`}>\r\n                               : {transaction.cashierName ?? ' '}\r\n                            </p>\r\n                            <p className={`text-sm ${transaction.type === 'withdraw' ? 'text-red-500' : 'text-green-600'}`}>\r\n                              {transaction.createdAt.toLocaleString('en-GB')}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                          {transaction.type !== 'withdraw' && (\r\n                            <p className=\"font-bold text-sm text-green-700\">\r\n                              {formatNumberEnglish(transaction.amount)} \r\n                            </p>\r\n                          )}\r\n                          {transaction.withdrawnAmount && (\r\n                            <p className=\"text-sm text-red-600\">\r\n                              : {formatNumberEnglish(transaction.withdrawnAmount)} \r\n                            </p>\r\n                          )}\r\n                          {transaction.sentAmount && (\r\n                            <p className=\"text-sm text-green-600\">\r\n                              : {formatNumberEnglish(transaction.sentAmount)} \r\n                            </p>\r\n                          )}\r\n                          <Badge \r\n                            variant={transaction.status === 'completed' ? 'default' : 'secondary'} \r\n                            className={`text-sm ${transaction.status === 'completed' ? (transaction.type === 'withdraw' ? 'bg-red-100 text-red-800 border-red-300' : (transaction.type === 'send' ? 'bg-green-100 text-green-800 border-green-300' : '')) : (transaction.type === 'withdraw' ? 'bg-red-100 text-red-800' : '')}`}\r\n                          >\r\n                            {transaction.type === 'withdraw' ? '' : getStatusText(transaction.status)}\r\n                          </Badge>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"send\" className=\"mt-2 receipts-list\">\r\n                {effectiveTransactions.filter(t => t.type === 'send').length === 0 ? (\r\n                  <div className=\"text-center py-4 text-gray-500 fade-in-up tab-stagger-item text-[10px]\">\r\n                         \r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-1 fade-in-up tab-content-smooth max-h-[600px] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400\">\r\n                    {effectiveTransactions.filter(t => t.type === 'send').map((transaction, index) => (\r\n                      <div \r\n                        key={transaction.id} \r\n                        className=\"relative flex items-center gap-4 p-4 rounded-xl bg-card border border-gray-100 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer\"\r\n                        onClick={() => handleTransactionClick(transaction)}\r\n                      >\r\n                        {/* Icon Column */}\r\n                        <div className=\"h-12 w-12 rounded-full flex items-center justify-center shrink-0 bg-green-50\">\r\n                           <ArrowUpRight className=\"h-6 w-6 text-green-600\" />\r\n                        </div>\r\n\r\n                        {/* Content Column */}\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center justify-between mb-1\">\r\n                            <h4 className=\"text-base font-bold text-foreground truncate\">\r\n                               {transaction.receiverPhone}\r\n                            </h4>\r\n                            <span className=\"text-base font-bold text-green-600 whitespace-nowrap\">\r\n                              - {formatNumberEnglish(transaction.amount)} .\r\n                            </span>\r\n                          </div>\r\n\r\n                          <div className=\"flex items-center justify-between\">\r\n                             <div className=\"flex flex-col gap-0.5\">\r\n                                <p className=\"text-sm text-muted-foreground truncate\">\r\n                                   : {transaction.receiverPhone}\r\n                                </p>\r\n                                <p className=\"text-sm font-medium text-gray-500 mt-0.5\">\r\n                                   {transaction.createdAt.toLocaleString('ar-EG', { day: 'numeric', month: 'short', hour: 'numeric', minute: 'numeric', hour12: true })}\r\n                                </p>\r\n                             </div>\r\n\r\n                             <div className={`px-2.5 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${\r\n                                transaction.status === 'completed' \r\n                                  ? 'bg-green-50 text-green-700' \r\n                                  : transaction.status === 'pending'\r\n                                  ? 'bg-yellow-50 text-yellow-700'\r\n                                  : 'bg-red-50 text-red-700'\r\n                             }`}>\r\n                                {transaction.status === 'completed' && <Check className=\"h-3 w-3\" />}\r\n                                {transaction.status === 'pending' && <Clock className=\"h-3 w-3\" />}\r\n                                {transaction.status === 'failed' && <X className=\"h-3 w-3\" />}\r\n                                <span>\r\n                                   {getStatusText(transaction.status)}\r\n                                </span>\r\n                             </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"withdraw\" className=\"mt-2 receipts-list\">\r\n                {effectiveTransactions.filter(t => t.type === 'withdraw').length === 0 ? (\r\n                  <div className=\"text-center py-4 text-gray-500 fade-in-up tab-stagger-item text-[10px]\">\r\n                         \r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-1 max-h-[600px] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400\">\r\n                    {effectiveTransactions.filter(t => t.type === 'withdraw').map((transaction, index) => (\r\n                      <div \r\n                        key={transaction.id} \r\n                        className=\"relative flex items-center gap-4 p-4 rounded-xl bg-card border border-gray-100 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer\"\r\n                        onClick={() => handleTransactionClick(transaction)}\r\n                      >\r\n                        {/* Icon Column */}\r\n                        <div className=\"h-12 w-12 rounded-full flex items-center justify-center shrink-0 bg-red-50\">\r\n                           <ArrowDownLeft className=\"h-6 w-6 text-red-600\" />\r\n                        </div>\r\n\r\n                        {/* Content Column */}\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center justify-between mb-1\">\r\n                            <h4 className=\"text-base font-bold text-foreground truncate\">\r\n                               {transaction.receiverPhone}\r\n                            </h4>\r\n                            <span className=\"text-base font-bold text-red-600 whitespace-nowrap\">\r\n                              + {formatNumberEnglish(transaction.amount)} .\r\n                            </span>\r\n                          </div>\r\n\r\n                          <div className=\"flex items-center justify-between\">\r\n                             <div className=\"flex flex-col gap-0.5\">\r\n                                <p className=\"text-sm text-muted-foreground truncate\">\r\n                                   : {transaction.senderPhone}\r\n                                </p>\r\n                                <p className=\"text-sm font-medium text-gray-500 mt-0.5\">\r\n                                   {transaction.createdAt.toLocaleString('ar-EG', { day: 'numeric', month: 'short', hour: 'numeric', minute: 'numeric', hour12: true })}\r\n                                </p>\r\n                             </div>\r\n\r\n                             <div className={`px-2.5 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${\r\n                                transaction.status === 'completed' \r\n                                  ? 'bg-red-50 text-red-700' \r\n                                  : transaction.status === 'pending'\r\n                                  ? 'bg-yellow-50 text-yellow-700'\r\n                                  : 'bg-red-50 text-red-700'\r\n                             }`}>\r\n                                {transaction.status === 'completed' && <Check className=\"h-3 w-3\" />}\r\n                                {transaction.status === 'pending' && <Clock className=\"h-3 w-3\" />}\r\n                                {transaction.status === 'failed' && <X className=\"h-3 w-3\" />}\r\n                                <span>\r\n                                   {getStatusText(transaction.status)}\r\n                                </span>\r\n                             </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </TabsContent>\r\n              <TabsContent value=\"deleted\" className=\"mt-2\">\r\n                {deletedTransactions.length === 0 ? (\r\n                  <div className=\"text-center py-4 text-gray-500 fade-in-up tab-stagger-item text-[10px]\">\r\n                       \r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-1 max-h-[600px] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400\">\r\n                    {deletedTransactions.map((transaction, index) => (\r\n                      <div \r\n                        key={transaction.id} \r\n                        className=\"receipts-row flex items-center justify-between p-3 rounded-lg border\"\r\n                      >\r\n                        <div className=\"flex items-center gap-1\">\r\n                          {getStatusIcon(transaction.status, transaction.type)}\r\n                          <div>\r\n                            <p className=\"font-medium text-sm text-red-700\">\r\n                              {transaction.type === 'withdraw' \r\n                                ? transaction.receiverPhone\r\n                                : `${transaction.senderPhone}  ${transaction.receiverPhone}`\r\n                              }\r\n                            </p>\r\n                            {transaction.type === 'withdraw' && (\r\n                              <>\r\n                                <p className=\"text-sm font-semibold text-red-600\">\r\n                                  {formatNumberEnglish(transaction.amount)} \r\n                                </p>\r\n                                <p className=\"text-xs text-orange-500\">\r\n                                  : {formatNumberEnglish(transaction.commission || 0)} \r\n                                </p>\r\n                              </>\r\n                            )}\r\n                            <p className=\"text-[10px] text-red-700\">\r\n                               : {transaction.cashierName ?? ' '}\r\n                            </p>\r\n                            <p className=\"text-sm text-red-500\">\r\n                              {transaction.createdAt.toLocaleString('ar-EG')}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <div className=\"text-right mr-2\">\r\n                            {transaction.type !== 'withdraw' && (\r\n                              <p className=\"font-bold text-sm text-red-700\">\r\n                                {formatNumberEnglish(transaction.amount)} \r\n                              </p>\r\n                            )}\r\n                            <StatusChip variant=\"error\" text=\"\" />\r\n                          </div>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            className=\"text-green-600 hover:bg-green-100 h-10 sm:h-12 px-4 sm:px-5 min-w-[44px] touch-manipulation\"\r\n                            onClick={() => handleOpenRestoreDialog(transaction)}\r\n                          >\r\n                            <span className=\"text-xs sm:text-sm\"></span>\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            className=\"text-red-600 hover:bg-red-100 h-10 sm:h-12 px-3 sm:px-4 min-w-[44px] touch-manipulation\"\r\n                            onClick={() => permanentlyDeleteTransaction(transaction.id)}\r\n                          >\r\n                            <Trash2 className=\"h-4 w-4 sm:h-5 sm:w-5\" />\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </TabsContent>\r\n            </Tabs>\r\n        </CardContent>\r\n       </Card>\r\n\r\n        {/*    */}\r\n        <Dialog open={isGuideOpen} onOpenChange={setIsGuideOpen}>\r\n          <DialogContent className=\"dialog-modern max-w-3xl w-full p-0 overflow-hidden border-0 shadow-2xl\">\r\n            <DialogHeader className=\"px-4 pt-4\">\r\n              <DialogTitle className=\"text-lg font-bold\">{guideTitle || ' '}</DialogTitle>\r\n            </DialogHeader>\r\n            <div className=\"aspect-video w-full bg-black\">\r\n              {guideUrl ? (\r\n                <iframe\r\n                  src={toYouTubeEmbed(guideUrl)}\r\n                  title=\"Application Guide\"\r\n                  className=\"w-full h-full\"\r\n                  allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"\r\n                  allowFullScreen\r\n                />\r\n              ) : (\r\n                <div className=\"flex items-center justify-center h-full text-white/80\">    </div>\r\n              )}\r\n            </div>\r\n          </DialogContent>\r\n        </Dialog>\r\n\r\n        {/*   */}\r\n        <MaintenanceDialog open={isMaintenanceOpen} onOpenChange={setIsMaintenanceOpen} />\r\n      </div>\r\n      \r\n      {/* Credit Cards Dialog */}\r\n      <CreditCardsDialog\r\n        isOpen={isCreditCardsOpen}\r\n        onClose={() => setIsCreditCardsOpen(false)}\r\n      />\r\n      <MasterPinDialog\r\n        open={isDebtsPasswordDialogOpen}\r\n        onOpenChange={setIsDebtsPasswordDialogOpen}\r\n        mode=\"verify\"\r\n        title=\"    \"\r\n        description=\"      \"\r\n        onSuccess={() => {\r\n          setIsDebtsPasswordDialogOpen(false);\r\n          //       \r\n          navigate('/user', { state: { openDebtDialog: true } });\r\n        }}\r\n      />\r\n      <PasswordConfirmDialog\r\n        open={isResetRecentDialogOpen}\r\n        onOpenChange={setIsResetRecentDialogOpen}\r\n        title=\"     \"\r\n        description=\"        Firebase.\"\r\n        onSuccess={async () => {\r\n          try {\r\n            if (!user?.uid) {\r\n              setIsResetRecentDialogOpen(false);\r\n              return;\r\n            }\r\n            const resetAt = new Date();\r\n            const toJsDate = (v: any) => (v instanceof Date) ? v : (typeof v?.toDate === 'function') ? v.toDate() : new Date(String(v));\r\n            //           .\r\n            //          .\r\n\r\n            //      Firestore    \r\n            await userDataService.updateUserData(user.uid, {\r\n              recentReset: {\r\n                keepLastCount: recentResetConfig.keepLastCount ?? 30,\r\n                intervalDays: recentResetConfig.intervalDays ?? 7,\r\n                lastResetAt: resetAt\r\n              }\r\n            });\r\n            setRecentResetConfig(cfg => ({ ...cfg, lastResetAt: resetAt }));\r\n\r\n            toast({ title: '   ', description: '              /  .' });\r\n          } catch (e) {\r\n            console.error('   :', e);\r\n            toast({ title: ' ', description: '     .', variant: 'destructive' });\r\n          } finally {\r\n            setIsResetRecentDialogOpen(false);\r\n          }\r\n        }}\r\n      />\r\n\r\n      {/*    */}\r\n      <Dialog open={isTopUpOpen} onOpenChange={(open) => {\r\n        if (open) {\r\n          const allowedEmail = 'alkaptin678678@gmail.com';\r\n          const userEmail = auth.currentUser?.email?.toLowerCase();\r\n          if (!userEmail || userEmail !== allowedEmail) {\r\n            toast({ title: ' ', description: '    .' });\r\n            return; //   \r\n          }\r\n          setIsTopUpOpen(true);\r\n        } else {\r\n          setIsTopUpOpen(false);\r\n        }\r\n      }}>\r\n        <DialogContent dir=\"rtl\" className=\"sm:max-w-md\">\r\n          <DialogHeader>\r\n            <DialogTitle>  </DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-3\">\r\n            <div>\r\n              <label className=\"block text-right mb-1\"> </label>\r\n              <Input\r\n                value={topupPhone}\r\n                onChange={(e) => setTopupPhone(e.target.value)}\r\n                placeholder=\"01XXXXXXXXX\"\r\n                dir=\"ltr\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-right mb-1\"></label>\r\n              <Select value={topupOperator} onValueChange={setTopupOperator}>\r\n                <SelectTrigger className=\"w-full\">\r\n                  <SelectValue placeholder=\" \" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"vodafone_eg\"></SelectItem>\r\n                  <SelectItem value=\"orange_eg\"></SelectItem>\r\n                  <SelectItem value=\"etisalat_eg\"></SelectItem>\r\n                  <SelectItem value=\"we_eg\">WE</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-right mb-1\"> </label>\r\n              <Input\r\n                type=\"number\"\r\n                min={1}\r\n                value={topupAmount as number | ''}\r\n                onChange={(e) => setTopupAmount(e.target.value ? Number(e.target.value) : '')}\r\n                placeholder=\"50\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between gap-2 pt-2\">\r\n              <Button variant=\"outline\" onClick={() => setIsTopUpOpen(false)}></Button>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Button variant=\"secondary\" onClick={() => navigate('/topup')}>  </Button>\r\n                <Button onClick={submitTopUp} disabled={topupLoading || !topupPhone || !topupOperator || !topupAmount}>\r\n                  {topupLoading ? ' ...' : ' '}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/*    */}\r\n      <Dialog open={isRestoreConfirmOpen} onOpenChange={setIsRestoreConfirmOpen}>\r\n        <DialogContent className=\"sm:max-w-[460px]\">\r\n          <DialogHeader>\r\n            <DialogTitle>  </DialogTitle>\r\n            <DialogDescription>\r\n                    .\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          {pendingRestoreTx && (\r\n            <div className=\"mt-2 space-y-2 text-sm\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <span className=\"text-gray-600\"></span>\r\n                <span className=\"font-bold\">{pendingRestoreTx.amount} </span>\r\n              </div>\r\n              {pendingRestoreTx.type === 'withdraw' ? (\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"text-gray-600\"></span>\r\n                  <span className=\"font-medium\">{pendingRestoreTx.receiverPhone}</span>\r\n                </div>\r\n              ) : (\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"text-gray-600\">  </span>\r\n                  <span className=\"font-medium\">{pendingRestoreTx.senderPhone}  {pendingRestoreTx.receiverPhone}</span>\r\n                </div>\r\n              )}\r\n              <div className=\"flex items-center justify-between\">\r\n                <span className=\"text-gray-600\"></span>\r\n                <span className=\"font-medium\">{pendingRestoreTx.cashierName ?? ' '}</span>\r\n              </div>\r\n              <div className=\"flex items-center justify-between\">\r\n                <span className=\"text-gray-600\"></span>\r\n                <span className=\"font-medium\">{pendingRestoreTx.createdAt.toLocaleString('ar-EG')}</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n          <div className=\"flex items-center justify-between gap-2 pt-3\">\r\n            <Button variant=\"outline\" onClick={() => { setIsRestoreConfirmOpen(false); setPendingRestoreTx(null); }}></Button>\r\n            <Button onClick={handleConfirmRestore}> </Button>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <ReceiptModal\r\n        isOpen={isReceiptOpen}\r\n        onClose={() => setIsReceiptOpen(false)}\r\n        transaction={receiptTransaction}\r\n        onPrint={() => window.print()}\r\n        onDelete={handleDeleteReceipt}\r\n        onComplete={handleCompleteReceipt}\r\n      />\r\n\r\n      <MasterPinDialog\r\n        open={isInstallmentPinOpen}\r\n        onOpenChange={setIsInstallmentPinOpen}\r\n        mode=\"verify\"\r\n        title=\"  \"\r\n        description=\"       \"\r\n        onSuccess={() => {\r\n          setIsInstallmentPinOpen(false);\r\n          setIsInstallmentModalOpen(true);\r\n        }}\r\n      />\r\n\r\n      <InstallmentModal\r\n        open={isInstallmentModalOpen}\r\n        onOpenChange={setIsInstallmentModalOpen}\r\n      />\r\n    </div>\r\n  );\r\n  };\r\n\r\nexport default TransactionsPage;\r\n"],"file":"assets/TransactionsPage-C9w_W7Bh.js"}