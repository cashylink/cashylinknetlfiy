import{u as T,r as o,j as s,I as h,B as i,T as D,f as r,y as x,i as f,P as p,K as w}from"./index-BkgvAZmL.js";import{C as S,a as A,b as I,d as k}from"./card-BeLkzSXB.js";import{L as j}from"./label-BnTYfWNe.js";function V(){const{user:t,profile:c,loading:a,signIn:U}=T(),[y,b]=o.useState(null),[n,v]=o.useState("alkaptin7878@mail.ru"),[d,C]=o.useState("01123456");o.useEffect(()=>{const e=()=>{b({contextUser:t?{uid:t.uid,email:t.email,emailVerified:t.emailVerified}:null,contextProfile:c,contextLoading:a,firebaseCurrentUser:r.currentUser?{uid:r.currentUser.uid,email:r.currentUser.email,emailVerified:r.currentUser.emailVerified}:null,timestamp:new Date().toISOString()})};e();const l=setInterval(e,2e3);return()=>clearInterval(l)},[t,c,a]);const N=async()=>{console.log("ğŸ§ª Testing login with:",{email:n,password:"***"});try{const e=await U(n,d);console.log("ğŸ§ª Login result:",e)}catch(e){console.error("ğŸ§ª Login error:",e)}},F=async()=>{console.log("ğŸ”¥ Testing Firestore connection..."),console.log("ğŸ” Current auth state:",{user:t?{uid:t.uid,email:t.email}:null,firebaseCurrentUser:r.currentUser?{uid:r.currentUser.uid,email:r.currentUser.email}:null});try{if(!t&&!r.currentUser){console.log("âŒ No user logged in - please login first"),alert("ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ Firestore");return}const e=t||r.currentUser;console.log("âœ… Using user:",e==null?void 0:e.email),console.log("ğŸ“– Testing user document read...");const l=x(f,"users",e.uid),u=await p(l);u.exists()?console.log("âœ… User document exists:",u.data()):(console.log("âš ï¸ User document does not exist, creating..."),await w(l,{email:e.email,uid:e.uid,createdAt:new Date,role:"user",isActive:!0}),console.log("âœ… User document created")),console.log("ğŸ“– Testing merchant wallet read...");const m=x(f,"merchantWallets",`test_${e.uid}`),g=await p(m);g.exists()?console.log("âœ… Wallet document exists:",g.data()):(console.log("âš ï¸ Wallet document does not exist, creating test wallet..."),await w(m,{merchantUserId:e.uid,walletName:"Ù…Ø­ÙØ¸Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©",balance:0,createdAt:new Date}),console.log("âœ… Test wallet created")),console.log("ğŸ‰ Firestore connection test completed successfully!"),alert("ØªÙ… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ Firestore Ø¨Ù†Ø¬Ø§Ø­! ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„ØªÙØ§ØµÙŠÙ„")}catch(e){console.error("âŒ Firestore connection error:",e),alert(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ Firestore: ${e.message}`)}};return s.jsx("div",{className:"min-h-screen bg-background p-6",children:s.jsx("div",{className:"max-w-4xl mx-auto space-y-6",children:s.jsxs(S,{children:[s.jsx(A,{children:s.jsx(I,{children:"ğŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©"})}),s.jsxs(k,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(j,{htmlFor:"email",children:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"}),s.jsx(h,{id:"email",type:"email",value:n,onChange:e=>v(e.target.value),placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(j,{htmlFor:"password",children:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"}),s.jsx(h,{id:"password",type:"password",value:d,onChange:e=>C(e.target.value),placeholder:"Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"})]}),s.jsx(i,{onClick:N,className:"w-full",disabled:a,children:a?"Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...":"ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ØªØ¬Ø±ÙŠØ¨ÙŠ"}),t&&s.jsx(i,{onClick:F,className:"w-full",variant:"outline",children:"Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ Firestore"}),t&&s.jsx(i,{onClick:async()=>{try{await D(t.uid,"Ø¥Ø´Ø¹Ø§Ø± ØªØ¬Ø±ÙŠØ¨ÙŠ","ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø¥Ø´Ø¹Ø§Ø± ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ"),alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ØªØ¬Ø±ÙŠØ¨ÙŠ! ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡Ø§ØªÙÙƒ.")}catch(e){alert(`ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ: ${(e==null?void 0:e.message)||e}`)}},className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white",children:"Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ØªØ¬Ø±ÙŠØ¨ÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ"}),s.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[s.jsx("h3",{className:"font-bold mb-2",children:"Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:"}),s.jsx("pre",{className:"text-sm overflow-auto",children:JSON.stringify(y,null,2)})]})]})]})})})}export{V as default};
