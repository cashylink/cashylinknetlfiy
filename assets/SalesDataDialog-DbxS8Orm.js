const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-DhbnydJl.js","./index-DLaPizfT.css"])))=>i.map(i=>d[i]);
import{a0 as xs,cg as Ku,ch as o0,r as je,m as qu,u as Zu,aM as Ju,a9 as Qu,R as $i,q as tr,aH as _t,s as Kt,t as ut,V as Ec,a8 as Xn,x as Fr,w as es,j as w,aa as Cn,ab as Tn,ad as Nn,B as it,b8 as Ql,aq as c0,c as kn,d as $u,e as ed,g as so,H as $l,K as Ni,y as or,a3 as ci,b1 as _c,C as oo,ay as li,I as Jt,ap as ts,J as Ac,a4 as ef,ao as bc,ac as ki,aI as Ii,an as tn,W as fa,E as ba,b9 as td,aG as Sc,a_ as rd,aT as ad,bz as nd,aR as l0,aD as id,D as Fs,$ as tf,v as sd,aK as Di,aN as Cc}from"./index-DhbnydJl.js";import{T as co,a as lo,b as Fi,c as xr,d as fo,e as gr}from"./table-B1_nzBiE.js";import{T as od,a as cd,b as Tc,c as Nc,S as kc}from"./tabs-VyDQ-WsJ.js";import{D as rf,a as af,b as nf,e as f0}from"./dropdown-menu-DhUxXtWv.js";import{S as ho}from"./separator-Cn84CDdZ.js";import{C as uo,e as ld,S as Ic,a as Dc,b as Fc,c as Oc,d as Os}from"./select-Bn8RCTk-.js";import{A as xo,a as go,b as mo,c as po,d as wo,e as vo,f as yo,g as Eo}from"./alert-dialog-BwXlZ7hY.js";import{b as Rc,a as h0,c as u0,d as fd,P as sf,e as of,f as cf,g as _o,h as lf,C as ff}from"./UserDashboardPage-XbIVMTiD.js";import{C as hd,V as ud}from"./VideoModal-w5Ot-7KI.js";import{C as dd}from"./chart-column-CP9zHq0e.js";import{D as Rs}from"./dollar-sign-AUKMnGdi.js";import{C as Ao}from"./calendar-4dCWv1Gk.js";import{S as xd}from"./save-DZuHrrpv.js";import{P as gd}from"./printer-DeiqlOce.js";import{P as hf}from"./pen-line-DHrJReBO.js";import{A as uf}from"./arrow-left-DTf_k4UZ.js";import{T as bo}from"./trending-down-CYLWGiMe.js";import{C as md}from"./users-D9PlfCO2.js";import"./index-xL9tDy8r.js";import"./SimCardsAccessDialog-Z5OgVyJn.js";import"./ProfileSettingsPage-DnVs4YJB.js";import"./switch-klIFyYmY.js";import"./square-pen-CSLFtBCt.js";import"./circle-check-big-Dtvck6_a.js";import"./crown-D1WD830B.js";import"./ProfileIcon-IxzO755X.js";import"./freeTrialService-u-lJSTVe.js";import"./broadcastService-BQWgcmoe.js";import"./bell-C-d1sJAh.js";import"./profitService-QTJQLMA0.js";import"./arrow-down-left-DcYD3MrR.js";import"./wallet--cZcBirk.js";import"./star-BSPZIAqJ.js";function pd(e,r){for(var t=0;t<r.length;t++){const n=r[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const c=Object.getOwnPropertyDescriptor(n,s);c&&Object.defineProperty(e,s,c.get?c:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],df=xs("ellipsis-vertical",wd);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],yd=xs("file-down",vd);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],_d=xs("file-up",Ed);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ad=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],bd=xs("info",Ad);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],zn=xs("rotate-ccw",Sd);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]],d0=xs("scan-barcode",Cd);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],xf=xs("shopping-cart",Td),Nd={lessThanXSeconds:{one:"أقل من ثانية",two:"أقل من ثانيتين",threeToTen:"أقل من {{count}} ثواني",other:"أقل من {{count}} ثانية"},xSeconds:{one:"ثانية",two:"ثانيتين",threeToTen:"{{count}} ثواني",other:"{{count}} ثانية"},halfAMinute:"نص دقيقة",lessThanXMinutes:{one:"أقل من دقيقة",two:"أقل من دقيقتين",threeToTen:"أقل من {{count}} دقايق",other:"أقل من {{count}} دقيقة"},xMinutes:{one:"دقيقة",two:"دقيقتين",threeToTen:"{{count}} دقايق",other:"{{count}} دقيقة"},aboutXHours:{one:"حوالي ساعة",two:"حوالي ساعتين",threeToTen:"حوالي {{count}} ساعات",other:"حوالي {{count}} ساعة"},xHours:{one:"ساعة",two:"ساعتين",threeToTen:"{{count}} ساعات",other:"{{count}} ساعة"},xDays:{one:"يوم",two:"يومين",threeToTen:"{{count}} أيام",other:"{{count}} يوم"},aboutXWeeks:{one:"حوالي أسبوع",two:"حوالي أسبوعين",threeToTen:"حوالي {{count}} أسابيع",other:"حوالي {{count}} أسبوع"},xWeeks:{one:"أسبوع",two:"أسبوعين",threeToTen:"{{count}} أسابيع",other:"{{count}} أسبوع"},aboutXMonths:{one:"حوالي شهر",two:"حوالي شهرين",threeToTen:"حوالي {{count}} أشهر",other:"حوالي {{count}} شهر"},xMonths:{one:"شهر",two:"شهرين",threeToTen:"{{count}} أشهر",other:"{{count}} شهر"},aboutXYears:{one:"حوالي سنة",two:"حوالي سنتين",threeToTen:"حوالي {{count}} سنين",other:"حوالي {{count}} سنة"},xYears:{one:"عام",two:"عامين",threeToTen:"{{count}} أعوام",other:"{{count}} عام"},overXYears:{one:"أكثر من سنة",two:"أكثر من سنتين",threeToTen:"أكثر من {{count}} سنين",other:"أكثر من {{count}} سنة"},almostXYears:{one:"عام تقريبًا",two:"عامين تقريبًا",threeToTen:"{{count}} أعوام تقريبًا",other:"{{count}} عام تقريبًا"}},kd=(e,r,t)=>{let n;const s=Nd[e];return typeof s=="string"?n=s:r===1?n=s.one:r===2?n=s.two:r<=10?n=s.threeToTen.replace("{{count}}",String(r)):n=s.other.replace("{{count}}",String(r)),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?`في خلال ${n}`:`منذ ${n}`:n},Id={full:"EEEE، do MMMM y",long:"do MMMM y",medium:"dd/MMM/y",short:"d/MM/y"},Dd={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Fd={full:"{{date}} 'الساعة' {{time}}",long:"{{date}} 'الساعة' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Od={date:Rc({formats:Id,defaultWidth:"full"}),time:Rc({formats:Dd,defaultWidth:"full"}),dateTime:Rc({formats:Fd,defaultWidth:"full"})},Rd={lastWeek:"eeee 'اللي جاي الساعة' p",yesterday:"'إمبارح الساعة' p",today:"'النهاردة الساعة' p",tomorrow:"'بكرة الساعة' p",nextWeek:"eeee 'الساعة' p",other:"P"},Md=(e,r,t,n)=>Rd[e],Pd={narrow:["ق","ب"],abbreviated:["ق.م","ب.م"],wide:["قبل الميلاد","بعد الميلاد"]},Bd={narrow:["1","2","3","4"],abbreviated:["ر1","ر2","ر3","ر4"],wide:["الربع الأول","الربع الثاني","الربع الثالث","الربع الرابع"]},Ld={narrow:["ي","ف","م","أ","م","ي","ي","أ","س","أ","ن","د"],abbreviated:["ينا","فبر","مارس","أبريل","مايو","يونـ","يولـ","أغسـ","سبتـ","أكتـ","نوفـ","ديسـ"],wide:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"]},jd={narrow:["ح","ن","ث","ر","خ","ج","س"],short:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],abbreviated:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],wide:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"]},Ud={narrow:{am:"ص",pm:"م",midnight:"ن",noon:"ظ",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءً",night:"ليلاً"},abbreviated:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهراً",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءً",night:"ليلاً"},wide:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهراً",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءً",night:"ليلاً"}},Wd={narrow:{am:"ص",pm:"م",midnight:"ن",noon:"ظ",morning:"في الصباح",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل"},abbreviated:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهراً",morning:"في الصباح",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل"},wide:{am:"ص",pm:"م",midnight:"نصف الليل",morning:"في الصباح",noon:"ظهراً",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل"}},Vd=(e,r)=>String(e),Hd={ordinalNumber:Vd,era:h0({values:Pd,defaultWidth:"wide"}),quarter:h0({values:Bd,defaultWidth:"wide",argumentCallback:e=>e-1}),month:h0({values:Ld,defaultWidth:"wide"}),day:h0({values:jd,defaultWidth:"wide"}),dayPeriod:h0({values:Ud,defaultWidth:"wide",formattingValues:Wd,defaultFormattingWidth:"wide"})},Gd=/^(\d+)/,Xd=/\d+/i,zd={narrow:/^(ق|ب)/g,abbreviated:/^(ق.م|ب.م)/g,wide:/^(قبل الميلاد|بعد الميلاد)/g},Yd={any:[/^ق/g,/^ب/g]},Kd={narrow:/^[1234]/,abbreviated:/^ر[1234]/,wide:/^الربع (الأول|الثاني|الثالث|الرابع)/},qd={wide:[/الربع الأول/,/الربع الثاني/,/الربع الثالث/,/الربع الرابع/],any:[/1/,/2/,/3/,/4/]},Zd={narrow:/^(ي|ف|م|أ|س|ن|د)/,abbreviated:/^(ينا|فبر|مارس|أبريل|مايو|يونـ|يولـ|أغسـ|سبتـ|أكتـ|نوفـ|ديسـ)/,wide:/^(يناير|فبراير|مارس|أبريل|مايو|يونيو|يوليو|أغسطس|سبتمبر|أكتوبر|نوفمبر|ديسمبر)/},Jd={narrow:[/^ي/,/^ف/,/^م/,/^أ/,/^م/,/^ي/,/^ي/,/^أ/,/^س/,/^أ/,/^ن/,/^د/],any:[/^ينا/,/^فبر/,/^مارس/,/^أبريل/,/^مايو/,/^يون/,/^يول/,/^أغس/,/^سبت/,/^أكت/,/^نوف/,/^ديس/]},Qd={narrow:/^(ح|ن|ث|ر|خ|ج|س)/,short:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/,abbreviated:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/,wide:/^(الأحد|الاثنين|الثلاثاء|الأربعاء|الخميس|الجمعة|السبت)/},$d={narrow:[/^ح/,/^ن/,/^ث/,/^ر/,/^خ/,/^ج/,/^س/],any:[/أحد/,/اثنين/,/ثلاثاء/,/أربعاء/,/خميس/,/جمعة/,/سبت/]},ex={narrow:/^(ص|م|ن|ظ|في الصباح|بعد الظهر|في المساء|في الليل)/,abbreviated:/^(ص|م|نصف الليل|ظهراً|في الصباح|بعد الظهر|في المساء|في الليل)/,wide:/^(ص|م|نصف الليل|في الصباح|ظهراً|بعد الظهر|في المساء|في الليل)/,any:/^(ص|م|صباح|ظهر|مساء|ليل)/},tx={any:{am:/^ص/,pm:/^م/,midnight:/^ن/,noon:/^ظ/,morning:/^ص/,afternoon:/^بعد/,evening:/^م/,night:/^ل/}},rx={ordinalNumber:fd({matchPattern:Gd,parsePattern:Xd,valueCallback:function(e){return parseInt(e,10)}}),era:u0({matchPatterns:zd,defaultMatchWidth:"wide",parsePatterns:Yd,defaultParseWidth:"any"}),quarter:u0({matchPatterns:Kd,defaultMatchWidth:"wide",parsePatterns:qd,defaultParseWidth:"any",valueCallback:e=>e+1}),month:u0({matchPatterns:Zd,defaultMatchWidth:"wide",parsePatterns:Jd,defaultParseWidth:"any"}),day:u0({matchPatterns:Qd,defaultMatchWidth:"wide",parsePatterns:$d,defaultParseWidth:"any"}),dayPeriod:u0({matchPatterns:ex,defaultMatchWidth:"any",parsePatterns:tx,defaultParseWidth:"any"})},So={code:"ar-EG",formatDistance:kd,formatLong:Od,formatRelative:Md,localize:Hd,match:rx,options:{weekStartsOn:0,firstWeekContainsDate:1}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Uo={};Uo.version="0.18.5";var M1=1252,ax=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ll={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fl=function(e){ax.indexOf(e)!=-1&&(M1=ll[0]=e)};function nx(){fl(1252)}var Dn=function(e){fl(e)};function hl(){Dn(1200),nx()}function gf(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function ix(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function P1(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var g0=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?ix(e.slice(2)):r==254&&t==255?P1(e.slice(2)):r==65279?e.slice(1):e},Co=function(r){return String.fromCharCode(r)},mf=function(r){return String.fromCharCode(r)},C0,Ri="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function T0(e){for(var r="",t=0,n=0,s=0,c=0,h=0,d=0,m=0,g=0;g<e.length;)t=e.charCodeAt(g++),c=t>>2,n=e.charCodeAt(g++),h=(t&3)<<4|n>>4,s=e.charCodeAt(g++),d=(n&15)<<2|s>>6,m=s&63,isNaN(n)?d=m=64:isNaN(s)&&(m=64),r+=Ri.charAt(c)+Ri.charAt(h)+Ri.charAt(d)+Ri.charAt(m);return r}function cn(e){var r="",t=0,n=0,s=0,c=0,h=0,d=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var g=0;g<e.length;)c=Ri.indexOf(e.charAt(g++)),h=Ri.indexOf(e.charAt(g++)),t=c<<2|h>>4,r+=String.fromCharCode(t),d=Ri.indexOf(e.charAt(g++)),n=(h&15)<<4|d>>2,d!==64&&(r+=String.fromCharCode(n)),m=Ri.indexOf(e.charAt(g++)),s=(d&3)<<6|m,m!==64&&(r+=String.fromCharCode(s));return r}var Gt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),mi=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function Pi(e){return Gt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function pf(e){return Gt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var sn=function(r){return Gt?mi(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function rc(e){if(typeof ArrayBuffer>"u")return sn(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function Ui(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function sx(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ul(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ul(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var ua=Gt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:mi(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),s=0;for(r=0,t=0;r<e.length;t+=s,++r)if(s=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function ox(e){for(var r=[],t=0,n=e.length+250,s=Pi(e.length+255),c=0;c<e.length;++c){var h=e.charCodeAt(c);if(h<128)s[t++]=h;else if(h<2048)s[t++]=192|h>>6&31,s[t++]=128|h&63;else if(h>=55296&&h<57344){h=(h&1023)+64;var d=e.charCodeAt(++c)&1023;s[t++]=240|h>>8&7,s[t++]=128|h>>2&63,s[t++]=128|d>>6&15|(h&3)<<4,s[t++]=128|d&63}else s[t++]=224|h>>12&15,s[t++]=128|h>>6&63,s[t++]=128|h&63;t>n&&(r.push(s.slice(0,t)),t=0,s=Pi(65535),n=65530)}return r.push(s.slice(0,t)),ua(r)}var ja=/\u0000/g,m0=/[\u0001-\u0006]/g;function Ws(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function Fn(e,r){var t=""+e;return t.length>=r?t:jr("0",r-t.length)+t}function dl(e,r){var t=""+e;return t.length>=r?t:jr(" ",r-t.length)+t}function Wo(e,r){var t=""+e;return t.length>=r?t:t+jr(" ",r-t.length)}function cx(e,r){var t=""+Math.round(e);return t.length>=r?t:jr("0",r-t.length)+t}function lx(e,r){var t=""+e;return t.length>=r?t:jr("0",r-t.length)+t}var wf=Math.pow(2,32);function Ms(e,r){if(e>wf||e<-wf)return cx(e,r);var t=Math.round(e);return lx(t,r)}function Vo(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var vf=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Mc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function fx(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var bt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},yf={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hx={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ho(e,r,t){for(var n=e<0?-1:1,s=e*n,c=0,h=1,d=0,m=1,g=0,v=0,_=Math.floor(s);g<r&&(_=Math.floor(s),d=_*h+c,v=_*g+m,!(s-_<5e-8));)s=1/(s-_),c=h,h=d,m=g,g=v;if(v>r&&(g>r?(v=m,d=c):(v=g,d=h)),!t)return[0,n*d,v];var C=Math.floor(n*d/v);return[C,n*d-C*v,v]}function as(e,r,t){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),c=0,h=[],d={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),r&&r.date1904&&(n+=1462),d.u>.9999&&(d.u=0,++s==86400&&(d.T=s=0,++n,++d.D)),n===60)h=t?[1317,10,29]:[1900,2,29],c=3;else if(n===0)h=t?[1317,8,29]:[1900,1,0],c=6;else{n>60&&--n;var m=new Date(1900,0,1);m.setDate(m.getDate()+n-1),h=[m.getFullYear(),m.getMonth()+1,m.getDate()],c=m.getDay(),n<60&&(c=(c+6)%7),t&&(c=px(m,h))}return d.y=h[0],d.m=h[1],d.d=h[2],d.S=s%60,s=Math.floor(s/60),d.M=s%60,s=Math.floor(s/60),d.H=s,d.q=c,d}var B1=new Date(1899,11,31,0,0,0),ux=B1.getTime(),dx=new Date(1900,2,1,0,0,0);function L1(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=dx&&(t+=24*60*60*1e3),(t-(ux+(e.getTimezoneOffset()-B1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function xl(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function xx(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function gx(e){var r=e<0?12:11,t=xl(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function mx(e){var r=xl(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function N0(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=gx(e):r===10?t=e.toFixed(10).substr(0,12):t=mx(e),xl(xx(t.toUpperCase()))}function cs(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):N0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return En(14,L1(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function px(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function wx(e,r,t,n){var s="",c=0,h=0,d=t.y,m,g=0;switch(e){case 98:d=t.y+543;case 121:switch(r.length){case 1:case 2:m=d%100,g=2;break;default:m=d%1e4,g=4;break}break;case 109:switch(r.length){case 1:case 2:m=t.m,g=r.length;break;case 3:return Mc[t.m-1][1];case 5:return Mc[t.m-1][0];default:return Mc[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:m=t.d,g=r.length;break;case 3:return vf[t.q][0];default:return vf[t.q][1]}break;case 104:switch(r.length){case 1:case 2:m=1+(t.H+11)%12,g=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:m=t.H,g=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:m=t.M,g=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?Fn(t.S,r.length):(n>=2?h=n===3?1e3:100:h=n===1?10:1,c=Math.round(h*(t.S+t.u)),c>=60*h&&(c=0),r==="s"?c===0?"0":""+c/h:(s=Fn(c,2+n),r==="ss"?s.substr(0,2):"."+s.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":m=t.D*24+t.H;break;case"[m]":case"[mm]":m=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":m=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}g=r.length===3?1:2;break;case 101:m=d,g=1;break}var v=g>0?Fn(m,g):"";return v}function Mi(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var j1=/%/g;function vx(e,r,t){var n=r.replace(j1,""),s=r.length-n.length;return ui(e,n,t*Math.pow(10,2*s))+jr("%",s)}function yx(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ui(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function U1(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+U1(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var c=Math.floor(Math.log(r)*Math.LOG10E)%s;if(c<0&&(c+=s),t=(r/Math.pow(10,c)).toPrecision(n+1+(s+c)%s),t.indexOf("e")===-1){var h=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(h-t.length+c):t+="E+"+(h-c);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,g,v){return m+g+v.substr(0,(s+c)%s)+"."+v.substr(c)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var W1=/# (\?+)( ?)\/( ?)(\d+)/;function Ex(e,r,t){var n=parseInt(e[4],10),s=Math.round(r*n),c=Math.floor(s/n),h=s-c*n,d=n;return t+(c===0?"":""+c)+" "+(h===0?jr(" ",e[1].length+1+e[4].length):dl(h,e[1].length)+e[2]+"/"+e[3]+Fn(d,e[4].length))}function _x(e,r,t){return t+(r===0?"":""+r)+jr(" ",e[1].length+2+e[4].length)}var V1=/^#*0*\.([0#]+)/,H1=/\).*[0#]/,G1=/\(###\) ###\\?-####/;function Ba(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Ef(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function _f(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function Ax(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function bx(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function gn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(H1)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?gn("n",n,t):"("+gn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return yx(e,r,t);if(r.indexOf("%")!==-1)return vx(e,r,t);if(r.indexOf("E")!==-1)return U1(r,t);if(r.charCodeAt(0)===36)return"$"+gn(e,r.substr(r.charAt(1)==" "?2:1),t);var s,c,h,d,m=Math.abs(t),g=t<0?"-":"";if(r.match(/^00+$/))return g+Ms(m,r.length);if(r.match(/^[#?]+$/))return s=Ms(t,0),s==="0"&&(s=""),s.length>r.length?s:Ba(r.substr(0,r.length-s.length))+s;if(c=r.match(W1))return Ex(c,m,g);if(r.match(/^#+0+$/))return g+Ms(m,r.length-r.indexOf("0"));if(c=r.match(V1))return s=Ef(t,c[1].length).replace(/^([^\.]+)$/,"$1."+Ba(c[1])).replace(/\.$/,"."+Ba(c[1])).replace(/\.(\d*)$/,function(N,S){return"."+S+jr("0",Ba(c[1]).length-S.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),c=r.match(/^(0*)\.(#*)$/))return g+Ef(m,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=r.match(/^#{1,3},##0(\.?)$/))return g+Mi(Ms(m,0));if(c=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+gn(e,r,-t):Mi(""+(Math.floor(t)+Ax(t,c[1].length)))+"."+Fn(_f(t,c[1].length),c[1].length);if(c=r.match(/^#,#*,#0/))return gn(e,r.replace(/^#,#*,/,""),t);if(c=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ws(gn(e,r.replace(/[\\-]/g,""),t)),h=0,Ws(Ws(r.replace(/\\/g,"")).replace(/[0#]/g,function(N){return h<s.length?s.charAt(h++):N==="0"?"0":""}));if(r.match(G1))return s=gn(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var v="";if(c=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(c[4].length,7),d=Ho(m,Math.pow(10,h)-1,!1),s=""+g,v=ui("n",c[1],d[1]),v.charAt(v.length-1)==" "&&(v=v.substr(0,v.length-1)+"0"),s+=v+c[2]+"/"+c[3],v=Wo(d[2],h),v.length<c[4].length&&(v=Ba(c[4].substr(c[4].length-v.length))+v),s+=v,s;if(c=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(c[1].length,c[4].length),7),d=Ho(m,Math.pow(10,h)-1,!0),g+(d[0]||(d[1]?"":"0"))+" "+(d[1]?dl(d[1],h)+c[2]+"/"+c[3]+Wo(d[2],h):jr(" ",2*h+1+c[2].length+c[3].length));if(c=r.match(/^[#0?]+$/))return s=Ms(t,0),r.length<=s.length?s:Ba(r.substr(0,r.length-s.length))+s;if(c=r.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),h=s.indexOf(".");var _=r.indexOf(".")-h,C=r.length-s.length-_;return Ba(r.substr(0,_)+s+r.substr(r.length-C))}if(c=r.match(/^00,000\.([#0]*0)$/))return h=_f(t,c[1].length),t<0?"-"+gn(e,r,-t):Mi(bx(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?Fn(0,3-N.length):"")+N})+"."+Fn(h,c[1].length);switch(r){case"###,##0.00":return gn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var T=Mi(Ms(m,0));return T!=="0"?g+T:"";case"###,###.00":return gn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return gn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Sx(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ui(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Cx(e,r,t){var n=r.replace(j1,""),s=r.length-n.length;return ui(e,n,t*Math.pow(10,2*s))+jr("%",s)}function X1(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+X1(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var c=Math.floor(Math.log(r)*Math.LOG10E)%s;if(c<0&&(c+=s),t=(r/Math.pow(10,c)).toPrecision(n+1+(s+c)%s),!t.match(/[Ee]/)){var h=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(h-t.length+c):t+="E+"+(h-c),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,g,v){return m+g+v.substr(0,(s+c)%s)+"."+v.substr(c)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Kn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(H1)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Kn("n",n,t):"("+Kn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Sx(e,r,t);if(r.indexOf("%")!==-1)return Cx(e,r,t);if(r.indexOf("E")!==-1)return X1(r,t);if(r.charCodeAt(0)===36)return"$"+Kn(e,r.substr(r.charAt(1)==" "?2:1),t);var s,c,h,d,m=Math.abs(t),g=t<0?"-":"";if(r.match(/^00+$/))return g+Fn(m,r.length);if(r.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>r.length?s:Ba(r.substr(0,r.length-s.length))+s;if(c=r.match(W1))return _x(c,m,g);if(r.match(/^#+0+$/))return g+Fn(m,r.length-r.indexOf("0"));if(c=r.match(V1))return s=(""+t).replace(/^([^\.]+)$/,"$1."+Ba(c[1])).replace(/\.$/,"."+Ba(c[1])),s=s.replace(/\.(\d*)$/,function(N,S){return"."+S+jr("0",Ba(c[1]).length-S.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),c=r.match(/^(0*)\.(#*)$/))return g+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=r.match(/^#{1,3},##0(\.?)$/))return g+Mi(""+m);if(c=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Kn(e,r,-t):Mi(""+t)+"."+jr("0",c[1].length);if(c=r.match(/^#,#*,#0/))return Kn(e,r.replace(/^#,#*,/,""),t);if(c=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ws(Kn(e,r.replace(/[\\-]/g,""),t)),h=0,Ws(Ws(r.replace(/\\/g,"")).replace(/[0#]/g,function(N){return h<s.length?s.charAt(h++):N==="0"?"0":""}));if(r.match(G1))return s=Kn(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var v="";if(c=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(c[4].length,7),d=Ho(m,Math.pow(10,h)-1,!1),s=""+g,v=ui("n",c[1],d[1]),v.charAt(v.length-1)==" "&&(v=v.substr(0,v.length-1)+"0"),s+=v+c[2]+"/"+c[3],v=Wo(d[2],h),v.length<c[4].length&&(v=Ba(c[4].substr(c[4].length-v.length))+v),s+=v,s;if(c=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(c[1].length,c[4].length),7),d=Ho(m,Math.pow(10,h)-1,!0),g+(d[0]||(d[1]?"":"0"))+" "+(d[1]?dl(d[1],h)+c[2]+"/"+c[3]+Wo(d[2],h):jr(" ",2*h+1+c[2].length+c[3].length));if(c=r.match(/^[#0?]+$/))return s=""+t,r.length<=s.length?s:Ba(r.substr(0,r.length-s.length))+s;if(c=r.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),h=s.indexOf(".");var _=r.indexOf(".")-h,C=r.length-s.length-_;return Ba(r.substr(0,_)+s+r.substr(r.length-C))}if(c=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Kn(e,r,-t):Mi(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?Fn(0,3-N.length):"")+N})+"."+Fn(0,c[1].length);switch(r){case"###,###":case"##,###":case"#,###":var T=Mi(""+m);return T!=="0"?g+T:"";default:if(r.match(/\.[0#?]*$/))return Kn(e,r.slice(0,r.lastIndexOf(".")),t)+Ba(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function ui(e,r,t){return(t|0)===t?Kn(e,r,t):gn(e,r,t)}function Tx(e){for(var r=[],t=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(s,n-s),s=n+1}if(r[r.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var z1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ks(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Vo(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(z1))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Nx(e,r,t,n){for(var s=[],c="",h=0,d="",m="t",g,v,_,C="H";h<e.length;)switch(d=e.charAt(h)){case"G":if(!Vo(e,h))throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"G",v:"General"},h+=7;break;case'"':for(c="";(_=e.charCodeAt(++h))!==34&&h<e.length;)c+=String.fromCharCode(_);s[s.length]={t:"t",v:c},++h;break;case"\\":var T=e.charAt(++h),N=T==="("||T===")"?T:"t";s[s.length]={t:N,v:T},++h;break;case"_":s[s.length]={t:"t",v:" "},h+=2;break;case"@":s[s.length]={t:"T",v:r},++h;break;case"B":case"b":if(e.charAt(h+1)==="1"||e.charAt(h+1)==="2"){if(g==null&&(g=as(r,t,e.charAt(h+1)==="2"),g==null))return"";s[s.length]={t:"X",v:e.substr(h,2)},m=d,h+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||g==null&&(g=as(r,t),g==null))return"";for(c=d;++h<e.length&&e.charAt(h).toLowerCase()===d;)c+=d;d==="m"&&m.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=C),s[s.length]={t:d,v:c},m=d;break;case"A":case"a":case"上":var S={t:d,v:d};if(g==null&&(g=as(r,t)),e.substr(h,3).toUpperCase()==="A/P"?(g!=null&&(S.v=g.H>=12?"P":"A"),S.t="T",C="h",h+=3):e.substr(h,5).toUpperCase()==="AM/PM"?(g!=null&&(S.v=g.H>=12?"PM":"AM"),S.t="T",h+=5,C="h"):e.substr(h,5).toUpperCase()==="上午/下午"?(g!=null&&(S.v=g.H>=12?"下午":"上午"),S.t="T",h+=5,C="h"):(S.t="t",++h),g==null&&S.t==="T")return"";s[s.length]=S,m=d;break;case"[":for(c=d;e.charAt(h++)!=="]"&&h<e.length;)c+=e.charAt(h);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(z1)){if(g==null&&(g=as(r,t),g==null))return"";s[s.length]={t:"Z",v:c.toLowerCase()},m=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ks(e)||(s[s.length]={t:"t",v:c}));break;case".":if(g!=null){for(c=d;++h<e.length&&(d=e.charAt(h))==="0";)c+=d;s[s.length]={t:"s",v:c};break}case"0":case"#":for(c=d;++h<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(h))>-1;)c+=d;s[s.length]={t:"n",v:c};break;case"?":for(c=d;e.charAt(++h)===d;)c+=d;s[s.length]={t:d,v:c},m=d;break;case"*":++h,(e.charAt(h)==" "||e.charAt(h)=="*")&&++h;break;case"(":case")":s[s.length]={t:n===1?"t":d,v:d},++h;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=d;h<e.length&&"0123456789".indexOf(e.charAt(++h))>-1;)c+=e.charAt(h);s[s.length]={t:"D",v:c};break;case" ":s[s.length]={t:d,v:d},++h;break;case"$":s[s.length]={t:"t",v:"$"},++h;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"t",v:d},++h;break}var D=0,U=0,X;for(h=s.length-1,m="t";h>=0;--h)switch(s[h].t){case"h":case"H":s[h].t=C,m="h",D<1&&(D=1);break;case"s":(X=s[h].v.match(/\.0+$/))&&(U=Math.max(U,X[0].length-1)),D<3&&(D=3);case"d":case"y":case"M":case"e":m=s[h].t;break;case"m":m==="s"&&(s[h].t="M",D<2&&(D=2));break;case"X":break;case"Z":D<1&&s[h].v.match(/[Hh]/)&&(D=1),D<2&&s[h].v.match(/[Mm]/)&&(D=2),D<3&&s[h].v.match(/[Ss]/)&&(D=3)}switch(D){case 0:break;case 1:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M),g.M>=60&&(g.M=0,++g.H);break;case 2:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M);break}var O="",q;for(h=0;h<s.length;++h)switch(s[h].t){case"t":case"T":case" ":case"D":break;case"X":s[h].v="",s[h].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[h].v=wx(s[h].t.charCodeAt(0),s[h].v,g,U),s[h].t="t";break;case"n":case"?":for(q=h+1;s[q]!=null&&((d=s[q].t)==="?"||d==="D"||(d===" "||d==="t")&&s[q+1]!=null&&(s[q+1].t==="?"||s[q+1].t==="t"&&s[q+1].v==="/")||s[h].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(s[q].v==="/"||s[q].v===" "&&s[q+1]!=null&&s[q+1].t=="?"));)s[h].v+=s[q].v,s[q]={v:"",t:";"},++q;O+=s[h].v,h=q-1;break;case"G":s[h].t="t",s[h].v=cs(r,t);break}var oe="",J,M;if(O.length>0){O.charCodeAt(0)==40?(J=r<0&&O.charCodeAt(0)===45?-r:r,M=ui("n",O,J)):(J=r<0&&n>1?-r:r,M=ui("n",O,J),J<0&&s[0]&&s[0].t=="t"&&(M=M.substr(1),s[0].v="-"+s[0].v)),q=M.length-1;var ie=s.length;for(h=0;h<s.length;++h)if(s[h]!=null&&s[h].t!="t"&&s[h].v.indexOf(".")>-1){ie=h;break}var j=s.length;if(ie===s.length&&M.indexOf("E")===-1){for(h=s.length-1;h>=0;--h)s[h]==null||"n?".indexOf(s[h].t)===-1||(q>=s[h].v.length-1?(q-=s[h].v.length,s[h].v=M.substr(q+1,s[h].v.length)):q<0?s[h].v="":(s[h].v=M.substr(0,q+1),q=-1),s[h].t="t",j=h);q>=0&&j<s.length&&(s[j].v=M.substr(0,q+1)+s[j].v)}else if(ie!==s.length&&M.indexOf("E")===-1){for(q=M.indexOf(".")-1,h=ie;h>=0;--h)if(!(s[h]==null||"n?".indexOf(s[h].t)===-1)){for(v=s[h].v.indexOf(".")>-1&&h===ie?s[h].v.indexOf(".")-1:s[h].v.length-1,oe=s[h].v.substr(v+1);v>=0;--v)q>=0&&(s[h].v.charAt(v)==="0"||s[h].v.charAt(v)==="#")&&(oe=M.charAt(q--)+oe);s[h].v=oe,s[h].t="t",j=h}for(q>=0&&j<s.length&&(s[j].v=M.substr(0,q+1)+s[j].v),q=M.indexOf(".")+1,h=ie;h<s.length;++h)if(!(s[h]==null||"n?(".indexOf(s[h].t)===-1&&h!==ie)){for(v=s[h].v.indexOf(".")>-1&&h===ie?s[h].v.indexOf(".")+1:0,oe=s[h].v.substr(0,v);v<s[h].v.length;++v)q<M.length&&(oe+=M.charAt(q++));s[h].v=oe,s[h].t="t",j=h}}}for(h=0;h<s.length;++h)s[h]!=null&&"n?".indexOf(s[h].t)>-1&&(J=n>1&&r<0&&h>0&&s[h-1].v==="-"?-r:r,s[h].v=ui(s[h].t,s[h].v,J),s[h].t="t");var Ee="";for(h=0;h!==s.length;++h)s[h]!=null&&(Ee+=s[h].v);return Ee}var Af=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function bf(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function kx(e,r){var t=Tx(e),n=t.length,s=t[n-1].indexOf("@");if(n<4&&s>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var c=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,c];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var h=t[0].match(Af),d=t[1].match(Af);return bf(r,h)?[n,t[0]]:bf(r,d)?[n,t[1]]:[n,t[h!=null&&d!=null?2:1]]}return[n,c]}function En(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:bt)[e],n==null&&(n=t.table&&t.table[yf[e]]||bt[yf[e]]),n==null&&(n=hx[e]||"General");break}if(Vo(n,0))return cs(r,t);r instanceof Date&&(r=L1(r,t.date1904));var s=kx(n,r);if(Vo(s[1]))return cs(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Nx(s[1],r,t,s[0])}function di(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(bt[t]==null){r<0&&(r=t);continue}if(bt[t]==e){r=t;break}}r<0&&(r=391)}return bt[r]=e,r}function ac(e){for(var r=0;r!=392;++r)e[r]!==void 0&&di(e[r],r)}function qs(){bt=fx()}var Ix={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Y1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Dx(e){var r=typeof e=="number"?bt[e]:e;return r=r.replace(Y1,"(\\d+)"),new RegExp("^"+r+"$")}function Fx(e,r,t){var n=-1,s=-1,c=-1,h=-1,d=-1,m=-1;(r.match(Y1)||[]).forEach(function(_,C){var T=parseInt(t[C+1],10);switch(_.toLowerCase().charAt(0)){case"y":n=T;break;case"d":c=T;break;case"h":h=T;break;case"s":m=T;break;case"m":h>=0?d=T:s=T;break}}),m>=0&&d==-1&&s>=0&&(d=s,s=-1);var g=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);g.length==7&&(g="0"+g),g.length==8&&(g="20"+g);var v=("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return h==-1&&d==-1&&m==-1?g:n==-1&&s==-1&&c==-1?v:g+"T"+v}var Ox=function(){var e={};e.version="1.2.0";function r(){for(var M=0,ie=new Array(256),j=0;j!=256;++j)M=j,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,ie[j]=M;return typeof Int32Array<"u"?new Int32Array(ie):ie}var t=r();function n(M){var ie=0,j=0,Ee=0,he=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Ee=0;Ee!=256;++Ee)he[Ee]=M[Ee];for(Ee=0;Ee!=256;++Ee)for(j=M[Ee],ie=256+Ee;ie<4096;ie+=256)j=he[ie]=j>>>8^M[j&255];var te=[];for(Ee=1;Ee!=16;++Ee)te[Ee-1]=typeof Int32Array<"u"?he.subarray(Ee*256,Ee*256+256):he.slice(Ee*256,Ee*256+256);return te}var s=n(t),c=s[0],h=s[1],d=s[2],m=s[3],g=s[4],v=s[5],_=s[6],C=s[7],T=s[8],N=s[9],S=s[10],D=s[11],U=s[12],X=s[13],O=s[14];function q(M,ie){for(var j=ie^-1,Ee=0,he=M.length;Ee<he;)j=j>>>8^t[(j^M.charCodeAt(Ee++))&255];return~j}function oe(M,ie){for(var j=ie^-1,Ee=M.length-15,he=0;he<Ee;)j=O[M[he++]^j&255]^X[M[he++]^j>>8&255]^U[M[he++]^j>>16&255]^D[M[he++]^j>>>24]^S[M[he++]]^N[M[he++]]^T[M[he++]]^C[M[he++]]^_[M[he++]]^v[M[he++]]^g[M[he++]]^m[M[he++]]^d[M[he++]]^h[M[he++]]^c[M[he++]]^t[M[he++]];for(Ee+=15;he<Ee;)j=j>>>8^t[(j^M[he++])&255];return~j}function J(M,ie){for(var j=ie^-1,Ee=0,he=M.length,te=0,be=0;Ee<he;)te=M.charCodeAt(Ee++),te<128?j=j>>>8^t[(j^te)&255]:te<2048?(j=j>>>8^t[(j^(192|te>>6&31))&255],j=j>>>8^t[(j^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,be=M.charCodeAt(Ee++)&1023,j=j>>>8^t[(j^(240|te>>8&7))&255],j=j>>>8^t[(j^(128|te>>2&63))&255],j=j>>>8^t[(j^(128|be>>6&15|(te&3)<<4))&255],j=j>>>8^t[(j^(128|be&63))&255]):(j=j>>>8^t[(j^(224|te>>12&15))&255],j=j>>>8^t[(j^(128|te>>6&63))&255],j=j>>>8^t[(j^(128|te&63))&255]);return~j}return e.table=t,e.bstr=q,e.buf=oe,e.str=J,e}(),mt=function(){var r={};r.version="1.2.1";function t(F,P){for(var L=F.split("/"),W=P.split("/"),H=0,z=0,me=Math.min(L.length,W.length);H<me;++H){if(z=L[H].length-W[H].length)return z;if(L[H]!=W[H])return L[H]<W[H]?-1:1}return L.length-W.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var P=F.lastIndexOf("/");return P===-1?F:F.slice(0,P+1)}function s(F){if(F.charAt(F.length-1)=="/")return s(F.slice(0,-1));var P=F.lastIndexOf("/");return P===-1?F:F.slice(P+1)}function c(F,P){typeof P=="string"&&(P=new Date(P));var L=P.getHours();L=L<<6|P.getMinutes(),L=L<<5|P.getSeconds()>>>1,F.write_shift(2,L);var W=P.getFullYear()-1980;W=W<<4|P.getMonth()+1,W=W<<5|P.getDate(),F.write_shift(2,W)}function h(F){var P=F.read_shift(2)&65535,L=F.read_shift(2)&65535,W=new Date,H=L&31;L>>>=5;var z=L&15;L>>>=4,W.setMilliseconds(0),W.setFullYear(L+1980),W.setMonth(z-1),W.setDate(H);var me=P&31;P>>>=5;var De=P&63;return P>>>=6,W.setHours(P),W.setMinutes(De),W.setSeconds(me<<1),W}function d(F){wa(F,0);for(var P={},L=0;F.l<=F.length-4;){var W=F.read_shift(2),H=F.read_shift(2),z=F.l+H,me={};switch(W){case 21589:L=F.read_shift(1),L&1&&(me.mtime=F.read_shift(4)),H>5&&(L&2&&(me.atime=F.read_shift(4)),L&4&&(me.ctime=F.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}F.l=z,P[W]=me}return P}var m;function g(){return m||(m={})}function v(F,P){if(F[0]==80&&F[1]==75)return vi(F,P);if((F[0]|32)==109&&(F[1]|32)==105)return Pn(F,P);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var L=3,W=512,H=0,z=0,me=0,De=0,xe=0,pe=[],ve=F.slice(0,512);wa(ve,0);var We=_(ve);switch(L=We[0],L){case 3:W=512;break;case 4:W=4096;break;case 0:if(We[1]==0)return vi(F,P);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}W!==512&&(ve=F.slice(0,W),wa(ve,28));var He=F.slice(0,W);C(ve,L);var Ye=ve.read_shift(4,"i");if(L===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);ve.l+=4,me=ve.read_shift(4,"i"),ve.l+=4,ve.chk("00100000","Mini Stream Cutoff Size: "),De=ve.read_shift(4,"i"),H=ve.read_shift(4,"i"),xe=ve.read_shift(4,"i"),z=ve.read_shift(4,"i");for(var Je=-1,nt=0;nt<109&&(Je=ve.read_shift(4,"i"),!(Je<0));++nt)pe[nt]=Je;var vt=T(F,W);D(xe,z,vt,W,pe);var Ce=X(vt,me,pe,W);Ce[me].name="!Directory",H>0&&De!==be&&(Ce[De].name="!MiniFAT"),Ce[pe[0]].name="!FAT",Ce.fat_addrs=pe,Ce.ssz=W;var lr={},Ft=[],ga=[],Bn=[];O(me,Ce,vt,Ft,H,lr,ga,De),N(ga,Bn,Ft),Ft.shift();var Ot={FileIndex:ga,FullPaths:Bn};return P&&P.raw&&(Ot.raw={header:He,sectors:vt}),Ot}function _(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk($e,"Header Signature: "),F.l+=16;var P=F.read_shift(2,"u");return[F.read_shift(2,"u"),P]}function C(F,P){var L=9;switch(F.l+=2,L=F.read_shift(2)){case 9:if(P!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(P!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function T(F,P){for(var L=Math.ceil(F.length/P)-1,W=[],H=1;H<L;++H)W[H-1]=F.slice(H*P,(H+1)*P);return W[L-1]=F.slice(L*P),W}function N(F,P,L){for(var W=0,H=0,z=0,me=0,De=0,xe=L.length,pe=[],ve=[];W<xe;++W)pe[W]=ve[W]=W,P[W]=L[W];for(;De<ve.length;++De)W=ve[De],H=F[W].L,z=F[W].R,me=F[W].C,pe[W]===W&&(H!==-1&&pe[H]!==H&&(pe[W]=pe[H]),z!==-1&&pe[z]!==z&&(pe[W]=pe[z])),me!==-1&&(pe[me]=W),H!==-1&&W!=pe[W]&&(pe[H]=pe[W],ve.lastIndexOf(H)<De&&ve.push(H)),z!==-1&&W!=pe[W]&&(pe[z]=pe[W],ve.lastIndexOf(z)<De&&ve.push(z));for(W=1;W<xe;++W)pe[W]===W&&(z!==-1&&pe[z]!==z?pe[W]=pe[z]:H!==-1&&pe[H]!==H&&(pe[W]=pe[H]));for(W=1;W<xe;++W)if(F[W].type!==0){if(De=W,De!=pe[De])do De=pe[De],P[W]=P[De]+"/"+P[W];while(De!==0&&pe[De]!==-1&&De!=pe[De]);pe[W]=-1}for(P[0]+="/",W=1;W<xe;++W)F[W].type!==2&&(P[W]+="/")}function S(F,P,L){for(var W=F.start,H=F.size,z=[],me=W;L&&H>0&&me>=0;)z.push(P.slice(me*te,me*te+te)),H-=te,me=rs(L,me*4);return z.length===0?Oe(0):ua(z).slice(0,F.size)}function D(F,P,L,W,H){var z=be;if(F===be){if(P!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var me=L[F],De=(W>>>2)-1;if(!me)return;for(var xe=0;xe<De&&(z=rs(me,xe*4))!==be;++xe)H.push(z);D(rs(me,W-4),P-1,L,W,H)}}function U(F,P,L,W,H){var z=[],me=[];H||(H=[]);var De=W-1,xe=0,pe=0;for(xe=P;xe>=0;){H[xe]=!0,z[z.length]=xe,me.push(F[xe]);var ve=L[Math.floor(xe*4/W)];if(pe=xe*4&De,W<4+pe)throw new Error("FAT boundary crossed: "+xe+" 4 "+W);if(!F[ve])break;xe=rs(F[ve],pe)}return{nodes:z,data:Pf([me])}}function X(F,P,L,W){var H=F.length,z=[],me=[],De=[],xe=[],pe=W-1,ve=0,We=0,He=0,Ye=0;for(ve=0;ve<H;++ve)if(De=[],He=ve+P,He>=H&&(He-=H),!me[He]){xe=[];var Je=[];for(We=He;We>=0;){Je[We]=!0,me[We]=!0,De[De.length]=We,xe.push(F[We]);var nt=L[Math.floor(We*4/W)];if(Ye=We*4&pe,W<4+Ye)throw new Error("FAT boundary crossed: "+We+" 4 "+W);if(!F[nt]||(We=rs(F[nt],Ye),Je[We]))break}z[He]={nodes:De,data:Pf([xe])}}return z}function O(F,P,L,W,H,z,me,De){for(var xe=0,pe=W.length?2:0,ve=P[F].data,We=0,He=0,Ye;We<ve.length;We+=128){var Je=ve.slice(We,We+128);wa(Je,64),He=Je.read_shift(2),Ye=El(Je,0,He-pe),W.push(Ye);var nt={name:Ye,type:Je.read_shift(1),color:Je.read_shift(1),L:Je.read_shift(4,"i"),R:Je.read_shift(4,"i"),C:Je.read_shift(4,"i"),clsid:Je.read_shift(16),state:Je.read_shift(4,"i"),start:0,size:0},vt=Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2);vt!==0&&(nt.ct=q(Je,Je.l-8));var Ce=Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2);Ce!==0&&(nt.mt=q(Je,Je.l-8)),nt.start=Je.read_shift(4,"i"),nt.size=Je.read_shift(4,"i"),nt.size<0&&nt.start<0&&(nt.size=nt.type=0,nt.start=be,nt.name=""),nt.type===5?(xe=nt.start,H>0&&xe!==be&&(P[xe].name="!StreamData")):nt.size>=4096?(nt.storage="fat",P[nt.start]===void 0&&(P[nt.start]=U(L,nt.start,P.fat_addrs,P.ssz)),P[nt.start].name=nt.name,nt.content=P[nt.start].data.slice(0,nt.size)):(nt.storage="minifat",nt.size<0?nt.size=0:xe!==be&&nt.start!==be&&P[xe]&&(nt.content=S(nt,P[xe].data,(P[De]||{}).data))),nt.content&&wa(nt.content,0),z[Ye]=nt,me.push(nt)}}function q(F,P){return new Date((nn(F,P+4)/1e7*Math.pow(2,32)+nn(F,P)/1e7-11644473600)*1e3)}function oe(F,P){return g(),v(m.readFileSync(F),P)}function J(F,P){var L=P&&P.type;switch(L||Gt&&Buffer.isBuffer(F)&&(L="buffer"),L||"base64"){case"file":return oe(F,P);case"base64":return v(sn(cn(F)),P);case"binary":return v(sn(F),P)}return v(F,P)}function M(F,P){var L=P||{},W=L.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=W+"/",F.FileIndex[0]={name:W,type:5}),L.CLSID&&(F.FileIndex[0].clsid=L.CLSID),ie(F)}function ie(F){var P="Sh33tJ5";if(!mt.find(F,"/"+P)){var L=Oe(4);L[0]=55,L[1]=L[3]=50,L[2]=54,F.FileIndex.push({name:P,type:2,content:L,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+P),j(F)}}function j(F,P){M(F);for(var L=!1,W=!1,H=F.FullPaths.length-1;H>=0;--H){var z=F.FileIndex[H];switch(z.type){case 0:W?L=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(z.R*z.L*z.C)&&(L=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!P)){var me=new Date(1987,1,19),De=0,xe=Object.create?Object.create(null):{},pe=[];for(H=0;H<F.FullPaths.length;++H)xe[F.FullPaths[H]]=!0,F.FileIndex[H].type!==0&&pe.push([F.FullPaths[H],F.FileIndex[H]]);for(H=0;H<pe.length;++H){var ve=n(pe[H][0]);W=xe[ve],W||(pe.push([ve,{name:s(ve).replace("/",""),type:1,clsid:tt,ct:me,mt:me,content:null}]),xe[ve]=!0)}for(pe.sort(function(Ye,Je){return t(Ye[0],Je[0])}),F.FullPaths=[],F.FileIndex=[],H=0;H<pe.length;++H)F.FullPaths[H]=pe[H][0],F.FileIndex[H]=pe[H][1];for(H=0;H<pe.length;++H){var We=F.FileIndex[H],He=F.FullPaths[H];if(We.name=s(He).replace("/",""),We.L=We.R=We.C=-(We.color=1),We.size=We.content?We.content.length:0,We.start=0,We.clsid=We.clsid||tt,H===0)We.C=pe.length>1?1:-1,We.size=0,We.type=5;else if(He.slice(-1)=="/"){for(De=H+1;De<pe.length&&n(F.FullPaths[De])!=He;++De);for(We.C=De>=pe.length?-1:De,De=H+1;De<pe.length&&n(F.FullPaths[De])!=n(He);++De);We.R=De>=pe.length?-1:De,We.type=1}else n(F.FullPaths[H+1]||"")==n(He)&&(We.R=H+1),We.type=2}}}function Ee(F,P){var L=P||{};if(L.fileType=="mad")return Wa(F,L);switch(j(F),L.fileType){case"zip":return Ya(F,L)}var W=function(Ye){for(var Je=0,nt=0,vt=0;vt<Ye.FileIndex.length;++vt){var Ce=Ye.FileIndex[vt];if(Ce.content){var lr=Ce.content.length;lr>0&&(lr<4096?Je+=lr+63>>6:nt+=lr+511>>9)}}for(var Ft=Ye.FullPaths.length+3>>2,ga=Je+7>>3,Bn=Je+127>>7,Ot=ga+nt+Ft+Bn,It=Ot+127>>7,Nt=It<=109?0:Math.ceil((It-109)/127);Ot+It+Nt+127>>7>It;)Nt=++It<=109?0:Math.ceil((It-109)/127);var ra=[1,Nt,It,Bn,Ft,nt,Je,0];return Ye.FileIndex[0].size=Je<<6,ra[7]=(Ye.FileIndex[0].start=ra[0]+ra[1]+ra[2]+ra[3]+ra[4]+ra[5])+(ra[6]+7>>3),ra}(F),H=Oe(W[7]<<9),z=0,me=0;{for(z=0;z<8;++z)H.write_shift(1,ae[z]);for(z=0;z<8;++z)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),z=0;z<3;++z)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,W[2]),H.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:be),H.write_shift(4,W[3]),H.write_shift(-4,W[1]?W[0]-1:be),H.write_shift(4,W[1]),z=0;z<109;++z)H.write_shift(-4,z<W[2]?W[1]+z:-1)}if(W[1])for(me=0;me<W[1];++me){for(;z<236+me*127;++z)H.write_shift(-4,z<W[2]?W[1]+z:-1);H.write_shift(-4,me===W[1]-1?be:me+1)}var De=function(Ye){for(me+=Ye;z<me-1;++z)H.write_shift(-4,z+1);Ye&&(++z,H.write_shift(-4,be))};for(me=z=0,me+=W[1];z<me;++z)H.write_shift(-4,Re.DIFSECT);for(me+=W[2];z<me;++z)H.write_shift(-4,Re.FATSECT);De(W[3]),De(W[4]);for(var xe=0,pe=0,ve=F.FileIndex[0];xe<F.FileIndex.length;++xe)ve=F.FileIndex[xe],ve.content&&(pe=ve.content.length,!(pe<4096)&&(ve.start=me,De(pe+511>>9)));for(De(W[6]+7>>3);H.l&511;)H.write_shift(-4,Re.ENDOFCHAIN);for(me=z=0,xe=0;xe<F.FileIndex.length;++xe)ve=F.FileIndex[xe],ve.content&&(pe=ve.content.length,!(!pe||pe>=4096)&&(ve.start=me,De(pe+63>>6)));for(;H.l&511;)H.write_shift(-4,Re.ENDOFCHAIN);for(z=0;z<W[4]<<2;++z){var We=F.FullPaths[z];if(!We||We.length===0){for(xe=0;xe<17;++xe)H.write_shift(4,0);for(xe=0;xe<3;++xe)H.write_shift(4,-1);for(xe=0;xe<12;++xe)H.write_shift(4,0);continue}ve=F.FileIndex[z],z===0&&(ve.start=ve.size?ve.start-1:be);var He=z===0&&L.root||ve.name;if(pe=2*(He.length+1),H.write_shift(64,He,"utf16le"),H.write_shift(2,pe),H.write_shift(1,ve.type),H.write_shift(1,ve.color),H.write_shift(-4,ve.L),H.write_shift(-4,ve.R),H.write_shift(-4,ve.C),ve.clsid)H.write_shift(16,ve.clsid,"hex");else for(xe=0;xe<4;++xe)H.write_shift(4,0);H.write_shift(4,ve.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,ve.start),H.write_shift(4,ve.size),H.write_shift(4,0)}for(z=1;z<F.FileIndex.length;++z)if(ve=F.FileIndex[z],ve.size>=4096)if(H.l=ve.start+1<<9,Gt&&Buffer.isBuffer(ve.content))ve.content.copy(H,H.l,0,ve.size),H.l+=ve.size+511&-512;else{for(xe=0;xe<ve.size;++xe)H.write_shift(1,ve.content[xe]);for(;xe&511;++xe)H.write_shift(1,0)}for(z=1;z<F.FileIndex.length;++z)if(ve=F.FileIndex[z],ve.size>0&&ve.size<4096)if(Gt&&Buffer.isBuffer(ve.content))ve.content.copy(H,H.l,0,ve.size),H.l+=ve.size+63&-64;else{for(xe=0;xe<ve.size;++xe)H.write_shift(1,ve.content[xe]);for(;xe&63;++xe)H.write_shift(1,0)}if(Gt)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function he(F,P){var L=F.FullPaths.map(function(xe){return xe.toUpperCase()}),W=L.map(function(xe){var pe=xe.split("/");return pe[pe.length-(xe.slice(-1)=="/"?2:1)]}),H=!1;P.charCodeAt(0)===47?(H=!0,P=L[0].slice(0,-1)+P):H=P.indexOf("/")!==-1;var z=P.toUpperCase(),me=H===!0?L.indexOf(z):W.indexOf(z);if(me!==-1)return F.FileIndex[me];var De=!z.match(m0);for(z=z.replace(ja,""),De&&(z=z.replace(m0,"!")),me=0;me<L.length;++me)if((De?L[me].replace(m0,"!"):L[me]).replace(ja,"")==z||(De?W[me].replace(m0,"!"):W[me]).replace(ja,"")==z)return F.FileIndex[me];return null}var te=64,be=-2,$e="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],tt="00000000000000000000000000000000",Re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:be,FREESECT:-1,HEADER_SIGNATURE:$e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:tt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ut(F,P,L){g();var W=Ee(F,L);m.writeFileSync(P,W)}function fe(F){for(var P=new Array(F.length),L=0;L<F.length;++L)P[L]=String.fromCharCode(F[L]);return P.join("")}function ot(F,P){var L=Ee(F,P);switch(P&&P.type||"buffer"){case"file":return g(),m.writeFileSync(P.filename,L),L;case"binary":return typeof L=="string"?L:fe(L);case"base64":return T0(typeof L=="string"?L:fe(L));case"buffer":if(Gt)return Buffer.isBuffer(L)?L:mi(L);case"array":return typeof L=="string"?sn(L):L}return L}var pt;function K(F){try{var P=F.InflateRaw,L=new P;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)pt=F;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function ce(F,P){if(!pt)return Mn(F,P);var L=pt.InflateRaw,W=new L,H=W._processChunk(F.slice(F.l),W._finishFlushFlag);return F.l+=W.bytesRead,H}function ee(F){return pt?pt.deflateRawSync(F):St(F)}var ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],qe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Le(F){var P=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(P>>16|P>>8|P)&255}for(var Pe=typeof Uint8Array<"u",Be=Pe?new Uint8Array(256):[],Te=0;Te<256;++Te)Be[Te]=Le(Te);function A(F,P){var L=Be[F&255];return P<=8?L>>>8-P:(L=L<<8|Be[F>>8&255],P<=16?L>>>16-P:(L=L<<8|Be[F>>16&255],L>>>24-P))}function Y(F,P){var L=P&7,W=P>>>3;return(F[W]|(L<=6?0:F[W+1]<<8))>>>L&3}function ht(F,P){var L=P&7,W=P>>>3;return(F[W]|(L<=5?0:F[W+1]<<8))>>>L&7}function lt(F,P){var L=P&7,W=P>>>3;return(F[W]|(L<=4?0:F[W+1]<<8))>>>L&15}function ze(F,P){var L=P&7,W=P>>>3;return(F[W]|(L<=3?0:F[W+1]<<8))>>>L&31}function Me(F,P){var L=P&7,W=P>>>3;return(F[W]|(L<=1?0:F[W+1]<<8))>>>L&127}function ft(F,P,L){var W=P&7,H=P>>>3,z=(1<<L)-1,me=F[H]>>>W;return L<8-W||(me|=F[H+1]<<8-W,L<16-W)||(me|=F[H+2]<<16-W,L<24-W)||(me|=F[H+3]<<24-W),me&z}function Et(F,P,L){var W=P&7,H=P>>>3;return W<=5?F[H]|=(L&7)<<W:(F[H]|=L<<W&255,F[H+1]=(L&7)>>8-W),P+3}function Kr(F,P,L){var W=P&7,H=P>>>3;return L=(L&1)<<W,F[H]|=L,P+1}function st(F,P,L){var W=P&7,H=P>>>3;return L<<=W,F[H]|=L&255,L>>>=8,F[H+1]=L,P+8}function An(F,P,L){var W=P&7,H=P>>>3;return L<<=W,F[H]|=L&255,L>>>=8,F[H+1]=L&255,F[H+2]=L>>>8,P+16}function ln(F,P){var L=F.length,W=2*L>P?2*L:P+5,H=0;if(L>=P)return F;if(Gt){var z=pf(W);if(F.copy)F.copy(z);else for(;H<F.length;++H)z[H]=F[H];return z}else if(Pe){var me=new Uint8Array(W);if(me.set)me.set(F);else for(;H<L;++H)me[H]=F[H];return me}return F.length=W,F}function Dr(F){for(var P=new Array(F),L=0;L<F;++L)P[L]=0;return P}function xa(F,P,L){var W=1,H=0,z=0,me=0,De=0,xe=F.length,pe=Pe?new Uint16Array(32):Dr(32);for(z=0;z<32;++z)pe[z]=0;for(z=xe;z<L;++z)F[z]=0;xe=F.length;var ve=Pe?new Uint16Array(xe):Dr(xe);for(z=0;z<xe;++z)pe[H=F[z]]++,W<H&&(W=H),ve[z]=0;for(pe[0]=0,z=1;z<=W;++z)pe[z+16]=De=De+pe[z-1]<<1;for(z=0;z<xe;++z)De=F[z],De!=0&&(ve[z]=pe[De+16]++);var We=0;for(z=0;z<xe;++z)if(We=F[z],We!=0)for(De=A(ve[z],W)>>W-We,me=(1<<W+4-We)-1;me>=0;--me)P[De|me<<We]=We&15|z<<4;return W}var Or=Pe?new Uint16Array(512):Dr(512),$n=Pe?new Uint16Array(32):Dr(32);if(!Pe){for(var Ar=0;Ar<512;++Ar)Or[Ar]=0;for(Ar=0;Ar<32;++Ar)$n[Ar]=0}(function(){for(var F=[],P=0;P<32;P++)F.push(5);xa(F,$n,32);var L=[];for(P=0;P<=143;P++)L.push(8);for(;P<=255;P++)L.push(9);for(;P<=279;P++)L.push(7);for(;P<=287;P++)L.push(8);xa(L,Or,288)})();var Yt=function(){for(var P=Pe?new Uint8Array(32768):[],L=0,W=0;L<qe.length-1;++L)for(;W<qe[L+1];++W)P[W]=L;for(;W<32768;++W)P[W]=29;var H=Pe?new Uint8Array(259):[];for(L=0,W=0;L<le.length-1;++L)for(;W<le[L+1];++W)H[W]=L;function z(De,xe){for(var pe=0;pe<De.length;){var ve=Math.min(65535,De.length-pe),We=pe+ve==De.length;for(xe.write_shift(1,+We),xe.write_shift(2,ve),xe.write_shift(2,~ve&65535);ve-- >0;)xe[xe.l++]=De[pe++]}return xe.l}function me(De,xe){for(var pe=0,ve=0,We=Pe?new Uint16Array(32768):[];ve<De.length;){var He=Math.min(65535,De.length-ve);if(He<10){for(pe=Et(xe,pe,+(ve+He==De.length)),pe&7&&(pe+=8-(pe&7)),xe.l=pe/8|0,xe.write_shift(2,He),xe.write_shift(2,~He&65535);He-- >0;)xe[xe.l++]=De[ve++];pe=xe.l*8;continue}pe=Et(xe,pe,+(ve+He==De.length)+2);for(var Ye=0;He-- >0;){var Je=De[ve];Ye=(Ye<<5^Je)&32767;var nt=-1,vt=0;if((nt=We[Ye])&&(nt|=ve&-32768,nt>ve&&(nt-=32768),nt<ve))for(;De[nt+vt]==De[ve+vt]&&vt<250;)++vt;if(vt>2){Je=H[vt],Je<=22?pe=st(xe,pe,Be[Je+1]>>1)-1:(st(xe,pe,3),pe+=5,st(xe,pe,Be[Je-23]>>5),pe+=3);var Ce=Je<8?0:Je-4>>2;Ce>0&&(An(xe,pe,vt-le[Je]),pe+=Ce),Je=P[ve-nt],pe=st(xe,pe,Be[Je]>>3),pe-=3;var lr=Je<4?0:Je-2>>1;lr>0&&(An(xe,pe,ve-nt-qe[Je]),pe+=lr);for(var Ft=0;Ft<vt;++Ft)We[Ye]=ve&32767,Ye=(Ye<<5^De[ve])&32767,++ve;He-=vt-1}else Je<=143?Je=Je+48:pe=Kr(xe,pe,1),pe=st(xe,pe,Be[Je]),We[Ye]=ve&32767,++ve}pe=st(xe,pe,0)-1}return xe.l=(pe+7)/8|0,xe.l}return function(xe,pe){return xe.length<8?z(xe,pe):me(xe,pe)}}();function St(F){var P=Oe(50+Math.floor(F.length*1.1)),L=Yt(F,P);return P.slice(0,L)}var cr=Pe?new Uint16Array(32768):Dr(32768),sa=Pe?new Uint16Array(32768):Dr(32768),Mt=Pe?new Uint16Array(128):Dr(128),Qe=1,br=1;function ar(F,P){var L=ze(F,P)+257;P+=5;var W=ze(F,P)+1;P+=5;var H=lt(F,P)+4;P+=4;for(var z=0,me=Pe?new Uint8Array(19):Dr(19),De=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],xe=1,pe=Pe?new Uint8Array(8):Dr(8),ve=Pe?new Uint8Array(8):Dr(8),We=me.length,He=0;He<H;++He)me[ne[He]]=z=ht(F,P),xe<z&&(xe=z),pe[z]++,P+=3;var Ye=0;for(pe[0]=0,He=1;He<=xe;++He)ve[He]=Ye=Ye+pe[He-1]<<1;for(He=0;He<We;++He)(Ye=me[He])!=0&&(De[He]=ve[Ye]++);var Je=0;for(He=0;He<We;++He)if(Je=me[He],Je!=0){Ye=Be[De[He]]>>8-Je;for(var nt=(1<<7-Je)-1;nt>=0;--nt)Mt[Ye|nt<<Je]=Je&7|He<<3}var vt=[];for(xe=1;vt.length<L+W;)switch(Ye=Mt[Me(F,P)],P+=Ye&7,Ye>>>=3){case 16:for(z=3+Y(F,P),P+=2,Ye=vt[vt.length-1];z-- >0;)vt.push(Ye);break;case 17:for(z=3+ht(F,P),P+=3;z-- >0;)vt.push(0);break;case 18:for(z=11+Me(F,P),P+=7;z-- >0;)vt.push(0);break;default:vt.push(Ye),xe<Ye&&(xe=Ye);break}var Ce=vt.slice(0,L),lr=vt.slice(L);for(He=L;He<286;++He)Ce[He]=0;for(He=W;He<30;++He)lr[He]=0;return Qe=xa(Ce,cr,286),br=xa(lr,sa,30),P}function pr(F,P){if(F[0]==3&&!(F[1]&3))return[Pi(P),2];for(var L=0,W=0,H=pf(P||1<<18),z=0,me=H.length>>>0,De=0,xe=0;!(W&1);){if(W=ht(F,L),L+=3,W>>>1)W>>1==1?(De=9,xe=5):(L=ar(F,L),De=Qe,xe=br);else{L&7&&(L+=8-(L&7));var pe=F[L>>>3]|F[(L>>>3)+1]<<8;if(L+=32,pe>0)for(!P&&me<z+pe&&(H=ln(H,z+pe),me=H.length);pe-- >0;)H[z++]=F[L>>>3],L+=8;continue}for(;;){!P&&me<z+32767&&(H=ln(H,z+32767),me=H.length);var ve=ft(F,L,De),We=W>>>1==1?Or[ve]:cr[ve];if(L+=We&15,We>>>=4,!(We>>>8&255))H[z++]=We;else{if(We==256)break;We-=257;var He=We<8?0:We-4>>2;He>5&&(He=0);var Ye=z+le[We];He>0&&(Ye+=ft(F,L,He),L+=He),ve=ft(F,L,xe),We=W>>>1==1?$n[ve]:sa[ve],L+=We&15,We>>>=4;var Je=We<4?0:We-2>>1,nt=qe[We];for(Je>0&&(nt+=ft(F,L,Je),L+=Je),!P&&me<Ye&&(H=ln(H,Ye+100),me=H.length);z<Ye;)H[z]=H[z-nt],++z}}}return P?[H,L+7>>>3]:[H.slice(0,z),L+7>>>3]}function Mn(F,P){var L=F.slice(F.l||0),W=pr(L,P);return F.l+=W[1],W[0]}function fn(F,P){if(F)typeof console<"u"&&console.error(P);else throw new Error(P)}function vi(F,P){var L=F;wa(L,0);var W=[],H=[],z={FileIndex:W,FullPaths:H};M(z,{root:P.root});for(var me=L.length-4;(L[me]!=80||L[me+1]!=75||L[me+2]!=5||L[me+3]!=6)&&me>=0;)--me;L.l=me+4,L.l+=4;var De=L.read_shift(2);L.l+=6;var xe=L.read_shift(4);for(L.l=xe,me=0;me<De;++me){L.l+=20;var pe=L.read_shift(4),ve=L.read_shift(4),We=L.read_shift(2),He=L.read_shift(2),Ye=L.read_shift(2);L.l+=8;var Je=L.read_shift(4),nt=d(L.slice(L.l+We,L.l+We+He));L.l+=We+He+Ye;var vt=L.l;L.l=Je+4,Bt(L,pe,ve,z,nt),L.l=vt}return z}function Bt(F,P,L,W,H){F.l+=2;var z=F.read_shift(2),me=F.read_shift(2),De=h(F);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var xe=F.read_shift(4),pe=F.read_shift(4),ve=F.read_shift(4),We=F.read_shift(2),He=F.read_shift(2),Ye="",Je=0;Je<We;++Je)Ye+=String.fromCharCode(F[F.l++]);if(He){var nt=d(F.slice(F.l,F.l+He));(nt[21589]||{}).mt&&(De=nt[21589].mt),((H||{})[21589]||{}).mt&&(De=H[21589].mt)}F.l+=He;var vt=F.slice(F.l,F.l+pe);switch(me){case 8:vt=ce(F,ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var Ce=!1;z&8&&(xe=F.read_shift(4),xe==134695760&&(xe=F.read_shift(4),Ce=!0),pe=F.read_shift(4),ve=F.read_shift(4)),pe!=P&&fn(Ce,"Bad compressed size: "+P+" != "+pe),ve!=L&&fn(Ce,"Bad uncompressed size: "+L+" != "+ve),ta(W,Ye,vt,{unsafe:!0,mt:De})}function Ya(F,P){var L=P||{},W=[],H=[],z=Oe(1),me=L.compression?8:0,De=0,xe=0,pe=0,ve=0,We=0,He=F.FullPaths[0],Ye=He,Je=F.FileIndex[0],nt=[],vt=0;for(xe=1;xe<F.FullPaths.length;++xe)if(Ye=F.FullPaths[xe].slice(He.length),Je=F.FileIndex[xe],!(!Je.size||!Je.content||Ye=="Sh33tJ5")){var Ce=ve,lr=Oe(Ye.length);for(pe=0;pe<Ye.length;++pe)lr.write_shift(1,Ye.charCodeAt(pe)&127);lr=lr.slice(0,lr.l),nt[We]=Ox.buf(Je.content,0);var Ft=Je.content;me==8&&(Ft=ee(Ft)),z=Oe(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,De),z.write_shift(2,me),Je.mt?c(z,Je.mt):z.write_shift(4,0),z.write_shift(-4,nt[We]),z.write_shift(4,Ft.length),z.write_shift(4,Je.content.length),z.write_shift(2,lr.length),z.write_shift(2,0),ve+=z.length,W.push(z),ve+=lr.length,W.push(lr),ve+=Ft.length,W.push(Ft),z=Oe(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,De),z.write_shift(2,me),z.write_shift(4,0),z.write_shift(-4,nt[We]),z.write_shift(4,Ft.length),z.write_shift(4,Je.content.length),z.write_shift(2,lr.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Ce),vt+=z.l,H.push(z),vt+=lr.length,H.push(lr),++We}return z=Oe(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,We),z.write_shift(2,We),z.write_shift(4,vt),z.write_shift(4,ve),z.write_shift(2,0),ua([ua(W),ua(H),z])}var Ua={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Hi(F,P){if(F.ctype)return F.ctype;var L=F.name||"",W=L.match(/\.([^\.]+)$/);return W&&Ua[W[1]]||P&&(W=(L=P).match(/[\.\\]([^\.\\])+$/),W&&Ua[W[1]])?Ua[W[1]]:"application/octet-stream"}function oa(F){for(var P=T0(F),L=[],W=0;W<P.length;W+=76)L.push(P.slice(W,W+76));return L.join(`\r
`)+`\r
`}function yi(F){var P=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var ve=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(ve.length==1?"0"+ve:ve)});P=P.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),P.charAt(0)==`
`&&(P="=0D"+P.slice(1)),P=P.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],W=P.split(`\r
`),H=0;H<W.length;++H){var z=W[H];if(z.length==0){L.push("");continue}for(var me=0;me<z.length;){var De=76,xe=z.slice(me,me+De);xe.charAt(De-1)=="="?De--:xe.charAt(De-2)=="="?De-=2:xe.charAt(De-3)=="="&&(De-=3),xe=z.slice(me,me+De),me+=De,me<z.length&&(xe+="="),L.push(xe)}}return L.join(`\r
`)}function Er(F){for(var P=[],L=0;L<F.length;++L){for(var W=F[L];L<=F.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+F[++L];P.push(W)}for(var H=0;H<P.length;++H)P[H]=P[H].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return sn(P.join(`\r
`))}function Ka(F,P,L){for(var W="",H="",z="",me,De=0;De<10;++De){var xe=P[De];if(!xe||xe.match(/^\s*$/))break;var pe=xe.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":W=pe[2].trim();break;case"content-type":z=pe[2].trim();break;case"content-transfer-encoding":H=pe[2].trim();break}}switch(++De,H.toLowerCase()){case"base64":me=sn(cn(P.slice(De).join("")));break;case"quoted-printable":me=Er(P.slice(De));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var ve=ta(F,W.slice(L.length),me,{unsafe:!0});z&&(ve.ctype=z)}function Pn(F,P){if(fe(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=P&&P.root||"",W=(Gt&&Buffer.isBuffer(F)?F.toString("binary"):fe(F)).split(`\r
`),H=0,z="";for(H=0;H<W.length;++H)if(z=W[H],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),L||(L=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),z.slice(0,L.length)!=L););var me=(W[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var De="--"+(me[1]||""),xe=[],pe=[],ve={FileIndex:xe,FullPaths:pe};M(ve);var We,He=0;for(H=0;H<W.length;++H){var Ye=W[H];Ye!==De&&Ye!==De+"--"||(He++&&Ka(ve,W.slice(We,H),L),We=H)}return ve}function Wa(F,P){var L=P||{},W=L.boundary||"SheetJS";W="------="+W;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],z=F.FullPaths[0],me=z,De=F.FileIndex[0],xe=1;xe<F.FullPaths.length;++xe)if(me=F.FullPaths[xe].slice(z.length),De=F.FileIndex[xe],!(!De.size||!De.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(vt){return"_x"+vt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(vt){return"_u"+vt.charCodeAt(0).toString(16)+"_"});for(var pe=De.content,ve=Gt&&Buffer.isBuffer(pe)?pe.toString("binary"):fe(pe),We=0,He=Math.min(1024,ve.length),Ye=0,Je=0;Je<=He;++Je)(Ye=ve.charCodeAt(Je))>=32&&Ye<128&&++We;var nt=We>=He*4/5;H.push(W),H.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+me),H.push("Content-Transfer-Encoding: "+(nt?"quoted-printable":"base64")),H.push("Content-Type: "+Hi(De,me)),H.push(""),H.push(nt?yi(ve):oa(ve))}return H.push(W+`--\r
`),H.join(`\r
`)}function ya(F){var P={};return M(P,F),P}function ta(F,P,L,W){var H=W&&W.unsafe;H||M(F);var z=!H&&mt.find(F,P);if(!z){var me=F.FullPaths[0];P.slice(0,me.length)==me?me=P:(me.slice(-1)!="/"&&(me+="/"),me=(me+P).replace("//","/")),z={name:s(P),type:2},F.FileIndex.push(z),F.FullPaths.push(me),H||mt.utils.cfb_gc(F)}return z.content=L,z.size=L?L.length:0,W&&(W.CLSID&&(z.clsid=W.CLSID),W.mt&&(z.mt=W.mt),W.ct&&(z.ct=W.ct)),z}function bn(F,P){M(F);var L=mt.find(F,P);if(L){for(var W=0;W<F.FileIndex.length;++W)if(F.FileIndex[W]==L)return F.FileIndex.splice(W,1),F.FullPaths.splice(W,1),!0}return!1}function qr(F,P,L){M(F);var W=mt.find(F,P);if(W){for(var H=0;H<F.FileIndex.length;++H)if(F.FileIndex[H]==W)return F.FileIndex[H].name=s(L),F.FullPaths[H]=L,!0}return!1}function Oa(F){j(F,!0)}return r.find=he,r.read=J,r.parse=v,r.write=ot,r.writeFile=Ut,r.utils={cfb_new:ya,cfb_add:ta,cfb_del:bn,cfb_mov:qr,cfb_gc:Oa,ReadShift:w0,CheckField:gh,prep_blob:wa,bconcat:ua,use_zlib:K,_deflateRaw:St,_inflateRaw:Mn,consts:Re},r}();function Rx(e){return typeof e=="string"?rc(e):Array.isArray(e)?sx(e):e}function U0(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=rc(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?Zn(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([Rx(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:e,saveAs:!0});var h=document.createElement("a");if(h.download!=null)return h.download=e,h.href=c,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(r)&&(r=Ui(r)),d.write(r),d.close(),r}catch(m){if(!m.message||!m.message.match(/onstruct/))throw m}throw new Error("cannot save file "+e)}function Mx(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Wr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Sf(e,r){for(var t=[],n=Wr(e),s=0;s!==n.length;++s)t[e[n[s]][r]]==null&&(t[e[n[s]][r]]=n[s]);return t}function nc(e){for(var r=[],t=Wr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function ic(e){for(var r=[],t=Wr(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function Px(e){for(var r=[],t=Wr(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var Go=new Date(1899,11,30,0,0,0);function ia(e,r){var t=e.getTime(),n=Go.getTime()+(e.getTimezoneOffset()-Go.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var K1=new Date,Bx=Go.getTime()+(K1.getTimezoneOffset()-Go.getTimezoneOffset())*6e4,Cf=K1.getTimezoneOffset();function sc(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Bx),r.getTimezoneOffset()!==Cf&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Cf)*6e4),r}function Lx(e){var r=0,t=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var c=1;c!=s.length;++c)if(s[c]){switch(t=1,c>3&&(n=!0),s[c].slice(s[c].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[c].slice(s[c].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(s[c],10)}return r}var Tf=new Date("2017-02-19T19:06:09.000Z"),q1=isNaN(Tf.getFullYear())?new Date("2/19/17"):Tf,jx=q1.getFullYear()==2017;function kr(e,r){var t=new Date(e);if(jx)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(q1.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function ls(e,r){if(Gt&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Zn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Zn(P1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Zn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Zn(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(c){return t[c]||c})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Ir(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Ir(e[t]));return r}function jr(e,r){for(var t="";t.length<r;)t+=e;return t}function On(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,c){return t=-t,c}),!isNaN(r=Number(n)))?r/t:r}var Ux=["january","february","march","april","may","june","july","august","september","october","november","december"];function Xs(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),s=r.getMonth(),c=r.getDate();if(isNaN(c))return t;var h=e.toLowerCase();if(h.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(h=h.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),h.length>3&&Ux.indexOf(h)==-1)return t}else if(h.match(/[a-z]/))return t;return n<0||n>8099?t:(s>0||c>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var Wx=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,s){if(e||typeof n=="string")return t.split(n);for(var c=t.split(n),h=[c[0]],d=1;d<c.length;++d)h.push(s),h.push(c[d]);return h}}();function Z1(e){return e?e.content&&e.type?ls(e.content,!0):e.data?g0(e.data):e.asNodeBuffer&&Gt?g0(e.asNodeBuffer().toString("binary")):e.asBinary?g0(e.asBinary()):e._data&&e._data.getContent?g0(ls(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function J1(e){if(!e)return null;if(e.data)return gf(e.data);if(e.asNodeBuffer&&Gt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?gf(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Vx(e){return e&&e.name.slice(-4)===".bin"?J1(e):Z1(e)}function wn(e,r){for(var t=e.FullPaths||Wr(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),c=0;c<t.length;++c){var h=t[c].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==h||s==h)return e.files?e.files[t[c]]:e.FileIndex[c]}return null}function gl(e,r){var t=wn(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function $r(e,r,t){if(!t)return Vx(gl(e,r));if(!r)return null;try{return $r(e,r)}catch{return null}}function on(e,r,t){if(!t)return Z1(gl(e,r));if(!r)return null;try{return on(e,r)}catch{return null}}function Hx(e,r,t){return J1(gl(e,r))}function Nf(e){for(var r=e.FullPaths||Wr(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function Vt(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Gt?n=mi(t):n=ox(t),mt.utils.cfb_add(e,r,n)}mt.utils.cfb_add(e,r,t)}else e.file(r,t)}function ml(){return mt.utils.cfb_new()}function Q1(e,r){switch(r.type){case"base64":return mt.read(e,{type:"base64"});case"binary":return mt.read(e,{type:"binary"});case"buffer":case"array":return mt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function p0(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?t.pop():s!=="."&&t.push(s)}return t.join("/")}var Yr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Gx=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,kf=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Xx=/<[^>]*>/g,Fa=Yr.match(kf)?kf:Xx,zx=/<\w*:/,Yx=/<(\/?)\w+:/;function Tt(e,r,t){for(var n={},s=0,c=0;s!==e.length&&!((c=e.charCodeAt(s))===32||c===10||c===13);++s);if(r||(n[0]=e.slice(0,s)),s===e.length)return n;var h=e.match(Gx),d=0,m="",g=0,v="",_="",C=1;if(h)for(g=0;g!=h.length;++g){for(_=h[g],c=0;c!=_.length&&_.charCodeAt(c)!==61;++c);for(v=_.slice(0,c).trim();_.charCodeAt(c+1)==32;)++c;for(C=(s=_.charCodeAt(c+1))==34||s==39?1:0,m=_.slice(c+1+C,_.length-C),d=0;d!=v.length&&v.charCodeAt(d)!==58;++d);if(d===v.length)v.indexOf("_")>0&&(v=v.slice(0,v.indexOf("_"))),n[v]=m,n[v.toLowerCase()]=m;else{var T=(d===5&&v.slice(0,5)==="xmlns"?"xmlns":"")+v.slice(d+1);if(n[T]&&v.slice(d-3,d)=="ext")continue;n[T]=m,n[T.toLowerCase()]=m}}return n}function Jn(e){return e.replace(Yx,"<$1")}var $1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},pl=nc($1),$t=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var s=n+"",c=s.indexOf("<![CDATA[");if(c==-1)return s.replace(e,function(d,m){return $1[d]||String.fromCharCode(parseInt(m,d.indexOf("x")>-1?16:10))||d}).replace(r,function(d,m){return String.fromCharCode(parseInt(m,16))});var h=s.indexOf("]]>");return t(s.slice(0,c))+s.slice(c+9,h)+t(s.slice(h+3))}}(),wl=/[&<>'"]/g,Kx=/[\u0000-\u0008\u000b-\u001f]/g;function ur(e){var r=e+"";return r.replace(wl,function(t){return pl[t]}).replace(Kx,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function If(e){return ur(e).replace(/ /g,"_x0020_")}var eh=/[\u0000-\u001f]/g;function vl(e){var r=e+"";return r.replace(wl,function(t){return pl[t]}).replace(/\n/g,"<br/>").replace(eh,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function qx(e){var r=e+"";return r.replace(wl,function(t){return pl[t]}).replace(eh,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Df=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function Zx(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Nr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Pc(e){for(var r="",t=0,n=0,s=0,c=0,h=0,d=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(s=e.charCodeAt(t++),n>191&&n<224){h=(n&31)<<6,h|=s&63,r+=String.fromCharCode(h);continue}if(c=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(s&63)<<6|c&63);continue}h=e.charCodeAt(t++),d=((n&7)<<18|(s&63)<<12|(c&63)<<6|h&63)-65536,r+=String.fromCharCode(55296+(d>>>10&1023)),r+=String.fromCharCode(56320+(d&1023))}return r}function Ff(e){var r=Pi(2*e.length),t,n,s=1,c=0,h=0,d;for(n=0;n<e.length;n+=s)s=1,(d=e.charCodeAt(n))<128?t=d:d<224?(t=(d&31)*64+(e.charCodeAt(n+1)&63),s=2):d<240?(t=(d&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,t=(d&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,h=55296+(t>>>10&1023),t=56320+(t&1023)),h!==0&&(r[c++]=h&255,r[c++]=h>>>8,h=0),r[c++]=t%256,r[c++]=t>>>8;return r.slice(0,c).toString("ucs2")}function Of(e){return mi(e,"binary").toString("utf8")}var To="foo bar bazâð£",mr=Gt&&(Of(To)==Pc(To)&&Of||Ff(To)==Pc(To)&&Ff)||Pc,Zn=Gt?function(e){return mi(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,s=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(s>>18&7))),r.push(String.fromCharCode(144+(s>>12&63))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},k0=function(){var e={};return function(t,n){var s=t+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),th=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),Jx=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Qx=/<\/?(?:vt:)?variant>/g,$x=/<(?:vt:)([^>]*)>([\s\S]*)</;function Rf(e,r){var t=Tt(e),n=e.match(Jx(t.baseType))||[],s=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return s}return n.forEach(function(c){var h=c.replace(Qx,"").match($x);h&&s.push({v:mr(h[2]),t:h[1]})}),s}var rh=/(^\s|\s$|\n)/;function va(e,r){return"<"+e+(r.match(rh)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function I0(e){return Wr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function rt(e,r,t){return"<"+e+(t!=null?I0(t):"")+(r!=null?(r.match(rh)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function qc(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function eg(e,r){switch(typeof e){case"string":var t=rt("vt:lpwstr",ur(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return rt((e|0)==e?"vt:i4":"vt:r8",ur(String(e)));case"boolean":return rt("vt:bool",e?"true":"false")}if(e instanceof Date)return rt("vt:filetime",qc(e));throw new Error("Unable to serialize "+e)}function yl(e){if(Gt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return mr(Ui(ul(e)));throw new Error("Bad input format: expected Buffer or string")}var D0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,na={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},gs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],an={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function tg(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),s=e[r+6]&15,c=5;c>=0;--c)s=s*256+e[r+c];return n==2047?s==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),t*Math.pow(2,n-52)*s)}function rg(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,s=0,c=0,h=n?-r:r;isFinite(h)?h==0?s=c=0:(s=Math.floor(Math.log(h)/Math.LN2),c=h*Math.pow(2,52-s),s<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?s=-1022:(c-=Math.pow(2,52),s+=1023)):(s=2047,c=isNaN(r)?26985:0);for(var d=0;d<=5;++d,c/=256)e[t+d]=c&255;e[t+6]=(s&15)<<4|c&15,e[t+7]=s>>4|n}var Mf=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,c=e[0][n].length;s<c;s+=t)r.push.apply(r,e[0][n].slice(s,s+t));return r},Pf=Gt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:mi(r)})):Mf(e)}:Mf,Bf=function(e,r,t){for(var n=[],s=r;s<t;s+=2)n.push(String.fromCharCode(hi(e,s)));return n.join("").replace(ja,"")},El=Gt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(ja,""):Bf(e,r,t)}:Bf,Lf=function(e,r,t){for(var n=[],s=r;s<r+t;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},ah=Gt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Lf(e,r,t)}:Lf,jf=function(e,r,t){for(var n=[],s=r;s<t;s++)n.push(String.fromCharCode(Ls(e,s)));return n.join("")},W0=Gt?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):jf(r,t,n)}:jf,nh=function(e,r){var t=nn(e,r);return t>0?W0(e,r+4,r+4+t-1):""},ih=nh,sh=function(e,r){var t=nn(e,r);return t>0?W0(e,r+4,r+4+t-1):""},oh=sh,ch=function(e,r){var t=2*nn(e,r);return t>0?W0(e,r+4,r+4+t-1):""},lh=ch,fh=function(r,t){var n=nn(r,t);return n>0?El(r,t+4,t+4+n):""},hh=fh,uh=function(e,r){var t=nn(e,r);return t>0?W0(e,r+4,r+4+t):""},dh=uh,xh=function(e,r){return tg(e,r)},Xo=xh,_l=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Gt&&(ih=function(r,t){if(!Buffer.isBuffer(r))return nh(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},oh=function(r,t){if(!Buffer.isBuffer(r))return sh(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},lh=function(r,t){if(!Buffer.isBuffer(r))return ch(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},hh=function(r,t){if(!Buffer.isBuffer(r))return fh(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},dh=function(r,t){if(!Buffer.isBuffer(r))return uh(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},Xo=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):xh(r,t)},_l=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Ls=function(e,r){return e[r]},hi=function(e,r){return e[r+1]*256+e[r]},ag=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},nn=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},rs=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},ng=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function w0(e,r){var t="",n,s,c=[],h,d,m,g;switch(r){case"dbcs":if(g=this.l,Gt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)t+=String.fromCharCode(hi(this,g)),g+=2;e*=2;break;case"utf8":t=W0(this,this.l,this.l+e);break;case"utf16le":e*=2,t=El(this,this.l,this.l+e);break;case"wstr":return w0.call(this,e,"dbcs");case"lpstr-ansi":t=ih(this,this.l),e=4+nn(this,this.l);break;case"lpstr-cp":t=oh(this,this.l),e=4+nn(this,this.l);break;case"lpwstr":t=lh(this,this.l),e=4+2*nn(this,this.l);break;case"lpp4":e=4+nn(this,this.l),t=hh(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+nn(this,this.l),t=dh(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(h=Ls(this,this.l+e++))!==0;)c.push(Co(h));t=c.join("");break;case"_wstr":for(e=0,t="";(h=hi(this,this.l+e))!==0;)c.push(Co(h)),e+=2;e+=2,t=c.join("");break;case"dbcs-cont":for(t="",g=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(g)!==-1)return h=Ls(this,g),this.l=g+1,d=w0.call(this,e-m,h?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(Co(hi(this,g))),g+=2}t=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",g=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(g)!==-1)return h=Ls(this,g),this.l=g+1,d=w0.call(this,e-m,h?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(Co(Ls(this,g))),g+=1}t=c.join("");break;default:switch(e){case 1:return n=Ls(this,this.l),this.l++,n;case 2:return n=(r==="i"?ag:hi)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?rs:ng)(this,this.l),this.l+=4,n):(s=nn(this,this.l),this.l+=4,s);case 8:case-8:if(r==="f")return e==8?s=Xo(this,this.l):s=Xo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=ah(this,this.l,e);break}}return this.l+=e,t}var ig=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},sg=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},og=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function cg(e,r,t){var n=0,s=0;if(t==="dbcs"){for(s=0;s!=r.length;++s)og(this,r.charCodeAt(s),this.l+2*s);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255;n=r.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var c=Math.min(this.l+e,this.length);for(s=0;s<Math.min(r.length,e);++s){var h=r.charCodeAt(s);this[this.l++]=h&255,this[this.l++]=h>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,ig(this,r,this.l);break;case 8:if(n=8,t==="f"){rg(this,r,this.l);break}case 16:break;case-4:n=4,sg(this,r,this.l);break}return this.l+=n,this}function gh(e,r){var t=ah(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function wa(e,r){e.l=r,e.read_shift=w0,e.chk=gh,e.write_shift=cg}function Da(e,r){e.l+=r}function Oe(e){var r=Pi(e);return wa(r,0),r}function pi(e,r,t){if(e){var n,s,c;wa(e,e.l||0);for(var h=e.length,d=0,m=0;e.l<h;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var g=B0[d]||B0[65535];for(n=e.read_shift(1),c=n&127,s=1;s<4&&n&128;++s)c+=((n=e.read_shift(1))&127)<<7*s;m=e.l+c;var v=g.f&&g.f(e,c,t);if(e.l=m,r(v,g,d))return}}}function Xa(){var e=[],r=Gt?256:2048,t=function(g){var v=Oe(g);return wa(v,0),v},n=t(r),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},c=function(g){return n&&g<n.length-n.l?n:(s(),n=t(Math.max(g+1,r)))},h=function(){return s(),ua(e)},d=function(g){s(),n=g,n.l==null&&(n.l=n.length),c(r)};return{next:c,push:d,end:h,_bufs:e}}function Ve(e,r,t,n){var s=+r,c;if(!isNaN(s)){n||(n=B0[s].p||(t||[]).length||0),c=1+(s>=128?1:0)+1,n>=128&&++c,n>=16384&&++c,n>=2097152&&++c;var h=e.next(c);s<=127?h.write_shift(1,s):(h.write_shift(1,(s&127)+128),h.write_shift(1,s>>7));for(var d=0;d!=4;++d)if(n>=128)h.write_shift(1,(n&127)+128),n>>=7;else{h.write_shift(1,n);break}n>0&&_l(t)&&e.push(t)}}function v0(e,r,t){var n=Ir(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Uf(e,r,t){var n=Ir(e);return n.s=v0(n.s,r.s,t),n.e=v0(n.e,r.s,t),n}function y0(e,r){if(e.cRel&&e.c<0)for(e=Ir(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Ir(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Ct(e);return!e.cRel&&e.cRel!=null&&(t=hg(t)),!e.rRel&&e.rRel!=null&&(t=lg(t)),t}function Bc(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Pr(e.s.c)+":"+(e.e.cRel?"":"$")+Pr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+zr(e.s.r)+":"+(e.e.rRel?"":"$")+zr(e.e.r):y0(e.s,r.biff)+":"+y0(e.e,r.biff)}function Al(e){return parseInt(fg(e),10)-1}function zr(e){return""+(e+1)}function lg(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function fg(e){return e.replace(/\$(\d+)$/,"$1")}function bl(e){for(var r=ug(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function Pr(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function hg(e){return e.replace(/^([A-Z])/,"$$$1")}function ug(e){return e.replace(/^\$([A-Z])/,"$1")}function dg(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Br(e){for(var r=0,t=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?r=10*r+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:r-1}}function Ct(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function za(e){var r=e.indexOf(":");return r==-1?{s:Br(e),e:Br(e)}:{s:Br(e.slice(0,r)),e:Br(e.slice(r+1))}}function jt(e,r){return typeof r>"u"||typeof r=="number"?jt(e.s,e.e):(typeof e!="string"&&(e=Ct(e)),typeof r!="string"&&(r=Ct(r)),e==r?e:e+":"+r)}function er(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,s=0,c=e.length;for(t=0;n<c&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.s.c=--t,t=0;n<c&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;if(r.s.r=--t,n===c||s!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=c&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.e.c=--t,t=0;n!=c&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;return r.e.r=--t,r}function Wf(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=En(e.z,t?ia(r):r)}catch{}try{return e.w=En((e.XF||{}).numFmtId||(t?14:0),t?ia(r):r)}catch{return""+r}}function gi(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?wi[e.v]||e.v:r==null?Wf(e,e.v):Wf(e,r))}function Wi(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function mh(e,r,t){var n=t||{},s=e?Array.isArray(e):n.dense,c=e||(s?[]:{}),h=0,d=0;if(c&&n.origin!=null){if(typeof n.origin=="number")h=n.origin;else{var m=typeof n.origin=="string"?Br(n.origin):n.origin;h=m.r,d=m.c}c["!ref"]||(c["!ref"]="A1:A1")}var g={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var v=er(c["!ref"]);g.s.c=v.s.c,g.s.r=v.s.r,g.e.c=Math.max(g.e.c,v.e.c),g.e.r=Math.max(g.e.r,v.e.r),h==-1&&(g.e.r=h=v.e.r+1)}for(var _=0;_!=r.length;++_)if(r[_]){if(!Array.isArray(r[_]))throw new Error("aoa_to_sheet expects an array of arrays");for(var C=0;C!=r[_].length;++C)if(!(typeof r[_][C]>"u")){var T={v:r[_][C]},N=h+_,S=d+C;if(g.s.r>N&&(g.s.r=N),g.s.c>S&&(g.s.c=S),g.e.r<N&&(g.e.r=N),g.e.c<S&&(g.e.c=S),r[_][C]&&typeof r[_][C]=="object"&&!Array.isArray(r[_][C])&&!(r[_][C]instanceof Date))T=r[_][C];else if(Array.isArray(T.v)&&(T.f=r[_][C][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(n.nullError)T.t="e",T.v=0;else if(n.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=n.dateNF||bt[14],n.cellDates?(T.t="d",T.w=En(T.z,ia(T.v))):(T.t="n",T.v=ia(T.v),T.w=En(T.z,T.v))):T.t="s";if(s)c[N]||(c[N]=[]),c[N][S]&&c[N][S].z&&(T.z=c[N][S].z),c[N][S]=T;else{var D=Ct({c:S,r:N});c[D]&&c[D].z&&(T.z=c[D].z),c[D]=T}}}return g.s.c<1e7&&(c["!ref"]=jt(g)),c}function Zs(e,r){return mh(null,e,r)}function xg(e){return e.read_shift(4,"i")}function Rn(e,r){return r||(r=Oe(4)),r.write_shift(4,e),r}function Ia(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function da(e,r){var t=!1;return r==null&&(t=!0,r=Oe(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function gg(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function mg(e,r){return r||(r=Oe(4)),r.write_shift(2,0),r.write_shift(2,0),r}function Sl(e,r){var t=e.l,n=e.read_shift(1),s=Ia(e),c=[],h={t:s,h:s};if(n&1){for(var d=e.read_shift(4),m=0;m!=d;++m)c.push(gg(e));h.r=c}else h.r=[{ich:0,ifnt:0}];return e.l=t+r,h}function pg(e,r){var t=!1;return r==null&&(t=!0,r=Oe(15+4*e.t.length)),r.write_shift(1,0),da(e.t,r),t?r.slice(0,r.l):r}var wg=Sl;function vg(e,r){var t=!1;return r==null&&(t=!0,r=Oe(23+4*e.t.length)),r.write_shift(1,1),da(e.t,r),r.write_shift(4,1),mg({},r),t?r.slice(0,r.l):r}function _n(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function ms(e,r){return r==null&&(r=Oe(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function ps(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function ws(e,r){return r==null&&(r=Oe(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var yg=Ia,ph=da;function Cl(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function zo(e,r){var t=!1;return r==null&&(t=!0,r=Oe(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var Eg=Ia,Zc=Cl,Tl=zo;function Nl(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var s=n===0?Xo([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):rs(r,0)>>2;return t?s/100:s}function wh(e,r){r==null&&(r=Oe(4));var t=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?s:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function vh(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function _g(e,r){return r||(r=Oe(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var vs=vh,Js=_g;function ka(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function fs(e,r){return(r||Oe(8)).write_shift(8,e,"f")}function Ag(e){var r={},t=e.read_shift(1),n=t>>>1,s=e.read_shift(1),c=e.read_shift(2,"i"),h=e.read_shift(1),d=e.read_shift(1),m=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=s;var g=ns[s];g&&(r.rgb=O0(g));break;case 2:r.rgb=O0([h,d,m]);break;case 3:r.theme=s;break}return c!=0&&(r.tint=c>0?c/32767:c/32768),r}function Yo(e,r){if(r||(r=Oe(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function bg(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Sg(e,r){r||(r=Oe(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}function yh(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function Cg(e){return yh(e,1)}function Tg(e){return yh(e,2)}var kl=2,Ga=3,No=11,Vf=12,Ko=19,ko=64,Ng=65,kg=71,Ig=4108,Dg=4126,ha=80,Eh=81,Fg=[ha,Eh],Jc={1:{n:"CodePage",t:kl},2:{n:"Category",t:ha},3:{n:"PresentationFormat",t:ha},4:{n:"ByteCount",t:Ga},5:{n:"LineCount",t:Ga},6:{n:"ParagraphCount",t:Ga},7:{n:"SlideCount",t:Ga},8:{n:"NoteCount",t:Ga},9:{n:"HiddenCount",t:Ga},10:{n:"MultimediaClipCount",t:Ga},11:{n:"ScaleCrop",t:No},12:{n:"HeadingPairs",t:Ig},13:{n:"TitlesOfParts",t:Dg},14:{n:"Manager",t:ha},15:{n:"Company",t:ha},16:{n:"LinksUpToDate",t:No},17:{n:"CharacterCount",t:Ga},19:{n:"SharedDoc",t:No},22:{n:"HyperlinksChanged",t:No},23:{n:"AppVersion",t:Ga,p:"version"},24:{n:"DigSig",t:Ng},26:{n:"ContentType",t:ha},27:{n:"ContentStatus",t:ha},28:{n:"Language",t:ha},29:{n:"Version",t:ha},255:{},2147483648:{n:"Locale",t:Ko},2147483651:{n:"Behavior",t:Ko},1919054434:{}},Qc={1:{n:"CodePage",t:kl},2:{n:"Title",t:ha},3:{n:"Subject",t:ha},4:{n:"Author",t:ha},5:{n:"Keywords",t:ha},6:{n:"Comments",t:ha},7:{n:"Template",t:ha},8:{n:"LastAuthor",t:ha},9:{n:"RevNumber",t:ha},10:{n:"EditTime",t:ko},11:{n:"LastPrinted",t:ko},12:{n:"CreatedDate",t:ko},13:{n:"ModifiedDate",t:ko},14:{n:"PageCount",t:Ga},15:{n:"WordCount",t:Ga},16:{n:"CharCount",t:Ga},17:{n:"Thumbnail",t:kg},18:{n:"Application",t:ha},19:{n:"DocSecurity",t:Ga},255:{},2147483648:{n:"Locale",t:Ko},2147483651:{n:"Behavior",t:Ko},1919054434:{}},Hf={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Og=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Rg(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Mg=Rg([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ns=Ir(Mg),wi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},_h={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},$c={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Io={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Il(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Pg(e){var r=Il();if(!e||!e.match)return r;var t={};if((e.match(Fa)||[]).forEach(function(n){var s=Tt(n);switch(s[0].replace(zx,"<")){case"<?xml":break;case"<Types":r.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":r[$c[s.ContentType]]!==void 0&&r[$c[s.ContentType]].push(s.PartName);break}}),r.xmlns!==na.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}function Ah(e,r){var t=Px($c),n=[],s;n[n.length]=Yr,n[n.length]=rt("Types",null,{xmlns:na.CT,"xmlns:xsd":na.xsd,"xmlns:xsi":na.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(m){return rt("Default",null,{Extension:m[0],ContentType:m[1]})}));var c=function(m){e[m]&&e[m].length>0&&(s=e[m][0],n[n.length]=rt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Io[m][r.bookType]||Io[m].xlsx}))},h=function(m){(e[m]||[]).forEach(function(g){n[n.length]=rt("Override",null,{PartName:(g[0]=="/"?"":"/")+g,ContentType:Io[m][r.bookType]||Io[m].xlsx})})},d=function(m){(e[m]||[]).forEach(function(g){n[n.length]=rt("Override",null,{PartName:(g[0]=="/"?"":"/")+g,ContentType:t[m][0]})})};return c("workbooks"),h("sheets"),h("charts"),d("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),h("metadata"),d("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var zt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function F0(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function E0(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(Fa)||[]).forEach(function(s){var c=Tt(s);if(c[0]==="<Relationship"){var h={};h.Type=c.Type,h.Target=c.Target,h.Id=c.Id,c.TargetMode&&(h.TargetMode=c.TargetMode);var d=c.TargetMode==="External"?c.Target:p0(c.Target,r);t[d]=h,n[c.Id]=h}}),t["!id"]=n,t}function Vs(e){var r=[Yr,rt("Relationships",null,{xmlns:na.RELS})];return Wr(e["!id"]).forEach(function(t){r[r.length]=rt("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function hr(e,r,t,n,s,c){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,s.Id="rId"+r,s.Type=n,s.Target=t,[zt.HLINK,zt.XPATH,zt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,r}var Bg="application/vnd.oasis.opendocument.spreadsheet";function Lg(e,r){for(var t=yl(e),n,s;n=D0.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Tt(n[0],!1),s.path=="/"&&s.type!==Bg)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}function jg(e){var r=[Yr];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Gf(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function Ug(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function Wg(e){var r=[Yr];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(Gf(e[t][0],e[t][1])),r.push(Ug("",e[t][0]));return r.push(Gf("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function bh(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Uo.version+"</meta:generator></office:meta></office:document-meta>"}var yn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Vg=function(){for(var e=new Array(yn.length),r=0;r<yn.length;++r){var t=yn[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Sh(e){var r={};e=mr(e);for(var t=0;t<yn.length;++t){var n=yn[t],s=e.match(Vg[t]);s!=null&&s.length>0&&(r[n[1]]=$t(s[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=kr(r[n[1]]))}return r}function Lc(e,r,t,n,s){s[e]!=null||r==null||r===""||(s[e]=r,r=ur(r),n[n.length]=t?rt(e,r,t):va(e,r))}function Ch(e,r){var t=r||{},n=[Yr,rt("cp:coreProperties",null,{"xmlns:cp":na.CORE_PROPS,"xmlns:dc":na.dc,"xmlns:dcterms":na.dcterms,"xmlns:dcmitype":na.dcmitype,"xmlns:xsi":na.xsi})],s={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&Lc("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:qc(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Lc("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:qc(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var c=0;c!=yn.length;++c){var h=yn[c],d=t.Props&&t.Props[h[1]]!=null?t.Props[h[1]]:e?e[h[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&Lc(h[0],d,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var is=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Th=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Nh(e,r,t,n){var s=[];if(typeof e=="string")s=Rf(e,n);else for(var c=0;c<e.length;++c)s=s.concat(e[c].map(function(v){return{v}}));var h=typeof r=="string"?Rf(r,n).map(function(v){return v.v}):r,d=0,m=0;if(h.length>0)for(var g=0;g!==s.length;g+=2){switch(m=+s[g+1].v,s[g].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=m,t.SheetNames=h.slice(d,d+m);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=m,t.DefinedNames=h.slice(d,d+m);break;case"Charts":case"Diagramme":t.Chartsheets=m,t.ChartNames=h.slice(d,d+m);break}d+=m}}function Hg(e,r,t){var n={};return r||(r={}),e=mr(e),is.forEach(function(s){var c=(e.match(k0(s[0]))||[])[1];switch(s[2]){case"string":c&&(r[s[1]]=$t(c));break;case"bool":r[s[1]]=c==="true";break;case"raw":var h=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));h&&h.length>0&&(n[s[1]]=h[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Nh(n.HeadingPairs,n.TitlesOfParts,r,t),r}function kh(e){var r=[],t=rt;return e||(e={}),e.Application="SheetJS",r[r.length]=Yr,r[r.length]=rt("Properties",null,{xmlns:na.EXT_PROPS,"xmlns:vt":na.vt}),is.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=ur(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(r[r.length]=t(n[0],s))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ur(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Gg=/<[^>]+>[^<]*/g;function Xg(e,r){var t={},n="",s=e.match(Gg);if(s)for(var c=0;c!=s.length;++c){var h=s[c],d=Tt(h);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":n=$t(d.name);break;case"</property>":n=null;break;default:if(h.indexOf("<vt:")===0){var m=h.split(">"),g=m[0].slice(4),v=m[1];switch(g){case"lpstr":case"bstr":case"lpwstr":t[n]=$t(v);break;case"bool":t[n]=Nr(v);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(v,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(v);break;case"filetime":case"date":t[n]=kr(v);break;case"cy":case"error":t[n]=$t(v);break;default:if(g.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",h,g,m)}}else if(h.slice(0,2)!=="</"){if(r.WTF)throw new Error(h)}}}return t}function Ih(e){var r=[Yr,rt("Properties",null,{xmlns:na.CUST_PROPS,"xmlns:vt":na.vt})];if(!e)return r.join("");var t=1;return Wr(e).forEach(function(s){++t,r[r.length]=rt("property",eg(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:ur(s)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var el={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},jc;function zg(e,r,t){jc||(jc=nc(el)),r=jc[r]||r,e[r]=t}function Yg(e,r){var t=[];return Wr(el).map(function(n){for(var s=0;s<yn.length;++s)if(yn[s][1]==n)return yn[s];for(s=0;s<is.length;++s)if(is[s][1]==n)return is[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(va(el[n[1]]||n[1],s))}}),rt("DocumentProperties",t.join(""),{xmlns:an.o})}function Kg(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Wr(e).forEach(function(c){if(Object.prototype.hasOwnProperty.call(e,c)){for(var h=0;h<yn.length;++h)if(c==yn[h][1])return;for(h=0;h<is.length;++h)if(c==is[h][1])return;for(h=0;h<t.length;++h)if(c==t[h])return;var d=e[c],m="string";typeof d=="number"?(m="float",d=String(d)):d===!0||d===!1?(m="boolean",d=d?"1":"0"):d=String(d),s.push(rt(If(c),d,{"dt:dt":m}))}}),r&&Wr(r).forEach(function(c){if(Object.prototype.hasOwnProperty.call(r,c)&&!(e&&Object.prototype.hasOwnProperty.call(e,c))){var h=r[c],d="string";typeof h=="number"?(d="float",h=String(h)):h===!0||h===!1?(d="boolean",h=h?"1":"0"):h instanceof Date?(d="dateTime.tz",h=h.toISOString()):h=String(h),s.push(rt(If(c),h,{"dt:dt":d}))}}),"<"+n+' xmlns="'+an.o+'">'+s.join("")+"</"+n+">"}function Dl(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function qg(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),s=(t-n)/Math.pow(2,32);n*=1e7,s*=1e7;var c=n/Math.pow(2,32)|0;c>0&&(n=n%Math.pow(2,32),s+=c);var h=Oe(8);return h.write_shift(4,n),h.write_shift(4,s),h}function Dh(e,r,t){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return s}function Fh(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function Oh(e,r,t){return r===31?Fh(e):Dh(e,r,t)}function tl(e,r,t){return Oh(e,r,t===!1?0:4)}function Zg(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Oh(e,r,0)}function Jg(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var s=e.l;t[n]=e.read_shift(0,"lpwstr").replace(ja,""),e.l-s&2&&(e.l+=2)}return t}function Qg(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(ja,"");return t}function $g(e){var r=e.l,t=qo(e,Eh);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=qo(e,Ga);return[t,n]}function e2(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push($g(e));return t}function Xf(e,r){for(var t=e.read_shift(4),n={},s=0;s!=t;++s){var c=e.read_shift(4),h=e.read_shift(4);n[c]=e.read_shift(h,r===1200?"utf16le":"utf8").replace(ja,"").replace(m0,"!"),r===1200&&h%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Rh(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function t2(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function qo(e,r,t){var n=e.read_shift(2),s,c=t||{};if(e.l+=2,r!==Vf&&n!==r&&Fg.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Vf?n:r){case 2:return s=e.read_shift(2,"i"),c.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Dh(e,n,4).replace(ja,"");case 31:return Fh(e);case 64:return Dl(e);case 65:return Rh(e);case 71:return t2(e);case 80:return tl(e,n,!c.raw).replace(ja,"");case 81:return Zg(e,n).replace(ja,"");case 4108:return e2(e);case 4126:case 4127:return n==4127?Jg(e):Qg(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function zf(e,r){var t=Oe(4),n=Oe(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=Oe(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=qg(r);break;case 31:case 80:for(n=Oe(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return ua([t,n])}function Yf(e,r){var t=e.l,n=e.read_shift(4),s=e.read_shift(4),c=[],h=0,d=0,m=-1,g={};for(h=0;h!=s;++h){var v=e.read_shift(4),_=e.read_shift(4);c[h]=[v,_+t]}c.sort(function(X,O){return X[1]-O[1]});var C={};for(h=0;h!=s;++h){if(e.l!==c[h][1]){var T=!0;if(h>0&&r)switch(r[c[h-1][0]].t){case 2:e.l+2===c[h][1]&&(e.l+=2,T=!1);break;case 80:e.l<=c[h][1]&&(e.l=c[h][1],T=!1);break;case 4108:e.l<=c[h][1]&&(e.l=c[h][1],T=!1);break}if((!r||h==0)&&e.l<=c[h][1]&&(T=!1,e.l=c[h][1]),T)throw new Error("Read Error: Expected address "+c[h][1]+" at "+e.l+" :"+h)}if(r){var N=r[c[h][0]];if(C[N.n]=qo(e,N.t,{raw:!0}),N.p==="version"&&(C[N.n]=String(C[N.n]>>16)+"."+("0000"+String(C[N.n]&65535)).slice(-4)),N.n=="CodePage")switch(C[N.n]){case 0:C[N.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Dn(d=C[N.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+C[N.n])}}else if(c[h][0]===1){if(d=C.CodePage=qo(e,kl),Dn(d),m!==-1){var S=e.l;e.l=c[m][1],g=Xf(e,d),e.l=S}}else if(c[h][0]===0){if(d===0){m=h,e.l=c[h+1][1];continue}g=Xf(e,d)}else{var D=g[c[h][0]],U;switch(e[e.l]){case 65:e.l+=4,U=Rh(e);break;case 30:e.l+=4,U=tl(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,U=tl(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,U=e.read_shift(4,"i");break;case 19:e.l+=4,U=e.read_shift(4);break;case 5:e.l+=4,U=e.read_shift(8,"f");break;case 11:e.l+=4,U=Xr(e,4);break;case 64:e.l+=4,U=kr(Dl(e));break;default:throw new Error("unparsed value: "+e[e.l])}C[D]=U}}return e.l=t+n,C}var Mh=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function r2(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Kf(e,r,t){var n=Oe(8),s=[],c=[],h=8,d=0,m=Oe(8),g=Oe(8);if(m.write_shift(4,2),m.write_shift(4,1200),g.write_shift(4,1),c.push(m),s.push(g),h+=8+m.length,!r){g=Oe(8),g.write_shift(4,0),s.unshift(g);var v=[Oe(4)];for(v[0].write_shift(4,e.length),d=0;d<e.length;++d){var _=e[d][0];for(m=Oe(8+2*(_.length+1)+(_.length%2?0:2)),m.write_shift(4,d+2),m.write_shift(4,_.length+1),m.write_shift(0,_,"dbcs");m.l!=m.length;)m.write_shift(1,0);v.push(m)}m=ua(v),c.unshift(m),h+=8+m.length}for(d=0;d<e.length;++d)if(!(r&&!r[e[d][0]])&&!(Mh.indexOf(e[d][0])>-1||Th.indexOf(e[d][0])>-1)&&e[d][1]!=null){var C=e[d][1],T=0;if(r){T=+r[e[d][0]];var N=t[T];if(N.p=="version"&&typeof C=="string"){var S=C.split(".");C=(+S[0]<<16)+(+S[1]||0)}m=zf(N.t,C)}else{var D=r2(C);D==-1&&(D=31,C=String(C)),m=zf(D,C)}c.push(m),g=Oe(8),g.write_shift(4,r?T:2+d),s.push(g),h+=8+m.length}var U=8*(c.length+1);for(d=0;d<c.length;++d)s[d].write_shift(4,U),U+=c[d].length;return n.write_shift(4,h),n.write_shift(4,c.length),ua([n].concat(s).concat(c))}function qf(e,r,t){var n=e.content;if(!n)return{};wa(n,0);var s,c,h,d,m=0;n.chk("feff","Byte Order: "),n.read_shift(2);var g=n.read_shift(4),v=n.read_shift(16);if(v!==mt.utils.consts.HEADER_CLSID&&v!==t)throw new Error("Bad PropertySet CLSID "+v);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(c=n.read_shift(16),d=n.read_shift(4),s===1&&d!==n.l)throw new Error("Length mismatch: "+d+" !== "+n.l);s===2&&(h=n.read_shift(16),m=n.read_shift(4));var _=Yf(n,r),C={SystemIdentifier:g};for(var T in _)C[T]=_[T];if(C.FMTID=c,s===1)return C;if(m-n.l==2&&(n.l+=2),n.l!==m)throw new Error("Length mismatch 2: "+n.l+" !== "+m);var N;try{N=Yf(n,null)}catch{}for(T in N)C[T]=N[T];return C.FMTID=[c,h],C}function Zf(e,r,t,n,s,c){var h=Oe(s?68:48),d=[h];h.write_shift(2,65534),h.write_shift(2,0),h.write_shift(4,842412599),h.write_shift(16,mt.utils.consts.HEADER_CLSID,"hex"),h.write_shift(4,s?2:1),h.write_shift(16,r,"hex"),h.write_shift(4,s?68:48);var m=Kf(e,t,n);if(d.push(m),s){var g=Kf(s,null,null);h.write_shift(16,c,"hex"),h.write_shift(4,68+m.length),d.push(g)}return ua(d)}function Oi(e,r){return e.read_shift(r),null}function a2(e,r){r||(r=Oe(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function n2(e,r,t){for(var n=[],s=e.l+r;e.l<s;)n.push(t(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Xr(e,r){return e.read_shift(r)===1}function La(e,r){return r||(r=Oe(2)),r.write_shift(2,+!!e),r}function ea(e){return e.read_shift(2,"u")}function vn(e,r){return r||(r=Oe(2)),r.write_shift(2,e),r}function Ph(e,r){return n2(e,r,ea)}function i2(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Bh(e,r,t){return t||(t=Oe(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function V0(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var c=e.read_shift(1);c&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var h=n?e.read_shift(n,s):"";return h}function s2(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,s=t&8,c=1+(t&1),h=0,d,m={};s&&(h=e.read_shift(2)),n&&(d=e.read_shift(4));var g=c==2?"dbcs-cont":"sbcs-cont",v=r===0?"":e.read_shift(r,g);return s&&(e.l+=4*h),n&&(e.l+=d),m.t=v,s||(m.raw="<t>"+m.t+"</t>",m.r=m.t),m}function o2(e){var r=e.t||"",t=Oe(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=Oe(2*r.length);n.write_shift(2*r.length,r,"utf16le");var s=[t,n];return ua(s)}function hs(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function H0(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):hs(e,n,t)}function ys(e,r,t){if(t.biff>5)return H0(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Lh(e,r,t){return t||(t=Oe(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function c2(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function l2(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var s=e.read_shift((n?r-24:r)>>1,"utf16le").replace(ja,"");return n&&(e.l+=24),s}function f2(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return t+n.replace(/\\/g,"/");var c=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var h=e.read_shift(c>>1,"utf16le").replace(ja,"");return t+h}function h2(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return l2(e);case"0303000000000000c000000000000046":return f2(e);default:throw new Error("Unsupported Moniker "+t)}}function Do(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(ja,""):"";return t}function Jf(e,r){r||(r=Oe(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function u2(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var c,h,d,m,g="",v,_;s&16&&(c=Do(e,t-e.l)),s&128&&(h=Do(e,t-e.l)),(s&257)===257&&(d=Do(e,t-e.l)),(s&257)===1&&(m=h2(e,t-e.l)),s&8&&(g=Do(e,t-e.l)),s&32&&(v=e.read_shift(16)),s&64&&(_=Dl(e)),e.l=t;var C=h||d||m||"";C&&g&&(C+="#"+g),C||(C="#"+g),s&2&&C.charAt(0)=="/"&&C.charAt(1)!="/"&&(C="file://"+C);var T={Target:C};return v&&(T.guid=v),_&&(T.time=_),c&&(T.Tooltip=c),T}function d2(e){var r=Oe(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),c=s>-1?31:23;switch(n.charAt(0)){case"#":c=28;break;case".":c&=-3;break}r.write_shift(4,2),r.write_shift(4,c);var h=[8,6815827,6619237,4849780,83];for(t=0;t<h.length;++t)r.write_shift(4,h[t]);if(c==28)n=n.slice(1),Jf(n,r);else if(c&2){for(h="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<h.length;++t)r.write_shift(1,parseInt(h[t],16));var d=s>-1?n.slice(0,s):n;for(r.write_shift(4,2*(d.length+1)),t=0;t<d.length;++t)r.write_shift(2,d.charCodeAt(t));r.write_shift(2,0),c&8&&Jf(s>-1?n.slice(s+1):"",r)}else{for(h="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<h.length;++t)r.write_shift(1,parseInt(h[t],16));for(var m=0;n.slice(m*3,m*3+3)=="../"||n.slice(m*3,m*3+3)=="..\\";)++m;for(r.write_shift(2,m),r.write_shift(4,n.length-3*m+1),t=0;t<n.length-3*m;++t)r.write_shift(1,n.charCodeAt(t+3*m)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function jh(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[r,t,n,s]}function Uh(e,r){var t=jh(e);return t[3]=0,t}function Qn(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function us(e,r,t,n){return n||(n=Oe(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function x2(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function g2(e,r,t){return r===0?"":ys(e,r,t)}function m2(e,r,t){var n=t.biff>8?4:2,s=e.read_shift(n),c=e.read_shift(n,"i"),h=e.read_shift(n,"i");return[s,c,h]}function Wh(e){var r=e.read_shift(2),t=Nl(e);return[r,t]}function p2(e,r,t){e.l+=4,r-=4;var n=e.l+r,s=V0(e,r,t),c=e.read_shift(2);if(n-=e.l,c!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+c);return e.l+=c,s}function oc(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r},e:{c:s,r:t}}}function Vh(e,r){return r||(r=Oe(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function Hh(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r},e:{c:s,r:t}}}var w2=Hh;function Gh(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function v2(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function y2(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function Sa(e){e.l+=2,e.l+=e.read_shift(2)}var E2={0:Sa,4:Sa,5:Sa,6:Sa,7:y2,8:Sa,9:Sa,10:Sa,11:Sa,12:Sa,13:v2,14:Sa,15:Sa,16:Sa,17:Sa,18:Sa,19:Sa,20:Sa,21:Gh};function _2(e,r){for(var t=e.l+r,n=[];e.l<t;){var s=e.read_shift(2);e.l-=2;try{n.push(E2[s](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function Fo(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function Fl(e,r,t){var n=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=Oe(s);return c.write_shift(2,n),c.write_shift(2,r),s>4&&c.write_shift(2,29282),s>6&&c.write_shift(2,1997),s>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function A2(e,r){return r===0||e.read_shift(2),1200}function b2(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,s=ys(e,0,t);return e.read_shift(r+n-e.l),s}function S2(e,r){var t=!r||r.biff==8,n=Oe(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function C2(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function T2(e,r,t){var n=e.read_shift(4),s=e.read_shift(1)&3,c=e.read_shift(1);switch(c){case 0:c="Worksheet";break;case 1:c="Macrosheet";break;case 2:c="Chartsheet";break;case 6:c="VBAModule";break}var h=V0(e,0,t);return h.length===0&&(h="Sheet1"),{pos:n,hs:s,dt:c,name:h}}function N2(e,r){var t=!r||r.biff>=8?2:1,n=Oe(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function k2(e,r){for(var t=e.l+r,n=e.read_shift(4),s=e.read_shift(4),c=[],h=0;h!=s&&e.l<t;++h)c.push(s2(e));return c.Count=n,c.Unique=s,c}function I2(e,r){var t=Oe(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=o2(e[s]);var c=ua([t].concat(n));return c.parts=[t.length].concat(n.map(function(h){return h.length})),c}function D2(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function F2(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function O2(e){var r=x2(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function R2(e){return e.read_shift(2),e.read_shift(4)}function Qf(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);t&&t.biff==2&&(n=1-(s>>15),s&=32767);var c={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[c,s]}function M2(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),h=e.read_shift(2),d=e.read_shift(2),m=e.read_shift(2),g=e.read_shift(2);return{Pos:[r,t],Dim:[n,s],Flags:c,CurTab:h,FirstTab:d,Selected:m,TabRatio:g}}function P2(){var e=Oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function B2(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function L2(e){var r=Oe(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function j2(){}function U2(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=V0(e,0,t),n}function W2(e,r){var t=e.name||"Arial",n=r&&r.biff==5,s=n?15+t.length:16+2*t.length,c=Oe(s);return c.write_shift(2,e.sz*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,t.length),n||c.write_shift(1,1),c.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),c}function V2(e){var r=Qn(e);return r.isst=e.read_shift(4),r}function H2(e,r,t,n){var s=Oe(10);return us(e,r,n,s),s.write_shift(4,t),s}function G2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,s=Qn(e);t.biff==2&&e.l++;var c=H0(e,n-e.l,t);return s.val=c,s}function X2(e,r,t,n,s){var c=!s||s.biff==8,h=Oe(8+ +c+(1+c)*t.length);return us(e,r,n,h),h.write_shift(2,t.length),c&&h.write_shift(1,1),h.write_shift((1+c)*t.length,t,c?"utf16le":"sbcs"),h}function z2(e,r,t){var n=e.read_shift(2),s=ys(e,0,t);return[n,s]}function Y2(e,r,t,n){var s=t&&t.biff==5;n||(n=Oe(s?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(s?1:2,r.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le");var c=n.length>n.l?n.slice(0,n.l):n;return c.l==null&&(c.l=c.length),c}var K2=ys;function $f(e,r,t){var n=e.l+r,s=t.biff==8||!t.biff?4:2,c=e.read_shift(s),h=e.read_shift(s),d=e.read_shift(2),m=e.read_shift(2);return e.l=n,{s:{r:c,c:d},e:{r:h,c:m}}}function q2(e,r){var t=r.biff==8||!r.biff?4:2,n=Oe(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Z2(e){var r=e.read_shift(2),t=e.read_shift(2),n=Wh(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function J2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),s=e.read_shift(2),c=[];e.l<t;)c.push(Wh(e));if(e.l!==t)throw new Error("MulRK read error");var h=e.read_shift(2);if(c.length!=h-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:h,rkrec:c}}function Q2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),s=e.read_shift(2),c=[];e.l<t;)c.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var h=e.read_shift(2);if(c.length!=h-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:h,ixfe:c}}function $2(e,r,t,n){var s={},c=e.read_shift(4),h=e.read_shift(4),d=e.read_shift(4),m=e.read_shift(2);return s.patternType=Og[d>>26],n.cellStyles&&(s.alc=c&7,s.fWrap=c>>3&1,s.alcV=c>>4&7,s.fJustLast=c>>7&1,s.trot=c>>8&255,s.cIndent=c>>16&15,s.fShrinkToFit=c>>20&1,s.iReadOrder=c>>22&2,s.fAtrNum=c>>26&1,s.fAtrFnt=c>>27&1,s.fAtrAlc=c>>28&1,s.fAtrBdr=c>>29&1,s.fAtrPat=c>>30&1,s.fAtrProt=c>>31&1,s.dgLeft=h&15,s.dgRight=h>>4&15,s.dgTop=h>>8&15,s.dgBottom=h>>12&15,s.icvLeft=h>>16&127,s.icvRight=h>>23&127,s.grbitDiag=h>>30&3,s.icvTop=d&127,s.icvBottom=d>>7&127,s.icvDiag=d>>14&127,s.dgDiag=d>>21&15,s.icvFore=m&127,s.icvBack=m>>7&127,s.fsxButton=m>>14&1),s}function em(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=$2(e,r,n.fStyle,t),n}function e1(e,r,t,n){var s=t&&t.biff==5;n||(n=Oe(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var c=0;return e.numFmtId>0&&s&&(c|=1024),n.write_shift(4,c),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function tm(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function rm(e){var r=Oe(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function t1(e,r,t){var n=Qn(e);(t.biff==2||r==9)&&++e.l;var s=i2(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function am(e,r,t,n,s,c){var h=Oe(8);return us(e,r,n,h),Bh(t,c,h),h}function nm(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Qn(e),s=ka(e);return n.val=s,n}function im(e,r,t,n){var s=Oe(14);return us(e,r,n,s),fs(t,s),s}var r1=g2;function sm(e,r,t){var n=e.l+r,s=e.read_shift(2),c=e.read_shift(2);if(t.sbcch=c,c==1025||c==14849)return[c,s];if(c<1||c>255)throw new Error("Unexpected SupBook type: "+c);for(var h=hs(e,c),d=[];n>e.l;)d.push(H0(e));return[c,s,h,d]}function a1(e,r,t){var n=e.read_shift(2),s,c={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(s=p2(e,r-2,t)),c.body=s||e.read_shift(r-2),typeof s=="string"&&(c.Name=s),c}var om=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function n1(e,r,t){var n=e.l+r,s=e.read_shift(2),c=e.read_shift(1),h=e.read_shift(1),d=e.read_shift(t&&t.biff==2?1:2),m=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),m=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var g=hs(e,h,t);s&32&&(g=om[g.charCodeAt(0)]);var v=n-e.l;t&&t.biff==2&&--v;var _=n==e.l||d===0||!(v>0)?[]:_3(e,v,t,d);return{chKey:c,Name:g,itab:m,rgce:_}}function Xh(e,r,t){if(t.biff<8)return cm(e,r,t);for(var n=[],s=e.l+r,c=e.read_shift(t.biff>8?4:2);c--!==0;)n.push(m2(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function cm(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=V0(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function lm(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),s=e.read_shift(2),c=hs(e,n,t),h=hs(e,s,t);return[c,h]}function fm(e,r,t){var n=Hh(e);e.l++;var s=e.read_shift(1);return r-=8,[A3(e,r,t),s,n]}function i1(e,r,t){var n=w2(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,y3(e,r,t)]}function hm(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function um(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),h=e.read_shift(2),d=ys(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:s},d,h,c]}}function dm(e,r,t){return um(e,r,t)}function xm(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(oc(e));return t}function gm(e){var r=Oe(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)Vh(e[t],r);return r}function mm(e,r,t){if(t&&t.biff<8)return wm(e,r,t);var n=Gh(e),s=_2(e,r-22,n[1]);return{cmo:n,ft:s}}var pm={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=t,{fmt:n}}};function wm(e,r,t){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var h=[];return h.push((pm[n]||Da)(e,r,t)),{cmo:[s,n,c],ft:h}}function vm(e,r,t){var n=e.l,s="";try{e.l+=4;var c=(t.lastobj||{cmo:[0,0]}).cmo[1],h;[0,5,7,11,12,14].indexOf(c)==-1?e.l+=6:h=c2(e,6,t);var d=e.read_shift(2);e.read_shift(2),ea(e,2);var m=e.read_shift(2);e.l+=m;for(var g=1;g<e.lens.length-1;++g){if(e.l-n!=e.lens[g])throw new Error("TxO: bad continue record");var v=e[e.l],_=hs(e,e.lens[g+1]-e.lens[g]-1);if(s+=_,s.length>=(v?d:2*d))break}if(s.length!==d&&s.length!==d*2)throw new Error("cchText: "+d+" != "+s.length);return e.l=n+r,{t:s}}catch{return e.l=n+r,{t:s}}}function ym(e,r){var t=oc(e);e.l+=16;var n=u2(e,r-24);return[t,n]}function Em(e){var r=Oe(24),t=Br(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)r.write_shift(1,parseInt(n[s],16));return ua([r,d2(e[1])])}function _m(e,r){e.read_shift(2);var t=oc(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(ja,""),[t,n]}function Am(e){var r=e[1].Tooltip,t=Oe(10+2*(r.length+1));t.write_shift(2,2048);var n=Br(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var s=0;s<r.length;++s)t.write_shift(2,r.charCodeAt(s));return t.write_shift(2,0),t}function bm(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=Hf[t]||t,t=e.read_shift(2),r[1]=Hf[t]||t,r}function Sm(e){return e||(e=Oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Cm(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Uh(e));return t}function Tm(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Uh(e));return t}function Nm(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function zh(e,r,t){if(!t.cellStyles)return Da(e,r);var n=t&&t.biff>=12?4:2,s=e.read_shift(n),c=e.read_shift(n),h=e.read_shift(n),d=e.read_shift(n),m=e.read_shift(2);n==2&&(e.l+=2);var g={s,e:c,w:h,ixfe:d,flags:m};return(t.biff>=5||!t.biff)&&(g.level=m>>8&7),g}function km(e,r){var t=Oe(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function Im(e,r){var t={};return r<32||(e.l+=16,t.header=ka(e),t.footer=ka(e),e.l+=2),t}function Dm(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function Fm(e){for(var r=Oe(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}var Om=Qn,Rm=Ph,Mm=H0;function Pm(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function Bm(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Qn(e);++e.l;var s=ys(e,r-7,t);return n.t="str",n.val=s,n}function Lm(e){var r=Qn(e);++e.l;var t=ka(e);return r.t="n",r.val=t,r}function jm(e,r,t){var n=Oe(15);return Y0(n,e,r),n.write_shift(8,t,"f"),n}function Um(e){var r=Qn(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function Wm(e,r,t){var n=Oe(9);return Y0(n,e,r),n.write_shift(2,t),n}function Vm(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function Hm(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function Gm(e,r,t){var n=e.l+r,s=Qn(e),c=e.read_shift(2),h=hs(e,c,t);return e.l=n,s.t="str",s.val=h,s}var Xm=[2,3,48,49,131,139,140,245],rl=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=nc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(d,m){var g=[],v=Pi(1);switch(m.type){case"base64":v=sn(cn(d));break;case"binary":v=sn(d);break;case"buffer":case"array":v=d;break}wa(v,0);var _=v.read_shift(1),C=!!(_&136),T=!1,N=!1;switch(_){case 2:break;case 3:break;case 48:T=!0,C=!0;break;case 49:T=!0,C=!0;break;case 131:break;case 139:break;case 140:N=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+_.toString(16))}var S=0,D=521;_==2&&(S=v.read_shift(2)),v.l+=3,_!=2&&(S=v.read_shift(4)),S>1048576&&(S=1e6),_!=2&&(D=v.read_shift(2));var U=v.read_shift(2),X=m.codepage||1252;_!=2&&(v.l+=16,v.read_shift(1),v[v.l]!==0&&(X=e[v[v.l]]),v.l+=1,v.l+=2),N&&(v.l+=36);for(var O=[],q={},oe=Math.min(v.length,_==2?521:D-10-(T?264:0)),J=N?32:11;v.l<oe&&v[v.l]!=13;)switch(q={},q.name=C0.utils.decode(X,v.slice(v.l,v.l+J)).replace(/[\u0000\r\n].*$/g,""),v.l+=J,q.type=String.fromCharCode(v.read_shift(1)),_!=2&&!N&&(q.offset=v.read_shift(4)),q.len=v.read_shift(1),_==2&&(q.offset=v.read_shift(2)),q.dec=v.read_shift(1),q.name.length&&O.push(q),_!=2&&(v.l+=N?13:14),q.type){case"B":(!T||q.len!=8)&&m.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+q.type)}if(v[v.l]!==13&&(v.l=D-1),v.read_shift(1)!==13)throw new Error("DBF Terminator not found "+v.l+" "+v[v.l]);v.l=D;var M=0,ie=0;for(g[0]=[],ie=0;ie!=O.length;++ie)g[0][ie]=O[ie].name;for(;S-- >0;){if(v[v.l]===42){v.l+=U;continue}for(++v.l,g[++M]=[],ie=0,ie=0;ie!=O.length;++ie){var j=v.slice(v.l,v.l+O[ie].len);v.l+=O[ie].len,wa(j,0);var Ee=C0.utils.decode(X,j);switch(O[ie].type){case"C":Ee.trim().length&&(g[M][ie]=Ee.replace(/\s+$/,""));break;case"D":Ee.length===8?g[M][ie]=new Date(+Ee.slice(0,4),+Ee.slice(4,6)-1,+Ee.slice(6,8)):g[M][ie]=Ee;break;case"F":g[M][ie]=parseFloat(Ee.trim());break;case"+":case"I":g[M][ie]=N?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(Ee.trim().toUpperCase()){case"Y":case"T":g[M][ie]=!0;break;case"N":case"F":g[M][ie]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Ee+"|")}break;case"M":if(!C)throw new Error("DBF Unexpected MEMO for type "+_.toString(16));g[M][ie]="##MEMO##"+(N?parseInt(Ee.trim(),10):j.read_shift(4));break;case"N":Ee=Ee.replace(/\u0000/g,"").trim(),Ee&&Ee!="."&&(g[M][ie]=+Ee||0);break;case"@":g[M][ie]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":g[M][ie]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":g[M][ie]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[M][ie]=-j.read_shift(-8,"f");break;case"B":if(T&&O[ie].len==8){g[M][ie]=j.read_shift(8,"f");break}case"G":case"P":j.l+=O[ie].len;break;case"0":if(O[ie].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+O[ie].type)}}}if(_!=2&&v.l<v.length&&v[v.l++]!=26)throw new Error("DBF EOF Marker missing "+(v.l-1)+" of "+v.length+" "+v[v.l-1].toString(16));return m&&m.sheetRows&&(g=g.slice(0,m.sheetRows)),m.DBF=O,g}function n(d,m){var g=m||{};g.dateNF||(g.dateNF="yyyymmdd");var v=Zs(t(d,g),g);return v["!cols"]=g.DBF.map(function(_){return{wch:_.len,DBF:_}}),delete g.DBF,v}function s(d,m){try{return Wi(n(d,m),m)}catch(g){if(m&&m.WTF)throw g}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function h(d,m){var g=m||{};if(+g.codepage>=0&&Dn(+g.codepage),g.type=="string")throw new Error("Cannot write DBF to JS string");var v=Xa(),_=Qo(d,{header:1,raw:!0,cellDates:!0}),C=_[0],T=_.slice(1),N=d["!cols"]||[],S=0,D=0,U=0,X=1;for(S=0;S<C.length;++S){if(((N[S]||{}).DBF||{}).name){C[S]=N[S].DBF.name,++U;continue}if(C[S]!=null){if(++U,typeof C[S]=="number"&&(C[S]=C[S].toString(10)),typeof C[S]!="string")throw new Error("DBF Invalid column name "+C[S]+" |"+typeof C[S]+"|");if(C.indexOf(C[S])!==S){for(D=0;D<1024;++D)if(C.indexOf(C[S]+"_"+D)==-1){C[S]+="_"+D;break}}}}var O=er(d["!ref"]),q=[],oe=[],J=[];for(S=0;S<=O.e.c-O.s.c;++S){var M="",ie="",j=0,Ee=[];for(D=0;D<T.length;++D)T[D][S]!=null&&Ee.push(T[D][S]);if(Ee.length==0||C[S]==null){q[S]="?";continue}for(D=0;D<Ee.length;++D){switch(typeof Ee[D]){case"number":ie="B";break;case"string":ie="C";break;case"boolean":ie="L";break;case"object":ie=Ee[D]instanceof Date?"D":"C";break;default:ie="C"}j=Math.max(j,String(Ee[D]).length),M=M&&M!=ie?"C":ie}j>250&&(j=250),ie=((N[S]||{}).DBF||{}).type,ie=="C"&&N[S].DBF.len>j&&(j=N[S].DBF.len),M=="B"&&ie=="N"&&(M="N",J[S]=N[S].DBF.dec,j=N[S].DBF.len),oe[S]=M=="C"||ie=="N"?j:c[M]||0,X+=oe[S],q[S]=M}var he=v.next(32);for(he.write_shift(4,318902576),he.write_shift(4,T.length),he.write_shift(2,296+32*U),he.write_shift(2,X),S=0;S<4;++S)he.write_shift(4,0);for(he.write_shift(4,0|(+r[M1]||3)<<8),S=0,D=0;S<C.length;++S)if(C[S]!=null){var te=v.next(32),be=(C[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,be,"sbcs"),te.write_shift(1,q[S]=="?"?"C":q[S],"sbcs"),te.write_shift(4,D),te.write_shift(1,oe[S]||c[q[S]]||0),te.write_shift(1,J[S]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),D+=oe[S]||c[q[S]]||0}var $e=v.next(264);for($e.write_shift(4,13),S=0;S<65;++S)$e.write_shift(4,0);for(S=0;S<T.length;++S){var ae=v.next(X);for(ae.write_shift(1,0),D=0;D<C.length;++D)if(C[D]!=null)switch(q[D]){case"L":ae.write_shift(1,T[S][D]==null?63:T[S][D]?84:70);break;case"B":ae.write_shift(8,T[S][D]||0,"f");break;case"N":var tt="0";for(typeof T[S][D]=="number"&&(tt=T[S][D].toFixed(J[D]||0)),U=0;U<oe[D]-tt.length;++U)ae.write_shift(1,32);ae.write_shift(1,tt,"sbcs");break;case"D":T[S][D]?(ae.write_shift(4,("0000"+T[S][D].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(T[S][D].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+T[S][D].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var Re=String(T[S][D]!=null?T[S][D]:"").slice(0,oe[D]);for(ae.write_shift(1,Re,"sbcs"),U=0;U<oe[D]-Re.length;++U)ae.write_shift(1,32);break}}return v.next(1).write_shift(1,26),v.end()}return{to_workbook:s,to_sheet:n,from_sheet:h}}(),Yh=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Wr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(C,T){var N=e[T];return typeof N=="number"?mf(N):N},n=function(C,T,N){var S=T.charCodeAt(0)-32<<4|N.charCodeAt(0)-48;return S==59?C:mf(S)};e["|"]=254;function s(C,T){switch(T.type){case"base64":return c(cn(C),T);case"binary":return c(C,T);case"buffer":return c(Gt&&Buffer.isBuffer(C)?C.toString("binary"):Ui(C),T);case"array":return c(ls(C),T)}throw new Error("Unrecognized type "+T.type)}function c(C,T){var N=C.split(/[\n\r]+/),S=-1,D=-1,U=0,X=0,O=[],q=[],oe=null,J={},M=[],ie=[],j=[],Ee=0,he;for(+T.codepage>=0&&Dn(+T.codepage);U!==N.length;++U){Ee=0;var te=N[U].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),be=te.replace(/;;/g,"\0").split(";").map(function(ne){return ne.replace(/\u0000/g,";")}),$e=be[0],ae;if(te.length>0)switch($e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":be[1].charAt(0)=="P"&&q.push(te.slice(3).replace(/;;/g,";"));break;case"C":var tt=!1,Re=!1,Ut=!1,fe=!1,ot=-1,pt=-1;for(X=1;X<be.length;++X)switch(be[X].charAt(0)){case"A":break;case"X":D=parseInt(be[X].slice(1))-1,Re=!0;break;case"Y":for(S=parseInt(be[X].slice(1))-1,Re||(D=0),he=O.length;he<=S;++he)O[he]=[];break;case"K":ae=be[X].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(On(ae))?isNaN(Xs(ae).getDate())||(ae=kr(ae)):(ae=On(ae),oe!==null&&Ks(oe)&&(ae=sc(ae))),tt=!0;break;case"E":fe=!0;var K=Hs(be[X].slice(1),{r:S,c:D});O[S][D]=[O[S][D],K];break;case"S":Ut=!0,O[S][D]=[O[S][D],"S5S"];break;case"G":break;case"R":ot=parseInt(be[X].slice(1))-1;break;case"C":pt=parseInt(be[X].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}if(tt&&(O[S][D]&&O[S][D].length==2?O[S][D][0]=ae:O[S][D]=ae,oe=null),Ut){if(fe)throw new Error("SYLK shared formula cannot have own formula");var ce=ot>-1&&O[ot][pt];if(!ce||!ce[1])throw new Error("SYLK shared formula cannot find base");O[S][D][1]=hu(ce[1],{r:S-ot,c:D-pt})}break;case"F":var ee=0;for(X=1;X<be.length;++X)switch(be[X].charAt(0)){case"X":D=parseInt(be[X].slice(1))-1,++ee;break;case"Y":for(S=parseInt(be[X].slice(1))-1,he=O.length;he<=S;++he)O[he]=[];break;case"M":Ee=parseInt(be[X].slice(1))/20;break;case"F":break;case"G":break;case"P":oe=q[parseInt(be[X].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=be[X].slice(1).split(" "),he=parseInt(j[0],10);he<=parseInt(j[1],10);++he)Ee=parseInt(j[2],10),ie[he-1]=Ee===0?{hidden:!0}:{wch:Ee},Bi(ie[he-1]);break;case"C":D=parseInt(be[X].slice(1))-1,ie[D]||(ie[D]={});break;case"R":S=parseInt(be[X].slice(1))-1,M[S]||(M[S]={}),Ee>0?(M[S].hpt=Ee,M[S].hpx=Ys(Ee)):Ee===0&&(M[S].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}ee<1&&(oe=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}}return M.length>0&&(J["!rows"]=M),ie.length>0&&(J["!cols"]=ie),T&&T.sheetRows&&(O=O.slice(0,T.sheetRows)),[O,J]}function h(C,T){var N=s(C,T),S=N[0],D=N[1],U=Zs(S,T);return Wr(D).forEach(function(X){U[X]=D[X]}),U}function d(C,T){return Wi(h(C,T),T)}function m(C,T,N,S){var D="C;Y"+(N+1)+";X"+(S+1)+";K";switch(C.t){case"n":D+=C.v||0,C.f&&!C.F&&(D+=";E"+Ll(C.f,{r:N,c:S}));break;case"b":D+=C.v?"TRUE":"FALSE";break;case"e":D+=C.w||C.v;break;case"d":D+='"'+(C.w||C.v)+'"';break;case"s":D+='"'+C.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return D}function g(C,T){T.forEach(function(N,S){var D="F;W"+(S+1)+" "+(S+1)+" ";N.hidden?D+="0":(typeof N.width=="number"&&!N.wpx&&(N.wpx=R0(N.width)),typeof N.wpx=="number"&&!N.wch&&(N.wch=M0(N.wpx)),typeof N.wch=="number"&&(D+=Math.round(N.wch))),D.charAt(D.length-1)!=" "&&C.push(D)})}function v(C,T){T.forEach(function(N,S){var D="F;";N.hidden?D+="M0;":N.hpt?D+="M"+20*N.hpt+";":N.hpx&&(D+="M"+20*P0(N.hpx)+";"),D.length>2&&C.push(D+"R"+(S+1))})}function _(C,T){var N=["ID;PWXL;N;E"],S=[],D=er(C["!ref"]),U,X=Array.isArray(C),O=`\r
`;N.push("P;PGeneral"),N.push("F;P0;DG0G8;M255"),C["!cols"]&&g(N,C["!cols"]),C["!rows"]&&v(N,C["!rows"]),N.push("B;Y"+(D.e.r-D.s.r+1)+";X"+(D.e.c-D.s.c+1)+";D"+[D.s.c,D.s.r,D.e.c,D.e.r].join(" "));for(var q=D.s.r;q<=D.e.r;++q)for(var oe=D.s.c;oe<=D.e.c;++oe){var J=Ct({r:q,c:oe});U=X?(C[q]||[])[oe]:C[J],!(!U||U.v==null&&(!U.f||U.F))&&S.push(m(U,C,q,oe))}return N.join(O)+O+S.join(O)+O+"E"+O}return{to_workbook:d,to_sheet:h,from_sheet:_}}(),Kh=function(){function e(c,h){switch(h.type){case"base64":return r(cn(c),h);case"binary":return r(c,h);case"buffer":return r(Gt&&Buffer.isBuffer(c)?c.toString("binary"):Ui(c),h);case"array":return r(ls(c),h)}throw new Error("Unrecognized type "+h.type)}function r(c,h){for(var d=c.split(`
`),m=-1,g=-1,v=0,_=[];v!==d.length;++v){if(d[v].trim()==="BOT"){_[++m]=[],g=0;continue}if(!(m<0)){var C=d[v].trim().split(","),T=C[0],N=C[1];++v;for(var S=d[v]||"";(S.match(/["]/g)||[]).length&1&&v<d.length-1;)S+=`
`+d[++v];switch(S=S.trim(),+T){case-1:if(S==="BOT"){_[++m]=[],g=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?_[m][g]=!0:S==="FALSE"?_[m][g]=!1:isNaN(On(N))?isNaN(Xs(N).getDate())?_[m][g]=N:_[m][g]=kr(N):_[m][g]=On(N),++g;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),_[m][g++]=S!==""?S:null;break}if(S==="EOD")break}}return h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),_}function t(c,h){return Zs(e(c,h),h)}function n(c,h){return Wi(t(c,h),h)}var s=function(){var c=function(m,g,v,_,C){m.push(g),m.push(v+","+_),m.push('"'+C.replace(/"/g,'""')+'"')},h=function(m,g,v,_){m.push(g+","+v),m.push(g==1?'"'+_.replace(/"/g,'""')+'"':_)};return function(m){var g=[],v=er(m["!ref"]),_,C=Array.isArray(m);c(g,"TABLE",0,1,"sheetjs"),c(g,"VECTORS",0,v.e.r-v.s.r+1,""),c(g,"TUPLES",0,v.e.c-v.s.c+1,""),c(g,"DATA",0,0,"");for(var T=v.s.r;T<=v.e.r;++T){h(g,-1,0,"BOT");for(var N=v.s.c;N<=v.e.c;++N){var S=Ct({r:T,c:N});if(_=C?(m[T]||[])[N]:m[S],!_){h(g,1,0,"");continue}switch(_.t){case"n":var D=_.w;!D&&_.v!=null&&(D=_.v),D==null?_.f&&!_.F?h(g,1,0,"="+_.f):h(g,1,0,""):h(g,0,D,"V");break;case"b":h(g,0,_.v?1:0,_.v?"TRUE":"FALSE");break;case"s":h(g,1,0,isNaN(_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=En(_.z||bt[14],ia(kr(_.v)))),h(g,0,_.w,"V");break;default:h(g,1,0,"")}}}h(g,-1,0,"EOD");var U=`\r
`,X=g.join(U);return X}}();return{to_workbook:n,to_sheet:t,from_sheet:s}}(),qh=function(){function e(_){return _.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(_){return _.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(_,C){for(var T=_.split(`
`),N=-1,S=-1,D=0,U=[];D!==T.length;++D){var X=T[D].trim().split(":");if(X[0]==="cell"){var O=Br(X[1]);if(U.length<=O.r)for(N=U.length;N<=O.r;++N)U[N]||(U[N]=[]);switch(N=O.r,S=O.c,X[2]){case"t":U[N][S]=e(X[3]);break;case"v":U[N][S]=+X[3];break;case"vtf":var q=X[X.length-1];case"vtc":switch(X[3]){case"nl":U[N][S]=!!+X[4];break;default:U[N][S]=+X[4];break}X[2]=="vtf"&&(U[N][S]=[U[N][S],q])}}}return C&&C.sheetRows&&(U=U.slice(0,C.sheetRows)),U}function n(_,C){return Zs(t(_,C),C)}function s(_,C){return Wi(n(_,C),C)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),h=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function g(_){if(!_||!_["!ref"])return"";for(var C=[],T=[],N,S="",D=za(_["!ref"]),U=Array.isArray(_),X=D.s.r;X<=D.e.r;++X)for(var O=D.s.c;O<=D.e.c;++O)if(S=Ct({r:X,c:O}),N=U?(_[X]||[])[O]:_[S],!(!N||N.v==null||N.t==="z")){switch(T=["cell",S,"t"],N.t){case"s":case"str":T.push(r(N.v));break;case"n":N.f?(T[2]="vtf",T[3]="n",T[4]=N.v,T[5]=r(N.f)):(T[2]="v",T[3]=N.v);break;case"b":T[2]="vt"+(N.f?"f":"c"),T[3]="nl",T[4]=N.v?"1":"0",T[5]=r(N.f||(N.v?"TRUE":"FALSE"));break;case"d":var q=ia(kr(N.v));T[2]="vtc",T[3]="nd",T[4]=""+q,T[5]=N.w||En(N.z||bt[14],q);break;case"e":continue}C.push(T.join(":"))}return C.push("sheet:c:"+(D.e.c-D.s.c+1)+":r:"+(D.e.r-D.s.r+1)+":tvf:1"),C.push("valueformat:1:text-wiki"),C.join(`
`)}function v(_){return[c,h,d,h,g(_),m].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:v}}(),zs=function(){function e(v,_,C,T,N){N.raw?_[C][T]=v:v===""||(v==="TRUE"?_[C][T]=!0:v==="FALSE"?_[C][T]=!1:isNaN(On(v))?isNaN(Xs(v).getDate())?_[C][T]=v:_[C][T]=kr(v):_[C][T]=On(v))}function r(v,_){var C=_||{},T=[];if(!v||v.length===0)return T;for(var N=v.split(/[\r\n]/),S=N.length-1;S>=0&&N[S].length===0;)--S;for(var D=10,U=0,X=0;X<=S;++X)U=N[X].indexOf(" "),U==-1?U=N[X].length:U++,D=Math.max(D,U);for(X=0;X<=S;++X){T[X]=[];var O=0;for(e(N[X].slice(0,D).trim(),T,X,O,C),O=1;O<=(N[X].length-D)/10+1;++O)e(N[X].slice(D+(O-1)*10,D+O*10).trim(),T,X,O,C)}return C.sheetRows&&(T=T.slice(0,C.sheetRows)),T}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(v){for(var _={},C=!1,T=0,N=0;T<v.length;++T)(N=v.charCodeAt(T))==34?C=!C:!C&&N in t&&(_[N]=(_[N]||0)+1);N=[];for(T in _)Object.prototype.hasOwnProperty.call(_,T)&&N.push([_[T],T]);if(!N.length){_=n;for(T in _)Object.prototype.hasOwnProperty.call(_,T)&&N.push([_[T],T])}return N.sort(function(S,D){return S[0]-D[0]||n[S[1]]-n[D[1]]}),t[N.pop()[1]]||44}function c(v,_){var C=_||{},T="",N=C.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};v.slice(0,4)=="sep="?v.charCodeAt(5)==13&&v.charCodeAt(6)==10?(T=v.charAt(4),v=v.slice(7)):v.charCodeAt(5)==13||v.charCodeAt(5)==10?(T=v.charAt(4),v=v.slice(6)):T=s(v.slice(0,1024)):C&&C.FS?T=C.FS:T=s(v.slice(0,1024));var D=0,U=0,X=0,O=0,q=0,oe=T.charCodeAt(0),J=!1,M=0,ie=v.charCodeAt(0);v=v.replace(/\r\n/mg,`
`);var j=C.dateNF!=null?Dx(C.dateNF):null;function Ee(){var he=v.slice(O,q),te={};if(he.charAt(0)=='"'&&he.charAt(he.length-1)=='"'&&(he=he.slice(1,-1).replace(/""/g,'"')),he.length===0)te.t="z";else if(C.raw)te.t="s",te.v=he;else if(he.trim().length===0)te.t="s",te.v=he;else if(he.charCodeAt(0)==61)he.charCodeAt(1)==34&&he.charCodeAt(he.length-1)==34?(te.t="s",te.v=he.slice(2,-1).replace(/""/g,'"')):sv(he)?(te.t="n",te.f=he.slice(1)):(te.t="s",te.v=he);else if(he=="TRUE")te.t="b",te.v=!0;else if(he=="FALSE")te.t="b",te.v=!1;else if(!isNaN(X=On(he)))te.t="n",C.cellText!==!1&&(te.w=he),te.v=X;else if(!isNaN(Xs(he).getDate())||j&&he.match(j)){te.z=C.dateNF||bt[14];var be=0;j&&he.match(j)&&(he=Fx(he,C.dateNF,he.match(j)||[]),be=1),C.cellDates?(te.t="d",te.v=kr(he,be)):(te.t="n",te.v=ia(kr(he,be))),C.cellText!==!1&&(te.w=En(te.z,te.v instanceof Date?ia(te.v):te.v)),C.cellNF||delete te.z}else te.t="s",te.v=he;if(te.t=="z"||(C.dense?(N[D]||(N[D]=[]),N[D][U]=te):N[Ct({c:U,r:D})]=te),O=q+1,ie=v.charCodeAt(O),S.e.c<U&&(S.e.c=U),S.e.r<D&&(S.e.r=D),M==oe)++U;else if(U=0,++D,C.sheetRows&&C.sheetRows<=D)return!0}e:for(;q<v.length;++q)switch(M=v.charCodeAt(q)){case 34:ie===34&&(J=!J);break;case oe:case 10:case 13:if(!J&&Ee())break e;break}return q-O>0&&Ee(),N["!ref"]=jt(S),N}function h(v,_){return!(_&&_.PRN)||_.FS||v.slice(0,4)=="sep="||v.indexOf("	")>=0||v.indexOf(",")>=0||v.indexOf(";")>=0?c(v,_):Zs(r(v,_),_)}function d(v,_){var C="",T=_.type=="string"?[0,0,0,0]:zl(v,_);switch(_.type){case"base64":C=cn(v);break;case"binary":C=v;break;case"buffer":_.codepage==65001?C=v.toString("utf8"):_.codepage&&typeof C0<"u"||(C=Gt&&Buffer.isBuffer(v)?v.toString("binary"):Ui(v));break;case"array":C=ls(v);break;case"string":C=v;break;default:throw new Error("Unrecognized type "+_.type)}return T[0]==239&&T[1]==187&&T[2]==191?C=mr(C.slice(3)):_.type!="string"&&_.type!="buffer"&&_.codepage==65001?C=mr(C):_.type=="binary"&&typeof C0<"u",C.slice(0,19)=="socialcalc:version:"?qh.to_sheet(_.type=="string"?C:mr(C),_):h(C,_)}function m(v,_){return Wi(d(v,_),_)}function g(v){for(var _=[],C=er(v["!ref"]),T,N=Array.isArray(v),S=C.s.r;S<=C.e.r;++S){for(var D=[],U=C.s.c;U<=C.e.c;++U){var X=Ct({r:S,c:U});if(T=N?(v[S]||[])[U]:v[X],!T||T.v==null){D.push("          ");continue}for(var O=(T.w||(gi(T),T.w)||"").slice(0,10);O.length<10;)O+=" ";D.push(O+(U===0?" ":""))}_.push(D.join(""))}return _.join(`
`)}return{to_workbook:m,to_sheet:d,from_sheet:g}}();function zm(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var s=Yh.to_workbook(e,t);return t.WTF=n,s}catch(c){if(t.WTF=n,!c.message.match(/SYLK bad record ID/)&&n)throw c;return zs.to_workbook(e,r)}}var ss=function(){function e(K,ce,ee){if(K){wa(K,K.l||0);for(var ne=ee.Enum||ot;K.l<K.length;){var le=K.read_shift(2),qe=ne[le]||ne[65535],Le=K.read_shift(2),Pe=K.l+Le,Be=qe.f&&qe.f(K,Le,ee);if(K.l=Pe,ce(Be,qe,le))return}}}function r(K,ce){switch(ce.type){case"base64":return t(sn(cn(K)),ce);case"binary":return t(sn(K),ce);case"buffer":case"array":return t(K,ce)}throw"Unsupported type "+ce.type}function t(K,ce){if(!K)return K;var ee=ce||{},ne=ee.dense?[]:{},le="Sheet1",qe="",Le=0,Pe={},Be=[],Te=[],A={s:{r:0,c:0},e:{r:0,c:0}},Y=ee.sheetRows||0;if(K[2]==0&&(K[3]==8||K[3]==9)&&K.length>=16&&K[14]==5&&K[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(K[2]==2)ee.Enum=ot,e(K,function(Me,ft,Et){switch(Et){case 0:ee.vers=Me,Me>=4096&&(ee.qpro=!0);break;case 6:A=Me;break;case 204:Me&&(qe=Me);break;case 222:qe=Me;break;case 15:case 51:ee.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:Et==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=ee.dateNF||bt[14],ee.cellDates&&(Me[1].t="d",Me[1].v=sc(Me[1].v))),ee.qpro&&Me[3]>Le&&(ne["!ref"]=jt(A),Pe[le]=ne,Be.push(le),ne=ee.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},Le=Me[3],le=qe||"Sheet"+(Le+1),qe="");var Kr=ee.dense?(ne[Me[0].r]||[])[Me[0].c]:ne[Ct(Me[0])];if(Kr){Kr.t=Me[1].t,Kr.v=Me[1].v,Me[1].z!=null&&(Kr.z=Me[1].z),Me[1].f!=null&&(Kr.f=Me[1].f);break}ee.dense?(ne[Me[0].r]||(ne[Me[0].r]=[]),ne[Me[0].r][Me[0].c]=Me[1]):ne[Ct(Me[0])]=Me[1];break}},ee);else if(K[2]==26||K[2]==14)ee.Enum=pt,K[2]==14&&(ee.qpro=!0,K.l=0),e(K,function(Me,ft,Et){switch(Et){case 204:le=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>Le&&(ne["!ref"]=jt(A),Pe[le]=ne,Be.push(le),ne=ee.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},Le=Me[3],le="Sheet"+(Le+1)),Y>0&&Me[0].r>=Y)break;ee.dense?(ne[Me[0].r]||(ne[Me[0].r]=[]),ne[Me[0].r][Me[0].c]=Me[1]):ne[Ct(Me[0])]=Me[1],A.e.c<Me[0].c&&(A.e.c=Me[0].c),A.e.r<Me[0].r&&(A.e.r=Me[0].r);break;case 27:Me[14e3]&&(Te[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Te[Me[0]]=Me[1],Me[0]==Le&&(le=Me[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+K[2]);if(ne["!ref"]=jt(A),Pe[qe||le]=ne,Be.push(qe||le),!Te.length)return{SheetNames:Be,Sheets:Pe};for(var ht={},lt=[],ze=0;ze<Te.length;++ze)Pe[Be[ze]]?(lt.push(Te[ze]||Be[ze]),ht[Te[ze]]=Pe[Te[ze]]||Pe[Be[ze]]):(lt.push(Te[ze]),ht[Te[ze]]={"!ref":"A1"});return{SheetNames:lt,Sheets:ht}}function n(K,ce){var ee=ce||{};if(+ee.codepage>=0&&Dn(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var ne=Xa(),le=er(K["!ref"]),qe=Array.isArray(K),Le=[];at(ne,0,c(1030)),at(ne,6,m(le));for(var Pe=Math.min(le.e.r,8191),Be=le.s.r;Be<=Pe;++Be)for(var Te=zr(Be),A=le.s.c;A<=le.e.c;++A){Be===le.s.r&&(Le[A]=Pr(A));var Y=Le[A]+Te,ht=qe?(K[Be]||[])[A]:K[Y];if(!(!ht||ht.t=="z"))if(ht.t=="n")(ht.v|0)==ht.v&&ht.v>=-32768&&ht.v<=32767?at(ne,13,T(Be,A,ht.v)):at(ne,14,S(Be,A,ht.v));else{var lt=gi(ht);at(ne,15,_(Be,A,lt.slice(0,239)))}}return at(ne,1),ne.end()}function s(K,ce){var ee=ce||{};if(+ee.codepage>=0&&Dn(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var ne=Xa();at(ne,0,h(K));for(var le=0,qe=0;le<K.SheetNames.length;++le)(K.Sheets[K.SheetNames[le]]||{})["!ref"]&&at(ne,27,fe(K.SheetNames[le],qe++));var Le=0;for(le=0;le<K.SheetNames.length;++le){var Pe=K.Sheets[K.SheetNames[le]];if(!(!Pe||!Pe["!ref"])){for(var Be=er(Pe["!ref"]),Te=Array.isArray(Pe),A=[],Y=Math.min(Be.e.r,8191),ht=Be.s.r;ht<=Y;++ht)for(var lt=zr(ht),ze=Be.s.c;ze<=Be.e.c;++ze){ht===Be.s.r&&(A[ze]=Pr(ze));var Me=A[ze]+lt,ft=Te?(Pe[ht]||[])[ze]:Pe[Me];if(!(!ft||ft.t=="z"))if(ft.t=="n")at(ne,23,Ee(ht,ze,Le,ft.v));else{var Et=gi(ft);at(ne,22,M(ht,ze,Le,Et.slice(0,239)))}}++Le}}return at(ne,1),ne.end()}function c(K){var ce=Oe(2);return ce.write_shift(2,K),ce}function h(K){var ce=Oe(26);ce.write_shift(2,4096),ce.write_shift(2,4),ce.write_shift(4,0);for(var ee=0,ne=0,le=0,qe=0;qe<K.SheetNames.length;++qe){var Le=K.SheetNames[qe],Pe=K.Sheets[Le];if(!(!Pe||!Pe["!ref"])){++le;var Be=za(Pe["!ref"]);ee<Be.e.r&&(ee=Be.e.r),ne<Be.e.c&&(ne=Be.e.c)}}return ee>8191&&(ee=8191),ce.write_shift(2,ee),ce.write_shift(1,le),ce.write_shift(1,ne),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(1,1),ce.write_shift(1,2),ce.write_shift(4,0),ce.write_shift(4,0),ce}function d(K,ce,ee){var ne={s:{c:0,r:0},e:{c:0,r:0}};return ce==8&&ee.qpro?(ne.s.c=K.read_shift(1),K.l++,ne.s.r=K.read_shift(2),ne.e.c=K.read_shift(1),K.l++,ne.e.r=K.read_shift(2),ne):(ne.s.c=K.read_shift(2),ne.s.r=K.read_shift(2),ce==12&&ee.qpro&&(K.l+=2),ne.e.c=K.read_shift(2),ne.e.r=K.read_shift(2),ce==12&&ee.qpro&&(K.l+=2),ne.s.c==65535&&(ne.s.c=ne.e.c=ne.s.r=ne.e.r=0),ne)}function m(K){var ce=Oe(8);return ce.write_shift(2,K.s.c),ce.write_shift(2,K.s.r),ce.write_shift(2,K.e.c),ce.write_shift(2,K.e.r),ce}function g(K,ce,ee){var ne=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(ne[0].c=K.read_shift(1),ne[3]=K.read_shift(1),ne[0].r=K.read_shift(2),K.l+=2):(ne[2]=K.read_shift(1),ne[0].c=K.read_shift(2),ne[0].r=K.read_shift(2)),ne}function v(K,ce,ee){var ne=K.l+ce,le=g(K,ce,ee);if(le[1].t="s",ee.vers==20768){K.l++;var qe=K.read_shift(1);return le[1].v=K.read_shift(qe,"utf8"),le}return ee.qpro&&K.l++,le[1].v=K.read_shift(ne-K.l,"cstr"),le}function _(K,ce,ee){var ne=Oe(7+ee.length);ne.write_shift(1,255),ne.write_shift(2,ce),ne.write_shift(2,K),ne.write_shift(1,39);for(var le=0;le<ne.length;++le){var qe=ee.charCodeAt(le);ne.write_shift(1,qe>=128?95:qe)}return ne.write_shift(1,0),ne}function C(K,ce,ee){var ne=g(K,ce,ee);return ne[1].v=K.read_shift(2,"i"),ne}function T(K,ce,ee){var ne=Oe(7);return ne.write_shift(1,255),ne.write_shift(2,ce),ne.write_shift(2,K),ne.write_shift(2,ee,"i"),ne}function N(K,ce,ee){var ne=g(K,ce,ee);return ne[1].v=K.read_shift(8,"f"),ne}function S(K,ce,ee){var ne=Oe(13);return ne.write_shift(1,255),ne.write_shift(2,ce),ne.write_shift(2,K),ne.write_shift(8,ee,"f"),ne}function D(K,ce,ee){var ne=K.l+ce,le=g(K,ce,ee);if(le[1].v=K.read_shift(8,"f"),ee.qpro)K.l=ne;else{var qe=K.read_shift(2);q(K.slice(K.l,K.l+qe),le),K.l+=qe}return le}function U(K,ce,ee){var ne=ce&32768;return ce&=-32769,ce=(ne?K:0)+(ce>=8192?ce-16384:ce),(ne?"":"$")+(ee?Pr(ce):zr(ce))}var X={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},O=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function q(K,ce){wa(K,0);for(var ee=[],ne=0,le="",qe="",Le="",Pe="";K.l<K.length;){var Be=K[K.l++];switch(Be){case 0:ee.push(K.read_shift(8,"f"));break;case 1:qe=U(ce[0].c,K.read_shift(2),!0),le=U(ce[0].r,K.read_shift(2),!1),ee.push(qe+le);break;case 2:{var Te=U(ce[0].c,K.read_shift(2),!0),A=U(ce[0].r,K.read_shift(2),!1);qe=U(ce[0].c,K.read_shift(2),!0),le=U(ce[0].r,K.read_shift(2),!1),ee.push(Te+A+":"+qe+le)}break;case 3:if(K.l<K.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(K.read_shift(2));break;case 6:{for(var Y="";Be=K[K.l++];)Y+=String.fromCharCode(Be);ee.push('"'+Y.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:Pe=ee.pop(),Le=ee.pop(),ee.push(["AND","OR"][Be-20]+"("+Le+","+Pe+")");break;default:if(Be<32&&O[Be])Pe=ee.pop(),Le=ee.pop(),ee.push(Le+O[Be]+Pe);else if(X[Be]){if(ne=X[Be][1],ne==69&&(ne=K[K.l++]),ne>ee.length){console.error("WK1 bad formula parse 0x"+Be.toString(16)+":|"+ee.join("|")+"|");return}var ht=ee.slice(-ne);ee.length-=ne,ee.push(X[Be][0]+"("+ht.join(",")+")")}else return Be<=7?console.error("WK1 invalid opcode "+Be.toString(16)):Be<=24?console.error("WK1 unsupported op "+Be.toString(16)):Be<=30?console.error("WK1 invalid opcode "+Be.toString(16)):Be<=115?console.error("WK1 unsupported function opcode "+Be.toString(16)):console.error("WK1 unrecognized opcode "+Be.toString(16))}}ee.length==1?ce[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function oe(K){var ce=[{c:0,r:0},{t:"n",v:0},0];return ce[0].r=K.read_shift(2),ce[3]=K[K.l++],ce[0].c=K[K.l++],ce}function J(K,ce){var ee=oe(K);return ee[1].t="s",ee[1].v=K.read_shift(ce-4,"cstr"),ee}function M(K,ce,ee,ne){var le=Oe(6+ne.length);le.write_shift(2,K),le.write_shift(1,ee),le.write_shift(1,ce),le.write_shift(1,39);for(var qe=0;qe<ne.length;++qe){var Le=ne.charCodeAt(qe);le.write_shift(1,Le>=128?95:Le)}return le.write_shift(1,0),le}function ie(K,ce){var ee=oe(K);ee[1].v=K.read_shift(2);var ne=ee[1].v>>1;if(ee[1].v&1)switch(ne&7){case 0:ne=(ne>>3)*5e3;break;case 1:ne=(ne>>3)*500;break;case 2:ne=(ne>>3)/20;break;case 3:ne=(ne>>3)/200;break;case 4:ne=(ne>>3)/2e3;break;case 5:ne=(ne>>3)/2e4;break;case 6:ne=(ne>>3)/16;break;case 7:ne=(ne>>3)/64;break}return ee[1].v=ne,ee}function j(K,ce){var ee=oe(K),ne=K.read_shift(4),le=K.read_shift(4),qe=K.read_shift(2);if(qe==65535)return ne===0&&le===3221225472?(ee[1].t="e",ee[1].v=15):ne===0&&le===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var Le=qe&32768;return qe=(qe&32767)-16446,ee[1].v=(1-Le*2)*(le*Math.pow(2,qe+32)+ne*Math.pow(2,qe)),ee}function Ee(K,ce,ee,ne){var le=Oe(14);if(le.write_shift(2,K),le.write_shift(1,ee),le.write_shift(1,ce),ne==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var qe=0,Le=0,Pe=0,Be=0;return ne<0&&(qe=1,ne=-ne),Le=Math.log2(ne)|0,ne/=Math.pow(2,Le-31),Be=ne>>>0,Be&2147483648||(ne/=2,++Le,Be=ne>>>0),ne-=Be,Be|=2147483648,Be>>>=0,ne*=Math.pow(2,32),Pe=ne>>>0,le.write_shift(4,Pe),le.write_shift(4,Be),Le+=16383+(qe?32768:0),le.write_shift(2,Le),le}function he(K,ce){var ee=j(K);return K.l+=ce-14,ee}function te(K,ce){var ee=oe(K),ne=K.read_shift(4);return ee[1].v=ne>>6,ee}function be(K,ce){var ee=oe(K),ne=K.read_shift(8,"f");return ee[1].v=ne,ee}function $e(K,ce){var ee=be(K);return K.l+=ce-10,ee}function ae(K,ce){return K[K.l+ce-1]==0?K.read_shift(ce,"cstr"):""}function tt(K,ce){var ee=K[K.l++];ee>ce-1&&(ee=ce-1);for(var ne="";ne.length<ee;)ne+=String.fromCharCode(K[K.l++]);return ne}function Re(K,ce,ee){if(!(!ee.qpro||ce<21)){var ne=K.read_shift(1);K.l+=17,K.l+=1,K.l+=2;var le=K.read_shift(ce-21,"cstr");return[ne,le]}}function Ut(K,ce){for(var ee={},ne=K.l+ce;K.l<ne;){var le=K.read_shift(2);if(le==14e3){for(ee[le]=[0,""],ee[le][0]=K.read_shift(2);K[K.l];)ee[le][1]+=String.fromCharCode(K[K.l]),K.l++;K.l++}}return ee}function fe(K,ce){var ee=Oe(5+K.length);ee.write_shift(2,14e3),ee.write_shift(2,ce);for(var ne=0;ne<K.length;++ne){var le=K.charCodeAt(ne);ee[ee.l++]=le>127?95:le}return ee[ee.l++]=0,ee}var ot={0:{n:"BOF",f:ea},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:C},14:{n:"NUMBER",f:N},15:{n:"LABEL",f:v},16:{n:"FORMULA",f:D},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:v},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:tt},65535:{n:""}},pt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:J},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:ie},25:{n:"FORMULA19",f:he},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ut},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:be},40:{n:"FORMULA28",f:$e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Re},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:r}}();function Ym(e){var r={},t=e.match(Fa),n=0,s=!1;if(t)for(;n!=t.length;++n){var c=Tt(t[n]);switch(c[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!c.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(c.val=="1")break;r.cp=ll[parseInt(c.val,10)];break;case"<outline":if(!c.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=c.val;break;case"<sz":r.sz=c.val;break;case"<strike":if(!c.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!c.val)break;switch(c.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(c.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(c.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":c.rgb&&(r.color=c.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=c.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=c.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(c[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+c[0])}}return r}var Km=function(){var e=k0("t"),r=k0("rPr");function t(c){var h=c.match(e);if(!h)return{t:"s",v:""};var d={t:"s",v:$t(h[1])},m=c.match(r);return m&&(d.s=Ym(m[1])),d}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(h){return h.replace(n,"").split(s).map(t).filter(function(d){return d.v})}}(),qm=function(){var r=/(\r\n|\n)/g;function t(s,c,h){var d=[];s.u&&d.push("text-decoration: underline;"),s.uval&&d.push("text-underline-style:"+s.uval+";"),s.sz&&d.push("font-size:"+s.sz+"pt;"),s.outline&&d.push("text-effect: outline;"),s.shadow&&d.push("text-shadow: auto;"),c.push('<span style="'+d.join("")+'">'),s.b&&(c.push("<b>"),h.push("</b>")),s.i&&(c.push("<i>"),h.push("</i>")),s.strike&&(c.push("<s>"),h.push("</s>"));var m=s.valign||"";return m=="superscript"||m=="super"?m="sup":m=="subscript"&&(m="sub"),m!=""&&(c.push("<"+m+">"),h.push("</"+m+">")),h.push("</span>"),s}function n(s){var c=[[],s.v,[]];return s.v?(s.s&&t(s.s,c[0],c[2]),c[0].join("")+c[1].replace(r,"<br/>")+c[2].join("")):""}return function(c){return c.map(n).join("")}}(),Zm=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Jm=/<(?:\w+:)?r>/,Qm=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ol(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=$t(mr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=mr(e),t&&(n.h=vl(n.t))):e.match(Jm)&&(n.r=mr(e),n.t=$t(mr((e.replace(Qm,"").match(Zm)||[]).join("").replace(Fa,""))),t&&(n.h=qm(Km(n.r)))),n):{t:""}}var $m=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ep=/<(?:\w+:)?(?:si|sstItem)>/g,tp=/<\/(?:\w+:)?(?:si|sstItem)>/;function rp(e,r){var t=[],n="";if(!e)return t;var s=e.match($m);if(s){n=s[2].replace(ep,"").split(tp);for(var c=0;c!=n.length;++c){var h=Ol(n[c].trim(),r);h!=null&&(t[t.length]=h)}s=Tt(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}var ap=/^\s|\s$|[\t\n\r]/;function Zh(e,r){if(!r.bookSST)return"";var t=[Yr];t[t.length]=rt("sst",null,{xmlns:gs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],c="<si>";s.r?c+=s.r:(c+="<t",s.t||(s.t=""),s.t.match(ap)&&(c+=' xml:space="preserve"'),c+=">"+ur(s.t)+"</t>"),c+="</si>",t[t.length]=c}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function np(e){return[e.read_shift(4),e.read_shift(4)]}function ip(e,r){var t=[],n=!1;return pi(e,function(c,h,d){switch(d){case 159:t.Count=c[0],t.Unique=c[1];break;case 19:t.push(c);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(h.T,!n||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),t}function sp(e,r){return r||(r=Oe(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var op=pg;function cp(e){var r=Xa();Ve(r,159,sp(e));for(var t=0;t<e.length;++t)Ve(r,19,op(e[t]));return Ve(r,160),r.end()}function Jh(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function xi(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function lp(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=xi(e,4),r.U=xi(e,4),r.W=xi(e,4),r}function fp(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},s=e.read_shift(4),c=[];s-- >0;)c.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=c,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function hp(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(fp(e));return r}function up(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function dp(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=xi(e,4),r.U=xi(e,4),r.W=xi(e,4),r}function xp(e){var r=dp(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function Qh(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function $h(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function gp(e){var r=xi(e);switch(r.Minor){case 2:return[r.Minor,mp(e)];case 3:return[r.Minor,pp()];case 4:return[r.Minor,wp(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function mp(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=Qh(e,t),s=$h(e,e.length-e.l);return{t:"Std",h:n,v:s}}function pp(){throw new Error("File is password-protected: ECMA-376 Extensible")}function wp(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(Fa,function(c){var h=Tt(c);switch(Jn(h[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(d){n[d]=h[d]});break;case"<dataIntegrity":n.encryptedHmacKey=h.encryptedHmacKey,n.encryptedHmacValue=h.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=h.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(h);break;default:throw h[0]}}),n}function vp(e,r){var t={},n=t.EncryptionVersionInfo=xi(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var s=e.read_shift(4);return r-=4,t.EncryptionHeader=Qh(e,s),r-=s,t.EncryptionVerifier=$h(e,r),t}function yp(e){var r={},t=r.EncryptionVersionInfo=xi(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function Rl(e){var r=0,t,n=Jh(e),s=n.length+1,c,h,d,m,g;for(t=Pi(s),t[0]=n.length,c=1;c!=s;++c)t[c]=n[c-1];for(c=s-1;c>=0;--c)h=t[c],d=r&16384?1:0,m=r<<1&32767,g=d|m,r=g^h;return r^52811}var eu=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(h){return(h/2|h*128)&255},s=function(h,d){return n(h^d)},c=function(h){for(var d=r[h.length-1],m=104,g=h.length-1;g>=0;--g)for(var v=h[g],_=0;_!=7;++_)v&64&&(d^=t[m]),v*=2,--m;return d};return function(h){for(var d=Jh(h),m=c(d),g=d.length,v=Pi(16),_=0;_!=16;++_)v[_]=0;var C,T,N;for((g&1)===1&&(C=m>>8,v[g]=s(e[0],C),--g,C=m&255,T=d[d.length-1],v[g]=s(T,C));g>0;)--g,C=m>>8,v[g]=s(d[g],C),--g,C=m&255,v[g]=s(d[g],C);for(g=15,N=15-d.length;N>0;)C=m>>8,v[g]=s(e[N],C),--g,--N,C=m&255,v[g]=s(d[g],C),--g,--N;return v}}(),Ep=function(e,r,t,n,s){s||(s=r),n||(n=eu(e));var c,h;for(c=0;c!=r.length;++c)h=r[c],h^=n[t],h=(h>>5|h<<3)&255,s[c]=h,++t;return[s,t,n]},_p=function(e){var r=0,t=eu(e);return function(n){var s=Ep("",n,r,t);return r=s[1],s[0]}};function Ap(e,r,t,n){var s={key:ea(e),verificationBytes:ea(e)};return t.password&&(s.verifier=Rl(t.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=_p(t.password)),s}function bp(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=yp(e):n.Data=vp(e,r),n}function Sp(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?bp(e,r-2,n):Ap(e,t.biff>=8?r:r-2,t,n),n}var tu=function(){function e(s,c){switch(c.type){case"base64":return r(cn(s),c);case"binary":return r(s,c);case"buffer":return r(Gt&&Buffer.isBuffer(s)?s.toString("binary"):Ui(s),c);case"array":return r(ls(s),c)}throw new Error("Unrecognized type "+c.type)}function r(s,c){var h=c||{},d=h.dense?[]:{},m=s.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(v,_){Array.isArray(d)&&(d[_]=[]);for(var C=/\\\w+\b/g,T=0,N,S=-1;N=C.exec(v);){switch(N[0]){case"\\cell":var D=v.slice(T,C.lastIndex-N[0].length);if(D[0]==" "&&(D=D.slice(1)),++S,D.length){var U={v:D,t:"s"};Array.isArray(d)?d[_][S]=U:d[Ct({r:_,c:S})]=U}break}T=C.lastIndex}S>g.e.c&&(g.e.c=S)}),d["!ref"]=jt(g),d}function t(s,c){return Wi(e(s,c),c)}function n(s){for(var c=["{\\rtf1\\ansi"],h=er(s["!ref"]),d,m=Array.isArray(s),g=h.s.r;g<=h.e.r;++g){c.push("\\trowd\\trautofit1");for(var v=h.s.c;v<=h.e.c;++v)c.push("\\cellx"+(v+1));for(c.push("\\pard\\intbl"),v=h.s.c;v<=h.e.c;++v){var _=Ct({r:g,c:v});d=m?(s[g]||[])[v]:s[_],!(!d||d.v==null&&(!d.f||d.F))&&(c.push(" "+(d.w||(gi(d),d.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function Cp(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function O0(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Tp(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,s=Math.max(r,t,n),c=Math.min(r,t,n),h=s-c;if(h===0)return[0,0,r];var d=0,m=0,g=s+c;switch(m=h/(g>1?2-g:g),s){case r:d=((t-n)/h+6)%6;break;case t:d=(n-r)/h+2;break;case n:d=(r-t)/h+4;break}return[d/6,m,g/2]}function Np(e){var r=e[0],t=e[1],n=e[2],s=t*2*(n<.5?n:1-n),c=n-s/2,h=[c,c,c],d=6*r,m;if(t!==0)switch(d|0){case 0:case 6:m=s*d,h[0]+=s,h[1]+=m;break;case 1:m=s*(2-d),h[0]+=m,h[1]+=s;break;case 2:m=s*(d-2),h[1]+=s,h[2]+=m;break;case 3:m=s*(4-d),h[1]+=m,h[2]+=s;break;case 4:m=s*(d-4),h[2]+=s,h[0]+=m;break;case 5:m=s*(6-d),h[2]+=m,h[0]+=s;break}for(var g=0;g!=3;++g)h[g]=Math.round(h[g]*255);return h}function Zo(e,r){if(r===0)return e;var t=Tp(Cp(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),O0(Np(t))}var ru=6,kp=15,Ip=1,Na=ru;function R0(e){return Math.floor((e+Math.round(128/Na)/256)*Na)}function M0(e){return Math.floor((e-5)/Na*100+.5)/100}function Jo(e){return Math.round((e*Na+5)/Na*256)/256}function Uc(e){return Jo(M0(R0(e)))}function Ml(e){var r=Math.abs(e-Uc(e)),t=Na;if(r>.005)for(Na=Ip;Na<kp;++Na)Math.abs(e-Uc(e))<=r&&(r=Math.abs(e-Uc(e)),t=Na);Na=t}function Bi(e){e.width?(e.wpx=R0(e.width),e.wch=M0(e.wpx),e.MDW=Na):e.wpx?(e.wch=M0(e.wpx),e.width=Jo(e.wch),e.MDW=Na):typeof e.wch=="number"&&(e.width=Jo(e.wch),e.wpx=R0(e.width),e.MDW=Na),e.customWidth&&delete e.customWidth}var Dp=96,au=Dp;function P0(e){return e*96/au}function Ys(e){return e*au/96}var Fp={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Op(e,r,t,n){r.Borders=[];var s={},c=!1;(e[0].match(Fa)||[]).forEach(function(h){var d=Tt(h);switch(Jn(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},d.diagonalUp&&(s.diagonalUp=Nr(d.diagonalUp)),d.diagonalDown&&(s.diagonalDown=Nr(d.diagonalDown)),r.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(n&&n.WTF&&!c)throw new Error("unrecognized "+d[0]+" in borders")}})}function Rp(e,r,t,n){r.Fills=[];var s={},c=!1;(e[0].match(Fa)||[]).forEach(function(h){var d=Tt(h);switch(Jn(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},r.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":d.patternType&&(s.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),d.indexed&&(s.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(s.bgColor.theme=parseInt(d.theme,10)),d.tint&&(s.bgColor.tint=parseFloat(d.tint)),d.rgb&&(s.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),d.theme&&(s.fgColor.theme=parseInt(d.theme,10)),d.tint&&(s.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(s.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(n&&n.WTF&&!c)throw new Error("unrecognized "+d[0]+" in fills")}})}function Mp(e,r,t,n){r.Fonts=[];var s={},c=!1;(e[0].match(Fa)||[]).forEach(function(h){var d=Tt(h);switch(Jn(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(s),s={};break;case"<name":d.val&&(s.name=mr(d.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=d.val?Nr(d.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=d.val?Nr(d.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(d.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=d.val?Nr(d.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=d.val?Nr(d.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=d.val?Nr(d.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=d.val?Nr(d.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=d.val?Nr(d.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":d.val&&(s.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(s.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(s.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(s.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=ll[parseInt(d.val,10)];break;case"<color":if(s.color||(s.color={}),d.auto&&(s.color.auto=Nr(d.auto)),d.rgb)s.color.rgb=d.rgb.slice(-6);else if(d.indexed){s.color.index=parseInt(d.indexed,10);var m=ns[s.color.index];s.color.index==81&&(m=ns[1]),m||(m=ns[1]),s.color.rgb=m[0].toString(16)+m[1].toString(16)+m[2].toString(16)}else d.theme&&(s.color.theme=parseInt(d.theme,10),d.tint&&(s.color.tint=parseFloat(d.tint)),d.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=Zo(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":c=!0;break;case"</AlternateContent>":c=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(n&&n.WTF&&!c)throw new Error("unrecognized "+d[0]+" in fonts")}})}function Pp(e,r,t){r.NumberFmt=[];for(var n=Wr(bt),s=0;s<n.length;++s)r.NumberFmt[n[s]]=bt[n[s]];var c=e[0].match(Fa);if(c)for(s=0;s<c.length;++s){var h=Tt(c[s]);switch(Jn(h[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=$t(mr(h.formatCode)),m=parseInt(h.numFmtId,10);if(r.NumberFmt[m]=d,m>0){if(m>392){for(m=392;m>60&&r.NumberFmt[m]!=null;--m);r.NumberFmt[m]=d}di(d,m)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+h[0]+" in numFmts")}}}function Bp(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=rt("numFmt",null,{numFmtId:n,formatCode:ur(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=rt("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var Oo=["numFmtId","fillId","fontId","borderId","xfId"],Ro=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Lp(e,r,t){r.CellXf=[];var n,s=!1;(e[0].match(Fa)||[]).forEach(function(c){var h=Tt(c),d=0;switch(Jn(h[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=h,delete n[0],d=0;d<Oo.length;++d)n[Oo[d]]&&(n[Oo[d]]=parseInt(n[Oo[d]],10));for(d=0;d<Ro.length;++d)n[Ro[d]]&&(n[Ro[d]]=Nr(n[Ro[d]]));if(r.NumberFmt&&n.numFmtId>392){for(d=392;d>60;--d)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[d]){n.numFmtId=d;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var m={};h.vertical&&(m.vertical=h.vertical),h.horizontal&&(m.horizontal=h.horizontal),h.textRotation!=null&&(m.textRotation=h.textRotation),h.indent&&(m.indent=h.indent),h.wrapText&&(m.wrapText=Nr(h.wrapText)),n.alignment=m;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+h[0]+" in cellXfs")}})}function jp(e){var r=[];return r[r.length]=rt("cellXfs",null),e.forEach(function(t){r[r.length]=rt("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=rt("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var Up=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,c=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,m,g){var v={};if(!d)return v;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var _;return(_=d.match(r))&&Pp(_,v,g),(_=d.match(s))&&Mp(_,v,m,g),(_=d.match(n))&&Rp(_,v,m,g),(_=d.match(c))&&Op(_,v,m,g),(_=d.match(t))&&Lp(_,v,g),v}}();function nu(e,r){var t=[Yr,rt("styleSheet",null,{xmlns:gs[0],"xmlns:vt":na.vt})],n;return e.SSF&&(n=Bp(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=jp(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Wp(e,r){var t=e.read_shift(2),n=Ia(e);return[t,n]}function Vp(e,r,t){t||(t=Oe(6+4*r.length)),t.write_shift(2,e),da(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function Hp(e,r,t){var n={};n.sz=e.read_shift(2)/20;var s=bg(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var c=e.read_shift(2);switch(c===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var h=e.read_shift(1);h!=0&&(n.underline=h);var d=e.read_shift(1);d>0&&(n.family=d);var m=e.read_shift(1);switch(m>0&&(n.charset=m),e.l++,n.color=Ag(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ia(e),n}function Gp(e,r){r||(r=Oe(25+4*32)),r.write_shift(2,e.sz*20),Sg(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),Yo(e.color,r);var n=0;return n=2,r.write_shift(1,n),da(e.name,r),r.length>r.l?r.slice(0,r.l):r}var Xp=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Wc,zp=Da;function s1(e,r){r||(r=Oe(4*3+8*7+16*1)),Wc||(Wc=nc(Xp));var t=Wc[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(Yo({auto:1},r),Yo({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function Yp(e,r){var t=e.l+r,n=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:s}}function iu(e,r,t){t||(t=Oe(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function x0(e,r){return r||(r=Oe(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var Kp=Da;function qp(e,r){return r||(r=Oe(51)),r.write_shift(1,0),x0(null,r),x0(null,r),x0(null,r),x0(null,r),x0(null,r),r.length>r.l?r.slice(0,r.l):r}function Zp(e,r){return r||(r=Oe(12+4*10)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),zo(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function Jp(e,r,t){var n=Oe(2052);return n.write_shift(4,e),zo(r,n),zo(t,n),n.length>n.l?n.slice(0,n.l):n}function Qp(e,r,t){var n={};n.NumberFmt=[];for(var s in bt)n.NumberFmt[s]=bt[s];n.CellXf=[],n.Fonts=[];var c=[],h=!1;return pi(e,function(m,g,v){switch(v){case 44:n.NumberFmt[m[0]]=m[1],di(m[1],m[0]);break;case 43:n.Fonts.push(m),m.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(m.color.rgb=Zo(r.themeElements.clrScheme[m.color.theme].rgb,m.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:c[c.length-1]==617&&n.CellXf.push(m);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:h=!0;break;case 36:h=!1;break;case 37:c.push(v),h=!0;break;case 38:c.pop(),h=!1;break;default:if(g.T>0)c.push(v);else if(g.T<0)c.pop();else if(!h||t.WTF&&c[c.length-1]!=37)throw new Error("Unexpected record 0x"+v.toString(16))}}),n}function $p(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&++t}),t!=0&&(Ve(e,615,Rn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&Ve(e,44,Vp(s,r[s]))}),Ve(e,616))}}function ew(e){var r=1;Ve(e,611,Rn(r)),Ve(e,43,Gp({sz:12,color:{theme:1},name:"Calibri",family:2})),Ve(e,612)}function tw(e){var r=2;Ve(e,603,Rn(r)),Ve(e,45,s1({patternType:"none"})),Ve(e,45,s1({patternType:"gray125"})),Ve(e,604)}function rw(e){var r=1;Ve(e,613,Rn(r)),Ve(e,46,qp()),Ve(e,614)}function aw(e){var r=1;Ve(e,626,Rn(r)),Ve(e,47,iu({numFmtId:0},65535)),Ve(e,627)}function nw(e,r){Ve(e,617,Rn(r.length)),r.forEach(function(t){Ve(e,47,iu(t,0))}),Ve(e,618)}function iw(e){var r=1;Ve(e,619,Rn(r)),Ve(e,48,Zp({xfId:0,name:"Normal"})),Ve(e,620)}function sw(e){var r=0;Ve(e,505,Rn(r)),Ve(e,506)}function ow(e){var r=0;Ve(e,508,Jp(r,"TableStyleMedium9","PivotStyleMedium4")),Ve(e,509)}function cw(e,r){var t=Xa();return Ve(t,278),$p(t,e.SSF),ew(t),tw(t),rw(t),aw(t),nw(t,r.cellXfs),iw(t),sw(t),ow(t),Ve(t,279),t.end()}var lw=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function fw(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(Fa)||[]).forEach(function(s){var c=Tt(s);switch(c[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=c.val;break;case"<a:sysClr":n.rgb=c.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":c[0].charAt(1)==="/"?(r.themeElements.clrScheme[lw.indexOf(c[0])]=n,n={}):n.name=c[0].slice(3,c[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+c[0]+" in clrScheme")}})}function hw(){}function uw(){}var dw=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,xw=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,gw=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function mw(e,r,t){r.themeElements={};var n;[["clrScheme",dw,fw],["fontScheme",xw,hw],["fmtScheme",gw,uw]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,r,t)})}var pw=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function su(e,r){(!e||e.length===0)&&(e=Pl());var t,n={};if(!(t=e.match(pw)))throw new Error("themeElements not found in theme");return mw(t[0],n,r),n.raw=e,n}function Pl(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Yr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function ww(e,r,t){var n=e.l+r,s=e.read_shift(4);if(s!==124226){if(!t.cellStyles){e.l=n;return}var c=e.slice(e.l);e.l=n;var h;try{h=Q1(c,{type:"array"})}catch{return}var d=on(h,"theme/theme/theme1.xml",!0);if(d)return su(d,t)}}function vw(e){return e.read_shift(4)}function yw(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=Ew(e,4);break;case 2:r.xclrValue=jh(e);break;case 3:r.xclrValue=vw(e);break;case 4:e.l+=4;break}return e.l+=8,r}function Ew(e,r){return Da(e,r)}function _w(e,r){return Da(e,r)}function Aw(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=yw(e);break;case 6:n[1]=_w(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function bw(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),c=[];s-- >0;)c.push(Aw(e,t-e.l));return{ixfe:n,ext:c}}function Sw(e,r){r.forEach(function(t){switch(t[0]){}})}function Cw(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ia(e)}}function Tw(e){var r=Oe(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),da(e.name,r),r.slice(0,r.l)}function Nw(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function kw(e){var r=Oe(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function Iw(e,r){var t=Oe(8+2*r.length);return t.write_shift(4,e),da(r,t),t.slice(0,t.l)}function Dw(e){return e.l+=4,e.read_shift(4)!=0}function Fw(e,r){var t=Oe(8);return t.write_shift(4,e),t.write_shift(4,1),t}function Ow(e,r,t){var n={Types:[],Cell:[],Value:[]},s=t||{},c=[],h=!1,d=2;return pi(e,function(m,g,v){switch(v){case 335:n.Types.push({name:m.name});break;case 51:m.forEach(function(_){d==1?n.Cell.push({type:n.Types[_[0]-1].name,index:_[1]}):d==0&&n.Value.push({type:n.Types[_[0]-1].name,index:_[1]})});break;case 337:d=m?1:0;break;case 338:d=2;break;case 35:c.push(v),h=!0;break;case 36:c.pop(),h=!1;break;default:if(!g.T){if(!h||s.WTF&&c[c.length-1]!=35)throw new Error("Unexpected record 0x"+v.toString(16))}}}),n}function Rw(){var e=Xa();return Ve(e,332),Ve(e,334,Rn(1)),Ve(e,335,Tw({name:"XLDAPR",version:12e4,flags:3496657072})),Ve(e,336),Ve(e,339,Iw(1,"XLDAPR")),Ve(e,52),Ve(e,35,Rn(514)),Ve(e,4096,Rn(0)),Ve(e,4097,vn(1)),Ve(e,36),Ve(e,53),Ve(e,340),Ve(e,337,Fw(1)),Ve(e,51,kw([[1,0]])),Ve(e,338),Ve(e,333),e.end()}function Mw(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,c=2,h;return e.replace(Fa,function(d){var m=Tt(d);switch(Jn(m[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:m.name});break;case"</metadataType>":break;case"<futureMetadata":for(var g=0;g<n.Types.length;++g)n.Types[g].name==m.name&&(h=n.Types[g]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":c==1?n.Cell.push({type:n.Types[m.t-1].name,index:+m.v}):c==0&&n.Value.push({type:n.Types[m.t-1].name,index:+m.v});break;case"</rc>":break;case"<cellMetadata":c=1;break;case"</cellMetadata>":c=2;break;case"<valueMetadata":c=0;break;case"</valueMetadata>":c=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!h)break;h.offsets||(h.offsets=[]),h.offsets.push(+m.i);break;default:if(!s&&t.WTF)throw new Error("unrecognized "+m[0]+" in metadata")}return d}),n}function ou(){var e=[Yr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Pw(e){var r=[];if(!e)return r;var t=1;return(e.match(Fa)||[]).forEach(function(n){var s=Tt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,r.push(s);break}}),r}function Bw(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Ct(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function Lw(e,r,t){var n=[];return pi(e,function(c,h,d){switch(d){case 63:n.push(c);break;default:if(!h.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function jw(e,r,t,n){if(!e)return e;var s=n||{},c=!1;pi(e,function(d,m,g){switch(g){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:c=!0;break;case 36:c=!1;break;default:if(!m.T){if(!c||s.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}},s)}function Uw(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}var js=1024;function cu(e,r){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[rt("xml",null,{"xmlns:v":an.v,"xmlns:o":an.o,"xmlns:x":an.x,"xmlns:mv":an.mv}).replace(/\/>/,">"),rt("o:shapelayout",rt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),rt("v:shapetype",[rt("v:stroke",null,{joinstyle:"miter"}),rt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];js<e*1e3;)js+=1e3;return r.forEach(function(c){var h=Br(c[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var m=d.type=="gradient"?rt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,g=rt("v:fill",m,d),v={on:"t",obscured:"t"};++js,s=s.concat(["<v:shape"+I0({id:"_x0000_s"+js,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",g,rt("v:shadow",null,v),rt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",va("x:Anchor",[h.c+1,0,h.r+1,0,h.c+3,20,h.r+5,20].join(",")),va("x:AutoFill","False"),va("x:Row",String(h.r)),va("x:Column",String(h.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function o1(e,r,t,n){var s=Array.isArray(e),c;r.forEach(function(h){var d=Br(h.ref);if(s?(e[d.r]||(e[d.r]=[]),c=e[d.r][d.c]):c=e[h.ref],!c){c={t:"z"},s?e[d.r][d.c]=c:e[h.ref]=c;var m=er(e["!ref"]||"BDWGO1000001:A1");m.s.r>d.r&&(m.s.r=d.r),m.e.r<d.r&&(m.e.r=d.r),m.s.c>d.c&&(m.s.c=d.c),m.e.c<d.c&&(m.e.c=d.c);var g=jt(m);g!==e["!ref"]&&(e["!ref"]=g)}c.c||(c.c=[]);var v={a:h.author,t:h.t,r:h.r,T:t};h.h&&(v.h=h.h);for(var _=c.c.length-1;_>=0;--_){if(!t&&c.c[_].T)return;t&&!c.c[_].T&&c.c.splice(_,1)}if(t&&n){for(_=0;_<n.length;++_)if(v.a==n[_].id){v.a=n[_].name||v.a;break}}c.c.push(v)})}function Ww(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(h){if(!(h===""||h.trim()==="")){var d=h.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&t.push(d[1])}});var c=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return c&&c[1]&&c[1].split(/<\/\w*:?comment>/).forEach(function(h){if(!(h===""||h.trim()==="")){var d=h.match(/<(?:\w+:)?comment[^>]*>/);if(d){var m=Tt(d[0]),g={author:m.authorId&&t[m.authorId]||"sheetjsghost",ref:m.ref,guid:m.guid},v=Br(m.ref);if(!(r.sheetRows&&r.sheetRows<=v.r)){var _=h.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),C=!!_&&!!_[1]&&Ol(_[1])||{r:"",t:"",h:""};g.r=C.r,C.r=="<t></t>"&&(C.t=C.h=""),g.t=(C.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(g.h=C.h),n.push(g)}}}}),n}function lu(e){var r=[Yr,rt("comments",null,{xmlns:gs[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var c=ur(s.a);t.indexOf(c)==-1&&(t.push(c),r.push("<author>"+c+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),r.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var s=0,c=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(m){m.a&&(s=t.indexOf(ur(m.a))),c.push(m.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),c.length<=1)r.push(va("t",ur(c[0]||"")));else{for(var h=`Comment:
    `+c[0]+`
`,d=1;d<c.length;++d)h+=`Reply:
    `+c[d]+`
`;r.push(va("t",ur(h)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Vw(e,r){var t=[],n=!1,s={},c=0;return e.replace(Fa,function(d,m){var g=Tt(d);switch(Jn(g[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:g.personId,guid:g.id,ref:g.ref,T:1};break;case"</threadedComment>":s.t!=null&&t.push(s);break;case"<text>":case"<text":c=m+d.length;break;case"</text>":s.t=e.slice(c,m).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+g[0]+" in threaded comments")}return d}),t}function Hw(e,r,t){var n=[Yr,rt("ThreadedComments",null,{xmlns:na.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var c="";(s[1]||[]).forEach(function(h,d){if(!h.T){delete h.ID;return}h.a&&r.indexOf(h.a)==-1&&r.push(h.a);var m={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};d==0?c=m.id:m.parentId=c,h.ID=m.id,h.a&&(m.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(h.a)).slice(-12)+"}"),n.push(rt("threadedComment",va("text",h.t||""),m))})}),n.push("</ThreadedComments>"),n.join("")}function Gw(e,r){var t=[],n=!1;return e.replace(Fa,function(c){var h=Tt(c);switch(Jn(h[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:h.displayname,id:h.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),t}function Xw(e){var r=[Yr,rt("personList",null,{xmlns:na.TCMNT,"xmlns:x":gs[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(rt("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function zw(e){var r={};r.iauthor=e.read_shift(4);var t=vs(e);return r.rfx=t.s,r.ref=Ct(t.s),e.l+=16,r}function Yw(e,r){return r==null&&(r=Oe(36)),r.write_shift(4,e[1].iauthor),Js(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var Kw=Ia;function qw(e){return da(e.slice(0,54))}function Zw(e,r){var t=[],n=[],s={},c=!1;return pi(e,function(d,m,g){switch(g){case 632:n.push(d);break;case 635:s=d;break;case 637:s.t=d.t,s.h=d.h,s.r=d.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,r.sheetRows&&s.rfx&&r.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!m.T){if(!c||r.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}),t}function Jw(e){var r=Xa(),t=[];return Ve(r,628),Ve(r,630),e.forEach(function(n){n[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),Ve(r,632,qw(s.a)))})}),Ve(r,631),Ve(r,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var c={s:Br(n[0]),e:Br(n[0])};Ve(r,635,Yw([c,s])),s.t&&s.t.length>0&&Ve(r,637,vg(s)),Ve(r,636),delete s.iauthor})}),Ve(r,634),Ve(r,629),r.end()}var Qw="application/vnd.ms-office.vbaProject";function $w(e){var r=mt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");mt.utils.cfb_add(r,s,e.FileIndex[n].content)}}),mt.write(r)}function ev(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&mt.utils.cfb_add(e,s,r.FileIndex[n].content)}})}var fu=["xlsb","xlsm","xlam","biff8","xla"];function tv(){return{"!type":"dialog"}}function rv(){return{"!type":"dialog"}}function av(){return{"!type":"macro"}}function nv(){return{"!type":"macro"}}var Hs=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,s,c,h){var d=!1,m=!1;c.length==0?m=!0:c.charAt(0)=="["&&(m=!0,c=c.slice(1,-1)),h.length==0?d=!0:h.charAt(0)=="["&&(d=!0,h=h.slice(1,-1));var g=c.length>0?parseInt(c,10)|0:0,v=h.length>0?parseInt(h,10)|0:0;return d?v+=r.c:--v,m?g+=r.r:--g,s+(d?"":"$")+Pr(v)+(m?"":"$")+zr(g)}return function(s,c){return r=c,s.replace(e,t)}}(),Bl=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ll=function(){return function(r,t){return r.replace(Bl,function(n,s,c,h,d,m){var g=bl(h)-(c?0:t.c),v=Al(m)-(d?0:t.r),_=v==0?"":d?v+1:"["+v+"]",C=g==0?"":c?g+1:"["+g+"]";return s+"R"+_+"C"+C})}}();function hu(e,r){return e.replace(Bl,function(t,n,s,c,h,d){return n+(s=="$"?s+c:Pr(bl(c)+r.c))+(h=="$"?h+d:zr(Al(d)+r.r))})}function iv(e,r,t){var n=za(r),s=n.s,c=Br(t),h={r:c.r-s.r,c:c.c-s.c};return hu(e,h)}function sv(e){return e.length!=1}function c1(e){return e.replace(/_xlfn\./g,"")}function Qr(e){e.l+=1}function Li(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function uu(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return du(e);t.biff==12&&(n=4)}var s=e.read_shift(n),c=e.read_shift(n),h=Li(e),d=Li(e);return{s:{r:s,c:h[0],cRel:h[1],rRel:h[2]},e:{r:c,c:d[0],cRel:d[1],rRel:d[2]}}}function du(e){var r=Li(e),t=Li(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function ov(e,r,t){if(t.biff<8)return du(e);var n=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),c=Li(e),h=Li(e);return{s:{r:n,c:c[0],cRel:c[1],rRel:c[2]},e:{r:s,c:h[0],cRel:h[1],rRel:h[2]}}}function xu(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return cv(e);var n=e.read_shift(t&&t.biff==12?4:2),s=Li(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function cv(e){var r=Li(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function lv(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function fv(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return hv(e);var s=e.read_shift(n>=12?4:2),c=e.read_shift(2),h=(c&16384)>>14,d=(c&32768)>>15;if(c&=16383,d==1)for(;s>524287;)s-=1048576;if(h==1)for(;c>8191;)c=c-16384;return{r:s,c,cRel:h,rRel:d}}function hv(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,s=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),s==1&&t>=128&&(t=t-256),{r,c:t,cRel:s,rRel:n}}function uv(e,r,t){var n=(e[e.l++]&96)>>5,s=uu(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,s]}function dv(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}var h=uu(e,c,t);return[n,s,h]}function xv(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function gv(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}return e.l+=c,[n,s]}function mv(e,r,t){var n=(e[e.l++]&96)>>5,s=ov(e,r-1,t);return[n,s]}function pv(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function l1(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function wv(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),s=[],c=0;c<=n;++c)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function vv(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function yv(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function Ev(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function _v(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function gu(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function Av(e){return e.read_shift(2),gu(e)}function bv(e){return e.read_shift(2),gu(e)}function Sv(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=xu(e,0,t);return[n,s]}function Cv(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=fv(e,0,t);return[n,s]}function Tv(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var c=xu(e,0,t);return[n,s,c]}function Nv(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[D3[s],wu[s],n]}function kv(e,r,t){var n=e[e.l++],s=e.read_shift(1),c=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:Iv(e);return[s,(c[0]===0?wu:I3)[c[1]]]}function Iv(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Dv(e,r,t){e.l+=t&&t.biff==2?3:4}function Fv(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function Ov(e){return e.l++,wi[e.read_shift(1)]}function Rv(e){return e.l++,e.read_shift(2)}function Mv(e){return e.l++,e.read_shift(1)!==0}function Pv(e){return e.l++,ka(e)}function Bv(e,r,t){return e.l++,V0(e,r-1,t)}function Lv(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Xr(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=wi[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=ka(e);break;case 2:t[1]=ys(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function jv(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),s=[],c=0;c!=n;++c)s.push((t.biff==12?vs:oc)(e));return s}function Uv(e,r,t){var n=0,s=0;t.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--s==0&&(s=256));for(var c=0,h=[];c!=n&&(h[c]=[]);++c)for(var d=0;d!=s;++d)h[c][d]=Lv(e,t.biff);return h}function Wv(e,r,t){var n=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,c=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,c]}function Vv(e,r,t){if(t.biff==5)return Hv(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),c=e.read_shift(4);return[n,s,c]}function Hv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function Gv(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function Xv(e,r,t){var n=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function zv(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function Yv(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),c=4;if(t)switch(t.biff){case 5:c=15;break;case 12:c=6;break}return e.l+=c,[n,s]}var Kv=Da,qv=Da,Zv=Da;function G0(e,r,t){return e.l+=2,[lv(e)]}function jl(e){return e.l+=6,[]}var Jv=G0,Qv=jl,$v=jl,e3=G0;function mu(e){return e.l+=2,[ea(e),e.read_shift(2)&1]}var t3=G0,r3=mu,a3=jl,n3=G0,i3=G0,s3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function o3(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),c=e.read_shift(2),h=s3[t>>2&31];return{ixti:r,coltype:t&3,rt:h,idx:n,c:s,C:c}}function c3(e){return e.l+=2,[e.read_shift(4)]}function l3(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function f3(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function h3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function u3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function d3(e){return e.l+=4,[0,0]}var f1={1:{n:"PtgExp",f:Fv},2:{n:"PtgTbl",f:Zv},3:{n:"PtgAdd",f:Qr},4:{n:"PtgSub",f:Qr},5:{n:"PtgMul",f:Qr},6:{n:"PtgDiv",f:Qr},7:{n:"PtgPower",f:Qr},8:{n:"PtgConcat",f:Qr},9:{n:"PtgLt",f:Qr},10:{n:"PtgLe",f:Qr},11:{n:"PtgEq",f:Qr},12:{n:"PtgGe",f:Qr},13:{n:"PtgGt",f:Qr},14:{n:"PtgNe",f:Qr},15:{n:"PtgIsect",f:Qr},16:{n:"PtgUnion",f:Qr},17:{n:"PtgRange",f:Qr},18:{n:"PtgUplus",f:Qr},19:{n:"PtgUminus",f:Qr},20:{n:"PtgPercent",f:Qr},21:{n:"PtgParen",f:Qr},22:{n:"PtgMissArg",f:Qr},23:{n:"PtgStr",f:Bv},26:{n:"PtgSheet",f:l3},27:{n:"PtgEndSheet",f:f3},28:{n:"PtgErr",f:Ov},29:{n:"PtgBool",f:Mv},30:{n:"PtgInt",f:Rv},31:{n:"PtgNum",f:Pv},32:{n:"PtgArray",f:pv},33:{n:"PtgFunc",f:Nv},34:{n:"PtgFuncVar",f:kv},35:{n:"PtgName",f:Wv},36:{n:"PtgRef",f:Sv},37:{n:"PtgArea",f:uv},38:{n:"PtgMemArea",f:Gv},39:{n:"PtgMemErr",f:Kv},40:{n:"PtgMemNoMem",f:qv},41:{n:"PtgMemFunc",f:Xv},42:{n:"PtgRefErr",f:zv},43:{n:"PtgAreaErr",f:xv},44:{n:"PtgRefN",f:Cv},45:{n:"PtgAreaN",f:mv},46:{n:"PtgMemAreaN",f:h3},47:{n:"PtgMemNoMemN",f:u3},57:{n:"PtgNameX",f:Vv},58:{n:"PtgRef3d",f:Tv},59:{n:"PtgArea3d",f:dv},60:{n:"PtgRefErr3d",f:Yv},61:{n:"PtgAreaErr3d",f:gv},255:{}},x3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},g3={1:{n:"PtgElfLel",f:mu},2:{n:"PtgElfRw",f:n3},3:{n:"PtgElfCol",f:Jv},6:{n:"PtgElfRwV",f:i3},7:{n:"PtgElfColV",f:e3},10:{n:"PtgElfRadical",f:t3},11:{n:"PtgElfRadicalS",f:a3},13:{n:"PtgElfColS",f:Qv},15:{n:"PtgElfColSV",f:$v},16:{n:"PtgElfRadicalLel",f:r3},25:{n:"PtgList",f:o3},29:{n:"PtgSxName",f:c3},255:{}},m3={0:{n:"PtgAttrNoop",f:d3},1:{n:"PtgAttrSemi",f:_v},2:{n:"PtgAttrIf",f:yv},4:{n:"PtgAttrChoose",f:wv},8:{n:"PtgAttrGoto",f:vv},16:{n:"PtgAttrSum",f:Dv},32:{n:"PtgAttrBaxcel",f:l1},33:{n:"PtgAttrBaxcel",f:l1},64:{n:"PtgAttrSpace",f:Av},65:{n:"PtgAttrSpaceSemi",f:bv},128:{n:"PtgAttrIfError",f:Ev},255:{}};function X0(e,r,t,n){if(n.biff<8)return Da(e,r);for(var s=e.l+r,c=[],h=0;h!==t.length;++h)switch(t[h][0]){case"PtgArray":t[h][1]=Uv(e,0,n),c.push(t[h][1]);break;case"PtgMemArea":t[h][2]=jv(e,t[h][1],n),c.push(t[h][2]);break;case"PtgExp":n&&n.biff==12&&(t[h][1][1]=e.read_shift(4),c.push(t[h][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[h][0]}return r=s-e.l,r!==0&&c.push(Da(e,r)),c}function z0(e,r,t){for(var n=e.l+r,s,c,h=[];n!=e.l;)r=n-e.l,c=e[e.l],s=f1[c]||f1[x3[c]],(c===24||c===25)&&(s=(c===24?g3:m3)[e[e.l+1]]),!s||!s.f?Da(e,r):h.push([s.n,s.f(e,r,t)]);return h}function p3(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],s=[],c=0;c<n.length;++c){var h=n[c];if(h)switch(h[0]){case 2:s.push('"'+h[1].replace(/"/g,'""')+'"');break;default:s.push(h[1])}else s.push("")}r.push(s.join(","))}return r.join(";")}var w3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function v3(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function pu(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function h1(e,r,t){var n=pu(e,r,t);return n=="#REF"?n:v3(n,t)}function Ta(e,r,t,n,s){var c=s&&s.biff||8,h={s:{c:0,r:0}},d=[],m,g,v,_=0,C=0,T,N="";if(!e[0]||!e[0][0])return"";for(var S=-1,D="",U=0,X=e[0].length;U<X;++U){var O=e[0][U];switch(O[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=d.pop(),g=d.pop(),S>=0){switch(e[0][S][1][0]){case 0:D=jr(" ",e[0][S][1][1]);break;case 1:D=jr("\r",e[0][S][1][1]);break;default:if(D="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}g=g+D,S=-1}d.push(g+w3[O[0]]+m);break;case"PtgIsect":m=d.pop(),g=d.pop(),d.push(g+" "+m);break;case"PtgUnion":m=d.pop(),g=d.pop(),d.push(g+","+m);break;case"PtgRange":m=d.pop(),g=d.pop(),d.push(g+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":v=v0(O[1][1],h,s),d.push(y0(v,c));break;case"PtgRefN":v=t?v0(O[1][1],t,s):O[1][1],d.push(y0(v,c));break;case"PtgRef3d":_=O[1][1],v=v0(O[1][2],h,s),N=h1(n,_,s),d.push(N+"!"+y0(v,c));break;case"PtgFunc":case"PtgFuncVar":var q=O[1][0],oe=O[1][1];q||(q=0),q&=127;var J=q==0?[]:d.slice(-q);d.length-=q,oe==="User"&&(oe=J.shift()),d.push(oe+"("+J.join(",")+")");break;case"PtgBool":d.push(O[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(O[1]);break;case"PtgNum":d.push(String(O[1]));break;case"PtgStr":d.push('"'+O[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(O[1]);break;case"PtgAreaN":T=Uf(O[1][1],t?{s:t}:h,s),d.push(Bc(T,s));break;case"PtgArea":T=Uf(O[1][1],h,s),d.push(Bc(T,s));break;case"PtgArea3d":_=O[1][1],T=O[1][2],N=h1(n,_,s),d.push(N+"!"+Bc(T,s));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":C=O[1][2];var M=(n.names||[])[C-1]||(n[0]||[])[C],ie=M?M.Name:"SH33TJSNAME"+String(C);ie&&ie.slice(0,6)=="_xlfn."&&!s.xlfn&&(ie=ie.slice(6)),d.push(ie);break;case"PtgNameX":var j=O[1][1];C=O[1][2];var Ee;if(s.biff<=5)j<0&&(j=-j),n[j]&&(Ee=n[j][C]);else{var he="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][C]&&n[j][C].itab>0&&(he=n.SheetNames[n[j][C].itab-1]+"!"):he=n.SheetNames[C-1]+"!"),n[j]&&n[j][C])he+=n[j][C].Name;else if(n[0]&&n[0][C])he+=n[0][C].Name;else{var te=(pu(n,j,s)||"").split(";;");te[C-1]?he=te[C-1]:he+="SH33TJSERRX"}d.push(he);break}Ee||(Ee={Name:"SH33TJSERRY"}),d.push(Ee.Name);break;case"PtgParen":var be="(",$e=")";if(S>=0){switch(D="",e[0][S][1][0]){case 2:be=jr(" ",e[0][S][1][1])+be;break;case 3:be=jr("\r",e[0][S][1][1])+be;break;case 4:$e=jr(" ",e[0][S][1][1])+$e;break;case 5:$e=jr("\r",e[0][S][1][1])+$e;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}S=-1}d.push(be+d.pop()+$e);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":v={c:O[1][1],r:O[1][0]};var ae={c:t.c,r:t.r};if(n.sharedf[Ct(v)]){var tt=n.sharedf[Ct(v)];d.push(Ta(tt,h,ae,n,s))}else{var Re=!1;for(m=0;m!=n.arrayf.length;++m)if(g=n.arrayf[m],!(v.c<g[0].s.c||v.c>g[0].e.c)&&!(v.r<g[0].s.r||v.r>g[0].e.r)){d.push(Ta(g[1],h,ae,n,s)),Re=!0;break}Re||d.push(O[1])}break;case"PtgArray":d.push("{"+p3(O[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=U;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+O[1].idx+"[#"+O[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(O));default:throw new Error("Unrecognized Formula Token: "+String(O))}var Ut=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&S>=0&&Ut.indexOf(e[0][U][0])==-1){O=e[0][S];var fe=!0;switch(O[1][0]){case 4:fe=!1;case 0:D=jr(" ",O[1][1]);break;case 5:fe=!1;case 1:D=jr("\r",O[1][1]);break;default:if(D="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+O[1][0])}d.push((fe?D:"")+d.pop()+(fe?"":D)),S=-1}}if(d.length>1&&s.WTF)throw new Error("bad formula stack");return d[0]}function y3(e,r,t){var n=e.l+r,s=t.biff==2?1:2,c,h=e.read_shift(s);if(h==65535)return[[],Da(e,r-2)];var d=z0(e,h,t);return r!==h+s&&(c=X0(e,r-h-s,d,t)),e.l=n,[d,c]}function E3(e,r,t){var n=e.l+r,s=t.biff==2?1:2,c,h=e.read_shift(s);if(h==65535)return[[],Da(e,r-2)];var d=z0(e,h,t);return r!==h+s&&(c=X0(e,r-h-s,d,t)),e.l=n,[d,c]}function _3(e,r,t,n){var s=e.l+r,c=z0(e,n,t),h;return s!==e.l&&(h=X0(e,s-e.l,c,t)),[c,h]}function A3(e,r,t){var n=e.l+r,s,c=e.read_shift(2),h=z0(e,c,t);return c==65535?[[],Da(e,r-2)]:(r!==c+2&&(s=X0(e,n-c-2,h,t)),[h,s])}function b3(e){var r;if(hi(e,e.l+6)!==65535)return[ka(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function S3(e){if(e==null){var r=Oe(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return fs(e);return fs(0)}function Vc(e,r,t){var n=e.l+r,s=Qn(e);t.biff==2&&++e.l;var c=b3(e),h=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var d=E3(e,n-e.l,t);return{cell:s,val:c[0],formula:d,shared:h>>3&1,tt:c[1]}}function C3(e,r,t,n,s){var c=us(r,t,s),h=S3(e.v),d=Oe(6),m=33;d.write_shift(2,m),d.write_shift(4,0);for(var g=Oe(e.bf.length),v=0;v<e.bf.length;++v)g[v]=e.bf[v];var _=ua([c,h,d,g]);return _}function cc(e,r,t){var n=e.read_shift(4),s=z0(e,n,t),c=e.read_shift(4),h=c>0?X0(e,c,s,t):null;return[s,h]}var T3=cc,lc=cc,N3=cc,k3=cc,I3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},wu={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},D3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function u1(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function F3(e){var r="of:="+e.replace(Bl,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function Hc(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function O3(e){return e.replace(/\./,"!")}var _0={},Gs={},A0=typeof Map<"u";function Ul(e,r,t){var n=0,s=e.length;if(t){if(A0?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var c=A0?t.get(r):t[r];n<c.length;++n)if(e[c[n]].t===r)return e.Count++,c[n]}}else for(;n<s;++n)if(e[n].t===r)return e.Count++,n;return e[s]={t:r},e.Count++,e.Unique++,t&&(A0?(t.has(r)||t.set(r,[]),t.get(r).push(s)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(s))),s}function fc(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(Na=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=M0(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=Jo(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function os(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Vi(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],s=60,c=e.length;if(n==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){di(r.z,s),t.ssf[s]=r.z,t.revssf[r.z]=n=s;break}}for(s=0;s!=c;++s)if(e[s].numFmtId===n)return s;return e[c]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function vu(e,r,t,n,s,c){try{n.cellNF&&(e.z=bt[r])}catch(d){if(n.WTF)throw d}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=kr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(bt[r]==null&&di(Ix[r]||"General",r),e.t==="e")e.w=e.w||wi[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=N0(e.v);else if(e.t==="d"){var h=ia(e.v);(h|0)===h?e.w=h.toString(10):e.w=N0(h)}else{if(e.v===void 0)return"";e.w=cs(e.v,Gs)}else e.t==="d"?e.w=En(r,ia(e.v),Gs):e.w=En(r,e.v,Gs)}catch(d){if(n.WTF)throw d}if(n.cellStyles&&t!=null)try{e.s=c.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Zo(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Zo(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(n.WTF&&c.Fills)throw d}}}function R3(e,r,t){if(e&&e["!ref"]){var n=er(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function M3(e,r){var t=er(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=jt(t))}var P3=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,B3=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,L3=/<(?:\w:)?hyperlink [^>]*>/mg,j3=/"(\w*:\w*)"/,U3=/<(?:\w:)?col\b[^>]*[\/]?>/g,W3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,V3=/<(?:\w:)?pageMargins[^>]*\/>/g,yu=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,H3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,G3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function X3(e,r,t,n,s,c,h){if(!e)return e;n||(n={"!id":{}});var d=r.dense?[]:{},m={s:{r:2e6,c:2e6},e:{r:0,c:0}},g="",v="",_=e.match(B3);_?(g=e.slice(0,_.index),v=e.slice(_.index+_[0].length)):g=v=e;var C=g.match(yu);C?Wl(C[0],d,s,t):(C=g.match(H3))&&Y3(C[0],C[1]||"",d,s,t);var T=(g.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var N=g.slice(T,T+50).match(j3);N&&M3(d,N[1])}var S=g.match(G3);S&&S[1]&&sy(S[1],s);var D=[];if(r.cellStyles){var U=g.match(U3);U&&ty(D,U)}_&&ly(_[1],d,r,m,c,h);var X=v.match(W3);X&&(d["!autofilter"]=ay(X[0]));var O=[],q=v.match(P3);if(q)for(T=0;T!=q.length;++T)O[T]=er(q[T].slice(q[T].indexOf('"')+1));var oe=v.match(L3);oe&&Q3(d,oe,n);var J=v.match(V3);if(J&&(d["!margins"]=$3(Tt(J[0]))),!d["!ref"]&&m.e.c>=m.s.c&&m.e.r>=m.s.r&&(d["!ref"]=jt(m)),r.sheetRows>0&&d["!ref"]){var M=er(d["!ref"]);r.sheetRows<=+M.e.r&&(M.e.r=r.sheetRows-1,M.e.r>m.e.r&&(M.e.r=m.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>m.e.c&&(M.e.c=m.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),d["!fullref"]=d["!ref"],d["!ref"]=jt(M))}return D.length>0&&(d["!cols"]=D),O.length>0&&(d["!merges"]=O),d}function z3(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+jt(e[t])+'"/>';return r+"</mergeCells>"}function Wl(e,r,t,n){var s=Tt(e);t.Sheets[n]||(t.Sheets[n]={}),s.codeName&&(t.Sheets[n].CodeName=$t(mr(s.codeName)))}function Y3(e,r,t,n,s){Wl(e.slice(0,e.indexOf(">")),t,n,s)}function K3(e,r,t,n,s){var c=!1,h={},d=null;if(n.bookType!=="xlsx"&&r.vbaraw){var m=r.SheetNames[t];try{r.Workbook&&(m=r.Workbook.Sheets[t].CodeName||m)}catch{}c=!0,h.codeName=Zn(ur(m))}if(e&&e["!outline"]){var g={summaryBelow:1,summaryRight:1};e["!outline"].above&&(g.summaryBelow=0),e["!outline"].left&&(g.summaryRight=0),d=(d||"")+rt("outlinePr",null,g)}!c&&!d||(s[s.length]=rt("sheetPr",d,h))}var q3=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Z3=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function J3(e){var r={sheet:1};return q3.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),Z3.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=Rl(e.password).toString(16).toUpperCase()),rt("sheetProtection",null,r)}function Q3(e,r,t){for(var n=Array.isArray(e),s=0;s!=r.length;++s){var c=Tt(mr(r[s]),!0);if(!c.ref)return;var h=((t||{})["!id"]||[])[c.id];h?(c.Target=h.Target,c.location&&(c.Target+="#"+$t(c.location))):(c.Target="#"+$t(c.location),h={Target:c.Target,TargetMode:"Internal"}),c.Rel=h,c.tooltip&&(c.Tooltip=c.tooltip,delete c.tooltip);for(var d=er(c.ref),m=d.s.r;m<=d.e.r;++m)for(var g=d.s.c;g<=d.e.c;++g){var v=Ct({c:g,r:m});n?(e[m]||(e[m]=[]),e[m][g]||(e[m][g]={t:"z",v:void 0}),e[m][g].l=c):(e[v]||(e[v]={t:"z",v:void 0}),e[v].l=c)}}}function $3(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function ey(e){return os(e),rt("pageMargins",null,e)}function ty(e,r){for(var t=!1,n=0;n!=r.length;++n){var s=Tt(r[n],!0);s.hidden&&(s.hidden=Nr(s.hidden));var c=parseInt(s.min,10)-1,h=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,Ml(s.width)),Bi(s);c<=h;)e[c++]=Ir(s)}}function ry(e,r){for(var t=["<cols>"],n,s=0;s!=r.length;++s)(n=r[s])&&(t[t.length]=rt("col",null,fc(s,n)));return t[t.length]="</cols>",t.join("")}function ay(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}function ny(e,r,t,n){var s=typeof e.ref=="string"?e.ref:jt(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var c=t.Workbook.Names,h=za(s);h.s.r==h.e.r&&(h.e.r=za(r["!ref"]).e.r,s=jt(h));for(var d=0;d<c.length;++d){var m=c[d];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==n){m.Ref="'"+t.SheetNames[n]+"'!"+s;break}}return d==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),rt("autoFilter",null,{ref:s})}var iy=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function sy(e,r){r.Views||(r.Views=[{}]),(e.match(iy)||[]).forEach(function(t,n){var s=Tt(t);r.Views[n]||(r.Views[n]={}),+s.zoomScale&&(r.Views[n].zoom=+s.zoomScale),Nr(s.rightToLeft)&&(r.Views[n].RTL=!0)})}function oy(e,r,t,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),rt("sheetViews",rt("sheetView",null,s),{})}function cy(e,r,t,n){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",c=e.t,h=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=wi[e.v];break;case"d":n&&n.cellDates?s=kr(e.v,-1).toISOString():(e=Ir(e),e.t="n",s=""+(e.v=ia(kr(e.v)))),typeof e.z>"u"&&(e.z=bt[14]);break;default:s=e.v;break}var d=va("v",ur(s)),m={r},g=Vi(n.cellXfs,e,n);switch(g!==0&&(m.s=g),e.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){d=va("v",""+Ul(n.Strings,e.v,n.revStrings)),m.t="s";break}m.t="str";break}if(e.t!=c&&(e.t=c,e.v=h),typeof e.f=="string"&&e.f){var v=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;d=rt("f",ur(e.f),v)+(e.v!=null?d:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(m.cm=1),rt("c",d,m)}var ly=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,c=k0("v"),h=k0("f");return function(m,g,v,_,C,T){for(var N=0,S="",D=[],U=[],X=0,O=0,q=0,oe="",J,M,ie=0,j=0,Ee,he,te=0,be=0,$e=Array.isArray(T.CellXf),ae,tt=[],Re=[],Ut=Array.isArray(g),fe=[],ot={},pt=!1,K=!!v.sheetStubs,ce=m.split(r),ee=0,ne=ce.length;ee!=ne;++ee){S=ce[ee].trim();var le=S.length;if(le!==0){var qe=0;e:for(N=0;N<le;++N)switch(S[N]){case">":if(S[N-1]!="/"){++N;break e}if(v&&v.cellStyles){if(M=Tt(S.slice(qe,N),!0),ie=M.r!=null?parseInt(M.r,10):ie+1,j=-1,v.sheetRows&&v.sheetRows<ie)continue;ot={},pt=!1,M.ht&&(pt=!0,ot.hpt=parseFloat(M.ht),ot.hpx=Ys(ot.hpt)),M.hidden=="1"&&(pt=!0,ot.hidden=!0),M.outlineLevel!=null&&(pt=!0,ot.level=+M.outlineLevel),pt&&(fe[ie-1]=ot)}break;case"<":qe=N;break}if(qe>=N)break;if(M=Tt(S.slice(qe,N),!0),ie=M.r!=null?parseInt(M.r,10):ie+1,j=-1,!(v.sheetRows&&v.sheetRows<ie)){_.s.r>ie-1&&(_.s.r=ie-1),_.e.r<ie-1&&(_.e.r=ie-1),v&&v.cellStyles&&(ot={},pt=!1,M.ht&&(pt=!0,ot.hpt=parseFloat(M.ht),ot.hpx=Ys(ot.hpt)),M.hidden=="1"&&(pt=!0,ot.hidden=!0),M.outlineLevel!=null&&(pt=!0,ot.level=+M.outlineLevel),pt&&(fe[ie-1]=ot)),D=S.slice(N).split(e);for(var Le=0;Le!=D.length&&D[Le].trim().charAt(0)=="<";++Le);for(D=D.slice(Le),N=0;N!=D.length;++N)if(S=D[N].trim(),S.length!==0){if(U=S.match(t),X=N,O=0,q=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,U!=null&&U.length===2){for(X=0,oe=U[1],O=0;O!=oe.length&&!((q=oe.charCodeAt(O)-64)<1||q>26);++O)X=26*X+q;--X,j=X}else++j;for(O=0;O!=S.length&&S.charCodeAt(O)!==62;++O);if(++O,M=Tt(S.slice(0,O),!0),M.r||(M.r=Ct({r:ie-1,c:j})),oe=S.slice(O),J={t:""},(U=oe.match(c))!=null&&U[1]!==""&&(J.v=$t(U[1])),v.cellFormula){if((U=oe.match(h))!=null&&U[1]!==""){if(J.f=$t(mr(U[1])).replace(/\r\n/g,`
`),v.xlfn||(J.f=c1(J.f)),U[0].indexOf('t="array"')>-1)J.F=(oe.match(s)||[])[1],J.F.indexOf(":")>-1&&tt.push([er(J.F),J.F]);else if(U[0].indexOf('t="shared"')>-1){he=Tt(U[0]);var Pe=$t(mr(U[1]));v.xlfn||(Pe=c1(Pe)),Re[parseInt(he.si,10)]=[he,Pe,M.r]}}else(U=oe.match(/<f[^>]*\/>/))&&(he=Tt(U[0]),Re[he.si]&&(J.f=iv(Re[he.si][1],Re[he.si][2],M.r)));var Be=Br(M.r);for(O=0;O<tt.length;++O)Be.r>=tt[O][0].s.r&&Be.r<=tt[O][0].e.r&&Be.c>=tt[O][0].s.c&&Be.c<=tt[O][0].e.c&&(J.F=tt[O][1])}if(M.t==null&&J.v===void 0)if(J.f||J.F)J.v=0,J.t="n";else if(K)J.t="z";else continue;else J.t=M.t||"n";switch(_.s.c>j&&(_.s.c=j),_.e.c<j&&(_.e.c=j),J.t){case"n":if(J.v==""||J.v==null){if(!K)continue;J.t="z"}else J.v=parseFloat(J.v);break;case"s":if(typeof J.v>"u"){if(!K)continue;J.t="z"}else Ee=_0[parseInt(J.v,10)],J.v=Ee.t,J.r=Ee.r,v.cellHTML&&(J.h=Ee.h);break;case"str":J.t="s",J.v=J.v!=null?mr(J.v):"",v.cellHTML&&(J.h=vl(J.v));break;case"inlineStr":U=oe.match(n),J.t="s",U!=null&&(Ee=Ol(U[1]))?(J.v=Ee.t,v.cellHTML&&(J.h=Ee.h)):J.v="";break;case"b":J.v=Nr(J.v);break;case"d":v.cellDates?J.v=kr(J.v,1):(J.v=ia(kr(J.v,1)),J.t="n");break;case"e":(!v||v.cellText!==!1)&&(J.w=J.v),J.v=_h[J.v];break}if(te=be=0,ae=null,$e&&M.s!==void 0&&(ae=T.CellXf[M.s],ae!=null&&(ae.numFmtId!=null&&(te=ae.numFmtId),v.cellStyles&&ae.fillId!=null&&(be=ae.fillId))),vu(J,te,be,v,C,T),v.cellDates&&$e&&J.t=="n"&&Ks(bt[te])&&(J.t="d",J.v=sc(J.v)),M.cm&&v.xlmeta){var Te=(v.xlmeta.Cell||[])[+M.cm-1];Te&&Te.type=="XLDAPR"&&(J.D=!0)}if(Ut){var A=Br(M.r);g[A.r]||(g[A.r]=[]),g[A.r][A.c]=J}else g[M.r]=J}}}}fe.length>0&&(g["!rows"]=fe)}}();function fy(e,r,t,n){var s=[],c=[],h=er(e["!ref"]),d="",m,g="",v=[],_=0,C=0,T=e["!rows"],N=Array.isArray(e),S={r:g},D,U=-1;for(C=h.s.c;C<=h.e.c;++C)v[C]=Pr(C);for(_=h.s.r;_<=h.e.r;++_){for(c=[],g=zr(_),C=h.s.c;C<=h.e.c;++C){m=v[C]+g;var X=N?(e[_]||[])[C]:e[m];X!==void 0&&(d=cy(X,m,e,r))!=null&&c.push(d)}(c.length>0||T&&T[_])&&(S={r:g},T&&T[_]&&(D=T[_],D.hidden&&(S.hidden=1),U=-1,D.hpx?U=P0(D.hpx):D.hpt&&(U=D.hpt),U>-1&&(S.ht=U,S.customHeight=1),D.level&&(S.outlineLevel=D.level)),s[s.length]=rt("row",c.join(""),S))}if(T)for(;_<T.length;++_)T&&T[_]&&(S={r:_+1},D=T[_],D.hidden&&(S.hidden=1),U=-1,D.hpx?U=P0(D.hpx):D.hpt&&(U=D.hpt),U>-1&&(S.ht=U,S.customHeight=1),D.level&&(S.outlineLevel=D.level),s[s.length]=rt("row","",S));return s.join("")}function Eu(e,r,t,n){var s=[Yr,rt("worksheet",null,{xmlns:gs[0],"xmlns:r":na.r})],c=t.SheetNames[e],h=0,d="",m=t.Sheets[c];m==null&&(m={});var g=m["!ref"]||"A1",v=er(g);if(v.e.c>16383||v.e.r>1048575){if(r.WTF)throw new Error("Range "+g+" exceeds format limit A1:XFD1048576");v.e.c=Math.min(v.e.c,16383),v.e.r=Math.min(v.e.c,1048575),g=jt(v)}n||(n={}),m["!comments"]=[];var _=[];K3(m,t,e,r,s),s[s.length]=rt("dimension",null,{ref:g}),s[s.length]=oy(m,r,e,t),r.sheetFormat&&(s[s.length]=rt("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),m["!cols"]!=null&&m["!cols"].length>0&&(s[s.length]=ry(m,m["!cols"])),s[h=s.length]="<sheetData/>",m["!links"]=[],m["!ref"]!=null&&(d=fy(m,r),d.length>0&&(s[s.length]=d)),s.length>h+1&&(s[s.length]="</sheetData>",s[h]=s[h].replace("/>",">")),m["!protect"]&&(s[s.length]=J3(m["!protect"])),m["!autofilter"]!=null&&(s[s.length]=ny(m["!autofilter"],m,t,e)),m["!merges"]!=null&&m["!merges"].length>0&&(s[s.length]=z3(m["!merges"]));var C=-1,T,N=-1;return m["!links"].length>0&&(s[s.length]="<hyperlinks>",m["!links"].forEach(function(S){S[1].Target&&(T={ref:S[0]},S[1].Target.charAt(0)!="#"&&(N=hr(n,-1,ur(S[1].Target).replace(/#.*$/,""),zt.HLINK),T["r:id"]="rId"+N),(C=S[1].Target.indexOf("#"))>-1&&(T.location=ur(S[1].Target.slice(C+1))),S[1].Tooltip&&(T.tooltip=ur(S[1].Tooltip)),s[s.length]=rt("hyperlink",null,T))}),s[s.length]="</hyperlinks>"),delete m["!links"],m["!margins"]!=null&&(s[s.length]=ey(m["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(s[s.length]=va("ignoredErrors",rt("ignoredError",null,{numberStoredAsText:1,sqref:g}))),_.length>0&&(N=hr(n,-1,"../drawings/drawing"+(e+1)+".xml",zt.DRAW),s[s.length]=rt("drawing",null,{"r:id":"rId"+N}),m["!drawing"]=_),m["!comments"].length>0&&(N=hr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",zt.VML),s[s.length]=rt("legacyDrawing",null,{"r:id":"rId"+N}),m["!legacy"]=N),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function hy(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var c=e.read_shift(1);return e.l=n,c&7&&(t.level=c&7),c&16&&(t.hidden=!0),c&32&&(t.hpt=s/20),t}function uy(e,r,t){var n=Oe(145),s=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var c=320;s.hpx?c=P0(s.hpx)*20:s.hpt&&(c=s.hpt*20),n.write_shift(2,c),n.write_shift(1,0);var h=0;s.level&&(h|=s.level),s.hidden&&(h|=16),(s.hpx||s.hpt)&&(h|=32),n.write_shift(1,h),n.write_shift(1,0);var d=0,m=n.l;n.l+=4;for(var g={r:e,c:0},v=0;v<16;++v)if(!(r.s.c>v+1<<10||r.e.c<v<<10)){for(var _=-1,C=-1,T=v<<10;T<v+1<<10;++T){g.c=T;var N=Array.isArray(t)?(t[g.r]||[])[g.c]:t[Ct(g)];N&&(_<0&&(_=T),C=T)}_<0||(++d,n.write_shift(4,_),n.write_shift(4,C))}var S=n.l;return n.l=m,n.write_shift(4,d),n.l=S,n.length>n.l?n.slice(0,n.l):n}function dy(e,r,t,n){var s=uy(n,t,r);(s.length>17||(r["!rows"]||[])[n])&&Ve(e,0,s)}var xy=vs,gy=Js;function my(){}function py(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=yg(e),t}function wy(e,r,t){t==null&&(t=Oe(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var s=1;s<3;++s)t.write_shift(1,0);return Yo({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),ph(e,t),t.slice(0,t.l)}function vy(e){var r=_n(e);return[r]}function yy(e,r,t){return t==null&&(t=Oe(8)),ms(r,t)}function Ey(e){var r=ps(e);return[r]}function _y(e,r,t){return t==null&&(t=Oe(4)),ws(r,t)}function Ay(e){var r=_n(e),t=e.read_shift(1);return[r,t,"b"]}function by(e,r,t){return t==null&&(t=Oe(9)),ms(r,t),t.write_shift(1,e.v?1:0),t}function Sy(e){var r=ps(e),t=e.read_shift(1);return[r,t,"b"]}function Cy(e,r,t){return t==null&&(t=Oe(5)),ws(r,t),t.write_shift(1,e.v?1:0),t}function Ty(e){var r=_n(e),t=e.read_shift(1);return[r,t,"e"]}function Ny(e,r,t){return t==null&&(t=Oe(9)),ms(r,t),t.write_shift(1,e.v),t}function ky(e){var r=ps(e),t=e.read_shift(1);return[r,t,"e"]}function Iy(e,r,t){return t==null&&(t=Oe(8)),ws(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function Dy(e){var r=_n(e),t=e.read_shift(4);return[r,t,"s"]}function Fy(e,r,t){return t==null&&(t=Oe(12)),ms(r,t),t.write_shift(4,r.v),t}function Oy(e){var r=ps(e),t=e.read_shift(4);return[r,t,"s"]}function Ry(e,r,t){return t==null&&(t=Oe(8)),ws(r,t),t.write_shift(4,r.v),t}function My(e){var r=_n(e),t=ka(e);return[r,t,"n"]}function Py(e,r,t){return t==null&&(t=Oe(16)),ms(r,t),fs(e.v,t),t}function _u(e){var r=ps(e),t=ka(e);return[r,t,"n"]}function By(e,r,t){return t==null&&(t=Oe(12)),ws(r,t),fs(e.v,t),t}function Ly(e){var r=_n(e),t=Nl(e);return[r,t,"n"]}function jy(e,r,t){return t==null&&(t=Oe(12)),ms(r,t),wh(e.v,t),t}function Uy(e){var r=ps(e),t=Nl(e);return[r,t,"n"]}function Wy(e,r,t){return t==null&&(t=Oe(8)),ws(r,t),wh(e.v,t),t}function Vy(e){var r=_n(e),t=Sl(e);return[r,t,"is"]}function Hy(e){var r=_n(e),t=Ia(e);return[r,t,"str"]}function Gy(e,r,t){return t==null&&(t=Oe(12+4*e.v.length)),ms(r,t),da(e.v,t),t.length>t.l?t.slice(0,t.l):t}function Xy(e){var r=ps(e),t=Ia(e);return[r,t,"str"]}function zy(e,r,t){return t==null&&(t=Oe(8+4*e.v.length)),ws(r,t),da(e.v,t),t.length>t.l?t.slice(0,t.l):t}function Yy(e,r,t){var n=e.l+r,s=_n(e);s.r=t["!row"];var c=e.read_shift(1),h=[s,c,"b"];if(t.cellFormula){e.l+=2;var d=lc(e,n-e.l,t);h[3]=Ta(d,null,s,t.supbooks,t)}else e.l=n;return h}function Ky(e,r,t){var n=e.l+r,s=_n(e);s.r=t["!row"];var c=e.read_shift(1),h=[s,c,"e"];if(t.cellFormula){e.l+=2;var d=lc(e,n-e.l,t);h[3]=Ta(d,null,s,t.supbooks,t)}else e.l=n;return h}function qy(e,r,t){var n=e.l+r,s=_n(e);s.r=t["!row"];var c=ka(e),h=[s,c,"n"];if(t.cellFormula){e.l+=2;var d=lc(e,n-e.l,t);h[3]=Ta(d,null,s,t.supbooks,t)}else e.l=n;return h}function Zy(e,r,t){var n=e.l+r,s=_n(e);s.r=t["!row"];var c=Ia(e),h=[s,c,"str"];if(t.cellFormula){e.l+=2;var d=lc(e,n-e.l,t);h[3]=Ta(d,null,s,t.supbooks,t)}else e.l=n;return h}var Jy=vs,Qy=Js;function $y(e,r){return r==null&&(r=Oe(4)),r.write_shift(4,e),r}function e4(e,r){var t=e.l+r,n=vs(e),s=Cl(e),c=Ia(e),h=Ia(e),d=Ia(e);e.l=t;var m={rfx:n,relId:s,loc:c,display:d};return h&&(m.Tooltip=h),m}function t4(e,r){var t=Oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Js({s:Br(e[0]),e:Br(e[0])},t),Tl("rId"+r,t);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return da(s||"",t),da(e[1].Tooltip||"",t),da("",t),t.slice(0,t.l)}function r4(){}function a4(e,r,t){var n=e.l+r,s=vh(e),c=e.read_shift(1),h=[s];if(h[2]=c,t.cellFormula){var d=T3(e,n-e.l,t);h[1]=d}else e.l=n;return h}function n4(e,r,t){var n=e.l+r,s=vs(e),c=[s];if(t.cellFormula){var h=k3(e,n-e.l,t);c[1]=h,e.l=n}else e.l=n;return c}function i4(e,r,t){t==null&&(t=Oe(18));var n=fc(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var s=0;return r.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),r.level&&(s|=r.level<<8),t.write_shift(2,s),t}var Au=["left","right","top","bottom","header","footer"];function s4(e){var r={};return Au.forEach(function(t){r[t]=ka(e)}),r}function o4(e,r){return r==null&&(r=Oe(6*8)),os(e),Au.forEach(function(t){fs(e[t],r)}),r}function c4(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function l4(e,r,t){t==null&&(t=Oe(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function f4(e){var r=Oe(24);return r.write_shift(4,4),r.write_shift(4,1),Js(e,r),r}function h4(e,r){return r==null&&(r=Oe(16*4+2)),r.write_shift(2,e.password?Rl(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function u4(){}function d4(){}function x4(e,r,t,n,s,c,h){if(!e)return e;var d=r||{};n||(n={"!id":{}});var m=d.dense?[]:{},g,v={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=!1,C=!1,T,N,S,D,U,X,O,q,oe,J=[];d.biff=12,d["!row"]=0;var M=0,ie=!1,j=[],Ee={},he=d.supbooks||s.supbooks||[[]];if(he.sharedf=Ee,he.arrayf=j,he.SheetNames=s.SheetNames||s.Sheets.map(function(Ut){return Ut.name}),!d.supbooks&&(d.supbooks=he,s.Names))for(var te=0;te<s.Names.length;++te)he[0][te+1]=s.Names[te];var be=[],$e=[],ae=!1;B0[16]={n:"BrtShortReal",f:_u};var tt;if(pi(e,function(fe,ot,pt){if(!C)switch(pt){case 148:g=fe;break;case 0:T=fe,d.sheetRows&&d.sheetRows<=T.r&&(C=!0),q=zr(D=T.r),d["!row"]=T.r,(fe.hidden||fe.hpt||fe.level!=null)&&(fe.hpt&&(fe.hpx=Ys(fe.hpt)),$e[fe.r]=fe);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(N={t:fe[2]},fe[2]){case"n":N.v=fe[1];break;case"s":O=_0[fe[1]],N.v=O.t,N.r=O.r;break;case"b":N.v=!!fe[1];break;case"e":N.v=fe[1],d.cellText!==!1&&(N.w=wi[N.v]);break;case"str":N.t="s",N.v=fe[1];break;case"is":N.t="s",N.v=fe[1].t;break}if((S=h.CellXf[fe[0].iStyleRef])&&vu(N,S.numFmtId,null,d,c,h),U=fe[0].c==-1?U+1:fe[0].c,d.dense?(m[D]||(m[D]=[]),m[D][U]=N):m[Pr(U)+q]=N,d.cellFormula){for(ie=!1,M=0;M<j.length;++M){var K=j[M];T.r>=K[0].s.r&&T.r<=K[0].e.r&&U>=K[0].s.c&&U<=K[0].e.c&&(N.F=jt(K[0]),ie=!0)}!ie&&fe.length>3&&(N.f=fe[3])}if(v.s.r>T.r&&(v.s.r=T.r),v.s.c>U&&(v.s.c=U),v.e.r<T.r&&(v.e.r=T.r),v.e.c<U&&(v.e.c=U),d.cellDates&&S&&N.t=="n"&&Ks(bt[S.numFmtId])){var ce=as(N.v);ce&&(N.t="d",N.v=new Date(ce.y,ce.m-1,ce.d,ce.H,ce.M,ce.S,ce.u))}tt&&(tt.type=="XLDAPR"&&(N.D=!0),tt=void 0);break;case 1:case 12:if(!d.sheetStubs||_)break;N={t:"z",v:void 0},U=fe[0].c==-1?U+1:fe[0].c,d.dense?(m[D]||(m[D]=[]),m[D][U]=N):m[Pr(U)+q]=N,v.s.r>T.r&&(v.s.r=T.r),v.s.c>U&&(v.s.c=U),v.e.r<T.r&&(v.e.r=T.r),v.e.c<U&&(v.e.c=U),tt&&(tt.type=="XLDAPR"&&(N.D=!0),tt=void 0);break;case 176:J.push(fe);break;case 49:tt=((d.xlmeta||{}).Cell||[])[fe-1];break;case 494:var ee=n["!id"][fe.relId];for(ee?(fe.Target=ee.Target,fe.loc&&(fe.Target+="#"+fe.loc),fe.Rel=ee):fe.relId==""&&(fe.Target="#"+fe.loc),D=fe.rfx.s.r;D<=fe.rfx.e.r;++D)for(U=fe.rfx.s.c;U<=fe.rfx.e.c;++U)d.dense?(m[D]||(m[D]=[]),m[D][U]||(m[D][U]={t:"z",v:void 0}),m[D][U].l=fe):(X=Ct({c:U,r:D}),m[X]||(m[X]={t:"z",v:void 0}),m[X].l=fe);break;case 426:if(!d.cellFormula)break;j.push(fe),oe=d.dense?m[D][U]:m[Pr(U)+q],oe.f=Ta(fe[1],v,{r:T.r,c:U},he,d),oe.F=jt(fe[0]);break;case 427:if(!d.cellFormula)break;Ee[Ct(fe[0].s)]=fe[1],oe=d.dense?m[D][U]:m[Pr(U)+q],oe.f=Ta(fe[1],v,{r:T.r,c:U},he,d);break;case 60:if(!d.cellStyles)break;for(;fe.e>=fe.s;)be[fe.e--]={width:fe.w/256,hidden:!!(fe.flags&1),level:fe.level},ae||(ae=!0,Ml(fe.w/256)),Bi(be[fe.e+1]);break;case 161:m["!autofilter"]={ref:jt(fe)};break;case 476:m["!margins"]=fe;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),fe.name&&(s.Sheets[t].CodeName=fe.name),(fe.above||fe.left)&&(m["!outline"]={above:fe.above,left:fe.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),fe.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_=!0;break;case 36:_=!1;break;case 37:_=!0;break;case 38:_=!1;break;default:if(!ot.T){if(!_||d.WTF)throw new Error("Unexpected record 0x"+pt.toString(16))}}},d),delete d.supbooks,delete d["!row"],!m["!ref"]&&(v.s.r<2e6||g&&(g.e.r>0||g.e.c>0||g.s.r>0||g.s.c>0))&&(m["!ref"]=jt(g||v)),d.sheetRows&&m["!ref"]){var Re=er(m["!ref"]);d.sheetRows<=+Re.e.r&&(Re.e.r=d.sheetRows-1,Re.e.r>v.e.r&&(Re.e.r=v.e.r),Re.e.r<Re.s.r&&(Re.s.r=Re.e.r),Re.e.c>v.e.c&&(Re.e.c=v.e.c),Re.e.c<Re.s.c&&(Re.s.c=Re.e.c),m["!fullref"]=m["!ref"],m["!ref"]=jt(Re))}return J.length>0&&(m["!merges"]=J),be.length>0&&(m["!cols"]=be),$e.length>0&&(m["!rows"]=$e),m}function g4(e,r,t,n,s,c,h){if(r.v===void 0)return!1;var d="";switch(r.t){case"b":d=r.v?"1":"0";break;case"d":r=Ir(r),r.z=r.z||bt[14],r.v=ia(kr(r.v)),r.t="n";break;case"n":case"e":d=""+r.v;break;default:d=r.v;break}var m={r:t,c:n};switch(m.s=Vi(s.cellXfs,r,s),r.l&&c["!links"].push([Ct(m),r.l]),r.c&&c["!comments"].push([Ct(m),r.c]),r.t){case"s":case"str":return s.bookSST?(d=Ul(s.Strings,r.v,s.revStrings),m.t="s",m.v=d,h?Ve(e,18,Ry(r,m)):Ve(e,7,Fy(r,m))):(m.t="str",h?Ve(e,17,zy(r,m)):Ve(e,6,Gy(r,m))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?h?Ve(e,13,Wy(r,m)):Ve(e,2,jy(r,m)):h?Ve(e,16,By(r,m)):Ve(e,5,Py(r,m)),!0;case"b":return m.t="b",h?Ve(e,15,Cy(r,m)):Ve(e,4,by(r,m)),!0;case"e":return m.t="e",h?Ve(e,14,Iy(r,m)):Ve(e,3,Ny(r,m)),!0}return h?Ve(e,12,_y(r,m)):Ve(e,1,yy(r,m)),!0}function m4(e,r,t,n){var s=er(r["!ref"]||"A1"),c,h="",d=[];Ve(e,145);var m=Array.isArray(r),g=s.e.r;r["!rows"]&&(g=Math.max(s.e.r,r["!rows"].length-1));for(var v=s.s.r;v<=g;++v){h=zr(v),dy(e,r,s,v);var _=!1;if(v<=s.e.r)for(var C=s.s.c;C<=s.e.c;++C){v===s.s.r&&(d[C]=Pr(C)),c=d[C]+h;var T=m?(r[v]||[])[C]:r[c];if(!T){_=!1;continue}_=g4(e,T,v,C,n,r,_)}}Ve(e,146)}function p4(e,r){!r||!r["!merges"]||(Ve(e,177,$y(r["!merges"].length)),r["!merges"].forEach(function(t){Ve(e,176,Qy(t))}),Ve(e,178))}function w4(e,r){!r||!r["!cols"]||(Ve(e,390),r["!cols"].forEach(function(t,n){t&&Ve(e,60,i4(n,t))}),Ve(e,391))}function v4(e,r){!r||!r["!ref"]||(Ve(e,648),Ve(e,649,f4(er(r["!ref"]))),Ve(e,650))}function y4(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var s=hr(t,-1,n[1].Target.replace(/#.*$/,""),zt.HLINK);Ve(e,494,t4(n,s))}}),delete r["!links"]}function E4(e,r,t,n){if(r["!comments"].length>0){var s=hr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",zt.VML);Ve(e,551,Tl("rId"+s)),r["!legacy"]=s}}function _4(e,r,t,n){if(r["!autofilter"]){var s=r["!autofilter"],c=typeof s.ref=="string"?s.ref:jt(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var h=t.Workbook.Names,d=za(c);d.s.r==d.e.r&&(d.e.r=za(r["!ref"]).e.r,c=jt(d));for(var m=0;m<h.length;++m){var g=h[m];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==n){g.Ref="'"+t.SheetNames[n]+"'!"+c;break}}m==h.length&&h.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+c}),Ve(e,161,Js(er(c))),Ve(e,162)}}function A4(e,r,t){Ve(e,133),Ve(e,137,l4(r,t)),Ve(e,138),Ve(e,134)}function b4(e,r){r["!protect"]&&Ve(e,535,h4(r["!protect"]))}function S4(e,r,t,n){var s=Xa(),c=t.SheetNames[e],h=t.Sheets[c]||{},d=c;try{t&&t.Workbook&&(d=t.Workbook.Sheets[e].CodeName||d)}catch{}var m=er(h["!ref"]||"A1");if(m.e.c>16383||m.e.r>1048575){if(r.WTF)throw new Error("Range "+(h["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575)}return h["!links"]=[],h["!comments"]=[],Ve(s,129),(t.vbaraw||h["!outline"])&&Ve(s,147,wy(d,h["!outline"])),Ve(s,148,gy(m)),A4(s,h,t.Workbook),w4(s,h),m4(s,h,e,r),b4(s,h),_4(s,h,t,e),p4(s,h),y4(s,h,n),h["!margins"]&&Ve(s,476,o4(h["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&v4(s,h),E4(s,h,e,n),Ve(s,130),s.end()}function C4(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(c){var h=c.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);h&&(r[+h[1]]=t?+h[2]:h[2])});var s=$t((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(c){n=c.replace(/<.*?>/g,"")}),[r,s,n]}function T4(e,r,t,n,s,c){var h=c||{"!type":"chart"};if(!e)return c;var d=0,m=0,g="A",v={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(_){var C=C4(_);v.s.r=v.s.c=0,v.e.c=d,g=Pr(d),C[0].forEach(function(T,N){h[g+zr(N)]={t:"n",v:T,z:C[1]},m=N}),v.e.r<m&&(v.e.r=m),++d}),d>0&&(h["!ref"]=jt(v)),h}function N4(e,r,t,n,s){if(!e)return e;n||(n={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},h,d=e.match(yu);return d&&Wl(d[0],c,s,t),(h=e.match(/drawing r:id="(.*?)"/))&&(c["!rel"]=h[1]),n["!id"][c["!rel"]]&&(c["!drawel"]=n["!id"][c["!rel"]]),c}function k4(e,r){e.l+=10;var t=Ia(e);return{name:t}}function I4(e,r,t,n,s){if(!e)return e;n||(n={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},h=!1;return pi(e,function(m,g,v){switch(v){case 550:c["!rel"]=m;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),m.name&&(s.Sheets[t].CodeName=m.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:h=!0;break;case 36:h=!1;break;case 37:break;case 38:break;default:if(!(g.T>0)){if(!(g.T<0)){if(!h||r.WTF)throw new Error("Unexpected record 0x"+v.toString(16))}}}},r),n["!id"][c["!rel"]]&&(c["!drawel"]=n["!id"][c["!rel"]]),c}var Vl=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],D4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],F4=[],O4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function d1(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],s=0;s!=r.length;++s){var c=r[s];if(n[c[0]]==null)n[c[0]]=c[1];else switch(c[2]){case"bool":typeof n[c[0]]=="string"&&(n[c[0]]=Nr(n[c[0]]));break;case"int":typeof n[c[0]]=="string"&&(n[c[0]]=parseInt(n[c[0]],10));break}}}function x1(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Nr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function bu(e){x1(e.WBProps,Vl),x1(e.CalcPr,O4),d1(e.WBView,D4),d1(e.Sheets,F4),Gs.date1904=Nr(e.WBProps.date1904)}function R4(e){return!e.Workbook||!e.Workbook.WBProps?"false":Nr(e.Workbook.WBProps.date1904)?"true":"false"}var M4="][*?/\\".split("");function Su(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return M4.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function P4(e,r,t){e.forEach(function(n,s){Su(n);for(var c=0;c<s;++c)if(n==e[c])throw new Error("Duplicate Sheet Name: "+n);if(t){var h=r&&r[s]&&r[s].CodeName||n;if(h.charCodeAt(0)==95&&h.length>22)throw new Error("Bad Code Name: Worksheet"+h)}})}function B4(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];P4(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)R3(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var L4=/<\w+:workbook/;function j4(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",c={},h=0;if(e.replace(Fa,function(m,g){var v=Tt(m);switch(Jn(v[0])){case"<?xml":break;case"<workbook":m.match(L4)&&(s="xmlns"+m.match(/<(\w+):/)[1]),t.xmlns=v[s];break;case"</workbook>":break;case"<fileVersion":delete v[0],t.AppVersion=v;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Vl.forEach(function(_){if(v[_[0]]!=null)switch(_[2]){case"bool":t.WBProps[_[0]]=Nr(v[_[0]]);break;case"int":t.WBProps[_[0]]=parseInt(v[_[0]],10);break;default:t.WBProps[_[0]]=v[_[0]]}}),v.codeName&&(t.WBProps.CodeName=mr(v.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete v[0],t.WBView.push(v);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(v.state){case"hidden":v.Hidden=1;break;case"veryHidden":v.Hidden=2;break;default:v.Hidden=0}delete v.state,v.name=$t(mr(v.name)),delete v[0],t.Sheets.push(v);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":c={},c.Name=mr(v.name),v.comment&&(c.Comment=v.comment),v.localSheetId&&(c.Sheet=+v.localSheetId),Nr(v.hidden||"0")&&(c.Hidden=!0),h=g+m.length;break;case"</definedName>":c.Ref=$t(mr(e.slice(h,g))),t.Names.push(c);break;case"<definedName/>":break;case"<calcPr":delete v[0],t.CalcPr=v;break;case"<calcPr/>":delete v[0],t.CalcPr=v;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+v[0]+" in workbook")}return m}),gs.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return bu(t),t}function Cu(e){var r=[Yr];r[r.length]=rt("workbook",null,{xmlns:gs[0],"xmlns:r":na.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Vl.forEach(function(d){e.Workbook.WBProps[d[0]]!=null&&e.Workbook.WBProps[d[0]]!=d[1]&&(n[d[0]]=e.Workbook.WBProps[d[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=rt("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],c=0;if(s&&s[0]&&s[0].Hidden){for(r[r.length]="<bookViews>",c=0;c!=e.SheetNames.length&&!(!s[c]||!s[c].Hidden);++c);c==e.SheetNames.length&&(c=0),r[r.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",c=0;c!=e.SheetNames.length;++c){var h={name:ur(e.SheetNames[c].slice(0,31))};if(h.sheetId=""+(c+1),h["r:id"]="rId"+(c+1),s[c])switch(s[c].Hidden){case 1:h.state="hidden";break;case 2:h.state="veryHidden";break}r[r.length]=rt("sheet",null,h)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(d){var m={name:d.Name};d.Comment&&(m.comment=d.Comment),d.Sheet!=null&&(m.localSheetId=""+d.Sheet),d.Hidden&&(m.hidden="1"),d.Ref&&(r[r.length]=rt("definedName",ur(d.Ref),m))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function U4(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Zc(e),t.name=Ia(e),t}function W4(e,r){return r||(r=Oe(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),Tl(e.strRelID,r),da(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function V4(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=r>8?Ia(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function H4(e,r){r||(r=Oe(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),ph(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function G4(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function X4(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var s=e.read_shift(4),c=Eg(e),h=N3(e,0,t),d=Cl(e);e.l=n;var m={Name:c,Ptg:h};return s<268435455&&(m.Sheet=s),d&&(m.Comment=d),m}function z4(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;r||(r={}),r.biff=12;var c=[],h=[[]];return h.SheetNames=[],h.XTI=[],B0[16]={n:"BrtFRTArchID$",f:G4},pi(e,function(m,g,v){switch(v){case 156:h.SheetNames.push(m.name),t.Sheets.push(m);break;case 153:t.WBProps=m;break;case 39:m.Sheet!=null&&(r.SID=m.Sheet),m.Ref=Ta(m.Ptg,null,null,h,r),delete r.SID,delete m.Ptg,c.push(m);break;case 1036:break;case 357:case 358:case 355:case 667:h[0].length?h.push([v,m]):h[0]=[v,m],h[h.length-1].XTI=[];break;case 362:h.length===0&&(h[0]=[],h[0].XTI=[]),h[h.length-1].XTI=h[h.length-1].XTI.concat(m),h.XTI=h.XTI.concat(m);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(v),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(v),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!g.T){if(!s||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+v.toString(16))}}},r),bu(t),t.Names=c,t.supbooks=h,t}function Y4(e,r){Ve(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,s={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};Ve(e,156,W4(s))}Ve(e,144)}function K4(e,r){r||(r=Oe(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return da("SheetJS",r),da(Uo.version,r),da(Uo.version,r),da("7262",r),r.length>r.l?r.slice(0,r.l):r}function q4(e,r){r||(r=Oe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function Z4(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,s=-1,c=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&s==-1?s=n:t[n].Hidden==1&&c==-1&&(c=n);c>s||(Ve(e,135),Ve(e,158,q4(s)),Ve(e,136))}}function J4(e,r){var t=Xa();return Ve(t,131),Ve(t,128,K4()),Ve(t,153,H4(e.Workbook&&e.Workbook.WBProps||null)),Z4(t,e),Y4(t,e),Ve(t,132),t.end()}function Q4(e,r,t){return r.slice(-4)===".bin"?z4(e,t):j4(e,t)}function $4(e,r,t,n,s,c,h,d){return r.slice(-4)===".bin"?x4(e,n,t,s,c,h,d):X3(e,n,t,s,c,h,d)}function eE(e,r,t,n,s,c,h,d){return r.slice(-4)===".bin"?I4(e,n,t,s,c):N4(e,n,t,s,c)}function tE(e,r,t,n,s,c,h,d){return r.slice(-4)===".bin"?av():nv()}function rE(e,r,t,n,s,c,h,d){return r.slice(-4)===".bin"?tv():rv()}function aE(e,r,t,n){return r.slice(-4)===".bin"?Qp(e,t,n):Up(e,t,n)}function nE(e,r,t){return su(e,t)}function iE(e,r,t){return r.slice(-4)===".bin"?ip(e,t):rp(e,t)}function sE(e,r,t){return r.slice(-4)===".bin"?Zw(e,t):Ww(e,t)}function oE(e,r,t){return r.slice(-4)===".bin"?Lw(e):Pw(e)}function cE(e,r,t,n){return t.slice(-4)===".bin"?jw(e,r,t,n):void 0}function lE(e,r,t){return r.slice(-4)===".bin"?Ow(e,r,t):Mw(e,r,t)}function fE(e,r,t){return(r.slice(-4)===".bin"?J4:Cu)(e)}function hE(e,r,t,n,s){return(r.slice(-4)===".bin"?S4:Eu)(e,t,n,s)}function uE(e,r,t){return(r.slice(-4)===".bin"?cw:nu)(e,t)}function dE(e,r,t){return(r.slice(-4)===".bin"?cp:Zh)(e,t)}function xE(e,r,t){return(r.slice(-4)===".bin"?Jw:lu)(e)}function gE(e){return(e.slice(-4)===".bin"?Rw:ou)()}var Tu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Nu=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function In(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var s=e.match(Tu),c,h,d,m;if(s)for(m=0;m!=s.length;++m)c=s[m].match(Nu),(h=c[1].indexOf(":"))===-1?n[c[1]]=c[2].slice(1,c[2].length-1):(c[1].slice(0,6)==="xmlns:"?d="xmlns"+c[1].slice(6):d=c[1].slice(h+1),n[d]=c[2].slice(1,c[2].length-1));return n}function mE(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(Tu),s,c,h,d;if(n)for(d=0;d!=n.length;++d)s=n[d].match(Nu),(c=s[1].indexOf(":"))===-1?t[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?h="xmlns"+s[1].slice(6):h=s[1].slice(c+1),t[h]=s[2].slice(1,s[2].length-1));return t}var b0;function pE(e,r){var t=b0[e]||$t(e);return t==="General"?cs(r):En(t,r)}function wE(e,r,t,n){var s=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Nr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=kr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[$t(r)]=s}function vE(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||wi[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=N0(e.v):e.w=cs(e.v):e.w=pE(r||"General",e.v)}catch(c){if(t.WTF)throw c}try{var n=b0[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&Ks(n)){var s=as(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(c){if(t.WTF)throw c}}}function yE(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=Fp[n.Pattern]||n.Pattern)}e[r.ID]=r}function EE(e,r,t,n,s,c,h,d,m,g){var v="General",_=n.StyleID,C={};g=g||{};var T=[],N=0;for(_===void 0&&d&&(_=d.StyleID),_===void 0&&h&&(_=h.StyleID);c[_]!==void 0&&(c[_].nf&&(v=c[_].nf),c[_].Interior&&T.push(c[_].Interior),!!c[_].Parent);)_=c[_].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Nr(e);break;case"String":n.t="s",n.r=Df($t(e)),n.v=e.indexOf("<")>-1?$t(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(kr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=$t(e):n.v<60&&(n.v=n.v-1),(!v||v=="General")&&(v="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=_h[e],g.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=Df(r||e));break}if(vE(n,v,g),g.cellFormula!==!1)if(n.Formula){var S=$t(n.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),n.f=Hs(S,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Hs("RC:RC",s):n.ArrayRange&&(n.F=Hs(n.ArrayRange,s),m.push([er(n.F),n.F]))}else for(N=0;N<m.length;++N)s.r>=m[N][0].s.r&&s.r<=m[N][0].e.r&&s.c>=m[N][0].s.c&&s.c<=m[N][0].e.c&&(n.F=m[N][1]);g.cellStyles&&(T.forEach(function(D){!C.patternType&&D.patternType&&(C.patternType=D.patternType)}),n.s=C),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function _E(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Gc(e,r){var t=r||{};qs();var n=g0(yl(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=mr(n));var s=n.slice(0,1024).toLowerCase(),c=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var h=Ir(t);return h.type="string",zs.to_workbook(n,h)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ft){s.indexOf("<"+ft)>=0&&(c=!0)}),c)return o_(n,t);b0={"General Number":"General","General Date":bt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":bt[15],"Short Date":bt[14],"Long Time":bt[19],"Medium Time":bt[18],"Short Time":bt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:bt[2],Standard:bt[4],Percent:bt[10],Scientific:bt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,m=[],g,v={},_=[],C=t.dense?[]:{},T="",N={},S={},D=In('<Data ss:Type="String">'),U=0,X=0,O=0,q={s:{r:2e6,c:2e6},e:{r:0,c:0}},oe={},J={},M="",ie=0,j=[],Ee={},he={},te=0,be=[],$e=[],ae={},tt=[],Re,Ut=!1,fe=[],ot=[],pt={},K=0,ce=0,ee={Sheets:[],WBProps:{date1904:!1}},ne={};D0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";d=D0.exec(n);)switch(d[3]=(le=d[3]).toLowerCase()){case"data":if(le=="data"){if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break}if(m[m.length-1][1])break;d[1]==="/"?EE(n.slice(U,d.index),M,D,m[m.length-1][0]=="comment"?ae:N,{c:X,r:O},oe,tt[X],S,fe,t):(M="",D=In(d[0]),U=d.index+d[0].length);break;case"cell":if(d[1]==="/")if($e.length>0&&(N.c=$e),(!t.sheetRows||t.sheetRows>O)&&N.v!==void 0&&(t.dense?(C[O]||(C[O]=[]),C[O][X]=N):C[Pr(X)+zr(O)]=N),N.HRef&&(N.l={Target:$t(N.HRef)},N.HRefScreenTip&&(N.l.Tooltip=N.HRefScreenTip),delete N.HRef,delete N.HRefScreenTip),(N.MergeAcross||N.MergeDown)&&(K=X+(parseInt(N.MergeAcross,10)|0),ce=O+(parseInt(N.MergeDown,10)|0),j.push({s:{c:X,r:O},e:{c:K,r:ce}})),!t.sheetStubs)N.MergeAcross?X=K+1:++X;else if(N.MergeAcross||N.MergeDown){for(var qe=X;qe<=K;++qe)for(var Le=O;Le<=ce;++Le)(qe>X||Le>O)&&(t.dense?(C[Le]||(C[Le]=[]),C[Le][qe]={t:"z"}):C[Pr(qe)+zr(Le)]={t:"z"});X=K+1}else++X;else N=mE(d[0]),N.Index&&(X=+N.Index-1),X<q.s.c&&(q.s.c=X),X>q.e.c&&(q.e.c=X),d[0].slice(-2)==="/>"&&++X,$e=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(O<q.s.r&&(q.s.r=O),O>q.e.r&&(q.e.r=O),d[0].slice(-2)==="/>"&&(S=In(d[0]),S.Index&&(O=+S.Index-1)),X=0,++O):(S=In(d[0]),S.Index&&(O=+S.Index-1),pt={},(S.AutoFitHeight=="0"||S.Height)&&(pt.hpx=parseInt(S.Height,10),pt.hpt=P0(pt.hpx),ot[O]=pt),S.Hidden=="1"&&(pt.hidden=!0,ot[O]=pt));break;case"worksheet":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"));_.push(T),q.s.r<=q.e.r&&q.s.c<=q.e.c&&(C["!ref"]=jt(q),t.sheetRows&&t.sheetRows<=q.e.r&&(C["!fullref"]=C["!ref"],q.e.r=t.sheetRows-1,C["!ref"]=jt(q))),j.length&&(C["!merges"]=j),tt.length>0&&(C["!cols"]=tt),ot.length>0&&(C["!rows"]=ot),v[T]=C}else q={s:{r:2e6,c:2e6},e:{r:0,c:0}},O=X=0,m.push([d[3],!1]),g=In(d[0]),T=$t(g.Name),C=t.dense?[]:{},j=[],fe=[],ot=[],ne={name:T,Hidden:0},ee.Sheets.push(ne);break;case"table":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else{if(d[0].slice(-2)=="/>")break;m.push([d[3],!1]),tt=[],Ut=!1}break;case"style":d[1]==="/"?yE(oe,J,t):J=In(d[0]);break;case"numberformat":J.nf=$t(In(d[0]).Format||"General"),b0[J.nf]&&(J.nf=b0[J.nf]);for(var Pe=0;Pe!=392&&bt[Pe]!=J.nf;++Pe);if(Pe==392){for(Pe=57;Pe!=392;++Pe)if(bt[Pe]==null){di(J.nf,Pe);break}}break;case"column":if(m[m.length-1][0]!=="table")break;if(Re=In(d[0]),Re.Hidden&&(Re.hidden=!0,delete Re.Hidden),Re.Width&&(Re.wpx=parseInt(Re.Width,10)),!Ut&&Re.wpx>10){Ut=!0,Na=ru;for(var Be=0;Be<tt.length;++Be)tt[Be]&&Bi(tt[Be])}Ut&&Bi(Re),tt[Re.Index-1||tt.length]=Re;for(var Te=0;Te<+Re.Span;++Te)tt[tt.length]=Ir(Re);break;case"namedrange":if(d[1]==="/")break;ee.Names||(ee.Names=[]);var A=Tt(d[0]),Y={Name:A.Name,Ref:Hs(A.RefersTo.slice(1),{r:0,c:0})};ee.Sheets.length>0&&(Y.Sheet=ee.Sheets.length-1),ee.Names.push(Y);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?M+=n.slice(ie,d.index):ie=d.index+d[0].length;break;case"interior":if(!t.cellStyles)break;J.Interior=In(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?zg(Ee,le,n.slice(te,d.index)):te=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else m.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"));_E(ae),$e.push(ae)}else m.push([d[3],!1]),g=In(d[0]),ae={a:g.Author};break;case"autofilter":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var ht=In(d[0]);C["!autofilter"]={ref:Hs(ht.Range).replace(/\$/g,"")},m.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"null":break;default:if(m.length==0&&d[3]=="document"||m.length==0&&d[3]=="uof")return v1(n,t);var lt=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:lt=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:lt=!1}break;case"excelworkbook":switch(d[3]){case"date1904":ee.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:lt=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:lt=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(n.slice(te,d.index)){case"SheetHidden":ne.Hidden=1;break;case"SheetVeryHidden":ne.Hidden=2;break}else te=d.index+d[0].length;break;case"header":C["!margins"]||os(C["!margins"]={},"xlml"),isNaN(+Tt(d[0]).Margin)||(C["!margins"].header=+Tt(d[0]).Margin);break;case"footer":C["!margins"]||os(C["!margins"]={},"xlml"),isNaN(+Tt(d[0]).Margin)||(C["!margins"].footer=+Tt(d[0]).Margin);break;case"pagemargins":var ze=Tt(d[0]);C["!margins"]||os(C["!margins"]={},"xlml"),isNaN(+ze.Top)||(C["!margins"].top=+ze.Top),isNaN(+ze.Left)||(C["!margins"].left=+ze.Left),isNaN(+ze.Right)||(C["!margins"].right=+ze.Right),isNaN(+ze.Bottom)||(C["!margins"].bottom=+ze.Bottom);break;case"displayrighttoleft":ee.Views||(ee.Views=[]),ee.Views[0]||(ee.Views[0]={}),ee.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":C["!outline"]||(C["!outline"]={}),C["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":C["!outline"]||(C["!outline"]={}),C["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:lt=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:lt=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:lt=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:lt=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:lt=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:lt=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:lt=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:lt=!1}break;case"smarttags":break;default:lt=!1;break}if(lt||d[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+m.join("|");if(m[m.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?wE(he,le,be,n.slice(te,d.index)):(be=d,te=d.index+d[0].length);break}if(t.WTF)throw"Unrecognized tag: "+d[3]+"|"+m.join("|")}var Me={};return!t.bookSheets&&!t.bookProps&&(Me.Sheets=v),Me.SheetNames=_,Me.Workbook=ee,Me.SSF=Ir(bt),Me.Props=Ee,Me.Custprops=he,Me}function al(e,r){switch(Gl(r=r||{}),r.type||"base64"){case"base64":return Gc(cn(e),r);case"binary":case"buffer":case"file":return Gc(e,r);case"array":return Gc(Ui(e),r)}}function AE(e,r){var t=[];return e.Props&&t.push(Yg(e.Props,r)),e.Custprops&&t.push(Kg(e.Props,e.Custprops)),t.join("")}function bE(){return""}function SE(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,s){var c=[];c.push(rt("NumberFormat",null,{"ss:Format":ur(bt[n.numFmtId])}));var h={"ss:ID":"s"+(21+s)};t.push(rt("Style",c.join(""),h))}),rt("Styles",t.join(""))}function ku(e){return rt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Ll(e.Ref,{r:0,c:0})})}function CE(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var s=r[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(ku(s)))}return rt("Names",t.join(""))}function TE(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,c=[],h=0;h<s.length;++h){var d=s[h];d.Sheet==t&&(d.Name.match(/^_xlfn\./)||c.push(ku(d)))}return c.join("")}function NE(e,r,t,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(rt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(rt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(rt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)s.push(rt("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<t&&!(n.Workbook.Sheets[c]&&!n.Workbook.Sheets[c].Hidden);++c);c==t&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(va("ProtectContents","True")),e["!protect"].objects&&s.push(va("ProtectObjects","True")),e["!protect"].scenarios&&s.push(va("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(va("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(va("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(h){e["!protect"][h[0]]&&s.push("<"+h[1]+"/>")})),s.length==0?"":rt("WorksheetOptions",s.join(""),{xmlns:an.x})}function kE(e){return e.map(function(r){var t=Zx(r.t||""),n=rt("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return rt("Comment",n,{"ss:Author":r.a})}).join("")}function IE(e,r,t,n,s,c,h){if(!e||e.v==null&&e.f==null)return"";var d={};if(e.f&&(d["ss:Formula"]="="+ur(Ll(e.f,h))),e.F&&e.F.slice(0,r.length)==r){var m=Br(e.F.slice(r.length+1));d["ss:ArrayRange"]="RC:R"+(m.r==h.r?"":"["+(m.r-h.r)+"]")+"C"+(m.c==h.c?"":"["+(m.c-h.c)+"]")}if(e.l&&e.l.Target&&(d["ss:HRef"]=ur(e.l.Target),e.l.Tooltip&&(d["x:HRefScreenTip"]=ur(e.l.Tooltip))),t["!merges"])for(var g=t["!merges"],v=0;v!=g.length;++v)g[v].s.c!=h.c||g[v].s.r!=h.r||(g[v].e.c>g[v].s.c&&(d["ss:MergeAcross"]=g[v].e.c-g[v].s.c),g[v].e.r>g[v].s.r&&(d["ss:MergeDown"]=g[v].e.r-g[v].s.r));var _="",C="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":_="Number",C=String(e.v);break;case"b":_="Boolean",C=e.v?"1":"0";break;case"e":_="Error",C=wi[e.v];break;case"d":_="DateTime",C=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||bt[14]);break;case"s":_="String",C=qx(e.v||"");break}var T=Vi(n.cellXfs,e,n);d["ss:StyleID"]="s"+(21+T),d["ss:Index"]=h.c+1;var N=e.v!=null?C:"",S=e.t=="z"?"":'<Data ss:Type="'+_+'">'+N+"</Data>";return(e.c||[]).length>0&&(S+=kE(e.c)),rt("Cell",S,d)}function DE(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Ys(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function FE(e,r,t,n){if(!e["!ref"])return"";var s=er(e["!ref"]),c=e["!merges"]||[],h=0,d=[];e["!cols"]&&e["!cols"].forEach(function(D,U){Bi(D);var X=!!D.width,O=fc(U,D),q={"ss:Index":U+1};X&&(q["ss:Width"]=R0(O.width)),D.hidden&&(q["ss:Hidden"]="1"),d.push(rt("Column",null,q))});for(var m=Array.isArray(e),g=s.s.r;g<=s.e.r;++g){for(var v=[DE(g,(e["!rows"]||[])[g])],_=s.s.c;_<=s.e.c;++_){var C=!1;for(h=0;h!=c.length;++h)if(!(c[h].s.c>_)&&!(c[h].s.r>g)&&!(c[h].e.c<_)&&!(c[h].e.r<g)){(c[h].s.c!=_||c[h].s.r!=g)&&(C=!0);break}if(!C){var T={r:g,c:_},N=Ct(T),S=m?(e[g]||[])[_]:e[N];v.push(IE(S,N,e,r,t,n,T))}}v.push("</Row>"),v.length>2&&d.push(v.join(""))}return d.join("")}function OE(e,r,t){var n=[],s=t.SheetNames[e],c=t.Sheets[s],h=c?TE(c,r,e,t):"";return h.length>0&&n.push("<Names>"+h+"</Names>"),h=c?FE(c,r,e,t):"",h.length>0&&n.push("<Table>"+h+"</Table>"),n.push(NE(c,r,e,t)),n.join("")}function RE(e,r){r||(r={}),e.SSF||(e.SSF=Ir(bt)),e.SSF&&(qs(),ac(e.SSF),r.revssf=ic(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],Vi(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(AE(e,r)),t.push(bE()),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push(rt("Worksheet",OE(n,r,e),{"ss:Name":ur(e.SheetNames[n])}));return t[2]=SE(e,r),t[3]=CE(e),Yr+rt("Workbook",t.join(""),{xmlns:an.ss,"xmlns:o":an.o,"xmlns:x":an.x,"xmlns:ss":an.ss,"xmlns:dt":an.dt,"xmlns:html":an.html})}function ME(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=Cg(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=Tg(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var PE=[60,1084,2066,2165,2175];function BE(e,r,t,n,s){var c=n,h=[],d=t.slice(t.l,t.l+c);if(s&&s.enc&&s.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(d)}h.push(d),t.l+=c;for(var m=hi(t,t.l),g=nl[m],v=0;g!=null&&PE.indexOf(m)>-1;)c=hi(t,t.l+2),v=t.l+4,m==2066?v+=4:(m==2165||m==2175)&&(v+=12),d=t.slice(v,t.l+4+c),h.push(d),t.l+=4+c,g=nl[m=hi(t,t.l)];var _=ua(h);wa(_,0);var C=0;_.lens=[];for(var T=0;T<h.length;++T)_.lens.push(C),C+=h[T].length;if(_.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+_.length+" < "+n;return r.f(_,_.length,s)}function Yn(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=bt[n])}catch(c){if(r.WTF)throw c}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||wi[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=N0(e.v):e.w=cs(e.v):e.w=En(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(c){if(r.WTF)throw c}if(r.cellDates&&n&&e.t=="n"&&Ks(bt[n]||String(n))){var s=as(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Mo(e,r,t){return{v:e,ixfe:r,t}}function LE(e,r){var t={opts:{}},n={},s=r.dense?[]:{},c={},h={},d=null,m=[],g="",v={},_,C="",T,N,S,D,U={},X=[],O,q,oe=[],J=[],M={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ie={},j=function(St){return St<8?ns[St]:St<64&&J[St-8]||ns[St]},Ee=function(St,cr,sa){var Mt=cr.XF.data;if(!(!Mt||!Mt.patternType||!sa||!sa.cellStyles)){cr.s={},cr.s.patternType=Mt.patternType;var Qe;(Qe=O0(j(Mt.icvFore)))&&(cr.s.fgColor={rgb:Qe}),(Qe=O0(j(Mt.icvBack)))&&(cr.s.bgColor={rgb:Qe})}},he=function(St,cr,sa){if(!(pt>1)&&!(sa.sheetRows&&St.r>=sa.sheetRows)){if(sa.cellStyles&&cr.XF&&cr.XF.data&&Ee(St,cr,sa),delete cr.ixfe,delete cr.XF,_=St,C=Ct(St),(!h||!h.s||!h.e)&&(h={s:{r:0,c:0},e:{r:0,c:0}}),St.r<h.s.r&&(h.s.r=St.r),St.c<h.s.c&&(h.s.c=St.c),St.r+1>h.e.r&&(h.e.r=St.r+1),St.c+1>h.e.c&&(h.e.c=St.c+1),sa.cellFormula&&cr.f){for(var Mt=0;Mt<X.length;++Mt)if(!(X[Mt][0].s.c>St.c||X[Mt][0].s.r>St.r)&&!(X[Mt][0].e.c<St.c||X[Mt][0].e.r<St.r)){cr.F=jt(X[Mt][0]),(X[Mt][0].s.c!=St.c||X[Mt][0].s.r!=St.r)&&delete cr.f,cr.f&&(cr.f=""+Ta(X[Mt][1],h,St,fe,te));break}}sa.dense?(s[St.r]||(s[St.r]=[]),s[St.r][St.c]=cr):s[C]=cr}},te={enc:!1,sbcch:0,snames:[],sharedf:U,arrayf:X,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(te.password=r.password);var be,$e=[],ae=[],tt=[],Re=[],Ut=!1,fe=[];fe.SheetNames=te.snames,fe.sharedf=te.sharedf,fe.arrayf=te.arrayf,fe.names=[],fe.XTI=[];var ot=0,pt=0,K=0,ce=[],ee=[],ne;te.codepage=1200,Dn(1200);for(var le=!1;e.l<e.length-1;){var qe=e.l,Le=e.read_shift(2);if(Le===0&&ot===10)break;var Pe=e.l===e.length?0:e.read_shift(2),Be=nl[Le];if(Be&&Be.f){if(r.bookSheets&&ot===133&&Le!==133)break;if(ot=Le,Be.r===2||Be.r==12){var Te=e.read_shift(2);if(Pe-=2,!te.enc&&Te!==Le&&((Te&255)<<8|Te>>8)!==Le)throw new Error("rt mismatch: "+Te+"!="+Le);Be.r==12&&(e.l+=10,Pe-=10)}var A={};if(Le===10?A=Be.f(e,Pe,te):A=BE(Le,Be,e,Pe,te),pt==0&&[9,521,1033,2057].indexOf(ot)===-1)continue;switch(Le){case 34:t.opts.Date1904=M.WBProps.date1904=A;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(te.enc||(e.l=0),te.enc=A,!r.password)throw new Error("File is password-protected");if(A.valid==null)throw new Error("Encryption scheme unsupported");if(!A.valid)throw new Error("Password is incorrect");break;case 92:te.lastuser=A;break;case 66:var Y=Number(A);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252;break}Dn(te.codepage=Y),le=!0;break;case 317:te.rrtabid=A;break;case 25:te.winlocked=A;break;case 439:t.opts.RefreshAll=A;break;case 12:t.opts.CalcCount=A;break;case 16:t.opts.CalcDelta=A;break;case 17:t.opts.CalcIter=A;break;case 13:t.opts.CalcMode=A;break;case 14:t.opts.CalcPrecision=A;break;case 95:t.opts.CalcSaveRecalc=A;break;case 15:te.CalcRefMode=A;break;case 2211:t.opts.FullCalc=A;break;case 129:A.fDialog&&(s["!type"]="dialog"),A.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),A.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:oe.push(A);break;case 430:fe.push([A]),fe[fe.length-1].XTI=[];break;case 35:case 547:fe[fe.length-1].push(A);break;case 24:case 536:ne={Name:A.Name,Ref:Ta(A.rgce,h,null,fe,te)},A.itab>0&&(ne.Sheet=A.itab-1),fe.names.push(ne),fe[0]||(fe[0]=[],fe[0].XTI=[]),fe[fe.length-1].push(A),A.Name=="_xlnm._FilterDatabase"&&A.itab>0&&A.rgce&&A.rgce[0]&&A.rgce[0][0]&&A.rgce[0][0][0]=="PtgArea3d"&&(ee[A.itab-1]={ref:jt(A.rgce[0][0][1][2])});break;case 22:te.ExternCount=A;break;case 23:fe.length==0&&(fe[0]=[],fe[0].XTI=[]),fe[fe.length-1].XTI=fe[fe.length-1].XTI.concat(A),fe.XTI=fe.XTI.concat(A);break;case 2196:if(te.biff<8)break;ne!=null&&(ne.Comment=A[1]);break;case 18:s["!protect"]=A;break;case 19:A!==0&&te.WTF&&console.error("Password verifier: "+A);break;case 133:c[A.pos]=A,te.snames.push(A.name);break;case 10:{if(--pt)break;if(h.e){if(h.e.r>0&&h.e.c>0){if(h.e.r--,h.e.c--,s["!ref"]=jt(h),r.sheetRows&&r.sheetRows<=h.e.r){var ht=h.e.r;h.e.r=r.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=jt(h),h.e.r=ht}h.e.r++,h.e.c++}$e.length>0&&(s["!merges"]=$e),ae.length>0&&(s["!objects"]=ae),tt.length>0&&(s["!cols"]=tt),Re.length>0&&(s["!rows"]=Re),M.Sheets.push(ie)}g===""?v=s:n[g]=s,s=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(te.biff===8&&(te.biff={9:2,521:3,1033:4}[Le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[A.BIFFVer]||8),te.biffguess=A.BIFFVer==0,A.BIFFVer==0&&A.dt==4096&&(te.biff=5,le=!0,Dn(te.codepage=28591)),te.biff==8&&A.BIFFVer==0&&A.dt==16&&(te.biff=2),pt++)break;if(s=r.dense?[]:{},te.biff<8&&!le&&(le=!0,Dn(te.codepage=r.codepage||1252)),te.biff<5||A.BIFFVer==0&&A.dt==4096){g===""&&(g="Sheet1"),h={s:{r:0,c:0},e:{r:0,c:0}};var lt={pos:e.l-Pe,name:g};c[lt.pos]=lt,te.snames.push(g)}else g=(c[qe]||{name:""}).name;A.dt==32&&(s["!type"]="chart"),A.dt==64&&(s["!type"]="macro"),$e=[],ae=[],te.arrayf=X=[],tt=[],Re=[],Ut=!1,ie={Hidden:(c[qe]||{hs:0}).hs,name:g}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(r.dense?(s[A.r]||[])[A.c]:s[Ct({c:A.c,r:A.r})])&&++A.c,O={ixfe:A.ixfe,XF:oe[A.ixfe]||{},v:A.val,t:"n"},K>0&&(O.z=ce[O.ixfe>>8&63]),Yn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r);break;case 5:case 517:O={ixfe:A.ixfe,XF:oe[A.ixfe],v:A.val,t:A.t},K>0&&(O.z=ce[O.ixfe>>8&63]),Yn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r);break;case 638:O={ixfe:A.ixfe,XF:oe[A.ixfe],v:A.rknum,t:"n"},K>0&&(O.z=ce[O.ixfe>>8&63]),Yn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r);break;case 189:for(var ze=A.c;ze<=A.C;++ze){var Me=A.rkrec[ze-A.c][0];O={ixfe:Me,XF:oe[Me],v:A.rkrec[ze-A.c][1],t:"n"},K>0&&(O.z=ce[O.ixfe>>8&63]),Yn(O,r,t.opts.Date1904),he({c:ze,r:A.r},O,r)}break;case 6:case 518:case 1030:{if(A.val=="String"){d=A;break}if(O=Mo(A.val,A.cell.ixfe,A.tt),O.XF=oe[O.ixfe],r.cellFormula){var ft=A.formula;if(ft&&ft[0]&&ft[0][0]&&ft[0][0][0]=="PtgExp"){var Et=ft[0][0][1][0],Kr=ft[0][0][1][1],st=Ct({r:Et,c:Kr});U[st]?O.f=""+Ta(A.formula,h,A.cell,fe,te):O.F=((r.dense?(s[Et]||[])[Kr]:s[st])||{}).F}else O.f=""+Ta(A.formula,h,A.cell,fe,te)}K>0&&(O.z=ce[O.ixfe>>8&63]),Yn(O,r,t.opts.Date1904),he(A.cell,O,r),d=A}break;case 7:case 519:if(d)d.val=A,O=Mo(A,d.cell.ixfe,"s"),O.XF=oe[O.ixfe],r.cellFormula&&(O.f=""+Ta(d.formula,h,d.cell,fe,te)),K>0&&(O.z=ce[O.ixfe>>8&63]),Yn(O,r,t.opts.Date1904),he(d.cell,O,r),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{X.push(A);var An=Ct(A[0].s);if(T=r.dense?(s[A[0].s.r]||[])[A[0].s.c]:s[An],r.cellFormula&&T){if(!d||!An||!T)break;T.f=""+Ta(A[1],h,A[0],fe,te),T.F=jt(A[0])}}break;case 1212:{if(!r.cellFormula)break;if(C){if(!d)break;U[Ct(d.cell)]=A[0],T=r.dense?(s[d.cell.r]||[])[d.cell.c]:s[Ct(d.cell)],(T||{}).f=""+Ta(A[0],h,_,fe,te)}}break;case 253:O=Mo(m[A.isst].t,A.ixfe,"s"),m[A.isst].h&&(O.h=m[A.isst].h),O.XF=oe[O.ixfe],K>0&&(O.z=ce[O.ixfe>>8&63]),Yn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r);break;case 513:r.sheetStubs&&(O={ixfe:A.ixfe,XF:oe[A.ixfe],t:"z"},K>0&&(O.z=ce[O.ixfe>>8&63]),Yn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r));break;case 190:if(r.sheetStubs)for(var ln=A.c;ln<=A.C;++ln){var Dr=A.ixfe[ln-A.c];O={ixfe:Dr,XF:oe[Dr],t:"z"},K>0&&(O.z=ce[O.ixfe>>8&63]),Yn(O,r,t.opts.Date1904),he({c:ln,r:A.r},O,r)}break;case 214:case 516:case 4:O=Mo(A.val,A.ixfe,"s"),O.XF=oe[O.ixfe],K>0&&(O.z=ce[O.ixfe>>8&63]),Yn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r);break;case 0:case 512:pt===1&&(h=A);break;case 252:m=A;break;case 1054:if(te.biff==4){ce[K++]=A[1];for(var xa=0;xa<K+163&&bt[xa]!=A[1];++xa);xa>=163&&di(A[1],K+163)}else di(A[1],A[0]);break;case 30:{ce[K++]=A;for(var Or=0;Or<K+163&&bt[Or]!=A;++Or);Or>=163&&di(A,K+163)}break;case 229:$e=$e.concat(A);break;case 93:ae[A.cmo[0]]=te.lastobj=A;break;case 438:te.lastobj.TxO=A;break;case 127:te.lastobj.ImData=A;break;case 440:for(D=A[0].s.r;D<=A[0].e.r;++D)for(S=A[0].s.c;S<=A[0].e.c;++S)T=r.dense?(s[D]||[])[S]:s[Ct({c:S,r:D})],T&&(T.l=A[1]);break;case 2048:for(D=A[0].s.r;D<=A[0].e.r;++D)for(S=A[0].s.c;S<=A[0].e.c;++S)T=r.dense?(s[D]||[])[S]:s[Ct({c:S,r:D})],T&&T.l&&(T.l.Tooltip=A[1]);break;case 28:{if(te.biff<=5&&te.biff>=2)break;T=r.dense?(s[A[0].r]||[])[A[0].c]:s[Ct(A[0])];var $n=ae[A[2]];T||(r.dense?(s[A[0].r]||(s[A[0].r]=[]),T=s[A[0].r][A[0].c]={t:"z"}):T=s[Ct(A[0])]={t:"z"},h.e.r=Math.max(h.e.r,A[0].r),h.s.r=Math.min(h.s.r,A[0].r),h.e.c=Math.max(h.e.c,A[0].c),h.s.c=Math.min(h.s.c,A[0].c)),T.c||(T.c=[]),N={a:A[1],t:$n.TxO.t},T.c.push(N)}break;case 2173:Sw(oe[A.ixfe],A.ext);break;case 125:{if(!te.cellStyles)break;for(;A.e>=A.s;)tt[A.e--]={width:A.w/256,level:A.level||0,hidden:!!(A.flags&1)},Ut||(Ut=!0,Ml(A.w/256)),Bi(tt[A.e+1])}break;case 520:{var Ar={};A.level!=null&&(Re[A.r]=Ar,Ar.level=A.level),A.hidden&&(Re[A.r]=Ar,Ar.hidden=!0),A.hpt&&(Re[A.r]=Ar,Ar.hpt=A.hpt,Ar.hpx=Ys(A.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||os(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Le]]=A;break;case 161:s["!margins"]||os(s["!margins"]={}),s["!margins"].header=A.header,s["!margins"].footer=A.footer;break;case 574:A.RTL&&(M.Views[0].RTL=!0);break;case 146:J=A;break;case 2198:be=A;break;case 140:q=A;break;case 442:g?ie.CodeName=A||ie.name:M.WBProps.CodeName=A||"ThisWorkbook";break}}else Be||console.error("Missing Info for XLS Record 0x"+Le.toString(16)),e.l+=Pe}return t.SheetNames=Wr(c).sort(function(Yt,St){return Number(Yt)-Number(St)}).map(function(Yt){return c[Yt].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&v["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=v)):t.Preamble=v,t.Sheets&&ee.forEach(function(Yt,St){t.Sheets[t.SheetNames[St]]["!autofilter"]=Yt}),t.Strings=m,t.SSF=Ir(bt),te.enc&&(t.Encryption=te.enc),be&&(t.Themes=be),t.Metadata={},q!==void 0&&(t.Metadata.Country=q),fe.names.length>0&&(M.Names=fe.names),t.Workbook=M,t}var S0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function jE(e,r,t){var n=mt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=qf(n,Jc,S0.DSI);for(var c in s)r[c]=s[c]}catch(g){if(t.WTF)throw g}var h=mt.find(e,"/!SummaryInformation");if(h&&h.size>0)try{var d=qf(h,Qc,S0.SI);for(var m in d)r[m]==null&&(r[m]=d[m])}catch(g){if(t.WTF)throw g}r.HeadingPairs&&r.TitlesOfParts&&(Nh(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function UE(e,r){var t=[],n=[],s=[],c=0,h,d=Sf(Jc,"n"),m=Sf(Qc,"n");if(e.Props)for(h=Wr(e.Props),c=0;c<h.length;++c)(Object.prototype.hasOwnProperty.call(d,h[c])?t:Object.prototype.hasOwnProperty.call(m,h[c])?n:s).push([h[c],e.Props[h[c]]]);if(e.Custprops)for(h=Wr(e.Custprops),c=0;c<h.length;++c)Object.prototype.hasOwnProperty.call(e.Props||{},h[c])||(Object.prototype.hasOwnProperty.call(d,h[c])?t:Object.prototype.hasOwnProperty.call(m,h[c])?n:s).push([h[c],e.Custprops[h[c]]]);var g=[];for(c=0;c<s.length;++c)Mh.indexOf(s[c][0])>-1||Th.indexOf(s[c][0])>-1||s[c][1]!=null&&g.push(s[c]);n.length&&mt.utils.cfb_add(r,"/SummaryInformation",Zf(n,S0.SI,m,Qc)),(t.length||g.length)&&mt.utils.cfb_add(r,"/DocumentSummaryInformation",Zf(t,S0.DSI,d,Jc,g.length?g:null,S0.UDI))}function Iu(e,r){r||(r={}),Gl(r),hl(),r.codepage&&fl(r.codepage);var t,n;if(e.FullPaths){if(mt.find(e,"/encryption"))throw new Error("File is password-protected");t=mt.find(e,"!CompObj"),n=mt.find(e,"/Workbook")||mt.find(e,"/Book")}else{switch(r.type){case"base64":e=sn(cn(e));break;case"binary":e=sn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wa(e,0),n={content:e}}var s,c;if(t&&ME(t),r.bookProps&&!r.bookSheets)s={};else{var h=Gt?"buffer":"array";if(n&&n.content)s=LE(n.content,r);else if((c=mt.find(e,"PerfectOffice_MAIN"))&&c.content)s=ss.to_workbook(c.content,(r.type=h,r));else if((c=mt.find(e,"NativeContent_MAIN"))&&c.content)s=ss.to_workbook(c.content,(r.type=h,r));else throw(c=mt.find(e,"MN0"))&&c.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&mt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=$w(e))}var d={};return e.FullPaths&&jE(e,d,r),s.Props=s.Custprops=d,r.bookFiles&&(s.cfb=e),s}function WE(e,r){var t=r||{},n=mt.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return mt.utils.cfb_add(n,s,Du(e,t)),t.biff==8&&(e.Props||e.Custprops)&&UE(e,n),t.biff==8&&e.vbaraw&&ev(n,mt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var B0={0:{f:hy},1:{f:vy},2:{f:Ly},3:{f:Ty},4:{f:Ay},5:{f:My},6:{f:Hy},7:{f:Dy},8:{f:Zy},9:{f:qy},10:{f:Yy},11:{f:Ky},12:{f:Ey},13:{f:Uy},14:{f:ky},15:{f:Sy},16:{f:_u},17:{f:Xy},18:{f:Oy},19:{f:Sl},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:X4},40:{},42:{},43:{f:Hp},44:{f:Wp},45:{f:zp},46:{f:Kp},47:{f:Yp},48:{},49:{f:xg},50:{},51:{f:Nw},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zh},62:{f:Vy},63:{f:Bw},64:{f:u4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Da,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:c4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:py},148:{f:xy,p:16},151:{f:r4},152:{},153:{f:V4},154:{},155:{},156:{f:U4},157:{},158:{},159:{T:1,f:np},160:{T:-1},161:{T:1,f:vs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Jy},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Cw},336:{T:-1},337:{f:Dw,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Zc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Xh},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:a4},427:{f:n4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:s4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:my},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:e4},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Zc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Kw},633:{T:1},634:{T:-1},635:{T:1,f:zw},636:{T:-1},637:{f:wg},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:k4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:d4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},nl={6:{f:Vc},10:{f:Oi},12:{f:ea},13:{f:ea},14:{f:Xr},15:{f:Xr},16:{f:ka},17:{f:Xr},18:{f:Xr},19:{f:ea},20:{f:r1},21:{f:r1},23:{f:Xh},24:{f:n1},25:{f:Xr},26:{},27:{},28:{f:dm},29:{},34:{f:Xr},35:{f:a1},38:{f:ka},39:{f:ka},40:{f:ka},41:{f:ka},42:{f:Xr},43:{f:Xr},47:{f:Sp},49:{f:U2},51:{f:ea},60:{},61:{f:M2},64:{f:Xr},65:{f:j2},66:{f:ea},77:{},80:{},81:{},82:{},85:{f:ea},89:{},90:{},91:{},92:{f:b2},93:{f:mm},94:{},95:{f:Xr},96:{},97:{},99:{f:Xr},125:{f:zh},128:{f:tm},129:{f:C2},130:{f:ea},131:{f:Xr},132:{f:Xr},133:{f:T2},134:{},140:{f:bm},141:{f:ea},144:{},146:{f:Tm},151:{},152:{},153:{},154:{},155:{},156:{f:ea},157:{},158:{},160:{f:Rm},161:{f:Im},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:J2},190:{f:Q2},193:{f:Oi},197:{},198:{},199:{},200:{},201:{},202:{f:Xr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ea},220:{},221:{f:Xr},222:{},224:{f:em},225:{f:A2},226:{f:Oi},227:{},229:{f:xm},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:k2},253:{f:V2},255:{f:D2},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ph},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Xr},353:{f:Oi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:sm},431:{f:Xr},432:{},433:{},434:{},437:{},438:{f:vm},439:{f:Xr},440:{f:ym},441:{},442:{f:H0},443:{},444:{f:ea},445:{},446:{},448:{f:Oi},449:{f:R2,r:2},450:{f:Oi},512:{f:$f},513:{f:Om},515:{f:nm},516:{f:G2},517:{f:t1},519:{f:Mm},520:{f:F2},523:{},545:{f:i1},549:{f:Qf},566:{},574:{f:B2},638:{f:Z2},659:{},1048:{},1054:{f:z2},1084:{},1212:{f:fm},2048:{f:_m},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Fo},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Oi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Nm,r:12},2173:{f:bw,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Xr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:lm,r:12},2197:{},2198:{f:ww,r:12},2199:{},2200:{},2201:{},2202:{f:hm,r:12},2203:{f:Oi},2204:{},2205:{},2206:{},2207:{},2211:{f:O2},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ea},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Dm},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Cm},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:$f},1:{},2:{f:Um},3:{f:Lm},4:{f:Bm},5:{f:t1},7:{f:Vm},8:{},9:{f:Fo},11:{},22:{f:ea},30:{f:K2},31:{},32:{},33:{f:i1},36:{},37:{f:Qf},50:{f:Hm},62:{},52:{},67:{},68:{f:ea},69:{},86:{},126:{},127:{f:Pm},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Gm},223:{},234:{},354:{},421:{},518:{f:Vc},521:{f:Fo},536:{f:n1},547:{f:a1},561:{},579:{},1030:{f:Vc},1033:{f:Fo},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function at(e,r,t,n){var s=r;if(!isNaN(s)){var c=n||(t||[]).length||0,h=e.next(4);h.write_shift(2,s),h.write_shift(2,c),c>0&&_l(t)&&e.push(t)}}function VE(e,r,t,n){var s=(t||[]).length||0;if(s<=8224)return at(e,r,t,s);var c=r;if(!isNaN(c)){for(var h=t.parts||[],d=0,m=0,g=0;g+(h[d]||8224)<=8224;)g+=h[d]||8224,d++;var v=e.next(4);for(v.write_shift(2,c),v.write_shift(2,g),e.push(t.slice(m,m+g)),m+=g;m<s;){for(v=e.next(4),v.write_shift(2,60),g=0;g+(h[d]||8224)<=8224;)g+=h[d]||8224,d++;v.write_shift(2,g),e.push(t.slice(m,m+g)),m+=g}}}function Y0(e,r,t){return e||(e=Oe(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function HE(e,r,t,n){var s=Oe(9);return Y0(s,e,r),Bh(t,n||"b",s),s}function GE(e,r,t){var n=Oe(8+2*t.length);return Y0(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function XE(e,r,t,n){if(r.v!=null)switch(r.t){case"d":case"n":var s=r.t=="d"?ia(kr(r.v)):r.v;s==(s|0)&&s>=0&&s<65536?at(e,2,Wm(t,n,s)):at(e,3,jm(t,n,s));return;case"b":case"e":at(e,5,HE(t,n,r.v,r.t));return;case"s":case"str":at(e,4,GE(t,n,(r.v||"").slice(0,255)));return}at(e,1,Y0(null,t,n))}function zE(e,r,t,n){var s=Array.isArray(r),c=er(r["!ref"]||"A1"),h,d="",m=[];if(c.e.c>255||c.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),h=jt(c)}for(var g=c.s.r;g<=c.e.r;++g){d=zr(g);for(var v=c.s.c;v<=c.e.c;++v){g===c.s.r&&(m[v]=Pr(v)),h=m[v]+d;var _=s?(r[g]||[])[v]:r[h];_&&XE(e,_,g,v)}}}function YE(e,r){for(var t=r||{},n=Xa(),s=0,c=0;c<e.SheetNames.length;++c)e.SheetNames[c]==t.sheet&&(s=c);if(s==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return at(n,t.biff==4?1033:t.biff==3?521:9,Fl(e,16,t)),zE(n,e.Sheets[e.SheetNames[s]],s,t),at(n,10),n.end()}function KE(e,r,t){at(e,49,W2({sz:12,name:"Arial"},t))}function qE(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&at(e,1054,Y2(s,r[s],t))})}function ZE(e,r){var t=Oe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),at(e,2151,t),t=Oe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Vh(er(r["!ref"]||"A1"),t),t.write_shift(4,4),at(e,2152,t)}function JE(e,r){for(var t=0;t<16;++t)at(e,224,e1({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){at(e,224,e1(n,0,r))})}function QE(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];at(e,440,Em(n)),n[1].Tooltip&&at(e,2048,Am(n))}delete r["!links"]}function $E(e,r){if(r){var t=0;r.forEach(function(n,s){++t<=256&&n&&at(e,125,km(fc(s,n),s))})}}function e_(e,r,t,n,s){var c=16+Vi(s.cellXfs,r,s);if(r.v==null&&!r.bf){at(e,513,us(t,n,c));return}if(r.bf)at(e,6,C3(r,t,n,s,c));else switch(r.t){case"d":case"n":var h=r.t=="d"?ia(kr(r.v)):r.v;at(e,515,im(t,n,h,c));break;case"b":case"e":at(e,517,am(t,n,r.v,c,s,r.t));break;case"s":case"str":if(s.bookSST){var d=Ul(s.Strings,r.v,s.revStrings);at(e,253,H2(t,n,d,c))}else at(e,516,X2(t,n,(r.v||"").slice(0,255),c,s));break;default:at(e,513,us(t,n,c))}}function t_(e,r,t){var n=Xa(),s=t.SheetNames[e],c=t.Sheets[s]||{},h=(t||{}).Workbook||{},d=(h.Sheets||[])[e]||{},m=Array.isArray(c),g=r.biff==8,v,_="",C=[],T=er(c["!ref"]||"A1"),N=g?65536:16384;if(T.e.c>255||T.e.r>=N){if(r.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,N-1)}at(n,2057,Fl(t,16,r)),at(n,13,vn(1)),at(n,12,vn(100)),at(n,15,La(!0)),at(n,17,La(!1)),at(n,16,fs(.001)),at(n,95,La(!0)),at(n,42,La(!1)),at(n,43,La(!1)),at(n,130,vn(1)),at(n,128,rm()),at(n,131,La(!1)),at(n,132,La(!1)),g&&$E(n,c["!cols"]),at(n,512,q2(T,r)),g&&(c["!links"]=[]);for(var S=T.s.r;S<=T.e.r;++S){_=zr(S);for(var D=T.s.c;D<=T.e.c;++D){S===T.s.r&&(C[D]=Pr(D)),v=C[D]+_;var U=m?(c[S]||[])[D]:c[v];U&&(e_(n,U,S,D,r),g&&U.l&&c["!links"].push([v,U.l]))}}var X=d.CodeName||d.name||s;return g&&at(n,574,L2((h.Views||[])[0])),g&&(c["!merges"]||[]).length&&at(n,229,gm(c["!merges"])),g&&QE(n,c),at(n,442,Lh(X)),g&&ZE(n,c),at(n,10),n.end()}function r_(e,r,t){var n=Xa(),s=(e||{}).Workbook||{},c=s.Sheets||[],h=s.WBProps||{},d=t.biff==8,m=t.biff==5;if(at(n,2057,Fl(e,5,t)),t.bookType=="xla"&&at(n,135),at(n,225,d?vn(1200):null),at(n,193,a2(2)),m&&at(n,191),m&&at(n,192),at(n,226),at(n,92,S2("SheetJS",t)),at(n,66,vn(d?1200:1252)),d&&at(n,353,vn(0)),d&&at(n,448),at(n,317,Fm(e.SheetNames.length)),d&&e.vbaraw&&at(n,211),d&&e.vbaraw){var g=h.CodeName||"ThisWorkbook";at(n,442,Lh(g))}at(n,156,vn(17)),at(n,25,La(!1)),at(n,18,La(!1)),at(n,19,vn(0)),d&&at(n,431,La(!1)),d&&at(n,444,vn(0)),at(n,61,P2()),at(n,64,La(!1)),at(n,141,vn(0)),at(n,34,La(R4(e)=="true")),at(n,14,La(!0)),d&&at(n,439,La(!1)),at(n,218,vn(0)),KE(n,e,t),qE(n,e.SSF,t),JE(n,t),d&&at(n,352,La(!1));var v=n.end(),_=Xa();d&&at(_,140,Sm()),d&&t.Strings&&VE(_,252,I2(t.Strings)),at(_,10);var C=_.end(),T=Xa(),N=0,S=0;for(S=0;S<e.SheetNames.length;++S)N+=(d?12:11)+(d?2:1)*e.SheetNames[S].length;var D=v.length+N+C.length;for(S=0;S<e.SheetNames.length;++S){var U=c[S]||{};at(T,133,N2({pos:D,hs:U.Hidden||0,dt:0,name:e.SheetNames[S]},t)),D+=r[S].length}var X=T.end();if(N!=X.length)throw new Error("BS8 "+N+" != "+X.length);var O=[];return v.length&&O.push(v),X.length&&O.push(X),C.length&&O.push(C),ua(O)}function a_(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=Ir(bt)),e&&e.SSF&&(qs(),ac(e.SSF),t.revssf=ic(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xl(t),t.cellXfs=[],Vi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=t_(s,t,e);return n.unshift(r_(e,n,t)),ua(n)}function Du(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var s=za(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var c=r||{};switch(c.biff||2){case 8:case 5:return a_(e,r);case 4:case 3:case 2:return YE(e,r)}throw new Error("invalid type "+c.bookType+" for BIFF")}function g1(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var c=e.match(/<\/table/i),h=s.index,d=c&&c.index||e.length,m=Wx(e.slice(h,d),/(:?<tr[^>]*>)/i,"<tr>"),g=-1,v=0,_=0,C=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},N=[];for(h=0;h<m.length;++h){var S=m[h].trim(),D=S.slice(0,3).toLowerCase();if(D=="<tr"){if(++g,t.sheetRows&&t.sheetRows<=g){--g;break}v=0;continue}if(!(D!="<td"&&D!="<th")){var U=S.split(/<\/t[dh]>/i);for(d=0;d<U.length;++d){var X=U[d].trim();if(X.match(/<t[dh]/i)){for(var O=X,q=0;O.charAt(0)=="<"&&(q=O.indexOf(">"))>-1;)O=O.slice(q+1);for(var oe=0;oe<N.length;++oe){var J=N[oe];J.s.c==v&&J.s.r<g&&g<=J.e.r&&(v=J.e.c+1,oe=-1)}var M=Tt(X.slice(0,X.indexOf(">")));C=M.colspan?+M.colspan:1,((_=+M.rowspan)>1||C>1)&&N.push({s:{r:g,c:v},e:{r:g+(_||1)-1,c:v+C-1}});var ie=M.t||M["data-t"]||"";if(!O.length){v+=C;continue}if(O=th(O),T.s.r>g&&(T.s.r=g),T.e.r<g&&(T.e.r=g),T.s.c>v&&(T.s.c=v),T.e.c<v&&(T.e.c=v),!O.length){v+=C;continue}var j={t:"s",v:O};t.raw||!O.trim().length||ie=="s"||(O==="TRUE"?j={t:"b",v:!0}:O==="FALSE"?j={t:"b",v:!1}:isNaN(On(O))?isNaN(Xs(O).getDate())||(j={t:"d",v:kr(O)},t.cellDates||(j={t:"n",v:ia(j.v)}),j.z=t.dateNF||bt[14]):j={t:"n",v:On(O)}),t.dense?(n[g]||(n[g]=[]),n[g][v]=j):n[Ct({r:g,c:v})]=j,v+=C}}}}return n["!ref"]=jt(T),N.length&&(n["!merges"]=N),n}function n_(e,r,t,n){for(var s=e["!merges"]||[],c=[],h=r.s.c;h<=r.e.c;++h){for(var d=0,m=0,g=0;g<s.length;++g)if(!(s[g].s.r>t||s[g].s.c>h)&&!(s[g].e.r<t||s[g].e.c<h)){if(s[g].s.r<t||s[g].s.c<h){d=-1;break}d=s[g].e.r-s[g].s.r+1,m=s[g].e.c-s[g].s.c+1;break}if(!(d<0)){var v=Ct({r:t,c:h}),_=n.dense?(e[t]||[])[h]:e[v],C=_&&_.v!=null&&(_.h||vl(_.w||(gi(_),_.w)||""))||"",T={};d>1&&(T.rowspan=d),m>1&&(T.colspan=m),n.editable?C='<span contenteditable="true">'+C+"</span>":_&&(T["data-t"]=_&&_.t||"z",_.v!=null&&(T["data-v"]=_.v),_.z!=null&&(T["data-z"]=_.z),_.l&&(_.l.Target||"#").charAt(0)!="#"&&(C='<a href="'+_.l.Target+'">'+C+"</a>")),T.id=(n.id||"sjs")+"-"+v,c.push(rt("td",C,T))}}var N="<tr>";return N+c.join("")+"</tr>"}var i_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',s_="</body></html>";function o_(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Wi(g1(t[0],r),r);var n=Kl();return t.forEach(function(s,c){ql(n,g1(s,r),"Sheet"+(c+1))}),n}function c_(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Fu(e,r){var t=r||{},n=t.header!=null?t.header:i_,s=t.footer!=null?t.footer:s_,c=[n],h=za(e["!ref"]);t.dense=Array.isArray(e),c.push(c_(e,h,t));for(var d=h.s.r;d<=h.e.r;++d)c.push(n_(e,h,d,t));return c.push("</table>"+s),c.join("")}function Ou(e,r,t){var n=t||{},s=0,c=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var h=typeof n.origin=="string"?Br(n.origin):n.origin;s=h.r,c=h.c}var d=r.getElementsByTagName("tr"),m=Math.min(n.sheetRows||1e7,d.length),g={s:{r:0,c:0},e:{r:s,c}};if(e["!ref"]){var v=za(e["!ref"]);g.s.r=Math.min(g.s.r,v.s.r),g.s.c=Math.min(g.s.c,v.s.c),g.e.r=Math.max(g.e.r,v.e.r),g.e.c=Math.max(g.e.c,v.e.c),s==-1&&(g.e.r=s=v.e.r+1)}var _=[],C=0,T=e["!rows"]||(e["!rows"]=[]),N=0,S=0,D=0,U=0,X=0,O=0;for(e["!cols"]||(e["!cols"]=[]);N<d.length&&S<m;++N){var q=d[N];if(m1(q)){if(n.display)continue;T[S]={hidden:!0}}var oe=q.children;for(D=U=0;D<oe.length;++D){var J=oe[D];if(!(n.display&&m1(J))){var M=J.hasAttribute("data-v")?J.getAttribute("data-v"):J.hasAttribute("v")?J.getAttribute("v"):th(J.innerHTML),ie=J.getAttribute("data-z")||J.getAttribute("z");for(C=0;C<_.length;++C){var j=_[C];j.s.c==U+c&&j.s.r<S+s&&S+s<=j.e.r&&(U=j.e.c+1-c,C=-1)}O=+J.getAttribute("colspan")||1,((X=+J.getAttribute("rowspan")||1)>1||O>1)&&_.push({s:{r:S+s,c:U+c},e:{r:S+s+(X||1)-1,c:U+c+(O||1)-1}});var Ee={t:"s",v:M},he=J.getAttribute("data-t")||J.getAttribute("t")||"";M!=null&&(M.length==0?Ee.t=he||"z":n.raw||M.trim().length==0||he=="s"||(M==="TRUE"?Ee={t:"b",v:!0}:M==="FALSE"?Ee={t:"b",v:!1}:isNaN(On(M))?isNaN(Xs(M).getDate())||(Ee={t:"d",v:kr(M)},n.cellDates||(Ee={t:"n",v:ia(Ee.v)}),Ee.z=n.dateNF||bt[14]):Ee={t:"n",v:On(M)})),Ee.z===void 0&&ie!=null&&(Ee.z=ie);var te="",be=J.getElementsByTagName("A");if(be&&be.length)for(var $e=0;$e<be.length&&!(be[$e].hasAttribute("href")&&(te=be[$e].getAttribute("href"),te.charAt(0)!="#"));++$e);te&&te.charAt(0)!="#"&&(Ee.l={Target:te}),n.dense?(e[S+s]||(e[S+s]=[]),e[S+s][U+c]=Ee):e[Ct({c:U+c,r:S+s})]=Ee,g.e.c<U+c&&(g.e.c=U+c),U+=O}}++S}return _.length&&(e["!merges"]=(e["!merges"]||[]).concat(_)),g.e.r=Math.max(g.e.r,S-1+s),e["!ref"]=jt(g),S>=m&&(e["!fullref"]=jt((g.e.r=d.length-N+S-1+s,g))),e}function Ru(e,r){var t=r||{},n=t.dense?[]:{};return Ou(n,e,r)}function l_(e,r){return Wi(Ru(e,r),r)}function m1(e){var r="",t=f_(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function f_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function h_(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=$t(r.replace(/<[^>]*>/g,""));return[t]}var p1={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Mu(e,r){var t=r||{},n=yl(e),s=[],c,h,d={name:""},m="",g=0,v,_,C={},T=[],N=t.dense?[]:{},S,D,U={value:""},X="",O=0,q=[],oe=-1,J=-1,M={s:{r:1e6,c:1e7},e:{r:0,c:0}},ie=0,j={},Ee=[],he={},te=0,be=0,$e=[],ae=1,tt=1,Re=[],Ut={Names:[]},fe={},ot=["",""],pt=[],K={},ce="",ee=0,ne=!1,le=!1,qe=0;for(D0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=D0.exec(n);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"工作表":S[1]==="/"?(M.e.c>=M.s.c&&M.e.r>=M.s.r?N["!ref"]=jt(M):N["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=M.e.r&&(N["!fullref"]=N["!ref"],M.e.r=t.sheetRows-1,N["!ref"]=jt(M)),Ee.length&&(N["!merges"]=Ee),$e.length&&(N["!rows"]=$e),v.name=v.名称||v.name,typeof JSON<"u"&&JSON.stringify(v),T.push(v.name),C[v.name]=N,le=!1):S[0].charAt(S[0].length-2)!=="/"&&(v=Tt(S[0],!1),oe=J=-1,M.s.r=M.s.c=1e7,M.e.r=M.e.c=0,N=t.dense?[]:{},Ee=[],$e=[],le=!0);break;case"table-row-group":S[1]==="/"?--ie:++ie;break;case"table-row":case"行":if(S[1]==="/"){oe+=ae,ae=1;break}if(_=Tt(S[0],!1),_.行号?oe=_.行号-1:oe==-1&&(oe=0),ae=+_["number-rows-repeated"]||1,ae<10)for(qe=0;qe<ae;++qe)ie>0&&($e[oe+qe]={level:ie});J=-1;break;case"covered-table-cell":S[1]!=="/"&&++J,t.sheetStubs&&(t.dense?(N[oe]||(N[oe]=[]),N[oe][J]={t:"z"}):N[Ct({r:oe,c:J})]={t:"z"}),X="",q=[];break;case"table-cell":case"数据":if(S[0].charAt(S[0].length-2)==="/")++J,U=Tt(S[0],!1),tt=parseInt(U["number-columns-repeated"]||"1",10),D={t:"z",v:null},U.formula&&t.cellFormula!=!1&&(D.f=u1($t(U.formula))),(U.数据类型||U["value-type"])=="string"&&(D.t="s",D.v=$t(U["string-value"]||""),t.dense?(N[oe]||(N[oe]=[]),N[oe][J]=D):N[Ct({r:oe,c:J})]=D),J+=tt-1;else if(S[1]!=="/"){++J,X="",O=0,q=[],tt=1;var Le=ae?oe+ae-1:oe;if(J>M.e.c&&(M.e.c=J),J<M.s.c&&(M.s.c=J),oe<M.s.r&&(M.s.r=oe),Le>M.e.r&&(M.e.r=Le),U=Tt(S[0],!1),pt=[],K={},D={t:U.数据类型||U["value-type"],v:null},t.cellFormula)if(U.formula&&(U.formula=$t(U.formula)),U["number-matrix-columns-spanned"]&&U["number-matrix-rows-spanned"]&&(te=parseInt(U["number-matrix-rows-spanned"],10)||0,be=parseInt(U["number-matrix-columns-spanned"],10)||0,he={s:{r:oe,c:J},e:{r:oe+te-1,c:J+be-1}},D.F=jt(he),Re.push([he,D.F])),U.formula)D.f=u1(U.formula);else for(qe=0;qe<Re.length;++qe)oe>=Re[qe][0].s.r&&oe<=Re[qe][0].e.r&&J>=Re[qe][0].s.c&&J<=Re[qe][0].e.c&&(D.F=Re[qe][1]);switch((U["number-columns-spanned"]||U["number-rows-spanned"])&&(te=parseInt(U["number-rows-spanned"],10)||0,be=parseInt(U["number-columns-spanned"],10)||0,he={s:{r:oe,c:J},e:{r:oe+te-1,c:J+be-1}},Ee.push(he)),U["number-columns-repeated"]&&(tt=parseInt(U["number-columns-repeated"],10)),D.t){case"boolean":D.t="b",D.v=Nr(U["boolean-value"]);break;case"float":D.t="n",D.v=parseFloat(U.value);break;case"percentage":D.t="n",D.v=parseFloat(U.value);break;case"currency":D.t="n",D.v=parseFloat(U.value);break;case"date":D.t="d",D.v=kr(U["date-value"]),t.cellDates||(D.t="n",D.v=ia(D.v)),D.z="m/d/yy";break;case"time":D.t="n",D.v=Lx(U["time-value"])/86400,t.cellDates&&(D.t="d",D.v=sc(D.v)),D.z="HH:MM:SS";break;case"number":D.t="n",D.v=parseFloat(U.数据数值);break;default:if(D.t==="string"||D.t==="text"||!D.t)D.t="s",U["string-value"]!=null&&(X=$t(U["string-value"]),q=[]);else throw new Error("Unsupported value type "+D.t)}}else{if(ne=!1,D.t==="s"&&(D.v=X||"",q.length&&(D.R=q),ne=O==0),fe.Target&&(D.l=fe),pt.length>0&&(D.c=pt,pt=[]),X&&t.cellText!==!1&&(D.w=X),ne&&(D.t="z",delete D.v),(!ne||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=oe))for(var Pe=0;Pe<ae;++Pe){if(tt=parseInt(U["number-columns-repeated"]||"1",10),t.dense)for(N[oe+Pe]||(N[oe+Pe]=[]),N[oe+Pe][J]=Pe==0?D:Ir(D);--tt>0;)N[oe+Pe][J+tt]=Ir(D);else for(N[Ct({r:oe+Pe,c:J})]=D;--tt>0;)N[Ct({r:oe+Pe,c:J+tt})]=Ir(D);M.e.c<=J&&(M.e.c=J)}tt=parseInt(U["number-columns-repeated"]||"1",10),J+=tt-1,tt=0,D={},X="",q=[]}fe={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((c=s.pop())[0]!==S[3])throw"Bad state: "+c}else S[0].charAt(S[0].length-2)!=="/"&&s.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((c=s.pop())[0]!==S[3])throw"Bad state: "+c;K.t=X,q.length&&(K.R=q),K.a=ce,pt.push(K)}else S[0].charAt(S[0].length-2)!=="/"&&s.push([S[3],!1]);ce="",ee=0,X="",O=0,q=[];break;case"creator":S[1]==="/"?ce=n.slice(ee,S.index):ee=S.index+S[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((c=s.pop())[0]!==S[3])throw"Bad state: "+c}else S[0].charAt(S[0].length-2)!=="/"&&s.push([S[3],!1]);X="",O=0,q=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(j[d.name]=m,(c=s.pop())[0]!==S[3])throw"Bad state: "+c}else S[0].charAt(S[0].length-2)!=="/"&&(m="",d=Tt(S[0],!1),s.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":h=Tt(S[0],!1),m+=p1[S[3]][h.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":h=Tt(S[0],!1),m+=p1[S[3]][h.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":m+=n.slice(g,S.index);break}else g=S.index+S[0].length;break;case"named-range":h=Tt(S[0],!1),ot=Hc(h["cell-range-address"]);var Be={Name:h.name,Ref:ot[0]+"!"+ot[1]};le&&(Be.Sheet=T.length),Ut.Names.push(Be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(S[1]==="/"&&(!U||!U["string-value"])){var Te=h_(n.slice(O,S.index));X=(X.length>0?X+`
`:"")+Te[0]}else Tt(S[0],!1),O=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{ot=Hc(Tt(S[0])["target-range-address"]),C[ot[0]]["!autofilter"]={ref:ot[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(fe=Tt(S[0],!1),!fe.href)break;fe.Target=$t(fe.href),delete fe.href,fe.Target.charAt(0)=="#"&&fe.Target.indexOf(".")>-1?(ot=Hc(fe.Target.slice(1)),fe.Target="#"+ot[0]+"!"+ot[1]):fe.Target.match(/^\.\.[\\\/]/)&&(fe.Target=fe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(S)}}var A={Sheets:C,SheetNames:T,Workbook:Ut};return t.bookSheets&&delete A.Sheets,A}function w1(e,r){r=r||{},wn(e,"META-INF/manifest.xml")&&Lg($r(e,"META-INF/manifest.xml"),r);var t=on(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=Mu(mr(t),r);return wn(e,"meta.xml")&&(n.Props=Sh($r(e,"meta.xml"))),n}function v1(e,r){return Mu(e,r)}var u_=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+I0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Yr+r}}(),y1=function(){var e=function(c){return ur(c).replace(/  +/g,function(h){return'<text:s text:c="'+h.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(c,h,d){var m=[];m.push('      <table:table table:name="'+ur(h.SheetNames[d])+`" table:style-name="ta1">
`);var g=0,v=0,_=za(c["!ref"]||"A1"),C=c["!merges"]||[],T=0,N=Array.isArray(c);if(c["!cols"])for(v=0;v<=_.e.c;++v)m.push("        <table:table-column"+(c["!cols"][v]?' table:style-name="co'+c["!cols"][v].ods+'"':"")+`></table:table-column>
`);var S="",D=c["!rows"]||[];for(g=0;g<_.s.r;++g)S=D[g]?' table:style-name="ro'+D[g].ods+'"':"",m.push("        <table:table-row"+S+`></table:table-row>
`);for(;g<=_.e.r;++g){for(S=D[g]?' table:style-name="ro'+D[g].ods+'"':"",m.push("        <table:table-row"+S+`>
`),v=0;v<_.s.c;++v)m.push(r);for(;v<=_.e.c;++v){var U=!1,X={},O="";for(T=0;T!=C.length;++T)if(!(C[T].s.c>v)&&!(C[T].s.r>g)&&!(C[T].e.c<v)&&!(C[T].e.r<g)){(C[T].s.c!=v||C[T].s.r!=g)&&(U=!0),X["table:number-columns-spanned"]=C[T].e.c-C[T].s.c+1,X["table:number-rows-spanned"]=C[T].e.r-C[T].s.r+1;break}if(U){m.push(t);continue}var q=Ct({r:g,c:v}),oe=N?(c[g]||[])[v]:c[q];if(oe&&oe.f&&(X["table:formula"]=ur(F3(oe.f)),oe.F&&oe.F.slice(0,q.length)==q)){var J=za(oe.F);X["table:number-matrix-columns-spanned"]=J.e.c-J.s.c+1,X["table:number-matrix-rows-spanned"]=J.e.r-J.s.r+1}if(!oe){m.push(r);continue}switch(oe.t){case"b":O=oe.v?"TRUE":"FALSE",X["office:value-type"]="boolean",X["office:boolean-value"]=oe.v?"true":"false";break;case"n":O=oe.w||String(oe.v||0),X["office:value-type"]="float",X["office:value"]=oe.v||0;break;case"s":case"str":O=oe.v==null?"":oe.v,X["office:value-type"]="string";break;case"d":O=oe.w||kr(oe.v).toISOString(),X["office:value-type"]="date",X["office:date-value"]=kr(oe.v).toISOString(),X["table:style-name"]="ce1";break;default:m.push(r);continue}var M=e(O);if(oe.l&&oe.l.Target){var ie=oe.l.Target;ie=ie.charAt(0)=="#"?"#"+O3(ie.slice(1)):ie,ie.charAt(0)!="#"&&!ie.match(/^\w+:/)&&(ie="../"+ie),M=rt("text:a",M,{"xlink:href":ie.replace(/&/g,"&amp;")})}m.push("          "+rt("table:table-cell",rt("text:p",M,{}),X)+`
`)}m.push(`        </table:table-row>
`)}return m.push(`      </table:table>
`),m.join("")},s=function(c,h){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var d=0;h.SheetNames.map(function(g){return h.Sheets[g]}).forEach(function(g){if(g&&g["!cols"]){for(var v=0;v<g["!cols"].length;++v)if(g["!cols"][v]){var _=g["!cols"][v];if(_.width==null&&_.wpx==null&&_.wch==null)continue;Bi(_),_.ods=d;var C=g["!cols"][v].wpx+"px";c.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+C+`"/>
`),c.push(`  </style:style>
`),++d}}});var m=0;h.SheetNames.map(function(g){return h.Sheets[g]}).forEach(function(g){if(g&&g["!rows"]){for(var v=0;v<g["!rows"].length;++v)if(g["!rows"][v]){g["!rows"][v].ods=m;var _=g["!rows"][v].hpx+"px";c.push('  <style:style style:name="ro'+m+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+_+`"/>
`),c.push(`  </style:style>
`),++m}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(h,d){var m=[Yr],g=I0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),v=I0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(m.push("<office:document"+g+v+`>
`),m.push(bh().replace(/office:document-meta/g,"office:meta"))):m.push("<office:document-content"+g+`>
`),s(m,h),m.push(`  <office:body>
`),m.push(`    <office:spreadsheet>
`);for(var _=0;_!=h.SheetNames.length;++_)m.push(n(h.Sheets[h.SheetNames[_]],h,_));return m.push(`    </office:spreadsheet>
`),m.push(`  </office:body>
`),d.bookType=="fods"?m.push("</office:document>"):m.push("</office:document-content>"),m.join("")}}();function Pu(e,r){if(r.bookType=="fods")return y1(e,r);var t=ml(),n="",s=[],c=[];return n="mimetype",Vt(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Vt(t,n,y1(e,r)),s.push([n,"text/xml"]),c.push([n,"ContentFile"]),n="styles.xml",Vt(t,n,u_(e,r)),s.push([n,"text/xml"]),c.push([n,"StylesFile"]),n="meta.xml",Vt(t,n,Yr+bh()),s.push([n,"text/xml"]),c.push([n,"MetadataFile"]),n="manifest.rdf",Vt(t,n,Wg(c)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Vt(t,n,jg(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ds(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function il(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):mr(Ui(e))}function d_(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):sn(Zn(e))}function x_(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var n=0;n<r.length;++n)if(e[t+n]!=r[n])continue e;return!0}return!1}function ji(e){var r=e.reduce(function(s,c){return s+c.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(s){t.set(s,n),n+=s.length}),t}function E1(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function g_(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,s=r+13;s>=r;--s)n=n*256+e[s];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function m_(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var c=0;s>=1;++c,s/=256)e[r+c]=s&255;e[r+15]|=t>=0?0:128}function L0(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function fr(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function Ur(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function rr(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],s=L0(e,t),c=s&7;s=Math.floor(s/8);var h=0,d;if(s==0)break;switch(c){case 0:{for(var m=t[0];e[t[0]++]>=128;);d=e.slice(m,t[0])}break;case 5:h=4,d=e.slice(t[0],t[0]+h),t[0]+=h;break;case 1:h=8,d=e.slice(t[0],t[0]+h),t[0]+=h;break;case 2:h=L0(e,t),d=e.slice(t[0],t[0]+h),t[0]+=h;break;case 3:case 4:default:throw new Error("PB Type ".concat(c," for Field ").concat(s," at offset ").concat(n))}var g={data:d,type:c};r[s]==null?r[s]=[g]:r[s].push(g)}return r}function pa(e){var r=[];return e.forEach(function(t,n){t.forEach(function(s){s.data&&(r.push(fr(n*8+s.type)),s.type==2&&r.push(fr(s.data.length)),r.push(s.data))})}),ji(r)}function Hl(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function mn(e){for(var r,t=[],n=[0];n[0]<e.length;){var s=L0(e,n),c=rr(e.slice(n[0],n[0]+s));n[0]+=s;var h={id:Ur(c[1][0].data),messages:[]};c[2].forEach(function(d){var m=rr(d.data),g=Ur(m[3][0].data);h.messages.push({meta:m,data:e.slice(n[0],n[0]+g)}),n[0]+=g}),(r=c[3])!=null&&r[0]&&(h.merge=Ur(c[3][0].data)>>>0>0),t.push(h)}return t}function Ps(e){var r=[];return e.forEach(function(t){var n=[];n[1]=[{data:fr(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:fr(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(h){s.push(h.data),h.meta[3]=[{type:0,data:fr(h.data.length)}],n[2].push({data:pa(h.meta),type:2})});var c=pa(n);r.push(fr(c.length)),r.push(c),s.forEach(function(h){return r.push(h)})}),ji(r)}function p_(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=L0(r,t),s=[];t[0]<r.length;){var c=r[t[0]]&3;if(c==0){var h=r[t[0]++]>>2;if(h<60)++h;else{var d=h-59;h=r[t[0]],d>1&&(h|=r[t[0]+1]<<8),d>2&&(h|=r[t[0]+2]<<16),d>3&&(h|=r[t[0]+3]<<24),h>>>=0,h++,t[0]+=d}s.push(r.slice(t[0],t[0]+h)),t[0]+=h;continue}else{var m=0,g=0;if(c==1?(g=(r[t[0]]>>2&7)+4,m=(r[t[0]++]&224)<<3,m|=r[t[0]++]):(g=(r[t[0]++]>>2)+1,c==2?(m=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(m=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),s=[ji(s)],m==0)throw new Error("Invalid offset 0");if(m>s[0].length)throw new Error("Invalid offset beyond length");if(g>=m)for(s.push(s[0].slice(-m)),g-=m;g>=s[s.length-1].length;)s.push(s[s.length-1]),g-=s[s.length-1].length;s.push(s[0].slice(-m,-m+g))}}var v=ji(s);if(v.length!=n)throw new Error("Unexpected length: ".concat(v.length," != ").concat(n));return v}function pn(e){for(var r=[],t=0;t<e.length;){var n=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(p_(n,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return ji(r)}function Bs(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),s=new Uint8Array(4);r.push(s);var c=fr(n),h=c.length;r.push(c),n<=60?(h++,r.push(new Uint8Array([n-1<<2]))):n<=256?(h+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(h+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(h+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(h+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e.slice(t,t+n)),h+=n,s[0]=0,s[1]=h&255,s[2]=h>>8&255,s[3]=h>>16&255,t+=n}return ji(r)}function w_(e,r,t,n){var s=ds(e),c=s.getUint32(4,!0),h=(n>1?12:8)+E1(c&(n>1?3470:398))*4,d=-1,m=-1,g=NaN,v=new Date(2001,0,1);c&512&&(d=s.getUint32(h,!0),h+=4),h+=E1(c&(n>1?12288:4096))*4,c&16&&(m=s.getUint32(h,!0),h+=4),c&32&&(g=s.getFloat64(h,!0),h+=8),c&64&&(v.setTime(v.getTime()+s.getFloat64(h,!0)*1e3),h+=8);var _;switch(e[2]){case 0:break;case 2:_={t:"n",v:g};break;case 3:_={t:"s",v:r[m]};break;case 5:_={t:"d",v};break;case 6:_={t:"b",v:g>0};break;case 7:_={t:"n",v:g/86400};break;case 8:_={t:"e",v:0};break;case 9:if(d>-1)_={t:"s",v:t[d]};else if(m>-1)_={t:"s",v:r[m]};else if(!isNaN(g))_={t:"n",v:g};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return _}function v_(e,r,t){var n=ds(e),s=n.getUint32(8,!0),c=12,h=-1,d=-1,m=NaN,g=NaN,v=new Date(2001,0,1);s&1&&(m=g_(e,c),c+=16),s&2&&(g=n.getFloat64(c,!0),c+=8),s&4&&(v.setTime(v.getTime()+n.getFloat64(c,!0)*1e3),c+=8),s&8&&(d=n.getUint32(c,!0),c+=4),s&16&&(h=n.getUint32(c,!0),c+=4);var _;switch(e[1]){case 0:break;case 2:_={t:"n",v:m};break;case 3:_={t:"s",v:r[d]};break;case 5:_={t:"d",v};break;case 6:_={t:"b",v:g>0};break;case 7:_={t:"n",v:g/86400};break;case 8:_={t:"e",v:0};break;case 9:if(h>-1)_={t:"s",v:t[h]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:_={t:"n",v:m};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return _}function Xc(e,r){var t=new Uint8Array(32),n=ds(t),s=12,c=0;switch(t[0]=5,e.t){case"n":t[1]=2,m_(t,s,e.v),c|=1,s+=16;break;case"b":t[1]=6,n.setFloat64(s,e.v?1:0,!0),c|=2,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,n.setUint32(s,r.indexOf(e.v),!0),c|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,c,!0),t.slice(0,s)}function zc(e,r){var t=new Uint8Array(32),n=ds(t),s=12,c=0;switch(t[0]=3,e.t){case"n":t[2]=2,n.setFloat64(s,e.v,!0),c|=32,s+=8;break;case"b":t[2]=6,n.setFloat64(s,e.v?1:0,!0),c|=32,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,n.setUint32(s,r.indexOf(e.v),!0),c|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,c,!0),t.slice(0,s)}function y_(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return w_(e,r,t,e[0]);case 5:return v_(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ca(e){var r=rr(e);return L0(r[1][0].data)}function _1(e,r){var t=rr(r.data),n=Ur(t[1][0].data),s=t[3],c=[];return(s||[]).forEach(function(h){var d=rr(h.data),m=Ur(d[1][0].data)>>>0;switch(n){case 1:c[m]=il(d[3][0].data);break;case 8:{var g=e[Ca(d[9][0].data)][0],v=rr(g.data),_=e[Ca(v[1][0].data)][0],C=Ur(_.meta[1][0].data);if(C!=2001)throw new Error("2000 unexpected reference to ".concat(C));var T=rr(_.data);c[m]=T[3].map(function(N){return il(N.data)}).join("")}break}}),c}function E_(e,r){var t,n,s,c,h,d,m,g,v,_,C,T,N,S,D=rr(e),U=Ur(D[1][0].data)>>>0,X=Ur(D[2][0].data)>>>0,O=((n=(t=D[8])==null?void 0:t[0])==null?void 0:n.data)&&Ur(D[8][0].data)>0||!1,q,oe;if((c=(s=D[7])==null?void 0:s[0])!=null&&c.data&&r!=0)q=(d=(h=D[7])==null?void 0:h[0])==null?void 0:d.data,oe=(g=(m=D[6])==null?void 0:m[0])==null?void 0:g.data;else if((_=(v=D[4])==null?void 0:v[0])!=null&&_.data&&r!=1)q=(T=(C=D[4])==null?void 0:C[0])==null?void 0:T.data,oe=(S=(N=D[3])==null?void 0:N[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var J=O?4:1,M=ds(q),ie=[],j=0;j<q.length/2;++j){var Ee=M.getUint16(j*2,!0);Ee<65535&&ie.push([j,Ee])}if(ie.length!=X)throw"Expected ".concat(X," cells, found ").concat(ie.length);var he=[];for(j=0;j<ie.length-1;++j)he[ie[j][0]]=oe.subarray(ie[j][1]*J,ie[j+1][1]*J);return ie.length>=1&&(he[ie[ie.length-1][0]]=oe.subarray(ie[ie.length-1][1]*J)),{R:U,cells:he}}function __(e,r){var t,n=rr(r.data),s=(t=n==null?void 0:n[7])!=null&&t[0]?Ur(n[7][0].data)>>>0>0?1:0:-1,c=Hl(n[5],function(h){return E_(h,s)});return{nrows:Ur(n[4][0].data)>>>0,data:c.reduce(function(h,d){return h[d.R]||(h[d.R]=[]),d.cells.forEach(function(m,g){if(h[d.R][g])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(g));h[d.R][g]=m}),h},[])}}function A_(e,r,t){var n,s=rr(r.data),c={s:{r:0,c:0},e:{r:0,c:0}};if(c.e.r=(Ur(s[6][0].data)>>>0)-1,c.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(c.e.c=(Ur(s[7][0].data)>>>0)-1,c.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=jt(c);var h=rr(s[4][0].data),d=_1(e,e[Ca(h[4][0].data)][0]),m=(n=h[17])!=null&&n[0]?_1(e,e[Ca(h[17][0].data)][0]):[],g=rr(h[3][0].data),v=0;g[1].forEach(function(_){var C=rr(_.data),T=e[Ca(C[2][0].data)][0],N=Ur(T.meta[1][0].data);if(N!=6002)throw new Error("6001 unexpected reference to ".concat(N));var S=__(e,T);S.data.forEach(function(D,U){D.forEach(function(X,O){var q=Ct({r:v+U,c:O}),oe=y_(X,d,m);oe&&(t[q]=oe)})}),v+=S.nrows})}function b_(e,r){var t=rr(r.data),n={"!ref":"A1"},s=e[Ca(t[2][0].data)],c=Ur(s[0].meta[1][0].data);if(c!=6001)throw new Error("6000 unexpected reference to ".concat(c));return A_(e,s[0],n),n}function S_(e,r){var t,n=rr(r.data),s={name:(t=n[1])!=null&&t[0]?il(n[1][0].data):"",sheets:[]},c=Hl(n[2],Ca);return c.forEach(function(h){e[h].forEach(function(d){var m=Ur(d.meta[1][0].data);m==6e3&&s.sheets.push(b_(e,d))})}),s}function C_(e,r){var t=Kl(),n=rr(r.data),s=Hl(n[1],Ca);if(s.forEach(function(c){e[c].forEach(function(h){var d=Ur(h.meta[1][0].data);if(d==2){var m=S_(e,h);m.sheets.forEach(function(g,v){ql(t,g,v==0?m.name:m.name+"_"+v,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Yc(e){var r,t,n,s,c={},h=[];if(e.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var g;try{g=pn(m.content)}catch(_){return console.log("?? "+m.content.length+" "+(_.message||_))}var v;try{v=mn(g)}catch(_){return console.log("## "+(_.message||_))}v.forEach(function(_){c[_.id]=_.messages,h.push(_.id)})}}),!h.length)throw new Error("File has no messages");var d=((s=(n=(t=(r=c==null?void 0:c[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Ur(c[1][0].meta[1][0].data)==1&&c[1][0];if(d||h.forEach(function(m){c[m].forEach(function(g){var v=Ur(g.meta[1][0].data)>>>0;if(v==1)if(!d)d=g;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return C_(c,d)}function T_(e,r,t){var n,s,c,h;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var d=((h=(c=e[8])==null?void 0:c[0])==null?void 0:h.data)&&Ur(e[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var m=0,g=ds(e[7][0].data),v=0,_=[],C=ds(e[4][0].data),T=0,N=[],S=0;S<r.length;++S){if(r[S]==null){g.setUint16(S*2,65535,!0),C.setUint16(S*2,65535);continue}g.setUint16(S*2,v,!0),C.setUint16(S*2,T,!0);var D,U;switch(typeof r[S]){case"string":D=Xc({t:"s",v:r[S]},t),U=zc({t:"s",v:r[S]},t);break;case"number":D=Xc({t:"n",v:r[S]},t),U=zc({t:"n",v:r[S]},t);break;case"boolean":D=Xc({t:"b",v:r[S]},t),U=zc({t:"b",v:r[S]},t);break;default:throw new Error("Unsupported value "+r[S])}_.push(D),v+=D.length,N.push(U),T+=U.length,++m}for(e[2][0].data=fr(m);S<e[7][0].data.length/2;++S)g.setUint16(S*2,65535,!0),C.setUint16(S*2,65535,!0);return e[6][0].data=ji(_),e[3][0].data=ji(N),m}function N_(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=za(t["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(jt(n)));var c=Qo(t,{range:n,header:1}),h=["~Sh33tJ5~"];c.forEach(function(ce){return ce.forEach(function(ee){typeof ee=="string"&&h.push(ee)})});var d={},m=[],g=mt.read(r.numbers,{type:"base64"});g.FileIndex.map(function(ce,ee){return[ce,g.FullPaths[ee]]}).forEach(function(ce){var ee=ce[0],ne=ce[1];if(ee.type==2&&ee.name.match(/\.iwa/)){var le=ee.content,qe=pn(le),Le=mn(qe);Le.forEach(function(Pe){m.push(Pe.id),d[Pe.id]={deps:[],location:ne,type:Ur(Pe.messages[0].meta[1][0].data)}})}}),m.sort(function(ce,ee){return ce-ee});var v=m.filter(function(ce){return ce>1}).map(function(ce){return[ce,fr(ce)]});g.FileIndex.map(function(ce,ee){return[ce,g.FullPaths[ee]]}).forEach(function(ce){var ee=ce[0];if(ce[1],!!ee.name.match(/\.iwa/)){var ne=mn(pn(ee.content));ne.forEach(function(le){le.messages.forEach(function(qe){v.forEach(function(Le){le.messages.some(function(Pe){return Ur(Pe.meta[1][0].data)!=11006&&x_(Pe.data,Le[1])})&&d[Le[0]].deps.push(le.id)})})})}});for(var _=mt.find(g,d[1].location),C=mn(pn(_.content)),T,N=0;N<C.length;++N){var S=C[N];S.id==1&&(T=S)}var D=Ca(rr(T.messages[0].data)[1][0].data);for(_=mt.find(g,d[D].location),C=mn(pn(_.content)),N=0;N<C.length;++N)S=C[N],S.id==D&&(T=S);for(D=Ca(rr(T.messages[0].data)[2][0].data),_=mt.find(g,d[D].location),C=mn(pn(_.content)),N=0;N<C.length;++N)S=C[N],S.id==D&&(T=S);for(D=Ca(rr(T.messages[0].data)[2][0].data),_=mt.find(g,d[D].location),C=mn(pn(_.content)),N=0;N<C.length;++N)S=C[N],S.id==D&&(T=S);var U=rr(T.messages[0].data);{U[6][0].data=fr(n.e.r+1),U[7][0].data=fr(n.e.c+1);var X=Ca(U[46][0].data),O=mt.find(g,d[X].location),q=mn(pn(O.content));{for(var oe=0;oe<q.length&&q[oe].id!=X;++oe);if(q[oe].id!=X)throw"Bad ColumnRowUIDMapArchive";var J=rr(q[oe].messages[0].data);J[1]=[],J[2]=[],J[3]=[];for(var M=0;M<=n.e.c;++M){var ie=[];ie[1]=ie[2]=[{type:0,data:fr(M+420690)}],J[1].push({type:2,data:pa(ie)}),J[2].push({type:0,data:fr(M)}),J[3].push({type:0,data:fr(M)})}J[4]=[],J[5]=[],J[6]=[];for(var j=0;j<=n.e.r;++j)ie=[],ie[1]=ie[2]=[{type:0,data:fr(j+726270)}],J[4].push({type:2,data:pa(ie)}),J[5].push({type:0,data:fr(j)}),J[6].push({type:0,data:fr(j)});q[oe].messages[0].data=pa(J)}O.content=Bs(Ps(q)),O.size=O.content.length,delete U[46];var Ee=rr(U[4][0].data);{Ee[7][0].data=fr(n.e.r+1);var he=rr(Ee[1][0].data),te=Ca(he[2][0].data);O=mt.find(g,d[te].location),q=mn(pn(O.content));{if(q[0].id!=te)throw"Bad HeaderStorageBucket";var be=rr(q[0].messages[0].data);for(j=0;j<c.length;++j){var $e=rr(be[2][0].data);$e[1][0].data=fr(j),$e[4][0].data=fr(c[j].length),be[2][j]={type:be[2][0].type,data:pa($e)}}q[0].messages[0].data=pa(be)}O.content=Bs(Ps(q)),O.size=O.content.length;var ae=Ca(Ee[2][0].data);O=mt.find(g,d[ae].location),q=mn(pn(O.content));{if(q[0].id!=ae)throw"Bad HeaderStorageBucket";for(be=rr(q[0].messages[0].data),M=0;M<=n.e.c;++M)$e=rr(be[2][0].data),$e[1][0].data=fr(M),$e[4][0].data=fr(n.e.r+1),be[2][M]={type:be[2][0].type,data:pa($e)};q[0].messages[0].data=pa(be)}O.content=Bs(Ps(q)),O.size=O.content.length;var tt=Ca(Ee[4][0].data);(function(){for(var ce=mt.find(g,d[tt].location),ee=mn(pn(ce.content)),ne,le=0;le<ee.length;++le){var qe=ee[le];qe.id==tt&&(ne=qe)}var Le=rr(ne.messages[0].data);{Le[3]=[];var Pe=[];h.forEach(function(A,Y){Pe[1]=[{type:0,data:fr(Y)}],Pe[2]=[{type:0,data:fr(1)}],Pe[3]=[{type:2,data:d_(A)}],Le[3].push({type:2,data:pa(Pe)})})}ne.messages[0].data=pa(Le);var Be=Ps(ee),Te=Bs(Be);ce.content=Te,ce.size=ce.content.length})();var Re=rr(Ee[3][0].data);{var Ut=Re[1][0];delete Re[2];var fe=rr(Ut.data);{var ot=Ca(fe[2][0].data);(function(){for(var ce=mt.find(g,d[ot].location),ee=mn(pn(ce.content)),ne,le=0;le<ee.length;++le){var qe=ee[le];qe.id==ot&&(ne=qe)}var Le=rr(ne.messages[0].data);{delete Le[6],delete Re[7];var Pe=new Uint8Array(Le[5][0].data);Le[5]=[];for(var Be=0,Te=0;Te<=n.e.r;++Te){var A=rr(Pe);Be+=T_(A,c[Te],h),A[1][0].data=fr(Te),Le[5].push({data:pa(A),type:2})}Le[1]=[{type:0,data:fr(n.e.c+1)}],Le[2]=[{type:0,data:fr(n.e.r+1)}],Le[3]=[{type:0,data:fr(Be)}],Le[4]=[{type:0,data:fr(n.e.r+1)}]}ne.messages[0].data=pa(Le);var Y=Ps(ee),ht=Bs(Y);ce.content=ht,ce.size=ce.content.length})()}Ut.data=pa(fe)}Ee[3][0].data=pa(Re)}U[4][0].data=pa(Ee)}T.messages[0].data=pa(U);var pt=Ps(C),K=Bs(pt);return _.content=K,_.size=_.content.length,g}function Bu(e){return function(t){for(var n=0;n!=e.length;++n){var s=e[n];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function Gl(e){Bu([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Xl(e){Bu([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function k_(e){return zt.WS.indexOf(e)>-1?"sheet":e==zt.CS?"chart":e==zt.DS?"dialog":e==zt.MS?"macro":e&&e.length?e:"sheet"}function I_(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,k_(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function D_(e,r,t,n,s,c,h,d,m,g,v,_){try{c[n]=E0(on(e,t,!0),r);var C=$r(e,r),T;switch(d){case"sheet":T=$4(C,r,s,m,c[n],g,v,_);break;case"chart":if(T=eE(C,r,s,m,c[n],g,v,_),!T||!T["!drawel"])break;var N=p0(T["!drawel"].Target,r),S=F0(N),D=Uw(on(e,N,!0),E0(on(e,S,!0),N)),U=p0(D,N),X=F0(U);T=T4(on(e,U,!0),U,m,E0(on(e,X,!0),U),g,T);break;case"macro":T=tE(C,r,s,m,c[n],g,v,_);break;case"dialog":T=rE(C,r,s,m,c[n],g,v,_);break;default:throw new Error("Unrecognized sheet type "+d)}h[n]=T;var O=[];c&&c[n]&&Wr(c[n]).forEach(function(q){var oe="";if(c[n][q].Type==zt.CMNT){oe=p0(c[n][q].Target,r);var J=sE($r(e,oe,!0),oe,m);if(!J||!J.length)return;o1(T,J,!1)}c[n][q].Type==zt.TCMNT&&(oe=p0(c[n][q].Target,r),O=O.concat(Vw($r(e,oe,!0),m)))}),O&&O.length&&o1(T,O,!0,m.people||[])}catch(q){if(m.WTF)throw q}}function xn(e){return e.charAt(0)=="/"?e.slice(1):e}function F_(e,r){if(qs(),r=r||{},Gl(r),wn(e,"META-INF/manifest.xml")||wn(e,"objectdata.xml"))return w1(e,r);if(wn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Yc<"u"){if(e.FileIndex)return Yc(e);var t=mt.utils.cfb_new();return Nf(e).forEach(function($e){Vt(t,$e,Hx(e,$e))}),Yc(t)}throw new Error("Unsupported NUMBERS file")}if(!wn(e,"[Content_Types].xml"))throw wn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):wn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Nf(e),s=Pg(on(e,"[Content_Types].xml")),c=!1,h,d;if(s.workbooks.length===0&&(d="xl/workbook.xml",$r(e,d,!0)&&s.workbooks.push(d)),s.workbooks.length===0){if(d="xl/workbook.bin",!$r(e,d,!0))throw new Error("Could not find workbook");s.workbooks.push(d),c=!0}s.workbooks[0].slice(-3)=="bin"&&(c=!0);var m={},g={};if(!r.bookSheets&&!r.bookProps){if(_0=[],s.sst)try{_0=iE($r(e,xn(s.sst)),s.sst,r)}catch($e){if(r.WTF)throw $e}r.cellStyles&&s.themes.length&&(m=nE(on(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],r)),s.style&&(g=aE($r(e,xn(s.style)),s.style,m,r))}s.links.map(function($e){try{var ae=E0(on(e,F0(xn($e))),$e);return cE($r(e,xn($e)),ae,$e,r)}catch{}});var v=Q4($r(e,xn(s.workbooks[0])),s.workbooks[0],r),_={},C="";s.coreprops.length&&(C=$r(e,xn(s.coreprops[0]),!0),C&&(_=Sh(C)),s.extprops.length!==0&&(C=$r(e,xn(s.extprops[0]),!0),C&&Hg(C,_,r)));var T={};(!r.bookSheets||r.bookProps)&&s.custprops.length!==0&&(C=on(e,xn(s.custprops[0]),!0),C&&(T=Xg(C,r)));var N={};if((r.bookSheets||r.bookProps)&&(v.Sheets?h=v.Sheets.map(function(ae){return ae.name}):_.Worksheets&&_.SheetNames.length>0&&(h=_.SheetNames),r.bookProps&&(N.Props=_,N.Custprops=T),r.bookSheets&&typeof h<"u"&&(N.SheetNames=h),r.bookSheets?N.SheetNames:r.bookProps))return N;h={};var S={};r.bookDeps&&s.calcchain&&(S=oE($r(e,xn(s.calcchain)),s.calcchain));var D=0,U={},X,O;{var q=v.Sheets;_.Worksheets=q.length,_.SheetNames=[];for(var oe=0;oe!=q.length;++oe)_.SheetNames[oe]=q[oe].name}var J=c?"bin":"xml",M=s.workbooks[0].lastIndexOf("/"),ie=(s.workbooks[0].slice(0,M+1)+"_rels/"+s.workbooks[0].slice(M+1)+".rels").replace(/^\//,"");wn(e,ie)||(ie="xl/_rels/workbook."+J+".rels");var j=E0(on(e,ie,!0),ie.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(r.xlmeta=lE($r(e,xn(s.metadata[0])),s.metadata[0],r)),(s.people||[]).length>=1&&(r.people=Gw($r(e,xn(s.people[0])),r)),j&&(j=I_(j,v.Sheets));var Ee=$r(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(D=0;D!=_.Worksheets;++D){var he="sheet";if(j&&j[D]?(X="xl/"+j[D][1].replace(/[\/]?xl\//,""),wn(e,X)||(X=j[D][1]),wn(e,X)||(X=ie.replace(/_rels\/.*$/,"")+j[D][1]),he=j[D][2]):(X="xl/worksheets/sheet"+(D+1-Ee)+"."+J,X=X.replace(/sheet0\./,"sheet.")),O=X.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(D!=r.sheets)continue e;break;case"string":if(_.SheetNames[D].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var te=!1,be=0;be!=r.sheets.length;++be)typeof r.sheets[be]=="number"&&r.sheets[be]==D&&(te=1),typeof r.sheets[be]=="string"&&r.sheets[be].toLowerCase()==_.SheetNames[D].toLowerCase()&&(te=1);if(!te)continue e}}D_(e,X,O,_.SheetNames[D],D,U,h,he,r,v,m,g)}return N={Directory:s,Workbook:v,Props:_,Custprops:T,Deps:S,Sheets:h,SheetNames:_.SheetNames,Strings:_0,Styles:g,Themes:m,SSF:Ir(bt)},r&&r.bookFiles&&(e.files?(N.keys=n,N.files=e.files):(N.keys=[],N.files={},e.FullPaths.forEach(function($e,ae){$e=$e.replace(/^Root Entry[\/]/,""),N.keys.push($e),N.files[$e]=e.FileIndex[ae]}))),r&&r.bookVBA&&(s.vba.length>0?N.vbaraw=$r(e,xn(s.vba[0]),!0):s.defaults&&s.defaults.bin===Qw&&(N.vbaraw=$r(e,"xl/vbaProject.bin",!0))),N}function O_(e,r){var t=r||{},n="Workbook",s=mt.find(e,n);try{if(n="/!DataSpaces/Version",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(lp(s.content),n="/!DataSpaces/DataSpaceMap",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=hp(s.content);if(c.length!==1||c[0].comps.length!==1||c[0].comps[0].t!==0||c[0].name!=="StrongEncryptionDataSpace"||c[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var h=up(s.content);if(h.length!=1||h[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);xp(s.content)}catch{}if(n="/EncryptionInfo",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var d=gp(s.content);if(n="/EncryptedPackage",s=mt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],s.content,t.password||"",t);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],s.content,t.password||"",t);throw new Error("File is password-protected")}function R_(e,r){return r.bookType=="ods"?Pu(e,r):r.bookType=="numbers"?N_(e,r):r.bookType=="xlsb"?M_(e,r):P_(e,r)}function M_(e,r){js=1024,e&&!e.SSF&&(e.SSF=Ir(bt)),e&&e.SSF&&(qs(),ac(e.SSF),r.revssf=ic(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,A0?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",n=fu.indexOf(r.bookType)>-1,s=Il();Xl(r=r||{});var c=ml(),h="",d=0;if(r.cellXfs=[],Vi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),h="docProps/core.xml",Vt(c,h,Ch(e.Props,r)),s.coreprops.push(h),hr(r.rels,2,h,zt.CORE_PROPS),h="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],g=0;g<e.SheetNames.length;++g)(e.Workbook.Sheets[g]||{}).Hidden!=2&&m.push(e.SheetNames[g]);e.Props.SheetNames=m}for(e.Props.Worksheets=e.Props.SheetNames.length,Vt(c,h,kh(e.Props)),s.extprops.push(h),hr(r.rels,3,h,zt.EXT_PROPS),e.Custprops!==e.Props&&Wr(e.Custprops||{}).length>0&&(h="docProps/custom.xml",Vt(c,h,Ih(e.Custprops)),s.custprops.push(h),hr(r.rels,4,h,zt.CUST_PROPS)),d=1;d<=e.SheetNames.length;++d){var v={"!id":{}},_=e.Sheets[e.SheetNames[d-1]],C=(_||{})["!type"]||"sheet";switch(C){case"chart":default:h="xl/worksheets/sheet"+d+"."+t,Vt(c,h,hE(d-1,h,r,e,v)),s.sheets.push(h),hr(r.wbrels,-1,"worksheets/sheet"+d+"."+t,zt.WS[0])}if(_){var T=_["!comments"],N=!1,S="";T&&T.length>0&&(S="xl/comments"+d+"."+t,Vt(c,S,xE(T,S)),s.comments.push(S),hr(v,-1,"../comments"+d+"."+t,zt.CMNT),N=!0),_["!legacy"]&&N&&Vt(c,"xl/drawings/vmlDrawing"+d+".vml",cu(d,_["!comments"])),delete _["!comments"],delete _["!legacy"]}v["!id"].rId1&&Vt(c,F0(h),Vs(v))}return r.Strings!=null&&r.Strings.length>0&&(h="xl/sharedStrings."+t,Vt(c,h,dE(r.Strings,h,r)),s.strs.push(h),hr(r.wbrels,-1,"sharedStrings."+t,zt.SST)),h="xl/workbook."+t,Vt(c,h,fE(e,h)),s.workbooks.push(h),hr(r.rels,1,h,zt.WB),h="xl/theme/theme1.xml",Vt(c,h,Pl(e.Themes,r)),s.themes.push(h),hr(r.wbrels,-1,"theme/theme1.xml",zt.THEME),h="xl/styles."+t,Vt(c,h,uE(e,h,r)),s.styles.push(h),hr(r.wbrels,-1,"styles."+t,zt.STY),e.vbaraw&&n&&(h="xl/vbaProject.bin",Vt(c,h,e.vbaraw),s.vba.push(h),hr(r.wbrels,-1,"vbaProject.bin",zt.VBA)),h="xl/metadata."+t,Vt(c,h,gE(h)),s.metadata.push(h),hr(r.wbrels,-1,"metadata."+t,zt.XLMETA),Vt(c,"[Content_Types].xml",Ah(s,r)),Vt(c,"_rels/.rels",Vs(r.rels)),Vt(c,"xl/_rels/workbook."+t+".rels",Vs(r.wbrels)),delete r.revssf,delete r.ssf,c}function P_(e,r){js=1024,e&&!e.SSF&&(e.SSF=Ir(bt)),e&&e.SSF&&(qs(),ac(e.SSF),r.revssf=ic(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,A0?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=fu.indexOf(r.bookType)>-1,s=Il();Xl(r=r||{});var c=ml(),h="",d=0;if(r.cellXfs=[],Vi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),h="docProps/core.xml",Vt(c,h,Ch(e.Props,r)),s.coreprops.push(h),hr(r.rels,2,h,zt.CORE_PROPS),h="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],g=0;g<e.SheetNames.length;++g)(e.Workbook.Sheets[g]||{}).Hidden!=2&&m.push(e.SheetNames[g]);e.Props.SheetNames=m}e.Props.Worksheets=e.Props.SheetNames.length,Vt(c,h,kh(e.Props)),s.extprops.push(h),hr(r.rels,3,h,zt.EXT_PROPS),e.Custprops!==e.Props&&Wr(e.Custprops||{}).length>0&&(h="docProps/custom.xml",Vt(c,h,Ih(e.Custprops)),s.custprops.push(h),hr(r.rels,4,h,zt.CUST_PROPS));var v=["SheetJ5"];for(r.tcid=0,d=1;d<=e.SheetNames.length;++d){var _={"!id":{}},C=e.Sheets[e.SheetNames[d-1]],T=(C||{})["!type"]||"sheet";switch(T){case"chart":default:h="xl/worksheets/sheet"+d+"."+t,Vt(c,h,Eu(d-1,r,e,_)),s.sheets.push(h),hr(r.wbrels,-1,"worksheets/sheet"+d+"."+t,zt.WS[0])}if(C){var N=C["!comments"],S=!1,D="";if(N&&N.length>0){var U=!1;N.forEach(function(X){X[1].forEach(function(O){O.T==!0&&(U=!0)})}),U&&(D="xl/threadedComments/threadedComment"+d+"."+t,Vt(c,D,Hw(N,v,r)),s.threadedcomments.push(D),hr(_,-1,"../threadedComments/threadedComment"+d+"."+t,zt.TCMNT)),D="xl/comments"+d+"."+t,Vt(c,D,lu(N)),s.comments.push(D),hr(_,-1,"../comments"+d+"."+t,zt.CMNT),S=!0}C["!legacy"]&&S&&Vt(c,"xl/drawings/vmlDrawing"+d+".vml",cu(d,C["!comments"])),delete C["!comments"],delete C["!legacy"]}_["!id"].rId1&&Vt(c,F0(h),Vs(_))}return r.Strings!=null&&r.Strings.length>0&&(h="xl/sharedStrings."+t,Vt(c,h,Zh(r.Strings,r)),s.strs.push(h),hr(r.wbrels,-1,"sharedStrings."+t,zt.SST)),h="xl/workbook."+t,Vt(c,h,Cu(e)),s.workbooks.push(h),hr(r.rels,1,h,zt.WB),h="xl/theme/theme1.xml",Vt(c,h,Pl(e.Themes,r)),s.themes.push(h),hr(r.wbrels,-1,"theme/theme1.xml",zt.THEME),h="xl/styles."+t,Vt(c,h,nu(e,r)),s.styles.push(h),hr(r.wbrels,-1,"styles."+t,zt.STY),e.vbaraw&&n&&(h="xl/vbaProject.bin",Vt(c,h,e.vbaraw),s.vba.push(h),hr(r.wbrels,-1,"vbaProject.bin",zt.VBA)),h="xl/metadata."+t,Vt(c,h,ou()),s.metadata.push(h),hr(r.wbrels,-1,"metadata."+t,zt.XLMETA),v.length>1&&(h="xl/persons/person.xml",Vt(c,h,Xw(v)),s.people.push(h),hr(r.wbrels,-1,"persons/person.xml",zt.PEOPLE)),Vt(c,"[Content_Types].xml",Ah(s,r)),Vt(c,"_rels/.rels",Vs(r.rels)),Vt(c,"xl/_rels/workbook."+t+".rels",Vs(r.wbrels)),delete r.revssf,delete r.ssf,c}function zl(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=cn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function B_(e,r){return mt.find(e,"EncryptedPackage")?O_(e,r):Iu(e,r)}function L_(e,r){var t,n=e,s=r||{};return s.type||(s.type=Gt&&Buffer.isBuffer(e)?"buffer":"base64"),t=Q1(n,s),F_(t,s)}function Lu(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return al(e.slice(t),r);default:break e}return zs.to_workbook(e,r)}function j_(e,r){var t="",n=zl(e,r);switch(r.type){case"base64":t=cn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=ls(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=mr(t)),r.type="binary",Lu(t,r)}function U_(e,r){var t=e;return r.type=="base64"&&(t=cn(t)),t=C0.utils.decode(1200,t.slice(2),"str"),r.type="binary",Lu(t,r)}function W_(e){return e.match(/[^\x00-\x7F]/)?Zn(e):e}function Kc(e,r,t,n){return n?(t.type="string",zs.to_workbook(e,t)):zs.to_workbook(r,t)}function sl(e,r){hl();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return sl(new Uint8Array(e),(t=Ir(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],c=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Gs={},t.dateNF&&(Gs.dateNF=t.dateNF),t.type||(t.type=Gt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Gt?"buffer":"binary",n=Mx(e),typeof Uint8Array<"u"&&!Gt&&(t.type="array")),t.type=="string"&&(c=!0,t.type="binary",t.codepage=65001,n=W_(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var h=new ArrayBuffer(3),d=new Uint8Array(h);if(d.foo="bar",!d.foo)return t=Ir(t),t.type="array",sl(ul(n),t)}switch((s=zl(n,t))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return B_(mt.read(n,t),t);break;case 9:if(s[1]<=8)return Iu(n,t);break;case 60:return al(n,t);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return zm(n,t);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Kh.to_workbook(n,t);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?L_(n,t):Kc(e,n,t,c);case 239:return s[3]===60?al(n,t):Kc(e,n,t,c);case 255:if(s[1]===254)return U_(n,t);if(s[1]===0&&s[2]===2&&s[3]===0)return ss.to_workbook(n,t);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ss.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return rl.to_workbook(n,t);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return tu.to_workbook(n,t);break;case 10:case 13:case 32:return j_(n,t);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Xm.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?rl.to_workbook(n,t):Kc(e,n,t,c)}function ju(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return U0(r.file,mt.write(e,{type:Gt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return mt.write(e,r)}function V_(e,r){var t=Ir(r||{}),n=R_(e,t);return H_(n,t)}function H_(e,r){var t={},n=Gt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var s=e.FullPaths?mt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(r.type=="binary"||r.type=="base64")return s;s=new Uint8Array(rc(s))}return r.password&&typeof encrypt_agile<"u"?ju(encrypt_agile(s,r.password),r):r.type==="file"?U0(r.file,s):r.type=="string"?mr(s):s}function G_(e,r){var t=r||{},n=WE(e,t);return ju(n,t)}function qn(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return T0(Zn(n));case"binary":return Zn(n);case"string":return e;case"file":return U0(r.file,n,"utf8");case"buffer":return Gt?mi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):qn(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function X_(e,r){switch(r.type){case"base64":return T0(e);case"binary":return e;case"string":return e;case"file":return U0(r.file,e,"binary");case"buffer":return Gt?mi(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Po(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?T0(t):r.type=="string"?mr(t):t;case"file":return U0(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function Uu(e,r){hl(),B4(e);var t=Ir(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=Uu(e,t);return t.type="array",rc(n)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=e.SheetNames.indexOf(t.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return qn(RE(e,t),t);case"slk":case"sylk":return qn(Yh.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"htm":case"html":return qn(Fu(e.Sheets[e.SheetNames[s]],t),t);case"txt":return X_(Wu(e.Sheets[e.SheetNames[s]],t),t);case"csv":return qn(Yl(e.Sheets[e.SheetNames[s]],t),t,"\uFEFF");case"dif":return qn(Kh.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"dbf":return Po(rl.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"prn":return qn(zs.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"rtf":return qn(tu.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"eth":return qn(qh.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"fods":return qn(Pu(e,t),t);case"wk1":return Po(ss.sheet_to_wk1(e.Sheets[e.SheetNames[s]],t),t);case"wk3":return Po(ss.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Po(Du(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),G_(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return V_(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function z_(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function Y_(e,r,t){var n={};return n.type="file",n.file=r,z_(n),Uu(e,n)}function K_(e,r,t,n,s,c,h,d){var m=zr(t),g=d.defval,v=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),_=!0,C=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(C,"__rowNum__",{value:t,enumerable:!1})}catch{C.__rowNum__=t}else C.__rowNum__=t;if(!h||e[t])for(var T=r.s.c;T<=r.e.c;++T){var N=h?e[t][T]:e[n[T]+m];if(N===void 0||N.t===void 0){if(g===void 0)continue;c[T]!=null&&(C[c[T]]=g);continue}var S=N.v;switch(N.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+N.t)}if(c[T]!=null){if(S==null)if(N.t=="e"&&S===null)C[c[T]]=null;else if(g!==void 0)C[c[T]]=g;else if(v&&S===null)C[c[T]]=null;else continue;else C[c[T]]=v&&(N.t!=="n"||N.t==="n"&&d.rawNumbers!==!1)?S:gi(N,S,d);S!=null&&(_=!1)}}return{row:C,isempty:_}}function Qo(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,s=1,c=[],h=0,d="",m={s:{r:0,c:0},e:{r:0,c:0}},g=r||{},v=g.range!=null?g.range:e["!ref"];switch(g.header===1?n=1:g.header==="A"?n=2:Array.isArray(g.header)?n=3:g.header==null&&(n=0),typeof v){case"string":m=er(v);break;case"number":m=er(e["!ref"]),m.s.r=v;break;default:m=v}n>0&&(s=0);var _=zr(m.s.r),C=[],T=[],N=0,S=0,D=Array.isArray(e),U=m.s.r,X=0,O={};D&&!e[U]&&(e[U]=[]);var q=g.skipHidden&&e["!cols"]||[],oe=g.skipHidden&&e["!rows"]||[];for(X=m.s.c;X<=m.e.c;++X)if(!(q[X]||{}).hidden)switch(C[X]=Pr(X),t=D?e[U][X]:e[C[X]+_],n){case 1:c[X]=X-m.s.c;break;case 2:c[X]=C[X];break;case 3:c[X]=g.header[X-m.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),d=h=gi(t,null,g),S=O[h]||0,!S)O[h]=1;else{do d=h+"_"+S++;while(O[d]);O[h]=S,O[d]=1}c[X]=d}for(U=m.s.r+s;U<=m.e.r;++U)if(!(oe[U]||{}).hidden){var J=K_(e,m,U,C,n,c,D,g);(J.isempty===!1||(n===1?g.blankrows!==!1:g.blankrows))&&(T[N++]=J.row)}return T.length=N,T}var A1=/"/g;function q_(e,r,t,n,s,c,h,d){for(var m=!0,g=[],v="",_=zr(t),C=r.s.c;C<=r.e.c;++C)if(n[C]){var T=d.dense?(e[t]||[])[C]:e[n[C]+_];if(T==null)v="";else if(T.v!=null){m=!1,v=""+(d.rawNumbers&&T.t=="n"?T.v:gi(T,null,d));for(var N=0,S=0;N!==v.length;++N)if((S=v.charCodeAt(N))===s||S===c||S===34||d.forceQuotes){v='"'+v.replace(A1,'""')+'"';break}v=="ID"&&(v='"ID"')}else T.f!=null&&!T.F?(m=!1,v="="+T.f,v.indexOf(",")>=0&&(v='"'+v.replace(A1,'""')+'"')):v="";g.push(v)}return d.blankrows===!1&&m?null:g.join(h)}function Yl(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var s=er(e["!ref"]),c=n.FS!==void 0?n.FS:",",h=c.charCodeAt(0),d=n.RS!==void 0?n.RS:`
`,m=d.charCodeAt(0),g=new RegExp((c=="|"?"\\|":c)+"+$"),v="",_=[];n.dense=Array.isArray(e);for(var C=n.skipHidden&&e["!cols"]||[],T=n.skipHidden&&e["!rows"]||[],N=s.s.c;N<=s.e.c;++N)(C[N]||{}).hidden||(_[N]=Pr(N));for(var S=0,D=s.s.r;D<=s.e.r;++D)(T[D]||{}).hidden||(v=q_(e,s,D,_,h,m,c,n),v!=null&&(n.strip&&(v=v.replace(g,"")),(v||n.blankrows!==!1)&&t.push((S++?d:"")+v)));return delete n.dense,t.join("")}function Wu(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Yl(e,r);return t}function Z_(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var s=er(e["!ref"]),c="",h=[],d,m=[],g=Array.isArray(e);for(d=s.s.c;d<=s.e.c;++d)h[d]=Pr(d);for(var v=s.s.r;v<=s.e.r;++v)for(c=zr(v),d=s.s.c;d<=s.e.c;++d)if(r=h[d]+c,t=g?(e[v]||[])[d]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}m[m.length]=r+"="+n}return m}function Vu(e,r,t){var n=t||{},s=+!n.skipHeader,c=e||{},h=0,d=0;if(c&&n.origin!=null)if(typeof n.origin=="number")h=n.origin;else{var m=typeof n.origin=="string"?Br(n.origin):n.origin;h=m.r,d=m.c}var g,v={s:{c:0,r:0},e:{c:d,r:h+r.length-1+s}};if(c["!ref"]){var _=er(c["!ref"]);v.e.c=Math.max(v.e.c,_.e.c),v.e.r=Math.max(v.e.r,_.e.r),h==-1&&(h=_.e.r+1,v.e.r=h+r.length-1+s)}else h==-1&&(h=0,v.e.r=r.length-1+s);var C=n.header||[],T=0;r.forEach(function(S,D){Wr(S).forEach(function(U){(T=C.indexOf(U))==-1&&(C[T=C.length]=U);var X=S[U],O="z",q="",oe=Ct({c:d+T,r:h+D+s});g=j0(c,oe),X&&typeof X=="object"&&!(X instanceof Date)?c[oe]=X:(typeof X=="number"?O="n":typeof X=="boolean"?O="b":typeof X=="string"?O="s":X instanceof Date?(O="d",n.cellDates||(O="n",X=ia(X)),q=n.dateNF||bt[14]):X===null&&n.nullError&&(O="e",X=0),g?(g.t=O,g.v=X,delete g.w,delete g.R,q&&(g.z=q)):c[oe]=g={t:O,v:X},q&&(g.z=q))})}),v.e.c=Math.max(v.e.c,d+C.length-1);var N=zr(h);if(s)for(T=0;T<C.length;++T)c[Pr(T+d)+N]={t:"s",v:C[T]};return c["!ref"]=jt(v),c}function J_(e,r){return Vu(null,e,r)}function j0(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Br(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?j0(e,Ct(r)):j0(e,Ct({r,c:t||0}))}function Q_(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Kl(){return{SheetNames:[],Sheets:{}}}function ql(e,r,t,n){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var c=t.match(/(^.*?)(\d+)$/);s=c&&+c[2]||0;var h=c&&c[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=h+s)!=-1;++s);}if(Su(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function $_(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Q_(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function e8(e,r){return e.z=r,e}function Hu(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function t8(e,r,t){return Hu(e,"#"+r,t)}function r8(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function a8(e,r,t,n){for(var s=typeof r!="string"?r:er(r),c=typeof r=="string"?r:jt(r),h=s.s.r;h<=s.e.r;++h)for(var d=s.s.c;d<=s.e.c;++d){var m=j0(e,h,d);m.t="n",m.F=c,delete m.v,h==s.s.r&&d==s.s.c&&(m.f=t,n&&(m.D=!0))}return e}var Bo={encode_col:Pr,encode_row:zr,encode_cell:Ct,encode_range:jt,decode_col:bl,decode_row:Al,split_cell:dg,decode_cell:Br,decode_range:za,format_cell:gi,sheet_add_aoa:mh,sheet_add_json:Vu,sheet_add_dom:Ou,aoa_to_sheet:Zs,json_to_sheet:J_,table_to_sheet:Ru,table_to_book:l_,sheet_to_csv:Yl,sheet_to_txt:Wu,sheet_to_json:Qo,sheet_to_html:Fu,sheet_to_formulae:Z_,sheet_to_row_object_array:Qo,sheet_get_cell:j0,book_new:Kl,book_append_sheet:ql,book_set_sheet_visibility:$_,cell_set_number_format:e8,cell_set_hyperlink:Hu,cell_set_internal_link:t8,cell_add_comment:r8,sheet_set_array_formula:a8,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},ct;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ct||(ct={}));var b1=new Map([[ct.QR_CODE,"QR_CODE"],[ct.AZTEC,"AZTEC"],[ct.CODABAR,"CODABAR"],[ct.CODE_39,"CODE_39"],[ct.CODE_93,"CODE_93"],[ct.CODE_128,"CODE_128"],[ct.DATA_MATRIX,"DATA_MATRIX"],[ct.MAXICODE,"MAXICODE"],[ct.ITF,"ITF"],[ct.EAN_13,"EAN_13"],[ct.EAN_8,"EAN_8"],[ct.PDF_417,"PDF_417"],[ct.RSS_14,"RSS_14"],[ct.RSS_EXPANDED,"RSS_EXPANDED"],[ct.UPC_A,"UPC_A"],[ct.UPC_E,"UPC_E"],[ct.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),S1;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(S1||(S1={}));function n8(e){return Object.values(ct).includes(e)}var $o;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})($o||($o={}));var i8=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[$o.SCAN_TYPE_CAMERA,$o.SCAN_TYPE_FILE],e}(),Gu=function(){function e(r,t){this.format=r,this.formatName=t}return e.prototype.toString=function(){return this.formatName},e.create=function(r){if(!b1.has(r))throw"".concat(r," not in html5QrcodeSupportedFormatsTextMap");return new e(r,b1.get(r))},e}(),C1=function(){function e(){}return e.createFromText=function(r){var t={text:r};return{decodedText:r,result:t}},e.createFromQrcodeResult=function(r){return{decodedText:r.text,result:r}},e}(),ol;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(ol||(ol={}));var s8=function(){function e(){}return e.createFrom=function(r){return{errorMessage:r,type:ol.UNKWOWN_ERROR}},e}(),o8=function(){function e(r){this.verbose=r}return e.prototype.log=function(r){this.verbose&&console.log(r)},e.prototype.warn=function(r){this.verbose&&console.warn(r)},e.prototype.logError=function(r,t){(this.verbose||t===!0)&&console.error(r)},e.prototype.logErrors=function(r){if(r.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(r)},e}();function fi(e){return typeof e>"u"||e===null}var Us=function(){function e(){}return e.codeParseError=function(r){return"QR code parse error, error = ".concat(r)},e.errorGettingUserMedia=function(r){return"Error getting userMedia, error = ".concat(r)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),Xu=function(){function e(){}return e.isMediaStreamConstraintsValid=function(r,t){if(typeof r!="object"){var n=typeof r;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(n,"."),!0),!1}for(var s=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],c=new Set(s),h=Object.keys(r),d=0,m=h;d<m.length;d++){var g=m[d];if(c.has(g))return t.logError("".concat(g," is not supported videoConstaints."),!0),!1}return!0},e}(),cl={exports:{}};(function(e,r){(function(t,n){n(r)})(o0,function(t){function n(k){return k==null}var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,a){k.__proto__=a}||function(k,a){for(var i in a)a.hasOwnProperty(i)&&(k[i]=a[i])};function c(k,a){s(k,a);function i(){this.constructor=k}k.prototype=a===null?Object.create(a):(i.prototype=a.prototype,new i)}function h(k,a){var i=Object.setPrototypeOf;i?i(k,a):k.__proto__=a}function d(k,a){a===void 0&&(a=k.constructor);var i=Error.captureStackTrace;i&&i(k,a)}var m=function(k){c(a,k);function a(i){var o=this.constructor,l=k.call(this,i)||this;return Object.defineProperty(l,"name",{value:o.name,enumerable:!1}),h(l,o.prototype),d(l),l}return a}(Error);class g extends m{constructor(a=void 0){super(a),this.message=a}getKind(){return this.constructor.kind}}g.kind="Exception";class v extends g{}v.kind="ArgumentException";class _ extends g{}_.kind="IllegalArgumentException";class C{constructor(a){if(this.binarizer=a,a===null)throw new _("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(a,i){return this.binarizer.getBlackRow(a,i)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(a,i,o,l){const f=this.binarizer.getLuminanceSource().crop(a,i,o,l);return new C(this.binarizer.createBinarizer(f))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const a=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new C(this.binarizer.createBinarizer(a))}rotateCounterClockwise45(){const a=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new C(this.binarizer.createBinarizer(a))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class T extends g{static getChecksumInstance(){return new T}}T.kind="ChecksumException";class N{constructor(a){this.source=a}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class S{static arraycopy(a,i,o,l,f){for(;f--;)o[l++]=a[i++]}static currentTimeMillis(){return Date.now()}}class D extends g{}D.kind="IndexOutOfBoundsException";class U extends D{constructor(a=void 0,i=void 0){super(i),this.index=a,this.message=i}}U.kind="ArrayIndexOutOfBoundsException";class X{static fill(a,i){for(let o=0,l=a.length;o<l;o++)a[o]=i}static fillWithin(a,i,o,l){X.rangeCheck(a.length,i,o);for(let f=i;f<o;f++)a[f]=l}static rangeCheck(a,i,o){if(i>o)throw new _("fromIndex("+i+") > toIndex("+o+")");if(i<0)throw new U(i);if(o>a)throw new U(o)}static asList(...a){return a}static create(a,i,o){return Array.from({length:a}).map(f=>Array.from({length:i}).fill(o))}static createInt32Array(a,i,o){return Array.from({length:a}).map(f=>Int32Array.from({length:i}).fill(o))}static equals(a,i){if(!a||!i||!a.length||!i.length||a.length!==i.length)return!1;for(let o=0,l=a.length;o<l;o++)if(a[o]!==i[o])return!1;return!0}static hashCode(a){if(a===null)return 0;let i=1;for(const o of a)i=31*i+o;return i}static fillUint8Array(a,i){for(let o=0;o!==a.length;o++)a[o]=i}static copyOf(a,i){return a.slice(0,i)}static copyOfUint8Array(a,i){if(a.length<=i){const o=new Uint8Array(i);return o.set(a),o}return a.slice(0,i)}static copyOfRange(a,i,o){const l=o-i,f=new Int32Array(l);return S.arraycopy(a,i,f,0,l),f}static binarySearch(a,i,o){o===void 0&&(o=X.numberComparator);let l=0,f=a.length-1;for(;l<=f;){const u=f+l>>1,x=o(i,a[u]);if(x>0)l=u+1;else if(x<0)f=u-1;else return u}return-l-1}static numberComparator(a,i){return a-i}}class O{static numberOfTrailingZeros(a){let i;if(a===0)return 32;let o=31;return i=a<<16,i!==0&&(o-=16,a=i),i=a<<8,i!==0&&(o-=8,a=i),i=a<<4,i!==0&&(o-=4,a=i),i=a<<2,i!==0&&(o-=2,a=i),o-(a<<1>>>31)}static numberOfLeadingZeros(a){if(a===0)return 32;let i=1;return a>>>16||(i+=16,a<<=16),a>>>24||(i+=8,a<<=8),a>>>28||(i+=4,a<<=4),a>>>30||(i+=2,a<<=2),i-=a>>>31,i}static toHexString(a){return a.toString(16)}static toBinaryString(a){return String(parseInt(String(a),2))}static bitCount(a){return a=a-(a>>>1&1431655765),a=(a&858993459)+(a>>>2&858993459),a=a+(a>>>4)&252645135,a=a+(a>>>8),a=a+(a>>>16),a&63}static truncDivision(a,i){return Math.trunc(a/i)}static parseInt(a,i=void 0){return parseInt(a,i)}}O.MIN_VALUE_32_BITS=-2147483648,O.MAX_VALUE=Number.MAX_SAFE_INTEGER;class q{constructor(a,i){a===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=a,i==null?this.bits=q.makeArray(a):this.bits=i)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(a){if(a>this.bits.length*32){const i=q.makeArray(a);S.arraycopy(this.bits,0,i,0,this.bits.length),this.bits=i}}get(a){return(this.bits[Math.floor(a/32)]&1<<(a&31))!==0}set(a){this.bits[Math.floor(a/32)]|=1<<(a&31)}flip(a){this.bits[Math.floor(a/32)]^=1<<(a&31)}getNextSet(a){const i=this.size;if(a>=i)return i;const o=this.bits;let l=Math.floor(a/32),f=o[l];f&=~((1<<(a&31))-1);const u=o.length;for(;f===0;){if(++l===u)return i;f=o[l]}const x=l*32+O.numberOfTrailingZeros(f);return x>i?i:x}getNextUnset(a){const i=this.size;if(a>=i)return i;const o=this.bits;let l=Math.floor(a/32),f=~o[l];f&=~((1<<(a&31))-1);const u=o.length;for(;f===0;){if(++l===u)return i;f=~o[l]}const x=l*32+O.numberOfTrailingZeros(f);return x>i?i:x}setBulk(a,i){this.bits[Math.floor(a/32)]=i}setRange(a,i){if(i<a||a<0||i>this.size)throw new _;if(i===a)return;i--;const o=Math.floor(a/32),l=Math.floor(i/32),f=this.bits;for(let u=o;u<=l;u++){const x=u>o?0:a&31,y=(2<<(u<l?31:i&31))-(1<<x);f[u]|=y}}clear(){const a=this.bits.length,i=this.bits;for(let o=0;o<a;o++)i[o]=0}isRange(a,i,o){if(i<a||a<0||i>this.size)throw new _;if(i===a)return!0;i--;const l=Math.floor(a/32),f=Math.floor(i/32),u=this.bits;for(let x=l;x<=f;x++){const p=x>l?0:a&31,b=(2<<(x<f?31:i&31))-(1<<p)&4294967295;if((u[x]&b)!==(o?b:0))return!1}return!0}appendBit(a){this.ensureCapacity(this.size+1),a&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(a,i){if(i<0||i>32)throw new _("Num bits must be between 0 and 32");this.ensureCapacity(this.size+i);for(let o=i;o>0;o--)this.appendBit((a>>o-1&1)===1)}appendBitArray(a){const i=a.size;this.ensureCapacity(this.size+i);for(let o=0;o<i;o++)this.appendBit(a.get(o))}xor(a){if(this.size!==a.size)throw new _("Sizes don't match");const i=this.bits;for(let o=0,l=i.length;o<l;o++)i[o]^=a.bits[o]}toBytes(a,i,o,l){for(let f=0;f<l;f++){let u=0;for(let x=0;x<8;x++)this.get(a)&&(u|=1<<7-x),a++;i[o+f]=u}}getBitArray(){return this.bits}reverse(){const a=new Int32Array(this.bits.length),i=Math.floor((this.size-1)/32),o=i+1,l=this.bits;for(let f=0;f<o;f++){let u=l[f];u=u>>1&1431655765|(u&1431655765)<<1,u=u>>2&858993459|(u&858993459)<<2,u=u>>4&252645135|(u&252645135)<<4,u=u>>8&16711935|(u&16711935)<<8,u=u>>16&65535|(u&65535)<<16,a[i-f]=u}if(this.size!==o*32){const f=o*32-this.size;let u=a[0]>>>f;for(let x=1;x<o;x++){const p=a[x];u|=p<<32-f,a[x-1]=u,u=p>>>f}a[o-1]=u}this.bits=a}static makeArray(a){return new Int32Array(Math.floor((a+31)/32))}equals(a){if(!(a instanceof q))return!1;const i=a;return this.size===i.size&&X.equals(this.bits,i.bits)}hashCode(){return 31*this.size+X.hashCode(this.bits)}toString(){let a="";for(let i=0,o=this.size;i<o;i++)i&7||(a+=" "),a+=this.get(i)?"X":".";return a}clone(){return new q(this.size,this.bits.slice())}}var oe;(function(k){k[k.OTHER=0]="OTHER",k[k.PURE_BARCODE=1]="PURE_BARCODE",k[k.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",k[k.TRY_HARDER=3]="TRY_HARDER",k[k.CHARACTER_SET=4]="CHARACTER_SET",k[k.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",k[k.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",k[k.ASSUME_GS1=7]="ASSUME_GS1",k[k.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",k[k.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",k[k.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(oe||(oe={}));var J=oe;class M extends g{static getFormatInstance(){return new M}}M.kind="FormatException";var ie;(function(k){k[k.Cp437=0]="Cp437",k[k.ISO8859_1=1]="ISO8859_1",k[k.ISO8859_2=2]="ISO8859_2",k[k.ISO8859_3=3]="ISO8859_3",k[k.ISO8859_4=4]="ISO8859_4",k[k.ISO8859_5=5]="ISO8859_5",k[k.ISO8859_6=6]="ISO8859_6",k[k.ISO8859_7=7]="ISO8859_7",k[k.ISO8859_8=8]="ISO8859_8",k[k.ISO8859_9=9]="ISO8859_9",k[k.ISO8859_10=10]="ISO8859_10",k[k.ISO8859_11=11]="ISO8859_11",k[k.ISO8859_13=12]="ISO8859_13",k[k.ISO8859_14=13]="ISO8859_14",k[k.ISO8859_15=14]="ISO8859_15",k[k.ISO8859_16=15]="ISO8859_16",k[k.SJIS=16]="SJIS",k[k.Cp1250=17]="Cp1250",k[k.Cp1251=18]="Cp1251",k[k.Cp1252=19]="Cp1252",k[k.Cp1256=20]="Cp1256",k[k.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",k[k.UTF8=22]="UTF8",k[k.ASCII=23]="ASCII",k[k.Big5=24]="Big5",k[k.GB18030=25]="GB18030",k[k.EUC_KR=26]="EUC_KR"})(ie||(ie={}));class j{constructor(a,i,o,...l){this.valueIdentifier=a,this.name=o,typeof i=="number"?this.values=Int32Array.from([i]):this.values=i,this.otherEncodingNames=l,j.VALUE_IDENTIFIER_TO_ECI.set(a,this),j.NAME_TO_ECI.set(o,this);const f=this.values;for(let u=0,x=f.length;u!==x;u++){const p=f[u];j.VALUES_TO_ECI.set(p,this)}for(const u of l)j.NAME_TO_ECI.set(u,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(a){if(a<0||a>=900)throw new M("incorect value");const i=j.VALUES_TO_ECI.get(a);if(i===void 0)throw new M("incorect value");return i}static getCharacterSetECIByName(a){const i=j.NAME_TO_ECI.get(a);if(i===void 0)throw new M("incorect value");return i}equals(a){if(!(a instanceof j))return!1;const i=a;return this.getName()===i.getName()}}j.VALUE_IDENTIFIER_TO_ECI=new Map,j.VALUES_TO_ECI=new Map,j.NAME_TO_ECI=new Map,j.Cp437=new j(ie.Cp437,Int32Array.from([0,2]),"Cp437"),j.ISO8859_1=new j(ie.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),j.ISO8859_2=new j(ie.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),j.ISO8859_3=new j(ie.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),j.ISO8859_4=new j(ie.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),j.ISO8859_5=new j(ie.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),j.ISO8859_6=new j(ie.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),j.ISO8859_7=new j(ie.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),j.ISO8859_8=new j(ie.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),j.ISO8859_9=new j(ie.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),j.ISO8859_10=new j(ie.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),j.ISO8859_11=new j(ie.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),j.ISO8859_13=new j(ie.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),j.ISO8859_14=new j(ie.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),j.ISO8859_15=new j(ie.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),j.ISO8859_16=new j(ie.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),j.SJIS=new j(ie.SJIS,20,"SJIS","Shift_JIS"),j.Cp1250=new j(ie.Cp1250,21,"Cp1250","windows-1250"),j.Cp1251=new j(ie.Cp1251,22,"Cp1251","windows-1251"),j.Cp1252=new j(ie.Cp1252,23,"Cp1252","windows-1252"),j.Cp1256=new j(ie.Cp1256,24,"Cp1256","windows-1256"),j.UnicodeBigUnmarked=new j(ie.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),j.UTF8=new j(ie.UTF8,26,"UTF8","UTF-8"),j.ASCII=new j(ie.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),j.Big5=new j(ie.Big5,28,"Big5"),j.GB18030=new j(ie.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),j.EUC_KR=new j(ie.EUC_KR,30,"EUC_KR","EUC-KR");class Ee extends g{}Ee.kind="UnsupportedOperationException";class he{static decode(a,i){const o=this.encodingName(i);return this.customDecoder?this.customDecoder(a,o):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(o)?this.decodeFallback(a,o):new TextDecoder(o).decode(a)}static shouldDecodeOnFallback(a){return!he.isBrowser()&&a==="ISO-8859-1"}static encode(a,i){const o=this.encodingName(i);return this.customEncoder?this.customEncoder(a,o):typeof TextEncoder>"u"?this.encodeFallback(a):new TextEncoder().encode(a)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(a){return typeof a=="string"?a:a.getName()}static encodingCharacterSet(a){return a instanceof j?a:j.getCharacterSetECIByName(a)}static decodeFallback(a,i){const o=this.encodingCharacterSet(i);if(he.isDecodeFallbackSupported(o)){let l="";for(let f=0,u=a.length;f<u;f++){let x=a[f].toString(16);x.length<2&&(x="0"+x),l+="%"+x}return decodeURIComponent(l)}if(o.equals(j.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(a.buffer));throw new Ee(`Encoding ${this.encodingName(i)} not supported by fallback.`)}static isDecodeFallbackSupported(a){return a.equals(j.UTF8)||a.equals(j.ISO8859_1)||a.equals(j.ASCII)}static encodeFallback(a){const o=btoa(unescape(encodeURIComponent(a))).split(""),l=[];for(let f=0;f<o.length;f++)l.push(o[f].charCodeAt(0));return new Uint8Array(l)}}class te{static castAsNonUtf8Char(a,i=null){const o=i?i.getName():this.ISO88591;return he.decode(new Uint8Array([a]),o)}static guessEncoding(a,i){if(i!=null&&i.get(J.CHARACTER_SET)!==void 0)return i.get(J.CHARACTER_SET).toString();const o=a.length;let l=!0,f=!0,u=!0,x=0,p=0,y=0,b=0,I=0,R=0,G=0,Q=0,re=0,ue=0,Ae=0;const Ke=a.length>3&&a[0]===239&&a[1]===187&&a[2]===191;for(let Ze=0;Ze<o&&(l||f||u);Ze++){const Xe=a[Ze]&255;u&&(x>0?Xe&128?x--:u=!1:Xe&128&&(Xe&64?(x++,Xe&32?(x++,Xe&16?(x++,Xe&8?u=!1:b++):y++):p++):u=!1)),l&&(Xe>127&&Xe<160?l=!1:Xe>159&&(Xe<192||Xe===215||Xe===247)&&Ae++),f&&(I>0?Xe<64||Xe===127||Xe>252?f=!1:I--:Xe===128||Xe===160||Xe>239?f=!1:Xe>160&&Xe<224?(R++,Q=0,G++,G>re&&(re=G)):Xe>127?(I++,G=0,Q++,Q>ue&&(ue=Q)):(G=0,Q=0))}return u&&x>0&&(u=!1),f&&I>0&&(f=!1),u&&(Ke||p+y+b>0)?te.UTF8:f&&(te.ASSUME_SHIFT_JIS||re>=3||ue>=3)?te.SHIFT_JIS:l&&f?re===2&&R===2||Ae*10>=o?te.SHIFT_JIS:te.ISO88591:l?te.ISO88591:f?te.SHIFT_JIS:u?te.UTF8:te.PLATFORM_DEFAULT_ENCODING}static format(a,...i){let o=-1;function l(u,x,p,y,b,I){if(u==="%%")return"%";if(i[++o]===void 0)return;u=y?parseInt(y.substr(1)):void 0;let R=b?parseInt(b.substr(1)):void 0,G;switch(I){case"s":G=i[o];break;case"c":G=i[o][0];break;case"f":G=parseFloat(i[o]).toFixed(u);break;case"p":G=parseFloat(i[o]).toPrecision(u);break;case"e":G=parseFloat(i[o]).toExponential(u);break;case"x":G=parseInt(i[o]).toString(R||16);break;case"d":G=parseFloat(parseInt(i[o],R||10).toPrecision(u)).toFixed(0);break}G=typeof G=="object"?JSON.stringify(G):(+G).toString(R);let Q=parseInt(p),re=p&&p[0]+""=="0"?"0":" ";for(;G.length<Q;)G=x!==void 0?G+re:re+G;return G}let f=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return a.replace(f,l)}static getBytes(a,i){return he.encode(a,i)}static getCharCode(a,i=0){return a.charCodeAt(i)}static getCharAt(a){return String.fromCharCode(a)}}te.SHIFT_JIS=j.SJIS.getName(),te.GB2312="GB2312",te.ISO88591=j.ISO8859_1.getName(),te.EUC_JP="EUC_JP",te.UTF8=j.UTF8.getName(),te.PLATFORM_DEFAULT_ENCODING=te.UTF8,te.ASSUME_SHIFT_JIS=!1;class be{constructor(a=""){this.value=a}enableDecoding(a){return this.encoding=a,this}append(a){return typeof a=="string"?this.value+=a.toString():this.encoding?this.value+=te.castAsNonUtf8Char(a,this.encoding):this.value+=String.fromCharCode(a),this}appendChars(a,i,o){for(let l=i;i<i+o;l++)this.append(a[l]);return this}length(){return this.value.length}charAt(a){return this.value.charAt(a)}deleteCharAt(a){this.value=this.value.substr(0,a)+this.value.substring(a+1)}setCharAt(a,i){this.value=this.value.substr(0,a)+i+this.value.substr(a+1)}substring(a,i){return this.value.substring(a,i)}setLengthToZero(){this.value=""}toString(){return this.value}insert(a,i){this.value=this.value.substr(0,a)+i+this.value.substr(a+i.length)}}class $e{constructor(a,i,o,l){if(this.width=a,this.height=i,this.rowSize=o,this.bits=l,i==null&&(i=a),this.height=i,a<1||i<1)throw new _("Both dimensions must be greater than 0");o==null&&(o=Math.floor((a+31)/32)),this.rowSize=o,l==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(a){const i=a.length,o=a[0].length,l=new $e(o,i);for(let f=0;f<i;f++){const u=a[f];for(let x=0;x<o;x++)u[x]&&l.set(x,f)}return l}static parseFromString(a,i,o){if(a===null)throw new _("stringRepresentation cannot be null");const l=new Array(a.length);let f=0,u=0,x=-1,p=0,y=0;for(;y<a.length;)if(a.charAt(y)===`
`||a.charAt(y)==="\r"){if(f>u){if(x===-1)x=f-u;else if(f-u!==x)throw new _("row lengths do not match");u=f,p++}y++}else if(a.substring(y,y+i.length)===i)y+=i.length,l[f]=!0,f++;else if(a.substring(y,y+o.length)===o)y+=o.length,l[f]=!1,f++;else throw new _("illegal character encountered: "+a.substring(y));if(f>u){if(x===-1)x=f-u;else if(f-u!==x)throw new _("row lengths do not match");p++}const b=new $e(x,p);for(let I=0;I<f;I++)l[I]&&b.set(Math.floor(I%x),Math.floor(I/x));return b}get(a,i){const o=i*this.rowSize+Math.floor(a/32);return(this.bits[o]>>>(a&31)&1)!==0}set(a,i){const o=i*this.rowSize+Math.floor(a/32);this.bits[o]|=1<<(a&31)&4294967295}unset(a,i){const o=i*this.rowSize+Math.floor(a/32);this.bits[o]&=~(1<<(a&31)&4294967295)}flip(a,i){const o=i*this.rowSize+Math.floor(a/32);this.bits[o]^=1<<(a&31)&4294967295}xor(a){if(this.width!==a.getWidth()||this.height!==a.getHeight()||this.rowSize!==a.getRowSize())throw new _("input matrix dimensions do not match");const i=new q(Math.floor(this.width/32)+1),o=this.rowSize,l=this.bits;for(let f=0,u=this.height;f<u;f++){const x=f*o,p=a.getRow(f,i).getBitArray();for(let y=0;y<o;y++)l[x+y]^=p[y]}}clear(){const a=this.bits,i=a.length;for(let o=0;o<i;o++)a[o]=0}setRegion(a,i,o,l){if(i<0||a<0)throw new _("Left and top must be nonnegative");if(l<1||o<1)throw new _("Height and width must be at least 1");const f=a+o,u=i+l;if(u>this.height||f>this.width)throw new _("The region must fit inside the matrix");const x=this.rowSize,p=this.bits;for(let y=i;y<u;y++){const b=y*x;for(let I=a;I<f;I++)p[b+Math.floor(I/32)]|=1<<(I&31)&4294967295}}getRow(a,i){i==null||i.getSize()<this.width?i=new q(this.width):i.clear();const o=this.rowSize,l=this.bits,f=a*o;for(let u=0;u<o;u++)i.setBulk(u*32,l[f+u]);return i}setRow(a,i){S.arraycopy(i.getBitArray(),0,this.bits,a*this.rowSize,this.rowSize)}rotate180(){const a=this.getWidth(),i=this.getHeight();let o=new q(a),l=new q(a);for(let f=0,u=Math.floor((i+1)/2);f<u;f++)o=this.getRow(f,o),l=this.getRow(i-1-f,l),o.reverse(),l.reverse(),this.setRow(f,l),this.setRow(i-1-f,o)}getEnclosingRectangle(){const a=this.width,i=this.height,o=this.rowSize,l=this.bits;let f=a,u=i,x=-1,p=-1;for(let y=0;y<i;y++)for(let b=0;b<o;b++){const I=l[y*o+b];if(I!==0){if(y<u&&(u=y),y>p&&(p=y),b*32<f){let R=0;for(;!(I<<31-R&4294967295);)R++;b*32+R<f&&(f=b*32+R)}if(b*32+31>x){let R=31;for(;!(I>>>R);)R--;b*32+R>x&&(x=b*32+R)}}}return x<f||p<u?null:Int32Array.from([f,u,x-f+1,p-u+1])}getTopLeftOnBit(){const a=this.rowSize,i=this.bits;let o=0;for(;o<i.length&&i[o]===0;)o++;if(o===i.length)return null;const l=o/a;let f=o%a*32;const u=i[o];let x=0;for(;!(u<<31-x&4294967295);)x++;return f+=x,Int32Array.from([f,l])}getBottomRightOnBit(){const a=this.rowSize,i=this.bits;let o=i.length-1;for(;o>=0&&i[o]===0;)o--;if(o<0)return null;const l=Math.floor(o/a);let f=Math.floor(o%a)*32;const u=i[o];let x=31;for(;!(u>>>x);)x--;return f+=x,Int32Array.from([f,l])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(a){if(!(a instanceof $e))return!1;const i=a;return this.width===i.width&&this.height===i.height&&this.rowSize===i.rowSize&&X.equals(this.bits,i.bits)}hashCode(){let a=this.width;return a=31*a+this.width,a=31*a+this.height,a=31*a+this.rowSize,a=31*a+X.hashCode(this.bits),a}toString(a="X ",i="  ",o=`
`){return this.buildToString(a,i,o)}buildToString(a,i,o){let l=new be;for(let f=0,u=this.height;f<u;f++){for(let x=0,p=this.width;x<p;x++)l.append(this.get(x,f)?a:i);l.append(o)}return l.toString()}clone(){return new $e(this.width,this.height,this.rowSize,this.bits.slice())}}class ae extends g{static getNotFoundInstance(){return new ae}}ae.kind="NotFoundException";class tt extends N{constructor(a){super(a),this.luminances=tt.EMPTY,this.buckets=new Int32Array(tt.LUMINANCE_BUCKETS)}getBlackRow(a,i){const o=this.getLuminanceSource(),l=o.getWidth();i==null||i.getSize()<l?i=new q(l):i.clear(),this.initArrays(l);const f=o.getRow(a,this.luminances),u=this.buckets;for(let p=0;p<l;p++)u[(f[p]&255)>>tt.LUMINANCE_SHIFT]++;const x=tt.estimateBlackPoint(u);if(l<3)for(let p=0;p<l;p++)(f[p]&255)<x&&i.set(p);else{let p=f[0]&255,y=f[1]&255;for(let b=1;b<l-1;b++){const I=f[b+1]&255;(y*4-p-I)/2<x&&i.set(b),p=y,y=I}}return i}getBlackMatrix(){const a=this.getLuminanceSource(),i=a.getWidth(),o=a.getHeight(),l=new $e(i,o);this.initArrays(i);const f=this.buckets;for(let p=1;p<5;p++){const y=Math.floor(o*p/5),b=a.getRow(y,this.luminances),I=Math.floor(i*4/5);for(let R=Math.floor(i/5);R<I;R++){const G=b[R]&255;f[G>>tt.LUMINANCE_SHIFT]++}}const u=tt.estimateBlackPoint(f),x=a.getMatrix();for(let p=0;p<o;p++){const y=p*i;for(let b=0;b<i;b++)(x[y+b]&255)<u&&l.set(b,p)}return l}createBinarizer(a){return new tt(a)}initArrays(a){this.luminances.length<a&&(this.luminances=new Uint8ClampedArray(a));const i=this.buckets;for(let o=0;o<tt.LUMINANCE_BUCKETS;o++)i[o]=0}static estimateBlackPoint(a){const i=a.length;let o=0,l=0,f=0;for(let b=0;b<i;b++)a[b]>f&&(l=b,f=a[b]),a[b]>o&&(o=a[b]);let u=0,x=0;for(let b=0;b<i;b++){const I=b-l,R=a[b]*I*I;R>x&&(u=b,x=R)}if(l>u){const b=l;l=u,u=b}if(u-l<=i/16)throw new ae;let p=u-1,y=-1;for(let b=u-1;b>l;b--){const I=b-l,R=I*I*(u-b)*(o-a[b]);R>y&&(p=b,y=R)}return p<<tt.LUMINANCE_SHIFT}}tt.LUMINANCE_BITS=5,tt.LUMINANCE_SHIFT=8-tt.LUMINANCE_BITS,tt.LUMINANCE_BUCKETS=1<<tt.LUMINANCE_BITS,tt.EMPTY=Uint8ClampedArray.from([0]);class Re extends tt{constructor(a){super(a),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const a=this.getLuminanceSource(),i=a.getWidth(),o=a.getHeight();if(i>=Re.MINIMUM_DIMENSION&&o>=Re.MINIMUM_DIMENSION){const l=a.getMatrix();let f=i>>Re.BLOCK_SIZE_POWER;i&Re.BLOCK_SIZE_MASK&&f++;let u=o>>Re.BLOCK_SIZE_POWER;o&Re.BLOCK_SIZE_MASK&&u++;const x=Re.calculateBlackPoints(l,f,u,i,o),p=new $e(i,o);Re.calculateThresholdForBlock(l,f,u,i,o,x,p),this.matrix=p}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(a){return new Re(a)}static calculateThresholdForBlock(a,i,o,l,f,u,x){const p=f-Re.BLOCK_SIZE,y=l-Re.BLOCK_SIZE;for(let b=0;b<o;b++){let I=b<<Re.BLOCK_SIZE_POWER;I>p&&(I=p);const R=Re.cap(b,2,o-3);for(let G=0;G<i;G++){let Q=G<<Re.BLOCK_SIZE_POWER;Q>y&&(Q=y);const re=Re.cap(G,2,i-3);let ue=0;for(let Ke=-2;Ke<=2;Ke++){const Ze=u[R+Ke];ue+=Ze[re-2]+Ze[re-1]+Ze[re]+Ze[re+1]+Ze[re+2]}const Ae=ue/25;Re.thresholdBlock(a,Q,I,Ae,l,x)}}}static cap(a,i,o){return a<i?i:a>o?o:a}static thresholdBlock(a,i,o,l,f,u){for(let x=0,p=o*f+i;x<Re.BLOCK_SIZE;x++,p+=f)for(let y=0;y<Re.BLOCK_SIZE;y++)(a[p+y]&255)<=l&&u.set(i+y,o+x)}static calculateBlackPoints(a,i,o,l,f){const u=f-Re.BLOCK_SIZE,x=l-Re.BLOCK_SIZE,p=new Array(o);for(let y=0;y<o;y++){p[y]=new Int32Array(i);let b=y<<Re.BLOCK_SIZE_POWER;b>u&&(b=u);for(let I=0;I<i;I++){let R=I<<Re.BLOCK_SIZE_POWER;R>x&&(R=x);let G=0,Q=255,re=0;for(let Ae=0,Ke=b*l+R;Ae<Re.BLOCK_SIZE;Ae++,Ke+=l){for(let Ze=0;Ze<Re.BLOCK_SIZE;Ze++){const Xe=a[Ke+Ze]&255;G+=Xe,Xe<Q&&(Q=Xe),Xe>re&&(re=Xe)}if(re-Q>Re.MIN_DYNAMIC_RANGE)for(Ae++,Ke+=l;Ae<Re.BLOCK_SIZE;Ae++,Ke+=l)for(let Ze=0;Ze<Re.BLOCK_SIZE;Ze++)G+=a[Ke+Ze]&255}let ue=G>>Re.BLOCK_SIZE_POWER*2;if(re-Q<=Re.MIN_DYNAMIC_RANGE&&(ue=Q/2,y>0&&I>0)){const Ae=(p[y-1][I]+2*p[y][I-1]+p[y-1][I-1])/4;Q<Ae&&(ue=Ae)}p[y][I]=ue}}return p}}Re.BLOCK_SIZE_POWER=3,Re.BLOCK_SIZE=1<<Re.BLOCK_SIZE_POWER,Re.BLOCK_SIZE_MASK=Re.BLOCK_SIZE-1,Re.MINIMUM_DIMENSION=Re.BLOCK_SIZE*5,Re.MIN_DYNAMIC_RANGE=24;class Ut{constructor(a,i){this.width=a,this.height=i}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(a,i,o,l){throw new Ee("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Ee("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Ee("This luminance source does not support rotation by 45 degrees.")}toString(){const a=new Uint8ClampedArray(this.width);let i=new be;for(let o=0;o<this.height;o++){const l=this.getRow(o,a);for(let f=0;f<this.width;f++){const u=l[f]&255;let x;u<64?x="#":u<128?x="+":u<192?x=".":x=" ",i.append(x)}i.append(`
`)}return i.toString()}}class fe extends Ut{constructor(a){super(a.getWidth(),a.getHeight()),this.delegate=a}getRow(a,i){const o=this.delegate.getRow(a,i),l=this.getWidth();for(let f=0;f<l;f++)o[f]=255-(o[f]&255);return o}getMatrix(){const a=this.delegate.getMatrix(),i=this.getWidth()*this.getHeight(),o=new Uint8ClampedArray(i);for(let l=0;l<i;l++)o[l]=255-(a[l]&255);return o}isCropSupported(){return this.delegate.isCropSupported()}crop(a,i,o,l){return new fe(this.delegate.crop(a,i,o,l))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new fe(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new fe(this.delegate.rotateCounterClockwise45())}}class ot extends Ut{constructor(a){super(a.width,a.height),this.canvas=a,this.tempCanvasElement=null,this.buffer=ot.makeBufferFromCanvasImageData(a)}static makeBufferFromCanvasImageData(a){const i=a.getContext("2d").getImageData(0,0,a.width,a.height);return ot.toGrayscaleBuffer(i.data,a.width,a.height)}static toGrayscaleBuffer(a,i,o){const l=new Uint8ClampedArray(i*o);for(let f=0,u=0,x=a.length;f<x;f+=4,u++){let p;if(a[f+3]===0)p=255;else{const b=a[f],I=a[f+1],R=a[f+2];p=306*b+601*I+117*R+512>>10}l[u]=p}return l}getRow(a,i){if(a<0||a>=this.getHeight())throw new _("Requested row is outside the image: "+a);const o=this.getWidth(),l=a*o;return i===null?i=this.buffer.slice(l,l+o):(i.length<o&&(i=new Uint8ClampedArray(o)),i.set(this.buffer.slice(l,l+o))),i}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(a,i,o,l){return super.crop(a,i,o,l),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const a=this.canvas.ownerDocument.createElement("canvas");a.width=this.canvas.width,a.height=this.canvas.height,this.tempCanvasElement=a}return this.tempCanvasElement}rotate(a){const i=this.getTempCanvasElement(),o=i.getContext("2d"),l=a*ot.DEGREE_TO_RADIANS,f=this.canvas.width,u=this.canvas.height,x=Math.ceil(Math.abs(Math.cos(l))*f+Math.abs(Math.sin(l))*u),p=Math.ceil(Math.abs(Math.sin(l))*f+Math.abs(Math.cos(l))*u);return i.width=x,i.height=p,o.translate(x/2,p/2),o.rotate(l),o.drawImage(this.canvas,f/-2,u/-2),this.buffer=ot.makeBufferFromCanvasImageData(i),this}invert(){return new fe(this)}}ot.DEGREE_TO_RADIANS=Math.PI/180;class pt{constructor(a,i,o){this.deviceId=a,this.label=i,this.kind="videoinput",this.groupId=o||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var K=(globalThis||o0||self||window||void 0)&&(globalThis||o0||self||window||void 0).__awaiter||function(k,a,i,o){function l(f){return f instanceof i?f:new i(function(u){u(f)})}return new(i||(i=Promise))(function(f,u){function x(b){try{y(o.next(b))}catch(I){u(I)}}function p(b){try{y(o.throw(b))}catch(I){u(I)}}function y(b){b.done?f(b.value):l(b.value).then(x,p)}y((o=o.apply(k,a||[])).next())})};class ce{constructor(a,i=500,o){this.reader=a,this.timeBetweenScansMillis=i,this._hints=o,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(a){this._timeBetweenDecodingAttempts=a<0?0:a}set hints(a){this._hints=a||null}get hints(){return this._hints}listVideoInputDevices(){return K(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const a=yield navigator.mediaDevices.enumerateDevices(),i=[];for(const o of a){const l=o.kind==="video"?"videoinput":o.kind;if(l!=="videoinput")continue;const f=o.deviceId||o.id,u=o.label||`Video device ${i.length+1}`,x=o.groupId,p={deviceId:f,label:u,kind:l,groupId:x};i.push(p)}return i})}getVideoInputDevices(){return K(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(i=>new pt(i.deviceId,i.label))})}findDeviceById(a){return K(this,void 0,void 0,function*(){const i=yield this.listVideoInputDevices();return i?i.find(o=>o.deviceId===a):null})}decodeFromInputVideoDevice(a,i){return K(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(a,i)})}decodeOnceFromVideoDevice(a,i){return K(this,void 0,void 0,function*(){this.reset();let o;a?o={deviceId:{exact:a}}:o={facingMode:"environment"};const l={video:o};return yield this.decodeOnceFromConstraints(l,i)})}decodeOnceFromConstraints(a,i){return K(this,void 0,void 0,function*(){const o=yield navigator.mediaDevices.getUserMedia(a);return yield this.decodeOnceFromStream(o,i)})}decodeOnceFromStream(a,i){return K(this,void 0,void 0,function*(){this.reset();const o=yield this.attachStreamToVideo(a,i);return yield this.decodeOnce(o)})}decodeFromInputVideoDeviceContinuously(a,i,o){return K(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(a,i,o)})}decodeFromVideoDevice(a,i,o){return K(this,void 0,void 0,function*(){let l;a?l={deviceId:{exact:a}}:l={facingMode:"environment"};const f={video:l};return yield this.decodeFromConstraints(f,i,o)})}decodeFromConstraints(a,i,o){return K(this,void 0,void 0,function*(){const l=yield navigator.mediaDevices.getUserMedia(a);return yield this.decodeFromStream(l,i,o)})}decodeFromStream(a,i,o){return K(this,void 0,void 0,function*(){this.reset();const l=yield this.attachStreamToVideo(a,i);return yield this.decodeContinuously(l,o)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(a,i){return K(this,void 0,void 0,function*(){const o=this.prepareVideoElement(i);return this.addVideoSource(o,a),this.videoElement=o,this.stream=a,yield this.playVideoOnLoadAsync(o),o})}playVideoOnLoadAsync(a){return new Promise((i,o)=>this.playVideoOnLoad(a,()=>i()))}playVideoOnLoad(a,i){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(a),a.addEventListener("ended",this.videoEndedListener),a.addEventListener("canplay",this.videoCanPlayListener),a.addEventListener("playing",i),this.tryPlayVideo(a)}isVideoPlaying(a){return a.currentTime>0&&!a.paused&&!a.ended&&a.readyState>2}tryPlayVideo(a){return K(this,void 0,void 0,function*(){if(this.isVideoPlaying(a)){console.warn("Trying to play video that is already playing.");return}try{yield a.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(a,i){const o=document.getElementById(a);if(!o)throw new v(`element with id '${a}' not found`);if(o.nodeName.toLowerCase()!==i.toLowerCase())throw new v(`element with id '${a}' must be an ${i} element`);return o}decodeFromImage(a,i){if(!a&&!i)throw new v("either imageElement with a src set or an url must be provided");return i&&!a?this.decodeFromImageUrl(i):this.decodeFromImageElement(a)}decodeFromVideo(a,i){if(!a&&!i)throw new v("Either an element with a src set or an URL must be provided");return i&&!a?this.decodeFromVideoUrl(i):this.decodeFromVideoElement(a)}decodeFromVideoContinuously(a,i,o){if(a===void 0&&i===void 0)throw new v("Either an element with a src set or an URL must be provided");return i&&!a?this.decodeFromVideoUrlContinuously(i,o):this.decodeFromVideoElementContinuously(a,o)}decodeFromImageElement(a){if(!a)throw new v("An image element must be provided.");this.reset();const i=this.prepareImageElement(a);this.imageElement=i;let o;return this.isImageLoaded(i)?o=this.decodeOnce(i,!1,!0):o=this._decodeOnLoadImage(i),o}decodeFromVideoElement(a){const i=this._decodeFromVideoElementSetup(a);return this._decodeOnLoadVideo(i)}decodeFromVideoElementContinuously(a,i){const o=this._decodeFromVideoElementSetup(a);return this._decodeOnLoadVideoContinuously(o,i)}_decodeFromVideoElementSetup(a){if(!a)throw new v("A video element must be provided.");this.reset();const i=this.prepareVideoElement(a);return this.videoElement=i,i}decodeFromImageUrl(a){if(!a)throw new v("An URL must be provided.");this.reset();const i=this.prepareImageElement();this.imageElement=i;const o=this._decodeOnLoadImage(i);return i.src=a,o}decodeFromVideoUrl(a){if(!a)throw new v("An URL must be provided.");this.reset();const i=this.prepareVideoElement(),o=this.decodeFromVideoElement(i);return i.src=a,o}decodeFromVideoUrlContinuously(a,i){if(!a)throw new v("An URL must be provided.");this.reset();const o=this.prepareVideoElement(),l=this.decodeFromVideoElementContinuously(o,i);return o.src=a,l}_decodeOnLoadImage(a){return new Promise((i,o)=>{this.imageLoadedListener=()=>this.decodeOnce(a,!1,!0).then(i,o),a.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(a){return K(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(a),yield this.decodeOnce(a)})}_decodeOnLoadVideoContinuously(a,i){return K(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(a),this.decodeContinuously(a,i)})}isImageLoaded(a){return!(!a.complete||a.naturalWidth===0)}prepareImageElement(a){let i;return typeof a>"u"&&(i=document.createElement("img"),i.width=200,i.height=200),typeof a=="string"&&(i=this.getMediaElement(a,"img")),a instanceof HTMLImageElement&&(i=a),i}prepareVideoElement(a){let i;return!a&&typeof document<"u"&&(i=document.createElement("video"),i.width=200,i.height=200),typeof a=="string"&&(i=this.getMediaElement(a,"video")),a instanceof HTMLVideoElement&&(i=a),i.setAttribute("autoplay","true"),i.setAttribute("muted","true"),i.setAttribute("playsinline","true"),i}decodeOnce(a,i=!0,o=!0){this._stopAsyncDecode=!1;const l=(f,u)=>{if(this._stopAsyncDecode){u(new ae("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const x=this.decode(a);f(x)}catch(x){const p=i&&x instanceof ae,b=(x instanceof T||x instanceof M)&&o;if(p||b)return setTimeout(l,this._timeBetweenDecodingAttempts,f,u);u(x)}};return new Promise((f,u)=>l(f,u))}decodeContinuously(a,i){this._stopContinuousDecode=!1;const o=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const l=this.decode(a);i(l,null),setTimeout(o,this.timeBetweenScansMillis)}catch(l){i(null,l);const f=l instanceof T||l instanceof M,u=l instanceof ae;(f||u)&&setTimeout(o,this._timeBetweenDecodingAttempts)}};o()}decode(a){const i=this.createBinaryBitmap(a);return this.decodeBitmap(i)}_isHTMLVideoElement(a){return a.videoWidth!==0}drawFrameOnCanvas(a,i,o){i||(i={sx:0,sy:0,sWidth:a.videoWidth,sHeight:a.videoHeight,dx:0,dy:0,dWidth:a.videoWidth,dHeight:a.videoHeight}),o||(o=this.captureCanvasContext),o.drawImage(a,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}drawImageOnCanvas(a,i,o=this.captureCanvasContext){i||(i={sx:0,sy:0,sWidth:a.naturalWidth,sHeight:a.naturalHeight,dx:0,dy:0,dWidth:a.naturalWidth,dHeight:a.naturalHeight}),o||(o=this.captureCanvasContext),o.drawImage(a,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}createBinaryBitmap(a){this.getCaptureCanvasContext(a),this._isHTMLVideoElement(a)?this.drawFrameOnCanvas(a):this.drawImageOnCanvas(a);const i=this.getCaptureCanvas(a),o=new ot(i),l=new Re(o);return new C(l)}getCaptureCanvasContext(a){if(!this.captureCanvasContext){const o=this.getCaptureCanvas(a).getContext("2d");this.captureCanvasContext=o}return this.captureCanvasContext}getCaptureCanvas(a){if(!this.captureCanvas){const i=this.createCaptureCanvas(a);this.captureCanvas=i}return this.captureCanvas}decodeBitmap(a){return this.reader.decode(a,this._hints)}createCaptureCanvas(a){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const i=document.createElement("canvas");let o,l;return typeof a<"u"&&(a instanceof HTMLVideoElement?(o=a.videoWidth,l=a.videoHeight):a instanceof HTMLImageElement&&(o=a.naturalWidth||a.width,l=a.naturalHeight||a.height)),i.style.width=o+"px",i.style.height=l+"px",i.width=o,i.height=l,i}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(a=>a.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(a,i){try{a.srcObject=i}catch{a.src=URL.createObjectURL(i)}}cleanVideoSource(a){try{a.srcObject=null}catch{a.src=""}this.videoElement.removeAttribute("src")}}class ee{constructor(a,i,o=i==null?0:8*i.length,l,f,u=S.currentTimeMillis()){this.text=a,this.rawBytes=i,this.numBits=o,this.resultPoints=l,this.format=f,this.timestamp=u,this.text=a,this.rawBytes=i,o==null?this.numBits=i==null?0:8*i.length:this.numBits=o,this.resultPoints=l,this.format=f,this.resultMetadata=null,u==null?this.timestamp=S.currentTimeMillis():this.timestamp=u}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(a,i){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(a,i)}putAllMetadata(a){a!==null&&(this.resultMetadata===null?this.resultMetadata=a:this.resultMetadata=new Map(a))}addResultPoints(a){const i=this.resultPoints;if(i===null)this.resultPoints=a;else if(a!==null&&a.length>0){const o=new Array(i.length+a.length);S.arraycopy(i,0,o,0,i.length),S.arraycopy(a,0,o,i.length,a.length),this.resultPoints=o}}getTimestamp(){return this.timestamp}toString(){return this.text}}var ne;(function(k){k[k.AZTEC=0]="AZTEC",k[k.CODABAR=1]="CODABAR",k[k.CODE_39=2]="CODE_39",k[k.CODE_93=3]="CODE_93",k[k.CODE_128=4]="CODE_128",k[k.DATA_MATRIX=5]="DATA_MATRIX",k[k.EAN_8=6]="EAN_8",k[k.EAN_13=7]="EAN_13",k[k.ITF=8]="ITF",k[k.MAXICODE=9]="MAXICODE",k[k.PDF_417=10]="PDF_417",k[k.QR_CODE=11]="QR_CODE",k[k.RSS_14=12]="RSS_14",k[k.RSS_EXPANDED=13]="RSS_EXPANDED",k[k.UPC_A=14]="UPC_A",k[k.UPC_E=15]="UPC_E",k[k.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ne||(ne={}));var le=ne,qe;(function(k){k[k.OTHER=0]="OTHER",k[k.ORIENTATION=1]="ORIENTATION",k[k.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",k[k.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",k[k.ISSUE_NUMBER=4]="ISSUE_NUMBER",k[k.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",k[k.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",k[k.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",k[k.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",k[k.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",k[k.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(qe||(qe={}));var Le=qe;class Pe{constructor(a,i,o,l,f=-1,u=-1){this.rawBytes=a,this.text=i,this.byteSegments=o,this.ecLevel=l,this.structuredAppendSequenceNumber=f,this.structuredAppendParity=u,this.numBits=a==null?0:8*a.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(a){this.numBits=a}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(a){this.errorsCorrected=a}getErasures(){return this.erasures}setErasures(a){this.erasures=a}getOther(){return this.other}setOther(a){this.other=a}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Be{exp(a){return this.expTable[a]}log(a){if(a===0)throw new _;return this.logTable[a]}static addOrSubtract(a,i){return a^i}}class Te{constructor(a,i){if(i.length===0)throw new _;this.field=a;const o=i.length;if(o>1&&i[0]===0){let l=1;for(;l<o&&i[l]===0;)l++;l===o?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(o-l),S.arraycopy(i,l,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(a){return this.coefficients[this.coefficients.length-1-a]}evaluateAt(a){if(a===0)return this.getCoefficient(0);const i=this.coefficients;let o;if(a===1){o=0;for(let u=0,x=i.length;u!==x;u++){const p=i[u];o=Be.addOrSubtract(o,p)}return o}o=i[0];const l=i.length,f=this.field;for(let u=1;u<l;u++)o=Be.addOrSubtract(f.multiply(a,o),i[u]);return o}addOrSubtract(a){if(!this.field.equals(a.field))throw new _("GenericGFPolys do not have same GenericGF field");if(this.isZero())return a;if(a.isZero())return this;let i=this.coefficients,o=a.coefficients;if(i.length>o.length){const u=i;i=o,o=u}let l=new Int32Array(o.length);const f=o.length-i.length;S.arraycopy(o,0,l,0,f);for(let u=f;u<o.length;u++)l[u]=Be.addOrSubtract(i[u-f],o[u]);return new Te(this.field,l)}multiply(a){if(!this.field.equals(a.field))throw new _("GenericGFPolys do not have same GenericGF field");if(this.isZero()||a.isZero())return this.field.getZero();const i=this.coefficients,o=i.length,l=a.coefficients,f=l.length,u=new Int32Array(o+f-1),x=this.field;for(let p=0;p<o;p++){const y=i[p];for(let b=0;b<f;b++)u[p+b]=Be.addOrSubtract(u[p+b],x.multiply(y,l[b]))}return new Te(x,u)}multiplyScalar(a){if(a===0)return this.field.getZero();if(a===1)return this;const i=this.coefficients.length,o=this.field,l=new Int32Array(i),f=this.coefficients;for(let u=0;u<i;u++)l[u]=o.multiply(f[u],a);return new Te(o,l)}multiplyByMonomial(a,i){if(a<0)throw new _;if(i===0)return this.field.getZero();const o=this.coefficients,l=o.length,f=new Int32Array(l+a),u=this.field;for(let x=0;x<l;x++)f[x]=u.multiply(o[x],i);return new Te(u,f)}divide(a){if(!this.field.equals(a.field))throw new _("GenericGFPolys do not have same GenericGF field");if(a.isZero())throw new _("Divide by 0");const i=this.field;let o=i.getZero(),l=this;const f=a.getCoefficient(a.getDegree()),u=i.inverse(f);for(;l.getDegree()>=a.getDegree()&&!l.isZero();){const x=l.getDegree()-a.getDegree(),p=i.multiply(l.getCoefficient(l.getDegree()),u),y=a.multiplyByMonomial(x,p),b=i.buildMonomial(x,p);o=o.addOrSubtract(b),l=l.addOrSubtract(y)}return[o,l]}toString(){let a="";for(let i=this.getDegree();i>=0;i--){let o=this.getCoefficient(i);if(o!==0){if(o<0?(a+=" - ",o=-o):a.length>0&&(a+=" + "),i===0||o!==1){const l=this.field.log(o);l===0?a+="1":l===1?a+="a":(a+="a^",a+=l)}i!==0&&(i===1?a+="x":(a+="x^",a+=i))}}return a}}class A extends g{}A.kind="ArithmeticException";class Y extends Be{constructor(a,i,o){super(),this.primitive=a,this.size=i,this.generatorBase=o;const l=new Int32Array(i);let f=1;for(let x=0;x<i;x++)l[x]=f,f*=2,f>=i&&(f^=a,f&=i-1);this.expTable=l;const u=new Int32Array(i);for(let x=0;x<i-1;x++)u[l[x]]=x;this.logTable=u,this.zero=new Te(this,Int32Array.from([0])),this.one=new Te(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(a,i){if(a<0)throw new _;if(i===0)return this.zero;const o=new Int32Array(a+1);return o[0]=i,new Te(this,o)}inverse(a){if(a===0)throw new A;return this.expTable[this.size-this.logTable[a]-1]}multiply(a,i){return a===0||i===0?0:this.expTable[(this.logTable[a]+this.logTable[i])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+O.toHexString(this.primitive)+","+this.size+")"}equals(a){return a===this}}Y.AZTEC_DATA_12=new Y(4201,4096,1),Y.AZTEC_DATA_10=new Y(1033,1024,1),Y.AZTEC_DATA_6=new Y(67,64,1),Y.AZTEC_PARAM=new Y(19,16,1),Y.QR_CODE_FIELD_256=new Y(285,256,0),Y.DATA_MATRIX_FIELD_256=new Y(301,256,1),Y.AZTEC_DATA_8=Y.DATA_MATRIX_FIELD_256,Y.MAXICODE_FIELD_64=Y.AZTEC_DATA_6;class ht extends g{}ht.kind="ReedSolomonException";class lt extends g{}lt.kind="IllegalStateException";class ze{constructor(a){this.field=a}decode(a,i){const o=this.field,l=new Te(o,a),f=new Int32Array(i);let u=!0;for(let G=0;G<i;G++){const Q=l.evaluateAt(o.exp(G+o.getGeneratorBase()));f[f.length-1-G]=Q,Q!==0&&(u=!1)}if(u)return;const x=new Te(o,f),p=this.runEuclideanAlgorithm(o.buildMonomial(i,1),x,i),y=p[0],b=p[1],I=this.findErrorLocations(y),R=this.findErrorMagnitudes(b,I);for(let G=0;G<I.length;G++){const Q=a.length-1-o.log(I[G]);if(Q<0)throw new ht("Bad error location");a[Q]=Y.addOrSubtract(a[Q],R[G])}}runEuclideanAlgorithm(a,i,o){if(a.getDegree()<i.getDegree()){const G=a;a=i,i=G}const l=this.field;let f=a,u=i,x=l.getZero(),p=l.getOne();for(;u.getDegree()>=(o/2|0);){let G=f,Q=x;if(f=u,x=p,f.isZero())throw new ht("r_{i-1} was zero");u=G;let re=l.getZero();const ue=f.getCoefficient(f.getDegree()),Ae=l.inverse(ue);for(;u.getDegree()>=f.getDegree()&&!u.isZero();){const Ke=u.getDegree()-f.getDegree(),Ze=l.multiply(u.getCoefficient(u.getDegree()),Ae);re=re.addOrSubtract(l.buildMonomial(Ke,Ze)),u=u.addOrSubtract(f.multiplyByMonomial(Ke,Ze))}if(p=re.multiply(x).addOrSubtract(Q),u.getDegree()>=f.getDegree())throw new lt("Division algorithm failed to reduce polynomial?")}const y=p.getCoefficient(0);if(y===0)throw new ht("sigmaTilde(0) was zero");const b=l.inverse(y),I=p.multiplyScalar(b),R=u.multiplyScalar(b);return[I,R]}findErrorLocations(a){const i=a.getDegree();if(i===1)return Int32Array.from([a.getCoefficient(1)]);const o=new Int32Array(i);let l=0;const f=this.field;for(let u=1;u<f.getSize()&&l<i;u++)a.evaluateAt(u)===0&&(o[l]=f.inverse(u),l++);if(l!==i)throw new ht("Error locator degree does not match number of roots");return o}findErrorMagnitudes(a,i){const o=i.length,l=new Int32Array(o),f=this.field;for(let u=0;u<o;u++){const x=f.inverse(i[u]);let p=1;for(let y=0;y<o;y++)if(u!==y){const b=f.multiply(i[y],x),I=b&1?b&-2:b|1;p=f.multiply(p,I)}l[u]=f.multiply(a.evaluateAt(x),f.inverse(p)),f.getGeneratorBase()!==0&&(l[u]=f.multiply(l[u],x))}return l}}var Me;(function(k){k[k.UPPER=0]="UPPER",k[k.LOWER=1]="LOWER",k[k.MIXED=2]="MIXED",k[k.DIGIT=3]="DIGIT",k[k.PUNCT=4]="PUNCT",k[k.BINARY=5]="BINARY"})(Me||(Me={}));class ft{decode(a){this.ddata=a;let i=a.getBits(),o=this.extractBits(i),l=this.correctBits(o),f=ft.convertBoolArrayToByteArray(l),u=ft.getEncodedData(l),x=new Pe(f,u,null,null);return x.setNumBits(l.length),x}static highLevelDecode(a){return this.getEncodedData(a)}static getEncodedData(a){let i=a.length,o=Me.UPPER,l=Me.UPPER,f="",u=0;for(;u<i;)if(l===Me.BINARY){if(i-u<5)break;let x=ft.readCode(a,u,5);if(u+=5,x===0){if(i-u<11)break;x=ft.readCode(a,u,11)+31,u+=11}for(let p=0;p<x;p++){if(i-u<8){u=i;break}const y=ft.readCode(a,u,8);f+=te.castAsNonUtf8Char(y),u+=8}l=o}else{let x=l===Me.DIGIT?4:5;if(i-u<x)break;let p=ft.readCode(a,u,x);u+=x;let y=ft.getCharacter(l,p);y.startsWith("CTRL_")?(o=l,l=ft.getTable(y.charAt(5)),y.charAt(6)==="L"&&(o=l)):(f+=y,l=o)}return f}static getTable(a){switch(a){case"L":return Me.LOWER;case"P":return Me.PUNCT;case"M":return Me.MIXED;case"D":return Me.DIGIT;case"B":return Me.BINARY;case"U":default:return Me.UPPER}}static getCharacter(a,i){switch(a){case Me.UPPER:return ft.UPPER_TABLE[i];case Me.LOWER:return ft.LOWER_TABLE[i];case Me.MIXED:return ft.MIXED_TABLE[i];case Me.PUNCT:return ft.PUNCT_TABLE[i];case Me.DIGIT:return ft.DIGIT_TABLE[i];default:throw new lt("Bad table")}}correctBits(a){let i,o;this.ddata.getNbLayers()<=2?(o=6,i=Y.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(o=8,i=Y.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(o=10,i=Y.AZTEC_DATA_10):(o=12,i=Y.AZTEC_DATA_12);let l=this.ddata.getNbDatablocks(),f=a.length/o;if(f<l)throw new M;let u=a.length%o,x=new Int32Array(f);for(let R=0;R<f;R++,u+=o)x[R]=ft.readCode(a,u,o);try{new ze(i).decode(x,f-l)}catch(R){throw new M(R)}let p=(1<<o)-1,y=0;for(let R=0;R<l;R++){let G=x[R];if(G===0||G===p)throw new M;(G===1||G===p-1)&&y++}let b=new Array(l*o-y),I=0;for(let R=0;R<l;R++){let G=x[R];if(G===1||G===p-1)b.fill(G>1,I,I+o-1),I+=o-1;else for(let Q=o-1;Q>=0;--Q)b[I++]=(G&1<<Q)!==0}return b}extractBits(a){let i=this.ddata.isCompact(),o=this.ddata.getNbLayers(),l=(i?11:14)+o*4,f=new Int32Array(l),u=new Array(this.totalBitsInLayer(o,i));if(i)for(let x=0;x<f.length;x++)f[x]=x;else{let x=l+1+2*O.truncDivision(O.truncDivision(l,2)-1,15),p=l/2,y=O.truncDivision(x,2);for(let b=0;b<p;b++){let I=b+O.truncDivision(b,15);f[p-b-1]=y-I-1,f[p+b]=y+I+1}}for(let x=0,p=0;x<o;x++){let y=(o-x)*4+(i?9:12),b=x*2,I=l-1-b;for(let R=0;R<y;R++){let G=R*2;for(let Q=0;Q<2;Q++)u[p+G+Q]=a.get(f[b+Q],f[b+R]),u[p+2*y+G+Q]=a.get(f[b+R],f[I-Q]),u[p+4*y+G+Q]=a.get(f[I-Q],f[I-R]),u[p+6*y+G+Q]=a.get(f[I-R],f[b+Q])}p+=y*8}return u}static readCode(a,i,o){let l=0;for(let f=i;f<i+o;f++)l<<=1,a[f]&&(l|=1);return l}static readByte(a,i){let o=a.length-i;return o>=8?ft.readCode(a,i,8):ft.readCode(a,i,o)<<8-o}static convertBoolArrayToByteArray(a){let i=new Uint8Array((a.length+7)/8);for(let o=0;o<i.length;o++)i[o]=ft.readByte(a,8*o);return i}totalBitsInLayer(a,i){return((i?88:112)+16*a)*a}}ft.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],ft.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],ft.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],ft.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],ft.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Et{constructor(){}static round(a){return a===NaN?0:a<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:a>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:a+(a<0?-.5:.5)|0}static distance(a,i,o,l){const f=a-o,u=i-l;return Math.sqrt(f*f+u*u)}static sum(a){let i=0;for(let o=0,l=a.length;o!==l;o++){const f=a[o];i+=f}return i}}class Kr{static floatToIntBits(a){return a}}Kr.MAX_VALUE=Number.MAX_SAFE_INTEGER;class st{constructor(a,i){this.x=a,this.y=i}getX(){return this.x}getY(){return this.y}equals(a){if(a instanceof st){const i=a;return this.x===i.x&&this.y===i.y}return!1}hashCode(){return 31*Kr.floatToIntBits(this.x)+Kr.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(a){const i=this.distance(a[0],a[1]),o=this.distance(a[1],a[2]),l=this.distance(a[0],a[2]);let f,u,x;if(o>=i&&o>=l?(u=a[0],f=a[1],x=a[2]):l>=o&&l>=i?(u=a[1],f=a[0],x=a[2]):(u=a[2],f=a[0],x=a[1]),this.crossProductZ(f,u,x)<0){const p=f;f=x,x=p}a[0]=f,a[1]=u,a[2]=x}static distance(a,i){return Et.distance(a.x,a.y,i.x,i.y)}static crossProductZ(a,i,o){const l=i.x,f=i.y;return(o.x-l)*(a.y-f)-(o.y-f)*(a.x-l)}}class An{constructor(a,i){this.bits=a,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class ln extends An{constructor(a,i,o,l,f){super(a,i),this.compact=o,this.nbDatablocks=l,this.nbLayers=f}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Dr{constructor(a,i,o,l){this.image=a,this.height=a.getHeight(),this.width=a.getWidth(),i==null&&(i=Dr.INIT_SIZE),o==null&&(o=a.getWidth()/2|0),l==null&&(l=a.getHeight()/2|0);const f=i/2|0;if(this.leftInit=o-f,this.rightInit=o+f,this.upInit=l-f,this.downInit=l+f,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new ae}detect(){let a=this.leftInit,i=this.rightInit,o=this.upInit,l=this.downInit,f=!1,u=!0,x=!1,p=!1,y=!1,b=!1,I=!1;const R=this.width,G=this.height;for(;u;){u=!1;let Q=!0;for(;(Q||!p)&&i<R;)Q=this.containsBlackPoint(o,l,i,!1),Q?(i++,u=!0,p=!0):p||i++;if(i>=R){f=!0;break}let re=!0;for(;(re||!y)&&l<G;)re=this.containsBlackPoint(a,i,l,!0),re?(l++,u=!0,y=!0):y||l++;if(l>=G){f=!0;break}let ue=!0;for(;(ue||!b)&&a>=0;)ue=this.containsBlackPoint(o,l,a,!1),ue?(a--,u=!0,b=!0):b||a--;if(a<0){f=!0;break}let Ae=!0;for(;(Ae||!I)&&o>=0;)Ae=this.containsBlackPoint(a,i,o,!0),Ae?(o--,u=!0,I=!0):I||o--;if(o<0){f=!0;break}u&&(x=!0)}if(!f&&x){const Q=i-a;let re=null;for(let Ze=1;re===null&&Ze<Q;Ze++)re=this.getBlackPointOnSegment(a,l-Ze,a+Ze,l);if(re==null)throw new ae;let ue=null;for(let Ze=1;ue===null&&Ze<Q;Ze++)ue=this.getBlackPointOnSegment(a,o+Ze,a+Ze,o);if(ue==null)throw new ae;let Ae=null;for(let Ze=1;Ae===null&&Ze<Q;Ze++)Ae=this.getBlackPointOnSegment(i,o+Ze,i-Ze,o);if(Ae==null)throw new ae;let Ke=null;for(let Ze=1;Ke===null&&Ze<Q;Ze++)Ke=this.getBlackPointOnSegment(i,l-Ze,i-Ze,l);if(Ke==null)throw new ae;return this.centerEdges(Ke,re,Ae,ue)}else throw new ae}getBlackPointOnSegment(a,i,o,l){const f=Et.round(Et.distance(a,i,o,l)),u=(o-a)/f,x=(l-i)/f,p=this.image;for(let y=0;y<f;y++){const b=Et.round(a+y*u),I=Et.round(i+y*x);if(p.get(b,I))return new st(b,I)}return null}centerEdges(a,i,o,l){const f=a.getX(),u=a.getY(),x=i.getX(),p=i.getY(),y=o.getX(),b=o.getY(),I=l.getX(),R=l.getY(),G=Dr.CORR;return f<this.width/2?[new st(I-G,R+G),new st(x+G,p+G),new st(y-G,b-G),new st(f+G,u-G)]:[new st(I+G,R+G),new st(x+G,p-G),new st(y-G,b+G),new st(f-G,u-G)]}containsBlackPoint(a,i,o,l){const f=this.image;if(l){for(let u=a;u<=i;u++)if(f.get(u,o))return!0}else for(let u=a;u<=i;u++)if(f.get(o,u))return!0;return!1}}Dr.INIT_SIZE=10,Dr.CORR=1;class xa{static checkAndNudgePoints(a,i){const o=a.getWidth(),l=a.getHeight();let f=!0;for(let u=0;u<i.length&&f;u+=2){const x=Math.floor(i[u]),p=Math.floor(i[u+1]);if(x<-1||x>o||p<-1||p>l)throw new ae;f=!1,x===-1?(i[u]=0,f=!0):x===o&&(i[u]=o-1,f=!0),p===-1?(i[u+1]=0,f=!0):p===l&&(i[u+1]=l-1,f=!0)}f=!0;for(let u=i.length-2;u>=0&&f;u-=2){const x=Math.floor(i[u]),p=Math.floor(i[u+1]);if(x<-1||x>o||p<-1||p>l)throw new ae;f=!1,x===-1?(i[u]=0,f=!0):x===o&&(i[u]=o-1,f=!0),p===-1?(i[u+1]=0,f=!0):p===l&&(i[u+1]=l-1,f=!0)}}}class Or{constructor(a,i,o,l,f,u,x,p,y){this.a11=a,this.a21=i,this.a31=o,this.a12=l,this.a22=f,this.a32=u,this.a13=x,this.a23=p,this.a33=y}static quadrilateralToQuadrilateral(a,i,o,l,f,u,x,p,y,b,I,R,G,Q,re,ue){const Ae=Or.quadrilateralToSquare(a,i,o,l,f,u,x,p);return Or.squareToQuadrilateral(y,b,I,R,G,Q,re,ue).times(Ae)}transformPoints(a){const i=a.length,o=this.a11,l=this.a12,f=this.a13,u=this.a21,x=this.a22,p=this.a23,y=this.a31,b=this.a32,I=this.a33;for(let R=0;R<i;R+=2){const G=a[R],Q=a[R+1],re=f*G+p*Q+I;a[R]=(o*G+u*Q+y)/re,a[R+1]=(l*G+x*Q+b)/re}}transformPointsWithValues(a,i){const o=this.a11,l=this.a12,f=this.a13,u=this.a21,x=this.a22,p=this.a23,y=this.a31,b=this.a32,I=this.a33,R=a.length;for(let G=0;G<R;G++){const Q=a[G],re=i[G],ue=f*Q+p*re+I;a[G]=(o*Q+u*re+y)/ue,i[G]=(l*Q+x*re+b)/ue}}static squareToQuadrilateral(a,i,o,l,f,u,x,p){const y=a-o+f-x,b=i-l+u-p;if(y===0&&b===0)return new Or(o-a,f-o,a,l-i,u-l,i,0,0,1);{const I=o-f,R=x-f,G=l-u,Q=p-u,re=I*Q-R*G,ue=(y*Q-R*b)/re,Ae=(I*b-y*G)/re;return new Or(o-a+ue*o,x-a+Ae*x,a,l-i+ue*l,p-i+Ae*p,i,ue,Ae,1)}}static quadrilateralToSquare(a,i,o,l,f,u,x,p){return Or.squareToQuadrilateral(a,i,o,l,f,u,x,p).buildAdjoint()}buildAdjoint(){return new Or(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(a){return new Or(this.a11*a.a11+this.a21*a.a12+this.a31*a.a13,this.a11*a.a21+this.a21*a.a22+this.a31*a.a23,this.a11*a.a31+this.a21*a.a32+this.a31*a.a33,this.a12*a.a11+this.a22*a.a12+this.a32*a.a13,this.a12*a.a21+this.a22*a.a22+this.a32*a.a23,this.a12*a.a31+this.a22*a.a32+this.a32*a.a33,this.a13*a.a11+this.a23*a.a12+this.a33*a.a13,this.a13*a.a21+this.a23*a.a22+this.a33*a.a23,this.a13*a.a31+this.a23*a.a32+this.a33*a.a33)}}class $n extends xa{sampleGrid(a,i,o,l,f,u,x,p,y,b,I,R,G,Q,re,ue,Ae,Ke,Ze){const Xe=Or.quadrilateralToQuadrilateral(l,f,u,x,p,y,b,I,R,G,Q,re,ue,Ae,Ke,Ze);return this.sampleGridWithTransform(a,i,o,Xe)}sampleGridWithTransform(a,i,o,l){if(i<=0||o<=0)throw new ae;const f=new $e(i,o),u=new Float32Array(2*i);for(let x=0;x<o;x++){const p=u.length,y=x+.5;for(let b=0;b<p;b+=2)u[b]=b/2+.5,u[b+1]=y;l.transformPoints(u),xa.checkAndNudgePoints(a,u);try{for(let b=0;b<p;b+=2)a.get(Math.floor(u[b]),Math.floor(u[b+1]))&&f.set(b/2,x)}catch{throw new ae}}return f}}class Ar{static setGridSampler(a){Ar.gridSampler=a}static getInstance(){return Ar.gridSampler}}Ar.gridSampler=new $n;class Yt{constructor(a,i){this.x=a,this.y=i}toResultPoint(){return new st(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class St{constructor(a){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=a}detect(){return this.detectMirror(!1)}detectMirror(a){let i=this.getMatrixCenter(),o=this.getBullsEyeCorners(i);if(a){let u=o[0];o[0]=o[2],o[2]=u}this.extractParameters(o);let l=this.sampleGrid(this.image,o[this.shift%4],o[(this.shift+1)%4],o[(this.shift+2)%4],o[(this.shift+3)%4]),f=this.getMatrixCornerPoints(o);return new ln(l,f,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(a){if(!this.isValidPoint(a[0])||!this.isValidPoint(a[1])||!this.isValidPoint(a[2])||!this.isValidPoint(a[3]))throw new ae;let i=2*this.nbCenterLayers,o=new Int32Array([this.sampleLine(a[0],a[1],i),this.sampleLine(a[1],a[2],i),this.sampleLine(a[2],a[3],i),this.sampleLine(a[3],a[0],i)]);this.shift=this.getRotation(o,i);let l=0;for(let u=0;u<4;u++){let x=o[(this.shift+u)%4];this.compact?(l<<=7,l+=x>>1&127):(l<<=10,l+=(x>>2&992)+(x>>1&31))}let f=this.getCorrectedParameterData(l,this.compact);this.compact?(this.nbLayers=(f>>6)+1,this.nbDataBlocks=(f&63)+1):(this.nbLayers=(f>>11)+1,this.nbDataBlocks=(f&2047)+1)}getRotation(a,i){let o=0;a.forEach((l,f,u)=>{let x=(l>>i-2<<1)+(l&1);o=(o<<3)+x}),o=((o&1)<<11)+(o>>1);for(let l=0;l<4;l++)if(O.bitCount(o^this.EXPECTED_CORNER_BITS[l])<=2)return l;throw new ae}getCorrectedParameterData(a,i){let o,l;i?(o=7,l=2):(o=10,l=4);let f=o-l,u=new Int32Array(o);for(let p=o-1;p>=0;--p)u[p]=a&15,a>>=4;try{new ze(Y.AZTEC_PARAM).decode(u,f)}catch{throw new ae}let x=0;for(let p=0;p<l;p++)x=(x<<4)+u[p];return x}getBullsEyeCorners(a){let i=a,o=a,l=a,f=a,u=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let I=this.getFirstDifferent(i,u,1,-1),R=this.getFirstDifferent(o,u,1,1),G=this.getFirstDifferent(l,u,-1,1),Q=this.getFirstDifferent(f,u,-1,-1);if(this.nbCenterLayers>2){let re=this.distancePoint(Q,I)*this.nbCenterLayers/(this.distancePoint(f,i)*(this.nbCenterLayers+2));if(re<.75||re>1.25||!this.isWhiteOrBlackRectangle(I,R,G,Q))break}i=I,o=R,l=G,f=Q,u=!u}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new ae;this.compact=this.nbCenterLayers===5;let x=new st(i.getX()+.5,i.getY()-.5),p=new st(o.getX()+.5,o.getY()+.5),y=new st(l.getX()-.5,l.getY()+.5),b=new st(f.getX()-.5,f.getY()-.5);return this.expandSquare([x,p,y,b],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let a,i,o,l;try{let x=new Dr(this.image).detect();a=x[0],i=x[1],o=x[2],l=x[3]}catch{let p=this.image.getWidth()/2,y=this.image.getHeight()/2;a=this.getFirstDifferent(new Yt(p+7,y-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new Yt(p+7,y+7),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new Yt(p-7,y+7),!1,-1,1).toResultPoint(),l=this.getFirstDifferent(new Yt(p-7,y-7),!1,-1,-1).toResultPoint()}let f=Et.round((a.getX()+l.getX()+i.getX()+o.getX())/4),u=Et.round((a.getY()+l.getY()+i.getY()+o.getY())/4);try{let x=new Dr(this.image,15,f,u).detect();a=x[0],i=x[1],o=x[2],l=x[3]}catch{a=this.getFirstDifferent(new Yt(f+7,u-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new Yt(f+7,u+7),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new Yt(f-7,u+7),!1,-1,1).toResultPoint(),l=this.getFirstDifferent(new Yt(f-7,u-7),!1,-1,-1).toResultPoint()}return f=Et.round((a.getX()+l.getX()+i.getX()+o.getX())/4),u=Et.round((a.getY()+l.getY()+i.getY()+o.getY())/4),new Yt(f,u)}getMatrixCornerPoints(a){return this.expandSquare(a,2*this.nbCenterLayers,this.getDimension())}sampleGrid(a,i,o,l,f){let u=Ar.getInstance(),x=this.getDimension(),p=x/2-this.nbCenterLayers,y=x/2+this.nbCenterLayers;return u.sampleGrid(a,x,x,p,p,y,p,y,y,p,y,i.getX(),i.getY(),o.getX(),o.getY(),l.getX(),l.getY(),f.getX(),f.getY())}sampleLine(a,i,o){let l=0,f=this.distanceResultPoint(a,i),u=f/o,x=a.getX(),p=a.getY(),y=u*(i.getX()-a.getX())/f,b=u*(i.getY()-a.getY())/f;for(let I=0;I<o;I++)this.image.get(Et.round(x+I*y),Et.round(p+I*b))&&(l|=1<<o-I-1);return l}isWhiteOrBlackRectangle(a,i,o,l){let f=3;a=new Yt(a.getX()-f,a.getY()+f),i=new Yt(i.getX()-f,i.getY()-f),o=new Yt(o.getX()+f,o.getY()-f),l=new Yt(l.getX()+f,l.getY()+f);let u=this.getColor(l,a);if(u===0)return!1;let x=this.getColor(a,i);return x!==u||(x=this.getColor(i,o),x!==u)?!1:(x=this.getColor(o,l),x===u)}getColor(a,i){let o=this.distancePoint(a,i),l=(i.getX()-a.getX())/o,f=(i.getY()-a.getY())/o,u=0,x=a.getX(),p=a.getY(),y=this.image.get(a.getX(),a.getY()),b=Math.ceil(o);for(let R=0;R<b;R++)x+=l,p+=f,this.image.get(Et.round(x),Et.round(p))!==y&&u++;let I=u/o;return I>.1&&I<.9?0:I<=.1===y?1:-1}getFirstDifferent(a,i,o,l){let f=a.getX()+o,u=a.getY()+l;for(;this.isValid(f,u)&&this.image.get(f,u)===i;)f+=o,u+=l;for(f-=o,u-=l;this.isValid(f,u)&&this.image.get(f,u)===i;)f+=o;for(f-=o;this.isValid(f,u)&&this.image.get(f,u)===i;)u+=l;return u-=l,new Yt(f,u)}expandSquare(a,i,o){let l=o/(2*i),f=a[0].getX()-a[2].getX(),u=a[0].getY()-a[2].getY(),x=(a[0].getX()+a[2].getX())/2,p=(a[0].getY()+a[2].getY())/2,y=new st(x+l*f,p+l*u),b=new st(x-l*f,p-l*u);f=a[1].getX()-a[3].getX(),u=a[1].getY()-a[3].getY(),x=(a[1].getX()+a[3].getX())/2,p=(a[1].getY()+a[3].getY())/2;let I=new st(x+l*f,p+l*u),R=new st(x-l*f,p-l*u);return[y,I,b,R]}isValid(a,i){return a>=0&&a<this.image.getWidth()&&i>0&&i<this.image.getHeight()}isValidPoint(a){let i=Et.round(a.getX()),o=Et.round(a.getY());return this.isValid(i,o)}distancePoint(a,i){return Et.distance(a.getX(),a.getY(),i.getX(),i.getY())}distanceResultPoint(a,i){return Et.distance(a.getX(),a.getY(),i.getX(),i.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(O.truncDivision(this.nbLayers-4,8)+1)+15}}class cr{decode(a,i=null){let o=null,l=new St(a.getBlackMatrix()),f=null,u=null;try{let b=l.detectMirror(!1);f=b.getPoints(),this.reportFoundResultPoints(i,f),u=new ft().decode(b)}catch(b){o=b}if(u==null)try{let b=l.detectMirror(!0);f=b.getPoints(),this.reportFoundResultPoints(i,f),u=new ft().decode(b)}catch(b){throw o??b}let x=new ee(u.getText(),u.getRawBytes(),u.getNumBits(),f,le.AZTEC,S.currentTimeMillis()),p=u.getByteSegments();p!=null&&x.putMetadata(Le.BYTE_SEGMENTS,p);let y=u.getECLevel();return y!=null&&x.putMetadata(Le.ERROR_CORRECTION_LEVEL,y),x}reportFoundResultPoints(a,i){if(a!=null){let o=a.get(J.NEED_RESULT_POINT_CALLBACK);o!=null&&i.forEach((l,f,u)=>{o.foundPossibleResultPoint(l)})}}reset(){}}class sa extends ce{constructor(a=500){super(new cr,a)}}class Mt{decode(a,i){try{return this.doDecode(a,i)}catch{if(i&&i.get(J.TRY_HARDER)===!0&&a.isRotateSupported()){const f=a.rotateCounterClockwise(),u=this.doDecode(f,i),x=u.getResultMetadata();let p=270;x!==null&&x.get(Le.ORIENTATION)===!0&&(p=p+x.get(Le.ORIENTATION)%360),u.putMetadata(Le.ORIENTATION,p);const y=u.getResultPoints();if(y!==null){const b=f.getHeight();for(let I=0;I<y.length;I++)y[I]=new st(b-y[I].getY()-1,y[I].getX())}return u}else throw new ae}}reset(){}doDecode(a,i){const o=a.getWidth(),l=a.getHeight();let f=new q(o);const u=i&&i.get(J.TRY_HARDER)===!0,x=Math.max(1,l>>(u?8:5));let p;u?p=l:p=15;const y=Math.trunc(l/2);for(let b=0;b<p;b++){const I=Math.trunc((b+1)/2),R=(b&1)===0,G=y+x*(R?I:-I);if(G<0||G>=l)break;try{f=a.getBlackRow(G,f)}catch{continue}for(let Q=0;Q<2;Q++){if(Q===1&&(f.reverse(),i&&i.get(J.NEED_RESULT_POINT_CALLBACK)===!0)){const re=new Map;i.forEach((ue,Ae)=>re.set(Ae,ue)),re.delete(J.NEED_RESULT_POINT_CALLBACK),i=re}try{const re=this.decodeRow(G,f,i);if(Q===1){re.putMetadata(Le.ORIENTATION,180);const ue=re.getResultPoints();ue!==null&&(ue[0]=new st(o-ue[0].getX()-1,ue[0].getY()),ue[1]=new st(o-ue[1].getX()-1,ue[1].getY()))}return re}catch{}}}throw new ae}static recordPattern(a,i,o){const l=o.length;for(let y=0;y<l;y++)o[y]=0;const f=a.getSize();if(i>=f)throw new ae;let u=!a.get(i),x=0,p=i;for(;p<f;){if(a.get(p)!==u)o[x]++;else{if(++x===l)break;o[x]=1,u=!u}p++}if(!(x===l||x===l-1&&p===f))throw new ae}static recordPatternInReverse(a,i,o){let l=o.length,f=a.get(i);for(;i>0&&l>=0;)a.get(--i)!==f&&(l--,f=!f);if(l>=0)throw new ae;Mt.recordPattern(a,i+1,o)}static patternMatchVariance(a,i,o){const l=a.length;let f=0,u=0;for(let y=0;y<l;y++)f+=a[y],u+=i[y];if(f<u)return Number.POSITIVE_INFINITY;const x=f/u;o*=x;let p=0;for(let y=0;y<l;y++){const b=a[y],I=i[y]*x,R=b>I?b-I:I-b;if(R>o)return Number.POSITIVE_INFINITY;p+=R}return p/f}}class Qe extends Mt{static findStartPattern(a){const i=a.getSize(),o=a.getNextSet(0);let l=0,f=Int32Array.from([0,0,0,0,0,0]),u=o,x=!1;const p=6;for(let y=o;y<i;y++)if(a.get(y)!==x)f[l]++;else{if(l===p-1){let b=Qe.MAX_AVG_VARIANCE,I=-1;for(let R=Qe.CODE_START_A;R<=Qe.CODE_START_C;R++){const G=Mt.patternMatchVariance(f,Qe.CODE_PATTERNS[R],Qe.MAX_INDIVIDUAL_VARIANCE);G<b&&(b=G,I=R)}if(I>=0&&a.isRange(Math.max(0,u-(y-u)/2),u,!1))return Int32Array.from([u,y,I]);u+=f[0]+f[1],f=f.slice(2,f.length-1),f[l-1]=0,f[l]=0,l--}else l++;f[l]=1,x=!x}throw new ae}static decodeCode(a,i,o){Mt.recordPattern(a,o,i);let l=Qe.MAX_AVG_VARIANCE,f=-1;for(let u=0;u<Qe.CODE_PATTERNS.length;u++){const x=Qe.CODE_PATTERNS[u],p=this.patternMatchVariance(i,x,Qe.MAX_INDIVIDUAL_VARIANCE);p<l&&(l=p,f=u)}if(f>=0)return f;throw new ae}decodeRow(a,i,o){const l=o&&o.get(J.ASSUME_GS1)===!0,f=Qe.findStartPattern(i),u=f[2];let x=0;const p=new Uint8Array(20);p[x++]=u;let y;switch(u){case Qe.CODE_START_A:y=Qe.CODE_CODE_A;break;case Qe.CODE_START_B:y=Qe.CODE_CODE_B;break;case Qe.CODE_START_C:y=Qe.CODE_CODE_C;break;default:throw new M}let b=!1,I=!1,R="",G=f[0],Q=f[1];const re=Int32Array.from([0,0,0,0,0,0]);let ue=0,Ae=0,Ke=u,Ze=0,Xe=!0,Ht=!1,kt=!1;for(;!b;){const Ci=I;switch(I=!1,ue=Ae,Ae=Qe.decodeCode(i,re,Q),p[x++]=Ae,Ae!==Qe.CODE_STOP&&(Xe=!0),Ae!==Qe.CODE_STOP&&(Ze++,Ke+=Ze*Ae),G=Q,Q+=re.reduce((no,E)=>no+E,0),Ae){case Qe.CODE_START_A:case Qe.CODE_START_B:case Qe.CODE_START_C:throw new M}switch(y){case Qe.CODE_CODE_A:if(Ae<64)kt===Ht?R+=String.fromCharCode(32+Ae):R+=String.fromCharCode(32+Ae+128),kt=!1;else if(Ae<96)kt===Ht?R+=String.fromCharCode(Ae-64):R+=String.fromCharCode(Ae+64),kt=!1;else switch(Ae!==Qe.CODE_STOP&&(Xe=!1),Ae){case Qe.CODE_FNC_1:l&&(R.length===0?R+="]C1":R+="");break;case Qe.CODE_FNC_2:case Qe.CODE_FNC_3:break;case Qe.CODE_FNC_4_A:!Ht&&kt?(Ht=!0,kt=!1):Ht&&kt?(Ht=!1,kt=!1):kt=!0;break;case Qe.CODE_SHIFT:I=!0,y=Qe.CODE_CODE_B;break;case Qe.CODE_CODE_B:y=Qe.CODE_CODE_B;break;case Qe.CODE_CODE_C:y=Qe.CODE_CODE_C;break;case Qe.CODE_STOP:b=!0;break}break;case Qe.CODE_CODE_B:if(Ae<96)kt===Ht?R+=String.fromCharCode(32+Ae):R+=String.fromCharCode(32+Ae+128),kt=!1;else switch(Ae!==Qe.CODE_STOP&&(Xe=!1),Ae){case Qe.CODE_FNC_1:l&&(R.length===0?R+="]C1":R+="");break;case Qe.CODE_FNC_2:case Qe.CODE_FNC_3:break;case Qe.CODE_FNC_4_B:!Ht&&kt?(Ht=!0,kt=!1):Ht&&kt?(Ht=!1,kt=!1):kt=!0;break;case Qe.CODE_SHIFT:I=!0,y=Qe.CODE_CODE_A;break;case Qe.CODE_CODE_A:y=Qe.CODE_CODE_A;break;case Qe.CODE_CODE_C:y=Qe.CODE_CODE_C;break;case Qe.CODE_STOP:b=!0;break}break;case Qe.CODE_CODE_C:if(Ae<100)Ae<10&&(R+="0"),R+=Ae;else switch(Ae!==Qe.CODE_STOP&&(Xe=!1),Ae){case Qe.CODE_FNC_1:l&&(R.length===0?R+="]C1":R+="");break;case Qe.CODE_CODE_A:y=Qe.CODE_CODE_A;break;case Qe.CODE_CODE_B:y=Qe.CODE_CODE_B;break;case Qe.CODE_STOP:b=!0;break}break}Ci&&(y=y===Qe.CODE_CODE_A?Qe.CODE_CODE_B:Qe.CODE_CODE_A)}const _a=Q-G;if(Q=i.getNextUnset(Q),!i.isRange(Q,Math.min(i.getSize(),Q+(Q-G)/2),!1))throw new ae;if(Ke-=Ze*ue,Ke%103!==ue)throw new T;const $a=R.length;if($a===0)throw new ae;$a>0&&Xe&&(y===Qe.CODE_CODE_C?R=R.substring(0,$a-2):R=R.substring(0,$a-1));const la=(f[1]+f[0])/2,sr=G+_a/2,Hr=p.length,Aa=new Uint8Array(Hr);for(let Ci=0;Ci<Hr;Ci++)Aa[Ci]=p[Ci];const en=[new st(la,a),new st(sr,a)];return new ee(R,Aa,0,en,le.CODE_128,new Date().getTime())}}Qe.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Qe.MAX_AVG_VARIANCE=.25,Qe.MAX_INDIVIDUAL_VARIANCE=.7,Qe.CODE_SHIFT=98,Qe.CODE_CODE_C=99,Qe.CODE_CODE_B=100,Qe.CODE_CODE_A=101,Qe.CODE_FNC_1=102,Qe.CODE_FNC_2=97,Qe.CODE_FNC_3=96,Qe.CODE_FNC_4_A=101,Qe.CODE_FNC_4_B=100,Qe.CODE_START_A=103,Qe.CODE_START_B=104,Qe.CODE_START_C=105,Qe.CODE_STOP=106;class br extends Mt{constructor(a=!1,i=!1){super(),this.usingCheckDigit=a,this.extendedMode=i,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(a,i,o){let l=this.counters;l.fill(0),this.decodeRowResult="";let f=br.findAsteriskPattern(i,l),u=i.getNextSet(f[1]),x=i.getSize(),p,y;do{br.recordPattern(i,u,l);let re=br.toNarrowWidePattern(l);if(re<0)throw new ae;p=br.patternToChar(re),this.decodeRowResult+=p,y=u;for(let ue of l)u+=ue;u=i.getNextSet(u)}while(p!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let b=0;for(let re of l)b+=re;let I=u-y-b;if(u!==x&&I*2<b)throw new ae;if(this.usingCheckDigit){let re=this.decodeRowResult.length-1,ue=0;for(let Ae=0;Ae<re;Ae++)ue+=br.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(Ae));if(this.decodeRowResult.charAt(re)!==br.ALPHABET_STRING.charAt(ue%43))throw new T;this.decodeRowResult=this.decodeRowResult.substring(0,re)}if(this.decodeRowResult.length===0)throw new ae;let R;this.extendedMode?R=br.decodeExtended(this.decodeRowResult):R=this.decodeRowResult;let G=(f[1]+f[0])/2,Q=y+b/2;return new ee(R,null,0,[new st(G,a),new st(Q,a)],le.CODE_39,new Date().getTime())}static findAsteriskPattern(a,i){let o=a.getSize(),l=a.getNextSet(0),f=0,u=l,x=!1,p=i.length;for(let y=l;y<o;y++)if(a.get(y)!==x)i[f]++;else{if(f===p-1){if(this.toNarrowWidePattern(i)===br.ASTERISK_ENCODING&&a.isRange(Math.max(0,u-Math.floor((y-u)/2)),u,!1))return[u,y];u+=i[0]+i[1],i.copyWithin(0,2,2+f-1),i[f-1]=0,i[f]=0,f--}else f++;i[f]=1,x=!x}throw new ae}static toNarrowWidePattern(a){let i=a.length,o=0,l;do{let f=2147483647;for(let p of a)p<f&&p>o&&(f=p);o=f,l=0;let u=0,x=0;for(let p=0;p<i;p++){let y=a[p];y>o&&(x|=1<<i-1-p,l++,u+=y)}if(l===3){for(let p=0;p<i&&l>0;p++){let y=a[p];if(y>o&&(l--,y*2>=u))return-1}return x}}while(l>3);return-1}static patternToChar(a){for(let i=0;i<br.CHARACTER_ENCODINGS.length;i++)if(br.CHARACTER_ENCODINGS[i]===a)return br.ALPHABET_STRING.charAt(i);if(a===br.ASTERISK_ENCODING)return"*";throw new ae}static decodeExtended(a){let i=a.length,o="";for(let l=0;l<i;l++){let f=a.charAt(l);if(f==="+"||f==="$"||f==="%"||f==="/"){let u=a.charAt(l+1),x="\0";switch(f){case"+":if(u>="A"&&u<="Z")x=String.fromCharCode(u.charCodeAt(0)+32);else throw new M;break;case"$":if(u>="A"&&u<="Z")x=String.fromCharCode(u.charCodeAt(0)-64);else throw new M;break;case"%":if(u>="A"&&u<="E")x=String.fromCharCode(u.charCodeAt(0)-38);else if(u>="F"&&u<="J")x=String.fromCharCode(u.charCodeAt(0)-11);else if(u>="K"&&u<="O")x=String.fromCharCode(u.charCodeAt(0)+16);else if(u>="P"&&u<="T")x=String.fromCharCode(u.charCodeAt(0)+43);else if(u==="U")x="\0";else if(u==="V")x="@";else if(u==="W")x="`";else if(u==="X"||u==="Y"||u==="Z")x="";else throw new M;break;case"/":if(u>="A"&&u<="O")x=String.fromCharCode(u.charCodeAt(0)-32);else if(u==="Z")x=":";else throw new M;break}o+=x,l++}else o+=f}return o}}br.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",br.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],br.ASTERISK_ENCODING=148;class ar extends Mt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(a,i,o){let l=this.decodeStart(i),f=this.decodeEnd(i),u=new be;ar.decodeMiddle(i,l[1],f[0],u);let x=u.toString(),p=null;o!=null&&(p=o.get(J.ALLOWED_LENGTHS)),p==null&&(p=ar.DEFAULT_ALLOWED_LENGTHS);let y=x.length,b=!1,I=0;for(let Q of p){if(y===Q){b=!0;break}Q>I&&(I=Q)}if(!b&&y>I&&(b=!0),!b)throw new M;const R=[new st(l[1],a),new st(f[0],a)];return new ee(x,null,0,R,le.ITF,new Date().getTime())}static decodeMiddle(a,i,o,l){let f=new Int32Array(10),u=new Int32Array(5),x=new Int32Array(5);for(f.fill(0),u.fill(0),x.fill(0);i<o;){Mt.recordPattern(a,i,f);for(let y=0;y<5;y++){let b=2*y;u[y]=f[b],x[y]=f[b+1]}let p=ar.decodeDigit(u);l.append(p.toString()),p=this.decodeDigit(x),l.append(p.toString()),f.forEach(function(y){i+=y})}}decodeStart(a){let i=ar.skipWhiteSpace(a),o=ar.findGuardPattern(a,i,ar.START_PATTERN);return this.narrowLineWidth=(o[1]-o[0])/4,this.validateQuietZone(a,o[0]),o}validateQuietZone(a,i){let o=this.narrowLineWidth*10;o=o<i?o:i;for(let l=i-1;o>0&&l>=0&&!a.get(l);l--)o--;if(o!==0)throw new ae}static skipWhiteSpace(a){const i=a.getSize(),o=a.getNextSet(0);if(o===i)throw new ae;return o}decodeEnd(a){a.reverse();try{let i=ar.skipWhiteSpace(a),o;try{o=ar.findGuardPattern(a,i,ar.END_PATTERN_REVERSED[0])}catch(f){f instanceof ae&&(o=ar.findGuardPattern(a,i,ar.END_PATTERN_REVERSED[1]))}this.validateQuietZone(a,o[0]);let l=o[0];return o[0]=a.getSize()-o[1],o[1]=a.getSize()-l,o}finally{a.reverse()}}static findGuardPattern(a,i,o){let l=o.length,f=new Int32Array(l),u=a.getSize(),x=!1,p=0,y=i;f.fill(0);for(let b=i;b<u;b++)if(a.get(b)!==x)f[p]++;else{if(p===l-1){if(Mt.patternMatchVariance(f,o,ar.MAX_INDIVIDUAL_VARIANCE)<ar.MAX_AVG_VARIANCE)return[y,b];y+=f[0]+f[1],S.arraycopy(f,2,f,0,p-1),f[p-1]=0,f[p]=0,p--}else p++;f[p]=1,x=!x}throw new ae}static decodeDigit(a){let i=ar.MAX_AVG_VARIANCE,o=-1,l=ar.PATTERNS.length;for(let f=0;f<l;f++){let u=ar.PATTERNS[f],x=Mt.patternMatchVariance(a,u,ar.MAX_INDIVIDUAL_VARIANCE);x<i?(i=x,o=f):x===i&&(o=-1)}if(o>=0)return o%10;throw new ae}}ar.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],ar.MAX_AVG_VARIANCE=.38,ar.MAX_INDIVIDUAL_VARIANCE=.5,ar.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],ar.START_PATTERN=Int32Array.from([1,1,1,1]),ar.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class pr extends Mt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(a){let i=!1,o,l=0,f=Int32Array.from([0,0,0]);for(;!i;){f=Int32Array.from([0,0,0]),o=pr.findGuardPattern(a,l,!1,this.START_END_PATTERN,f);let u=o[0];l=o[1];let x=u-(l-u);x>=0&&(i=a.isRange(x,u,!1))}return o}static checkChecksum(a){return pr.checkStandardUPCEANChecksum(a)}static checkStandardUPCEANChecksum(a){let i=a.length;if(i===0)return!1;let o=parseInt(a.charAt(i-1),10);return pr.getStandardUPCEANChecksum(a.substring(0,i-1))===o}static getStandardUPCEANChecksum(a){let i=a.length,o=0;for(let l=i-1;l>=0;l-=2){let f=a.charAt(l).charCodeAt(0)-48;if(f<0||f>9)throw new M;o+=f}o*=3;for(let l=i-2;l>=0;l-=2){let f=a.charAt(l).charCodeAt(0)-48;if(f<0||f>9)throw new M;o+=f}return(1e3-o)%10}static decodeEnd(a,i){return pr.findGuardPattern(a,i,!1,pr.START_END_PATTERN,new Int32Array(pr.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(a,i,o,l){return this.findGuardPattern(a,i,o,l,new Int32Array(l.length))}static findGuardPattern(a,i,o,l,f){let u=a.getSize();i=o?a.getNextUnset(i):a.getNextSet(i);let x=0,p=i,y=l.length,b=o;for(let I=i;I<u;I++)if(a.get(I)!==b)f[x]++;else{if(x===y-1){if(Mt.patternMatchVariance(f,l,pr.MAX_INDIVIDUAL_VARIANCE)<pr.MAX_AVG_VARIANCE)return Int32Array.from([p,I]);p+=f[0]+f[1];let R=f.slice(2,f.length-1);for(let G=0;G<x-1;G++)f[G]=R[G];f[x-1]=0,f[x]=0,x--}else x++;f[x]=1,b=!b}throw new ae}static decodeDigit(a,i,o,l){this.recordPattern(a,o,i);let f=this.MAX_AVG_VARIANCE,u=-1,x=l.length;for(let p=0;p<x;p++){let y=l[p],b=Mt.patternMatchVariance(i,y,pr.MAX_INDIVIDUAL_VARIANCE);b<f&&(f=b,u=p)}if(u>=0)return u;throw new ae}}pr.MAX_AVG_VARIANCE=.48,pr.MAX_INDIVIDUAL_VARIANCE=.7,pr.START_END_PATTERN=Int32Array.from([1,1,1]),pr.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),pr.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),pr.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Mn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(a,i,o){let l=this.decodeRowStringBuffer,f=this.decodeMiddle(i,o,l),u=l.toString(),x=Mn.parseExtensionString(u),p=[new st((o[0]+o[1])/2,a),new st(f,a)],y=new ee(u,null,0,p,le.UPC_EAN_EXTENSION,new Date().getTime());return x!=null&&y.putAllMetadata(x),y}decodeMiddle(a,i,o){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let f=a.getSize(),u=i[1],x=0;for(let y=0;y<5&&u<f;y++){let b=pr.decodeDigit(a,l,u,pr.L_AND_G_PATTERNS);o+=String.fromCharCode(48+b%10);for(let I of l)u+=I;b>=10&&(x|=1<<4-y),y!==4&&(u=a.getNextSet(u),u=a.getNextUnset(u))}if(o.length!==5)throw new ae;let p=this.determineCheckDigit(x);if(Mn.extensionChecksum(o.toString())!==p)throw new ae;return u}static extensionChecksum(a){let i=a.length,o=0;for(let l=i-2;l>=0;l-=2)o+=a.charAt(l).charCodeAt(0)-48;o*=3;for(let l=i-1;l>=0;l-=2)o+=a.charAt(l).charCodeAt(0)-48;return o*=3,o%10}determineCheckDigit(a){for(let i=0;i<10;i++)if(a===this.CHECK_DIGIT_ENCODINGS[i])return i;throw new ae}static parseExtensionString(a){if(a.length!==5)return null;let i=Mn.parseExtension5String(a);return i==null?null:new Map([[Le.SUGGESTED_PRICE,i]])}static parseExtension5String(a){let i;switch(a.charAt(0)){case"0":i="£";break;case"5":i="$";break;case"9":switch(a){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}i="";break;default:i="";break}let o=parseInt(a.substring(1)),l=(o/100).toString(),f=o%100,u=f<10?"0"+f:f.toString();return i+l+"."+u}}class fn{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(a,i,o){let l=this.decodeRowStringBuffer,f=this.decodeMiddle(i,o,l),u=l.toString(),x=fn.parseExtensionString(u),p=[new st((o[0]+o[1])/2,a),new st(f,a)],y=new ee(u,null,0,p,le.UPC_EAN_EXTENSION,new Date().getTime());return x!=null&&y.putAllMetadata(x),y}decodeMiddle(a,i,o){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let f=a.getSize(),u=i[1],x=0;for(let p=0;p<2&&u<f;p++){let y=pr.decodeDigit(a,l,u,pr.L_AND_G_PATTERNS);o+=String.fromCharCode(48+y%10);for(let b of l)u+=b;y>=10&&(x|=1<<1-p),p!==1&&(u=a.getNextSet(u),u=a.getNextUnset(u))}if(o.length!==2)throw new ae;if(parseInt(o.toString())%4!==x)throw new ae;return u}static parseExtensionString(a){return a.length!==2?null:new Map([[Le.ISSUE_NUMBER,parseInt(a)]])}}class vi{static decodeRow(a,i,o){let l=pr.findGuardPattern(i,o,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Mn().decodeRow(a,i,l)}catch{return new fn().decodeRow(a,i,l)}}}vi.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Bt extends pr{constructor(){super(),this.decodeRowStringBuffer="",Bt.L_AND_G_PATTERNS=Bt.L_PATTERNS.map(a=>Int32Array.from(a));for(let a=10;a<20;a++){let i=Bt.L_PATTERNS[a-10],o=new Int32Array(i.length);for(let l=0;l<i.length;l++)o[l]=i[i.length-l-1];Bt.L_AND_G_PATTERNS[a]=o}}decodeRow(a,i,o){let l=Bt.findStartGuardPattern(i),f=o==null?null:o.get(J.NEED_RESULT_POINT_CALLBACK);if(f!=null){const Xe=new st((l[0]+l[1])/2,a);f.foundPossibleResultPoint(Xe)}let u=this.decodeMiddle(i,l,this.decodeRowStringBuffer),x=u.rowOffset,p=u.resultString;if(f!=null){const Xe=new st(x,a);f.foundPossibleResultPoint(Xe)}let y=this.decodeEnd(i,x);if(f!=null){const Xe=new st((y[0]+y[1])/2,a);f.foundPossibleResultPoint(Xe)}let b=y[1],I=b+(b-y[0]);if(I>=i.getSize()||!i.isRange(b,I,!1))throw new ae;let R=p.toString();if(R.length<8)throw new M;if(!Bt.checkChecksum(R))throw new T;let G=(l[1]+l[0])/2,Q=(y[1]+y[0])/2,re=this.getBarcodeFormat(),ue=[new st(G,a),new st(Q,a)],Ae=new ee(R,null,0,ue,re,new Date().getTime()),Ke=0;try{let Xe=vi.decodeRow(a,i,y[1]);Ae.putMetadata(Le.UPC_EAN_EXTENSION,Xe.getText()),Ae.putAllMetadata(Xe.getResultMetadata()),Ae.addResultPoints(Xe.getResultPoints()),Ke=Xe.getText().length}catch{}let Ze=o==null?null:o.get(J.ALLOWED_EAN_EXTENSIONS);if(Ze!=null){let Xe=!1;for(let Ht in Ze)if(Ke.toString()===Ht){Xe=!0;break}if(!Xe)throw new ae}return Ae}decodeEnd(a,i){return Bt.findGuardPattern(a,i,!1,Bt.START_END_PATTERN,new Int32Array(Bt.START_END_PATTERN.length).fill(0))}static checkChecksum(a){return Bt.checkStandardUPCEANChecksum(a)}static checkStandardUPCEANChecksum(a){let i=a.length;if(i===0)return!1;let o=parseInt(a.charAt(i-1),10);return Bt.getStandardUPCEANChecksum(a.substring(0,i-1))===o}static getStandardUPCEANChecksum(a){let i=a.length,o=0;for(let l=i-1;l>=0;l-=2){let f=a.charAt(l).charCodeAt(0)-48;if(f<0||f>9)throw new M;o+=f}o*=3;for(let l=i-2;l>=0;l-=2){let f=a.charAt(l).charCodeAt(0)-48;if(f<0||f>9)throw new M;o+=f}return(1e3-o)%10}}class Ya extends Bt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(a,i,o){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let f=a.getSize(),u=i[1],x=0;for(let y=0;y<6&&u<f;y++){let b=Bt.decodeDigit(a,l,u,Bt.L_AND_G_PATTERNS);o+=String.fromCharCode(48+b%10);for(let I of l)u+=I;b>=10&&(x|=1<<5-y)}o=Ya.determineFirstDigit(o,x),u=Bt.findGuardPattern(a,u,!0,Bt.MIDDLE_PATTERN,new Int32Array(Bt.MIDDLE_PATTERN.length).fill(0))[1];for(let y=0;y<6&&u<f;y++){let b=Bt.decodeDigit(a,l,u,Bt.L_PATTERNS);o+=String.fromCharCode(48+b);for(let I of l)u+=I}return{rowOffset:u,resultString:o}}getBarcodeFormat(){return le.EAN_13}static determineFirstDigit(a,i){for(let o=0;o<10;o++)if(i===this.FIRST_DIGIT_ENCODINGS[o])return a=String.fromCharCode(48+o)+a,a;throw new ae}}Ya.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Ua extends Bt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(a,i,o){const l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let f=a.getSize(),u=i[1];for(let p=0;p<4&&u<f;p++){let y=Bt.decodeDigit(a,l,u,Bt.L_PATTERNS);o+=String.fromCharCode(48+y);for(let b of l)u+=b}u=Bt.findGuardPattern(a,u,!0,Bt.MIDDLE_PATTERN,new Int32Array(Bt.MIDDLE_PATTERN.length).fill(0))[1];for(let p=0;p<4&&u<f;p++){let y=Bt.decodeDigit(a,l,u,Bt.L_PATTERNS);o+=String.fromCharCode(48+y);for(let b of l)u+=b}return{rowOffset:u,resultString:o}}getBarcodeFormat(){return le.EAN_8}}class Hi extends Bt{constructor(){super(...arguments),this.ean13Reader=new Ya}getBarcodeFormat(){return le.UPC_A}decode(a,i){return this.maybeReturnResult(this.ean13Reader.decode(a))}decodeRow(a,i,o){return this.maybeReturnResult(this.ean13Reader.decodeRow(a,i,o))}decodeMiddle(a,i,o){return this.ean13Reader.decodeMiddle(a,i,o)}maybeReturnResult(a){let i=a.getText();if(i.charAt(0)==="0"){let o=new ee(i.substring(1),null,null,a.getResultPoints(),le.UPC_A);return a.getResultMetadata()!=null&&o.putAllMetadata(a.getResultMetadata()),o}else throw new ae}reset(){this.ean13Reader.reset()}}class oa extends Bt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(a,i,o){const l=this.decodeMiddleCounters.map(y=>y);l[0]=0,l[1]=0,l[2]=0,l[3]=0;const f=a.getSize();let u=i[1],x=0;for(let y=0;y<6&&u<f;y++){const b=oa.decodeDigit(a,l,u,oa.L_AND_G_PATTERNS);o+=String.fromCharCode(48+b%10);for(let I of l)u+=I;b>=10&&(x|=1<<5-y)}let p=oa.determineNumSysAndCheckDigit(o,x);return{rowOffset:u,resultString:p}}decodeEnd(a,i){return oa.findGuardPatternWithoutCounters(a,i,!0,oa.MIDDLE_END_PATTERN)}checkChecksum(a){return Bt.checkChecksum(oa.convertUPCEtoUPCA(a))}static determineNumSysAndCheckDigit(a,i){for(let o=0;o<=1;o++)for(let l=0;l<10;l++)if(i===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[o][l]){let f=String.fromCharCode(48+o),u=String.fromCharCode(48+l);return f+a+u}throw ae.getNotFoundInstance()}getBarcodeFormat(){return le.UPC_E}static convertUPCEtoUPCA(a){const i=a.slice(1,7).split("").map(f=>f.charCodeAt(0)),o=new be;o.append(a.charAt(0));let l=i[5];switch(l){case 0:case 1:case 2:o.appendChars(i,0,2),o.append(l),o.append("0000"),o.appendChars(i,2,3);break;case 3:o.appendChars(i,0,3),o.append("00000"),o.appendChars(i,3,2);break;case 4:o.appendChars(i,0,4),o.append("00000"),o.append(i[4]);break;default:o.appendChars(i,0,5),o.append("0000"),o.append(l);break}return a.length>=8&&o.append(a.charAt(7)),o.toString()}}oa.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),oa.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class yi extends Mt{constructor(a){super();let i=a==null?null:a.get(J.POSSIBLE_FORMATS),o=[];n(i)?(o.push(new Ya),o.push(new Hi),o.push(new Ua),o.push(new oa)):(i.indexOf(le.EAN_13)>-1&&o.push(new Ya),i.indexOf(le.UPC_A)>-1&&o.push(new Hi),i.indexOf(le.EAN_8)>-1&&o.push(new Ua),i.indexOf(le.UPC_E)>-1&&o.push(new oa)),this.readers=o}decodeRow(a,i,o){for(let l of this.readers)try{const f=l.decodeRow(a,i,o),u=f.getBarcodeFormat()===le.EAN_13&&f.getText().charAt(0)==="0",x=o==null?null:o.get(J.POSSIBLE_FORMATS),p=x==null||x.includes(le.UPC_A);if(u&&p){const y=f.getRawBytes(),b=new ee(f.getText().substring(1),y,y?y.length:null,f.getResultPoints(),le.UPC_A);return b.putAllMetadata(f.getResultMetadata()),b}return f}catch{}throw new ae}reset(){for(let a of this.readers)a.reset()}}class Er extends Mt{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(a,i){for(let o=0;o<i.length;o++)if(Mt.patternMatchVariance(a,i[o],Er.MAX_INDIVIDUAL_VARIANCE)<Er.MAX_AVG_VARIANCE)return o;throw new ae}static count(a){return Et.sum(new Int32Array(a))}static increment(a,i){let o=0,l=i[0];for(let f=1;f<a.length;f++)i[f]>l&&(l=i[f],o=f);a[o]++}static decrement(a,i){let o=0,l=i[0];for(let f=1;f<a.length;f++)i[f]<l&&(l=i[f],o=f);a[o]--}static isFinderPattern(a){let i=a[0]+a[1],o=i+a[2]+a[3],l=i/o;if(l>=Er.MIN_FINDER_PATTERN_RATIO&&l<=Er.MAX_FINDER_PATTERN_RATIO){let f=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;for(let x of a)x>u&&(u=x),x<f&&(f=x);return u<10*f}return!1}}Er.MAX_AVG_VARIANCE=.2,Er.MAX_INDIVIDUAL_VARIANCE=.45,Er.MIN_FINDER_PATTERN_RATIO=9.5/12,Er.MAX_FINDER_PATTERN_RATIO=12.5/14;class Ka{constructor(a,i){this.value=a,this.checksumPortion=i}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(a){if(!(a instanceof Ka))return!1;const i=a;return this.value===i.value&&this.checksumPortion===i.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Pn{constructor(a,i,o,l,f){this.value=a,this.startEnd=i,this.value=a,this.startEnd=i,this.resultPoints=new Array,this.resultPoints.push(new st(o,f)),this.resultPoints.push(new st(l,f))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(a){if(!(a instanceof Pn))return!1;const i=a;return this.value===i.value}hashCode(){return this.value}}class Wa{constructor(){}static getRSSvalue(a,i,o){let l=0;for(let p of a)l+=p;let f=0,u=0,x=a.length;for(let p=0;p<x-1;p++){let y;for(y=1,u|=1<<p;y<a[p];y++,u&=~(1<<p)){let b=Wa.combins(l-y-1,x-p-2);if(o&&u===0&&l-y-(x-p-1)>=x-p-1&&(b-=Wa.combins(l-y-(x-p),x-p-2)),x-p-1>1){let I=0;for(let R=l-y-(x-p-2);R>i;R--)I+=Wa.combins(l-y-R-1,x-p-3);b-=I*(x-1-p)}else l-y>i&&b--;f+=b}l-=y}return f}static combins(a,i){let o,l;a-i>i?(l=i,o=a-i):(l=a-i,o=i);let f=1,u=1;for(let x=a;x>o;x--)f*=x,u<=l&&(f/=u,u++);for(;u<=l;)f/=u,u++;return f}}class ya{static buildBitArray(a){let i=a.length*2-1;a[a.length-1].getRightChar()==null&&(i-=1);let o=12*i,l=new q(o),f=0,x=a[0].getRightChar().getValue();for(let p=11;p>=0;--p)x&1<<p&&l.set(f),f++;for(let p=1;p<a.length;++p){let y=a[p],b=y.getLeftChar().getValue();for(let I=11;I>=0;--I)b&1<<I&&l.set(f),f++;if(y.getRightChar()!=null){let I=y.getRightChar().getValue();for(let R=11;R>=0;--R)I&1<<R&&l.set(f),f++}}return l}}class ta{constructor(a,i){i?this.decodedInformation=null:(this.finished=a,this.decodedInformation=i)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class bn{constructor(a){this.newPosition=a}getNewPosition(){return this.newPosition}}class qr extends bn{constructor(a,i){super(a),this.value=i}getValue(){return this.value}isFNC1(){return this.value===qr.FNC1}}qr.FNC1="$";class Oa extends bn{constructor(a,i,o){super(a),o?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=i}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class F extends bn{constructor(a,i,o){if(super(a),i<0||i>10||o<0||o>10)throw new M;this.firstDigit=i,this.secondDigit=o}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===F.FNC1}isSecondDigitFNC1(){return this.secondDigit===F.FNC1}isAnyFNC1(){return this.firstDigit===F.FNC1||this.secondDigit===F.FNC1}}F.FNC1=10;class P{constructor(){}static parseFieldsInGeneralPurpose(a){if(!a)return null;if(a.length<2)throw new ae;let i=a.substring(0,2);for(let f of P.TWO_DIGIT_DATA_LENGTH)if(f[0]===i)return f[1]===P.VARIABLE_LENGTH?P.processVariableAI(2,f[2],a):P.processFixedAI(2,f[1],a);if(a.length<3)throw new ae;let o=a.substring(0,3);for(let f of P.THREE_DIGIT_DATA_LENGTH)if(f[0]===o)return f[1]===P.VARIABLE_LENGTH?P.processVariableAI(3,f[2],a):P.processFixedAI(3,f[1],a);for(let f of P.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(f[0]===o)return f[1]===P.VARIABLE_LENGTH?P.processVariableAI(4,f[2],a):P.processFixedAI(4,f[1],a);if(a.length<4)throw new ae;let l=a.substring(0,4);for(let f of P.FOUR_DIGIT_DATA_LENGTH)if(f[0]===l)return f[1]===P.VARIABLE_LENGTH?P.processVariableAI(4,f[2],a):P.processFixedAI(4,f[1],a);throw new ae}static processFixedAI(a,i,o){if(o.length<a)throw new ae;let l=o.substring(0,a);if(o.length<a+i)throw new ae;let f=o.substring(a,a+i),u=o.substring(a+i),x="("+l+")"+f,p=P.parseFieldsInGeneralPurpose(u);return p==null?x:x+p}static processVariableAI(a,i,o){let l=o.substring(0,a),f;o.length<a+i?f=o.length:f=a+i;let u=o.substring(a,f),x=o.substring(f),p="("+l+")"+u,y=P.parseFieldsInGeneralPurpose(x);return y==null?p:p+y}}P.VARIABLE_LENGTH=[],P.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",P.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",P.VARIABLE_LENGTH,20],["22",P.VARIABLE_LENGTH,29],["30",P.VARIABLE_LENGTH,8],["37",P.VARIABLE_LENGTH,8],["90",P.VARIABLE_LENGTH,30],["91",P.VARIABLE_LENGTH,30],["92",P.VARIABLE_LENGTH,30],["93",P.VARIABLE_LENGTH,30],["94",P.VARIABLE_LENGTH,30],["95",P.VARIABLE_LENGTH,30],["96",P.VARIABLE_LENGTH,30],["97",P.VARIABLE_LENGTH,3],["98",P.VARIABLE_LENGTH,30],["99",P.VARIABLE_LENGTH,30]],P.THREE_DIGIT_DATA_LENGTH=[["240",P.VARIABLE_LENGTH,30],["241",P.VARIABLE_LENGTH,30],["242",P.VARIABLE_LENGTH,6],["250",P.VARIABLE_LENGTH,30],["251",P.VARIABLE_LENGTH,30],["253",P.VARIABLE_LENGTH,17],["254",P.VARIABLE_LENGTH,20],["400",P.VARIABLE_LENGTH,30],["401",P.VARIABLE_LENGTH,30],["402",17],["403",P.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",P.VARIABLE_LENGTH,20],["421",P.VARIABLE_LENGTH,15],["422",3],["423",P.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],P.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",P.VARIABLE_LENGTH,15],["391",P.VARIABLE_LENGTH,18],["392",P.VARIABLE_LENGTH,15],["393",P.VARIABLE_LENGTH,18],["703",P.VARIABLE_LENGTH,30]],P.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",P.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",P.VARIABLE_LENGTH,20],["8003",P.VARIABLE_LENGTH,30],["8004",P.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",P.VARIABLE_LENGTH,30],["8008",P.VARIABLE_LENGTH,12],["8018",18],["8020",P.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",P.VARIABLE_LENGTH,70],["8200",P.VARIABLE_LENGTH,70]];class L{constructor(a){this.buffer=new be,this.information=a}decodeAllCodes(a,i){let o=i,l=null;do{let f=this.decodeGeneralPurposeField(o,l),u=P.parseFieldsInGeneralPurpose(f.getNewString());if(u!=null&&a.append(u),f.isRemaining()?l=""+f.getRemainingValue():l=null,o===f.getNewPosition())break;o=f.getNewPosition()}while(!0);return a.toString()}isStillNumeric(a){if(a+7>this.information.getSize())return a+4<=this.information.getSize();for(let i=a;i<a+3;++i)if(this.information.get(i))return!0;return this.information.get(a+3)}decodeNumeric(a){if(a+7>this.information.getSize()){let f=this.extractNumericValueFromBitArray(a,4);return f===0?new F(this.information.getSize(),F.FNC1,F.FNC1):new F(this.information.getSize(),f-1,F.FNC1)}let i=this.extractNumericValueFromBitArray(a,7),o=(i-8)/11,l=(i-8)%11;return new F(a+7,o,l)}extractNumericValueFromBitArray(a,i){return L.extractNumericValueFromBitArray(this.information,a,i)}static extractNumericValueFromBitArray(a,i,o){let l=0;for(let f=0;f<o;++f)a.get(i+f)&&(l|=1<<o-f-1);return l}decodeGeneralPurposeField(a,i){this.buffer.setLengthToZero(),i!=null&&this.buffer.append(i),this.current.setPosition(a);let o=this.parseBlocks();return o!=null&&o.isRemaining()?new Oa(this.current.getPosition(),this.buffer.toString(),o.getRemainingValue()):new Oa(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let a,i;do{let o=this.current.getPosition();if(this.current.isAlpha()?(i=this.parseAlphaBlock(),a=i.isFinished()):this.current.isIsoIec646()?(i=this.parseIsoIec646Block(),a=i.isFinished()):(i=this.parseNumericBlock(),a=i.isFinished()),!(o!==this.current.getPosition())&&!a)break}while(!a);return i.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let a=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFirstDigitFNC1()){let i;return a.isSecondDigitFNC1()?i=new Oa(this.current.getPosition(),this.buffer.toString()):i=new Oa(this.current.getPosition(),this.buffer.toString(),a.getSecondDigit()),new ta(!0,i)}if(this.buffer.append(a.getFirstDigit()),a.isSecondDigitFNC1()){let i=new Oa(this.current.getPosition(),this.buffer.toString());return new ta(!0,i)}this.buffer.append(a.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new ta(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let a=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFNC1()){let i=new Oa(this.current.getPosition(),this.buffer.toString());return new ta(!0,i)}this.buffer.append(a.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new ta(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let a=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFNC1()){let i=new Oa(this.current.getPosition(),this.buffer.toString());return new ta(!0,i)}this.buffer.append(a.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new ta(!1)}isStillIsoIec646(a){if(a+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(a,5);if(i>=5&&i<16)return!0;if(a+7>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(a,7);if(o>=64&&o<116)return!0;if(a+8>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(a,8);return l>=232&&l<253}decodeIsoIec646(a){let i=this.extractNumericValueFromBitArray(a,5);if(i===15)return new qr(a+5,qr.FNC1);if(i>=5&&i<15)return new qr(a+5,"0"+(i-5));let o=this.extractNumericValueFromBitArray(a,7);if(o>=64&&o<90)return new qr(a+7,""+(o+1));if(o>=90&&o<116)return new qr(a+7,""+(o+7));let l=this.extractNumericValueFromBitArray(a,8),f;switch(l){case 232:f="!";break;case 233:f='"';break;case 234:f="%";break;case 235:f="&";break;case 236:f="'";break;case 237:f="(";break;case 238:f=")";break;case 239:f="*";break;case 240:f="+";break;case 241:f=",";break;case 242:f="-";break;case 243:f=".";break;case 244:f="/";break;case 245:f=":";break;case 246:f=";";break;case 247:f="<";break;case 248:f="=";break;case 249:f=">";break;case 250:f="?";break;case 251:f="_";break;case 252:f=" ";break;default:throw new M}return new qr(a+8,f)}isStillAlpha(a){if(a+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(a,5);if(i>=5&&i<16)return!0;if(a+6>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(a,6);return o>=16&&o<63}decodeAlphanumeric(a){let i=this.extractNumericValueFromBitArray(a,5);if(i===15)return new qr(a+5,qr.FNC1);if(i>=5&&i<15)return new qr(a+5,"0"+(i-5));let o=this.extractNumericValueFromBitArray(a,6);if(o>=32&&o<58)return new qr(a+6,""+(o+33));let l;switch(o){case 58:l="*";break;case 59:l=",";break;case 60:l="-";break;case 61:l=".";break;case 62:l="/";break;default:throw new lt("Decoding invalid alphanumeric value: "+o)}return new qr(a+6,l)}isAlphaTo646ToAlphaLatch(a){if(a+1>this.information.getSize())return!1;for(let i=0;i<5&&i+a<this.information.getSize();++i)if(i===2){if(!this.information.get(a+2))return!1}else if(this.information.get(a+i))return!1;return!0}isAlphaOr646ToNumericLatch(a){if(a+3>this.information.getSize())return!1;for(let i=a;i<a+3;++i)if(this.information.get(i))return!1;return!0}isNumericToAlphaNumericLatch(a){if(a+1>this.information.getSize())return!1;for(let i=0;i<4&&i+a<this.information.getSize();++i)if(this.information.get(a+i))return!1;return!0}}class W{constructor(a){this.information=a,this.generalDecoder=new L(a)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class H extends W{constructor(a){super(a)}encodeCompressedGtin(a,i){a.append("(01)");let o=a.length();a.append("9"),this.encodeCompressedGtinWithoutAI(a,i,o)}encodeCompressedGtinWithoutAI(a,i,o){for(let l=0;l<4;++l){let f=this.getGeneralDecoder().extractNumericValueFromBitArray(i+10*l,10);f/100===0&&a.append("0"),f/10===0&&a.append("0"),a.append(f)}H.appendCheckDigit(a,o)}static appendCheckDigit(a,i){let o=0;for(let l=0;l<13;l++){let f=a.charAt(l+i).charCodeAt(0)-48;o+=l&1?f:3*f}o=10-o%10,o===10&&(o=0),a.append(o)}}H.GTIN_SIZE=40;class z extends H{constructor(a){super(a)}parseInformation(){let a=new be;a.append("(01)");let i=a.length(),o=this.getGeneralDecoder().extractNumericValueFromBitArray(z.HEADER_SIZE,4);return a.append(o),this.encodeCompressedGtinWithoutAI(a,z.HEADER_SIZE+4,i),this.getGeneralDecoder().decodeAllCodes(a,z.HEADER_SIZE+44)}}z.HEADER_SIZE=4;class me extends W{constructor(a){super(a)}parseInformation(){let a=new be;return this.getGeneralDecoder().decodeAllCodes(a,me.HEADER_SIZE)}}me.HEADER_SIZE=5;class De extends H{constructor(a){super(a)}encodeCompressedWeight(a,i,o){let l=this.getGeneralDecoder().extractNumericValueFromBitArray(i,o);this.addWeightCode(a,l);let f=this.checkWeight(l),u=1e5;for(let x=0;x<5;++x)f/u===0&&a.append("0"),u/=10;a.append(f)}}class xe extends De{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()!=xe.HEADER_SIZE+De.GTIN_SIZE+xe.WEIGHT_SIZE)throw new ae;let a=new be;return this.encodeCompressedGtin(a,xe.HEADER_SIZE),this.encodeCompressedWeight(a,xe.HEADER_SIZE+De.GTIN_SIZE,xe.WEIGHT_SIZE),a.toString()}}xe.HEADER_SIZE=5,xe.WEIGHT_SIZE=15;class pe extends xe{constructor(a){super(a)}addWeightCode(a,i){a.append("(3103)")}checkWeight(a){return a}}class ve extends xe{constructor(a){super(a)}addWeightCode(a,i){i<1e4?a.append("(3202)"):a.append("(3203)")}checkWeight(a){return a<1e4?a:a-1e4}}class We extends H{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()<We.HEADER_SIZE+H.GTIN_SIZE)throw new ae;let a=new be;this.encodeCompressedGtin(a,We.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(We.HEADER_SIZE+H.GTIN_SIZE,We.LAST_DIGIT_SIZE);a.append("(392"),a.append(i),a.append(")");let o=this.getGeneralDecoder().decodeGeneralPurposeField(We.HEADER_SIZE+H.GTIN_SIZE+We.LAST_DIGIT_SIZE,null);return a.append(o.getNewString()),a.toString()}}We.HEADER_SIZE=8,We.LAST_DIGIT_SIZE=2;class He extends H{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()<He.HEADER_SIZE+H.GTIN_SIZE)throw new ae;let a=new be;this.encodeCompressedGtin(a,He.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(He.HEADER_SIZE+H.GTIN_SIZE,He.LAST_DIGIT_SIZE);a.append("(393"),a.append(i),a.append(")");let o=this.getGeneralDecoder().extractNumericValueFromBitArray(He.HEADER_SIZE+H.GTIN_SIZE+He.LAST_DIGIT_SIZE,He.FIRST_THREE_DIGITS_SIZE);o/100==0&&a.append("0"),o/10==0&&a.append("0"),a.append(o);let l=this.getGeneralDecoder().decodeGeneralPurposeField(He.HEADER_SIZE+H.GTIN_SIZE+He.LAST_DIGIT_SIZE+He.FIRST_THREE_DIGITS_SIZE,null);return a.append(l.getNewString()),a.toString()}}He.HEADER_SIZE=8,He.LAST_DIGIT_SIZE=2,He.FIRST_THREE_DIGITS_SIZE=10;class Ye extends De{constructor(a,i,o){super(a),this.dateCode=o,this.firstAIdigits=i}parseInformation(){if(this.getInformation().getSize()!=Ye.HEADER_SIZE+Ye.GTIN_SIZE+Ye.WEIGHT_SIZE+Ye.DATE_SIZE)throw new ae;let a=new be;return this.encodeCompressedGtin(a,Ye.HEADER_SIZE),this.encodeCompressedWeight(a,Ye.HEADER_SIZE+Ye.GTIN_SIZE,Ye.WEIGHT_SIZE),this.encodeCompressedDate(a,Ye.HEADER_SIZE+Ye.GTIN_SIZE+Ye.WEIGHT_SIZE),a.toString()}encodeCompressedDate(a,i){let o=this.getGeneralDecoder().extractNumericValueFromBitArray(i,Ye.DATE_SIZE);if(o==38400)return;a.append("("),a.append(this.dateCode),a.append(")");let l=o%32;o/=32;let f=o%12+1;o/=12;let u=o;u/10==0&&a.append("0"),a.append(u),f/10==0&&a.append("0"),a.append(f),l/10==0&&a.append("0"),a.append(l)}addWeightCode(a,i){a.append("("),a.append(this.firstAIdigits),a.append(i/1e5),a.append(")")}checkWeight(a){return a%1e5}}Ye.HEADER_SIZE=8,Ye.WEIGHT_SIZE=20,Ye.DATE_SIZE=16;function Je(k){try{if(k.get(1))return new z(k);if(!k.get(2))return new me(k);switch(L.extractNumericValueFromBitArray(k,1,4)){case 4:return new pe(k);case 5:return new ve(k)}switch(L.extractNumericValueFromBitArray(k,1,5)){case 12:return new We(k);case 13:return new He(k)}switch(L.extractNumericValueFromBitArray(k,1,7)){case 56:return new Ye(k,"310","11");case 57:return new Ye(k,"320","11");case 58:return new Ye(k,"310","13");case 59:return new Ye(k,"320","13");case 60:return new Ye(k,"310","15");case 61:return new Ye(k,"320","15");case 62:return new Ye(k,"310","17");case 63:return new Ye(k,"320","17")}}catch(a){throw console.log(a),new lt("unknown decoder: "+k)}}class nt{constructor(a,i,o,l){this.leftchar=a,this.rightchar=i,this.finderpattern=o,this.maybeLast=l}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(a,i){return a instanceof nt?nt.equalsOrNull(a.leftchar,i.leftchar)&&nt.equalsOrNull(a.rightchar,i.rightchar)&&nt.equalsOrNull(a.finderpattern,i.finderpattern):!1}static equalsOrNull(a,i){return a===null?i===null:nt.equals(a,i)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class vt{constructor(a,i,o){this.pairs=a,this.rowNumber=i,this.wasReversed=o}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(a){return this.checkEqualitity(this,a)}toString(){return"{ "+this.pairs+" }"}equals(a,i){return a instanceof vt?this.checkEqualitity(a,i)&&a.wasReversed===i.wasReversed:!1}checkEqualitity(a,i){if(!a||!i)return;let o;return a.forEach((l,f)=>{i.forEach(u=>{l.getLeftChar().getValue()===u.getLeftChar().getValue()&&l.getRightChar().getValue()===u.getRightChar().getValue()&&l.getFinderPatter().getValue()===u.getFinderPatter().getValue()&&(o=!0)})}),o}}class Ce extends Er{constructor(a){super(...arguments),this.pairs=new Array(Ce.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=a===!0}decodeRow(a,i,o){this.pairs.length=0,this.startFromEven=!1;try{return Ce.constructResult(this.decodeRow2pairs(a,i))}catch(l){this.verbose&&console.log(l)}return this.pairs.length=0,this.startFromEven=!0,Ce.constructResult(this.decodeRow2pairs(a,i))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(a,i){let o=!1;for(;!o;)try{this.pairs.push(this.retrieveNextPair(i,this.pairs,a))}catch(f){if(f instanceof ae){if(!this.pairs.length)throw new ae;o=!0}}if(this.checkChecksum())return this.pairs;let l;if(this.rows.length?l=!0:l=!1,this.storeRow(a,!1),l){let f=this.checkRowsBoolean(!1);if(f!=null||(f=this.checkRowsBoolean(!0),f!=null))return f}throw new ae}checkRowsBoolean(a){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,a&&(this.rows=this.rows.reverse());let i=null;try{i=this.checkRows(new Array,0)}catch(o){this.verbose&&console.log(o)}return a&&(this.rows=this.rows.reverse()),i}checkRows(a,i){for(let o=i;o<this.rows.length;o++){let l=this.rows[o];this.pairs.length=0;for(let u of a)this.pairs.push(u.getPairs());if(this.pairs.push(l.getPairs()),!Ce.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let f=new Array(a);f.push(l);try{return this.checkRows(f,o+1)}catch(u){this.verbose&&console.log(u)}}throw new ae}static isValidSequence(a){for(let i of Ce.FINDER_PATTERN_SEQUENCES){if(a.length>i.length)continue;let o=!0;for(let l=0;l<a.length;l++)if(a[l].getFinderPattern().getValue()!=i[l]){o=!1;break}if(o)return!0}return!1}storeRow(a,i){let o=0,l=!1,f=!1;for(;o<this.rows.length;){let u=this.rows[o];if(u.getRowNumber()>a){f=u.isEquivalent(this.pairs);break}l=u.isEquivalent(this.pairs),o++}f||l||Ce.isPartialRow(this.pairs,this.rows)||(this.rows.push(o,new vt(this.pairs,a,i)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(a,i){for(let o of i)if(o.getPairs().length!==a.length){for(let l of o.getPairs())for(let f of a)if(nt.equals(l,f))break}}static isPartialRow(a,i){for(let o of i){let l=!0;for(let f of a){let u=!1;for(let x of o.getPairs())if(f.equals(x)){u=!0;break}if(!u){l=!1;break}}if(l)return!0}return!1}getRows(){return this.rows}static constructResult(a){let i=ya.buildBitArray(a),l=Je(i).parseInformation(),f=a[0].getFinderPattern().getResultPoints(),u=a[a.length-1].getFinderPattern().getResultPoints(),x=[f[0],f[1],u[0],u[1]];return new ee(l,null,null,x,le.RSS_EXPANDED,null)}checkChecksum(){let a=this.pairs.get(0),i=a.getLeftChar(),o=a.getRightChar();if(o==null)return!1;let l=o.getChecksumPortion(),f=2;for(let x=1;x<this.pairs.size();++x){let p=this.pairs.get(x);l+=p.getLeftChar().getChecksumPortion(),f++;let y=p.getRightChar();y!=null&&(l+=y.getChecksumPortion(),f++)}return l%=211,211*(f-4)+l==i.getValue()}static getNextSecondBar(a,i){let o;return a.get(i)?(o=a.getNextUnset(i),o=a.getNextSet(o)):(o=a.getNextSet(i),o=a.getNextUnset(o)),o}retrieveNextPair(a,i,o){let l=i.length%2==0;this.startFromEven&&(l=!l);let f,u=!0,x=-1;do this.findNextPair(a,i,x),f=this.parseFoundFinderPattern(a,o,l),f==null?x=Ce.getNextSecondBar(a,this.startEnd[0]):u=!1;while(u);let p=this.decodeDataCharacter(a,f,l,!0);if(!this.isEmptyPair(i)&&i[i.length-1].mustBeLast())throw new ae;let y;try{y=this.decodeDataCharacter(a,f,l,!1)}catch(b){y=null,this.verbose&&console.log(b)}return new nt(p,y,f,!0)}isEmptyPair(a){return a.length===0}findNextPair(a,i,o){let l=this.getDecodeFinderCounters();l[0]=0,l[1]=0,l[2]=0,l[3]=0;let f=a.getSize(),u;o>=0?u=o:this.isEmptyPair(i)?u=0:u=i[i.length-1].getFinderPattern().getStartEnd()[1];let x=i.length%2!=0;this.startFromEven&&(x=!x);let p=!1;for(;u<f&&(p=!a.get(u),!!p);)u++;let y=0,b=u;for(let I=u;I<f;I++)if(a.get(I)!=p)l[y]++;else{if(y==3){if(x&&Ce.reverseCounters(l),Ce.isFinderPattern(l)){this.startEnd[0]=b,this.startEnd[1]=I;return}x&&Ce.reverseCounters(l),b+=l[0]+l[1],l[0]=l[2],l[1]=l[3],l[2]=0,l[3]=0,y--}else y++;l[y]=1,p=!p}throw new ae}static reverseCounters(a){let i=a.length;for(let o=0;o<i/2;++o){let l=a[o];a[o]=a[i-o-1],a[i-o-1]=l}}parseFoundFinderPattern(a,i,o){let l,f,u;if(o){let y=this.startEnd[0]-1;for(;y>=0&&!a.get(y);)y--;y++,l=this.startEnd[0]-y,f=y,u=this.startEnd[1]}else f=this.startEnd[0],u=a.getNextUnset(this.startEnd[1]+1),l=u-this.startEnd[1];let x=this.getDecodeFinderCounters();S.arraycopy(x,0,x,1,x.length-1),x[0]=l;let p;try{p=this.parseFinderValue(x,Ce.FINDER_PATTERNS)}catch{return null}return new Pn(p,[f,u],f,u,i)}decodeDataCharacter(a,i,o,l){let f=this.getDataCharacterCounters();for(let sr=0;sr<f.length;sr++)f[sr]=0;if(l)Ce.recordPatternInReverse(a,i.getStartEnd()[0],f);else{Ce.recordPattern(a,i.getStartEnd()[1],f);for(let sr=0,Hr=f.length-1;sr<Hr;sr++,Hr--){let Aa=f[sr];f[sr]=f[Hr],f[Hr]=Aa}}let u=17,x=Et.sum(new Int32Array(f))/u,p=(i.getStartEnd()[1]-i.getStartEnd()[0])/15;if(Math.abs(x-p)/p>.3)throw new ae;let y=this.getOddCounts(),b=this.getEvenCounts(),I=this.getOddRoundingErrors(),R=this.getEvenRoundingErrors();for(let sr=0;sr<f.length;sr++){let Hr=1*f[sr]/x,Aa=Hr+.5;if(Aa<1){if(Hr<.3)throw new ae;Aa=1}else if(Aa>8){if(Hr>8.7)throw new ae;Aa=8}let en=sr/2;sr&1?(b[en]=Aa,R[en]=Hr-Aa):(y[en]=Aa,I[en]=Hr-Aa)}this.adjustOddEvenCounts(u);let G=4*i.getValue()+(o?0:2)+(l?0:1)-1,Q=0,re=0;for(let sr=y.length-1;sr>=0;sr--){if(Ce.isNotA1left(i,o,l)){let Hr=Ce.WEIGHTS[G][2*sr];re+=y[sr]*Hr}Q+=y[sr]}let ue=0;for(let sr=b.length-1;sr>=0;sr--)if(Ce.isNotA1left(i,o,l)){let Hr=Ce.WEIGHTS[G][2*sr+1];ue+=b[sr]*Hr}let Ae=re+ue;if(Q&1||Q>13||Q<4)throw new ae;let Ke=(13-Q)/2,Ze=Ce.SYMBOL_WIDEST[Ke],Xe=9-Ze,Ht=Wa.getRSSvalue(y,Ze,!0),kt=Wa.getRSSvalue(b,Xe,!1),_a=Ce.EVEN_TOTAL_SUBSET[Ke],$a=Ce.GSUM[Ke],la=Ht*_a+kt+$a;return new Ka(la,Ae)}static isNotA1left(a,i,o){return!(a.getValue()==0&&i&&o)}adjustOddEvenCounts(a){let i=Et.sum(new Int32Array(this.getOddCounts())),o=Et.sum(new Int32Array(this.getEvenCounts())),l=!1,f=!1;i>13?f=!0:i<4&&(l=!0);let u=!1,x=!1;o>13?x=!0:o<4&&(u=!0);let p=i+o-a,y=(i&1)==1,b=(o&1)==0;if(p==1)if(y){if(b)throw new ae;f=!0}else{if(!b)throw new ae;x=!0}else if(p==-1)if(y){if(b)throw new ae;l=!0}else{if(!b)throw new ae;u=!0}else if(p==0){if(y){if(!b)throw new ae;i<o?(l=!0,x=!0):(f=!0,u=!0)}else if(b)throw new ae}else throw new ae;if(l){if(f)throw new ae;Ce.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(f&&Ce.decrement(this.getOddCounts(),this.getOddRoundingErrors()),u){if(x)throw new ae;Ce.increment(this.getEvenCounts(),this.getOddRoundingErrors())}x&&Ce.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ce.SYMBOL_WIDEST=[7,5,4,3,1],Ce.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Ce.GSUM=[0,348,1388,2948,3988],Ce.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Ce.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Ce.FINDER_PAT_A=0,Ce.FINDER_PAT_B=1,Ce.FINDER_PAT_C=2,Ce.FINDER_PAT_D=3,Ce.FINDER_PAT_E=4,Ce.FINDER_PAT_F=5,Ce.FINDER_PATTERN_SEQUENCES=[[Ce.FINDER_PAT_A,Ce.FINDER_PAT_A],[Ce.FINDER_PAT_A,Ce.FINDER_PAT_B,Ce.FINDER_PAT_B],[Ce.FINDER_PAT_A,Ce.FINDER_PAT_C,Ce.FINDER_PAT_B,Ce.FINDER_PAT_D],[Ce.FINDER_PAT_A,Ce.FINDER_PAT_E,Ce.FINDER_PAT_B,Ce.FINDER_PAT_D,Ce.FINDER_PAT_C],[Ce.FINDER_PAT_A,Ce.FINDER_PAT_E,Ce.FINDER_PAT_B,Ce.FINDER_PAT_D,Ce.FINDER_PAT_D,Ce.FINDER_PAT_F],[Ce.FINDER_PAT_A,Ce.FINDER_PAT_E,Ce.FINDER_PAT_B,Ce.FINDER_PAT_D,Ce.FINDER_PAT_E,Ce.FINDER_PAT_F,Ce.FINDER_PAT_F],[Ce.FINDER_PAT_A,Ce.FINDER_PAT_A,Ce.FINDER_PAT_B,Ce.FINDER_PAT_B,Ce.FINDER_PAT_C,Ce.FINDER_PAT_C,Ce.FINDER_PAT_D,Ce.FINDER_PAT_D],[Ce.FINDER_PAT_A,Ce.FINDER_PAT_A,Ce.FINDER_PAT_B,Ce.FINDER_PAT_B,Ce.FINDER_PAT_C,Ce.FINDER_PAT_C,Ce.FINDER_PAT_D,Ce.FINDER_PAT_E,Ce.FINDER_PAT_E],[Ce.FINDER_PAT_A,Ce.FINDER_PAT_A,Ce.FINDER_PAT_B,Ce.FINDER_PAT_B,Ce.FINDER_PAT_C,Ce.FINDER_PAT_C,Ce.FINDER_PAT_D,Ce.FINDER_PAT_E,Ce.FINDER_PAT_F,Ce.FINDER_PAT_F],[Ce.FINDER_PAT_A,Ce.FINDER_PAT_A,Ce.FINDER_PAT_B,Ce.FINDER_PAT_B,Ce.FINDER_PAT_C,Ce.FINDER_PAT_D,Ce.FINDER_PAT_D,Ce.FINDER_PAT_E,Ce.FINDER_PAT_E,Ce.FINDER_PAT_F,Ce.FINDER_PAT_F]],Ce.MAX_PAIRS=11;class lr extends Ka{constructor(a,i,o){super(a,i),this.count=0,this.finderPattern=o}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Ft extends Er{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(a,i,o){const l=this.decodePair(i,!1,a,o);Ft.addOrTally(this.possibleLeftPairs,l),i.reverse();let f=this.decodePair(i,!0,a,o);Ft.addOrTally(this.possibleRightPairs,f),i.reverse();for(let u of this.possibleLeftPairs)if(u.getCount()>1){for(let x of this.possibleRightPairs)if(x.getCount()>1&&Ft.checkChecksum(u,x))return Ft.constructResult(u,x)}throw new ae}static addOrTally(a,i){if(i==null)return;let o=!1;for(let l of a)if(l.getValue()===i.getValue()){l.incrementCount(),o=!0;break}o||a.push(i)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(a,i){let o=4537077*a.getValue()+i.getValue(),l=new String(o).toString(),f=new be;for(let y=13-l.length;y>0;y--)f.append("0");f.append(l);let u=0;for(let y=0;y<13;y++){let b=f.charAt(y).charCodeAt(0)-48;u+=y&1?b:3*b}u=10-u%10,u===10&&(u=0),f.append(u.toString());let x=a.getFinderPattern().getResultPoints(),p=i.getFinderPattern().getResultPoints();return new ee(f.toString(),null,0,[x[0],x[1],p[0],p[1]],le.RSS_14,new Date().getTime())}static checkChecksum(a,i){let o=(a.getChecksumPortion()+16*i.getChecksumPortion())%79,l=9*a.getFinderPattern().getValue()+i.getFinderPattern().getValue();return l>72&&l--,l>8&&l--,o===l}decodePair(a,i,o,l){try{let f=this.findFinderPattern(a,i),u=this.parseFoundFinderPattern(a,o,i,f),x=l==null?null:l.get(J.NEED_RESULT_POINT_CALLBACK);if(x!=null){let b=(f[0]+f[1])/2;i&&(b=a.getSize()-1-b),x.foundPossibleResultPoint(new st(b,o))}let p=this.decodeDataCharacter(a,u,!0),y=this.decodeDataCharacter(a,u,!1);return new lr(1597*p.getValue()+y.getValue(),p.getChecksumPortion()+4*y.getChecksumPortion(),u)}catch{return null}}decodeDataCharacter(a,i,o){let l=this.getDataCharacterCounters();for(let ue=0;ue<l.length;ue++)l[ue]=0;if(o)Mt.recordPatternInReverse(a,i.getStartEnd()[0],l);else{Mt.recordPattern(a,i.getStartEnd()[1]+1,l);for(let ue=0,Ae=l.length-1;ue<Ae;ue++,Ae--){let Ke=l[ue];l[ue]=l[Ae],l[Ae]=Ke}}let f=o?16:15,u=Et.sum(new Int32Array(l))/f,x=this.getOddCounts(),p=this.getEvenCounts(),y=this.getOddRoundingErrors(),b=this.getEvenRoundingErrors();for(let ue=0;ue<l.length;ue++){let Ae=l[ue]/u,Ke=Math.floor(Ae+.5);Ke<1?Ke=1:Ke>8&&(Ke=8);let Ze=Math.floor(ue/2);ue&1?(p[Ze]=Ke,b[Ze]=Ae-Ke):(x[Ze]=Ke,y[Ze]=Ae-Ke)}this.adjustOddEvenCounts(o,f);let I=0,R=0;for(let ue=x.length-1;ue>=0;ue--)R*=9,R+=x[ue],I+=x[ue];let G=0,Q=0;for(let ue=p.length-1;ue>=0;ue--)G*=9,G+=p[ue],Q+=p[ue];let re=R+3*G;if(o){if(I&1||I>12||I<4)throw new ae;let ue=(12-I)/2,Ae=Ft.OUTSIDE_ODD_WIDEST[ue],Ke=9-Ae,Ze=Wa.getRSSvalue(x,Ae,!1),Xe=Wa.getRSSvalue(p,Ke,!0),Ht=Ft.OUTSIDE_EVEN_TOTAL_SUBSET[ue],kt=Ft.OUTSIDE_GSUM[ue];return new Ka(Ze*Ht+Xe+kt,re)}else{if(Q&1||Q>10||Q<4)throw new ae;let ue=(10-Q)/2,Ae=Ft.INSIDE_ODD_WIDEST[ue],Ke=9-Ae,Ze=Wa.getRSSvalue(x,Ae,!0),Xe=Wa.getRSSvalue(p,Ke,!1),Ht=Ft.INSIDE_ODD_TOTAL_SUBSET[ue],kt=Ft.INSIDE_GSUM[ue];return new Ka(Xe*Ht+Ze+kt,re)}}findFinderPattern(a,i){let o=this.getDecodeFinderCounters();o[0]=0,o[1]=0,o[2]=0,o[3]=0;let l=a.getSize(),f=!1,u=0;for(;u<l&&(f=!a.get(u),i!==f);)u++;let x=0,p=u;for(let y=u;y<l;y++)if(a.get(y)!==f)o[x]++;else{if(x===3){if(Er.isFinderPattern(o))return[p,y];p+=o[0]+o[1],o[0]=o[2],o[1]=o[3],o[2]=0,o[3]=0,x--}else x++;o[x]=1,f=!f}throw new ae}parseFoundFinderPattern(a,i,o,l){let f=a.get(l[0]),u=l[0]-1;for(;u>=0&&f!==a.get(u);)u--;u++;const x=l[0]-u,p=this.getDecodeFinderCounters(),y=new Int32Array(p.length);S.arraycopy(p,0,y,1,p.length-1),y[0]=x;const b=this.parseFinderValue(y,Ft.FINDER_PATTERNS);let I=u,R=l[1];return o&&(I=a.getSize()-1-I,R=a.getSize()-1-R),new Pn(b,[u,l[1]],I,R,i)}adjustOddEvenCounts(a,i){let o=Et.sum(new Int32Array(this.getOddCounts())),l=Et.sum(new Int32Array(this.getEvenCounts())),f=!1,u=!1,x=!1,p=!1;a?(o>12?u=!0:o<4&&(f=!0),l>12?p=!0:l<4&&(x=!0)):(o>11?u=!0:o<5&&(f=!0),l>10?p=!0:l<4&&(x=!0));let y=o+l-i,b=(o&1)===(a?1:0),I=(l&1)===1;if(y===1)if(b){if(I)throw new ae;u=!0}else{if(!I)throw new ae;p=!0}else if(y===-1)if(b){if(I)throw new ae;f=!0}else{if(!I)throw new ae;x=!0}else if(y===0){if(b){if(!I)throw new ae;o<l?(f=!0,p=!0):(u=!0,x=!0)}else if(I)throw new ae}else throw new ae;if(f){if(u)throw new ae;Er.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(u&&Er.decrement(this.getOddCounts(),this.getOddRoundingErrors()),x){if(p)throw new ae;Er.increment(this.getEvenCounts(),this.getOddRoundingErrors())}p&&Er.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ft.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Ft.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Ft.OUTSIDE_GSUM=[0,161,961,2015,2715],Ft.INSIDE_GSUM=[0,336,1036,1516],Ft.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Ft.INSIDE_ODD_WIDEST=[2,4,6,8],Ft.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class ga extends Mt{constructor(a,i){super(),this.readers=[],this.verbose=i===!0;const o=a?a.get(J.POSSIBLE_FORMATS):null,l=a&&a.get(J.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;o?((o.includes(le.EAN_13)||o.includes(le.UPC_A)||o.includes(le.EAN_8)||o.includes(le.UPC_E))&&this.readers.push(new yi(a)),o.includes(le.CODE_39)&&this.readers.push(new br(l)),o.includes(le.CODE_128)&&this.readers.push(new Qe),o.includes(le.ITF)&&this.readers.push(new ar),o.includes(le.RSS_14)&&this.readers.push(new Ft),o.includes(le.RSS_EXPANDED)&&this.readers.push(new Ce(this.verbose))):(this.readers.push(new yi(a)),this.readers.push(new br),this.readers.push(new yi(a)),this.readers.push(new Qe),this.readers.push(new ar),this.readers.push(new Ft),this.readers.push(new Ce(this.verbose)))}decodeRow(a,i,o){for(let l=0;l<this.readers.length;l++)try{return this.readers[l].decodeRow(a,i,o)}catch{}throw new ae}reset(){this.readers.forEach(a=>a.reset())}}class Bn extends ce{constructor(a=500,i){super(new ga(i),a,i)}}class Ot{constructor(a,i,o){this.ecCodewords=a,this.ecBlocks=[i],o&&this.ecBlocks.push(o)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class It{constructor(a,i){this.count=a,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Nt{constructor(a,i,o,l,f,u){this.versionNumber=a,this.symbolSizeRows=i,this.symbolSizeColumns=o,this.dataRegionSizeRows=l,this.dataRegionSizeColumns=f,this.ecBlocks=u;let x=0;const p=u.getECCodewords(),y=u.getECBlocks();for(let b of y)x+=b.getCount()*(b.getDataCodewords()+p);this.totalCodewords=x}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(a,i){if(a&1||i&1)throw new M;for(let o of Nt.VERSIONS)if(o.symbolSizeRows===a&&o.symbolSizeColumns===i)return o;throw new M}toString(){return""+this.versionNumber}static buildVersions(){return[new Nt(1,10,10,8,8,new Ot(5,new It(1,3))),new Nt(2,12,12,10,10,new Ot(7,new It(1,5))),new Nt(3,14,14,12,12,new Ot(10,new It(1,8))),new Nt(4,16,16,14,14,new Ot(12,new It(1,12))),new Nt(5,18,18,16,16,new Ot(14,new It(1,18))),new Nt(6,20,20,18,18,new Ot(18,new It(1,22))),new Nt(7,22,22,20,20,new Ot(20,new It(1,30))),new Nt(8,24,24,22,22,new Ot(24,new It(1,36))),new Nt(9,26,26,24,24,new Ot(28,new It(1,44))),new Nt(10,32,32,14,14,new Ot(36,new It(1,62))),new Nt(11,36,36,16,16,new Ot(42,new It(1,86))),new Nt(12,40,40,18,18,new Ot(48,new It(1,114))),new Nt(13,44,44,20,20,new Ot(56,new It(1,144))),new Nt(14,48,48,22,22,new Ot(68,new It(1,174))),new Nt(15,52,52,24,24,new Ot(42,new It(2,102))),new Nt(16,64,64,14,14,new Ot(56,new It(2,140))),new Nt(17,72,72,16,16,new Ot(36,new It(4,92))),new Nt(18,80,80,18,18,new Ot(48,new It(4,114))),new Nt(19,88,88,20,20,new Ot(56,new It(4,144))),new Nt(20,96,96,22,22,new Ot(68,new It(4,174))),new Nt(21,104,104,24,24,new Ot(56,new It(6,136))),new Nt(22,120,120,18,18,new Ot(68,new It(6,175))),new Nt(23,132,132,20,20,new Ot(62,new It(8,163))),new Nt(24,144,144,22,22,new Ot(62,new It(8,156),new It(2,155))),new Nt(25,8,18,6,16,new Ot(7,new It(1,5))),new Nt(26,8,32,6,14,new Ot(11,new It(1,10))),new Nt(27,12,26,10,24,new Ot(14,new It(1,16))),new Nt(28,12,36,10,16,new Ot(18,new It(1,22))),new Nt(29,16,36,14,16,new Ot(24,new It(1,32))),new Nt(30,16,48,14,22,new Ot(28,new It(1,49)))]}}Nt.VERSIONS=Nt.buildVersions();class ra{constructor(a){const i=a.getHeight();if(i<8||i>144||i&1)throw new M;this.version=ra.readVersion(a),this.mappingBitMatrix=this.extractDataRegion(a),this.readMappingMatrix=new $e(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(a){const i=a.getHeight(),o=a.getWidth();return Nt.getVersionForDimensions(i,o)}readCodewords(){const a=new Int8Array(this.version.getTotalCodewords());let i=0,o=4,l=0;const f=this.mappingBitMatrix.getHeight(),u=this.mappingBitMatrix.getWidth();let x=!1,p=!1,y=!1,b=!1;do if(o===f&&l===0&&!x)a[i++]=this.readCorner1(f,u)&255,o-=2,l+=2,x=!0;else if(o===f-2&&l===0&&u&3&&!p)a[i++]=this.readCorner2(f,u)&255,o-=2,l+=2,p=!0;else if(o===f+4&&l===2&&!(u&7)&&!y)a[i++]=this.readCorner3(f,u)&255,o-=2,l+=2,y=!0;else if(o===f-2&&l===0&&(u&7)===4&&!b)a[i++]=this.readCorner4(f,u)&255,o-=2,l+=2,b=!0;else{do o<f&&l>=0&&!this.readMappingMatrix.get(l,o)&&(a[i++]=this.readUtah(o,l,f,u)&255),o-=2,l+=2;while(o>=0&&l<u);o+=1,l+=3;do o>=0&&l<u&&!this.readMappingMatrix.get(l,o)&&(a[i++]=this.readUtah(o,l,f,u)&255),o+=2,l-=2;while(o<f&&l>=0);o+=3,l+=1}while(o<f||l<u);if(i!==this.version.getTotalCodewords())throw new M;return a}readModule(a,i,o,l){return a<0&&(a+=o,i+=4-(o+4&7)),i<0&&(i+=l,a+=4-(l+4&7)),this.readMappingMatrix.set(i,a),this.mappingBitMatrix.get(i,a)}readUtah(a,i,o,l){let f=0;return this.readModule(a-2,i-2,o,l)&&(f|=1),f<<=1,this.readModule(a-2,i-1,o,l)&&(f|=1),f<<=1,this.readModule(a-1,i-2,o,l)&&(f|=1),f<<=1,this.readModule(a-1,i-1,o,l)&&(f|=1),f<<=1,this.readModule(a-1,i,o,l)&&(f|=1),f<<=1,this.readModule(a,i-2,o,l)&&(f|=1),f<<=1,this.readModule(a,i-1,o,l)&&(f|=1),f<<=1,this.readModule(a,i,o,l)&&(f|=1),f}readCorner1(a,i){let o=0;return this.readModule(a-1,0,a,i)&&(o|=1),o<<=1,this.readModule(a-1,1,a,i)&&(o|=1),o<<=1,this.readModule(a-1,2,a,i)&&(o|=1),o<<=1,this.readModule(0,i-2,a,i)&&(o|=1),o<<=1,this.readModule(0,i-1,a,i)&&(o|=1),o<<=1,this.readModule(1,i-1,a,i)&&(o|=1),o<<=1,this.readModule(2,i-1,a,i)&&(o|=1),o<<=1,this.readModule(3,i-1,a,i)&&(o|=1),o}readCorner2(a,i){let o=0;return this.readModule(a-3,0,a,i)&&(o|=1),o<<=1,this.readModule(a-2,0,a,i)&&(o|=1),o<<=1,this.readModule(a-1,0,a,i)&&(o|=1),o<<=1,this.readModule(0,i-4,a,i)&&(o|=1),o<<=1,this.readModule(0,i-3,a,i)&&(o|=1),o<<=1,this.readModule(0,i-2,a,i)&&(o|=1),o<<=1,this.readModule(0,i-1,a,i)&&(o|=1),o<<=1,this.readModule(1,i-1,a,i)&&(o|=1),o}readCorner3(a,i){let o=0;return this.readModule(a-1,0,a,i)&&(o|=1),o<<=1,this.readModule(a-1,i-1,a,i)&&(o|=1),o<<=1,this.readModule(0,i-3,a,i)&&(o|=1),o<<=1,this.readModule(0,i-2,a,i)&&(o|=1),o<<=1,this.readModule(0,i-1,a,i)&&(o|=1),o<<=1,this.readModule(1,i-3,a,i)&&(o|=1),o<<=1,this.readModule(1,i-2,a,i)&&(o|=1),o<<=1,this.readModule(1,i-1,a,i)&&(o|=1),o}readCorner4(a,i){let o=0;return this.readModule(a-3,0,a,i)&&(o|=1),o<<=1,this.readModule(a-2,0,a,i)&&(o|=1),o<<=1,this.readModule(a-1,0,a,i)&&(o|=1),o<<=1,this.readModule(0,i-2,a,i)&&(o|=1),o<<=1,this.readModule(0,i-1,a,i)&&(o|=1),o<<=1,this.readModule(1,i-1,a,i)&&(o|=1),o<<=1,this.readModule(2,i-1,a,i)&&(o|=1),o<<=1,this.readModule(3,i-1,a,i)&&(o|=1),o}extractDataRegion(a){const i=this.version.getSymbolSizeRows(),o=this.version.getSymbolSizeColumns();if(a.getHeight()!==i)throw new _("Dimension of bitMatrix must match the version size");const l=this.version.getDataRegionSizeRows(),f=this.version.getDataRegionSizeColumns(),u=i/l|0,x=o/f|0,p=u*l,y=x*f,b=new $e(y,p);for(let I=0;I<u;++I){const R=I*l;for(let G=0;G<x;++G){const Q=G*f;for(let re=0;re<l;++re){const ue=I*(l+2)+1+re,Ae=R+re;for(let Ke=0;Ke<f;++Ke){const Ze=G*(f+2)+1+Ke;if(a.get(Ze,ue)){const Xe=Q+Ke;b.set(Xe,Ae)}}}}}return b}}class Qs{constructor(a,i){this.numDataCodewords=a,this.codewords=i}static getDataBlocks(a,i){const o=i.getECBlocks();let l=0;const f=o.getECBlocks();for(let re of f)l+=re.getCount();const u=new Array(l);let x=0;for(let re of f)for(let ue=0;ue<re.getCount();ue++){const Ae=re.getDataCodewords(),Ke=o.getECCodewords()+Ae;u[x++]=new Qs(Ae,new Uint8Array(Ke))}const y=u[0].codewords.length-o.getECCodewords(),b=y-1;let I=0;for(let re=0;re<b;re++)for(let ue=0;ue<x;ue++)u[ue].codewords[re]=a[I++];const R=i.getVersionNumber()===24,G=R?8:x;for(let re=0;re<G;re++)u[re].codewords[y-1]=a[I++];const Q=u[0].codewords.length;for(let re=y;re<Q;re++)for(let ue=0;ue<x;ue++){const Ae=R?(ue+8)%x:ue,Ke=R&&Ae>7?re-1:re;u[Ae].codewords[Ke]=a[I++]}if(I!==a.length)throw new _;return u}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Ln{constructor(a){this.bytes=a,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(a){if(a<1||a>32||a>this.available())throw new _(""+a);let i=0,o=this.bitOffset,l=this.byteOffset;const f=this.bytes;if(o>0){const u=8-o,x=a<u?a:u,p=u-x,y=255>>8-x<<p;i=(f[l]&y)>>p,a-=x,o+=x,o===8&&(o=0,l++)}if(a>0){for(;a>=8;)i=i<<8|f[l]&255,l++,a-=8;if(a>0){const u=8-a,x=255>>u<<u;i=i<<a|(f[l]&x)>>u,o+=a}}return this.bitOffset=o,this.byteOffset=l,i}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Rr;(function(k){k[k.PAD_ENCODE=0]="PAD_ENCODE",k[k.ASCII_ENCODE=1]="ASCII_ENCODE",k[k.C40_ENCODE=2]="C40_ENCODE",k[k.TEXT_ENCODE=3]="TEXT_ENCODE",k[k.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",k[k.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",k[k.BASE256_ENCODE=6]="BASE256_ENCODE"})(Rr||(Rr={}));class Va{static decode(a){const i=new Ln(a),o=new be,l=new be,f=new Array;let u=Rr.ASCII_ENCODE;do if(u===Rr.ASCII_ENCODE)u=this.decodeAsciiSegment(i,o,l);else{switch(u){case Rr.C40_ENCODE:this.decodeC40Segment(i,o);break;case Rr.TEXT_ENCODE:this.decodeTextSegment(i,o);break;case Rr.ANSIX12_ENCODE:this.decodeAnsiX12Segment(i,o);break;case Rr.EDIFACT_ENCODE:this.decodeEdifactSegment(i,o);break;case Rr.BASE256_ENCODE:this.decodeBase256Segment(i,o,f);break;default:throw new M}u=Rr.ASCII_ENCODE}while(u!==Rr.PAD_ENCODE&&i.available()>0);return l.length()>0&&o.append(l.toString()),new Pe(a,o.toString(),f.length===0?null:f,null)}static decodeAsciiSegment(a,i,o){let l=!1;do{let f=a.readBits(8);if(f===0)throw new M;if(f<=128)return l&&(f+=128),i.append(String.fromCharCode(f-1)),Rr.ASCII_ENCODE;if(f===129)return Rr.PAD_ENCODE;if(f<=229){const u=f-130;u<10&&i.append("0"),i.append(""+u)}else switch(f){case 230:return Rr.C40_ENCODE;case 231:return Rr.BASE256_ENCODE;case 232:i.append("");break;case 233:case 234:break;case 235:l=!0;break;case 236:i.append("[)>05"),o.insert(0,"");break;case 237:i.append("[)>06"),o.insert(0,"");break;case 238:return Rr.ANSIX12_ENCODE;case 239:return Rr.TEXT_ENCODE;case 240:return Rr.EDIFACT_ENCODE;case 241:break;default:if(f!==254||a.available()!==0)throw new M;break}}while(a.available()>0);return Rr.ASCII_ENCODE}static decodeC40Segment(a,i){let o=!1;const l=[];let f=0;do{if(a.available()===8)return;const u=a.readBits(8);if(u===254)return;this.parseTwoBytes(u,a.readBits(8),l);for(let x=0;x<3;x++){const p=l[x];switch(f){case 0:if(p<3)f=p+1;else if(p<this.C40_BASIC_SET_CHARS.length){const y=this.C40_BASIC_SET_CHARS[p];o?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),o=!1):i.append(y)}else throw new M;break;case 1:o?(i.append(String.fromCharCode(p+128)),o=!1):i.append(String.fromCharCode(p)),f=0;break;case 2:if(p<this.C40_SHIFT2_SET_CHARS.length){const y=this.C40_SHIFT2_SET_CHARS[p];o?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),o=!1):i.append(y)}else switch(p){case 27:i.append("");break;case 30:o=!0;break;default:throw new M}f=0;break;case 3:o?(i.append(String.fromCharCode(p+224)),o=!1):i.append(String.fromCharCode(p+96)),f=0;break;default:throw new M}}}while(a.available()>0)}static decodeTextSegment(a,i){let o=!1,l=[],f=0;do{if(a.available()===8)return;const u=a.readBits(8);if(u===254)return;this.parseTwoBytes(u,a.readBits(8),l);for(let x=0;x<3;x++){const p=l[x];switch(f){case 0:if(p<3)f=p+1;else if(p<this.TEXT_BASIC_SET_CHARS.length){const y=this.TEXT_BASIC_SET_CHARS[p];o?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),o=!1):i.append(y)}else throw new M;break;case 1:o?(i.append(String.fromCharCode(p+128)),o=!1):i.append(String.fromCharCode(p)),f=0;break;case 2:if(p<this.TEXT_SHIFT2_SET_CHARS.length){const y=this.TEXT_SHIFT2_SET_CHARS[p];o?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),o=!1):i.append(y)}else switch(p){case 27:i.append("");break;case 30:o=!0;break;default:throw new M}f=0;break;case 3:if(p<this.TEXT_SHIFT3_SET_CHARS.length){const y=this.TEXT_SHIFT3_SET_CHARS[p];o?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),o=!1):i.append(y),f=0}else throw new M;break;default:throw new M}}}while(a.available()>0)}static decodeAnsiX12Segment(a,i){const o=[];do{if(a.available()===8)return;const l=a.readBits(8);if(l===254)return;this.parseTwoBytes(l,a.readBits(8),o);for(let f=0;f<3;f++){const u=o[f];switch(u){case 0:i.append("\r");break;case 1:i.append("*");break;case 2:i.append(">");break;case 3:i.append(" ");break;default:if(u<14)i.append(String.fromCharCode(u+44));else if(u<40)i.append(String.fromCharCode(u+51));else throw new M;break}}}while(a.available()>0)}static parseTwoBytes(a,i,o){let l=(a<<8)+i-1,f=Math.floor(l/1600);o[0]=f,l-=f*1600,f=Math.floor(l/40),o[1]=f,o[2]=l-f*40}static decodeEdifactSegment(a,i){do{if(a.available()<=16)return;for(let o=0;o<4;o++){let l=a.readBits(6);if(l===31){const f=8-a.getBitOffset();f!==8&&a.readBits(f);return}l&32||(l|=64),i.append(String.fromCharCode(l))}}while(a.available()>0)}static decodeBase256Segment(a,i,o){let l=1+a.getByteOffset();const f=this.unrandomize255State(a.readBits(8),l++);let u;if(f===0?u=a.available()/8|0:f<250?u=f:u=250*(f-249)+this.unrandomize255State(a.readBits(8),l++),u<0)throw new M;const x=new Uint8Array(u);for(let p=0;p<u;p++){if(a.available()<8)throw new M;x[p]=this.unrandomize255State(a.readBits(8),l++)}o.push(x);try{i.append(he.decode(x,te.ISO88591))}catch(p){throw new lt("Platform does not support required encoding: "+p.message)}}static unrandomize255State(a,i){const o=149*i%255+1,l=a-o;return l>=0?l:l+256}}Va.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Va.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Va.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Va.TEXT_SHIFT2_SET_CHARS=Va.C40_SHIFT2_SET_CHARS,Va.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class ma{constructor(){this.rsDecoder=new ze(Y.DATA_MATRIX_FIELD_256)}decode(a){const i=new ra(a),o=i.getVersion(),l=i.readCodewords(),f=Qs.getDataBlocks(l,o);let u=0;for(let y of f)u+=y.getNumDataCodewords();const x=new Uint8Array(u),p=f.length;for(let y=0;y<p;y++){const b=f[y],I=b.getCodewords(),R=b.getNumDataCodewords();this.correctErrors(I,R);for(let G=0;G<R;G++)x[G*p+y]=I[G]}return Va.decode(x)}correctErrors(a,i){const o=new Int32Array(a);try{this.rsDecoder.decode(o,a.length-i)}catch{throw new T}for(let l=0;l<i;l++)a[l]=o[l]}}class Sr{constructor(a){this.image=a,this.rectangleDetector=new Dr(this.image)}detect(){const a=this.rectangleDetector.detect();let i=this.detectSolid1(a);if(i=this.detectSolid2(i),i[3]=this.correctTopRight(i),!i[3])throw new ae;i=this.shiftToModuleCenter(i);const o=i[0],l=i[1],f=i[2],u=i[3];let x=this.transitionsBetween(o,u)+1,p=this.transitionsBetween(f,u)+1;(x&1)===1&&(x+=1),(p&1)===1&&(p+=1),4*x<7*p&&4*p<7*x&&(x=p=Math.max(x,p));let y=Sr.sampleGrid(this.image,o,l,f,u,x,p);return new An(y,[o,l,f,u])}static shiftPoint(a,i,o){let l=(i.getX()-a.getX())/(o+1),f=(i.getY()-a.getY())/(o+1);return new st(a.getX()+l,a.getY()+f)}static moveAway(a,i,o){let l=a.getX(),f=a.getY();return l<i?l-=1:l+=1,f<o?f-=1:f+=1,new st(l,f)}detectSolid1(a){let i=a[0],o=a[1],l=a[3],f=a[2],u=this.transitionsBetween(i,o),x=this.transitionsBetween(o,l),p=this.transitionsBetween(l,f),y=this.transitionsBetween(f,i),b=u,I=[f,i,o,l];return b>x&&(b=x,I[0]=i,I[1]=o,I[2]=l,I[3]=f),b>p&&(b=p,I[0]=o,I[1]=l,I[2]=f,I[3]=i),b>y&&(I[0]=l,I[1]=f,I[2]=i,I[3]=o),I}detectSolid2(a){let i=a[0],o=a[1],l=a[2],f=a[3],u=this.transitionsBetween(i,f),x=Sr.shiftPoint(o,l,(u+1)*4),p=Sr.shiftPoint(l,o,(u+1)*4),y=this.transitionsBetween(x,i),b=this.transitionsBetween(p,f);return y<b?(a[0]=i,a[1]=o,a[2]=l,a[3]=f):(a[0]=o,a[1]=l,a[2]=f,a[3]=i),a}correctTopRight(a){let i=a[0],o=a[1],l=a[2],f=a[3],u=this.transitionsBetween(i,f),x=this.transitionsBetween(o,f),p=Sr.shiftPoint(i,o,(x+1)*4),y=Sr.shiftPoint(l,o,(u+1)*4);u=this.transitionsBetween(p,f),x=this.transitionsBetween(y,f);let b=new st(f.getX()+(l.getX()-o.getX())/(u+1),f.getY()+(l.getY()-o.getY())/(u+1)),I=new st(f.getX()+(i.getX()-o.getX())/(x+1),f.getY()+(i.getY()-o.getY())/(x+1));if(!this.isValid(b))return this.isValid(I)?I:null;if(!this.isValid(I))return b;let R=this.transitionsBetween(p,b)+this.transitionsBetween(y,b),G=this.transitionsBetween(p,I)+this.transitionsBetween(y,I);return R>G?b:I}shiftToModuleCenter(a){let i=a[0],o=a[1],l=a[2],f=a[3],u=this.transitionsBetween(i,f)+1,x=this.transitionsBetween(l,f)+1,p=Sr.shiftPoint(i,o,x*4),y=Sr.shiftPoint(l,o,u*4);u=this.transitionsBetween(p,f)+1,x=this.transitionsBetween(y,f)+1,(u&1)===1&&(u+=1),(x&1)===1&&(x+=1);let b=(i.getX()+o.getX()+l.getX()+f.getX())/4,I=(i.getY()+o.getY()+l.getY()+f.getY())/4;i=Sr.moveAway(i,b,I),o=Sr.moveAway(o,b,I),l=Sr.moveAway(l,b,I),f=Sr.moveAway(f,b,I);let R,G;return p=Sr.shiftPoint(i,o,x*4),p=Sr.shiftPoint(p,f,u*4),R=Sr.shiftPoint(o,i,x*4),R=Sr.shiftPoint(R,l,u*4),y=Sr.shiftPoint(l,f,x*4),y=Sr.shiftPoint(y,o,u*4),G=Sr.shiftPoint(f,l,x*4),G=Sr.shiftPoint(G,i,u*4),[p,R,y,G]}isValid(a){return a.getX()>=0&&a.getX()<this.image.getWidth()&&a.getY()>0&&a.getY()<this.image.getHeight()}static sampleGrid(a,i,o,l,f,u,x){return Ar.getInstance().sampleGrid(a,u,x,.5,.5,u-.5,.5,u-.5,x-.5,.5,x-.5,i.getX(),i.getY(),f.getX(),f.getY(),l.getX(),l.getY(),o.getX(),o.getY())}transitionsBetween(a,i){let o=Math.trunc(a.getX()),l=Math.trunc(a.getY()),f=Math.trunc(i.getX()),u=Math.trunc(i.getY()),x=Math.abs(u-l)>Math.abs(f-o);if(x){let re=o;o=l,l=re,re=f,f=u,u=re}let p=Math.abs(f-o),y=Math.abs(u-l),b=-p/2,I=l<u?1:-1,R=o<f?1:-1,G=0,Q=this.image.get(x?l:o,x?o:l);for(let re=o,ue=l;re!==f;re+=R){let Ae=this.image.get(x?ue:re,x?re:ue);if(Ae!==Q&&(G++,Q=Ae),b+=y,b>0){if(ue===u)break;ue+=I,b-=p}}return G}}class hn{constructor(){this.decoder=new ma}decode(a,i=null){let o,l;if(i!=null&&i.has(J.PURE_BARCODE)){const y=hn.extractPureBits(a.getBlackMatrix());o=this.decoder.decode(y),l=hn.NO_POINTS}else{const y=new Sr(a.getBlackMatrix()).detect();o=this.decoder.decode(y.getBits()),l=y.getPoints()}const f=o.getRawBytes(),u=new ee(o.getText(),f,8*f.length,l,le.DATA_MATRIX,S.currentTimeMillis()),x=o.getByteSegments();x!=null&&u.putMetadata(Le.BYTE_SEGMENTS,x);const p=o.getECLevel();return p!=null&&u.putMetadata(Le.ERROR_CORRECTION_LEVEL,p),u}reset(){}static extractPureBits(a){const i=a.getTopLeftOnBit(),o=a.getBottomRightOnBit();if(i==null||o==null)throw new ae;const l=this.moduleSize(i,a);let f=i[1];const u=o[1];let x=i[0];const y=(o[0]-x+1)/l,b=(u-f+1)/l;if(y<=0||b<=0)throw new ae;const I=l/2;f+=I,x+=I;const R=new $e(y,b);for(let G=0;G<b;G++){const Q=f+G*l;for(let re=0;re<y;re++)a.get(x+re*l,Q)&&R.set(re,G)}return R}static moduleSize(a,i){const o=i.getWidth();let l=a[0];const f=a[1];for(;l<o&&i.get(l,f);)l++;if(l===o)throw new ae;const u=l-a[0];if(u===0)throw new ae;return u}}hn.NO_POINTS=[];class K0 extends ce{constructor(a=500){super(new hn,a)}}var jn;(function(k){k[k.L=0]="L",k[k.M=1]="M",k[k.Q=2]="Q",k[k.H=3]="H"})(jn||(jn={}));class dr{constructor(a,i,o){this.value=a,this.stringValue=i,this.bits=o,dr.FOR_BITS.set(o,this),dr.FOR_VALUE.set(a,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(a){switch(a){case"L":return dr.L;case"M":return dr.M;case"Q":return dr.Q;case"H":return dr.H;default:throw new v(a+"not available")}}toString(){return this.stringValue}equals(a){if(!(a instanceof dr))return!1;const i=a;return this.value===i.value}static forBits(a){if(a<0||a>=dr.FOR_BITS.size)throw new _;return dr.FOR_BITS.get(a)}}dr.FOR_BITS=new Map,dr.FOR_VALUE=new Map,dr.L=new dr(jn.L,"L",1),dr.M=new dr(jn.M,"M",0),dr.Q=new dr(jn.Q,"Q",3),dr.H=new dr(jn.H,"H",2);class ca{constructor(a){this.errorCorrectionLevel=dr.forBits(a>>3&3),this.dataMask=a&7}static numBitsDiffering(a,i){return O.bitCount(a^i)}static decodeFormatInformation(a,i){const o=ca.doDecodeFormatInformation(a,i);return o!==null?o:ca.doDecodeFormatInformation(a^ca.FORMAT_INFO_MASK_QR,i^ca.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(a,i){let o=Number.MAX_SAFE_INTEGER,l=0;for(const f of ca.FORMAT_INFO_DECODE_LOOKUP){const u=f[0];if(u===a||u===i)return new ca(f[1]);let x=ca.numBitsDiffering(a,u);x<o&&(l=f[1],o=x),a!==i&&(x=ca.numBitsDiffering(i,u),x<o&&(l=f[1],o=x))}return o<=3?new ca(l):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(a){if(!(a instanceof ca))return!1;const i=a;return this.errorCorrectionLevel===i.errorCorrectionLevel&&this.dataMask===i.dataMask}}ca.FORMAT_INFO_MASK_QR=21522,ca.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class ge{constructor(a,...i){this.ecCodewordsPerBlock=a,this.ecBlocks=i}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let a=0;const i=this.ecBlocks;for(const o of i)a+=o.getCount();return a}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class V{constructor(a,i){this.count=a,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class dt{constructor(a,i,...o){this.versionNumber=a,this.alignmentPatternCenters=i,this.ecBlocks=o;let l=0;const f=o[0].getECCodewordsPerBlock(),u=o[0].getECBlocks();for(const x of u)l+=x.getCount()*(x.getDataCodewords()+f);this.totalCodewords=l}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(a){return this.ecBlocks[a.getValue()]}static getProvisionalVersionForDimension(a){if(a%4!==1)throw new M;try{return this.getVersionForNumber((a-17)/4)}catch{throw new M}}static getVersionForNumber(a){if(a<1||a>40)throw new _;return dt.VERSIONS[a-1]}static decodeVersionInformation(a){let i=Number.MAX_SAFE_INTEGER,o=0;for(let l=0;l<dt.VERSION_DECODE_INFO.length;l++){const f=dt.VERSION_DECODE_INFO[l];if(f===a)return dt.getVersionForNumber(l+7);const u=ca.numBitsDiffering(a,f);u<i&&(o=l+7,i=u)}return i<=3?dt.getVersionForNumber(o):null}buildFunctionPattern(){const a=this.getDimensionForVersion(),i=new $e(a);i.setRegion(0,0,9,9),i.setRegion(a-8,0,8,9),i.setRegion(0,a-8,9,8);const o=this.alignmentPatternCenters.length;for(let l=0;l<o;l++){const f=this.alignmentPatternCenters[l]-2;for(let u=0;u<o;u++)l===0&&(u===0||u===o-1)||l===o-1&&u===0||i.setRegion(this.alignmentPatternCenters[u]-2,f,5,5)}return i.setRegion(6,9,1,a-17),i.setRegion(9,6,a-17,1),this.versionNumber>6&&(i.setRegion(a-11,0,3,6),i.setRegion(0,a-11,6,3)),i}toString(){return""+this.versionNumber}}dt.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),dt.VERSIONS=[new dt(1,new Int32Array(0),new ge(7,new V(1,19)),new ge(10,new V(1,16)),new ge(13,new V(1,13)),new ge(17,new V(1,9))),new dt(2,Int32Array.from([6,18]),new ge(10,new V(1,34)),new ge(16,new V(1,28)),new ge(22,new V(1,22)),new ge(28,new V(1,16))),new dt(3,Int32Array.from([6,22]),new ge(15,new V(1,55)),new ge(26,new V(1,44)),new ge(18,new V(2,17)),new ge(22,new V(2,13))),new dt(4,Int32Array.from([6,26]),new ge(20,new V(1,80)),new ge(18,new V(2,32)),new ge(26,new V(2,24)),new ge(16,new V(4,9))),new dt(5,Int32Array.from([6,30]),new ge(26,new V(1,108)),new ge(24,new V(2,43)),new ge(18,new V(2,15),new V(2,16)),new ge(22,new V(2,11),new V(2,12))),new dt(6,Int32Array.from([6,34]),new ge(18,new V(2,68)),new ge(16,new V(4,27)),new ge(24,new V(4,19)),new ge(28,new V(4,15))),new dt(7,Int32Array.from([6,22,38]),new ge(20,new V(2,78)),new ge(18,new V(4,31)),new ge(18,new V(2,14),new V(4,15)),new ge(26,new V(4,13),new V(1,14))),new dt(8,Int32Array.from([6,24,42]),new ge(24,new V(2,97)),new ge(22,new V(2,38),new V(2,39)),new ge(22,new V(4,18),new V(2,19)),new ge(26,new V(4,14),new V(2,15))),new dt(9,Int32Array.from([6,26,46]),new ge(30,new V(2,116)),new ge(22,new V(3,36),new V(2,37)),new ge(20,new V(4,16),new V(4,17)),new ge(24,new V(4,12),new V(4,13))),new dt(10,Int32Array.from([6,28,50]),new ge(18,new V(2,68),new V(2,69)),new ge(26,new V(4,43),new V(1,44)),new ge(24,new V(6,19),new V(2,20)),new ge(28,new V(6,15),new V(2,16))),new dt(11,Int32Array.from([6,30,54]),new ge(20,new V(4,81)),new ge(30,new V(1,50),new V(4,51)),new ge(28,new V(4,22),new V(4,23)),new ge(24,new V(3,12),new V(8,13))),new dt(12,Int32Array.from([6,32,58]),new ge(24,new V(2,92),new V(2,93)),new ge(22,new V(6,36),new V(2,37)),new ge(26,new V(4,20),new V(6,21)),new ge(28,new V(7,14),new V(4,15))),new dt(13,Int32Array.from([6,34,62]),new ge(26,new V(4,107)),new ge(22,new V(8,37),new V(1,38)),new ge(24,new V(8,20),new V(4,21)),new ge(22,new V(12,11),new V(4,12))),new dt(14,Int32Array.from([6,26,46,66]),new ge(30,new V(3,115),new V(1,116)),new ge(24,new V(4,40),new V(5,41)),new ge(20,new V(11,16),new V(5,17)),new ge(24,new V(11,12),new V(5,13))),new dt(15,Int32Array.from([6,26,48,70]),new ge(22,new V(5,87),new V(1,88)),new ge(24,new V(5,41),new V(5,42)),new ge(30,new V(5,24),new V(7,25)),new ge(24,new V(11,12),new V(7,13))),new dt(16,Int32Array.from([6,26,50,74]),new ge(24,new V(5,98),new V(1,99)),new ge(28,new V(7,45),new V(3,46)),new ge(24,new V(15,19),new V(2,20)),new ge(30,new V(3,15),new V(13,16))),new dt(17,Int32Array.from([6,30,54,78]),new ge(28,new V(1,107),new V(5,108)),new ge(28,new V(10,46),new V(1,47)),new ge(28,new V(1,22),new V(15,23)),new ge(28,new V(2,14),new V(17,15))),new dt(18,Int32Array.from([6,30,56,82]),new ge(30,new V(5,120),new V(1,121)),new ge(26,new V(9,43),new V(4,44)),new ge(28,new V(17,22),new V(1,23)),new ge(28,new V(2,14),new V(19,15))),new dt(19,Int32Array.from([6,30,58,86]),new ge(28,new V(3,113),new V(4,114)),new ge(26,new V(3,44),new V(11,45)),new ge(26,new V(17,21),new V(4,22)),new ge(26,new V(9,13),new V(16,14))),new dt(20,Int32Array.from([6,34,62,90]),new ge(28,new V(3,107),new V(5,108)),new ge(26,new V(3,41),new V(13,42)),new ge(30,new V(15,24),new V(5,25)),new ge(28,new V(15,15),new V(10,16))),new dt(21,Int32Array.from([6,28,50,72,94]),new ge(28,new V(4,116),new V(4,117)),new ge(26,new V(17,42)),new ge(28,new V(17,22),new V(6,23)),new ge(30,new V(19,16),new V(6,17))),new dt(22,Int32Array.from([6,26,50,74,98]),new ge(28,new V(2,111),new V(7,112)),new ge(28,new V(17,46)),new ge(30,new V(7,24),new V(16,25)),new ge(24,new V(34,13))),new dt(23,Int32Array.from([6,30,54,78,102]),new ge(30,new V(4,121),new V(5,122)),new ge(28,new V(4,47),new V(14,48)),new ge(30,new V(11,24),new V(14,25)),new ge(30,new V(16,15),new V(14,16))),new dt(24,Int32Array.from([6,28,54,80,106]),new ge(30,new V(6,117),new V(4,118)),new ge(28,new V(6,45),new V(14,46)),new ge(30,new V(11,24),new V(16,25)),new ge(30,new V(30,16),new V(2,17))),new dt(25,Int32Array.from([6,32,58,84,110]),new ge(26,new V(8,106),new V(4,107)),new ge(28,new V(8,47),new V(13,48)),new ge(30,new V(7,24),new V(22,25)),new ge(30,new V(22,15),new V(13,16))),new dt(26,Int32Array.from([6,30,58,86,114]),new ge(28,new V(10,114),new V(2,115)),new ge(28,new V(19,46),new V(4,47)),new ge(28,new V(28,22),new V(6,23)),new ge(30,new V(33,16),new V(4,17))),new dt(27,Int32Array.from([6,34,62,90,118]),new ge(30,new V(8,122),new V(4,123)),new ge(28,new V(22,45),new V(3,46)),new ge(30,new V(8,23),new V(26,24)),new ge(30,new V(12,15),new V(28,16))),new dt(28,Int32Array.from([6,26,50,74,98,122]),new ge(30,new V(3,117),new V(10,118)),new ge(28,new V(3,45),new V(23,46)),new ge(30,new V(4,24),new V(31,25)),new ge(30,new V(11,15),new V(31,16))),new dt(29,Int32Array.from([6,30,54,78,102,126]),new ge(30,new V(7,116),new V(7,117)),new ge(28,new V(21,45),new V(7,46)),new ge(30,new V(1,23),new V(37,24)),new ge(30,new V(19,15),new V(26,16))),new dt(30,Int32Array.from([6,26,52,78,104,130]),new ge(30,new V(5,115),new V(10,116)),new ge(28,new V(19,47),new V(10,48)),new ge(30,new V(15,24),new V(25,25)),new ge(30,new V(23,15),new V(25,16))),new dt(31,Int32Array.from([6,30,56,82,108,134]),new ge(30,new V(13,115),new V(3,116)),new ge(28,new V(2,46),new V(29,47)),new ge(30,new V(42,24),new V(1,25)),new ge(30,new V(23,15),new V(28,16))),new dt(32,Int32Array.from([6,34,60,86,112,138]),new ge(30,new V(17,115)),new ge(28,new V(10,46),new V(23,47)),new ge(30,new V(10,24),new V(35,25)),new ge(30,new V(19,15),new V(35,16))),new dt(33,Int32Array.from([6,30,58,86,114,142]),new ge(30,new V(17,115),new V(1,116)),new ge(28,new V(14,46),new V(21,47)),new ge(30,new V(29,24),new V(19,25)),new ge(30,new V(11,15),new V(46,16))),new dt(34,Int32Array.from([6,34,62,90,118,146]),new ge(30,new V(13,115),new V(6,116)),new ge(28,new V(14,46),new V(23,47)),new ge(30,new V(44,24),new V(7,25)),new ge(30,new V(59,16),new V(1,17))),new dt(35,Int32Array.from([6,30,54,78,102,126,150]),new ge(30,new V(12,121),new V(7,122)),new ge(28,new V(12,47),new V(26,48)),new ge(30,new V(39,24),new V(14,25)),new ge(30,new V(22,15),new V(41,16))),new dt(36,Int32Array.from([6,24,50,76,102,128,154]),new ge(30,new V(6,121),new V(14,122)),new ge(28,new V(6,47),new V(34,48)),new ge(30,new V(46,24),new V(10,25)),new ge(30,new V(2,15),new V(64,16))),new dt(37,Int32Array.from([6,28,54,80,106,132,158]),new ge(30,new V(17,122),new V(4,123)),new ge(28,new V(29,46),new V(14,47)),new ge(30,new V(49,24),new V(10,25)),new ge(30,new V(24,15),new V(46,16))),new dt(38,Int32Array.from([6,32,58,84,110,136,162]),new ge(30,new V(4,122),new V(18,123)),new ge(28,new V(13,46),new V(32,47)),new ge(30,new V(48,24),new V(14,25)),new ge(30,new V(42,15),new V(32,16))),new dt(39,Int32Array.from([6,26,54,82,110,138,166]),new ge(30,new V(20,117),new V(4,118)),new ge(28,new V(40,47),new V(7,48)),new ge(30,new V(43,24),new V(22,25)),new ge(30,new V(10,15),new V(67,16))),new dt(40,Int32Array.from([6,30,58,86,114,142,170]),new ge(30,new V(19,118),new V(6,119)),new ge(28,new V(18,47),new V(31,48)),new ge(30,new V(34,24),new V(34,25)),new ge(30,new V(20,15),new V(61,16)))];var aa;(function(k){k[k.DATA_MASK_000=0]="DATA_MASK_000",k[k.DATA_MASK_001=1]="DATA_MASK_001",k[k.DATA_MASK_010=2]="DATA_MASK_010",k[k.DATA_MASK_011=3]="DATA_MASK_011",k[k.DATA_MASK_100=4]="DATA_MASK_100",k[k.DATA_MASK_101=5]="DATA_MASK_101",k[k.DATA_MASK_110=6]="DATA_MASK_110",k[k.DATA_MASK_111=7]="DATA_MASK_111"})(aa||(aa={}));class qa{constructor(a,i){this.value=a,this.isMasked=i}unmaskBitMatrix(a,i){for(let o=0;o<i;o++)for(let l=0;l<i;l++)this.isMasked(o,l)&&a.flip(l,o)}}qa.values=new Map([[aa.DATA_MASK_000,new qa(aa.DATA_MASK_000,(k,a)=>(k+a&1)===0)],[aa.DATA_MASK_001,new qa(aa.DATA_MASK_001,(k,a)=>(k&1)===0)],[aa.DATA_MASK_010,new qa(aa.DATA_MASK_010,(k,a)=>a%3===0)],[aa.DATA_MASK_011,new qa(aa.DATA_MASK_011,(k,a)=>(k+a)%3===0)],[aa.DATA_MASK_100,new qa(aa.DATA_MASK_100,(k,a)=>(Math.floor(k/2)+Math.floor(a/3)&1)===0)],[aa.DATA_MASK_101,new qa(aa.DATA_MASK_101,(k,a)=>k*a%6===0)],[aa.DATA_MASK_110,new qa(aa.DATA_MASK_110,(k,a)=>k*a%6<3)],[aa.DATA_MASK_111,new qa(aa.DATA_MASK_111,(k,a)=>(k+a+k*a%3&1)===0)]]);class hc{constructor(a){const i=a.getHeight();if(i<21||(i&3)!==1)throw new M;this.bitMatrix=a}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let a=0;for(let f=0;f<6;f++)a=this.copyBit(f,8,a);a=this.copyBit(7,8,a),a=this.copyBit(8,8,a),a=this.copyBit(8,7,a);for(let f=5;f>=0;f--)a=this.copyBit(8,f,a);const i=this.bitMatrix.getHeight();let o=0;const l=i-7;for(let f=i-1;f>=l;f--)o=this.copyBit(8,f,o);for(let f=i-8;f<i;f++)o=this.copyBit(f,8,o);if(this.parsedFormatInfo=ca.decodeFormatInformation(a,o),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new M}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const a=this.bitMatrix.getHeight(),i=Math.floor((a-17)/4);if(i<=6)return dt.getVersionForNumber(i);let o=0;const l=a-11;for(let u=5;u>=0;u--)for(let x=a-9;x>=l;x--)o=this.copyBit(x,u,o);let f=dt.decodeVersionInformation(o);if(f!==null&&f.getDimensionForVersion()===a)return this.parsedVersion=f,f;o=0;for(let u=5;u>=0;u--)for(let x=a-9;x>=l;x--)o=this.copyBit(u,x,o);if(f=dt.decodeVersionInformation(o),f!==null&&f.getDimensionForVersion()===a)return this.parsedVersion=f,f;throw new M}copyBit(a,i,o){return(this.isMirror?this.bitMatrix.get(i,a):this.bitMatrix.get(a,i))?o<<1|1:o<<1}readCodewords(){const a=this.readFormatInformation(),i=this.readVersion(),o=qa.values.get(a.getDataMask()),l=this.bitMatrix.getHeight();o.unmaskBitMatrix(this.bitMatrix,l);const f=i.buildFunctionPattern();let u=!0;const x=new Uint8Array(i.getTotalCodewords());let p=0,y=0,b=0;for(let I=l-1;I>0;I-=2){I===6&&I--;for(let R=0;R<l;R++){const G=u?l-1-R:R;for(let Q=0;Q<2;Q++)f.get(I-Q,G)||(b++,y<<=1,this.bitMatrix.get(I-Q,G)&&(y|=1),b===8&&(x[p++]=y,b=0,y=0))}u=!u}if(p!==i.getTotalCodewords())throw new M;return x}remask(){if(this.parsedFormatInfo===null)return;const a=qa.values[this.parsedFormatInfo.getDataMask()],i=this.bitMatrix.getHeight();a.unmaskBitMatrix(this.bitMatrix,i)}setMirror(a){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=a}mirror(){const a=this.bitMatrix;for(let i=0,o=a.getWidth();i<o;i++)for(let l=i+1,f=a.getHeight();l<f;l++)a.get(i,l)!==a.get(l,i)&&(a.flip(l,i),a.flip(i,l))}}class Gi{constructor(a,i){this.numDataCodewords=a,this.codewords=i}static getDataBlocks(a,i,o){if(a.length!==i.getTotalCodewords())throw new _;const l=i.getECBlocksForLevel(o);let f=0;const u=l.getECBlocks();for(const Q of u)f+=Q.getCount();const x=new Array(f);let p=0;for(const Q of u)for(let re=0;re<Q.getCount();re++){const ue=Q.getDataCodewords(),Ae=l.getECCodewordsPerBlock()+ue;x[p++]=new Gi(ue,new Uint8Array(Ae))}const y=x[0].codewords.length;let b=x.length-1;for(;b>=0&&x[b].codewords.length!==y;)b--;b++;const I=y-l.getECCodewordsPerBlock();let R=0;for(let Q=0;Q<I;Q++)for(let re=0;re<p;re++)x[re].codewords[Q]=a[R++];for(let Q=b;Q<p;Q++)x[Q].codewords[I]=a[R++];const G=x[0].codewords.length;for(let Q=I;Q<G;Q++)for(let re=0;re<p;re++){const ue=re<b?Q:Q+1;x[re].codewords[ue]=a[R++]}return x}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Ra;(function(k){k[k.TERMINATOR=0]="TERMINATOR",k[k.NUMERIC=1]="NUMERIC",k[k.ALPHANUMERIC=2]="ALPHANUMERIC",k[k.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",k[k.BYTE=4]="BYTE",k[k.ECI=5]="ECI",k[k.KANJI=6]="KANJI",k[k.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",k[k.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",k[k.HANZI=9]="HANZI"})(Ra||(Ra={}));class xt{constructor(a,i,o,l){this.value=a,this.stringValue=i,this.characterCountBitsForVersions=o,this.bits=l,xt.FOR_BITS.set(l,this),xt.FOR_VALUE.set(a,this)}static forBits(a){const i=xt.FOR_BITS.get(a);if(i===void 0)throw new _;return i}getCharacterCountBits(a){const i=a.getVersionNumber();let o;return i<=9?o=0:i<=26?o=1:o=2,this.characterCountBitsForVersions[o]}getValue(){return this.value}getBits(){return this.bits}equals(a){if(!(a instanceof xt))return!1;const i=a;return this.value===i.value}toString(){return this.stringValue}}xt.FOR_BITS=new Map,xt.FOR_VALUE=new Map,xt.TERMINATOR=new xt(Ra.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),xt.NUMERIC=new xt(Ra.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),xt.ALPHANUMERIC=new xt(Ra.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),xt.STRUCTURED_APPEND=new xt(Ra.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),xt.BYTE=new xt(Ra.BYTE,"BYTE",Int32Array.from([8,16,16]),4),xt.ECI=new xt(Ra.ECI,"ECI",Int32Array.from([0,0,0]),7),xt.KANJI=new xt(Ra.KANJI,"KANJI",Int32Array.from([8,10,12]),8),xt.FNC1_FIRST_POSITION=new xt(Ra.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),xt.FNC1_SECOND_POSITION=new xt(Ra.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),xt.HANZI=new xt(Ra.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class wr{static decode(a,i,o,l){const f=new Ln(a);let u=new be;const x=new Array;let p=-1,y=-1;try{let b=null,I=!1,R;do{if(f.available()<4)R=xt.TERMINATOR;else{const G=f.readBits(4);R=xt.forBits(G)}switch(R){case xt.TERMINATOR:break;case xt.FNC1_FIRST_POSITION:case xt.FNC1_SECOND_POSITION:I=!0;break;case xt.STRUCTURED_APPEND:if(f.available()<16)throw new M;p=f.readBits(8),y=f.readBits(8);break;case xt.ECI:const G=wr.parseECIValue(f);if(b=j.getCharacterSetECIByValue(G),b===null)throw new M;break;case xt.HANZI:const Q=f.readBits(4),re=f.readBits(R.getCharacterCountBits(i));Q===wr.GB2312_SUBSET&&wr.decodeHanziSegment(f,u,re);break;default:const ue=f.readBits(R.getCharacterCountBits(i));switch(R){case xt.NUMERIC:wr.decodeNumericSegment(f,u,ue);break;case xt.ALPHANUMERIC:wr.decodeAlphanumericSegment(f,u,ue,I);break;case xt.BYTE:wr.decodeByteSegment(f,u,ue,b,x,l);break;case xt.KANJI:wr.decodeKanjiSegment(f,u,ue);break;default:throw new M}break}}while(R!==xt.TERMINATOR)}catch{throw new M}return new Pe(a,u.toString(),x.length===0?null:x,o===null?null:o.toString(),p,y)}static decodeHanziSegment(a,i,o){if(o*13>a.available())throw new M;const l=new Uint8Array(2*o);let f=0;for(;o>0;){const u=a.readBits(13);let x=u/96<<8&4294967295|u%96;x<959?x+=41377:x+=42657,l[f]=x>>8&255,l[f+1]=x&255,f+=2,o--}try{i.append(he.decode(l,te.GB2312))}catch(u){throw new M(u)}}static decodeKanjiSegment(a,i,o){if(o*13>a.available())throw new M;const l=new Uint8Array(2*o);let f=0;for(;o>0;){const u=a.readBits(13);let x=u/192<<8&4294967295|u%192;x<7936?x+=33088:x+=49472,l[f]=x>>8,l[f+1]=x,f+=2,o--}try{i.append(he.decode(l,te.SHIFT_JIS))}catch(u){throw new M(u)}}static decodeByteSegment(a,i,o,l,f,u){if(8*o>a.available())throw new M;const x=new Uint8Array(o);for(let y=0;y<o;y++)x[y]=a.readBits(8);let p;l===null?p=te.guessEncoding(x,u):p=l.getName();try{i.append(he.decode(x,p))}catch(y){throw new M(y)}f.push(x)}static toAlphaNumericChar(a){if(a>=wr.ALPHANUMERIC_CHARS.length)throw new M;return wr.ALPHANUMERIC_CHARS[a]}static decodeAlphanumericSegment(a,i,o,l){const f=i.length();for(;o>1;){if(a.available()<11)throw new M;const u=a.readBits(11);i.append(wr.toAlphaNumericChar(Math.floor(u/45))),i.append(wr.toAlphaNumericChar(u%45)),o-=2}if(o===1){if(a.available()<6)throw new M;i.append(wr.toAlphaNumericChar(a.readBits(6)))}if(l)for(let u=f;u<i.length();u++)i.charAt(u)==="%"&&(u<i.length()-1&&i.charAt(u+1)==="%"?i.deleteCharAt(u+1):i.setCharAt(u,""))}static decodeNumericSegment(a,i,o){for(;o>=3;){if(a.available()<10)throw new M;const l=a.readBits(10);if(l>=1e3)throw new M;i.append(wr.toAlphaNumericChar(Math.floor(l/100))),i.append(wr.toAlphaNumericChar(Math.floor(l/10)%10)),i.append(wr.toAlphaNumericChar(l%10)),o-=3}if(o===2){if(a.available()<7)throw new M;const l=a.readBits(7);if(l>=100)throw new M;i.append(wr.toAlphaNumericChar(Math.floor(l/10))),i.append(wr.toAlphaNumericChar(l%10))}else if(o===1){if(a.available()<4)throw new M;const l=a.readBits(4);if(l>=10)throw new M;i.append(wr.toAlphaNumericChar(l))}}static parseECIValue(a){const i=a.readBits(8);if(!(i&128))return i&127;if((i&192)===128){const o=a.readBits(8);return(i&63)<<8&4294967295|o}if((i&224)===192){const o=a.readBits(16);return(i&31)<<16&4294967295|o}throw new M}}wr.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",wr.GB2312_SUBSET=1;class Es{constructor(a){this.mirrored=a}isMirrored(){return this.mirrored}applyMirroredCorrection(a){if(!this.mirrored||a===null||a.length<3)return;const i=a[0];a[0]=a[2],a[2]=i}}class $s{constructor(){this.rsDecoder=new ze(Y.QR_CODE_FIELD_256)}decodeBooleanArray(a,i){return this.decodeBitMatrix($e.parseFromBooleanArray(a),i)}decodeBitMatrix(a,i){const o=new hc(a);let l=null;try{return this.decodeBitMatrixParser(o,i)}catch(f){l=f}try{o.remask(),o.setMirror(!0),o.readVersion(),o.readFormatInformation(),o.mirror();const f=this.decodeBitMatrixParser(o,i);return f.setOther(new Es(!0)),f}catch(f){throw l!==null?l:f}}decodeBitMatrixParser(a,i){const o=a.readVersion(),l=a.readFormatInformation().getErrorCorrectionLevel(),f=a.readCodewords(),u=Gi.getDataBlocks(f,o,l);let x=0;for(const b of u)x+=b.getNumDataCodewords();const p=new Uint8Array(x);let y=0;for(const b of u){const I=b.getCodewords(),R=b.getNumDataCodewords();this.correctErrors(I,R);for(let G=0;G<R;G++)p[y++]=I[G]}return wr.decode(p,o,l,i)}correctErrors(a,i){const o=new Int32Array(a);try{this.rsDecoder.decode(o,a.length-i)}catch{throw new T}for(let l=0;l<i;l++)a[l]=o[l]}}class Xi extends st{constructor(a,i,o){super(a,i),this.estimatedModuleSize=o}aboutEquals(a,i,o){if(Math.abs(i-this.getY())<=a&&Math.abs(o-this.getX())<=a){const l=Math.abs(a-this.estimatedModuleSize);return l<=1||l<=this.estimatedModuleSize}return!1}combineEstimate(a,i,o){const l=(this.getX()+i)/2,f=(this.getY()+a)/2,u=(this.estimatedModuleSize+o)/2;return new Xi(l,f,u)}}class _s{constructor(a,i,o,l,f,u,x){this.image=a,this.startX=i,this.startY=o,this.width=l,this.height=f,this.moduleSize=u,this.resultPointCallback=x,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const a=this.startX,i=this.height,o=this.width,l=a+o,f=this.startY+i/2,u=new Int32Array(3),x=this.image;for(let p=0;p<i;p++){const y=f+(p&1?-Math.floor((p+1)/2):Math.floor((p+1)/2));u[0]=0,u[1]=0,u[2]=0;let b=a;for(;b<l&&!x.get(b,y);)b++;let I=0;for(;b<l;){if(x.get(b,y))if(I===1)u[1]++;else if(I===2){if(this.foundPatternCross(u)){const R=this.handlePossibleCenter(u,y,b);if(R!==null)return R}u[0]=u[2],u[1]=1,u[2]=0,I=1}else u[++I]++;else I===1&&I++,u[I]++;b++}if(this.foundPatternCross(u)){const R=this.handlePossibleCenter(u,y,l);if(R!==null)return R}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new ae}static centerFromEnd(a,i){return i-a[2]-a[1]/2}foundPatternCross(a){const i=this.moduleSize,o=i/2;for(let l=0;l<3;l++)if(Math.abs(i-a[l])>=o)return!1;return!0}crossCheckVertical(a,i,o,l){const f=this.image,u=f.getHeight(),x=this.crossCheckStateCount;x[0]=0,x[1]=0,x[2]=0;let p=a;for(;p>=0&&f.get(i,p)&&x[1]<=o;)x[1]++,p--;if(p<0||x[1]>o)return NaN;for(;p>=0&&!f.get(i,p)&&x[0]<=o;)x[0]++,p--;if(x[0]>o)return NaN;for(p=a+1;p<u&&f.get(i,p)&&x[1]<=o;)x[1]++,p++;if(p===u||x[1]>o)return NaN;for(;p<u&&!f.get(i,p)&&x[2]<=o;)x[2]++,p++;if(x[2]>o)return NaN;const y=x[0]+x[1]+x[2];return 5*Math.abs(y-l)>=2*l?NaN:this.foundPatternCross(x)?_s.centerFromEnd(x,p):NaN}handlePossibleCenter(a,i,o){const l=a[0]+a[1]+a[2],f=_s.centerFromEnd(a,o),u=this.crossCheckVertical(i,f,2*a[1],l);if(!isNaN(u)){const x=(a[0]+a[1]+a[2])/3;for(const y of this.possibleCenters)if(y.aboutEquals(x,u,f))return y.combineEstimate(u,f,x);const p=new Xi(f,u,x);this.possibleCenters.push(p),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(p)}return null}}class e0 extends st{constructor(a,i,o,l){super(a,i),this.estimatedModuleSize=o,this.count=l,l===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(a,i,o){if(Math.abs(i-this.getY())<=a&&Math.abs(o-this.getX())<=a){const l=Math.abs(a-this.estimatedModuleSize);return l<=1||l<=this.estimatedModuleSize}return!1}combineEstimate(a,i,o){const l=this.count+1,f=(this.count*this.getX()+i)/l,u=(this.count*this.getY()+a)/l,x=(this.count*this.estimatedModuleSize+o)/l;return new e0(f,u,x,l)}}class uc{constructor(a){this.bottomLeft=a[0],this.topLeft=a[1],this.topRight=a[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Zr{constructor(a,i){this.image=a,this.resultPointCallback=i,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=i}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(a){const i=a!=null&&a.get(J.TRY_HARDER)!==void 0,o=a!=null&&a.get(J.PURE_BARCODE)!==void 0,l=this.image,f=l.getHeight(),u=l.getWidth();let x=Math.floor(3*f/(4*Zr.MAX_MODULES));(x<Zr.MIN_SKIP||i)&&(x=Zr.MIN_SKIP);let p=!1;const y=new Int32Array(5);for(let I=x-1;I<f&&!p;I+=x){y[0]=0,y[1]=0,y[2]=0,y[3]=0,y[4]=0;let R=0;for(let G=0;G<u;G++)if(l.get(G,I))(R&1)===1&&R++,y[R]++;else if(R&1)y[R]++;else if(R===4)if(Zr.foundPatternCross(y)){if(this.handlePossibleCenter(y,I,G,o)===!0)if(x=2,this.hasSkipped===!0)p=this.haveMultiplyConfirmedCenters();else{const re=this.findRowSkip();re>y[2]&&(I+=re-y[2]-x,G=u-1)}else{y[0]=y[2],y[1]=y[3],y[2]=y[4],y[3]=1,y[4]=0,R=3;continue}R=0,y[0]=0,y[1]=0,y[2]=0,y[3]=0,y[4]=0}else y[0]=y[2],y[1]=y[3],y[2]=y[4],y[3]=1,y[4]=0,R=3;else y[++R]++;Zr.foundPatternCross(y)&&this.handlePossibleCenter(y,I,u,o)===!0&&(x=y[0],this.hasSkipped&&(p=this.haveMultiplyConfirmedCenters()))}const b=this.selectBestPatterns();return st.orderBestPatterns(b),new uc(b)}static centerFromEnd(a,i){return i-a[4]-a[3]-a[2]/2}static foundPatternCross(a){let i=0;for(let f=0;f<5;f++){const u=a[f];if(u===0)return!1;i+=u}if(i<7)return!1;const o=i/7,l=o/2;return Math.abs(o-a[0])<l&&Math.abs(o-a[1])<l&&Math.abs(3*o-a[2])<3*l&&Math.abs(o-a[3])<l&&Math.abs(o-a[4])<l}getCrossCheckStateCount(){const a=this.crossCheckStateCount;return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a}crossCheckDiagonal(a,i,o,l){const f=this.getCrossCheckStateCount();let u=0;const x=this.image;for(;a>=u&&i>=u&&x.get(i-u,a-u);)f[2]++,u++;if(a<u||i<u)return!1;for(;a>=u&&i>=u&&!x.get(i-u,a-u)&&f[1]<=o;)f[1]++,u++;if(a<u||i<u||f[1]>o)return!1;for(;a>=u&&i>=u&&x.get(i-u,a-u)&&f[0]<=o;)f[0]++,u++;if(f[0]>o)return!1;const p=x.getHeight(),y=x.getWidth();for(u=1;a+u<p&&i+u<y&&x.get(i+u,a+u);)f[2]++,u++;if(a+u>=p||i+u>=y)return!1;for(;a+u<p&&i+u<y&&!x.get(i+u,a+u)&&f[3]<o;)f[3]++,u++;if(a+u>=p||i+u>=y||f[3]>=o)return!1;for(;a+u<p&&i+u<y&&x.get(i+u,a+u)&&f[4]<o;)f[4]++,u++;if(f[4]>=o)return!1;const b=f[0]+f[1]+f[2]+f[3]+f[4];return Math.abs(b-l)<2*l&&Zr.foundPatternCross(f)}crossCheckVertical(a,i,o,l){const f=this.image,u=f.getHeight(),x=this.getCrossCheckStateCount();let p=a;for(;p>=0&&f.get(i,p);)x[2]++,p--;if(p<0)return NaN;for(;p>=0&&!f.get(i,p)&&x[1]<=o;)x[1]++,p--;if(p<0||x[1]>o)return NaN;for(;p>=0&&f.get(i,p)&&x[0]<=o;)x[0]++,p--;if(x[0]>o)return NaN;for(p=a+1;p<u&&f.get(i,p);)x[2]++,p++;if(p===u)return NaN;for(;p<u&&!f.get(i,p)&&x[3]<o;)x[3]++,p++;if(p===u||x[3]>=o)return NaN;for(;p<u&&f.get(i,p)&&x[4]<o;)x[4]++,p++;if(x[4]>=o)return NaN;const y=x[0]+x[1]+x[2]+x[3]+x[4];return 5*Math.abs(y-l)>=2*l?NaN:Zr.foundPatternCross(x)?Zr.centerFromEnd(x,p):NaN}crossCheckHorizontal(a,i,o,l){const f=this.image,u=f.getWidth(),x=this.getCrossCheckStateCount();let p=a;for(;p>=0&&f.get(p,i);)x[2]++,p--;if(p<0)return NaN;for(;p>=0&&!f.get(p,i)&&x[1]<=o;)x[1]++,p--;if(p<0||x[1]>o)return NaN;for(;p>=0&&f.get(p,i)&&x[0]<=o;)x[0]++,p--;if(x[0]>o)return NaN;for(p=a+1;p<u&&f.get(p,i);)x[2]++,p++;if(p===u)return NaN;for(;p<u&&!f.get(p,i)&&x[3]<o;)x[3]++,p++;if(p===u||x[3]>=o)return NaN;for(;p<u&&f.get(p,i)&&x[4]<o;)x[4]++,p++;if(x[4]>=o)return NaN;const y=x[0]+x[1]+x[2]+x[3]+x[4];return 5*Math.abs(y-l)>=l?NaN:Zr.foundPatternCross(x)?Zr.centerFromEnd(x,p):NaN}handlePossibleCenter(a,i,o,l){const f=a[0]+a[1]+a[2]+a[3]+a[4];let u=Zr.centerFromEnd(a,o),x=this.crossCheckVertical(i,Math.floor(u),a[2],f);if(!isNaN(x)&&(u=this.crossCheckHorizontal(Math.floor(u),Math.floor(x),a[2],f),!isNaN(u)&&(!l||this.crossCheckDiagonal(Math.floor(x),Math.floor(u),a[2],f)))){const p=f/7;let y=!1;const b=this.possibleCenters;for(let I=0,R=b.length;I<R;I++){const G=b[I];if(G.aboutEquals(p,x,u)){b[I]=G.combineEstimate(x,u,p),y=!0;break}}if(!y){const I=new e0(u,x,p);b.push(I),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(I)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let i=null;for(const o of this.possibleCenters)if(o.getCount()>=Zr.CENTER_QUORUM)if(i==null)i=o;else return this.hasSkipped=!0,Math.floor((Math.abs(i.getX()-o.getX())-Math.abs(i.getY()-o.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let a=0,i=0;const o=this.possibleCenters.length;for(const u of this.possibleCenters)u.getCount()>=Zr.CENTER_QUORUM&&(a++,i+=u.getEstimatedModuleSize());if(a<3)return!1;const l=i/o;let f=0;for(const u of this.possibleCenters)f+=Math.abs(u.getEstimatedModuleSize()-l);return f<=.05*i}selectBestPatterns(){const a=this.possibleCenters.length;if(a<3)throw new ae;const i=this.possibleCenters;let o;if(a>3){let l=0,f=0;for(const p of this.possibleCenters){const y=p.getEstimatedModuleSize();l+=y,f+=y*y}o=l/a;let u=Math.sqrt(f/a-o*o);i.sort((p,y)=>{const b=Math.abs(y.getEstimatedModuleSize()-o),I=Math.abs(p.getEstimatedModuleSize()-o);return b<I?-1:b>I?1:0});const x=Math.max(.2*o,u);for(let p=0;p<i.length&&i.length>3;p++){const y=i[p];Math.abs(y.getEstimatedModuleSize()-o)>x&&(i.splice(p,1),p--)}}if(i.length>3){let l=0;for(const f of i)l+=f.getEstimatedModuleSize();o=l/i.length,i.sort((f,u)=>{if(u.getCount()===f.getCount()){const x=Math.abs(u.getEstimatedModuleSize()-o),p=Math.abs(f.getEstimatedModuleSize()-o);return x<p?1:x>p?-1:0}else return u.getCount()-f.getCount()}),i.splice(3)}return[i[0],i[1],i[2]]}}Zr.CENTER_QUORUM=2,Zr.MIN_SKIP=3,Zr.MAX_MODULES=57;class ei{constructor(a){this.image=a}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(a){this.resultPointCallback=a==null?null:a.get(J.NEED_RESULT_POINT_CALLBACK);const o=new Zr(this.image,this.resultPointCallback).find(a);return this.processFinderPatternInfo(o)}processFinderPatternInfo(a){const i=a.getTopLeft(),o=a.getTopRight(),l=a.getBottomLeft(),f=this.calculateModuleSize(i,o,l);if(f<1)throw new ae("No pattern found in proccess finder.");const u=ei.computeDimension(i,o,l,f),x=dt.getProvisionalVersionForDimension(u),p=x.getDimensionForVersion()-7;let y=null;if(x.getAlignmentPatternCenters().length>0){const G=o.getX()-i.getX()+l.getX(),Q=o.getY()-i.getY()+l.getY(),re=1-3/p,ue=Math.floor(i.getX()+re*(G-i.getX())),Ae=Math.floor(i.getY()+re*(Q-i.getY()));for(let Ke=4;Ke<=16;Ke<<=1)try{y=this.findAlignmentInRegion(f,ue,Ae,Ke);break}catch(Ze){if(!(Ze instanceof ae))throw Ze}}const b=ei.createTransform(i,o,l,y,u),I=ei.sampleGrid(this.image,b,u);let R;return y===null?R=[l,i,o]:R=[l,i,o,y],new An(I,R)}static createTransform(a,i,o,l,f){const u=f-3.5;let x,p,y,b;return l!==null?(x=l.getX(),p=l.getY(),y=u-3,b=y):(x=i.getX()-a.getX()+o.getX(),p=i.getY()-a.getY()+o.getY(),y=u,b=u),Or.quadrilateralToQuadrilateral(3.5,3.5,u,3.5,y,b,3.5,u,a.getX(),a.getY(),i.getX(),i.getY(),x,p,o.getX(),o.getY())}static sampleGrid(a,i,o){return Ar.getInstance().sampleGridWithTransform(a,o,o,i)}static computeDimension(a,i,o,l){const f=Et.round(st.distance(a,i)/l),u=Et.round(st.distance(a,o)/l);let x=Math.floor((f+u)/2)+7;switch(x&3){case 0:x++;break;case 2:x--;break;case 3:throw new ae("Dimensions could be not found.")}return x}calculateModuleSize(a,i,o){return(this.calculateModuleSizeOneWay(a,i)+this.calculateModuleSizeOneWay(a,o))/2}calculateModuleSizeOneWay(a,i){const o=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(a.getX()),Math.floor(a.getY()),Math.floor(i.getX()),Math.floor(i.getY())),l=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(i.getX()),Math.floor(i.getY()),Math.floor(a.getX()),Math.floor(a.getY()));return isNaN(o)?l/7:isNaN(l)?o/7:(o+l)/14}sizeOfBlackWhiteBlackRunBothWays(a,i,o,l){let f=this.sizeOfBlackWhiteBlackRun(a,i,o,l),u=1,x=a-(o-a);x<0?(u=a/(a-x),x=0):x>=this.image.getWidth()&&(u=(this.image.getWidth()-1-a)/(x-a),x=this.image.getWidth()-1);let p=Math.floor(i-(l-i)*u);return u=1,p<0?(u=i/(i-p),p=0):p>=this.image.getHeight()&&(u=(this.image.getHeight()-1-i)/(p-i),p=this.image.getHeight()-1),x=Math.floor(a+(x-a)*u),f+=this.sizeOfBlackWhiteBlackRun(a,i,x,p),f-1}sizeOfBlackWhiteBlackRun(a,i,o,l){const f=Math.abs(l-i)>Math.abs(o-a);if(f){let G=a;a=i,i=G,G=o,o=l,l=G}const u=Math.abs(o-a),x=Math.abs(l-i);let p=-u/2;const y=a<o?1:-1,b=i<l?1:-1;let I=0;const R=o+y;for(let G=a,Q=i;G!==R;G+=y){const re=f?Q:G,ue=f?G:Q;if(I===1===this.image.get(re,ue)){if(I===2)return Et.distance(G,Q,a,i);I++}if(p+=x,p>0){if(Q===l)break;Q+=b,p-=u}}return I===2?Et.distance(o+y,l,a,i):NaN}findAlignmentInRegion(a,i,o,l){const f=Math.floor(l*a),u=Math.max(0,i-f),x=Math.min(this.image.getWidth()-1,i+f);if(x-u<a*3)throw new ae("Alignment top exceeds estimated module size.");const p=Math.max(0,o-f),y=Math.min(this.image.getHeight()-1,o+f);if(y-p<a*3)throw new ae("Alignment bottom exceeds estimated module size.");return new _s(this.image,u,p,x-u,y-p,a,this.resultPointCallback).find()}}class vr{constructor(){this.decoder=new $s}getDecoder(){return this.decoder}decode(a,i){let o,l;if(i!=null&&i.get(J.PURE_BARCODE)!==void 0){const p=vr.extractPureBits(a.getBlackMatrix());o=this.decoder.decodeBitMatrix(p,i),l=vr.NO_POINTS}else{const p=new ei(a.getBlackMatrix()).detect(i);o=this.decoder.decodeBitMatrix(p.getBits(),i),l=p.getPoints()}o.getOther()instanceof Es&&o.getOther().applyMirroredCorrection(l);const f=new ee(o.getText(),o.getRawBytes(),void 0,l,le.QR_CODE,void 0),u=o.getByteSegments();u!==null&&f.putMetadata(Le.BYTE_SEGMENTS,u);const x=o.getECLevel();return x!==null&&f.putMetadata(Le.ERROR_CORRECTION_LEVEL,x),o.hasStructuredAppend()&&(f.putMetadata(Le.STRUCTURED_APPEND_SEQUENCE,o.getStructuredAppendSequenceNumber()),f.putMetadata(Le.STRUCTURED_APPEND_PARITY,o.getStructuredAppendParity())),f}reset(){}static extractPureBits(a){const i=a.getTopLeftOnBit(),o=a.getBottomRightOnBit();if(i===null||o===null)throw new ae;const l=this.moduleSize(i,a);let f=i[1],u=o[1],x=i[0],p=o[0];if(x>=p||f>=u)throw new ae;if(u-f!==p-x&&(p=x+(u-f),p>=a.getWidth()))throw new ae;const y=Math.round((p-x+1)/l),b=Math.round((u-f+1)/l);if(y<=0||b<=0)throw new ae;if(b!==y)throw new ae;const I=Math.floor(l/2);f+=I,x+=I;const R=x+Math.floor((y-1)*l)-p;if(R>0){if(R>I)throw new ae;x-=R}const G=f+Math.floor((b-1)*l)-u;if(G>0){if(G>I)throw new ae;f-=G}const Q=new $e(y,b);for(let re=0;re<b;re++){const ue=f+Math.floor(re*l);for(let Ae=0;Ae<y;Ae++)a.get(x+Math.floor(Ae*l),ue)&&Q.set(Ae,re)}return Q}static moduleSize(a,i){const o=i.getHeight(),l=i.getWidth();let f=a[0],u=a[1],x=!0,p=0;for(;f<l&&u<o;){if(x!==i.get(f,u)){if(++p===5)break;x=!x}f++,u++}if(f===l||u===o)throw new ae;return(f-a[0])/7}}vr.NO_POINTS=new Array;class yt{PDF417Common(){}static getBitCountSum(a){return Et.sum(a)}static toIntArray(a){if(a==null||!a.length)return yt.EMPTY_INT_ARRAY;const i=new Int32Array(a.length);let o=0;for(const l of a)i[o++]=l;return i}static getCodeword(a){const i=X.binarySearch(yt.SYMBOL_TABLE,a&262143);return i<0?-1:(yt.CODEWORD_TABLE[i]-1)%yt.NUMBER_OF_CODEWORDS}}yt.NUMBER_OF_CODEWORDS=929,yt.MAX_CODEWORDS_IN_BARCODE=yt.NUMBER_OF_CODEWORDS-1,yt.MIN_ROWS_IN_BARCODE=3,yt.MAX_ROWS_IN_BARCODE=90,yt.MODULES_IN_CODEWORD=17,yt.MODULES_IN_STOP_PATTERN=18,yt.BARS_IN_MODULE=8,yt.EMPTY_INT_ARRAY=new Int32Array([]),yt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),yt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class dc{constructor(a,i){this.bits=a,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class Lt{static detectMultiple(a,i,o){let l=a.getBlackMatrix(),f=Lt.detect(o,l);return f.length||(l=l.clone(),l.rotate180(),f=Lt.detect(o,l)),new dc(l,f)}static detect(a,i){const o=new Array;let l=0,f=0,u=!1;for(;l<i.getHeight();){const x=Lt.findVertices(i,l,f);if(x[0]==null&&x[3]==null){if(!u)break;u=!1,f=0;for(const p of o)p[1]!=null&&(l=Math.trunc(Math.max(l,p[1].getY()))),p[3]!=null&&(l=Math.max(l,Math.trunc(p[3].getY())));l+=Lt.ROW_STEP;continue}if(u=!0,o.push(x),!a)break;x[2]!=null?(f=Math.trunc(x[2].getX()),l=Math.trunc(x[2].getY())):(f=Math.trunc(x[4].getX()),l=Math.trunc(x[4].getY()))}return o}static findVertices(a,i,o){const l=a.getHeight(),f=a.getWidth(),u=new Array(8);return Lt.copyToResult(u,Lt.findRowsWithPattern(a,l,f,i,o,Lt.START_PATTERN),Lt.INDEXES_START_PATTERN),u[4]!=null&&(o=Math.trunc(u[4].getX()),i=Math.trunc(u[4].getY())),Lt.copyToResult(u,Lt.findRowsWithPattern(a,l,f,i,o,Lt.STOP_PATTERN),Lt.INDEXES_STOP_PATTERN),u}static copyToResult(a,i,o){for(let l=0;l<o.length;l++)a[o[l]]=i[l]}static findRowsWithPattern(a,i,o,l,f,u){const x=new Array(4);let p=!1;const y=new Int32Array(u.length);for(;l<i;l+=Lt.ROW_STEP){let I=Lt.findGuardPattern(a,f,l,o,!1,u,y);if(I!=null){for(;l>0;){const R=Lt.findGuardPattern(a,f,--l,o,!1,u,y);if(R!=null)I=R;else{l++;break}}x[0]=new st(I[0],l),x[1]=new st(I[1],l),p=!0;break}}let b=l+1;if(p){let I=0,R=Int32Array.from([Math.trunc(x[0].getX()),Math.trunc(x[1].getX())]);for(;b<i;b++){const G=Lt.findGuardPattern(a,R[0],b,o,!1,u,y);if(G!=null&&Math.abs(R[0]-G[0])<Lt.MAX_PATTERN_DRIFT&&Math.abs(R[1]-G[1])<Lt.MAX_PATTERN_DRIFT)R=G,I=0;else{if(I>Lt.SKIPPED_ROW_COUNT_MAX)break;I++}}b-=I+1,x[2]=new st(R[0],b),x[3]=new st(R[1],b)}return b-l<Lt.BARCODE_MIN_HEIGHT&&X.fill(x,null),x}static findGuardPattern(a,i,o,l,f,u,x){X.fillWithin(x,0,x.length,0);let p=i,y=0;for(;a.get(p,o)&&p>0&&y++<Lt.MAX_PIXEL_DRIFT;)p--;let b=p,I=0,R=u.length;for(let G=f;b<l;b++)if(a.get(b,o)!==G)x[I]++;else{if(I===R-1){if(Lt.patternMatchVariance(x,u,Lt.MAX_INDIVIDUAL_VARIANCE)<Lt.MAX_AVG_VARIANCE)return new Int32Array([p,b]);p+=x[0]+x[1],S.arraycopy(x,2,x,0,I-1),x[I-1]=0,x[I]=0,I--}else I++;x[I]=1,G=!G}return I===R-1&&Lt.patternMatchVariance(x,u,Lt.MAX_INDIVIDUAL_VARIANCE)<Lt.MAX_AVG_VARIANCE?new Int32Array([p,b-1]):null}static patternMatchVariance(a,i,o){let l=a.length,f=0,u=0;for(let y=0;y<l;y++)f+=a[y],u+=i[y];if(f<u)return 1/0;let x=f/u;o*=x;let p=0;for(let y=0;y<l;y++){let b=a[y],I=i[y]*x,R=b>I?b-I:I-b;if(R>o)return 1/0;p+=R}return p/f}}Lt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Lt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Lt.MAX_AVG_VARIANCE=.42,Lt.MAX_INDIVIDUAL_VARIANCE=.8,Lt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Lt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Lt.MAX_PIXEL_DRIFT=3,Lt.MAX_PATTERN_DRIFT=5,Lt.SKIPPED_ROW_COUNT_MAX=25,Lt.ROW_STEP=5,Lt.BARCODE_MIN_HEIGHT=10;class Jr{constructor(a,i){if(i.length===0)throw new _;this.field=a;let o=i.length;if(o>1&&i[0]===0){let l=1;for(;l<o&&i[l]===0;)l++;l===o?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(o-l),S.arraycopy(i,l,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(a){return this.coefficients[this.coefficients.length-1-a]}evaluateAt(a){if(a===0)return this.getCoefficient(0);if(a===1){let l=0;for(let f of this.coefficients)l=this.field.add(l,f);return l}let i=this.coefficients[0],o=this.coefficients.length;for(let l=1;l<o;l++)i=this.field.add(this.field.multiply(a,i),this.coefficients[l]);return i}add(a){if(!this.field.equals(a.field))throw new _("ModulusPolys do not have same ModulusGF field");if(this.isZero())return a;if(a.isZero())return this;let i=this.coefficients,o=a.coefficients;if(i.length>o.length){let u=i;i=o,o=u}let l=new Int32Array(o.length),f=o.length-i.length;S.arraycopy(o,0,l,0,f);for(let u=f;u<o.length;u++)l[u]=this.field.add(i[u-f],o[u]);return new Jr(this.field,l)}subtract(a){if(!this.field.equals(a.field))throw new _("ModulusPolys do not have same ModulusGF field");return a.isZero()?this:this.add(a.negative())}multiply(a){return a instanceof Jr?this.multiplyOther(a):this.multiplyScalar(a)}multiplyOther(a){if(!this.field.equals(a.field))throw new _("ModulusPolys do not have same ModulusGF field");if(this.isZero()||a.isZero())return new Jr(this.field,new Int32Array([0]));let i=this.coefficients,o=i.length,l=a.coefficients,f=l.length,u=new Int32Array(o+f-1);for(let x=0;x<o;x++){let p=i[x];for(let y=0;y<f;y++)u[x+y]=this.field.add(u[x+y],this.field.multiply(p,l[y]))}return new Jr(this.field,u)}negative(){let a=this.coefficients.length,i=new Int32Array(a);for(let o=0;o<a;o++)i[o]=this.field.subtract(0,this.coefficients[o]);return new Jr(this.field,i)}multiplyScalar(a){if(a===0)return new Jr(this.field,new Int32Array([0]));if(a===1)return this;let i=this.coefficients.length,o=new Int32Array(i);for(let l=0;l<i;l++)o[l]=this.field.multiply(this.coefficients[l],a);return new Jr(this.field,o)}multiplyByMonomial(a,i){if(a<0)throw new _;if(i===0)return new Jr(this.field,new Int32Array([0]));let o=this.coefficients.length,l=new Int32Array(o+a);for(let f=0;f<o;f++)l[f]=this.field.multiply(this.coefficients[f],i);return new Jr(this.field,l)}toString(){let a=new be;for(let i=this.getDegree();i>=0;i--){let o=this.getCoefficient(i);o!==0&&(o<0?(a.append(" - "),o=-o):a.length()>0&&a.append(" + "),(i===0||o!==1)&&a.append(o),i!==0&&(i===1?a.append("x"):(a.append("x^"),a.append(i))))}return a.toString()}}class xc{add(a,i){return(a+i)%this.modulus}subtract(a,i){return(this.modulus+a-i)%this.modulus}exp(a){return this.expTable[a]}log(a){if(a===0)throw new _;return this.logTable[a]}inverse(a){if(a===0)throw new A;return this.expTable[this.modulus-this.logTable[a]-1]}multiply(a,i){return a===0||i===0?0:this.expTable[(this.logTable[a]+this.logTable[i])%(this.modulus-1)]}getSize(){return this.modulus}equals(a){return a===this}}class t0 extends xc{constructor(a,i){super(),this.modulus=a,this.expTable=new Int32Array(a),this.logTable=new Int32Array(a);let o=1;for(let l=0;l<a;l++)this.expTable[l]=o,o=o*i%a;for(let l=0;l<a-1;l++)this.logTable[this.expTable[l]]=l;this.zero=new Jr(this,new Int32Array([0])),this.one=new Jr(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(a,i){if(a<0)throw new _;if(i===0)return this.zero;let o=new Int32Array(a+1);return o[0]=i,new Jr(this,o)}}t0.PDF417_GF=new t0(yt.NUMBER_OF_CODEWORDS,3);class As{constructor(){this.field=t0.PDF417_GF}decode(a,i,o){let l=new Jr(this.field,a),f=new Int32Array(i),u=!1;for(let Q=i;Q>0;Q--){let re=l.evaluateAt(this.field.exp(Q));f[i-Q]=re,re!==0&&(u=!0)}if(!u)return 0;let x=this.field.getOne();if(o!=null)for(const Q of o){let re=this.field.exp(a.length-1-Q),ue=new Jr(this.field,new Int32Array([this.field.subtract(0,re),1]));x=x.multiply(ue)}let p=new Jr(this.field,f),y=this.runEuclideanAlgorithm(this.field.buildMonomial(i,1),p,i),b=y[0],I=y[1],R=this.findErrorLocations(b),G=this.findErrorMagnitudes(I,b,R);for(let Q=0;Q<R.length;Q++){let re=a.length-1-this.field.log(R[Q]);if(re<0)throw T.getChecksumInstance();a[re]=this.field.subtract(a[re],G[Q])}return R.length}runEuclideanAlgorithm(a,i,o){if(a.getDegree()<i.getDegree()){let R=a;a=i,i=R}let l=a,f=i,u=this.field.getZero(),x=this.field.getOne();for(;f.getDegree()>=Math.round(o/2);){let R=l,G=u;if(l=f,u=x,l.isZero())throw T.getChecksumInstance();f=R;let Q=this.field.getZero(),re=l.getCoefficient(l.getDegree()),ue=this.field.inverse(re);for(;f.getDegree()>=l.getDegree()&&!f.isZero();){let Ae=f.getDegree()-l.getDegree(),Ke=this.field.multiply(f.getCoefficient(f.getDegree()),ue);Q=Q.add(this.field.buildMonomial(Ae,Ke)),f=f.subtract(l.multiplyByMonomial(Ae,Ke))}x=Q.multiply(u).subtract(G).negative()}let p=x.getCoefficient(0);if(p===0)throw T.getChecksumInstance();let y=this.field.inverse(p),b=x.multiply(y),I=f.multiply(y);return[b,I]}findErrorLocations(a){let i=a.getDegree(),o=new Int32Array(i),l=0;for(let f=1;f<this.field.getSize()&&l<i;f++)a.evaluateAt(f)===0&&(o[l]=this.field.inverse(f),l++);if(l!==i)throw T.getChecksumInstance();return o}findErrorMagnitudes(a,i,o){let l=i.getDegree(),f=new Int32Array(l);for(let y=1;y<=l;y++)f[l-y]=this.field.multiply(y,i.getCoefficient(y));let u=new Jr(this.field,f),x=o.length,p=new Int32Array(x);for(let y=0;y<x;y++){let b=this.field.inverse(o[y]),I=this.field.subtract(0,a.evaluateAt(b)),R=this.field.inverse(u.evaluateAt(b));p[y]=this.field.multiply(I,R)}return p}}class Un{constructor(a,i,o,l,f){a instanceof Un?this.constructor_2(a):this.constructor_1(a,i,o,l,f)}constructor_1(a,i,o,l,f){const u=i==null||o==null,x=l==null||f==null;if(u&&x)throw new ae;u?(i=new st(0,l.getY()),o=new st(0,f.getY())):x&&(l=new st(a.getWidth()-1,i.getY()),f=new st(a.getWidth()-1,o.getY())),this.image=a,this.topLeft=i,this.bottomLeft=o,this.topRight=l,this.bottomRight=f,this.minX=Math.trunc(Math.min(i.getX(),o.getX())),this.maxX=Math.trunc(Math.max(l.getX(),f.getX())),this.minY=Math.trunc(Math.min(i.getY(),l.getY())),this.maxY=Math.trunc(Math.max(o.getY(),f.getY()))}constructor_2(a){this.image=a.image,this.topLeft=a.getTopLeft(),this.bottomLeft=a.getBottomLeft(),this.topRight=a.getTopRight(),this.bottomRight=a.getBottomRight(),this.minX=a.getMinX(),this.maxX=a.getMaxX(),this.minY=a.getMinY(),this.maxY=a.getMaxY()}static merge(a,i){return a==null?i:i==null?a:new Un(a.image,a.topLeft,a.bottomLeft,i.topRight,i.bottomRight)}addMissingRows(a,i,o){let l=this.topLeft,f=this.bottomLeft,u=this.topRight,x=this.bottomRight;if(a>0){let p=o?this.topLeft:this.topRight,y=Math.trunc(p.getY()-a);y<0&&(y=0);let b=new st(p.getX(),y);o?l=b:u=b}if(i>0){let p=o?this.bottomLeft:this.bottomRight,y=Math.trunc(p.getY()+i);y>=this.image.getHeight()&&(y=this.image.getHeight()-1);let b=new st(p.getX(),y);o?f=b:x=b}return new Un(this.image,l,f,u,x)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Ei{constructor(a,i,o,l){this.columnCount=a,this.errorCorrectionLevel=l,this.rowCountUpperPart=i,this.rowCountLowerPart=o,this.rowCount=i+o}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class _i{constructor(){this.buffer=""}static form(a,i){let o=-1;function l(u,x,p,y,b,I){if(u==="%%")return"%";if(i[++o]===void 0)return;u=y?parseInt(y.substr(1)):void 0;let R=b?parseInt(b.substr(1)):void 0,G;switch(I){case"s":G=i[o];break;case"c":G=i[o][0];break;case"f":G=parseFloat(i[o]).toFixed(u);break;case"p":G=parseFloat(i[o]).toPrecision(u);break;case"e":G=parseFloat(i[o]).toExponential(u);break;case"x":G=parseInt(i[o]).toString(R||16);break;case"d":G=parseFloat(parseInt(i[o],R||10).toPrecision(u)).toFixed(0);break}G=typeof G=="object"?JSON.stringify(G):(+G).toString(R);let Q=parseInt(p),re=p&&p[0]+""=="0"?"0":" ";for(;G.length<Q;)G=x!==void 0?G+re:re+G;return G}let f=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return a.replace(f,l)}format(a,...i){this.buffer+=_i.form(a,i)}toString(){return this.buffer}}class zi{constructor(a){this.boundingBox=new Un(a),this.codewords=new Array(a.getMaxY()-a.getMinY()+1)}getCodewordNearby(a){let i=this.getCodeword(a);if(i!=null)return i;for(let o=1;o<zi.MAX_NEARBY_DISTANCE;o++){let l=this.imageRowToCodewordIndex(a)-o;if(l>=0&&(i=this.codewords[l],i!=null)||(l=this.imageRowToCodewordIndex(a)+o,l<this.codewords.length&&(i=this.codewords[l],i!=null)))return i}return null}imageRowToCodewordIndex(a){return a-this.boundingBox.getMinY()}setCodeword(a,i){this.codewords[this.imageRowToCodewordIndex(a)]=i}getCodeword(a){return this.codewords[this.imageRowToCodewordIndex(a)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const a=new _i;let i=0;for(const o of this.codewords){if(o==null){a.format("%3d:    |   %n",i++);continue}a.format("%3d: %3d|%3d%n",i++,o.getRowNumber(),o.getValue())}return a.toString()}}zi.MAX_NEARBY_DISTANCE=5;class ti{constructor(){this.values=new Map}setValue(a){a=Math.trunc(a);let i=this.values.get(a);i==null&&(i=0),i++,this.values.set(a,i)}getValue(){let a=-1,i=new Array;for(const[o,l]of this.values.entries()){const f={getKey:()=>o,getValue:()=>l};f.getValue()>a?(a=f.getValue(),i=[],i.push(f.getKey())):f.getValue()===a&&i.push(f.getKey())}return yt.toIntArray(i)}getConfidence(a){return this.values.get(a)}}class bs extends zi{constructor(a,i){super(a),this._isLeft=i}setRowNumbers(){for(let a of this.getCodewords())a!=null&&a.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(a){let i=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(i,a);let o=this.getBoundingBox(),l=this._isLeft?o.getTopLeft():o.getTopRight(),f=this._isLeft?o.getBottomLeft():o.getBottomRight(),u=this.imageRowToCodewordIndex(Math.trunc(l.getY())),x=this.imageRowToCodewordIndex(Math.trunc(f.getY())),p=-1,y=1,b=0;for(let I=u;I<x;I++){if(i[I]==null)continue;let R=i[I],G=R.getRowNumber()-p;if(G===0)b++;else if(G===1)y=Math.max(y,b),b=1,p=R.getRowNumber();else if(G<0||R.getRowNumber()>=a.getRowCount()||G>I)i[I]=null;else{let Q;y>2?Q=(y-2)*G:Q=G;let re=Q>=I;for(let ue=1;ue<=Q&&!re;ue++)re=i[I-ue]!=null;re?i[I]=null:(p=R.getRowNumber(),b=1)}}}getRowHeights(){let a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);let i=new Int32Array(a.getRowCount());for(let o of this.getCodewords())if(o!=null){let l=o.getRowNumber();if(l>=i.length)continue;i[l]++}return i}adjustIncompleteIndicatorColumnRowNumbers(a){let i=this.getBoundingBox(),o=this._isLeft?i.getTopLeft():i.getTopRight(),l=this._isLeft?i.getBottomLeft():i.getBottomRight(),f=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=this.imageRowToCodewordIndex(Math.trunc(l.getY())),x=this.getCodewords(),p=-1;for(let y=f;y<u;y++){if(x[y]==null)continue;let b=x[y];b.setRowNumberAsRowIndicatorColumn();let I=b.getRowNumber()-p;I===0||(I===1?p=b.getRowNumber():b.getRowNumber()>=a.getRowCount()?x[y]=null:p=b.getRowNumber())}}getBarcodeMetadata(){let a=this.getCodewords(),i=new ti,o=new ti,l=new ti,f=new ti;for(let x of a){if(x==null)continue;x.setRowNumberAsRowIndicatorColumn();let p=x.getValue()%30,y=x.getRowNumber();switch(this._isLeft||(y+=2),y%3){case 0:o.setValue(p*3+1);break;case 1:f.setValue(p/3),l.setValue(p%3);break;case 2:i.setValue(p+1);break}}if(i.getValue().length===0||o.getValue().length===0||l.getValue().length===0||f.getValue().length===0||i.getValue()[0]<1||o.getValue()[0]+l.getValue()[0]<yt.MIN_ROWS_IN_BARCODE||o.getValue()[0]+l.getValue()[0]>yt.MAX_ROWS_IN_BARCODE)return null;let u=new Ei(i.getValue()[0],o.getValue()[0],l.getValue()[0],f.getValue()[0]);return this.removeIncorrectCodewords(a,u),u}removeIncorrectCodewords(a,i){for(let o=0;o<a.length;o++){let l=a[o];if(a[o]==null)continue;let f=l.getValue()%30,u=l.getRowNumber();if(u>i.getRowCount()){a[o]=null;continue}switch(this._isLeft||(u+=2),u%3){case 0:f*3+1!==i.getRowCountUpperPart()&&(a[o]=null);break;case 1:(Math.trunc(f/3)!==i.getErrorCorrectionLevel()||f%3!==i.getRowCountLowerPart())&&(a[o]=null);break;case 2:f+1!==i.getColumnCount()&&(a[o]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Ai{constructor(a,i){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=a,this.barcodeColumnCount=a.getColumnCount(),this.boundingBox=i,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let a=yt.MAX_CODEWORDS_IN_BARCODE,i;do i=a,a=this.adjustRowNumbersAndGetCount();while(a>0&&a<i);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(a){a!=null&&a.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let a=this.adjustRowNumbersByRow();if(a===0)return 0;for(let i=1;i<this.barcodeColumnCount+1;i++){let o=this.detectionResultColumns[i].getCodewords();for(let l=0;l<o.length;l++)o[l]!=null&&(o[l].hasValidRowNumber()||this.adjustRowNumbers(i,l,o))}return a}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let a=this.detectionResultColumns[0].getCodewords(),i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<a.length;o++)if(a[o]!=null&&i[o]!=null&&a[o].getRowNumber()===i[o].getRowNumber())for(let l=1;l<=this.barcodeColumnCount;l++){let f=this.detectionResultColumns[l].getCodewords()[o];f!=null&&(f.setRowNumber(a[o].getRowNumber()),f.hasValidRowNumber()||(this.detectionResultColumns[l].getCodewords()[o]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let a=0,i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<i.length;o++){if(i[o]==null)continue;let l=i[o].getRowNumber(),f=0;for(let u=this.barcodeColumnCount+1;u>0&&f<this.ADJUST_ROW_NUMBER_SKIP;u--){let x=this.detectionResultColumns[u].getCodewords()[o];x!=null&&(f=Ai.adjustRowNumberIfValid(l,f,x),x.hasValidRowNumber()||a++)}}return a}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let a=0,i=this.detectionResultColumns[0].getCodewords();for(let o=0;o<i.length;o++){if(i[o]==null)continue;let l=i[o].getRowNumber(),f=0;for(let u=1;u<this.barcodeColumnCount+1&&f<this.ADJUST_ROW_NUMBER_SKIP;u++){let x=this.detectionResultColumns[u].getCodewords()[o];x!=null&&(f=Ai.adjustRowNumberIfValid(l,f,x),x.hasValidRowNumber()||a++)}}return a}static adjustRowNumberIfValid(a,i,o){return o==null||o.hasValidRowNumber()||(o.isValidRowNumber(a)?(o.setRowNumber(a),i=0):++i),i}adjustRowNumbers(a,i,o){if(!this.detectionResultColumns[a-1])return;let l=o[i],f=this.detectionResultColumns[a-1].getCodewords(),u=f;this.detectionResultColumns[a+1]!=null&&(u=this.detectionResultColumns[a+1].getCodewords());let x=new Array(14);x[2]=f[i],x[3]=u[i],i>0&&(x[0]=o[i-1],x[4]=f[i-1],x[5]=u[i-1]),i>1&&(x[8]=o[i-2],x[10]=f[i-2],x[11]=u[i-2]),i<o.length-1&&(x[1]=o[i+1],x[6]=f[i+1],x[7]=u[i+1]),i<o.length-2&&(x[9]=o[i+2],x[12]=f[i+2],x[13]=u[i+2]);for(let p of x)if(Ai.adjustRowNumber(l,p))return}static adjustRowNumber(a,i){return i==null?!1:i.hasValidRowNumber()&&i.getBucket()===a.getBucket()?(a.setRowNumber(i.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(a){this.boundingBox=a}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(a,i){this.detectionResultColumns[a]=i}getDetectionResultColumn(a){return this.detectionResultColumns[a]}toString(){let a=this.detectionResultColumns[0];a==null&&(a=this.detectionResultColumns[this.barcodeColumnCount+1]);let i=new _i;for(let o=0;o<a.getCodewords().length;o++){i.format("CW %3d:",o);for(let l=0;l<this.barcodeColumnCount+2;l++){if(this.detectionResultColumns[l]==null){i.format("    |   ");continue}let f=this.detectionResultColumns[l].getCodewords()[o];if(f==null){i.format("    |   ");continue}i.format(" %3d|%3d",f.getRowNumber(),f.getValue())}i.format("%n")}return i.toString()}}class Yi{constructor(a,i,o,l){this.rowNumber=Yi.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(a),this.endX=Math.trunc(i),this.bucket=Math.trunc(o),this.value=Math.trunc(l)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(a){return a!==Yi.BARCODE_ROW_UNKNOWN&&this.bucket===a%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(a){this.rowNumber=a}toString(){return this.rowNumber+"|"+this.value}}Yi.BARCODE_ROW_UNKNOWN=-1;class Ea{static initialize(){for(let a=0;a<yt.SYMBOL_TABLE.length;a++){let i=yt.SYMBOL_TABLE[a],o=i&1;for(let l=0;l<yt.BARS_IN_MODULE;l++){let f=0;for(;(i&1)===o;)f+=1,i>>=1;o=i&1,Ea.RATIOS_TABLE[a]||(Ea.RATIOS_TABLE[a]=new Array(yt.BARS_IN_MODULE)),Ea.RATIOS_TABLE[a][yt.BARS_IN_MODULE-l-1]=Math.fround(f/yt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(a){let i=Ea.getDecodedCodewordValue(Ea.sampleBitCounts(a));return i!==-1?i:Ea.getClosestDecodedValue(a)}static sampleBitCounts(a){let i=Et.sum(a),o=new Int32Array(yt.BARS_IN_MODULE),l=0,f=0;for(let u=0;u<yt.MODULES_IN_CODEWORD;u++){let x=i/(2*yt.MODULES_IN_CODEWORD)+u*i/yt.MODULES_IN_CODEWORD;f+a[l]<=x&&(f+=a[l],l++),o[l]++}return o}static getDecodedCodewordValue(a){let i=Ea.getBitValue(a);return yt.getCodeword(i)===-1?-1:i}static getBitValue(a){let i=0;for(let o=0;o<a.length;o++)for(let l=0;l<a[o];l++)i=i<<1|(o%2===0?1:0);return Math.trunc(i)}static getClosestDecodedValue(a){let i=Et.sum(a),o=new Array(yt.BARS_IN_MODULE);if(i>1)for(let u=0;u<o.length;u++)o[u]=Math.fround(a[u]/i);let l=Kr.MAX_VALUE,f=-1;this.bSymbolTableReady||Ea.initialize();for(let u=0;u<Ea.RATIOS_TABLE.length;u++){let x=0,p=Ea.RATIOS_TABLE[u];for(let y=0;y<yt.BARS_IN_MODULE;y++){let b=Math.fround(p[y]-o[y]);if(x+=Math.fround(b*b),x>=l)break}x<l&&(l=x,f=yt.SYMBOL_TABLE[u])}return f}}Ea.bSymbolTableReady=!1,Ea.RATIOS_TABLE=new Array(yt.SYMBOL_TABLE.length).map(k=>new Array(yt.BARS_IN_MODULE));class q0{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(a){this.segmentIndex=a}getFileId(){return this.fileId}setFileId(a){this.fileId=a}getOptionalData(){return this.optionalData}setOptionalData(a){this.optionalData=a}isLastSegment(){return this.lastSegment}setLastSegment(a){this.lastSegment=a}getSegmentCount(){return this.segmentCount}setSegmentCount(a){this.segmentCount=a}getSender(){return this.sender||null}setSender(a){this.sender=a}getAddressee(){return this.addressee||null}setAddressee(a){this.addressee=a}getFileName(){return this.fileName}setFileName(a){this.fileName=a}getFileSize(){return this.fileSize}setFileSize(a){this.fileSize=a}getChecksum(){return this.checksum}setChecksum(a){this.checksum=a}getTimestamp(){return this.timestamp}setTimestamp(a){this.timestamp=a}}class Z0{static parseLong(a,i=void 0){return parseInt(a,i)}}class ri extends g{}ri.kind="NullPointerException";class J0{writeBytes(a){this.writeBytesOffset(a,0,a.length)}writeBytesOffset(a,i,o){if(a==null)throw new ri;if(i<0||i>a.length||o<0||i+o>a.length||i+o<0)throw new D;if(o===0)return;for(let l=0;l<o;l++)this.write(a[i+l])}flush(){}close(){}}class gc extends g{}class Q0 extends J0{constructor(a=32){if(super(),this.count=0,a<0)throw new _("Negative initial size: "+a);this.buf=new Uint8Array(a)}ensureCapacity(a){a-this.buf.length>0&&this.grow(a)}grow(a){let o=this.buf.length<<1;if(o-a<0&&(o=a),o<0){if(a<0)throw new gc;o=O.MAX_VALUE}this.buf=X.copyOfUint8Array(this.buf,o)}write(a){this.ensureCapacity(this.count+1),this.buf[this.count]=a,this.count+=1}writeBytesOffset(a,i,o){if(i<0||i>a.length||o<0||i+o-a.length>0)throw new D;this.ensureCapacity(this.count+o),S.arraycopy(a,i,this.buf,this.count,o),this.count+=o}writeTo(a){a.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return X.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(a){return a?typeof a=="string"?this.toString_string(a):this.toString_number(a):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(a){return new String(this.buf).toString()}toString_number(a){return new String(this.buf).toString()}close(){}}var nr;(function(k){k[k.ALPHA=0]="ALPHA",k[k.LOWER=1]="LOWER",k[k.MIXED=2]="MIXED",k[k.PUNCT=3]="PUNCT",k[k.ALPHA_SHIFT=4]="ALPHA_SHIFT",k[k.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(nr||(nr={}));function r0(){if(typeof window<"u")return window.BigInt||null;if(typeof o0<"u")return o0.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Ki;function Wn(k){if(typeof Ki>"u"&&(Ki=r0()),Ki===null)throw new Error("BigInt is not supported!");return Ki(k)}function a0(){let k=[];k[0]=Wn(1);let a=Wn(900);k[1]=a;for(let i=2;i<16;i++)k[i]=k[i-1]*a;return k}class _e{static decode(a,i){let o=new be(""),l=j.ISO8859_1;o.enableDecoding(l);let f=1,u=a[f++],x=new q0;for(;f<a[0];){switch(u){case _e.TEXT_COMPACTION_MODE_LATCH:f=_e.textCompaction(a,f,o);break;case _e.BYTE_COMPACTION_MODE_LATCH:case _e.BYTE_COMPACTION_MODE_LATCH_6:f=_e.byteCompaction(u,a,l,f,o);break;case _e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(a[f++]);break;case _e.NUMERIC_COMPACTION_MODE_LATCH:f=_e.numericCompaction(a,f,o);break;case _e.ECI_CHARSET:j.getCharacterSetECIByValue(a[f++]);break;case _e.ECI_GENERAL_PURPOSE:f+=2;break;case _e.ECI_USER_DEFINED:f++;break;case _e.BEGIN_MACRO_PDF417_CONTROL_BLOCK:f=_e.decodeMacroBlock(a,f,x);break;case _e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case _e.MACRO_PDF417_TERMINATOR:throw new M;default:f--,f=_e.textCompaction(a,f,o);break}if(f<a.length)u=a[f++];else throw M.getFormatInstance()}if(o.length()===0)throw M.getFormatInstance();let p=new Pe(null,o.toString(),null,i);return p.setOther(x),p}static decodeMacroBlock(a,i,o){if(i+_e.NUMBER_OF_SEQUENCE_CODEWORDS>a[0])throw M.getFormatInstance();let l=new Int32Array(_e.NUMBER_OF_SEQUENCE_CODEWORDS);for(let x=0;x<_e.NUMBER_OF_SEQUENCE_CODEWORDS;x++,i++)l[x]=a[i];o.setSegmentIndex(O.parseInt(_e.decodeBase900toBase10(l,_e.NUMBER_OF_SEQUENCE_CODEWORDS)));let f=new be;i=_e.textCompaction(a,i,f),o.setFileId(f.toString());let u=-1;for(a[i]===_e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(u=i+1);i<a[0];)switch(a[i]){case _e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(i++,a[i]){case _e.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let x=new be;i=_e.textCompaction(a,i+1,x),o.setFileName(x.toString());break;case _e.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let p=new be;i=_e.textCompaction(a,i+1,p),o.setSender(p.toString());break;case _e.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let y=new be;i=_e.textCompaction(a,i+1,y),o.setAddressee(y.toString());break;case _e.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let b=new be;i=_e.numericCompaction(a,i+1,b),o.setSegmentCount(O.parseInt(b.toString()));break;case _e.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let I=new be;i=_e.numericCompaction(a,i+1,I),o.setTimestamp(Z0.parseLong(I.toString()));break;case _e.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let R=new be;i=_e.numericCompaction(a,i+1,R),o.setChecksum(O.parseInt(R.toString()));break;case _e.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let G=new be;i=_e.numericCompaction(a,i+1,G),o.setFileSize(Z0.parseLong(G.toString()));break;default:throw M.getFormatInstance()}break;case _e.MACRO_PDF417_TERMINATOR:i++,o.setLastSegment(!0);break;default:throw M.getFormatInstance()}if(u!==-1){let x=i-u;o.isLastSegment()&&x--,o.setOptionalData(X.copyOfRange(a,u,u+x))}return i}static textCompaction(a,i,o){let l=new Int32Array((a[0]-i)*2),f=new Int32Array((a[0]-i)*2),u=0,x=!1;for(;i<a[0]&&!x;){let p=a[i++];if(p<_e.TEXT_COMPACTION_MODE_LATCH)l[u]=p/30,l[u+1]=p%30,u+=2;else switch(p){case _e.TEXT_COMPACTION_MODE_LATCH:l[u++]=_e.TEXT_COMPACTION_MODE_LATCH;break;case _e.BYTE_COMPACTION_MODE_LATCH:case _e.BYTE_COMPACTION_MODE_LATCH_6:case _e.NUMERIC_COMPACTION_MODE_LATCH:case _e.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case _e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case _e.MACRO_PDF417_TERMINATOR:i--,x=!0;break;case _e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l[u]=_e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,p=a[i++],f[u]=p,u++;break}}return _e.decodeTextCompaction(l,f,u,o),i}static decodeTextCompaction(a,i,o,l){let f=nr.ALPHA,u=nr.ALPHA,x=0;for(;x<o;){let p=a[x],y="";switch(f){case nr.ALPHA:if(p<26)y=String.fromCharCode(65+p);else switch(p){case 26:y=" ";break;case _e.LL:f=nr.LOWER;break;case _e.ML:f=nr.MIXED;break;case _e.PS:u=f,f=nr.PUNCT_SHIFT;break;case _e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(i[x]);break;case _e.TEXT_COMPACTION_MODE_LATCH:f=nr.ALPHA;break}break;case nr.LOWER:if(p<26)y=String.fromCharCode(97+p);else switch(p){case 26:y=" ";break;case _e.AS:u=f,f=nr.ALPHA_SHIFT;break;case _e.ML:f=nr.MIXED;break;case _e.PS:u=f,f=nr.PUNCT_SHIFT;break;case _e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(i[x]);break;case _e.TEXT_COMPACTION_MODE_LATCH:f=nr.ALPHA;break}break;case nr.MIXED:if(p<_e.PL)y=_e.MIXED_CHARS[p];else switch(p){case _e.PL:f=nr.PUNCT;break;case 26:y=" ";break;case _e.LL:f=nr.LOWER;break;case _e.AL:f=nr.ALPHA;break;case _e.PS:u=f,f=nr.PUNCT_SHIFT;break;case _e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(i[x]);break;case _e.TEXT_COMPACTION_MODE_LATCH:f=nr.ALPHA;break}break;case nr.PUNCT:if(p<_e.PAL)y=_e.PUNCT_CHARS[p];else switch(p){case _e.PAL:f=nr.ALPHA;break;case _e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(i[x]);break;case _e.TEXT_COMPACTION_MODE_LATCH:f=nr.ALPHA;break}break;case nr.ALPHA_SHIFT:if(f=u,p<26)y=String.fromCharCode(65+p);else switch(p){case 26:y=" ";break;case _e.TEXT_COMPACTION_MODE_LATCH:f=nr.ALPHA;break}break;case nr.PUNCT_SHIFT:if(f=u,p<_e.PAL)y=_e.PUNCT_CHARS[p];else switch(p){case _e.PAL:f=nr.ALPHA;break;case _e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(i[x]);break;case _e.TEXT_COMPACTION_MODE_LATCH:f=nr.ALPHA;break}break}y!==""&&l.append(y),x++}}static byteCompaction(a,i,o,l,f){let u=new Q0,x=0,p=0,y=!1;switch(a){case _e.BYTE_COMPACTION_MODE_LATCH:let b=new Int32Array(6),I=i[l++];for(;l<i[0]&&!y;)switch(b[x++]=I,p=900*p+I,I=i[l++],I){case _e.TEXT_COMPACTION_MODE_LATCH:case _e.BYTE_COMPACTION_MODE_LATCH:case _e.NUMERIC_COMPACTION_MODE_LATCH:case _e.BYTE_COMPACTION_MODE_LATCH_6:case _e.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case _e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case _e.MACRO_PDF417_TERMINATOR:l--,y=!0;break;default:if(x%5===0&&x>0){for(let R=0;R<6;++R)u.write(Number(Wn(p)>>Wn(8*(5-R))));p=0,x=0}break}l===i[0]&&I<_e.TEXT_COMPACTION_MODE_LATCH&&(b[x++]=I);for(let R=0;R<x;R++)u.write(b[R]);break;case _e.BYTE_COMPACTION_MODE_LATCH_6:for(;l<i[0]&&!y;){let R=i[l++];if(R<_e.TEXT_COMPACTION_MODE_LATCH)x++,p=900*p+R;else switch(R){case _e.TEXT_COMPACTION_MODE_LATCH:case _e.BYTE_COMPACTION_MODE_LATCH:case _e.NUMERIC_COMPACTION_MODE_LATCH:case _e.BYTE_COMPACTION_MODE_LATCH_6:case _e.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case _e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case _e.MACRO_PDF417_TERMINATOR:l--,y=!0;break}if(x%5===0&&x>0){for(let G=0;G<6;++G)u.write(Number(Wn(p)>>Wn(8*(5-G))));p=0,x=0}}break}return f.append(he.decode(u.toByteArray(),o)),l}static numericCompaction(a,i,o){let l=0,f=!1,u=new Int32Array(_e.MAX_NUMERIC_CODEWORDS);for(;i<a[0]&&!f;){let x=a[i++];if(i===a[0]&&(f=!0),x<_e.TEXT_COMPACTION_MODE_LATCH)u[l]=x,l++;else switch(x){case _e.TEXT_COMPACTION_MODE_LATCH:case _e.BYTE_COMPACTION_MODE_LATCH:case _e.BYTE_COMPACTION_MODE_LATCH_6:case _e.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case _e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case _e.MACRO_PDF417_TERMINATOR:i--,f=!0;break}(l%_e.MAX_NUMERIC_CODEWORDS===0||x===_e.NUMERIC_COMPACTION_MODE_LATCH||f)&&l>0&&(o.append(_e.decodeBase900toBase10(u,l)),l=0)}return i}static decodeBase900toBase10(a,i){let o=Wn(0);for(let f=0;f<i;f++)o+=_e.EXP900[i-f-1]*Wn(a[f]);let l=o.toString();if(l.charAt(0)!=="1")throw new M;return l.substring(1)}}_e.TEXT_COMPACTION_MODE_LATCH=900,_e.BYTE_COMPACTION_MODE_LATCH=901,_e.NUMERIC_COMPACTION_MODE_LATCH=902,_e.BYTE_COMPACTION_MODE_LATCH_6=924,_e.ECI_USER_DEFINED=925,_e.ECI_GENERAL_PURPOSE=926,_e.ECI_CHARSET=927,_e.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,_e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,_e.MACRO_PDF417_TERMINATOR=922,_e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,_e.MAX_NUMERIC_CODEWORDS=15,_e.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,_e.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,_e.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,_e.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,_e.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,_e.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,_e.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,_e.PL=25,_e.LL=27,_e.AS=27,_e.ML=28,_e.AL=28,_e.PS=29,_e.PAL=29,_e.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,_e.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",_e.EXP900=r0()?a0():[],_e.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Rt{constructor(){}static decode(a,i,o,l,f,u,x){let p=new Un(a,i,o,l,f),y=null,b=null,I;for(let Q=!0;;Q=!1){if(i!=null&&(y=Rt.getRowIndicatorColumn(a,p,i,!0,u,x)),l!=null&&(b=Rt.getRowIndicatorColumn(a,p,l,!1,u,x)),I=Rt.merge(y,b),I==null)throw ae.getNotFoundInstance();let re=I.getBoundingBox();if(Q&&re!=null&&(re.getMinY()<p.getMinY()||re.getMaxY()>p.getMaxY()))p=re;else break}I.setBoundingBox(p);let R=I.getBarcodeColumnCount()+1;I.setDetectionResultColumn(0,y),I.setDetectionResultColumn(R,b);let G=y!=null;for(let Q=1;Q<=R;Q++){let re=G?Q:R-Q;if(I.getDetectionResultColumn(re)!==void 0)continue;let ue;re===0||re===R?ue=new bs(p,re===0):ue=new zi(p),I.setDetectionResultColumn(re,ue);let Ae=-1,Ke=Ae;for(let Ze=p.getMinY();Ze<=p.getMaxY();Ze++){if(Ae=Rt.getStartColumn(I,re,Ze,G),Ae<0||Ae>p.getMaxX()){if(Ke===-1)continue;Ae=Ke}let Xe=Rt.detectCodeword(a,p.getMinX(),p.getMaxX(),G,Ae,Ze,u,x);Xe!=null&&(ue.setCodeword(Ze,Xe),Ke=Ae,u=Math.min(u,Xe.getWidth()),x=Math.max(x,Xe.getWidth()))}}return Rt.createDecoderResult(I)}static merge(a,i){if(a==null&&i==null)return null;let o=Rt.getBarcodeMetadata(a,i);if(o==null)return null;let l=Un.merge(Rt.adjustBoundingBox(a),Rt.adjustBoundingBox(i));return new Ai(o,l)}static adjustBoundingBox(a){if(a==null)return null;let i=a.getRowHeights();if(i==null)return null;let o=Rt.getMax(i),l=0;for(let x of i)if(l+=o-x,x>0)break;let f=a.getCodewords();for(let x=0;l>0&&f[x]==null;x++)l--;let u=0;for(let x=i.length-1;x>=0&&(u+=o-i[x],!(i[x]>0));x--);for(let x=f.length-1;u>0&&f[x]==null;x--)u--;return a.getBoundingBox().addMissingRows(l,u,a.isLeft())}static getMax(a){let i=-1;for(let o of a)i=Math.max(i,o);return i}static getBarcodeMetadata(a,i){let o;if(a==null||(o=a.getBarcodeMetadata())==null)return i==null?null:i.getBarcodeMetadata();let l;return i==null||(l=i.getBarcodeMetadata())==null?o:o.getColumnCount()!==l.getColumnCount()&&o.getErrorCorrectionLevel()!==l.getErrorCorrectionLevel()&&o.getRowCount()!==l.getRowCount()?null:o}static getRowIndicatorColumn(a,i,o,l,f,u){let x=new bs(i,l);for(let p=0;p<2;p++){let y=p===0?1:-1,b=Math.trunc(Math.trunc(o.getX()));for(let I=Math.trunc(Math.trunc(o.getY()));I<=i.getMaxY()&&I>=i.getMinY();I+=y){let R=Rt.detectCodeword(a,0,a.getWidth(),l,b,I,f,u);R!=null&&(x.setCodeword(I,R),l?b=R.getStartX():b=R.getEndX())}}return x}static adjustCodewordCount(a,i){let o=i[0][1],l=o.getValue(),f=a.getBarcodeColumnCount()*a.getBarcodeRowCount()-Rt.getNumberOfECCodeWords(a.getBarcodeECLevel());if(l.length===0){if(f<1||f>yt.MAX_CODEWORDS_IN_BARCODE)throw ae.getNotFoundInstance();o.setValue(f)}else l[0]!==f&&o.setValue(f)}static createDecoderResult(a){let i=Rt.createBarcodeMatrix(a);Rt.adjustCodewordCount(a,i);let o=new Array,l=new Int32Array(a.getBarcodeRowCount()*a.getBarcodeColumnCount()),f=[],u=new Array;for(let p=0;p<a.getBarcodeRowCount();p++)for(let y=0;y<a.getBarcodeColumnCount();y++){let b=i[p][y+1].getValue(),I=p*a.getBarcodeColumnCount()+y;b.length===0?o.push(I):b.length===1?l[I]=b[0]:(u.push(I),f.push(b))}let x=new Array(f.length);for(let p=0;p<x.length;p++)x[p]=f[p];return Rt.createDecoderResultFromAmbiguousValues(a.getBarcodeECLevel(),l,yt.toIntArray(o),yt.toIntArray(u),x)}static createDecoderResultFromAmbiguousValues(a,i,o,l,f){let u=new Int32Array(l.length),x=100;for(;x-- >0;){for(let p=0;p<u.length;p++)i[l[p]]=f[p][u[p]];try{return Rt.decodeCodewords(i,a,o)}catch(p){if(!(p instanceof T))throw p}if(u.length===0)throw T.getChecksumInstance();for(let p=0;p<u.length;p++)if(u[p]<f[p].length-1){u[p]++;break}else if(u[p]=0,p===u.length-1)throw T.getChecksumInstance()}throw T.getChecksumInstance()}static createBarcodeMatrix(a){let i=Array.from({length:a.getBarcodeRowCount()},()=>new Array(a.getBarcodeColumnCount()+2));for(let l=0;l<i.length;l++)for(let f=0;f<i[l].length;f++)i[l][f]=new ti;let o=0;for(let l of a.getDetectionResultColumns()){if(l!=null){for(let f of l.getCodewords())if(f!=null){let u=f.getRowNumber();if(u>=0){if(u>=i.length)continue;i[u][o].setValue(f.getValue())}}}o++}return i}static isValidBarcodeColumn(a,i){return i>=0&&i<=a.getBarcodeColumnCount()+1}static getStartColumn(a,i,o,l){let f=l?1:-1,u=null;if(Rt.isValidBarcodeColumn(a,i-f)&&(u=a.getDetectionResultColumn(i-f).getCodeword(o)),u!=null)return l?u.getEndX():u.getStartX();if(u=a.getDetectionResultColumn(i).getCodewordNearby(o),u!=null)return l?u.getStartX():u.getEndX();if(Rt.isValidBarcodeColumn(a,i-f)&&(u=a.getDetectionResultColumn(i-f).getCodewordNearby(o)),u!=null)return l?u.getEndX():u.getStartX();let x=0;for(;Rt.isValidBarcodeColumn(a,i-f);){i-=f;for(let p of a.getDetectionResultColumn(i).getCodewords())if(p!=null)return(l?p.getEndX():p.getStartX())+f*x*(p.getEndX()-p.getStartX());x++}return l?a.getBoundingBox().getMinX():a.getBoundingBox().getMaxX()}static detectCodeword(a,i,o,l,f,u,x,p){f=Rt.adjustCodewordStartColumn(a,i,o,l,f,u);let y=Rt.getModuleBitCount(a,i,o,l,f,u);if(y==null)return null;let b,I=Et.sum(y);if(l)b=f+I;else{for(let Q=0;Q<y.length/2;Q++){let re=y[Q];y[Q]=y[y.length-1-Q],y[y.length-1-Q]=re}b=f,f=b-I}if(!Rt.checkCodewordSkew(I,x,p))return null;let R=Ea.getDecodedValue(y),G=yt.getCodeword(R);return G===-1?null:new Yi(f,b,Rt.getCodewordBucketNumber(R),G)}static getModuleBitCount(a,i,o,l,f,u){let x=f,p=new Int32Array(8),y=0,b=l?1:-1,I=l;for(;(l?x<o:x>=i)&&y<p.length;)a.get(x,u)===I?(p[y]++,x+=b):(y++,I=!I);return y===p.length||x===(l?o:i)&&y===p.length-1?p:null}static getNumberOfECCodeWords(a){return 2<<a}static adjustCodewordStartColumn(a,i,o,l,f,u){let x=f,p=l?-1:1;for(let y=0;y<2;y++){for(;(l?x>=i:x<o)&&l===a.get(x,u);){if(Math.abs(f-x)>Rt.CODEWORD_SKEW_SIZE)return f;x+=p}p=-p,l=!l}return x}static checkCodewordSkew(a,i,o){return i-Rt.CODEWORD_SKEW_SIZE<=a&&a<=o+Rt.CODEWORD_SKEW_SIZE}static decodeCodewords(a,i,o){if(a.length===0)throw M.getFormatInstance();let l=1<<i+1,f=Rt.correctErrors(a,o,l);Rt.verifyCodewordCount(a,l);let u=_e.decode(a,""+i);return u.setErrorsCorrected(f),u.setErasures(o.length),u}static correctErrors(a,i,o){if(i!=null&&i.length>o/2+Rt.MAX_ERRORS||o<0||o>Rt.MAX_EC_CODEWORDS)throw T.getChecksumInstance();return Rt.errorCorrection.decode(a,o,i)}static verifyCodewordCount(a,i){if(a.length<4)throw M.getFormatInstance();let o=a[0];if(o>a.length)throw M.getFormatInstance();if(o===0)if(i<a.length)a[0]=a.length-i;else throw M.getFormatInstance()}static getBitCountForCodeword(a){let i=new Int32Array(8),o=0,l=i.length-1;for(;!((a&1)!==o&&(o=a&1,l--,l<0));)i[l]++,a>>=1;return i}static getCodewordBucketNumber(a){return a instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(a):this.getCodewordBucketNumber_number(a)}static getCodewordBucketNumber_number(a){return Rt.getCodewordBucketNumber(Rt.getBitCountForCodeword(a))}static getCodewordBucketNumber_Int32Array(a){return(a[0]-a[2]+a[4]-a[6]+9)%9}static toString(a){let i=new _i;for(let o=0;o<a.length;o++){i.format("Row %2d: ",o);for(let l=0;l<a[o].length;l++){let f=a[o][l];f.getValue().length===0?i.format("        ",null):i.format("%4d(%2d)",f.getValue()[0],f.getConfidence(f.getValue()[0]))}i.format("%n")}return i.toString()}}Rt.CODEWORD_SKEW_SIZE=2,Rt.MAX_ERRORS=3,Rt.MAX_EC_CODEWORDS=512,Rt.errorCorrection=new As;class Cr{decode(a,i=null){let o=Cr.decode(a,i,!1);if(o==null||o.length===0||o[0]==null)throw ae.getNotFoundInstance();return o[0]}decodeMultiple(a,i=null){try{return Cr.decode(a,i,!0)}catch(o){throw o instanceof M||o instanceof T?ae.getNotFoundInstance():o}}static decode(a,i,o){const l=new Array,f=Lt.detectMultiple(a,i,o);for(const u of f.getPoints()){const x=Rt.decode(f.getBits(),u[4],u[5],u[6],u[7],Cr.getMinCodewordWidth(u),Cr.getMaxCodewordWidth(u)),p=new ee(x.getText(),x.getRawBytes(),void 0,u,le.PDF_417);p.putMetadata(Le.ERROR_CORRECTION_LEVEL,x.getECLevel());const y=x.getOther();y!=null&&p.putMetadata(Le.PDF417_EXTRA_METADATA,y),l.push(p)}return l.map(u=>u)}static getMaxWidth(a,i){return a==null||i==null?0:Math.trunc(Math.abs(a.getX()-i.getX()))}static getMinWidth(a,i){return a==null||i==null?O.MAX_VALUE:Math.trunc(Math.abs(a.getX()-i.getX()))}static getMaxCodewordWidth(a){return Math.floor(Math.max(Math.max(Cr.getMaxWidth(a[0],a[4]),Cr.getMaxWidth(a[6],a[2])*yt.MODULES_IN_CODEWORD/yt.MODULES_IN_STOP_PATTERN),Math.max(Cr.getMaxWidth(a[1],a[5]),Cr.getMaxWidth(a[7],a[3])*yt.MODULES_IN_CODEWORD/yt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(a){return Math.floor(Math.min(Math.min(Cr.getMinWidth(a[0],a[4]),Cr.getMinWidth(a[6],a[2])*yt.MODULES_IN_CODEWORD/yt.MODULES_IN_STOP_PATTERN),Math.min(Cr.getMinWidth(a[1],a[5]),Cr.getMinWidth(a[7],a[3])*yt.MODULES_IN_CODEWORD/yt.MODULES_IN_STOP_PATTERN)))}reset(){}}class Ss extends g{}Ss.kind="ReaderException";class ai{constructor(a,i){this.verbose=a===!0,i&&this.setHints(i)}decode(a,i){return i&&this.setHints(i),this.decodeInternal(a)}decodeWithState(a){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(a)}setHints(a){this.hints=a;const i=!n(a)&&a.get(J.TRY_HARDER)===!0,o=n(a)?null:a.get(J.POSSIBLE_FORMATS),l=new Array;if(!n(o)){const f=o.some(u=>u===le.UPC_A||u===le.UPC_E||u===le.EAN_13||u===le.EAN_8||u===le.CODABAR||u===le.CODE_39||u===le.CODE_93||u===le.CODE_128||u===le.ITF||u===le.RSS_14||u===le.RSS_EXPANDED);f&&!i&&l.push(new ga(a,this.verbose)),o.includes(le.QR_CODE)&&l.push(new vr),o.includes(le.DATA_MATRIX)&&l.push(new hn),o.includes(le.AZTEC)&&l.push(new cr),o.includes(le.PDF_417)&&l.push(new Cr),f&&i&&l.push(new ga(a,this.verbose))}l.length===0&&(i||l.push(new ga(a,this.verbose)),l.push(new vr),l.push(new hn),l.push(new cr),l.push(new Cr),i&&l.push(new ga(a,this.verbose))),this.readers=l}reset(){if(this.readers!==null)for(const a of this.readers)a.reset()}decodeInternal(a){if(this.readers===null)throw new Ss("No readers where selected, nothing can be read.");for(const i of this.readers)try{return i.decode(a,this.hints)}catch(o){if(o instanceof Ss)continue}throw new ae("No MultiFormat Readers were able to detect the code.")}}class mc extends ce{constructor(a=null,i=500){const o=new ai;o.setHints(a),super(o,i)}decodeBitmap(a){return this.reader.decodeWithState(a)}}class Cs extends ce{constructor(a=500){super(new Cr,a)}}class ni extends ce{constructor(a=500){super(new vr,a)}}var qi;(function(k){k[k.ERROR_CORRECTION=0]="ERROR_CORRECTION",k[k.CHARACTER_SET=1]="CHARACTER_SET",k[k.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",k[k.MIN_SIZE=3]="MIN_SIZE",k[k.MAX_SIZE=4]="MAX_SIZE",k[k.MARGIN=5]="MARGIN",k[k.PDF417_COMPACT=6]="PDF417_COMPACT",k[k.PDF417_COMPACTION=7]="PDF417_COMPACTION",k[k.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",k[k.AZTEC_LAYERS=9]="AZTEC_LAYERS",k[k.QR_VERSION=10]="QR_VERSION"})(qi||(qi={}));var Vr=qi;class Zi{constructor(a){this.field=a,this.cachedGenerators=[],this.cachedGenerators.push(new Te(a,Int32Array.from([1])))}buildGenerator(a){const i=this.cachedGenerators;if(a>=i.length){let o=i[i.length-1];const l=this.field;for(let f=i.length;f<=a;f++){const u=o.multiply(new Te(l,Int32Array.from([1,l.exp(f-1+l.getGeneratorBase())])));i.push(u),o=u}}return i[a]}encode(a,i){if(i===0)throw new _("No error correction bytes");const o=a.length-i;if(o<=0)throw new _("No data bytes provided");const l=this.buildGenerator(i),f=new Int32Array(o);S.arraycopy(a,0,f,0,o);let u=new Te(this.field,f);u=u.multiplyByMonomial(i,1);const p=u.divide(l)[1].getCoefficients(),y=i-p.length;for(let b=0;b<y;b++)a[o+b]=0;S.arraycopy(p,0,a,o+y,p.length)}}class _r{constructor(){}static applyMaskPenaltyRule1(a){return _r.applyMaskPenaltyRule1Internal(a,!0)+_r.applyMaskPenaltyRule1Internal(a,!1)}static applyMaskPenaltyRule2(a){let i=0;const o=a.getArray(),l=a.getWidth(),f=a.getHeight();for(let u=0;u<f-1;u++){const x=o[u];for(let p=0;p<l-1;p++){const y=x[p];y===x[p+1]&&y===o[u+1][p]&&y===o[u+1][p+1]&&i++}}return _r.N2*i}static applyMaskPenaltyRule3(a){let i=0;const o=a.getArray(),l=a.getWidth(),f=a.getHeight();for(let u=0;u<f;u++)for(let x=0;x<l;x++){const p=o[u];x+6<l&&p[x]===1&&p[x+1]===0&&p[x+2]===1&&p[x+3]===1&&p[x+4]===1&&p[x+5]===0&&p[x+6]===1&&(_r.isWhiteHorizontal(p,x-4,x)||_r.isWhiteHorizontal(p,x+7,x+11))&&i++,u+6<f&&o[u][x]===1&&o[u+1][x]===0&&o[u+2][x]===1&&o[u+3][x]===1&&o[u+4][x]===1&&o[u+5][x]===0&&o[u+6][x]===1&&(_r.isWhiteVertical(o,x,u-4,u)||_r.isWhiteVertical(o,x,u+7,u+11))&&i++}return i*_r.N3}static isWhiteHorizontal(a,i,o){i=Math.max(i,0),o=Math.min(o,a.length);for(let l=i;l<o;l++)if(a[l]===1)return!1;return!0}static isWhiteVertical(a,i,o,l){o=Math.max(o,0),l=Math.min(l,a.length);for(let f=o;f<l;f++)if(a[f][i]===1)return!1;return!0}static applyMaskPenaltyRule4(a){let i=0;const o=a.getArray(),l=a.getWidth(),f=a.getHeight();for(let p=0;p<f;p++){const y=o[p];for(let b=0;b<l;b++)y[b]===1&&i++}const u=a.getHeight()*a.getWidth();return Math.floor(Math.abs(i*2-u)*10/u)*_r.N4}static getDataMaskBit(a,i,o){let l,f;switch(a){case 0:l=o+i&1;break;case 1:l=o&1;break;case 2:l=i%3;break;case 3:l=(o+i)%3;break;case 4:l=Math.floor(o/2)+Math.floor(i/3)&1;break;case 5:f=o*i,l=(f&1)+f%3;break;case 6:f=o*i,l=(f&1)+f%3&1;break;case 7:f=o*i,l=f%3+(o+i&1)&1;break;default:throw new _("Invalid mask pattern: "+a)}return l===0}static applyMaskPenaltyRule1Internal(a,i){let o=0;const l=i?a.getHeight():a.getWidth(),f=i?a.getWidth():a.getHeight(),u=a.getArray();for(let x=0;x<l;x++){let p=0,y=-1;for(let b=0;b<f;b++){const I=i?u[x][b]:u[b][x];I===y?p++:(p>=5&&(o+=_r.N1+(p-5)),p=1,y=I)}p>=5&&(o+=_r.N1+(p-5))}return o}}_r.N1=3,_r.N2=3,_r.N3=40,_r.N4=10;class Ts{constructor(a,i){this.width=a,this.height=i;const o=new Array(i);for(let l=0;l!==i;l++)o[l]=new Uint8Array(a);this.bytes=o}getHeight(){return this.height}getWidth(){return this.width}get(a,i){return this.bytes[i][a]}getArray(){return this.bytes}setNumber(a,i,o){this.bytes[i][a]=o}setBoolean(a,i,o){this.bytes[i][a]=o?1:0}clear(a){for(const i of this.bytes)X.fill(i,a)}equals(a){if(!(a instanceof Ts))return!1;const i=a;if(this.width!==i.width||this.height!==i.height)return!1;for(let o=0,l=this.height;o<l;++o){const f=this.bytes[o],u=i.bytes[o];for(let x=0,p=this.width;x<p;++x)if(f[x]!==u[x])return!1}return!0}toString(){const a=new be;for(let i=0,o=this.height;i<o;++i){const l=this.bytes[i];for(let f=0,u=this.width;f<u;++f)switch(l[f]){case 0:a.append(" 0");break;case 1:a.append(" 1");break;default:a.append("  ");break}a.append(`
`)}return a.toString()}}class Sn{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const a=new be;return a.append(`<<
`),a.append(" mode: "),a.append(this.mode?this.mode.toString():"null"),a.append(`
 ecLevel: `),a.append(this.ecLevel?this.ecLevel.toString():"null"),a.append(`
 version: `),a.append(this.version?this.version.toString():"null"),a.append(`
 maskPattern: `),a.append(this.maskPattern.toString()),this.matrix?(a.append(`
 matrix:
`),a.append(this.matrix.toString())):a.append(`
 matrix: null
`),a.append(`>>
`),a.toString()}setMode(a){this.mode=a}setECLevel(a){this.ecLevel=a}setVersion(a){this.version=a}setMaskPattern(a){this.maskPattern=a}setMatrix(a){this.matrix=a}static isValidMaskPattern(a){return a>=0&&a<Sn.NUM_MASK_PATTERNS}}Sn.NUM_MASK_PATTERNS=8;class ir extends g{}ir.kind="WriterException";class gt{constructor(){}static clearMatrix(a){a.clear(255)}static buildMatrix(a,i,o,l,f){gt.clearMatrix(f),gt.embedBasicPatterns(o,f),gt.embedTypeInfo(i,l,f),gt.maybeEmbedVersionInfo(o,f),gt.embedDataBits(a,l,f)}static embedBasicPatterns(a,i){gt.embedPositionDetectionPatternsAndSeparators(i),gt.embedDarkDotAtLeftBottomCorner(i),gt.maybeEmbedPositionAdjustmentPatterns(a,i),gt.embedTimingPatterns(i)}static embedTypeInfo(a,i,o){const l=new q;gt.makeTypeInfoBits(a,i,l);for(let f=0,u=l.getSize();f<u;++f){const x=l.get(l.getSize()-1-f),p=gt.TYPE_INFO_COORDINATES[f],y=p[0],b=p[1];if(o.setBoolean(y,b,x),f<8){const I=o.getWidth()-f-1;o.setBoolean(I,8,x)}else{const R=o.getHeight()-7+(f-8);o.setBoolean(8,R,x)}}}static maybeEmbedVersionInfo(a,i){if(a.getVersionNumber()<7)return;const o=new q;gt.makeVersionInfoBits(a,o);let l=6*3-1;for(let f=0;f<6;++f)for(let u=0;u<3;++u){const x=o.get(l);l--,i.setBoolean(f,i.getHeight()-11+u,x),i.setBoolean(i.getHeight()-11+u,f,x)}}static embedDataBits(a,i,o){let l=0,f=-1,u=o.getWidth()-1,x=o.getHeight()-1;for(;u>0;){for(u===6&&(u-=1);x>=0&&x<o.getHeight();){for(let p=0;p<2;++p){const y=u-p;if(!gt.isEmpty(o.get(y,x)))continue;let b;l<a.getSize()?(b=a.get(l),++l):b=!1,i!==255&&_r.getDataMaskBit(i,y,x)&&(b=!b),o.setBoolean(y,x,b)}x+=f}f=-f,x+=f,u-=2}if(l!==a.getSize())throw new ir("Not all bits consumed: "+l+"/"+a.getSize())}static findMSBSet(a){return 32-O.numberOfLeadingZeros(a)}static calculateBCHCode(a,i){if(i===0)throw new _("0 polynomial");const o=gt.findMSBSet(i);for(a<<=o-1;gt.findMSBSet(a)>=o;)a^=i<<gt.findMSBSet(a)-o;return a}static makeTypeInfoBits(a,i,o){if(!Sn.isValidMaskPattern(i))throw new ir("Invalid mask pattern");const l=a.getBits()<<3|i;o.appendBits(l,5);const f=gt.calculateBCHCode(l,gt.TYPE_INFO_POLY);o.appendBits(f,10);const u=new q;if(u.appendBits(gt.TYPE_INFO_MASK_PATTERN,15),o.xor(u),o.getSize()!==15)throw new ir("should not happen but we got: "+o.getSize())}static makeVersionInfoBits(a,i){i.appendBits(a.getVersionNumber(),6);const o=gt.calculateBCHCode(a.getVersionNumber(),gt.VERSION_INFO_POLY);if(i.appendBits(o,12),i.getSize()!==18)throw new ir("should not happen but we got: "+i.getSize())}static isEmpty(a){return a===255}static embedTimingPatterns(a){for(let i=8;i<a.getWidth()-8;++i){const o=(i+1)%2;gt.isEmpty(a.get(i,6))&&a.setNumber(i,6,o),gt.isEmpty(a.get(6,i))&&a.setNumber(6,i,o)}}static embedDarkDotAtLeftBottomCorner(a){if(a.get(8,a.getHeight()-8)===0)throw new ir;a.setNumber(8,a.getHeight()-8,1)}static embedHorizontalSeparationPattern(a,i,o){for(let l=0;l<8;++l){if(!gt.isEmpty(o.get(a+l,i)))throw new ir;o.setNumber(a+l,i,0)}}static embedVerticalSeparationPattern(a,i,o){for(let l=0;l<7;++l){if(!gt.isEmpty(o.get(a,i+l)))throw new ir;o.setNumber(a,i+l,0)}}static embedPositionAdjustmentPattern(a,i,o){for(let l=0;l<5;++l){const f=gt.POSITION_ADJUSTMENT_PATTERN[l];for(let u=0;u<5;++u)o.setNumber(a+u,i+l,f[u])}}static embedPositionDetectionPattern(a,i,o){for(let l=0;l<7;++l){const f=gt.POSITION_DETECTION_PATTERN[l];for(let u=0;u<7;++u)o.setNumber(a+u,i+l,f[u])}}static embedPositionDetectionPatternsAndSeparators(a){const i=gt.POSITION_DETECTION_PATTERN[0].length;gt.embedPositionDetectionPattern(0,0,a),gt.embedPositionDetectionPattern(a.getWidth()-i,0,a),gt.embedPositionDetectionPattern(0,a.getWidth()-i,a);const o=8;gt.embedHorizontalSeparationPattern(0,o-1,a),gt.embedHorizontalSeparationPattern(a.getWidth()-o,o-1,a),gt.embedHorizontalSeparationPattern(0,a.getWidth()-o,a);const l=7;gt.embedVerticalSeparationPattern(l,0,a),gt.embedVerticalSeparationPattern(a.getHeight()-l-1,0,a),gt.embedVerticalSeparationPattern(l,a.getHeight()-l,a)}static maybeEmbedPositionAdjustmentPatterns(a,i){if(a.getVersionNumber()<2)return;const o=a.getVersionNumber()-1,l=gt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[o];for(let f=0,u=l.length;f!==u;f++){const x=l[f];if(x>=0)for(let p=0;p!==u;p++){const y=l[p];y>=0&&gt.isEmpty(i.get(y,x))&&gt.embedPositionAdjustmentPattern(y-2,x-2,i)}}}}gt.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),gt.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),gt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),gt.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),gt.VERSION_INFO_POLY=7973,gt.TYPE_INFO_POLY=1335,gt.TYPE_INFO_MASK_PATTERN=21522;class $0{constructor(a,i){this.dataBytes=a,this.errorCorrectionBytes=i}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class yr{constructor(){}static calculateMaskPenalty(a){return _r.applyMaskPenaltyRule1(a)+_r.applyMaskPenaltyRule2(a)+_r.applyMaskPenaltyRule3(a)+_r.applyMaskPenaltyRule4(a)}static encode(a,i,o=null){let l=yr.DEFAULT_BYTE_MODE_ENCODING;const f=o!==null&&o.get(Vr.CHARACTER_SET)!==void 0;f&&(l=o.get(Vr.CHARACTER_SET).toString());const u=this.chooseMode(a,l),x=new q;if(u===xt.BYTE&&(f||yr.DEFAULT_BYTE_MODE_ENCODING!==l)){const Ze=j.getCharacterSetECIByName(l);Ze!==void 0&&this.appendECI(Ze,x)}this.appendModeInfo(u,x);const p=new q;this.appendBytes(a,u,p,l);let y;if(o!==null&&o.get(Vr.QR_VERSION)!==void 0){const Ze=Number.parseInt(o.get(Vr.QR_VERSION).toString(),10);y=dt.getVersionForNumber(Ze);const Xe=this.calculateBitsNeeded(u,x,p,y);if(!this.willFit(Xe,y,i))throw new ir("Data too big for requested version")}else y=this.recommendVersion(i,u,x,p);const b=new q;b.appendBitArray(x);const I=u===xt.BYTE?p.getSizeInBytes():a.length;this.appendLengthInfo(I,y,u,b),b.appendBitArray(p);const R=y.getECBlocksForLevel(i),G=y.getTotalCodewords()-R.getTotalECCodewords();this.terminateBits(G,b);const Q=this.interleaveWithECBytes(b,y.getTotalCodewords(),G,R.getNumBlocks()),re=new Sn;re.setECLevel(i),re.setMode(u),re.setVersion(y);const ue=y.getDimensionForVersion(),Ae=new Ts(ue,ue),Ke=this.chooseMaskPattern(Q,i,y,Ae);return re.setMaskPattern(Ke),gt.buildMatrix(Q,i,y,Ke,Ae),re.setMatrix(Ae),re}static recommendVersion(a,i,o,l){const f=this.calculateBitsNeeded(i,o,l,dt.getVersionForNumber(1)),u=this.chooseVersion(f,a),x=this.calculateBitsNeeded(i,o,l,u);return this.chooseVersion(x,a)}static calculateBitsNeeded(a,i,o,l){return i.getSize()+a.getCharacterCountBits(l)+o.getSize()}static getAlphanumericCode(a){return a<yr.ALPHANUMERIC_TABLE.length?yr.ALPHANUMERIC_TABLE[a]:-1}static chooseMode(a,i=null){if(j.SJIS.getName()===i&&this.isOnlyDoubleByteKanji(a))return xt.KANJI;let o=!1,l=!1;for(let f=0,u=a.length;f<u;++f){const x=a.charAt(f);if(yr.isDigit(x))o=!0;else if(this.getAlphanumericCode(x.charCodeAt(0))!==-1)l=!0;else return xt.BYTE}return l?xt.ALPHANUMERIC:o?xt.NUMERIC:xt.BYTE}static isOnlyDoubleByteKanji(a){let i;try{i=he.encode(a,j.SJIS)}catch{return!1}const o=i.length;if(o%2!==0)return!1;for(let l=0;l<o;l+=2){const f=i[l]&255;if((f<129||f>159)&&(f<224||f>235))return!1}return!0}static chooseMaskPattern(a,i,o,l){let f=Number.MAX_SAFE_INTEGER,u=-1;for(let x=0;x<Sn.NUM_MASK_PATTERNS;x++){gt.buildMatrix(a,i,o,x,l);let p=this.calculateMaskPenalty(l);p<f&&(f=p,u=x)}return u}static chooseVersion(a,i){for(let o=1;o<=40;o++){const l=dt.getVersionForNumber(o);if(yr.willFit(a,l,i))return l}throw new ir("Data too big")}static willFit(a,i,o){const l=i.getTotalCodewords(),u=i.getECBlocksForLevel(o).getTotalECCodewords(),x=l-u,p=(a+7)/8;return x>=p}static terminateBits(a,i){const o=a*8;if(i.getSize()>o)throw new ir("data bits cannot fit in the QR Code"+i.getSize()+" > "+o);for(let u=0;u<4&&i.getSize()<o;++u)i.appendBit(!1);const l=i.getSize()&7;if(l>0)for(let u=l;u<8;u++)i.appendBit(!1);const f=a-i.getSizeInBytes();for(let u=0;u<f;++u)i.appendBits(u&1?17:236,8);if(i.getSize()!==o)throw new ir("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(a,i,o,l,f,u){if(l>=o)throw new ir("Block ID too large");const x=a%o,p=o-x,y=Math.floor(a/o),b=y+1,I=Math.floor(i/o),R=I+1,G=y-I,Q=b-R;if(G!==Q)throw new ir("EC bytes mismatch");if(o!==p+x)throw new ir("RS blocks mismatch");if(a!==(I+G)*p+(R+Q)*x)throw new ir("Total bytes mismatch");l<p?(f[0]=I,u[0]=G):(f[0]=R,u[0]=Q)}static interleaveWithECBytes(a,i,o,l){if(a.getSizeInBytes()!==o)throw new ir("Number of bits and data bytes does not match");let f=0,u=0,x=0;const p=new Array;for(let b=0;b<l;++b){const I=new Int32Array(1),R=new Int32Array(1);yr.getNumDataBytesAndNumECBytesForBlockID(i,o,l,b,I,R);const G=I[0],Q=new Uint8Array(G);a.toBytes(8*f,Q,0,G);const re=yr.generateECBytes(Q,R[0]);p.push(new $0(Q,re)),u=Math.max(u,G),x=Math.max(x,re.length),f+=I[0]}if(o!==f)throw new ir("Data bytes does not match offset");const y=new q;for(let b=0;b<u;++b)for(const I of p){const R=I.getDataBytes();b<R.length&&y.appendBits(R[b],8)}for(let b=0;b<x;++b)for(const I of p){const R=I.getErrorCorrectionBytes();b<R.length&&y.appendBits(R[b],8)}if(i!==y.getSizeInBytes())throw new ir("Interleaving error: "+i+" and "+y.getSizeInBytes()+" differ.");return y}static generateECBytes(a,i){const o=a.length,l=new Int32Array(o+i);for(let u=0;u<o;u++)l[u]=a[u]&255;new Zi(Y.QR_CODE_FIELD_256).encode(l,i);const f=new Uint8Array(i);for(let u=0;u<i;u++)f[u]=l[o+u];return f}static appendModeInfo(a,i){i.appendBits(a.getBits(),4)}static appendLengthInfo(a,i,o,l){const f=o.getCharacterCountBits(i);if(a>=1<<f)throw new ir(a+" is bigger than "+((1<<f)-1));l.appendBits(a,f)}static appendBytes(a,i,o,l){switch(i){case xt.NUMERIC:yr.appendNumericBytes(a,o);break;case xt.ALPHANUMERIC:yr.appendAlphanumericBytes(a,o);break;case xt.BYTE:yr.append8BitBytes(a,o,l);break;case xt.KANJI:yr.appendKanjiBytes(a,o);break;default:throw new ir("Invalid mode: "+i)}}static getDigit(a){return a.charCodeAt(0)-48}static isDigit(a){const i=yr.getDigit(a);return i>=0&&i<=9}static appendNumericBytes(a,i){const o=a.length;let l=0;for(;l<o;){const f=yr.getDigit(a.charAt(l));if(l+2<o){const u=yr.getDigit(a.charAt(l+1)),x=yr.getDigit(a.charAt(l+2));i.appendBits(f*100+u*10+x,10),l+=3}else if(l+1<o){const u=yr.getDigit(a.charAt(l+1));i.appendBits(f*10+u,7),l+=2}else i.appendBits(f,4),l++}}static appendAlphanumericBytes(a,i){const o=a.length;let l=0;for(;l<o;){const f=yr.getAlphanumericCode(a.charCodeAt(l));if(f===-1)throw new ir;if(l+1<o){const u=yr.getAlphanumericCode(a.charCodeAt(l+1));if(u===-1)throw new ir;i.appendBits(f*45+u,11),l+=2}else i.appendBits(f,6),l++}}static append8BitBytes(a,i,o){let l;try{l=he.encode(a,o)}catch(f){throw new ir(f)}for(let f=0,u=l.length;f!==u;f++){const x=l[f];i.appendBits(x,8)}}static appendKanjiBytes(a,i){let o;try{o=he.encode(a,j.SJIS)}catch(f){throw new ir(f)}const l=o.length;for(let f=0;f<l;f+=2){const u=o[f]&255,x=o[f+1]&255,p=u<<8&4294967295|x;let y=-1;if(p>=33088&&p<=40956?y=p-33088:p>=57408&&p<=60351&&(y=p-49472),y===-1)throw new ir("Invalid byte sequence");const b=(y>>8)*192+(y&255);i.appendBits(b,13)}}static appendECI(a,i){i.appendBits(xt.ECI.getBits(),4),i.appendBits(a.getValue(),8)}}yr.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),yr.DEFAULT_BYTE_MODE_ENCODING=j.UTF8.getName();class un{write(a,i,o,l=null){if(a.length===0)throw new _("Found empty contents");if(i<0||o<0)throw new _("Requested dimensions are too small: "+i+"x"+o);let f=dr.L,u=un.QUIET_ZONE_SIZE;l!==null&&(l.get(Vr.ERROR_CORRECTION)!==void 0&&(f=dr.fromString(l.get(Vr.ERROR_CORRECTION).toString())),l.get(Vr.MARGIN)!==void 0&&(u=Number.parseInt(l.get(Vr.MARGIN).toString(),10)));const x=yr.encode(a,f,l);return this.renderResult(x,i,o,u)}writeToDom(a,i,o,l,f=null){typeof a=="string"&&(a=document.querySelector(a));const u=this.write(i,o,l,f);a&&a.appendChild(u)}renderResult(a,i,o,l){const f=a.getMatrix();if(f===null)throw new lt;const u=f.getWidth(),x=f.getHeight(),p=u+l*2,y=x+l*2,b=Math.max(i,p),I=Math.max(o,y),R=Math.min(Math.floor(b/p),Math.floor(I/y)),G=Math.floor((b-u*R)/2),Q=Math.floor((I-x*R)/2),re=this.createSVGElement(b,I);for(let ue=0,Ae=Q;ue<x;ue++,Ae+=R)for(let Ke=0,Ze=G;Ke<u;Ke++,Ze+=R)if(f.get(Ke,ue)===1){const Xe=this.createSvgRectElement(Ze,Ae,R,R);re.appendChild(Xe)}return re}createSVGElement(a,i){const o=document.createElementNS(un.SVG_NS,"svg");return o.setAttributeNS(null,"height",a.toString()),o.setAttributeNS(null,"width",i.toString()),o}createSvgRectElement(a,i,o,l){const f=document.createElementNS(un.SVG_NS,"rect");return f.setAttributeNS(null,"x",a.toString()),f.setAttributeNS(null,"y",i.toString()),f.setAttributeNS(null,"height",o.toString()),f.setAttributeNS(null,"width",l.toString()),f.setAttributeNS(null,"fill","#000000"),f}}un.QUIET_ZONE_SIZE=4,un.SVG_NS="http://www.w3.org/2000/svg";class Ma{encode(a,i,o,l,f){if(a.length===0)throw new _("Found empty contents");if(i!==le.QR_CODE)throw new _("Can only encode QR_CODE, but got "+i);if(o<0||l<0)throw new _(`Requested dimensions are too small: ${o}x${l}`);let u=dr.L,x=Ma.QUIET_ZONE_SIZE;f!==null&&(f.get(Vr.ERROR_CORRECTION)!==void 0&&(u=dr.fromString(f.get(Vr.ERROR_CORRECTION).toString())),f.get(Vr.MARGIN)!==void 0&&(x=Number.parseInt(f.get(Vr.MARGIN).toString(),10)));const p=yr.encode(a,u,f);return Ma.renderResult(p,o,l,x)}static renderResult(a,i,o,l){const f=a.getMatrix();if(f===null)throw new lt;const u=f.getWidth(),x=f.getHeight(),p=u+l*2,y=x+l*2,b=Math.max(i,p),I=Math.max(o,y),R=Math.min(Math.floor(b/p),Math.floor(I/y)),G=Math.floor((b-u*R)/2),Q=Math.floor((I-x*R)/2),re=new $e(b,I);for(let ue=0,Ae=Q;ue<x;ue++,Ae+=R)for(let Ke=0,Ze=G;Ke<u;Ke++,Ze+=R)f.get(Ke,ue)===1&&re.setRegion(Ze,Ae,R,R);return re}}Ma.QUIET_ZONE_SIZE=4;class pc{encode(a,i,o,l,f){let u;switch(i){case le.QR_CODE:u=new Ma;break;default:throw new _("No encoder available for format "+i)}return u.encode(a,i,o,l,f)}}class Za extends Ut{constructor(a,i,o,l,f,u,x,p){if(super(u,x),this.yuvData=a,this.dataWidth=i,this.dataHeight=o,this.left=l,this.top=f,l+u>i||f+x>o)throw new _("Crop rectangle does not fit within image data.");p&&this.reverseHorizontal(u,x)}getRow(a,i){if(a<0||a>=this.getHeight())throw new _("Requested row is outside the image: "+a);const o=this.getWidth();(i==null||i.length<o)&&(i=new Uint8ClampedArray(o));const l=(a+this.top)*this.dataWidth+this.left;return S.arraycopy(this.yuvData,l,i,0,o),i}getMatrix(){const a=this.getWidth(),i=this.getHeight();if(a===this.dataWidth&&i===this.dataHeight)return this.yuvData;const o=a*i,l=new Uint8ClampedArray(o);let f=this.top*this.dataWidth+this.left;if(a===this.dataWidth)return S.arraycopy(this.yuvData,f,l,0,o),l;for(let u=0;u<i;u++){const x=u*a;S.arraycopy(this.yuvData,f,l,x,a),f+=this.dataWidth}return l}isCropSupported(){return!0}crop(a,i,o,l){return new Za(this.yuvData,this.dataWidth,this.dataHeight,this.left+a,this.top+i,o,l,!1)}renderThumbnail(){const a=this.getWidth()/Za.THUMBNAIL_SCALE_FACTOR,i=this.getHeight()/Za.THUMBNAIL_SCALE_FACTOR,o=new Int32Array(a*i),l=this.yuvData;let f=this.top*this.dataWidth+this.left;for(let u=0;u<i;u++){const x=u*a;for(let p=0;p<a;p++){const y=l[f+p*Za.THUMBNAIL_SCALE_FACTOR]&255;o[x+p]=4278190080|y*65793}f+=this.dataWidth*Za.THUMBNAIL_SCALE_FACTOR}return o}getThumbnailWidth(){return this.getWidth()/Za.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Za.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(a,i){const o=this.yuvData;for(let l=0,f=this.top*this.dataWidth+this.left;l<i;l++,f+=this.dataWidth){const u=f+a/2;for(let x=f,p=f+a-1;x<u;x++,p--){const y=o[x];o[x]=o[p],o[p]=y}}}invert(){return new fe(this)}}Za.THUMBNAIL_SCALE_FACTOR=2;class bi extends Ut{constructor(a,i,o,l,f,u,x){if(super(i,o),this.dataWidth=l,this.dataHeight=f,this.left=u,this.top=x,a.BYTES_PER_ELEMENT===4){const p=i*o,y=new Uint8ClampedArray(p);for(let b=0;b<p;b++){const I=a[b],R=I>>16&255,G=I>>7&510,Q=I&255;y[b]=(R+G+Q)/4&255}this.luminances=y}else this.luminances=a;if(l===void 0&&(this.dataWidth=i),f===void 0&&(this.dataHeight=o),u===void 0&&(this.left=0),x===void 0&&(this.top=0),this.left+i>this.dataWidth||this.top+o>this.dataHeight)throw new _("Crop rectangle does not fit within image data.")}getRow(a,i){if(a<0||a>=this.getHeight())throw new _("Requested row is outside the image: "+a);const o=this.getWidth();(i==null||i.length<o)&&(i=new Uint8ClampedArray(o));const l=(a+this.top)*this.dataWidth+this.left;return S.arraycopy(this.luminances,l,i,0,o),i}getMatrix(){const a=this.getWidth(),i=this.getHeight();if(a===this.dataWidth&&i===this.dataHeight)return this.luminances;const o=a*i,l=new Uint8ClampedArray(o);let f=this.top*this.dataWidth+this.left;if(a===this.dataWidth)return S.arraycopy(this.luminances,f,l,0,o),l;for(let u=0;u<i;u++){const x=u*a;S.arraycopy(this.luminances,f,l,x,a),f+=this.dataWidth}return l}isCropSupported(){return!0}crop(a,i,o,l){return new bi(this.luminances,o,l,this.dataWidth,this.dataHeight,this.left+a,this.top+i)}invert(){return new fe(this)}}class Ns extends j{static forName(a){return this.getCharacterSetECIByName(a)}}class ks{}ks.ISO_8859_1=j.ISO8859_1;class eo{isCompact(){return this.compact}setCompact(a){this.compact=a}getSize(){return this.size}setSize(a){this.size=a}getLayers(){return this.layers}setLayers(a){this.layers=a}getCodeWords(){return this.codeWords}setCodeWords(a){this.codeWords=a}getMatrix(){return this.matrix}setMatrix(a){this.matrix=a}}class dn{static singletonList(a){return[a]}static min(a,i){return a.sort(i)[0]}}class Vn{constructor(a){this.previous=a}getPrevious(){return this.previous}}class Hn extends Vn{constructor(a,i,o){super(a),this.value=i,this.bitCount=o}appendTo(a,i){a.appendBits(this.value,this.bitCount)}add(a,i){return new Hn(this,a,i)}addBinaryShift(a,i){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Hn(this,a,i)}toString(){let a=this.value&(1<<this.bitCount)-1;return a|=1<<this.bitCount,"<"+O.toBinaryString(a|1<<this.bitCount).substring(1)+">"}}class ii extends Hn{constructor(a,i,o){super(a,0,0),this.binaryShiftStart=i,this.binaryShiftByteCount=o}appendTo(a,i){for(let o=0;o<this.binaryShiftByteCount;o++)(o===0||o===31&&this.binaryShiftByteCount<=62)&&(a.appendBits(31,5),this.binaryShiftByteCount>62?a.appendBits(this.binaryShiftByteCount-31,16):o===0?a.appendBits(Math.min(this.binaryShiftByteCount,31),5):a.appendBits(this.binaryShiftByteCount-31,5)),a.appendBits(i[this.binaryShiftStart+o],8)}addBinaryShift(a,i){return new ii(this,a,i)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function to(k,a,i){return new ii(k,a,i)}function Ji(k,a,i){return new Hn(k,a,i)}const si=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Ja=0,Gn=1,Ha=2,n0=3,Qa=4,ro=new Hn(null,0,0),i0=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function wc(k){for(let a of k)X.fill(a,-1);return k[Ja][Qa]=0,k[Gn][Qa]=0,k[Gn][Ja]=28,k[n0][Qa]=0,k[Ha][Qa]=0,k[Ha][Ja]=15,k}const ao=wc(X.createInt32Array(6,6));class Pa{constructor(a,i,o,l){this.token=a,this.mode=i,this.binaryShiftByteCount=o,this.bitCount=l}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(a,i){let o=this.bitCount,l=this.token;if(a!==this.mode){let u=i0[this.mode][a];l=Ji(l,u&65535,u>>16),o+=u>>16}let f=a===Ha?4:5;return l=Ji(l,i,f),new Pa(l,a,0,o+f)}shiftAndAppend(a,i){let o=this.token,l=this.mode===Ha?4:5;return o=Ji(o,ao[this.mode][a],l),o=Ji(o,i,5),new Pa(o,this.mode,0,this.bitCount+l+5)}addBinaryShiftChar(a){let i=this.token,o=this.mode,l=this.bitCount;if(this.mode===Qa||this.mode===Ha){let x=i0[o][Ja];i=Ji(i,x&65535,x>>16),l+=x>>16,o=Ja}let f=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,u=new Pa(i,o,this.binaryShiftByteCount+1,l+f);return u.binaryShiftByteCount===2078&&(u=u.endBinaryShift(a+1)),u}endBinaryShift(a){if(this.binaryShiftByteCount===0)return this;let i=this.token;return i=to(i,a-this.binaryShiftByteCount,this.binaryShiftByteCount),new Pa(i,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(a){let i=this.bitCount+(i0[this.mode][a.mode]>>16);return this.binaryShiftByteCount<a.binaryShiftByteCount?i+=Pa.calculateBinaryShiftCost(a)-Pa.calculateBinaryShiftCost(this):this.binaryShiftByteCount>a.binaryShiftByteCount&&a.binaryShiftByteCount>0&&(i+=10),i<=a.bitCount}toBitArray(a){let i=[];for(let l=this.endBinaryShift(a.length).token;l!==null;l=l.getPrevious())i.unshift(l);let o=new q;for(const l of i)l.appendTo(o,a);return o}toString(){return te.format("%s bits=%d bytes=%d",si[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(a){return a.binaryShiftByteCount>62?21:a.binaryShiftByteCount>31?20:a.binaryShiftByteCount>0?10:0}}Pa.INITIAL_STATE=new Pa(ro,Ja,0,0);function vc(k){const a=te.getCharCode(" "),i=te.getCharCode("."),o=te.getCharCode(",");k[Ja][a]=1;const l=te.getCharCode("Z"),f=te.getCharCode("A");for(let R=f;R<=l;R++)k[Ja][R]=R-f+2;k[Gn][a]=1;const u=te.getCharCode("z"),x=te.getCharCode("a");for(let R=x;R<=u;R++)k[Gn][R]=R-x+2;k[Ha][a]=1;const p=te.getCharCode("9"),y=te.getCharCode("0");for(let R=y;R<=p;R++)k[Ha][R]=R-y+2;k[Ha][o]=12,k[Ha][i]=13;const b=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let R=0;R<b.length;R++)k[n0][te.getCharCode(b[R])]=R;const I=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let R=0;R<I.length;R++)te.getCharCode(I[R])>0&&(k[Qa][te.getCharCode(I[R])]=R);return k}const s0=vc(X.createInt32Array(5,256));class Si{constructor(a){this.text=a}encode(){const a=te.getCharCode(" "),i=te.getCharCode(`
`);let o=dn.singletonList(Pa.INITIAL_STATE);for(let f=0;f<this.text.length;f++){let u,x=f+1<this.text.length?this.text[f+1]:0;switch(this.text[f]){case te.getCharCode("\r"):u=x===i?2:0;break;case te.getCharCode("."):u=x===a?3:0;break;case te.getCharCode(","):u=x===a?4:0;break;case te.getCharCode(":"):u=x===a?5:0;break;default:u=0}u>0?(o=Si.updateStateListForPair(o,f,u),f++):o=this.updateStateListForChar(o,f)}return dn.min(o,(f,u)=>f.getBitCount()-u.getBitCount()).toBitArray(this.text)}updateStateListForChar(a,i){const o=[];for(let l of a)this.updateStateForChar(l,i,o);return Si.simplifyStates(o)}updateStateForChar(a,i,o){let l=this.text[i]&255,f=s0[a.getMode()][l]>0,u=null;for(let x=0;x<=Qa;x++){let p=s0[x][l];if(p>0){if(u==null&&(u=a.endBinaryShift(i)),!f||x===a.getMode()||x===Ha){const y=u.latchAndAppend(x,p);o.push(y)}if(!f&&ao[a.getMode()][x]>=0){const y=u.shiftAndAppend(x,p);o.push(y)}}}if(a.getBinaryShiftByteCount()>0||s0[a.getMode()][l]===0){let x=a.addBinaryShiftChar(i);o.push(x)}}static updateStateListForPair(a,i,o){const l=[];for(let f of a)this.updateStateForPair(f,i,o,l);return this.simplifyStates(l)}static updateStateForPair(a,i,o,l){let f=a.endBinaryShift(i);if(l.push(f.latchAndAppend(Qa,o)),a.getMode()!==Qa&&l.push(f.shiftAndAppend(Qa,o)),o===3||o===4){let u=f.latchAndAppend(Ha,16-o).latchAndAppend(Ha,1);l.push(u)}if(a.getBinaryShiftByteCount()>0){let u=a.addBinaryShiftChar(i).addBinaryShiftChar(i+1);l.push(u)}}static simplifyStates(a){let i=[];for(const o of a){let l=!0;for(const f of i){if(f.isBetterThanOrEqualTo(o)){l=!1;break}o.isBetterThanOrEqualTo(f)&&(i=i.filter(u=>u!==f))}l&&i.push(o)}return i}}class qt{constructor(){}static encodeBytes(a){return qt.encode(a,qt.DEFAULT_EC_PERCENT,qt.DEFAULT_AZTEC_LAYERS)}static encode(a,i,o){let l=new Si(a).encode(),f=O.truncDivision(l.getSize()*i,100)+11,u=l.getSize()+f,x,p,y,b,I;if(o!==qt.DEFAULT_AZTEC_LAYERS){if(x=o<0,p=Math.abs(o),p>(x?qt.MAX_NB_BITS_COMPACT:qt.MAX_NB_BITS))throw new _(te.format("Illegal value %s for layers",o));y=qt.totalBitsInLayer(p,x),b=qt.WORD_SIZE[p];let Xe=y-y%b;if(I=qt.stuffBits(l,b),I.getSize()+f>Xe)throw new _("Data to large for user specified layer");if(x&&I.getSize()>b*64)throw new _("Data to large for user specified layer")}else{b=0,I=null;for(let Xe=0;;Xe++){if(Xe>qt.MAX_NB_BITS)throw new _("Data too large for an Aztec code");if(x=Xe<=3,p=x?Xe+1:Xe,y=qt.totalBitsInLayer(p,x),u>y)continue;(I==null||b!==qt.WORD_SIZE[p])&&(b=qt.WORD_SIZE[p],I=qt.stuffBits(l,b));let Ht=y-y%b;if(!(x&&I.getSize()>b*64)&&I.getSize()+f<=Ht)break}}let R=qt.generateCheckWords(I,y,b),G=I.getSize()/b,Q=qt.generateModeMessage(x,p,G),re=(x?11:14)+p*4,ue=new Int32Array(re),Ae;if(x){Ae=re;for(let Xe=0;Xe<ue.length;Xe++)ue[Xe]=Xe}else{Ae=re+1+2*O.truncDivision(O.truncDivision(re,2)-1,15);let Xe=O.truncDivision(re,2),Ht=O.truncDivision(Ae,2);for(let kt=0;kt<Xe;kt++){let _a=kt+O.truncDivision(kt,15);ue[Xe-kt-1]=Ht-_a-1,ue[Xe+kt]=Ht+_a+1}}let Ke=new $e(Ae);for(let Xe=0,Ht=0;Xe<p;Xe++){let kt=(p-Xe)*4+(x?9:12);for(let _a=0;_a<kt;_a++){let $a=_a*2;for(let la=0;la<2;la++)R.get(Ht+$a+la)&&Ke.set(ue[Xe*2+la],ue[Xe*2+_a]),R.get(Ht+kt*2+$a+la)&&Ke.set(ue[Xe*2+_a],ue[re-1-Xe*2-la]),R.get(Ht+kt*4+$a+la)&&Ke.set(ue[re-1-Xe*2-la],ue[re-1-Xe*2-_a]),R.get(Ht+kt*6+$a+la)&&Ke.set(ue[re-1-Xe*2-_a],ue[Xe*2+la])}Ht+=kt*8}if(qt.drawModeMessage(Ke,x,Ae,Q),x)qt.drawBullsEye(Ke,O.truncDivision(Ae,2),5);else{qt.drawBullsEye(Ke,O.truncDivision(Ae,2),7);for(let Xe=0,Ht=0;Xe<O.truncDivision(re,2)-1;Xe+=15,Ht+=16)for(let kt=O.truncDivision(Ae,2)&1;kt<Ae;kt+=2)Ke.set(O.truncDivision(Ae,2)-Ht,kt),Ke.set(O.truncDivision(Ae,2)+Ht,kt),Ke.set(kt,O.truncDivision(Ae,2)-Ht),Ke.set(kt,O.truncDivision(Ae,2)+Ht)}let Ze=new eo;return Ze.setCompact(x),Ze.setSize(Ae),Ze.setLayers(p),Ze.setCodeWords(G),Ze.setMatrix(Ke),Ze}static drawBullsEye(a,i,o){for(let l=0;l<o;l+=2)for(let f=i-l;f<=i+l;f++)a.set(f,i-l),a.set(f,i+l),a.set(i-l,f),a.set(i+l,f);a.set(i-o,i-o),a.set(i-o+1,i-o),a.set(i-o,i-o+1),a.set(i+o,i-o),a.set(i+o,i-o+1),a.set(i+o,i+o-1)}static generateModeMessage(a,i,o){let l=new q;return a?(l.appendBits(i-1,2),l.appendBits(o-1,6),l=qt.generateCheckWords(l,28,4)):(l.appendBits(i-1,5),l.appendBits(o-1,11),l=qt.generateCheckWords(l,40,4)),l}static drawModeMessage(a,i,o,l){let f=O.truncDivision(o,2);if(i)for(let u=0;u<7;u++){let x=f-3+u;l.get(u)&&a.set(x,f-5),l.get(u+7)&&a.set(f+5,x),l.get(20-u)&&a.set(x,f+5),l.get(27-u)&&a.set(f-5,x)}else for(let u=0;u<10;u++){let x=f-5+u+O.truncDivision(u,5);l.get(u)&&a.set(x,f-7),l.get(u+10)&&a.set(f+7,x),l.get(29-u)&&a.set(x,f+7),l.get(39-u)&&a.set(f-7,x)}}static generateCheckWords(a,i,o){let l=a.getSize()/o,f=new Zi(qt.getGF(o)),u=O.truncDivision(i,o),x=qt.bitsToWords(a,o,u);f.encode(x,u-l);let p=i%o,y=new q;y.appendBits(0,p);for(const b of Array.from(x))y.appendBits(b,o);return y}static bitsToWords(a,i,o){let l=new Int32Array(o),f,u;for(f=0,u=a.getSize()/i;f<u;f++){let x=0;for(let p=0;p<i;p++)x|=a.get(f*i+p)?1<<i-p-1:0;l[f]=x}return l}static getGF(a){switch(a){case 4:return Y.AZTEC_PARAM;case 6:return Y.AZTEC_DATA_6;case 8:return Y.AZTEC_DATA_8;case 10:return Y.AZTEC_DATA_10;case 12:return Y.AZTEC_DATA_12;default:throw new _("Unsupported word size "+a)}}static stuffBits(a,i){let o=new q,l=a.getSize(),f=(1<<i)-2;for(let u=0;u<l;u+=i){let x=0;for(let p=0;p<i;p++)(u+p>=l||a.get(u+p))&&(x|=1<<i-1-p);(x&f)===f?(o.appendBits(x&f,i),u--):x&f?o.appendBits(x,i):(o.appendBits(x|1,i),u--)}return o}static totalBitsInLayer(a,i){return((i?88:112)+16*a)*a}}qt.DEFAULT_EC_PERCENT=33,qt.DEFAULT_AZTEC_LAYERS=0,qt.MAX_NB_BITS=32,qt.MAX_NB_BITS_COMPACT=4,qt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Qi{encode(a,i,o,l){return this.encodeWithHints(a,i,o,l,null)}encodeWithHints(a,i,o,l,f){let u=ks.ISO_8859_1,x=qt.DEFAULT_EC_PERCENT,p=qt.DEFAULT_AZTEC_LAYERS;return f!=null&&(f.has(Vr.CHARACTER_SET)&&(u=Ns.forName(f.get(Vr.CHARACTER_SET).toString())),f.has(Vr.ERROR_CORRECTION)&&(x=O.parseInt(f.get(Vr.ERROR_CORRECTION).toString())),f.has(Vr.AZTEC_LAYERS)&&(p=O.parseInt(f.get(Vr.AZTEC_LAYERS).toString()))),Qi.encodeLayers(a,i,o,l,u,x,p)}static encodeLayers(a,i,o,l,f,u,x){if(i!==le.AZTEC)throw new _("Can only encode AZTEC, but got "+i);let p=qt.encode(te.getBytes(a,f),u,x);return Qi.renderResult(p,o,l)}static renderResult(a,i,o){let l=a.getMatrix();if(l==null)throw new lt;let f=l.getWidth(),u=l.getHeight(),x=Math.max(i,f),p=Math.max(o,u),y=Math.min(x/f,p/u),b=(x-f*y)/2,I=(p-u*y)/2,R=new $e(x,p);for(let G=0,Q=I;G<u;G++,Q+=y)for(let re=0,ue=b;re<f;re++,ue+=y)l.get(re,G)&&R.setRegion(ue,Q,y,y);return R}}t.AbstractExpandedDecoder=W,t.ArgumentException=v,t.ArithmeticException=A,t.AztecCode=eo,t.AztecCodeReader=cr,t.AztecCodeWriter=Qi,t.AztecDecoder=ft,t.AztecDetector=St,t.AztecDetectorResult=ln,t.AztecEncoder=qt,t.AztecHighLevelEncoder=Si,t.AztecPoint=Yt,t.BarcodeFormat=le,t.Binarizer=N,t.BinaryBitmap=C,t.BitArray=q,t.BitMatrix=$e,t.BitSource=Ln,t.BrowserAztecCodeReader=sa,t.BrowserBarcodeReader=Bn,t.BrowserCodeReader=ce,t.BrowserDatamatrixCodeReader=K0,t.BrowserMultiFormatReader=mc,t.BrowserPDF417Reader=Cs,t.BrowserQRCodeReader=ni,t.BrowserQRCodeSvgWriter=un,t.CharacterSetECI=j,t.ChecksumException=T,t.Code128Reader=Qe,t.Code39Reader=br,t.DataMatrixDecodedBitStreamParser=Va,t.DataMatrixReader=hn,t.DecodeHintType=J,t.DecoderResult=Pe,t.DefaultGridSampler=$n,t.DetectorResult=An,t.EAN13Reader=Ya,t.EncodeHintType=Vr,t.Exception=g,t.FormatException=M,t.GenericGF=Y,t.GenericGFPoly=Te,t.GlobalHistogramBinarizer=tt,t.GridSampler=xa,t.GridSamplerInstance=Ar,t.HTMLCanvasElementLuminanceSource=ot,t.HybridBinarizer=Re,t.ITFReader=ar,t.IllegalArgumentException=_,t.IllegalStateException=lt,t.InvertedLuminanceSource=fe,t.LuminanceSource=Ut,t.MathUtils=Et,t.MultiFormatOneDReader=ga,t.MultiFormatReader=ai,t.MultiFormatWriter=pc,t.NotFoundException=ae,t.OneDReader=Mt,t.PDF417DecodedBitStreamParser=_e,t.PDF417DecoderErrorCorrection=As,t.PDF417Reader=Cr,t.PDF417ResultMetadata=q0,t.PerspectiveTransform=Or,t.PlanarYUVLuminanceSource=Za,t.QRCodeByteMatrix=Ts,t.QRCodeDataMask=qa,t.QRCodeDecodedBitStreamParser=wr,t.QRCodeDecoderErrorCorrectionLevel=dr,t.QRCodeDecoderFormatInformation=ca,t.QRCodeEncoder=yr,t.QRCodeEncoderQRCode=Sn,t.QRCodeMaskUtil=_r,t.QRCodeMatrixUtil=gt,t.QRCodeMode=xt,t.QRCodeReader=vr,t.QRCodeVersion=dt,t.QRCodeWriter=Ma,t.RGBLuminanceSource=bi,t.RSS14Reader=Ft,t.RSSExpandedReader=Ce,t.ReaderException=Ss,t.ReedSolomonDecoder=ze,t.ReedSolomonEncoder=Zi,t.ReedSolomonException=ht,t.Result=ee,t.ResultMetadataType=Le,t.ResultPoint=st,t.StringUtils=te,t.UnsupportedOperationException=Ee,t.VideoInputDevice=pt,t.WhiteRectangleDetector=Dr,t.WriterException=ir,t.ZXingArrays=X,t.ZXingCharset=Ns,t.ZXingInteger=O,t.ZXingStandardCharsets=ks,t.ZXingStringBuilder=be,t.ZXingStringEncoding=he,t.ZXingSystem=S,t.createAbstractExpandedDecoder=Je,Object.defineProperty(t,"__esModule",{value:!0})})})(cl,cl.exports);var Tr=cl.exports;const c8=Ku(Tr),l8=pd({__proto__:null,default:c8},[Tr]);var T1=function(){function e(r,t,n){if(this.formatMap=new Map([[ct.QR_CODE,Tr.BarcodeFormat.QR_CODE],[ct.AZTEC,Tr.BarcodeFormat.AZTEC],[ct.CODABAR,Tr.BarcodeFormat.CODABAR],[ct.CODE_39,Tr.BarcodeFormat.CODE_39],[ct.CODE_93,Tr.BarcodeFormat.CODE_93],[ct.CODE_128,Tr.BarcodeFormat.CODE_128],[ct.DATA_MATRIX,Tr.BarcodeFormat.DATA_MATRIX],[ct.MAXICODE,Tr.BarcodeFormat.MAXICODE],[ct.ITF,Tr.BarcodeFormat.ITF],[ct.EAN_13,Tr.BarcodeFormat.EAN_13],[ct.EAN_8,Tr.BarcodeFormat.EAN_8],[ct.PDF_417,Tr.BarcodeFormat.PDF_417],[ct.RSS_14,Tr.BarcodeFormat.RSS_14],[ct.RSS_EXPANDED,Tr.BarcodeFormat.RSS_EXPANDED],[ct.UPC_A,Tr.BarcodeFormat.UPC_A],[ct.UPC_E,Tr.BarcodeFormat.UPC_E],[ct.UPC_EAN_EXTENSION,Tr.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!l8)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=n;var s=this.createZXingFormats(r),c=new Map;c.set(Tr.DecodeHintType.POSSIBLE_FORMATS,s),c.set(Tr.DecodeHintType.TRY_HARDER,!1),this.hints=c}return e.prototype.decodeAsync=function(r){var t=this;return new Promise(function(n,s){try{n(t.decode(r))}catch(c){s(c)}})},e.prototype.decode=function(r){var t=new Tr.MultiFormatReader(this.verbose,this.hints),n=new Tr.HTMLCanvasElementLuminanceSource(r),s=new Tr.BinaryBitmap(new Tr.HybridBinarizer(n)),c=t.decode(s);return{text:c.text,format:Gu.create(this.toHtml5QrcodeSupportedFormats(c.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(t,n,s){r.set(t,n)}),r},e.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},e.prototype.createZXingFormats=function(r){for(var t=[],n=0,s=r;n<s.length;n++){var c=s[n];this.formatMap.has(c)?t.push(this.formatMap.get(c)):this.logger.logError("".concat(c," is not supported by")+"ZXingHtml5QrcodeShim")}return t},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),f8=function(e,r,t,n){function s(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function d(v){try{g(n.next(v))}catch(_){h(_)}}function m(v){try{g(n.throw(v))}catch(_){h(_)}}function g(v){v.done?c(v.value):s(v.value).then(d,m)}g((n=n.apply(e,r||[])).next())})},h8=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,h;return h={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function d(g){return function(v){return m([g,v])}}function m(g){if(n)throw new TypeError("Generator is already executing.");for(;h&&(h=0,g[0]&&(t=0)),t;)try{if(n=1,s&&(c=g[0]&2?s.return:g[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,g[1])).done)return c;switch(s=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,s=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=r.call(e,t)}catch(v){g=[6,v],s=0}finally{n=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},N1=function(){function e(r,t,n){if(this.formatMap=new Map([[ct.QR_CODE,"qr_code"],[ct.AZTEC,"aztec"],[ct.CODABAR,"codabar"],[ct.CODE_39,"code_39"],[ct.CODE_93,"code_93"],[ct.CODE_128,"code_128"],[ct.DATA_MATRIX,"data_matrix"],[ct.ITF,"itf"],[ct.EAN_13,"ean_13"],[ct.EAN_8,"ean_8"],[ct.PDF_417,"pdf417"],[ct.UPC_A,"upc_a"],[ct.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t,this.logger=n;var s=this.createBarcodeDetectorFormats(r);if(this.detector=new BarcodeDetector(s),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var r=new BarcodeDetector({formats:["qr_code"]});return typeof r<"u"},e.prototype.decodeAsync=function(r){return f8(this,void 0,void 0,function(){var t,n;return h8(this,function(s){switch(s.label){case 0:return[4,this.detector.detect(r)];case 1:if(t=s.sent(),!t||t.length===0)throw"No barcode or QR code detected.";return n=this.selectLargestBarcode(t),[2,{text:n.rawValue,format:Gu.create(this.toHtml5QrcodeSupportedFormats(n.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(r){for(var t=null,n=0,s=0,c=r;s<c.length;s++){var h=c[s],d=h.boundingBox.width*h.boundingBox.height;d>n&&(n=d,t=h)}if(!t)throw"No largest barcode found";return t},e.prototype.createBarcodeDetectorFormats=function(r){for(var t=[],n=0,s=r;n<s.length;n++){var c=s[n];this.formatMap.has(c)?t.push(this.formatMap.get(c)):this.logger.warn("".concat(c," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},e.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},e.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(t,n,s){r.set(t,n)}),r},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),k1=function(e,r,t,n){function s(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function d(v){try{g(n.next(v))}catch(_){h(_)}}function m(v){try{g(n.throw(v))}catch(_){h(_)}}function g(v){v.done?c(v.value):s(v.value).then(d,m)}g((n=n.apply(e,r||[])).next())})},I1=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,h;return h={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function d(g){return function(v){return m([g,v])}}function m(g){if(n)throw new TypeError("Generator is already executing.");for(;h&&(h=0,g[0]&&(t=0)),t;)try{if(n=1,s&&(c=g[0]&2?s.return:g[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,g[1])).done)return c;switch(s=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,s=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=r.call(e,t)}catch(v){g=[6,v],s=0}finally{n=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},u8=function(){function e(r,t,n,s){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=n,t&&N1.isSupported()?(this.primaryDecoder=new N1(r,n,s),this.secondaryDecoder=new T1(r,n,s)):this.primaryDecoder=new T1(r,n,s)}return e.prototype.decodeAsync=function(r){return k1(this,void 0,void 0,function(){var t;return I1(this,function(n){switch(n.label){case 0:t=performance.now(),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(r)];case 2:return[2,n.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(r){return k1(this,void 0,void 0,function(){var t,n;return I1(this,function(s){switch(s.label){case 0:t=performance.now(),s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(r)];case 2:return[2,s.sent()];case 3:if(n=s.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(r)];throw n;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(r){if(this.verbose){var t=performance.now()-r;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var r=0,t=0,n=this.executionResults;t<n.length;t++){var s=n[t];r+=s}var c=r/this.executionResults.length;console.log("".concat(c," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e}(),Zl=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(n[c]=s[c])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ec=function(e,r,t,n){function s(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function d(v){try{g(n.next(v))}catch(_){h(_)}}function m(v){try{g(n.throw(v))}catch(_){h(_)}}function g(v){v.done?c(v.value):s(v.value).then(d,m)}g((n=n.apply(e,r||[])).next())})},tc=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,h;return h={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function d(g){return function(v){return m([g,v])}}function m(g){if(n)throw new TypeError("Generator is already executing.");for(;h&&(h=0,g[0]&&(t=0)),t;)try{if(n=1,s&&(c=g[0]&2?s.return:g[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,g[1])).done)return c;switch(s=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,s=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=r.call(e,t)}catch(v){g=[6,v],s=0}finally{n=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},zu=function(){function e(r,t){this.name=r,this.track=t}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(r){var t={};t[this.name]=r;var n={advanced:[t]};return this.track.applyConstraints(n)},e.prototype.value=function(){var r=this.track.getSettings();if(this.name in r){var t=r[this.name];return t}return null},e}(),d8=function(e){Zl(r,e);function r(t,n){return e.call(this,t,n)||this}return r.prototype.min=function(){return this.getCapabilities().min},r.prototype.max=function(){return this.getCapabilities().max},r.prototype.step=function(){return this.getCapabilities().step},r.prototype.apply=function(t){var n={};n[this.name]=t;var s={advanced:[n]};return this.track.applyConstraints(s)},r.prototype.getCapabilities=function(){this.failIfNotSupported();var t=this.track.getCapabilities(),n=t[this.name];return{min:n.min,max:n.max,step:n.step}},r.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},r}(zu),x8=function(e){Zl(r,e);function r(t){return e.call(this,"zoom",t)||this}return r}(d8),g8=function(e){Zl(r,e);function r(t){return e.call(this,"torch",t)||this}return r}(zu),m8=function(){function e(r){this.track=r}return e.prototype.zoomFeature=function(){return new x8(this.track)},e.prototype.torchFeature=function(){return new g8(this.track)},e}(),p8=function(){function e(r,t,n){this.isClosed=!1,this.parentElement=r,this.mediaStream=t,this.callbacks=n,this.surface=this.createVideoElement(this.parentElement.clientWidth),r.append(this.surface)}return e.prototype.createVideoElement=function(r){var t=document.createElement("video");return t.style.width="".concat(r,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},e.prototype.setupSurface=function(){var r=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var n=r.surface.clientWidth,s=r.surface.clientHeight;r.callbacks.onRenderSurfaceReady(n,s),r.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(r,t,n,s){return ec(this,void 0,void 0,function(){var c,h;return tc(this,function(d){switch(d.label){case 0:return c=new e(r,t,s),n.aspectRatio?(h={aspectRatio:n.aspectRatio},[4,c.getFirstTrackOrFail().applyConstraints(h)]):[3,2];case 1:d.sent(),d.label=2;case 2:return c.setupSurface(),[2,c]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(r){this.failIfClosed();var t=this,n=function(){setTimeout(r,200),t.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(r){return ec(this,void 0,void 0,function(){return tc(this,function(t){if("aspectRatio"in r)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(r)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var r=this;return new Promise(function(t,n){var s=r.mediaStream.getVideoTracks(),c=s.length,h=0;r.mediaStream.getVideoTracks().forEach(function(d){r.mediaStream.removeTrack(d),d.stop(),++h,h>=c&&(r.isClosed=!0,r.parentElement.removeChild(r.surface),t())})})},e.prototype.getCapabilities=function(){return new m8(this.getFirstTrackOrFail())},e}(),w8=function(){function e(r){this.mediaStream=r}return e.prototype.render=function(r,t,n){return ec(this,void 0,void 0,function(){return tc(this,function(s){return[2,p8.create(r,this.mediaStream,t,n)]})})},e.create=function(r){return ec(this,void 0,void 0,function(){var t,n;return tc(this,function(s){switch(s.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return t={audio:!1,video:r},[4,navigator.mediaDevices.getUserMedia(t)];case 1:return n=s.sent(),[2,new e(n)]}})})},e}(),D1=function(e,r,t,n){function s(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function d(v){try{g(n.next(v))}catch(_){h(_)}}function m(v){try{g(n.throw(v))}catch(_){h(_)}}function g(v){v.done?c(v.value):s(v.value).then(d,m)}g((n=n.apply(e,r||[])).next())})},F1=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,h;return h={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function d(g){return function(v){return m([g,v])}}function m(g){if(n)throw new TypeError("Generator is already executing.");for(;h&&(h=0,g[0]&&(t=0)),t;)try{if(n=1,s&&(c=g[0]&2?s.return:g[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,g[1])).done)return c;switch(s=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,s=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=r.call(e,t)}catch(v){g=[6,v],s=0}finally{n=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},v8=function(){function e(){}return e.failIfNotSupported=function(){return D1(this,void 0,void 0,function(){return F1(this,function(r){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(r){return D1(this,void 0,void 0,function(){return F1(this,function(t){return[2,w8.create(r)]})})},e}(),y8=function(e,r,t,n){function s(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function d(v){try{g(n.next(v))}catch(_){h(_)}}function m(v){try{g(n.throw(v))}catch(_){h(_)}}function g(v){v.done?c(v.value):s(v.value).then(d,m)}g((n=n.apply(e,r||[])).next())})},E8=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,h;return h={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function d(g){return function(v){return m([g,v])}}function m(g){if(n)throw new TypeError("Generator is already executing.");for(;h&&(h=0,g[0]&&(t=0)),t;)try{if(n=1,s&&(c=g[0]&2?s.return:g[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,g[1])).done)return c;switch(s=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,s=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=r.call(e,t)}catch(v){g=[6,v],s=0}finally{n=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},_8=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var r=MediaStreamTrack;return MediaStreamTrack&&r.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var r=Us.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(r=Us.insecureContextCameraQueryError()),Promise.reject(r)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var r=location.host.split(":")[0];return r==="127.0.0.1"||r==="localhost"},e.getCamerasFromMediaDevices=function(){return y8(this,void 0,void 0,function(){var r,t,n,s,c,h,d;return E8(this,function(m){switch(m.label){case 0:return r=function(g){for(var v=g.getVideoTracks(),_=0,C=v;_<C.length;_++){var T=C[_];T.enabled=!1,T.stop(),g.removeTrack(T)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=m.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(n=m.sent(),s=[],c=0,h=n;c<h.length;c++)d=h[c],d.kind==="videoinput"&&s.push({id:d.deviceId,label:d.label});return r(t),[2,s]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(r,t){var n=function(c){for(var h=[],d=0,m=c;d<m.length;d++){var g=m[d];g.kind==="video"&&h.push({id:g.id,label:g.label})}r(h)},s=MediaStreamTrack;s.getSources(n)})},e}(),Lr;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(Lr||(Lr={}));var A8=function(){function e(){this.state=Lr.NOT_STARTED,this.onGoingTransactionNewState=Lr.UNKNOWN}return e.prototype.directTransition=function(r){this.failIfTransitionOngoing(),this.validateTransition(r),this.state=r},e.prototype.startTransition=function(r){return this.failIfTransitionOngoing(),this.validateTransition(r),this.onGoingTransactionNewState=r,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===Lr.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var r=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Lr.UNKNOWN,this.directTransition(r)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===Lr.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Lr.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Lr.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(r){switch(this.state){case Lr.UNKNOWN:throw"Transition from unknown is not allowed";case Lr.NOT_STARTED:this.failIfNewStateIs(r,[Lr.PAUSED]);break;case Lr.SCANNING:break;case Lr.PAUSED:break}},e.prototype.failIfNewStateIs=function(r,t){for(var n=0,s=t;n<s.length;n++){var c=s[n];if(r===c)throw"Cannot transition from ".concat(this.state," to ").concat(r)}},e}(),b8=function(){function e(r){this.stateManager=r}return e.prototype.startTransition=function(r){return this.stateManager.startTransition(r)},e.prototype.directTransition=function(r){this.stateManager.directTransition(r)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===Lr.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==Lr.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Lr.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===Lr.PAUSED},e}(),S8=function(){function e(){}return e.create=function(){return new b8(new A8)},e}(),C8=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(n[c]=s[c])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),rn=function(e){C8(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.DEFAULT_WIDTH=300,r.DEFAULT_WIDTH_OFFSET=2,r.FILE_SCAN_MIN_HEIGHT=300,r.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,r.MIN_QR_BOX_SIZE=50,r.SHADED_LEFT=1,r.SHADED_RIGHT=2,r.SHADED_TOP=3,r.SHADED_BOTTOM=4,r.SHADED_REGION_ELEMENT_ID="qr-shaded-region",r.VERBOSE=!1,r.BORDER_SHADER_DEFAULT_COLOR="#ffffff",r.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",r}(i8),T8=function(){function e(r,t){this.logger=t,this.fps=rn.SCAN_DEFAULT_FPS,r?(r.fps&&(this.fps=r.fps),this.disableFlip=r.disableFlip===!0,this.qrbox=r.qrbox,this.aspectRatio=r.aspectRatio,this.videoConstraints=r.videoConstraints):this.disableFlip=rn.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Xu.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!fi(this.qrbox)},e.create=function(r,t){return new e(r,t)},e}(),Lo=function(){function e(r,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(r))throw"HTML Element with id=".concat(r," not found");this.elementId=r,this.verbose=!1;var n;typeof t=="boolean"?this.verbose=t===!0:t&&(n=t,this.verbose=n.verbose===!0,n.experimentalFeatures),this.logger=new o8(this.verbose),this.qrcode=new u8(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(n),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=S8.create()}return e.prototype.start=function(r,t,n,s){var c=this;if(!r)throw"cameraIdOrConfig is required";if(!n||typeof n!="function")throw"qrCodeSuccessCallback is required and should be a function.";var h;s?h=s:h=this.verbose?this.logger.log:function(){};var d=T8.create(t,this.logger);this.clearElement();var m=!1;d.videoConstraints&&(d.isMediaStreamConstraintsValid()?m=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var g=m,v=document.getElementById(this.elementId);v.clientWidth?v.clientWidth:rn.DEFAULT_WIDTH,v.style.position="relative",this.shouldScan=!0,this.element=v;var _=this,C=this.stateManagerProxy.startTransition(Lr.SCANNING);return new Promise(function(T,N){var S=g?d.videoConstraints:_.createVideoConstraints(r);if(!S){C.cancel(),N("videoConstraints should be defined");return}var D={};(!g||d.aspectRatio)&&(D.aspectRatio=d.aspectRatio);var U={onRenderSurfaceReady:function(X,O){_.setupUi(X,O,d),_.isScanning=!0,_.foreverScan(d,n,h)}};v8.failIfNotSupported().then(function(X){X.create(S).then(function(O){return O.render(c.element,D,U).then(function(q){_.renderedCamera=q,C.execute(),T(null)}).catch(function(q){C.cancel(),N(q)})}).catch(function(O){C.cancel(),N(Us.errorGettingUserMedia(O))})}).catch(function(X){C.cancel(),N(Us.cameraStreamingNotSupported())})})},e.prototype.pause=function(r){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Lr.PAUSED),this.showPausedState(),(fi(r)||r!==!0)&&(r=!1),r&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var r=this,t=function(){r.stateManagerProxy.directTransition(Lr.SCANNING),r.hidePausedState()};if(!this.renderedCamera.isPaused()){t();return}this.renderedCamera.resume(function(){t()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var r=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(Lr.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var n=function(){if(r.element){var c=document.getElementById(rn.SHADED_REGION_ELEMENT_ID);c&&r.element.removeChild(c)}},s=this;return this.renderedCamera.close().then(function(){return s.renderedCamera=null,s.element&&(s.element.removeChild(s.canvasElement),s.canvasElement=null),n(),s.qrRegion&&(s.qrRegion=null),s.context&&(s.context=null),t.execute(),s.hidePausedState(),s.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(r,t){return this.scanFileV2(r,t).then(function(n){return n.decodedText})},e.prototype.scanFileV2=function(r,t){var n=this;if(!r||!(r instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(fi(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(s,c){n.possiblyCloseLastScanImageFile(),n.clearElement(),n.lastScanImageFile=URL.createObjectURL(r);var h=new Image;h.onload=function(){var d=h.width,m=h.height,g=document.getElementById(n.elementId),v=g.clientWidth?g.clientWidth:rn.DEFAULT_WIDTH,_=Math.max(g.clientHeight?g.clientHeight:m,rn.FILE_SCAN_MIN_HEIGHT),C=n.computeCanvasDrawConfig(d,m,v,_);if(t){var T=n.createCanvasElement(v,_,"qr-canvas-visible");T.style.display="inline-block",g.appendChild(T);var N=T.getContext("2d");if(!N)throw"Unable to get 2d context from canvas";N.canvas.width=v,N.canvas.height=_,N.drawImage(h,0,0,d,m,C.x,C.y,C.width,C.height)}var S=rn.FILE_SCAN_HIDDEN_CANVAS_PADDING,D=Math.max(h.width,C.width),U=Math.max(h.height,C.height),X=D+2*S,O=U+2*S,q=n.createCanvasElement(X,O);g.appendChild(q);var oe=q.getContext("2d");if(!oe)throw"Unable to get 2d context from canvas";oe.canvas.width=X,oe.canvas.height=O,oe.drawImage(h,0,0,d,m,S,S,D,U);try{n.qrcode.decodeRobustlyAsync(q).then(function(J){s(C1.createFromQrcodeResult(J))}).catch(c)}catch(J){c("QR code parse error, error = ".concat(J))}},h.onerror=c,h.onabort=c,h.onstalled=c,h.onsuspend=c,h.src=URL.createObjectURL(r)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return _8.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(r){if(r){if(!Xu.isMediaStreamConstraintsValid(r,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(r)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(r){var t=[ct.QR_CODE,ct.AZTEC,ct.CODABAR,ct.CODE_39,ct.CODE_93,ct.CODE_128,ct.DATA_MATRIX,ct.MAXICODE,ct.ITF,ct.EAN_13,ct.EAN_8,ct.PDF_417,ct.RSS_14,ct.RSS_EXPANDED,ct.UPC_A,ct.UPC_E,ct.UPC_EAN_EXTENSION];if(!r||typeof r=="boolean"||!r.formatsToSupport)return t;if(!Array.isArray(r.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(r.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var n=[],s=0,c=r.formatsToSupport;s<c.length;s++){var h=c[s];n8(h)?n.push(h):this.logger.warn("Invalid format: ".concat(h," passed in config, ignoring."))}if(n.length===0)throw"None of formatsToSupport match supported values.";return n},e.prototype.getUseBarCodeDetectorIfSupported=function(r){if(fi(r))return!0;if(!fi(r.useBarCodeDetectorIfSupported))return r.useBarCodeDetectorIfSupported!==!1;if(fi(r.experimentalFeatures))return!0;var t=r.experimentalFeatures;return fi(t.useBarCodeDetectorIfSupported)?!0:t.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(r,t,n){var s=this,c=n.qrbox;this.validateQrboxConfig(c);var h=this.toQrdimensions(r,t,c),d=function(g){if(g<rn.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(rn.MIN_QR_BOX_SIZE,"px.")},m=function(g){return g>r&&(s.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),g=r),g};d(h.width),d(h.height),h.width=m(h.width)},e.prototype.validateQrboxConfig=function(r){if(typeof r!="number"&&typeof r!="function"&&(r.width===void 0||r.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(r,t,n){if(typeof n=="number")return{width:n,height:n};if(typeof n=="function")try{return n(r,t)}catch(s){throw new Error("qrbox config was passed as a function but it failed with unknown error"+s)}return n},e.prototype.setupUi=function(r,t,n){n.isShadedBoxEnabled()&&this.validateQrboxSize(r,t,n);var s=fi(n.qrbox)?{width:r,height:t}:n.qrbox;this.validateQrboxConfig(s);var c=this.toQrdimensions(r,t,s);c.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var h=n.isShadedBoxEnabled()&&c.height<=t,d={x:0,y:0,width:r,height:t},m=h?this.getShadedRegionBounds(r,t,c):d,g=this.createCanvasElement(m.width,m.height),v={willReadFrequently:!0},_=g.getContext("2d",v);_.canvas.width=m.width,_.canvas.height=m.height,this.element.append(g),h&&this.possiblyInsertShadingElement(this.element,r,t,c),this.createScannerPausedUiElement(this.element),this.qrRegion=m,this.context=_,this.canvasElement=g},e.prototype.createScannerPausedUiElement=function(r){var t=document.createElement("div");t.innerText=Us.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",r.appendChild(t),this.scannerPausedUiElement=t},e.prototype.scanContext=function(r,t){var n=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(s){return r(s.text,C1.createFromQrcodeResult(s)),n.possiblyUpdateShaders(!0),!0}).catch(function(s){n.possiblyUpdateShaders(!1);var c=Us.codeParseError(s);return t(c,s8.createFrom(c)),!1})},e.prototype.foreverScan=function(r,t,n){var s=this;if(this.shouldScan&&this.renderedCamera){var c=this.renderedCamera.getSurface(),h=c.videoWidth/c.clientWidth,d=c.videoHeight/c.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var m=this.qrRegion.width*h,g=this.qrRegion.height*d,v=this.qrRegion.x*h,_=this.qrRegion.y*d;this.context.drawImage(c,v,_,m,g,0,0,this.qrRegion.width,this.qrRegion.height);var C=function(){s.foreverScanTimeout=setTimeout(function(){s.foreverScan(r,t,n)},s.getTimeoutFps(r.fps))};this.scanContext(t,n).then(function(T){!T&&r.disableFlip!==!0?(s.context.translate(s.context.canvas.width,0),s.context.scale(-1,1),s.scanContext(t,n).finally(function(){C()})):C()}).catch(function(T){s.logger.logError("Error happend while scanning context",T),C()})}},e.prototype.createVideoConstraints=function(r){if(typeof r=="string")return{deviceId:{exact:r}};if(typeof r=="object"){var t="facingMode",n="deviceId",s={user:!0,environment:!0},c="exact",h=function(N){if(N in s)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(N,"'")},d=Object.keys(r);if(d.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(d.length," keys");var m=Object.keys(r)[0];if(m!==t&&m!==n)throw"Only '".concat(t,"' and '").concat(n,"' ")+" are supported for 'cameraIdOrConfig'";if(m===t){var g=r.facingMode;if(typeof g=="string"){if(h(g))return{facingMode:g}}else if(typeof g=="object")if(c in g){if(h(g["".concat(c)]))return{facingMode:{exact:g["".concat(c)]}}}else throw"'facingMode' should be string or object with"+" ".concat(c," as key.");else{var v=typeof g;throw"Invalid type of 'facingMode' = ".concat(v)}}else{var _=r.deviceId;if(typeof _=="string")return{deviceId:_};if(typeof _=="object"){if(c in _)return{deviceId:{exact:_["".concat(c)]}};throw"'deviceId' should be string or object with"+" ".concat(c," as key.")}else{var C=typeof _;throw"Invalid type of 'deviceId' = ".concat(C)}}}var T=typeof r;throw"Invalid type of 'cameraIdOrConfig' = ".concat(T)},e.prototype.computeCanvasDrawConfig=function(r,t,n,s){if(r<=n&&t<=s){var c=(n-r)/2,h=(s-t)/2;return{x:c,y:h,width:r,height:t}}else{var d=r,m=t;return r>n&&(t=n/r*t,r=n),t>s&&(r=s/t*r,t=s),this.logger.log("Image downsampled from "+"".concat(d,"X").concat(m)+" to ".concat(r,"X").concat(t,".")),this.computeCanvasDrawConfig(r,t,n,s)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var r=document.getElementById(this.elementId);r&&(r.innerHTML="")},e.prototype.possiblyUpdateShaders=function(r){this.qrMatch!==r&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=r?rn.BORDER_SHADER_MATCH_COLOR:rn.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=r)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(r,t,n){var s=r,c=t,h=document.createElement("canvas");return h.style.width="".concat(s,"px"),h.style.height="".concat(c,"px"),h.style.display="none",h.id=fi(n)?"qr-canvas":n,h},e.prototype.getShadedRegionBounds=function(r,t,n){if(n.width>r||n.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(r-n.width)/2,y:(t-n.height)/2,width:n.width,height:n.height}},e.prototype.possiblyInsertShadingElement=function(r,t,n,s){if(!(t-s.width<1||n-s.height<1)){var c=document.createElement("div");c.style.position="absolute";var h=(t-s.width)/2,d=(n-s.height)/2;if(c.style.borderLeft="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderRight="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderTop="".concat(d,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderBottom="".concat(d,"px solid rgba(0, 0, 0, 0.48)"),c.style.boxSizing="border-box",c.style.top="0px",c.style.bottom="0px",c.style.left="0px",c.style.right="0px",c.id="".concat(rn.SHADED_REGION_ELEMENT_ID),t-s.width<11||n-s.height<11)this.hasBorderShaders=!1;else{var m=5,g=40;this.insertShaderBorders(c,g,m,-m,null,0,!0),this.insertShaderBorders(c,g,m,-m,null,0,!1),this.insertShaderBorders(c,g,m,null,-m,0,!0),this.insertShaderBorders(c,g,m,null,-m,0,!1),this.insertShaderBorders(c,m,g+m,-m,null,-m,!0),this.insertShaderBorders(c,m,g+m,null,-m,-m,!0),this.insertShaderBorders(c,m,g+m,-m,null,-m,!1),this.insertShaderBorders(c,m,g+m,null,-m,-m,!1),this.hasBorderShaders=!0}r.append(c)}},e.prototype.insertShaderBorders=function(r,t,n,s,c,h,d){var m=document.createElement("div");m.style.position="absolute",m.style.backgroundColor=rn.BORDER_SHADER_DEFAULT_COLOR,m.style.width="".concat(t,"px"),m.style.height="".concat(n,"px"),s!==null&&(m.style.top="".concat(s,"px")),c!==null&&(m.style.bottom="".concat(c,"px")),d?m.style.left="".concat(h,"px"):m.style.right="".concat(h,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(m),r.appendChild(m)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(r){return 1e3/r},e}(),O1;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(O1||(O1={}));function oA({isOpen:e,onClose:r,initialBarcode:t}){var no;const[n,s]=je.useState(new Date);je.useEffect(()=>{const E=setInterval(()=>{const B=new Date;(B.getDate()!==n.getDate()||B.getMonth()!==n.getMonth())&&s(B)},1e4);return()=>clearInterval(E)},[n]);const c=je.useMemo(()=>{const E=n,B=E.getFullYear(),Z=String(E.getMonth()+1).padStart(2,"0"),de=String(E.getDate()).padStart(2,"0");return`${B}-${Z}-${de}`},[n]),h=je.useMemo(()=>{const E=n,B=E.getFullYear(),Z=String(E.getMonth()+1).padStart(2,"0");return`${B}-${Z}`},[n]),[d,m]=je.useState(!1),[g,v]=je.useState(!1),[_,C]=je.useState(""),[T,N]=je.useState(""),S=(E,B)=>{C(E),N(B),v(!0)},[D,U]=je.useState(null),[X,O]=je.useState(""),[q,oe]=je.useState(null),[J,M]=je.useState(!1),ie=async E=>{if(!(!(A!=null&&A.uid)||!E)){M(!0),oe(null);try{const B=Kt(ut,"users",A.uid,"dailySales"),Z=tr(B,_t("date","==",E)),de=await Fr(Z);let Se=0,Fe=0,Ue=0,Ne=0;de.forEach(se=>{const ye=se.data(),we=Number(ye.quantity||1);Se++,Fe+=Number(ye.sellingPrice||0)*we,Ue+=Number(ye.wholesalePrice||0)*we,Ne+=Number(ye.profit||0)}),oe({count:Se,sales:Fe,cost:Ue,profit:Ne})}catch(B){console.error(B),Te({title:"خطأ",description:"فشل جلب التقارير",variant:"destructive"})}finally{M(!1)}}},[j,Ee]=je.useState([]),[he,te]=je.useState(""),[be,$e]=je.useState(""),ae=async()=>{if(A!=null&&A.uid){if(!he&&!be){Te({title:"تنبيه",description:"يرجى اختيار تاريخ للبحث",variant:"destructive"});return}try{const E=ze||(Y==null?void 0:Y.shopId)||null,B=tr(Kt(ut,"users",A.uid,"dailySales"),...E?[_t("shopId","==",E)]:[],...he?[_t("date",">=",he)]:[],...be?[_t("date","<=",be)]:[]);let Z=tr(Kt(ut,"dailySales"),_t("userId","==",A.uid),...E?[_t("shopId","==",E)]:[]);he&&(Z=tr(Z,_t("date",">=",he))),be&&(Z=tr(Z,_t("date","<=",be)));let de=[],Se=[];try{Se=(await Fr(B)).docs}catch(se){console.warn("Sub-collection query failed",se)}try{de=(await Fr(Z)).docs}catch(se){console.warn("Root collection indexed query failed (likely missing index). Falling back to basic fetch.",se);try{const ye=tr(Kt(ut,"dailySales"),_t("userId","==",A.uid),...E?[_t("shopId","==",E)]:[],sd("date","desc"),es(1e3)),we=tr(Kt(ut,"dailySales"),_t("userId","==",A.uid),...E?[_t("shopId","==",E)]:[],es(2e3));de=(await Fr(we)).docs.filter(ke=>{const Ie=ke.data();return!(he&&Ie.date<he||be&&Ie.date>be)})}catch(ye){console.error("Fallback query also failed",ye)}}const Fe=[...de,...Se];if(Fe.length===0){Ee([]),Te({title:"بحث",description:"لم يتم العثور على نتائج"});return}const Ue=new Map;Fe.forEach(se=>{const ye=se.data(),we=ye.clientId||se.id;Ue.has(we)||Ue.set(we,{...ye,firestoreId:se.id})});const Ne=Array.from(Ue.values()).map(se=>{var ye,we;return{id:se.clientId||se.firestoreId,productName:se.productName,price:Number(se.sellingPrice||0),wholesalePrice:Number(se.wholesalePrice||0),quantity:Number(se.quantity||0),date:se.date,time:se.time,serialNumber:se.serialNumber,barcode:se.barcode,performedByType:se.performedByType,performedByName:se.performedByName,performedByUsername:se.performedByUsername,isDeferred:!!se.isDeferred,customerName:se.customerName,customerMobile:se.customerMobile,customerId:se.customerId,firestoreId:se.firestoreId,cartItems:se.cartItems,createdAtMs:(we=(ye=se.createdAt)==null?void 0:ye.toDate)!=null&&we.call(ye)?se.createdAt.toDate().getTime():0,transactionReference:se.reference}});Ne.sort((se,ye)=>se.date!==ye.date?ye.date.localeCompare(se.date):(ye.time||"").localeCompare(se.time||"")),Ee(Ne),Te({title:"تم البحث",description:`تم العثور على ${Ne.length} عملية بيع`})}catch(E){console.error("Search error:",E),Te({title:"خطأ",description:"حدث خطأ أثناء البحث",variant:"destructive"})}}},tt=()=>{te(""),$e(""),Hn()},[Re,Ut]=je.useState(null),[fe,ot]=je.useState({productName:"",price:"",wholesalePrice:"",quantity:"",barcode:"",serialNumber:""}),[pt,K]=je.useState(!1),[ce,ee]=je.useState(null),[ne,le]=je.useState(!1),[qe,Le]=je.useState(null),[Pe,Be]=je.useState({productName:"",price:"",wholesalePrice:"",quantity:"",barcode:"",serialNumber:""}),{toast:Te}=qu(),{user:A,profile:Y}=Zu(),{isShiftActive:ht,shiftUser:lt}=Ju(),{shopId:ze}=Qu(),[Me,ft]=je.useState([]),[Et,Kr]=je.useState({}),[st,An]=je.useState({}),[ln,Dr]=je.useState({}),[xa,Or]=je.useState(""),[$n,Ar]=je.useState(!1),[Yt,St]=je.useState({}),[cr,sa]=je.useState(!1),[Mt,Qe]=je.useState(""),[br,ar]=je.useState(""),[pr,Mn]=je.useState(""),[fn,vi]=je.useState(!1),[Bt,Ya]=je.useState(""),Ua=$i.useRef(null),Hi=Object.values(Yt).reduce((E,B)=>E+(Number(B)||0),0),[oa,yi]=je.useState(!1),[Er,Ka]=je.useState(!1),[Pn,Wa]=je.useState(!1),[ya,ta]=je.useState({productName:"",price:"",wholesalePrice:"",quantity:"1",barcode:"",serialNumber:""}),[bn,qr]=je.useState(""),[Oa,F]=je.useState(""),[P,L]=je.useState(!1),W=()=>{const B=(Date.now().toString().slice(-9)+Math.floor(Math.random()*1e3).toString().padStart(3,"0")).slice(0,12);ot(Z=>({...Z,barcode:B}))},H=async()=>{window.JsBarcode||await new Promise((E,B)=>{const Z=document.createElement("script");Z.src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js",Z.onload=()=>E(),Z.onerror=()=>B(new Error("Failed to load JsBarcode")),document.head.appendChild(Z)})},z=async E=>{const B=`https://bwipjs-api.metafloor.com/?bcid=code128&text=${encodeURIComponent(E)}&scale=3&height=10&includetext=1`,de=await(await fetch(B,{cache:"no-store"})).blob();return await new Promise((Se,Fe)=>{const Ue=new FileReader;Ue.onloadend=()=>Se(Ue.result||""),Ue.onerror=Ne=>Fe(Ne),Ue.readAsDataURL(de)})};je.useEffect(()=>{const E=(fe.barcode||"").trim();if(!E){F(""),qr("");return}L(!0),(async()=>{try{if(await H(),!window.JsBarcode)throw new Error("JsBarcode unavailable");const B=document.createElementNS("http://www.w3.org/2000/svg","svg");window.JsBarcode(B,E,{format:"CODE128",displayValue:!0,fontSize:12,height:70,margin:0});const Z=new XMLSerializer().serializeToString(B),de="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(Z)));F(de),qr("")}catch(B){console.warn("JsBarcode failed, using bwip fallback",B);try{const Z=await z(E);F(Z),qr("")}catch(Z){console.error("barcode fallback error",Z),F("")}}finally{L(!1)}})()},[fe.barcode]);const me=E=>(E||"").replace(/[&<>]/g,B=>({"&":"&amp;","<":"&lt;",">":"&gt;"})[B]),De=()=>{if(!(fe.barcode||"").trim()||!(Oa||bn)){Te({title:"الباركود مطلوب",description:"أنشئ باركود أو أدخله قبل الطباعة",variant:"destructive"});return}try{const B=Oa||bn,Z=window.open("","PRINT","width=600,height=400");Z==null||Z.document.write(`
      <html dir="rtl">
        <head>
          <meta charset="utf-8" />
          <title>طباعة باركود</title>
          <style>
            @page { size: 50mm 30mm; margin: 4mm; }
            body { margin: 0; padding: 0; font-family: system-ui, sans-serif; }
            .label { width: 100%; height: 100%; display:flex; flex-direction:column; align-items:center; justify-content:center; }
            .name { font-size: 12px; margin-bottom: 6px; }
            img { width: 100%; height: auto; }
          </style>
        </head>
        <body>
          <div class="label">
            <div class="name">${me(fe.productName||"")}</div>
            <img src="${B}" alt="barcode" />
          </div>
          <script>setTimeout(() => window.print(), 150);<\/script>
        </body>
      </html>
    `),Z==null||Z.document.close()}catch(B){console.error(B),Te({title:"فشل الطباعة",description:"تعذّر فتح نافذة الطباعة",variant:"destructive"})}},[xe,pe]=je.useState(!1),[ve,We]=je.useState(""),He=$i.useRef(null),Ye="barcode-scanner-container",Je=async()=>{try{const E=ct,B=await Lo.getCameras();if(!B||B.length===0)throw new Error("لا توجد كاميرات متاحة");const de=(B.find(Se=>/back|rear|خلف/i.test(Se.label))||B[B.length-1]).id;He.current=new Lo(Ye),await He.current.start(de,{fps:10,qrbox:{width:250,height:120},formatsToSupport:[E.CODE_128,E.EAN_13,E.EAN_8,E.CODE_39]},Se=>{ot(Fe=>({...Fe,barcode:Se})),nt()},()=>{})}catch(E){console.error("scanner start error",E),We((E==null?void 0:E.message)||"تعذّر بدء الكاميرا")}},nt=async()=>{try{He.current&&(await He.current.stop(),await He.current.clear(),He.current=null)}catch(E){console.warn("scanner stop warn",E)}pe(!1)};je.useEffect(()=>()=>{He.current&&(He.current.stop().catch(()=>{}),He.current.clear().catch(()=>{}),He.current=null)},[]);const[vt,Ce]=je.useState(!0);je.useEffect(()=>{e&&Ce(!0)},[e]);const[lr,Ft]=je.useState(!1),ga=$i.useRef(""),Bn=$i.useRef(0),[Ot,It]=je.useState(0),[Nt,ra]=je.useState(0),[Qs,Ln]=je.useState(!1),[Rr,Va]=je.useState(!1),[ma,Sr]=je.useState(!0),hn=$i.useRef(0),K0=$i.useRef(0);je.useEffect(()=>{e&&Sr(!0)},[e]);const[jn,dr]=je.useState(!1),[ca,ge]=je.useState(!1),[V,dt]=je.useState(!0),[aa,qa]=je.useState(!0),[hc,Gi]=je.useState(!1),[Ra,xt]=je.useState("day"),[wr,Es]=je.useState({}),[$s,Xi]=je.useState(!1),[_s,e0]=je.useState("التحقق قبل العملية"),[uc,Zr]=je.useState("أدخل الرقم السري الرئيسي للمتابعة"),ei=$i.useRef(null),vr=(E,B,Z)=>{e0(E),Zr(B),ei.current=Z,Xi(!0)},[yt,dc]=je.useState([]),[Lt,Jr]=je.useState(0);je.useEffect(()=>{if(A!=null&&A.uid){const E=`inventoryOffset_v4_${A.uid}`,B=localStorage.getItem(E);B&&Jr(Number(B))}},[A==null?void 0:A.uid]);const xc=E=>{A!=null&&A.uid&&localStorage.setItem(`inventoryOffset_v4_${A.uid}`,String(E))},t0=()=>{vr("إخفاء إجمالي المخزون","هل تريد تصفير عداد إجمالي المخزون مؤقتاً؟",async()=>{const E=Me.reduce((B,Z)=>B+(Number(Z.wholesalePrice)||0)*(Number(Z.quantity)||0),0);Jr(E),xc(E),Te({title:"تم التصفير",description:"تم تصفير عداد المخزون مؤقتاً"})})},[As,Un]=je.useState([]),[Ei,_i]=je.useState(null),[zi,ti]=je.useState(!1),[bs,Ai]=je.useState("");je.useEffect(()=>{if(!(A!=null&&A.uid))return;const E=(Y==null?void 0:Y.shopId)||ze||null;try{const de=E?`categories_${A.uid}_${E}`:`categories_${A.uid}_main`,Se=localStorage.getItem(de),Fe=Se?JSON.parse(Se):[];Array.isArray(Fe)&&Fe.length>0&&Un(Fe)}catch{}const B=E?tr(Kt(ut,"categories"),_t("shopId","==",E)):tr(Kt(ut,"categories"),_t("userId","==",A.uid)),Z=Ec(B,de=>{const Se=de.docs.map(Ne=>{var ye,we;const se=Ne.data();return{id:Ne.id,name:String(se.name||""),shopId:se.shopId||E||void 0,createdAt:((we=(ye=se.createdAt)==null?void 0:ye.toDate)==null?void 0:we.call(ye))||new Date}}),Fe=new Map;for(const Ne of Se)Fe.set(Ne.id,Ne);const Ue=Array.from(Fe.values()).sort((Ne,se)=>{const ye=new Date(String(Ne.createdAt||"")).getTime(),we=new Date(String(se.createdAt||"")).getTime();return ye-we});Un(Ue);try{const Ne=E?`categories_${A.uid}_${E}`:`categories_${A.uid}_main`;localStorage.setItem(Ne,JSON.stringify(Ue))}catch{}});return()=>Z()},[A==null?void 0:A.uid,Y==null?void 0:Y.shopId,ze]);const Yi=async()=>{if(bs.trim())try{await Fs(Kt(ut,"categories"),{name:bs.trim(),shopId:(Y==null?void 0:Y.shopId)||ze||void 0,userId:(A==null?void 0:A.uid)||void 0,createdAt:ba()}),Ai(""),ti(!1),Te({title:"تمت الإضافة",description:"تم إضافة القسم بنجاح"})}catch(E){console.error(E),Te({title:"خطأ",description:"فشل إضافة القسم",variant:"destructive"})}},Ea=async(E,B)=>{B.stopPropagation(),vr("حذف القسم","أدخل الرقم السري الرئيسي لحذف هذا القسم",()=>{U(E)})},q0=async()=>{if(D)try{await Di(fa(ut,"categories",D)),Te({title:"تم الحذف",description:"تم حذف القسم بنجاح"})}catch(E){console.error(E),Te({title:"خطأ",description:"فشل حذف القسم",variant:"destructive"})}finally{U(null)}},[Z0,ri]=je.useState(!1),[J0,gc]=je.useState(""),[Q0,nr]=je.useState(""),[r0,Ki]=je.useState(""),[Wn,a0]=je.useState(null);je.useEffect(()=>{(async()=>{try{if(!e||!(A!=null&&A.uid))return;const E=await Xn.getUserData(A.uid),B=Array.isArray(E==null?void 0:E.customers)?E.customers.map(Z=>({id:String(Z.id||""),name:String(Z.name||""),mobile:Z.mobile||void 0})):[];dc(B)}catch{}})()},[e,A==null?void 0:A.uid]);const[_e,Rt]=je.useState(!1),[Cr,Ss]=je.useState(null),[ai,mc]=je.useState(null),Cs=(E,B)=>{Ss(E),mc(B),Rt(!0)},[ni,qi]=je.useState(null),[Vr,Zi]=je.useState(!1),[_r,Ts]=je.useState(""),Sn=E=>E.replace(/[\u0660-\u0669]/g,B=>String("0123456789"["٠١٢٣٤٥٦٧٨٩".indexOf(B)])),ir=je.useMemo(()=>{const E=_r.trim(),B=E.toLowerCase(),Z=new Map;for(const Ue of Me){const Ne=Z.get(Ue.id);if(!Ne)Z.set(Ue.id,Ue);else{const se=new Date(Ne.updatedAt||"").getTime(),ye=new Date(Ue.updatedAt||"").getTime();Z.set(Ue.id,isFinite(se)&&isFinite(ye)?ye>=se?Ue:Ne:Ue)}}let de=Array.from(Z.values());if(!B)return de;const Se=Sn(E);return/^[0-9]+$/.test(Se)?de.filter(Ue=>String(Ue.barcode||"")===Se):de.filter(Ue=>(Ue.name||"").toLowerCase().includes(B))},[Me,_r]),[gt,$0]=je.useState({}),[yr,un]=je.useState(!1),[Ma,pc]=je.useState(null),[Za,bi]=je.useState("1"),Ns=E=>{pc(E),bi("1"),un(!0)},ks=()=>{if(!Ma)return;const E=parseInt(Za);E>0&&(un(!1),vr("إضافة مخزون",`إضافة ${E} قطع للمنتج ${Ma.name}`,async()=>{try{const B=Ma.quantity+E;await tn(fa(ut,"products",Ma.id),{quantity:B,updatedAt:ba()}),ft(Z=>Z.map(de=>de.id===Ma.id?{...de,quantity:B}:de)),Te({title:"تمت الإضافة",description:`تمت إضافة ${E} قطعة`})}catch(B){console.error(B)}}))};je.useEffect(()=>{e&&(A!=null&&A.uid)&&(Hn(),ma||si())},[e,A==null?void 0:A.uid,ma]),je.useEffect(()=>{const E=B=>{var Z;try{const de=!!((Z=B==null?void 0:B.detail)!=null&&Z.enabled);Sr(de)}catch{}};return window.addEventListener("monthlyReportsLockChanged",E),()=>window.removeEventListener("monthlyReportsLockChanged",E)},[]),je.useEffect(()=>{if(!e)return;const E=B=>{var Ue;const Z=B.target,de=(Ue=Z==null?void 0:Z.tagName)==null?void 0:Ue.toLowerCase();if(de==="input"||de==="textarea"||!!(Z&&Z.isContentEditable)||$s||Rr||lr)return;const Fe=Date.now();if(B.key==="Enter"){const Ne=(ga.current||"").trim();ga.current="",Ne&&l(Ne);return}B.key.length===1&&(Fe-(Bn.current||0)>100&&(ga.current=""),ga.current+=B.key,Bn.current=Fe)};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[e,Me,$s,Rr,lr]),je.useEffect(()=>{e&&t&&l(t)},[e,t]);const eo=async()=>{var Fe,Ue;if(!(A!=null&&A.uid))return;const E=(Y==null?void 0:Y.shopId)||ze||"main",B=`shopProducts_${A.uid}_${E}`,Z=`shopProducts_lastSync_${A.uid}_${E}`;let de=[],Se=null;try{const Ne=localStorage.getItem(B);if(Ne){const ye=JSON.parse(Ne);Array.isArray(ye)&&ye.length>0&&(de=ye,ft(de))}const se=localStorage.getItem(Z);se&&(Se=new Date(se))}catch(Ne){console.warn("Failed to load products from cache",Ne)}try{const Ne=[_t("userId","==",A.uid),...E?[_t("shopId","==",E)]:[]],se=tr(Kt(ut,"products"),...Ne,es(2e3)),ye=await Fr(se),we=ye.docs.map(Ie=>{var wt,At,et;return{id:Ie.id,name:String(Ie.data().name??""),sellingPrice:Number(Ie.data().sellingPrice??0),wholesalePrice:Number(Ie.data().wholesalePrice??0),quantity:Number(Ie.data().quantity??0),barcode:String(Ie.data().barcode??""),serialNumber:String(Ie.data().serialNumber??""),categoryId:Ie.data().categoryId||void 0,supplierName:Ie.data().supplierName||void 0,updatedAt:((et=(At=(wt=Ie.data().updatedAt)==null?void 0:wt.toDate)==null?void 0:At.call(wt))==null?void 0:et.toISOString())||new Date().toISOString()}}),Ge=new Map(de.map(Ie=>[Ie.id,Ie]));we.forEach(Ie=>{Ge.set(Ie.id,Ie)});const ke=Array.from(Ge.values());ke.sort((Ie,wt)=>new Date(String(Ie.updatedAt||"")).getTime()-new Date(String(wt.updatedAt||"")).getTime()),ft(ke);try{if(localStorage.setItem(B,JSON.stringify(ke)),we.length>0){const Ie=we[we.length-1].updatedAt;localStorage.setItem(Z,Ie)}}catch{}Y!=null&&Y.shopId&&we.length>0&&we.filter(wt=>{var et;const At=(et=ye.docs.find(Dt=>Dt.id===wt.id))==null?void 0:et.data();return!(At!=null&&At.shopId)}).length>0}catch(Ne){if((Ne==null?void 0:Ne.code)==="failed-precondition"||(Fe=Ne==null?void 0:Ne.message)!=null&&Fe.includes("index")){const se=[_t("userId","==",A.uid),...Y!=null&&Y.shopId?[_t("shopId","==",Y.shopId)]:[]],ye=tr(Kt(ut,"products"),...se,es(2e3));let Ge=(await Fr(ye)).docs.map(ke=>{var Ie,wt,At;return{id:ke.id,name:String(ke.data().name??""),sellingPrice:Number(ke.data().sellingPrice??0),wholesalePrice:Number(ke.data().wholesalePrice??0),quantity:Number(ke.data().quantity??0),barcode:String(ke.data().barcode??""),serialNumber:String(ke.data().serialNumber??""),categoryId:ke.data().categoryId||void 0,supplierName:ke.data().supplierName||void 0,updatedAt:((At=(wt=(Ie=ke.data().updatedAt)==null?void 0:Ie.toDate)==null?void 0:wt.call(Ie))==null?void 0:At.toISOString())||new Date().toISOString()}});if(Se){const ke=Se.getTime();Ge=Ge.filter(Ie=>{const wt=new Date(Ie.updatedAt).getTime();return isFinite(wt)?wt>ke:!0})}Ge=Ge.sort((ke,Ie)=>new Date(ke.updatedAt).getTime()-new Date(Ie.updatedAt).getTime()),ft(Ge);try{localStorage.setItem(B,JSON.stringify(Ge));const ke=((Ue=Ge[Ge.length-1])==null?void 0:Ue.updatedAt)||new Date().toISOString();localStorage.setItem(Z,ke)}catch{}}else console.error("Error loading shop products with sync:",Ne)}};je.useEffect(()=>{e&&(A!=null&&A.uid)&&(eo(),si(),Hn(),Qa())},[e,A==null?void 0:A.uid,Y==null?void 0:Y.shopId,h]),je.useEffect(()=>{if(!e||!(A!=null&&A.uid))return;const E=ze||(Y==null?void 0:Y.shopId)||null,B=new Date().toISOString().split("T")[0],Z={current:""},de=(Ue,Ne)=>{var ye,we;const se=Ue;return{id:String(se.clientId||Ne),firestoreId:Ne,productName:String(se.productName||""),price:Number(se.sellingPrice||0),wholesalePrice:se.wholesalePrice!==void 0?Number(se.wholesalePrice):null,quantity:Number(se.quantity||0),date:String(se.date||B),time:String(se.time||""),serialNumber:se.serialNumber||void 0,barcode:se.barcode||void 0,performedByType:se.performedByType||void 0,performedByName:se.performedByName||void 0,performedByUsername:se.performedByUsername||void 0,isDeferred:!!se.isDeferred,paymentMethod:se.paymentMethod==="visa"?"visa":"cash",customerName:se.customerName||void 0,customerMobile:se.customerMobile||void 0,customerId:se.customerId||void 0,createdAtMs:(we=(ye=se==null?void 0:se.createdAt)==null?void 0:ye.toDate)!=null&&we.call(ye)?se.createdAt.toDate().getTime():new Date(String(se.date||B)).getTime()}},Se=E?tr(Kt(ut,"dailySales"),_t("shopId","==",E)):tr(Kt(ut,"dailySales"),_t("userId","==",A.uid)),Fe=Ec(Se,Ue=>{let Ne=[];try{const ke=`deletedSaleIds_${A.uid}`,Ie=localStorage.getItem(ke);Ie&&(Ne=JSON.parse(Ie))}catch{}const se=Ue.docs.map(ke=>de(ke.data(),ke.id)).filter(ke=>!Ne.includes(ke.id)&&!Ne.includes(ke.firestoreId||"")),ye=se.map(ke=>`${ke.id}:${ke.createdAtMs}:${ke.quantity}:${ke.price}`).join("|");if(ye===Z.current)return;Z.current=ye;const we={};[...j,...se].forEach(ke=>{we[ke.id]=ke});const Ge=Object.values(we);to(Ge),si()});return()=>{try{Fe()}catch{}}},[e,A==null?void 0:A.uid,Y==null?void 0:Y.shopId,ze]),je.useEffect(()=>{if(!e||!(A!=null&&A.uid))return;const E=(Y==null?void 0:Y.shopId)||ze||void 0,B={current:[]},Z={current:""};try{const ye=`shopProducts_${A.uid}_${E||"main"}`,we=`shopProducts_${A.uid}_main`,Ge=localStorage.getItem(ye),ke=localStorage.getItem(we),Ie=Ge?JSON.parse(Ge):[],wt=ke?JSON.parse(ke):[],At=new Map;[...Array.isArray(Ie)?Ie:[],...Array.isArray(wt)?wt:[]].forEach(Dt=>{Dt&&Dt.id&&At.set(Dt.id,Dt)});const et=Array.from(At.values());et.length>0&&(ft(et),B.current=et)}catch{}const de=E?tr(Kt(ut,"products"),_t("shopId","==",E)):tr(Kt(ut,"products"),_t("userId","==",A.uid));let Se=[],Fe=null;const Ue=()=>{Fe||(Fe=setTimeout(()=>{Fe=null,Ne()},100))},Ne=()=>{var ke;const ye=new Map;for(const Ie of B.current||[])Ie&&Ie.id&&ye.set(Ie.id,Ie);for(const Ie of Se){const wt=ye.get(Ie.id);if(!wt)ye.set(Ie.id,Ie);else{const At=new Date(String(wt.updatedAt||"")).getTime(),et=new Date(String(Ie.updatedAt||"")).getTime();ye.set(Ie.id,isFinite(At)&&isFinite(et)?et>=At?Ie:wt:Ie)}}let we=Array.from(ye.values());we=we.sort((Ie,wt)=>{const At=new Date(String(Ie.updatedAt||"")).getTime(),et=new Date(String(wt.updatedAt||"")).getTime();if(isFinite(et)&&isFinite(At))return et-At;if(isFinite(et))return-1;if(isFinite(At))return 1;const Dt=String(Ie.name||"").toLowerCase(),Qt=String(wt.name||"").toLowerCase();return Dt.localeCompare(Qt)});const Ge=we.map(Ie=>`${Ie.id}:${String(Ie.updatedAt||"")}`).join("|");if(Ge!==Z.current){if(Z.current=Ge,we.length===0){B.current.length>0?ft(B.current):ft([]);return}B.current=we,ft(we);try{const Ie=`shopProducts_${A.uid}_${E||"main"}`;localStorage.setItem(Ie,JSON.stringify(we));const wt=`shopProducts_lastSync_${A.uid}_${E||"main"}`,At=((ke=we[we.length-1])==null?void 0:ke.updatedAt)||new Date().toISOString();localStorage.setItem(wt,At)}catch{}}},se=Ec(de,ye=>{Se=ye.docs.map(we=>{var Ge,ke,Ie;return{id:we.id,name:String(we.data().name??""),sellingPrice:Number(we.data().sellingPrice??0),wholesalePrice:Number(we.data().wholesalePrice??0),quantity:Number(we.data().quantity??0),barcode:String(we.data().barcode??""),serialNumber:String(we.data().serialNumber??""),categoryId:we.data().categoryId||void 0,supplierName:we.data().supplierName||void 0,updatedAt:((Ie=(ke=(Ge=we.data().updatedAt)==null?void 0:Ge.toDate)==null?void 0:ke.call(Ge))==null?void 0:Ie.toISOString())||new Date().toISOString()}}),Ue()});return()=>{try{se()}catch{}if(Fe){try{clearTimeout(Fe)}catch{}Fe=null}}},[e,A==null?void 0:A.uid,Y==null?void 0:Y.shopId,ze]);const dn=()=>{const E=new Date,B=E.getFullYear(),Z=String(E.getMonth()+1).padStart(2,"0"),de=String(E.getDate()).padStart(2,"0");return`${B}-${Z}-${de}`},Vn=E=>{const B=Z=>{if(typeof Z.createdAtMs=="number")return Z.createdAtMs;const de=parseInt(Z.id,10);if(!isNaN(de))return de;const Se=new Date(Z.date);return isNaN(Se.getTime())?0:Se.getTime()};return[...E].sort((Z,de)=>B(de)-B(Z))},Hn=()=>{if(!(A!=null&&A.uid)){console.log("No user authenticated, cannot load sales data");return}let E=[];try{const Ge=`deletedSaleIds_${A.uid}`,ke=localStorage.getItem(Ge);ke&&(E=JSON.parse(ke))}catch{}const B=Ge=>Array.isArray(Ge)?Ge.filter(ke=>!E.includes(ke.id)&&!E.includes(ke.firestoreId||"")):[],Z=ze||(Y==null?void 0:Y.shopId)||"main",de=`salesData_all_${A.uid}_${Z}`,Se=localStorage.getItem(de);if(Se)try{const Ge=JSON.parse(Se),ke=B(Ge);Ee(Vn(ke)),ke.length!==Ge.length&&localStorage.setItem(de,JSON.stringify(ke));return}catch{}const Fe=dn(),Ue=`salesData_${A.uid}_${Z}_${Fe}`,Ne=localStorage.getItem(Ue);if(Ne){const Ge=JSON.parse(Ne),ke=B(Ge),Ie=Vn(ke);Ee(Ie);try{localStorage.setItem(de,JSON.stringify(Ie))}catch{}return}const se=new Date().toISOString().split("T")[0],ye=`salesData_${A.uid}_${Z}_${se}`,we=localStorage.getItem(ye);if(we){const Ge=JSON.parse(we),ke=B(Ge),Ie=Vn(ke);Ee(Ie);try{localStorage.setItem(Ue,JSON.stringify(Ie)),localStorage.setItem(de,JSON.stringify(Ie))}catch{}return}Ji()},ii=E=>{if(!(A!=null&&A.uid)){console.log("No user authenticated, cannot save sales data");return}const B=ze||(Y==null?void 0:Y.shopId)||"main",Z=dn(),de=`salesData_${A.uid}_${B}_${Z}`,Se=`salesData_all_${A.uid}_${B}`,Fe=Vn(E);localStorage.setItem(de,JSON.stringify(Fe));try{const Ue=localStorage.getItem(Se),Ne=Ue?JSON.parse(Ue):[],se={};[...Array.isArray(Ne)?Ne:[],...Fe].forEach(Ge=>{se[Ge.id]=Ge});const ye=Object.values(se),we=Vn(ye);localStorage.setItem(Se,JSON.stringify(we))}catch{}Ee(Fe)},to=E=>{if(!(A!=null&&A.uid)){console.log("No user authenticated, cannot save sales data");return}const B=ze||(Y==null?void 0:Y.shopId)||"main",Z=`salesData_all_${A.uid}_${B}`;try{const Se=localStorage.getItem(Z),Fe=Se?JSON.parse(Se):[],Ue={};[...Array.isArray(Fe)?Fe:[],...E].forEach(ye=>{Ue[ye.id]=ye});const Ne=Object.values(Ue),se=Vn(Ne);localStorage.setItem(Z,JSON.stringify(se))}catch{}const de=Vn(E);Ee(de)},Ji=async()=>{if(A!=null&&A.uid)try{const E=ze||(Y==null?void 0:Y.shopId)||null,B=new Date().toISOString().split("T")[0],Z=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(new Date);let de,Se,Fe,Ue;try{const ke=tr(Kt(ut,"dailySales"),_t("userId","==",A.uid),...E?[_t("shopId","==",E)]:[]);de=await Fr(ke)}catch{}try{const ke=tr(Kt(ut,"dailySales"),_t("userId","==",A.uid));Fe=await Fr(ke)}catch{}try{const ke=tr(Kt(ut,"users",A.uid,"dailySales"),...E?[_t("shopId","==",E)]:[]);Se=await Fr(ke)}catch{}try{const ke=tr(Kt(ut,"users",A.uid,"dailySales"));Ue=await Fr(ke)}catch{}const Ne=[...de?de.docs:[],...Se?Se.docs:[],...Fe?Fe.docs:[],...Ue?Ue.docs:[]];let se=[];try{const ke=`deletedSaleIds_${A.uid}`,Ie=localStorage.getItem(ke);Ie&&(se=JSON.parse(Ie))}catch{}const ye=Ne.map(ke=>{var wt,At;const Ie=ke.data();return{id:String(Ie.clientId||ke.id),firestoreId:ke.id,productName:String(Ie.productName||""),price:Number(Ie.sellingPrice||0),wholesalePrice:Ie.wholesalePrice!==void 0?Number(Ie.wholesalePrice):null,quantity:Number(Ie.quantity||0),date:String(Ie.date||B),time:String(Ie.time||""),serialNumber:Ie.serialNumber||void 0,barcode:Ie.barcode||void 0,performedByType:Ie.performedByType||void 0,performedByName:Ie.performedByName||void 0,performedByUsername:Ie.performedByUsername||void 0,isDeferred:!!Ie.isDeferred,paymentMethod:Ie.paymentMethod==="visa"?"visa":"cash",customerName:Ie.customerName||void 0,customerMobile:Ie.customerMobile||void 0,customerId:Ie.customerId||void 0,createdAtMs:(At=(wt=Ie==null?void 0:Ie.createdAt)==null?void 0:wt.toDate)!=null&&At.call(wt)?Ie.createdAt.toDate().getTime():new Date(String(Ie.date||B)).getTime()}}).filter(ke=>!se.includes(ke.id)&&!se.includes(ke.firestoreId||"")),we={};[...j,...ye].forEach(ke=>{we[ke.id]=ke});const Ge=Object.values(we);to(Ge)}catch{}},si=async()=>{if(A!=null&&A.uid)try{const E=Date.now();if(hn.current&&E<hn.current||E-(K0.current||0)<6e4)return;const B=new Date,Z=new Date(B.getFullYear(),B.getMonth(),1),de=new Date(B.getFullYear(),B.getMonth()+1,0),Se=Ge=>Ge.toISOString().split("T")[0],Fe=Se(Z),Ue=Se(de),Ne=ze||(Y==null?void 0:Y.shopId)||null;let se;try{const Ge=tr(Kt(ut,"dailySales"),_t("userId","==",A.uid),...Ne?[_t("shopId","==",Ne)]:[]);se=await Fr(Ge)}catch{const Ge=tr(Kt(ut,"users",A.uid,"dailySales"),...Ne?[_t("shopId","==",Ne)]:[]);se=await Fr(Ge)}let ye=0,we=0;se.forEach(Ge=>{const ke=Ge.data(),Ie=String(ke.date??"").slice(0,10);if(!ke.isDeferred&&Ie>=Fe&&Ie<=Ue){const wt=Number(ke.sellingPrice??0),At=Number(ke.quantity??0),et=Number(ke.profit??(Number(ke.sellingPrice??0)-Number(ke.wholesalePrice??0))*At);ye+=wt*At,we+=et}}),It(ye),ra(we),K0.current=Date.now()}catch(E){console.error("Error loading monthly stats:",E);try{const B=(E==null?void 0:E.code)||"";String(B)==="resource-exhausted"&&(hn.current=Date.now()+5*60*1e3,Te({title:"تم تجاوز الحصة",description:"تم إيقاف استعلامات تقارير الشهر مؤقتاً لمدة 5 دقائق لتجنب الضغط على الخادم.",variant:"destructive"}))}catch{}}},Ja=async E=>{if(!(A!=null&&A.uid))return null;try{const B=((E.price??0)-(E.wholesalePrice??0))*(E.quantity??0),Z=ht&&lt?"cashier":"admin",de=Z==="cashier"?(lt==null?void 0:lt.name)||"كاشير":(Y==null?void 0:Y.fullName)||(A==null?void 0:A.displayName)||"الحساب الرئيسي",Se=Z==="cashier"&&(lt==null?void 0:lt.username)||null,Fe=await Fs(Kt(ut,"dailySales"),{userId:A.uid,clientId:E.id,productName:E.productName,quantity:E.quantity,wholesalePrice:E.wholesalePrice??null,sellingPrice:E.price,profit:B,date:E.date,time:E.time,performedByType:Z,performedByName:de,performedByUsername:Se,serialNumber:E.serialNumber??null,barcode:E.barcode??null,isDeferred:!!E.isDeferred,paymentMethod:E.paymentMethod||"cash",customerName:E.customerName||null,customerMobile:E.customerMobile||null,customerId:E.customerId||null,...Y!=null&&Y.shopId?{shopId:Y.shopId}:ze?{shopId:ze}:{},...E.cartItems?{cartItems:E.cartItems}:{},createdAt:ba()});try{await tf(fa(ut,"users",A.uid,"dailySales",Fe.id),{userId:A.uid,clientId:E.id,productName:E.productName,quantity:E.quantity,wholesalePrice:E.wholesalePrice??null,sellingPrice:E.price,profit:B,date:E.date,time:E.time,performedByType:Z,performedByName:de,performedByUsername:Se,serialNumber:E.serialNumber??null,barcode:E.barcode??null,isDeferred:!!E.isDeferred,paymentMethod:E.paymentMethod||"cash",customerName:E.customerName||null,customerMobile:E.customerMobile||null,customerId:E.customerId||null,...Y!=null&&Y.shopId?{shopId:Y.shopId}:ze?{shopId:ze}:{},...E.cartItems?{cartItems:E.cartItems}:{},createdAt:ba()})}catch{}return Fe.id}catch{try{const B=await Fs(Kt(ut,"users",A.uid,"dailySales"),{userId:A.uid,clientId:E.id,productName:E.productName,quantity:E.quantity,wholesalePrice:E.wholesalePrice??null,sellingPrice:E.price,profit,date:E.date,time:E.time,performedByType,performedByName,performedByUsername,serialNumber:E.serialNumber??null,barcode:E.barcode??null,isDeferred:!!E.isDeferred,paymentMethod:E.paymentMethod||"cash",customerName:E.customerName||null,customerMobile:E.customerMobile||null,customerId:E.customerId||null,...Y!=null&&Y.shopId?{shopId:Y.shopId}:ze?{shopId:ze}:{},...E.cartItems?{cartItems:E.cartItems}:{},createdAt:ba()});try{await tf(fa(ut,"dailySales",B.id),{userId:A.uid,clientId:E.id,productName:E.productName,quantity:E.quantity,wholesalePrice:E.wholesalePrice??null,sellingPrice:E.price,profit,date:E.date,time:E.time,performedByType,performedByName,performedByUsername,serialNumber:E.serialNumber??null,barcode:E.barcode??null,isDeferred:!!E.isDeferred,paymentMethod:E.paymentMethod||"cash",customerName:E.customerName||null,customerMobile:E.customerMobile||null,customerId:E.customerId||null,...Y!=null&&Y.shopId?{shopId:Y.shopId}:ze?{shopId:ze}:{},...E.cartItems?{cartItems:E.cartItems}:{},createdAt:ba()})}catch{}return B.id}catch(B){return console.error("Error saving sale:",B),null}}},Gn=()=>{const E=ze||(Y==null?void 0:Y.shopId)||"main";return`cashBalance_${(A==null?void 0:A.uid)||"default"}_${E}`},Ha=async(E,B)=>{if(A!=null&&A.uid)try{const Z=fa(ut,"dailySales",E);await tn(Z,B)}catch{try{const Z=fa(ut,"users",A.uid,"dailySales",E);await tn(Z,B)}catch(Z){console.error("Error updating sale:",Z)}}},n0=async E=>{try{const B=E.firestoreId;if(B)await Ha(B,{isDeferred:!1});else try{const Z=tr(Kt(ut,"dailySales"),_t("userId","==",(A==null?void 0:A.uid)||""),_t("date","==",E.date),_t("productName","==",E.productName),es(5)),Se=(await Fr(Z)).docs[0];Se&&await tn(Se.ref,{isDeferred:!1})}catch{}Ee(Z=>Z.map(de=>de.id===E.id?{...de,isDeferred:!1}:de));try{await si()}catch{}Te({title:"تم التسديد",description:`تم تسديد أجل ${E.productName}`})}catch(B){console.error("Error marking deferred sale as paid:",B),Te({title:"فشل التسديد",description:"تعذّر تحديث حالة البيع المؤجّل",variant:"destructive"})}},Qa=async()=>{if(!(A!=null&&A.uid))return;const E=j.filter(B=>!B.firestoreId);if(E.length!==0)for(const B of E)try{let Z;try{const Se=tr(Kt(ut,"dailySales"),_t("userId","==",A.uid),_t("clientId","==",B.id),es(1));Z=await Fr(Se)}catch{const Se=tr(Kt(ut,"users",A.uid,"dailySales"),_t("clientId","==",B.id),es(1));Z=await Fr(Se)}if(!Z.empty){const Se=Z.docs[0].id,Fe=j.map(Ue=>Ue.id===B.id?{...Ue,firestoreId:Se}:Ue);ii(Fe);continue}const de=await Ja(B);if(de){const Se=j.map(Fe=>Fe.id===B.id?{...Fe,firestoreId:de}:Fe);ii(Se)}}catch{}},ro=async E=>{try{if(A!=null&&A.uid)try{const se=Kt(ut,"deficiencies"),ye=await Fs(se,{shopId:(Y==null?void 0:Y.shopId)||A.uid||"default-shop",name:E,quantity:1,status:"pending",createdAt:ba()});try{const we=`deficiencies_${(Y==null?void 0:Y.shopId)||(A==null?void 0:A.uid)||"default-shop"}`,Ge=localStorage.getItem(we),ke=Ge?JSON.parse(Ge):[],Ie=Array.isArray(ke)?ke:[],wt=Ie.some(Dt=>String((Dt==null?void 0:Dt.id)||"")===ye.id),At={id:ye.id,name:E,quantity:1,status:"pending",createdAt:new Date().toISOString()},et=wt?Ie:[...Ie,At];localStorage.setItem(we,JSON.stringify(et))}catch{}Te({title:"تمت الإضافة للنواقص",description:`المنتج ${E} نفد من المخزون وتمت إضافته للنواقص`});return}catch(se){console.warn("Failed to add deficiency to Firestore, falling back to local storage:",se)}const B=`deficiencies_${(Y==null?void 0:Y.shopId)||(A==null?void 0:A.uid)||"default-shop"}`,Z=localStorage.getItem(B),de=Z?JSON.parse(Z):[],Se=Array.isArray(de)?de:[];if(Se.some(se=>String((se==null?void 0:se.name)||"").trim()===E&&String((se==null?void 0:se.status)||"pending")==="pending"))return;const Ue={id:Date.now().toString(),name:E,quantity:1,status:"pending",createdAt:new Date().toISOString()},Ne=[...Se,Ue];localStorage.setItem(B,JSON.stringify(Ne)),Te({title:"تمت الإضافة للنواقص",description:`المنتج ${E} نفد من المخزون وتمت إضافته للنواقص`})}catch(B){console.error("Error adding deficiency for out-of-stock:",B)}},i0=()=>{try{if(Me.length===0){Te({title:"لا توجد بيانات",description:"لا توجد منتجات لتصديرها",variant:"destructive"});return}const E=Me.map(de=>({"اسم المنتج":de.name,"سعر البيع":de.sellingPrice,"سعر الجملة":de.wholesalePrice||0,الكمية:de.quantity,الباركود:de.barcode||"","الرقم التسلسلي":de.serialNumber||""})),B=Bo.json_to_sheet(E),Z=Bo.book_new();Bo.book_append_sheet(Z,B,"المنتجات"),Y_(Z,"المنتجات.xlsx"),Te({title:"تم التصدير",description:"تم تصدير المنتجات بنجاح"})}catch(E){console.error("Error exporting excel:",E),Te({title:"خطأ",description:"حدث خطأ أثناء تصدير البيانات",variant:"destructive"})}},wc=E=>{var Z;const B=(Z=E.target.files)==null?void 0:Z[0];if(B){if(ht){Te({title:"غير مسموح",description:"لا يمكن استيراد منتجات أثناء الوردية",variant:"destructive"}),E.target.value="";return}vr("استيراد منتجات","أدخل الرقم السري للمتابعة",async()=>{const de=new FileReader;de.onload=async Se=>{var Fe;try{const Ue=(Fe=Se.target)==null?void 0:Fe.result,Ne=sl(Ue,{type:"binary"}),se=Ne.SheetNames[0],ye=Ne.Sheets[se],we=Bo.sheet_to_json(ye);if(!we||we.length===0){Te({title:"خطأ",description:"الملف فارغ أو التنسيق غير صحيح",variant:"destructive"});return}let Ge=0,ke=0;for(const et of we)try{const Dt=et["اسم المنتج"]||et.name,Qt=Number(et["سعر البيع"]||et.sellingPrice),Pt=Number(et.الكمية||et.quantity),Zt=Number(et["سعر الجملة"]||et.wholesalePrice||0),Xt=et.الباركود||et.barcode||"",Mr=et["الرقم التسلسلي"]||et.serialNumber||"";if(Dt&&!isNaN(Qt)&&!isNaN(Pt)){const Gr={name:String(Dt).trim(),sellingPrice:Qt,wholesalePrice:Zt,quantity:Pt,userId:A==null?void 0:A.uid,createdAt:ba(),updatedAt:ba()};Xt&&(Gr.barcode=String(Xt).trim()),Mr&&(Gr.serialNumber=String(Mr).trim()),Y!=null&&Y.shopId?Gr.shopId=Y.shopId:ze&&(Gr.shopId=ze),await Fs(Kt(ut,"products"),Gr),Ge++}}catch{ke++}const Ie=tr(Kt(ut,"products"),_t("userId","==",A==null?void 0:A.uid),...Y!=null&&Y.shopId?[_t("shopId","==",Y.shopId)]:[]),At=(await Fr(Ie)).docs.map(et=>({id:et.id,...et.data()}));ft(At),Te({title:"تم الاستيراد",description:`تم إضافة ${Ge} منتج بنجاح.${ke>0?` فشل ${ke} منتج.`:""}`})}catch(Ue){console.error("Error importing excel:",Ue),Te({title:"خطأ",description:"حدث خطأ أثناء قراءة الملف",variant:"destructive"})}E.target&&(E.target.value="")},de.readAsBinaryString(B)})}},ao=async()=>{const E=String(ya.productName||"").trim(),B=parseFloat(String(ya.price||"")),Z=parseFloat(String(ya.wholesalePrice||"")),de=parseInt(String(ya.quantity||"1"));if(!E||isNaN(B)||B<=0||isNaN(de)||de<=0){Te({title:"بيانات غير صالحة",description:"أدخل اسم المنتج وسعر بيع صحيح والكمية",variant:"destructive"});return}const Se=new Date,Fe=ht&&lt?"cashier":"admin",Ue=Fe==="cashier"?(lt==null?void 0:lt.name)||"كاشير":(Y==null?void 0:Y.fullName)||(A==null?void 0:A.displayName)||"الحساب الرئيسي",Ne=Fe==="cashier"&&(lt==null?void 0:lt.username)||null,se=A!=null&&A.uid?`SALECASH-${A.uid}-${Date.now()}`:void 0,ye={id:Date.now().toString(),productName:E,price:B,wholesalePrice:isNaN(Z)?0:Z,quantity:de,date:Se.toISOString().split("T")[0],time:Se.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),createdAtMs:Se.getTime(),performedByType:Fe,performedByName:Ue,performedByUsername:Ne,serialNumber:String(ya.serialNumber||"").trim()||void 0,barcode:String(ya.barcode||"").trim()||void 0,isDeferred:!1,transactionReference:se};try{const we=await Ja(ye),Ge=we?{...ye,firestoreId:we}:ye;ii([...j,Ge]);const ke=B*de;try{const Ie=Gn(),wt=localStorage.getItem(Ie),et=(wt?parseFloat(wt):0)+ke;localStorage.setItem(Ie,et.toString());const Dt=`userData_${A==null?void 0:A.uid}`,Qt={cashBalance:et,lastUpdated:new Date().toISOString()};localStorage.setItem(Dt,JSON.stringify(Qt)),A!=null&&A.uid&&Xn.updateUserData(A.uid,Qt).catch(()=>{});const Pt=(Y==null?void 0:Y.shopId)||ze;if(Pt)try{await tn(fa(ut,"dashboardData",Pt),{cashBalance:et})}catch{}try{window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:et}}))}catch{}try{if(A!=null&&A.uid&&se){const Xt={txnType:"sales",type:"sales",amount:ke,status:"confirmed",senderMsisdn:"مبيعات",receiverMsisdn:"",reference:se,title:"إيصال مبيعات",merchantUserId:A.uid,createdBy:A.uid,shopId:(Y==null?void 0:Y.shopId)||ze||void 0,cashierName:Ue,performedByType:Fe,performedByUsername:Ne,saleProductName:E,saleQuantity:de,createdAt:new Date};await Xn.saveUserTransaction(A.uid,Xt)}}catch{}It(Xt=>Xt+ke);const Zt=(B-(isNaN(Z)?0:Z))*de;ra(Xt=>Xt+Zt)}catch(Ie){console.warn("تعذر تحديث رصيد الدرج النقدي بعد البيع الفوري:",Ie)}ta({productName:"",price:"",wholesalePrice:"",quantity:"1",barcode:"",serialNumber:""}),Te({title:"تم البيع",description:`تم بيع ${de} قطعة من ${E} (بدون تسجيل بالمخزون)`})}catch(we){console.error("Error quick selling ad-hoc product:",we),Te({title:"فشل البيع",description:"تعذّر تنفيذ عملية البيع الفوري",variant:"destructive"})}},Pa=async(E,B=!1,Z,de)=>{const Se=Et[E.id]||"",Fe=parseInt(Se);if(isNaN(Fe)||Fe<=0){Te({title:"كمية غير صالحة",description:"أدخل كمية صحيحة للبيـع",variant:"destructive"});return}if(Fe>E.quantity){Te({title:"كمية أكبر من المتاح",description:"الكمية المطلوب بيعها تتجاوز المخزون المتاح",variant:"destructive"});return}const Ue=new Date,Ne=dn(),se=ht&&lt?"cashier":"admin",ye=se==="cashier"?(lt==null?void 0:lt.name)||"كاشير":(Y==null?void 0:Y.fullName)||(A==null?void 0:A.displayName)||"الحساب الرئيسي",we=se==="cashier"&&(lt==null?void 0:lt.username)||null,Ge=A!=null&&A.uid?`SALECASH-${A.uid}-${Date.now()}`:void 0,ke=(E.serialNumber||"").trim(),Ie=wr[E.id]||"",wt=parseFloat(Ie),At=!isNaN(wt)&&wt>0?wt:E.sellingPrice,et=gt[E.id]||"cash",Dt={id:Date.now().toString(),productName:E.name,price:At,wholesalePrice:E.wholesalePrice,quantity:Fe,date:Ne,time:Ue.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),createdAtMs:Ue.getTime(),performedByType:se,performedByName:ye,performedByUsername:we,serialNumber:ke||void 0,barcode:E.barcode,isDeferred:B,paymentMethod:et,customerName:Z==null?void 0:Z.name,customerMobile:Z==null?void 0:Z.mobile,customerId:Z==null?void 0:Z.id,transactionReference:Ge};try{ii([Dt,...j]);const Qt=E.quantity-Fe;if(ft(Zt=>Zt.map(Xt=>Xt.id===E.id?{...Xt,quantity:Qt}:Xt)),Kr(Zt=>({...Zt,[E.id]:""})),Es(Zt=>({...Zt,[E.id]:""})),Qt===0)try{ro(E.name)}catch{}if(!B){const Zt=At*Fe;if(et==="cash")try{const Mr=Gn(),Gr=localStorage.getItem(Mr),oi=(Gr?parseFloat(Gr):0)+Zt;localStorage.setItem(Mr,oi.toString());const Is=`userData_${A==null?void 0:A.uid}`,io={cashBalance:oi,lastUpdated:new Date().toISOString()};try{localStorage.setItem(Is,JSON.stringify(io))}catch{}try{window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:oi}}))}catch{}}catch(Mr){console.warn("تعذر تحديث رصيد الدرج محلياً:",Mr)}const Xt=(At-(E.wholesalePrice||0))*Fe;It(Mr=>Mr+Zt),ra(Mr=>Mr+Xt),kt(Mr=>Mr+Xt)}const Pt=[];if(Pt.push(Ja(Dt).then(Zt=>{if(Zt)try{const Xt=ze||(Y==null?void 0:Y.shopId)||"main",Mr=dn(),Gr=`salesData_${A==null?void 0:A.uid}_${Xt}_${Mr}`,Ti=`salesData_all_${A==null?void 0:A.uid}_${Xt}`,oi=localStorage.getItem(Gr),Is=oi?JSON.parse(oi):[],io=(Array.isArray(Is)?Is:[]).map(Ds=>Ds.id===Dt.id?{...Ds,firestoreId:Zt}:Ds);localStorage.setItem(Gr,JSON.stringify(io));try{const Ds=localStorage.getItem(Ti),Jl=Ds?JSON.parse(Ds):[],Yu=(Array.isArray(Jl)?Jl:[]).map(yc=>yc.id===Dt.id?{...yc,firestoreId:Zt}:yc);localStorage.setItem(Ti,JSON.stringify(Yu))}catch{}Ee(Vn(io))}catch{}})),Pt.push(tn(fa(ut,"products",E.id),{quantity:Qt,updatedAt:ba()}).catch(()=>{})),!B){const Zt=At*Fe;if(et==="cash"){const Xt=(Y==null?void 0:Y.shopId)||ze,Mr=`userData_${A==null?void 0:A.uid}`,Gr=localStorage.getItem(Gn()),oi=Gr?parseFloat(Gr):0,Is={cashBalance:oi,lastUpdated:new Date().toISOString()};A!=null&&A.uid&&Pt.push(Xn.updateUserData(A.uid,Is).catch(()=>{})),Xt&&Pt.push(tn(fa(ut,"dashboardData",Xt),{cashBalance:oi}).catch(()=>{}))}if(A!=null&&A.uid&&Ge){const Xt={txnType:"sales",type:"sales",amount:At*Fe,status:"confirmed",senderMsisdn:"مبيعات",receiverMsisdn:"",reference:Ge,title:"إيصال مبيعات",merchantUserId:A.uid,createdBy:A.uid,shopId:(Y==null?void 0:Y.shopId)||ze||void 0,cashierName:ye,performedByType:se,performedByUsername:we,saleProductName:E.name,saleQuantity:Fe,paymentMethod:et,createdAt:new Date};Pt.push(Xn.saveUserTransaction(A.uid,Xt).catch(()=>{}))}}Promise.allSettled(Pt).catch(()=>{}),Te({title:"تم البيع",description:`تم بيع ${Fe} قطعة من ${E.name}`})}catch(Qt){console.error("Error selling product:",Qt),Te({title:"فشل البيع",description:"تعذّر تنفيذ عملية البيع",variant:"destructive"})}},vc=async E=>{if(A!=null&&A.uid){if(ht){Te({title:"غير مسموح في وضع الكاشير",description:"لا يمكن حذف إيصالات البيع أثناء الورديه",variant:"destructive"});return}vr("تأكيد حذف إيصال بيع","أدخل الرقم السري الرئيسي لحذف الإيصال وعكس الآثار",async()=>{try{try{const Ne=`deletedSaleIds_${A.uid}`,se=localStorage.getItem(Ne),we=[...se?JSON.parse(se):[],E.id,E.firestoreId].filter(Boolean);localStorage.setItem(Ne,JSON.stringify(we))}catch{}const B=ze||(Y==null?void 0:Y.shopId)||"main",Z=dn(),de=`salesData_${A.uid}_${B}_${Z}`,Se=`salesData_all_${A.uid}_${B}`,Fe=j.filter(Ne=>Ne.id!==E.id);try{localStorage.setItem(de,JSON.stringify(Fe));const Ne=localStorage.getItem(Se),se=Ne?JSON.parse(Ne):[],ye=(Array.isArray(se)?se:[]).filter(we=>(we==null?void 0:we.id)!==E.id);localStorage.setItem(Se,JSON.stringify(ye))}catch{}Ee(Fe);const Ue=[];if(!E.isDeferred)try{const Ne=(E.price??0)*(E.quantity??0),se=Gn(),ye=localStorage.getItem(se),Ge=(ye?parseFloat(ye):0)-Ne;localStorage.setItem(se,Ge.toString());const ke=`userData_${A==null?void 0:A.uid}`,Ie={cashBalance:Ge,lastUpdated:new Date().toISOString()};try{localStorage.setItem(ke,JSON.stringify(Ie))}catch{}A!=null&&A.uid&&Ue.push(Xn.updateUserData(A.uid,Ie));const wt=(Y==null?void 0:Y.shopId)||ze;wt&&Ue.push(tn(fa(ut,"dashboardData",wt),{cashBalance:Ge}).catch(()=>{}));try{window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:Ge}}))}catch{}const At=((E.price??0)-(E.wholesalePrice??0))*(E.quantity??0);It(et=>et-Ne),ra(et=>et-At),kt(et=>et-At)}catch(Ne){console.warn("تعذر عكس رصيد الدرج النقدي عند حذف الإيصال:",Ne)}try{if(E.cartItems&&E.cartItems.length>0){const Ne=[];for(const se of E.cartItems){const ye=Me.find(we=>we.id===se.productId||we.name===se.productName);if(ye){const we=(ye.quantity||0)+(se.quantity||0);Ne.push({id:ye.id,qty:we}),Ue.push(tn(fa(ut,"products",ye.id),{quantity:we,updatedAt:ba()}))}}ft(se=>se.map(ye=>{const we=Ne.find(Ge=>Ge.id===ye.id);return we?{...ye,quantity:we.qty}:ye}))}else{const Ne=Me.find(se=>E.barcode&&se.barcode===E.barcode||se.name===E.productName);if(Ne){const se=(Ne.quantity||0)+(E.quantity||0);ft(ye=>ye.map(we=>we.id===Ne.id?{...we,quantity:se}:we)),Ue.push(tn(fa(ut,"products",Ne.id),{quantity:se,updatedAt:ba()}))}}}catch(Ne){console.warn("تعذر عكس المخزون عند حذف الإيصال:",Ne)}try{Ue.push((async()=>{try{if(E.transactionReference){const se=tr(Kt(ut,"userTransactions"),_t("userId","==",A.uid),_t("reference","==",E.transactionReference)),ye=await Fr(se);await Promise.all(ye.docs.map(we=>Di(we.ref)))}else{const se=(E.price??0)*(E.quantity??0),ye=E.createdAtMs||new Date(E.date+"T"+(E.time||"00:00")).getTime(),we=ye-6e4*2,Ge=ye+6e4*2,ke=tr(Kt(ut,"userTransactions"),_t("userId","==",A.uid),_t("type","==","sales"),_t("saleProductName","==",E.productName),_t("amount","==",se)),wt=(await Fr(ke)).docs.filter(At=>{var Qt,Pt,Zt;const et=At.data(),Dt=((Zt=(Pt=(Qt=et.createdAt)==null?void 0:Qt.toDate)==null?void 0:Pt.call(Qt))==null?void 0:Zt.getTime())||new Date(et.createdAt).getTime();return Dt>=we&&Dt<=Ge});await Promise.all(wt.map(At=>Di(At.ref)))}}catch(se){console.warn("Failed to delete from userTransactions",se)}})());const Ne=async()=>{try{const se=tr(Kt(ut,"dailySales"),_t("userId","==",A.uid),_t("clientId","==",E.id)),ye=await Fr(se);await Promise.all(ye.docs.map(ke=>Di(ke.ref)));const we=tr(Kt(ut,"users",A.uid,"dailySales"),_t("clientId","==",E.id)),Ge=await Fr(we);await Promise.all(Ge.docs.map(ke=>Di(ke.ref)))}catch(se){console.warn("تعذر حذف سجل البيع عبر الاستعلام:",se)}};E.firestoreId?(Ue.push((async()=>{try{await Di(fa(ut,"dailySales",E.firestoreId))}catch(se){console.warn("Failed to delete from root dailySales by ID, trying fallback...",se),await Ne()}})()),Ue.push(Di(fa(ut,"users",A.uid,"dailySales",E.firestoreId)).catch(()=>{}))):Ue.push(Ne())}catch(Ne){console.warn("تعذر جدولة حذف سجل البيع من Firestore:",Ne)}try{ma||setTimeout(()=>{try{si()}catch{}},0)}catch{}try{await Promise.allSettled(Ue)}catch{}Te({title:"تم حذف الإيصال",description:`تم حذف إيصال بيع للمنتج ${E.productName} وتم عكس الآثار`})}catch(B){console.error("Error deleting sale:",B),Te({title:"فشل حذف الإيصال",description:"تعذّر حذف إيصال البيع",variant:"destructive"})}})}},s0=async E=>{try{Kr(B=>({...B,[E.id]:"1"})),await Pa(E)}catch(B){console.error("Error selling by barcode:",B)}},Si=E=>{if(A!=null&&A.uid){if(ht){Te({title:"غير مسموح في وضع الكاشير",description:"لا يمكن حذف المنتجات أثناء الورديه",variant:"destructive"});return}vr("تأكيد حذف منتج","لا يمكن حذف المنتجات إلا بإدخال الرقم السري الرئيسي",()=>{qi(E)})}},qt=async()=>{if(!(!ni||!(A!=null&&A.uid)))try{const{getDoc:E}=await Cc(async()=>{const{getDoc:Ne}=await import("./index-DhbnydJl.js").then(se=>se.cP);return{getDoc:Ne}},__vite__mapDeps([0,1]),import.meta.url),B=(Y==null?void 0:Y.shopId)||ze,Z=fa(ut,"products",ni.id),de=await E(Z);if(!de.exists()){Te({title:"غير موجود",description:"هذا المنتج غير موجود أو تم حذفه مسبقاً",variant:"destructive"});return}const Se=de.data(),Fe=String((Se==null?void 0:Se.userId)||"")===String(A.uid),Ue=B?String((Se==null?void 0:Se.shopId)||"")===String(B):!0;if(!Fe||!Ue){Te({title:"ممنوع",description:"لا يمكنك حذف منتج لا يخص الحساب الحالي أو هذا المحل",variant:"destructive"});return}await Di(Z),ft(Ne=>{const se=Ne.filter(ye=>ye.id!==ni.id);try{const ye=(Y==null?void 0:Y.shopId)||ze||"main",we=`shopProducts_${A.uid}_${ye}`;localStorage.setItem(we,JSON.stringify(se))}catch(ye){console.error(ye)}return se}),Te({title:"تم الحذف",description:`تم حذف المنتج ${ni.name}`})}catch(E){console.error("Error deleting product:",E),Te({title:"فشل الحذف",description:"تعذّر حذف المنتج",variant:"destructive"})}finally{qi(null)}},Qi=()=>{if(A!=null&&A.uid){if(ht){Te({title:"غير مسموح",description:"لا يمكن حذف المنتجات أثناء الوردية",variant:"destructive"});return}if(Me.length===0){Te({title:"تنبيه",description:"لا توجد منتجات لحذفها"});return}vr("حذف جميع المنتجات","تحذير: سيتم حذف كل المنتجات من المخزون نهائياً. هذا الإجراء لا يمكن التراجع عنه.",()=>{Zi(!0)})}},k=async()=>{if(A!=null&&A.uid)try{const{collection:E,query:B,where:Z,getDocs:de,writeBatch:Se}=await Cc(async()=>{const{collection:ye,query:we,where:Ge,getDocs:ke,writeBatch:Ie}=await import("./index-DhbnydJl.js").then(wt=>wt.cP);return{collection:ye,query:we,where:Ge,getDocs:ke,writeBatch:Ie}},__vite__mapDeps([0,1]),import.meta.url),Fe=(Y==null?void 0:Y.shopId)||ze,Ue=[Z("userId","==",A.uid)];Fe&&Ue.push(Z("shopId","==",Fe));const Ne=B(E(ut,"products"),...Ue),se=await de(Ne);if(!se.empty){let ye=Se(ut),we=0;for(const Ge of se.docs)ye.delete(Ge.ref),we++,we%400===0&&(await ye.commit(),ye=Se(ut));we%400!==0&&await ye.commit()}ft([]);try{const ye=(Y==null?void 0:Y.shopId)||ze||"main",we=`shopProducts_${A.uid}_${ye}`,Ge=`shopProducts_lastSync_${A.uid}_${ye}`;localStorage.removeItem(we),localStorage.removeItem(Ge)}catch(ye){console.error(ye)}Te({title:"تم الحذف",description:"تم حذف جميع المنتجات بنجاح"})}catch(E){console.error("Error deleting all products:",E),Te({title:"خطأ",description:"حدث خطأ أثناء حذف المنتجات",variant:"destructive"})}finally{Zi(!1)}},a=async()=>{try{if(!(A!=null&&A.uid)){Te({title:"خطأ",description:"غير مسجّل دخول",variant:"destructive"});return}if(ht){Te({title:"غير مسموح في وضع الكاشير",description:"لا يمكن إضافة منتجات أثناء الورديه",variant:"destructive"});return}const E=fe.productName.trim(),B=parseFloat(fe.price),Z=parseFloat(fe.wholesalePrice||"0"),de=parseInt(fe.quantity);if(!E||isNaN(B)||isNaN(de)){Te({title:"بيانات غير مكتملة",description:"أدخل اسم المنتج والسعر والكمية",variant:"destructive"});return}const Se={name:E,sellingPrice:B,wholesalePrice:isNaN(Z)?0:Z,quantity:isNaN(de)?0:de,userId:A.uid,createdAt:ba(),updatedAt:ba()},Fe=(fe.barcode||"").trim();Fe&&(Se.barcode=Fe);const Ue=(fe.serialNumber||"").trim();Ue&&(Se.serialNumber=Ue);const Ne=(fe.supplierName||"").trim();Ne&&(Se.supplierName=Ne),fe.categoryId&&(Se.categoryId=fe.categoryId),Y!=null&&Y.shopId?Se.shopId=Y.shopId:ze&&(Se.shopId=ze);const se=await Fs(Kt(ut,"products"),Se);ft(ye=>{const Ge=[{id:se.id,name:E,sellingPrice:B,wholesalePrice:isNaN(Z)?0:Z,quantity:isNaN(de)?0:de,barcode:(fe.barcode||"").trim()||void 0,serialNumber:(fe.serialNumber||"").trim()||void 0,supplierName:(fe.supplierName||"").trim()||void 0,categoryId:fe.categoryId,updatedAt:new Date().toISOString(),...Y!=null&&Y.shopId?{shopId:Y.shopId}:ze?{shopId:ze}:{}},...ye];try{const ke=(Y==null?void 0:Y.shopId)||ze||"main",Ie=`shopProducts_${A.uid}_${ke}`;localStorage.setItem(Ie,JSON.stringify(Ge))}catch(ke){console.error("Failed to persist products locally",ke)}return Ge}),ot({productName:"",price:"",wholesalePrice:"",quantity:"",barcode:"",serialNumber:"",supplierName:"",categoryId:void 0}),Te({title:"تمت الإضافة",description:`تم إضافة المنتج ${E} بنجاح`})}catch(E){console.error("createProduct error",E),Te({title:"فشل الإضافة",description:"تعذّر إضافة المنتج. حاول مجددًا",variant:"destructive"})}},i=E=>{Le(E),Be({productName:E.name,price:String(E.sellingPrice??""),wholesalePrice:String(E.wholesalePrice??""),quantity:String(E.quantity??""),barcode:E.barcode||"",serialNumber:E.serialNumber||"",supplierName:E.supplierName||"",categoryId:E.categoryId||""}),le(!0)},o=async()=>{try{if(!(A!=null&&A.uid)||!qe){Te({title:"خطأ",description:"لا يوجد مستخدم أو منتج محدد",variant:"destructive"});return}if(ht){Te({title:"غير مسموح في وضع الكاشير",description:"لا يمكن تعديل المنتجات أثناء الورديه",variant:"destructive"});return}const E=(Pe.productName||"").trim(),B=parseFloat(Pe.price||""),Z=parseFloat(Pe.wholesalePrice||"0"),de=parseInt(Pe.quantity||"");if(!E||isNaN(B)){Te({title:"بيانات غير مكتملة",description:"أدخل اسم المنتج وسعر البيع",variant:"destructive"});return}const Se={name:E,sellingPrice:B,wholesalePrice:isNaN(Z)?0:Z,updatedAt:ba()};isNaN(de)||(Se.quantity=de);const Fe=(Pe.barcode||"").trim();Fe?Se.barcode=Fe:Se.barcode="";const Ue=(Pe.serialNumber||"").trim();Ue?Se.serialNumber=Ue:Se.serialNumber="";const Ne=(Pe.supplierName||"").trim();Ne?Se.supplierName=Ne:Se.supplierName="",Pe.categoryId?Se.categoryId=Pe.categoryId:Se.categoryId=null,await tn(fa(ut,"products",qe.id),Se),ft(se=>{const ye=se.map(we=>we.id===qe.id?{...we,name:E,sellingPrice:B,wholesalePrice:isNaN(Z)?0:Z,quantity:isNaN(de)?we.quantity:de,barcode:Fe,serialNumber:Ue,supplierName:Ne,categoryId:Pe.categoryId}:we);try{const we=(Y==null?void 0:Y.shopId)||ze,Ge=`shopProducts_${A.uid}_${we}`;localStorage.setItem(Ge,JSON.stringify(ye))}catch(we){console.error("Failed to persist products locally",we)}return ye}),le(!1),Le(null),Te({title:"تم الحفظ",description:`تم تعديل المنتج ${E} بنجاح`})}catch(E){console.error("updateProduct error",E),Te({title:"فشل التعديل",description:"تعذّر تعديل المنتج. حاول مجددًا",variant:"destructive"})}},l=async E=>{const B=(E||"").trim();if(!B)return;const Z=Me.find(de=>(de.barcode||"")===B);if(!Z){Te({title:"باركود غير معروف",description:"لم يتم العثور على منتج بهذا الباركود"});return}await s0(Z)},f=E=>{const B=Me.find(Z=>Z.barcode===E);B?(St(Z=>({...Z,[B.id]:Number(Z[B.id]||0)+1})),Te({title:"تمت الإضافة",description:`تم إضافة ${B.name} للعربة`}),Ya("")):Te({title:"غير موجود",description:"المنتج غير موجود",variant:"destructive"})},u=async()=>{try{const E=ct,B=await Lo.getCameras();if(!B||B.length===0)throw new Error("لا توجد كاميرات متاحة");const de=(B.find(Se=>/back|rear|خلف/i.test(Se.label))||B[B.length-1]).id;Ua.current=new Lo("cart-scanner-container"),await Ua.current.start(de,{fps:10,qrbox:{width:250,height:120},formatsToSupport:[E.CODE_128,E.EAN_13,E.EAN_8,E.CODE_39]},Se=>{f(Se),x()},()=>{}),vi(!0)}catch(E){console.error("cart scanner start error",E),Te({title:"خطأ",description:"تعذّر تشغيل الكاميرا",variant:"destructive"})}},x=async()=>{try{Ua.current&&(await Ua.current.stop(),await Ua.current.clear(),Ua.current=null)}catch(E){console.warn(E)}vi(!1)};je.useEffect(()=>{cr||x()},[cr]);const p=()=>{const E=Object.entries(Yt).map(([ye,we])=>{const Ge=Number(we),ke=Me.find(Ie=>Ie.id===ye);return!ke||!Ge||Ge<=0?null:{name:ke.name,qty:Ge,price:ke.sellingPrice,total:Ge*ke.sellingPrice}}).filter(Boolean);if(E.length===0){Te({title:"لم يتم اختيار منتجات",description:"اختر منتجات عبر زر + لإضافتها للفاتورة"});return}const B=Mt||(Y==null?void 0:Y.shopName)||(A==null?void 0:A.displayName)||"المحل",Z=br||(Y==null?void 0:Y.phone)||(A==null?void 0:A.phoneNumber)||"",de=pr||(Y==null?void 0:Y.address)||"",Se=E.reduce((ye,we)=>ye+we.total,0),Fe=new Date().toLocaleString("ar-EG"),Ue=E.map(ye=>`
        <tr>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;font-size:12px">${ye.name}</td>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;text-align:center;font-size:12px">${ye.qty}</td>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;text-align:center;font-size:12px">${Wt(ye.price)}</td>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;text-align:center;font-weight:bold;font-size:12px">${Wt(ye.total)}</td>
        </tr>
      `).join(""),Ne=`
      <html>
        <head>
          <meta charset="utf-8" />
          <title>فاتورة</title>
          <style>
            @media print {
                @page { size: 80mm auto; margin: 0; }
                body { width: 80mm; margin: 0; padding: 5px; }
            }
            body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; direction: rtl; padding: 10px; margin: 0; width: 80mm; box-sizing: border-box; }
            .header { text-align: center; margin-bottom: 10px; border-bottom: 2px solid #000; padding-bottom: 5px; }
            .header h2 { margin: 0; font-size: 18px; font-weight: bold; }
            .meta { text-align: center; font-size: 11px; margin-bottom: 3px; color: #333; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
            th { border-bottom: 2px solid #000; font-size: 12px; padding: 4px 2px; text-align: center; }
            .total-section { border-top: 2px solid #000; padding-top: 5px; margin-top: 5px; }
            .total-row { display: flex; justify-content: space-between; font-weight: bold; font-size: 14px; margin-top: 5px; }
            .footer { text-align: center; font-size: 10px; margin-top: 15px; border-top: 1px dotted #ccc; padding-top: 5px; }
          </style>
        </head>
        <body>
          <div class="header">
            <h2>${B}</h2>
            ${de?`<div class="meta">${de}</div>`:""}
            ${Z?`<div class="meta">ت: ${Z}</div>`:""}
            <div class="meta">${Fe}</div>
          </div>
          <table>
            <thead>
              <tr>
                <th style="text-align:right">الصنف</th>
                <th>العدد</th>
                <th>سعر</th>
                <th>الإجمالي</th>
              </tr>
            </thead>
            <tbody>
              ${Ue}
            </tbody>
          </table>
          <div class="total-section">
            <div class="total-row">
                <span>الإجمالي:</span>
                <span>${Wt(Se)}</span>
            </div>
          </div>
          <div class="footer">شكراً لتعاملكم معنا</div>
        </body>
      </html>
    `,se=window.open("","_blank");se&&(se.document.write(Ne),se.document.close(),se.focus(),setTimeout(()=>{se.print(),se.close()},500))},[y,b]=je.useState(0),[I,R]=je.useState(0),[G,Q]=je.useState(0),[re,ue]=je.useState(0),[Ae,Ke]=je.useState(!1),[Ze,Xe]=je.useState(!1),[Ht,kt]=je.useState(0),_a=()=>new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(new Date),$a=async()=>{if(!(A!=null&&A.uid))return 0;const E=_a(),B=new Date().toISOString().split("T")[0],Z=dn(),de=ze||(Y==null?void 0:Y.shopId)||null;let Se=0;try{const Fe=tr(Kt(ut,"dailySales"),_t("userId","==",A.uid),...de?[_t("shopId","==",de)]:[]),Ue=await Fr(Fe),Ne=[];Ue.forEach(we=>{Ne.push({id:we.id,data:we.data()})}),(await Fr(Kt(ut,"users",A.uid,"dailySales"))).forEach(we=>{const Ge=we.data();de&&Ge.shopId&&Ge.shopId!==de||Ne.push({id:we.id,data:Ge})});const ye=new Map;Ne.forEach(we=>{const Ge=String(we.data.clientId||we.id);ye.has(Ge)||ye.set(Ge,we)}),ye.forEach(({data:we})=>{const Ge=String(we.date||"").slice(0,10);if(!we.isDeferred&&(Ge===E||Ge===B||Ge===Z)){const ke=Number(we.quantity||1),Ie=Number(we.profit??(Number(we.sellingPrice||0)-Number(we.wholesalePrice||0))*ke);Se+=Ie}})}catch(Fe){console.warn("تعذر جلب أرباح المبيعات اليومية للملخص:",Fe)}return Math.round(Se*100)/100};je.useEffect(()=>{!e||!(A!=null&&A.uid)||(async()=>{try{kt(await $a())}catch{}})()},[e,A==null?void 0:A.uid,ze,c]);const la=()=>{const E=ze||(Y==null?void 0:Y.shopId)||"main",B=(A==null?void 0:A.uid)||"guest";return{daily:`dailyOffset_${B}_${E}_${c}`,monthly:`monthlyOffset_${B}_${E}_${h}`}};je.useEffect(()=>{if(!(A!=null&&A.uid))return;const E=la(),B=ze||(Y==null?void 0:Y.shopId)||"main",Z=(A==null?void 0:A.uid)||"guest";try{let de=localStorage.getItem(E.daily);if(!de&&B!=="main"&&(de=localStorage.getItem(`dailyOffset_${Z}_main_${c}`)),de){const{sales:Fe,profit:Ue}=JSON.parse(de);b(Number(Fe)||0),R(Number(Ue)||0)}else Ke(!0),b(0),R(0);let Se=localStorage.getItem(E.monthly);if(!Se&&B!=="main"&&(Se=localStorage.getItem(`monthlyOffset_${Z}_main_${h}`)),Se){const{sales:Fe,profit:Ue}=JSON.parse(Se);Q(Number(Fe)||0),ue(Number(Ue)||0)}else Xe(!0),Q(0),ue(0)}catch(de){console.error("Failed to load offsets",de)}},[A==null?void 0:A.uid,ze,Y==null?void 0:Y.shopId,e,c,h]);const sr=(E,B)=>{const Z=la();localStorage.setItem(Z.daily,JSON.stringify({sales:E,profit:B}))},Hr=(E,B)=>{const Z=la();localStorage.setItem(Z.monthly,JSON.stringify({sales:E,profit:B}))};je.useEffect(()=>{if(e&&Ae){const E=j.filter(Z=>!Z.isDeferred&&Z.date===c).reduce((Z,de)=>Z+de.price*de.quantity,0),B=j.filter(Z=>!Z.isDeferred&&Z.date===c).reduce((Z,de)=>Z+(de.price-(de.wholesalePrice??0))*de.quantity,0);b(E),R(B),sr(E,B),Ke(!1)}},[e,Ae,j]),je.useEffect(()=>{e&&Ze&&(Q(Ot),ue(Nt),Hr(Ot,Nt),Xe(!1))},[e,Ze,Ot,Nt]);const Aa=()=>{vr("بدء وردية جديدة (تصفير العرض)","هل تريد تصفير عدادات اليوم وبدء جلسة جديدة؟ (لن يتم حذف البيانات من السجل)",async()=>{try{const E=j.filter(Z=>!Z.isDeferred&&Z.date===c).reduce((Z,de)=>Z+de.price*de.quantity,0),B=j.filter(Z=>!Z.isDeferred&&Z.date===c).reduce((Z,de)=>Z+(de.price-(de.wholesalePrice??0))*de.quantity,0);b(E),R(B),sr(E,B),Te({title:"تم التصفير",description:"تم تصفير عدادات اليوم بنجاح (بياناتك آمنة في السجل)"})}catch(E){console.error(E),Te({title:"خطأ",description:"حدث خطأ أثناء التصفير",variant:"destructive"})}})},en=()=>{vr("إخفاء ملخص الشهر","هل تريد تصفير عدادات الشهر مؤقتاً؟ (لن يتم حذف البيانات من السجل)",async()=>{try{Q(Ot),ue(Nt),Hr(Ot,Nt),Te({title:"تم التصفير",description:"تم تصفير عدادات الشهر مؤقتاً"})}catch(E){console.error(E),Te({title:"خطأ",description:"حدث خطأ أثناء تصفير الشهر",variant:"destructive"})}})},Ci=async E=>{if(A!=null&&A.uid)try{const B=ze||(Y==null?void 0:Y.shopId)||null,Z=dn(),de=new Date().toISOString().split("T")[0],Se=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(new Date),Fe=new Date,Ue=new Date(Fe.getFullYear(),Fe.getMonth(),1),Ne=new Date(Fe.getFullYear(),Fe.getMonth()+1,0),se=Ue.toISOString().split("T")[0],ye=Ne.toISOString().split("T")[0],we=Pt=>Pt?E==="day"?Pt===Se||Pt===de||Pt===Z:Pt>=se&&Pt<=ye:!1,{writeBatch:Ge}=await Cc(async()=>{const{writeBatch:Pt}=await import("./index-DhbnydJl.js").then(Zt=>Zt.cP);return{writeBatch:Pt}},__vite__mapDeps([0,1]),import.meta.url),ke=Ge(ut),Ie=tr(Kt(ut,"dailySales"),_t("userId","==",A.uid),...B?[_t("shopId","==",B)]:[]);(await Fr(Ie)).docs.forEach(Pt=>{var Xt;const Zt=String(((Xt=Pt.data())==null?void 0:Xt.date)||"").slice(0,10);we(Zt)&&ke.delete(Pt.ref)});const At=tr(Kt(ut,"users",A.uid,"dailySales"),...B?[_t("shopId","==",B)]:[]);(await Fr(At)).docs.forEach(Pt=>{var Xt;const Zt=String(((Xt=Pt.data())==null?void 0:Xt.date)||"").slice(0,10);we(Zt)&&ke.delete(Pt.ref)}),await ke.commit();const Dt=Pt=>{const Zt=String(Pt.date||"").slice(0,10);return!we(Zt)},Qt=(j||[]).filter(Dt);ii(Qt);try{const Pt=ze||(Y==null?void 0:Y.shopId)||"main",Zt=`salesData_all_${A==null?void 0:A.uid}_${Pt}`,Xt=localStorage.getItem(Zt);if(Xt){const Mr=JSON.parse(Xt).filter(Gr=>{const Ti=String((Gr==null?void 0:Gr.date)||"").slice(0,10);return!we(Ti)});localStorage.setItem(Zt,JSON.stringify(Mr))}}catch{}Ee(Qt),E==="day"?(b(0),R(0),sr(0,0)):(Q(0),ue(0),Hr(0,0));try{await si()}catch{}Te({title:"تم التصفير النهائي",description:E==="day"?"تم حذف مبيعات اليوم نهائياً":"تم حذف مبيعات الشهر نهائياً"})}catch(B){console.error("Permanent reset failed:",B),Te({title:"فشل التصفير",description:"تعذّر التصفير النهائي لسجلات المبيعات",variant:"destructive"})}};return w.jsxs(Cn,{open:e,onOpenChange:r,children:[w.jsxs(Tn,{className:"max-w-none w-[100vw] h-[100dvh] p-0 overflow-hidden bg-background",children:[w.jsxs("div",{className:"flex flex-col h-full",dir:"rtl",children:[w.jsxs("div",{className:"bg-background dark:bg-card border-b border-border px-3 py-2 flex items-center justify-between shrink-0 z-10 h-14 sm:h-auto",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"bg-primary/10 p-1.5 rounded-full",children:w.jsx(dd,{className:"h-4 w-4 text-primary"})}),w.jsxs("div",{className:"flex flex-col justify-center",children:[w.jsx(Nn,{className:"text-sm font-bold leading-tight text-foreground",children:"المبيعات والمنتجات"}),w.jsx("p",{className:"text-[10px] text-muted-foreground hidden sm:block leading-none mt-0.5",children:"إدارة عمليات البيع والمخزون"})]})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs(it,{variant:"outline",size:"sm",onClick:()=>S("https://www.youtube.com/watch?v=a8wsEloObOs&t=3s","شرح القسم (فيديو)"),className:"hidden sm:flex h-7 text-[10px] px-2 text-rose-600 border-rose-200 hover:bg-rose-50 dark:border-rose-900/30 dark:text-rose-400 dark:hover:bg-rose-900/20",children:[w.jsx(hd,{className:"h-3 w-3 ml-1.5"}),"شرح القسم (فيديو)"]}),w.jsxs("span",{className:"hidden sm:flex items-center gap-1 h-7 text-[10px] px-2 rounded-full bg-amber-50 text-amber-700 border border-amber-200",children:[w.jsx(bd,{className:"h-3 w-3"}),"الرجاء أخذ نسخة احتياطية من المنتجات المضافة — الشرح موجود في الفيديو"]}),w.jsxs(it,{variant:"outline",size:"sm",onClick:()=>Qa(),className:"hidden sm:flex h-7 text-[10px] px-2 dark:border-gray-700 dark:text-gray-300",children:[w.jsx(Ql,{className:"h-3 w-3 ml-1.5"}),"مزامنة"]}),w.jsxs(it,{variant:"outline",size:"sm",onClick:()=>Gi(!0),className:"hidden sm:flex h-7 text-[10px] px-2 text-red-600 border-red-200 hover:bg-red-50 dark:border-red-900/30 dark:text-red-400 dark:hover:bg-red-900/20",children:[w.jsx(zn,{className:"h-3 w-3 ml-1.5"}),"تصفير نهائي"]}),w.jsx(it,{variant:"ghost",size:"icon",onClick:r,className:"rounded-full h-8 w-8 hover:bg-muted",children:w.jsx(c0,{className:"h-4 w-4"})})]})]}),w.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row",children:[w.jsx("div",{className:"w-full md:w-80 bg-muted/30 dark:bg-card/50 border-l dark:border-border flex flex-col shrink-0 order-2 md:order-1",children:w.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin",children:w.jsxs("div",{className:"p-4 space-y-4",children:[w.jsxs(kn,{className:"hidden md:block dark:bg-card dark:border-border",children:[w.jsxs($u,{className:"p-4 pb-2 flex flex-row items-center justify-between space-y-0",children:[w.jsxs(ed,{className:"text-sm font-medium flex items-center gap-2 text-foreground",children:[w.jsx(Rs,{className:"h-4 w-4 text-primary"}),"ملخص اليوم"]}),w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-red-600 dark:hover:text-red-400",onClick:Aa,title:"تصفير اليوم",children:w.jsx(zn,{className:"h-3.5 w-3.5"})})]}),w.jsxs(so,{className:"p-4 pt-2 space-y-3",children:[w.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border dark:border-gray-700",children:[w.jsx("span",{className:"text-sm text-muted-foreground",children:"المبيعات"}),w.jsx("span",{className:"text-lg font-bold text-primary",children:Wt(Math.max(0,j.filter(E=>!E.isDeferred&&E.date===c).reduce((E,B)=>E+B.price*B.quantity,0)-y))})]}),w.jsxs("div",{className:"relative overflow-hidden p-3 bg-emerald-50/50 dark:bg-emerald-950/20 rounded-lg border border-emerald-100 dark:border-emerald-900/50",children:[w.jsxs("div",{className:`flex justify-between items-center ${vt?"blur-sm":""}`,children:[w.jsx("span",{className:"text-sm text-emerald-700 dark:text-emerald-400",children:"الأرباح"}),w.jsx("span",{className:"text-lg font-bold text-emerald-700 dark:text-emerald-400",children:Wt(Ht)})]}),vt&&w.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 dark:bg-black/50",children:w.jsxs(it,{size:"sm",variant:"outline",onClick:()=>Ft(!0),className:"h-7 text-xs bg-white dark:bg-gray-800 dark:border-gray-700",children:[w.jsx($l,{className:"h-3 w-3 ml-1"}),"عرض"]})})]})]})]}),w.jsxs(kn,{className:"shadow-none border-none bg-transparent hidden md:block",children:[w.jsxs("div",{className:"flex items-center justify-between w-full p-2",children:[w.jsxs("button",{onClick:()=>dr(!jn),className:"flex items-center gap-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-primary transition-colors",children:[w.jsx(Ao,{className:"h-4 w-4"}),"تقارير الشهر",jn?w.jsx(uo,{className:"h-4 w-4"}):w.jsx(ld,{className:"h-4 w-4"})]}),w.jsx(it,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-red-600 dark:hover:text-red-400",onClick:en,title:"تصفير الشهر",children:w.jsx(zn,{className:"h-3.5 w-3.5"})})]}),!jn&&w.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 animate-in slide-in-from-top-2",children:w.jsxs("div",{className:"col-span-2 relative",children:[w.jsxs("div",{className:`grid grid-cols-2 gap-2 ${ma?"blur-md select-none":""}`,children:[w.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-950/20 p-3 rounded-xl border border-indigo-100 dark:border-indigo-900/50 text-center relative overflow-hidden group",children:[w.jsxs("div",{className:"flex justify-center items-center relative",children:[w.jsx("span",{className:"text-[10px] text-indigo-600 dark:text-indigo-400 block mb-1",children:"المبيعات"}),!ma&&w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 absolute -left-2 top-0 text-indigo-400 hover:text-red-600 hover:bg-white/50 rounded-full z-20",onClick:en,title:"تصفير الشهر",children:w.jsx(zn,{className:"h-3.5 w-3.5"})})]}),w.jsx("span",{className:"text-sm font-bold text-indigo-700 dark:text-indigo-300",children:Wt(Math.max(0,Ot-G))})]}),w.jsxs("div",{className:"bg-pink-50 dark:bg-pink-950/20 p-3 rounded-xl border border-pink-100 dark:border-pink-900/50 text-center relative overflow-hidden group",children:[w.jsxs("div",{className:"flex justify-center items-center relative",children:[w.jsx("span",{className:"text-[10px] text-pink-600 dark:text-pink-400 block mb-1",children:"الأرباح"}),!ma&&w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 absolute -left-2 top-0 text-pink-400 hover:text-red-600 hover:bg-white/50 rounded-full z-20",onClick:en,title:"تصفير الشهر",children:w.jsx(zn,{className:"h-3.5 w-3.5"})})]}),w.jsx("span",{className:"text-sm font-bold text-pink-700 dark:text-pink-300",children:Wt(Math.max(0,Nt-re))})]})]}),ma&&w.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/20 dark:bg-black/20 backdrop-blur-[2px]",children:w.jsx(it,{"aria-label":"عرض",variant:"ghost",size:"icon",onClick:()=>Va(!0),className:"rounded-full h-8 w-8 bg-white/80 dark:bg-black/50 backdrop-blur-sm shadow hover:bg-white dark:hover:bg-black/70",children:w.jsx(Ni,{className:"h-4 w-4 text-indigo-700 dark:text-indigo-400"})})})]})})]}),w.jsxs(kn,{className:"shadow-none border-none bg-transparent hidden md:block mt-2 relative",children:[w.jsxs("div",{className:`bg-amber-50 dark:bg-amber-950/20 p-3 rounded-xl border border-amber-100 dark:border-amber-900/50 text-center relative overflow-hidden ${ma?"blur-md select-none":""}`,children:[w.jsxs("div",{className:"flex justify-between items-start mb-1",children:[w.jsx("span",{className:"text-[10px] text-amber-600 dark:text-amber-400",children:"إجمالي المخزون (جملة)"}),!ma&&w.jsx(it,{variant:"ghost",size:"icon",className:"h-4 w-4 text-amber-600/50 hover:text-red-600 -mt-1 -mr-1",onClick:t0,title:"تصفير المخزون",children:w.jsx(zn,{className:"h-3 w-3"})})]}),w.jsx("span",{className:"text-sm font-bold text-amber-700 dark:text-amber-300",children:Wt(Math.max(0,Me.reduce((E,B)=>E+(Number(B.wholesalePrice)||0)*(Number(B.quantity)||0),0)-Lt))})]}),ma&&w.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/20 dark:bg-black/20 backdrop-blur-[2px]",children:w.jsx(it,{"aria-label":"عرض",variant:"ghost",size:"icon",onClick:()=>Va(!0),className:"rounded-full h-8 w-8 bg-white/80 dark:bg-black/50 backdrop-blur-sm shadow hover:bg-white dark:hover:bg-black/70",children:w.jsx(Ni,{className:"h-4 w-4 text-amber-700 dark:text-amber-400"})})})]}),w.jsx(ho,{className:"hidden md:block"})]})})}),w.jsx(xo,{open:hc,onOpenChange:Gi,children:w.jsxs(go,{children:[w.jsxs(mo,{children:[w.jsx(po,{children:"تصفير المبيعات"}),w.jsx(wo,{children:"اختر النطاق الذي تريد تصفيره نهائياً"})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsx(or,{className:"text-sm",children:"النطاق"}),w.jsxs(Ic,{value:Ra,onValueChange:E=>xt(E),children:[w.jsx(Dc,{children:w.jsx(Fc,{placeholder:"اختر النطاق"})}),w.jsxs(Oc,{children:[w.jsx(Os,{value:"day",children:"مبيعات اليوم"}),w.jsx(Os,{value:"month",children:"مبيعات الشهر"})]})]}),w.jsx("div",{className:"text-xs text-red-600 bg-red-50 border border-red-200 rounded p-2",children:"تحذير: سيتم حذف سجلات المبيعات نهائياً للنطاق المختار ولا يمكن التراجع."})]}),w.jsxs(vo,{children:[w.jsx(yo,{children:"إلغاء"}),w.jsx(Eo,{onClick:()=>{vr("تأكيد التصفير النهائي","أدخل الرقم السري الرئيسي لتأكيد الحذف النهائي لسجلات المبيعات",async()=>{await Ci(Ra),Gi(!1)})},className:"bg-red-600 hover:bg-red-700 text-white",children:"تصفير نهائي"})]})]})}),w.jsx("div",{className:"flex-1 overflow-hidden flex flex-col order-1 md:order-2 bg-background dark:bg-background",children:w.jsxs(od,{defaultValue:"products",className:"flex-1 flex flex-col overflow-hidden",children:[w.jsxs("div",{className:"px-2 py-1.5 bg-gray-50 dark:bg-card border-b border-dashed border-gray-300/60 dark:border-gray-700 flex items-center justify-between shrink-0",children:[w.jsxs(cd,{className:"h-8 dark:bg-gray-800",children:[w.jsx(Tc,{value:"products",className:"text-xs px-2 sm:px-3 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 dark:text-gray-300 dark:data-[state=active]:text-white",children:"المنتجات والبيع"}),w.jsx(Tc,{value:"categories",className:"text-xs px-2 sm:px-3 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 dark:text-gray-300 dark:data-[state=active]:text-white",children:"الاقسام"}),w.jsxs(Tc,{value:"sales-log",className:"text-xs px-2 sm:px-3 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 dark:text-gray-300 dark:data-[state=active]:text-white",children:["سجل المبيعات",w.jsx(ci,{variant:"secondary",className:"mr-2 h-5 px-1.5 text-[10px] hidden sm:inline-flex dark:bg-gray-600 dark:text-white",children:j.filter(E=>!E.isDeferred).length})]})]}),w.jsxs(it,{variant:"ghost",size:"sm",className:"md:hidden text-xs h-8 px-2 bg-white/50 dark:bg-gray-800/50 border dark:border-gray-700 mr-1 text-primary dark:text-primary-foreground",onClick:()=>Ln(!0),children:[w.jsx(_c,{className:"h-3 w-3 ml-1"}),"تفاصيل اليوم"]}),w.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 font-mono",dir:"ltr",children:[w.jsx("span",{className:"hidden sm:inline",children:new Date().toLocaleDateString("ar-EG")}),w.jsx(oo,{className:"h-3.5 w-3.5 text-gray-400"})]})]}),w.jsx(Nc,{value:"products",className:"flex-1 p-0 m-0 overflow-hidden h-full relative",children:w.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-thin",children:w.jsxs("div",{className:"p-4 space-y-4",children:[w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.jsxs(kn,{className:"border-dashed border-2 border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 transition-all bg-gray-50/30 dark:bg-gray-900/30 overflow-hidden",children:[w.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",onClick:()=>K(!pt),children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"bg-emerald-100 dark:bg-emerald-900/30 p-2 rounded-full",children:w.jsx(li,{className:"h-5 w-5 text-emerald-600 dark:text-emerald-400"})}),w.jsxs("div",{className:"text-right",children:[w.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:"إضافة منتج جديد"}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"تسجيل منتج جديد في المخزون"})]})]}),w.jsx(it,{variant:"ghost",size:"sm",className:"rounded-full h-8 w-8 p-0",children:w.jsx(uo,{className:`h-5 w-5 text-gray-400 transition-transform duration-200 ${pt?"rotate-180":""}`})})]}),pt&&w.jsxs("div",{className:"px-4 pb-4 pt-0 animate-in slide-in-from-top-2",children:[w.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent mb-4 opacity-50"}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(or,{className:"text-xs font-medium text-gray-700",children:["اسم المنتج ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(Jt,{value:fe.productName,onChange:E=>ot(B=>({...B,productName:E.target.value})),className:"h-9 bg-white",placeholder:"مثال: شاحن آيفون أصلي"})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(or,{className:"text-xs font-medium text-gray-700",children:["سعر البيع ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(Jt,{type:"number",value:fe.price,onChange:E=>ot(B=>({...B,price:E.target.value})),className:"h-9 bg-white",placeholder:"0.00"})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(or,{className:"text-xs font-medium text-gray-700",children:"سعر الجملة"}),w.jsx(Jt,{type:"number",value:fe.wholesalePrice||"",onChange:E=>ot(B=>({...B,wholesalePrice:E.target.value})),className:"h-9 bg-white",placeholder:"0.00"})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(or,{className:"text-xs font-medium text-gray-700",children:["الكمية ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(Jt,{type:"number",value:fe.quantity,onChange:E=>ot(B=>({...B,quantity:E.target.value})),className:"h-9 bg-white",placeholder:"1"})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(or,{className:"text-xs font-medium text-gray-700",children:"الباركود (اختياري)"}),w.jsxs("div",{className:"relative",children:[w.jsx(Jt,{value:fe.barcode||"",onChange:E=>ot(B=>({...B,barcode:E.target.value})),className:"h-9 bg-white pl-8",placeholder:"Scan..."}),w.jsx("button",{type:"button",onClick:()=>{pe(!0),We(""),Je()},title:"مسح الباركود بالكاميرا",className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-7 w-7 rounded hover:bg-gray-100 flex items-center justify-center",children:w.jsx(d0,{className:"h-4 w-4 text-gray-600"})})]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mt-2",children:[w.jsxs(it,{variant:"outline",size:"sm",onClick:W,title:"إنشاء باركود","aria-label":"إنشاء باركود",className:"h-9 w-full bg-white flex items-center justify-center",children:[w.jsx(xd,{className:"h-4 w-4"}),w.jsx("span",{className:"sr-only",children:"إنشاء باركود"})]}),w.jsxs(it,{variant:"secondary",size:"sm",onClick:De,title:"طباعة الباركود","aria-label":"طباعة الباركود",className:"h-9 w-full bg-white flex items-center justify-center",disabled:P||!(Oa||bn),children:[w.jsx(gd,{className:"h-4 w-4"}),w.jsx("span",{className:"sr-only",children:"طباعة الباركود"})]})]}),w.jsx("div",{className:"mt-2",children:xe?w.jsxs("div",{className:"bg-white border rounded p-2",children:[w.jsx("div",{id:Ye,className:"w-full h-[220px]"}),ve&&w.jsx("div",{className:"text-[11px] text-red-600 text-center mt-1",children:ve}),w.jsx("div",{className:"flex justify-end gap-2 mt-2",children:w.jsxs(it,{size:"sm",variant:"outline",onClick:nt,title:"إيقاف الماسح","aria-label":"إيقاف الماسح",children:[w.jsx(c0,{className:"h-4 w-4"}),w.jsx("span",{className:"sr-only",children:"إيقاف الماسح"})]})})]}):P?w.jsx("div",{className:"text-[11px] text-gray-500 text-center",children:"جاري إنشاء المعاينة..."}):Oa||bn?w.jsx("img",{src:Oa||bn,alt:"barcode",className:"w-full max-w-xs h-[70px] mx-auto bg-white rounded border"}):w.jsx("div",{className:"text-[11px] text-gray-500 text-center",children:"لا توجد معاينة بعد"})})]})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(or,{className:"text-xs font-medium text-gray-700",children:"القسم (اختياري)"}),w.jsxs(Ic,{value:fe.categoryId||"none",onValueChange:E=>ot(B=>({...B,categoryId:E==="none"?void 0:E})),children:[w.jsx(Dc,{className:"h-9 bg-white text-right",dir:"rtl",children:w.jsx(Fc,{placeholder:"اختر القسم"})}),w.jsxs(Oc,{children:[w.jsx(Os,{value:"none",children:"بدون قسم"}),As.map(E=>w.jsx(Os,{value:E.id,children:E.name},E.id))]})]})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(or,{className:"text-xs font-medium text-gray-700",children:"اسم المورد (اختياري)"}),w.jsx(Jt,{value:fe.supplierName||"",onChange:E=>ot(B=>({...B,supplierName:E.target.value})),className:"h-9 bg-white",placeholder:"مثال: شركة إلكترونيات"})]}),w.jsx("div",{className:"col-span-1 md:col-span-2 flex items-end",children:w.jsxs(it,{className:"w-full h-9 bg-emerald-600 hover:bg-emerald-700 text-white shadow-sm",onClick:()=>{if(ht){Te({title:"غير مسموح",description:"لا يمكن إضافة منتج أثناء الوردية",variant:"destructive"});return}vr("إضافة منتج","أدخل الرقم السري للمتابعة",a)},children:[w.jsx(li,{className:"h-4 w-4 ml-2"}),"حفظ المنتج الجديد"]})})]})]})]}),w.jsxs(kn,{className:"border-dashed border-2 border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 transition-all bg-gray-50/30 dark:bg-gray-900/30 overflow-hidden",children:[w.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",onClick:()=>Wa(!Pn),children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"bg-indigo-100 dark:bg-indigo-900/30 p-2 rounded-full",children:w.jsx(Rs,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),w.jsxs("div",{className:"text-right",children:[w.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:"بيع منتج فوري (غير مسجل)"}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"أدخل بيانات المنتج الآن وسيتم البيع بدون إضافته للمخزون"})]})]}),w.jsx(it,{variant:"ghost",size:"sm",className:"rounded-full h-8 w-8 p-0",children:w.jsx(uo,{className:`h-5 w-5 text-gray-400 transition-transform duration-200 ${Pn?"rotate-180":""}`})})]}),Pn&&w.jsxs("div",{className:"px-4 pb-4 pt-0 animate-in slide-in-from-top-2",children:[w.jsx("div",{className:"h-px bg-gray-200 mb-4"}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(or,{className:"text-xs font-medium text-gray-700",children:["اسم المنتج ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(Jt,{value:ya.productName,onChange:E=>ta(B=>({...B,productName:E.target.value})),className:"h-9 bg-white",placeholder:"مثال: منتج خاص"})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(or,{className:"text-xs font-medium text-gray-700",children:["سعر البيع ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(Jt,{type:"number",value:ya.price,onChange:E=>ta(B=>({...B,price:E.target.value})),className:"h-9 bg-white dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100",placeholder:"0.00"})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(or,{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"سعر الجملة (اختياري)"}),w.jsx(Jt,{type:"number",value:ya.wholesalePrice||"",onChange:E=>ta(B=>({...B,wholesalePrice:E.target.value})),className:"h-9 bg-white dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100",placeholder:"0.00"})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(or,{className:"text-xs font-medium text-gray-700",children:["الكمية ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(Jt,{type:"number",value:ya.quantity,onChange:E=>ta(B=>({...B,quantity:E.target.value})),className:"h-9 bg-white",placeholder:"1"})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(or,{className:"text-xs font-medium text-gray-700",children:"الباركود (اختياري)"}),w.jsxs("div",{className:"relative",children:[w.jsx(Jt,{value:ya.barcode||"",onChange:E=>ta(B=>({...B,barcode:E.target.value})),className:"h-9 bg-white pl-8",placeholder:"Scan..."}),w.jsx(d0,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400"})]})]})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(or,{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"الرقم التسلسلي (اختياري)"}),w.jsx(Jt,{value:ya.serialNumber||"",onChange:E=>ta(B=>({...B,serialNumber:E.target.value})),className:"h-9 bg-white dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100",placeholder:"SN..."})]}),w.jsx("div",{className:"flex items-end",children:w.jsxs(it,{className:"w-full h-9 bg-indigo-600 hover:bg-indigo-700 text-white shadow-sm",onClick:ao,children:[w.jsx(Rs,{className:"h-4 w-4 ml-2"}),"بيع الآن"]})})]})]})]})]})]}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-stretch sm:items-center justify-between bg-white p-2 rounded-xl border border-gray-100 shadow-sm",children:[w.jsxs("div",{className:"relative flex-1 w-full sm:max-w-md group",children:[w.jsx(kc,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-primary transition-colors"}),w.jsx(Jt,{value:_r,onChange:E=>Ts(E.target.value),placeholder:"بحث عن منتج بالاسم...",className:"pl-3 pr-9 h-10 border-0 bg-transparent focus-visible:ring-0 placeholder:text-gray-400"})]}),w.jsx("div",{className:"h-8 w-px bg-gray-200 hidden sm:block"}),w.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[w.jsxs("div",{className:"relative flex-1 sm:w-48 group",children:[w.jsx(d0,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-primary transition-colors"}),w.jsx(Jt,{value:xa,onChange:E=>Or(E.target.value),onKeyDown:async E=>{E.key==="Enter"&&xa.trim()&&(await l(xa.trim()),Or(""))},placeholder:"ماسح الباركود...",className:"pr-9 h-9 bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 focus:bg-white dark:focus:bg-gray-950 transition-all text-sm dark:text-gray-100"})]}),w.jsxs("div",{className:"flex items-center gap-1 border-r dark:border-gray-700 pr-2 mr-1",children:[w.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:wc,className:"hidden",id:"excel-upload",disabled:ht}),w.jsx("label",{htmlFor:"excel-upload",children:w.jsx(it,{variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-full cursor-pointer",asChild:!0,disabled:ht,children:w.jsx("span",{children:w.jsx(_d,{className:"h-4 w-4"})})})}),w.jsx(it,{variant:"ghost",size:"icon",onClick:i0,className:"h-9 w-9 shrink-0 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-full",title:"تصدير لملف Excel",children:w.jsx(yd,{className:"h-4 w-4"})}),w.jsxs(it,{variant:"ghost",size:"icon",onClick:()=>sa(!0),className:"h-9 w-9 shrink-0 transition-all rounded-full text-gray-500 hover:text-primary hover:bg-primary/10 relative",title:"عربة المبيعات",children:[w.jsx(xf,{className:"h-4 w-4"}),Hi>0&&w.jsx("span",{className:"absolute -top-2 -right-2 bg-red-600 text-white text-[10px] font-bold rounded-full h-5 w-5 flex items-center justify-center border-2 border-white shadow-sm",children:Hi})]}),w.jsx(it,{variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-full",title:"حذف جميع المنتجات نهائياً",onClick:Qi,disabled:ht||Me.length===0,children:w.jsx(ts,{className:"h-4 w-4"})}),w.jsxs(rf,{children:[w.jsx(af,{asChild:!0,children:w.jsx(it,{variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-full",title:"خيارات إضافية",children:w.jsx(df,{className:"h-4 w-4"})})}),w.jsx(nf,{align:"end",className:"w-48",children:w.jsxs(f0,{onClick:Qi,className:"text-red-600 focus:text-red-700 focus:bg-red-50 dark:focus:bg-red-950/30 cursor-pointer",children:[w.jsx(ts,{className:"h-4 w-4 ml-2"}),"حذف جميع المنتجات"]})})]})]})]})]}),w.jsx("div",{className:"space-y-4",children:ir.length===0?w.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 bg-white rounded-xl border border-dashed border-gray-200 text-center shadow-sm",children:[w.jsx("div",{className:"bg-gray-50 p-4 rounded-full mb-4",children:w.jsx(sf,{className:"h-10 w-10 text-gray-300"})}),w.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"لا توجد منتجات"}),w.jsx("p",{className:"text-gray-500 text-sm max-w-xs mx-auto mb-4",children:"لم يتم العثور على منتجات تطابق بحثك."}),w.jsxs(it,{variant:"outline",onClick:()=>K(!0),className:"gap-2",children:[w.jsx(li,{className:"h-4 w-4"}),"إضافة منتج جديد"]})]}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"hidden md:block bg-[#fcf9f2] dark:bg-card rounded-xl border border-gray-100 dark:border-border shadow-sm overflow-hidden",children:w.jsxs(co,{children:[w.jsx(lo,{className:"bg-gray-50/80 dark:bg-gray-900/80",children:w.jsxs(Fi,{className:"hover:bg-transparent border-gray-100 dark:border-gray-800",children:[w.jsx(xr,{className:"text-right h-11 font-semibold text-gray-700 dark:text-gray-300",children:"المنتج"}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-28",children:"السعر"}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-28",children:w.jsxs("div",{className:"flex items-center justify-center gap-1.5 cursor-pointer hover:text-primary transition-colors select-none",onClick:()=>{oa?yi(!1):vr("عرض سعر الجملة","أدخل الرقم السري الرئيسي لعرض سعر الجملة",()=>yi(!0))},children:[w.jsx("span",{children:"الجملة"}),oa?w.jsx(Ac,{className:"h-3.5 w-3.5"}):w.jsx(Ni,{className:"h-3.5 w-3.5"})]})}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-24",children:"الكمية"}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-[360px]",children:"إجراءات البيع"})]})}),w.jsx(fo,{children:ir.map(E=>w.jsxs(Fi,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 transition-colors border-gray-100 dark:border-gray-800",children:[w.jsxs(gr,{className:"font-medium py-3",children:[w.jsx("div",{className:"text-gray-900 dark:text-gray-100 font-bold",children:E.name}),E.barcode&&w.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-gray-500 dark:text-gray-400 font-mono mt-0.5",children:[w.jsx(d0,{className:"h-3 w-3"}),E.barcode]})]}),w.jsx(gr,{className:"text-center py-3",children:w.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-950/30 px-2 py-1 rounded-md",children:Wt(E.sellingPrice)})}),w.jsx(gr,{className:"text-center py-3",children:w.jsx("span",{className:`font-medium text-xs ${oa?"text-gray-600 dark:text-gray-400":"blur-sm select-none text-gray-300 dark:text-gray-600"}`,children:Wt(E.wholesalePrice)})}),w.jsx(gr,{className:"text-center py-3",children:w.jsxs("div",{className:"flex items-center justify-center gap-1",children:[w.jsx(ci,{variant:E.quantity>0?"outline":"destructive",className:`font-mono ${E.quantity>0?"bg-gray-50 dark:bg-gray-900 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700":""}`,children:E.quantity}),w.jsx(it,{size:"icon",variant:"ghost",className:"h-5 w-5 rounded-full text-emerald-600 hover:bg-emerald-50 hover:text-emerald-700",onClick:()=>Ns(E),title:"إضافة مخزون",children:w.jsx(li,{className:"h-3 w-3"})})]})}),w.jsx(gr,{className:"py-3",children:w.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[w.jsxs("div",{className:"relative group",children:[w.jsx(Jt,{type:"number",className:"h-8 w-14 text-center px-1 text-sm bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 focus:border-primary/50 dark:text-gray-100",placeholder:"0",value:Et[E.id]||"",onChange:B=>Kr(Z=>({...Z,[E.id]:B.target.value}))}),w.jsx("span",{className:"absolute -top-2 -right-1 text-[9px] bg-white dark:bg-gray-800 px-0.5 text-gray-400 rounded",children:"العدد"})]}),w.jsxs("div",{className:"relative group",children:[w.jsx(Jt,{type:"number",className:"h-8 w-16 text-center px-1 bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 focus:border-primary/50 text-sm focus:bg-white dark:focus:bg-gray-950 transition-colors dark:text-gray-100",placeholder:"سعر",value:wr[E.id]||"",onChange:B=>Es(Z=>({...Z,[E.id]:B.target.value})),title:"سعر بيع مخصص"}),w.jsx("span",{className:"absolute -top-2 -right-1 text-[9px] bg-white dark:bg-gray-800 px-0.5 text-gray-400 rounded",children:"مخصص"})]}),w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsx(it,{size:"sm",className:"h-8 bg-indigo-600 hover:bg-indigo-700 text-white shadow-sm px-3 font-medium",onClick:()=>Pa(E),children:"بيع"}),w.jsxs("div",{className:"flex items-center bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-md overflow-hidden",children:[w.jsx("button",{className:`px-2 h-8 text-[11px] ${(gt[E.id]||"cash")==="cash"?"bg-green-50 text-green-700 dark:bg-green-900/30":"text-gray-600 dark:text-gray-300"}`,onClick:()=>$0(B=>({...B,[E.id]:"cash"})),title:"الدفع نقدي",children:"كاش"}),w.jsx("button",{className:`px-2 h-8 text-[11px] border-r border-gray-200 dark:border-gray-700 ${(gt[E.id]||"cash")==="visa"?"bg-purple-50 text-purple-700 dark:bg-purple-900/30":"text-gray-600 dark:text-gray-300"}`,onClick:()=>$0(B=>({...B,[E.id]:"visa"})),title:"الدفع بالفيزا",children:"فيزا"})]})]}),w.jsx(it,{size:"icon",variant:"outline",className:"h-8 w-8 rounded-full border-indigo-200 text-indigo-600 hover:bg-indigo-50",onClick:()=>St(B=>({...B,[E.id]:Number(B[E.id]||0)+1})),title:"إضافة للفاتورة",children:w.jsx(li,{className:"h-4 w-4"})}),(Yt[E.id]||0)>0&&w.jsx(ci,{variant:"outline",className:"font-mono bg-indigo-50 text-indigo-700 border-indigo-200",children:Yt[E.id]}),w.jsxs(rf,{children:[w.jsx(af,{asChild:!0,children:w.jsx(it,{size:"icon",variant:"ghost",className:"h-8 w-8 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full",children:w.jsx(df,{className:"h-4 w-4"})})}),w.jsxs(nf,{align:"end",className:"w-40",children:[w.jsxs(f0,{onClick:()=>{ht||vr("تعديل المنتج","أدخل الرقم السري الرئيسي لتعديل بيانات المنتج",()=>i(E))},disabled:ht,children:[w.jsx(hf,{className:"h-3.5 w-3.5 ml-2 text-blue-600"}),"تعديل المنتج"]}),w.jsxs(f0,{onClick:()=>Ns(E),children:[w.jsx(li,{className:"h-3.5 w-3.5 ml-2 text-emerald-600"}),"إضافة مخزون"]}),w.jsxs(f0,{onClick:()=>{a0(E),ri(!0)},children:[w.jsx(oo,{className:"h-3.5 w-3.5 ml-2 text-amber-600"}),"بيع مؤجل"]}),w.jsxs(f0,{onClick:()=>Si(E),disabled:ht,className:"text-red-600 focus:text-red-700",children:[w.jsx(ts,{className:"h-3.5 w-3.5 ml-2"}),"حذف المنتج"]})]})]})]})})]},E.id))})]})}),w.jsx("div",{className:"md:hidden grid grid-cols-1 gap-3",children:ir.map(E=>w.jsx(kn,{className:"overflow-hidden border-gray-100 dark:border-gray-800 shadow-sm hover:shadow-md transition-shadow bg-[#fcf9f2] dark:bg-card",children:w.jsxs(so,{className:"p-4 space-y-4",children:[w.jsxs("div",{className:"flex justify-between items-start",children:[w.jsxs("div",{children:[w.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100 text-base",children:E.name}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[w.jsx(ci,{variant:"secondary",className:"bg-emerald-50 dark:bg-emerald-950/30 text-emerald-700 dark:text-emerald-400 border-emerald-100 dark:border-emerald-900/50",children:Wt(E.sellingPrice)}),w.jsxs("span",{className:`text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1 ${!oa&&"blur-sm select-none"}`,children:[w.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"جملة:"}),Wt(E.wholesalePrice)]}),w.jsx("span",{className:"text-gray-300 dark:text-gray-700",children:"|"}),w.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300 font-medium flex items-center gap-1",children:["متاح: ",E.quantity,w.jsx(it,{size:"icon",variant:"ghost",className:"h-5 w-5 rounded-full text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-950/30",onClick:()=>Ns(E),children:w.jsx(li,{className:"h-3 w-3"})})]})]})]}),w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsx(it,{size:"icon",variant:"ghost",className:"h-8 w-8 -mt-1 -ml-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-950/30 rounded-full",onClick:()=>{ht||vr("تعديل المنتج","أدخل الرقم السري الرئيسي لتعديل بيانات المنتج",()=>i(E))},disabled:ht,children:w.jsx(hf,{className:"h-4 w-4"})}),w.jsx(it,{size:"icon",variant:"ghost",className:"h-8 w-8 -mt-1 -ml-2 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>Si(E),disabled:ht,children:w.jsx(ts,{className:"h-4 w-4"})})]})]}),w.jsxs("div",{className:"flex items-center gap-2 bg-gray-50/50 dark:bg-gray-800/50 p-2 rounded-lg border border-gray-100 dark:border-gray-700",children:[w.jsxs("div",{className:"relative flex-1",children:[w.jsx(Jt,{type:"number",className:"h-9 w-full bg-white dark:bg-gray-900 text-center border-gray-200 dark:border-gray-700 focus:border-indigo-300 dark:text-gray-100",placeholder:"الكمية",value:Et[E.id]||"",onChange:B=>Kr(Z=>({...Z,[E.id]:B.target.value}))}),w.jsx("span",{className:"absolute inset-y-0 right-2 flex items-center text-[10px] text-gray-400 pointer-events-none",children:"عدد"})]}),w.jsxs("div",{className:"relative w-28",children:[w.jsx(Jt,{type:"number",className:"h-9 w-full bg-white dark:bg-gray-900 text-center border-gray-200 dark:border-gray-700 focus:border-indigo-300 dark:text-gray-100",placeholder:"سعر مخصص",value:wr[E.id]||"",onChange:B=>Es(Z=>({...Z,[E.id]:B.target.value}))}),w.jsx("span",{className:"absolute inset-y-0 right-2 flex items-center text-[10px] text-gray-400 pointer-events-none",children:"سعر"})]})]}),w.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[w.jsxs(it,{className:"h-10 bg-indigo-600 text-white hover:bg-indigo-700 shadow-sm font-bold",onClick:()=>Pa(E),children:[w.jsx(Rs,{className:"h-4 w-4 ml-2"}),"بيع فوري"]}),w.jsxs(it,{variant:"outline",className:"h-10 border-amber-200 text-amber-700 bg-amber-50 hover:bg-amber-100 dark:bg-amber-950/30 dark:border-amber-900/50 dark:text-amber-400 font-bold",onClick:()=>{a0(E),ri(!0)},children:[w.jsx(oo,{className:"h-4 w-4 ml-2"}),"بيع أجل"]}),w.jsxs(it,{variant:"outline",className:"h-10 border-indigo-200 text-indigo-700 bg-indigo-50 hover:bg-indigo-100 dark:bg-indigo-950/30 dark:border-indigo-900/50 dark:text-indigo-400 font-bold",onClick:()=>St(B=>({...B,[E.id]:Number(B[E.id]||0)+1})),title:"إضافة للفاتورة",children:[w.jsx(li,{className:"h-4 w-4 ml-2"}),"إضافة +"]})]}),(Yt[E.id]||0)>0&&w.jsx("div",{className:"pt-3 border-t border-dashed border-gray-200 dark:border-gray-700",children:w.jsxs("div",{className:"text-xs text-indigo-700 dark:text-indigo-400",children:["مضاف للفاتورة: ",Yt[E.id]]})})]})},E.id))})]})})]})})}),w.jsx(Nc,{value:"categories",className:"flex-1 p-0 m-0 overflow-hidden h-full relative",children:w.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-thin bg-gray-50/50 dark:bg-gray-950/50",children:w.jsx("div",{className:"p-4",children:Ei?w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"flex flex-col gap-4",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs(it,{variant:"ghost",size:"sm",onClick:()=>_i(null),className:"hover:bg-gray-100 dark:hover:bg-gray-800 dark:text-gray-200",children:[w.jsx(uf,{className:"h-4 w-4 ml-1"}),"رجوع"]}),w.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:Ei.name})]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[w.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-border rounded-xl p-3 shadow-sm flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"bg-indigo-50 dark:bg-indigo-950/30 p-2 rounded-lg",children:w.jsx(sf,{className:"h-4 w-4 text-indigo-600 dark:text-indigo-400"})}),w.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:"عدد المنتجات"})]}),w.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:Me.filter(E=>E.categoryId===Ei.id).length})]}),w.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-border rounded-xl p-3 shadow-sm flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"bg-amber-50 dark:bg-amber-950/30 p-2 rounded-lg",children:w.jsx(Rs,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),w.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:"إجمالي الجملة (لهذا القسم)"})]}),w.jsx("span",{className:"text-lg font-bold text-amber-700 dark:text-amber-400",children:Wt(Me.filter(E=>E.categoryId===Ei.id).reduce((E,B)=>E+(Number(B.wholesalePrice)||0)*(Number(B.quantity)||0),0))})]})]})]}),w.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:Me.filter(E=>E.categoryId===Ei.id).length===0?w.jsx("div",{className:"col-span-full text-center py-10 text-gray-500 dark:text-gray-400 bg-white dark:bg-card rounded-lg border border-dashed border-gray-300 dark:border-gray-700",children:"لا توجد منتجات في هذا القسم"}):Me.filter(E=>E.categoryId===Ei.id).map(E=>w.jsx(kn,{className:"overflow-hidden hover:shadow-md transition-all group relative bg-white dark:bg-card border-gray-200 dark:border-gray-700 cursor-pointer",onClick:()=>handleAddProductToInvoice(E),children:w.jsxs("div",{className:"p-3",children:[w.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate text-right",title:E.name,children:E.name}),w.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[w.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400",children:Wt(E.sellingPrice)}),w.jsx(ci,{variant:"outline",className:"text-xs dark:text-gray-300 dark:border-gray-600",children:E.quantity})]})]})},E.id))})]}):w.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[w.jsxs(kn,{className:"border-dashed border-2 border-emerald-200 dark:border-emerald-800/50 hover:border-emerald-400 dark:hover:border-emerald-700 hover:bg-emerald-50/50 dark:hover:bg-emerald-950/20 transition-all cursor-pointer flex flex-col items-center justify-center p-6 h-32 group dark:bg-card/50",onClick:()=>ti(!0),children:[w.jsx("div",{className:"bg-emerald-100 dark:bg-emerald-900/30 p-3 rounded-full mb-2 group-hover:scale-110 transition-transform",children:w.jsx(li,{className:"h-6 w-6 text-emerald-600 dark:text-emerald-400"})}),w.jsx("span",{className:"font-semibold text-emerald-700 dark:text-emerald-400",children:"إضافة قسم جديد"})]}),As.map(E=>w.jsxs(kn,{className:"overflow-hidden hover:shadow-md transition-all h-32 flex flex-col items-center justify-center relative group bg-white dark:bg-card border-gray-100 dark:border-gray-700 cursor-pointer",onClick:()=>_i(E),children:[w.jsx("div",{className:"absolute top-2 left-2 z-10",children:w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",onClick:B=>Ea(E.id,B),title:"حذف القسم",children:w.jsx(ts,{className:"h-4 w-4"})})}),w.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-100 text-center px-2",children:E.name}),w.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[Me.filter(B=>B.categoryId===E.id).length," منتج"]})]},E.id))]})})})}),w.jsx(Nc,{value:"sales-log",className:"flex-1 p-0 m-0 overflow-hidden h-full relative",children:w.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-thin",children:w.jsxs("div",{className:"p-4 space-y-4 min-h-full",children:[w.jsx("div",{className:"md:hidden",children:w.jsxs(it,{variant:"outline",className:"w-full justify-between bg-white dark:bg-card border-dashed border-2 border-gray-200 dark:border-gray-700 h-12 text-gray-700 dark:text-gray-200 hover:text-primary hover:border-primary/50 hover:bg-primary/5 shadow-sm",onClick:()=>Ln(!0),children:[w.jsxs("span",{className:"flex items-center gap-2 font-semibold",children:[w.jsx(_c,{className:"h-4 w-4 text-primary"}),"تفاصيل اليوم"]}),w.jsx("span",{className:"text-xs text-muted-foreground font-normal bg-gray-50 dark:bg-gray-800 px-2 py-1 rounded-full border dark:border-gray-700",children:"اضغط لعرض التقارير"})]})}),w.jsxs("div",{className:"flex flex-wrap items-end gap-2 bg-white dark:bg-card p-3 rounded-lg border border-gray-100 dark:border-gray-700 shadow-sm",children:[w.jsxs("div",{className:"grid gap-1",children:[w.jsx(or,{className:"text-[10px] text-gray-500 dark:text-gray-400",children:"من تاريخ"}),w.jsxs(of,{children:[w.jsx(cf,{asChild:!0,children:w.jsxs(it,{variant:"outline",className:ef("h-8 w-[140px] justify-start text-right font-normal text-xs dark:bg-gray-900 dark:border-gray-700 dark:text-gray-200",!he&&"text-muted-foreground"),children:[w.jsx(Ao,{className:"ml-2 h-3.5 w-3.5"}),he?_o(new Date(he),"P",{locale:So}):w.jsx("span",{children:"اختر تاريخ"})]})}),w.jsx(lf,{className:"w-auto p-0",align:"start",children:w.jsx(ff,{mode:"single",selected:he?new Date(he):void 0,onSelect:E=>te(E?_o(E,"yyyy-MM-dd"):""),initialFocus:!0,locale:So})})]})]}),w.jsxs("div",{className:"grid gap-1",children:[w.jsx(or,{className:"text-[10px] text-gray-500 dark:text-gray-400",children:"إلى تاريخ"}),w.jsxs(of,{children:[w.jsx(cf,{asChild:!0,children:w.jsxs(it,{variant:"outline",className:ef("h-8 w-[140px] justify-start text-right font-normal text-xs dark:bg-gray-900 dark:border-gray-700 dark:text-gray-200",!be&&"text-muted-foreground"),children:[w.jsx(Ao,{className:"ml-2 h-3.5 w-3.5"}),be?_o(new Date(be),"P",{locale:So}):w.jsx("span",{children:"اختر تاريخ"})]})}),w.jsx(lf,{className:"w-auto p-0",align:"start",children:w.jsx(ff,{mode:"single",selected:be?new Date(be):void 0,onSelect:E=>$e(E?_o(E,"yyyy-MM-dd"):""),initialFocus:!0,locale:So})})]})]}),w.jsxs(it,{size:"sm",onClick:ae,className:"h-8 gap-1 bg-indigo-600 hover:bg-indigo-700 text-white",children:[w.jsx(kc,{className:"h-3.5 w-3.5"}),w.jsx("span",{className:"hidden sm:inline",children:"بحث"})]}),(he||be)&&w.jsx(it,{size:"sm",variant:"ghost",onClick:tt,className:"h-8 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/30",children:"إلغاء"})]}),j.length===0?w.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-12 px-4 bg-[#fcf9f2]/50 dark:bg-card/50 rounded-xl border border-dashed border-gray-200 dark:border-gray-700 text-center",children:[w.jsx("div",{className:"bg-[#fcf9f2] dark:bg-gray-800 p-4 rounded-full shadow-sm mb-4",children:w.jsx(bc,{className:"h-8 w-8 text-gray-400"})}),w.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-1",children:"لا توجد مبيعات"}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:he||be?"لم يتم العثور على مبيعات في الفترة المحددة.":"لم يتم تسجيل أي عمليات بيع اليوم."})]}):w.jsxs("div",{className:"space-y-4",children:[w.jsx("div",{className:"hidden md:block bg-[#fcf9f2] dark:bg-card rounded-xl border border-gray-100 dark:border-gray-700 shadow-sm overflow-hidden",children:w.jsxs(co,{children:[w.jsx(lo,{className:"bg-gray-50/80 dark:bg-gray-800",children:w.jsxs(Fi,{className:"hover:bg-transparent",children:[w.jsx(xr,{className:"text-right h-11 font-semibold text-gray-700 dark:text-gray-300",children:"المنتج"}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"السعر"}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"الكمية"}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"الإجمالي"}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"طريقة الدفع"}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:w.jsxs("div",{className:"flex items-center justify-center gap-1.5 cursor-pointer hover:text-primary transition-colors select-none",onClick:()=>{Er?Ka(!1):vr("عرض ربح المبيعات","أدخل الرقم السري الرئيسي لعرض ربح كل عملية بيع",()=>Ka(!0))},children:[w.jsx("span",{children:"الربح"}),Er?w.jsx(Ac,{className:"h-3.5 w-3.5"}):w.jsx(Ni,{className:"h-3.5 w-3.5"})]})}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"التاريخ"}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"الوقت"}),w.jsx(xr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"إجراءات"})]})}),w.jsx(fo,{children:j.map(E=>w.jsxs(Fi,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 transition-colors dark:border-gray-800",children:[w.jsxs(gr,{className:"py-3",children:[w.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100 flex flex-col gap-0.5",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{className:E.cartItems&&E.cartItems.length>0?"cursor-pointer hover:text-indigo-600 dark:hover:text-indigo-400 underline-offset-4 hover:underline":"",onClick:()=>E.cartItems&&E.cartItems.length>0&&Ut(E),children:E.productName}),E.cartItems&&E.cartItems.length>0&&w.jsx(it,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 rounded-full hover:bg-indigo-100 dark:hover:bg-indigo-950/30 text-indigo-600 dark:text-indigo-400",onClick:()=>Ut(E),title:"عرض التفاصيل",children:w.jsx(Ni,{className:"h-3.5 w-3.5"})})]}),E.performedByType==="cashier"&&E.performedByName&&w.jsxs("div",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:["تم بواسطة الكاشير: ",w.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-200",children:E.performedByName})]})]}),E.isDeferred&&w.jsx(ci,{variant:"secondary",className:"mt-1 text-[10px] bg-amber-100 dark:bg-amber-950/30 text-amber-700 dark:text-amber-400 border-amber-200 dark:border-amber-900/50",children:"مؤجل"})]}),w.jsx(gr,{className:"text-center py-3 text-gray-700 dark:text-gray-300",children:Wt(E.price)}),w.jsx(gr,{className:"text-center py-3",children:w.jsx(ci,{variant:"outline",className:"font-mono bg-gray-50 dark:bg-gray-900 dark:text-gray-300 dark:border-gray-700",children:E.quantity})}),w.jsx(gr,{className:"text-center font-bold text-green-600 dark:text-green-400 py-3",children:Wt(E.price*E.quantity)}),w.jsx(gr,{className:"text-center py-3",children:w.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${(E.paymentMethod||"cash")==="cash"?"bg-green-50 text-green-700":"bg-purple-50 text-purple-700"}`,children:(E.paymentMethod||"cash")==="cash"?"كاش":"فيزا"})}),w.jsx(gr,{className:"text-center text-indigo-600 dark:text-indigo-400 py-3",children:w.jsx("span",{className:Er?"":"blur-sm select-none text-gray-300 dark:text-gray-700",children:Wt(((E.price??0)-(E.wholesalePrice??0))*E.quantity)})}),w.jsx(gr,{className:"text-center text-gray-500 dark:text-gray-400 text-xs py-3 font-mono",children:jo(E.date)}),w.jsx(gr,{className:"text-center text-gray-500 dark:text-gray-400 text-xs py-3 font-mono",children:E.time}),w.jsx(gr,{className:"py-3",children:w.jsxs("div",{className:"flex justify-center gap-2",children:[E.isDeferred&&w.jsx(it,{size:"sm",variant:"outline",className:"h-8 text-xs border-amber-200 text-amber-700 bg-amber-50 hover:bg-amber-100 dark:bg-amber-950/30 dark:border-amber-900/50 dark:text-amber-400",onClick:()=>vr("تأكيد سداد بيع مؤجل","أدخل الرقم السري الرئيسي لتأكيد السداد",()=>n0(E)),children:"سداد"}),w.jsx(it,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>Cs(E,"return"),title:"مرتجع",children:w.jsx(bo,{className:"h-4 w-4"})}),w.jsx(it,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>Cs(E,"delete"),title:"حذف نهائي",children:w.jsx(md,{className:"h-4 w-4"})})]})})]},E.id))})]})}),w.jsx("div",{className:"md:hidden space-y-3",children:j.map(E=>w.jsx(kn,{className:"overflow-hidden border-gray-100 dark:border-gray-700 shadow-sm bg-[#fcf9f2] dark:bg-card",children:w.jsxs(so,{className:"p-4",children:[w.jsxs("div",{className:"flex justify-between items-start mb-3",children:[w.jsxs("div",{children:[w.jsxs("h4",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm flex items-center gap-2",children:[w.jsx("span",{className:E.cartItems&&E.cartItems.length>0?"cursor-pointer hover:text-indigo-600 dark:hover:text-indigo-400 underline-offset-4 hover:underline":"",onClick:()=>E.cartItems&&E.cartItems.length>0&&Ut(E),children:E.productName}),E.cartItems&&E.cartItems.length>0&&w.jsx(it,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 rounded-full hover:bg-indigo-100 dark:hover:bg-indigo-950/30 text-indigo-600 dark:text-indigo-400",onClick:()=>Ut(E),children:w.jsx(Ni,{className:"h-3.5 w-3.5"})})]}),w.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 flex flex-wrap items-center gap-2",children:[w.jsx("span",{className:"bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded text-gray-600 dark:text-gray-300 font-mono",children:E.time}),w.jsx("span",{className:"text-gray-400 dark:text-gray-600",children:"|"}),w.jsx("span",{children:jo(E.date)}),E.isDeferred&&w.jsx(ci,{variant:"outline",className:"text-[10px] bg-amber-50 dark:bg-amber-950/30 text-amber-700 dark:text-amber-400 border-amber-100 dark:border-amber-900/50 px-1.5 py-0 h-5",children:"مؤجل"}),E.performedByType==="cashier"&&E.performedByName&&w.jsxs(w.Fragment,{children:[w.jsx("span",{className:"text-gray-400 dark:text-gray-600",children:"|"}),w.jsxs("span",{className:"text-[11px] text-gray-500 dark:text-gray-300",children:["كاشير: ",w.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-100",children:E.performedByName})]})]})]})]}),w.jsxs("div",{className:"text-left",children:[w.jsx("div",{className:"font-bold text-green-600 dark:text-green-400 text-sm",children:Wt(E.price*E.quantity)}),w.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-0.5",children:[E.quantity," × ",Wt(E.price)]}),w.jsx("div",{className:"mt-1",children:w.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-medium ${(E.paymentMethod||"cash")==="cash"?"bg-green-50 text-green-700":"bg-purple-50 text-purple-700"}`,children:(E.paymentMethod||"cash")==="cash"?"كاش":"فيزا"})})]})]}),w.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-50 dark:border-gray-800",children:[E.isDeferred&&w.jsx(it,{size:"sm",variant:"ghost",className:"h-8 text-xs text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-950/30 hover:bg-amber-100 dark:hover:bg-amber-900/50",onClick:()=>vr("تأكيد سداد بيع مؤجل","أدخل الرقم السري الرئيسي لتأكيد السداد",()=>n0(E)),children:"تسديد"}),w.jsxs(it,{size:"sm",variant:"ghost",className:"h-8 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-950/30",onClick:()=>Cs(E,"return"),children:[w.jsx(bo,{className:"h-3.5 w-3.5 ml-1.5"}),"مرتجع"]}),w.jsx(it,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-gray-400 dark:text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>Cs(E,"delete"),children:w.jsx(ts,{className:"h-4 w-4"})})]})]})},E.id))})]})]})})})]})})]})]}),w.jsx(it,{variant:"ghost",size:"icon",className:"fixed bottom-6 right-6 h-14 w-14 rounded-full bg-red-600 text-white shadow-lg hover:bg-red-700 hover:scale-105 transition-all duration-300 z-[60] animate-in fade-in zoom-in",onClick:E=>{E.preventDefault(),E.stopPropagation(),r()},children:w.jsx(uf,{className:"h-6 w-6"})})]}),w.jsx(Cn,{open:cr,onOpenChange:sa,children:w.jsxs(Tn,{className:"sm:max-w-md",dir:"rtl",children:[w.jsxs(ki,{children:[w.jsxs(Nn,{className:"flex items-center gap-2",children:[w.jsx(xf,{className:"h-5 w-5 text-primary"}),"عربة المبيعات"]}),w.jsx(Ii,{className:"text-xs",children:"راجع المنتجات المختارة، عدّل اسم المحل، ثم بع أو اطبع الفاتورة"})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-3 rounded-lg space-y-2 border border-dashed border-gray-200 dark:border-gray-700",children:[w.jsx(or,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"بيانات الفاتورة (اختياري)"}),w.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[w.jsx(Jt,{value:Mt,onChange:E=>Qe(E.target.value),placeholder:(Y==null?void 0:Y.shopName)||(A==null?void 0:A.displayName)||"اسم المحل",className:"h-8 text-xs bg-white dark:bg-gray-900"}),w.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[w.jsx(Jt,{value:br,onChange:E=>ar(E.target.value),placeholder:(Y==null?void 0:Y.phone)||"رقم التليفون",className:"h-8 text-xs bg-white dark:bg-gray-900"}),w.jsx(Jt,{value:pr,onChange:E=>Mn(E.target.value),placeholder:(Y==null?void 0:Y.address)||"العنوان",className:"h-8 text-xs bg-white dark:bg-gray-900"})]})]})]}),w.jsx(ho,{}),w.jsxs("div",{className:"space-y-2 relative",children:[w.jsx(or,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"إضافة منتج للفاتورة"}),w.jsxs("div",{className:"flex gap-2 relative",children:[w.jsxs("div",{className:"relative flex-1",children:[w.jsx(kc,{className:"absolute right-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400"}),w.jsx(Jt,{value:Bt,onChange:E=>{const B=E.target.value,Z=Sn(B);Ya(Z),/^[0-9]+$/.test(Z)&&Me.find(Se=>String(Se.barcode||"")===Z)&&f(Z)},onKeyDown:E=>{E.key==="Enter"&&f(Sn(Bt))},placeholder:"بحث بالاسم أو الباركود...",className:"h-9 pr-8 text-xs",autoComplete:"off"})]}),w.jsx(it,{size:"icon",variant:"outline",className:"h-9 w-9 shrink-0",onClick:()=>{fn?x():u()},title:fn?"إغلاق الكاميرا":"فتح الكاميرا",children:fn?w.jsx(c0,{className:"h-4 w-4 text-red-500"}):w.jsx(d0,{className:"h-4 w-4"})})]}),fn&&w.jsxs("div",{className:"relative bg-black rounded-lg overflow-hidden border border-gray-200 shadow-sm mt-2",children:[w.jsx("div",{id:"cart-scanner-container",className:"w-full h-[200px]"}),w.jsx(it,{size:"sm",variant:"ghost",className:"absolute top-2 right-2 text-white bg-black/50 hover:bg-black/70 h-6 w-6 p-0 rounded-full",onClick:x,children:w.jsx(c0,{className:"h-3 w-3"})})]}),Bt&&Bt.length>1&&!fn&&w.jsxs("div",{className:"border rounded-md max-h-40 overflow-y-auto bg-white dark:bg-gray-800 shadow-lg absolute z-50 w-full top-full mt-1",children:[Me.filter(E=>{var B;return E.name.toLowerCase().includes(Bt.toLowerCase())||((B=E.barcode)==null?void 0:B.includes(Bt))}).slice(0,10).map(E=>w.jsxs("div",{className:"p-2 text-xs border-b last:border-0 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer flex justify-between items-center",onClick:()=>{St(B=>({...B,[E.id]:Number(B[E.id]||0)+1})),Ya(""),Te({title:"تمت الإضافة",description:`تم إضافة ${E.name}`})},children:[w.jsx("span",{className:"font-medium",children:E.name}),w.jsx("span",{className:"text-emerald-600",children:Wt(E.sellingPrice)})]},E.id)),Me.filter(E=>{var B;return E.name.toLowerCase().includes(Bt.toLowerCase())||((B=E.barcode)==null?void 0:B.includes(Bt))}).length===0&&w.jsx("div",{className:"p-2 text-xs text-center text-gray-500",children:"لا توجد نتائج"})]})]}),w.jsxs("div",{className:"text-xs text-gray-500",children:["التاريخ والوقت: ",new Date().toLocaleString("ar-EG")]}),w.jsx(ho,{}),w.jsxs("div",{className:"space-y-2 max-h-64 overflow-auto",children:[Object.entries(Yt).filter(([E,B])=>Number(B)>0).map(([E,B])=>{const Z=Me.find(Fe=>Fe.id===E),de=Number(B);if(!Z||!de)return null;const Se=de*Z.sellingPrice;return w.jsxs("div",{className:"flex items-center justify-between gap-2",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("div",{className:"font-medium text-gray-900 text-sm",children:Z.name}),w.jsxs("div",{className:"text-xs text-gray-500",children:["سعر: ",Wt(Z.sellingPrice)]})]}),w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsx(it,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:()=>St(Fe=>({...Fe,[E]:Math.max(0,Number(Fe[E]||0)-1)})),children:"-"}),w.jsx(ci,{variant:"outline",className:"font-mono bg-indigo-50 text-indigo-700 border-indigo-200",children:de}),w.jsx(it,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:()=>St(Fe=>({...Fe,[E]:Number(Fe[E]||0)+1})),children:"+"})]}),w.jsx("div",{className:"w-24 text-left font-semibold text-emerald-700",children:Wt(Se)})]},E)}),Object.entries(Yt).filter(([E,B])=>Number(B)>0).length===0&&w.jsx("div",{className:"text-center text-sm text-gray-500",children:"لا توجد منتجات مضافة. استخدم زر + بجوار المنتجات."})]}),w.jsx(ho,{}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"font-bold",children:"الإجمالي:"}),w.jsx("span",{className:"font-bold text-emerald-700",children:Wt(Object.entries(Yt).reduce((E,[B,Z])=>{const de=Me.find(Fe=>Fe.id===B),Se=Number(Z)||0;return E+(de?Se*de.sellingPrice:0)},0))})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[w.jsx(it,{className:"bg-indigo-600 text-white hover:bg-indigo-700",onClick:async()=>{const E=Object.entries(Yt).filter(([Z,de])=>Number(de)>0);if(E.length===0){Te({title:"لا توجد منتجات",description:"أضف منتجات للعربة أولاً"});return}const B=[];for(const[Z,de]of E){const Se=Me.find(Ue=>Ue.id===Z),Fe=Number(de);if(!(!Se||!Fe)){if(Fe>Se.quantity){Te({title:"كمية غير كافية",description:`الكمية المطلوبة للمنتج ${Se.name} غير متوفرة (المتاح: ${Se.quantity})`,variant:"destructive"});return}B.push({prod:Se,qty:Fe})}}sa(!1),St({}),Te({title:"جاري التنفيذ",description:"يتم الآن معالجة عملية البيع..."});try{const Z=new Date,de=dn(),Se=ht&&lt?"cashier":"admin",Fe=Se==="cashier"?(lt==null?void 0:lt.name)||"كاشير":(Y==null?void 0:Y.fullName)||(A==null?void 0:A.displayName)||"الحساب الرئيسي",Ue=Se==="cashier"&&(lt==null?void 0:lt.username)||null,Ne=A!=null&&A.uid?`CART-${A.uid}-${Date.now()}`:void 0;if(B.length>0){let se=0,ye=0;const we=[],Ge=[];for(const{prod:et,qty:Dt}of B){se+=et.sellingPrice*Dt,ye+=(et.wholesalePrice||0)*Dt;const Qt=et.quantity-Dt;we.push({id:et.id,qty:Qt}),Ge.push({productId:et.id,productName:et.name,quantity:Dt,price:et.sellingPrice,wholesalePrice:et.wholesalePrice,barcode:et.barcode})}const ke={id:Date.now().toString(),productName:`فاتورة مجمعة (${B.length} منتج)`,price:se,wholesalePrice:ye,quantity:1,date:de,time:Z.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),createdAtMs:Z.getTime(),performedByType:Se,performedByName:Fe,performedByUsername:Ue,isDeferred:!1,transactionReference:Ne,cartItems:Ge},Ie=await Ja(ke),wt=Ie?{...ke,firestoreId:Ie}:ke;for(const{prod:et,qty:Dt}of B){const Qt=et.quantity-Dt;await tn(fa(ut,"products",et.id),{quantity:Qt,updatedAt:ba()}),Qt===0&&ro(et.name)}if(A!=null&&A.uid&&Ne){const et={txnType:"sales",type:"sales",amount:se,status:"confirmed",senderMsisdn:"مبيعات",receiverMsisdn:"",reference:Ne,title:"فاتورة مبيعات مجمعة",merchantUserId:A.uid,createdBy:A.uid,shopId:(Y==null?void 0:Y.shopId)||ze||void 0,cashierName:Fe,performedByType:Se,performedByUsername:Ue,saleProductName:`فاتورة مجمعة (${B.length} منتج)`,saleQuantity:1,createdAt:new Date};await Xn.saveUserTransaction(A.uid,et)}ft(et=>et.map(Dt=>{const Qt=we.find(Pt=>Pt.id===Dt.id);return Qt?{...Dt,quantity:Qt.qty}:Dt})),Ee(et=>{const Dt=[wt,...et],Qt=ze||(Y==null?void 0:Y.shopId)||"main",Pt=dn(),Zt=`salesData_${A==null?void 0:A.uid}_${Qt}_${Pt}`,Xt=`salesData_all_${A==null?void 0:A.uid}_${Qt}`;localStorage.setItem(Zt,JSON.stringify(Dt));try{const Mr=localStorage.getItem(Xt),Gr=Mr?JSON.parse(Mr):[],Ti=[wt,...Array.isArray(Gr)?Gr:[]];localStorage.setItem(Xt,JSON.stringify(Ti))}catch(Mr){console.warn("Failed to update all sales storage:",Mr)}return Dt}),It(et=>et+se);const At=se-ye;ra(et=>et+At),kt(et=>et+At),Te({title:"تم البيع بنجاح",description:"تم حفظ الفاتورة المجمعة وخصم الكميات"});try{const et=Gn(),Dt=localStorage.getItem(et),Pt=(Dt?parseFloat(Dt):0)+se;if(localStorage.setItem(et,Pt.toString()),A!=null&&A.uid){const Zt={cashBalance:Pt,lastUpdated:new Date().toISOString()};await Xn.updateUserData(A.uid,Zt);const Xt=(Y==null?void 0:Y.shopId)||ze;Xt&&await tn(fa(ut,"dashboardData",Xt),{cashBalance:Pt})}window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:Pt}}))}catch(et){console.warn("Error updating cash balance batch:",et)}Te({title:"تم البيع بنجاح",description:`تم بيع الفاتورة بإجمالي ${Wt(se)}`})}}catch(Z){console.error("Batch sell error:",Z),Te({title:"خطأ",description:"حدث خطأ أثناء معالجة البيع",variant:"destructive"})}},children:"بيع"}),w.jsx(it,{variant:"outline",onClick:()=>p(),className:"border-indigo-200 text-indigo-700 hover:bg-indigo-50",children:"طباعة فاتورة"})]})]})}),w.jsx(Cn,{open:Z0,onOpenChange:ri,children:w.jsxs(Tn,{className:"max-w-sm mx-auto bg-white dark:bg-card border border-gray-100 dark:border-border shadow-xl rounded-2xl sm:max-w-md p-6 gap-5",children:[w.jsxs(ki,{className:"text-center space-y-2",children:[w.jsx("div",{className:"mx-auto bg-amber-100 dark:bg-amber-900/30 p-3 rounded-full w-fit",children:w.jsx(oo,{className:"h-6 w-6 text-amber-600 dark:text-amber-500"})}),w.jsx(Nn,{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"تسجيل بيع أجل"}),w.jsx(Ii,{className:"text-gray-500 dark:text-gray-400 text-sm",children:"أدخل بيانات العميل لتسجيل عملية البيع الآجل"})]}),w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[w.jsx(or,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"اختيار عميل (اختياري)"}),w.jsxs("div",{className:"relative",children:[w.jsxs("select",{className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background dark:bg-gray-900 px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none dark:text-gray-100",value:J0,onChange:E=>{const B=E.target.value;gc(B);const Z=yt.find(de=>de.id===B);Z&&(nr(Z.name),Ki(Z.mobile||""))},children:[w.jsx("option",{value:"",children:"-- اختر عميل مسجل --"}),yt.map(E=>w.jsxs("option",{value:E.id,children:[E.name,E.mobile?` - ${E.mobile}`:""]},E.id))]}),w.jsx(uo,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]})]}),w.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[w.jsxs(or,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["اسم العميل ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(Jt,{value:Q0,onChange:E=>nr(E.target.value),placeholder:"أدخل اسم العميل...",className:"h-10 dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100"})]}),w.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[w.jsx(or,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"رقم التليفون (اختياري)"}),w.jsx(Jt,{value:r0,onChange:E=>Ki(E.target.value),placeholder:"أدخل رقم التليفون...",className:"h-10 dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100"})]})]}),w.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[w.jsx(it,{variant:"outline",className:"flex-1 h-10 border-gray-200 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",onClick:()=>ri(!1),children:"إلغاء"}),w.jsx(it,{className:"flex-1 h-10 bg-amber-600 hover:bg-amber-700 text-white shadow-sm",onClick:async()=>{try{const E=Wn;if(!E){ri(!1);return}const B=Q0.trim(),Z=r0.trim()||void 0,de=J0||void 0;if(!B){Te({title:"بيانات مطلوبة",description:"أدخل اسم العميل",variant:"destructive"});return}await Pa(E,!0,{id:de,name:B,mobile:Z});try{if(A!=null&&A.uid){const Se=E.sellingPrice*(parseInt(Et[E.id]||"0")||0),Fe=await Xn.getUserData(A.uid),Ue=Array.isArray(Fe==null?void 0:Fe.debts)?Fe.debts:[],Ne={id:Date.now().toString(),debtorName:B,customerId:de||null,mobile:Z||null,amount:Se,reason:`بيع أجل للمنتج ${E.name}`,status:"pending",createdAt:new Date,partialPayments:[]},se=[Ne,...Ue];Xn.updateUserData(A.uid,{debts:se}).catch(()=>{});try{const ye=ze||(Y==null?void 0:Y.shopId)||"main";localStorage.setItem(`debts_${A.uid}_${ye}`,JSON.stringify(se)),localStorage.setItem(`debts_default_${ye}`,JSON.stringify(se)),localStorage.setItem(`debts_last_write_${A.uid}_${ye}`,Date.now().toString())}catch{}try{window.dispatchEvent(new CustomEvent("debtsUpdated",{detail:{count:se.length}}))}catch{}try{td.send(A.uid,`تم إضافة دين على ${Ne.debtorName} بمبلغ ${Ne.amount} جنيه`).catch(()=>{})}catch{}}}catch{}ri(!1),a0(null)}catch{}},children:"تأكيد البيع"})]})]})}),w.jsx(Cn,{open:ca,onOpenChange:ge,children:w.jsxs(Tn,{className:"sm:max-w-4xl max-h-[85vh] flex flex-col p-0 overflow-hidden gap-0 bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",children:[w.jsxs("div",{className:"p-4 border-b dark:border-gray-800 flex items-center justify-between bg-gray-50/50 dark:bg-gray-800/50",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"bg-white dark:bg-gray-700 p-2 rounded-full border dark:border-gray-600 shadow-sm",children:w.jsx(bc,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),w.jsxs("div",{children:[w.jsx(Nn,{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:"سجل الإيصالات"}),w.jsx(Ii,{className:"text-xs text-gray-500 dark:text-gray-400",children:"عرض تفاصيل عمليات البيع الفورية"})]})]}),w.jsx(it,{variant:"ghost",size:"icon",onClick:()=>ge(!1),className:"rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800",children:w.jsx(c0,{className:"h-5 w-5"})})]}),w.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:j.filter(E=>!E.isDeferred).length===0?w.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[w.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-full mb-3",children:w.jsx(bc,{className:"h-8 w-8 text-gray-300 dark:text-gray-600"})}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"لا توجد إيصالات بيع حتى الآن"})]}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"hidden md:block border dark:border-gray-800 rounded-xl overflow-hidden shadow-sm",children:w.jsxs(co,{children:[w.jsx(lo,{className:"bg-gray-50/80 dark:bg-gray-800",children:w.jsxs(Fi,{className:"hover:bg-transparent dark:border-gray-800",children:[w.jsx(xr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"المنتج"}),w.jsx(xr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"سعر البيع"}),w.jsx(xr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"سعر الجملة"}),w.jsx(xr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"الكمية"}),w.jsx(xr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"الإجمالي"}),w.jsx(xr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"طريقة الدفع"}),w.jsx(xr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:w.jsxs("div",{className:"flex items-center justify-end gap-1.5 cursor-pointer hover:text-primary transition-colors select-none",onClick:()=>{Er?Ka(!1):vr("عرض ربح المبيعات","أدخل الرقم السري الرئيسي لعرض ربح كل عملية بيع",()=>Ka(!0))},children:[w.jsx("span",{children:"الربح"}),Er?w.jsx(Ac,{className:"h-3.5 w-3.5"}):w.jsx(Ni,{className:"h-3.5 w-3.5"})]})}),w.jsx(xr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"التاريخ"}),w.jsx(xr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"الوقت"}),w.jsx(xr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"المنفذ"})]})}),w.jsx(fo,{children:j.filter(E=>!E.isDeferred).map(E=>w.jsxs(Fi,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 dark:border-gray-800",children:[w.jsx(gr,{className:"font-medium text-gray-900 dark:text-gray-100 py-3",children:E.productName}),w.jsx(gr,{className:"text-gray-700 dark:text-gray-300 py-3",children:Wt(E.price)}),w.jsx(gr,{className:"text-gray-700 dark:text-gray-300 py-3",children:Wt(E.wholesalePrice??0)}),w.jsx(gr,{className:"text-gray-700 dark:text-gray-300 py-3 font-mono",children:R1(E.quantity)}),w.jsx(gr,{className:"text-gray-700 dark:text-gray-300 py-3 font-bold text-emerald-600 dark:text-emerald-400",children:Wt((E.price??0)*(E.quantity??0))}),w.jsx(gr,{className:"text-gray-700 dark:text-gray-300 py-3",children:w.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${(E.paymentMethod||"cash")==="cash"?"bg-green-50 text-green-700":"bg-purple-50 text-purple-700"}`,children:(E.paymentMethod||"cash")==="cash"?"كاش":"فيزا"})}),w.jsx(gr,{className:"text-gray-700 dark:text-gray-300 py-3 text-indigo-600 dark:text-indigo-400",children:w.jsx("span",{className:Er?"":"blur-sm select-none text-gray-300 dark:text-gray-700",children:Wt(((E.price??0)-(E.wholesalePrice??0))*(E.quantity??0))})}),w.jsx(gr,{className:"text-gray-500 dark:text-gray-400 py-3 text-xs",children:jo(E.date)}),w.jsx(gr,{className:"text-gray-500 dark:text-gray-400 py-3 text-xs font-mono",children:E.time}),w.jsx(gr,{className:"text-gray-700 dark:text-gray-300 py-3 text-xs",children:E.executedBy||"-"})]},E.id))})]})}),w.jsx("div",{className:"md:hidden space-y-3",children:j.filter(E=>!E.isDeferred).map(E=>w.jsx(kn,{className:"overflow-hidden border-gray-100 dark:border-gray-800 shadow-sm bg-white dark:bg-card",children:w.jsxs(so,{className:"p-4 space-y-3",children:[w.jsxs("div",{className:"flex justify-between items-start",children:[w.jsxs("div",{children:[w.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:E.productName}),w.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 flex items-center gap-2",children:[w.jsx("span",{className:"bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded text-gray-600 dark:text-gray-300 font-mono",children:E.time}),w.jsx("span",{className:"text-gray-400",children:"|"}),w.jsx("span",{children:jo(E.date)})]})]}),w.jsxs("div",{className:"text-left",children:[w.jsx("div",{className:"font-bold text-emerald-600 dark:text-emerald-400 text-sm",children:Wt((E.price??0)*(E.quantity??0))}),w.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:[E.quantity," × ",Wt(E.price)]}),w.jsx("div",{className:"mt-1",children:w.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-medium ${(E.paymentMethod||"cash")==="cash"?"bg-green-50 text-green-700":"bg-purple-50 text-purple-700"}`,children:(E.paymentMethod||"cash")==="cash"?"كاش":"فيزا"})})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-3 border-t border-dashed border-gray-100 dark:border-gray-800 text-xs",children:[w.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-2 rounded flex flex-col items-center justify-center",children:[w.jsx("span",{className:"text-gray-400 mb-1",children:"الربح"}),w.jsx("span",{className:`font-bold text-indigo-600 dark:text-indigo-400 ${!Er&&"blur-sm select-none text-gray-300 dark:text-gray-700"}`,children:Wt(((E.price??0)-(E.wholesalePrice??0))*(E.quantity??0))})]}),w.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-2 rounded flex flex-col items-center justify-center",children:[w.jsx("span",{className:"text-gray-400 mb-1",children:"المنفذ"}),w.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300 truncate max-w-full px-1",children:E.executedBy||"-"})]})]})]})},E.id))})]})}),w.jsx("div",{className:"p-4 border-t dark:border-border bg-gray-50/30 dark:bg-gray-900/30 flex justify-end",children:w.jsx(it,{variant:"outline",onClick:()=>ge(!1),className:"px-6 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",children:"إغلاق"})})]})}),w.jsx(Cn,{open:_e,onOpenChange:Rt,children:w.jsxs(Tn,{className:"max-w-sm mx-auto bg-white border border-gray-100 shadow-xl rounded-2xl sm:max-w-md p-6 gap-6",children:[w.jsxs("div",{className:"flex flex-col items-center text-center gap-2",children:[w.jsx("div",{className:`p-3 rounded-full ${ai==="return"?"bg-amber-100 text-amber-600":"bg-red-100 text-red-600"}`,children:ai==="return"?w.jsx(bo,{className:"h-6 w-6"}):w.jsx(ts,{className:"h-6 w-6"})}),w.jsx(Nn,{className:"text-xl font-bold text-gray-900 mt-2",children:ai==="return"?"تأكيد المرتجع":"تأكيد الحذف"}),w.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[w.jsxs("p",{children:["هل أنت متأكد من ",ai==="return"?"إرجاع":"حذف"," المنتج",w.jsx("span",{className:"font-bold text-gray-900 mx-1",children:Cr==null?void 0:Cr.productName}),"بكمية",w.jsx("span",{className:"font-bold text-gray-900 mx-1 font-mono",children:R1((Cr==null?void 0:Cr.quantity)||0)}),"؟"]}),w.jsx("p",{className:"text-xs text-gray-400",children:"سيتم تحديث المخزون والرصيد تلقائياً."})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsx(it,{variant:"outline",className:"h-10 border-gray-200",onClick:()=>Rt(!1),children:"إلغاء"}),w.jsx(it,{className:`h-10 ${ai==="return"?"bg-amber-600 hover:bg-amber-700":"bg-red-600 hover:bg-red-700"} text-white shadow-sm`,onClick:()=>{const E=Cr;Rt(!1),E&&vc(E)},children:ai==="return"?"تأكيد المرتجع":"تأكيد الحذف"})]})]})}),w.jsx(Cn,{open:d,onOpenChange:m,children:w.jsxs(Tn,{className:"sm:max-w-md bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",dir:"rtl",children:[w.jsxs(ki,{children:[w.jsxs(Nn,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[w.jsx(_c,{className:"h-5 w-5 text-primary"}),"تقارير يومية"]}),w.jsx(Ii,{className:"text-gray-500 dark:text-gray-400",children:"اختر تاريخاً لعرض تفاصيل العمليات لذلك اليوم"})]}),w.jsxs("div",{className:"space-y-4 py-4",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx(or,{className:"text-gray-700 dark:text-gray-300",children:"اختر التاريخ"}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx(Jt,{type:"date",value:X,onChange:E=>O(E.target.value),className:"flex-1 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100"}),w.jsx(it,{onClick:()=>ie(X),disabled:!X||J,className:"bg-indigo-600 hover:bg-indigo-700 text-white",children:J?w.jsx(Ql,{className:"h-4 w-4 animate-spin"}):"عرض التقرير"})]})]}),q&&w.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-4 border-t border-gray-100 dark:border-gray-800",children:[w.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg text-center border border-blue-100 dark:border-blue-800/50",children:[w.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 block mb-1",children:"المعاملات"}),w.jsx("span",{className:"font-bold text-blue-700 dark:text-blue-300 text-lg",children:q.count})]}),w.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 p-3 rounded-lg text-center border border-emerald-100 dark:border-emerald-800/50",children:[w.jsx("span",{className:"text-xs text-emerald-600 dark:text-emerald-400 block mb-1",children:"إجمالي المسحوب"}),w.jsx("span",{className:"font-bold text-emerald-700 dark:text-emerald-300 text-lg",children:Wt(q.sales)})]}),w.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-3 rounded-lg text-center border border-amber-100 dark:border-amber-800/50",children:[w.jsx("span",{className:"text-xs text-amber-600 dark:text-amber-400 block mb-1",children:"إجمالي المرسل"}),w.jsx("span",{className:"font-bold text-amber-700 dark:text-amber-300 text-lg",children:Wt(q.cost)})]}),w.jsxs("div",{className:"bg-pink-50 dark:bg-pink-900/20 p-3 rounded-lg text-center border border-pink-100 dark:border-pink-800/50",children:[w.jsx("span",{className:"text-xs text-pink-600 dark:text-pink-400 block mb-1",children:"الأرباح"}),w.jsx("span",{className:"font-bold text-pink-700 dark:text-pink-300 text-lg",children:Wt(q.profit)})]})]})]})]})}),w.jsx(Sc,{open:lr,onOpenChange:Ft,mode:"verify",title:"قفل إجمالي الأرباح",description:"أدخل الرقم السري الرئيسي لعرض إجمالي الأرباح",userId:A==null?void 0:A.uid,userRole:Y==null?void 0:Y.role,onSuccess:()=>{Ce(!1),Ft(!1)}}),w.jsx(Sc,{open:Rr,onOpenChange:Va,mode:"verify",title:"قفل إحصائيات الشهر",description:"لا يمكن الاطلاع على تقارير الشهر إلا بإدخال الرقم السري الرئيسي",onSuccess:async()=>{try{const E=A==null?void 0:A.uid;if(E){const B=await rd(E),Z=(B==null?void 0:B.planType)??(B==null?void 0:B.plan)??null,de=typeof Z=="string"?Z.toLowerCase():null;if(Z===ad.ZERO||de==="zero"){Te({title:"الخطة زيرو",description:"التقارير الشهرية غير متاحة في خطة زيرو. قم بالترقية للوصول إلى التقارير.",variant:"destructive"});return}}}catch{}Sr(!1),Va(!1),si()}}),w.jsx(Sc,{open:$s,onOpenChange:Xi,mode:"verify",title:_s,description:uc,userId:A==null?void 0:A.uid,userRole:Y==null?void 0:Y.role,onSuccess:()=>{const E=ei.current;ei.current=null,Xi(!1),E&&setTimeout(()=>{E()},100)}}),w.jsx(Cn,{open:yr,onOpenChange:un,children:w.jsxs(Tn,{className:"sm:max-w-[400px]",children:[w.jsxs(ki,{children:[w.jsx(Nn,{className:"text-center",children:"إضافة مخزون"}),w.jsxs(Ii,{className:"text-center",children:["إضافة كمية للمنتج: ",w.jsx("span",{className:"font-bold text-black",children:Ma==null?void 0:Ma.name})]})]}),w.jsx("div",{className:"py-6 flex flex-col items-center gap-4",children:w.jsxs("div",{className:"flex items-center gap-4 w-full justify-center",children:[w.jsx(it,{variant:"outline",size:"icon",onClick:()=>bi(E=>String(Math.max(1,parseInt(E||"0")-1))),children:w.jsx(bo,{className:"h-4 w-4"})}),w.jsx(Jt,{id:"qty",type:"number",value:Za,onChange:E=>bi(E.target.value),className:"w-32 text-center text-2xl font-bold h-12",autoFocus:!0,onKeyDown:E=>{E.key==="Enter"&&ks()}}),w.jsx(it,{variant:"outline",size:"icon",onClick:()=>bi(E=>String(parseInt(E||"0")+1)),children:w.jsx(nd,{className:"h-4 w-4"})})]})}),w.jsxs(l0,{className:"flex gap-2 sm:justify-center",children:[w.jsx(it,{variant:"outline",onClick:()=>un(!1),className:"flex-1",children:"إلغاء"}),w.jsx(it,{onClick:ks,className:"flex-1 bg-emerald-600 hover:bg-emerald-700",children:"تأكيد الإضافة"})]})]})}),w.jsx(Cn,{open:ne,onOpenChange:le,children:w.jsxs(Tn,{className:"sm:max-w-[500px] bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",dir:"rtl",children:[w.jsxs(ki,{children:[w.jsx(Nn,{className:"text-center text-gray-900 dark:text-gray-100",children:"تعديل المنتج"}),w.jsx(Ii,{className:"text-center text-gray-500 dark:text-gray-400",children:"عدّل بيانات المنتج ثم اضغط حفظ"})]}),w.jsxs("div",{className:"grid gap-4 py-4",children:[w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(or,{htmlFor:"ep_name",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"المنتج"}),w.jsx(Jt,{id:"ep_name",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.productName,onChange:E=>Be(B=>({...B,productName:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(or,{htmlFor:"ep_price",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"سعر البيع"}),w.jsx(Jt,{id:"ep_price",type:"number",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.price,onChange:E=>Be(B=>({...B,price:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(or,{htmlFor:"ep_wholesale",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"سعر الجملة"}),w.jsx(Jt,{id:"ep_wholesale",type:"number",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.wholesalePrice??"",onChange:E=>Be(B=>({...B,wholesalePrice:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(or,{htmlFor:"ep_qty",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"الكمية"}),w.jsx(Jt,{id:"ep_qty",type:"number",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.quantity,onChange:E=>Be(B=>({...B,quantity:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(or,{htmlFor:"ep_barcode",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"باركود"}),w.jsx(Jt,{id:"ep_barcode",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.barcode??"",onChange:E=>Be(B=>({...B,barcode:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(or,{htmlFor:"ep_serial",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"سيريال"}),w.jsx(Jt,{id:"ep_serial",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.serialNumber??"",onChange:E=>Be(B=>({...B,serialNumber:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(or,{htmlFor:"ep_category",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"القسم"}),w.jsx("div",{className:"col-span-3",children:w.jsxs(Ic,{value:Pe.categoryId||"none",onValueChange:E=>Be(B=>({...B,categoryId:E==="none"?void 0:E})),children:[w.jsx(Dc,{id:"ep_category",className:"bg-white dark:bg-gray-800 text-right dark:text-gray-100 border-gray-200 dark:border-gray-700",dir:"rtl",children:w.jsx(Fc,{placeholder:"اختر القسم"})}),w.jsxs(Oc,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[w.jsx(Os,{value:"none",className:"dark:text-gray-100 dark:focus:bg-gray-700",children:"بدون قسم"}),As.map(E=>w.jsx(Os,{value:E.id,className:"dark:text-gray-100 dark:focus:bg-gray-700",children:E.name},E.id))]})]})})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(or,{htmlFor:"ep_supplier",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"المورد"}),w.jsx(Jt,{id:"ep_supplier",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.supplierName??"",onChange:E=>Be(B=>({...B,supplierName:E.target.value})),placeholder:"اسم المورد (اختياري)"})]})]}),w.jsxs(l0,{className:"flex gap-2 sm:justify-center",children:[w.jsx(it,{variant:"outline",onClick:()=>{le(!1),Le(null)},className:"flex-1 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",children:"إلغاء"}),w.jsx(it,{onClick:o,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white shadow-sm dark:shadow-none",disabled:ht,children:"حفظ"})]})]})}),w.jsx(Cn,{open:Qs,onOpenChange:Ln,children:w.jsxs(Tn,{className:"sm:max-w-md",dir:"rtl",children:[w.jsx(ki,{children:w.jsx(Nn,{children:"تقرير اليوم والشهر"})}),w.jsxs("div",{className:"space-y-4 py-4",children:[w.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[w.jsxs("div",{className:"flex items-center justify-between mb-3",children:[w.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[w.jsx(Rs,{className:"h-4 w-4 text-primary"}),"ملخص اليوم"]}),w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-red-600",onClick:Aa,title:"تصفير اليوم",children:w.jsx(zn,{className:"h-3.5 w-3.5"})})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"text-center p-2 bg-white rounded border",children:[w.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"المبيعات"}),w.jsx("div",{className:"font-bold text-primary",children:Wt(Math.max(0,j.filter(E=>!E.isDeferred).reduce((E,B)=>E+B.price*B.quantity,0)-y))})]}),w.jsxs("div",{className:"text-center p-2 bg-white rounded border relative overflow-hidden",children:[w.jsx("div",{className:"text-xs text-emerald-700 mb-1",children:"الأرباح"}),w.jsx("div",{className:`font-bold text-emerald-700 ${vt?"blur-sm":""}`,children:Wt(Ht)}),vt&&w.jsxs("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50",children:[w.jsx(it,{size:"sm",variant:"ghost",onClick:()=>{Ln(!1),Ft(!0)},className:"h-full w-full opacity-0 absolute inset-0"}),w.jsx($l,{className:"h-3 w-3 text-muted-foreground"})]})]})]})]}),w.jsxs("div",{className:"bg-indigo-50/50 p-4 rounded-lg border border-indigo-100",children:[w.jsxs("div",{className:"flex items-center justify-between mb-3",children:[w.jsxs("h3",{className:"font-semibold flex items-center gap-2 text-indigo-900",children:[w.jsx(Ao,{className:"h-4 w-4 text-indigo-600"}),"تقارير الشهر"]}),w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-red-600",onClick:en,title:"تصفير الشهر",children:w.jsx(zn,{className:"h-3 w-3"})})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4 relative",children:[w.jsxs("div",{className:`text-center p-2 bg-white rounded border border-indigo-100 relative overflow-hidden group ${ma?"blur-md select-none":""}`,children:[w.jsxs("div",{className:"flex justify-center items-center relative",children:[w.jsx("div",{className:"text-xs text-indigo-600 mb-1",children:"المبيعات"}),!ma&&w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 absolute -left-2 top-0 text-indigo-400 hover:text-red-600 hover:bg-white/50 rounded-full z-20",onClick:en,title:"تصفير الشهر",children:w.jsx(zn,{className:"h-3.5 w-3.5"})})]}),w.jsx("div",{className:"font-bold text-indigo-700",children:Wt(Math.max(0,Ot-G))})]}),w.jsxs("div",{className:`text-center p-2 bg-white rounded border border-indigo-100 relative overflow-hidden group ${ma?"blur-md select-none":""}`,children:[w.jsxs("div",{className:"flex justify-center items-center relative",children:[w.jsx("div",{className:"text-xs text-pink-600 mb-1",children:"الأرباح"}),!ma&&w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 absolute -left-2 top-0 text-pink-400 hover:text-red-600 hover:bg-white/50 rounded-full z-20",onClick:en,title:"تصفير الشهر",children:w.jsx(zn,{className:"h-3.5 w-3.5"})})]}),w.jsx("div",{className:"font-bold text-pink-700",children:Wt(Math.max(0,Nt-re))})]}),ma&&w.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/20 dark:bg-black/20 backdrop-blur-[2px]",children:w.jsx(it,{"aria-label":"عرض",variant:"ghost",size:"icon",onClick:()=>{Ln(!1),Va(!0)},className:"rounded-full h-8 w-8 bg-white/80 backdrop-blur-sm shadow hover:bg-white dark:hover:bg-black/70",children:w.jsx(Ni,{className:"h-4 w-4 text-indigo-700"})})})]})]})]}),w.jsx(l0,{children:w.jsx(it,{onClick:()=>Ln(!1),children:"إغلاق"})})]})}),w.jsx(Cn,{open:zi,onOpenChange:ti,children:w.jsxs(Tn,{className:"sm:max-w-[425px]",children:[w.jsxs(ki,{children:[w.jsx(Nn,{children:"إضافة قسم جديد"}),w.jsx(Ii,{children:"أدخل اسم القسم الجديد لإضافته إلى قائمة الأقسام."})]}),w.jsx("div",{className:"grid gap-4 py-4",children:w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(or,{htmlFor:"categoryName",className:"text-right",children:"اسم القسم"}),w.jsx(Jt,{id:"categoryName",value:bs,onChange:E=>Ai(E.target.value),className:"col-span-3",placeholder:"مثال: إلكترونيات"})]})}),w.jsx(l0,{children:w.jsx(it,{onClick:Yi,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:"إضافة"})})]})}),w.jsx(xo,{open:!!ni,onOpenChange:E=>!E&&qi(null),children:w.jsxs(go,{children:[w.jsxs(mo,{children:[w.jsx(po,{className:"text-right",children:"حذف المنتج"}),w.jsxs(wo,{className:"text-right",children:[ni?`هل أنت متأكد من حذف المنتج "${ni.name}" من قائمة المنتجات؟`:"هل أنت متأكد من حذف هذا المنتج من قائمة المنتجات؟",w.jsx("br",{}),"سيتم حذفه من المخزون ولن يظهر في شاشة البيع."]})]}),w.jsxs(vo,{className:"flex-row-reverse sm:justify-start",children:[w.jsx(yo,{children:"إلغاء"}),w.jsx(Eo,{onClick:qt,className:"bg-red-600 hover:bg-red-700",children:"حذف"})]})]})}),w.jsx(xo,{open:!!D,onOpenChange:E=>!E&&U(null),children:w.jsxs(go,{children:[w.jsxs(mo,{children:[w.jsx(po,{className:"text-right",children:"حذف القسم"}),w.jsxs(wo,{className:"text-right",children:["هل أنت متأكد من حذف هذا القسم؟",w.jsx("br",{}),"سيتم حذف القسم ولكن ستبقى المنتجات المرتبطة به بدون قسم."]})]}),w.jsxs(vo,{className:"flex-row-reverse sm:justify-start",children:[w.jsx(yo,{children:"إلغاء"}),w.jsx(Eo,{onClick:q0,className:"bg-red-600 hover:bg-red-700",children:"حذف"})]})]})}),w.jsx(xo,{open:Vr,onOpenChange:Zi,children:w.jsxs(go,{children:[w.jsxs(mo,{children:[w.jsxs(po,{className:"text-right text-red-600 flex items-center gap-2",children:[w.jsx(id,{className:"h-5 w-5"}),"حذف جميع المنتجات"]}),w.jsxs(wo,{className:"text-right pt-2",children:["هل أنت متأكد تماماً من رغبتك في ",w.jsxs("strong",{children:["حذف جميع المنتجات (",Me.length," منتج)"]}),"؟",w.jsx("br",{}),w.jsx("br",{}),w.jsx("span",{className:"text-red-500 font-bold",children:"هذا الإجراء نهائي ولا يمكن استرجاع البيانات المحذوفة."})]})]}),w.jsxs(vo,{className:"flex-row-reverse sm:justify-start",children:[w.jsx(yo,{children:"إلغاء"}),w.jsx(Eo,{onClick:k,className:"bg-red-600 hover:bg-red-700",children:"نعم، احذف الكل"})]})]})}),w.jsx(Cn,{open:!!Re,onOpenChange:E=>!E&&Ut(null),children:w.jsxs(Tn,{className:"sm:max-w-lg bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",dir:"rtl",children:[w.jsxs(ki,{children:[w.jsx(Nn,{className:"text-gray-900 dark:text-gray-100",children:"تفاصيل الفاتورة المجمعة"}),w.jsx(Ii,{className:"text-gray-500 dark:text-gray-400",children:"قائمة المنتجات المدرجة في هذه الفاتورة"})]}),w.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[w.jsxs(co,{children:[w.jsx(lo,{className:"bg-gray-50/80 dark:bg-gray-800",children:w.jsxs(Fi,{className:"hover:bg-transparent dark:border-gray-800",children:[w.jsx(xr,{className:"text-right text-gray-700 dark:text-gray-300",children:"المنتج"}),w.jsx(xr,{className:"text-center text-gray-700 dark:text-gray-300",children:"الكمية"}),w.jsx(xr,{className:"text-center text-gray-700 dark:text-gray-300",children:"السعر"}),w.jsx(xr,{className:"text-center text-gray-700 dark:text-gray-300",children:"الإجمالي"})]})}),w.jsx(fo,{children:(no=Re==null?void 0:Re.cartItems)==null?void 0:no.map((E,B)=>w.jsxs(Fi,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 dark:border-gray-800",children:[w.jsx(gr,{className:"font-medium text-gray-900 dark:text-gray-100",children:E.productName}),w.jsx(gr,{className:"text-center text-gray-700 dark:text-gray-300",children:E.quantity}),w.jsx(gr,{className:"text-center text-gray-700 dark:text-gray-300",children:Wt(E.price)}),w.jsx(gr,{className:"text-center font-bold text-emerald-600 dark:text-emerald-400",children:Wt(E.price*E.quantity)})]},B))})]}),w.jsxs("div",{className:"mt-4 flex justify-between items-center bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border border-gray-100 dark:border-gray-700",children:[w.jsx("span",{className:"font-bold text-gray-900 dark:text-gray-100",children:"الإجمالي الكلي:"}),w.jsx("span",{className:"font-bold text-lg text-emerald-700 dark:text-emerald-400",children:Wt((Re==null?void 0:Re.price)||0)})]})]}),w.jsx(l0,{children:w.jsx(it,{onClick:()=>Ut(null),className:"dark:bg-gray-800 dark:text-gray-100 dark:hover:bg-gray-700",children:"إغلاق"})})]})}),w.jsx(ud,{isOpen:g,onClose:()=>v(!1),videoUrl:_,title:T})]})}const R1=e=>new Intl.NumberFormat("ar-EG",{maximumFractionDigits:0}).format(Number(e||0)),Wt=e=>`${new Intl.NumberFormat("ar-EG",{maximumFractionDigits:0}).format(Number(e||0))} ج.م`,jo=e=>{try{const r=new Date(e);return isNaN(r.getTime())?new Date(`${e}T00:00:00`).toLocaleDateString("ar-EG"):r.toLocaleDateString("ar-EG")}catch{return e}};export{oA as SalesDataDialog};
//# sourceMappingURL=SalesDataDialog-DbxS8Orm.js.map
