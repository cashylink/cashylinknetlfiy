{"version":3,"file":"ProtectedDashboard-BXnXVsHp.js","sources":["../../src/pages/DashboardPage.tsx","../../src/components/ProtectedDashboard.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { ArrowUpDown, Plus, CheckCircle, Clock, XCircle, Phone, DollarSign, Wallet, ArrowDownLeft, Trash2, Edit, LogOut, Settings, Eye } from 'lucide-react';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\r\nimport WalletManagement from '@/components/WalletManagement';\r\nimport TransactionDetailsModal from '@/components/TransactionDetailsModal';\r\nimport { SecretPinDialog } from '@/components/SecretPinDialog';\r\nimport { EditBalanceDialog } from '@/components/EditBalanceDialog';\r\nimport { ChangePinDialog } from '@/components/ChangePinDialog';\r\nimport { AddToWalletDialog } from '@/components/AddToWalletDialog';\r\nimport { transactionService, profileService } from '@/integrations/firebase/services';\r\nimport { doc, updateDoc, getDoc, setDoc, onSnapshot, getDocFromCache } from 'firebase/firestore';\r\nimport { db } from '@/firebase';\r\nimport { useShift } from '@/contexts/ShiftContext';\r\nimport { MasterPinDialog } from '@/components/MasterPinDialog';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { Capacitor } from '@capacitor/core';\r\nimport { calculateCommission } from '@/utils/commissionCalculator';\r\nimport { ProfitService } from '@/utils/profitService';\r\n\r\ninterface Transaction {\r\n  id: string;\r\n  type: 'send' | 'receive' | 'withdraw';\r\n  senderPhone: string;\r\n  receiverPhone: string;\r\n  amount: number;\r\n  status: 'pending' | 'completed' | 'failed';\r\n  createdAt: Date;\r\n  withdrawnAmount?: number;\r\n  sentAmount?: number;\r\n  merchantShopName?: string;\r\n  shopName?: string;\r\n  commission?: number;\r\n  fee?: number;\r\n  fromWallet?: string;\r\n  senderName?: string;\r\n}\r\n\r\ninterface DailyStats {\r\n  date: string;\r\n  totalTransactions: number;\r\n  totalAmount: number;\r\n  totalWithdrawn: number;\r\n  totalSent: number;\r\n}\r\n\r\ninterface MonthlyStats {\r\n  month: string;\r\n  totalTransactions: number;\r\n  totalAmount: number;\r\n  totalWithdrawn: number;\r\n  totalSent: number;\r\n}\r\n\r\nconst DashboardPage = () => {\r\n  const location = useLocation();\r\n  const { toast } = useToast();\r\n  const { signOut, user, profile } = useFirebaseAuth();\r\n  const { isShiftActive, shiftUser } = useShift();\r\n  const isMobile = useIsMobile();\r\n  const platform = (typeof Capacitor !== 'undefined' && typeof Capacitor.getPlatform === 'function') ? Capacitor.getPlatform() : 'web';\r\n  const isAndroid = platform === 'android' || /Android/i.test(typeof navigator !== 'undefined' ? navigator.userAgent : '');\r\n  // تفعيل تخطيط الموبايل/الأندرويد: عرض آخر 3 فقط والباقي في قسم قابل للتمرير\r\n  const showAndroidMobileLayout = isAndroid || isMobile;\r\n  const [senderPhone, setSenderPhone] = useState('01030302038');\r\n  const [senderName, setSenderName] = useState('');\r\n  const [receiverPhone, setReceiverPhone] = useState('');\r\n  const [amount, setAmount] = useState('');\r\n  const [transactionType, setTransactionType] = useState<'transfer' | 'withdraw'>('transfer');\r\n  const [senderProvider, setSenderProvider] = useState<'vodafone_cash' | 'etisalat_cash' | 'orange_cash' | 'instapay'>('vodafone_cash');\r\n  const [receiverProvider, setReceiverProvider] = useState<'vodafone_cash' | 'etisalat_cash' | 'orange_cash' | 'instapay'>('vodafone_cash');\r\n  const [transferFee, setTransferFee] = useState('');\r\n  const [transactions, setTransactions] = useState<Transaction[]>([]);\r\n  const [activeTab, setActiveTab] = useState('all');\r\n  const [isWalletManagementOpen, setIsWalletManagementOpen] = useState(false);\r\n  const [selectedWallet, setSelectedWallet] = useState<string>('');\r\n  const [wallets, setWallets] = useState<Array<{id: string, name: string, phone: string, isDefault: boolean}>>([]);\r\n  const [selectedTransaction, setSelectedTransaction] = useState<Transaction | null>(null);\r\n  const [isTransactionDetailsOpen, setIsTransactionDetailsOpen] = useState(false);\r\n  const [dailyStats, setDailyStats] = useState<DailyStats[]>([]);\r\n  const [monthlyStats, setMonthlyStats] = useState<MonthlyStats[]>([]);\r\n  const [isResetDialogOpen, setIsResetDialogOpen] = useState(false);\r\n  const [resetType, setResetType] = useState<'daily' | 'monthly'>('daily');\r\n  const [deletedTransactions, setDeletedTransactions] = useState<Transaction[]>([]);\r\n  const MONTHLY_WITHDRAWAL_LIMIT = 200000;\r\n  const MONTHLY_TRANSFER_LIMIT = 200000;\r\n  const [cashBalance, setCashBalance] = useState(0);\r\n  const [walletBalances, setWalletBalances] = useState<{[key: string]: number}>({});\r\n  const [isEditCashDialogOpen, setIsEditCashDialogOpen] = useState(false);\r\n  const [isEditWalletDialogOpen, setIsEditWalletDialogOpen] = useState(false);\r\n  const [isAddToWalletDialogOpen, setIsAddToWalletDialogOpen] = useState(false);\r\n  const [isAddToWalletTotalDialogOpen, setIsAddToWalletTotalDialogOpen] = useState(false);\r\n  const [isEditWalletTotalDialogOpen, setIsEditWalletTotalDialogOpen] = useState(false);\r\n  const [editingWalletId, setEditingWalletId] = useState<string>('');\r\n  const [isChangePinDialogOpen, setIsChangePinDialogOpen] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isDailyLocked, setIsDailyLocked] = useState<boolean>(() => {\r\n    try {\r\n      const key = user?.uid ? `dailyReportsLockEnabled_${user?.uid}` : 'dailyReportsLockEnabled';\r\n      const v = localStorage.getItem(key) ?? localStorage.getItem('dailyReportsLockEnabled');\r\n      return v === 'true';\r\n    } catch {\r\n      return false;\r\n    }\r\n  });\r\n  const [isDailyPinDialogOpen, setIsDailyPinDialogOpen] = useState<boolean>(false);\r\n  const [isTransactionPinned, setIsTransactionPinned] = useState(false);\r\n\r\n  // كشف الشركة تلقائيًا من مقدمة الرقم\r\n  // Helper: normalize Arabic/Persian digits to ASCII\r\n  const normalizeDigits = (s: string) => {\r\n    const arabicIndic = '٠١٢٣٤٥٦٧٨٩';\r\n    const easternIndic = '۰۱۲۳۴۵۶۷۸۹';\r\n    return (s || '').split('').map(ch => {\r\n      const ai = arabicIndic.indexOf(ch);\r\n      if (ai > -1) return String(ai);\r\n      const ei = easternIndic.indexOf(ch);\r\n      if (ei > -1) return String(ei);\r\n      return ch;\r\n    }).join('');\r\n  };\r\n\r\n  const detectProvider = (phone: string): 'vodafone_cash' | 'etisalat_cash' | 'orange_cash' | 'instapay' | null => {\r\n    const digits = normalizeDigits(phone).replace(/\\D/g, '');\r\n    if (digits.startsWith('010')) return 'vodafone_cash';\r\n    if (digits.startsWith('011')) return 'etisalat_cash';\r\n    if (digits.startsWith('012')) return 'orange_cash';\r\n    // مبدئيًا لا ندعم 015 (WE) هنا؛ تظل القيمة كما هي أو يُستخدم الاختيار اليدوي\r\n    return null;\r\n  };\r\n\r\n  useEffect(() => {\r\n    const p = detectProvider(senderPhone);\r\n    if (p && p !== senderProvider) setSenderProvider(p);\r\n  }, [senderPhone]);\r\n\r\n  useEffect(() => {\r\n    const p = detectProvider(receiverPhone);\r\n    if (p && p !== receiverProvider) setReceiverProvider(p);\r\n  }, [receiverPhone]);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const key = user?.uid ? `dailyReportsLockEnabled_${user?.uid}` : 'dailyReportsLockEnabled';\r\n      const v = localStorage.getItem(key) ?? localStorage.getItem('dailyReportsLockEnabled');\r\n      setIsDailyLocked(v === 'true');\r\n    } catch {}\r\n  }, [user?.uid]);\r\n\r\n  // تفعيل نموذج المعاملة ووضع التثبيت عند القدوم من أزرار أسفل الموبايل\r\n  useEffect(() => {\r\n    const state: any = location.state || {};\r\n    if (state?.openTransactionSection) {\r\n      if (state?.transactionType === 'withdraw' || state?.transactionType === 'transfer') {\r\n        setTransactionType(state.transactionType);\r\n      }\r\n      setIsTransactionPinned(true);\r\n      if (state?.startNewTransaction) {\r\n        setSenderPhone('01030302038');\r\n        setReceiverPhone('');\r\n        setAmount('');\r\n        setTransferFee('');\r\n      }\r\n      // تأكد من ظهور النموذج أعلى الصفحة في الموبايل\r\n      setTimeout(() => {\r\n        window.scrollTo({ top: 0, behavior: 'smooth' });\r\n      }, 50);\r\n    }\r\n  }, [location.state]);\r\n\r\n  // دالة لحفظ البيانات في Firebase\r\n  const saveDataToFirebase = async (data: any) => {\r\n    if (!user) return;\r\n    \r\n    try {\r\n      const userProfile = await profileService.getById(user.uid);\r\n      if (userProfile?.shopId) {\r\n        const dataRef = doc(db, 'dashboardData', userProfile.shopId);\r\n        await updateDoc(dataRef, data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error saving to Firebase:', error);\r\n      toast({\r\n        title: \"خطأ في الحفظ\",\r\n        description: \"حدث خطأ أثناء حفظ البيانات في Firebase\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!user) return;\r\n    \r\n    const loadDataFromFirebase = async () => {\r\n      setIsLoading(true);\r\n      try {\r\n        const userProfile = await profileService.getById(user.uid);\r\n        if (userProfile?.shopId) {\r\n          // تحميل الأرصدة من Firebase\r\n          const dataRef = doc(db, 'dashboardData', userProfile.shopId);\r\n          // أولاً: محاولة قراءة سريعة من الكاش لعرض البيانات فورًا\r\n          try {\r\n            const cachedSnap = await getDocFromCache(dataRef);\r\n            if (cachedSnap.exists()) {\r\n              const cached = cachedSnap.data() as any;\r\n              setCashBalance(cached.cashBalance || 0);\r\n              setWalletBalances(cached.walletBalances || {});\r\n              setDeletedTransactions(cached.deletedTransactions || []);\r\n              // بما أن لدينا بيانات معروضة من الكاش، ننهي حالة التحميل مبكرًا\r\n              setIsLoading(false);\r\n            }\r\n          } catch {\r\n            // الكاش غير متوفر أو غير مفعّل، نتابع لجلب الشبكة\r\n          }\r\n          const dataSnap = await getDoc(dataRef);\r\n          \r\n          if (dataSnap.exists()) {\r\n            const data = dataSnap.data();\r\n            setCashBalance(data.cashBalance || 0);\r\n            setWalletBalances(data.walletBalances || {});\r\n            setDeletedTransactions(data.deletedTransactions || []);\r\n          } else {\r\n            const defaultData = {\r\n              walletBalances: {},\r\n              deletedTransactions: []\r\n            };\r\n            await setDoc(dataRef, defaultData);\r\n            setCashBalance(0);\r\n            setWalletBalances(defaultData.walletBalances);\r\n            setDeletedTransactions(defaultData.deletedTransactions);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading data from Firebase:', error);\r\n        // لا يتم استخدام أي استرجاع من التخزين المحلي؛ اعرض قيمًا افتراضية وآمن اتصالك\r\n        setCashBalance(0);\r\n        setWalletBalances({});\r\n        setDeletedTransactions([]);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    loadDataFromFirebase();\r\n  }, [user]);\r\n\r\n  // اشتراك لحظي لبيانات لوحة المتجر لضمان التزامن عبر الويب/الكمبيوتر/الموبايل\r\n  useEffect(() => {\r\n    if (!user) return;\r\n    let unsubscribe: (() => void) | null = null;\r\n    const subscribeRealtime = async () => {\r\n      try {\r\n        const userProfile = await profileService.getById(user.uid);\r\n        if (userProfile?.shopId) {\r\n          const dataRef = doc(db, 'dashboardData', userProfile.shopId);\r\n          unsubscribe = onSnapshot(dataRef, { includeMetadataChanges: true }, (dataSnap) => {\r\n            if (dataSnap.exists()) {\r\n              const data: any = dataSnap.data();\r\n              setCashBalance(data.cashBalance || 0);\r\n              setWalletBalances(data.walletBalances || {});\r\n              setDeletedTransactions(data.deletedTransactions || []);\r\n            }\r\n          }, (err) => {\r\n            console.error('Error subscribing to dashboardData:', err);\r\n          });\r\n        }\r\n      } catch (e) {\r\n        console.error('Error initializing realtime dashboard subscription:', e);\r\n      }\r\n    };\r\n    subscribeRealtime();\r\n    return () => { if (unsubscribe) unsubscribe(); };\r\n  }, [user?.uid]);\r\n\r\n  // تمت إزالة مزامنة التخزين المحلي: العرض والعمليات تعتمد على Firestore فقط\r\n\r\n  // باقي الكود يبقى كما هو...\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (transactionType === 'transfer') {\r\n      // Transfer logic\r\n      if (!senderPhone || !receiverPhone || !amount) {\r\n        toast({\r\n          title: \"خطأ\",\r\n          description: \"يرجى ملء جميع الحقول المطلوبة\",\r\n          variant: \"destructive\",\r\n        });\r\n        return;\r\n      }\r\n\r\n      // تحديد اسم المحل من بروفايل المستخدم، مع بدائل آمنة\r\n      const merchantShopName = profile?.shopName || user?.displayName || 'محل كاشي لينك';\r\n\r\n      // محاولة تحديد اسم المحفظة المختارة أو الافتراضية\r\n      const selectedWalletObj = wallets.find(w => w.id === selectedWallet) || wallets.find(w => w.isDefault);\r\n\r\n      // تحقق من الرسوم بناءً على بادئات الأرقام (شرط 010 → 011)\r\n      const sDigits = normalizeDigits(senderPhone || '').replace(/\\D/g, '');\r\n      const rDigits = normalizeDigits(receiverPhone || '').replace(/\\D/g, '');\r\n      const isSameProvider = senderProvider === receiverProvider;\r\n      const needsCustomFee = (sDigits.startsWith('010') && (rDigits.startsWith('011') || rDigits.startsWith('012') || rDigits.startsWith('015'))) || (sDigits.startsWith('012') && rDigits.startsWith('010')) || (sDigits.startsWith('011') && rDigits.startsWith('010')) || (sDigits.startsWith('015') && rDigits.startsWith('010'));\r\n      const fee = isSameProvider\r\n  ? ((transferFee && transferFee.trim() !== '') ? parseFloat(transferFee) : 1)\r\n  : (needsCustomFee ? parseFloat(transferFee || '0') : 0);\r\n      if (needsCustomFee && (Number.isNaN(fee) || fee <= 0)) {\r\n        toast({\r\n          title: \"خطأ\",\r\n          description: \"أدخل رسوم التحويل لعمليات 010 → 011/012/015 أو 012 → 010 أو 011 → 010 أو 015 → 010\",\r\n          variant: \"destructive\",\r\n        });\r\n        return;\r\n      }\r\n\r\n      // تحقق من توفر المحفظة والرصيد الكافي\r\n      if (!selectedWalletObj) {\r\n        toast({ title: \"لا توجد محفظة\", description: \"يرجى اختيار محفظة لإتمام التحويل\", variant: \"destructive\" });\r\n        return;\r\n      }\r\n      const parsedAmount = parseFloat(amount);\r\n      const totalDebit = parsedAmount + fee;\r\n      const currentWalletBalance = walletBalances[selectedWalletObj.id] || 0;\r\n      if (currentWalletBalance < totalDebit) {\r\n        toast({ title: \"رصيد المحفظة غير كافٍ\", description: `الرصيد الحالي ${currentWalletBalance} لا يكفي لخصم ${totalDebit}`, variant: \"destructive\" });\r\n        return;\r\n      }\r\n\r\n      const transferCommission = calculateCommission(parsedAmount, 'send');\r\n      const newTransaction: Transaction = {\r\n        id: Date.now().toString(),\r\n        type: 'send',\r\n        senderPhone,\r\n        receiverPhone,\r\n        amount: parsedAmount,\r\n        status: 'pending',\r\n        createdAt: new Date(),\r\n        withdrawnAmount: 0,\r\n        sentAmount: parsedAmount,\r\n        merchantShopName,\r\n        shopName: selectedWalletObj?.name || 'المحفظة الرئيسية',\r\n        commission: transferCommission,\r\n        fee: fee,\r\n        fromWallet: selectedWalletObj.id,\r\n      };\r\n\r\n      // لا نضيف اسم الكاشير في معاملات الحساب الرئيسي حتى لو كانت وردية نشطة\r\n\r\n      const updatedTransactions = [newTransaction, ...transactions];\r\n      setTransactions(updatedTransactions);\r\n\r\n      // تحديث رصيد المحفظة (خصم مبلغ التحويل + الرسوم)\r\n      const totalDebit2 = parsedAmount + fee;\r\n      const walletId = selectedWalletObj?.id;\r\n      const currentWalletBalance2 = walletId ? (walletBalances[walletId] || 0) : 0;\r\n      const newWalletBalances = walletId ? { ...walletBalances, [walletId]: currentWalletBalance2 - totalDebit2 } : walletBalances;\r\n      setWalletBalances(newWalletBalances);\r\n\r\n      // لا نضيف الرسوم إلى الدرج عند الإنشاء — الإضافة تتم عند الإكمال فقط\r\n\r\n      // حفظ في Firebase بدون تعديل الدرج الآن\r\n      await saveDataToFirebase({ transactions: updatedTransactions, walletBalances: newWalletBalances });\r\n\r\n      toast({\r\n        title: \"تم إرسال التحويل\",\r\n        description: \"جاري معالجة التحويل...\",\r\n      });\r\n\r\n      setTimeout(async () => {\r\n        const completedTransaction = { ...newTransaction, status: 'completed' as const };\r\n        const finalTransactions = [completedTransaction, ...transactions];\r\n        setTransactions(finalTransactions);\r\n        \r\n        // عند الإكمال: إضافة الرسوم إلى الدرج ثم حفظ\r\n        const completedFee = fee;\r\n        const toAdd = Math.max(0, transferCommission) + (Number.isFinite(completedFee) ? completedFee : 0);\r\n        const newCashBalanceOnComplete = cashBalance + toAdd;\r\n        setCashBalance(newCashBalanceOnComplete);\r\n        await saveDataToFirebase({ transactions: finalTransactions, cashBalance: newCashBalanceOnComplete });\r\n\r\n        ProfitService.addProfit(toAdd);\r\n\r\n        // toast({\r\n        //   title: \"تم التحويل بنجاح\",\r\n        //   description: `تم تحويل ${amount} جنيه إلى ${receiverPhone} وخصم عمولة ${commission} جنيه من الدرج`,\r\n        // });\r\n      }, 2000);\r\n\r\n      setSenderPhone('01030302038');\r\n      setReceiverPhone('');\r\n      setAmount('');\r\n      setTransferFee('');\r\n    } else if (transactionType === 'withdraw') {\r\n      if (!senderPhone || !amount) {\r\n        toast({\r\n          title: \"خطأ\",\r\n          description: \"يرجى ملء جميع الحقول المطلوبة\",\r\n          variant: \"destructive\",\r\n        });\r\n        return;\r\n      }\r\n\r\n      const merchantShopName = profile?.shopName || user?.displayName || 'محل كاشي لينك';\r\n      const selectedWalletObj = wallets.find(w => w.id === selectedWallet) || wallets.find(w => w.isDefault);\r\n      if (!selectedWalletObj) {\r\n        toast({ title: \"لا توجد محفظة\", description: \"يرجى اختيار محفظة لإتمام السحب\", variant: \"destructive\" });\r\n        return;\r\n      }\r\n\r\n      const parsedAmount = parseFloat(amount);\r\n      if (!Number.isFinite(parsedAmount) || parsedAmount <= 0) {\r\n        toast({ title: \"خطأ\", description: \"أدخل مبلغًا صحيحًا للسحب\", variant: \"destructive\" });\r\n        return;\r\n      }\r\n\r\n      const withdrawCommission = calculateCommission(parsedAmount, 'receive');\r\n      const newTransaction: Transaction = {\r\n        id: Date.now().toString(),\r\n        type: 'withdraw',\r\n        senderPhone,\r\n        receiverPhone: '',\r\n        amount: parsedAmount,\r\n        status: 'pending',\r\n        createdAt: new Date(),\r\n        withdrawnAmount: parsedAmount,\r\n        sentAmount: 0,\r\n        merchantShopName,\r\n        shopName: selectedWalletObj?.name || 'المحفظة الرئيسية',\r\n        commission: withdrawCommission,\r\n        fromWallet: selectedWalletObj.id,\r\n        senderName: senderName || undefined,\r\n      };\r\n\r\n      const updatedTransactions = [newTransaction, ...transactions];\r\n      setTransactions(updatedTransactions);\r\n\r\n      await saveDataToFirebase({ transactions: updatedTransactions });\r\n\r\n      toast({\r\n        title: \"تم إنشاء عملية السحب\",\r\n        description: \"جاري معالجة السحب...\",\r\n      });\r\n\r\n      setTimeout(async () => {\r\n        const completedTransaction = { ...newTransaction, status: 'completed' as const };\r\n        const finalTransactions = [completedTransaction, ...transactions];\r\n        setTransactions(finalTransactions);\r\n\r\n        const fromWalletId = selectedWalletObj.id;\r\n        const currentWalletBalance = walletBalances[fromWalletId] || 0;\r\n        const newWalletBalances = { ...walletBalances, [fromWalletId]: currentWalletBalance + parsedAmount };\r\n        setWalletBalances(newWalletBalances);\r\n\r\n        const newCashBalanceOnComplete = cashBalance - parsedAmount + Math.max(0, withdrawCommission);\r\n        setCashBalance(newCashBalanceOnComplete);\r\n\r\n        await saveDataToFirebase({ transactions: finalTransactions, walletBalances: newWalletBalances, cashBalance: newCashBalanceOnComplete });\r\n\r\n        ProfitService.addProfit(Math.max(0, withdrawCommission));\r\n      }, 2000);\r\n\r\n      setSenderPhone('01030302038');\r\n      setAmount('');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background p-4\">\r\n      {isLoading && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white p-6 rounded-lg\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"></div>\r\n            <p className=\"mt-2 text-center\">جاري تحميل البيانات...</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      <div className=\"max-w-7xl mx-auto space-y-6\">\r\n        {/* Header */}\r\n        <div className=\"flex justify-between items-center\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">لوحة تحكم الإدارة</h1>\r\n          <Button onClick={signOut} variant=\"outline\" className=\"flex items-center gap-2\">\r\n            <LogOut className=\"h-4 w-4\" />\r\n            تسجيل الخروج\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Stats Cards */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n              <CardTitle className=\"text-sm font-medium\">الرصيد النقدي</CardTitle>\r\n              <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold\">{cashBalance.toLocaleString()} جنيه</div>\r\n            </CardContent>\r\n          </Card>\r\n          \r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n              <CardTitle className=\"text-sm font-medium\">الأرصدة علي المحافظ</CardTitle>\r\n              <Wallet className=\"h-4 w-4 text-muted-foreground\" />\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold\">\r\n                {Object.values(walletBalances).reduce((sum, balance) => sum + balance, 0).toLocaleString()} جنيه\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n          \r\n          <Card className=\"relative\">\r\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n              <CardTitle className=\"text-sm font-medium\">المعاملات اليوم</CardTitle>\r\n              <ArrowUpDown className=\"h-4 w-4 text-muted-foreground\" />\r\n            </CardHeader>\r\n            <CardContent className={isDailyLocked ? \"filter blur-sm pointer-events-none\" : \"\"}>\r\n              <div className=\"text-2xl font-bold\">{transactions.length}</div>\r\n            </CardContent>\r\n            {isDailyLocked && (\r\n              <div className=\"absolute inset-0 flex items-center justify-center rounded-lg bg-yellow-100/60\">\r\n                <Button\r\n                  size=\"sm\"\r\n                  variant=\"ghost\"\r\n                  onClick={() => setIsDailyPinDialogOpen(true)}\r\n                  className=\"flex items-center gap-2 bg-yellow-200/70 hover:bg-yellow-300 text-yellow-900 px-3 py-2 rounded-xl shadow-md hover:shadow-lg transition-all\"\r\n                  title=\"عرض تقارير اليوم\"\r\n                >\r\n                  <Eye className=\"h-5 w-5\" />\r\n                  <span className=\"text-xs\">عرض تقارير اليوم</span>\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </Card>\r\n          \r\n          <Card className=\"relative\">\r\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n              <CardTitle className=\"text-sm font-medium\">إجمالي اليوم</CardTitle>\r\n              <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\r\n            </CardHeader>\r\n            <CardContent className={isDailyLocked ? \"filter blur-sm pointer-events-none\" : \"\"}>\r\n              <div className=\"text-2xl font-bold\">\r\n                {transactions.reduce((sum, t) => sum + t.amount, 0).toLocaleString()} جنيه\r\n              </div>\r\n            </CardContent>\r\n            {isDailyLocked && (\r\n              <div className=\"absolute inset-0 flex items-center justify-center rounded-lg bg-yellow-100/60\">\r\n                <Button\r\n                  size=\"sm\"\r\n                  variant=\"ghost\"\r\n                  onClick={() => setIsDailyPinDialogOpen(true)}\r\n                  className=\"flex items-center gap-2 bg-yellow-200/70 hover:bg-yellow-300 text-yellow-900 px-3 py-2 rounded-xl shadow-md hover:shadow-lg transition-all\"\r\n                  title=\"عرض تقارير اليوم\"\r\n                >\r\n                  <Eye className=\"h-5 w-5\" />\r\n                  <span className=\"text-xs\">عرض تقارير اليوم</span>\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </Card>\r\n\r\n          {/* Dialog to verify master PIN and unlock daily reports */}\r\n          <MasterPinDialog\r\n            open={isDailyPinDialogOpen}\r\n            onOpenChange={setIsDailyPinDialogOpen}\r\n            mode=\"verify\"\r\n            title=\"قفل تقارير اليوم\"\r\n            description=\"لا يمكن الاطلاع على تقارير اليوم إلا بإدخال الرقم السري الرئيسي\"\r\n            onSuccess={() => {\r\n              setIsDailyLocked(false);\r\n              setIsDailyPinDialogOpen(false);\r\n            }}\r\n          />\r\n        </div>\r\n\r\n        {/* Transaction Form */}\r\n        <Card className={isMobile && isTransactionPinned ? 'sticky top-0 z-40 shadow-lg bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/70' : ''}>\r\n          <CardHeader>\r\n            <CardTitle>إجراء معاملة جديدة</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-2\">نوع المعاملة</label>\r\n                  <Select value={transactionType} onValueChange={(value: 'transfer' | 'withdraw') => setTransactionType(value)}>\r\n                    <SelectTrigger>\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"transfer\">تحويل</SelectItem>\r\n                      <SelectItem value=\"withdraw\">سحب</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                \r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-2\">رقم المرسل</label>\r\n                  <Input\r\n                    type=\"tel\"\r\n                    value={senderPhone}\r\n                    onChange={(e) => setSenderPhone(e.target.value)}\r\n                    onKeyDown={(e) => {\r\n                      if (e.key === 'Enter') {\r\n                        const dest = document.getElementById('receiverPhoneInput') as HTMLInputElement | null;\r\n                        if (dest) {\r\n                          dest.focus();\r\n                        } else {\r\n                          const amountEl = document.getElementById('amountInput') as HTMLInputElement | null;\r\n                          amountEl?.focus();\r\n                        }\r\n                      }\r\n                    }}\r\n                    placeholder=\"01xxxxxxxxx\"\r\n                  />\r\n                </div>\r\n                \r\n                {transactionType === 'transfer' && (\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium mb-2\">رقم المستقبل</label>\r\n                    <Input\r\n                      id=\"receiverPhoneInput\"\r\n                      type=\"tel\"\r\n                      value={receiverPhone}\r\n                      onChange={(e) => setReceiverPhone(e.target.value)}\r\n                      onKeyDown={(e) => {\r\n                        if (e.key === 'Enter') {\r\n                          const next = document.getElementById('amountInput') as HTMLInputElement | null;\r\n                          next?.focus();\r\n                        }\r\n                      }}\r\n                      placeholder=\"01xxxxxxxxx\"\r\n                    />\r\n                  </div>\r\n                )}\r\n                {transactionType === 'withdraw' && (\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium mb-2\">اسم الراسل (اختياري)</label>\r\n                    <Input\r\n                      id=\"senderNameInput\"\r\n                      type=\"text\"\r\n                      value={senderName}\r\n                      onChange={(e) => setSenderName(e.target.value)}\r\n                      placeholder=\"مثال: أحمد عبد الرحمن\"\r\n                    />\r\n                  </div>\r\n                )}\r\n                \r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-2\">شركة المرسل</label>\r\n                  <Select value={senderProvider} onValueChange={(v) => setSenderProvider(v as any)}>\r\n                    <SelectTrigger>\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"vodafone_cash\">فودافون</SelectItem>\r\n                      <SelectItem value=\"etisalat_cash\">اتصالات</SelectItem>\r\n                      <SelectItem value=\"orange_cash\">أورانج</SelectItem>\r\n                      <SelectItem value=\"instapay\">إنستاباي</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                \r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-2\">شركة المستقبل</label>\r\n                  <Select value={receiverProvider} onValueChange={(v) => setReceiverProvider(v as any)}>\r\n                    <SelectTrigger>\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"vodafone_cash\">فودافون</SelectItem>\r\n                      <SelectItem value=\"etisalat_cash\">اتصالات</SelectItem>\r\n                      <SelectItem value=\"orange_cash\">أورانج</SelectItem>\r\n                      <SelectItem value=\"instapay\">إنستاباي</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                \r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-2\">المبلغ</label>\r\n                  <Input\r\n                    id=\"amountInput\"\r\n                    type=\"number\"\r\n                    value={amount}\r\n                    onChange={(e) => setAmount(e.target.value)}\r\n                    onKeyDown={(e) => {\r\n                      if (e.key === 'Enter') {\r\n                        const submitBtn = document.getElementById('txSubmitButton') as HTMLButtonElement | null;\r\n                        submitBtn?.focus();\r\n                      }\r\n                    }}\r\n                    placeholder=\"0.00\"\r\n                  />\r\n                </div>\r\n                {transactionType === 'withdraw' && (\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium mb-2\">اسم الراسل (اختياري)</label>\r\n                    <Input\r\n                      id=\"senderNameInput\"\r\n                      type=\"text\"\r\n                      value={senderName}\r\n                      onChange={(e) => setSenderName(e.target.value)}\r\n                      placeholder=\"مثال: أحمد عبد الرحمن\"\r\n                    />\r\n                  </div>\r\n                )}\r\n                {transactionType === 'transfer' && ((normalizeDigits(senderPhone || '').replace(/\\D/g, '').startsWith('010') && normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('010')) || (normalizeDigits(senderPhone || '').replace(/\\D/g, '').startsWith('010') && (normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('011') || normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('012') || normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('015'))) || (normalizeDigits(senderPhone || '').replace(/\\D/g, '').startsWith('012') && normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('010')) || (normalizeDigits(senderPhone || '').replace(/\\D/g, '').startsWith('011') && normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('010')) || (normalizeDigits(senderPhone || '').replace(/\\D/g, '').startsWith('015') && normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('010'))) && (\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium mb-2\">رسوم التحويل</label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      value={transferFee}\r\n                      onChange={(e) => setTransferFee(e.target.value)}\r\n                      placeholder=\"0.00\"\r\n                    />\r\n                    <p className=\"text-xs text-gray-500 mt-1\">تُخصم من المحفظة وتضاف للدرج</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              \r\n              <Button id=\"txSubmitButton\" type=\"submit\" className={`w-full ${transactionType === 'transfer' ? 'btn-transfer-confirm' : 'btn-withdraw-confirm'}`}>\r\n                {transactionType === 'transfer' ? 'إرسال التحويل' : 'تنفيذ السحب'}\r\n              </Button>\r\n            </form>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Transactions List */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>المعاملات الأخيرة</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {transactions.length === 0 ? (\r\n              <p className=\"text-sm text-gray-500\">لا توجد معاملات حديثة.</p>\r\n            ) : (\r\n              <div className={(isMobile || isAndroid) ? \"receipts-list space-y-4 max-h-[310px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400\" : \"receipts-list space-y-4\"}>\r\n                {transactions.map((transaction) => (\r\n                  <div key={transaction.id} className=\"receipts-row flex items-center justify-between p-4 border rounded-lg\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        {transaction.status === 'completed' && <CheckCircle className={`h-5 w-5 ${transaction.type === 'withdraw' ? 'text-red-500' : 'text-green-500'}`} />}\r\n                        {transaction.status === 'pending' && <Clock className=\"h-5 w-5 text-yellow-500\" />}\r\n                        {transaction.status === 'failed' && <XCircle className=\"h-5 w-5 text-red-500\" />}\r\n                      </div>\r\n                      \r\n                      <div>\r\n                        <p className={`font-medium ${transaction.type === 'send' ? 'text-green-700' : 'text-red-700'}`}>\r\n                          {transaction.type === 'send' ? 'تحويل' : 'سحب'} - {transaction.amount.toLocaleString()} جنيه\r\n                        </p>\r\n                        {transaction.type === 'send' ? (\r\n                          <p className=\"text-sm text-green-600\">\r\n                            من {transaction.senderPhone} إلى {transaction.receiverPhone}\r\n                          </p>\r\n                        ) : (\r\n                          <>\r\n                            <p className=\"text-sm text-red-500\">من {transaction.senderPhone}</p>\r\n                            {transaction.senderName && (\r\n                              <p className=\"text-xs text-red-400\">اسم الراسل: {transaction.senderName}</p>\r\n                            )}\r\n                          </>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    <Badge variant={\r\n                      transaction.status === 'completed' ? 'default' :\r\n                      transaction.status === 'pending' ? 'secondary' : 'destructive'\r\n                    }>\r\n                      {transaction.status === 'completed' ? 'مكتمل' :\r\n                       transaction.status === 'pending' ? 'قيد المعالجة' : 'فشل'}\r\n                    </Badge>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DashboardPage;\r\n\r\n// كشف الشركة تلقائيًا من مقدمة الرقم\r\nconst detectProvider = (phone: string): 'vodafone_cash' | 'etisalat_cash' | 'orange_cash' | 'instapay' | null => {\r\n  const digits = normalizeDigits(phone).replace(/\\D/g, '');\r\n  if (digits.startsWith('010')) return 'vodafone_cash';\r\n  if (digits.startsWith('011')) return 'etisalat_cash';\r\n  if (digits.startsWith('012')) return 'orange_cash';\r\n  // مبدئيًا لا ندعم 015 (WE) هنا؛ تظل القيمة كما هي أو يُستخدم الاختيار اليدوي\r\n  return null;\r\n};\r\n","import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport DashboardPage from '../pages/DashboardPage';\r\nimport LogoLoader from '@/components/LogoLoader';\r\n\r\nconst ProtectedDashboard = () => {\r\n  const navigate = useNavigate();\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // التحقق من حالة تسجيل الدخول\r\n    const checkAuth = () => {\r\n      const authStatus = localStorage.getItem('dashboardAuth');\r\n      const userData = localStorage.getItem('dashboardUser');\r\n      \r\n      if (authStatus === 'true' && userData) {\r\n        try {\r\n          const user = JSON.parse(userData);\r\n          const loginTime = new Date(user.loginTime);\r\n          const now = new Date();\r\n          const hoursDiff = (now.getTime() - loginTime.getTime()) / (1000 * 60 * 60);\r\n          \r\n          // انتهاء صلاحية الجلسة بعد 24 ساعة\r\n          if (hoursDiff < 24) {\r\n            setIsAuthenticated(true);\r\n          } else {\r\n            // انتهت صلاحية الجلسة\r\n            localStorage.removeItem('dashboardAuth');\r\n            localStorage.removeItem('dashboardUser');\r\n            navigate('/dashboard/login');\r\n          }\r\n        } catch (error) {\r\n          console.error('Error parsing user data:', error);\r\n          navigate('/dashboard/login');\r\n        }\r\n      } else {\r\n        navigate('/dashboard/login');\r\n      }\r\n      \r\n      setIsLoading(false);\r\n    };\r\n\r\n    checkAuth();\r\n  }, [navigate]);\r\n\r\n  if (isLoading) {\r\n    return <LogoLoader />;\r\n  }\r\n\r\n  if (!isAuthenticated) {\r\n    return <LogoLoader />;\r\n  }\r\n\r\n  return <DashboardPage />;\r\n};\r\n\r\nexport default ProtectedDashboard;"],"names":["DashboardPage","location","useLocation","toast","useToast","signOut","user","profile","useFirebaseAuth","isShiftActive","shiftUser","useShift","isMobile","useIsMobile","isAndroid","Capacitor","senderPhone","setSenderPhone","useState","senderName","setSenderName","receiverPhone","setReceiverPhone","amount","setAmount","transactionType","setTransactionType","senderProvider","setSenderProvider","receiverProvider","setReceiverProvider","transferFee","setTransferFee","transactions","setTransactions","activeTab","setActiveTab","isWalletManagementOpen","setIsWalletManagementOpen","selectedWallet","setSelectedWallet","wallets","setWallets","selectedTransaction","setSelectedTransaction","isTransactionDetailsOpen","setIsTransactionDetailsOpen","dailyStats","setDailyStats","monthlyStats","setMonthlyStats","isResetDialogOpen","setIsResetDialogOpen","resetType","setResetType","deletedTransactions","setDeletedTransactions","cashBalance","setCashBalance","walletBalances","setWalletBalances","isEditCashDialogOpen","setIsEditCashDialogOpen","isEditWalletDialogOpen","setIsEditWalletDialogOpen","isAddToWalletDialogOpen","setIsAddToWalletDialogOpen","isAddToWalletTotalDialogOpen","setIsAddToWalletTotalDialogOpen","isEditWalletTotalDialogOpen","setIsEditWalletTotalDialogOpen","editingWalletId","setEditingWalletId","isChangePinDialogOpen","setIsChangePinDialogOpen","isLoading","setIsLoading","isDailyLocked","setIsDailyLocked","key","isDailyPinDialogOpen","setIsDailyPinDialogOpen","isTransactionPinned","setIsTransactionPinned","normalizeDigits","s","arabicIndic","easternIndic","ch","ai","ei","detectProvider","phone","digits","useEffect","p","v","state","saveDataToFirebase","data","userProfile","profileService","dataRef","doc","db","updateDoc","error","cachedSnap","getDocFromCache","cached","dataSnap","getDoc","defaultData","setDoc","unsubscribe","onSnapshot","err","e","handleSubmit","merchantShopName","selectedWalletObj","w","sDigits","rDigits","isSameProvider","needsCustomFee","fee","parsedAmount","totalDebit","currentWalletBalance","transferCommission","calculateCommission","newTransaction","updatedTransactions","totalDebit2","walletId","currentWalletBalance2","newWalletBalances","finalTransactions","completedFee","toAdd","newCashBalanceOnComplete","ProfitService","withdrawCommission","fromWalletId","jsxs","jsx","Button","LogOut","Card","CardHeader","CardTitle","DollarSign","CardContent","Wallet","sum","balance","ArrowUpDown","Eye","t","MasterPinDialog","Select","value","SelectTrigger","SelectValue","SelectContent","SelectItem","Input","dest","amountEl","next","submitBtn","transaction","CheckCircle","Clock","XCircle","Fragment","Badge","ProtectedDashboard","navigate","useNavigate","isAuthenticated","setIsAuthenticated","authStatus","userData","loginTime","LogoLoader"],"mappings":"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"}