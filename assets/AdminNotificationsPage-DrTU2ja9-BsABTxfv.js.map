{"version":3,"file":"AdminNotificationsPage-DrTU2ja9-BsABTxfv.js","sources":["../../assets/AdminNotificationsPage-DrTU2ja9.js"],"sourcesContent":["import{c as I,r,j as e,I as x,B as N,m as k,n as C,p as w,h as F,i as L,s as U,f as B}from\"./index-tnWDkOuX.js\";import{C as D,a as A,b as E,d as H}from\"./card-SlwaggFS.js\";import{L as m}from\"./label-_mnIMROJ.js\";import{B as K,T as M}from\"./textarea-DK4Tmvmm.js\";import{L as P}from\"./link-BcnlpFfX.js\";const J=()=>{const{toast:a}=I(),[u,v]=r.useState(\"\"),[h,y]=r.useState(\"\"),[f,j]=r.useState(\"\"),[c,d]=r.useState(!1),[o,b]=r.useState(\"\"),S=async s=>{var n;if(s.preventDefault(),!u.trim()||!h.trim()){a({title:\"خطأ\",description:\"العنوان والنص مطلوبان\",variant:\"destructive\"});return}try{d(!0);const t={title:u.trim(),body:h.trim(),link:f.trim()||\"\"};if(o.trim()){const g=k(C,\"sendFcmToUser\"),l={};t.link&&(l.link=t.link);const i=await g({userId:o.trim(),title:t.title,body:t.body,data:l}),p=!!((n=i==null?void 0:i.data)!=null&&n.ok);a({title:p?\"تم الإرسال\":\"تحذير\",description:p?`أُرسل إلى المستخدم ${o}`:\"لا توجد أجهزة مسجلة لهذا المستخدم\",variant:p?void 0:\"destructive\"})}else await w(F(L,\"broadcasts\"),{title:t.title,message:t.body,linkUrl:t.link||void 0,audienceKey:\"global\",active:!0,createdAt:U()}),a({title:\"تم الإرسال\",description:\"تم إنشاء بث عام وسيتم إرسال الإشعار\"});v(\"\"),y(\"\"),j(\"\"),b(\"\")}catch(t){a({title:\"فشل الإرسال\",description:String((t==null?void 0:t.message)||t),variant:\"destructive\"})}finally{d(!1)}},T=async()=>{var s,n;try{const t=((s=B.currentUser)==null?void 0:s.uid)||\"\";if(!t){a({title:\"غير مسجل\",description:\"سجّل الدخول كأدمن لإرسال اختبار\",variant:\"destructive\"});return}d(!0);const l=await k(C,\"sendFcmToUser\")({userId:t,title:\"إشعار اختبار\",body:\"تم إرسال إشعار تجريبي بنجاح\",data:{type:\"test\"}}),i=!!((n=l==null?void 0:l.data)!=null&&n.ok);a({title:i?\"تم إرسال الاختبار\":\"فشل الاختبار\",description:i?\"تفقد هاتفك الآن\":\"تحقق من حفظ توكن الجهاز\",variant:i?void 0:\"destructive\"})}catch(t){a({title:\"فشل الاختبار\",description:String((t==null?void 0:t.message)||t),variant:\"destructive\"})}finally{d(!1)}};return e.jsx(\"div\",{className:\"min-h-screen p-4\",children:e.jsxs(D,{className:\"max-w-xl mx-auto\",children:[e.jsx(A,{children:e.jsxs(E,{className:\"flex items-center gap-2 text-base\",children:[e.jsx(K,{className:\"h-4 w-4\"}),\"إرسال إشعار خارجي\"]})}),e.jsx(H,{className:\"space-y-4\",children:e.jsxs(\"form\",{onSubmit:S,className:\"space-y-4\",children:[e.jsxs(\"div\",{className:\"space-y-2\",children:[e.jsx(m,{htmlFor:\"userId\",children:\"إرسال لمستخدم محدد (اختياري)\"}),e.jsx(x,{id:\"userId\",value:o,onChange:s=>b(s.target.value),placeholder:\"أدخل معرف المستخدم (UID)\"}),e.jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"إذا تركته فارغاً سيتم إرسال إشعار عام للجميع.\"})]}),e.jsxs(\"div\",{className:\"space-y-2\",children:[e.jsx(m,{htmlFor:\"title\",children:\"العنوان\"}),e.jsx(x,{id:\"title\",value:u,onChange:s=>v(s.target.value),placeholder:\"عنوان الإشعار\"})]}),e.jsxs(\"div\",{className:\"space-y-2\",children:[e.jsx(m,{htmlFor:\"body\",children:\"النص\"}),e.jsx(M,{id:\"body\",value:h,onChange:s=>y(s.target.value),placeholder:\"نص الإشعار\",className:\"min-h-[120px]\"})]}),e.jsxs(\"div\",{className:\"space-y-2\",children:[e.jsxs(m,{htmlFor:\"link\",className:\"flex items-center gap-1\",children:[e.jsx(P,{className:\"h-3 w-3\"}),\" رابط اختياري\"]}),e.jsx(x,{id:\"link\",value:f,onChange:s=>j(s.target.value),placeholder:\"https://example.com أو cashy://...\"})]}),e.jsxs(\"div\",{className:\"flex justify-between\",children:[e.jsx(N,{type:\"button\",onClick:T,disabled:c,variant:\"outline\",children:c?\"...\":\"إرسال اختبار لنفسي\"}),e.jsx(N,{type:\"submit\",disabled:c,className:\"px-6\",children:c?\"جاري الإرسال...\":\"إرسال\"})]})]})})]})})};export{J as default};\r\n//# sourceMappingURL=AdminNotificationsPage-DrTU2ja9.js.map\r\n"],"names":["J","I","u","v","r","h","f","j","c","d","o","b","S","n","g","k","C","l","i","p","w","F","L","U","T","B","e","D","A","E","K","H","m","x","M","P","N"],"mappings":"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"}