import{b,z as y,aj as h,R as p,G as v,L as A,i as g,U as k}from"./index-C_crvORM.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=b("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);async function E({title:l,message:s,audienceKey:a,createdBy:d,linkUrl:n}){const u={title:l,message:s,audienceKey:a,active:!0,createdAt:k(),createdBy:d||null,linkUrl:n||void 0};return(await g(p(v,"broadcasts"),u)).id}function K(l,s){const a=new Map,d=l.map(n=>{const u=y(p(v,"broadcasts"),h("audienceKey","==",n));return A(u,c=>{c.docChanges().forEach(e=>{const o=e.doc.data(),r=e.doc.id,i={...o,id:r};e.type==="removed"?a.delete(r):a.set(r,i)});const f=Array.from(a.values()).filter(e=>e.active===!0);if(f.length===0){s(null);return}const t=f.sort((e,o)=>{var r,i;const M=typeof((r=e.createdAt)==null?void 0:r.toMillis)=="function"?e.createdAt.toMillis():0,m=typeof((i=o.createdAt)==null?void 0:i.toMillis)=="function"?o.createdAt.toMillis():0;return M-m});s(t[t.length-1])},c=>{console.error("subscribeToActiveBroadcasts error:",c),s(null)})});return()=>d.forEach(n=>n())}function L(l,s){const a=new Map,d=l.map(n=>{const u=y(p(v,"broadcasts"),h("audienceKey","==",n));return A(u,c=>{c.docChanges().forEach(t=>{const e=t.doc.data(),o=t.doc.id,r={...e,id:o};t.type==="removed"?a.delete(o):a.set(o,r)});const f=Array.from(a.values()).filter(t=>t.active===!0).sort((t,e)=>{var o,r;const i=typeof((o=t.createdAt)==null?void 0:o.toMillis)=="function"?t.createdAt.toMillis():0;return(typeof((r=e.createdAt)==null?void 0:r.toMillis)=="function"?e.createdAt.toMillis():0)-i});s(f)},c=>{console.error("subscribeToActiveBroadcastsList error:",c),s([])})});return()=>d.forEach(n=>n())}export{B,K as L,L as T,E as w};
//# sourceMappingURL=broadcastService-DGqqg97J-DRJTOIRh.js.map
