{"version":3,"mappings":"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","names":["__iconNode","Ban","createLucideIcon","Moon","Sun","Type","AvatarSelector","selectedAvatarId","onAvatarSelect","className","isOpen","setIsOpen","useState","selectedAvatar","avatarCollection","avatar","jsxs","jsx","MasterPinManagement","userId","user","useFirebaseAuth","effectiveUserId","masterPinDialogOpen","setMasterPinDialogOpen","masterPinMode","setMasterPinMode","isPasswordConfirmOpen","setIsPasswordConfirmOpen","toast","useToast","hasMasterPin","setHasMasterPin","useEffect","mounted","has","MasterPinService","getChangeCountKey","getChangeCount","raw","incrementChangeCount","count","handleCreateOrChangeMasterPin","latestHas","handleMasterPinSuccess","handleMasterPinCancel","Fragment","Button","Shield","Edit","Plus","MasterPinDialog","PLANS","SubscriptionPlan","ResellerManagement","accounts","setAccounts","loading","setLoading","isResellerEnabled","setIsResellerEnabled","isDialogOpen","setIsDialogOpen","isPricingDialogOpen","setIsPricingDialogOpen","isSubmitting","setIsSubmitting","formData","setFormData","isDeleteRequestOpen","setIsDeleteRequestOpen","deleteReason","setDeleteReason","selectedAccountForDelete","setSelectedAccountForDelete","isDeleteSubmitting","setIsDeleteSubmitting","isCancelRequestOpen","setIsCancelRequestOpen","cancelReason","setCancelReason","selectedAccountForCancel","setSelectedAccountForCancel","isCancelSubmitting","setIsCancelSubmitting","userDocRef","doc","db","unsubscribeUser","onSnapshot","docSnap","data","q","query","collection","where","unsubscribeAccounts","snapshot","docs","a","b","timeA","_a","_b","error","generateReferralCode","timestamp","handleSubmit","e","secondaryApp","initializeApp","firebaseConfig","secondaryAuth","getAuth","secondaryDb","getFirestore","newUser","createUserWithEmailAndPassword","userReferralCode","setDoc","serverTimestamp","shopRef","addDoc","signOut","errorMessage","deleteApp","handleCancelClick","account","handleSubmitCancelRequest","updateDoc","handleDeleteClick","handleDelete","handleSubmitDeleteRequest","id","uid","deleteDoc","userError","getStatusBadge","status","packageName","CheckCircle","Clock","XCircle","Card","DollarSign","CardHeader","CardTitle","Users","Dialog","DialogTrigger","DialogContent","DialogHeader","DialogTitle","Label","Input","prev","Select","value","SelectTrigger","SelectValue","SelectContent","plan","SelectItem","Loader2","CardContent","Trash2","AlertTriangle","Textarea","ProfileSettingsPage","navigate","useNavigate","profile","updateUserProfile","updateAvatarId","refreshProfile","userSubscription","isSubscriptionActive","checkSubscriptionStatus","fontSize","setFontSize","isMobile","useFontSize","appDownloads","setAppDownloads","s1","s2","isRefreshing","setIsRefreshing","isDailyReportsLockEnabled","setIsDailyReportsLockEnabled","isDailyLockTogglePinOpen","setIsDailyLockTogglePinOpen","pendingDailyLockValue","setPendingDailyLockValue","isWalletSelectionPinEnabled","setIsWalletSelectionPinEnabled","isWalletSelectionPinToggleOpen","setIsWalletSelectionPinToggleOpen","pendingWalletSelectionPinValue","setPendingWalletSelectionPinValue","isDebtsPinRequired","setIsDebtsPinRequired","key","isDebtsPinToggleOpen","setIsDebtsPinToggleOpen","pendingDebtsPinValue","setPendingDebtsPinValue","isAndroidNative","Capacitor","isReceiptNoteEnabled","setIsReceiptNoteEnabled","v","isWithdrawSenderNameInputEnabled","setIsWithdrawSenderNameInputEnabled","isSmsReadingEnabled","setIsSmsReadingEnabled","isSmsAutoRegisterEnabled","setIsSmsAutoRegisterEnabled","isAdbSmsReadingEnabled","setIsAdbSmsReadingEnabled","theme","setTheme","useTheme","isDark","setIsDark","notificationPermissionEnabled","setNotificationPermissionEnabled","handleStatus","prefersDark","userDataService","remote","handleReceiptNoteToggle","nextVal","handleWithdrawSenderNameInputToggle","handleSmsReadingToggle","handleSmsAutoRegisterToggle","handleAdbSmsReadingToggle","adbDevices","setAdbDevices","selectedDevice","setSelectedDevice","deviceStatus","setDeviceStatus","wifiIp","setWifiIp","telegramChatId","setTelegramChatId","isZeroPlan","setIsZeroPlan","KNOWN_DEVICES_KEY","getKnownDevices","arr","x","addKnownDevice","set","receiver","setReceiver","amount","setAmount","pinOpen","setPinOpen","transferStatus","setTransferStatus","bridgeLink","setBridgeLink","bridgeDeviceId","setBridgeDeviceId","SHOW_DEVICE_UTILS","SHOW_TRANSFER_UI","handleConnectWifi","api","res","err","val","list","filtered","saved","d","base","wifiCandidate","walletSelectionPinService","handleDailyLockToggle","next","handleWalletSelectionPinToggle","handleDebtsPinToggle","zero","rawLocalPlan","planLocalStr","remoteSub","getUserSubscription","rawRemotePlan","planRemoteStr","getAppDownloads","handleInputChange","name","handleAvatarSelect","avatarId","Preferences","__vitePreload","n","handleRefreshSubscription","ArrowLeft","nextTheme","runtimeDesktopVersion","setRuntimeDesktopVersion","React","version","localVersion","isElectronEnv","label","User","i","testCode","getUssdCode","e1","maybeIp","Save","Switch","Minus","Crown","RefreshCw","getSubscriptionStatusColor","getPlanDisplayName","getDaysRemaining","Code","PinModal","deviceId","pin","pinDigits","receiverDigits","amountInt","pinCode","getUssdCodeWithPin","openUssdDeepLink"],"ignoreList":[0,1,2,3],"sources":["../../node_modules/lucide-react/dist/esm/icons/ban.js","../../node_modules/lucide-react/dist/esm/icons/moon.js","../../node_modules/lucide-react/dist/esm/icons/sun.js","../../node_modules/lucide-react/dist/esm/icons/type.js","../../src/components/AvatarSelector.tsx","../../src/components/MasterPinManagement.tsx","../../src/components/ResellerManagement.tsx","../../src/pages/ProfileSettingsPage.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.561.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M4.929 4.929 19.07 19.071\", key: \"196cmz\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }]\n];\nconst Ban = createLucideIcon(\"ban\", __iconNode);\n\nexport { __iconNode, Ban as default };\n//# sourceMappingURL=ban.js.map\n","/**\n * @license lucide-react v0.561.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401\",\n      key: \"kfwtm\"\n    }\n  ]\n];\nconst Moon = createLucideIcon(\"moon\", __iconNode);\n\nexport { __iconNode, Moon as default };\n//# sourceMappingURL=moon.js.map\n","/**\n * @license lucide-react v0.561.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"4\", key: \"4exip2\" }],\n  [\"path\", { d: \"M12 2v2\", key: \"tus03m\" }],\n  [\"path\", { d: \"M12 20v2\", key: \"1lh1kg\" }],\n  [\"path\", { d: \"m4.93 4.93 1.41 1.41\", key: \"149t6j\" }],\n  [\"path\", { d: \"m17.66 17.66 1.41 1.41\", key: \"ptbguv\" }],\n  [\"path\", { d: \"M2 12h2\", key: \"1t8f8n\" }],\n  [\"path\", { d: \"M20 12h2\", key: \"1q8mjw\" }],\n  [\"path\", { d: \"m6.34 17.66-1.41 1.41\", key: \"1m8zz5\" }],\n  [\"path\", { d: \"m19.07 4.93-1.41 1.41\", key: \"1shlcs\" }]\n];\nconst Sun = createLucideIcon(\"sun\", __iconNode);\n\nexport { __iconNode, Sun as default };\n//# sourceMappingURL=sun.js.map\n","/**\n * @license lucide-react v0.561.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 4v16\", key: \"1654pz\" }],\n  [\"path\", { d: \"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2\", key: \"e0r10z\" }],\n  [\"path\", { d: \"M9 20h6\", key: \"s66wpe\" }]\n];\nconst Type = createLucideIcon(\"type\", __iconNode);\n\nexport { __iconNode, Type as default };\n//# sourceMappingURL=type.js.map\n","import React, { useState } from 'react';\r\nimport { avatarCollection } from '../utils/avatars';\r\n\r\ninterface AvatarSelectorProps {\r\n  selectedAvatarId?: string;\r\n  onAvatarSelect: (avatarId: string) => void;\r\n  className?: string;\r\n}\r\n\r\nconst AvatarSelector: React.FC<AvatarSelectorProps> = ({\r\n  selectedAvatarId,\r\n  onAvatarSelect,\r\n  className = ''\r\n}) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  const selectedAvatar = avatarCollection.find(avatar => avatar.id === selectedAvatarId);\r\n\r\n  return (\r\n    <div className={`relative ${className}`}>\r\n      {/* زر عرض الصورة المختارة */}\r\n      <button\r\n        onClick={() => setIsOpen(!isOpen)}\r\n        className=\"w-20 h-20 rounded-full border-4 border-blue-500 hover:border-blue-600 transition-colors duration-200 bg-white shadow-lg overflow-hidden\"\r\n        type=\"button\"\r\n      >\r\n        {selectedAvatar ? (\r\n          <div className=\"w-full h-full\">\r\n            {selectedAvatar.component}\r\n          </div>\r\n        ) : (\r\n          <div className=\"w-full h-full flex items-center justify-center bg-gray-100\">\r\n            <svg className=\"w-8 h-8 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\r\n            </svg>\r\n          </div>\r\n        )}\r\n      </button>\r\n\r\n      {/* نص توضيحي */}\r\n      <p className=\"text-sm text-gray-600 mt-2 text-center\">\r\n        اختر صورة البروفيل\r\n      </p>\r\n\r\n      {/* قائمة الصور المتاحة */}\r\n      {isOpen && (\r\n        <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 bg-white rounded-lg shadow-xl border border-gray-200 p-4 z-50 min-w-max\">\r\n          <div className=\"grid grid-cols-5 gap-3\">\r\n            {avatarCollection.map((avatar) => (\r\n              <button\r\n                key={avatar.id}\r\n                onClick={() => {\r\n                  onAvatarSelect(avatar.id);\r\n                  setIsOpen(false);\r\n                }}\r\n                className={`w-16 h-16 rounded-full border-2 transition-all duration-200 hover:scale-105 overflow-hidden ${\r\n                  selectedAvatarId === avatar.id\r\n                    ? 'border-blue-500 ring-2 ring-blue-200'\r\n                    : 'border-gray-300 hover:border-blue-400'\r\n                }`}\r\n                type=\"button\"\r\n                title={avatar.name}\r\n              >\r\n                <div className=\"w-full h-full\">\r\n                  {avatar.component}\r\n                </div>\r\n              </button>\r\n            ))}\r\n          </div>\r\n          \r\n          {/* زر الإغلاق */}\r\n          <button\r\n            onClick={() => setIsOpen(false)}\r\n            className=\"mt-3 w-full py-2 text-sm text-gray-500 hover:text-gray-700 transition-colors\"\r\n            type=\"button\"\r\n          >\r\n            إغلاق\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* خلفية شفافة للإغلاق عند النقر خارج القائمة */}\r\n      {isOpen && (\r\n        <div\r\n          className=\"fixed inset-0 z-40\"\r\n          onClick={() => setIsOpen(false)}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AvatarSelector;","import React, { useEffect, useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Shield, Plus, Edit } from 'lucide-react';\r\nimport { MasterPinDialog } from '@/components/MasterPinDialog';\r\nimport { MasterPinService } from '@/utils/masterPinService';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport PasswordConfirmDialog from '@/components/PasswordConfirmDialog';\r\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\r\n\r\ninterface MasterPinManagementProps {\r\n  userId?: string;\r\n}\r\n\r\nexport const MasterPinManagement: React.FC<MasterPinManagementProps> = ({\r\n  userId\r\n}) => {\r\n  const { user } = useFirebaseAuth();\r\n  const effectiveUserId = userId ?? user?.uid;\r\n  const [masterPinDialogOpen, setMasterPinDialogOpen] = useState(false);\r\n  const [masterPinMode, setMasterPinMode] = useState<'verify' | 'create' | 'change'>('create');\r\n  const [isPasswordConfirmOpen, setIsPasswordConfirmOpen] = useState(false);\r\n  const { toast } = useToast();\r\n\r\n  const [hasMasterPin, setHasMasterPin] = useState<boolean>(false);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      try {\r\n        const has = await MasterPinService.hasMasterPin(effectiveUserId);\r\n        if (mounted) setHasMasterPin(!!has);\r\n      } catch {\r\n        if (mounted) setHasMasterPin(false);\r\n      }\r\n    })();\r\n    return () => { mounted = false; };\r\n  }, [effectiveUserId]);\r\n\r\n  const getChangeCountKey = () => effectiveUserId ? `master_pin_change_count_${effectiveUserId}` : 'master_pin_change_count';\r\n  const getChangeCount = () => {\r\n    try {\r\n      const raw = localStorage.getItem(getChangeCountKey());\r\n      return raw ? parseInt(raw, 10) : 0;\r\n    } catch {\r\n      return 0;\r\n    }\r\n  };\r\n  const incrementChangeCount = () => {\r\n    try {\r\n      const count = getChangeCount() + 1;\r\n      localStorage.setItem(getChangeCountKey(), String(count));\r\n    } catch {}\r\n  };\r\n\r\n  const handleCreateOrChangeMasterPin = async () => {\r\n    try {\r\n      const latestHas = await MasterPinService.hasMasterPin(effectiveUserId);\r\n      setHasMasterPin(!!latestHas);\r\n      setMasterPinMode(latestHas ? 'change' : 'create');\r\n      setMasterPinDialogOpen(true);\r\n    } catch {\r\n      setMasterPinMode('create');\r\n      setMasterPinDialogOpen(true);\r\n    }\r\n  };\r\n\r\n  const handleMasterPinSuccess = () => {\r\n    setMasterPinDialogOpen(false);\r\n    if (masterPinMode === 'change') {\r\n      incrementChangeCount();\r\n    }\r\n    // بعد الإنشاء الأول، اعتبر أن هناك رقم سري محفوظ لطلب الحالي في المرات القادمة\r\n    if (masterPinMode === 'create') {\r\n      setHasMasterPin(true);\r\n    }\r\n    toast({\r\n      title: \"تم بنجاح\",\r\n      description: hasMasterPin ? \"تم تغيير الرقم السري الرئيسي\" : \"تم إنشاء الرقم السري الرئيسي\",\r\n    });\r\n  };\r\n\r\n  const handleMasterPinCancel = () => {\r\n    setMasterPinDialogOpen(false);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Button\r\n        variant=\"outline\"\r\n        size=\"sm\"\r\n        onClick={handleCreateOrChangeMasterPin}\r\n        className=\"flex items-center gap-2 text-sm\"\r\n      >\r\n        <Shield className=\"h-4 w-4\" />\r\n        {hasMasterPin ? (\r\n          <>\r\n            <Edit className=\"h-4 w-4\" />\r\n            تغيير الرقم السري الرئيسي\r\n          </>\r\n        ) : (\r\n          <>\r\n            <Plus className=\"h-4 w-4\" />\r\n            إنشاء رقم سري رئيسي\r\n          </>\r\n        )}\r\n      </Button>\r\n\r\n\r\n      <MasterPinDialog\r\n        open={masterPinDialogOpen}\r\n        onOpenChange={setMasterPinDialogOpen}\r\n        mode={masterPinMode}\r\n        onSuccess={handleMasterPinSuccess}\r\n        onCancel={handleMasterPinCancel}\r\n      />\r\n    </>\r\n  );\r\n};","import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\nimport { useToast } from '@/hooks/use-toast';\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\nimport { db, firebaseConfig } from '@/firebase';\nimport { collection, addDoc, query, where, onSnapshot, orderBy, serverTimestamp, deleteDoc, doc, setDoc, getFirestore, updateDoc } from 'firebase/firestore';\nimport { Users, Plus, Loader2, Trash2, CheckCircle, Clock, XCircle, AlertTriangle, Ban, DollarSign } from 'lucide-react';\nimport { initializeApp, deleteApp } from 'firebase/app';\nimport { getAuth, createUserWithEmailAndPassword, signOut } from 'firebase/auth';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { SubscriptionPlan } from '@/utils/subscriptionService';\n\ninterface ResellerAccount {\n  id: string;\n  uid?: string;\n  email: string;\n  password?: string;\n  phone?: string;\n  status: 'pending' | 'active' | 'inactive';\n  packageName?: string;\n  ownerId: string;\n  createdAt: any;\n  startDate?: any;\n  endDate?: any;\n  deletionRequested?: boolean;\n  deletionReason?: string;\n  deletionStatus?: 'pending' | 'rejected';\n  cancelRequested?: boolean;\n  cancelReason?: string;\n  cancelStatus?: 'pending' | 'rejected';\n}\n\nconst PLANS = [\n  { value: SubscriptionPlan.MONTHLY, label: 'باقة شهرية' },\n  { value: SubscriptionPlan.QUARTERLY, label: 'باقة ربع سنوية' },\n  { value: SubscriptionPlan.YEARLY, label: 'باقة سنوية' },\n  { value: SubscriptionPlan.LIFETIME, label: 'باقة مدى الحياة' },\n];\n\nexport const ResellerManagement = () => {\n  const { user } = useFirebaseAuth();\n  const { toast } = useToast();\n  const [accounts, setAccounts] = useState<ResellerAccount[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [isResellerEnabled, setIsResellerEnabled] = useState(false);\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [isPricingDialogOpen, setIsPricingDialogOpen] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [formData, setFormData] = useState({ email: '', password: '', phone: '', packageName: '' });\n\n  // Delete Request States\n  const [isDeleteRequestOpen, setIsDeleteRequestOpen] = useState(false);\n  const [deleteReason, setDeleteReason] = useState('');\n  const [selectedAccountForDelete, setSelectedAccountForDelete] = useState<string | null>(null);\n  const [isDeleteSubmitting, setIsDeleteSubmitting] = useState(false);\n\n  // Cancel Package Request States\n  const [isCancelRequestOpen, setIsCancelRequestOpen] = useState(false);\n  const [cancelReason, setCancelReason] = useState('');\n  const [selectedAccountForCancel, setSelectedAccountForCancel] = useState<string | null>(null);\n  const [isCancelSubmitting, setIsCancelSubmitting] = useState(false);\n\n  useEffect(() => {\n    if (!user) return;\n\n    // 1. Check if reseller system is enabled for this user\n    const userDocRef = doc(db, 'users', user.uid);\n    const unsubscribeUser = onSnapshot(userDocRef, (docSnap) => {\n      if (docSnap.exists()) {\n        const data = docSnap.data();\n        setIsResellerEnabled(data.isResellerEnabled === true);\n      }\n    });\n\n    // 2. Fetch reseller accounts\n    const q = query(\n      collection(db, 'reseller_requests'),\n      where('ownerId', '==', user.uid)\n    );\n\n    const unsubscribeAccounts = onSnapshot(q, (snapshot) => {\n      const docs = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() } as ResellerAccount));\n      // فرز النتائج محلياً بدلاً من الخادم لتجنب مشاكل الفهرسة\n      docs.sort((a, b) => {\n        const timeA = a.createdAt?.seconds || 0;\n        const timeB = b.createdAt?.seconds || 0;\n        return timeB - timeA;\n      });\n      setAccounts(docs);\n      setLoading(false);\n    }, (error) => {\n      console.error(\"Error fetching reseller accounts:\", error);\n      setLoading(false);\n    });\n\n    return () => {\n      unsubscribeUser();\n      unsubscribeAccounts();\n    };\n  }, [user]);\n\n  const generateReferralCode = (userId: string) => {\n    const timestamp = Date.now().toString(36);\n    const userHash = userId.slice(-6);\n    return `REF_${userHash}_${timestamp}`.toUpperCase();\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!user) {\n      toast({ title: 'خطأ', description: 'يجب تسجيل الدخول أولاً', variant: 'destructive' });\n      return;\n    }\n    if (!formData.email || !formData.password || !formData.phone || !formData.packageName) {\n      toast({ title: 'خطأ', description: 'يرجى ملء جميع الحقول', variant: 'destructive' });\n      return;\n    }\n\n    setIsSubmitting(true);\n    let secondaryApp: any = null;\n\n    try {\n      // 1. إنشاء حساب في Firebase Auth باستخدام تطبيق ثانوي\n      // نستخدم تطبيق ثانوي لكي لا يتم تسجيل خروج المستخدم الحالي\n      secondaryApp = initializeApp(firebaseConfig, \"SecondaryApp\");\n      const secondaryAuth = getAuth(secondaryApp);\n      const secondaryDb = getFirestore(secondaryApp);\n      \n      const userCredential = await createUserWithEmailAndPassword(secondaryAuth, formData.email, formData.password);\n      const newUser = userCredential.user;\n      const userReferralCode = generateReferralCode(newUser.uid);\n      \n      // 2. إنشاء وثيقة المستخدم والمتجر باستخدام حساب المستخدم الجديد (لتجاوز قواعد الأمان)\n      // نستخدم secondaryDb لأن المستخدم الجديد هو المسجل فيه\n      \n      // أ. إنشاء وثيقة المستخدم\n      await setDoc(doc(secondaryDb, 'users', newUser.uid), {\n        email: formData.email,\n        displayName: 'مستخدم ريسيلر',\n        phone: formData.phone,\n        shopName: null,\n        isActive: false, // يبدأ غير نشط حتى يتم تفعيله\n        role: 'merchant',\n        referralCode: userReferralCode,\n        ownerId: user.uid, // إضافة معرف المالك (الريسيلر) للسماح بالحذف\n        createdAt: serverTimestamp(),\n        updatedAt: serverTimestamp(),\n        lastLogin: null\n      });\n\n      // ب. إنشاء متجر افتراضي للمستخدم\n      const shopRef = await addDoc(collection(secondaryDb, 'shops'), {\n        name: 'متجر جديد',\n        ownerId: newUser.uid,\n        createdAt: serverTimestamp(),\n        updatedAt: serverTimestamp(),\n        isActive: true\n      });\n\n      // ج. إنشاء ملف التعريف (Profile)\n      await setDoc(doc(secondaryDb, 'profiles', newUser.uid), {\n        userId: newUser.uid,\n        shopId: shopRef.id,\n        role: 'merchant',\n        fullName: 'مستخدم ريسيلر',\n        phone: formData.phone,\n        referralCode: userReferralCode,\n        createdAt: serverTimestamp(),\n        updatedAt: serverTimestamp()\n      });\n\n      // تسجيل الخروج من التطبيق الثانوي\n      await signOut(secondaryAuth);\n\n      // 3. إنشاء وثيقة طلب الريسيلر (باستخدام حساب الريسيلر الحالي)\n      // نستخدم db الأساسي هنا\n      await addDoc(collection(db, 'reseller_requests'), {\n        ownerId: user.uid,\n        uid: newUser.uid, // ربط الطلب بحساب المستخدم الجديد\n        email: formData.email,\n        password: formData.password, // الاحتفاظ بكلمة المرور هنا كما هو مطلوب للعرض\n        phone: formData.phone,\n        packageName: formData.packageName,\n        shopId: shopRef.id,\n        status: 'pending',\n        createdAt: serverTimestamp(),\n      });\n      \n      toast({ title: 'تمت الإضافة', description: 'تم إنشاء الحساب وإضافته لقائمة الريسيلر بنجاح' });\n      setIsDialogOpen(false);\n      setFormData({ email: '', password: '', phone: '', packageName: '' });\n    } catch (error: any) {\n      console.error(\"Error adding account:\", error);\n      let errorMessage = 'حدث خطأ أثناء إضافة الحساب';\n      if (error.code === 'auth/email-already-in-use') {\n        errorMessage = 'البريد الإلكتروني مستخدم بالفعل';\n      } else if (error.code === 'auth/weak-password') {\n        errorMessage = 'كلمة المرور ضعيفة جداً';\n      } else if (error.code === 'auth/invalid-email') {\n        errorMessage = 'البريد الإلكتروني غير صالح';\n      }\n      toast({ title: 'خطأ', description: errorMessage, variant: 'destructive' });\n    } finally {\n      if (secondaryApp) {\n        try {\n          await deleteApp(secondaryApp);\n        } catch (e) {\n          console.error(\"Error deleting secondary app:\", e);\n        }\n      }\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleCancelClick = (account: ResellerAccount) => {\n    setSelectedAccountForCancel(account.id);\n    setCancelReason('');\n    setIsCancelRequestOpen(true);\n  };\n\n  const handleSubmitCancelRequest = async () => {\n    if (!selectedAccountForCancel) return;\n    if (!cancelReason.trim()) {\n      toast({ title: 'خطأ', description: 'يرجى كتابة سبب الإلغاء', variant: 'destructive' });\n      return;\n    }\n\n    setIsCancelSubmitting(true);\n    try {\n      await updateDoc(doc(db, 'reseller_requests', selectedAccountForCancel), {\n        cancelRequested: true,\n        cancelReason: cancelReason,\n        cancelStatus: 'pending'\n      });\n      toast({ title: 'تم الإرسال', description: 'تم إرسال طلب إلغاء الباقة للإدارة بنجاح' });\n      setIsCancelRequestOpen(false);\n    } catch (error) {\n      console.error(\"Error submitting cancel request:\", error);\n      toast({ title: 'خطأ', description: 'حدث خطأ أثناء إرسال الطلب', variant: 'destructive' });\n    } finally {\n      setIsCancelSubmitting(false);\n    }\n  };\n\n  const handleDeleteClick = (account: ResellerAccount) => {\n    // If pending, allow direct delete (cancel request)\n    if (account.status === 'pending') {\n      if (window.confirm('هل أنت متأكد من حذف هذا الحساب نهائياً؟')) {\n        handleDelete(account.id, account.uid);\n      }\n      return;\n    }\n\n    // Otherwise open delete request dialog\n    setSelectedAccountForDelete(account.id);\n    setDeleteReason('');\n    setIsDeleteRequestOpen(true);\n  };\n\n  const handleSubmitDeleteRequest = async () => {\n    if (!selectedAccountForDelete) return;\n    if (!deleteReason.trim()) {\n      toast({ title: 'خطأ', description: 'يرجى كتابة سبب الحذف', variant: 'destructive' });\n      return;\n    }\n\n    setIsDeleteSubmitting(true);\n    try {\n      await updateDoc(doc(db, 'reseller_requests', selectedAccountForDelete), {\n        deletionRequested: true,\n        deletionReason: deleteReason,\n        deletionStatus: 'pending'\n      });\n      toast({ title: 'تم الإرسال', description: 'تم إرسال طلب الحذف للإدارة بنجاح' });\n      setIsDeleteRequestOpen(false);\n    } catch (error) {\n      console.error(\"Error submitting delete request:\", error);\n      toast({ title: 'خطأ', description: 'حدث خطأ أثناء إرسال الطلب', variant: 'destructive' });\n    } finally {\n      setIsDeleteSubmitting(false);\n    }\n  };\n\n  const handleDelete = async (id: string, uid?: string) => {\n    try {\n      // 1. حذف طلب الريسيلر\n      await deleteDoc(doc(db, 'reseller_requests', id));\n      \n      // 2. حذف وثيقة المستخدم من مجموعة users إذا توفر uid\n      if (uid) {\n        try {\n          await deleteDoc(doc(db, 'users', uid));\n        } catch (userError) {\n          console.error(\"Error deleting user doc:\", userError);\n          // لا نوقف العملية إذا فشل حذف المستخدم\n        }\n      }\n\n      toast({ title: 'تم الحذف', description: 'تم حذف الحساب بنجاح' });\n    } catch (error) {\n      console.error(\"Error deleting request:\", error);\n      toast({ title: 'خطأ', description: 'حدث خطأ أثناء الحذف', variant: 'destructive' });\n    }\n  };\n\n  const getStatusBadge = (status: string, packageName?: string) => {\n    switch (status) {\n      case 'active':\n        return (\n          <div className=\"flex items-center gap-1 text-green-600 bg-green-50 px-2 py-1 rounded-full text-xs\">\n            <CheckCircle className=\"w-3 h-3\" />\n            <span>نشط {packageName ? `- ${packageName}` : ''}</span>\n          </div>\n        );\n      case 'pending':\n        return (\n          <div className=\"flex items-center gap-1 text-yellow-600 bg-yellow-50 px-2 py-1 rounded-full text-xs\">\n            <Clock className=\"w-3 h-3\" />\n            <span>قيد الانتظار</span>\n          </div>\n        );\n      case 'inactive':\n        return (\n          <div className=\"flex items-center gap-1 text-red-600 bg-red-50 px-2 py-1 rounded-full text-xs\">\n            <XCircle className=\"w-3 h-3\" />\n            <span>غير نشط</span>\n          </div>\n        );\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <Card className={`shadow-lg mb-6 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800 relative overflow-hidden ${!isResellerEnabled ? 'min-h-[500px]' : ''}`}>\n      {!isResellerEnabled && (\n        <div className=\"absolute inset-0 z-50 backdrop-blur-sm bg-yellow-50/50 flex flex-col items-center justify-center p-6 text-center\">\n          <div className=\"bg-white p-6 rounded-full shadow-lg mb-4\">\n            <Ban className=\"w-12 h-12 text-red-500\" />\n          </div>\n          <h3 className=\"text-xl font-bold text-gray-900 mb-2\">نظام الريسيلر غير مفعل</h3>\n          <p className=\"text-gray-600 max-w-md mb-6\">\n            هذا النظام غير مفعل لحسابك حالياً. يرجى التواصل مع إدارة الموقع لتفعيل نظام الريسيلر والبدء في إضافة الحسابات.\n          </p>\n          <Button \n            onClick={() => setIsPricingDialogOpen(true)}\n            className=\"bg-green-600 hover:bg-green-700 text-white gap-2\"\n          >\n            <DollarSign className=\"w-4 h-4\" />\n            تكسب إزاي؟\n          </Button>\n\n\n        </div>\n      )}\n      <CardHeader className=\"flex flex-row items-center justify-between\">\n        <CardTitle className=\"flex items-center gap-2 dark:text-white\">\n          <Users className=\"h-5 w-5\" />\n          نظام الريسيلر\n        </CardTitle>\n        <div className=\"flex items-center gap-2\">\n          <Button \n            size=\"sm\"\n            onClick={() => setIsPricingDialogOpen(true)}\n            className=\"bg-green-600 hover:bg-green-700 text-white gap-2 shadow-sm\"\n          >\n            <DollarSign className=\"w-4 h-4\" />\n            تكسب إزاي؟\n          </Button>\n          <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n            <DialogTrigger asChild>\n              <Button size=\"sm\" className=\"gap-2 bg-blue-600 hover:bg-blue-700 text-white shadow-sm\">\n                <Plus className=\"h-4 w-4\" />\n                إضافة حساب\n              </Button>\n            </DialogTrigger>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>إضافة حساب ريسيلر جديد</DialogTitle>\n            </DialogHeader>\n            <form onSubmit={handleSubmit} className=\"space-y-4 mt-4\">\n              <div className=\"space-y-2\">\n                <Label>البريد الإلكتروني</Label>\n                <Input \n                  type=\"email\" \n                  value={formData.email}\n                  onChange={(e) => setFormData(prev => ({ ...prev, email: e.target.value }))}\n                  placeholder=\"email@example.com\"\n                  required\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>رقم الهاتف</Label>\n                <Input \n                  type=\"tel\" \n                  value={formData.phone}\n                  onChange={(e) => setFormData(prev => ({ ...prev, phone: e.target.value }))}\n                  placeholder=\"01xxxxxxxxx\"\n                  required\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>نوع الباقة</Label>\n                <Select\n                  value={formData.packageName}\n                  onValueChange={(value) => setFormData(prev => ({ ...prev, packageName: value }))}\n                  required\n                >\n                  <SelectTrigger className=\"text-right\" dir=\"rtl\">\n                    <SelectValue placeholder=\"اختر الباقة\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {PLANS.map((plan) => (\n                      <SelectItem key={plan.value} value={plan.value} className=\"text-right\" dir=\"rtl\">\n                        {plan.label}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n              <div className=\"space-y-2\">\n                <Label>كلمة المرور</Label>\n                <Input \n                  type=\"text\" \n                  value={formData.password}\n                  onChange={(e) => setFormData(prev => ({ ...prev, password: e.target.value }))}\n                  placeholder=\"كلمة المرور للحساب\"\n                  required\n                />\n              </div>\n              <Button type=\"submit\" className=\"w-full bg-blue-600 hover:bg-blue-700 text-white\" disabled={isSubmitting}>\n                {isSubmitting ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}\n                إضافة الحساب\n              </Button>\n            </form>\n          </DialogContent>\n        </Dialog>\n        </div>\n      </CardHeader>\n      <CardContent>\n        {loading ? (\n          <div className=\"text-center py-4 text-gray-500\">جاري التحميل...</div>\n        ) : accounts.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 bg-gray-50 rounded-lg border border-dashed border-gray-200\">\n            لا توجد حسابات مضافة حالياً\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {accounts.map((account) => (\n              <div key={account.id} className=\"flex items-center justify-between p-3 rounded-lg border border-gray-100 bg-gray-50/50 hover:bg-gray-50 transition-colors\">\n                <div className=\"space-y-1\">\n                  <div className=\"font-medium text-sm text-gray-900 dark:text-gray-100\">{account.email}</div>\n                  <div className=\"text-xs text-gray-400 flex flex-col gap-0.5\">\n                    {account.status === 'active' && account.startDate && account.endDate ? (\n                      <>\n                        <span className=\"text-green-600\">البدء: {new Date(account.startDate.seconds * 1000).toLocaleDateString('en-GB')}</span>\n                        <span className=\"text-red-500\">الانتهاء: {new Date(account.endDate.seconds * 1000).toLocaleDateString('en-GB')}</span>\n                      </>\n                    ) : (\n                      <span>{account.createdAt?.seconds ? new Date(account.createdAt.seconds * 1000).toLocaleDateString('en-GB') : ''}</span>\n                    )}\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  {getStatusBadge(account.status, account.packageName)}\n                  \n                  {/* Badge for deletion rejected status */}\n                  {account.deletionStatus === 'rejected' && (\n                    <div className=\"flex items-center gap-1 text-red-600 bg-red-50 px-2 py-1 rounded-full text-xs border border-red-100\">\n                      <XCircle className=\"w-3 h-3\" />\n                      <span>تم رفض طلب الحذف</span>\n                    </div>\n                  )}\n\n                  {/* Badge for deletion pending status */}\n                  {account.deletionRequested && account.deletionStatus === 'pending' && (\n                    <div className=\"flex items-center gap-1 text-orange-600 bg-orange-50 px-2 py-1 rounded-full text-xs border border-orange-100\">\n                      <Clock className=\"w-3 h-3\" />\n                      <span>بانتظار الحذف</span>\n                    </div>\n                  )}\n\n                  {/* Badge for cancellation pending status */}\n                  {account.cancelRequested && account.cancelStatus === 'pending' && (\n                    <div className=\"flex items-center gap-1 text-orange-600 bg-orange-50 px-2 py-1 rounded-full text-xs border border-orange-100\">\n                      <Clock className=\"w-3 h-3\" />\n                      <span>بانتظار إلغاء الباقة</span>\n                    </div>\n                  )}\n\n                  {/* Badge for cancellation rejected status */}\n                  {account.cancelStatus === 'rejected' && (\n                    <div className=\"flex items-center gap-1 text-red-600 bg-red-50 px-2 py-1 rounded-full text-xs border border-red-100\">\n                      <XCircle className=\"w-3 h-3\" />\n                      <span>تم رفض إلغاء الباقة</span>\n                    </div>\n                  )}\n\n                  {account.status === 'active' && (\n                    <Button \n                      variant=\"ghost\" \n                      size=\"icon\" \n                      className=\"text-orange-500 hover:text-orange-700 hover:bg-orange-50 h-8 w-8\"\n                      onClick={() => handleCancelClick(account)}\n                      disabled={account.cancelRequested && account.cancelStatus === 'pending'}\n                      title=\"إلغاء الباقة\"\n                    >\n                      <Ban className=\"h-4 w-4\" />\n                    </Button>\n                  )}\n\n                  <Button \n                    variant=\"ghost\" \n                    size=\"icon\" \n                    className=\"text-red-500 hover:text-red-700 hover:bg-red-50 h-8 w-8\"\n                    onClick={() => handleDeleteClick(account)}\n                    disabled={account.deletionRequested && account.deletionStatus === 'pending'}\n                  >\n                    <Trash2 className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </CardContent>\n\n      {/* Delete Request Dialog */}\n      <Dialog open={isDeleteRequestOpen} onOpenChange={setIsDeleteRequestOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2 text-red-600\">\n              <AlertTriangle className=\"h-5 w-5\" />\n              طلب حذف الحساب\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <p className=\"text-sm text-gray-600\">\n              يرجى كتابة سبب رغبتك في حذف هذا الحساب. سيتم مراجعة الطلب من قبل الإدارة.\n            </p>\n            <div className=\"space-y-2\">\n              <Label>سبب الحذف</Label>\n              <Textarea \n                value={deleteReason}\n                onChange={(e) => setDeleteReason(e.target.value)}\n                placeholder=\"اكتب السبب هنا...\"\n                rows={4}\n              />\n            </div>\n            <Button \n              onClick={handleSubmitDeleteRequest} \n              className=\"w-full bg-red-600 hover:bg-red-700 text-white\"\n              disabled={isDeleteSubmitting}\n            >\n              {isDeleteSubmitting ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}\n              إرسال طلب الحذف\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Cancel Package Request Dialog */}\n      <Dialog open={isCancelRequestOpen} onOpenChange={setIsCancelRequestOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2 text-orange-600\">\n              <Ban className=\"h-5 w-5\" />\n              طلب إلغاء الباقة\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <p className=\"text-sm text-gray-600\">\n              يرجى كتابة سبب رغبتك في إلغاء باقة هذا الحساب. سيتم مراجعة الطلب من قبل الإدارة.\n              <br />\n              <span className=\"text-xs text-red-500 font-semibold\">تنبيه: عند الموافقة سيتم إيقاف تفعيل الحساب فوراً.</span>\n            </p>\n            <div className=\"space-y-2\">\n              <Label>سبب الإلغاء</Label>\n              <Textarea \n                value={cancelReason}\n                onChange={(e) => setCancelReason(e.target.value)}\n                placeholder=\"اكتب السبب هنا...\"\n                rows={4}\n              />\n            </div>\n            <Button \n              onClick={handleSubmitCancelRequest} \n              className=\"w-full bg-orange-600 hover:bg-orange-700 text-white\"\n              disabled={isCancelSubmitting}\n            >\n              {isCancelSubmitting ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}\n              إرسال طلب الإلغاء\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n      <Dialog open={isPricingDialogOpen} onOpenChange={setIsPricingDialogOpen}>\n        <DialogContent className=\"max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle className=\"text-center text-xl font-bold mb-4\">قائمة الأسعار والأرباح</DialogTitle>\n          </DialogHeader>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-right border-collapse\">\n              <thead>\n                <tr className=\"bg-gray-100\">\n                  <th className=\"p-3 border text-gray-700\">نوع الباقة</th>\n                  <th className=\"p-3 border text-blue-600\">سعر البيع للعميل</th>\n                  <th className=\"p-3 border text-red-600\">التكلفة عليك</th>\n                  <th className=\"p-3 border text-green-600\">صافي ربحك</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  <td className=\"p-3 border font-medium\">باقة شهرية</td>\n                  <td className=\"p-3 border\">150 ج.م</td>\n                  <td className=\"p-3 border\">100 ج.م</td>\n                  <td className=\"p-3 border font-bold text-green-600\">50 ج.م</td>\n                </tr>\n                <tr>\n                  <td className=\"p-3 border font-medium\">باقة ربع سنوية</td>\n                  <td className=\"p-3 border\">350 ج.م</td>\n                  <td className=\"p-3 border\">250 ج.م</td>\n                  <td className=\"p-3 border font-bold text-green-600\">100 ج.م</td>\n                </tr>\n                <tr>\n                  <td className=\"p-3 border font-medium\">باقة سنوية</td>\n                  <td className=\"p-3 border\">1150 ج.م</td>\n                  <td className=\"p-3 border\">900 ج.م</td>\n                  <td className=\"p-3 border font-bold text-green-600\">250 ج.م</td>\n                </tr>\n                <tr>\n                  <td className=\"p-3 border font-medium\">باقة مدى الحياة</td>\n                  <td className=\"p-3 border\">3000 ج.م</td>\n                  <td className=\"p-3 border\">2400 ج.م</td>\n                  <td className=\"p-3 border font-bold text-green-600\">600 ج.م</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </Card>\n  );\n};\n","import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { ArrowLeft, Save, User, Crown, Calendar, Clock, RefreshCw, Shield, Type, Minus, Plus, Send, Moon, Sun, CheckCircle, Code } from 'lucide-react';\nimport { useNavigate } from 'react-router-dom';\nimport { useToast } from '@/hooks/use-toast';\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\nimport { useFontSize } from '@/contexts/FontSizeContext';\nimport AvatarSelector from '@/components/AvatarSelector';\nimport { getAppDownloads, type AppDownloads } from '@/utils/appDownloadService';\nimport PinModal from '@/components/PinModal';\nimport { MasterPinManagement } from '@/components/MasterPinManagement';\nimport { formatDate, getDaysRemaining, getPlanDisplayName, getSubscriptionStatusColor, SubscriptionPlan, getUserSubscription } from '@/utils/subscriptionService';\nimport { Switch } from '@/components/ui/switch';\nimport { MasterPinDialog } from '@/components/MasterPinDialog';\nimport { openUssdDeepLink, sendTransferDeepLink, getUssdCode, getUssdCodeWithPin, getUssdCodeBySender } from '@/utils/ussdDialer';\nimport { walletSelectionPinService } from '@/utils/walletSelectionPinService';\nimport { userDataService } from '@/integrations/firebase/services';\nimport { useTheme } from 'next-themes';\nimport { Capacitor } from '@capacitor/core';\nimport { db, functions } from '@/firebase';\nimport { httpsCallable } from 'firebase/functions';\nimport { doc, setDoc } from 'firebase/firestore';\nimport { ResellerManagement } from '@/components/ResellerManagement';\n\nconst ProfileSettingsPage: React.FC = () => {\n  const navigate = useNavigate();\n  const { toast } = useToast();\n  const { user, profile, updateUserProfile, updateAvatarId, refreshProfile, userSubscription, isSubscriptionActive, checkSubscriptionStatus } = useFirebaseAuth();\n  const { fontSize, setFontSize, isMobile } = useFontSize();\n  const [appDownloads, setAppDownloads] = useState<AppDownloads | null>(null);\n  \n  const [formData, setFormData] = useState({\n    fullName: profile?.fullName || '',\n    phone: profile?.phone || '',\n    sim1Number: '',\n    sim2Number: '',\n    avatarId: profile?.avatarId || ''\n  });\n\n  useEffect(() => {\n    try {\n      const uid = user?.uid || 'default';\n      const s1 = localStorage.getItem(`sim1Number_${uid}`) || localStorage.getItem('sim1Number') || '';\n      const s2 = localStorage.getItem(`sim2Number_${uid}`) || localStorage.getItem('sim2Number') || '';\n      setFormData(prev => ({\n        ...prev,\n        sim1Number: s1,\n        sim2Number: s2\n      }));\n    } catch {}\n  }, [user?.uid]);\n  \n  const [loading, setLoading] = useState(false);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [isDailyReportsLockEnabled, setIsDailyReportsLockEnabled] = useState<boolean>(false);\n  const [isDailyLockTogglePinOpen, setIsDailyLockTogglePinOpen] = useState<boolean>(false);\n  const [pendingDailyLockValue, setPendingDailyLockValue] = useState<boolean | null>(null);\n  const [isWalletSelectionPinEnabled, setIsWalletSelectionPinEnabled] = useState<boolean>(false);\n  const [isWalletSelectionPinToggleOpen, setIsWalletSelectionPinToggleOpen] = useState<boolean>(false);\n  const [pendingWalletSelectionPinValue, setPendingWalletSelectionPinValue] = useState<boolean | null>(null);\n  const [isDebtsPinRequired, setIsDebtsPinRequired] = useState<boolean>(() => {\n    try {\n      const key = user?.uid ? `debtsPinRequired_${user?.uid}` : 'debtsPinRequired';\n      const v = localStorage.getItem(key) ?? localStorage.getItem('debtsPinRequired');\n      return v === 'true';\n    } catch { return false; }\n  });\n  const [isDebtsPinToggleOpen, setIsDebtsPinToggleOpen] = useState<boolean>(false);\n  const [pendingDebtsPinValue, setPendingDebtsPinValue] = useState<boolean | null>(null);\n  const isAndroidNative = Capacitor?.isNativePlatform && Capacitor.getPlatform() === 'android';\n  const [isReceiptNoteEnabled, setIsReceiptNoteEnabled] = useState<boolean>(() => {\n    try {\n      const key = user?.uid ? `receiptNoteEnabled_${user?.uid}` : 'receiptNoteEnabled';\n      const v = localStorage.getItem(key) ?? localStorage.getItem('receiptNoteEnabled');\n      return v === null ? true : v === 'true';\n    } catch {\n      return true;\n    }\n  });\n  const [isWithdrawSenderNameInputEnabled, setIsWithdrawSenderNameInputEnabled] = useState<boolean>(() => {\n    try {\n      const key = user?.uid ? `withdrawSenderNameInputEnabled_${user?.uid}` : 'withdrawSenderNameInputEnabled';\n      const v = localStorage.getItem(key) ?? localStorage.getItem('withdrawSenderNameInputEnabled');\n      return v === null ? false : v === 'true';\n    } catch {\n      return false;\n    }\n  });\n  const [isSmsReadingEnabled, setIsSmsReadingEnabled] = useState<boolean>(() => {\n    try {\n      const v = (profile as any)?.smsReadingEnabled;\n      return v === undefined ? false : !!v;\n    } catch {\n      return false;\n    }\n  });\n  const [isSmsAutoRegisterEnabled, setIsSmsAutoRegisterEnabled] = useState<boolean>(() => {\n    try {\n      const v = (profile as any)?.smsAutoRegisterEnabled;\n      return v === undefined ? false : !!v;\n    } catch {\n      return false;\n    }\n  });\n  const [isAdbSmsReadingEnabled, setIsAdbSmsReadingEnabled] = useState<boolean>(() => {\n    try {\n      return localStorage.getItem('adbSmsReadingEnabled') === 'true';\n    } catch { return false; }\n  });\n  const { theme, setTheme } = useTheme();\n  const [isDark, setIsDark] = useState<boolean>(false);\n\n  const [notificationPermissionEnabled, setNotificationPermissionEnabled] = useState<boolean | null>(null);\n\n  useEffect(() => {\n    // الاستماع لحالة الإذن\n    const handleStatus = (e: CustomEvent) => {\n        if (e.detail && typeof e.detail.enabled === 'boolean') {\n            setNotificationPermissionEnabled(e.detail.enabled);\n        }\n    };\n    window.addEventListener('notificationListenerStatus', handleStatus as any);\n    \n    // طلب التحقق فوراً عند فتح الصفحة\n    if (isAndroidNative) {\n        setTimeout(() => {\n             try { window.location.href = \"cashy://checkNotificationStatus\"; } catch {}\n        }, 500);\n    }\n\n    return () => window.removeEventListener('notificationListenerStatus', handleStatus as any);\n  }, [isAndroidNative]);\n\n  useEffect(() => {\n    try {\n      const t = theme || (localStorage.getItem('theme') || 'system');\n      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;\n      setIsDark(t === 'dark' || (t === 'system' && prefersDark));\n    } catch {}\n  }, [theme]);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const uid = user?.uid || '';\n        if (!uid) return;\n        const data = await userDataService.getUserData(uid);\n        const remote: any = (data as any)?.withdrawSenderNameInputEnabled;\n        if (typeof remote === 'boolean') {\n          setIsWithdrawSenderNameInputEnabled(remote);\n          try { localStorage.setItem(`withdrawSenderNameInputEnabled_${uid}`, remote ? 'true' : 'false'); } catch {}\n        }\n      } catch {}\n    })();\n  }, [user?.uid]);\n\n  const handleReceiptNoteToggle = (nextVal: boolean) => {\n    setIsReceiptNoteEnabled(nextVal);\n    try {\n      if (user?.uid) {\n        localStorage.setItem(`receiptNoteEnabled_${user.uid}`, nextVal ? 'true' : 'false');\n      }\n      localStorage.setItem('receiptNoteEnabled', nextVal ? 'true' : 'false');\n    } catch {}\n    toast({\n      title: nextVal ? 'ستظهر ملاحظة الإيصال' : 'سيتم إخفاء ملاحظة الإيصال',\n      description: nextVal ? 'سيتم عرض الملاحظة عند توفرها.' : 'لن يتم عرض الملاحظة داخل الإيصال والطباعة.',\n    });\n  };\n  const handleWithdrawSenderNameInputToggle = (nextVal: boolean) => {\n    setIsWithdrawSenderNameInputEnabled(nextVal);\n    try {\n      if (user?.uid) {\n        localStorage.setItem(`withdrawSenderNameInputEnabled_${user.uid}`, nextVal ? 'true' : 'false');\n        userDataService.updateUserData(user.uid, { withdrawSenderNameInputEnabled: nextVal });\n      }\n      localStorage.setItem('withdrawSenderNameInputEnabled', nextVal ? 'true' : 'false');\n    } catch {}\n    toast({\n      title: nextVal ? 'سيظهر خانة اسم الراسل' : 'سيتم إخفاء خانة اسم الراسل',\n      description: nextVal ? 'ستظهر خانة كتابة اسم الراسل في نموذج السحب.' : 'لن تظهر خانة كتابة اسم الراسل في نموذج السحب.',\n    });\n  };\n  const handleSmsReadingToggle = async (nextVal: boolean) => {\n    setIsSmsReadingEnabled(nextVal);\n    try {\n      await updateUserProfile({ smsReadingEnabled: nextVal });\n    } catch {}\n    toast({\n      title: nextVal ? 'تم تفعيل قراءة رسائل SMS' : 'تم إلغاء قراءة رسائل SMS',\n      description: nextVal ? 'ستظهر النافذة المنبثقة عند استقبال رسالة.' : 'لن تتم قراءة الرسائل ولن تظهر النافذة المنبثقة.',\n    });\n  };\n\n\n  const handleSmsAutoRegisterToggle = async (nextVal: boolean) => {\n    setIsSmsAutoRegisterEnabled(nextVal);\n    try {\n      if (user?.uid) {\n        localStorage.setItem(`smsAutoRegisterEnabled_${user.uid}`, nextVal ? 'true' : 'false');\n      }\n      localStorage.setItem('smsAutoRegisterEnabled', nextVal ? 'true' : 'false');\n      await updateUserProfile({ smsAutoRegisterEnabled: nextVal });\n    } catch {}\n    toast({\n      title: nextVal ? 'تفعيل التسجيل التلقائي بدون نافذة' : 'إلغاء التسجيل التلقائي بدون نافذة',\n      description: nextVal ? 'سيتم حفظ المعاملة تلقائياً بدون عرض النافذة المنبثقة.' : 'ستظهر النافذة وسيحتاج تأكيد التسجيل يدوياً.',\n    });\n  };\n\n  const handleAdbSmsReadingToggle = async (nextVal: boolean) => {\n    setIsAdbSmsReadingEnabled(nextVal);\n    try {\n      localStorage.setItem('adbSmsReadingEnabled', nextVal ? 'true' : 'false');\n      // Call Electron API if available\n      if ((window as any).electronAPI && (window as any).electronAPI.toggleAdbSms) {\n         await (window as any).electronAPI.toggleAdbSms(nextVal);\n      }\n    } catch (e) { console.error(e); }\n    toast({\n      title: nextVal ? 'تم تفعيل التسجيل التلقائي عبر الكابل' : 'تم تعطيل التسجيل التلقائي عبر الكابل',\n      description: nextVal ? 'سيتم قراءة رسائل فودافون كاش تلقائياً من الموبايل المتصل (USB/Wi-Fi).' : 'لن يتم قراءة الرسائل تلقائياً.',\n    });\n  };\n  // 🔹 أجهزة ADB المتصلة واختيار الجهاز الافتراضي\n  const [adbDevices, setAdbDevices] = useState<Array<{ id: string; model?: string; name?: string; type?: string }>>([]);\n  const [selectedDevice, setSelectedDevice] = useState<string>(() => {\n    try { return localStorage.getItem('cashySelectedDevice') || ''; } catch { return ''; }\n  });\n  const [deviceStatus, setDeviceStatus] = useState<string>('');\n  const [wifiIp, setWifiIp] = useState<string>(() => {\n    try { return localStorage.getItem('cashyWifiIp') || ''; } catch { return ''; }\n  });\n  const [telegramChatId, setTelegramChatId] = useState<string>('');\n  const [isZeroPlan, setIsZeroPlan] = useState<boolean>(false);\n  // قائمة الأجهزة المعروفة (المضافة مسبقًا)\n  const KNOWN_DEVICES_KEY = 'cashyKnownDevices';\n  const getKnownDevices = (): string[] => {\n    try {\n      const raw = localStorage.getItem(KNOWN_DEVICES_KEY);\n      const arr = raw ? JSON.parse(raw) : [];\n      return Array.isArray(arr) ? arr.filter((x) => typeof x === 'string') : [];\n    } catch { return []; }\n  };\n  const addKnownDevice = (id: string) => {\n    try {\n      const set = new Set(getKnownDevices());\n      set.add(id);\n      localStorage.setItem(KNOWN_DEVICES_KEY, JSON.stringify(Array.from(set)));\n    } catch {}\n  };\n  \n  \n  // 🔹 إعدادات التحويل عبر USSD + نافذة إدخال PIN\n  const [receiver, setReceiver] = useState<string>('');\n  const [amount, setAmount] = useState<string>('');\n  const [pinOpen, setPinOpen] = useState<boolean>(false);\n  const [transferStatus, setTransferStatus] = useState<string>('');\n  // 🔹 إعدادات Cashy Bridge (رابط الجسر + معرف الجهاز)\n  const [bridgeLink, setBridgeLink] = useState<string>(() => String((profile as any)?.bridgeLink || ''));\n  const [bridgeDeviceId, setBridgeDeviceId] = useState<string>(() => String((profile as any)?.bridgeDeviceId || ''));\n\n  // إظهار أدوات الجهاز (إدخال IP والاتصال عبر الواي فاي) داخل تطبيق الكمبيوتر فقط\n  const SHOW_DEVICE_UTILS = (() => {\n    if (isAndroidNative) return false;\n    const isElectron = typeof window !== 'undefined' && (\n      (window as any).electronAPI ||\n      window.location.protocol === 'file:' ||\n      (typeof navigator !== 'undefined' && navigator.userAgent.toLowerCase().includes('electron'))\n    );\n    return isElectron && !isMobile;\n  })();\n  const SHOW_TRANSFER_UI = false;\n\n\n  // استرجاع رقم محفظة المُرسل المختارة من التخزين المحلي\n  const getSelectedWalletPhone = (): string => {\n    try {\n      const selectedKey = `selectedWallet_${user?.uid || 'default'}`;\n      const walletsKey = `wallets_${user?.uid || 'default'}`;\n      const selectedId = localStorage.getItem(selectedKey);\n      const raw = localStorage.getItem(walletsKey);\n      const list = raw ? JSON.parse(raw) : [];\n      if (selectedId && Array.isArray(list)) {\n        const w = list.find((x: any) => x && x.id === selectedId);\n        return (w?.phone || '').toString();\n      }\n      return '';\n    } catch {\n      return '';\n    }\n  };\n\n  useEffect(() => {\n    // مزامنة الحالة عندما يتم تحديث بروفايل المستخدم بعد التحميل\n    setBridgeLink(String((profile as any)?.bridgeLink || ''));\n    setBridgeDeviceId(String((profile as any)?.bridgeDeviceId || ''));\n  }, [profile?.bridgeLink, profile?.bridgeDeviceId]);\n\n  useEffect(() => {\n    try {\n      const v = (profile as any)?.smsReadingEnabled;\n      if (v !== undefined) setIsSmsReadingEnabled(!!v);\n    } catch {}\n  }, [(profile as any)?.smsReadingEnabled]);\n\n  useEffect(() => {\n    try {\n      const v = (profile as any)?.smsAutoRegisterEnabled;\n      if (v !== undefined) setIsSmsAutoRegisterEnabled(!!v);\n    } catch {}\n  }, [(profile as any)?.smsAutoRegisterEnabled]);\n\n  const handleConnectWifi = async () => {\n    try {\n      const api: any = (window as any).electronAPI;\n      if (!api || typeof api.connectWifi !== 'function') {\n        setDeviceStatus('❌ هذه الميزة متاحة داخل تطبيق سطح المكتب فقط');\n        return;\n      }\n      if (!wifiIp.trim()) {\n        setDeviceStatus('❌ أدخل عنوان IP مع المنفذ (مثال: 192.168.1.8:5555)');\n        return;\n      }\n      setDeviceStatus('🔄 جارِ الاتصال عبر Wi‑Fi...');\n      const res = await api.connectWifi(wifiIp.trim());\n      setDeviceStatus(`✅ تم الاتصال: ${String(res || '').trim() || 'نجاح'}`);\n      // أضف الجهاز إلى القائمة المعروفة ليظهر في الاختيار لاحقًا\n      addKnownDevice(wifiIp.trim());\n      // سيظهر الجهاز تلقائياً في القائمة خلال ثوانٍ\n    } catch (err: any) {\n      setDeviceStatus(`❌ فشل الاتصال: ${err?.message || String(err)}`);\n    }\n  };\n\n  useEffect(() => {\n    try { localStorage.setItem('cashyWifiIp', wifiIp); } catch {}\n  }, [wifiIp]);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const uid = user?.uid || '';\n        if (!uid) return;\n        const data = await userDataService.getUserData(uid);\n        const val = String((data as any)?.telegramChatId || '').trim();\n        setTelegramChatId(val);\n      } catch {}\n    })();\n  }, [user?.uid]);\n\n  useEffect(() => {\n    const api: any = (window as any).electronAPI;\n    if (api && typeof api.onAdbDevices === 'function') {\n      api.onAdbDevices((list: Array<{ id: string; model?: string; name?: string; type?: string }>) => {\n        const devices = Array.isArray(list) ? list : [];\n        // أظهر جميع الأجهزة (USB و Wi‑Fi) بدون تصفية\n        const filtered = devices;\n        setAdbDevices(filtered);\n        // حافظ على الاختيار إن كان موجوداً، وإلا اختر أول جهاز\n        const saved = (() => { try { return localStorage.getItem('cashySelectedDevice') || ''; } catch { return ''; } })();\n        const existsExact = saved && filtered.some(d => d.id === saved);\n        if (existsExact) {\n          setSelectedDevice(saved);\n        } else {\n          // محاولة التحويل تلقائياً من USB إلى Wi‑Fi لنفس الجهاز عند فصل الكابل\n          const base = saved ? String(saved).split(':')[0] : '';\n          const wifiCandidate = base\n            ? filtered.find(d => (d.id.startsWith(base) || d.id.includes(base)) && String(d.type).toLowerCase().includes('wifi'))\n            : undefined;\n          if (wifiCandidate?.id) {\n            setSelectedDevice(wifiCandidate.id);\n          } else if (!selectedDevice && filtered[0]?.id) {\n            setSelectedDevice(filtered[0].id);\n          }\n        }\n      });\n    }\n  }, []);\n\n  \n\n  useEffect(() => {\n    try {\n      if (selectedDevice) localStorage.setItem('cashySelectedDevice', selectedDevice);\n    } catch {}\n  }, [selectedDevice]);\n\n  useEffect(() => {\n    try {\n      const key = user?.uid ? `dailyReportsLockEnabled_${user.uid}` : 'dailyReportsLockEnabled';\n      const v = localStorage.getItem(key) ?? localStorage.getItem('dailyReportsLockEnabled');\n      setIsDailyReportsLockEnabled(v === 'true');\n    } catch {}\n  }, [user?.uid]);\n\n  // تحميل حالة طلب الرقم السري عند اختيار المحفظة\n  useEffect(() => {\n    try {\n      setIsWalletSelectionPinEnabled(walletSelectionPinService.isEnabled(user?.uid));\n    } catch {}\n  }, [user?.uid]);\n\n  const handleDailyLockToggle = (next: boolean) => {\n    setPendingDailyLockValue(next);\n    setIsDailyLockTogglePinOpen(true);\n  };\n\n  const handleWalletSelectionPinToggle = (next: boolean) => {\n    setPendingWalletSelectionPinValue(next);\n    setIsWalletSelectionPinToggleOpen(true);\n  };\n\n  const handleDebtsPinToggle = (next: boolean) => {\n    setPendingDebtsPinValue(next);\n    setIsDebtsPinToggleOpen(true);\n  };\n\n  // تحديث بيانات الاشتراك عند تحميل الصفحة\n  useEffect(() => {\n    const refreshSubscriptionData = async () => {\n      try {\n        // نستخدم force=true للتأكد من جلب أحدث حالة للاشتراك عند فتح صفحة الإعدادات\n        await checkSubscriptionStatus(true);\n        console.log('تم تحديث بيانات الاشتراك عند تحميل صفحة البروفايل');\n      } catch (error) {\n        console.error('خطأ في تحديث بيانات الاشتراك:', error);\n      }\n    };\n\n    refreshSubscriptionData();\n  }, [checkSubscriptionStatus]);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        let zero = false;\n        const rawLocalPlan: any = (userSubscription as any)?.subscription?.planType ?? (userSubscription as any)?.planType ?? null;\n        const planLocalStr = typeof rawLocalPlan === 'string' ? rawLocalPlan.toLowerCase() : null;\n        if (rawLocalPlan === SubscriptionPlan.ZERO || planLocalStr === 'zero' || rawLocalPlan === 0 || planLocalStr === '0') {\n          zero = true;\n        } else if (user?.uid) {\n          const remoteSub: any = await getUserSubscription(user.uid);\n          const rawRemotePlan: any = remoteSub?.planType ?? remoteSub?.plan ?? null;\n          const planRemoteStr = typeof rawRemotePlan === 'string' ? rawRemotePlan.toLowerCase() : null;\n          if (rawRemotePlan === SubscriptionPlan.ZERO || planRemoteStr === 'zero' || rawRemotePlan === 0 || planRemoteStr === '0') zero = true;\n        }\n        setIsZeroPlan(zero);\n      } catch { setIsZeroPlan(false); }\n    })();\n  }, [user?.uid, (userSubscription as any)?.subscription?.planType, (userSubscription as any)?.planType]);\n\n  // تحميل معلومات النسخة وروابط التطبيق لعرض رقم النسخة في البروفيل\n  useEffect(() => {\n    const loadDownloads = async () => {\n      try {\n        const data = await getAppDownloads();\n        setAppDownloads(data);\n      } catch (e) {\n        console.warn('تعذّر تحميل معلومات النسخة', e);\n      }\n    };\n    loadDownloads();\n  }, []);\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  const handleAvatarSelect = (avatarId: string) => {\n    setFormData(prev => ({\n      ...prev,\n      avatarId\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      // حفظ أرقام الشرائح محليًا فقط (لكل جهاز)\n      try {\n        const uid = user?.uid || 'default';\n        const s1 = String(formData.sim1Number || '').trim();\n        const s2 = String(formData.sim2Number || '').trim();\n        localStorage.setItem(`sim1Number_${uid}`, s1);\n        localStorage.setItem(`sim2Number_${uid}`, s2);\n        localStorage.setItem('sim1Number', s1);\n        localStorage.setItem('sim2Number', s2);\n        try {\n          const { Preferences } = await import('@capacitor/preferences');\n          await Preferences.set({ key: 'sim1_number', value: s1 });\n          await Preferences.set({ key: 'sim2_number', value: s2 });\n        } catch {}\n      } catch {}\n\n      // تحديث باقي بيانات البروفايل بدون أرقام الشرائح\n      await updateUserProfile({\n        fullName: formData.fullName,\n        phone: formData.phone,\n      });\n\n      // تحديث صورة البروفيل إذا تم تغييرها\n      if (formData.avatarId !== profile?.avatarId) {\n        await updateAvatarId(formData.avatarId);\n      }\n\n      if (user?.uid) {\n        try {\n          await userDataService.updateUserData(user.uid, {\n            telegramChatId: isZeroPlan ? null : (telegramChatId.trim() || null)\n          });\n        } catch {}\n      }\n      await refreshProfile();\n\n      toast({\n        title: \"تم التحديث بنجاح\",\n        description: \"تم حفظ الإعدادات محليًا لهذا الجهاز\",\n      });\n\n      navigate('/user/dashboard', { replace: true });\n    } catch (error) {\n      console.error('Error updating profile:', error);\n      toast({\n        title: \"خطأ في التحديث\",\n        description: \"حدث خطأ أثناء حفظ الإعدادات\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    try {\n      const uid = user?.uid || 'default';\n      const s1 = (localStorage.getItem(`sim1Number_${uid}`) ?? localStorage.getItem('sim1Number') ?? '') || '';\n      const s2 = (localStorage.getItem(`sim2Number_${uid}`) ?? localStorage.getItem('sim2Number') ?? '') || '';\n      setFormData(prev => ({ ...prev, sim1Number: s1, sim2Number: s2 }));\n    } catch {}\n  }, [user?.uid]);\n\n  const handleRefreshSubscription = async () => {\n    setIsRefreshing(true);\n    try {\n      // تحديث البروفايل وبيانات الاشتراك معاً\n      await refreshProfile();\n      await checkSubscriptionStatus();\n      \n      console.log('تم تحديث بيانات الاشتراك يدوياً:', {\n        userSubscription,\n        isSubscriptionActive\n      });\n      \n      toast({\n        title: \"تم تحديث بيانات الاشتراك\",\n        description: \"تم تحديث معلومات اشتراكك بنجاح\",\n      });\n    } catch (error) {\n      console.error('Error refreshing subscription:', error);\n      toast({\n        title: \"خطأ في التحديث\",\n        description: \"حدث خطأ أثناء تحديث بيانات الاشتراك\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsRefreshing(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-[100dvh] p-4 relative bg-gray-50 dark:bg-slate-950 bg-[radial-gradient(140%_140%_at_10%_10%,#f3f4f6_0%,#e5e7eb_45%,#d1d5db_100%)] dark:bg-none\">\n      <div className=\"max-w-2xl mx-auto\">\n        {/* Header */}\n        <div className=\"flex items-center gap-4 mb-6\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => navigate('/user/dashboard', { replace: true })}\n            className=\"flex items-center gap-2 dark:bg-slate-800 dark:text-white dark:border-slate-700\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            العودة\n          </Button>\n          <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">إعدادات البروفيل</h1>\n</div>\n\n        {/* Theme Toggle */}\n        <Card className=\"shadow-lg mb-6 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 dark:text-white\">\n              {isDark ? <Moon className=\"h-5 w-5\" /> : <Sun className=\"h-5 w-5\" />}\n              الوضع الليلي\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center justify-between\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">تفعيل/إلغاء الوضع الليلي للتطبيق</p>\n              <Button\n                type=\"button\"\n                onClick={() => {\n                  const next = !isDark;\n                  setIsDark(next);\n                  const nextTheme = next ? 'dark' : 'light';\n                  try { localStorage.setItem('theme', nextTheme); } catch {}\n                  setTheme(nextTheme);\n                  try {\n                    if (user?.uid) {\n                      setDoc(doc(db, 'userSettings', user.uid), { darkMode: nextTheme }, { merge: true });\n                    }\n                  } catch {}\n                  toast({ title: next ? 'تم تفعيل الوضع الليلي' : 'تم إلغاء الوضع الليلي' });\n                }}\n                className={isDark ? \"px-4 bg-slate-800 text-white hover:bg-slate-700\" : \"px-4 bg-black text-white hover:bg-gray-800\"}\n              >\n                {isDark ? 'إلغاء الوضع الليلي' : 'تفعيل الوضع الليلي'}\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* App Version Badge */}\n        <div className=\"mb-4\">\n          {(() => {\n            const isElectron = typeof window !== 'undefined' && !isAndroidNative && (\n              (window as any).electronAPI ||\n              window.location.protocol === 'file:' ||\n              (typeof navigator !== 'undefined' && navigator.userAgent.toLowerCase().includes('electron'))\n            );\n            const [runtimeDesktopVersion, setRuntimeDesktopVersion] = React.useState<string | undefined>(undefined);\n            React.useEffect(() => {\n              try {\n                const api: any = (window as any).electronAPI;\n                if (api && typeof api.appVersion === 'function') {\n                  api.appVersion().then((v: any) => {\n                    if (typeof v === 'string' && !v.startsWith('err:')) setRuntimeDesktopVersion(v);\n                  }).catch(() => {});\n                }\n              } catch {}\n            }, []);\n            const version = (() => {\n              const localVersion = (import.meta as any)?.env?.VITE_APP_VERSION as string | undefined;\n              const isElectronEnv = typeof window !== 'undefined' && ((window as any).electronAPI || window.location.protocol === 'file:' || (typeof navigator !== 'undefined' && navigator.userAgent.toLowerCase().includes('electron')));\n              if (isElectronEnv && (profile as any)?.desktopInstalledVersion) return (profile as any)?.desktopInstalledVersion;\n              if (isElectronEnv && runtimeDesktopVersion) return runtimeDesktopVersion;\n              if (localVersion) return localVersion;\n              if (!appDownloads && !profile) return undefined;\n              if (isMobile) return (profile as any)?.androidInstalledVersion || (profile as any)?.lastAckAndroidVersion || appDownloads?.androidVersion || appDownloads?.pcVersion;\n              if (isElectronEnv) return appDownloads?.pcVersion || appDownloads?.androidVersion;\n              return appDownloads?.pcVersion || appDownloads?.androidVersion;\n            })();\n            const label = isMobile ? 'نسخة التطبيق (موبايل)' : 'نسخة التطبيق (كمبيوتر)';\n            return (\n              <div className=\"inline-flex items-center gap-2 rounded-lg border border-indigo-200 bg-indigo-50 px-3 py-2 text-sm text-indigo-700\">\n                <span className=\"font-semibold\">{label}:</span>\n                <span className=\"rounded-md bg-white px-2 py-1 border border-indigo-200\">\n                  {version ? `v${version}` : 'غير محدد'}\n                </span>\n              </div>\n            );\n          })()}\n        </div>\n\n        {/* Profile Settings Card */}\n      <Card className=\"shadow-lg mb-6 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 dark:text-white\">\n              <User className=\"h-5 w-5\" />\n              تحديث بيانات البروفيل\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\n              {/* Avatar Selection */}\n              <div className=\"space-y-2\">\n                <Label className=\"dark:text-white\">صورة البروفيل</Label>\n                <div className=\"flex justify-center\">\n                  <AvatarSelector\n                    selectedAvatarId={formData.avatarId}\n                    onAvatarSelect={handleAvatarSelect}\n                  />\n                </div>\n              </div>\n\n              {/* Full Name */}\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"fullName\">الاسم الكامل</Label>\n                <Input\n                  id=\"fullName\"\n                  name=\"fullName\"\n                  type=\"text\"\n                  value={formData.fullName}\n                  onChange={handleInputChange}\n                  placeholder=\"أدخل اسمك الكامل\"\n                  className=\"text-right\"\n                />\n              </div>\n\n              {/* Phone */}\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"phone\">رقم الهاتف</Label>\n              <Input\n                id=\"phone\"\n                name=\"phone\"\n                type=\"tel\"\n                value={formData.phone}\n                onChange={handleInputChange}\n                placeholder=\"أدخل رقم هاتفك\"\n                className=\"text-right\"\n              />\n            </div>\n\n            <>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"sim1Number\">SIM 1</Label>\n                <Input\n                  id=\"sim1Number\"\n                  name=\"sim1Number\"\n                  type=\"tel\"\n                  value={formData.sim1Number}\n                  onChange={handleInputChange}\n                  placeholder=\"أدخل رقم الشريحة الأولى\"\n                  className=\"text-right\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"sim2Number\">SIM 2</Label>\n                <Input\n                  id=\"sim2Number\"\n                  name=\"sim2Number\"\n                  type=\"tel\"\n                  value={formData.sim2Number}\n                  onChange={handleInputChange}\n                  placeholder=\"أدخل رقم الشريحة الثانية (اختياري)\"\n                  className=\"text-right\"\n                />\n              </div>\n            </>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"telegramChatId\">Telegram Chat ID</Label>\n              <Input\n                id=\"telegramChatId\"\n                name=\"telegramChatId\"\n                type=\"text\"\n                value={telegramChatId}\n                onChange={(e) => { if (!isZeroPlan) setTelegramChatId(e.target.value); }}\n                disabled={isZeroPlan}\n                readOnly={isZeroPlan}\n                placeholder=\"أدخل Chat ID\"\n                className=\"text-right\"\n              />\n              \n              \n            </div>\n\n              {/* Device Selection */}\n              <div className=\"space-y-2\">\n                <Label>📱 اختر الجهاز المتصل</Label>\n              <select\n                value={selectedDevice}\n                onChange={(e) => setSelectedDevice(e.target.value)}\n                className=\"border rounded-md p-2 w-full text-right\"\n              >\n                <option value=\"\">— اختر جهاز —</option>\n                {adbDevices.map((d, i) => (\n                  <option key={i} value={d.id}>\n                    {(d.model || d.name || 'Android')} ({d.type || 'USB/Wi‑Fi'}) — {d.id}\n                  </option>\n                ))}\n              </select>\n              {SHOW_DEVICE_UTILS && (\n                <div className=\"flex gap-2\">\n                  <Button\n                    type=\"button\"\n                    variant=\"default\"\n                    onClick={async () => {\n                      try {\n                        if (!selectedDevice) {\n                          setDeviceStatus('❌ اختر جهاز أولاً');\n                          return;\n                        }\n                        const api: any = (window as any).electronAPI;\n                        if (!api || typeof api.sendUssd !== 'function') {\n                          setDeviceStatus('❌ هذه الميزة متاحة داخل تطبيق سطح المكتب فقط');\n                          return;\n                        }\n                        const testCode = getUssdCode('01000000000', 10) || '*9*7*01000000000*10#';\n                        try {\n                          await api.sendUssd(selectedDevice, testCode);\n                        } catch (e1: any) {\n                          const maybeIp = selectedDevice.includes(':') ? selectedDevice.split(':').slice(0,2).join(':') : '';\n                          if (maybeIp && typeof api.connectWifi === 'function') {\n                            await api.connectWifi(maybeIp);\n                            await api.sendUssd(selectedDevice, testCode);\n                          } else {\n                            throw e1;\n                          }\n                        }\n                        setDeviceStatus(`✅ تم إرسال كود اختبار إلى ${selectedDevice}`);\n                      } catch (err) {\n                        console.error('USSD test error:', err);\n                        setDeviceStatus('❌ حدث خطأ أثناء الإرسال');\n                      }\n                    }}\n                  >\n                    📤 إرسال كود اختبار\n                  </Button>\n                  <Input\n                    value={wifiIp}\n                    onChange={(e) => setWifiIp(e.target.value)}\n                    placeholder=\"IP:PORT — مثال: 192.168.1.8:5555\"\n                    className=\"flex-1 text-right\"\n                  />\n                  <Button type=\"button\" variant=\"outline\" onClick={handleConnectWifi}>\n                    🌐 اتصال عبر Wi‑Fi\n                  </Button>\n                </div>\n              )}\n              {/* 🔹 نموذج التحويل عبر USSD وفتح نافذة PIN */}\n              {SHOW_TRANSFER_UI && (\n              <div className=\"mt-4 p-3 bg-gray-50 rounded-lg border space-y-3\">\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <Input\n                      value={receiver}\n                      onChange={(e) => setReceiver(e.target.value)}\n                      placeholder=\"رقم المُستلم\"\n                      className=\"text-right flex-1\"\n                    />\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Input\n                      value={amount}\n                      onChange={(e) => setAmount(e.target.value)}\n                      placeholder=\"المبلغ\"\n                      className=\"text-right flex-1\"\n                    />\n                  </div>\n                  <Button\n                    type=\"button\"\n                    className=\"w-full flex items-center gap-2\"\n                    onClick={async () => {\n                      try {\n                        setTransferStatus('');\n                        const receiverDigits = String(receiver || '').replace(/\\D/g, '');\n                        const amountInt = Math.max(1, Math.round(Number(String(amount || '0').replace(/\\D/g, '')) || 0));\n                        const senderPhone = getSelectedWalletPhone();\n                        if (!senderPhone) {\n                          setTransferStatus('❌ يرجى اختيار محفظة المُرسل أولاً');\n                          return;\n                        }\n                        const code = getUssdCodeBySender(senderPhone, receiverDigits, amountInt);\n                        if (!code) {\n                          setTransferStatus('❌ الشبكة غير مدعومة أو الرقم غير صحيح');\n                          return;\n                        }\n                        const api: any = (window as any).electronAPI;\n                        if (api && typeof api.sendUssd === 'function' && selectedDevice) {\n                          try { /* عدم انتظار تحديث الأجهزة لتجنب التهنيج */ } catch {}\n                          // سطح المكتب: إرسال عبر ADB مباشرة مع اختيار الشريحة تلقائيًا\n                          try {\n                            const pick = typeof api.pickSimAutomatically === 'function'\n                              ? await api.pickSimAutomatically(selectedDevice, senderPhone)\n                              : { deviceId: selectedDevice, slot: 0 };\n                            const decoratedId = `${pick.deviceId}:sim${pick.slot}`;\n                            await api.sendUssd(decoratedId, code);\n                          } catch (e1: any) {\n                            try {\n                              // رجوع للطريقة التقليدية إذا فشل اختيار الشريحة\n                              await api.sendUssd(selectedDevice, code);\n                            } catch (e2: any) {\n                              // محاولة اتصال تلقائي عبر Wi‑Fi ثم إعادة الإرسال إذا كانت الهوية على شكل IP:PORT\n                              const maybeIp = selectedDevice.includes(':') ? selectedDevice.split(':').slice(0,2).join(':') : '';\n                              if (maybeIp && typeof api.connectWifi === 'function') {\n                                try {\n                                  await api.connectWifi(maybeIp);\n                                  await api.sendUssd(selectedDevice, code);\n                                } catch (e3: any) {\n                                  throw e3;\n                                }\n                              } else {\n                                throw e2;\n                              }\n                            }\n                          }\n                          setTransferStatus(`✅ تم إرسال كود التحويل: ${code}`);\n                          setPinOpen(true);\n                        } else {\n                          // الموبايل: إرسال الكود مباشرة من الجهاز عبر USSD\n                          openUssdDeepLink(code);\n                          setTransferStatus(`✅ تم إرسال كود التحويل مباشرة: ${code}`);\n                          setPinOpen(true);\n                        }\n                      } catch (err: any) {\n                        console.error('USSD send error:', err);\n                        setTransferStatus(`❌ فشل الإرسال: ${err?.message || String(err)}`);\n                        // فتح نصيحة سريعة: تأكد من تفعيل Wireless debugging واتصال adb connect\n                        setDeviceStatus('❌ الجهاز غير متصل. جرّب الضغط على \"اتصال عبر Wi‑Fi\" أو فعّل Wireless debugging ثم قم بالاقتران عبر ADB.');\n                      }\n                    }}\n                  >\n                    <Send className=\"h-4 w-4\" />\n                    إرسال التحويل\n                  </Button>\n                </div>\n                {transferStatus && (\n                  <p className=\"text-center text-sm mt-2\">{transferStatus}</p>\n                )}\n                <div className=\"text-xs text-gray-500 text-right\">\n                  بعد إرسال كود التحويل، ستظهر نافذة لإدخال الرقم السري ويتم إرساله للهاتف تلقائياً.\n                </div>\n              </div>\n              )}\n              {/* 🔹 إعدادات الجسر (ngrok) للموبايل */}\n              {SHOW_TRANSFER_UI && (\n              <div className=\"mt-4 p-3 bg-white rounded-lg border space-y-3\">\n                <p className=\"text-sm text-gray-600 text-right\">\n                  لتفعيل الإرسال من الموبايل عبر الواي فاي: أدخل رابط الجسر (ngrok) ومعرّف الجهاز، ثم احفظ.\n                </p>\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-2\">\n                  <Input\n                    value={bridgeLink}\n                    onChange={(e) => setBridgeLink(e.target.value)}\n                    placeholder=\"رابط الجسر (مثال: https://xxxx.ngrok-free.app)\"\n                    className=\"text-right\"\n                  />\n                  <Input\n                    value={bridgeDeviceId}\n                    onChange={(e) => setBridgeDeviceId(e.target.value)}\n                    placeholder=\"معرّف الجهاز (اختياري)\"\n                    className=\"text-right\"\n                  />\n                  <Button\n                    type=\"button\"\n                    variant=\"default\"\n                    onClick={async () => {\n                      try {\n                        await updateUserProfile({ bridgeLink: bridgeLink || '', bridgeDeviceId: bridgeDeviceId || '' });\n                        toast({ title: 'تم الحفظ', description: 'تم حفظ إعدادات الجسر بنجاح' });\n                      } catch (err: any) {\n                        toast({ title: 'فشل الحفظ', description: err?.message || String(err), variant: 'destructive' });\n                      }\n                    }}\n                  >\n                    حفظ إعدادات الجسر\n                  </Button>\n                </div>\n              </div>\n              )}\n              {SHOW_DEVICE_UTILS && deviceStatus && (\n                <p className=\"text-center text-sm mt-3\">{deviceStatus}</p>\n              )}\n\n              </div>\n\n              {/* Email (read-only) */}\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"email\">البريد الإلكتروني</Label>\n                <Input\n                  id=\"email\"\n                  name=\"email\"\n                  type=\"email\"\n                  value={user?.email || ''}\n                  readOnly\n                  placeholder=\"البريد المرتبط بحسابك\"\n                  className=\"text-right\"\n                />\n              </div>\n\n              {/* Submit Button */}\n              <Button\n                type=\"submit\"\n                disabled={loading}\n                className=\"w-full h-12 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-medium transition-all duration-300\"\n              >\n                {loading ? (\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\"></div>\n                    جاري الحفظ...\n                  </div>\n                ) : (\n                  <div className=\"flex items-center gap-2\">\n                    <Save className=\"h-4 w-4\" />\n                    حفظ التغييرات\n                  </div>\n                )}\n              </Button>\n            </form>\n          </CardContent>\n        </Card>\n\n        \n\n        {/* PIN Management Card */}\n      <Card className=\"shadow-lg mb-6 bg-white border border-gray-200\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Shield className=\"h-5 w-5\" />\n              إدارة الأرقام السرية\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h3 className=\"font-medium text-gray-800 mb-1\">تغيير الأرقام السرية</h3>\n                <p className=\"text-sm text-gray-600\">إدارة أرقامك السرية للنظام والمحفظة والأرباح</p>\n              </div>\n              <MasterPinManagement />\n            </div>\n\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between\">\n              <div>\n                <h4 className=\"font-medium text-gray-800 mb-1\">قفل تقارير اليوم</h4>\n                <p className=\"text-sm text-gray-600\">عند التفعيل، يتم تمويه تقارير اليوم ويتطلب الرقم السري الرئيسي لعرضها</p>\n              </div>\n              <Switch\n                checked={isDailyReportsLockEnabled}\n                onCheckedChange={handleDailyLockToggle}\n                className=\"data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-red-500\"\n              />\n            </div>\n\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between\">\n              <div>\n                <h4 className=\"font-medium text-gray-800 mb-1\">تفعيل التسجيل التلقائي عبر الكابل</h4>\n                <p className=\"text-sm text-gray-600\">عند التفعيل، سيتم قراءة رسائل فودافون كاش تلقائياً من الموبايل المتصل (USB/Wi-Fi)</p>\n              </div>\n              <Switch\n                checked={isAdbSmsReadingEnabled}\n                onCheckedChange={handleAdbSmsReadingToggle}\n                className=\"data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-red-500\"\n              />\n            </div>\n\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between\">\n              <div>\n                <h4 className=\"font-medium text-gray-800 mb-1\">طلب الرقم السري عند اختيار المحفظة</h4>\n                <p className=\"text-sm text-gray-600\">عند التفعيل، سيُطلب الرقم السري الرئيسي لتأكيد تغيير المحفظة</p>\n              </div>\n              <Switch\n                checked={isWalletSelectionPinEnabled}\n                onCheckedChange={handleWalletSelectionPinToggle}\n                className=\"data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-red-500\"\n              />\n            </div>\n\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between\">\n              <div>\n                <h4 className=\"font-medium text-gray-800 mb-1\">طلب الرقم السري عند فتح الديون</h4>\n                <p className=\"text-sm text-gray-600\">عند التفعيل، سيُطلب الرقم السري الرئيسي قبل فتح نافذة الديون</p>\n              </div>\n              <Switch\n                checked={isDebtsPinRequired}\n                onCheckedChange={handleDebtsPinToggle}\n                className=\"data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-red-500\"\n              />\n            </div>\n\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between\">\n              <div>\n                <h4 className=\"font-medium text-gray-800 mb-1\">إظهار ملاحظة الإيصال</h4>\n                <p className=\"text-sm text-gray-600\">عند التفعيل، ستظهر الملاحظة داخل الإيصال والطباعة عندما تكون موجودة.</p>\n              </div>\n              <Switch\n                checked={isReceiptNoteEnabled}\n                onCheckedChange={handleReceiptNoteToggle}\n                className=\"data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-red-500\"\n              />\n            </div>\n\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between\">\n              <div>\n                <h4 className=\"font-medium text-gray-800 mb-1\">إظهار خانة اسم الراسل في السحب</h4>\n                <p className=\"text-sm text-gray-600\">يمكنك إخفاء أو إظهار خانة كتابة اسم الراسل في نموذج السحب</p>\n              </div>\n              <Switch\n                checked={isWithdrawSenderNameInputEnabled}\n                onCheckedChange={handleWithdrawSenderNameInputToggle}\n                className=\"data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-red-500\"\n              />\n            </div>\n\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between\">\n              <div>\n                <h4 className=\"font-medium text-gray-800 mb-1\">قراءة رسائل SMS وعرض النافذة</h4>\n                <p className=\"text-sm text-gray-600\">عند التعطيل، لن تتم قراءة الرسائل ولن تظهر النافذة المنبثقة</p>\n              </div>\n              <Switch\n                checked={isSmsReadingEnabled}\n                onCheckedChange={handleSmsReadingToggle}\n                className=\"data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-red-500\"\n              />\n            </div>\n\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between\">\n              <div>\n                <h4 className=\"font-medium text-gray-800 mb-1\">تسجيل تلقائي بدون نافذة منبثقة</h4>\n                <p className=\"text-sm text-gray-600\">عند التفعيل، سيتم حفظ المعاملة فور وصول الرسالة بدون عرض النافذة</p>\n              </div>\n              <Switch\n                checked={isSmsAutoRegisterEnabled}\n                onCheckedChange={handleSmsAutoRegisterToggle}\n                className=\"data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-red-500\"\n              />\n            </div>\n\n            {/* زر تفعيل الإشعارات المخفية (Android Only) */}\n            {isAndroidNative && (\n            <>\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between\">\n              <div>\n                <h4 className=\"font-medium text-gray-800 mb-1\">صلاحية الوصول للإشعارات</h4>\n                <p className=\"text-sm text-gray-600\">السماح للتطبيق بقراءة الإشعارات لتسجيل المعاملات تلقائياً</p>\n              </div>\n              <Button\n                type=\"button\"\n                variant={notificationPermissionEnabled ? \"outline\" : \"default\"}\n                className={notificationPermissionEnabled ? \"border-green-500 text-green-600 hover:text-green-700 hover:bg-green-50\" : \"bg-blue-600 hover:bg-blue-700 text-white\"}\n                onClick={() => {\n                    try { window.location.href = \"cashy://openNotificationSettings\"; } catch {}\n                }}\n              >\n                {notificationPermissionEnabled ? (\n                    <>\n                        <CheckCircle className=\"w-4 h-4 mr-2\" />\n                        مفعل\n                    </>\n                ) : (\n                    \"تفعيل الآن\"\n                )}\n              </Button>\n            </div>\n\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border flex items-center justify-between\">\n              <div>\n                <h4 className=\"font-medium text-gray-800 mb-1\">صلاحية قراءة الرسائل (SMS)</h4>\n                <p className=\"text-sm text-gray-600\">مطلوب لاستقبال وتسجيل المعاملات المالية تلقائياً</p>\n              </div>\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n                onClick={() => {\n                    try { window.location.href = \"cashy://requestPerms\"; } catch {}\n                }}\n              >\n                تفعيل الأذونات\n              </Button>\n            </div>\n            </>\n            )}\n\n            <MasterPinDialog\n              open={isDailyLockTogglePinOpen}\n              onOpenChange={setIsDailyLockTogglePinOpen}\n              mode=\"verify\"\n              title=\"تأكيد التغيير\"\n              description=\"أدخل الرقم السري الرئيسي لتفعيل أو إلغاء قفل تقارير اليوم\"\n              onSuccess={() => {\n                if (pendingDailyLockValue !== null) {\n                  const nextVal = pendingDailyLockValue;\n                  setIsDailyReportsLockEnabled(nextVal);\n                  try {\n                    localStorage.setItem('dailyReportsLockEnabled', nextVal ? 'true' : 'false');\n                    if (user?.uid) {\n                      localStorage.setItem(`dailyReportsLockEnabled_${user.uid}`, nextVal ? 'true' : 'false');\n                    }\n                  } catch {}\n                  toast({\n                    title: nextVal ? 'تم تفعيل قفل تقارير اليوم' : 'تم إلغاء قفل تقارير اليوم',\n                    description: nextVal ? 'ستظهر تقارير اليوم بتمويه وتتطلب الرقم السري لعرضها.' : 'ستظهر تقارير اليوم بدون تمويه وبدون رقم سري.',\n                  });\n                }\n                setIsDailyLockTogglePinOpen(false);\n                setPendingDailyLockValue(null);\n              }}\n            />\n\n            <MasterPinDialog\n              open={isWalletSelectionPinToggleOpen}\n              onOpenChange={setIsWalletSelectionPinToggleOpen}\n              mode=\"verify\"\n              title=\"تأكيد طلب الرقم السري عند اختيار المحفظة\"\n              description=\"أدخل الرقم السري الرئيسي لتفعيل أو إلغاء طلب الرقم السري عند تغيير المحفظة\"\n              onSuccess={() => {\n                if (pendingWalletSelectionPinValue !== null) {\n                  const nextVal = pendingWalletSelectionPinValue;\n                  setIsWalletSelectionPinEnabled(nextVal);\n                  try {\n                    walletSelectionPinService.setEnabled(nextVal, user?.uid);\n                  } catch {}\n                  toast({\n                    title: nextVal ? 'تم تفعيل طلب الرقم السري' : 'تم إلغاء طلب الرقم السري',\n                    description: nextVal ? 'سيُطلب الرقم السري الرئيسي عند تغيير المحفظة.' : 'يمكن تغيير المحفظة بدون طلب الرقم السري.',\n                  });\n                }\n                setIsWalletSelectionPinToggleOpen(false);\n                setPendingWalletSelectionPinValue(null);\n              }}\n            />\n\n            <MasterPinDialog\n              open={isDebtsPinToggleOpen}\n              onOpenChange={setIsDebtsPinToggleOpen}\n              mode=\"verify\"\n              title=\"تأكيد طلب الرقم السري عند فتح الديون\"\n              description=\"أدخل الرقم السري الرئيسي لتفعيل أو إلغاء طلب الرقم السري عند فتح الديون\"\n              onSuccess={async () => {\n                if (pendingDebtsPinValue !== null) {\n                  const nextVal = pendingDebtsPinValue;\n                  setIsDebtsPinRequired(nextVal);\n                  try {\n                    const key = user?.uid ? `debtsPinRequired_${user?.uid}` : 'debtsPinRequired';\n                    localStorage.setItem(key, String(nextVal));\n                    localStorage.setItem('debtsPinRequired', String(nextVal));\n                    if (user?.uid) await userDataService.updateUserData(user.uid, { debtsPinRequired: nextVal });\n                  } catch {}\n                  toast({\n                    title: nextVal ? 'تم تفعيل طلب الرقم السري للديون' : 'تم إلغاء طلب الرقم السري للديون',\n                    description: nextVal ? 'سيُطلب الرقم السري الرئيسي قبل فتح نافذة الديون.' : 'يمكن فتح نافذة الديون بدون طلب الرقم السري.',\n                  });\n                }\n                setPendingDebtsPinValue(null);\n                setIsDebtsPinToggleOpen(false);\n              }}\n            />\n          </CardContent>\n        </Card>\n\n        {/* Font Size Settings Card - Visible on جميع المنصات */}\n      <Card className=\"shadow-lg mb-6 bg-white border border-gray-200\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Type className=\"h-5 w-5\" />\n                حجم الخط\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                <div>\n                  <h3 className=\"font-medium text-gray-800 mb-1\">تخصيص حجم الخط</h3>\n                  <p className=\"text-sm text-gray-600\">اختر حجم الخط المناسب لك لكل من الموبايل وسطح المكتب</p>\n                </div>\n                \n                <div className=\"flex items-center justify-between bg-gray-50 p-4 rounded-lg\">\n                  <div className=\"flex items-center gap-3\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => setFontSize('small')}\n                      className={`flex items-center gap-2 ${fontSize === 'small' ? 'bg-blue-100 border-blue-300 text-blue-700' : ''}`}\n                    >\n                      <Minus className=\"h-4 w-4\" />\n                      صغير\n                    </Button>\n                    \n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => setFontSize('medium')}\n                      className={`flex items-center gap-2 ${fontSize === 'medium' ? 'bg-blue-100 border-blue-300 text-blue-700' : ''}`}\n                    >\n                      <Type className=\"h-4 w-4\" />\n                      متوسط\n                    </Button>\n                    \n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => setFontSize('large')}\n                      className={`flex items-center gap-2 ${fontSize === 'large' ? 'bg-blue-100 border-blue-300 text-blue-700' : ''}`}\n                    >\n                      <Plus className=\"h-4 w-4\" />\n                      كبير\n                    </Button>\n                  </div>\n                </div>\n                \n                <div className=\"text-sm text-gray-500 bg-blue-50 p-3 rounded-lg border border-blue-200\">\n                  <p>💡 تؤثر هذه الميزة على جميع النصوص في التطبيق مع الحفاظ على تناسق الأيقونات، وتعمل على الموبايل وسطح المكتب.</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n        {/* Reseller Management */}\n        <ResellerManagement />\n\n        {/* Subscription Information Card */}\n      <Card className=\"shadow-lg bg-white border border-gray-200\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <Crown className=\"h-5 w-5 text-yellow-500\" />\n                معلومات الاشتراك\n              </div>\n              <Button\n                onClick={handleRefreshSubscription}\n                disabled={isRefreshing}\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"flex items-center gap-2\"\n              >\n                <RefreshCw className={`w-4 h-4 ${isRefreshing ? 'animate-spin' : ''}`} />\n                {isRefreshing ? 'جاري التحديث...' : 'تحديث'}\n              </Button>\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            {/* Subscription Status */}\n            {isSubscriptionActive && userSubscription?.subscription ? (\n              <div>\n                <div className=\"p-6 rounded-lg bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200\">\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <div className=\"flex items-center gap-3\">\n                      <Crown className=\"h-6 w-6 text-green-500\" />\n                      <h3 className=\"text-lg font-semibold text-gray-800\">حالة الاشتراك</h3>\n                    </div>\n                    <div className=\"flex items-center gap-2 bg-green-100 px-3 py-1 rounded-full\">\n                      <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n                      <span className=\"text-green-700 font-medium text-sm\">نشط</span>\n                    </div>\n                  </div>\n                  \n                  {/* Plan Type Display */}\n                  <div className=\"mb-4 p-4 bg-white/70 rounded-lg border border-green-100\">\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-600 font-medium\">نوع الباقة:</span>\n                      <span className={`font-bold text-lg ${getSubscriptionStatusColor(userSubscription.subscription)}`}>\n                        {getPlanDisplayName(userSubscription.subscription.planType)}\n                      </span>\n                    </div>\n                  </div>\n                  \n                  <div className=\"text-lg font-medium text-gray-700 leading-relaxed\">\n                    {userSubscription.subscription.planType === 'monthly' && (\n                      <p>\n                        اشتراكك الشهري يبدأ يوم <span className=\"font-bold text-green-600\">{formatDate(userSubscription.subscription.startDate)}</span> وينتهي يوم <span className=\"font-bold text-green-600\">{formatDate(userSubscription.subscription.endDate)}</span>\n                      </p>\n                    )}\n                    \n                    {userSubscription.subscription.planType === 'quarterly' && (\n                      <p>\n                        اشتراكك ربع السنوي يبدأ يوم <span className=\"font-bold text-green-600\">{formatDate(userSubscription.subscription.startDate)}</span> وينتهي يوم <span className=\"font-bold text-green-600\">{formatDate(userSubscription.subscription.endDate)}</span>\n                      </p>\n                    )}\n                    \n                    {userSubscription.subscription.planType === 'yearly' && (\n                      <p>\n                        اشتراكك السنوي يبدأ يوم <span className=\"font-bold text-green-600\">{formatDate(userSubscription.subscription.startDate)}</span> وينتهي يوم <span className=\"font-bold text-green-600\">{formatDate(userSubscription.subscription.endDate)}</span>\n                      </p>\n                    )}\n                    \n                    {userSubscription.subscription.planType === 'lifetime' && (\n                      <p className=\"text-yellow-600 font-bold\">\n                        🎉 اشتراكك مدى الحياة - لا ينتهي أبداً\n                      </p>\n                    )}\n                  </div>\n\n                  {/* Additional Info for Active Subscriptions */}\n                  {isSubscriptionActive && userSubscription.subscription.planType !== 'lifetime' && userSubscription.subscription.planType !== 'zero' && (\n                    <div className=\"mt-4 p-3 bg-white/50 rounded-lg border border-green-100\">\n                      <p className=\"text-sm text-gray-600\">\n                        متبقي <span className=\"font-semibold text-green-600\">{getDaysRemaining(userSubscription.subscription)}</span> يوم على انتهاء الاشتراك\n                      </p>\n                    </div>\n                  )}\n                </div>\n              </div>\n            ) : (\n              <div className=\"text-center py-8\">\n                <div className=\"p-6 rounded-lg bg-gradient-to-r from-red-50 to-orange-50 border border-red-200\">\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <div className=\"flex items-center gap-3\">\n                      <Crown className=\"h-6 w-6 text-red-500\" />\n                      <h3 className=\"text-lg font-semibold text-gray-800\">حالة الاشتراك</h3>\n                    </div>\n                    <div className=\"flex items-center gap-2 bg-red-100 px-3 py-1 rounded-full\">\n                      <div className=\"w-2 h-2 bg-red-500 rounded-full\"></div>\n                      <span className=\"text-red-700 font-medium text-sm\">غير نشط</span>\n                    </div>\n                  </div>\n                  \n                  <div className=\"mb-4 p-4 bg-white/70 rounded-lg border border-red-100\">\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-600 font-medium\">نوع الباقة:</span>\n                      <span className=\"font-bold text-lg text-gray-500\">\n                        لا يوجد اشتراك\n                      </span>\n                    </div>\n                  </div>\n                  \n                  <p className=\"text-gray-600 text-lg font-medium\">لا يوجد اشتراك مفعل</p>\n                  <p className=\"text-gray-500 text-sm mt-2\">تواصل مع الإدارة لتفعيل اشتراكك</p>\n                  <div className=\"mt-3 bg-blue-50 p-4 rounded-lg border border-blue-200\">\n                    <div className=\"flex items-center justify-center gap-2\">\n                      <span className=\"text-sm font-semibold text-blue-700\">البريد الإلكتروني للإدارة:</span>\n                      <a\n                        href=\"mailto:info@cashy-link.com\"\n                        className=\"text-sm font-bold text-blue-600 hover:text-blue-700 underline\"\n                      >\n                        info@cashy-link.com\n                      </a>\n                    </div>\n                    <p className=\"text-xs text-blue-600 mt-2 text-center\">يمكنك مراسلتنا لطلب التفعيل أو الاستفسار</p>\n                  </div>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n        {/* Developer Info Card */}\n        <Card className=\"shadow-lg mt-6 bg-gradient-to-br from-indigo-50 to-blue-50 border border-blue-100 dark:bg-slate-900 dark:border-slate-800\">\n          <CardContent className=\"pt-6 text-center\">\n             <div className=\"mb-2 flex justify-center\">\n                <div className=\"p-3 bg-blue-100 rounded-full dark:bg-slate-800\">\n                  <Code className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n                </div>\n             </div>\n             <h3 className=\"text-xl font-bold text-gray-900 mb-3 dark:text-white\">معلومات المطور</h3>\n             <div className=\"space-y-3\">\n               <p className=\"text-lg font-bold bg-gradient-to-r from-blue-700 to-indigo-700 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent leading-relaxed\">\n                 تم تطوير الابلكيشن بالكامل بواسطة م/أحمد عبد الرحيم محمد\n               </p>\n               <div className=\"flex flex-col items-center gap-1\">\n                 <p className=\"text-base font-semibold text-gray-800 dark:text-gray-200\">\n                   رقم خدمة العملاء الوحيد لنا\n                 </p>\n                 <a href=\"tel:01000392539\" className=\"text-xl font-black text-blue-600 dark:text-blue-400 tracking-wider hover:underline\" dir=\"ltr\">\n                   01000392539\n                 </a>\n               </div>\n               <p className=\"text-sm text-red-600 dark:text-red-400 font-bold bg-red-50 dark:bg-red-900/20 py-1 px-3 rounded-full inline-block\">\n                 ليس لنا اي ارقام اخري\n               </p>\n             </div>\n          </CardContent>\n        </Card>\n\n      </div>\n      <div className=\"mt-6 flex items-center justify-center\">\n        <Button variant=\"outline\" onClick={() => navigate('/privacy-policy')}>سياسة الخصوصية</Button>\n      </div>\n      {/* 🔐 نافذة إدخال الرقم السري بعد إرسال كود التحويل */}\n      <PinModal\n        open={pinOpen}\n        onClose={() => setPinOpen(false)}\n        deviceId={selectedDevice || null}\n        onSubmit={async (deviceId, pin) => {\n          try {\n            const api: any = (window as any).electronAPI;\n            const pinDigits = String(pin || '').replace(/\\D/g, '');\n            if (api && typeof api.enterPin === 'function' && selectedDevice) {\n              await api.enterPin(selectedDevice, pinDigits);\n              setPinOpen(false);\n            } else {\n              // الموبايل: إرسال كود PIN مباشرة عبر USSD\n              const receiverDigits = String(receiver || '').replace(/\\D/g, '');\n              const amountInt = Math.max(1, Math.round(Number(String(amount || '0').replace(/\\D/g, '')) || 0));\n              const pinCode = getUssdCodeWithPin(receiverDigits, amountInt, pinDigits);\n              if (!pinCode) {\n                toast({ title: 'رقم غير مدعوم', description: 'تحقق من بداية الرقم 010/011/012/015', variant: 'destructive' });\n                return;\n              }\n              openUssdDeepLink(pinCode);\n              setPinOpen(false);\n            }\n          } catch (err: any) {\n            console.error('PIN enter error:', err);\n            toast({ title: 'فشل إدخال الرقم السري', description: err?.message || String(err), variant: 'destructive' });\n          }\n        }}\n      />\n    </div>\n  );\n};\n\nexport default ProfileSettingsPage;\n"],"file":"assets/ProfileSettingsPage-BZg2Qs-H.js"}