import{O as Z,r as x,u as q,c as Y,j as e,Y as X,Z as G,_ as J,$ as K,I as N,B as f,S as V,ax as se,au as I,a as te,av as P}from"./index-TGIFU2Cb.js";import{C as z,a as re,b as ae,d as B}from"./card-Dhy3zl0F.js";import{B as ne}from"./badge-Cbt1k2jo.js";import{T as de,P as E}from"./progress-vkiRTi3L.js";import{L as j}from"./label-BAt1qffg.js";import{S as oe,a as ce,b as me,c as le,d as M}from"./select-bmG6MsJJ.js";import{walletDailyLimitsService as H}from"./walletDailyLimitsService-DJsLEjBQ.js";import{L as he}from"./dropdown-menu-D0kqDXOF.js";import{S as xe}from"./square-pen-CtWSoR4G.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=Z("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=Z("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);function fe({open:p,onOpenChange:b,wallet:s,onSuccess:D}){const[t,o]=x.useState({provider:(s==null?void 0:s.provider)||"",msisdn:(s==null?void 0:s.msisdn)||"",dailyLimit:(s==null?void 0:s.dailyLimit)||0,monthlyLimit:(s==null?void 0:s.monthlyLimit)||0,transferLimit:(s==null?void 0:s.transferLimit)||2e5,withdrawLimit:(s==null?void 0:s.withdrawLimit)||2e5,dailyTransferLimit:(s==null?void 0:s.dailyTransferLimit)||6e4,dailyWithdrawLimit:(s==null?void 0:s.dailyWithdrawLimit)||1e5,monthlyTransferLimit:(s==null?void 0:s.monthlyTransferLimit)||(s==null?void 0:s.transferLimit)||2e5,monthlyWithdrawLimit:(s==null?void 0:s.monthlyWithdrawLimit)||(s==null?void 0:s.withdrawLimit)||2e5,ownerName:(s==null?void 0:s.ownerName)||"",nationalId:(s==null?void 0:s.nationalId)||""}),[m,W]=x.useState(!1),[F,g]=x.useState(null),{user:l,userSubscription:y}=q(),{toast:S}=Y();x.useEffect(()=>{p&&s?(o({provider:s.provider||"",msisdn:s.msisdn||"",dailyLimit:s.dailyLimit??0,monthlyLimit:s.monthlyLimit??0,transferLimit:s.transferLimit??2e5,withdrawLimit:s.withdrawLimit??2e5,dailyTransferLimit:s.dailyTransferLimit??6e4,dailyWithdrawLimit:s.dailyWithdrawLimit??1e5,monthlyTransferLimit:s.monthlyTransferLimit??s.transferLimit??2e5,monthlyWithdrawLimit:s.monthlyWithdrawLimit??s.withdrawLimit??2e5,ownerName:s.ownerName||"",nationalId:s.nationalId||""}),g(null)):p&&!s&&(o({provider:"",msisdn:"",dailyLimit:0,monthlyLimit:0,transferLimit:2e5,withdrawLimit:2e5,dailyTransferLimit:6e4,dailyWithdrawLimit:1e5,monthlyTransferLimit:2e5,monthlyWithdrawLimit:2e5,ownerName:"",nationalId:""}),g(null))},[s,p]);const T=(a,u)=>{const r=a.slice(0,3);return u==="vodafone_cash"&&r==="010"||u==="orange_cash"&&r==="012"||u==="etisalat_cash"&&r==="011"||u==="instapay"&&r==="015"},k=a=>{switch(a){case"INVALID_MSISDN":return"رقم المحفظة غير صالح.";case"PROVIDER_MISMATCH":return"المزوّد لا يطابق مقدمة الرقم.";case"ALREADY_EXISTS":return"المحفظة مضافة قبل كده.";case"RLS_DENIED":return"ليست لديك صلاحية لإضافة المحفظة.";default:return"خطأ غير متوقع."}},C=async a=>{var u;if(a.preventDefault(),g(null),!/^01\d{9}$/.test(t.msisdn)){g("اكتب رقم 11 رقم يبدأ بـ 01.");return}if(!T(t.msisdn,t.provider)){g("مقدم الخدمة لا يتطابق مع مقدمة الرقم.");return}if(!(s!=null&&s.id)&&(l!=null&&l.uid))try{let r=!1;const n=((u=y==null?void 0:y.subscription)==null?void 0:u.planType)??(y==null?void 0:y.planType)??null,v=typeof n=="string"?n.toLowerCase():null;if(n===V.ZERO||v==="zero"||n===0||v==="0")r=!0;else{const h=await se(l.uid),U=(h==null?void 0:h.planType)??(h==null?void 0:h.plan)??null,_=typeof U=="string"?U.toLowerCase():null;r=U===V.ZERO||_==="zero"||U===0||_==="0"}if(r&&(await I.getByMerchantId(l.uid)).length>=5){g("باقة زيرو تسمح بإضافة 5 محافظ فقط. قم بالترقية."),S({title:"تحذير",description:"لا يمكنك إضافة أكثر من 5 محافظ في باقة زيرو. قم بالترقية.",variant:"destructive"});return}}catch(r){console.warn("Zero plan limit check failed:",r)}W(!0);try{if(!(l!=null&&l.uid)){console.warn("يجب تسجيل الدخول قبل حفظ/إضافة المحفظة");return}const r={...t,merchantUserId:l==null?void 0:l.uid,isActive:!0,provider:t.provider};if(console.log("Saving wallet data:",r),s!=null&&s.id)await I.update(s.id,r),await H.setLimits(s.id,{dailyTransferLimit:t.dailyTransferLimit,dailyWithdrawLimit:t.dailyWithdrawLimit,monthlyTransferLimit:t.monthlyTransferLimit??t.transferLimit,monthlyWithdrawLimit:t.monthlyWithdrawLimit??t.withdrawLimit}),console.log("Wallet updated successfully"),D();else{console.log("Creating new wallet...");const n=await I.create(r);console.log("Wallet created with ID:",n),await H.setLimits(n,{dailyTransferLimit:t.dailyTransferLimit,dailyWithdrawLimit:t.dailyWithdrawLimit,monthlyTransferLimit:t.monthlyTransferLimit??t.transferLimit,monthlyWithdrawLimit:t.monthlyWithdrawLimit??t.withdrawLimit});const v={id:n,...r,dailyUsage:0,monthlyUsage:0};console.log("Final wallet object:",v),D(v)}S({title:"تم إضافة المحفظة",description:`تم ${s!=null&&s.id?"تحديث":"إضافة"} المحفظة بنجاح`}),b(!1)}catch(r){console.error("Error saving wallet:",r);let n="حصل خطأ أثناء الإضافة";r.code?n=k(r.code):r.message&&(n=r.message),S({title:"خطأ",description:n,variant:"destructive"})}finally{W(!1)}};return e.jsx(X,{open:p,onOpenChange:b,children:e.jsxs(G,{className:"sm:max-w-md",children:[e.jsx(J,{children:e.jsx(K,{children:s!=null&&s.id?"تعديل المحفظة":"إضافة محفظة جديدة"})}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"provider",children:"المزود"}),e.jsxs(oe,{value:t.provider,onValueChange:a=>o({...t,provider:a}),disabled:m,children:[e.jsx(ce,{children:e.jsx(me,{placeholder:"اختر المزود"})}),e.jsxs(le,{children:[e.jsx(M,{value:"vodafone_cash",children:"Vodafone Cash"}),e.jsx(M,{value:"etisalat_cash",children:"Etisalat Cash"}),e.jsx(M,{value:"orange_cash",children:"Orange Cash"}),e.jsx(M,{value:"instapay",children:"InstaPay"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"msisdn",children:"رقم الهاتف"}),e.jsx(N,{id:"msisdn",placeholder:"01xxxxxxxxx",value:t.msisdn,onChange:a=>o({...t,msisdn:a.target.value}),disabled:m,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"ownerName",children:"اسم صاحب المحفظة (اختياري)"}),e.jsx(N,{id:"ownerName",type:"text",value:t.ownerName,onChange:a=>o({...t,ownerName:a.target.value}),disabled:m,placeholder:"اكتب اسم صاحب المحفظة"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"nationalId",children:"الرقم القومي (اختياري)"}),e.jsx(N,{id:"nationalId",type:"text",value:t.nationalId,onChange:a=>o({...t,nationalId:a.target.value}),disabled:m,placeholder:"الرقم القومي"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"dailyWithdrawLimit",children:"حد السحب اليومي (ج.م)"}),e.jsx(N,{id:"dailyWithdrawLimit",type:"number",min:"0",step:"0.01",value:t.dailyWithdrawLimit,onChange:a=>o({...t,dailyWithdrawLimit:parseFloat(a.target.value)||0}),disabled:m,placeholder:"100000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"dailyTransferLimit",children:"حد التحويل اليومي (ج.م)"}),e.jsx(N,{id:"dailyTransferLimit",type:"number",min:"0",step:"0.01",value:t.dailyTransferLimit,onChange:a=>o({...t,dailyTransferLimit:parseFloat(a.target.value)||0}),disabled:m,placeholder:"60000"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"monthlyWithdrawLimit",children:"حد السحب الشهري (ج.م)"}),e.jsx(N,{id:"monthlyWithdrawLimit",type:"number",min:"0",step:"0.01",value:t.monthlyWithdrawLimit,onChange:a=>o({...t,monthlyWithdrawLimit:parseFloat(a.target.value)||2e5}),disabled:m,placeholder:"200000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"monthlyTransferLimit",children:"حد التحويل الشهري (ج.م)"}),e.jsx(N,{id:"monthlyTransferLimit",type:"number",min:"0",step:"0.01",value:t.monthlyTransferLimit,onChange:a=>o({...t,monthlyTransferLimit:parseFloat(a.target.value)||2e5}),disabled:m,placeholder:"200000"})]})]}),F&&e.jsx("div",{className:"text-red-600 text-sm mt-2",children:F}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>b(!1),disabled:m,children:"إلغاء"}),e.jsx(f,{type:"submit",disabled:m,className:"btn-primary",children:m?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"mr-2 h-4 w-4 animate-spin"}),"جارِ الإضافة…"]}):s!=null&&s.id?"تحديث المحفظة":"إضافة المحفظة"})]})]})]})})}function Te({showAddButton:p=!0,showUsageBars:b=!0,showLimitCards:s=!0,showEditButton:D=!0}){const[t,o]=x.useState([]),[m,W]=x.useState(!0),[F,g]=x.useState(!1),[l,y]=x.useState(null),[S,T]=x.useState(p),[k,C]=x.useState(!1),[a,u]=x.useState(null),{user:r}=q(),{toast:n}=Y(),v=te();x.useEffect(()=>{r!=null&&r.uid&&h()},[r==null?void 0:r.uid]);const h=async()=>{try{if(!(r!=null&&r.uid)){o([]),W(!1);return}W(!0);const c=(await I.getByMerchantId(r.uid)).map(d=>({...d,dailyUsage:d.dailyUsage||0,monthlyUsage:d.monthlyUsage||0,transferUsage:d.transferUsage||0,withdrawUsage:d.withdrawUsage||0}));o(c)}catch(i){console.error("Error fetching wallets from Firebase:",i),n({title:"خطأ",description:"فشل في تحميل المحافظ من الخادم. يرجى المحاولة مرة أخرى.",variant:"destructive"}),o([])}finally{W(!1)}},U=async(i,c)=>{try{await I.update(i,{isActive:!c});const d=t.map(L=>L.id===i?{...L,isActive:!L.isActive}:L);o(d),n({title:"تم التحديث",description:`تم ${c?"إلغاء تفعيل":"تفعيل"} المحفظة بنجاح`})}catch(d){console.error("Error toggling wallet status:",d),n({title:"خطأ",description:"فشل في تحديث حالة المحفظة",variant:"destructive"})}},_=async(i,c)=>{u({id:i,msisdn:c}),C(!0)},Q=async()=>{if(a)try{await I.delete(a.id);const i=t.filter(c=>c.id!==a.id);o(i),r!=null&&r.uid&&await h(),n({title:"تم الحذف",description:`تم حذف المحفظة ${a.msisdn} بنجاح`})}catch(i){console.error("Error deleting wallet:",i),n({title:"خطأ",description:"فشل في حذف المحفظة",variant:"destructive"})}finally{C(!1),u(null)}},A=(i,c)=>{if(c===0)return"bg-muted";const d=i/c*100;return d>=100?"bg-destructive":d>=80?"bg-warning":"bg-success"},w=i=>{switch(i){case"vodafone_cash":return"bg-red-600";case"etisalat_cash":return"bg-green-600";case"orange_cash":return"bg-orange-600";case"instapay":return"bg-blue-600";default:return"bg-gray-600"}},ee=i=>{switch(i){case"vodafone_cash":return"#dc2626";case"etisalat_cash":return"#16a34a";case"orange_cash":return"#ea580c";case"instapay":return"#2563eb";default:return"#6b7280"}},ie=i=>{switch(i){case"vodafone_cash":return"فودافون كاش";case"etisalat_cash":return"اتصالات كاش";case"orange_cash":return"أورانج كاش";case"instapay":return"إنستاباي";default:return String(i).replace(/_/g," ")}};return m?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent"}),e.jsx("p",{className:"text-muted-foreground animate-pulse",children:"جاري تحميل المحافظ..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"محافظي"}),e.jsxs(f,{variant:"outline",size:"sm",onClick:h,disabled:m,className:"flex items-center gap-2",children:[e.jsx("svg",{className:`w-4 h-4 ${m?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"تحديث"]})]}),p&&S&&e.jsxs(f,{onClick:()=>{g(!0),T(!1)},className:"btn-primary",children:[e.jsx(P,{className:"ml-2 h-4 w-4"}),"إضافة محفظة جديدة"]})]}),e.jsxs("div",{className:"grid gap-6",children:[t.map(i=>{var c,d,L,$,R,O;return e.jsxs(z,{className:"card-glass hover:shadow-lg transition-all duration-300 border-l-4",style:{borderLeftColor:ee(i.provider)},children:[e.jsx(re,{className:"pb-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ne,{className:`${w(i.provider)} text-white font-medium px-3 py-1`,children:ie(i.provider)}),e.jsx("div",{className:`w-3 h-3 rounded-full ${i.isActive?"bg-green-500":"bg-gray-400"}`,title:i.isActive?"نشط":"غير نشط"})]}),e.jsx(ae,{className:"text-xl font-bold text-primary",children:i.msisdn}),i.label&&e.jsxs("span",{className:"text-sm text-muted-foreground font-medium",children:["(",i.label,")"]})]})}),e.jsxs("div",{className:"flex items-center gap-2 bg-muted/50 rounded-lg p-2",children:[D&&e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>{v(`/user/add-wallet?edit=1&id=${i.id}`)},children:e.jsx(xe,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>U(i.id,i.isActive),children:i.isActive?e.jsx(ue,{className:"h-5 w-5 text-success"}):e.jsx(ge,{className:"h-5 w-5 text-muted-foreground"})}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>_(i.id,i.msisdn),className:"text-destructive hover:text-destructive",children:e.jsx(de,{className:"h-4 w-4"})})]})]})}),e.jsx(B,{className:"pt-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 p-3 rounded-md border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"text-xs text-gray-600 font-medium mb-2 text-center",children:["الحدود الشهرية: ",i.provider," - ",i.msisdn]}),e.jsxs("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden flex",children:[e.jsx("div",{className:"w-1/2 bg-red-200 relative",children:e.jsx("div",{className:"bg-gradient-to-r from-red-400 to-red-600 h-2 transition-all duration-200 ease-out",style:{width:`${i.withdrawLimit?Math.min((i.withdrawUsage||0)/i.withdrawLimit*100,100):0}%`}})}),e.jsx("div",{className:"w-1/2 bg-blue-200 relative",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-blue-600 h-2 transition-all duration-200 ease-out",style:{width:`${i.transferLimit?Math.min((i.transferUsage||0)/i.transferLimit*100,100):0}%`}})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsxs("div",{className:"text-xs text-red-600 font-medium",children:["متبقي سحب: ",Math.max((i.withdrawLimit||0)-(i.withdrawUsage||0),0).toLocaleString()," جنيه"]}),e.jsxs("div",{className:"text-xs text-blue-600 font-medium",children:["متبقي تحويل: ",Math.max((i.transferLimit||0)-(i.transferUsage||0),0).toLocaleString()," جنيه"]})]})]}),b&&e.jsxs("div",{className:"bg-muted/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm mb-3",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"الاستخدام اليومي"}),e.jsxs("span",{className:"font-bold",children:[(c=i.dailyUsage)==null?void 0:c.toLocaleString()," / ",i.dailyLimit>0?i.dailyLimit.toLocaleString():"∞"," جنيه"]})]}),e.jsx(E,{value:i.dailyLimit>0?Math.min((i.dailyUsage||0)/i.dailyLimit*100,100):0,className:`h-3 ${A(i.dailyUsage||0,i.dailyLimit)}`}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 text-right",children:[i.dailyLimit>0?((i.dailyUsage||0)/i.dailyLimit*100).toFixed(1):0,"% مستخدم"]})]}),b&&e.jsxs("div",{className:"bg-muted/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm mb-3",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"الاستخدام الشهري"}),e.jsxs("span",{className:"font-bold",children:[(d=i.monthlyUsage)==null?void 0:d.toLocaleString()," / ",i.monthlyLimit>0?i.monthlyLimit.toLocaleString():"∞"," جنيه"]})]}),e.jsx(E,{value:i.monthlyLimit>0?Math.min((i.monthlyUsage||0)/i.monthlyLimit*100,100):0,className:`h-3 ${A(i.monthlyUsage||0,i.monthlyLimit)}`}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 text-right",children:[i.monthlyLimit>0?((i.monthlyUsage||0)/i.monthlyLimit*100).toFixed(1):0,"% مستخدم"]})]}),s&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm mb-3",children:[e.jsx("span",{className:"font-medium text-blue-700",children:"حد التحويل"}),e.jsxs("span",{className:"font-bold text-blue-900",children:[((L=i.transferUsage)==null?void 0:L.toLocaleString())||0," / ",(($=i.transferLimit)==null?void 0:$.toLocaleString())||2e5," جنيه"]})]}),e.jsx(E,{value:i.transferLimit?Math.min((i.transferUsage||0)/i.transferLimit*100,100):0,className:"h-3 bg-blue-100"}),e.jsxs("div",{className:"text-xs text-blue-600 mt-1 text-right",children:[i.transferLimit?((i.transferUsage||0)/i.transferLimit*100).toFixed(1):0,"% مستخدم"]}),e.jsxs("div",{className:"text-xs text-blue-700 mt-1 text-right font-medium",children:["المتبقي: ",Math.max((i.transferLimit||0)-(i.transferUsage||0),0).toLocaleString()," جنيه"]})]}),s&&e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm mb-3",children:[e.jsx("span",{className:"font-medium text-green-700",children:"حد السحب"}),e.jsxs("span",{className:"font-bold text-green-900",children:[((R=i.withdrawUsage)==null?void 0:R.toLocaleString())||0," / ",((O=i.withdrawLimit)==null?void 0:O.toLocaleString())||2e5," جنيه"]})]}),e.jsx(E,{value:i.withdrawLimit?Math.min((i.withdrawUsage||0)/i.withdrawLimit*100,100):0,className:"h-3 bg-green-100"}),e.jsxs("div",{className:"text-xs text-green-600 mt-1 text-right",children:[i.withdrawLimit?((i.withdrawUsage||0)/i.withdrawLimit*100).toFixed(1):0,"% مستخدم"]}),e.jsxs("div",{className:"text-xs text-green-700 mt-1 text-right font-medium",children:["المتبقي: ",Math.max((i.withdrawLimit||0)-(i.withdrawUsage||0),0).toLocaleString()," جنيه"]})]})]})})]},i.id)}),t.length===0&&e.jsx(z,{className:"card-glass",children:e.jsxs(B,{className:"text-center py-16",children:[e.jsx("div",{className:"bg-muted/30 rounded-full w-24 h-24 mx-auto mb-6 flex items-center justify-center",children:e.jsx(P,{className:"w-12 h-12 text-muted-foreground"})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"لا توجد محافظ"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"ابدأ بإضافة محفظتك الأولى لتتمكن من استقبال المدفوعات من عملائك"}),p&&S&&e.jsxs(f,{onClick:()=>{g(!0),T(!1)},size:"lg",className:"btn-primary px-8",children:[e.jsx(P,{className:"w-5 h-5 ml-2"}),"إضافة محفظة جديدة"]})]})})]}),e.jsx(fe,{open:F,onOpenChange:i=>{g(i),i||(y(null),T(!0))},wallet:l,onSuccess:i=>{console.log("onSuccess called with:",i),console.log("editingWallet:",l),i&&!l?(console.log("Adding new wallet to list"),o(c=>{const d=[...c,i];return console.log("Updated wallets list:",d),d})):(console.log("Refreshing wallets from Firebase"),h()),g(!1),y(null),T(!0)}}),e.jsx(X,{open:k,onOpenChange:C,children:e.jsxs(G,{children:[e.jsx(J,{children:e.jsx(K,{children:"تأكيد حذف المحفظة"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["هل أنت متأكد من حذف المحفظة ",a==null?void 0:a.msisdn,"؟ هذا الإجراء لا يمكن التراجع عنه."]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{variant:"outline",onClick:()=>C(!1),children:"إلغاء"}),e.jsx(f,{variant:"destructive",onClick:Q,children:"حذف"})]})]})]})})]})}export{Te as W};
