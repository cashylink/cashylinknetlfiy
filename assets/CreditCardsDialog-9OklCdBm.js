import{i as P,r as u,j as e,a5 as I,a6 as G,a7 as O,a8 as J,ao as f,B as p,ap as U,v as m,I as c,aq as q}from"./index-bCWIXU_s.js";import{P as H}from"./progress-x9HwvYAT.js";import{C as M}from"./circle-check-big-DiwZPFwf.js";import{P as R}from"./pen-line-BxC7Ywxy.js";import{T as W}from"./trash-2-BWgB-yFB.js";import{C as v}from"./circle-alert-BxhCUO6U.js";import{C}from"./calendar-xPArWQ6D.js";const Z=({isOpen:b,onClose:w})=>{console.log("CreditCardsDialog rendered with isOpen:",b);const{toast:x}=P(),[d,D]=u.useState([]),[N,h]=u.useState(!1),[l,j]=u.useState(null),[s,i]=u.useState({name:"",bank:"",creditLimit:"",startDate:"",endDate:"",reminderDate:"",color:"#8B5CF6"}),y=["#8B5CF6","#EF4444","#10B981","#F59E0B","#3B82F6","#EC4899","#6366F1","#14B8A6"];u.useEffect(()=>{const t=localStorage.getItem("creditCards");t&&D(JSON.parse(t))},[]);const g=t=>{localStorage.setItem("creditCards",JSON.stringify(t)),D(t)},k=()=>{if(!s.name||!s.bank||!s.creditLimit){x({title:"خطأ",description:"يرجى ملء جميع الحقول المطلوبة",variant:"destructive"});return}const t=parseFloat(s.creditLimit),a={id:Date.now().toString(),name:s.name,bank:s.bank,creditLimit:t,usedAmount:0,availableAmount:t,startDate:s.startDate,endDate:s.endDate,reminderDate:s.reminderDate,color:s.color},n=[...d,a];g(n),i({name:"",bank:"",creditLimit:"",startDate:"",endDate:"",reminderDate:"",color:"#8B5CF6"}),h(!1),x({title:"تم بنجاح",description:"تم إضافة بطاقة الائتمان بنجاح"})},F=t=>{const a=d.filter(n=>n.id!==t);g(a),x({title:"تم الحذف",description:"تم حذف بطاقة الائتمان بنجاح"})},L=t=>{j(t),i({name:t.name,bank:t.bank,creditLimit:t.creditLimit.toString(),startDate:t.startDate,endDate:t.endDate,reminderDate:t.reminderDate,color:t.color}),h(!0)},A=()=>{if(!l)return;const t=parseFloat(s.creditLimit),a={...l,name:s.name,bank:s.bank,creditLimit:t,availableAmount:t-l.usedAmount,startDate:s.startDate,endDate:s.endDate,reminderDate:s.reminderDate,color:s.color},n=d.map(r=>r.id===l.id?a:r);g(n),j(null),h(!1),i({name:"",bank:"",creditLimit:"",startDate:"",endDate:"",reminderDate:"",color:"#8B5CF6"}),x({title:"تم التحديث",description:"تم تحديث بطاقة الائتمان بنجاح"})},E=()=>{j(null),h(!1),i({name:"",bank:"",creditLimit:"",startDate:"",endDate:"",reminderDate:"",color:"#8B5CF6"})},S=(t,a)=>{const n=d.map(r=>{if(r.id===t){const o=r.usedAmount+a;return o>r.creditLimit?(x({title:"خطأ",description:"المبلغ يتجاوز الحد الائتماني المتاح",variant:"destructive"}),r):{...r,usedAmount:o,availableAmount:r.creditLimit-o}}return r});g(n)},B=t=>t.usedAmount/t.creditLimit*100,T=t=>{if(!t)return!1;const a=new Date,r=new Date(t).getTime()-a.getTime(),o=Math.ceil(r/(1e3*60*60*24));return o<=7&&o>=0};return e.jsx(I,{open:b,onOpenChange:w,children:e.jsxs(G,{className:"max-w-4xl max-h-[95vh] overflow-y-auto p-3 sm:p-6",children:[e.jsx(O,{className:"pb-4",children:e.jsxs(J,{className:"flex items-center gap-2 text-lg sm:text-xl",children:[e.jsx(f,{className:"h-5 w-5 sm:h-6 sm:w-6 text-purple-600"}),"إدارة كروت الائتمان"]})}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[!N&&e.jsxs(p,{onClick:()=>h(!0),className:"w-full bg-purple-600 hover:bg-purple-700 text-white py-3 text-base",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"إضافة بطاقة ائتمان جديدة"]}),N&&e.jsxs("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg border",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:l?"تعديل بطاقة الائتمان":"إضافة بطاقة ائتمان جديدة"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"cardName",className:"text-sm font-medium",children:"اسم البطاقة"}),e.jsx(c,{id:"cardName",value:s.name,onChange:t=>i({...s,name:t.target.value}),placeholder:"مثال: بطاقة التسوق",className:"mt-1 h-11"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"bankName",className:"text-sm font-medium",children:"اسم البنك"}),e.jsx(c,{id:"bankName",value:s.bank,onChange:t=>i({...s,bank:t.target.value}),placeholder:"مثال: البنك الأهلي",className:"mt-1 h-11"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"creditLimit",className:"text-sm font-medium",children:"الحد الائتماني (جنيه)"}),e.jsx(c,{id:"creditLimit",type:"number",value:s.creditLimit,onChange:t=>i({...s,creditLimit:t.target.value}),placeholder:"10000",className:"mt-1 h-11"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"cardColor",className:"text-sm font-medium",children:"لون البطاقة"}),e.jsx("div",{className:"flex gap-3 mt-2 flex-wrap",children:y.map(t=>e.jsx("button",{type:"button",className:`w-10 h-10 rounded-full border-2 ${s.color===t?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:t},onClick:()=>i({...s,color:t})},t))})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"startDate",className:"text-sm font-medium",children:"تاريخ بداية المدة"}),e.jsx(c,{id:"startDate",type:"date",value:s.startDate,onChange:t=>i({...s,startDate:t.target.value}),className:"mt-1 h-11"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"endDate",className:"text-sm font-medium",children:"تاريخ نهاية المدة"}),e.jsx(c,{id:"endDate",type:"date",value:s.endDate,onChange:t=>i({...s,endDate:t.target.value}),className:"mt-1 h-11"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"reminderDate",className:"text-sm font-medium",children:"تاريخ التذكير"}),e.jsx(c,{id:"reminderDate",type:"date",value:s.reminderDate,onChange:t=>i({...s,reminderDate:t.target.value}),className:"mt-1 h-11"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-4",children:[e.jsxs(p,{onClick:l?A:k,className:"bg-green-600 hover:bg-green-700 text-white py-3 text-base flex-1",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),l?"حفظ التعديلات":"إضافة البطاقة"]}),e.jsx(p,{onClick:E,variant:"outline",className:"py-3 text-base flex-1",children:"إلغاء"})]})]}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:d.length===0?e.jsxs("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:[e.jsx(f,{className:"h-10 w-10 sm:h-12 sm:w-12 mx-auto mb-3 sm:mb-4 text-gray-300"}),e.jsx("p",{className:"text-sm sm:text-base",children:"لا توجد بطاقات ائتمان مضافة بعد"})]}):d.map(t=>e.jsxs("div",{className:"bg-white border-2 rounded-lg p-3 sm:p-4 shadow-sm",style:{borderColor:t.color},children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-base sm:text-lg font-semibold text-gray-800",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.bank})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>L(t),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-full transition-colors",children:e.jsx(R,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>F(t.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-full transition-colors",children:e.jsx(W,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"حد السحب"}),e.jsxs("span",{className:"text-xs sm:text-sm text-gray-600",children:[t.availableAmount.toFixed(2)," / ",t.creditLimit.toFixed(2)," ج.م"]})]}),e.jsx(H,{value:B(t),className:"h-2 sm:h-3",style:{"--progress-background":t.color,"--progress-foreground":t.color}}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:["مستخدم: ",t.usedAmount.toFixed(2)," ج.م"]}),e.jsxs("span",{children:["متاح: ",t.availableAmount.toFixed(2)," ج.م"]})]})]}),T(t.endDate)&&e.jsxs("div",{className:"flex items-center gap-2 mb-3 p-2 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsx(v,{className:"h-4 w-4 text-orange-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-orange-700",children:"موعد السداد قريب!"})]}),(t.startDate||t.endDate||t.reminderDate)&&e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-xs text-gray-600 mb-3 sm:mb-4",children:[t.startDate&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-3 w-3 flex-shrink-0"}),e.jsxs("span",{children:["البداية: ",new Date(t.startDate).toLocaleDateString("ar-EG")]})]}),t.endDate&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-3 w-3 flex-shrink-0"}),e.jsxs("span",{children:["النهاية: ",new Date(t.endDate).toLocaleDateString("ar-EG")]})]}),t.reminderDate&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-3 w-3 flex-shrink-0"}),e.jsxs("span",{children:["التذكير: ",new Date(t.reminderDate).toLocaleDateString("ar-EG")]})]})]}),e.jsxs(p,{onClick:()=>{const a=prompt("أدخل مبلغ السحب:");a&&!isNaN(parseFloat(a))&&S(t.id,parseFloat(a))},className:"w-full bg-red-600 hover:bg-red-700 text-white py-3 text-base",disabled:t.availableAmount<=0,children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"سحب من البطاقة"]})]},t.id))})]})]})})};export{Z as default};
//# sourceMappingURL=CreditCardsDialog-9OklCdBm.js.map
