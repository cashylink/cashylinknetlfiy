{"version":3,"file":"AuthTestPage-BezjdZu6.js","sources":["../../src/pages/AuthTestPage.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\r\nimport { auth, db } from '@/firebase';\r\nimport { doc, getDoc, setDoc } from 'firebase/firestore';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\n\r\nexport default function AuthTestPage() {\r\n  const { user, profile, loading, signIn } = useFirebaseAuth();\r\n  const [authState, setAuthState] = useState<any>(null);\r\n  const [email, setEmail] = useState('alkaptin7878@mail.ru');\r\n  const [password, setPassword] = useState('01123456');\r\n\r\n  useEffect(() => {\r\n    const checkAuthState = () => {\r\n      setAuthState({\r\n        contextUser: user ? {\r\n          uid: user.uid,\r\n          email: user.email,\r\n          emailVerified: user.emailVerified\r\n        } : null,\r\n        contextProfile: profile,\r\n        contextLoading: loading,\r\n        firebaseCurrentUser: auth.currentUser ? {\r\n          uid: auth.currentUser.uid,\r\n          email: auth.currentUser.email,\r\n          emailVerified: auth.currentUser.emailVerified\r\n        } : null,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n    };\r\n\r\n    checkAuthState();\r\n    const interval = setInterval(checkAuthState, 2000);\r\n    return () => clearInterval(interval);\r\n  }, [user, profile, loading]);\r\n\r\n  const handleTestLogin = async () => {\r\n    console.log('üß™ Testing login with:', { email, password: '***' });\r\n    try {\r\n      const result = await signIn(email, password);\r\n      console.log('üß™ Login result:', result);\r\n    } catch (error) {\r\n      console.error('üß™ Login error:', error);\r\n    }\r\n  };\r\n\r\n  const testFirestoreConnection = async () => {\r\n    console.log('üî• Testing Firestore connection...');\r\n    console.log('üîç Current auth state:', {\r\n      user: user ? { uid: user.uid, email: user.email } : null,\r\n      firebaseCurrentUser: auth.currentUser ? { uid: auth.currentUser.uid, email: auth.currentUser.email } : null\r\n    });\r\n    \r\n    try {\r\n      if (!user && !auth.currentUser) {\r\n        console.log('‚ùå No user logged in - please login first');\r\n        alert('Ÿäÿ±ÿ¨Ÿâ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ£ŸàŸÑÿßŸã ŸÑÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿßÿ™ÿµÿßŸÑ ŸÖÿπ Firestore');\r\n        return;\r\n      }\r\n\r\n      const currentUser = user || auth.currentUser;\r\n      console.log('‚úÖ Using user:', currentUser?.email);\r\n\r\n      // ÿßÿÆÿ™ÿ®ÿßÿ± ŸÇÿ±ÿßÿ°ÿ© ŸÖŸÑŸÅ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ\r\n      console.log('üìñ Testing user document read...');\r\n      const userDocRef = doc(db, 'users', currentUser!.uid);\r\n      const userDoc = await getDoc(userDocRef);\r\n      \r\n      if (userDoc.exists()) {\r\n        console.log('‚úÖ User document exists:', userDoc.data());\r\n      } else {\r\n        console.log('‚ö†Ô∏è User document does not exist, creating...');\r\n        await setDoc(userDocRef, {\r\n          email: currentUser!.email,\r\n          uid: currentUser!.uid,\r\n          createdAt: new Date(),\r\n          role: 'user',\r\n          isActive: true\r\n        });\r\n        console.log('‚úÖ User document created');\r\n      }\r\n\r\n      // ÿßÿÆÿ™ÿ®ÿßÿ± ŸÇÿ±ÿßÿ°ÿ© ŸÖÿ≠ÿßŸÅÿ∏ ÿßŸÑÿ™ÿßÿ¨ÿ±\r\n      console.log('üìñ Testing merchant wallet read...');\r\n      const walletDocRef = doc(db, 'merchantWallets', `test_${currentUser!.uid}`);\r\n      const walletDoc = await getDoc(walletDocRef);\r\n      \r\n      if (walletDoc.exists()) {\r\n        console.log('‚úÖ Wallet document exists:', walletDoc.data());\r\n      } else {\r\n        console.log('‚ö†Ô∏è Wallet document does not exist, creating test wallet...');\r\n        await setDoc(walletDocRef, {\r\n          merchantUserId: currentUser!.uid,\r\n          walletName: 'ŸÖÿ≠ŸÅÿ∏ÿ© ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©',\r\n          balance: 0,\r\n          createdAt: new Date()\r\n        });\r\n        console.log('‚úÖ Test wallet created');\r\n      }\r\n\r\n      console.log('üéâ Firestore connection test completed successfully!');\r\n      alert('ÿ™ŸÖ ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿßÿ™ÿµÿßŸÑ ŸÖÿπ Firestore ÿ®ŸÜÿ¨ÿßÿ≠! ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ Ÿàÿ≠ÿØÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ ŸÑŸÑÿ™ŸÅÿßÿµŸäŸÑ');\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Firestore connection error:', error);\r\n      alert(`ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ ŸÖÿπ Firestore: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background p-6\">\r\n      <div className=\"max-w-4xl mx-auto space-y-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>üîê ÿßÿÆÿ™ÿ®ÿßÿ± ÿ≠ÿßŸÑÿ© ÿßŸÑŸÖÿµÿßÿØŸÇÿ©</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"email\">ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä</Label>\r\n              <Input\r\n                id=\"email\"\r\n                type=\"email\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n                placeholder=\"ÿ£ÿØÿÆŸÑ ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä\"\r\n              />\r\n            </div>\r\n            \r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"password\">ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±</Label>\r\n              <Input\r\n                id=\"password\"\r\n                type=\"password\"\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n                placeholder=\"ÿ£ÿØÿÆŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±\"\r\n              />\r\n            </div>\r\n            \r\n            <Button onClick={handleTestLogin} className=\"w-full\" disabled={loading}>\r\n              {loading ? 'ÿ¨ÿßÿ±Ÿä ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ...' : 'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä'}\r\n            </Button>\r\n            \r\n            {user && (\r\n              <Button onClick={testFirestoreConnection} className=\"w-full\" variant=\"outline\">\r\n                ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿßÿ™ÿµÿßŸÑ ŸÖÿπ Firestore\r\n              </Button>\r\n            )}\r\n\r\n            \r\n            \r\n            <div className=\"bg-gray-100 p-4 rounded-lg\">\r\n              <h3 className=\"font-bold mb-2\">ÿ≠ÿßŸÑÿ© ÿßŸÑŸÖÿµÿßÿØŸÇÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©:</h3>\r\n              <pre className=\"text-sm overflow-auto\">\r\n                {JSON.stringify(authState, null, 2)}\r\n              </pre>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["AuthTestPage","user","profile","loading","signIn","useFirebaseAuth","authState","setAuthState","useState","email","setEmail","password","setPassword","useEffect","checkAuthState","auth","interval","handleTestLogin","result","error","testFirestoreConnection","currentUser","userDocRef","doc","db","userDoc","getDoc","setDoc","walletDocRef","walletDoc","jsx","jsxs","Card","CardHeader","CardTitle","CardContent","Label","Input","Button"],"mappings":"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"}