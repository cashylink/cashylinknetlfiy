{"version":3,"file":"WalletsListDialog-BZJ2fJb2.js","sources":["../../src/components/WalletsListDialog.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Wallet, Check, Phone, CreditCard, User, Building2, FileText, X } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { MasterPinDialog } from '@/components/MasterPinDialog';\n\ninterface WalletData {\n  id: string;\n  name: string;\n  phone: string;\n  isDefault: boolean;\n  ownerName?: string;\n  nationalId?: string;\n  providerName?: string;\n}\n\ninterface WalletsListDialogProps {\n  isOpen: boolean;\n  onClose: () => void;\n  wallets: WalletData[];\n  walletBalances: Record<string, number>;\n  onSelectWallet: (walletId: string) => void;\n  selectedWalletId?: string;\n  userId?: string;\n}\n\nexport function WalletsListDialog({\n  isOpen,\n  onClose,\n  wallets,\n  walletBalances,\n  onSelectWallet,\n  selectedWalletId,\n  userId\n}: WalletsListDialogProps) {\n  const [isMasterPinOpen, setIsMasterPinOpen] = useState(false);\n  const [selectedWalletForDetails, setSelectedWalletForDetails] = useState<WalletData | null>(null);\n  const [isDetailsOpen, setIsDetailsOpen] = useState(false);\n\n  const handleSelect = (walletId: string) => {\n    onSelectWallet(walletId);\n    onClose();\n  };\n\n  const handleShowDetails = (e: React.MouseEvent, wallet: WalletData) => {\n    e.stopPropagation();\n    setSelectedWalletForDetails(wallet);\n    setIsMasterPinOpen(true);\n  };\n\n  const handleMasterPinSuccess = () => {\n    setIsDetailsOpen(true);\n  };\n\n  const totalBalance = wallets.reduce((sum, wallet) => sum + (Number(walletBalances[wallet.id]) || 0), 0);\n\n  return (\n    <>\n      <Dialog open={isOpen} onOpenChange={onClose}>\n        <DialogContent className=\"sm:max-w-md bg-gradient-to-br from-white to-gray-50 border-0 shadow-2xl\">\n          <DialogHeader className=\"space-y-4 pb-4 border-b border-gray-100\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-3 bg-blue-100 rounded-full\">\n                <Wallet className=\"w-6 h-6 text-blue-600\" />\n              </div>\n              <div className=\"space-y-1\">\n                <DialogTitle className=\"text-xl font-bold text-gray-900\">\n                  المحافظ المتاحة\n                </DialogTitle>\n                <p className=\"text-sm text-gray-500 font-medium\">\n                  إجمالي الرصيد: <span className=\"text-blue-600 font-bold text-base\">{totalBalance.toLocaleString('en-US')} جنيه</span>\n                </p>\n              </div>\n            </div>\n          </DialogHeader>\n          \n          <ScrollArea className=\"max-h-[60vh] pr-4 -mr-4\">\n            <div className=\"grid gap-3 py-2\">\n              {wallets.length === 0 ? (\n                <div className=\"text-center py-8 text-gray-500 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200\">\n                  <p>لا توجد محافظ مضافة</p>\n                </div>\n              ) : (\n                wallets.map((wallet) => {\n                  const balance = walletBalances[wallet.id] || 0;\n                  const isSelected = selectedWalletId === wallet.id;\n                  \n                  return (\n                    <div\n                      key={wallet.id}\n                      className={cn(\n                        \"relative flex items-center justify-between p-4 rounded-xl border-2 transition-all duration-200\",\n                        isSelected \n                          ? \"border-blue-500 bg-blue-50/50 shadow-md ring-1 ring-blue-200\" \n                          : \"border-transparent bg-white hover:bg-gray-50 hover:border-gray-200 shadow-sm hover:shadow-md\"\n                      )}\n                    >\n                      {/* Main Clickable Area for Selection */}\n                      <div \n                        className=\"absolute inset-0 z-0 cursor-pointer\"\n                        onClick={() => handleSelect(wallet.id)}\n                      />\n\n                      <div className=\"relative z-10 flex items-center gap-4 pointer-events-none\">\n                        <div className={cn(\n                          \"w-12 h-12 rounded-full flex items-center justify-center transition-colors\",\n                          isSelected ? \"bg-blue-100 text-blue-600\" : \"bg-gray-100 text-gray-500\"\n                        )}>\n                          <Wallet className=\"w-6 h-6\" />\n                        </div>\n                        \n                        <div className=\"flex flex-col items-start gap-1\">\n                          <span className={cn(\n                            \"font-bold text-lg\",\n                            isSelected ? \"text-blue-900\" : \"text-gray-900\"\n                          )}>\n                            {wallet.name}\n                          </span>\n                          <div className=\"flex items-center gap-1.5 text-gray-500\">\n                            <Phone className=\"w-3.5 h-3.5\" />\n                            <span className=\"text-sm font-medium dir-ltr\">{wallet.phone}</span>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"relative z-10 flex items-center gap-3\">\n                        {/* Details Button */}\n                        <Button\n                          size=\"icon\"\n                          variant=\"ghost\"\n                          className=\"h-9 w-9 rounded-full bg-indigo-50 text-indigo-600 hover:bg-indigo-100 hover:text-indigo-700 transition-colors\"\n                          onClick={(e) => handleShowDetails(e, wallet)}\n                          title=\"عرض بيانات المحفظة\"\n                        >\n                          <CreditCard className=\"w-5 h-5\" />\n                        </Button>\n\n                        <div className=\"flex flex-col items-end gap-1 pointer-events-none\">\n                          <span className={cn(\n                            \"font-extrabold text-lg\",\n                            balance > 0 ? \"text-emerald-600\" : \"text-gray-400\"\n                          )}>\n                            {balance.toLocaleString('en-US')}\n                            <span className=\"text-xs mr-1 font-medium text-gray-400\">جنيه</span>\n                          </span>\n                          {isSelected && (\n                            <div className=\"flex items-center gap-1 text-xs font-bold text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full\">\n                              <Check className=\"w-3 h-3\" />\n                              مختار\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })\n              )}\n            </div>\n          </ScrollArea>\n        </DialogContent>\n      </Dialog>\n\n      <MasterPinDialog\n        open={isMasterPinOpen}\n        onOpenChange={setIsMasterPinOpen}\n        onSuccess={handleMasterPinSuccess}\n        mode=\"verify\"\n        title=\"بيانات المحفظة\"\n        description=\"يرجى إدخال الرقم السري الرئيسي لعرض بيانات المحفظة الحساسة\"\n        userId={userId}\n      />\n\n      <Dialog open={isDetailsOpen} onOpenChange={setIsDetailsOpen}>\n        <DialogContent className=\"sm:max-w-md border-0 bg-transparent shadow-none p-0\">\n          <div className=\"relative w-full aspect-[1.586/1] rounded-2xl overflow-hidden shadow-2xl transform transition-all hover:scale-[1.02]\">\n            {/* Card Background with Gradient */}\n            <div className=\"absolute inset-0 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900\">\n              <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 mix-blend-soft-light\"></div>\n              <div className=\"absolute top-0 right-0 w-64 h-64 bg-blue-500 rounded-full mix-blend-overlay filter blur-3xl opacity-20 -mr-16 -mt-16\"></div>\n              <div className=\"absolute bottom-0 left-0 w-64 h-64 bg-purple-500 rounded-full mix-blend-overlay filter blur-3xl opacity-20 -ml-16 -mb-16\"></div>\n            </div>\n\n            {/* Card Content */}\n            <div className=\"relative h-full p-6 flex flex-col justify-between text-white\">\n              {/* Header: Provider & Chip */}\n              <div className=\"flex justify-between items-start\">\n                <div className=\"space-y-1\">\n                  <h3 className=\"text-xs font-medium text-slate-400 uppercase tracking-wider\">جهة الإصدار</h3>\n                  <div className=\"flex items-center gap-2\">\n                    <Building2 className=\"w-4 h-4 text-blue-400\" />\n                    <span className=\"font-bold text-lg tracking-wide\">{selectedWalletForDetails?.providerName || 'غير محدد'}</span>\n                  </div>\n                </div>\n                <div className=\"w-12 h-9 rounded-md bg-gradient-to-br from-yellow-200 to-yellow-400 shadow-inner border border-yellow-500/30 flex items-center justify-center relative overflow-hidden\">\n                  <div className=\"absolute inset-0 opacity-50 bg-[repeating-linear-gradient(90deg,transparent,transparent_2px,#000_2px,#000_3px)]\"></div>\n                  <div className=\"absolute inset-0 opacity-50 bg-[repeating-linear-gradient(0deg,transparent,transparent_2px,#000_2px,#000_3px)]\"></div>\n                </div>\n              </div>\n\n              {/* Middle: Wallet Name/Number (Hidden/Masked or shown?) - User asked for Owner Name, National ID, Provider Name. Wallet Name is usually just a label. Let's show Wallet Name too. */}\n              <div className=\"flex items-center gap-3 my-2\">\n                <div className=\"h-8 px-3 rounded bg-white/10 backdrop-blur-sm flex items-center border border-white/10\">\n                   <span className=\"font-mono text-lg tracking-widest\">{selectedWalletForDetails?.phone}</span>\n                </div>\n              </div>\n\n              {/* Footer: Owner & National ID */}\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-1\">\n                  <h3 className=\"text-[10px] font-medium text-slate-400 uppercase tracking-wider\">اسم المالك</h3>\n                  <div className=\"flex items-center gap-1.5\">\n                    <User className=\"w-3 h-3 text-emerald-400\" />\n                    <span className=\"font-semibold text-sm truncate\">{selectedWalletForDetails?.ownerName || 'غير مسجل'}</span>\n                  </div>\n                </div>\n                <div className=\"space-y-1\">\n                  <h3 className=\"text-[10px] font-medium text-slate-400 uppercase tracking-wider\">الرقم القومي</h3>\n                  <div className=\"flex items-center gap-1.5\">\n                    <FileText className=\"w-3 h-3 text-purple-400\" />\n                    <span className=\"font-mono font-semibold text-sm tracking-wide\">{selectedWalletForDetails?.nationalId || 'غير مسجل'}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n            \n            {/* Close Button */}\n            <button \n              onClick={() => setIsDetailsOpen(false)}\n              className=\"absolute top-3 left-3 p-1.5 rounded-full bg-white/10 hover:bg-white/20 text-white/70 hover:text-white transition-colors\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}\n\n"],"names":["WalletsListDialog","isOpen","onClose","wallets","walletBalances","onSelectWallet","selectedWalletId","userId","isMasterPinOpen","setIsMasterPinOpen","useState","selectedWalletForDetails","setSelectedWalletForDetails","isDetailsOpen","setIsDetailsOpen","handleSelect","walletId","handleShowDetails","e","wallet","handleMasterPinSuccess","totalBalance","sum","jsxs","Fragment","jsx","Dialog","DialogContent","DialogHeader","Wallet","DialogTitle","ScrollArea","balance","isSelected","cn","Phone","Button","CreditCard","Check","MasterPinDialog","Building2","User","FileText","X"],"mappings":"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"}