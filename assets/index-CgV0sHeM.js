const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./LandingPage-2FeRsCUb.js","./star-DyMukElk.js","./arrow-left-L-ZCLYHX.js","./monitor-BtjxvLUT.js","./chart-column-DR-1RCFv.js","./download-DwDr96vs.js","./zap-BGNh6qf_.js","./circle-check-big-iKMCgwGI.js","./crown-2lrrj6PS.js","./SubscriptionsPage-B0tq67oA.js","./contentService-Bgh-eKcj.js","./calendar-0_98-YC1.js","./sparkles-Dox-dZ7m.js","./AuthPage-Dr6lFGi5.js","./TopUpPage-CMMAKE2g.js","./select-Cjxh7T8L.js","./AdminTopupsPage-BQDfBGeH.js","./AdminNotificationsPage-DL6D70pW.js","./bell-CyrMMN44.js","./link-Dyw-TbYI.js","./UserRegisterPage-CEg2Fust.js","./alert-Dp2JhWKK.js","./wallet-BjpRmBYz.js","./user-plus-cWNrqlLl.js","./UserAccountSetupPage-DtlCxBSG.js","./ProtectedDashboard-ClOH56K2.js","./profitService-9EsNGq16.js","./dollar-sign-CUtjmL1D.js","./arrow-down-left-BR8IyOzF.js","./ProtectedUserDashboard-zE0zQwvA.js","./broadcastService-DLuBcfgc.js","./MerchantDashboard-B9wPntSJ.js","./dropdown-menu-CLdLSeyn.js","./index-BVTp5Qlg.js","./WalletsManagement-DwgeheI5.js","./progress-BGmEOiQZ.js","./WalletPrinterDialog-D0giMR7D.js","./html2canvas.esm-BfYXEYrK.js","./printer-D4O-3a9p.js","./save-CK42wzuM.js","./square-pen-B77-kNO1.js","./PendingApprovalPage-TVRqpaRE.js","./freeTrialService-DU5AUvYv.js","./ProtectedAdminDashboard-BIpEuHrG.js","./ProfileIcon-CCS5CeGE.js","./switch-CQytG77E.js","./separator-CArj5DvN.js","./gift-BCTVqinY.js","./table-Ry-VsunV.js","./tabs-B1SNyKq6.js","./users-DcT8Qdqe.js","./activity-BzRIRPYu.js","./pen-line-dJR2NKoC.js","./ProfileSettingsPage-6rJ-8Y1I.js","./VideoModal-3NrJTmLh.js","./TransactionsPage-C9z5VyWw.js","./ReceiptModal-VfKDuN84.js","./SimCardsAccessDialog-ja1xLiJY.js","./InstallmentModal-CNygnL1g.js","./CreditCardsDialog-HYhlYCyp.js","./MaintenanceDialog-DP7Ch7_c.js","./SimCardsDialog-Ca3l7QZk.js","./alert-dialog-CocjFfXp.js","./wifi-D5OhFBQF.js","./battery-charging-DTcxFVrm.js","./WalletAdditionPage-DEGm7k8O.js","./building-2-D9Ovqzwm.js","./ReferralsPage-CkAbKvk4.js","./UserDashboardPage-BxOlnKZi.js"])))=>i.map(i=>d[i]);
var Fj=Object.defineProperty;var $I=t=>{throw TypeError(t)};var Uj=(t,e,n)=>e in t?Fj(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Xd=(t,e,n)=>Uj(t,typeof e!="symbol"?e+"":e,n),Hv=(t,e,n)=>e.has(t)||$I("Cannot "+n);var re=(t,e,n)=>(Hv(t,e,"read from private field"),n?n.call(t):e.get(t)),Gt=(t,e,n)=>e.has(t)?$I("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Et=(t,e,n,r)=>(Hv(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),zr=(t,e,n)=>(Hv(t,e,"access private method"),n);var Pm=(t,e,n,r)=>({set _(s){Et(t,e,s,n)},get _(){return re(t,e,r)}});function $j(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Rte=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function AR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Cte(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var PR={exports:{}},wy={},RR={exports:{}},$t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wf=Symbol.for("react.element"),Bj=Symbol.for("react.portal"),zj=Symbol.for("react.fragment"),Wj=Symbol.for("react.strict_mode"),qj=Symbol.for("react.profiler"),Hj=Symbol.for("react.provider"),Kj=Symbol.for("react.context"),Gj=Symbol.for("react.forward_ref"),Qj=Symbol.for("react.suspense"),Yj=Symbol.for("react.memo"),Jj=Symbol.for("react.lazy"),BI=Symbol.iterator;function Xj(t){return t===null||typeof t!="object"?null:(t=BI&&t[BI]||t["@@iterator"],typeof t=="function"?t:null)}var CR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},NR=Object.assign,kR={};function Td(t,e,n){this.props=t,this.context=e,this.refs=kR,this.updater=n||CR}Td.prototype.isReactComponent={};Td.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Td.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function DR(){}DR.prototype=Td.prototype;function fb(t,e,n){this.props=t,this.context=e,this.refs=kR,this.updater=n||CR}var mb=fb.prototype=new DR;mb.constructor=fb;NR(mb,Td.prototype);mb.isPureReactComponent=!0;var zI=Array.isArray,OR=Object.prototype.hasOwnProperty,pb={current:null},LR={key:!0,ref:!0,__self:!0,__source:!0};function MR(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)OR.call(e,r)&&!LR.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Wf,type:t,key:i,ref:o,props:s,_owner:pb.current}}function Zj(t,e){return{$$typeof:Wf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function gb(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wf}function eF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var WI=/\/+/g;function Kv(t,e){return typeof t=="object"&&t!==null&&t.key!=null?eF(""+t.key):e.toString(36)}function _p(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Wf:case Bj:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Kv(o,0):r,zI(s)?(n="",t!=null&&(n=t.replace(WI,"$&/")+"/"),_p(s,e,n,"",function(c){return c})):s!=null&&(gb(s)&&(s=Zj(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(WI,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",zI(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+Kv(i,a);o+=_p(i,e,n,l,s)}else if(l=Xj(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+Kv(i,a++),o+=_p(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Rm(t,e,n){if(t==null)return t;var r=[],s=0;return _p(t,r,"","",function(i){return e.call(n,i,s++)}),r}function tF(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var is={current:null},bp={transition:null},nF={ReactCurrentDispatcher:is,ReactCurrentBatchConfig:bp,ReactCurrentOwner:pb};function VR(){throw Error("act(...) is not supported in production builds of React.")}$t.Children={map:Rm,forEach:function(t,e,n){Rm(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Rm(t,function(){e++}),e},toArray:function(t){return Rm(t,function(e){return e})||[]},only:function(t){if(!gb(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};$t.Component=Td;$t.Fragment=zj;$t.Profiler=qj;$t.PureComponent=fb;$t.StrictMode=Wj;$t.Suspense=Qj;$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nF;$t.act=VR;$t.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=NR({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=pb.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)OR.call(e,l)&&!LR.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Wf,type:t.type,key:s,ref:i,props:r,_owner:o}};$t.createContext=function(t){return t={$$typeof:Kj,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Hj,_context:t},t.Consumer=t};$t.createElement=MR;$t.createFactory=function(t){var e=MR.bind(null,t);return e.type=t,e};$t.createRef=function(){return{current:null}};$t.forwardRef=function(t){return{$$typeof:Gj,render:t}};$t.isValidElement=gb;$t.lazy=function(t){return{$$typeof:Jj,_payload:{_status:-1,_result:t},_init:tF}};$t.memo=function(t,e){return{$$typeof:Yj,type:t,compare:e===void 0?null:e}};$t.startTransition=function(t){var e=bp.transition;bp.transition={};try{t()}finally{bp.transition=e}};$t.unstable_act=VR;$t.useCallback=function(t,e){return is.current.useCallback(t,e)};$t.useContext=function(t){return is.current.useContext(t)};$t.useDebugValue=function(){};$t.useDeferredValue=function(t){return is.current.useDeferredValue(t)};$t.useEffect=function(t,e){return is.current.useEffect(t,e)};$t.useId=function(){return is.current.useId()};$t.useImperativeHandle=function(t,e,n){return is.current.useImperativeHandle(t,e,n)};$t.useInsertionEffect=function(t,e){return is.current.useInsertionEffect(t,e)};$t.useLayoutEffect=function(t,e){return is.current.useLayoutEffect(t,e)};$t.useMemo=function(t,e){return is.current.useMemo(t,e)};$t.useReducer=function(t,e,n){return is.current.useReducer(t,e,n)};$t.useRef=function(t){return is.current.useRef(t)};$t.useState=function(t){return is.current.useState(t)};$t.useSyncExternalStore=function(t,e,n){return is.current.useSyncExternalStore(t,e,n)};$t.useTransition=function(){return is.current.useTransition()};$t.version="18.3.1";RR.exports=$t;var y=RR.exports;const V=AR(y),_y=$j({__proto__:null,default:V},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rF=y,sF=Symbol.for("react.element"),iF=Symbol.for("react.fragment"),oF=Object.prototype.hasOwnProperty,aF=rF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lF={key:!0,ref:!0,__self:!0,__source:!0};function jR(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)oF.call(e,r)&&!lF.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:sF,type:t,key:i,ref:o,props:s,_owner:aF.current}}wy.Fragment=iF;wy.jsx=jR;wy.jsxs=jR;PR.exports=wy;var f=PR.exports,FR={exports:{}},Fs={},UR={exports:{}},$R={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,Y){var le=W.length;W.push(Y);e:for(;0<le;){var pe=le-1>>>1,fe=W[pe];if(0<s(fe,Y))W[pe]=Y,W[le]=fe,le=pe;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var Y=W[0],le=W.pop();if(le!==Y){W[0]=le;e:for(var pe=0,fe=W.length,Ge=fe>>>1;pe<Ge;){var Ie=2*(pe+1)-1,ve=W[Ie],J=Ie+1,qe=W[J];if(0>s(ve,le))J<fe&&0>s(qe,ve)?(W[pe]=qe,W[J]=le,pe=J):(W[pe]=ve,W[Ie]=le,pe=Ie);else if(J<fe&&0>s(qe,le))W[pe]=qe,W[J]=le,pe=J;else break e}}return Y}function s(W,Y){var le=W.sortIndex-Y.sortIndex;return le!==0?le:W.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,m=3,p=!1,v=!1,g=!1,E=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var Y=n(c);Y!==null;){if(Y.callback===null)r(c);else if(Y.startTime<=W)r(c),Y.sortIndex=Y.expirationTime,e(l,Y);else break;Y=n(c)}}function P(W){if(g=!1,S(W),!v)if(n(l)!==null)v=!0,Le(T);else{var Y=n(c);Y!==null&&Fe(P,Y.startTime-W)}}function T(W,Y){v=!1,g&&(g=!1,b(A),A=-1),p=!0;var le=m;try{for(S(Y),h=n(l);h!==null&&(!(h.expirationTime>Y)||W&&!C());){var pe=h.callback;if(typeof pe=="function"){h.callback=null,m=h.priorityLevel;var fe=pe(h.expirationTime<=Y);Y=t.unstable_now(),typeof fe=="function"?h.callback=fe:h===n(l)&&r(l),S(Y)}else r(l);h=n(l)}if(h!==null)var Ge=!0;else{var Ie=n(c);Ie!==null&&Fe(P,Ie.startTime-Y),Ge=!1}return Ge}finally{h=null,m=le,p=!1}}var N=!1,I=null,A=-1,R=5,k=-1;function C(){return!(t.unstable_now()-k<R)}function L(){if(I!==null){var W=t.unstable_now();k=W;var Y=!0;try{Y=I(!0,W)}finally{Y?O():(N=!1,I=null)}}else N=!1}var O;if(typeof _=="function")O=function(){_(L)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,Ne=X.port2;X.port1.onmessage=L,O=function(){Ne.postMessage(null)}}else O=function(){E(L,0)};function Le(W){I=W,N||(N=!0,O())}function Fe(W,Y){A=E(function(){W(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,Le(T))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(W){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var le=m;m=Y;try{return W()}finally{m=le}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,Y){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var le=m;m=W;try{return Y()}finally{m=le}},t.unstable_scheduleCallback=function(W,Y,le){var pe=t.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?pe+le:pe):le=pe,W){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=le+fe,W={id:u++,callback:Y,priorityLevel:W,startTime:le,expirationTime:fe,sortIndex:-1},le>pe?(W.sortIndex=le,e(c,W),n(l)===null&&W===n(c)&&(g?(b(A),A=-1):g=!0,Fe(P,le-pe))):(W.sortIndex=fe,e(l,W),v||p||(v=!0,Le(T))),W},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(W){var Y=m;return function(){var le=m;m=Y;try{return W.apply(this,arguments)}finally{m=le}}}})($R);UR.exports=$R;var cF=UR.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uF=y,Ms=cF;function me(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var BR=new Set,ef={};function bc(t,e){Fu(t,e),Fu(t+"Capture",e)}function Fu(t,e){for(ef[t]=e,t=0;t<e.length;t++)BR.add(e[t])}var Ao=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),a_=Object.prototype.hasOwnProperty,dF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qI={},HI={};function hF(t){return a_.call(HI,t)?!0:a_.call(qI,t)?!1:dF.test(t)?HI[t]=!0:(qI[t]=!0,!1)}function fF(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function mF(t,e,n,r){if(e===null||typeof e>"u"||fF(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function os(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var $r={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$r[t]=new os(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$r[e]=new os(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$r[t]=new os(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$r[t]=new os(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$r[t]=new os(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$r[t]=new os(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$r[t]=new os(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$r[t]=new os(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$r[t]=new os(t,5,!1,t.toLowerCase(),null,!1,!1)});var yb=/[\-:]([a-z])/g;function vb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(yb,vb);$r[e]=new os(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(yb,vb);$r[e]=new os(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(yb,vb);$r[e]=new os(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$r[t]=new os(t,1,!1,t.toLowerCase(),null,!1,!1)});$r.xlinkHref=new os("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$r[t]=new os(t,1,!1,t.toLowerCase(),null,!0,!0)});function wb(t,e,n,r){var s=$r.hasOwnProperty(e)?$r[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(mF(e,n,s,r)&&(n=null),r||s===null?hF(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var jo=uF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Cm=Symbol.for("react.element"),Jc=Symbol.for("react.portal"),Xc=Symbol.for("react.fragment"),_b=Symbol.for("react.strict_mode"),l_=Symbol.for("react.profiler"),zR=Symbol.for("react.provider"),WR=Symbol.for("react.context"),bb=Symbol.for("react.forward_ref"),c_=Symbol.for("react.suspense"),u_=Symbol.for("react.suspense_list"),Eb=Symbol.for("react.memo"),ia=Symbol.for("react.lazy"),qR=Symbol.for("react.offscreen"),KI=Symbol.iterator;function Zd(t){return t===null||typeof t!="object"?null:(t=KI&&t[KI]||t["@@iterator"],typeof t=="function"?t:null)}var Gn=Object.assign,Gv;function ph(t){if(Gv===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Gv=e&&e[1]||""}return`
`+Gv+t}var Qv=!1;function Yv(t,e){if(!t||Qv)return"";Qv=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Qv=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ph(t):""}function pF(t){switch(t.tag){case 5:return ph(t.type);case 16:return ph("Lazy");case 13:return ph("Suspense");case 19:return ph("SuspenseList");case 0:case 2:case 15:return t=Yv(t.type,!1),t;case 11:return t=Yv(t.type.render,!1),t;case 1:return t=Yv(t.type,!0),t;default:return""}}function d_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xc:return"Fragment";case Jc:return"Portal";case l_:return"Profiler";case _b:return"StrictMode";case c_:return"Suspense";case u_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case WR:return(t.displayName||"Context")+".Consumer";case zR:return(t._context.displayName||"Context")+".Provider";case bb:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Eb:return e=t.displayName||null,e!==null?e:d_(t.type)||"Memo";case ia:e=t._payload,t=t._init;try{return d_(t(e))}catch{}}return null}function gF(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return d_(e);case 8:return e===_b?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Wa(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function HR(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yF(t){var e=HR(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Nm(t){t._valueTracker||(t._valueTracker=yF(t))}function KR(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=HR(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ng(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function h_(t,e){var n=e.checked;return Gn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function GI(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Wa(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function GR(t,e){e=e.checked,e!=null&&wb(t,"checked",e,!1)}function f_(t,e){GR(t,e);var n=Wa(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?m_(t,e.type,n):e.hasOwnProperty("defaultValue")&&m_(t,e.type,Wa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function QI(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function m_(t,e,n){(e!=="number"||ng(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var gh=Array.isArray;function gu(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Wa(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function p_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(me(91));return Gn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function YI(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(me(92));if(gh(n)){if(1<n.length)throw Error(me(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Wa(n)}}function QR(t,e){var n=Wa(e.value),r=Wa(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function JI(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function YR(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function g_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?YR(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var km,JR=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(km=km||document.createElement("div"),km.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=km.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function tf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ph={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vF=["Webkit","ms","Moz","O"];Object.keys(Ph).forEach(function(t){vF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ph[e]=Ph[t]})});function XR(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ph.hasOwnProperty(t)&&Ph[t]?(""+e).trim():e+"px"}function ZR(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=XR(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var wF=Gn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function y_(t,e){if(e){if(wF[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(me(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(me(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(me(61))}if(e.style!=null&&typeof e.style!="object")throw Error(me(62))}}function v_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var w_=null;function Sb(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var __=null,yu=null,vu=null;function XI(t){if(t=Kf(t)){if(typeof __!="function")throw Error(me(280));var e=t.stateNode;e&&(e=Ty(e),__(t.stateNode,t.type,e))}}function eC(t){yu?vu?vu.push(t):vu=[t]:yu=t}function tC(){if(yu){var t=yu,e=vu;if(vu=yu=null,XI(t),e)for(t=0;t<e.length;t++)XI(e[t])}}function nC(t,e){return t(e)}function rC(){}var Jv=!1;function sC(t,e,n){if(Jv)return t(e,n);Jv=!0;try{return nC(t,e,n)}finally{Jv=!1,(yu!==null||vu!==null)&&(rC(),tC())}}function nf(t,e){var n=t.stateNode;if(n===null)return null;var r=Ty(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(me(231,e,typeof n));return n}var b_=!1;if(Ao)try{var eh={};Object.defineProperty(eh,"passive",{get:function(){b_=!0}}),window.addEventListener("test",eh,eh),window.removeEventListener("test",eh,eh)}catch{b_=!1}function _F(t,e,n,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Rh=!1,rg=null,sg=!1,E_=null,bF={onError:function(t){Rh=!0,rg=t}};function EF(t,e,n,r,s,i,o,a,l){Rh=!1,rg=null,_F.apply(bF,arguments)}function SF(t,e,n,r,s,i,o,a,l){if(EF.apply(this,arguments),Rh){if(Rh){var c=rg;Rh=!1,rg=null}else throw Error(me(198));sg||(sg=!0,E_=c)}}function Ec(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function iC(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ZI(t){if(Ec(t)!==t)throw Error(me(188))}function IF(t){var e=t.alternate;if(!e){if(e=Ec(t),e===null)throw Error(me(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return ZI(s),t;if(i===r)return ZI(s),e;i=i.sibling}throw Error(me(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(me(189))}}if(n.alternate!==r)throw Error(me(190))}if(n.tag!==3)throw Error(me(188));return n.stateNode.current===n?t:e}function oC(t){return t=IF(t),t!==null?aC(t):null}function aC(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=aC(t);if(e!==null)return e;t=t.sibling}return null}var lC=Ms.unstable_scheduleCallback,eT=Ms.unstable_cancelCallback,TF=Ms.unstable_shouldYield,xF=Ms.unstable_requestPaint,or=Ms.unstable_now,AF=Ms.unstable_getCurrentPriorityLevel,Ib=Ms.unstable_ImmediatePriority,cC=Ms.unstable_UserBlockingPriority,ig=Ms.unstable_NormalPriority,PF=Ms.unstable_LowPriority,uC=Ms.unstable_IdlePriority,by=null,Hi=null;function RF(t){if(Hi&&typeof Hi.onCommitFiberRoot=="function")try{Hi.onCommitFiberRoot(by,t,void 0,(t.current.flags&128)===128)}catch{}}var hi=Math.clz32?Math.clz32:kF,CF=Math.log,NF=Math.LN2;function kF(t){return t>>>=0,t===0?32:31-(CF(t)/NF|0)|0}var Dm=64,Om=4194304;function yh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function og(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=yh(a):(i&=o,i!==0&&(r=yh(i)))}else o=n&~s,o!==0?r=yh(o):i!==0&&(r=yh(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-hi(e),s=1<<n,r|=t[n],e&=~s;return r}function DF(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function OF(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-hi(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=DF(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function S_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function dC(){var t=Dm;return Dm<<=1,!(Dm&4194240)&&(Dm=64),t}function Xv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function qf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-hi(e),t[e]=n}function LF(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-hi(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Tb(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-hi(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var pn=0;function hC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var fC,xb,mC,pC,gC,I_=!1,Lm=[],Ra=null,Ca=null,Na=null,rf=new Map,sf=new Map,la=[],MF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tT(t,e){switch(t){case"focusin":case"focusout":Ra=null;break;case"dragenter":case"dragleave":Ca=null;break;case"mouseover":case"mouseout":Na=null;break;case"pointerover":case"pointerout":rf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":sf.delete(e.pointerId)}}function th(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Kf(e),e!==null&&xb(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function VF(t,e,n,r,s){switch(e){case"focusin":return Ra=th(Ra,t,e,n,r,s),!0;case"dragenter":return Ca=th(Ca,t,e,n,r,s),!0;case"mouseover":return Na=th(Na,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return rf.set(i,th(rf.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,sf.set(i,th(sf.get(i)||null,t,e,n,r,s)),!0}return!1}function yC(t){var e=Fl(t.target);if(e!==null){var n=Ec(e);if(n!==null){if(e=n.tag,e===13){if(e=iC(n),e!==null){t.blockedOn=e,gC(t.priority,function(){mC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ep(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=T_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);w_=r,n.target.dispatchEvent(r),w_=null}else return e=Kf(n),e!==null&&xb(e),t.blockedOn=n,!1;e.shift()}return!0}function nT(t,e,n){Ep(t)&&n.delete(e)}function jF(){I_=!1,Ra!==null&&Ep(Ra)&&(Ra=null),Ca!==null&&Ep(Ca)&&(Ca=null),Na!==null&&Ep(Na)&&(Na=null),rf.forEach(nT),sf.forEach(nT)}function nh(t,e){t.blockedOn===e&&(t.blockedOn=null,I_||(I_=!0,Ms.unstable_scheduleCallback(Ms.unstable_NormalPriority,jF)))}function of(t){function e(s){return nh(s,t)}if(0<Lm.length){nh(Lm[0],t);for(var n=1;n<Lm.length;n++){var r=Lm[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ra!==null&&nh(Ra,t),Ca!==null&&nh(Ca,t),Na!==null&&nh(Na,t),rf.forEach(e),sf.forEach(e),n=0;n<la.length;n++)r=la[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<la.length&&(n=la[0],n.blockedOn===null);)yC(n),n.blockedOn===null&&la.shift()}var wu=jo.ReactCurrentBatchConfig,ag=!0;function FF(t,e,n,r){var s=pn,i=wu.transition;wu.transition=null;try{pn=1,Ab(t,e,n,r)}finally{pn=s,wu.transition=i}}function UF(t,e,n,r){var s=pn,i=wu.transition;wu.transition=null;try{pn=4,Ab(t,e,n,r)}finally{pn=s,wu.transition=i}}function Ab(t,e,n,r){if(ag){var s=T_(t,e,n,r);if(s===null)lw(t,e,r,lg,n),tT(t,r);else if(VF(s,t,e,n,r))r.stopPropagation();else if(tT(t,r),e&4&&-1<MF.indexOf(t)){for(;s!==null;){var i=Kf(s);if(i!==null&&fC(i),i=T_(t,e,n,r),i===null&&lw(t,e,r,lg,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else lw(t,e,r,null,n)}}var lg=null;function T_(t,e,n,r){if(lg=null,t=Sb(r),t=Fl(t),t!==null)if(e=Ec(t),e===null)t=null;else if(n=e.tag,n===13){if(t=iC(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return lg=t,null}function vC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(AF()){case Ib:return 1;case cC:return 4;case ig:case PF:return 16;case uC:return 536870912;default:return 16}default:return 16}}var Ea=null,Pb=null,Sp=null;function wC(){if(Sp)return Sp;var t,e=Pb,n=e.length,r,s="value"in Ea?Ea.value:Ea.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Sp=s.slice(t,1<r?1-r:void 0)}function Ip(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Mm(){return!0}function rT(){return!1}function Us(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Mm:rT,this.isPropagationStopped=rT,this}return Gn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Mm)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Mm)},persist:function(){},isPersistent:Mm}),e}var xd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rb=Us(xd),Hf=Gn({},xd,{view:0,detail:0}),$F=Us(Hf),Zv,ew,rh,Ey=Gn({},Hf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==rh&&(rh&&t.type==="mousemove"?(Zv=t.screenX-rh.screenX,ew=t.screenY-rh.screenY):ew=Zv=0,rh=t),Zv)},movementY:function(t){return"movementY"in t?t.movementY:ew}}),sT=Us(Ey),BF=Gn({},Ey,{dataTransfer:0}),zF=Us(BF),WF=Gn({},Hf,{relatedTarget:0}),tw=Us(WF),qF=Gn({},xd,{animationName:0,elapsedTime:0,pseudoElement:0}),HF=Us(qF),KF=Gn({},xd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),GF=Us(KF),QF=Gn({},xd,{data:0}),iT=Us(QF),YF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},JF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},XF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ZF(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=XF[t])?!!e[t]:!1}function Cb(){return ZF}var e4=Gn({},Hf,{key:function(t){if(t.key){var e=YF[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ip(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?JF[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cb,charCode:function(t){return t.type==="keypress"?Ip(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ip(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),t4=Us(e4),n4=Gn({},Ey,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oT=Us(n4),r4=Gn({},Hf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cb}),s4=Us(r4),i4=Gn({},xd,{propertyName:0,elapsedTime:0,pseudoElement:0}),o4=Us(i4),a4=Gn({},Ey,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),l4=Us(a4),c4=[9,13,27,32],Nb=Ao&&"CompositionEvent"in window,Ch=null;Ao&&"documentMode"in document&&(Ch=document.documentMode);var u4=Ao&&"TextEvent"in window&&!Ch,_C=Ao&&(!Nb||Ch&&8<Ch&&11>=Ch),aT=" ",lT=!1;function bC(t,e){switch(t){case"keyup":return c4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function EC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Zc=!1;function d4(t,e){switch(t){case"compositionend":return EC(e);case"keypress":return e.which!==32?null:(lT=!0,aT);case"textInput":return t=e.data,t===aT&&lT?null:t;default:return null}}function h4(t,e){if(Zc)return t==="compositionend"||!Nb&&bC(t,e)?(t=wC(),Sp=Pb=Ea=null,Zc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return _C&&e.locale!=="ko"?null:e.data;default:return null}}var f4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!f4[t.type]:e==="textarea"}function SC(t,e,n,r){eC(r),e=cg(e,"onChange"),0<e.length&&(n=new Rb("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Nh=null,af=null;function m4(t){OC(t,0)}function Sy(t){var e=nu(t);if(KR(e))return t}function p4(t,e){if(t==="change")return e}var IC=!1;if(Ao){var nw;if(Ao){var rw="oninput"in document;if(!rw){var uT=document.createElement("div");uT.setAttribute("oninput","return;"),rw=typeof uT.oninput=="function"}nw=rw}else nw=!1;IC=nw&&(!document.documentMode||9<document.documentMode)}function dT(){Nh&&(Nh.detachEvent("onpropertychange",TC),af=Nh=null)}function TC(t){if(t.propertyName==="value"&&Sy(af)){var e=[];SC(e,af,t,Sb(t)),sC(m4,e)}}function g4(t,e,n){t==="focusin"?(dT(),Nh=e,af=n,Nh.attachEvent("onpropertychange",TC)):t==="focusout"&&dT()}function y4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Sy(af)}function v4(t,e){if(t==="click")return Sy(e)}function w4(t,e){if(t==="input"||t==="change")return Sy(e)}function _4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var gi=typeof Object.is=="function"?Object.is:_4;function lf(t,e){if(gi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!a_.call(e,s)||!gi(t[s],e[s]))return!1}return!0}function hT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fT(t,e){var n=hT(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=hT(n)}}function xC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?xC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function AC(){for(var t=window,e=ng();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ng(t.document)}return e}function kb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function b4(t){var e=AC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&xC(n.ownerDocument.documentElement,n)){if(r!==null&&kb(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=fT(n,i);var o=fT(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var E4=Ao&&"documentMode"in document&&11>=document.documentMode,eu=null,x_=null,kh=null,A_=!1;function mT(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;A_||eu==null||eu!==ng(r)||(r=eu,"selectionStart"in r&&kb(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),kh&&lf(kh,r)||(kh=r,r=cg(x_,"onSelect"),0<r.length&&(e=new Rb("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=eu)))}function Vm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var tu={animationend:Vm("Animation","AnimationEnd"),animationiteration:Vm("Animation","AnimationIteration"),animationstart:Vm("Animation","AnimationStart"),transitionend:Vm("Transition","TransitionEnd")},sw={},PC={};Ao&&(PC=document.createElement("div").style,"AnimationEvent"in window||(delete tu.animationend.animation,delete tu.animationiteration.animation,delete tu.animationstart.animation),"TransitionEvent"in window||delete tu.transitionend.transition);function Iy(t){if(sw[t])return sw[t];if(!tu[t])return t;var e=tu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in PC)return sw[t]=e[n];return t}var RC=Iy("animationend"),CC=Iy("animationiteration"),NC=Iy("animationstart"),kC=Iy("transitionend"),DC=new Map,pT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function il(t,e){DC.set(t,e),bc(e,[t])}for(var iw=0;iw<pT.length;iw++){var ow=pT[iw],S4=ow.toLowerCase(),I4=ow[0].toUpperCase()+ow.slice(1);il(S4,"on"+I4)}il(RC,"onAnimationEnd");il(CC,"onAnimationIteration");il(NC,"onAnimationStart");il("dblclick","onDoubleClick");il("focusin","onFocus");il("focusout","onBlur");il(kC,"onTransitionEnd");Fu("onMouseEnter",["mouseout","mouseover"]);Fu("onMouseLeave",["mouseout","mouseover"]);Fu("onPointerEnter",["pointerout","pointerover"]);Fu("onPointerLeave",["pointerout","pointerover"]);bc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bc("onBeforeInput",["compositionend","keypress","textInput","paste"]);bc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),T4=new Set("cancel close invalid load scroll toggle".split(" ").concat(vh));function gT(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,SF(r,e,void 0,t),t.currentTarget=null}function OC(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;gT(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;gT(s,a,c),i=l}}}if(sg)throw t=E_,sg=!1,E_=null,t}function Nn(t,e){var n=e[k_];n===void 0&&(n=e[k_]=new Set);var r=t+"__bubble";n.has(r)||(LC(e,t,2,!1),n.add(r))}function aw(t,e,n){var r=0;e&&(r|=4),LC(n,t,r,e)}var jm="_reactListening"+Math.random().toString(36).slice(2);function cf(t){if(!t[jm]){t[jm]=!0,BR.forEach(function(n){n!=="selectionchange"&&(T4.has(n)||aw(n,!1,t),aw(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[jm]||(e[jm]=!0,aw("selectionchange",!1,e))}}function LC(t,e,n,r){switch(vC(e)){case 1:var s=FF;break;case 4:s=UF;break;default:s=Ab}n=s.bind(null,e,n,t),s=void 0,!b_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function lw(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Fl(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}sC(function(){var c=i,u=Sb(n),h=[];e:{var m=DC.get(t);if(m!==void 0){var p=Rb,v=t;switch(t){case"keypress":if(Ip(n)===0)break e;case"keydown":case"keyup":p=t4;break;case"focusin":v="focus",p=tw;break;case"focusout":v="blur",p=tw;break;case"beforeblur":case"afterblur":p=tw;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=sT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=zF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=s4;break;case RC:case CC:case NC:p=HF;break;case kC:p=o4;break;case"scroll":p=$F;break;case"wheel":p=l4;break;case"copy":case"cut":case"paste":p=GF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=oT}var g=(e&4)!==0,E=!g&&t==="scroll",b=g?m!==null?m+"Capture":null:m;g=[];for(var _=c,S;_!==null;){S=_;var P=S.stateNode;if(S.tag===5&&P!==null&&(S=P,b!==null&&(P=nf(_,b),P!=null&&g.push(uf(_,P,S)))),E)break;_=_.return}0<g.length&&(m=new p(m,v,null,n,u),h.push({event:m,listeners:g}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",m&&n!==w_&&(v=n.relatedTarget||n.fromElement)&&(Fl(v)||v[Po]))break e;if((p||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,p?(v=n.relatedTarget||n.toElement,p=c,v=v?Fl(v):null,v!==null&&(E=Ec(v),v!==E||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=c),p!==v)){if(g=sT,P="onMouseLeave",b="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(g=oT,P="onPointerLeave",b="onPointerEnter",_="pointer"),E=p==null?m:nu(p),S=v==null?m:nu(v),m=new g(P,_+"leave",p,n,u),m.target=E,m.relatedTarget=S,P=null,Fl(u)===c&&(g=new g(b,_+"enter",v,n,u),g.target=S,g.relatedTarget=E,P=g),E=P,p&&v)t:{for(g=p,b=v,_=0,S=g;S;S=Oc(S))_++;for(S=0,P=b;P;P=Oc(P))S++;for(;0<_-S;)g=Oc(g),_--;for(;0<S-_;)b=Oc(b),S--;for(;_--;){if(g===b||b!==null&&g===b.alternate)break t;g=Oc(g),b=Oc(b)}g=null}else g=null;p!==null&&yT(h,m,p,g,!1),v!==null&&E!==null&&yT(h,E,v,g,!0)}}e:{if(m=c?nu(c):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var T=p4;else if(cT(m))if(IC)T=w4;else{T=y4;var N=g4}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(T=v4);if(T&&(T=T(t,c))){SC(h,T,n,u);break e}N&&N(t,m,c),t==="focusout"&&(N=m._wrapperState)&&N.controlled&&m.type==="number"&&m_(m,"number",m.value)}switch(N=c?nu(c):window,t){case"focusin":(cT(N)||N.contentEditable==="true")&&(eu=N,x_=c,kh=null);break;case"focusout":kh=x_=eu=null;break;case"mousedown":A_=!0;break;case"contextmenu":case"mouseup":case"dragend":A_=!1,mT(h,n,u);break;case"selectionchange":if(E4)break;case"keydown":case"keyup":mT(h,n,u)}var I;if(Nb)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Zc?bC(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(_C&&n.locale!=="ko"&&(Zc||A!=="onCompositionStart"?A==="onCompositionEnd"&&Zc&&(I=wC()):(Ea=u,Pb="value"in Ea?Ea.value:Ea.textContent,Zc=!0)),N=cg(c,A),0<N.length&&(A=new iT(A,t,null,n,u),h.push({event:A,listeners:N}),I?A.data=I:(I=EC(n),I!==null&&(A.data=I)))),(I=u4?d4(t,n):h4(t,n))&&(c=cg(c,"onBeforeInput"),0<c.length&&(u=new iT("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:c}),u.data=I))}OC(h,e)})}function uf(t,e,n){return{instance:t,listener:e,currentTarget:n}}function cg(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=nf(t,n),i!=null&&r.unshift(uf(t,i,s)),i=nf(t,e),i!=null&&r.push(uf(t,i,s))),t=t.return}return r}function Oc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function yT(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=nf(n,i),l!=null&&o.unshift(uf(n,l,a))):s||(l=nf(n,i),l!=null&&o.push(uf(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var x4=/\r\n?/g,A4=/\u0000|\uFFFD/g;function vT(t){return(typeof t=="string"?t:""+t).replace(x4,`
`).replace(A4,"")}function Fm(t,e,n){if(e=vT(e),vT(t)!==e&&n)throw Error(me(425))}function ug(){}var P_=null,R_=null;function C_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var N_=typeof setTimeout=="function"?setTimeout:void 0,P4=typeof clearTimeout=="function"?clearTimeout:void 0,wT=typeof Promise=="function"?Promise:void 0,R4=typeof queueMicrotask=="function"?queueMicrotask:typeof wT<"u"?function(t){return wT.resolve(null).then(t).catch(C4)}:N_;function C4(t){setTimeout(function(){throw t})}function cw(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),of(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);of(e)}function ka(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function _T(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ad=Math.random().toString(36).slice(2),Fi="__reactFiber$"+Ad,df="__reactProps$"+Ad,Po="__reactContainer$"+Ad,k_="__reactEvents$"+Ad,N4="__reactListeners$"+Ad,k4="__reactHandles$"+Ad;function Fl(t){var e=t[Fi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Po]||n[Fi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=_T(t);t!==null;){if(n=t[Fi])return n;t=_T(t)}return e}t=n,n=t.parentNode}return null}function Kf(t){return t=t[Fi]||t[Po],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function nu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(me(33))}function Ty(t){return t[df]||null}var D_=[],ru=-1;function ol(t){return{current:t}}function Ln(t){0>ru||(t.current=D_[ru],D_[ru]=null,ru--)}function Tn(t,e){ru++,D_[ru]=t.current,t.current=e}var qa={},Xr=ol(qa),ws=ol(!1),nc=qa;function Uu(t,e){var n=t.type.contextTypes;if(!n)return qa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function _s(t){return t=t.childContextTypes,t!=null}function dg(){Ln(ws),Ln(Xr)}function bT(t,e,n){if(Xr.current!==qa)throw Error(me(168));Tn(Xr,e),Tn(ws,n)}function MC(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(me(108,gF(t)||"Unknown",s));return Gn({},n,r)}function hg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qa,nc=Xr.current,Tn(Xr,t),Tn(ws,ws.current),!0}function ET(t,e,n){var r=t.stateNode;if(!r)throw Error(me(169));n?(t=MC(t,e,nc),r.__reactInternalMemoizedMergedChildContext=t,Ln(ws),Ln(Xr),Tn(Xr,t)):Ln(ws),Tn(ws,n)}var fo=null,xy=!1,uw=!1;function VC(t){fo===null?fo=[t]:fo.push(t)}function D4(t){xy=!0,VC(t)}function al(){if(!uw&&fo!==null){uw=!0;var t=0,e=pn;try{var n=fo;for(pn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}fo=null,xy=!1}catch(s){throw fo!==null&&(fo=fo.slice(t+1)),lC(Ib,al),s}finally{pn=e,uw=!1}}return null}var su=[],iu=0,fg=null,mg=0,Ws=[],qs=0,rc=null,go=1,yo="";function Il(t,e){su[iu++]=mg,su[iu++]=fg,fg=t,mg=e}function jC(t,e,n){Ws[qs++]=go,Ws[qs++]=yo,Ws[qs++]=rc,rc=t;var r=go;t=yo;var s=32-hi(r)-1;r&=~(1<<s),n+=1;var i=32-hi(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,go=1<<32-hi(e)+s|n<<s|r,yo=i+t}else go=1<<i|n<<s|r,yo=t}function Db(t){t.return!==null&&(Il(t,1),jC(t,1,0))}function Ob(t){for(;t===fg;)fg=su[--iu],su[iu]=null,mg=su[--iu],su[iu]=null;for(;t===rc;)rc=Ws[--qs],Ws[qs]=null,yo=Ws[--qs],Ws[qs]=null,go=Ws[--qs],Ws[qs]=null}var ks=null,Cs=null,Fn=!1,ci=null;function FC(t,e){var n=Ks(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ST(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ks=t,Cs=ka(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ks=t,Cs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=rc!==null?{id:go,overflow:yo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ks(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ks=t,Cs=null,!0):!1;default:return!1}}function O_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function L_(t){if(Fn){var e=Cs;if(e){var n=e;if(!ST(t,e)){if(O_(t))throw Error(me(418));e=ka(n.nextSibling);var r=ks;e&&ST(t,e)?FC(r,n):(t.flags=t.flags&-4097|2,Fn=!1,ks=t)}}else{if(O_(t))throw Error(me(418));t.flags=t.flags&-4097|2,Fn=!1,ks=t}}}function IT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ks=t}function Um(t){if(t!==ks)return!1;if(!Fn)return IT(t),Fn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!C_(t.type,t.memoizedProps)),e&&(e=Cs)){if(O_(t))throw UC(),Error(me(418));for(;e;)FC(t,e),e=ka(e.nextSibling)}if(IT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(me(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Cs=ka(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Cs=null}}else Cs=ks?ka(t.stateNode.nextSibling):null;return!0}function UC(){for(var t=Cs;t;)t=ka(t.nextSibling)}function $u(){Cs=ks=null,Fn=!1}function Lb(t){ci===null?ci=[t]:ci.push(t)}var O4=jo.ReactCurrentBatchConfig;function sh(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(me(309));var r=n.stateNode}if(!r)throw Error(me(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(me(284));if(!n._owner)throw Error(me(290,t))}return t}function $m(t,e){throw t=Object.prototype.toString.call(e),Error(me(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function TT(t){var e=t._init;return e(t._payload)}function $C(t){function e(b,_){if(t){var S=b.deletions;S===null?(b.deletions=[_],b.flags|=16):S.push(_)}}function n(b,_){if(!t)return null;for(;_!==null;)e(b,_),_=_.sibling;return null}function r(b,_){for(b=new Map;_!==null;)_.key!==null?b.set(_.key,_):b.set(_.index,_),_=_.sibling;return b}function s(b,_){return b=Ma(b,_),b.index=0,b.sibling=null,b}function i(b,_,S){return b.index=S,t?(S=b.alternate,S!==null?(S=S.index,S<_?(b.flags|=2,_):S):(b.flags|=2,_)):(b.flags|=1048576,_)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function a(b,_,S,P){return _===null||_.tag!==6?(_=yw(S,b.mode,P),_.return=b,_):(_=s(_,S),_.return=b,_)}function l(b,_,S,P){var T=S.type;return T===Xc?u(b,_,S.props.children,P,S.key):_!==null&&(_.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ia&&TT(T)===_.type)?(P=s(_,S.props),P.ref=sh(b,_,S),P.return=b,P):(P=Np(S.type,S.key,S.props,null,b.mode,P),P.ref=sh(b,_,S),P.return=b,P)}function c(b,_,S,P){return _===null||_.tag!==4||_.stateNode.containerInfo!==S.containerInfo||_.stateNode.implementation!==S.implementation?(_=vw(S,b.mode,P),_.return=b,_):(_=s(_,S.children||[]),_.return=b,_)}function u(b,_,S,P,T){return _===null||_.tag!==7?(_=Yl(S,b.mode,P,T),_.return=b,_):(_=s(_,S),_.return=b,_)}function h(b,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return _=yw(""+_,b.mode,S),_.return=b,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Cm:return S=Np(_.type,_.key,_.props,null,b.mode,S),S.ref=sh(b,null,_),S.return=b,S;case Jc:return _=vw(_,b.mode,S),_.return=b,_;case ia:var P=_._init;return h(b,P(_._payload),S)}if(gh(_)||Zd(_))return _=Yl(_,b.mode,S,null),_.return=b,_;$m(b,_)}return null}function m(b,_,S,P){var T=_!==null?_.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return T!==null?null:a(b,_,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Cm:return S.key===T?l(b,_,S,P):null;case Jc:return S.key===T?c(b,_,S,P):null;case ia:return T=S._init,m(b,_,T(S._payload),P)}if(gh(S)||Zd(S))return T!==null?null:u(b,_,S,P,null);$m(b,S)}return null}function p(b,_,S,P,T){if(typeof P=="string"&&P!==""||typeof P=="number")return b=b.get(S)||null,a(_,b,""+P,T);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Cm:return b=b.get(P.key===null?S:P.key)||null,l(_,b,P,T);case Jc:return b=b.get(P.key===null?S:P.key)||null,c(_,b,P,T);case ia:var N=P._init;return p(b,_,S,N(P._payload),T)}if(gh(P)||Zd(P))return b=b.get(S)||null,u(_,b,P,T,null);$m(_,P)}return null}function v(b,_,S,P){for(var T=null,N=null,I=_,A=_=0,R=null;I!==null&&A<S.length;A++){I.index>A?(R=I,I=null):R=I.sibling;var k=m(b,I,S[A],P);if(k===null){I===null&&(I=R);break}t&&I&&k.alternate===null&&e(b,I),_=i(k,_,A),N===null?T=k:N.sibling=k,N=k,I=R}if(A===S.length)return n(b,I),Fn&&Il(b,A),T;if(I===null){for(;A<S.length;A++)I=h(b,S[A],P),I!==null&&(_=i(I,_,A),N===null?T=I:N.sibling=I,N=I);return Fn&&Il(b,A),T}for(I=r(b,I);A<S.length;A++)R=p(I,b,A,S[A],P),R!==null&&(t&&R.alternate!==null&&I.delete(R.key===null?A:R.key),_=i(R,_,A),N===null?T=R:N.sibling=R,N=R);return t&&I.forEach(function(C){return e(b,C)}),Fn&&Il(b,A),T}function g(b,_,S,P){var T=Zd(S);if(typeof T!="function")throw Error(me(150));if(S=T.call(S),S==null)throw Error(me(151));for(var N=T=null,I=_,A=_=0,R=null,k=S.next();I!==null&&!k.done;A++,k=S.next()){I.index>A?(R=I,I=null):R=I.sibling;var C=m(b,I,k.value,P);if(C===null){I===null&&(I=R);break}t&&I&&C.alternate===null&&e(b,I),_=i(C,_,A),N===null?T=C:N.sibling=C,N=C,I=R}if(k.done)return n(b,I),Fn&&Il(b,A),T;if(I===null){for(;!k.done;A++,k=S.next())k=h(b,k.value,P),k!==null&&(_=i(k,_,A),N===null?T=k:N.sibling=k,N=k);return Fn&&Il(b,A),T}for(I=r(b,I);!k.done;A++,k=S.next())k=p(I,b,A,k.value,P),k!==null&&(t&&k.alternate!==null&&I.delete(k.key===null?A:k.key),_=i(k,_,A),N===null?T=k:N.sibling=k,N=k);return t&&I.forEach(function(L){return e(b,L)}),Fn&&Il(b,A),T}function E(b,_,S,P){if(typeof S=="object"&&S!==null&&S.type===Xc&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Cm:e:{for(var T=S.key,N=_;N!==null;){if(N.key===T){if(T=S.type,T===Xc){if(N.tag===7){n(b,N.sibling),_=s(N,S.props.children),_.return=b,b=_;break e}}else if(N.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ia&&TT(T)===N.type){n(b,N.sibling),_=s(N,S.props),_.ref=sh(b,N,S),_.return=b,b=_;break e}n(b,N);break}else e(b,N);N=N.sibling}S.type===Xc?(_=Yl(S.props.children,b.mode,P,S.key),_.return=b,b=_):(P=Np(S.type,S.key,S.props,null,b.mode,P),P.ref=sh(b,_,S),P.return=b,b=P)}return o(b);case Jc:e:{for(N=S.key;_!==null;){if(_.key===N)if(_.tag===4&&_.stateNode.containerInfo===S.containerInfo&&_.stateNode.implementation===S.implementation){n(b,_.sibling),_=s(_,S.children||[]),_.return=b,b=_;break e}else{n(b,_);break}else e(b,_);_=_.sibling}_=vw(S,b.mode,P),_.return=b,b=_}return o(b);case ia:return N=S._init,E(b,_,N(S._payload),P)}if(gh(S))return v(b,_,S,P);if(Zd(S))return g(b,_,S,P);$m(b,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,_!==null&&_.tag===6?(n(b,_.sibling),_=s(_,S),_.return=b,b=_):(n(b,_),_=yw(S,b.mode,P),_.return=b,b=_),o(b)):n(b,_)}return E}var Bu=$C(!0),BC=$C(!1),pg=ol(null),gg=null,ou=null,Mb=null;function Vb(){Mb=ou=gg=null}function jb(t){var e=pg.current;Ln(pg),t._currentValue=e}function M_(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function _u(t,e){gg=t,Mb=ou=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ms=!0),t.firstContext=null)}function Js(t){var e=t._currentValue;if(Mb!==t)if(t={context:t,memoizedValue:e,next:null},ou===null){if(gg===null)throw Error(me(308));ou=t,gg.dependencies={lanes:0,firstContext:t}}else ou=ou.next=t;return e}var Ul=null;function Fb(t){Ul===null?Ul=[t]:Ul.push(t)}function zC(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Fb(e)):(n.next=s.next,s.next=n),e.interleaved=n,Ro(t,r)}function Ro(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var oa=!1;function Ub(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function WC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function So(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Da(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,tn&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Ro(t,n)}return s=r.interleaved,s===null?(e.next=e,Fb(r)):(e.next=s.next,s.next=e),r.interleaved=e,Ro(t,n)}function Tp(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Tb(t,n)}}function xT(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function yg(t,e,n,r){var s=t.updateQueue;oa=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,u=c=l=null,a=i;do{var m=a.lane,p=a.eventTime;if((r&m)===m){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=t,g=a;switch(m=e,p=n,g.tag){case 1:if(v=g.payload,typeof v=="function"){h=v.call(p,h,m);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,m=typeof v=="function"?v.call(p,h,m):v,m==null)break e;h=Gn({},h,m);break e;case 2:oa=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else p={eventTime:p,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ic|=o,t.lanes=o,t.memoizedState=h}}function AT(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(me(191,s));s.call(r)}}}var Gf={},Ki=ol(Gf),hf=ol(Gf),ff=ol(Gf);function $l(t){if(t===Gf)throw Error(me(174));return t}function $b(t,e){switch(Tn(ff,e),Tn(hf,t),Tn(Ki,Gf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:g_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=g_(e,t)}Ln(Ki),Tn(Ki,e)}function zu(){Ln(Ki),Ln(hf),Ln(ff)}function qC(t){$l(ff.current);var e=$l(Ki.current),n=g_(e,t.type);e!==n&&(Tn(hf,t),Tn(Ki,n))}function Bb(t){hf.current===t&&(Ln(Ki),Ln(hf))}var qn=ol(0);function vg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dw=[];function zb(){for(var t=0;t<dw.length;t++)dw[t]._workInProgressVersionPrimary=null;dw.length=0}var xp=jo.ReactCurrentDispatcher,hw=jo.ReactCurrentBatchConfig,sc=0,Kn=null,yr=null,Rr=null,wg=!1,Dh=!1,mf=0,L4=0;function Wr(){throw Error(me(321))}function Wb(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!gi(t[n],e[n]))return!1;return!0}function qb(t,e,n,r,s,i){if(sc=i,Kn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xp.current=t===null||t.memoizedState===null?F4:U4,t=n(r,s),Dh){i=0;do{if(Dh=!1,mf=0,25<=i)throw Error(me(301));i+=1,Rr=yr=null,e.updateQueue=null,xp.current=$4,t=n(r,s)}while(Dh)}if(xp.current=_g,e=yr!==null&&yr.next!==null,sc=0,Rr=yr=Kn=null,wg=!1,e)throw Error(me(300));return t}function Hb(){var t=mf!==0;return mf=0,t}function ki(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rr===null?Kn.memoizedState=Rr=t:Rr=Rr.next=t,Rr}function Xs(){if(yr===null){var t=Kn.alternate;t=t!==null?t.memoizedState:null}else t=yr.next;var e=Rr===null?Kn.memoizedState:Rr.next;if(e!==null)Rr=e,yr=t;else{if(t===null)throw Error(me(310));yr=t,t={memoizedState:yr.memoizedState,baseState:yr.baseState,baseQueue:yr.baseQueue,queue:yr.queue,next:null},Rr===null?Kn.memoizedState=Rr=t:Rr=Rr.next=t}return Rr}function pf(t,e){return typeof e=="function"?e(t):e}function fw(t){var e=Xs(),n=e.queue;if(n===null)throw Error(me(311));n.lastRenderedReducer=t;var r=yr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((sc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,Kn.lanes|=u,ic|=u}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,gi(r,e.memoizedState)||(ms=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Kn.lanes|=i,ic|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function mw(t){var e=Xs(),n=e.queue;if(n===null)throw Error(me(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);gi(i,e.memoizedState)||(ms=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function HC(){}function KC(t,e){var n=Kn,r=Xs(),s=e(),i=!gi(r.memoizedState,s);if(i&&(r.memoizedState=s,ms=!0),r=r.queue,Kb(YC.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Rr!==null&&Rr.memoizedState.tag&1){if(n.flags|=2048,gf(9,QC.bind(null,n,r,s,e),void 0,null),Nr===null)throw Error(me(349));sc&30||GC(n,e,s)}return s}function GC(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Kn.updateQueue,e===null?(e={lastEffect:null,stores:null},Kn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function QC(t,e,n,r){e.value=n,e.getSnapshot=r,JC(e)&&XC(t)}function YC(t,e,n){return n(function(){JC(e)&&XC(t)})}function JC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!gi(t,n)}catch{return!0}}function XC(t){var e=Ro(t,1);e!==null&&fi(e,t,1,-1)}function PT(t){var e=ki();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pf,lastRenderedState:t},e.queue=t,t=t.dispatch=j4.bind(null,Kn,t),[e.memoizedState,t]}function gf(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Kn.updateQueue,e===null?(e={lastEffect:null,stores:null},Kn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function ZC(){return Xs().memoizedState}function Ap(t,e,n,r){var s=ki();Kn.flags|=t,s.memoizedState=gf(1|e,n,void 0,r===void 0?null:r)}function Ay(t,e,n,r){var s=Xs();r=r===void 0?null:r;var i=void 0;if(yr!==null){var o=yr.memoizedState;if(i=o.destroy,r!==null&&Wb(r,o.deps)){s.memoizedState=gf(e,n,i,r);return}}Kn.flags|=t,s.memoizedState=gf(1|e,n,i,r)}function RT(t,e){return Ap(8390656,8,t,e)}function Kb(t,e){return Ay(2048,8,t,e)}function eN(t,e){return Ay(4,2,t,e)}function tN(t,e){return Ay(4,4,t,e)}function nN(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function rN(t,e,n){return n=n!=null?n.concat([t]):null,Ay(4,4,nN.bind(null,e,t),n)}function Gb(){}function sN(t,e){var n=Xs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wb(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function iN(t,e){var n=Xs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wb(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function oN(t,e,n){return sc&21?(gi(n,e)||(n=dC(),Kn.lanes|=n,ic|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ms=!0),t.memoizedState=n)}function M4(t,e){var n=pn;pn=n!==0&&4>n?n:4,t(!0);var r=hw.transition;hw.transition={};try{t(!1),e()}finally{pn=n,hw.transition=r}}function aN(){return Xs().memoizedState}function V4(t,e,n){var r=La(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},lN(t))cN(e,n);else if(n=zC(t,e,n,r),n!==null){var s=ss();fi(n,t,r,s),uN(n,e,r)}}function j4(t,e,n){var r=La(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(lN(t))cN(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,gi(a,o)){var l=e.interleaved;l===null?(s.next=s,Fb(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=zC(t,e,s,r),n!==null&&(s=ss(),fi(n,t,r,s),uN(n,e,r))}}function lN(t){var e=t.alternate;return t===Kn||e!==null&&e===Kn}function cN(t,e){Dh=wg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function uN(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Tb(t,n)}}var _g={readContext:Js,useCallback:Wr,useContext:Wr,useEffect:Wr,useImperativeHandle:Wr,useInsertionEffect:Wr,useLayoutEffect:Wr,useMemo:Wr,useReducer:Wr,useRef:Wr,useState:Wr,useDebugValue:Wr,useDeferredValue:Wr,useTransition:Wr,useMutableSource:Wr,useSyncExternalStore:Wr,useId:Wr,unstable_isNewReconciler:!1},F4={readContext:Js,useCallback:function(t,e){return ki().memoizedState=[t,e===void 0?null:e],t},useContext:Js,useEffect:RT,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ap(4194308,4,nN.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ap(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ap(4,2,t,e)},useMemo:function(t,e){var n=ki();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ki();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=V4.bind(null,Kn,t),[r.memoizedState,t]},useRef:function(t){var e=ki();return t={current:t},e.memoizedState=t},useState:PT,useDebugValue:Gb,useDeferredValue:function(t){return ki().memoizedState=t},useTransition:function(){var t=PT(!1),e=t[0];return t=M4.bind(null,t[1]),ki().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Kn,s=ki();if(Fn){if(n===void 0)throw Error(me(407));n=n()}else{if(n=e(),Nr===null)throw Error(me(349));sc&30||GC(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,RT(YC.bind(null,r,i,t),[t]),r.flags|=2048,gf(9,QC.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=ki(),e=Nr.identifierPrefix;if(Fn){var n=yo,r=go;n=(r&~(1<<32-hi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=mf++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=L4++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},U4={readContext:Js,useCallback:sN,useContext:Js,useEffect:Kb,useImperativeHandle:rN,useInsertionEffect:eN,useLayoutEffect:tN,useMemo:iN,useReducer:fw,useRef:ZC,useState:function(){return fw(pf)},useDebugValue:Gb,useDeferredValue:function(t){var e=Xs();return oN(e,yr.memoizedState,t)},useTransition:function(){var t=fw(pf)[0],e=Xs().memoizedState;return[t,e]},useMutableSource:HC,useSyncExternalStore:KC,useId:aN,unstable_isNewReconciler:!1},$4={readContext:Js,useCallback:sN,useContext:Js,useEffect:Kb,useImperativeHandle:rN,useInsertionEffect:eN,useLayoutEffect:tN,useMemo:iN,useReducer:mw,useRef:ZC,useState:function(){return mw(pf)},useDebugValue:Gb,useDeferredValue:function(t){var e=Xs();return yr===null?e.memoizedState=t:oN(e,yr.memoizedState,t)},useTransition:function(){var t=mw(pf)[0],e=Xs().memoizedState;return[t,e]},useMutableSource:HC,useSyncExternalStore:KC,useId:aN,unstable_isNewReconciler:!1};function si(t,e){if(t&&t.defaultProps){e=Gn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function V_(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Gn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Py={isMounted:function(t){return(t=t._reactInternals)?Ec(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ss(),s=La(t),i=So(r,s);i.payload=e,n!=null&&(i.callback=n),e=Da(t,i,s),e!==null&&(fi(e,t,s,r),Tp(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ss(),s=La(t),i=So(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Da(t,i,s),e!==null&&(fi(e,t,s,r),Tp(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ss(),r=La(t),s=So(n,r);s.tag=2,e!=null&&(s.callback=e),e=Da(t,s,r),e!==null&&(fi(e,t,r,n),Tp(e,t,r))}};function CT(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!lf(n,r)||!lf(s,i):!0}function dN(t,e,n){var r=!1,s=qa,i=e.contextType;return typeof i=="object"&&i!==null?i=Js(i):(s=_s(e)?nc:Xr.current,r=e.contextTypes,i=(r=r!=null)?Uu(t,s):qa),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Py,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function NT(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Py.enqueueReplaceState(e,e.state,null)}function j_(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Ub(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Js(i):(i=_s(e)?nc:Xr.current,s.context=Uu(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(V_(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Py.enqueueReplaceState(s,s.state,null),yg(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Wu(t,e){try{var n="",r=e;do n+=pF(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function pw(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function F_(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var B4=typeof WeakMap=="function"?WeakMap:Map;function hN(t,e,n){n=So(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Eg||(Eg=!0,Q_=r),F_(t,e)},n}function fN(t,e,n){n=So(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){F_(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){F_(t,e),typeof r!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function kT(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new B4;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=nU.bind(null,t,e,n),e.then(t,t))}function DT(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function OT(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=So(-1,1),e.tag=2,Da(n,e,1))),n.lanes|=1),t)}var z4=jo.ReactCurrentOwner,ms=!1;function ts(t,e,n,r){e.child=t===null?BC(e,null,n,r):Bu(e,t.child,n,r)}function LT(t,e,n,r,s){n=n.render;var i=e.ref;return _u(e,s),r=qb(t,e,n,r,i,s),n=Hb(),t!==null&&!ms?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Co(t,e,s)):(Fn&&n&&Db(e),e.flags|=1,ts(t,e,r,s),e.child)}function MT(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!nE(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,mN(t,e,i,r,s)):(t=Np(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:lf,n(o,r)&&t.ref===e.ref)return Co(t,e,s)}return e.flags|=1,t=Ma(i,r),t.ref=e.ref,t.return=e,e.child=t}function mN(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(lf(i,r)&&t.ref===e.ref)if(ms=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(ms=!0);else return e.lanes=t.lanes,Co(t,e,s)}return U_(t,e,n,r,s)}function pN(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tn(lu,xs),xs|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Tn(lu,xs),xs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Tn(lu,xs),xs|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Tn(lu,xs),xs|=r;return ts(t,e,s,n),e.child}function gN(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function U_(t,e,n,r,s){var i=_s(n)?nc:Xr.current;return i=Uu(e,i),_u(e,s),n=qb(t,e,n,r,i,s),r=Hb(),t!==null&&!ms?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Co(t,e,s)):(Fn&&r&&Db(e),e.flags|=1,ts(t,e,n,s),e.child)}function VT(t,e,n,r,s){if(_s(n)){var i=!0;hg(e)}else i=!1;if(_u(e,s),e.stateNode===null)Pp(t,e),dN(e,n,r),j_(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Js(c):(c=_s(n)?nc:Xr.current,c=Uu(e,c));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&NT(e,o,r,c),oa=!1;var m=e.memoizedState;o.state=m,yg(e,r,o,s),l=e.memoizedState,a!==r||m!==l||ws.current||oa?(typeof u=="function"&&(V_(e,n,u,r),l=e.memoizedState),(a=oa||CT(e,n,a,r,m,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,WC(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:si(e.type,a),o.props=c,h=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Js(l):(l=_s(n)?nc:Xr.current,l=Uu(e,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||m!==l)&&NT(e,o,r,l),oa=!1,m=e.memoizedState,o.state=m,yg(e,r,o,s);var v=e.memoizedState;a!==h||m!==v||ws.current||oa?(typeof p=="function"&&(V_(e,n,p,r),v=e.memoizedState),(c=oa||CT(e,n,c,r,m,v,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),o.props=r,o.state=v,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return $_(t,e,n,r,i,s)}function $_(t,e,n,r,s,i){gN(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&ET(e,n,!1),Co(t,e,i);r=e.stateNode,z4.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Bu(e,t.child,null,i),e.child=Bu(e,null,a,i)):ts(t,e,a,i),e.memoizedState=r.state,s&&ET(e,n,!0),e.child}function yN(t){var e=t.stateNode;e.pendingContext?bT(t,e.pendingContext,e.pendingContext!==e.context):e.context&&bT(t,e.context,!1),$b(t,e.containerInfo)}function jT(t,e,n,r,s){return $u(),Lb(s),e.flags|=256,ts(t,e,n,r),e.child}var B_={dehydrated:null,treeContext:null,retryLane:0};function z_(t){return{baseLanes:t,cachePool:null,transitions:null}}function vN(t,e,n){var r=e.pendingProps,s=qn.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Tn(qn,s&1),t===null)return L_(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Ny(o,r,0,null),t=Yl(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=z_(n),e.memoizedState=B_,t):Qb(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return W4(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ma(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Ma(a,i):(i=Yl(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?z_(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=B_,r}return i=t.child,t=i.sibling,r=Ma(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Qb(t,e){return e=Ny({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Bm(t,e,n,r){return r!==null&&Lb(r),Bu(e,t.child,null,n),t=Qb(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function W4(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=pw(Error(me(422))),Bm(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Ny({mode:"visible",children:r.children},s,0,null),i=Yl(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Bu(e,t.child,null,o),e.child.memoizedState=z_(o),e.memoizedState=B_,i);if(!(e.mode&1))return Bm(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(me(419)),r=pw(i,r,void 0),Bm(t,e,o,r)}if(a=(o&t.childLanes)!==0,ms||a){if(r=Nr,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Ro(t,s),fi(r,t,s,-1))}return tE(),r=pw(Error(me(421))),Bm(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=rU.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Cs=ka(s.nextSibling),ks=e,Fn=!0,ci=null,t!==null&&(Ws[qs++]=go,Ws[qs++]=yo,Ws[qs++]=rc,go=t.id,yo=t.overflow,rc=e),e=Qb(e,r.children),e.flags|=4096,e)}function FT(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),M_(t.return,e,n)}function gw(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function wN(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(ts(t,e,r.children,n),r=qn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&FT(t,n,e);else if(t.tag===19)FT(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Tn(qn,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&vg(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),gw(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&vg(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}gw(e,!0,n,null,i);break;case"together":gw(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Pp(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Co(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ic|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(me(153));if(e.child!==null){for(t=e.child,n=Ma(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ma(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function q4(t,e,n){switch(e.tag){case 3:yN(e),$u();break;case 5:qC(e);break;case 1:_s(e.type)&&hg(e);break;case 4:$b(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Tn(pg,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Tn(qn,qn.current&1),e.flags|=128,null):n&e.child.childLanes?vN(t,e,n):(Tn(qn,qn.current&1),t=Co(t,e,n),t!==null?t.sibling:null);Tn(qn,qn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return wN(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Tn(qn,qn.current),r)break;return null;case 22:case 23:return e.lanes=0,pN(t,e,n)}return Co(t,e,n)}var _N,W_,bN,EN;_N=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};W_=function(){};bN=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,$l(Ki.current);var i=null;switch(n){case"input":s=h_(t,s),r=h_(t,r),i=[];break;case"select":s=Gn({},s,{value:void 0}),r=Gn({},r,{value:void 0}),i=[];break;case"textarea":s=p_(t,s),r=p_(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ug)}y_(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ef.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ef.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Nn("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};EN=function(t,e,n,r){n!==r&&(e.flags|=4)};function ih(t,e){if(!Fn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function qr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function H4(t,e,n){var r=e.pendingProps;switch(Ob(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qr(e),null;case 1:return _s(e.type)&&dg(),qr(e),null;case 3:return r=e.stateNode,zu(),Ln(ws),Ln(Xr),zb(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Um(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ci!==null&&(X_(ci),ci=null))),W_(t,e),qr(e),null;case 5:Bb(e);var s=$l(ff.current);if(n=e.type,t!==null&&e.stateNode!=null)bN(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(me(166));return qr(e),null}if(t=$l(Ki.current),Um(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Fi]=e,r[df]=i,t=(e.mode&1)!==0,n){case"dialog":Nn("cancel",r),Nn("close",r);break;case"iframe":case"object":case"embed":Nn("load",r);break;case"video":case"audio":for(s=0;s<vh.length;s++)Nn(vh[s],r);break;case"source":Nn("error",r);break;case"img":case"image":case"link":Nn("error",r),Nn("load",r);break;case"details":Nn("toggle",r);break;case"input":GI(r,i),Nn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Nn("invalid",r);break;case"textarea":YI(r,i),Nn("invalid",r)}y_(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Fm(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Fm(r.textContent,a,t),s=["children",""+a]):ef.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Nn("scroll",r)}switch(n){case"input":Nm(r),QI(r,i,!0);break;case"textarea":Nm(r),JI(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ug)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=YR(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Fi]=e,t[df]=r,_N(t,e,!1,!1),e.stateNode=t;e:{switch(o=v_(n,r),n){case"dialog":Nn("cancel",t),Nn("close",t),s=r;break;case"iframe":case"object":case"embed":Nn("load",t),s=r;break;case"video":case"audio":for(s=0;s<vh.length;s++)Nn(vh[s],t);s=r;break;case"source":Nn("error",t),s=r;break;case"img":case"image":case"link":Nn("error",t),Nn("load",t),s=r;break;case"details":Nn("toggle",t),s=r;break;case"input":GI(t,r),s=h_(t,r),Nn("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Gn({},r,{value:void 0}),Nn("invalid",t);break;case"textarea":YI(t,r),s=p_(t,r),Nn("invalid",t);break;default:s=r}y_(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?ZR(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&JR(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&tf(t,l):typeof l=="number"&&tf(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ef.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Nn("scroll",t):l!=null&&wb(t,i,l,o))}switch(n){case"input":Nm(t),QI(t,r,!1);break;case"textarea":Nm(t),JI(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Wa(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?gu(t,!!r.multiple,i,!1):r.defaultValue!=null&&gu(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=ug)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return qr(e),null;case 6:if(t&&e.stateNode!=null)EN(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(me(166));if(n=$l(ff.current),$l(Ki.current),Um(e)){if(r=e.stateNode,n=e.memoizedProps,r[Fi]=e,(i=r.nodeValue!==n)&&(t=ks,t!==null))switch(t.tag){case 3:Fm(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Fm(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Fi]=e,e.stateNode=r}return qr(e),null;case 13:if(Ln(qn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Fn&&Cs!==null&&e.mode&1&&!(e.flags&128))UC(),$u(),e.flags|=98560,i=!1;else if(i=Um(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(me(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(me(317));i[Fi]=e}else $u(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;qr(e),i=!1}else ci!==null&&(X_(ci),ci=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||qn.current&1?wr===0&&(wr=3):tE())),e.updateQueue!==null&&(e.flags|=4),qr(e),null);case 4:return zu(),W_(t,e),t===null&&cf(e.stateNode.containerInfo),qr(e),null;case 10:return jb(e.type._context),qr(e),null;case 17:return _s(e.type)&&dg(),qr(e),null;case 19:if(Ln(qn),i=e.memoizedState,i===null)return qr(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ih(i,!1);else{if(wr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=vg(t),o!==null){for(e.flags|=128,ih(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Tn(qn,qn.current&1|2),e.child}t=t.sibling}i.tail!==null&&or()>qu&&(e.flags|=128,r=!0,ih(i,!1),e.lanes=4194304)}else{if(!r)if(t=vg(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ih(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Fn)return qr(e),null}else 2*or()-i.renderingStartTime>qu&&n!==1073741824&&(e.flags|=128,r=!0,ih(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=or(),e.sibling=null,n=qn.current,Tn(qn,r?n&1|2:n&1),e):(qr(e),null);case 22:case 23:return eE(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?xs&1073741824&&(qr(e),e.subtreeFlags&6&&(e.flags|=8192)):qr(e),null;case 24:return null;case 25:return null}throw Error(me(156,e.tag))}function K4(t,e){switch(Ob(e),e.tag){case 1:return _s(e.type)&&dg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return zu(),Ln(ws),Ln(Xr),zb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Bb(e),null;case 13:if(Ln(qn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(me(340));$u()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ln(qn),null;case 4:return zu(),null;case 10:return jb(e.type._context),null;case 22:case 23:return eE(),null;case 24:return null;default:return null}}var zm=!1,Qr=!1,G4=typeof WeakSet=="function"?WeakSet:Set,We=null;function au(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){rr(t,e,r)}else n.current=null}function q_(t,e,n){try{n()}catch(r){rr(t,e,r)}}var UT=!1;function Q4(t,e){if(P_=ag,t=AC(),kb(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=t,m=null;t:for(;;){for(var p;h!==n||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)m=h,h=p;for(;;){if(h===t)break t;if(m===n&&++c===s&&(a=o),m===i&&++u===r&&(l=o),(p=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(R_={focusedElem:t,selectionRange:n},ag=!1,We=e;We!==null;)if(e=We,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,We=t;else for(;We!==null;){e=We;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,E=v.memoizedState,b=e.stateNode,_=b.getSnapshotBeforeUpdate(e.elementType===e.type?g:si(e.type,g),E);b.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(me(163))}}catch(P){rr(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,We=t;break}We=e.return}return v=UT,UT=!1,v}function Oh(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&q_(e,n,i)}s=s.next}while(s!==r)}}function Ry(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function H_(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function SN(t){var e=t.alternate;e!==null&&(t.alternate=null,SN(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Fi],delete e[df],delete e[k_],delete e[N4],delete e[k4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function IN(t){return t.tag===5||t.tag===3||t.tag===4}function $T(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||IN(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function K_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ug));else if(r!==4&&(t=t.child,t!==null))for(K_(t,e,n),t=t.sibling;t!==null;)K_(t,e,n),t=t.sibling}function G_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(G_(t,e,n),t=t.sibling;t!==null;)G_(t,e,n),t=t.sibling}var Mr=null,ai=!1;function Ko(t,e,n){for(n=n.child;n!==null;)TN(t,e,n),n=n.sibling}function TN(t,e,n){if(Hi&&typeof Hi.onCommitFiberUnmount=="function")try{Hi.onCommitFiberUnmount(by,n)}catch{}switch(n.tag){case 5:Qr||au(n,e);case 6:var r=Mr,s=ai;Mr=null,Ko(t,e,n),Mr=r,ai=s,Mr!==null&&(ai?(t=Mr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mr.removeChild(n.stateNode));break;case 18:Mr!==null&&(ai?(t=Mr,n=n.stateNode,t.nodeType===8?cw(t.parentNode,n):t.nodeType===1&&cw(t,n),of(t)):cw(Mr,n.stateNode));break;case 4:r=Mr,s=ai,Mr=n.stateNode.containerInfo,ai=!0,Ko(t,e,n),Mr=r,ai=s;break;case 0:case 11:case 14:case 15:if(!Qr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&q_(n,e,o),s=s.next}while(s!==r)}Ko(t,e,n);break;case 1:if(!Qr&&(au(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){rr(n,e,a)}Ko(t,e,n);break;case 21:Ko(t,e,n);break;case 22:n.mode&1?(Qr=(r=Qr)||n.memoizedState!==null,Ko(t,e,n),Qr=r):Ko(t,e,n);break;default:Ko(t,e,n)}}function BT(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new G4),e.forEach(function(r){var s=sU.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function ni(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Mr=a.stateNode,ai=!1;break e;case 3:Mr=a.stateNode.containerInfo,ai=!0;break e;case 4:Mr=a.stateNode.containerInfo,ai=!0;break e}a=a.return}if(Mr===null)throw Error(me(160));TN(i,o,s),Mr=null,ai=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){rr(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)xN(e,t),e=e.sibling}function xN(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ni(e,t),Ci(t),r&4){try{Oh(3,t,t.return),Ry(3,t)}catch(g){rr(t,t.return,g)}try{Oh(5,t,t.return)}catch(g){rr(t,t.return,g)}}break;case 1:ni(e,t),Ci(t),r&512&&n!==null&&au(n,n.return);break;case 5:if(ni(e,t),Ci(t),r&512&&n!==null&&au(n,n.return),t.flags&32){var s=t.stateNode;try{tf(s,"")}catch(g){rr(t,t.return,g)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&GR(s,i),v_(a,o);var c=v_(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?ZR(s,h):u==="dangerouslySetInnerHTML"?JR(s,h):u==="children"?tf(s,h):wb(s,u,h,c)}switch(a){case"input":f_(s,i);break;case"textarea":QR(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?gu(s,!!i.multiple,p,!1):m!==!!i.multiple&&(i.defaultValue!=null?gu(s,!!i.multiple,i.defaultValue,!0):gu(s,!!i.multiple,i.multiple?[]:"",!1))}s[df]=i}catch(g){rr(t,t.return,g)}}break;case 6:if(ni(e,t),Ci(t),r&4){if(t.stateNode===null)throw Error(me(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){rr(t,t.return,g)}}break;case 3:if(ni(e,t),Ci(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{of(e.containerInfo)}catch(g){rr(t,t.return,g)}break;case 4:ni(e,t),Ci(t);break;case 13:ni(e,t),Ci(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Xb=or())),r&4&&BT(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Qr=(c=Qr)||u,ni(e,t),Qr=c):ni(e,t),Ci(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(We=t,u=t.child;u!==null;){for(h=We=u;We!==null;){switch(m=We,p=m.child,m.tag){case 0:case 11:case 14:case 15:Oh(4,m,m.return);break;case 1:au(m,m.return);var v=m.stateNode;if(typeof v.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(g){rr(r,n,g)}}break;case 5:au(m,m.return);break;case 22:if(m.memoizedState!==null){WT(h);continue}}p!==null?(p.return=m,We=p):WT(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=XR("display",o))}catch(g){rr(t,t.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){rr(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ni(e,t),Ci(t),r&4&&BT(t);break;case 21:break;default:ni(e,t),Ci(t)}}function Ci(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(IN(n)){var r=n;break e}n=n.return}throw Error(me(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(tf(s,""),r.flags&=-33);var i=$T(t);G_(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=$T(t);K_(t,a,o);break;default:throw Error(me(161))}}catch(l){rr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Y4(t,e,n){We=t,AN(t)}function AN(t,e,n){for(var r=(t.mode&1)!==0;We!==null;){var s=We,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||zm;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Qr;a=zm;var c=Qr;if(zm=o,(Qr=l)&&!c)for(We=s;We!==null;)o=We,l=o.child,o.tag===22&&o.memoizedState!==null?qT(s):l!==null?(l.return=o,We=l):qT(s);for(;i!==null;)We=i,AN(i),i=i.sibling;We=s,zm=a,Qr=c}zT(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,We=i):zT(t)}}function zT(t){for(;We!==null;){var e=We;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qr||Ry(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Qr)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:si(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&AT(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}AT(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&of(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(me(163))}Qr||e.flags&512&&H_(e)}catch(m){rr(e,e.return,m)}}if(e===t){We=null;break}if(n=e.sibling,n!==null){n.return=e.return,We=n;break}We=e.return}}function WT(t){for(;We!==null;){var e=We;if(e===t){We=null;break}var n=e.sibling;if(n!==null){n.return=e.return,We=n;break}We=e.return}}function qT(t){for(;We!==null;){var e=We;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ry(4,e)}catch(l){rr(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){rr(e,s,l)}}var i=e.return;try{H_(e)}catch(l){rr(e,i,l)}break;case 5:var o=e.return;try{H_(e)}catch(l){rr(e,o,l)}}}catch(l){rr(e,e.return,l)}if(e===t){We=null;break}var a=e.sibling;if(a!==null){a.return=e.return,We=a;break}We=e.return}}var J4=Math.ceil,bg=jo.ReactCurrentDispatcher,Yb=jo.ReactCurrentOwner,Qs=jo.ReactCurrentBatchConfig,tn=0,Nr=null,fr=null,Ur=0,xs=0,lu=ol(0),wr=0,yf=null,ic=0,Cy=0,Jb=0,Lh=null,ds=null,Xb=0,qu=1/0,ho=null,Eg=!1,Q_=null,Oa=null,Wm=!1,Sa=null,Sg=0,Mh=0,Y_=null,Rp=-1,Cp=0;function ss(){return tn&6?or():Rp!==-1?Rp:Rp=or()}function La(t){return t.mode&1?tn&2&&Ur!==0?Ur&-Ur:O4.transition!==null?(Cp===0&&(Cp=dC()),Cp):(t=pn,t!==0||(t=window.event,t=t===void 0?16:vC(t.type)),t):1}function fi(t,e,n,r){if(50<Mh)throw Mh=0,Y_=null,Error(me(185));qf(t,n,r),(!(tn&2)||t!==Nr)&&(t===Nr&&(!(tn&2)&&(Cy|=n),wr===4&&ca(t,Ur)),bs(t,r),n===1&&tn===0&&!(e.mode&1)&&(qu=or()+500,xy&&al()))}function bs(t,e){var n=t.callbackNode;OF(t,e);var r=og(t,t===Nr?Ur:0);if(r===0)n!==null&&eT(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&eT(n),e===1)t.tag===0?D4(HT.bind(null,t)):VC(HT.bind(null,t)),R4(function(){!(tn&6)&&al()}),n=null;else{switch(hC(r)){case 1:n=Ib;break;case 4:n=cC;break;case 16:n=ig;break;case 536870912:n=uC;break;default:n=ig}n=LN(n,PN.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function PN(t,e){if(Rp=-1,Cp=0,tn&6)throw Error(me(327));var n=t.callbackNode;if(bu()&&t.callbackNode!==n)return null;var r=og(t,t===Nr?Ur:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ig(t,r);else{e=r;var s=tn;tn|=2;var i=CN();(Nr!==t||Ur!==e)&&(ho=null,qu=or()+500,Ql(t,e));do try{eU();break}catch(a){RN(t,a)}while(!0);Vb(),bg.current=i,tn=s,fr!==null?e=0:(Nr=null,Ur=0,e=wr)}if(e!==0){if(e===2&&(s=S_(t),s!==0&&(r=s,e=J_(t,s))),e===1)throw n=yf,Ql(t,0),ca(t,r),bs(t,or()),n;if(e===6)ca(t,r);else{if(s=t.current.alternate,!(r&30)&&!X4(s)&&(e=Ig(t,r),e===2&&(i=S_(t),i!==0&&(r=i,e=J_(t,i))),e===1))throw n=yf,Ql(t,0),ca(t,r),bs(t,or()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(me(345));case 2:Tl(t,ds,ho);break;case 3:if(ca(t,r),(r&130023424)===r&&(e=Xb+500-or(),10<e)){if(og(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){ss(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=N_(Tl.bind(null,t,ds,ho),e);break}Tl(t,ds,ho);break;case 4:if(ca(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-hi(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=or()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*J4(r/1960))-r,10<r){t.timeoutHandle=N_(Tl.bind(null,t,ds,ho),r);break}Tl(t,ds,ho);break;case 5:Tl(t,ds,ho);break;default:throw Error(me(329))}}}return bs(t,or()),t.callbackNode===n?PN.bind(null,t):null}function J_(t,e){var n=Lh;return t.current.memoizedState.isDehydrated&&(Ql(t,e).flags|=256),t=Ig(t,e),t!==2&&(e=ds,ds=n,e!==null&&X_(e)),t}function X_(t){ds===null?ds=t:ds.push.apply(ds,t)}function X4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!gi(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ca(t,e){for(e&=~Jb,e&=~Cy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-hi(e),r=1<<n;t[n]=-1,e&=~r}}function HT(t){if(tn&6)throw Error(me(327));bu();var e=og(t,0);if(!(e&1))return bs(t,or()),null;var n=Ig(t,e);if(t.tag!==0&&n===2){var r=S_(t);r!==0&&(e=r,n=J_(t,r))}if(n===1)throw n=yf,Ql(t,0),ca(t,e),bs(t,or()),n;if(n===6)throw Error(me(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Tl(t,ds,ho),bs(t,or()),null}function Zb(t,e){var n=tn;tn|=1;try{return t(e)}finally{tn=n,tn===0&&(qu=or()+500,xy&&al())}}function oc(t){Sa!==null&&Sa.tag===0&&!(tn&6)&&bu();var e=tn;tn|=1;var n=Qs.transition,r=pn;try{if(Qs.transition=null,pn=1,t)return t()}finally{pn=r,Qs.transition=n,tn=e,!(tn&6)&&al()}}function eE(){xs=lu.current,Ln(lu)}function Ql(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,P4(n)),fr!==null)for(n=fr.return;n!==null;){var r=n;switch(Ob(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&dg();break;case 3:zu(),Ln(ws),Ln(Xr),zb();break;case 5:Bb(r);break;case 4:zu();break;case 13:Ln(qn);break;case 19:Ln(qn);break;case 10:jb(r.type._context);break;case 22:case 23:eE()}n=n.return}if(Nr=t,fr=t=Ma(t.current,null),Ur=xs=e,wr=0,yf=null,Jb=Cy=ic=0,ds=Lh=null,Ul!==null){for(e=0;e<Ul.length;e++)if(n=Ul[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ul=null}return t}function RN(t,e){do{var n=fr;try{if(Vb(),xp.current=_g,wg){for(var r=Kn.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}wg=!1}if(sc=0,Rr=yr=Kn=null,Dh=!1,mf=0,Yb.current=null,n===null||n.return===null){wr=1,yf=e,fr=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Ur,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=DT(o);if(p!==null){p.flags&=-257,OT(p,o,a,i,e),p.mode&1&&kT(i,c,e),e=p,l=c;var v=e.updateQueue;if(v===null){var g=new Set;g.add(l),e.updateQueue=g}else v.add(l);break e}else{if(!(e&1)){kT(i,c,e),tE();break e}l=Error(me(426))}}else if(Fn&&a.mode&1){var E=DT(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),OT(E,o,a,i,e),Lb(Wu(l,a));break e}}i=l=Wu(l,a),wr!==4&&(wr=2),Lh===null?Lh=[i]:Lh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=hN(i,l,e);xT(i,b);break e;case 1:a=l;var _=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Oa===null||!Oa.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=fN(i,a,e);xT(i,P);break e}}i=i.return}while(i!==null)}kN(n)}catch(T){e=T,fr===n&&n!==null&&(fr=n=n.return);continue}break}while(!0)}function CN(){var t=bg.current;return bg.current=_g,t===null?_g:t}function tE(){(wr===0||wr===3||wr===2)&&(wr=4),Nr===null||!(ic&268435455)&&!(Cy&268435455)||ca(Nr,Ur)}function Ig(t,e){var n=tn;tn|=2;var r=CN();(Nr!==t||Ur!==e)&&(ho=null,Ql(t,e));do try{Z4();break}catch(s){RN(t,s)}while(!0);if(Vb(),tn=n,bg.current=r,fr!==null)throw Error(me(261));return Nr=null,Ur=0,wr}function Z4(){for(;fr!==null;)NN(fr)}function eU(){for(;fr!==null&&!TF();)NN(fr)}function NN(t){var e=ON(t.alternate,t,xs);t.memoizedProps=t.pendingProps,e===null?kN(t):fr=e,Yb.current=null}function kN(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=K4(n,e),n!==null){n.flags&=32767,fr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wr=6,fr=null;return}}else if(n=H4(n,e,xs),n!==null){fr=n;return}if(e=e.sibling,e!==null){fr=e;return}fr=e=t}while(e!==null);wr===0&&(wr=5)}function Tl(t,e,n){var r=pn,s=Qs.transition;try{Qs.transition=null,pn=1,tU(t,e,n,r)}finally{Qs.transition=s,pn=r}return null}function tU(t,e,n,r){do bu();while(Sa!==null);if(tn&6)throw Error(me(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(me(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(LF(t,i),t===Nr&&(fr=Nr=null,Ur=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Wm||(Wm=!0,LN(ig,function(){return bu(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Qs.transition,Qs.transition=null;var o=pn;pn=1;var a=tn;tn|=4,Yb.current=null,Q4(t,n),xN(n,t),b4(R_),ag=!!P_,R_=P_=null,t.current=n,Y4(n),xF(),tn=a,pn=o,Qs.transition=i}else t.current=n;if(Wm&&(Wm=!1,Sa=t,Sg=s),i=t.pendingLanes,i===0&&(Oa=null),RF(n.stateNode),bs(t,or()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Eg)throw Eg=!1,t=Q_,Q_=null,t;return Sg&1&&t.tag!==0&&bu(),i=t.pendingLanes,i&1?t===Y_?Mh++:(Mh=0,Y_=t):Mh=0,al(),null}function bu(){if(Sa!==null){var t=hC(Sg),e=Qs.transition,n=pn;try{if(Qs.transition=null,pn=16>t?16:t,Sa===null)var r=!1;else{if(t=Sa,Sa=null,Sg=0,tn&6)throw Error(me(331));var s=tn;for(tn|=4,We=t.current;We!==null;){var i=We,o=i.child;if(We.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(We=c;We!==null;){var u=We;switch(u.tag){case 0:case 11:case 15:Oh(8,u,i)}var h=u.child;if(h!==null)h.return=u,We=h;else for(;We!==null;){u=We;var m=u.sibling,p=u.return;if(SN(u),u===c){We=null;break}if(m!==null){m.return=p,We=m;break}We=p}}}var v=i.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var E=g.sibling;g.sibling=null,g=E}while(g!==null)}}We=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,We=o;else e:for(;We!==null;){if(i=We,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Oh(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,We=b;break e}We=i.return}}var _=t.current;for(We=_;We!==null;){o=We;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,We=S;else e:for(o=_;We!==null;){if(a=We,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ry(9,a)}}catch(T){rr(a,a.return,T)}if(a===o){We=null;break e}var P=a.sibling;if(P!==null){P.return=a.return,We=P;break e}We=a.return}}if(tn=s,al(),Hi&&typeof Hi.onPostCommitFiberRoot=="function")try{Hi.onPostCommitFiberRoot(by,t)}catch{}r=!0}return r}finally{pn=n,Qs.transition=e}}return!1}function KT(t,e,n){e=Wu(n,e),e=hN(t,e,1),t=Da(t,e,1),e=ss(),t!==null&&(qf(t,1,e),bs(t,e))}function rr(t,e,n){if(t.tag===3)KT(t,t,n);else for(;e!==null;){if(e.tag===3){KT(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Oa===null||!Oa.has(r))){t=Wu(n,t),t=fN(e,t,1),e=Da(e,t,1),t=ss(),e!==null&&(qf(e,1,t),bs(e,t));break}}e=e.return}}function nU(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ss(),t.pingedLanes|=t.suspendedLanes&n,Nr===t&&(Ur&n)===n&&(wr===4||wr===3&&(Ur&130023424)===Ur&&500>or()-Xb?Ql(t,0):Jb|=n),bs(t,e)}function DN(t,e){e===0&&(t.mode&1?(e=Om,Om<<=1,!(Om&130023424)&&(Om=4194304)):e=1);var n=ss();t=Ro(t,e),t!==null&&(qf(t,e,n),bs(t,n))}function rU(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),DN(t,n)}function sU(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(me(314))}r!==null&&r.delete(e),DN(t,n)}var ON;ON=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ws.current)ms=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ms=!1,q4(t,e,n);ms=!!(t.flags&131072)}else ms=!1,Fn&&e.flags&1048576&&jC(e,mg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Pp(t,e),t=e.pendingProps;var s=Uu(e,Xr.current);_u(e,n),s=qb(null,e,r,t,s,n);var i=Hb();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_s(r)?(i=!0,hg(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ub(e),s.updater=Py,e.stateNode=s,s._reactInternals=e,j_(e,r,t,n),e=$_(null,e,r,!0,i,n)):(e.tag=0,Fn&&i&&Db(e),ts(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Pp(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=oU(r),t=si(r,t),s){case 0:e=U_(null,e,r,t,n);break e;case 1:e=VT(null,e,r,t,n);break e;case 11:e=LT(null,e,r,t,n);break e;case 14:e=MT(null,e,r,si(r.type,t),n);break e}throw Error(me(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:si(r,s),U_(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:si(r,s),VT(t,e,r,s,n);case 3:e:{if(yN(e),t===null)throw Error(me(387));r=e.pendingProps,i=e.memoizedState,s=i.element,WC(t,e),yg(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Wu(Error(me(423)),e),e=jT(t,e,r,n,s);break e}else if(r!==s){s=Wu(Error(me(424)),e),e=jT(t,e,r,n,s);break e}else for(Cs=ka(e.stateNode.containerInfo.firstChild),ks=e,Fn=!0,ci=null,n=BC(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if($u(),r===s){e=Co(t,e,n);break e}ts(t,e,r,n)}e=e.child}return e;case 5:return qC(e),t===null&&L_(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,C_(r,s)?o=null:i!==null&&C_(r,i)&&(e.flags|=32),gN(t,e),ts(t,e,o,n),e.child;case 6:return t===null&&L_(e),null;case 13:return vN(t,e,n);case 4:return $b(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Bu(e,null,r,n):ts(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:si(r,s),LT(t,e,r,s,n);case 7:return ts(t,e,e.pendingProps,n),e.child;case 8:return ts(t,e,e.pendingProps.children,n),e.child;case 12:return ts(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Tn(pg,r._currentValue),r._currentValue=o,i!==null)if(gi(i.value,o)){if(i.children===s.children&&!ws.current){e=Co(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=So(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),M_(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(me(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),M_(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ts(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,_u(e,n),s=Js(s),r=r(s),e.flags|=1,ts(t,e,r,n),e.child;case 14:return r=e.type,s=si(r,e.pendingProps),s=si(r.type,s),MT(t,e,r,s,n);case 15:return mN(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:si(r,s),Pp(t,e),e.tag=1,_s(r)?(t=!0,hg(e)):t=!1,_u(e,n),dN(e,r,s),j_(e,r,s,n),$_(null,e,r,!0,t,n);case 19:return wN(t,e,n);case 22:return pN(t,e,n)}throw Error(me(156,e.tag))};function LN(t,e){return lC(t,e)}function iU(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ks(t,e,n,r){return new iU(t,e,n,r)}function nE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function oU(t){if(typeof t=="function")return nE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===bb)return 11;if(t===Eb)return 14}return 2}function Ma(t,e){var n=t.alternate;return n===null?(n=Ks(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Np(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")nE(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Xc:return Yl(n.children,s,i,e);case _b:o=8,s|=8;break;case l_:return t=Ks(12,n,e,s|2),t.elementType=l_,t.lanes=i,t;case c_:return t=Ks(13,n,e,s),t.elementType=c_,t.lanes=i,t;case u_:return t=Ks(19,n,e,s),t.elementType=u_,t.lanes=i,t;case qR:return Ny(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case zR:o=10;break e;case WR:o=9;break e;case bb:o=11;break e;case Eb:o=14;break e;case ia:o=16,r=null;break e}throw Error(me(130,t==null?t:typeof t,""))}return e=Ks(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Yl(t,e,n,r){return t=Ks(7,t,r,e),t.lanes=n,t}function Ny(t,e,n,r){return t=Ks(22,t,r,e),t.elementType=qR,t.lanes=n,t.stateNode={isHidden:!1},t}function yw(t,e,n){return t=Ks(6,t,null,e),t.lanes=n,t}function vw(t,e,n){return e=Ks(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function aU(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xv(0),this.expirationTimes=Xv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xv(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function rE(t,e,n,r,s,i,o,a,l){return t=new aU(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ks(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ub(i),t}function lU(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function MN(t){if(!t)return qa;t=t._reactInternals;e:{if(Ec(t)!==t||t.tag!==1)throw Error(me(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_s(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(me(171))}if(t.tag===1){var n=t.type;if(_s(n))return MC(t,n,e)}return e}function VN(t,e,n,r,s,i,o,a,l){return t=rE(n,r,!0,t,s,i,o,a,l),t.context=MN(null),n=t.current,r=ss(),s=La(n),i=So(r,s),i.callback=e??null,Da(n,i,s),t.current.lanes=s,qf(t,s,r),bs(t,r),t}function ky(t,e,n,r){var s=e.current,i=ss(),o=La(s);return n=MN(n),e.context===null?e.context=n:e.pendingContext=n,e=So(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Da(s,e,o),t!==null&&(fi(t,s,o,i),Tp(t,s,o)),o}function Tg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function GT(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function sE(t,e){GT(t,e),(t=t.alternate)&&GT(t,e)}function cU(){return null}var jN=typeof reportError=="function"?reportError:function(t){console.error(t)};function iE(t){this._internalRoot=t}Dy.prototype.render=iE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(me(409));ky(t,e,null,null)};Dy.prototype.unmount=iE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;oc(function(){ky(null,t,null,null)}),e[Po]=null}};function Dy(t){this._internalRoot=t}Dy.prototype.unstable_scheduleHydration=function(t){if(t){var e=pC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<la.length&&e!==0&&e<la[n].priority;n++);la.splice(n,0,t),n===0&&yC(t)}};function oE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Oy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function QT(){}function uU(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Tg(o);i.call(c)}}var o=VN(e,r,t,0,null,!1,!1,"",QT);return t._reactRootContainer=o,t[Po]=o.current,cf(t.nodeType===8?t.parentNode:t),oc(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Tg(l);a.call(c)}}var l=rE(t,0,!1,null,null,!1,!1,"",QT);return t._reactRootContainer=l,t[Po]=l.current,cf(t.nodeType===8?t.parentNode:t),oc(function(){ky(e,l,n,r)}),l}function Ly(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Tg(o);a.call(l)}}ky(e,o,t,s)}else o=uU(n,e,t,s,r);return Tg(o)}fC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=yh(e.pendingLanes);n!==0&&(Tb(e,n|1),bs(e,or()),!(tn&6)&&(qu=or()+500,al()))}break;case 13:oc(function(){var r=Ro(t,1);if(r!==null){var s=ss();fi(r,t,1,s)}}),sE(t,1)}};xb=function(t){if(t.tag===13){var e=Ro(t,134217728);if(e!==null){var n=ss();fi(e,t,134217728,n)}sE(t,134217728)}};mC=function(t){if(t.tag===13){var e=La(t),n=Ro(t,e);if(n!==null){var r=ss();fi(n,t,e,r)}sE(t,e)}};pC=function(){return pn};gC=function(t,e){var n=pn;try{return pn=t,e()}finally{pn=n}};__=function(t,e,n){switch(e){case"input":if(f_(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Ty(r);if(!s)throw Error(me(90));KR(r),f_(r,s)}}}break;case"textarea":QR(t,n);break;case"select":e=n.value,e!=null&&gu(t,!!n.multiple,e,!1)}};nC=Zb;rC=oc;var dU={usingClientEntryPoint:!1,Events:[Kf,nu,Ty,eC,tC,Zb]},oh={findFiberByHostInstance:Fl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hU={bundleType:oh.bundleType,version:oh.version,rendererPackageName:oh.rendererPackageName,rendererConfig:oh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:jo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=oC(t),t===null?null:t.stateNode},findFiberByHostInstance:oh.findFiberByHostInstance||cU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qm.isDisabled&&qm.supportsFiber)try{by=qm.inject(hU),Hi=qm}catch{}}Fs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dU;Fs.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!oE(e))throw Error(me(200));return lU(t,e,null,n)};Fs.createRoot=function(t,e){if(!oE(t))throw Error(me(299));var n=!1,r="",s=jN;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=rE(t,1,!1,null,null,n,!1,r,s),t[Po]=e.current,cf(t.nodeType===8?t.parentNode:t),new iE(e)};Fs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(me(188)):(t=Object.keys(t).join(","),Error(me(268,t)));return t=oC(e),t=t===null?null:t.stateNode,t};Fs.flushSync=function(t){return oc(t)};Fs.hydrate=function(t,e,n){if(!Oy(e))throw Error(me(200));return Ly(null,t,e,!0,n)};Fs.hydrateRoot=function(t,e,n){if(!oE(t))throw Error(me(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=jN;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=VN(e,null,t,1,n??null,s,!1,i,o),t[Po]=e.current,cf(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Dy(e)};Fs.render=function(t,e,n){if(!Oy(e))throw Error(me(200));return Ly(null,t,e,!1,n)};Fs.unmountComponentAtNode=function(t){if(!Oy(t))throw Error(me(40));return t._reactRootContainer?(oc(function(){Ly(null,null,t,!1,function(){t._reactRootContainer=null,t[Po]=null})}),!0):!1};Fs.unstable_batchedUpdates=Zb;Fs.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Oy(n))throw Error(me(200));if(t==null||t._reactInternals===void 0)throw Error(me(38));return Ly(t,e,n,!1,r)};Fs.version="18.3.1-next-f1338f8080-20240426";function FN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(FN)}catch(t){console.error(t)}}FN(),FR.exports=Fs;var Qf=FR.exports;const UN=AR(Qf);var $N,YT=Qf;$N=YT.createRoot,YT.hydrateRoot;const fU="modulepreload",mU=function(t,e){return new URL(t,e).href},JT={},ee=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=mU(c,r),c in JT)return;JT[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(!!r)for(let v=o.length-1;v>=0;v--){const g=o[v];if(g.href===c&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${h}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":fU,u||(p.as="script"),p.crossOrigin="",p.href=c,l&&p.setAttribute("nonce",l),document.head.appendChild(p),u)return new Promise((v,g)=>{p.addEventListener("load",v),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},pU=1,gU=1e6;let ww=0;function yU(){return ww=(ww+1)%Number.MAX_SAFE_INTEGER,ww.toString()}const _w=new Map,XT=t=>{if(_w.has(t))return;const e=setTimeout(()=>{_w.delete(t),Vh({type:"REMOVE_TOAST",toastId:t})},gU);_w.set(t,e)},vU=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,pU)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?XT(n):t.toasts.forEach(r=>{XT(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},kp=[];let Dp={toasts:[]};function Vh(t){Dp=vU(Dp,t),kp.forEach(e=>{e(Dp)})}function wU({...t}){const e=yU(),n=s=>Vh({type:"UPDATE_TOAST",toast:{...s,id:e}}),r=()=>Vh({type:"DISMISS_TOAST",toastId:e});return Vh({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:s=>{s||r()}}}),{id:e,dismiss:r,update:n}}function ll(){const[t,e]=y.useState(Dp);return y.useEffect(()=>(kp.push(e),()=>{const n=kp.indexOf(e);n>-1&&kp.splice(n,1)}),[t]),{...t,toast:wU,dismiss:n=>Vh({type:"DISMISS_TOAST",toastId:n})}}function en(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function ZT(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Yf(...t){return e=>{let n=!1;const r=t.map(s=>{const i=ZT(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():ZT(t[s],null)}}}}function Qn(...t){return y.useCallback(Yf(...t),t)}function _U(t,e){const n=y.createContext(e),r=i=>{const{children:o,...a}=i,l=y.useMemo(()=>a,Object.values(a));return f.jsx(n.Provider,{value:l,children:o})};r.displayName=t+"Provider";function s(i){const o=y.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,s]}function Sc(t,e=[]){let n=[];function r(i,o){const a=y.createContext(o),l=n.length;n=[...n,o];const c=h=>{var b;const{scope:m,children:p,...v}=h,g=((b=m==null?void 0:m[t])==null?void 0:b[l])||a,E=y.useMemo(()=>v,Object.values(v));return f.jsx(g.Provider,{value:E,children:p})};c.displayName=i+"Provider";function u(h,m){var g;const p=((g=m==null?void 0:m[t])==null?void 0:g[l])||a,v=y.useContext(p);if(v)return v;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(o=>y.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return y.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,bU(s,...e)]}function bU(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return y.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function ex(t){const e=EU(t),n=y.forwardRef((r,s)=>{const{children:i,...o}=r,a=y.Children.toArray(i),l=a.find(IU);if(l){const c=l.props.children,u=a.map(h=>h===l?y.Children.count(c)>1?y.Children.only(null):y.isValidElement(c)?c.props.children:null:h);return f.jsx(e,{...o,ref:s,children:y.isValidElement(c)?y.cloneElement(c,void 0,u):null})}return f.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}function EU(t){const e=y.forwardRef((n,r)=>{const{children:s,...i}=n;if(y.isValidElement(s)){const o=xU(s),a=TU(i,s.props);return s.type!==y.Fragment&&(a.ref=r?Yf(r,o):o),y.cloneElement(s,a)}return y.Children.count(s)>1?y.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var SU=Symbol("radix.slottable");function IU(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===SU}function TU(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function xU(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function AU(t){const e=t+"CollectionProvider",[n,r]=Sc(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:E,children:b}=g,_=V.useRef(null),S=V.useRef(new Map).current;return f.jsx(s,{scope:E,itemMap:S,collectionRef:_,children:b})};o.displayName=e;const a=t+"CollectionSlot",l=ex(a),c=V.forwardRef((g,E)=>{const{scope:b,children:_}=g,S=i(a,b),P=Qn(E,S.collectionRef);return f.jsx(l,{ref:P,children:_})});c.displayName=a;const u=t+"CollectionItemSlot",h="data-radix-collection-item",m=ex(u),p=V.forwardRef((g,E)=>{const{scope:b,children:_,...S}=g,P=V.useRef(null),T=Qn(E,P),N=i(u,b);return V.useEffect(()=>(N.itemMap.set(P,{ref:P,...S}),()=>void N.itemMap.delete(P))),f.jsx(m,{[h]:"",ref:T,children:_})});p.displayName=u;function v(g){const E=i(t+"CollectionConsumer",g);return V.useCallback(()=>{const _=E.collectionRef.current;if(!_)return[];const S=Array.from(_.querySelectorAll(`[${h}]`));return Array.from(E.itemMap.values()).sort((N,I)=>S.indexOf(N.ref.current)-S.indexOf(I.ref.current))},[E.collectionRef,E.itemMap])}return[{Provider:o,Slot:c,ItemSlot:p},v,r]}function PU(t){const e=RU(t),n=y.forwardRef((r,s)=>{const{children:i,...o}=r,a=y.Children.toArray(i),l=a.find(NU);if(l){const c=l.props.children,u=a.map(h=>h===l?y.Children.count(c)>1?y.Children.only(null):y.isValidElement(c)?c.props.children:null:h);return f.jsx(e,{...o,ref:s,children:y.isValidElement(c)?y.cloneElement(c,void 0,u):null})}return f.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}function RU(t){const e=y.forwardRef((n,r)=>{const{children:s,...i}=n;if(y.isValidElement(s)){const o=DU(s),a=kU(i,s.props);return s.type!==y.Fragment&&(a.ref=r?Yf(r,o):o),y.cloneElement(s,a)}return y.Children.count(s)>1?y.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var CU=Symbol("radix.slottable");function NU(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===CU}function kU(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function DU(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var OU=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],_n=OU.reduce((t,e)=>{const n=PU(`Primitive.${e}`),r=y.forwardRef((s,i)=>{const{asChild:o,...a}=s,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...a,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function BN(t,e){t&&Qf.flushSync(()=>t.dispatchEvent(e))}function jr(t){const e=y.useRef(t);return y.useEffect(()=>{e.current=t}),y.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function LU(t,e=globalThis==null?void 0:globalThis.document){const n=jr(t);y.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var MU="DismissableLayer",Z_="dismissableLayer.update",VU="dismissableLayer.pointerDownOutside",jU="dismissableLayer.focusOutside",tx,zN=y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),My=y.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=y.useContext(zN),[u,h]=y.useState(null),m=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=y.useState({}),v=Qn(e,I=>h(I)),g=Array.from(c.layers),[E]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),b=g.indexOf(E),_=u?g.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,P=_>=b,T=UU(I=>{const A=I.target,R=[...c.branches].some(k=>k.contains(A));!P||R||(s==null||s(I),o==null||o(I),I.defaultPrevented||a==null||a())},m),N=$U(I=>{const A=I.target;[...c.branches].some(k=>k.contains(A))||(i==null||i(I),o==null||o(I),I.defaultPrevented||a==null||a())},m);return LU(I=>{_===c.layers.size-1&&(r==null||r(I),!I.defaultPrevented&&a&&(I.preventDefault(),a()))},m),y.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(tx=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),nx(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=tx)}},[u,m,n,c]),y.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),nx())},[u,c]),y.useEffect(()=>{const I=()=>p({});return document.addEventListener(Z_,I),()=>document.removeEventListener(Z_,I)},[]),f.jsx(_n.div,{...l,ref:v,style:{pointerEvents:S?P?"auto":"none":void 0,...t.style},onFocusCapture:en(t.onFocusCapture,N.onFocusCapture),onBlurCapture:en(t.onBlurCapture,N.onBlurCapture),onPointerDownCapture:en(t.onPointerDownCapture,T.onPointerDownCapture)})});My.displayName=MU;var FU="DismissableLayerBranch",WN=y.forwardRef((t,e)=>{const n=y.useContext(zN),r=y.useRef(null),s=Qn(e,r);return y.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(_n.div,{...t,ref:s})});WN.displayName=FU;function UU(t,e=globalThis==null?void 0:globalThis.document){const n=jr(t),r=y.useRef(!1),s=y.useRef(()=>{});return y.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){qN(VU,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function $U(t,e=globalThis==null?void 0:globalThis.document){const n=jr(t),r=y.useRef(!1);return y.useEffect(()=>{const s=i=>{i.target&&!r.current&&qN(jU,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function nx(){const t=new CustomEvent(Z_);document.dispatchEvent(t)}function qN(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?BN(s,i):s.dispatchEvent(i)}var BU=My,zU=WN,Zi=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},WU="Portal",aE=y.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[s,i]=y.useState(!1);Zi(()=>i(!0),[]);const o=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?UN.createPortal(f.jsx(_n.div,{...r,ref:e}),o):null});aE.displayName=WU;function qU(t,e){return y.useReducer((n,r)=>e[n][r]??n,t)}var Si=t=>{const{present:e,children:n}=t,r=HU(e),s=typeof n=="function"?n({present:r.isPresent}):y.Children.only(n),i=Qn(r.ref,KU(s));return typeof n=="function"||r.isPresent?y.cloneElement(s,{ref:i}):null};Si.displayName="Presence";function HU(t){const[e,n]=y.useState(),r=y.useRef(null),s=y.useRef(t),i=y.useRef("none"),o=t?"mounted":"unmounted",[a,l]=qU(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const c=Hm(r.current);i.current=a==="mounted"?c:"none"},[a]),Zi(()=>{const c=r.current,u=s.current;if(u!==t){const m=i.current,p=Hm(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&m!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),Zi(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=p=>{const g=Hm(r.current).includes(CSS.escape(p.animationName));if(p.target===e&&g&&(l("ANIMATION_END"),!s.current)){const E=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=E)})}},m=p=>{p.target===e&&(i.current=Hm(r.current))};return e.addEventListener("animationstart",m),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",m),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:y.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function Hm(t){return(t==null?void 0:t.animationName)||"none"}function KU(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var GU=_y[" useInsertionEffect ".trim().toString()]||Zi;function lE({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,o]=QU({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:s;{const u=y.useRef(t!==void 0);y.useEffect(()=>{const h=u.current;h!==a&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,r])}const c=y.useCallback(u=>{var h;if(a){const m=YU(u)?u(t):u;m!==t&&((h=o.current)==null||h.call(o,m))}else i(u)},[a,t,i,o]);return[l,c]}function QU({defaultProp:t,onChange:e}){const[n,r]=y.useState(t),s=y.useRef(n),i=y.useRef(e);return GU(()=>{i.current=e},[e]),y.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function YU(t){return typeof t=="function"}var JU=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),XU="VisuallyHidden",Vy=y.forwardRef((t,e)=>f.jsx(_n.span,{...t,ref:e,style:{...JU,...t.style}}));Vy.displayName=XU;var ZU=Vy,cE="ToastProvider",[uE,e3,t3]=AU("Toast"),[HN]=Sc("Toast",[t3]),[n3,jy]=HN(cE),KN=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[a,l]=y.useState(null),[c,u]=y.useState(0),h=y.useRef(!1),m=y.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${cE}\`. Expected non-empty \`string\`.`),f.jsx(uE.Provider,{scope:e,children:f.jsx(n3,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:y.useCallback(()=>u(p=>p+1),[]),onToastRemove:y.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:m,children:o})})};KN.displayName=cE;var GN="ToastViewport",r3=["F8"],e0="toast.viewportPause",t0="toast.viewportResume",QN=y.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=r3,label:s="Notifications ({hotkey})",...i}=t,o=jy(GN,n),a=e3(n),l=y.useRef(null),c=y.useRef(null),u=y.useRef(null),h=y.useRef(null),m=Qn(e,h,o.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=o.toastCount>0;y.useEffect(()=>{const E=b=>{var S;r.length!==0&&r.every(P=>b[P]||b.code===P)&&((S=h.current)==null||S.focus())};return document.addEventListener("keydown",E),()=>document.removeEventListener("keydown",E)},[r]),y.useEffect(()=>{const E=l.current,b=h.current;if(v&&E&&b){const _=()=>{if(!o.isClosePausedRef.current){const N=new CustomEvent(e0);b.dispatchEvent(N),o.isClosePausedRef.current=!0}},S=()=>{if(o.isClosePausedRef.current){const N=new CustomEvent(t0);b.dispatchEvent(N),o.isClosePausedRef.current=!1}},P=N=>{!E.contains(N.relatedTarget)&&S()},T=()=>{E.contains(document.activeElement)||S()};return E.addEventListener("focusin",_),E.addEventListener("focusout",P),E.addEventListener("pointermove",_),E.addEventListener("pointerleave",T),window.addEventListener("blur",_),window.addEventListener("focus",S),()=>{E.removeEventListener("focusin",_),E.removeEventListener("focusout",P),E.removeEventListener("pointermove",_),E.removeEventListener("pointerleave",T),window.removeEventListener("blur",_),window.removeEventListener("focus",S)}}},[v,o.isClosePausedRef]);const g=y.useCallback(({tabbingDirection:E})=>{const _=a().map(S=>{const P=S.ref.current,T=[P,...g3(P)];return E==="forwards"?T:T.reverse()});return(E==="forwards"?_.reverse():_).flat()},[a]);return y.useEffect(()=>{const E=h.current;if(E){const b=_=>{var T,N,I;const S=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!S){const A=document.activeElement,R=_.shiftKey;if(_.target===E&&R){(T=c.current)==null||T.focus();return}const L=g({tabbingDirection:R?"backwards":"forwards"}),O=L.findIndex(X=>X===A);bw(L.slice(O+1))?_.preventDefault():R?(N=c.current)==null||N.focus():(I=u.current)==null||I.focus()}};return E.addEventListener("keydown",b),()=>E.removeEventListener("keydown",b)}},[a,g]),f.jsxs(zU,{ref:l,role:"region","aria-label":s.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&f.jsx(n0,{ref:c,onFocusFromOutsideViewport:()=>{const E=g({tabbingDirection:"forwards"});bw(E)}}),f.jsx(uE.Slot,{scope:n,children:f.jsx(_n.ol,{tabIndex:-1,...i,ref:m})}),v&&f.jsx(n0,{ref:u,onFocusFromOutsideViewport:()=>{const E=g({tabbingDirection:"backwards"});bw(E)}})]})});QN.displayName=GN;var YN="ToastFocusProxy",n0=y.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=jy(YN,n);return f.jsx(Vy,{tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=i.viewport)!=null&&c.contains(a))&&r()}})});n0.displayName=YN;var Jf="Toast",s3="toast.swipeStart",i3="toast.swipeMove",o3="toast.swipeCancel",a3="toast.swipeEnd",JN=y.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[a,l]=lE({prop:r,defaultProp:s??!0,onChange:i,caller:Jf});return f.jsx(Si,{present:n||a,children:f.jsx(u3,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:jr(t.onPause),onResume:jr(t.onResume),onSwipeStart:en(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:en(t.onSwipeMove,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:en(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:en(t.onSwipeEnd,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),l(!1)})})})});JN.displayName=Jf;var[l3,c3]=HN(Jf,{onClose(){}}),u3=y.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:m,onSwipeEnd:p,...v}=t,g=jy(Jf,n),[E,b]=y.useState(null),_=Qn(e,X=>b(X)),S=y.useRef(null),P=y.useRef(null),T=s||g.duration,N=y.useRef(0),I=y.useRef(T),A=y.useRef(0),{onToastAdd:R,onToastRemove:k}=g,C=jr(()=>{var Ne;(E==null?void 0:E.contains(document.activeElement))&&((Ne=g.viewport)==null||Ne.focus()),o()}),L=y.useCallback(X=>{!X||X===1/0||(window.clearTimeout(A.current),N.current=new Date().getTime(),A.current=window.setTimeout(C,X))},[C]);y.useEffect(()=>{const X=g.viewport;if(X){const Ne=()=>{L(I.current),c==null||c()},Le=()=>{const Fe=new Date().getTime()-N.current;I.current=I.current-Fe,window.clearTimeout(A.current),l==null||l()};return X.addEventListener(e0,Le),X.addEventListener(t0,Ne),()=>{X.removeEventListener(e0,Le),X.removeEventListener(t0,Ne)}}},[g.viewport,T,l,c,L]),y.useEffect(()=>{i&&!g.isClosePausedRef.current&&L(T)},[i,T,g.isClosePausedRef,L]),y.useEffect(()=>(R(),()=>k()),[R,k]);const O=y.useMemo(()=>E?sk(E):null,[E]);return g.viewport?f.jsxs(f.Fragment,{children:[O&&f.jsx(d3,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite",children:O}),f.jsx(l3,{scope:n,onClose:C,children:Qf.createPortal(f.jsx(uE.ItemSlot,{scope:n,children:f.jsx(BU,{asChild:!0,onEscapeKeyDown:en(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||C(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:f.jsx(_n.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection,...v,ref:_,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:en(t.onKeyDown,X=>{X.key==="Escape"&&(a==null||a(X.nativeEvent),X.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,C()))}),onPointerDown:en(t.onPointerDown,X=>{X.button===0&&(S.current={x:X.clientX,y:X.clientY})}),onPointerMove:en(t.onPointerMove,X=>{if(!S.current)return;const Ne=X.clientX-S.current.x,Le=X.clientY-S.current.y,Fe=!!P.current,W=["left","right"].includes(g.swipeDirection),Y=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,le=W?Y(0,Ne):0,pe=W?0:Y(0,Le),fe=X.pointerType==="touch"?10:2,Ge={x:le,y:pe},Ie={originalEvent:X,delta:Ge};Fe?(P.current=Ge,Km(i3,h,Ie,{discrete:!1})):rx(Ge,g.swipeDirection,fe)?(P.current=Ge,Km(s3,u,Ie,{discrete:!1}),X.target.setPointerCapture(X.pointerId)):(Math.abs(Ne)>fe||Math.abs(Le)>fe)&&(S.current=null)}),onPointerUp:en(t.onPointerUp,X=>{const Ne=P.current,Le=X.target;if(Le.hasPointerCapture(X.pointerId)&&Le.releasePointerCapture(X.pointerId),P.current=null,S.current=null,Ne){const Fe=X.currentTarget,W={originalEvent:X,delta:Ne};rx(Ne,g.swipeDirection,g.swipeThreshold)?Km(a3,p,W,{discrete:!0}):Km(o3,m,W,{discrete:!0}),Fe.addEventListener("click",Y=>Y.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),d3=t=>{const{__scopeToast:e,children:n,...r}=t,s=jy(Jf,e),[i,o]=y.useState(!1),[a,l]=y.useState(!1);return m3(()=>o(!0)),y.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:f.jsx(aE,{asChild:!0,children:f.jsx(Vy,{...r,children:i&&f.jsxs(f.Fragment,{children:[s.label," ",n]})})})},h3="ToastTitle",XN=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return f.jsx(_n.div,{...r,ref:e})});XN.displayName=h3;var f3="ToastDescription",ZN=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return f.jsx(_n.div,{...r,ref:e})});ZN.displayName=f3;var ek="ToastAction",tk=y.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?f.jsx(rk,{altText:n,asChild:!0,children:f.jsx(dE,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${ek}\`. Expected non-empty \`string\`.`),null)});tk.displayName=ek;var nk="ToastClose",dE=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=c3(nk,n);return f.jsx(rk,{asChild:!0,children:f.jsx(_n.button,{type:"button",...r,ref:e,onClick:en(t.onClick,s.onClose)})})});dE.displayName=nk;var rk=y.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return f.jsx(_n.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function sk(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),p3(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...sk(r))}}),e}function Km(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?BN(s,i):s.dispatchEvent(i)}var rx=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function m3(t=()=>{}){const e=jr(t);Zi(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function p3(t){return t.nodeType===t.ELEMENT_NODE}function g3(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function bw(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var y3=KN,ik=QN,ok=JN,ak=XN,lk=ZN,ck=tk,uk=dE;function dk(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=dk(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function hk(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=dk(t))&&(r&&(r+=" "),r+=e);return r}const sx=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,ix=hk,Fy=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return ix(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],h=i==null?void 0:i[c];if(u===null)return null;const m=sx(u)||sx(h);return s[c][m]}),a=n&&Object.entries(n).reduce((c,u)=>{let[h,m]=u;return m===void 0||(c[h]=m),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:h,className:m,...p}=u;return Object.entries(p).every(v=>{let[g,E]=v;return Array.isArray(E)?E.includes({...i,...a}[g]):{...i,...a}[g]===E})?[...c,h,m]:c},[]);return ix(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),w3=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),ox=t=>{const e=w3(t);return e.charAt(0).toUpperCase()+e.slice(1)},fk=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),_3=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var b3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=y.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},l)=>y.createElement("svg",{ref:l,...b3,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:fk("lucide",s),...!i&&!_3(a)&&{"aria-hidden":"true"},...a},[...o.map(([c,u])=>y.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=(t,e)=>{const n=y.forwardRef(({className:r,...s},i)=>y.createElement(E3,{ref:i,iconNode:e,className:fk(`lucide-${v3(ox(t))}`,`lucide-${t}`,r),...s}));return n.displayName=ox(t),n};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],I3=Ot("arrow-down",S3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],mk=Ot("arrow-right",T3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],A3=Ot("arrow-up-down",x3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"M9 9h.01",key:"1q5me6"}],["path",{d:"M15 15h.01",key:"lqbp3k"}]],R3=Ot("badge-percent",P3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],pk=Ot("check",C3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],k3=Ot("circle-alert",N3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],O3=Ot("circle-check",D3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ax=Ot("clock",L3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],V3=Ot("credit-card",M3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],jh=Ot("eye-off",j3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Fh=Ot("eye",F3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],$3=Ot("file-text",U3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],z3=Ot("house",B3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],q3=Ot("image",W3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H3=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],K3=Ot("landmark",H3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],hE=Ot("loader-circle",G3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Uy=Ot("lock",Q3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y3=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],r0=Ot("log-out",Y3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],s0=Ot("mail",J3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Hc=Ot("message-circle",X3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],e5=Ot("message-square",Z3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t5=[["path",{d:"M5 12h14",key:"1ays0h"}]],n5=Ot("minus",t5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r5=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],s5=Ot("phone",r5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i5=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],lx=Ot("plus",i5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o5=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],cx=Ot("receipt",o5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a5=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],fE=Ot("refresh-ccw",a5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],c5=Ot("refresh-cw",l5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u5=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],d5=Ot("send",u5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ux=Ot("settings",h5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f5=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],mE=Ot("shield",f5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m5=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],gk=Ot("smartphone",m5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p5=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],g5=Ot("square",p5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y5=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],v5=Ot("store",y5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w5=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],yk=Ot("trash-2",w5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _5=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],b5=Ot("trending-up",_5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E5=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],vk=Ot("triangle-alert",E5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S5=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],I5=Ot("user",S5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T5=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],x5=Ot("wrench",T5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A5=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ui=Ot("x",A5),pE="-",P5=t=>{const e=C5(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const a=o.split(pE);return a[0]===""&&a.length!==1&&a.shift(),wk(a,e)||R5(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&r[o]?[...l,...r[o]]:l}}},wk=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),s=r?wk(t.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=t.join(pE);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},dx=/^\[(.+)\]$/,R5=t=>{if(dx.test(t)){const e=dx.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},C5=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return k5(Object.entries(t.classGroups),n).forEach(([i,o])=>{i0(o,r,i,e)}),r},i0=(t,e,n,r)=>{t.forEach(s=>{if(typeof s=="string"){const i=s===""?e:hx(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(N5(s)){i0(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,o])=>{i0(o,hx(e,i),n,r)})})},hx=(t,e)=>{let n=t;return e.split(pE).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},N5=t=>t.isThemeGetter,k5=(t,e)=>e?t.map(([n,r])=>{const s=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[n,s]}):t,D5=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const s=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return s(i,o),o},set(i,o){n.has(i)?n.set(i,o):s(i,o)}}},_k="!",O5=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,s=e[0],i=e.length,o=a=>{const l=[];let c=0,u=0,h;for(let E=0;E<a.length;E++){let b=a[E];if(c===0){if(b===s&&(r||a.slice(E,E+i)===e)){l.push(a.slice(u,E)),u=E+i;continue}if(b==="/"){h=E;continue}}b==="["?c++:b==="]"&&c--}const m=l.length===0?a:a.substring(u),p=m.startsWith(_k),v=p?m.substring(1):m,g=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:v,maybePostfixModifierPosition:g}};return n?a=>n({className:a,parseClassName:o}):o},L5=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},M5=t=>({cache:D5(t.cacheSize),parseClassName:O5(t),...P5(t)}),V5=/\s+/,j5=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=e,i=[],o=t.trim().split(V5);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:p}=n(c);let v=!!p,g=r(v?m.substring(0,p):m);if(!g){if(!v){a=c+(a.length>0?" "+a:a);continue}if(g=r(m),!g){a=c+(a.length>0?" "+a:a);continue}v=!1}const E=L5(u).join(":"),b=h?E+_k:E,_=b+g;if(i.includes(_))continue;i.push(_);const S=s(g,v);for(let P=0;P<S.length;++P){const T=S[P];i.push(b+T)}a=c+(a.length>0?" "+a:a)}return a};function F5(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=bk(e))&&(r&&(r+=" "),r+=n);return r}const bk=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=bk(t[r]))&&(n&&(n+=" "),n+=e);return n};function U5(t,...e){let n,r,s,i=o;function o(l){const c=e.reduce((u,h)=>h(u),t());return n=M5(c),r=n.cache.get,s=n.cache.set,i=a,a(l)}function a(l){const c=r(l);if(c)return c;const u=j5(l,n);return s(l,u),u}return function(){return i(F5.apply(null,arguments))}}const Cn=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},Ek=/^\[(?:([a-z-]+):)?(.+)\]$/i,$5=/^\d+\/\d+$/,B5=new Set(["px","full","screen"]),z5=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,W5=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,q5=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,H5=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,K5=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,lo=t=>Eu(t)||B5.has(t)||$5.test(t),Go=t=>Pd(t,"length",t$),Eu=t=>!!t&&!Number.isNaN(Number(t)),Ew=t=>Pd(t,"number",Eu),ah=t=>!!t&&Number.isInteger(Number(t)),G5=t=>t.endsWith("%")&&Eu(t.slice(0,-1)),Rt=t=>Ek.test(t),Qo=t=>z5.test(t),Q5=new Set(["length","size","percentage"]),Y5=t=>Pd(t,Q5,Sk),J5=t=>Pd(t,"position",Sk),X5=new Set(["image","url"]),Z5=t=>Pd(t,X5,r$),e$=t=>Pd(t,"",n$),lh=()=>!0,Pd=(t,e,n)=>{const r=Ek.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},t$=t=>W5.test(t)&&!q5.test(t),Sk=()=>!1,n$=t=>H5.test(t),r$=t=>K5.test(t),s$=()=>{const t=Cn("colors"),e=Cn("spacing"),n=Cn("blur"),r=Cn("brightness"),s=Cn("borderColor"),i=Cn("borderRadius"),o=Cn("borderSpacing"),a=Cn("borderWidth"),l=Cn("contrast"),c=Cn("grayscale"),u=Cn("hueRotate"),h=Cn("invert"),m=Cn("gap"),p=Cn("gradientColorStops"),v=Cn("gradientColorStopPositions"),g=Cn("inset"),E=Cn("margin"),b=Cn("opacity"),_=Cn("padding"),S=Cn("saturate"),P=Cn("scale"),T=Cn("sepia"),N=Cn("skew"),I=Cn("space"),A=Cn("translate"),R=()=>["auto","contain","none"],k=()=>["auto","hidden","clip","visible","scroll"],C=()=>["auto",Rt,e],L=()=>[Rt,e],O=()=>["",lo,Go],X=()=>["auto",Eu,Rt],Ne=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Le=()=>["solid","dashed","dotted","double","none"],Fe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],W=()=>["start","end","center","between","around","evenly","stretch"],Y=()=>["","0",Rt],le=()=>["auto","avoid","all","avoid-page","page","left","right","column"],pe=()=>[Eu,Rt];return{cacheSize:500,separator:":",theme:{colors:[lh],spacing:[lo,Go],blur:["none","",Qo,Rt],brightness:pe(),borderColor:[t],borderRadius:["none","","full",Qo,Rt],borderSpacing:L(),borderWidth:O(),contrast:pe(),grayscale:Y(),hueRotate:pe(),invert:Y(),gap:L(),gradientColorStops:[t],gradientColorStopPositions:[G5,Go],inset:C(),margin:C(),opacity:pe(),padding:L(),saturate:pe(),scale:pe(),sepia:Y(),skew:pe(),space:L(),translate:L()},classGroups:{aspect:[{aspect:["auto","square","video",Rt]}],container:["container"],columns:[{columns:[Qo]}],"break-after":[{"break-after":le()}],"break-before":[{"break-before":le()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Ne(),Rt]}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ah,Rt]}],basis:[{basis:C()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Rt]}],grow:[{grow:Y()}],shrink:[{shrink:Y()}],order:[{order:["first","last","none",ah,Rt]}],"grid-cols":[{"grid-cols":[lh]}],"col-start-end":[{col:["auto",{span:["full",ah,Rt]},Rt]}],"col-start":[{"col-start":X()}],"col-end":[{"col-end":X()}],"grid-rows":[{"grid-rows":[lh]}],"row-start-end":[{row:["auto",{span:[ah,Rt]},Rt]}],"row-start":[{"row-start":X()}],"row-end":[{"row-end":X()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Rt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Rt]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...W()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...W(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...W(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Rt,e]}],"min-w":[{"min-w":[Rt,e,"min","max","fit"]}],"max-w":[{"max-w":[Rt,e,"none","full","min","max","fit","prose",{screen:[Qo]},Qo]}],h:[{h:[Rt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Rt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Rt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Rt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Qo,Go]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ew]}],"font-family":[{font:[lh]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Rt]}],"line-clamp":[{"line-clamp":["none",Eu,Ew]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",lo,Rt]}],"list-image":[{"list-image":["none",Rt]}],"list-style-type":[{list:["none","disc","decimal",Rt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Le(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",lo,Go]}],"underline-offset":[{"underline-offset":["auto",lo,Rt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:L()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Rt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Rt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Ne(),J5]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Y5]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Z5]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...Le(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:Le()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...Le()]}],"outline-offset":[{"outline-offset":[lo,Rt]}],"outline-w":[{outline:[lo,Go]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[lo,Go]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Qo,e$]}],"shadow-color":[{shadow:[lh]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...Fe(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Fe()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Qo,Rt]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[S]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Rt]}],duration:[{duration:pe()}],ease:[{ease:["linear","in","out","in-out",Rt]}],delay:[{delay:pe()}],animate:[{animate:["none","spin","ping","pulse","bounce",Rt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[P]}],"scale-x":[{"scale-x":[P]}],"scale-y":[{"scale-y":[P]}],rotate:[{rotate:[ah,Rt]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Rt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Rt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":L()}],"scroll-mx":[{"scroll-mx":L()}],"scroll-my":[{"scroll-my":L()}],"scroll-ms":[{"scroll-ms":L()}],"scroll-me":[{"scroll-me":L()}],"scroll-mt":[{"scroll-mt":L()}],"scroll-mr":[{"scroll-mr":L()}],"scroll-mb":[{"scroll-mb":L()}],"scroll-ml":[{"scroll-ml":L()}],"scroll-p":[{"scroll-p":L()}],"scroll-px":[{"scroll-px":L()}],"scroll-py":[{"scroll-py":L()}],"scroll-ps":[{"scroll-ps":L()}],"scroll-pe":[{"scroll-pe":L()}],"scroll-pt":[{"scroll-pt":L()}],"scroll-pr":[{"scroll-pr":L()}],"scroll-pb":[{"scroll-pb":L()}],"scroll-pl":[{"scroll-pl":L()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Rt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[lo,Go,Ew]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},i$=U5(s$);function yn(...t){return i$(hk(t))}function Nte(t){const e=Number(t)||0;return new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}const o$=y3,Ik=y.forwardRef(({className:t,...e},n)=>f.jsx(ik,{ref:n,className:yn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));Ik.displayName=ik.displayName;const a$=Fy("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Tk=y.forwardRef(({className:t,variant:e,...n},r)=>f.jsx(ok,{ref:r,className:yn(a$({variant:e}),t),...n}));Tk.displayName=ok.displayName;const l$=y.forwardRef(({className:t,...e},n)=>f.jsx(ck,{ref:n,className:yn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));l$.displayName=ck.displayName;const xk=y.forwardRef(({className:t,...e},n)=>f.jsx(uk,{ref:n,className:yn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:f.jsx(Ui,{className:"h-4 w-4"})}));xk.displayName=uk.displayName;const Ak=y.forwardRef(({className:t,...e},n)=>f.jsx(ak,{ref:n,className:yn("text-sm font-semibold",t),...e}));Ak.displayName=ak.displayName;const Pk=y.forwardRef(({className:t,...e},n)=>f.jsx(lk,{ref:n,className:yn("text-sm opacity-90",t),...e}));Pk.displayName=lk.displayName;function c$(){const{toasts:t}=ll();return f.jsxs(o$,{children:[t.map(function({id:e,title:n,description:r,action:s,...i}){return f.jsxs(Tk,{...i,children:[f.jsxs("div",{className:"grid gap-1",children:[n&&f.jsx(Ak,{children:n}),r&&f.jsx(Pk,{children:r})]}),s,f.jsx(xk,{})]},e)}),f.jsx(Ik,{})]})}var xg=["light","dark"],gE="(prefers-color-scheme: dark)",u$=typeof window>"u",yE=y.createContext(void 0),d$={setTheme:t=>{},themes:[]},Rk=()=>{var t;return(t=y.useContext(yE))!=null?t:d$},h$=t=>y.useContext(yE)?t.children:y.createElement(m$,{...t}),f$=["light","dark"],m$=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:n=!0,enableColorScheme:r=!0,storageKey:s="theme",themes:i=f$,defaultTheme:o=n?"system":"light",attribute:a="data-theme",value:l,children:c,nonce:u})=>{let[h,m]=y.useState(()=>fx(s,o)),[p,v]=y.useState(()=>fx(s)),g=l?Object.values(l):i,E=y.useCallback(P=>{let T=P;if(!T)return;P==="system"&&n&&(T=mx());let N=l?l[T]:T,I=e?g$():null,A=document.documentElement;if(a==="class"?(A.classList.remove(...g),N&&A.classList.add(N)):N?A.setAttribute(a,N):A.removeAttribute(a),r){let R=xg.includes(o)?o:null,k=xg.includes(T)?T:R;A.style.colorScheme=k}I==null||I()},[]),b=y.useCallback(P=>{let T=typeof P=="function"?P(P):P;m(T);try{localStorage.setItem(s,T)}catch{}},[t]),_=y.useCallback(P=>{let T=mx(P);v(T),h==="system"&&n&&!t&&E("system")},[h,t]);y.useEffect(()=>{let P=window.matchMedia(gE);return P.addListener(_),_(P),()=>P.removeListener(_)},[_]),y.useEffect(()=>{let P=T=>{if(T.key!==s)return;let N=T.newValue||o;b(N)};return window.addEventListener("storage",P),()=>window.removeEventListener("storage",P)},[b]),y.useEffect(()=>{E(t??h)},[t,h]);let S=y.useMemo(()=>({theme:h,setTheme:b,forcedTheme:t,resolvedTheme:h==="system"?p:h,themes:n?[...i,"system"]:i,systemTheme:n?p:void 0}),[h,b,t,p,n,i]);return y.createElement(yE.Provider,{value:S},y.createElement(p$,{forcedTheme:t,disableTransitionOnChange:e,enableSystem:n,enableColorScheme:r,storageKey:s,themes:i,defaultTheme:o,attribute:a,value:l,children:c,attrs:g,nonce:u}),c)},p$=y.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:o,attrs:a,nonce:l})=>{let c=i==="system",u=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(v=>`'${v}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,h=s?xg.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",m=(v,g=!1,E=!0)=>{let b=o?o[v]:v,_=g?v+"|| ''":`'${b}'`,S="";return s&&E&&!g&&xg.includes(v)&&(S+=`d.style.colorScheme = '${v}';`),n==="class"?g||b?S+=`c.add(${_})`:S+="null":b&&(S+=`d[s](n,${_})`),S},p=t?`!function(){${u}${m(t)}}()`:r?`!function(){try{${u}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${c})){var t='${gE}',m=window.matchMedia(t);if(m.media!==t||m.matches){${m("dark")}}else{${m("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${m(o?"x[e]":"e",!0)}}${c?"":"else{"+m(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${m(o?"x[e]":"e",!0)}}else{${m(i,!1,!1)};}${h}}catch(t){}}();`;return y.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})}),fx=(t,e)=>{if(u$)return;let n;try{n=localStorage.getItem(t)||void 0}catch{}return n||e},g$=()=>{let t=document.createElement("style");return t.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},mx=t=>(t||(t=window.matchMedia(gE)),t.matches?"dark":"light"),y$=t=>{switch(t){case"success":return _$;case"info":return E$;case"warning":return b$;case"error":return S$;default:return null}},v$=Array(12).fill(0),w$=({visible:t,className:e})=>V.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},V.createElement("div",{className:"sonner-spinner"},v$.map((n,r)=>V.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),_$=V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},V.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),b$=V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},V.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),E$=V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},V.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),S$=V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},V.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),I$=V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},V.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),V.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),T$=()=>{let[t,e]=V.useState(document.hidden);return V.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},o0=1,x$=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let n=this.subscribers.indexOf(e);this.subscribers.splice(n,1)}),this.publish=e=>{this.subscribers.forEach(n=>n(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var n;let{message:r,...s}=e,i=typeof(e==null?void 0:e.id)=="number"||((n=e.id)==null?void 0:n.length)>0?e.id:o0++,o=this.toasts.find(l=>l.id===i),a=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),o?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...e,id:i,title:r}),{...l,...e,id:i,dismissible:a,title:r}):l):this.addToast({title:r,...s,dismissible:a,id:i}),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:e,dismiss:!0})),e),this.message=(e,n)=>this.create({...n,message:e}),this.error=(e,n)=>this.create({...n,message:e,type:"error"}),this.success=(e,n)=>this.create({...n,type:"success",message:e}),this.info=(e,n)=>this.create({...n,type:"info",message:e}),this.warning=(e,n)=>this.create({...n,type:"warning",message:e}),this.loading=(e,n)=>this.create({...n,type:"loading",message:e}),this.promise=(e,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:e,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let s=e instanceof Promise?e:e(),i=r!==void 0,o,a=s.then(async c=>{if(o=["resolve",c],V.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(P$(c)&&!c.ok){i=!1;let u=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,h=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description;this.create({id:r,type:"error",message:u,description:h})}else if(n.success!==void 0){i=!1;let u=typeof n.success=="function"?await n.success(c):n.success,h=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"success",message:u,description:h})}}).catch(async c=>{if(o=["reject",c],n.error!==void 0){i=!1;let u=typeof n.error=="function"?await n.error(c):n.error,h=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"error",message:u,description:h})}}).finally(()=>{var c;i&&(this.dismiss(r),r=void 0),(c=n.finally)==null||c.call(n)}),l=()=>new Promise((c,u)=>a.then(()=>o[0]==="reject"?u(o[1]):c(o[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(e,n)=>{let r=(n==null?void 0:n.id)||o0++;return this.create({jsx:e(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},cs=new x$,A$=(t,e)=>{let n=(e==null?void 0:e.id)||o0++;return cs.addToast({title:t,...e,id:n}),n},P$=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",R$=A$,C$=()=>cs.toasts,N$=()=>cs.getActiveToasts(),kt=Object.assign(R$,{success:cs.success,info:cs.info,warning:cs.warning,error:cs.error,custom:cs.custom,message:cs.message,promise:cs.promise,dismiss:cs.dismiss,loading:cs.loading},{getHistory:C$,getToasts:N$});function k$(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}k$(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Gm(t){return t.label!==void 0}var D$=3,O$="32px",L$="16px",px=4e3,M$=356,V$=14,j$=20,F$=200;function ri(...t){return t.filter(Boolean).join(" ")}function U$(t){let[e,n]=t.split("-"),r=[];return e&&r.push(e),n&&r.push(n),r}var $$=t=>{var e,n,r,s,i,o,a,l,c,u,h;let{invert:m,toast:p,unstyled:v,interacting:g,setHeights:E,visibleToasts:b,heights:_,index:S,toasts:P,expanded:T,removeToast:N,defaultRichColors:I,closeButton:A,style:R,cancelButtonStyle:k,actionButtonStyle:C,className:L="",descriptionClassName:O="",duration:X,position:Ne,gap:Le,loadingIcon:Fe,expandByDefault:W,classNames:Y,icons:le,closeButtonAriaLabel:pe="Close toast",pauseWhenPageIsHidden:fe}=t,[Ge,Ie]=V.useState(null),[ve,J]=V.useState(null),[qe,dn]=V.useState(!1),[dr,Xn]=V.useState(!1),[sr,Dr]=V.useState(!1),[Or,Lr]=V.useState(!1),[Q,de]=V.useState(!1),[_e,nt]=V.useState(0),[he,Ce]=V.useState(0),Ue=V.useRef(p.duration||X||px),rt=V.useRef(null),lt=V.useRef(null),Lt=S===0,Ct=S+1<=b,q=p.type,ge=p.dismissible!==!1,ke=p.className||"",Re=p.descriptionClassName||"",ue=V.useMemo(()=>_.findIndex(te=>te.toastId===p.id)||0,[_,p.id]),ae=V.useMemo(()=>{var te;return(te=p.closeButton)!=null?te:A},[p.closeButton,A]),Tt=V.useMemo(()=>p.duration||X||px,[p.duration,X]),_t=V.useRef(0),Mt=V.useRef(0),Zn=V.useRef(0),M=V.useRef(null),[z,j]=Ne.split("-"),Z=V.useMemo(()=>_.reduce((te,ne,be)=>be>=ue?te:te+ne.height,0),[_,ue]),K=T$(),oe=p.invert||m,H=q==="loading";Mt.current=V.useMemo(()=>ue*Le+Z,[ue,Z]),V.useEffect(()=>{Ue.current=Tt},[Tt]),V.useEffect(()=>{dn(!0)},[]),V.useEffect(()=>{let te=lt.current;if(te){let ne=te.getBoundingClientRect().height;return Ce(ne),E(be=>[{toastId:p.id,height:ne,position:p.position},...be]),()=>E(be=>be.filter(ze=>ze.toastId!==p.id))}},[E,p.id]),V.useLayoutEffect(()=>{if(!qe)return;let te=lt.current,ne=te.style.height;te.style.height="auto";let be=te.getBoundingClientRect().height;te.style.height=ne,Ce(be),E(ze=>ze.find(Qe=>Qe.toastId===p.id)?ze.map(Qe=>Qe.toastId===p.id?{...Qe,height:be}:Qe):[{toastId:p.id,height:be,position:p.position},...ze])},[qe,p.title,p.description,E,p.id]);let Ae=V.useCallback(()=>{Xn(!0),nt(Mt.current),E(te=>te.filter(ne=>ne.toastId!==p.id)),setTimeout(()=>{N(p)},F$)},[p,N,E,Mt]);V.useEffect(()=>{if(p.promise&&q==="loading"||p.duration===1/0||p.type==="loading")return;let te;return T||g||fe&&K?(()=>{if(Zn.current<_t.current){let ne=new Date().getTime()-_t.current;Ue.current=Ue.current-ne}Zn.current=new Date().getTime()})():Ue.current!==1/0&&(_t.current=new Date().getTime(),te=setTimeout(()=>{var ne;(ne=p.onAutoClose)==null||ne.call(p,p),Ae()},Ue.current)),()=>clearTimeout(te)},[T,g,p,q,fe,K,Ae]),V.useEffect(()=>{p.delete&&Ae()},[Ae,p.delete]);function st(){var te,ne,be;return le!=null&&le.loading?V.createElement("div",{className:ri(Y==null?void 0:Y.loader,(te=p==null?void 0:p.classNames)==null?void 0:te.loader,"sonner-loader"),"data-visible":q==="loading"},le.loading):Fe?V.createElement("div",{className:ri(Y==null?void 0:Y.loader,(ne=p==null?void 0:p.classNames)==null?void 0:ne.loader,"sonner-loader"),"data-visible":q==="loading"},Fe):V.createElement(w$,{className:ri(Y==null?void 0:Y.loader,(be=p==null?void 0:p.classNames)==null?void 0:be.loader),visible:q==="loading"})}return V.createElement("li",{tabIndex:0,ref:lt,className:ri(L,ke,Y==null?void 0:Y.toast,(e=p==null?void 0:p.classNames)==null?void 0:e.toast,Y==null?void 0:Y.default,Y==null?void 0:Y[q],(n=p==null?void 0:p.classNames)==null?void 0:n[q]),"data-sonner-toast":"","data-rich-colors":(r=p.richColors)!=null?r:I,"data-styled":!(p.jsx||p.unstyled||v),"data-mounted":qe,"data-promise":!!p.promise,"data-swiped":Q,"data-removed":dr,"data-visible":Ct,"data-y-position":z,"data-x-position":j,"data-index":S,"data-front":Lt,"data-swiping":sr,"data-dismissible":ge,"data-type":q,"data-invert":oe,"data-swipe-out":Or,"data-swipe-direction":ve,"data-expanded":!!(T||W&&qe),style:{"--index":S,"--toasts-before":S,"--z-index":P.length-S,"--offset":`${dr?_e:Mt.current}px`,"--initial-height":W?"auto":`${he}px`,...R,...p.style},onDragEnd:()=>{Dr(!1),Ie(null),M.current=null},onPointerDown:te=>{H||!ge||(rt.current=new Date,nt(Mt.current),te.target.setPointerCapture(te.pointerId),te.target.tagName!=="BUTTON"&&(Dr(!0),M.current={x:te.clientX,y:te.clientY}))},onPointerUp:()=>{var te,ne,be,ze;if(Or||!ge)return;M.current=null;let Qe=Number(((te=lt.current)==null?void 0:te.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),ft=Number(((ne=lt.current)==null?void 0:ne.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ut=new Date().getTime()-((be=rt.current)==null?void 0:be.getTime()),Pe=Ge==="x"?Qe:ft,it=Math.abs(Pe)/ut;if(Math.abs(Pe)>=j$||it>.11){nt(Mt.current),(ze=p.onDismiss)==null||ze.call(p,p),J(Ge==="x"?Qe>0?"right":"left":ft>0?"down":"up"),Ae(),Lr(!0),de(!1);return}Dr(!1),Ie(null)},onPointerMove:te=>{var ne,be,ze,Qe;if(!M.current||!ge||((ne=window.getSelection())==null?void 0:ne.toString().length)>0)return;let ft=te.clientY-M.current.y,ut=te.clientX-M.current.x,Pe=(be=t.swipeDirections)!=null?be:U$(Ne);!Ge&&(Math.abs(ut)>1||Math.abs(ft)>1)&&Ie(Math.abs(ut)>Math.abs(ft)?"x":"y");let it={x:0,y:0};Ge==="y"?(Pe.includes("top")||Pe.includes("bottom"))&&(Pe.includes("top")&&ft<0||Pe.includes("bottom")&&ft>0)&&(it.y=ft):Ge==="x"&&(Pe.includes("left")||Pe.includes("right"))&&(Pe.includes("left")&&ut<0||Pe.includes("right")&&ut>0)&&(it.x=ut),(Math.abs(it.x)>0||Math.abs(it.y)>0)&&de(!0),(ze=lt.current)==null||ze.style.setProperty("--swipe-amount-x",`${it.x}px`),(Qe=lt.current)==null||Qe.style.setProperty("--swipe-amount-y",`${it.y}px`)}},ae&&!p.jsx?V.createElement("button",{"aria-label":pe,"data-disabled":H,"data-close-button":!0,onClick:H||!ge?()=>{}:()=>{var te;Ae(),(te=p.onDismiss)==null||te.call(p,p)},className:ri(Y==null?void 0:Y.closeButton,(s=p==null?void 0:p.classNames)==null?void 0:s.closeButton)},(i=le==null?void 0:le.close)!=null?i:I$):null,p.jsx||y.isValidElement(p.title)?p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title:V.createElement(V.Fragment,null,q||p.icon||p.promise?V.createElement("div",{"data-icon":"",className:ri(Y==null?void 0:Y.icon,(o=p==null?void 0:p.classNames)==null?void 0:o.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||st():null,p.type!=="loading"?p.icon||(le==null?void 0:le[q])||y$(q):null):null,V.createElement("div",{"data-content":"",className:ri(Y==null?void 0:Y.content,(a=p==null?void 0:p.classNames)==null?void 0:a.content)},V.createElement("div",{"data-title":"",className:ri(Y==null?void 0:Y.title,(l=p==null?void 0:p.classNames)==null?void 0:l.title)},typeof p.title=="function"?p.title():p.title),p.description?V.createElement("div",{"data-description":"",className:ri(O,Re,Y==null?void 0:Y.description,(c=p==null?void 0:p.classNames)==null?void 0:c.description)},typeof p.description=="function"?p.description():p.description):null),y.isValidElement(p.cancel)?p.cancel:p.cancel&&Gm(p.cancel)?V.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||k,onClick:te=>{var ne,be;Gm(p.cancel)&&ge&&((be=(ne=p.cancel).onClick)==null||be.call(ne,te),Ae())},className:ri(Y==null?void 0:Y.cancelButton,(u=p==null?void 0:p.classNames)==null?void 0:u.cancelButton)},p.cancel.label):null,y.isValidElement(p.action)?p.action:p.action&&Gm(p.action)?V.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||C,onClick:te=>{var ne,be;Gm(p.action)&&((be=(ne=p.action).onClick)==null||be.call(ne,te),!te.defaultPrevented&&Ae())},className:ri(Y==null?void 0:Y.actionButton,(h=p==null?void 0:p.classNames)==null?void 0:h.actionButton)},p.action.label):null))};function gx(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function B$(t,e){let n={};return[t,e].forEach((r,s)=>{let i=s===1,o=i?"--mobile-offset":"--offset",a=i?L$:O$;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${o}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${o}-${c}`]=a:n[`${o}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(a)}),n}var z$=y.forwardRef(function(t,e){let{invert:n,position:r="bottom-right",hotkey:s=["altKey","KeyT"],expand:i,closeButton:o,className:a,offset:l,mobileOffset:c,theme:u="light",richColors:h,duration:m,style:p,visibleToasts:v=D$,toastOptions:g,dir:E=gx(),gap:b=V$,loadingIcon:_,icons:S,containerAriaLabel:P="Notifications",pauseWhenPageIsHidden:T}=t,[N,I]=V.useState([]),A=V.useMemo(()=>Array.from(new Set([r].concat(N.filter(fe=>fe.position).map(fe=>fe.position)))),[N,r]),[R,k]=V.useState([]),[C,L]=V.useState(!1),[O,X]=V.useState(!1),[Ne,Le]=V.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Fe=V.useRef(null),W=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),Y=V.useRef(null),le=V.useRef(!1),pe=V.useCallback(fe=>{I(Ge=>{var Ie;return(Ie=Ge.find(ve=>ve.id===fe.id))!=null&&Ie.delete||cs.dismiss(fe.id),Ge.filter(({id:ve})=>ve!==fe.id)})},[]);return V.useEffect(()=>cs.subscribe(fe=>{if(fe.dismiss){I(Ge=>Ge.map(Ie=>Ie.id===fe.id?{...Ie,delete:!0}:Ie));return}setTimeout(()=>{UN.flushSync(()=>{I(Ge=>{let Ie=Ge.findIndex(ve=>ve.id===fe.id);return Ie!==-1?[...Ge.slice(0,Ie),{...Ge[Ie],...fe},...Ge.slice(Ie+1)]:[fe,...Ge]})})})}),[]),V.useEffect(()=>{if(u!=="system"){Le(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Le("dark"):Le("light")),typeof window>"u")return;let fe=window.matchMedia("(prefers-color-scheme: dark)");try{fe.addEventListener("change",({matches:Ge})=>{Le(Ge?"dark":"light")})}catch{fe.addListener(({matches:Ie})=>{try{Le(Ie?"dark":"light")}catch(ve){console.error(ve)}})}},[u]),V.useEffect(()=>{N.length<=1&&L(!1)},[N]),V.useEffect(()=>{let fe=Ge=>{var Ie,ve;s.every(J=>Ge[J]||Ge.code===J)&&(L(!0),(Ie=Fe.current)==null||Ie.focus()),Ge.code==="Escape"&&(document.activeElement===Fe.current||(ve=Fe.current)!=null&&ve.contains(document.activeElement))&&L(!1)};return document.addEventListener("keydown",fe),()=>document.removeEventListener("keydown",fe)},[s]),V.useEffect(()=>{if(Fe.current)return()=>{Y.current&&(Y.current.focus({preventScroll:!0}),Y.current=null,le.current=!1)}},[Fe.current]),V.createElement("section",{ref:e,"aria-label":`${P} ${W}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},A.map((fe,Ge)=>{var Ie;let[ve,J]=fe.split("-");return N.length?V.createElement("ol",{key:fe,dir:E==="auto"?gx():E,tabIndex:-1,ref:Fe,className:a,"data-sonner-toaster":!0,"data-theme":Ne,"data-y-position":ve,"data-lifted":C&&N.length>1&&!i,"data-x-position":J,style:{"--front-toast-height":`${((Ie=R[0])==null?void 0:Ie.height)||0}px`,"--width":`${M$}px`,"--gap":`${b}px`,...p,...B$(l,c)},onBlur:qe=>{le.current&&!qe.currentTarget.contains(qe.relatedTarget)&&(le.current=!1,Y.current&&(Y.current.focus({preventScroll:!0}),Y.current=null))},onFocus:qe=>{qe.target instanceof HTMLElement&&qe.target.dataset.dismissible==="false"||le.current||(le.current=!0,Y.current=qe.relatedTarget)},onMouseEnter:()=>L(!0),onMouseMove:()=>L(!0),onMouseLeave:()=>{O||L(!1)},onDragEnd:()=>L(!1),onPointerDown:qe=>{qe.target instanceof HTMLElement&&qe.target.dataset.dismissible==="false"||X(!0)},onPointerUp:()=>X(!1)},N.filter(qe=>!qe.position&&Ge===0||qe.position===fe).map((qe,dn)=>{var dr,Xn;return V.createElement($$,{key:qe.id,icons:S,index:dn,toast:qe,defaultRichColors:h,duration:(dr=g==null?void 0:g.duration)!=null?dr:m,className:g==null?void 0:g.className,descriptionClassName:g==null?void 0:g.descriptionClassName,invert:n,visibleToasts:v,closeButton:(Xn=g==null?void 0:g.closeButton)!=null?Xn:o,interacting:O,position:fe,style:g==null?void 0:g.style,unstyled:g==null?void 0:g.unstyled,classNames:g==null?void 0:g.classNames,cancelButtonStyle:g==null?void 0:g.cancelButtonStyle,actionButtonStyle:g==null?void 0:g.actionButtonStyle,removeToast:pe,toasts:N.filter(sr=>sr.position==qe.position),heights:R.filter(sr=>sr.position==qe.position),setHeights:k,expandByDefault:i,gap:b,loadingIcon:_,expanded:C,pauseWhenPageIsHidden:T,swipeDirections:t.swipeDirections})})):null}))});const Ck=({...t})=>{const{theme:e="system"}=Rk();return f.jsx(z$,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var W$=_y[" useId ".trim().toString()]||(()=>{}),q$=0;function Sw(t){const[e,n]=y.useState(W$());return Zi(()=>{n(r=>r??String(q$++))},[t]),t||(e?`radix-${e}`:"")}const H$=["top","right","bottom","left"],Ha=Math.min,Rs=Math.max,Ag=Math.round,Qm=Math.floor,Gi=t=>({x:t,y:t}),K$={left:"right",right:"left",bottom:"top",top:"bottom"},G$={start:"end",end:"start"};function a0(t,e,n){return Rs(t,Ha(e,n))}function No(t,e){return typeof t=="function"?t(e):t}function ko(t){return t.split("-")[0]}function Rd(t){return t.split("-")[1]}function vE(t){return t==="x"?"y":"x"}function wE(t){return t==="y"?"height":"width"}const Q$=new Set(["top","bottom"]);function Bi(t){return Q$.has(ko(t))?"y":"x"}function _E(t){return vE(Bi(t))}function Y$(t,e,n){n===void 0&&(n=!1);const r=Rd(t),s=_E(t),i=wE(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Pg(o)),[o,Pg(o)]}function J$(t){const e=Pg(t);return[l0(t),e,l0(e)]}function l0(t){return t.replace(/start|end/g,e=>G$[e])}const yx=["left","right"],vx=["right","left"],X$=["top","bottom"],Z$=["bottom","top"];function eB(t,e,n){switch(t){case"top":case"bottom":return n?e?vx:yx:e?yx:vx;case"left":case"right":return e?X$:Z$;default:return[]}}function tB(t,e,n,r){const s=Rd(t);let i=eB(ko(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(l0)))),i}function Pg(t){return t.replace(/left|right|bottom|top/g,e=>K$[e])}function nB(t){return{top:0,right:0,bottom:0,left:0,...t}}function Nk(t){return typeof t!="number"?nB(t):{top:t,right:t,bottom:t,left:t}}function Rg(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function wx(t,e,n){let{reference:r,floating:s}=t;const i=Bi(e),o=_E(e),a=wE(o),l=ko(e),c=i==="y",u=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,m=r[a]/2-s[a]/2;let p;switch(l){case"top":p={x:u,y:r.y-s.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:h};break;case"left":p={x:r.x-s.width,y:h};break;default:p={x:r.x,y:r.y}}switch(Rd(e)){case"start":p[o]-=m*(n&&c?-1:1);break;case"end":p[o]+=m*(n&&c?-1:1);break}return p}const rB=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:u,y:h}=wx(c,r,l),m=r,p={},v=0;for(let g=0;g<a.length;g++){const{name:E,fn:b}=a[g],{x:_,y:S,data:P,reset:T}=await b({x:u,y:h,initialPlacement:r,placement:m,strategy:s,middlewareData:p,rects:c,platform:o,elements:{reference:t,floating:e}});u=_??u,h=S??h,p={...p,[E]:{...p[E],...P}},T&&v<=50&&(v++,typeof T=="object"&&(T.placement&&(m=T.placement),T.rects&&(c=T.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):T.rects),{x:u,y:h}=wx(c,m,l)),g=-1)}return{x:u,y:h,placement:m,strategy:s,middlewareData:p}};async function vf(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:m=!1,padding:p=0}=No(e,t),v=Nk(p),E=a[m?h==="floating"?"reference":"floating":h],b=Rg(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(E)))==null||n?E:E.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),_=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),P=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},T=Rg(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:_,offsetParent:S,strategy:l}):_);return{top:(b.top-T.top+v.top)/P.y,bottom:(T.bottom-b.bottom+v.bottom)/P.y,left:(b.left-T.left+v.left)/P.x,right:(T.right-b.right+v.right)/P.x}}const sB=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=No(t,e)||{};if(c==null)return{};const h=Nk(u),m={x:n,y:r},p=_E(s),v=wE(p),g=await o.getDimensions(c),E=p==="y",b=E?"top":"left",_=E?"bottom":"right",S=E?"clientHeight":"clientWidth",P=i.reference[v]+i.reference[p]-m[p]-i.floating[v],T=m[p]-i.reference[p],N=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let I=N?N[S]:0;(!I||!await(o.isElement==null?void 0:o.isElement(N)))&&(I=a.floating[S]||i.floating[v]);const A=P/2-T/2,R=I/2-g[v]/2-1,k=Ha(h[b],R),C=Ha(h[_],R),L=k,O=I-g[v]-C,X=I/2-g[v]/2+A,Ne=a0(L,X,O),Le=!l.arrow&&Rd(s)!=null&&X!==Ne&&i.reference[v]/2-(X<L?k:C)-g[v]/2<0,Fe=Le?X<L?X-L:X-O:0;return{[p]:m[p]+Fe,data:{[p]:Ne,centerOffset:X-Ne-Fe,...Le&&{alignmentOffset:Fe}},reset:Le}}}),iB=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:m,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:g=!0,...E}=No(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const b=ko(s),_=Bi(a),S=ko(a)===a,P=await(l.isRTL==null?void 0:l.isRTL(c.floating)),T=m||(S||!g?[Pg(a)]:J$(a)),N=v!=="none";!m&&N&&T.push(...tB(a,g,v,P));const I=[a,...T],A=await vf(e,E),R=[];let k=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&R.push(A[b]),h){const X=Y$(s,o,P);R.push(A[X[0]],A[X[1]])}if(k=[...k,{placement:s,overflows:R}],!R.every(X=>X<=0)){var C,L;const X=(((C=i.flip)==null?void 0:C.index)||0)+1,Ne=I[X];if(Ne&&(!(h==="alignment"?_!==Bi(Ne):!1)||k.every(W=>Bi(W.placement)===_?W.overflows[0]>0:!0)))return{data:{index:X,overflows:k},reset:{placement:Ne}};let Le=(L=k.filter(Fe=>Fe.overflows[0]<=0).sort((Fe,W)=>Fe.overflows[1]-W.overflows[1])[0])==null?void 0:L.placement;if(!Le)switch(p){case"bestFit":{var O;const Fe=(O=k.filter(W=>{if(N){const Y=Bi(W.placement);return Y===_||Y==="y"}return!0}).map(W=>[W.placement,W.overflows.filter(Y=>Y>0).reduce((Y,le)=>Y+le,0)]).sort((W,Y)=>W[1]-Y[1])[0])==null?void 0:O[0];Fe&&(Le=Fe);break}case"initialPlacement":Le=a;break}if(s!==Le)return{reset:{placement:Le}}}return{}}}};function _x(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function bx(t){return H$.some(e=>t[e]>=0)}const oB=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=No(t,e);switch(r){case"referenceHidden":{const i=await vf(e,{...s,elementContext:"reference"}),o=_x(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:bx(o)}}}case"escaped":{const i=await vf(e,{...s,altBoundary:!0}),o=_x(i,n.floating);return{data:{escapedOffsets:o,escaped:bx(o)}}}default:return{}}}}},kk=new Set(["left","top"]);async function aB(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=ko(n),a=Rd(n),l=Bi(n)==="y",c=kk.has(o)?-1:1,u=i&&l?-1:1,h=No(e,t);let{mainAxis:m,crossAxis:p,alignmentAxis:v}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof v=="number"&&(p=a==="end"?v*-1:v),l?{x:p*u,y:m*c}:{x:m*c,y:p*u}}const lB=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await aB(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},cB=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:E=>{let{x:b,y:_}=E;return{x:b,y:_}}},...l}=No(t,e),c={x:n,y:r},u=await vf(e,l),h=Bi(ko(s)),m=vE(h);let p=c[m],v=c[h];if(i){const E=m==="y"?"top":"left",b=m==="y"?"bottom":"right",_=p+u[E],S=p-u[b];p=a0(_,p,S)}if(o){const E=h==="y"?"top":"left",b=h==="y"?"bottom":"right",_=v+u[E],S=v-u[b];v=a0(_,v,S)}const g=a.fn({...e,[m]:p,[h]:v});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[m]:i,[h]:o}}}}}},uB=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=No(t,e),u={x:n,y:r},h=Bi(s),m=vE(h);let p=u[m],v=u[h];const g=No(a,e),E=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const S=m==="y"?"height":"width",P=i.reference[m]-i.floating[S]+E.mainAxis,T=i.reference[m]+i.reference[S]-E.mainAxis;p<P?p=P:p>T&&(p=T)}if(c){var b,_;const S=m==="y"?"width":"height",P=kk.has(ko(s)),T=i.reference[h]-i.floating[S]+(P&&((b=o.offset)==null?void 0:b[h])||0)+(P?0:E.crossAxis),N=i.reference[h]+i.reference[S]+(P?0:((_=o.offset)==null?void 0:_[h])||0)-(P?E.crossAxis:0);v<T?v=T:v>N&&(v=N)}return{[m]:p,[h]:v}}}},dB=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=No(t,e),u=await vf(e,c),h=ko(s),m=Rd(s),p=Bi(s)==="y",{width:v,height:g}=i.floating;let E,b;h==="top"||h==="bottom"?(E=h,b=m===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(b=h,E=m==="end"?"top":"bottom");const _=g-u.top-u.bottom,S=v-u.left-u.right,P=Ha(g-u[E],_),T=Ha(v-u[b],S),N=!e.middlewareData.shift;let I=P,A=T;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(A=S),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(I=_),N&&!m){const k=Rs(u.left,0),C=Rs(u.right,0),L=Rs(u.top,0),O=Rs(u.bottom,0);p?A=v-2*(k!==0||C!==0?k+C:Rs(u.left,u.right)):I=g-2*(L!==0||O!==0?L+O:Rs(u.top,u.bottom))}await l({...e,availableWidth:A,availableHeight:I});const R=await o.getDimensions(a.floating);return v!==R.width||g!==R.height?{reset:{rects:!0}}:{}}}};function $y(){return typeof window<"u"}function Cd(t){return Dk(t)?(t.nodeName||"").toLowerCase():"#document"}function Ds(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function ro(t){var e;return(e=(Dk(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Dk(t){return $y()?t instanceof Node||t instanceof Ds(t).Node:!1}function yi(t){return $y()?t instanceof Element||t instanceof Ds(t).Element:!1}function eo(t){return $y()?t instanceof HTMLElement||t instanceof Ds(t).HTMLElement:!1}function Ex(t){return!$y()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ds(t).ShadowRoot}const hB=new Set(["inline","contents"]);function Xf(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=vi(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!hB.has(s)}const fB=new Set(["table","td","th"]);function mB(t){return fB.has(Cd(t))}const pB=[":popover-open",":modal"];function By(t){return pB.some(e=>{try{return t.matches(e)}catch{return!1}})}const gB=["transform","translate","scale","rotate","perspective"],yB=["transform","translate","scale","rotate","perspective","filter"],vB=["paint","layout","strict","content"];function bE(t){const e=EE(),n=yi(t)?vi(t):t;return gB.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||yB.some(r=>(n.willChange||"").includes(r))||vB.some(r=>(n.contain||"").includes(r))}function wB(t){let e=Ka(t);for(;eo(e)&&!Hu(e);){if(bE(e))return e;if(By(e))return null;e=Ka(e)}return null}function EE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const _B=new Set(["html","body","#document"]);function Hu(t){return _B.has(Cd(t))}function vi(t){return Ds(t).getComputedStyle(t)}function zy(t){return yi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ka(t){if(Cd(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Ex(t)&&t.host||ro(t);return Ex(e)?e.host:e}function Ok(t){const e=Ka(t);return Hu(e)?t.ownerDocument?t.ownerDocument.body:t.body:eo(e)&&Xf(e)?e:Ok(e)}function wf(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=Ok(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=Ds(s);if(i){const a=c0(o);return e.concat(o,o.visualViewport||[],Xf(s)?s:[],a&&n?wf(a):[])}return e.concat(s,wf(s,[],n))}function c0(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Lk(t){const e=vi(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=eo(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,a=Ag(n)!==i||Ag(r)!==o;return a&&(n=i,r=o),{width:n,height:r,$:a}}function SE(t){return yi(t)?t:t.contextElement}function Su(t){const e=SE(t);if(!eo(e))return Gi(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=Lk(e);let o=(i?Ag(n.width):n.width)/r,a=(i?Ag(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const bB=Gi(0);function Mk(t){const e=Ds(t);return!EE()||!e.visualViewport?bB:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function EB(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ds(t)?!1:e}function ac(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=SE(t);let o=Gi(1);e&&(r?yi(r)&&(o=Su(r)):o=Su(t));const a=EB(i,n,r)?Mk(i):Gi(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,h=s.height/o.y;if(i){const m=Ds(i),p=r&&yi(r)?Ds(r):r;let v=m,g=c0(v);for(;g&&r&&p!==v;){const E=Su(g),b=g.getBoundingClientRect(),_=vi(g),S=b.left+(g.clientLeft+parseFloat(_.paddingLeft))*E.x,P=b.top+(g.clientTop+parseFloat(_.paddingTop))*E.y;l*=E.x,c*=E.y,u*=E.x,h*=E.y,l+=S,c+=P,v=Ds(g),g=c0(v)}}return Rg({width:u,height:h,x:l,y:c})}function Wy(t,e){const n=zy(t).scrollLeft;return e?e.left+n:ac(ro(t)).left+n}function Vk(t,e){const n=t.getBoundingClientRect(),r=n.left+e.scrollLeft-Wy(t,n),s=n.top+e.scrollTop;return{x:r,y:s}}function SB(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=ro(r),a=e?By(e.floating):!1;if(r===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},c=Gi(1);const u=Gi(0),h=eo(r);if((h||!h&&!i)&&((Cd(r)!=="body"||Xf(o))&&(l=zy(r)),eo(r))){const p=ac(r);c=Su(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}const m=o&&!h&&!i?Vk(o,l):Gi(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+m.x,y:n.y*c.y-l.scrollTop*c.y+u.y+m.y}}function IB(t){return Array.from(t.getClientRects())}function TB(t){const e=ro(t),n=zy(t),r=t.ownerDocument.body,s=Rs(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Rs(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+Wy(t);const a=-n.scrollTop;return vi(r).direction==="rtl"&&(o+=Rs(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:a}}const Sx=25;function xB(t,e){const n=Ds(t),r=ro(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const u=EE();(!u||u&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}const c=Wy(r);if(c<=0){const u=r.ownerDocument,h=u.body,m=getComputedStyle(h),p=u.compatMode==="CSS1Compat"&&parseFloat(m.marginLeft)+parseFloat(m.marginRight)||0,v=Math.abs(r.clientWidth-h.clientWidth-p);v<=Sx&&(i-=v)}else c<=Sx&&(i+=c);return{width:i,height:o,x:a,y:l}}const AB=new Set(["absolute","fixed"]);function PB(t,e){const n=ac(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=eo(t)?Su(t):Gi(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:o,height:a,x:l,y:c}}function Ix(t,e,n){let r;if(e==="viewport")r=xB(t,n);else if(e==="document")r=TB(ro(t));else if(yi(e))r=PB(e,n);else{const s=Mk(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Rg(r)}function jk(t,e){const n=Ka(t);return n===e||!yi(n)||Hu(n)?!1:vi(n).position==="fixed"||jk(n,e)}function RB(t,e){const n=e.get(t);if(n)return n;let r=wf(t,[],!1).filter(a=>yi(a)&&Cd(a)!=="body"),s=null;const i=vi(t).position==="fixed";let o=i?Ka(t):t;for(;yi(o)&&!Hu(o);){const a=vi(o),l=bE(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&AB.has(s.position)||Xf(o)&&!l&&jk(t,o))?r=r.filter(u=>u!==o):s=a,o=Ka(o)}return e.set(t,r),r}function CB(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?By(e)?[]:RB(e,this._c):[].concat(n),r],a=o[0],l=o.reduce((c,u)=>{const h=Ix(e,u,s);return c.top=Rs(h.top,c.top),c.right=Ha(h.right,c.right),c.bottom=Ha(h.bottom,c.bottom),c.left=Rs(h.left,c.left),c},Ix(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function NB(t){const{width:e,height:n}=Lk(t);return{width:e,height:n}}function kB(t,e,n){const r=eo(e),s=ro(e),i=n==="fixed",o=ac(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=Gi(0);function c(){l.x=Wy(s)}if(r||!r&&!i)if((Cd(e)!=="body"||Xf(s))&&(a=zy(e)),r){const p=ac(e,!0,i,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else s&&c();i&&!r&&s&&c();const u=s&&!r&&!i?Vk(s,a):Gi(0),h=o.left+a.scrollLeft-l.x-u.x,m=o.top+a.scrollTop-l.y-u.y;return{x:h,y:m,width:o.width,height:o.height}}function Iw(t){return vi(t).position==="static"}function Tx(t,e){if(!eo(t)||vi(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return ro(t)===n&&(n=n.ownerDocument.body),n}function Fk(t,e){const n=Ds(t);if(By(t))return n;if(!eo(t)){let s=Ka(t);for(;s&&!Hu(s);){if(yi(s)&&!Iw(s))return s;s=Ka(s)}return n}let r=Tx(t,e);for(;r&&mB(r)&&Iw(r);)r=Tx(r,e);return r&&Hu(r)&&Iw(r)&&!bE(r)?n:r||wB(t)||n}const DB=async function(t){const e=this.getOffsetParent||Fk,n=this.getDimensions,r=await n(t.floating);return{reference:kB(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function OB(t){return vi(t).direction==="rtl"}const LB={convertOffsetParentRelativeRectToViewportRelativeRect:SB,getDocumentElement:ro,getClippingRect:CB,getOffsetParent:Fk,getElementRects:DB,getClientRects:IB,getDimensions:NB,getScale:Su,isElement:yi,isRTL:OB};function Uk(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function MB(t,e){let n=null,r;const s=ro(t);function i(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:h,width:m,height:p}=c;if(a||e(),!m||!p)return;const v=Qm(h),g=Qm(s.clientWidth-(u+m)),E=Qm(s.clientHeight-(h+p)),b=Qm(u),S={rootMargin:-v+"px "+-g+"px "+-E+"px "+-b+"px",threshold:Rs(0,Ha(1,l))||1};let P=!0;function T(N){const I=N[0].intersectionRatio;if(I!==l){if(!P)return o();I?o(!1,I):r=setTimeout(()=>{o(!1,1e-7)},1e3)}I===1&&!Uk(c,t.getBoundingClientRect())&&o(),P=!1}try{n=new IntersectionObserver(T,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(T,S)}n.observe(t)}return o(!0),i}function VB(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=SE(t),u=s||i?[...c?wf(c):[],...wf(e)]:[];u.forEach(b=>{s&&b.addEventListener("scroll",n,{passive:!0}),i&&b.addEventListener("resize",n)});const h=c&&a?MB(c,n):null;let m=-1,p=null;o&&(p=new ResizeObserver(b=>{let[_]=b;_&&_.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var S;(S=p)==null||S.observe(e)})),n()}),c&&!l&&p.observe(c),p.observe(e));let v,g=l?ac(t):null;l&&E();function E(){const b=ac(t);g&&!Uk(g,b)&&n(),g=b,v=requestAnimationFrame(E)}return n(),()=>{var b;u.forEach(_=>{s&&_.removeEventListener("scroll",n),i&&_.removeEventListener("resize",n)}),h==null||h(),(b=p)==null||b.disconnect(),p=null,l&&cancelAnimationFrame(v)}}const jB=lB,FB=cB,UB=iB,$B=dB,BB=oB,xx=sB,zB=uB,WB=(t,e,n)=>{const r=new Map,s={platform:LB,...n},i={...s.platform,_c:r};return rB(t,e,{...s,platform:i})};var qB=typeof document<"u",HB=function(){},Op=qB?y.useLayoutEffect:HB;function Cg(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Cg(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!Cg(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function $k(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Ax(t,e){const n=$k(t);return Math.round(e*n)/n}function Tw(t){const e=y.useRef(t);return Op(()=>{e.current=t}),e}function KB(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=y.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[m,p]=y.useState(r);Cg(m,r)||p(r);const[v,g]=y.useState(null),[E,b]=y.useState(null),_=y.useCallback(W=>{W!==N.current&&(N.current=W,g(W))},[]),S=y.useCallback(W=>{W!==I.current&&(I.current=W,b(W))},[]),P=i||v,T=o||E,N=y.useRef(null),I=y.useRef(null),A=y.useRef(u),R=l!=null,k=Tw(l),C=Tw(s),L=Tw(c),O=y.useCallback(()=>{if(!N.current||!I.current)return;const W={placement:e,strategy:n,middleware:m};C.current&&(W.platform=C.current),WB(N.current,I.current,W).then(Y=>{const le={...Y,isPositioned:L.current!==!1};X.current&&!Cg(A.current,le)&&(A.current=le,Qf.flushSync(()=>{h(le)}))})},[m,e,n,C,L]);Op(()=>{c===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,h(W=>({...W,isPositioned:!1})))},[c]);const X=y.useRef(!1);Op(()=>(X.current=!0,()=>{X.current=!1}),[]),Op(()=>{if(P&&(N.current=P),T&&(I.current=T),P&&T){if(k.current)return k.current(P,T,O);O()}},[P,T,O,k,R]);const Ne=y.useMemo(()=>({reference:N,floating:I,setReference:_,setFloating:S}),[_,S]),Le=y.useMemo(()=>({reference:P,floating:T}),[P,T]),Fe=y.useMemo(()=>{const W={position:n,left:0,top:0};if(!Le.floating)return W;const Y=Ax(Le.floating,u.x),le=Ax(Le.floating,u.y);return a?{...W,transform:"translate("+Y+"px, "+le+"px)",...$k(Le.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:Y,top:le}},[n,a,Le.floating,u.x,u.y]);return y.useMemo(()=>({...u,update:O,refs:Ne,elements:Le,floatingStyles:Fe}),[u,O,Ne,Le,Fe])}const GB=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?xx({element:r.current,padding:s}).fn(n):{}:r?xx({element:r,padding:s}).fn(n):{}}}},QB=(t,e)=>({...jB(t),options:[t,e]}),YB=(t,e)=>({...FB(t),options:[t,e]}),JB=(t,e)=>({...zB(t),options:[t,e]}),XB=(t,e)=>({...UB(t),options:[t,e]}),ZB=(t,e)=>({...$B(t),options:[t,e]}),e6=(t,e)=>({...BB(t),options:[t,e]}),t6=(t,e)=>({...GB(t),options:[t,e]});var n6="Arrow",Bk=y.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return f.jsx(_n.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});Bk.displayName=n6;var r6=Bk;function zk(t){const[e,n]=y.useState(void 0);return Zi(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var IE="Popper",[Wk,qk]=Sc(IE),[s6,Hk]=Wk(IE),Kk=t=>{const{__scopePopper:e,children:n}=t,[r,s]=y.useState(null);return f.jsx(s6,{scope:e,anchor:r,onAnchorChange:s,children:n})};Kk.displayName=IE;var Gk="PopperAnchor",Qk=y.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=Hk(Gk,n),o=y.useRef(null),a=Qn(e,o),l=y.useRef(null);return y.useEffect(()=>{const c=l.current;l.current=(r==null?void 0:r.current)||o.current,c!==l.current&&i.onAnchorChange(l.current)}),r?null:f.jsx(_n.div,{...s,ref:a})});Qk.displayName=Gk;var TE="PopperContent",[i6,o6]=Wk(TE),Yk=y.forwardRef((t,e)=>{var qe,dn,dr,Xn,sr,Dr;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:m=!1,updatePositionStrategy:p="optimized",onPlaced:v,...g}=t,E=Hk(TE,n),[b,_]=y.useState(null),S=Qn(e,Or=>_(Or)),[P,T]=y.useState(null),N=zk(P),I=(N==null?void 0:N.width)??0,A=(N==null?void 0:N.height)??0,R=r+(i!=="center"?"-"+i:""),k=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},C=Array.isArray(c)?c:[c],L=C.length>0,O={padding:k,boundary:C.filter(l6),altBoundary:L},{refs:X,floatingStyles:Ne,placement:Le,isPositioned:Fe,middlewareData:W}=KB({strategy:"fixed",placement:R,whileElementsMounted:(...Or)=>VB(...Or,{animationFrame:p==="always"}),elements:{reference:E.anchor},middleware:[QB({mainAxis:s+A,alignmentAxis:o}),l&&YB({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?JB():void 0,...O}),l&&XB({...O}),ZB({...O,apply:({elements:Or,rects:Lr,availableWidth:Q,availableHeight:de})=>{const{width:_e,height:nt}=Lr.reference,he=Or.floating.style;he.setProperty("--radix-popper-available-width",`${Q}px`),he.setProperty("--radix-popper-available-height",`${de}px`),he.setProperty("--radix-popper-anchor-width",`${_e}px`),he.setProperty("--radix-popper-anchor-height",`${nt}px`)}}),P&&t6({element:P,padding:a}),c6({arrowWidth:I,arrowHeight:A}),m&&e6({strategy:"referenceHidden",...O})]}),[Y,le]=Zk(Le),pe=jr(v);Zi(()=>{Fe&&(pe==null||pe())},[Fe,pe]);const fe=(qe=W.arrow)==null?void 0:qe.x,Ge=(dn=W.arrow)==null?void 0:dn.y,Ie=((dr=W.arrow)==null?void 0:dr.centerOffset)!==0,[ve,J]=y.useState();return Zi(()=>{b&&J(window.getComputedStyle(b).zIndex)},[b]),f.jsx("div",{ref:X.setFloating,"data-radix-popper-content-wrapper":"",style:{...Ne,transform:Fe?Ne.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ve,"--radix-popper-transform-origin":[(Xn=W.transformOrigin)==null?void 0:Xn.x,(sr=W.transformOrigin)==null?void 0:sr.y].join(" "),...((Dr=W.hide)==null?void 0:Dr.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:f.jsx(i6,{scope:n,placedSide:Y,onArrowChange:T,arrowX:fe,arrowY:Ge,shouldHideArrow:Ie,children:f.jsx(_n.div,{"data-side":Y,"data-align":le,...g,ref:S,style:{...g.style,animation:Fe?void 0:"none"}})})})});Yk.displayName=TE;var Jk="PopperArrow",a6={top:"bottom",right:"left",bottom:"top",left:"right"},Xk=y.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=o6(Jk,r),o=a6[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(r6,{...s,ref:n,style:{...s.style,display:"block"}})})});Xk.displayName=Jk;function l6(t){return t!==null}var c6=t=>({name:"transformOrigin",options:t,fn(e){var E,b,_;const{placement:n,rects:r,middlewareData:s}=e,o=((E=s.arrow)==null?void 0:E.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=Zk(n),h={start:"0%",center:"50%",end:"100%"}[u],m=(((b=s.arrow)==null?void 0:b.x)??0)+a/2,p=(((_=s.arrow)==null?void 0:_.y)??0)+l/2;let v="",g="";return c==="bottom"?(v=o?h:`${m}px`,g=`${-l}px`):c==="top"?(v=o?h:`${m}px`,g=`${r.floating.height+l}px`):c==="right"?(v=`${-l}px`,g=o?h:`${p}px`):c==="left"&&(v=`${r.floating.width+l}px`,g=o?h:`${p}px`),{data:{x:v,y:g}}}});function Zk(t){const[e,n="center"]=t.split("-");return[e,n]}var Dte=Kk,u6=Qk,d6=Yk,h6=Xk,f6=Symbol("radix.slottable");function m6(t){const e=({children:n})=>f.jsx(f.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=f6,e}var[qy]=Sc("Tooltip",[qk]),xE=qk(),eD="TooltipProvider",p6=700,Px="tooltip.open",[g6,tD]=qy(eD),nD=t=>{const{__scopeTooltip:e,delayDuration:n=p6,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=t,o=y.useRef(!0),a=y.useRef(!1),l=y.useRef(0);return y.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),f.jsx(g6,{scope:e,isOpenDelayedRef:o,delayDuration:n,onOpen:y.useCallback(()=>{window.clearTimeout(l.current),o.current=!1},[]),onClose:y.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.current=!0,r)},[r]),isPointerInTransitRef:a,onPointerInTransitChange:y.useCallback(c=>{a.current=c},[]),disableHoverableContent:s,children:i})};nD.displayName=eD;var rD="Tooltip",[Ote,Hy]=qy(rD),u0="TooltipTrigger",y6=y.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=Hy(u0,n),i=tD(u0,n),o=xE(n),a=y.useRef(null),l=Qn(e,a,s.onTriggerChange),c=y.useRef(!1),u=y.useRef(!1),h=y.useCallback(()=>c.current=!1,[]);return y.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),f.jsx(u6,{asChild:!0,...o,children:f.jsx(_n.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:en(t.onPointerMove,m=>{m.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:en(t.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:en(t.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:en(t.onFocus,()=>{c.current||s.onOpen()}),onBlur:en(t.onBlur,s.onClose),onClick:en(t.onClick,s.onClose)})})});y6.displayName=u0;var v6="TooltipPortal",[Lte,w6]=qy(v6,{forceMount:void 0}),Ku="TooltipContent",sD=y.forwardRef((t,e)=>{const n=w6(Ku,t.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=t,o=Hy(Ku,t.__scopeTooltip);return f.jsx(Si,{present:r||o.open,children:o.disableHoverableContent?f.jsx(iD,{side:s,...i,ref:e}):f.jsx(_6,{side:s,...i,ref:e})})}),_6=y.forwardRef((t,e)=>{const n=Hy(Ku,t.__scopeTooltip),r=tD(Ku,t.__scopeTooltip),s=y.useRef(null),i=Qn(e,s),[o,a]=y.useState(null),{trigger:l,onClose:c}=n,u=s.current,{onPointerInTransitChange:h}=r,m=y.useCallback(()=>{a(null),h(!1)},[h]),p=y.useCallback((v,g)=>{const E=v.currentTarget,b={x:v.clientX,y:v.clientY},_=T6(b,E.getBoundingClientRect()),S=x6(b,_),P=A6(g.getBoundingClientRect()),T=R6([...S,...P]);a(T),h(!0)},[h]);return y.useEffect(()=>()=>m(),[m]),y.useEffect(()=>{if(l&&u){const v=E=>p(E,u),g=E=>p(E,l);return l.addEventListener("pointerleave",v),u.addEventListener("pointerleave",g),()=>{l.removeEventListener("pointerleave",v),u.removeEventListener("pointerleave",g)}}},[l,u,p,m]),y.useEffect(()=>{if(o){const v=g=>{const E=g.target,b={x:g.clientX,y:g.clientY},_=(l==null?void 0:l.contains(E))||(u==null?void 0:u.contains(E)),S=!P6(b,o);_?m():S&&(m(),c())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[l,u,o,c,m]),f.jsx(iD,{...t,ref:i})}),[b6,E6]=qy(rD,{isInside:!1}),S6=m6("TooltipContent"),iD=y.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=Hy(Ku,n),c=xE(n),{onClose:u}=l;return y.useEffect(()=>(document.addEventListener(Px,u),()=>document.removeEventListener(Px,u)),[u]),y.useEffect(()=>{if(l.trigger){const h=m=>{const p=m.target;p!=null&&p.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),f.jsx(My,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:f.jsxs(d6,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(S6,{children:r}),f.jsx(b6,{scope:n,isInside:!0,children:f.jsx(ZU,{id:l.contentId,role:"tooltip",children:s||r})})]})})});sD.displayName=Ku;var oD="TooltipArrow",I6=y.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=xE(n);return E6(oD,n).isInside?null:f.jsx(h6,{...s,...r,ref:e})});I6.displayName=oD;function T6(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function x6(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function A6(t){const{top:e,right:n,bottom:r,left:s}=t;return[{x:s,y:e},{x:n,y:e},{x:n,y:r},{x:s,y:r}]}function P6(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,h=l.x,m=l.y;u>r!=m>r&&n<(h-c)*(r-u)/(m-u)+c&&(s=!s)}return s}function R6(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),C6(e)}function C6(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const s=t[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const s=t[r];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))n.pop();else break}n.push(s)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var N6=nD,aD=sD;const k6=N6,D6=y.forwardRef(({className:t,sideOffset:e=4,...n},r)=>f.jsx(aD,{ref:r,sideOffset:e,className:yn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));D6.displayName=aD.displayName;var Ky=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},O6={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},ga,hb,oR,L6=(oR=class{constructor(){Gt(this,ga,O6);Gt(this,hb,!1)}setTimeoutProvider(t){Et(this,ga,t)}setTimeout(t,e){return re(this,ga).setTimeout(t,e)}clearTimeout(t){re(this,ga).clearTimeout(t)}setInterval(t,e){return re(this,ga).setInterval(t,e)}clearInterval(t){re(this,ga).clearInterval(t)}},ga=new WeakMap,hb=new WeakMap,oR),Ng=new L6;function M6(t){setTimeout(t,0)}var Gy=typeof window>"u"||"Deno"in globalThis;function ns(){}function V6(t,e){return typeof t=="function"?t(e):t}function j6(t){return typeof t=="number"&&t>=0&&t!==1/0}function F6(t,e){return Math.max(t+(e||0)-Date.now(),0)}function d0(t,e){return typeof t=="function"?t(e):t}function U6(t,e){return typeof t=="function"?t(e):t}function Rx(t,e){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:a}=t;if(o){if(r){if(e.queryHash!==AE(o,e.options))return!1}else if(!bf(e.queryKey,o))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||s&&s!==e.state.fetchStatus||i&&!i(e))}function Cx(t,e){const{exact:n,status:r,predicate:s,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(_f(e.options.mutationKey)!==_f(i))return!1}else if(!bf(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function AE(t,e){return((e==null?void 0:e.queryKeyHashFn)||_f)(t)}function _f(t){return JSON.stringify(t,(e,n)=>h0(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function bf(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>bf(t[n],e[n])):!1}var $6=Object.prototype.hasOwnProperty;function lD(t,e){if(t===e)return t;const n=Nx(t)&&Nx(e);if(!n&&!(h0(t)&&h0(e)))return e;const s=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),o=i.length,a=n?new Array(o):{};let l=0;for(let c=0;c<o;c++){const u=n?c:i[c],h=t[u],m=e[u];if(h===m){a[u]=h,(n?c<s:$6.call(t,u))&&l++;continue}if(h===null||m===null||typeof h!="object"||typeof m!="object"){a[u]=m;continue}const p=lD(h,m);a[u]=p,p===h&&l++}return s===o&&l===s?t:a}function Mte(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Nx(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function h0(t){if(!kx(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!kx(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function kx(t){return Object.prototype.toString.call(t)==="[object Object]"}function B6(t){return new Promise(e=>{Ng.setTimeout(e,t)})}function z6(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?lD(t,e):e}function W6(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function q6(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var PE=Symbol();function cD(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===PE?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function Vte(t,e){return typeof t=="function"?t(...e):!!t}function H6(t,e,n){let r=!1,s;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(s??(s=e()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),t}var zl,ya,Nu,aR,K6=(aR=class extends Ky{constructor(){super();Gt(this,zl);Gt(this,ya);Gt(this,Nu);Et(this,Nu,e=>{if(!Gy&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){re(this,ya)||this.setEventListener(re(this,Nu))}onUnsubscribe(){var e;this.hasListeners()||((e=re(this,ya))==null||e.call(this),Et(this,ya,void 0))}setEventListener(e){var n;Et(this,Nu,e),(n=re(this,ya))==null||n.call(this),Et(this,ya,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){re(this,zl)!==e&&(Et(this,zl,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof re(this,zl)=="boolean"?re(this,zl):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},zl=new WeakMap,ya=new WeakMap,Nu=new WeakMap,aR),uD=new K6;function G6(){let t,e;const n=new Promise((s,i)=>{t=s,e=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),t(s)},n.reject=s=>{r({status:"rejected",reason:s}),e(s)},n}function Q6(t){var n;let e;if((n=t.then(r=>(e=r,r),ns))==null||n.catch(ns),e!==void 0)return{data:e}}function dD(t){return t}function Y6(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function J6(t,e,n){const r=()=>{var i;const s=(i=t.promise)==null?void 0:i.then(e).catch(o=>n(o)?Promise.reject(new Error("redacted")):Promise.reject(o));return s==null||s.catch(ns),s};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:r()},...t.meta&&{meta:t.meta}}}function X6(t){return t.state.isPaused}function Z6(t){return t.state.status==="success"}function e9(t){return!0}function t9(t,e={}){var l,c,u,h;const n=e.shouldDehydrateMutation??((l=t.getDefaultOptions().dehydrate)==null?void 0:l.shouldDehydrateMutation)??X6,r=t.getMutationCache().getAll().flatMap(m=>n(m)?[Y6(m)]:[]),s=e.shouldDehydrateQuery??((c=t.getDefaultOptions().dehydrate)==null?void 0:c.shouldDehydrateQuery)??Z6,i=e.shouldRedactErrors??((u=t.getDefaultOptions().dehydrate)==null?void 0:u.shouldRedactErrors)??e9,o=e.serializeData??((h=t.getDefaultOptions().dehydrate)==null?void 0:h.serializeData)??dD,a=t.getQueryCache().getAll().flatMap(m=>s(m)?[J6(m,o,i)]:[]);return{mutations:r,queries:a}}function n9(t,e,n){var l,c;if(typeof e!="object"||e===null)return;const r=t.getMutationCache(),s=t.getQueryCache(),i=((l=n==null?void 0:n.defaultOptions)==null?void 0:l.deserializeData)??((c=t.getDefaultOptions().hydrate)==null?void 0:c.deserializeData)??dD,o=e.mutations||[],a=e.queries||[];o.forEach(({state:u,...h})=>{var m,p;r.build(t,{...(m=t.getDefaultOptions().hydrate)==null?void 0:m.mutations,...(p=n==null?void 0:n.defaultOptions)==null?void 0:p.mutations,...h},u)}),a.forEach(({queryKey:u,state:h,queryHash:m,meta:p,promise:v,dehydratedAt:g})=>{var N,I;const E=v?Q6(v):void 0,b=h.data===void 0?E==null?void 0:E.data:h.data,_=b===void 0?b:i(b);let S=s.get(m);const P=(S==null?void 0:S.state.status)==="pending",T=(S==null?void 0:S.state.fetchStatus)==="fetching";if(S){const A=E&&g!==void 0&&g>S.state.dataUpdatedAt;if(h.dataUpdatedAt>S.state.dataUpdatedAt||A){const{fetchStatus:R,...k}=h;S.setState({...k,data:_})}}else S=s.build(t,{...(N=t.getDefaultOptions().hydrate)==null?void 0:N.queries,...(I=n==null?void 0:n.defaultOptions)==null?void 0:I.queries,queryKey:u,queryHash:m,meta:p},{...h,data:_,fetchStatus:"idle",status:_!==void 0?"success":h.status});v&&!P&&!T&&(g===void 0||g>S.state.dataUpdatedAt)&&S.fetch(void 0,{initialPromise:Promise.resolve(v).then(i)}).catch(ns)})}var r9=M6;function s9(){let t=[],e=0,n=a=>{a()},r=a=>{a()},s=r9;const i=a=>{e?t.push(a):s(()=>{n(a)})},o=()=>{const a=t;t=[],a.length&&s(()=>{r(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{s=a}}}var rs=s9(),ku,va,Du,lR,i9=(lR=class extends Ky{constructor(){super();Gt(this,ku,!0);Gt(this,va);Gt(this,Du);Et(this,Du,e=>{if(!Gy&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){re(this,va)||this.setEventListener(re(this,Du))}onUnsubscribe(){var e;this.hasListeners()||((e=re(this,va))==null||e.call(this),Et(this,va,void 0))}setEventListener(e){var n;Et(this,Du,e),(n=re(this,va))==null||n.call(this),Et(this,va,e(this.setOnline.bind(this)))}setOnline(e){re(this,ku)!==e&&(Et(this,ku,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return re(this,ku)}},ku=new WeakMap,va=new WeakMap,Du=new WeakMap,lR),kg=new i9;function o9(t){return Math.min(1e3*2**t,3e4)}function hD(t){return(t??"online")==="online"?kg.isOnline():!0}var f0=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function fD(t){let e=!1,n=0,r;const s=G6(),i=()=>s.status!=="pending",o=g=>{var E;if(!i()){const b=new f0(g);m(b),(E=t.onCancel)==null||E.call(t,b)}},a=()=>{e=!0},l=()=>{e=!1},c=()=>uD.isFocused()&&(t.networkMode==="always"||kg.isOnline())&&t.canRun(),u=()=>hD(t.networkMode)&&t.canRun(),h=g=>{i()||(r==null||r(),s.resolve(g))},m=g=>{i()||(r==null||r(),s.reject(g))},p=()=>new Promise(g=>{var E;r=b=>{(i()||c())&&g(b)},(E=t.onPause)==null||E.call(t)}).then(()=>{var g;r=void 0,i()||(g=t.onContinue)==null||g.call(t)}),v=()=>{if(i())return;let g;const E=n===0?t.initialPromise:void 0;try{g=E??t.fn()}catch(b){g=Promise.reject(b)}Promise.resolve(g).then(h).catch(b=>{var N;if(i())return;const _=t.retry??(Gy?0:3),S=t.retryDelay??o9,P=typeof S=="function"?S(n,b):S,T=_===!0||typeof _=="number"&&n<_||typeof _=="function"&&_(n,b);if(e||!T){m(b);return}n++,(N=t.onFail)==null||N.call(t,n,b),B6(P).then(()=>c()?void 0:p()).then(()=>{e?m(b):v()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?v():p().then(v),s)}}var Wl,cR,mD=(cR=class{constructor(){Gt(this,Wl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),j6(this.gcTime)&&Et(this,Wl,Ng.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Gy?1/0:5*60*1e3))}clearGcTimeout(){re(this,Wl)&&(Ng.clearTimeout(re(this,Wl)),Et(this,Wl,void 0))}},Wl=new WeakMap,cR),ql,Ou,zs,Hl,xr,$f,Kl,ii,co,uR,a9=(uR=class extends mD{constructor(n){super();Gt(this,ii);Gt(this,ql);Gt(this,Ou);Gt(this,zs);Gt(this,Hl);Gt(this,xr);Gt(this,$f);Gt(this,Kl);Et(this,Kl,!1),Et(this,$f,n.defaultOptions),this.setOptions(n.options),this.observers=[],Et(this,Hl,n.client),Et(this,zs,re(this,Hl).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,Et(this,ql,Ox(this.options)),this.state=n.state??re(this,ql),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=re(this,xr))==null?void 0:n.promise}setOptions(n){if(this.options={...re(this,$f),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Ox(this.options);r.data!==void 0&&(this.setState(Dx(r.data,r.dataUpdatedAt)),Et(this,ql,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&re(this,zs).remove(this)}setData(n,r){const s=z6(this.state.data,n,this.options);return zr(this,ii,co).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(n,r){zr(this,ii,co).call(this,{type:"setState",state:n,setStateOptions:r})}cancel(n){var s,i;const r=(s=re(this,xr))==null?void 0:s.promise;return(i=re(this,xr))==null||i.cancel(n),r?r.then(ns).catch(ns):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(re(this,ql))}isActive(){return this.observers.some(n=>U6(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===PE||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>d0(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!F6(this.state.dataUpdatedAt,n)}onFocus(){var r;const n=this.observers.find(s=>s.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(r=re(this,xr))==null||r.continue()}onOnline(){var r;const n=this.observers.find(s=>s.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(r=re(this,xr))==null||r.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),re(this,zs).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(r=>r!==n),this.observers.length||(re(this,xr)&&(re(this,Kl)?re(this,xr).cancel({revert:!0}):re(this,xr).cancelRetry()),this.scheduleGc()),re(this,zs).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||zr(this,ii,co).call(this,{type:"invalidate"})}async fetch(n,r){var c,u,h,m,p,v,g,E,b,_,S,P;if(this.state.fetchStatus!=="idle"&&((c=re(this,xr))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(re(this,xr))return re(this,xr).continueRetry(),re(this,xr).promise}if(n&&this.setOptions(n),!this.options.queryFn){const T=this.observers.find(N=>N.options.queryFn);T&&this.setOptions(T.options)}const s=new AbortController,i=T=>{Object.defineProperty(T,"signal",{enumerable:!0,get:()=>(Et(this,Kl,!0),s.signal)})},o=()=>{const T=cD(this.options,r),I=(()=>{const A={client:re(this,Hl),queryKey:this.queryKey,meta:this.meta};return i(A),A})();return Et(this,Kl,!1),this.options.persister?this.options.persister(T,I,this):T(I)},l=(()=>{const T={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:re(this,Hl),state:this.state,fetchFn:o};return i(T),T})();(u=this.options.behavior)==null||u.onFetch(l,this),Et(this,Ou,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=l.fetchOptions)==null?void 0:h.meta))&&zr(this,ii,co).call(this,{type:"fetch",meta:(m=l.fetchOptions)==null?void 0:m.meta}),Et(this,xr,fD({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,onCancel:T=>{T instanceof f0&&T.revert&&this.setState({...re(this,Ou),fetchStatus:"idle"}),s.abort()},onFail:(T,N)=>{zr(this,ii,co).call(this,{type:"failed",failureCount:T,error:N})},onPause:()=>{zr(this,ii,co).call(this,{type:"pause"})},onContinue:()=>{zr(this,ii,co).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const T=await re(this,xr).start();if(T===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(T),(v=(p=re(this,zs).config).onSuccess)==null||v.call(p,T,this),(E=(g=re(this,zs).config).onSettled)==null||E.call(g,T,this.state.error,this),T}catch(T){if(T instanceof f0){if(T.silent)return re(this,xr).promise;if(T.revert){if(this.state.data===void 0)throw T;return this.state.data}}throw zr(this,ii,co).call(this,{type:"error",error:T}),(_=(b=re(this,zs).config).onError)==null||_.call(b,T,this),(P=(S=re(this,zs).config).onSettled)==null||P.call(S,this.state.data,T,this),T}finally{this.scheduleGc()}}},ql=new WeakMap,Ou=new WeakMap,zs=new WeakMap,Hl=new WeakMap,xr=new WeakMap,$f=new WeakMap,Kl=new WeakMap,ii=new WeakSet,co=function(n){const r=s=>{switch(n.type){case"failed":return{...s,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...l9(s.data,this.options),fetchMeta:n.meta??null};case"success":const i={...s,...Dx(n.data,n.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Et(this,Ou,n.manual?i:void 0),i;case"error":const o=n.error;return{...s,error:o,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...n.state}}};this.state=r(this.state),rs.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),re(this,zs).notify({query:this,type:"updated",action:n})})},uR);function l9(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:hD(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Dx(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Ox(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}function Lx(t){return{onFetch:(e,n)=>{var u,h,m,p,v;const r=e.options,s=(m=(h=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:m.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],o=((v=e.state.data)==null?void 0:v.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let g=!1;const E=S=>{H6(S,()=>e.signal,()=>g=!0)},b=cD(e.options,e.fetchOptions),_=async(S,P,T)=>{if(g)return Promise.reject();if(P==null&&S.pages.length)return Promise.resolve(S);const I=(()=>{const C={client:e.client,queryKey:e.queryKey,pageParam:P,direction:T?"backward":"forward",meta:e.options.meta};return E(C),C})(),A=await b(I),{maxPages:R}=e.options,k=T?q6:W6;return{pages:k(S.pages,A,R),pageParams:k(S.pageParams,P,R)}};if(s&&i.length){const S=s==="backward",P=S?c9:Mx,T={pages:i,pageParams:o},N=P(r,T);a=await _(T,N,S)}else{const S=t??i.length;do{const P=l===0?o[0]??r.initialPageParam:Mx(r,a);if(l>0&&P==null)break;a=await _(a,P),l++}while(l<S)}return a};e.options.persister?e.fetchFn=()=>{var g,E;return(E=(g=e.options).persister)==null?void 0:E.call(g,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function Mx(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function c9(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var Bf,Li,es,Gl,Mi,ra,dR,u9=(dR=class extends mD{constructor(n){super();Gt(this,Mi);Gt(this,Bf);Gt(this,Li);Gt(this,es);Gt(this,Gl);Et(this,Bf,n.client),this.mutationId=n.mutationId,Et(this,es,n.mutationCache),Et(this,Li,[]),this.state=n.state||d9(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){re(this,Li).includes(n)||(re(this,Li).push(n),this.clearGcTimeout(),re(this,es).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){Et(this,Li,re(this,Li).filter(r=>r!==n)),this.scheduleGc(),re(this,es).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){re(this,Li).length||(this.state.status==="pending"?this.scheduleGc():re(this,es).remove(this))}continue(){var n;return((n=re(this,Gl))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var a,l,c,u,h,m,p,v,g,E,b,_,S,P,T,N,I,A,R,k;const r=()=>{zr(this,Mi,ra).call(this,{type:"continue"})},s={client:re(this,Bf),meta:this.options.meta,mutationKey:this.options.mutationKey};Et(this,Gl,fD({fn:()=>this.options.mutationFn?this.options.mutationFn(n,s):Promise.reject(new Error("No mutationFn found")),onFail:(C,L)=>{zr(this,Mi,ra).call(this,{type:"failed",failureCount:C,error:L})},onPause:()=>{zr(this,Mi,ra).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>re(this,es).canRun(this)}));const i=this.state.status==="pending",o=!re(this,Gl).canStart();try{if(i)r();else{zr(this,Mi,ra).call(this,{type:"pending",variables:n,isPaused:o}),await((l=(a=re(this,es).config).onMutate)==null?void 0:l.call(a,n,this,s));const L=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,n,s));L!==this.state.context&&zr(this,Mi,ra).call(this,{type:"pending",context:L,variables:n,isPaused:o})}const C=await re(this,Gl).start();return await((m=(h=re(this,es).config).onSuccess)==null?void 0:m.call(h,C,n,this.state.context,this,s)),await((v=(p=this.options).onSuccess)==null?void 0:v.call(p,C,n,this.state.context,s)),await((E=(g=re(this,es).config).onSettled)==null?void 0:E.call(g,C,null,this.state.variables,this.state.context,this,s)),await((_=(b=this.options).onSettled)==null?void 0:_.call(b,C,null,n,this.state.context,s)),zr(this,Mi,ra).call(this,{type:"success",data:C}),C}catch(C){try{await((P=(S=re(this,es).config).onError)==null?void 0:P.call(S,C,n,this.state.context,this,s))}catch(L){Promise.reject(L)}try{await((N=(T=this.options).onError)==null?void 0:N.call(T,C,n,this.state.context,s))}catch(L){Promise.reject(L)}try{await((A=(I=re(this,es).config).onSettled)==null?void 0:A.call(I,void 0,C,this.state.variables,this.state.context,this,s))}catch(L){Promise.reject(L)}try{await((k=(R=this.options).onSettled)==null?void 0:k.call(R,void 0,C,n,this.state.context,s))}catch(L){Promise.reject(L)}throw zr(this,Mi,ra).call(this,{type:"error",error:C}),C}finally{re(this,es).runNext(this)}}},Bf=new WeakMap,Li=new WeakMap,es=new WeakMap,Gl=new WeakMap,Mi=new WeakSet,ra=function(n){const r=s=>{switch(n.type){case"failed":return{...s,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...s,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:n.error,failureCount:s.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=r(this.state),rs.batch(()=>{re(this,Li).forEach(s=>{s.onMutationUpdate(n)}),re(this,es).notify({mutation:this,type:"updated",action:n})})},dR);function d9(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var mo,oi,zf,hR,h9=(hR=class extends Ky{constructor(e={}){super();Gt(this,mo);Gt(this,oi);Gt(this,zf);this.config=e,Et(this,mo,new Set),Et(this,oi,new Map),Et(this,zf,0)}build(e,n,r){const s=new u9({client:e,mutationCache:this,mutationId:++Pm(this,zf)._,options:e.defaultMutationOptions(n),state:r});return this.add(s),s}add(e){re(this,mo).add(e);const n=Ym(e);if(typeof n=="string"){const r=re(this,oi).get(n);r?r.push(e):re(this,oi).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(re(this,mo).delete(e)){const n=Ym(e);if(typeof n=="string"){const r=re(this,oi).get(n);if(r)if(r.length>1){const s=r.indexOf(e);s!==-1&&r.splice(s,1)}else r[0]===e&&re(this,oi).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Ym(e);if(typeof n=="string"){const r=re(this,oi).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===e}else return!0}runNext(e){var r;const n=Ym(e);if(typeof n=="string"){const s=(r=re(this,oi).get(n))==null?void 0:r.find(i=>i!==e&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){rs.batch(()=>{re(this,mo).forEach(e=>{this.notify({type:"removed",mutation:e})}),re(this,mo).clear(),re(this,oi).clear()})}getAll(){return Array.from(re(this,mo))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Cx(n,r))}findAll(e={}){return this.getAll().filter(n=>Cx(e,n))}notify(e){rs.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return rs.batch(()=>Promise.all(e.map(n=>n.continue().catch(ns))))}},mo=new WeakMap,oi=new WeakMap,zf=new WeakMap,hR);function Ym(t){var e;return(e=t.options.scope)==null?void 0:e.id}var Vi,fR,f9=(fR=class extends Ky{constructor(e={}){super();Gt(this,Vi);this.config=e,Et(this,Vi,new Map)}build(e,n,r){const s=n.queryKey,i=n.queryHash??AE(s,n);let o=this.get(i);return o||(o=new a9({client:e,queryKey:s,queryHash:i,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(s)}),this.add(o)),o}add(e){re(this,Vi).has(e.queryHash)||(re(this,Vi).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=re(this,Vi).get(e.queryHash);n&&(e.destroy(),n===e&&re(this,Vi).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){rs.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return re(this,Vi).get(e)}getAll(){return[...re(this,Vi).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Rx(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>Rx(e,r)):n}notify(e){rs.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){rs.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){rs.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Vi=new WeakMap,fR),nr,wa,_a,Lu,Mu,ba,Vu,ju,mR,m9=(mR=class{constructor(t={}){Gt(this,nr);Gt(this,wa);Gt(this,_a);Gt(this,Lu);Gt(this,Mu);Gt(this,ba);Gt(this,Vu);Gt(this,ju);Et(this,nr,t.queryCache||new f9),Et(this,wa,t.mutationCache||new h9),Et(this,_a,t.defaultOptions||{}),Et(this,Lu,new Map),Et(this,Mu,new Map),Et(this,ba,0)}mount(){Pm(this,ba)._++,re(this,ba)===1&&(Et(this,Vu,uD.subscribe(async t=>{t&&(await this.resumePausedMutations(),re(this,nr).onFocus())})),Et(this,ju,kg.subscribe(async t=>{t&&(await this.resumePausedMutations(),re(this,nr).onOnline())})))}unmount(){var t,e;Pm(this,ba)._--,re(this,ba)===0&&((t=re(this,Vu))==null||t.call(this),Et(this,Vu,void 0),(e=re(this,ju))==null||e.call(this),Et(this,ju,void 0))}isFetching(t){return re(this,nr).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return re(this,wa).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=re(this,nr).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=re(this,nr).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(d0(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return re(this,nr).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),s=re(this,nr).get(r.queryHash),i=s==null?void 0:s.state.data,o=V6(e,i);if(o!==void 0)return re(this,nr).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return rs.batch(()=>re(this,nr).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=re(this,nr).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=re(this,nr);rs.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=re(this,nr);return rs.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=rs.batch(()=>re(this,nr).findAll(t).map(s=>s.cancel(n)));return Promise.all(r).then(ns).catch(ns)}invalidateQueries(t,e={}){return rs.batch(()=>(re(this,nr).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=rs.batch(()=>re(this,nr).findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(ns)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(ns)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=re(this,nr).build(this,e);return n.isStaleByTime(d0(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(ns).catch(ns)}fetchInfiniteQuery(t){return t.behavior=Lx(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(ns).catch(ns)}ensureInfiniteQueryData(t){return t.behavior=Lx(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return kg.isOnline()?re(this,wa).resumePausedMutations():Promise.resolve()}getQueryCache(){return re(this,nr)}getMutationCache(){return re(this,wa)}getDefaultOptions(){return re(this,_a)}setDefaultOptions(t){Et(this,_a,t)}setQueryDefaults(t,e){re(this,Lu).set(_f(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...re(this,Lu).values()],n={};return e.forEach(r=>{bf(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){re(this,Mu).set(_f(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...re(this,Mu).values()],n={};return e.forEach(r=>{bf(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...re(this,_a).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=AE(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===PE&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...re(this,_a).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){re(this,nr).clear(),re(this,wa).clear()}},nr=new WeakMap,wa=new WeakMap,_a=new WeakMap,Lu=new WeakMap,Mu=new WeakMap,ba=new WeakMap,Vu=new WeakMap,ju=new WeakMap,mR),pD=y.createContext(void 0),Ute=t=>{const e=y.useContext(pD);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},p9=({client:t,children:e})=>(y.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),f.jsx(pD.Provider,{value:t,children:e})),g9=["added","removed","updated"];function Vx(t){return g9.includes(t)}async function y9({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:r="",hydrateOptions:s}){try{const i=await e.restoreClient();if(i)if(i.timestamp){const o=Date.now()-i.timestamp>n,a=i.buster!==r;if(o||a)return e.removeClient();n9(t,i.clientState,s)}else return e.removeClient()}catch(i){throw await e.removeClient(),i}}async function jx({queryClient:t,persister:e,buster:n="",dehydrateOptions:r}){const s={buster:n,timestamp:Date.now(),clientState:t9(t,r)};await e.persistClient(s)}function v9(t){const e=t.queryClient.getQueryCache().subscribe(r=>{Vx(r.type)&&jx(t)}),n=t.queryClient.getMutationCache().subscribe(r=>{Vx(r.type)&&jx(t)});return()=>{e(),n()}}function w9(t){let e=!1,n;const r=()=>{e=!0,n==null||n()},s=y9(t).then(()=>{e||(n=v9(t))});return[r,s]}function xw(){}function _9({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:r=JSON.stringify,deserialize:s=JSON.parse,retry:i}){if(t){const o=a=>{try{t.setItem(e,r(a));return}catch(l){return l}};return{persistClient:b9(a=>{let l=a,c=o(l),u=0;for(;c&&l;)u++,l=i==null?void 0:i({persistedClient:l,error:c,errorCount:u}),l&&(c=o(l))},n),restoreClient:()=>{const a=t.getItem(e);if(a)return s(a)},removeClient:()=>{t.removeItem(e)}}}return{persistClient:xw,restoreClient:xw,removeClient:xw}}function b9(t,e=100){let n=null,r;return function(...s){r=s,n===null&&(n=Ng.setTimeout(()=>{t(...r),n=null},e))}}/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ef(){return Ef=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ef.apply(this,arguments)}var Ia;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ia||(Ia={}));const Fx="popstate";function E9(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Dg("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Sf(s)}return gD(e,n,null,t)}function S9(t){t===void 0&&(t={});function e(s,i){let{pathname:o="/",search:a="",hash:l=""}=Ic(s.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Dg("",{pathname:o,search:a,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let o=s.document.querySelector("base"),a="";if(o&&o.getAttribute("href")){let l=s.location.href,c=l.indexOf("#");a=c===-1?l:l.slice(0,c)}return a+"#"+(typeof i=="string"?i:Sf(i))}function r(s,i){Qy(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return gD(e,n,r,t)}function cr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Qy(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function I9(){return Math.random().toString(36).substr(2,8)}function Ux(t,e){return{usr:t.state,key:t.key,idx:e}}function Dg(t,e,n,r){return n===void 0&&(n=null),Ef({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ic(e):e,{state:n,key:e&&e.key||r||I9()})}function Sf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ic(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function gD(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=Ia.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(Ef({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=Ia.Pop;let E=u(),b=E==null?null:E-c;c=E,l&&l({action:a,location:g.location,delta:b})}function m(E,b){a=Ia.Push;let _=Dg(g.location,E,b);n&&n(_,E),c=u()+1;let S=Ux(_,c),P=g.createHref(_);try{o.pushState(S,"",P)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;s.location.assign(P)}i&&l&&l({action:a,location:g.location,delta:1})}function p(E,b){a=Ia.Replace;let _=Dg(g.location,E,b);n&&n(_,E),c=u();let S=Ux(_,c),P=g.createHref(_);o.replaceState(S,"",P),i&&l&&l({action:a,location:g.location,delta:0})}function v(E){let b=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof E=="string"?E:Sf(E);return _=_.replace(/ $/,"%20"),cr(b,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,b)}let g={get action(){return a},get location(){return t(s,o)},listen(E){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Fx,h),l=E,()=>{s.removeEventListener(Fx,h),l=null}},createHref(E){return e(s,E)},createURL:v,encodeLocation(E){let b=v(E);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:m,replace:p,go(E){return o.go(E)}};return g}var $x;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})($x||($x={}));function T9(t,e,n){return n===void 0&&(n="/"),x9(t,e,n)}function x9(t,e,n,r){let s=typeof e=="string"?Ic(e):e,i=RE(s.pathname||"/",n);if(i==null)return null;let o=yD(t);A9(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=F9(i);a=M9(o[l],c)}return a}function yD(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(cr(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Va([r,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(cr(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),yD(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:O9(c,i.index),routesMeta:u})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of vD(i.path))s(i,o,l)}),e}function vD(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=vD(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function A9(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:L9(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const P9=/^:[\w-]+$/,R9=3,C9=2,N9=1,k9=10,D9=-2,Bx=t=>t==="*";function O9(t,e){let n=t.split("/"),r=n.length;return n.some(Bx)&&(r+=D9),e&&(r+=C9),n.filter(s=>!Bx(s)).reduce((s,i)=>s+(P9.test(i)?R9:i===""?N9:k9),r)}function L9(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function M9(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=V9({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),m=l.route;if(!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Va([i,h.pathname]),pathnameBase:W9(Va([i,h.pathnameBase])),route:m}),h.pathnameBase!=="/"&&(i=Va([i,h.pathnameBase]))}return o}function V9(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=j9(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,u,h)=>{let{paramName:m,isOptional:p}=u;if(m==="*"){let g=a[h]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const v=a[h];return p&&!v?c[m]=void 0:c[m]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function j9(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Qy(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function F9(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qy(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function RE(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const U9=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$9=t=>U9.test(t);function B9(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ic(t):t,i;if(n)if($9(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Qy(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=zx(n.substring(1),"/"):i=zx(n,e)}else i=e;return{pathname:i,search:q9(r),hash:H9(s)}}function zx(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Aw(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function z9(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function CE(t,e){let n=z9(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function NE(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Ic(t):(s=Ef({},t),cr(!s.pathname||!s.pathname.includes("?"),Aw("?","pathname","search",s)),cr(!s.pathname||!s.pathname.includes("#"),Aw("#","pathname","hash",s)),cr(!s.search||!s.search.includes("#"),Aw("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),h-=1;s.pathname=m.join("/")}a=h>=0?e[h]:"/"}let l=B9(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Va=t=>t.join("/").replace(/\/\/+/g,"/"),W9=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),q9=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,H9=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function K9(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const wD=["post","put","patch","delete"];new Set(wD);const G9=["get",...wD];new Set(G9);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function If(){return If=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},If.apply(this,arguments)}const kE=y.createContext(null),Q9=y.createContext(null),cl=y.createContext(null),Yy=y.createContext(null),so=y.createContext({outlet:null,matches:[],isDataRoute:!1}),_D=y.createContext(null);function Y9(t,e){let{relative:n}=e===void 0?{}:e;Nd()||cr(!1);let{basename:r,navigator:s}=y.useContext(cl),{hash:i,pathname:o,search:a}=ED(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:Va([r,o])),s.createHref({pathname:l,search:a,hash:i})}function Nd(){return y.useContext(Yy)!=null}function Ii(){return Nd()||cr(!1),y.useContext(Yy).location}function bD(t){y.useContext(cl).static||y.useLayoutEffect(t)}function io(){let{isDataRoute:t}=y.useContext(so);return t?dz():J9()}function J9(){Nd()||cr(!1);let t=y.useContext(kE),{basename:e,future:n,navigator:r}=y.useContext(cl),{matches:s}=y.useContext(so),{pathname:i}=Ii(),o=JSON.stringify(CE(s,n.v7_relativeSplatPath)),a=y.useRef(!1);return bD(()=>{a.current=!0}),y.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let h=NE(c,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Va([e,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[e,r,o,i,t])}const X9=y.createContext(null);function Z9(t){let e=y.useContext(so).outlet;return e&&y.createElement(X9.Provider,{value:t},e)}function $te(){let{matches:t}=y.useContext(so),e=t[t.length-1];return e?e.params:{}}function ED(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=y.useContext(cl),{matches:s}=y.useContext(so),{pathname:i}=Ii(),o=JSON.stringify(CE(s,r.v7_relativeSplatPath));return y.useMemo(()=>NE(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function ez(t,e){return tz(t,e)}function tz(t,e,n,r){Nd()||cr(!1);let{navigator:s}=y.useContext(cl),{matches:i}=y.useContext(so),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=Ii(),u;if(e){var h;let E=typeof e=="string"?Ic(e):e;l==="/"||(h=E.pathname)!=null&&h.startsWith(l)||cr(!1),u=E}else u=c;let m=u.pathname||"/",p=m;if(l!=="/"){let E=l.replace(/^\//,"").split("/");p="/"+m.replace(/^\//,"").split("/").slice(E.length).join("/")}let v=T9(t,{pathname:p}),g=oz(v&&v.map(E=>Object.assign({},E,{params:Object.assign({},a,E.params),pathname:Va([l,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?l:Va([l,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,n,r);return e&&g?y.createElement(Yy.Provider,{value:{location:If({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Ia.Pop}},g):g}function nz(){let t=uz(),e=K9(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},e),n?y.createElement("pre",{style:s},n):null,null)}const rz=y.createElement(nz,null);class sz extends y.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?y.createElement(so.Provider,{value:this.props.routeContext},y.createElement(_D.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function iz(t){let{routeContext:e,match:n,children:r}=t,s=y.useContext(kE);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),y.createElement(so.Provider,{value:e},r)}function oz(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||cr(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:m,errors:p}=n,v=h.route.loader&&m[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||v){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,m)=>{let p,v=!1,g=null,E=null;n&&(p=a&&h.route.id?a[h.route.id]:void 0,g=h.route.errorElement||rz,l&&(c<0&&m===0?(hz("route-fallback"),v=!0,E=null):c===m&&(v=!0,E=h.route.hydrateFallbackElement||null)));let b=e.concat(o.slice(0,m+1)),_=()=>{let S;return p?S=g:v?S=E:h.route.Component?S=y.createElement(h.route.Component,null):h.route.element?S=h.route.element:S=u,y.createElement(iz,{match:h,routeContext:{outlet:u,matches:b,isDataRoute:n!=null},children:S})};return n&&(h.route.ErrorBoundary||h.route.errorElement||m===0)?y.createElement(sz,{location:n.location,revalidation:n.revalidation,component:g,error:p,children:_(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):_()},null)}var SD=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(SD||{}),ID=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(ID||{});function az(t){let e=y.useContext(kE);return e||cr(!1),e}function lz(t){let e=y.useContext(Q9);return e||cr(!1),e}function cz(t){let e=y.useContext(so);return e||cr(!1),e}function TD(t){let e=cz(),n=e.matches[e.matches.length-1];return n.route.id||cr(!1),n.route.id}function uz(){var t;let e=y.useContext(_D),n=lz(),r=TD();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function dz(){let{router:t}=az(SD.UseNavigateStable),e=TD(ID.UseNavigateStable),n=y.useRef(!1);return bD(()=>{n.current=!0}),y.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,If({fromRouteId:e},i)))},[t,e])}const Wx={};function hz(t,e,n){Wx[t]||(Wx[t]=!0)}function xD(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Bte(t){let{to:e,replace:n,state:r,relative:s}=t;Nd()||cr(!1);let{future:i,static:o}=y.useContext(cl),{matches:a}=y.useContext(so),{pathname:l}=Ii(),c=io(),u=NE(e,CE(a,i.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(u);return y.useEffect(()=>c(JSON.parse(h),{replace:n,state:r,relative:s}),[c,h,s,n,r]),null}function fz(t){return Z9(t.context)}function je(t){cr(!1)}function AD(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Ia.Pop,navigator:i,static:o=!1,future:a}=t;Nd()&&cr(!1);let l=e.replace(/^\/*/,"/"),c=y.useMemo(()=>({basename:l,navigator:i,static:o,future:If({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=Ic(r));let{pathname:u="/",search:h="",hash:m="",state:p=null,key:v="default"}=r,g=y.useMemo(()=>{let E=RE(u,l);return E==null?null:{location:{pathname:E,search:h,hash:m,state:p,key:v},navigationType:s}},[l,u,h,m,p,v,s]);return g==null?null:y.createElement(cl.Provider,{value:c},y.createElement(Yy.Provider,{children:n,value:g}))}function qx(t){let{children:e,location:n}=t;return ez(m0(e),n)}new Promise(()=>{});function m0(t,e){e===void 0&&(e=[]);let n=[];return y.Children.forEach(t,(r,s)=>{if(!y.isValidElement(r))return;let i=[...e,s];if(r.type===y.Fragment){n.push.apply(n,m0(r.props.children,i));return}r.type!==je&&cr(!1),!r.props.index||!r.props.children||cr(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=m0(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function p0(){return p0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},p0.apply(this,arguments)}function mz(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function pz(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function gz(t,e){return t.button===0&&(!e||e==="_self")&&!pz(t)}function g0(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function yz(t,e){let n=g0(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const vz=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],wz="6";try{window.__reactRouterVersion=wz}catch{}const _z="startTransition",Og=_y[_z];function bz(t){let{basename:e,children:n,future:r,window:s}=t,i=y.useRef();i.current==null&&(i.current=E9({window:s,v5Compat:!0}));let o=i.current,[a,l]=y.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=y.useCallback(h=>{c&&Og?Og(()=>l(h)):l(h)},[l,c]);return y.useLayoutEffect(()=>o.listen(u),[o,u]),y.useEffect(()=>xD(r),[r]),y.createElement(AD,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}function Ez(t){let{basename:e,children:n,future:r,window:s}=t,i=y.useRef();i.current==null&&(i.current=S9({window:s,v5Compat:!0}));let o=i.current,[a,l]=y.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=y.useCallback(h=>{c&&Og?Og(()=>l(h)):l(h)},[l,c]);return y.useLayoutEffect(()=>o.listen(u),[o,u]),y.useEffect(()=>xD(r),[r]),y.createElement(AD,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const Sz=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Iz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,y0=y.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,m=mz(e,vz),{basename:p}=y.useContext(cl),v,g=!1;if(typeof c=="string"&&Iz.test(c)&&(v=c,Sz))try{let S=new URL(window.location.href),P=c.startsWith("//")?new URL(S.protocol+c):new URL(c),T=RE(P.pathname,p);P.origin===S.origin&&T!=null?c=T+P.search+P.hash:g=!0}catch{}let E=Y9(c,{relative:s}),b=Tz(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:h});function _(S){r&&r(S),S.defaultPrevented||b(S)}return y.createElement("a",p0({},m,{href:v||E,onClick:g||i?r:_,ref:n,target:l}))});var Hx;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Hx||(Hx={}));var Kx;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Kx||(Kx={}));function Tz(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=io(),c=Ii(),u=ED(t,{relative:o});return y.useCallback(h=>{if(gz(h,n)){h.preventDefault();let m=r!==void 0?r:Sf(c)===Sf(u);l(t,{replace:m,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,r,s,n,t,i,o,a])}function zte(t){let e=y.useRef(g0(t)),n=y.useRef(!1),r=Ii(),s=y.useMemo(()=>yz(r.search,n.current?null:e.current),[r.search]),i=io(),o=y.useCallback((a,l)=>{const c=g0(typeof a=="function"?a(s):a);n.current=!0,i("?"+c,l)},[i,s]);return[s,o]}const PD=y.createContext(void 0),xz=({children:t})=>{const[e,n]=y.useState(()=>{if(typeof window<"u"){const l=["appFontSize","desktopFontSize","mobileFontSize"];for(const c of l){const u=localStorage.getItem(c);if(u&&["small","medium","large"].includes(u))return u}return window.innerWidth<=768?"small":"medium"}return"medium"}),[r,s]=y.useState(!1),[i,o]=y.useState(!1);y.useEffect(()=>{const l=()=>{const c=window.innerWidth<=768;s(c)};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),y.useEffect(()=>{try{const l=!!window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron")||typeof window<"u"&&window.location&&window.location.protocol==="file:";o(l)}catch{o(!1)}},[]),y.useEffect(()=>{},[]),y.useEffect(()=>{const l=document.documentElement;l.classList.remove("font-size-small","font-size-medium","font-size-large"),l.classList.add(`font-size-${e}`)},[e]);const a=l=>{n(l),localStorage.setItem("appFontSize",l),i&&localStorage.setItem("desktopFontSize",l)};return f.jsx(PD.Provider,{value:{fontSize:e,setFontSize:a,isMobile:r,isDesktopApp:i},children:t})},Wte=()=>{const t=y.useContext(PD);if(t===void 0)throw new Error("useFontSize must be used within a FontSizeProvider");return t};var Az=Symbol.for("react.lazy"),Lg=_y[" use ".trim().toString()];function Pz(t){return typeof t=="object"&&t!==null&&"then"in t}function RD(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===Az&&"_payload"in t&&Pz(t._payload)}function CD(t){const e=Cz(t),n=y.forwardRef((r,s)=>{let{children:i,...o}=r;RD(i)&&typeof Lg=="function"&&(i=Lg(i._payload));const a=y.Children.toArray(i),l=a.find(kz);if(l){const c=l.props.children,u=a.map(h=>h===l?y.Children.count(c)>1?y.Children.only(null):y.isValidElement(c)?c.props.children:null:h);return f.jsx(e,{...o,ref:s,children:y.isValidElement(c)?y.cloneElement(c,void 0,u):null})}return f.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var Rz=CD("Slot");function Cz(t){const e=y.forwardRef((n,r)=>{let{children:s,...i}=n;if(RD(s)&&typeof Lg=="function"&&(s=Lg(s._payload)),y.isValidElement(s)){const o=Oz(s),a=Dz(i,s.props);return s.type!==y.Fragment&&(a.ref=r?Yf(r,o):o),y.cloneElement(s,a)}return y.Children.count(s)>1?y.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Nz=Symbol("radix.slottable");function kz(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Nz}function Dz(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function Oz(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}const Lz=Fy("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full text-sm font-medium ring-offset-background transition-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-none hover:bg-primary",destructive:"bg-destructive text-destructive-foreground shadow-none hover:bg-destructive",outline:"border border-input bg-background shadow-none hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-none hover:bg-secondary",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-12 px-6 py-2",sm:"h-10 rounded-full px-4",lg:"h-14 rounded-full px-8",icon:"h-12 w-12"}},defaultVariants:{variant:"default",size:"default"}}),wt=y.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const o=r?Rz:"button";return f.jsx(o,{className:yn(Lz({variant:e,size:n,className:t})),ref:i,...s})});wt.displayName="Button";const ar=y.forwardRef(({className:t,type:e,...n},r)=>{const s={...n};return Object.prototype.hasOwnProperty.call(s,"value")&&s.value===void 0&&(s.value=""),f.jsx("input",{type:e,className:yn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...s})});ar.displayName="Input";const Mz=()=>{};var Gx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Vz=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},DE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let m=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(m=64)),r.push(n[u],n[h],n[m],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ND(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Vz(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||h==null)throw new jz;const m=i<<2|a>>4;if(r.push(m),c!==64){const p=a<<4&240|c>>2;if(r.push(p),h!==64){const v=c<<6&192|h;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class jz extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Fz=function(t){const e=ND(t);return DE.encodeByteArray(e,!0)},Mg=function(t){return Fz(t).replace(/\./g,"")},kD=function(t){try{return DE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uz=()=>DD().__FIREBASE_DEFAULTS__,$z=()=>{if(typeof process>"u"||typeof Gx>"u")return;const t=Gx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Bz=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&kD(t[1]);return e&&JSON.parse(e)},Jy=()=>{try{return Mz()||Uz()||$z()||Bz()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},OD=t=>{var e,n;return(n=(e=Jy())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},OE=t=>{const e=OD(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},LD=()=>{var t;return(t=Jy())==null?void 0:t.config},MD=t=>{var e;return(e=Jy())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Zf(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VD(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Mg(JSON.stringify(n)),Mg(JSON.stringify(o)),""].join(".")}const Uh={};function zz(){const t={prod:[],emulator:[]};for(const e of Object.keys(Uh))Uh[e]?t.emulator.push(e):t.prod.push(e);return t}function Wz(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Qx=!1;function Xy(t,e){if(typeof window>"u"||typeof document>"u"||!Ti(window.location.host)||Uh[t]===e||Uh[t]||Qx)return;Uh[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=zz().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,p){m.setAttribute("width","24"),m.setAttribute("id",p),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Qx=!0,o()},m}function u(m,p){m.setAttribute("id",p),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function h(){const m=Wz(r),p=n("text"),v=document.getElementById(p)||document.createElement("span"),g=n("learnmore"),E=document.getElementById(g)||document.createElement("a"),b=n("preprendIcon"),_=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const S=m.element;a(S),u(E,g);const P=c();l(_,b),S.append(_,v,E,P),document.body.appendChild(S)}i?(v.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _r(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qz(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_r())}function jD(){var e;const t=(e=Jy())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Hz(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Kz(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Gz(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Qz(){const t=_r();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function FD(){return!jD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function UD(){return!jD()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function LE(){try{return typeof indexedDB=="object"}catch{return!1}}function Yz(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jz="FirebaseError";class xi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Jz,Object.setPrototypeOf(this,xi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,kd.prototype.create)}}class kd{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Xz(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new xi(s,a,r)}}function Xz(t,e){return t.replace(Zz,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Zz=/\{\$([^}]+)}/g;function eW(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function wi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Yx(i)&&Yx(o)){if(!wi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Yx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function em(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function wh(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function _h(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function tW(t,e){const n=new nW(t,e);return n.subscribe.bind(n)}class nW{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");rW(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Pw),s.error===void 0&&(s.error=Pw),s.complete===void 0&&(s.complete=Pw);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rW(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Pw(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qte=4*60*60*1e3;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(t){return t&&t._delegate?t._delegate:t}class _i{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sW{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new v0;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(oW(e))try{this.getOrInitializeService({instanceIdentifier:xl})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=xl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xl){return this.instances.has(e)}getOptions(e=xl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:iW(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=xl){return this.component?this.component.multipleInstances?e:xl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function iW(t){return t===xl?void 0:t}function oW(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aW{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new sW(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Wt||(Wt={}));const lW={debug:Wt.DEBUG,verbose:Wt.VERBOSE,info:Wt.INFO,warn:Wt.WARN,error:Wt.ERROR,silent:Wt.SILENT},cW=Wt.INFO,uW={[Wt.DEBUG]:"log",[Wt.VERBOSE]:"log",[Wt.INFO]:"info",[Wt.WARN]:"warn",[Wt.ERROR]:"error"},dW=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=uW[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zy{constructor(e){this.name=e,this._logLevel=cW,this._logHandler=dW,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lW[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Wt.DEBUG,...e),this._logHandler(this,Wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Wt.VERBOSE,...e),this._logHandler(this,Wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Wt.INFO,...e),this._logHandler(this,Wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Wt.WARN,...e),this._logHandler(this,Wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Wt.ERROR,...e),this._logHandler(this,Wt.ERROR,...e)}}const hW=(t,e)=>e.some(n=>t instanceof n);let Jx,Xx;function fW(){return Jx||(Jx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function mW(){return Xx||(Xx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $D=new WeakMap,w0=new WeakMap,BD=new WeakMap,Rw=new WeakMap,ME=new WeakMap;function pW(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ja(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&$D.set(n,t)}).catch(()=>{}),ME.set(e,t),e}function gW(t){if(w0.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});w0.set(t,e)}let _0={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return w0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||BD.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ja(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function yW(t){_0=t(_0)}function vW(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Cw(this),e,...n);return BD.set(r,e.sort?e.sort():[e]),ja(r)}:mW().includes(t)?function(...e){return t.apply(Cw(this),e),ja($D.get(this))}:function(...e){return ja(t.apply(Cw(this),e))}}function wW(t){return typeof t=="function"?vW(t):(t instanceof IDBTransaction&&gW(t),hW(t,fW())?new Proxy(t,_0):t)}function ja(t){if(t instanceof IDBRequest)return pW(t);if(Rw.has(t))return Rw.get(t);const e=wW(t);return e!==t&&(Rw.set(t,e),ME.set(e,t)),e}const Cw=t=>ME.get(t);function _W(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=ja(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ja(o.result),l.oldVersion,l.newVersion,ja(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const bW=["get","getKey","getAll","getAllKeys","count"],EW=["put","add","delete","clear"],Nw=new Map;function Zx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Nw.get(e))return Nw.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=EW.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||bW.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return Nw.set(e,i),i}yW(t=>({...t,get:(e,n,r)=>Zx(e,n)||t.get(e,n,r),has:(e,n)=>!!Zx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SW{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(IW(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function IW(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const b0="@firebase/app",eA="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do=new Zy("@firebase/app"),TW="@firebase/app-compat",xW="@firebase/analytics-compat",AW="@firebase/analytics",PW="@firebase/app-check-compat",RW="@firebase/app-check",CW="@firebase/auth",NW="@firebase/auth-compat",kW="@firebase/database",DW="@firebase/data-connect",OW="@firebase/database-compat",LW="@firebase/functions",MW="@firebase/functions-compat",VW="@firebase/installations",jW="@firebase/installations-compat",FW="@firebase/messaging",UW="@firebase/messaging-compat",$W="@firebase/performance",BW="@firebase/performance-compat",zW="@firebase/remote-config",WW="@firebase/remote-config-compat",qW="@firebase/storage",HW="@firebase/storage-compat",KW="@firebase/firestore",GW="@firebase/ai",QW="@firebase/firestore-compat",YW="firebase",JW="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg="[DEFAULT]",XW={[b0]:"fire-core",[TW]:"fire-core-compat",[AW]:"fire-analytics",[xW]:"fire-analytics-compat",[RW]:"fire-app-check",[PW]:"fire-app-check-compat",[CW]:"fire-auth",[NW]:"fire-auth-compat",[kW]:"fire-rtdb",[DW]:"fire-data-connect",[OW]:"fire-rtdb-compat",[LW]:"fire-fn",[MW]:"fire-fn-compat",[VW]:"fire-iid",[jW]:"fire-iid-compat",[FW]:"fire-fcm",[UW]:"fire-fcm-compat",[$W]:"fire-perf",[BW]:"fire-perf-compat",[zW]:"fire-rc",[WW]:"fire-rc-compat",[qW]:"fire-gcs",[HW]:"fire-gcs-compat",[KW]:"fire-fst",[QW]:"fire-fst-compat",[GW]:"fire-vertex","fire-js":"fire-js",[YW]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gu=new Map,E0=new Map,S0=new Map;function tA(t,e){try{t.container.addComponent(e)}catch(n){Do.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function to(t){const e=t.name;if(S0.has(e))return Do.debug(`There were multiple attempts to register component ${e}.`),!1;S0.set(e,t);for(const n of Gu.values())tA(n,t);for(const n of E0.values())tA(n,t);return!0}function Tc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ZW(t,e,n=Vg){Tc(t,e).clearInstance(n)}function hs(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fa=new kd("app","Firebase",e8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t8{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new _i("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xc=JW;function zD(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Vg,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Fa.create("bad-app-name",{appName:String(s)});if(n||(n=LD()),!n)throw Fa.create("no-options");const i=Gu.get(s);if(i){if(wi(n,i.options)&&wi(r,i.config))return i;throw Fa.create("duplicate-app",{appName:s})}const o=new aW(s);for(const l of S0.values())o.addComponent(l);const a=new t8(n,r,o);return Gu.set(s,a),a}function ev(t=Vg){const e=Gu.get(t);if(!e&&t===Vg&&LD())return zD();if(!e)throw Fa.create("no-app",{appName:t});return e}async function Hte(t){let e=!1;const n=t.name;Gu.has(n)?(e=!0,Gu.delete(n)):E0.has(n)&&t.decRefCount()<=0&&(E0.delete(n),e=!0),e&&(await Promise.all(t.container.getProviders().map(r=>r.delete())),t.isDeleted=!0)}function Os(t,e,n){let r=XW[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Do.warn(o.join(" "));return}to(new _i(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n8="firebase-heartbeat-database",r8=1,Tf="firebase-heartbeat-store";let kw=null;function WD(){return kw||(kw=_W(n8,r8,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Tf)}catch(n){console.warn(n)}}}}).catch(t=>{throw Fa.create("idb-open",{originalErrorMessage:t.message})})),kw}async function s8(t){try{const n=(await WD()).transaction(Tf),r=await n.objectStore(Tf).get(qD(t));return await n.done,r}catch(e){if(e instanceof xi)Do.warn(e.message);else{const n=Fa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Do.warn(n.message)}}}async function nA(t,e){try{const r=(await WD()).transaction(Tf,"readwrite");await r.objectStore(Tf).put(e,qD(t)),await r.done}catch(n){if(n instanceof xi)Do.warn(n.message);else{const r=Fa.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Do.warn(r.message)}}}function qD(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i8=1024,o8=30;class a8{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new c8(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=rA();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>o8){const o=u8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Do.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=rA(),{heartbeatsToSend:r,unsentEntries:s}=l8(this._heartbeatsCache.heartbeats),i=Mg(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Do.warn(n),""}}}function rA(){return new Date().toISOString().substring(0,10)}function l8(t,e=i8){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),sA(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),sA(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class c8{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return LE()?Yz().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await s8(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return nA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return nA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function sA(t){return Mg(JSON.stringify({version:2,heartbeats:t})).length}function u8(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d8(t){to(new _i("platform-logger",e=>new SW(e),"PRIVATE")),to(new _i("heartbeat",e=>new a8(e),"PRIVATE")),Os(b0,eA,t),Os(b0,eA,"esm2020"),Os("fire-js","")}d8("");function HD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const h8=HD,KD=new kd("auth","Firebase",HD());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jg=new Zy("@firebase/auth");function f8(t,...e){jg.logLevel<=Wt.WARN&&jg.warn(`Auth (${xc}): ${t}`,...e)}function Lp(t,...e){jg.logLevel<=Wt.ERROR&&jg.error(`Auth (${xc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(t,...e){throw VE(t,...e)}function Qi(t,...e){return VE(t,...e)}function GD(t,e,n){const r={...h8(),[e]:n};return new kd("auth","Firebase",r).create(e,{appName:t.name})}function Io(t){return GD(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function VE(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return KD.create(t,...e)}function mt(t,e,...n){if(!t)throw VE(e,...n)}function vo(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Lp(e),new Error(e)}function Oo(t,e){t||vo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function QD(){return iA()==="http:"||iA()==="https:"}function iA(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(QD()||Kz()||"connection"in navigator)?navigator.onLine:!0}function p8(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e,n){this.shortDelay=e,this.longDelay=n,Oo(n>e,"Short delay should be less than long delay!"),this.isMobile=qz()||Gz()}get(){return m8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jE(t,e){Oo(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],v8=new tm(3e4,6e4);function oo(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ai(t,e,n,r,s={}){return JD(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=em({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...i};return Hz()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&Ti(t.emulatorConfig.host)&&(c.credentials="include"),YD.fetch()(await XD(t,t.config.apiHost,n,a),c)})}async function JD(t,e,n){t._canInitEmulator=!1;const r={...g8,...e};try{const s=new _8(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Jm(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jm(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Jm(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Jm(t,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw GD(t,u,c);bi(t,u)}}catch(s){if(s instanceof xi)throw s;bi(t,"network-request-failed",{message:String(s)})}}async function nm(t,e,n,r,s={}){const i=await Ai(t,e,n,r,s);return"mfaPendingCredential"in i&&bi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function XD(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?jE(t.config,s):`${t.config.apiScheme}://${s}`;return y8.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function w8(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class _8{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Qi(this.auth,"network-request-failed")),v8.get())})}}function Jm(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Qi(t,e,r);return s.customData._tokenResponse=n,s}function oA(t){return t!==void 0&&t.enterprise!==void 0}class b8{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return w8(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function E8(t,e){return Ai(t,"GET","/v2/recaptchaConfig",oo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S8(t,e){return Ai(t,"POST","/v1/accounts:delete",e)}async function Ug(t,e){return Ai(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function I8(t,e=!1){const n=Dt(t),r=await n.getIdToken(e),s=FE(r);mt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:$h(Dw(s.auth_time)),issuedAtTime:$h(Dw(s.iat)),expirationTime:$h(Dw(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Dw(t){return Number(t)*1e3}function FE(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Lp("JWT malformed, contained fewer than 3 sections"),null;try{const s=kD(n);return s?JSON.parse(s):(Lp("Failed to decode base64 JWT payload"),null)}catch(s){return Lp("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function aA(t){const e=FE(t);return mt(e,"internal-error"),mt(typeof e.exp<"u","internal-error"),mt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof xi&&T8(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function T8({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x8{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=$h(this.lastLoginAt),this.creationTime=$h(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $g(t){var h;const e=t.auth,n=await t.getIdToken(),r=await Qu(t,Ug(e,{idToken:n}));mt(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(h=s.providerUserInfo)!=null&&h.length?ZD(s.providerUserInfo):[],o=P8(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),c=a?l:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new I0(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function A8(t){const e=Dt(t);await $g(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function P8(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function ZD(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R8(t,e){const n=await JD(t,{},async()=>{const r=em({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await XD(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Ti(t.emulatorConfig.host)&&(l.credentials="include"),YD.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function C8(t,e){return Ai(t,"POST","/v2/accounts:revokeToken",oo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){mt(e.idToken,"internal-error"),mt(typeof e.idToken<"u","internal-error"),mt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):aA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){mt(e.length!==0,"internal-error");const n=aA(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(mt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await R8(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Iu;return r&&(mt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(mt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(mt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Iu,this.toJSON())}_performRefresh(){return vo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yo(t,e){mt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ui{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new x8(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new I0(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Qu(this,this.stsTokenManager.getToken(this.auth,e));return mt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return I8(this,e)}reload(){return A8(this)}_assign(e){this!==e&&(mt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ui({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){mt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await $g(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(hs(this.auth.app))return Promise.reject(Io(this.auth));const e=await this.getIdToken();return await Qu(this,S8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,c=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:h,emailVerified:m,isAnonymous:p,providerData:v,stsTokenManager:g}=n;mt(h&&g,e,"internal-error");const E=Iu.fromJSON(this.name,g);mt(typeof h=="string",e,"internal-error"),Yo(r,e.name),Yo(s,e.name),mt(typeof m=="boolean",e,"internal-error"),mt(typeof p=="boolean",e,"internal-error"),Yo(i,e.name),Yo(o,e.name),Yo(a,e.name),Yo(l,e.name),Yo(c,e.name),Yo(u,e.name);const b=new ui({uid:h,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:p,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:E,createdAt:c,lastLoginAt:u});return v&&Array.isArray(v)&&(b.providerData=v.map(_=>({..._}))),l&&(b._redirectEventId=l),b}static async _fromIdTokenResponse(e,n,r=!1){const s=new Iu;s.updateFromServerResponse(n);const i=new ui({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await $g(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];mt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?ZD(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Iu;a.updateFromIdToken(r);const l=new ui({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new I0(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA=new Map;function wo(t){Oo(t instanceof Function,"Expected a class definition");let e=lA.get(t);return e?(Oo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,lA.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}e2.type="NONE";const T0=e2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mp(t,e,n){return`firebase:${t}:${e}:${n}`}class Tu{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Mp(this.userKey,s.apiKey,i),this.fullPersistenceKey=Mp("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Ug(this.auth,{idToken:e}).catch(()=>{});return n?ui._fromGetAccountInfoResponse(this.auth,n,e):null}return ui._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Tu(wo(T0),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||wo(T0);const o=Mp(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){let h;if(typeof u=="string"){const m=await Ug(e,{idToken:u}).catch(()=>{});if(!m)break;h=await ui._fromGetAccountInfoResponse(e,m,u)}else h=ui._fromJSON(e,u);c!==i&&(a=h),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Tu(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Tu(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(s2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(t2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(o2(e))return"Blackberry";if(a2(e))return"Webos";if(n2(e))return"Safari";if((e.includes("chrome/")||r2(e))&&!e.includes("edge/"))return"Chrome";if(i2(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function t2(t=_r()){return/firefox\//i.test(t)}function n2(t=_r()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function r2(t=_r()){return/crios\//i.test(t)}function s2(t=_r()){return/iemobile/i.test(t)}function i2(t=_r()){return/android/i.test(t)}function o2(t=_r()){return/blackberry/i.test(t)}function a2(t=_r()){return/webos/i.test(t)}function UE(t=_r()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function N8(t=_r()){var e;return UE(t)&&!!((e=window.navigator)!=null&&e.standalone)}function k8(){return Qz()&&document.documentMode===10}function l2(t=_r()){return UE(t)||i2(t)||a2(t)||o2(t)||/windows phone/i.test(t)||s2(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c2(t,e=[]){let n;switch(t){case"Browser":n=cA(_r());break;case"Worker":n=`${cA(_r())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${xc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O8(t,e={}){return Ai(t,"GET","/v2/passwordPolicy",oo(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L8=6;class M8{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??L8,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V8{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new uA(this),this.idTokenSubscription=new uA(this),this.beforeStateQueue=new D8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=KD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=wo(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Tu.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Ug(this,{idToken:e}),r=await ui._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(hs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return mt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await $g(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=p8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(hs(this.app))return Promise.reject(Io(this));const n=e?Dt(e):null;return n&&mt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&mt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return hs(this.app)?Promise.reject(Io(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return hs(this.app)?Promise.reject(Io(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(wo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await O8(this),n=new M8(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new kd("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await C8(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&wo(e)||this._popupRedirectResolver;mt(n,this,"argument-error"),this.redirectPersistenceManager=await Tu.create(this,[wo(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(mt(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return mt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=c2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(hs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&f8(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ul(t){return Dt(t)}class uA{constructor(e){this.auth=e,this.observer=null,this.addObserver=tW(n=>this.observer=n)}get next(){return mt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function j8(t){tv=t}function u2(t){return tv.loadJS(t)}function F8(){return tv.recaptchaEnterpriseScript}function U8(){return tv.gapiScript}function $8(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class B8{constructor(){this.enterprise=new z8}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class z8{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const W8="recaptcha-enterprise",d2="NO_RECAPTCHA";class q8{constructor(e){this.type=W8,this.auth=ul(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{E8(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new b8(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;oA(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(d2)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new B8().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&oA(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=F8();l.length!==0&&(l+=a),u2(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function dA(t,e,n,r=!1,s=!1){const i=new q8(t);let o;if(s)o=d2;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Bg(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await dA(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await dA(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h2(t,e){const n=Tc(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(wi(i,e??{}))return s;bi(s,"already-initialized")}return n.initialize({options:e})}function H8(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(wo);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function K8(t,e,n){const r=ul(t);mt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=f2(e),{host:o,port:a}=G8(e),l=a===null?"":`:${a}`,c={url:`${i}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){mt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),mt(wi(c,r.config.emulator)&&wi(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,Ti(o)?(Zf(`${i}//${o}${l}`),Xy("Auth",!0)):Q8()}function f2(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function G8(t){const e=f2(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:hA(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:hA(o)}}}function hA(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Q8(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return vo("not implemented")}_getIdTokenResponse(e){return vo("not implemented")}_linkToIdToken(e,n){return vo("not implemented")}_getReauthenticationResolver(e){return vo("not implemented")}}async function Y8(t,e){return Ai(t,"POST","/v1/accounts:update",e)}async function J8(t,e){return Ai(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X8(t,e){return nm(t,"POST","/v1/accounts:signInWithPassword",oo(t,e))}async function Z8(t,e){return Ai(t,"POST","/v1/accounts:sendOobCode",oo(t,e))}async function e7(t,e){return Z8(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t7(t,e){return nm(t,"POST","/v1/accounts:signInWithEmailLink",oo(t,e))}async function n7(t,e){return nm(t,"POST","/v1/accounts:signInWithEmailLink",oo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf extends $E{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new xf(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new xf(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bg(e,n,"signInWithPassword",X8);case"emailLink":return t7(e,{email:this._email,oobCode:this._password});default:bi(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bg(e,r,"signUpPassword",J8);case"emailLink":return n7(e,{idToken:n,email:this._email,oobCode:this._password});default:bi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xu(t,e){return nm(t,"POST","/v1/accounts:signInWithIdp",oo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r7="http://localhost";class lc extends $E{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new lc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):bi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new lc(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return xu(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,xu(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,xu(e,n)}buildRequest(){const e={requestUri:r7,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=em(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s7(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function i7(t){const e=wh(_h(t)).link,n=e?wh(_h(e)).deep_link_id:null,r=wh(_h(t)).deep_link_id;return(r?wh(_h(r)).link:null)||r||n||e||t}class BE{constructor(e){const n=wh(_h(e)),r=n.apiKey??null,s=n.oobCode??null,i=s7(n.mode??null);mt(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=i7(e);try{return new BE(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(){this.providerId=Ac.PROVIDER_ID}static credential(e,n){return xf._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=BE.parseLink(n);return mt(r,"argument-error"),xf._fromEmailAndCode(e,r.code,r.tenantId)}}Ac.PROVIDER_ID="password";Ac.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ac.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm extends m2{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua extends rm{constructor(){super("facebook.com")}static credential(e){return lc._fromParams({providerId:ua.PROVIDER_ID,signInMethod:ua.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ua.credentialFromTaggedObject(e)}static credentialFromError(e){return ua.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ua.credential(e.oauthAccessToken)}catch{return null}}}ua.FACEBOOK_SIGN_IN_METHOD="facebook.com";ua.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da extends rm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return lc._fromParams({providerId:da.PROVIDER_ID,signInMethod:da.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return da.credentialFromTaggedObject(e)}static credentialFromError(e){return da.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return da.credential(n,r)}catch{return null}}}da.GOOGLE_SIGN_IN_METHOD="google.com";da.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha extends rm{constructor(){super("github.com")}static credential(e){return lc._fromParams({providerId:ha.PROVIDER_ID,signInMethod:ha.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ha.credentialFromTaggedObject(e)}static credentialFromError(e){return ha.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ha.credential(e.oauthAccessToken)}catch{return null}}}ha.GITHUB_SIGN_IN_METHOD="github.com";ha.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa extends rm{constructor(){super("twitter.com")}static credential(e,n){return lc._fromParams({providerId:fa.PROVIDER_ID,signInMethod:fa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return fa.credentialFromTaggedObject(e)}static credentialFromError(e){return fa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return fa.credential(n,r)}catch{return null}}}fa.TWITTER_SIGN_IN_METHOD="twitter.com";fa.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o7(t,e){return nm(t,"POST","/v1/accounts:signUp",oo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await ui._fromIdTokenResponse(e,r,s),o=fA(r);return new cc({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=fA(r);return new cc({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function fA(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg extends xi{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,zg.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new zg(e,n,r,s)}}function p2(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?zg._fromErrorAndOperation(t,i,e,r):i})}async function a7(t,e,n=!1){const r=await Qu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return cc._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g2(t,e,n=!1){const{auth:r}=t;if(hs(r.app))return Promise.reject(Io(r));const s="reauthenticate";try{const i=await Qu(t,p2(r,s,e,t),n);mt(i.idToken,r,"internal-error");const o=FE(i.idToken);mt(o,r,"internal-error");const{sub:a}=o;return mt(t.uid===a,r,"user-mismatch"),cc._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&bi(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y2(t,e,n=!1){if(hs(t.app))return Promise.reject(Io(t));const r="signIn",s=await p2(t,r,e),i=await cc._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function l7(t,e){return y2(ul(t),e)}async function c7(t,e){return g2(Dt(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v2(t){const e=ul(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function u7(t,e,n){const r=ul(t);await Bg(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",e7)}async function mA(t,e,n){if(hs(t.app))return Promise.reject(Io(t));const r=ul(t),o=await Bg(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",o7).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&v2(t),l}),a=await cc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function w2(t,e,n){return hs(t.app)?Promise.reject(Io(t)):l7(Dt(t),Ac.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&v2(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d7(t,e){return Ai(t,"POST","/v1/accounts:createAuthUri",oo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h7(t,e){const n=QD()?Fg():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:s}=await d7(Dt(t),r);return s||[]}function Kte(t,e){return f7(Dt(t),null,e)}async function f7(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(i.password=n);const o=await Qu(t,Y8(r,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m7(t,e){return Dt(t).setPersistence(e)}function p7(t,e,n,r){return Dt(t).onIdTokenChanged(e,n,r)}function g7(t,e,n){return Dt(t).beforeAuthStateChanged(e,n)}function y7(t,e,n,r){return Dt(t).onAuthStateChanged(e,n,r)}function pA(t){return Dt(t).signOut()}const Wg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Wg,"1"),this.storage.removeItem(Wg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v7=1e3,w7=10;class b2 extends _2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=l2(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);k8()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,w7):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},v7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}b2.type="LOCAL";const zE=b2;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2 extends _2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}E2.type="SESSION";const WE=E2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _7(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new nv(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(n.origin,i)),l=await _7(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}nv.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qE(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b7{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=qE("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const m=h;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(){return window}function E7(t){Yi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S2(){return typeof Yi().WorkerGlobalScope<"u"&&typeof Yi().importScripts=="function"}async function S7(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function I7(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function T7(){return S2()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2="firebaseLocalStorageDb",x7=1,qg="firebaseLocalStorage",T2="fbase_key";class sm{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function rv(t,e){return t.transaction([qg],e?"readwrite":"readonly").objectStore(qg)}function A7(){const t=indexedDB.deleteDatabase(I2);return new sm(t).toPromise()}function x0(){const t=indexedDB.open(I2,x7);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(qg,{keyPath:T2})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(qg)?e(r):(r.close(),await A7(),e(await x0()))})})}async function gA(t,e,n){const r=rv(t,!0).put({[T2]:e,value:n});return new sm(r).toPromise()}async function P7(t,e){const n=rv(t,!1).get(e),r=await new sm(n).toPromise();return r===void 0?null:r.value}function yA(t,e){const n=rv(t,!0).delete(e);return new sm(n).toPromise()}const R7=800,C7=3;class x2{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await x0(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>C7)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return S2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nv._getInstance(T7()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await S7(),!this.activeServiceWorker)return;this.sender=new b7(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||I7()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await x0();return await gA(e,Wg,"1"),await yA(e,Wg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>gA(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>P7(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>yA(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=rv(s,!1).getAll();return new sm(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),R7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}x2.type="LOCAL";const N7=x2;new tm(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k7(t,e){return e?wo(e):(mt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE extends $E{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return xu(e,this._buildIdpRequest())}_linkToIdToken(e,n){return xu(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return xu(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function D7(t){return y2(t.auth,new HE(t),t.bypassAuthState)}function O7(t){const{auth:e,user:n}=t;return mt(n,e,"internal-error"),g2(n,new HE(t),t.bypassAuthState)}async function L7(t){const{auth:e,user:n}=t;return mt(n,e,"internal-error"),a7(n,new HE(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return D7;case"linkViaPopup":case"linkViaRedirect":return L7;case"reauthViaPopup":case"reauthViaRedirect":return O7;default:bi(this.auth,"internal-error")}}resolve(e){Oo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Oo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M7=new tm(2e3,1e4);class cu extends A2{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,cu.currentPopupAction&&cu.currentPopupAction.cancel(),cu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return mt(e,this.auth,"internal-error"),e}async onExecution(){Oo(this.filter.length===1,"Popup operations only handle one event");const e=qE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Qi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Qi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,cu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,M7.get())};e()}}cu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V7="pendingRedirect",Vp=new Map;class j7 extends A2{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Vp.get(this.auth._key());if(!e){try{const r=await F7(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Vp.set(this.auth._key(),e)}return this.bypassAuthState||Vp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function F7(t,e){const n=B7(e),r=$7(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function U7(t,e){Vp.set(t._key(),e)}function $7(t){return wo(t._redirectPersistence)}function B7(t){return Mp(V7,t.config.apiKey,t.name)}async function z7(t,e,n=!1){if(hs(t.app))return Promise.reject(Io(t));const r=ul(t),s=k7(r,e),o=await new j7(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W7=10*60*1e3;class q7{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!H7(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!P2(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Qi(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=W7&&this.cachedEventUids.clear(),this.cachedEventUids.has(vA(e))}saveEventToCache(e){this.cachedEventUids.add(vA(e)),this.lastProcessedEventTime=Date.now()}}function vA(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function P2({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function H7(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return P2(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K7(t,e={}){return Ai(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Q7=/^https?/;async function Y7(t){if(t.config.emulator)return;const{authorizedDomains:e}=await K7(t);for(const n of e)try{if(J7(n))return}catch{}bi(t,"unauthorized-domain")}function J7(t){const e=Fg(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Q7.test(n))return!1;if(G7.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X7=new tm(3e4,6e4);function wA(){const t=Yi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Z7(t){return new Promise((e,n)=>{var s,i,o;function r(){wA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wA(),n(Qi(t,"network-request-failed"))},timeout:X7.get()})}if((i=(s=Yi().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Yi().gapi)!=null&&o.load)r();else{const a=$8("iframefcb");return Yi()[a]=()=>{gapi.load?r():n(Qi(t,"network-request-failed"))},u2(`${U8()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw jp=null,e})}let jp=null;function eq(t){return jp=jp||Z7(t),jp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tq=new tm(5e3,15e3),nq="__/auth/iframe",rq="emulator/auth/iframe",sq={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},iq=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function oq(t){const e=t.config;mt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?jE(e,rq):`https://${t.config.authDomain}/${nq}`,r={apiKey:e.apiKey,appName:t.name,v:xc},s=iq.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${em(r).slice(1)}`}async function aq(t){const e=await eq(t),n=Yi().gapi;return mt(n,t,"internal-error"),e.open({where:document.body,url:oq(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sq,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Qi(t,"network-request-failed"),a=Yi().setTimeout(()=>{i(o)},tq.get());function l(){Yi().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lq={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},cq=500,uq=600,dq="_blank",hq="http://localhost";class _A{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function fq(t,e,n,r=cq,s=uq){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...lq,width:r.toString(),height:s.toString(),top:i,left:o},c=_r().toLowerCase();n&&(a=r2(c)?dq:n),t2(c)&&(e=e||hq,l.scrollbars="yes");const u=Object.entries(l).reduce((m,[p,v])=>`${m}${p}=${v},`,"");if(N8(c)&&a!=="_self")return mq(e||"",a),new _A(null);const h=window.open(e||"",a,u);mt(h,t,"popup-blocked");try{h.focus()}catch{}return new _A(h)}function mq(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pq="__/auth/handler",gq="emulator/auth/handler",yq=encodeURIComponent("fac");async function bA(t,e,n,r,s,i){mt(t.config.authDomain,t,"auth-domain-config-required"),mt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:xc,eventId:s};if(e instanceof m2){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",eW(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof rm){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${yq}=${encodeURIComponent(l)}`:"";return`${vq(t)}?${em(a).slice(1)}${c}`}function vq({config:t}){return t.emulator?jE(t,gq):`https://${t.authDomain}/${pq}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow="webStorageSupport";class wq{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=WE,this._completeRedirectFn=z7,this._overrideRedirectResult=U7}async _openPopup(e,n,r,s){var o;Oo((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await bA(e,n,r,Fg(),s);return fq(e,i,qE())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await bA(e,n,r,Fg(),s);return E7(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Oo(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await aq(e),r=new q7(e);return n.register("authEvent",s=>(mt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ow,{type:Ow},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Ow];i!==void 0&&n(!!i),bi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Y7(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return l2()||n2()||UE()}}const _q=wq;var EA="@firebase/auth",SA="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bq{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){mt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eq(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Sq(t){to(new _i("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;mt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:c2(t)},c=new V8(r,s,i,l);return H8(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),to(new _i("auth-internal",e=>{const n=ul(e.getProvider("auth").getImmediate());return(r=>new bq(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Os(EA,SA,Eq(t)),Os(EA,SA,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iq=5*60,Tq=MD("authIdTokenMaxAge")||Iq;let IA=null;const xq=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Tq)return;const s=n==null?void 0:n.token;IA!==s&&(IA=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Gte(t=ev()){const e=Tc(t,"auth");if(e.isInitialized())return e.getImmediate();const n=h2(t,{popupRedirectResolver:_q,persistence:[N7,zE,WE]}),r=MD("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=xq(i.toString());g7(n,o,()=>o(n.currentUser)),p7(n,a=>o(a))}}const s=OD("auth");return s&&K8(n,`http://${s}`),n}function Aq(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}j8({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Qi("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Aq().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Sq("Browser");var Pq="firebase",Rq="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Os(Pq,Rq,"app");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cq=new Map,Nq={activated:!1,tokenObservers:[]},kq={initialized:!1,enabled:!1};function Ei(t){return Cq.get(t)||{...Nq}}function R2(){return kq}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dq="https://content-firebaseappcheck.googleapis.com/v1";const Oq="exchangeDebugToken",TA={RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Qte=24*60*60*1e3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lq{constructor(e,n,r,s,i){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new v0,this.pending.promise.catch(n=>{}),await Mq(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new v0,this.pending.promise.catch(n=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function Mq(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vq={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},Ta=new kd("appCheck","AppCheck",Vq);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C2(t){if(!Ei(t).activated)throw Ta.create("use-before-activation",{appName:t.name})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N2({url:t,body:e},n){const r={"Content-Type":"application/json"},s=n.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&(r["X-Firebase-Client"]=h)}const i={method:"POST",body:JSON.stringify(e),headers:r};let o;try{o=await fetch(t,i)}catch(h){throw Ta.create("fetch-network-error",{originalErrorMessage:h==null?void 0:h.message})}if(o.status!==200)throw Ta.create("fetch-status-error",{httpStatus:o.status});let a;try{a=await o.json()}catch(h){throw Ta.create("fetch-parse-error",{originalErrorMessage:h==null?void 0:h.message})}const l=a.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw Ta.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const c=Number(l[1])*1e3,u=Date.now();return{token:a.token,expireTimeMillis:u+c,issuedAtTimeMillis:u}}function k2(t,e){const{projectId:n,appId:r,apiKey:s}=t.options;return{url:`${Dq}/projects/${n}/apps/${r}:${Oq}?key=${s}`,body:{debug_token:e}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jq="firebase-app-check-database",Fq=1,A0="firebase-app-check-store";let Xm=null;function Uq(){return Xm||(Xm=new Promise((t,e)=>{try{const n=indexedDB.open(jq,Fq);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var s;e(Ta.create("storage-open",{originalErrorMessage:(s=r.target.error)==null?void 0:s.message}))},n.onupgradeneeded=r=>{const s=r.target.result;switch(r.oldVersion){case 0:s.createObjectStore(A0,{keyPath:"compositeKey"})}}}catch(n){e(Ta.create("storage-open",{originalErrorMessage:n==null?void 0:n.message}))}}),Xm)}function $q(t,e){return Bq(zq(t),e)}async function Bq(t,e){const r=(await Uq()).transaction(A0,"readwrite"),i=r.objectStore(A0).put({compositeKey:t,value:e});return new Promise((o,a)=>{i.onsuccess=l=>{o()},r.onerror=l=>{var c;a(Ta.create("storage-set",{originalErrorMessage:(c=l.target.error)==null?void 0:c.message}))}})}function zq(t){return`${t.options.appId}-${t.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh=new Zy("@firebase/app-check");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(t,e){return LE()?$q(t,e).catch(n=>{bh.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D2(){return R2().enabled}async function O2(){const t=R2();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wq={error:"UNKNOWN_ERROR"};function qq(t){return DE.encodeString(JSON.stringify(t),!1)}async function P0(t,e=!1,n=!1){const r=t.app;C2(r);const s=Ei(r);let i=s.token,o;if(i&&!Eh(i)&&(s.token=void 0,i=void 0),!i){const c=await s.cachedTokenPromise;c&&(Eh(c)?i=c:await Lw(r,void 0))}if(!e&&i&&Eh(i))return{token:i.token};let a=!1;if(D2())try{s.exchangeTokenPromise||(s.exchangeTokenPromise=N2(k2(r,await O2()),t.heartbeatServiceProvider).finally(()=>{s.exchangeTokenPromise=void 0}),a=!0);const c=await s.exchangeTokenPromise;return await Lw(r,c),s.token=c,{token:c.token}}catch(c){return c.code==="appCheck/throttled"||c.code==="appCheck/initial-throttle"?bh.warn(c.message):n&&bh.error(c),Mw(c)}try{s.exchangeTokenPromise||(s.exchangeTokenPromise=s.provider.getToken().finally(()=>{s.exchangeTokenPromise=void 0}),a=!0),i=await Ei(r).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"||c.code==="appCheck/initial-throttle"?bh.warn(c.message):n&&bh.error(c),o=c}let l;return i?o?Eh(i)?l={token:i.token,internalError:o}:l=Mw(o):(l={token:i.token},s.token=i,await Lw(r,i)):l=Mw(o),a&&Qq(r,l),l}async function Hq(t){const e=t.app;C2(e);const{provider:n}=Ei(e);if(D2()){const r=await O2(),{token:s}=await N2(k2(e,r),t.heartbeatServiceProvider);return{token:s}}else{const{token:r}=await n.getToken();return{token:r}}}function Kq(t,e,n,r){const{app:s}=t,i=Ei(s),o={next:n,error:r,type:e};if(i.tokenObservers=[...i.tokenObservers,o],i.token&&Eh(i.token)){const a=i.token;Promise.resolve().then(()=>{n({token:a.token}),xA(t)}).catch(()=>{})}i.cachedTokenPromise.then(()=>xA(t))}function L2(t,e){const n=Ei(t),r=n.tokenObservers.filter(s=>s.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function xA(t){const{app:e}=t,n=Ei(e);let r=n.tokenRefresher;r||(r=Gq(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function Gq(t){const{app:e}=t;return new Lq(async()=>{const n=Ei(e);let r;if(n.token?r=await P0(t,!0):r=await P0(t),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{const n=Ei(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const s=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,s),Math.max(0,r-Date.now())}else return 0},TA.RETRIAL_MIN_WAIT,TA.RETRIAL_MAX_WAIT)}function Qq(t,e){const n=Ei(t).tokenObservers;for(const r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Eh(t){return t.expireTimeMillis-Date.now()>0}function Mw(t){return{token:qq(Wq),error:t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yq{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=Ei(this.app);for(const n of e)L2(this.app,n.next);return Promise.resolve()}}function Jq(t,e){return new Yq(t,e)}function Xq(t){return{getToken:e=>P0(t,e),getLimitedUseToken:()=>Hq(t),addTokenListener:e=>Kq(t,"INTERNAL",e),removeTokenListener:e=>L2(t.app,e)}}const Zq="@firebase/app-check",eH="0.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tH="app-check",AA="app-check-internal";function nH(){to(new _i(tH,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return Jq(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(AA).initialize()})),to(new _i(AA,t=>{const e=t.getProvider("app-check").getImmediate();return Xq(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Os(Zq,eH)}nH();var PA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ua,M2;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,A){function R(){}R.prototype=A.prototype,I.F=A.prototype,I.prototype=new R,I.prototype.constructor=I,I.D=function(k,C,L){for(var O=Array(arguments.length-2),X=2;X<arguments.length;X++)O[X-2]=arguments[X];return A.prototype[C].apply(k,O)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,A,R){R||(R=0);const k=Array(16);if(typeof A=="string")for(var C=0;C<16;++C)k[C]=A.charCodeAt(R++)|A.charCodeAt(R++)<<8|A.charCodeAt(R++)<<16|A.charCodeAt(R++)<<24;else for(C=0;C<16;++C)k[C]=A[R++]|A[R++]<<8|A[R++]<<16|A[R++]<<24;A=I.g[0],R=I.g[1],C=I.g[2];let L=I.g[3],O;O=A+(L^R&(C^L))+k[0]+3614090360&4294967295,A=R+(O<<7&4294967295|O>>>25),O=L+(C^A&(R^C))+k[1]+3905402710&4294967295,L=A+(O<<12&4294967295|O>>>20),O=C+(R^L&(A^R))+k[2]+606105819&4294967295,C=L+(O<<17&4294967295|O>>>15),O=R+(A^C&(L^A))+k[3]+3250441966&4294967295,R=C+(O<<22&4294967295|O>>>10),O=A+(L^R&(C^L))+k[4]+4118548399&4294967295,A=R+(O<<7&4294967295|O>>>25),O=L+(C^A&(R^C))+k[5]+1200080426&4294967295,L=A+(O<<12&4294967295|O>>>20),O=C+(R^L&(A^R))+k[6]+2821735955&4294967295,C=L+(O<<17&4294967295|O>>>15),O=R+(A^C&(L^A))+k[7]+4249261313&4294967295,R=C+(O<<22&4294967295|O>>>10),O=A+(L^R&(C^L))+k[8]+1770035416&4294967295,A=R+(O<<7&4294967295|O>>>25),O=L+(C^A&(R^C))+k[9]+2336552879&4294967295,L=A+(O<<12&4294967295|O>>>20),O=C+(R^L&(A^R))+k[10]+4294925233&4294967295,C=L+(O<<17&4294967295|O>>>15),O=R+(A^C&(L^A))+k[11]+2304563134&4294967295,R=C+(O<<22&4294967295|O>>>10),O=A+(L^R&(C^L))+k[12]+1804603682&4294967295,A=R+(O<<7&4294967295|O>>>25),O=L+(C^A&(R^C))+k[13]+4254626195&4294967295,L=A+(O<<12&4294967295|O>>>20),O=C+(R^L&(A^R))+k[14]+2792965006&4294967295,C=L+(O<<17&4294967295|O>>>15),O=R+(A^C&(L^A))+k[15]+1236535329&4294967295,R=C+(O<<22&4294967295|O>>>10),O=A+(C^L&(R^C))+k[1]+4129170786&4294967295,A=R+(O<<5&4294967295|O>>>27),O=L+(R^C&(A^R))+k[6]+3225465664&4294967295,L=A+(O<<9&4294967295|O>>>23),O=C+(A^R&(L^A))+k[11]+643717713&4294967295,C=L+(O<<14&4294967295|O>>>18),O=R+(L^A&(C^L))+k[0]+3921069994&4294967295,R=C+(O<<20&4294967295|O>>>12),O=A+(C^L&(R^C))+k[5]+3593408605&4294967295,A=R+(O<<5&4294967295|O>>>27),O=L+(R^C&(A^R))+k[10]+38016083&4294967295,L=A+(O<<9&4294967295|O>>>23),O=C+(A^R&(L^A))+k[15]+3634488961&4294967295,C=L+(O<<14&4294967295|O>>>18),O=R+(L^A&(C^L))+k[4]+3889429448&4294967295,R=C+(O<<20&4294967295|O>>>12),O=A+(C^L&(R^C))+k[9]+568446438&4294967295,A=R+(O<<5&4294967295|O>>>27),O=L+(R^C&(A^R))+k[14]+3275163606&4294967295,L=A+(O<<9&4294967295|O>>>23),O=C+(A^R&(L^A))+k[3]+4107603335&4294967295,C=L+(O<<14&4294967295|O>>>18),O=R+(L^A&(C^L))+k[8]+1163531501&4294967295,R=C+(O<<20&4294967295|O>>>12),O=A+(C^L&(R^C))+k[13]+2850285829&4294967295,A=R+(O<<5&4294967295|O>>>27),O=L+(R^C&(A^R))+k[2]+4243563512&4294967295,L=A+(O<<9&4294967295|O>>>23),O=C+(A^R&(L^A))+k[7]+1735328473&4294967295,C=L+(O<<14&4294967295|O>>>18),O=R+(L^A&(C^L))+k[12]+2368359562&4294967295,R=C+(O<<20&4294967295|O>>>12),O=A+(R^C^L)+k[5]+4294588738&4294967295,A=R+(O<<4&4294967295|O>>>28),O=L+(A^R^C)+k[8]+2272392833&4294967295,L=A+(O<<11&4294967295|O>>>21),O=C+(L^A^R)+k[11]+1839030562&4294967295,C=L+(O<<16&4294967295|O>>>16),O=R+(C^L^A)+k[14]+4259657740&4294967295,R=C+(O<<23&4294967295|O>>>9),O=A+(R^C^L)+k[1]+2763975236&4294967295,A=R+(O<<4&4294967295|O>>>28),O=L+(A^R^C)+k[4]+1272893353&4294967295,L=A+(O<<11&4294967295|O>>>21),O=C+(L^A^R)+k[7]+4139469664&4294967295,C=L+(O<<16&4294967295|O>>>16),O=R+(C^L^A)+k[10]+3200236656&4294967295,R=C+(O<<23&4294967295|O>>>9),O=A+(R^C^L)+k[13]+681279174&4294967295,A=R+(O<<4&4294967295|O>>>28),O=L+(A^R^C)+k[0]+3936430074&4294967295,L=A+(O<<11&4294967295|O>>>21),O=C+(L^A^R)+k[3]+3572445317&4294967295,C=L+(O<<16&4294967295|O>>>16),O=R+(C^L^A)+k[6]+76029189&4294967295,R=C+(O<<23&4294967295|O>>>9),O=A+(R^C^L)+k[9]+3654602809&4294967295,A=R+(O<<4&4294967295|O>>>28),O=L+(A^R^C)+k[12]+3873151461&4294967295,L=A+(O<<11&4294967295|O>>>21),O=C+(L^A^R)+k[15]+530742520&4294967295,C=L+(O<<16&4294967295|O>>>16),O=R+(C^L^A)+k[2]+3299628645&4294967295,R=C+(O<<23&4294967295|O>>>9),O=A+(C^(R|~L))+k[0]+4096336452&4294967295,A=R+(O<<6&4294967295|O>>>26),O=L+(R^(A|~C))+k[7]+1126891415&4294967295,L=A+(O<<10&4294967295|O>>>22),O=C+(A^(L|~R))+k[14]+2878612391&4294967295,C=L+(O<<15&4294967295|O>>>17),O=R+(L^(C|~A))+k[5]+4237533241&4294967295,R=C+(O<<21&4294967295|O>>>11),O=A+(C^(R|~L))+k[12]+1700485571&4294967295,A=R+(O<<6&4294967295|O>>>26),O=L+(R^(A|~C))+k[3]+2399980690&4294967295,L=A+(O<<10&4294967295|O>>>22),O=C+(A^(L|~R))+k[10]+4293915773&4294967295,C=L+(O<<15&4294967295|O>>>17),O=R+(L^(C|~A))+k[1]+2240044497&4294967295,R=C+(O<<21&4294967295|O>>>11),O=A+(C^(R|~L))+k[8]+1873313359&4294967295,A=R+(O<<6&4294967295|O>>>26),O=L+(R^(A|~C))+k[15]+4264355552&4294967295,L=A+(O<<10&4294967295|O>>>22),O=C+(A^(L|~R))+k[6]+2734768916&4294967295,C=L+(O<<15&4294967295|O>>>17),O=R+(L^(C|~A))+k[13]+1309151649&4294967295,R=C+(O<<21&4294967295|O>>>11),O=A+(C^(R|~L))+k[4]+4149444226&4294967295,A=R+(O<<6&4294967295|O>>>26),O=L+(R^(A|~C))+k[11]+3174756917&4294967295,L=A+(O<<10&4294967295|O>>>22),O=C+(A^(L|~R))+k[2]+718787259&4294967295,C=L+(O<<15&4294967295|O>>>17),O=R+(L^(C|~A))+k[9]+3951481745&4294967295,I.g[0]=I.g[0]+A&4294967295,I.g[1]=I.g[1]+(C+(O<<21&4294967295|O>>>11))&4294967295,I.g[2]=I.g[2]+C&4294967295,I.g[3]=I.g[3]+L&4294967295}r.prototype.v=function(I,A){A===void 0&&(A=I.length);const R=A-this.blockSize,k=this.C;let C=this.h,L=0;for(;L<A;){if(C==0)for(;L<=R;)s(this,I,L),L+=this.blockSize;if(typeof I=="string"){for(;L<A;)if(k[C++]=I.charCodeAt(L++),C==this.blockSize){s(this,k),C=0;break}}else for(;L<A;)if(k[C++]=I[L++],C==this.blockSize){s(this,k),C=0;break}}this.h=C,this.o+=A},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var A=1;A<I.length-8;++A)I[A]=0;A=this.o*8;for(var R=I.length-8;R<I.length;++R)I[R]=A&255,A/=256;for(this.v(I),I=Array(16),A=0,R=0;R<4;++R)for(let k=0;k<32;k+=8)I[A++]=this.g[R]>>>k&255;return I};function i(I,A){var R=a;return Object.prototype.hasOwnProperty.call(R,I)?R[I]:R[I]=A(I)}function o(I,A){this.h=A;const R=[];let k=!0;for(let C=I.length-1;C>=0;C--){const L=I[C]|0;k&&L==A||(R[C]=L,k=!1)}this.g=R}var a={};function l(I){return-128<=I&&I<128?i(I,function(A){return new o([A|0],A<0?-1:0)}):new o([I|0],I<0?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return h;if(I<0)return E(c(-I));const A=[];let R=1;for(let k=0;I>=R;k++)A[k]=I/R|0,R*=4294967296;return new o(A,0)}function u(I,A){if(I.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(I.charAt(0)=="-")return E(u(I.substring(1),A));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=c(Math.pow(A,8));let k=h;for(let L=0;L<I.length;L+=8){var C=Math.min(8,I.length-L);const O=parseInt(I.substring(L,L+C),A);C<8?(C=c(Math.pow(A,C)),k=k.j(C).add(c(O))):(k=k.j(R),k=k.add(c(O)))}return k}var h=l(0),m=l(1),p=l(16777216);t=o.prototype,t.m=function(){if(g(this))return-E(this).m();let I=0,A=1;for(let R=0;R<this.g.length;R++){const k=this.i(R);I+=(k>=0?k:4294967296+k)*A,A*=4294967296}return I},t.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(v(this))return"0";if(g(this))return"-"+E(this).toString(I);const A=c(Math.pow(I,6));var R=this;let k="";for(;;){const C=P(R,A).g;R=b(R,C.j(A));let L=((R.g.length>0?R.g[0]:R.h)>>>0).toString(I);if(R=C,v(R))return L+k;for(;L.length<6;)L="0"+L;k=L+k}},t.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function v(I){if(I.h!=0)return!1;for(let A=0;A<I.g.length;A++)if(I.g[A]!=0)return!1;return!0}function g(I){return I.h==-1}t.l=function(I){return I=b(this,I),g(I)?-1:v(I)?0:1};function E(I){const A=I.g.length,R=[];for(let k=0;k<A;k++)R[k]=~I.g[k];return new o(R,~I.h).add(m)}t.abs=function(){return g(this)?E(this):this},t.add=function(I){const A=Math.max(this.g.length,I.g.length),R=[];let k=0;for(let C=0;C<=A;C++){let L=k+(this.i(C)&65535)+(I.i(C)&65535),O=(L>>>16)+(this.i(C)>>>16)+(I.i(C)>>>16);k=O>>>16,L&=65535,O&=65535,R[C]=O<<16|L}return new o(R,R[R.length-1]&-2147483648?-1:0)};function b(I,A){return I.add(E(A))}t.j=function(I){if(v(this)||v(I))return h;if(g(this))return g(I)?E(this).j(E(I)):E(E(this).j(I));if(g(I))return E(this.j(E(I)));if(this.l(p)<0&&I.l(p)<0)return c(this.m()*I.m());const A=this.g.length+I.g.length,R=[];for(var k=0;k<2*A;k++)R[k]=0;for(k=0;k<this.g.length;k++)for(let C=0;C<I.g.length;C++){const L=this.i(k)>>>16,O=this.i(k)&65535,X=I.i(C)>>>16,Ne=I.i(C)&65535;R[2*k+2*C]+=O*Ne,_(R,2*k+2*C),R[2*k+2*C+1]+=L*Ne,_(R,2*k+2*C+1),R[2*k+2*C+1]+=O*X,_(R,2*k+2*C+1),R[2*k+2*C+2]+=L*X,_(R,2*k+2*C+2)}for(I=0;I<A;I++)R[I]=R[2*I+1]<<16|R[2*I];for(I=A;I<2*A;I++)R[I]=0;return new o(R,0)};function _(I,A){for(;(I[A]&65535)!=I[A];)I[A+1]+=I[A]>>>16,I[A]&=65535,A++}function S(I,A){this.g=I,this.h=A}function P(I,A){if(v(A))throw Error("division by zero");if(v(I))return new S(h,h);if(g(I))return A=P(E(I),A),new S(E(A.g),E(A.h));if(g(A))return A=P(I,E(A)),new S(E(A.g),A.h);if(I.g.length>30){if(g(I)||g(A))throw Error("slowDivide_ only works with positive integers.");for(var R=m,k=A;k.l(I)<=0;)R=T(R),k=T(k);var C=N(R,1),L=N(k,1);for(k=N(k,2),R=N(R,2);!v(k);){var O=L.add(k);O.l(I)<=0&&(C=C.add(R),L=O),k=N(k,1),R=N(R,1)}return A=b(I,C.j(A)),new S(C,A)}for(C=h;I.l(A)>=0;){for(R=Math.max(1,Math.floor(I.m()/A.m())),k=Math.ceil(Math.log(R)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),L=c(R),O=L.j(A);g(O)||O.l(I)>0;)R-=k,L=c(R),O=L.j(A);v(L)&&(L=m),C=C.add(L),I=b(I,O)}return new S(C,I)}t.B=function(I){return P(this,I).h},t.and=function(I){const A=Math.max(this.g.length,I.g.length),R=[];for(let k=0;k<A;k++)R[k]=this.i(k)&I.i(k);return new o(R,this.h&I.h)},t.or=function(I){const A=Math.max(this.g.length,I.g.length),R=[];for(let k=0;k<A;k++)R[k]=this.i(k)|I.i(k);return new o(R,this.h|I.h)},t.xor=function(I){const A=Math.max(this.g.length,I.g.length),R=[];for(let k=0;k<A;k++)R[k]=this.i(k)^I.i(k);return new o(R,this.h^I.h)};function T(I){const A=I.g.length+1,R=[];for(let k=0;k<A;k++)R[k]=I.i(k)<<1|I.i(k-1)>>>31;return new o(R,I.h)}function N(I,A){const R=A>>5;A%=32;const k=I.g.length-R,C=[];for(let L=0;L<k;L++)C[L]=A>0?I.i(L+R)>>>A|I.i(L+R+1)<<32-A:I.i(L+R);return new o(C,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,M2=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,Ua=o}).apply(typeof PA<"u"?PA:typeof self<"u"?self:typeof window<"u"?window:{});var Zm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var V2,Sh,j2,Fp,R0,F2,U2,$2;(function(){var t,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zm=="object"&&Zm];for(var w=0;w<d.length;++w){var x=d[w];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=n(this);function s(d,w){if(w)e:{var x=r;d=d.split(".");for(var D=0;D<d.length-1;D++){var $=d[D];if(!($ in x))break e;x=x[$]}d=d[d.length-1],D=x[d],w=w(D),w!=D&&w!=null&&e(x,d,{configurable:!0,writable:!0,value:w})}}s("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(d){return d||function(w){var x=[],D;for(D in w)Object.prototype.hasOwnProperty.call(w,D)&&x.push([D,w[D]]);return x}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(d){var w=typeof d;return w=="object"&&d!=null||w=="function"}function l(d,w,x){return d.call.apply(d.bind,arguments)}function c(d,w,x){return c=l,c.apply(null,arguments)}function u(d,w){var x=Array.prototype.slice.call(arguments,1);return function(){var D=x.slice();return D.push.apply(D,arguments),d.apply(this,D)}}function h(d,w){function x(){}x.prototype=w.prototype,d.Z=w.prototype,d.prototype=new x,d.prototype.constructor=d,d.Ob=function(D,$,G){for(var Se=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)Se[Nt-2]=arguments[Nt];return w.prototype[$].apply(D,Se)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function p(d){const w=d.length;if(w>0){const x=Array(w);for(let D=0;D<w;D++)x[D]=d[D];return x}return[]}function v(d,w){for(let D=1;D<arguments.length;D++){const $=arguments[D];var x=typeof $;if(x=x!="object"?x:$?Array.isArray($)?"array":x:"null",x=="array"||x=="object"&&typeof $.length=="number"){x=d.length||0;const G=$.length||0;d.length=x+G;for(let Se=0;Se<G;Se++)d[x+Se]=$[Se]}else d.push($)}}class g{constructor(w,x){this.i=w,this.j=x,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function E(d){o.setTimeout(()=>{throw d},0)}function b(){var d=I;let w=null;return d.g&&(w=d.g,d.g=d.g.next,d.g||(d.h=null),w.next=null),w}class _{constructor(){this.h=this.g=null}add(w,x){const D=S.get();D.set(w,x),this.h?this.h.next=D:this.g=D,this.h=D}}var S=new g(()=>new P,d=>d.reset());class P{constructor(){this.next=this.g=this.h=null}set(w,x){this.h=w,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let T,N=!1,I=new _,A=()=>{const d=Promise.resolve(void 0);T=()=>{d.then(R)}};function R(){for(var d;d=b();){try{d.h.call(d.g)}catch(x){E(x)}var w=S;w.j(d),w.h<100&&(w.h++,d.next=w.g,w.g=d)}N=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(d,w){this.type=d,this.g=this.target=w,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,w=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};o.addEventListener("test",x,w),o.removeEventListener("test",x,w)}catch{}return d}();function O(d){return/^[\s\xa0]*$/.test(d)}function X(d,w){C.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,w)}h(X,C),X.prototype.init=function(d,w){const x=this.type=d.type,D=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=w,w=d.relatedTarget,w||(x=="mouseover"?w=d.fromElement:x=="mouseout"&&(w=d.toElement)),this.relatedTarget=w,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&X.Z.h.call(this)},X.prototype.h=function(){X.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Ne="closure_listenable_"+(Math.random()*1e6|0),Le=0;function Fe(d,w,x,D,$){this.listener=d,this.proxy=null,this.src=w,this.type=x,this.capture=!!D,this.ha=$,this.key=++Le,this.da=this.fa=!1}function W(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Y(d,w,x){for(const D in d)w.call(x,d[D],D,d)}function le(d,w){for(const x in d)w.call(void 0,d[x],x,d)}function pe(d){const w={};for(const x in d)w[x]=d[x];return w}const fe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ge(d,w){let x,D;for(let $=1;$<arguments.length;$++){D=arguments[$];for(x in D)d[x]=D[x];for(let G=0;G<fe.length;G++)x=fe[G],Object.prototype.hasOwnProperty.call(D,x)&&(d[x]=D[x])}}function Ie(d){this.src=d,this.g={},this.h=0}Ie.prototype.add=function(d,w,x,D,$){const G=d.toString();d=this.g[G],d||(d=this.g[G]=[],this.h++);const Se=J(d,w,D,$);return Se>-1?(w=d[Se],x||(w.fa=!1)):(w=new Fe(w,this.src,G,!!D,$),w.fa=x,d.push(w)),w};function ve(d,w){const x=w.type;if(x in d.g){var D=d.g[x],$=Array.prototype.indexOf.call(D,w,void 0),G;(G=$>=0)&&Array.prototype.splice.call(D,$,1),G&&(W(w),d.g[x].length==0&&(delete d.g[x],d.h--))}}function J(d,w,x,D){for(let $=0;$<d.length;++$){const G=d[$];if(!G.da&&G.listener==w&&G.capture==!!x&&G.ha==D)return $}return-1}var qe="closure_lm_"+(Math.random()*1e6|0),dn={};function dr(d,w,x,D,$){if(Array.isArray(w)){for(let G=0;G<w.length;G++)dr(d,w[G],x,D,$);return null}return x=nt(x),d&&d[Ne]?d.J(w,x,a(D)?!!D.capture:!1,$):Xn(d,w,x,!1,D,$)}function Xn(d,w,x,D,$,G){if(!w)throw Error("Invalid event type");const Se=a($)?!!$.capture:!!$;let Nt=de(d);if(Nt||(d[qe]=Nt=new Ie(d)),x=Nt.add(w,x,D,Se,G),x.proxy)return x;if(D=sr(),x.proxy=D,D.src=d,D.listener=x,d.addEventListener)L||($=Se),$===void 0&&($=!1),d.addEventListener(w.toString(),D,$);else if(d.attachEvent)d.attachEvent(Lr(w.toString()),D);else if(d.addListener&&d.removeListener)d.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return x}function sr(){function d(x){return w.call(d.src,d.listener,x)}const w=Q;return d}function Dr(d,w,x,D,$){if(Array.isArray(w))for(var G=0;G<w.length;G++)Dr(d,w[G],x,D,$);else D=a(D)?!!D.capture:!!D,x=nt(x),d&&d[Ne]?(d=d.i,G=String(w).toString(),G in d.g&&(w=d.g[G],x=J(w,x,D,$),x>-1&&(W(w[x]),Array.prototype.splice.call(w,x,1),w.length==0&&(delete d.g[G],d.h--)))):d&&(d=de(d))&&(w=d.g[w.toString()],d=-1,w&&(d=J(w,x,D,$)),(x=d>-1?w[d]:null)&&Or(x))}function Or(d){if(typeof d!="number"&&d&&!d.da){var w=d.src;if(w&&w[Ne])ve(w.i,d);else{var x=d.type,D=d.proxy;w.removeEventListener?w.removeEventListener(x,D,d.capture):w.detachEvent?w.detachEvent(Lr(x),D):w.addListener&&w.removeListener&&w.removeListener(D),(x=de(w))?(ve(x,d),x.h==0&&(x.src=null,w[qe]=null)):W(d)}}}function Lr(d){return d in dn?dn[d]:dn[d]="on"+d}function Q(d,w){if(d.da)d=!0;else{w=new X(w,this);const x=d.listener,D=d.ha||d.src;d.fa&&Or(d),d=x.call(D,w)}return d}function de(d){return d=d[qe],d instanceof Ie?d:null}var _e="__closure_events_fn_"+(Math.random()*1e9>>>0);function nt(d){return typeof d=="function"?d:(d[_e]||(d[_e]=function(w){return d.handleEvent(w)}),d[_e])}function he(){k.call(this),this.i=new Ie(this),this.M=this,this.G=null}h(he,k),he.prototype[Ne]=!0,he.prototype.removeEventListener=function(d,w,x,D){Dr(this,d,w,x,D)};function Ce(d,w){var x,D=d.G;if(D)for(x=[];D;D=D.G)x.push(D);if(d=d.M,D=w.type||w,typeof w=="string")w=new C(w,d);else if(w instanceof C)w.target=w.target||d;else{var $=w;w=new C(D,d),Ge(w,$)}$=!0;let G,Se;if(x)for(Se=x.length-1;Se>=0;Se--)G=w.g=x[Se],$=Ue(G,D,!0,w)&&$;if(G=w.g=d,$=Ue(G,D,!0,w)&&$,$=Ue(G,D,!1,w)&&$,x)for(Se=0;Se<x.length;Se++)G=w.g=x[Se],$=Ue(G,D,!1,w)&&$}he.prototype.N=function(){if(he.Z.N.call(this),this.i){var d=this.i;for(const w in d.g){const x=d.g[w];for(let D=0;D<x.length;D++)W(x[D]);delete d.g[w],d.h--}}this.G=null},he.prototype.J=function(d,w,x,D){return this.i.add(String(d),w,!1,x,D)},he.prototype.K=function(d,w,x,D){return this.i.add(String(d),w,!0,x,D)};function Ue(d,w,x,D){if(w=d.i.g[String(w)],!w)return!0;w=w.concat();let $=!0;for(let G=0;G<w.length;++G){const Se=w[G];if(Se&&!Se.da&&Se.capture==x){const Nt=Se.listener,gr=Se.ha||Se.src;Se.fa&&ve(d.i,Se),$=Nt.call(gr,D)!==!1&&$}}return $&&!D.defaultPrevented}function rt(d,w){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=c(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:o.setTimeout(d,w||0)}function lt(d){d.g=rt(()=>{d.g=null,d.i&&(d.i=!1,lt(d))},d.l);const w=d.h;d.h=null,d.m.apply(null,w)}class Lt extends k{constructor(w,x){super(),this.m=w,this.l=x,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:lt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ct(d){k.call(this),this.h=d,this.g={}}h(Ct,k);var q=[];function ge(d){Y(d.g,function(w,x){this.g.hasOwnProperty(x)&&Or(w)},d),d.g={}}Ct.prototype.N=function(){Ct.Z.N.call(this),ge(this)},Ct.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ke=o.JSON.stringify,Re=o.JSON.parse,ue=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function ae(){}function Tt(){}var _t={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Mt(){C.call(this,"d")}h(Mt,C);function Zn(){C.call(this,"c")}h(Zn,C);var M={},z=null;function j(){return z=z||new he}M.Ia="serverreachability";function Z(d){C.call(this,M.Ia,d)}h(Z,C);function K(d){const w=j();Ce(w,new Z(w))}M.STAT_EVENT="statevent";function oe(d,w){C.call(this,M.STAT_EVENT,d),this.stat=w}h(oe,C);function H(d){const w=j();Ce(w,new oe(w,d))}M.Ja="timingevent";function Ae(d,w){C.call(this,M.Ja,d),this.size=w}h(Ae,C);function st(d,w){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},w)}function te(){this.g=!0}te.prototype.ua=function(){this.g=!1};function ne(d,w,x,D,$,G){d.info(function(){if(d.g)if(G){var Se="",Nt=G.split("&");for(let bn=0;bn<Nt.length;bn++){var gr=Nt[bn].split("=");if(gr.length>1){const Tr=gr[0];gr=gr[1];const Ri=Tr.split("_");Se=Ri.length>=2&&Ri[1]=="type"?Se+(Tr+"="+gr+"&"):Se+(Tr+"=redacted&")}}}else Se=null;else Se=G;return"XMLHTTP REQ ("+D+") [attempt "+$+"]: "+w+`
`+x+`
`+Se})}function be(d,w,x,D,$,G,Se){d.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+$+"]: "+w+`
`+x+`
`+G+" "+Se})}function ze(d,w,x,D){d.info(function(){return"XMLHTTP TEXT ("+w+"): "+ft(d,x)+(D?" "+D:"")})}function Qe(d,w){d.info(function(){return"TIMEOUT: "+w})}te.prototype.info=function(){};function ft(d,w){if(!d.g)return w;if(!w)return null;try{const G=JSON.parse(w);if(G){for(d=0;d<G.length;d++)if(Array.isArray(G[d])){var x=G[d];if(!(x.length<2)){var D=x[1];if(Array.isArray(D)&&!(D.length<1)){var $=D[0];if($!="noop"&&$!="stop"&&$!="close")for(let Se=1;Se<D.length;Se++)D[Se]=""}}}}return ke(G)}catch{return w}}var ut={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Pe={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},it;function Bt(){}h(Bt,ae),Bt.prototype.g=function(){return new XMLHttpRequest},it=new Bt;function St(d){return encodeURIComponent(String(d))}function ct(d){var w=1;d=d.split(":");const x=[];for(;w>0&&d.length;)x.push(d.shift()),w--;return d.length&&x.push(d.join(":")),x}function Pt(d,w,x,D){this.j=d,this.i=w,this.l=x,this.S=D||1,this.V=new Ct(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ve}function Ve(){this.i=null,this.g="",this.h=!1}var cn={},Vt={};function Pn(d,w,x){d.M=1,d.A=as(Xt(w)),d.u=x,d.R=!0,dt(d,null)}function dt(d,w){d.F=Date.now(),xt(d),d.B=Xt(d.A);var x=d.B,D=d.S;Array.isArray(D)||(D=[String(D)]),Wn(x.i,"t",D),d.C=0,x=d.j.L,d.h=new Ve,d.g=VI(d.j,x?w:null,!d.u),d.P>0&&(d.O=new Lt(c(d.Y,d,d.g),d.P)),w=d.V,x=d.g,D=d.ba;var $="readystatechange";Array.isArray($)||($&&(q[0]=$.toString()),$=q);for(let G=0;G<$.length;G++){const Se=dr(x,$[G],D||w.handleEvent,!1,w.h||w);if(!Se)break;w.g[Se.key]=Se}w=d.J?pe(d.J):{},d.u?(d.v||(d.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,w)):(d.v="GET",d.g.ea(d.B,d.v,null,w)),K(),ne(d.i,d.v,d.B,d.l,d.S,d.u)}Pt.prototype.ba=function(d){d=d.target;const w=this.O;w&&Wo(d)==3?w.j():this.Y(d)},Pt.prototype.Y=function(d){try{if(d==this.g)e:{const Nt=Wo(this.g),gr=this.g.ya(),bn=this.g.ca();if(!(Nt<3)&&(Nt!=3||this.g&&(this.h.h||this.g.la()||xI(this.g)))){this.K||Nt!=4||gr==7||(gr==8||bn<=0?K(3):K(2)),ln(this);var w=this.g.ca();this.X=w;var x=Yt(this);if(this.o=w==200,be(this.i,this.v,this.B,this.l,this.S,Nt,w),this.o){if(this.U&&!this.L){t:{if(this.g){var D,$=this.g;if((D=$.g?$.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(D)){var G=D;break t}}G=null}if(d=G)ze(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,De(this,d);else{this.o=!1,this.m=3,H(12),at(this),He(this);break e}}if(this.R){d=!0;let Tr;for(;!this.K&&this.C<x.length;)if(Tr=an(this,x),Tr==Vt){Nt==4&&(this.m=4,H(14),d=!1),ze(this.i,this.l,null,"[Incomplete Response]");break}else if(Tr==cn){this.m=4,H(15),ze(this.i,this.l,x,"[Invalid Chunk]"),d=!1;break}else ze(this.i,this.l,Tr,null),De(this,Tr);if(on(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Nt!=4||x.length!=0||this.h.h||(this.m=1,H(16),d=!1),this.o=this.o&&d,!d)ze(this.i,this.l,x,"[Invalid Chunked Response]"),at(this),He(this);else if(x.length>0&&!this.W){this.W=!0;var Se=this.j;Se.g==this&&Se.aa&&!Se.P&&(Se.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),Wv(Se),Se.P=!0,H(11))}}else ze(this.i,this.l,x,null),De(this,x);Nt==4&&at(this),this.o&&!this.K&&(Nt==4?DI(this.j,this):(this.o=!1,xt(this)))}else Vj(this.g),w==400&&x.indexOf("Unknown SID")>0?(this.m=3,H(12)):(this.m=0,H(13)),at(this),He(this)}}}catch{}finally{}};function Yt(d){if(!on(d))return d.g.la();const w=xI(d.g);if(w==="")return"";let x="";const D=w.length,$=Wo(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return at(d),He(d),"";d.h.i=new o.TextDecoder}for(let G=0;G<D;G++)d.h.h=!0,x+=d.h.i.decode(w[G],{stream:!($&&G==D-1)});return w.length=0,d.h.g+=x,d.C=0,d.h.g}function on(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function an(d,w){var x=d.C,D=w.indexOf(`
`,x);return D==-1?Vt:(x=Number(w.substring(x,D)),isNaN(x)?cn:(D+=1,D+x>w.length?Vt:(w=w.slice(D,D+x),d.C=D+x,w)))}Pt.prototype.cancel=function(){this.K=!0,at(this)};function xt(d){d.T=Date.now()+d.H,gt(d,d.H)}function gt(d,w){if(d.D!=null)throw Error("WatchDog timer not null");d.D=st(c(d.aa,d),w)}function ln(d){d.D&&(o.clearTimeout(d.D),d.D=null)}Pt.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(Qe(this.i,this.B),this.M!=2&&(K(),H(17)),at(this),this.m=2,He(this)):gt(this,this.T-d)};function He(d){d.j.I==0||d.K||DI(d.j,d)}function at(d){ln(d);var w=d.O;w&&typeof w.dispose=="function"&&w.dispose(),d.O=null,ge(d.V),d.g&&(w=d.g,d.g=null,w.abort(),w.dispose())}function De(d,w){try{var x=d.j;if(x.I!=0&&(x.g==d||vt(x.h,d))){if(!d.L&&vt(x.h,d)&&x.I==3){try{var D=x.Ba.g.parse(w)}catch{D=null}if(Array.isArray(D)&&D.length==3){var $=D;if($[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<d.F)Tm(x),Sm(x);else break e;zv(x),H(18)}}else x.xa=$[1],0<x.xa-x.K&&$[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=st(c(x.Va,x),6e3));Xe(x.h)<=1&&x.ta&&(x.ta=void 0)}else _l(x,11)}else if((d.L||x.g==d)&&Tm(x),!O(w))for($=x.Ba.g.parse(w),w=0;w<$.length;w++){let bn=$[w];const Tr=bn[0];if(!(Tr<=x.K))if(x.K=Tr,bn=bn[1],x.I==2)if(bn[0]=="c"){x.M=bn[1],x.ba=bn[2];const Ri=bn[3];Ri!=null&&(x.ka=Ri,x.j.info("VER="+x.ka));const bl=bn[4];bl!=null&&(x.za=bl,x.j.info("SVER="+x.za));const qo=bn[5];qo!=null&&typeof qo=="number"&&qo>0&&(D=1.5*qo,x.O=D,x.j.info("backChannelRequestTimeoutMs_="+D)),D=x;const Ho=d.g;if(Ho){const Am=Ho.g?Ho.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Am){var G=D.h;G.g||Am.indexOf("spdy")==-1&&Am.indexOf("quic")==-1&&Am.indexOf("h2")==-1||(G.j=G.l,G.g=new Set,G.h&&(zt(G,G.h),G.h=null))}if(D.G){const qv=Ho.g?Ho.g.getResponseHeader("X-HTTP-Session-Id"):null;qv&&(D.wa=qv,yt(D.J,D.G,qv))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-d.F,x.j.info("Handshake RTT: "+x.T+"ms")),D=x;var Se=d;if(D.na=MI(D,D.L?D.ba:null,D.W),Se.L){un(D.h,Se);var Nt=Se,gr=D.O;gr&&(Nt.H=gr),Nt.D&&(ln(Nt),xt(Nt)),D.g=Se}else NI(D);x.i.length>0&&Im(x)}else bn[0]!="stop"&&bn[0]!="close"||_l(x,7);else x.I==3&&(bn[0]=="stop"||bn[0]=="close"?bn[0]=="stop"?_l(x,7):Bv(x):bn[0]!="noop"&&x.l&&x.l.qa(bn),x.A=0)}}K(4)}catch{}}var tt=class{constructor(d,w){this.g=d,this.map=w}};function $e(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function se(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Xe(d){return d.h?1:d.g?d.g.size:0}function vt(d,w){return d.h?d.h==w:d.g?d.g.has(w):!1}function zt(d,w){d.g?d.g.add(w):d.h=w}function un(d,w){d.h&&d.h==w?d.h=null:d.g&&d.g.has(w)&&d.g.delete(w)}$e.prototype.cancel=function(){if(this.i=Jt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Jt(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let w=d.i;for(const x of d.g.values())w=w.concat(x.G);return w}return p(d.i)}var Ke=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function In(d,w){if(d){d=d.split("&");for(let x=0;x<d.length;x++){const D=d[x].indexOf("=");let $,G=null;D>=0?($=d[x].substring(0,D),G=d[x].substring(D+1)):$=d[x],w($,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}function jt(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;d instanceof jt?(this.l=d.l,ir(this,d.j),this.o=d.o,this.g=d.g,Ze(this,d.u),this.h=d.h,Kt(this,Ir(d.i)),this.m=d.m):d&&(w=String(d).match(Ke))?(this.l=!1,ir(this,w[1]||"",!0),this.o=ti(w[2]||""),this.g=ti(w[3]||"",!0),Ze(this,w[4]),this.h=ti(w[5]||"",!0),Kt(this,w[6]||"",!0),this.m=ti(w[7]||"")):(this.l=!1,this.i=new Zt(null,this.l))}jt.prototype.toString=function(){const d=[];var w=this.j;w&&d.push(er(w,ls,!0),":");var x=this.g;return(x||w=="file")&&(d.push("//"),(w=this.o)&&d.push(er(w,ls,!0),"@"),d.push(St(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&d.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(er(x,x.charAt(0)=="/"?bt:Rn,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",er(x,nn)),d.join("")},jt.prototype.resolve=function(d){const w=Xt(this);let x=!!d.j;x?ir(w,d.j):x=!!d.o,x?w.o=d.o:x=!!d.g,x?w.g=d.g:x=d.u!=null;var D=d.h;if(x)Ze(w,d.u);else if(x=!!d.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var $=w.h.lastIndexOf("/");$!=-1&&(D=w.h.slice(0,$+1)+D)}if($=D,$==".."||$==".")D="";else if($.indexOf("./")!=-1||$.indexOf("/.")!=-1){D=$.lastIndexOf("/",0)==0,$=$.split("/");const G=[];for(let Se=0;Se<$.length;){const Nt=$[Se++];Nt=="."?D&&Se==$.length&&G.push(""):Nt==".."?((G.length>1||G.length==1&&G[0]!="")&&G.pop(),D&&Se==$.length&&G.push("")):(G.push(Nt),D=!0)}D=G.join("/")}else D=$}return x?w.h=D:x=d.i.toString()!=="",x?Kt(w,Ir(d.i)):x=!!d.m,x&&(w.m=d.m),w};function Xt(d){return new jt(d)}function ir(d,w,x){d.j=x?ti(w,!0):w,d.j&&(d.j=d.j.replace(/:$/,""))}function Ze(d,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);d.u=w}else d.u=null}function Kt(d,w,x){w instanceof Zt?(d.i=w,vn(d.i,d.l)):(x||(w=er(w,$s)),d.i=new Zt(w,d.l))}function yt(d,w,x){d.i.set(w,x)}function as(d){return yt(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function ti(d,w){return d?w?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function er(d,w,x){return typeof d=="string"?(d=encodeURI(d).replace(w,Is),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Is(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var ls=/[#\/\?@]/g,Rn=/[#\?:]/g,bt=/[#\?]/g,$s=/[#\?@]/g,nn=/#/g;function Zt(d,w){this.h=this.g=null,this.i=d||null,this.j=!!w}function ht(d){d.g||(d.g=new Map,d.h=0,d.i&&In(d.i,function(w,x){d.add(decodeURIComponent(w.replace(/\+/g," ")),x)}))}t=Zt.prototype,t.add=function(d,w){ht(this),this.i=null,d=Vn(this,d);let x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(w),this.h+=1,this};function Sr(d,w){ht(d),w=Vn(d,w),d.g.has(w)&&(d.i=null,d.h-=d.g.get(w).length,d.g.delete(w))}function Bn(d,w){return ht(d),w=Vn(d,w),d.g.has(w)}t.forEach=function(d,w){ht(this),this.g.forEach(function(x,D){x.forEach(function($){d.call(w,$,D,this)},this)},this)};function zn(d,w){ht(d);let x=[];if(typeof w=="string")Bn(d,w)&&(x=x.concat(d.g.get(Vn(d,w))));else for(d=Array.from(d.g.values()),w=0;w<d.length;w++)x=x.concat(d[w]);return x}t.set=function(d,w){return ht(this),this.i=null,d=Vn(this,d),Bn(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[w]),this.h+=1,this},t.get=function(d,w){return d?(d=zn(this,d),d.length>0?String(d[0]):w):w};function Wn(d,w,x){Sr(d,w),x.length>0&&(d.i=null,d.g.set(Vn(d,w),p(x)),d.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],w=Array.from(this.g.keys());for(let D=0;D<w.length;D++){var x=w[D];const $=St(x);x=zn(this,x);for(let G=0;G<x.length;G++){let Se=$;x[G]!==""&&(Se+="="+St(x[G])),d.push(Se)}}return this.i=d.join("&")};function Ir(d){const w=new Zt;return w.i=d.i,d.g&&(w.g=new Map(d.g),w.h=d.h),w}function Vn(d,w){return w=String(w),d.j&&(w=w.toLowerCase()),w}function vn(d,w){w&&!d.j&&(ht(d),d.i=null,d.g.forEach(function(x,D){const $=D.toLowerCase();D!=$&&(Sr(this,D),Wn(this,$,x))},d)),d.j=w}function hn(d,w){const x=new te;if(o.Image){const D=new Image;D.onload=u(Bs,x,"TestLoadImage: loaded",!0,w,D),D.onerror=u(Bs,x,"TestLoadImage: error",!1,w,D),D.onabort=u(Bs,x,"TestLoadImage: abort",!1,w,D),D.ontimeout=u(Bs,x,"TestLoadImage: timeout",!1,w,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=d}else w(!1)}function Br(d,w){const x=new te,D=new AbortController,$=setTimeout(()=>{D.abort(),Bs(x,"TestPingServer: timeout",!1,w)},1e4);fetch(d,{signal:D.signal}).then(G=>{clearTimeout($),G.ok?Bs(x,"TestPingServer: ok",!0,w):Bs(x,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout($),Bs(x,"TestPingServer: error",!1,w)})}function Bs(d,w,x,D,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),D(x)}catch{}}function Kd(){this.g=new ue}function wl(d){this.i=d.Sb||null,this.h=d.ab||!1}h(wl,ae),wl.prototype.g=function(){return new zo(this.i,this.h)};function zo(d,w){he.call(this),this.H=d,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(zo,he),t=zo.prototype,t.open=function(d,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=w,this.readyState=1,Qd(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(w.body=d),(this.H||o).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Gd(this)),this.readyState=0},t.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Qd(this)),this.g&&(this.readyState=3,Qd(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;bm(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function bm(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}t.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var w=d.value?d.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!d.done}))&&(this.response=this.responseText+=w)}d.done?Gd(this):Qd(this),this.readyState==3&&bm(this)}},t.Oa=function(d){this.g&&(this.response=this.responseText=d,Gd(this))},t.Na=function(d){this.g&&(this.response=d,Gd(this))},t.ga=function(){this.g&&Gd(this)};function Gd(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Qd(d)}t.setRequestHeader=function(d,w){this.A.append(d,w)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],w=this.h.entries();for(var x=w.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=w.next();return d.join(`\r
`)};function Qd(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(zo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function EI(d){let w="";return Y(d,function(x,D){w+=D,w+=":",w+=x,w+=`\r
`}),w}function $v(d,w,x){e:{for(D in x){var D=!1;break e}D=!0}D||(x=EI(x),typeof d=="string"?x!=null&&St(x):yt(d,w,x))}function tr(d){he.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(tr,he);var Lj=/^https?$/i,Mj=["POST","PUT"];t=tr.prototype,t.Fa=function(d){this.H=d},t.ea=function(d,w,x,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);w=w?w.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():it.g(),this.g.onreadystatechange=m(c(this.Ca,this));try{this.B=!0,this.g.open(w,String(d),!0),this.B=!1}catch(G){SI(this,G);return}if(d=x||"",x=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var $ in D)x.set($,D[$]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const G of D.keys())x.set(G,D.get(G));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(x.keys()).find(G=>G.toLowerCase()=="content-type"),$=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(Mj,w,void 0)>=0)||D||$||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[G,Se]of x)this.g.setRequestHeader(G,Se);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(G){SI(this,G)}};function SI(d,w){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=w,d.o=5,II(d),Em(d)}function II(d){d.A||(d.A=!0,Ce(d,"complete"),Ce(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Ce(this,"complete"),Ce(this,"abort"),Em(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Em(this,!0)),tr.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?TI(this):this.Xa())},t.Xa=function(){TI(this)};function TI(d){if(d.h&&typeof i<"u"){if(d.v&&Wo(d)==4)setTimeout(d.Ca.bind(d),0);else if(Ce(d,"readystatechange"),Wo(d)==4){d.h=!1;try{const G=d.ca();e:switch(G){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var x;if(!(x=w)){var D;if(D=G===0){let Se=String(d.D).match(Ke)[1]||null;!Se&&o.self&&o.self.location&&(Se=o.self.location.protocol.slice(0,-1)),D=!Lj.test(Se?Se.toLowerCase():"")}x=D}if(x)Ce(d,"complete"),Ce(d,"success");else{d.o=6;try{var $=Wo(d)>2?d.g.statusText:""}catch{$=""}d.l=$+" ["+d.ca()+"]",II(d)}}finally{Em(d)}}}}function Em(d,w){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const x=d.g;d.g=null,w||Ce(d,"ready");try{x.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Wo(d){return d.g?d.g.readyState:0}t.ca=function(){try{return Wo(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(d){if(this.g){var w=this.g.responseText;return d&&w.indexOf(d)==0&&(w=w.substring(d.length)),Re(w)}};function xI(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Vj(d){const w={};d=(d.g&&Wo(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<d.length;D++){if(O(d[D]))continue;var x=ct(d[D]);const $=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const G=w[$]||[];w[$]=G,G.push(x)}le(w,function(D){return D.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yd(d,w,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||w}function AI(d){this.za=0,this.i=[],this.j=new te,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Yd("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Yd("baseRetryDelayMs",5e3,d),this.Za=Yd("retryDelaySeedMs",1e4,d),this.Ta=Yd("forwardChannelMaxRetries",2,d),this.va=Yd("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new $e(d&&d.concurrentRequestLimit),this.Ba=new Kd,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=AI.prototype,t.ka=8,t.I=1,t.connect=function(d,w,x,D){H(0),this.W=d,this.H=w||{},x&&D!==void 0&&(this.H.OSID=x,this.H.OAID=D),this.F=this.X,this.J=MI(this,null,this.W),Im(this)};function Bv(d){if(PI(d),d.I==3){var w=d.V++,x=Xt(d.J);if(yt(x,"SID",d.M),yt(x,"RID",w),yt(x,"TYPE","terminate"),Jd(d,x),w=new Pt(d,d.j,w),w.M=2,w.A=as(Xt(x)),x=!1,o.navigator&&o.navigator.sendBeacon)try{x=o.navigator.sendBeacon(w.A.toString(),"")}catch{}!x&&o.Image&&(new Image().src=w.A,x=!0),x||(w.g=VI(w.j,null),w.g.ea(w.A)),w.F=Date.now(),xt(w)}LI(d)}function Sm(d){d.g&&(Wv(d),d.g.cancel(),d.g=null)}function PI(d){Sm(d),d.v&&(o.clearTimeout(d.v),d.v=null),Tm(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function Im(d){if(!se(d.h)&&!d.m){d.m=!0;var w=d.Ea;T||A(),N||(T(),N=!0),I.add(w,d),d.D=0}}function jj(d,w){return Xe(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=w.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=st(c(d.Ea,d,w),OI(d,d.D)),d.D++,!0)}t.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const $=new Pt(this,this.j,d);let G=this.o;if(this.U&&(G?(G=pe(G),Ge(G,this.U)):G=this.U),this.u!==null||this.R||($.J=G,G=null),this.S)e:{for(var w=0,x=0;x<this.i.length;x++){t:{var D=this.i[x];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(w+=D,w>4096){w=x;break e}if(w===4096||x===this.i.length-1){w=x+1;break e}}w=1e3}else w=1e3;w=CI(this,$,w),x=Xt(this.J),yt(x,"RID",d),yt(x,"CVER",22),this.G&&yt(x,"X-HTTP-Session-Id",this.G),Jd(this,x),G&&(this.R?w="headers="+St(EI(G))+"&"+w:this.u&&$v(x,this.u,G)),zt(this.h,$),this.Ra&&yt(x,"TYPE","init"),this.S?(yt(x,"$req",w),yt(x,"SID","null"),$.U=!0,Pn($,x,null)):Pn($,x,w),this.I=2}}else this.I==3&&(d?RI(this,d):this.i.length==0||se(this.h)||RI(this))};function RI(d,w){var x;w?x=w.l:x=d.V++;const D=Xt(d.J);yt(D,"SID",d.M),yt(D,"RID",x),yt(D,"AID",d.K),Jd(d,D),d.u&&d.o&&$v(D,d.u,d.o),x=new Pt(d,d.j,x,d.D+1),d.u===null&&(x.J=d.o),w&&(d.i=w.G.concat(d.i)),w=CI(d,x,1e3),x.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),zt(d.h,x),Pn(x,D,w)}function Jd(d,w){d.H&&Y(d.H,function(x,D){yt(w,D,x)}),d.l&&Y({},function(x,D){yt(w,D,x)})}function CI(d,w,x){x=Math.min(d.i.length,x);const D=d.l?c(d.l.Ka,d.l,d):null;e:{var $=d.i;let Nt=-1;for(;;){const gr=["count="+x];Nt==-1?x>0?(Nt=$[0].g,gr.push("ofs="+Nt)):Nt=0:gr.push("ofs="+Nt);let bn=!0;for(let Tr=0;Tr<x;Tr++){var G=$[Tr].g;const Ri=$[Tr].map;if(G-=Nt,G<0)Nt=Math.max(0,$[Tr].g-100),bn=!1;else try{G="req"+G+"_"||"";try{var Se=Ri instanceof Map?Ri:Object.entries(Ri);for(const[bl,qo]of Se){let Ho=qo;a(qo)&&(Ho=ke(qo)),gr.push(G+bl+"="+encodeURIComponent(Ho))}}catch(bl){throw gr.push(G+"type="+encodeURIComponent("_badmap")),bl}}catch{D&&D(Ri)}}if(bn){Se=gr.join("&");break e}}Se=void 0}return d=d.i.splice(0,x),w.G=d,Se}function NI(d){if(!d.g&&!d.v){d.Y=1;var w=d.Da;T||A(),N||(T(),N=!0),I.add(w,d),d.A=0}}function zv(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=st(c(d.Da,d),OI(d,d.A)),d.A++,!0)}t.Da=function(){if(this.v=null,kI(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=st(c(this.Wa,this),d)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,H(10),Sm(this),kI(this))};function Wv(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function kI(d){d.g=new Pt(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var w=Xt(d.na);yt(w,"RID","rpc"),yt(w,"SID",d.M),yt(w,"AID",d.K),yt(w,"CI",d.F?"0":"1"),!d.F&&d.ia&&yt(w,"TO",d.ia),yt(w,"TYPE","xmlhttp"),Jd(d,w),d.u&&d.o&&$v(w,d.u,d.o),d.O&&(d.g.H=d.O);var x=d.g;d=d.ba,x.M=1,x.A=as(Xt(w)),x.u=null,x.R=!0,dt(x,d)}t.Va=function(){this.C!=null&&(this.C=null,Sm(this),zv(this),H(19))};function Tm(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function DI(d,w){var x=null;if(d.g==w){Tm(d),Wv(d),d.g=null;var D=2}else if(vt(d.h,w))x=w.G,un(d.h,w),D=1;else return;if(d.I!=0){if(w.o)if(D==1){x=w.u?w.u.length:0,w=Date.now()-w.F;var $=d.D;D=j(),Ce(D,new Ae(D,x)),Im(d)}else NI(d);else if($=w.m,$==3||$==0&&w.X>0||!(D==1&&jj(d,w)||D==2&&zv(d)))switch(x&&x.length>0&&(w=d.h,w.i=w.i.concat(x)),$){case 1:_l(d,5);break;case 4:_l(d,10);break;case 3:_l(d,6);break;default:_l(d,2)}}}function OI(d,w){let x=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(x*=2),x*w}function _l(d,w){if(d.j.info("Error code "+w),w==2){var x=c(d.bb,d),D=d.Ua;const $=!D;D=new jt(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ir(D,"https"),as(D),$?hn(D.toString(),x):Br(D.toString(),x)}else H(2);d.I=0,d.l&&d.l.pa(w),LI(d),PI(d)}t.bb=function(d){d?(this.j.info("Successfully pinged google.com"),H(2)):(this.j.info("Failed to ping google.com"),H(1))};function LI(d){if(d.I=0,d.ja=[],d.l){const w=Jt(d.h);(w.length!=0||d.i.length!=0)&&(v(d.ja,w),v(d.ja,d.i),d.h.i.length=0,p(d.i),d.i.length=0),d.l.oa()}}function MI(d,w,x){var D=x instanceof jt?Xt(x):new jt(x);if(D.g!="")w&&(D.g=w+"."+D.g),Ze(D,D.u);else{var $=o.location;D=$.protocol,w=w?w+"."+$.hostname:$.hostname,$=+$.port;const G=new jt(null);D&&ir(G,D),w&&(G.g=w),$&&Ze(G,$),x&&(G.h=x),D=G}return x=d.G,w=d.wa,x&&w&&yt(D,x,w),yt(D,"VER",d.ka),Jd(d,D),D}function VI(d,w,x){if(w&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=d.Aa&&!d.ma?new tr(new wl({ab:x})):new tr(d.ma),w.Fa(d.L),w}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function jI(){}t=jI.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function xm(){}xm.prototype.g=function(d,w){return new Ts(d,w)};function Ts(d,w){he.call(this),this.g=new AI(w),this.l=d,this.h=w&&w.messageUrlParams||null,d=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(d?d["X-WebChannel-Content-Type"]=w.messageContentType:d={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(d?d["X-WebChannel-Client-Profile"]=w.sa:d={"X-WebChannel-Client-Profile":w.sa}),this.g.U=d,(d=w&&w.Qb)&&!O(d)&&(this.g.u=d),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!O(w)&&(this.g.G=w,d=this.h,d!==null&&w in d&&(d=this.h,w in d&&delete d[w])),this.j=new Dc(this)}h(Ts,he),Ts.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ts.prototype.close=function(){Bv(this.g)},Ts.prototype.o=function(d){var w=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.v&&(x={},x.__data__=ke(d),d=x);w.i.push(new tt(w.Ya++,d)),w.I==3&&Im(w)},Ts.prototype.N=function(){this.g.l=null,delete this.j,Bv(this.g),delete this.g,Ts.Z.N.call(this)};function FI(d){Mt.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var w=d.__sm__;if(w){e:{for(const x in w){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,w=w!==null&&d in w?w[d]:void 0),this.data=w}else this.data=d}h(FI,Mt);function UI(){Zn.call(this),this.status=1}h(UI,Zn);function Dc(d){this.g=d}h(Dc,jI),Dc.prototype.ra=function(){Ce(this.g,"a")},Dc.prototype.qa=function(d){Ce(this.g,new FI(d))},Dc.prototype.pa=function(d){Ce(this.g,new UI)},Dc.prototype.oa=function(){Ce(this.g,"b")},xm.prototype.createWebChannel=xm.prototype.g,Ts.prototype.send=Ts.prototype.o,Ts.prototype.open=Ts.prototype.m,Ts.prototype.close=Ts.prototype.close,$2=function(){return new xm},U2=function(){return j()},F2=M,R0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ut.NO_ERROR=0,ut.TIMEOUT=8,ut.HTTP_ERROR=6,Fp=ut,Pe.COMPLETE="complete",j2=Pe,Tt.EventType=_t,_t.OPEN="a",_t.CLOSE="b",_t.ERROR="c",_t.MESSAGE="d",he.prototype.listen=he.prototype.J,Sh=Tt,tr.prototype.listenOnce=tr.prototype.K,tr.prototype.getLastError=tr.prototype.Ha,tr.prototype.getLastErrorCode=tr.prototype.ya,tr.prototype.getStatus=tr.prototype.ca,tr.prototype.getResponseJson=tr.prototype.La,tr.prototype.getResponseText=tr.prototype.la,tr.prototype.send=tr.prototype.ea,tr.prototype.setWithCredentials=tr.prototype.Fa,V2=tr}).apply(typeof Zm<"u"?Zm:typeof self<"u"?self:typeof window<"u"?window:{});const RA="@firebase/firestore",CA="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Cr.UNAUTHENTICATED=new Cr(null),Cr.GOOGLE_CREDENTIALS=new Cr("google-credentials-uid"),Cr.FIRST_PARTY=new Cr("first-party-uid"),Cr.MOCK_USER=new Cr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dd="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=new Zy("@firebase/firestore");function Kc(){return Ga.logLevel}function B2(t){Ga.setLogLevel(t)}function ce(t,...e){if(Ga.logLevel<=Wt.DEBUG){const n=e.map(KE);Ga.debug(`Firestore (${Dd}): ${t}`,...n)}}function lr(t,...e){if(Ga.logLevel<=Wt.ERROR){const n=e.map(KE);Ga.error(`Firestore (${Dd}): ${t}`,...n)}}function Vs(t,...e){if(Ga.logLevel<=Wt.WARN){const n=e.map(KE);Ga.warn(`Firestore (${Dd}): ${t}`,...n)}}function KE(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,z2(t,r,n)}function z2(t,e,n){let r=`FIRESTORE (${Dd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw lr(r),new Error(r)}function Je(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||z2(e,s,r)}function rH(t,e){t||Me(57014,e)}function Ee(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ie extends xi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class q2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Cr.UNAUTHENTICATED))}shutdown(){}}class sH{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class iH{constructor(e){this.t=e,this.currentUser=Cr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Je(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new kr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new kr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new kr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Je(typeof r.accessToken=="string",31837,{l:r}),new W2(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Je(e===null||typeof e=="string",2055,{h:e}),new Cr(e)}}class oH{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Cr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class aH{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new oH(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Cr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class C0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lH{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,hs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Je(this.o===void 0,3512);const r=i=>{i.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,ce("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new C0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Je(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new C0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class cH{getToken(){return Promise.resolve(new C0(""))}invalidateToken(){}start(e,n){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uH(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=uH(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function pt(t,e){return t<e?-1:t>e?1:0}function N0(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Vw(s)===Vw(i)?pt(s,i):Vw(s)?1:-1}return pt(t.length,e.length)}const dH=55296,hH=57343;function Vw(t){const e=t.charCodeAt(0);return e>=dH&&e<=hH}function Yu(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function H2(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0="__name__";class Oi{constructor(e,n,r){n===void 0?n=0:n>e.length&&Me(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Me(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Oi.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Oi?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Oi.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return pt(e.length,n.length)}static compareSegments(e,n){const r=Oi.isNumericId(e),s=Oi.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Oi.extractNumericId(e).compare(Oi.extractNumericId(n)):N0(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ua.fromString(e.substring(4,e.length-2))}}class Ft extends Oi{construct(e,n,r){return new Ft(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ie(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ft(n)}static emptyPath(){return new Ft([])}}const fH=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class On extends Oi{construct(e,n,r){return new On(e,n,r)}static isValidIdentifier(e){return fH.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),On.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===k0}static keyField(){return new On([k0])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ie(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new ie(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ie(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new ie(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new On(n)}static emptyPath(){return new On([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(Ft.fromString(e))}static fromName(e){return new we(Ft.fromString(e).popFirst(5))}static empty(){return new we(Ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ft.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new Ft(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(t,e,n){if(!n)throw new ie(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function K2(t,e,n,r){if(e===!0&&r===!0)throw new ie(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function NA(t){if(!we.isDocumentKey(t))throw new ie(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function kA(t){if(we.isDocumentKey(t))throw new ie(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function G2(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function iv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Me(12329,{type:typeof t})}function Ut(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ie(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=iv(t);throw new ie(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Q2(t,e){if(e<=0)throw new ie(B.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(t,e){const n={typeString:t};return e&&(n.value=e),n}function Pc(t,e){if(!G2(t))throw new ie(B.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new ie(B.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA=-62135596800,OA=1e6;class sn{static now(){return sn.fromMillis(Date.now())}static fromDate(e){return sn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*OA);return new sn(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ie(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ie(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<DA)throw new ie(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ie(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/OA}_compareTo(e){return this.seconds===e.seconds?pt(this.nanoseconds,e.nanoseconds):pt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:sn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pc(e,sn._jsonSchema))return new sn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-DA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}sn._jsonSchemaVersion="firestore/timestamp/1.0",sn._jsonSchema={type:pr("string",sn._jsonSchemaVersion),seconds:pr("number"),nanoseconds:pr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{static fromTimestamp(e){return new ot(e)}static min(){return new ot(new sn(0,0))}static max(){return new ot(new sn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=-1;class Xu{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function D0(t){return t.fields.find(e=>e.kind===2)}function Al(t){return t.fields.filter(e=>e.kind!==2)}function mH(t,e){let n=pt(t.collectionGroup,e.collectionGroup);if(n!==0)return n;for(let r=0;r<Math.min(t.fields.length,e.fields.length);++r)if(n=pH(t.fields[r],e.fields[r]),n!==0)return n;return pt(t.fields.length,e.fields.length)}Xu.UNKNOWN_ID=-1;class Jl{constructor(e,n){this.fieldPath=e,this.kind=n}}function pH(t,e){const n=On.comparator(t.fieldPath,e.fieldPath);return n!==0?n:pt(t.kind,e.kind)}class Zu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Zu(0,js.min())}}function Y2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ot.fromTimestamp(r===1e9?new sn(n+1,0):new sn(n,r));return new js(s,we.empty(),e)}function J2(t){return new js(t.readTime,t.key,Ju)}class js{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new js(ot.min(),we.empty(),Ju)}static max(){return new js(ot.max(),we.empty(),Ju)}}function QE(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=we.comparator(t.documentKey,e.documentKey),n!==0?n:pt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Z2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dl(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==X2)throw t;ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(e[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const As="SimpleDb";class ov{static open(e,n,r,s){try{return new ov(n,e.transaction(s,r))}catch(i){throw new Bh(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new kr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Bh(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=YE(r.target.error);this.S.reject(new Bh(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ce(As,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new yH(n)}}class Ji{static delete(e){return ce(As,"Removing database:",e),Cl(DD().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!LE())return!1;if(Ji.F())return!0;const e=_r(),n=Ji.M(e),r=0<n&&n<10,s=eO(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Ji.M(_r())===12.2&&lr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ce(As,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Bh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new ie(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ie(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Bh(e,o))},s.onupgradeneeded=i=>{ce(As,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{ce(As,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=ov.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(c=>(a.C(),c)).catch(c=>(a.abort(c),U.reject(c))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(ce(As,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function eO(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class gH{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Cl(this.U.delete())}}class Bh extends ie{constructor(e,n){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function hl(t){return t.name==="IndexedDbTransactionError"}class yH{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ce(As,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(ce(As,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Cl(r)}add(e){return ce(As,"ADD",this.store.name,e,e),Cl(this.store.add(e))}get(e){return Cl(this.store.get(e)).next(n=>(n===void 0&&(n=null),ce(As,"GET",this.store.name,e,n),n))}delete(e){return ce(As,"DELETE",this.store.name,e),Cl(this.store.delete(e))}count(){return ce(As,"COUNT",this.store.name),Cl(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new U((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new U((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){ce(As,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new U((r,s)=>{n.onerror=i=>{const o=YE(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new U((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new gH(a),c=n(a.primaryKey,a.value,l);if(c instanceof U){const u=c.catch(h=>(l.done(),U.reject(h)));r.push(u)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}}).next(()=>U.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Cl(t){return new U((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=YE(r.target.error);n(s)}})}let LA=!1;function YE(t){const e=Ji.M(_r());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return LA||(LA=!0,setTimeout(()=>{throw r},0)),r}}return t}const zh="IndexBackfiller";class vH{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ce(zh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();ce(zh,`Documents written: ${n}`)}catch(n){hl(n)?ce(zh,"Ignoring IndexedDB error during index backfill: ",n):await dl(n)}await this.re(6e4)})}}class wH{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return U.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return ce(zh,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(ce(zh,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=J2(i);QE(o,r)>0&&(r=o)}),new js(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ps.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a=-1;function im(t){return t==null}function Af(t){return t===0&&1/t==-1/0}function tO(t){return typeof t=="number"&&Number.isInteger(t)&&!Af(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg="";function Yr(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=MA(e)),e=_H(t.get(n),e);return MA(e)}function _H(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Hg:n+="";break;default:n+=i}}return n}function MA(t){return t+Hg+""}function zi(t){const e=t.length;if(Je(e>=2,64408,{path:t}),e===2)return Je(t.charAt(0)===Hg&&t.charAt(1)==="",56145,{path:t}),Ft.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Hg,i);switch((o<0||o>n)&&Me(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:Me(61167,{path:t})}i=o+2}return new Ft(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pl="remoteDocuments",om="owner",Lc="owner",Pf="mutationQueues",bH="userId",li="mutations",VA="batchId",Bl="userMutationsIndex",jA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Up(t,e){return[t,Yr(e)]}function nO(t,e,n){return[t,Yr(e),n]}const EH={},ed="documentMutations",Kg="remoteDocumentsV14",SH=["prefixPath","collectionGroup","readTime","documentId"],$p="documentKeyIndex",IH=["prefixPath","collectionGroup","documentId"],rO="collectionGroupIndex",TH=["collectionGroup","readTime","prefixPath","documentId"],Rf="remoteDocumentGlobal",O0="remoteDocumentGlobalKey",td="targets",sO="queryTargetsIndex",xH=["canonicalId","targetId"],nd="targetDocuments",AH=["targetId","path"],JE="documentTargetsIndex",PH=["path","targetId"],Gg="targetGlobalKey",Xl="targetGlobal",Cf="collectionParents",RH=["collectionId","parent"],rd="clientMetadata",CH="clientId",av="bundles",NH="bundleId",lv="namedQueries",kH="name",XE="indexConfiguration",DH="indexId",L0="collectionGroupIndex",OH="collectionGroup",Wh="indexState",LH=["indexId","uid"],iO="sequenceNumberIndex",MH=["uid","sequenceNumber"],qh="indexEntries",VH=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],oO="documentKeyIndex",jH=["indexId","uid","orderedDocumentKey"],cv="documentOverlays",FH=["userId","collectionPath","documentId"],M0="collectionPathOverlayIndex",UH=["userId","collectionPath","largestBatchId"],aO="collectionGroupOverlayIndex",$H=["userId","collectionGroup","largestBatchId"],ZE="globals",BH="name",lO=[Pf,li,ed,Pl,td,om,Xl,nd,rd,Rf,Cf,av,lv],zH=[...lO,cv],cO=[Pf,li,ed,Kg,td,om,Xl,nd,rd,Rf,Cf,av,lv,cv],uO=cO,eS=[...uO,XE,Wh,qh],WH=eS,dO=[...eS,ZE],qH=dO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0 extends Z2{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Er(t,e){const n=Ee(t);return Ji.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function fl(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function hO(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function fO(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e,n){this.comparator=e,this.root=n||Vr.EMPTY}insert(e,n){return new An(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Vr.BLACK,null,null))}remove(e){return new An(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ep(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ep(this.root,e,this.comparator,!1)}getReverseIterator(){return new ep(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ep(this.root,e,this.comparator,!0)}}class ep{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vr{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Vr.RED,this.left=s??Vr.EMPTY,this.right=i??Vr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Vr(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Vr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Vr.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Me(27949);return e+(this.isRed()?0:1)}}Vr.EMPTY=null,Vr.RED=!0,Vr.BLACK=!1;Vr.EMPTY=new class{constructor(){this.size=0}get key(){throw Me(57766)}get value(){throw Me(16141)}get color(){throw Me(16727)}get left(){throw Me(29726)}get right(){throw Me(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Vr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.comparator=e,this.data=new An(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new UA(this.data.getIterator())}getIteratorFrom(e){return new UA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof gn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new gn(this.comparator);return n.data=e,n}}class UA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Mc(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e){this.fields=e,e.sort(On.comparator)}static empty(){return new gs([])}unionWith(e){let n=new gn(On.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new gs(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Yu(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HH(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new mO("Invalid base64 string: "+i):i}}(e);return new Yn(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Yn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Yn.EMPTY_BYTE_STRING=new Yn("");const KH=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Lo(t){if(Je(!!t,39018),typeof t=="string"){let e=0;const n=KH.exec(t);if(Je(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:jn(t.seconds),nanos:jn(t.nanos)}}function jn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Mo(t){return typeof t=="string"?Yn.fromBase64String(t):Yn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pO="server_timestamp",gO="__type__",yO="__previous_value__",vO="__local_write_time__";function uv(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[gO])==null?void 0:r.stringValue)===pO}function dv(t){const e=t.mapValue.fields[yO];return uv(e)?dv(e):e}function Nf(t){const e=Lo(t.mapValue.fields[vO].timestampValue);return new sn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GH{constructor(e,n,r,s,i,o,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const kf="(default)";class Qa{constructor(e,n){this.projectId=e,this.database=n||kf}static empty(){return new Qa("","")}get isDefaultDatabase(){return this.database===kf}isEqual(e){return e instanceof Qa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS="__type__",wO="__max__",xa={mapValue:{fields:{__type__:{stringValue:wO}}}},nS="__vector__",sd="value",Bp={nullValue:"NULL_VALUE"};function Ya(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?uv(t)?4:_O(t)?9007199254740991:hv(t)?10:11:Me(28295,{value:t})}function no(t,e){if(t===e)return!0;const n=Ya(t);if(n!==Ya(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Nf(t).isEqual(Nf(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Lo(s.timestampValue),a=Lo(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Mo(s.bytesValue).isEqual(Mo(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return jn(s.geoPointValue.latitude)===jn(i.geoPointValue.latitude)&&jn(s.geoPointValue.longitude)===jn(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return jn(s.integerValue)===jn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=jn(s.doubleValue),a=jn(i.doubleValue);return o===a?Af(o)===Af(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Yu(t.arrayValue.values||[],e.arrayValue.values||[],no);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(FA(o)!==FA(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!no(o[l],a[l])))return!1;return!0}(t,e);default:return Me(52216,{left:t})}}function Df(t,e){return(t.values||[]).find(n=>no(n,e))!==void 0}function Ja(t,e){if(t===e)return 0;const n=Ya(t),r=Ya(e);if(n!==r)return pt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return pt(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=jn(i.integerValue||i.doubleValue),l=jn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return $A(t.timestampValue,e.timestampValue);case 4:return $A(Nf(t),Nf(e));case 5:return N0(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Mo(i),l=Mo(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=pt(a[c],l[c]);if(u!==0)return u}return pt(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=pt(jn(i.latitude),jn(o.latitude));return a!==0?a:pt(jn(i.longitude),jn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return BA(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,p,v,g;const a=i.fields||{},l=o.fields||{},c=(m=a[sd])==null?void 0:m.arrayValue,u=(p=l[sd])==null?void 0:p.arrayValue,h=pt(((v=c==null?void 0:c.values)==null?void 0:v.length)||0,((g=u==null?void 0:u.values)==null?void 0:g.length)||0);return h!==0?h:BA(c,u)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===xa.mapValue&&o===xa.mapValue)return 0;if(i===xa.mapValue)return 1;if(o===xa.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const m=N0(l[h],u[h]);if(m!==0)return m;const p=Ja(a[l[h]],c[u[h]]);if(p!==0)return p}return pt(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Me(23264,{he:n})}}function $A(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return pt(t,e);const n=Lo(t),r=Lo(e),s=pt(n.seconds,r.seconds);return s!==0?s:pt(n.nanos,r.nanos)}function BA(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ja(n[s],r[s]);if(i)return i}return pt(n.length,r.length)}function id(t){return j0(t)}function j0(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Lo(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Mo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return we.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=j0(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${j0(n.fields[o])}`;return s+"}"}(t.mapValue):Me(61005,{value:t})}function zp(t){switch(Ya(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dv(t);return e?16+zp(e):16;case 5:return 2*t.stringValue.length;case 6:return Mo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+zp(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return fl(r.fields,(i,o)=>{s+=i.length+zp(o)}),s}(t.mapValue);default:throw Me(13486,{value:t})}}function uc(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function F0(t){return!!t&&"integerValue"in t}function Of(t){return!!t&&"arrayValue"in t}function zA(t){return!!t&&"nullValue"in t}function WA(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wp(t){return!!t&&"mapValue"in t}function hv(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[tS])==null?void 0:r.stringValue)===nS}function Hh(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return fl(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Hh(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Hh(t.arrayValue.values[n]);return e}return{...t}}function _O(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===wO}const bO={mapValue:{fields:{[tS]:{stringValue:nS},[sd]:{arrayValue:{}}}}};function QH(t){return"nullValue"in t?Bp:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?uc(Qa.empty(),we.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?hv(t)?bO:{mapValue:{}}:Me(35942,{value:t})}function YH(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?uc(Qa.empty(),we.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?bO:"mapValue"in t?hv(t)?{mapValue:{}}:xa:Me(61959,{value:t})}function qA(t,e){const n=Ja(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function HA(t,e){const n=Ja(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.value=e}static empty(){return new Fr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Wp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Hh(n)}setAll(e){let n=On.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Hh(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Wp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return no(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Wp(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){fl(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Fr(Hh(this.value))}}function EO(t){const e=[];return fl(t.fields,(n,r)=>{const s=new On([n]);if(Wp(r)){const i=EO(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new gs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Dn(e,0,ot.min(),ot.min(),ot.min(),Fr.empty(),0)}static newFoundDocument(e,n,r,s){return new Dn(e,1,n,ot.min(),r,s,0)}static newNoDocument(e,n){return new Dn(e,2,n,ot.min(),ot.min(),Fr.empty(),0)}static newUnknownDocument(e,n){return new Dn(e,3,n,ot.min(),ot.min(),Fr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ot.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ot.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Dn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(e,n){this.position=e,this.inclusive=n}}function KA(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=we.comparator(we.fromName(o.referenceValue),n.key):r=Ja(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function GA(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!no(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e,n="asc"){this.field=e,this.dir=n}}function JH(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{}class Ht extends SO{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new XH(e,n,r):n==="array-contains"?new tK(e,r):n==="in"?new RO(e,r):n==="not-in"?new nK(e,r):n==="array-contains-any"?new rK(e,r):new Ht(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new ZH(e,r):new eK(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ja(n,this.value)):n!==null&&Ya(this.value)===Ya(n)&&this.matchesComparison(Ja(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fn extends SO{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new fn(e,n)}matches(e){return od(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function od(t){return t.op==="and"}function U0(t){return t.op==="or"}function rS(t){return IO(t)&&od(t)}function IO(t){for(const e of t.filters)if(e instanceof fn)return!1;return!0}function $0(t){if(t instanceof Ht)return t.field.canonicalString()+t.op.toString()+id(t.value);if(rS(t))return t.filters.map(e=>$0(e)).join(",");{const e=t.filters.map(n=>$0(n)).join(",");return`${t.op}(${e})`}}function TO(t,e){return t instanceof Ht?function(r,s){return s instanceof Ht&&r.op===s.op&&r.field.isEqual(s.field)&&no(r.value,s.value)}(t,e):t instanceof fn?function(r,s){return s instanceof fn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&TO(o,s.filters[a]),!0):!1}(t,e):void Me(19439)}function xO(t,e){const n=t.filters.concat(e);return fn.create(n,t.op)}function AO(t){return t instanceof Ht?function(n){return`${n.field.canonicalString()} ${n.op} ${id(n.value)}`}(t):t instanceof fn?function(n){return n.op.toString()+" {"+n.getFilters().map(AO).join(" ,")+"}"}(t):"Filter"}class XH extends Ht{constructor(e,n,r){super(e,n,r),this.key=we.fromName(r.referenceValue)}matches(e){const n=we.comparator(e.key,this.key);return this.matchesComparison(n)}}class ZH extends Ht{constructor(e,n){super(e,"in",n),this.keys=PO("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class eK extends Ht{constructor(e,n){super(e,"not-in",n),this.keys=PO("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function PO(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>we.fromName(r.referenceValue))}class tK extends Ht{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Of(n)&&Df(n.arrayValue,this.value)}}class RO extends Ht{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Df(this.value.arrayValue,n)}}class nK extends Ht{constructor(e,n){super(e,"not-in",n)}matches(e){if(Df(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Df(this.value.arrayValue,n)}}class rK extends Ht{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Of(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Df(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sK{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function B0(t,e=null,n=[],r=[],s=null,i=null,o=null){return new sK(t,e,n,r,s,i,o)}function dc(t){const e=Ee(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>$0(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),im(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>id(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>id(r)).join(",")),e.Te=n}return e.Te}function am(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!JH(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!TO(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!GA(t.startAt,e.startAt)&&GA(t.endAt,e.endAt)}function Qg(t){return we.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Yg(t,e){return t.filters.filter(n=>n instanceof Ht&&n.field.isEqual(e))}function QA(t,e,n){let r=Bp,s=!0;for(const i of Yg(t,e)){let o=Bp,a=!0;switch(i.op){case"<":case"<=":o=QH(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Bp}qA({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];qA({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function YA(t,e,n){let r=xa,s=!0;for(const i of Yg(t,e)){let o=xa,a=!0;switch(i.op){case">=":case">":o=YH(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=xa}HA({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];HA({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function CO(t,e,n,r,s,i,o,a){return new Fo(t,e,n,r,s,i,o,a)}function Od(t){return new Fo(t)}function JA(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function sS(t){return t.collectionGroup!==null}function Au(t){const e=Ee(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new gn(On.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Lf(i,r))}),n.has(On.keyField().canonicalString())||e.Ie.push(new Lf(On.keyField(),r))}return e.Ie}function Jr(t){const e=Ee(t);return e.Ee||(e.Ee=kO(e,Au(t))),e.Ee}function NO(t){const e=Ee(t);return e.de||(e.de=kO(e,t.explicitOrderBy)),e.de}function kO(t,e){if(t.limitType==="F")return B0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Lf(s.field,i)});const n=t.endAt?new Xa(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Xa(t.startAt.position,t.startAt.inclusive):null;return B0(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function z0(t,e){const n=t.filters.concat([e]);return new Fo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Jg(t,e,n){return new Fo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function lm(t,e){return am(Jr(t),Jr(e))&&t.limitType===e.limitType}function DO(t){return`${dc(Jr(t))}|lt:${t.limitType}`}function Gc(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>AO(s)).join(", ")}]`),im(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>id(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>id(s)).join(",")),`Target(${r})`}(Jr(t))}; limitType=${t.limitType})`}function cm(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):we.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Au(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=KA(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Au(r),s)||r.endAt&&!function(o,a,l){const c=KA(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Au(r),s))}(t,e)}function OO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function LO(t){return(e,n)=>{let r=!1;for(const s of Au(t)){const i=iK(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function iK(t,e,n){const r=t.field.isKeyField()?we.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?Ja(l,c):Me(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Me(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){fl(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return fO(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oK=new An(we.comparator);function ys(){return oK}const MO=new An(we.comparator);function Ih(...t){let e=MO;for(const n of t)e=e.insert(n.key,n);return e}function VO(t){let e=MO;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Wi(){return Kh()}function jO(){return Kh()}function Kh(){return new Uo(t=>t.toString(),(t,e)=>t.isEqual(e))}const aK=new An(we.comparator),lK=new gn(we.comparator);function At(...t){let e=lK;for(const n of t)e=e.add(n);return e}const cK=new gn(pt);function iS(){return cK}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Af(e)?"-0":e}}function FO(t){return{integerValue:""+t}}function UO(t,e){return tO(e)?FO(e):oS(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(){this._=void 0}}function uK(t,e,n){return t instanceof ad?function(s,i){const o={fields:{[gO]:{stringValue:pO},[vO]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&uv(i)&&(i=dv(i)),i&&(o.fields[yO]=i),{mapValue:o}}(n,e):t instanceof hc?BO(t,e):t instanceof fc?zO(t,e):function(s,i){const o=$O(s,i),a=XA(o)+XA(s.Ae);return F0(o)&&F0(s.Ae)?FO(a):oS(s.serializer,a)}(t,e)}function dK(t,e,n){return t instanceof hc?BO(t,e):t instanceof fc?zO(t,e):n}function $O(t,e){return t instanceof ld?function(r){return F0(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ad extends fv{}class hc extends fv{constructor(e){super(),this.elements=e}}function BO(t,e){const n=WO(e);for(const r of t.elements)n.some(s=>no(s,r))||n.push(r);return{arrayValue:{values:n}}}class fc extends fv{constructor(e){super(),this.elements=e}}function zO(t,e){let n=WO(e);for(const r of t.elements)n=n.filter(s=>!no(s,r));return{arrayValue:{values:n}}}class ld extends fv{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function XA(t){return jn(t.integerValue||t.doubleValue)}function WO(t){return Of(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,n){this.field=e,this.transform=n}}function hK(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof hc&&s instanceof hc||r instanceof fc&&s instanceof fc?Yu(r.elements,s.elements,no):r instanceof ld&&s instanceof ld?no(r.Ae,s.Ae):r instanceof ad&&s instanceof ad}(t.transform,e.transform)}class fK{constructor(e,n){this.version=e,this.transformResults=n}}class Un{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Un}static exists(e){return new Un(void 0,e)}static updateTime(e){return new Un(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function qp(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class mv{}function qO(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Md(t.key,Un.none()):new Ld(t.key,t.data,Un.none());{const n=t.data,r=Fr.empty();let s=new gn(On.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new $o(t.key,r,new gs(s.toArray()),Un.none())}}function mK(t,e,n){t instanceof Ld?function(s,i,o){const a=s.value.clone(),l=e1(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof $o?function(s,i,o){if(!qp(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=e1(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(HO(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Gh(t,e,n,r){return t instanceof Ld?function(i,o,a,l){if(!qp(i.precondition,o))return a;const c=i.value.clone(),u=t1(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof $o?function(i,o,a,l){if(!qp(i.precondition,o))return a;const c=t1(i.fieldTransforms,l,o),u=o.data;return u.setAll(HO(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,o,a){return qp(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function pK(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=$O(r.transform,s||null);i!=null&&(n===null&&(n=Fr.empty()),n.set(r.field,i))}return n||null}function ZA(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Yu(r,s,(i,o)=>hK(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ld extends mv{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class $o extends mv{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function HO(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function e1(t,e,n){const r=new Map;Je(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,dK(o,a,n[s]))}return r}function t1(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,uK(i,o,e))}return r}class Md extends mv{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class aS extends mv{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&mK(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Gh(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Gh(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=jO();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=qO(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ot.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),At())}isEqual(e){return this.batchId===e.batchId&&Yu(this.mutations,e.mutations,(n,r)=>ZA(n,r))&&Yu(this.baseMutations,e.baseMutations,(n,r)=>ZA(n,r))}}class cS{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Je(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return aK}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new cS(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uS=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gK{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hr,Qt;function GO(t){switch(t){case B.OK:return Me(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return Me(15467,{code:t})}}function QO(t){if(t===void 0)return lr("GRPC error has no .code"),B.UNKNOWN;switch(t){case hr.OK:return B.OK;case hr.CANCELLED:return B.CANCELLED;case hr.UNKNOWN:return B.UNKNOWN;case hr.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case hr.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case hr.INTERNAL:return B.INTERNAL;case hr.UNAVAILABLE:return B.UNAVAILABLE;case hr.UNAUTHENTICATED:return B.UNAUTHENTICATED;case hr.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case hr.NOT_FOUND:return B.NOT_FOUND;case hr.ALREADY_EXISTS:return B.ALREADY_EXISTS;case hr.PERMISSION_DENIED:return B.PERMISSION_DENIED;case hr.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case hr.ABORTED:return B.ABORTED;case hr.OUT_OF_RANGE:return B.OUT_OF_RANGE;case hr.UNIMPLEMENTED:return B.UNIMPLEMENTED;case hr.DATA_LOSS:return B.DATA_LOSS;default:return Me(39323,{code:t})}}(Qt=hr||(hr={}))[Qt.OK=0]="OK",Qt[Qt.CANCELLED=1]="CANCELLED",Qt[Qt.UNKNOWN=2]="UNKNOWN",Qt[Qt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qt[Qt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qt[Qt.NOT_FOUND=5]="NOT_FOUND",Qt[Qt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qt[Qt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qt[Qt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qt[Qt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qt[Qt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qt[Qt.ABORTED=10]="ABORTED",Qt[Qt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qt[Qt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qt[Qt.INTERNAL=13]="INTERNAL",Qt[Qt.UNAVAILABLE=14]="UNAVAILABLE",Qt[Qt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qh=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yK=new Ua([4294967295,4294967295],0);function n1(t){const e=YO().encode(t),n=new M2;return n.update(e),new Uint8Array(n.digest())}function r1(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ua([n,r],0),new Ua([s,i],0)]}class dS{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Th(`Invalid padding: ${n}`);if(r<0)throw new Th(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Th(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Th(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ua.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Ua.fromNumber(r)));return s.compare(yK)===1&&(s=new Ua([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=n1(e),[r,s]=r1(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new dS(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=n1(e),[r,s]=r1(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Th extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,hm.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new dm(ot.min(),s,new An(pt),ys(),At())}}class hm{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new hm(r,n,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class JO{constructor(e,n){this.targetId=e,this.Ce=n}}class XO{constructor(e,n,r=Yn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class s1{constructor(){this.ve=0,this.Fe=i1(),this.Me=Yn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=At(),n=At(),r=At();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Me(38017,{changeType:i})}}),new hm(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=i1()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Je(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class vK{constructor(e){this.Ge=e,this.ze=new Map,this.je=ys(),this.Je=tp(),this.He=tp(),this.Ye=new An(pt)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Me(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Qg(i))if(r===0){const o=new we(i.path);this.et(n,o,Dn.newNoDocument(o,ot.min()))}else Je(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,c)}Qh==null||Qh.lt(function(u,h,m,p,v){var b,_,S;const g={localCacheCount:u,existenceFilterCount:h.count,databaseId:m.database,projectId:m.projectId},E=h.unchangedNames;return E&&(g.bloomFilter={applied:v===0,hashCount:(E==null?void 0:E.hashCount)??0,bitmapLength:((_=(b=E==null?void 0:E.bits)==null?void 0:b.bitmap)==null?void 0:_.length)??0,padding:((S=E==null?void 0:E.bits)==null?void 0:S.padding)??0,mightContain:P=>(p==null?void 0:p.mightContain(P))??!1}),g}(o,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Mo(r).toUint8Array()}catch(l){if(l instanceof mO)return Vs("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new dS(o,s,i)}catch(l){return Vs(l instanceof Th?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&Qg(a.target)){const l=new we(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Dn.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=At();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new dm(e,n,this.Ye,this.je,r);return this.je=ys(),this.Je=tp(),this.He=tp(),this.Ye=new An(pt),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new s1,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new gn(pt),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new gn(pt),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ce("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new s1),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function tp(){return new An(we.comparator)}function i1(){return new An(we.comparator)}const wK={asc:"ASCENDING",desc:"DESCENDING"},_K={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bK={and:"AND",or:"OR"};class EK{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function W0(t,e){return t.useProto3Json||im(e)?e:{value:e}}function cd(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ZO(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function SK(t,e){return cd(t,e.toTimestamp())}function ur(t){return Je(!!t,49232),ot.fromTimestamp(function(n){const r=Lo(n);return new sn(r.seconds,r.nanos)}(t))}function hS(t,e){return q0(t,e).canonicalString()}function q0(t,e){const n=function(s){return new Ft(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function eL(t){const e=Ft.fromString(t);return Je(cL(e),10190,{key:e.toString()}),e}function Mf(t,e){return hS(t.databaseId,e.path)}function Xi(t,e){const n=eL(e);if(n.get(1)!==t.databaseId.projectId)throw new ie(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ie(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new we(rL(n))}function tL(t,e){return hS(t.databaseId,e)}function nL(t){const e=eL(t);return e.length===4?Ft.emptyPath():rL(e)}function H0(t){return new Ft(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function rL(t){return Je(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function o1(t,e,n){return{name:Mf(t,e),fields:n.value.mapValue.fields}}function pv(t,e,n){const r=Xi(t,e.name),s=ur(e.updateTime),i=e.createTime?ur(e.createTime):ot.min(),o=new Fr({mapValue:{fields:e.fields}}),a=Dn.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function IK(t,e){return"found"in e?function(r,s){Je(!!s.found,43571),s.found.name,s.found.updateTime;const i=Xi(r,s.found.name),o=ur(s.found.updateTime),a=s.found.createTime?ur(s.found.createTime):ot.min(),l=new Fr({mapValue:{fields:s.found.fields}});return Dn.newFoundDocument(i,o,a,l)}(t,e):"missing"in e?function(r,s){Je(!!s.missing,3894),Je(!!s.readTime,22933);const i=Xi(r,s.missing),o=ur(s.readTime);return Dn.newNoDocument(i,o)}(t,e):Me(7234,{result:e})}function TK(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Me(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(Je(u===void 0||typeof u=="string",58123),Yn.fromBase64String(u||"")):(Je(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Yn.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?B.UNKNOWN:QO(c.code);return new ie(u,c.message||"")}(o);n=new XO(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Xi(t,r.document.name),i=ur(r.document.updateTime),o=r.document.createTime?ur(r.document.createTime):ot.min(),a=new Fr({mapValue:{fields:r.document.fields}}),l=Dn.newFoundDocument(s,i,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Hp(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Xi(t,r.document),i=r.readTime?ur(r.readTime):ot.min(),o=Dn.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Hp([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Xi(t,r.document),i=r.removedTargetIds||[];n=new Hp([],i,s,null)}else{if(!("filter"in e))return Me(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new gK(s,i),a=r.targetId;n=new JO(a,o)}}return n}function Vf(t,e){let n;if(e instanceof Ld)n={update:o1(t,e.key,e.value)};else if(e instanceof Md)n={delete:Mf(t,e.key)};else if(e instanceof $o)n={update:o1(t,e.key,e.data),updateMask:NK(e.fieldMask)};else{if(!(e instanceof aS))return Me(16599,{Vt:e.type});n={verify:Mf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof ad)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof hc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof fc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ld)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Me(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:SK(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Me(27497)}(t,e.precondition)),n}function K0(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Un.updateTime(ur(i.updateTime)):i.exists!==void 0?Un.exists(i.exists):Un.none()}(e.currentDocument):Un.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)Je(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new ad;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];l=new hc(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];l=new fc(u)}else"increment"in a?l=new ld(o,a.increment):Me(16584,{proto:a});const c=On.fromServerFormat(a.fieldPath);return new um(c,l)}(t,s)):[];if(e.update){e.update.name;const s=Xi(t,e.update.name),i=new Fr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new gs(c.map(u=>On.fromServerFormat(u)))}(e.updateMask);return new $o(s,i,o,n,r)}return new Ld(s,i,n,r)}if(e.delete){const s=Xi(t,e.delete);return new Md(s,n)}if(e.verify){const s=Xi(t,e.verify);return new aS(s,n)}return Me(1463,{proto:e})}function xK(t,e){return t&&t.length>0?(Je(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?ur(s.updateTime):ur(i);return o.isEqual(ot.min())&&(o=ur(i)),new fK(o,s.transformResults||[])}(n,e))):[]}function sL(t,e){return{documents:[tL(t,e.path)]}}function gv(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=tL(t,s);const i=function(c){if(c.length!==0)return lL(fn.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(u=>function(m){return{field:ma(m.field),direction:PK(m.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=W0(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:n,parent:s}}function iL(t,e,n,r){const{ft:s,parent:i}=gv(t,e),o={},a=[];let l=0;return n.forEach(c=>{const u=r?c.alias:"aggregate_"+l++;o[u]=c.alias,c.aggregateType==="count"?a.push({alias:u,count:{}}):c.aggregateType==="avg"?a.push({alias:u,avg:{field:ma(c.fieldPath)}}):c.aggregateType==="sum"&&a.push({alias:u,sum:{field:ma(c.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function oL(t){let e=nL(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Je(r===1,65062);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=function(h){const m=aL(h);return m instanceof fn&&rS(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(m=>function(v){return new Lf(Qc(v.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(h){let m;return m=typeof h=="object"?h.value:h,im(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(h){const m=!!h.before,p=h.values||[];return new Xa(p,m)}(n.startAt));let c=null;return n.endAt&&(c=function(h){const m=!h.before,p=h.values||[];return new Xa(p,m)}(n.endAt)),CO(e,s,o,i,a,"F",l,c)}function AK(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Me(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function aL(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Qc(n.unaryFilter.field);return Ht.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Qc(n.unaryFilter.field);return Ht.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Qc(n.unaryFilter.field);return Ht.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Qc(n.unaryFilter.field);return Ht.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Me(61313);default:return Me(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ht.create(Qc(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Me(58110);default:return Me(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return fn.create(n.compositeFilter.filters.map(r=>aL(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Me(1026)}}(n.compositeFilter.op))}(t):Me(30097,{filter:t})}function PK(t){return wK[t]}function RK(t){return _K[t]}function CK(t){return bK[t]}function ma(t){return{fieldPath:t.canonicalString()}}function Qc(t){return On.fromServerFormat(t.fieldPath)}function lL(t){return t instanceof Ht?function(n){if(n.op==="=="){if(WA(n.value))return{unaryFilter:{field:ma(n.field),op:"IS_NAN"}};if(zA(n.value))return{unaryFilter:{field:ma(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(WA(n.value))return{unaryFilter:{field:ma(n.field),op:"IS_NOT_NAN"}};if(zA(n.value))return{unaryFilter:{field:ma(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ma(n.field),op:RK(n.op),value:n.value}}}(t):t instanceof fn?function(n){const r=n.getFilters().map(s=>lL(s));return r.length===1?r[0]:{compositeFilter:{op:CK(n.op),filters:r}}}(t):Me(54877,{filter:t})}function NK(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function cL(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,n,r,s,i=ot.min(),o=ot.min(),a=Yn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new _o(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new _o(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _o(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _o(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(e){this.yt=e}}function kK(t,e){let n;if(e.document)n=pv(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=we.fromSegments(e.noDocument.path),s=pc(e.noDocument.readTime);n=Dn.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Me(56709);{const r=we.fromSegments(e.unknownDocument.path),s=pc(e.unknownDocument.version);n=Dn.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new sn(s[0],s[1]);return ot.fromTimestamp(i)}(e.readTime)),n}function a1(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Xg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Mf(i,o.key),fields:o.data.value.mapValue.fields,updateTime:cd(i,o.version.toTimestamp()),createTime:cd(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:mc(e.version)};else{if(!e.isUnknownDocument())return Me(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:mc(e.version)}}return r}function Xg(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function mc(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function pc(t){const e=new sn(t.seconds,t.nanoseconds);return ot.fromTimestamp(e)}function Nl(t,e){const n=(e.baseMutations||[]).map(i=>K0(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>K0(t.yt,i)),s=sn.fromMillis(e.localWriteTimeMs);return new lS(e.batchId,s,n,r)}function xh(t){const e=pc(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?pc(t.lastLimboFreeSnapshotVersion):ot.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return Je(o===1,1966,{count:o}),Jr(Od(nL(i.documents[0])))}(t.query):function(i){return Jr(oL(i))}(t.query),new _o(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Yn.fromBase64String(t.resumeToken))}function dL(t,e){const n=mc(e.snapshotVersion),r=mc(e.lastLimboFreeSnapshotVersion);let s;s=Qg(e.target)?sL(t.yt,e.target):gv(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:dc(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function yv(t){const e=oL({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Jg(e,e.limit,"L"):e}function jw(t,e){return new uS(e.largestBatchId,K0(t.yt,e.overlayMutation))}function l1(t,e){const n=e.path.lastSegment();return[t,Yr(e.path.popLast()),n]}function c1(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:mc(r.readTime),documentKey:Yr(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DK{getBundleMetadata(e,n){return u1(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:pc(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return u1(e).put(function(s){return{bundleId:s.id,createTime:mc(ur(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return d1(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:yv(i.bundledQuery),readTime:pc(i.readTime)}}(r)})}saveNamedQuery(e,n){return d1(e).put(function(s){return{name:s.name,readTime:mc(ur(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function u1(t){return Er(t,av)}function d1(t){return Er(t,lv)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new vv(e,r)}getOverlay(e,n){return ch(e).get(l1(this.userId,n)).next(r=>r?jw(this.serializer,r):null)}getOverlays(e,n){const r=Wi();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new uS(n,o);s.push(this.St(e,a))}),U.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Yr(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(ch(e).Z(M0,a))}),U.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Wi(),i=Yr(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return ch(e).J(M0,o).next(a=>{for(const l of a){const c=jw(this.serializer,l);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Wi();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return ch(e).ee({index:aO,range:a},(l,c,u)=>{const h=jw(this.serializer,c);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>i)}St(e,n){return ch(e).put(function(s,i,o){const[a,l,c]=l1(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Vf(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function ch(t){return Er(t,cv)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OK{bt(e){return Er(e,ZE)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Yn.fromUint8Array(r):Yn.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(jn(e.integerValue));else if("doubleValue"in e){const r=jn(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Af(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Lo(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Mo(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?_O(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):hv(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):Me(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=sd,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(jn(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),we.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}kl.Kt=new kl;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc=255;function LK(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function h1(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=LK(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class MK{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=h1(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=h1(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(Vc),this.sn(255)}_n(){this.an(Vc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Vc?(this.sn(Vc),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Vc?(this.an(Vc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class VK{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class jK{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class uh{constructor(){this.cn=new MK,this.ln=new VK(this.cn),this.hn=new jK(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Dl(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Kp(this.En),directionalValue:Kp(this.dn),orderedDocumentKey:Kp(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Jo(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=f1(t.En,e.En),n!==0?n:(n=f1(t.dn,e.dn),n!==0?n:we.comparator(t.In,e.In)))}function f1(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Kp(t){return UD()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function m1(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class p1{constructor(e){this.mn=new gn((n,r)=>On.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Je(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=D0(e);if(n!==void 0&&!this.wn(n))return!1;const r=Al(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new gn(On.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Jl(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Jl(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Jl(r.field,r.dir==="asc"?0:1)));return new Xu(Xu.UNKNOWN_ID,this.collectionId,n,Zu.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hL(t){var n,r;if(Je(t instanceof Ht||t instanceof fn,20012),t instanceof Ht){if(t instanceof RO){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>Ht.create(t.field,"==",i)))||[];return fn.create(s,"or")}return t}const e=t.filters.map(s=>hL(s));return fn.create(e,t.op)}function FK(t){if(t.getFilters().length===0)return[];const e=Y0(hL(t));return Je(fL(e),7391),G0(e)||Q0(e)?[e]:e.getFilters()}function G0(t){return t instanceof Ht}function Q0(t){return t instanceof fn&&rS(t)}function fL(t){return G0(t)||Q0(t)||function(n){if(n instanceof fn&&U0(n)){for(const r of n.getFilters())if(!G0(r)&&!Q0(r))return!1;return!0}return!1}(t)}function Y0(t){if(Je(t instanceof Ht||t instanceof fn,34018),t instanceof Ht)return t;if(t.filters.length===1)return Y0(t.filters[0]);const e=t.filters.map(r=>Y0(r));let n=fn.create(e,t.op);return n=Zg(n),fL(n)?n:(Je(n instanceof fn,64498),Je(od(n),40251),Je(n.filters.length>1,57927),n.filters.reduce((r,s)=>fS(r,s)))}function fS(t,e){let n;return Je(t instanceof Ht||t instanceof fn,38388),Je(e instanceof Ht||e instanceof fn,25473),n=t instanceof Ht?e instanceof Ht?function(s,i){return fn.create([s,i],"and")}(t,e):g1(t,e):e instanceof Ht?g1(e,t):function(s,i){if(Je(s.filters.length>0&&i.filters.length>0,48005),od(s)&&od(i))return xO(s,i.getFilters());const o=U0(s)?s:i,a=U0(s)?i:s,l=o.filters.map(c=>fS(c,a));return fn.create(l,"or")}(t,e),Zg(n)}function g1(t,e){if(od(e))return xO(e,t.getFilters());{const n=e.filters.map(r=>fS(t,r));return fn.create(n,"or")}}function Zg(t){if(Je(t instanceof Ht||t instanceof fn,11850),t instanceof Ht)return t;const e=t.getFilters();if(e.length===1)return Zg(e[0]);if(IO(t))return t;const n=e.map(s=>Zg(s)),r=[];return n.forEach(s=>{s instanceof Ht?r.push(s):s instanceof fn&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:fn.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UK{constructor(){this.Cn=new mS}addToCollectionParentIndex(e,n){return this.Cn.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(js.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(js.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class mS{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new gn(Ft.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new gn(Ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1="IndexedDbIndexManager",np=new Uint8Array(0);class $K{constructor(e,n){this.databaseId=n,this.vn=new mS,this.Fn=new Uo(r=>dc(r),(r,s)=>am(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:Yr(s)};return v1(e).put(i)}return U.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[H2(n),""],!1,!0);return v1(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(zi(o.parent))}return r})}addFieldIndex(e,n){const r=dh(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Fc(e);return i.next(a=>{o.put(c1(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=dh(e),s=Fc(e),i=jc(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=dh(e),r=jc(e),s=Fc(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return U.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new p1(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=jc(e);let s=!0;const i=new Map;return U.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=At();const a=[];return U.forEach(i,(l,c)=>{ce(y1,`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(P=>`${P.fieldPath}:${P.kind}`).join(",")}`}(l)} to execute ${dc(n)}`);const u=function(S,P){const T=D0(P);if(T===void 0)return null;for(const N of Yg(S,T.fieldPath))switch(N.op){case"array-contains-any":return N.value.arrayValue.values||[];case"array-contains":return[N.value]}return null}(c,l),h=function(S,P){const T=new Map;for(const N of Al(P))for(const I of Yg(S,N.fieldPath))switch(I.op){case"==":case"in":T.set(N.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return T.set(N.fieldPath.canonicalString(),I.value),Array.from(T.values())}return null}(c,l),m=function(S,P){const T=[];let N=!0;for(const I of Al(P)){const A=I.kind===0?QA(S,I.fieldPath,S.startAt):YA(S,I.fieldPath,S.startAt);T.push(A.value),N&&(N=A.inclusive)}return new Xa(T,N)}(c,l),p=function(S,P){const T=[];let N=!0;for(const I of Al(P)){const A=I.kind===0?YA(S,I.fieldPath,S.endAt):QA(S,I.fieldPath,S.endAt);T.push(A.value),N&&(N=A.inclusive)}return new Xa(T,N)}(c,l),v=this.On(l,c,m),g=this.On(l,c,p),E=this.Nn(l,c,h),b=this.Bn(l.indexId,u,v,m.inclusive,g,p.inclusive,E);return U.forEach(b,_=>r.Y(_,n.limit).next(S=>{S.forEach(P=>{const T=we.fromSegments(P.documentKey);o.has(T)||(o=o.add(T),a.push(T))})}))}).next(()=>a)}return U.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=FK(fn.create(e.filters,"and")).map(r=>B0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,i.length),c=l/(n!=null?n.length:1),u=[];for(let h=0;h<l;++h){const m=n?this.Ln(n[h/c]):np,p=this.kn(e,m,r[h%c],s),v=this.qn(e,m,i[h%c],o),g=a.map(E=>this.kn(e,m,E,!0));u.push(...this.createRange(p,v,g))}return u}kn(e,n,r,s){const i=new Dl(e,we.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new Dl(e,we.empty(),n,r);return s?i.An():i}xn(e,n){const r=new p1(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return U.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new gn(On.comparator),u=!1;for(const h of l.filters)for(const m of h.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?u=!0:c=c.add(m.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(u?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new uh;for(const s of Al(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);kl.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new uh;return kl.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new uh;return kl.Kt.Dt(uc(this.databaseId,n),r.Pn(function(i){const o=Al(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new uh);let i=0;for(const o of Al(e)){const a=r[i++];for(const l of s)if(this.Un(n,o.fieldPath)&&Of(a))s=this.Kn(s,o,a);else{const c=l.Pn(o.kind);kl.Kt.Dt(a,c)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new uh;l.seed(a.un()),kl.Kt.Dt(o,l.Pn(n.kind)),i.push(l)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof Ht&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=dh(e),s=Fc(e);return(n?r.J(L0,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return U.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(u,h){const m=h?new Zu(h.sequenceNumber,new js(pc(h.readTime),new we(zi(h.documentKey)),h.largestBatchId)):Zu.empty(),p=u.fields.map(([v,g])=>new Jl(On.fromServerFormat(v),g));return new Xu(u.indexId,u.collectionGroup,p,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:pt(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=dh(e),i=Fc(e);return this.Gn(e).next(o=>s.J(L0,IDBKeyRange.bound(n,n)).next(a=>U.forEach(a,l=>i.put(c1(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return U.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?U.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),U.forEach(a,l=>this.zn(e,s,l).next(c=>{const u=this.jn(i,l);return c.isEqual(u)?U.resolve():this.Jn(e,i,l,c,u)}))))})}Hn(e,n,r,s){return jc(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return jc(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=jc(e);let i=new gn(Jo);return s.ee({index:oO,range:IDBKeyRange.only([r.indexId,this.uid,Kp(this.$n(r,n))])},(o,a)=>{i=i.add(new Dl(r.indexId,n,m1(a.arrayValue),m1(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new gn(Jo);const s=this.Qn(n,e);if(s==null)return r;const i=D0(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Of(o))for(const a of o.arrayValue.values||[])r=r.add(new Dl(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new Dl(n.indexId,e.key,np,s));return r}Jn(e,n,r,s,i){ce(y1,"Updating index entries for document '%s'",n.key);const o=[];return function(l,c,u,h,m){const p=l.getIterator(),v=c.getIterator();let g=Mc(p),E=Mc(v);for(;g||E;){let b=!1,_=!1;if(g&&E){const S=u(g,E);S<0?_=!0:S>0&&(b=!0)}else g!=null?_=!0:b=!0;b?(h(E),E=Mc(v)):_?(m(g),g=Mc(p)):(g=Mc(p),E=Mc(v))}}(s,i,Jo,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),U.waitFor(o)}Gn(e){let n=1;return Fc(e).ee({index:iO,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Jo(o,a)).filter((o,a,l)=>!a||Jo(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Jo(o,e),l=Jo(o,n);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(o),s.push(o.An());else if(l>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,np,we.empty()),l=s[o+1].Vn(this.uid,np,we.empty());i.push(IDBKeyRange.bound(a,l))}return i}Zn(e,n){return Jo(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(w1)}getMinOffset(e,n){return U.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||Me(44426))).next(w1)}}function v1(t){return Er(t,Cf)}function jc(t){return Er(t,qh)}function dh(t){return Er(t,XE)}function Fc(t){return Er(t,Wh)}function w1(t){Je(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;QE(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new js(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mL=41943040;class Gr{static withCacheSize(e){return new Gr(e,Gr.DEFAULT_COLLECTION_PERCENTILE,Gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pL(t,e,n){const r=t.store(li),s=t.store(ed),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(u,h,m)=>(a++,m.delete()));i.push(l.next(()=>{Je(a===1,47070,{batchId:n.batchId})}));const c=[];for(const u of n.mutations){const h=nO(e,u.key.path,n.batchId);i.push(s.delete(h)),c.push(u.key)}return U.waitFor(i).next(()=>c)}function ey(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Me(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gr.DEFAULT_COLLECTION_PERCENTILE=10,Gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Gr.DEFAULT=new Gr(mL,Gr.DEFAULT_COLLECTION_PERCENTILE,Gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Gr.DISABLED=new Gr(-1,0,0);class wv{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){Je(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new wv(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Xo(e).ee({index:Bl,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Yc(e),o=Xo(e);return o.add({}).next(a=>{Je(typeof a=="number",49019);const l=new lS(a,n,r,s),c=function(p,v,g){const E=g.baseMutations.map(_=>Vf(p.yt,_)),b=g.mutations.map(_=>Vf(p.yt,_));return{userId:v,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:E,mutations:b}}(this.serializer,this.userId,l),u=[];let h=new gn((m,p)=>pt(m.canonicalString(),p.canonicalString()));for(const m of s){const p=nO(this.userId,m.key.path,a);h=h.add(m.key.path.popLast()),u.push(o.put(c)),u.push(i.put(p,EH))}return h.forEach(m=>{u.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),U.waitFor(u).next(()=>l)})}lookupMutationBatch(e,n){return Xo(e).get(n).next(r=>r?(Je(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Nl(this.serializer,r)):null)}er(e,n){return this.Xn[n]?U.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Xo(e).ee({index:Bl,range:s},(o,a,l)=>{a.userId===this.userId&&(Je(a.batchId>=r,47524,{tr:r}),i=Nl(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=$a;return Xo(e).ee({index:Bl,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,$a],[this.userId,Number.POSITIVE_INFINITY]);return Xo(e).J(Bl,n).next(r=>r.map(s=>Nl(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Up(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Yc(e).ee({range:s},(o,a,l)=>{const[c,u,h]=o,m=zi(u);if(c===this.userId&&n.path.isEqual(m))return Xo(e).get(h).next(p=>{if(!p)throw Me(61480,{nr:o,batchId:h});Je(p.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:p.userId,batchId:h}),i.push(Nl(this.serializer,p))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new gn(pt);const s=[];return n.forEach(i=>{const o=Up(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=Yc(e).ee({range:a},(c,u,h)=>{const[m,p,v]=c,g=zi(p);m===this.userId&&i.path.isEqual(g)?r=r.add(v):h.done()});s.push(l)}),U.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Up(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new gn(pt);return Yc(e).ee({range:o},(l,c,u)=>{const[h,m,p]=l,v=zi(m);h===this.userId&&r.isPrefixOf(v)?v.length===s&&(a=a.add(p)):u.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Xo(e).get(i).next(o=>{if(o===null)throw Me(35274,{batchId:i});Je(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(Nl(this.serializer,o))}))}),U.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return pL(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),U.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return U.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Yc(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=zi(i[1]);s.push(l)}else a.done()}).next(()=>{Je(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return gL(e,this.userId,n)}_r(e){return yL(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:$a,lastStreamToken:""})}}function gL(t,e,n){const r=Up(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Yc(t).ee({range:i,X:!0},(a,l,c)=>{const[u,h,m]=a;u===e&&h===s&&(o=!0),c.done()}).next(()=>o)}function Xo(t){return Er(t,li)}function Yc(t){return Er(t,ed)}function yL(t){return Er(t,Pf)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new gc(0)}static cr(){return new gc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BK{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new gc(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>ot.fromTimestamp(new sn(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Uc(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(Je(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Uc(e).ee((o,a)=>{const l=xh(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>U.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Uc(e).ee((r,s)=>{const i=xh(s);n(i)})}lr(e){return b1(e).get(Gg).next(n=>(Je(n!==null,2888),n))}hr(e,n){return b1(e).put(Gg,n)}Pr(e,n){return Uc(e).put(dL(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=dc(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Uc(e).ee({range:s,index:sO},(o,a,l)=>{const c=xh(a);am(n,c.target)&&(i=c,l.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=pa(e);return n.forEach(o=>{const a=Yr(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),U.waitFor(s)}removeMatchingKeys(e,n,r){const s=pa(e);return U.forEach(n,i=>{const o=Yr(i.path);return U.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=pa(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=pa(e);let i=At();return s.ee({range:r,X:!0},(o,a,l)=>{const c=zi(o[1]),u=new we(c);i=i.add(u)}).next(()=>i)}containsKey(e,n){const r=Yr(n.path),s=IDBKeyRange.bound([r],[H2(r)],!1,!0);let i=0;return pa(e).ee({index:JE,X:!0,range:s},([o,a],l,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}At(e,n){return Uc(e).get(n).next(r=>r?xh(r):null)}}function Uc(t){return Er(t,td)}function b1(t){return Er(t,Xl)}function pa(t){return Er(t,nd)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1="LruGarbageCollector",vL=1048576;function S1([t,e],[n,r]){const s=pt(t,n);return s===0?pt(e,r):s}class zK{constructor(e){this.Ir=e,this.buffer=new gn(S1),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();S1(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class wL{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ce(E1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){hl(n)?ce(E1,"Ignoring IndexedDB error during garbage collection: ",n):await dl(n)}await this.Vr(3e5)})}}class WK{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return U.resolve(ps.ce);const r=new zK(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ce("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(_1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_1):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),Kc()<=Wt.DEBUG&&ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function _L(t,e){return new WK(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qK{constructor(e,n){this.db=e,this.garbageCollector=_L(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return rp(e,r)}removeReference(e,n,r){return rp(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return rp(e,n)}br(e,n){return function(s,i){let o=!1;return yL(s).te(a=>gL(s,a,i).next(l=>(l&&(o=!0),U.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ot.min()),pa(e).delete(function(h){return[0,Yr(h.path)]}(o))))});s.push(l)}}).next(()=>U.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return rp(e,n)}Sr(e,n){const r=pa(e);let s,i=ps.ce;return r.ee({index:JE},([o,a],{path:l,sequenceNumber:c})=>{o===0?(i!==ps.ce&&n(new we(zi(s)),i),i=c,s=l):i=ps.ce}).next(()=>{i!==ps.ce&&n(new we(zi(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function rp(t,e){return pa(t).put(function(r,s){return{targetId:0,path:Yr(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(){this.changes=new Uo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Dn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HK{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return El(e).put(r)}removeEntry(e,n,r){return El(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Xg(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=Dn.newInvalidDocument(n);return El(e).ee({index:$p,range:IDBKeyRange.only(hh(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:Dn.newInvalidDocument(n)};return El(e).ee({index:$p,range:IDBKeyRange.only(hh(n))},(s,i)=>{r={document:this.Cr(n,i),size:ey(i)}}).next(()=>r)}getEntries(e,n){let r=ys();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=ys(),s=new An(we.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,ey(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return U.resolve();let s=new gn(x1);n.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(hh(s.first()),hh(s.last())),o=s.getIterator();let a=o.getNext();return El(e).ee({index:$p,range:i},(l,c,u)=>{const h=we.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&x1(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?u.j(hh(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Xg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return El(e).J(IDBKeyRange.bound(a,l,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let u=ys();for(const h of c){const m=this.Cr(we.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);m.isFoundDocument()&&(cm(n,m)||s.has(m.key))&&(u=u.insert(m.key,m))}return u})}getAllFromCollectionGroup(e,n,r,s){let i=ys();const o=T1(n,r),a=T1(n,js.max());return El(e).ee({index:rO,range:IDBKeyRange.bound(o,a,!0)},(l,c,u)=>{const h=this.Cr(we.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(h.key,h),i.size===s&&u.done()}).next(()=>i)}newChangeBuffer(e){return new KK(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return I1(e).get(O0).next(n=>(Je(!!n,20021),n))}Dr(e,n){return I1(e).put(O0,n)}Cr(e,n){if(n){const r=kK(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ot.min())))return r}return Dn.newInvalidDocument(e)}}function EL(t){return new HK(t)}class KK extends bL{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new Uo(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new gn((i,o)=>pt(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=a1(this.Nr.serializer,o);s=s.add(i.path.popLast());const c=ey(l);r+=c-a.size,n.push(this.Nr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=a1(this.Nr.serializer,o.convertToNoDocument(ot.min()));n.push(this.Nr.addEntry(e,i,l))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),U.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function I1(t){return Er(t,Rf)}function El(t){return Er(t,Kg)}function hh(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function T1(t,e){const n=e.documentKey.path.toArray();return[t,Xg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function x1(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=pt(n[i],r[i]),s)return s;return s=pt(n.length,r.length),s||(s=pt(n[n.length-2],r[r.length-2]),s||pt(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GK{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Gh(r.mutation,s,gs.empty(),sn.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,At()).next(()=>r))}getLocalViewOfDocuments(e,n,r=At()){const s=Wi();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ih();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Wi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,At()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=ys();const o=Kh(),a=function(){return Kh()}();return n.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof $o)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),Gh(u.mutation,c,u.mutation.getFieldMask(),sn.now())):o.set(c.key,gs.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>a.set(c,new GK(u,o.get(c)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Kh();let s=new An((o,a)=>o-a),i=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||gs.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(s.get(a.batchId)||At()).add(l);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=jO();u.forEach(m=>{if(!i.has(m)){const p=qO(n.get(m),r.get(m));p!==null&&h.set(m,p),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return we.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):sS(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(Wi());let a=Ju,l=i;return o.next(c=>U.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?U.resolve():this.remoteDocumentCache.getEntry(e,u).next(m=>{l=l.insert(u,m)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,At())).next(u=>({batchId:a,changes:VO(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new we(n)).next(r=>{let s=Ih();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Ih();return this.indexManager.getCollectionParents(e,i).next(a=>U.forEach(a,l=>{const c=function(h,m){return new Fo(m,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(u=>{u.forEach((h,m)=>{o=o.insert(h,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Dn.newInvalidDocument(u)))});let a=Ih();return o.forEach((l,c)=>{const u=i.get(l);u!==void 0&&Gh(u.mutation,c,gs.empty(),sn.now()),cm(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QK{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return U.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:ur(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:yv(s.bundledQuery),readTime:ur(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YK{constructor(){this.overlays=new An(we.comparator),this.qr=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Wi();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=Wi(),i=n.length+1,o=new we(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new An((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=Wi(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=Wi(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return U.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new uS(n,r));let i=this.qr.get(n);i===void 0&&(i=At(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JK{constructor(){this.sessionToken=Yn.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(){this.Qr=new gn(Pr.$r),this.Ur=new gn(Pr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Pr(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Pr(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new we(new Ft([])),r=new Pr(n,e),s=new Pr(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new we(new Ft([])),r=new Pr(n,e),s=new Pr(n,e+1);let i=At();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Pr(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Pr{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return we.comparator(e.key,n.key)||pt(e.Yr,n.Yr)}static Kr(e,n){return pt(e.Yr,n.Yr)||we.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XK{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new gn(Pr.$r)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new lS(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new Pr(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?$a:this.tr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Pr(n,0),s=new Pr(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new gn(pt);return n.forEach(s=>{const i=new Pr(s,0),o=new Pr(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),U.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;we.isDocumentKey(i)||(i=i.child(""));const o=new Pr(new we(i),0);let a=new gn(pt);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Yr)),!0)},o),U.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Je(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return U.forEach(n.mutations,s=>{const i=new Pr(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Pr(n,0),s=this.Zr.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZK{constructor(e){this.ri=e,this.docs=function(){return new An(we.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():Dn.newInvalidDocument(n))}getEntries(e,n){let r=ys();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Dn.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=ys();const o=n.path,a=new we(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||QE(J2(u),r)<=0||(s.has(u.key)||cm(n,u))&&(i=i.insert(u.key,u.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Me(9500)}ii(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new eG(this)}getSize(e){return U.resolve(this.size)}}class eG extends bL{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tG{constructor(e){this.persistence=e,this.si=new Uo(n=>dc(n),am),this.lastRemoteSnapshotVersion=ot.min(),this.highestTargetId=0,this.oi=0,this._i=new pS,this.targetCount=0,this.ai=gc.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),U.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new gc(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Pr(n),U.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e,n){this.ui={},this.overlays={},this.ci=new ps(0),this.li=!1,this.li=!0,this.hi=new JK,this.referenceDelegate=e(this),this.Pi=new tG(this),this.indexManager=new UK,this.remoteDocumentCache=function(s){return new ZK(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new uL(n),this.Ii=new QK(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new YK,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new XK(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ce("MemoryPersistence","Starting transaction:",e);const s=new nG(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return U.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class nG extends Z2{constructor(e){super(),this.currentSequenceNumber=e}}class _v{constructor(e){this.persistence=e,this.Ri=new pS,this.Vi=null}static mi(e){return new _v(e)}get fi(){if(this.Vi)return this.Vi;throw Me(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),U.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.fi,r=>{const s=we.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,ot.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return U.or([()=>U.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class ty{constructor(e,n){this.persistence=e,this.pi=new Uo(r=>Yr(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=_L(this,n)}static mi(e,n){return new ty(e,n)}Ei(){}di(e){return U.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return U.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?U.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,ot.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=zp(e.data.value)),n}br(e,n,r){return U.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return U.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rG{constructor(e){this.serializer=e}k(e,n,r,s){const i=new ov("createOrUpgrade",n);r<1&&s>=1&&(function(l){l.createObjectStore(om)}(e),function(l){l.createObjectStore(Pf,{keyPath:bH}),l.createObjectStore(li,{keyPath:VA,autoIncrement:!0}).createIndex(Bl,jA,{unique:!0}),l.createObjectStore(ed)}(e),A1(e),function(l){l.createObjectStore(Pl)}(e));let o=U.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore(nd),l.deleteObjectStore(td),l.deleteObjectStore(Xl)}(e),A1(e)),o=o.next(()=>function(l){const c=l.store(Xl),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ot.min().toTimestamp(),targetCount:0};return c.put(Gg,u)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store(li).J().next(h=>{l.deleteObjectStore(li),l.createObjectStore(li,{keyPath:VA,autoIncrement:!0}).createIndex(Bl,jA,{unique:!0});const m=c.store(li),p=h.map(v=>m.put(v));return U.waitFor(p)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore(rd,{keyPath:CH})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(Rf)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(av,{keyPath:NH})})(e),function(l){l.createObjectStore(lv,{keyPath:kH})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore(cv,{keyPath:FH});c.createIndex(M0,UH,{unique:!1}),c.createIndex(aO,$H,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore(Kg,{keyPath:SH});c.createIndex($p,IH),c.createIndex(rO,TH)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(Pl))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore(XE,{keyPath:DH,autoIncrement:!0}).createIndex(L0,OH,{unique:!1}),l.createObjectStore(Wh,{keyPath:LH}).createIndex(iO,MH,{unique:!1}),l.createObjectStore(qh,{keyPath:VH}).createIndex(oO,jH,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(Wh).clear()}).next(()=>{n.objectStore(qh).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(ZE,{keyPath:BH})})(e)})),r<18&&s>=18&&UD()&&(o=o.next(()=>{n.objectStore(Wh).clear()}).next(()=>{n.objectStore(qh).clear()})),o}wi(e){let n=0;return e.store(Pl).ee((r,s)=>{n+=ey(s)}).next(()=>{const r={byteSize:n};return e.store(Rf).put(O0,r)})}yi(e){const n=e.store(Pf),r=e.store(li);return n.J().next(s=>U.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,$a],[i.userId,i.lastAcknowledgedBatchId]);return r.J(Bl,o).next(a=>U.forEach(a,l=>{Je(l.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=Nl(this.serializer,l);return pL(e,i.userId,c).next(()=>{})}))}))}Si(e){const n=e.store(nd),r=e.store(Pl);return e.store(Xl).get(Gg).next(s=>{const i=[];return r.ee((o,a)=>{const l=new Ft(o),c=function(h){return[0,Yr(h)]}(l);i.push(n.get(c).next(u=>u?U.resolve():(h=>n.put({targetId:0,path:Yr(h),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>U.waitFor(i))})}bi(e,n){e.createObjectStore(Cf,{keyPath:RH});const r=n.store(Cf),s=new mS,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Yr(l)})}};return n.store(Pl).ee({X:!0},(o,a)=>{const l=new Ft(o);return i(l.popLast())}).next(()=>n.store(ed).ee({X:!0},([o,a,l],c)=>{const u=zi(a);return i(u.popLast())}))}Di(e){const n=e.store(td);return n.ee((r,s)=>{const i=xh(s),o=dL(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store(Pl),s=[];return r.ee((i,o)=>{const a=n.store(Kg),l=function(h){return h.document?new we(Ft.fromString(h.document.name).popFirst(5)):h.noDocument?we.fromSegments(h.noDocument.path):h.unknownDocument?we.fromSegments(h.unknownDocument.path):Me(36783)}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>U.waitFor(s))}Fi(e,n){const r=n.store(li),s=EL(this.serializer),i=new gS(_v.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let c=a.get(l.userId)??At();Nl(this.serializer,l).keys().forEach(u=>c=c.add(u)),a.set(l.userId,c)}),U.forEach(a,(l,c)=>{const u=new Cr(c),h=vv.wt(this.serializer,u),m=i.getIndexManager(u),p=wv.wt(u,this.serializer,m,i.referenceDelegate);return new SL(s,p,h,m).recalculateAndSaveOverlaysForDocumentKeys(new V0(n,ps.ce),l).next()})})}}function A1(t){t.createObjectStore(nd,{keyPath:AH}).createIndex(JE,PH,{unique:!0}),t.createObjectStore(td,{keyPath:"targetId"}).createIndex(sO,xH,{unique:!0}),t.createObjectStore(Xl)}const Zo="IndexedDbPersistence",Fw=18e5,Uw=5e3,$w="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",IL="main";class yS{constructor(e,n,r,s,i,o,a,l,c,u,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=c,this.Oi=u,this.Ni=h,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!yS.v())throw new ie(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new qK(this,s),this.$i=n+IL,this.serializer=new uL(l),this.Ui=new Ji(this.$i,this.Ni,new rG(this.serializer)),this.hi=new OK,this.Pi=new BK(this.referenceDelegate,this.serializer),this.remoteDocumentCache=EL(this.serializer),this.Ii=new DK,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,u===!1&&lr(Zo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ie(B.FAILED_PRECONDITION,$w);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new ps(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>sp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(hl(e))return ce(Zo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ce(Zo,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return fh(e).get(Lc).next(n=>U.resolve(this.es(n)))}ts(e){return sp(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Fw)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Er(n,rd);return r.J().next(s=>{const i=this.ss(s,Fw),o=s.filter(a=>i.indexOf(a)===-1);return U.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?U.resolve(!0):fh(e).get(Lc).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Uw)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new ie(B.FAILED_PRECONDITION,$w);return!1}}return!(!this.networkEnabled||!this.inForeground)||sp(e).J().next(r=>this.ss(r,Uw).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&ce(Zo,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[om,rd],e=>{const n=new V0(e,ps.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>sp(e).J().next(n=>this.ss(n,Fw).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return wv.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new $K(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vv.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){ce(Zo,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(l){return l===18?qH:l===17?dO:l===16?WH:l===15?eS:l===14?uO:l===13?cO:l===12?zH:l===11?lO:void Me(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new V0(a,this.ci?this.ci.next():ps.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw lr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new ie(B.FAILED_PRECONDITION,X2);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return fh(e).get(Lc).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Uw)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ie(B.FAILED_PRECONDITION,$w)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return fh(e).put(Lc,n)}static v(){return Ji.v()}Zi(e){const n=fh(e);return n.get(Lc).next(r=>this.es(r)?(ce(Zo,"Releasing primary lease."),n.delete(Lc)):U.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(lr(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;FD()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return ce(Zo,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return lr(Zo,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){lr("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function fh(t){return Er(t,om)}function sp(t){return Er(t,rd)}function vS(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=At(),s=At();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new wS(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return FD()?8:eO(_r())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new sG;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Kc()<=Wt.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",Gc(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),U.resolve()):(Kc()<=Wt.DEBUG&&ce("QueryEngine","Query:",Gc(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Kc()<=Wt.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",Gc(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jr(n))):U.resolve())}ys(e,n){if(JA(n))return U.resolve(null);let r=Jr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Jg(n,null,"F"),r=Jr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=At(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.Ds(n,a);return this.Cs(n,c,o,l.readTime)?this.ys(e,Jg(n,null,"F")):this.vs(e,c,n,l)}))})))}ws(e,n,r,s){return JA(n)||s.isEqual(ot.min())?U.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?U.resolve(null):(Kc()<=Wt.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Gc(n)),this.vs(e,o,n,Y2(s,Ju)).next(a=>a))})}Ds(e,n){let r=new gn(LO(e));return n.forEach((s,i)=>{cm(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return Kc()<=Wt.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",Gc(n)),this.ps.getDocumentsMatchingQuery(e,n,js.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S="LocalStore",iG=3e8;class oG{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new An(pt),this.xs=new Uo(i=>dc(i),am),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new SL(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function xL(t,e,n,r){return new oG(t,e,n,r)}async function AL(t,e){const n=Ee(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=At();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Ls:c,removedBatchIds:o,addedBatchIds:a}))})})}function aG(t,e){const n=Ee(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const h=c.batch,m=h.keys();let p=U.resolve();return m.forEach(v=>{p=p.next(()=>u.getEntry(l,v)).next(g=>{const E=c.docVersions.get(v);Je(E!==null,48541),g.version.compareTo(E)<0&&(h.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),u.addEntry(g)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=At();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function PL(t){const e=Ee(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function lG(t,e){const n=Ee(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((u,h)=>{const m=s.get(h);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.Pi.addMatchingKeys(i,u.addedDocuments,h)));let p=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Yn.EMPTY_BYTE_STRING,ot.min()).withLastLimboFreeSnapshotVersion(ot.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,r)),s=s.insert(h,p),function(g,E,b){return g.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=iG?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(m,p,u)&&a.push(n.Pi.updateTargetData(i,p))});let l=ys(),c=At();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(RL(i,o,e.documentUpdates).next(u=>{l=u.ks,c=u.qs})),!r.isEqual(ot.min())){const u=n.Pi.getLastRemoteSnapshotVersion(i).next(h=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return U.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.Ms=s,i))}function RL(t,e,n){let r=At(),s=At();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=ys();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(ot.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ce(_S,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{ks:o,qs:s}})}function cG(t,e){const n=Ee(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=$a),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ud(t,e){const n=Ee(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new _o(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function dd(t,e,n){const r=Ee(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!hl(o))throw o;ce(_S,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function ny(t,e,n){const r=Ee(t);let s=ot.min(),i=At();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const h=Ee(l),m=h.xs.get(u);return m!==void 0?U.resolve(h.Ms.get(m)):h.Pi.getTargetData(c,u)}(r,o,Jr(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:ot.min(),n?i:At())).next(a=>(kL(r,OO(e),a),{documents:a,Qs:i})))}function CL(t,e){const n=Ee(t),r=Ee(n.Pi),s=n.Ms.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.At(i,e).next(o=>o?o.target:null))}function NL(t,e){const n=Ee(t),r=n.Os.get(e)||ot.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.Ns.getAllFromCollectionGroup(s,e,Y2(r,Ju),Number.MAX_SAFE_INTEGER)).then(s=>(kL(n,e,s),s))}function kL(t,e,n){let r=t.Os.get(e)||ot.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}async function uG(t,e,n,r){const s=Ee(t);let i=At(),o=ys();for(const c of n){const u=e.$s(c.metadata.name);c.document&&(i=i.add(u));const h=e.Us(c);h.setReadTime(e.Ks(c.metadata.readTime)),o=o.insert(u,h)}const a=s.Ns.newChangeBuffer({trackRemovals:!0}),l=await ud(s,function(u){return Jr(Od(Ft.fromString(`__bundle__/docs/${u}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",c=>RL(c,a,o).next(u=>(a.apply(c),u)).next(u=>s.Pi.removeMatchingKeysForTargetId(c,l.targetId).next(()=>s.Pi.addMatchingKeys(c,i,l.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(c,u.ks,u.qs)).next(()=>u.ks)))}async function dG(t,e,n=At()){const r=await ud(t,Jr(yv(e.bundledQuery))),s=Ee(t);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=ur(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Ii.saveNamedQuery(i,e);const a=r.withResumeToken(Yn.EMPTY_BYTE_STRING,o);return s.Ms=s.Ms.insert(a.targetId,a),s.Pi.updateTargetData(i,a).next(()=>s.Pi.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Pi.addMatchingKeys(i,n,r.targetId)).next(()=>s.Ii.saveNamedQuery(i,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DL="firestore_clients";function P1(t,e){return`${DL}_${t}_${e}`}const OL="firestore_mutations";function R1(t,e,n){let r=`${OL}_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const LL="firestore_targets";function Bw(t,e){return`${LL}_${t}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji="SharedClientState";class ry{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Ws(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new ie(s.error.code,s.error.message))),o?new ry(e,n,s.state,i):(lr(ji,`Failed to parse mutation state for ID '${n}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Yh{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ws(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new ie(r.error.code,r.error.message))),i?new Yh(e,r.state,s):(lr(ji,`Failed to parse target state for ID '${e}': ${n}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class sy{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ws(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=iS();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=tO(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new sy(e,i):(lr(ji,`Failed to parse client data for instance '${e}': ${n}`),null)}}class bS{constructor(e,n){this.clientId=e,this.onlineState=n}static Ws(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new bS(n.clientId,n.onlineState):(lr(ji,`Failed to parse online state: ${e}`),null)}}class J0{constructor(){this.activeTargetIds=iS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class zw{constructor(e,n,r,s,i){this.window=e,this.Mi=n,this.persistenceKey=r,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new An(pt),this.started=!1,this.Xs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.eo=P1(this.persistenceKey,this.Js),this.no=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new J0),this.ro=new RegExp(`^${DL}_${o}_([^_]*)$`),this.io=new RegExp(`^${OL}_${o}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${LL}_${o}_(\\d+)$`),this.oo=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this._o=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const s=this.getItem(P1(this.persistenceKey,r));if(s){const i=sy.Ws(r,s);i&&(this.Zs=this.Zs.insert(i.clientId,i))}}this.ao();const n=this.storage.getItem(this.oo);if(n){const r=this.uo(n);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let n=!1;return this.Zs.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,n,r){this.ho(e,n,r),this.Po(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Bw(this.persistenceKey,e));if(s){const i=Yh.Ws(e,s);i&&(r=i.state)}}return n&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Bw(this.persistenceKey,e))}updateQueryState(e,n,r){this.Io(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Po(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return ce(ji,"READ",e,n),n}setItem(e,n){ce(ji,"SET",e,n),this.storage.setItem(e,n)}removeItem(e){ce(ji,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const n=e;if(n.storageArea===this.storage){if(ce(ji,"EVENT",n.key,n.newValue),n.key===this.eo)return void lr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.ro.test(n.key)){if(n.newValue==null){const r=this.Ro(n.key);return this.Vo(r,null)}{const r=this.mo(n.key,n.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(n.key)){if(n.newValue!==null){const r=this.fo(n.key,n.newValue);if(r)return this.po(r)}}else if(this.so.test(n.key)){if(n.newValue!==null){const r=this.yo(n.key,n.newValue);if(r)return this.wo(r)}}else if(n.key===this.oo){if(n.newValue!==null){const r=this.uo(n.newValue);if(r)return this.co(r)}}else if(n.key===this.no){const r=function(i){let o=ps.ce;if(i!=null)try{const a=JSON.parse(i);Je(typeof a=="number",30636,{So:i}),o=a}catch(a){lr(ji,"Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==ps.ce&&this.sequenceNumberHandler(r)}else if(n.key===this._o){const r=this.bo(n.newValue);await Promise.all(r.map(s=>this.syncEngine.Do(s)))}}}else this.Xs.push(n)})}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,n,r){const s=new ry(this.currentUser,e,n,r),i=R1(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Gs())}Po(e){const n=R1(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Eo(e){const n={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(n))}Io(e,n,r){const s=Bw(this.persistenceKey,e),i=new Yh(e,n,r);this.setItem(s,i.Gs())}Ao(e){const n=JSON.stringify(Array.from(e));this.setItem(this._o,n)}Ro(e){const n=this.ro.exec(e);return n?n[1]:null}mo(e,n){const r=this.Ro(e);return sy.Ws(r,n)}fo(e,n){const r=this.io.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return ry.Ws(new Cr(i),s,n)}yo(e,n){const r=this.so.exec(e),s=Number(r[1]);return Yh.Ws(s,n)}uo(e){return bS.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ce(ji,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,n){const r=n?this.Zs.insert(e,n):this.Zs.remove(e),s=this.lo(this.Zs),i=this.lo(r),o=[],a=[];return i.forEach(l=>{s.has(l)||o.push(l)}),s.forEach(l=>{i.has(l)||a.push(l)}),this.syncEngine.Fo(o,a).then(()=>{this.Zs=r})}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let n=iS();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class ML{constructor(){this.Mo=new J0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new J0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hG{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1="ConnectivityMonitor";class N1{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ce(C1,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ce(C1,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ip=null;function X0(){return ip===null?ip=function(){return 268435456+Math.round(2147483648*Math.random())}():ip++,"0x"+ip.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww="RestConnection",fG={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class mG{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===kf?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=X0(),a=this.zo(e,n.toUriEncodedString());ce(Ww,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:c}=new URL(a),u=Ti(c);return this.Jo(e,a,l,r,u).then(h=>(ce(Ww,`Received RPC '${e}' ${o}: `,h),h),h=>{throw Vs(Ww,`RPC '${e}' ${o} failed with error: `,h,"url: ",a,"request:",r),h})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Dd}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=fG[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pG{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hr="WebChannelConnection";class gG extends mG{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=X0();return new Promise((a,l)=>{const c=new V2;c.setWithCredentials(!0),c.listenOnce(j2.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Fp.NO_ERROR:const h=c.getResponseJson();ce(Hr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),a(h);break;case Fp.TIMEOUT:ce(Hr,`RPC '${e}' ${o} timed out`),l(new ie(B.DEADLINE_EXCEEDED,"Request time out"));break;case Fp.HTTP_ERROR:const m=c.getStatus();if(ce(Hr,`RPC '${e}' ${o} failed with status:`,m,"response text:",c.getResponseText()),m>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const v=p==null?void 0:p.error;if(v&&v.status&&v.message){const g=function(b){const _=b.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(_)>=0?_:B.UNKNOWN}(v.status);l(new ie(g,v.message))}else l(new ie(B.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ie(B.UNAVAILABLE,"Connection failed."));break;default:Me(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{ce(Hr,`RPC '${e}' ${o} completed.`)}});const u=JSON.stringify(s);ce(Hr,`RPC '${e}' ${o} sending request:`,s),c.send(n,"POST",u,r,15)})}T_(e,n,r){const s=X0(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=$2(),a=U2(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const u=i.join("");ce(Hr,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=o.createWebChannel(u,l);this.I_(h);let m=!1,p=!1;const v=new pG({Yo:E=>{p?ce(Hr,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(m||(ce(Hr,`Opening RPC '${e}' stream ${s} transport.`),h.open(),m=!0),ce(Hr,`RPC '${e}' stream ${s} sending:`,E),h.send(E))},Zo:()=>h.close()}),g=(E,b,_)=>{E.listen(b,S=>{try{_(S)}catch(P){setTimeout(()=>{throw P},0)}})};return g(h,Sh.EventType.OPEN,()=>{p||(ce(Hr,`RPC '${e}' stream ${s} transport opened.`),v.o_())}),g(h,Sh.EventType.CLOSE,()=>{p||(p=!0,ce(Hr,`RPC '${e}' stream ${s} transport closed`),v.a_(),this.E_(h))}),g(h,Sh.EventType.ERROR,E=>{p||(p=!0,Vs(Hr,`RPC '${e}' stream ${s} transport errored. Name:`,E.name,"Message:",E.message),v.a_(new ie(B.UNAVAILABLE,"The operation could not be completed")))}),g(h,Sh.EventType.MESSAGE,E=>{var b;if(!p){const _=E.data[0];Je(!!_,16349);const S=_,P=(S==null?void 0:S.error)||((b=S[0])==null?void 0:b.error);if(P){ce(Hr,`RPC '${e}' stream ${s} received error:`,P);const T=P.status;let N=function(R){const k=hr[R];if(k!==void 0)return QO(k)}(T),I=P.message;N===void 0&&(N=B.INTERNAL,I="Unknown error status: "+T+" with message "+P.message),p=!0,v.a_(new ie(N,I)),h.close()}else ce(Hr,`RPC '${e}' stream ${s} received:`,_),v.u_(_)}}),g(a,F2.STAT_EVENT,E=>{E.stat===R0.PROXY?ce(Hr,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===R0.NOPROXY&&ce(Hr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{v.__()},0),v}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VL(){return typeof window<"u"?window:null}function Gp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rc(t){return new EK(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&ce("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="PersistentStream";class jL{constructor(e,n,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ES(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(lr(n.toString()),lr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new ie(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ce(k1,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ce(k1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class yG extends jL{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=TK(this.serializer,e),r=function(i){if(!("targetChange"in i))return ot.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ot.min():o.readTime?ur(o.readTime):ot.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=H0(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=Qg(l)?{documents:sL(i,l)}:{query:gv(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=ZO(i,o.resumeToken);const c=W0(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ot.min())>0){a.readTime=cd(i,o.snapshotVersion.toTimestamp());const c=W0(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=AK(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=H0(this.serializer),n.removeTarget=e,this.q_(n)}}class vG extends jL{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Je(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=xK(e.writeResults,e.commitTime),r=ur(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=H0(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Vf(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wG{}class _G extends wG{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ie(B.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,q0(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ie(B.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,q0(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ie(B.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class bG{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(lr(n),this.aa=!1):ce("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yc="RemoteStore";class EG{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ml(this)&&(ce(yc,"Restarting streams for network reachability change."),await async function(l){const c=Ee(l);c.Ea.add(4),await Vd(c),c.Ra.set("Unknown"),c.Ea.delete(4),await fm(c)}(this))})}),this.Ra=new bG(r,s)}}async function fm(t){if(ml(t))for(const e of t.da)await e(!0)}async function Vd(t){for(const e of t.da)await e(!1)}function bv(t,e){const n=Ee(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),TS(n)?IS(n):Fd(n).O_()&&SS(n,e))}function hd(t,e){const n=Ee(t),r=Fd(n);n.Ia.delete(e),r.O_()&&FL(n,e),n.Ia.size===0&&(r.O_()?r.L_():ml(n)&&n.Ra.set("Unknown"))}function SS(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ot.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fd(t).Y_(e)}function FL(t,e){t.Va.Ue(e),Fd(t).Z_(e)}function IS(t){t.Va=new vK({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Fd(t).start(),t.Ra.ua()}function TS(t){return ml(t)&&!Fd(t).x_()&&t.Ia.size>0}function ml(t){return Ee(t).Ea.size===0}function UL(t){t.Va=void 0}async function SG(t){t.Ra.set("Online")}async function IG(t){t.Ia.forEach((e,n)=>{SS(t,e)})}async function TG(t,e){UL(t),TS(t)?(t.Ra.ha(e),IS(t)):t.Ra.set("Unknown")}async function xG(t,e,n){if(t.Ra.set("Online"),e instanceof XO&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){ce(yc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await iy(t,r)}else if(e instanceof Hp?t.Va.Ze(e):e instanceof JO?t.Va.st(e):t.Va.tt(e),!n.isEqual(ot.min()))try{const r=await PL(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.Ia.get(c);u&&i.Ia.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=i.Ia.get(l);if(!u)return;i.Ia.set(l,u.withResumeToken(Yn.EMPTY_BYTE_STRING,u.snapshotVersion)),FL(i,l);const h=new _o(u.target,l,c,u.sequenceNumber);SS(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ce(yc,"Failed to raise snapshot:",r),await iy(t,r)}}async function iy(t,e,n){if(!hl(e))throw e;t.Ea.add(1),await Vd(t),t.Ra.set("Offline"),n||(n=()=>PL(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ce(yc,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await fm(t)})}function $L(t,e){return e().catch(n=>iy(t,n,e))}async function jd(t){const e=Ee(t),n=Za(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:$a;for(;AG(e);)try{const s=await cG(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,PG(e,s)}catch(s){await iy(e,s)}BL(e)&&zL(e)}function AG(t){return ml(t)&&t.Ta.length<10}function PG(t,e){t.Ta.push(e);const n=Za(t);n.O_()&&n.X_&&n.ea(e.mutations)}function BL(t){return ml(t)&&!Za(t).x_()&&t.Ta.length>0}function zL(t){Za(t).start()}async function RG(t){Za(t).ra()}async function CG(t){const e=Za(t);for(const n of t.Ta)e.ea(n.mutations)}async function NG(t,e,n){const r=t.Ta.shift(),s=cS.from(r,e,n);await $L(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await jd(t)}async function kG(t,e){e&&Za(t).X_&&await async function(r,s){if(function(o){return GO(o)&&o!==B.ABORTED}(s.code)){const i=r.Ta.shift();Za(r).B_(),await $L(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await jd(r)}}(t,e),BL(t)&&zL(t)}async function D1(t,e){const n=Ee(t);n.asyncQueue.verifyOperationInProgress(),ce(yc,"RemoteStore received new credentials");const r=ml(n);n.Ea.add(3),await Vd(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await fm(n)}async function Z0(t,e){const n=Ee(t);e?(n.Ea.delete(2),await fm(n)):e||(n.Ea.add(2),await Vd(n),n.Ra.set("Unknown"))}function Fd(t){return t.ma||(t.ma=function(n,r,s){const i=Ee(n);return i.sa(),new yG(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:SG.bind(null,t),t_:IG.bind(null,t),r_:TG.bind(null,t),H_:xG.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),TS(t)?IS(t):t.Ra.set("Unknown")):(await t.ma.stop(),UL(t))})),t.ma}function Za(t){return t.fa||(t.fa=function(n,r,s){const i=Ee(n);return i.sa(),new vG(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:RG.bind(null,t),r_:kG.bind(null,t),ta:CG.bind(null,t),na:NG.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await jd(t)):(await t.fa.stop(),t.Ta.length>0&&(ce(yc,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new kr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new xS(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ie(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ud(t,e){if(lr("AsyncQueue",`${e}: ${t}`),hl(t))return new ie(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{static emptySet(e){return new Zl(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||we.comparator(n.key,r.key):(n,r)=>we.comparator(n.key,r.key),this.keyedMap=Ih(),this.sortedSet=new An(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Zl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Zl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(){this.ga=new An(we.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Me(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class vc{constructor(e,n,r,s,i,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new vc(e,n,Zl.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DG{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class OG{constructor(){this.queries=L1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=Ee(n),i=s.queries;s.queries=L1(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new ie(B.ABORTED,"Firestore shutting down"))}}function L1(){return new Uo(t=>DO(t),lm)}async function AS(t,e){const n=Ee(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new DG,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Ud(o,`Initialization of query '${Gc(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&RS(n)}async function PS(t,e){const n=Ee(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function LG(t,e){const n=Ee(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&RS(n)}function MG(t,e,n){const r=Ee(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function RS(t){t.Ca.forEach(e=>{e.next()})}var eb,M1;(M1=eb||(eb={})).Ma="default",M1.Cache="cache";class CS{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new vc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=vc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==eb.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{constructor(e,n){this.Qa=e,this.byteLength=n}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e){this.serializer=e}$s(e){return Xi(this.serializer,e)}Us(e){return e.metadata.exists?pv(this.serializer,e.document,!1):Dn.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return ur(e)}}class NS{constructor(e,n){this.Ua=e,this.serializer=n,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=qL(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++n;const r=Ft.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,{...this.progress}):null}za(e){const n=new Map,r=new V1(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.$s(s.metadata.name);for(const o of s.metadata.queries){const a=(n.get(o)||At()).add(i);n.set(o,a)}}return n}async ja(e){const n=await uG(e,new V1(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const s of this.Ka)await dG(e,s,r.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:n}}}function qL(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{constructor(e){this.key=e}}class KL{constructor(e){this.key=e}}class GL{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=At(),this.mutatedKeys=At(),this.eu=LO(e),this.tu=new Zl(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new O1,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const m=s.get(u),p=cm(this.query,h)?h:null,v=!!m&&this.mutatedKeys.has(m.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let E=!1;m&&p?m.data.isEqual(p.data)?v!==g&&(r.track({type:3,doc:p}),E=!0):this.su(m,p)||(r.track({type:2,doc:p}),E=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(a=!0)):!m&&p?(r.track({type:0,doc:p}),E=!0):m&&!p&&(r.track({type:1,doc:m}),E=!0,(l||c)&&(a=!0)),E&&(p?(o=o.add(p),i=g?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((u,h)=>function(p,v){const g=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Me(20277,{Rt:E})}};return g(p)-g(v)}(u.type,h.type)||this.eu(u.doc,h.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new vc(this.query,e.tu,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new O1,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=At(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new KL(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new HL(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=At();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return vc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const pl="SyncEngine";class VG{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class jG{constructor(e){this.key=e,this.hu=!1}}class FG{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Uo(a=>DO(a),lm),this.Iu=new Map,this.Eu=new Set,this.du=new An(we.comparator),this.Au=new Map,this.Ru=new pS,this.Vu={},this.mu=new Map,this.fu=gc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function UG(t,e,n=!0){const r=Ev(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await QL(r,e,n,!0),s}async function $G(t,e){const n=Ev(t);await QL(n,e,!0,!1)}async function QL(t,e,n,r){const s=await ud(t.localStore,Jr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await kS(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&bv(t.remoteStore,s),a}async function kS(t,e,n,r,s){t.pu=(h,m,p)=>async function(g,E,b,_){let S=E.view.ru(b);S.Cs&&(S=await ny(g.localStore,E.query,!1).then(({documents:I})=>E.view.ru(I,S)));const P=_&&_.targetChanges.get(E.targetId),T=_&&_.targetMismatches.get(E.targetId)!=null,N=E.view.applyChanges(S,g.isPrimaryClient,P,T);return tb(g,E.targetId,N.au),N.snapshot}(t,h,m,p);const i=await ny(t.localStore,e,!0),o=new GL(e,i.Qs),a=o.ru(i.documents),l=hm.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=o.applyChanges(a,t.isPrimaryClient,l);tb(t,n,c.au);const u=new VG(e,n,o);return t.Tu.set(e,u),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),c.snapshot}async function BG(t,e,n){const r=Ee(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!lm(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await dd(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&hd(r.remoteStore,s.targetId),fd(r,s.targetId)}).catch(dl)):(fd(r,s.targetId),await dd(r.localStore,s.targetId,!0))}async function zG(t,e){const n=Ee(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),hd(n.remoteStore,r.targetId))}async function WG(t,e,n){const r=MS(t);try{const s=await function(o,a){const l=Ee(o),c=sn.now(),u=a.reduce((p,v)=>p.add(v.key),At());let h,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=ys(),g=At();return l.Ns.getEntries(p,u).next(E=>{v=E,v.forEach((b,_)=>{_.isValidDocument()||(g=g.add(b))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,v)).next(E=>{h=E;const b=[];for(const _ of a){const S=pK(_,h.get(_.key).overlayedDocument);S!=null&&b.push(new $o(_.key,S,EO(S.value.mapValue),Un.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,b,a)}).next(E=>{m=E;const b=E.applyToLocalDocumentSet(h,g);return l.documentOverlayCache.saveOverlays(p,E.batchId,b)})}).then(()=>({batchId:m.batchId,changes:VO(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new An(pt)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c}(r,s.batchId,n),await Bo(r,s.changes),await jd(r.remoteStore)}catch(s){const i=Ud(s,"Failed to persist write");n.reject(i)}}async function YL(t,e){const n=Ee(t);try{const r=await lG(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(Je(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Je(o.hu,14607):s.removedDocuments.size>0&&(Je(o.hu,42227),o.hu=!1))}),await Bo(n,r,e)}catch(r){await dl(r)}}function j1(t,e,n){const r=Ee(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=Ee(o);l.onlineState=a;let c=!1;l.queries.forEach((u,h)=>{for(const m of h.Sa)m.va(a)&&(c=!0)}),c&&RS(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function qG(t,e,n){const r=Ee(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new An(we.comparator);o=o.insert(i,Dn.newNoDocument(i,ot.min()));const a=At().add(i),l=new dm(ot.min(),new Map,new An(pt),o,a);await YL(r,l),r.du=r.du.remove(i),r.Au.delete(e),LS(r)}else await dd(r.localStore,e,!1).then(()=>fd(r,e,n)).catch(dl)}async function HG(t,e){const n=Ee(t),r=e.batch.batchId;try{const s=await aG(n.localStore,e);OS(n,r,null),DS(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Bo(n,s)}catch(s){await dl(s)}}async function KG(t,e,n){const r=Ee(t);try{const s=await function(o,a){const l=Ee(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(Je(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);OS(r,e,n),DS(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Bo(r,s)}catch(s){await dl(s)}}async function GG(t,e){const n=Ee(t);ml(n.remoteStore)||ce(pl,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=Ee(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(n.localStore);if(r===$a)return void e.resolve();const s=n.mu.get(r)||[];s.push(e),n.mu.set(r,s)}catch(r){const s=Ud(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function DS(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function OS(t,e,n){const r=Ee(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function fd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||JL(t,r)})}function JL(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(hd(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),LS(t))}function tb(t,e,n){for(const r of n)r instanceof HL?(t.Ru.addReference(r.key,e),QG(t,r)):r instanceof KL?(ce(pl,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||JL(t,r.key)):Me(19791,{wu:r})}function QG(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ce(pl,"New document in limbo: "+n),t.Eu.add(r),LS(t))}function LS(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new we(Ft.fromString(e)),r=t.fu.next();t.Au.set(r,new jG(n)),t.du=t.du.insert(n,r),bv(t.remoteStore,new _o(Jr(Od(n.path)),r,"TargetPurposeLimboResolution",ps.ce))}}async function Bo(t,e,n){const r=Ee(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(c=>{var u;if((c||n)&&r.isPrimaryClient){const h=c?!c.fromCache:(u=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:u.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=wS.As(l.targetId,c);i.push(h)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,c){const u=Ee(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>U.forEach(c,m=>U.forEach(m.Es,p=>u.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>U.forEach(m.ds,p=>u.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!hl(h))throw h;ce(_S,"Failed to update sequence numbers: "+h)}for(const h of c){const m=h.targetId;if(!h.fromCache){const p=u.Ms.get(m),v=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(v);u.Ms=u.Ms.insert(m,g)}}}(r.localStore,i))}async function YG(t,e){const n=Ee(t);if(!n.currentUser.isEqual(e)){ce(pl,"User change. New user:",e.toKey());const r=await AL(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new ie(B.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Bo(n,r.Ls)}}function JG(t,e){const n=Ee(t),r=n.Au.get(e);if(r&&r.hu)return At().add(r.key);{let s=At();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}async function XG(t,e){const n=Ee(t),r=await ny(n.localStore,e.query,!0),s=e.view.cu(r);return n.isPrimaryClient&&tb(n,e.targetId,s.au),s}async function ZG(t,e){const n=Ee(t);return NL(n.localStore,e).then(r=>Bo(n,r))}async function eQ(t,e,n,r){const s=Ee(t),i=await function(a,l){const c=Ee(a),u=Ee(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",h=>u.er(h,l).next(m=>m?c.localDocuments.getDocuments(h,m):U.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await jd(s.remoteStore):n==="acknowledged"||n==="rejected"?(OS(s,e,r||null),DS(s,e),function(a,l){Ee(Ee(a).mutationQueue).ir(l)}(s.localStore,e)):Me(6720,"Unknown batchState",{Su:n}),await Bo(s,i)):ce(pl,"Cannot apply mutation batch with id: "+e)}async function tQ(t,e){const n=Ee(t);if(Ev(n),MS(n),e===!0&&n.gu!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await F1(n,r.toArray());n.gu=!0,await Z0(n.remoteStore,!0);for(const i of s)bv(n.remoteStore,i)}else if(e===!1&&n.gu!==!1){const r=[];let s=Promise.resolve();n.Iu.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(fd(n,o),dd(n.localStore,o,!0))),hd(n.remoteStore,o)}),await s,await F1(n,r),function(o){const a=Ee(o);a.Au.forEach((l,c)=>{hd(a.remoteStore,c)}),a.Ru.Jr(),a.Au=new Map,a.du=new An(we.comparator)}(n),n.gu=!1,await Z0(n.remoteStore,!1)}}async function F1(t,e,n){const r=Ee(t),s=[],i=[];for(const o of e){let a;const l=r.Iu.get(o);if(l&&l.length!==0){a=await ud(r.localStore,Jr(l[0]));for(const c of l){const u=r.Tu.get(c),h=await XG(r,u);h.snapshot&&i.push(h.snapshot)}}else{const c=await CL(r.localStore,o);a=await ud(r.localStore,c),await kS(r,XL(c),o,!1,a.resumeToken)}s.push(a)}return r.Pu.H_(i),s}function XL(t){return CO(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function nQ(t){return function(n){return Ee(Ee(n).persistence).Ts()}(Ee(t).localStore)}async function rQ(t,e,n,r){const s=Ee(t);if(s.gu)return void ce(pl,"Ignoring unexpected query state notification.");const i=s.Iu.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await NL(s.localStore,OO(i[0])),a=dm.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Yn.EMPTY_BYTE_STRING);await Bo(s,o,a);break}case"rejected":await dd(s.localStore,e,!0),fd(s,e,r);break;default:Me(64155,n)}}async function sQ(t,e,n){const r=Ev(t);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){ce(pl,"Adding an already active target "+s);continue}const i=await CL(r.localStore,s),o=await ud(r.localStore,i);await kS(r,XL(i),o.targetId,!1,o.resumeToken),bv(r.remoteStore,o)}for(const s of n)r.Iu.has(s)&&await dd(r.localStore,s,!1).then(()=>{hd(r.remoteStore,s),fd(r,s)}).catch(dl)}}function Ev(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=YL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=JG.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qG.bind(null,e),e.Pu.H_=LG.bind(null,e.eventManager),e.Pu.yu=MG.bind(null,e.eventManager),e}function MS(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=HG.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=KG.bind(null,e),e}function iQ(t,e,n){const r=Ee(t);(async function(i,o,a){try{const l=await o.getMetadata();if(await function(p,v){const g=Ee(p),E=ur(v.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",b=>g.Ii.getBundleMetadata(b,v.id)).then(b=>!!b&&b.createTime.compareTo(E)>=0)}(i.localStore,l))return await o.close(),a._completeWith(function(p){return{taskState:"Success",documentsLoaded:p.totalDocuments,bytesLoaded:p.totalBytes,totalDocuments:p.totalDocuments,totalBytes:p.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(qL(l));const c=new NS(l,o.serializer);let u=await o.bu();for(;u;){const m=await c.Ga(u);m&&a._updateProgress(m),u=await o.bu()}const h=await c.ja(i.localStore);return await Bo(i,h.Ha,void 0),await function(p,v){const g=Ee(p);return g.persistence.runTransaction("Save bundle","readwrite",E=>g.Ii.saveBundleMetadata(E,v))}(i.localStore,l),a._completeWith(h.progress),Promise.resolve(h.Ja)}catch(l){return Vs(pl,`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,n).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class md{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Rc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return xL(this.persistence,new TL,e.initialUser,this.serializer)}Cu(e){return new gS(_v.mi,this.serializer)}Du(e){return new ML}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}md.provider={build:()=>new md};class VS extends md{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Je(this.persistence.referenceDelegate instanceof ty,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new wL(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Gr.withCacheSize(this.cacheSizeBytes):Gr.DEFAULT;return new gS(r=>ty.mi(r,n),this.serializer)}}class jS extends md{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await MS(this.xu.syncEngine),await jd(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return xL(this.persistence,new TL,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new wL(r,e.asyncQueue,n)}Mu(e,n){const r=new wH(n,this.persistence);return new vH(e.asyncQueue,r)}Cu(e){const n=vS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Gr.withCacheSize(this.cacheSizeBytes):Gr.DEFAULT;return new yS(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,VL(),Gp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new ML}}class ZL extends jS{constructor(e,n){super(e,n,!1),this.xu=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xu.syncEngine;this.sharedClientState instanceof zw&&(this.sharedClientState.syncEngine={Co:eQ.bind(null,n),vo:rQ.bind(null,n),Fo:sQ.bind(null,n),Ts:nQ.bind(null,n),Do:ZG.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Ji(async r=>{await tQ(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Du(e){const n=VL();if(!zw.v(n))throw new ie(B.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=vS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new zw(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class el{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>j1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=YG.bind(null,this.syncEngine),await Z0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new OG}()}createDatastore(e){const n=Rc(e.databaseInfo.databaseId),r=function(i){return new gG(i)}(e.databaseInfo);return function(i,o,a,l){return new _G(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new EG(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>j1(this.syncEngine,n,0),function(){return N1.v()?new N1:new hG}())}createSyncEngine(e,n){return function(s,i,o,a,l,c,u){const h=new FG(s,i,o,a,l,c);return u&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Ee(s);ce(yc,"RemoteStore shutting down."),i.Ea.add(5),await Vd(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}el.provider={build:()=>new el};function U1(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):lr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oQ{constructor(e,n){this.Bu=e,this.serializer=n,this.metadata=new kr,this.buffer=new Uint8Array,this.Lu=function(){return new TextDecoder("utf-8")}(),this.ku().then(r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Qa)}`))},r=>this.metadata.reject(r))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const n=this.Lu.decode(e),r=Number(n);isNaN(r)&&this.Qu(`length string (${n}) is not valid number`);const s=await this.$u(r);return new WL(JSON.parse(s),e.length+r)}Uu(){return this.buffer.findIndex(e=>e===123)}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const n=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aQ{constructor(e,n){this.bundleData=e,this.serializer=n,this.cursor=0,this.elements=[];let r=this.bu();if(!r||!r.$a())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r==null?void 0:r.Qa)}`);this.metadata=r;do r=this.bu(),r!==null&&this.elements.push(r);while(r!==null)}getMetadata(){return this.metadata}Wu(){return this.elements}bu(){if(this.cursor===this.bundleData.length)return null;const e=this.qu(),n=this.$u(e);return new WL(JSON.parse(n),e)}$u(e){if(this.cursor+e>this.bundleData.length)throw new ie(B.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}qu(){const e=this.cursor;let n=this.cursor;for(;n<this.bundleData.length;){if(this.bundleData[n]==="{"){if(n===e)throw new Error("First character is a bracket and not a number");return this.cursor=n,Number(this.bundleData.slice(e,n))}n++}throw new Error("Reached the end of bundle when more is expected.")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lQ{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ie(B.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,i){const o=Ee(s),a={documents:i.map(h=>Mf(o.serializer,h))},l=await o.Ho("BatchGetDocuments",o.serializer.databaseId,Ft.emptyPath(),a,i.length),c=new Map;l.forEach(h=>{const m=IK(o.serializer,h);c.set(m.key.toString(),m)});const u=[];return i.forEach(h=>{const m=c.get(h.toString());Je(!!m,55234,{key:h}),u.push(m)}),u}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Md(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=we.fromPath(r);this.mutations.push(new aS(s,this.precondition(s)))}),await async function(r,s){const i=Ee(r),o={writes:s.map(a=>Vf(i.serializer,a))};await i.Go("Commit",i.serializer.databaseId,Ft.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Me(50498,{Gu:e.constructor.name});n=ot.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new ie(B.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(ot.min())?Un.exists(!1):Un.updateTime(n):Un.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(ot.min()))throw new ie(B.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Un.updateTime(n)}return Un.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cQ{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.zu=r.maxAttempts,this.M_=new ES(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new lQ(this.datastore),n=this.Hu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Yu(s)}))}).catch(r=>{this.Yu(r)})})}Hu(e){try{const n=this.updateFunction(e);return!im(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!GO(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl="FirestoreClient";class uQ{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Cr.UNAUTHENTICATED,this.clientId=sv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ce(tl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ce(tl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new kr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Ud(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function qw(t,e){t.asyncQueue.verifyOperationInProgress(),ce(tl,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await AL(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $1(t,e){t.asyncQueue.verifyOperationInProgress();const n=await FS(t);ce(tl,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>D1(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>D1(e.remoteStore,s)),t._onlineComponents=e}async function FS(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ce(tl,"Using user provided OfflineComponentProvider");try{await qw(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===B.FAILED_PRECONDITION||s.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Vs("Error using user provided cache. Falling back to memory cache: "+n),await qw(t,new md)}}else ce(tl,"Using default OfflineComponentProvider"),await qw(t,new VS(void 0));return t._offlineComponents}async function Iv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ce(tl,"Using user provided OnlineComponentProvider"),await $1(t,t._uninitializedComponentsProvider._online)):(ce(tl,"Using default OnlineComponentProvider"),await $1(t,new el))),t._onlineComponents}function eM(t){return FS(t).then(e=>e.persistence)}function $d(t){return FS(t).then(e=>e.localStore)}function tM(t){return Iv(t).then(e=>e.remoteStore)}function US(t){return Iv(t).then(e=>e.syncEngine)}function nM(t){return Iv(t).then(e=>e.datastore)}async function pd(t){const e=await Iv(t),n=e.eventManager;return n.onListen=UG.bind(null,e.syncEngine),n.onUnlisten=BG.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=$G.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=zG.bind(null,e.syncEngine),n}function dQ(t){return t.asyncQueue.enqueue(async()=>{const e=await eM(t),n=await tM(t);return e.setNetworkEnabled(!0),function(s){const i=Ee(s);return i.Ea.delete(0),fm(i)}(n)})}function hQ(t){return t.asyncQueue.enqueue(async()=>{const e=await eM(t),n=await tM(t);return e.setNetworkEnabled(!1),async function(s){const i=Ee(s);i.Ea.add(0),await Vd(i),i.Ra.set("Offline")}(n)})}function fQ(t,e){const n=new kr;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(c,u){const h=Ee(c);return h.persistence.runTransaction("read document","readonly",m=>h.localDocuments.getDocument(m,u))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new ie(B.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=Ud(a,`Failed to get document '${i} from cache`);o.reject(l)}}(await $d(t),e,n)),n.promise}function rM(t,e,n={}){const r=new kr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new Sv({next:m=>{u.Nu(),o.enqueueAndForget(()=>PS(i,h));const p=m.docs.has(a);!p&&m.fromCache?c.reject(new ie(B.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?c.reject(new ie(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new CS(Od(a.path),u,{includeMetadataChanges:!0,qa:!0});return AS(i,h)}(await pd(t),t.asyncQueue,e,n,r)),r.promise}function mQ(t,e){const n=new kr;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await ny(s,i,!0),l=new GL(i,a.Qs),c=l.ru(a.documents),u=l.applyChanges(c,!1);o.resolve(u.snapshot)}catch(a){const l=Ud(a,`Failed to execute query '${i} against cache`);o.reject(l)}}(await $d(t),e,n)),n.promise}function sM(t,e,n={}){const r=new kr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new Sv({next:m=>{u.Nu(),o.enqueueAndForget(()=>PS(i,h)),m.fromCache&&l.source==="server"?c.reject(new ie(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new CS(a,u,{includeMetadataChanges:!0,qa:!0});return AS(i,h)}(await pd(t),t.asyncQueue,e,n,r)),r.promise}function pQ(t,e,n){const r=new kr;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await nM(t);r.resolve(async function(o,a,l){var g;const c=Ee(o),{request:u,gt:h,parent:m}=iL(c.serializer,NO(a),l);c.connection.$o||delete u.parent;const p=(await c.Ho("RunAggregationQuery",c.serializer.databaseId,m,u,1)).filter(E=>!!E.result);Je(p.length===1,64727);const v=(g=p[0].result)==null?void 0:g.aggregateFields;return Object.keys(v).reduce((E,b)=>(E[h[b]]=v[b],E),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}function gQ(t,e){const n=new Sv(e);return t.asyncQueue.enqueueAndForget(async()=>function(s,i){Ee(s).Ca.add(i),i.next()}(await pd(t),n)),()=>{n.Nu(),t.asyncQueue.enqueueAndForget(async()=>function(s,i){Ee(s).Ca.delete(i)}(await pd(t),n))}}function yQ(t,e,n,r){const s=function(o,a){let l;return l=typeof o=="string"?YO().encode(o):o,function(u,h){return new oQ(u,h)}(function(u,h){if(u instanceof Uint8Array)return U1(u,h);if(u instanceof ArrayBuffer)return U1(new Uint8Array(u),h);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(n,Rc(e));t.asyncQueue.enqueueAndForget(async()=>{iQ(await US(t),s,r)})}function vQ(t,e){return t.asyncQueue.enqueue(async()=>function(r,s){const i=Ee(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Ii.getNamedQuery(o,s))}(await $d(t),e))}function iM(t,e){return function(r,s){return new aQ(r,s)}(t,e)}function wQ(t,e){return t.asyncQueue.enqueue(async()=>async function(r,s){const i=Ee(r),o=i.indexManager,a=[];return i.persistence.runTransaction("Configure indexes","readwrite",l=>o.getFieldIndexes(l).next(c=>function(h,m,p,v,g){h=[...h],m=[...m],h.sort(p),m.sort(p);const E=h.length,b=m.length;let _=0,S=0;for(;_<b&&S<E;){const P=p(h[S],m[_]);P<0?g(h[S++]):P>0?v(m[_++]):(_++,S++)}for(;_<b;)v(m[_++]);for(;S<E;)g(h[S++])}(c,s,mH,u=>{a.push(o.addFieldIndex(l,u))},u=>{a.push(o.deleteFieldIndex(l,u))})).next(()=>U.waitFor(a)))}(await $d(t),e))}function _Q(t,e){return t.asyncQueue.enqueue(async()=>function(r,s){Ee(r).Fs.Vs=s}(await $d(t),e))}function bQ(t){return t.asyncQueue.enqueue(async()=>function(n){const r=Ee(n),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",i=>s.deleteAllFieldIndexes(i))}(await $d(t)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oM(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aM="firestore.googleapis.com",z1=!0;class W1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ie(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=aM,this.ssl=z1}else this.host=e.host,this.ssl=e.ssl??z1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=mL;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<vL)throw new ie(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}K2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=oM(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ie(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ie(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ie(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class mm{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new W1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ie(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ie(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new W1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new q2;switch(r.type){case"firstParty":return new aH(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ie(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=B1.get(n);r&&(ce("ComponentProvider","Removing Datastore"),B1.delete(n),r.terminate())}(this),Promise.resolve()}}function lM(t,e,n,r={}){var c;t=Ut(t,mm);const s=Ti(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(Zf(`https://${a}`),Xy("Firestore",!0)),i.host!==aM&&i.host!==a&&Vs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!wi(l,o)&&(t._setSettings(l),r.mockUserToken)){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=Cr.MOCK_USER;else{u=VD(r.mockUserToken,(c=t._app)==null?void 0:c.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new ie(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Cr(m)}t._authCredentials=new sH(new W2(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new br(this.firestore,e,this._query)}}class mn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mn(this.firestore,e,this._key)}toJSON(){return{type:mn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Pc(n,mn._jsonSchema))return new mn(e,r||null,new we(Ft.fromString(n.referencePath)))}}mn._jsonSchemaVersion="firestore/documentReference/1.0",mn._jsonSchema={type:pr("string",mn._jsonSchemaVersion),referencePath:pr("string")};class mi extends br{constructor(e,n,r){super(e,n,Od(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new mn(this.firestore,null,new we(e))}withConverter(e){return new mi(this.firestore,e,this._path)}}function xe(t,e,...n){if(t=Dt(t),GE("collection","path",e),t instanceof mm){const r=Ft.fromString(e,...n);return kA(r),new mi(t,null,r)}{if(!(t instanceof mn||t instanceof mi))throw new ie(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ft.fromString(e,...n));return kA(r),new mi(t.firestore,null,r)}}function EQ(t,e){if(t=Ut(t,mm),GE("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ie(B.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new br(t,null,function(r){return new Fo(Ft.emptyPath(),r)}(e))}function ye(t,e,...n){if(t=Dt(t),arguments.length===1&&(e=sv.newId()),GE("doc","path",e),t instanceof mm){const r=Ft.fromString(e,...n);return NA(r),new mn(t,null,new we(r))}{if(!(t instanceof mn||t instanceof mi))throw new ie(B.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ft.fromString(e,...n));return NA(r),new mn(t.firestore,t instanceof mi?t.converter:null,new we(r))}}function SQ(t,e){return t=Dt(t),e=Dt(e),(t instanceof mn||t instanceof mi)&&(e instanceof mn||e instanceof mi)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function $S(t,e){return t=Dt(t),e=Dt(e),t instanceof br&&e instanceof br&&t.firestore===e.firestore&&lm(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1="AsyncQueue";class H1{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ES(this,"async_queue_retry"),this._c=()=>{const r=Gp();r&&ce(q1,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Gp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Gp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new kr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!hl(e))throw e;ce(q1,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,lr("INTERNAL UNHANDLED ERROR: ",K1(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=xS.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&Me(47125,{Pc:K1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function K1(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pu(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class cM{constructor(){this._progressObserver={},this._taskCompletionResolver=new kr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IQ=-1;class wn extends mm{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new H1,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new H1(e),this._firestoreClient=void 0,await e}}}function uM(t,e,n){n||(n=kf);const r=Tc(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(wi(i,e))return s;throw new ie(B.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ie(B.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<vL)throw new ie(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Ti(e.host)&&Zf(e.host),r.initialize({options:e,instanceIdentifier:n})}function TQ(t,e){const n=typeof t=="object"?t:ev(),r=typeof t=="string"?t:e||kf,s=Tc(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=OE("firestore");i&&lM(s,...i)}return s}function $n(t){if(t._terminated)throw new ie(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||dM(t),t._firestoreClient}function dM(t){var r,s,i;const e=t._freezeSettings(),n=function(a,l,c,u){return new GH(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,oM(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new uQ(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function xQ(t,e){Vs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return hM(t,el.provider,{build:r=>new jS(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function AQ(t){Vs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();hM(t,el.provider,{build:n=>new ZL(n,e.cacheSizeBytes)})}function hM(t,e,n){if((t=Ut(t,wn))._firestoreClient||t._terminated)throw new ie(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new ie(B.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},dM(t)}function PQ(t){if(t._initialized&&!t._terminated)throw new ie(B.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new kr;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Ji.v())return Promise.resolve();const s=r+IL;await Ji.delete(s)}(vS(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function RQ(t){return function(n){const r=new kr;return n.asyncQueue.enqueueAndForget(async()=>GG(await US(n),r)),r.promise}($n(t=Ut(t,wn)))}function BS(t){return dQ($n(t=Ut(t,wn)))}function zS(t){return hQ($n(t=Ut(t,wn)))}function CQ(t){return ZW(t.app,"firestore",t._databaseId.database),t._delete()}function nb(t,e){const n=$n(t=Ut(t,wn)),r=new cM;return yQ(n,t._databaseId,e,r),r}function fM(t,e){return vQ($n(t=Ut(t,wn)),e).then(n=>n?new br(t,null,n.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class mM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fs(Yn.fromBase64String(e))}catch(n){throw new ie(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new fs(Yn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:fs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pc(e,fs._jsonSchema))return fs.fromBase64String(e.bytes)}}fs._jsonSchemaVersion="firestore/bytes/1.0",fs._jsonSchema={type:pr("string",fs._jsonSchemaVersion),bytes:pr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ie(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new On(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function NQ(){return new gl(k0)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ie(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ie(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return pt(this._lat,e._lat)||pt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:pi._jsonSchemaVersion}}static fromJSON(e){if(Pc(e,pi._jsonSchema))return new pi(e.latitude,e.longitude)}}pi._jsonSchemaVersion="firestore/geoPoint/1.0",pi._jsonSchema={type:pr("string",pi._jsonSchemaVersion),latitude:pr("number"),longitude:pr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Ys._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pc(e,Ys._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Ys(e.vectorValues);throw new ie(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ys._jsonSchemaVersion="firestore/vectorValue/1.0",Ys._jsonSchema={type:pr("string",Ys._jsonSchemaVersion),vectorValues:pr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kQ=/^__.*__$/;class DQ{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new $o(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ld(e,this.data,n,this.fieldTransforms)}}class pM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new $o(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function gM(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Me(40011,{Ac:t})}}class Tv{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Tv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return oy(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(gM(this.Ac)&&kQ.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class OQ{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Rc(e)}Cc(e,n,r,s=!1){return new Tv({Ac:e,methodName:n,Dc:r,path:On.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Cc(t){const e=t._freezeSettings(),n=Rc(t._databaseId);return new OQ(t._databaseId,!!e.ignoreUndefinedProperties,n)}function xv(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);YS("Data must be an object, but it was:",o,r);const a=wM(r,o);let l,c;if(i.merge)l=new gs(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const m=jf(e,h,n);if(!o.contains(m))throw new ie(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);bM(u,m)||u.push(m)}l=new gs(u),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new DQ(new Fr(a),l,c)}class pm extends yl{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pm}}function yM(t,e,n){return new Tv({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class WS extends yl{_toFieldTransform(e){return new um(e.path,new ad)}isEqual(e){return e instanceof WS}}class qS extends yl{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=yM(this,e,!0),r=this.vc.map(i=>Nc(i,n)),s=new hc(r);return new um(e.path,s)}isEqual(e){return e instanceof qS&&wi(this.vc,e.vc)}}class HS extends yl{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=yM(this,e,!0),r=this.vc.map(i=>Nc(i,n)),s=new fc(r);return new um(e.path,s)}isEqual(e){return e instanceof HS&&wi(this.vc,e.vc)}}class KS extends yl{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new ld(e.serializer,UO(e.serializer,this.Fc));return new um(e.path,n)}isEqual(e){return e instanceof KS&&this.Fc===e.Fc}}function GS(t,e,n,r){const s=t.Cc(1,e,n);YS("Data must be an object, but it was:",s,r);const i=[],o=Fr.empty();fl(r,(l,c)=>{const u=Av(e,l,n);c=Dt(c);const h=s.yc(u);if(c instanceof pm)i.push(u);else{const m=Nc(c,h);m!=null&&(i.push(u),o.set(u,m))}});const a=new gs(i);return new pM(o,a,s.fieldTransforms)}function QS(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[jf(e,r,n)],l=[s];if(i.length%2!=0)throw new ie(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(jf(e,i[m])),l.push(i[m+1]);const c=[],u=Fr.empty();for(let m=a.length-1;m>=0;--m)if(!bM(c,a[m])){const p=a[m];let v=l[m];v=Dt(v);const g=o.yc(p);if(v instanceof pm)c.push(p);else{const E=Nc(v,g);E!=null&&(c.push(p),u.set(p,E))}}const h=new gs(c);return new pM(u,h,o.fieldTransforms)}function vM(t,e,n,r=!1){return Nc(n,t.Cc(r?4:3,e))}function Nc(t,e){if(_M(t=Dt(t)))return YS("Unsupported field value:",e,t),wM(t,e);if(t instanceof yl)return function(r,s){if(!gM(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Nc(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Dt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return UO(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=sn.fromDate(r);return{timestampValue:cd(s.serializer,i)}}if(r instanceof sn){const i=new sn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:cd(s.serializer,i)}}if(r instanceof pi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof fs)return{bytesValue:ZO(s.serializer,r._byteString)};if(r instanceof mn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:hS(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Ys)return function(o,a){return{mapValue:{fields:{[tS]:{stringValue:nS},[sd]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return oS(a.serializer,c)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${iv(r)}`)}(t,e)}function wM(t,e){const n={};return fO(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fl(t,(r,s)=>{const i=Nc(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function _M(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof sn||t instanceof pi||t instanceof fs||t instanceof mn||t instanceof yl||t instanceof Ys)}function YS(t,e,n){if(!_M(n)||!G2(n)){const r=iv(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function jf(t,e,n){if((e=Dt(e))instanceof gl)return e._internalPath;if(typeof e=="string")return Av(t,e);throw oy("Field path arguments must be of type string or ",t,!1,void 0,n)}const LQ=new RegExp("[~\\*/\\[\\]]");function Av(t,e,n){if(e.search(LQ)>=0)throw oy(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new gl(...e.split("."))._internalPath}catch{throw oy(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function oy(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new ie(B.INVALID_ARGUMENT,a+t+l)}function bM(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new mn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new MQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Pv("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class MQ extends Ff{data(){return super.data()}}function Pv(t,e){return typeof e=="string"?Av(t,e):e instanceof gl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EM(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ie(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class JS{}class Bd extends JS{}function Ye(t,e,...n){let r=[];e instanceof JS&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof kc).length,a=i.filter(l=>l instanceof zd).length;if(o>1||o>0&&a>0)throw new ie(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class zd extends Bd{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new zd(e,n,r)}_apply(e){const n=this._parse(e);return IM(e._query,n),new br(e.firestore,e.converter,z0(e._query,n))}_parse(e){const n=Cc(e.firestore);return function(i,o,a,l,c,u,h){let m;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new ie(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Q1(h,u);const v=[];for(const g of h)v.push(G1(l,i,g));m={arrayValue:{values:v}}}else m=G1(l,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Q1(h,u),m=vM(a,o,h,u==="in"||u==="not-in");return Ht.create(c,u,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Oe(t,e,n){const r=e,s=Pv("where",t);return zd._create(s,r,n)}class kc extends JS{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new kc(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:fn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)IM(o,l),o=z0(o,l)}(e._query,n),new br(e.firestore,e.converter,z0(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function VQ(...t){return t.forEach(e=>TM("or",e)),kc._create("or",t)}function jQ(...t){return t.forEach(e=>TM("and",e)),kc._create("and",t)}class Rv extends Bd{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Rv(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new ie(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ie(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Lf(i,o)}(e._query,this._field,this._direction);return new br(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Fo(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Gs(t,e="asc"){const n=e,r=Pv("orderBy",t);return Rv._create(r,n)}class gm extends Bd{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new gm(e,n,r)}_apply(e){return new br(e.firestore,e.converter,Jg(e._query,this._limit,this._limitType))}}function di(t){return Q2("limit",t),gm._create("limit",t,"F")}function FQ(t){return Q2("limitToLast",t),gm._create("limitToLast",t,"L")}class ym extends Bd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new ym(e,n,r)}_apply(e){const n=SM(e,this.type,this._docOrFields,this._inclusive);return new br(e.firestore,e.converter,function(s,i){return new Fo(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function UQ(...t){return ym._create("startAt",t,!0)}function $Q(...t){return ym._create("startAfter",t,!1)}class vm extends Bd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new vm(e,n,r)}_apply(e){const n=SM(e,this.type,this._docOrFields,this._inclusive);return new br(e.firestore,e.converter,function(s,i){return new Fo(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function BQ(...t){return vm._create("endBefore",t,!1)}function zQ(...t){return vm._create("endAt",t,!0)}function SM(t,e,n,r){if(n[0]=Dt(n[0]),n[0]instanceof Ff)return function(i,o,a,l,c){if(!l)throw new ie(B.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const u=[];for(const h of Au(i))if(h.field.isKeyField())u.push(uc(o,l.key));else{const m=l.data.field(h.field);if(uv(m))throw new ie(B.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const p=h.field.canonicalString();throw new ie(B.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${p}' (used as the orderBy) does not exist.`)}u.push(m)}return new Xa(u,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=Cc(t.firestore);return function(o,a,l,c,u,h){const m=o.explicitOrderBy;if(u.length>m.length)throw new ie(B.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const p=[];for(let v=0;v<u.length;v++){const g=u[v];if(m[v].field.isKeyField()){if(typeof g!="string")throw new ie(B.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!sS(o)&&g.indexOf("/")!==-1)throw new ie(B.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);const E=o.path.child(Ft.fromString(g));if(!we.isDocumentKey(E))throw new ie(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${E}' is not because it contains an odd number of segments.`);const b=new we(E);p.push(uc(a,b))}else{const E=vM(l,c,g);p.push(E)}}return new Xa(p,h)}(t._query,t.firestore._databaseId,s,e,n,r)}}function G1(t,e,n){if(typeof(n=Dt(n))=="string"){if(n==="")throw new ie(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sS(e)&&n.indexOf("/")!==-1)throw new ie(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ft.fromString(n));if(!we.isDocumentKey(r))throw new ie(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return uc(t,new we(r))}if(n instanceof mn)return uc(t,n._key);throw new ie(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${iv(n)}.`)}function Q1(t,e){if(!Array.isArray(t)||t.length===0)throw new ie(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function IM(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ie(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ie(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function TM(t,e){if(!(e instanceof zd||e instanceof kc))throw new ie(B.INVALID_ARGUMENT,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class XS{convertValue(e,n="none"){switch(Ya(e)){case 0:return null;case 1:return e.booleanValue;case 2:return jn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Mo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Me(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return fl(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[sd].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>jn(o.doubleValue));return new Ys(n)}convertGeoPoint(e){return new pi(jn(e.latitude),jn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=dv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Nf(e));default:return null}}convertTimestamp(e){const n=Lo(e);return new sn(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ft.fromString(e);Je(cL(r),9688,{name:e});const s=new Qa(r.get(1),r.get(3)),i=new we(r.popFirst(5));return s.isEqual(n)||lr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cv(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class ZS extends XS{constructor(e){super(),this.firestore=e}convertBytes(e){return new fs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new mn(this.firestore,null,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WQ(t){return new gd("sum",jf("sum",t))}function qQ(t){return new gd("avg",jf("average",t))}function xM(){return new gd("count")}function HQ(t,e){var n,r;return t instanceof gd&&e instanceof gd&&t.aggregateType===e.aggregateType&&((n=t._internalFieldPath)==null?void 0:n.canonicalString())===((r=e._internalFieldPath)==null?void 0:r.canonicalString())}function KQ(t,e){return $S(t.query,e.query)&&wi(t.data(),e.data())}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM="NOT SUPPORTED";class bo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Es extends Ff{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Jh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Pv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Es._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}function GQ(t,e,n){if(Pc(e,Es._jsonSchema)){if(e.bundle===AM)throw new ie(B.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=Rc(t._databaseId),s=iM(e.bundle,r),i=s.Wu(),o=new NS(s.getMetadata(),r);for(const u of i)o.Ga(u);const a=o.documents;if(a.length!==1)throw new ie(B.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${a.length} documents.`);const l=pv(r,a[0].document),c=new we(Ft.fromString(e.bundleName));return new Es(t,new ZS(t),c,l,new bo(!1,!1),n||null)}}Es._jsonSchemaVersion="firestore/documentSnapshot/1.0",Es._jsonSchema={type:pr("string",Es._jsonSchemaVersion),bundleSource:pr("string","DocumentSnapshot"),bundleName:pr("string"),bundle:pr("string")};class Jh extends Es{data(e={}){return super.data(e)}}class Ss{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new bo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Jh(this._firestore,this._userDataWriter,r.key,r,new bo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ie(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Jh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new bo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Jh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new bo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:YQ(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ss._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=sv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function QQ(t,e,n){if(Pc(e,Ss._jsonSchema)){if(e.bundle===AM)throw new ie(B.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=Rc(t._databaseId),s=iM(e.bundle,r),i=s.Wu(),o=new NS(s.getMetadata(),r);for(const m of i)o.Ga(m);if(o.queries.length!==1)throw new ie(B.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);const a=yv(o.queries[0].bundledQuery),l=o.documents;let c=new Zl;l.map(m=>{const p=pv(r,m.document);c=c.add(p)});const u=vc.fromInitialDocuments(a,c,At(),!1,!1),h=new br(t,n||null,a);return new Ss(t,new ZS(t),h,u)}}function YQ(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Me(61501,{type:t})}}function JQ(t,e){return t instanceof Es&&e instanceof Es?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Ss&&e instanceof Ss&&t._firestore===e._firestore&&$S(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(t){t=Ut(t,mn);const e=Ut(t.firestore,wn);return rM($n(e),t._key).then(n=>eI(e,t,n))}Ss._jsonSchemaVersion="firestore/querySnapshot/1.0",Ss._jsonSchema={type:pr("string",Ss._jsonSchemaVersion),bundleSource:pr("string","QuerySnapshot"),bundleName:pr("string"),bundle:pr("string")};class vl extends XS{constructor(e){super(),this.firestore=e}convertBytes(e){return new fs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new mn(this.firestore,null,n)}}function XQ(t){t=Ut(t,mn);const e=Ut(t.firestore,wn),n=$n(e),r=new vl(e);return fQ(n,t._key).then(s=>new Es(e,r,t._key,s,new bo(s!==null&&s.hasLocalMutations,!0),t.converter))}function ZQ(t){t=Ut(t,mn);const e=Ut(t.firestore,wn);return rM($n(e),t._key,{source:"server"}).then(n=>eI(e,t,n))}function et(t){t=Ut(t,br);const e=Ut(t.firestore,wn),n=$n(e),r=new vl(e);return EM(t._query),sM(n,t._query).then(s=>new Ss(e,r,t,s))}function eY(t){t=Ut(t,br);const e=Ut(t.firestore,wn),n=$n(e),r=new vl(e);return mQ(n,t._query).then(s=>new Ss(e,r,t,s))}function tY(t){t=Ut(t,br);const e=Ut(t.firestore,wn),n=$n(e),r=new vl(e);return sM(n,t._query,{source:"server"}).then(s=>new Ss(e,r,t,s))}function rn(t,e,n){t=Ut(t,mn);const r=Ut(t.firestore,wn),s=Cv(t.converter,e,n);return Wd(r,[xv(Cc(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Un.none())])}function xn(t,e,n,...r){t=Ut(t,mn);const s=Ut(t.firestore,wn),i=Cc(s);let o;return o=typeof(e=Dt(e))=="string"||e instanceof gl?QS(i,"updateDoc",t._key,e,n,r):GS(i,"updateDoc",t._key,e),Wd(s,[o.toMutation(t._key,Un.exists(!0))])}function Hn(t){return Wd(Ut(t.firestore,wn),[new Md(t._key,Un.none())])}function Ls(t,e){const n=Ut(t.firestore,wn),r=ye(t),s=Cv(t.converter,e);return Wd(n,[xv(Cc(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Un.exists(!1))]).then(()=>r)}function Vo(t,...e){var l,c,u;t=Dt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Pu(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Pu(e[r])){const h=e[r];e[r]=(l=h.next)==null?void 0:l.bind(h),e[r+1]=(c=h.error)==null?void 0:c.bind(h),e[r+2]=(u=h.complete)==null?void 0:u.bind(h)}let i,o,a;if(t instanceof mn)o=Ut(t.firestore,wn),a=Od(t._key.path),i={next:h=>{e[r]&&e[r](eI(o,t,h))},error:e[r+1],complete:e[r+2]};else{const h=Ut(t,br);o=Ut(h.firestore,wn),a=h._query;const m=new vl(o);i={next:p=>{e[r]&&e[r](new Ss(o,m,h,p))},error:e[r+1],complete:e[r+2]},EM(t._query)}return function(m,p,v,g){const E=new Sv(g),b=new CS(p,E,v);return m.asyncQueue.enqueueAndForget(async()=>AS(await pd(m),b)),()=>{E.Nu(),m.asyncQueue.enqueueAndForget(async()=>PS(await pd(m),b))}}($n(o),a,s,i)}function nY(t,e,...n){const r=Dt(t),s=function(l){const c={bundle:"",bundleName:"",bundleSource:""},u=["bundle","bundleName","bundleSource"];for(const h of u){if(!(h in l)){c.error=`snapshotJson missing required field: ${h}`;break}const m=l[h];if(typeof m!="string"){c.error=`snapshotJson field '${h}' must be a string.`;break}if(m.length===0){c.error=`snapshotJson field '${h}' cannot be an empty string.`;break}h==="bundle"?c.bundle=m:h==="bundleName"?c.bundleName=m:h==="bundleSource"&&(c.bundleSource=m)}return c}(e);if(s.error)throw new ie(B.INVALID_ARGUMENT,s.error);let i,o=0;if(typeof n[o]!="object"||Pu(n[o])||(i=n[o++]),s.bundleSource==="QuerySnapshot"){let a=null;if(typeof n[o]=="object"&&Pu(n[o])){const l=n[o++];a={next:l.next,error:l.error,complete:l.complete}}else a={next:n[o++],error:n[o++],complete:n[o++]};return function(c,u,h,m,p){let v,g=!1;return nb(c,u.bundle).then(()=>fM(c,u.bundleName)).then(b=>{b&&!g&&(p&&b.withConverter(p),v=Vo(b,h||{},m))}).catch(b=>(m.error&&m.error(b),()=>{})),()=>{g||(g=!0,v&&v())}}(r,s,i,a,n[o])}if(s.bundleSource==="DocumentSnapshot"){let a=null;if(typeof n[o]=="object"&&Pu(n[o])){const l=n[o++];a={next:l.next,error:l.error,complete:l.complete}}else a={next:n[o++],error:n[o++],complete:n[o++]};return function(c,u,h,m,p){let v,g=!1;return nb(c,u.bundle).then(()=>{if(!g){const b=new mn(c,p||null,we.fromPath(u.bundleName));v=Vo(b,h||{},m)}}).catch(b=>(m.error&&m.error(b),()=>{})),()=>{g||(g=!0,v&&v())}}(r,s,i,a,n[o])}throw new ie(B.INVALID_ARGUMENT,`unsupported bundle source: ${s.bundleSource}`)}function rY(t,e){return gQ($n(t=Ut(t,wn)),Pu(e)?e:{next:e})}function Wd(t,e){return function(r,s){const i=new kr;return r.asyncQueue.enqueueAndForget(async()=>WG(await US(r),s,i)),i.promise}($n(t),e)}function eI(t,e,n){const r=n.docs.get(e._key),s=new vl(t);return new Es(t,s,e._key,r,new bo(n.hasPendingWrites,n.fromCache),e.converter)}function PM(t){return RM(t,{count:xM()})}function RM(t,e){const n=Ut(t.firestore,wn),r=$n(n),s=hO(e,(i,o)=>new KO(o,i.aggregateType,i._internalFieldPath));return pQ(r,t._query,s).then(i=>function(a,l,c){const u=new vl(a);return new mM(l,u,c)}(n,t,i))}class sY{constructor(e){this.kind="memory",this._onlineComponentProvider=el.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new VS(void 0)}}toJSON(){return{kind:this.kind}}}class iY{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=CM(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class oY{constructor(){this.kind="memoryEager",this._offlineComponentProvider=md.provider}toJSON(){return{kind:this.kind}}}class aY{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new VS(e)}}toJSON(){return{kind:this.kind}}}function lY(){return new oY}function cY(t){return new aY(t==null?void 0:t.cacheSizeBytes)}function uY(t){return new sY(t)}function dY(t){return new iY(t)}class hY{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=el.provider,this._offlineComponentProvider={build:n=>new jS(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class fY{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=el.provider,this._offlineComponentProvider={build:n=>new ZL(n,e==null?void 0:e.cacheSizeBytes)}}}function CM(t){return new hY(t==null?void 0:t.forceOwnership)}function mY(){return new fY}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pY={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Cc(e)}set(e,n,r){this._verifyNotCommitted();const s=Aa(e,this._firestore),i=Cv(s.converter,n,r),o=xv(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Un.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Aa(e,this._firestore);let o;return o=typeof(n=Dt(n))=="string"||n instanceof gl?QS(this._dataReader,"WriteBatch.update",i._key,n,r,s):GS(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Un.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Aa(e,this._firestore);return this._mutations=this._mutations.concat(new Md(n._key,Un.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ie(B.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Aa(t,e){if((t=Dt(t)).firestore!==e)throw new ie(B.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gY{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Cc(e)}get(e){const n=Aa(e,this._firestore),r=new ZS(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return Me(24041);const i=s[0];if(i.isFoundDocument())return new Ff(this._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Ff(this._firestore,r,n._key,null,n.converter);throw Me(18433,{doc:i})})}set(e,n,r){const s=Aa(e,this._firestore),i=Cv(s.converter,n,r),o=xv(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,n,r,...s){const i=Aa(e,this._firestore);let o;return o=typeof(n=Dt(n))=="string"||n instanceof gl?QS(this._dataReader,"Transaction.update",i._key,n,r,s):GS(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=Aa(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM extends gY{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Aa(e,this._firestore),r=new vl(this._firestore);return super.get(e).then(s=>new Es(this._firestore,r,n._key,s._document,new bo(!1,!1),n.converter))}}function yY(t,e,n){t=Ut(t,wn);const r={...pY,...n};return function(i){if(i.maxAttempts<1)throw new ie(B.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const l=new kr;return i.asyncQueue.enqueueAndForget(async()=>{const c=await nM(i);new cQ(i.asyncQueue,c,a,o,l).ju()}),l.promise}($n(t),s=>e(new kM(t,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vY(){return new pm("deleteField")}function Be(){return new WS("serverTimestamp")}function wY(...t){return new qS("arrayUnion",t)}function _Y(...t){return new HS("arrayRemove",t)}function Ah(t){return new KS("increment",t)}function bY(t){return new Ys(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(t){return $n(t=Ut(t,wn)),new NM(t,e=>Wd(t,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EY(t,e){const n=$n(t=Ut(t,wn));if(!n._uninitializedComponentsProvider||n._uninitializedComponentsProvider._offline.kind==="memory")return Vs("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(i){const o=typeof i=="string"?function(c){try{return JSON.parse(c)}catch(u){throw new ie(B.INVALID_ARGUMENT,"Failed to parse JSON: "+(u==null?void 0:u.message))}}(i):i,a=[];if(Array.isArray(o.indexes))for(const l of o.indexes){const c=Y1(l,"collectionGroup"),u=[];if(Array.isArray(l.fields))for(const h of l.fields){const m=Av("setIndexConfiguration",Y1(h,"fieldPath"));h.arrayConfig==="CONTAINS"?u.push(new Jl(m,2)):h.order==="ASCENDING"?u.push(new Jl(m,0)):h.order==="DESCENDING"&&u.push(new Jl(m,1))}a.push(new Xu(Xu.UNKNOWN_ID,c,u,Zu.empty()))}return a}(e);return wQ(n,r)}function Y1(t,e){if(typeof t[e]!="string")throw new ie(B.INVALID_ARGUMENT,"Missing string value for: "+e);return t[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function SY(t){var s;t=Ut(t,wn);const e=J1.get(t);if(e)return e;if(((s=$n(t)._uninitializedComponentsProvider)==null?void 0:s._offline.kind)!=="persistent")return null;const r=new DM(t);return J1.set(t,r),r}function IY(t){OM(t,!0)}function TY(t){OM(t,!1)}function xY(t){bQ($n(t._firestore)).then(e=>ce("deleting all persistent cache indexes succeeded")).catch(e=>Vs("deleting all persistent cache indexes failed",e))}function OM(t,e){_Q($n(t._firestore),e).then(n=>ce(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(n=>Vs(`setting persistent cache index auto creation isEnabled=${e} failed`,n))}const J1=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AY(t){var r;const e=$n(Ut(t.firestore,wn)),n=(r=e._onlineComponents)==null?void 0:r.datastore.serializer;return n===void 0?null:gv(n,Jr(t._query)).ft}function PY(t,e){var i;const n=hO(e,(o,a)=>new KO(a,o.aggregateType,o._internalFieldPath)),r=$n(Ut(t.firestore,wn)),s=(i=r._onlineComponents)==null?void 0:i.datastore.serializer;return s===void 0?null:iL(s,NO(t._query),n,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RY{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return tI.instance.onExistenceFilterMismatch(e)}}class tI{constructor(){this.Mc=new Map}static get instance(){return op||(op=new tI,function(n){if(Qh)throw new Error("a TestingHooksSpi instance is already set");Qh=n}(op)),op}lt(e){this.Mc.forEach(n=>n(e))}onExistenceFilterMismatch(e){const n=Symbol(),r=this.Mc;return r.set(n,e),()=>r.delete(n)}}let op=null;(function(e,n=!0){(function(s){Dd=s})(xc),to(new _i("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new wn(new iH(r.getProvider("auth-internal")),new lH(o,r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ie(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qa(c.options.projectId,u)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Os(RA,CA,e),Os(RA,CA,"esm2020")})();const kn=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:XS,AggregateField:gd,AggregateQuerySnapshot:mM,Bytes:fs,CACHE_SIZE_UNLIMITED:IQ,CollectionReference:mi,DocumentReference:mn,DocumentSnapshot:Es,FieldPath:gl,FieldValue:yl,Firestore:wn,FirestoreError:ie,GeoPoint:pi,LoadBundleTask:cM,PersistentCacheIndexManager:DM,Query:br,QueryCompositeFilterConstraint:kc,QueryConstraint:Bd,QueryDocumentSnapshot:Jh,QueryEndAtConstraint:vm,QueryFieldFilterConstraint:zd,QueryLimitConstraint:gm,QueryOrderByConstraint:Rv,QuerySnapshot:Ss,QueryStartAtConstraint:ym,SnapshotMetadata:bo,Timestamp:sn,Transaction:kM,VectorValue:Ys,WriteBatch:NM,_AutoId:sv,_ByteString:Yn,_DatabaseId:Qa,_DocumentKey:we,_EmptyAppCheckTokenProvider:cH,_EmptyAuthCredentialsProvider:q2,_FieldPath:On,_TestingHooks:RY,_cast:Ut,_debugAssert:rH,_internalAggregationQueryToProtoRunAggregationQueryRequest:PY,_internalQueryToProtoQueryTarget:AY,_isBase64Available:HH,_logWarn:Vs,_validateIsNotUsedTogether:K2,addDoc:Ls,aggregateFieldEqual:HQ,aggregateQuerySnapshotEqual:KQ,and:jQ,arrayRemove:_Y,arrayUnion:wY,average:qQ,clearIndexedDbPersistence:PQ,collection:xe,collectionGroup:EQ,connectFirestoreEmulator:lM,count:xM,deleteAllPersistentCacheIndexes:xY,deleteDoc:Hn,deleteField:vY,disableNetwork:zS,disablePersistentCacheIndexAutoCreation:TY,doc:ye,documentId:NQ,documentSnapshotFromJSON:GQ,enableIndexedDbPersistence:xQ,enableMultiTabIndexedDbPersistence:AQ,enableNetwork:BS,enablePersistentCacheIndexAutoCreation:IY,endAt:zQ,endBefore:BQ,ensureFirestoreConfigured:$n,executeWrite:Wd,getAggregateFromServer:RM,getCountFromServer:PM,getDoc:Sn,getDocFromCache:XQ,getDocFromServer:ZQ,getDocs:et,getDocsFromCache:eY,getDocsFromServer:tY,getFirestore:TQ,getPersistentCacheIndexManager:SY,increment:Ah,initializeFirestore:uM,limit:di,limitToLast:FQ,loadBundle:nb,memoryEagerGarbageCollector:lY,memoryLocalCache:uY,memoryLruGarbageCollector:cY,namedQuery:fM,onSnapshot:Vo,onSnapshotResume:nY,onSnapshotsInSync:rY,or:VQ,orderBy:Gs,persistentLocalCache:dY,persistentMultipleTabManager:mY,persistentSingleTabManager:CM,query:Ye,queryEqual:$S,querySnapshotFromJSON:QQ,refEqual:SQ,runTransaction:yY,serverTimestamp:Be,setDoc:rn,setIndexConfiguration:EY,setLogLevel:B2,snapshotEqual:JQ,startAfter:$Q,startAt:UQ,sum:WQ,terminate:CQ,updateDoc:xn,vector:bY,waitForPendingWrites:RQ,where:Oe,writeBatch:Nv},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CY="type.googleapis.com/google.protobuf.Int64Value",NY="type.googleapis.com/google.protobuf.UInt64Value";function LM(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function ay(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>ay(e));if(typeof t=="function"||typeof t=="object")return LM(t,e=>ay(e));throw new Error("Data cannot be encoded in JSON: "+t)}function yd(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case CY:case NY:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>yd(e)):typeof t=="function"||typeof t=="object"?LM(t,e=>yd(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X1={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class vs extends xi{constructor(e,n,r){super(`${nI}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,vs.prototype)}}function kY(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function ly(t,e){let n=kY(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!X1[o])return new vs("internal","internal");n=X1[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=yd(s))}}catch{}return n==="ok"?null:new vs(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DY{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,hs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rb="us-central1",OY=/^data: (.*?)(?:\n|$)/;function LY(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new vs("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class MY{constructor(e,n,r,s,i=rb,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new DY(e,n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=rb}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function VY(t,e,n){const r=Ti(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(Zf(t.emulatorOrigin+"/backends"),Xy("Functions",!0))}function jY(t,e,n){const r=s=>UY(t,e,s,{});return r.stream=(s,i)=>BY(t,e,s,i),r}function MM(t){return t.emulatorOrigin&&Ti(t.emulatorOrigin)?"include":void 0}async function FY(t,e,n,r,s){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:MM(s)})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}async function VM(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function UY(t,e,n,r){const s=t._url(e);return $Y(t,s,n,r)}async function $Y(t,e,n,r){n=ay(n);const s={data:n},i=await VM(t,r),o=r.timeout||7e4,a=LY(o),l=await Promise.race([FY(e,s,i,t.fetchImpl,t),a.promise,t.cancelAllRequests]);if(a.cancel(),!l)throw new vs("cancelled","Firebase Functions instance was deleted.");const c=ly(l.status,l.json);if(c)throw c;if(!l.json)throw new vs("internal","Response is not valid JSON object.");let u=l.json.data;if(typeof u>"u"&&(u=l.json.result),typeof u>"u")throw new vs("internal","Response is missing data field.");return{data:yd(u)}}function BY(t,e,n,r){const s=t._url(e);return zY(t,s,n,r||{})}async function zY(t,e,n,r){var m;n=ay(n);const s={data:n},i=await VM(t,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r==null?void 0:r.signal,credentials:MM(t)})}catch(p){if(p instanceof Error&&p.name==="AbortError"){const g=new vs("cancelled","Request was cancelled.");return{data:Promise.reject(g),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(g)}}}}}}const v=ly(0,null);return{data:Promise.reject(v),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(v)}}}}}}let a,l;const c=new Promise((p,v)=>{a=p,l=v});(m=r==null?void 0:r.signal)==null||m.addEventListener("abort",()=>{const p=new vs("cancelled","Request was cancelled.");l(p)});const u=o.body.getReader(),h=WY(u,a,l,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const p=h.getReader();return{async next(){const{value:v,done:g}=await p.read();return{value:v,done:g}},async return(){return await p.cancel(),{done:!0,value:void 0}}}}},data:c}}function WY(t,e,n,r){const s=(o,a)=>{const l=o.match(OY);if(!l)return;const c=l[1];try{const u=JSON.parse(c);if("result"in u){e(yd(u.result));return}if("message"in u){a.enqueue(yd(u.message));return}if("error"in u){const h=ly(0,u);a.error(h),n(h);return}}catch(u){if(u instanceof vs){a.error(u),n(u);return}}},i=new TextDecoder;return new ReadableStream({start(o){let a="";return l();async function l(){if(r!=null&&r.aborted){const c=new vs("cancelled","Request was cancelled");return o.error(c),n(c),Promise.resolve()}try{const{value:c,done:u}=await t.read();if(u){a.trim()&&s(a.trim(),o),o.close();return}if(r!=null&&r.aborted){const m=new vs("cancelled","Request was cancelled");o.error(m),n(m),await t.cancel();return}a+=i.decode(c,{stream:!0});const h=a.split(`
`);a=h.pop()||"";for(const m of h)m.trim()&&s(m.trim(),o);return l()}catch(c){const u=c instanceof vs?c:ly(0,null);o.error(u),n(u)}}},cancel(){return t.cancel()}})}const Z1="@firebase/functions",eP="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qY="auth-internal",HY="app-check-internal",KY="messaging-internal";function GY(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(qY),o=n.getProvider(KY),a=n.getProvider(HY);return new MY(s,i,o,a,r)};to(new _i(nI,e,"PUBLIC").setMultipleInstances(!0)),Os(Z1,eP,t),Os(Z1,eP,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QY(t=ev(),e=rb){const r=Tc(Dt(t),nI).getImmediate({identifier:e}),s=OE("functions");return s&&YY(r,...s),r}function YY(t,e,n){VY(Dt(t),e,n)}function JY(t,e,n){return jY(Dt(t),e)}GY();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jM="firebasestorage.googleapis.com",FM="storageBucket",XY=2*60*1e3,ZY=10*60*1e3,eJ=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn extends xi{constructor(e,n,r=0){super(Hw(e),`Firebase Storage: ${n} (${Hw(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Jn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Hw(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Mn;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Mn||(Mn={}));function Hw(t){return"storage/"+t}function rI(){const t="An unknown error occurred, please check the error payload for server response.";return new Jn(Mn.UNKNOWN,t)}function tJ(t){return new Jn(Mn.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function nJ(t){return new Jn(Mn.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function rJ(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Jn(Mn.UNAUTHENTICATED,t)}function sJ(){return new Jn(Mn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function iJ(t){return new Jn(Mn.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function UM(){return new Jn(Mn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function $M(){return new Jn(Mn.CANCELED,"User canceled the upload/download.")}function oJ(t){return new Jn(Mn.INVALID_URL,"Invalid URL '"+t+"'.")}function aJ(t){return new Jn(Mn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function lJ(){return new Jn(Mn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+FM+"' property when initializing the app?")}function BM(){return new Jn(Mn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function cJ(){return new Jn(Mn.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function uJ(){return new Jn(Mn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function dJ(t){return new Jn(Mn.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function sb(t){return new Jn(Mn.INVALID_ARGUMENT,t)}function zM(){return new Jn(Mn.APP_DELETED,"The Firebase app was deleted.")}function hJ(t){return new Jn(Mn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Xh(t,e){return new Jn(Mn.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function mh(t){throw new Jn(Mn.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Ns.makeFromUrl(e,n)}catch{return new Ns(e,"")}if(r.path==="")return r;throw aJ(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(P){P.path_=decodeURIComponent(P.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${s}/o${m}`,"i"),v={bucket:1,path:3},g=n===jM?"(?:storage.googleapis.com|storage.cloud.google.com)":n,E="([^?#]*)",b=new RegExp(`^https?://${g}/${s}/${E}`,"i"),S=[{regex:a,indices:l,postModify:i},{regex:p,indices:v,postModify:c},{regex:b,indices:{bucket:1,path:2},postModify:c}];for(let P=0;P<S.length;P++){const T=S[P],N=T.regex.exec(e);if(N){const I=N[T.indices.bucket];let A=N[T.indices.path];A||(A=""),r=new Ns(I,A),T.postModify(r);break}}if(r==null)throw oJ(e);return r}}class fJ{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mJ(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...E){c||(c=!0,e.apply(null,E))}function h(E){s=setTimeout(()=>{s=null,t(p,l())},E)}function m(){i&&clearTimeout(i)}function p(E,...b){if(c){m();return}if(E){m(),u.call(null,E,...b);return}if(l()||o){m(),u.call(null,E,...b);return}r<64&&(r*=2);let S;a===1?(a=2,S=0):S=(r+Math.random())*1e3,h(S)}let v=!1;function g(E){v||(v=!0,m(),!c&&(s!==null?(E||(a=2),clearTimeout(s),h(0)):E||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,g(!0)},n),g}function pJ(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gJ(t){return t!==void 0}function yJ(t){return typeof t=="function"}function vJ(t){return typeof t=="object"&&!Array.isArray(t)}function kv(t){return typeof t=="string"||t instanceof String}function tP(t){return sI()&&t instanceof Blob}function sI(){return typeof Blob<"u"}function nP(t,e,n,r){if(r<e)throw sb(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw sb(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wm(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function WM(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var ec;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ec||(ec={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qM(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wJ{constructor(e,n,r,s,i,o,a,l,c,u,h,m=!0,p=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=m,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,g)=>{this.resolve_=v,this.reject_=g,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new ap(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===ec.NO_ERROR,l=i.getStatus();if(!a||qM(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===ec.ABORT;r(!1,new ap(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new ap(c,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());gJ(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=rI();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?zM():$M();o(l)}else{const l=UM();o(l)}};this.canceled_?n(!1,new ap(!1,null,!0)):this.backoffId_=mJ(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&pJ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ap{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function _J(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function bJ(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function EJ(t,e){e&&(t["X-Firebase-GMPID"]=e)}function SJ(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function IJ(t,e,n,r,s,i,o=!0,a=!1){const l=WM(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return EJ(u,e),_J(u,n),bJ(u,i),SJ(u,r),new wJ(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TJ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function xJ(...t){const e=TJ();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(sI())return new Blob(t);throw new Jn(Mn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function AJ(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PJ(t){if(typeof atob>"u")throw dJ("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Kw{constructor(e,n){this.data=e,this.contentType=n||null}}function RJ(t,e){switch(t){case qi.RAW:return new Kw(HM(e));case qi.BASE64:case qi.BASE64URL:return new Kw(KM(t,e));case qi.DATA_URL:return new Kw(NJ(e),kJ(e))}throw rI()}function HM(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function CJ(t){let e;try{e=decodeURIComponent(t)}catch{throw Xh(qi.DATA_URL,"Malformed data URL.")}return HM(e)}function KM(t,e){switch(t){case qi.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Xh(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case qi.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Xh(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=PJ(e)}catch(s){throw s.message.includes("polyfill")?s:Xh(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class GM{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Xh(qi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=DJ(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function NJ(t){const e=new GM(t);return e.base64?KM(qi.BASE64,e.rest):CJ(e.rest)}function kJ(t){return new GM(t).contentType}function DJ(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e,n){let r=0,s="";tP(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(tP(this.data_)){const r=this.data_,s=AJ(r,e,n);return s===null?null:new po(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new po(r,!0)}}static getBlob(...e){if(sI()){const n=e.map(r=>r instanceof po?r.data_:r);return new po(xJ.apply(null,n))}else{const n=e.map(o=>kv(o)?RJ(qi.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new po(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QM(t){let e;try{e=JSON.parse(t)}catch{return null}return vJ(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OJ(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function LJ(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function YM(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MJ(t,e){return e}class Zr{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||MJ}}let lp=null;function VJ(t){return!kv(t)||t.length<2?t:YM(t)}function iI(){if(lp)return lp;const t=[];t.push(new Zr("bucket")),t.push(new Zr("generation")),t.push(new Zr("metageneration")),t.push(new Zr("name","fullPath",!0));function e(i,o){return VJ(o)}const n=new Zr("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Zr("size");return s.xform=r,t.push(s),t.push(new Zr("timeCreated")),t.push(new Zr("updated")),t.push(new Zr("md5Hash",null,!0)),t.push(new Zr("cacheControl",null,!0)),t.push(new Zr("contentDisposition",null,!0)),t.push(new Zr("contentEncoding",null,!0)),t.push(new Zr("contentLanguage",null,!0)),t.push(new Zr("contentType",null,!0)),t.push(new Zr("metadata","customMetadata",!0)),lp=t,lp}function jJ(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Ns(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function FJ(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return jJ(r,t),r}function JM(t,e,n){const r=QM(e);return r===null?null:FJ(t,r,n)}function UJ(t,e,n,r){const s=QM(e);if(s===null||!kv(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(c=>{const u=t.bucket,h=t.fullPath,m="/b/"+o(u)+"/o/"+o(h),p=wm(m,n,r),v=WM({alt:"media",token:c});return p+v})[0]}function XM(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class qd{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function To(t){if(!t)throw rI()}function oI(t,e){function n(r,s){const i=JM(t,s,e);return To(i!==null),i}return n}function $J(t,e){function n(r,s){const i=JM(t,s,e);return To(i!==null),UJ(i,s,t.host,t._protocol)}return n}function _m(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=sJ():s=rJ():n.getStatus()===402?s=nJ(t.bucket):n.getStatus()===403?s=iJ(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function ZM(t){const e=_m(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=tJ(t.path)),i.serverResponse=s.serverResponse,i}return n}function BJ(t,e,n){const r=e.fullServerUrl(),s=wm(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new qd(s,i,oI(t,n),o);return a.errorHandler=ZM(e),a}function zJ(t,e,n){const r=e.fullServerUrl(),s=wm(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new qd(s,i,$J(t,n),o);return a.errorHandler=ZM(e),a}function WJ(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function eV(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=WJ(null,e)),r}function tV(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let S="";for(let P=0;P<2;P++)S=S+Math.random().toString().slice(2);return S}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=eV(e,r,s),u=XM(c,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,m=`\r
--`+l+"--",p=po.getBlob(h,r,m);if(p===null)throw BM();const v={name:c.fullPath},g=wm(i,t.host,t._protocol),E="POST",b=t.maxUploadRetryTime,_=new qd(g,E,oI(t,n),b);return _.urlParams=v,_.headers=o,_.body=p.uploadData(),_.errorHandler=_m(e),_}class cy{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}}function aI(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{To(!1)}return To(!!n&&(e||["active"]).indexOf(n)!==-1),n}function qJ(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o=eV(e,r,s),a={name:o.fullPath},l=wm(i,t.host,t._protocol),c="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=XM(o,n),m=t.maxUploadRetryTime;function p(g){aI(g);let E;try{E=g.getResponseHeader("X-Goog-Upload-URL")}catch{To(!1)}return To(kv(E)),E}const v=new qd(l,c,p,m);return v.urlParams=a,v.headers=u,v.body=h,v.errorHandler=_m(e),v}function HJ(t,e,n,r){const s={"X-Goog-Upload-Command":"query"};function i(c){const u=aI(c,["active","final"]);let h=null;try{h=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{To(!1)}h||To(!1);const m=Number(h);return To(!isNaN(m)),new cy(m,r.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,l=new qd(n,o,i,a);return l.headers=s,l.errorHandler=_m(e),l}const rP=256*1024;function KJ(t,e,n,r,s,i,o,a){const l=new cy(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=r.size()),r.size()!==l.total)throw cJ();const c=l.total-l.current;let u=c;s>0&&(u=Math.min(u,s));const h=l.current,m=h+u;let p="";u===0?p="finalize":c===u?p="upload, finalize":p="upload";const v={"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":`${l.current}`},g=r.slice(h,m);if(g===null)throw BM();function E(P,T){const N=aI(P,["active","final"]),I=l.current+u,A=r.size();let R;return N==="final"?R=oI(e,i)(P,T):R=null,new cy(I,A,N==="final",R)}const b="POST",_=e.maxUploadRetryTime,S=new qd(n,b,E,_);return S.headers=v,S.body=g.uploadData(),S.progressCallback=a||null,S.errorHandler=_m(t),S}const us={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Gw(t){switch(t){case"running":case"pausing":case"canceling":return us.RUNNING;case"paused":return us.PAUSED;case"success":return us.SUCCESS;case"canceled":return us.CANCELED;case"error":return us.ERROR;default:return us.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GJ{constructor(e,n,r){if(yJ(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $c(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class QJ{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ec.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ec.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ec.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw mh("cannot .send() more than once");if(Ti(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw mh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw mh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw mh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw mh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class YJ extends QJ{initXhr(){this.xhr_.responseType="text"}}function Ol(){return new YJ}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JJ{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=iI(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(Mn.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const i=this.isExponentialBackoffExpired();if(qM(s.status,[]))if(i)s=UM();else{this.sleepTime=Math.max(this.sleepTime*2,eJ),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(Mn.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=qJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Ol,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const s=HJ(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,Ol,n,r);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=rP*this._chunkMultiplier,n=new cy(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,i)=>{let o;try{o=KJ(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(o,Ol,s,i,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){rP*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=BJ(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,Ol,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=tV(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Ol,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=$M(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Gw(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){const i=new GJ(n||void 0,r||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Gw(this._state)){case us.SUCCESS:$c(this._resolve.bind(null,this.snapshot))();break;case us.CANCELED:case us.ERROR:const n=this._reject;$c(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Gw(this._state)){case us.RUNNING:case us.PAUSED:e.next&&$c(e.next.bind(e,this.snapshot))();break;case us.SUCCESS:e.complete&&$c(e.complete.bind(e))();break;case us.CANCELED:case us.ERROR:e.error&&$c(e.error.bind(e,this._error))();break;default:e.error&&$c(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,n){this._service=e,n instanceof Ns?this._location=n:this._location=Ns.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new wc(e,n)}get root(){const e=new Ns(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return YM(this._location.path)}get storage(){return this._service}get parent(){const e=OJ(this._location.path);if(e===null)return null;const n=new Ns(this._location.bucket,e);return new wc(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw hJ(e)}}function XJ(t,e,n){t._throwIfRoot("uploadBytes");const r=tV(t.storage,t._location,iI(),new po(e,!0),n);return t.storage.makeRequestWithTokens(r,Ol).then(s=>({metadata:s,ref:t}))}function ZJ(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new JJ(t,new po(e),n)}function eX(t){t._throwIfRoot("getDownloadURL");const e=zJ(t.storage,t._location,iI());return t.storage.makeRequestWithTokens(e,Ol).then(n=>{if(n===null)throw uJ();return n})}function tX(t,e){const n=LJ(t._location.path,e),r=new Ns(t._location.bucket,n);return new wc(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nX(t){return/^[A-Za-z]+:\/\//.test(t)}function rX(t,e){return new wc(t,e)}function nV(t,e){if(t instanceof lI){const n=t;if(n._bucket==null)throw lJ();const r=new wc(n,n._bucket);return e!=null?nV(r,e):r}else return e!==void 0?tX(t,e):t}function sX(t,e){if(e&&nX(e)){if(t instanceof lI)return rX(t,e);throw sb("To use ref(service, url), the first argument must be a Storage instance.")}else return nV(t,e)}function sP(t,e){const n=e==null?void 0:e[FM];return n==null?null:Ns.makeFromBucketSpec(n,t)}function iX(t,e,n,r={}){t.host=`${e}:${n}`;const s=Ti(e);s&&(Zf(`https://${t.host}/b`),Xy("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:VD(i,t.app.options.projectId))}class lI{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=jM,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=XY,this._maxUploadRetryTime=ZY,this._requests=new Set,s!=null?this._bucket=Ns.makeFromBucketSpec(s,this._host):this._bucket=sP(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ns.makeFromBucketSpec(this._url,e):this._bucket=sP(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){nP("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){nP("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(hs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new wc(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new fJ(zM());{const o=IJ(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const iP="@firebase/storage",oP="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV="storage";function Xte(t,e,n){return t=Dt(t),XJ(t,e,n)}function oX(t,e,n){return t=Dt(t),ZJ(t,e,n)}function aX(t){return t=Dt(t),eX(t)}function lX(t,e){return t=Dt(t),sX(t,e)}function sV(t=ev(),e){t=Dt(t);const r=Tc(t,rV).getImmediate({identifier:e}),s=OE("storage");return s&&cX(r,...s),r}function cX(t,e,n,r={}){iX(t,e,n,r)}function uX(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new lI(n,r,s,e,xc)}function dX(){to(new _i(rV,uX,"PUBLIC").setMultipleInstances(!0)),Os(iP,oP,""),Os(iP,oP,"esm2020")}dX();const hX={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"0.0.0",VITE_DEV_MODE:"true",VITE_ENABLE_OFFLINE_PERSISTENCE:"false",VITE_FIREBASE_API_KEY:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),VITE_FIREBASE_APP_ID:"1:483702062341:web:b1ff06ad175cb7ae428b6c",VITE_FIREBASE_AUTH_DOMAIN:"voda-c6abd.firebaseapp.com",VITE_FIREBASE_AUTH_EMULATOR_URL:"http://localhost:9099",VITE_FIREBASE_FIRESTORE_EMULATOR_HOST:"localhost:8080",VITE_FIREBASE_FUNCTIONS_EMULATOR_HOST:"localhost:5001",VITE_FIREBASE_MEASUREMENT_ID:"G-CV6QGH7G7P",VITE_FIREBASE_MESSAGING_SENDER_ID:"483702062341",VITE_FIREBASE_PROJECT_ID:"voda-c6abd",VITE_FIREBASE_STORAGE_BUCKET:"voda-c6abd.appspot.com",VITE_FORCE_HASH_ROUTER:"true",VITE_SHOP_ID:"demo-shop-001",VITE_SHOP_NAME:"   ",VITE_SHOW_ENV_BANNER:"true",VITE_USE_EMULATORS:"false",VITE_USE_FIREBASE_EMULATOR:"false"},uy={apiKey:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),authDomain:"voda-c6abd.firebaseapp.com",projectId:"voda-c6abd",storageBucket:"voda-c6abd.appspot.com",messagingSenderId:"483702062341",appId:"1:483702062341:web:b1ff06ad175cb7ae428b6c"};console.log(" Initializing Firebase with config:",{projectId:uy.projectId,authDomain:uy.authDomain,emulatorMode:!1});const Dv=zD(uy);try{typeof window<"u",void 0||console.log(" App Check not initialized: missing VITE_FIREBASE_RECAPTCHA_KEY")}catch(t){console.log(" Failed to initialize App Check (will proceed without it):",t)}const qt=h2(Dv,{persistence:[zE,T0]});console.log(" Firebase Auth initialized with browserLocalPersistence (fallback to inMemory)");const F=uM(Dv,{experimentalForceLongPolling:!0,useFetchStreams:!1});try{B2("error")}catch{}const iV=QY(Dv,"us-central1");sV(Dv);console.log(" Firebase initialized successfully");const fX=async()=>{try{console.log(" Offline persistence disabled (env flag or emulator mode)"),console.log(" Firestore features configured successfully")}catch(t){console.error(" Error configuring Firestore features:",t)}};setTimeout(fX,100);let Rl=0;const Qw=3,mX=1e3,oV=async t=>{var e,n;if(console.error(" Firestore connection error:",t),(t.code==="unavailable"||t.code==="failed-precondition"||(e=t.message)!=null&&e.includes("ERR_ABORTED")||(n=t.message)!=null&&n.includes("UNAVAILABLE"))&&Rl<Qw){Rl++;const r=Math.min(mX*Math.pow(2,Rl-1),1e4);console.log(` Attempting to reconnect (${Rl}/${Qw}) in ${r}ms...`);try{await zS(F),await new Promise(s=>setTimeout(s,r)),await BS(F),console.log(" Firestore reconnected successfully"),Rl=0}catch(s){console.error(" Failed to reconnect:",s),Rl>=Qw&&(console.error(" Maximum reconnection attempts reached."),pX())}}},pX=()=>{const t=document.createElement("div");t.style.cssText=`
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #f8d7da;
    color: #721c24;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #f5c6cb;
    z-index: 10000;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    max-width: 400px;
  `,t.innerHTML=`
    <h3 style="margin: 0 0 10px 0;">  </h3>
    <p style="margin: 0 0 15px 0;">   .     .</p>
    <button onclick="window.location.reload()" style="
      background: #dc3545;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
    ">  </button>
  `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},1e4)};window.addEventListener("online",async()=>{console.log(" Network back online, enabling Firestore...");try{await BS(F),Rl=0,console.log(" Firestore network enabled")}catch(t){console.error(" Failed to enable Firestore network:",t)}});window.addEventListener("offline",async()=>{console.log(" Network offline, disabling Firestore network...");try{await zS(F),console.log(" Firestore network disabled")}catch(t){console.error(" Failed to disable Firestore network:",t)}});window.addEventListener("unhandledrejection",t=>{var e,n,r,s,i,o;(((e=t.reason)==null?void 0:e.code)==="unavailable"||((n=t.reason)==null?void 0:n.code)==="failed-precondition"||(s=(r=t.reason)==null?void 0:r.message)!=null&&s.includes("ERR_ABORTED")||(o=(i=t.reason)==null?void 0:i.message)!=null&&o.includes("UNAVAILABLE"))&&(oV(t.reason),t.preventDefault())});console.log("Using Firebase Production Environment");const En=Object.freeze(Object.defineProperty({__proto__:null,auth:qt,db:F,firebaseConfig:uy,functions:iV,handleFirestoreError:oV},Symbol.toStringTag,{value:"Module"})),It=t=>{if(t&&typeof t=="object"&&typeof t.toDate=="function")return t.toDate();if(t instanceof Date)return t;if(typeof t=="number")return new Date(t);if(typeof t=="string"){const e=new Date(t);return isNaN(e.getTime())?new Date:e}return new Date},gX=t=>{if(t===null)return!1;const e=Object.getPrototypeOf(t);return e===Object.prototype||e===null},nl=t=>{if(t===void 0)return;if(t===null)return null;if(Array.isArray(t))return t.map(n=>nl(n)).filter(n=>n!==void 0);if(t instanceof Date||!gX(t))return t;const e={};for(const[n,r]of Object.entries(t)){const s=nl(r);s!==void 0&&(e[n]=s)}return e},Zh={async create(t){await rn(ye(F,"profiles",t.userId),{userId:t.userId,shopId:t.shopId,role:t.role,fullName:t.fullName,phone:t.phone,createdAt:Be()})},async getById(t){const e=ye(F,"profiles",t),n=await Sn(e);if(n.exists()){const r=n.data();return{userId:n.id,...r,createdAt:It(r.createdAt)}}return null},async update(t,e){const n=ye(F,"profiles",t);await xn(n,{...e,updatedAt:Be()})},async getByShopId(t){const e=Ye(xe(F,"profiles"),Oe("shopId","==",t));return(await et(e)).docs.map(r=>{const s=r.data();return{userId:r.id,...s,createdAt:It(s.createdAt)}})}},ib={async create(t){return(await Ls(xe(F,"referrals"),{...t,createdAt:Be(),updatedAt:Be()})).id},async getByReferrerId(t){try{const e=Ye(xe(F,"referrals"),Oe("referrerId","==",t),Gs("createdAt","desc"));return(await et(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:It(r.data().createdAt),updatedAt:It(r.data().updatedAt)}))}catch(e){if(String((e==null?void 0:e.message)||"").includes("requires an index")){const r=Ye(xe(F,"referrals"),Oe("referrerId","==",t));return(await et(r)).docs.map(i=>({id:i.id,...i.data(),createdAt:It(i.data().createdAt),updatedAt:It(i.data().updatedAt)})).sort((i,o)=>{var a,l,c,u;return(((l=(a=o.createdAt)==null?void 0:a.getTime)==null?void 0:l.call(a))||0)-(((u=(c=i.createdAt)==null?void 0:c.getTime)==null?void 0:u.call(c))||0)})}throw e}},async getByReferralCode(t){const e=Ye(xe(F,"referrals"),Oe("referralCode","==",t),di(1)),n=await et(e);if(n.empty)return null;const r=n.docs[0];return{id:r.id,...r.data(),createdAt:It(r.data().createdAt),updatedAt:It(r.data().updatedAt)}},async updateStatus(t,e){await xn(ye(F,"referrals",t),{status:e,updatedAt:Be()})},generateReferralCode(t){const e=Date.now().toString(36);return`REF_${t.slice(-6)}_${e}`.toUpperCase()}},aV={async getLastTransactions(t,e=30){try{const{getLastTransactions:n}=await ee(async()=>{const{getLastTransactions:s}=await import("./functions-VHUwf-oY.js");return{getLastTransactions:s}},[],import.meta.url);return(await n({walletId:t,limit:e})).transactions}catch(n){console.error("Error in getLastTransactions:",n);const r=Ye(xe(F,"transactions"),Oe("shopId","==",t));return(await et(r)).docs.map(o=>{const a=o.data();return{id:o.id,...a,createdAt:It(a.createdAt)}}).sort((o,a)=>{const l=o.createdAt?new Date(o.createdAt).getTime():0;return(a.createdAt?new Date(a.createdAt).getTime():0)-l}).slice(0,e)}},async getMerchantTransactions(t,e=30){try{const{getLastTransactions:n}=await ee(async()=>{const{getLastTransactions:s}=await import("./functions-VHUwf-oY.js");return{getLastTransactions:s}},[],import.meta.url);return(await n({merchantUserId:t,limit:e})).transactions}catch(n){console.error("Error in getMerchantTransactions:",n);const r=Ye(xe(F,"transactions"),Oe("merchantUserId","==",t));return(await et(r)).docs.map(o=>{const a=o.data();return{id:o.id,...a,createdAt:It(a.createdAt)}}).sort((o,a)=>{const l=o.createdAt?new Date(o.createdAt).getTime():0;return(a.createdAt?new Date(a.createdAt).getTime():0)-l}).slice(0,e)}}},lV={async getByUserId(t){const e=Ye(xe(F,"profiles"),Oe("userId","==",t)),n=await et(e);if(!n.empty){const r=n.docs[0],s=r.data();return{userId:r.id,...s,createdAt:It(s.createdAt),updatedAt:It(s.updatedAt)}}return null},async update(t,e){const n=Ye(xe(F,"profiles"),Oe("userId","==",t)),r=await et(n);if(!r.empty){const s=ye(F,"profiles",r.docs[0].id);await xn(s,{...e,updatedAt:Be()})}}},Pa={async create(t){return(await Ls(xe(F,"merchantWallets"),{...t,transferLimit:t.transferLimit||2e5,withdrawLimit:t.withdrawLimit||2e5,transferUsage:t.transferUsage||0,withdrawUsage:t.withdrawUsage||0,createdAt:Be(),updatedAt:Be()})).id},async getByMerchantId(t){const e=Ye(xe(F,"merchantWallets"),Oe("merchantUserId","==",t)),r=(await et(e)).docs.map(a=>{const l=a.data();return{id:a.id,...l,transferLimit:l.transferLimit||2e5,withdrawLimit:l.withdrawLimit||2e5,transferUsage:l.transferUsage||0,withdrawUsage:l.withdrawUsage||0,createdAt:It(l.createdAt),updatedAt:It(l.updatedAt)}});if(r.length>0)return r.sort((a,l)=>{const c=a.createdAt,u=l.createdAt;return c&&u?u.getTime()-c.getTime():c&&!u?-1:!c&&u?1:0});const s=Ye(xe(F,"wallets"),Oe("userId","==",t));return(await et(s)).docs.map(a=>{const l=a.data();return{id:a.id,merchantUserId:l.userId||t,provider:l.provider||"instapay",msisdn:l.msisdn||"",label:l.name||l.label||"",isActive:l.isActive!==!1,dailyLimit:l.dailyLimit||2e5,monthlyLimit:l.monthlyLimit||2e5,transferLimit:l.transferLimit||l.monthlyTransferLimit||2e5,withdrawLimit:l.withdrawLimit||l.monthlyWithdrawLimit||2e5,transferUsage:l.transferUsage||l.monthlyTransferUsage||0,withdrawUsage:l.withdrawUsage||l.monthlyWithdrawUsage||0,dailyTransferLimit:l.dailyTransferLimit,dailyWithdrawLimit:l.dailyWithdrawLimit,createdAt:It(l.createdAt),updatedAt:It(l.updatedAt)}}).sort((a,l)=>{const c=a.createdAt,u=l.createdAt;return c&&u?u.getTime()-c.getTime():c&&!u?-1:!c&&u?1:0})},async getById(t){const e=ye(F,"merchantWallets",t),n=await Sn(e);if(n.exists()){const r=n.data();return{id:n.id,...r,transferLimit:r.transferLimit||2e5,withdrawLimit:r.withdrawLimit||2e5,transferUsage:r.transferUsage||0,withdrawUsage:r.withdrawUsage||0,createdAt:It(r.createdAt),updatedAt:It(r.updatedAt)}}return null},async getByIccid(t){try{if(!t)return null;const e=Ye(xe(F,"merchantWallets"),Oe("iccid","==",t)),n=await et(e);if(!n.empty){const r=n.docs[0],s=r.data();return{id:r.id,...s,transferLimit:s.transferLimit||2e5,withdrawLimit:s.withdrawLimit||2e5,transferUsage:s.transferUsage||0,withdrawUsage:s.withdrawUsage||0,createdAt:It(s.createdAt),updatedAt:It(s.updatedAt)}}return null}catch(e){return console.warn("getByIccid failed:",e),null}},async getByMsisdn(t){try{const e=String(t||"").replace(/\D/g,"");if(!e)return null;let n=Ye(xe(F,"merchantWallets"),Oe("msisdn","==",t)),r=await et(n);if(!r.empty){const a=r.docs[0],l=a.data();return{id:a.id,...l,transferLimit:l.transferLimit||2e5,withdrawLimit:l.withdrawLimit||2e5,transferUsage:l.transferUsage||0,withdrawUsage:l.withdrawUsage||0,createdAt:It(l.createdAt),updatedAt:It(l.updatedAt)}}const s=Ye(xe(F,"merchantWallets")),i=await et(s),o=e.slice(-7);for(const a of i.docs){const l=a.data();if(String(l.msisdn||"").replace(/\D/g,"").slice(-7)===o)return{id:a.id,...l,transferLimit:l.transferLimit||2e5,withdrawLimit:l.withdrawLimit||2e5,transferUsage:l.transferUsage||0,withdrawUsage:l.withdrawUsage||0,createdAt:It(l.createdAt),updatedAt:It(l.updatedAt)}}return null}catch(e){return console.warn("getByMsisdn failed:",e),null}},async update(t,e){const n=ye(F,"merchantWallets",t);await xn(n,{...e,updatedAt:Be()})},async updateUsage(t,e,n){const r=ye(F,"merchantWallets",t),s={updatedAt:Be()};e!==void 0&&(s.transferUsage=e),n!==void 0&&(s.withdrawUsage=n),await xn(r,s)},async resetDailyUsage(t){const n=(await this.getByMerchantId(t)).map(r=>this.updateUsage(r.id,0,0));await Promise.all(n)},async reassignByMsisdns(t,e){try{if(!e)throw new Error("merchantUserId   ");if(!Array.isArray(t)||t.length===0)return{updated:0,failed:0};const r=((o,a)=>o.reduce((l,c,u)=>(u%a===0&&l.push(o.slice(u,u+a)),l),[]))(t.map(o=>o.trim()).filter(Boolean),10);let s=0,i=0;for(const o of r){const a=Ye(xe(F,"merchantWallets"),Oe("msisdn","in",o)),c=(await et(a)).docs.map(async u=>{try{const h=u.data();if(h.merchantUserId&&h.merchantUserId!==e)return;await xn(u.ref,{merchantUserId:e,updatedAt:Be()}),s+=1}catch(h){console.error("Failed to reassign wallet",u.id,h),i+=1}});await Promise.allSettled(c)}return{updated:s,failed:i}}catch(n){return console.error("Error reassigning wallets by msisdns:",n),{updated:0,failed:t.length}}},async delete(t){const e=ye(F,"merchantWallets",t);await Hn(e)}},cI={async create(t){try{console.log("Creating transaction:",t);const{calculateCommission:e,calculateProfit:n}=await ee(async()=>{const{calculateCommission:c,calculateProfit:u}=await Promise.resolve().then(()=>Eo);return{calculateCommission:c,calculateProfit:u}},void 0,import.meta.url),r=t.commission!==void 0?t.commission:e(t.amount,t.txnType),s=n(t.amount,t.txnType),i=t.merchantUserId||t.createdBy;i||console.warn("   merchantUserId  createdBy         .");const o=Object.fromEntries(Object.entries(t).filter(([c,u])=>u!==void 0)),a={...o,merchantUserId:i,commission:r,profit:s,createdAt:o.createdAt?o.createdAt instanceof Date?o.createdAt:new Date(String(o.createdAt)):new Date,uploadedAt:Be(),confirmedAt:o.confirmedAt?o.confirmedAt instanceof Date?o.confirmedAt:new Date(String(o.confirmedAt)):null},l=await Ls(xe(F,"transactions"),a);if(console.log("Transaction created with ID:",l.id,"Profit:",s),s>0){const{ProfitService:c}=await ee(async()=>{const{ProfitService:u}=await import("./profitService-9EsNGq16.js");return{ProfitService:u}},[],import.meta.url);try{c.addProfit(s,i)}catch{c.addProfit(s)}console.log("     :",s,"")}await this.updateLineUsage(t.lineId,t.amount);try{const c=String((t==null?void 0:t.walletId)||"").trim();if(c){const u=await Pa.getById(c),h=Number((u==null?void 0:u.transferUsage)||0),m=Number((u==null?void 0:u.withdrawUsage)||0),p=Number(t.amount||0),v=String((t==null?void 0:t.originType)||"").trim()==="withdraw",g=String(t.txnType||"")==="receive";v||g?await Pa.updateUsage(c,void 0,m+p):await Pa.updateUsage(c,h+p,void 0)}}catch{}try{const c=Number(t.amount||0),u=String((t==null?void 0:t.receiverMsisdn)||"").trim(),h=String((t==null?void 0:t.walletId)||"").trim(),m=String((t==null?void 0:t.originType)||"").trim();let p="";if(h)try{const g=await Pa.getById(h);p=String((g==null?void 0:g.msisdn)||(g==null?void 0:g.label)||h).trim()}catch{}let v="";m==="withdraw"?v=p?`   ${c}   ${p}    ${r}`:`   ${c}    ${r}`:m==="transfer"||t.txnType==="send"?v=`   ${c}   ${p||" "}   ${u||""}    ${r}`:v=p?`  ${c}   ${p}`:`  ${c}`}catch{}return l.id}catch(e){throw console.error("Error creating transaction:",e),e}},async updateLineUsage(t,e){try{console.log("Updating line usage:",{lineId:t,amount:e})}catch(n){console.error("Error updating line usage:",n)}},async getByShopId(t){const e=Ye(xe(F,"transactions"),Oe("shopId","==",t),Gs("createdAt","desc"));return(await et(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:It(r.data().createdAt),confirmedAt:r.data().confirmedAt?It(r.data().confirmedAt):void 0}))},async getByMerchantId(t){const e=Ye(xe(F,"transactions"),Oe("merchantUserId","==",t),Gs("createdAt","desc"));return(await et(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:It(r.data().createdAt),confirmedAt:r.data().confirmedAt?It(r.data().confirmedAt):void 0}))},async getByUserId(t){const e=Ye(xe(F,"transactions"),Oe("merchantUserId","==",t)),n=Ye(xe(F,"transactions"),Oe("userId","==",t)),[r,s]=await Promise.all([et(e),et(n)]),i=[...r.docs,...s.docs],o=new Set,a=[];for(const l of i){if(o.has(l.id))continue;o.add(l.id);const c=l.data();a.push({id:l.id,...c,createdAt:It(c.createdAt),confirmedAt:c.confirmedAt?It(c.confirmedAt):void 0})}return a.sort((l,c)=>{const u=l.createdAt,h=c.createdAt;return u&&h?h.getTime()-u.getTime():u&&!h?-1:!u&&h?1:0})},async updateStatus(t,e,n){const r=ye(F,"transactions",t);await xn(r,{status:e,confirmedAt:n?n instanceof Date?n:new Date(String(n)):null})}};async function yX(t){const e=t.txnType||"receive",n=Date.now(),r=o=>String(o||"").replace(/\D/g,"").slice(-5);try{const o=await aV.getMerchantTransactions(t.createdBy,50),a=r(e==="send"?t.senderMsisdn||t.lineId:t.senderMsisdn),l=String(t.provider||"vodafone_cash").toLowerCase();for(const c of o){const u=c!=null&&c.createdAt?new Date(c.createdAt).getTime():0;if(Math.abs(n-u)<=1e4){const h=Number((c==null?void 0:c.amount)||0)===Number(t.amount||0),m=String((c==null?void 0:c.provider)||"").toLowerCase()===l,p=r((c==null?void 0:c.senderMsisdn)||(c==null?void 0:c.receiverMsisdn)||(c==null?void 0:c.senderPhone)||(c==null?void 0:c.receiverPhone));if(h&&m&&p&&a&&p===a)return String((c==null?void 0:c.id)||"")}}}catch{}const s={shopId:t.shopId,lineId:t.lineId,merchantUserId:t.createdBy,walletId:t.walletId,provider:t.provider||"vodafone_cash",txnType:e,originType:e==="send"?"send":"withdraw",amount:t.amount,receiverMsisdn:e==="send"?t.senderMsisdn:t.lineId,senderMsisdn:e==="send"?t.lineId:t.senderMsisdn,senderName:t.senderName,reference:t.reference,rawText:t.text,note:t.note,createdBy:t.createdBy,createdAt:new Date,confirmedAt:new Date,status:"confirmed"},i=await cI.create(s);try{const{calculateCommission:o}=await ee(async()=>{const{calculateCommission:c}=await Promise.resolve().then(()=>Eo);return{calculateCommission:c}},void 0,import.meta.url),a=o(Number(t.amount||0),e),l={transactionId:i,userId:t.createdBy,transactionType:e==="send"?"send":"withdraw",txnType:e,status:"confirmed",amount:Number(t.amount||0),commission:a,senderMsisdn:e==="send"?t.lineId:t.senderMsisdn,receiverMsisdn:e==="send"?t.senderMsisdn:t.lineId,fromWallet:t.walletId,note:t.note||"SMS-VF",reference:t.reference,createdAt:new Date,cashierName:" "};await mr.saveUserTransaction(t.createdBy,l)}catch{}return(async()=>{try{const{calculateCommission:o}=await ee(async()=>{const{calculateCommission:m}=await Promise.resolve().then(()=>Eo);return{calculateCommission:m}},void 0,import.meta.url),a=o(Number(t.amount||0),e),l=await mr.getUserData(t.createdBy),c={...(l==null?void 0:l.walletBalances)||{}},u=Math.max(0,Number(c[t.walletId]||0)),h=Math.max(0,Number(t.amount||0));if(e==="send"){c[t.walletId]=u-h;const m=Number((l==null?void 0:l.cashBalance)||0),p=Math.round(m+h+Math.max(0,a));await mr.updateUserData(t.createdBy,{walletBalances:c,cashBalance:p,lastUpdated:new Date().toISOString()})}else{c[t.walletId]=u+h;const m=Number((l==null?void 0:l.cashBalance)||0),p=Math.round(m-h+Math.max(0,a));await mr.updateUserData(t.createdBy,{walletBalances:c,cashBalance:p,lastUpdated:new Date().toISOString()})}}catch{}})(),(async()=>{try{const{walletDailyLimitsService:o}=await ee(async()=>{const{walletDailyLimitsService:l}=await Promise.resolve().then(()=>Uf);return{walletDailyLimitsService:l}},void 0,import.meta.url),a=Math.max(0,Number(t.amount||0));await o.updateUsage(String(t.walletId),a,e==="send"?"transfer":"withdraw")}catch(o){console.warn("      SMS:",o)}})(),i}const vX="https://summer-cake-5149.alkaptin2030.workers.dev",cV={async getTelegramWorkerUrl(){var t;try{const e=ye(F,"systemSettings","core"),n=await Sn(e);return n.exists()&&String(((t=n.data())==null?void 0:t.telegramWorkerUrl)||"").trim()||null}catch{return null}},async setTelegramWorkerUrl(t){const e=ye(F,"systemSettings","core");await rn(e,{telegramWorkerUrl:t,updatedAt:Be()},{merge:!0})}},wX={async send(t,e){try{const n=await mr.getUserData(t),r=String((n==null?void 0:n.telegramChatId)||(n==null?void 0:n.chat_id)||"").trim();if(!r)throw new Error("Telegram Chat ID   ");const i=(await cV.getTelegramWorkerUrl()||vX).replace(/\/$/,""),o=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:r,text:e})});if(!o.ok){const a=await o.text().catch(()=>"");throw new Error(a||"     ")}}catch{}}},_X={async log(t,e,n,r,s){await Ls(xe(F,"auditLogs"),{actor:s,action:t,entity:e,entityId:n,meta:r,createdAt:Be()})},async getLogs(t=100){const e=Ye(xe(F,"auditLogs"),Gs("createdAt","desc"),di(t));return(await et(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:It(r.data().createdAt)}))},async getDeletedTransactions(){try{const t=Ye(xe(F,"deletedTransactions"),Gs("deletedAt","desc"));return(await et(t)).docs.map(n=>({id:n.id,...n.data(),deletedAt:It(n.data().deletedAt)}))}catch(t){return console.error("Error getting deleted transactions:",t),[]}},async getDeletedTransactionsByUser(t){try{const e=Ye(xe(F,"deletedTransactions"),Oe("userId","==",t),Gs("deletedAt","desc"));return(await et(e)).docs.map(r=>({id:r.id,...r.data(),deletedAt:It(r.data().deletedAt)})).filter(r=>(r==null?void 0:r.permanent)!==!0)}catch(e){if(String((e==null?void 0:e.message)||"").includes("requires an index"))try{const r=Ye(xe(F,"deletedTransactions"),Oe("userId","==",t));return(await et(r)).docs.map(o=>({id:o.id,...o.data(),deletedAt:It(o.data().deletedAt)})).filter(o=>(o==null?void 0:o.permanent)!==!0).sort((o,a)=>{const l=(o.deletedAt instanceof Date?o.deletedAt:new Date(o.deletedAt)).getTime();return(a.deletedAt instanceof Date?a.deletedAt:new Date(a.deletedAt)).getTime()-l})}catch(r){return console.error("Fallback error getting deleted transactions by user:",r),[]}return console.error("Error getting deleted transactions by user:",e),[]}},async saveDeletedTransaction(t){var e;try{if(console.log("      Firebase:",t.id),!t.userId)throw new Error("     ");if(!t.originalTransactionId)throw new Error("   ");const n=t.reference??t.transactionReference??((e=t.receipt)==null?void 0:e.reference),r={...t,deletedAt:Be(),userId:t.userId,originalTransactionId:t.originalTransactionId,type:t.type||"unknown",amount:t.amount||0,status:t.status||"deleted",...n?{reference:n}:{}};console.log("    :",r);let s=3,i;for(;s>0;)try{const o=await Ls(xe(F,"deletedTransactions"),r);console.log("       :",o.id);return}catch(o){i=o,s--,console.warn(`       : ${s}`,o),s>0&&await new Promise(a=>setTimeout(a,1e3))}throw console.error("        "),i}catch(n){throw console.error("     :",n),n instanceof Error&&(n.message.includes("network")?console.error("    -    "):n.message.includes("permission")?console.error("    -    Firestore"):n.message.includes("quota")&&console.error("     -    Firebase")),n}},async permanentlyDeleteTransaction(t,e){try{const n=Ye(xe(F,"deletedTransactions"),Oe("originalTransactionId","==",t),Oe("userId","==",e)),r=await et(n);r.empty?await Ls(xe(F,"deletedTransactions"),{userId:e,originalTransactionId:t,permanent:!0,deletedAt:Be()}):await Promise.all(r.docs.map(s=>xn(s.ref,{permanent:!0,deletedAt:Be()}))),console.log("    :",t);try{const s=Ye(xe(F,"userTransactions"),Oe("userId","==",e)),o=(await et(s)).docs.filter(a=>{var c,u;const l=a.data();return a.id===t||l.id===t||l.transactionId===t||l.originalTransactionId===t||((c=l.receipt)==null?void 0:c.id)===t||((u=l.receipt)==null?void 0:u.transactionId)===t});o.length>0&&(console.log(`  ${o.length}   userTransactions`),await Promise.all(o.map(a=>Hn(a.ref))))}catch(s){console.warn("   userTransactions   :",s)}try{const s=ye(F,"transactions",t);(await Sn(s)).exists()&&(console.log("     transactions  "),await Hn(s));const o=Ye(xe(F,"transactions"),Oe("transactionId","==",t)),a=await et(o);a.empty||(console.log(`  ${a.size}   transactions  transactionId`),await Promise.all(a.docs.map(u=>Hn(u.ref))));const l=Ye(xe(F,"transactions"),Oe("originalTransactionId","==",t)),c=await et(l);c.empty||(console.log(`  ${c.size}   transactions  originalTransactionId`),await Promise.all(c.docs.map(u=>Hn(u.ref))));try{const u=Ye(xe(F,"deletedTransactions"),Oe("userId","==",e),Oe("originalTransactionId","==",t)),h=await et(u),m=h.docs.map(v=>{var g;return String(((g=v.data())==null?void 0:g.reference)||"")}).filter(Boolean),p=h.docs.map(v=>{var g;return String(((g=v.data())==null?void 0:g.transactionId)||"")}).filter(Boolean);for(const v of m){const g=Ye(xe(F,"transactions"),Oe("reference","==",v)),E=await et(g);E.empty||(console.log(`  ${E.size}   transactions  reference=${v}`),await Promise.all(E.docs.map(b=>Hn(b.ref))))}for(const v of p){try{const b=ye(F,"transactions",v);(await Sn(b)).exists()&&(console.log("     transactions  :",v),await Hn(b))}catch{}const g=Ye(xe(F,"transactions"),Oe("transactionId","==",v)),E=await et(g);E.empty||(console.log(`  ${E.size}   transactions  transactionId=${v}`),await Promise.all(E.docs.map(b=>Hn(b.ref))))}}catch{}}catch(s){console.warn("    transactions   :",s)}}catch(n){throw console.error("Error permanently deleting transaction:",n),n}}},uV={async add(t){const e=xe(F,"daily_reports_archive");return(await Ls(e,{userId:t.userId,reportDate:t.reportDate,totalTransactions:t.totalTransactions,totalAmount:t.totalAmount,totalWithdrawn:t.totalWithdrawn,totalSent:t.totalSent,profit:t.profit??null,walletId:t.walletId??null,cashBalance:t.cashBalance??null,walletsTotal:t.walletsTotal??null,walletBalances:t.walletBalances?nl(t.walletBalances):null,salesToday:t.salesToday??null,debtsToday:t.debtsToday??null,maintenanceProfitToday:t.maintenanceProfitToday??null,createdAt:Be(),updatedAt:Be()})).id},async getByUser(t,e=50){var n,r,s,i;try{const o=Ye(xe(F,"daily_reports_archive"),Oe("userId","==",t),di(e)),a=await et(o);let l=[];try{l=(await et(Ye(xe(F,"deletedDailyArchives"),Oe("userId","==",t)))).docs.map(v=>{var g,E;return{id:v.id,reportDate:String(((g=v.data())==null?void 0:g.reportDate)||""),archiveId:String(((E=v.data())==null?void 0:E.archiveId)||"")}})}catch{}const c=(p,v)=>l.some(g=>g.archiveId&&g.archiveId===p||g.reportDate&&g.reportDate===v),u=a.docs.map(p=>({id:p.id,userId:String(p.data().userId),reportDate:String(p.data().reportDate),totalTransactions:Number(p.data().totalTransactions||0),totalAmount:Number(p.data().totalAmount||0),totalWithdrawn:Number(p.data().totalWithdrawn||0),totalSent:Number(p.data().totalSent||0),profit:p.data().profit!==void 0?Number(p.data().profit):void 0,walletId:p.data().walletId??null,cashBalance:p.data().cashBalance!==void 0?Number(p.data().cashBalance):void 0,walletsTotal:p.data().walletsTotal!==void 0?Number(p.data().walletsTotal):void 0,walletBalances:p.data().walletBalances??void 0,salesToday:p.data().salesToday!==void 0?Number(p.data().salesToday):void 0,debtsToday:p.data().debtsToday!==void 0?Number(p.data().debtsToday):void 0,maintenanceProfitToday:p.data().maintenanceProfitToday!==void 0?Number(p.data().maintenanceProfitToday):void 0,createdAt:It(p.data().createdAt||p.data().updatedAt)})).filter(p=>!c(p.id,p.reportDate)),h=new Map;for(const p of u){const v=h.get(p.reportDate);(!v||(((r=(n=p.createdAt)==null?void 0:n.getTime)==null?void 0:r.call(n))||0)>(((i=(s=v.createdAt)==null?void 0:s.getTime)==null?void 0:i.call(s))||0))&&h.set(p.reportDate,p)}const m=Array.from(h.values());return m.sort((p,v)=>p.reportDate<v.reportDate?1:-1),m}catch(o){throw console.error("Error loading daily reports archive:",o),o}},async deleteOlderThan(t,e=10){try{const n=new Date;n.setDate(n.getDate()-e);const r=Ye(xe(F,"daily_reports_archive"),Oe("userId","==",t)),s=await et(r);let i=0;for(const o of s.docs){const a=It(o.data().createdAt);a&&a.getTime()<n.getTime()&&(await Hn(o.ref),i++)}return i>0&&console.log(`   ${i}      ${e}   ${t}`),i}catch(n){throw console.error("Error deleting old daily reports archive:",n),n}},async trimToMaxCount(t,e=10){try{const n=Ye(xe(F,"daily_reports_archive"),Oe("userId","==",t)),s=(await et(n)).docs.map(o=>({ref:o.ref,reportDate:String(o.data().reportDate||""),createdAt:It(o.data().createdAt)}));if(s.sort((o,a)=>{var u,h;if(o.reportDate&&a.reportDate)return o.reportDate<a.reportDate?1:-1;const l=((u=o.createdAt)==null?void 0:u.getTime())??0;return(((h=a.createdAt)==null?void 0:h.getTime())??0)-l}),s.length<=e)return 0;const i=s.slice(e);for(const o of i)await Hn(o.ref);return console.log(`     ${t}  ${e}   ${i.length}`),i.length}catch(n){throw console.error("Error trimming daily reports archive to max count:",n),n}},async deleteAllByUser(t){try{const e=Ye(xe(F,"daily_reports_archive"),Oe("userId","==",t)),n=await et(e);let r=0;for(const s of n.docs)try{await Hn(s.ref),r++}catch{const o=s.data();try{await Ls(xe(F,"deletedDailyArchives"),{userId:t,archiveId:s.id,reportDate:String((o==null?void 0:o.reportDate)||""),createdAt:Be()})}catch{}}return r}catch(e){throw console.error("Error deleting all daily reports archive for user:",e),e}}},mr={async getUserData(t){try{console.log("     :",{userId:t});const e=ye(F,"users",t),n=await Sn(e);if(n.exists()){const r=n.data();return console.log("     :",r),{...r,createdAt:It(r.createdAt),updatedAt:It(r.updatedAt)}}else{console.log("       ");const r={walletBalances:{},createdAt:new Date,updatedAt:new Date};return await this.saveUserData(t,r),console.log("     "),r}}catch(e){return console.error("      :",e),{walletBalances:{},createdAt:new Date,updatedAt:new Date}}},getLocalReceipts(t){try{const e=localStorage.getItem(`localReceipts_${t}`);if(!e)return[];const n=JSON.parse(e);return Array.isArray(n)?n:[]}catch{return[]}},saveLocalReceipt(t,e){try{const n=this.getLocalReceipts(t),r=200,s=l=>{var c;return String((l==null?void 0:l.id)||(l==null?void 0:l.transactionId)||(l==null?void 0:l.originalTransactionId)||(l==null?void 0:l.reference)||(l==null?void 0:l.transactionReference)||((c=l==null?void 0:l.receipt)==null?void 0:c.reference)||`${(l==null?void 0:l.type)||"tx"}-${new Date((l==null?void 0:l.createdAt)||Date.now()).getTime()}`)},i=s(e),o=n.filter(l=>s(l)!==i),a=[e,...o].slice(0,r);localStorage.setItem(`localReceipts_${t}`,JSON.stringify(a))}catch{}},removeLocalReceiptById(t,e){try{const r=this.getLocalReceipts(t).filter(s=>{var o,a;return![s==null?void 0:s.id,s==null?void 0:s.transactionId,s==null?void 0:s.originalTransactionId,(o=s==null?void 0:s.receipt)==null?void 0:o.transactionId,(a=s==null?void 0:s.receipt)==null?void 0:a.id].map(l=>String(l||"")).includes(String(e))});localStorage.setItem(`localReceipts_${t}`,JSON.stringify(r))}catch{}},removeLocalReceiptByRef(t,e){try{if(!e)return;const r=this.getLocalReceipts(t).filter(s=>{var o;return![s==null?void 0:s.reference,s==null?void 0:s.transactionReference,(o=s==null?void 0:s.receipt)==null?void 0:o.reference].map(a=>String(a||"")).includes(String(e))});localStorage.setItem(`localReceipts_${t}`,JSON.stringify(r))}catch{}},async syncDeletedTransactionsLocal(t){try{const e=Ye(xe(F,"deletedTransactions"),Oe("userId","==",t));(await et(e)).docs.forEach(r=>{const s=r.data();if(!((s==null?void 0:s.permanent)===!0))return;const o=String((s==null?void 0:s.originalTransactionId)||""),a=String((s==null?void 0:s.transactionId)||""),l=String((s==null?void 0:s.reference)||"");o&&this.removeLocalReceiptById(t,o),a&&this.removeLocalReceiptById(t,a),l&&this.removeLocalReceiptByRef(t,l)})}catch(e){console.warn("syncDeletedTransactionsLocal failed:",e)}},async factoryResetUserData(t,e){const n={},r=[],s=(e==null?void 0:e.excludeProducts)??!1,i=async(u,h)=>{if(u.length===0)return 0;const m=400;let p=0;try{for(let v=0;v<u.length;v+=m){const g=Nv(F),E=u.slice(v,v+m);E.forEach(b=>{g.delete(b.ref)}),await g.commit(),p+=E.length,console.log(` Deleted ${E.length} docs from ${h} (Batch ${Math.floor(v/m)+1})`)}}catch(v){console.error(`Error batch deleting ${h}:`,v),r.push(`${h}: ${(v==null?void 0:v.message)||String(v)}`)}return p},o=async(u,h,m)=>{try{const p=Ye(xe(F,u),Oe(h,"==",m)),v=await et(p);v.empty||await i(v.docs,`${u}:${h}`),n[`${u}:${h}`]=(n[`${u}:${h}`]||0)+v.size}catch(p){console.error(`factoryResetUserData client: error deleting from ${u} by ${h}=`,p),r.push(`${u}:${h}: ${(p==null?void 0:p.message)||String(p)}`)}};let a=null;try{const u=await Sn(ye(F,"profiles",t));if(u.exists()){const h=u.data();h!=null&&h.shopId&&(a=String(h.shopId))}}catch(u){console.warn("factoryResetUserData client: failed to fetch profile for shopId:",u)}await o("userTransactions","userId",t),await o("userTransactions","merchantUserId",t),await o("userTransactions","createdBy",t),await o("transactions","userId",t),await o("transactions","createdBy",t),await o("deletedTransactions","userId",t),await o("daily_reports_archive","userId",t),await o("deletedDailyArchives","userId",t),await o("adslReceipts","userId",t),await o("simCardReceipts","userId",t),await o("adslCards","userId",t),await o("simCards","userId",t),await o("distributors","userId",t),await o("simCardRequests","userId",t),await o("pendingTransactions","userId",t),await o("pendingOperations","userId",t),await o("notifications","userId",t),await o("wallets","userId",t),await o("wallets","merchantUserId",t),await o("dailySales","userId",t),await o("products","userId",t),await o("debts","userId",t),await o("installments","userId",t),a?(await o("shop_expenses","userId",t),await o("deficiencies","userId",t),await o("categories","userId",t)):(await o("shop_expenses","userId",t),await o("deficiencies","userId",t),await o("categories","shopId",t)),await o("fawry_terminals","userId",t),await o("maintenance_items","userId",t),await o("maintenance_pending","userId",t),await o("maintenance_done","userId",t);try{const u=await et(xe(F,"users",t,"maintenance_waste"));u.empty||await i(u.docs,"users/maintenance_waste"),n["users/maintenance_waste"]=(n["users/maintenance_waste"]||0)+u.size}catch(u){console.error("factoryResetUserData client: error deleting maintenance_waste:",u),r.push(`users/maintenance_waste: ${(u==null?void 0:u.message)||String(u)}`)}await o("expenses","userId",t),await o("sales","userId",t),await o("cashSummaries","userId",t),await o("deviceTokens","userId",t);try{const u=ye(F,"users",t);await rn(u,{cashBalance:0,walletBalances:{},debts:[],debtsDeletedAt:Be(),reportsData:{},lastUpdated:new Date().toISOString()},{merge:!0}),n["users:embedded"]=(n["users:embedded"]||0)+1}catch(u){console.error("factoryResetUserData client: error clearing embedded user fields:",u),r.push(`users:embedded: ${(u==null?void 0:u.message)||String(u)}`)}try{const u=await et(xe(F,"users",t,"debts"));u.empty||await i(u.docs,"users/debts"),n["users/debts"]=(n["users/debts"]||0)+u.size}catch(u){console.error("factoryResetUserData client: error deleting debts subcollection:",u),r.push(`users/debts: ${(u==null?void 0:u.message)||String(u)}`)}try{const u=await et(xe(F,"users",t,"dailySales"));u.empty||await i(u.docs,"users/dailySales"),n["users/dailySales"]=(n["users/dailySales"]||0)+u.size}catch(u){console.error("factoryResetUserData client: error deleting dailySales subcollection:",u),r.push(`users/dailySales: ${(u==null?void 0:u.message)||String(u)}`)}const l=[];try{const u=await et(Ye(xe(F,"merchantWallets"),Oe("merchantUserId","==",t)));u.empty||(u.docs.forEach(h=>l.push(h.id)),await i(u.docs,"merchantWallets")),n["merchantWallets:merchantUserId"]=(n["merchantWallets:merchantUserId"]||0)+u.size}catch(u){console.error("factoryResetUserData client: error deleting merchantWallets:",u),r.push(`merchantWallets:merchantUserId: ${(u==null?void 0:u.message)||String(u)}`)}try{const u=await et(xe(F,"users",t,"wallets"));u.empty||(u.docs.forEach(h=>l.push(h.id)),await i(u.docs,"users/wallets")),n["users/wallets"]=(n["users/wallets"]||0)+u.size}catch(u){console.error("factoryResetUserData client: error deleting user wallets subcollection:",u),r.push(`users/wallets: ${(u==null?void 0:u.message)||String(u)}`)}const c=Array.from(new Set(l));for(const u of c){try{await Hn(ye(F,"walletLimits",u)),n["walletLimits:doc"]=(n["walletLimits:doc"]||0)+1}catch(h){console.warn("factoryResetUserData client: error deleting walletLimits doc:",h),r.push(`walletLimits:doc:${u}: ${(h==null?void 0:h.message)||String(h)}`)}try{await Hn(ye(F,"walletDailyLimits",u)),n["walletDailyLimits:doc"]=(n["walletDailyLimits:doc"]||0)+1}catch(h){console.warn("factoryResetUserData client: error deleting walletDailyLimits doc:",h),r.push(`walletDailyLimits:doc:${u}: ${(h==null?void 0:h.message)||String(h)}`)}}if(await o("walletLimits","ownerId",t),await o("walletDailyLimits","ownerId",t),await o("walletLimits","userId",t),await o("walletDailyLimits","userId",t),a)try{await rn(ye(F,"dashboardData",a),{cashBalance:0,walletBalances:{},lastUpdated:new Date().toISOString()},{merge:!0}),n["dashboardData:shop"]=(n["dashboardData:shop"]||0)+1,await rn(ye(F,"shops",a),{cashBalance:0,walletBalances:{},lastUpdated:new Date().toISOString()},{merge:!0})}catch(u){console.error("factoryResetUserData client: error resetting dashboardData:",u),r.push(`dashboardData:shop:${a}: ${(u==null?void 0:u.message)||String(u)}`)}try{const u=ye(F,"users",t);await xn(u,{cashBalance:0,walletBalances:{},debts:[],debtsDeletedAt:Be(),reportsData:{},lastUpdated:new Date().toISOString()}),n["users:reset_balances"]=(n["users:reset_balances"]||0)+1}catch(u){console.error("factoryResetUserData client: error resetting user balances:",u);try{await rn(ye(F,"users",t),{cashBalance:0,walletBalances:{},debts:[],debtsDeletedAt:Be(),reportsData:{},lastUpdated:new Date().toISOString(),createdAt:Be()},{merge:!0})}catch{r.push(`users:reset_balances: ${(u==null?void 0:u.message)||String(u)}`)}}try{const u=typeof localStorage<"u"?localStorage:null;if(u){const h=[];for(let m=0;m<u.length;m++){const p=u.key(m);p&&(p.includes(t)||p.startsWith("cashBalance_")||p.startsWith("walletBalances_")||p.startsWith("walletBalances_backup_")||p.startsWith("debts_")||!s&&p.startsWith("shopProducts_")||p.startsWith("deficiencies_"))&&h.push(p)}h.forEach(m=>{try{u.removeItem(m)}catch{}})}}catch(u){console.warn("factoryResetUserData client: failed to cleanup localStorage:",u)}try{await Ls(xe(F,"factoryResets"),{userId:t,summary:n,errors:r,createdAt:Be()})}catch(u){console.warn("factoryResetUserData client: failed to log factory reset:",u)}return{success:r.length===0,summary:n,errors:r}},async saveUserData(t,e){try{const n=ye(F,"users",t),r=nl(e);await rn(n,{...r||{},updatedAt:Be()},{merge:!0})}catch(n){throw console.error("Error saving user data:",n),n}},async updateUserData(t,e){try{console.log("      Firebase:",{userId:t,data:e}),typeof e.cashBalance=="number"&&(e.cashBalance=Math.round(e.cashBalance));const n=ye(F,"users",t),r=Object.fromEntries(Object.entries(e).filter(([l,c])=>c!==void 0)),s=nl(r);let i={};try{const l=await Sn(n);i=l.exists()?l.data():{},console.log("  :",i)}catch(l){console.warn("         :",l)}const o={...i,...s,updatedAt:Be()};console.log("   :",o);let a=3;for(;a>0;)try{await rn(n,o,{merge:!0}),console.log("     ");try{const l=await Zh.getById(t);if(l!=null&&l.shopId){const c={};if(o.cashBalance!==void 0&&(c.cashBalance=o.cashBalance),o.walletBalances!==void 0&&(c.walletBalances=o.walletBalances),Object.keys(c).length>0){const u=ye(F,"dashboardData",l.shopId);await rn(u,c,{merge:!0}),console.log("     dashboardData ")}}}catch(l){console.warn("   dashboardData ( ):",l)}return}catch(l){if(a--,console.warn(`     : ${a}`,l),a===0)throw l;await new Promise(c=>setTimeout(c,1e3))}}catch(n){throw console.error("     :",n),n instanceof Error&&(n.message.includes("network")?console.error("    -    "):n.message.includes("permission")?console.error("    -    Firestore"):n.message.includes("quota")&&console.error("     -    Firebase")),n}},async getUserWallets(t){try{const e=await this.getUserData(t);return(e==null?void 0:e.wallets)||[]}catch(e){return console.error("Error getting user wallets:",e),[]}},async getUserTransactions(t){try{let e;try{const l=Ye(xe(F,"userTransactions"),Oe("userId","==",t),Gs("createdAt","desc"),di(50));e=await et(l)}catch(l){console.warn(" getUserTransactions ordered query failed, falling back to unordered limit(50). Index might be missing.",l);const c=Ye(xe(F,"userTransactions"),Oe("userId","==",t),di(50));e=await et(c)}const n=e.docs.map(l=>({id:l.id,...l.data(),createdAt:It(l.data().createdAt)})),r=this.getLocalReceipts(t),s=[...n,...r],i=l=>{var c;return String((l==null?void 0:l.id)||(l==null?void 0:l.transactionId)||(l==null?void 0:l.originalTransactionId)||(l==null?void 0:l.reference)||(l==null?void 0:l.transactionReference)||((c=l==null?void 0:l.receipt)==null?void 0:c.reference)||`${(l==null?void 0:l.type)||"tx"}-${new Date((l==null?void 0:l.createdAt)||0).getTime()}`)},o=new Set;return s.filter(l=>{const c=i(l);return o.has(c)?!1:(o.add(c),!0)}).filter(l=>(l==null?void 0:l.status)!=="cancelled"&&!(l!=null&&l.isDeleted)).sort((l,c)=>{const u=l.createdAt?new Date(l.createdAt).getTime():0;return(c.createdAt?new Date(c.createdAt).getTime():0)-u})}catch(e){console.error("Error getting user transactions:",e);const n=(e==null?void 0:e.code)||"";if(n==="permission-denied"||n==="unauthenticated")throw e;return[]}},async getUserTransactionsForDateRange(t,e,n){try{const r=Ye(xe(F,"userTransactions"),Oe("userId","==",t),Oe("createdAt",">=",e),Oe("createdAt","<=",n),Gs("createdAt","desc"));return(await et(r)).docs.map(o=>({id:o.id,...o.data(),createdAt:It(o.data().createdAt)}))}catch(r){console.warn("Error fetching transactions for date range:",r);try{const s=Ye(xe(F,"userTransactions"),Oe("userId","==",t),Oe("createdAt",">=",e),Oe("createdAt","<=",n));return(await et(s)).docs.map(a=>({id:a.id,...a.data(),createdAt:It(a.data().createdAt)})).sort((a,l)=>l.createdAt.getTime()-a.createdAt.getTime())}catch(s){return console.error("Fallback query failed:",s),[]}}},subscribeToUserTransactions(t,e,n=30){try{const r=Ye(xe(F,"userTransactions"),Oe("userId","==",t),Gs("createdAt","desc"),di(n));return Vo(r,s=>{const i=s.docs.map(o=>({id:o.id,...o.data(),createdAt:It(o.data().createdAt)}));e(i)},s=>{console.error("Error in transactions subscription:",s)})}catch(r){return console.error("Error setting up subscription:",r),()=>{}}},subscribeToDashboardData(t,e){try{const n=ye(F,"dashboardData",t);return Vo(n,r=>{r.exists()?e(r.data()):e({})},r=>{console.error("Error in dashboard data subscription:",r)})}catch(n){return console.error("Error setting up dashboard subscription:",n),()=>{}}},async saveUserTransaction(t,e){var n,r;try{const s=Object.fromEntries(Object.entries(e??{}).filter(([o,a])=>a!==void 0));try{const o=s.reference;if(o){const a=Ye(xe(F,"deletedTransactions"),Oe("userId","==",t),Oe("reference","==",o));if(!(await et(a)).empty)return console.log("          ."),"skip-deleted"}{const a=Ye(xe(F,"deletedTransactions"),Oe("userId","==",t),Oe("permanent","==",!0)),l=await et(a);if(!l.empty){const c=[s.id,s.transactionId,s.originalTransactionId,(n=s.receipt)==null?void 0:n.id,(r=s.receipt)==null?void 0:r.transactionId,s.reference,s.transactionReference].filter(h=>!!h).map(h=>String(h));if(l.docs.find(h=>{const m=h.data(),p=String(m.originalTransactionId||m.transactionId||h.id||""),v=String(m.reference||"");return p&&c.includes(p)||v&&c.includes(v)}))return console.log("        /   ."),"skip-deleted"}}}catch(o){console.warn("           :",o)}try{const o=Ye(xe(F,"userTransactions"),Oe("userId","==",t));if(s.transactionId){const b=Ye(xe(F,"userTransactions"),Oe("userId","==",t),Oe("transactionId","==",s.transactionId)),_=await et(b);if(!_.empty){const S=_.docs[0];return await xn(ye(F,"userTransactions",S.id),{...s,uploadedAt:Be()}),S.id}}if(s.reference){const b=Ye(xe(F,"userTransactions"),Oe("userId","==",t),Oe("reference","==",s.reference)),_=await et(b);if(!_.empty){const S=_.docs[0];return await xn(ye(F,"userTransactions",S.id),{...s,uploadedAt:Be()}),S.id}}const a=Ye(xe(F,"userTransactions"),Oe("userId","==",t),Gs("createdAt","desc"),di(10)),l=await et(a),c=s.type||s.txnType,u=Number(s.amount||0),h=s.senderName,m=s.senderMsisdn||s.senderPhone||s.sender_msisdn,p=s.receiverMsisdn||s.receiverPhone||s.receiver_msisdn,v=s.createdAt?new Date(String(s.createdAt)):new Date,g=60*1e3,E=l.docs.find(b=>{const _=b.data(),S=_.type||_.txnType,P=Number(_.amount||0),T=_.senderName,N=_.senderMsisdn||_.senderPhone||_.sender_msisdn,I=_.receiverMsisdn||_.receiverPhone||_.receiver_msisdn,A=It(_.createdAt);return!(Math.abs(A.getTime()-v.getTime())<=g)||P!==u||S!==c?!1:c==="machine_withdrawal"?T===h:N===m&&I===p});if(E)return console.log("            :",E.id),await xn(ye(F,"userTransactions",E.id),{...s,uploadedAt:Be()}),E.id}catch(o){console.warn("      saveUserTransaction  :",o)}return(await Ls(xe(F,"userTransactions"),{...s,userId:t,createdAt:s.createdAt?s.createdAt instanceof Date?s.createdAt:new Date(String(s.createdAt)):Be(),uploadedAt:Be()})).id}catch(s){throw console.error("Error saving user transaction:",s),s}},async removeUserTransaction(t,e){try{console.log("     userTransactions:",{userId:t,transactionId:e});try{const o=ye(F,"userTransactions",e),a=await Sn(o);if(a.exists()){const l=a.data();if([l==null?void 0:l.userId,l==null?void 0:l.merchantUserId,l==null?void 0:l.createdBy].map(u=>String(u||"")).includes(String(t))){console.log("    userTransactions  ( ):",e),await Hn(o),console.log("     userTransactions");try{this.removeLocalReceiptById(t,e)}catch{}return}else console.log("           ")}}catch(o){console.warn("     userTransactions   :",o)}const n=Ye(xe(F,"userTransactions"),Oe("userId","==",t)),r=await et(n);console.log(`    ${r.docs.length}  `);const s=r.docs.filter(o=>{var h,m;const a=o.data(),l=o.id,u=[a.id===e,a.transactionId===e,l===e,a.originalTransactionId===e,((h=a.receipt)==null?void 0:h.transactionId)===e,((m=a.receipt)==null?void 0:m.id)===e].some(p=>p===!0);return u&&console.log("     :",{docId:l,dataId:a.id,transactionId:a.transactionId,originalTransactionId:a.originalTransactionId,searchingFor:e}),u}),i=[Ye(xe(F,"userTransactions"),Oe("merchantUserId","==",t)),Ye(xe(F,"userTransactions"),Oe("createdBy","==",t))];for(const o of i)try{const l=(await et(o)).docs.filter(c=>{var m,p;const u=c.data(),h=c.id;return u.id===e||u.transactionId===e||h===e||u.originalTransactionId===e||((m=u.receipt)==null?void 0:m.transactionId)===e||((p=u.receipt)==null?void 0:p.id)===e});l.length&&(console.log(`   ${l.length}       `),s.push(...l))}catch{}if(s.length>0){console.log(`   ${s.length}    `);const o=s.map(async a=>{try{console.log("   :",a.id),await Hn(a.ref)}catch(l){console.warn("     userTransactions ():",{id:a.id,error:l})}});await Promise.allSettled(o);try{this.removeLocalReceiptById(t,e)}catch{}console.log("        userTransactions:",e);try{const a=ye(F,"transactions",e);if((await Sn(a)).exists())console.log("     transactions   "),await Hn(a);else{const c=Ye(xe(F,"transactions"),Oe("transactionId","==",e)),u=await et(c);u.empty||(console.log(`   ${u.size}   transactions  transactionId `),await Promise.all(u.docs.map(p=>Hn(p.ref))));const h=Ye(xe(F,"transactions"),Oe("originalTransactionId","==",e)),m=await et(h);m.empty||(console.log(`   ${m.size}   transactions  originalTransactionId `),await Promise.all(m.docs.map(p=>Hn(p.ref))))}}catch(a){console.warn("      transactions   :",a)}return}console.log("       userTransactions (   ):",e)}catch(n){console.error("      userTransactions ():",n);return}}},ob={async getToday(t){const e=ye(F,"dailyStats",t,"today","data"),n=await Sn(e);return n.exists()?n.data():{}},async setToday(t,e){const n=ye(F,"dailyStats",t,"today","data");await rn(n,{...nl(e),updatedAt:new Date},{merge:!0})},async saveToHistory(t,e,n){const r=ye(F,"dailyStats",t,"history",e);await rn(r,nl(n),{merge:!0})},async archiveTodayToHistory(t,e){const n=await this.getToday(t);await this.saveToHistory(t,e,n||{})}},bX={async create(t,e){const n={...e,userId:t,status:"active",createdAt:Be()};return(await Ls(xe(F,"installments"),n)).id},async getByUser(t){try{const e=Ye(xe(F,"installments"),Oe("userId","==",t));return(await et(e)).docs.map(r=>({id:r.id,...r.data()}))}catch(e){return console.error("installments fetch error",e),[]}},async markMonthPaid(t,e){const n=e.every(r=>r.paid);return await xn(ye(F,"installments",t),{paidMonths:e,status:n?"completed":"active"}),!0},async remove(t){return await Hn(ye(F,"installments",t)),!0}},uo=Object.freeze(Object.defineProperty({__proto__:null,InstallmentsService:bX,auditLogService:_X,dailyReportsArchiveService:uV,dailyStatsService:ob,merchantWalletService:Pa,profileService:Zh,profileServiceExtra:lV,recordAutoTransaction:yX,referralService:ib,sanitizeFirestoreData:nl,systemSettingsService:cV,telegramNotifier:wX,transactionService:cI,transactionServiceExtra:aV,userDataService:mr},Symbol.toStringTag,{value:"Module"}));var Ll=(t=>(t.MONTHLY="monthly",t.QUARTERLY="quarterly",t.HALF_YEARLY="half_yearly",t.YEARLY="yearly",t.LIFETIME="lifetime",t.ZERO="zero",t.TAHWEELA="tahweela",t.FIVE_MINUTES="five_minutes",t.BRANCH="branch",t))(Ll||{});const tc=t=>{if(!t)return null;if(t instanceof Date)return isNaN(t.getTime())?null:t;if(t.toDate&&typeof t.toDate=="function")return t.toDate();if(t.seconds!==void 0&&typeof t.seconds=="number")return new Date(t.seconds*1e3);const e=new Date(t);return isNaN(e.getTime())?null:e},EX=(t,e=new Date)=>{const n=tc(e)||new Date;switch(t){case"monthly":{const r=new Date(n);return r.setDate(r.getDate()+30),r}case"five_minutes":{const r=new Date(n);return r.setMinutes(r.getMinutes()+5),r}case"tahweela":{const r=new Date(n);return r.setDate(r.getDate()+30),r}case"quarterly":{const r=new Date(n);return r.setDate(r.getDate()+90),r}case"half_yearly":{const r=new Date(n);return r.setDate(r.getDate()+180),r}case"yearly":{const r=new Date(n);return r.setDate(r.getDate()+365),r}case"lifetime":return null;case"zero":return null;default:return null}},aP=t=>{if(!t||!t.isActive)return!1;if(t.planType==="lifetime")return!0;if(!t.endDate){const r=new Date,s=tc(t.activatedAt);return s&&r.getTime()-s.getTime()<4*60*60*1e3,!0}const e=new Date,n=tc(t.endDate);if(!n){const r=tc(t.activatedAt);return r&&e.getTime()-r.getTime()<4*60*60*1e3,!0}return e<=n},SX=t=>{if(!t||!t.isActive)return null;if(t.planType==="lifetime")return-1;if(!t.endDate)return null;const e=new Date,n=tc(t.endDate);if(!n)return null;const r=n.getTime()-e.getTime(),s=Math.ceil(r/(1e3*60*60*24));return s>0?s:0},Zte=async(t,e,n,r,s,i)=>{try{const o=s||new Date,a=i||EX(e,o),l={planType:e,startDate:o,endDate:a,isActive:!0,activatedBy:n,activatedAt:new Date};console.log(" Activating subscription for user:",{userId:t,planType:e,adminId:n,subscriptionData:l});const c=ye(F,"users",t);await xn(c,{subscription:l,isActive:!0,approved:!0,isOnFreeTrial:!1,freeTrialStartDate:null,freeTrialEndDate:null,updatedAt:new Date});try{const u=await Sn(c);if(u.exists()){const h=u.data();if(h.ownerId){const m=h.ownerId;try{const p=ye(F,"users",m,"branches",t);await xn(p,{isActive:!0,updatedAt:new Date})}catch(p){console.warn("Could not update branch reference in parent subcollection",p)}}}}catch(u){console.warn("Error syncing branch status to parent:",u)}if(console.log(" Subscription data updated in Firestore"),typeof window<"u"){const u=new CustomEvent("subscriptionActivated",{detail:{userId:t,planType:e,timestamp:new Date().toISOString()}});window.dispatchEvent(u),console.log(" Subscription activation event dispatched:",{userId:t,planType:e});const h=new CustomEvent("userSubscriptionUpdated",{detail:{userId:t,planType:e,isActive:!0,timestamp:new Date().toISOString()}});window.dispatchEvent(h),console.log(" Global subscription update event dispatched")}console.log(`    ${e}  ${t}`)}catch(o){throw console.error("    :",o),new Error("   ")}},ene=async t=>{try{const e=Nv(F),n=ye(F,"users",t);e.update(n,{"subscription.isActive":!1,isActive:!1,"branchPackage.status":"canceled","branchPackage.canceledAt":new Date,isOnFreeTrial:!1,freeTrialStartDate:null,freeTrialEndDate:null,updatedAt:new Date});const r=Ye(xe(F,"users"),Oe("ownerId","==",t)),s=await et(r);s.forEach(i=>{e.update(i.ref,{isActive:!1,"subscription.isActive":!1,updatedAt:new Date})}),await e.commit(),console.log(`      ${t}   (${s.size})`)}catch(e){throw console.error("     :",e),new Error("    ")}},IX=async t=>{try{const e=Nv(F),n=ye(F,"users",t);e.update(n,{"branchPackage.status":"expired","branchPackage.expiredAt":new Date,updatedAt:new Date});const r=Ye(xe(F,"users"),Oe("ownerId","==",t));(await et(r)).forEach(i=>{e.update(i.ref,{isActive:!1,updatedAt:new Date})}),await e.commit(),console.log(` Branch package expired for user ${t}`)}catch(e){console.error("Failed to expire branch package:",e)}},TX=async(t,e)=>{if((e==null?void 0:e.status)!=="active"||!e.endDate)return;const n=tc(e.endDate);n&&new Date>n&&(console.log(`Branch package expired for user ${t}. Deactivating...`),await IX(t))},xX=async t=>{try{const e=ye(F,"users",t),n=await Sn(e);return n.exists()&&n.data().subscription||null}catch(e){return console.error("      :",e),null}},tne=t=>{switch(t){case"monthly":return"";case"quarterly":return" ";case"half_yearly":return" ";case"yearly":return"";case"lifetime":return" ";case"zero":return"";case"tahweela":return"";case"five_minutes":return"5 ";case"branch":return" ";default:return" "}},nne=t=>{if(!t)return"text-gray-500";if(!t.isActive)return"text-red-500";if(t.planType==="lifetime")return"text-green-600";const e=SX(t);return e===null||e<=0?"text-red-500":e<=7?"text-yellow-500":"text-green-500"},AX=t=>{const e=tc(t);return e?e.toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"}):" "};/*! Capacitor: https://capacitorjs.com/ - MIT License */const PX=t=>{const e=new Map;e.set("web",{name:"web"});const n=t.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},r=(i,o)=>{n.platforms.set(i,o)},s=i=>{n.platforms.has(i)&&(n.currentPlatform=n.platforms.get(i))};return n.addPlatform=r,n.setPlatform=s,n},RX=t=>t.CapacitorPlatforms=PX(t),dV=RX(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});dV.addPlatform;dV.setPlatform;var vd;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(vd||(vd={}));class Yw extends Error{constructor(e,n,r){super(e),this.message=e,this.code=n,this.data=r}}const CX=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},NX=t=>{var e,n,r,s,i;const o=t.CapacitorCustomPlatform||null,a=t.Capacitor||{},l=a.Plugins=a.Plugins||{},c=t.CapacitorPlatforms,u=()=>o!==null?o.name:CX(t),h=((e=c==null?void 0:c.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||u,m=()=>h()!=="web",p=((n=c==null?void 0:c.currentPlatform)===null||n===void 0?void 0:n.isNativePlatform)||m,v=I=>{const A=P.get(I);return!!(A!=null&&A.platforms.has(h())||b(I))},g=((r=c==null?void 0:c.currentPlatform)===null||r===void 0?void 0:r.isPluginAvailable)||v,E=I=>{var A;return(A=a.PluginHeaders)===null||A===void 0?void 0:A.find(R=>R.name===I)},b=((s=c==null?void 0:c.currentPlatform)===null||s===void 0?void 0:s.getPluginHeader)||E,_=I=>t.console.error(I),S=(I,A,R)=>Promise.reject(`${R} does not have an implementation of "${A}".`),P=new Map,T=(I,A={})=>{const R=P.get(I);if(R)return console.warn(`Capacitor plugin "${I}" already registered. Cannot register plugins twice.`),R.proxy;const k=h(),C=b(I);let L;const O=async()=>(!L&&k in A?L=typeof A[k]=="function"?L=await A[k]():L=A[k]:o!==null&&!L&&"web"in A&&(L=typeof A.web=="function"?L=await A.web():L=A.web),L),X=(le,pe)=>{var fe,Ge;if(C){const Ie=C==null?void 0:C.methods.find(ve=>pe===ve.name);if(Ie)return Ie.rtype==="promise"?ve=>a.nativePromise(I,pe.toString(),ve):(ve,J)=>a.nativeCallback(I,pe.toString(),ve,J);if(le)return(fe=le[pe])===null||fe===void 0?void 0:fe.bind(le)}else{if(le)return(Ge=le[pe])===null||Ge===void 0?void 0:Ge.bind(le);throw new Yw(`"${I}" plugin is not implemented on ${k}`,vd.Unimplemented)}},Ne=le=>{let pe;const fe=(...Ge)=>{const Ie=O().then(ve=>{const J=X(ve,le);if(J){const qe=J(...Ge);return pe=qe==null?void 0:qe.remove,qe}else throw new Yw(`"${I}.${le}()" is not implemented on ${k}`,vd.Unimplemented)});return le==="addListener"&&(Ie.remove=async()=>pe()),Ie};return fe.toString=()=>`${le.toString()}() { [capacitor code] }`,Object.defineProperty(fe,"name",{value:le,writable:!1,configurable:!1}),fe},Le=Ne("addListener"),Fe=Ne("removeListener"),W=(le,pe)=>{const fe=Le({eventName:le},pe),Ge=async()=>{const ve=await fe;Fe({eventName:le,callbackId:ve},pe)},Ie=new Promise(ve=>fe.then(()=>ve({remove:Ge})));return Ie.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await Ge()},Ie},Y=new Proxy({},{get(le,pe){switch(pe){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return C?W:Le;case"removeListener":return Fe;default:return Ne(pe)}}});return l[I]=Y,P.set(I,{name:I,proxy:Y,platforms:new Set([...Object.keys(A),...C?[k]:[]])}),Y},N=((i=c==null?void 0:c.currentPlatform)===null||i===void 0?void 0:i.registerPlugin)||T;return a.convertFileSrc||(a.convertFileSrc=I=>I),a.getPlatform=h,a.handleError=_,a.isNativePlatform=p,a.isPluginAvailable=g,a.pluginMethodNoop=S,a.registerPlugin=N,a.Exception=Yw,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a.platform=a.getPlatform(),a.isNative=a.isNativePlatform(),a},kX=t=>t.Capacitor=NX(t),Te=kX(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Hd=Te.registerPlugin;Te.Plugins;class hV{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,n){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(n);const s=this.windowListeners[e];s&&!s.registered&&this.addWindowListener(s);const i=async()=>this.removeListener(e,n),o=Promise.resolve({remove:i});return Object.defineProperty(o,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await i()}}),o}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n){const r=this.listeners[e];r&&r.forEach(s=>s(n))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(e="not implemented"){return new Te.Exception(e,vd.Unimplemented)}unavailable(e="not available"){return new Te.Exception(e,vd.Unavailable)}async removeListener(e,n){const r=this.listeners[e];if(!r)return;const s=r.indexOf(n);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}const lP=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),cP=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class DX extends hV{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=cP(s).trim(),i=cP(i).trim(),n[s]=i}),n}async setCookie(e){try{const n=lP(e.key),r=lP(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${s}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Hd("CapacitorCookies",{web:()=>new DX});const OX=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>n(s),r.readAsDataURL(t)}),LX=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(s=>s.toLocaleLowerCase()).reduce((s,i,o)=>(s[i]=t[e[o]],s),{})},MX=(t,e=!0)=>t?Object.entries(t).reduce((r,s)=>{const[i,o]=s;let a,l;return Array.isArray(o)?(l="",o.forEach(c=>{a=e?encodeURIComponent(c):c,l+=`${i}=${a}&`}),l.slice(0,-1)):(a=e?encodeURIComponent(o):o,l=`${i}=${a}`),`${r}&${l}`},"").substr(1):null,VX=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),s=LX(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(s.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,a]of Object.entries(t.data||{}))i.set(o,a);n.body=i.toString()}else if(s.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((a,l)=>{i.append(l,a)});else for(const a of Object.keys(t.data))i.append(a,t.data[a]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(s.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class jX extends hV{async request(e){const n=VX(e,e.webFetchExtra),r=MX(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,i=await fetch(s,n),o=i.headers.get("content-type")||"";let{responseType:a="text"}=i.ok?e:{};o.includes("application/json")&&(a="json");let l,c;switch(a){case"arraybuffer":case"blob":c=await i.blob(),l=await OX(c);break;case"json":l=await i.json();break;case"document":case"text":default:l=await i.text()}const u={};return i.headers.forEach((h,m)=>{u[m]=h}),{data:l,headers:u,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Hd("CapacitorHttp",{web:()=>new jX});const Ml=Hd("Preferences",{web:()=>ee(()=>import("./web-BQZiqb_5.js"),[],import.meta.url).then(t=>new t.PreferencesWeb)}),cp=Object.freeze(Object.defineProperty({__proto__:null,Preferences:Ml},Symbol.toStringTag,{value:"Module"}));var FX=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],UX=FX.reduce((t,e)=>{const n=CD(`Primitive.${e}`),r=y.forwardRef((s,i)=>{const{asChild:o,...a}=s,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...a,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{}),$X="Label",fV=y.forwardRef((t,e)=>f.jsx(UX.label,{...t,ref:e,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));fV.displayName=$X;var mV=fV;const BX=Fy("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),vr=y.forwardRef(({className:t,...e},n)=>f.jsx(mV,{ref:n,className:yn(BX(),t),...e}));vr.displayName=mV.displayName;var Jw="focusScope.autoFocusOnMount",Xw="focusScope.autoFocusOnUnmount",uP={bubbles:!1,cancelable:!0},zX="FocusScope",pV=y.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[a,l]=y.useState(null),c=jr(s),u=jr(i),h=y.useRef(null),m=Qn(e,g=>l(g)),p=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(r){let g=function(S){if(p.paused||!a)return;const P=S.target;a.contains(P)?h.current=P:sa(h.current,{select:!0})},E=function(S){if(p.paused||!a)return;const P=S.relatedTarget;P!==null&&(a.contains(P)||sa(h.current,{select:!0}))},b=function(S){if(document.activeElement===document.body)for(const T of S)T.removedNodes.length>0&&sa(a)};document.addEventListener("focusin",g),document.addEventListener("focusout",E);const _=new MutationObserver(b);return a&&_.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",E),_.disconnect()}}},[r,a,p.paused]),y.useEffect(()=>{if(a){hP.add(p);const g=document.activeElement;if(!a.contains(g)){const b=new CustomEvent(Jw,uP);a.addEventListener(Jw,c),a.dispatchEvent(b),b.defaultPrevented||(WX(QX(gV(a)),{select:!0}),document.activeElement===g&&sa(a))}return()=>{a.removeEventListener(Jw,c),setTimeout(()=>{const b=new CustomEvent(Xw,uP);a.addEventListener(Xw,u),a.dispatchEvent(b),b.defaultPrevented||sa(g??document.body,{select:!0}),a.removeEventListener(Xw,u),hP.remove(p)},0)}}},[a,c,u,p]);const v=y.useCallback(g=>{if(!n&&!r||p.paused)return;const E=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,b=document.activeElement;if(E&&b){const _=g.currentTarget,[S,P]=qX(_);S&&P?!g.shiftKey&&b===P?(g.preventDefault(),n&&sa(S,{select:!0})):g.shiftKey&&b===S&&(g.preventDefault(),n&&sa(P,{select:!0})):b===_&&g.preventDefault()}},[n,r,p.paused]);return f.jsx(_n.div,{tabIndex:-1,...o,ref:m,onKeyDown:v})});pV.displayName=zX;function WX(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(sa(r,{select:e}),document.activeElement!==n)return}function qX(t){const e=gV(t),n=dP(e,t),r=dP(e.reverse(),t);return[n,r]}function gV(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function dP(t,e){for(const n of t)if(!HX(n,{upTo:e}))return n}function HX(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function KX(t){return t instanceof HTMLInputElement&&"select"in t}function sa(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&KX(t)&&e&&t.select()}}var hP=GX();function GX(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=fP(t,e),t.unshift(e)},remove(e){var n;t=fP(t,e),(n=t[0])==null||n.resume()}}}function fP(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function QX(t){return t.filter(e=>e.tagName!=="A")}var Zw=0;function YX(){y.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??mP()),document.body.insertAdjacentElement("beforeend",t[1]??mP()),Zw++,()=>{Zw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Zw--}},[])}function mP(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var $i=function(){return $i=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},$i.apply(this,arguments)};function yV(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function JX(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var Qp="right-scroll-bar-position",Yp="width-before-scroll-bar",XX="with-scroll-bars-hidden",ZX="--removed-body-scroll-bar-size";function e_(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function eZ(t,e){var n=y.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var tZ=typeof window<"u"?y.useLayoutEffect:y.useEffect,pP=new WeakMap;function nZ(t,e){var n=eZ(null,function(r){return t.forEach(function(s){return e_(s,r)})});return tZ(function(){var r=pP.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(a){i.has(a)||e_(a,null)}),i.forEach(function(a){s.has(a)||e_(a,o)})}pP.set(n,t)},[t]),n}function rZ(t){return t}function sZ(t,e){e===void 0&&(e=rZ);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return s}function iZ(t){t===void 0&&(t={});var e=sZ(null);return e.options=$i({async:!0,ssr:!1},t),e}var vV=function(t){var e=t.sideCar,n=yV(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return y.createElement(r,$i({},n))};vV.isSideCarExport=!0;function oZ(t,e){return t.useMedium(e),vV}var wV=iZ(),t_=function(){},Ov=y.forwardRef(function(t,e){var n=y.useRef(null),r=y.useState({onScrollCapture:t_,onWheelCapture:t_,onTouchMoveCapture:t_}),s=r[0],i=r[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,h=t.shards,m=t.sideCar,p=t.noRelative,v=t.noIsolation,g=t.inert,E=t.allowPinchZoom,b=t.as,_=b===void 0?"div":b,S=t.gapMode,P=yV(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),T=m,N=nZ([n,e]),I=$i($i({},P),s);return y.createElement(y.Fragment,null,u&&y.createElement(T,{sideCar:wV,removeScrollBar:c,shards:h,noRelative:p,noIsolation:v,inert:g,setCallbacks:i,allowPinchZoom:!!E,lockRef:n,gapMode:S}),o?y.cloneElement(y.Children.only(a),$i($i({},I),{ref:N})):y.createElement(_,$i({},I,{className:l,ref:N}),a))});Ov.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ov.classNames={fullWidth:Yp,zeroRight:Qp};var aZ=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function lZ(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=aZ();return e&&t.setAttribute("nonce",e),t}function cZ(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function uZ(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var dZ=function(){var t=0,e=null;return{add:function(n){t==0&&(e=lZ())&&(cZ(e,n),uZ(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},hZ=function(){var t=dZ();return function(e,n){y.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},_V=function(){var t=hZ(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},fZ={left:0,top:0,right:0,gap:0},n_=function(t){return parseInt(t||"",10)||0},mZ=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[n_(n),n_(r),n_(s)]},pZ=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return fZ;var e=mZ(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},gZ=_V(),Ru="data-scroll-locked",yZ=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(XX,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(Ru,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Qp,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Yp,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Qp," .").concat(Qp,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Yp," .").concat(Yp,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ru,`] {
    `).concat(ZX,": ").concat(a,`px;
  }
`)},gP=function(){var t=parseInt(document.body.getAttribute(Ru)||"0",10);return isFinite(t)?t:0},vZ=function(){y.useEffect(function(){return document.body.setAttribute(Ru,(gP()+1).toString()),function(){var t=gP()-1;t<=0?document.body.removeAttribute(Ru):document.body.setAttribute(Ru,t.toString())}},[])},wZ=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;vZ();var i=y.useMemo(function(){return pZ(s)},[s]);return y.createElement(gZ,{styles:yZ(i,!e,s,n?"":"!important")})},ab=!1;if(typeof window<"u")try{var up=Object.defineProperty({},"passive",{get:function(){return ab=!0,!0}});window.addEventListener("test",up,up),window.removeEventListener("test",up,up)}catch{ab=!1}var Bc=ab?{passive:!1}:!1,_Z=function(t){return t.tagName==="TEXTAREA"},bV=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!_Z(t)&&n[e]==="visible")},bZ=function(t){return bV(t,"overflowY")},EZ=function(t){return bV(t,"overflowX")},yP=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=EV(t,r);if(s){var i=SV(t,r),o=i[1],a=i[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},SZ=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},IZ=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},EV=function(t,e){return t==="v"?bZ(e):EZ(e)},SV=function(t,e){return t==="v"?SZ(e):IZ(e)},TZ=function(t,e){return t==="h"&&e==="rtl"?-1:1},xZ=function(t,e,n,r,s){var i=TZ(t,window.getComputedStyle(e).direction),o=i*r,a=n.target,l=e.contains(a),c=!1,u=o>0,h=0,m=0;do{if(!a)break;var p=SV(t,a),v=p[0],g=p[1],E=p[2],b=g-E-i*v;(v||b)&&EV(t,a)&&(h+=b,m+=v);var _=a.parentNode;a=_&&_.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_.host:_}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&Math.abs(h)<1||!u&&Math.abs(m)<1)&&(c=!0),c},dp=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},vP=function(t){return[t.deltaX,t.deltaY]},wP=function(t){return t&&"current"in t?t.current:t},AZ=function(t,e){return t[0]===e[0]&&t[1]===e[1]},PZ=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},RZ=0,zc=[];function CZ(t){var e=y.useRef([]),n=y.useRef([0,0]),r=y.useRef(),s=y.useState(RZ++)[0],i=y.useState(_V)[0],o=y.useRef(t);y.useEffect(function(){o.current=t},[t]),y.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var g=JX([t.lockRef.current],(t.shards||[]).map(wP),!0).filter(Boolean);return g.forEach(function(E){return E.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),g.forEach(function(E){return E.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var a=y.useCallback(function(g,E){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var b=dp(g),_=n.current,S="deltaX"in g?g.deltaX:_[0]-b[0],P="deltaY"in g?g.deltaY:_[1]-b[1],T,N=g.target,I=Math.abs(S)>Math.abs(P)?"h":"v";if("touches"in g&&I==="h"&&N.type==="range")return!1;var A=window.getSelection(),R=A&&A.anchorNode,k=R?R===N||R.contains(N):!1;if(k)return!1;var C=yP(I,N);if(!C)return!0;if(C?T=I:(T=I==="v"?"h":"v",C=yP(I,N)),!C)return!1;if(!r.current&&"changedTouches"in g&&(S||P)&&(r.current=T),!T)return!0;var L=r.current||T;return xZ(L,E,g,L==="h"?S:P)},[]),l=y.useCallback(function(g){var E=g;if(!(!zc.length||zc[zc.length-1]!==i)){var b="deltaY"in E?vP(E):dp(E),_=e.current.filter(function(T){return T.name===E.type&&(T.target===E.target||E.target===T.shadowParent)&&AZ(T.delta,b)})[0];if(_&&_.should){E.cancelable&&E.preventDefault();return}if(!_){var S=(o.current.shards||[]).map(wP).filter(Boolean).filter(function(T){return T.contains(E.target)}),P=S.length>0?a(E,S[0]):!o.current.noIsolation;P&&E.cancelable&&E.preventDefault()}}},[]),c=y.useCallback(function(g,E,b,_){var S={name:g,delta:E,target:b,should:_,shadowParent:NZ(b)};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(P){return P!==S})},1)},[]),u=y.useCallback(function(g){n.current=dp(g),r.current=void 0},[]),h=y.useCallback(function(g){c(g.type,vP(g),g.target,a(g,t.lockRef.current))},[]),m=y.useCallback(function(g){c(g.type,dp(g),g.target,a(g,t.lockRef.current))},[]);y.useEffect(function(){return zc.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:m}),document.addEventListener("wheel",l,Bc),document.addEventListener("touchmove",l,Bc),document.addEventListener("touchstart",u,Bc),function(){zc=zc.filter(function(g){return g!==i}),document.removeEventListener("wheel",l,Bc),document.removeEventListener("touchmove",l,Bc),document.removeEventListener("touchstart",u,Bc)}},[]);var p=t.removeScrollBar,v=t.inert;return y.createElement(y.Fragment,null,v?y.createElement(i,{styles:PZ(s)}):null,p?y.createElement(wZ,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function NZ(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const kZ=oZ(wV,CZ);var IV=y.forwardRef(function(t,e){return y.createElement(Ov,$i({},t,{ref:e,sideCar:kZ}))});IV.classNames=Ov.classNames;var DZ=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Wc=new WeakMap,hp=new WeakMap,fp={},r_=0,TV=function(t){return t&&(t.host||TV(t.parentNode))},OZ=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=TV(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},LZ=function(t,e,n,r){var s=OZ(e,Array.isArray(t)?t:[t]);fp[n]||(fp[n]=new WeakMap);var i=fp[n],o=[],a=new Set,l=new Set(s),c=function(h){!h||a.has(h)||(a.add(h),c(h.parentNode))};s.forEach(c);var u=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(m){if(a.has(m))u(m);else try{var p=m.getAttribute(r),v=p!==null&&p!=="false",g=(Wc.get(m)||0)+1,E=(i.get(m)||0)+1;Wc.set(m,g),i.set(m,E),o.push(m),g===1&&v&&hp.set(m,!0),E===1&&m.setAttribute(n,"true"),v||m.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",m,b)}})};return u(e),a.clear(),r_++,function(){o.forEach(function(h){var m=Wc.get(h)-1,p=i.get(h)-1;Wc.set(h,m),i.set(h,p),m||(hp.has(h)||h.removeAttribute(r),hp.delete(h)),p||h.removeAttribute(n)}),r_--,r_||(Wc=new WeakMap,Wc=new WeakMap,hp=new WeakMap,fp={})}},MZ=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=DZ(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),LZ(r,s,n,"aria-hidden")):function(){return null}};function VZ(t){const e=jZ(t),n=y.forwardRef((r,s)=>{const{children:i,...o}=r,a=y.Children.toArray(i),l=a.find(UZ);if(l){const c=l.props.children,u=a.map(h=>h===l?y.Children.count(c)>1?y.Children.only(null):y.isValidElement(c)?c.props.children:null:h);return f.jsx(e,{...o,ref:s,children:y.isValidElement(c)?y.cloneElement(c,void 0,u):null})}return f.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}function jZ(t){const e=y.forwardRef((n,r)=>{const{children:s,...i}=n;if(y.isValidElement(s)){const o=BZ(s),a=$Z(i,s.props);return s.type!==y.Fragment&&(a.ref=r?Yf(r,o):o),y.cloneElement(s,a)}return y.Children.count(s)>1?y.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var FZ=Symbol("radix.slottable");function UZ(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===FZ}function $Z(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function BZ(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Lv="Dialog",[xV,rne]=Sc(Lv),[zZ,Pi]=xV(Lv),AV=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,a=y.useRef(null),l=y.useRef(null),[c,u]=lE({prop:r,defaultProp:s??!1,onChange:i,caller:Lv});return f.jsx(zZ,{scope:e,triggerRef:a,contentRef:l,contentId:Sw(),titleId:Sw(),descriptionId:Sw(),open:c,onOpenChange:u,onOpenToggle:y.useCallback(()=>u(h=>!h),[u]),modal:o,children:n})};AV.displayName=Lv;var PV="DialogTrigger",RV=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Pi(PV,n),i=Qn(e,s.triggerRef);return f.jsx(_n.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":hI(s.open),...r,ref:i,onClick:en(t.onClick,s.onOpenToggle)})});RV.displayName=PV;var uI="DialogPortal",[WZ,CV]=xV(uI,{forceMount:void 0}),NV=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=Pi(uI,e);return f.jsx(WZ,{scope:e,forceMount:n,children:y.Children.map(r,o=>f.jsx(Si,{present:n||i.open,children:f.jsx(aE,{asChild:!0,container:s,children:o})}))})};NV.displayName=uI;var dy="DialogOverlay",kV=y.forwardRef((t,e)=>{const n=CV(dy,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Pi(dy,t.__scopeDialog);return i.modal?f.jsx(Si,{present:r||i.open,children:f.jsx(HZ,{...s,ref:e})}):null});kV.displayName=dy;var qZ=VZ("DialogOverlay.RemoveScroll"),HZ=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Pi(dy,n);return f.jsx(IV,{as:qZ,allowPinchZoom:!0,shards:[s.contentRef],children:f.jsx(_n.div,{"data-state":hI(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),_c="DialogContent",DV=y.forwardRef((t,e)=>{const n=CV(_c,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Pi(_c,t.__scopeDialog);return f.jsx(Si,{present:r||i.open,children:i.modal?f.jsx(KZ,{...s,ref:e}):f.jsx(GZ,{...s,ref:e})})});DV.displayName=_c;var KZ=y.forwardRef((t,e)=>{const n=Pi(_c,t.__scopeDialog),r=y.useRef(null),s=Qn(e,n.contentRef,r);return y.useEffect(()=>{const i=r.current;if(i)return MZ(i)},[]),f.jsx(OV,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:en(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:en(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:en(t.onFocusOutside,i=>i.preventDefault())})}),GZ=y.forwardRef((t,e)=>{const n=Pi(_c,t.__scopeDialog),r=y.useRef(!1),s=y.useRef(!1);return f.jsx(OV,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),OV=y.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,a=Pi(_c,n),l=y.useRef(null),c=Qn(e,l);return YX(),f.jsxs(f.Fragment,{children:[f.jsx(pV,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(My,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":hI(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(QZ,{titleId:a.titleId}),f.jsx(JZ,{contentRef:l,descriptionId:a.descriptionId})]})]})}),dI="DialogTitle",LV=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Pi(dI,n);return f.jsx(_n.h2,{id:s.titleId,...r,ref:e})});LV.displayName=dI;var MV="DialogDescription",VV=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Pi(MV,n);return f.jsx(_n.p,{id:s.descriptionId,...r,ref:e})});VV.displayName=MV;var jV="DialogClose",FV=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Pi(jV,n);return f.jsx(_n.button,{type:"button",...r,ref:e,onClick:en(t.onClick,()=>s.onOpenChange(!1))})});FV.displayName=jV;function hI(t){return t?"open":"closed"}var UV="DialogTitleWarning",[sne,$V]=_U(UV,{contentName:_c,titleName:dI,docsSlug:"dialog"}),QZ=({titleId:t})=>{const e=$V(UV),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return y.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},YZ="DialogDescriptionWarning",JZ=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${$V(YZ).contentName}}.`;return y.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},XZ=AV,ZZ=RV,eee=NV,BV=kV,zV=DV,WV=LV,qV=VV,tee=FV;const Ba=XZ,ine=ZZ,nee=eee,HV=y.forwardRef(({className:t,...e},n)=>f.jsx(BV,{ref:n,className:yn("fixed inset-0 z-[9998] bg-black/30 dark:bg-black backdrop-blur-[5px] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 radix-dialog-overlay",t),...e}));HV.displayName=BV.displayName;const xo=y.forwardRef(({className:t,children:e,hideClose:n,disableOutsideClose:r,disableEscClose:s,overlayClassName:i,...o},a)=>f.jsxs(nee,{children:[f.jsx(HV,{className:i}),f.jsxs(zV,{ref:a,className:yn("fixed left-[50%] top-[50%] z-[9999] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 bg-background dark:bg-[#0f172a] dark:text-slate-100 dark:border-slate-800 p-6 shadow-md rounded-2xl duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] radix-dialog-content",t),onInteractOutside:l=>{r&&l.preventDefault()},onEscapeKeyDown:l=>{s&&l.preventDefault()},...o,children:[e,!n&&f.jsxs(tee,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[f.jsx(Ui,{className:"h-4 w-4"}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));xo.displayName=zV.displayName;const rl=({className:t,...e})=>f.jsx("div",{className:yn("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});rl.displayName="DialogHeader";const Mv=({className:t,...e})=>f.jsx("div",{className:yn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});Mv.displayName="DialogFooter";const sl=y.forwardRef(({className:t,...e},n)=>f.jsx(WV,{ref:n,className:yn("text-lg font-semibold leading-none tracking-tight",t),...e}));sl.displayName=WV.displayName;const fI=y.forwardRef(({className:t,...e},n)=>f.jsx(qV,{ref:n,className:yn("text-sm text-muted-foreground",t),...e}));fI.displayName=qV.displayName;const _P="master_pin",Ni=new Map;function ree(t){return t.replace(/[-]/g,e=>"0123456789"["".indexOf(e)])}function aa(t){return t?`${_P}_${t}`:_P}async function see(t){try{const e=await mr.getUserData(t),n=(e==null?void 0:e.security)&&e.security.masterPin||(e==null?void 0:e.masterPin)||null;return typeof n=="string"&&n.length>0?n:null}catch{try{const e=ye(F,"users",t),n=await Sn(e);if(n.exists()){const r=n.data(),s=(r==null?void 0:r.security)&&r.security.masterPin||(r==null?void 0:r.masterPin)||null;return typeof s=="string"&&s.length>0?s:null}}catch{}return null}}function bP(t){try{const e=localStorage.getItem(aa(t));return e&&e.length>0?e:null}catch{return null}}async function mp(t,e){try{const n={security:{masterPin:e||null,masterPinUpdatedAt:Be()},updatedAt:Be()};await rn(ye(F,"users",t),n,{merge:!0})}catch{try{await xn(ye(F,"users",t),{security:{masterPin:e||null,masterPinUpdatedAt:Be()},updatedAt:Be()})}catch{}}}function ea(t,e){try{const n=aa(t);e?localStorage.setItem(n,e):localStorage.removeItem(n)}catch{}}class Sl{static async hasMasterPin(e){const n=aa(e);if(Ni.has(n)){const s=Ni.get(n);return s!==""&&s!=null}const r=bP(e);if(r)return Ni.set(n,r),!0;if(e){const s=bP(void 0);if(s){Ni.set(n,s),ea(e,s);try{ea(void 0,null)}catch{}return await mp(e,s),!0}}if(e){const s=await see(e);if(s){Ni.set(n,s),ea(e,s);try{ea(void 0,null)}catch{}return!0}}return!1}static async createMasterPin(e,n){try{if(!e||e.length<4)return!1;const r=btoa(e),s=aa(n);return Ni.set(s,r),ea(n,r),n&&await mp(n,r),!0}catch(r){return console.error("Error creating master PIN:",r),!1}}static async verifyMasterPin(e,n){try{const r=e.trim(),s=ree(r),i=aa(n);if(await this.hasMasterPin(n)){const o=Ni.get(i);if(o){const a=atob(o);if(a===r||a===s)return!0}}if(n){const o=aa(void 0),a=localStorage.getItem(o);if(a)try{const l=atob(a);if(l===r||l===s)return console.log("Master PIN auto-correction: Generic PIN matched while User PIN failed. Updating User PIN."),Ni.set(i,a),ea(n,a),await mp(n,a),!0}catch{}}return!1}catch(r){return console.error("Error verifying master PIN:",r),!1}}static async changeMasterPin(e,n,r){try{return await this.verifyMasterPin(e,r)?await this.createMasterPin(n,r):!1}catch(s){return console.error("Error changing master PIN:",s),!1}}static async deleteMasterPin(e){try{const n=aa(e);return Ni.delete(n),ea(e,null),e&&(ea(void 0,null),await mp(e,null)),!0}catch(n){return console.error("Error deleting master PIN:",n),!1}}static async getMasterPin(e){try{const n=aa(e);if(!await this.hasMasterPin(e))return null;const r=Ni.get(n);return r?atob(r):null}catch(n){return console.error("Error getting master PIN:",n),null}}}const KV=({open:t,onOpenChange:e,title:n="  ",description:r="     ",onSuccess:s})=>{const{toast:i}=ll(),[o,a]=y.useState(""),[l,c]=y.useState(!1),[u,h]=y.useState(null),m=async()=>{h(null);try{const v=qt.currentUser;if(!v||!v.email){h("    .    .");return}c(!0);const g=Ac.credential(v.email,o);await c7(v,g),c(!1),a(""),i({title:" ",description:"     "}),s(),e&&e(!1)}catch(v){console.error("    :",v),c(!1);const g=(v==null?void 0:v.code)||"";h(g==="auth/wrong-password"?"   .   .":g==="auth/too-many-requests"?"  .     .":"   .   .")}},p=v=>{e&&e(v),v||(a(""),h(null),c(!1))};return f.jsx(Ba,{open:t,onOpenChange:p,children:f.jsxs(xo,{className:"sm:max-w-[400px] bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",dir:"rtl",children:[f.jsxs(rl,{children:[f.jsx(sl,{className:"text-right text-gray-900 dark:text-gray-100",children:n}),f.jsx(fI,{className:"text-right text-gray-500 dark:text-gray-400",children:r})]}),f.jsxs("div",{className:"grid gap-4 py-2",children:[f.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[f.jsx("label",{htmlFor:"password",className:"text-right col-span-1 text-sm text-gray-700 dark:text-gray-300",children:" "}),f.jsxs("div",{className:"col-span-3 relative",children:[f.jsx(Uy,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),f.jsx(ar,{id:"password",type:"password",value:o,onChange:v=>a(v.target.value),onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),m())},placeholder:"    ",autoComplete:"off",className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100"})]})]}),u&&f.jsx("div",{className:"text-red-600 dark:text-red-400 text-xs text-right",children:u})]}),f.jsxs(Mv,{className:"flex justify-end gap-2",children:[f.jsx(wt,{variant:"outline",onClick:()=>p(!1),disabled:l,className:"dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",children:""}),f.jsx(wt,{onClick:m,disabled:l,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:l?" ...":""})]})]})})},one=Object.freeze(Object.defineProperty({__proto__:null,default:KV},Symbol.toStringTag,{value:"Module"})),lb=({open:t,onOpenChange:e,onSuccess:n,title:r="  ",description:s="      ",mode:i="verify",className:o,overlayClassName:a,userId:l,userRole:c})=>{const[u,h]=y.useState(""),[m,p]=y.useState(""),[v,g]=y.useState(""),[E,b]=y.useState(!1),[_,S]=y.useState(!1),[P,T]=y.useState(!1),[N,I]=y.useState(""),[A,R]=y.useState(!1),{toast:k}=ll(),[C,L]=y.useState(!1),[O,X]=y.useState(!1),Ne=c==="admin"||c==="staff",[Le,Fe]=y.useState(!1),[W,Y]=y.useState(!1),le=y.useRef(null),[pe,fe]=y.useState(i);y.useEffect(()=>{fe(i)},[i]),y.useEffect(()=>{let ve=!0;return t&&(async()=>{var qe;try{const dn=l||((qe=qt.currentUser)==null?void 0:qe.uid),dr=await Sl.hasMasterPin(dn);ve&&L(dr)}catch{}})(),()=>{ve=!1}},[l,t]);const Ge=async ve=>{var qe;ve.preventDefault(),I(""),R(!0);const J=l||((qe=qt.currentUser)==null?void 0:qe.uid);try{if(pe==="verify"){if(!u){I("    "),R(!1);return}if(!await Sl.verifyMasterPin(u,J)){I("   "),R(!1);return}k({title:" ",description:"     "}),n==null||n(),Ie()}else if(pe==="create"){if(!m||m.length<4){I("      4   "),R(!1);return}if(m!==v){I("     "),R(!1);return}if(!await Sl.createMasterPin(m,J)){I("    "),R(!1);return}k({title:"    ",description:"     "}),n==null||n(),Ie()}else if(pe==="change"){if(!J){I("        .         ."),R(!1);return}if(C&&!O&&!W){if(!u){I("        "),R(!1);return}if(!await Sl.verifyMasterPin(u,J)){I("    "),R(!1);return}}if(!m||m.length<4){I("      4   "),R(!1);return}if(m!==v){I("     "),R(!1);return}if(!(C?O&&Ne||W?await Sl.createMasterPin(m,J):await Sl.changeMasterPin(u,m,J):await Sl.createMasterPin(m,J))){I("    "),R(!1);return}k({title:C?O&&Ne||W?"     ":"    ":"    ",description:C?O&&Ne||W?"      ":"     ":"     "}),n==null||n(),Ie()}}catch{I("     ")}finally{R(!1)}},Ie=()=>{h(""),p(""),g(""),I(""),b(!1),S(!1),T(!1),Y(!1),Fe(!1),X(!1),fe(i),e(!1)};return f.jsx(Ba,{open:t,onOpenChange:Ie,children:f.jsxs(xo,{className:yn("sm:max-w-md bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",o),dir:"rtl",overlayClassName:a,children:[f.jsx(rl,{children:f.jsxs(sl,{className:"flex items-center gap-2 text-center justify-center text-gray-900 dark:text-gray-100",children:[f.jsx(mE,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),r]})}),f.jsx("div",{className:"text-center text-sm text-gray-600 dark:text-gray-400 mb-4",children:s}),f.jsxs("form",{ref:le,onSubmit:Ge,className:"space-y-4",children:[(pe==="verify"||pe==="change"&&C)&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"currentPin",className:"text-right block text-gray-700 dark:text-gray-300",children:pe==="verify"?"  ":"  "}),f.jsxs("div",{className:"relative",children:[f.jsx(ar,{id:"currentPin",type:E?"text":"password",autoComplete:"off",value:u,onChange:ve=>h(ve.target.value),onKeyDown:ve=>{var J;if(ve.key==="Enter")try{(J=le.current)==null||J.requestSubmit()}catch{}},placeholder:pe==="verify"?"   ":"   ",className:"pr-10 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",dir:"ltr",inputMode:"numeric",autoFocus:!0,disabled:pe==="change"&&W}),f.jsx(wt,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent text-gray-500 dark:text-gray-400",onClick:()=>b(!E),children:E?f.jsx(jh,{className:"h-4 w-4"}):f.jsx(Fh,{className:"h-4 w-4"})})]}),pe==="verify"&&f.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2 flex items-center justify-between",children:[f.jsx("span",{children:"   "}),f.jsx(wt,{type:"button",variant:"link",size:"sm",className:"h-auto p-0 text-blue-600 dark:text-blue-400 hover:no-underline",onClick:()=>Fe(!0),children:" "})]}),pe==="change"&&C&&Ne&&f.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2 flex items-center justify-between",children:[f.jsx("span",{children:"  "}),f.jsx(wt,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2 dark:border-gray-700 dark:text-gray-300",onClick:()=>{X(ve=>!ve)},children:O?"   ":"    "})]}),pe==="change"&&C&&f.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2 flex items-center justify-between",children:[f.jsx("span",{children:"       "}),f.jsx(wt,{type:"button",variant:"secondary",size:"sm",className:"h-7 px-2 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700",onClick:()=>Fe(!0),children:"  "})]}),pe==="change"&&W&&f.jsx("div",{className:"text-[11px] text-green-600 dark:text-green-400",children:"          "})]}),(pe==="create"||pe==="change")&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"newPin",className:"text-right block text-gray-700 dark:text-gray-300",children:pe==="create"?"   ":"  "}),f.jsxs("div",{className:"relative",children:[f.jsx(ar,{id:"newPin",type:_?"text":"password",autoComplete:"off",value:m,onChange:ve=>p(ve.target.value),onKeyDown:ve=>{var J;if(ve.key==="Enter")try{(J=le.current)==null||J.requestSubmit()}catch{}},placeholder:"   ",className:"pr-10 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",dir:"ltr",inputMode:"numeric"}),f.jsx(wt,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent text-gray-500 dark:text-gray-400",onClick:()=>S(!_),children:_?f.jsx(jh,{className:"h-4 w-4"}):f.jsx(Fh,{className:"h-4 w-4"})})]})]}),(pe==="create"||pe==="change")&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"confirmPin",className:"text-right block text-gray-700 dark:text-gray-300",children:"   "}),f.jsxs("div",{className:"relative",children:[f.jsx(ar,{id:"confirmPin",type:P?"text":"password",autoComplete:"off",value:v,onChange:ve=>g(ve.target.value),onKeyDown:ve=>{var J;if(ve.key==="Enter")try{(J=le.current)==null||J.requestSubmit()}catch{}},placeholder:"    ",className:"pr-10 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",dir:"ltr",inputMode:"numeric"}),f.jsx(wt,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent text-gray-500 dark:text-gray-400",onClick:()=>T(!P),children:P?f.jsx(jh,{className:"h-4 w-4"}):f.jsx(Fh,{className:"h-4 w-4"})})]})]}),N&&f.jsxs("div",{className:"flex items-center gap-2 text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/30 p-3 rounded-lg border border-red-100 dark:border-red-900/50",children:[f.jsx(k3,{className:"h-4 w-4"}),N]}),f.jsxs("div",{className:"flex gap-3 pt-4",children:[f.jsx(wt,{type:"button",variant:"outline",onClick:Ie,className:"flex-1 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",children:""}),f.jsx(wt,{type:"submit",disabled:A,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:A?f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})," ..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Uy,{className:"h-4 w-4 mr-2"}),pe==="verify"?"":pe==="create"?"":""]})})]})]}),f.jsx(KV,{open:Le,onOpenChange:Fe,title:"   ",description:"         ",onSuccess:()=>{Y(!0),Fe(!1),I(""),pe==="verify"&&fe("change")}})]})})},ane=Object.freeze(Object.defineProperty({__proto__:null,MasterPinDialog:lb,default:lb},Symbol.toStringTag,{value:"Module"})),iee={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"0.0.0",VITE_DEV_MODE:"true",VITE_ENABLE_OFFLINE_PERSISTENCE:"false",VITE_FIREBASE_API_KEY:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),VITE_FIREBASE_APP_ID:"1:483702062341:web:b1ff06ad175cb7ae428b6c",VITE_FIREBASE_AUTH_DOMAIN:"voda-c6abd.firebaseapp.com",VITE_FIREBASE_AUTH_EMULATOR_URL:"http://localhost:9099",VITE_FIREBASE_FIRESTORE_EMULATOR_HOST:"localhost:8080",VITE_FIREBASE_FUNCTIONS_EMULATOR_HOST:"localhost:5001",VITE_FIREBASE_MEASUREMENT_ID:"G-CV6QGH7G7P",VITE_FIREBASE_MESSAGING_SENDER_ID:"483702062341",VITE_FIREBASE_PROJECT_ID:"voda-c6abd",VITE_FIREBASE_STORAGE_BUCKET:"voda-c6abd.appspot.com",VITE_FORCE_HASH_ROUTER:"true",VITE_SHOP_ID:"demo-shop-001",VITE_SHOP_NAME:"   ",VITE_SHOW_ENV_BANNER:"true",VITE_USE_EMULATORS:"false",VITE_USE_FIREBASE_EMULATOR:"false"},GV=y.createContext(void 0);function Zs(){const t=y.useContext(GV);if(t===void 0)throw new Error("useFirebaseAuth must be used within a FirebaseAuthProvider");return t}const qc=2,oee=1e3*60*60*24,aee=({children:t})=>{const[e,n]=y.useState(null),[r,s]=y.useState(null),[i,o]=y.useState(null),[a,l]=y.useState(null),[c,u]=y.useState(!1),[h,m]=y.useState(!0),p=y.useRef(null),v=y.useRef(null),[g,E]=y.useState(!1),[b,_]=y.useState(qc),[S,P]=y.useState([]),[T,N]=y.useState(!1),[I,A]=y.useState(null),[R,k]=y.useState(!1),[C,L]=y.useState(!1),{toast:O}=ll(),X=()=>{try{const Q="device_id",de=localStorage.getItem(Q);if(de&&de.length>0)return de;const _e=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`dev-${Math.random().toString(36).slice(2)}-${Date.now()}`;return localStorage.setItem(Q,_e),_e}catch{return"unknown-device"}},Ne=()=>{try{const Q=typeof window<"u"?window:null,de=typeof navigator<"u"&&navigator.userAgent||"",_e=typeof navigator<"u"&&navigator.platform||"",nt=de.toLowerCase(),he=_e.toLowerCase();return Q&&Q.electronAPI?nt.includes("windows")?{deviceName:"  - ",deviceType:"desktop"}:nt.includes("mac")?{deviceName:"  - ",deviceType:"desktop"}:nt.includes("linux")?{deviceName:"  - ",deviceType:"desktop"}:{deviceName:"  ",deviceType:"desktop"}:/android/i.test(de)?{deviceName:" ",deviceType:"mobile-web"}:/iphone|ipad|ipod/i.test(de)?{deviceName:" iOS",deviceType:"mobile-web"}:/mobile/i.test(de)?{deviceName:" ",deviceType:"mobile-web"}:he.includes("win")?{deviceName:"   - ",deviceType:"web"}:he.includes("mac")?{deviceName:"   - ",deviceType:"web"}:he.includes("linux")?{deviceName:"   - ",deviceType:"web"}:{deviceName:"  ",deviceType:"web"}}catch{return{deviceName:"  ",deviceType:"unknown"}}},Le=Q=>{const de=String(Q||"").toLowerCase();return de==="desktop"?"  ":de==="web"?"  ":de==="mobile-web"?" ":de==="android"?" ":" "},Fe=async()=>{if(!(e!=null&&e.uid)){P([]);return}N(!0);try{const Q=xe(F,"userSessions"),de=Ye(Q,Oe("userId","==",e.uid)),_e=await et(de),nt=Date.now(),he=1e3*60*60*24,Ce=_e.docs.map(Ue=>{const rt=Ue.data(),lt=rt.forcedLogout===!0;let Lt,Ct;try{const q=rt.createdAt;Lt=q&&typeof q.toDate=="function"?q.toDate():q?new Date(q):void 0}catch{Lt=void 0}try{const q=rt.lastSeen;Ct=q&&typeof q.toDate=="function"?q.toDate():q?new Date(q):Lt}catch{Ct=Lt}return{id:Ue.id,deviceId:String(rt.deviceId||""),deviceName:rt.deviceName?String(rt.deviceName):void 0,deviceType:rt.deviceType?String(rt.deviceType):void 0,createdAt:Lt,lastSeen:Ct,forcedLogout:lt}}).filter(Ue=>{if(Ue.forcedLogout||!Ue.lastSeen)return!1;const rt=Ue.lastSeen.getTime();return!rt||isNaN(rt)?!1:nt-rt<he}).sort((Ue,rt)=>{const lt=Date.now();let Lt=Ue.lastSeen instanceof Date?Ue.lastSeen.getTime():0,Ct=rt.lastSeen instanceof Date?rt.lastSeen.getTime():0;Lt>lt+6e4&&(Lt=lt),Ct>lt+6e4&&(Ct=lt);const q=Ct-Lt;return q!==0?q:Ue.deviceId===currentDeviceId?-1:rt.deviceId===currentDeviceId?1:0});P(Ce)}catch{P([])}finally{N(!1)}},W=async Q=>{try{const de=X(),_e=Ne(),nt=xe(F,"userSessions"),he=Ye(nt,Oe("userId","==",Q),Oe("deviceId","==",de)),Ce=await et(he);if(!Ce.empty){const Ue=Ce.docs[0].ref;await xn(Ue,{lastSeen:Be(),deviceName:_e.deviceName,deviceType:_e.deviceType});return}await Ls(nt,{userId:Q,deviceId:de,deviceName:_e.deviceName,deviceType:_e.deviceType,createdAt:Be(),lastSeen:Be()})}catch(de){console.error("session registration error:",de)}},Y=async Q=>{try{const de=X(),_e=xe(F,"userSessions"),nt=Ye(_e,Oe("userId","==",Q),Oe("deviceId","==",de)),Ce=(await et(nt)).docs.map(Ue=>Hn(Ue.ref));Ce.length>0&&await Promise.all(Ce)}catch(de){console.error("session clear error:",de)}},le=(Q,de)=>{if(de===!0)return null;const nt=typeof Q=="number"?Q:parseInt(String(Q??""),10);return!isNaN(nt)&&nt>0?nt:qc},pe=async Q=>{try{const de=ye(F,"users",Q),_e=await Sn(de);if(!_e.exists())return _(qc),qc;const nt=_e.data(),he=le(nt.sessionLimit,nt.sessionLimitDisabled);return _(he),he}catch(de){return console.error("session limit load error:",de),_(qc),qc}},fe=(Q,de)=>{try{const _e=X(),nt=xe(F,"userSessions"),he=Ye(nt,Oe("userId","==",Q),di(50));if(v.current)try{v.current()}catch{}v.current=Vo(he,Ce=>{try{const Ue=Ce.docs.map(Re=>{const ue=Re.data();let ae,Tt;try{const _t=ue.createdAt;ae=_t&&typeof _t.toDate=="function"?_t.toDate():new Date(_t||Date.now())}catch{ae=new Date}try{const _t=ue.lastSeen;Tt=_t&&typeof _t.toDate=="function"?_t.toDate():new Date(_t||ae)}catch{Tt=ae}return{id:Re.id,deviceId:String(ue.deviceId||""),createdAt:ae,lastSeen:Tt,forcedLogout:ue.forcedLogout===!0}});Ue.sort((Re,ue)=>{const ae=Date.now();let Tt=Re.lastSeen instanceof Date?Re.lastSeen.getTime():0,_t=ue.lastSeen instanceof Date?ue.lastSeen.getTime():0;Tt>ae+6e4&&(Tt=ae),_t>ae+6e4&&(_t=ae);const Mt=_t-Tt;return Mt!==0?Mt:Re.deviceId===_e?-1:ue.deviceId===_e?1:0});const rt=Date.now(),lt=Ue.filter(Re=>{const ue=Re.lastSeen instanceof Date?Re.lastSeen:Re.createdAt;return!(ue instanceof Date)||isNaN(ue.getTime())||Re.forcedLogout?!1:rt-ue.getTime()<oee}),Lt=Ue.filter(Re=>!lt.some(ue=>ue.id===Re.id));if(Lt.length>0&&Lt.forEach(Re=>{try{Hn(ye(F,"userSessions",Re.id))}catch{}}),Ue.some(Re=>Re.deviceId===_e&&Re.forcedLogout)){E(!0);try{dn()}catch{}return}if(de==null||de<=0){E(!1);return}const q=[...lt].sort((Re,ue)=>{const ae=Re.createdAt instanceof Date?Re.createdAt.getTime():0,Tt=ue.createdAt instanceof Date?ue.createdAt.getTime():0;return ae-Tt}),ke=q.slice(0,de).some(Re=>Re.deviceId===_e);q.length>de?E(!ke):E(!1)}catch(Ue){console.error("sessions listener error:",Ue),E(!1)}},Ce=>{console.error("sessions listener subscribe error:",Ce),E(!1)})}catch(_e){console.error("attachSessionsListener error:",_e),E(!1)}};y.useEffect(()=>{const Q=()=>{console.log(" Received userSubscriptionUpdated event - Refreshing profile..."),e&&(Ge(e.uid,!0),Xn(!0))};return window.addEventListener("userSubscriptionUpdated",Q),()=>{window.removeEventListener("userSubscriptionUpdated",Q)}},[e]),y.useEffect(()=>{let Q=null;if(e){const de=ye(F,"users",e.uid);Q=Vo(de,_e=>{if(_e.exists()){const nt=_e.data();o(nt);const he=le(nt.sessionLimit,nt.sessionLimitDisabled);_(Ce=>Ce!==he?(fe(e.uid,he),he):Ce)}else o(null)},_e=>{console.error("Error listening to user data:",_e)})}else o(null);return()=>{Q&&Q()}},[e]);const Ge=async(Q,de=!1)=>{var _e,nt,he,Ce,Ue,rt,lt,Lt;try{const Ct=ye(F,"profiles",Q),q=`profile_cache_v2_${Q}`,ge=Date.now(),ke=1e3*60*60*24;if(!de)try{const ue=localStorage.getItem(q);if(ue){const{data:ae,timestamp:Tt}=JSON.parse(ue);if(ge-Tt<ke&&(s(ae),m(!1),console.log(" Profile loaded from cache (valid)"),!(ge-Tt>1e3*60*60)))return}}catch(ue){console.warn("Cache parse error:",ue)}const Re=await Sn(Ct);if(Re.exists()){const ue=Re.data(),ae={userId:Re.id,shopId:ue.shopId,role:ue.role,fullName:ue.fullName,phone:ue.phone,sim1Number:ue.sim1Number||null,sim2Number:ue.sim2Number||null,shopName:ue.shopName||null,approved:ue.approved,avatarId:ue.avatarId,bridgeLink:ue.bridgeLink||null,bridgeDeviceId:ue.bridgeDeviceId||null,showWithdrawNote:ue.showWithdrawNote!==void 0?!!ue.showWithdrawNote:!0,isReceiptNoteEnabled:ue.isReceiptNoteEnabled!==void 0?!!ue.isReceiptNoteEnabled:!0,smsReadingEnabled:ue.smsReadingEnabled!==void 0?!!ue.smsReadingEnabled:!1,smsAutoRegisterEnabled:ue.smsAutoRegisterEnabled!==void 0?!!ue.smsAutoRegisterEnabled:!1,smsAutoConfirmDuration:typeof ue.smsAutoConfirmDuration=="number"?ue.smsAutoConfirmDuration:5,createdAt:((nt=(_e=ue.createdAt)==null?void 0:_e.toDate)==null?void 0:nt.call(_e))||new Date,updatedAt:((Ce=(he=ue.updatedAt)==null?void 0:he.toDate)==null?void 0:Ce.call(he))||new Date,trialStarted:ue.trialStarted||!1,trialStartDate:(rt=(Ue=ue.trialStartDate)==null?void 0:Ue.toDate)==null?void 0:rt.call(Ue),trialEndDate:(Lt=(lt=ue.trialEndDate)==null?void 0:lt.toDate)==null?void 0:Lt.call(lt),trialExpired:ue.trialExpired||!1,referralCode:ue.referralCode||null,referredBy:ue.referredBy||null};s(ae);try{localStorage.setItem(q,JSON.stringify({data:ae,timestamp:ge})),ae.shopId&&localStorage.setItem("shopId",ae.shopId)}catch{}}else try{const ue=await lV.getByUserId(Q);if(ue){const ae={userId:Q,shopId:ue.shopId,role:ue.role||"user",fullName:ue.fullName||null,phone:ue.phone||null,shopName:ue.shopName||null,approved:ue.approved??!1,avatarId:ue.avatarId||void 0,bridgeLink:ue.bridgeLink||null,bridgeDeviceId:ue.bridgeDeviceId||null,createdAt:Be(),updatedAt:Be()};await rn(ye(F,"profiles",Q),ae,{merge:!0}),s({...ue,userId:Q})}else await ve(Q)}catch(ue){console.error("Profile migration error:",ue)}m(!1)}catch(Ct){console.error("Error fetching profile:",Ct),m(!1)}},Ie=async Q=>{try{const de=ye(F,"users",Q.uid);(await Sn(de)).exists()?(await xn(de,{lastLogin:Be(),updatedAt:Be()}),console.log(" ensureAdminUserDoc: Updated lastLogin for",Q.uid)):(await rn(de,{email:Q.email||"",displayName:Q.displayName||" ",phone:null,shopName:null,isActive:!1,createdAt:Be(),updatedAt:Be(),lastLogin:Be()},{merge:!0}),console.log(" ensureAdminUserDoc: Created users doc for",Q.uid))}catch(de){console.error(" ensureAdminUserDoc error:",de)}},ve=async(Q,de,_e,nt,he)=>{var Ce,Ue;try{console.log("Creating default profile for user:",Q);const rt=ib.generateReferralCode(Q);let lt=null;const Lt={userId:Q,shopId:"default-shop",role:"user",fullName:de||" ",phone:_e||null,shopName:nt||null,approved:!1,referralCode:rt,referredBy:he||null,bridgeLink:null,bridgeDeviceId:null,showWithdrawNote:!0,isReceiptNoteEnabled:!0,smsReadingEnabled:!1,smsAutoRegisterEnabled:!1,createdAt:new Date,updatedAt:new Date};s(Lt),console.log("Created temporary profile:",Lt);try{const{doc:Ct,setDoc:q,serverTimestamp:ge}=await ee(async()=>{const{doc:ae,setDoc:Tt,serverTimestamp:_t}=await Promise.resolve().then(()=>kn);return{doc:ae,setDoc:Tt,serverTimestamp:_t}},void 0,import.meta.url),{db:ke}=await ee(async()=>{const{db:ae}=await Promise.resolve().then(()=>En);return{db:ae}},void 0,import.meta.url),Re={email:((Ce=qt.currentUser)==null?void 0:Ce.email)||"",displayName:de||" ",phone:_e||null,shopName:nt||null,isActive:!1,referralCode:rt,referredBy:he||null,createdAt:ge(),lastLogin:null,updatedAt:ge()};if(console.log("Attempting to add user to admin collection with data:",Re),await q(Ct(ke,"users",Q),Re,{merge:!0}),console.log(" User successfully added to admin collection:",Re),he)try{const{query:ae,collection:Tt,where:_t,limit:Mt,getDocs:Zn}=await ee(async()=>{const{query:Z,collection:K,where:oe,limit:H,getDocs:Ae}=await Promise.resolve().then(()=>kn);return{query:Z,collection:K,where:oe,limit:H,getDocs:Ae}},void 0,import.meta.url),{db:M}=await ee(async()=>{const{db:Z}=await Promise.resolve().then(()=>En);return{db:Z}},void 0,import.meta.url),z=ae(Tt(M,"users"),_t("referralCode","==",he),Mt(1)),j=await Zn(z);j.empty?console.log(" Referral code not found in users collection:",he):(lt=j.docs[0].id,await ib.create({referrerId:lt,referredUserId:Q,referredUserEmail:((Ue=qt.currentUser)==null?void 0:Ue.email)||"",referralCode:he,status:"completed"}),console.log(" Referral record created successfully for referrer:",lt))}catch(ae){console.error(" Error creating referral record:",ae)}const ue=await Sn(Ct(ke,"users",Q));ue.exists()?console.log(" User document verified in Firestore:",ue.data()):console.log(" User document not found after creation")}catch(Ct){console.error(" Error adding user to admin collection:",Ct)}try{const{addDoc:Ct,collection:q,serverTimestamp:ge}=await ee(async()=>{const{addDoc:Tt,collection:_t,serverTimestamp:Mt}=await Promise.resolve().then(()=>kn);return{addDoc:Tt,collection:_t,serverTimestamp:Mt}},void 0,import.meta.url),{db:ke}=await ee(async()=>{const{db:Tt}=await Promise.resolve().then(()=>En);return{db:Tt}},void 0,import.meta.url),ue=(await Ct(q(ke,"shops"),{name:nt||" ",ownerId:Q,createdAt:ge(),updatedAt:ge(),isActive:!0})).id;await Zh.create({userId:Q,shopId:ue,role:"user",fullName:" ",phone:null});try{await Zh.update(Q,{referralCode:rt,referredBy:lt||null,showWithdrawNote:!0,isReceiptNoteEnabled:!0})}catch(Tt){console.warn(" Failed to update profile with referral fields:",Tt)}const ae=await Zh.getById(Q);ae&&(s(ae),console.log("Updated with Firebase profile:",ae))}catch(Ct){console.error("Error creating profile:",Ct),console.log("Using local profile - Firebase unavailable")}}catch(rt){console.error("Error creating default profile:",rt)}};y.useEffect(()=>{console.log(" Setting up auth state listener"),m(!0);const Q=setTimeout(()=>{console.warn(" Global auth timeout reached, forcing loading to false"),m(!1)},2e4);localStorage.getItem("demoProfile")&&(console.log(" Cleaning up demo profile from localStorage"),localStorage.removeItem("demoProfile"));const de=localStorage.getItem("demoUser"),_e=localStorage.getItem("demoProfile");if(de&&_e){console.log(" Found demo user in localStorage");try{const he=JSON.parse(de),Ce=JSON.parse(_e);n(he),s(Ce),clearTimeout(Q),m(!1);return}catch(he){console.error("Error parsing demo user data:",he),localStorage.removeItem("demoUser"),localStorage.removeItem("demoProfile")}}const nt=y7(qt,async he=>{if(console.log(" Auth state changed:",{uid:he==null?void 0:he.uid,email:he==null?void 0:he.email,emailVerified:he==null?void 0:he.emailVerified,timestamp:new Date().toISOString()}),n(he),he){console.log(" User authenticated, starting profile hydration for:",he.uid);try{const Ce=await pe(he.uid);await W(he.uid),fe(he.uid,Ce)}catch(Ce){console.error("session registration on auth change error:",Ce)}try{await Ml.set({key:"current_user_id",value:he.uid}),console.log(" Synced current_user_id to Native:",he.uid)}catch(Ce){console.error("Failed to sync user ID to native:",Ce)}try{if(!localStorage.getItem("theme")){localStorage.setItem("theme","light");try{document.documentElement.classList.remove("dark"),document.documentElement.setAttribute("data-theme","light")}catch{}}}catch{}Ge(he.uid),Xn(),Ie(he)}else{if(console.log(" User not authenticated, clearing profile"),s(null),l(null),u(!1),E(!1),v.current){try{v.current()}catch{}v.current=null}m(!1);try{await Ml.remove({key:"current_user_id"}),await Ml.remove({key:"selected_wallet_id"})}catch{}}clearTimeout(Q)});return()=>{clearTimeout(Q),nt()}},[]),y.useEffect(()=>{const Q=async()=>{try{await sr(),await Xn(!0)}catch{}};try{window.addEventListener("app:softRefresh",Q)}catch{}return()=>{try{window.removeEventListener("app:softRefresh",Q)}catch{}}},[e==null?void 0:e.uid]),y.useEffect(()=>{const Q=()=>{try{Xn(!0)}catch{}};try{window.addEventListener("userSubscriptionUpdated",Q),window.addEventListener("subscriptionActivated",Q)}catch{}return()=>{try{window.removeEventListener("userSubscriptionUpdated",Q),window.removeEventListener("subscriptionActivated",Q)}catch{}}},[e==null?void 0:e.uid]),y.useEffect(()=>{e!=null&&e.uid&&mr.syncDeletedTransactionsLocal(e.uid)},[e==null?void 0:e.uid]);const J=async(Q,de,_e,nt,he,Ce)=>{try{const Ue=(Q||"").trim().toLowerCase(),rt=(de||"").trim();console.log(" Attempting to sign up user:",Ue);const lt=await mA(qt,Ue,rt);console.log(" Sign up successful:",lt.user.uid),await ve(lt.user.uid,_e,nt,he,Ce),await Ie(lt.user);try{await Ge(lt.user.uid),await Xn()}catch{}try{if(!localStorage.getItem("theme")){localStorage.setItem("theme","light");try{document.documentElement.classList.remove("dark"),document.documentElement.setAttribute("data-theme","light")}catch{}}}catch{}return{error:null}}catch(Ue){console.error(" Sign up error:",Ue);let rt="    ";return Ue.code==="auth/email-already-in-use"?rt="    ":Ue.code==="auth/weak-password"?rt="   ":Ue.code==="auth/invalid-email"&&(rt="   "),{error:{...Ue,message:rt}}}},qe=async(Q,de)=>{var he;const _e=(Q||"").trim().toLowerCase(),nt=(de||"").trim();try{const Ce=ge=>ge.replace(/[\u200B\u200C\u200D\u200E\u200F\u061C]/g,""),Ue=ge=>ge.replace(/[-]/g,ke=>String("0123456789"["".indexOf(ke)])).replace(/[-]/g,ke=>String("0123456789"["".indexOf(ke)])),rt=ge=>ge.replace(/[0-9]/g,ke=>""[Number(ke)]),lt=ge=>Ue(Ce(ge));if(console.log(" Attempting to sign in user:",_e),_e==="test@example.com"&&nt==="123456"){console.log(" Demo user login detected");const ge={uid:"demo-user-123",email:"test@example.com",displayName:" ",emailVerified:!0},ke={userId:"demo-user-123",shopId:"demo-shop",role:"user",fullName:" ",phone:"01000000000",approved:!0,createdAt:new Date,updatedAt:new Date};return localStorage.setItem("demoUser",JSON.stringify(ge)),localStorage.setItem("demoProfile",JSON.stringify(ke)),n(ge),s(ke),m(!1),console.log(" Demo user signed in successfully"),{error:null}}let Lt;const Ct=[lt(nt),Ce(nt),rt(Ce(nt))];let q=null;for(const ge of Ct)try{ge!==nt&&console.log(" Trying password variant"),Lt=await w2(qt,_e,ge);break}catch(ke){if(q=ke,(ke==null?void 0:ke.code)!=="auth/wrong-password"&&(ke==null?void 0:ke.code)!=="auth/invalid-credential")throw ke}if(!Lt)throw q||new Error("auth/invalid-credential");console.log(" Sign in successful:",Lt.user.uid);try{if((await Sn(ye(F,"deletedUsers",Lt.user.uid))).exists())return console.log(" User is deleted, signing out"),await pA(qt),{error:{code:"auth/user-deleted",message:"      .    ."}}}catch(ge){console.error("Error checking deleted users:",ge)}await Ie(Lt.user);try{await Ge(Lt.user.uid),await Xn()}catch{}return{error:null}}catch(Ce){if(console.error(" Sign in error:",Ce),_e==="test@example.com"&&Ce.code==="auth/user-not-found"){console.log(" Creating test user...");try{const lt=await mA(qt,_e,nt);return console.log(" Test user created:",lt.user.uid),await ve(lt.user.uid," ","01000000000"," "),{error:null}}catch(lt){return console.error(" Error creating test user:",lt),{error:lt}}}let Ue="    ",rt=Ce==null?void 0:Ce.code;if(rt==="auth/invalid-credential")try{const lt=await h7(qt,((he=Ce==null?void 0:Ce.customData)==null?void 0:he.email)||"");Array.isArray(lt)&&lt.length===0?(rt="auth/user-not-found",Ue="     "):(rt="auth/wrong-password",Ue="   ")}catch{Ue="      "}else rt==="auth/invalid-email"?Ue="    ":rt==="auth/user-not-found"?Ue="     ":rt==="auth/wrong-password"?Ue="   ":rt==="auth/too-many-requests"&&(Ue="      ");return{error:{...Ce,code:rt,message:Ue}}}},dn=async()=>{try{const Q=e==null?void 0:e.uid;if(localStorage.getItem("demoUser"))console.log(" Signing out demo user"),localStorage.removeItem("demoUser"),localStorage.removeItem("demoProfile"),n(null),s(null),m(!1);else{if(Q)try{await Y(Q)}catch(he){console.error("session clear on sign out error:",he)}await pA(qt)}Q&&(localStorage.removeItem(`sub_cache_${Q}`),localStorage.removeItem(`profile_cache_v2_${Q}`),console.log(" Cleared user caches for:",Q));try{await Ml.remove({key:"selected_wallet_id"}),await Ml.remove({key:"current_user_id"}),console.log(" Cleared selected_wallet_id and current_user_id from Capacitor Preferences")}catch(he){console.error(" Failed to clear Preferences:",he)}const nt=(()=>{try{const he=typeof window<"u"?window:null,Ce=!!(he&&he.electronAPI)||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"),Ue=typeof window<"u"&&window.location.protocol==="file:",rt=typeof window<"u"&&typeof window.location.hash=="string"&&window.location.hash.startsWith("#/");return Ce||Ue||rt||typeof import.meta<"u"&&iee&&!0}catch{return!1}})()?"#/user/login":"/user/login";try{window.location.replace(nt)}catch{window.location.href=nt}}catch(Q){console.error("Sign out error:",Q)}},dr=async Q=>{try{return await u7(qt,Q),{error:null}}catch(de){console.error("Reset password error:",de);let _e="        ";return de.code==="auth/user-not-found"?_e="     ":de.code==="auth/invalid-email"&&(_e="   "),{error:{...de,message:_e}}}},Xn=async(Q=!1)=>{var he,Ce,Ue,rt,lt,Lt,Ct,q,ge,ke,Re,ue,ae,Tt,_t,Mt,Zn,M,z,j,Z;if(!e){console.log("No user found for subscription check"),l(null),u(!1);return}p.current&&(p.current(),p.current=null),console.log("Checking subscription status for user:",e.uid,{force:Q});const de=`sub_cache_${e.uid}`,_e=Date.now(),nt=1e3*60*60*24;if(!Q)try{const K=localStorage.getItem(de);if(K){const{data:oe,timestamp:H}=JSON.parse(K);if(_e-H<nt){const Ae={...oe,subscription:oe.subscription?{...oe.subscription,activatedAt:oe.subscription.activatedAt?{toDate:()=>new Date(oe.subscription.activatedAt)}:null,endDate:oe.subscription.endDate?{toDate:()=>new Date(oe.subscription.endDate)}:null}:null,branchPackage:oe.branchPackage?{...oe.branchPackage,activatedAt:oe.branchPackage.activatedAt?{toDate:()=>new Date(oe.branchPackage.activatedAt)}:null,endDate:oe.branchPackage.endDate?{toDate:()=>new Date(oe.branchPackage.endDate)}:null}:null,freeTrialStartDate:oe.freeTrialStartDate?{toDate:()=>new Date(oe.freeTrialStartDate)}:null,freeTrialEndDate:oe.freeTrialEndDate?{toDate:()=>new Date(oe.freeTrialEndDate)}:null};l(Ae);const st=((he=oe==null?void 0:oe.branchPackage)==null?void 0:he.status)==="active";let te=!1;if(st)te=!0;else{const ne=Ae.subscription;te=aP(ne)}u(te),console.log(" Subscription loaded from cache (Client-side validity check applied)");return}}}catch(K){console.warn("Subscription Cache parse error:",K)}try{const K=ye(F,"users",e.uid),oe=await Sn(K);if(oe.exists()){const H=oe.data();l(H);try{const ne={...H,subscription:H.subscription?{...H.subscription,activatedAt:((rt=(Ue=(Ce=H.subscription.activatedAt)==null?void 0:Ce.toDate)==null?void 0:Ue.call(Ce))==null?void 0:rt.toISOString())||H.subscription.activatedAt,endDate:((Ct=(Lt=(lt=H.subscription.endDate)==null?void 0:lt.toDate)==null?void 0:Lt.call(lt))==null?void 0:Ct.toISOString())||H.subscription.endDate}:null,branchPackage:H.branchPackage?{...H.branchPackage,activatedAt:((ke=(ge=(q=H.branchPackage.activatedAt)==null?void 0:q.toDate)==null?void 0:ge.call(q))==null?void 0:ke.toISOString())||H.branchPackage.activatedAt,endDate:((ae=(ue=(Re=H.branchPackage.endDate)==null?void 0:Re.toDate)==null?void 0:ue.call(Re))==null?void 0:ae.toISOString())||H.branchPackage.endDate}:null,freeTrialStartDate:((Mt=(_t=(Tt=H.freeTrialStartDate)==null?void 0:Tt.toDate)==null?void 0:_t.call(Tt))==null?void 0:Mt.toISOString())||H.freeTrialStartDate,freeTrialEndDate:((z=(M=(Zn=H.freeTrialEndDate)==null?void 0:Zn.toDate)==null?void 0:M.call(Zn))==null?void 0:z.toISOString())||H.freeTrialEndDate};localStorage.setItem(de,JSON.stringify({data:ne,timestamp:_e}))}catch{}console.log(" Subscription Data Details (Fetched):",{userId:e.uid,isActive:(j=H.subscription)==null?void 0:j.isActive});const Ae=((Z=H==null?void 0:H.branchPackage)==null?void 0:Z.status)==="active";let st=!1;if(Ae){const ne=H.branchPackage;let be=!1;if(ne.endDate){const ze=ne.endDate.toDate?ne.endDate.toDate():new Date(ne.endDate);!isNaN(ze.getTime())&&new Date>ze&&(be=!0,TX(e.uid,ne).catch(console.error))}st=!be}const te=st||aP(H.subscription);u(te)}}catch(K){console.error("Error checking subscription status:",K)}},sr=async()=>{if(e)try{console.log("Refreshing profile for user:",e.uid),await Ge(e.uid,!0),await Xn(!0)}catch(Q){console.error("Error refreshing profile:",Q)}},Lr={user:e,profile:r,userData:i,userSubscription:a,isSubscriptionActive:c,loading:h,signUp:J,signIn:qe,signOut:dn,resetPassword:dr,updateUserProfile:async Q=>{if(e)try{const de={updatedAt:Be()};if(Q.fullName!==void 0&&(de.fullName=Q.fullName),Q.phone!==void 0&&(de.phone=Q.phone),Q.sim1Number!==void 0){const _e=(Q.sim1Number||"").trim();de.sim1Number=_e.length?_e:null}if(Q.sim2Number!==void 0){const _e=(Q.sim2Number||"").trim();de.sim2Number=_e.length?_e:null}if(Q.bridgeLink!==void 0){const _e=(Q.bridgeLink||"").trim();de.bridgeLink=_e.length?_e:null}if(Q.bridgeDeviceId!==void 0){const _e=(Q.bridgeDeviceId||"").trim();de.bridgeDeviceId=_e.length?_e:null}Q.showWithdrawNote!==void 0&&(de.showWithdrawNote=!!Q.showWithdrawNote),Q.isReceiptNoteEnabled!==void 0&&(de.isReceiptNoteEnabled=!!Q.isReceiptNoteEnabled),Q.smsReadingEnabled!==void 0&&(de.smsReadingEnabled=!!Q.smsReadingEnabled),Q.smsAutoRegisterEnabled!==void 0&&(de.smsAutoRegisterEnabled=!!Q.smsAutoRegisterEnabled),Q.smsAutoConfirmDuration!==void 0&&(de.smsAutoConfirmDuration=Q.smsAutoConfirmDuration),await xn(ye(F,"profiles",e.uid),de),await Ge(e.uid,!0)}catch(de){console.error("Error updating user profile:",de)}},updateAvatarId:async Q=>{if(e)try{await xn(ye(F,"profiles",e.uid),{avatarId:Q,updatedAt:Be()}),await Ge(e.uid)}catch(de){console.error("Error updating avatarId:",de)}},refreshProfile:sr,checkSubscriptionStatus:Xn,isSessionBlocked:g};return f.jsxs(GV.Provider,{value:Lr,children:[t,g&&f.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/70 p-4",children:[f.jsxs("div",{className:"w-full max-w-md rounded-xl bg-white p-6 shadow-xl max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("h2",{className:"mb-3 text-lg font-semibold text-gray-900",children:"   "}),f.jsx("p",{className:"mb-1 text-sm text-gray-700",children:"       ."}),f.jsx("p",{className:"mb-1 text-sm text-gray-700",children:"          ."}),f.jsx("p",{className:"text-sm text-gray-700",children:"                   ."})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx(wt,{onClick:()=>{L(!C),C||Fe()},variant:"outline",className:"w-full",children:C?"  ":"  "}),C&&f.jsxs("div",{className:"space-y-3 mt-4",children:[T&&f.jsx("p",{className:"text-center text-sm text-gray-500",children:" ..."}),!T&&S.length===0&&f.jsx("p",{className:"text-center text-sm text-gray-500",children:"   "}),!T&&S.map(Q=>{const de=Q.deviceId&&Q.deviceId===X(),_e=Le(Q.deviceType);return f.jsxs("div",{className:"flex flex-col gap-2 rounded-lg border p-3 text-right",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm font-medium text-gray-900",children:Q.deviceName||"  "}),de&&f.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:" "})]}),f.jsxs("div",{className:"text-xs text-gray-500",children:[_e,Q.lastSeen&&`  ${AX(Q.lastSeen)}`]}),!de&&f.jsx(wt,{size:"sm",variant:"destructive",className:"w-full mt-2 h-8 text-xs",onClick:()=>{A(Q.id),k(!0)},children:" "})]},Q.id)})]})]})]}),f.jsx(lb,{open:R,onOpenChange:Q=>{k(Q),Q||A(null)},mode:"verify",title:"   ",description:"         .",userId:e==null?void 0:e.uid,userRole:r==null?void 0:r.role,onSuccess:async()=>{if(I)try{await xn(ye(F,"userSessions",I),{forcedLogout:!0}),P(Q=>Q.filter(de=>de.id!==I)),O({title:"   ",description:"       ."})}catch{O({title:"   ",description:"     .",variant:"destructive"})}A(null),k(!1)}})]})]})};function lee(t){const e=y.useRef({value:t,previous:t});return y.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var Vv="Checkbox",[cee]=Sc(Vv),[uee,mI]=cee(Vv);function dee(t){const{__scopeCheckbox:e,checked:n,children:r,defaultChecked:s,disabled:i,form:o,name:a,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:h}=t,[m,p]=lE({prop:n,defaultProp:s??!1,onChange:l,caller:Vv}),[v,g]=y.useState(null),[E,b]=y.useState(null),_=y.useRef(!1),S=v?!!o||!!v.closest("form"):!0,P={checked:m,disabled:i,setChecked:p,control:v,setControl:g,name:a,form:o,value:u,hasConsumerStoppedPropagationRef:_,required:c,defaultChecked:za(s)?!1:s,isFormControl:S,bubbleInput:E,setBubbleInput:b};return f.jsx(uee,{scope:e,...P,children:hee(h)?h(P):r})}var QV="CheckboxTrigger",YV=y.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...r},s)=>{const{control:i,value:o,disabled:a,checked:l,required:c,setControl:u,setChecked:h,hasConsumerStoppedPropagationRef:m,isFormControl:p,bubbleInput:v}=mI(QV,t),g=Qn(s,u),E=y.useRef(l);return y.useEffect(()=>{const b=i==null?void 0:i.form;if(b){const _=()=>h(E.current);return b.addEventListener("reset",_),()=>b.removeEventListener("reset",_)}},[i,h]),f.jsx(_n.button,{type:"button",role:"checkbox","aria-checked":za(l)?"mixed":l,"aria-required":c,"data-state":tj(l),"data-disabled":a?"":void 0,disabled:a,value:o,...r,ref:g,onKeyDown:en(e,b=>{b.key==="Enter"&&b.preventDefault()}),onClick:en(n,b=>{h(_=>za(_)?!0:!_),v&&p&&(m.current=b.isPropagationStopped(),m.current||b.stopPropagation())})})});YV.displayName=QV;var pI=y.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:a,value:l,onCheckedChange:c,form:u,...h}=t;return f.jsx(dee,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:a,required:o,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:m})=>f.jsxs(f.Fragment,{children:[f.jsx(YV,{...h,ref:e,__scopeCheckbox:n}),m&&f.jsx(ej,{__scopeCheckbox:n})]})})});pI.displayName=Vv;var JV="CheckboxIndicator",XV=y.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...s}=t,i=mI(JV,n);return f.jsx(Si,{present:r||za(i.checked)||i.checked===!0,children:f.jsx(_n.span,{"data-state":tj(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});XV.displayName=JV;var ZV="CheckboxBubbleInput",ej=y.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:a,disabled:l,name:c,value:u,form:h,bubbleInput:m,setBubbleInput:p}=mI(ZV,t),v=Qn(n,p),g=lee(i),E=zk(r);y.useEffect(()=>{const _=m;if(!_)return;const S=window.HTMLInputElement.prototype,T=Object.getOwnPropertyDescriptor(S,"checked").set,N=!s.current;if(g!==i&&T){const I=new Event("click",{bubbles:N});_.indeterminate=za(i),T.call(_,za(i)?!1:i),_.dispatchEvent(I)}},[m,g,i,s]);const b=y.useRef(za(i)?!1:i);return f.jsx(_n.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??b.current,required:a,disabled:l,name:c,value:u,form:h,...e,tabIndex:-1,ref:v,style:{...e.style,...E,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});ej.displayName=ZV;function hee(t){return typeof t=="function"}function za(t){return t==="indeterminate"}function tj(t){return za(t)?"indeterminate":t?"checked":"unchecked"}const nj=y.forwardRef(({className:t,...e},n)=>f.jsx(pI,{ref:n,className:yn("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:f.jsx(XV,{className:yn("flex items-center justify-center text-current"),children:f.jsx(pk,{className:"h-4 w-4"})})}));nj.displayName=pI.displayName;const hy=()=>{const[t,e]=y.useState(""),[n,r]=y.useState(""),[s,i]=y.useState(!1),[o,a]=y.useState(!1),[l,c]=y.useState(typeof navigator<"u"?!navigator.onLine:!1);y.useEffect(()=>{const P=()=>c(!navigator.onLine);return window.addEventListener("online",P),window.addEventListener("offline",P),()=>{window.removeEventListener("online",P),window.removeEventListener("offline",P)}},[]);const[u,h]=y.useState(!0),{signIn:m,user:p,checkSubscriptionStatus:v,loading:g}=Zs(),E=io();y.useEffect(()=>{try{p&&!g&&E("/user/dashboard")}catch{}},[p,g,E]),y.useEffect(()=>{try{const P=typeof window<"u"?window.localStorage.getItem("cashy:lastEmail"):null;P&&e(P)}catch{}try{const P=typeof window<"u"?window.localStorage.getItem("cashy:rememberLogin"):null;P==="true"?h(!0):P==="false"&&h(!1)}catch{}(async()=>{var P,T;try{if(typeof navigator<"u"&&navigator.credentials&&window.localStorage.getItem("cashy:rememberLogin")==="true"){const N=await((T=(P=navigator.credentials).get)==null?void 0:T.call(P,{password:!0,mediation:"optional"}));N&&N.type==="password"&&(N.id&&e(N.id),N.password&&r(N.password))}if(window.localStorage.getItem("cashy:rememberLogin")==="true")try{const N=sessionStorage.getItem("cashy:rememberedPassword");N&&!n&&r(N)}catch{}}catch{}})()},[]);const b=async P=>{if(P.preventDefault(),o){kt.info("     ...");return}if(typeof navigator<"u"&&navigator.onLine===!1){kt.error("   .      .");return}const T=(t||"").trim().toLowerCase(),N=(n||"").trim();if(console.log("    :",{email:T,password:"***"}),!t||!n){kt.error("   ");return}if(!/^\S+@\S+\.\S+$/.test(T)){kt.error("    ");return}a(!0);try{try{await m7(qt,u?zE:WE);try{window.localStorage.setItem("cashy:rememberLogin",u?"true":"false")}catch{}}catch{}console.log("  signIn...");const{error:I}=await m(T,N);if(console.log(" SignIn result:",{error:I}),I){console.error("    :",I);const A=I==null?void 0:I.code;A==="auth/user-not-found"?kt.error("     "):A==="auth/wrong-password"?kt.error("   "):A==="auth/invalid-credential"?kt.error("      "):A==="auth/too-many-requests"?kt.error("      "):kt.error((I==null?void 0:I.message)||"    ")}else{console.log("    !"),kt.success("   !");try{if(u&&navigator.credentials&&window.PasswordCredential){const A=new window.PasswordCredential({id:T,name:T,password:N});await navigator.credentials.store(A)}if(u)try{sessionStorage.setItem("cashy:rememberedPassword",N)}catch{}else try{sessionStorage.removeItem("cashy:rememberedPassword")}catch{}}catch{}}}catch(I){console.error("   :",I),kt.error("   ")}finally{a(!1)}},_=P=>{if(o){P.preventDefault(),P.stopPropagation(),kt.info("     ...");return}if(typeof navigator<"u"&&navigator.onLine===!1){P.preventDefault(),P.stopPropagation(),kt.error("   .      .");return}t||kt.error("   "),n||kt.error("   ");const T=(t||"").trim().toLowerCase();T&&!/^\S+@\S+\.\S+$/.test(T)&&kt.error("    ")},S=()=>{E("/user/forgot-password")};return y.useEffect(()=>{if(!(typeof window<"u"&&window.matchMedia&&window.matchMedia("(pointer: coarse)").matches))return;const P=document.documentElement,T=document.body,N=P.style.overflow,I=T.style.overflow,A=P.style.overscrollBehaviorY,R=T.style.overscrollBehaviorY;return P.style.overflow="hidden",T.style.overflow="hidden",P.style.overscrollBehaviorY="none",T.style.overscrollBehaviorY="none",()=>{P.style.overflow=N||"",T.style.overflow=I||"",P.style.overscrollBehaviorY=A||"",T.style.overscrollBehaviorY=R||""}},[]),f.jsxs("div",{className:"relative min-h-[100dvh] w-full overflow-hidden flex items-center justify-center p-4 bg-no-repeat bg-cover",style:{backgroundImage:"var(--bg-purple-gradient)",backgroundAttachment:"fixed"},children:[l&&f.jsx("div",{className:"absolute top-0 left-0 right-0 bg-red-600 text-white text-center py-2 z-50 animate-in fade-in slide-in-from-top-2",children:f.jsx("p",{className:"text-sm font-medium",children:"   .        ."})}),f.jsx("div",{className:"absolute inset-0 bg-black/40"}),f.jsxs("div",{className:"w-full max-w-md mt-16 md:mt-12 lg:mt-10",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-green-600 to-blue-600 rounded-full mb-4 shadow-2xl",children:f.jsx(I5,{className:"w-10 h-10 text-white"})}),f.jsx("div",{className:"flex items-center justify-center mb-2",children:f.jsx("span",{className:"text-2xl font-extrabold text-white tracking-wider uppercase",dir:"ltr",style:{fontFamily:"Inter, sans-serif"},children:"cashy link"})}),f.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"  "}),f.jsx("p",{className:"text-white/80",children:"    "})]}),f.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-8 shadow-2xl border border-white/20",children:[f.jsxs("form",{onSubmit:b,className:"space-y-6",autoComplete:"on",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-white",children:" "}),f.jsxs("div",{className:"relative",children:[f.jsx(s0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/70 w-5 h-5"}),f.jsx(ar,{id:"username",type:"email",placeholder:"  ",value:t,onChange:P=>{const T=P.target.value;e(T);try{window.localStorage.setItem("cashy:lastEmail",T)}catch{}},name:"username",autoComplete:"username",className:"pl-10 pr-4 py-3 rounded-lg bg-white/20 border-white/30 text-white placeholder:text-white/70 focus:ring-2 focus:ring-green-400",dir:"rtl",required:!0})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-white",children:" "}),f.jsxs("div",{className:"relative",children:[f.jsx(Uy,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/70 w-5 h-5"}),f.jsx(ar,{id:"password",type:s?"text":"password",placeholder:"  ",value:n,onChange:P=>r(P.target.value),className:"pl-10 pr-10 py-3 rounded-lg bg-white/20 border-white/30 text-white placeholder:text-white/70 focus:ring-2 focus:ring-green-400",name:"password",autoComplete:"current-password",dir:"rtl",required:!0}),f.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-white/70 hover:text-white transition-colors",children:s?f.jsx(jh,{className:"w-5 h-5"}):f.jsx(Fh,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[f.jsx(nj,{id:"rememberLogin",checked:u,onCheckedChange:P=>h(!!P)}),f.jsx("label",{htmlFor:"rememberLogin",className:"text-sm text-white",children:"  "})]})]}),f.jsx("div",{className:"flex justify-end",children:f.jsxs(wt,{type:"button",variant:"ghost",size:"sm",onClick:S,className:"text-green-200 hover:text-green-100 p-0 h-auto font-normal hover:bg-transparent",children:[f.jsx(s0,{className:"w-4 h-4 ml-1"}),"  "]})}),f.jsx("button",{type:"submit",onClick:_,className:"w-full bg-gradient-to-r from-green-600 to-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:from-green-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-green-400 transition-all duration-200",children:o?f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white ml-2"}),"  ..."]}):f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx(mk,{className:"w-5 h-5 ml-2"})," "]})})]}),f.jsxs("div",{className:"mt-6 text-center space-y-3",children:[f.jsxs("p",{className:"text-sm text-white/80",children:["  "," ",f.jsx(y0,{to:"/user/register",className:"text-green-200 hover:text-green-100 font-medium transition-colors hover:underline",children:"  "})]}),f.jsxs("p",{className:"text-sm text-white/80",children:["        "," ",f.jsx("a",{href:"https://wa.me/201000392539",target:"_blank",rel:"noreferrer",className:"text-green-200 hover:text-green-100 font-medium hover:underline",children:"01000392539"})," ","   "," ",f.jsx("a",{href:"mailto:info@cashy-link.com",className:"text-blue-200 hover:text-blue-100 font-medium hover:underline",children:"info@cashy-link.com"})]})]})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsx("p",{className:"text-xs text-white/70",children:"   "})})]})]})},fee=Object.freeze(Object.defineProperty({__proto__:null,default:hy},Symbol.toStringTag,{value:"Module"})),wd=y.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:yn("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));wd.displayName="Card";const _d=y.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:yn("flex flex-col space-y-1.5 p-6",t),...e}));_d.displayName="CardHeader";const bd=y.forwardRef(({className:t,...e},n)=>f.jsx("h3",{ref:n,className:yn("text-2xl font-semibold leading-none tracking-tight",t),...e}));bd.displayName="CardTitle";const jv=y.forwardRef(({className:t,...e},n)=>f.jsx("p",{ref:n,className:yn("text-sm text-muted-foreground",t),...e}));jv.displayName="CardDescription";const Ed=y.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:yn("p-6 pt-0",t),...e}));Ed.displayName="CardContent";const rj=y.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:yn("flex items-center p-6 pt-0",t),...e}));rj.displayName="CardFooter";function sj({open:t,onOpenChange:e,onSuccess:n}){const{user:r,userSubscription:s}=Zs(),[i,o]=y.useState("1"),[a,l]=y.useState("basic"),[c,u]=y.useState(!1),[h,m]=y.useState(null),p=async()=>{var v;if(r){u(!0),m(null);try{const g=((v=s==null?void 0:s.branchPackage)==null?void 0:v.limit)||0;await xn(ye(F,"users",r.uid),{branchPackage:{status:"pending",requested:!0,limit:g+parseInt(i),packageType:a,requestedAt:new Date().toISOString()}}),m("       ."),window.dispatchEvent(new CustomEvent("userSubscriptionUpdated",{detail:{userId:r.uid,isActive:!0}})),setTimeout(()=>{e(!1),n&&n()},1500)}catch(g){m("  : "+g.message)}finally{u(!1)}}};return f.jsx(Ba,{open:t,onOpenChange:e,children:f.jsxs(xo,{children:[f.jsx(rl,{children:f.jsx(sl,{children:" "})}),f.jsxs("div",{className:"grid gap-4 py-2",children:[f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{children:"   "}),f.jsx(ar,{type:"number",min:"1",value:i,onChange:v=>o(v.target.value),placeholder:"   "})]}),f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{children:" "}),f.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:a,onChange:v=>l(v.target.value),children:[f.jsx("option",{value:"basic",children:"  ()"}),f.jsx("option",{value:"quarterly",children:"   (3 )"}),f.jsx("option",{value:"pro",children:"  ()"}),f.jsx("option",{value:"enterprise",children:"  ( )"})]})]}),h&&f.jsx("p",{className:`text-sm ${h.includes("")?"text-green-600":"text-red-600"}`,children:h})]}),f.jsxs(Mv,{children:[f.jsx(wt,{variant:"outline",onClick:()=>e(!1),children:""}),f.jsx(wt,{onClick:p,disabled:c,className:"bg-black text-white hover:bg-gray-800 dark:bg-white dark:text-black dark:hover:bg-gray-200",children:c?" ...":" "})]})]})})}const lne=Object.freeze(Object.defineProperty({__proto__:null,BranchRequestDialog:sj},Symbol.toStringTag,{value:"Module"}));function EP(){var k,C,L,O;const{user:t,profile:e,isSubscriptionActive:n,userSubscription:r}=Zs(),[s,i]=y.useState(!1),[o,a]=y.useState(!1),[l,c]=y.useState(""),[u,h]=y.useState(""),[m,p]=y.useState(""),[v,g]=y.useState(""),[E,b]=y.useState(!1),[_,S]=y.useState(null),[P,T]=y.useState(0),N=((k=r==null?void 0:r.branchPackage)==null?void 0:k.status)==="active",I=((C=r==null?void 0:r.branchPackage)==null?void 0:C.limit)||0;V.useEffect(()=>{t&&(async()=>{try{const Ne=Ye(xe(F,"shops"),Oe("ownerId","==",t.uid)),Le=await PM(Ne);T(Le.data().count)}catch(Ne){console.error("Error fetching shops count:",Ne)}})()},[t]),(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="merchant"||n||N&&P<I;const A=()=>{c(""),h(""),p(""),g("")},R=async()=>{S(null);const X=l.trim(),Ne=u.trim(),Le=m.trim(),Fe=v;if(N&&P>=I&&(e==null?void 0:e.role)!=="admin"&&(e==null?void 0:e.role)!=="merchant"){S(`        (${I}).   .`);return}if(!X||!Ne||!Le||!Fe){S("    .");return}try{b(!0);const Y=await JY(iV,"createShopAndManager")({shopName:X,managerName:Ne,email:Le,password:Fe,branchCode:null}),le=Y==null?void 0:Y.data;le!=null&&le.success?(S(`   (${le.shopId})   .`),A(),i(!1)):S("     .")}catch(W){const Y=(W==null?void 0:W.message)||"     ";S(Y)}finally{b(!1)}};return f.jsxs("div",{className:"container mx-auto p-4",children:[f.jsxs(wd,{children:[f.jsx(_d,{children:f.jsx(bd,{children:"  (CPanel)"})}),f.jsxs(Ed,{children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{children:f.jsx("p",{className:"text-sm text-muted-foreground",children:"           ."})}),f.jsxs("div",{className:"flex gap-2",children:[!N&&((L=r==null?void 0:r.branchPackage)==null?void 0:L.status)!=="pending"&&f.jsx(wt,{onClick:()=>a(!0),variant:"outline",children:"  "}),((O=r==null?void 0:r.branchPackage)==null?void 0:O.status)==="pending"&&f.jsx(wt,{disabled:!0,variant:"outline",className:"text-yellow-600 border-yellow-200 bg-yellow-50",children:"  "}),f.jsx(wt,{onClick:()=>i(!0),disabled:!1,children:" "})]})]}),!t&&f.jsx("p",{className:"mt-3 text-sm text-red-600",children:"      ."}),N&&f.jsxs("p",{className:"mt-3 text-sm text-green-600 font-medium",children:["  :  ",P,"   ",I," ."]}),t&&!1]})]}),f.jsx(Ba,{open:s,onOpenChange:i,children:f.jsxs(xo,{children:[f.jsx(rl,{children:f.jsx(sl,{children:"  "})}),f.jsxs("div",{className:"grid gap-4 py-2",children:[f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{htmlFor:"shopName",children:" "}),f.jsx(ar,{id:"shopName",value:l,onChange:X=>c(X.target.value),placeholder:":  "})]}),f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{htmlFor:"managerName",children:" "}),f.jsx(ar,{id:"managerName",value:u,onChange:X=>h(X.target.value),placeholder:":  "})]}),f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{htmlFor:"email",children:""}),f.jsx(ar,{id:"email",type:"email",value:m,onChange:X=>p(X.target.value),placeholder:"example@mail.com"})]}),f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{htmlFor:"password",children:""}),f.jsx(ar,{id:"password",type:"password",value:v,onChange:X=>g(X.target.value),onKeyDown:X=>{X.key==="Enter"&&(X.preventDefault(),R())},placeholder:""})]}),_&&f.jsx("p",{className:"text-sm text-muted-foreground",children:_})]}),f.jsxs(Mv,{children:[f.jsx(wt,{variant:"outline",onClick:()=>i(!1),disabled:E,children:""}),f.jsx(wt,{onClick:R,disabled:E||!1,children:E?" ...":" "})]})]})}),f.jsx(sj,{open:o,onOpenChange:a})]})}const SP=()=>{const[t,e]=y.useState(""),[n,r]=y.useState(""),[s,i]=y.useState(!1),[o,a]=y.useState(!1),{signIn:l}=Zs(),c=io();y.useEffect(()=>{try{const h=typeof window<"u"?window.localStorage.getItem("cashy:lastEmail"):null;h&&e(h)}catch{}},[]);const u=async h=>{var m;if(h.preventDefault(),o){kt.info("     ...");return}if(typeof navigator<"u"&&navigator.onLine===!1){kt.error("   .      .");return}if(!t||!n){kt.error("     ");return}a(!0);try{const{error:p}=await l(t,n);if(p){const v=p==null?void 0:p.code;v==="auth/invalid-email"?kt.error("    "):v==="auth/user-not-found"?kt.error("     "):v==="auth/wrong-password"?kt.error("   "):v==="auth/invalid-credential"?kt.error("      "):v==="auth/too-many-requests"?kt.error("      "):kt.error((p==null?void 0:p.message)||"    ");return}try{const v=(m=qt.currentUser)==null?void 0:m.uid;v&&await rn(ye(F,"users",v),{branchPackage:{requested:!0,status:"pending",requestedAt:Be()},updatedAt:Be()},{merge:!0})}catch(v){console.warn("    :",v)}kt.success("   "),c("/cpanel")}catch(p){kt.error((p==null?void 0:p.message)||"     ")}finally{a(!1)}};return f.jsx("div",{className:"min-h-screen bg-background px-4 py-8 flex items-center justify-center",children:f.jsxs(wd,{className:"w-full max-w-md",children:[f.jsxs(_d,{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(mE,{className:"w-6 h-6"}),f.jsx(bd,{children:"   "})]}),f.jsx(jv,{children:"     "})]}),f.jsx(Ed,{children:f.jsxs("form",{onSubmit:u,className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"email",children:" "}),f.jsxs("div",{className:"relative",children:[f.jsx(s0,{className:"absolute right-3 top-2.5 w-5 h-5 text-muted-foreground"}),f.jsx(ar,{id:"email",type:"email",value:t,onChange:h=>{const m=h.target.value;e(m);try{window.localStorage.setItem("cashy:lastEmail",m)}catch{}},placeholder:"example@mail.com",className:"pr-10"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"password",children:" "}),f.jsxs("div",{className:"relative",children:[f.jsx(Uy,{className:"absolute right-3 top-2.5 w-5 h-5 text-muted-foreground"}),f.jsx(ar,{id:"password",type:s?"text":"password",value:n,onChange:h=>r(h.target.value),placeholder:"",className:"pr-10"}),f.jsx("button",{type:"button",onClick:()=>i(h=>!h),className:"absolute left-3 top-2.5 text-muted-foreground","aria-label":s?"  ":"  ",children:s?f.jsx(jh,{className:"w-5 h-5"}):f.jsx(Fh,{className:"w-5 h-5"})})]})]}),f.jsx("button",{type:"submit",onClick:h=>{o?(h.preventDefault(),h.stopPropagation(),kt.info("     ...")):typeof navigator<"u"&&navigator.onLine===!1?(h.preventDefault(),h.stopPropagation(),kt.error("   .      .")):(t||kt.error("   "),n||kt.error("   "))},className:"w-full inline-flex items-center justify-center gap-2 rounded-md bg-primary px-4 py-2 text-white hover:opacity-90",children:o?f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white ml-2"}),"  ..."]}):f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx(mk,{className:"w-5 h-5 ml-2"})," "]})}),f.jsxs("div",{className:"mt-4 text-center space-y-3",children:[f.jsx("p",{className:"text-sm text-muted-foreground",children:"  "}),f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx(y0,{to:"/user/forgot-password",className:"text-primary text-sm",children:"   "}),f.jsx("span",{className:"text-muted-foreground",children:""}),f.jsx(y0,{to:"/auth?mode=signup",className:"text-primary text-sm",children:"  "})]})]})]})})]})})},IP=()=>{const[t,e]=y.useState(null),n=io();y.useEffect(()=>{const s=qt.onAuthStateChanged(i=>{e(i)});return()=>s()},[]);const r=async()=>{try{await qt.signOut(),n("/sms-portal/login")}catch(s){console.error("Logout error",s)}};return f.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 font-cairo",dir:"rtl",children:[f.jsxs("div",{className:"max-w-md mx-auto min-h-screen shadow-lg bg-white dark:bg-slate-950 border-x border-slate-200 dark:border-slate-800",children:[f.jsxs("header",{className:"p-4 border-b bg-primary text-primary-foreground flex justify-between items-center sticky top-0 z-10",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"font-bold text-lg",children:" "}),f.jsx("div",{className:"text-[10px] opacity-80 font-mono",children:"SMS Portal v1.0"})]}),t&&f.jsxs(wt,{variant:"ghost",size:"sm",onClick:r,className:"text-primary-foreground hover:bg-primary-foreground/10 hover:text-white",children:[f.jsx(r0,{className:"h-4 w-4 ml-2"}),""]})]}),f.jsx("main",{className:"p-4",children:f.jsx(fz,{})})]}),f.jsx(Ck,{position:"top-center"})]})},pp=()=>{const[t,e]=y.useState(""),[n,r]=y.useState(""),[s,i]=y.useState(!1),o=io(),a=async l=>{if(l.preventDefault(),!t||!n){kt.error("     ");return}try{i(!0),await w2(qt,t,n),kt.success("   "),o("/sms-portal/dashboard")}catch(c){console.error("Login error:",c);let u="  ";(c.code==="auth/invalid-credential"||c.code==="auth/user-not-found"||c.code==="auth/wrong-password")&&(u="      "),kt.error(u)}finally{i(!1)}};return f.jsx("div",{className:"flex items-center justify-center min-h-[80vh]",children:f.jsxs(wd,{className:"w-full max-w-sm border-none shadow-none",children:[f.jsxs(_d,{className:"text-center",children:[f.jsx("div",{className:"mx-auto bg-primary/10 p-4 rounded-full mb-4 w-fit",children:f.jsx(e5,{className:"h-8 w-8 text-primary"})}),f.jsx(bd,{className:"text-2xl",children:" "}),f.jsx(jv,{children:"     Cashy      "})]}),f.jsx(Ed,{children:f.jsxs("form",{onSubmit:a,className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"email",children:" "}),f.jsx(ar,{id:"email",type:"email",placeholder:"example@cashy.com",value:t,onChange:l=>e(l.target.value),disabled:s,className:"text-left",dir:"ltr"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"password",children:" "}),f.jsx(ar,{id:"password",type:"password",value:n,onChange:l=>r(l.target.value),disabled:s,className:"text-left",dir:"ltr"})]}),f.jsx(wt,{type:"submit",className:"w-full",disabled:s,children:s?f.jsx(hE,{className:"ml-2 h-4 w-4 animate-spin"}):""})]})})]})})},ij=y.forwardRef(({className:t,...e},n)=>f.jsx("textarea",{className:yn("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));ij.displayName="Textarea";const mee=Fy("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function TP({className:t,variant:e,...n}){return f.jsx("div",{className:yn(mee({variant:e}),t),...n})}const gI=t=>{if(!t)return"";let e=t.replace(/[^\d+]/g,"");return e.startsWith("0020")?e=e.substring(4):e.startsWith("+20")?e=e.substring(3):e.startsWith("20")&&e.length>10&&(e=e.substring(2)),e.length===10&&(e.startsWith("10")||e.startsWith("11")||e.startsWith("12")||e.startsWith("15"))&&(e="0"+e),e},pee=t=>{if(!t.includes("Received EGP")||!t.includes("Available Balance"))return null;const e=t.replace(/\n/g," ").trim(),n=/Received\s+EGP\s*(\d+(?:\.\d+)?)/i,r=/from\s+(\d{10,15})/i,s=/Ref:\s*(\d+)/i,i=/Available Balance:\s*(\d+(?:\.\d+)?)/i,o=/^(.+?):\s*Received/i,a=e.match(n),l=e.match(r),c=e.match(s),u=e.match(i),h=e.match(o);return a?{amount:parseFloat(a[1]),sender:l?gI(l[1]):void 0,senderName:void 0,reference:c?c[1]:void 0,type:"receive",originalText:t,balance:u?parseFloat(u[1]):void 0,date:h?h[1].trim():void 0}:null},Cu=t=>{const e=String(t||""),n=e.replace(/\n/g," ").replace(/\s+/g," ").trim(),r=pee(e);if(r)return r;let s="receive";if(/(?:\s*|\s*|sent|transferred|\s*|\s*|\s*)/i.test(n)){const T=/(?:\s*|from|(?:\s*)?)/i.test(n),N=/(?:|to|||)/i.test(n);T&&!N?s="receive":s="transfer"}else(/InstaPay/i.test(n)||/Received\s*EGP/i.test(n)||/You\s*have\s*received/i.test(n)||/\s*/i.test(n))&&(s="receive");let i=0;const o=/(?:|amount)\s+(\d+(?:\.\d+)?)/i,a=n.match(o);if(a)i=parseFloat(a[1]);else{const T=n.match(/(?:\s*|\s*?\s*|?\s*|\s*|received|transfer)\s*(?:of)?\s*(?:EGP)?\s*([0-9.,]+)/i);T&&(i=parseFloat(String(T[1]).replace(/,/g,"")))}let l;if(s==="transfer"){const T=/(?:|\s*||to)\s*[:\-\s]*([\+\d]{10,14})/i,N=n.match(T);N&&(l=N[1])}else{const T=/(?:\s*|from\s*number|from||)\s*[:\-\s]*([\+\d]{10,14})/i,N=n.match(T);N&&(l=N[1])}l&&(l=gI(l));let c;const u=/(?:\s*(?:|)|\s*(?:|)|(?:|)|(?:\s*)?|)\s*[:\-\s]*([^\n:]+?)(?=\s*(?:||||transaction|ref|reference|||\.|$))/i,h=n.match(u);if(h)c=h[1].trim();else{const T=n.match(/(?:registered\s*(?:name|as)|from|sender|name)\s*[:\-]?\s*([A-Za-z][A-Za-z\s]+?)(?=\s*(?:balance|mobile|number|account|ref|transaction|$))/i);if(!c&&/InstaPay/i.test(n)){const N=n.match(/from\s+([A-Za-z\s]+?)(?=\s*(?:balance|account|ref|transaction|$))/i);N&&(c=N[1].trim())}if(!c&&/e&\s*money/i.test(n)){const N=n.match(/from\s+([A-Za-z\s]+?)\s+[0-9+]/i);N&&(c=N[1].trim())}!c&&T&&(c=T[1].trim())}let m;const p=/(?:\s*|transaction\s*id)\s+(\d+)/i,v=n.match(p);if(v)m=v[1];else{const T=n.match(/(?:Ref|Reference||[]|transaction\s*id|\s*(?:[]|[]||))\s*[:\-\s]*([0-9A-Za-z\-]+)/i),N=T?null:n.match(/\b([A-Za-z0-9\-]{10,})\b/g);m=T?T[1]:N?N[N.length-1]:void 0}let g;const E=/(?:\s*|current\s*balance)\s+(\d+(?:\.\d+)?)/i,b=n.match(E);b&&(g=parseFloat(b[1]));let _;const S=/(?:\s*|transaction\s*date)\s+([0-9\-:\s]+)/i,P=n.match(S);return P&&(_=P[1].trim()),{amount:i,sender:l,senderName:c,reference:m,type:s,originalText:e,balance:g,date:_}},gee=Object.freeze(Object.defineProperty({__proto__:null,normalizeMsisdnEgypt:gI,parseSms:Cu},Symbol.toStringTag,{value:"Module"})),xP=()=>{const[t,e]=y.useState(""),[n,r]=y.useState(null),[s,i]=y.useState([]),[o,a]=y.useState(!1),[l,c]=y.useState(null);y.useEffect(()=>{const v=qt.onAuthStateChanged(g=>{if(c(g),g){const E=Ye(xe(F,"pendingSmsPopups"),Oe("userId","==",g.uid),Gs("createdAt","desc"),di(10)),b=Vo(E,_=>{const S=_.docs.map(P=>({id:P.id,...P.data()}));i(S)});return()=>b()}});return()=>v()},[]);const u=()=>{if(!t.trim())return;const v=Cu(t);r(v),v.amount>0?kt.success("   ",{description:`${v.amount} .  ${v.sender||""}`}):kt.warning("       ")},h=async()=>{if(!(!n||!l))try{a(!0),await mr.saveUserTransaction(l.uid,{amount:n.amount,senderMsisdn:n.sender,senderName:n.senderName,reference:n.reference,type:n.type==="transfer"?"send":"receive",note:`SMS Parsing: ${n.type}`,originalSms:n.originalText,createdAt:new Date().toISOString(),status:"completed"}),kt.success("   "),e(""),r(null)}catch(v){console.error("Save error:",v),kt.error("  : "+v.message)}finally{a(!1)}},m=v=>{e(v.body||v.text||"");const g=Cu(v.body||v.text||"");r(g)},p=async(v,g)=>{if(g.stopPropagation(),!!confirm("      "))try{await Hn(ye(F,"pendingSmsPopups",v)),kt.success(" ")}catch{kt.error(" ")}};return l?f.jsxs("div",{className:"space-y-6",children:[s.length>0&&f.jsxs(wd,{children:[f.jsx(_d,{className:"pb-3",children:f.jsxs(bd,{className:"text-lg flex items-center gap-2",children:[f.jsx(gk,{className:"h-5 w-5 text-blue-500"}),"    (",s.length,")"]})}),f.jsx(Ed,{className:"space-y-2 max-h-60 overflow-y-auto",children:s.map(v=>{var g;return f.jsxs("div",{className:"p-3 border rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer transition-colors flex justify-between items-start group",onClick:()=>m(v),children:[f.jsxs("div",{className:"text-sm",children:[f.jsx("div",{className:"font-semibold mb-1",children:v.sender||""}),f.jsx("div",{className:"text-muted-foreground line-clamp-2",children:v.body||v.text}),f.jsx("div",{className:"text-xs text-muted-foreground mt-1 opacity-70",children:(g=v.createdAt)!=null&&g.toDate?v.createdAt.toDate().toLocaleString("ar-EG"):""})]}),f.jsx(wt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",onClick:E=>p(v.id,E),children:f.jsx(yk,{className:"h-4 w-4"})})]},v.id)})})]}),f.jsxs(wd,{children:[f.jsxs(_d,{children:[f.jsx(bd,{children:" "}),f.jsx(jv,{children:"      "})]}),f.jsxs(Ed,{className:"space-y-4",children:[f.jsx(ij,{placeholder:":    1000   ...",className:"min-h-[100px]",value:t,onChange:v=>e(v.target.value)}),f.jsx("div",{className:"flex justify-end",children:f.jsxs(wt,{onClick:u,disabled:!t.trim(),children:[f.jsx(c5,{className:"mr-2 h-4 w-4"})," "]})}),n&&f.jsx("div",{className:"mt-6 p-4 bg-slate-50 dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-800 space-y-4",children:f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx(vr,{className:"text-xs text-muted-foreground",children:""}),f.jsxs("div",{className:"text-xl font-bold text-green-600",children:[n.amount," ."]})]}),f.jsxs("div",{children:[f.jsx(vr,{className:"text-xs text-muted-foreground",children:""}),f.jsx("div",{children:n.type==="transfer"?f.jsx(TP,{variant:"outline",className:"bg-orange-100 text-orange-800 border-orange-200",children:" ()"}):f.jsx(TP,{variant:"outline",className:"bg-green-100 text-green-800 border-green-200",children:" ()"})})]}),f.jsxs("div",{children:[f.jsx(vr,{className:"text-xs text-muted-foreground",children:" / "}),f.jsx("div",{className:"font-mono dir-ltr text-right",children:n.sender||"-"})]}),f.jsxs("div",{children:[f.jsx(vr,{className:"text-xs text-muted-foreground",children:""}),f.jsx("div",{children:n.senderName||"-"})]}),n.reference&&f.jsxs("div",{className:"col-span-2",children:[f.jsx(vr,{className:"text-xs text-muted-foreground",children:" (Reference)"}),f.jsx("div",{className:"font-mono text-xs",children:n.reference})]})]})})]}),f.jsxs(rj,{className:"justify-between border-t p-4 bg-slate-50/50 dark:bg-slate-900/50",children:[f.jsx(wt,{variant:"ghost",onClick:()=>{e(""),r(null)},children:""}),f.jsxs(wt,{onClick:h,disabled:!n||n.amount<=0||o,className:"bg-green-600 hover:bg-green-700 text-white",children:[o?f.jsx(hE,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(O3,{className:"mr-2 h-4 w-4"})," "]})]})]})]}):f.jsx("div",{className:"p-8 text-center",children:" ..."})};function yee({size:t=24,className:e,...n}){return f.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,...n,children:[f.jsx("rect",{x:"5",y:"2.5",width:"14",height:"19",rx:"2.5",stroke:"currentColor",strokeWidth:"1.5"}),f.jsx("rect",{x:"7",y:"4.5",width:"10",height:"5.5",rx:"1",stroke:"currentColor",strokeWidth:"1.2"}),f.jsx("path",{d:"M9.5 11.5h5",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round"}),f.jsx("circle",{cx:"8.5",cy:"14",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("circle",{cx:"12",cy:"14",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("circle",{cx:"15.5",cy:"14",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("circle",{cx:"8.5",cy:"17",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("circle",{cx:"12",cy:"17",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("circle",{cx:"15.5",cy:"17",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("rect",{x:"8",y:"19",width:"9",height:"1.8",rx:"0.6",stroke:"currentColor",strokeWidth:"1"})]})}const AP=t=>{try{const e=t||"default",n=localStorage.getItem(`hiddenQuickActions_${e}`)??localStorage.getItem("hiddenQuickActions"),r=n?JSON.parse(n):[];return Array.isArray(r)?r.filter(s=>typeof s=="string"):[]}catch{return[]}},vee=()=>{const t=io(),e=Ii(),{signOut:n,user:r,userSubscription:s}=Zs(),{toast:i}=ll(),[o,a]=y.useState(!1),[l,c]=y.useState(!1),[u,h]=y.useState(()=>AP(r==null?void 0:r.uid)),[m,p]=y.useState(0);V.useEffect(()=>{const T=I=>{p(I.detail.count)};window.addEventListener("support-chat-unread",T);const N=localStorage.getItem("support_chat_unread_count");return N&&p(parseInt(N,10)),()=>window.removeEventListener("support-chat-unread",T)},[]),V.useEffect(()=>{h(AP(r==null?void 0:r.uid))},[r==null?void 0:r.uid]);const v=(T,N,I={},A={})=>{if(e.pathname.startsWith("/user/dashboard"))window.dispatchEvent(new CustomEvent("dashboard-navigation-action",{detail:{action:T,payload:A}}));else{const R=N?{[N]:!0,...I}:{...I};t("/user/dashboard",{state:R})}},g=[{id:"home",label:"",icon:z3,path:"/user/dashboard",action:()=>{const T=()=>{const N=document.getElementById("dashboard-content-container");N&&(N.scrollTop=0,N.scrollTo(0,0));const I=document.querySelector(".user-dashboard");I&&(I.scrollTop=0,I.scrollTo(0,0)),window.scrollTo(0,0),document.body.scrollTop=0,document.documentElement.scrollTop=0};e.pathname==="/user/dashboard"?(e.state&&Object.keys(e.state).length>0&&t("/user/dashboard",{replace:!0,state:{}}),T()):t("/user/dashboard"),setTimeout(T,10),setTimeout(T,50),setTimeout(T,150),setTimeout(T,300)}},{id:"debts",label:"",icon:$3,path:"/debts",action:()=>{var T;(T=e.state)!=null&&T.openDebtDialog||v("debts","openDebtDialog")}},{id:"transfer",label:"",icon:A3,path:"/transfer",action:()=>{v("transaction-section","openTransactionSection",{transactionType:"transfer",startNewTransaction:!0},{transactionType:"transfer",startNewTransaction:!0,skipAnimation:!0})}},{id:"add",label:"",icon:lx,path:"/add",isSpecial:!0},{id:"withdraw",label:"",icon:I3,path:"/withdraw",action:()=>{v("transaction-section","openTransactionSection",{transactionType:"withdraw",startNewTransaction:!0},{transactionType:"withdraw",startNewTransaction:!0,skipAnimation:!0})}},{id:"support",label:"",icon:Hc,path:"#",action:()=>{window.dispatchEvent(new CustomEvent("open-support-chat"))}},{id:"settings",label:"",icon:ux,path:"/user/dashboard",action:()=>{v("profile-settings","openProfileSettings")}}],b=[{id:"lines",label:"",icon:gk,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openSimCardsDialog)&&v("lines","openSimCardsDialog")},color:"#9333ea"},{id:"installment",label:"",icon:R3,action:()=>{var N,I;a(!1);const T=(N=s==null?void 0:s.subscription)==null?void 0:N.planType;if(T===Ll.TAHWEELA||T===Ll.ZERO){i({title:"  ",description:"      .",variant:"destructive"});return}(I=e.state)!=null&&I.openInstallment||v("installment","openInstallment")},color:"#7C3AED"},{id:"maintenance",label:"",icon:x5,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openMaintenanceDialog)&&v("maintenance","openMaintenanceDialog")},color:"#0EA5E9"},{id:"machine",label:"",icon:yee,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openMachineDailyDialog)&&v("machine-daily","openMachineDailyDialog")},color:"#F59E0B"},{id:"atm-withdraw",label:" ATM",icon:K3,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openAtmWithdrawDialog)&&v("atm-withdraw","openAtmWithdrawDialog")},color:"#10B981"},{id:"pending-operations",label:" ",icon:ax,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openPendingOperationsDialog)&&v("pending-operations","openPendingOperationsDialog")},color:"#ea580c"},{id:"credit-cards",label:" ",icon:V3,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openCreditCardsDialog)&&v("credit-cards","openCreditCardsDialog")},color:"#8B5CF6"},{id:"sales",label:"",icon:b5,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openSalesDialog)&&v("sales","openSalesDialog")},color:"#F59E0B"},{id:"shop-expenses",label:" ",icon:cx,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openShopExpensesDialog)&&v("shop-expenses","openShopExpensesDialog")},color:"#F97316"},{id:"deficiencies",label:"",icon:vk,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openDeficienciesDialog)&&v("deficiencies","openDeficienciesDialog")},color:"#DB2777"},{id:"branch-management",label:" ",icon:v5,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openBranchManagement)&&v("branch-management","openBranchManagement")},color:"#14b8a6"},{id:"my-client-numbers",label:"",icon:s5,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openMyClientNumbersDialog)&&v("my-client-numbers","openMyClientNumbersDialog")},color:"#22C55E"},{id:"add-wallet",label:" ",icon:lx,action:()=>{a(!1),e.pathname!=="/user/add-wallet"&&t("/user/add-wallet")},color:"#EF4444"},{id:"cashier-shift",label:" ",icon:ax,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openCashierShiftModal)&&v("cashier-shift","openCashierShiftModal")},color:"#3B82F6"},{id:"logout",label:" ",icon:r0,action:async()=>{a(!1);try{await n()}catch(T){console.error("Logout error:",T)}},color:"#EF4444"}].filter(T=>!u.includes(T.id)),_=[{id:"shop-expenses-settings",label:" ",icon:cx,action:()=>{var T;c(!1),!((T=e.state)!=null&&T.openShopExpensesDialog)&&t("/user/dashboard",{state:{openShopExpensesDialog:!0}})},color:"#F97316"},{id:"profile-settings",label:"  ",icon:ux,action:()=>{c(!1),e.pathname.startsWith("/user/dashboard")?window.dispatchEvent(new CustomEvent("dashboard-navigation-action",{detail:{action:"profile-settings"}})):t("/user/dashboard",{state:{openProfileSettings:!0}})},color:"#6366F1"},{id:"logout",label:" ",icon:r0,action:async()=>{c(!1);try{await n()}catch(T){console.error("Logout error:",T)}},color:"#EF4444"}],S=(T,N,I,A)=>{var O;const k=((O=s==null?void 0:s.subscription)==null?void 0:O.planType)===Ll.TAHWEELA,C=X=>["/user/dashboard","/profile-settings"].includes(X),L=X=>X==="debts";if(I){if(k&&!L(A)&&!C(T)){i({title:"  ",description:"      .",variant:"destructive"});return}I()}else if(N&&T==="/add"){if(k){i({title:"  ",description:"      .",variant:"destructive"});return}a(!o)}else if(!N){if(k&&!C(T)){i({title:"  ",description:"      .",variant:"destructive"});return}if(e.pathname===T&&!I)return;t(T)}},P=T=>e.pathname===T;return f.jsxs("div",{className:"mobile-bottom-nav",children:[o&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"quick-actions-overlay",onClick:()=>a(!1)}),f.jsx("div",{className:"quick-actions-bottomsheet",children:f.jsx("div",{className:"quick-actions-grid",children:b.map((T,N)=>f.jsxs("button",{type:"button",className:"quick-action-tile",onClick:()=>{var A;if(((A=s==null?void 0:s.subscription)==null?void 0:A.planType)===Ll.TAHWEELA){i({title:"  ",description:"      .",variant:"destructive"});return}a(!1),T.action()},style:{"--action-color":T.color,"--animation-delay":"0s"},children:[f.jsx("div",{className:"quick-action-icon",children:f.jsx(T.icon,{className:"action-icon"})}),f.jsx("span",{className:"quick-action-label",children:T.label})]},T.id))})})]}),l&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"quick-actions-overlay",onClick:()=>c(!1)}),f.jsx("div",{className:"quick-actions-bottomsheet",children:f.jsx("div",{className:"quick-actions-grid",children:_.map((T,N)=>f.jsxs("button",{type:"button",className:"quick-action-tile",onClick:()=>{var R;const I=(R=s==null?void 0:s.subscription)==null?void 0:R.planType,A=new Set(["logout","profile-settings"]);if(I===Ll.TAHWEELA&&!A.has(T.id)){i({title:"  ",description:"      .",variant:"destructive"});return}c(!1),T.action()},style:{"--action-color":T.color,"--animation-delay":`${N*.06}s`},children:[f.jsx("div",{className:"quick-action-icon",children:f.jsx(T.icon,{className:"action-icon"})}),f.jsx("span",{className:"quick-action-label",children:T.label})]},T.id))})})]}),f.jsx("nav",{className:"mobile-bottom-nav-container",children:g.map(T=>{const N=T.icon,I=P(T.path);return f.jsxs("button",{onClick:()=>S(T.path,T.isSpecial,T.action,T.id),className:`mobile-nav-item ${I?"active":""} ${T.isSpecial?"special":""}`,type:"button","aria-label":T.label,style:{backgroundColor:"transparent"},children:[f.jsxs("div",{className:`nav-icon-container relative ${T.isSpecial?"special-icon":""} ${T.isSpecial&&T.id==="add"&&o?"special-open":""}`,children:[f.jsx(N,{className:`nav-icon ${I?"active-icon":""} ${T.isSpecial?"special-icon-svg":""} ${T.isSpecial&&T.id==="settings"&&l?"rotated":""}`}),T.id==="support"&&m>0&&f.jsx("span",{className:"absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white shadow-sm ring-1 ring-white",children:m>99?"99+":m})]}),!T.isSpecial&&f.jsx("span",{className:`nav-label ${I?"active-label":""}`,children:T.label})]},T.id)})})]})};var pR,gR;const uu=(gR=(pR=import.meta)==null?void 0:pR.env)==null?void 0:gR.VITE_ANDROID_DOWNLOAD_URL;var yR,vR;const du=(vR=(yR=import.meta)==null?void 0:yR.env)==null?void 0:vR.VITE_PC_DOWNLOAD_URL;var wR,_R;const hu=(_R=(wR=import.meta)==null?void 0:wR.env)==null?void 0:_R.VITE_PC32_DOWNLOAD_URL;var bR,ER;const fu=(ER=(bR=import.meta)==null?void 0:bR.env)==null?void 0:ER.VITE_ANDROID_VERSION;var SR,IR;const mu=(IR=(SR=import.meta)==null?void 0:SR.env)==null?void 0:IR.VITE_PC_VERSION;var TR,xR;const pu=(xR=(TR=import.meta)==null?void 0:TR.env)==null?void 0:xR.VITE_PC32_VERSION;function Ar(t){if(t)try{const n=(t.split("?")[0].split("#")[0].split("/").pop()||"").match(/v?(\d+\.\d+(?:\.\d+)?)/i);return n==null?void 0:n[1]}catch{return}}const PP=["siteContent","sms_agent_updates"];async function wee(t,e){const n={};Object.entries(t||{}).forEach(([s,i])=>{i!==void 0&&(n[s]=i)});const r={...n,updatedAt:Be(),updatedBy:e||"admin"};await rn(ye(F,PP[0],PP[1]),r,{merge:!0})}function _ee(t){if(t&&Jp(t)!==void 0)try{const e=t.match(/drive\.google\.com\/file\/d\/([^/]+)\//),n=t.match(/drive\.google\.com\/open\?id=([^&]+)/),r=(e==null?void 0:e[1])||(n==null?void 0:n[1]);return r?`https://drive.google.com/uc?export=download&id=${r}`:(/drive\.google\.com\/uc\?/.test(t),t)}catch{return t}}const Sd=["siteContent","appDownloads"],fy=["siteContent","desktop_updates"],my=["siteContent","android_updates"],Hs="appDownloadsCache",bee=6*60*60*1e3,Eee=["1LMXQdSVB3-gIW-89fwWoq113IIEelhxR"];function Jp(t){if(t){for(const e of Eee)if(t.includes(e))return;return t}}function Vl(t){return{...t,androidUrl:Jp(t.androidUrl),pcUrl:Jp(t.pcUrl),pc32Url:Jp(t.pc32Url)}}function See(){try{const e=localStorage.getItem(Hs);if(e){const n=JSON.parse(e),r={androidUrl:(n==null?void 0:n.androidUrl)||uu,pcUrl:(n==null?void 0:n.pcUrl)||du,pc32Url:(n==null?void 0:n.pc32Url)||hu,androidVersion:(n==null?void 0:n.androidVersion)||fu,pcVersion:(n==null?void 0:n.pcVersion)||mu,pc32Version:(n==null?void 0:n.pc32Version)||pu,updatedAt:n==null?void 0:n.updatedAt,updatedBy:n==null?void 0:n.updatedBy};return r.pcVersion||(r.pcVersion=Ar(r.pcUrl)),r.androidVersion||(r.androidVersion=Ar(r.androidUrl)),r.pc32Version||(r.pc32Version=Ar(r.pc32Url)),Vl(r)}}catch{}const t={androidUrl:uu,pcUrl:du,pc32Url:hu,androidVersion:fu,pcVersion:mu,pc32Version:pu};return t.pcVersion||(t.pcVersion=Ar(t.pcUrl)),t.androidVersion||(t.androidVersion=Ar(t.androidUrl)),t.pc32Version||(t.pc32Version=Ar(t.pc32Url)),Vl(t)}async function oj(t=!1){try{if(!t)try{const r=localStorage.getItem(Hs),s=localStorage.getItem(Hs+"_ts");if(r&&s&&Date.now()-Number(s)<bee){const o=JSON.parse(r);return Vl(o)}}catch{}const e=await Sn(ye(F,Sd[0],Sd[1]));if(e.exists()){const r=e.data();try{localStorage.setItem(Hs,JSON.stringify(r)),localStorage.setItem(Hs+"_ts",String(Date.now()))}catch{}const s={androidUrl:(r==null?void 0:r.androidUrl)||uu,pcUrl:(r==null?void 0:r.pcUrl)||du,pc32Url:(r==null?void 0:r.pc32Url)||hu,androidVersion:(r==null?void 0:r.androidVersion)||fu,pcVersion:(r==null?void 0:r.pcVersion)||mu,pc32Version:(r==null?void 0:r.pc32Version)||pu,updatedAt:r==null?void 0:r.updatedAt,updatedBy:r==null?void 0:r.updatedBy};return s.pcVersion||(s.pcVersion=Ar(s.pcUrl)),s.androidVersion||(s.androidVersion=Ar(s.androidUrl)),s.pc32Version||(s.pc32Version=Ar(s.pc32Url)),Vl(s)}const n={androidUrl:uu,pcUrl:du,pc32Url:hu,androidVersion:fu,pcVersion:mu,pc32Version:pu};return n.pcVersion||(n.pcVersion=Ar(n.pcUrl)),n.androidVersion||(n.androidVersion=Ar(n.androidUrl)),n.pc32Version||(n.pc32Version=Ar(n.pc32Url)),Vl(n)}catch(e){const n=(e==null?void 0:e.message)||"";((e==null?void 0:e.code)||"")==="permission-denied"||n.includes("Missing or insufficient permissions")?console.warn(" Cannot read app downloads (unauth/public). Using cached or empty.",e):console.error(" Error loading app downloads:",e);try{const i=localStorage.getItem(Hs);if(i){const o=JSON.parse(i),a={androidUrl:(o==null?void 0:o.androidUrl)||uu,pcUrl:(o==null?void 0:o.pcUrl)||du,pc32Url:(o==null?void 0:o.pc32Url)||hu,androidVersion:(o==null?void 0:o.androidVersion)||fu,pcVersion:(o==null?void 0:o.pcVersion)||mu,pc32Version:(o==null?void 0:o.pc32Version)||pu,updatedAt:o==null?void 0:o.updatedAt,updatedBy:o==null?void 0:o.updatedBy};return a.pcVersion||(a.pcVersion=Ar(a.pcUrl)),a.androidVersion||(a.androidVersion=Ar(a.androidUrl)),a.pc32Version||(a.pc32Version=Ar(a.pc32Url)),Vl(a)}}catch{}const s={androidUrl:uu,pcUrl:du,pc32Url:hu,androidVersion:fu,pcVersion:mu,pc32Version:pu};return s.pcVersion||(s.pcVersion=Ar(s.pcUrl)),s.androidVersion||(s.androidVersion=Ar(s.androidUrl)),s.pc32Version||(s.pc32Version=Ar(s.pc32Url)),Vl(s)}}function Iee(t){return oj().then(t),()=>{}}async function Tee(t,e,n,r,s,i=12e4){const o=sV(),a=t.name.replace(/[^a-zA-Z0-9_.-]/g,"_"),l=`public/apps/${e}/${Date.now()}_${a}`,c=lX(o,l);return new Promise((u,h)=>{const m=oX(c,t);let p=!1;const v=setTimeout(()=>{p=!0;try{m.cancel()}catch{}h(new Error("Upload timed out"))},i);m.on("state_changed",g=>{const E=Math.round(g.bytesTransferred/g.totalBytes*100);s&&s(E)},g=>{clearTimeout(v),h(g)},async()=>{try{if(clearTimeout(v),p)return;const g=await aX(c),E={updatedAt:Be(),updatedBy:n||"admin"};e==="android"?(E.androidUrl=g,r&&(E.androidVersion=r)):e==="pc"?(E.pcUrl=g,r&&(E.pcVersion=r)):(E.pc32Url=g,r&&(E.pc32Version=r));const b=Math.min(Math.max(2e4,Math.floor(i/10)),6e4),_=rn(ye(F,Sd[0],Sd[1]),E,{merge:!0});try{const T=localStorage.getItem(Hs),I={...T?JSON.parse(T):{},...E};localStorage.setItem(Hs,JSON.stringify(I)),localStorage.setItem(Hs+"_ts",String(Date.now()))}catch{}let S=!1;const P=new Promise(T=>setTimeout(()=>{S=!0,T()},b));try{await Promise.race([_,P])}catch(T){console.warn(" Firestore write error, proceeding with URL only:",T)}S&&console.warn(" Firestore update timed out;             ."),u(g)}catch(g){h(g)}})})}async function xee(t,e){const n={};Object.entries(t||{}).forEach(([s,i])=>{i!==void 0&&(n[s]=i)});const r={...n,updatedAt:Be(),updatedBy:e||"admin"};await rn(ye(F,Sd[0],Sd[1]),r,{merge:!0});try{const s=localStorage.getItem(Hs),i=s?JSON.parse(s):{},o={...r,updatedAt:Date.now()},a={...i,...o};localStorage.setItem(Hs,JSON.stringify(a)),localStorage.setItem(Hs+"_ts",String(Date.now()))}catch{}}async function Aee(t,e){const n={};Object.entries(t||{}).forEach(([s,i])=>{i!==void 0&&(n[s]=i)});const r={...n,updatedAt:Be(),updatedBy:e||"admin"};await rn(ye(F,fy[0],fy[1]),r,{merge:!0});try{const s=localStorage.getItem("desktop_update_cache"),i=s?JSON.parse(s):{},o={...r,updatedAt:Date.now()},a={...i,...o};localStorage.setItem("desktop_update_cache",JSON.stringify(a))}catch{}}function aj(t){const e=ye(F,fy[0],fy[1]);return Vo(e,r=>{if(r.exists()){const s=r.data(),i={version:s!=null&&s.version?String(s.version):void 0,downloadURL_64:s!=null&&s.downloadURL_64?String(s.downloadURL_64):void 0,downloadURL_32:s!=null&&s.downloadURL_32?String(s.downloadURL_32):void 0,notes:s!=null&&s.notes?String(s.notes):void 0,force:(s==null?void 0:s.force)===!0||(s==null?void 0:s.force)==="true"};try{localStorage.setItem("desktop_update_cache",JSON.stringify(i))}catch{}t(i)}},r=>{console.warn("Error listening to desktop updates:",r)})}function lj(t){try{const e=(typeof navigator<"u"?navigator.userAgent.toLowerCase():"")||"",n=e.includes("win64")||e.includes("x64")||e.includes("wow64")||e.includes("amd64"),r=e.includes("arm64");return String(n||r?(t==null?void 0:t.downloadURL_64)||(t==null?void 0:t.downloadURL_32)||"":(t==null?void 0:t.downloadURL_32)||(t==null?void 0:t.downloadURL_64)||"")}catch{return(t==null?void 0:t.downloadURL_64)||(t==null?void 0:t.downloadURL_32)}}async function Pee(t,e){const n={};Object.entries(t||{}).forEach(([s,i])=>{i!==void 0&&(n[s]=i)});const r={...n,updatedAt:Be(),updatedBy:e||"admin"};await rn(ye(F,my[0],my[1]),r,{merge:!0});try{const s=localStorage.getItem("android_update_cache"),i=s?JSON.parse(s):{},o={...r,updatedAt:Date.now()},a={...i,...o};localStorage.setItem("android_update_cache",JSON.stringify(a))}catch{}}async function cj(){try{const t=ye(F,my[0],my[1]),e=await Sn(t),n=(e.exists()?e.data():{})||{},r={version:n!=null&&n.version?String(n.version):void 0,url:n!=null&&n.url?String(n.url):void 0,notes:n!=null&&n.notes?String(n.notes):void 0,force:!!(n!=null&&n.force),code:typeof(n==null?void 0:n.code)=="number"?n.code:typeof(n==null?void 0:n.versionCode)=="number"?n.versionCode:void 0};try{localStorage.setItem("android_update_cache",JSON.stringify(r))}catch{}return r}catch(t){console.warn("Error fetching android updates:",t);try{const e=localStorage.getItem("android_update_cache");if(e)return JSON.parse(e)}catch{}return{}}}function Ree(t){return cj().then(t),()=>{}}const Cee=Object.freeze(Object.defineProperty({__proto__:null,fetchAndroidUpdates:cj,getAppDownloads:oj,getCachedOrEnvAppDownloads:See,listenAndroidUpdates:Ree,listenAppDownloads:Iee,listenDesktopUpdates:aj,resolveDownloadUrl:_ee,selectDesktopUrl:lj,setAndroidUpdateInfo:Pee,setAppDownloadLinks:xee,setDesktopUpdateInfo:Aee,setSmsAgentUpdateInfo:wee,uploadAppBinaryResumable:Tee},Symbol.toStringTag,{value:"Module"})),Nee=()=>{const t=typeof window<"u"?window.electronAPI:void 0,e=!!t,[n,r]=V.useState(!1),[s,i]=V.useState(!1),[o,a]=V.useState(!1),[l,c]=V.useState(0),[u,h]=V.useState(""),[m,p]=V.useState(!1),v=async()=>{try{e&&t?await t.windowMinimize():console.info("windowMinimize (dev preview)")}catch(T){console.warn("failed to minimize",T)}},g=async()=>{try{e&&t?await t.windowClose():console.info("windowClose (dev preview)")}catch(T){console.warn("failed to close",T)}},E=async()=>{if(!m){p(!0);try{try{window.dispatchEvent(new CustomEvent("app:softRefresh"))}catch{}if(e&&t&&typeof t.windowReload=="function"){setTimeout(()=>{try{t.windowReload()}catch{}},50),setTimeout(()=>p(!1),600);return}try{window.location.reload()}catch{}}catch(T){console.warn("failed to soft refresh",T),p(!1)}}};if(V.useEffect(()=>{if(!(!e||!t))try{t.onUpdateAvailable(()=>r(!0)),t.onUpdateDownloaded(()=>r(!0)),typeof t.onUpdateError=="function"&&t.onUpdateError(()=>{a(!1)}),typeof t.onUpdateProgress=="function"&&t.onUpdateProgress(T=>{const N=(T==null?void 0:T.percent)==null?0:Number(T.percent);a(!0),c(Math.max(0,Math.min(100,isNaN(N)?0:N)))}),t.checkUpdate()}catch(T){console.warn("update init failed",T)}},[e,t]),V.useEffect(()=>{const T=aj(N=>{if(String((N==null?void 0:N.version)||"")){r(!0);const A=lj({downloadURL_64:N==null?void 0:N.downloadURL_64,downloadURL_32:N==null?void 0:N.downloadURL_32})||"";h(A)}});return()=>{try{T()}catch{}}},[]),!e)return null;const[_,S]=V.useState(!1),P=async()=>{try{if(!t)return;_?(typeof t.windowFullscreen=="function"&&await t.windowFullscreen(),S(!1)):(typeof t.windowWindowed=="function"&&await t.windowWindowed(),S(!0))}catch(T){console.warn("window toggle failed",T)}};return f.jsxs("div",{className:"fixed top-2 right-2 z-[9999] flex flex-col items-center gap-2",style:{pointerEvents:"auto"},children:[f.jsx("button",{type:"button","aria-label":"",title:"",onClick:g,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-red-600 hover:bg-red-500/10 focus:outline-none dark:text-red-400 dark:hover:bg-red-400/10",children:f.jsx(Ui,{className:"w-5 h-5"})}),f.jsx("button",{type:"button","aria-label":"",title:" ",onClick:E,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-blue-600 hover:bg-blue-500/10 focus:outline-none dark:text-blue-400 dark:hover:bg-blue-400/10",children:f.jsx(fE,{className:`w-5 h-5 ${m?"animate-spin":""}`})}),f.jsx("button",{type:"button","aria-label":"",title:"",onClick:v,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-gray-800 hover:bg-black/10 focus:outline-none dark:text-white/80 dark:hover:bg-white/10",children:f.jsx(n5,{className:"w-5 h-5"})}),f.jsx("button",{type:"button","aria-label":"/",title:_?"":" ",onClick:P,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-gray-700 hover:bg-black/10 focus:outline-none dark:text-white/80 dark:hover:bg-white/10",children:f.jsx(g5,{className:"w-5 h-5"})})]})},cb=({className:t=""})=>{var l,c;const n=typeof window<"u"&&window.location&&window.location.protocol==="file:"?"./":`${((c=(l=import.meta)==null?void 0:l.env)==null?void 0:c.BASE_URL)||"/"}`,[r,s]=y.useState(`${n}logo.svg`),[i,o]=y.useState(0),a=y.useCallback(()=>{o(u=>{const h=u+1;return h===1?s(`${n}logo.png`):h===2&&s(`${n}placeholder.svg`),h})},[]);return f.jsxs("div",{className:`min-h-screen bg-background flex items-center justify-center ${t}`,children:[f.jsx("style",{children:`
        @keyframes loaderSpin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `}),f.jsxs("div",{className:"flex flex-col items-center justify-center",children:[f.jsx("img",{src:r,onError:a,alt:"logo",className:"w-32 h-32",style:{filter:"drop-shadow(0 6px 12px rgba(0,0,0,0.15))",animation:"loaderSpin 0.7s linear infinite",willChange:"transform"}}),f.jsx("p",{className:"mt-5 text-2xl font-extrabold tracking-wide text-transparent bg-clip-text",style:{fontFamily:"'Cairo','Tajawal','Noto Sans Arabic',sans-serif",backgroundImage:"var(--gradient-hero)"},children:"  "})]})]})},RP=Hd("SplashScreen",{web:()=>ee(()=>import("./web-D7JDtu5R.js"),[],import.meta.url).then(t=>new t.SplashScreenWeb)});var py;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(py||(py={}));var CP;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(CP||(CP={}));const ta=Hd("StatusBar"),NP=Hd("AppLauncher",{web:()=>ee(()=>import("./web-Dis4q22G.js"),[],import.meta.url).then(t=>new t.AppLauncherWeb)});function kee(t,e){if(!t||!t.trim())throw new Error("USSD code is required");const n=`tel:${t.replace(/#/g,"%23")}`,s=`cashy://ussd?code=${t.replace(/#/g,"%23")}${e?`&sim=${e}`:""}`;let i=!1;try{Te&&Te.getPlatform()!=="web"&&(NP.openUrl({url:s}),i=!0)}catch{}if(!i)try{window.location.href=s,i=!0}catch{}if(!i){try{window.location.href=n}catch{}try{Te&&Te.getPlatform()!=="web"&&NP.openUrl({url:n})}catch{}}}function uj(t,e){const n=String(t||"").replace(/\D/g,""),r=Math.round(Number(e||0));return!n||n.length!==11||!n.startsWith("01")||!r||r<=0?null:n.startsWith("010")?`*9*7*${n}*${r}#`:n.startsWith("011")?`*323*${n}*${r}#`:n.startsWith("012")?`*115*1*${n}*${r}#`:n.startsWith("015")?`*322*${n}*${r}#`:null}function Dee(t,e,n){const r=String(t||"").replace(/\D/g,""),s=String(e||"").replace(/\D/g,""),i=Math.round(Number(n||0));return!s||s.length!==11||!s.startsWith("01")||!i||i<=0?null:!r||!r.startsWith("01")?uj(s,i):r.startsWith("010")?`*9*7*${s}*${i}#`:r.startsWith("011")?`*323*${s}*${i}#`:r.startsWith("012")?`*7115*7*${s}*${i}#`:r.startsWith("015")?`*322*${s}*${i}#`:null}function cne(t,e,n){const r=uj(t,e),s=String(n||"").replace(/\D/g,"");return!r||!s?r:`${r.endsWith("#")?r.slice(0,-1):r}*${s}#`}function Oee(t){const e=String(t||"").replace(/\D/g,"");return e.startsWith("010")?"vodafone":e.startsWith("011")?"etisalat":e.startsWith("012")?"orange":e.startsWith("015")?"we":null}function Lee(t){const e=Oee(t),n=e?`simSlot_${e}`:"simSlot_default";try{if(localStorage.getItem(n)==="sim2")return"sim2"}catch{}return"sim1"}function une(t,e,n){const r=Dee(t,e,n);if(!r)throw new Error("Unsupported network or invalid sender/receiver/amount");const s=Lee(t||e);kee(r,s)}async function Mee(t,e="Cashy"){if(!t||!t.trim())throw new Error("Notification message is required");try{if(typeof Notification<"u"&&(Notification.permission==="granted"?"granted":await Notification.requestPermission())==="granted"){new Notification(e||"Cashy",{body:t});return}typeof window<"u"&&typeof alert=="function"?alert(`${e||"Cashy"}
${t}`):console.log(`[${e||"Cashy"}] ${t}`)}catch(n){console.warn("Notification not available:",n)}}function yI(t,e){return e==="send"?0:Math.round(t*.01)}function Vee(t,e,n=0){const r=yI(t,e),s=Math.max(0,r-n);return Math.round(s)}const Eo=Object.freeze(Object.defineProperty({__proto__:null,calculateCommission:yI,calculateProfit:Vee},Symbol.toStringTag,{value:"Module"})),jee=t=>t==="withdraw"||t==="receive"?"receive":"send",Fee=async t=>{if(!t)return null;const e=Ye(xe(F,"transactions"),Oe("reference","==",t),di(1)),n=await et(e);return n.empty?null:n.docs[0].id},Uee=async t=>{var e;try{const n=await Ml.get({key:"selected_wallet_id"}),r=String((n==null?void 0:n.value)||"").trim();if(r)return r}catch{}return Wee(t||((e=qt.currentUser)==null?void 0:e.uid)||"")||null},s_=async t=>{try{const e=String(t||"").trim();if(!e)return null;const n=await Pa.getByMsisdn(e);return(n==null?void 0:n.id)||null}catch{return null}},dj=async t=>{if(!t||!t.shopId||!t.lineId||!t.provider)throw new Error("   :   shopId  lineId  provider");if(!t.amount||t.amount<=0)throw new Error("     ");const e=await Fee(t.reference);if(e)return{id:e,duplicate:!0};const n=jee(t.type);let r=t.walletId&&String(t.walletId).trim()?String(t.walletId).trim():"";if(!r){let o=await s_(t.receiverMsisdn);if(o||(o=await s_(t.senderMsisdn)),!o){const a=String(t.lineId||"").replace(/\D/g,"");a.length>=10&&(o=await s_(a))}r=o||await Uee(t.createdBy)||""}if(!r)throw new Error("     ");try{const{transactionServiceExtra:o}=await ee(async()=>{const{transactionServiceExtra:m}=await Promise.resolve().then(()=>uo);return{transactionServiceExtra:m}},void 0,import.meta.url),a=await o.getMerchantTransactions(t.createdBy,50),l=Date.now(),c=m=>String(m||"").replace(/\D/g,"").slice(-5),u=c(n==="send"?t.senderMsisdn||t.lineId:t.senderMsisdn),h=String(t.provider||"").toLowerCase();for(const m of a){const p=m!=null&&m.createdAt?new Date(m.createdAt).getTime():0;if(Math.abs(l-p)<=1e4){const v=Number((m==null?void 0:m.amount)||0)===Number(t.amount||0),g=String((m==null?void 0:m.provider)||"").toLowerCase()===h,E=c((m==null?void 0:m.senderMsisdn)||(m==null?void 0:m.receiverMsisdn)||(m==null?void 0:m.senderPhone)||(m==null?void 0:m.receiverPhone));if(v&&g&&E&&u&&E===u)return{id:String((m==null?void 0:m.id)||""),duplicate:!0}}}}catch{}const s={shopId:t.shopId,lineId:t.lineId,merchantUserId:t.merchantUserId||t.createdBy,walletId:r,provider:t.provider,txnType:n,originType:t.type,amount:t.amount,fee:void 0,commission:void 0,profit:0,reference:t.reference,senderMsisdn:t.senderMsisdn,receiverMsisdn:t.receiverMsisdn,note:t.note,status:"confirmed",createdBy:t.createdBy,createdAt:t.createdAt||new Date,confirmedAt:new Date},i=await cI.create(s);if(n==="send")try{const{calculateCommission:o}=await ee(async()=>{const{calculateCommission:b}=await Promise.resolve().then(()=>Eo);return{calculateCommission:b}},void 0,import.meta.url),a=o(t.amount,"send"),l=t.merchantUserId||t.createdBy,c=t.fee||0,u=await mr.getUserData(l),h={...(u==null?void 0:u.walletBalances)||{}},p=Number(h[r]||0)-(t.amount+c);h[r]=p;const v=Number((u==null?void 0:u.cashBalance)||0),g=Math.round(v+t.amount+a);if(await mr.updateUserData(l,{walletBalances:h,cashBalance:g,lastUpdated:new Date().toISOString()}),t.shopId)try{const b=ye(F,"dashboardData",t.shopId);await rn(b,{cashBalance:g,walletBalances:h,lastUpdated:new Date().toISOString()},{merge:!0})}catch(b){console.warn("   dashboardData:",b)}const{walletDailyLimitsService:E}=await ee(async()=>{const{walletDailyLimitsService:b}=await Promise.resolve().then(()=>Uf);return{walletDailyLimitsService:b}},void 0,import.meta.url);await E.updateUsage(r,t.amount,"transfer",!0)}catch(o){console.warn("     :",o)}else try{const{calculateCommission:o}=await ee(async()=>{const{calculateCommission:g}=await Promise.resolve().then(()=>Eo);return{calculateCommission:g}},void 0,import.meta.url),a=o(t.amount,"receive"),l=t.merchantUserId||t.createdBy,c=await mr.getUserData(l),u={...(c==null?void 0:c.walletBalances)||{}},m=Number(u[r]||0)+t.amount;u[r]=m;const p=Number((c==null?void 0:c.cashBalance)||0),v=Math.round(p-t.amount+a);if(await mr.updateUserData(l,{walletBalances:u,cashBalance:v,lastUpdated:new Date().toISOString()}),t.shopId)try{const g=ye(F,"dashboardData",t.shopId);await rn(g,{cashBalance:v,walletBalances:u,lastUpdated:new Date().toISOString()},{merge:!0})}catch(g){console.warn("   dashboardData:",g)}if(t.type==="withdraw"){const{walletDailyLimitsService:g}=await ee(async()=>{const{walletDailyLimitsService:E}=await Promise.resolve().then(()=>Uf);return{walletDailyLimitsService:E}},void 0,import.meta.url);await g.updateUsage(r,t.amount,"withdraw",!0)}}catch(o){console.warn("     /:",o)}try{const o="  ",a=`: ${t.type} | : ${t.amount} | : ${t.provider}`;await Mee(a,o)}catch(o){console.warn("   :",o)}try{const o=t.merchantUserId||t.createdBy;if(o){const a=n==="receive"?"withdraw":"send",l=yI(t.amount,n);await mr.saveUserTransaction(o,{type:a,amount:t.amount,commission:l,status:"completed",createdAt:new Date,senderMsisdn:t.senderMsisdn,receiverMsisdn:t.receiverMsisdn,senderName:t.senderName,walletId:r,lineId:t.lineId,provider:t.provider,note:t.note,transactionId:i})}else console.warn("    :   userId (merchantUserId  createdBy)  .")}catch(o){console.warn("      userTransactions   :",o)}return{id:i,duplicate:!1}},Xp=t=>{try{const e=String(t||"").replace(/[^0-9+]/g,"");if(!e)return"";if(e.startsWith("+20")){const n=e.slice(3);return n.startsWith("1")?"0"+n:n}if(e.startsWith("0020")){const n=e.slice(4);return n.startsWith("1")?"0"+n:n}if(e.startsWith("20")){const n=e.slice(2);return n.startsWith("1")?"0"+n:n}return e.startsWith("0")?e:/^(10|11|12|15)/.test(e)?"0"+e:e}catch{return""}},ub=async(t=[],e)=>{var n;try{try{console.log("identifyWalletBySim  input",t)}catch{}const r=e||((n=qt.currentUser)==null?void 0:n.uid)||"default",s=Array.isArray(t)?t.map(g=>Xp(g)).filter(g=>!!g):[],i=`wallets_${r}`,o=typeof localStorage<"u"?localStorage.getItem(i):null,a=o?JSON.parse(o):[],l=g=>String(g||"").replace(/\D/g,""),c=Array.isArray(a)?a.map(g=>({walletId:String((g==null?void 0:g.id)||""),msisdn:Xp(String((g==null?void 0:g.phone)||(g==null?void 0:g.msisdn)||"")),isDefault:!!(g!=null&&g.isDefault)})).filter(g=>g.walletId&&g.msisdn):[],u=new Map;for(const g of s){const E=l(g);for(const b of c){const _=l(b.msisdn);if(b.msisdn===g){u.set(b.walletId,{msisdn:b.msisdn,isDefault:!!b.isDefault});continue}if(_.slice(-7)===E.slice(-7)){u.set(b.walletId,{msisdn:b.msisdn,isDefault:!!b.isDefault});continue}}}if(u.size>0){const g=Array.from(u.entries()),E=g.find(([S,P])=>P.isDefault),[b,_]=E||g[0];return{walletId:b,msisdn:_.msisdn}}const m=(await Pa.getByMerchantId(r)||[]).map(g=>({walletId:String((g==null?void 0:g.id)||""),msisdn:Xp(String((g==null?void 0:g.msisdn)||"")),isDefault:!!(g!=null&&g.isDefault)})).filter(g=>g.walletId&&g.msisdn),p=[...c,...m],v=new Map;for(const g of s){const E=l(g);for(const b of p){const _=l(b.msisdn);if(b.msisdn===g){v.set(b.walletId,{msisdn:b.msisdn,isDefault:!!b.isDefault});continue}if(_.slice(-7)===E.slice(-7)){v.set(b.walletId,{msisdn:b.msisdn,isDefault:!!b.isDefault});continue}}}try{console.log("identifyWalletBySim  matched size",v.size)}catch{}if(v.size>0){const g=Array.from(v.entries()),E=g.find(([S,P])=>P.isDefault),[b,_]=E||g[0];try{console.log("identifyWalletBySim  selected match",{walletId:b,msisdn:_.msisdn})}catch{}return{walletId:b,msisdn:_.msisdn}}try{console.warn("identifyWalletBySim  no unique match")}catch{}return null}catch{return null}};async function $ee(t,e){try{const n=i=>Xp(String(i||"")),r=(e||[]).map(i=>({walletId:String(i.id||""),msisdn:n(String(i.msisdn||i.phone||"")),isDefault:!!i.isDefault})).filter(i=>i.walletId&&i.msisdn),s=i=>String(i||"").replace(/\D/g,"");for(const i of t||[]){const o=n(i),a=s(o),l=r.filter(u=>u.msisdn===o);if(l.length>0){const h=l.find(m=>m.isDefault)||l[0];return{walletId:h.walletId,msisdn:h.msisdn}}const c=r.filter(u=>s(u.msisdn).slice(-7)===a.slice(-7));if(c.length>0){const h=c.find(m=>m.isDefault)||c[0];return{walletId:h.walletId,msisdn:h.msisdn}}}return null}catch{return null}}async function Bee(t){var e;try{const n=t.userId||((e=qt.currentUser)==null?void 0:e.uid)||"default";if(t.slotIndex!==void 0&&t.slotIndex!==null&&t.slotIndex>=0){let c="";try{t.slotIndex===0?c=localStorage.getItem(`sim1Number_${n}`)||localStorage.getItem("sim1Number")||"":t.slotIndex===1&&(c=localStorage.getItem(`sim2Number_${n}`)||localStorage.getItem("sim2Number")||"")}catch{}if(c){const u=await ub([c],n);if(u)return u}}const r=Array.isArray(t.simNumbers)?t.simNumbers:[],s=await ub(r,n);if(s)return s;const i=`simWalletBindings_${n}`;let o={};try{const c=typeof localStorage<"u"?localStorage.getItem(i):null;o=c?JSON.parse(c):{}}catch{}const a=String(t.subId??""),l=String(t.slotIndex??"");return a&&o[a]&&o[a].walletId?{walletId:o[a].walletId,msisdn:String(o[a].msisdn||"")}:l&&o[`slot_${l}`]&&o[`slot_${l}`].walletId?{walletId:o[`slot_${l}`].walletId,msisdn:String(o[`slot_${l}`].msisdn||"")}:null}catch{return null}}function zee(t){var e;try{const r=`simWalletBindings_${t.userId||((e=qt.currentUser)==null?void 0:e.uid)||"default"}`;let s={};try{const i=typeof localStorage<"u"?localStorage.getItem(r):null;s=i?JSON.parse(i):{}}catch{}t.subId!=null&&(s[String(t.subId)]={walletId:t.walletId,msisdn:t.msisdn||""}),t.slotIndex!=null&&(s[`slot_${String(t.slotIndex)}`]={walletId:t.walletId,msisdn:t.msisdn||""});try{typeof localStorage<"u"&&localStorage.setItem(r,JSON.stringify(s))}catch{}}catch{}}const Wee=t=>{var e,n;try{const r=t||((e=qt.currentUser)==null?void 0:e.uid)||"",s=Object.keys(localStorage),i=`selectedWallet_${r}`,o=`wallets_${r}`,a=s.find(c=>c.startsWith(i));if(a){const c=localStorage.getItem(a)||"";if(c)return c}const l=s.find(c=>c.startsWith(o));if(l){const c=localStorage.getItem(l)||"";if(c){const u=JSON.parse(c);if(Array.isArray(u)&&u.length>0){const h=u.find(m=>m==null?void 0:m.isDefault);return(h==null?void 0:h.id)||((n=u[0])==null?void 0:n.id)||null}}}}catch{}return null};function hj(){return typeof window>"u"?()=>{}:()=>{}}const Di=Object.freeze(Object.defineProperty({__proto__:null,bindSlotWalletMapping:zee,detectWalletFromSim:$ee,identifyWalletBySim:ub,initMobileSmsBridge:hj,processMobileTransactionNotification:dj,resolveWalletBySimOrSlot:Bee},Symbol.toStringTag,{value:"Module"})),qee=t=>{try{let e=t.match(/(?:||)\s*[:]?\s*([0-9]+(?:[.,][0-9]+)?)/);return e?Number(e[1].replace(",",".")):(e=t.match(/received\s*EGP([0-9]+(?:[.,][0-9]+)?)/i),e||(e=t.match(/(?:amount|balance|transferred|received)\s*(?:is|:)?\s*(?:EGP)?\s*([0-9]+(?:[.,][0-9]+)?)/i),e)||(e=t.match(/EGP\s*([0-9]+(?:[.,][0-9]+)?)/i),e)||(e=t.match(/([0-9]+(?:[.,][0-9]+)?)\s*EGP/i),e)||(e=t.match(/([0-9]+[.,]?[0-9]*)\s*(?:)/),e)?Number(e[1].replace(",","")):(e=t.match(/([0-9]+(?:[.,][0-9]+)?)\s*\.?\s*\.?\.?/i)||t.match(/([0-9]+(?:[.,][0-9]+)?)\s*\s*/i),e?Number(String(e[1]).replace(",",".")):null))}catch{return null}},Hee=t=>{try{const e=t.match(/((?:002|\+2)?01[0-9]{9})/);if(e){let n=e[1];return n.startsWith("002")&&(n=n.substring(3)),n.startsWith("+2")&&(n=n.substring(2)),n}return}catch{return}},Kee=t=>{try{const e=t.match(/(?:|)(?:\s+(?:|))?\s*([0-9]+(?:[.,][0-9]+)?)/);if(!e)return;const n=e[1].replace(",",".");return Number(n)||0}catch{return}},Gee=()=>{var t,e;try{const n=((t=qt.currentUser)==null?void 0:t.uid)||"default",r=Object.keys(localStorage).find(i=>i.startsWith(`selectedWallet_${n}`));if(r){const i=localStorage.getItem(r)||"";if(i)return i}const s=Object.keys(localStorage).find(i=>i.startsWith(`wallets_${n}`));if(s){const i=localStorage.getItem(s)||"";if(i){const o=JSON.parse(i);if(Array.isArray(o)&&o.length>0){const a=o.find(l=>l==null?void 0:l.isDefault);return(a==null?void 0:a.id)||((e=o[0])==null?void 0:e.id)||null}}}}catch{}return null},Qee=()=>{var t;try{const e=((t=qt.currentUser)==null?void 0:t.uid)||"",n=e?`selectedShopId_${e}`:"selectedShopId";return localStorage.getItem(n)||""||null}catch{return null}},Yee=(t,e)=>{try{const n=`wallets_${t}`,r=localStorage.getItem(n);if(!r)return null;const s=JSON.parse(r);if(Array.isArray(s)){const i=e.trim(),o=s.find(a=>a.phone&&String(a.phone).trim()===i||a.msisdn&&String(a.msisdn).trim()===i);return o?o.id:null}}catch{}return null},Zp=async(t,e)=>{var N,I;const n=String((t==null?void 0:t.text)||"").trim(),r=String((t==null?void 0:t.title)||"").trim(),s=String((t==null?void 0:t.packageName)||"").toLowerCase(),i=String((t==null?void 0:t.appName)||"").toLowerCase();if(!n||!(/vodafone|emeint|myservices|etisalat|e&|instapay/.test(s)||/vodafone|vf\-?cash|||etisalat|e&|money|instapay/.test(i)||/\s*?\s*|\s*|\s*|\s*|\s*|ana\s*vodafone|e&\s*money|etisalat|received|transferred|sent/i.test(n)))return;try{console.log("VF/ETISALAT NOTIFICATION RECEIVED",t)}catch{}if(t.handledInBackground){console.log("Transaction handled in background (Native). Skipping Web processing to prevent double counting."),e&&e.toast&&e.toast({title:" ",description:"     ."});return}const a=/|?||received/i.test(n),l=/\s*|\s*|transferred|sent/i.test(n);if(l){const A=((N=qt.currentUser)==null?void 0:N.uid)||void 0,R=A?localStorage.getItem(`autoTransferRecord_${A}`):null,k=localStorage.getItem("autoTransferRecord");if(!((R??k)!=="false")){console.log("Transfer detected but Auto-Record is disabled by user preference. Ignoring.");return}}let c=qee(n);if(l){const A=n.match(/\s*\s+(\d+(?:[.,]\d+)?)\s+/);if(A)c=Number(A[1].replace(",","."));else{const R=n.match(/\s*\s+([0-9.,]+)\s+/);if(R){const k=Number(R[1].replace(",","."));k>0&&(c=k)}}}const u=Hee(n),h=Kee(n)||0;if(!c||c<=0)return;let m="vodafone_cash";/etisalat|e&|/i.test(n)||/etisalat|e&/i.test(s)||/etisalat|e&/i.test(i)?m="etisalat_cash":(/instapay/i.test(n)||/instapay/i.test(s)||/instapay/i.test(i))&&(m="instapay");const p=((I=qt.currentUser)==null?void 0:I.uid)||"";let v;if((t==null?void 0:t.simSlot)!==void 0&&p)try{if(t.simSlot===0){const A=localStorage.getItem(`sim1Number_${p}`)??localStorage.getItem("sim1Number");A&&(v=String(A).trim()),!v&&Array.isArray(t.activeSimMsisdns)&&t.activeSimMsisdns[0]&&(v=String(t.activeSimMsisdns[0]).trim())}else if(t.simSlot===1){const A=localStorage.getItem(`sim2Number_${p}`)??localStorage.getItem("sim2Number");A&&(v=String(A).trim()),!v&&Array.isArray(t.activeSimMsisdns)&&t.activeSimMsisdns[1]&&(v=String(t.activeSimMsisdns[1]).trim())}}catch(A){console.error("Error resolving SIM from profile",A)}let g;if((t==null?void 0:t.simSlot)!==void 0){if(!v){console.warn("Transaction detected but no SIM number found in profile for slot",t==null?void 0:t.simSlot),e&&e.toast&&e.toast({title:"",description:`     ${t.simSlot+1}         .`,variant:"destructive"});return}const A=Yee(p,v);if(A)g=A;else{console.warn("Transaction detected but no wallet found for number",v),e&&e.toast&&e.toast({title:"",description:`       ${v}.       .`,variant:"destructive"});return}}else g=Gee()||void 0;const E=Qee()||"",b=g||"default-line";if(!p||!g||!E)return;try{const A=await xX(p);if((A==null?void 0:A.planType)===Ll.ZERO){console.log("Ignoring Notification for Zero Plan user");return}}catch{}const _=`${r}|${n}|${(t==null?void 0:t.sender)||""}|${(t==null?void 0:t.postedAt)||Date.now()}`,S=`VF-${btoa(unescape(encodeURIComponent(_))).slice(0,24)}`,P=a?"withdraw":l?"transfer":"withdraw";v||(v=(t==null?void 0:t.receiverMsisdn)||void 0);const T={type:P,amount:c,provider:m,shopId:E,lineId:b,walletId:g,senderMsisdn:P==="withdraw"?u||void 0:v,receiverMsisdn:P==="withdraw"?v:u||void 0,reference:S,fee:h,createdBy:p,merchantUserId:p,note:m==="etisalat_cash"?"  ":m==="instapay"?"  ":"  "};try{await dj(T)}catch{}};let na={};const Ps={invalidateCache:t=>{const e=t||"default";delete na[e]},async syncReportsDataFromFirebase(t){try{if(!t)return null;const e=await mr.getUserData(t),n=e==null?void 0:e.reportsData;if(!n)return null;const r=`reportsData_${t}`,s=a=>{if(!a)return null;try{return a!=null&&a.toDate?a.toDate():new Date(a)}catch{return null}},i={lastDailyResetDate:s(n.lastDailyResetDate),lastMonthlyResetDate:s(n.lastMonthlyResetDate),hiddenDailyTransactionIds:Array.isArray(n.hiddenDailyTransactionIds)?n.hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:Array.isArray(n.hiddenMonthlyTransactionIds)?n.hiddenMonthlyTransactionIds:[],dailyProfit:Number(n.dailyProfit??0),monthlyProfit:Number(n.monthlyProfit??0),lastDailyProfitResetDate:s(n.lastDailyProfitResetDate),lastMonthlyProfitResetDate:s(n.lastMonthlyProfitResetDate)},o=Ps.getReportsData(t);o.lastDailyResetDate&&(!i.lastDailyResetDate||o.lastDailyResetDate.getTime()>i.lastDailyResetDate.getTime())&&(i.lastDailyResetDate=o.lastDailyResetDate,i.hiddenDailyTransactionIds=o.hiddenDailyTransactionIds,i.dailyProfit=o.dailyProfit,i.lastDailyProfitResetDate=o.lastDailyProfitResetDate),o.lastMonthlyResetDate&&(!i.lastMonthlyResetDate||o.lastMonthlyResetDate.getTime()>i.lastMonthlyResetDate.getTime())&&(i.lastMonthlyResetDate=o.lastMonthlyResetDate,i.hiddenMonthlyTransactionIds=o.hiddenMonthlyTransactionIds,i.monthlyProfit=o.monthlyProfit,i.lastMonthlyProfitResetDate=o.lastMonthlyProfitResetDate);try{localStorage.setItem(r,JSON.stringify(i))}catch{}return i}catch(e){return console.warn("     Firebase:",e),null}},shouldResetDailyReports:t=>{if(!t)return!0;const e=new Date,n=new Date(t);return e.toDateString()!==n.toDateString()},shouldResetMonthlyReports:t=>{if(!t)return!0;const e=new Date,n=new Date(t),r=e.getDate()===1,s=e.getMonth()!==n.getMonth()||e.getFullYear()!==n.getFullYear();return r&&s},autoResetReportsIfNeeded:t=>{try{const e=t?`reportsData_${t}`:"reportsData";let n=Ps.getReportsData(t);const r=!1,s=!1;if(n.lastDailyResetDate||(n.lastDailyResetDate=new Date),n.lastDailyProfitResetDate||(n.lastDailyProfitResetDate=new Date),n.lastMonthlyResetDate||(n.lastMonthlyResetDate=new Date),n.lastMonthlyProfitResetDate||(n.lastMonthlyProfitResetDate=new Date),localStorage.setItem(e,JSON.stringify(n)),na[t||"default"]=n,t)try{mr.updateUserData(t,{reportsData:{...n}})}catch(i){console.warn("     Firebase   :",i)}return{dailyReset:r,monthlyReset:s}}catch(e){return console.error("    :",e),{dailyReset:!1,monthlyReset:!1}}},resetReportsManually:(t,e,n)=>{try{const r=n?`reportsData_${n}`:"reportsData",s=localStorage.getItem(r);let i={lastDailyResetDate:null,lastMonthlyResetDate:null,hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:[],dailyProfit:0,monthlyProfit:0,lastDailyProfitResetDate:null,lastMonthlyProfitResetDate:null};if(s){const a=JSON.parse(s);i={lastDailyResetDate:a.lastDailyResetDate?new Date(a.lastDailyResetDate):null,lastMonthlyResetDate:a.lastMonthlyResetDate?new Date(a.lastMonthlyResetDate):null,hiddenDailyTransactionIds:a.hiddenDailyTransactionIds||[],hiddenMonthlyTransactionIds:a.hiddenMonthlyTransactionIds||[],dailyProfit:a.dailyProfit||0,monthlyProfit:a.monthlyProfit||0,lastDailyProfitResetDate:a.lastDailyProfitResetDate?new Date(a.lastDailyProfitResetDate):null,lastMonthlyProfitResetDate:a.lastMonthlyProfitResetDate?new Date(a.lastMonthlyProfitResetDate):null}}let o=[];if(t==="daily"){const a=new Date().toDateString();o=e.filter(l=>new Date(l.createdAt).toDateString()===a).map(l=>l.id),i.hiddenDailyTransactionIds=[...new Set([...i.hiddenDailyTransactionIds,...o])],i.lastDailyResetDate=new Date,i.dailyProfit=0,i.lastDailyProfitResetDate=new Date}else{const a=new Date().getMonth(),l=new Date().getFullYear();o=e.filter(c=>{const u=new Date(c.createdAt);return u.getMonth()===a&&u.getFullYear()===l}).map(c=>c.id),i.hiddenMonthlyTransactionIds=[...new Set([...i.hiddenMonthlyTransactionIds,...o])],i.lastMonthlyResetDate=new Date,i.monthlyProfit=0,i.lastMonthlyProfitResetDate=new Date}if(localStorage.setItem(r,JSON.stringify(i)),na[n||"default"]=i,n)try{mr.updateUserData(n,{reportsData:{...i}})}catch(a){console.warn("     Firebase   :",a)}return console.log(`   ${t==="daily"?"":""} `),o}catch(r){return console.error("    :",r),[]}},getReportsData:t=>{try{const e=t||"default";if(na[e])return{...na[e]};const n=t?`reportsData_${t}`:"reportsData",r=localStorage.getItem(n);let s={lastDailyResetDate:null,lastMonthlyResetDate:null,hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:[],dailyProfit:0,monthlyProfit:0,lastDailyProfitResetDate:null,lastMonthlyProfitResetDate:null};if(r){const i=JSON.parse(r);s={lastDailyResetDate:i.lastDailyResetDate?new Date(i.lastDailyResetDate):null,lastMonthlyResetDate:i.lastMonthlyResetDate?new Date(i.lastMonthlyResetDate):null,hiddenDailyTransactionIds:i.hiddenDailyTransactionIds||[],hiddenMonthlyTransactionIds:i.hiddenMonthlyTransactionIds||[],dailyProfit:i.dailyProfit||0,monthlyProfit:i.monthlyProfit||0,lastDailyProfitResetDate:i.lastDailyProfitResetDate?new Date(i.lastDailyProfitResetDate):null,lastMonthlyProfitResetDate:i.lastMonthlyProfitResetDate?new Date(i.lastMonthlyProfitResetDate):null}}else if(t){const i=localStorage.getItem("reportsData");if(i)try{const o=JSON.parse(i);s={lastDailyResetDate:o.lastDailyResetDate?new Date(o.lastDailyResetDate):null,lastMonthlyResetDate:o.lastMonthlyResetDate?new Date(o.lastMonthlyResetDate):null,hiddenDailyTransactionIds:o.hiddenDailyTransactionIds||[],hiddenMonthlyTransactionIds:o.hiddenMonthlyTransactionIds||[],dailyProfit:o.dailyProfit||0,monthlyProfit:o.monthlyProfit||0,lastDailyProfitResetDate:o.lastDailyProfitResetDate?new Date(o.lastDailyProfitResetDate):null,lastMonthlyProfitResetDate:o.lastMonthlyProfitResetDate?new Date(o.lastMonthlyProfitResetDate):null},localStorage.setItem(n,JSON.stringify(s))}catch{}}return na[e]=s,{...s}}catch(e){return console.error("    :",e),{lastDailyResetDate:null,lastMonthlyResetDate:null,hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:[],dailyProfit:0,monthlyProfit:0,lastDailyProfitResetDate:null,lastMonthlyProfitResetDate:null}}},filterVisibleTransactions:(t,e,n)=>{try{const r=Ps.getReportsData(n),s=e==="daily"?r.hiddenDailyTransactionIds:r.hiddenMonthlyTransactionIds;return t.filter(o=>!s.includes(o.id))}catch(r){return console.error("   :",r),t}},addProfit:(t,e,n)=>{try{const r=n?`reportsData_${n}`:"reportsData",s=Ps.getReportsData(n);if(e==="daily"?s.dailyProfit+=t:s.monthlyProfit+=t,localStorage.setItem(r,JSON.stringify(s)),na[n||"default"]=s,n)try{mr.updateUserData(n,{reportsData:{...s}})}catch(i){console.warn("     Firebase:",i)}try{window.dispatchEvent(new CustomEvent("reportsUpdated",{detail:{userId:n,type:e,amount:t}}))}catch{}}catch(r){console.error("   :",r)}},getProfits:t=>{try{const e=Ps.getReportsData(t);return{dailyProfit:e.dailyProfit,monthlyProfit:e.monthlyProfit}}catch(e){return console.error("   :",e),{dailyProfit:0,monthlyProfit:0}}},removeTransactionEffects:(t,e)=>{try{const n=e?`reportsData_${e}`:"reportsData",r=Ps.getReportsData(e),s=new Date(t.createdAt),i=new Date,o=i.getMonth(),a=i.getFullYear(),l=Ps.calculateTransactionProfit(t);if(s.toDateString()===i.toDateString()&&((r.hiddenDailyTransactionIds||[]).includes(t.id)||(r.dailyProfit=Math.round((r.dailyProfit-l)*100)/100)),s.getMonth()===o&&s.getFullYear()===a&&((r.hiddenMonthlyTransactionIds||[]).includes(t.id)||(r.monthlyProfit=Math.round((r.monthlyProfit-l)*100)/100)),localStorage.setItem(n,JSON.stringify(r)),na[e||"default"]=r,e)try{mr.updateUserData(e,{reportsData:{...r}})}catch(c){console.warn("      Firebase:",c)}}catch(n){console.error("      :",n)}},calculateTransactionProfit:t=>{const e=String((t==null?void 0:t.status)||"").toLowerCase();if(e&&e!=="completed"&&e!=="confirmed")return 0;const n=String(t.type||t.txnType||"").toLowerCase();if(n==="atm_withdraw"){const i=Number(t.commission||0);return-1*Math.abs(i)}const r=Number((t==null?void 0:t.fee)??0);if(t.commission!==void 0){const i=Math.max(0,Number(t.commission||0));return Math.round((i+Math.max(0,r))*100)/100}const s=n==="withdrawal"?"withdraw":n;if(s==="withdraw"||s==="receive"||s==="send"||s==="transfer"){const i=Math.round(Number(t.amount||0)*.01*100)/100;return Math.round((i+Math.max(0,r))*100)/100}return 0}},Jee=Ps,dne=Object.freeze(Object.defineProperty({__proto__:null,ReportsService:Jee,reportsService:Ps},Symbol.toStringTag,{value:"Module"})),gy={parseNum(t,e){if(typeof t=="number"&&Number.isFinite(t))return t;if(typeof t=="string"){const n=t.replace(/[^0-9.-]/g,""),r=parseFloat(n);return Number.isFinite(r)?r:e}return e},getCurrentDayId(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},async setLimits(t,e){var n;try{const r=ye(F,"walletLimits",t),s={updatedAt:Be(),ownerId:(n=qt.currentUser)==null?void 0:n.uid};return e.dailyTransferLimit!==void 0&&(s.dailyTransferLimit=e.dailyTransferLimit),e.dailyWithdrawLimit!==void 0&&(s.dailyWithdrawLimit=e.dailyWithdrawLimit),e.monthlyTransferLimit!==void 0&&(s.monthlyTransferLimit=e.monthlyTransferLimit),e.monthlyWithdrawLimit!==void 0&&(s.monthlyWithdrawLimit=e.monthlyWithdrawLimit),await rn(r,s,{merge:!0}),await this.getWalletLimits(t)}catch(r){return console.error("    :",r),null}},getCurrentMonthId(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`},shouldResetDailyLimits(t){if(!t)return!0;const e=new Date,n=t.toDate();return e.getDate()!==n.getDate()||e.getMonth()!==n.getMonth()||e.getFullYear()!==n.getFullYear()},shouldResetMonthlyLimits(t){const e=new Date,n=e.getDate()===1;if(!t)return n;const r=t.toDate();return n&&(e.getMonth()!==r.getMonth()||e.getFullYear()!==r.getFullYear())},async getWalletLimits(t){var e;try{const n=ye(F,"walletLimits",t);let r;try{r=await Sn(n)}catch(i){return console.error("     (     ):",i),null}if(r.exists()){const i=r.data();return{walletId:t,dailyTransferLimit:this.parseNum(i.dailyTransferLimit,6e4),dailyWithdrawLimit:this.parseNum(i.dailyWithdrawLimit,1e5),dailyTransferUsed:this.parseNum(i.dailyTransferUsed,0),dailyWithdrawUsed:this.parseNum(i.dailyWithdrawUsed,0),lastDailyReset:i.lastDailyReset||null,monthlyTransferLimit:this.parseNum(i.monthlyTransferLimit,2e5),monthlyWithdrawLimit:this.parseNum(i.monthlyWithdrawLimit,2e5),monthlyTransferUsed:this.parseNum(i.monthlyTransferUsed,0),monthlyWithdrawUsed:this.parseNum(i.monthlyWithdrawUsed,0),lastMonthlyReset:i.lastMonthlyReset||null,updatedAt:i.updatedAt||sn.now()}}const s={walletId:t,dailyTransferLimit:6e4,dailyWithdrawLimit:1e5,dailyTransferUsed:0,dailyWithdrawUsed:0,lastDailyReset:null,monthlyTransferLimit:2e5,monthlyWithdrawLimit:2e5,monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:null,updatedAt:sn.now()};return await rn(n,{dailyTransferLimit:6e4,dailyWithdrawLimit:1e5,dailyTransferUsed:0,dailyWithdrawUsed:0,lastDailyReset:null,monthlyTransferLimit:2e5,monthlyWithdrawLimit:2e5,monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:null,updatedAt:Be(),ownerId:(e=qt.currentUser)==null?void 0:e.uid}),s}catch(n){return console.error("     :",n),null}},async resetDailyLimits(t){var e;try{const n=ye(F,"walletLimits",t);return await rn(n,{dailyTransferUsed:0,dailyWithdrawUsed:0,lastDailyReset:Be(),updatedAt:Be(),ownerId:(e=qt.currentUser)==null?void 0:e.uid},{merge:!0}),console.log(`       ${t}`),!0}catch(n){return console.error("     :",n),!1}},async resetMonthlyLimits(t){var e;try{const n=ye(F,"walletLimits",t);return await rn(n,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:Be(),updatedAt:Be(),ownerId:(e=qt.currentUser)==null?void 0:e.uid},{merge:!0}),console.log(`       ${t}`),!0}catch(n){return console.error("     :",n),!1}},async autoResetLimitsIfNeeded(t){try{const e=await this.getWalletLimits(t);if(!e)return null;let n=!1;return this.shouldResetDailyLimits(e.lastDailyReset)&&(await this.resetDailyLimits(t),n=!0),this.shouldResetMonthlyLimits(e.lastMonthlyReset)&&(await this.resetMonthlyLimits(t),n=!0),n?await this.getWalletLimits(t):e}catch(e){return console.error("     :",e),null}},async canPerformOperation(t,e,n){try{const r=await this.autoResetLimitsIfNeeded(t);if(!r)return{canPerform:!1,message:"      "};if(n==="transfer"){const s=Math.max(0,this.parseNum(r.dailyTransferLimit,6e4)-this.parseNum(r.dailyTransferUsed,0));if(e>s)return{canPerform:!1,message:`   . : ${s.toLocaleString()} .   ${r.dailyTransferLimit.toLocaleString()} .`,dailyRemaining:s,limitType:"daily"};const i=Math.max(0,this.parseNum(r.monthlyTransferLimit,2e5)-this.parseNum(r.monthlyTransferUsed,0));return e>i?{canPerform:!1,message:`   . : ${i.toLocaleString()} .   ${r.monthlyTransferLimit.toLocaleString()} .`,monthlyRemaining:i,limitType:"monthly"}:{canPerform:!0,dailyRemaining:Math.max(0,s-e),monthlyRemaining:Math.max(0,i-e)}}if(n==="withdraw"){const s=Math.max(0,this.parseNum(r.dailyWithdrawLimit,1e5)-this.parseNum(r.dailyWithdrawUsed,0));if(e>s)return{canPerform:!1,message:`   . : ${s.toLocaleString()} .   ${r.dailyWithdrawLimit.toLocaleString()} .`,dailyRemaining:s,limitType:"daily"};const i=Math.max(0,this.parseNum(r.monthlyWithdrawLimit,2e5)-this.parseNum(r.monthlyWithdrawUsed,0));return e>i?{canPerform:!1,message:`   . : ${i.toLocaleString()} .   ${r.monthlyWithdrawLimit.toLocaleString()} .`,monthlyRemaining:i,limitType:"monthly"}:{canPerform:!0,dailyRemaining:Math.max(0,s-e),monthlyRemaining:Math.max(0,i-e)}}return{canPerform:!1,message:"   "}}catch(r){return console.error("      :",r),{canPerform:!1,message:"    "}}},async updateUsage(t,e,n,r=!1){try{if(!r){const o=await this.canPerformOperation(t,e,n);if(!o.canPerform)throw new Error(o.message||"   ")}const s=ye(F,"walletLimits",t),i={updatedAt:Be()};return n==="transfer"?(i.dailyTransferUsed=Ah(e),i.monthlyTransferUsed=Ah(e)):n==="withdraw"&&(i.dailyWithdrawUsed=Ah(e),i.monthlyWithdrawUsed=Ah(e)),await rn(s,i,{merge:!0}),await this.getWalletLimits(t)}catch(s){throw console.error("    :",s),s}},async rollbackUsage(t,e,n,r){try{const s=ye(F,"walletLimits",t),i=await this.getWalletLimits(t);if(!i)throw new Error("      ");const o={updatedAt:Be()},a=new Date,l=r?new Date(r):a,c=l.getDate()===a.getDate()&&l.getMonth()===a.getMonth()&&l.getFullYear()===a.getFullYear(),u=l.getMonth()===a.getMonth()&&l.getFullYear()===a.getFullYear();return n==="transfer"?(c&&(o.dailyTransferUsed=Math.max(0,(i.dailyTransferUsed||0)-e)),u&&(o.monthlyTransferUsed=Math.max(0,(i.monthlyTransferUsed||0)-e))):(c&&(o.dailyWithdrawUsed=Math.max(0,(i.dailyWithdrawUsed||0)-e)),u&&(o.monthlyWithdrawUsed=Math.max(0,(i.monthlyWithdrawUsed||0)-e))),Object.keys(o).length<=1?i:(await rn(s,{...o},{merge:!0}),await this.getWalletLimits(t))}catch(s){throw console.error("      :",s),s}},calculateRemaining(t){return{dailyTransferRemaining:Math.max(0,t.dailyTransferLimit-t.dailyTransferUsed),dailyWithdrawRemaining:Math.max(0,t.dailyWithdrawLimit-t.dailyWithdrawUsed),monthlyTransferRemaining:Math.max(0,t.monthlyTransferLimit-t.monthlyTransferUsed),monthlyWithdrawRemaining:Math.max(0,t.monthlyWithdrawLimit-t.monthlyWithdrawUsed)}},async resetAllLimits(t){var e;try{const n=ye(F,"walletLimits",t);return await rn(n,{dailyTransferUsed:0,dailyWithdrawUsed:0,monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastDailyReset:Be(),lastMonthlyReset:Be(),updatedAt:Be(),ownerId:(e=qt.currentUser)==null?void 0:e.uid},{merge:!0}),console.log(`       ${t}`),await this.getWalletLimits(t)}catch(n){return console.error("     :",n),null}}},Uf=Object.freeze(Object.defineProperty({__proto__:null,default:gy,walletDailyLimitsService:gy},Symbol.toStringTag,{value:"Module"}));class Xee{constructor(){Xd(this,"intervalId",null);Xd(this,"isRunning",!1)}start(){if(this.isRunning){console.log(" ReportsResetScheduler  ");return}this.isRunning=!0;try{const e=()=>{const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1,0,0,0,0),s=Math.max(1e3,r.getTime()-n.getTime());this.intervalId=setTimeout(async()=>{await this.runResetSafely(),e()},s)};e(),console.log("        ")}catch{console.log("   ")}}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.isRunning=!1,console.log("     ")}async runResetSafely(){var e;try{const n=(e=qt.currentUser)==null?void 0:e.uid;if(!n){console.log("          ");return}const s=new Date().toISOString().slice(0,10),i=await ob.getToday(n);await ob.saveToHistory(n,s,i||{}),console.log("      :",s),await this.archivePreviousDayIfNeeded(n),await this.resetUserWalletLimits(n)}catch(n){console.error("     :",n)}}async archivePreviousDayIfNeeded(e){try{await Ps.syncReportsDataFromFirebase(e);const n=Ps.getReportsData(e);if(!n.lastDailyResetDate||!Ps.shouldResetDailyReports(n.lastDailyResetDate))return;const s=new Date,i=new Date(s.getFullYear(),s.getMonth(),s.getDate()-1),o=i.toDateString(),a=await mr.getUserTransactions(e),l=_=>{const S=String(_||"").toLowerCase();return["completed","confirmed","success"].includes(S)?"completed":["failed","error"].includes(S)?"failed":["cancelled","canceled"].includes(S)?"cancelled":"pending"},c=(a||[]).filter(_=>{var P,T;const S=(P=_==null?void 0:_.createdAt)!=null&&P.toDate?_.createdAt.toDate():(_==null?void 0:_.createdAt)instanceof Date?_.createdAt:new Date(_==null?void 0:_.createdAt);return((T=S==null?void 0:S.toDateString)==null?void 0:T.call(S))===o&&l(_==null?void 0:_.status)==="completed"}),u=c.length,h=c.reduce((_,S)=>_+Number(S.amount||0),0),m=_=>{const S=String(((_==null?void 0:_.type)??(_==null?void 0:_.txnType))||"").toLowerCase();return S==="withdraw"||S==="withdrawal"||S==="receive"},p=_=>{const S=String(((_==null?void 0:_.type)??(_==null?void 0:_.txnType))||"").toLowerCase();return S==="send"||S==="transfer"},v=c.filter(m).reduce((_,S)=>{const P=S.withdrawnAmount!==void 0?Number(S.withdrawnAmount):Number(S.amount||0);return _+P},0),g=c.filter(_=>p(_)&&!["  "].includes(String((_==null?void 0:_.title)||""))).reduce((_,S)=>{const P=S.sentAmount!==void 0?Number(S.sentAmount):Number(S.amount||0);return _+P},0),E=c.reduce((_,S)=>_+Number(Ps.calculateTransactionProfit(S)||0),0),b=new Date(i).toISOString().slice(0,10);await uV.add({userId:e,reportDate:b,totalTransactions:u,totalAmount:Math.round(h),totalWithdrawn:Math.round(v),totalSent:Math.round(g),profit:Math.round(E),walletId:null}),console.log("    :",b)}catch(n){console.warn("      :",n)}}async resetUserWalletLimits(e){try{const n=await Pa.getByMerchantId(e),r=new Date().getDate()===1;for(const s of n){const i=String((s==null?void 0:s.id)||"");if(i){try{await gy.resetDailyLimits(i)}catch{}if(r)try{await gy.resetMonthlyLimits(i)}catch{}}}console.log("     "+(r?" ":""))}catch(n){console.warn("    :",n)}}}const kP=new Xee,i_=768;function fj(){const[t,e]=y.useState(void 0);return y.useEffect(()=>{const n=window.matchMedia(`(max-width: ${i_-1}px)`),r=()=>{e(window.innerWidth<i_)};return n.addEventListener("change",r),e(window.innerWidth<i_),()=>n.removeEventListener("change",r)},[]),!!t}function Zee(){const[t,e]=y.useState("default"),[n,r]=y.useState(!1);return y.useEffect(()=>{try{const i=localStorage.getItem("notificationPermission");(i==="granted"||i==="denied"||i==="default")&&e(i);const o=localStorage.getItem("notificationConsentRequested")==="true";r(o)}catch{}},[]),{permission:t,hasRequested:n,requestConsent:async()=>{if(typeof window<"u"&&"Notification"in window){const i=await Notification.requestPermission();e(i);try{localStorage.setItem("notificationPermission",i),localStorage.setItem("notificationConsentRequested","true"),r(!0)}catch{}return i}return"unsupported"}}}const mj=y.createContext(void 0);function ete({children:t}){const{profile:e,user:n,loading:r}=Zs(),[s,i]=y.useState(null),[o,a]=y.useState(null),[l,c]=y.useState(!0);y.useEffect(()=>{if(!r&&e){const h=e!=null&&e.userId?`selectedShopId_${e.userId}`:n!=null&&n.uid?`selectedShopId_${n==null?void 0:n.uid}`:"selectedShopId";let m=null;try{m=localStorage.getItem(h)||null}catch{}i(m||e.shopId),a((e==null?void 0:e.shopName)||(n==null?void 0:n.displayName)||""),c(!1)}else r||c(!1)},[e,r]),y.useEffect(()=>{const h=()=>{const p=e!=null&&e.userId?`selectedShopId_${e.userId}`:n!=null&&n.uid?`selectedShopId_${n==null?void 0:n.uid}`:"selectedShopId";try{const v=localStorage.getItem(p);i(v||((e==null?void 0:e.shopId)??null))}catch{}};window.addEventListener("selectedShopIdChanged",h);const m=p=>{const v=e!=null&&e.userId?`selectedShopId_${e.userId}`:n!=null&&n.uid?`selectedShopId_${n==null?void 0:n.uid}`:"selectedShopId";if(!(!p.key||p.key!==v))try{const g=localStorage.getItem(v);i(g||((e==null?void 0:e.shopId)??null))}catch{}};return window.addEventListener("storage",m),()=>{window.removeEventListener("selectedShopIdChanged",h),window.removeEventListener("storage",m)}},[e==null?void 0:e.userId,n==null?void 0:n.uid,e==null?void 0:e.shopId]);const u={shopId:s,shopName:o,loading:l};return f.jsx(mj.Provider,{value:u,children:t})}function tte(){const t=y.useContext(mj);return t===void 0?{shopId:null,shopName:null,loading:!1}:t}const Kr={phoneNumber:"201000392539",defaultMessage:"    ",isEnabled:!0,lastUpdated:new Date},pj="whatsapp-settings",gj="app-settings",eg="whatsapp_settings_cache",db=async()=>{var t;try{if(!qt.currentUser){try{const r=localStorage.getItem(eg);if(r){const s=JSON.parse(r);return{phoneNumber:s.phoneNumber||Kr.phoneNumber,defaultMessage:s.defaultMessage||Kr.defaultMessage,isEnabled:s.isEnabled!==void 0?s.isEnabled:Kr.isEnabled,lastUpdated:s.lastUpdated?new Date(s.lastUpdated):Kr.lastUpdated}}}catch{}return Kr}const e=ye(F,gj,pj),n=await Sn(e);if(n.exists()){const r=n.data(),s={phoneNumber:r.phoneNumber||Kr.phoneNumber,defaultMessage:r.defaultMessage||Kr.defaultMessage,isEnabled:r.isEnabled!==void 0?r.isEnabled:Kr.isEnabled,lastUpdated:((t=r.lastUpdated)==null?void 0:t.toDate())||Kr.lastUpdated};try{localStorage.setItem(eg,JSON.stringify(s))}catch{}return s}else return await yj(Kr),Kr}catch{try{const n=localStorage.getItem(eg);if(n){const r=JSON.parse(n);return{phoneNumber:r.phoneNumber||Kr.phoneNumber,defaultMessage:r.defaultMessage||Kr.defaultMessage,isEnabled:r.isEnabled!==void 0?r.isEnabled:Kr.isEnabled,lastUpdated:r.lastUpdated?new Date(r.lastUpdated):Kr.lastUpdated}}}catch{}return Kr}},yj=async t=>{try{const e=ye(F,gj,pj),n={...t,lastUpdated:new Date};await rn(e,n,{merge:!0});try{localStorage.setItem(eg,JSON.stringify(n))}catch{}return!0}catch(e){return console.error("    :",e),!1}},vj=t=>{const e=t.replace(/\D/g,"");if(e.length<10)throw new Error("      10   ");return e},hne=t=>{try{const e=vj(t);return e.length>=10&&e.length<=15}catch{return!1}},nte=(t,e)=>{const n=vj(t),r=encodeURIComponent(e);return`https://wa.me/${n}?text=${r}`},fne=()=>{const[t,e]=V.useState(null),[n,r]=V.useState(!0),[s,i]=V.useState(null);return V.useEffect(()=>{(async()=>{try{r(!0);const l=await db();e(l),i(null)}catch(l){i("    "),console.error(l)}finally{r(!1)}})()},[]),{settings:t,loading:n,error:s,updateSettings:async a=>{try{return r(!0),await yj(a)&&t?(e({...t,...a,lastUpdated:new Date}),i(null),!0):(i("   "),!1)}catch(l){return i("   "),console.error(l),!1}finally{r(!1)}},refreshSettings:()=>db().then(e)}},gp="https://cashy-link-chat.shop",DP=({position:t="left"})=>{const[e,n]=y.useState(()=>{try{return localStorage.getItem("chat_widget_visible")!=="false"}catch{return!0}}),[r,s]=y.useState(!1),[i,o]=y.useState(null),[a,l]=y.useState(""),[c,u]=y.useState(""),[h,m]=y.useState(()=>{if(typeof window<"u"){const q=localStorage.getItem("support_chat_messages");return q?JSON.parse(q):[]}return[]}),[p,v]=y.useState(null),[g,E]=y.useState(null),[b,_]=y.useState(!1),[S,P]=y.useState(()=>{if(typeof window<"u"){const q=localStorage.getItem("support_chat_unread_count");return q?parseInt(q,10):0}return 0}),[T,N]=y.useState(new Set),[I,A]=y.useState(null),[R,k]=y.useState(!1),[C,L]=y.useState({name:"",email:"",phone:""});y.useEffect(()=>{const q=localStorage.getItem("support_chat_user_data");if(q)try{const ge=JSON.parse(q);L(ke=>({...ke,...ge}))}catch(ge){console.error("Error parsing saved chat user data",ge)}},[]);const[O,X]=y.useState(null),Ne=y.useRef(null),Le=y.useRef(null),Fe=y.useRef(null),W=y.useRef(r),Y=y.useRef(null),le=y.useRef(0),pe=y.useRef(0),fe=y.useRef(0);y.useEffect(()=>{window.dispatchEvent(new CustomEvent("support-chat-unread",{detail:{count:S}}))},[S]),y.useEffect(()=>{W.current=r},[r]),y.useEffect(()=>{const q=()=>{I&&Q(I),s(!0),P(0)};return window.addEventListener("open-support-chat",q),()=>window.removeEventListener("open-support-chat",q)},[I]);const Ge=()=>{var q;(q=Fe.current)==null||q.scrollIntoView({behavior:"auto"})};y.useEffect(()=>{Ge()},[h,r,R]);const{toast:Ie}=ll(),{user:ve}=Zs(),J=Ii(),qe=fj(),dn=Te.isNativePlatform(),dr=qe||dn;y.useEffect(()=>{ve&&L(q=>({...q,name:ve.displayName||q.name,email:ve.email||q.email,phone:ve.phoneNumber||q.phone}))},[ve]);const Xn=J.pathname.startsWith("/admin"),sr=J.pathname.startsWith("/profile-settings");y.useEffect(()=>{localStorage.setItem("support_chat_messages",JSON.stringify(h))},[h]),y.useEffect(()=>{localStorage.setItem("support_chat_unread_count",S.toString())},[S]),y.useEffect(()=>{const q=localStorage.getItem("support_chat_user_id");q&&(A(q),Q(q))},[]),y.useEffect(()=>()=>{Le.current!==null&&(window.clearInterval(Le.current),Le.current=null)},[]);const Dr=async()=>{k(!0)},Or=async()=>{if(!C.name||!C.email||!C.phone){Ie({title:" ",description:"    ",variant:"destructive"});return}try{let q=ve==null?void 0:ve.uid;if(!q){if(C.phone){const Re=C.phone.replace(/[^0-9]/g,"");Re.length>=5&&(q=`user_${Re}`)}if(!q){const Re=localStorage.getItem("support_chat_user_id");Re?q=Re:q=`guest_${Date.now()}_${Math.random().toString(36).slice(2,10)}`}}const ke=await(await fetch(`${gp}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:q,name:C.name,email:C.email,phone:C.phone})})).json().catch(()=>null);if((ke==null?void 0:ke.status)==="missing_fields"){Ie({title:" ",description:"    ",variant:"destructive"});return}if((ke==null?void 0:ke.status)!=="registered"){const Re=localStorage.getItem("support_chat_user_id");if(!(q===Re||(ve==null?void 0:ve.uid)&&q===ve.uid)){Ie({title:"",description:"    ",variant:"destructive"});return}}localStorage.setItem("support_chat_user_data",JSON.stringify({name:C.name,email:C.email,phone:C.phone})),o("local"),A(q),localStorage.setItem("support_chat_user_id",q),k(!1),Q(q)}catch(q){console.error("Registration check failed:",q),Ie({title:"  ",description:"    ",variant:"destructive"})}},Lr=q=>{if(!q)return new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});let ge;if(typeof q=="object"&&q.toDate)ge=q.toDate();else if(typeof q=="string")ge=new Date(q);else return"";if(isNaN(ge.getTime()))return"";const ke=new Date;return ge.getDate()===ke.getDate()&&ge.getMonth()===ke.getMonth()&&ge.getFullYear()===ke.getFullYear()?ge.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):`${ge.toLocaleDateString()} ${ge.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`},Q=q=>{if(Le.current!==null)return;const ge=window.setInterval(async()=>{try{if(pe.current>Date.now())return;if(typeof navigator<"u"&&navigator&&"onLine"in navigator&&navigator.onLine===!1){le.current++,le.current>=3&&(pe.current=Date.now()+3e4,le.current=0);return}const ke=new AbortController,Re=setTimeout(()=>ke.abort(),6e3),ue=await fetch(`${gp}/get/${q}`,{signal:ke.signal,cache:"no-store"});if(clearTimeout(Re),!ue.ok){le.current++,le.current>=3&&(pe.current=Date.now()+15e3,le.current=0);return}const ae=await ue.json().catch(()=>null);if(!ae)return;le.current=0,pe.current=0;const Tt=`server_${Date.now()}_${Math.random().toString(36).slice(2,10)}`;let _t=null,Mt=ae.message||ae.msg||ae.text||ae.imageUrl||ae.url||ae.image||ae.data||ae.content;ae.imageBase64&&(Mt=`data:image/jpeg;base64,${ae.imageBase64}`);let Zn=ae.type;if(Mt&&typeof Mt=="string"&&(Mt.startsWith("data:image")||Mt.match(/\.(jpeg|jpg|gif|png|webp)$/i)||Mt.length>200&&!Mt.includes(" ")&&/^[A-Za-z0-9+/=]+$/.test(Mt))&&(Zn="image"),!Zn&&Mt&&(Zn="text"),Zn==="text"&&Mt&&(_t={id:Tt,senderType:"admin",message:Mt,content:Mt,type:"text",timestamp:new Date().toISOString()}),Zn==="image"&&Mt){let M=Mt;!M.startsWith("http")&&!M.startsWith("data:image")&&(M=`data:image/jpeg;base64,${Mt}`),_t={id:Tt,senderType:"admin",message:"",content:M,imageUrl:M,type:"image",timestamp:new Date().toISOString()}}_t&&(m(M=>[...M,_t]),Y.current&&(Y.current.currentTime=0,Y.current.play().catch(M=>console.error("Error playing notification sound:",M))),W.current||P(M=>M+1),N(M=>new Set([...M,Tt])),setTimeout(()=>{N(M=>{const z=new Set(M);return z.delete(Tt),z})},5e3))}catch(ke){const Re=Date.now();Re-fe.current>6e4&&(fe.current=Re,console.error("Error polling support messages:",ke)),le.current++,le.current>=3&&(pe.current=Date.now()+3e4,le.current=0)}},3e3);Le.current=ge},de=()=>{Le.current!==null&&(window.clearInterval(Le.current),Le.current=null)},_e=async()=>{if(!a.trim())return;const q=a;l("");let ge=I;if(!ge){const ue=localStorage.getItem("support_chat_user_id");if(ue)ge=ue;else{const ae=`web_${Date.now()}_${Math.random().toString(36).slice(2,10)}`;localStorage.setItem("support_chat_user_id",ae),ge=ae}A(ge)}const ke=`client_${Date.now()}_${Math.random().toString(36).slice(2,10)}`,Re={id:ke,senderType:"client",message:q,content:q,timestamp:new Date().toISOString()};m(ue=>[...ue,Re]);try{await fetch(`${gp}/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:ge,type:"text",message:q,name:C.name,email:C.email,phone:C.phone})}),Q(ge)}catch(ue){console.error("Error sending support message:",ue),m(ae=>ae.filter(Tt=>Tt.id!==ke)),l(q),Ie({title:"  ",description:"   ",variant:"destructive"})}},nt=async()=>{if(!c.trim())return;const q=c;u("");try{const ge=await db(),ke=nte(ge.phoneNumber,q);window.open(ke,"_blank")}catch(ge){console.error("Error opening WhatsApp:",ge),Ie({title:"",description:"      ",variant:"destructive"}),u(q)}},he=async()=>{o(null),m([]),localStorage.removeItem("support_chat_messages"),localStorage.removeItem("support_chat_user_id"),l(""),v(null),E(null),P(0),de(),Ie({title:"  ",description:"     "})},Ce=q=>{var ke;const ge=(ke=q.target.files)==null?void 0:ke[0];if(ge){if(!ge.type.startsWith("image/")){Ie({title:"   ",description:"   ",variant:"destructive"});return}if(ge.size>5*1024*1024){Ie({title:"   ",description:"     5 ",variant:"destructive"});return}v(ge);const Re=new FileReader;Re.onload=ue=>{var ae;E((ae=ue.target)==null?void 0:ae.result)},Re.readAsDataURL(ge)}},Ue=q=>new Promise((ge,ke)=>{const Re=new FileReader;Re.onload=()=>{const ue=Re.result.split(",")[1];ge(ue)},Re.onerror=ke,Re.readAsDataURL(q)}),rt=async()=>{if(!p)return;const q=p;v(null),E(null),_(!0);let ge=I;if(!ge){const ke=localStorage.getItem("support_chat_user_id");if(ke)ge=ke;else{const Re=`web_${Date.now()}_${Math.random().toString(36).slice(2,10)}`;localStorage.setItem("support_chat_user_id",Re),ge=Re}A(ge)}try{const ke=await Ue(q);await fetch(`${gp}/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:ge,name:C.name,email:C.email,phone:C.phone,type:"image",imageBase64:ke})});const ue={id:`client_img_${Date.now()}_${Math.random().toString(36).slice(2,10)}`,senderType:"client",message:"",content:"",imageUrl:`data:image/jpeg;base64,${ke}`,type:"image",timestamp:new Date().toISOString()};m(ae=>[...ae,ue]),Q(ge),Ie({title:" ",description:"   "})}catch(ke){console.error("Error sending image:",ke),Ie({title:"",description:"   .    .",variant:"destructive"})}finally{_(!1),Ne.current&&(Ne.current.value="")}},lt=()=>{var q;(q=Ne.current)==null||q.click()},Lt=()=>{s(!1),P(0)},Ct=()=>{r||(P(0),I&&Q(I)),s(!r)};return Xn||sr||!e?null:f.jsxs(f.Fragment,{children:[f.jsx("style",{children:`
           @keyframes pulse {
             0% {
               transform: scale(1);
               box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
             }
             70% {
               transform: scale(1.05);
               box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
             }
             100% {
               transform: scale(1);
               box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
             }
           }

           @keyframes slideIn {
             0% {
               transform: translateX(${t==="left"?"-100%":"100%"});
               opacity: 0;
             }
             100% {
               transform: translateX(0);
               opacity: 1;
             }
           }

           .chat-container {
             position: fixed;
             bottom: 40px;
             ${t}: 40px;
             z-index: 100;
             animation: slideIn 0.8s ease-out;
           }

           .chat-float {
             width: 60px;
             height: 60px;
             background: linear-gradient(135deg, rgba(59, 130, 246, 0.9), rgba(37, 99, 235, 0.9));
             color: #FFF;
             border-radius: 50px;
             text-align: center;
             font-size: 30px;
             box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
             cursor: pointer;
             transition: all 0.3s ease;
             display: flex;
             align-items: center;
             justify-content: center;
             border: 2px solid rgba(255, 255, 255, 0.3);
             outline: none;
             position: relative;
             backdrop-filter: blur(10px);
           }

           .chat-float:hover {
             transform: scale(1.1) rotate(5deg);
             box-shadow: 0 6px 20px rgba(59, 130, 246, 0.5);
           }

           .chat-dialog {
             position: absolute;
             bottom: 80px;
             ${t}: 0;
             width: 350px;
             max-height: 70vh;
             background: white;
             border-radius: 16px;
             box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
             border: 1px solid rgba(59, 130, 246, 0.2);
             overflow: hidden;
             transform-origin: bottom ${t};
             animation: slideIn 0.3s ease-out;
             display: flex;
             flex-direction: column;
           }

           .messages-container {
             flex: 1;
             overflow-y: auto;
             padding: 16px;
             background: #f8fafc;
             min-height: 0;
           }

           .message {
             margin-bottom: 12px;
             padding: 8px 12px;
             border-radius: 12px;
             max-width: 80%;
             word-wrap: break-word;
           }

           .message.client {
             background: linear-gradient(135deg, #3b82f6, #2563eb);
             color: white;
             margin-left: auto;
             text-align: right;
           }

           .message.admin {
-                background: #e2e8f0;
-                color: #334155;
+                background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
+                color: #0f172a;
+                border: 2px solid #0ea5e9;
+                box-shadow: 0 2px 8px rgba(14, 165, 233, 0.2);
             margin-right: auto;
+             position: relative;
+           }
+           
+           .message.admin.new-message {
+             animation: newMessagePulse 2s ease-in-out;
+             border-color: #10b981;
+             background: linear-gradient(135deg, #f0fdf4, #dcfce7);
+             box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
+           }
+           
+           .message.admin.new-message::before {
+             content: "";
+             position: absolute;
+             top: -8px;
+             right: -8px;
+             background: #10b981;
+             color: white;
+             font-size: 10px;
+             padding: 2px 6px;
+             border-radius: 8px;
+             font-weight: bold;
+           }
+           
+           @keyframes newMessagePulse {
+             0% {
+               transform: scale(1);
+               box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
+             }
+             50% {
+               transform: scale(1.02);
+               box-shadow: 0 6px 16px rgba(16, 185, 129, 0.5);
+             }
+             100% {
+               transform: scale(1);
+               box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
+             }
            }
            margin-right: auto;
          }

          @media (max-width: 768px) {
            .chat-container {
              bottom: 80px;
              ${t}: 16px;
              pointer-events: none;
            }
            
            .chat-dialog {
              width: 300px;
              max-height: 400px;
              pointer-events: auto;
              bottom: 0;
            }
            
            .chat-float {
              display: none !important;
            }
          }
        `}),f.jsxs("div",{className:"chat-container",children:[r&&f.jsxs("div",{className:"chat-dialog",children:[f.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Hc,{className:"h-5 w-5"}),f.jsx("span",{className:"font-semibold",children:"   cashy link"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[i&&f.jsx(wt,{variant:"ghost",size:"sm",onClick:he,className:"text-white hover:bg-red-500/20 h-8 w-8 p-0",title:" ",children:f.jsx(yk,{className:"h-4 w-4"})}),f.jsx(wt,{variant:"ghost",size:"sm",onClick:Lt,className:"text-white hover:bg-white/20 h-8 w-8 p-0",children:f.jsx(Ui,{className:"h-4 w-4"})})]})]}),!i&&!R?f.jsxs("div",{className:"p-6 space-y-4",children:[f.jsxs("div",{className:"text-center space-y-2",children:[f.jsx("h3",{className:"font-semibold text-lg",children:"    "}),f.jsx("p",{className:"text-sm text-gray-500",children:"  .    :"})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs(wt,{onClick:Dr,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[f.jsx(Hc,{className:"w-4 h-4 ml-2"}),"   "]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-0 flex items-center",children:f.jsx("span",{className:"w-full border-t"})}),f.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:f.jsx("span",{className:"bg-white px-2 text-gray-500",children:""})})]}),f.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-100",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2 text-green-700 font-medium",children:[f.jsx(Hc,{className:"w-4 h-4"}),f.jsx("span",{children:""})]}),f.jsx(ar,{dir:"ltr",placeholder:"  ...",value:c,onChange:q=>u(q.target.value),className:"mb-2 bg-white"}),f.jsx(wt,{className:"w-full bg-[#25D366] hover:bg-[#128C7E] text-white",onClick:nt,children:" "})]})]})]}):R&&!i?f.jsxs("div",{className:"p-6 space-y-4",children:[f.jsxs("div",{className:"text-center space-y-2",children:[f.jsx("h3",{className:"font-semibold text-lg",children:" "}),f.jsx("p",{className:"text-sm text-gray-500",children:"    "})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium mb-1 block",children:""}),f.jsx(ar,{placeholder:" ",value:C.name,onChange:q=>L({...C,name:q.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium mb-1 block",children:" "}),f.jsx(ar,{placeholder:"example@email.com",type:"email",value:C.email,onChange:q=>L({...C,email:q.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium mb-1 block",children:" "}),f.jsx(ar,{placeholder:"01xxxxxxxxx",type:"tel",value:C.phone,onChange:q=>L({...C,phone:q.target.value})})]}),f.jsx(wt,{onClick:Or,className:"w-full mt-4 bg-blue-600 text-white hover:bg-blue-700",children:"  "}),f.jsx(wt,{variant:"ghost",onClick:()=>k(!1),className:"w-full",children:""})]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"messages-container",children:[h.length===0?f.jsxs("div",{className:"text-center text-gray-500 py-8",children:[f.jsx(Hc,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),f.jsx("p",{children:"   "}),f.jsx("p",{className:"text-sm",children:"   "})]}):h.map(q=>f.jsx("div",{className:`flex mb-4 ${q.senderType==="client"?"justify-end":"justify-start"}`,children:f.jsxs("div",{className:`max-w-[80%] p-3 rounded-lg ${q.senderType==="client"?"bg-blue-600 text-white rounded-br-none":"bg-gray-100 text-gray-800 rounded-bl-none"}`,children:[q.type==="image"?f.jsxs("div",{children:[f.jsx("img",{src:q.imageUrl||"https://placehold.co/300x200?text=Image+Unavailable",alt:" ",className:"max-w-full h-auto rounded-lg mb-2 cursor-pointer",onClick:()=>q.imageUrl&&X(q.imageUrl),style:{maxHeight:"200px"}}),q.message&&f.jsx("div",{className:"text-sm",children:q.message})]}):f.jsx("div",{className:"text-sm",children:q.message||q.content||" "}),f.jsx("span",{className:"text-[10px] opacity-70 mt-1 block",children:Lr(q.timestamp)})]})},q.id)),f.jsx("div",{ref:Fe})]}),f.jsxs("div",{className:"p-4 border-t bg-white",children:[g&&f.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700",children:" :"}),f.jsx(wt,{variant:"ghost",size:"sm",onClick:()=>{v(null),E(null),Ne.current&&(Ne.current.value="")},className:"h-6 w-6 p-0 text-gray-500 hover:text-red-500",children:f.jsx(Ui,{className:"h-4 w-4"})})]}),f.jsx("img",{src:g,alt:"",className:"max-w-full h-auto rounded-lg",style:{maxHeight:"150px"}}),f.jsx("div",{className:"flex gap-2 mt-2",children:f.jsx(wt,{onClick:rt,disabled:b,size:"sm",className:"bg-green-600 hover:bg-green-700 flex-1",children:b?" ...":" "})})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(ar,{placeholder:"  ...",value:a,onChange:q=>l(q.target.value),onKeyPress:q=>q.key==="Enter"&&_e(),className:"flex-1 text-right",dir:"rtl"}),f.jsx("input",{type:"file",ref:Ne,onChange:Ce,accept:"image/*",className:"hidden"}),f.jsx(wt,{onClick:lt,size:"sm",variant:"outline",className:"px-3",title:" ",children:f.jsx(q3,{className:"h-4 w-4"})}),f.jsx(wt,{onClick:_e,disabled:!a.trim(),size:"sm",className:"bg-blue-600 hover:bg-blue-700 px-3",children:f.jsx(d5,{className:"h-4 w-4"})})]})]})]})]}),!dr&&f.jsxs("div",{className:"relative inline-block",children:[!r&&f.jsx("div",{onClick:q=>{q.stopPropagation(),q.preventDefault(),n(!1);try{localStorage.setItem("chat_widget_visible","false")}catch{}},className:"absolute -top-1 -left-1 bg-gray-200 hover:bg-red-500 hover:text-white text-gray-600 rounded-full p-0.5 w-5 h-5 flex items-center justify-center shadow-md cursor-pointer transition-colors z-[102]",title:"",children:f.jsx(Ui,{size:12})}),f.jsxs("button",{className:"chat-float",onClick:Ct,title:"  ",children:[!r&&S>0&&f.jsx("div",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full h-6 w-6 flex items-center justify-center min-w-[24px] shadow-lg",children:S>99?"99+":S}),r?f.jsx(Ui,{className:"h-6 w-6"}):f.jsx(Hc,{className:"h-6 w-6"})]})]}),O&&f.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/80 flex items-center justify-center p-4 backdrop-blur-sm",onClick:()=>X(null),children:f.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] w-full flex items-center justify-center",onClick:q=>q.stopPropagation(),children:[f.jsx("button",{onClick:()=>X(null),className:"absolute -top-12 right-0 bg-white/10 hover:bg-white/20 text-white rounded-full p-2 transition-colors",children:f.jsx(Ui,{className:"h-6 w-6"})}),f.jsx("img",{src:O,alt:"Full size",className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl"})]})}),f.jsx("audio",{ref:Y,src:"https://res.cloudinary.com/dxfq3iotg/video/upload/v1557233524/success.mp3",hidden:!0})]})]})};var rte=y.createContext(void 0);function ste(t){const e=y.useContext(rte);return t||e||"ltr"}function ite(t,[e,n]){return Math.min(n,Math.max(e,t))}function ote(t,e){return y.useReducer((n,r)=>e[n][r]??n,t)}var vI="ScrollArea",[wj]=Sc(vI),[ate,ei]=wj(vI),_j=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...o}=t,[a,l]=y.useState(null),[c,u]=y.useState(null),[h,m]=y.useState(null),[p,v]=y.useState(null),[g,E]=y.useState(null),[b,_]=y.useState(0),[S,P]=y.useState(0),[T,N]=y.useState(!1),[I,A]=y.useState(!1),R=Qn(e,C=>l(C)),k=ste(s);return f.jsx(ate,{scope:n,type:r,dir:k,scrollHideDelay:i,scrollArea:a,viewport:c,onViewportChange:u,content:h,onContentChange:m,scrollbarX:p,onScrollbarXChange:v,scrollbarXEnabled:T,onScrollbarXEnabledChange:N,scrollbarY:g,onScrollbarYChange:E,scrollbarYEnabled:I,onScrollbarYEnabledChange:A,onCornerWidthChange:_,onCornerHeightChange:P,children:f.jsx(_n.div,{dir:k,...o,ref:R,style:{position:"relative","--radix-scroll-area-corner-width":b+"px","--radix-scroll-area-corner-height":S+"px",...t.style}})})});_j.displayName=vI;var bj="ScrollAreaViewport",Ej=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=t,o=ei(bj,n),a=y.useRef(null),l=Qn(e,a,o.onViewportChange);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),f.jsx(_n.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:f.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});Ej.displayName=bj;var ao="ScrollAreaScrollbar",wI=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=ei(ao,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=s,a=t.orientation==="horizontal";return y.useEffect(()=>(a?i(!0):o(!0),()=>{a?i(!1):o(!1)}),[a,i,o]),s.type==="hover"?f.jsx(lte,{...r,ref:e,forceMount:n}):s.type==="scroll"?f.jsx(cte,{...r,ref:e,forceMount:n}):s.type==="auto"?f.jsx(Sj,{...r,ref:e,forceMount:n}):s.type==="always"?f.jsx(_I,{...r,ref:e}):null});wI.displayName=ao;var lte=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=ei(ao,t.__scopeScrollArea),[i,o]=y.useState(!1);return y.useEffect(()=>{const a=s.scrollArea;let l=0;if(a){const c=()=>{window.clearTimeout(l),o(!0)},u=()=>{l=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return a.addEventListener("pointerenter",c),a.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),a.removeEventListener("pointerenter",c),a.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),f.jsx(Si,{present:n||i,children:f.jsx(Sj,{"data-state":i?"visible":"hidden",...r,ref:e})})}),cte=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=ei(ao,t.__scopeScrollArea),i=t.orientation==="horizontal",o=Uv(()=>l("SCROLL_END"),100),[a,l]=ote("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return y.useEffect(()=>{if(a==="idle"){const c=window.setTimeout(()=>l("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(c)}},[a,s.scrollHideDelay,l]),y.useEffect(()=>{const c=s.viewport,u=i?"scrollLeft":"scrollTop";if(c){let h=c[u];const m=()=>{const p=c[u];h!==p&&(l("SCROLL"),o()),h=p};return c.addEventListener("scroll",m),()=>c.removeEventListener("scroll",m)}},[s.viewport,i,l,o]),f.jsx(Si,{present:n||a!=="hidden",children:f.jsx(_I,{"data-state":a==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:en(t.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:en(t.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),Sj=y.forwardRef((t,e)=>{const n=ei(ao,t.__scopeScrollArea),{forceMount:r,...s}=t,[i,o]=y.useState(!1),a=t.orientation==="horizontal",l=Uv(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;o(a?c:u)}},10);return Id(n.viewport,l),Id(n.content,l),f.jsx(Si,{present:r||i,children:f.jsx(_I,{"data-state":i?"visible":"hidden",...s,ref:e})})}),_I=y.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,s=ei(ao,t.__scopeScrollArea),i=y.useRef(null),o=y.useRef(0),[a,l]=y.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=Pj(a.viewport,a.content),u={...r,sizes:a,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:m=>i.current=m,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:m=>o.current=m};function h(m,p){return pte(m,o.current,a,p)}return n==="horizontal"?f.jsx(ute,{...u,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const m=s.viewport.scrollLeft,p=OP(m,a,s.dir);i.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:m=>{s.viewport&&(s.viewport.scrollLeft=m)},onDragScroll:m=>{s.viewport&&(s.viewport.scrollLeft=h(m,s.dir))}}):n==="vertical"?f.jsx(dte,{...u,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const m=s.viewport.scrollTop,p=OP(m,a);i.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:m=>{s.viewport&&(s.viewport.scrollTop=m)},onDragScroll:m=>{s.viewport&&(s.viewport.scrollTop=h(m))}}):null}),ute=y.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=ei(ao,t.__scopeScrollArea),[o,a]=y.useState(),l=y.useRef(null),c=Qn(e,l,i.onScrollbarXChange);return y.useEffect(()=>{l.current&&a(getComputedStyle(l.current))},[l]),f.jsx(Tj,{"data-orientation":"horizontal",...s,ref:c,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Fv(n)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.x),onDragScroll:u=>t.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(i.viewport){const m=i.viewport.scrollLeft+u.deltaX;t.onWheelScroll(m),Cj(m,h)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:vy(o.paddingLeft),paddingEnd:vy(o.paddingRight)}})}})}),dte=y.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=ei(ao,t.__scopeScrollArea),[o,a]=y.useState(),l=y.useRef(null),c=Qn(e,l,i.onScrollbarYChange);return y.useEffect(()=>{l.current&&a(getComputedStyle(l.current))},[l]),f.jsx(Tj,{"data-orientation":"vertical",...s,ref:c,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Fv(n)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.y),onDragScroll:u=>t.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(i.viewport){const m=i.viewport.scrollTop+u.deltaY;t.onWheelScroll(m),Cj(m,h)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:vy(o.paddingTop),paddingEnd:vy(o.paddingBottom)}})}})}),[hte,Ij]=wj(ao),Tj=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:a,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:h,...m}=t,p=ei(ao,n),[v,g]=y.useState(null),E=Qn(e,R=>g(R)),b=y.useRef(null),_=y.useRef(""),S=p.viewport,P=r.content-r.viewport,T=jr(u),N=jr(l),I=Uv(h,10);function A(R){if(b.current){const k=R.clientX-b.current.left,C=R.clientY-b.current.top;c({x:k,y:C})}}return y.useEffect(()=>{const R=k=>{const C=k.target;(v==null?void 0:v.contains(C))&&T(k,P)};return document.addEventListener("wheel",R,{passive:!1}),()=>document.removeEventListener("wheel",R,{passive:!1})},[S,v,P,T]),y.useEffect(N,[r,N]),Id(v,I),Id(p.content,I),f.jsx(hte,{scope:n,scrollbar:v,hasThumb:s,onThumbChange:jr(i),onThumbPointerUp:jr(o),onThumbPositionChange:N,onThumbPointerDown:jr(a),children:f.jsx(_n.div,{...m,ref:E,style:{position:"absolute",...m.style},onPointerDown:en(t.onPointerDown,R=>{R.button===0&&(R.target.setPointerCapture(R.pointerId),b.current=v.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),A(R))}),onPointerMove:en(t.onPointerMove,A),onPointerUp:en(t.onPointerUp,R=>{const k=R.target;k.hasPointerCapture(R.pointerId)&&k.releasePointerCapture(R.pointerId),document.body.style.webkitUserSelect=_.current,p.viewport&&(p.viewport.style.scrollBehavior=""),b.current=null})})})}),yy="ScrollAreaThumb",xj=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=Ij(yy,t.__scopeScrollArea);return f.jsx(Si,{present:n||s.hasThumb,children:f.jsx(fte,{ref:e,...r})})}),fte=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...s}=t,i=ei(yy,n),o=Ij(yy,n),{onThumbPositionChange:a}=o,l=Qn(e,h=>o.onThumbChange(h)),c=y.useRef(void 0),u=Uv(()=>{c.current&&(c.current(),c.current=void 0)},100);return y.useEffect(()=>{const h=i.viewport;if(h){const m=()=>{if(u(),!c.current){const p=gte(h,a);c.current=p,a()}};return a(),h.addEventListener("scroll",m),()=>h.removeEventListener("scroll",m)}},[i.viewport,u,a]),f.jsx(_n.div,{"data-state":o.hasThumb?"visible":"hidden",...s,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:en(t.onPointerDownCapture,h=>{const p=h.target.getBoundingClientRect(),v=h.clientX-p.left,g=h.clientY-p.top;o.onThumbPointerDown({x:v,y:g})}),onPointerUp:en(t.onPointerUp,o.onThumbPointerUp)})});xj.displayName=yy;var bI="ScrollAreaCorner",Aj=y.forwardRef((t,e)=>{const n=ei(bI,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?f.jsx(mte,{...t,ref:e}):null});Aj.displayName=bI;var mte=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,s=ei(bI,n),[i,o]=y.useState(0),[a,l]=y.useState(0),c=!!(i&&a);return Id(s.scrollbarX,()=>{var h;const u=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(u),l(u)}),Id(s.scrollbarY,()=>{var h;const u=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(u),o(u)}),c?f.jsx(_n.div,{...r,ref:e,style:{width:i,height:a,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function vy(t){return t?parseInt(t,10):0}function Pj(t,e){const n=t/e;return isNaN(n)?0:n}function Fv(t){const e=Pj(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function pte(t,e,n,r="ltr"){const s=Fv(n),i=s/2,o=e||i,a=s-o,l=n.scrollbar.paddingStart+o,c=n.scrollbar.size-n.scrollbar.paddingEnd-a,u=n.content-n.viewport,h=r==="ltr"?[0,u]:[u*-1,0];return Rj([l,c],h)(t)}function OP(t,e,n="ltr"){const r=Fv(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,o=e.content-e.viewport,a=i-r,l=n==="ltr"?[0,o]:[o*-1,0],c=ite(t,l);return Rj([0,o],[0,a])(c)}function Rj(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function Cj(t,e){return t>0&&t<e}var gte=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function s(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,a=n.top!==i.top;(o||a)&&e(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function Uv(t,e){const n=jr(t),r=y.useRef(0);return y.useEffect(()=>()=>window.clearTimeout(r.current),[]),y.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function Id(t,e){const n=jr(e);Zi(()=>{let r=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(t),()=>{window.cancelAnimationFrame(r),s.unobserve(t)}}},[t,n])}var Nj=_j,yte=Ej,vte=Aj;const kj=y.forwardRef(({className:t,children:e,...n},r)=>f.jsxs(Nj,{ref:r,className:yn("relative overflow-hidden",t),...n,children:[f.jsx(yte,{className:"h-full w-full rounded-[inherit]",children:e}),f.jsx(Dj,{}),f.jsx(vte,{})]}));kj.displayName=Nj.displayName;const Dj=y.forwardRef(({className:t,orientation:e="vertical",...n},r)=>f.jsx(wI,{ref:r,orientation:e,className:yn("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-3 bg-muted rounded-md p-[2px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:f.jsx(xj,{className:"relative flex-1 rounded-full bg-gray-400 hover:bg-gray-500 transition-colors"})}));Dj.displayName=wI.displayName;const wte=()=>{const[t,e]=y.useState(!1),[n,r]=y.useState([]),[s,i]=y.useState(!1);ll(),y.useRef([]),y.useEffect(()=>{const u=h=>{var m;if((m=h.detail)!=null&&m.isPending){const p={id:`pending-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,data:h.detail,status:"pending",receivedAt:Date.now()};r(v=>v.some(E=>E.data.postedAt===p.data.postedAt&&E.data.text===p.data.text)?v:[...v,p]),e(!0)}};return window.addEventListener("vfNotificationReceived",u),()=>{window.removeEventListener("vfNotificationReceived",u)}},[]),y.useEffect(()=>{t&&n.some(u=>u.status==="pending")&&!s&&o()},[t,n,s]);const o=async()=>{i(!0);const u=n.findIndex(m=>m.status==="pending");if(u===-1){i(!1);return}const h=n[u];a(h.id,"processing"),await new Promise(m=>setTimeout(m,800));try{const{isPending:m,...p}=h.data;await Zp(p,{toast:()=>{}}),a(h.id,"success")}catch(m){console.error("Error processing pending transaction",m),a(h.id,"error"," ")}i(!1)},a=(u,h,m)=>{r(p=>p.map(v=>v.id===u?{...v,status:h,errorMessage:m}:v))},l=()=>{e(!1),setTimeout(()=>{r(u=>u.filter(h=>h.status!=="success"))},500)},c=n.length>0&&n.every(u=>u.status==="success"||u.status==="error");return!t&&n.length===0?null:f.jsx(Ba,{open:t,onOpenChange:u=>!u&&c&&l(),children:f.jsxs(xo,{className:"sm:max-w-md",onPointerDownOutside:u=>!c&&u.preventDefault(),children:[f.jsxs(rl,{children:[f.jsx(sl,{className:"text-center text-xl mb-2",children:" "}),f.jsx("p",{className:"text-center text-muted-foreground text-sm",children:"          "})]}),f.jsx(kj,{className:"max-h-[60vh] mt-4 pr-4",children:f.jsx("div",{className:"space-y-4",children:n.map(u=>f.jsxs("div",{className:`p-4 rounded-lg border flex items-center justify-between transition-colors duration-300 ${u.status==="success"?"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800":u.status==="error"?"bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800":"bg-card border-border"}`,children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("span",{className:"font-bold text-lg",children:u.data.amount?`${Number(u.data.amount).toLocaleString("en-US",{maximumFractionDigits:0})} .`:"  "}),f.jsx("span",{className:"text-xs text-muted-foreground bg-secondary px-2 py-0.5 rounded-full",children:new Date(u.data.postedAt||Date.now()).toLocaleTimeString("ar-EG")})]}),f.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:u.data.text||u.data.title||"  "}),u.errorMessage&&f.jsx("p",{className:"text-xs text-red-500 mt-1",children:u.errorMessage})]}),f.jsxs("div",{className:"mr-4 flex-shrink-0",children:[u.status==="pending"&&f.jsx("div",{className:"h-8 w-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center animate-pulse",children:f.jsx(Ui,{className:"h-5 w-5"})}),u.status==="processing"&&f.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center",children:f.jsx(hE,{className:"h-5 w-5 animate-spin"})}),u.status==="success"&&f.jsx("div",{className:"h-8 w-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center animate-in zoom-in duration-300",children:f.jsx(pk,{className:"h-5 w-5"})}),u.status==="error"&&f.jsx("div",{className:"h-8 w-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center",children:f.jsx(Ui,{className:"h-5 w-5"})})]})]},u.id))})}),f.jsx("div",{className:"mt-6 flex justify-center",children:f.jsx(wt,{onClick:l,disabled:!c,className:`w-full transition-all duration-300 ${c?"bg-green-600 hover:bg-green-700":""}`,children:c?"  ":" ..."})})]})})},_te={},LP=V.lazy(()=>ee(()=>import("./Index-CEJy6Ib5.js"),[],import.meta.url)),yp=V.lazy(()=>ee(()=>import("./LandingPage-2FeRsCUb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url)),MP=V.lazy(()=>ee(()=>import("./SubscriptionsPage-B0tq67oA.js"),__vite__mapDeps([9,10,11,1,2,12,7]),import.meta.url)),VP=V.lazy(()=>ee(()=>import("./AuthPage-Dr6lFGi5.js"),__vite__mapDeps([13,5,3]),import.meta.url)),vp=V.lazy(()=>ee(()=>import("./TopUpPage-CMMAKE2g.js"),__vite__mapDeps([14,15]),import.meta.url)),jP=V.lazy(()=>ee(()=>import("./AdminTopupsPage-BQDfBGeH.js"),__vite__mapDeps([16,15]),import.meta.url)),FP=V.lazy(()=>ee(()=>import("./AdminNotificationsPage-DL6D70pW.js"),__vite__mapDeps([17,18,19]),import.meta.url)),wp=V.lazy(()=>ee(()=>import("./UserRegisterPage-CEg2Fust.js"),__vite__mapDeps([20,21,22,23]),import.meta.url)),UP=V.lazy(()=>ee(()=>import("./UserAccountSetupPage-DtlCxBSG.js"),__vite__mapDeps([24,21,7]),import.meta.url)),$P=V.lazy(()=>ee(()=>import("./ForgotPasswordCodePage-JCbQZXZL.js"),[],import.meta.url)),BP=V.lazy(()=>ee(()=>import("./DashboardLoginPage-DgtU-XYM.js"),[],import.meta.url)),zP=V.lazy(()=>ee(()=>import("./ProtectedDashboard-ClOH56K2.js"),__vite__mapDeps([25,15,22,26,27,28]),import.meta.url)),tg=V.lazy(()=>ee(()=>import("./ProtectedUserDashboard-zE0zQwvA.js"),__vite__mapDeps([29,30,19]),import.meta.url)),WP=V.lazy(()=>ee(()=>import("./MerchantDashboard-B9wPntSJ.js"),__vite__mapDeps([31,32,33,34,35,15,36,37,38,22,2,39,5,40]),import.meta.url)),qP=V.lazy(()=>ee(()=>import("./PendingApprovalPage-TVRqpaRE.js"),__vite__mapDeps([41,42]),import.meta.url)),HP=V.lazy(()=>ee(()=>import("./AdminLogin-pg4vuWad.js"),[],import.meta.url)),KP=V.lazy(()=>ee(()=>import("./ProtectedAdminDashboard-BIpEuHrG.js").then(t=>t.P),__vite__mapDeps([43,10,44,32,33,45,42,21,46,39,47,30,18,11,15,6,8,1,7,48,49,40,35,5,50,51,3,52]),import.meta.url)),GP=V.lazy(()=>ee(()=>import("./AuthTestPage-Cs6R6AYQ.js"),[],import.meta.url)),QP=V.lazy(()=>ee(()=>import("./ProfileSettingsPage-6rJ-8Y1I.js").then(t=>t.b),__vite__mapDeps([53,45,40,54,15,50,27,7,39,8,2]),import.meta.url)),YP=V.lazy(()=>ee(()=>import("./TransactionsPage-C9z5VyWw.js"),__vite__mapDeps([55,15,49,33,56,57,46,37,7,38,5,58,54,11,59,52,27,60,26,61,62,48,50,63,39,28,2,64]),import.meta.url)),JP=V.lazy(()=>ee(()=>import("./WalletAdditionPage-DEGm7k8O.js"),__vite__mapDeps([65,15,2,22,66]),import.meta.url)),XP=V.lazy(()=>ee(()=>import("./ReferralsPage-CkAbKvk4.js"),__vite__mapDeps([67,21,23,19,7,47,50]),import.meta.url)),ZP=V.lazy(()=>ee(()=>import("./NotFound-B36LpG8t.js"),[],import.meta.url)),eR=V.lazy(()=>ee(()=>import("./PrivacyPolicyPage-BXCM6Jrt.js"),[],import.meta.url)),jl=new m9({defaultOptions:{queries:{gcTime:3e5}}});if(typeof window<"u")try{const t=_9({storage:window.localStorage,key:"cashylink:rq-cache",throttleTime:1e3});w9({queryClient:jl,persister:t,maxAge:24*60*60*1e3})}catch{}const bte=()=>{if(!((Te==null?void 0:Te.isNativePlatform)&&Te.getPlatform()==="android"))return null;const e=()=>{try{window.location.reload()}catch{}};return f.jsx("div",{className:"fixed right-2 z-[2000] flex items-center gap-2",style:{pointerEvents:"auto",top:"calc(env(safe-area-inset-top, 0px) + 24px)"},children:f.jsx("button",{type:"button","aria-label":"",title:" ",onClick:e,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-blue-600 hover:bg-blue-500/10 focus:outline-none dark:text-blue-400 dark:hover:bg-blue-400/10",children:f.jsx(fE,{className:"w-5 h-5"})})})},tR=()=>{const t=Ii(),{user:e,loading:n}=Zs(),r=(Te==null?void 0:Te.isNativePlatform)&&Te.getPlatform()==="android",s=t.pathname.startsWith("/user/dashboard"),i=r&&t.pathname==="/",o=!!e&&(s||i);return n?null:o?f.jsx(vee,{}):null},Ete=(t,e)=>{try{const n=String(e||"").toLowerCase(),r=String(t||"").toLowerCase();return!!(n.includes("vf-cash")||n.includes("vodafone")||n.includes("vfcash")||n.includes("etisalat")||n.includes("e&")||/\s*|etisalat|e&|money/i.test(t)||r.includes("vodafone cash")||r.includes("etisalat cash")||/Received\s*EGP/i.test(t))}catch{return!1}},o_=async t=>{try{const e=String(localStorage.getItem(`selectedWallet_${t}`)||"").trim();if(!e)return"";const{merchantWalletService:n}=await ee(async()=>{const{merchantWalletService:c}=await Promise.resolve().then(()=>Di);return{merchantWalletService:c}},void 0,import.meta.url),r=await n.getByMerchantId(t),s=localStorage.getItem(`wallets_${t}`),i=s?JSON.parse(s):[],a=[...Array.isArray(i)?i:[],...Array.isArray(r)?r:[]].find(c=>String((c==null?void 0:c.id)||"")===e);return String((a==null?void 0:a.msisdn)||(a==null?void 0:a.phone)||"")}catch{return""}},nR=async t=>{var e;try{const n=Object.keys(localStorage),r=`selectedWallet_${t}`,s=`wallets_${t}`,i=n.find(h=>h.startsWith(r));if(i){const h=localStorage.getItem(i)||"";if(h)return h}const{merchantWalletService:o}=await ee(async()=>{const{merchantWalletService:h}=await Promise.resolve().then(()=>Di);return{merchantWalletService:h}},void 0,import.meta.url),a=await o.getByMerchantId(t),l=localStorage.getItem(s),c=l?JSON.parse(l):[],u=[...Array.isArray(c)?c:[],...Array.isArray(a)?a:[]];if(u.length>0){const h=u.find(p=>!!(p!=null&&p.isDefault)),m=String(((h==null?void 0:h.id)??((e=u[0])==null?void 0:e.id))||"").trim();if(m)return m}}catch{}return""},rR=()=>{const t=fj(),e=(Te==null?void 0:Te.isNativePlatform)&&Te.getPlatform()==="android",{profile:n,user:r}=Zs(),{shopId:s}=tte(),i=Ii(),o=(Te==null?void 0:Te.isNativePlatform)&&Te.getPlatform()==="android"&&i.pathname==="/"&&!!r;V.useEffect(()=>{(async()=>{if(Te.isNativePlatform())try{await ta.setOverlaysWebView({overlay:!1}),await ta.setStyle({style:py.Light}),Te.getPlatform()==="android"&&(await ta.setBackgroundColor({color:"#FFFFFF"}),await ta.show())}catch(j){console.warn("StatusBar config failed",j)}})(),(async()=>{if(Te.isNativePlatform()&&Te.getPlatform()==="android")try{await ta.setOverlaysWebView({overlay:!1}),await ta.setBackgroundColor({color:"#FFFFFF"}),await ta.setStyle({style:py.Light}),await ta.show()}catch(j){console.warn("StatusBar re-config failed",j)}})()},[i.pathname]),V.useEffect(()=>{if(!e||!(r!=null&&r.uid))return;const M=async()=>{try{const j=await nR(r.uid),Z=j,K=s||"";if(window.CashyAndroid&&(window.CashyAndroid.setUserId&&window.CashyAndroid.setUserId(r.uid),window.CashyAndroid.setContext&&window.CashyAndroid.setContext(K,j,Z),window.CashyAndroid.setAutoTransferRecord)){const oe=localStorage.getItem("autoTransferRecord")==="true";window.CashyAndroid.setAutoTransferRecord(oe)}}catch(j){console.error("Context Sync Error",j)}};M();const z=setInterval(M,1e4);return()=>clearInterval(z)},[e,r==null?void 0:r.uid,s]),V.useEffect(()=>{const M=window.electronAPI;if(M){try{const z=localStorage.getItem("adbSmsReadingEnabled")==="true";M.toggleAdbSms&&M.toggleAdbSms(z)}catch{}M.onAdbSmsReceived&&M.onAdbSmsReceived(z=>{console.log("[App] ADB SMS Received:",z);const j={text:z.text,sender:z.sender,msisdn:z.sender,receivedAt:Date.now()};window.dispatchEvent(new CustomEvent("mobileSmsReceived",{detail:j}))})}},[]);const a=i.pathname.startsWith("/user/login")||i.pathname.startsWith("/auth")||i.pathname.startsWith("/landing")||i.pathname==="/"&&!o&&!r,l=!!r&&!a||i.pathname.startsWith("/user/dashboard")||o;V.useEffect(()=>{r&&console.log("Dashboard State Check:",{path:i.pathname,isUserDashboard:l,isAuthOrLanding:a,userUid:r.uid})},[i.pathname,l,r]);const c=io(),{toast:u}=ll(),[h,m]=V.useState(!1),[p,v]=V.useState(null),[g,E]=V.useState(!1),[b,_]=V.useState(null),[S,P]=V.useState(!1),[T,N]=V.useState(""),[I,A]=V.useState(""),[R,k]=V.useState(null),[C,L]=V.useState(null),O=V.useRef(null),X=V.useRef(null),Ne=V.useRef(!1),Le=V.useRef(null),Fe=V.useRef(""),W=V.useRef(""),Y=V.useRef(new Set);V.useEffect(()=>{try{const M=localStorage.getItem("sms_suppressed_ids")||"[]",z=Array.isArray(JSON.parse(M))?JSON.parse(M):[];Y.current=new Set(z.map(j=>String(j||"")))}catch{}},[]);const[le,pe]=V.useState(!1),fe=V.useRef(n),Ge=V.useRef([]);V.useEffect(()=>{fe.current=n},[n]),V.useEffect(()=>{if(!(r!=null&&r.uid))return;let M;return(async()=>{try{const{collection:z,query:j,where:Z,onSnapshot:K}=await ee(async()=>{const{collection:Ae,query:st,where:te,onSnapshot:ne}=await Promise.resolve().then(()=>kn);return{collection:Ae,query:st,where:te,onSnapshot:ne}},void 0,import.meta.url),{db:oe}=await ee(async()=>{const{db:Ae}=await Promise.resolve().then(()=>En);return{db:Ae}},void 0,import.meta.url),H=j(z(oe,"wallets"),Z("userId","==",r.uid));M=K(H,Ae=>{Ge.current=Ae.docs.map(st=>({id:st.id,...st.data()}))})}catch{}})(),()=>{M&&M()}},[r==null?void 0:r.uid]),Zee(),V.useEffect(()=>{const M=z=>{};return window.addEventListener("notificationListenerStatus",M),()=>window.removeEventListener("notificationListenerStatus",M)},[u,e]);const[Ie,ve]=V.useState(!1),[J,qe]=V.useState(null),[dn,dr]=V.useState(""),[Xn,sr]=V.useState(!1),[Dr,Or]=V.useState(!1),[Lr,Q]=V.useState(""),[de,_e]=V.useState(""),[nt,he]=V.useState(!1),[Ce,Ue]=V.useState(0),[rt,lt]=V.useState(!1),[Lt,Ct]=V.useState(""),[q,ge]=V.useState("");V.useEffect(()=>{try{const M=(r==null?void 0:r.uid)||"default",z=localStorage.getItem(`sim1Number_${M}`)??localStorage.getItem("sim1Number")??"",j=localStorage.getItem(`sim2Number_${M}`)??localStorage.getItem("sim2Number")??"";Ct(z),ge(j),Fe.current=z,W.current=j}catch{}},[r==null?void 0:r.uid]);const ke=V.useCallback(()=>{try{localStorage.setItem("privacyPolicyAccepted","true")}catch{}lt(!1);try{c("/user/login")}catch{}},[c]);V.useEffect(()=>{lt(!1)},[r,e]);const Re=V.useCallback(()=>{try{const M=window.AudioContext||window.webkitAudioContext;if(!M)return;const z=new M,j=z.createOscillator(),Z=z.createGain();j.type="sine",Z.gain.setValueAtTime(0,z.currentTime),j.connect(Z),Z.connect(z.destination);const K=z.currentTime;j.frequency.setValueAtTime(800,K),Z.gain.linearRampToValueAtTime(.15,K+.02),j.start(K),j.frequency.exponentialRampToValueAtTime(1200,K+.08),Z.gain.exponentialRampToValueAtTime(1e-5,K+.32),j.stop(K+.35)}catch{}},[]),ue=V.useCallback(()=>{try{const M=window.AudioContext||window.webkitAudioContext;if(!M)return;const z=new M,j=z.createOscillator(),Z=z.createGain();j.type="sawtooth",Z.gain.setValueAtTime(.5,z.currentTime),j.connect(Z),Z.connect(z.destination);const K=z.currentTime;j.start(K);for(let oe=0;oe<14;oe++){const H=K+oe*.5;j.frequency.setValueAtTime(600,H),j.frequency.linearRampToValueAtTime(800,H+.25),j.frequency.setValueAtTime(800,H+.25),j.frequency.linearRampToValueAtTime(600,H+.5)}j.stop(K+7)}catch{}},[]),ae=M=>{try{const z=String(M||"").replace(/[^0-9+]/g,"");if(!z)return"";if(z.startsWith("+20")){const j=z.slice(3);return j.startsWith("1")?"0"+j:j}if(z.startsWith("0020")){const j=z.slice(4);return j.startsWith("1")?"0"+j:j}if(z.startsWith("20")){const j=z.slice(2);return j.startsWith("1")?"0"+j:j}return z.startsWith("0")?z:/^(10|11|12|15)/.test(z)?"0"+z:z}catch{return""}};V.useEffect(()=>{(async()=>{var M;try{if(!Ie||!J){sr(!1);return}const{auth:z}=await ee(async()=>{const{auth:oe}=await Promise.resolve().then(()=>En);return{auth:oe}},void 0,import.meta.url),j=((M=z.currentUser)==null?void 0:M.uid)||"",Z=j?`selectedWallet_${j}`:"selectedWallet_default",K=localStorage.getItem(Z)||"";if(!K){sr(!0);return}try{const{merchantWalletService:oe}=await ee(async()=>{const{merchantWalletService:st}=await Promise.resolve().then(()=>uo);return{merchantWalletService:st}},void 0,import.meta.url),H=await oe.getById(K),Ae=H&&H.defaultWithdrawCommission!=null;sr(!Ae)}catch{sr(!0)}}catch{sr(!0)}})()},[Ie,J]);const Tt=async M=>{try{const{merchantWalletService:z,detectWalletFromSim:j}=await ee(async()=>{const{merchantWalletService:ne,detectWalletFromSim:be}=await Promise.resolve().then(()=>Di);return{merchantWalletService:ne,detectWalletFromSim:be}},void 0,import.meta.url),Z=(r==null?void 0:r.uid)||"";if(!Z)return;const K=`wallets_${Z}`,oe=typeof localStorage<"u"?localStorage.getItem(K):null,H=oe?JSON.parse(oe):[],Ae=await z.getByMerchantId(Z),st=[...(Array.isArray(H)?H:[]).map(ne=>({id:String((ne==null?void 0:ne.id)||""),phone:String((ne==null?void 0:ne.phone)||(ne==null?void 0:ne.msisdn)||""),isDefault:!!(ne!=null&&ne.isDefault)})),...(Array.isArray(Ae)?Ae:[]).map(ne=>({id:String((ne==null?void 0:ne.id)||""),msisdn:String((ne==null?void 0:ne.msisdn)||""),isDefault:!!(ne!=null&&ne.isDefault)}))],te=await j(M||[],st);if(te&&te.walletId)try{localStorage.setItem(`selectedWallet_${Z}`,te.walletId)}catch{}}catch{}};y.useEffect(()=>{const M=async z=>{var j,Z,K,oe,H,Ae,st;try{const te=(z==null?void 0:z.detail)||{};if(te.isPending){console.log("Skipping pending transaction in main listener (delegated to PendingTransactionsDialog)",te);return}const ne=String(te.text||"").trim(),be=String(te.title||"").trim();if(!ne)return;if(!/vodafone|vf\-?cash|||\s*[]?\s*|\s*|\s*|instapay|received\s*egp|transaction|etisalat|e&|money|/i.test(`${be} ${ne}`)){try{Zp(te,{toast:u})}catch{}return}const Qe={...te,slot:te.simSlot,sender:te.sender||te.senderMsisdn};window.dispatchEvent(new CustomEvent("vfCashTransactionDetected",{detail:Qe}));return;if(!ut){try{u({title:"  ",description:"   "})}catch{}return}if(!Pe)try{const{doc:xt,getDoc:gt}=await ee(async()=>{const{doc:at,getDoc:De}=await Promise.resolve().then(()=>kn);return{doc:at,getDoc:De}},void 0,import.meta.url),{db:ln}=await ee(async()=>{const{db:at}=await Promise.resolve().then(()=>En);return{db:at}},void 0,import.meta.url),He=await gt(xt(ln,"profiles",ut));if(He.exists()){const at=He.data(),De=String((at==null?void 0:at.shopId)||"").trim();De&&(Pe=De)}}catch{}try{const xt=ut||"default";it=(localStorage.getItem(`sim1Number_${xt}`)??localStorage.getItem("sim1Number")??"").trim(),Bt=(localStorage.getItem(`sim2Number_${xt}`)??localStorage.getItem("sim2Number")??"").trim();const gt=localStorage.getItem(`smsAutoRegisterEnabled_${xt}`)??localStorage.getItem("smsAutoRegisterEnabled"),ln=((K=fe.current)==null?void 0:K.smsAutoRegisterEnabled)===!0;St=gt==="true"||ln}catch{}try{const xt=((oe=fe.current)==null?void 0:oe.smsReadingEnabled)!==void 0?!!fe.current.smsReadingEnabled:localStorage.getItem("smsReadingEnabled")==="true",gt=localStorage.getItem("adbSmsReadingEnabled")==="true";if(!xt&&!gt&&!St)return}catch{}try{const{Preferences:xt}=await ee(async()=>{const{Preferences:He}=await Promise.resolve().then(()=>cp);return{Preferences:He}},void 0,import.meta.url),gt=await xt.get({key:"sim1_number"}),ln=await xt.get({key:"sim2_number"});!it&&(gt!=null&&gt.value)&&(it=String(gt.value).trim()),!Bt&&(ln!=null&&ln.value)&&(Bt=String(ln.value).trim()),!it&&Fe.current&&(it=Fe.current),!Bt&&W.current&&(Bt=W.current)}catch{}try{localStorage.setItem("lastActiveSimMsisdns",JSON.stringify(ct))}catch{}try{if(!Ve){const xt=localStorage.getItem("lastSmsSimMsisdn")||"";xt&&ct.includes(xt)&&(Ve=xt)}}catch{}if(Ve)try{localStorage.setItem("lastSmsSimMsisdn",Ve)}catch{}if(!Pn||Pn<=0){try{Zp(te,{toast:u})}catch{}return}if(Vt.type==="transfer")try{await _t({...an,reference:on,walletMsisdn:dt})}catch{}else{const xt=St;try{const{addDoc:gt,collection:ln,serverTimestamp:He}=await ee(async()=>{const{addDoc:$e,collection:se,serverTimestamp:Xe}=await Promise.resolve().then(()=>kn);return{addDoc:$e,collection:se,serverTimestamp:Xe}},void 0,import.meta.url),{db:at}=await ee(async()=>{const{db:$e}=await Promise.resolve().then(()=>En);return{db:$e}},void 0,import.meta.url),De=await gt(ln(at,"pendingSmsPopups"),{userId:ut,shopId:Pe,payload:{...an,reference:on,walletMsisdn:dt,sim1Number:it,sim2Number:Bt,autoConfirm:xt,autoConfirmDuration:Number(((H=fe.current)==null?void 0:H.smsAutoConfirmDuration)??5)},status:"pending",createdAt:He()}),tt=/Received\s*EGP/i.test(String(ne))?"InstaPay":/etisalat|e&|/i.test(String(ne))?"Etisalat Cash":"VF-Cash";qe({...an,reference:on,providerLabel:tt,walletMsisdn:dt,popupId:De.id,autoConfirm:xt,autoConfirmDuration:Number(((Ae=fe.current)==null?void 0:Ae.smsAutoConfirmDuration)??5),isLocal:!0})}catch{const gt=/Received\s*EGP/i.test(String(ne))?"InstaPay":/etisalat|e&|/i.test(String(ne))?"Etisalat Cash":"VF-Cash";qe({...an,reference:on,providerLabel:gt,walletMsisdn:dt,autoConfirm:xt,autoConfirmDuration:Number(((st=fe.current)==null?void 0:st.smsAutoConfirmDuration)??5),isLocal:!0})}ve(!0);try{Re()}catch{}}}catch{try{Zp((z==null?void 0:z.detail)||{},{toast:u})}catch{}}};try{window.addEventListener("vfNotificationReceived",M)}catch{}return()=>{try{window.removeEventListener("vfNotificationReceived",M)}catch{}}},[u,s]),y.useEffect(()=>{const M=window.electronAPI;M&&typeof M.onAdbSmsReceived=="function"&&M.onAdbSmsReceived(z=>{const j={sender:z.sender,text:z.text,msisdn:z.sender,deviceId:z.deviceId,timestamp:Date.now()};window.dispatchEvent(new CustomEvent("mobileSmsReceived",{detail:j}))})},[]),y.useEffect(()=>{const M=async z=>{try{const j=(z==null?void 0:z.detail)||{},Z=String(j.text||"");if(!Z)return;const K=(n==null?void 0:n.smsReadingEnabled)!==void 0?!!n.smsReadingEnabled:localStorage.getItem("smsReadingEnabled")==="true",oe=localStorage.getItem("adbSmsReadingEnabled")==="true",H=(r==null?void 0:r.uid)||"",Ae=H?`smsAutoRegisterEnabled_${H}`:"smsAutoRegisterEnabled",te=(localStorage.getItem(Ae)??localStorage.getItem("smsAutoRegisterEnabled"))==="true"||(n==null?void 0:n.smsAutoRegisterEnabled)===!0;if(!K&&!oe&&!te)return;const ne=/Received\s*EGP/i.test(Z),be=/etisalat|e&|/i.test(Z),ze=Ete(Z,String(j.sender||j.msisdn||"")),Qe=/(?:\s*?\s*|?\s*|\s*|Deposit|\s*|\s*)/i.test(Z);if(!ne&&!ze&&!be&&!Qe||!H)return;let ft=s||(n==null?void 0:n.shopId)||localStorage.getItem("shopId")||"";const ut=fe.current;let Pe=(ut==null?void 0:ut.sim1Number)||"",it=(ut==null?void 0:ut.sim2Number)||"";Pe||(Pe=localStorage.getItem(`sim1Number_${userId}`)||localStorage.getItem("sim1Number")||""),it||(it=localStorage.getItem(`sim2Number_${userId}`)||localStorage.getItem("sim2Number")||""),!Pe&&Fe.current&&(Pe=Fe.current),!it&&W.current&&(it=W.current),Pe=String(Pe).trim(),it=String(it).trim();const Bt=String(j.msisdn||j.sender||""),St=ae(Bt),ct=Cu(Z);let Pt=Number(ct.amount||0),Ve=ct.sender||St||String(j.sender||""),cn=ct.senderName,Vt=ct.reference||"";if(ne){const $e=String(Z).match(/Received\s*EGP\s*([0-9.,]+)/i)||String(Z).match(/Received\s*EGP([0-9.,]+)/i);$e&&(Pt=parseFloat(String($e[1]).replace(/,/g,"")));const se=String(Z).match(/from\s+([0-9+]+)/i);se&&(Ve=ae(se[1]));const Xe=String(Z).match(/Ref:\s*([A-Za-z0-9\-]+)/i);Xe&&(Vt=String(Xe[1]).trim())}const Pn=ct.receiverAccountTail;if(!Pt||Pt<=0)return;let dt="",Yt="";const on=[Pe,it].filter(Boolean).map($e=>ae($e));if(St&&on.includes(St)&&(dt=St,dt===ae(Pe)?Yt="SIM 1":dt===ae(it)&&(Yt="SIM 2")),(j==null?void 0:j.slot)!==void 0&&(j==null?void 0:j.slot)!==null){const $e=Number(j.slot),se=Ge.current||[];if($e===0){if(Yt="SIM 1",Pe)dt=ae(Pe);else if(se.length>0){const Xe=it?ae(it):"",vt=se.find(zt=>ae(zt.phoneNumber)!==Xe);vt&&(dt=ae(vt.phoneNumber))}}else if($e===1){if(Yt="SIM 2",it)dt=ae(it);else if(se.length>0){const Xe=Pe?ae(Pe):"",vt=se.find(zt=>ae(zt.phoneNumber)!==Xe);if(se.length>1){const zt=se[1];dt=ae(zt.phoneNumber)}else vt&&(dt=ae(vt.phoneNumber))}}}!Yt&&dt&&(dt===ae(Pe)?Yt="SIM 1":dt===ae(it)&&(Yt="SIM 2"));const an=ne?"InstaPay":be?"Etisalat Cash":"VF-Cash",xt=String(j.sender||j.msisdn||""),gt=/VF-Cash|Vodafone|Etisalat|e&|InstaPay/i.test(xt),ln=/Received\s*EGP/i.test(Z)&&/Ref:/i.test(Z),He=!gt&&!ln,at={amount:Pt,sender:Ve,senderName:cn,text:Z,simNumber:dt,simLabel:Yt,lineId:j==null?void 0:j.slot,isFakeSender:He,type:ct.type},De=localStorage.getItem("autoTransferRecord")==="true",tt=!He&&(te||ct.type==="transfer"&&De);if(!tt)if(qe({...at,reference:Vt,providerLabel:an,walletMsisdn:dt}),ve(!0),He)try{ue()}catch{}else try{Re()}catch{}(async()=>{var $e;try{const{resolveWalletBySimOrSlot:se,bindSlotWalletMapping:Xe,merchantWalletService:vt}=await ee(async()=>{const{resolveWalletBySimOrSlot:Ke,bindSlotWalletMapping:In,merchantWalletService:jt}=await Promise.resolve().then(()=>Di);return{resolveWalletBySimOrSlot:Ke,bindSlotWalletMapping:In,merchantWalletService:jt}},void 0,import.meta.url);let zt=Array.isArray(j.activeSimMsisdns)&&j.activeSimMsisdns.length>0?j.activeSimMsisdns.map(Ke=>ae(String(Ke||""))):St?[St]:[];zt.length===0&&(zt=[ae(Pe),ae(it)].filter(Boolean));let un=await se({simNumbers:zt,subId:Number((j==null?void 0:j.subId)||-1),slotIndex:Number((j==null?void 0:j.slot)||-1),userId:H});if(!un&&zt.length>0){try{await Tt(zt)}catch{}const Ke=localStorage.getItem(`selectedWallet_${H}`)||"";if(Ke)try{const In=await vt.getById(Ke),jt=String((In==null?void 0:In.msisdn)||"");(!dt||ae(jt)===ae(dt))&&(un={walletId:Ke,msisdn:jt})}catch{}}if(un&&un.walletId){try{localStorage.setItem(`selectedWallet_${H}`,un.walletId)}catch{}try{Xe({userId:H,subId:Number((j==null?void 0:j.subId)||-1),slotIndex:Number((j==null?void 0:j.slot)||-1),walletId:un.walletId,msisdn:un.msisdn})}catch{}}const Jt=(un==null?void 0:un.msisdn)||dt||(H?await o_(H):"");if(qe(Ke=>Ke?{...Ke,walletMsisdn:(un==null?void 0:un.msisdn)||dt,simNumber:dt,simLabel:Yt||Ke.simLabel}:null),tt)try{await _t({...at,reference:Vt,walletMsisdn:Jt,walletId:un==null?void 0:un.walletId,sim1Number:Pe,sim2Number:it})}catch(Ke){console.error("Auto-register failed",Ke)}else try{const{addDoc:Ke,collection:In,serverTimestamp:jt}=await ee(async()=>{const{addDoc:Ze,collection:Kt,serverTimestamp:yt}=await Promise.resolve().then(()=>kn);return{addDoc:Ze,collection:Kt,serverTimestamp:yt}},void 0,import.meta.url),{db:Xt}=await ee(async()=>{const{db:Ze}=await Promise.resolve().then(()=>En);return{db:Ze}},void 0,import.meta.url),ir=await Ke(In(Xt,"pendingSmsPopups"),{userId:H,shopId:ft,payload:{...at,reference:Vt,walletMsisdn:Jt,sim1Number:Pe,sim2Number:it,autoConfirm:!1,autoConfirmDuration:Number((($e=fe.current)==null?void 0:$e.smsAutoConfirmDuration)??5)},status:"pending",createdAt:jt()});qe(Ze=>{var yt;return{...Ze||{...at,reference:Vt,walletMsisdn:Jt},popupId:ir.id,autoConfirm:!1,autoConfirmDuration:Number(((yt=fe.current)==null?void 0:yt.smsAutoConfirmDuration)??5),isLocal:!0}}),ve(!0)}catch(Ke){console.error("Error creating pending popup",Ke),qe(In=>{var Xt;return{...In||{...at,reference:Vt,walletMsisdn:Jt},autoConfirm:!1,autoConfirmDuration:Number(((Xt=fe.current)==null?void 0:Xt.smsAutoConfirmDuration)??5),isLocal:!0}}),ve(!0)}}catch(se){console.error("Background SMS processing error",se)}})()}catch(j){console.error("SMS Handler Error",j)}};try{window.addEventListener("mobileSmsReceived",M)}catch{}return()=>{try{window.removeEventListener("mobileSmsReceived",M)}catch{}}},[u,s,n,r]),y.useEffect(()=>{const M=async z=>{var j,Z,K,oe;try{const H=(z==null?void 0:z.detail)||{},Ae=Number(H.amount||0),st=String(H.sender||H.senderMsisdn||""),te=Array.isArray(H.activeSimMsisdns)?H.activeSimMsisdns.map(He=>String(He||"")):[];try{console.log("VF Auto SMS  activeSimMsisdns",te)}catch{}const ne=String(H.text||""),be=Ae,{auth:ze}=await ee(async()=>{const{auth:He}=await Promise.resolve().then(()=>En);return{auth:He}},void 0,import.meta.url),Qe=((j=ze.currentUser)==null?void 0:j.uid)||"";let ft=s||"";if(!Qe)try{u({title:"  ",description:"   "})}catch{}if(!ft)try{const{doc:He,getDoc:at}=await ee(async()=>{const{doc:$e,getDoc:se}=await Promise.resolve().then(()=>kn);return{doc:$e,getDoc:se}},void 0,import.meta.url),{db:De}=await ee(async()=>{const{db:$e}=await Promise.resolve().then(()=>En);return{db:$e}},void 0,import.meta.url),tt=await at(He(De,"profiles",Qe));if(tt.exists()){const $e=tt.data(),se=String(($e==null?void 0:$e.shopId)||"").trim();se&&(ft=se)}}catch{}if(!ft)try{u({title:"  ",description:"   "})}catch{}try{const{doc:He,getDoc:at}=await ee(async()=>{const{doc:$e,getDoc:se}=await Promise.resolve().then(()=>kn);return{doc:$e,getDoc:se}},void 0,import.meta.url),{db:De}=await ee(async()=>{const{db:$e}=await Promise.resolve().then(()=>En);return{db:$e}},void 0,import.meta.url);sim1=localStorage.getItem(`sim1Number_${Qe}`)||localStorage.getItem("sim1Number")||"",sim2=localStorage.getItem(`sim2Number_${Qe}`)||localStorage.getItem("sim2Number")||"",!sim1&&Fe.current&&(sim1=Fe.current),!sim2&&W.current&&(sim2=W.current);const tt=fe.current;if(tt)smsEnabled=(tt==null?void 0:tt.smsReadingEnabled)!==void 0?!!tt.smsReadingEnabled:!1,smsAutoRegister=(tt==null?void 0:tt.smsAutoRegisterEnabled)===!0;else try{const $e=await at(He(De,"profiles",Qe));if($e.exists()){const se=$e.data();smsEnabled=(se==null?void 0:se.smsReadingEnabled)!==void 0?!!se.smsReadingEnabled:!1,smsAutoRegister=(se==null?void 0:se.smsAutoRegisterEnabled)===!0}}catch{}}catch{}try{if(!sim1){const He=localStorage.getItem(`sim1Number_${Qe}`)??localStorage.getItem("sim1Number");He&&(sim1=String(He).trim())}if(!sim2){const He=localStorage.getItem(`sim2Number_${Qe}`)??localStorage.getItem("sim2Number");He&&(sim2=String(He).trim())}}catch{}try{const{Preferences:He}=await ee(async()=>{const{Preferences:at}=await Promise.resolve().then(()=>cp);return{Preferences:at}},void 0,import.meta.url);if(!sim1){const at=await He.get({key:"sim1_number"});at!=null&&at.value&&(sim1=String(at.value).trim())}if(!sim2){const at=await He.get({key:"sim2_number"});at!=null&&at.value&&(sim2=String(at.value).trim())}}catch{}const ut=smsEnabled,Pe=String((H==null?void 0:H.simNumber)||""),it=ae(Pe);let Bt=Array.isArray(te)&&te.length>0?te.map(He=>ae(String(He||""))):it?[it]:[];Bt.length===0&&(Bt=[ae(sim1),ae(sim2)].filter(Boolean));try{localStorage.setItem("lastActiveSimMsisdns",JSON.stringify(Bt))}catch{}let St="",ct="";const Pt=[sim1,sim2].filter(Boolean).map(He=>ae(He)),Ve=ae(Pe);if(Ve&&Pt.includes(Ve))St=Ve,St===ae(sim1)?ct="SIM 1":St===ae(sim2)&&(ct="SIM 2");else{const He=(H==null?void 0:H.slot)!==void 0?H.slot:(H==null?void 0:H.subId)||-1,at=Number(He);at===0?(ct="SIM 1",St=sim1?ae(sim1):""):at===1?(ct="SIM 2",St=sim2?ae(sim2):""):(St=ae(Bt[0]||sim1||sim2||""),St===ae(sim1)?ct="SIM 1":St===ae(sim2)&&(ct="SIM 2"))}if(St)try{localStorage.setItem("lastSmsSimMsisdn",St)}catch{}const{resolveWalletBySimOrSlot:cn,bindSlotWalletMapping:Vt,merchantWalletService:Pn}=await ee(async()=>{const{resolveWalletBySimOrSlot:He,bindSlotWalletMapping:at,merchantWalletService:De}=await Promise.resolve().then(()=>Di);return{resolveWalletBySimOrSlot:He,bindSlotWalletMapping:at,merchantWalletService:De}},void 0,import.meta.url),dt=Qe;let on=await cn({simNumbers:St?[St]:Bt,userId:dt});if(!on&&Bt.length>0){try{await Tt(Bt)}catch{}const He=localStorage.getItem(`selectedWallet_${dt}`)||"";if(He)try{const at=await Pn.getById(He),De=String((at==null?void 0:at.msisdn)||"");(!St||ae(De)===ae(St))&&(on={walletId:He,msisdn:De})}catch{}}if(on&&on.walletId){try{localStorage.setItem(`selectedWallet_${dt}`,on.walletId)}catch{}try{Vt({userId:dt,walletId:on.walletId,msisdn:on.msisdn})}catch{}}const an=String(H.reference||H.txnRefNumber||""),xt=(on==null?void 0:on.msisdn)||St||(Qe?await o_(Qe):"");let gt=st;try{const He=Cu(ne);(/[a-z\u0600-\u06FF]/i.test(gt)||!gt||gt.length<5)&&He.sender&&(gt=He.sender)}catch{}const ln={amount:be,sender:gt,senderName:String(H.senderName||""),text:ne,simNumber:St,simLabel:ct,type:H.type};if(smsAutoRegister)try{await _t({...ln,reference:an,walletMsisdn:xt,walletId:on==null?void 0:on.walletId,sim1Number:sim1,sim2Number:sim2,autoConfirm:!0});try{Re()}catch{}return}catch(He){console.error("Auto-register failed",He)}try{const{addDoc:He,collection:at,serverTimestamp:De}=await ee(async()=>{const{addDoc:Xe,collection:vt,serverTimestamp:zt}=await Promise.resolve().then(()=>kn);return{addDoc:Xe,collection:vt,serverTimestamp:zt}},void 0,import.meta.url),{db:tt}=await ee(async()=>{const{db:Xe}=await Promise.resolve().then(()=>En);return{db:Xe}},void 0,import.meta.url),$e=await He(at(tt,"pendingSmsPopups"),{userId:Qe,shopId:ft,payload:{...ln,reference:an,walletMsisdn:xt,sim1Number:sim1,sim2Number:sim2,autoConfirmDuration:Number(((Z=fe.current)==null?void 0:Z.smsAutoConfirmDuration)??5)},status:"pending",createdAt:De()});let se="VF-Cash";/Received\s*EGP/i.test(String(ne))?se="InstaPay":(/etisalat|e&|/i.test(String(ne))||/etisalat|e&|/i.test(String(ln.sender||"")))&&(se="Etisalat Cash"),qe({...ln,reference:an,providerLabel:se,walletMsisdn:xt,popupId:$e.id,autoConfirmDuration:Number(((K=fe.current)==null?void 0:K.smsAutoConfirmDuration)??5)})}catch{let He="VF-Cash";/Received\s*EGP/i.test(String(ne))?He="InstaPay":(/etisalat|e&|/i.test(String(ne))||/etisalat|e&|/i.test(String(ln.sender||"")))&&(He="Etisalat Cash"),qe({...ln,reference:an,providerLabel:He,walletMsisdn:xt,autoConfirmDuration:Number(((oe=fe.current)==null?void 0:oe.smsAutoConfirmDuration)??5)})}ve(!0);try{Re()}catch{}}catch{}};try{window.addEventListener("vfCashTransactionDetected",M)}catch{}return()=>{try{window.removeEventListener("vfCashTransactionDetected",M)}catch{}}},[u,s]),y.useEffect(()=>{},[u,s]);const _t=async M=>{var z,j,Z;try{const K=M||J;if(!K)return;try{console.log("handleConfirmSmsRegister ",{simLabel:K.simLabel,simNumber:K.simNumber,slot:K.simSlot})}catch{}const{amount:oe,sender:H,text:Ae,simNumber:st,senderName:te}=K,ne=String(Ae||"");let be=Number(oe||0);const ze=typeof(M==null?void 0:M.deferredMode)=="boolean"?M.deferredMode:Dr,Qe=(M==null?void 0:M.debtorName)??Lr,ft=(M==null?void 0:M.debtorNote)??de;try{ve(!1)}catch{}try{}catch{}const ut=/InstaPay|Received\s*EGP|You\s*have\s*received/i.test(ne)?"instapay":"vodafone_cash";if(!be||be<=0){const De=ne.match(/\s+(\d+(?:[\.,]\d+)?)\s*/i);if(De&&(be=parseFloat(String(De[1]).replace(",","."))),!be||be<=0){const tt=ne.match(/Received\s*EGP\s*([0-9.,]+)/i)||ne.match(/Received\s*EGP([0-9.,]+)/i)||ne.match(/amount\s*([0-9.,]+)\s*EGP/i)||ne.match(/received\s*([0-9.,]+)\s*EGP/i);tt&&(be=parseFloat(String(tt[1]).replace(/,/g,"")))}}let Pe=String(H||"").trim();if(!Pe){const De=ne.match(/\s+\s+(\d+)/i);if(Pe=De?ae(De[1]):"",!Pe){const tt=ne.match(/from\s+([0-9+]+)/i);tt&&(Pe=ae(tt[1]))}}let it=String((K==null?void 0:K.reference)||"").trim();if(!it){const De=ne.match(/\s*\s*([\d\.]+)/i);if(De)it=String(De[1]).trim();else{const tt=ne.match(/(?:Ref:|Ref)\s*([A-Za-z0-9\-]+)/i);tt?it=String(tt[1]).trim():it=String(Date.now())}}let Bt=String((K==null?void 0:K.walletMsisdn)||"").trim();if(!be||be<=0){try{u({title:"      ",variant:"destructive"})}catch{}return}const{auth:St}=await ee(async()=>{const{auth:De}=await Promise.resolve().then(()=>En);return{auth:De}},void 0,import.meta.url),ct=((z=St.currentUser)==null?void 0:z.uid)||"";let Pt=s||"";if(!ct){try{u({title:"  ",description:"   "})}catch{}return}if(!Pt)try{const{doc:De,getDoc:tt}=await ee(async()=>{const{doc:Xe,getDoc:vt}=await Promise.resolve().then(()=>kn);return{doc:Xe,getDoc:vt}},void 0,import.meta.url),{db:$e}=await ee(async()=>{const{db:Xe}=await Promise.resolve().then(()=>En);return{db:Xe}},void 0,import.meta.url),se=await tt(De($e,"profiles",ct));if(se.exists()){const Xe=se.data(),vt=String((Xe==null?void 0:Xe.shopId)||"").trim();vt&&(Pt=vt)}}catch{}if(!Pt){try{u({title:"  ",description:"   "})}catch{}return}let Ve=(M==null?void 0:M.walletId)||"";if(!Ve)try{const{resolveWalletBySimOrSlot:De}=await ee(async()=>{const{resolveWalletBySimOrSlot:Xe}=await Promise.resolve().then(()=>Di);return{resolveWalletBySimOrSlot:Xe}},void 0,import.meta.url),tt=K==null?void 0:K.simLabel;let $e=-1;(K==null?void 0:K.simSlot)!==void 0&&(K==null?void 0:K.simSlot)!==-1?$e=Number(K.simSlot):$e=tt==="SIM 1"?0:tt==="SIM 2"?1:-1;const se=await De({simNumbers:st?[st]:[],userId:ct,slotIndex:$e});se&&se.walletId&&(Ve=se.walletId)}catch{}if(!Ve&&st)try{const{detectWalletFromSim:De}=await ee(async()=>{const{detectWalletFromSim:Ke}=await Promise.resolve().then(()=>Di);return{detectWalletFromSim:Ke}},void 0,import.meta.url),{merchantWalletService:tt}=await ee(async()=>{const{merchantWalletService:Ke}=await Promise.resolve().then(()=>uo);return{merchantWalletService:Ke}},void 0,import.meta.url),$e=await tt.getByMerchantId(ct),se=localStorage.getItem(`wallets_${ct}`),Xe=se?JSON.parse(se):[],vt=(Array.isArray(Xe)?Xe:[]).map(Ke=>({id:String((Ke==null?void 0:Ke.id)||""),phone:String((Ke==null?void 0:Ke.phone)||(Ke==null?void 0:Ke.msisdn)||""),isDefault:!!(Ke!=null&&Ke.isDefault)})),zt=(Array.isArray($e)?$e:[]).map(Ke=>({id:String((Ke==null?void 0:Ke.id)||""),msisdn:String((Ke==null?void 0:Ke.msisdn)||""),isDefault:!!(Ke!=null&&Ke.isDefault)})),un=[...vt,...zt],Jt=await De([st],un);Jt&&Jt.walletId&&(Ve=Jt.walletId)}catch{}if(Ve||(Ve=await nR(ct)),!Ve)try{const{doc:De,getDoc:tt}=await ee(async()=>{const{doc:Ze,getDoc:Kt}=await Promise.resolve().then(()=>kn);return{doc:Ze,getDoc:Kt}},void 0,import.meta.url),{db:$e}=await ee(async()=>{const{db:Ze}=await Promise.resolve().then(()=>En);return{db:Ze}},void 0,import.meta.url);let se="",Xe="";try{const Ze=await tt(De($e,"profiles",ct));if(Ze.exists()){const Kt=Ze.data();se=String((Kt==null?void 0:Kt.sim1Number)||"").trim(),Xe=String((Kt==null?void 0:Kt.sim2Number)||"").trim()}}catch{}const{detectWalletFromSim:vt}=await ee(async()=>{const{detectWalletFromSim:Ze}=await Promise.resolve().then(()=>Di);return{detectWalletFromSim:Ze}},void 0,import.meta.url),{merchantWalletService:zt}=await ee(async()=>{const{merchantWalletService:Ze}=await Promise.resolve().then(()=>uo);return{merchantWalletService:Ze}},void 0,import.meta.url),un=`wallets_${ct}`,Jt=localStorage.getItem(un),Ke=Jt?JSON.parse(Jt):[],In=await zt.getByMerchantId(ct),jt=(Array.isArray(Ke)?Ke:[]).map(Ze=>({id:String((Ze==null?void 0:Ze.id)||""),phone:String((Ze==null?void 0:Ze.phone)||(Ze==null?void 0:Ze.msisdn)||""),isDefault:!!(Ze!=null&&Ze.isDefault)})),Xt=(Array.isArray(In)?In:[]).map(Ze=>({id:String((Ze==null?void 0:Ze.id)||""),msisdn:String((Ze==null?void 0:Ze.msisdn)||""),isDefault:!!(Ze!=null&&Ze.isDefault)})),ir=[...jt,...Xt];if(ir.length>0)Ve=ir[0].id;else{const Ze=st||String(localStorage.getItem("lastSmsSimMsisdn")||"");let Kt=(Ze?[Ze]:[]).filter(Boolean);Kt.length===0&&(Kt=[se,Xe].filter(Boolean));const yt=await vt(Kt,ir);if(yt&&yt.walletId){Ve=yt.walletId;try{localStorage.setItem(`selectedWallet_${ct}`,Ve)}catch{}}}}catch{}if(!Ve){try{u({title:"   ",description:"       "})}catch{}return}try{const De=ct;try{localStorage.setItem(`selectedWallet_${De}`,Ve)}catch{}try{localStorage.setItem(`selectedWallet_${De}_${Pt}`,Ve)}catch{}if(Ve)try{window.dispatchEvent(new CustomEvent("walletSelection:update",{detail:{walletId:Ve}}))}catch{}try{const{Preferences:tt}=await ee(async()=>{const{Preferences:$e}=await Promise.resolve().then(()=>cp);return{Preferences:$e}},void 0,import.meta.url);await tt.set({key:"selected_wallet_id",value:Ve}),await tt.set({key:"current_user_id",value:De})}catch{}}catch{}const{recordAutoTransaction:cn,userDataService:Vt}=await ee(async()=>{const{recordAutoTransaction:De,userDataService:tt}=await Promise.resolve().then(()=>uo);return{recordAutoTransaction:De,userDataService:tt}},void 0,import.meta.url),Pn=dn&&dn.trim()!==""?Math.max(0,parseFloat(dn)):null;let dt=0;if(Pn!=null)dt=Pn;else try{const{merchantWalletService:De}=await ee(async()=>{const{merchantWalletService:se}=await Promise.resolve().then(()=>uo);return{merchantWalletService:se}},void 0,import.meta.url),tt=await De.getById(String(Ve)),$e=tt&&tt.defaultWithdrawCommission;if($e!=null)dt=Math.round((Number($e)||0)*Number(be)/1e3*100)/100;else{const{calculateCommission:se}=await ee(async()=>{const{calculateCommission:Xe}=await Promise.resolve().then(()=>Eo);return{calculateCommission:Xe}},void 0,import.meta.url);dt=se(Number(be),"receive")}}catch{const{calculateCommission:De}=await ee(async()=>{const{calculateCommission:tt}=await Promise.resolve().then(()=>Eo);return{calculateCommission:tt}},void 0,import.meta.url);dt=De(Number(be),"receive")}try{const{walletDailyLimitsService:De}=await ee(async()=>{const{walletDailyLimitsService:$e}=await Promise.resolve().then(()=>Uf);return{walletDailyLimitsService:$e}},void 0,import.meta.url),tt=await De.canPerformOperation(String(Ve),Math.max(0,Number(be||0)),"withdraw");if(!tt.canPerform)try{u({title:"  ",description:String(tt.message||"      "),variant:"destructive"})}catch{}}catch{}const Yt=it||`${ne}|${Date.now()}`,on=st||String(localStorage.getItem("lastSmsSimMsisdn")||""),an=Bt||on||await o_(ct)||"",xt=(localStorage.getItem("commissionMode")||"").toLowerCase()==="add"?"add":"deduct";if(ze)try{const De=await Vt.getUserData(ct),tt=Array.isArray(De==null?void 0:De.debts)?De.debts:[],$e=xt==="add"?Number(be)+Number(dt):Number(be),se={id:`DEBT-${Date.now()}`,debtorName:Qe||te||Pe||"",amount:Math.round(Number($e)*100)/100,reason:ft||"  VodafoneCash",customerId:void 0,mobile:Pe,status:"pending",createdAt:new Date},Xe=[se,...tt];await Vt.updateUserData(ct,{debts:Xe});try{const vt=dt;await Vt.saveUserTransaction(ct,{type:"withdraw",amount:be,withdrawnAmount:be,commission:vt,status:"pending",createdAt:new Date,senderMsisdn:Pe,receiverMsisdn:an,senderName:te,walletId:Ve,fromWallet:Ve,lineId:an,provider:ut,reference:Yt,transactionId:`DEFER-${Date.now()}`,linkedDebtId:se.id})}catch{}try{const vt=(M==null?void 0:M.popupId)||(J==null?void 0:J.popupId)||"";if(vt){const{doc:zt,updateDoc:un,serverTimestamp:Jt}=await ee(async()=>{const{doc:In,updateDoc:jt,serverTimestamp:Xt}=await Promise.resolve().then(()=>kn);return{doc:In,updateDoc:jt,serverTimestamp:Xt}},void 0,import.meta.url),{db:Ke}=await ee(async()=>{const{db:In}=await Promise.resolve().then(()=>En);return{db:In}},void 0,import.meta.url);try{await un(zt(Ke,"pendingSmsPopups",vt),{status:"confirmed",confirmedAt:Jt()})}catch{}try{(Z=(j=Y.current)==null?void 0:j.add)==null||Z.call(j,vt);const In=Array.from(Y.current||[]);localStorage.setItem("sms_suppressed_ids",JSON.stringify(In))}catch{}}}catch{}try{u({title:"  ",description:"      "})}catch{}return}catch{}ve(!1),qe(null);const gt=(K==null?void 0:K.type)==="transfer"?"send":"withdraw";try{u({title:gt==="send"?"  ...":"  ..."})}catch{}const ln=`TX-${Date.now()}`,He=Math.max(0,Number(be||0)),at=Math.max(0,dt);try{const De=`cashBalance_${ct}_${Pt||"main"}`,tt=`walletBalances_${ct}_${Pt||"main"}`,$e=localStorage.getItem(De),se=localStorage.getItem(tt);let Xe=$e?parseFloat($e):0,vt=se?JSON.parse(se):{};gt==="send"?(vt[Ve]=(Number(vt[Ve])||0)-He,Xe=Xe+He+at):(vt[Ve]=(Number(vt[Ve])||0)+He,Xe=Xe-He+at);const zt={id:ln,type:gt,senderPhone:gt==="send"?an:Pe,receiverPhone:gt==="send"?Pe:an,amount:be,status:"completed",createdAt:new Date,withdrawnAmount:be,commission:at,fromWallet:Ve,senderName:te,provider:ut,reference:Yt,shopName:"  ()"};window.dispatchEvent(new CustomEvent("dashboard:external-update",{detail:{delta:{amount:He,commission:at,walletId:Ve,type:gt}}}))}catch(De){console.error("Optimistic update failed",De)}(async()=>{var tt,$e,se,Xe,vt,zt,un;let De="";try{const{collection:Jt,query:Ke,where:In,orderBy:jt,limit:Xt,getDocs:ir,doc:Ze,updateDoc:Kt,serverTimestamp:yt}=await ee(async()=>{const{collection:Rn,query:bt,where:$s,orderBy:nn,limit:Zt,getDocs:ht,doc:Sr,updateDoc:Bn,serverTimestamp:zn}=await Promise.resolve().then(()=>kn);return{collection:Rn,query:bt,where:$s,orderBy:nn,limit:Zt,getDocs:ht,doc:Sr,updateDoc:Bn,serverTimestamp:zn}},void 0,import.meta.url),{db:as}=await ee(async()=>{const{db:Rn}=await Promise.resolve().then(()=>En);return{db:Rn}},void 0,import.meta.url),ti=Ke(Jt(as,"transactions"),In("merchantUserId","==",ct),jt("createdAt","desc"),Xt(12)),er=await ir(ti),Is=Date.now();let ls=!1;for(const Rn of er.docs){const bt=Rn.data(),$s=bt!=null&&bt.createdAt&&typeof((tt=bt==null?void 0:bt.createdAt)==null?void 0:tt.toDate)=="function"?bt.createdAt.toDate().getTime():bt!=null&&bt.createdAt?new Date(String(bt.createdAt)).getTime():0,nn=Math.abs(Is-$s)<=12e4,Zt=Math.round(Number((bt==null?void 0:bt.amount)||0)*100)===Math.round(Number(be||0)*100),ht=String((bt==null?void 0:bt.provider)||"").toLowerCase()===String(ut||"").toLowerCase(),Sr=String(gt==="send"?(bt==null?void 0:bt.receiverMsisdn)||(bt==null?void 0:bt.receiverPhone)||"":(bt==null?void 0:bt.senderMsisdn)||(bt==null?void 0:bt.senderPhone)||""),Bn=ae(Sr)===ae(Pe);if(nn&&Zt&&Bn&&ht){ls=!0,De=Rn.id;break}}if(ls){const Rn=(M==null?void 0:M.popupId)||(J==null?void 0:J.popupId)||"";if(Rn){try{await Kt(Ze(as,"pendingSmsPopups",Rn),{status:"confirmed",confirmedAt:yt()})}catch{}try{(se=($e=Y.current)==null?void 0:$e.add)==null||se.call($e,Rn);const bt=Array.from(Y.current||[]);localStorage.setItem("sms_suppressed_ids",JSON.stringify(bt))}catch{}}}else{De=await cn({shopId:Pt,lineId:an,walletId:Ve,amount:be,note:"SMS-ManualConfirm",provider:ut,createdBy:ct,senderMsisdn:Pe,senderName:te,reference:Yt,text:ne,txnType:gt==="send"?"send":"receive"});try{const Rn=(M==null?void 0:M.popupId)||(J==null?void 0:J.popupId)||"";if(Rn){try{await Kt(Ze(as,"pendingSmsPopups",Rn),{status:"confirmed",confirmedAt:yt()})}catch{}try{(vt=(Xe=Y.current)==null?void 0:Xe.add)==null||vt.call(Xe,Rn);const bt=Array.from(Y.current||[]);localStorage.setItem("sms_suppressed_ids",JSON.stringify(bt))}catch{}}}catch{}}}catch(Jt){console.error(Jt)}try{const{doc:Jt,getDoc:Ke,updateDoc:In}=await ee(async()=>{const{doc:er,getDoc:Is,updateDoc:ls}=await Promise.resolve().then(()=>kn);return{doc:er,getDoc:Is,updateDoc:ls}},void 0,import.meta.url),{db:jt}=await ee(async()=>{const{db:er}=await Promise.resolve().then(()=>En);return{db:er}},void 0,import.meta.url),Xt=Math.max(0,Number(be||0)),ir=Jt(jt,"dashboardData",Pt),Ze=await Ke(ir);let Kt=Ze.exists()?Number(((zt=Ze.data())==null?void 0:zt.cashBalance)||0):0;const yt=Ze.exists()?((un=Ze.data())==null?void 0:un.walletBalances)||{}:{},as=Number(yt[Ve]||0);(()=>{gt==="send"?(yt[Ve]=as-Xt,Kt=Kt+Xt+Math.max(0,dt)):(yt[Ve]=as+Xt,Kt=Kt-Xt+Math.max(0,dt))})(),await In(ir,{cashBalance:Kt,walletBalances:yt,lastUpdated:new Date().toISOString()});try{const er={id:De||`TX-${Date.now()}`,type:gt,senderPhone:gt==="send"?an:Pe,receiverPhone:gt==="send"?Pe:an,amount:be,status:"completed",createdAt:new Date,withdrawnAmount:be,commission:dt,fromWallet:Ve,senderName:te,provider:ut,reference:Yt,shopName:" "};window.dispatchEvent(new CustomEvent("dashboard:external-update",{detail:{cashBalance:Kt,walletBalances:yt,newTransaction:er}}))}catch{}try{const{walletDailyLimitsService:er}=await ee(async()=>{const{walletDailyLimitsService:Is}=await Promise.resolve().then(()=>Uf);return{walletDailyLimitsService:Is}},void 0,import.meta.url);try{const{transactionServiceExtra:Is}=await ee(async()=>{const{transactionServiceExtra:ht}=await Promise.resolve().then(()=>uo);return{transactionServiceExtra:ht}},void 0,import.meta.url),ls=await Is.getMerchantTransactions(ct,50),Rn=Date.now(),bt=ht=>String(ht||"").replace(/\D/g,"").slice(-5),$s=bt(gt==="send"?Pe||an:Pe),nn=String(ut||"").toLowerCase();let Zt=!1;for(const ht of ls){const Sr=ht!=null&&ht.createdAt?new Date(ht.createdAt).getTime():0;if(Math.abs(Rn-Sr)<=1e4){const Bn=Number((ht==null?void 0:ht.amount)||0)===Number(Xt||0),zn=String((ht==null?void 0:ht.provider)||"").toLowerCase()===nn,Wn=bt((ht==null?void 0:ht.senderMsisdn)||(ht==null?void 0:ht.receiverMsisdn)||(ht==null?void 0:ht.senderPhone)||(ht==null?void 0:ht.receiverPhone));if(Bn&&zn&&Wn&&$s&&Wn===$s){Zt=!0;break}}}Zt||await er.updateUsage(String(Ve),Xt,gt==="send"?"transfer":"withdraw",!0)}catch{await er.updateUsage(String(Ve),Xt,gt==="send"?"transfer":"withdraw",!0)}try{window.dispatchEvent(new CustomEvent("walletLimitsUpdated",{detail:{walletId:String(Ve)}}))}catch{}}catch{}}catch{}(async()=>{try{const Jt=dt;await Vt.saveUserTransaction(ct,{type:gt,amount:be,withdrawnAmount:be,commission:Jt,status:"completed",createdAt:new Date,senderMsisdn:gt==="send"?an:Pe,receiverMsisdn:gt==="send"?Pe:an,senderName:te,walletId:Ve,fromWallet:Ve,lineId:an,provider:ut,reference:Yt,transactionId:De||ln});try{window.dispatchEvent(new CustomEvent("transaction-created"))}catch{}}catch{}})(),jl.invalidateQueries({queryKey:["dashboardData"]}),jl.invalidateQueries({queryKey:["transactions"]}),jl.invalidateQueries({queryKey:["walletDailyLimits"]}),jl.invalidateQueries({queryKey:["wallets"]}),jl.invalidateQueries({queryKey:["user-stats"]});try{const Jt=gt==="send"?`     ${De||ln}`:`     ${De||ln}`;u({title:Jt})}catch{}})()}catch(K){try{u({title:String((K==null?void 0:K.message)||"  "),variant:"destructive"})}catch{}}};y.useEffect(()=>{try{kP.start()}catch{}return()=>{try{kP.stop()}catch{}}},[]),y.useEffect(()=>{(async()=>{try{if(!(r!=null&&r.uid))return;const M=String(localStorage.getItem("android_last_ack_version_id")||"").trim(),z=String(localStorage.getItem("android_installed_version")||"").trim(),j=localStorage.getItem("android_last_ack_code"),Z=localStorage.getItem("android_installed_code"),K=j?Number(j):null,oe=Z?Number(Z):null,H=M||z,Ae=K??oe??null;H&&N(H),Ae&&L(Ae);const{doc:st,getDoc:te}=await ee(async()=>{const{doc:ze,getDoc:Qe}=await Promise.resolve().then(()=>kn);return{doc:ze,getDoc:Qe}},void 0,import.meta.url),{db:ne}=await ee(async()=>{const{db:ze}=await Promise.resolve().then(()=>En);return{db:ze}},void 0,import.meta.url),be=await te(st(ne,"profiles",r.uid));if(be.exists()){const ze=be.data(),Qe=String((ze==null?void 0:ze.lastAckAndroidVersion)||(ze==null?void 0:ze.androidInstalledVersion)||(ze==null?void 0:ze.lastAckUpdateId)||"").trim(),ft=typeof(ze==null?void 0:ze.lastAckAndroidCode)=="number"?ze.lastAckAndroidCode:typeof(ze==null?void 0:ze.androidInstalledCode)=="number"?ze.androidInstalledCode:null,ut=(it,Bt)=>{const St=String(it||"").replace(/^v/i,"").split(".").map(Pt=>parseInt(Pt,10)||0),ct=String(Bt||"").replace(/^v/i,"").split(".").map(Pt=>parseInt(Pt,10)||0);for(let Pt=0;Pt<Math.max(St.length,ct.length);Pt++){const Ve=St[Pt]||0,cn=ct[Pt]||0;if(Ve>cn)return 1;if(Ve<cn)return-1}return 0};let Pe=!1;if(typeof ft=="number"&&typeof Ae=="number"?Pe=ft>Ae:typeof ft=="number"&&Ae==null?Pe=!0:Qe&&H?Pe=ut(Qe,H)>0:Qe&&!H&&(Pe=!0),Pe){if(Qe){try{localStorage.setItem("android_installed_version",Qe)}catch{}N(Qe)}if(typeof ft=="number"){try{localStorage.setItem("android_installed_code",String(ft))}catch{}L(ft)}}else if(typeof ft=="number"&&Ae==null){try{localStorage.setItem("android_installed_code",String(ft))}catch{}L(ft)}}}catch{}})()},[r==null?void 0:r.uid]),y.useEffect(()=>{try{const z=String((window==null?void 0:window.__nativeAppVersion)||"").trim();z&&A(z);const j=window==null?void 0:window.__nativeAppVersionCode;if(typeof j=="number"){k(j);try{localStorage.setItem("android_installed_code",String(j))}catch{}}try{z&&localStorage.setItem("android_installed_version",z)}catch{}}catch{}const M=z=>{var j,Z;try{const K=String((((j=z==null?void 0:z.detail)==null?void 0:j.version)??"")||"").trim(),oe=(Z=z==null?void 0:z.detail)==null?void 0:Z.code;K&&A(K);try{K&&localStorage.setItem("android_installed_version",K)}catch{}typeof oe=="number"&&k(oe)}catch{}};try{window.addEventListener("native-app-version",M)}catch{}return()=>{try{window.removeEventListener("native-app-version",M)}catch{}}},[]),y.useEffect(()=>{try{const M=(Te==null?void 0:Te.isNativePlatform)&&Te.getPlatform()==="android",z=String(I||"").trim();if(!M||!z||!(r!=null&&r.uid))return;(async()=>{try{const{doc:j,setDoc:Z,serverTimestamp:K}=await ee(async()=>{const{doc:H,setDoc:Ae,serverTimestamp:st}=await Promise.resolve().then(()=>kn);return{doc:H,setDoc:Ae,serverTimestamp:st}},void 0,import.meta.url),{db:oe}=await ee(async()=>{const{db:H}=await Promise.resolve().then(()=>En);return{db:H}},void 0,import.meta.url);await Z(j(oe,"profiles",r.uid),{androidInstalledVersion:z,androidInstalledAt:K()},{merge:!0});try{localStorage.setItem("android_installed_version",z)}catch{}}catch{}})()}catch{}},[I,r==null?void 0:r.uid]),y.useEffect(()=>{Te!=null&&Te.isNativePlatform&&Te.getPlatform()==="android"&&(async()=>{try{await ee(()=>import("./ProtectedUserDashboard-zE0zQwvA.js"),__vite__mapDeps([29,30,19]),import.meta.url),await ee(()=>import("./UserDashboardPage-BxOlnKZi.js").then(z=>z.U),__vite__mapDeps([68,57,15,54,53,45,40,50,27,7,39,8,2,49,33,32,44,42,30,18,26,11,28,22,38,1]),import.meta.url),await ee(()=>Promise.resolve().then(()=>fee),void 0,import.meta.url),await ee(()=>import("./ProfileSettingsPage-6rJ-8Y1I.js").then(z=>z.b),__vite__mapDeps([53,45,40,54,15,50,27,7,39,8,2]),import.meta.url),await ee(()=>import("./TransactionsPage-C9z5VyWw.js"),__vite__mapDeps([55,15,49,33,56,57,46,37,7,38,5,58,54,11,59,52,27,60,26,61,62,48,50,63,39,28,2,64]),import.meta.url)}catch{}})()},[]),y.useEffect(()=>{if(!t)return;const M=document.createElement("style");M.setAttribute("data-disable-pull-to-refresh","true"),M.textContent="html, body { overscroll-behavior-y: contain; touch-action: pan-y; }",document.head.appendChild(M);let z=0,j=null;const Z=oe=>{var H,Ae;z=((Ae=(H=oe.touches)==null?void 0:H[0])==null?void 0:Ae.clientY)||0,j=oe.target},K=oe=>{var ze,Qe;const H=((Qe=(ze=oe.touches)==null?void 0:ze[0])==null?void 0:Qe.clientY)||0,Ae=document.scrollingElement||document.documentElement,st=Ae.scrollTop||window.scrollY||0,te=Ae.scrollHeight-Ae.clientHeight||0,ne=j||null,be=(()=>{let ft=ne;for(;ft&&ft!==document.body;){const Pe=window.getComputedStyle(ft).overflowY;if((Pe==="auto"||Pe==="scroll")&&ft.scrollHeight>ft.clientHeight)return!0;ft=ft.parentElement}return!1})();!be&&st<=0&&H>z&&oe.cancelable&&oe.preventDefault(),!be&&st>=te&&H<z&&oe.cancelable&&oe.preventDefault()};return document.addEventListener("touchstart",Z,{passive:!0}),document.addEventListener("touchmove",K,{passive:!1}),()=>{document.removeEventListener("touchstart",Z),document.removeEventListener("touchmove",K);try{document.head.removeChild(M)}catch{}}},[t]),y.useEffect(()=>{if(!((Te==null?void 0:Te.isNativePlatform)&&Te.getPlatform()==="android"))return;try{const Z=(window.location.reload||(()=>{})).bind(window.location);window.__originalReload=Z,window.location.reload=()=>{try{window.dispatchEvent(new CustomEvent("app:softRefresh"))}catch{}}}catch{}try{const Z=(window.location.assign||(K=>{})).bind(window.location);window.__originalAssign=Z,window.location.assign=K=>{try{if(String(K||"").startsWith("/user/dashboard")){c("/user/dashboard");return}}catch{}try{Z(K)}catch{}}}catch{}let z=null,j=!1;return(async()=>{try{const{listenAndroidUpdates:Z}=await ee(async()=>{const{listenAndroidUpdates:K}=await Promise.resolve().then(()=>Cee);return{listenAndroidUpdates:K}},void 0,import.meta.url);z=Z(K=>{if(j)return;const oe=String((K==null?void 0:K.version)||"").trim(),H=String((K==null?void 0:K.url)||"").trim(),Ae=String((K==null?void 0:K.notes)||"").trim(),st=!!(K!=null&&K.force),te=typeof(K==null?void 0:K.code)=="number"?K.code:void 0,ne=String(localStorage.getItem("android_last_ack_version_id")||"").trim(),be=String(T||ne||"").trim(),ze=(cn,Vt)=>{const Pn=String(cn||"").replace(/^v/i,"").split(".").map(Yt=>parseInt(Yt,10)||0),dt=String(Vt||"").replace(/^v/i,"").split(".").map(Yt=>parseInt(Yt,10)||0);for(let Yt=0;Yt<Math.max(Pn.length,dt.length);Yt++){const on=Pn[Yt]||0,an=dt[Yt]||0;if(on>an)return 1;if(on<an)return-1}return 0},Qe=String(I||"").trim(),ft=String(localStorage.getItem("android_installed_version")||"").trim(),ut=localStorage.getItem("android_installed_code"),Pe=ut?Number(ut):null,it=[R,C,Pe].filter(cn=>typeof cn=="number").reduce((cn,Vt)=>cn===void 0?Vt:Math.max(cn,Vt),void 0),Bt=typeof te=="number"&&typeof it=="number"?te>it:void 0,St=(()=>{const cn=[Qe,be,ft].filter(Boolean);return cn.length===0?"":cn.reduce((Vt,Pn)=>ze(Pn,Vt)>0?Pn:Vt)})(),ct=ze(oe,St)>0;if(!!H&&(!!oe||typeof te=="number")&&(Bt!==void 0?Bt:ct)){const cn="   ",Vt=`${Ae?Ae+`
`:""} : ${oe}`;v({title:cn,message:Vt,apkUrl:H,force:st,versionId:oe,versionCode:te}),m(!0);try{const Pn=localStorage.getItem("android_update_ready_version"),dt=localStorage.getItem("android_update_ready_code");(Pn&&Pn===oe||dt&&te&&String(te)===dt)&&P(!0)}catch{}}else try{m(!1)}catch{}})}catch{}})(),()=>{j=!0;try{typeof z=="function"&&z()}catch{}}},[T,I]),y.useEffect(()=>{if(r!=null&&r.uid)try{const M=localStorage.getItem("android_update_ready_version"),z=localStorage.getItem("android_update_ready_code"),j=String(I||"").trim(),Z=R,K=M&&j&&j===M,oe=z&&Z&&String(Z)===z;(K||oe)&&(async()=>{try{const{doc:H,setDoc:Ae,serverTimestamp:st}=await ee(async()=>{const{doc:be,setDoc:ze,serverTimestamp:Qe}=await Promise.resolve().then(()=>kn);return{doc:be,setDoc:ze,serverTimestamp:Qe}},void 0,import.meta.url),{db:te}=await ee(async()=>{const{db:be}=await Promise.resolve().then(()=>En);return{db:be}},void 0,import.meta.url),ne={lastAckAndroidVersion:j||M,androidInstalledVersion:j||M,lastAckAt:st(),androidInstalledAt:st()};Z&&(ne.lastAckAndroidCode=Z,ne.androidInstalledCode=Z),await Ae(H(te,"profiles",r.uid),ne,{merge:!0}),localStorage.removeItem("android_update_ready_version"),localStorage.removeItem("android_update_ready_code"),j&&localStorage.setItem("android_last_ack_version_id",j),j&&localStorage.setItem("android_installed_version",j),Z&&localStorage.setItem("android_last_ack_code",String(Z)),Z&&localStorage.setItem("android_installed_code",String(Z)),m(!1)}catch{}})()}catch{}},[r==null?void 0:r.uid,I,R]),y.useEffect(()=>{const M=j=>{const Z=(j==null?void 0:j.detail)||{};try{O.current&&(clearTimeout(O.current),O.current=null)}catch{}try{X.current&&(clearInterval(X.current),X.current=null)}catch{}E(!0),_({percent:Z.percent??null,downloaded:Z.downloaded??0,total:Z.total??0})},z=()=>{try{O.current&&(clearTimeout(O.current),O.current=null)}catch{}try{X.current&&(clearInterval(X.current),X.current=null)}catch{}E(!1),P(!0),_({percent:100,downloaded:((b==null?void 0:b.total)??(b==null?void 0:b.downloaded)??0)||0,total:(b==null?void 0:b.total)??0});try{const j=String((p==null?void 0:p.versionId)||"").trim(),Z=p==null?void 0:p.versionCode;if(j)try{localStorage.setItem("android_update_ready_version",j)}catch{}if(typeof Z=="number")try{localStorage.setItem("android_update_ready_code",String(Z))}catch{}}catch{}};return window.addEventListener("androidUpdateProgress",M),window.addEventListener("androidUpdateDownloaded",z),()=>{window.removeEventListener("androidUpdateProgress",M),window.removeEventListener("androidUpdateDownloaded",z)}},[]),V.useEffect(()=>{g&&(b!=null&&b.percent)&&b.percent>=99&&window.dispatchEvent(new CustomEvent("androidUpdateDownloaded"))},[b,g]),y.useEffect(()=>{let M=!0;return(async()=>{var z;try{const{auth:j}=await ee(async()=>{const{auth:ut}=await Promise.resolve().then(()=>En);return{auth:ut}},void 0,import.meta.url),Z=((z=j.currentUser)==null?void 0:z.uid)||"";if(!Z)return;const{db:K}=await ee(async()=>{const{db:ut}=await Promise.resolve().then(()=>En);return{db:ut}},void 0,import.meta.url),{collection:oe,query:H,where:Ae,onSnapshot:st,deleteDoc:te,limit:ne,orderBy:be,getDocs:ze}=await ee(async()=>{const{collection:ut,query:Pe,where:it,onSnapshot:Bt,deleteDoc:St,limit:ct,orderBy:Pt,getDocs:Ve}=await Promise.resolve().then(()=>kn);return{collection:ut,query:Pe,where:it,onSnapshot:Bt,deleteDoc:St,limit:ct,orderBy:Pt,getDocs:Ve}},void 0,import.meta.url),Qe=H(oe(K,"pendingSmsPopups"),Ae("userId","==",Z),Ae("status","==","pending")),ft=st(Qe,async ut=>{var Pe,it,Bt,St,ct,Pt,Ve,cn,Vt,Pn,dt,Yt,on,an,xt,gt,ln,He,at,De;if(M)try{const tt=typeof ut.docChanges=="function"?ut.docChanges():[];console.log("Web Popup: Snapshot received",tt.length,"changes");for(const $e of tt){if($e.type==="added"){if($e.doc.metadata.hasPendingWrites)continue;const se=$e.doc.data()||{},Xe=$e.doc.id;console.log("Web Popup: Received document",Xe,se),(it=(Pe=Y.current)==null?void 0:Pe.has)!=null&&it.call(Pe,Xe)&&console.log("Web Popup: ID is in suppressed list",Xe);try{const nn=se.createdAt||se.timestamp||(se.payload||{}).createdAt||(se.payload||{}).timestamp,Zt=nn&&typeof nn.toMillis=="function"?nn.toMillis():typeof se.createdAtMs=="number"?se.createdAtMs:typeof(se.payload||{}).createdAtMs=="number"?(se.payload||{}).createdAtMs:null;if(typeof Zt=="number"&&Zt<Date.now()-36e5){console.log("Web Popup: Cleaning up old popup",Xe),te($e.doc.ref).catch(()=>{});continue}}catch{}let vt=se.amount??((Bt=se.payload)==null?void 0:Bt.amount)??null,zt=se.sender??((St=se.payload)==null?void 0:St.sender)??"";const un=se.senderName??((ct=se.payload)==null?void 0:ct.senderName)??"";let Jt=se.reference??((Pt=se.payload)==null?void 0:Pt.reference)??"";const Ke=se.text??((Ve=se.payload)==null?void 0:Ve.text)??"";if((!vt||Number(vt)<=0)&&Ke)try{const{parseSms:nn}=await ee(async()=>{const{parseSms:ht}=await Promise.resolve().then(()=>gee);return{parseSms:ht}},void 0,import.meta.url),Zt=nn(Ke);Zt.amount>0&&(vt=Zt.amount,zt=Zt.sender||zt,Zt.reference&&(Jt=Zt.reference))}catch{}if(Jt&&Jt.length>5)try{const nn=H(oe(K,"transactions"),Ae("reference","==",Jt),ne(1));if(!(await ze(nn)).empty){console.log("Web Popup: Transaction already processed, confirming popup silently",Xe);const{doc:ht,updateDoc:Sr,serverTimestamp:Bn}=await ee(async()=>{const{doc:zn,updateDoc:Wn,serverTimestamp:Ir}=await Promise.resolve().then(()=>kn);return{doc:zn,updateDoc:Wn,serverTimestamp:Ir}},void 0,import.meta.url);await Sr(ht(K,"pendingSmsPopups",Xe),{status:"confirmed",confirmedAt:Bn()});continue}}catch(nn){console.error("Error checking duplicate popup",nn)}if(vt&&Number(vt)>0)try{const Zt=H(oe(K,"transactions"),Ae("userId","==",ir),Ae("amount","==",Number(vt)),Ae("createdAt",">",new Date(Date.now()-864e5)),be("createdAt","desc"),ne(10)),ht=await ze(Zt);if(!ht.empty){const Sr=ae(String(zt||""));if(ht.docs.find(zn=>{const Wn=zn.data(),Ir=ae(String(Wn.senderMsisdn||Wn.senderPhone||""));return!!(Sr&&Ir&&Sr===Ir)})){console.log("Web Popup: Duplicate transaction found by fuzzy match (Amount+Sender), confirming popup silently",Xe);const{doc:zn,updateDoc:Wn,serverTimestamp:Ir}=await ee(async()=>{const{doc:Vn,updateDoc:vn,serverTimestamp:hn}=await Promise.resolve().then(()=>kn);return{doc:Vn,updateDoc:vn,serverTimestamp:hn}},void 0,import.meta.url);await Wn(zn(K,"pendingSmsPopups",Xe),{status:"confirmed",confirmedAt:Ir()});continue}}}catch(nn){console.warn("Fuzzy duplicate check failed",nn)}let In=se.simNumber??((cn=se.payload)==null?void 0:cn.simNumber)??"",jt=se.simSlot??((Vt=se.payload)==null?void 0:Vt.simSlot);jt==null&&(jt=se.slot??((Pn=se.payload)==null?void 0:Pn.slot)),jt==null&&(jt=se.sim_slot??((dt=se.payload)==null?void 0:dt.sim_slot)),jt==null&&(jt=se.lineId??((Yt=se.payload)==null?void 0:Yt.lineId));const Xt=jt!=null?String(jt):"",ir=(r==null?void 0:r.uid)||"default";let Ze=localStorage.getItem(`sim1Number_${ir}`)??localStorage.getItem("sim1Number")??"",Kt=localStorage.getItem(`sim2Number_${ir}`)??localStorage.getItem("sim2Number")??"";const yt=se.payload||{},as=yt.sim1Number||yt.sim1||se.sim1Number||"",ti=yt.sim2Number||yt.sim2||se.sim2Number||"";as&&(Ze=String(as).trim(),Ct(Ze)),ti&&(Kt=String(ti).trim(),ge(Kt));let er=In,Is="";Xt==="1"?(Is="SIM 2",Kt&&(er=Kt)):(Xt==="0"||!Xt)&&(Is="SIM 1",Ze&&(er=Ze));const ls=se.walletMsisdn??((on=se.payload)==null?void 0:on.walletMsisdn)??"";let Rn=se.walletId??((an=se.payload)==null?void 0:an.walletId)??"",bt="";if(!Rn&&(ls||er))try{const nn=ls||er,Zt=(r==null?void 0:r.uid)||"default",ht=`wallets_${Zt}`,Sr=localStorage.getItem(ht);if(Sr){const Bn=JSON.parse(Sr),zn=Array.isArray(Bn)?Bn.map(vn=>({id:String((vn==null?void 0:vn.id)||""),msisdn:ae(String((vn==null?void 0:vn.phone)||(vn==null?void 0:vn.msisdn)||"")),isDefault:!!(vn!=null&&vn.isDefault)})):[],Wn=ae(nn),Ir=Wn.replace(/\D/g,"");let Vn=zn.find(vn=>vn.msisdn===Wn);Vn||(Vn=zn.find(vn=>{const hn=(vn.msisdn||"").replace(/\D/g,"");return hn.length>=7&&Ir.length>=7&&hn.slice(-7)===Ir.slice(-7)})),Vn&&(Rn=Vn.id,bt=Vn.msisdn)}if(!Rn){const{merchantWalletService:Bn}=await ee(async()=>{const{merchantWalletService:Wn}=await Promise.resolve().then(()=>uo);return{merchantWalletService:Wn}},void 0,import.meta.url),zn=await Bn.getByMerchantId(Zt);if(zn&&zn.length>0){const Wn=zn.map(hn=>({id:String((hn==null?void 0:hn.id)||""),msisdn:ae(String((hn==null?void 0:hn.phone)||(hn==null?void 0:hn.msisdn)||"")),isDefault:!!(hn!=null&&hn.isDefault)})),Ir=ae(nn),Vn=Ir.replace(/\D/g,"");let vn=Wn.find(hn=>hn.msisdn===Ir);if(vn||(vn=Wn.find(hn=>{const Br=(hn.msisdn||"").replace(/\D/g,"");return Br.length>=7&&Vn.length>=7&&Br.slice(-7)===Vn.slice(-7)})),vn){Rn=vn.id,bt=vn.msisdn;try{const hn=`wallets_${Zt}`,Br=localStorage.getItem(hn)?JSON.parse(localStorage.getItem(hn)):[]}catch{}}}}}catch(nn){console.error("Immediate wallet resolution failed",nn)}let $s="VF-Cash";if((/etisalat|/i.test(String(zt||""))||/etisalat|/i.test(String(Ke||"")))&&($s="Etisalat Cash"),/Received\s*EGP/i.test(String(Ke))){$s="InstaPay";const nn=String(Ke).match(/Received\s*EGP\s*([0-9.,]+)/i);nn&&(vt=parseFloat(String(nn[1]).replace(/,/g,"")));const Zt=String(Ke).match(/from\s+([0-9+]+)/i);Zt&&(zt=ae(Zt[1]));const ht=String(Ke).match(/Ref:\s*([A-Za-z0-9\-]+)/i);ht&&(Jt=String(ht[1]).trim())}if(M){se.lockedBy&&se.lockedBy!==(localStorage.getItem("deviceId")||"web")&&console.log("Web Popup: Locked by another device, skipping countdown",Xe),console.log("Web Popup: Opening modal for",Xe);const nn=!!se.isFakeSender||!!((xt=se.payload)!=null&&xt.isFakeSender),Zt=localStorage.getItem(`smsAutoRegisterEnabled_${ir}`)??localStorage.getItem("smsAutoRegisterEnabled"),ht=((gt=fe.current)==null?void 0:gt.smsAutoRegisterEnabled)===!0,Sr=Zt==="true"||ht;let Bn=!1;const zn=se.autoConfirm??((ln=se.payload)==null?void 0:ln.autoConfirm)??se.auto_confirm??((He=se.payload)==null?void 0:He.auto_confirm);zn!=null?Bn=!!zn:Bn=Sr;const Wn=se.autoConfirmDuration??((at=se.payload)==null?void 0:at.autoConfirmDuration)??(se==null?void 0:se.auto_confirm_duration)??((De=se.payload)==null?void 0:De.auto_confirm_duration),Ir=Number.isFinite(Number(Wn))?Math.max(0,Number(Wn)):void 0;Ir===0&&(Bn=!0);const Vn={amount:Number(vt||0),sender:String(zt||""),senderName:un,reference:String(Jt||""),text:Ke,simNumber:bt||ls||er,simLabel:Is,simSlot:jt,walletMsisdn:bt||ls,walletId:Rn,providerLabel:$s,popupId:Xe,sim1Number:Ze,sim2Number:Kt,isFakeSender:nn,autoConfirm:Bn,autoConfirmDuration:Ir,isLocal:!0,lockedBy:se.lockedBy};if(Bn&&!se.lockedBy){const Br=localStorage.getItem("deviceId")||`web-${Math.random().toString(36).slice(2)}`;localStorage.setItem("deviceId",Br);const{doc:Bs,updateDoc:Kd}=await ee(async()=>{const{doc:wl,updateDoc:zo}=await Promise.resolve().then(()=>kn);return{doc:wl,updateDoc:zo}},void 0,import.meta.url);Kd(Bs(K,"pendingSmsPopups",Xe),{lockedBy:Br}).catch(()=>{})}const vn=localStorage.getItem("deviceId"),hn=se.lockedBy===vn;if(se.lockedBy&&!hn&&(Vn.autoConfirm=!1),Vn.autoConfirm&&Number(Vn.autoConfirmDuration)===0&&(!se.lockedBy||hn))try{await _t({...Vn,walletId:Rn});try{const{doc:Br,updateDoc:Bs,serverTimestamp:Kd}=await ee(async()=>{const{doc:wl,updateDoc:zo,serverTimestamp:bm}=await Promise.resolve().then(()=>kn);return{doc:wl,updateDoc:zo,serverTimestamp:bm}},void 0,import.meta.url);await Bs(Br(K,"pendingSmsPopups",Xe),{status:"confirmed",confirmedAt:Kd()})}catch{}continue}catch(Br){console.error("Instant auto-confirm failed",Br)}if(Bn){console.log("Web Popup: Auto-confirming with countdown",Xe),qe(Vn),ve(!0);try{u({title:"  ( )",description:`   ${vt}  ${zt}`})}catch{}if(nn)try{ue()}catch{}else try{Re()}catch(Br){console.error("PlayBell failed",Br)}}else{qe(Vn),ve(!0);try{u({title:" ",description:se.lockedBy?"    ...":`   ${vt}  ${zt}`})}catch{}if(nn)try{ue()}catch{}else if(!se.lockedBy)try{Re()}catch(Br){console.error("PlayBell failed",Br)}}}}$e.type}}catch{}});Le.current=ft}catch{}})(),()=>{M=!1;try{const z=Le.current;typeof z=="function"&&z()}catch{}}},[r==null?void 0:r.uid]),y.useEffect(()=>{const M=(Te==null?void 0:Te.isNativePlatform)&&Te.getPlatform()==="android"||/android/i.test(navigator.userAgent.toLowerCase()),z=typeof window<"u"&&(window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"));if(M||z)return;let j=!1;return(async()=>{try{const Z="0.0.0",K=await fetch("https://cashy-link.com/desktop_version.json",{cache:"no-store"});if(!K.ok)return;const oe=await K.json(),H=String((oe==null?void 0:oe.version)||"0.0.0"),Ae=!!(oe!=null&&oe.force);if(!j&&((te,ne)=>{const be=String(te).split(".").map(Qe=>parseInt(Qe,10)||0),ze=String(ne).split(".").map(Qe=>parseInt(Qe,10)||0);for(let Qe=0;Qe<Math.max(be.length,ze.length);Qe++){const ft=be[Qe]||0,ut=ze[Qe]||0;if(ft>ut)return 1;if(ft<ut)return-1}return 0})(H,Z)>0){if(Ae){try{window.location.reload()}catch{}return}try{u({title:"  ",description:` ${H}      `})}catch{}}}catch{}})(),()=>{j=!0}},[]),y.useEffect(()=>{(async()=>{try{const M=(r==null?void 0:r.uid)||"",z=s||"";if(M){const{Preferences:j}=await ee(async()=>{const{Preferences:H}=await Promise.resolve().then(()=>cp);return{Preferences:H}},void 0,import.meta.url);await j.set({key:"bg_user_id",value:M}),await j.set({key:"bg_shop_id",value:z});const Z=localStorage.getItem(`sim1Number_${M}`)||localStorage.getItem("sim1Number")||"",K=localStorage.getItem(`sim2Number_${M}`)||localStorage.getItem("sim2Number")||"";Z&&await j.set({key:"sim1_number",value:Z}),K&&await j.set({key:"sim2_number",value:K});const oe=localStorage.getItem(`selectedWallet_${M}`)||"";oe&&await j.set({key:"bg_wallet_id",value:oe})}}catch(M){console.error("Failed to sync native preferences",M)}})()},[r==null?void 0:r.uid,s,Lt,q]),y.useEffect(()=>{if(Ie)try{const M=(r==null?void 0:r.uid)||"default",z=localStorage.getItem(`sim1Number_${M}`)??localStorage.getItem("sim1Number")??"",j=localStorage.getItem(`sim2Number_${M}`)??localStorage.getItem("sim2Number")??"";Ct(z),ge(j)}catch{}},[Ie,r==null?void 0:r.uid]);const Mt=(()=>{try{return String(localStorage.getItem("android_installed_version")||"").trim()}catch{return""}})(),Zn=(()=>{const M=(j,Z)=>{const K=String(j||"").replace(/^v/i,"").split(".").map(H=>parseInt(H,10)||0),oe=String(Z||"").replace(/^v/i,"").split(".").map(H=>parseInt(H,10)||0);for(let H=0;H<Math.max(K.length,oe.length);H++){const Ae=K[H]||0,st=oe[H]||0;if(Ae>st)return 1;if(Ae<st)return-1}return 0},z=[I,T,Mt].filter(Boolean);return z.length===0?"":z.reduce((j,Z)=>M(Z,j)>0?Z:j)})();return f.jsxs(f.Fragment,{children:[f.jsx(Ba,{open:rt,onOpenChange:()=>{},children:f.jsxs(xo,{hideClose:!0,disableOutsideClose:!0,disableEscClose:!0,className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[92vw] max-w-md max-h-[86vh] overflow-y-auto rounded-2xl bg-white/95 backdrop-blur border border-gray-200 shadow-[0_10px_40px_rgba(16,24,40,0.12)] p-5",onInteractOutside:M=>{try{M.preventDefault()}catch{}},onEscapeKeyDown:M=>{try{M.preventDefault()}catch{}},style:{paddingBottom:"env(safe-area-inset-bottom, 16px)"},children:[f.jsx("div",{className:"absolute inset-x-0 -top-1 mx-auto h-1 w-24 rounded-full bg-gradient-to-r from-blue-600 via-emerald-500 to-purple-600"}),f.jsx(rl,{className:"text-center",children:f.jsxs("div",{className:"flex items-center justify-center gap-3",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-11 h-11 rounded-xl bg-gradient-to-br from-blue-600 to-emerald-500 text-white",children:f.jsx(mE,{className:"w-6 h-6"})}),f.jsx(sl,{className:"text-lg font-extrabold tracking-tight text-gray-900",children:" "})]})}),f.jsx("div",{className:"mt-2 space-y-4 text-[0.95rem] leading-relaxed text-gray-800",children:f.jsxs("div",{className:"mt-4 text-center text-gray-700 leading-relaxed",children:[f.jsx("p",{children:"   .                    ."}),f.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"        ."})]})}),f.jsx("div",{className:"mt-4",children:f.jsx(wt,{className:"w-full h-10 rounded-xl bg-gradient-to-r from-blue-600 via-emerald-500 to-purple-600 hover:from-blue-700 hover:via-emerald-600 hover:to-purple-700 text-white font-semibold",onClick:ke,children:"  "})})]})}),(()=>{try{const M=(Te==null?void 0:Te.isNativePlatform)&&Te.getPlatform()==="android",z=(typeof window<"u"?window.__uid:"")||""}catch{}return null})(),le&&(Te==null?void 0:Te.isNativePlatform)&&Te.getPlatform()==="android"&&f.jsx("div",{className:"fixed inset-0 z-[3000] flex items-center justify-center p-4",style:{background:"linear-gradient(135deg, #0f172a, #111827)"},children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 max-w-sm w-full p-5 text-center",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 rounded-full bg-red-100 text-red-600 mx-auto",children:f.jsx("span",{className:"text-2xl",children:"!"})}),f.jsx("h2",{className:"mt-3 text-base md:text-lg font-bold text-gray-900",children:"   "}),f.jsx("p",{className:"mt-1 text-sm text-gray-700",children:"        "}),f.jsx("div",{className:"mt-3 flex items-center justify-center gap-3",children:f.jsx(wt,{variant:"outline",className:"h-8 min-w-[100px]",onClick:retryConnectivity,children:"  "})})]})}),h&&p&&f.jsx(Ba,{open:h,onOpenChange:M=>{p!=null&&p.force||m(M)},children:f.jsxs(xo,{className:"max-w-sm mx-auto bg-white border border-gray-200 shadow-2xl rounded-2xl sm:max-w-md",children:[f.jsxs(rl,{className:"text-center",children:[f.jsx(sl,{className:"text-base md:text-lg font-bold text-gray-900",children:p.title}),f.jsx(fI,{className:"text-sm text-gray-700 whitespace-pre-line",children:p.message}),f.jsx("div",{className:"mt-2 text-xs text-muted-foreground",children:Zn?`  : v${Zn}`:""})]}),f.jsxs("div",{className:"flex items-center justify-center gap-3 mt-3",children:[!p.force&&!g&&!S&&f.jsx(wt,{variant:"outline",className:"h-8 min-w-[80px]",onClick:()=>m(!1),children:""}),!S&&f.jsx(wt,{className:"h-8 min-w-[120px] bg-emerald-600 hover:bg-emerald-700 text-white",onClick:()=>{try{const M=String((p==null?void 0:p.versionId)||"").trim(),z=p==null?void 0:p.versionCode;if(M)try{localStorage.setItem("android_last_ack_version_id",M)}catch{}if(typeof z=="number")try{localStorage.setItem("android_last_ack_code",String(z))}catch{}if((async()=>{try{if(r!=null&&r.uid&&M){const{doc:Z,setDoc:K,serverTimestamp:oe}=await ee(async()=>{const{doc:st,setDoc:te,serverTimestamp:ne}=await Promise.resolve().then(()=>kn);return{doc:st,setDoc:te,serverTimestamp:ne}},void 0,import.meta.url),{db:H}=await ee(async()=>{const{db:st}=await Promise.resolve().then(()=>En);return{db:st}},void 0,import.meta.url),Ae={lastAckAndroidVersion:M,lastAckAt:oe()};typeof z=="number"&&(Ae.lastAckAndroidCode=z),await K(Z(H,"profiles",r.uid),Ae,{merge:!0})}}catch{}})(),(Te==null?void 0:Te.isNativePlatform)&&Te.getPlatform()==="android"){const Z=p.apkUrl,K=`cashy://update?url=${encodeURIComponent(Z)}`;E(!0),_({percent:0,downloaded:0,total:0});try{X.current&&clearInterval(X.current),X.current=setInterval(()=>{_(oe=>{const H=typeof(oe==null?void 0:oe.percent)=="number"?oe.percent:0,Ae=Ne.current?2:1;return{percent:Math.min(99,Math.max(0,Math.round(H+Ae))),downloaded:(oe==null?void 0:oe.downloaded)??0,total:(oe==null?void 0:oe.total)??0}})},600)}catch{}window.location.href=K;try{O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{try{Ne.current=!1}catch{}try{O.current=null}catch{}},8e3)}catch{}}else{const Z=p.apkUrl;try{window.open(Z,"_blank")}catch{}}}catch{}},children:g?" ...":" "}),S&&f.jsx(wt,{className:"h-8 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>{try{(Te==null?void 0:Te.isNativePlatform)&&Te.getPlatform()==="android"&&(m(!1),window.location.href="cashy://applyUpdate")}catch{}},children:" "})]}),g&&f.jsxs("div",{className:"mt-3 text-center",children:[f.jsx("div",{className:"w-full h-2 bg-gray-200 rounded",children:f.jsx("div",{className:"h-2 bg-emerald-600 rounded",style:{width:`${Math.max(0,Math.min(100,Math.round((b==null?void 0:b.percent)||0)))}%`}})}),f.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[Math.round((b==null?void 0:b.percent)||0),"%"]})]})]})}),!!r&&Ie&&f.jsx(Ba,{open:Ie,onOpenChange:async M=>{M&&ve(!0)},children:f.jsxs(xo,{className:"sm:max-w-[420px] rounded-2xl shadow-xl z-[9999] overflow-hidden border-0 p-0 gap-0",onInteractOutside:M=>{M.preventDefault()},onEscapeKeyDown:M=>{M.preventDefault()},hideClose:!0,children:[f.jsx("div",{className:"absolute left-4 top-4 z-50",children:f.jsx("button",{className:"p-2 rounded-full bg-black/10 hover:bg-black/20 text-white transition-colors backdrop-blur-sm",onClick:async()=>{if(ve(!1),J!=null&&J.popupId)try{const{db:M}=await ee(async()=>{const{db:K}=await Promise.resolve().then(()=>En);return{db:K}},void 0,import.meta.url),{doc:z,updateDoc:j,serverTimestamp:Z}=await ee(async()=>{const{doc:K,updateDoc:oe,serverTimestamp:H}=await Promise.resolve().then(()=>kn);return{doc:K,updateDoc:oe,serverTimestamp:H}},void 0,import.meta.url);await j(z(M,"pendingSmsPopups",J.popupId),{status:"dismissed",dismissedAt:Z()})}catch{}},children:f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"M18 6 6 18"}),f.jsx("path",{d:"m6 6 12 12"})]})})}),f.jsxs("div",{className:"flex flex-col h-full bg-white",children:[f.jsxs("div",{className:`p-6 pb-10 relative overflow-hidden ${J!=null&&J.isFakeSender?"bg-gradient-to-br from-red-600 to-red-700":(J==null?void 0:J.type)==="transfer"?"bg-gradient-to-br from-orange-500 to-red-500":"bg-gradient-to-br from-emerald-500 to-emerald-700"}`,children:[f.jsx("div",{className:"absolute top-0 right-0 p-0 opacity-10",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"180",height:"180",viewBox:"0 0 24 24",fill:"currentColor",className:"-mr-8 -mt-8",children:f.jsx("path",{d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"})})}),f.jsxs("div",{className:"relative z-10 text-center text-white",children:[f.jsx("h2",{className:"text-lg font-bold mb-1 opacity-90 flex items-center justify-center gap-2",children:(J==null?void 0:J.type)==="transfer"?f.jsx("span",{children:"  "}):f.jsx("span",{children:" "})}),f.jsx("div",{className:"text-sm font-medium opacity-80 mb-4",children:(J==null?void 0:J.providerLabel)||"Vodafone Cash"}),f.jsxs("div",{className:"flex items-center justify-center gap-1 my-4 scale-110",dir:"rtl",children:[f.jsx("span",{className:"text-5xl font-extrabold tracking-tight drop-shadow-md",children:Number((J==null?void 0:J.amount)||0).toLocaleString()}),f.jsx("span",{className:"text-xl font-medium opacity-90 mt-3",children:"."})]}),!!(J!=null&&J.autoConfirm)&&f.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 bg-white/20 backdrop-blur-md px-4 py-1.5 rounded-full text-sm font-medium border border-white/10 shadow-sm",children:[f.jsx("span",{className:"animate-pulse",children:""}),f.jsx("span",{children:"  ()"})]})]})]}),f.jsxs("div",{className:"px-5 pb-5 -mt-6 relative z-20 flex-1 flex flex-col",children:[f.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden mb-4",children:[(J==null?void 0:J.isFakeSender)&&f.jsxs("div",{className:"p-3 bg-red-50 border-b border-red-100 text-red-700 text-center text-sm font-bold flex items-center justify-center gap-2",children:[f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),f.jsx("path",{d:"M12 9v4"}),f.jsx("path",{d:"M12 17h.01"})]}),"     !"]}),f.jsxs("div",{className:"divide-y divide-gray-100",children:[f.jsx("div",{className:"p-4 flex items-center justify-between",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center text-blue-600",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:f.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})})}),f.jsxs("div",{className:"text-right",children:[f.jsx("div",{className:"text-xs text-gray-500",children:(J==null?void 0:J.type)==="transfer"?"":""}),f.jsx("div",{className:"font-bold text-gray-900 text-sm",dir:"ltr",children:(J==null?void 0:J.sender)||" "}),(J==null?void 0:J.senderName)&&f.jsx("div",{className:"text-xs text-emerald-600 font-semibold mt-0.5",children:J.senderName})]})]})}),f.jsx("div",{className:"p-4 flex items-center justify-between",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-50 flex items-center justify-center text-purple-600",children:f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("line",{x1:"4",x2:"20",y1:"9",y2:"9"}),f.jsx("line",{x1:"4",x2:"20",y1:"15",y2:"15"}),f.jsx("line",{x1:"10",x2:"8",y1:"3",y2:"21"}),f.jsx("line",{x1:"16",x2:"14",y1:"3",y2:"21"})]})}),f.jsxs("div",{className:"text-right",children:[f.jsx("div",{className:"text-xs text-gray-500",children:" "}),f.jsx("div",{className:"font-mono text-sm font-medium text-gray-700 max-w-[200px] truncate",title:J==null?void 0:J.reference,children:(J==null?void 0:J.reference)||"---"})]})]})}),f.jsx("div",{className:"p-4 flex items-center justify-between bg-gray-50/50",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-50 flex items-center justify-center text-amber-600",children:f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1"}),f.jsx("path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4"})]})}),f.jsxs("div",{className:"text-right",children:[f.jsx("div",{className:"text-xs text-gray-500",children:" "}),f.jsx("div",{className:"font-bold text-gray-900 text-sm",dir:"ltr",children:(J==null?void 0:J.walletMsisdn)||f.jsx("span",{className:"text-amber-600 text-xs px-2 py-0.5 rounded bg-amber-100",children:" ..."})})]})]})})]})]}),(J==null?void 0:J.simSelectionRequired)&&f.jsxs("div",{className:"mb-4 bg-amber-50 rounded-xl p-3 border border-amber-200 animate-in fade-in zoom-in duration-300",children:[f.jsx("div",{className:"text-xs font-bold text-amber-800 mb-2 text-center",children:"   "}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("button",{className:"flex-1 py-2.5 bg-white border border-amber-300 rounded-lg text-amber-900 font-bold hover:bg-amber-100 transition-colors shadow-sm",onClick:async()=>{const M=J.sim1Number||localStorage.getItem("sim1Number")||"",z={...J,simSelectionRequired:!1,simLabel:"SIM 1",simNumber:ae(M),simSlot:0};qe(z);try{const{resolveWalletBySimOrSlot:j}=await ee(async()=>{const{resolveWalletBySimOrSlot:K}=await Promise.resolve().then(()=>Di);return{resolveWalletBySimOrSlot:K}},void 0,import.meta.url),Z=await j({simNumbers:[z.simNumber],userId:r==null?void 0:r.uid,slotIndex:0});Z&&Z.walletId&&qe({...z,walletMsisdn:Z.msisdn,walletId:Z.walletId})}catch{}},children:["SIM 1",Lt&&f.jsx("div",{className:"text-[10px] font-normal opacity-75",children:Lt})]}),f.jsxs("button",{className:"flex-1 py-2.5 bg-white border border-amber-300 rounded-lg text-amber-900 font-bold hover:bg-amber-100 transition-colors shadow-sm",onClick:async()=>{const M=J.sim2Number||localStorage.getItem("sim2Number")||"",z={...J,simSelectionRequired:!1,simLabel:"SIM 2",simNumber:ae(M),simSlot:1};qe(z);try{const{resolveWalletBySimOrSlot:j}=await ee(async()=>{const{resolveWalletBySimOrSlot:K}=await Promise.resolve().then(()=>Di);return{resolveWalletBySimOrSlot:K}},void 0,import.meta.url),Z=await j({simNumbers:[z.simNumber],userId:r==null?void 0:r.uid,slotIndex:1});Z&&Z.walletId&&qe({...z,walletMsisdn:Z.msisdn,walletId:Z.walletId})}catch{}},children:["SIM 2",q&&f.jsx("div",{className:"text-[10px] font-normal opacity-75",children:q})]})]})]}),Xn&&f.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 p-3 rounded-xl border border-gray-100 mb-4",children:[f.jsx("input",{type:"number",step:"0.01",min:"0",value:dn,onChange:M=>dr(M.target.value),className:"w-24 text-center font-bold border rounded-lg px-2 py-1.5 focus:ring-2 focus:ring-emerald-500 outline-none",placeholder:"0.00"}),f.jsx("span",{className:"text-sm font-medium text-gray-600 flex-1 text-right",children:"  ()"})]}),nt&&f.jsxs("div",{className:"bg-amber-50 rounded-xl p-4 border border-amber-100 space-y-3 animate-in fade-in slide-in-from-top-2 mb-4",children:[f.jsxs("div",{className:"flex items-center justify-between text-amber-800",children:[f.jsxs("span",{className:"font-bold text-lg",children:[Ce.toLocaleString()," ."]}),f.jsx("span",{className:"text-sm font-medium",children:"   ()"})]}),f.jsx("input",{type:"text",value:Lr,onChange:M=>Q(M.target.value),className:"w-full border-amber-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-amber-500 outline-none",placeholder:"  ()",autoFocus:!0}),f.jsx(wt,{size:"sm",className:"w-full bg-amber-600 hover:bg-amber-700 text-white font-medium",onClick:()=>{Or(!0),he(!1)},children:"  "})]}),Dr&&!nt&&f.jsxs("div",{className:"bg-amber-50 border border-amber-200 text-amber-800 rounded-lg p-3 text-sm flex items-center justify-between mb-4",children:[f.jsx("button",{onClick:()=>he(!0),className:"text-amber-600 underline text-xs",children:""}),f.jsxs("span",{children:["   ",f.jsx("b",{children:""})," : ",Lr||" "]})]}),f.jsxs("div",{className:"mt-auto space-y-3",children:[f.jsx(Ste,{enabled:!!(J!=null&&J.autoConfirm)&&Number((J==null?void 0:J.autoConfirmDuration)??(n==null?void 0:n.smsAutoConfirmDuration)??5)>0,isLocal:!!(J!=null&&J.isLocal),duration:Math.max(0,Number((J==null?void 0:J.autoConfirmDuration)??(n==null?void 0:n.smsAutoConfirmDuration)??5)),onConfirm:()=>{try{_t({...J,deferredMode:Dr,debtorName:Lr,debtorNote:de})}catch{_t()}}}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx(wt,{variant:"outline",className:"flex-1 border-amber-200 text-amber-700 hover:bg-amber-50 hover:text-amber-800 h-12 text-base rounded-xl",disabled:!1,onClick:async()=>{var M;try{const j=String((J==null?void 0:J.text)||"").match(/\s+(\d+(?:[\.,]\d+)?)\s*/i),Z=j?parseFloat(String(j[1]).replace(",",".")):Number((J==null?void 0:J.amount)||0),{auth:K}=await ee(async()=>{const{auth:Qe}=await Promise.resolve().then(()=>En);return{auth:Qe}},void 0,import.meta.url),oe=((M=K.currentUser)==null?void 0:M.uid)||"",H=J==null?void 0:J.walletId,Ae=oe?`selectedWallet_${oe}`:"selectedWallet_default",st=H||localStorage.getItem(Ae)||"",te=dn&&dn.trim()!==""?Math.max(0,parseFloat(dn)):null;let ne=0;if(te!=null)ne=te;else try{const{merchantWalletService:Qe}=await ee(async()=>{const{merchantWalletService:Pe}=await Promise.resolve().then(()=>uo);return{merchantWalletService:Pe}},void 0,import.meta.url),ft=await Qe.getById(String(st)),ut=ft&&ft.defaultWithdrawCommission;if(ut!=null)ne=Math.round((Number(ut)||0)*Number(Z)/1e3*100)/100;else{const{calculateCommission:Pe}=await ee(async()=>{const{calculateCommission:it}=await Promise.resolve().then(()=>Eo);return{calculateCommission:it}},void 0,import.meta.url);ne=Pe(Number(Z),"receive")}}catch{const{calculateCommission:Qe}=await ee(async()=>{const{calculateCommission:ft}=await Promise.resolve().then(()=>Eo);return{calculateCommission:ft}},void 0,import.meta.url);ne=Qe(Number(Z),"receive")}const ze=((localStorage.getItem("commissionMode")||"").toLowerCase()==="add"?"add":"deduct")==="add"?Number(Z)+Number(ne):Number(Z);Ue(Math.round(ze*100)/100),he(!0)}catch{he(!0)}},children:" ()"}),f.jsx(wt,{className:`flex-[2] h-12 text-base font-bold shadow-lg rounded-xl text-white ${(J==null?void 0:J.type)==="transfer"?"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 shadow-orange-200":"bg-gradient-to-r from-emerald-600 to-emerald-500 hover:from-emerald-700 hover:to-emerald-600 shadow-emerald-200"}`,disabled:!1,onClick:()=>{try{_t({...J,deferredMode:Dr,debtorName:Lr,debtorNote:de})}catch{_t()}},children:" "})]})]})]})]})]})})]})},Ste=({enabled:t,duration:e,onConfirm:n,isLocal:r})=>{const[s,i]=V.useState(e),[o,a]=V.useState(!1),l=V.useRef(n),c=V.useRef(null);if(V.useEffect(()=>{l.current=n},[n]),V.useEffect(()=>{t&&(i(e),a(!1),c.current=Date.now()+e*1e3)},[t,e]),V.useEffect(()=>{if(!t||o){c.current=null;return}c.current===null&&(c.current=Date.now()+s*1e3);const h=setInterval(()=>{const m=Date.now(),p=c.current||m+1e3,v=Math.max(0,(p-m)/1e3);i(v),v<=0&&(clearInterval(h),l.current())},100);return()=>clearInterval(h)},[t,o,r]),!t)return null;const u=Math.min(100,Math.max(0,s/e*100));return f.jsxs("div",{className:"mb-4 relative overflow-hidden rounded-xl bg-emerald-50 border border-emerald-100 p-3 shadow-inner",children:[f.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[f.jsxs("div",{className:"flex items-center gap-2 text-emerald-900 font-bold text-sm",children:[f.jsx("div",{className:"relative w-5 h-5 flex items-center justify-center",children:f.jsxs("svg",{className:"animate-spin text-emerald-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),f.jsxs("span",{children:["   ",Math.ceil(s)," "]})]}),f.jsx("button",{onClick:()=>a(!0),className:"text-xs font-bold text-white bg-emerald-500 hover:bg-emerald-600 px-3 py-1.5 rounded-lg shadow-sm transition-all active:scale-95",children:""})]}),f.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-emerald-200 w-full"}),f.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-emerald-600 transition-all duration-100 ease-linear",style:{width:`${u}%`}})]})},sR=()=>{const t=Ii(),{user:e}=Zs(),n=t.pathname.startsWith("/user/login")||t.pathname.startsWith("/auth")||t.pathname.startsWith("/admin/login")||t.pathname.startsWith("/cpanel/login")||t.pathname.startsWith("/dashboard/login")||t.pathname==="/"||t.pathname.startsWith("/landing");return e&&!n?f.jsxs(f.Fragment,{children:[f.jsx(c$,{}),f.jsx(Ck,{})]}):null},iR=()=>{const{user:t,loading:e}=Zs(),[n,r]=y.useState(!0),s=io();return y.useEffect(()=>{const i=setTimeout(()=>r(!1),7e3);return()=>clearTimeout(i)},[]),y.useEffect(()=>{(async()=>{if(Te.isNativePlatform()&&Te.getPlatform()==="android")if(!e)setTimeout(async()=>{try{await RP.hide()}catch(o){console.warn("Error hiding splash:",o)}},100);else{const o=setTimeout(async()=>{try{await RP.hide()}catch{}},8e3);return()=>clearTimeout(o)}})()},[e]),y.useEffect(()=>{if(e)r(!0);else{try{window.dispatchEvent(new CustomEvent("loader:finish"))}catch{}const i=()=>r(!1);try{window.addEventListener("loader:progress-done",i)}catch{}const o=setTimeout(()=>r(!1),1500);return()=>{try{window.removeEventListener("loader:progress-done",i)}catch{}clearTimeout(o)}}},[e]),y.useEffect(()=>{if(!n&&!e&&!t)try{s("/user/login")}catch{}},[n,e,t]),n?f.jsx(cb,{}):t?f.jsx(tg,{}):f.jsx(hy,{})},Ite=()=>(y.useEffect(()=>{const t=document.getElementById("app-loading-screen");t&&(t.style.opacity="0",t.style.transition="opacity 0.2s ease",setTimeout(()=>t.remove(),200))},[]),f.jsx(p9,{client:jl,children:f.jsx(xz,{children:f.jsxs(k6,{children:[typeof window<"u"&&(window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"))&&!(Te!=null&&Te.isNativePlatform&&Te.getPlatform()==="android")&&f.jsx(Nee,{}),f.jsx(wte,{}),f.jsx(bte,{}),typeof window<"u"&&(window.electronAPI||window.location.protocol==="file:"||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron")||typeof window.location.hash=="string"&&window.location.hash.startsWith("#/")||typeof import.meta<"u"&&_te||Te!=null&&Te.isNativePlatform&&Te.getPlatform()==="android")?f.jsxs(Ez,{children:[f.jsx(rR,{}),f.jsx(sR,{}),f.jsx(y.Suspense,{fallback:f.jsx(cb,{}),children:f.jsxs(qx,{children:[f.jsx(je,{path:"/",element:Te!=null&&Te.isNativePlatform&&Te.getPlatform()==="android"?f.jsx(iR,{}):f.jsx(yp,{})}),f.jsx(je,{path:"/dashboard-redirect",element:f.jsx(LP,{})}),f.jsx(je,{path:"/landing",element:f.jsx(yp,{})}),f.jsx(je,{path:"/subscriptions",element:f.jsx(MP,{})}),f.jsx(je,{path:"/auth",element:f.jsx(VP,{})}),f.jsx(je,{path:"/user/login",element:f.jsx(hy,{})}),f.jsx(je,{path:"/user/forgot-password",element:f.jsx($P,{})}),f.jsx(je,{path:"/user/register",element:f.jsx(wp,{})}),f.jsx(je,{path:"/register",element:f.jsx(wp,{})}),f.jsx(je,{path:"/user/account-setup",element:f.jsx(UP,{})}),f.jsx(je,{path:"/user/pending-approval",element:f.jsx(qP,{})}),f.jsx(je,{path:"/user/dashboard",element:f.jsx(tg,{})}),f.jsx(je,{path:"/branch/:shopId/dashboard",element:f.jsx(tg,{})}),f.jsx(je,{path:"/user/add-wallet",element:f.jsx(JP,{})}),f.jsx(je,{path:"/admin/login",element:f.jsx(HP,{})}),f.jsx(je,{path:"/admin/dashboard",element:f.jsx(KP,{})}),f.jsx(je,{path:"/admin/topups",element:f.jsx(jP,{})}),f.jsx(je,{path:"/admin/notifications",element:f.jsx(FP,{})}),f.jsx(je,{path:"/profile-settings",element:f.jsx(QP,{})}),f.jsx(je,{path:"/transactions",element:f.jsx(YP,{})}),f.jsx(je,{path:"/referrals",element:f.jsx(XP,{})}),f.jsx(je,{path:"/privacy-policy",element:f.jsx(eR,{})}),f.jsx(je,{path:"/cpanel",element:f.jsx(EP,{})}),f.jsx(je,{path:"/cpanel/login",element:f.jsx(SP,{})}),f.jsx(je,{path:"/auth-test",element:f.jsx(GP,{})}),f.jsx(je,{path:"/topup",element:f.jsx(vp,{})}),f.jsx(je,{path:"/recharge",element:f.jsx(vp,{})}),f.jsx(je,{path:"/merchant/*",element:f.jsx(WP,{})}),f.jsx(je,{path:"/dashboard/login",element:f.jsx(BP,{})}),f.jsx(je,{path:"/dashboard",element:f.jsx(zP,{})}),f.jsxs(je,{path:"/sms-portal",element:f.jsx(IP,{}),children:[f.jsx(je,{index:!0,element:f.jsx(pp,{})}),f.jsx(je,{path:"login",element:f.jsx(pp,{})}),f.jsx(je,{path:"dashboard",element:f.jsx(xP,{})})]}),f.jsx(je,{path:"*",element:f.jsx(ZP,{})})]})}),f.jsx(DP,{position:"right"}),f.jsx(tR,{})]}):f.jsxs(bz,{children:[f.jsx(rR,{}),f.jsx(sR,{}),f.jsx(y.Suspense,{fallback:f.jsx(cb,{}),children:f.jsxs(qx,{children:[f.jsx(je,{path:"/",element:Te!=null&&Te.isNativePlatform&&Te.getPlatform()==="android"?f.jsx(iR,{}):f.jsx(yp,{})}),f.jsx(je,{path:"/dashboard-redirect",element:f.jsx(LP,{})}),f.jsx(je,{path:"/landing",element:f.jsx(yp,{})}),f.jsx(je,{path:"/subscriptions",element:f.jsx(MP,{})}),f.jsx(je,{path:"/auth",element:f.jsx(VP,{})}),f.jsx(je,{path:"/user/login",element:f.jsx(hy,{})}),f.jsx(je,{path:"/user/forgot-password",element:f.jsx($P,{})}),f.jsx(je,{path:"/user/register",element:f.jsx(wp,{})}),f.jsx(je,{path:"/register",element:f.jsx(wp,{})}),f.jsx(je,{path:"/user/account-setup",element:f.jsx(UP,{})}),f.jsx(je,{path:"/user/pending-approval",element:f.jsx(qP,{})}),f.jsx(je,{path:"/user/dashboard",element:f.jsx(tg,{})}),f.jsx(je,{path:"/user/add-wallet",element:f.jsx(JP,{})}),f.jsx(je,{path:"/admin/login",element:f.jsx(HP,{})}),f.jsx(je,{path:"/admin/dashboard",element:f.jsx(KP,{})}),f.jsx(je,{path:"/admin/topups",element:f.jsx(jP,{})}),f.jsx(je,{path:"/admin/notifications",element:f.jsx(FP,{})}),f.jsx(je,{path:"/profile-settings",element:f.jsx(QP,{})}),f.jsx(je,{path:"/transactions",element:f.jsx(YP,{})}),f.jsx(je,{path:"/referrals",element:f.jsx(XP,{})}),f.jsx(je,{path:"/privacy-policy",element:f.jsx(eR,{})}),f.jsx(je,{path:"/cpanel",element:f.jsx(EP,{})}),f.jsx(je,{path:"/cpanel/login",element:f.jsx(SP,{})}),f.jsx(je,{path:"/auth-test",element:f.jsx(GP,{})}),f.jsx(je,{path:"/topup",element:f.jsx(vp,{})}),f.jsx(je,{path:"/recharge",element:f.jsx(vp,{})}),f.jsx(je,{path:"/merchant/*",element:f.jsx(WP,{})}),f.jsx(je,{path:"/dashboard/login",element:f.jsx(BP,{})}),f.jsx(je,{path:"/dashboard",element:f.jsx(zP,{})}),f.jsxs(je,{path:"/sms-portal",element:f.jsx(IP,{}),children:[f.jsx(je,{index:!0,element:f.jsx(pp,{})}),f.jsx(je,{path:"login",element:f.jsx(pp,{})}),f.jsx(je,{path:"dashboard",element:f.jsx(xP,{})})]}),f.jsx(je,{path:"*",element:f.jsx(ZP,{})})]})}),f.jsx(DP,{position:"right"}),f.jsx(tR,{})]})]})})})),Oj=y.createContext(void 0),Tte=({children:t})=>{const[e,n]=y.useState(null),[r,s]=y.useState(!1),[i,o]=y.useState(null),{profile:a,user:l}=Zs();y.useEffect(()=>{try{const p=localStorage.getItem("cashier_shift_user"),v=localStorage.getItem("cashier_shift_active"),g=localStorage.getItem("cashier_shift_start_at");p&&n(JSON.parse(p)),v&&s(v==="true"),g&&o(Number(g))}catch{}},[]);const c=async()=>{if(a!=null&&a.shopId)try{const p=ye(F,"cashierShift",a.shopId),v=await Sn(p);if(v.exists()){const g=v.data(),E=!!(g!=null&&g.isShiftActive),b=(g==null?void 0:g.shiftStartAt)??null,_=localStorage.getItem("cashier_shift_active")==="true";if(!E&&_){s(!1),n(null),localStorage.setItem("cashier_shift_active","false"),localStorage.removeItem("cashier_shift_user");return}if(E&&!_){s(!1),n(null);return}if(E&&_){s(!0);try{const S=localStorage.getItem("cashier_shift_user");S&&n(JSON.parse(S))}catch{}b&&(o(Number(b)),localStorage.setItem("cashier_shift_start_at",String(b)))}}else await rn(p,{isShiftActive:!1,shiftStartAt:null,shiftUser:null})}catch(p){console.warn("Failed to refresh shift status:",p)}};y.useEffect(()=>{c()},[a==null?void 0:a.shopId]);const u=p=>{n(p);try{p?localStorage.setItem("cashier_shift_user",JSON.stringify(p)):localStorage.removeItem("cashier_shift_user")}catch{}try{if(a!=null&&a.shopId){const v=ye(F,"cashierShift",a.shopId);xn(v,{shiftUser:p||null})}}catch{}},h=()=>{s(!0);try{localStorage.setItem("cashier_shift_active","true")}catch{}const p=Date.now();o(p);try{localStorage.setItem("cashier_shift_start_at",String(p))}catch{}try{if(a!=null&&a.shopId){const v=ye(F,"cashierShift",a.shopId);xn(v,{isShiftActive:!0,shiftStartAt:p})}}catch{}try{const g=`cashBalance_${(l==null?void 0:l.uid)||"default"}`,E=`userCashBalance_${(l==null?void 0:l.uid)||"default"}`,b=`walletBalances_${(l==null?void 0:l.uid)||"default"}`,_=localStorage.getItem("lastKnownCashBalance"),S=localStorage.getItem("lastKnownWalletBalances");let P=localStorage.getItem(g);if((!P||P==="0")&&_&&_!=="0"&&(P=_),P==null){const N=localStorage.getItem(E);if(N!=null){P=N;try{localStorage.setItem(g,N),localStorage.removeItem(E)}catch{}}}if(P==null&&(l!=null&&l.uid)){const N=localStorage.getItem("cashBalance"),I=localStorage.getItem("userCashBalance");if(N!=null){try{localStorage.setItem(g,N),localStorage.removeItem("cashBalance")}catch{}P=N}else if(I!=null){try{localStorage.setItem(g,I),localStorage.removeItem("userCashBalance")}catch{}P=I}}let T=localStorage.getItem(b);(!T||T==="{}")&&S&&S!=="{}"&&(T=S),P?localStorage.setItem("shiftStartDrawerFunds",P):localStorage.setItem("shiftStartDrawerFunds","0"),T?localStorage.setItem("shiftStartWalletBalances",T):localStorage.setItem("shiftStartWalletBalances","{}")}catch{}try{a!=null&&a.shopId&&(async()=>{try{const v=ye(F,"dashboardData",a.shopId),g=await Sn(v);if(g.exists()){const E=g.data(),b=Number((E==null?void 0:E.cashBalance)??0),_=(E==null?void 0:E.walletBalances)??{};try{const S=localStorage.getItem("lastKnownCashBalance"),P=localStorage.getItem("lastKnownWalletBalances"),T=localStorage.getItem("shiftStartDrawerFunds"),N=localStorage.getItem("shiftStartWalletBalances"),I=T?parseFloat(T):0,A=N?JSON.parse(N):{},R=!T||!Number.isFinite(I)||I===0,k=!N||Object.keys(A||{}).length===0;R&&(b===0&&S&&S!=="0"?localStorage.setItem("shiftStartDrawerFunds",S):localStorage.setItem("shiftStartDrawerFunds",String(Number.isFinite(b)?b:0))),k&&((!_||Object.keys(_).length===0)&&P&&P!=="{}"?localStorage.setItem("shiftStartWalletBalances",P):localStorage.setItem("shiftStartWalletBalances",JSON.stringify(_||{})))}catch{}}}catch(v){console.warn("Shift start Firebase read failed:",v)}})()}catch{}},m=()=>{s(!1);try{localStorage.setItem("cashier_shift_active","false")}catch{}try{if(a!=null&&a.shopId){const p=ye(F,"cashierShift",a.shopId);xn(p,{isShiftActive:!1})}}catch{}};return f.jsx(Oj.Provider,{value:{shiftUser:e,isShiftActive:r,shiftStartAt:i,setShiftUser:u,startShift:h,endShift:m,refreshShiftStatus:c},children:t})},mne=()=>{const t=y.useContext(Oj);if(!t)throw new Error("useShift must be used within ShiftProvider");return t};class xte extends y.Component{constructor(){super(...arguments);Xd(this,"state",{hasError:!1,error:null});Xd(this,"handleReload",()=>{window.location.reload()})}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("Uncaught error:",n,r)}render(){var n,r,s,i,o,a,l;if(this.state.hasError){const c=((r=(n=this.state.error)==null?void 0:n.message)==null?void 0:r.includes("removeChild"))||((i=(s=this.state.error)==null?void 0:s.message)==null?void 0:i.includes("NotFoundError"))||((a=(o=this.state.error)==null?void 0:o.message)==null?void 0:a.includes("The node to be removed is not a child of this node"));if(c){const u=parseInt(sessionStorage.getItem("node_error_reload_count")||"0");if(u<2)return sessionStorage.setItem("node_error_reload_count",String(u+1)),window.location.reload(),null;setTimeout(()=>sessionStorage.removeItem("node_error_reload_count"),1e4)}return f.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50 p-4 text-center dark:bg-gray-900",children:f.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 space-y-4",children:[f.jsx("div",{className:"flex justify-center",children:f.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 rounded-full",children:f.jsx(vk,{className:"w-8 h-8 text-red-600 dark:text-red-400"})})}),f.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"    "}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:c?"         .   .":"    .    ."}),typeof window<"u"&&window.Capacitor&&f.jsx("pre",{className:"text-xs text-left bg-gray-100 dark:bg-gray-950 p-2 rounded overflow-auto max-h-32 dir-ltr",children:(l=this.state.error)==null?void 0:l.toString()}),f.jsxs(wt,{onClick:this.handleReload,className:"w-full gap-2",children:[f.jsx(fE,{className:"w-4 h-4"})," "]})]})})}return this.props.children}}try{const t=navigator.userAgent||navigator.vendor||"",e=/iPad|iPhone|iPod/.test(t),n=document.documentElement;n&&(n.classList.toggle("ios",e),n.classList.toggle("android",!e))}catch{}try{hj()}catch{}try{window.useState=V.useState,window.useEffect=V.useEffect,window.useRef=V.useRef,window.createContext=V.createContext}catch{}const Ate=()=>{const{theme:t="system"}=Rk();return y.useEffect(()=>{try{const e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,n=t==="system"?e?"dark":"light":t;document.documentElement.setAttribute("data-theme",n||"light"),document.documentElement.classList.toggle("dark",n==="dark")}catch{}},[t]),null};$N(document.getElementById("root")).render(f.jsx(xte,{children:f.jsx(h$,{attribute:"class",defaultTheme:"system",enableSystem:!0,storageKey:"theme",children:f.jsx(aee,{children:f.jsx(Tte,{children:f.jsxs(ete,{children:[f.jsx(Ite,{}),f.jsx(Ate,{})]})})})})}));export{rn as $,iV as A,wt as B,ax as C,Ls as D,Be as E,v5 as F,s0 as G,Uy as H,ar as I,jh as J,Fh as K,y0 as L,Hc as M,Bte as N,mk as O,s5 as P,u7 as Q,V as R,gk as S,ij as T,I5 as U,Vo as V,ye as W,aP as X,mE as Y,kt as Z,w2 as _,io as a,r0 as a$,Ot as a0,Sn as a1,Pa as a2,lx as a3,V3 as a4,k3 as a5,Ll as a6,xX as a7,gy as a8,ib as a9,hne as aA,sV as aB,lX as aC,Xte as aD,aX as aE,bX as aF,wU as aG,hV as aH,ux as aI,n5 as aJ,lb as aK,Oe as aL,fI as aM,Nte as aN,Hn as aO,Nv as aP,mne as aQ,ee as aR,yee as aS,fE as aT,nj as aU,Mv as aV,kj as aW,pk as aX,$3 as aY,uV as aZ,Zh as a_,TP as aa,yn as ab,Fy as ac,Ii as ad,Ps as ae,mr as af,tte as ag,Ba as ah,xo as ai,rl as aj,sl as ak,Sc as al,AU as am,Sw as an,_n as ao,en as ap,Qn as aq,ste as ar,lE as as,jr as at,xn as au,cx as av,yk as aw,Ui as ax,Sl as ay,vj as az,fne as b,mA as b$,sj as b0,qx as b1,je as b2,_X as b3,R3 as b4,x5 as b5,KV as b6,Te as b7,NP as b8,I3 as b9,b5 as bA,Yf as bB,qk as bC,Dte as bD,Zi as bE,JU as bF,u6 as bG,aE as bH,Qf as bI,MZ as bJ,YX as bK,IV as bL,pV as bM,My as bN,d6 as bO,ite as bP,h6 as bQ,cI as bR,Vee as bS,BN as bT,d5 as bU,ine as bV,vk as bW,zD as bX,uy as bY,Gte as bZ,TQ as b_,c5 as ba,wX as bb,hE as bc,O3 as bd,fj as be,A3 as bf,XQ as bg,yI as bh,cb as bi,wY as bj,Si as bk,lee as bl,zk as bm,CD as bn,rne as bo,XZ as bp,eee as bq,sne as br,zV as bs,WV as bt,qV as bu,tee as bv,BV as bw,ZZ as bx,Lz as by,Iee as bz,wd as c,pA as c0,Hte as c1,Wte as c2,Rk as c3,uj as c4,AX as c5,tne as c6,nne as c7,SX as c8,cne as c9,Ky as cA,G6 as cB,U6 as cC,Mte as cD,d0 as cE,ns as cF,Gy as cG,j6 as cH,F6 as cI,Ng as cJ,uD as cK,l9 as cL,z6 as cM,rs as cN,Vte as cO,kn as cP,En as cQ,uo as cR,cp as cS,one as cT,ane as cU,lne as cV,Cee as cW,dne as cX,Uf as cY,kee as ca,Ac as cb,c7 as cc,Kte as cd,aj as ce,lj as cf,AR as cg,Rte as ch,sn as ci,Ah as cj,$te as ck,Ute as cl,Ml as cm,K3 as cn,Oee as co,Dee as cp,une as cq,tc as cr,EX as cs,Cte as ct,Hd as cu,Ree as cv,Zte as cw,Pee as cx,ene as cy,Aee as cz,_d as d,bd as e,jv as f,Ed as g,rj as h,nte as i,f as j,zte as k,See as l,ll as m,oj as n,_ee as o,qt as p,Ye as q,y as r,xe as s,F as t,Zs as u,Gs as v,di as w,et as x,vr as y,JY as z};
//# sourceMappingURL=index-CgV0sHeM.js.map
