{"version":3,"file":"dailyOperationCountService-BuoXgFag-ByT7vHq7.js","sources":["../../assets/dailyOperationCountService-BuoXgFag.js"],"sourcesContent":["import{y as c,i as d,H as f,s as u,K as C}from\"./index-tnWDkOuX.js\";const g={getCurrentDayId(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,\"0\")}-${String(n.getDate()).padStart(2,\"0\")}`},async getCounts(n,i){const r=i||this.getCurrentDayId(),e=c(d,\"users\",n,\"dailyOps\",r),s=await C(e);if(!s.exists()){const a={dayId:r,confirmTransferCount:0,confirmWithdrawCount:0,updatedAt:u()};return await f(e,a),{...a,updatedAt:new Date}}const t=s.data();return{dayId:r,confirmTransferCount:Number((t==null?void 0:t.confirmTransferCount)||0),confirmWithdrawCount:Number((t==null?void 0:t.confirmWithdrawCount)||0),updatedAt:(t==null?void 0:t.updatedAt)||u()}},async checkAndIncrement(n,i,r){const e=this.getCurrentDayId(),s=c(d,\"users\",n,\"dailyOps\",e),t=await this.getCounts(n,e),a=i===\"transfer\"?t.confirmTransferCount:t.confirmWithdrawCount;if(a>=r)return{allowed:!1,remaining:0};const o={updatedAt:u()};return i===\"transfer\"?o.confirmTransferCount=t.confirmTransferCount+1:o.confirmWithdrawCount=t.confirmWithdrawCount+1,await f(s,o,{merge:!0}),{allowed:!0,remaining:Math.max(0,r-(a+1))}},async checkAndIncrementCombined(n,i,r){const e=this.getCurrentDayId(),s=c(d,\"users\",n,\"dailyOps\",e),t=await this.getCounts(n,e),a=Number(t.confirmTransferCount||0)+Number(t.confirmWithdrawCount||0);if(a>=r)return{allowed:!1,remaining:0};const o={updatedAt:u()};return i===\"transfer\"?o.confirmTransferCount=t.confirmTransferCount+1:o.confirmWithdrawCount=t.confirmWithdrawCount+1,await f(s,o,{merge:!0}),{allowed:!0,remaining:Math.max(0,r-(a+1))}}};export{g as dailyOperationCountService,g as default};\r\n//# sourceMappingURL=dailyOperationCountService-BuoXgFag.js.map\r\n"],"names":["g","n","r","c","d","s","C","u","f"],"mappings":"oEAAyE,MAACA,EAAE,CAAC,iBAAiB,CAAC,MAAMC,EAAE,IAAI,KAAK,MAAM,GAAGA,EAAE,YAAW,CAAE,IAAI,OAAOA,EAAE,SAAQ,EAAG,CAAC,EAAE,SAAS,EAAE,GAAG,CAAC,IAAI,OAAOA,EAAE,QAAO,CAAE,EAAE,SAAS,EAAE,GAAG,CAAC,EAAE,EAAE,MAAM,UAAUA,EAAE,EAAE,CAAC,MAAMC,EAAE,GAAG,KAAK,gBAAe,EAAG,EAAEC,EAAEC,EAAE,QAAQH,EAAE,WAAWC,CAAC,EAAEG,EAAE,MAAMC,EAAE,CAAC,EAAE,GAAG,CAACD,EAAE,OAAM,EAAG,CAAC,MAAM,EAAE,CAAC,MAAMH,EAAE,qBAAqB,EAAE,qBAAqB,EAAE,UAAUK,EAAC,CAAE,EAAE,OAAO,MAAMC,EAAE,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,UAAU,IAAI,IAAI,CAAC,CAAC,MAAM,EAAEH,EAAE,KAAI,EAAG,MAAM,CAAC,MAAMH,EAAE,qBAAqB,QAAQ,GAAG,KAAK,OAAO,EAAE,uBAAuB,CAAC,EAAE,qBAAqB,QAAQ,GAAG,KAAK,OAAO,EAAE,uBAAuB,CAAC,EAAE,WAAW,GAAG,KAAK,OAAO,EAAE,YAAYK,EAAC,CAAE,CAAC,EAAE,MAAM,kBAAkBN,EAAE,EAAEC,EAAE,CAAC,MAAM,EAAE,KAAK,gBAAe,EAAGG,EAAEF,EAAEC,EAAE,QAAQH,EAAE,WAAW,CAAC,EAAE,EAAE,MAAM,KAAK,UAAUA,EAAE,CAAC,EAAE,EAAE,IAAI,WAAW,EAAE,qBAAqB,EAAE,qBAAqB,GAAG,GAAGC,EAAE,MAAM,CAAC,QAAQ,GAAG,UAAU,CAAC,EAAE,MAAM,EAAE,CAAC,UAAUK,EAAC,CAAE,EAAE,OAAO,IAAI,WAAW,EAAE,qBAAqB,EAAE,qBAAqB,EAAE,EAAE,qBAAqB,EAAE,qBAAqB,EAAE,MAAMC,EAAEH,EAAE,EAAE,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,QAAQ,GAAG,UAAU,KAAK,IAAI,EAAEH,GAAG,EAAE,EAAE,CAAC,CAAC,EAAE,MAAM,0BAA0BD,EAAE,EAAEC,EAAE,CAAC,MAAM,EAAE,KAAK,gBAAe,EAAGG,EAAEF,EAAEC,EAAE,QAAQH,EAAE,WAAW,CAAC,EAAE,EAAE,MAAM,KAAK,UAAUA,EAAE,CAAC,EAAE,EAAE,OAAO,EAAE,sBAAsB,CAAC,EAAE,OAAO,EAAE,sBAAsB,CAAC,EAAE,GAAG,GAAGC,EAAE,MAAM,CAAC,QAAQ,GAAG,UAAU,CAAC,EAAE,MAAM,EAAE,CAAC,UAAUK,EAAC,CAAE,EAAE,OAAO,IAAI,WAAW,EAAE,qBAAqB,EAAE,qBAAqB,EAAE,EAAE,qBAAqB,EAAE,qBAAqB,EAAE,MAAMC,EAAEH,EAAE,EAAE,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,QAAQ,GAAG,UAAU,KAAK,IAAI,EAAEH,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC"}