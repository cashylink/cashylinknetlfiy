import{F as J,r as i,j as e,a0 as _e,a3 as Q,a7 as Ue,b6 as Y,O as Z,u as ne,c as oe,Q as ie,T as ce,V as le,W as de,ax as De,I as K,B as C,E as B,v as z,X as Me,ay as Re,az as Oe,b9 as Ve,a as Fe,ac as Te,ba as Ge,bb as $e,bc as We,ak as Ke,S as Be,af as ze}from"./index-DvnSb1Lh.js";import{D as He,a as qe,b as Xe,c as Ye,d as H,e as T}from"./dropdown-menu-Cr2CyYbi.js";import{L as q}from"./label-B6P4HKsh.js";import{M as Je}from"./MasterPinDialog-DoxZ0TSE.js";import{g as Qe}from"./switch-C0JIfFYU.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],_s=J("activity",Ze);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]],ss=J("cloud-download",es);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],as=J("loader-circle",ts);var ue={exports:{}},fe={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D=i;function rs(n,t){return n===t&&(n!==0||1/n===1/t)||n!==n&&t!==t}var ns=typeof Object.is=="function"?Object.is:rs,os=D.useState,is=D.useEffect,cs=D.useLayoutEffect,ls=D.useDebugValue;function ds(n,t){var s=t(),d=os({inst:{value:s,getSnapshot:t}}),o=d[0].inst,l=d[1];return cs(function(){o.value=s,o.getSnapshot=t,X(o)&&l({inst:o})},[n,s,t]),is(function(){return X(o)&&l({inst:o}),n(function(){X(o)&&l({inst:o})})},[n]),ls(s),s}function X(n){var t=n.getSnapshot;n=n.value;try{var s=t();return!ns(n,s)}catch{return!0}}function us(n,t){return t()}var fs=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?us:ds;fe.useSyncExternalStore=D.useSyncExternalStore!==void 0?D.useSyncExternalStore:fs;ue.exports=fe;var hs=ue.exports;function ms(){return hs.useSyncExternalStore(ws,()=>!0,()=>!1)}function ws(){return()=>{}}var ee="Avatar",[gs]=_e(ee),[ps,he]=gs(ee),me=i.forwardRef((n,t)=>{const{__scopeAvatar:s,...d}=n,[o,l]=i.useState("idle");return e.jsx(ps,{scope:s,imageLoadingStatus:o,onImageLoadingStatusChange:l,children:e.jsx(Q.span,{...d,ref:t})})});me.displayName=ee;var we="AvatarImage",ge=i.forwardRef((n,t)=>{const{__scopeAvatar:s,src:d,onLoadingStatusChange:o=()=>{},...l}=n,b=he(we,s),v=xs(d,l),g=Ue(f=>{o(f),b.onImageLoadingStatusChange(f)});return Y(()=>{v!=="idle"&&g(v)},[v,g]),v==="loaded"?e.jsx(Q.img,{...l,ref:t,src:d}):null});ge.displayName=we;var pe="AvatarFallback",xe=i.forwardRef((n,t)=>{const{__scopeAvatar:s,delayMs:d,...o}=n,l=he(pe,s),[b,v]=i.useState(d===void 0);return i.useEffect(()=>{if(d!==void 0){const g=window.setTimeout(()=>v(!0),d);return()=>window.clearTimeout(g)}},[d]),b&&l.imageLoadingStatus!=="loaded"?e.jsx(Q.span,{...o,ref:t}):null});xe.displayName=pe;function re(n,t){return n?t?(n.src!==t&&(n.src=t),n.complete&&n.naturalWidth>0?"loaded":"loading"):"error":"idle"}function xs(n,{referrerPolicy:t,crossOrigin:s}){const d=ms(),o=i.useRef(null),l=d?(o.current||(o.current=new window.Image),o.current):null,[b,v]=i.useState(()=>re(l,n));return Y(()=>{v(re(l,n))},[l,n]),Y(()=>{const g=R=>()=>{v(R)};if(!l)return;const f=g("loaded"),A=g("error");return l.addEventListener("load",f),l.addEventListener("error",A),t&&(l.referrerPolicy=t),typeof s=="string"&&(l.crossOrigin=s),()=>{l.removeEventListener("load",f),l.removeEventListener("error",A)}},[l,s,t]),b}var ve=me,je=ge,Se=xe;const Ne=i.forwardRef(({className:n,...t},s)=>e.jsx(ve,{ref:s,className:Z("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",n),...t}));Ne.displayName=ve.displayName;const be=i.forwardRef(({className:n,...t},s)=>e.jsx(je,{ref:s,className:Z("aspect-square h-full w-full",n),...t}));be.displayName=je.displayName;const ye=i.forwardRef(({className:n,...t},s)=>e.jsx(Se,{ref:s,className:Z("flex h-full w-full items-center justify-center rounded-full bg-muted",n),...t}));ye.displayName=Se.displayName;function vs({open:n,onOpenChange:t}){const{user:s}=ne(),{toast:d}=oe(),[o,l]=i.useState(!1),[b,v]=i.useState(!1),[g,f]=i.useState(!1),[A,R]=i.useState(!1),[se,I]=i.useState(!1),[te,L]=i.useState(!1),[j,O]=i.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[c,w]=i.useState({currentPassword:"",newPassword:"",confirmPassword:""}),M=()=>{const u={currentPassword:"",newPassword:"",confirmPassword:""};return j.currentPassword||(u.currentPassword="كلمة المرور الحالية مطلوبة"),j.newPassword?j.newPassword.length<6&&(u.newPassword="كلمة المرور يجب أن تكون 6 أحرف على الأقل"):u.newPassword="كلمة المرور الجديدة مطلوبة",j.confirmPassword?j.newPassword!==j.confirmPassword&&(u.confirmPassword="كلمات المرور غير متطابقة"):u.confirmPassword="تأكيد كلمة المرور مطلوب",w(u),!Object.values(u).some(m=>m!=="")},S=async u=>{if(u.preventDefault(),!(!M()||!s||!s.email)){l(!0);try{const m=Re.credential(s.email,j.currentPassword);await Oe(s,m),L(!0),I(!0),d({title:"تأكيد الهوية",description:"أدخل الرقم السري الرئيسي لتأكيد تغيير كلمة المرور"})}catch(m){console.error("خطأ في تغيير كلمة المرور:",m);let P="حدث خطأ أثناء تغيير كلمة المرور";if(m.code==="auth/wrong-password"){w(k=>({...k,currentPassword:"كلمة المرور الحالية غير صحيحة"}));return}else if(m.code==="auth/weak-password"){w(k=>({...k,newPassword:"كلمة المرور ضعيفة جداً"}));return}else m.code==="auth/requires-recent-login"&&(P="يجب تسجيل الدخول مرة أخرى لتغيير كلمة المرور");d({title:"خطأ في تغيير كلمة المرور",description:P,variant:"destructive"})}finally{l(!1)}}},G=async()=>{if(s){l(!0);try{await Ve(s,j.newPassword),d({title:"تم تغيير كلمة المرور بنجاح",description:"تم تحديث كلمة المرور الخاصة بك بنجاح"}),O({currentPassword:"",newPassword:"",confirmPassword:""}),w({currentPassword:"",newPassword:"",confirmPassword:""}),I(!1),L(!1),t(!1)}catch(u){console.error("خطأ في تحديث كلمة المرور:",u);let m="حدث خطأ أثناء تغيير كلمة المرور";u.code==="auth/requires-recent-login"&&(m="انتهت جلسة المصادقة. يرجى إعادة إدخال كلمة المرور الحالية"),d({title:"خطأ في تغيير كلمة المرور",description:m,variant:"destructive"})}finally{l(!1)}}},y=u=>m=>{O(P=>({...P,[u]:m.target.value})),c[u]&&w(P=>({...P,[u]:""}))},p=()=>{O({currentPassword:"",newPassword:"",confirmPassword:""}),w({currentPassword:"",newPassword:"",confirmPassword:""}),I(!1),L(!1),t(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(ie,{open:n,onOpenChange:p,children:e.jsxs(ce,{className:"sm:max-w-[425px]",children:[e.jsxs(le,{children:[e.jsx(de,{children:"تغيير كلمة المرور"}),e.jsx(De,{children:"أدخل كلمة المرور الحالية وكلمة المرور الجديدة لتحديث حسابك"})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"currentPassword",children:"كلمة المرور الحالية"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{id:"currentPassword",type:b?"text":"password",value:j.currentPassword,onChange:y("currentPassword"),className:c.currentPassword?"border-red-500":"",autoComplete:"off",disabled:o}),e.jsx(C,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>v(!b),disabled:o,children:b?e.jsx(B,{className:"h-4 w-4"}):e.jsx(z,{className:"h-4 w-4"})})]}),c.currentPassword&&e.jsx("p",{className:"text-sm text-red-500",children:c.currentPassword})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"newPassword",children:"كلمة المرور الجديدة"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{id:"newPassword",type:g?"text":"password",value:j.newPassword,onChange:y("newPassword"),className:c.newPassword?"border-red-500":"",autoComplete:"new-password",disabled:o}),e.jsx(C,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>f(!g),disabled:o,children:g?e.jsx(B,{className:"h-4 w-4"}):e.jsx(z,{className:"h-4 w-4"})})]}),c.newPassword&&e.jsx("p",{className:"text-sm text-red-500",children:c.newPassword})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"confirmPassword",children:"تأكيد كلمة المرور الجديدة"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{id:"confirmPassword",type:A?"text":"password",value:j.confirmPassword,onChange:y("confirmPassword"),className:c.confirmPassword?"border-red-500":"",autoComplete:"new-password",disabled:o}),e.jsx(C,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>R(!A),disabled:o,children:A?e.jsx(B,{className:"h-4 w-4"}):e.jsx(z,{className:"h-4 w-4"})})]}),c.confirmPassword&&e.jsx("p",{className:"text-sm text-red-500",children:c.confirmPassword})]}),e.jsxs(Me,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:p,disabled:o,children:"إلغاء"}),e.jsxs(C,{type:"submit",disabled:o,children:[o&&e.jsx(as,{className:"mr-2 h-4 w-4 animate-spin"}),"تغيير كلمة المرور"]})]})]})]})}),e.jsx(Je,{open:se&&te,onOpenChange:u=>{I(u),u||L(!1)},mode:"verify",title:"التحقق من الرقم السري الرئيسي",description:"لا يمكن تغيير كلمة المرور إلا بعد التحقق من الرقم السري الرئيسي",onSuccess:G,onCancel:()=>{I(!1),L(!1)}})]})}const js="cashy.google.accessToken",Ss="cashy.google.email",Ns="cashy.google.expiresAt";function bs(){try{const n=localStorage.getItem(js),t=localStorage.getItem(Ss),s=localStorage.getItem(Ns),d=s?Number(s):null;return{token:n,email:t,expiresAt:d}}catch{return{token:null,email:null,expiresAt:null}}}async function ys(n,t,s){try{const d=await fetch("/user/google-backup-token",{method:"POST",headers:{"Content-Type":"application/json","X-USER-ID":n},body:JSON.stringify({email:t,refresh_token:s})}),o=await d.json().catch(()=>({}));return!!(d.ok&&(o!=null&&o.ok))}catch{return!1}}function Us({className:n}){const{user:t,profile:s,signOut:d,updateUserProfile:o}=ne(),l=Fe(),[b,v]=i.useState(!1),{isShiftActive:g}=Te(),{toast:f}=oe(),[A,R]=i.useState(!1),[se,I]=i.useState(!1),[te,L]=i.useState(!1),[{token:j},O]=i.useState(()=>bs()),c=typeof window<"u"?window.electronAPI:void 0,w=!!c,[M,S]=i.useState(!1),[G,y]=i.useState(!1),[p,u]=i.useState(""),[m,P]=i.useState(""),[k,$]=i.useState(0),[W,V]=i.useState(!1),[Pe,ke]=i.useState(""),[E,Ce]=i.useState(""),[Ps,ks]=i.useState(!1),_=(a,r)=>{const h=String(a||"").split(".").map(x=>parseInt(x,10)||0),N=String(r||"").split(".").map(x=>parseInt(x,10)||0);for(let x=0;x<Math.max(h.length,N.length);x++){const U=h[x]||0,F=N[x]||0;if(U>F)return 1;if(U<F)return-1}return 0};i.useEffect(()=>{if(!(!w||!c))try{c.onUpdateAvailable(a=>{var h,N;const r=String(((h=a==null?void 0:a.info)==null?void 0:h.version)||"");u(r),P(String(((N=a==null?void 0:a.info)==null?void 0:N.notes)||"")),_(r,E)>0?S(!0):S(!1)}),c.onUpdateDownloaded(a=>{var h,N;const r=String(((h=a==null?void 0:a.info)==null?void 0:h.version)||"");u(r),P(String(((N=a==null?void 0:a.info)==null?void 0:N.notes)||"")),V(!1),$(100),_(r,E)>0?S(!0):S(!1);try{w&&(t!=null&&t.uid)&&r&&(o==null||o({lastAckDesktopVersion:r}))}catch{}}),c.onUpdateError(a=>{try{f({title:"فشل التحديث",description:String((a==null?void 0:a.message)||(a==null?void 0:a.code)||"تعذر التحميل"),variant:"destructive"})}catch{}}),typeof c.onUpdateProgress=="function"&&c.onUpdateProgress(a=>{const r=(a==null?void 0:a.percent)==null?0:Number(a.percent);V(!0),$(Math.max(0,Math.min(100,isNaN(r)?0:r)))}),typeof c.appVersion=="function"&&c.appVersion().then(a=>{typeof a=="string"&&Ce(a);try{w&&(t!=null&&t.uid)&&typeof a=="string"&&a&&(o==null||o({desktopInstalledVersion:a}))}catch{}}).catch(()=>{})}catch{}},[w,c]),i.useEffect(()=>{w&&k>=100&&y(!0)},[w,k]),i.useEffect(()=>{const a=Ge(r=>{const h=String((r==null?void 0:r.version)||""),x=`desktop_update_seen_${String((t==null?void 0:t.uid)||"anon")}`;let U="";try{U=localStorage.getItem(x)||""}catch{}if(h&&h!==p){if(_(h,E)>0)if(U===h)S(!1),y(!1);else{S(!0),y(!0);try{localStorage.setItem(x,h)}catch{}}else S(!1);u(h),P(String((r==null?void 0:r.notes)||""));const F=$e({downloadURL_64:r==null?void 0:r.downloadURL_64,downloadURL_32:r==null?void 0:r.downloadURL_32})||"";ke(F)}});return()=>{try{a()}catch{}}},[p,E,t==null?void 0:t.uid]);const Ee=async()=>{var a;try{if(c){try{await c.checkUpdate()}catch{}y(!0),V(!0),$(0);const r=await((a=c.downloadUpdate)==null?void 0:a.call(c,Pe))??await c.downloadUpdate();if(typeof r=="string"&&r.startsWith("err:")){try{f({title:"فشل التحديث",description:r.slice(4),variant:"destructive"})}catch{}V(!1)}else if(r==="noop")try{f({title:"لا يوجد تحديث",description:"لا تتوفر نسخة أحدث حالياً."})}catch{}else if(r==="manual")try{f({title:"جارٍ تنزيل التحديث",description:"سيتم تطبيق التحديث تلقائيًا بعد اكتمال التنزيل."})}catch{}else if(r==="autoUpdater")try{f({title:"تنزيل تلقائي",description:"سيتم تطبيق التحديث تلقائياً بواسطة النظام."})}catch{}}}catch(r){try{f({title:"فشل التحديث",description:(r==null?void 0:r.message)||"حدث خطأ أثناء التنزيل",variant:"destructive"})}catch{}}},Ae=async()=>{try{if(c){const a=await c.applyUpdate();if(typeof a=="string"&&a.startsWith("err:"))try{f({title:"فشل تطبيق التحديث",description:a.slice(4),variant:"destructive"})}catch{}}}catch(a){try{f({title:"فشل تطبيق التحديث",description:(a==null?void 0:a.message)||"حدث خطأ أثناء تطبيق التحديث",variant:"destructive"})}catch{}}},Ie=()=>s!=null&&s.fullName?s==null?void 0:s.fullName.split(" ").map(a=>a.charAt(0)).join("").toUpperCase().slice(0,2):t.email?t.email.charAt(0).toUpperCase():"U",ae=s!=null&&s.avatarId?Qe(s.avatarId):null;if(i.useEffect(()=>{console.log("Profile updated in ProfileIcon:",s==null?void 0:s.avatarId)},[s==null?void 0:s.avatarId]),i.useEffect(()=>{const a=async r=>{try{if(!(r!=null&&r.data)||typeof r.data!="object"||r.origin!=="https://cashy.link")return;const{type:h,email:N,refresh_token:x}=r.data||{};h==="cashy_oauth_token"&&(t!=null&&t.uid)&&N&&x&&await ys(t.uid,String(N),String(x))&&f({title:"تم ربط جوجل",description:"تم حفظ توكن النسخ الاحتياطي عبر الخادم."})}catch{}};return window.addEventListener("message",a),()=>window.removeEventListener("message",a)},[t==null?void 0:t.uid]),!t)return null;const Le=async()=>{try{await d()}catch(a){console.error("خطأ في تسجيل الخروج:",a)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[w&&e.jsxs(C,{type:"button",onClick:()=>{y(!0),_(p,E)>0&&S(!0)},title:"تحديث التطبيق",className:"relative inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-blue-600 hover:bg-blue-500/10 focus:outline-none dark:text-blue-400 dark:hover:bg-blue-400/10",variant:"ghost",children:[e.jsx(ss,{className:"w-5 h-5"}),M&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 inline-block w-2 h-2 rounded-full bg-red-500"})]}),e.jsxs(He,{children:[e.jsx(qe,{asChild:!0,children:e.jsx(C,{variant:"ghost",disabled:g,title:g?"غير متاح أثناء وجود وردية كاشير نشطة":void 0,className:`relative h-8 w-8 rounded-full p-0 hover:bg-transparent focus:ring-1 focus:ring-primary focus:ring-offset-1 transition-all duration-200 disabled:opacity-60 disabled:cursor-not-allowed ${n}`,children:e.jsx(Ne,{className:"h-8 w-8 border border-border shadow-sm hover:shadow-md transition-all duration-200 hover:scale-105 bg-white",children:ae?e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-white dark:bg-neutral-900/20 rounded-full overflow-hidden",children:e.jsx("div",{className:"w-full h-full flex items-center justify-center scale-[2.5]",children:ae.component})}):e.jsxs(e.Fragment,{children:[e.jsx(be,{src:t.photoURL||void 0,alt:(s==null?void 0:s.fullName)||t.email||"المستخدم",className:"object-cover"}),e.jsx(ye,{className:"bg-white text-gray-900 font-semibold text-lg border-0",children:Ie()})]})})})}),e.jsxs(Xe,{className:"w-64",align:"end",forceMount:!0,children:[e.jsx(Ye,{className:"font-normal",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:(s==null?void 0:s.fullName)||"المستخدم"}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:t.email}),(s==null?void 0:s.role)&&e.jsxs("p",{className:"text-xs leading-none text-muted-foreground",children:["الدور: ",s.role==="staff"?"مدير":s.role==="merchant"?"تاجر":"مستخدم"]})]})}),e.jsx(H,{}),e.jsxs(T,{onClick:async()=>{try{await o({showWithdrawNote:!((s==null?void 0:s.showWithdrawNote)??!0)})}catch{}},className:"cursor-pointer",children:[e.jsx(We,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:(s==null?void 0:s.showWithdrawNote)??!0?"إخفاء خانة ملاحظة السحب":"إظهار خانة ملاحظة السحب"})]}),e.jsx(H,{}),e.jsxs(T,{onClick:()=>l("/profile-settings"),className:"cursor-pointer",children:[e.jsx(Ke,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"إعدادات البروفيل"})]}),((s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="staff")&&e.jsxs(T,{onClick:()=>l("/admin"),className:"cursor-pointer",children:[e.jsx(Be,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"لوحة الإدارة"})]}),e.jsx(H,{}),e.jsxs(T,{onClick:Le,className:"cursor-pointer text-red-600 focus:text-red-600",children:[e.jsx(ze,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"تسجيل الخروج"})]})]})]})]}),w&&e.jsx(ie,{open:G,onOpenChange:a=>{if(y(a),!a){const h=`desktop_update_seen_${String((t==null?void 0:t.uid)||"anon")}`;try{p&&localStorage.setItem(h,p)}catch{}S(!1)}},children:e.jsxs(ce,{className:"sm:max-w-md",children:[e.jsx(le,{children:e.jsx(de,{children:"يوجد تحديث جديد للبرنامج"})}),e.jsx("div",{className:"text-sm",children:W?"جارٍ تنزيل التحديث...":M&&_(p,E)>0?"هل ترغب في تنزيله الآن؟":"التطبيق مُحدَّث لآخر إصدار"}),p&&e.jsxs("div",{className:"mt-2 text-xs",children:["الإصدار الجديد: ",e.jsxs("span",{className:"font-semibold",children:["v",p]})]}),E&&e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["إصدار التطبيق لديك: ",e.jsxs("span",{className:"font-semibold",children:["v",E]})]}),m&&e.jsx("div",{className:"mt-2 text-xs text-muted-foreground whitespace-pre-line",children:m}),W&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"w-full h-2 bg-gray-200 rounded",children:e.jsx("div",{className:"h-2 bg-blue-600 rounded",style:{width:`${k}%`}})}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:[Math.round(k),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 mt-3",children:[e.jsx(C,{variant:"outline",onClick:()=>{const r=`desktop_update_seen_${String((t==null?void 0:t.uid)||"anon")}`;try{p&&localStorage.setItem(r,p)}catch{}S(!1),y(!1)},children:"إلغاء"}),!W&&k<100&&M&&_(p,E)>0&&e.jsx(C,{className:"bg-blue-600 hover:bg-blue-700",onClick:Ee,children:"بدء التنزيل"}),k>=100&&e.jsx(C,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{try{if(c!=null&&c.openUpdateFolder){const a=await c.openUpdateFolder();typeof a=="string"&&a.startsWith("err:")?f({title:"تعذر فتح مجلد التحديث",description:a.slice(4),variant:"destructive"}):f({title:"افتح ملف التثبيت",description:"تم فتح مجلد التحديث — اضغط على الملف لتثبيت."})}else await Ae()}catch(a){f({title:"تعذر فتح مجلد التحديث",description:(a==null?void 0:a.message)||"حدث خطأ غير متوقع",variant:"destructive"})}},children:"تحديث الآن"})]})]})}),e.jsx(vs,{open:b,onOpenChange:v})]})}export{_s as A,Us as P};
//# sourceMappingURL=ProfileIcon-9WiQiAPK.js.map
