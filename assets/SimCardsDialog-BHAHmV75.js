import{_ as Ue,u as _e,l as qe,r as o,q as me,aF as xe,p as M,s as j,Q as Y,T as y,j as e,af as S,ag as A,S as ge,ai as I,aG as O,B as c,au as Ge,a8 as V,I as f,a1 as Je,P as he,at as We,U as Ke,aH as Z,M as Qe,ah as L,x as u,ar as B,D,A as ue,aI as Xe,aJ as Ye,$ as Ve}from"./index-CzMrJEuC.js";import{T as Ze}from"./textarea-DH9YvORw.js";import{T as es,a as ss,b as pe,c as ee,d as as,e as se}from"./table-B3xDson-.js";import{B as H}from"./SimCardsAccessDialog-p84rP6ZI.js";import{S as fe}from"./tabs-CUOI6ynQ.js";import{W as be,P as ts,H as rs}from"./wifi--Er0opd2.js";import{S as ns}from"./save-C_zXO1pj.js";import"./select-DHMtOuee.js";import"./index-BBRmOonx.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],ls=Ue("globe",is);function fs({isOpen:z,onClose:ae,shopId:je,onOpenAdsl:te}){const{user:r}=_e(),{toast:h}=qe(),[v,w]=o.useState([]),[Ne,$]=o.useState(!0),[T,ve]=o.useState(""),[b,U]=o.useState("all"),[ye,R]=o.useState(!1),[_,re]=o.useState(null),[a,p]=o.useState({name:"",simNumber:"",lineNumber:"",callsPackage:"",internetPackage:"",adslPackage:"",totalAmount:"",remainingAmount:"",nationalId:"",whatsappNumber:"",notes:"",isPaid:!1}),[we,F]=o.useState(!1),[E,ke]=o.useState(null),[q,ne]=o.useState(""),[ie,le]=o.useState(""),[Ce,P]=o.useState(!1),[G,de]=o.useState(!1),[De,Pe]=o.useState([]),[J,Se]=o.useState(""),[W,Ae]=o.useState(()=>{const s=new Date,t=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0");return`${t}-${i}-${n}`}),[k,oe]=o.useState("day");o.useEffect(()=>{if(!(r!=null&&r.uid))return;const s=`simCards_${r.uid}`;try{const n=localStorage.getItem(s);n&&(w(JSON.parse(n)),$(!1))}catch(n){console.warn("Error loading sim cards from localStorage",n)}if(!z)return;$(!0);const t=me(M(j,"simCards"),xe("userId","==",r.uid)),i=Y(t,n=>{const l=n.docs.map(x=>({id:x.id,...x.data()})).sort((x,d)=>{var m,C;const g=((m=x.createdAt)==null?void 0:m.seconds)||0;return(((C=d.createdAt)==null?void 0:C.seconds)||0)-g});console.log("Fetched SIM cards:",l),w(l),$(!1);try{localStorage.setItem(s,JSON.stringify(l))}catch(x){console.warn("Error saving sim cards to localStorage",x)}},n=>{console.error("Error fetching sim cards:",n),$(!1)});return()=>i()},[r==null?void 0:r.uid,z]);const K=s=>{s?(re(s),p({name:s.name,simNumber:s.simNumber,lineNumber:s.lineNumber,callsPackage:s.callsPackage,internetPackage:s.internetPackage,adslPackage:s.adslPackage||"",totalAmount:s.totalAmount.toString(),remainingAmount:s.remainingAmount.toString(),nationalId:s.nationalId||"",whatsappNumber:s.whatsappNumber||"",notes:s.notes||"",isPaid:s.isPaid||!1})):(re(null),p({name:"",simNumber:"",lineNumber:"",callsPackage:"",internetPackage:"",adslPackage:"",totalAmount:"",remainingAmount:"",nationalId:"",whatsappNumber:"",notes:"",isPaid:!1})),R(!0)},Ie=async()=>{if(r!=null&&r.uid){if(!a.name.trim()){h({title:"خطأ",description:"يرجى إدخال الاسم",variant:"destructive"});return}if(!a.lineNumber.trim()){h({title:"خطأ",description:"يرجى إدخال رقم الخط",variant:"destructive"});return}try{const s={name:a.name,simNumber:a.simNumber,lineNumber:a.lineNumber,callsPackage:a.callsPackage,internetPackage:a.internetPackage,adslPackage:a.adslPackage,totalAmount:parseFloat(a.totalAmount)||0,remainingAmount:parseFloat(a.remainingAmount)||0,nationalId:a.nationalId,whatsappNumber:a.whatsappNumber,notes:a.notes,isPaid:a.isPaid,userId:r.uid,shopId:je||r.uid,updatedAt:D()};_?(await B(y(j,"simCards",_.id),s),h({title:"تم التحديث",description:"تم تحديث بيانات الخط بنجاح"})):(await ue(M(j,"simCards"),{...s,createdAt:D()}),h({title:"تم الإضافة",description:"تم إضافة الخط الجديد بنجاح"})),R(!1)}catch(s){console.error(s),h({title:"خطأ",description:"حدث خطأ أثناء الحفظ",variant:"destructive"})}}},$e=async s=>{if(confirm("هل أنت متأكد من حذف هذا الخط؟"))try{await Xe(y(j,"simCards",s)),h({title:"تم الحذف",description:"تم حذف الخط بنجاح"})}catch(t){console.error(t),h({title:"خطأ",description:"فشل الحذف",variant:"destructive"})}},Q=async(s,t)=>{w(i=>i.map(n=>n.id===s.id?{...n,isPaid:t,isDeferred:!1}:n));try{await B(y(j,"simCards",s.id),{isPaid:t,isDeferred:!1,updatedAt:D()}),t&&await ue(M(j,"simCardReceipts"),{cardId:s.id,cardName:s.name,amount:s.totalAmount,userId:r==null?void 0:r.uid,createdAt:D(),type:"payment"}),h({title:"تم التحديث",description:t?"تم تحديد الخط كمدفوع وتم تسجيل إيصال":"تم تحديد الخط كغير مدفوع"})}catch(i){w(n=>n.map(l=>l.id===s.id?{...l,isPaid:!t,isDeferred:s.isDeferred}:l)),console.error(i),h({title:"خطأ",description:"حدث خطأ أثناء تحديث الحالة",variant:"destructive"})}},Te=s=>{var t;ke(s),ne(s.name||""),le(((t=s.totalAmount)==null?void 0:t.toString())||""),F(!0)},Re=async()=>{if(!(r!=null&&r.uid)||!E)return;if(!q.trim()){h({title:"خطأ",description:"يرجى إدخال اسم العميل",variant:"destructive"});return}const s=parseFloat(ie);if(isNaN(s)||s<=0){h({title:"خطأ",description:"يرجى إدخال مبلغ صحيح",variant:"destructive"});return}try{const t=y(j,"users",r.uid),n=(await Ve(t)).data(),l=Array.isArray(n==null?void 0:n.debts)?n.debts:[],x={id:`DEBT-${Date.now()}`,debtorName:q,mobile:E.lineNumber,amount:s,reason:"تمن تسديد باقة",status:"pending",createdAt:new Date,paidAmount:0,partialPayments:[]};await B(t,{debts:[x,...l]}),w(d=>d.map(g=>g.id===E.id?{...g,isPaid:!1,isDeferred:!0,debtId:x.id}:g)),await B(y(j,"simCards",E.id),{isPaid:!1,isDeferred:!0,debtId:x.id,updatedAt:D()}),h({title:"تم الإضافة",description:"تم إضافة الدين وتأجيل الخط"}),F(!1)}catch(t){console.error(t),h({title:"خطأ",description:"حدث خطأ أثناء حفظ الدين",variant:"destructive"})}};o.useEffect(()=>{if(!(r!=null&&r.uid))return;const s=y(j,"users",r.uid),t=Y(s,async i=>{if(i.exists()){const l=i.data().debts||[],x=v.filter(d=>d.isDeferred&&!d.isPaid);for(const d of x){let g=!1;if(d.debtId){const N=l.find(m=>m.id===d.debtId);N&&N.status==="paid"&&(g=!0)}else l.find(m=>m.status==="paid"&&m.reason==="تمن تسديد باقة"&&(m.mobile&&m.mobile===d.lineNumber||!m.mobile&&m.debtorName===d.name&&Math.abs(m.amount-d.totalAmount)<.1))&&(g=!0);g&&await Q(d,!0)}}});return()=>t()},[r==null?void 0:r.uid,v]);const ce=v.filter(s=>{const t=s.name.toLowerCase().includes(T.toLowerCase())||s.lineNumber.includes(T)||s.simNumber.includes(T),i=b==="all"?!0:b==="paid"?s.isPaid:b==="unpaid"?!s.isPaid&&!s.isDeferred:b==="deferred"?s.isDeferred:!0;return t&&i}),Fe=v.filter(s=>s.isPaid).length,Ee=v.filter(s=>!s.isPaid&&!s.isDeferred).length,Me=v.filter(s=>s.isDeferred).length,Oe=async()=>{P(!0)},Le=async()=>{if(r!=null&&r.uid)try{const s=Ye(j);v.forEach(t=>{if(t.isPaid){const i=y(j,"simCards",t.id);s.update(i,{isPaid:!1,updatedAt:D()})}}),await s.commit(),w(t=>t.map(i=>({...i,isPaid:!1}))),h({title:"تم التحديث",description:"تم تحويل جميع الخطوط إلى غير مدفوع بنجاح"}),P(!1)}catch(s){console.error("Error resetting cards:",s),h({title:"خطأ",description:"حدث خطأ أثناء تحديث الخطوط",variant:"destructive"}),P(!1)}};o.useEffect(()=>{if(!G||!(r!=null&&r.uid))return;const s=me(M(j,"simCardReceipts"),xe("userId","==",r.uid)),t=Y(s,i=>{const n=i.docs.map(l=>({id:l.id,...l.data()}));n.sort((l,x)=>{var N,m;const d=((N=l.createdAt)==null?void 0:N.seconds)||Math.floor(Date.now()/1e3);return(((m=x.createdAt)==null?void 0:m.seconds)||Math.floor(Date.now()/1e3))-d}),Pe(n)},i=>{console.error("Error fetching receipts:",i),h({title:"خطأ",description:"فشل تحميل السجل",variant:"destructive"})});return()=>t()},[G,r==null?void 0:r.uid]);const X=De.filter(s=>{var N;if(J.trim()){const m=J.toLowerCase(),C=v.find(ze=>ze.id===s.cardId),Be=s.cardName.toLowerCase().includes(m),He=C?C.lineNumber.includes(m)||C.simNumber.includes(m):!1;return Be||He}const t=(N=s.createdAt)!=null&&N.seconds?s.createdAt.seconds*1e3:Date.now(),i=new Date(t),[n,l,x]=W.split("-").map(Number),d=new Date(n,l-1,x),g=new Date(n,l-1,x);return k==="day"?(d.setHours(0,0,0,0),g.setHours(23,59,59,999)):(d.setDate(1),d.setHours(0,0,0,0),g.setMonth(g.getMonth()+1),g.setDate(0),g.setHours(23,59,59,999)),i>=d&&i<=g});return e.jsxs(e.Fragment,{children:[e.jsx(S,{open:z,onOpenChange:s=>!s&&ae(),children:e.jsxs(A,{className:"max-w-screen w-screen h-screen flex flex-col p-0 gap-0 bg-gray-50 dark:bg-gray-900 rounded-none border-0",children:[e.jsxs("div",{className:"p-3 border-b bg-white dark:bg-gray-800 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-purple-100 dark:bg-purple-900/30 rounded-full text-purple-600",children:e.jsx(ge,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"text-base font-bold",children:"إدارة الخطوط"}),e.jsx(O,{className:"text-xs",children:"سجل ومتابعة خطوط الموبايل والباقات"})]})]}),e.jsx(c,{onClick:()=>ae(),variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(Ge,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 p-2 bg-gray-50/50 dark:bg-gray-900/50 border-b",children:[e.jsxs("div",{onClick:()=>U(b==="paid"?"all":"paid"),className:`cursor-pointer rounded-md border py-1.5 px-2 flex flex-row items-center justify-center gap-2 transition-all hover:shadow-sm ${b==="paid"?"bg-green-100 border-green-300 ring-1 ring-green-500 ring-offset-1 dark:ring-offset-gray-900":"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 hover:border-green-300"}`,children:[e.jsx("div",{className:`p-1 rounded-full ${b==="paid"?"bg-green-200":"bg-green-100"} text-green-700`,children:e.jsx(H,{className:"h-3.5 w-3.5"})}),e.jsxs("div",{className:"flex items-center gap-1.5 leading-none",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 dark:text-gray-400",children:"المدفوعة"}),e.jsx("div",{className:"text-sm font-bold text-green-600",children:Fe})]})]}),e.jsxs("div",{onClick:()=>U(b==="unpaid"?"all":"unpaid"),className:`cursor-pointer rounded-md border py-1.5 px-2 flex flex-row items-center justify-center gap-2 transition-all hover:shadow-sm ${b==="unpaid"?"bg-red-100 border-red-300 ring-1 ring-red-500 ring-offset-1 dark:ring-offset-gray-900":"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 hover:border-red-300"}`,children:[e.jsx("div",{className:`p-1 rounded-full ${b==="unpaid"?"bg-red-200":"bg-red-100"} text-red-700`,children:e.jsx(V,{className:"h-3.5 w-3.5"})}),e.jsxs("div",{className:"flex items-center gap-1.5 leading-none",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 dark:text-gray-400",children:"غير المدفوعة"}),e.jsx("div",{className:"text-sm font-bold text-red-600",children:Ee})]})]}),e.jsxs("div",{onClick:()=>U(b==="deferred"?"all":"deferred"),className:`cursor-pointer rounded-md border py-1.5 px-2 flex flex-row items-center justify-center gap-2 transition-all hover:shadow-sm ${b==="deferred"?"bg-orange-100 border-orange-300 ring-1 ring-orange-500 ring-offset-1 dark:ring-offset-gray-900":"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 hover:border-orange-300"}`,children:[e.jsx("div",{className:`p-1 rounded-full ${b==="deferred"?"bg-orange-200":"bg-orange-100"} text-orange-700`,children:e.jsx(V,{className:"h-3.5 w-3.5"})}),e.jsxs("div",{className:"flex items-center gap-1.5 leading-none",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 dark:text-gray-400",children:"مؤجلة الدفع"}),e.jsx("div",{className:"text-sm font-bold text-orange-600",children:Me})]})]})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 border-b flex flex-col md:flex-row gap-3 justify-between items-center",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(fe,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(f,{placeholder:"بحث بالاسم أو الرقم...",value:T,onChange:s=>ve(s.target.value),className:"pr-9"})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[te&&e.jsxs(c,{onClick:te,variant:"outline",className:"flex-1 md:flex-none gap-2 text-blue-600 border-blue-200 hover:bg-blue-50",children:[e.jsx(be,{className:"h-4 w-4"}),"ADSL"]}),e.jsxs(c,{onClick:()=>de(!0),variant:"outline",className:"flex-1 md:flex-none gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),"سجل السداد"]}),e.jsxs(c,{onClick:()=>K(),className:"flex-1 md:flex-none bg-purple-600 hover:bg-purple-700 text-white gap-2",children:[e.jsx(Je,{className:"h-4 w-4"}),"إضافة خط جديد"]}),e.jsxs(c,{onClick:Oe,variant:"destructive",className:"flex-1 md:flex-none gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"تحويل الكل لغير مدفوع"]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:Ne?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})}):ce.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx(ge,{className:"h-12 w-12 mb-3 opacity-20"}),e.jsx("p",{children:"لا توجد خطوط مسجلة"}),e.jsx(c,{variant:"link",onClick:()=>K(),className:"text-purple-600",children:"إضافة أول خط"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:ce.map(s=>e.jsxs("div",{className:`rounded-xl shadow-sm border p-2 hover:shadow-md transition-shadow ${s.isDeferred?"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800":s.isPaid?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-8 w-8 rounded-full flex items-center justify-center font-bold text-sm ${s.isDeferred?"bg-orange-100 text-orange-700 dark:bg-orange-800 dark:text-orange-100":s.isPaid?"bg-green-100 text-green-700 dark:bg-green-800 dark:text-green-100":"bg-red-100 text-red-700 dark:bg-red-800 dark:text-red-100"}`,children:s.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[e.jsx(he,{className:"h-3 w-3"}),e.jsx("span",{dir:"ltr",children:s.lineNumber})]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(c,{variant:"ghost",size:"icon",className:"h-6 w-6 text-blue-600 hover:bg-blue-50",onClick:()=>K(s),children:e.jsx(ts,{className:"h-3 w-3"})}),e.jsx(c,{variant:"ghost",size:"icon",className:"h-6 w-6 text-red-600 hover:bg-red-50",onClick:()=>$e(s.id),children:e.jsx(We,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[s.nationalId&&e.jsxs("div",{className:"flex justify-between py-0.5 border-b border-gray-200/50",children:[e.jsxs("span",{className:"text-gray-500 flex items-center gap-1",children:[e.jsx(Ke,{className:"h-3 w-3"})," الرقم القومي"]}),e.jsx("span",{className:"font-medium font-mono",children:s.nationalId})]}),e.jsxs("div",{className:"flex justify-between py-0.5 border-b border-gray-200/50",children:[e.jsxs("span",{className:"text-gray-500 flex items-center gap-1",children:[e.jsx(rs,{className:"h-3 w-3"})," رقم الموزع"]}),e.jsx("span",{className:"font-medium font-mono",children:s.simNumber||"-"})]}),e.jsxs("div",{className:"flex justify-between py-0.5 border-b border-gray-200/50",children:[e.jsxs("span",{className:"text-gray-500 flex items-center gap-1",children:[e.jsx(he,{className:"h-3 w-3"})," باقة المكالمات"]}),e.jsx("span",{className:"font-medium",children:s.callsPackage||"-"})]}),e.jsxs("div",{className:"flex justify-between py-0.5 border-b border-gray-200/50",children:[e.jsxs("span",{className:"text-gray-500 flex items-center gap-1",children:[e.jsx(ls,{className:"h-3 w-3"})," باقة النت"]}),e.jsx("span",{className:"font-medium",children:s.internetPackage||"-"})]}),s.adslPackage&&e.jsxs("div",{className:"flex justify-between py-0.5 border-b border-gray-200/50",children:[e.jsxs("span",{className:"text-gray-500 flex items-center gap-1",children:[e.jsx(be,{className:"h-3 w-3"})," باقة ADSL"]}),e.jsx("span",{className:"font-medium",children:s.adslPackage})]}),e.jsxs("div",{className:"flex justify-between py-1 pt-1.5",children:[e.jsxs("span",{className:"text-gray-500 flex items-center gap-1",children:[e.jsx(H,{className:"h-3 w-3"})," الإجمالي"]}),e.jsx("span",{className:"font-bold text-gray-900",children:Z(s.totalAmount)})]}),s.whatsappNumber&&e.jsx("div",{className:"mt-2 px-1",children:e.jsxs(c,{variant:"outline",className:"w-full h-8 gap-2 text-green-600 border-green-200 hover:bg-green-50 hover:text-green-700",onClick:()=>{const t=`مرحباً ${s.name}،
تذكير بموعد دفع فاتورة الخط رقم ${s.lineNumber}.
المبلغ المطلوب: ${s.totalAmount} جنيه.
شكراً لك!`,i=`https://wa.me/2${s.whatsappNumber}?text=${encodeURIComponent(t)}`;window.open(i,"_blank")},children:[e.jsx(Qe,{className:"h-4 w-4"}),"تذكير بالدفع"]})}),e.jsxs("div",{className:"flex gap-2 mt-1.5 px-1",children:[e.jsx(c,{size:"sm",className:`flex-1 h-8 text-xs font-bold ${s.isPaid?"bg-green-600 hover:bg-green-700 text-white":"bg-white text-green-600 border border-green-200 hover:bg-green-50"}`,onClick:()=>Q(s,!0),children:"مدفوع"}),e.jsx(c,{size:"sm",variant:"destructive",className:`flex-1 h-8 text-xs font-bold ${!s.isPaid&&!s.isDeferred?"bg-red-600 hover:bg-red-700 text-white":"bg-white text-red-600 border border-red-200 hover:bg-red-50"}`,onClick:()=>Q(s,!1),children:"غير مدفوع"}),e.jsx(c,{size:"sm",variant:"outline",className:`flex-1 h-8 text-xs font-bold ${s.isDeferred?"bg-orange-600 hover:bg-orange-700 text-white":"text-orange-600 border-orange-200 hover:bg-orange-50"}`,onClick:()=>Te(s),children:"أجل"})]})]})]},s.id))})})]})}),e.jsx(S,{open:G,onOpenChange:de,children:e.jsxs(A,{className:"max-w-2xl h-[80vh] flex flex-col p-0",children:[e.jsxs(L,{className:"p-4 border-b",children:[e.jsx(I,{children:"سجل سداد الخطوط"}),e.jsx(O,{children:"عرض إيصالات السداد حسب التاريخ"})]}),e.jsxs("div",{className:"p-4 border-b bg-gray-50 flex flex-col gap-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(fe,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(f,{placeholder:"بحث في السجل بالاسم أو الرقم...",value:J,onChange:s=>Se(s.target.value),className:"pr-9 bg-white"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-end w-full",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(u,{children:"نوع البحث"}),e.jsxs("div",{className:"flex bg-white rounded-md border p-1",children:[e.jsx("button",{onClick:()=>oe("day"),className:`flex-1 px-3 py-1.5 text-sm rounded-sm transition-colors ${k==="day"?"bg-purple-100 text-purple-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:"يومي"}),e.jsx("button",{onClick:()=>oe("month"),className:`flex-1 px-3 py-1.5 text-sm rounded-sm transition-colors ${k==="month"?"bg-purple-100 text-purple-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:"شهري"})]})]}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(u,{children:k==="day"?"اختر اليوم":"اختر الشهر"}),e.jsx(f,{type:k==="day"?"date":"month",value:k==="day"?W:W.substring(0,7),onChange:s=>Ae(s.target.value),className:"bg-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 mb-1",children:"إجمالي الفترة"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:Z(X.reduce((s,t)=>s+(t.amount||0),0))})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-0 relative",children:X.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-gray-500",children:[e.jsx(H,{className:"h-12 w-12 mb-2 opacity-20"}),e.jsx("p",{children:"لا توجد عمليات سداد في هذه الفترة"})]}):e.jsxs(es,{children:[e.jsx(ss,{className:"sticky top-0 bg-white z-10 shadow-sm",children:e.jsxs(pe,{children:[e.jsx(ee,{className:"text-right",children:"التاريخ"}),e.jsx(ee,{className:"text-right",children:"اسم الخط"}),e.jsx(ee,{className:"text-right",children:"المبلغ"})]})}),e.jsx(as,{children:X.map(s=>{var t;return e.jsxs(pe,{children:[e.jsx(se,{className:"font-mono text-xs text-gray-500",children:(t=s.createdAt)!=null&&t.seconds?new Date(s.createdAt.seconds*1e3).toLocaleString("ar-EG"):"الآن"}),e.jsx(se,{className:"font-medium",children:s.cardName}),e.jsx(se,{className:"font-bold text-green-600",children:Z(s.amount)})]},s.id)})})]})})]})}),e.jsx(S,{open:Ce,onOpenChange:P,children:e.jsxs(A,{className:"max-w-md",children:[e.jsxs(L,{children:[e.jsx(I,{children:"تأكيد التحويل"}),e.jsxs(O,{children:['هل أنت متأكد من تحويل جميع الخطوط إلى "غير مدفوع"؟',e.jsx("br",{}),"سيتم تغيير حالة الدفع لجميع الخطوط المسجلة."]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(c,{variant:"outline",onClick:()=>P(!1),children:"إلغاء"}),e.jsx(c,{variant:"destructive",onClick:Le,children:"نعم، تحويل الكل"})]})]})}),e.jsx(S,{open:ye,onOpenChange:R,children:e.jsxs(A,{className:"max-w-md",children:[e.jsx(L,{children:e.jsx(I,{children:_?"تعديل بيانات الخط":"إضافة خط جديد"})}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"الاسم"}),e.jsx(f,{value:a.name,onChange:s=>p({...a,name:s.target.value}),placeholder:"اسم العميل أو صاحب الخط"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"الرقم القومي (اختياري)"}),e.jsx(f,{value:a.nationalId,onChange:s=>p({...a,nationalId:s.target.value}),placeholder:"الرقم القومي...",dir:"ltr"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"رقم الخط"}),e.jsx(f,{value:a.lineNumber,onChange:s=>p({...a,lineNumber:s.target.value}),placeholder:"01xxxxxxxxx",dir:"ltr"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"رقم الموزع"}),e.jsx(f,{value:a.simNumber,onChange:s=>p({...a,simNumber:s.target.value}),placeholder:"رقم الموزع..."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"رقم الواتساب (اختياري)"}),e.jsx(f,{value:a.whatsappNumber,onChange:s=>p({...a,whatsappNumber:s.target.value}),placeholder:"رقم الواتساب...",dir:"ltr"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"باقة المكالمات"}),e.jsx(f,{value:a.callsPackage,onChange:s=>p({...a,callsPackage:s.target.value}),placeholder:"مثال: فليكس 45"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"باقة النت"}),e.jsx(f,{value:a.internetPackage,onChange:s=>p({...a,internetPackage:s.target.value}),placeholder:"مثال: سوبر ميجا 20"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"باقة ADSL (اختياري)"}),e.jsx(f,{value:a.adslPackage,onChange:s=>p({...a,adslPackage:s.target.value}),placeholder:"مثال: 140 جيجا"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"ملاحظات (اختياري)"}),e.jsx(Ze,{value:a.notes,onChange:s=>p({...a,notes:s.target.value}),placeholder:"أي ملاحظات إضافية...",className:"resize-none"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"المبلغ الإجمالي"}),e.jsx(f,{type:"number",value:a.totalAmount,onChange:s=>p({...a,totalAmount:s.target.value}),placeholder:"0.00"})]})}),e.jsxs("div",{className:"space-y-2 pt-2 hidden",children:[e.jsx(u,{children:"حالة الدفع"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{type:"button",variant:a.isPaid?"default":"outline",className:`flex-1 ${a.isPaid?"bg-green-600 hover:bg-green-700":"text-green-600 border-green-200 hover:bg-green-50"}`,onClick:()=>p({...a,isPaid:!0}),children:"مدفوع"}),e.jsx(c,{type:"button",variant:a.isPaid?"outline":"default",className:`flex-1 ${a.isPaid?"text-red-600 border-red-200 hover:bg-red-50":"bg-red-600 hover:bg-red-700"}`,onClick:()=>p({...a,isPaid:!1}),children:"لم يتم الدفع"})]})]}),e.jsxs("div",{className:"pt-4 flex gap-2",children:[e.jsxs(c,{className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white",onClick:Ie,children:[e.jsx(ns,{className:"h-4 w-4 ml-2"}),"حفظ"]}),e.jsx(c,{variant:"outline",onClick:()=>R(!1),children:"إلغاء"})]})]})]})}),e.jsx(S,{open:we,onOpenChange:F,children:e.jsxs(A,{className:"max-w-sm",children:[e.jsxs(L,{children:[e.jsx(I,{children:"تسجيل معاملة آجل"}),e.jsx(O,{children:"سيتم إضافة المبلغ للديون المستحقة"})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"اسم العميل"}),e.jsx(f,{value:q,onChange:s=>ne(s.target.value),placeholder:"اسم العميل..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"المبلغ"}),e.jsx(f,{type:"number",value:ie,onChange:s=>le(s.target.value),placeholder:"0.00"})]}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[e.jsx(c,{className:"flex-1 bg-orange-600 hover:bg-orange-700 text-white",onClick:Re,children:"تأكيد الأجل"}),e.jsx(c,{variant:"outline",onClick:()=>F(!1),children:"إلغاء"})]})]})]})})]})}export{fs as SimCardsDialog};
//# sourceMappingURL=SimCardsDialog-BHAHmV75.js.map
