{"version":3,"file":"brandingService-BsDZBAj_.js","sources":["../../node_modules/lucide-react/dist/esm/icons/monitor.js","../../node_modules/lucide-react/dist/esm/icons/smartphone.js","../../src/utils/brandingService.ts"],"sourcesContent":["/**\n * @license lucide-react v0.561.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"20\", height: \"14\", x: \"2\", y: \"3\", rx: \"2\", key: \"48i651\" }],\n  [\"line\", { x1: \"8\", x2: \"16\", y1: \"21\", y2: \"21\", key: \"1svkeh\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"17\", y2: \"21\", key: \"vw1qmm\" }]\n];\nconst Monitor = createLucideIcon(\"monitor\", __iconNode);\n\nexport { __iconNode, Monitor as default };\n//# sourceMappingURL=monitor.js.map\n","/**\n * @license lucide-react v0.561.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"14\", height: \"20\", x: \"5\", y: \"2\", rx: \"2\", ry: \"2\", key: \"1yt0o3\" }],\n  [\"path\", { d: \"M12 18h.01\", key: \"mhygvu\" }]\n];\nconst Smartphone = createLucideIcon(\"smartphone\", __iconNode);\n\nexport { __iconNode, Smartphone as default };\n//# sourceMappingURL=smartphone.js.map\n","import { db, storage } from '../firebase';\r\nimport { doc, getDoc, setDoc, updateDoc } from 'firebase/firestore';\r\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\r\n\r\nexport interface BrandingConfig {\r\n  logoUrl?: string;\r\n  updatedAt?: number;\r\n}\r\n\r\nconst BRANDING_DOC = doc(db, 'siteContent', 'branding');\r\n\r\nexport async function getBrandingConfig(): Promise<BrandingConfig> {\r\n  try {\r\n    const snap = await getDoc(BRANDING_DOC);\r\n    if (!snap.exists()) return {};\r\n    return (snap.data() as BrandingConfig) || {};\r\n  } catch (e: any) {\r\n    // بعض الصفحات العامة قد لا تمتلك صلاحية قراءة وثيقة العلامة التجارية حسب القواعد\r\n    // نتعامل بالرقة ونعيد قيمة افتراضية بدون كسر الواجهة\r\n    if (e && typeof e === 'object' && (e.code === 'permission-denied' || e.message?.includes('Missing or insufficient permissions'))) {\r\n      console.warn('brandingService: read branding config denied for public page');\r\n      return {};\r\n    }\r\n    console.warn('brandingService: failed to read branding config', e);\r\n    return {};\r\n  }\r\n}\r\n\r\nexport async function setBrandingConfig(config: BrandingConfig): Promise<void> {\r\n  const payload: BrandingConfig = {\r\n    ...config,\r\n    updatedAt: Date.now(),\r\n  };\r\n  await setDoc(BRANDING_DOC, payload, { merge: true });\r\n}\r\n\r\nexport async function uploadLogoAndSave(file: File): Promise<string> {\r\n  const path = `branding/logo_${Date.now()}_${file.name}`;\r\n  const storageRef = ref(storage, path);\r\n  await uploadBytes(storageRef, file);\r\n  const url = await getDownloadURL(storageRef);\r\n  await setBrandingConfig({ logoUrl: url });\r\n  return url;\r\n}\r\n\r\nexport async function getLogoUrl(): Promise<string | undefined> {\r\n  const config = await getBrandingConfig();\r\n  return config.logoUrl;\r\n}"],"names":["__iconNode","Monitor","createLucideIcon","Smartphone","BRANDING_DOC","doc","db","getBrandingConfig","snap","getDoc","e","_a","setBrandingConfig","config","payload","setDoc","uploadLogoAndSave","file","path","storageRef","ref","storage","uploadBytes","url","getDownloadURL","getLogoUrl"],"mappings":"oGAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMA,EAAa,CACjB,CAAC,OAAQ,CAAE,MAAO,KAAM,OAAQ,KAAM,EAAG,IAAK,EAAG,IAAK,GAAI,IAAK,IAAK,QAAQ,CAAE,EAC9E,CAAC,OAAQ,CAAE,GAAI,IAAK,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,IAAK,QAAQ,CAAE,EACjE,CAAC,OAAQ,CAAE,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,IAAK,QAAQ,CAAE,CACpE,EACMC,EAAUC,EAAiB,UAAWF,CAAU,ECdtD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMA,EAAa,CACjB,CAAC,OAAQ,CAAE,MAAO,KAAM,OAAQ,KAAM,EAAG,IAAK,EAAG,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,SAAU,EACvF,CAAC,OAAQ,CAAE,EAAG,aAAc,IAAK,QAAQ,CAAE,CAC7C,EACMG,EAAaD,EAAiB,aAAcF,CAAU,ECJtDI,EAAeC,EAAIC,EAAI,cAAe,UAAU,EAEtD,eAAsBC,GAA6C,OACjE,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAOL,CAAY,EACtC,OAAKI,EAAK,OAAA,EACFA,EAAK,KAAA,GAA6B,CAAA,EADf,CAAA,CAE7B,OAASE,EAAQ,CAGf,OAAIA,GAAK,OAAOA,GAAM,WAAaA,EAAE,OAAS,sBAAuBC,EAAAD,EAAE,UAAF,MAAAC,EAAW,SAAS,yCACvF,QAAQ,KAAK,8DAA8D,EACpE,CAAA,IAET,QAAQ,KAAK,kDAAmDD,CAAC,EAC1D,CAAA,EACT,CACF,CAEA,eAAsBE,EAAkBC,EAAuC,CAC7E,MAAMC,EAA0B,CAC9B,GAAGD,EACH,UAAW,KAAK,IAAA,CAAI,EAEtB,MAAME,EAAOX,EAAcU,EAAS,CAAE,MAAO,GAAM,CACrD,CAEA,eAAsBE,EAAkBC,EAA6B,CACnE,MAAMC,EAAO,iBAAiB,KAAK,KAAK,IAAID,EAAK,IAAI,GAC/CE,EAAaC,EAAIC,EAASH,CAAI,EACpC,MAAMI,EAAYH,EAAYF,CAAI,EAClC,MAAMM,EAAM,MAAMC,EAAeL,CAAU,EAC3C,aAAMP,EAAkB,CAAE,QAASW,EAAK,EACjCA,CACT,CAEA,eAAsBE,GAA0C,CAE9D,OADe,MAAMlB,EAAA,GACP,OAChB","x_google_ignoreList":[0,1]}