const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./LandingPage-DoYGgVis.js","./star-BSPZIAqJ.js","./arrow-left-DTf_k4UZ.js","./monitor-B97Iq5Zs.js","./chart-column-CP9zHq0e.js","./download-CAzB5lkL.js","./zap-CVW2mOxW.js","./circle-check-big-Dtvck6_a.js","./crown-D1WD830B.js","./SubscriptionsPage-CBhWDcn8.js","./contentService-Co2zXytx.js","./calendar-4dCWv1Gk.js","./sparkles-CZWxysoS.js","./AuthPage-6wJ4ilRc.js","./TopUpPage-BJoYNtD0.js","./select-Bn8RCTk-.js","./AdminTopupsPage-CRJP3_Nt.js","./AdminNotificationsPage-DtfvHRp1.js","./bell-C-d1sJAh.js","./link-Dfi0T6IH.js","./UserRegisterPage-r8M0t8fy.js","./alert-DViuKvlp.js","./wallet--cZcBirk.js","./user-plus-yhPdJ_2W.js","./UserAccountSetupPage-BPoVexWs.js","./ProtectedDashboard-CMyGL1BE.js","./profitService-QTJQLMA0.js","./dollar-sign-AUKMnGdi.js","./arrow-down-left-DcYD3MrR.js","./ProtectedUserDashboard-c6O-i0ck.js","./broadcastService-BQWgcmoe.js","./MerchantDashboard-BvehcK8E.js","./dropdown-menu-DhUxXtWv.js","./index-xL9tDy8r.js","./WalletsManagement-BtpHhaWq.js","./progress-QxZkw5ok.js","./WalletPrinterDialog-B3yID8sa.js","./html2canvas.esm-BfYXEYrK.js","./printer-DeiqlOce.js","./save-DZuHrrpv.js","./square-pen-CSLFtBCt.js","./PendingApprovalPage-DxsLZkqf.js","./freeTrialService-u-lJSTVe.js","./ProtectedAdminDashboard-BS6A8Uip.js","./ProfileIcon-IxzO755X.js","./switch-klIFyYmY.js","./separator-Cn84CDdZ.js","./gift-DSYL8rJL.js","./table-B1_nzBiE.js","./tabs-VyDQ-WsJ.js","./users-D9PlfCO2.js","./activity-NKT3hJFE.js","./pen-line-DHrJReBO.js","./ProfileSettingsPage-DnVs4YJB.js","./VideoModal-w5Ot-7KI.js","./TransactionsPage-C1gBXxdf.js","./ReceiptModal-Dqs_G1Fp.js","./SimCardsAccessDialog-Z5OgVyJn.js","./InstallmentModal-BmQdY6-Y.js","./CreditCardsDialog-CCiftUNp.js","./MaintenanceDialog-nfkRI82d.js","./SimCardsDialog-BmPZk43L.js","./alert-dialog-BwXlZ7hY.js","./wifi-bFidCAXd.js","./battery-charging-BKlgE6-N.js","./ReferralsPage-D8GbRMX3.js","./UserDashboardPage-XbIVMTiD.js"])))=>i.map(i=>d[i]);
var Uj=Object.defineProperty;var $I=t=>{throw TypeError(t)};var $j=(t,e,n)=>e in t?Uj(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var eh=(t,e,n)=>$j(t,typeof e!="symbol"?e+"":e,n),Kv=(t,e,n)=>e.has(t)||$I("Cannot "+n);var re=(t,e,n)=>(Kv(t,e,"read from private field"),n?n.call(t):e.get(t)),Gt=(t,e,n)=>e.has(t)?$I("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),St=(t,e,n,r)=>(Kv(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Wr=(t,e,n)=>(Kv(t,e,"access private method"),n);var Rm=(t,e,n,r)=>({set _(s){St(t,e,s,n)},get _(){return re(t,e,r)}});function Bj(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Rte=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function PR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Cte(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var RR={exports:{}},_y={},CR={exports:{}},$t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hf=Symbol.for("react.element"),zj=Symbol.for("react.portal"),Wj=Symbol.for("react.fragment"),qj=Symbol.for("react.strict_mode"),Hj=Symbol.for("react.profiler"),Kj=Symbol.for("react.provider"),Gj=Symbol.for("react.context"),Qj=Symbol.for("react.forward_ref"),Yj=Symbol.for("react.suspense"),Jj=Symbol.for("react.memo"),Xj=Symbol.for("react.lazy"),BI=Symbol.iterator;function Zj(t){return t===null||typeof t!="object"?null:(t=BI&&t[BI]||t["@@iterator"],typeof t=="function"?t:null)}var NR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kR=Object.assign,DR={};function Rd(t,e,n){this.props=t,this.context=e,this.refs=DR,this.updater=n||NR}Rd.prototype.isReactComponent={};Rd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Rd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function OR(){}OR.prototype=Rd.prototype;function mb(t,e,n){this.props=t,this.context=e,this.refs=DR,this.updater=n||NR}var pb=mb.prototype=new OR;pb.constructor=mb;kR(pb,Rd.prototype);pb.isPureReactComponent=!0;var zI=Array.isArray,LR=Object.prototype.hasOwnProperty,gb={current:null},MR={key:!0,ref:!0,__self:!0,__source:!0};function VR(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)LR.call(e,r)&&!MR.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Hf,type:t,key:i,ref:o,props:s,_owner:gb.current}}function eF(t,e){return{$$typeof:Hf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function yb(t){return typeof t=="object"&&t!==null&&t.$$typeof===Hf}function tF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var WI=/\/+/g;function Gv(t,e){return typeof t=="object"&&t!==null&&t.key!=null?tF(""+t.key):e.toString(36)}function bp(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Hf:case zj:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Gv(o,0):r,zI(s)?(n="",t!=null&&(n=t.replace(WI,"$&/")+"/"),bp(s,e,n,"",function(c){return c})):s!=null&&(yb(s)&&(s=eF(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(WI,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",zI(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+Gv(i,a);o+=bp(i,e,n,l,s)}else if(l=Zj(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+Gv(i,a++),o+=bp(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Cm(t,e,n){if(t==null)return t;var r=[],s=0;return bp(t,r,"","",function(i){return e.call(n,i,s++)}),r}function nF(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var os={current:null},Ep={transition:null},rF={ReactCurrentDispatcher:os,ReactCurrentBatchConfig:Ep,ReactCurrentOwner:gb};function jR(){throw Error("act(...) is not supported in production builds of React.")}$t.Children={map:Cm,forEach:function(t,e,n){Cm(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Cm(t,function(){e++}),e},toArray:function(t){return Cm(t,function(e){return e})||[]},only:function(t){if(!yb(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};$t.Component=Rd;$t.Fragment=Wj;$t.Profiler=Hj;$t.PureComponent=mb;$t.StrictMode=qj;$t.Suspense=Yj;$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rF;$t.act=jR;$t.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=kR({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=gb.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)LR.call(e,l)&&!MR.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Hf,type:t.type,key:s,ref:i,props:r,_owner:o}};$t.createContext=function(t){return t={$$typeof:Gj,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Kj,_context:t},t.Consumer=t};$t.createElement=VR;$t.createFactory=function(t){var e=VR.bind(null,t);return e.type=t,e};$t.createRef=function(){return{current:null}};$t.forwardRef=function(t){return{$$typeof:Qj,render:t}};$t.isValidElement=yb;$t.lazy=function(t){return{$$typeof:Xj,_payload:{_status:-1,_result:t},_init:nF}};$t.memo=function(t,e){return{$$typeof:Jj,type:t,compare:e===void 0?null:e}};$t.startTransition=function(t){var e=Ep.transition;Ep.transition={};try{t()}finally{Ep.transition=e}};$t.unstable_act=jR;$t.useCallback=function(t,e){return os.current.useCallback(t,e)};$t.useContext=function(t){return os.current.useContext(t)};$t.useDebugValue=function(){};$t.useDeferredValue=function(t){return os.current.useDeferredValue(t)};$t.useEffect=function(t,e){return os.current.useEffect(t,e)};$t.useId=function(){return os.current.useId()};$t.useImperativeHandle=function(t,e,n){return os.current.useImperativeHandle(t,e,n)};$t.useInsertionEffect=function(t,e){return os.current.useInsertionEffect(t,e)};$t.useLayoutEffect=function(t,e){return os.current.useLayoutEffect(t,e)};$t.useMemo=function(t,e){return os.current.useMemo(t,e)};$t.useReducer=function(t,e,n){return os.current.useReducer(t,e,n)};$t.useRef=function(t){return os.current.useRef(t)};$t.useState=function(t){return os.current.useState(t)};$t.useSyncExternalStore=function(t,e,n){return os.current.useSyncExternalStore(t,e,n)};$t.useTransition=function(){return os.current.useTransition()};$t.version="18.3.1";CR.exports=$t;var y=CR.exports;const M=PR(y),by=Bj({__proto__:null,default:M},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sF=y,iF=Symbol.for("react.element"),oF=Symbol.for("react.fragment"),aF=Object.prototype.hasOwnProperty,lF=sF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cF={key:!0,ref:!0,__self:!0,__source:!0};function FR(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)aF.call(e,r)&&!cF.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:iF,type:t,key:i,ref:o,props:s,_owner:lF.current}}_y.Fragment=oF;_y.jsx=FR;_y.jsxs=FR;RR.exports=_y;var f=RR.exports,UR={exports:{}},$s={},$R={exports:{}},BR={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,G){var ae=W.length;W.push(G);e:for(;0<ae;){var pe=ae-1>>>1,fe=W[pe];if(0<s(fe,G))W[pe]=G,W[ae]=fe,ae=pe;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var G=W[0],ae=W.pop();if(ae!==G){W[0]=ae;e:for(var pe=0,fe=W.length,Ge=fe>>>1;pe<Ge;){var xe=2*(pe+1)-1,ve=W[xe],Q=xe+1,qe=W[Q];if(0>s(ve,ae))Q<fe&&0>s(qe,ve)?(W[pe]=qe,W[Q]=ae,pe=Q):(W[pe]=ve,W[xe]=ae,pe=xe);else if(Q<fe&&0>s(qe,ae))W[pe]=qe,W[Q]=ae,pe=Q;else break e}}return G}function s(W,G){var ae=W.sortIndex-G.sortIndex;return ae!==0?ae:W.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,m=3,p=!1,v=!1,g=!1,E=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var G=n(c);G!==null;){if(G.callback===null)r(c);else if(G.startTime<=W)r(c),G.sortIndex=G.expirationTime,e(l,G);else break;G=n(c)}}function P(W){if(g=!1,S(W),!v)if(n(l)!==null)v=!0,Oe(T);else{var G=n(c);G!==null&&je(P,G.startTime-W)}}function T(W,G){v=!1,g&&(g=!1,b(A),A=-1),p=!0;var ae=m;try{for(S(G),d=n(l);d!==null&&(!(d.expirationTime>G)||W&&!C());){var pe=d.callback;if(typeof pe=="function"){d.callback=null,m=d.priorityLevel;var fe=pe(d.expirationTime<=G);G=t.unstable_now(),typeof fe=="function"?d.callback=fe:d===n(l)&&r(l),S(G)}else r(l);d=n(l)}if(d!==null)var Ge=!0;else{var xe=n(c);xe!==null&&je(P,xe.startTime-G),Ge=!1}return Ge}finally{d=null,m=ae,p=!1}}var N=!1,I=null,A=-1,R=5,k=-1;function C(){return!(t.unstable_now()-k<R)}function L(){if(I!==null){var W=t.unstable_now();k=W;var G=!0;try{G=I(!0,W)}finally{G?O():(N=!1,I=null)}}else N=!1}var O;if(typeof _=="function")O=function(){_(L)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,ke=X.port2;X.port1.onmessage=L,O=function(){ke.postMessage(null)}}else O=function(){E(L,0)};function Oe(W){I=W,N||(N=!0,O())}function je(W,G){A=E(function(){W(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,Oe(T))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(W){switch(m){case 1:case 2:case 3:var G=3;break;default:G=m}var ae=m;m=G;try{return W()}finally{m=ae}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,G){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ae=m;m=W;try{return G()}finally{m=ae}},t.unstable_scheduleCallback=function(W,G,ae){var pe=t.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?pe+ae:pe):ae=pe,W){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=ae+fe,W={id:u++,callback:G,priorityLevel:W,startTime:ae,expirationTime:fe,sortIndex:-1},ae>pe?(W.sortIndex=ae,e(c,W),n(l)===null&&W===n(c)&&(g?(b(A),A=-1):g=!0,je(P,ae-pe))):(W.sortIndex=fe,e(l,W),v||p||(v=!0,Oe(T))),W},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(W){var G=m;return function(){var ae=m;m=G;try{return W.apply(this,arguments)}finally{m=ae}}}})(BR);$R.exports=BR;var uF=$R.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dF=y,js=uF;function me(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zR=new Set,nf={};function Tc(t,e){zu(t,e),zu(t+"Capture",e)}function zu(t,e){for(nf[t]=e,t=0;t<e.length;t++)zR.add(e[t])}var Co=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l_=Object.prototype.hasOwnProperty,hF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qI={},HI={};function fF(t){return l_.call(HI,t)?!0:l_.call(qI,t)?!1:hF.test(t)?HI[t]=!0:(qI[t]=!0,!1)}function mF(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function pF(t,e,n,r){if(e===null||typeof e>"u"||mF(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function as(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var $r={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$r[t]=new as(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$r[e]=new as(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$r[t]=new as(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$r[t]=new as(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$r[t]=new as(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$r[t]=new as(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$r[t]=new as(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$r[t]=new as(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$r[t]=new as(t,5,!1,t.toLowerCase(),null,!1,!1)});var vb=/[\-:]([a-z])/g;function wb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(vb,wb);$r[e]=new as(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(vb,wb);$r[e]=new as(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(vb,wb);$r[e]=new as(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$r[t]=new as(t,1,!1,t.toLowerCase(),null,!1,!1)});$r.xlinkHref=new as("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$r[t]=new as(t,1,!1,t.toLowerCase(),null,!0,!0)});function _b(t,e,n,r){var s=$r.hasOwnProperty(e)?$r[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(pF(e,n,s,r)&&(n=null),r||s===null?fF(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Bo=dF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nm=Symbol.for("react.element"),tu=Symbol.for("react.portal"),nu=Symbol.for("react.fragment"),bb=Symbol.for("react.strict_mode"),c_=Symbol.for("react.profiler"),WR=Symbol.for("react.provider"),qR=Symbol.for("react.context"),Eb=Symbol.for("react.forward_ref"),u_=Symbol.for("react.suspense"),d_=Symbol.for("react.suspense_list"),Sb=Symbol.for("react.memo"),ca=Symbol.for("react.lazy"),HR=Symbol.for("react.offscreen"),KI=Symbol.iterator;function th(t){return t===null||typeof t!="object"?null:(t=KI&&t[KI]||t["@@iterator"],typeof t=="function"?t:null)}var Hn=Object.assign,Qv;function yh(t){if(Qv===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Qv=e&&e[1]||""}return`
`+Qv+t}var Yv=!1;function Jv(t,e){if(!t||Yv)return"";Yv=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Yv=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?yh(t):""}function gF(t){switch(t.tag){case 5:return yh(t.type);case 16:return yh("Lazy");case 13:return yh("Suspense");case 19:return yh("SuspenseList");case 0:case 2:case 15:return t=Jv(t.type,!1),t;case 11:return t=Jv(t.type.render,!1),t;case 1:return t=Jv(t.type,!0),t;default:return""}}function h_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case nu:return"Fragment";case tu:return"Portal";case c_:return"Profiler";case bb:return"StrictMode";case u_:return"Suspense";case d_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case qR:return(t.displayName||"Context")+".Consumer";case WR:return(t._context.displayName||"Context")+".Provider";case Eb:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Sb:return e=t.displayName||null,e!==null?e:h_(t.type)||"Memo";case ca:e=t._payload,t=t._init;try{return h_(t(e))}catch{}}return null}function yF(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return h_(e);case 8:return e===bb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ga(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function KR(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function vF(t){var e=KR(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function km(t){t._valueTracker||(t._valueTracker=vF(t))}function GR(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=KR(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function rg(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function f_(t,e){var n=e.checked;return Hn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function GI(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ga(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function QR(t,e){e=e.checked,e!=null&&_b(t,"checked",e,!1)}function m_(t,e){QR(t,e);var n=Ga(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?p_(t,e.type,n):e.hasOwnProperty("defaultValue")&&p_(t,e.type,Ga(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function QI(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function p_(t,e,n){(e!=="number"||rg(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var vh=Array.isArray;function _u(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ga(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function g_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(me(91));return Hn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function YI(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(me(92));if(vh(n)){if(1<n.length)throw Error(me(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ga(n)}}function YR(t,e){var n=Ga(e.value),r=Ga(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function JI(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function JR(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function y_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?JR(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Dm,XR=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Dm=Dm||document.createElement("div"),Dm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Dm.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function rf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ch={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wF=["Webkit","ms","Moz","O"];Object.keys(Ch).forEach(function(t){wF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ch[e]=Ch[t]})});function ZR(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ch.hasOwnProperty(t)&&Ch[t]?(""+e).trim():e+"px"}function eC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ZR(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var _F=Hn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function v_(t,e){if(e){if(_F[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(me(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(me(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(me(61))}if(e.style!=null&&typeof e.style!="object")throw Error(me(62))}}function w_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var __=null;function Ib(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var b_=null,bu=null,Eu=null;function XI(t){if(t=Qf(t)){if(typeof b_!="function")throw Error(me(280));var e=t.stateNode;e&&(e=xy(e),b_(t.stateNode,t.type,e))}}function tC(t){bu?Eu?Eu.push(t):Eu=[t]:bu=t}function nC(){if(bu){var t=bu,e=Eu;if(Eu=bu=null,XI(t),e)for(t=0;t<e.length;t++)XI(e[t])}}function rC(t,e){return t(e)}function sC(){}var Xv=!1;function iC(t,e,n){if(Xv)return t(e,n);Xv=!0;try{return rC(t,e,n)}finally{Xv=!1,(bu!==null||Eu!==null)&&(sC(),nC())}}function sf(t,e){var n=t.stateNode;if(n===null)return null;var r=xy(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(me(231,e,typeof n));return n}var E_=!1;if(Co)try{var nh={};Object.defineProperty(nh,"passive",{get:function(){E_=!0}}),window.addEventListener("test",nh,nh),window.removeEventListener("test",nh,nh)}catch{E_=!1}function bF(t,e,n,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Nh=!1,sg=null,ig=!1,S_=null,EF={onError:function(t){Nh=!0,sg=t}};function SF(t,e,n,r,s,i,o,a,l){Nh=!1,sg=null,bF.apply(EF,arguments)}function IF(t,e,n,r,s,i,o,a,l){if(SF.apply(this,arguments),Nh){if(Nh){var c=sg;Nh=!1,sg=null}else throw Error(me(198));ig||(ig=!0,S_=c)}}function xc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function oC(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ZI(t){if(xc(t)!==t)throw Error(me(188))}function TF(t){var e=t.alternate;if(!e){if(e=xc(t),e===null)throw Error(me(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return ZI(s),t;if(i===r)return ZI(s),e;i=i.sibling}throw Error(me(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(me(189))}}if(n.alternate!==r)throw Error(me(190))}if(n.tag!==3)throw Error(me(188));return n.stateNode.current===n?t:e}function aC(t){return t=TF(t),t!==null?lC(t):null}function lC(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lC(t);if(e!==null)return e;t=t.sibling}return null}var cC=js.unstable_scheduleCallback,eT=js.unstable_cancelCallback,xF=js.unstable_shouldYield,AF=js.unstable_requestPaint,sr=js.unstable_now,PF=js.unstable_getCurrentPriorityLevel,Tb=js.unstable_ImmediatePriority,uC=js.unstable_UserBlockingPriority,og=js.unstable_NormalPriority,RF=js.unstable_LowPriority,dC=js.unstable_IdlePriority,Ey=null,Ki=null;function CF(t){if(Ki&&typeof Ki.onCommitFiberRoot=="function")try{Ki.onCommitFiberRoot(Ey,t,void 0,(t.current.flags&128)===128)}catch{}}var hi=Math.clz32?Math.clz32:DF,NF=Math.log,kF=Math.LN2;function DF(t){return t>>>=0,t===0?32:31-(NF(t)/kF|0)|0}var Om=64,Lm=4194304;function wh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ag(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=wh(a):(i&=o,i!==0&&(r=wh(i)))}else o=n&~s,o!==0?r=wh(o):i!==0&&(r=wh(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-hi(e),s=1<<n,r|=t[n],e&=~s;return r}function OF(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function LF(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-hi(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=OF(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function I_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function hC(){var t=Om;return Om<<=1,!(Om&4194240)&&(Om=64),t}function Zv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Kf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-hi(e),t[e]=n}function MF(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-hi(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function xb(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-hi(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var pn=0;function fC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var mC,Ab,pC,gC,yC,T_=!1,Mm=[],Da=null,Oa=null,La=null,of=new Map,af=new Map,ha=[],VF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tT(t,e){switch(t){case"focusin":case"focusout":Da=null;break;case"dragenter":case"dragleave":Oa=null;break;case"mouseover":case"mouseout":La=null;break;case"pointerover":case"pointerout":of.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":af.delete(e.pointerId)}}function rh(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Qf(e),e!==null&&Ab(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function jF(t,e,n,r,s){switch(e){case"focusin":return Da=rh(Da,t,e,n,r,s),!0;case"dragenter":return Oa=rh(Oa,t,e,n,r,s),!0;case"mouseover":return La=rh(La,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return of.set(i,rh(of.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,af.set(i,rh(af.get(i)||null,t,e,n,r,s)),!0}return!1}function vC(t){var e=zl(t.target);if(e!==null){var n=xc(e);if(n!==null){if(e=n.tag,e===13){if(e=oC(n),e!==null){t.blockedOn=e,yC(t.priority,function(){pC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Sp(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=x_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);__=r,n.target.dispatchEvent(r),__=null}else return e=Qf(n),e!==null&&Ab(e),t.blockedOn=n,!1;e.shift()}return!0}function nT(t,e,n){Sp(t)&&n.delete(e)}function FF(){T_=!1,Da!==null&&Sp(Da)&&(Da=null),Oa!==null&&Sp(Oa)&&(Oa=null),La!==null&&Sp(La)&&(La=null),of.forEach(nT),af.forEach(nT)}function sh(t,e){t.blockedOn===e&&(t.blockedOn=null,T_||(T_=!0,js.unstable_scheduleCallback(js.unstable_NormalPriority,FF)))}function lf(t){function e(s){return sh(s,t)}if(0<Mm.length){sh(Mm[0],t);for(var n=1;n<Mm.length;n++){var r=Mm[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Da!==null&&sh(Da,t),Oa!==null&&sh(Oa,t),La!==null&&sh(La,t),of.forEach(e),af.forEach(e),n=0;n<ha.length;n++)r=ha[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ha.length&&(n=ha[0],n.blockedOn===null);)vC(n),n.blockedOn===null&&ha.shift()}var Su=Bo.ReactCurrentBatchConfig,lg=!0;function UF(t,e,n,r){var s=pn,i=Su.transition;Su.transition=null;try{pn=1,Pb(t,e,n,r)}finally{pn=s,Su.transition=i}}function $F(t,e,n,r){var s=pn,i=Su.transition;Su.transition=null;try{pn=4,Pb(t,e,n,r)}finally{pn=s,Su.transition=i}}function Pb(t,e,n,r){if(lg){var s=x_(t,e,n,r);if(s===null)cw(t,e,r,cg,n),tT(t,r);else if(jF(s,t,e,n,r))r.stopPropagation();else if(tT(t,r),e&4&&-1<VF.indexOf(t)){for(;s!==null;){var i=Qf(s);if(i!==null&&mC(i),i=x_(t,e,n,r),i===null&&cw(t,e,r,cg,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else cw(t,e,r,null,n)}}var cg=null;function x_(t,e,n,r){if(cg=null,t=Ib(r),t=zl(t),t!==null)if(e=xc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=oC(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cg=t,null}function wC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(PF()){case Tb:return 1;case uC:return 4;case og:case RF:return 16;case dC:return 536870912;default:return 16}default:return 16}}var xa=null,Rb=null,Ip=null;function _C(){if(Ip)return Ip;var t,e=Rb,n=e.length,r,s="value"in xa?xa.value:xa.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Ip=s.slice(t,1<r?1-r:void 0)}function Tp(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Vm(){return!0}function rT(){return!1}function Bs(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Vm:rT,this.isPropagationStopped=rT,this}return Hn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Vm)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Vm)},persist:function(){},isPersistent:Vm}),e}var Cd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cb=Bs(Cd),Gf=Hn({},Cd,{view:0,detail:0}),BF=Bs(Gf),ew,tw,ih,Sy=Hn({},Gf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ih&&(ih&&t.type==="mousemove"?(ew=t.screenX-ih.screenX,tw=t.screenY-ih.screenY):tw=ew=0,ih=t),ew)},movementY:function(t){return"movementY"in t?t.movementY:tw}}),sT=Bs(Sy),zF=Hn({},Sy,{dataTransfer:0}),WF=Bs(zF),qF=Hn({},Gf,{relatedTarget:0}),nw=Bs(qF),HF=Hn({},Cd,{animationName:0,elapsedTime:0,pseudoElement:0}),KF=Bs(HF),GF=Hn({},Cd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),QF=Bs(GF),YF=Hn({},Cd,{data:0}),iT=Bs(YF),JF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},XF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function e4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ZF[t])?!!e[t]:!1}function Nb(){return e4}var t4=Hn({},Gf,{key:function(t){if(t.key){var e=JF[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Tp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?XF[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nb,charCode:function(t){return t.type==="keypress"?Tp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Tp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),n4=Bs(t4),r4=Hn({},Sy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oT=Bs(r4),s4=Hn({},Gf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nb}),i4=Bs(s4),o4=Hn({},Cd,{propertyName:0,elapsedTime:0,pseudoElement:0}),a4=Bs(o4),l4=Hn({},Sy,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),c4=Bs(l4),u4=[9,13,27,32],kb=Co&&"CompositionEvent"in window,kh=null;Co&&"documentMode"in document&&(kh=document.documentMode);var d4=Co&&"TextEvent"in window&&!kh,bC=Co&&(!kb||kh&&8<kh&&11>=kh),aT=" ",lT=!1;function EC(t,e){switch(t){case"keyup":return u4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function SC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ru=!1;function h4(t,e){switch(t){case"compositionend":return SC(e);case"keypress":return e.which!==32?null:(lT=!0,aT);case"textInput":return t=e.data,t===aT&&lT?null:t;default:return null}}function f4(t,e){if(ru)return t==="compositionend"||!kb&&EC(t,e)?(t=_C(),Ip=Rb=xa=null,ru=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return bC&&e.locale!=="ko"?null:e.data;default:return null}}var m4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!m4[t.type]:e==="textarea"}function IC(t,e,n,r){tC(r),e=ug(e,"onChange"),0<e.length&&(n=new Cb("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Dh=null,cf=null;function p4(t){LC(t,0)}function Iy(t){var e=ou(t);if(GR(e))return t}function g4(t,e){if(t==="change")return e}var TC=!1;if(Co){var rw;if(Co){var sw="oninput"in document;if(!sw){var uT=document.createElement("div");uT.setAttribute("oninput","return;"),sw=typeof uT.oninput=="function"}rw=sw}else rw=!1;TC=rw&&(!document.documentMode||9<document.documentMode)}function dT(){Dh&&(Dh.detachEvent("onpropertychange",xC),cf=Dh=null)}function xC(t){if(t.propertyName==="value"&&Iy(cf)){var e=[];IC(e,cf,t,Ib(t)),iC(p4,e)}}function y4(t,e,n){t==="focusin"?(dT(),Dh=e,cf=n,Dh.attachEvent("onpropertychange",xC)):t==="focusout"&&dT()}function v4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Iy(cf)}function w4(t,e){if(t==="click")return Iy(e)}function _4(t,e){if(t==="input"||t==="change")return Iy(e)}function b4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var gi=typeof Object.is=="function"?Object.is:b4;function uf(t,e){if(gi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!l_.call(e,s)||!gi(t[s],e[s]))return!1}return!0}function hT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fT(t,e){var n=hT(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=hT(n)}}function AC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?AC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function PC(){for(var t=window,e=rg();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=rg(t.document)}return e}function Db(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function E4(t){var e=PC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&AC(n.ownerDocument.documentElement,n)){if(r!==null&&Db(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=fT(n,i);var o=fT(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var S4=Co&&"documentMode"in document&&11>=document.documentMode,su=null,A_=null,Oh=null,P_=!1;function mT(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;P_||su==null||su!==rg(r)||(r=su,"selectionStart"in r&&Db(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Oh&&uf(Oh,r)||(Oh=r,r=ug(A_,"onSelect"),0<r.length&&(e=new Cb("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=su)))}function jm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var iu={animationend:jm("Animation","AnimationEnd"),animationiteration:jm("Animation","AnimationIteration"),animationstart:jm("Animation","AnimationStart"),transitionend:jm("Transition","TransitionEnd")},iw={},RC={};Co&&(RC=document.createElement("div").style,"AnimationEvent"in window||(delete iu.animationend.animation,delete iu.animationiteration.animation,delete iu.animationstart.animation),"TransitionEvent"in window||delete iu.transitionend.transition);function Ty(t){if(iw[t])return iw[t];if(!iu[t])return t;var e=iu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in RC)return iw[t]=e[n];return t}var CC=Ty("animationend"),NC=Ty("animationiteration"),kC=Ty("animationstart"),DC=Ty("transitionend"),OC=new Map,pT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cl(t,e){OC.set(t,e),Tc(e,[t])}for(var ow=0;ow<pT.length;ow++){var aw=pT[ow],I4=aw.toLowerCase(),T4=aw[0].toUpperCase()+aw.slice(1);cl(I4,"on"+T4)}cl(CC,"onAnimationEnd");cl(NC,"onAnimationIteration");cl(kC,"onAnimationStart");cl("dblclick","onDoubleClick");cl("focusin","onFocus");cl("focusout","onBlur");cl(DC,"onTransitionEnd");zu("onMouseEnter",["mouseout","mouseover"]);zu("onMouseLeave",["mouseout","mouseover"]);zu("onPointerEnter",["pointerout","pointerover"]);zu("onPointerLeave",["pointerout","pointerover"]);Tc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _h="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),x4=new Set("cancel close invalid load scroll toggle".split(" ").concat(_h));function gT(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,IF(r,e,void 0,t),t.currentTarget=null}function LC(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;gT(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;gT(s,a,c),i=l}}}if(ig)throw t=S_,ig=!1,S_=null,t}function Nn(t,e){var n=e[D_];n===void 0&&(n=e[D_]=new Set);var r=t+"__bubble";n.has(r)||(MC(e,t,2,!1),n.add(r))}function lw(t,e,n){var r=0;e&&(r|=4),MC(n,t,r,e)}var Fm="_reactListening"+Math.random().toString(36).slice(2);function df(t){if(!t[Fm]){t[Fm]=!0,zR.forEach(function(n){n!=="selectionchange"&&(x4.has(n)||lw(n,!1,t),lw(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Fm]||(e[Fm]=!0,lw("selectionchange",!1,e))}}function MC(t,e,n,r){switch(wC(e)){case 1:var s=UF;break;case 4:s=$F;break;default:s=Pb}n=s.bind(null,e,n,t),s=void 0,!E_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function cw(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=zl(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}iC(function(){var c=i,u=Ib(n),d=[];e:{var m=OC.get(t);if(m!==void 0){var p=Cb,v=t;switch(t){case"keypress":if(Tp(n)===0)break e;case"keydown":case"keyup":p=n4;break;case"focusin":v="focus",p=nw;break;case"focusout":v="blur",p=nw;break;case"beforeblur":case"afterblur":p=nw;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=sT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=WF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=i4;break;case CC:case NC:case kC:p=KF;break;case DC:p=a4;break;case"scroll":p=BF;break;case"wheel":p=c4;break;case"copy":case"cut":case"paste":p=QF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=oT}var g=(e&4)!==0,E=!g&&t==="scroll",b=g?m!==null?m+"Capture":null:m;g=[];for(var _=c,S;_!==null;){S=_;var P=S.stateNode;if(S.tag===5&&P!==null&&(S=P,b!==null&&(P=sf(_,b),P!=null&&g.push(hf(_,P,S)))),E)break;_=_.return}0<g.length&&(m=new p(m,v,null,n,u),d.push({event:m,listeners:g}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",m&&n!==__&&(v=n.relatedTarget||n.fromElement)&&(zl(v)||v[No]))break e;if((p||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,p?(v=n.relatedTarget||n.toElement,p=c,v=v?zl(v):null,v!==null&&(E=xc(v),v!==E||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=c),p!==v)){if(g=sT,P="onMouseLeave",b="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(g=oT,P="onPointerLeave",b="onPointerEnter",_="pointer"),E=p==null?m:ou(p),S=v==null?m:ou(v),m=new g(P,_+"leave",p,n,u),m.target=E,m.relatedTarget=S,P=null,zl(u)===c&&(g=new g(b,_+"enter",v,n,u),g.target=S,g.relatedTarget=E,P=g),E=P,p&&v)t:{for(g=p,b=v,_=0,S=g;S;S=jc(S))_++;for(S=0,P=b;P;P=jc(P))S++;for(;0<_-S;)g=jc(g),_--;for(;0<S-_;)b=jc(b),S--;for(;_--;){if(g===b||b!==null&&g===b.alternate)break t;g=jc(g),b=jc(b)}g=null}else g=null;p!==null&&yT(d,m,p,g,!1),v!==null&&E!==null&&yT(d,E,v,g,!0)}}e:{if(m=c?ou(c):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var T=g4;else if(cT(m))if(TC)T=_4;else{T=v4;var N=y4}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(T=w4);if(T&&(T=T(t,c))){IC(d,T,n,u);break e}N&&N(t,m,c),t==="focusout"&&(N=m._wrapperState)&&N.controlled&&m.type==="number"&&p_(m,"number",m.value)}switch(N=c?ou(c):window,t){case"focusin":(cT(N)||N.contentEditable==="true")&&(su=N,A_=c,Oh=null);break;case"focusout":Oh=A_=su=null;break;case"mousedown":P_=!0;break;case"contextmenu":case"mouseup":case"dragend":P_=!1,mT(d,n,u);break;case"selectionchange":if(S4)break;case"keydown":case"keyup":mT(d,n,u)}var I;if(kb)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else ru?EC(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(bC&&n.locale!=="ko"&&(ru||A!=="onCompositionStart"?A==="onCompositionEnd"&&ru&&(I=_C()):(xa=u,Rb="value"in xa?xa.value:xa.textContent,ru=!0)),N=ug(c,A),0<N.length&&(A=new iT(A,t,null,n,u),d.push({event:A,listeners:N}),I?A.data=I:(I=SC(n),I!==null&&(A.data=I)))),(I=d4?h4(t,n):f4(t,n))&&(c=ug(c,"onBeforeInput"),0<c.length&&(u=new iT("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=I))}LC(d,e)})}function hf(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ug(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=sf(t,n),i!=null&&r.unshift(hf(t,i,s)),i=sf(t,e),i!=null&&r.push(hf(t,i,s))),t=t.return}return r}function jc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function yT(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=sf(n,i),l!=null&&o.unshift(hf(n,l,a))):s||(l=sf(n,i),l!=null&&o.push(hf(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var A4=/\r\n?/g,P4=/\u0000|\uFFFD/g;function vT(t){return(typeof t=="string"?t:""+t).replace(A4,`
`).replace(P4,"")}function Um(t,e,n){if(e=vT(e),vT(t)!==e&&n)throw Error(me(425))}function dg(){}var R_=null,C_=null;function N_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var k_=typeof setTimeout=="function"?setTimeout:void 0,R4=typeof clearTimeout=="function"?clearTimeout:void 0,wT=typeof Promise=="function"?Promise:void 0,C4=typeof queueMicrotask=="function"?queueMicrotask:typeof wT<"u"?function(t){return wT.resolve(null).then(t).catch(N4)}:k_;function N4(t){setTimeout(function(){throw t})}function uw(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),lf(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);lf(e)}function Ma(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function _T(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Nd=Math.random().toString(36).slice(2),Ui="__reactFiber$"+Nd,ff="__reactProps$"+Nd,No="__reactContainer$"+Nd,D_="__reactEvents$"+Nd,k4="__reactListeners$"+Nd,D4="__reactHandles$"+Nd;function zl(t){var e=t[Ui];if(e)return e;for(var n=t.parentNode;n;){if(e=n[No]||n[Ui]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=_T(t);t!==null;){if(n=t[Ui])return n;t=_T(t)}return e}t=n,n=t.parentNode}return null}function Qf(t){return t=t[Ui]||t[No],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ou(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(me(33))}function xy(t){return t[ff]||null}var O_=[],au=-1;function ul(t){return{current:t}}function Ln(t){0>au||(t.current=O_[au],O_[au]=null,au--)}function Tn(t,e){au++,O_[au]=t.current,t.current=e}var Qa={},Zr=ul(Qa),_s=ul(!1),oc=Qa;function Wu(t,e){var n=t.type.contextTypes;if(!n)return Qa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function bs(t){return t=t.childContextTypes,t!=null}function hg(){Ln(_s),Ln(Zr)}function bT(t,e,n){if(Zr.current!==Qa)throw Error(me(168));Tn(Zr,e),Tn(_s,n)}function VC(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(me(108,yF(t)||"Unknown",s));return Hn({},n,r)}function fg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Qa,oc=Zr.current,Tn(Zr,t),Tn(_s,_s.current),!0}function ET(t,e,n){var r=t.stateNode;if(!r)throw Error(me(169));n?(t=VC(t,e,oc),r.__reactInternalMemoizedMergedChildContext=t,Ln(_s),Ln(Zr),Tn(Zr,t)):Ln(_s),Tn(_s,n)}var go=null,Ay=!1,dw=!1;function jC(t){go===null?go=[t]:go.push(t)}function O4(t){Ay=!0,jC(t)}function dl(){if(!dw&&go!==null){dw=!0;var t=0,e=pn;try{var n=go;for(pn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}go=null,Ay=!1}catch(s){throw go!==null&&(go=go.slice(t+1)),cC(Tb,dl),s}finally{pn=e,dw=!1}}return null}var lu=[],cu=0,mg=null,pg=0,Ws=[],qs=0,ac=null,wo=1,_o="";function Pl(t,e){lu[cu++]=pg,lu[cu++]=mg,mg=t,pg=e}function FC(t,e,n){Ws[qs++]=wo,Ws[qs++]=_o,Ws[qs++]=ac,ac=t;var r=wo;t=_o;var s=32-hi(r)-1;r&=~(1<<s),n+=1;var i=32-hi(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,wo=1<<32-hi(e)+s|n<<s|r,_o=i+t}else wo=1<<i|n<<s|r,_o=t}function Ob(t){t.return!==null&&(Pl(t,1),FC(t,1,0))}function Lb(t){for(;t===mg;)mg=lu[--cu],lu[cu]=null,pg=lu[--cu],lu[cu]=null;for(;t===ac;)ac=Ws[--qs],Ws[qs]=null,_o=Ws[--qs],Ws[qs]=null,wo=Ws[--qs],Ws[qs]=null}var Os=null,ks=null,Un=!1,ui=null;function UC(t,e){var n=Ks(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ST(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Os=t,ks=Ma(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Os=t,ks=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ac!==null?{id:wo,overflow:_o}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ks(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Os=t,ks=null,!0):!1;default:return!1}}function L_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function M_(t){if(Un){var e=ks;if(e){var n=e;if(!ST(t,e)){if(L_(t))throw Error(me(418));e=Ma(n.nextSibling);var r=Os;e&&ST(t,e)?UC(r,n):(t.flags=t.flags&-4097|2,Un=!1,Os=t)}}else{if(L_(t))throw Error(me(418));t.flags=t.flags&-4097|2,Un=!1,Os=t}}}function IT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Os=t}function $m(t){if(t!==Os)return!1;if(!Un)return IT(t),Un=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!N_(t.type,t.memoizedProps)),e&&(e=ks)){if(L_(t))throw $C(),Error(me(418));for(;e;)UC(t,e),e=Ma(e.nextSibling)}if(IT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(me(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ks=Ma(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ks=null}}else ks=Os?Ma(t.stateNode.nextSibling):null;return!0}function $C(){for(var t=ks;t;)t=Ma(t.nextSibling)}function qu(){ks=Os=null,Un=!1}function Mb(t){ui===null?ui=[t]:ui.push(t)}var L4=Bo.ReactCurrentBatchConfig;function oh(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(me(309));var r=n.stateNode}if(!r)throw Error(me(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(me(284));if(!n._owner)throw Error(me(290,t))}return t}function Bm(t,e){throw t=Object.prototype.toString.call(e),Error(me(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function TT(t){var e=t._init;return e(t._payload)}function BC(t){function e(b,_){if(t){var S=b.deletions;S===null?(b.deletions=[_],b.flags|=16):S.push(_)}}function n(b,_){if(!t)return null;for(;_!==null;)e(b,_),_=_.sibling;return null}function r(b,_){for(b=new Map;_!==null;)_.key!==null?b.set(_.key,_):b.set(_.index,_),_=_.sibling;return b}function s(b,_){return b=Ua(b,_),b.index=0,b.sibling=null,b}function i(b,_,S){return b.index=S,t?(S=b.alternate,S!==null?(S=S.index,S<_?(b.flags|=2,_):S):(b.flags|=2,_)):(b.flags|=1048576,_)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function a(b,_,S,P){return _===null||_.tag!==6?(_=vw(S,b.mode,P),_.return=b,_):(_=s(_,S),_.return=b,_)}function l(b,_,S,P){var T=S.type;return T===nu?u(b,_,S.props.children,P,S.key):_!==null&&(_.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ca&&TT(T)===_.type)?(P=s(_,S.props),P.ref=oh(b,_,S),P.return=b,P):(P=kp(S.type,S.key,S.props,null,b.mode,P),P.ref=oh(b,_,S),P.return=b,P)}function c(b,_,S,P){return _===null||_.tag!==4||_.stateNode.containerInfo!==S.containerInfo||_.stateNode.implementation!==S.implementation?(_=ww(S,b.mode,P),_.return=b,_):(_=s(_,S.children||[]),_.return=b,_)}function u(b,_,S,P,T){return _===null||_.tag!==7?(_=ec(S,b.mode,P,T),_.return=b,_):(_=s(_,S),_.return=b,_)}function d(b,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return _=vw(""+_,b.mode,S),_.return=b,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Nm:return S=kp(_.type,_.key,_.props,null,b.mode,S),S.ref=oh(b,null,_),S.return=b,S;case tu:return _=ww(_,b.mode,S),_.return=b,_;case ca:var P=_._init;return d(b,P(_._payload),S)}if(vh(_)||th(_))return _=ec(_,b.mode,S,null),_.return=b,_;Bm(b,_)}return null}function m(b,_,S,P){var T=_!==null?_.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return T!==null?null:a(b,_,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Nm:return S.key===T?l(b,_,S,P):null;case tu:return S.key===T?c(b,_,S,P):null;case ca:return T=S._init,m(b,_,T(S._payload),P)}if(vh(S)||th(S))return T!==null?null:u(b,_,S,P,null);Bm(b,S)}return null}function p(b,_,S,P,T){if(typeof P=="string"&&P!==""||typeof P=="number")return b=b.get(S)||null,a(_,b,""+P,T);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Nm:return b=b.get(P.key===null?S:P.key)||null,l(_,b,P,T);case tu:return b=b.get(P.key===null?S:P.key)||null,c(_,b,P,T);case ca:var N=P._init;return p(b,_,S,N(P._payload),T)}if(vh(P)||th(P))return b=b.get(S)||null,u(_,b,P,T,null);Bm(_,P)}return null}function v(b,_,S,P){for(var T=null,N=null,I=_,A=_=0,R=null;I!==null&&A<S.length;A++){I.index>A?(R=I,I=null):R=I.sibling;var k=m(b,I,S[A],P);if(k===null){I===null&&(I=R);break}t&&I&&k.alternate===null&&e(b,I),_=i(k,_,A),N===null?T=k:N.sibling=k,N=k,I=R}if(A===S.length)return n(b,I),Un&&Pl(b,A),T;if(I===null){for(;A<S.length;A++)I=d(b,S[A],P),I!==null&&(_=i(I,_,A),N===null?T=I:N.sibling=I,N=I);return Un&&Pl(b,A),T}for(I=r(b,I);A<S.length;A++)R=p(I,b,A,S[A],P),R!==null&&(t&&R.alternate!==null&&I.delete(R.key===null?A:R.key),_=i(R,_,A),N===null?T=R:N.sibling=R,N=R);return t&&I.forEach(function(C){return e(b,C)}),Un&&Pl(b,A),T}function g(b,_,S,P){var T=th(S);if(typeof T!="function")throw Error(me(150));if(S=T.call(S),S==null)throw Error(me(151));for(var N=T=null,I=_,A=_=0,R=null,k=S.next();I!==null&&!k.done;A++,k=S.next()){I.index>A?(R=I,I=null):R=I.sibling;var C=m(b,I,k.value,P);if(C===null){I===null&&(I=R);break}t&&I&&C.alternate===null&&e(b,I),_=i(C,_,A),N===null?T=C:N.sibling=C,N=C,I=R}if(k.done)return n(b,I),Un&&Pl(b,A),T;if(I===null){for(;!k.done;A++,k=S.next())k=d(b,k.value,P),k!==null&&(_=i(k,_,A),N===null?T=k:N.sibling=k,N=k);return Un&&Pl(b,A),T}for(I=r(b,I);!k.done;A++,k=S.next())k=p(I,b,A,k.value,P),k!==null&&(t&&k.alternate!==null&&I.delete(k.key===null?A:k.key),_=i(k,_,A),N===null?T=k:N.sibling=k,N=k);return t&&I.forEach(function(L){return e(b,L)}),Un&&Pl(b,A),T}function E(b,_,S,P){if(typeof S=="object"&&S!==null&&S.type===nu&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Nm:e:{for(var T=S.key,N=_;N!==null;){if(N.key===T){if(T=S.type,T===nu){if(N.tag===7){n(b,N.sibling),_=s(N,S.props.children),_.return=b,b=_;break e}}else if(N.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ca&&TT(T)===N.type){n(b,N.sibling),_=s(N,S.props),_.ref=oh(b,N,S),_.return=b,b=_;break e}n(b,N);break}else e(b,N);N=N.sibling}S.type===nu?(_=ec(S.props.children,b.mode,P,S.key),_.return=b,b=_):(P=kp(S.type,S.key,S.props,null,b.mode,P),P.ref=oh(b,_,S),P.return=b,b=P)}return o(b);case tu:e:{for(N=S.key;_!==null;){if(_.key===N)if(_.tag===4&&_.stateNode.containerInfo===S.containerInfo&&_.stateNode.implementation===S.implementation){n(b,_.sibling),_=s(_,S.children||[]),_.return=b,b=_;break e}else{n(b,_);break}else e(b,_);_=_.sibling}_=ww(S,b.mode,P),_.return=b,b=_}return o(b);case ca:return N=S._init,E(b,_,N(S._payload),P)}if(vh(S))return v(b,_,S,P);if(th(S))return g(b,_,S,P);Bm(b,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,_!==null&&_.tag===6?(n(b,_.sibling),_=s(_,S),_.return=b,b=_):(n(b,_),_=vw(S,b.mode,P),_.return=b,b=_),o(b)):n(b,_)}return E}var Hu=BC(!0),zC=BC(!1),gg=ul(null),yg=null,uu=null,Vb=null;function jb(){Vb=uu=yg=null}function Fb(t){var e=gg.current;Ln(gg),t._currentValue=e}function V_(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Iu(t,e){yg=t,Vb=uu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ps=!0),t.firstContext=null)}function Js(t){var e=t._currentValue;if(Vb!==t)if(t={context:t,memoizedValue:e,next:null},uu===null){if(yg===null)throw Error(me(308));uu=t,yg.dependencies={lanes:0,firstContext:t}}else uu=uu.next=t;return e}var Wl=null;function Ub(t){Wl===null?Wl=[t]:Wl.push(t)}function WC(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Ub(e)):(n.next=s.next,s.next=n),e.interleaved=n,ko(t,r)}function ko(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ua=!1;function $b(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Va(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,en&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,ko(t,n)}return s=r.interleaved,s===null?(e.next=e,Ub(r)):(e.next=s.next,s.next=e),r.interleaved=e,ko(t,n)}function xp(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,xb(t,n)}}function xT(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function vg(t,e,n,r){var s=t.updateQueue;ua=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=s.baseState;o=0,u=c=l=null,a=i;do{var m=a.lane,p=a.eventTime;if((r&m)===m){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=t,g=a;switch(m=e,p=n,g.tag){case 1:if(v=g.payload,typeof v=="function"){d=v.call(p,d,m);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,m=typeof v=="function"?v.call(p,d,m):v,m==null)break e;d=Hn({},d,m);break e;case 2:ua=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else p={eventTime:p,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);cc|=o,t.lanes=o,t.memoizedState=d}}function AT(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(me(191,s));s.call(r)}}}var Yf={},Gi=ul(Yf),mf=ul(Yf),pf=ul(Yf);function ql(t){if(t===Yf)throw Error(me(174));return t}function Bb(t,e){switch(Tn(pf,e),Tn(mf,t),Tn(Gi,Yf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:y_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=y_(e,t)}Ln(Gi),Tn(Gi,e)}function Ku(){Ln(Gi),Ln(mf),Ln(pf)}function HC(t){ql(pf.current);var e=ql(Gi.current),n=y_(e,t.type);e!==n&&(Tn(mf,t),Tn(Gi,n))}function zb(t){mf.current===t&&(Ln(Gi),Ln(mf))}var zn=ul(0);function wg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var hw=[];function Wb(){for(var t=0;t<hw.length;t++)hw[t]._workInProgressVersionPrimary=null;hw.length=0}var Ap=Bo.ReactCurrentDispatcher,fw=Bo.ReactCurrentBatchConfig,lc=0,qn=null,yr=null,Ar=null,_g=!1,Lh=!1,gf=0,M4=0;function qr(){throw Error(me(321))}function qb(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!gi(t[n],e[n]))return!1;return!0}function Hb(t,e,n,r,s,i){if(lc=i,qn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ap.current=t===null||t.memoizedState===null?U4:$4,t=n(r,s),Lh){i=0;do{if(Lh=!1,gf=0,25<=i)throw Error(me(301));i+=1,Ar=yr=null,e.updateQueue=null,Ap.current=B4,t=n(r,s)}while(Lh)}if(Ap.current=bg,e=yr!==null&&yr.next!==null,lc=0,Ar=yr=qn=null,_g=!1,e)throw Error(me(300));return t}function Kb(){var t=gf!==0;return gf=0,t}function Di(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ar===null?qn.memoizedState=Ar=t:Ar=Ar.next=t,Ar}function Xs(){if(yr===null){var t=qn.alternate;t=t!==null?t.memoizedState:null}else t=yr.next;var e=Ar===null?qn.memoizedState:Ar.next;if(e!==null)Ar=e,yr=t;else{if(t===null)throw Error(me(310));yr=t,t={memoizedState:yr.memoizedState,baseState:yr.baseState,baseQueue:yr.baseQueue,queue:yr.queue,next:null},Ar===null?qn.memoizedState=Ar=t:Ar=Ar.next=t}return Ar}function yf(t,e){return typeof e=="function"?e(t):e}function mw(t){var e=Xs(),n=e.queue;if(n===null)throw Error(me(311));n.lastRenderedReducer=t;var r=yr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((lc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,qn.lanes|=u,cc|=u}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,gi(r,e.memoizedState)||(ps=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,qn.lanes|=i,cc|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function pw(t){var e=Xs(),n=e.queue;if(n===null)throw Error(me(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);gi(i,e.memoizedState)||(ps=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function KC(){}function GC(t,e){var n=qn,r=Xs(),s=e(),i=!gi(r.memoizedState,s);if(i&&(r.memoizedState=s,ps=!0),r=r.queue,Gb(JC.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Ar!==null&&Ar.memoizedState.tag&1){if(n.flags|=2048,vf(9,YC.bind(null,n,r,s,e),void 0,null),Rr===null)throw Error(me(349));lc&30||QC(n,e,s)}return s}function QC(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=qn.updateQueue,e===null?(e={lastEffect:null,stores:null},qn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function YC(t,e,n,r){e.value=n,e.getSnapshot=r,XC(e)&&ZC(t)}function JC(t,e,n){return n(function(){XC(e)&&ZC(t)})}function XC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!gi(t,n)}catch{return!0}}function ZC(t){var e=ko(t,1);e!==null&&fi(e,t,1,-1)}function PT(t){var e=Di();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yf,lastRenderedState:t},e.queue=t,t=t.dispatch=F4.bind(null,qn,t),[e.memoizedState,t]}function vf(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=qn.updateQueue,e===null?(e={lastEffect:null,stores:null},qn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function eN(){return Xs().memoizedState}function Pp(t,e,n,r){var s=Di();qn.flags|=t,s.memoizedState=vf(1|e,n,void 0,r===void 0?null:r)}function Py(t,e,n,r){var s=Xs();r=r===void 0?null:r;var i=void 0;if(yr!==null){var o=yr.memoizedState;if(i=o.destroy,r!==null&&qb(r,o.deps)){s.memoizedState=vf(e,n,i,r);return}}qn.flags|=t,s.memoizedState=vf(1|e,n,i,r)}function RT(t,e){return Pp(8390656,8,t,e)}function Gb(t,e){return Py(2048,8,t,e)}function tN(t,e){return Py(4,2,t,e)}function nN(t,e){return Py(4,4,t,e)}function rN(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function sN(t,e,n){return n=n!=null?n.concat([t]):null,Py(4,4,rN.bind(null,e,t),n)}function Qb(){}function iN(t,e){var n=Xs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&qb(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function oN(t,e){var n=Xs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&qb(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function aN(t,e,n){return lc&21?(gi(n,e)||(n=hC(),qn.lanes|=n,cc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ps=!0),t.memoizedState=n)}function V4(t,e){var n=pn;pn=n!==0&&4>n?n:4,t(!0);var r=fw.transition;fw.transition={};try{t(!1),e()}finally{pn=n,fw.transition=r}}function lN(){return Xs().memoizedState}function j4(t,e,n){var r=Fa(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},cN(t))uN(e,n);else if(n=WC(t,e,n,r),n!==null){var s=is();fi(n,t,r,s),dN(n,e,r)}}function F4(t,e,n){var r=Fa(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(cN(t))uN(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,gi(a,o)){var l=e.interleaved;l===null?(s.next=s,Ub(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=WC(t,e,s,r),n!==null&&(s=is(),fi(n,t,r,s),dN(n,e,r))}}function cN(t){var e=t.alternate;return t===qn||e!==null&&e===qn}function uN(t,e){Lh=_g=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function dN(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,xb(t,n)}}var bg={readContext:Js,useCallback:qr,useContext:qr,useEffect:qr,useImperativeHandle:qr,useInsertionEffect:qr,useLayoutEffect:qr,useMemo:qr,useReducer:qr,useRef:qr,useState:qr,useDebugValue:qr,useDeferredValue:qr,useTransition:qr,useMutableSource:qr,useSyncExternalStore:qr,useId:qr,unstable_isNewReconciler:!1},U4={readContext:Js,useCallback:function(t,e){return Di().memoizedState=[t,e===void 0?null:e],t},useContext:Js,useEffect:RT,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Pp(4194308,4,rN.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Pp(4194308,4,t,e)},useInsertionEffect:function(t,e){return Pp(4,2,t,e)},useMemo:function(t,e){var n=Di();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Di();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=j4.bind(null,qn,t),[r.memoizedState,t]},useRef:function(t){var e=Di();return t={current:t},e.memoizedState=t},useState:PT,useDebugValue:Qb,useDeferredValue:function(t){return Di().memoizedState=t},useTransition:function(){var t=PT(!1),e=t[0];return t=V4.bind(null,t[1]),Di().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=qn,s=Di();if(Un){if(n===void 0)throw Error(me(407));n=n()}else{if(n=e(),Rr===null)throw Error(me(349));lc&30||QC(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,RT(JC.bind(null,r,i,t),[t]),r.flags|=2048,vf(9,YC.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Di(),e=Rr.identifierPrefix;if(Un){var n=_o,r=wo;n=(r&~(1<<32-hi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=gf++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=M4++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},$4={readContext:Js,useCallback:iN,useContext:Js,useEffect:Gb,useImperativeHandle:sN,useInsertionEffect:tN,useLayoutEffect:nN,useMemo:oN,useReducer:mw,useRef:eN,useState:function(){return mw(yf)},useDebugValue:Qb,useDeferredValue:function(t){var e=Xs();return aN(e,yr.memoizedState,t)},useTransition:function(){var t=mw(yf)[0],e=Xs().memoizedState;return[t,e]},useMutableSource:KC,useSyncExternalStore:GC,useId:lN,unstable_isNewReconciler:!1},B4={readContext:Js,useCallback:iN,useContext:Js,useEffect:Gb,useImperativeHandle:sN,useInsertionEffect:tN,useLayoutEffect:nN,useMemo:oN,useReducer:pw,useRef:eN,useState:function(){return pw(yf)},useDebugValue:Qb,useDeferredValue:function(t){var e=Xs();return yr===null?e.memoizedState=t:aN(e,yr.memoizedState,t)},useTransition:function(){var t=pw(yf)[0],e=Xs().memoizedState;return[t,e]},useMutableSource:KC,useSyncExternalStore:GC,useId:lN,unstable_isNewReconciler:!1};function ii(t,e){if(t&&t.defaultProps){e=Hn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function j_(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Hn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ry={isMounted:function(t){return(t=t._reactInternals)?xc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=is(),s=Fa(t),i=xo(r,s);i.payload=e,n!=null&&(i.callback=n),e=Va(t,i,s),e!==null&&(fi(e,t,s,r),xp(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=is(),s=Fa(t),i=xo(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Va(t,i,s),e!==null&&(fi(e,t,s,r),xp(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=is(),r=Fa(t),s=xo(n,r);s.tag=2,e!=null&&(s.callback=e),e=Va(t,s,r),e!==null&&(fi(e,t,r,n),xp(e,t,r))}};function CT(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!uf(n,r)||!uf(s,i):!0}function hN(t,e,n){var r=!1,s=Qa,i=e.contextType;return typeof i=="object"&&i!==null?i=Js(i):(s=bs(e)?oc:Zr.current,r=e.contextTypes,i=(r=r!=null)?Wu(t,s):Qa),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ry,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function NT(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ry.enqueueReplaceState(e,e.state,null)}function F_(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},$b(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Js(i):(i=bs(e)?oc:Zr.current,s.context=Wu(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(j_(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ry.enqueueReplaceState(s,s.state,null),vg(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Gu(t,e){try{var n="",r=e;do n+=gF(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function gw(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function U_(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var z4=typeof WeakMap=="function"?WeakMap:Map;function fN(t,e,n){n=xo(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Sg||(Sg=!0,Y_=r),U_(t,e)},n}function mN(t,e,n){n=xo(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){U_(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){U_(t,e),typeof r!="function"&&(ja===null?ja=new Set([this]):ja.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function kT(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new z4;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=rU.bind(null,t,e,n),e.then(t,t))}function DT(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function OT(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xo(-1,1),e.tag=2,Va(n,e,1))),n.lanes|=1),t)}var W4=Bo.ReactCurrentOwner,ps=!1;function ns(t,e,n,r){e.child=t===null?zC(e,null,n,r):Hu(e,t.child,n,r)}function LT(t,e,n,r,s){n=n.render;var i=e.ref;return Iu(e,s),r=Hb(t,e,n,r,i,s),n=Kb(),t!==null&&!ps?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Do(t,e,s)):(Un&&n&&Ob(e),e.flags|=1,ns(t,e,r,s),e.child)}function MT(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!rE(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,pN(t,e,i,r,s)):(t=kp(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:uf,n(o,r)&&t.ref===e.ref)return Do(t,e,s)}return e.flags|=1,t=Ua(i,r),t.ref=e.ref,t.return=e,e.child=t}function pN(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(uf(i,r)&&t.ref===e.ref)if(ps=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(ps=!0);else return e.lanes=t.lanes,Do(t,e,s)}return $_(t,e,n,r,s)}function gN(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tn(hu,Ps),Ps|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Tn(hu,Ps),Ps|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Tn(hu,Ps),Ps|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Tn(hu,Ps),Ps|=r;return ns(t,e,s,n),e.child}function yN(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function $_(t,e,n,r,s){var i=bs(n)?oc:Zr.current;return i=Wu(e,i),Iu(e,s),n=Hb(t,e,n,r,i,s),r=Kb(),t!==null&&!ps?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Do(t,e,s)):(Un&&r&&Ob(e),e.flags|=1,ns(t,e,n,s),e.child)}function VT(t,e,n,r,s){if(bs(n)){var i=!0;fg(e)}else i=!1;if(Iu(e,s),e.stateNode===null)Rp(t,e),hN(e,n,r),F_(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Js(c):(c=bs(n)?oc:Zr.current,c=Wu(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&NT(e,o,r,c),ua=!1;var m=e.memoizedState;o.state=m,vg(e,r,o,s),l=e.memoizedState,a!==r||m!==l||_s.current||ua?(typeof u=="function"&&(j_(e,n,u,r),l=e.memoizedState),(a=ua||CT(e,n,a,r,m,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,qC(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:ii(e.type,a),o.props=c,d=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Js(l):(l=bs(n)?oc:Zr.current,l=Wu(e,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||m!==l)&&NT(e,o,r,l),ua=!1,m=e.memoizedState,o.state=m,vg(e,r,o,s);var v=e.memoizedState;a!==d||m!==v||_s.current||ua?(typeof p=="function"&&(j_(e,n,p,r),v=e.memoizedState),(c=ua||CT(e,n,c,r,m,v,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),o.props=r,o.state=v,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return B_(t,e,n,r,i,s)}function B_(t,e,n,r,s,i){yN(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&ET(e,n,!1),Do(t,e,i);r=e.stateNode,W4.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Hu(e,t.child,null,i),e.child=Hu(e,null,a,i)):ns(t,e,a,i),e.memoizedState=r.state,s&&ET(e,n,!0),e.child}function vN(t){var e=t.stateNode;e.pendingContext?bT(t,e.pendingContext,e.pendingContext!==e.context):e.context&&bT(t,e.context,!1),Bb(t,e.containerInfo)}function jT(t,e,n,r,s){return qu(),Mb(s),e.flags|=256,ns(t,e,n,r),e.child}var z_={dehydrated:null,treeContext:null,retryLane:0};function W_(t){return{baseLanes:t,cachePool:null,transitions:null}}function wN(t,e,n){var r=e.pendingProps,s=zn.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Tn(zn,s&1),t===null)return M_(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=ky(o,r,0,null),t=ec(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=W_(n),e.memoizedState=z_,t):Yb(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return q4(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ua(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Ua(a,i):(i=ec(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?W_(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=z_,r}return i=t.child,t=i.sibling,r=Ua(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Yb(t,e){return e=ky({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function zm(t,e,n,r){return r!==null&&Mb(r),Hu(e,t.child,null,n),t=Yb(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function q4(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=gw(Error(me(422))),zm(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=ky({mode:"visible",children:r.children},s,0,null),i=ec(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Hu(e,t.child,null,o),e.child.memoizedState=W_(o),e.memoizedState=z_,i);if(!(e.mode&1))return zm(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(me(419)),r=gw(i,r,void 0),zm(t,e,o,r)}if(a=(o&t.childLanes)!==0,ps||a){if(r=Rr,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ko(t,s),fi(r,t,s,-1))}return nE(),r=gw(Error(me(421))),zm(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=sU.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,ks=Ma(s.nextSibling),Os=e,Un=!0,ui=null,t!==null&&(Ws[qs++]=wo,Ws[qs++]=_o,Ws[qs++]=ac,wo=t.id,_o=t.overflow,ac=e),e=Yb(e,r.children),e.flags|=4096,e)}function FT(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),V_(t.return,e,n)}function yw(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function _N(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(ns(t,e,r.children,n),r=zn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&FT(t,n,e);else if(t.tag===19)FT(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Tn(zn,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&wg(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),yw(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&wg(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}yw(e,!0,n,null,i);break;case"together":yw(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Rp(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Do(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),cc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(me(153));if(e.child!==null){for(t=e.child,n=Ua(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ua(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function H4(t,e,n){switch(e.tag){case 3:vN(e),qu();break;case 5:HC(e);break;case 1:bs(e.type)&&fg(e);break;case 4:Bb(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Tn(gg,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Tn(zn,zn.current&1),e.flags|=128,null):n&e.child.childLanes?wN(t,e,n):(Tn(zn,zn.current&1),t=Do(t,e,n),t!==null?t.sibling:null);Tn(zn,zn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return _N(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Tn(zn,zn.current),r)break;return null;case 22:case 23:return e.lanes=0,gN(t,e,n)}return Do(t,e,n)}var bN,q_,EN,SN;bN=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};q_=function(){};EN=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ql(Gi.current);var i=null;switch(n){case"input":s=f_(t,s),r=f_(t,r),i=[];break;case"select":s=Hn({},s,{value:void 0}),r=Hn({},r,{value:void 0}),i=[];break;case"textarea":s=g_(t,s),r=g_(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=dg)}v_(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(nf.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(nf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Nn("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};SN=function(t,e,n,r){n!==r&&(e.flags|=4)};function ah(t,e){if(!Un)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Hr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function K4(t,e,n){var r=e.pendingProps;switch(Lb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hr(e),null;case 1:return bs(e.type)&&hg(),Hr(e),null;case 3:return r=e.stateNode,Ku(),Ln(_s),Ln(Zr),Wb(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&($m(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ui!==null&&(Z_(ui),ui=null))),q_(t,e),Hr(e),null;case 5:zb(e);var s=ql(pf.current);if(n=e.type,t!==null&&e.stateNode!=null)EN(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(me(166));return Hr(e),null}if(t=ql(Gi.current),$m(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Ui]=e,r[ff]=i,t=(e.mode&1)!==0,n){case"dialog":Nn("cancel",r),Nn("close",r);break;case"iframe":case"object":case"embed":Nn("load",r);break;case"video":case"audio":for(s=0;s<_h.length;s++)Nn(_h[s],r);break;case"source":Nn("error",r);break;case"img":case"image":case"link":Nn("error",r),Nn("load",r);break;case"details":Nn("toggle",r);break;case"input":GI(r,i),Nn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Nn("invalid",r);break;case"textarea":YI(r,i),Nn("invalid",r)}v_(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Um(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Um(r.textContent,a,t),s=["children",""+a]):nf.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Nn("scroll",r)}switch(n){case"input":km(r),QI(r,i,!0);break;case"textarea":km(r),JI(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=dg)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=JR(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ui]=e,t[ff]=r,bN(t,e,!1,!1),e.stateNode=t;e:{switch(o=w_(n,r),n){case"dialog":Nn("cancel",t),Nn("close",t),s=r;break;case"iframe":case"object":case"embed":Nn("load",t),s=r;break;case"video":case"audio":for(s=0;s<_h.length;s++)Nn(_h[s],t);s=r;break;case"source":Nn("error",t),s=r;break;case"img":case"image":case"link":Nn("error",t),Nn("load",t),s=r;break;case"details":Nn("toggle",t),s=r;break;case"input":GI(t,r),s=f_(t,r),Nn("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Hn({},r,{value:void 0}),Nn("invalid",t);break;case"textarea":YI(t,r),s=g_(t,r),Nn("invalid",t);break;default:s=r}v_(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?eC(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&XR(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&rf(t,l):typeof l=="number"&&rf(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(nf.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Nn("scroll",t):l!=null&&_b(t,i,l,o))}switch(n){case"input":km(t),QI(t,r,!1);break;case"textarea":km(t),JI(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ga(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?_u(t,!!r.multiple,i,!1):r.defaultValue!=null&&_u(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=dg)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Hr(e),null;case 6:if(t&&e.stateNode!=null)SN(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(me(166));if(n=ql(pf.current),ql(Gi.current),$m(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ui]=e,(i=r.nodeValue!==n)&&(t=Os,t!==null))switch(t.tag){case 3:Um(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Um(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ui]=e,e.stateNode=r}return Hr(e),null;case 13:if(Ln(zn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Un&&ks!==null&&e.mode&1&&!(e.flags&128))$C(),qu(),e.flags|=98560,i=!1;else if(i=$m(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(me(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(me(317));i[Ui]=e}else qu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Hr(e),i=!1}else ui!==null&&(Z_(ui),ui=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||zn.current&1?wr===0&&(wr=3):nE())),e.updateQueue!==null&&(e.flags|=4),Hr(e),null);case 4:return Ku(),q_(t,e),t===null&&df(e.stateNode.containerInfo),Hr(e),null;case 10:return Fb(e.type._context),Hr(e),null;case 17:return bs(e.type)&&hg(),Hr(e),null;case 19:if(Ln(zn),i=e.memoizedState,i===null)return Hr(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ah(i,!1);else{if(wr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=wg(t),o!==null){for(e.flags|=128,ah(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Tn(zn,zn.current&1|2),e.child}t=t.sibling}i.tail!==null&&sr()>Qu&&(e.flags|=128,r=!0,ah(i,!1),e.lanes=4194304)}else{if(!r)if(t=wg(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ah(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Un)return Hr(e),null}else 2*sr()-i.renderingStartTime>Qu&&n!==1073741824&&(e.flags|=128,r=!0,ah(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=sr(),e.sibling=null,n=zn.current,Tn(zn,r?n&1|2:n&1),e):(Hr(e),null);case 22:case 23:return tE(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ps&1073741824&&(Hr(e),e.subtreeFlags&6&&(e.flags|=8192)):Hr(e),null;case 24:return null;case 25:return null}throw Error(me(156,e.tag))}function G4(t,e){switch(Lb(e),e.tag){case 1:return bs(e.type)&&hg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ku(),Ln(_s),Ln(Zr),Wb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return zb(e),null;case 13:if(Ln(zn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(me(340));qu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ln(zn),null;case 4:return Ku(),null;case 10:return Fb(e.type._context),null;case 22:case 23:return tE(),null;case 24:return null;default:return null}}var Wm=!1,Yr=!1,Q4=typeof WeakSet=="function"?WeakSet:Set,We=null;function du(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){er(t,e,r)}else n.current=null}function H_(t,e,n){try{n()}catch(r){er(t,e,r)}}var UT=!1;function Y4(t,e){if(R_=lg,t=PC(),Db(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,m=null;t:for(;;){for(var p;d!==n||s!==0&&d.nodeType!==3||(a=o+s),d!==i||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)m=d,d=p;for(;;){if(d===t)break t;if(m===n&&++c===s&&(a=o),m===i&&++u===r&&(l=o),(p=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(C_={focusedElem:t,selectionRange:n},lg=!1,We=e;We!==null;)if(e=We,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,We=t;else for(;We!==null;){e=We;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,E=v.memoizedState,b=e.stateNode,_=b.getSnapshotBeforeUpdate(e.elementType===e.type?g:ii(e.type,g),E);b.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(me(163))}}catch(P){er(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,We=t;break}We=e.return}return v=UT,UT=!1,v}function Mh(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&H_(e,n,i)}s=s.next}while(s!==r)}}function Cy(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function K_(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function IN(t){var e=t.alternate;e!==null&&(t.alternate=null,IN(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ui],delete e[ff],delete e[D_],delete e[k4],delete e[D4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function TN(t){return t.tag===5||t.tag===3||t.tag===4}function $T(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||TN(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function G_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=dg));else if(r!==4&&(t=t.child,t!==null))for(G_(t,e,n),t=t.sibling;t!==null;)G_(t,e,n),t=t.sibling}function Q_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Q_(t,e,n),t=t.sibling;t!==null;)Q_(t,e,n),t=t.sibling}var Mr=null,li=!1;function Jo(t,e,n){for(n=n.child;n!==null;)xN(t,e,n),n=n.sibling}function xN(t,e,n){if(Ki&&typeof Ki.onCommitFiberUnmount=="function")try{Ki.onCommitFiberUnmount(Ey,n)}catch{}switch(n.tag){case 5:Yr||du(n,e);case 6:var r=Mr,s=li;Mr=null,Jo(t,e,n),Mr=r,li=s,Mr!==null&&(li?(t=Mr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mr.removeChild(n.stateNode));break;case 18:Mr!==null&&(li?(t=Mr,n=n.stateNode,t.nodeType===8?uw(t.parentNode,n):t.nodeType===1&&uw(t,n),lf(t)):uw(Mr,n.stateNode));break;case 4:r=Mr,s=li,Mr=n.stateNode.containerInfo,li=!0,Jo(t,e,n),Mr=r,li=s;break;case 0:case 11:case 14:case 15:if(!Yr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&H_(n,e,o),s=s.next}while(s!==r)}Jo(t,e,n);break;case 1:if(!Yr&&(du(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){er(n,e,a)}Jo(t,e,n);break;case 21:Jo(t,e,n);break;case 22:n.mode&1?(Yr=(r=Yr)||n.memoizedState!==null,Jo(t,e,n),Yr=r):Jo(t,e,n);break;default:Jo(t,e,n)}}function BT(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Q4),e.forEach(function(r){var s=iU.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function ri(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Mr=a.stateNode,li=!1;break e;case 3:Mr=a.stateNode.containerInfo,li=!0;break e;case 4:Mr=a.stateNode.containerInfo,li=!0;break e}a=a.return}if(Mr===null)throw Error(me(160));xN(i,o,s),Mr=null,li=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){er(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)AN(e,t),e=e.sibling}function AN(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ri(e,t),Ni(t),r&4){try{Mh(3,t,t.return),Cy(3,t)}catch(g){er(t,t.return,g)}try{Mh(5,t,t.return)}catch(g){er(t,t.return,g)}}break;case 1:ri(e,t),Ni(t),r&512&&n!==null&&du(n,n.return);break;case 5:if(ri(e,t),Ni(t),r&512&&n!==null&&du(n,n.return),t.flags&32){var s=t.stateNode;try{rf(s,"")}catch(g){er(t,t.return,g)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&QR(s,i),w_(a,o);var c=w_(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?eC(s,d):u==="dangerouslySetInnerHTML"?XR(s,d):u==="children"?rf(s,d):_b(s,u,d,c)}switch(a){case"input":m_(s,i);break;case"textarea":YR(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?_u(s,!!i.multiple,p,!1):m!==!!i.multiple&&(i.defaultValue!=null?_u(s,!!i.multiple,i.defaultValue,!0):_u(s,!!i.multiple,i.multiple?[]:"",!1))}s[ff]=i}catch(g){er(t,t.return,g)}}break;case 6:if(ri(e,t),Ni(t),r&4){if(t.stateNode===null)throw Error(me(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){er(t,t.return,g)}}break;case 3:if(ri(e,t),Ni(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{lf(e.containerInfo)}catch(g){er(t,t.return,g)}break;case 4:ri(e,t),Ni(t);break;case 13:ri(e,t),Ni(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Zb=sr())),r&4&&BT(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Yr=(c=Yr)||u,ri(e,t),Yr=c):ri(e,t),Ni(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(We=t,u=t.child;u!==null;){for(d=We=u;We!==null;){switch(m=We,p=m.child,m.tag){case 0:case 11:case 14:case 15:Mh(4,m,m.return);break;case 1:du(m,m.return);var v=m.stateNode;if(typeof v.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(g){er(r,n,g)}}break;case 5:du(m,m.return);break;case 22:if(m.memoizedState!==null){WT(d);continue}}p!==null?(p.return=m,We=p):WT(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=ZR("display",o))}catch(g){er(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){er(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ri(e,t),Ni(t),r&4&&BT(t);break;case 21:break;default:ri(e,t),Ni(t)}}function Ni(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(TN(n)){var r=n;break e}n=n.return}throw Error(me(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(rf(s,""),r.flags&=-33);var i=$T(t);Q_(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=$T(t);G_(t,a,o);break;default:throw Error(me(161))}}catch(l){er(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function J4(t,e,n){We=t,PN(t)}function PN(t,e,n){for(var r=(t.mode&1)!==0;We!==null;){var s=We,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Wm;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Yr;a=Wm;var c=Yr;if(Wm=o,(Yr=l)&&!c)for(We=s;We!==null;)o=We,l=o.child,o.tag===22&&o.memoizedState!==null?qT(s):l!==null?(l.return=o,We=l):qT(s);for(;i!==null;)We=i,PN(i),i=i.sibling;We=s,Wm=a,Yr=c}zT(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,We=i):zT(t)}}function zT(t){for(;We!==null;){var e=We;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Yr||Cy(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Yr)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:ii(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&AT(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}AT(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&lf(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(me(163))}Yr||e.flags&512&&K_(e)}catch(m){er(e,e.return,m)}}if(e===t){We=null;break}if(n=e.sibling,n!==null){n.return=e.return,We=n;break}We=e.return}}function WT(t){for(;We!==null;){var e=We;if(e===t){We=null;break}var n=e.sibling;if(n!==null){n.return=e.return,We=n;break}We=e.return}}function qT(t){for(;We!==null;){var e=We;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Cy(4,e)}catch(l){er(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){er(e,s,l)}}var i=e.return;try{K_(e)}catch(l){er(e,i,l)}break;case 5:var o=e.return;try{K_(e)}catch(l){er(e,o,l)}}}catch(l){er(e,e.return,l)}if(e===t){We=null;break}var a=e.sibling;if(a!==null){a.return=e.return,We=a;break}We=e.return}}var X4=Math.ceil,Eg=Bo.ReactCurrentDispatcher,Jb=Bo.ReactCurrentOwner,Qs=Bo.ReactCurrentBatchConfig,en=0,Rr=null,dr=null,Ur=0,Ps=0,hu=ul(0),wr=0,wf=null,cc=0,Ny=0,Xb=0,Vh=null,hs=null,Zb=0,Qu=1/0,po=null,Sg=!1,Y_=null,ja=null,qm=!1,Aa=null,Ig=0,jh=0,J_=null,Cp=-1,Np=0;function is(){return en&6?sr():Cp!==-1?Cp:Cp=sr()}function Fa(t){return t.mode&1?en&2&&Ur!==0?Ur&-Ur:L4.transition!==null?(Np===0&&(Np=hC()),Np):(t=pn,t!==0||(t=window.event,t=t===void 0?16:wC(t.type)),t):1}function fi(t,e,n,r){if(50<jh)throw jh=0,J_=null,Error(me(185));Kf(t,n,r),(!(en&2)||t!==Rr)&&(t===Rr&&(!(en&2)&&(Ny|=n),wr===4&&fa(t,Ur)),Es(t,r),n===1&&en===0&&!(e.mode&1)&&(Qu=sr()+500,Ay&&dl()))}function Es(t,e){var n=t.callbackNode;LF(t,e);var r=ag(t,t===Rr?Ur:0);if(r===0)n!==null&&eT(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&eT(n),e===1)t.tag===0?O4(HT.bind(null,t)):jC(HT.bind(null,t)),C4(function(){!(en&6)&&dl()}),n=null;else{switch(fC(r)){case 1:n=Tb;break;case 4:n=uC;break;case 16:n=og;break;case 536870912:n=dC;break;default:n=og}n=MN(n,RN.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function RN(t,e){if(Cp=-1,Np=0,en&6)throw Error(me(327));var n=t.callbackNode;if(Tu()&&t.callbackNode!==n)return null;var r=ag(t,t===Rr?Ur:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Tg(t,r);else{e=r;var s=en;en|=2;var i=NN();(Rr!==t||Ur!==e)&&(po=null,Qu=sr()+500,Zl(t,e));do try{tU();break}catch(a){CN(t,a)}while(!0);jb(),Eg.current=i,en=s,dr!==null?e=0:(Rr=null,Ur=0,e=wr)}if(e!==0){if(e===2&&(s=I_(t),s!==0&&(r=s,e=X_(t,s))),e===1)throw n=wf,Zl(t,0),fa(t,r),Es(t,sr()),n;if(e===6)fa(t,r);else{if(s=t.current.alternate,!(r&30)&&!Z4(s)&&(e=Tg(t,r),e===2&&(i=I_(t),i!==0&&(r=i,e=X_(t,i))),e===1))throw n=wf,Zl(t,0),fa(t,r),Es(t,sr()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(me(345));case 2:Rl(t,hs,po);break;case 3:if(fa(t,r),(r&130023424)===r&&(e=Zb+500-sr(),10<e)){if(ag(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){is(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=k_(Rl.bind(null,t,hs,po),e);break}Rl(t,hs,po);break;case 4:if(fa(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-hi(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=sr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*X4(r/1960))-r,10<r){t.timeoutHandle=k_(Rl.bind(null,t,hs,po),r);break}Rl(t,hs,po);break;case 5:Rl(t,hs,po);break;default:throw Error(me(329))}}}return Es(t,sr()),t.callbackNode===n?RN.bind(null,t):null}function X_(t,e){var n=Vh;return t.current.memoizedState.isDehydrated&&(Zl(t,e).flags|=256),t=Tg(t,e),t!==2&&(e=hs,hs=n,e!==null&&Z_(e)),t}function Z_(t){hs===null?hs=t:hs.push.apply(hs,t)}function Z4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!gi(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fa(t,e){for(e&=~Xb,e&=~Ny,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-hi(e),r=1<<n;t[n]=-1,e&=~r}}function HT(t){if(en&6)throw Error(me(327));Tu();var e=ag(t,0);if(!(e&1))return Es(t,sr()),null;var n=Tg(t,e);if(t.tag!==0&&n===2){var r=I_(t);r!==0&&(e=r,n=X_(t,r))}if(n===1)throw n=wf,Zl(t,0),fa(t,e),Es(t,sr()),n;if(n===6)throw Error(me(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Rl(t,hs,po),Es(t,sr()),null}function eE(t,e){var n=en;en|=1;try{return t(e)}finally{en=n,en===0&&(Qu=sr()+500,Ay&&dl())}}function uc(t){Aa!==null&&Aa.tag===0&&!(en&6)&&Tu();var e=en;en|=1;var n=Qs.transition,r=pn;try{if(Qs.transition=null,pn=1,t)return t()}finally{pn=r,Qs.transition=n,en=e,!(en&6)&&dl()}}function tE(){Ps=hu.current,Ln(hu)}function Zl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,R4(n)),dr!==null)for(n=dr.return;n!==null;){var r=n;switch(Lb(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&hg();break;case 3:Ku(),Ln(_s),Ln(Zr),Wb();break;case 5:zb(r);break;case 4:Ku();break;case 13:Ln(zn);break;case 19:Ln(zn);break;case 10:Fb(r.type._context);break;case 22:case 23:tE()}n=n.return}if(Rr=t,dr=t=Ua(t.current,null),Ur=Ps=e,wr=0,wf=null,Xb=Ny=cc=0,hs=Vh=null,Wl!==null){for(e=0;e<Wl.length;e++)if(n=Wl[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Wl=null}return t}function CN(t,e){do{var n=dr;try{if(jb(),Ap.current=bg,_g){for(var r=qn.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}_g=!1}if(lc=0,Ar=yr=qn=null,Lh=!1,gf=0,Jb.current=null,n===null||n.return===null){wr=1,wf=e,dr=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Ur,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=DT(o);if(p!==null){p.flags&=-257,OT(p,o,a,i,e),p.mode&1&&kT(i,c,e),e=p,l=c;var v=e.updateQueue;if(v===null){var g=new Set;g.add(l),e.updateQueue=g}else v.add(l);break e}else{if(!(e&1)){kT(i,c,e),nE();break e}l=Error(me(426))}}else if(Un&&a.mode&1){var E=DT(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),OT(E,o,a,i,e),Mb(Gu(l,a));break e}}i=l=Gu(l,a),wr!==4&&(wr=2),Vh===null?Vh=[i]:Vh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=fN(i,l,e);xT(i,b);break e;case 1:a=l;var _=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ja===null||!ja.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=mN(i,a,e);xT(i,P);break e}}i=i.return}while(i!==null)}DN(n)}catch(T){e=T,dr===n&&n!==null&&(dr=n=n.return);continue}break}while(!0)}function NN(){var t=Eg.current;return Eg.current=bg,t===null?bg:t}function nE(){(wr===0||wr===3||wr===2)&&(wr=4),Rr===null||!(cc&268435455)&&!(Ny&268435455)||fa(Rr,Ur)}function Tg(t,e){var n=en;en|=2;var r=NN();(Rr!==t||Ur!==e)&&(po=null,Zl(t,e));do try{eU();break}catch(s){CN(t,s)}while(!0);if(jb(),en=n,Eg.current=r,dr!==null)throw Error(me(261));return Rr=null,Ur=0,wr}function eU(){for(;dr!==null;)kN(dr)}function tU(){for(;dr!==null&&!xF();)kN(dr)}function kN(t){var e=LN(t.alternate,t,Ps);t.memoizedProps=t.pendingProps,e===null?DN(t):dr=e,Jb.current=null}function DN(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=G4(n,e),n!==null){n.flags&=32767,dr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wr=6,dr=null;return}}else if(n=K4(n,e,Ps),n!==null){dr=n;return}if(e=e.sibling,e!==null){dr=e;return}dr=e=t}while(e!==null);wr===0&&(wr=5)}function Rl(t,e,n){var r=pn,s=Qs.transition;try{Qs.transition=null,pn=1,nU(t,e,n,r)}finally{Qs.transition=s,pn=r}return null}function nU(t,e,n,r){do Tu();while(Aa!==null);if(en&6)throw Error(me(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(me(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(MF(t,i),t===Rr&&(dr=Rr=null,Ur=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||qm||(qm=!0,MN(og,function(){return Tu(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Qs.transition,Qs.transition=null;var o=pn;pn=1;var a=en;en|=4,Jb.current=null,Y4(t,n),AN(n,t),E4(C_),lg=!!R_,C_=R_=null,t.current=n,J4(n),AF(),en=a,pn=o,Qs.transition=i}else t.current=n;if(qm&&(qm=!1,Aa=t,Ig=s),i=t.pendingLanes,i===0&&(ja=null),CF(n.stateNode),Es(t,sr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Sg)throw Sg=!1,t=Y_,Y_=null,t;return Ig&1&&t.tag!==0&&Tu(),i=t.pendingLanes,i&1?t===J_?jh++:(jh=0,J_=t):jh=0,dl(),null}function Tu(){if(Aa!==null){var t=fC(Ig),e=Qs.transition,n=pn;try{if(Qs.transition=null,pn=16>t?16:t,Aa===null)var r=!1;else{if(t=Aa,Aa=null,Ig=0,en&6)throw Error(me(331));var s=en;for(en|=4,We=t.current;We!==null;){var i=We,o=i.child;if(We.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(We=c;We!==null;){var u=We;switch(u.tag){case 0:case 11:case 15:Mh(8,u,i)}var d=u.child;if(d!==null)d.return=u,We=d;else for(;We!==null;){u=We;var m=u.sibling,p=u.return;if(IN(u),u===c){We=null;break}if(m!==null){m.return=p,We=m;break}We=p}}}var v=i.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var E=g.sibling;g.sibling=null,g=E}while(g!==null)}}We=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,We=o;else e:for(;We!==null;){if(i=We,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Mh(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,We=b;break e}We=i.return}}var _=t.current;for(We=_;We!==null;){o=We;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,We=S;else e:for(o=_;We!==null;){if(a=We,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Cy(9,a)}}catch(T){er(a,a.return,T)}if(a===o){We=null;break e}var P=a.sibling;if(P!==null){P.return=a.return,We=P;break e}We=a.return}}if(en=s,dl(),Ki&&typeof Ki.onPostCommitFiberRoot=="function")try{Ki.onPostCommitFiberRoot(Ey,t)}catch{}r=!0}return r}finally{pn=n,Qs.transition=e}}return!1}function KT(t,e,n){e=Gu(n,e),e=fN(t,e,1),t=Va(t,e,1),e=is(),t!==null&&(Kf(t,1,e),Es(t,e))}function er(t,e,n){if(t.tag===3)KT(t,t,n);else for(;e!==null;){if(e.tag===3){KT(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ja===null||!ja.has(r))){t=Gu(n,t),t=mN(e,t,1),e=Va(e,t,1),t=is(),e!==null&&(Kf(e,1,t),Es(e,t));break}}e=e.return}}function rU(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=is(),t.pingedLanes|=t.suspendedLanes&n,Rr===t&&(Ur&n)===n&&(wr===4||wr===3&&(Ur&130023424)===Ur&&500>sr()-Zb?Zl(t,0):Xb|=n),Es(t,e)}function ON(t,e){e===0&&(t.mode&1?(e=Lm,Lm<<=1,!(Lm&130023424)&&(Lm=4194304)):e=1);var n=is();t=ko(t,e),t!==null&&(Kf(t,e,n),Es(t,n))}function sU(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),ON(t,n)}function iU(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(me(314))}r!==null&&r.delete(e),ON(t,n)}var LN;LN=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||_s.current)ps=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ps=!1,H4(t,e,n);ps=!!(t.flags&131072)}else ps=!1,Un&&e.flags&1048576&&FC(e,pg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Rp(t,e),t=e.pendingProps;var s=Wu(e,Zr.current);Iu(e,n),s=Hb(null,e,r,t,s,n);var i=Kb();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,bs(r)?(i=!0,fg(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,$b(e),s.updater=Ry,e.stateNode=s,s._reactInternals=e,F_(e,r,t,n),e=B_(null,e,r,!0,i,n)):(e.tag=0,Un&&i&&Ob(e),ns(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Rp(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=aU(r),t=ii(r,t),s){case 0:e=$_(null,e,r,t,n);break e;case 1:e=VT(null,e,r,t,n);break e;case 11:e=LT(null,e,r,t,n);break e;case 14:e=MT(null,e,r,ii(r.type,t),n);break e}throw Error(me(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ii(r,s),$_(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ii(r,s),VT(t,e,r,s,n);case 3:e:{if(vN(e),t===null)throw Error(me(387));r=e.pendingProps,i=e.memoizedState,s=i.element,qC(t,e),vg(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Gu(Error(me(423)),e),e=jT(t,e,r,n,s);break e}else if(r!==s){s=Gu(Error(me(424)),e),e=jT(t,e,r,n,s);break e}else for(ks=Ma(e.stateNode.containerInfo.firstChild),Os=e,Un=!0,ui=null,n=zC(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(qu(),r===s){e=Do(t,e,n);break e}ns(t,e,r,n)}e=e.child}return e;case 5:return HC(e),t===null&&M_(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,N_(r,s)?o=null:i!==null&&N_(r,i)&&(e.flags|=32),yN(t,e),ns(t,e,o,n),e.child;case 6:return t===null&&M_(e),null;case 13:return wN(t,e,n);case 4:return Bb(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Hu(e,null,r,n):ns(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ii(r,s),LT(t,e,r,s,n);case 7:return ns(t,e,e.pendingProps,n),e.child;case 8:return ns(t,e,e.pendingProps.children,n),e.child;case 12:return ns(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Tn(gg,r._currentValue),r._currentValue=o,i!==null)if(gi(i.value,o)){if(i.children===s.children&&!_s.current){e=Do(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=xo(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),V_(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(me(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),V_(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ns(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Iu(e,n),s=Js(s),r=r(s),e.flags|=1,ns(t,e,r,n),e.child;case 14:return r=e.type,s=ii(r,e.pendingProps),s=ii(r.type,s),MT(t,e,r,s,n);case 15:return pN(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ii(r,s),Rp(t,e),e.tag=1,bs(r)?(t=!0,fg(e)):t=!1,Iu(e,n),hN(e,r,s),F_(e,r,s,n),B_(null,e,r,!0,t,n);case 19:return _N(t,e,n);case 22:return gN(t,e,n)}throw Error(me(156,e.tag))};function MN(t,e){return cC(t,e)}function oU(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ks(t,e,n,r){return new oU(t,e,n,r)}function rE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function aU(t){if(typeof t=="function")return rE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Eb)return 11;if(t===Sb)return 14}return 2}function Ua(t,e){var n=t.alternate;return n===null?(n=Ks(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function kp(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")rE(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case nu:return ec(n.children,s,i,e);case bb:o=8,s|=8;break;case c_:return t=Ks(12,n,e,s|2),t.elementType=c_,t.lanes=i,t;case u_:return t=Ks(13,n,e,s),t.elementType=u_,t.lanes=i,t;case d_:return t=Ks(19,n,e,s),t.elementType=d_,t.lanes=i,t;case HR:return ky(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case WR:o=10;break e;case qR:o=9;break e;case Eb:o=11;break e;case Sb:o=14;break e;case ca:o=16,r=null;break e}throw Error(me(130,t==null?t:typeof t,""))}return e=Ks(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ec(t,e,n,r){return t=Ks(7,t,r,e),t.lanes=n,t}function ky(t,e,n,r){return t=Ks(22,t,r,e),t.elementType=HR,t.lanes=n,t.stateNode={isHidden:!1},t}function vw(t,e,n){return t=Ks(6,t,null,e),t.lanes=n,t}function ww(t,e,n){return e=Ks(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function lU(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zv(0),this.expirationTimes=Zv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zv(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function sE(t,e,n,r,s,i,o,a,l){return t=new lU(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ks(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$b(i),t}function cU(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:tu,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function VN(t){if(!t)return Qa;t=t._reactInternals;e:{if(xc(t)!==t||t.tag!==1)throw Error(me(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(bs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(me(171))}if(t.tag===1){var n=t.type;if(bs(n))return VC(t,n,e)}return e}function jN(t,e,n,r,s,i,o,a,l){return t=sE(n,r,!0,t,s,i,o,a,l),t.context=VN(null),n=t.current,r=is(),s=Fa(n),i=xo(r,s),i.callback=e??null,Va(n,i,s),t.current.lanes=s,Kf(t,s,r),Es(t,r),t}function Dy(t,e,n,r){var s=e.current,i=is(),o=Fa(s);return n=VN(n),e.context===null?e.context=n:e.pendingContext=n,e=xo(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Va(s,e,o),t!==null&&(fi(t,s,o,i),xp(t,s,o)),o}function xg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function GT(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function iE(t,e){GT(t,e),(t=t.alternate)&&GT(t,e)}function uU(){return null}var FN=typeof reportError=="function"?reportError:function(t){console.error(t)};function oE(t){this._internalRoot=t}Oy.prototype.render=oE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(me(409));Dy(t,e,null,null)};Oy.prototype.unmount=oE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;uc(function(){Dy(null,t,null,null)}),e[No]=null}};function Oy(t){this._internalRoot=t}Oy.prototype.unstable_scheduleHydration=function(t){if(t){var e=gC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ha.length&&e!==0&&e<ha[n].priority;n++);ha.splice(n,0,t),n===0&&vC(t)}};function aE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ly(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function QT(){}function dU(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=xg(o);i.call(c)}}var o=jN(e,r,t,0,null,!1,!1,"",QT);return t._reactRootContainer=o,t[No]=o.current,df(t.nodeType===8?t.parentNode:t),uc(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=xg(l);a.call(c)}}var l=sE(t,0,!1,null,null,!1,!1,"",QT);return t._reactRootContainer=l,t[No]=l.current,df(t.nodeType===8?t.parentNode:t),uc(function(){Dy(e,l,n,r)}),l}function My(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=xg(o);a.call(l)}}Dy(e,o,t,s)}else o=dU(n,e,t,s,r);return xg(o)}mC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=wh(e.pendingLanes);n!==0&&(xb(e,n|1),Es(e,sr()),!(en&6)&&(Qu=sr()+500,dl()))}break;case 13:uc(function(){var r=ko(t,1);if(r!==null){var s=is();fi(r,t,1,s)}}),iE(t,1)}};Ab=function(t){if(t.tag===13){var e=ko(t,134217728);if(e!==null){var n=is();fi(e,t,134217728,n)}iE(t,134217728)}};pC=function(t){if(t.tag===13){var e=Fa(t),n=ko(t,e);if(n!==null){var r=is();fi(n,t,e,r)}iE(t,e)}};gC=function(){return pn};yC=function(t,e){var n=pn;try{return pn=t,e()}finally{pn=n}};b_=function(t,e,n){switch(e){case"input":if(m_(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=xy(r);if(!s)throw Error(me(90));GR(r),m_(r,s)}}}break;case"textarea":YR(t,n);break;case"select":e=n.value,e!=null&&_u(t,!!n.multiple,e,!1)}};rC=eE;sC=uc;var hU={usingClientEntryPoint:!1,Events:[Qf,ou,xy,tC,nC,eE]},lh={findFiberByHostInstance:zl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fU={bundleType:lh.bundleType,version:lh.version,rendererPackageName:lh.rendererPackageName,rendererConfig:lh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Bo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=aC(t),t===null?null:t.stateNode},findFiberByHostInstance:lh.findFiberByHostInstance||uU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hm.isDisabled&&Hm.supportsFiber)try{Ey=Hm.inject(fU),Ki=Hm}catch{}}$s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hU;$s.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!aE(e))throw Error(me(200));return cU(t,e,null,n)};$s.createRoot=function(t,e){if(!aE(t))throw Error(me(299));var n=!1,r="",s=FN;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=sE(t,1,!1,null,null,n,!1,r,s),t[No]=e.current,df(t.nodeType===8?t.parentNode:t),new oE(e)};$s.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(me(188)):(t=Object.keys(t).join(","),Error(me(268,t)));return t=aC(e),t=t===null?null:t.stateNode,t};$s.flushSync=function(t){return uc(t)};$s.hydrate=function(t,e,n){if(!Ly(e))throw Error(me(200));return My(null,t,e,!0,n)};$s.hydrateRoot=function(t,e,n){if(!aE(t))throw Error(me(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=FN;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=jN(e,null,t,1,n??null,s,!1,i,o),t[No]=e.current,df(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Oy(e)};$s.render=function(t,e,n){if(!Ly(e))throw Error(me(200));return My(null,t,e,!1,n)};$s.unmountComponentAtNode=function(t){if(!Ly(t))throw Error(me(40));return t._reactRootContainer?(uc(function(){My(null,null,t,!1,function(){t._reactRootContainer=null,t[No]=null})}),!0):!1};$s.unstable_batchedUpdates=eE;$s.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ly(n))throw Error(me(200));if(t==null||t._reactInternals===void 0)throw Error(me(38));return My(t,e,n,!1,r)};$s.version="18.3.1-next-f1338f8080-20240426";function UN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(UN)}catch(t){console.error(t)}}UN(),UR.exports=$s;var Jf=UR.exports;const $N=PR(Jf);var BN,YT=Jf;BN=YT.createRoot,YT.hydrateRoot;const mU="modulepreload",pU=function(t,e){return new URL(t,e).href},JT={},ee=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=pU(c,r),c in JT)return;JT[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(!!r)for(let v=o.length-1;v>=0;v--){const g=o[v];if(g.href===c&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${d}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":mU,u||(p.as="script"),p.crossOrigin="",p.href=c,l&&p.setAttribute("nonce",l),document.head.appendChild(p),u)return new Promise((v,g)=>{p.addEventListener("load",v),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},gU=1,yU=1e6;let _w=0;function vU(){return _w=(_w+1)%Number.MAX_SAFE_INTEGER,_w.toString()}const bw=new Map,XT=t=>{if(bw.has(t))return;const e=setTimeout(()=>{bw.delete(t),Fh({type:"REMOVE_TOAST",toastId:t})},yU);bw.set(t,e)},wU=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,gU)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?XT(n):t.toasts.forEach(r=>{XT(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},Dp=[];let Op={toasts:[]};function Fh(t){Op=wU(Op,t),Dp.forEach(e=>{e(Op)})}function _U({...t}){const e=vU(),n=s=>Fh({type:"UPDATE_TOAST",toast:{...s,id:e}}),r=()=>Fh({type:"DISMISS_TOAST",toastId:e});return Fh({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:s=>{s||r()}}}),{id:e,dismiss:r,update:n}}function hl(){const[t,e]=y.useState(Op);return y.useEffect(()=>(Dp.push(e),()=>{const n=Dp.indexOf(e);n>-1&&Dp.splice(n,1)}),[t]),{...t,toast:_U,dismiss:n=>Fh({type:"DISMISS_TOAST",toastId:n})}}function Zt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function ZT(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Xf(...t){return e=>{let n=!1;const r=t.map(s=>{const i=ZT(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():ZT(t[s],null)}}}}function Kn(...t){return y.useCallback(Xf(...t),t)}function bU(t,e){const n=y.createContext(e),r=i=>{const{children:o,...a}=i,l=y.useMemo(()=>a,Object.values(a));return f.jsx(n.Provider,{value:l,children:o})};r.displayName=t+"Provider";function s(i){const o=y.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,s]}function Ac(t,e=[]){let n=[];function r(i,o){const a=y.createContext(o),l=n.length;n=[...n,o];const c=d=>{var b;const{scope:m,children:p,...v}=d,g=((b=m==null?void 0:m[t])==null?void 0:b[l])||a,E=y.useMemo(()=>v,Object.values(v));return f.jsx(g.Provider,{value:E,children:p})};c.displayName=i+"Provider";function u(d,m){var g;const p=((g=m==null?void 0:m[t])==null?void 0:g[l])||a,v=y.useContext(p);if(v)return v;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(o=>y.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return y.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,EU(s,...e)]}function EU(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...a,...d}},{});return y.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function ex(t){const e=SU(t),n=y.forwardRef((r,s)=>{const{children:i,...o}=r,a=y.Children.toArray(i),l=a.find(TU);if(l){const c=l.props.children,u=a.map(d=>d===l?y.Children.count(c)>1?y.Children.only(null):y.isValidElement(c)?c.props.children:null:d);return f.jsx(e,{...o,ref:s,children:y.isValidElement(c)?y.cloneElement(c,void 0,u):null})}return f.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}function SU(t){const e=y.forwardRef((n,r)=>{const{children:s,...i}=n;if(y.isValidElement(s)){const o=AU(s),a=xU(i,s.props);return s.type!==y.Fragment&&(a.ref=r?Xf(r,o):o),y.cloneElement(s,a)}return y.Children.count(s)>1?y.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var IU=Symbol("radix.slottable");function TU(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===IU}function xU(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function AU(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function PU(t){const e=t+"CollectionProvider",[n,r]=Ac(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:E,children:b}=g,_=M.useRef(null),S=M.useRef(new Map).current;return f.jsx(s,{scope:E,itemMap:S,collectionRef:_,children:b})};o.displayName=e;const a=t+"CollectionSlot",l=ex(a),c=M.forwardRef((g,E)=>{const{scope:b,children:_}=g,S=i(a,b),P=Kn(E,S.collectionRef);return f.jsx(l,{ref:P,children:_})});c.displayName=a;const u=t+"CollectionItemSlot",d="data-radix-collection-item",m=ex(u),p=M.forwardRef((g,E)=>{const{scope:b,children:_,...S}=g,P=M.useRef(null),T=Kn(E,P),N=i(u,b);return M.useEffect(()=>(N.itemMap.set(P,{ref:P,...S}),()=>void N.itemMap.delete(P))),f.jsx(m,{[d]:"",ref:T,children:_})});p.displayName=u;function v(g){const E=i(t+"CollectionConsumer",g);return M.useCallback(()=>{const _=E.collectionRef.current;if(!_)return[];const S=Array.from(_.querySelectorAll(`[${d}]`));return Array.from(E.itemMap.values()).sort((N,I)=>S.indexOf(N.ref.current)-S.indexOf(I.ref.current))},[E.collectionRef,E.itemMap])}return[{Provider:o,Slot:c,ItemSlot:p},v,r]}function RU(t){const e=CU(t),n=y.forwardRef((r,s)=>{const{children:i,...o}=r,a=y.Children.toArray(i),l=a.find(kU);if(l){const c=l.props.children,u=a.map(d=>d===l?y.Children.count(c)>1?y.Children.only(null):y.isValidElement(c)?c.props.children:null:d);return f.jsx(e,{...o,ref:s,children:y.isValidElement(c)?y.cloneElement(c,void 0,u):null})}return f.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}function CU(t){const e=y.forwardRef((n,r)=>{const{children:s,...i}=n;if(y.isValidElement(s)){const o=OU(s),a=DU(i,s.props);return s.type!==y.Fragment&&(a.ref=r?Xf(r,o):o),y.cloneElement(s,a)}return y.Children.count(s)>1?y.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var NU=Symbol("radix.slottable");function kU(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===NU}function DU(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function OU(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var LU=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],wn=LU.reduce((t,e)=>{const n=RU(`Primitive.${e}`),r=y.forwardRef((s,i)=>{const{asChild:o,...a}=s,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...a,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function zN(t,e){t&&Jf.flushSync(()=>t.dispatchEvent(e))}function jr(t){const e=y.useRef(t);return y.useEffect(()=>{e.current=t}),y.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function MU(t,e=globalThis==null?void 0:globalThis.document){const n=jr(t);y.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var VU="DismissableLayer",e0="dismissableLayer.update",jU="dismissableLayer.pointerDownOutside",FU="dismissableLayer.focusOutside",tx,WN=y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Vy=y.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=y.useContext(WN),[u,d]=y.useState(null),m=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=y.useState({}),v=Kn(e,I=>d(I)),g=Array.from(c.layers),[E]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),b=g.indexOf(E),_=u?g.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,P=_>=b,T=$U(I=>{const A=I.target,R=[...c.branches].some(k=>k.contains(A));!P||R||(s==null||s(I),o==null||o(I),I.defaultPrevented||a==null||a())},m),N=BU(I=>{const A=I.target;[...c.branches].some(k=>k.contains(A))||(i==null||i(I),o==null||o(I),I.defaultPrevented||a==null||a())},m);return MU(I=>{_===c.layers.size-1&&(r==null||r(I),!I.defaultPrevented&&a&&(I.preventDefault(),a()))},m),y.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(tx=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),nx(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=tx)}},[u,m,n,c]),y.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),nx())},[u,c]),y.useEffect(()=>{const I=()=>p({});return document.addEventListener(e0,I),()=>document.removeEventListener(e0,I)},[]),f.jsx(wn.div,{...l,ref:v,style:{pointerEvents:S?P?"auto":"none":void 0,...t.style},onFocusCapture:Zt(t.onFocusCapture,N.onFocusCapture),onBlurCapture:Zt(t.onBlurCapture,N.onBlurCapture),onPointerDownCapture:Zt(t.onPointerDownCapture,T.onPointerDownCapture)})});Vy.displayName=VU;var UU="DismissableLayerBranch",qN=y.forwardRef((t,e)=>{const n=y.useContext(WN),r=y.useRef(null),s=Kn(e,r);return y.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(wn.div,{...t,ref:s})});qN.displayName=UU;function $U(t,e=globalThis==null?void 0:globalThis.document){const n=jr(t),r=y.useRef(!1),s=y.useRef(()=>{});return y.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){HN(jU,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function BU(t,e=globalThis==null?void 0:globalThis.document){const n=jr(t),r=y.useRef(!1);return y.useEffect(()=>{const s=i=>{i.target&&!r.current&&HN(FU,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function nx(){const t=new CustomEvent(e0);document.dispatchEvent(t)}function HN(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?zN(s,i):s.dispatchEvent(i)}var zU=Vy,WU=qN,eo=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},qU="Portal",lE=y.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[s,i]=y.useState(!1);eo(()=>i(!0),[]);const o=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?$N.createPortal(f.jsx(wn.div,{...r,ref:e}),o):null});lE.displayName=qU;function HU(t,e){return y.useReducer((n,r)=>e[n][r]??n,t)}var Si=t=>{const{present:e,children:n}=t,r=KU(e),s=typeof n=="function"?n({present:r.isPresent}):y.Children.only(n),i=Kn(r.ref,GU(s));return typeof n=="function"||r.isPresent?y.cloneElement(s,{ref:i}):null};Si.displayName="Presence";function KU(t){const[e,n]=y.useState(),r=y.useRef(null),s=y.useRef(t),i=y.useRef("none"),o=t?"mounted":"unmounted",[a,l]=HU(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const c=Km(r.current);i.current=a==="mounted"?c:"none"},[a]),eo(()=>{const c=r.current,u=s.current;if(u!==t){const m=i.current,p=Km(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&m!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),eo(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=p=>{const g=Km(r.current).includes(CSS.escape(p.animationName));if(p.target===e&&g&&(l("ANIMATION_END"),!s.current)){const E=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=E)})}},m=p=>{p.target===e&&(i.current=Km(r.current))};return e.addEventListener("animationstart",m),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",m),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:y.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function Km(t){return(t==null?void 0:t.animationName)||"none"}function GU(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var QU=by[" useInsertionEffect ".trim().toString()]||eo;function cE({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,o]=YU({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:s;{const u=y.useRef(t!==void 0);y.useEffect(()=>{const d=u.current;d!==a&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,r])}const c=y.useCallback(u=>{var d;if(a){const m=JU(u)?u(t):u;m!==t&&((d=o.current)==null||d.call(o,m))}else i(u)},[a,t,i,o]);return[l,c]}function YU({defaultProp:t,onChange:e}){const[n,r]=y.useState(t),s=y.useRef(n),i=y.useRef(e);return QU(()=>{i.current=e},[e]),y.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function JU(t){return typeof t=="function"}var XU=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),ZU="VisuallyHidden",jy=y.forwardRef((t,e)=>f.jsx(wn.span,{...t,ref:e,style:{...XU,...t.style}}));jy.displayName=ZU;var e3=jy,uE="ToastProvider",[dE,t3,n3]=PU("Toast"),[KN]=Ac("Toast",[n3]),[r3,Fy]=KN(uE),GN=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[a,l]=y.useState(null),[c,u]=y.useState(0),d=y.useRef(!1),m=y.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${uE}\`. Expected non-empty \`string\`.`),f.jsx(dE.Provider,{scope:e,children:f.jsx(r3,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:y.useCallback(()=>u(p=>p+1),[]),onToastRemove:y.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:m,children:o})})};GN.displayName=uE;var QN="ToastViewport",s3=["F8"],t0="toast.viewportPause",n0="toast.viewportResume",YN=y.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=s3,label:s="Notifications ({hotkey})",...i}=t,o=Fy(QN,n),a=t3(n),l=y.useRef(null),c=y.useRef(null),u=y.useRef(null),d=y.useRef(null),m=Kn(e,d,o.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=o.toastCount>0;y.useEffect(()=>{const E=b=>{var S;r.length!==0&&r.every(P=>b[P]||b.code===P)&&((S=d.current)==null||S.focus())};return document.addEventListener("keydown",E),()=>document.removeEventListener("keydown",E)},[r]),y.useEffect(()=>{const E=l.current,b=d.current;if(v&&E&&b){const _=()=>{if(!o.isClosePausedRef.current){const N=new CustomEvent(t0);b.dispatchEvent(N),o.isClosePausedRef.current=!0}},S=()=>{if(o.isClosePausedRef.current){const N=new CustomEvent(n0);b.dispatchEvent(N),o.isClosePausedRef.current=!1}},P=N=>{!E.contains(N.relatedTarget)&&S()},T=()=>{E.contains(document.activeElement)||S()};return E.addEventListener("focusin",_),E.addEventListener("focusout",P),E.addEventListener("pointermove",_),E.addEventListener("pointerleave",T),window.addEventListener("blur",_),window.addEventListener("focus",S),()=>{E.removeEventListener("focusin",_),E.removeEventListener("focusout",P),E.removeEventListener("pointermove",_),E.removeEventListener("pointerleave",T),window.removeEventListener("blur",_),window.removeEventListener("focus",S)}}},[v,o.isClosePausedRef]);const g=y.useCallback(({tabbingDirection:E})=>{const _=a().map(S=>{const P=S.ref.current,T=[P,...y3(P)];return E==="forwards"?T:T.reverse()});return(E==="forwards"?_.reverse():_).flat()},[a]);return y.useEffect(()=>{const E=d.current;if(E){const b=_=>{var T,N,I;const S=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!S){const A=document.activeElement,R=_.shiftKey;if(_.target===E&&R){(T=c.current)==null||T.focus();return}const L=g({tabbingDirection:R?"backwards":"forwards"}),O=L.findIndex(X=>X===A);Ew(L.slice(O+1))?_.preventDefault():R?(N=c.current)==null||N.focus():(I=u.current)==null||I.focus()}};return E.addEventListener("keydown",b),()=>E.removeEventListener("keydown",b)}},[a,g]),f.jsxs(WU,{ref:l,role:"region","aria-label":s.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&f.jsx(r0,{ref:c,onFocusFromOutsideViewport:()=>{const E=g({tabbingDirection:"forwards"});Ew(E)}}),f.jsx(dE.Slot,{scope:n,children:f.jsx(wn.ol,{tabIndex:-1,...i,ref:m})}),v&&f.jsx(r0,{ref:u,onFocusFromOutsideViewport:()=>{const E=g({tabbingDirection:"backwards"});Ew(E)}})]})});YN.displayName=QN;var JN="ToastFocusProxy",r0=y.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=Fy(JN,n);return f.jsx(jy,{tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=i.viewport)!=null&&c.contains(a))&&r()}})});r0.displayName=JN;var Zf="Toast",i3="toast.swipeStart",o3="toast.swipeMove",a3="toast.swipeCancel",l3="toast.swipeEnd",XN=y.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[a,l]=cE({prop:r,defaultProp:s??!0,onChange:i,caller:Zf});return f.jsx(Si,{present:n||a,children:f.jsx(d3,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:jr(t.onPause),onResume:jr(t.onResume),onSwipeStart:Zt(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Zt(t.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:Zt(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Zt(t.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});XN.displayName=Zf;var[c3,u3]=KN(Zf,{onClose(){}}),d3=y.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:m,onSwipeEnd:p,...v}=t,g=Fy(Zf,n),[E,b]=y.useState(null),_=Kn(e,X=>b(X)),S=y.useRef(null),P=y.useRef(null),T=s||g.duration,N=y.useRef(0),I=y.useRef(T),A=y.useRef(0),{onToastAdd:R,onToastRemove:k}=g,C=jr(()=>{var ke;(E==null?void 0:E.contains(document.activeElement))&&((ke=g.viewport)==null||ke.focus()),o()}),L=y.useCallback(X=>{!X||X===1/0||(window.clearTimeout(A.current),N.current=new Date().getTime(),A.current=window.setTimeout(C,X))},[C]);y.useEffect(()=>{const X=g.viewport;if(X){const ke=()=>{L(I.current),c==null||c()},Oe=()=>{const je=new Date().getTime()-N.current;I.current=I.current-je,window.clearTimeout(A.current),l==null||l()};return X.addEventListener(t0,Oe),X.addEventListener(n0,ke),()=>{X.removeEventListener(t0,Oe),X.removeEventListener(n0,ke)}}},[g.viewport,T,l,c,L]),y.useEffect(()=>{i&&!g.isClosePausedRef.current&&L(T)},[i,T,g.isClosePausedRef,L]),y.useEffect(()=>(R(),()=>k()),[R,k]);const O=y.useMemo(()=>E?ik(E):null,[E]);return g.viewport?f.jsxs(f.Fragment,{children:[O&&f.jsx(h3,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite",children:O}),f.jsx(c3,{scope:n,onClose:C,children:Jf.createPortal(f.jsx(dE.ItemSlot,{scope:n,children:f.jsx(zU,{asChild:!0,onEscapeKeyDown:Zt(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||C(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:f.jsx(wn.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection,...v,ref:_,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Zt(t.onKeyDown,X=>{X.key==="Escape"&&(a==null||a(X.nativeEvent),X.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,C()))}),onPointerDown:Zt(t.onPointerDown,X=>{X.button===0&&(S.current={x:X.clientX,y:X.clientY})}),onPointerMove:Zt(t.onPointerMove,X=>{if(!S.current)return;const ke=X.clientX-S.current.x,Oe=X.clientY-S.current.y,je=!!P.current,W=["left","right"].includes(g.swipeDirection),G=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,ae=W?G(0,ke):0,pe=W?0:G(0,Oe),fe=X.pointerType==="touch"?10:2,Ge={x:ae,y:pe},xe={originalEvent:X,delta:Ge};je?(P.current=Ge,Gm(o3,d,xe,{discrete:!1})):rx(Ge,g.swipeDirection,fe)?(P.current=Ge,Gm(i3,u,xe,{discrete:!1}),X.target.setPointerCapture(X.pointerId)):(Math.abs(ke)>fe||Math.abs(Oe)>fe)&&(S.current=null)}),onPointerUp:Zt(t.onPointerUp,X=>{const ke=P.current,Oe=X.target;if(Oe.hasPointerCapture(X.pointerId)&&Oe.releasePointerCapture(X.pointerId),P.current=null,S.current=null,ke){const je=X.currentTarget,W={originalEvent:X,delta:ke};rx(ke,g.swipeDirection,g.swipeThreshold)?Gm(l3,p,W,{discrete:!0}):Gm(a3,m,W,{discrete:!0}),je.addEventListener("click",G=>G.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),h3=t=>{const{__scopeToast:e,children:n,...r}=t,s=Fy(Zf,e),[i,o]=y.useState(!1),[a,l]=y.useState(!1);return p3(()=>o(!0)),y.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:f.jsx(lE,{asChild:!0,children:f.jsx(jy,{...r,children:i&&f.jsxs(f.Fragment,{children:[s.label," ",n]})})})},f3="ToastTitle",ZN=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return f.jsx(wn.div,{...r,ref:e})});ZN.displayName=f3;var m3="ToastDescription",ek=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return f.jsx(wn.div,{...r,ref:e})});ek.displayName=m3;var tk="ToastAction",nk=y.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?f.jsx(sk,{altText:n,asChild:!0,children:f.jsx(hE,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${tk}\`. Expected non-empty \`string\`.`),null)});nk.displayName=tk;var rk="ToastClose",hE=y.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=u3(rk,n);return f.jsx(sk,{asChild:!0,children:f.jsx(wn.button,{type:"button",...r,ref:e,onClick:Zt(t.onClick,s.onClose)})})});hE.displayName=rk;var sk=y.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return f.jsx(wn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function ik(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),g3(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...ik(r))}}),e}function Gm(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?zN(s,i):s.dispatchEvent(i)}var rx=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function p3(t=()=>{}){const e=jr(t);eo(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function g3(t){return t.nodeType===t.ELEMENT_NODE}function y3(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Ew(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var v3=GN,ok=YN,ak=XN,lk=ZN,ck=ek,uk=nk,dk=hE;function hk(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=hk(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function fk(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=hk(t))&&(r&&(r+=" "),r+=e);return r}const sx=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,ix=fk,Uy=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return ix(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],d=i==null?void 0:i[c];if(u===null)return null;const m=sx(u)||sx(d);return s[c][m]}),a=n&&Object.entries(n).reduce((c,u)=>{let[d,m]=u;return m===void 0||(c[d]=m),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:m,...p}=u;return Object.entries(p).every(v=>{let[g,E]=v;return Array.isArray(E)?E.includes({...i,...a}[g]):{...i,...a}[g]===E})?[...c,d,m]:c},[]);return ix(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_3=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),ox=t=>{const e=_3(t);return e.charAt(0).toUpperCase()+e.slice(1)},mk=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),b3=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var E3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=y.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},l)=>y.createElement("svg",{ref:l,...E3,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:mk("lucide",s),...!i&&!b3(a)&&{"aria-hidden":"true"},...a},[...o.map(([c,u])=>y.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=(t,e)=>{const n=y.forwardRef(({className:r,...s},i)=>y.createElement(S3,{ref:i,iconNode:e,className:mk(`lucide-${w3(ox(t))}`,`lucide-${t}`,r),...s}));return n.displayName=ox(t),n};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],T3=Ot("arrow-down",I3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],pk=Ot("arrow-right",x3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],P3=Ot("arrow-up-down",A3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"M9 9h.01",key:"1q5me6"}],["path",{d:"M15 15h.01",key:"lqbp3k"}]],C3=Ot("badge-percent",R3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],gk=Ot("check",N3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],D3=Ot("circle-alert",k3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],L3=Ot("circle-check",O3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ax=Ot("clock",M3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],j3=Ot("credit-card",V3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Uh=Ot("eye-off",F3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$h=Ot("eye",U3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],B3=Ot("file-text",$3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],W3=Ot("house",z3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],H3=Ot("image",q3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],G3=Ot("landmark",K3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],fE=Ot("loader-circle",Q3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y3=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],$y=Ot("lock",Y3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],s0=Ot("log-out",J3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],i0=Ot("mail",X3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Yc=Ot("message-circle",Z3);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e5=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],t5=Ot("message-square",e5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=[["path",{d:"M5 12h14",key:"1ays0h"}]],r5=Ot("minus",n5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s5=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],i5=Ot("phone",s5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o5=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],lx=Ot("plus",o5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a5=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],cx=Ot("receipt",a5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],mE=Ot("refresh-ccw",l5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],u5=Ot("refresh-cw",c5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d5=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],h5=Ot("send",d5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f5=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ux=Ot("settings",f5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m5=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],pE=Ot("shield",m5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p5=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],yk=Ot("smartphone",p5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g5=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],y5=Ot("square",g5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v5=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],w5=Ot("store",v5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _5=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],vk=Ot("trash-2",_5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b5=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],E5=Ot("trending-up",b5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S5=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],wk=Ot("triangle-alert",S5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I5=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],T5=Ot("user",I5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x5=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],A5=Ot("wrench",x5);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P5=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],$i=Ot("x",P5),gE="-",R5=t=>{const e=N5(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const a=o.split(gE);return a[0]===""&&a.length!==1&&a.shift(),_k(a,e)||C5(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&r[o]?[...l,...r[o]]:l}}},_k=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),s=r?_k(t.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=t.join(gE);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},dx=/^\[(.+)\]$/,C5=t=>{if(dx.test(t)){const e=dx.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},N5=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return D5(Object.entries(t.classGroups),n).forEach(([i,o])=>{o0(o,r,i,e)}),r},o0=(t,e,n,r)=>{t.forEach(s=>{if(typeof s=="string"){const i=s===""?e:hx(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(k5(s)){o0(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,o])=>{o0(o,hx(e,i),n,r)})})},hx=(t,e)=>{let n=t;return e.split(gE).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},k5=t=>t.isThemeGetter,D5=(t,e)=>e?t.map(([n,r])=>{const s=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[n,s]}):t,O5=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const s=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return s(i,o),o},set(i,o){n.has(i)?n.set(i,o):s(i,o)}}},bk="!",L5=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,s=e[0],i=e.length,o=a=>{const l=[];let c=0,u=0,d;for(let E=0;E<a.length;E++){let b=a[E];if(c===0){if(b===s&&(r||a.slice(E,E+i)===e)){l.push(a.slice(u,E)),u=E+i;continue}if(b==="/"){d=E;continue}}b==="["?c++:b==="]"&&c--}const m=l.length===0?a:a.substring(u),p=m.startsWith(bk),v=p?m.substring(1):m,g=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:v,maybePostfixModifierPosition:g}};return n?a=>n({className:a,parseClassName:o}):o},M5=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},V5=t=>({cache:O5(t.cacheSize),parseClassName:L5(t),...R5(t)}),j5=/\s+/,F5=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=e,i=[],o=t.trim().split(j5);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:d,baseClassName:m,maybePostfixModifierPosition:p}=n(c);let v=!!p,g=r(v?m.substring(0,p):m);if(!g){if(!v){a=c+(a.length>0?" "+a:a);continue}if(g=r(m),!g){a=c+(a.length>0?" "+a:a);continue}v=!1}const E=M5(u).join(":"),b=d?E+bk:E,_=b+g;if(i.includes(_))continue;i.push(_);const S=s(g,v);for(let P=0;P<S.length;++P){const T=S[P];i.push(b+T)}a=c+(a.length>0?" "+a:a)}return a};function U5(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=Ek(e))&&(r&&(r+=" "),r+=n);return r}const Ek=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=Ek(t[r]))&&(n&&(n+=" "),n+=e);return n};function $5(t,...e){let n,r,s,i=o;function o(l){const c=e.reduce((u,d)=>d(u),t());return n=V5(c),r=n.cache.get,s=n.cache.set,i=a,a(l)}function a(l){const c=r(l);if(c)return c;const u=F5(l,n);return s(l,u),u}return function(){return i(U5.apply(null,arguments))}}const Cn=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},Sk=/^\[(?:([a-z-]+):)?(.+)\]$/i,B5=/^\d+\/\d+$/,z5=new Set(["px","full","screen"]),W5=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,q5=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,H5=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,K5=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,G5=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ho=t=>xu(t)||z5.has(t)||B5.test(t),Xo=t=>kd(t,"length",n$),xu=t=>!!t&&!Number.isNaN(Number(t)),Sw=t=>kd(t,"number",xu),ch=t=>!!t&&Number.isInteger(Number(t)),Q5=t=>t.endsWith("%")&&xu(t.slice(0,-1)),Rt=t=>Sk.test(t),Zo=t=>W5.test(t),Y5=new Set(["length","size","percentage"]),J5=t=>kd(t,Y5,Ik),X5=t=>kd(t,"position",Ik),Z5=new Set(["image","url"]),e$=t=>kd(t,Z5,s$),t$=t=>kd(t,"",r$),uh=()=>!0,kd=(t,e,n)=>{const r=Sk.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},n$=t=>q5.test(t)&&!H5.test(t),Ik=()=>!1,r$=t=>K5.test(t),s$=t=>G5.test(t),i$=()=>{const t=Cn("colors"),e=Cn("spacing"),n=Cn("blur"),r=Cn("brightness"),s=Cn("borderColor"),i=Cn("borderRadius"),o=Cn("borderSpacing"),a=Cn("borderWidth"),l=Cn("contrast"),c=Cn("grayscale"),u=Cn("hueRotate"),d=Cn("invert"),m=Cn("gap"),p=Cn("gradientColorStops"),v=Cn("gradientColorStopPositions"),g=Cn("inset"),E=Cn("margin"),b=Cn("opacity"),_=Cn("padding"),S=Cn("saturate"),P=Cn("scale"),T=Cn("sepia"),N=Cn("skew"),I=Cn("space"),A=Cn("translate"),R=()=>["auto","contain","none"],k=()=>["auto","hidden","clip","visible","scroll"],C=()=>["auto",Rt,e],L=()=>[Rt,e],O=()=>["",ho,Xo],X=()=>["auto",xu,Rt],ke=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Oe=()=>["solid","dashed","dotted","double","none"],je=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],W=()=>["start","end","center","between","around","evenly","stretch"],G=()=>["","0",Rt],ae=()=>["auto","avoid","all","avoid-page","page","left","right","column"],pe=()=>[xu,Rt];return{cacheSize:500,separator:":",theme:{colors:[uh],spacing:[ho,Xo],blur:["none","",Zo,Rt],brightness:pe(),borderColor:[t],borderRadius:["none","","full",Zo,Rt],borderSpacing:L(),borderWidth:O(),contrast:pe(),grayscale:G(),hueRotate:pe(),invert:G(),gap:L(),gradientColorStops:[t],gradientColorStopPositions:[Q5,Xo],inset:C(),margin:C(),opacity:pe(),padding:L(),saturate:pe(),scale:pe(),sepia:G(),skew:pe(),space:L(),translate:L()},classGroups:{aspect:[{aspect:["auto","square","video",Rt]}],container:["container"],columns:[{columns:[Zo]}],"break-after":[{"break-after":ae()}],"break-before":[{"break-before":ae()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ke(),Rt]}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ch,Rt]}],basis:[{basis:C()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Rt]}],grow:[{grow:G()}],shrink:[{shrink:G()}],order:[{order:["first","last","none",ch,Rt]}],"grid-cols":[{"grid-cols":[uh]}],"col-start-end":[{col:["auto",{span:["full",ch,Rt]},Rt]}],"col-start":[{"col-start":X()}],"col-end":[{"col-end":X()}],"grid-rows":[{"grid-rows":[uh]}],"row-start-end":[{row:["auto",{span:[ch,Rt]},Rt]}],"row-start":[{"row-start":X()}],"row-end":[{"row-end":X()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Rt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Rt]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...W()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...W(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...W(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Rt,e]}],"min-w":[{"min-w":[Rt,e,"min","max","fit"]}],"max-w":[{"max-w":[Rt,e,"none","full","min","max","fit","prose",{screen:[Zo]},Zo]}],h:[{h:[Rt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Rt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Rt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Rt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Zo,Xo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Sw]}],"font-family":[{font:[uh]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Rt]}],"line-clamp":[{"line-clamp":["none",xu,Sw]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ho,Rt]}],"list-image":[{"list-image":["none",Rt]}],"list-style-type":[{list:["none","disc","decimal",Rt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Oe(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ho,Xo]}],"underline-offset":[{"underline-offset":["auto",ho,Rt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:L()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Rt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Rt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ke(),X5]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",J5]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},e$]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...Oe(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:Oe()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...Oe()]}],"outline-offset":[{"outline-offset":[ho,Rt]}],"outline-w":[{outline:[ho,Xo]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[ho,Xo]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Zo,t$]}],"shadow-color":[{shadow:[uh]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...je(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":je()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Zo,Rt]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[S]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Rt]}],duration:[{duration:pe()}],ease:[{ease:["linear","in","out","in-out",Rt]}],delay:[{delay:pe()}],animate:[{animate:["none","spin","ping","pulse","bounce",Rt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[P]}],"scale-x":[{"scale-x":[P]}],"scale-y":[{"scale-y":[P]}],rotate:[{rotate:[ch,Rt]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Rt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Rt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":L()}],"scroll-mx":[{"scroll-mx":L()}],"scroll-my":[{"scroll-my":L()}],"scroll-ms":[{"scroll-ms":L()}],"scroll-me":[{"scroll-me":L()}],"scroll-mt":[{"scroll-mt":L()}],"scroll-mr":[{"scroll-mr":L()}],"scroll-mb":[{"scroll-mb":L()}],"scroll-ml":[{"scroll-ml":L()}],"scroll-p":[{"scroll-p":L()}],"scroll-px":[{"scroll-px":L()}],"scroll-py":[{"scroll-py":L()}],"scroll-ps":[{"scroll-ps":L()}],"scroll-pe":[{"scroll-pe":L()}],"scroll-pt":[{"scroll-pt":L()}],"scroll-pr":[{"scroll-pr":L()}],"scroll-pb":[{"scroll-pb":L()}],"scroll-pl":[{"scroll-pl":L()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Rt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[ho,Xo,Sw]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},o$=$5(i$);function yn(...t){return o$(fk(t))}function Nte(t){const e=Number(t)||0;return new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}const a$=v3,Tk=y.forwardRef(({className:t,...e},n)=>f.jsx(ok,{ref:n,className:yn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));Tk.displayName=ok.displayName;const l$=Uy("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),xk=y.forwardRef(({className:t,variant:e,...n},r)=>f.jsx(ak,{ref:r,className:yn(l$({variant:e}),t),...n}));xk.displayName=ak.displayName;const c$=y.forwardRef(({className:t,...e},n)=>f.jsx(uk,{ref:n,className:yn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));c$.displayName=uk.displayName;const Ak=y.forwardRef(({className:t,...e},n)=>f.jsx(dk,{ref:n,className:yn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:f.jsx($i,{className:"h-4 w-4"})}));Ak.displayName=dk.displayName;const Pk=y.forwardRef(({className:t,...e},n)=>f.jsx(lk,{ref:n,className:yn("text-sm font-semibold",t),...e}));Pk.displayName=lk.displayName;const Rk=y.forwardRef(({className:t,...e},n)=>f.jsx(ck,{ref:n,className:yn("text-sm opacity-90",t),...e}));Rk.displayName=ck.displayName;function u$(){const{toasts:t}=hl();return f.jsxs(a$,{children:[t.map(function({id:e,title:n,description:r,action:s,...i}){return f.jsxs(xk,{...i,children:[f.jsxs("div",{className:"grid gap-1",children:[n&&f.jsx(Pk,{children:n}),r&&f.jsx(Rk,{children:r})]}),s,f.jsx(Ak,{})]},e)}),f.jsx(Tk,{})]})}var Ag=["light","dark"],yE="(prefers-color-scheme: dark)",d$=typeof window>"u",vE=y.createContext(void 0),h$={setTheme:t=>{},themes:[]},Ck=()=>{var t;return(t=y.useContext(vE))!=null?t:h$},f$=t=>y.useContext(vE)?t.children:y.createElement(p$,{...t}),m$=["light","dark"],p$=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:n=!0,enableColorScheme:r=!0,storageKey:s="theme",themes:i=m$,defaultTheme:o=n?"system":"light",attribute:a="data-theme",value:l,children:c,nonce:u})=>{let[d,m]=y.useState(()=>fx(s,o)),[p,v]=y.useState(()=>fx(s)),g=l?Object.values(l):i,E=y.useCallback(P=>{let T=P;if(!T)return;P==="system"&&n&&(T=mx());let N=l?l[T]:T,I=e?y$():null,A=document.documentElement;if(a==="class"?(A.classList.remove(...g),N&&A.classList.add(N)):N?A.setAttribute(a,N):A.removeAttribute(a),r){let R=Ag.includes(o)?o:null,k=Ag.includes(T)?T:R;A.style.colorScheme=k}I==null||I()},[]),b=y.useCallback(P=>{let T=typeof P=="function"?P(P):P;m(T);try{localStorage.setItem(s,T)}catch{}},[t]),_=y.useCallback(P=>{let T=mx(P);v(T),d==="system"&&n&&!t&&E("system")},[d,t]);y.useEffect(()=>{let P=window.matchMedia(yE);return P.addListener(_),_(P),()=>P.removeListener(_)},[_]),y.useEffect(()=>{let P=T=>{if(T.key!==s)return;let N=T.newValue||o;b(N)};return window.addEventListener("storage",P),()=>window.removeEventListener("storage",P)},[b]),y.useEffect(()=>{E(t??d)},[t,d]);let S=y.useMemo(()=>({theme:d,setTheme:b,forcedTheme:t,resolvedTheme:d==="system"?p:d,themes:n?[...i,"system"]:i,systemTheme:n?p:void 0}),[d,b,t,p,n,i]);return y.createElement(vE.Provider,{value:S},y.createElement(g$,{forcedTheme:t,disableTransitionOnChange:e,enableSystem:n,enableColorScheme:r,storageKey:s,themes:i,defaultTheme:o,attribute:a,value:l,children:c,attrs:g,nonce:u}),c)},g$=y.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:o,attrs:a,nonce:l})=>{let c=i==="system",u=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(v=>`'${v}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,d=s?Ag.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",m=(v,g=!1,E=!0)=>{let b=o?o[v]:v,_=g?v+"|| ''":`'${b}'`,S="";return s&&E&&!g&&Ag.includes(v)&&(S+=`d.style.colorScheme = '${v}';`),n==="class"?g||b?S+=`c.add(${_})`:S+="null":b&&(S+=`d[s](n,${_})`),S},p=t?`!function(){${u}${m(t)}}()`:r?`!function(){try{${u}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${c})){var t='${yE}',m=window.matchMedia(t);if(m.media!==t||m.matches){${m("dark")}}else{${m("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${m(o?"x[e]":"e",!0)}}${c?"":"else{"+m(i,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${m(o?"x[e]":"e",!0)}}else{${m(i,!1,!1)};}${d}}catch(t){}}();`;return y.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})}),fx=(t,e)=>{if(d$)return;let n;try{n=localStorage.getItem(t)||void 0}catch{}return n||e},y$=()=>{let t=document.createElement("style");return t.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},mx=t=>(t||(t=window.matchMedia(yE)),t.matches?"dark":"light"),v$=t=>{switch(t){case"success":return b$;case"info":return S$;case"warning":return E$;case"error":return I$;default:return null}},w$=Array(12).fill(0),_$=({visible:t,className:e})=>M.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},M.createElement("div",{className:"sonner-spinner"},w$.map((n,r)=>M.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),b$=M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},M.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),E$=M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},M.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),S$=M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},M.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),I$=M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},M.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),T$=M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},M.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),M.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),x$=()=>{let[t,e]=M.useState(document.hidden);return M.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},a0=1,A$=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let n=this.subscribers.indexOf(e);this.subscribers.splice(n,1)}),this.publish=e=>{this.subscribers.forEach(n=>n(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var n;let{message:r,...s}=e,i=typeof(e==null?void 0:e.id)=="number"||((n=e.id)==null?void 0:n.length)>0?e.id:a0++,o=this.toasts.find(l=>l.id===i),a=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),o?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...e,id:i,title:r}),{...l,...e,id:i,dismissible:a,title:r}):l):this.addToast({title:r,...s,dismissible:a,id:i}),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:e,dismiss:!0})),e),this.message=(e,n)=>this.create({...n,message:e}),this.error=(e,n)=>this.create({...n,message:e,type:"error"}),this.success=(e,n)=>this.create({...n,type:"success",message:e}),this.info=(e,n)=>this.create({...n,type:"info",message:e}),this.warning=(e,n)=>this.create({...n,type:"warning",message:e}),this.loading=(e,n)=>this.create({...n,type:"loading",message:e}),this.promise=(e,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:e,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let s=e instanceof Promise?e:e(),i=r!==void 0,o,a=s.then(async c=>{if(o=["resolve",c],M.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(R$(c)&&!c.ok){i=!1;let u=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,d=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description;this.create({id:r,type:"error",message:u,description:d})}else if(n.success!==void 0){i=!1;let u=typeof n.success=="function"?await n.success(c):n.success,d=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"success",message:u,description:d})}}).catch(async c=>{if(o=["reject",c],n.error!==void 0){i=!1;let u=typeof n.error=="function"?await n.error(c):n.error,d=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"error",message:u,description:d})}}).finally(()=>{var c;i&&(this.dismiss(r),r=void 0),(c=n.finally)==null||c.call(n)}),l=()=>new Promise((c,u)=>a.then(()=>o[0]==="reject"?u(o[1]):c(o[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(e,n)=>{let r=(n==null?void 0:n.id)||a0++;return this.create({jsx:e(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},us=new A$,P$=(t,e)=>{let n=(e==null?void 0:e.id)||a0++;return us.addToast({title:t,...e,id:n}),n},R$=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",C$=P$,N$=()=>us.toasts,k$=()=>us.getActiveToasts(),kt=Object.assign(C$,{success:us.success,info:us.info,warning:us.warning,error:us.error,custom:us.custom,message:us.message,promise:us.promise,dismiss:us.dismiss,loading:us.loading},{getHistory:N$,getToasts:k$});function D$(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}D$(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Qm(t){return t.label!==void 0}var O$=3,L$="32px",M$="16px",px=4e3,V$=356,j$=14,F$=20,U$=200;function si(...t){return t.filter(Boolean).join(" ")}function $$(t){let[e,n]=t.split("-"),r=[];return e&&r.push(e),n&&r.push(n),r}var B$=t=>{var e,n,r,s,i,o,a,l,c,u,d;let{invert:m,toast:p,unstyled:v,interacting:g,setHeights:E,visibleToasts:b,heights:_,index:S,toasts:P,expanded:T,removeToast:N,defaultRichColors:I,closeButton:A,style:R,cancelButtonStyle:k,actionButtonStyle:C,className:L="",descriptionClassName:O="",duration:X,position:ke,gap:Oe,loadingIcon:je,expandByDefault:W,classNames:G,icons:ae,closeButtonAriaLabel:pe="Close toast",pauseWhenPageIsHidden:fe}=t,[Ge,xe]=M.useState(null),[ve,Q]=M.useState(null),[qe,cn]=M.useState(!1),[cr,Yn]=M.useState(!1),[tr,Nr]=M.useState(!1),[kr,Dr]=M.useState(!1),[J,ue]=M.useState(!1),[Ee,et]=M.useState(0),[he,Ce]=M.useState(0),Fe=M.useRef(p.duration||X||px),rt=M.useRef(null),ct=M.useRef(null),Lt=S===0,Ct=S+1<=b,dt=p.type,Y=p.dismissible!==!1,Te=p.className||"",we=p.descriptionClassName||"",le=M.useMemo(()=>_.findIndex(te=>te.toastId===p.id)||0,[_,p.id]),ce=M.useMemo(()=>{var te;return(te=p.closeButton)!=null?te:A},[p.closeButton,A]),st=M.useMemo(()=>p.duration||X||px,[p.duration,X]),yt=M.useRef(0),_n=M.useRef(0),tn=M.useRef(0),j=M.useRef(null),[U,V]=ke.split("-"),Z=M.useMemo(()=>_.reduce((te,ne,be)=>be>=le?te:te+ne.height,0),[_,le]),q=x$(),oe=p.invert||m,H=dt==="loading";_n.current=M.useMemo(()=>le*Oe+Z,[le,Z]),M.useEffect(()=>{Fe.current=st},[st]),M.useEffect(()=>{cn(!0)},[]),M.useEffect(()=>{let te=ct.current;if(te){let ne=te.getBoundingClientRect().height;return Ce(ne),E(be=>[{toastId:p.id,height:ne,position:p.position},...be]),()=>E(be=>be.filter(ze=>ze.toastId!==p.id))}},[E,p.id]),M.useLayoutEffect(()=>{if(!qe)return;let te=ct.current,ne=te.style.height;te.style.height="auto";let be=te.getBoundingClientRect().height;te.style.height=ne,Ce(be),E(ze=>ze.find(Qe=>Qe.toastId===p.id)?ze.map(Qe=>Qe.toastId===p.id?{...Qe,height:be}:Qe):[{toastId:p.id,height:be,position:p.position},...ze])},[qe,p.title,p.description,E,p.id]);let Pe=M.useCallback(()=>{Yn(!0),et(_n.current),E(te=>te.filter(ne=>ne.toastId!==p.id)),setTimeout(()=>{N(p)},U$)},[p,N,E,_n]);M.useEffect(()=>{if(p.promise&&dt==="loading"||p.duration===1/0||p.type==="loading")return;let te;return T||g||fe&&q?(()=>{if(tn.current<yt.current){let ne=new Date().getTime()-yt.current;Fe.current=Fe.current-ne}tn.current=new Date().getTime()})():Fe.current!==1/0&&(yt.current=new Date().getTime(),te=setTimeout(()=>{var ne;(ne=p.onAutoClose)==null||ne.call(p,p),Pe()},Fe.current)),()=>clearTimeout(te)},[T,g,p,dt,fe,q,Pe]),M.useEffect(()=>{p.delete&&Pe()},[Pe,p.delete]);function it(){var te,ne,be;return ae!=null&&ae.loading?M.createElement("div",{className:si(G==null?void 0:G.loader,(te=p==null?void 0:p.classNames)==null?void 0:te.loader,"sonner-loader"),"data-visible":dt==="loading"},ae.loading):je?M.createElement("div",{className:si(G==null?void 0:G.loader,(ne=p==null?void 0:p.classNames)==null?void 0:ne.loader,"sonner-loader"),"data-visible":dt==="loading"},je):M.createElement(_$,{className:si(G==null?void 0:G.loader,(be=p==null?void 0:p.classNames)==null?void 0:be.loader),visible:dt==="loading"})}return M.createElement("li",{tabIndex:0,ref:ct,className:si(L,Te,G==null?void 0:G.toast,(e=p==null?void 0:p.classNames)==null?void 0:e.toast,G==null?void 0:G.default,G==null?void 0:G[dt],(n=p==null?void 0:p.classNames)==null?void 0:n[dt]),"data-sonner-toast":"","data-rich-colors":(r=p.richColors)!=null?r:I,"data-styled":!(p.jsx||p.unstyled||v),"data-mounted":qe,"data-promise":!!p.promise,"data-swiped":J,"data-removed":cr,"data-visible":Ct,"data-y-position":U,"data-x-position":V,"data-index":S,"data-front":Lt,"data-swiping":tr,"data-dismissible":Y,"data-type":dt,"data-invert":oe,"data-swipe-out":kr,"data-swipe-direction":ve,"data-expanded":!!(T||W&&qe),style:{"--index":S,"--toasts-before":S,"--z-index":P.length-S,"--offset":`${cr?Ee:_n.current}px`,"--initial-height":W?"auto":`${he}px`,...R,...p.style},onDragEnd:()=>{Nr(!1),xe(null),j.current=null},onPointerDown:te=>{H||!Y||(rt.current=new Date,et(_n.current),te.target.setPointerCapture(te.pointerId),te.target.tagName!=="BUTTON"&&(Nr(!0),j.current={x:te.clientX,y:te.clientY}))},onPointerUp:()=>{var te,ne,be,ze;if(kr||!Y)return;j.current=null;let Qe=Number(((te=ct.current)==null?void 0:te.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),mt=Number(((ne=ct.current)==null?void 0:ne.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ht=new Date().getTime()-((be=rt.current)==null?void 0:be.getTime()),Re=Ge==="x"?Qe:mt,ot=Math.abs(Re)/ht;if(Math.abs(Re)>=F$||ot>.11){et(_n.current),(ze=p.onDismiss)==null||ze.call(p,p),Q(Ge==="x"?Qe>0?"right":"left":mt>0?"down":"up"),Pe(),Dr(!0),ue(!1);return}Nr(!1),xe(null)},onPointerMove:te=>{var ne,be,ze,Qe;if(!j.current||!Y||((ne=window.getSelection())==null?void 0:ne.toString().length)>0)return;let mt=te.clientY-j.current.y,ht=te.clientX-j.current.x,Re=(be=t.swipeDirections)!=null?be:$$(ke);!Ge&&(Math.abs(ht)>1||Math.abs(mt)>1)&&xe(Math.abs(ht)>Math.abs(mt)?"x":"y");let ot={x:0,y:0};Ge==="y"?(Re.includes("top")||Re.includes("bottom"))&&(Re.includes("top")&&mt<0||Re.includes("bottom")&&mt>0)&&(ot.y=mt):Ge==="x"&&(Re.includes("left")||Re.includes("right"))&&(Re.includes("left")&&ht<0||Re.includes("right")&&ht>0)&&(ot.x=ht),(Math.abs(ot.x)>0||Math.abs(ot.y)>0)&&ue(!0),(ze=ct.current)==null||ze.style.setProperty("--swipe-amount-x",`${ot.x}px`),(Qe=ct.current)==null||Qe.style.setProperty("--swipe-amount-y",`${ot.y}px`)}},ce&&!p.jsx?M.createElement("button",{"aria-label":pe,"data-disabled":H,"data-close-button":!0,onClick:H||!Y?()=>{}:()=>{var te;Pe(),(te=p.onDismiss)==null||te.call(p,p)},className:si(G==null?void 0:G.closeButton,(s=p==null?void 0:p.classNames)==null?void 0:s.closeButton)},(i=ae==null?void 0:ae.close)!=null?i:T$):null,p.jsx||y.isValidElement(p.title)?p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title:M.createElement(M.Fragment,null,dt||p.icon||p.promise?M.createElement("div",{"data-icon":"",className:si(G==null?void 0:G.icon,(o=p==null?void 0:p.classNames)==null?void 0:o.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||it():null,p.type!=="loading"?p.icon||(ae==null?void 0:ae[dt])||v$(dt):null):null,M.createElement("div",{"data-content":"",className:si(G==null?void 0:G.content,(a=p==null?void 0:p.classNames)==null?void 0:a.content)},M.createElement("div",{"data-title":"",className:si(G==null?void 0:G.title,(l=p==null?void 0:p.classNames)==null?void 0:l.title)},typeof p.title=="function"?p.title():p.title),p.description?M.createElement("div",{"data-description":"",className:si(O,we,G==null?void 0:G.description,(c=p==null?void 0:p.classNames)==null?void 0:c.description)},typeof p.description=="function"?p.description():p.description):null),y.isValidElement(p.cancel)?p.cancel:p.cancel&&Qm(p.cancel)?M.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||k,onClick:te=>{var ne,be;Qm(p.cancel)&&Y&&((be=(ne=p.cancel).onClick)==null||be.call(ne,te),Pe())},className:si(G==null?void 0:G.cancelButton,(u=p==null?void 0:p.classNames)==null?void 0:u.cancelButton)},p.cancel.label):null,y.isValidElement(p.action)?p.action:p.action&&Qm(p.action)?M.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||C,onClick:te=>{var ne,be;Qm(p.action)&&((be=(ne=p.action).onClick)==null||be.call(ne,te),!te.defaultPrevented&&Pe())},className:si(G==null?void 0:G.actionButton,(d=p==null?void 0:p.classNames)==null?void 0:d.actionButton)},p.action.label):null))};function gx(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function z$(t,e){let n={};return[t,e].forEach((r,s)=>{let i=s===1,o=i?"--mobile-offset":"--offset",a=i?M$:L$;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${o}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${o}-${c}`]=a:n[`${o}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(a)}),n}var W$=y.forwardRef(function(t,e){let{invert:n,position:r="bottom-right",hotkey:s=["altKey","KeyT"],expand:i,closeButton:o,className:a,offset:l,mobileOffset:c,theme:u="light",richColors:d,duration:m,style:p,visibleToasts:v=O$,toastOptions:g,dir:E=gx(),gap:b=j$,loadingIcon:_,icons:S,containerAriaLabel:P="Notifications",pauseWhenPageIsHidden:T}=t,[N,I]=M.useState([]),A=M.useMemo(()=>Array.from(new Set([r].concat(N.filter(fe=>fe.position).map(fe=>fe.position)))),[N,r]),[R,k]=M.useState([]),[C,L]=M.useState(!1),[O,X]=M.useState(!1),[ke,Oe]=M.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),je=M.useRef(null),W=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),G=M.useRef(null),ae=M.useRef(!1),pe=M.useCallback(fe=>{I(Ge=>{var xe;return(xe=Ge.find(ve=>ve.id===fe.id))!=null&&xe.delete||us.dismiss(fe.id),Ge.filter(({id:ve})=>ve!==fe.id)})},[]);return M.useEffect(()=>us.subscribe(fe=>{if(fe.dismiss){I(Ge=>Ge.map(xe=>xe.id===fe.id?{...xe,delete:!0}:xe));return}setTimeout(()=>{$N.flushSync(()=>{I(Ge=>{let xe=Ge.findIndex(ve=>ve.id===fe.id);return xe!==-1?[...Ge.slice(0,xe),{...Ge[xe],...fe},...Ge.slice(xe+1)]:[fe,...Ge]})})})}),[]),M.useEffect(()=>{if(u!=="system"){Oe(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Oe("dark"):Oe("light")),typeof window>"u")return;let fe=window.matchMedia("(prefers-color-scheme: dark)");try{fe.addEventListener("change",({matches:Ge})=>{Oe(Ge?"dark":"light")})}catch{fe.addListener(({matches:xe})=>{try{Oe(xe?"dark":"light")}catch(ve){console.error(ve)}})}},[u]),M.useEffect(()=>{N.length<=1&&L(!1)},[N]),M.useEffect(()=>{let fe=Ge=>{var xe,ve;s.every(Q=>Ge[Q]||Ge.code===Q)&&(L(!0),(xe=je.current)==null||xe.focus()),Ge.code==="Escape"&&(document.activeElement===je.current||(ve=je.current)!=null&&ve.contains(document.activeElement))&&L(!1)};return document.addEventListener("keydown",fe),()=>document.removeEventListener("keydown",fe)},[s]),M.useEffect(()=>{if(je.current)return()=>{G.current&&(G.current.focus({preventScroll:!0}),G.current=null,ae.current=!1)}},[je.current]),M.createElement("section",{ref:e,"aria-label":`${P} ${W}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},A.map((fe,Ge)=>{var xe;let[ve,Q]=fe.split("-");return N.length?M.createElement("ol",{key:fe,dir:E==="auto"?gx():E,tabIndex:-1,ref:je,className:a,"data-sonner-toaster":!0,"data-theme":ke,"data-y-position":ve,"data-lifted":C&&N.length>1&&!i,"data-x-position":Q,style:{"--front-toast-height":`${((xe=R[0])==null?void 0:xe.height)||0}px`,"--width":`${V$}px`,"--gap":`${b}px`,...p,...z$(l,c)},onBlur:qe=>{ae.current&&!qe.currentTarget.contains(qe.relatedTarget)&&(ae.current=!1,G.current&&(G.current.focus({preventScroll:!0}),G.current=null))},onFocus:qe=>{qe.target instanceof HTMLElement&&qe.target.dataset.dismissible==="false"||ae.current||(ae.current=!0,G.current=qe.relatedTarget)},onMouseEnter:()=>L(!0),onMouseMove:()=>L(!0),onMouseLeave:()=>{O||L(!1)},onDragEnd:()=>L(!1),onPointerDown:qe=>{qe.target instanceof HTMLElement&&qe.target.dataset.dismissible==="false"||X(!0)},onPointerUp:()=>X(!1)},N.filter(qe=>!qe.position&&Ge===0||qe.position===fe).map((qe,cn)=>{var cr,Yn;return M.createElement(B$,{key:qe.id,icons:S,index:cn,toast:qe,defaultRichColors:d,duration:(cr=g==null?void 0:g.duration)!=null?cr:m,className:g==null?void 0:g.className,descriptionClassName:g==null?void 0:g.descriptionClassName,invert:n,visibleToasts:v,closeButton:(Yn=g==null?void 0:g.closeButton)!=null?Yn:o,interacting:O,position:fe,style:g==null?void 0:g.style,unstyled:g==null?void 0:g.unstyled,classNames:g==null?void 0:g.classNames,cancelButtonStyle:g==null?void 0:g.cancelButtonStyle,actionButtonStyle:g==null?void 0:g.actionButtonStyle,removeToast:pe,toasts:N.filter(tr=>tr.position==qe.position),heights:R.filter(tr=>tr.position==qe.position),setHeights:k,expandByDefault:i,gap:b,loadingIcon:_,expanded:C,pauseWhenPageIsHidden:T,swipeDirections:t.swipeDirections})})):null}))});const Nk=({...t})=>{const{theme:e="system"}=Ck();return f.jsx(W$,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var q$=by[" useId ".trim().toString()]||(()=>{}),H$=0;function Iw(t){const[e,n]=y.useState(q$());return eo(()=>{n(r=>r??String(H$++))},[t]),t||(e?`radix-${e}`:"")}const K$=["top","right","bottom","left"],Ya=Math.min,Ns=Math.max,Pg=Math.round,Ym=Math.floor,Qi=t=>({x:t,y:t}),G$={left:"right",right:"left",bottom:"top",top:"bottom"},Q$={start:"end",end:"start"};function l0(t,e,n){return Ns(t,Ya(e,n))}function Oo(t,e){return typeof t=="function"?t(e):t}function Lo(t){return t.split("-")[0]}function Dd(t){return t.split("-")[1]}function wE(t){return t==="x"?"y":"x"}function _E(t){return t==="y"?"height":"width"}const Y$=new Set(["top","bottom"]);function zi(t){return Y$.has(Lo(t))?"y":"x"}function bE(t){return wE(zi(t))}function J$(t,e,n){n===void 0&&(n=!1);const r=Dd(t),s=bE(t),i=_E(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Rg(o)),[o,Rg(o)]}function X$(t){const e=Rg(t);return[c0(t),e,c0(e)]}function c0(t){return t.replace(/start|end/g,e=>Q$[e])}const yx=["left","right"],vx=["right","left"],Z$=["top","bottom"],e6=["bottom","top"];function t6(t,e,n){switch(t){case"top":case"bottom":return n?e?vx:yx:e?yx:vx;case"left":case"right":return e?Z$:e6;default:return[]}}function n6(t,e,n,r){const s=Dd(t);let i=t6(Lo(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(c0)))),i}function Rg(t){return t.replace(/left|right|bottom|top/g,e=>G$[e])}function r6(t){return{top:0,right:0,bottom:0,left:0,...t}}function kk(t){return typeof t!="number"?r6(t):{top:t,right:t,bottom:t,left:t}}function Cg(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function wx(t,e,n){let{reference:r,floating:s}=t;const i=zi(e),o=bE(e),a=_E(o),l=Lo(e),c=i==="y",u=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,m=r[a]/2-s[a]/2;let p;switch(l){case"top":p={x:u,y:r.y-s.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-s.width,y:d};break;default:p={x:r.x,y:r.y}}switch(Dd(e)){case"start":p[o]-=m*(n&&c?-1:1);break;case"end":p[o]+=m*(n&&c?-1:1);break}return p}const s6=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:u,y:d}=wx(c,r,l),m=r,p={},v=0;for(let g=0;g<a.length;g++){const{name:E,fn:b}=a[g],{x:_,y:S,data:P,reset:T}=await b({x:u,y:d,initialPlacement:r,placement:m,strategy:s,middlewareData:p,rects:c,platform:o,elements:{reference:t,floating:e}});u=_??u,d=S??d,p={...p,[E]:{...p[E],...P}},T&&v<=50&&(v++,typeof T=="object"&&(T.placement&&(m=T.placement),T.rects&&(c=T.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):T.rects),{x:u,y:d}=wx(c,m,l)),g=-1)}return{x:u,y:d,placement:m,strategy:s,middlewareData:p}};async function _f(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:m=!1,padding:p=0}=Oo(e,t),v=kk(p),E=a[m?d==="floating"?"reference":"floating":d],b=Cg(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(E)))==null||n?E:E.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),_=d==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),P=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},T=Cg(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:_,offsetParent:S,strategy:l}):_);return{top:(b.top-T.top+v.top)/P.y,bottom:(T.bottom-b.bottom+v.bottom)/P.y,left:(b.left-T.left+v.left)/P.x,right:(T.right-b.right+v.right)/P.x}}const i6=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=Oo(t,e)||{};if(c==null)return{};const d=kk(u),m={x:n,y:r},p=bE(s),v=_E(p),g=await o.getDimensions(c),E=p==="y",b=E?"top":"left",_=E?"bottom":"right",S=E?"clientHeight":"clientWidth",P=i.reference[v]+i.reference[p]-m[p]-i.floating[v],T=m[p]-i.reference[p],N=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let I=N?N[S]:0;(!I||!await(o.isElement==null?void 0:o.isElement(N)))&&(I=a.floating[S]||i.floating[v]);const A=P/2-T/2,R=I/2-g[v]/2-1,k=Ya(d[b],R),C=Ya(d[_],R),L=k,O=I-g[v]-C,X=I/2-g[v]/2+A,ke=l0(L,X,O),Oe=!l.arrow&&Dd(s)!=null&&X!==ke&&i.reference[v]/2-(X<L?k:C)-g[v]/2<0,je=Oe?X<L?X-L:X-O:0;return{[p]:m[p]+je,data:{[p]:ke,centerOffset:X-ke-je,...Oe&&{alignmentOffset:je}},reset:Oe}}}),o6=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:m,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:g=!0,...E}=Oo(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const b=Lo(s),_=zi(a),S=Lo(a)===a,P=await(l.isRTL==null?void 0:l.isRTL(c.floating)),T=m||(S||!g?[Rg(a)]:X$(a)),N=v!=="none";!m&&N&&T.push(...n6(a,g,v,P));const I=[a,...T],A=await _f(e,E),R=[];let k=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&R.push(A[b]),d){const X=J$(s,o,P);R.push(A[X[0]],A[X[1]])}if(k=[...k,{placement:s,overflows:R}],!R.every(X=>X<=0)){var C,L;const X=(((C=i.flip)==null?void 0:C.index)||0)+1,ke=I[X];if(ke&&(!(d==="alignment"?_!==zi(ke):!1)||k.every(W=>zi(W.placement)===_?W.overflows[0]>0:!0)))return{data:{index:X,overflows:k},reset:{placement:ke}};let Oe=(L=k.filter(je=>je.overflows[0]<=0).sort((je,W)=>je.overflows[1]-W.overflows[1])[0])==null?void 0:L.placement;if(!Oe)switch(p){case"bestFit":{var O;const je=(O=k.filter(W=>{if(N){const G=zi(W.placement);return G===_||G==="y"}return!0}).map(W=>[W.placement,W.overflows.filter(G=>G>0).reduce((G,ae)=>G+ae,0)]).sort((W,G)=>W[1]-G[1])[0])==null?void 0:O[0];je&&(Oe=je);break}case"initialPlacement":Oe=a;break}if(s!==Oe)return{reset:{placement:Oe}}}return{}}}};function _x(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function bx(t){return K$.some(e=>t[e]>=0)}const a6=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=Oo(t,e);switch(r){case"referenceHidden":{const i=await _f(e,{...s,elementContext:"reference"}),o=_x(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:bx(o)}}}case"escaped":{const i=await _f(e,{...s,altBoundary:!0}),o=_x(i,n.floating);return{data:{escapedOffsets:o,escaped:bx(o)}}}default:return{}}}}},Dk=new Set(["left","top"]);async function l6(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=Lo(n),a=Dd(n),l=zi(n)==="y",c=Dk.has(o)?-1:1,u=i&&l?-1:1,d=Oo(e,t);let{mainAxis:m,crossAxis:p,alignmentAxis:v}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof v=="number"&&(p=a==="end"?v*-1:v),l?{x:p*u,y:m*c}:{x:m*c,y:p*u}}const c6=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await l6(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},u6=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:E=>{let{x:b,y:_}=E;return{x:b,y:_}}},...l}=Oo(t,e),c={x:n,y:r},u=await _f(e,l),d=zi(Lo(s)),m=wE(d);let p=c[m],v=c[d];if(i){const E=m==="y"?"top":"left",b=m==="y"?"bottom":"right",_=p+u[E],S=p-u[b];p=l0(_,p,S)}if(o){const E=d==="y"?"top":"left",b=d==="y"?"bottom":"right",_=v+u[E],S=v-u[b];v=l0(_,v,S)}const g=a.fn({...e,[m]:p,[d]:v});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[m]:i,[d]:o}}}}}},d6=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Oo(t,e),u={x:n,y:r},d=zi(s),m=wE(d);let p=u[m],v=u[d];const g=Oo(a,e),E=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const S=m==="y"?"height":"width",P=i.reference[m]-i.floating[S]+E.mainAxis,T=i.reference[m]+i.reference[S]-E.mainAxis;p<P?p=P:p>T&&(p=T)}if(c){var b,_;const S=m==="y"?"width":"height",P=Dk.has(Lo(s)),T=i.reference[d]-i.floating[S]+(P&&((b=o.offset)==null?void 0:b[d])||0)+(P?0:E.crossAxis),N=i.reference[d]+i.reference[S]+(P?0:((_=o.offset)==null?void 0:_[d])||0)-(P?E.crossAxis:0);v<T?v=T:v>N&&(v=N)}return{[m]:p,[d]:v}}}},h6=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=Oo(t,e),u=await _f(e,c),d=Lo(s),m=Dd(s),p=zi(s)==="y",{width:v,height:g}=i.floating;let E,b;d==="top"||d==="bottom"?(E=d,b=m===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(b=d,E=m==="end"?"top":"bottom");const _=g-u.top-u.bottom,S=v-u.left-u.right,P=Ya(g-u[E],_),T=Ya(v-u[b],S),N=!e.middlewareData.shift;let I=P,A=T;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(A=S),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(I=_),N&&!m){const k=Ns(u.left,0),C=Ns(u.right,0),L=Ns(u.top,0),O=Ns(u.bottom,0);p?A=v-2*(k!==0||C!==0?k+C:Ns(u.left,u.right)):I=g-2*(L!==0||O!==0?L+O:Ns(u.top,u.bottom))}await l({...e,availableWidth:A,availableHeight:I});const R=await o.getDimensions(a.floating);return v!==R.width||g!==R.height?{reset:{rects:!0}}:{}}}};function By(){return typeof window<"u"}function Od(t){return Ok(t)?(t.nodeName||"").toLowerCase():"#document"}function Ls(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function so(t){var e;return(e=(Ok(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Ok(t){return By()?t instanceof Node||t instanceof Ls(t).Node:!1}function yi(t){return By()?t instanceof Element||t instanceof Ls(t).Element:!1}function to(t){return By()?t instanceof HTMLElement||t instanceof Ls(t).HTMLElement:!1}function Ex(t){return!By()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ls(t).ShadowRoot}const f6=new Set(["inline","contents"]);function em(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=vi(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!f6.has(s)}const m6=new Set(["table","td","th"]);function p6(t){return m6.has(Od(t))}const g6=[":popover-open",":modal"];function zy(t){return g6.some(e=>{try{return t.matches(e)}catch{return!1}})}const y6=["transform","translate","scale","rotate","perspective"],v6=["transform","translate","scale","rotate","perspective","filter"],w6=["paint","layout","strict","content"];function EE(t){const e=SE(),n=yi(t)?vi(t):t;return y6.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||v6.some(r=>(n.willChange||"").includes(r))||w6.some(r=>(n.contain||"").includes(r))}function _6(t){let e=Ja(t);for(;to(e)&&!Yu(e);){if(EE(e))return e;if(zy(e))return null;e=Ja(e)}return null}function SE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const b6=new Set(["html","body","#document"]);function Yu(t){return b6.has(Od(t))}function vi(t){return Ls(t).getComputedStyle(t)}function Wy(t){return yi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ja(t){if(Od(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Ex(t)&&t.host||so(t);return Ex(e)?e.host:e}function Lk(t){const e=Ja(t);return Yu(e)?t.ownerDocument?t.ownerDocument.body:t.body:to(e)&&em(e)?e:Lk(e)}function bf(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=Lk(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=Ls(s);if(i){const a=u0(o);return e.concat(o,o.visualViewport||[],em(s)?s:[],a&&n?bf(a):[])}return e.concat(s,bf(s,[],n))}function u0(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Mk(t){const e=vi(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=to(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,a=Pg(n)!==i||Pg(r)!==o;return a&&(n=i,r=o),{width:n,height:r,$:a}}function IE(t){return yi(t)?t:t.contextElement}function Au(t){const e=IE(t);if(!to(e))return Qi(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=Mk(e);let o=(i?Pg(n.width):n.width)/r,a=(i?Pg(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const E6=Qi(0);function Vk(t){const e=Ls(t);return!SE()||!e.visualViewport?E6:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function S6(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ls(t)?!1:e}function dc(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=IE(t);let o=Qi(1);e&&(r?yi(r)&&(o=Au(r)):o=Au(t));const a=S6(i,n,r)?Vk(i):Qi(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,d=s.height/o.y;if(i){const m=Ls(i),p=r&&yi(r)?Ls(r):r;let v=m,g=u0(v);for(;g&&r&&p!==v;){const E=Au(g),b=g.getBoundingClientRect(),_=vi(g),S=b.left+(g.clientLeft+parseFloat(_.paddingLeft))*E.x,P=b.top+(g.clientTop+parseFloat(_.paddingTop))*E.y;l*=E.x,c*=E.y,u*=E.x,d*=E.y,l+=S,c+=P,v=Ls(g),g=u0(v)}}return Cg({width:u,height:d,x:l,y:c})}function qy(t,e){const n=Wy(t).scrollLeft;return e?e.left+n:dc(so(t)).left+n}function jk(t,e){const n=t.getBoundingClientRect(),r=n.left+e.scrollLeft-qy(t,n),s=n.top+e.scrollTop;return{x:r,y:s}}function I6(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=so(r),a=e?zy(e.floating):!1;if(r===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},c=Qi(1);const u=Qi(0),d=to(r);if((d||!d&&!i)&&((Od(r)!=="body"||em(o))&&(l=Wy(r)),to(r))){const p=dc(r);c=Au(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}const m=o&&!d&&!i?jk(o,l):Qi(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+m.x,y:n.y*c.y-l.scrollTop*c.y+u.y+m.y}}function T6(t){return Array.from(t.getClientRects())}function x6(t){const e=so(t),n=Wy(t),r=t.ownerDocument.body,s=Ns(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Ns(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+qy(t);const a=-n.scrollTop;return vi(r).direction==="rtl"&&(o+=Ns(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:a}}const Sx=25;function A6(t,e){const n=Ls(t),r=so(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const u=SE();(!u||u&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}const c=qy(r);if(c<=0){const u=r.ownerDocument,d=u.body,m=getComputedStyle(d),p=u.compatMode==="CSS1Compat"&&parseFloat(m.marginLeft)+parseFloat(m.marginRight)||0,v=Math.abs(r.clientWidth-d.clientWidth-p);v<=Sx&&(i-=v)}else c<=Sx&&(i+=c);return{width:i,height:o,x:a,y:l}}const P6=new Set(["absolute","fixed"]);function R6(t,e){const n=dc(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=to(t)?Au(t):Qi(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:o,height:a,x:l,y:c}}function Ix(t,e,n){let r;if(e==="viewport")r=A6(t,n);else if(e==="document")r=x6(so(t));else if(yi(e))r=R6(e,n);else{const s=Vk(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Cg(r)}function Fk(t,e){const n=Ja(t);return n===e||!yi(n)||Yu(n)?!1:vi(n).position==="fixed"||Fk(n,e)}function C6(t,e){const n=e.get(t);if(n)return n;let r=bf(t,[],!1).filter(a=>yi(a)&&Od(a)!=="body"),s=null;const i=vi(t).position==="fixed";let o=i?Ja(t):t;for(;yi(o)&&!Yu(o);){const a=vi(o),l=EE(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&P6.has(s.position)||em(o)&&!l&&Fk(t,o))?r=r.filter(u=>u!==o):s=a,o=Ja(o)}return e.set(t,r),r}function N6(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?zy(e)?[]:C6(e,this._c):[].concat(n),r],a=o[0],l=o.reduce((c,u)=>{const d=Ix(e,u,s);return c.top=Ns(d.top,c.top),c.right=Ya(d.right,c.right),c.bottom=Ya(d.bottom,c.bottom),c.left=Ns(d.left,c.left),c},Ix(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function k6(t){const{width:e,height:n}=Mk(t);return{width:e,height:n}}function D6(t,e,n){const r=to(e),s=so(e),i=n==="fixed",o=dc(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=Qi(0);function c(){l.x=qy(s)}if(r||!r&&!i)if((Od(e)!=="body"||em(s))&&(a=Wy(e)),r){const p=dc(e,!0,i,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else s&&c();i&&!r&&s&&c();const u=s&&!r&&!i?jk(s,a):Qi(0),d=o.left+a.scrollLeft-l.x-u.x,m=o.top+a.scrollTop-l.y-u.y;return{x:d,y:m,width:o.width,height:o.height}}function Tw(t){return vi(t).position==="static"}function Tx(t,e){if(!to(t)||vi(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return so(t)===n&&(n=n.ownerDocument.body),n}function Uk(t,e){const n=Ls(t);if(zy(t))return n;if(!to(t)){let s=Ja(t);for(;s&&!Yu(s);){if(yi(s)&&!Tw(s))return s;s=Ja(s)}return n}let r=Tx(t,e);for(;r&&p6(r)&&Tw(r);)r=Tx(r,e);return r&&Yu(r)&&Tw(r)&&!EE(r)?n:r||_6(t)||n}const O6=async function(t){const e=this.getOffsetParent||Uk,n=this.getDimensions,r=await n(t.floating);return{reference:D6(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function L6(t){return vi(t).direction==="rtl"}const M6={convertOffsetParentRelativeRectToViewportRelativeRect:I6,getDocumentElement:so,getClippingRect:N6,getOffsetParent:Uk,getElementRects:O6,getClientRects:T6,getDimensions:k6,getScale:Au,isElement:yi,isRTL:L6};function $k(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function V6(t,e){let n=null,r;const s=so(t);function i(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:d,width:m,height:p}=c;if(a||e(),!m||!p)return;const v=Ym(d),g=Ym(s.clientWidth-(u+m)),E=Ym(s.clientHeight-(d+p)),b=Ym(u),S={rootMargin:-v+"px "+-g+"px "+-E+"px "+-b+"px",threshold:Ns(0,Ya(1,l))||1};let P=!0;function T(N){const I=N[0].intersectionRatio;if(I!==l){if(!P)return o();I?o(!1,I):r=setTimeout(()=>{o(!1,1e-7)},1e3)}I===1&&!$k(c,t.getBoundingClientRect())&&o(),P=!1}try{n=new IntersectionObserver(T,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(T,S)}n.observe(t)}return o(!0),i}function j6(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=IE(t),u=s||i?[...c?bf(c):[],...bf(e)]:[];u.forEach(b=>{s&&b.addEventListener("scroll",n,{passive:!0}),i&&b.addEventListener("resize",n)});const d=c&&a?V6(c,n):null;let m=-1,p=null;o&&(p=new ResizeObserver(b=>{let[_]=b;_&&_.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var S;(S=p)==null||S.observe(e)})),n()}),c&&!l&&p.observe(c),p.observe(e));let v,g=l?dc(t):null;l&&E();function E(){const b=dc(t);g&&!$k(g,b)&&n(),g=b,v=requestAnimationFrame(E)}return n(),()=>{var b;u.forEach(_=>{s&&_.removeEventListener("scroll",n),i&&_.removeEventListener("resize",n)}),d==null||d(),(b=p)==null||b.disconnect(),p=null,l&&cancelAnimationFrame(v)}}const F6=c6,U6=u6,$6=o6,B6=h6,z6=a6,xx=i6,W6=d6,q6=(t,e,n)=>{const r=new Map,s={platform:M6,...n},i={...s.platform,_c:r};return s6(t,e,{...s,platform:i})};var H6=typeof document<"u",K6=function(){},Lp=H6?y.useLayoutEffect:K6;function Ng(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Ng(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!Ng(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function Bk(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Ax(t,e){const n=Bk(t);return Math.round(e*n)/n}function xw(t){const e=y.useRef(t);return Lp(()=>{e.current=t}),e}function G6(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,d]=y.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[m,p]=y.useState(r);Ng(m,r)||p(r);const[v,g]=y.useState(null),[E,b]=y.useState(null),_=y.useCallback(W=>{W!==N.current&&(N.current=W,g(W))},[]),S=y.useCallback(W=>{W!==I.current&&(I.current=W,b(W))},[]),P=i||v,T=o||E,N=y.useRef(null),I=y.useRef(null),A=y.useRef(u),R=l!=null,k=xw(l),C=xw(s),L=xw(c),O=y.useCallback(()=>{if(!N.current||!I.current)return;const W={placement:e,strategy:n,middleware:m};C.current&&(W.platform=C.current),q6(N.current,I.current,W).then(G=>{const ae={...G,isPositioned:L.current!==!1};X.current&&!Ng(A.current,ae)&&(A.current=ae,Jf.flushSync(()=>{d(ae)}))})},[m,e,n,C,L]);Lp(()=>{c===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,d(W=>({...W,isPositioned:!1})))},[c]);const X=y.useRef(!1);Lp(()=>(X.current=!0,()=>{X.current=!1}),[]),Lp(()=>{if(P&&(N.current=P),T&&(I.current=T),P&&T){if(k.current)return k.current(P,T,O);O()}},[P,T,O,k,R]);const ke=y.useMemo(()=>({reference:N,floating:I,setReference:_,setFloating:S}),[_,S]),Oe=y.useMemo(()=>({reference:P,floating:T}),[P,T]),je=y.useMemo(()=>{const W={position:n,left:0,top:0};if(!Oe.floating)return W;const G=Ax(Oe.floating,u.x),ae=Ax(Oe.floating,u.y);return a?{...W,transform:"translate("+G+"px, "+ae+"px)",...Bk(Oe.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:G,top:ae}},[n,a,Oe.floating,u.x,u.y]);return y.useMemo(()=>({...u,update:O,refs:ke,elements:Oe,floatingStyles:je}),[u,O,ke,Oe,je])}const Q6=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?xx({element:r.current,padding:s}).fn(n):{}:r?xx({element:r,padding:s}).fn(n):{}}}},Y6=(t,e)=>({...F6(t),options:[t,e]}),J6=(t,e)=>({...U6(t),options:[t,e]}),X6=(t,e)=>({...W6(t),options:[t,e]}),Z6=(t,e)=>({...$6(t),options:[t,e]}),eB=(t,e)=>({...B6(t),options:[t,e]}),tB=(t,e)=>({...z6(t),options:[t,e]}),nB=(t,e)=>({...Q6(t),options:[t,e]});var rB="Arrow",zk=y.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return f.jsx(wn.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});zk.displayName=rB;var sB=zk;function Wk(t){const[e,n]=y.useState(void 0);return eo(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var TE="Popper",[qk,Hk]=Ac(TE),[iB,Kk]=qk(TE),Gk=t=>{const{__scopePopper:e,children:n}=t,[r,s]=y.useState(null);return f.jsx(iB,{scope:e,anchor:r,onAnchorChange:s,children:n})};Gk.displayName=TE;var Qk="PopperAnchor",Yk=y.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=Kk(Qk,n),o=y.useRef(null),a=Kn(e,o),l=y.useRef(null);return y.useEffect(()=>{const c=l.current;l.current=(r==null?void 0:r.current)||o.current,c!==l.current&&i.onAnchorChange(l.current)}),r?null:f.jsx(wn.div,{...s,ref:a})});Yk.displayName=Qk;var xE="PopperContent",[oB,aB]=qk(xE),Jk=y.forwardRef((t,e)=>{var qe,cn,cr,Yn,tr,Nr;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:m=!1,updatePositionStrategy:p="optimized",onPlaced:v,...g}=t,E=Kk(xE,n),[b,_]=y.useState(null),S=Kn(e,kr=>_(kr)),[P,T]=y.useState(null),N=Wk(P),I=(N==null?void 0:N.width)??0,A=(N==null?void 0:N.height)??0,R=r+(i!=="center"?"-"+i:""),k=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},C=Array.isArray(c)?c:[c],L=C.length>0,O={padding:k,boundary:C.filter(cB),altBoundary:L},{refs:X,floatingStyles:ke,placement:Oe,isPositioned:je,middlewareData:W}=G6({strategy:"fixed",placement:R,whileElementsMounted:(...kr)=>j6(...kr,{animationFrame:p==="always"}),elements:{reference:E.anchor},middleware:[Y6({mainAxis:s+A,alignmentAxis:o}),l&&J6({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?X6():void 0,...O}),l&&Z6({...O}),eB({...O,apply:({elements:kr,rects:Dr,availableWidth:J,availableHeight:ue})=>{const{width:Ee,height:et}=Dr.reference,he=kr.floating.style;he.setProperty("--radix-popper-available-width",`${J}px`),he.setProperty("--radix-popper-available-height",`${ue}px`),he.setProperty("--radix-popper-anchor-width",`${Ee}px`),he.setProperty("--radix-popper-anchor-height",`${et}px`)}}),P&&nB({element:P,padding:a}),uB({arrowWidth:I,arrowHeight:A}),m&&tB({strategy:"referenceHidden",...O})]}),[G,ae]=eD(Oe),pe=jr(v);eo(()=>{je&&(pe==null||pe())},[je,pe]);const fe=(qe=W.arrow)==null?void 0:qe.x,Ge=(cn=W.arrow)==null?void 0:cn.y,xe=((cr=W.arrow)==null?void 0:cr.centerOffset)!==0,[ve,Q]=y.useState();return eo(()=>{b&&Q(window.getComputedStyle(b).zIndex)},[b]),f.jsx("div",{ref:X.setFloating,"data-radix-popper-content-wrapper":"",style:{...ke,transform:je?ke.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ve,"--radix-popper-transform-origin":[(Yn=W.transformOrigin)==null?void 0:Yn.x,(tr=W.transformOrigin)==null?void 0:tr.y].join(" "),...((Nr=W.hide)==null?void 0:Nr.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:f.jsx(oB,{scope:n,placedSide:G,onArrowChange:T,arrowX:fe,arrowY:Ge,shouldHideArrow:xe,children:f.jsx(wn.div,{"data-side":G,"data-align":ae,...g,ref:S,style:{...g.style,animation:je?void 0:"none"}})})})});Jk.displayName=xE;var Xk="PopperArrow",lB={top:"bottom",right:"left",bottom:"top",left:"right"},Zk=y.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=aB(Xk,r),o=lB[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(sB,{...s,ref:n,style:{...s.style,display:"block"}})})});Zk.displayName=Xk;function cB(t){return t!==null}var uB=t=>({name:"transformOrigin",options:t,fn(e){var E,b,_;const{placement:n,rects:r,middlewareData:s}=e,o=((E=s.arrow)==null?void 0:E.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=eD(n),d={start:"0%",center:"50%",end:"100%"}[u],m=(((b=s.arrow)==null?void 0:b.x)??0)+a/2,p=(((_=s.arrow)==null?void 0:_.y)??0)+l/2;let v="",g="";return c==="bottom"?(v=o?d:`${m}px`,g=`${-l}px`):c==="top"?(v=o?d:`${m}px`,g=`${r.floating.height+l}px`):c==="right"?(v=`${-l}px`,g=o?d:`${p}px`):c==="left"&&(v=`${r.floating.width+l}px`,g=o?d:`${p}px`),{data:{x:v,y:g}}}});function eD(t){const[e,n="center"]=t.split("-");return[e,n]}var Dte=Gk,dB=Yk,hB=Jk,fB=Zk,mB=Symbol("radix.slottable");function pB(t){const e=({children:n})=>f.jsx(f.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=mB,e}var[Hy]=Ac("Tooltip",[Hk]),AE=Hk(),tD="TooltipProvider",gB=700,Px="tooltip.open",[yB,nD]=Hy(tD),rD=t=>{const{__scopeTooltip:e,delayDuration:n=gB,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=t,o=y.useRef(!0),a=y.useRef(!1),l=y.useRef(0);return y.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),f.jsx(yB,{scope:e,isOpenDelayedRef:o,delayDuration:n,onOpen:y.useCallback(()=>{window.clearTimeout(l.current),o.current=!1},[]),onClose:y.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.current=!0,r)},[r]),isPointerInTransitRef:a,onPointerInTransitChange:y.useCallback(c=>{a.current=c},[]),disableHoverableContent:s,children:i})};rD.displayName=tD;var sD="Tooltip",[Ote,Ky]=Hy(sD),d0="TooltipTrigger",vB=y.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=Ky(d0,n),i=nD(d0,n),o=AE(n),a=y.useRef(null),l=Kn(e,a,s.onTriggerChange),c=y.useRef(!1),u=y.useRef(!1),d=y.useCallback(()=>c.current=!1,[]);return y.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),f.jsx(dB,{asChild:!0,...o,children:f.jsx(wn.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:Zt(t.onPointerMove,m=>{m.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Zt(t.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Zt(t.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Zt(t.onFocus,()=>{c.current||s.onOpen()}),onBlur:Zt(t.onBlur,s.onClose),onClick:Zt(t.onClick,s.onClose)})})});vB.displayName=d0;var wB="TooltipPortal",[Lte,_B]=Hy(wB,{forceMount:void 0}),Ju="TooltipContent",iD=y.forwardRef((t,e)=>{const n=_B(Ju,t.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=t,o=Ky(Ju,t.__scopeTooltip);return f.jsx(Si,{present:r||o.open,children:o.disableHoverableContent?f.jsx(oD,{side:s,...i,ref:e}):f.jsx(bB,{side:s,...i,ref:e})})}),bB=y.forwardRef((t,e)=>{const n=Ky(Ju,t.__scopeTooltip),r=nD(Ju,t.__scopeTooltip),s=y.useRef(null),i=Kn(e,s),[o,a]=y.useState(null),{trigger:l,onClose:c}=n,u=s.current,{onPointerInTransitChange:d}=r,m=y.useCallback(()=>{a(null),d(!1)},[d]),p=y.useCallback((v,g)=>{const E=v.currentTarget,b={x:v.clientX,y:v.clientY},_=xB(b,E.getBoundingClientRect()),S=AB(b,_),P=PB(g.getBoundingClientRect()),T=CB([...S,...P]);a(T),d(!0)},[d]);return y.useEffect(()=>()=>m(),[m]),y.useEffect(()=>{if(l&&u){const v=E=>p(E,u),g=E=>p(E,l);return l.addEventListener("pointerleave",v),u.addEventListener("pointerleave",g),()=>{l.removeEventListener("pointerleave",v),u.removeEventListener("pointerleave",g)}}},[l,u,p,m]),y.useEffect(()=>{if(o){const v=g=>{const E=g.target,b={x:g.clientX,y:g.clientY},_=(l==null?void 0:l.contains(E))||(u==null?void 0:u.contains(E)),S=!RB(b,o);_?m():S&&(m(),c())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[l,u,o,c,m]),f.jsx(oD,{...t,ref:i})}),[EB,SB]=Hy(sD,{isInside:!1}),IB=pB("TooltipContent"),oD=y.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=Ky(Ju,n),c=AE(n),{onClose:u}=l;return y.useEffect(()=>(document.addEventListener(Px,u),()=>document.removeEventListener(Px,u)),[u]),y.useEffect(()=>{if(l.trigger){const d=m=>{const p=m.target;p!=null&&p.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),f.jsx(Vy,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:f.jsxs(hB,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(IB,{children:r}),f.jsx(EB,{scope:n,isInside:!0,children:f.jsx(e3,{id:l.contentId,role:"tooltip",children:s||r})})]})})});iD.displayName=Ju;var aD="TooltipArrow",TB=y.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=AE(n);return SB(aD,n).isInside?null:f.jsx(fB,{...s,...r,ref:e})});TB.displayName=aD;function xB(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function AB(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function PB(t){const{top:e,right:n,bottom:r,left:s}=t;return[{x:s,y:e},{x:n,y:e},{x:n,y:r},{x:s,y:r}]}function RB(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,d=l.x,m=l.y;u>r!=m>r&&n<(d-c)*(r-u)/(m-u)+c&&(s=!s)}return s}function CB(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),NB(e)}function NB(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const s=t[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const s=t[r];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))n.pop();else break}n.push(s)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var kB=rD,lD=iD;const DB=kB,OB=y.forwardRef(({className:t,sideOffset:e=4,...n},r)=>f.jsx(lD,{ref:r,sideOffset:e,className:yn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));OB.displayName=lD.displayName;var Gy=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},LB={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},_a,fb,aR,MB=(aR=class{constructor(){Gt(this,_a,LB);Gt(this,fb,!1)}setTimeoutProvider(t){St(this,_a,t)}setTimeout(t,e){return re(this,_a).setTimeout(t,e)}clearTimeout(t){re(this,_a).clearTimeout(t)}setInterval(t,e){return re(this,_a).setInterval(t,e)}clearInterval(t){re(this,_a).clearInterval(t)}},_a=new WeakMap,fb=new WeakMap,aR),kg=new MB;function VB(t){setTimeout(t,0)}var Qy=typeof window>"u"||"Deno"in globalThis;function rs(){}function jB(t,e){return typeof t=="function"?t(e):t}function FB(t){return typeof t=="number"&&t>=0&&t!==1/0}function UB(t,e){return Math.max(t+(e||0)-Date.now(),0)}function h0(t,e){return typeof t=="function"?t(e):t}function $B(t,e){return typeof t=="function"?t(e):t}function Rx(t,e){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:a}=t;if(o){if(r){if(e.queryHash!==PE(o,e.options))return!1}else if(!Sf(e.queryKey,o))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||s&&s!==e.state.fetchStatus||i&&!i(e))}function Cx(t,e){const{exact:n,status:r,predicate:s,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(Ef(e.options.mutationKey)!==Ef(i))return!1}else if(!Sf(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function PE(t,e){return((e==null?void 0:e.queryKeyHashFn)||Ef)(t)}function Ef(t){return JSON.stringify(t,(e,n)=>f0(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Sf(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Sf(t[n],e[n])):!1}var BB=Object.prototype.hasOwnProperty;function cD(t,e){if(t===e)return t;const n=Nx(t)&&Nx(e);if(!n&&!(f0(t)&&f0(e)))return e;const s=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),o=i.length,a=n?new Array(o):{};let l=0;for(let c=0;c<o;c++){const u=n?c:i[c],d=t[u],m=e[u];if(d===m){a[u]=d,(n?c<s:BB.call(t,u))&&l++;continue}if(d===null||m===null||typeof d!="object"||typeof m!="object"){a[u]=m;continue}const p=cD(d,m);a[u]=p,p===d&&l++}return s===o&&l===s?t:a}function Mte(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Nx(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function f0(t){if(!kx(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!kx(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function kx(t){return Object.prototype.toString.call(t)==="[object Object]"}function zB(t){return new Promise(e=>{kg.setTimeout(e,t)})}function WB(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?cD(t,e):e}function qB(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function HB(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var RE=Symbol();function uD(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===RE?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function Vte(t,e){return typeof t=="function"?t(...e):!!t}function KB(t,e,n){let r=!1,s;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(s??(s=e()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),t}var Kl,ba,Lu,lR,GB=(lR=class extends Gy{constructor(){super();Gt(this,Kl);Gt(this,ba);Gt(this,Lu);St(this,Lu,e=>{if(!Qy&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){re(this,ba)||this.setEventListener(re(this,Lu))}onUnsubscribe(){var e;this.hasListeners()||((e=re(this,ba))==null||e.call(this),St(this,ba,void 0))}setEventListener(e){var n;St(this,Lu,e),(n=re(this,ba))==null||n.call(this),St(this,ba,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){re(this,Kl)!==e&&(St(this,Kl,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof re(this,Kl)=="boolean"?re(this,Kl):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Kl=new WeakMap,ba=new WeakMap,Lu=new WeakMap,lR),dD=new GB;function QB(){let t,e;const n=new Promise((s,i)=>{t=s,e=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),t(s)},n.reject=s=>{r({status:"rejected",reason:s}),e(s)},n}function YB(t){var n;let e;if((n=t.then(r=>(e=r,r),rs))==null||n.catch(rs),e!==void 0)return{data:e}}function hD(t){return t}function JB(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function XB(t,e,n){const r=()=>{var i;const s=(i=t.promise)==null?void 0:i.then(e).catch(o=>n(o)?Promise.reject(new Error("redacted")):Promise.reject(o));return s==null||s.catch(rs),s};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:r()},...t.meta&&{meta:t.meta}}}function ZB(t){return t.state.isPaused}function e9(t){return t.state.status==="success"}function t9(t){return!0}function n9(t,e={}){var l,c,u,d;const n=e.shouldDehydrateMutation??((l=t.getDefaultOptions().dehydrate)==null?void 0:l.shouldDehydrateMutation)??ZB,r=t.getMutationCache().getAll().flatMap(m=>n(m)?[JB(m)]:[]),s=e.shouldDehydrateQuery??((c=t.getDefaultOptions().dehydrate)==null?void 0:c.shouldDehydrateQuery)??e9,i=e.shouldRedactErrors??((u=t.getDefaultOptions().dehydrate)==null?void 0:u.shouldRedactErrors)??t9,o=e.serializeData??((d=t.getDefaultOptions().dehydrate)==null?void 0:d.serializeData)??hD,a=t.getQueryCache().getAll().flatMap(m=>s(m)?[XB(m,o,i)]:[]);return{mutations:r,queries:a}}function r9(t,e,n){var l,c;if(typeof e!="object"||e===null)return;const r=t.getMutationCache(),s=t.getQueryCache(),i=((l=n==null?void 0:n.defaultOptions)==null?void 0:l.deserializeData)??((c=t.getDefaultOptions().hydrate)==null?void 0:c.deserializeData)??hD,o=e.mutations||[],a=e.queries||[];o.forEach(({state:u,...d})=>{var m,p;r.build(t,{...(m=t.getDefaultOptions().hydrate)==null?void 0:m.mutations,...(p=n==null?void 0:n.defaultOptions)==null?void 0:p.mutations,...d},u)}),a.forEach(({queryKey:u,state:d,queryHash:m,meta:p,promise:v,dehydratedAt:g})=>{var N,I;const E=v?YB(v):void 0,b=d.data===void 0?E==null?void 0:E.data:d.data,_=b===void 0?b:i(b);let S=s.get(m);const P=(S==null?void 0:S.state.status)==="pending",T=(S==null?void 0:S.state.fetchStatus)==="fetching";if(S){const A=E&&g!==void 0&&g>S.state.dataUpdatedAt;if(d.dataUpdatedAt>S.state.dataUpdatedAt||A){const{fetchStatus:R,...k}=d;S.setState({...k,data:_})}}else S=s.build(t,{...(N=t.getDefaultOptions().hydrate)==null?void 0:N.queries,...(I=n==null?void 0:n.defaultOptions)==null?void 0:I.queries,queryKey:u,queryHash:m,meta:p},{...d,data:_,fetchStatus:"idle",status:_!==void 0?"success":d.status});v&&!P&&!T&&(g===void 0||g>S.state.dataUpdatedAt)&&S.fetch(void 0,{initialPromise:Promise.resolve(v).then(i)}).catch(rs)})}var s9=VB;function i9(){let t=[],e=0,n=a=>{a()},r=a=>{a()},s=s9;const i=a=>{e?t.push(a):s(()=>{n(a)})},o=()=>{const a=t;t=[],a.length&&s(()=>{r(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{s=a}}}var ss=i9(),Mu,Ea,Vu,cR,o9=(cR=class extends Gy{constructor(){super();Gt(this,Mu,!0);Gt(this,Ea);Gt(this,Vu);St(this,Vu,e=>{if(!Qy&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){re(this,Ea)||this.setEventListener(re(this,Vu))}onUnsubscribe(){var e;this.hasListeners()||((e=re(this,Ea))==null||e.call(this),St(this,Ea,void 0))}setEventListener(e){var n;St(this,Vu,e),(n=re(this,Ea))==null||n.call(this),St(this,Ea,e(this.setOnline.bind(this)))}setOnline(e){re(this,Mu)!==e&&(St(this,Mu,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return re(this,Mu)}},Mu=new WeakMap,Ea=new WeakMap,Vu=new WeakMap,cR),Dg=new o9;function a9(t){return Math.min(1e3*2**t,3e4)}function fD(t){return(t??"online")==="online"?Dg.isOnline():!0}var m0=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function mD(t){let e=!1,n=0,r;const s=QB(),i=()=>s.status!=="pending",o=g=>{var E;if(!i()){const b=new m0(g);m(b),(E=t.onCancel)==null||E.call(t,b)}},a=()=>{e=!0},l=()=>{e=!1},c=()=>dD.isFocused()&&(t.networkMode==="always"||Dg.isOnline())&&t.canRun(),u=()=>fD(t.networkMode)&&t.canRun(),d=g=>{i()||(r==null||r(),s.resolve(g))},m=g=>{i()||(r==null||r(),s.reject(g))},p=()=>new Promise(g=>{var E;r=b=>{(i()||c())&&g(b)},(E=t.onPause)==null||E.call(t)}).then(()=>{var g;r=void 0,i()||(g=t.onContinue)==null||g.call(t)}),v=()=>{if(i())return;let g;const E=n===0?t.initialPromise:void 0;try{g=E??t.fn()}catch(b){g=Promise.reject(b)}Promise.resolve(g).then(d).catch(b=>{var N;if(i())return;const _=t.retry??(Qy?0:3),S=t.retryDelay??a9,P=typeof S=="function"?S(n,b):S,T=_===!0||typeof _=="number"&&n<_||typeof _=="function"&&_(n,b);if(e||!T){m(b);return}n++,(N=t.onFail)==null||N.call(t,n,b),zB(P).then(()=>c()?void 0:p()).then(()=>{e?m(b):v()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?v():p().then(v),s)}}var Gl,uR,pD=(uR=class{constructor(){Gt(this,Gl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),FB(this.gcTime)&&St(this,Gl,kg.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Qy?1/0:5*60*1e3))}clearGcTimeout(){re(this,Gl)&&(kg.clearTimeout(re(this,Gl)),St(this,Gl,void 0))}},Gl=new WeakMap,uR),Ql,ju,zs,Yl,Ir,zf,Jl,oi,fo,dR,l9=(dR=class extends pD{constructor(n){super();Gt(this,oi);Gt(this,Ql);Gt(this,ju);Gt(this,zs);Gt(this,Yl);Gt(this,Ir);Gt(this,zf);Gt(this,Jl);St(this,Jl,!1),St(this,zf,n.defaultOptions),this.setOptions(n.options),this.observers=[],St(this,Yl,n.client),St(this,zs,re(this,Yl).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,St(this,Ql,Ox(this.options)),this.state=n.state??re(this,Ql),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=re(this,Ir))==null?void 0:n.promise}setOptions(n){if(this.options={...re(this,zf),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Ox(this.options);r.data!==void 0&&(this.setState(Dx(r.data,r.dataUpdatedAt)),St(this,Ql,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&re(this,zs).remove(this)}setData(n,r){const s=WB(this.state.data,n,this.options);return Wr(this,oi,fo).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(n,r){Wr(this,oi,fo).call(this,{type:"setState",state:n,setStateOptions:r})}cancel(n){var s,i;const r=(s=re(this,Ir))==null?void 0:s.promise;return(i=re(this,Ir))==null||i.cancel(n),r?r.then(rs).catch(rs):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(re(this,Ql))}isActive(){return this.observers.some(n=>$B(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===RE||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>h0(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!UB(this.state.dataUpdatedAt,n)}onFocus(){var r;const n=this.observers.find(s=>s.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(r=re(this,Ir))==null||r.continue()}onOnline(){var r;const n=this.observers.find(s=>s.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(r=re(this,Ir))==null||r.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),re(this,zs).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(r=>r!==n),this.observers.length||(re(this,Ir)&&(re(this,Jl)?re(this,Ir).cancel({revert:!0}):re(this,Ir).cancelRetry()),this.scheduleGc()),re(this,zs).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Wr(this,oi,fo).call(this,{type:"invalidate"})}async fetch(n,r){var c,u,d,m,p,v,g,E,b,_,S,P;if(this.state.fetchStatus!=="idle"&&((c=re(this,Ir))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(re(this,Ir))return re(this,Ir).continueRetry(),re(this,Ir).promise}if(n&&this.setOptions(n),!this.options.queryFn){const T=this.observers.find(N=>N.options.queryFn);T&&this.setOptions(T.options)}const s=new AbortController,i=T=>{Object.defineProperty(T,"signal",{enumerable:!0,get:()=>(St(this,Jl,!0),s.signal)})},o=()=>{const T=uD(this.options,r),I=(()=>{const A={client:re(this,Yl),queryKey:this.queryKey,meta:this.meta};return i(A),A})();return St(this,Jl,!1),this.options.persister?this.options.persister(T,I,this):T(I)},l=(()=>{const T={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:re(this,Yl),state:this.state,fetchFn:o};return i(T),T})();(u=this.options.behavior)==null||u.onFetch(l,this),St(this,ju,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=l.fetchOptions)==null?void 0:d.meta))&&Wr(this,oi,fo).call(this,{type:"fetch",meta:(m=l.fetchOptions)==null?void 0:m.meta}),St(this,Ir,mD({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,onCancel:T=>{T instanceof m0&&T.revert&&this.setState({...re(this,ju),fetchStatus:"idle"}),s.abort()},onFail:(T,N)=>{Wr(this,oi,fo).call(this,{type:"failed",failureCount:T,error:N})},onPause:()=>{Wr(this,oi,fo).call(this,{type:"pause"})},onContinue:()=>{Wr(this,oi,fo).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const T=await re(this,Ir).start();if(T===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(T),(v=(p=re(this,zs).config).onSuccess)==null||v.call(p,T,this),(E=(g=re(this,zs).config).onSettled)==null||E.call(g,T,this.state.error,this),T}catch(T){if(T instanceof m0){if(T.silent)return re(this,Ir).promise;if(T.revert){if(this.state.data===void 0)throw T;return this.state.data}}throw Wr(this,oi,fo).call(this,{type:"error",error:T}),(_=(b=re(this,zs).config).onError)==null||_.call(b,T,this),(P=(S=re(this,zs).config).onSettled)==null||P.call(S,this.state.data,T,this),T}finally{this.scheduleGc()}}},Ql=new WeakMap,ju=new WeakMap,zs=new WeakMap,Yl=new WeakMap,Ir=new WeakMap,zf=new WeakMap,Jl=new WeakMap,oi=new WeakSet,fo=function(n){const r=s=>{switch(n.type){case"failed":return{...s,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...c9(s.data,this.options),fetchMeta:n.meta??null};case"success":const i={...s,...Dx(n.data,n.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return St(this,ju,n.manual?i:void 0),i;case"error":const o=n.error;return{...s,error:o,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...n.state}}};this.state=r(this.state),ss.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),re(this,zs).notify({query:this,type:"updated",action:n})})},dR);function c9(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:fD(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Dx(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Ox(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}function Lx(t){return{onFetch:(e,n)=>{var u,d,m,p,v;const r=e.options,s=(m=(d=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:m.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],o=((v=e.state.data)==null?void 0:v.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let g=!1;const E=S=>{KB(S,()=>e.signal,()=>g=!0)},b=uD(e.options,e.fetchOptions),_=async(S,P,T)=>{if(g)return Promise.reject();if(P==null&&S.pages.length)return Promise.resolve(S);const I=(()=>{const C={client:e.client,queryKey:e.queryKey,pageParam:P,direction:T?"backward":"forward",meta:e.options.meta};return E(C),C})(),A=await b(I),{maxPages:R}=e.options,k=T?HB:qB;return{pages:k(S.pages,A,R),pageParams:k(S.pageParams,P,R)}};if(s&&i.length){const S=s==="backward",P=S?u9:Mx,T={pages:i,pageParams:o},N=P(r,T);a=await _(T,N,S)}else{const S=t??i.length;do{const P=l===0?o[0]??r.initialPageParam:Mx(r,a);if(l>0&&P==null)break;a=await _(a,P),l++}while(l<S)}return a};e.options.persister?e.fetchFn=()=>{var g,E;return(E=(g=e.options).persister)==null?void 0:E.call(g,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function Mx(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function u9(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var Wf,Mi,ts,Xl,Vi,aa,hR,d9=(hR=class extends pD{constructor(n){super();Gt(this,Vi);Gt(this,Wf);Gt(this,Mi);Gt(this,ts);Gt(this,Xl);St(this,Wf,n.client),this.mutationId=n.mutationId,St(this,ts,n.mutationCache),St(this,Mi,[]),this.state=n.state||h9(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){re(this,Mi).includes(n)||(re(this,Mi).push(n),this.clearGcTimeout(),re(this,ts).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){St(this,Mi,re(this,Mi).filter(r=>r!==n)),this.scheduleGc(),re(this,ts).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){re(this,Mi).length||(this.state.status==="pending"?this.scheduleGc():re(this,ts).remove(this))}continue(){var n;return((n=re(this,Xl))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var a,l,c,u,d,m,p,v,g,E,b,_,S,P,T,N,I,A,R,k;const r=()=>{Wr(this,Vi,aa).call(this,{type:"continue"})},s={client:re(this,Wf),meta:this.options.meta,mutationKey:this.options.mutationKey};St(this,Xl,mD({fn:()=>this.options.mutationFn?this.options.mutationFn(n,s):Promise.reject(new Error("No mutationFn found")),onFail:(C,L)=>{Wr(this,Vi,aa).call(this,{type:"failed",failureCount:C,error:L})},onPause:()=>{Wr(this,Vi,aa).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>re(this,ts).canRun(this)}));const i=this.state.status==="pending",o=!re(this,Xl).canStart();try{if(i)r();else{Wr(this,Vi,aa).call(this,{type:"pending",variables:n,isPaused:o}),await((l=(a=re(this,ts).config).onMutate)==null?void 0:l.call(a,n,this,s));const L=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,n,s));L!==this.state.context&&Wr(this,Vi,aa).call(this,{type:"pending",context:L,variables:n,isPaused:o})}const C=await re(this,Xl).start();return await((m=(d=re(this,ts).config).onSuccess)==null?void 0:m.call(d,C,n,this.state.context,this,s)),await((v=(p=this.options).onSuccess)==null?void 0:v.call(p,C,n,this.state.context,s)),await((E=(g=re(this,ts).config).onSettled)==null?void 0:E.call(g,C,null,this.state.variables,this.state.context,this,s)),await((_=(b=this.options).onSettled)==null?void 0:_.call(b,C,null,n,this.state.context,s)),Wr(this,Vi,aa).call(this,{type:"success",data:C}),C}catch(C){try{await((P=(S=re(this,ts).config).onError)==null?void 0:P.call(S,C,n,this.state.context,this,s))}catch(L){Promise.reject(L)}try{await((N=(T=this.options).onError)==null?void 0:N.call(T,C,n,this.state.context,s))}catch(L){Promise.reject(L)}try{await((A=(I=re(this,ts).config).onSettled)==null?void 0:A.call(I,void 0,C,this.state.variables,this.state.context,this,s))}catch(L){Promise.reject(L)}try{await((k=(R=this.options).onSettled)==null?void 0:k.call(R,void 0,C,n,this.state.context,s))}catch(L){Promise.reject(L)}throw Wr(this,Vi,aa).call(this,{type:"error",error:C}),C}finally{re(this,ts).runNext(this)}}},Wf=new WeakMap,Mi=new WeakMap,ts=new WeakMap,Xl=new WeakMap,Vi=new WeakSet,aa=function(n){const r=s=>{switch(n.type){case"failed":return{...s,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...s,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:n.error,failureCount:s.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=r(this.state),ss.batch(()=>{re(this,Mi).forEach(s=>{s.onMutationUpdate(n)}),re(this,ts).notify({mutation:this,type:"updated",action:n})})},hR);function h9(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var yo,ai,qf,fR,f9=(fR=class extends Gy{constructor(e={}){super();Gt(this,yo);Gt(this,ai);Gt(this,qf);this.config=e,St(this,yo,new Set),St(this,ai,new Map),St(this,qf,0)}build(e,n,r){const s=new d9({client:e,mutationCache:this,mutationId:++Rm(this,qf)._,options:e.defaultMutationOptions(n),state:r});return this.add(s),s}add(e){re(this,yo).add(e);const n=Jm(e);if(typeof n=="string"){const r=re(this,ai).get(n);r?r.push(e):re(this,ai).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(re(this,yo).delete(e)){const n=Jm(e);if(typeof n=="string"){const r=re(this,ai).get(n);if(r)if(r.length>1){const s=r.indexOf(e);s!==-1&&r.splice(s,1)}else r[0]===e&&re(this,ai).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Jm(e);if(typeof n=="string"){const r=re(this,ai).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===e}else return!0}runNext(e){var r;const n=Jm(e);if(typeof n=="string"){const s=(r=re(this,ai).get(n))==null?void 0:r.find(i=>i!==e&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ss.batch(()=>{re(this,yo).forEach(e=>{this.notify({type:"removed",mutation:e})}),re(this,yo).clear(),re(this,ai).clear()})}getAll(){return Array.from(re(this,yo))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Cx(n,r))}findAll(e={}){return this.getAll().filter(n=>Cx(e,n))}notify(e){ss.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return ss.batch(()=>Promise.all(e.map(n=>n.continue().catch(rs))))}},yo=new WeakMap,ai=new WeakMap,qf=new WeakMap,fR);function Jm(t){var e;return(e=t.options.scope)==null?void 0:e.id}var ji,mR,m9=(mR=class extends Gy{constructor(e={}){super();Gt(this,ji);this.config=e,St(this,ji,new Map)}build(e,n,r){const s=n.queryKey,i=n.queryHash??PE(s,n);let o=this.get(i);return o||(o=new l9({client:e,queryKey:s,queryHash:i,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(s)}),this.add(o)),o}add(e){re(this,ji).has(e.queryHash)||(re(this,ji).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=re(this,ji).get(e.queryHash);n&&(e.destroy(),n===e&&re(this,ji).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){ss.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return re(this,ji).get(e)}getAll(){return[...re(this,ji).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Rx(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>Rx(e,r)):n}notify(e){ss.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){ss.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){ss.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},ji=new WeakMap,mR),Zn,Sa,Ia,Fu,Uu,Ta,$u,Bu,pR,p9=(pR=class{constructor(t={}){Gt(this,Zn);Gt(this,Sa);Gt(this,Ia);Gt(this,Fu);Gt(this,Uu);Gt(this,Ta);Gt(this,$u);Gt(this,Bu);St(this,Zn,t.queryCache||new m9),St(this,Sa,t.mutationCache||new f9),St(this,Ia,t.defaultOptions||{}),St(this,Fu,new Map),St(this,Uu,new Map),St(this,Ta,0)}mount(){Rm(this,Ta)._++,re(this,Ta)===1&&(St(this,$u,dD.subscribe(async t=>{t&&(await this.resumePausedMutations(),re(this,Zn).onFocus())})),St(this,Bu,Dg.subscribe(async t=>{t&&(await this.resumePausedMutations(),re(this,Zn).onOnline())})))}unmount(){var t,e;Rm(this,Ta)._--,re(this,Ta)===0&&((t=re(this,$u))==null||t.call(this),St(this,$u,void 0),(e=re(this,Bu))==null||e.call(this),St(this,Bu,void 0))}isFetching(t){return re(this,Zn).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return re(this,Sa).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=re(this,Zn).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=re(this,Zn).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(h0(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return re(this,Zn).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),s=re(this,Zn).get(r.queryHash),i=s==null?void 0:s.state.data,o=jB(e,i);if(o!==void 0)return re(this,Zn).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return ss.batch(()=>re(this,Zn).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=re(this,Zn).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=re(this,Zn);ss.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=re(this,Zn);return ss.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=ss.batch(()=>re(this,Zn).findAll(t).map(s=>s.cancel(n)));return Promise.all(r).then(rs).catch(rs)}invalidateQueries(t,e={}){return ss.batch(()=>(re(this,Zn).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=ss.batch(()=>re(this,Zn).findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(rs)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(rs)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=re(this,Zn).build(this,e);return n.isStaleByTime(h0(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(rs).catch(rs)}fetchInfiniteQuery(t){return t.behavior=Lx(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(rs).catch(rs)}ensureInfiniteQueryData(t){return t.behavior=Lx(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Dg.isOnline()?re(this,Sa).resumePausedMutations():Promise.resolve()}getQueryCache(){return re(this,Zn)}getMutationCache(){return re(this,Sa)}getDefaultOptions(){return re(this,Ia)}setDefaultOptions(t){St(this,Ia,t)}setQueryDefaults(t,e){re(this,Fu).set(Ef(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...re(this,Fu).values()],n={};return e.forEach(r=>{Sf(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){re(this,Uu).set(Ef(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...re(this,Uu).values()],n={};return e.forEach(r=>{Sf(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...re(this,Ia).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=PE(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===RE&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...re(this,Ia).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){re(this,Zn).clear(),re(this,Sa).clear()}},Zn=new WeakMap,Sa=new WeakMap,Ia=new WeakMap,Fu=new WeakMap,Uu=new WeakMap,Ta=new WeakMap,$u=new WeakMap,Bu=new WeakMap,pR),gD=y.createContext(void 0),Ute=t=>{const e=y.useContext(gD);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},g9=({client:t,children:e})=>(y.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),f.jsx(gD.Provider,{value:t,children:e})),y9=["added","removed","updated"];function Vx(t){return y9.includes(t)}async function v9({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:r="",hydrateOptions:s}){try{const i=await e.restoreClient();if(i)if(i.timestamp){const o=Date.now()-i.timestamp>n,a=i.buster!==r;if(o||a)return e.removeClient();r9(t,i.clientState,s)}else return e.removeClient()}catch(i){throw await e.removeClient(),i}}async function jx({queryClient:t,persister:e,buster:n="",dehydrateOptions:r}){const s={buster:n,timestamp:Date.now(),clientState:n9(t,r)};await e.persistClient(s)}function w9(t){const e=t.queryClient.getQueryCache().subscribe(r=>{Vx(r.type)&&jx(t)}),n=t.queryClient.getMutationCache().subscribe(r=>{Vx(r.type)&&jx(t)});return()=>{e(),n()}}function _9(t){let e=!1,n;const r=()=>{e=!0,n==null||n()},s=v9(t).then(()=>{e||(n=w9(t))});return[r,s]}function Aw(){}function b9({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:r=JSON.stringify,deserialize:s=JSON.parse,retry:i}){if(t){const o=a=>{try{t.setItem(e,r(a));return}catch(l){return l}};return{persistClient:E9(a=>{let l=a,c=o(l),u=0;for(;c&&l;)u++,l=i==null?void 0:i({persistedClient:l,error:c,errorCount:u}),l&&(c=o(l))},n),restoreClient:()=>{const a=t.getItem(e);if(a)return s(a)},removeClient:()=>{t.removeItem(e)}}}return{persistClient:Aw,restoreClient:Aw,removeClient:Aw}}function E9(t,e=100){let n=null,r;return function(...s){r=s,n===null&&(n=kg.setTimeout(()=>{t(...r),n=null},e))}}/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function If(){return If=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},If.apply(this,arguments)}var Pa;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Pa||(Pa={}));const Fx="popstate";function S9(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Og("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Tf(s)}return yD(e,n,null,t)}function I9(t){t===void 0&&(t={});function e(s,i){let{pathname:o="/",search:a="",hash:l=""}=Pc(s.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Og("",{pathname:o,search:a,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let o=s.document.querySelector("base"),a="";if(o&&o.getAttribute("href")){let l=s.location.href,c=l.indexOf("#");a=c===-1?l:l.slice(0,c)}return a+"#"+(typeof i=="string"?i:Tf(i))}function r(s,i){Yy(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return yD(e,n,r,t)}function ar(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Yy(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function T9(){return Math.random().toString(36).substr(2,8)}function Ux(t,e){return{usr:t.state,key:t.key,idx:e}}function Og(t,e,n,r){return n===void 0&&(n=null),If({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Pc(e):e,{state:n,key:e&&e.key||r||T9()})}function Tf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Pc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function yD(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=Pa.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(If({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=Pa.Pop;let E=u(),b=E==null?null:E-c;c=E,l&&l({action:a,location:g.location,delta:b})}function m(E,b){a=Pa.Push;let _=Og(g.location,E,b);n&&n(_,E),c=u()+1;let S=Ux(_,c),P=g.createHref(_);try{o.pushState(S,"",P)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;s.location.assign(P)}i&&l&&l({action:a,location:g.location,delta:1})}function p(E,b){a=Pa.Replace;let _=Og(g.location,E,b);n&&n(_,E),c=u();let S=Ux(_,c),P=g.createHref(_);o.replaceState(S,"",P),i&&l&&l({action:a,location:g.location,delta:0})}function v(E){let b=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof E=="string"?E:Tf(E);return _=_.replace(/ $/,"%20"),ar(b,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,b)}let g={get action(){return a},get location(){return t(s,o)},listen(E){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Fx,d),l=E,()=>{s.removeEventListener(Fx,d),l=null}},createHref(E){return e(s,E)},createURL:v,encodeLocation(E){let b=v(E);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:m,replace:p,go(E){return o.go(E)}};return g}var $x;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})($x||($x={}));function x9(t,e,n){return n===void 0&&(n="/"),A9(t,e,n)}function A9(t,e,n,r){let s=typeof e=="string"?Pc(e):e,i=CE(s.pathname||"/",n);if(i==null)return null;let o=vD(t);P9(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=U9(i);a=V9(o[l],c)}return a}function vD(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(ar(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=$a([r,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(ar(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),vD(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:L9(c,i.index),routesMeta:u})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of wD(i.path))s(i,o,l)}),e}function wD(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=wD(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function P9(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:M9(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const R9=/^:[\w-]+$/,C9=3,N9=2,k9=1,D9=10,O9=-2,Bx=t=>t==="*";function L9(t,e){let n=t.split("/"),r=n.length;return n.some(Bx)&&(r+=O9),e&&(r+=N9),n.filter(s=>!Bx(s)).reduce((s,i)=>s+(R9.test(i)?C9:i===""?k9:D9),r)}function M9(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function V9(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",d=j9({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),m=l.route;if(!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:$a([i,d.pathname]),pathnameBase:q9($a([i,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(i=$a([i,d.pathnameBase]))}return o}function j9(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=F9(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,u,d)=>{let{paramName:m,isOptional:p}=u;if(m==="*"){let g=a[d]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const v=a[d];return p&&!v?c[m]=void 0:c[m]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function F9(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Yy(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function U9(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yy(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function CE(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const $9=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,B9=t=>$9.test(t);function z9(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Pc(t):t,i;if(n)if(B9(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Yy(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=zx(n.substring(1),"/"):i=zx(n,e)}else i=e;return{pathname:i,search:H9(r),hash:K9(s)}}function zx(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Pw(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function W9(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function NE(t,e){let n=W9(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function kE(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Pc(t):(s=If({},t),ar(!s.pathname||!s.pathname.includes("?"),Pw("?","pathname","search",s)),ar(!s.pathname||!s.pathname.includes("#"),Pw("#","pathname","hash",s)),ar(!s.search||!s.search.includes("#"),Pw("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),d-=1;s.pathname=m.join("/")}a=d>=0?e[d]:"/"}let l=z9(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const $a=t=>t.join("/").replace(/\/\/+/g,"/"),q9=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),H9=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,K9=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function G9(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _D=["post","put","patch","delete"];new Set(_D);const Q9=["get",..._D];new Set(Q9);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xf(){return xf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xf.apply(this,arguments)}const DE=y.createContext(null),Y9=y.createContext(null),fl=y.createContext(null),Jy=y.createContext(null),io=y.createContext({outlet:null,matches:[],isDataRoute:!1}),bD=y.createContext(null);function J9(t,e){let{relative:n}=e===void 0?{}:e;Ld()||ar(!1);let{basename:r,navigator:s}=y.useContext(fl),{hash:i,pathname:o,search:a}=SD(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:$a([r,o])),s.createHref({pathname:l,search:a,hash:i})}function Ld(){return y.useContext(Jy)!=null}function Ii(){return Ld()||ar(!1),y.useContext(Jy).location}function ED(t){y.useContext(fl).static||y.useLayoutEffect(t)}function oo(){let{isDataRoute:t}=y.useContext(io);return t?hz():X9()}function X9(){Ld()||ar(!1);let t=y.useContext(DE),{basename:e,future:n,navigator:r}=y.useContext(fl),{matches:s}=y.useContext(io),{pathname:i}=Ii(),o=JSON.stringify(NE(s,n.v7_relativeSplatPath)),a=y.useRef(!1);return ED(()=>{a.current=!0}),y.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let d=kE(c,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:$a([e,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[e,r,o,i,t])}const Z9=y.createContext(null);function ez(t){let e=y.useContext(io).outlet;return e&&y.createElement(Z9.Provider,{value:t},e)}function $te(){let{matches:t}=y.useContext(io),e=t[t.length-1];return e?e.params:{}}function SD(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=y.useContext(fl),{matches:s}=y.useContext(io),{pathname:i}=Ii(),o=JSON.stringify(NE(s,r.v7_relativeSplatPath));return y.useMemo(()=>kE(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function tz(t,e){return nz(t,e)}function nz(t,e,n,r){Ld()||ar(!1);let{navigator:s}=y.useContext(fl),{matches:i}=y.useContext(io),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=Ii(),u;if(e){var d;let E=typeof e=="string"?Pc(e):e;l==="/"||(d=E.pathname)!=null&&d.startsWith(l)||ar(!1),u=E}else u=c;let m=u.pathname||"/",p=m;if(l!=="/"){let E=l.replace(/^\//,"").split("/");p="/"+m.replace(/^\//,"").split("/").slice(E.length).join("/")}let v=x9(t,{pathname:p}),g=az(v&&v.map(E=>Object.assign({},E,{params:Object.assign({},a,E.params),pathname:$a([l,s.encodeLocation?s.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?l:$a([l,s.encodeLocation?s.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,n,r);return e&&g?y.createElement(Jy.Provider,{value:{location:xf({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Pa.Pop}},g):g}function rz(){let t=dz(),e=G9(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},e),n?y.createElement("pre",{style:s},n):null,null)}const sz=y.createElement(rz,null);class iz extends y.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?y.createElement(io.Provider,{value:this.props.routeContext},y.createElement(bD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function oz(t){let{routeContext:e,match:n,children:r}=t,s=y.useContext(DE);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),y.createElement(io.Provider,{value:e},r)}function az(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||ar(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:m,errors:p}=n,v=d.route.loader&&m[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||v){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,d,m)=>{let p,v=!1,g=null,E=null;n&&(p=a&&d.route.id?a[d.route.id]:void 0,g=d.route.errorElement||sz,l&&(c<0&&m===0?(fz("route-fallback"),v=!0,E=null):c===m&&(v=!0,E=d.route.hydrateFallbackElement||null)));let b=e.concat(o.slice(0,m+1)),_=()=>{let S;return p?S=g:v?S=E:d.route.Component?S=y.createElement(d.route.Component,null):d.route.element?S=d.route.element:S=u,y.createElement(oz,{match:d,routeContext:{outlet:u,matches:b,isDataRoute:n!=null},children:S})};return n&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?y.createElement(iz,{location:n.location,revalidation:n.revalidation,component:g,error:p,children:_(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):_()},null)}var ID=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(ID||{}),TD=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(TD||{});function lz(t){let e=y.useContext(DE);return e||ar(!1),e}function cz(t){let e=y.useContext(Y9);return e||ar(!1),e}function uz(t){let e=y.useContext(io);return e||ar(!1),e}function xD(t){let e=uz(),n=e.matches[e.matches.length-1];return n.route.id||ar(!1),n.route.id}function dz(){var t;let e=y.useContext(bD),n=cz(),r=xD();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function hz(){let{router:t}=lz(ID.UseNavigateStable),e=xD(TD.UseNavigateStable),n=y.useRef(!1);return ED(()=>{n.current=!0}),y.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,xf({fromRouteId:e},i)))},[t,e])}const Wx={};function fz(t,e,n){Wx[t]||(Wx[t]=!0)}function AD(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Bte(t){let{to:e,replace:n,state:r,relative:s}=t;Ld()||ar(!1);let{future:i,static:o}=y.useContext(fl),{matches:a}=y.useContext(io),{pathname:l}=Ii(),c=oo(),u=kE(e,NE(a,i.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(u);return y.useEffect(()=>c(JSON.parse(d),{replace:n,state:r,relative:s}),[c,d,s,n,r]),null}function mz(t){return ez(t.context)}function Ve(t){ar(!1)}function PD(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Pa.Pop,navigator:i,static:o=!1,future:a}=t;Ld()&&ar(!1);let l=e.replace(/^\/*/,"/"),c=y.useMemo(()=>({basename:l,navigator:i,static:o,future:xf({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=Pc(r));let{pathname:u="/",search:d="",hash:m="",state:p=null,key:v="default"}=r,g=y.useMemo(()=>{let E=CE(u,l);return E==null?null:{location:{pathname:E,search:d,hash:m,state:p,key:v},navigationType:s}},[l,u,d,m,p,v,s]);return g==null?null:y.createElement(fl.Provider,{value:c},y.createElement(Jy.Provider,{children:n,value:g}))}function qx(t){let{children:e,location:n}=t;return tz(p0(e),n)}new Promise(()=>{});function p0(t,e){e===void 0&&(e=[]);let n=[];return y.Children.forEach(t,(r,s)=>{if(!y.isValidElement(r))return;let i=[...e,s];if(r.type===y.Fragment){n.push.apply(n,p0(r.props.children,i));return}r.type!==Ve&&ar(!1),!r.props.index||!r.props.children||ar(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=p0(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function g0(){return g0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},g0.apply(this,arguments)}function pz(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function gz(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function yz(t,e){return t.button===0&&(!e||e==="_self")&&!gz(t)}function y0(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function vz(t,e){let n=y0(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const wz=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],_z="6";try{window.__reactRouterVersion=_z}catch{}const bz="startTransition",Lg=by[bz];function Ez(t){let{basename:e,children:n,future:r,window:s}=t,i=y.useRef();i.current==null&&(i.current=S9({window:s,v5Compat:!0}));let o=i.current,[a,l]=y.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=y.useCallback(d=>{c&&Lg?Lg(()=>l(d)):l(d)},[l,c]);return y.useLayoutEffect(()=>o.listen(u),[o,u]),y.useEffect(()=>AD(r),[r]),y.createElement(PD,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}function Sz(t){let{basename:e,children:n,future:r,window:s}=t,i=y.useRef();i.current==null&&(i.current=I9({window:s,v5Compat:!0}));let o=i.current,[a,l]=y.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=y.useCallback(d=>{c&&Lg?Lg(()=>l(d)):l(d)},[l,c]);return y.useLayoutEffect(()=>o.listen(u),[o,u]),y.useEffect(()=>AD(r),[r]),y.createElement(PD,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const Iz=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Tz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,v0=y.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d}=e,m=pz(e,wz),{basename:p}=y.useContext(fl),v,g=!1;if(typeof c=="string"&&Tz.test(c)&&(v=c,Iz))try{let S=new URL(window.location.href),P=c.startsWith("//")?new URL(S.protocol+c):new URL(c),T=CE(P.pathname,p);P.origin===S.origin&&T!=null?c=T+P.search+P.hash:g=!0}catch{}let E=J9(c,{relative:s}),b=xz(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:d});function _(S){r&&r(S),S.defaultPrevented||b(S)}return y.createElement("a",g0({},m,{href:v||E,onClick:g||i?r:_,ref:n,target:l}))});var Hx;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Hx||(Hx={}));var Kx;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Kx||(Kx={}));function xz(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=oo(),c=Ii(),u=SD(t,{relative:o});return y.useCallback(d=>{if(yz(d,n)){d.preventDefault();let m=r!==void 0?r:Tf(c)===Tf(u);l(t,{replace:m,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,r,s,n,t,i,o,a])}function zte(t){let e=y.useRef(y0(t)),n=y.useRef(!1),r=Ii(),s=y.useMemo(()=>vz(r.search,n.current?null:e.current),[r.search]),i=oo(),o=y.useCallback((a,l)=>{const c=y0(typeof a=="function"?a(s):a);n.current=!0,i("?"+c,l)},[i,s]);return[s,o]}const RD=y.createContext(void 0),Az=({children:t})=>{const[e,n]=y.useState(()=>{if(typeof window<"u"){const l=["appFontSize","desktopFontSize","mobileFontSize"];for(const c of l){const u=localStorage.getItem(c);if(u&&["small","medium","large"].includes(u))return u}return window.innerWidth<=768?"small":"medium"}return"medium"}),[r,s]=y.useState(!1),[i,o]=y.useState(!1);y.useEffect(()=>{const l=()=>{const c=window.innerWidth<=768;s(c)};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),y.useEffect(()=>{try{const l=!!window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron")||typeof window<"u"&&window.location&&window.location.protocol==="file:";o(l)}catch{o(!1)}},[]),y.useEffect(()=>{},[]),y.useEffect(()=>{const l=document.documentElement;l.classList.remove("font-size-small","font-size-medium","font-size-large"),l.classList.add(`font-size-${e}`)},[e]);const a=l=>{n(l),localStorage.setItem("appFontSize",l),i&&localStorage.setItem("desktopFontSize",l)};return f.jsx(RD.Provider,{value:{fontSize:e,setFontSize:a,isMobile:r,isDesktopApp:i},children:t})},Wte=()=>{const t=y.useContext(RD);if(t===void 0)throw new Error("useFontSize must be used within a FontSizeProvider");return t};var Pz=Symbol.for("react.lazy"),Mg=by[" use ".trim().toString()];function Rz(t){return typeof t=="object"&&t!==null&&"then"in t}function CD(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===Pz&&"_payload"in t&&Rz(t._payload)}function ND(t){const e=Nz(t),n=y.forwardRef((r,s)=>{let{children:i,...o}=r;CD(i)&&typeof Mg=="function"&&(i=Mg(i._payload));const a=y.Children.toArray(i),l=a.find(Dz);if(l){const c=l.props.children,u=a.map(d=>d===l?y.Children.count(c)>1?y.Children.only(null):y.isValidElement(c)?c.props.children:null:d);return f.jsx(e,{...o,ref:s,children:y.isValidElement(c)?y.cloneElement(c,void 0,u):null})}return f.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var Cz=ND("Slot");function Nz(t){const e=y.forwardRef((n,r)=>{let{children:s,...i}=n;if(CD(s)&&typeof Mg=="function"&&(s=Mg(s._payload)),y.isValidElement(s)){const o=Lz(s),a=Oz(i,s.props);return s.type!==y.Fragment&&(a.ref=r?Xf(r,o):o),y.cloneElement(s,a)}return y.Children.count(s)>1?y.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var kz=Symbol("radix.slottable");function Dz(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===kz}function Oz(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function Lz(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}const Mz=Uy("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full text-sm font-medium ring-offset-background transition-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-none hover:bg-primary",destructive:"bg-destructive text-destructive-foreground shadow-none hover:bg-destructive",outline:"border border-input bg-background shadow-none hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-none hover:bg-secondary",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-12 px-6 py-2",sm:"h-10 rounded-full px-4",lg:"h-14 rounded-full px-8",icon:"h-12 w-12"}},defaultVariants:{variant:"default",size:"default"}}),bt=y.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const o=r?Cz:"button";return f.jsx(o,{className:yn(Mz({variant:e,size:n,className:t})),ref:i,...s})});bt.displayName="Button";const ir=y.forwardRef(({className:t,type:e,...n},r)=>{const s={...n};return Object.prototype.hasOwnProperty.call(s,"value")&&s.value===void 0&&(s.value=""),f.jsx("input",{type:e,className:yn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...s})});ir.displayName="Input";const Vz=()=>{};var Gx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},jz=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},OE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,d=(i&3)<<4|a>>4;let m=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(m=64)),r.push(n[u],n[d],n[m],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(kD(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):jz(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const d=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||d==null)throw new Fz;const m=i<<2|a>>4;if(r.push(m),c!==64){const p=a<<4&240|c>>2;if(r.push(p),d!==64){const v=c<<6&192|d;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Fz extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Uz=function(t){const e=kD(t);return OE.encodeByteArray(e,!0)},Vg=function(t){return Uz(t).replace(/\./g,"")},DD=function(t){try{return OE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $z=()=>OD().__FIREBASE_DEFAULTS__,Bz=()=>{if(typeof process>"u"||typeof Gx>"u")return;const t=Gx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},zz=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&DD(t[1]);return e&&JSON.parse(e)},Xy=()=>{try{return Vz()||$z()||Bz()||zz()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},LD=t=>{var e,n;return(n=(e=Xy())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},LE=t=>{const e=LD(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},MD=()=>{var t;return(t=Xy())==null?void 0:t.config},VD=t=>{var e;return(e=Xy())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function tm(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jD(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Vg(JSON.stringify(n)),Vg(JSON.stringify(o)),""].join(".")}const Bh={};function Wz(){const t={prod:[],emulator:[]};for(const e of Object.keys(Bh))Bh[e]?t.emulator.push(e):t.prod.push(e);return t}function qz(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Qx=!1;function Zy(t,e){if(typeof window>"u"||typeof document>"u"||!Ti(window.location.host)||Bh[t]===e||Bh[t]||Qx)return;Bh[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=Wz().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,p){m.setAttribute("width","24"),m.setAttribute("id",p),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Qx=!0,o()},m}function u(m,p){m.setAttribute("id",p),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function d(){const m=qz(r),p=n("text"),v=document.getElementById(p)||document.createElement("span"),g=n("learnmore"),E=document.getElementById(g)||document.createElement("a"),b=n("preprendIcon"),_=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const S=m.element;a(S),u(E,g);const P=c();l(_,b),S.append(_,v,E,P),document.body.appendChild(S)}i?(v.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _r(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Hz(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_r())}function FD(){var e;const t=(e=Xy())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Kz(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Gz(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Qz(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Yz(){const t=_r();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function UD(){return!FD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $D(){return!FD()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ME(){try{return typeof indexedDB=="object"}catch{return!1}}function Jz(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xz="FirebaseError";class xi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Xz,Object.setPrototypeOf(this,xi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Md.prototype.create)}}class Md{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Zz(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new xi(s,a,r)}}function Zz(t,e){return t.replace(eW,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const eW=/\{\$([^}]+)}/g;function tW(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function wi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Yx(i)&&Yx(o)){if(!wi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Yx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nm(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function bh(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Eh(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function nW(t,e){const n=new rW(t,e);return n.subscribe.bind(n)}class rW{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");sW(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Rw),s.error===void 0&&(s.error=Rw),s.complete===void 0&&(s.complete=Rw);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sW(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Rw(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qte=4*60*60*1e3;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(t){return t&&t._delegate?t._delegate:t}class _i{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iW{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new w0;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(aW(e))try{this.getOrInitializeService({instanceIdentifier:Cl})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Cl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Cl){return this.instances.has(e)}getOptions(e=Cl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:oW(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Cl){return this.component?this.component.multipleInstances?e:Cl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function oW(t){return t===Cl?void 0:t}function aW(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lW{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new iW(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Wt||(Wt={}));const cW={debug:Wt.DEBUG,verbose:Wt.VERBOSE,info:Wt.INFO,warn:Wt.WARN,error:Wt.ERROR,silent:Wt.SILENT},uW=Wt.INFO,dW={[Wt.DEBUG]:"log",[Wt.VERBOSE]:"log",[Wt.INFO]:"info",[Wt.WARN]:"warn",[Wt.ERROR]:"error"},hW=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=dW[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ev{constructor(e){this.name=e,this._logLevel=uW,this._logHandler=hW,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cW[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Wt.DEBUG,...e),this._logHandler(this,Wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Wt.VERBOSE,...e),this._logHandler(this,Wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Wt.INFO,...e),this._logHandler(this,Wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Wt.WARN,...e),this._logHandler(this,Wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Wt.ERROR,...e),this._logHandler(this,Wt.ERROR,...e)}}const fW=(t,e)=>e.some(n=>t instanceof n);let Jx,Xx;function mW(){return Jx||(Jx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pW(){return Xx||(Xx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const BD=new WeakMap,_0=new WeakMap,zD=new WeakMap,Cw=new WeakMap,VE=new WeakMap;function gW(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Ba(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&BD.set(n,t)}).catch(()=>{}),VE.set(e,t),e}function yW(t){if(_0.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});_0.set(t,e)}let b0={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return _0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||zD.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ba(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function vW(t){b0=t(b0)}function wW(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Nw(this),e,...n);return zD.set(r,e.sort?e.sort():[e]),Ba(r)}:pW().includes(t)?function(...e){return t.apply(Nw(this),e),Ba(BD.get(this))}:function(...e){return Ba(t.apply(Nw(this),e))}}function _W(t){return typeof t=="function"?wW(t):(t instanceof IDBTransaction&&yW(t),fW(t,mW())?new Proxy(t,b0):t)}function Ba(t){if(t instanceof IDBRequest)return gW(t);if(Cw.has(t))return Cw.get(t);const e=_W(t);return e!==t&&(Cw.set(t,e),VE.set(e,t)),e}const Nw=t=>VE.get(t);function bW(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Ba(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Ba(o.result),l.oldVersion,l.newVersion,Ba(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const EW=["get","getKey","getAll","getAllKeys","count"],SW=["put","add","delete","clear"],kw=new Map;function Zx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(kw.get(e))return kw.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=SW.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||EW.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return kw.set(e,i),i}vW(t=>({...t,get:(e,n,r)=>Zx(e,n)||t.get(e,n,r),has:(e,n)=>!!Zx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IW{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(TW(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function TW(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const E0="@firebase/app",eA="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mo=new ev("@firebase/app"),xW="@firebase/app-compat",AW="@firebase/analytics-compat",PW="@firebase/analytics",RW="@firebase/app-check-compat",CW="@firebase/app-check",NW="@firebase/auth",kW="@firebase/auth-compat",DW="@firebase/database",OW="@firebase/data-connect",LW="@firebase/database-compat",MW="@firebase/functions",VW="@firebase/functions-compat",jW="@firebase/installations",FW="@firebase/installations-compat",UW="@firebase/messaging",$W="@firebase/messaging-compat",BW="@firebase/performance",zW="@firebase/performance-compat",WW="@firebase/remote-config",qW="@firebase/remote-config-compat",HW="@firebase/storage",KW="@firebase/storage-compat",GW="@firebase/firestore",QW="@firebase/ai",YW="@firebase/firestore-compat",JW="firebase",XW="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jg="[DEFAULT]",ZW={[E0]:"fire-core",[xW]:"fire-core-compat",[PW]:"fire-analytics",[AW]:"fire-analytics-compat",[CW]:"fire-app-check",[RW]:"fire-app-check-compat",[NW]:"fire-auth",[kW]:"fire-auth-compat",[DW]:"fire-rtdb",[OW]:"fire-data-connect",[LW]:"fire-rtdb-compat",[MW]:"fire-fn",[VW]:"fire-fn-compat",[jW]:"fire-iid",[FW]:"fire-iid-compat",[UW]:"fire-fcm",[$W]:"fire-fcm-compat",[BW]:"fire-perf",[zW]:"fire-perf-compat",[WW]:"fire-rc",[qW]:"fire-rc-compat",[HW]:"fire-gcs",[KW]:"fire-gcs-compat",[GW]:"fire-fst",[YW]:"fire-fst-compat",[QW]:"fire-vertex","fire-js":"fire-js",[JW]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu=new Map,S0=new Map,I0=new Map;function tA(t,e){try{t.container.addComponent(e)}catch(n){Mo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function no(t){const e=t.name;if(I0.has(e))return Mo.debug(`There were multiple attempts to register component ${e}.`),!1;I0.set(e,t);for(const n of Xu.values())tA(n,t);for(const n of S0.values())tA(n,t);return!0}function Rc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function e8(t,e,n=jg){Rc(t,e).clearInstance(n)}function fs(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},za=new Md("app","Firebase",t8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n8{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new _i("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw za.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cc=XW;function WD(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:jg,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw za.create("bad-app-name",{appName:String(s)});if(n||(n=MD()),!n)throw za.create("no-options");const i=Xu.get(s);if(i){if(wi(n,i.options)&&wi(r,i.config))return i;throw za.create("duplicate-app",{appName:s})}const o=new lW(s);for(const l of I0.values())o.addComponent(l);const a=new n8(n,r,o);return Xu.set(s,a),a}function tv(t=jg){const e=Xu.get(t);if(!e&&t===jg&&MD())return WD();if(!e)throw za.create("no-app",{appName:t});return e}async function Hte(t){let e=!1;const n=t.name;Xu.has(n)?(e=!0,Xu.delete(n)):S0.has(n)&&t.decRefCount()<=0&&(S0.delete(n),e=!0),e&&(await Promise.all(t.container.getProviders().map(r=>r.delete())),t.isDeleted=!0)}function Ms(t,e,n){let r=ZW[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Mo.warn(o.join(" "));return}no(new _i(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r8="firebase-heartbeat-database",s8=1,Af="firebase-heartbeat-store";let Dw=null;function qD(){return Dw||(Dw=bW(r8,s8,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Af)}catch(n){console.warn(n)}}}}).catch(t=>{throw za.create("idb-open",{originalErrorMessage:t.message})})),Dw}async function i8(t){try{const n=(await qD()).transaction(Af),r=await n.objectStore(Af).get(HD(t));return await n.done,r}catch(e){if(e instanceof xi)Mo.warn(e.message);else{const n=za.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Mo.warn(n.message)}}}async function nA(t,e){try{const r=(await qD()).transaction(Af,"readwrite");await r.objectStore(Af).put(e,HD(t)),await r.done}catch(n){if(n instanceof xi)Mo.warn(n.message);else{const r=za.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Mo.warn(r.message)}}}function HD(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o8=1024,a8=30;class l8{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new u8(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=rA();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>a8){const o=d8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Mo.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=rA(),{heartbeatsToSend:r,unsentEntries:s}=c8(this._heartbeatsCache.heartbeats),i=Vg(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Mo.warn(n),""}}}function rA(){return new Date().toISOString().substring(0,10)}function c8(t,e=o8){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),sA(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),sA(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class u8{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ME()?Jz().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await i8(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return nA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return nA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function sA(t){return Vg(JSON.stringify({version:2,heartbeats:t})).length}function d8(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h8(t){no(new _i("platform-logger",e=>new IW(e),"PRIVATE")),no(new _i("heartbeat",e=>new l8(e),"PRIVATE")),Ms(E0,eA,t),Ms(E0,eA,"esm2020"),Ms("fire-js","")}h8("");function KD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const f8=KD,GD=new Md("auth","Firebase",KD());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg=new ev("@firebase/auth");function m8(t,...e){Fg.logLevel<=Wt.WARN&&Fg.warn(`Auth (${Cc}): ${t}`,...e)}function Mp(t,...e){Fg.logLevel<=Wt.ERROR&&Fg.error(`Auth (${Cc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(t,...e){throw jE(t,...e)}function Yi(t,...e){return jE(t,...e)}function QD(t,e,n){const r={...f8(),[e]:n};return new Md("auth","Firebase",r).create(e,{appName:t.name})}function Ao(t){return QD(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jE(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return GD.create(t,...e)}function pt(t,e,...n){if(!t)throw jE(e,...n)}function bo(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Mp(e),new Error(e)}function Vo(t,e){t||bo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function YD(){return iA()==="http:"||iA()==="https:"}function iA(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(YD()||Gz()||"connection"in navigator)?navigator.onLine:!0}function g8(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e,n){this.shortDelay=e,this.longDelay=n,Vo(n>e,"Short delay should be less than long delay!"),this.isMobile=Hz()||Qz()}get(){return p8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(t,e){Vo(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],w8=new rm(3e4,6e4);function ao(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ai(t,e,n,r,s={}){return XD(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=nm({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...i};return Kz()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&Ti(t.emulatorConfig.host)&&(c.credentials="include"),JD.fetch()(await ZD(t,t.config.apiHost,n,a),c)})}async function XD(t,e,n){t._canInitEmulator=!1;const r={...y8,...e};try{const s=new b8(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Xm(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xm(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Xm(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Xm(t,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw QD(t,u,c);bi(t,u)}}catch(s){if(s instanceof xi)throw s;bi(t,"network-request-failed",{message:String(s)})}}async function sm(t,e,n,r,s={}){const i=await Ai(t,e,n,r,s);return"mfaPendingCredential"in i&&bi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function ZD(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?FE(t.config,s):`${t.config.apiScheme}://${s}`;return v8.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function _8(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class b8{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Yi(this.auth,"network-request-failed")),w8.get())})}}function Xm(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Yi(t,e,r);return s.customData._tokenResponse=n,s}function oA(t){return t!==void 0&&t.enterprise!==void 0}class E8{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return _8(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function S8(t,e){return Ai(t,"GET","/v2/recaptchaConfig",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I8(t,e){return Ai(t,"POST","/v1/accounts:delete",e)}async function $g(t,e){return Ai(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function T8(t,e=!1){const n=Dt(t),r=await n.getIdToken(e),s=UE(r);pt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:zh(Ow(s.auth_time)),issuedAtTime:zh(Ow(s.iat)),expirationTime:zh(Ow(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ow(t){return Number(t)*1e3}function UE(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Mp("JWT malformed, contained fewer than 3 sections"),null;try{const s=DD(n);return s?JSON.parse(s):(Mp("Failed to decode base64 JWT payload"),null)}catch(s){return Mp("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function aA(t){const e=UE(t);return pt(e,"internal-error"),pt(typeof e.exp<"u","internal-error"),pt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof xi&&x8(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function x8({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A8{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=zh(this.lastLoginAt),this.creationTime=zh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bg(t){var d;const e=t.auth,n=await t.getIdToken(),r=await Zu(t,$g(e,{idToken:n}));pt(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(d=s.providerUserInfo)!=null&&d.length?e2(s.providerUserInfo):[],o=R8(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),c=a?l:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new T0(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function P8(t){const e=Dt(t);await Bg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function R8(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function e2(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C8(t,e){const n=await XD(t,{},async()=>{const r=nm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await ZD(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Ti(t.emulatorConfig.host)&&(l.credentials="include"),JD.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function N8(t,e){return Ai(t,"POST","/v2/accounts:revokeToken",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pt(e.idToken,"internal-error"),pt(typeof e.idToken<"u","internal-error"),pt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):aA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){pt(e.length!==0,"internal-error");const n=aA(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(pt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await C8(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Pu;return r&&(pt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(pt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(pt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pu,this.toJSON())}_performRefresh(){return bo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(t,e){pt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class di{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new A8(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new T0(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Zu(this,this.stsTokenManager.getToken(this.auth,e));return pt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return T8(this,e)}reload(){return P8(this)}_assign(e){this!==e&&(pt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new di({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){pt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Bg(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fs(this.auth.app))return Promise.reject(Ao(this.auth));const e=await this.getIdToken();return await Zu(this,I8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,c=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:d,emailVerified:m,isAnonymous:p,providerData:v,stsTokenManager:g}=n;pt(d&&g,e,"internal-error");const E=Pu.fromJSON(this.name,g);pt(typeof d=="string",e,"internal-error"),ea(r,e.name),ea(s,e.name),pt(typeof m=="boolean",e,"internal-error"),pt(typeof p=="boolean",e,"internal-error"),ea(i,e.name),ea(o,e.name),ea(a,e.name),ea(l,e.name),ea(c,e.name),ea(u,e.name);const b=new di({uid:d,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:p,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:E,createdAt:c,lastLoginAt:u});return v&&Array.isArray(v)&&(b.providerData=v.map(_=>({..._}))),l&&(b._redirectEventId=l),b}static async _fromIdTokenResponse(e,n,r=!1){const s=new Pu;s.updateFromServerResponse(n);const i=new di({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Bg(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];pt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?e2(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Pu;a.updateFromIdToken(r);const l=new di({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new T0(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA=new Map;function Eo(t){Vo(t instanceof Function,"Expected a class definition");let e=lA.get(t);return e?(Vo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,lA.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}t2.type="NONE";const x0=t2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(t,e,n){return`firebase:${t}:${e}:${n}`}class Ru{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Vp(this.userKey,s.apiKey,i),this.fullPersistenceKey=Vp("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await $g(this.auth,{idToken:e}).catch(()=>{});return n?di._fromGetAccountInfoResponse(this.auth,n,e):null}return di._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ru(Eo(x0),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Eo(x0);const o=Vp(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){let d;if(typeof u=="string"){const m=await $g(e,{idToken:u}).catch(()=>{});if(!m)break;d=await di._fromGetAccountInfoResponse(e,m,u)}else d=di._fromJSON(e,u);c!==i&&(a=d),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Ru(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Ru(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(i2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(n2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(a2(e))return"Blackberry";if(l2(e))return"Webos";if(r2(e))return"Safari";if((e.includes("chrome/")||s2(e))&&!e.includes("edge/"))return"Chrome";if(o2(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function n2(t=_r()){return/firefox\//i.test(t)}function r2(t=_r()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function s2(t=_r()){return/crios\//i.test(t)}function i2(t=_r()){return/iemobile/i.test(t)}function o2(t=_r()){return/android/i.test(t)}function a2(t=_r()){return/blackberry/i.test(t)}function l2(t=_r()){return/webos/i.test(t)}function $E(t=_r()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function k8(t=_r()){var e;return $E(t)&&!!((e=window.navigator)!=null&&e.standalone)}function D8(){return Yz()&&document.documentMode===10}function c2(t=_r()){return $E(t)||o2(t)||l2(t)||a2(t)||/windows phone/i.test(t)||i2(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u2(t,e=[]){let n;switch(t){case"Browser":n=cA(_r());break;case"Worker":n=`${cA(_r())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Cc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O8{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L8(t,e={}){return Ai(t,"GET","/v2/passwordPolicy",ao(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M8=6;class V8{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??M8,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j8{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new uA(this),this.idTokenSubscription=new uA(this),this.beforeStateQueue=new O8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=GD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Eo(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Ru.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await $g(this,{idToken:e}),r=await di._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(fs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return pt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Bg(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=g8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(fs(this.app))return Promise.reject(Ao(this));const n=e?Dt(e):null;return n&&pt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&pt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return fs(this.app)?Promise.reject(Ao(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return fs(this.app)?Promise.reject(Ao(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Eo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await L8(this),n=new V8(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Md("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await N8(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Eo(e)||this._popupRedirectResolver;pt(n,this,"argument-error"),this.redirectPersistenceManager=await Ru.create(this,[Eo(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(pt(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=u2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(fs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&m8(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ml(t){return Dt(t)}class uA{constructor(e){this.auth=e,this.observer=null,this.addObserver=nW(n=>this.observer=n)}get next(){return pt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function F8(t){nv=t}function d2(t){return nv.loadJS(t)}function U8(){return nv.recaptchaEnterpriseScript}function $8(){return nv.gapiScript}function B8(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class z8{constructor(){this.enterprise=new W8}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class W8{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const q8="recaptcha-enterprise",h2="NO_RECAPTCHA";class H8{constructor(e){this.type=q8,this.auth=ml(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{S8(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new E8(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;oA(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(h2)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new z8().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&oA(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=U8();l.length!==0&&(l+=a),d2(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function dA(t,e,n,r=!1,s=!1){const i=new H8(t);let o;if(s)o=h2;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function zg(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await dA(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await dA(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f2(t,e){const n=Rc(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(wi(i,e??{}))return s;bi(s,"already-initialized")}return n.initialize({options:e})}function K8(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Eo);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function G8(t,e,n){const r=ml(t);pt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=m2(e),{host:o,port:a}=Q8(e),l=a===null?"":`:${a}`,c={url:`${i}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){pt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),pt(wi(c,r.config.emulator)&&wi(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,Ti(o)?(tm(`${i}//${o}${l}`),Zy("Auth",!0)):Y8()}function m2(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Q8(t){const e=m2(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:hA(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:hA(o)}}}function hA(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Y8(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return bo("not implemented")}_getIdTokenResponse(e){return bo("not implemented")}_linkToIdToken(e,n){return bo("not implemented")}_getReauthenticationResolver(e){return bo("not implemented")}}async function J8(t,e){return Ai(t,"POST","/v1/accounts:update",e)}async function X8(t,e){return Ai(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z8(t,e){return sm(t,"POST","/v1/accounts:signInWithPassword",ao(t,e))}async function e7(t,e){return Ai(t,"POST","/v1/accounts:sendOobCode",ao(t,e))}async function t7(t,e){return e7(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n7(t,e){return sm(t,"POST","/v1/accounts:signInWithEmailLink",ao(t,e))}async function r7(t,e){return sm(t,"POST","/v1/accounts:signInWithEmailLink",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf extends BE{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Pf(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Pf(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zg(e,n,"signInWithPassword",Z8);case"emailLink":return n7(e,{email:this._email,oobCode:this._password});default:bi(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zg(e,r,"signUpPassword",X8);case"emailLink":return r7(e,{idToken:n,email:this._email,oobCode:this._password});default:bi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cu(t,e){return sm(t,"POST","/v1/accounts:signInWithIdp",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s7="http://localhost";class hc extends BE{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new hc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):bi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new hc(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Cu(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Cu(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Cu(e,n)}buildRequest(){const e={requestUri:s7,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=nm(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i7(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function o7(t){const e=bh(Eh(t)).link,n=e?bh(Eh(e)).deep_link_id:null,r=bh(Eh(t)).deep_link_id;return(r?bh(Eh(r)).link:null)||r||n||e||t}class zE{constructor(e){const n=bh(Eh(e)),r=n.apiKey??null,s=n.oobCode??null,i=i7(n.mode??null);pt(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=o7(e);try{return new zE(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(){this.providerId=Nc.PROVIDER_ID}static credential(e,n){return Pf._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=zE.parseLink(n);return pt(r,"argument-error"),Pf._fromEmailAndCode(e,r.code,r.tenantId)}}Nc.PROVIDER_ID="password";Nc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Nc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im extends p2{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma extends im{constructor(){super("facebook.com")}static credential(e){return hc._fromParams({providerId:ma.PROVIDER_ID,signInMethod:ma.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ma.credentialFromTaggedObject(e)}static credentialFromError(e){return ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ma.credential(e.oauthAccessToken)}catch{return null}}}ma.FACEBOOK_SIGN_IN_METHOD="facebook.com";ma.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa extends im{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return hc._fromParams({providerId:pa.PROVIDER_ID,signInMethod:pa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return pa.credentialFromTaggedObject(e)}static credentialFromError(e){return pa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return pa.credential(n,r)}catch{return null}}}pa.GOOGLE_SIGN_IN_METHOD="google.com";pa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga extends im{constructor(){super("github.com")}static credential(e){return hc._fromParams({providerId:ga.PROVIDER_ID,signInMethod:ga.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ga.credentialFromTaggedObject(e)}static credentialFromError(e){return ga.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ga.credential(e.oauthAccessToken)}catch{return null}}}ga.GITHUB_SIGN_IN_METHOD="github.com";ga.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends im{constructor(){super("twitter.com")}static credential(e,n){return hc._fromParams({providerId:ya.PROVIDER_ID,signInMethod:ya.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ya.credentialFromTaggedObject(e)}static credentialFromError(e){return ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ya.credential(n,r)}catch{return null}}}ya.TWITTER_SIGN_IN_METHOD="twitter.com";ya.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a7(t,e){return sm(t,"POST","/v1/accounts:signUp",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await di._fromIdTokenResponse(e,r,s),o=fA(r);return new fc({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=fA(r);return new fc({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function fA(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg extends xi{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Wg.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Wg(e,n,r,s)}}function g2(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Wg._fromErrorAndOperation(t,i,e,r):i})}async function l7(t,e,n=!1){const r=await Zu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return fc._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y2(t,e,n=!1){const{auth:r}=t;if(fs(r.app))return Promise.reject(Ao(r));const s="reauthenticate";try{const i=await Zu(t,g2(r,s,e,t),n);pt(i.idToken,r,"internal-error");const o=UE(i.idToken);pt(o,r,"internal-error");const{sub:a}=o;return pt(t.uid===a,r,"user-mismatch"),fc._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&bi(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v2(t,e,n=!1){if(fs(t.app))return Promise.reject(Ao(t));const r="signIn",s=await g2(t,r,e),i=await fc._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function c7(t,e){return v2(ml(t),e)}async function u7(t,e){return y2(Dt(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w2(t){const e=ml(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function d7(t,e,n){const r=ml(t);await zg(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",t7)}async function mA(t,e,n){if(fs(t.app))return Promise.reject(Ao(t));const r=ml(t),o=await zg(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",a7).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&w2(t),l}),a=await fc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function _2(t,e,n){return fs(t.app)?Promise.reject(Ao(t)):c7(Dt(t),Nc.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&w2(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h7(t,e){return Ai(t,"POST","/v1/accounts:createAuthUri",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f7(t,e){const n=YD()?Ug():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:s}=await h7(Dt(t),r);return s||[]}function Kte(t,e){return m7(Dt(t),null,e)}async function m7(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(i.password=n);const o=await Zu(t,J8(r,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p7(t,e){return Dt(t).setPersistence(e)}function g7(t,e,n,r){return Dt(t).onIdTokenChanged(e,n,r)}function y7(t,e,n){return Dt(t).beforeAuthStateChanged(e,n)}function v7(t,e,n,r){return Dt(t).onAuthStateChanged(e,n,r)}function pA(t){return Dt(t).signOut()}const qg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(qg,"1"),this.storage.removeItem(qg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w7=1e3,_7=10;class E2 extends b2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=c2(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);D8()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,_7):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},w7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}E2.type="LOCAL";const WE=E2;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2 extends b2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}S2.type="SESSION";const qE=S2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b7(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new rv(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(n.origin,i)),l=await b7(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rv.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HE(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E7{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=HE("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(d){const m=d;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(){return window}function S7(t){Ji().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I2(){return typeof Ji().WorkerGlobalScope<"u"&&typeof Ji().importScripts=="function"}async function I7(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function T7(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function x7(){return I2()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T2="firebaseLocalStorageDb",A7=1,Hg="firebaseLocalStorage",x2="fbase_key";class om{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function sv(t,e){return t.transaction([Hg],e?"readwrite":"readonly").objectStore(Hg)}function P7(){const t=indexedDB.deleteDatabase(T2);return new om(t).toPromise()}function A0(){const t=indexedDB.open(T2,A7);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Hg,{keyPath:x2})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Hg)?e(r):(r.close(),await P7(),e(await A0()))})})}async function gA(t,e,n){const r=sv(t,!0).put({[x2]:e,value:n});return new om(r).toPromise()}async function R7(t,e){const n=sv(t,!1).get(e),r=await new om(n).toPromise();return r===void 0?null:r.value}function yA(t,e){const n=sv(t,!0).delete(e);return new om(n).toPromise()}const C7=800,N7=3;class A2{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await A0(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>N7)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return I2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rv._getInstance(x7()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await I7(),!this.activeServiceWorker)return;this.sender=new E7(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||T7()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await A0();return await gA(e,qg,"1"),await yA(e,qg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>gA(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>R7(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>yA(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=sv(s,!1).getAll();return new om(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),C7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}A2.type="LOCAL";const k7=A2;new rm(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D7(t,e){return e?Eo(e):(pt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE extends BE{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Cu(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Cu(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Cu(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function O7(t){return v2(t.auth,new KE(t),t.bypassAuthState)}function L7(t){const{auth:e,user:n}=t;return pt(n,e,"internal-error"),y2(n,new KE(t),t.bypassAuthState)}async function M7(t){const{auth:e,user:n}=t;return pt(n,e,"internal-error"),l7(n,new KE(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return O7;case"linkViaPopup":case"linkViaRedirect":return M7;case"reauthViaPopup":case"reauthViaRedirect":return L7;default:bi(this.auth,"internal-error")}}resolve(e){Vo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V7=new rm(2e3,1e4);class fu extends P2{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,fu.currentPopupAction&&fu.currentPopupAction.cancel(),fu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pt(e,this.auth,"internal-error"),e}async onExecution(){Vo(this.filter.length===1,"Popup operations only handle one event");const e=HE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Yi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Yi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Yi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,V7.get())};e()}}fu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j7="pendingRedirect",jp=new Map;class F7 extends P2{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=jp.get(this.auth._key());if(!e){try{const r=await U7(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}jp.set(this.auth._key(),e)}return this.bypassAuthState||jp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function U7(t,e){const n=z7(e),r=B7(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function $7(t,e){jp.set(t._key(),e)}function B7(t){return Eo(t._redirectPersistence)}function z7(t){return Vp(j7,t.config.apiKey,t.name)}async function W7(t,e,n=!1){if(fs(t.app))return Promise.reject(Ao(t));const r=ml(t),s=D7(r,e),o=await new F7(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q7=10*60*1e3;class H7{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!K7(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!R2(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Yi(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=q7&&this.cachedEventUids.clear(),this.cachedEventUids.has(vA(e))}saveEventToCache(e){this.cachedEventUids.add(vA(e)),this.lastProcessedEventTime=Date.now()}}function vA(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function R2({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function K7(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return R2(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G7(t,e={}){return Ai(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Y7=/^https?/;async function J7(t){if(t.config.emulator)return;const{authorizedDomains:e}=await G7(t);for(const n of e)try{if(X7(n))return}catch{}bi(t,"unauthorized-domain")}function X7(t){const e=Ug(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Y7.test(n))return!1;if(Q7.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z7=new rm(3e4,6e4);function wA(){const t=Ji().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function eq(t){return new Promise((e,n)=>{var s,i,o;function r(){wA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wA(),n(Yi(t,"network-request-failed"))},timeout:Z7.get()})}if((i=(s=Ji().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Ji().gapi)!=null&&o.load)r();else{const a=B8("iframefcb");return Ji()[a]=()=>{gapi.load?r():n(Yi(t,"network-request-failed"))},d2(`${$8()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Fp=null,e})}let Fp=null;function tq(t){return Fp=Fp||eq(t),Fp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nq=new rm(5e3,15e3),rq="__/auth/iframe",sq="emulator/auth/iframe",iq={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oq=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function aq(t){const e=t.config;pt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?FE(e,sq):`https://${t.config.authDomain}/${rq}`,r={apiKey:e.apiKey,appName:t.name,v:Cc},s=oq.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${nm(r).slice(1)}`}async function lq(t){const e=await tq(t),n=Ji().gapi;return pt(n,t,"internal-error"),e.open({where:document.body,url:aq(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:iq,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Yi(t,"network-request-failed"),a=Ji().setTimeout(()=>{i(o)},nq.get());function l(){Ji().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cq={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},uq=500,dq=600,hq="_blank",fq="http://localhost";class _A{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mq(t,e,n,r=uq,s=dq){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...cq,width:r.toString(),height:s.toString(),top:i,left:o},c=_r().toLowerCase();n&&(a=s2(c)?hq:n),n2(c)&&(e=e||fq,l.scrollbars="yes");const u=Object.entries(l).reduce((m,[p,v])=>`${m}${p}=${v},`,"");if(k8(c)&&a!=="_self")return pq(e||"",a),new _A(null);const d=window.open(e||"",a,u);pt(d,t,"popup-blocked");try{d.focus()}catch{}return new _A(d)}function pq(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gq="__/auth/handler",yq="emulator/auth/handler",vq=encodeURIComponent("fac");async function bA(t,e,n,r,s,i){pt(t.config.authDomain,t,"auth-domain-config-required"),pt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Cc,eventId:s};if(e instanceof p2){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",tW(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(e instanceof im){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${vq}=${encodeURIComponent(l)}`:"";return`${wq(t)}?${nm(a).slice(1)}${c}`}function wq({config:t}){return t.emulator?FE(t,yq):`https://${t.authDomain}/${gq}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lw="webStorageSupport";class _q{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qE,this._completeRedirectFn=W7,this._overrideRedirectResult=$7}async _openPopup(e,n,r,s){var o;Vo((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await bA(e,n,r,Ug(),s);return mq(e,i,HE())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await bA(e,n,r,Ug(),s);return S7(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Vo(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await lq(e),r=new H7(e);return n.register("authEvent",s=>(pt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Lw,{type:Lw},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Lw];i!==void 0&&n(!!i),bi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=J7(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return c2()||r2()||$E()}}const bq=_q;var EA="@firebase/auth",SA="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eq{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){pt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sq(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Iq(t){no(new _i("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;pt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:u2(t)},c=new j8(r,s,i,l);return K8(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),no(new _i("auth-internal",e=>{const n=ml(e.getProvider("auth").getImmediate());return(r=>new Eq(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ms(EA,SA,Sq(t)),Ms(EA,SA,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tq=5*60,xq=VD("authIdTokenMaxAge")||Tq;let IA=null;const Aq=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>xq)return;const s=n==null?void 0:n.token;IA!==s&&(IA=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Gte(t=tv()){const e=Rc(t,"auth");if(e.isInitialized())return e.getImmediate();const n=f2(t,{popupRedirectResolver:bq,persistence:[k7,WE,qE]}),r=VD("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=Aq(i.toString());y7(n,o,()=>o(n.currentUser)),g7(n,a=>o(a))}}const s=LD("auth");return s&&G8(n,`http://${s}`),n}function Pq(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}F8({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Yi("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Pq().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Iq("Browser");var Rq="firebase",Cq="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ms(Rq,Cq,"app");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nq=new Map,kq={activated:!1,tokenObservers:[]},Dq={initialized:!1,enabled:!1};function Ei(t){return Nq.get(t)||{...kq}}function C2(){return Dq}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oq="https://content-firebaseappcheck.googleapis.com/v1";const Lq="exchangeDebugToken",TA={RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Qte=24*60*60*1e3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mq{constructor(e,n,r,s,i){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new w0,this.pending.promise.catch(n=>{}),await Vq(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new w0,this.pending.promise.catch(n=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function Vq(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jq={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},Ra=new Md("appCheck","AppCheck",jq);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N2(t){if(!Ei(t).activated)throw Ra.create("use-before-activation",{appName:t.name})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k2({url:t,body:e},n){const r={"Content-Type":"application/json"},s=n.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&(r["X-Firebase-Client"]=d)}const i={method:"POST",body:JSON.stringify(e),headers:r};let o;try{o=await fetch(t,i)}catch(d){throw Ra.create("fetch-network-error",{originalErrorMessage:d==null?void 0:d.message})}if(o.status!==200)throw Ra.create("fetch-status-error",{httpStatus:o.status});let a;try{a=await o.json()}catch(d){throw Ra.create("fetch-parse-error",{originalErrorMessage:d==null?void 0:d.message})}const l=a.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw Ra.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const c=Number(l[1])*1e3,u=Date.now();return{token:a.token,expireTimeMillis:u+c,issuedAtTimeMillis:u}}function D2(t,e){const{projectId:n,appId:r,apiKey:s}=t.options;return{url:`${Oq}/projects/${n}/apps/${r}:${Lq}?key=${s}`,body:{debug_token:e}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fq="firebase-app-check-database",Uq=1,P0="firebase-app-check-store";let Zm=null;function $q(){return Zm||(Zm=new Promise((t,e)=>{try{const n=indexedDB.open(Fq,Uq);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var s;e(Ra.create("storage-open",{originalErrorMessage:(s=r.target.error)==null?void 0:s.message}))},n.onupgradeneeded=r=>{const s=r.target.result;switch(r.oldVersion){case 0:s.createObjectStore(P0,{keyPath:"compositeKey"})}}}catch(n){e(Ra.create("storage-open",{originalErrorMessage:n==null?void 0:n.message}))}}),Zm)}function Bq(t,e){return zq(Wq(t),e)}async function zq(t,e){const r=(await $q()).transaction(P0,"readwrite"),i=r.objectStore(P0).put({compositeKey:t,value:e});return new Promise((o,a)=>{i.onsuccess=l=>{o()},r.onerror=l=>{var c;a(Ra.create("storage-set",{originalErrorMessage:(c=l.target.error)==null?void 0:c.message}))}})}function Wq(t){return`${t.options.appId}-${t.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh=new ev("@firebase/app-check");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mw(t,e){return ME()?Bq(t,e).catch(n=>{Sh.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(){return C2().enabled}async function L2(){const t=C2();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qq={error:"UNKNOWN_ERROR"};function Hq(t){return OE.encodeString(JSON.stringify(t),!1)}async function R0(t,e=!1,n=!1){const r=t.app;N2(r);const s=Ei(r);let i=s.token,o;if(i&&!Ih(i)&&(s.token=void 0,i=void 0),!i){const c=await s.cachedTokenPromise;c&&(Ih(c)?i=c:await Mw(r,void 0))}if(!e&&i&&Ih(i))return{token:i.token};let a=!1;if(O2())try{s.exchangeTokenPromise||(s.exchangeTokenPromise=k2(D2(r,await L2()),t.heartbeatServiceProvider).finally(()=>{s.exchangeTokenPromise=void 0}),a=!0);const c=await s.exchangeTokenPromise;return await Mw(r,c),s.token=c,{token:c.token}}catch(c){return c.code==="appCheck/throttled"||c.code==="appCheck/initial-throttle"?Sh.warn(c.message):n&&Sh.error(c),Vw(c)}try{s.exchangeTokenPromise||(s.exchangeTokenPromise=s.provider.getToken().finally(()=>{s.exchangeTokenPromise=void 0}),a=!0),i=await Ei(r).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"||c.code==="appCheck/initial-throttle"?Sh.warn(c.message):n&&Sh.error(c),o=c}let l;return i?o?Ih(i)?l={token:i.token,internalError:o}:l=Vw(o):(l={token:i.token},s.token=i,await Mw(r,i)):l=Vw(o),a&&Yq(r,l),l}async function Kq(t){const e=t.app;N2(e);const{provider:n}=Ei(e);if(O2()){const r=await L2(),{token:s}=await k2(D2(e,r),t.heartbeatServiceProvider);return{token:s}}else{const{token:r}=await n.getToken();return{token:r}}}function Gq(t,e,n,r){const{app:s}=t,i=Ei(s),o={next:n,error:r,type:e};if(i.tokenObservers=[...i.tokenObservers,o],i.token&&Ih(i.token)){const a=i.token;Promise.resolve().then(()=>{n({token:a.token}),xA(t)}).catch(()=>{})}i.cachedTokenPromise.then(()=>xA(t))}function M2(t,e){const n=Ei(t),r=n.tokenObservers.filter(s=>s.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function xA(t){const{app:e}=t,n=Ei(e);let r=n.tokenRefresher;r||(r=Qq(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function Qq(t){const{app:e}=t;return new Mq(async()=>{const n=Ei(e);let r;if(n.token?r=await R0(t,!0):r=await R0(t),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{const n=Ei(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const s=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,s),Math.max(0,r-Date.now())}else return 0},TA.RETRIAL_MIN_WAIT,TA.RETRIAL_MAX_WAIT)}function Yq(t,e){const n=Ei(t).tokenObservers;for(const r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Ih(t){return t.expireTimeMillis-Date.now()>0}function Vw(t){return{token:Hq(qq),error:t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jq{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=Ei(this.app);for(const n of e)M2(this.app,n.next);return Promise.resolve()}}function Xq(t,e){return new Jq(t,e)}function Zq(t){return{getToken:e=>R0(t,e),getLimitedUseToken:()=>Kq(t),addTokenListener:e=>Gq(t,"INTERNAL",e),removeTokenListener:e=>M2(t.app,e)}}const eH="@firebase/app-check",tH="0.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nH="app-check",AA="app-check-internal";function rH(){no(new _i(nH,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return Xq(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(AA).initialize()})),no(new _i(AA,t=>{const e=t.getProvider("app-check").getImmediate();return Zq(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Ms(eH,tH)}rH();var PA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Wa,V2;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,A){function R(){}R.prototype=A.prototype,I.F=A.prototype,I.prototype=new R,I.prototype.constructor=I,I.D=function(k,C,L){for(var O=Array(arguments.length-2),X=2;X<arguments.length;X++)O[X-2]=arguments[X];return A.prototype[C].apply(k,O)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,A,R){R||(R=0);const k=Array(16);if(typeof A=="string")for(var C=0;C<16;++C)k[C]=A.charCodeAt(R++)|A.charCodeAt(R++)<<8|A.charCodeAt(R++)<<16|A.charCodeAt(R++)<<24;else for(C=0;C<16;++C)k[C]=A[R++]|A[R++]<<8|A[R++]<<16|A[R++]<<24;A=I.g[0],R=I.g[1],C=I.g[2];let L=I.g[3],O;O=A+(L^R&(C^L))+k[0]+3614090360&4294967295,A=R+(O<<7&4294967295|O>>>25),O=L+(C^A&(R^C))+k[1]+3905402710&4294967295,L=A+(O<<12&4294967295|O>>>20),O=C+(R^L&(A^R))+k[2]+606105819&4294967295,C=L+(O<<17&4294967295|O>>>15),O=R+(A^C&(L^A))+k[3]+3250441966&4294967295,R=C+(O<<22&4294967295|O>>>10),O=A+(L^R&(C^L))+k[4]+4118548399&4294967295,A=R+(O<<7&4294967295|O>>>25),O=L+(C^A&(R^C))+k[5]+1200080426&4294967295,L=A+(O<<12&4294967295|O>>>20),O=C+(R^L&(A^R))+k[6]+2821735955&4294967295,C=L+(O<<17&4294967295|O>>>15),O=R+(A^C&(L^A))+k[7]+4249261313&4294967295,R=C+(O<<22&4294967295|O>>>10),O=A+(L^R&(C^L))+k[8]+1770035416&4294967295,A=R+(O<<7&4294967295|O>>>25),O=L+(C^A&(R^C))+k[9]+2336552879&4294967295,L=A+(O<<12&4294967295|O>>>20),O=C+(R^L&(A^R))+k[10]+4294925233&4294967295,C=L+(O<<17&4294967295|O>>>15),O=R+(A^C&(L^A))+k[11]+2304563134&4294967295,R=C+(O<<22&4294967295|O>>>10),O=A+(L^R&(C^L))+k[12]+1804603682&4294967295,A=R+(O<<7&4294967295|O>>>25),O=L+(C^A&(R^C))+k[13]+4254626195&4294967295,L=A+(O<<12&4294967295|O>>>20),O=C+(R^L&(A^R))+k[14]+2792965006&4294967295,C=L+(O<<17&4294967295|O>>>15),O=R+(A^C&(L^A))+k[15]+1236535329&4294967295,R=C+(O<<22&4294967295|O>>>10),O=A+(C^L&(R^C))+k[1]+4129170786&4294967295,A=R+(O<<5&4294967295|O>>>27),O=L+(R^C&(A^R))+k[6]+3225465664&4294967295,L=A+(O<<9&4294967295|O>>>23),O=C+(A^R&(L^A))+k[11]+643717713&4294967295,C=L+(O<<14&4294967295|O>>>18),O=R+(L^A&(C^L))+k[0]+3921069994&4294967295,R=C+(O<<20&4294967295|O>>>12),O=A+(C^L&(R^C))+k[5]+3593408605&4294967295,A=R+(O<<5&4294967295|O>>>27),O=L+(R^C&(A^R))+k[10]+38016083&4294967295,L=A+(O<<9&4294967295|O>>>23),O=C+(A^R&(L^A))+k[15]+3634488961&4294967295,C=L+(O<<14&4294967295|O>>>18),O=R+(L^A&(C^L))+k[4]+3889429448&4294967295,R=C+(O<<20&4294967295|O>>>12),O=A+(C^L&(R^C))+k[9]+568446438&4294967295,A=R+(O<<5&4294967295|O>>>27),O=L+(R^C&(A^R))+k[14]+3275163606&4294967295,L=A+(O<<9&4294967295|O>>>23),O=C+(A^R&(L^A))+k[3]+4107603335&4294967295,C=L+(O<<14&4294967295|O>>>18),O=R+(L^A&(C^L))+k[8]+1163531501&4294967295,R=C+(O<<20&4294967295|O>>>12),O=A+(C^L&(R^C))+k[13]+2850285829&4294967295,A=R+(O<<5&4294967295|O>>>27),O=L+(R^C&(A^R))+k[2]+4243563512&4294967295,L=A+(O<<9&4294967295|O>>>23),O=C+(A^R&(L^A))+k[7]+1735328473&4294967295,C=L+(O<<14&4294967295|O>>>18),O=R+(L^A&(C^L))+k[12]+2368359562&4294967295,R=C+(O<<20&4294967295|O>>>12),O=A+(R^C^L)+k[5]+4294588738&4294967295,A=R+(O<<4&4294967295|O>>>28),O=L+(A^R^C)+k[8]+2272392833&4294967295,L=A+(O<<11&4294967295|O>>>21),O=C+(L^A^R)+k[11]+1839030562&4294967295,C=L+(O<<16&4294967295|O>>>16),O=R+(C^L^A)+k[14]+4259657740&4294967295,R=C+(O<<23&4294967295|O>>>9),O=A+(R^C^L)+k[1]+2763975236&4294967295,A=R+(O<<4&4294967295|O>>>28),O=L+(A^R^C)+k[4]+1272893353&4294967295,L=A+(O<<11&4294967295|O>>>21),O=C+(L^A^R)+k[7]+4139469664&4294967295,C=L+(O<<16&4294967295|O>>>16),O=R+(C^L^A)+k[10]+3200236656&4294967295,R=C+(O<<23&4294967295|O>>>9),O=A+(R^C^L)+k[13]+681279174&4294967295,A=R+(O<<4&4294967295|O>>>28),O=L+(A^R^C)+k[0]+3936430074&4294967295,L=A+(O<<11&4294967295|O>>>21),O=C+(L^A^R)+k[3]+3572445317&4294967295,C=L+(O<<16&4294967295|O>>>16),O=R+(C^L^A)+k[6]+76029189&4294967295,R=C+(O<<23&4294967295|O>>>9),O=A+(R^C^L)+k[9]+3654602809&4294967295,A=R+(O<<4&4294967295|O>>>28),O=L+(A^R^C)+k[12]+3873151461&4294967295,L=A+(O<<11&4294967295|O>>>21),O=C+(L^A^R)+k[15]+530742520&4294967295,C=L+(O<<16&4294967295|O>>>16),O=R+(C^L^A)+k[2]+3299628645&4294967295,R=C+(O<<23&4294967295|O>>>9),O=A+(C^(R|~L))+k[0]+4096336452&4294967295,A=R+(O<<6&4294967295|O>>>26),O=L+(R^(A|~C))+k[7]+1126891415&4294967295,L=A+(O<<10&4294967295|O>>>22),O=C+(A^(L|~R))+k[14]+2878612391&4294967295,C=L+(O<<15&4294967295|O>>>17),O=R+(L^(C|~A))+k[5]+4237533241&4294967295,R=C+(O<<21&4294967295|O>>>11),O=A+(C^(R|~L))+k[12]+1700485571&4294967295,A=R+(O<<6&4294967295|O>>>26),O=L+(R^(A|~C))+k[3]+2399980690&4294967295,L=A+(O<<10&4294967295|O>>>22),O=C+(A^(L|~R))+k[10]+4293915773&4294967295,C=L+(O<<15&4294967295|O>>>17),O=R+(L^(C|~A))+k[1]+2240044497&4294967295,R=C+(O<<21&4294967295|O>>>11),O=A+(C^(R|~L))+k[8]+1873313359&4294967295,A=R+(O<<6&4294967295|O>>>26),O=L+(R^(A|~C))+k[15]+4264355552&4294967295,L=A+(O<<10&4294967295|O>>>22),O=C+(A^(L|~R))+k[6]+2734768916&4294967295,C=L+(O<<15&4294967295|O>>>17),O=R+(L^(C|~A))+k[13]+1309151649&4294967295,R=C+(O<<21&4294967295|O>>>11),O=A+(C^(R|~L))+k[4]+4149444226&4294967295,A=R+(O<<6&4294967295|O>>>26),O=L+(R^(A|~C))+k[11]+3174756917&4294967295,L=A+(O<<10&4294967295|O>>>22),O=C+(A^(L|~R))+k[2]+718787259&4294967295,C=L+(O<<15&4294967295|O>>>17),O=R+(L^(C|~A))+k[9]+3951481745&4294967295,I.g[0]=I.g[0]+A&4294967295,I.g[1]=I.g[1]+(C+(O<<21&4294967295|O>>>11))&4294967295,I.g[2]=I.g[2]+C&4294967295,I.g[3]=I.g[3]+L&4294967295}r.prototype.v=function(I,A){A===void 0&&(A=I.length);const R=A-this.blockSize,k=this.C;let C=this.h,L=0;for(;L<A;){if(C==0)for(;L<=R;)s(this,I,L),L+=this.blockSize;if(typeof I=="string"){for(;L<A;)if(k[C++]=I.charCodeAt(L++),C==this.blockSize){s(this,k),C=0;break}}else for(;L<A;)if(k[C++]=I[L++],C==this.blockSize){s(this,k),C=0;break}}this.h=C,this.o+=A},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var A=1;A<I.length-8;++A)I[A]=0;A=this.o*8;for(var R=I.length-8;R<I.length;++R)I[R]=A&255,A/=256;for(this.v(I),I=Array(16),A=0,R=0;R<4;++R)for(let k=0;k<32;k+=8)I[A++]=this.g[R]>>>k&255;return I};function i(I,A){var R=a;return Object.prototype.hasOwnProperty.call(R,I)?R[I]:R[I]=A(I)}function o(I,A){this.h=A;const R=[];let k=!0;for(let C=I.length-1;C>=0;C--){const L=I[C]|0;k&&L==A||(R[C]=L,k=!1)}this.g=R}var a={};function l(I){return-128<=I&&I<128?i(I,function(A){return new o([A|0],A<0?-1:0)}):new o([I|0],I<0?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return d;if(I<0)return E(c(-I));const A=[];let R=1;for(let k=0;I>=R;k++)A[k]=I/R|0,R*=4294967296;return new o(A,0)}function u(I,A){if(I.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(I.charAt(0)=="-")return E(u(I.substring(1),A));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=c(Math.pow(A,8));let k=d;for(let L=0;L<I.length;L+=8){var C=Math.min(8,I.length-L);const O=parseInt(I.substring(L,L+C),A);C<8?(C=c(Math.pow(A,C)),k=k.j(C).add(c(O))):(k=k.j(R),k=k.add(c(O)))}return k}var d=l(0),m=l(1),p=l(16777216);t=o.prototype,t.m=function(){if(g(this))return-E(this).m();let I=0,A=1;for(let R=0;R<this.g.length;R++){const k=this.i(R);I+=(k>=0?k:4294967296+k)*A,A*=4294967296}return I},t.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(v(this))return"0";if(g(this))return"-"+E(this).toString(I);const A=c(Math.pow(I,6));var R=this;let k="";for(;;){const C=P(R,A).g;R=b(R,C.j(A));let L=((R.g.length>0?R.g[0]:R.h)>>>0).toString(I);if(R=C,v(R))return L+k;for(;L.length<6;)L="0"+L;k=L+k}},t.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function v(I){if(I.h!=0)return!1;for(let A=0;A<I.g.length;A++)if(I.g[A]!=0)return!1;return!0}function g(I){return I.h==-1}t.l=function(I){return I=b(this,I),g(I)?-1:v(I)?0:1};function E(I){const A=I.g.length,R=[];for(let k=0;k<A;k++)R[k]=~I.g[k];return new o(R,~I.h).add(m)}t.abs=function(){return g(this)?E(this):this},t.add=function(I){const A=Math.max(this.g.length,I.g.length),R=[];let k=0;for(let C=0;C<=A;C++){let L=k+(this.i(C)&65535)+(I.i(C)&65535),O=(L>>>16)+(this.i(C)>>>16)+(I.i(C)>>>16);k=O>>>16,L&=65535,O&=65535,R[C]=O<<16|L}return new o(R,R[R.length-1]&-2147483648?-1:0)};function b(I,A){return I.add(E(A))}t.j=function(I){if(v(this)||v(I))return d;if(g(this))return g(I)?E(this).j(E(I)):E(E(this).j(I));if(g(I))return E(this.j(E(I)));if(this.l(p)<0&&I.l(p)<0)return c(this.m()*I.m());const A=this.g.length+I.g.length,R=[];for(var k=0;k<2*A;k++)R[k]=0;for(k=0;k<this.g.length;k++)for(let C=0;C<I.g.length;C++){const L=this.i(k)>>>16,O=this.i(k)&65535,X=I.i(C)>>>16,ke=I.i(C)&65535;R[2*k+2*C]+=O*ke,_(R,2*k+2*C),R[2*k+2*C+1]+=L*ke,_(R,2*k+2*C+1),R[2*k+2*C+1]+=O*X,_(R,2*k+2*C+1),R[2*k+2*C+2]+=L*X,_(R,2*k+2*C+2)}for(I=0;I<A;I++)R[I]=R[2*I+1]<<16|R[2*I];for(I=A;I<2*A;I++)R[I]=0;return new o(R,0)};function _(I,A){for(;(I[A]&65535)!=I[A];)I[A+1]+=I[A]>>>16,I[A]&=65535,A++}function S(I,A){this.g=I,this.h=A}function P(I,A){if(v(A))throw Error("division by zero");if(v(I))return new S(d,d);if(g(I))return A=P(E(I),A),new S(E(A.g),E(A.h));if(g(A))return A=P(I,E(A)),new S(E(A.g),A.h);if(I.g.length>30){if(g(I)||g(A))throw Error("slowDivide_ only works with positive integers.");for(var R=m,k=A;k.l(I)<=0;)R=T(R),k=T(k);var C=N(R,1),L=N(k,1);for(k=N(k,2),R=N(R,2);!v(k);){var O=L.add(k);O.l(I)<=0&&(C=C.add(R),L=O),k=N(k,1),R=N(R,1)}return A=b(I,C.j(A)),new S(C,A)}for(C=d;I.l(A)>=0;){for(R=Math.max(1,Math.floor(I.m()/A.m())),k=Math.ceil(Math.log(R)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),L=c(R),O=L.j(A);g(O)||O.l(I)>0;)R-=k,L=c(R),O=L.j(A);v(L)&&(L=m),C=C.add(L),I=b(I,O)}return new S(C,I)}t.B=function(I){return P(this,I).h},t.and=function(I){const A=Math.max(this.g.length,I.g.length),R=[];for(let k=0;k<A;k++)R[k]=this.i(k)&I.i(k);return new o(R,this.h&I.h)},t.or=function(I){const A=Math.max(this.g.length,I.g.length),R=[];for(let k=0;k<A;k++)R[k]=this.i(k)|I.i(k);return new o(R,this.h|I.h)},t.xor=function(I){const A=Math.max(this.g.length,I.g.length),R=[];for(let k=0;k<A;k++)R[k]=this.i(k)^I.i(k);return new o(R,this.h^I.h)};function T(I){const A=I.g.length+1,R=[];for(let k=0;k<A;k++)R[k]=I.i(k)<<1|I.i(k-1)>>>31;return new o(R,I.h)}function N(I,A){const R=A>>5;A%=32;const k=I.g.length-R,C=[];for(let L=0;L<k;L++)C[L]=A>0?I.i(L+R)>>>A|I.i(L+R+1)<<32-A:I.i(L+R);return new o(C,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,V2=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,Wa=o}).apply(typeof PA<"u"?PA:typeof self<"u"?self:typeof window<"u"?window:{});var ep=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var j2,Th,F2,Up,C0,U2,$2,B2;(function(){var t,e=Object.defineProperty;function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof ep=="object"&&ep];for(var w=0;w<h.length;++w){var x=h[w];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=n(this);function s(h,w){if(w)e:{var x=r;h=h.split(".");for(var D=0;D<h.length-1;D++){var B=h[D];if(!(B in x))break e;x=x[B]}h=h[h.length-1],D=x[h],w=w(D),w!=D&&w!=null&&e(x,h,{configurable:!0,writable:!0,value:w})}}s("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(h){return h||function(w){var x=[],D;for(D in w)Object.prototype.hasOwnProperty.call(w,D)&&x.push([D,w[D]]);return x}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(h){var w=typeof h;return w=="object"&&h!=null||w=="function"}function l(h,w,x){return h.call.apply(h.bind,arguments)}function c(h,w,x){return c=l,c.apply(null,arguments)}function u(h,w){var x=Array.prototype.slice.call(arguments,1);return function(){var D=x.slice();return D.push.apply(D,arguments),h.apply(this,D)}}function d(h,w){function x(){}x.prototype=w.prototype,h.Z=w.prototype,h.prototype=new x,h.prototype.constructor=h,h.Ob=function(D,B,K){for(var Ie=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)Ie[Nt-2]=arguments[Nt];return w.prototype[B].apply(D,Ie)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function p(h){const w=h.length;if(w>0){const x=Array(w);for(let D=0;D<w;D++)x[D]=h[D];return x}return[]}function v(h,w){for(let D=1;D<arguments.length;D++){const B=arguments[D];var x=typeof B;if(x=x!="object"?x:B?Array.isArray(B)?"array":x:"null",x=="array"||x=="object"&&typeof B.length=="number"){x=h.length||0;const K=B.length||0;h.length=x+K;for(let Ie=0;Ie<K;Ie++)h[x+Ie]=B[Ie]}else h.push(B)}}class g{constructor(w,x){this.i=w,this.j=x,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function E(h){o.setTimeout(()=>{throw h},0)}function b(){var h=I;let w=null;return h.g&&(w=h.g,h.g=h.g.next,h.g||(h.h=null),w.next=null),w}class _{constructor(){this.h=this.g=null}add(w,x){const D=S.get();D.set(w,x),this.h?this.h.next=D:this.g=D,this.h=D}}var S=new g(()=>new P,h=>h.reset());class P{constructor(){this.next=this.g=this.h=null}set(w,x){this.h=w,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let T,N=!1,I=new _,A=()=>{const h=Promise.resolve(void 0);T=()=>{h.then(R)}};function R(){for(var h;h=b();){try{h.h.call(h.g)}catch(x){E(x)}var w=S;w.j(h),w.h<100&&(w.h++,h.next=w.g,w.g=h)}N=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(h,w){this.type=h,this.g=this.target=w,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var h=!1,w=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const x=()=>{};o.addEventListener("test",x,w),o.removeEventListener("test",x,w)}catch{}return h}();function O(h){return/^[\s\xa0]*$/.test(h)}function X(h,w){C.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,w)}d(X,C),X.prototype.init=function(h,w){const x=this.type=h.type,D=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=w,w=h.relatedTarget,w||(x=="mouseover"?w=h.fromElement:x=="mouseout"&&(w=h.toElement)),this.relatedTarget=w,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&X.Z.h.call(this)},X.prototype.h=function(){X.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ke="closure_listenable_"+(Math.random()*1e6|0),Oe=0;function je(h,w,x,D,B){this.listener=h,this.proxy=null,this.src=w,this.type=x,this.capture=!!D,this.ha=B,this.key=++Oe,this.da=this.fa=!1}function W(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function G(h,w,x){for(const D in h)w.call(x,h[D],D,h)}function ae(h,w){for(const x in h)w.call(void 0,h[x],x,h)}function pe(h){const w={};for(const x in h)w[x]=h[x];return w}const fe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ge(h,w){let x,D;for(let B=1;B<arguments.length;B++){D=arguments[B];for(x in D)h[x]=D[x];for(let K=0;K<fe.length;K++)x=fe[K],Object.prototype.hasOwnProperty.call(D,x)&&(h[x]=D[x])}}function xe(h){this.src=h,this.g={},this.h=0}xe.prototype.add=function(h,w,x,D,B){const K=h.toString();h=this.g[K],h||(h=this.g[K]=[],this.h++);const Ie=Q(h,w,D,B);return Ie>-1?(w=h[Ie],x||(w.fa=!1)):(w=new je(w,this.src,K,!!D,B),w.fa=x,h.push(w)),w};function ve(h,w){const x=w.type;if(x in h.g){var D=h.g[x],B=Array.prototype.indexOf.call(D,w,void 0),K;(K=B>=0)&&Array.prototype.splice.call(D,B,1),K&&(W(w),h.g[x].length==0&&(delete h.g[x],h.h--))}}function Q(h,w,x,D){for(let B=0;B<h.length;++B){const K=h[B];if(!K.da&&K.listener==w&&K.capture==!!x&&K.ha==D)return B}return-1}var qe="closure_lm_"+(Math.random()*1e6|0),cn={};function cr(h,w,x,D,B){if(Array.isArray(w)){for(let K=0;K<w.length;K++)cr(h,w[K],x,D,B);return null}return x=et(x),h&&h[ke]?h.J(w,x,a(D)?!!D.capture:!1,B):Yn(h,w,x,!1,D,B)}function Yn(h,w,x,D,B,K){if(!w)throw Error("Invalid event type");const Ie=a(B)?!!B.capture:!!B;let Nt=ue(h);if(Nt||(h[qe]=Nt=new xe(h)),x=Nt.add(w,x,D,Ie,K),x.proxy)return x;if(D=tr(),x.proxy=D,D.src=h,D.listener=x,h.addEventListener)L||(B=Ie),B===void 0&&(B=!1),h.addEventListener(w.toString(),D,B);else if(h.attachEvent)h.attachEvent(Dr(w.toString()),D);else if(h.addListener&&h.removeListener)h.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return x}function tr(){function h(x){return w.call(h.src,h.listener,x)}const w=J;return h}function Nr(h,w,x,D,B){if(Array.isArray(w))for(var K=0;K<w.length;K++)Nr(h,w[K],x,D,B);else D=a(D)?!!D.capture:!!D,x=et(x),h&&h[ke]?(h=h.i,K=String(w).toString(),K in h.g&&(w=h.g[K],x=Q(w,x,D,B),x>-1&&(W(w[x]),Array.prototype.splice.call(w,x,1),w.length==0&&(delete h.g[K],h.h--)))):h&&(h=ue(h))&&(w=h.g[w.toString()],h=-1,w&&(h=Q(w,x,D,B)),(x=h>-1?w[h]:null)&&kr(x))}function kr(h){if(typeof h!="number"&&h&&!h.da){var w=h.src;if(w&&w[ke])ve(w.i,h);else{var x=h.type,D=h.proxy;w.removeEventListener?w.removeEventListener(x,D,h.capture):w.detachEvent?w.detachEvent(Dr(x),D):w.addListener&&w.removeListener&&w.removeListener(D),(x=ue(w))?(ve(x,h),x.h==0&&(x.src=null,w[qe]=null)):W(h)}}}function Dr(h){return h in cn?cn[h]:cn[h]="on"+h}function J(h,w){if(h.da)h=!0;else{w=new X(w,this);const x=h.listener,D=h.ha||h.src;h.fa&&kr(h),h=x.call(D,w)}return h}function ue(h){return h=h[qe],h instanceof xe?h:null}var Ee="__closure_events_fn_"+(Math.random()*1e9>>>0);function et(h){return typeof h=="function"?h:(h[Ee]||(h[Ee]=function(w){return h.handleEvent(w)}),h[Ee])}function he(){k.call(this),this.i=new xe(this),this.M=this,this.G=null}d(he,k),he.prototype[ke]=!0,he.prototype.removeEventListener=function(h,w,x,D){Nr(this,h,w,x,D)};function Ce(h,w){var x,D=h.G;if(D)for(x=[];D;D=D.G)x.push(D);if(h=h.M,D=w.type||w,typeof w=="string")w=new C(w,h);else if(w instanceof C)w.target=w.target||h;else{var B=w;w=new C(D,h),Ge(w,B)}B=!0;let K,Ie;if(x)for(Ie=x.length-1;Ie>=0;Ie--)K=w.g=x[Ie],B=Fe(K,D,!0,w)&&B;if(K=w.g=h,B=Fe(K,D,!0,w)&&B,B=Fe(K,D,!1,w)&&B,x)for(Ie=0;Ie<x.length;Ie++)K=w.g=x[Ie],B=Fe(K,D,!1,w)&&B}he.prototype.N=function(){if(he.Z.N.call(this),this.i){var h=this.i;for(const w in h.g){const x=h.g[w];for(let D=0;D<x.length;D++)W(x[D]);delete h.g[w],h.h--}}this.G=null},he.prototype.J=function(h,w,x,D){return this.i.add(String(h),w,!1,x,D)},he.prototype.K=function(h,w,x,D){return this.i.add(String(h),w,!0,x,D)};function Fe(h,w,x,D){if(w=h.i.g[String(w)],!w)return!0;w=w.concat();let B=!0;for(let K=0;K<w.length;++K){const Ie=w[K];if(Ie&&!Ie.da&&Ie.capture==x){const Nt=Ie.listener,gr=Ie.ha||Ie.src;Ie.fa&&ve(h.i,Ie),B=Nt.call(gr,D)!==!1&&B}}return B&&!D.defaultPrevented}function rt(h,w){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=c(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:o.setTimeout(h,w||0)}function ct(h){h.g=rt(()=>{h.g=null,h.i&&(h.i=!1,ct(h))},h.l);const w=h.h;h.h=null,h.m.apply(null,w)}class Lt extends k{constructor(w,x){super(),this.m=w,this.l=x,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:ct(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ct(h){k.call(this),this.h=h,this.g={}}d(Ct,k);var dt=[];function Y(h){G(h.g,function(w,x){this.g.hasOwnProperty(x)&&kr(w)},h),h.g={}}Ct.prototype.N=function(){Ct.Z.N.call(this),Y(this)},Ct.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Te=o.JSON.stringify,we=o.JSON.parse,le=class{stringify(h){return o.JSON.stringify(h,void 0)}parse(h){return o.JSON.parse(h,void 0)}};function ce(){}function st(){}var yt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function _n(){C.call(this,"d")}d(_n,C);function tn(){C.call(this,"c")}d(tn,C);var j={},U=null;function V(){return U=U||new he}j.Ia="serverreachability";function Z(h){C.call(this,j.Ia,h)}d(Z,C);function q(h){const w=V();Ce(w,new Z(w))}j.STAT_EVENT="statevent";function oe(h,w){C.call(this,j.STAT_EVENT,h),this.stat=w}d(oe,C);function H(h){const w=V();Ce(w,new oe(w,h))}j.Ja="timingevent";function Pe(h,w){C.call(this,j.Ja,h),this.size=w}d(Pe,C);function it(h,w){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){h()},w)}function te(){this.g=!0}te.prototype.ua=function(){this.g=!1};function ne(h,w,x,D,B,K){h.info(function(){if(h.g)if(K){var Ie="",Nt=K.split("&");for(let bn=0;bn<Nt.length;bn++){var gr=Nt[bn].split("=");if(gr.length>1){const Sr=gr[0];gr=gr[1];const Ci=Sr.split("_");Ie=Ci.length>=2&&Ci[1]=="type"?Ie+(Sr+"="+gr+"&"):Ie+(Sr+"=redacted&")}}}else Ie=null;else Ie=K;return"XMLHTTP REQ ("+D+") [attempt "+B+"]: "+w+`
`+x+`
`+Ie})}function be(h,w,x,D,B,K,Ie){h.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+B+"]: "+w+`
`+x+`
`+K+" "+Ie})}function ze(h,w,x,D){h.info(function(){return"XMLHTTP TEXT ("+w+"): "+mt(h,x)+(D?" "+D:"")})}function Qe(h,w){h.info(function(){return"TIMEOUT: "+w})}te.prototype.info=function(){};function mt(h,w){if(!h.g)return w;if(!w)return null;try{const K=JSON.parse(w);if(K){for(h=0;h<K.length;h++)if(Array.isArray(K[h])){var x=K[h];if(!(x.length<2)){var D=x[1];if(Array.isArray(D)&&!(D.length<1)){var B=D[0];if(B!="noop"&&B!="stop"&&B!="close")for(let Ie=1;Ie<D.length;Ie++)D[Ie]=""}}}}return Te(K)}catch{return w}}var ht={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Re={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ot;function Bt(){}d(Bt,ce),Bt.prototype.g=function(){return new XMLHttpRequest},ot=new Bt;function It(h){return encodeURIComponent(String(h))}function ut(h){var w=1;h=h.split(":");const x=[];for(;w>0&&h.length;)x.push(h.shift()),w--;return h.length&&x.push(h.join(":")),x}function Pt(h,w,x,D){this.j=h,this.i=w,this.l=x,this.S=D||1,this.V=new Ct(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}var un={},Mt={};function Pn(h,w,x){h.M=1,h.A=ls(Xt(w)),h.u=x,h.R=!0,ft(h,null)}function ft(h,w){h.F=Date.now(),xt(h),h.B=Xt(h.A);var x=h.B,D=h.S;Array.isArray(D)||(D=[String(D)]),rr(x.i,"t",D),h.C=0,x=h.j.L,h.h=new Me,h.g=VI(h.j,x?w:null,!h.u),h.P>0&&(h.O=new Lt(c(h.Y,h,h.g),h.P)),w=h.V,x=h.g,D=h.ba;var B="readystatechange";Array.isArray(B)||(B&&(dt[0]=B.toString()),B=dt);for(let K=0;K<B.length;K++){const Ie=cr(x,B[K],D||w.handleEvent,!1,w.h||w);if(!Ie)break;w.g[Ie.key]=Ie}w=h.J?pe(h.J):{},h.u?(h.v||(h.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,w)):(h.v="GET",h.g.ea(h.B,h.v,null,w)),q(),ne(h.i,h.v,h.B,h.l,h.S,h.u)}Pt.prototype.ba=function(h){h=h.target;const w=this.O;w&&Go(h)==3?w.j():this.Y(h)},Pt.prototype.Y=function(h){try{if(h==this.g)e:{const Nt=Go(this.g),gr=this.g.ya(),bn=this.g.ca();if(!(Nt<3)&&(Nt!=3||this.g&&(this.h.h||this.g.la()||xI(this.g)))){this.K||Nt!=4||gr==7||(gr==8||bn<=0?q(3):q(2)),ln(this);var w=this.g.ca();this.X=w;var x=Yt(this);if(this.o=w==200,be(this.i,this.v,this.B,this.l,this.S,Nt,w),this.o){if(this.U&&!this.L){t:{if(this.g){var D,B=this.g;if((D=B.g?B.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(D)){var K=D;break t}}K=null}if(h=K)ze(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,De(this,h);else{this.o=!1,this.m=3,H(12),lt(this),He(this);break e}}if(this.R){h=!0;let Sr;for(;!this.K&&this.C<x.length;)if(Sr=an(this,x),Sr==Mt){Nt==4&&(this.m=4,H(14),h=!1),ze(this.i,this.l,null,"[Incomplete Response]");break}else if(Sr==un){this.m=4,H(15),ze(this.i,this.l,x,"[Invalid Chunk]"),h=!1;break}else ze(this.i,this.l,Sr,null),De(this,Sr);if(on(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Nt!=4||x.length!=0||this.h.h||(this.m=1,H(16),h=!1),this.o=this.o&&h,!h)ze(this.i,this.l,x,"[Invalid Chunked Response]"),lt(this),He(this);else if(x.length>0&&!this.W){this.W=!0;var Ie=this.j;Ie.g==this&&Ie.aa&&!Ie.P&&(Ie.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),qv(Ie),Ie.P=!0,H(11))}}else ze(this.i,this.l,x,null),De(this,x);Nt==4&&lt(this),this.o&&!this.K&&(Nt==4?DI(this.j,this):(this.o=!1,xt(this)))}else jj(this.g),w==400&&x.indexOf("Unknown SID")>0?(this.m=3,H(12)):(this.m=0,H(13)),lt(this),He(this)}}}catch{}finally{}};function Yt(h){if(!on(h))return h.g.la();const w=xI(h.g);if(w==="")return"";let x="";const D=w.length,B=Go(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return lt(h),He(h),"";h.h.i=new o.TextDecoder}for(let K=0;K<D;K++)h.h.h=!0,x+=h.h.i.decode(w[K],{stream:!(B&&K==D-1)});return w.length=0,h.h.g+=x,h.C=0,h.h.g}function on(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function an(h,w){var x=h.C,D=w.indexOf(`
`,x);return D==-1?Mt:(x=Number(w.substring(x,D)),isNaN(x)?un:(D+=1,D+x>w.length?Mt:(w=w.slice(D,D+x),h.C=D+x,w)))}Pt.prototype.cancel=function(){this.K=!0,lt(this)};function xt(h){h.T=Date.now()+h.H,vt(h,h.H)}function vt(h,w){if(h.D!=null)throw Error("WatchDog timer not null");h.D=it(c(h.aa,h),w)}function ln(h){h.D&&(o.clearTimeout(h.D),h.D=null)}Pt.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Qe(this.i,this.B),this.M!=2&&(q(),H(17)),lt(this),this.m=2,He(this)):vt(this,this.T-h)};function He(h){h.j.I==0||h.K||DI(h.j,h)}function lt(h){ln(h);var w=h.O;w&&typeof w.dispose=="function"&&w.dispose(),h.O=null,Y(h.V),h.g&&(w=h.g,h.g=null,w.abort(),w.dispose())}function De(h,w){try{var x=h.j;if(x.I!=0&&(x.g==h||_t(x.h,h))){if(!h.L&&_t(x.h,h)&&x.I==3){try{var D=x.Ba.g.parse(w)}catch{D=null}if(Array.isArray(D)&&D.length==3){var B=D;if(B[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<h.F)xm(x),Im(x);else break e;Wv(x),H(18)}}else x.xa=B[1],0<x.xa-x.K&&B[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=it(c(x.Va,x),6e3));nt(x.h)<=1&&x.ta&&(x.ta=void 0)}else Il(x,11)}else if((h.L||x.g==h)&&xm(x),!O(w))for(B=x.Ba.g.parse(w),w=0;w<B.length;w++){let bn=B[w];const Sr=bn[0];if(!(Sr<=x.K))if(x.K=Sr,bn=bn[1],x.I==2)if(bn[0]=="c"){x.M=bn[1],x.ba=bn[2];const Ci=bn[3];Ci!=null&&(x.ka=Ci,x.j.info("VER="+x.ka));const Tl=bn[4];Tl!=null&&(x.za=Tl,x.j.info("SVER="+x.za));const Qo=bn[5];Qo!=null&&typeof Qo=="number"&&Qo>0&&(D=1.5*Qo,x.O=D,x.j.info("backChannelRequestTimeoutMs_="+D)),D=x;const Yo=h.g;if(Yo){const Pm=Yo.g?Yo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Pm){var K=D.h;K.g||Pm.indexOf("spdy")==-1&&Pm.indexOf("quic")==-1&&Pm.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(zt(K,K.h),K.h=null))}if(D.G){const Hv=Yo.g?Yo.g.getResponseHeader("X-HTTP-Session-Id"):null;Hv&&(D.wa=Hv,wt(D.J,D.G,Hv))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-h.F,x.j.info("Handshake RTT: "+x.T+"ms")),D=x;var Ie=h;if(D.na=MI(D,D.L?D.ba:null,D.W),Ie.L){dn(D.h,Ie);var Nt=Ie,gr=D.O;gr&&(Nt.H=gr),Nt.D&&(ln(Nt),xt(Nt)),D.g=Ie}else NI(D);x.i.length>0&&Tm(x)}else bn[0]!="stop"&&bn[0]!="close"||Il(x,7);else x.I==3&&(bn[0]=="stop"||bn[0]=="close"?bn[0]=="stop"?Il(x,7):zv(x):bn[0]!="noop"&&x.l&&x.l.qa(bn),x.A=0)}}q(4)}catch{}}var tt=class{constructor(h,w){this.g=h,this.map=w}};function Ue(h){this.l=h||10,o.PerformanceNavigationTiming?(h=o.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function se(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function nt(h){return h.h?1:h.g?h.g.size:0}function _t(h,w){return h.h?h.h==w:h.g?h.g.has(w):!1}function zt(h,w){h.g?h.g.add(w):h.h=w}function dn(h,w){h.h&&h.h==w?h.h=null:h.g&&h.g.has(w)&&h.g.delete(w)}Ue.prototype.cancel=function(){if(this.i=Jt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Jt(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let w=h.i;for(const x of h.g.values())w=w.concat(x.G);return w}return p(h.i)}var Be=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function In(h,w){if(h){h=h.split("&");for(let x=0;x<h.length;x++){const D=h[x].indexOf("=");let B,K=null;D>=0?(B=h[x].substring(0,D),K=h[x].substring(D+1)):B=h[x],w(B,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Vt(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;h instanceof Vt?(this.l=h.l,nr(this,h.j),this.o=h.o,this.g=h.g,Xe(this,h.u),this.h=h.h,Kt(this,mr(h.i)),this.m=h.m):h&&(w=String(h).match(Be))?(this.l=!1,nr(this,w[1]||"",!0),this.o=ti(w[2]||""),this.g=ti(w[3]||"",!0),Xe(this,w[4]),this.h=ti(w[5]||"",!0),Kt(this,w[6]||"",!0),this.m=ti(w[7]||"")):(this.l=!1,this.i=new Br(null,this.l))}Vt.prototype.toString=function(){const h=[];var w=this.j;w&&h.push(Jn(w,cs,!0),":");var x=this.g;return(x||w=="file")&&(h.push("//"),(w=this.o)&&h.push(Jn(w,cs,!0),"@"),h.push(It(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&h.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&h.push("/"),h.push(Jn(x,x.charAt(0)=="/"?Et:Rn,!0))),(x=this.i.toString())&&h.push("?",x),(x=this.m)&&h.push("#",Jn(x,ni)),h.join("")},Vt.prototype.resolve=function(h){const w=Xt(this);let x=!!h.j;x?nr(w,h.j):x=!!h.o,x?w.o=h.o:x=!!h.g,x?w.g=h.g:x=h.u!=null;var D=h.h;if(x)Xe(w,h.u);else if(x=!!h.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var B=w.h.lastIndexOf("/");B!=-1&&(D=w.h.slice(0,B+1)+D)}if(B=D,B==".."||B==".")D="";else if(B.indexOf("./")!=-1||B.indexOf("/.")!=-1){D=B.lastIndexOf("/",0)==0,B=B.split("/");const K=[];for(let Ie=0;Ie<B.length;){const Nt=B[Ie++];Nt=="."?D&&Ie==B.length&&K.push(""):Nt==".."?((K.length>1||K.length==1&&K[0]!="")&&K.pop(),D&&Ie==B.length&&K.push("")):(K.push(Nt),D=!0)}D=K.join("/")}else D=B}return x?w.h=D:x=h.i.toString()!=="",x?Kt(w,mr(h.i)):x=!!h.m,x&&(w.m=h.m),w};function Xt(h){return new Vt(h)}function nr(h,w,x){h.j=x?ti(w,!0):w,h.j&&(h.j=h.j.replace(/:$/,""))}function Xe(h,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);h.u=w}else h.u=null}function Kt(h,w,x){w instanceof Br?(h.i=w,Or(h.i,h.l)):(x||(w=Jn(w,xs)),h.i=new Br(w,h.l))}function wt(h,w,x){h.i.set(w,x)}function ls(h){return wt(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function ti(h,w){return h?w?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Jn(h,w,x){return typeof h=="string"?(h=encodeURI(h).replace(w,Ts),x&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Ts(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var cs=/[#\/\?@]/g,Rn=/[#\?:]/g,Et=/[#\?]/g,xs=/[#\?@]/g,ni=/#/g;function Br(h,w){this.h=this.g=null,this.i=h||null,this.j=!!w}function Ke(h){h.g||(h.g=new Map,h.h=0,h.i&&In(h.i,function(w,x){h.add(decodeURIComponent(w.replace(/\+/g," ")),x)}))}t=Br.prototype,t.add=function(h,w){Ke(this),this.i=null,h=jn(this,h);let x=this.g.get(h);return x||this.g.set(h,x=[]),x.push(w),this.h+=1,this};function hn(h,w){Ke(h),w=jn(h,w),h.g.has(w)&&(h.i=null,h.h-=h.g.get(w).length,h.g.delete(w))}function Vn(h,w){return Ke(h),w=jn(h,w),h.g.has(w)}t.forEach=function(h,w){Ke(this),this.g.forEach(function(x,D){x.forEach(function(B){h.call(w,B,D,this)},this)},this)};function zr(h,w){Ke(h);let x=[];if(typeof w=="string")Vn(h,w)&&(x=x.concat(h.g.get(jn(h,w))));else for(h=Array.from(h.g.values()),w=0;w<h.length;w++)x=x.concat(h[w]);return x}t.set=function(h,w){return Ke(this),this.i=null,h=jn(this,h),Vn(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[w]),this.h+=1,this},t.get=function(h,w){return h?(h=zr(this,h),h.length>0?String(h[0]):w):w};function rr(h,w,x){hn(h,w),x.length>0&&(h.i=null,h.g.set(jn(h,w),p(x)),h.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],w=Array.from(this.g.keys());for(let D=0;D<w.length;D++){var x=w[D];const B=It(x);x=zr(this,x);for(let K=0;K<x.length;K++){let Ie=B;x[K]!==""&&(Ie+="="+It(x[K])),h.push(Ie)}}return this.i=h.join("&")};function mr(h){const w=new Br;return w.i=h.i,h.g&&(w.g=new Map(h.g),w.h=h.h),w}function jn(h,w){return w=String(w),h.j&&(w=w.toLowerCase()),w}function Or(h,w){w&&!h.j&&(Ke(h),h.i=null,h.g.forEach(function(x,D){const B=D.toLowerCase();D!=B&&(hn(this,D),rr(this,B,x))},h)),h.j=w}function pr(h,w){const x=new te;if(o.Image){const D=new Image;D.onload=u(jt,x,"TestLoadImage: loaded",!0,w,D),D.onerror=u(jt,x,"TestLoadImage: error",!1,w,D),D.onabort=u(jt,x,"TestLoadImage: abort",!1,w,D),D.ontimeout=u(jt,x,"TestLoadImage: timeout",!1,w,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=h}else w(!1)}function nn(h,w){const x=new te,D=new AbortController,B=setTimeout(()=>{D.abort(),jt(x,"TestPingServer: timeout",!1,w)},1e4);fetch(h,{signal:D.signal}).then(K=>{clearTimeout(B),K.ok?jt(x,"TestPingServer: ok",!0,w):jt(x,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(B),jt(x,"TestPingServer: error",!1,w)})}function jt(h,w,x,D,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),D(x)}catch{}}function Lr(){this.g=new le}function Sl(h){this.i=h.Sb||null,this.h=h.ab||!1}d(Sl,ce),Sl.prototype.g=function(){return new co(this.i,this.h)};function co(h,w){he.call(this),this.H=h,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(co,he),t=co.prototype,t.open=function(h,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=w,this.readyState=1,Ko(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(w.body=h),(this.H||o).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ri(this)),this.readyState=0},t.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Ko(this)),this.g&&(this.readyState=3,Ko(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;uo(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function uo(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}t.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var w=h.value?h.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!h.done}))&&(this.response=this.responseText+=w)}h.done?Ri(this):Ko(this),this.readyState==3&&uo(this)}},t.Oa=function(h){this.g&&(this.response=this.responseText=h,Ri(this))},t.Na=function(h){this.g&&(this.response=h,Ri(this))},t.ga=function(){this.g&&Ri(this)};function Ri(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Ko(h)}t.setRequestHeader=function(h,w){this.A.append(h,w)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],w=this.h.entries();for(var x=w.next();!x.done;)x=x.value,h.push(x[0]+": "+x[1]),x=w.next();return h.join(`\r
`)};function Ko(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(co.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Jd(h){let w="";return G(h,function(x,D){w+=D,w+=":",w+=x,w+=`\r
`}),w}function Bv(h,w,x){e:{for(D in x){var D=!1;break e}D=!0}D||(x=Jd(x),typeof h=="string"?x!=null&&It(x):wt(h,w,x))}function Xn(h){he.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(Xn,he);var Mj=/^https?$/i,Vj=["POST","PUT"];t=Xn.prototype,t.Fa=function(h){this.H=h},t.ea=function(h,w,x,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);w=w?w.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ot.g(),this.g.onreadystatechange=m(c(this.Ca,this));try{this.B=!0,this.g.open(w,String(h),!0),this.B=!1}catch(K){SI(this,K);return}if(h=x||"",x=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var B in D)x.set(B,D[B]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const K of D.keys())x.set(K,D.get(K));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(x.keys()).find(K=>K.toLowerCase()=="content-type"),B=o.FormData&&h instanceof o.FormData,!(Array.prototype.indexOf.call(Vj,w,void 0)>=0)||D||B||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,Ie]of x)this.g.setRequestHeader(K,Ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(K){SI(this,K)}};function SI(h,w){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=w,h.o=5,II(h),Sm(h)}function II(h){h.A||(h.A=!0,Ce(h,"complete"),Ce(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ce(this,"complete"),Ce(this,"abort"),Sm(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Sm(this,!0)),Xn.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?TI(this):this.Xa())},t.Xa=function(){TI(this)};function TI(h){if(h.h&&typeof i<"u"){if(h.v&&Go(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ce(h,"readystatechange"),Go(h)==4){h.h=!1;try{const K=h.ca();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var x;if(!(x=w)){var D;if(D=K===0){let Ie=String(h.D).match(Be)[1]||null;!Ie&&o.self&&o.self.location&&(Ie=o.self.location.protocol.slice(0,-1)),D=!Mj.test(Ie?Ie.toLowerCase():"")}x=D}if(x)Ce(h,"complete"),Ce(h,"success");else{h.o=6;try{var B=Go(h)>2?h.g.statusText:""}catch{B=""}h.l=B+" ["+h.ca()+"]",II(h)}}finally{Sm(h)}}}}function Sm(h,w){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const x=h.g;h.g=null,w||Ce(h,"ready");try{x.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Go(h){return h.g?h.g.readyState:0}t.ca=function(){try{return Go(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(h){if(this.g){var w=this.g.responseText;return h&&w.indexOf(h)==0&&(w=w.substring(h.length)),we(w)}};function xI(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function jj(h){const w={};h=(h.g&&Go(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<h.length;D++){if(O(h[D]))continue;var x=ut(h[D]);const B=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const K=w[B]||[];w[B]=K,K.push(x)}ae(w,function(D){return D.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Xd(h,w,x){return x&&x.internalChannelParams&&x.internalChannelParams[h]||w}function AI(h){this.za=0,this.i=[],this.j=new te,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Xd("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Xd("baseRetryDelayMs",5e3,h),this.Za=Xd("retryDelaySeedMs",1e4,h),this.Ta=Xd("forwardChannelMaxRetries",2,h),this.va=Xd("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Ue(h&&h.concurrentRequestLimit),this.Ba=new Lr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=AI.prototype,t.ka=8,t.I=1,t.connect=function(h,w,x,D){H(0),this.W=h,this.H=w||{},x&&D!==void 0&&(this.H.OSID=x,this.H.OAID=D),this.F=this.X,this.J=MI(this,null,this.W),Tm(this)};function zv(h){if(PI(h),h.I==3){var w=h.V++,x=Xt(h.J);if(wt(x,"SID",h.M),wt(x,"RID",w),wt(x,"TYPE","terminate"),Zd(h,x),w=new Pt(h,h.j,w),w.M=2,w.A=ls(Xt(x)),x=!1,o.navigator&&o.navigator.sendBeacon)try{x=o.navigator.sendBeacon(w.A.toString(),"")}catch{}!x&&o.Image&&(new Image().src=w.A,x=!0),x||(w.g=VI(w.j,null),w.g.ea(w.A)),w.F=Date.now(),xt(w)}LI(h)}function Im(h){h.g&&(qv(h),h.g.cancel(),h.g=null)}function PI(h){Im(h),h.v&&(o.clearTimeout(h.v),h.v=null),xm(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&o.clearTimeout(h.m),h.m=null)}function Tm(h){if(!se(h.h)&&!h.m){h.m=!0;var w=h.Ea;T||A(),N||(T(),N=!0),I.add(w,h),h.D=0}}function Fj(h,w){return nt(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=w.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=it(c(h.Ea,h,w),OI(h,h.D)),h.D++,!0)}t.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const B=new Pt(this,this.j,h);let K=this.o;if(this.U&&(K?(K=pe(K),Ge(K,this.U)):K=this.U),this.u!==null||this.R||(B.J=K,K=null),this.S)e:{for(var w=0,x=0;x<this.i.length;x++){t:{var D=this.i[x];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(w+=D,w>4096){w=x;break e}if(w===4096||x===this.i.length-1){w=x+1;break e}}w=1e3}else w=1e3;w=CI(this,B,w),x=Xt(this.J),wt(x,"RID",h),wt(x,"CVER",22),this.G&&wt(x,"X-HTTP-Session-Id",this.G),Zd(this,x),K&&(this.R?w="headers="+It(Jd(K))+"&"+w:this.u&&Bv(x,this.u,K)),zt(this.h,B),this.Ra&&wt(x,"TYPE","init"),this.S?(wt(x,"$req",w),wt(x,"SID","null"),B.U=!0,Pn(B,x,null)):Pn(B,x,w),this.I=2}}else this.I==3&&(h?RI(this,h):this.i.length==0||se(this.h)||RI(this))};function RI(h,w){var x;w?x=w.l:x=h.V++;const D=Xt(h.J);wt(D,"SID",h.M),wt(D,"RID",x),wt(D,"AID",h.K),Zd(h,D),h.u&&h.o&&Bv(D,h.u,h.o),x=new Pt(h,h.j,x,h.D+1),h.u===null&&(x.J=h.o),w&&(h.i=w.G.concat(h.i)),w=CI(h,x,1e3),x.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),zt(h.h,x),Pn(x,D,w)}function Zd(h,w){h.H&&G(h.H,function(x,D){wt(w,D,x)}),h.l&&G({},function(x,D){wt(w,D,x)})}function CI(h,w,x){x=Math.min(h.i.length,x);const D=h.l?c(h.l.Ka,h.l,h):null;e:{var B=h.i;let Nt=-1;for(;;){const gr=["count="+x];Nt==-1?x>0?(Nt=B[0].g,gr.push("ofs="+Nt)):Nt=0:gr.push("ofs="+Nt);let bn=!0;for(let Sr=0;Sr<x;Sr++){var K=B[Sr].g;const Ci=B[Sr].map;if(K-=Nt,K<0)Nt=Math.max(0,B[Sr].g-100),bn=!1;else try{K="req"+K+"_"||"";try{var Ie=Ci instanceof Map?Ci:Object.entries(Ci);for(const[Tl,Qo]of Ie){let Yo=Qo;a(Qo)&&(Yo=Te(Qo)),gr.push(K+Tl+"="+encodeURIComponent(Yo))}}catch(Tl){throw gr.push(K+"type="+encodeURIComponent("_badmap")),Tl}}catch{D&&D(Ci)}}if(bn){Ie=gr.join("&");break e}}Ie=void 0}return h=h.i.splice(0,x),w.G=h,Ie}function NI(h){if(!h.g&&!h.v){h.Y=1;var w=h.Da;T||A(),N||(T(),N=!0),I.add(w,h),h.A=0}}function Wv(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=it(c(h.Da,h),OI(h,h.A)),h.A++,!0)}t.Da=function(){if(this.v=null,kI(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=it(c(this.Wa,this),h)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,H(10),Im(this),kI(this))};function qv(h){h.B!=null&&(o.clearTimeout(h.B),h.B=null)}function kI(h){h.g=new Pt(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var w=Xt(h.na);wt(w,"RID","rpc"),wt(w,"SID",h.M),wt(w,"AID",h.K),wt(w,"CI",h.F?"0":"1"),!h.F&&h.ia&&wt(w,"TO",h.ia),wt(w,"TYPE","xmlhttp"),Zd(h,w),h.u&&h.o&&Bv(w,h.u,h.o),h.O&&(h.g.H=h.O);var x=h.g;h=h.ba,x.M=1,x.A=ls(Xt(w)),x.u=null,x.R=!0,ft(x,h)}t.Va=function(){this.C!=null&&(this.C=null,Im(this),Wv(this),H(19))};function xm(h){h.C!=null&&(o.clearTimeout(h.C),h.C=null)}function DI(h,w){var x=null;if(h.g==w){xm(h),qv(h),h.g=null;var D=2}else if(_t(h.h,w))x=w.G,dn(h.h,w),D=1;else return;if(h.I!=0){if(w.o)if(D==1){x=w.u?w.u.length:0,w=Date.now()-w.F;var B=h.D;D=V(),Ce(D,new Pe(D,x)),Tm(h)}else NI(h);else if(B=w.m,B==3||B==0&&w.X>0||!(D==1&&Fj(h,w)||D==2&&Wv(h)))switch(x&&x.length>0&&(w=h.h,w.i=w.i.concat(x)),B){case 1:Il(h,5);break;case 4:Il(h,10);break;case 3:Il(h,6);break;default:Il(h,2)}}}function OI(h,w){let x=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(x*=2),x*w}function Il(h,w){if(h.j.info("Error code "+w),w==2){var x=c(h.bb,h),D=h.Ua;const B=!D;D=new Vt(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||nr(D,"https"),ls(D),B?pr(D.toString(),x):nn(D.toString(),x)}else H(2);h.I=0,h.l&&h.l.pa(w),LI(h),PI(h)}t.bb=function(h){h?(this.j.info("Successfully pinged google.com"),H(2)):(this.j.info("Failed to ping google.com"),H(1))};function LI(h){if(h.I=0,h.ja=[],h.l){const w=Jt(h.h);(w.length!=0||h.i.length!=0)&&(v(h.ja,w),v(h.ja,h.i),h.h.i.length=0,p(h.i),h.i.length=0),h.l.oa()}}function MI(h,w,x){var D=x instanceof Vt?Xt(x):new Vt(x);if(D.g!="")w&&(D.g=w+"."+D.g),Xe(D,D.u);else{var B=o.location;D=B.protocol,w=w?w+"."+B.hostname:B.hostname,B=+B.port;const K=new Vt(null);D&&nr(K,D),w&&(K.g=w),B&&Xe(K,B),x&&(K.h=x),D=K}return x=h.G,w=h.wa,x&&w&&wt(D,x,w),wt(D,"VER",h.ka),Zd(h,D),D}function VI(h,w,x){if(w&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=h.Aa&&!h.ma?new Xn(new Sl({ab:x})):new Xn(h.ma),w.Fa(h.L),w}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function jI(){}t=jI.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Am(){}Am.prototype.g=function(h,w){return new As(h,w)};function As(h,w){he.call(this),this.g=new AI(w),this.l=h,this.h=w&&w.messageUrlParams||null,h=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(h?h["X-WebChannel-Content-Type"]=w.messageContentType:h={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(h?h["X-WebChannel-Client-Profile"]=w.sa:h={"X-WebChannel-Client-Profile":w.sa}),this.g.U=h,(h=w&&w.Qb)&&!O(h)&&(this.g.u=h),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!O(w)&&(this.g.G=w,h=this.h,h!==null&&w in h&&(h=this.h,w in h&&delete h[w])),this.j=new Vc(this)}d(As,he),As.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},As.prototype.close=function(){zv(this.g)},As.prototype.o=function(h){var w=this.g;if(typeof h=="string"){var x={};x.__data__=h,h=x}else this.v&&(x={},x.__data__=Te(h),h=x);w.i.push(new tt(w.Ya++,h)),w.I==3&&Tm(w)},As.prototype.N=function(){this.g.l=null,delete this.j,zv(this.g),delete this.g,As.Z.N.call(this)};function FI(h){_n.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var w=h.__sm__;if(w){e:{for(const x in w){h=x;break e}h=void 0}(this.i=h)&&(h=this.i,w=w!==null&&h in w?w[h]:void 0),this.data=w}else this.data=h}d(FI,_n);function UI(){tn.call(this),this.status=1}d(UI,tn);function Vc(h){this.g=h}d(Vc,jI),Vc.prototype.ra=function(){Ce(this.g,"a")},Vc.prototype.qa=function(h){Ce(this.g,new FI(h))},Vc.prototype.pa=function(h){Ce(this.g,new UI)},Vc.prototype.oa=function(){Ce(this.g,"b")},Am.prototype.createWebChannel=Am.prototype.g,As.prototype.send=As.prototype.o,As.prototype.open=As.prototype.m,As.prototype.close=As.prototype.close,B2=function(){return new Am},$2=function(){return V()},U2=j,C0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ht.NO_ERROR=0,ht.TIMEOUT=8,ht.HTTP_ERROR=6,Up=ht,Re.COMPLETE="complete",F2=Re,st.EventType=yt,yt.OPEN="a",yt.CLOSE="b",yt.ERROR="c",yt.MESSAGE="d",he.prototype.listen=he.prototype.J,Th=st,Xn.prototype.listenOnce=Xn.prototype.K,Xn.prototype.getLastError=Xn.prototype.Ha,Xn.prototype.getLastErrorCode=Xn.prototype.ya,Xn.prototype.getStatus=Xn.prototype.ca,Xn.prototype.getResponseJson=Xn.prototype.La,Xn.prototype.getResponseText=Xn.prototype.la,Xn.prototype.send=Xn.prototype.ea,Xn.prototype.setWithCredentials=Xn.prototype.Fa,j2=Xn}).apply(typeof ep<"u"?ep:typeof self<"u"?self:typeof window<"u"?window:{});const RA="@firebase/firestore",CA="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Pr.UNAUTHENTICATED=new Pr(null),Pr.GOOGLE_CREDENTIALS=new Pr("google-credentials-uid"),Pr.FIRST_PARTY=new Pr("first-party-uid"),Pr.MOCK_USER=new Pr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vd="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa=new ev("@firebase/firestore");function Jc(){return Xa.logLevel}function z2(t){Xa.setLogLevel(t)}function de(t,...e){if(Xa.logLevel<=Wt.DEBUG){const n=e.map(GE);Xa.debug(`Firestore (${Vd}): ${t}`,...n)}}function or(t,...e){if(Xa.logLevel<=Wt.ERROR){const n=e.map(GE);Xa.error(`Firestore (${Vd}): ${t}`,...n)}}function Fs(t,...e){if(Xa.logLevel<=Wt.WARN){const n=e.map(GE);Xa.warn(`Firestore (${Vd}): ${t}`,...n)}}function GE(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,W2(t,r,n)}function W2(t,e,n){let r=`FIRESTORE (${Vd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw or(r),new Error(r)}function Je(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||W2(e,s,r)}function sH(t,e){t||Le(57014,e)}function Se(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ie extends xi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class H2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Pr.UNAUTHENTICATED))}shutdown(){}}class iH{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class oH{constructor(e){this.t=e,this.currentUser=Pr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Je(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new Cr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Cr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Cr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Je(typeof r.accessToken=="string",31837,{l:r}),new q2(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Je(e===null||typeof e=="string",2055,{h:e}),new Pr(e)}}class aH{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Pr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class lH{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new aH(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Pr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class N0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cH{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,fs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Je(this.o===void 0,3512);const r=i=>{i.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,de("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new N0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Je(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new N0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class uH{getToken(){return Promise.resolve(new N0(""))}invalidateToken(){}start(e,n){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dH(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=dH(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function gt(t,e){return t<e?-1:t>e?1:0}function k0(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return jw(s)===jw(i)?gt(s,i):jw(s)?1:-1}return gt(t.length,e.length)}const hH=55296,fH=57343;function jw(t){const e=t.charCodeAt(0);return e>=hH&&e<=fH}function ed(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function K2(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D0="__name__";class Li{constructor(e,n,r){n===void 0?n=0:n>e.length&&Le(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Le(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Li.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Li?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Li.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return gt(e.length,n.length)}static compareSegments(e,n){const r=Li.isNumericId(e),s=Li.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Li.extractNumericId(e).compare(Li.extractNumericId(n)):k0(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Wa.fromString(e.substring(4,e.length-2))}}class Ft extends Li{construct(e,n,r){return new Ft(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ie(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ft(n)}static emptyPath(){return new Ft([])}}const mH=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class On extends Li{construct(e,n,r){return new On(e,n,r)}static isValidIdentifier(e){return mH.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),On.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===D0}static keyField(){return new On([D0])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ie(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new ie(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ie(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new ie(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new On(n)}static emptyPath(){return new On([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.path=e}static fromPath(e){return new _e(Ft.fromString(e))}static fromName(e){return new _e(Ft.fromString(e).popFirst(5))}static empty(){return new _e(Ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ft.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _e(new Ft(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(t,e,n){if(!n)throw new ie(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function G2(t,e,n,r){if(e===!0&&r===!0)throw new ie(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function NA(t){if(!_e.isDocumentKey(t))throw new ie(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function kA(t){if(_e.isDocumentKey(t))throw new ie(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Q2(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function ov(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Le(12329,{type:typeof t})}function Ut(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ie(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ov(t);throw new ie(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Y2(t,e){if(e<=0)throw new ie(z.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(t,e){const n={typeString:t};return e&&(n.value=e),n}function kc(t,e){if(!Q2(t))throw new ie(z.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new ie(z.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA=-62135596800,OA=1e6;class sn{static now(){return sn.fromMillis(Date.now())}static fromDate(e){return sn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*OA);return new sn(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ie(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ie(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<DA)throw new ie(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ie(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/OA}_compareTo(e){return this.seconds===e.seconds?gt(this.nanoseconds,e.nanoseconds):gt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:sn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(kc(e,sn._jsonSchema))return new sn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-DA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}sn._jsonSchemaVersion="firestore/timestamp/1.0",sn._jsonSchema={type:fr("string",sn._jsonSchemaVersion),seconds:fr("number"),nanoseconds:fr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{static fromTimestamp(e){return new at(e)}static min(){return new at(new sn(0,0))}static max(){return new at(new sn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td=-1;class nd{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function O0(t){return t.fields.find(e=>e.kind===2)}function Nl(t){return t.fields.filter(e=>e.kind!==2)}function pH(t,e){let n=gt(t.collectionGroup,e.collectionGroup);if(n!==0)return n;for(let r=0;r<Math.min(t.fields.length,e.fields.length);++r)if(n=gH(t.fields[r],e.fields[r]),n!==0)return n;return gt(t.fields.length,e.fields.length)}nd.UNKNOWN_ID=-1;class tc{constructor(e,n){this.fieldPath=e,this.kind=n}}function gH(t,e){const n=On.comparator(t.fieldPath,e.fieldPath);return n!==0?n:gt(t.kind,e.kind)}class rd{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new rd(0,Us.min())}}function J2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=at.fromTimestamp(r===1e9?new sn(n+1,0):new sn(n,r));return new Us(s,_e.empty(),e)}function X2(t){return new Us(t.readTime,t.key,td)}class Us{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Us(at.min(),_e.empty(),td)}static max(){return new Us(at.max(),_e.empty(),td)}}function YE(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=_e.comparator(t.documentKey,e.documentKey),n!==0?n:gt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pl(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==Z2)throw t;de("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,r)=>{n(e)})}static reject(e){return new $((n,r)=>{r(e)})}static waitFor(e){return new $((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=$.resolve(!1);for(const r of e)n=n.next(s=>s?$.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new $((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(e[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,n){return new $((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs="SimpleDb";class av{static open(e,n,r,s){try{return new av(n,e.transaction(s,r))}catch(i){throw new Wh(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Cr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Wh(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=JE(r.target.error);this.S.reject(new Wh(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(de(Rs,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new vH(n)}}class Xi{static delete(e){return de(Rs,"Removing database:",e),Ol(OD().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ME())return!1;if(Xi.F())return!0;const e=_r(),n=Xi.M(e),r=0<n&&n<10,s=tO(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Xi.M(_r())===12.2&&or("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(de(Rs,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Wh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new ie(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ie(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Wh(e,o))},s.onupgradeneeded=i=>{de(Rs,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{de(Rs,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=av.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(c=>(a.C(),c)).catch(c=>(a.abort(c),$.reject(c))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(de(Rs,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function tO(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class yH{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ol(this.U.delete())}}class Wh extends ie{constructor(e,n){super(z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function gl(t){return t.name==="IndexedDbTransactionError"}class vH{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(de(Rs,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(de(Rs,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ol(r)}add(e){return de(Rs,"ADD",this.store.name,e,e),Ol(this.store.add(e))}get(e){return Ol(this.store.get(e)).next(n=>(n===void 0&&(n=null),de(Rs,"GET",this.store.name,e,n),n))}delete(e){return de(Rs,"DELETE",this.store.name,e),Ol(this.store.delete(e))}count(){return de(Rs,"COUNT",this.store.name),Ol(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new $((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new $((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){de(Rs,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new $((r,s)=>{n.onerror=i=>{const o=JE(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new $((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new yH(a),c=n(a.primaryKey,a.value,l);if(c instanceof $){const u=c.catch(d=>(l.done(),$.reject(d)));r.push(u)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}}).next(()=>$.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ol(t){return new $((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=JE(r.target.error);n(s)}})}let LA=!1;function JE(t){const e=Xi.M(_r());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return LA||(LA=!0,setTimeout(()=>{throw r},0)),r}}return t}const qh="IndexBackfiller";class wH{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){de(qh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();de(qh,`Documents written: ${n}`)}catch(n){gl(n)?de(qh,"Ignoring IndexedDB error during index backfill: ",n):await pl(n)}await this.re(6e4)})}}class _H{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return $.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return de(qh,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(de(qh,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=X2(i);YE(o,r)>0&&(r=o)}),new Us(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}gs.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa=-1;function am(t){return t==null}function Rf(t){return t===0&&1/t==-1/0}function nO(t){return typeof t=="number"&&Number.isInteger(t)&&!Rf(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kg="";function Jr(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=MA(e)),e=bH(t.get(n),e);return MA(e)}function bH(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Kg:n+="";break;default:n+=i}}return n}function MA(t){return t+Kg+""}function Wi(t){const e=t.length;if(Je(e>=2,64408,{path:t}),e===2)return Je(t.charAt(0)===Kg&&t.charAt(1)==="",56145,{path:t}),Ft.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Kg,i);switch((o<0||o>n)&&Le(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:Le(61167,{path:t})}i=o+2}return new Ft(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kl="remoteDocuments",lm="owner",Fc="owner",Cf="mutationQueues",EH="userId",ci="mutations",VA="batchId",Hl="userMutationsIndex",jA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $p(t,e){return[t,Jr(e)]}function rO(t,e,n){return[t,Jr(e),n]}const SH={},sd="documentMutations",Gg="remoteDocumentsV14",IH=["prefixPath","collectionGroup","readTime","documentId"],Bp="documentKeyIndex",TH=["prefixPath","collectionGroup","documentId"],sO="collectionGroupIndex",xH=["collectionGroup","readTime","prefixPath","documentId"],Nf="remoteDocumentGlobal",L0="remoteDocumentGlobalKey",id="targets",iO="queryTargetsIndex",AH=["canonicalId","targetId"],od="targetDocuments",PH=["targetId","path"],XE="documentTargetsIndex",RH=["path","targetId"],Qg="targetGlobalKey",nc="targetGlobal",kf="collectionParents",CH=["collectionId","parent"],ad="clientMetadata",NH="clientId",lv="bundles",kH="bundleId",cv="namedQueries",DH="name",ZE="indexConfiguration",OH="indexId",M0="collectionGroupIndex",LH="collectionGroup",Hh="indexState",MH=["indexId","uid"],oO="sequenceNumberIndex",VH=["uid","sequenceNumber"],Kh="indexEntries",jH=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],aO="documentKeyIndex",FH=["indexId","uid","orderedDocumentKey"],uv="documentOverlays",UH=["userId","collectionPath","documentId"],V0="collectionPathOverlayIndex",$H=["userId","collectionPath","largestBatchId"],lO="collectionGroupOverlayIndex",BH=["userId","collectionGroup","largestBatchId"],eS="globals",zH="name",cO=[Cf,ci,sd,kl,id,lm,nc,od,ad,Nf,kf,lv,cv],WH=[...cO,uv],uO=[Cf,ci,sd,Gg,id,lm,nc,od,ad,Nf,kf,lv,cv,uv],dO=uO,tS=[...dO,ZE,Hh,Kh],qH=tS,hO=[...tS,eS],HH=hO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0 extends eO{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Er(t,e){const n=Se(t);return Xi.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function yl(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function fO(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function mO(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e,n){this.comparator=e,this.root=n||Vr.EMPTY}insert(e,n){return new An(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Vr.BLACK,null,null))}remove(e){return new An(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new tp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new tp(this.root,e,this.comparator,!1)}getReverseIterator(){return new tp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new tp(this.root,e,this.comparator,!0)}}class tp{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vr{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Vr.RED,this.left=s??Vr.EMPTY,this.right=i??Vr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Vr(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Vr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Vr.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Le(27949);return e+(this.isRed()?0:1)}}Vr.EMPTY=null,Vr.RED=!0,Vr.BLACK=!1;Vr.EMPTY=new class{constructor(){this.size=0}get key(){throw Le(57766)}get value(){throw Le(16141)}get color(){throw Le(16727)}get left(){throw Le(29726)}get right(){throw Le(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Vr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.comparator=e,this.data=new An(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new UA(this.data.getIterator())}getIteratorFrom(e){return new UA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof gn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new gn(this.comparator);return n.data=e,n}}class UA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Uc(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e){this.fields=e,e.sort(On.comparator)}static empty(){return new ys([])}unionWith(e){let n=new gn(On.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new ys(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ed(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KH(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new pO("Invalid base64 string: "+i):i}}(e);return new Gn(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Gn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return gt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Gn.EMPTY_BYTE_STRING=new Gn("");const GH=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jo(t){if(Je(!!t,39018),typeof t=="string"){let e=0;const n=GH.exec(t);if(Je(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Fn(t.seconds),nanos:Fn(t.nanos)}}function Fn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Fo(t){return typeof t=="string"?Gn.fromBase64String(t):Gn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gO="server_timestamp",yO="__type__",vO="__previous_value__",wO="__local_write_time__";function dv(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[yO])==null?void 0:r.stringValue)===gO}function hv(t){const e=t.mapValue.fields[vO];return dv(e)?hv(e):e}function Df(t){const e=jo(t.mapValue.fields[wO].timestampValue);return new sn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QH{constructor(e,n,r,s,i,o,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const Of="(default)";class Za{constructor(e,n){this.projectId=e,this.database=n||Of}static empty(){return new Za("","")}get isDefaultDatabase(){return this.database===Of}isEqual(e){return e instanceof Za&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS="__type__",_O="__max__",Ca={mapValue:{fields:{__type__:{stringValue:_O}}}},rS="__vector__",ld="value",zp={nullValue:"NULL_VALUE"};function el(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?dv(t)?4:bO(t)?9007199254740991:fv(t)?10:11:Le(28295,{value:t})}function ro(t,e){if(t===e)return!0;const n=el(t);if(n!==el(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Df(t).isEqual(Df(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=jo(s.timestampValue),a=jo(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Fo(s.bytesValue).isEqual(Fo(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Fn(s.geoPointValue.latitude)===Fn(i.geoPointValue.latitude)&&Fn(s.geoPointValue.longitude)===Fn(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Fn(s.integerValue)===Fn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Fn(s.doubleValue),a=Fn(i.doubleValue);return o===a?Rf(o)===Rf(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ed(t.arrayValue.values||[],e.arrayValue.values||[],ro);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(FA(o)!==FA(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!ro(o[l],a[l])))return!1;return!0}(t,e);default:return Le(52216,{left:t})}}function Lf(t,e){return(t.values||[]).find(n=>ro(n,e))!==void 0}function tl(t,e){if(t===e)return 0;const n=el(t),r=el(e);if(n!==r)return gt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return gt(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Fn(i.integerValue||i.doubleValue),l=Fn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return $A(t.timestampValue,e.timestampValue);case 4:return $A(Df(t),Df(e));case 5:return k0(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Fo(i),l=Fo(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=gt(a[c],l[c]);if(u!==0)return u}return gt(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=gt(Fn(i.latitude),Fn(o.latitude));return a!==0?a:gt(Fn(i.longitude),Fn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return BA(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,p,v,g;const a=i.fields||{},l=o.fields||{},c=(m=a[ld])==null?void 0:m.arrayValue,u=(p=l[ld])==null?void 0:p.arrayValue,d=gt(((v=c==null?void 0:c.values)==null?void 0:v.length)||0,((g=u==null?void 0:u.values)==null?void 0:g.length)||0);return d!==0?d:BA(c,u)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ca.mapValue&&o===Ca.mapValue)return 0;if(i===Ca.mapValue)return 1;if(o===Ca.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){const m=k0(l[d],u[d]);if(m!==0)return m;const p=tl(a[l[d]],c[u[d]]);if(p!==0)return p}return gt(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Le(23264,{he:n})}}function $A(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return gt(t,e);const n=jo(t),r=jo(e),s=gt(n.seconds,r.seconds);return s!==0?s:gt(n.nanos,r.nanos)}function BA(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=tl(n[s],r[s]);if(i)return i}return gt(n.length,r.length)}function cd(t){return F0(t)}function F0(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=jo(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Fo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return _e.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=F0(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${F0(n.fields[o])}`;return s+"}"}(t.mapValue):Le(61005,{value:t})}function Wp(t){switch(el(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hv(t);return e?16+Wp(e):16;case 5:return 2*t.stringValue.length;case 6:return Fo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Wp(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return yl(r.fields,(i,o)=>{s+=i.length+Wp(o)}),s}(t.mapValue);default:throw Le(13486,{value:t})}}function mc(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function U0(t){return!!t&&"integerValue"in t}function Mf(t){return!!t&&"arrayValue"in t}function zA(t){return!!t&&"nullValue"in t}function WA(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function qp(t){return!!t&&"mapValue"in t}function fv(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[nS])==null?void 0:r.stringValue)===rS}function Gh(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return yl(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Gh(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Gh(t.arrayValue.values[n]);return e}return{...t}}function bO(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===_O}const EO={mapValue:{fields:{[nS]:{stringValue:rS},[ld]:{arrayValue:{}}}}};function YH(t){return"nullValue"in t?zp:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?mc(Za.empty(),_e.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?fv(t)?EO:{mapValue:{}}:Le(35942,{value:t})}function JH(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?mc(Za.empty(),_e.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?EO:"mapValue"in t?fv(t)?{mapValue:{}}:Ca:Le(61959,{value:t})}function qA(t,e){const n=tl(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function HA(t,e){const n=tl(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.value=e}static empty(){return new Fr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!qp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gh(n)}setAll(e){let n=On.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Gh(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());qp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ro(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];qp(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){yl(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Fr(Gh(this.value))}}function SO(t){const e=[];return yl(t.fields,(n,r)=>{const s=new On([n]);if(qp(r)){const i=SO(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new ys(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Dn(e,0,at.min(),at.min(),at.min(),Fr.empty(),0)}static newFoundDocument(e,n,r,s){return new Dn(e,1,n,at.min(),r,s,0)}static newNoDocument(e,n){return new Dn(e,2,n,at.min(),at.min(),Fr.empty(),0)}static newUnknownDocument(e,n){return new Dn(e,3,n,at.min(),at.min(),Fr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(at.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=at.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Dn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,n){this.position=e,this.inclusive=n}}function KA(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=_e.comparator(_e.fromName(o.referenceValue),n.key):r=tl(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function GA(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ro(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e,n="asc"){this.field=e,this.dir=n}}function XH(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{}class Ht extends IO{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new ZH(e,n,r):n==="array-contains"?new nK(e,r):n==="in"?new CO(e,r):n==="not-in"?new rK(e,r):n==="array-contains-any"?new sK(e,r):new Ht(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new eK(e,r):new tK(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(tl(n,this.value)):n!==null&&el(this.value)===el(n)&&this.matchesComparison(tl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fn extends IO{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new fn(e,n)}matches(e){return ud(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ud(t){return t.op==="and"}function $0(t){return t.op==="or"}function sS(t){return TO(t)&&ud(t)}function TO(t){for(const e of t.filters)if(e instanceof fn)return!1;return!0}function B0(t){if(t instanceof Ht)return t.field.canonicalString()+t.op.toString()+cd(t.value);if(sS(t))return t.filters.map(e=>B0(e)).join(",");{const e=t.filters.map(n=>B0(n)).join(",");return`${t.op}(${e})`}}function xO(t,e){return t instanceof Ht?function(r,s){return s instanceof Ht&&r.op===s.op&&r.field.isEqual(s.field)&&ro(r.value,s.value)}(t,e):t instanceof fn?function(r,s){return s instanceof fn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&xO(o,s.filters[a]),!0):!1}(t,e):void Le(19439)}function AO(t,e){const n=t.filters.concat(e);return fn.create(n,t.op)}function PO(t){return t instanceof Ht?function(n){return`${n.field.canonicalString()} ${n.op} ${cd(n.value)}`}(t):t instanceof fn?function(n){return n.op.toString()+" {"+n.getFilters().map(PO).join(" ,")+"}"}(t):"Filter"}class ZH extends Ht{constructor(e,n,r){super(e,n,r),this.key=_e.fromName(r.referenceValue)}matches(e){const n=_e.comparator(e.key,this.key);return this.matchesComparison(n)}}class eK extends Ht{constructor(e,n){super(e,"in",n),this.keys=RO("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class tK extends Ht{constructor(e,n){super(e,"not-in",n),this.keys=RO("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function RO(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>_e.fromName(r.referenceValue))}class nK extends Ht{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Mf(n)&&Lf(n.arrayValue,this.value)}}class CO extends Ht{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Lf(this.value.arrayValue,n)}}class rK extends Ht{constructor(e,n){super(e,"not-in",n)}matches(e){if(Lf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Lf(this.value.arrayValue,n)}}class sK extends Ht{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Mf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Lf(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iK{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function z0(t,e=null,n=[],r=[],s=null,i=null,o=null){return new iK(t,e,n,r,s,i,o)}function pc(t){const e=Se(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>B0(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),am(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>cd(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>cd(r)).join(",")),e.Te=n}return e.Te}function cm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!XH(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!xO(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!GA(t.startAt,e.startAt)&&GA(t.endAt,e.endAt)}function Yg(t){return _e.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Jg(t,e){return t.filters.filter(n=>n instanceof Ht&&n.field.isEqual(e))}function QA(t,e,n){let r=zp,s=!0;for(const i of Jg(t,e)){let o=zp,a=!0;switch(i.op){case"<":case"<=":o=YH(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=zp}qA({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];qA({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function YA(t,e,n){let r=Ca,s=!0;for(const i of Jg(t,e)){let o=Ca,a=!0;switch(i.op){case">=":case">":o=JH(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Ca}HA({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];HA({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function NO(t,e,n,r,s,i,o,a){return new zo(t,e,n,r,s,i,o,a)}function jd(t){return new zo(t)}function JA(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function iS(t){return t.collectionGroup!==null}function Nu(t){const e=Se(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new gn(On.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Vf(i,r))}),n.has(On.keyField().canonicalString())||e.Ie.push(new Vf(On.keyField(),r))}return e.Ie}function Xr(t){const e=Se(t);return e.Ee||(e.Ee=DO(e,Nu(t))),e.Ee}function kO(t){const e=Se(t);return e.de||(e.de=DO(e,t.explicitOrderBy)),e.de}function DO(t,e){if(t.limitType==="F")return z0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Vf(s.field,i)});const n=t.endAt?new nl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new nl(t.startAt.position,t.startAt.inclusive):null;return z0(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function W0(t,e){const n=t.filters.concat([e]);return new zo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Xg(t,e,n){return new zo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function um(t,e){return cm(Xr(t),Xr(e))&&t.limitType===e.limitType}function OO(t){return`${pc(Xr(t))}|lt:${t.limitType}`}function Xc(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>PO(s)).join(", ")}]`),am(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>cd(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>cd(s)).join(",")),`Target(${r})`}(Xr(t))}; limitType=${t.limitType})`}function dm(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):_e.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Nu(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=KA(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Nu(r),s)||r.endAt&&!function(o,a,l){const c=KA(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Nu(r),s))}(t,e)}function LO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function MO(t){return(e,n)=>{let r=!1;for(const s of Nu(t)){const i=oK(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function oK(t,e,n){const r=t.field.isKeyField()?_e.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?tl(l,c):Le(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Le(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){yl(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return mO(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aK=new An(_e.comparator);function vs(){return aK}const VO=new An(_e.comparator);function xh(...t){let e=VO;for(const n of t)e=e.insert(n.key,n);return e}function jO(t){let e=VO;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function qi(){return Qh()}function FO(){return Qh()}function Qh(){return new Wo(t=>t.toString(),(t,e)=>t.isEqual(e))}const lK=new An(_e.comparator),cK=new gn(_e.comparator);function At(...t){let e=cK;for(const n of t)e=e.add(n);return e}const uK=new gn(gt);function oS(){return uK}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aS(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rf(e)?"-0":e}}function UO(t){return{integerValue:""+t}}function $O(t,e){return nO(e)?UO(e):aS(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(){this._=void 0}}function dK(t,e,n){return t instanceof dd?function(s,i){const o={fields:{[yO]:{stringValue:gO},[wO]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&dv(i)&&(i=hv(i)),i&&(o.fields[vO]=i),{mapValue:o}}(n,e):t instanceof gc?zO(t,e):t instanceof yc?WO(t,e):function(s,i){const o=BO(s,i),a=XA(o)+XA(s.Ae);return U0(o)&&U0(s.Ae)?UO(a):aS(s.serializer,a)}(t,e)}function hK(t,e,n){return t instanceof gc?zO(t,e):t instanceof yc?WO(t,e):n}function BO(t,e){return t instanceof hd?function(r){return U0(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class dd extends mv{}class gc extends mv{constructor(e){super(),this.elements=e}}function zO(t,e){const n=qO(e);for(const r of t.elements)n.some(s=>ro(s,r))||n.push(r);return{arrayValue:{values:n}}}class yc extends mv{constructor(e){super(),this.elements=e}}function WO(t,e){let n=qO(e);for(const r of t.elements)n=n.filter(s=>!ro(s,r));return{arrayValue:{values:n}}}class hd extends mv{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function XA(t){return Fn(t.integerValue||t.doubleValue)}function qO(t){return Mf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,n){this.field=e,this.transform=n}}function fK(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof gc&&s instanceof gc||r instanceof yc&&s instanceof yc?ed(r.elements,s.elements,ro):r instanceof hd&&s instanceof hd?ro(r.Ae,s.Ae):r instanceof dd&&s instanceof dd}(t.transform,e.transform)}class mK{constructor(e,n){this.version=e,this.transformResults=n}}class $n{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new $n}static exists(e){return new $n(void 0,e)}static updateTime(e){return new $n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hp(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class pv{}function HO(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ud(t.key,$n.none()):new Fd(t.key,t.data,$n.none());{const n=t.data,r=Fr.empty();let s=new gn(On.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new qo(t.key,r,new ys(s.toArray()),$n.none())}}function pK(t,e,n){t instanceof Fd?function(s,i,o){const a=s.value.clone(),l=e1(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof qo?function(s,i,o){if(!Hp(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=e1(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(KO(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Yh(t,e,n,r){return t instanceof Fd?function(i,o,a,l){if(!Hp(i.precondition,o))return a;const c=i.value.clone(),u=t1(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof qo?function(i,o,a,l){if(!Hp(i.precondition,o))return a;const c=t1(i.fieldTransforms,l,o),u=o.data;return u.setAll(KO(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(i,o,a){return Hp(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function gK(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=BO(r.transform,s||null);i!=null&&(n===null&&(n=Fr.empty()),n.set(r.field,i))}return n||null}function ZA(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ed(r,s,(i,o)=>fK(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Fd extends pv{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class qo extends pv{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function KO(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function e1(t,e,n){const r=new Map;Je(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,hK(o,a,n[s]))}return r}function t1(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,dK(i,o,e))}return r}class Ud extends pv{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class lS extends pv{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&pK(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Yh(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Yh(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=FO();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=HO(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(at.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),At())}isEqual(e){return this.batchId===e.batchId&&ed(this.mutations,e.mutations,(n,r)=>ZA(n,r))&&ed(this.baseMutations,e.baseMutations,(n,r)=>ZA(n,r))}}class uS{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Je(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return lK}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new uS(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dS=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yK{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ur,Qt;function QO(t){switch(t){case z.OK:return Le(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return Le(15467,{code:t})}}function YO(t){if(t===void 0)return or("GRPC error has no .code"),z.UNKNOWN;switch(t){case ur.OK:return z.OK;case ur.CANCELLED:return z.CANCELLED;case ur.UNKNOWN:return z.UNKNOWN;case ur.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case ur.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case ur.INTERNAL:return z.INTERNAL;case ur.UNAVAILABLE:return z.UNAVAILABLE;case ur.UNAUTHENTICATED:return z.UNAUTHENTICATED;case ur.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case ur.NOT_FOUND:return z.NOT_FOUND;case ur.ALREADY_EXISTS:return z.ALREADY_EXISTS;case ur.PERMISSION_DENIED:return z.PERMISSION_DENIED;case ur.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case ur.ABORTED:return z.ABORTED;case ur.OUT_OF_RANGE:return z.OUT_OF_RANGE;case ur.UNIMPLEMENTED:return z.UNIMPLEMENTED;case ur.DATA_LOSS:return z.DATA_LOSS;default:return Le(39323,{code:t})}}(Qt=ur||(ur={}))[Qt.OK=0]="OK",Qt[Qt.CANCELLED=1]="CANCELLED",Qt[Qt.UNKNOWN=2]="UNKNOWN",Qt[Qt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qt[Qt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qt[Qt.NOT_FOUND=5]="NOT_FOUND",Qt[Qt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qt[Qt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qt[Qt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qt[Qt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qt[Qt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qt[Qt.ABORTED=10]="ABORTED",Qt[Qt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qt[Qt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qt[Qt.INTERNAL=13]="INTERNAL",Qt[Qt.UNAVAILABLE=14]="UNAVAILABLE",Qt[Qt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jh=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vK=new Wa([4294967295,4294967295],0);function n1(t){const e=JO().encode(t),n=new V2;return n.update(e),new Uint8Array(n.digest())}function r1(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Wa([n,r],0),new Wa([s,i],0)]}class hS{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ah(`Invalid padding: ${n}`);if(r<0)throw new Ah(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ah(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ah(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Wa.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Wa.fromNumber(r)));return s.compare(vK)===1&&(s=new Wa([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=n1(e),[r,s]=r1(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new hS(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=n1(e),[r,s]=r1(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ah extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,mm.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new fm(at.min(),s,new An(gt),vs(),At())}}class mm{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new mm(r,n,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class XO{constructor(e,n){this.targetId=e,this.Ce=n}}class ZO{constructor(e,n,r=Gn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class s1{constructor(){this.ve=0,this.Fe=i1(),this.Me=Gn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=At(),n=At(),r=At();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Le(38017,{changeType:i})}}),new mm(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=i1()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Je(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class wK{constructor(e){this.Ge=e,this.ze=new Map,this.je=vs(),this.Je=np(),this.He=np(),this.Ye=new An(gt)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Le(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Yg(i))if(r===0){const o=new _e(i.path);this.et(n,o,Dn.newNoDocument(o,at.min()))}else Je(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,c)}Jh==null||Jh.lt(function(u,d,m,p,v){var b,_,S;const g={localCacheCount:u,existenceFilterCount:d.count,databaseId:m.database,projectId:m.projectId},E=d.unchangedNames;return E&&(g.bloomFilter={applied:v===0,hashCount:(E==null?void 0:E.hashCount)??0,bitmapLength:((_=(b=E==null?void 0:E.bits)==null?void 0:b.bitmap)==null?void 0:_.length)??0,padding:((S=E==null?void 0:E.bits)==null?void 0:S.padding)??0,mightContain:P=>(p==null?void 0:p.mightContain(P))??!1}),g}(o,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Fo(r).toUint8Array()}catch(l){if(l instanceof pO)return Fs("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new hS(o,s,i)}catch(l){return Fs(l instanceof Ah?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&Yg(a.target)){const l=new _e(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Dn.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=At();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new fm(e,n,this.Ye,this.je,r);return this.je=vs(),this.Je=np(),this.He=np(),this.Ye=new An(gt),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new s1,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new gn(gt),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new gn(gt),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||de("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new s1),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function np(){return new An(_e.comparator)}function i1(){return new An(_e.comparator)}const _K={asc:"ASCENDING",desc:"DESCENDING"},bK={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},EK={and:"AND",or:"OR"};class SK{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function q0(t,e){return t.useProto3Json||am(e)?e:{value:e}}function fd(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function eL(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function IK(t,e){return fd(t,e.toTimestamp())}function lr(t){return Je(!!t,49232),at.fromTimestamp(function(n){const r=jo(n);return new sn(r.seconds,r.nanos)}(t))}function fS(t,e){return H0(t,e).canonicalString()}function H0(t,e){const n=function(s){return new Ft(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function tL(t){const e=Ft.fromString(t);return Je(uL(e),10190,{key:e.toString()}),e}function jf(t,e){return fS(t.databaseId,e.path)}function Zi(t,e){const n=tL(e);if(n.get(1)!==t.databaseId.projectId)throw new ie(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ie(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new _e(sL(n))}function nL(t,e){return fS(t.databaseId,e)}function rL(t){const e=tL(t);return e.length===4?Ft.emptyPath():sL(e)}function K0(t){return new Ft(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function sL(t){return Je(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function o1(t,e,n){return{name:jf(t,e),fields:n.value.mapValue.fields}}function gv(t,e,n){const r=Zi(t,e.name),s=lr(e.updateTime),i=e.createTime?lr(e.createTime):at.min(),o=new Fr({mapValue:{fields:e.fields}}),a=Dn.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function TK(t,e){return"found"in e?function(r,s){Je(!!s.found,43571),s.found.name,s.found.updateTime;const i=Zi(r,s.found.name),o=lr(s.found.updateTime),a=s.found.createTime?lr(s.found.createTime):at.min(),l=new Fr({mapValue:{fields:s.found.fields}});return Dn.newFoundDocument(i,o,a,l)}(t,e):"missing"in e?function(r,s){Je(!!s.missing,3894),Je(!!s.readTime,22933);const i=Zi(r,s.missing),o=lr(s.readTime);return Dn.newNoDocument(i,o)}(t,e):Le(7234,{result:e})}function xK(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Le(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(Je(u===void 0||typeof u=="string",58123),Gn.fromBase64String(u||"")):(Je(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Gn.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?z.UNKNOWN:YO(c.code);return new ie(u,c.message||"")}(o);n=new ZO(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Zi(t,r.document.name),i=lr(r.document.updateTime),o=r.document.createTime?lr(r.document.createTime):at.min(),a=new Fr({mapValue:{fields:r.document.fields}}),l=Dn.newFoundDocument(s,i,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Kp(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Zi(t,r.document),i=r.readTime?lr(r.readTime):at.min(),o=Dn.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Kp([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Zi(t,r.document),i=r.removedTargetIds||[];n=new Kp([],i,s,null)}else{if(!("filter"in e))return Le(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new yK(s,i),a=r.targetId;n=new XO(a,o)}}return n}function Ff(t,e){let n;if(e instanceof Fd)n={update:o1(t,e.key,e.value)};else if(e instanceof Ud)n={delete:jf(t,e.key)};else if(e instanceof qo)n={update:o1(t,e.key,e.data),updateMask:kK(e.fieldMask)};else{if(!(e instanceof lS))return Le(16599,{Vt:e.type});n={verify:jf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof dd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof gc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof yc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof hd)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Le(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:IK(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Le(27497)}(t,e.precondition)),n}function G0(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?$n.updateTime(lr(i.updateTime)):i.exists!==void 0?$n.exists(i.exists):$n.none()}(e.currentDocument):$n.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)Je(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new dd;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];l=new gc(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];l=new yc(u)}else"increment"in a?l=new hd(o,a.increment):Le(16584,{proto:a});const c=On.fromServerFormat(a.fieldPath);return new hm(c,l)}(t,s)):[];if(e.update){e.update.name;const s=Zi(t,e.update.name),i=new Fr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new ys(c.map(u=>On.fromServerFormat(u)))}(e.updateMask);return new qo(s,i,o,n,r)}return new Fd(s,i,n,r)}if(e.delete){const s=Zi(t,e.delete);return new Ud(s,n)}if(e.verify){const s=Zi(t,e.verify);return new lS(s,n)}return Le(1463,{proto:e})}function AK(t,e){return t&&t.length>0?(Je(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?lr(s.updateTime):lr(i);return o.isEqual(at.min())&&(o=lr(i)),new mK(o,s.transformResults||[])}(n,e))):[]}function iL(t,e){return{documents:[nL(t,e.path)]}}function yv(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=nL(t,s);const i=function(c){if(c.length!==0)return cL(fn.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(u=>function(m){return{field:va(m.field),direction:RK(m.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=q0(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:n,parent:s}}function oL(t,e,n,r){const{ft:s,parent:i}=yv(t,e),o={},a=[];let l=0;return n.forEach(c=>{const u=r?c.alias:"aggregate_"+l++;o[u]=c.alias,c.aggregateType==="count"?a.push({alias:u,count:{}}):c.aggregateType==="avg"?a.push({alias:u,avg:{field:va(c.fieldPath)}}):c.aggregateType==="sum"&&a.push({alias:u,sum:{field:va(c.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function aL(t){let e=rL(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Je(r===1,65062);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=function(d){const m=lL(d);return m instanceof fn&&sS(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(m=>function(v){return new Vf(Zc(v.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(d){let m;return m=typeof d=="object"?d.value:d,am(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(d){const m=!!d.before,p=d.values||[];return new nl(p,m)}(n.startAt));let c=null;return n.endAt&&(c=function(d){const m=!d.before,p=d.values||[];return new nl(p,m)}(n.endAt)),NO(e,s,o,i,a,"F",l,c)}function PK(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function lL(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Zc(n.unaryFilter.field);return Ht.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Zc(n.unaryFilter.field);return Ht.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Zc(n.unaryFilter.field);return Ht.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Zc(n.unaryFilter.field);return Ht.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Le(61313);default:return Le(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ht.create(Zc(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Le(58110);default:return Le(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return fn.create(n.compositeFilter.filters.map(r=>lL(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Le(1026)}}(n.compositeFilter.op))}(t):Le(30097,{filter:t})}function RK(t){return _K[t]}function CK(t){return bK[t]}function NK(t){return EK[t]}function va(t){return{fieldPath:t.canonicalString()}}function Zc(t){return On.fromServerFormat(t.fieldPath)}function cL(t){return t instanceof Ht?function(n){if(n.op==="=="){if(WA(n.value))return{unaryFilter:{field:va(n.field),op:"IS_NAN"}};if(zA(n.value))return{unaryFilter:{field:va(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(WA(n.value))return{unaryFilter:{field:va(n.field),op:"IS_NOT_NAN"}};if(zA(n.value))return{unaryFilter:{field:va(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:va(n.field),op:CK(n.op),value:n.value}}}(t):t instanceof fn?function(n){const r=n.getFilters().map(s=>cL(s));return r.length===1?r[0]:{compositeFilter:{op:NK(n.op),filters:r}}}(t):Le(54877,{filter:t})}function kK(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function uL(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e,n,r,s,i=at.min(),o=at.min(),a=Gn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new So(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new So(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new So(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new So(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e){this.yt=e}}function DK(t,e){let n;if(e.document)n=gv(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=_e.fromSegments(e.noDocument.path),s=wc(e.noDocument.readTime);n=Dn.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Le(56709);{const r=_e.fromSegments(e.unknownDocument.path),s=wc(e.unknownDocument.version);n=Dn.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new sn(s[0],s[1]);return at.fromTimestamp(i)}(e.readTime)),n}function a1(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Zg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:jf(i,o.key),fields:o.data.value.mapValue.fields,updateTime:fd(i,o.version.toTimestamp()),createTime:fd(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:vc(e.version)};else{if(!e.isUnknownDocument())return Le(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:vc(e.version)}}return r}function Zg(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function vc(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function wc(t){const e=new sn(t.seconds,t.nanoseconds);return at.fromTimestamp(e)}function Ll(t,e){const n=(e.baseMutations||[]).map(i=>G0(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>G0(t.yt,i)),s=sn.fromMillis(e.localWriteTimeMs);return new cS(e.batchId,s,n,r)}function Ph(t){const e=wc(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?wc(t.lastLimboFreeSnapshotVersion):at.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return Je(o===1,1966,{count:o}),Xr(jd(rL(i.documents[0])))}(t.query):function(i){return Xr(aL(i))}(t.query),new So(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Gn.fromBase64String(t.resumeToken))}function hL(t,e){const n=vc(e.snapshotVersion),r=vc(e.lastLimboFreeSnapshotVersion);let s;s=Yg(e.target)?iL(t.yt,e.target):yv(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:pc(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function vv(t){const e=aL({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Xg(e,e.limit,"L"):e}function Fw(t,e){return new dS(e.largestBatchId,G0(t.yt,e.overlayMutation))}function l1(t,e){const n=e.path.lastSegment();return[t,Jr(e.path.popLast()),n]}function c1(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:vc(r.readTime),documentKey:Jr(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OK{getBundleMetadata(e,n){return u1(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:wc(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return u1(e).put(function(s){return{bundleId:s.id,createTime:vc(lr(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return d1(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:vv(i.bundledQuery),readTime:wc(i.readTime)}}(r)})}saveNamedQuery(e,n){return d1(e).put(function(s){return{name:s.name,readTime:vc(lr(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function u1(t){return Er(t,lv)}function d1(t){return Er(t,cv)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new wv(e,r)}getOverlay(e,n){return dh(e).get(l1(this.userId,n)).next(r=>r?Fw(this.serializer,r):null)}getOverlays(e,n){const r=qi();return $.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new dS(n,o);s.push(this.St(e,a))}),$.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Jr(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(dh(e).Z(V0,a))}),$.waitFor(i)}getOverlaysForCollection(e,n,r){const s=qi(),i=Jr(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return dh(e).J(V0,o).next(a=>{for(const l of a){const c=Fw(this.serializer,l);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=qi();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return dh(e).ee({index:lO,range:a},(l,c,u)=>{const d=Fw(this.serializer,c);i.size()<s||d.largestBatchId===o?(i.set(d.getKey(),d),o=d.largestBatchId):u.done()}).next(()=>i)}St(e,n){return dh(e).put(function(s,i,o){const[a,l,c]=l1(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ff(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function dh(t){return Er(t,uv)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LK{bt(e){return Er(e,eS)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Gn.fromUint8Array(r):Gn.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(Fn(e.integerValue));else if("doubleValue"in e){const r=Fn(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Rf(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=jo(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Fo(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?bO(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):fv(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):Le(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=ld,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(Fn(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),_e.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Ml.Kt=new Ml;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c=255;function MK(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function h1(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=MK(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class VK{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=h1(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=h1(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn($c),this.sn(255)}_n(){this.an($c),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===$c?(this.sn($c),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===$c?(this.an($c),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class jK{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class FK{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class hh{constructor(){this.cn=new VK,this.ln=new jK(this.cn),this.hn=new FK(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Vl(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Gp(this.En),directionalValue:Gp(this.dn),orderedDocumentKey:Gp(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function ta(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=f1(t.En,e.En),n!==0?n:(n=f1(t.dn,e.dn),n!==0?n:_e.comparator(t.In,e.In)))}function f1(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Gp(t){return $D()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function m1(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class p1{constructor(e){this.mn=new gn((n,r)=>On.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Je(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=O0(e);if(n!==void 0&&!this.wn(n))return!1;const r=Nl(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new gn(On.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new tc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new tc(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new tc(r.field,r.dir==="asc"?0:1)));return new nd(nd.UNKNOWN_ID,this.collectionId,n,rd.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fL(t){var n,r;if(Je(t instanceof Ht||t instanceof fn,20012),t instanceof Ht){if(t instanceof CO){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>Ht.create(t.field,"==",i)))||[];return fn.create(s,"or")}return t}const e=t.filters.map(s=>fL(s));return fn.create(e,t.op)}function UK(t){if(t.getFilters().length===0)return[];const e=J0(fL(t));return Je(mL(e),7391),Q0(e)||Y0(e)?[e]:e.getFilters()}function Q0(t){return t instanceof Ht}function Y0(t){return t instanceof fn&&sS(t)}function mL(t){return Q0(t)||Y0(t)||function(n){if(n instanceof fn&&$0(n)){for(const r of n.getFilters())if(!Q0(r)&&!Y0(r))return!1;return!0}return!1}(t)}function J0(t){if(Je(t instanceof Ht||t instanceof fn,34018),t instanceof Ht)return t;if(t.filters.length===1)return J0(t.filters[0]);const e=t.filters.map(r=>J0(r));let n=fn.create(e,t.op);return n=ey(n),mL(n)?n:(Je(n instanceof fn,64498),Je(ud(n),40251),Je(n.filters.length>1,57927),n.filters.reduce((r,s)=>mS(r,s)))}function mS(t,e){let n;return Je(t instanceof Ht||t instanceof fn,38388),Je(e instanceof Ht||e instanceof fn,25473),n=t instanceof Ht?e instanceof Ht?function(s,i){return fn.create([s,i],"and")}(t,e):g1(t,e):e instanceof Ht?g1(e,t):function(s,i){if(Je(s.filters.length>0&&i.filters.length>0,48005),ud(s)&&ud(i))return AO(s,i.getFilters());const o=$0(s)?s:i,a=$0(s)?i:s,l=o.filters.map(c=>mS(c,a));return fn.create(l,"or")}(t,e),ey(n)}function g1(t,e){if(ud(e))return AO(e,t.getFilters());{const n=e.filters.map(r=>mS(t,r));return fn.create(n,"or")}}function ey(t){if(Je(t instanceof Ht||t instanceof fn,11850),t instanceof Ht)return t;const e=t.getFilters();if(e.length===1)return ey(e[0]);if(TO(t))return t;const n=e.map(s=>ey(s)),r=[];return n.forEach(s=>{s instanceof Ht?r.push(s):s instanceof fn&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:fn.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $K{constructor(){this.Cn=new pS}addToCollectionParentIndex(e,n){return this.Cn.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(Us.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(Us.min())}updateCollectionGroup(e,n,r){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class pS{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new gn(Ft.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new gn(Ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1="IndexedDbIndexManager",rp=new Uint8Array(0);class BK{constructor(e,n){this.databaseId=n,this.vn=new pS,this.Fn=new Wo(r=>pc(r),(r,s)=>cm(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:Jr(s)};return v1(e).put(i)}return $.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[K2(n),""],!1,!0);return v1(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Wi(o.parent))}return r})}addFieldIndex(e,n){const r=fh(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=zc(e);return i.next(a=>{o.put(c1(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=fh(e),s=zc(e),i=Bc(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=fh(e),r=Bc(e),s=zc(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return $.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new p1(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Bc(e);let s=!0;const i=new Map;return $.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=At();const a=[];return $.forEach(i,(l,c)=>{de(y1,`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(P=>`${P.fieldPath}:${P.kind}`).join(",")}`}(l)} to execute ${pc(n)}`);const u=function(S,P){const T=O0(P);if(T===void 0)return null;for(const N of Jg(S,T.fieldPath))switch(N.op){case"array-contains-any":return N.value.arrayValue.values||[];case"array-contains":return[N.value]}return null}(c,l),d=function(S,P){const T=new Map;for(const N of Nl(P))for(const I of Jg(S,N.fieldPath))switch(I.op){case"==":case"in":T.set(N.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return T.set(N.fieldPath.canonicalString(),I.value),Array.from(T.values())}return null}(c,l),m=function(S,P){const T=[];let N=!0;for(const I of Nl(P)){const A=I.kind===0?QA(S,I.fieldPath,S.startAt):YA(S,I.fieldPath,S.startAt);T.push(A.value),N&&(N=A.inclusive)}return new nl(T,N)}(c,l),p=function(S,P){const T=[];let N=!0;for(const I of Nl(P)){const A=I.kind===0?YA(S,I.fieldPath,S.endAt):QA(S,I.fieldPath,S.endAt);T.push(A.value),N&&(N=A.inclusive)}return new nl(T,N)}(c,l),v=this.On(l,c,m),g=this.On(l,c,p),E=this.Nn(l,c,d),b=this.Bn(l.indexId,u,v,m.inclusive,g,p.inclusive,E);return $.forEach(b,_=>r.Y(_,n.limit).next(S=>{S.forEach(P=>{const T=_e.fromSegments(P.documentKey);o.has(T)||(o=o.add(T),a.push(T))})}))}).next(()=>a)}return $.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=UK(fn.create(e.filters,"and")).map(r=>z0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,i.length),c=l/(n!=null?n.length:1),u=[];for(let d=0;d<l;++d){const m=n?this.Ln(n[d/c]):rp,p=this.kn(e,m,r[d%c],s),v=this.qn(e,m,i[d%c],o),g=a.map(E=>this.kn(e,m,E,!0));u.push(...this.createRange(p,v,g))}return u}kn(e,n,r,s){const i=new Vl(e,_e.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new Vl(e,_e.empty(),n,r);return s?i.An():i}xn(e,n){const r=new p1(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return $.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new gn(On.comparator),u=!1;for(const d of l.filters)for(const m of d.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?u=!0:c=c.add(m.field));for(const d of l.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(u?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new hh;for(const s of Nl(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);Ml.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new hh;return Ml.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new hh;return Ml.Kt.Dt(mc(this.databaseId,n),r.Pn(function(i){const o=Nl(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new hh);let i=0;for(const o of Nl(e)){const a=r[i++];for(const l of s)if(this.Un(n,o.fieldPath)&&Mf(a))s=this.Kn(s,o,a);else{const c=l.Pn(o.kind);Ml.Kt.Dt(a,c)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new hh;l.seed(a.un()),Ml.Kt.Dt(o,l.Pn(n.kind)),i.push(l)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof Ht&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=fh(e),s=zc(e);return(n?r.J(M0,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return $.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(u,d){const m=d?new rd(d.sequenceNumber,new Us(wc(d.readTime),new _e(Wi(d.documentKey)),d.largestBatchId)):rd.empty(),p=u.fields.map(([v,g])=>new tc(On.fromServerFormat(v),g));return new nd(u.indexId,u.collectionGroup,p,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:gt(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=fh(e),i=zc(e);return this.Gn(e).next(o=>s.J(M0,IDBKeyRange.bound(n,n)).next(a=>$.forEach(a,l=>i.put(c1(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return $.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?$.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),$.forEach(a,l=>this.zn(e,s,l).next(c=>{const u=this.jn(i,l);return c.isEqual(u)?$.resolve():this.Jn(e,i,l,c,u)}))))})}Hn(e,n,r,s){return Bc(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return Bc(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=Bc(e);let i=new gn(ta);return s.ee({index:aO,range:IDBKeyRange.only([r.indexId,this.uid,Gp(this.$n(r,n))])},(o,a)=>{i=i.add(new Vl(r.indexId,n,m1(a.arrayValue),m1(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new gn(ta);const s=this.Qn(n,e);if(s==null)return r;const i=O0(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Mf(o))for(const a of o.arrayValue.values||[])r=r.add(new Vl(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new Vl(n.indexId,e.key,rp,s));return r}Jn(e,n,r,s,i){de(y1,"Updating index entries for document '%s'",n.key);const o=[];return function(l,c,u,d,m){const p=l.getIterator(),v=c.getIterator();let g=Uc(p),E=Uc(v);for(;g||E;){let b=!1,_=!1;if(g&&E){const S=u(g,E);S<0?_=!0:S>0&&(b=!0)}else g!=null?_=!0:b=!0;b?(d(E),E=Uc(v)):_?(m(g),g=Uc(p)):(g=Uc(p),E=Uc(v))}}(s,i,ta,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),$.waitFor(o)}Gn(e){let n=1;return zc(e).ee({index:oO,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ta(o,a)).filter((o,a,l)=>!a||ta(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=ta(o,e),l=ta(o,n);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(o),s.push(o.An());else if(l>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,rp,_e.empty()),l=s[o+1].Vn(this.uid,rp,_e.empty());i.push(IDBKeyRange.bound(a,l))}return i}Zn(e,n){return ta(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(w1)}getMinOffset(e,n){return $.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||Le(44426))).next(w1)}}function v1(t){return Er(t,kf)}function Bc(t){return Er(t,Kh)}function fh(t){return Er(t,ZE)}function zc(t){return Er(t,Hh)}function w1(t){Je(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;YE(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Us(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pL=41943040;class Qr{static withCacheSize(e){return new Qr(e,Qr.DEFAULT_COLLECTION_PERCENTILE,Qr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gL(t,e,n){const r=t.store(ci),s=t.store(sd),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(u,d,m)=>(a++,m.delete()));i.push(l.next(()=>{Je(a===1,47070,{batchId:n.batchId})}));const c=[];for(const u of n.mutations){const d=rO(e,u.key.path,n.batchId);i.push(s.delete(d)),c.push(u.key)}return $.waitFor(i).next(()=>c)}function ty(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Le(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qr.DEFAULT_COLLECTION_PERCENTILE=10,Qr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qr.DEFAULT=new Qr(pL,Qr.DEFAULT_COLLECTION_PERCENTILE,Qr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qr.DISABLED=new Qr(-1,0,0);class _v{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){Je(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new _v(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return na(e).ee({index:Hl,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=eu(e),o=na(e);return o.add({}).next(a=>{Je(typeof a=="number",49019);const l=new cS(a,n,r,s),c=function(p,v,g){const E=g.baseMutations.map(_=>Ff(p.yt,_)),b=g.mutations.map(_=>Ff(p.yt,_));return{userId:v,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:E,mutations:b}}(this.serializer,this.userId,l),u=[];let d=new gn((m,p)=>gt(m.canonicalString(),p.canonicalString()));for(const m of s){const p=rO(this.userId,m.key.path,a);d=d.add(m.key.path.popLast()),u.push(o.put(c)),u.push(i.put(p,SH))}return d.forEach(m=>{u.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),$.waitFor(u).next(()=>l)})}lookupMutationBatch(e,n){return na(e).get(n).next(r=>r?(Je(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Ll(this.serializer,r)):null)}er(e,n){return this.Xn[n]?$.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return na(e).ee({index:Hl,range:s},(o,a,l)=>{a.userId===this.userId&&(Je(a.batchId>=r,47524,{tr:r}),i=Ll(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=qa;return na(e).ee({index:Hl,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,qa],[this.userId,Number.POSITIVE_INFINITY]);return na(e).J(Hl,n).next(r=>r.map(s=>Ll(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=$p(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return eu(e).ee({range:s},(o,a,l)=>{const[c,u,d]=o,m=Wi(u);if(c===this.userId&&n.path.isEqual(m))return na(e).get(d).next(p=>{if(!p)throw Le(61480,{nr:o,batchId:d});Je(p.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:p.userId,batchId:d}),i.push(Ll(this.serializer,p))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new gn(gt);const s=[];return n.forEach(i=>{const o=$p(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=eu(e).ee({range:a},(c,u,d)=>{const[m,p,v]=c,g=Wi(p);m===this.userId&&i.path.isEqual(g)?r=r.add(v):d.done()});s.push(l)}),$.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=$p(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new gn(gt);return eu(e).ee({range:o},(l,c,u)=>{const[d,m,p]=l,v=Wi(m);d===this.userId&&r.isPrefixOf(v)?v.length===s&&(a=a.add(p)):u.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(na(e).get(i).next(o=>{if(o===null)throw Le(35274,{batchId:i});Je(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(Ll(this.serializer,o))}))}),$.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return gL(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),$.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return $.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return eu(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=Wi(i[1]);s.push(l)}else a.done()}).next(()=>{Je(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return yL(e,this.userId,n)}_r(e){return vL(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:qa,lastStreamToken:""})}}function yL(t,e,n){const r=$p(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return eu(t).ee({range:i,X:!0},(a,l,c)=>{const[u,d,m]=a;u===e&&d===s&&(o=!0),c.done()}).next(()=>o)}function na(t){return Er(t,ci)}function eu(t){return Er(t,sd)}function vL(t){return Er(t,Cf)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new _c(0)}static cr(){return new _c(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zK{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new _c(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>at.fromTimestamp(new sn(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Wc(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(Je(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Wc(e).ee((o,a)=>{const l=Ph(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>$.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Wc(e).ee((r,s)=>{const i=Ph(s);n(i)})}lr(e){return b1(e).get(Qg).next(n=>(Je(n!==null,2888),n))}hr(e,n){return b1(e).put(Qg,n)}Pr(e,n){return Wc(e).put(hL(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=pc(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Wc(e).ee({range:s,index:iO},(o,a,l)=>{const c=Ph(a);cm(n,c.target)&&(i=c,l.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=wa(e);return n.forEach(o=>{const a=Jr(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),$.waitFor(s)}removeMatchingKeys(e,n,r){const s=wa(e);return $.forEach(n,i=>{const o=Jr(i.path);return $.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=wa(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=wa(e);let i=At();return s.ee({range:r,X:!0},(o,a,l)=>{const c=Wi(o[1]),u=new _e(c);i=i.add(u)}).next(()=>i)}containsKey(e,n){const r=Jr(n.path),s=IDBKeyRange.bound([r],[K2(r)],!1,!0);let i=0;return wa(e).ee({index:XE,X:!0,range:s},([o,a],l,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}At(e,n){return Wc(e).get(n).next(r=>r?Ph(r):null)}}function Wc(t){return Er(t,id)}function b1(t){return Er(t,nc)}function wa(t){return Er(t,od)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1="LruGarbageCollector",wL=1048576;function S1([t,e],[n,r]){const s=gt(t,n);return s===0?gt(e,r):s}class WK{constructor(e){this.Ir=e,this.buffer=new gn(S1),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();S1(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class _L{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){de(E1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){gl(n)?de(E1,"Ignoring IndexedDB error during garbage collection: ",n):await pl(n)}await this.Vr(3e5)})}}class qK{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return $.resolve(gs.ce);const r=new WK(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(de("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(_1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(de("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_1):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(de("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,o=Date.now(),this.nthSequenceNumber(e,s))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(i=d,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),Jc()<=Wt.DEBUG&&de("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:d})))}}function bL(t,e){return new qK(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HK{constructor(e,n){this.db=e,this.garbageCollector=bL(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return sp(e,r)}removeReference(e,n,r){return sp(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return sp(e,n)}br(e,n){return function(s,i){let o=!1;return vL(s).te(a=>yL(s,a,i).next(l=>(l&&(o=!0),$.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,at.min()),wa(e).delete(function(d){return[0,Jr(d.path)]}(o))))});s.push(l)}}).next(()=>$.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return sp(e,n)}Sr(e,n){const r=wa(e);let s,i=gs.ce;return r.ee({index:XE},([o,a],{path:l,sequenceNumber:c})=>{o===0?(i!==gs.ce&&n(new _e(Wi(s)),i),i=c,s=l):i=gs.ce}).next(()=>{i!==gs.ce&&n(new _e(Wi(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function sp(t,e){return wa(t).put(function(r,s){return{targetId:0,path:Jr(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(){this.changes=new Wo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Dn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?$.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KK{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return xl(e).put(r)}removeEntry(e,n,r){return xl(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Zg(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=Dn.newInvalidDocument(n);return xl(e).ee({index:Bp,range:IDBKeyRange.only(mh(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:Dn.newInvalidDocument(n)};return xl(e).ee({index:Bp,range:IDBKeyRange.only(mh(n))},(s,i)=>{r={document:this.Cr(n,i),size:ty(i)}}).next(()=>r)}getEntries(e,n){let r=vs();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=vs(),s=new An(_e.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,ty(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return $.resolve();let s=new gn(x1);n.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(mh(s.first()),mh(s.last())),o=s.getIterator();let a=o.getNext();return xl(e).ee({index:Bp,range:i},(l,c,u)=>{const d=_e.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&x1(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?u.j(mh(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Zg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xl(e).J(IDBKeyRange.bound(a,l,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let u=vs();for(const d of c){const m=this.Cr(_e.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);m.isFoundDocument()&&(dm(n,m)||s.has(m.key))&&(u=u.insert(m.key,m))}return u})}getAllFromCollectionGroup(e,n,r,s){let i=vs();const o=T1(n,r),a=T1(n,Us.max());return xl(e).ee({index:sO,range:IDBKeyRange.bound(o,a,!0)},(l,c,u)=>{const d=this.Cr(_e.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(d.key,d),i.size===s&&u.done()}).next(()=>i)}newChangeBuffer(e){return new GK(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return I1(e).get(L0).next(n=>(Je(!!n,20021),n))}Dr(e,n){return I1(e).put(L0,n)}Cr(e,n){if(n){const r=DK(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(at.min())))return r}return Dn.newInvalidDocument(e)}}function SL(t){return new KK(t)}class GK extends EL{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new Wo(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new gn((i,o)=>gt(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=a1(this.Nr.serializer,o);s=s.add(i.path.popLast());const c=ty(l);r+=c-a.size,n.push(this.Nr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=a1(this.Nr.serializer,o.convertToNoDocument(at.min()));n.push(this.Nr.addEntry(e,i,l))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),$.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function I1(t){return Er(t,Nf)}function xl(t){return Er(t,Gg)}function mh(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function T1(t,e){const n=e.documentKey.path.toArray();return[t,Zg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function x1(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=gt(n[i],r[i]),s)return s;return s=gt(n.length,r.length),s||(s=gt(n[n.length-2],r[r.length-2]),s||gt(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QK{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Yh(r.mutation,s,ys.empty(),sn.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,At()).next(()=>r))}getLocalViewOfDocuments(e,n,r=At()){const s=qi();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=xh();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=qi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,At()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=vs();const o=Qh(),a=function(){return Qh()}();return n.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof qo)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),Yh(u.mutation,c,u.mutation.getFieldMask(),sn.now())):o.set(c.key,ys.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>a.set(c,new QK(u,o.get(c)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Qh();let s=new An((o,a)=>o-a),i=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||ys.empty();u=a.applyToLocalView(c,u),r.set(l,u);const d=(s.get(a.batchId)||At()).add(l);s=s.insert(a.batchId,d)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,d=FO();u.forEach(m=>{if(!i.has(m)){const p=HO(n.get(m),r.get(m));p!==null&&d.set(m,p),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return $.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return _e.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):iS(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):$.resolve(qi());let a=td,l=i;return o.next(c=>$.forEach(c,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(u)?$.resolve():this.remoteDocumentCache.getEntry(e,u).next(m=>{l=l.insert(u,m)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,At())).next(u=>({batchId:a,changes:jO(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new _e(n)).next(r=>{let s=xh();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=xh();return this.indexManager.getCollectionParents(e,i).next(a=>$.forEach(a,l=>{const c=function(d,m){return new zo(m,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(u=>{u.forEach((d,m)=>{o=o.insert(d,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Dn.newInvalidDocument(u)))});let a=xh();return o.forEach((l,c)=>{const u=i.get(l);u!==void 0&&Yh(u.mutation,c,ys.empty(),sn.now()),dm(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YK{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return $.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:lr(s.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:vv(s.bundledQuery),readTime:lr(s.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JK{constructor(){this.overlays=new An(_e.comparator),this.qr=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const r=qi();return $.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),$.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),$.resolve()}getOverlaysForCollection(e,n,r){const s=qi(),i=n.length+1,o=new _e(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return $.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new An((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=qi(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=qi(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return $.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new dS(n,r));let i=this.qr.get(n);i===void 0&&(i=At(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XK{constructor(){this.sessionToken=Gn.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(){this.Qr=new gn(xr.$r),this.Ur=new gn(xr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new xr(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new xr(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new _e(new Ft([])),r=new xr(n,e),s=new xr(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new _e(new Ft([])),r=new xr(n,e),s=new xr(n,e+1);let i=At();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new xr(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class xr{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return _e.comparator(e.key,n.key)||gt(e.Yr,n.Yr)}static Kr(e,n){return gt(e.Yr,n.Yr)||_e.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZK{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new gn(xr.$r)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new cS(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new xr(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,n){return $.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?qa:this.tr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new xr(n,0),s=new xr(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new gn(gt);return n.forEach(s=>{const i=new xr(s,0),o=new xr(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),$.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;_e.isDocumentKey(i)||(i=i.child(""));const o=new xr(new _e(i),0);let a=new gn(gt);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Yr)),!0)},o),$.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Je(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return $.forEach(n.mutations,s=>{const i=new xr(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new xr(n,0),s=this.Zr.firstAfterOrEqual(r);return $.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eG{constructor(e){this.ri=e,this.docs=function(){return new An(_e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return $.resolve(r?r.document.mutableCopy():Dn.newInvalidDocument(n))}getEntries(e,n){let r=vs();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Dn.newInvalidDocument(s))}),$.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=vs();const o=n.path,a=new _e(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||YE(X2(u),r)<=0||(s.has(u.key)||dm(n,u))&&(i=i.insert(u.key,u.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Le(9500)}ii(e,n){return $.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new tG(this)}getSize(e){return $.resolve(this.size)}}class tG extends EL{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),$.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nG{constructor(e){this.persistence=e,this.si=new Wo(n=>pc(n),cm),this.lastRemoteSnapshotVersion=at.min(),this.highestTargetId=0,this.oi=0,this._i=new gS,this.targetCount=0,this.ai=_c.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),$.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new _c(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.Pr(n),$.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),$.waitFor(i).next(()=>s)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return $.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),$.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return $.resolve(r)}containsKey(e,n){return $.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e,n){this.ui={},this.overlays={},this.ci=new gs(0),this.li=!1,this.li=!0,this.hi=new XK,this.referenceDelegate=e(this),this.Pi=new nG(this),this.indexManager=new $K,this.remoteDocumentCache=function(s){return new eG(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new dL(n),this.Ii=new YK(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new JK,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new ZK(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){de("MemoryPersistence","Starting transaction:",e);const s=new rG(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return $.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class rG extends eO{constructor(e){super(),this.currentSequenceNumber=e}}class bv{constructor(e){this.persistence=e,this.Ri=new gS,this.Vi=null}static mi(e){return new bv(e)}get fi(){if(this.Vi)return this.Vi;throw Le(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),$.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),$.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.fi,r=>{const s=_e.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,at.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return $.or([()=>$.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class ny{constructor(e,n){this.persistence=e,this.pi=new Wo(r=>Jr(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=bL(this,n)}static mi(e,n){return new ny(e,n)}Ei(){}di(e){return $.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return $.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?$.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,at.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),$.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),$.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Wp(e.data.value)),n}br(e,n,r){return $.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return $.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sG{constructor(e){this.serializer=e}k(e,n,r,s){const i=new av("createOrUpgrade",n);r<1&&s>=1&&(function(l){l.createObjectStore(lm)}(e),function(l){l.createObjectStore(Cf,{keyPath:EH}),l.createObjectStore(ci,{keyPath:VA,autoIncrement:!0}).createIndex(Hl,jA,{unique:!0}),l.createObjectStore(sd)}(e),A1(e),function(l){l.createObjectStore(kl)}(e));let o=$.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore(od),l.deleteObjectStore(id),l.deleteObjectStore(nc)}(e),A1(e)),o=o.next(()=>function(l){const c=l.store(nc),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:at.min().toTimestamp(),targetCount:0};return c.put(Qg,u)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store(ci).J().next(d=>{l.deleteObjectStore(ci),l.createObjectStore(ci,{keyPath:VA,autoIncrement:!0}).createIndex(Hl,jA,{unique:!0});const m=c.store(ci),p=d.map(v=>m.put(v));return $.waitFor(p)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore(ad,{keyPath:NH})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(Nf)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(lv,{keyPath:kH})})(e),function(l){l.createObjectStore(cv,{keyPath:DH})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore(uv,{keyPath:UH});c.createIndex(V0,$H,{unique:!1}),c.createIndex(lO,BH,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore(Gg,{keyPath:IH});c.createIndex(Bp,TH),c.createIndex(sO,xH)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(kl))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore(ZE,{keyPath:OH,autoIncrement:!0}).createIndex(M0,LH,{unique:!1}),l.createObjectStore(Hh,{keyPath:MH}).createIndex(oO,VH,{unique:!1}),l.createObjectStore(Kh,{keyPath:jH}).createIndex(aO,FH,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(Hh).clear()}).next(()=>{n.objectStore(Kh).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(eS,{keyPath:zH})})(e)})),r<18&&s>=18&&$D()&&(o=o.next(()=>{n.objectStore(Hh).clear()}).next(()=>{n.objectStore(Kh).clear()})),o}wi(e){let n=0;return e.store(kl).ee((r,s)=>{n+=ty(s)}).next(()=>{const r={byteSize:n};return e.store(Nf).put(L0,r)})}yi(e){const n=e.store(Cf),r=e.store(ci);return n.J().next(s=>$.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,qa],[i.userId,i.lastAcknowledgedBatchId]);return r.J(Hl,o).next(a=>$.forEach(a,l=>{Je(l.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=Ll(this.serializer,l);return gL(e,i.userId,c).next(()=>{})}))}))}Si(e){const n=e.store(od),r=e.store(kl);return e.store(nc).get(Qg).next(s=>{const i=[];return r.ee((o,a)=>{const l=new Ft(o),c=function(d){return[0,Jr(d)]}(l);i.push(n.get(c).next(u=>u?$.resolve():(d=>n.put({targetId:0,path:Jr(d),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>$.waitFor(i))})}bi(e,n){e.createObjectStore(kf,{keyPath:CH});const r=n.store(kf),s=new pS,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Jr(l)})}};return n.store(kl).ee({X:!0},(o,a)=>{const l=new Ft(o);return i(l.popLast())}).next(()=>n.store(sd).ee({X:!0},([o,a,l],c)=>{const u=Wi(a);return i(u.popLast())}))}Di(e){const n=e.store(id);return n.ee((r,s)=>{const i=Ph(s),o=hL(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store(kl),s=[];return r.ee((i,o)=>{const a=n.store(Gg),l=function(d){return d.document?new _e(Ft.fromString(d.document.name).popFirst(5)):d.noDocument?_e.fromSegments(d.noDocument.path):d.unknownDocument?_e.fromSegments(d.unknownDocument.path):Le(36783)}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>$.waitFor(s))}Fi(e,n){const r=n.store(ci),s=SL(this.serializer),i=new yS(bv.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let c=a.get(l.userId)??At();Ll(this.serializer,l).keys().forEach(u=>c=c.add(u)),a.set(l.userId,c)}),$.forEach(a,(l,c)=>{const u=new Pr(c),d=wv.wt(this.serializer,u),m=i.getIndexManager(u),p=_v.wt(u,this.serializer,m,i.referenceDelegate);return new IL(s,p,d,m).recalculateAndSaveOverlaysForDocumentKeys(new j0(n,gs.ce),l).next()})})}}function A1(t){t.createObjectStore(od,{keyPath:PH}).createIndex(XE,RH,{unique:!0}),t.createObjectStore(id,{keyPath:"targetId"}).createIndex(iO,AH,{unique:!0}),t.createObjectStore(nc)}const ra="IndexedDbPersistence",Uw=18e5,$w=5e3,Bw="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",TL="main";class vS{constructor(e,n,r,s,i,o,a,l,c,u,d=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=c,this.Oi=u,this.Ni=d,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!vS.v())throw new ie(z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new HK(this,s),this.$i=n+TL,this.serializer=new dL(l),this.Ui=new Xi(this.$i,this.Ni,new sG(this.serializer)),this.hi=new LK,this.Pi=new zK(this.referenceDelegate,this.serializer),this.remoteDocumentCache=SL(this.serializer),this.Ii=new OK,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,u===!1&&or(ra,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ie(z.FAILED_PRECONDITION,Bw);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new gs(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ip(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(gl(e))return de(ra,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return de(ra,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return ph(e).get(Fc).next(n=>$.resolve(this.es(n)))}ts(e){return ip(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Uw)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Er(n,ad);return r.J().next(s=>{const i=this.ss(s,Uw),o=s.filter(a=>i.indexOf(a)===-1);return $.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?$.resolve(!0):ph(e).get(Fc).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,$w)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new ie(z.FAILED_PRECONDITION,Bw);return!1}}return!(!this.networkEnabled||!this.inForeground)||ip(e).J().next(r=>this.ss(r,$w).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&de(ra,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[lm,ad],e=>{const n=new j0(e,gs.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>ip(e).J().next(n=>this.ss(n,Uw).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return _v.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new BK(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return wv.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){de(ra,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(l){return l===18?HH:l===17?hO:l===16?qH:l===15?tS:l===14?dO:l===13?uO:l===12?WH:l===11?cO:void Le(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new j0(a,this.ci?this.ci.next():gs.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw or(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new ie(z.FAILED_PRECONDITION,Z2);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return ph(e).get(Fc).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,$w)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ie(z.FAILED_PRECONDITION,Bw)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ph(e).put(Fc,n)}static v(){return Xi.v()}Zi(e){const n=ph(e);return n.get(Fc).next(r=>this.es(r)?(de(ra,"Releasing primary lease."),n.delete(Fc)):$.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(or(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;UD()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return de(ra,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return or(ra,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){or("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ph(t){return Er(t,lm)}function ip(t){return Er(t,ad)}function wS(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=At(),s=At();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new _S(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return UD()?8:tO(_r())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new iG;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Jc()<=Wt.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",Xc(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),$.resolve()):(Jc()<=Wt.DEBUG&&de("QueryEngine","Query:",Xc(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Jc()<=Wt.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",Xc(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xr(n))):$.resolve())}ys(e,n){if(JA(n))return $.resolve(null);let r=Xr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Xg(n,null,"F"),r=Xr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=At(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.Ds(n,a);return this.Cs(n,c,o,l.readTime)?this.ys(e,Xg(n,null,"F")):this.vs(e,c,n,l)}))})))}ws(e,n,r,s){return JA(n)||s.isEqual(at.min())?$.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?$.resolve(null):(Jc()<=Wt.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Xc(n)),this.vs(e,o,n,J2(s,td)).next(a=>a))})}Ds(e,n){let r=new gn(MO(e));return n.forEach((s,i)=>{dm(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return Jc()<=Wt.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",Xc(n)),this.ps.getDocumentsMatchingQuery(e,n,Us.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS="LocalStore",oG=3e8;class aG{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new An(gt),this.xs=new Wo(i=>pc(i),cm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new IL(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function AL(t,e,n,r){return new aG(t,e,n,r)}async function PL(t,e){const n=Se(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=At();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Ls:c,removedBatchIds:o,addedBatchIds:a}))})})}function lG(t,e){const n=Se(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const d=c.batch,m=d.keys();let p=$.resolve();return m.forEach(v=>{p=p.next(()=>u.getEntry(l,v)).next(g=>{const E=c.docVersions.get(v);Je(E!==null,48541),g.version.compareTo(E)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),u.addEntry(g)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=At();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function RL(t){const e=Se(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function cG(t,e){const n=Se(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((u,d)=>{const m=s.get(d);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,u.removedDocuments,d).next(()=>n.Pi.addMatchingKeys(i,u.addedDocuments,d)));let p=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(Gn.EMPTY_BYTE_STRING,at.min()).withLastLimboFreeSnapshotVersion(at.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,r)),s=s.insert(d,p),function(g,E,b){return g.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=oG?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(m,p,u)&&a.push(n.Pi.updateTargetData(i,p))});let l=vs(),c=At();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(CL(i,o,e.documentUpdates).next(u=>{l=u.ks,c=u.qs})),!r.isEqual(at.min())){const u=n.Pi.getLastRemoteSnapshotVersion(i).next(d=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return $.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.Ms=s,i))}function CL(t,e,n){let r=At(),s=At();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=vs();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(at.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):de(bS,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{ks:o,qs:s}})}function uG(t,e){const n=Se(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=qa),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function md(t,e){const n=Se(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,$.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new So(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function pd(t,e,n){const r=Se(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!gl(o))throw o;de(bS,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function ry(t,e,n){const r=Se(t);let s=at.min(),i=At();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const d=Se(l),m=d.xs.get(u);return m!==void 0?$.resolve(d.Ms.get(m)):d.Pi.getTargetData(c,u)}(r,o,Xr(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:at.min(),n?i:At())).next(a=>(DL(r,LO(e),a),{documents:a,Qs:i})))}function NL(t,e){const n=Se(t),r=Se(n.Pi),s=n.Ms.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.At(i,e).next(o=>o?o.target:null))}function kL(t,e){const n=Se(t),r=n.Os.get(e)||at.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.Ns.getAllFromCollectionGroup(s,e,J2(r,td),Number.MAX_SAFE_INTEGER)).then(s=>(DL(n,e,s),s))}function DL(t,e,n){let r=t.Os.get(e)||at.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}async function dG(t,e,n,r){const s=Se(t);let i=At(),o=vs();for(const c of n){const u=e.$s(c.metadata.name);c.document&&(i=i.add(u));const d=e.Us(c);d.setReadTime(e.Ks(c.metadata.readTime)),o=o.insert(u,d)}const a=s.Ns.newChangeBuffer({trackRemovals:!0}),l=await md(s,function(u){return Xr(jd(Ft.fromString(`__bundle__/docs/${u}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",c=>CL(c,a,o).next(u=>(a.apply(c),u)).next(u=>s.Pi.removeMatchingKeysForTargetId(c,l.targetId).next(()=>s.Pi.addMatchingKeys(c,i,l.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(c,u.ks,u.qs)).next(()=>u.ks)))}async function hG(t,e,n=At()){const r=await md(t,Xr(vv(e.bundledQuery))),s=Se(t);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=lr(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Ii.saveNamedQuery(i,e);const a=r.withResumeToken(Gn.EMPTY_BYTE_STRING,o);return s.Ms=s.Ms.insert(a.targetId,a),s.Pi.updateTargetData(i,a).next(()=>s.Pi.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Pi.addMatchingKeys(i,n,r.targetId)).next(()=>s.Ii.saveNamedQuery(i,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OL="firestore_clients";function P1(t,e){return`${OL}_${t}_${e}`}const LL="firestore_mutations";function R1(t,e,n){let r=`${LL}_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const ML="firestore_targets";function zw(t,e){return`${ML}_${t}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fi="SharedClientState";class sy{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Ws(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new ie(s.error.code,s.error.message))),o?new sy(e,n,s.state,i):(or(Fi,`Failed to parse mutation state for ID '${n}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Xh{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ws(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new ie(r.error.code,r.error.message))),i?new Xh(e,r.state,s):(or(Fi,`Failed to parse target state for ID '${e}': ${n}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class iy{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ws(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=oS();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=nO(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new iy(e,i):(or(Fi,`Failed to parse client data for instance '${e}': ${n}`),null)}}class ES{constructor(e,n){this.clientId=e,this.onlineState=n}static Ws(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new ES(n.clientId,n.onlineState):(or(Fi,`Failed to parse online state: ${e}`),null)}}class X0{constructor(){this.activeTargetIds=oS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ww{constructor(e,n,r,s,i){this.window=e,this.Mi=n,this.persistenceKey=r,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new An(gt),this.started=!1,this.Xs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.eo=P1(this.persistenceKey,this.Js),this.no=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new X0),this.ro=new RegExp(`^${OL}_${o}_([^_]*)$`),this.io=new RegExp(`^${LL}_${o}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${ML}_${o}_(\\d+)$`),this.oo=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this._o=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const s=this.getItem(P1(this.persistenceKey,r));if(s){const i=iy.Ws(r,s);i&&(this.Zs=this.Zs.insert(i.clientId,i))}}this.ao();const n=this.storage.getItem(this.oo);if(n){const r=this.uo(n);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let n=!1;return this.Zs.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,n,r){this.ho(e,n,r),this.Po(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(zw(this.persistenceKey,e));if(s){const i=Xh.Ws(e,s);i&&(r=i.state)}}return n&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(zw(this.persistenceKey,e))}updateQueryState(e,n,r){this.Io(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Po(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return de(Fi,"READ",e,n),n}setItem(e,n){de(Fi,"SET",e,n),this.storage.setItem(e,n)}removeItem(e){de(Fi,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const n=e;if(n.storageArea===this.storage){if(de(Fi,"EVENT",n.key,n.newValue),n.key===this.eo)return void or("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.ro.test(n.key)){if(n.newValue==null){const r=this.Ro(n.key);return this.Vo(r,null)}{const r=this.mo(n.key,n.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(n.key)){if(n.newValue!==null){const r=this.fo(n.key,n.newValue);if(r)return this.po(r)}}else if(this.so.test(n.key)){if(n.newValue!==null){const r=this.yo(n.key,n.newValue);if(r)return this.wo(r)}}else if(n.key===this.oo){if(n.newValue!==null){const r=this.uo(n.newValue);if(r)return this.co(r)}}else if(n.key===this.no){const r=function(i){let o=gs.ce;if(i!=null)try{const a=JSON.parse(i);Je(typeof a=="number",30636,{So:i}),o=a}catch(a){or(Fi,"Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==gs.ce&&this.sequenceNumberHandler(r)}else if(n.key===this._o){const r=this.bo(n.newValue);await Promise.all(r.map(s=>this.syncEngine.Do(s)))}}}else this.Xs.push(n)})}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,n,r){const s=new sy(this.currentUser,e,n,r),i=R1(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Gs())}Po(e){const n=R1(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Eo(e){const n={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(n))}Io(e,n,r){const s=zw(this.persistenceKey,e),i=new Xh(e,n,r);this.setItem(s,i.Gs())}Ao(e){const n=JSON.stringify(Array.from(e));this.setItem(this._o,n)}Ro(e){const n=this.ro.exec(e);return n?n[1]:null}mo(e,n){const r=this.Ro(e);return iy.Ws(r,n)}fo(e,n){const r=this.io.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return sy.Ws(new Pr(i),s,n)}yo(e,n){const r=this.so.exec(e),s=Number(r[1]);return Xh.Ws(s,n)}uo(e){return ES.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);de(Fi,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,n){const r=n?this.Zs.insert(e,n):this.Zs.remove(e),s=this.lo(this.Zs),i=this.lo(r),o=[],a=[];return i.forEach(l=>{s.has(l)||o.push(l)}),s.forEach(l=>{i.has(l)||a.push(l)}),this.syncEngine.Fo(o,a).then(()=>{this.Zs=r})}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let n=oS();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class VL{constructor(){this.Mo=new X0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new X0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fG{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1="ConnectivityMonitor";class N1{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){de(C1,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){de(C1,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let op=null;function Z0(){return op===null?op=function(){return 268435456+Math.round(2147483648*Math.random())}():op++,"0x"+op.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw="RestConnection",mG={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pG{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Of?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=Z0(),a=this.zo(e,n.toUriEncodedString());de(qw,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:c}=new URL(a),u=Ti(c);return this.Jo(e,a,l,r,u).then(d=>(de(qw,`Received RPC '${e}' ${o}: `,d),d),d=>{throw Fs(qw,`RPC '${e}' ${o} failed with error: `,d,"url: ",a,"request:",r),d})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vd}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=mG[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gG{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr="WebChannelConnection";class yG extends pG{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=Z0();return new Promise((a,l)=>{const c=new j2;c.setWithCredentials(!0),c.listenOnce(F2.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Up.NO_ERROR:const d=c.getResponseJson();de(Kr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),a(d);break;case Up.TIMEOUT:de(Kr,`RPC '${e}' ${o} timed out`),l(new ie(z.DEADLINE_EXCEEDED,"Request time out"));break;case Up.HTTP_ERROR:const m=c.getStatus();if(de(Kr,`RPC '${e}' ${o} failed with status:`,m,"response text:",c.getResponseText()),m>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const v=p==null?void 0:p.error;if(v&&v.status&&v.message){const g=function(b){const _=b.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(_)>=0?_:z.UNKNOWN}(v.status);l(new ie(g,v.message))}else l(new ie(z.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ie(z.UNAVAILABLE,"Connection failed."));break;default:Le(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{de(Kr,`RPC '${e}' ${o} completed.`)}});const u=JSON.stringify(s);de(Kr,`RPC '${e}' ${o} sending request:`,s),c.send(n,"POST",u,r,15)})}T_(e,n,r){const s=Z0(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=B2(),a=$2(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const u=i.join("");de(Kr,`Creating RPC '${e}' stream ${s}: ${u}`,l);const d=o.createWebChannel(u,l);this.I_(d);let m=!1,p=!1;const v=new gG({Yo:E=>{p?de(Kr,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(m||(de(Kr,`Opening RPC '${e}' stream ${s} transport.`),d.open(),m=!0),de(Kr,`RPC '${e}' stream ${s} sending:`,E),d.send(E))},Zo:()=>d.close()}),g=(E,b,_)=>{E.listen(b,S=>{try{_(S)}catch(P){setTimeout(()=>{throw P},0)}})};return g(d,Th.EventType.OPEN,()=>{p||(de(Kr,`RPC '${e}' stream ${s} transport opened.`),v.o_())}),g(d,Th.EventType.CLOSE,()=>{p||(p=!0,de(Kr,`RPC '${e}' stream ${s} transport closed`),v.a_(),this.E_(d))}),g(d,Th.EventType.ERROR,E=>{p||(p=!0,Fs(Kr,`RPC '${e}' stream ${s} transport errored. Name:`,E.name,"Message:",E.message),v.a_(new ie(z.UNAVAILABLE,"The operation could not be completed")))}),g(d,Th.EventType.MESSAGE,E=>{var b;if(!p){const _=E.data[0];Je(!!_,16349);const S=_,P=(S==null?void 0:S.error)||((b=S[0])==null?void 0:b.error);if(P){de(Kr,`RPC '${e}' stream ${s} received error:`,P);const T=P.status;let N=function(R){const k=ur[R];if(k!==void 0)return YO(k)}(T),I=P.message;N===void 0&&(N=z.INTERNAL,I="Unknown error status: "+T+" with message "+P.message),p=!0,v.a_(new ie(N,I)),d.close()}else de(Kr,`RPC '${e}' stream ${s} received:`,_),v.u_(_)}}),g(a,U2.STAT_EVENT,E=>{E.stat===C0.PROXY?de(Kr,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===C0.NOPROXY&&de(Kr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{v.__()},0),v}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jL(){return typeof window<"u"?window:null}function Qp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dc(t){return new SK(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&de("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="PersistentStream";class FL{constructor(e,n,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new SS(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(or(n.toString()),or("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new ie(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return de(k1,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(de(k1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class vG extends FL{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=xK(this.serializer,e),r=function(i){if(!("targetChange"in i))return at.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?at.min():o.readTime?lr(o.readTime):at.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=K0(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=Yg(l)?{documents:iL(i,l)}:{query:yv(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=eL(i,o.resumeToken);const c=q0(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(at.min())>0){a.readTime=fd(i,o.snapshotVersion.toTimestamp());const c=q0(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=PK(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=K0(this.serializer),n.removeTarget=e,this.q_(n)}}class wG extends FL{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Je(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=AK(e.writeResults,e.commitTime),r=lr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=K0(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Ff(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _G{}class bG extends _G{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ie(z.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,H0(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ie(z.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,H0(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ie(z.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class EG{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(or(n),this.aa=!1):de("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bc="RemoteStore";class SG{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{vl(this)&&(de(bc,"Restarting streams for network reachability change."),await async function(l){const c=Se(l);c.Ea.add(4),await $d(c),c.Ra.set("Unknown"),c.Ea.delete(4),await pm(c)}(this))})}),this.Ra=new EG(r,s)}}async function pm(t){if(vl(t))for(const e of t.da)await e(!0)}async function $d(t){for(const e of t.da)await e(!1)}function Ev(t,e){const n=Se(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),xS(n)?TS(n):zd(n).O_()&&IS(n,e))}function gd(t,e){const n=Se(t),r=zd(n);n.Ia.delete(e),r.O_()&&UL(n,e),n.Ia.size===0&&(r.O_()?r.L_():vl(n)&&n.Ra.set("Unknown"))}function IS(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(at.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}zd(t).Y_(e)}function UL(t,e){t.Va.Ue(e),zd(t).Z_(e)}function TS(t){t.Va=new wK({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),zd(t).start(),t.Ra.ua()}function xS(t){return vl(t)&&!zd(t).x_()&&t.Ia.size>0}function vl(t){return Se(t).Ea.size===0}function $L(t){t.Va=void 0}async function IG(t){t.Ra.set("Online")}async function TG(t){t.Ia.forEach((e,n)=>{IS(t,e)})}async function xG(t,e){$L(t),xS(t)?(t.Ra.ha(e),TS(t)):t.Ra.set("Unknown")}async function AG(t,e,n){if(t.Ra.set("Online"),e instanceof ZO&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){de(bc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await oy(t,r)}else if(e instanceof Kp?t.Va.Ze(e):e instanceof XO?t.Va.st(e):t.Va.tt(e),!n.isEqual(at.min()))try{const r=await RL(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.Ia.get(c);u&&i.Ia.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=i.Ia.get(l);if(!u)return;i.Ia.set(l,u.withResumeToken(Gn.EMPTY_BYTE_STRING,u.snapshotVersion)),UL(i,l);const d=new So(u.target,l,c,u.sequenceNumber);IS(i,d)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){de(bc,"Failed to raise snapshot:",r),await oy(t,r)}}async function oy(t,e,n){if(!gl(e))throw e;t.Ea.add(1),await $d(t),t.Ra.set("Offline"),n||(n=()=>RL(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{de(bc,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await pm(t)})}function BL(t,e){return e().catch(n=>oy(t,n,e))}async function Bd(t){const e=Se(t),n=rl(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:qa;for(;PG(e);)try{const s=await uG(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,RG(e,s)}catch(s){await oy(e,s)}zL(e)&&WL(e)}function PG(t){return vl(t)&&t.Ta.length<10}function RG(t,e){t.Ta.push(e);const n=rl(t);n.O_()&&n.X_&&n.ea(e.mutations)}function zL(t){return vl(t)&&!rl(t).x_()&&t.Ta.length>0}function WL(t){rl(t).start()}async function CG(t){rl(t).ra()}async function NG(t){const e=rl(t);for(const n of t.Ta)e.ea(n.mutations)}async function kG(t,e,n){const r=t.Ta.shift(),s=uS.from(r,e,n);await BL(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Bd(t)}async function DG(t,e){e&&rl(t).X_&&await async function(r,s){if(function(o){return QO(o)&&o!==z.ABORTED}(s.code)){const i=r.Ta.shift();rl(r).B_(),await BL(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Bd(r)}}(t,e),zL(t)&&WL(t)}async function D1(t,e){const n=Se(t);n.asyncQueue.verifyOperationInProgress(),de(bc,"RemoteStore received new credentials");const r=vl(n);n.Ea.add(3),await $d(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await pm(n)}async function eb(t,e){const n=Se(t);e?(n.Ea.delete(2),await pm(n)):e||(n.Ea.add(2),await $d(n),n.Ra.set("Unknown"))}function zd(t){return t.ma||(t.ma=function(n,r,s){const i=Se(n);return i.sa(),new vG(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:IG.bind(null,t),t_:TG.bind(null,t),r_:xG.bind(null,t),H_:AG.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),xS(t)?TS(t):t.Ra.set("Unknown")):(await t.ma.stop(),$L(t))})),t.ma}function rl(t){return t.fa||(t.fa=function(n,r,s){const i=Se(n);return i.sa(),new wG(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:CG.bind(null,t),r_:DG.bind(null,t),ta:NG.bind(null,t),na:kG.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Bd(t)):(await t.fa.stop(),t.Ta.length>0&&(de(bc,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new AS(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ie(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wd(t,e){if(or("AsyncQueue",`${e}: ${t}`),gl(t))return new ie(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{static emptySet(e){return new rc(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||_e.comparator(n.key,r.key):(n,r)=>_e.comparator(n.key,r.key),this.keyedMap=xh(),this.sortedSet=new An(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof rc)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new rc;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(){this.ga=new An(_e.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Le(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ec{constructor(e,n,r,s,i,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ec(e,n,rc.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&um(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OG{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class LG{constructor(){this.queries=L1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=Se(n),i=s.queries;s.queries=L1(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new ie(z.ABORTED,"Firestore shutting down"))}}function L1(){return new Wo(t=>OO(t),um)}async function PS(t,e){const n=Se(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new OG,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Wd(o,`Initialization of query '${Xc(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&CS(n)}async function RS(t,e){const n=Se(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function MG(t,e){const n=Se(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&CS(n)}function VG(t,e,n){const r=Se(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function CS(t){t.Ca.forEach(e=>{e.next()})}var tb,M1;(M1=tb||(tb={})).Ma="default",M1.Cache="cache";class NS{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ec(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ec.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==tb.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qL{constructor(e,n){this.Qa=e,this.byteLength=n}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e){this.serializer=e}$s(e){return Zi(this.serializer,e)}Us(e){return e.metadata.exists?gv(this.serializer,e.document,!1):Dn.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return lr(e)}}class kS{constructor(e,n){this.Ua=e,this.serializer=n,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=HL(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++n;const r=Ft.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,{...this.progress}):null}za(e){const n=new Map,r=new V1(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.$s(s.metadata.name);for(const o of s.metadata.queries){const a=(n.get(o)||At()).add(i);n.set(o,a)}}return n}async ja(e){const n=await dG(e,new V1(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const s of this.Ka)await hG(e,s,r.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:n}}}function HL(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KL{constructor(e){this.key=e}}class GL{constructor(e){this.key=e}}class QL{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=At(),this.mutatedKeys=At(),this.eu=MO(e),this.tu=new rc(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new O1,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,d)=>{const m=s.get(u),p=dm(this.query,d)?d:null,v=!!m&&this.mutatedKeys.has(m.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let E=!1;m&&p?m.data.isEqual(p.data)?v!==g&&(r.track({type:3,doc:p}),E=!0):this.su(m,p)||(r.track({type:2,doc:p}),E=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(a=!0)):!m&&p?(r.track({type:0,doc:p}),E=!0):m&&!p&&(r.track({type:1,doc:m}),E=!0,(l||c)&&(a=!0)),E&&(p?(o=o.add(p),i=g?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((u,d)=>function(p,v){const g=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le(20277,{Rt:E})}};return g(p)-g(v)}(u.type,d.type)||this.eu(u.doc,d.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new Ec(this.query,e.tu,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new O1,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=At(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new GL(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new KL(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=At();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ec.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const wl="SyncEngine";class jG{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class FG{constructor(e){this.key=e,this.hu=!1}}class UG{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Wo(a=>OO(a),um),this.Iu=new Map,this.Eu=new Set,this.du=new An(_e.comparator),this.Au=new Map,this.Ru=new gS,this.Vu={},this.mu=new Map,this.fu=_c.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function $G(t,e,n=!0){const r=Sv(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await YL(r,e,n,!0),s}async function BG(t,e){const n=Sv(t);await YL(n,e,!0,!1)}async function YL(t,e,n,r){const s=await md(t.localStore,Xr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await DS(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Ev(t.remoteStore,s),a}async function DS(t,e,n,r,s){t.pu=(d,m,p)=>async function(g,E,b,_){let S=E.view.ru(b);S.Cs&&(S=await ry(g.localStore,E.query,!1).then(({documents:I})=>E.view.ru(I,S)));const P=_&&_.targetChanges.get(E.targetId),T=_&&_.targetMismatches.get(E.targetId)!=null,N=E.view.applyChanges(S,g.isPrimaryClient,P,T);return nb(g,E.targetId,N.au),N.snapshot}(t,d,m,p);const i=await ry(t.localStore,e,!0),o=new QL(e,i.Qs),a=o.ru(i.documents),l=mm.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=o.applyChanges(a,t.isPrimaryClient,l);nb(t,n,c.au);const u=new jG(e,n,o);return t.Tu.set(e,u),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),c.snapshot}async function zG(t,e,n){const r=Se(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!um(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await pd(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&gd(r.remoteStore,s.targetId),yd(r,s.targetId)}).catch(pl)):(yd(r,s.targetId),await pd(r.localStore,s.targetId,!0))}async function WG(t,e){const n=Se(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),gd(n.remoteStore,r.targetId))}async function qG(t,e,n){const r=VS(t);try{const s=await function(o,a){const l=Se(o),c=sn.now(),u=a.reduce((p,v)=>p.add(v.key),At());let d,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=vs(),g=At();return l.Ns.getEntries(p,u).next(E=>{v=E,v.forEach((b,_)=>{_.isValidDocument()||(g=g.add(b))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,v)).next(E=>{d=E;const b=[];for(const _ of a){const S=gK(_,d.get(_.key).overlayedDocument);S!=null&&b.push(new qo(_.key,S,SO(S.value.mapValue),$n.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,b,a)}).next(E=>{m=E;const b=E.applyToLocalDocumentSet(d,g);return l.documentOverlayCache.saveOverlays(p,E.batchId,b)})}).then(()=>({batchId:m.batchId,changes:jO(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new An(gt)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c}(r,s.batchId,n),await Ho(r,s.changes),await Bd(r.remoteStore)}catch(s){const i=Wd(s,"Failed to persist write");n.reject(i)}}async function JL(t,e){const n=Se(t);try{const r=await cG(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(Je(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Je(o.hu,14607):s.removedDocuments.size>0&&(Je(o.hu,42227),o.hu=!1))}),await Ho(n,r,e)}catch(r){await pl(r)}}function j1(t,e,n){const r=Se(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=Se(o);l.onlineState=a;let c=!1;l.queries.forEach((u,d)=>{for(const m of d.Sa)m.va(a)&&(c=!0)}),c&&CS(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function HG(t,e,n){const r=Se(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new An(_e.comparator);o=o.insert(i,Dn.newNoDocument(i,at.min()));const a=At().add(i),l=new fm(at.min(),new Map,new An(gt),o,a);await JL(r,l),r.du=r.du.remove(i),r.Au.delete(e),MS(r)}else await pd(r.localStore,e,!1).then(()=>yd(r,e,n)).catch(pl)}async function KG(t,e){const n=Se(t),r=e.batch.batchId;try{const s=await lG(n.localStore,e);LS(n,r,null),OS(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ho(n,s)}catch(s){await pl(s)}}async function GG(t,e,n){const r=Se(t);try{const s=await function(o,a){const l=Se(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>(Je(d!==null,37113),u=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);LS(r,e,n),OS(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ho(r,s)}catch(s){await pl(s)}}async function QG(t,e){const n=Se(t);vl(n.remoteStore)||de(wl,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=Se(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(n.localStore);if(r===qa)return void e.resolve();const s=n.mu.get(r)||[];s.push(e),n.mu.set(r,s)}catch(r){const s=Wd(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function OS(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function LS(t,e,n){const r=Se(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function yd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||XL(t,r)})}function XL(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(gd(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),MS(t))}function nb(t,e,n){for(const r of n)r instanceof KL?(t.Ru.addReference(r.key,e),YG(t,r)):r instanceof GL?(de(wl,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||XL(t,r.key)):Le(19791,{wu:r})}function YG(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(de(wl,"New document in limbo: "+n),t.Eu.add(r),MS(t))}function MS(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new _e(Ft.fromString(e)),r=t.fu.next();t.Au.set(r,new FG(n)),t.du=t.du.insert(n,r),Ev(t.remoteStore,new So(Xr(jd(n.path)),r,"TargetPurposeLimboResolution",gs.ce))}}async function Ho(t,e,n){const r=Se(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(c=>{var u;if((c||n)&&r.isPrimaryClient){const d=c?!c.fromCache:(u=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:u.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){s.push(c);const d=_S.As(l.targetId,c);i.push(d)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,c){const u=Se(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>$.forEach(c,m=>$.forEach(m.Es,p=>u.persistence.referenceDelegate.addReference(d,m.targetId,p)).next(()=>$.forEach(m.ds,p=>u.persistence.referenceDelegate.removeReference(d,m.targetId,p)))))}catch(d){if(!gl(d))throw d;de(bS,"Failed to update sequence numbers: "+d)}for(const d of c){const m=d.targetId;if(!d.fromCache){const p=u.Ms.get(m),v=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(v);u.Ms=u.Ms.insert(m,g)}}}(r.localStore,i))}async function JG(t,e){const n=Se(t);if(!n.currentUser.isEqual(e)){de(wl,"User change. New user:",e.toKey());const r=await PL(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new ie(z.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ho(n,r.Ls)}}function XG(t,e){const n=Se(t),r=n.Au.get(e);if(r&&r.hu)return At().add(r.key);{let s=At();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}async function ZG(t,e){const n=Se(t),r=await ry(n.localStore,e.query,!0),s=e.view.cu(r);return n.isPrimaryClient&&nb(n,e.targetId,s.au),s}async function eQ(t,e){const n=Se(t);return kL(n.localStore,e).then(r=>Ho(n,r))}async function tQ(t,e,n,r){const s=Se(t),i=await function(a,l){const c=Se(a),u=Se(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>u.er(d,l).next(m=>m?c.localDocuments.getDocuments(d,m):$.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await Bd(s.remoteStore):n==="acknowledged"||n==="rejected"?(LS(s,e,r||null),OS(s,e),function(a,l){Se(Se(a).mutationQueue).ir(l)}(s.localStore,e)):Le(6720,"Unknown batchState",{Su:n}),await Ho(s,i)):de(wl,"Cannot apply mutation batch with id: "+e)}async function nQ(t,e){const n=Se(t);if(Sv(n),VS(n),e===!0&&n.gu!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await F1(n,r.toArray());n.gu=!0,await eb(n.remoteStore,!0);for(const i of s)Ev(n.remoteStore,i)}else if(e===!1&&n.gu!==!1){const r=[];let s=Promise.resolve();n.Iu.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(yd(n,o),pd(n.localStore,o,!0))),gd(n.remoteStore,o)}),await s,await F1(n,r),function(o){const a=Se(o);a.Au.forEach((l,c)=>{gd(a.remoteStore,c)}),a.Ru.Jr(),a.Au=new Map,a.du=new An(_e.comparator)}(n),n.gu=!1,await eb(n.remoteStore,!1)}}async function F1(t,e,n){const r=Se(t),s=[],i=[];for(const o of e){let a;const l=r.Iu.get(o);if(l&&l.length!==0){a=await md(r.localStore,Xr(l[0]));for(const c of l){const u=r.Tu.get(c),d=await ZG(r,u);d.snapshot&&i.push(d.snapshot)}}else{const c=await NL(r.localStore,o);a=await md(r.localStore,c),await DS(r,ZL(c),o,!1,a.resumeToken)}s.push(a)}return r.Pu.H_(i),s}function ZL(t){return NO(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function rQ(t){return function(n){return Se(Se(n).persistence).Ts()}(Se(t).localStore)}async function sQ(t,e,n,r){const s=Se(t);if(s.gu)return void de(wl,"Ignoring unexpected query state notification.");const i=s.Iu.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await kL(s.localStore,LO(i[0])),a=fm.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Gn.EMPTY_BYTE_STRING);await Ho(s,o,a);break}case"rejected":await pd(s.localStore,e,!0),yd(s,e,r);break;default:Le(64155,n)}}async function iQ(t,e,n){const r=Sv(t);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){de(wl,"Adding an already active target "+s);continue}const i=await NL(r.localStore,s),o=await md(r.localStore,i);await DS(r,ZL(i),o.targetId,!1,o.resumeToken),Ev(r.remoteStore,o)}for(const s of n)r.Iu.has(s)&&await pd(r.localStore,s,!1).then(()=>{gd(r.remoteStore,s),yd(r,s)}).catch(pl)}}function Sv(t){const e=Se(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=JL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=XG.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=HG.bind(null,e),e.Pu.H_=MG.bind(null,e.eventManager),e.Pu.yu=VG.bind(null,e.eventManager),e}function VS(t){const e=Se(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=KG.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=GG.bind(null,e),e}function oQ(t,e,n){const r=Se(t);(async function(i,o,a){try{const l=await o.getMetadata();if(await function(p,v){const g=Se(p),E=lr(v.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",b=>g.Ii.getBundleMetadata(b,v.id)).then(b=>!!b&&b.createTime.compareTo(E)>=0)}(i.localStore,l))return await o.close(),a._completeWith(function(p){return{taskState:"Success",documentsLoaded:p.totalDocuments,bytesLoaded:p.totalBytes,totalDocuments:p.totalDocuments,totalBytes:p.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(HL(l));const c=new kS(l,o.serializer);let u=await o.bu();for(;u;){const m=await c.Ga(u);m&&a._updateProgress(m),u=await o.bu()}const d=await c.ja(i.localStore);return await Ho(i,d.Ha,void 0),await function(p,v){const g=Se(p);return g.persistence.runTransaction("Save bundle","readwrite",E=>g.Ii.saveBundleMetadata(E,v))}(i.localStore,l),a._completeWith(d.progress),Promise.resolve(d.Ja)}catch(l){return Fs(wl,`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,n).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class vd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Dc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return AL(this.persistence,new xL,e.initialUser,this.serializer)}Cu(e){return new yS(bv.mi,this.serializer)}Du(e){return new VL}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vd.provider={build:()=>new vd};class jS extends vd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Je(this.persistence.referenceDelegate instanceof ny,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new _L(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Qr.withCacheSize(this.cacheSizeBytes):Qr.DEFAULT;return new yS(r=>ny.mi(r,n),this.serializer)}}class FS extends vd{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await VS(this.xu.syncEngine),await Bd(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return AL(this.persistence,new xL,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new _L(r,e.asyncQueue,n)}Mu(e,n){const r=new _H(n,this.persistence);return new wH(e.asyncQueue,r)}Cu(e){const n=wS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Qr.withCacheSize(this.cacheSizeBytes):Qr.DEFAULT;return new vS(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,jL(),Qp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new VL}}class eM extends FS{constructor(e,n){super(e,n,!1),this.xu=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xu.syncEngine;this.sharedClientState instanceof Ww&&(this.sharedClientState.syncEngine={Co:tQ.bind(null,n),vo:sQ.bind(null,n),Fo:iQ.bind(null,n),Ts:rQ.bind(null,n),Do:eQ.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Ji(async r=>{await nQ(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Du(e){const n=jL();if(!Ww.v(n))throw new ie(z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=wS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ww(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class sl{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>j1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=JG.bind(null,this.syncEngine),await eb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new LG}()}createDatastore(e){const n=Dc(e.databaseInfo.databaseId),r=function(i){return new yG(i)}(e.databaseInfo);return function(i,o,a,l){return new bG(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new SG(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>j1(this.syncEngine,n,0),function(){return N1.v()?new N1:new fG}())}createSyncEngine(e,n){return function(s,i,o,a,l,c,u){const d=new UG(s,i,o,a,l,c);return u&&(d.gu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Se(s);de(bc,"RemoteStore shutting down."),i.Ea.add(5),await $d(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}sl.provider={build:()=>new sl};function U1(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):or("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aQ{constructor(e,n){this.Bu=e,this.serializer=n,this.metadata=new Cr,this.buffer=new Uint8Array,this.Lu=function(){return new TextDecoder("utf-8")}(),this.ku().then(r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Qa)}`))},r=>this.metadata.reject(r))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const n=this.Lu.decode(e),r=Number(n);isNaN(r)&&this.Qu(`length string (${n}) is not valid number`);const s=await this.$u(r);return new qL(JSON.parse(s),e.length+r)}Uu(){return this.buffer.findIndex(e=>e===123)}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const n=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lQ{constructor(e,n){this.bundleData=e,this.serializer=n,this.cursor=0,this.elements=[];let r=this.bu();if(!r||!r.$a())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r==null?void 0:r.Qa)}`);this.metadata=r;do r=this.bu(),r!==null&&this.elements.push(r);while(r!==null)}getMetadata(){return this.metadata}Wu(){return this.elements}bu(){if(this.cursor===this.bundleData.length)return null;const e=this.qu(),n=this.$u(e);return new qL(JSON.parse(n),e)}$u(e){if(this.cursor+e>this.bundleData.length)throw new ie(z.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}qu(){const e=this.cursor;let n=this.cursor;for(;n<this.bundleData.length;){if(this.bundleData[n]==="{"){if(n===e)throw new Error("First character is a bracket and not a number");return this.cursor=n,Number(this.bundleData.slice(e,n))}n++}throw new Error("Reached the end of bundle when more is expected.")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cQ{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ie(z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,i){const o=Se(s),a={documents:i.map(d=>jf(o.serializer,d))},l=await o.Ho("BatchGetDocuments",o.serializer.databaseId,Ft.emptyPath(),a,i.length),c=new Map;l.forEach(d=>{const m=TK(o.serializer,d);c.set(m.key.toString(),m)});const u=[];return i.forEach(d=>{const m=c.get(d.toString());Je(!!m,55234,{key:d}),u.push(m)}),u}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ud(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=_e.fromPath(r);this.mutations.push(new lS(s,this.precondition(s)))}),await async function(r,s){const i=Se(r),o={writes:s.map(a=>Ff(i.serializer,a))};await i.Go("Commit",i.serializer.databaseId,Ft.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Le(50498,{Gu:e.constructor.name});n=at.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new ie(z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(at.min())?$n.exists(!1):$n.updateTime(n):$n.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(at.min()))throw new ie(z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $n.updateTime(n)}return $n.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uQ{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.zu=r.maxAttempts,this.M_=new SS(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new cQ(this.datastore),n=this.Hu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Yu(s)}))}).catch(r=>{this.Yu(r)})})}Hu(e){try{const n=this.updateFunction(e);return!am(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!QO(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const il="FirestoreClient";class dQ{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Pr.UNAUTHENTICATED,this.clientId=iv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{de(il,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(de(il,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Wd(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Hw(t,e){t.asyncQueue.verifyOperationInProgress(),de(il,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await PL(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $1(t,e){t.asyncQueue.verifyOperationInProgress();const n=await US(t);de(il,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>D1(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>D1(e.remoteStore,s)),t._onlineComponents=e}async function US(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){de(il,"Using user provided OfflineComponentProvider");try{await Hw(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Fs("Error using user provided cache. Falling back to memory cache: "+n),await Hw(t,new vd)}}else de(il,"Using default OfflineComponentProvider"),await Hw(t,new jS(void 0));return t._offlineComponents}async function Tv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(de(il,"Using user provided OnlineComponentProvider"),await $1(t,t._uninitializedComponentsProvider._online)):(de(il,"Using default OnlineComponentProvider"),await $1(t,new sl))),t._onlineComponents}function tM(t){return US(t).then(e=>e.persistence)}function qd(t){return US(t).then(e=>e.localStore)}function nM(t){return Tv(t).then(e=>e.remoteStore)}function $S(t){return Tv(t).then(e=>e.syncEngine)}function rM(t){return Tv(t).then(e=>e.datastore)}async function wd(t){const e=await Tv(t),n=e.eventManager;return n.onListen=$G.bind(null,e.syncEngine),n.onUnlisten=zG.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=BG.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=WG.bind(null,e.syncEngine),n}function hQ(t){return t.asyncQueue.enqueue(async()=>{const e=await tM(t),n=await nM(t);return e.setNetworkEnabled(!0),function(s){const i=Se(s);return i.Ea.delete(0),pm(i)}(n)})}function fQ(t){return t.asyncQueue.enqueue(async()=>{const e=await tM(t),n=await nM(t);return e.setNetworkEnabled(!1),async function(s){const i=Se(s);i.Ea.add(0),await $d(i),i.Ra.set("Offline")}(n)})}function mQ(t,e){const n=new Cr;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(c,u){const d=Se(c);return d.persistence.runTransaction("read document","readonly",m=>d.localDocuments.getDocument(m,u))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new ie(z.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=Wd(a,`Failed to get document '${i} from cache`);o.reject(l)}}(await qd(t),e,n)),n.promise}function sM(t,e,n={}){const r=new Cr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new Iv({next:m=>{u.Nu(),o.enqueueAndForget(()=>RS(i,d));const p=m.docs.has(a);!p&&m.fromCache?c.reject(new ie(z.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?c.reject(new ie(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),d=new NS(jd(a.path),u,{includeMetadataChanges:!0,qa:!0});return PS(i,d)}(await wd(t),t.asyncQueue,e,n,r)),r.promise}function pQ(t,e){const n=new Cr;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await ry(s,i,!0),l=new QL(i,a.Qs),c=l.ru(a.documents),u=l.applyChanges(c,!1);o.resolve(u.snapshot)}catch(a){const l=Wd(a,`Failed to execute query '${i} against cache`);o.reject(l)}}(await qd(t),e,n)),n.promise}function iM(t,e,n={}){const r=new Cr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new Iv({next:m=>{u.Nu(),o.enqueueAndForget(()=>RS(i,d)),m.fromCache&&l.source==="server"?c.reject(new ie(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),d=new NS(a,u,{includeMetadataChanges:!0,qa:!0});return PS(i,d)}(await wd(t),t.asyncQueue,e,n,r)),r.promise}function gQ(t,e,n){const r=new Cr;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await rM(t);r.resolve(async function(o,a,l){var g;const c=Se(o),{request:u,gt:d,parent:m}=oL(c.serializer,kO(a),l);c.connection.$o||delete u.parent;const p=(await c.Ho("RunAggregationQuery",c.serializer.databaseId,m,u,1)).filter(E=>!!E.result);Je(p.length===1,64727);const v=(g=p[0].result)==null?void 0:g.aggregateFields;return Object.keys(v).reduce((E,b)=>(E[d[b]]=v[b],E),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}function yQ(t,e){const n=new Iv(e);return t.asyncQueue.enqueueAndForget(async()=>function(s,i){Se(s).Ca.add(i),i.next()}(await wd(t),n)),()=>{n.Nu(),t.asyncQueue.enqueueAndForget(async()=>function(s,i){Se(s).Ca.delete(i)}(await wd(t),n))}}function vQ(t,e,n,r){const s=function(o,a){let l;return l=typeof o=="string"?JO().encode(o):o,function(u,d){return new aQ(u,d)}(function(u,d){if(u instanceof Uint8Array)return U1(u,d);if(u instanceof ArrayBuffer)return U1(new Uint8Array(u),d);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(n,Dc(e));t.asyncQueue.enqueueAndForget(async()=>{oQ(await $S(t),s,r)})}function wQ(t,e){return t.asyncQueue.enqueue(async()=>function(r,s){const i=Se(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Ii.getNamedQuery(o,s))}(await qd(t),e))}function oM(t,e){return function(r,s){return new lQ(r,s)}(t,e)}function _Q(t,e){return t.asyncQueue.enqueue(async()=>async function(r,s){const i=Se(r),o=i.indexManager,a=[];return i.persistence.runTransaction("Configure indexes","readwrite",l=>o.getFieldIndexes(l).next(c=>function(d,m,p,v,g){d=[...d],m=[...m],d.sort(p),m.sort(p);const E=d.length,b=m.length;let _=0,S=0;for(;_<b&&S<E;){const P=p(d[S],m[_]);P<0?g(d[S++]):P>0?v(m[_++]):(_++,S++)}for(;_<b;)v(m[_++]);for(;S<E;)g(d[S++])}(c,s,pH,u=>{a.push(o.addFieldIndex(l,u))},u=>{a.push(o.deleteFieldIndex(l,u))})).next(()=>$.waitFor(a)))}(await qd(t),e))}function bQ(t,e){return t.asyncQueue.enqueue(async()=>function(r,s){Se(r).Fs.Vs=s}(await qd(t),e))}function EQ(t){return t.asyncQueue.enqueue(async()=>function(n){const r=Se(n),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",i=>s.deleteAllFieldIndexes(i))}(await qd(t)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aM(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM="firestore.googleapis.com",z1=!0;class W1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ie(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=lM,this.ssl=z1}else this.host=e.host,this.ssl=e.ssl??z1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=pL;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<wL)throw new ie(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}G2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=aM(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ie(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ie(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ie(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gm{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new W1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ie(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ie(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new W1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new H2;switch(r.type){case"firstParty":return new lH(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ie(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=B1.get(n);r&&(de("ComponentProvider","Removing Datastore"),B1.delete(n),r.terminate())}(this),Promise.resolve()}}function cM(t,e,n,r={}){var c;t=Ut(t,gm);const s=Ti(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(tm(`https://${a}`),Zy("Firestore",!0)),i.host!==lM&&i.host!==a&&Fs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!wi(l,o)&&(t._setSettings(l),r.mockUserToken)){let u,d;if(typeof r.mockUserToken=="string")u=r.mockUserToken,d=Pr.MOCK_USER;else{u=jD(r.mockUserToken,(c=t._app)==null?void 0:c.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new ie(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Pr(m)}t._authCredentials=new iH(new q2(u,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new br(this.firestore,e,this._query)}}class mn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mn(this.firestore,e,this._key)}toJSON(){return{type:mn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(kc(n,mn._jsonSchema))return new mn(e,r||null,new _e(Ft.fromString(n.referencePath)))}}mn._jsonSchemaVersion="firestore/documentReference/1.0",mn._jsonSchema={type:fr("string",mn._jsonSchemaVersion),referencePath:fr("string")};class mi extends br{constructor(e,n,r){super(e,n,jd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new mn(this.firestore,null,new _e(e))}withConverter(e){return new mi(this.firestore,e,this._path)}}function Ae(t,e,...n){if(t=Dt(t),QE("collection","path",e),t instanceof gm){const r=Ft.fromString(e,...n);return kA(r),new mi(t,null,r)}{if(!(t instanceof mn||t instanceof mi))throw new ie(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ft.fromString(e,...n));return kA(r),new mi(t.firestore,null,r)}}function SQ(t,e){if(t=Ut(t,gm),QE("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ie(z.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new br(t,null,function(r){return new zo(Ft.emptyPath(),r)}(e))}function ye(t,e,...n){if(t=Dt(t),arguments.length===1&&(e=iv.newId()),QE("doc","path",e),t instanceof gm){const r=Ft.fromString(e,...n);return NA(r),new mn(t,null,new _e(r))}{if(!(t instanceof mn||t instanceof mi))throw new ie(z.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ft.fromString(e,...n));return NA(r),new mn(t.firestore,t instanceof mi?t.converter:null,new _e(r))}}function IQ(t,e){return t=Dt(t),e=Dt(e),(t instanceof mn||t instanceof mi)&&(e instanceof mn||e instanceof mi)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function BS(t,e){return t=Dt(t),e=Dt(e),t instanceof br&&e instanceof br&&t.firestore===e.firestore&&um(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1="AsyncQueue";class H1{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new SS(this,"async_queue_retry"),this._c=()=>{const r=Qp();r&&de(q1,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Qp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Qp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Cr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!gl(e))throw e;de(q1,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,or("INTERNAL UNHANDLED ERROR: ",K1(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=AS.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&Le(47125,{Pc:K1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function K1(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class uM{constructor(){this._progressObserver={},this._taskCompletionResolver=new Cr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TQ=-1;class vn extends gm{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new H1,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new H1(e),this._firestoreClient=void 0,await e}}}function dM(t,e,n){n||(n=Of);const r=Rc(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(wi(i,e))return s;throw new ie(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ie(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<wL)throw new ie(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Ti(e.host)&&tm(e.host),r.initialize({options:e,instanceIdentifier:n})}function xQ(t,e){const n=typeof t=="object"?t:tv(),r=typeof t=="string"?t:e||Of,s=Rc(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=LE("firestore");i&&cM(s,...i)}return s}function Bn(t){if(t._terminated)throw new ie(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||hM(t),t._firestoreClient}function hM(t){var r,s,i;const e=t._freezeSettings(),n=function(a,l,c,u){return new QH(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,aM(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new dQ(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function AQ(t,e){Fs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return fM(t,sl.provider,{build:r=>new FS(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function PQ(t){Fs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();fM(t,sl.provider,{build:n=>new eM(n,e.cacheSizeBytes)})}function fM(t,e,n){if((t=Ut(t,vn))._firestoreClient||t._terminated)throw new ie(z.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new ie(z.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},hM(t)}function RQ(t){if(t._initialized&&!t._terminated)throw new ie(z.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Cr;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Xi.v())return Promise.resolve();const s=r+TL;await Xi.delete(s)}(wS(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function CQ(t){return function(n){const r=new Cr;return n.asyncQueue.enqueueAndForget(async()=>QG(await $S(n),r)),r.promise}(Bn(t=Ut(t,vn)))}function zS(t){return hQ(Bn(t=Ut(t,vn)))}function WS(t){return fQ(Bn(t=Ut(t,vn)))}function NQ(t){return e8(t.app,"firestore",t._databaseId.database),t._delete()}function rb(t,e){const n=Bn(t=Ut(t,vn)),r=new uM;return vQ(n,t._databaseId,e,r),r}function mM(t,e){return wQ(Bn(t=Ut(t,vn)),e).then(n=>n?new br(t,null,n.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class pM{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ms(Gn.fromBase64String(e))}catch(n){throw new ie(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ms(Gn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ms._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(kc(e,ms._jsonSchema))return ms.fromBase64String(e.bytes)}}ms._jsonSchemaVersion="firestore/bytes/1.0",ms._jsonSchema={type:fr("string",ms._jsonSchemaVersion),bytes:fr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ie(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new On(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function kQ(){return new _l(D0)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ie(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ie(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return gt(this._lat,e._lat)||gt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:pi._jsonSchemaVersion}}static fromJSON(e){if(kc(e,pi._jsonSchema))return new pi(e.latitude,e.longitude)}}pi._jsonSchemaVersion="firestore/geoPoint/1.0",pi._jsonSchema={type:fr("string",pi._jsonSchemaVersion),latitude:fr("number"),longitude:fr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Ys._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(kc(e,Ys._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Ys(e.vectorValues);throw new ie(z.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ys._jsonSchemaVersion="firestore/vectorValue/1.0",Ys._jsonSchema={type:fr("string",Ys._jsonSchemaVersion),vectorValues:fr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DQ=/^__.*__$/;class OQ{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new qo(e,this.data,this.fieldMask,n,this.fieldTransforms):new Fd(e,this.data,n,this.fieldTransforms)}}class gM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new qo(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function yM(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le(40011,{Ac:t})}}class xv{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new xv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ay(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(yM(this.Ac)&&DQ.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class LQ{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Dc(e)}Cc(e,n,r,s=!1){return new xv({Ac:e,methodName:n,Dc:r,path:On.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Oc(t){const e=t._freezeSettings(),n=Dc(t._databaseId);return new LQ(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Av(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);JS("Data must be an object, but it was:",o,r);const a=_M(r,o);let l,c;if(i.merge)l=new ys(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const d of i.mergeFields){const m=Uf(e,d,n);if(!o.contains(m))throw new ie(z.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);EM(u,m)||u.push(m)}l=new ys(u),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new OQ(new Fr(a),l,c)}class ym extends bl{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ym}}function vM(t,e,n){return new xv({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class qS extends bl{_toFieldTransform(e){return new hm(e.path,new dd)}isEqual(e){return e instanceof qS}}class HS extends bl{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=vM(this,e,!0),r=this.vc.map(i=>Lc(i,n)),s=new gc(r);return new hm(e.path,s)}isEqual(e){return e instanceof HS&&wi(this.vc,e.vc)}}class KS extends bl{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=vM(this,e,!0),r=this.vc.map(i=>Lc(i,n)),s=new yc(r);return new hm(e.path,s)}isEqual(e){return e instanceof KS&&wi(this.vc,e.vc)}}class GS extends bl{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new hd(e.serializer,$O(e.serializer,this.Fc));return new hm(e.path,n)}isEqual(e){return e instanceof GS&&this.Fc===e.Fc}}function QS(t,e,n,r){const s=t.Cc(1,e,n);JS("Data must be an object, but it was:",s,r);const i=[],o=Fr.empty();yl(r,(l,c)=>{const u=Pv(e,l,n);c=Dt(c);const d=s.yc(u);if(c instanceof ym)i.push(u);else{const m=Lc(c,d);m!=null&&(i.push(u),o.set(u,m))}});const a=new ys(i);return new gM(o,a,s.fieldTransforms)}function YS(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[Uf(e,r,n)],l=[s];if(i.length%2!=0)throw new ie(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(Uf(e,i[m])),l.push(i[m+1]);const c=[],u=Fr.empty();for(let m=a.length-1;m>=0;--m)if(!EM(c,a[m])){const p=a[m];let v=l[m];v=Dt(v);const g=o.yc(p);if(v instanceof ym)c.push(p);else{const E=Lc(v,g);E!=null&&(c.push(p),u.set(p,E))}}const d=new ys(c);return new gM(u,d,o.fieldTransforms)}function wM(t,e,n,r=!1){return Lc(n,t.Cc(r?4:3,e))}function Lc(t,e){if(bM(t=Dt(t)))return JS("Unsupported field value:",e,t),_M(t,e);if(t instanceof bl)return function(r,s){if(!yM(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Lc(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Dt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return $O(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=sn.fromDate(r);return{timestampValue:fd(s.serializer,i)}}if(r instanceof sn){const i=new sn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:fd(s.serializer,i)}}if(r instanceof pi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ms)return{bytesValue:eL(s.serializer,r._byteString)};if(r instanceof mn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:fS(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Ys)return function(o,a){return{mapValue:{fields:{[nS]:{stringValue:rS},[ld]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return aS(a.serializer,c)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${ov(r)}`)}(t,e)}function _M(t,e){const n={};return mO(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yl(t,(r,s)=>{const i=Lc(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function bM(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof sn||t instanceof pi||t instanceof ms||t instanceof mn||t instanceof bl||t instanceof Ys)}function JS(t,e,n){if(!bM(n)||!Q2(n)){const r=ov(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Uf(t,e,n){if((e=Dt(e))instanceof _l)return e._internalPath;if(typeof e=="string")return Pv(t,e);throw ay("Field path arguments must be of type string or ",t,!1,void 0,n)}const MQ=new RegExp("[~\\*/\\[\\]]");function Pv(t,e,n){if(e.search(MQ)>=0)throw ay(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new _l(...e.split("."))._internalPath}catch{throw ay(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function ay(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new ie(z.INVALID_ARGUMENT,a+t+l)}function EM(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new mn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new VQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Rv("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class VQ extends $f{data(){return super.data()}}function Rv(t,e){return typeof e=="string"?Pv(t,e):e instanceof _l?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SM(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ie(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class XS{}class Hd extends XS{}function Ye(t,e,...n){let r=[];e instanceof XS&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof Mc).length,a=i.filter(l=>l instanceof Kd).length;if(o>1||o>0&&a>0)throw new ie(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Kd extends Hd{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Kd(e,n,r)}_apply(e){const n=this._parse(e);return TM(e._query,n),new br(e.firestore,e.converter,W0(e._query,n))}_parse(e){const n=Oc(e.firestore);return function(i,o,a,l,c,u,d){let m;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new ie(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Q1(d,u);const v=[];for(const g of d)v.push(G1(l,i,g));m={arrayValue:{values:v}}}else m=G1(l,i,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Q1(d,u),m=wM(a,o,d,u==="in"||u==="not-in");return Ht.create(c,u,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ne(t,e,n){const r=e,s=Rv("where",t);return Kd._create(s,r,n)}class Mc extends XS{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Mc(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:fn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)TM(o,l),o=W0(o,l)}(e._query,n),new br(e.firestore,e.converter,W0(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function jQ(...t){return t.forEach(e=>xM("or",e)),Mc._create("or",t)}function FQ(...t){return t.forEach(e=>xM("and",e)),Mc._create("and",t)}class Cv extends Hd{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Cv(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new ie(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ie(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Vf(i,o)}(e._query,this._field,this._direction);return new br(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new zo(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Gs(t,e="asc"){const n=e,r=Rv("orderBy",t);return Cv._create(r,n)}class vm extends Hd{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new vm(e,n,r)}_apply(e){return new br(e.firestore,e.converter,Xg(e._query,this._limit,this._limitType))}}function Uo(t){return Y2("limit",t),vm._create("limit",t,"F")}function UQ(t){return Y2("limitToLast",t),vm._create("limitToLast",t,"L")}class wm extends Hd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new wm(e,n,r)}_apply(e){const n=IM(e,this.type,this._docOrFields,this._inclusive);return new br(e.firestore,e.converter,function(s,i){return new zo(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function $Q(...t){return wm._create("startAt",t,!0)}function BQ(...t){return wm._create("startAfter",t,!1)}class _m extends Hd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new _m(e,n,r)}_apply(e){const n=IM(e,this.type,this._docOrFields,this._inclusive);return new br(e.firestore,e.converter,function(s,i){return new zo(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function zQ(...t){return _m._create("endBefore",t,!1)}function WQ(...t){return _m._create("endAt",t,!0)}function IM(t,e,n,r){if(n[0]=Dt(n[0]),n[0]instanceof $f)return function(i,o,a,l,c){if(!l)throw new ie(z.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const u=[];for(const d of Nu(i))if(d.field.isKeyField())u.push(mc(o,l.key));else{const m=l.data.field(d.field);if(dv(m))throw new ie(z.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const p=d.field.canonicalString();throw new ie(z.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${p}' (used as the orderBy) does not exist.`)}u.push(m)}return new nl(u,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=Oc(t.firestore);return function(o,a,l,c,u,d){const m=o.explicitOrderBy;if(u.length>m.length)throw new ie(z.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const p=[];for(let v=0;v<u.length;v++){const g=u[v];if(m[v].field.isKeyField()){if(typeof g!="string")throw new ie(z.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!iS(o)&&g.indexOf("/")!==-1)throw new ie(z.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);const E=o.path.child(Ft.fromString(g));if(!_e.isDocumentKey(E))throw new ie(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${E}' is not because it contains an odd number of segments.`);const b=new _e(E);p.push(mc(a,b))}else{const E=wM(l,c,g);p.push(E)}}return new nl(p,d)}(t._query,t.firestore._databaseId,s,e,n,r)}}function G1(t,e,n){if(typeof(n=Dt(n))=="string"){if(n==="")throw new ie(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!iS(e)&&n.indexOf("/")!==-1)throw new ie(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ft.fromString(n));if(!_e.isDocumentKey(r))throw new ie(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return mc(t,new _e(r))}if(n instanceof mn)return mc(t,n._key);throw new ie(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ov(n)}.`)}function Q1(t,e){if(!Array.isArray(t)||t.length===0)throw new ie(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function TM(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ie(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ie(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function xM(t,e){if(!(e instanceof Kd||e instanceof Mc))throw new ie(z.INVALID_ARGUMENT,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class ZS{convertValue(e,n="none"){switch(el(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Fn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Fo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Le(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return yl(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[ld].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Fn(o.doubleValue));return new Ys(n)}convertGeoPoint(e){return new pi(Fn(e.latitude),Fn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=hv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Df(e));default:return null}}convertTimestamp(e){const n=jo(e);return new sn(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ft.fromString(e);Je(uL(r),9688,{name:e});const s=new Za(r.get(1),r.get(3)),i=new _e(r.popFirst(5));return s.isEqual(n)||or(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class eI extends ZS{constructor(e){super(),this.firestore=e}convertBytes(e){return new ms(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new mn(this.firestore,null,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qQ(t){return new _d("sum",Uf("sum",t))}function HQ(t){return new _d("avg",Uf("average",t))}function AM(){return new _d("count")}function KQ(t,e){var n,r;return t instanceof _d&&e instanceof _d&&t.aggregateType===e.aggregateType&&((n=t._internalFieldPath)==null?void 0:n.canonicalString())===((r=e._internalFieldPath)==null?void 0:r.canonicalString())}function GQ(t,e){return BS(t.query,e.query)&&wi(t.data(),e.data())}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PM="NOT SUPPORTED";class Io{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ss extends $f{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Zh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Rv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(z.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ss._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}function QQ(t,e,n){if(kc(e,Ss._jsonSchema)){if(e.bundle===PM)throw new ie(z.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=Dc(t._databaseId),s=oM(e.bundle,r),i=s.Wu(),o=new kS(s.getMetadata(),r);for(const u of i)o.Ga(u);const a=o.documents;if(a.length!==1)throw new ie(z.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${a.length} documents.`);const l=gv(r,a[0].document),c=new _e(Ft.fromString(e.bundleName));return new Ss(t,new eI(t),c,l,new Io(!1,!1),n||null)}}Ss._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ss._jsonSchema={type:fr("string",Ss._jsonSchemaVersion),bundleSource:fr("string","DocumentSnapshot"),bundleName:fr("string"),bundle:fr("string")};class Zh extends Ss{data(e={}){return super.data(e)}}class Is{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Io(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Zh(this._firestore,this._userDataWriter,r.key,r,new Io(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ie(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Zh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Io(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Zh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Io(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:JQ(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ie(z.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Is._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=iv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function YQ(t,e,n){if(kc(e,Is._jsonSchema)){if(e.bundle===PM)throw new ie(z.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=Dc(t._databaseId),s=oM(e.bundle,r),i=s.Wu(),o=new kS(s.getMetadata(),r);for(const m of i)o.Ga(m);if(o.queries.length!==1)throw new ie(z.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);const a=vv(o.queries[0].bundledQuery),l=o.documents;let c=new rc;l.map(m=>{const p=gv(r,m.document);c=c.add(p)});const u=Ec.fromInitialDocuments(a,c,At(),!1,!1),d=new br(t,n||null,a);return new Is(t,new eI(t),d,u)}}function JQ(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le(61501,{type:t})}}function XQ(t,e){return t instanceof Ss&&e instanceof Ss?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Is&&e instanceof Is&&t._firestore===e._firestore&&BS(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(t){t=Ut(t,mn);const e=Ut(t.firestore,vn);return sM(Bn(e),t._key).then(n=>tI(e,t,n))}Is._jsonSchemaVersion="firestore/querySnapshot/1.0",Is._jsonSchema={type:fr("string",Is._jsonSchemaVersion),bundleSource:fr("string","QuerySnapshot"),bundleName:fr("string"),bundle:fr("string")};class El extends ZS{constructor(e){super(),this.firestore=e}convertBytes(e){return new ms(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new mn(this.firestore,null,n)}}function ZQ(t){t=Ut(t,mn);const e=Ut(t.firestore,vn),n=Bn(e),r=new El(e);return mQ(n,t._key).then(s=>new Ss(e,r,t._key,s,new Io(s!==null&&s.hasLocalMutations,!0),t.converter))}function eY(t){t=Ut(t,mn);const e=Ut(t.firestore,vn);return sM(Bn(e),t._key,{source:"server"}).then(n=>tI(e,t,n))}function Ze(t){t=Ut(t,br);const e=Ut(t.firestore,vn),n=Bn(e),r=new El(e);return SM(t._query),iM(n,t._query).then(s=>new Is(e,r,t,s))}function tY(t){t=Ut(t,br);const e=Ut(t.firestore,vn),n=Bn(e),r=new El(e);return pQ(n,t._query).then(s=>new Is(e,r,t,s))}function nY(t){t=Ut(t,br);const e=Ut(t.firestore,vn),n=Bn(e),r=new El(e);return iM(n,t._query,{source:"server"}).then(s=>new Is(e,r,t,s))}function rn(t,e,n){t=Ut(t,mn);const r=Ut(t.firestore,vn),s=Nv(t.converter,e,n);return Gd(r,[Av(Oc(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,$n.none())])}function xn(t,e,n,...r){t=Ut(t,mn);const s=Ut(t.firestore,vn),i=Oc(s);let o;return o=typeof(e=Dt(e))=="string"||e instanceof _l?YS(i,"updateDoc",t._key,e,n,r):QS(i,"updateDoc",t._key,e),Gd(s,[o.toMutation(t._key,$n.exists(!0))])}function Wn(t){return Gd(Ut(t.firestore,vn),[new Ud(t._key,$n.none())])}function Vs(t,e){const n=Ut(t.firestore,vn),r=ye(t),s=Nv(t.converter,e);return Gd(n,[Av(Oc(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,$n.exists(!1))]).then(()=>r)}function $o(t,...e){var l,c,u;t=Dt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||ku(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(ku(e[r])){const d=e[r];e[r]=(l=d.next)==null?void 0:l.bind(d),e[r+1]=(c=d.error)==null?void 0:c.bind(d),e[r+2]=(u=d.complete)==null?void 0:u.bind(d)}let i,o,a;if(t instanceof mn)o=Ut(t.firestore,vn),a=jd(t._key.path),i={next:d=>{e[r]&&e[r](tI(o,t,d))},error:e[r+1],complete:e[r+2]};else{const d=Ut(t,br);o=Ut(d.firestore,vn),a=d._query;const m=new El(o);i={next:p=>{e[r]&&e[r](new Is(o,m,d,p))},error:e[r+1],complete:e[r+2]},SM(t._query)}return function(m,p,v,g){const E=new Iv(g),b=new NS(p,E,v);return m.asyncQueue.enqueueAndForget(async()=>PS(await wd(m),b)),()=>{E.Nu(),m.asyncQueue.enqueueAndForget(async()=>RS(await wd(m),b))}}(Bn(o),a,s,i)}function rY(t,e,...n){const r=Dt(t),s=function(l){const c={bundle:"",bundleName:"",bundleSource:""},u=["bundle","bundleName","bundleSource"];for(const d of u){if(!(d in l)){c.error=`snapshotJson missing required field: ${d}`;break}const m=l[d];if(typeof m!="string"){c.error=`snapshotJson field '${d}' must be a string.`;break}if(m.length===0){c.error=`snapshotJson field '${d}' cannot be an empty string.`;break}d==="bundle"?c.bundle=m:d==="bundleName"?c.bundleName=m:d==="bundleSource"&&(c.bundleSource=m)}return c}(e);if(s.error)throw new ie(z.INVALID_ARGUMENT,s.error);let i,o=0;if(typeof n[o]!="object"||ku(n[o])||(i=n[o++]),s.bundleSource==="QuerySnapshot"){let a=null;if(typeof n[o]=="object"&&ku(n[o])){const l=n[o++];a={next:l.next,error:l.error,complete:l.complete}}else a={next:n[o++],error:n[o++],complete:n[o++]};return function(c,u,d,m,p){let v,g=!1;return rb(c,u.bundle).then(()=>mM(c,u.bundleName)).then(b=>{b&&!g&&(p&&b.withConverter(p),v=$o(b,d||{},m))}).catch(b=>(m.error&&m.error(b),()=>{})),()=>{g||(g=!0,v&&v())}}(r,s,i,a,n[o])}if(s.bundleSource==="DocumentSnapshot"){let a=null;if(typeof n[o]=="object"&&ku(n[o])){const l=n[o++];a={next:l.next,error:l.error,complete:l.complete}}else a={next:n[o++],error:n[o++],complete:n[o++]};return function(c,u,d,m,p){let v,g=!1;return rb(c,u.bundle).then(()=>{if(!g){const b=new mn(c,p||null,_e.fromPath(u.bundleName));v=$o(b,d||{},m)}}).catch(b=>(m.error&&m.error(b),()=>{})),()=>{g||(g=!0,v&&v())}}(r,s,i,a,n[o])}throw new ie(z.INVALID_ARGUMENT,`unsupported bundle source: ${s.bundleSource}`)}function sY(t,e){return yQ(Bn(t=Ut(t,vn)),ku(e)?e:{next:e})}function Gd(t,e){return function(r,s){const i=new Cr;return r.asyncQueue.enqueueAndForget(async()=>qG(await $S(r),s,i)),i.promise}(Bn(t),e)}function tI(t,e,n){const r=n.docs.get(e._key),s=new El(t);return new Ss(t,s,e._key,r,new Io(n.hasPendingWrites,n.fromCache),e.converter)}function RM(t){return CM(t,{count:AM()})}function CM(t,e){const n=Ut(t.firestore,vn),r=Bn(n),s=fO(e,(i,o)=>new GO(o,i.aggregateType,i._internalFieldPath));return gQ(r,t._query,s).then(i=>function(a,l,c){const u=new El(a);return new pM(l,u,c)}(n,t,i))}class iY{constructor(e){this.kind="memory",this._onlineComponentProvider=sl.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new jS(void 0)}}toJSON(){return{kind:this.kind}}}class oY{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=NM(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class aY{constructor(){this.kind="memoryEager",this._offlineComponentProvider=vd.provider}toJSON(){return{kind:this.kind}}}class lY{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new jS(e)}}toJSON(){return{kind:this.kind}}}function cY(){return new aY}function uY(t){return new lY(t==null?void 0:t.cacheSizeBytes)}function dY(t){return new iY(t)}function hY(t){return new oY(t)}class fY{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=sl.provider,this._offlineComponentProvider={build:n=>new FS(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class mY{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=sl.provider,this._offlineComponentProvider={build:n=>new eM(n,e==null?void 0:e.cacheSizeBytes)}}}function NM(t){return new fY(t==null?void 0:t.forceOwnership)}function pY(){return new mY}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gY={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Oc(e)}set(e,n,r){this._verifyNotCommitted();const s=Na(e,this._firestore),i=Nv(s.converter,n,r),o=Av(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,$n.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Na(e,this._firestore);let o;return o=typeof(n=Dt(n))=="string"||n instanceof _l?YS(this._dataReader,"WriteBatch.update",i._key,n,r,s):QS(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,$n.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Na(e,this._firestore);return this._mutations=this._mutations.concat(new Ud(n._key,$n.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ie(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Na(t,e){if((t=Dt(t)).firestore!==e)throw new ie(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yY{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Oc(e)}get(e){const n=Na(e,this._firestore),r=new eI(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return Le(24041);const i=s[0];if(i.isFoundDocument())return new $f(this._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new $f(this._firestore,r,n._key,null,n.converter);throw Le(18433,{doc:i})})}set(e,n,r){const s=Na(e,this._firestore),i=Nv(s.converter,n,r),o=Av(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,n,r,...s){const i=Na(e,this._firestore);let o;return o=typeof(n=Dt(n))=="string"||n instanceof _l?YS(this._dataReader,"Transaction.update",i._key,n,r,s):QS(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=Na(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM extends yY{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Na(e,this._firestore),r=new El(this._firestore);return super.get(e).then(s=>new Ss(this._firestore,r,n._key,s._document,new Io(!1,!1),n.converter))}}function vY(t,e,n){t=Ut(t,vn);const r={...gY,...n};return function(i){if(i.maxAttempts<1)throw new ie(z.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const l=new Cr;return i.asyncQueue.enqueueAndForget(async()=>{const c=await rM(i);new uQ(i.asyncQueue,c,a,o,l).ju()}),l.promise}(Bn(t),s=>e(new DM(t,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wY(){return new ym("deleteField")}function $e(){return new qS("serverTimestamp")}function _Y(...t){return new HS("arrayUnion",t)}function bY(...t){return new KS("arrayRemove",t)}function Rh(t){return new GS("increment",t)}function EY(t){return new Ys(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(t){return Bn(t=Ut(t,vn)),new kM(t,e=>Gd(t,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SY(t,e){const n=Bn(t=Ut(t,vn));if(!n._uninitializedComponentsProvider||n._uninitializedComponentsProvider._offline.kind==="memory")return Fs("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(i){const o=typeof i=="string"?function(c){try{return JSON.parse(c)}catch(u){throw new ie(z.INVALID_ARGUMENT,"Failed to parse JSON: "+(u==null?void 0:u.message))}}(i):i,a=[];if(Array.isArray(o.indexes))for(const l of o.indexes){const c=Y1(l,"collectionGroup"),u=[];if(Array.isArray(l.fields))for(const d of l.fields){const m=Pv("setIndexConfiguration",Y1(d,"fieldPath"));d.arrayConfig==="CONTAINS"?u.push(new tc(m,2)):d.order==="ASCENDING"?u.push(new tc(m,0)):d.order==="DESCENDING"&&u.push(new tc(m,1))}a.push(new nd(nd.UNKNOWN_ID,c,u,rd.empty()))}return a}(e);return _Q(n,r)}function Y1(t,e){if(typeof t[e]!="string")throw new ie(z.INVALID_ARGUMENT,"Missing string value for: "+e);return t[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function IY(t){var s;t=Ut(t,vn);const e=J1.get(t);if(e)return e;if(((s=Bn(t)._uninitializedComponentsProvider)==null?void 0:s._offline.kind)!=="persistent")return null;const r=new OM(t);return J1.set(t,r),r}function TY(t){LM(t,!0)}function xY(t){LM(t,!1)}function AY(t){EQ(Bn(t._firestore)).then(e=>de("deleting all persistent cache indexes succeeded")).catch(e=>Fs("deleting all persistent cache indexes failed",e))}function LM(t,e){bQ(Bn(t._firestore),e).then(n=>de(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(n=>Fs(`setting persistent cache index auto creation isEnabled=${e} failed`,n))}const J1=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PY(t){var r;const e=Bn(Ut(t.firestore,vn)),n=(r=e._onlineComponents)==null?void 0:r.datastore.serializer;return n===void 0?null:yv(n,Xr(t._query)).ft}function RY(t,e){var i;const n=fO(e,(o,a)=>new GO(a,o.aggregateType,o._internalFieldPath)),r=Bn(Ut(t.firestore,vn)),s=(i=r._onlineComponents)==null?void 0:i.datastore.serializer;return s===void 0?null:oL(s,kO(t._query),n,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CY{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return nI.instance.onExistenceFilterMismatch(e)}}class nI{constructor(){this.Mc=new Map}static get instance(){return ap||(ap=new nI,function(n){if(Jh)throw new Error("a TestingHooksSpi instance is already set");Jh=n}(ap)),ap}lt(e){this.Mc.forEach(n=>n(e))}onExistenceFilterMismatch(e){const n=Symbol(),r=this.Mc;return r.set(n,e),()=>r.delete(n)}}let ap=null;(function(e,n=!0){(function(s){Vd=s})(Cc),no(new _i("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new vn(new oH(r.getProvider("auth-internal")),new cH(o,r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ie(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Za(c.options.projectId,u)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Ms(RA,CA,e),Ms(RA,CA,"esm2020")})();const kn=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:ZS,AggregateField:_d,AggregateQuerySnapshot:pM,Bytes:ms,CACHE_SIZE_UNLIMITED:TQ,CollectionReference:mi,DocumentReference:mn,DocumentSnapshot:Ss,FieldPath:_l,FieldValue:bl,Firestore:vn,FirestoreError:ie,GeoPoint:pi,LoadBundleTask:uM,PersistentCacheIndexManager:OM,Query:br,QueryCompositeFilterConstraint:Mc,QueryConstraint:Hd,QueryDocumentSnapshot:Zh,QueryEndAtConstraint:_m,QueryFieldFilterConstraint:Kd,QueryLimitConstraint:vm,QueryOrderByConstraint:Cv,QuerySnapshot:Is,QueryStartAtConstraint:wm,SnapshotMetadata:Io,Timestamp:sn,Transaction:DM,VectorValue:Ys,WriteBatch:kM,_AutoId:iv,_ByteString:Gn,_DatabaseId:Za,_DocumentKey:_e,_EmptyAppCheckTokenProvider:uH,_EmptyAuthCredentialsProvider:H2,_FieldPath:On,_TestingHooks:CY,_cast:Ut,_debugAssert:sH,_internalAggregationQueryToProtoRunAggregationQueryRequest:RY,_internalQueryToProtoQueryTarget:PY,_isBase64Available:KH,_logWarn:Fs,_validateIsNotUsedTogether:G2,addDoc:Vs,aggregateFieldEqual:KQ,aggregateQuerySnapshotEqual:GQ,and:FQ,arrayRemove:bY,arrayUnion:_Y,average:HQ,clearIndexedDbPersistence:RQ,collection:Ae,collectionGroup:SQ,connectFirestoreEmulator:cM,count:AM,deleteAllPersistentCacheIndexes:AY,deleteDoc:Wn,deleteField:wY,disableNetwork:WS,disablePersistentCacheIndexAutoCreation:xY,doc:ye,documentId:kQ,documentSnapshotFromJSON:QQ,enableIndexedDbPersistence:AQ,enableMultiTabIndexedDbPersistence:PQ,enableNetwork:zS,enablePersistentCacheIndexAutoCreation:TY,endAt:WQ,endBefore:zQ,ensureFirestoreConfigured:Bn,executeWrite:Gd,getAggregateFromServer:CM,getCountFromServer:RM,getDoc:Sn,getDocFromCache:ZQ,getDocFromServer:eY,getDocs:Ze,getDocsFromCache:tY,getDocsFromServer:nY,getFirestore:xQ,getPersistentCacheIndexManager:IY,increment:Rh,initializeFirestore:dM,limit:Uo,limitToLast:UQ,loadBundle:rb,memoryEagerGarbageCollector:cY,memoryLocalCache:dY,memoryLruGarbageCollector:uY,namedQuery:mM,onSnapshot:$o,onSnapshotResume:rY,onSnapshotsInSync:sY,or:jQ,orderBy:Gs,persistentLocalCache:hY,persistentMultipleTabManager:pY,persistentSingleTabManager:NM,query:Ye,queryEqual:BS,querySnapshotFromJSON:YQ,refEqual:IQ,runTransaction:vY,serverTimestamp:$e,setDoc:rn,setIndexConfiguration:SY,setLogLevel:z2,snapshotEqual:XQ,startAfter:BQ,startAt:$Q,sum:qQ,terminate:NQ,updateDoc:xn,vector:EY,waitForPendingWrites:CQ,where:Ne,writeBatch:kv},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NY="type.googleapis.com/google.protobuf.Int64Value",kY="type.googleapis.com/google.protobuf.UInt64Value";function MM(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function ly(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>ly(e));if(typeof t=="function"||typeof t=="object")return MM(t,e=>ly(e));throw new Error("Data cannot be encoded in JSON: "+t)}function bd(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case NY:case kY:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>bd(e)):typeof t=="function"||typeof t=="object"?MM(t,e=>bd(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X1={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ws extends xi{constructor(e,n,r){super(`${rI}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,ws.prototype)}}function DY(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function cy(t,e){let n=DY(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!X1[o])return new ws("internal","internal");n=X1[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=bd(s))}}catch{}return n==="ok"?null:new ws(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OY{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,fs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sb="us-central1",LY=/^data: (.*?)(?:\n|$)/;function MY(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new ws("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class VY{constructor(e,n,r,s,i=sb,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new OY(e,n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=sb}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function jY(t,e,n){const r=Ti(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(tm(t.emulatorOrigin+"/backends"),Zy("Functions",!0))}function FY(t,e,n){const r=s=>$Y(t,e,s,{});return r.stream=(s,i)=>zY(t,e,s,i),r}function VM(t){return t.emulatorOrigin&&Ti(t.emulatorOrigin)?"include":void 0}async function UY(t,e,n,r,s){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:VM(s)})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}async function jM(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function $Y(t,e,n,r){const s=t._url(e);return BY(t,s,n,r)}async function BY(t,e,n,r){n=ly(n);const s={data:n},i=await jM(t,r),o=r.timeout||7e4,a=MY(o),l=await Promise.race([UY(e,s,i,t.fetchImpl,t),a.promise,t.cancelAllRequests]);if(a.cancel(),!l)throw new ws("cancelled","Firebase Functions instance was deleted.");const c=cy(l.status,l.json);if(c)throw c;if(!l.json)throw new ws("internal","Response is not valid JSON object.");let u=l.json.data;if(typeof u>"u"&&(u=l.json.result),typeof u>"u")throw new ws("internal","Response is missing data field.");return{data:bd(u)}}function zY(t,e,n,r){const s=t._url(e);return WY(t,s,n,r||{})}async function WY(t,e,n,r){var m;n=ly(n);const s={data:n},i=await jM(t,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r==null?void 0:r.signal,credentials:VM(t)})}catch(p){if(p instanceof Error&&p.name==="AbortError"){const g=new ws("cancelled","Request was cancelled.");return{data:Promise.reject(g),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(g)}}}}}}const v=cy(0,null);return{data:Promise.reject(v),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(v)}}}}}}let a,l;const c=new Promise((p,v)=>{a=p,l=v});(m=r==null?void 0:r.signal)==null||m.addEventListener("abort",()=>{const p=new ws("cancelled","Request was cancelled.");l(p)});const u=o.body.getReader(),d=qY(u,a,l,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const p=d.getReader();return{async next(){const{value:v,done:g}=await p.read();return{value:v,done:g}},async return(){return await p.cancel(),{done:!0,value:void 0}}}}},data:c}}function qY(t,e,n,r){const s=(o,a)=>{const l=o.match(LY);if(!l)return;const c=l[1];try{const u=JSON.parse(c);if("result"in u){e(bd(u.result));return}if("message"in u){a.enqueue(bd(u.message));return}if("error"in u){const d=cy(0,u);a.error(d),n(d);return}}catch(u){if(u instanceof ws){a.error(u),n(u);return}}},i=new TextDecoder;return new ReadableStream({start(o){let a="";return l();async function l(){if(r!=null&&r.aborted){const c=new ws("cancelled","Request was cancelled");return o.error(c),n(c),Promise.resolve()}try{const{value:c,done:u}=await t.read();if(u){a.trim()&&s(a.trim(),o),o.close();return}if(r!=null&&r.aborted){const m=new ws("cancelled","Request was cancelled");o.error(m),n(m),await t.cancel();return}a+=i.decode(c,{stream:!0});const d=a.split(`
`);a=d.pop()||"";for(const m of d)m.trim()&&s(m.trim(),o);return l()}catch(c){const u=c instanceof ws?c:cy(0,null);o.error(u),n(u)}}},cancel(){return t.cancel()}})}const Z1="@firebase/functions",eP="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HY="auth-internal",KY="app-check-internal",GY="messaging-internal";function QY(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(HY),o=n.getProvider(GY),a=n.getProvider(KY);return new VY(s,i,o,a,r)};no(new _i(rI,e,"PUBLIC").setMultipleInstances(!0)),Ms(Z1,eP,t),Ms(Z1,eP,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YY(t=tv(),e=sb){const r=Rc(Dt(t),rI).getImmediate({identifier:e}),s=LE("functions");return s&&JY(r,...s),r}function JY(t,e,n){jY(Dt(t),e,n)}function XY(t,e,n){return FY(Dt(t),e)}QY();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FM="firebasestorage.googleapis.com",UM="storageBucket",ZY=2*60*1e3,eJ=10*60*1e3,tJ=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn extends xi{constructor(e,n,r=0){super(Kw(e),`Firebase Storage: ${n} (${Kw(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Qn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Kw(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Mn;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Mn||(Mn={}));function Kw(t){return"storage/"+t}function sI(){const t="An unknown error occurred, please check the error payload for server response.";return new Qn(Mn.UNKNOWN,t)}function nJ(t){return new Qn(Mn.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function rJ(t){return new Qn(Mn.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function sJ(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Qn(Mn.UNAUTHENTICATED,t)}function iJ(){return new Qn(Mn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function oJ(t){return new Qn(Mn.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function $M(){return new Qn(Mn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function BM(){return new Qn(Mn.CANCELED,"User canceled the upload/download.")}function aJ(t){return new Qn(Mn.INVALID_URL,"Invalid URL '"+t+"'.")}function lJ(t){return new Qn(Mn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function cJ(){return new Qn(Mn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+UM+"' property when initializing the app?")}function zM(){return new Qn(Mn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function uJ(){return new Qn(Mn.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function dJ(){return new Qn(Mn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function hJ(t){return new Qn(Mn.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ib(t){return new Qn(Mn.INVALID_ARGUMENT,t)}function WM(){return new Qn(Mn.APP_DELETED,"The Firebase app was deleted.")}function fJ(t){return new Qn(Mn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ef(t,e){return new Qn(Mn.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function gh(t){throw new Qn(Mn.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Ds.makeFromUrl(e,n)}catch{return new Ds(e,"")}if(r.path==="")return r;throw lJ(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(P){P.path_=decodeURIComponent(P.path)}const u="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${d}/${u}/b/${s}/o${m}`,"i"),v={bucket:1,path:3},g=n===FM?"(?:storage.googleapis.com|storage.cloud.google.com)":n,E="([^?#]*)",b=new RegExp(`^https?://${g}/${s}/${E}`,"i"),S=[{regex:a,indices:l,postModify:i},{regex:p,indices:v,postModify:c},{regex:b,indices:{bucket:1,path:2},postModify:c}];for(let P=0;P<S.length;P++){const T=S[P],N=T.regex.exec(e);if(N){const I=N[T.indices.bucket];let A=N[T.indices.path];A||(A=""),r=new Ds(I,A),T.postModify(r);break}}if(r==null)throw aJ(e);return r}}class mJ{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pJ(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...E){c||(c=!0,e.apply(null,E))}function d(E){s=setTimeout(()=>{s=null,t(p,l())},E)}function m(){i&&clearTimeout(i)}function p(E,...b){if(c){m();return}if(E){m(),u.call(null,E,...b);return}if(l()||o){m(),u.call(null,E,...b);return}r<64&&(r*=2);let S;a===1?(a=2,S=0):S=(r+Math.random())*1e3,d(S)}let v=!1;function g(E){v||(v=!0,m(),!c&&(s!==null?(E||(a=2),clearTimeout(s),d(0)):E||(a=1)))}return d(0),i=setTimeout(()=>{o=!0,g(!0)},n),g}function gJ(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yJ(t){return t!==void 0}function vJ(t){return typeof t=="function"}function wJ(t){return typeof t=="object"&&!Array.isArray(t)}function Dv(t){return typeof t=="string"||t instanceof String}function tP(t){return iI()&&t instanceof Blob}function iI(){return typeof Blob<"u"}function nP(t,e,n,r){if(r<e)throw ib(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ib(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bm(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function qM(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var sc;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(sc||(sc={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HM(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _J{constructor(e,n,r,s,i,o,a,l,c,u,d,m=!0,p=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=d,this.retry=m,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,g)=>{this.resolve_=v,this.reject_=g,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new lp(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===sc.NO_ERROR,l=i.getStatus();if(!a||HM(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===sc.ABORT;r(!1,new lp(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new lp(c,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());yJ(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=sI();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?WM():BM();o(l)}else{const l=$M();o(l)}};this.canceled_?n(!1,new lp(!1,null,!0)):this.backoffId_=pJ(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&gJ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class lp{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function bJ(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function EJ(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function SJ(t,e){e&&(t["X-Firebase-GMPID"]=e)}function IJ(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function TJ(t,e,n,r,s,i,o=!0,a=!1){const l=qM(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return SJ(u,e),bJ(u,n),EJ(u,i),IJ(u,r),new _J(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xJ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function AJ(...t){const e=xJ();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(iI())return new Blob(t);throw new Qn(Mn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function PJ(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RJ(t){if(typeof atob>"u")throw hJ("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Gw{constructor(e,n){this.data=e,this.contentType=n||null}}function CJ(t,e){switch(t){case Hi.RAW:return new Gw(KM(e));case Hi.BASE64:case Hi.BASE64URL:return new Gw(GM(t,e));case Hi.DATA_URL:return new Gw(kJ(e),DJ(e))}throw sI()}function KM(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function NJ(t){let e;try{e=decodeURIComponent(t)}catch{throw ef(Hi.DATA_URL,"Malformed data URL.")}return KM(e)}function GM(t,e){switch(t){case Hi.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw ef(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Hi.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw ef(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=RJ(e)}catch(s){throw s.message.includes("polyfill")?s:ef(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class QM{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw ef(Hi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=OJ(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function kJ(t){const e=new QM(t);return e.base64?GM(Hi.BASE64,e.rest):NJ(e.rest)}function DJ(t){return new QM(t).contentType}function OJ(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e,n){let r=0,s="";tP(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(tP(this.data_)){const r=this.data_,s=PJ(r,e,n);return s===null?null:new vo(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new vo(r,!0)}}static getBlob(...e){if(iI()){const n=e.map(r=>r instanceof vo?r.data_:r);return new vo(AJ.apply(null,n))}else{const n=e.map(o=>Dv(o)?CJ(Hi.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new vo(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YM(t){let e;try{e=JSON.parse(t)}catch{return null}return wJ(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LJ(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function MJ(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function JM(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VJ(t,e){return e}class es{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||VJ}}let cp=null;function jJ(t){return!Dv(t)||t.length<2?t:JM(t)}function oI(){if(cp)return cp;const t=[];t.push(new es("bucket")),t.push(new es("generation")),t.push(new es("metageneration")),t.push(new es("name","fullPath",!0));function e(i,o){return jJ(o)}const n=new es("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new es("size");return s.xform=r,t.push(s),t.push(new es("timeCreated")),t.push(new es("updated")),t.push(new es("md5Hash",null,!0)),t.push(new es("cacheControl",null,!0)),t.push(new es("contentDisposition",null,!0)),t.push(new es("contentEncoding",null,!0)),t.push(new es("contentLanguage",null,!0)),t.push(new es("contentType",null,!0)),t.push(new es("metadata","customMetadata",!0)),cp=t,cp}function FJ(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Ds(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function UJ(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return FJ(r,t),r}function XM(t,e,n){const r=YM(e);return r===null?null:UJ(t,r,n)}function $J(t,e,n,r){const s=YM(e);if(s===null||!Dv(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(c=>{const u=t.bucket,d=t.fullPath,m="/b/"+o(u)+"/o/"+o(d),p=bm(m,n,r),v=qM({alt:"media",token:c});return p+v})[0]}function ZM(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class Qd{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Po(t){if(!t)throw sI()}function aI(t,e){function n(r,s){const i=XM(t,s,e);return Po(i!==null),i}return n}function BJ(t,e){function n(r,s){const i=XM(t,s,e);return Po(i!==null),$J(i,s,t.host,t._protocol)}return n}function Em(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=iJ():s=sJ():n.getStatus()===402?s=rJ(t.bucket):n.getStatus()===403?s=oJ(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function eV(t){const e=Em(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=nJ(t.path)),i.serverResponse=s.serverResponse,i}return n}function zJ(t,e,n){const r=e.fullServerUrl(),s=bm(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new Qd(s,i,aI(t,n),o);return a.errorHandler=eV(e),a}function WJ(t,e,n){const r=e.fullServerUrl(),s=bm(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new Qd(s,i,BJ(t,n),o);return a.errorHandler=eV(e),a}function qJ(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function tV(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=qJ(null,e)),r}function nV(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let S="";for(let P=0;P<2;P++)S=S+Math.random().toString().slice(2);return S}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=tV(e,r,s),u=ZM(c,n),d="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,m=`\r
--`+l+"--",p=vo.getBlob(d,r,m);if(p===null)throw zM();const v={name:c.fullPath},g=bm(i,t.host,t._protocol),E="POST",b=t.maxUploadRetryTime,_=new Qd(g,E,aI(t,n),b);return _.urlParams=v,_.headers=o,_.body=p.uploadData(),_.errorHandler=Em(e),_}class uy{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}}function lI(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Po(!1)}return Po(!!n&&(e||["active"]).indexOf(n)!==-1),n}function HJ(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o=tV(e,r,s),a={name:o.fullPath},l=bm(i,t.host,t._protocol),c="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},d=ZM(o,n),m=t.maxUploadRetryTime;function p(g){lI(g);let E;try{E=g.getResponseHeader("X-Goog-Upload-URL")}catch{Po(!1)}return Po(Dv(E)),E}const v=new Qd(l,c,p,m);return v.urlParams=a,v.headers=u,v.body=d,v.errorHandler=Em(e),v}function KJ(t,e,n,r){const s={"X-Goog-Upload-Command":"query"};function i(c){const u=lI(c,["active","final"]);let d=null;try{d=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Po(!1)}d||Po(!1);const m=Number(d);return Po(!isNaN(m)),new uy(m,r.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,l=new Qd(n,o,i,a);return l.headers=s,l.errorHandler=Em(e),l}const rP=256*1024;function GJ(t,e,n,r,s,i,o,a){const l=new uy(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=r.size()),r.size()!==l.total)throw uJ();const c=l.total-l.current;let u=c;s>0&&(u=Math.min(u,s));const d=l.current,m=d+u;let p="";u===0?p="finalize":c===u?p="upload, finalize":p="upload";const v={"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":`${l.current}`},g=r.slice(d,m);if(g===null)throw zM();function E(P,T){const N=lI(P,["active","final"]),I=l.current+u,A=r.size();let R;return N==="final"?R=aI(e,i)(P,T):R=null,new uy(I,A,N==="final",R)}const b="POST",_=e.maxUploadRetryTime,S=new Qd(n,b,E,_);return S.headers=v,S.body=g.uploadData(),S.progressCallback=a||null,S.errorHandler=Em(t),S}const ds={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Qw(t){switch(t){case"running":case"pausing":case"canceling":return ds.RUNNING;case"paused":return ds.PAUSED;case"success":return ds.SUCCESS;case"canceled":return ds.CANCELED;case"error":return ds.ERROR;default:return ds.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QJ{constructor(e,n,r){if(vJ(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class YJ{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=sc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=sc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=sc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw gh("cannot .send() more than once");if(Ti(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw gh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw gh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw gh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw gh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class JJ extends YJ{initXhr(){this.xhr_.responseType="text"}}function jl(){return new JJ}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XJ{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=oI(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(Mn.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const i=this.isExponentialBackoffExpired();if(HM(s.status,[]))if(i)s=$M();else{this.sleepTime=Math.max(this.sleepTime*2,tJ),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(Mn.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=HJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,jl,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const s=KJ(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,jl,n,r);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=rP*this._chunkMultiplier,n=new uy(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,i)=>{let o;try{o=GJ(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(o,jl,s,i,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){rP*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=zJ(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,jl,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=nV(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,jl,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=BM(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Qw(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){const i=new QJ(n||void 0,r||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Qw(this._state)){case ds.SUCCESS:qc(this._resolve.bind(null,this.snapshot))();break;case ds.CANCELED:case ds.ERROR:const n=this._reject;qc(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Qw(this._state)){case ds.RUNNING:case ds.PAUSED:e.next&&qc(e.next.bind(e,this.snapshot))();break;case ds.SUCCESS:e.complete&&qc(e.complete.bind(e))();break;case ds.CANCELED:case ds.ERROR:e.error&&qc(e.error.bind(e,this._error))();break;default:e.error&&qc(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(e,n){this._service=e,n instanceof Ds?this._location=n:this._location=Ds.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Sc(e,n)}get root(){const e=new Ds(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return JM(this._location.path)}get storage(){return this._service}get parent(){const e=LJ(this._location.path);if(e===null)return null;const n=new Ds(this._location.bucket,e);return new Sc(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw fJ(e)}}function ZJ(t,e,n){t._throwIfRoot("uploadBytes");const r=nV(t.storage,t._location,oI(),new vo(e,!0),n);return t.storage.makeRequestWithTokens(r,jl).then(s=>({metadata:s,ref:t}))}function eX(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new XJ(t,new vo(e),n)}function tX(t){t._throwIfRoot("getDownloadURL");const e=WJ(t.storage,t._location,oI());return t.storage.makeRequestWithTokens(e,jl).then(n=>{if(n===null)throw dJ();return n})}function nX(t,e){const n=MJ(t._location.path,e),r=new Ds(t._location.bucket,n);return new Sc(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rX(t){return/^[A-Za-z]+:\/\//.test(t)}function sX(t,e){return new Sc(t,e)}function rV(t,e){if(t instanceof cI){const n=t;if(n._bucket==null)throw cJ();const r=new Sc(n,n._bucket);return e!=null?rV(r,e):r}else return e!==void 0?nX(t,e):t}function iX(t,e){if(e&&rX(e)){if(t instanceof cI)return sX(t,e);throw ib("To use ref(service, url), the first argument must be a Storage instance.")}else return rV(t,e)}function sP(t,e){const n=e==null?void 0:e[UM];return n==null?null:Ds.makeFromBucketSpec(n,t)}function oX(t,e,n,r={}){t.host=`${e}:${n}`;const s=Ti(e);s&&(tm(`https://${t.host}/b`),Zy("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:jD(i,t.app.options.projectId))}class cI{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=FM,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ZY,this._maxUploadRetryTime=eJ,this._requests=new Set,s!=null?this._bucket=Ds.makeFromBucketSpec(s,this._host):this._bucket=sP(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ds.makeFromBucketSpec(this._url,e):this._bucket=sP(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){nP("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){nP("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(fs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Sc(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new mJ(WM());{const o=TJ(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const iP="@firebase/storage",oP="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sV="storage";function Xte(t,e,n){return t=Dt(t),ZJ(t,e,n)}function aX(t,e,n){return t=Dt(t),eX(t,e,n)}function lX(t){return t=Dt(t),tX(t)}function cX(t,e){return t=Dt(t),iX(t,e)}function iV(t=tv(),e){t=Dt(t);const r=Rc(t,sV).getImmediate({identifier:e}),s=LE("storage");return s&&uX(r,...s),r}function uX(t,e,n,r={}){oX(t,e,n,r)}function dX(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new cI(n,r,s,e,Cc)}function hX(){no(new _i(sV,dX,"PUBLIC").setMultipleInstances(!0)),Ms(iP,oP,""),Ms(iP,oP,"esm2020")}hX();const fX={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"0.0.0",VITE_DEV_MODE:"true",VITE_ENABLE_OFFLINE_PERSISTENCE:"false",VITE_FIREBASE_API_KEY:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),VITE_FIREBASE_APP_ID:"1:483702062341:web:b1ff06ad175cb7ae428b6c",VITE_FIREBASE_AUTH_DOMAIN:"voda-c6abd.firebaseapp.com",VITE_FIREBASE_AUTH_EMULATOR_URL:"http://localhost:9099",VITE_FIREBASE_FIRESTORE_EMULATOR_HOST:"localhost:8080",VITE_FIREBASE_FUNCTIONS_EMULATOR_HOST:"localhost:5001",VITE_FIREBASE_MEASUREMENT_ID:"G-CV6QGH7G7P",VITE_FIREBASE_MESSAGING_SENDER_ID:"483702062341",VITE_FIREBASE_PROJECT_ID:"voda-c6abd",VITE_FIREBASE_STORAGE_BUCKET:"voda-c6abd.appspot.com",VITE_FORCE_HASH_ROUTER:"true",VITE_SHOP_ID:"demo-shop-001",VITE_SHOP_NAME:"   ",VITE_SHOW_ENV_BANNER:"true",VITE_USE_EMULATORS:"false",VITE_USE_FIREBASE_EMULATOR:"false"},dy={apiKey:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),authDomain:"voda-c6abd.firebaseapp.com",projectId:"voda-c6abd",storageBucket:"voda-c6abd.appspot.com",messagingSenderId:"483702062341",appId:"1:483702062341:web:b1ff06ad175cb7ae428b6c"};console.log(" Initializing Firebase with config:",{projectId:dy.projectId,authDomain:dy.authDomain,emulatorMode:!1});const Ov=WD(dy);try{typeof window<"u",void 0||console.log(" App Check not initialized: missing VITE_FIREBASE_RECAPTCHA_KEY")}catch(t){console.log(" Failed to initialize App Check (will proceed without it):",t)}const qt=f2(Ov,{persistence:[WE,x0]});console.log(" Firebase Auth initialized with browserLocalPersistence (fallback to inMemory)");const F=dM(Ov,{experimentalForceLongPolling:!0,useFetchStreams:!1});try{z2("error")}catch{}const oV=YY(Ov,"us-central1");iV(Ov);console.log(" Firebase initialized successfully");const mX=async()=>{try{console.log(" Offline persistence disabled (env flag or emulator mode)"),console.log(" Firestore features configured successfully")}catch(t){console.error(" Error configuring Firestore features:",t)}};setTimeout(mX,100);let Dl=0;const Yw=3,pX=1e3,aV=async t=>{var e,n;if(console.error(" Firestore connection error:",t),(t.code==="unavailable"||t.code==="failed-precondition"||(e=t.message)!=null&&e.includes("ERR_ABORTED")||(n=t.message)!=null&&n.includes("UNAVAILABLE"))&&Dl<Yw){Dl++;const r=Math.min(pX*Math.pow(2,Dl-1),1e4);console.log(` Attempting to reconnect (${Dl}/${Yw}) in ${r}ms...`);try{await WS(F),await new Promise(s=>setTimeout(s,r)),await zS(F),console.log(" Firestore reconnected successfully"),Dl=0}catch(s){console.error(" Failed to reconnect:",s),Dl>=Yw&&(console.error(" Maximum reconnection attempts reached."),gX())}}},gX=()=>{const t=document.createElement("div");t.style.cssText=`
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #f8d7da;
    color: #721c24;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #f5c6cb;
    z-index: 10000;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    max-width: 400px;
  `,t.innerHTML=`
    <h3 style="margin: 0 0 10px 0;">  </h3>
    <p style="margin: 0 0 15px 0;">   .     .</p>
    <button onclick="window.location.reload()" style="
      background: #dc3545;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
    ">  </button>
  `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},1e4)};window.addEventListener("online",async()=>{console.log(" Network back online, enabling Firestore...");try{await zS(F),Dl=0,console.log(" Firestore network enabled")}catch(t){console.error(" Failed to enable Firestore network:",t)}});window.addEventListener("offline",async()=>{console.log(" Network offline, disabling Firestore network...");try{await WS(F),console.log(" Firestore network disabled")}catch(t){console.error(" Failed to disable Firestore network:",t)}});window.addEventListener("unhandledrejection",t=>{var e,n,r,s,i,o;(((e=t.reason)==null?void 0:e.code)==="unavailable"||((n=t.reason)==null?void 0:n.code)==="failed-precondition"||(s=(r=t.reason)==null?void 0:r.message)!=null&&s.includes("ERR_ABORTED")||(o=(i=t.reason)==null?void 0:i.message)!=null&&o.includes("UNAVAILABLE"))&&(aV(t.reason),t.preventDefault())});console.log("Using Firebase Production Environment");const En=Object.freeze(Object.defineProperty({__proto__:null,auth:qt,db:F,firebaseConfig:dy,functions:oV,handleFirestoreError:aV},Symbol.toStringTag,{value:"Module"})),Tt=t=>{if(t&&typeof t=="object"&&typeof t.toDate=="function")return t.toDate();if(t instanceof Date)return t;if(typeof t=="number")return new Date(t);if(typeof t=="string"){const e=new Date(t);return isNaN(e.getTime())?new Date:e}return new Date},yX=t=>{if(t===null)return!1;const e=Object.getPrototypeOf(t);return e===Object.prototype||e===null},ol=t=>{if(t===void 0)return;if(t===null)return null;if(Array.isArray(t))return t.map(n=>ol(n)).filter(n=>n!==void 0);if(t instanceof Date||!yX(t))return t;const e={};for(const[n,r]of Object.entries(t)){const s=ol(r);s!==void 0&&(e[n]=s)}return e},tf={async create(t){await rn(ye(F,"profiles",t.userId),{userId:t.userId,shopId:t.shopId,role:t.role,fullName:t.fullName,phone:t.phone,createdAt:$e()})},async getById(t){const e=ye(F,"profiles",t),n=await Sn(e);if(n.exists()){const r=n.data();return{userId:n.id,...r,createdAt:Tt(r.createdAt)}}return null},async update(t,e){const n=ye(F,"profiles",t);await xn(n,{...e,updatedAt:$e()})},async getByShopId(t){const e=Ye(Ae(F,"profiles"),Ne("shopId","==",t));return(await Ze(e)).docs.map(r=>{const s=r.data();return{userId:r.id,...s,createdAt:Tt(s.createdAt)}})}},ob={async create(t){return(await Vs(Ae(F,"referrals"),{...t,createdAt:$e(),updatedAt:$e()})).id},async getByReferrerId(t){try{const e=Ye(Ae(F,"referrals"),Ne("referrerId","==",t),Gs("createdAt","desc"));return(await Ze(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:Tt(r.data().createdAt),updatedAt:Tt(r.data().updatedAt)}))}catch(e){if(String((e==null?void 0:e.message)||"").includes("requires an index")){const r=Ye(Ae(F,"referrals"),Ne("referrerId","==",t));return(await Ze(r)).docs.map(i=>({id:i.id,...i.data(),createdAt:Tt(i.data().createdAt),updatedAt:Tt(i.data().updatedAt)})).sort((i,o)=>{var a,l,c,u;return(((l=(a=o.createdAt)==null?void 0:a.getTime)==null?void 0:l.call(a))||0)-(((u=(c=i.createdAt)==null?void 0:c.getTime)==null?void 0:u.call(c))||0)})}throw e}},async getByReferralCode(t){const e=Ye(Ae(F,"referrals"),Ne("referralCode","==",t),Uo(1)),n=await Ze(e);if(n.empty)return null;const r=n.docs[0];return{id:r.id,...r.data(),createdAt:Tt(r.data().createdAt),updatedAt:Tt(r.data().updatedAt)}},async updateStatus(t,e){await xn(ye(F,"referrals",t),{status:e,updatedAt:$e()})},generateReferralCode(t){const e=Date.now().toString(36);return`REF_${t.slice(-6)}_${e}`.toUpperCase()}},lV={async getLastTransactions(t,e=30){try{const{getLastTransactions:n}=await ee(async()=>{const{getLastTransactions:s}=await import("./functions-DxNA6i1h.js");return{getLastTransactions:s}},[],import.meta.url);return(await n({walletId:t,limit:e})).transactions}catch(n){console.error("Error in getLastTransactions:",n);const r=Ye(Ae(F,"transactions"),Ne("shopId","==",t));return(await Ze(r)).docs.map(o=>{const a=o.data();return{id:o.id,...a,createdAt:Tt(a.createdAt)}}).sort((o,a)=>{const l=o.createdAt?new Date(o.createdAt).getTime():0;return(a.createdAt?new Date(a.createdAt).getTime():0)-l}).slice(0,e)}},async getMerchantTransactions(t,e=30){try{const{getLastTransactions:n}=await ee(async()=>{const{getLastTransactions:s}=await import("./functions-DxNA6i1h.js");return{getLastTransactions:s}},[],import.meta.url);return(await n({merchantUserId:t,limit:e})).transactions}catch(n){console.error("Error in getMerchantTransactions:",n);const r=Ye(Ae(F,"transactions"),Ne("merchantUserId","==",t));return(await Ze(r)).docs.map(o=>{const a=o.data();return{id:o.id,...a,createdAt:Tt(a.createdAt)}}).sort((o,a)=>{const l=o.createdAt?new Date(o.createdAt).getTime():0;return(a.createdAt?new Date(a.createdAt).getTime():0)-l}).slice(0,e)}}},cV={async getByUserId(t){const e=Ye(Ae(F,"profiles"),Ne("userId","==",t)),n=await Ze(e);if(!n.empty){const r=n.docs[0],s=r.data();return{userId:r.id,...s,createdAt:Tt(s.createdAt),updatedAt:Tt(s.updatedAt)}}return null},async update(t,e){const n=Ye(Ae(F,"profiles"),Ne("userId","==",t)),r=await Ze(n);if(!r.empty){const s=ye(F,"profiles",r.docs[0].id);await xn(s,{...e,updatedAt:$e()})}}},ka={async create(t){return(await Vs(Ae(F,"merchantWallets"),{...t,transferLimit:t.transferLimit||2e5,withdrawLimit:t.withdrawLimit||2e5,transferUsage:t.transferUsage||0,withdrawUsage:t.withdrawUsage||0,createdAt:$e(),updatedAt:$e()})).id},async getByMerchantId(t){const e=Ye(Ae(F,"merchantWallets"),Ne("merchantUserId","==",t)),r=(await Ze(e)).docs.map(a=>{const l=a.data();return{id:a.id,...l,transferLimit:l.transferLimit||2e5,withdrawLimit:l.withdrawLimit||2e5,transferUsage:l.transferUsage||0,withdrawUsage:l.withdrawUsage||0,createdAt:Tt(l.createdAt),updatedAt:Tt(l.updatedAt)}});if(r.length>0)return r.sort((a,l)=>{const c=a.createdAt,u=l.createdAt;return c&&u?u.getTime()-c.getTime():c&&!u?-1:!c&&u?1:0});const s=Ye(Ae(F,"wallets"),Ne("userId","==",t));return(await Ze(s)).docs.map(a=>{const l=a.data();return{id:a.id,merchantUserId:l.userId||t,provider:l.provider||"instapay",msisdn:l.msisdn||"",label:l.name||l.label||"",isActive:l.isActive!==!1,dailyLimit:l.dailyLimit||2e5,monthlyLimit:l.monthlyLimit||2e5,transferLimit:l.transferLimit||l.monthlyTransferLimit||2e5,withdrawLimit:l.withdrawLimit||l.monthlyWithdrawLimit||2e5,transferUsage:l.transferUsage||l.monthlyTransferUsage||0,withdrawUsage:l.withdrawUsage||l.monthlyWithdrawUsage||0,dailyTransferLimit:l.dailyTransferLimit,dailyWithdrawLimit:l.dailyWithdrawLimit,createdAt:Tt(l.createdAt),updatedAt:Tt(l.updatedAt)}}).sort((a,l)=>{const c=a.createdAt,u=l.createdAt;return c&&u?u.getTime()-c.getTime():c&&!u?-1:!c&&u?1:0})},async getById(t){const e=ye(F,"merchantWallets",t),n=await Sn(e);if(n.exists()){const r=n.data();return{id:n.id,...r,transferLimit:r.transferLimit||2e5,withdrawLimit:r.withdrawLimit||2e5,transferUsage:r.transferUsage||0,withdrawUsage:r.withdrawUsage||0,createdAt:Tt(r.createdAt),updatedAt:Tt(r.updatedAt)}}return null},async getByIccid(t){try{if(!t)return null;const e=Ye(Ae(F,"merchantWallets"),Ne("iccid","==",t)),n=await Ze(e);if(!n.empty){const r=n.docs[0],s=r.data();return{id:r.id,...s,transferLimit:s.transferLimit||2e5,withdrawLimit:s.withdrawLimit||2e5,transferUsage:s.transferUsage||0,withdrawUsage:s.withdrawUsage||0,createdAt:Tt(s.createdAt),updatedAt:Tt(s.updatedAt)}}return null}catch(e){return console.warn("getByIccid failed:",e),null}},async getByMsisdn(t){try{const e=String(t||"").replace(/\D/g,"");if(!e)return null;let n=Ye(Ae(F,"merchantWallets"),Ne("msisdn","==",t)),r=await Ze(n);if(!r.empty){const a=r.docs[0],l=a.data();return{id:a.id,...l,transferLimit:l.transferLimit||2e5,withdrawLimit:l.withdrawLimit||2e5,transferUsage:l.transferUsage||0,withdrawUsage:l.withdrawUsage||0,createdAt:Tt(l.createdAt),updatedAt:Tt(l.updatedAt)}}const s=Ye(Ae(F,"merchantWallets")),i=await Ze(s),o=e.slice(-7);for(const a of i.docs){const l=a.data();if(String(l.msisdn||"").replace(/\D/g,"").slice(-7)===o)return{id:a.id,...l,transferLimit:l.transferLimit||2e5,withdrawLimit:l.withdrawLimit||2e5,transferUsage:l.transferUsage||0,withdrawUsage:l.withdrawUsage||0,createdAt:Tt(l.createdAt),updatedAt:Tt(l.updatedAt)}}return null}catch(e){return console.warn("getByMsisdn failed:",e),null}},async update(t,e){const n=ye(F,"merchantWallets",t);await xn(n,{...e,updatedAt:$e()})},async updateUsage(t,e,n){const r=ye(F,"merchantWallets",t),s={updatedAt:$e()};e!==void 0&&(s.transferUsage=e),n!==void 0&&(s.withdrawUsage=n),await xn(r,s)},async resetDailyUsage(t){const n=(await this.getByMerchantId(t)).map(r=>this.updateUsage(r.id,0,0));await Promise.all(n)},async reassignByMsisdns(t,e){try{if(!e)throw new Error("merchantUserId   ");if(!Array.isArray(t)||t.length===0)return{updated:0,failed:0};const r=((o,a)=>o.reduce((l,c,u)=>(u%a===0&&l.push(o.slice(u,u+a)),l),[]))(t.map(o=>o.trim()).filter(Boolean),10);let s=0,i=0;for(const o of r){const a=Ye(Ae(F,"merchantWallets"),Ne("msisdn","in",o)),c=(await Ze(a)).docs.map(async u=>{try{const d=u.data();if(d.merchantUserId&&d.merchantUserId!==e)return;await xn(u.ref,{merchantUserId:e,updatedAt:$e()}),s+=1}catch(d){console.error("Failed to reassign wallet",u.id,d),i+=1}});await Promise.allSettled(c)}return{updated:s,failed:i}}catch(n){return console.error("Error reassigning wallets by msisdns:",n),{updated:0,failed:t.length}}},async delete(t){const e=ye(F,"merchantWallets",t);await Wn(e)}},uI={async create(t){try{console.log("Creating transaction:",t);const{calculateCommission:e,calculateProfit:n}=await ee(async()=>{const{calculateCommission:c,calculateProfit:u}=await Promise.resolve().then(()=>To);return{calculateCommission:c,calculateProfit:u}},void 0,import.meta.url),r=t.commission!==void 0?t.commission:e(t.amount,t.txnType),s=n(t.amount,t.txnType),i=t.merchantUserId||t.createdBy;i||console.warn("   merchantUserId  createdBy         .");const o=Object.fromEntries(Object.entries(t).filter(([c,u])=>u!==void 0)),a={...o,merchantUserId:i,commission:r,profit:s,createdAt:o.createdAt?o.createdAt instanceof Date?o.createdAt:new Date(String(o.createdAt)):new Date,uploadedAt:$e(),confirmedAt:o.confirmedAt?o.confirmedAt instanceof Date?o.confirmedAt:new Date(String(o.confirmedAt)):null},l=await Vs(Ae(F,"transactions"),a);if(console.log("Transaction created with ID:",l.id,"Profit:",s),s>0){const{ProfitService:c}=await ee(async()=>{const{ProfitService:u}=await import("./profitService-QTJQLMA0.js");return{ProfitService:u}},[],import.meta.url);try{c.addProfit(s,i)}catch{c.addProfit(s)}console.log("     :",s,"")}await this.updateLineUsage(t.lineId,t.amount);try{const c=String((t==null?void 0:t.walletId)||"").trim();if(c){const u=await ka.getById(c),d=Number((u==null?void 0:u.transferUsage)||0),m=Number((u==null?void 0:u.withdrawUsage)||0),p=Number(t.amount||0),v=String((t==null?void 0:t.originType)||"").trim()==="withdraw",g=String(t.txnType||"")==="receive";v||g?await ka.updateUsage(c,void 0,m+p):await ka.updateUsage(c,d+p,void 0)}}catch{}try{const c=Number(t.amount||0),u=String((t==null?void 0:t.receiverMsisdn)||"").trim(),d=String((t==null?void 0:t.walletId)||"").trim(),m=String((t==null?void 0:t.originType)||"").trim();let p="";if(d)try{const g=await ka.getById(d);p=String((g==null?void 0:g.msisdn)||(g==null?void 0:g.label)||d).trim()}catch{}let v="";m==="withdraw"?v=p?`   ${c}   ${p}    ${r}`:`   ${c}    ${r}`:m==="transfer"||t.txnType==="send"?v=`   ${c}   ${p||" "}   ${u||""}    ${r}`:v=p?`  ${c}   ${p}`:`  ${c}`}catch{}return l.id}catch(e){throw console.error("Error creating transaction:",e),e}},async updateLineUsage(t,e){try{console.log("Updating line usage:",{lineId:t,amount:e})}catch(n){console.error("Error updating line usage:",n)}},async getByShopId(t){const e=Ye(Ae(F,"transactions"),Ne("shopId","==",t),Gs("createdAt","desc"));return(await Ze(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:Tt(r.data().createdAt),confirmedAt:r.data().confirmedAt?Tt(r.data().confirmedAt):void 0}))},async getByMerchantId(t){const e=Ye(Ae(F,"transactions"),Ne("merchantUserId","==",t),Gs("createdAt","desc"));return(await Ze(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:Tt(r.data().createdAt),confirmedAt:r.data().confirmedAt?Tt(r.data().confirmedAt):void 0}))},async getByUserId(t){const e=Ye(Ae(F,"transactions"),Ne("merchantUserId","==",t)),n=Ye(Ae(F,"transactions"),Ne("userId","==",t)),[r,s]=await Promise.all([Ze(e),Ze(n)]),i=[...r.docs,...s.docs],o=new Set,a=[];for(const l of i){if(o.has(l.id))continue;o.add(l.id);const c=l.data();a.push({id:l.id,...c,createdAt:Tt(c.createdAt),confirmedAt:c.confirmedAt?Tt(c.confirmedAt):void 0})}return a.sort((l,c)=>{const u=l.createdAt,d=c.createdAt;return u&&d?d.getTime()-u.getTime():u&&!d?-1:!u&&d?1:0})},async updateStatus(t,e,n){const r=ye(F,"transactions",t);await xn(r,{status:e,confirmedAt:n?n instanceof Date?n:new Date(String(n)):null})}};async function vX(t){const e=t.txnType||"receive",n=Date.now(),r=o=>String(o||"").replace(/\D/g,"").slice(-5);try{const o=await lV.getMerchantTransactions(t.createdBy,50),a=r(e==="send"?t.senderMsisdn||t.lineId:t.senderMsisdn),l=String(t.provider||"vodafone_cash").toLowerCase();for(const c of o){const u=c!=null&&c.createdAt?new Date(c.createdAt).getTime():0;if(Math.abs(n-u)<=1e4){const d=Number((c==null?void 0:c.amount)||0)===Number(t.amount||0),m=String((c==null?void 0:c.provider)||"").toLowerCase()===l,p=r((c==null?void 0:c.senderMsisdn)||(c==null?void 0:c.receiverMsisdn)||(c==null?void 0:c.senderPhone)||(c==null?void 0:c.receiverPhone));if(d&&m&&p&&a&&p===a)return String((c==null?void 0:c.id)||"")}}}catch{}const s={shopId:t.shopId,lineId:t.lineId,merchantUserId:t.createdBy,walletId:t.walletId,provider:t.provider||"vodafone_cash",txnType:e,originType:e==="send"?"send":"withdraw",amount:t.amount,receiverMsisdn:e==="send"?t.senderMsisdn:t.lineId,senderMsisdn:e==="send"?t.lineId:t.senderMsisdn,senderName:t.senderName,reference:t.reference,rawText:t.text,note:t.note,createdBy:t.createdBy,createdAt:new Date,confirmedAt:new Date,status:"confirmed"},i=await uI.create(s);try{const{calculateCommission:o}=await ee(async()=>{const{calculateCommission:c}=await Promise.resolve().then(()=>To);return{calculateCommission:c}},void 0,import.meta.url),a=o(Number(t.amount||0),e),l={transactionId:i,userId:t.createdBy,transactionType:e==="send"?"send":"withdraw",txnType:e,status:"confirmed",amount:Number(t.amount||0),commission:a,senderMsisdn:e==="send"?t.lineId:t.senderMsisdn,receiverMsisdn:e==="send"?t.senderMsisdn:t.lineId,fromWallet:t.walletId,note:t.note||"SMS-VF",reference:t.reference,createdAt:new Date,cashierName:" "};await hr.saveUserTransaction(t.createdBy,l)}catch{}return(async()=>{try{const{calculateCommission:o}=await ee(async()=>{const{calculateCommission:m}=await Promise.resolve().then(()=>To);return{calculateCommission:m}},void 0,import.meta.url),a=o(Number(t.amount||0),e),l=await hr.getUserData(t.createdBy),c={...(l==null?void 0:l.walletBalances)||{}},u=Math.max(0,Number(c[t.walletId]||0)),d=Math.max(0,Number(t.amount||0));if(e==="send"){c[t.walletId]=u-d;const m=Number((l==null?void 0:l.cashBalance)||0),p=Math.round(m+d+Math.max(0,a));await hr.updateUserData(t.createdBy,{walletBalances:c,cashBalance:p,lastUpdated:new Date().toISOString()})}else{c[t.walletId]=u+d;const m=Number((l==null?void 0:l.cashBalance)||0),p=Math.round(m-d+Math.max(0,a));await hr.updateUserData(t.createdBy,{walletBalances:c,cashBalance:p,lastUpdated:new Date().toISOString()})}}catch{}})(),(async()=>{try{const{walletDailyLimitsService:o}=await ee(async()=>{const{walletDailyLimitsService:l}=await Promise.resolve().then(()=>Bf);return{walletDailyLimitsService:l}},void 0,import.meta.url),a=Math.max(0,Number(t.amount||0));await o.updateUsage(String(t.walletId),a,e==="send"?"transfer":"withdraw")}catch(o){console.warn("      SMS:",o)}})(),i}const wX="https://summer-cake-5149.alkaptin2030.workers.dev",uV={async getTelegramWorkerUrl(){var t;try{const e=ye(F,"systemSettings","core"),n=await Sn(e);return n.exists()&&String(((t=n.data())==null?void 0:t.telegramWorkerUrl)||"").trim()||null}catch{return null}},async setTelegramWorkerUrl(t){const e=ye(F,"systemSettings","core");await rn(e,{telegramWorkerUrl:t,updatedAt:$e()},{merge:!0})}},_X={async send(t,e){try{const n=await hr.getUserData(t),r=String((n==null?void 0:n.telegramChatId)||(n==null?void 0:n.chat_id)||"").trim();if(!r)throw new Error("Telegram Chat ID   ");const i=(await uV.getTelegramWorkerUrl()||wX).replace(/\/$/,""),o=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:r,text:e})});if(!o.ok){const a=await o.text().catch(()=>"");throw new Error(a||"     ")}}catch{}}},bX={async log(t,e,n,r,s){await Vs(Ae(F,"auditLogs"),{actor:s,action:t,entity:e,entityId:n,meta:r,createdAt:$e()})},async getLogs(t=100){const e=Ye(Ae(F,"auditLogs"),Gs("createdAt","desc"),Uo(t));return(await Ze(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:Tt(r.data().createdAt)}))},async getDeletedTransactions(){try{const t=Ye(Ae(F,"deletedTransactions"),Gs("deletedAt","desc"));return(await Ze(t)).docs.map(n=>({id:n.id,...n.data(),deletedAt:Tt(n.data().deletedAt)}))}catch(t){return console.error("Error getting deleted transactions:",t),[]}},async getDeletedTransactionsByUser(t){try{const e=Ye(Ae(F,"deletedTransactions"),Ne("userId","==",t),Gs("deletedAt","desc"));return(await Ze(e)).docs.map(r=>({id:r.id,...r.data(),deletedAt:Tt(r.data().deletedAt)})).filter(r=>(r==null?void 0:r.permanent)!==!0)}catch(e){if(String((e==null?void 0:e.message)||"").includes("requires an index"))try{const r=Ye(Ae(F,"deletedTransactions"),Ne("userId","==",t));return(await Ze(r)).docs.map(o=>({id:o.id,...o.data(),deletedAt:Tt(o.data().deletedAt)})).filter(o=>(o==null?void 0:o.permanent)!==!0).sort((o,a)=>{const l=(o.deletedAt instanceof Date?o.deletedAt:new Date(o.deletedAt)).getTime();return(a.deletedAt instanceof Date?a.deletedAt:new Date(a.deletedAt)).getTime()-l})}catch(r){return console.error("Fallback error getting deleted transactions by user:",r),[]}return console.error("Error getting deleted transactions by user:",e),[]}},async saveDeletedTransaction(t){var e;try{if(console.log("      Firebase:",t.id),!t.userId)throw new Error("     ");if(!t.originalTransactionId)throw new Error("   ");const n=t.reference??t.transactionReference??((e=t.receipt)==null?void 0:e.reference),r={...t,deletedAt:$e(),userId:t.userId,originalTransactionId:t.originalTransactionId,type:t.type||"unknown",amount:t.amount||0,status:t.status||"deleted",...n?{reference:n}:{}};console.log("    :",r);let s=3,i;for(;s>0;)try{const o=await Vs(Ae(F,"deletedTransactions"),r);console.log("       :",o.id);return}catch(o){i=o,s--,console.warn(`       : ${s}`,o),s>0&&await new Promise(a=>setTimeout(a,1e3))}throw console.error("        "),i}catch(n){throw console.error("     :",n),n instanceof Error&&(n.message.includes("network")?console.error("    -    "):n.message.includes("permission")?console.error("    -    Firestore"):n.message.includes("quota")&&console.error("     -    Firebase")),n}},async permanentlyDeleteTransaction(t,e){try{const n=Ye(Ae(F,"deletedTransactions"),Ne("originalTransactionId","==",t),Ne("userId","==",e)),r=await Ze(n);r.empty?await Vs(Ae(F,"deletedTransactions"),{userId:e,originalTransactionId:t,permanent:!0,deletedAt:$e()}):await Promise.all(r.docs.map(s=>xn(s.ref,{permanent:!0,deletedAt:$e()}))),console.log("    :",t);try{const s=Ye(Ae(F,"userTransactions"),Ne("userId","==",e)),o=(await Ze(s)).docs.filter(a=>{var c,u;const l=a.data();return a.id===t||l.id===t||l.transactionId===t||l.originalTransactionId===t||((c=l.receipt)==null?void 0:c.id)===t||((u=l.receipt)==null?void 0:u.transactionId)===t});o.length>0&&(console.log(`  ${o.length}   userTransactions`),await Promise.all(o.map(a=>Wn(a.ref))))}catch(s){console.warn("   userTransactions   :",s)}try{const s=ye(F,"transactions",t);(await Sn(s)).exists()&&(console.log("     transactions  "),await Wn(s));const o=Ye(Ae(F,"transactions"),Ne("transactionId","==",t)),a=await Ze(o);a.empty||(console.log(`  ${a.size}   transactions  transactionId`),await Promise.all(a.docs.map(u=>Wn(u.ref))));const l=Ye(Ae(F,"transactions"),Ne("originalTransactionId","==",t)),c=await Ze(l);c.empty||(console.log(`  ${c.size}   transactions  originalTransactionId`),await Promise.all(c.docs.map(u=>Wn(u.ref))));try{const u=Ye(Ae(F,"deletedTransactions"),Ne("userId","==",e),Ne("originalTransactionId","==",t)),d=await Ze(u),m=d.docs.map(v=>{var g;return String(((g=v.data())==null?void 0:g.reference)||"")}).filter(Boolean),p=d.docs.map(v=>{var g;return String(((g=v.data())==null?void 0:g.transactionId)||"")}).filter(Boolean);for(const v of m){const g=Ye(Ae(F,"transactions"),Ne("reference","==",v)),E=await Ze(g);E.empty||(console.log(`  ${E.size}   transactions  reference=${v}`),await Promise.all(E.docs.map(b=>Wn(b.ref))))}for(const v of p){try{const b=ye(F,"transactions",v);(await Sn(b)).exists()&&(console.log("     transactions  :",v),await Wn(b))}catch{}const g=Ye(Ae(F,"transactions"),Ne("transactionId","==",v)),E=await Ze(g);E.empty||(console.log(`  ${E.size}   transactions  transactionId=${v}`),await Promise.all(E.docs.map(b=>Wn(b.ref))))}}catch{}}catch(s){console.warn("    transactions   :",s)}}catch(n){throw console.error("Error permanently deleting transaction:",n),n}}},dV={async add(t){const e=Ae(F,"daily_reports_archive");return(await Vs(e,{userId:t.userId,reportDate:t.reportDate,totalTransactions:t.totalTransactions,totalAmount:t.totalAmount,totalWithdrawn:t.totalWithdrawn,totalSent:t.totalSent,profit:t.profit??null,walletId:t.walletId??null,cashBalance:t.cashBalance??null,walletsTotal:t.walletsTotal??null,walletBalances:t.walletBalances?ol(t.walletBalances):null,salesToday:t.salesToday??null,debtsToday:t.debtsToday??null,maintenanceProfitToday:t.maintenanceProfitToday??null,createdAt:$e(),updatedAt:$e()})).id},async getByUser(t,e=50){var n,r,s,i;try{const o=Ye(Ae(F,"daily_reports_archive"),Ne("userId","==",t),Uo(e)),a=await Ze(o);let l=[];try{l=(await Ze(Ye(Ae(F,"deletedDailyArchives"),Ne("userId","==",t)))).docs.map(v=>{var g,E;return{id:v.id,reportDate:String(((g=v.data())==null?void 0:g.reportDate)||""),archiveId:String(((E=v.data())==null?void 0:E.archiveId)||"")}})}catch{}const c=(p,v)=>l.some(g=>g.archiveId&&g.archiveId===p||g.reportDate&&g.reportDate===v),u=a.docs.map(p=>({id:p.id,userId:String(p.data().userId),reportDate:String(p.data().reportDate),totalTransactions:Number(p.data().totalTransactions||0),totalAmount:Number(p.data().totalAmount||0),totalWithdrawn:Number(p.data().totalWithdrawn||0),totalSent:Number(p.data().totalSent||0),profit:p.data().profit!==void 0?Number(p.data().profit):void 0,walletId:p.data().walletId??null,cashBalance:p.data().cashBalance!==void 0?Number(p.data().cashBalance):void 0,walletsTotal:p.data().walletsTotal!==void 0?Number(p.data().walletsTotal):void 0,walletBalances:p.data().walletBalances??void 0,salesToday:p.data().salesToday!==void 0?Number(p.data().salesToday):void 0,debtsToday:p.data().debtsToday!==void 0?Number(p.data().debtsToday):void 0,maintenanceProfitToday:p.data().maintenanceProfitToday!==void 0?Number(p.data().maintenanceProfitToday):void 0,createdAt:Tt(p.data().createdAt||p.data().updatedAt)})).filter(p=>!c(p.id,p.reportDate)),d=new Map;for(const p of u){const v=d.get(p.reportDate);(!v||(((r=(n=p.createdAt)==null?void 0:n.getTime)==null?void 0:r.call(n))||0)>(((i=(s=v.createdAt)==null?void 0:s.getTime)==null?void 0:i.call(s))||0))&&d.set(p.reportDate,p)}const m=Array.from(d.values());return m.sort((p,v)=>p.reportDate<v.reportDate?1:-1),m}catch(o){throw console.error("Error loading daily reports archive:",o),o}},async deleteOlderThan(t,e=10){try{const n=new Date;n.setDate(n.getDate()-e);const r=Ye(Ae(F,"daily_reports_archive"),Ne("userId","==",t)),s=await Ze(r);let i=0;for(const o of s.docs){const a=Tt(o.data().createdAt);a&&a.getTime()<n.getTime()&&(await Wn(o.ref),i++)}return i>0&&console.log(`   ${i}      ${e}   ${t}`),i}catch(n){throw console.error("Error deleting old daily reports archive:",n),n}},async trimToMaxCount(t,e=10){try{const n=Ye(Ae(F,"daily_reports_archive"),Ne("userId","==",t)),s=(await Ze(n)).docs.map(o=>({ref:o.ref,reportDate:String(o.data().reportDate||""),createdAt:Tt(o.data().createdAt)}));if(s.sort((o,a)=>{var u,d;if(o.reportDate&&a.reportDate)return o.reportDate<a.reportDate?1:-1;const l=((u=o.createdAt)==null?void 0:u.getTime())??0;return(((d=a.createdAt)==null?void 0:d.getTime())??0)-l}),s.length<=e)return 0;const i=s.slice(e);for(const o of i)await Wn(o.ref);return console.log(`     ${t}  ${e}   ${i.length}`),i.length}catch(n){throw console.error("Error trimming daily reports archive to max count:",n),n}},async deleteAllByUser(t){try{const e=Ye(Ae(F,"daily_reports_archive"),Ne("userId","==",t)),n=await Ze(e);let r=0;for(const s of n.docs)try{await Wn(s.ref),r++}catch{const o=s.data();try{await Vs(Ae(F,"deletedDailyArchives"),{userId:t,archiveId:s.id,reportDate:String((o==null?void 0:o.reportDate)||""),createdAt:$e()})}catch{}}return r}catch(e){throw console.error("Error deleting all daily reports archive for user:",e),e}}},hr={async getUserData(t){try{console.log("     :",{userId:t});const e=ye(F,"users",t),n=await Sn(e);if(n.exists()){const r=n.data();return console.log("     :",r),{...r,createdAt:Tt(r.createdAt),updatedAt:Tt(r.updatedAt)}}else{console.log("       ");const r={walletBalances:{},createdAt:new Date,updatedAt:new Date};return await this.saveUserData(t,r),console.log("     "),r}}catch(e){return console.error("      :",e),{walletBalances:{},createdAt:new Date,updatedAt:new Date}}},getLocalReceipts(t){try{const e=localStorage.getItem(`localReceipts_${t}`);if(!e)return[];const n=JSON.parse(e);return Array.isArray(n)?n:[]}catch{return[]}},saveLocalReceipt(t,e){try{const n=this.getLocalReceipts(t),r=200,s=l=>{var c;return String((l==null?void 0:l.id)||(l==null?void 0:l.transactionId)||(l==null?void 0:l.originalTransactionId)||(l==null?void 0:l.reference)||(l==null?void 0:l.transactionReference)||((c=l==null?void 0:l.receipt)==null?void 0:c.reference)||`${(l==null?void 0:l.type)||"tx"}-${new Date((l==null?void 0:l.createdAt)||Date.now()).getTime()}`)},i=s(e),o=n.filter(l=>s(l)!==i),a=[e,...o].slice(0,r);localStorage.setItem(`localReceipts_${t}`,JSON.stringify(a))}catch{}},removeLocalReceiptById(t,e){try{const r=this.getLocalReceipts(t).filter(s=>{var o,a;return![s==null?void 0:s.id,s==null?void 0:s.transactionId,s==null?void 0:s.originalTransactionId,(o=s==null?void 0:s.receipt)==null?void 0:o.transactionId,(a=s==null?void 0:s.receipt)==null?void 0:a.id].map(l=>String(l||"")).includes(String(e))});localStorage.setItem(`localReceipts_${t}`,JSON.stringify(r))}catch{}},removeLocalReceiptByRef(t,e){try{if(!e)return;const r=this.getLocalReceipts(t).filter(s=>{var o;return![s==null?void 0:s.reference,s==null?void 0:s.transactionReference,(o=s==null?void 0:s.receipt)==null?void 0:o.reference].map(a=>String(a||"")).includes(String(e))});localStorage.setItem(`localReceipts_${t}`,JSON.stringify(r))}catch{}},async syncDeletedTransactionsLocal(t){try{const e=Ye(Ae(F,"deletedTransactions"),Ne("userId","==",t));(await Ze(e)).docs.forEach(r=>{const s=r.data();if(!((s==null?void 0:s.permanent)===!0))return;const o=String((s==null?void 0:s.originalTransactionId)||""),a=String((s==null?void 0:s.transactionId)||""),l=String((s==null?void 0:s.reference)||"");o&&this.removeLocalReceiptById(t,o),a&&this.removeLocalReceiptById(t,a),l&&this.removeLocalReceiptByRef(t,l)})}catch(e){console.warn("syncDeletedTransactionsLocal failed:",e)}},async factoryResetUserData(t,e){const n={},r=[],s=(e==null?void 0:e.excludeProducts)??!1,i=async(u,d)=>{if(u.length===0)return 0;const m=400;let p=0;try{for(let v=0;v<u.length;v+=m){const g=kv(F),E=u.slice(v,v+m);E.forEach(b=>{g.delete(b.ref)}),await g.commit(),p+=E.length,console.log(` Deleted ${E.length} docs from ${d} (Batch ${Math.floor(v/m)+1})`)}}catch(v){console.error(`Error batch deleting ${d}:`,v),r.push(`${d}: ${(v==null?void 0:v.message)||String(v)}`)}return p},o=async(u,d,m)=>{try{const p=Ye(Ae(F,u),Ne(d,"==",m)),v=await Ze(p);v.empty||await i(v.docs,`${u}:${d}`),n[`${u}:${d}`]=(n[`${u}:${d}`]||0)+v.size}catch(p){console.error(`factoryResetUserData client: error deleting from ${u} by ${d}=`,p),r.push(`${u}:${d}: ${(p==null?void 0:p.message)||String(p)}`)}};let a=null;try{const u=await Sn(ye(F,"profiles",t));if(u.exists()){const d=u.data();d!=null&&d.shopId&&(a=String(d.shopId))}}catch(u){console.warn("factoryResetUserData client: failed to fetch profile for shopId:",u)}await o("userTransactions","userId",t),await o("userTransactions","merchantUserId",t),await o("userTransactions","createdBy",t),await o("transactions","userId",t),await o("transactions","createdBy",t),await o("deletedTransactions","userId",t),await o("daily_reports_archive","userId",t),await o("deletedDailyArchives","userId",t),await o("adslReceipts","userId",t),await o("simCardReceipts","userId",t),await o("adslCards","userId",t),await o("simCards","userId",t),await o("distributors","userId",t),await o("simCardRequests","userId",t),await o("pendingTransactions","userId",t),await o("pendingOperations","userId",t),await o("notifications","userId",t),await o("wallets","userId",t),await o("wallets","merchantUserId",t),await o("dailySales","userId",t),await o("products","userId",t),await o("debts","userId",t),await o("installments","userId",t),a?(await o("shop_expenses","userId",t),await o("deficiencies","userId",t),await o("categories","userId",t)):(await o("shop_expenses","userId",t),await o("deficiencies","userId",t),await o("categories","shopId",t)),await o("fawry_terminals","userId",t),await o("maintenance_items","userId",t),await o("maintenance_pending","userId",t),await o("maintenance_done","userId",t);try{const u=await Ze(Ae(F,"users",t,"maintenance_waste"));u.empty||await i(u.docs,"users/maintenance_waste"),n["users/maintenance_waste"]=(n["users/maintenance_waste"]||0)+u.size}catch(u){console.error("factoryResetUserData client: error deleting maintenance_waste:",u),r.push(`users/maintenance_waste: ${(u==null?void 0:u.message)||String(u)}`)}await o("expenses","userId",t),await o("sales","userId",t),await o("cashSummaries","userId",t),await o("deviceTokens","userId",t);try{const u=ye(F,"users",t);await rn(u,{cashBalance:0,walletBalances:{},debts:[],debtsDeletedAt:$e(),reportsData:{},lastUpdated:new Date().toISOString()},{merge:!0}),n["users:embedded"]=(n["users:embedded"]||0)+1}catch(u){console.error("factoryResetUserData client: error clearing embedded user fields:",u),r.push(`users:embedded: ${(u==null?void 0:u.message)||String(u)}`)}try{const u=await Ze(Ae(F,"users",t,"debts"));u.empty||await i(u.docs,"users/debts"),n["users/debts"]=(n["users/debts"]||0)+u.size}catch(u){console.error("factoryResetUserData client: error deleting debts subcollection:",u),r.push(`users/debts: ${(u==null?void 0:u.message)||String(u)}`)}try{const u=await Ze(Ae(F,"users",t,"dailySales"));u.empty||await i(u.docs,"users/dailySales"),n["users/dailySales"]=(n["users/dailySales"]||0)+u.size}catch(u){console.error("factoryResetUserData client: error deleting dailySales subcollection:",u),r.push(`users/dailySales: ${(u==null?void 0:u.message)||String(u)}`)}const l=[];try{const u=await Ze(Ye(Ae(F,"merchantWallets"),Ne("merchantUserId","==",t)));u.empty||(u.docs.forEach(d=>l.push(d.id)),await i(u.docs,"merchantWallets")),n["merchantWallets:merchantUserId"]=(n["merchantWallets:merchantUserId"]||0)+u.size}catch(u){console.error("factoryResetUserData client: error deleting merchantWallets:",u),r.push(`merchantWallets:merchantUserId: ${(u==null?void 0:u.message)||String(u)}`)}try{const u=await Ze(Ae(F,"users",t,"wallets"));u.empty||(u.docs.forEach(d=>l.push(d.id)),await i(u.docs,"users/wallets")),n["users/wallets"]=(n["users/wallets"]||0)+u.size}catch(u){console.error("factoryResetUserData client: error deleting user wallets subcollection:",u),r.push(`users/wallets: ${(u==null?void 0:u.message)||String(u)}`)}const c=Array.from(new Set(l));for(const u of c){try{await Wn(ye(F,"walletLimits",u)),n["walletLimits:doc"]=(n["walletLimits:doc"]||0)+1}catch(d){console.warn("factoryResetUserData client: error deleting walletLimits doc:",d),r.push(`walletLimits:doc:${u}: ${(d==null?void 0:d.message)||String(d)}`)}try{await Wn(ye(F,"walletDailyLimits",u)),n["walletDailyLimits:doc"]=(n["walletDailyLimits:doc"]||0)+1}catch(d){console.warn("factoryResetUserData client: error deleting walletDailyLimits doc:",d),r.push(`walletDailyLimits:doc:${u}: ${(d==null?void 0:d.message)||String(d)}`)}}if(await o("walletLimits","ownerId",t),await o("walletDailyLimits","ownerId",t),await o("walletLimits","userId",t),await o("walletDailyLimits","userId",t),a)try{await rn(ye(F,"dashboardData",a),{cashBalance:0,walletBalances:{},lastUpdated:new Date().toISOString()},{merge:!0}),n["dashboardData:shop"]=(n["dashboardData:shop"]||0)+1,await rn(ye(F,"shops",a),{cashBalance:0,walletBalances:{},lastUpdated:new Date().toISOString()},{merge:!0})}catch(u){console.error("factoryResetUserData client: error resetting dashboardData:",u),r.push(`dashboardData:shop:${a}: ${(u==null?void 0:u.message)||String(u)}`)}try{const u=ye(F,"users",t);await xn(u,{cashBalance:0,walletBalances:{},debts:[],debtsDeletedAt:$e(),reportsData:{},lastUpdated:new Date().toISOString()}),n["users:reset_balances"]=(n["users:reset_balances"]||0)+1}catch(u){console.error("factoryResetUserData client: error resetting user balances:",u);try{await rn(ye(F,"users",t),{cashBalance:0,walletBalances:{},debts:[],debtsDeletedAt:$e(),reportsData:{},lastUpdated:new Date().toISOString(),createdAt:$e()},{merge:!0})}catch{r.push(`users:reset_balances: ${(u==null?void 0:u.message)||String(u)}`)}}try{const u=typeof localStorage<"u"?localStorage:null;if(u){const d=[];for(let m=0;m<u.length;m++){const p=u.key(m);p&&(p.includes(t)||p.startsWith("cashBalance_")||p.startsWith("walletBalances_")||p.startsWith("walletBalances_backup_")||p.startsWith("debts_")||!s&&p.startsWith("shopProducts_")||p.startsWith("deficiencies_"))&&d.push(p)}d.forEach(m=>{try{u.removeItem(m)}catch{}})}}catch(u){console.warn("factoryResetUserData client: failed to cleanup localStorage:",u)}try{await Vs(Ae(F,"factoryResets"),{userId:t,summary:n,errors:r,createdAt:$e()})}catch(u){console.warn("factoryResetUserData client: failed to log factory reset:",u)}return{success:r.length===0,summary:n,errors:r}},async saveUserData(t,e){try{const n=ye(F,"users",t),r=ol(e);await rn(n,{...r||{},updatedAt:$e()},{merge:!0})}catch(n){throw console.error("Error saving user data:",n),n}},async updateUserData(t,e){try{console.log("      Firebase:",{userId:t,data:e}),typeof e.cashBalance=="number"&&(e.cashBalance=Math.round(e.cashBalance));const n=ye(F,"users",t),r=Object.fromEntries(Object.entries(e).filter(([l,c])=>c!==void 0)),s=ol(r);let i={};try{const l=await Sn(n);i=l.exists()?l.data():{},console.log("  :",i)}catch(l){console.warn("         :",l)}const o={...i,...s,updatedAt:$e()};console.log("   :",o);let a=3;for(;a>0;)try{await rn(n,o,{merge:!0}),console.log("     ");try{const l=await tf.getById(t);if(l!=null&&l.shopId){const c={};if(o.cashBalance!==void 0&&(c.cashBalance=o.cashBalance),o.walletBalances!==void 0&&(c.walletBalances=o.walletBalances),Object.keys(c).length>0){const u=ye(F,"dashboardData",l.shopId);await rn(u,c,{merge:!0}),console.log("     dashboardData ")}}}catch(l){console.warn("   dashboardData ( ):",l)}return}catch(l){if(a--,console.warn(`     : ${a}`,l),a===0)throw l;await new Promise(c=>setTimeout(c,1e3))}}catch(n){throw console.error("     :",n),n instanceof Error&&(n.message.includes("network")?console.error("    -    "):n.message.includes("permission")?console.error("    -    Firestore"):n.message.includes("quota")&&console.error("     -    Firebase")),n}},async getUserWallets(t){try{const e=await this.getUserData(t);return(e==null?void 0:e.wallets)||[]}catch(e){return console.error("Error getting user wallets:",e),[]}},async getUserTransactions(t){try{const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),1);let r;try{const u=Ye(Ae(F,"userTransactions"),Ne("userId","==",t),Ne("createdAt",">=",n),Gs("createdAt","desc"));r=await Ze(u)}catch(u){console.warn(" getUserTransactions ordered query failed, falling back to unordered date range. Index might be missing.",u);const d=Ye(Ae(F,"userTransactions"),Ne("userId","==",t),Ne("createdAt",">=",n));r=await Ze(d)}const s=r.docs.map(u=>({id:u.id,...u.data(),createdAt:Tt(u.data().createdAt)})),i=this.getLocalReceipts(t),o=[...s,...i].filter(u=>(u.createdAt instanceof Date?u.createdAt:new Date(u.createdAt))>=n),a=u=>{var d;return String((u==null?void 0:u.id)||(u==null?void 0:u.transactionId)||(u==null?void 0:u.originalTransactionId)||(u==null?void 0:u.reference)||(u==null?void 0:u.transactionReference)||((d=u==null?void 0:u.receipt)==null?void 0:d.reference)||`${(u==null?void 0:u.type)||"tx"}-${new Date((u==null?void 0:u.createdAt)||0).getTime()}`)},l=new Set;return o.filter(u=>{const d=a(u);return l.has(d)?!1:(l.add(d),!0)}).filter(u=>(u==null?void 0:u.status)!=="cancelled"&&!(u!=null&&u.isDeleted)).sort((u,d)=>{const m=u.createdAt?new Date(u.createdAt).getTime():0;return(d.createdAt?new Date(d.createdAt).getTime():0)-m})}catch(e){console.error("Error getting user transactions:",e);const n=(e==null?void 0:e.code)||"";if(n==="permission-denied"||n==="unauthenticated")throw e;return[]}},async getUserTransactionsForDateRange(t,e,n){try{const r=Ye(Ae(F,"userTransactions"),Ne("userId","==",t),Ne("createdAt",">=",e),Ne("createdAt","<=",n),Gs("createdAt","desc"));return(await Ze(r)).docs.map(o=>({id:o.id,...o.data(),createdAt:Tt(o.data().createdAt)}))}catch(r){console.warn("Error fetching transactions for date range:",r);try{const s=Ye(Ae(F,"userTransactions"),Ne("userId","==",t),Ne("createdAt",">=",e),Ne("createdAt","<=",n));return(await Ze(s)).docs.map(a=>({id:a.id,...a.data(),createdAt:Tt(a.data().createdAt)})).sort((a,l)=>l.createdAt.getTime()-a.createdAt.getTime())}catch(s){return console.error("Fallback query failed:",s),[]}}},subscribeToUserTransactions(t,e,n=30){try{const r=Ye(Ae(F,"userTransactions"),Ne("userId","==",t),Gs("createdAt","desc"),Uo(n));return $o(r,s=>{const i=s.docs.map(o=>({id:o.id,...o.data(),createdAt:Tt(o.data().createdAt)}));e(i)},s=>{console.error("Error in transactions subscription:",s)})}catch(r){return console.error("Error setting up subscription:",r),()=>{}}},subscribeToDashboardData(t,e){try{const n=ye(F,"dashboardData",t);return $o(n,r=>{r.exists()?e(r.data()):e({})},r=>{console.error("Error in dashboard data subscription:",r)})}catch(n){return console.error("Error setting up dashboard subscription:",n),()=>{}}},async saveUserTransaction(t,e){var n,r;try{const s=Object.fromEntries(Object.entries(e??{}).filter(([o,a])=>a!==void 0));try{const o=s.reference;if(o){const a=Ye(Ae(F,"deletedTransactions"),Ne("userId","==",t),Ne("reference","==",o));if(!(await Ze(a)).empty)return console.log("          ."),"skip-deleted"}{const a=Ye(Ae(F,"deletedTransactions"),Ne("userId","==",t),Ne("permanent","==",!0)),l=await Ze(a);if(!l.empty){const c=[s.id,s.transactionId,s.originalTransactionId,(n=s.receipt)==null?void 0:n.id,(r=s.receipt)==null?void 0:r.transactionId,s.reference,s.transactionReference].filter(d=>!!d).map(d=>String(d));if(l.docs.find(d=>{const m=d.data(),p=String(m.originalTransactionId||m.transactionId||d.id||""),v=String(m.reference||"");return p&&c.includes(p)||v&&c.includes(v)}))return console.log("        /   ."),"skip-deleted"}}}catch(o){console.warn("           :",o)}try{const o=Ye(Ae(F,"userTransactions"),Ne("userId","==",t));if(s.transactionId){const b=Ye(Ae(F,"userTransactions"),Ne("userId","==",t),Ne("transactionId","==",s.transactionId)),_=await Ze(b);if(!_.empty){const S=_.docs[0];return await xn(ye(F,"userTransactions",S.id),{...s,uploadedAt:$e()}),S.id}}if(s.reference){const b=Ye(Ae(F,"userTransactions"),Ne("userId","==",t),Ne("reference","==",s.reference)),_=await Ze(b);if(!_.empty){const S=_.docs[0];return await xn(ye(F,"userTransactions",S.id),{...s,uploadedAt:$e()}),S.id}}const a=Ye(Ae(F,"userTransactions"),Ne("userId","==",t),Gs("createdAt","desc"),Uo(10)),l=await Ze(a),c=s.type||s.txnType,u=Number(s.amount||0),d=s.senderName,m=s.senderMsisdn||s.senderPhone||s.sender_msisdn,p=s.receiverMsisdn||s.receiverPhone||s.receiver_msisdn,v=s.createdAt?new Date(String(s.createdAt)):new Date,g=60*1e3,E=l.docs.find(b=>{const _=b.data(),S=_.type||_.txnType,P=Number(_.amount||0),T=_.senderName,N=_.senderMsisdn||_.senderPhone||_.sender_msisdn,I=_.receiverMsisdn||_.receiverPhone||_.receiver_msisdn,A=Tt(_.createdAt);return!(Math.abs(A.getTime()-v.getTime())<=g)||P!==u||S!==c?!1:c==="machine_withdrawal"?T===d:N===m&&I===p});if(E)return console.log("            :",E.id),await xn(ye(F,"userTransactions",E.id),{...s,uploadedAt:$e()}),E.id}catch(o){console.warn("      saveUserTransaction  :",o)}return(await Vs(Ae(F,"userTransactions"),{...s,userId:t,createdAt:s.createdAt?s.createdAt instanceof Date?s.createdAt:new Date(String(s.createdAt)):$e(),uploadedAt:$e()})).id}catch(s){throw console.error("Error saving user transaction:",s),s}},async removeUserTransaction(t,e){try{console.log("     userTransactions:",{userId:t,transactionId:e});try{const o=ye(F,"userTransactions",e),a=await Sn(o);if(a.exists()){const l=a.data();if([l==null?void 0:l.userId,l==null?void 0:l.merchantUserId,l==null?void 0:l.createdBy].map(u=>String(u||"")).includes(String(t))){console.log("    userTransactions  ( ):",e),await Wn(o),console.log("     userTransactions");try{this.removeLocalReceiptById(t,e)}catch{}return}else console.log("           ")}}catch(o){console.warn("     userTransactions   :",o)}const n=Ye(Ae(F,"userTransactions"),Ne("userId","==",t)),r=await Ze(n);console.log(`    ${r.docs.length}  `);const s=r.docs.filter(o=>{var d,m;const a=o.data(),l=o.id,u=[a.id===e,a.transactionId===e,l===e,a.originalTransactionId===e,((d=a.receipt)==null?void 0:d.transactionId)===e,((m=a.receipt)==null?void 0:m.id)===e].some(p=>p===!0);return u&&console.log("     :",{docId:l,dataId:a.id,transactionId:a.transactionId,originalTransactionId:a.originalTransactionId,searchingFor:e}),u}),i=[Ye(Ae(F,"userTransactions"),Ne("merchantUserId","==",t)),Ye(Ae(F,"userTransactions"),Ne("createdBy","==",t))];for(const o of i)try{const l=(await Ze(o)).docs.filter(c=>{var m,p;const u=c.data(),d=c.id;return u.id===e||u.transactionId===e||d===e||u.originalTransactionId===e||((m=u.receipt)==null?void 0:m.transactionId)===e||((p=u.receipt)==null?void 0:p.id)===e});l.length&&(console.log(`   ${l.length}       `),s.push(...l))}catch{}if(s.length>0){console.log(`   ${s.length}    `);const o=s.map(async a=>{try{console.log("   :",a.id),await Wn(a.ref)}catch(l){console.warn("     userTransactions ():",{id:a.id,error:l})}});await Promise.allSettled(o);try{this.removeLocalReceiptById(t,e)}catch{}console.log("        userTransactions:",e);try{const a=ye(F,"transactions",e);if((await Sn(a)).exists())console.log("     transactions   "),await Wn(a);else{const c=Ye(Ae(F,"transactions"),Ne("transactionId","==",e)),u=await Ze(c);u.empty||(console.log(`   ${u.size}   transactions  transactionId `),await Promise.all(u.docs.map(p=>Wn(p.ref))));const d=Ye(Ae(F,"transactions"),Ne("originalTransactionId","==",e)),m=await Ze(d);m.empty||(console.log(`   ${m.size}   transactions  originalTransactionId `),await Promise.all(m.docs.map(p=>Wn(p.ref))))}}catch(a){console.warn("      transactions   :",a)}return}console.log("       userTransactions (   ):",e)}catch(n){console.error("      userTransactions ():",n);return}}},ab={async getToday(t){const e=ye(F,"dailyStats",t,"today","data"),n=await Sn(e);return n.exists()?n.data():{}},async setToday(t,e){const n=ye(F,"dailyStats",t,"today","data");await rn(n,{...ol(e),updatedAt:new Date},{merge:!0})},async saveToHistory(t,e,n){const r=ye(F,"dailyStats",t,"history",e);await rn(r,ol(n),{merge:!0})},async archiveTodayToHistory(t,e){const n=await this.getToday(t);await this.saveToHistory(t,e,n||{})}},EX={async create(t,e){const n={...e,userId:t,status:"active",createdAt:$e()};return(await Vs(Ae(F,"installments"),n)).id},async getByUser(t){try{const e=Ye(Ae(F,"installments"),Ne("userId","==",t));return(await Ze(e)).docs.map(r=>({id:r.id,...r.data()}))}catch(e){return console.error("installments fetch error",e),[]}},async markMonthPaid(t,e){const n=e.every(r=>r.paid);return await xn(ye(F,"installments",t),{paidMonths:e,status:n?"completed":"active"}),!0},async remove(t){return await Wn(ye(F,"installments",t)),!0}},mo=Object.freeze(Object.defineProperty({__proto__:null,InstallmentsService:EX,auditLogService:bX,dailyReportsArchiveService:dV,dailyStatsService:ab,merchantWalletService:ka,profileService:tf,profileServiceExtra:cV,recordAutoTransaction:vX,referralService:ob,sanitizeFirestoreData:ol,systemSettingsService:uV,telegramNotifier:_X,transactionService:uI,transactionServiceExtra:lV,userDataService:hr},Symbol.toStringTag,{value:"Module"}));var Fl=(t=>(t.MONTHLY="monthly",t.QUARTERLY="quarterly",t.HALF_YEARLY="half_yearly",t.YEARLY="yearly",t.LIFETIME="lifetime",t.ZERO="zero",t.TAHWEELA="tahweela",t.FIVE_MINUTES="five_minutes",t.BRANCH="branch",t))(Fl||{});const ic=t=>{if(!t)return null;if(t instanceof Date)return isNaN(t.getTime())?null:t;if(t.toDate&&typeof t.toDate=="function")return t.toDate();if(t.seconds!==void 0&&typeof t.seconds=="number")return new Date(t.seconds*1e3);const e=new Date(t);return isNaN(e.getTime())?null:e},SX=(t,e=new Date)=>{const n=ic(e)||new Date;switch(t){case"monthly":{const r=new Date(n);return r.setDate(r.getDate()+30),r}case"five_minutes":{const r=new Date(n);return r.setMinutes(r.getMinutes()+5),r}case"tahweela":{const r=new Date(n);return r.setDate(r.getDate()+30),r}case"quarterly":{const r=new Date(n);return r.setDate(r.getDate()+90),r}case"half_yearly":{const r=new Date(n);return r.setDate(r.getDate()+180),r}case"yearly":{const r=new Date(n);return r.setDate(r.getDate()+365),r}case"lifetime":return null;case"zero":return null;default:return null}},aP=t=>{if(!t||!t.isActive)return!1;if(t.planType==="lifetime")return!0;if(!t.endDate){const r=new Date,s=ic(t.activatedAt);return s&&r.getTime()-s.getTime()<4*60*60*1e3,!0}const e=new Date,n=ic(t.endDate);if(!n){const r=ic(t.activatedAt);return r&&e.getTime()-r.getTime()<4*60*60*1e3,!0}return e<=n},IX=t=>{if(!t||!t.isActive)return null;if(t.planType==="lifetime")return-1;if(!t.endDate)return null;const e=new Date,n=ic(t.endDate);if(!n)return null;const r=n.getTime()-e.getTime(),s=Math.ceil(r/(1e3*60*60*24));return s>0?s:0},Zte=async(t,e,n,r,s,i)=>{try{const o=s||new Date,a=i||SX(e,o),l={planType:e,startDate:o,endDate:a,isActive:!0,activatedBy:n,activatedAt:new Date};console.log(" Activating subscription for user:",{userId:t,planType:e,adminId:n,subscriptionData:l});const c=ye(F,"users",t);await xn(c,{subscription:l,isActive:!0,approved:!0,isOnFreeTrial:!1,freeTrialStartDate:null,freeTrialEndDate:null,updatedAt:new Date});try{const u=await Sn(c);if(u.exists()){const d=u.data();if(d.ownerId){const m=d.ownerId;try{const p=ye(F,"users",m,"branches",t);await xn(p,{isActive:!0,updatedAt:new Date})}catch(p){console.warn("Could not update branch reference in parent subcollection",p)}}}}catch(u){console.warn("Error syncing branch status to parent:",u)}if(console.log(" Subscription data updated in Firestore"),typeof window<"u"){const u=new CustomEvent("subscriptionActivated",{detail:{userId:t,planType:e,timestamp:new Date().toISOString()}});window.dispatchEvent(u),console.log(" Subscription activation event dispatched:",{userId:t,planType:e});const d=new CustomEvent("userSubscriptionUpdated",{detail:{userId:t,planType:e,isActive:!0,timestamp:new Date().toISOString()}});window.dispatchEvent(d),console.log(" Global subscription update event dispatched")}console.log(`    ${e}  ${t}`)}catch(o){throw console.error("    :",o),new Error("   ")}},ene=async t=>{try{const e=kv(F),n=ye(F,"users",t);e.update(n,{"subscription.isActive":!1,isActive:!1,"branchPackage.status":"canceled","branchPackage.canceledAt":new Date,isOnFreeTrial:!1,freeTrialStartDate:null,freeTrialEndDate:null,updatedAt:new Date});const r=Ye(Ae(F,"users"),Ne("ownerId","==",t)),s=await Ze(r);s.forEach(i=>{e.update(i.ref,{isActive:!1,"subscription.isActive":!1,updatedAt:new Date})}),await e.commit(),console.log(`      ${t}   (${s.size})`)}catch(e){throw console.error("     :",e),new Error("    ")}},TX=async t=>{try{const e=kv(F),n=ye(F,"users",t);e.update(n,{"branchPackage.status":"expired","branchPackage.expiredAt":new Date,updatedAt:new Date});const r=Ye(Ae(F,"users"),Ne("ownerId","==",t));(await Ze(r)).forEach(i=>{e.update(i.ref,{isActive:!1,updatedAt:new Date})}),await e.commit(),console.log(` Branch package expired for user ${t}`)}catch(e){console.error("Failed to expire branch package:",e)}},xX=async(t,e)=>{if((e==null?void 0:e.status)!=="active"||!e.endDate)return;const n=ic(e.endDate);n&&new Date>n&&(console.log(`Branch package expired for user ${t}. Deactivating...`),await TX(t))},AX=async t=>{try{const e=ye(F,"users",t),n=await Sn(e);return n.exists()&&n.data().subscription||null}catch(e){return console.error("      :",e),null}},tne=t=>{switch(t){case"monthly":return"";case"quarterly":return" ";case"half_yearly":return" ";case"yearly":return"";case"lifetime":return" ";case"zero":return"";case"tahweela":return"";case"five_minutes":return"5 ";case"branch":return" ";default:return" "}},nne=t=>{if(!t)return"text-gray-500";if(!t.isActive)return"text-red-500";if(t.planType==="lifetime")return"text-green-600";const e=IX(t);return e===null||e<=0?"text-red-500":e<=7?"text-yellow-500":"text-green-500"},PX=t=>{const e=ic(t);return e?e.toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"}):" "};/*! Capacitor: https://capacitorjs.com/ - MIT License */const RX=t=>{const e=new Map;e.set("web",{name:"web"});const n=t.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},r=(i,o)=>{n.platforms.set(i,o)},s=i=>{n.platforms.has(i)&&(n.currentPlatform=n.platforms.get(i))};return n.addPlatform=r,n.setPlatform=s,n},CX=t=>t.CapacitorPlatforms=RX(t),hV=CX(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});hV.addPlatform;hV.setPlatform;var Ed;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Ed||(Ed={}));class Jw extends Error{constructor(e,n,r){super(e),this.message=e,this.code=n,this.data=r}}const NX=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},kX=t=>{var e,n,r,s,i;const o=t.CapacitorCustomPlatform||null,a=t.Capacitor||{},l=a.Plugins=a.Plugins||{},c=t.CapacitorPlatforms,u=()=>o!==null?o.name:NX(t),d=((e=c==null?void 0:c.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||u,m=()=>d()!=="web",p=((n=c==null?void 0:c.currentPlatform)===null||n===void 0?void 0:n.isNativePlatform)||m,v=I=>{const A=P.get(I);return!!(A!=null&&A.platforms.has(d())||b(I))},g=((r=c==null?void 0:c.currentPlatform)===null||r===void 0?void 0:r.isPluginAvailable)||v,E=I=>{var A;return(A=a.PluginHeaders)===null||A===void 0?void 0:A.find(R=>R.name===I)},b=((s=c==null?void 0:c.currentPlatform)===null||s===void 0?void 0:s.getPluginHeader)||E,_=I=>t.console.error(I),S=(I,A,R)=>Promise.reject(`${R} does not have an implementation of "${A}".`),P=new Map,T=(I,A={})=>{const R=P.get(I);if(R)return console.warn(`Capacitor plugin "${I}" already registered. Cannot register plugins twice.`),R.proxy;const k=d(),C=b(I);let L;const O=async()=>(!L&&k in A?L=typeof A[k]=="function"?L=await A[k]():L=A[k]:o!==null&&!L&&"web"in A&&(L=typeof A.web=="function"?L=await A.web():L=A.web),L),X=(ae,pe)=>{var fe,Ge;if(C){const xe=C==null?void 0:C.methods.find(ve=>pe===ve.name);if(xe)return xe.rtype==="promise"?ve=>a.nativePromise(I,pe.toString(),ve):(ve,Q)=>a.nativeCallback(I,pe.toString(),ve,Q);if(ae)return(fe=ae[pe])===null||fe===void 0?void 0:fe.bind(ae)}else{if(ae)return(Ge=ae[pe])===null||Ge===void 0?void 0:Ge.bind(ae);throw new Jw(`"${I}" plugin is not implemented on ${k}`,Ed.Unimplemented)}},ke=ae=>{let pe;const fe=(...Ge)=>{const xe=O().then(ve=>{const Q=X(ve,ae);if(Q){const qe=Q(...Ge);return pe=qe==null?void 0:qe.remove,qe}else throw new Jw(`"${I}.${ae}()" is not implemented on ${k}`,Ed.Unimplemented)});return ae==="addListener"&&(xe.remove=async()=>pe()),xe};return fe.toString=()=>`${ae.toString()}() { [capacitor code] }`,Object.defineProperty(fe,"name",{value:ae,writable:!1,configurable:!1}),fe},Oe=ke("addListener"),je=ke("removeListener"),W=(ae,pe)=>{const fe=Oe({eventName:ae},pe),Ge=async()=>{const ve=await fe;je({eventName:ae,callbackId:ve},pe)},xe=new Promise(ve=>fe.then(()=>ve({remove:Ge})));return xe.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await Ge()},xe},G=new Proxy({},{get(ae,pe){switch(pe){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return C?W:Oe;case"removeListener":return je;default:return ke(pe)}}});return l[I]=G,P.set(I,{name:I,proxy:G,platforms:new Set([...Object.keys(A),...C?[k]:[]])}),G},N=((i=c==null?void 0:c.currentPlatform)===null||i===void 0?void 0:i.registerPlugin)||T;return a.convertFileSrc||(a.convertFileSrc=I=>I),a.getPlatform=d,a.handleError=_,a.isNativePlatform=p,a.isPluginAvailable=g,a.pluginMethodNoop=S,a.registerPlugin=N,a.Exception=Jw,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a.platform=a.getPlatform(),a.isNative=a.isNativePlatform(),a},DX=t=>t.Capacitor=kX(t),ge=DX(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Yd=ge.registerPlugin;ge.Plugins;class fV{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,n){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(n);const s=this.windowListeners[e];s&&!s.registered&&this.addWindowListener(s);const i=async()=>this.removeListener(e,n),o=Promise.resolve({remove:i});return Object.defineProperty(o,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await i()}}),o}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n){const r=this.listeners[e];r&&r.forEach(s=>s(n))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(e="not implemented"){return new ge.Exception(e,Ed.Unimplemented)}unavailable(e="not available"){return new ge.Exception(e,Ed.Unavailable)}async removeListener(e,n){const r=this.listeners[e];if(!r)return;const s=r.indexOf(n);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}const lP=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),cP=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class OX extends fV{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=cP(s).trim(),i=cP(i).trim(),n[s]=i}),n}async setCookie(e){try{const n=lP(e.key),r=lP(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${s}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Yd("CapacitorCookies",{web:()=>new OX});const LX=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>n(s),r.readAsDataURL(t)}),MX=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(s=>s.toLocaleLowerCase()).reduce((s,i,o)=>(s[i]=t[e[o]],s),{})},VX=(t,e=!0)=>t?Object.entries(t).reduce((r,s)=>{const[i,o]=s;let a,l;return Array.isArray(o)?(l="",o.forEach(c=>{a=e?encodeURIComponent(c):c,l+=`${i}=${a}&`}),l.slice(0,-1)):(a=e?encodeURIComponent(o):o,l=`${i}=${a}`),`${r}&${l}`},"").substr(1):null,jX=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),s=MX(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(s.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,a]of Object.entries(t.data||{}))i.set(o,a);n.body=i.toString()}else if(s.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((a,l)=>{i.append(l,a)});else for(const a of Object.keys(t.data))i.append(a,t.data[a]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(s.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class FX extends fV{async request(e){const n=jX(e,e.webFetchExtra),r=VX(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,i=await fetch(s,n),o=i.headers.get("content-type")||"";let{responseType:a="text"}=i.ok?e:{};o.includes("application/json")&&(a="json");let l,c;switch(a){case"arraybuffer":case"blob":c=await i.blob(),l=await LX(c);break;case"json":l=await i.json();break;case"document":case"text":default:l=await i.text()}const u={};return i.headers.forEach((d,m)=>{u[m]=d}),{data:l,headers:u,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Yd("CapacitorHttp",{web:()=>new FX});const Ul=Yd("Preferences",{web:()=>ee(()=>import("./web-B2x26q9g.js"),[],import.meta.url).then(t=>new t.PreferencesWeb)}),up=Object.freeze(Object.defineProperty({__proto__:null,Preferences:Ul},Symbol.toStringTag,{value:"Module"}));var UX=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],$X=UX.reduce((t,e)=>{const n=ND(`Primitive.${e}`),r=y.forwardRef((s,i)=>{const{asChild:o,...a}=s,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...a,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{}),BX="Label",mV=y.forwardRef((t,e)=>f.jsx($X.label,{...t,ref:e,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));mV.displayName=BX;var pV=mV;const zX=Uy("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),vr=y.forwardRef(({className:t,...e},n)=>f.jsx(pV,{ref:n,className:yn(zX(),t),...e}));vr.displayName=pV.displayName;var Xw="focusScope.autoFocusOnMount",Zw="focusScope.autoFocusOnUnmount",uP={bubbles:!1,cancelable:!0},WX="FocusScope",gV=y.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[a,l]=y.useState(null),c=jr(s),u=jr(i),d=y.useRef(null),m=Kn(e,g=>l(g)),p=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(r){let g=function(S){if(p.paused||!a)return;const P=S.target;a.contains(P)?d.current=P:la(d.current,{select:!0})},E=function(S){if(p.paused||!a)return;const P=S.relatedTarget;P!==null&&(a.contains(P)||la(d.current,{select:!0}))},b=function(S){if(document.activeElement===document.body)for(const T of S)T.removedNodes.length>0&&la(a)};document.addEventListener("focusin",g),document.addEventListener("focusout",E);const _=new MutationObserver(b);return a&&_.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",E),_.disconnect()}}},[r,a,p.paused]),y.useEffect(()=>{if(a){hP.add(p);const g=document.activeElement;if(!a.contains(g)){const b=new CustomEvent(Xw,uP);a.addEventListener(Xw,c),a.dispatchEvent(b),b.defaultPrevented||(qX(YX(yV(a)),{select:!0}),document.activeElement===g&&la(a))}return()=>{a.removeEventListener(Xw,c),setTimeout(()=>{const b=new CustomEvent(Zw,uP);a.addEventListener(Zw,u),a.dispatchEvent(b),b.defaultPrevented||la(g??document.body,{select:!0}),a.removeEventListener(Zw,u),hP.remove(p)},0)}}},[a,c,u,p]);const v=y.useCallback(g=>{if(!n&&!r||p.paused)return;const E=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,b=document.activeElement;if(E&&b){const _=g.currentTarget,[S,P]=HX(_);S&&P?!g.shiftKey&&b===P?(g.preventDefault(),n&&la(S,{select:!0})):g.shiftKey&&b===S&&(g.preventDefault(),n&&la(P,{select:!0})):b===_&&g.preventDefault()}},[n,r,p.paused]);return f.jsx(wn.div,{tabIndex:-1,...o,ref:m,onKeyDown:v})});gV.displayName=WX;function qX(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(la(r,{select:e}),document.activeElement!==n)return}function HX(t){const e=yV(t),n=dP(e,t),r=dP(e.reverse(),t);return[n,r]}function yV(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function dP(t,e){for(const n of t)if(!KX(n,{upTo:e}))return n}function KX(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function GX(t){return t instanceof HTMLInputElement&&"select"in t}function la(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&GX(t)&&e&&t.select()}}var hP=QX();function QX(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=fP(t,e),t.unshift(e)},remove(e){var n;t=fP(t,e),(n=t[0])==null||n.resume()}}}function fP(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function YX(t){return t.filter(e=>e.tagName!=="A")}var e_=0;function JX(){y.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??mP()),document.body.insertAdjacentElement("beforeend",t[1]??mP()),e_++,()=>{e_===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),e_--}},[])}function mP(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Bi=function(){return Bi=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Bi.apply(this,arguments)};function vV(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function XX(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var Yp="right-scroll-bar-position",Jp="width-before-scroll-bar",ZX="with-scroll-bars-hidden",eZ="--removed-body-scroll-bar-size";function t_(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function tZ(t,e){var n=y.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var nZ=typeof window<"u"?y.useLayoutEffect:y.useEffect,pP=new WeakMap;function rZ(t,e){var n=tZ(null,function(r){return t.forEach(function(s){return t_(s,r)})});return nZ(function(){var r=pP.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(a){i.has(a)||t_(a,null)}),i.forEach(function(a){s.has(a)||t_(a,o)})}pP.set(n,t)},[t]),n}function sZ(t){return t}function iZ(t,e){e===void 0&&(e=sZ);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return s}function oZ(t){t===void 0&&(t={});var e=iZ(null);return e.options=Bi({async:!0,ssr:!1},t),e}var wV=function(t){var e=t.sideCar,n=vV(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return y.createElement(r,Bi({},n))};wV.isSideCarExport=!0;function aZ(t,e){return t.useMedium(e),wV}var _V=oZ(),n_=function(){},Lv=y.forwardRef(function(t,e){var n=y.useRef(null),r=y.useState({onScrollCapture:n_,onWheelCapture:n_,onTouchMoveCapture:n_}),s=r[0],i=r[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,m=t.sideCar,p=t.noRelative,v=t.noIsolation,g=t.inert,E=t.allowPinchZoom,b=t.as,_=b===void 0?"div":b,S=t.gapMode,P=vV(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),T=m,N=rZ([n,e]),I=Bi(Bi({},P),s);return y.createElement(y.Fragment,null,u&&y.createElement(T,{sideCar:_V,removeScrollBar:c,shards:d,noRelative:p,noIsolation:v,inert:g,setCallbacks:i,allowPinchZoom:!!E,lockRef:n,gapMode:S}),o?y.cloneElement(y.Children.only(a),Bi(Bi({},I),{ref:N})):y.createElement(_,Bi({},I,{className:l,ref:N}),a))});Lv.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Lv.classNames={fullWidth:Jp,zeroRight:Yp};var lZ=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function cZ(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=lZ();return e&&t.setAttribute("nonce",e),t}function uZ(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function dZ(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var hZ=function(){var t=0,e=null;return{add:function(n){t==0&&(e=cZ())&&(uZ(e,n),dZ(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},fZ=function(){var t=hZ();return function(e,n){y.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},bV=function(){var t=fZ(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},mZ={left:0,top:0,right:0,gap:0},r_=function(t){return parseInt(t||"",10)||0},pZ=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[r_(n),r_(r),r_(s)]},gZ=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return mZ;var e=pZ(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},yZ=bV(),Du="data-scroll-locked",vZ=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(ZX,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(Du,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Yp,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Jp,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Yp," .").concat(Yp,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Jp," .").concat(Jp,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Du,`] {
    `).concat(eZ,": ").concat(a,`px;
  }
`)},gP=function(){var t=parseInt(document.body.getAttribute(Du)||"0",10);return isFinite(t)?t:0},wZ=function(){y.useEffect(function(){return document.body.setAttribute(Du,(gP()+1).toString()),function(){var t=gP()-1;t<=0?document.body.removeAttribute(Du):document.body.setAttribute(Du,t.toString())}},[])},_Z=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;wZ();var i=y.useMemo(function(){return gZ(s)},[s]);return y.createElement(yZ,{styles:vZ(i,!e,s,n?"":"!important")})},lb=!1;if(typeof window<"u")try{var dp=Object.defineProperty({},"passive",{get:function(){return lb=!0,!0}});window.addEventListener("test",dp,dp),window.removeEventListener("test",dp,dp)}catch{lb=!1}var Hc=lb?{passive:!1}:!1,bZ=function(t){return t.tagName==="TEXTAREA"},EV=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!bZ(t)&&n[e]==="visible")},EZ=function(t){return EV(t,"overflowY")},SZ=function(t){return EV(t,"overflowX")},yP=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=SV(t,r);if(s){var i=IV(t,r),o=i[1],a=i[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},IZ=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},TZ=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},SV=function(t,e){return t==="v"?EZ(e):SZ(e)},IV=function(t,e){return t==="v"?IZ(e):TZ(e)},xZ=function(t,e){return t==="h"&&e==="rtl"?-1:1},AZ=function(t,e,n,r,s){var i=xZ(t,window.getComputedStyle(e).direction),o=i*r,a=n.target,l=e.contains(a),c=!1,u=o>0,d=0,m=0;do{if(!a)break;var p=IV(t,a),v=p[0],g=p[1],E=p[2],b=g-E-i*v;(v||b)&&SV(t,a)&&(d+=b,m+=v);var _=a.parentNode;a=_&&_.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_.host:_}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&Math.abs(d)<1||!u&&Math.abs(m)<1)&&(c=!0),c},hp=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},vP=function(t){return[t.deltaX,t.deltaY]},wP=function(t){return t&&"current"in t?t.current:t},PZ=function(t,e){return t[0]===e[0]&&t[1]===e[1]},RZ=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},CZ=0,Kc=[];function NZ(t){var e=y.useRef([]),n=y.useRef([0,0]),r=y.useRef(),s=y.useState(CZ++)[0],i=y.useState(bV)[0],o=y.useRef(t);y.useEffect(function(){o.current=t},[t]),y.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var g=XX([t.lockRef.current],(t.shards||[]).map(wP),!0).filter(Boolean);return g.forEach(function(E){return E.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),g.forEach(function(E){return E.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var a=y.useCallback(function(g,E){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var b=hp(g),_=n.current,S="deltaX"in g?g.deltaX:_[0]-b[0],P="deltaY"in g?g.deltaY:_[1]-b[1],T,N=g.target,I=Math.abs(S)>Math.abs(P)?"h":"v";if("touches"in g&&I==="h"&&N.type==="range")return!1;var A=window.getSelection(),R=A&&A.anchorNode,k=R?R===N||R.contains(N):!1;if(k)return!1;var C=yP(I,N);if(!C)return!0;if(C?T=I:(T=I==="v"?"h":"v",C=yP(I,N)),!C)return!1;if(!r.current&&"changedTouches"in g&&(S||P)&&(r.current=T),!T)return!0;var L=r.current||T;return AZ(L,E,g,L==="h"?S:P)},[]),l=y.useCallback(function(g){var E=g;if(!(!Kc.length||Kc[Kc.length-1]!==i)){var b="deltaY"in E?vP(E):hp(E),_=e.current.filter(function(T){return T.name===E.type&&(T.target===E.target||E.target===T.shadowParent)&&PZ(T.delta,b)})[0];if(_&&_.should){E.cancelable&&E.preventDefault();return}if(!_){var S=(o.current.shards||[]).map(wP).filter(Boolean).filter(function(T){return T.contains(E.target)}),P=S.length>0?a(E,S[0]):!o.current.noIsolation;P&&E.cancelable&&E.preventDefault()}}},[]),c=y.useCallback(function(g,E,b,_){var S={name:g,delta:E,target:b,should:_,shadowParent:kZ(b)};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(P){return P!==S})},1)},[]),u=y.useCallback(function(g){n.current=hp(g),r.current=void 0},[]),d=y.useCallback(function(g){c(g.type,vP(g),g.target,a(g,t.lockRef.current))},[]),m=y.useCallback(function(g){c(g.type,hp(g),g.target,a(g,t.lockRef.current))},[]);y.useEffect(function(){return Kc.push(i),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:m}),document.addEventListener("wheel",l,Hc),document.addEventListener("touchmove",l,Hc),document.addEventListener("touchstart",u,Hc),function(){Kc=Kc.filter(function(g){return g!==i}),document.removeEventListener("wheel",l,Hc),document.removeEventListener("touchmove",l,Hc),document.removeEventListener("touchstart",u,Hc)}},[]);var p=t.removeScrollBar,v=t.inert;return y.createElement(y.Fragment,null,v?y.createElement(i,{styles:RZ(s)}):null,p?y.createElement(_Z,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function kZ(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const DZ=aZ(_V,NZ);var TV=y.forwardRef(function(t,e){return y.createElement(Lv,Bi({},t,{ref:e,sideCar:DZ}))});TV.classNames=Lv.classNames;var OZ=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Gc=new WeakMap,fp=new WeakMap,mp={},s_=0,xV=function(t){return t&&(t.host||xV(t.parentNode))},LZ=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=xV(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},MZ=function(t,e,n,r){var s=LZ(e,Array.isArray(t)?t:[t]);mp[n]||(mp[n]=new WeakMap);var i=mp[n],o=[],a=new Set,l=new Set(s),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(m){if(a.has(m))u(m);else try{var p=m.getAttribute(r),v=p!==null&&p!=="false",g=(Gc.get(m)||0)+1,E=(i.get(m)||0)+1;Gc.set(m,g),i.set(m,E),o.push(m),g===1&&v&&fp.set(m,!0),E===1&&m.setAttribute(n,"true"),v||m.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",m,b)}})};return u(e),a.clear(),s_++,function(){o.forEach(function(d){var m=Gc.get(d)-1,p=i.get(d)-1;Gc.set(d,m),i.set(d,p),m||(fp.has(d)||d.removeAttribute(r),fp.delete(d)),p||d.removeAttribute(n)}),s_--,s_||(Gc=new WeakMap,Gc=new WeakMap,fp=new WeakMap,mp={})}},VZ=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=OZ(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),MZ(r,s,n,"aria-hidden")):function(){return null}};function jZ(t){const e=FZ(t),n=y.forwardRef((r,s)=>{const{children:i,...o}=r,a=y.Children.toArray(i),l=a.find($Z);if(l){const c=l.props.children,u=a.map(d=>d===l?y.Children.count(c)>1?y.Children.only(null):y.isValidElement(c)?c.props.children:null:d);return f.jsx(e,{...o,ref:s,children:y.isValidElement(c)?y.cloneElement(c,void 0,u):null})}return f.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}function FZ(t){const e=y.forwardRef((n,r)=>{const{children:s,...i}=n;if(y.isValidElement(s)){const o=zZ(s),a=BZ(i,s.props);return s.type!==y.Fragment&&(a.ref=r?Xf(r,o):o),y.cloneElement(s,a)}return y.Children.count(s)>1?y.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var UZ=Symbol("radix.slottable");function $Z(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===UZ}function BZ(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function zZ(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Mv="Dialog",[AV,rne]=Ac(Mv),[WZ,Pi]=AV(Mv),PV=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,a=y.useRef(null),l=y.useRef(null),[c,u]=cE({prop:r,defaultProp:s??!1,onChange:i,caller:Mv});return f.jsx(WZ,{scope:e,triggerRef:a,contentRef:l,contentId:Iw(),titleId:Iw(),descriptionId:Iw(),open:c,onOpenChange:u,onOpenToggle:y.useCallback(()=>u(d=>!d),[u]),modal:o,children:n})};PV.displayName=Mv;var RV="DialogTrigger",CV=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Pi(RV,n),i=Kn(e,s.triggerRef);return f.jsx(wn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":fI(s.open),...r,ref:i,onClick:Zt(t.onClick,s.onOpenToggle)})});CV.displayName=RV;var dI="DialogPortal",[qZ,NV]=AV(dI,{forceMount:void 0}),kV=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=Pi(dI,e);return f.jsx(qZ,{scope:e,forceMount:n,children:y.Children.map(r,o=>f.jsx(Si,{present:n||i.open,children:f.jsx(lE,{asChild:!0,container:s,children:o})}))})};kV.displayName=dI;var hy="DialogOverlay",DV=y.forwardRef((t,e)=>{const n=NV(hy,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Pi(hy,t.__scopeDialog);return i.modal?f.jsx(Si,{present:r||i.open,children:f.jsx(KZ,{...s,ref:e})}):null});DV.displayName=hy;var HZ=jZ("DialogOverlay.RemoveScroll"),KZ=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Pi(hy,n);return f.jsx(TV,{as:HZ,allowPinchZoom:!0,shards:[s.contentRef],children:f.jsx(wn.div,{"data-state":fI(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Ic="DialogContent",OV=y.forwardRef((t,e)=>{const n=NV(Ic,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Pi(Ic,t.__scopeDialog);return f.jsx(Si,{present:r||i.open,children:i.modal?f.jsx(GZ,{...s,ref:e}):f.jsx(QZ,{...s,ref:e})})});OV.displayName=Ic;var GZ=y.forwardRef((t,e)=>{const n=Pi(Ic,t.__scopeDialog),r=y.useRef(null),s=Kn(e,n.contentRef,r);return y.useEffect(()=>{const i=r.current;if(i)return VZ(i)},[]),f.jsx(LV,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Zt(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Zt(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:Zt(t.onFocusOutside,i=>i.preventDefault())})}),QZ=y.forwardRef((t,e)=>{const n=Pi(Ic,t.__scopeDialog),r=y.useRef(!1),s=y.useRef(!1);return f.jsx(LV,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),LV=y.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,a=Pi(Ic,n),l=y.useRef(null),c=Kn(e,l);return JX(),f.jsxs(f.Fragment,{children:[f.jsx(gV,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(Vy,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":fI(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(YZ,{titleId:a.titleId}),f.jsx(XZ,{contentRef:l,descriptionId:a.descriptionId})]})]})}),hI="DialogTitle",MV=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Pi(hI,n);return f.jsx(wn.h2,{id:s.titleId,...r,ref:e})});MV.displayName=hI;var VV="DialogDescription",jV=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Pi(VV,n);return f.jsx(wn.p,{id:s.descriptionId,...r,ref:e})});jV.displayName=VV;var FV="DialogClose",UV=y.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Pi(FV,n);return f.jsx(wn.button,{type:"button",...r,ref:e,onClick:Zt(t.onClick,()=>s.onOpenChange(!1))})});UV.displayName=FV;function fI(t){return t?"open":"closed"}var $V="DialogTitleWarning",[sne,BV]=bU($V,{contentName:Ic,titleName:hI,docsSlug:"dialog"}),YZ=({titleId:t})=>{const e=BV($V),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return y.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},JZ="DialogDescriptionWarning",XZ=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${BV(JZ).contentName}}.`;return y.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},ZZ=PV,eee=CV,tee=kV,zV=DV,WV=OV,qV=MV,HV=jV,nee=UV;const Ha=ZZ,ine=eee,ree=tee,KV=y.forwardRef(({className:t,...e},n)=>f.jsx(zV,{ref:n,className:yn("fixed inset-0 z-[9998] bg-black/30 dark:bg-black backdrop-blur-[5px] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 radix-dialog-overlay",t),...e}));KV.displayName=zV.displayName;const Ro=y.forwardRef(({className:t,children:e,hideClose:n,disableOutsideClose:r,disableEscClose:s,overlayClassName:i,...o},a)=>f.jsxs(ree,{children:[f.jsx(KV,{className:i}),f.jsxs(WV,{ref:a,className:yn("fixed left-[50%] top-[50%] z-[9999] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 bg-background dark:bg-[#0f172a] dark:text-slate-100 dark:border-slate-800 p-6 shadow-md rounded-2xl duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] radix-dialog-content",t),onInteractOutside:l=>{r&&l.preventDefault()},onEscapeKeyDown:l=>{s&&l.preventDefault()},...o,children:[e,!n&&f.jsxs(nee,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[f.jsx($i,{className:"h-4 w-4"}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ro.displayName=WV.displayName;const al=({className:t,...e})=>f.jsx("div",{className:yn("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});al.displayName="DialogHeader";const Vv=({className:t,...e})=>f.jsx("div",{className:yn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});Vv.displayName="DialogFooter";const ll=y.forwardRef(({className:t,...e},n)=>f.jsx(qV,{ref:n,className:yn("text-lg font-semibold leading-none tracking-tight",t),...e}));ll.displayName=qV.displayName;const mI=y.forwardRef(({className:t,...e},n)=>f.jsx(HV,{ref:n,className:yn("text-sm text-muted-foreground",t),...e}));mI.displayName=HV.displayName;const _P="master_pin",ki=new Map;function see(t){return t.replace(/[-]/g,e=>"0123456789"["".indexOf(e)])}function da(t){return t?`${_P}_${t}`:_P}async function iee(t){try{const e=await hr.getUserData(t),n=(e==null?void 0:e.security)&&e.security.masterPin||(e==null?void 0:e.masterPin)||null;return typeof n=="string"&&n.length>0?n:null}catch{try{const e=ye(F,"users",t),n=await Sn(e);if(n.exists()){const r=n.data(),s=(r==null?void 0:r.security)&&r.security.masterPin||(r==null?void 0:r.masterPin)||null;return typeof s=="string"&&s.length>0?s:null}}catch{}return null}}function bP(t){try{const e=localStorage.getItem(da(t));return e&&e.length>0?e:null}catch{return null}}async function pp(t,e){try{const n={security:{masterPin:e||null,masterPinUpdatedAt:$e()},updatedAt:$e()};await rn(ye(F,"users",t),n,{merge:!0})}catch{try{await xn(ye(F,"users",t),{security:{masterPin:e||null,masterPinUpdatedAt:$e()},updatedAt:$e()})}catch{}}}function sa(t,e){try{const n=da(t);e?localStorage.setItem(n,e):localStorage.removeItem(n)}catch{}}class Al{static async hasMasterPin(e){const n=da(e);if(ki.has(n)){const s=ki.get(n);return s!==""&&s!=null}const r=bP(e);if(r)return ki.set(n,r),!0;if(e){const s=bP(void 0);if(s){ki.set(n,s),sa(e,s);try{sa(void 0,null)}catch{}return await pp(e,s),!0}}if(e){const s=await iee(e);if(s){ki.set(n,s),sa(e,s);try{sa(void 0,null)}catch{}return!0}}return!1}static async createMasterPin(e,n){try{if(!e||e.length<4)return!1;const r=btoa(e),s=da(n);return ki.set(s,r),sa(n,r),n&&await pp(n,r),!0}catch(r){return console.error("Error creating master PIN:",r),!1}}static async verifyMasterPin(e,n){try{const r=e.trim(),s=see(r),i=da(n);if(await this.hasMasterPin(n)){const o=ki.get(i);if(o){const a=atob(o);if(a===r||a===s)return!0}}if(n){const o=da(void 0),a=localStorage.getItem(o);if(a)try{const l=atob(a);if(l===r||l===s)return console.log("Master PIN auto-correction: Generic PIN matched while User PIN failed. Updating User PIN."),ki.set(i,a),sa(n,a),await pp(n,a),!0}catch{}}return!1}catch(r){return console.error("Error verifying master PIN:",r),!1}}static async changeMasterPin(e,n,r){try{return await this.verifyMasterPin(e,r)?await this.createMasterPin(n,r):!1}catch(s){return console.error("Error changing master PIN:",s),!1}}static async deleteMasterPin(e){try{const n=da(e);return ki.delete(n),sa(e,null),e&&(sa(void 0,null),await pp(e,null)),!0}catch(n){return console.error("Error deleting master PIN:",n),!1}}static async getMasterPin(e){try{const n=da(e);if(!await this.hasMasterPin(e))return null;const r=ki.get(n);return r?atob(r):null}catch(n){return console.error("Error getting master PIN:",n),null}}}const GV=({open:t,onOpenChange:e,title:n="  ",description:r="     ",onSuccess:s})=>{const{toast:i}=hl(),[o,a]=y.useState(""),[l,c]=y.useState(!1),[u,d]=y.useState(null),m=async()=>{d(null);try{const v=qt.currentUser;if(!v||!v.email){d("    .    .");return}c(!0);const g=Nc.credential(v.email,o);await u7(v,g),c(!1),a(""),i({title:" ",description:"     "}),s(),e&&e(!1)}catch(v){console.error("    :",v),c(!1);const g=(v==null?void 0:v.code)||"";d(g==="auth/wrong-password"?"   .   .":g==="auth/too-many-requests"?"  .     .":"   .   .")}},p=v=>{e&&e(v),v||(a(""),d(null),c(!1))};return f.jsx(Ha,{open:t,onOpenChange:p,children:f.jsxs(Ro,{className:"sm:max-w-[400px] bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",dir:"rtl",children:[f.jsxs(al,{children:[f.jsx(ll,{className:"text-right text-gray-900 dark:text-gray-100",children:n}),f.jsx(mI,{className:"text-right text-gray-500 dark:text-gray-400",children:r})]}),f.jsxs("div",{className:"grid gap-4 py-2",children:[f.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[f.jsx("label",{htmlFor:"password",className:"text-right col-span-1 text-sm text-gray-700 dark:text-gray-300",children:" "}),f.jsxs("div",{className:"col-span-3 relative",children:[f.jsx($y,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),f.jsx(ir,{id:"password",type:"password",value:o,onChange:v=>a(v.target.value),onKeyDown:v=>{v.key==="Enter"&&(v.preventDefault(),m())},placeholder:"    ",autoComplete:"off",className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100"})]})]}),u&&f.jsx("div",{className:"text-red-600 dark:text-red-400 text-xs text-right",children:u})]}),f.jsxs(Vv,{className:"flex justify-end gap-2",children:[f.jsx(bt,{variant:"outline",onClick:()=>p(!1),disabled:l,className:"dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",children:""}),f.jsx(bt,{onClick:m,disabled:l,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:l?" ...":""})]})]})})},one=Object.freeze(Object.defineProperty({__proto__:null,default:GV},Symbol.toStringTag,{value:"Module"})),cb=({open:t,onOpenChange:e,onSuccess:n,title:r="  ",description:s="      ",mode:i="verify",className:o,overlayClassName:a,userId:l,userRole:c})=>{const[u,d]=y.useState(""),[m,p]=y.useState(""),[v,g]=y.useState(""),[E,b]=y.useState(!1),[_,S]=y.useState(!1),[P,T]=y.useState(!1),[N,I]=y.useState(""),[A,R]=y.useState(!1),{toast:k}=hl(),[C,L]=y.useState(!1),[O,X]=y.useState(!1),ke=c==="admin"||c==="staff",[Oe,je]=y.useState(!1),[W,G]=y.useState(!1),ae=y.useRef(null),[pe,fe]=y.useState(i);y.useEffect(()=>{fe(i)},[i]),y.useEffect(()=>{let ve=!0;return t&&(async()=>{var qe;try{const cn=l||((qe=qt.currentUser)==null?void 0:qe.uid),cr=await Al.hasMasterPin(cn);ve&&L(cr)}catch{}})(),()=>{ve=!1}},[l,t]);const Ge=async ve=>{var qe;ve.preventDefault(),I(""),R(!0);const Q=l||((qe=qt.currentUser)==null?void 0:qe.uid);try{if(pe==="verify"){if(!u){I("    "),R(!1);return}if(!await Al.verifyMasterPin(u,Q)){I("   "),R(!1);return}k({title:" ",description:"     "}),n==null||n(),xe()}else if(pe==="create"){if(!m||m.length<4){I("      4   "),R(!1);return}if(m!==v){I("     "),R(!1);return}if(!await Al.createMasterPin(m,Q)){I("    "),R(!1);return}k({title:"    ",description:"     "}),n==null||n(),xe()}else if(pe==="change"){if(!Q){I("        .         ."),R(!1);return}if(C&&!O&&!W){if(!u){I("        "),R(!1);return}if(!await Al.verifyMasterPin(u,Q)){I("    "),R(!1);return}}if(!m||m.length<4){I("      4   "),R(!1);return}if(m!==v){I("     "),R(!1);return}if(!(C?O&&ke||W?await Al.createMasterPin(m,Q):await Al.changeMasterPin(u,m,Q):await Al.createMasterPin(m,Q))){I("    "),R(!1);return}k({title:C?O&&ke||W?"     ":"    ":"    ",description:C?O&&ke||W?"      ":"     ":"     "}),n==null||n(),xe()}}catch{I("     ")}finally{R(!1)}},xe=()=>{d(""),p(""),g(""),I(""),b(!1),S(!1),T(!1),G(!1),je(!1),X(!1),fe(i),e(!1)};return f.jsx(Ha,{open:t,onOpenChange:xe,children:f.jsx(Ro,{className:yn("sm:max-w-md bg-transparent border-0 shadow-none p-0",o),dir:"rtl",overlayClassName:a,children:f.jsxs("div",{className:"rounded-2xl bg-white border border-gray-200 shadow-2xl px-6 py-5",children:[f.jsx(al,{className:"px-0 pt-0",children:f.jsxs(ll,{className:"flex items-center gap-2 justify-center text-gray-900 text-xl font-bold leading-snug text-center",children:[f.jsx(pE,{className:"h-5 w-5 text-blue-600"}),r]})}),f.jsx("div",{className:"mt-1 text-center text-xs md:text-sm text-gray-600 leading-relaxed mb-4",children:s}),f.jsxs("form",{ref:ae,onSubmit:Ge,className:"space-y-4",children:[(pe==="verify"||pe==="change"&&C)&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"currentPin",className:"text-right block text-gray-700 dark:text-gray-300",children:pe==="verify"?"  ":"  "}),f.jsxs("div",{className:"relative",children:[f.jsx(ir,{id:"currentPin",type:E?"text":"password",autoComplete:"off",value:u,onChange:ve=>d(ve.target.value),onKeyDown:ve=>{var Q;if(ve.key==="Enter")try{(Q=ae.current)==null||Q.requestSubmit()}catch{}},placeholder:pe==="verify"?"   ":"   ",className:"pr-10 bg-white dark:bg-white border border-blue-500/60 text-gray-900 placeholder:text-slate-400 focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:border-blue-500 text-lg tracking-[0.2em]",dir:"ltr",inputMode:"numeric",autoFocus:!0,disabled:pe==="change"&&W}),f.jsx(bt,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent text-gray-500 dark:text-gray-400",onClick:()=>b(!E),children:E?f.jsx(Uh,{className:"h-4 w-4"}):f.jsx($h,{className:"h-4 w-4"})})]}),pe==="verify"&&f.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2 flex items-center justify-between",children:[f.jsx("span",{children:"   "}),f.jsx(bt,{type:"button",variant:"link",size:"sm",className:"h-auto p-0 text-blue-600 dark:text-blue-400 hover:no-underline",onClick:()=>je(!0),children:" "})]}),pe==="change"&&C&&ke&&f.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2 flex items-center justify-between",children:[f.jsx("span",{children:"  "}),f.jsx(bt,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2 dark:border-gray-700 dark:text-gray-300",onClick:()=>{X(ve=>!ve)},children:O?"   ":"    "})]}),pe==="change"&&C&&f.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2 flex items-center justify-between",children:[f.jsx("span",{children:"       "}),f.jsx(bt,{type:"button",variant:"secondary",size:"sm",className:"h-7 px-2 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700",onClick:()=>je(!0),children:"  "})]}),pe==="change"&&W&&f.jsx("div",{className:"text-[11px] text-green-600 dark:text-green-400",children:"          "})]}),(pe==="create"||pe==="change")&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"newPin",className:"text-right block text-gray-700 dark:text-gray-300",children:pe==="create"?"   ":"  "}),f.jsxs("div",{className:"relative",children:[f.jsx(ir,{id:"newPin",type:_?"text":"password",autoComplete:"off",value:m,onChange:ve=>p(ve.target.value),onKeyDown:ve=>{var Q;if(ve.key==="Enter")try{(Q=ae.current)==null||Q.requestSubmit()}catch{}},placeholder:"   ",className:"pr-10 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",dir:"ltr",inputMode:"numeric"}),f.jsx(bt,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent text-gray-500 dark:text-gray-400",onClick:()=>S(!_),children:_?f.jsx(Uh,{className:"h-4 w-4"}):f.jsx($h,{className:"h-4 w-4"})})]})]}),(pe==="create"||pe==="change")&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"confirmPin",className:"text-right block text-gray-700 dark:text-gray-300",children:"   "}),f.jsxs("div",{className:"relative",children:[f.jsx(ir,{id:"confirmPin",type:P?"text":"password",autoComplete:"off",value:v,onChange:ve=>g(ve.target.value),onKeyDown:ve=>{var Q;if(ve.key==="Enter")try{(Q=ae.current)==null||Q.requestSubmit()}catch{}},placeholder:"    ",className:"pr-10 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",dir:"ltr",inputMode:"numeric"}),f.jsx(bt,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent text-gray-500 dark:text-gray-400",onClick:()=>T(!P),children:P?f.jsx(Uh,{className:"h-4 w-4"}):f.jsx($h,{className:"h-4 w-4"})})]})]}),N&&f.jsxs("div",{className:"flex items-center gap-2 text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/30 p-3 rounded-lg border border-red-100 dark:border-red-900/50",children:[f.jsx(D3,{className:"h-4 w-4"}),N]}),f.jsxs("div",{className:"flex gap-3 pt-4",children:[f.jsx(bt,{type:"button",variant:"outline",onClick:xe,className:"flex-1 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",children:""}),f.jsx(bt,{type:"submit",disabled:A,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:A?f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})," ..."]}):f.jsxs(f.Fragment,{children:[f.jsx($y,{className:"h-4 w-4 mr-2"}),pe==="verify"?"":pe==="create"?"":""]})})]})]}),f.jsx(GV,{open:Oe,onOpenChange:je,title:"   ",description:"         ",onSuccess:()=>{G(!0),je(!1),I(""),pe==="verify"&&fe("change")}})]})})})},ane=Object.freeze(Object.defineProperty({__proto__:null,MasterPinDialog:cb,default:cb},Symbol.toStringTag,{value:"Module"})),oee={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"0.0.0",VITE_DEV_MODE:"true",VITE_ENABLE_OFFLINE_PERSISTENCE:"false",VITE_FIREBASE_API_KEY:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),VITE_FIREBASE_APP_ID:"1:483702062341:web:b1ff06ad175cb7ae428b6c",VITE_FIREBASE_AUTH_DOMAIN:"voda-c6abd.firebaseapp.com",VITE_FIREBASE_AUTH_EMULATOR_URL:"http://localhost:9099",VITE_FIREBASE_FIRESTORE_EMULATOR_HOST:"localhost:8080",VITE_FIREBASE_FUNCTIONS_EMULATOR_HOST:"localhost:5001",VITE_FIREBASE_MEASUREMENT_ID:"G-CV6QGH7G7P",VITE_FIREBASE_MESSAGING_SENDER_ID:"483702062341",VITE_FIREBASE_PROJECT_ID:"voda-c6abd",VITE_FIREBASE_STORAGE_BUCKET:"voda-c6abd.appspot.com",VITE_FORCE_HASH_ROUTER:"true",VITE_SHOP_ID:"demo-shop-001",VITE_SHOP_NAME:"   ",VITE_SHOW_ENV_BANNER:"true",VITE_USE_EMULATORS:"false",VITE_USE_FIREBASE_EMULATOR:"false"},QV=y.createContext(void 0);function Zs(){const t=y.useContext(QV);if(t===void 0)throw new Error("useFirebaseAuth must be used within a FirebaseAuthProvider");return t}const Qc=2,aee=1e3*60*60*24,lee=({children:t})=>{const[e,n]=y.useState(null),[r,s]=y.useState(null),[i,o]=y.useState(null),[a,l]=y.useState(null),[c,u]=y.useState(!1),[d,m]=y.useState(!0),p=y.useRef(null),v=y.useRef(null),[g,E]=y.useState(!1),[b,_]=y.useState(Qc),[S,P]=y.useState([]),[T,N]=y.useState(!1),[I,A]=y.useState(null),[R,k]=y.useState(!1),[C,L]=y.useState(!1),{toast:O}=hl(),X=()=>{try{const J="device_id",ue=localStorage.getItem(J);if(ue&&ue.length>0)return ue;const Ee=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`dev-${Math.random().toString(36).slice(2)}-${Date.now()}`;return localStorage.setItem(J,Ee),Ee}catch{return"unknown-device"}},ke=()=>{try{const J=typeof window<"u"?window:null,ue=typeof navigator<"u"&&navigator.userAgent||"",Ee=typeof navigator<"u"&&navigator.platform||"",et=ue.toLowerCase(),he=Ee.toLowerCase();return J&&J.electronAPI?et.includes("windows")?{deviceName:"  - ",deviceType:"desktop"}:et.includes("mac")?{deviceName:"  - ",deviceType:"desktop"}:et.includes("linux")?{deviceName:"  - ",deviceType:"desktop"}:{deviceName:"  ",deviceType:"desktop"}:/android/i.test(ue)?{deviceName:" ",deviceType:"mobile-web"}:/iphone|ipad|ipod/i.test(ue)?{deviceName:" iOS",deviceType:"mobile-web"}:/mobile/i.test(ue)?{deviceName:" ",deviceType:"mobile-web"}:he.includes("win")?{deviceName:"   - ",deviceType:"web"}:he.includes("mac")?{deviceName:"   - ",deviceType:"web"}:he.includes("linux")?{deviceName:"   - ",deviceType:"web"}:{deviceName:"  ",deviceType:"web"}}catch{return{deviceName:"  ",deviceType:"unknown"}}},Oe=J=>{const ue=String(J||"").toLowerCase();return ue==="desktop"?"  ":ue==="web"?"  ":ue==="mobile-web"?" ":ue==="android"?" ":" "},je=async()=>{if(!(e!=null&&e.uid)){P([]);return}N(!0);try{const J=Ae(F,"userSessions"),ue=Ye(J,Ne("userId","==",e.uid)),Ee=await Ze(ue),et=Date.now(),he=1e3*60*60*24,Ce=Ee.docs.map(Fe=>{const rt=Fe.data(),ct=rt.forcedLogout===!0;let Lt,Ct;try{const dt=rt.createdAt;Lt=dt&&typeof dt.toDate=="function"?dt.toDate():dt?new Date(dt):void 0}catch{Lt=void 0}try{const dt=rt.lastSeen;Ct=dt&&typeof dt.toDate=="function"?dt.toDate():dt?new Date(dt):Lt}catch{Ct=Lt}return{id:Fe.id,deviceId:String(rt.deviceId||""),deviceName:rt.deviceName?String(rt.deviceName):void 0,deviceType:rt.deviceType?String(rt.deviceType):void 0,createdAt:Lt,lastSeen:Ct,forcedLogout:ct}}).filter(Fe=>{if(Fe.forcedLogout||!Fe.lastSeen)return!1;const rt=Fe.lastSeen.getTime();return!rt||isNaN(rt)?!1:et-rt<he}).sort((Fe,rt)=>{const ct=Date.now();let Lt=Fe.lastSeen instanceof Date?Fe.lastSeen.getTime():0,Ct=rt.lastSeen instanceof Date?rt.lastSeen.getTime():0;Lt>ct+6e4&&(Lt=ct),Ct>ct+6e4&&(Ct=ct);const dt=Ct-Lt;return dt!==0?dt:Fe.deviceId===currentDeviceId?-1:rt.deviceId===currentDeviceId?1:0});P(Ce)}catch{P([])}finally{N(!1)}},W=async J=>{try{const ue=X(),Ee=ke(),et=Ae(F,"userSessions"),he=Ye(et,Ne("userId","==",J),Ne("deviceId","==",ue)),Ce=await Ze(he);if(!Ce.empty){const Fe=Ce.docs[0].ref;await xn(Fe,{lastSeen:$e(),deviceName:Ee.deviceName,deviceType:Ee.deviceType});return}await Vs(et,{userId:J,deviceId:ue,deviceName:Ee.deviceName,deviceType:Ee.deviceType,createdAt:$e(),lastSeen:$e()})}catch(ue){console.error("session registration error:",ue)}},G=async J=>{try{const ue=X(),Ee=Ae(F,"userSessions"),et=Ye(Ee,Ne("userId","==",J),Ne("deviceId","==",ue)),Ce=(await Ze(et)).docs.map(Fe=>Wn(Fe.ref));Ce.length>0&&await Promise.all(Ce)}catch(ue){console.error("session clear error:",ue)}},ae=(J,ue)=>{if(ue===!0)return null;const et=typeof J=="number"?J:parseInt(String(J??""),10);return!isNaN(et)&&et>0?et:Qc},pe=async J=>{try{const ue=ye(F,"users",J),Ee=await Sn(ue);if(!Ee.exists())return _(Qc),Qc;const et=Ee.data(),he=ae(et.sessionLimit,et.sessionLimitDisabled);return _(he),he}catch(ue){return console.error("session limit load error:",ue),_(Qc),Qc}},fe=(J,ue)=>{try{const Ee=X(),et=Ae(F,"userSessions"),he=Ye(et,Ne("userId","==",J),Uo(50));if(v.current)try{v.current()}catch{}v.current=$o(he,Ce=>{try{const Fe=Ce.docs.map(we=>{const le=we.data();let ce,st;try{const yt=le.createdAt;ce=yt&&typeof yt.toDate=="function"?yt.toDate():new Date(yt||Date.now())}catch{ce=new Date}try{const yt=le.lastSeen;st=yt&&typeof yt.toDate=="function"?yt.toDate():new Date(yt||ce)}catch{st=ce}return{id:we.id,deviceId:String(le.deviceId||""),createdAt:ce,lastSeen:st,forcedLogout:le.forcedLogout===!0}});Fe.sort((we,le)=>{const ce=Date.now();let st=we.lastSeen instanceof Date?we.lastSeen.getTime():0,yt=le.lastSeen instanceof Date?le.lastSeen.getTime():0;st>ce+6e4&&(st=ce),yt>ce+6e4&&(yt=ce);const _n=yt-st;return _n!==0?_n:we.deviceId===Ee?-1:le.deviceId===Ee?1:0});const rt=Date.now(),ct=Fe.filter(we=>{const le=we.lastSeen instanceof Date?we.lastSeen:we.createdAt;return!(le instanceof Date)||isNaN(le.getTime())||we.forcedLogout?!1:rt-le.getTime()<aee}),Lt=Fe.filter(we=>!ct.some(le=>le.id===we.id));if(Lt.length>0&&Lt.forEach(we=>{try{Wn(ye(F,"userSessions",we.id))}catch{}}),Fe.some(we=>we.deviceId===Ee&&we.forcedLogout)){E(!0);try{cn()}catch{}return}if(ue==null||ue<=0){E(!1);return}const dt=[...ct].sort((we,le)=>{const ce=we.createdAt instanceof Date?we.createdAt.getTime():0,st=le.createdAt instanceof Date?le.createdAt.getTime():0;return ce-st}),Te=dt.slice(0,ue).some(we=>we.deviceId===Ee);dt.length>ue?E(!Te):E(!1)}catch(Fe){console.error("sessions listener error:",Fe),E(!1)}},Ce=>{console.error("sessions listener subscribe error:",Ce),E(!1)})}catch(Ee){console.error("attachSessionsListener error:",Ee),E(!1)}};y.useEffect(()=>{const J=()=>{console.log(" Received userSubscriptionUpdated event - Refreshing profile..."),e&&(Ge(e.uid,!0),Yn(!0))};return window.addEventListener("userSubscriptionUpdated",J),()=>{window.removeEventListener("userSubscriptionUpdated",J)}},[e]),y.useEffect(()=>{let J=null;if(e){const ue=ye(F,"users",e.uid);J=$o(ue,Ee=>{if(Ee.exists()){const et=Ee.data();o(et);const he=ae(et.sessionLimit,et.sessionLimitDisabled);_(Ce=>Ce!==he?(fe(e.uid,he),he):Ce)}else o(null)},Ee=>{console.error("Error listening to user data:",Ee)})}else o(null);return()=>{J&&J()}},[e]);const Ge=async(J,ue=!1)=>{var Ee,et,he,Ce,Fe,rt,ct,Lt;try{const Ct=ye(F,"profiles",J),dt=`profile_cache_v2_${J}`,Y=Date.now(),Te=1e3*60*60*24;if(!ue)try{const le=localStorage.getItem(dt);if(le){const{data:ce,timestamp:st}=JSON.parse(le);if(Y-st<Te&&(s(ce),m(!1),console.log(" Profile loaded from cache (valid)"),!(Y-st>1e3*60*60)))return}}catch(le){console.warn("Cache parse error:",le)}const we=await Sn(Ct);if(we.exists()){const le=we.data(),ce={userId:we.id,shopId:le.shopId,role:le.role,fullName:le.fullName,phone:le.phone,sim1Number:le.sim1Number||null,sim2Number:le.sim2Number||null,shopName:le.shopName||null,approved:le.approved,avatarId:le.avatarId,bridgeLink:le.bridgeLink||null,bridgeDeviceId:le.bridgeDeviceId||null,showWithdrawNote:le.showWithdrawNote!==void 0?!!le.showWithdrawNote:!0,isReceiptNoteEnabled:le.isReceiptNoteEnabled!==void 0?!!le.isReceiptNoteEnabled:!0,smsReadingEnabled:le.smsReadingEnabled!==void 0?!!le.smsReadingEnabled:!1,smsAutoRegisterEnabled:le.smsAutoRegisterEnabled!==void 0?!!le.smsAutoRegisterEnabled:!1,smsAutoConfirmDuration:typeof le.smsAutoConfirmDuration=="number"?le.smsAutoConfirmDuration:5,createdAt:((et=(Ee=le.createdAt)==null?void 0:Ee.toDate)==null?void 0:et.call(Ee))||new Date,updatedAt:((Ce=(he=le.updatedAt)==null?void 0:he.toDate)==null?void 0:Ce.call(he))||new Date,trialStarted:le.trialStarted||!1,trialStartDate:(rt=(Fe=le.trialStartDate)==null?void 0:Fe.toDate)==null?void 0:rt.call(Fe),trialEndDate:(Lt=(ct=le.trialEndDate)==null?void 0:ct.toDate)==null?void 0:Lt.call(ct),trialExpired:le.trialExpired||!1,referralCode:le.referralCode||null,referredBy:le.referredBy||null};s(ce);try{localStorage.setItem(dt,JSON.stringify({data:ce,timestamp:Y})),ce.shopId&&localStorage.setItem("shopId",ce.shopId)}catch{}}else try{const le=await cV.getByUserId(J);if(le){const ce={userId:J,shopId:le.shopId,role:le.role||"user",fullName:le.fullName||null,phone:le.phone||null,shopName:le.shopName||null,approved:le.approved??!1,avatarId:le.avatarId||void 0,bridgeLink:le.bridgeLink||null,bridgeDeviceId:le.bridgeDeviceId||null,createdAt:$e(),updatedAt:$e()};await rn(ye(F,"profiles",J),ce,{merge:!0}),s({...le,userId:J})}else await ve(J)}catch(le){console.error("Profile migration error:",le)}m(!1)}catch(Ct){console.error("Error fetching profile:",Ct),m(!1)}},xe=async J=>{try{const ue=ye(F,"users",J.uid);(await Sn(ue)).exists()?(await xn(ue,{lastLogin:$e(),updatedAt:$e()}),console.log(" ensureAdminUserDoc: Updated lastLogin for",J.uid)):(await rn(ue,{email:J.email||"",displayName:J.displayName||" ",phone:null,shopName:null,isActive:!1,createdAt:$e(),updatedAt:$e(),lastLogin:$e()},{merge:!0}),console.log(" ensureAdminUserDoc: Created users doc for",J.uid))}catch(ue){console.error(" ensureAdminUserDoc error:",ue)}},ve=async(J,ue,Ee,et,he)=>{var Ce,Fe;try{console.log("Creating default profile for user:",J);const rt=ob.generateReferralCode(J);let ct=null;const Lt={userId:J,shopId:"default-shop",role:"user",fullName:ue||" ",phone:Ee||null,shopName:et||null,approved:!1,referralCode:rt,referredBy:he||null,bridgeLink:null,bridgeDeviceId:null,showWithdrawNote:!0,isReceiptNoteEnabled:!0,smsReadingEnabled:!1,smsAutoRegisterEnabled:!1,createdAt:new Date,updatedAt:new Date};s(Lt),console.log("Created temporary profile:",Lt);try{const{doc:Ct,setDoc:dt,serverTimestamp:Y}=await ee(async()=>{const{doc:ce,setDoc:st,serverTimestamp:yt}=await Promise.resolve().then(()=>kn);return{doc:ce,setDoc:st,serverTimestamp:yt}},void 0,import.meta.url),{db:Te}=await ee(async()=>{const{db:ce}=await Promise.resolve().then(()=>En);return{db:ce}},void 0,import.meta.url),we={email:((Ce=qt.currentUser)==null?void 0:Ce.email)||"",displayName:ue||" ",phone:Ee||null,shopName:et||null,isActive:!1,referralCode:rt,referredBy:he||null,createdAt:Y(),lastLogin:null,updatedAt:Y()};if(console.log("Attempting to add user to admin collection with data:",we),await dt(Ct(Te,"users",J),we,{merge:!0}),console.log(" User successfully added to admin collection:",we),he)try{const{query:ce,collection:st,where:yt,limit:_n,getDocs:tn}=await ee(async()=>{const{query:Z,collection:q,where:oe,limit:H,getDocs:Pe}=await Promise.resolve().then(()=>kn);return{query:Z,collection:q,where:oe,limit:H,getDocs:Pe}},void 0,import.meta.url),{db:j}=await ee(async()=>{const{db:Z}=await Promise.resolve().then(()=>En);return{db:Z}},void 0,import.meta.url),U=ce(st(j,"users"),yt("referralCode","==",he),_n(1)),V=await tn(U);V.empty?console.log(" Referral code not found in users collection:",he):(ct=V.docs[0].id,await ob.create({referrerId:ct,referredUserId:J,referredUserEmail:((Fe=qt.currentUser)==null?void 0:Fe.email)||"",referralCode:he,status:"completed"}),console.log(" Referral record created successfully for referrer:",ct))}catch(ce){console.error(" Error creating referral record:",ce)}const le=await Sn(Ct(Te,"users",J));le.exists()?console.log(" User document verified in Firestore:",le.data()):console.log(" User document not found after creation")}catch(Ct){console.error(" Error adding user to admin collection:",Ct)}try{const{addDoc:Ct,collection:dt,serverTimestamp:Y}=await ee(async()=>{const{addDoc:st,collection:yt,serverTimestamp:_n}=await Promise.resolve().then(()=>kn);return{addDoc:st,collection:yt,serverTimestamp:_n}},void 0,import.meta.url),{db:Te}=await ee(async()=>{const{db:st}=await Promise.resolve().then(()=>En);return{db:st}},void 0,import.meta.url),le=(await Ct(dt(Te,"shops"),{name:et||" ",ownerId:J,createdAt:Y(),updatedAt:Y(),isActive:!0})).id;await tf.create({userId:J,shopId:le,role:"user",fullName:" ",phone:null});try{await tf.update(J,{referralCode:rt,referredBy:ct||null,showWithdrawNote:!0,isReceiptNoteEnabled:!0})}catch(st){console.warn(" Failed to update profile with referral fields:",st)}const ce=await tf.getById(J);ce&&(s(ce),console.log("Updated with Firebase profile:",ce))}catch(Ct){console.error("Error creating profile:",Ct),console.log("Using local profile - Firebase unavailable")}}catch(rt){console.error("Error creating default profile:",rt)}};y.useEffect(()=>{console.log(" Setting up auth state listener"),m(!0);const J=setTimeout(()=>{console.warn(" Global auth timeout reached, forcing loading to false"),m(!1)},2e4);localStorage.getItem("demoProfile")&&(console.log(" Cleaning up demo profile from localStorage"),localStorage.removeItem("demoProfile"));const ue=localStorage.getItem("demoUser"),Ee=localStorage.getItem("demoProfile");if(ue&&Ee){console.log(" Found demo user in localStorage");try{const he=JSON.parse(ue),Ce=JSON.parse(Ee);n(he),s(Ce),clearTimeout(J),m(!1);return}catch(he){console.error("Error parsing demo user data:",he),localStorage.removeItem("demoUser"),localStorage.removeItem("demoProfile")}}const et=v7(qt,async he=>{if(console.log(" Auth state changed:",{uid:he==null?void 0:he.uid,email:he==null?void 0:he.email,emailVerified:he==null?void 0:he.emailVerified,timestamp:new Date().toISOString()}),n(he),he){console.log(" User authenticated, starting profile hydration for:",he.uid);try{const Ce=await pe(he.uid);await W(he.uid),fe(he.uid,Ce)}catch(Ce){console.error("session registration on auth change error:",Ce)}try{await Ul.set({key:"current_user_id",value:he.uid}),console.log(" Synced current_user_id to Native:",he.uid)}catch(Ce){console.error("Failed to sync user ID to native:",Ce)}try{if(!localStorage.getItem("theme")){localStorage.setItem("theme","light");try{document.documentElement.classList.remove("dark"),document.documentElement.setAttribute("data-theme","light")}catch{}}}catch{}Ge(he.uid),Yn(),xe(he)}else{if(console.log(" User not authenticated, clearing profile"),s(null),l(null),u(!1),E(!1),v.current){try{v.current()}catch{}v.current=null}m(!1);try{await Ul.remove({key:"current_user_id"}),await Ul.remove({key:"selected_wallet_id"})}catch{}}clearTimeout(J)});return()=>{clearTimeout(J),et()}},[]),y.useEffect(()=>{const J=async()=>{try{await tr(),await Yn(!0)}catch{}};try{window.addEventListener("app:softRefresh",J)}catch{}return()=>{try{window.removeEventListener("app:softRefresh",J)}catch{}}},[e==null?void 0:e.uid]),y.useEffect(()=>{const J=()=>{try{Yn(!0)}catch{}};try{window.addEventListener("userSubscriptionUpdated",J),window.addEventListener("subscriptionActivated",J)}catch{}return()=>{try{window.removeEventListener("userSubscriptionUpdated",J),window.removeEventListener("subscriptionActivated",J)}catch{}}},[e==null?void 0:e.uid]),y.useEffect(()=>{e!=null&&e.uid&&hr.syncDeletedTransactionsLocal(e.uid)},[e==null?void 0:e.uid]);const Q=async(J,ue,Ee,et,he,Ce)=>{try{const Fe=(J||"").trim().toLowerCase(),rt=(ue||"").trim();console.log(" Attempting to sign up user:",Fe);const ct=await mA(qt,Fe,rt);console.log(" Sign up successful:",ct.user.uid),await ve(ct.user.uid,Ee,et,he,Ce),await xe(ct.user);try{await Ge(ct.user.uid),await Yn()}catch{}try{if(!localStorage.getItem("theme")){localStorage.setItem("theme","light");try{document.documentElement.classList.remove("dark"),document.documentElement.setAttribute("data-theme","light")}catch{}}}catch{}return{error:null}}catch(Fe){console.error(" Sign up error:",Fe);let rt="    ";return Fe.code==="auth/email-already-in-use"?rt="    ":Fe.code==="auth/weak-password"?rt="   ":Fe.code==="auth/invalid-email"&&(rt="   "),{error:{...Fe,message:rt}}}},qe=async(J,ue)=>{var he;const Ee=(J||"").trim().toLowerCase(),et=(ue||"").trim();try{const Ce=Y=>Y.replace(/[\u200B\u200C\u200D\u200E\u200F\u061C]/g,""),Fe=Y=>Y.replace(/[-]/g,Te=>String("0123456789"["".indexOf(Te)])).replace(/[-]/g,Te=>String("0123456789"["".indexOf(Te)])),rt=Y=>Y.replace(/[0-9]/g,Te=>""[Number(Te)]),ct=Y=>Fe(Ce(Y));if(console.log(" Attempting to sign in user:",Ee),Ee==="test@example.com"&&et==="123456"){console.log(" Demo user login detected");const Y={uid:"demo-user-123",email:"test@example.com",displayName:" ",emailVerified:!0},Te={userId:"demo-user-123",shopId:"demo-shop",role:"user",fullName:" ",phone:"01000000000",approved:!0,createdAt:new Date,updatedAt:new Date};return localStorage.setItem("demoUser",JSON.stringify(Y)),localStorage.setItem("demoProfile",JSON.stringify(Te)),n(Y),s(Te),m(!1),console.log(" Demo user signed in successfully"),{error:null}}let Lt;const Ct=[ct(et),Ce(et),rt(Ce(et))];let dt=null;for(const Y of Ct)try{Y!==et&&console.log(" Trying password variant"),Lt=await _2(qt,Ee,Y);break}catch(Te){if(dt=Te,(Te==null?void 0:Te.code)!=="auth/wrong-password"&&(Te==null?void 0:Te.code)!=="auth/invalid-credential")throw Te}if(!Lt)throw dt||new Error("auth/invalid-credential");console.log(" Sign in successful:",Lt.user.uid);try{if((await Sn(ye(F,"deletedUsers",Lt.user.uid))).exists())return console.log(" User is deleted, signing out"),await pA(qt),{error:{code:"auth/user-deleted",message:"      .    ."}}}catch(Y){console.error("Error checking deleted users:",Y)}await xe(Lt.user);try{await Ge(Lt.user.uid),await Yn()}catch{}return{error:null}}catch(Ce){if(console.error(" Sign in error:",Ce),Ee==="test@example.com"&&Ce.code==="auth/user-not-found"){console.log(" Creating test user...");try{const ct=await mA(qt,Ee,et);return console.log(" Test user created:",ct.user.uid),await ve(ct.user.uid," ","01000000000"," "),{error:null}}catch(ct){return console.error(" Error creating test user:",ct),{error:ct}}}let Fe="    ",rt=Ce==null?void 0:Ce.code;if(rt==="auth/invalid-credential")try{const ct=await f7(qt,((he=Ce==null?void 0:Ce.customData)==null?void 0:he.email)||"");Array.isArray(ct)&&ct.length===0?(rt="auth/user-not-found",Fe="     "):(rt="auth/wrong-password",Fe="   ")}catch{Fe="      "}else rt==="auth/invalid-email"?Fe="    ":rt==="auth/user-not-found"?Fe="     ":rt==="auth/wrong-password"?Fe="   ":rt==="auth/too-many-requests"&&(Fe="      ");return{error:{...Ce,code:rt,message:Fe}}}},cn=async()=>{try{const J=e==null?void 0:e.uid;if(localStorage.getItem("demoUser"))console.log(" Signing out demo user"),localStorage.removeItem("demoUser"),localStorage.removeItem("demoProfile"),n(null),s(null),m(!1);else{if(J)try{await G(J)}catch(he){console.error("session clear on sign out error:",he)}await pA(qt)}J&&(localStorage.removeItem(`sub_cache_${J}`),localStorage.removeItem(`profile_cache_v2_${J}`),console.log(" Cleared user caches for:",J));try{await Ul.remove({key:"selected_wallet_id"}),await Ul.remove({key:"current_user_id"}),console.log(" Cleared selected_wallet_id and current_user_id from Capacitor Preferences")}catch(he){console.error(" Failed to clear Preferences:",he)}const et=(()=>{try{const he=typeof window<"u"?window:null,Ce=!!(he&&he.electronAPI)||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"),Fe=typeof window<"u"&&window.location.protocol==="file:",rt=typeof window<"u"&&typeof window.location.hash=="string"&&window.location.hash.startsWith("#/");return Ce||Fe||rt||typeof import.meta<"u"&&oee&&!0}catch{return!1}})()?"#/user/login":"/user/login";try{window.location.replace(et)}catch{window.location.href=et}}catch(J){console.error("Sign out error:",J)}},cr=async J=>{try{return await d7(qt,J),{error:null}}catch(ue){console.error("Reset password error:",ue);let Ee="        ";return ue.code==="auth/user-not-found"?Ee="     ":ue.code==="auth/invalid-email"&&(Ee="   "),{error:{...ue,message:Ee}}}},Yn=async(J=!1)=>{var he,Ce,Fe,rt,ct,Lt,Ct,dt,Y,Te,we,le,ce,st,yt,_n,tn,j,U,V,Z;if(!e){console.log("No user found for subscription check"),l(null),u(!1);return}p.current&&(p.current(),p.current=null),console.log("Checking subscription status for user:",e.uid,{force:J});const ue=`sub_cache_${e.uid}`,Ee=Date.now(),et=1e3*60*60*24;if(!J)try{const q=localStorage.getItem(ue);if(q){const{data:oe,timestamp:H}=JSON.parse(q);if(Ee-H<et){const Pe={...oe,subscription:oe.subscription?{...oe.subscription,activatedAt:oe.subscription.activatedAt?{toDate:()=>new Date(oe.subscription.activatedAt)}:null,endDate:oe.subscription.endDate?{toDate:()=>new Date(oe.subscription.endDate)}:null}:null,branchPackage:oe.branchPackage?{...oe.branchPackage,activatedAt:oe.branchPackage.activatedAt?{toDate:()=>new Date(oe.branchPackage.activatedAt)}:null,endDate:oe.branchPackage.endDate?{toDate:()=>new Date(oe.branchPackage.endDate)}:null}:null,freeTrialStartDate:oe.freeTrialStartDate?{toDate:()=>new Date(oe.freeTrialStartDate)}:null,freeTrialEndDate:oe.freeTrialEndDate?{toDate:()=>new Date(oe.freeTrialEndDate)}:null};l(Pe);const it=((he=oe==null?void 0:oe.branchPackage)==null?void 0:he.status)==="active";let te=!1;if(it)te=!0;else{const ne=Pe.subscription;te=aP(ne)}u(te),console.log(" Subscription loaded from cache (Client-side validity check applied)");return}}}catch(q){console.warn("Subscription Cache parse error:",q)}try{const q=ye(F,"users",e.uid),oe=await Sn(q);if(oe.exists()){const H=oe.data();l(H);try{const ne={...H,subscription:H.subscription?{...H.subscription,activatedAt:((rt=(Fe=(Ce=H.subscription.activatedAt)==null?void 0:Ce.toDate)==null?void 0:Fe.call(Ce))==null?void 0:rt.toISOString())||H.subscription.activatedAt,endDate:((Ct=(Lt=(ct=H.subscription.endDate)==null?void 0:ct.toDate)==null?void 0:Lt.call(ct))==null?void 0:Ct.toISOString())||H.subscription.endDate}:null,branchPackage:H.branchPackage?{...H.branchPackage,activatedAt:((Te=(Y=(dt=H.branchPackage.activatedAt)==null?void 0:dt.toDate)==null?void 0:Y.call(dt))==null?void 0:Te.toISOString())||H.branchPackage.activatedAt,endDate:((ce=(le=(we=H.branchPackage.endDate)==null?void 0:we.toDate)==null?void 0:le.call(we))==null?void 0:ce.toISOString())||H.branchPackage.endDate}:null,freeTrialStartDate:((_n=(yt=(st=H.freeTrialStartDate)==null?void 0:st.toDate)==null?void 0:yt.call(st))==null?void 0:_n.toISOString())||H.freeTrialStartDate,freeTrialEndDate:((U=(j=(tn=H.freeTrialEndDate)==null?void 0:tn.toDate)==null?void 0:j.call(tn))==null?void 0:U.toISOString())||H.freeTrialEndDate};localStorage.setItem(ue,JSON.stringify({data:ne,timestamp:Ee}))}catch{}console.log(" Subscription Data Details (Fetched):",{userId:e.uid,isActive:(V=H.subscription)==null?void 0:V.isActive});const Pe=((Z=H==null?void 0:H.branchPackage)==null?void 0:Z.status)==="active";let it=!1;if(Pe){const ne=H.branchPackage;let be=!1;if(ne.endDate){const ze=ne.endDate.toDate?ne.endDate.toDate():new Date(ne.endDate);!isNaN(ze.getTime())&&new Date>ze&&(be=!0,xX(e.uid,ne).catch(console.error))}it=!be}const te=it||aP(H.subscription);u(te)}}catch(q){console.error("Error checking subscription status:",q)}},tr=async()=>{if(e)try{console.log("Refreshing profile for user:",e.uid),await Ge(e.uid,!0),await Yn(!0)}catch(J){console.error("Error refreshing profile:",J)}},Dr={user:e,profile:r,userData:i,userSubscription:a,isSubscriptionActive:c,loading:d,signUp:Q,signIn:qe,signOut:cn,resetPassword:cr,updateUserProfile:async J=>{if(e)try{const ue={updatedAt:$e()};if(J.fullName!==void 0&&(ue.fullName=J.fullName),J.phone!==void 0&&(ue.phone=J.phone),J.sim1Number!==void 0){const Ee=(J.sim1Number||"").trim();ue.sim1Number=Ee.length?Ee:null}if(J.sim2Number!==void 0){const Ee=(J.sim2Number||"").trim();ue.sim2Number=Ee.length?Ee:null}if(J.bridgeLink!==void 0){const Ee=(J.bridgeLink||"").trim();ue.bridgeLink=Ee.length?Ee:null}if(J.bridgeDeviceId!==void 0){const Ee=(J.bridgeDeviceId||"").trim();ue.bridgeDeviceId=Ee.length?Ee:null}J.showWithdrawNote!==void 0&&(ue.showWithdrawNote=!!J.showWithdrawNote),J.isReceiptNoteEnabled!==void 0&&(ue.isReceiptNoteEnabled=!!J.isReceiptNoteEnabled),J.smsReadingEnabled!==void 0&&(ue.smsReadingEnabled=!!J.smsReadingEnabled),J.smsAutoRegisterEnabled!==void 0&&(ue.smsAutoRegisterEnabled=!!J.smsAutoRegisterEnabled),J.smsAutoConfirmDuration!==void 0&&(ue.smsAutoConfirmDuration=J.smsAutoConfirmDuration),await xn(ye(F,"profiles",e.uid),ue),await Ge(e.uid,!0)}catch(ue){console.error("Error updating user profile:",ue)}},updateAvatarId:async J=>{if(e)try{await xn(ye(F,"profiles",e.uid),{avatarId:J,updatedAt:$e()}),await Ge(e.uid)}catch(ue){console.error("Error updating avatarId:",ue)}},refreshProfile:tr,checkSubscriptionStatus:Yn,isSessionBlocked:g};return f.jsxs(QV.Provider,{value:Dr,children:[t,g&&f.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/70 p-4",children:[f.jsxs("div",{className:"w-full max-w-md rounded-xl bg-white p-6 shadow-xl max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("h2",{className:"mb-3 text-lg font-semibold text-gray-900",children:"   "}),f.jsx("p",{className:"mb-1 text-sm text-gray-700",children:"       ."}),f.jsx("p",{className:"mb-1 text-sm text-gray-700",children:"          ."}),f.jsx("p",{className:"text-sm text-gray-700",children:"                   ."})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx(bt,{onClick:()=>{L(!C),C||je()},variant:"outline",className:"w-full",children:C?"  ":"  "}),C&&f.jsxs("div",{className:"space-y-3 mt-4",children:[T&&f.jsx("p",{className:"text-center text-sm text-gray-500",children:" ..."}),!T&&S.length===0&&f.jsx("p",{className:"text-center text-sm text-gray-500",children:"   "}),!T&&S.map(J=>{const ue=J.deviceId&&J.deviceId===X(),Ee=Oe(J.deviceType);return f.jsxs("div",{className:"flex flex-col gap-2 rounded-lg border p-3 text-right",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm font-medium text-gray-900",children:J.deviceName||"  "}),ue&&f.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:" "})]}),f.jsxs("div",{className:"text-xs text-gray-500",children:[Ee,J.lastSeen&&`  ${PX(J.lastSeen)}`]}),!ue&&f.jsx(bt,{size:"sm",variant:"destructive",className:"w-full mt-2 h-8 text-xs",onClick:()=>{A(J.id),k(!0)},children:" "})]},J.id)})]})]})]}),f.jsx(cb,{open:R,onOpenChange:J=>{k(J),J||A(null)},mode:"verify",title:"   ",description:"         .",userId:e==null?void 0:e.uid,userRole:r==null?void 0:r.role,onSuccess:async()=>{if(I)try{await xn(ye(F,"userSessions",I),{forcedLogout:!0}),P(J=>J.filter(ue=>ue.id!==I)),O({title:"   ",description:"       ."})}catch{O({title:"   ",description:"     .",variant:"destructive"})}A(null),k(!1)}})]})]})};function cee(t){const e=y.useRef({value:t,previous:t});return y.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var jv="Checkbox",[uee]=Ac(jv),[dee,pI]=uee(jv);function hee(t){const{__scopeCheckbox:e,checked:n,children:r,defaultChecked:s,disabled:i,form:o,name:a,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:d}=t,[m,p]=cE({prop:n,defaultProp:s??!1,onChange:l,caller:jv}),[v,g]=y.useState(null),[E,b]=y.useState(null),_=y.useRef(!1),S=v?!!o||!!v.closest("form"):!0,P={checked:m,disabled:i,setChecked:p,control:v,setControl:g,name:a,form:o,value:u,hasConsumerStoppedPropagationRef:_,required:c,defaultChecked:Ka(s)?!1:s,isFormControl:S,bubbleInput:E,setBubbleInput:b};return f.jsx(dee,{scope:e,...P,children:fee(d)?d(P):r})}var YV="CheckboxTrigger",JV=y.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...r},s)=>{const{control:i,value:o,disabled:a,checked:l,required:c,setControl:u,setChecked:d,hasConsumerStoppedPropagationRef:m,isFormControl:p,bubbleInput:v}=pI(YV,t),g=Kn(s,u),E=y.useRef(l);return y.useEffect(()=>{const b=i==null?void 0:i.form;if(b){const _=()=>d(E.current);return b.addEventListener("reset",_),()=>b.removeEventListener("reset",_)}},[i,d]),f.jsx(wn.button,{type:"button",role:"checkbox","aria-checked":Ka(l)?"mixed":l,"aria-required":c,"data-state":nj(l),"data-disabled":a?"":void 0,disabled:a,value:o,...r,ref:g,onKeyDown:Zt(e,b=>{b.key==="Enter"&&b.preventDefault()}),onClick:Zt(n,b=>{d(_=>Ka(_)?!0:!_),v&&p&&(m.current=b.isPropagationStopped(),m.current||b.stopPropagation())})})});JV.displayName=YV;var gI=y.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:a,value:l,onCheckedChange:c,form:u,...d}=t;return f.jsx(hee,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:a,required:o,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:m})=>f.jsxs(f.Fragment,{children:[f.jsx(JV,{...d,ref:e,__scopeCheckbox:n}),m&&f.jsx(tj,{__scopeCheckbox:n})]})})});gI.displayName=jv;var XV="CheckboxIndicator",ZV=y.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...s}=t,i=pI(XV,n);return f.jsx(Si,{present:r||Ka(i.checked)||i.checked===!0,children:f.jsx(wn.span,{"data-state":nj(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});ZV.displayName=XV;var ej="CheckboxBubbleInput",tj=y.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:a,disabled:l,name:c,value:u,form:d,bubbleInput:m,setBubbleInput:p}=pI(ej,t),v=Kn(n,p),g=cee(i),E=Wk(r);y.useEffect(()=>{const _=m;if(!_)return;const S=window.HTMLInputElement.prototype,T=Object.getOwnPropertyDescriptor(S,"checked").set,N=!s.current;if(g!==i&&T){const I=new Event("click",{bubbles:N});_.indeterminate=Ka(i),T.call(_,Ka(i)?!1:i),_.dispatchEvent(I)}},[m,g,i,s]);const b=y.useRef(Ka(i)?!1:i);return f.jsx(wn.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??b.current,required:a,disabled:l,name:c,value:u,form:d,...e,tabIndex:-1,ref:v,style:{...e.style,...E,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});tj.displayName=ej;function fee(t){return typeof t=="function"}function Ka(t){return t==="indeterminate"}function nj(t){return Ka(t)?"indeterminate":t?"checked":"unchecked"}const rj=y.forwardRef(({className:t,...e},n)=>f.jsx(gI,{ref:n,className:yn("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:f.jsx(ZV,{className:yn("flex items-center justify-center text-current"),children:f.jsx(gk,{className:"h-4 w-4"})})}));rj.displayName=gI.displayName;const fy=()=>{const[t,e]=y.useState(""),[n,r]=y.useState(""),[s,i]=y.useState(!1),[o,a]=y.useState(!1),[l,c]=y.useState(typeof navigator<"u"?!navigator.onLine:!1);y.useEffect(()=>{const P=()=>c(!navigator.onLine);return window.addEventListener("online",P),window.addEventListener("offline",P),()=>{window.removeEventListener("online",P),window.removeEventListener("offline",P)}},[]);const[u,d]=y.useState(!0),{signIn:m,user:p,checkSubscriptionStatus:v,loading:g}=Zs(),E=oo();y.useEffect(()=>{try{p&&!g&&E("/user/dashboard")}catch{}},[p,g,E]),y.useEffect(()=>{try{const P=typeof window<"u"?window.localStorage.getItem("cashy:lastEmail"):null;P&&e(P)}catch{}try{const P=typeof window<"u"?window.localStorage.getItem("cashy:rememberLogin"):null;P==="true"?d(!0):P==="false"&&d(!1)}catch{}(async()=>{var P,T;try{if(typeof navigator<"u"&&navigator.credentials&&window.localStorage.getItem("cashy:rememberLogin")==="true"){const N=await((T=(P=navigator.credentials).get)==null?void 0:T.call(P,{password:!0,mediation:"optional"}));N&&N.type==="password"&&(N.id&&e(N.id),N.password&&r(N.password))}if(window.localStorage.getItem("cashy:rememberLogin")==="true")try{const N=sessionStorage.getItem("cashy:rememberedPassword");N&&!n&&r(N)}catch{}}catch{}})()},[]);const b=async P=>{if(P.preventDefault(),o){kt.info("     ...");return}if(typeof navigator<"u"&&navigator.onLine===!1){kt.error("   .      .");return}const T=(t||"").trim().toLowerCase(),N=(n||"").trim();if(console.log("    :",{email:T,password:"***"}),!t||!n){kt.error("   ");return}if(!/^\S+@\S+\.\S+$/.test(T)){kt.error("    ");return}a(!0);try{try{await p7(qt,u?WE:qE);try{window.localStorage.setItem("cashy:rememberLogin",u?"true":"false")}catch{}}catch{}console.log("  signIn...");const{error:I}=await m(T,N);if(console.log(" SignIn result:",{error:I}),I){console.error("    :",I);const A=I==null?void 0:I.code;A==="auth/user-not-found"?kt.error("     "):A==="auth/wrong-password"?kt.error("   "):A==="auth/invalid-credential"?kt.error("      "):A==="auth/too-many-requests"?kt.error("      "):kt.error((I==null?void 0:I.message)||"    ")}else{console.log("    !"),kt.success("   !");try{if(u&&navigator.credentials&&window.PasswordCredential){const A=new window.PasswordCredential({id:T,name:T,password:N});await navigator.credentials.store(A)}if(u)try{sessionStorage.setItem("cashy:rememberedPassword",N)}catch{}else try{sessionStorage.removeItem("cashy:rememberedPassword")}catch{}}catch{}}}catch(I){console.error("   :",I),kt.error("   ")}finally{a(!1)}},_=P=>{if(o){P.preventDefault(),P.stopPropagation(),kt.info("     ...");return}if(typeof navigator<"u"&&navigator.onLine===!1){P.preventDefault(),P.stopPropagation(),kt.error("   .      .");return}t||kt.error("   "),n||kt.error("   ");const T=(t||"").trim().toLowerCase();T&&!/^\S+@\S+\.\S+$/.test(T)&&kt.error("    ")},S=()=>{E("/user/forgot-password")};return y.useEffect(()=>{if(!(typeof window<"u"&&window.matchMedia&&window.matchMedia("(pointer: coarse)").matches))return;const P=document.documentElement,T=document.body,N=P.style.overflow,I=T.style.overflow,A=P.style.overscrollBehaviorY,R=T.style.overscrollBehaviorY;return P.style.overflow="hidden",T.style.overflow="hidden",P.style.overscrollBehaviorY="none",T.style.overscrollBehaviorY="none",()=>{P.style.overflow=N||"",T.style.overflow=I||"",P.style.overscrollBehaviorY=A||"",T.style.overscrollBehaviorY=R||""}},[]),f.jsxs("div",{className:"relative min-h-[100dvh] w-full overflow-hidden flex items-center justify-center p-4 bg-no-repeat bg-cover",style:{backgroundImage:"var(--bg-purple-gradient)",backgroundAttachment:"fixed"},children:[l&&f.jsx("div",{className:"absolute top-0 left-0 right-0 bg-red-600 text-white text-center py-2 z-50 animate-in fade-in slide-in-from-top-2",children:f.jsx("p",{className:"text-sm font-medium",children:"   .        ."})}),f.jsx("div",{className:"absolute inset-0 bg-black/40"}),f.jsxs("div",{className:"w-full max-w-md mt-16 md:mt-12 lg:mt-10",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-green-600 to-blue-600 rounded-full mb-4 shadow-2xl",children:f.jsx(T5,{className:"w-10 h-10 text-white"})}),f.jsx("div",{className:"flex items-center justify-center mb-2",children:f.jsx("span",{className:"text-2xl font-extrabold text-white tracking-wider uppercase",dir:"ltr",style:{fontFamily:"Inter, sans-serif"},children:"cashy link"})}),f.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"  "}),f.jsx("p",{className:"text-white/80",children:"    "})]}),f.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-8 shadow-2xl border border-white/20",children:[f.jsxs("form",{onSubmit:b,className:"space-y-6",autoComplete:"on",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-white",children:" "}),f.jsxs("div",{className:"relative",children:[f.jsx(i0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/70 w-5 h-5"}),f.jsx(ir,{id:"username",type:"email",placeholder:"  ",value:t,onChange:P=>{const T=P.target.value;e(T);try{window.localStorage.setItem("cashy:lastEmail",T)}catch{}},name:"username",autoComplete:"username",className:"pl-10 pr-4 py-3 rounded-lg bg-white/20 border-white/30 text-white placeholder:text-white/70 focus:ring-2 focus:ring-green-400",dir:"rtl",required:!0})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-white",children:" "}),f.jsxs("div",{className:"relative",children:[f.jsx($y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/70 w-5 h-5"}),f.jsx(ir,{id:"password",type:s?"text":"password",placeholder:"  ",value:n,onChange:P=>r(P.target.value),className:"pl-10 pr-10 py-3 rounded-lg bg-white/20 border-white/30 text-white placeholder:text-white/70 focus:ring-2 focus:ring-green-400",name:"password",autoComplete:"current-password",dir:"rtl",required:!0}),f.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-white/70 hover:text-white transition-colors",children:s?f.jsx(Uh,{className:"w-5 h-5"}):f.jsx($h,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[f.jsx(rj,{id:"rememberLogin",checked:u,onCheckedChange:P=>d(!!P)}),f.jsx("label",{htmlFor:"rememberLogin",className:"text-sm text-white",children:"  "})]})]}),f.jsx("div",{className:"flex justify-end",children:f.jsxs(bt,{type:"button",variant:"ghost",size:"sm",onClick:S,className:"text-green-200 hover:text-green-100 p-0 h-auto font-normal hover:bg-transparent",children:[f.jsx(i0,{className:"w-4 h-4 ml-1"}),"  "]})}),f.jsx("button",{type:"submit",onClick:_,className:"w-full bg-gradient-to-r from-green-600 to-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:from-green-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-green-400 transition-all duration-200",children:o?f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white ml-2"}),"  ..."]}):f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx(pk,{className:"w-5 h-5 ml-2"})," "]})})]}),f.jsxs("div",{className:"mt-6 text-center space-y-3",children:[f.jsxs("p",{className:"text-sm text-white/80",children:["  "," ",f.jsx(v0,{to:"/user/register",className:"text-green-200 hover:text-green-100 font-medium transition-colors hover:underline",children:"  "})]}),f.jsxs("p",{className:"text-sm text-white/80",children:["        "," ",f.jsx("a",{href:"https://wa.me/201000392539",target:"_blank",rel:"noreferrer",className:"text-green-200 hover:text-green-100 font-medium hover:underline",children:"01000392539"})," ","   "," ",f.jsx("a",{href:"mailto:info@cashy-link.com",className:"text-blue-200 hover:text-blue-100 font-medium hover:underline",children:"info@cashy-link.com"})]})]})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsx("p",{className:"text-xs text-white/70",children:"   "})})]})]})},mee=Object.freeze(Object.defineProperty({__proto__:null,default:fy},Symbol.toStringTag,{value:"Module"})),Sd=y.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:yn("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));Sd.displayName="Card";const Id=y.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:yn("flex flex-col space-y-1.5 p-6",t),...e}));Id.displayName="CardHeader";const Td=y.forwardRef(({className:t,...e},n)=>f.jsx("h3",{ref:n,className:yn("text-2xl font-semibold leading-none tracking-tight",t),...e}));Td.displayName="CardTitle";const Fv=y.forwardRef(({className:t,...e},n)=>f.jsx("p",{ref:n,className:yn("text-sm text-muted-foreground",t),...e}));Fv.displayName="CardDescription";const xd=y.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:yn("p-6 pt-0",t),...e}));xd.displayName="CardContent";const sj=y.forwardRef(({className:t,...e},n)=>f.jsx("div",{ref:n,className:yn("flex items-center p-6 pt-0",t),...e}));sj.displayName="CardFooter";function ij({open:t,onOpenChange:e,onSuccess:n}){const{user:r,userSubscription:s}=Zs(),[i,o]=y.useState("1"),[a,l]=y.useState("basic"),[c,u]=y.useState(!1),[d,m]=y.useState(null),p=async()=>{var v;if(r){u(!0),m(null);try{const g=((v=s==null?void 0:s.branchPackage)==null?void 0:v.limit)||0;await xn(ye(F,"users",r.uid),{branchPackage:{status:"pending",requested:!0,limit:g+parseInt(i),packageType:a,requestedAt:new Date().toISOString()}}),m("       ."),window.dispatchEvent(new CustomEvent("userSubscriptionUpdated",{detail:{userId:r.uid,isActive:!0}})),setTimeout(()=>{e(!1),n&&n()},1500)}catch(g){m("  : "+g.message)}finally{u(!1)}}};return f.jsx(Ha,{open:t,onOpenChange:e,children:f.jsxs(Ro,{children:[f.jsx(al,{children:f.jsx(ll,{children:" "})}),f.jsxs("div",{className:"grid gap-4 py-2",children:[f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{children:"   "}),f.jsx(ir,{type:"number",min:"1",value:i,onChange:v=>o(v.target.value),placeholder:"   "})]}),f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{children:" "}),f.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:a,onChange:v=>l(v.target.value),children:[f.jsx("option",{value:"basic",children:"  ()"}),f.jsx("option",{value:"quarterly",children:"   (3 )"}),f.jsx("option",{value:"pro",children:"  ()"}),f.jsx("option",{value:"enterprise",children:"  ( )"})]})]}),d&&f.jsx("p",{className:`text-sm ${d.includes("")?"text-green-600":"text-red-600"}`,children:d})]}),f.jsxs(Vv,{children:[f.jsx(bt,{variant:"outline",onClick:()=>e(!1),children:""}),f.jsx(bt,{onClick:p,disabled:c,className:"bg-black text-white hover:bg-gray-800 dark:bg-white dark:text-black dark:hover:bg-gray-200",children:c?" ...":" "})]})]})})}const lne=Object.freeze(Object.defineProperty({__proto__:null,BranchRequestDialog:ij},Symbol.toStringTag,{value:"Module"}));function EP(){var k,C,L,O;const{user:t,profile:e,isSubscriptionActive:n,userSubscription:r}=Zs(),[s,i]=y.useState(!1),[o,a]=y.useState(!1),[l,c]=y.useState(""),[u,d]=y.useState(""),[m,p]=y.useState(""),[v,g]=y.useState(""),[E,b]=y.useState(!1),[_,S]=y.useState(null),[P,T]=y.useState(0),N=((k=r==null?void 0:r.branchPackage)==null?void 0:k.status)==="active",I=((C=r==null?void 0:r.branchPackage)==null?void 0:C.limit)||0;M.useEffect(()=>{t&&(async()=>{try{const ke=Ye(Ae(F,"shops"),Ne("ownerId","==",t.uid)),Oe=await RM(ke);T(Oe.data().count)}catch(ke){console.error("Error fetching shops count:",ke)}})()},[t]),(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="merchant"||n||N&&P<I;const A=()=>{c(""),d(""),p(""),g("")},R=async()=>{S(null);const X=l.trim(),ke=u.trim(),Oe=m.trim(),je=v;if(N&&P>=I&&(e==null?void 0:e.role)!=="admin"&&(e==null?void 0:e.role)!=="merchant"){S(`        (${I}).   .`);return}if(!X||!ke||!Oe||!je){S("    .");return}try{b(!0);const G=await XY(oV,"createShopAndManager")({shopName:X,managerName:ke,email:Oe,password:je,branchCode:null}),ae=G==null?void 0:G.data;ae!=null&&ae.success?(S(`   (${ae.shopId})   .`),A(),i(!1)):S("     .")}catch(W){const G=(W==null?void 0:W.message)||"     ";S(G)}finally{b(!1)}};return f.jsxs("div",{className:"container mx-auto p-4",children:[f.jsxs(Sd,{children:[f.jsx(Id,{children:f.jsx(Td,{children:"  (CPanel)"})}),f.jsxs(xd,{children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{children:f.jsx("p",{className:"text-sm text-muted-foreground",children:"           ."})}),f.jsxs("div",{className:"flex gap-2",children:[!N&&((L=r==null?void 0:r.branchPackage)==null?void 0:L.status)!=="pending"&&f.jsx(bt,{onClick:()=>a(!0),variant:"outline",children:"  "}),((O=r==null?void 0:r.branchPackage)==null?void 0:O.status)==="pending"&&f.jsx(bt,{disabled:!0,variant:"outline",className:"text-yellow-600 border-yellow-200 bg-yellow-50",children:"  "}),f.jsx(bt,{onClick:()=>i(!0),disabled:!1,children:" "})]})]}),!t&&f.jsx("p",{className:"mt-3 text-sm text-red-600",children:"      ."}),N&&f.jsxs("p",{className:"mt-3 text-sm text-green-600 font-medium",children:["  :  ",P,"   ",I," ."]}),t&&!1]})]}),f.jsx(Ha,{open:s,onOpenChange:i,children:f.jsxs(Ro,{children:[f.jsx(al,{children:f.jsx(ll,{children:"  "})}),f.jsxs("div",{className:"grid gap-4 py-2",children:[f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{htmlFor:"shopName",children:" "}),f.jsx(ir,{id:"shopName",value:l,onChange:X=>c(X.target.value),placeholder:":  "})]}),f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{htmlFor:"managerName",children:" "}),f.jsx(ir,{id:"managerName",value:u,onChange:X=>d(X.target.value),placeholder:":  "})]}),f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{htmlFor:"email",children:""}),f.jsx(ir,{id:"email",type:"email",value:m,onChange:X=>p(X.target.value),placeholder:"example@mail.com"})]}),f.jsxs("div",{className:"grid gap-2",children:[f.jsx(vr,{htmlFor:"password",children:""}),f.jsx(ir,{id:"password",type:"password",value:v,onChange:X=>g(X.target.value),onKeyDown:X=>{X.key==="Enter"&&(X.preventDefault(),R())},placeholder:""})]}),_&&f.jsx("p",{className:"text-sm text-muted-foreground",children:_})]}),f.jsxs(Vv,{children:[f.jsx(bt,{variant:"outline",onClick:()=>i(!1),disabled:E,children:""}),f.jsx(bt,{onClick:R,disabled:E||!1,children:E?" ...":" "})]})]})}),f.jsx(ij,{open:o,onOpenChange:a})]})}const SP=()=>{const[t,e]=y.useState(""),[n,r]=y.useState(""),[s,i]=y.useState(!1),[o,a]=y.useState(!1),{signIn:l}=Zs(),c=oo();y.useEffect(()=>{try{const d=typeof window<"u"?window.localStorage.getItem("cashy:lastEmail"):null;d&&e(d)}catch{}},[]);const u=async d=>{var m;if(d.preventDefault(),o){kt.info("     ...");return}if(typeof navigator<"u"&&navigator.onLine===!1){kt.error("   .      .");return}if(!t||!n){kt.error("     ");return}a(!0);try{const{error:p}=await l(t,n);if(p){const v=p==null?void 0:p.code;v==="auth/invalid-email"?kt.error("    "):v==="auth/user-not-found"?kt.error("     "):v==="auth/wrong-password"?kt.error("   "):v==="auth/invalid-credential"?kt.error("      "):v==="auth/too-many-requests"?kt.error("      "):kt.error((p==null?void 0:p.message)||"    ");return}try{const v=(m=qt.currentUser)==null?void 0:m.uid;v&&await rn(ye(F,"users",v),{branchPackage:{requested:!0,status:"pending",requestedAt:$e()},updatedAt:$e()},{merge:!0})}catch(v){console.warn("    :",v)}kt.success("   "),c("/cpanel")}catch(p){kt.error((p==null?void 0:p.message)||"     ")}finally{a(!1)}};return f.jsx("div",{className:"min-h-screen bg-background px-4 py-8 flex items-center justify-center",children:f.jsxs(Sd,{className:"w-full max-w-md",children:[f.jsxs(Id,{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(pE,{className:"w-6 h-6"}),f.jsx(Td,{children:"   "})]}),f.jsx(Fv,{children:"     "})]}),f.jsx(xd,{children:f.jsxs("form",{onSubmit:u,className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"email",children:" "}),f.jsxs("div",{className:"relative",children:[f.jsx(i0,{className:"absolute right-3 top-2.5 w-5 h-5 text-muted-foreground"}),f.jsx(ir,{id:"email",type:"email",value:t,onChange:d=>{const m=d.target.value;e(m);try{window.localStorage.setItem("cashy:lastEmail",m)}catch{}},placeholder:"example@mail.com",className:"pr-10"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"password",children:" "}),f.jsxs("div",{className:"relative",children:[f.jsx($y,{className:"absolute right-3 top-2.5 w-5 h-5 text-muted-foreground"}),f.jsx(ir,{id:"password",type:s?"text":"password",value:n,onChange:d=>r(d.target.value),placeholder:"",className:"pr-10"}),f.jsx("button",{type:"button",onClick:()=>i(d=>!d),className:"absolute left-3 top-2.5 text-muted-foreground","aria-label":s?"  ":"  ",children:s?f.jsx(Uh,{className:"w-5 h-5"}):f.jsx($h,{className:"w-5 h-5"})})]})]}),f.jsx("button",{type:"submit",onClick:d=>{o?(d.preventDefault(),d.stopPropagation(),kt.info("     ...")):typeof navigator<"u"&&navigator.onLine===!1?(d.preventDefault(),d.stopPropagation(),kt.error("   .      .")):(t||kt.error("   "),n||kt.error("   "))},className:"w-full inline-flex items-center justify-center gap-2 rounded-md bg-primary px-4 py-2 text-white hover:opacity-90",children:o?f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white ml-2"}),"  ..."]}):f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx(pk,{className:"w-5 h-5 ml-2"})," "]})}),f.jsxs("div",{className:"mt-4 text-center space-y-3",children:[f.jsx("p",{className:"text-sm text-muted-foreground",children:"  "}),f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx(v0,{to:"/user/forgot-password",className:"text-primary text-sm",children:"   "}),f.jsx("span",{className:"text-muted-foreground",children:""}),f.jsx(v0,{to:"/auth?mode=signup",className:"text-primary text-sm",children:"  "})]})]})]})})]})})},IP=()=>{const[t,e]=y.useState(null),n=oo();y.useEffect(()=>{const s=qt.onAuthStateChanged(i=>{e(i)});return()=>s()},[]);const r=async()=>{try{await qt.signOut(),n("/sms-portal/login")}catch(s){console.error("Logout error",s)}};return f.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 font-cairo",dir:"rtl",children:[f.jsxs("div",{className:"max-w-md mx-auto min-h-screen shadow-lg bg-white dark:bg-slate-950 border-x border-slate-200 dark:border-slate-800",children:[f.jsxs("header",{className:"p-4 border-b bg-primary text-primary-foreground flex justify-between items-center sticky top-0 z-10",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"font-bold text-lg",children:" "}),f.jsx("div",{className:"text-[10px] opacity-80 font-mono",children:"SMS Portal v1.0"})]}),t&&f.jsxs(bt,{variant:"ghost",size:"sm",onClick:r,className:"text-primary-foreground hover:bg-primary-foreground/10 hover:text-white",children:[f.jsx(s0,{className:"h-4 w-4 ml-2"}),""]})]}),f.jsx("main",{className:"p-4",children:f.jsx(mz,{})})]}),f.jsx(Nk,{position:"top-center"})]})},gp=()=>{const[t,e]=y.useState(""),[n,r]=y.useState(""),[s,i]=y.useState(!1),o=oo(),a=async l=>{if(l.preventDefault(),!t||!n){kt.error("     ");return}try{i(!0),await _2(qt,t,n),kt.success("   "),o("/sms-portal/dashboard")}catch(c){console.error("Login error:",c);let u="  ";(c.code==="auth/invalid-credential"||c.code==="auth/user-not-found"||c.code==="auth/wrong-password")&&(u="      "),kt.error(u)}finally{i(!1)}};return f.jsx("div",{className:"flex items-center justify-center min-h-[80vh]",children:f.jsxs(Sd,{className:"w-full max-w-sm border-none shadow-none",children:[f.jsxs(Id,{className:"text-center",children:[f.jsx("div",{className:"mx-auto bg-primary/10 p-4 rounded-full mb-4 w-fit",children:f.jsx(t5,{className:"h-8 w-8 text-primary"})}),f.jsx(Td,{className:"text-2xl",children:" "}),f.jsx(Fv,{children:"     Cashy      "})]}),f.jsx(xd,{children:f.jsxs("form",{onSubmit:a,className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"email",children:" "}),f.jsx(ir,{id:"email",type:"email",placeholder:"example@cashy.com",value:t,onChange:l=>e(l.target.value),disabled:s,className:"text-left",dir:"ltr"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(vr,{htmlFor:"password",children:" "}),f.jsx(ir,{id:"password",type:"password",value:n,onChange:l=>r(l.target.value),disabled:s,className:"text-left",dir:"ltr"})]}),f.jsx(bt,{type:"submit",className:"w-full",disabled:s,children:s?f.jsx(fE,{className:"ml-2 h-4 w-4 animate-spin"}):""})]})})]})})},oj=y.forwardRef(({className:t,...e},n)=>f.jsx("textarea",{className:yn("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));oj.displayName="Textarea";const pee=Uy("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function TP({className:t,variant:e,...n}){return f.jsx("div",{className:yn(pee({variant:e}),t),...n})}const yI=t=>{if(!t)return"";let e=t.replace(/[^\d+]/g,"");return e.startsWith("0020")?e=e.substring(4):e.startsWith("+20")?e=e.substring(3):e.startsWith("20")&&e.length>10&&(e=e.substring(2)),e.length===10&&(e.startsWith("10")||e.startsWith("11")||e.startsWith("12")||e.startsWith("15"))&&(e="0"+e),e},gee=t=>{if(!t.includes("Received EGP")||!t.includes("Available Balance"))return null;const e=t.replace(/\n/g," ").trim(),n=/Received\s+EGP\s*(\d+(?:\.\d+)?)/i,r=/from\s+(\d{10,15})/i,s=/Ref:\s*(\d+)/i,i=/Available Balance:\s*(\d+(?:\.\d+)?)/i,o=/^(.+?):\s*Received/i,a=e.match(n),l=e.match(r),c=e.match(s),u=e.match(i),d=e.match(o);return a?{amount:parseFloat(a[1]),sender:l?yI(l[1]):void 0,senderName:void 0,reference:c?c[1]:void 0,type:"receive",originalText:t,balance:u?parseFloat(u[1]):void 0,date:d?d[1].trim():void 0}:null},Ou=t=>{const e=String(t||""),n=e.replace(/\n/g," ").replace(/\s+/g," ").trim(),r=gee(e);if(r)return r;let s="receive";if(/(?:\s*|\s*|sent|transferred|\s*|\s*|\s*)/i.test(n)){const T=/(?:\s*|from|(?:\s*)?)/i.test(n),N=/(?:|to|||)/i.test(n);T&&!N?s="receive":s="transfer"}else(/InstaPay/i.test(n)||/Received\s*EGP/i.test(n)||/You\s*have\s*received/i.test(n)||/\s*/i.test(n))&&(s="receive");let i=0;const o=/(?:|amount)\s+(\d+(?:\.\d+)?)/i,a=n.match(o);if(a)i=parseFloat(a[1]);else{const T=n.match(/(?:\s*|\s*?\s*|?\s*|\s*|received|transfer)\s*(?:of)?\s*(?:EGP)?\s*([0-9.,]+)/i);T&&(i=parseFloat(String(T[1]).replace(/,/g,"")))}let l;if(s==="transfer"){const T=/(?:|\s*||to)\s*[:\-\s]*([\+\d]{10,14})/i,N=n.match(T);N&&(l=N[1])}else{const T=/(?:\s*|from\s*number|from||)\s*[:\-\s]*([\+\d]{10,14})/i,N=n.match(T);N&&(l=N[1])}l&&(l=yI(l));let c;const u=/(?:\s*(?:|)|\s*(?:|)|(?:|)|(?:\s*)?|)\s*[:\-\s]*([^\n:]+?)(?=\s*(?:||||transaction|ref|reference|||\.|$))/i,d=n.match(u);if(d)c=d[1].trim();else{const T=n.match(/(?:registered\s*(?:name|as)|from|sender|name)\s*[:\-]?\s*([A-Za-z][A-Za-z\s]+?)(?=\s*(?:balance|mobile|number|account|ref|transaction|$))/i);if(!c&&/InstaPay/i.test(n)){const N=n.match(/from\s+([A-Za-z\s]+?)(?=\s*(?:balance|account|ref|transaction|$))/i);N&&(c=N[1].trim())}if(!c&&/e&\s*money/i.test(n)){const N=n.match(/from\s+([A-Za-z\s]+?)\s+[0-9+]/i);N&&(c=N[1].trim())}!c&&T&&(c=T[1].trim())}let m;const p=/(?:\s*|transaction\s*id)\s+(\d+)/i,v=n.match(p);if(v)m=v[1];else{const T=n.match(/(?:Ref|Reference||[]|transaction\s*id|\s*(?:[]|[]||))\s*[:\-\s]*([0-9A-Za-z\-]+)/i),N=T?null:n.match(/\b([A-Za-z0-9\-]{10,})\b/g);m=T?T[1]:N?N[N.length-1]:void 0}let g;const E=/(?:(?:|(?:\s*))\s*(?:|)|current\s*balance)\s+(\d+(?:\.\d+)?)/i,b=n.match(E);b&&(g=parseFloat(b[1]));let _;const S=/(?:\s*|transaction\s*date)\s+([0-9\-:\s]+)/i,P=n.match(S);return P&&(_=P[1].trim()),{amount:i,sender:l,senderName:c,reference:m,type:s,originalText:e,balance:g,date:_}},xP=Object.freeze(Object.defineProperty({__proto__:null,normalizeMsisdnEgypt:yI,parseSms:Ou},Symbol.toStringTag,{value:"Module"})),AP=()=>{const[t,e]=y.useState(""),[n,r]=y.useState(null),[s,i]=y.useState([]),[o,a]=y.useState(!1),[l,c]=y.useState(null);y.useEffect(()=>{const v=qt.onAuthStateChanged(g=>{if(c(g),g){const E=Ye(Ae(F,"pendingSmsPopups"),Ne("userId","==",g.uid),Gs("createdAt","desc"),Uo(10)),b=$o(E,_=>{const S=_.docs.map(P=>({id:P.id,...P.data()}));i(S)});return()=>b()}});return()=>v()},[]);const u=()=>{if(!t.trim())return;const v=Ou(t);r(v),v.amount>0?kt.success("   ",{description:`${v.amount} .  ${v.sender||""}`}):kt.warning("       ")},d=async()=>{if(!(!n||!l))try{a(!0),await hr.saveUserTransaction(l.uid,{amount:n.amount,senderMsisdn:n.sender,senderName:n.senderName,reference:n.reference,type:n.type==="transfer"?"send":"receive",note:`SMS Parsing: ${n.type}`,originalSms:n.originalText,createdAt:new Date().toISOString(),status:"completed"}),kt.success("   "),e(""),r(null)}catch(v){console.error("Save error:",v),kt.error("  : "+v.message)}finally{a(!1)}},m=v=>{e(v.body||v.text||"");const g=Ou(v.body||v.text||"");r(g)},p=async(v,g)=>{if(g.stopPropagation(),!!confirm("      "))try{await Wn(ye(F,"pendingSmsPopups",v)),kt.success(" ")}catch{kt.error(" ")}};return l?f.jsxs("div",{className:"space-y-6",children:[s.length>0&&f.jsxs(Sd,{children:[f.jsx(Id,{className:"pb-3",children:f.jsxs(Td,{className:"text-lg flex items-center gap-2",children:[f.jsx(yk,{className:"h-5 w-5 text-blue-500"}),"    (",s.length,")"]})}),f.jsx(xd,{className:"space-y-2 max-h-60 overflow-y-auto",children:s.map(v=>{var g;return f.jsxs("div",{className:"p-3 border rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer transition-colors flex justify-between items-start group",onClick:()=>m(v),children:[f.jsxs("div",{className:"text-sm",children:[f.jsx("div",{className:"font-semibold mb-1",children:v.sender||""}),f.jsx("div",{className:"text-muted-foreground line-clamp-2",children:v.body||v.text}),f.jsx("div",{className:"text-xs text-muted-foreground mt-1 opacity-70",children:(g=v.createdAt)!=null&&g.toDate?v.createdAt.toDate().toLocaleString("ar-EG"):""})]}),f.jsx(bt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",onClick:E=>p(v.id,E),children:f.jsx(vk,{className:"h-4 w-4"})})]},v.id)})})]}),f.jsxs(Sd,{children:[f.jsxs(Id,{children:[f.jsx(Td,{children:" "}),f.jsx(Fv,{children:"      "})]}),f.jsxs(xd,{className:"space-y-4",children:[f.jsx(oj,{placeholder:":    1000   ...",className:"min-h-[100px]",value:t,onChange:v=>e(v.target.value)}),f.jsx("div",{className:"flex justify-end",children:f.jsxs(bt,{onClick:u,disabled:!t.trim(),children:[f.jsx(u5,{className:"mr-2 h-4 w-4"})," "]})}),n&&f.jsx("div",{className:"mt-6 p-4 bg-slate-50 dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-800 space-y-4",children:f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx(vr,{className:"text-xs text-muted-foreground",children:""}),f.jsxs("div",{className:"text-xl font-bold text-green-600",children:[n.amount," ."]})]}),f.jsxs("div",{children:[f.jsx(vr,{className:"text-xs text-muted-foreground",children:""}),f.jsx("div",{children:n.type==="transfer"?f.jsx(TP,{variant:"outline",className:"bg-orange-100 text-orange-800 border-orange-200",children:" ()"}):f.jsx(TP,{variant:"outline",className:"bg-green-100 text-green-800 border-green-200",children:" ()"})})]}),f.jsxs("div",{children:[f.jsx(vr,{className:"text-xs text-muted-foreground",children:" / "}),f.jsx("div",{className:"font-mono dir-ltr text-right",children:n.sender||"-"})]}),f.jsxs("div",{children:[f.jsx(vr,{className:"text-xs text-muted-foreground",children:""}),f.jsx("div",{children:n.senderName||"-"})]}),n.reference&&f.jsxs("div",{className:"col-span-2",children:[f.jsx(vr,{className:"text-xs text-muted-foreground",children:" (Reference)"}),f.jsx("div",{className:"font-mono text-xs",children:n.reference})]})]})})]}),f.jsxs(sj,{className:"justify-between border-t p-4 bg-slate-50/50 dark:bg-slate-900/50",children:[f.jsx(bt,{variant:"ghost",onClick:()=>{e(""),r(null)},children:""}),f.jsxs(bt,{onClick:d,disabled:!n||n.amount<=0||o,className:"bg-green-600 hover:bg-green-700 text-white",children:[o?f.jsx(fE,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(L3,{className:"mr-2 h-4 w-4"})," "]})]})]})]}):f.jsx("div",{className:"p-8 text-center",children:" ..."})};function yee({size:t=24,className:e,...n}){return f.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,...n,children:[f.jsx("rect",{x:"5",y:"2.5",width:"14",height:"19",rx:"2.5",stroke:"currentColor",strokeWidth:"1.5"}),f.jsx("rect",{x:"7",y:"4.5",width:"10",height:"5.5",rx:"1",stroke:"currentColor",strokeWidth:"1.2"}),f.jsx("path",{d:"M9.5 11.5h5",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round"}),f.jsx("circle",{cx:"8.5",cy:"14",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("circle",{cx:"12",cy:"14",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("circle",{cx:"15.5",cy:"14",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("circle",{cx:"8.5",cy:"17",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("circle",{cx:"12",cy:"17",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("circle",{cx:"15.5",cy:"17",r:"0.9",stroke:"currentColor",strokeWidth:"1"}),f.jsx("rect",{x:"8",y:"19",width:"9",height:"1.8",rx:"0.6",stroke:"currentColor",strokeWidth:"1"})]})}const PP=t=>{try{const e=t||"default",n=localStorage.getItem(`hiddenQuickActions_${e}`)??localStorage.getItem("hiddenQuickActions"),r=n?JSON.parse(n):[];return Array.isArray(r)?r.filter(s=>typeof s=="string"):[]}catch{return[]}},vee=()=>{const t=oo(),e=Ii(),{signOut:n,user:r,userSubscription:s}=Zs(),{toast:i}=hl(),[o,a]=y.useState(!1),[l,c]=y.useState(!1),[u,d]=y.useState(()=>PP(r==null?void 0:r.uid)),[m,p]=y.useState(0);M.useEffect(()=>{const T=I=>{p(I.detail.count)};window.addEventListener("support-chat-unread",T);const N=localStorage.getItem("support_chat_unread_count");return N&&p(parseInt(N,10)),()=>window.removeEventListener("support-chat-unread",T)},[]),M.useEffect(()=>{d(PP(r==null?void 0:r.uid))},[r==null?void 0:r.uid]);const v=(T,N,I={},A={})=>{if(e.pathname.startsWith("/user/dashboard"))window.dispatchEvent(new CustomEvent("dashboard-navigation-action",{detail:{action:T,payload:A}}));else{const R=N?{[N]:!0,...I}:{...I};t("/user/dashboard",{state:R})}},g=[{id:"home",label:"",icon:W3,path:"/user/dashboard",action:()=>{const T=()=>{const N=document.getElementById("dashboard-content-container");N&&(N.scrollTop=0,N.scrollTo(0,0));const I=document.querySelector(".user-dashboard");I&&(I.scrollTop=0,I.scrollTo(0,0)),window.scrollTo(0,0),document.body.scrollTop=0,document.documentElement.scrollTop=0};e.pathname==="/user/dashboard"?(e.state&&Object.keys(e.state).length>0&&t("/user/dashboard",{replace:!0,state:{}}),T()):t("/user/dashboard"),setTimeout(T,10),setTimeout(T,50),setTimeout(T,150),setTimeout(T,300)}},{id:"debts",label:"",icon:B3,path:"/debts",action:()=>{var T;(T=e.state)!=null&&T.openDebtDialog||v("debts","openDebtDialog")}},{id:"transfer",label:"",icon:P3,path:"/transfer",action:()=>{v("transaction-section","openTransactionSection",{transactionType:"transfer",startNewTransaction:!0},{transactionType:"transfer",startNewTransaction:!0,skipAnimation:!0})}},{id:"add",label:"",icon:lx,path:"/add",isSpecial:!0},{id:"withdraw",label:"",icon:T3,path:"/withdraw",action:()=>{v("transaction-section","openTransactionSection",{transactionType:"withdraw",startNewTransaction:!0},{transactionType:"withdraw",startNewTransaction:!0,skipAnimation:!0})}},{id:"support",label:"",icon:Yc,path:"#",action:()=>{window.dispatchEvent(new CustomEvent("open-support-chat"))}},{id:"settings",label:"",icon:ux,path:"/user/dashboard",action:()=>{v("profile-settings","openProfileSettings")}}],b=[{id:"lines",label:"",icon:yk,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openSimCardsDialog)&&v("lines","openSimCardsDialog")},color:"#9333ea"},{id:"installment",label:"",icon:C3,action:()=>{var N,I;a(!1);const T=(N=s==null?void 0:s.subscription)==null?void 0:N.planType;if(T===Fl.TAHWEELA||T===Fl.ZERO){i({title:"  ",description:"      .",variant:"destructive"});return}(I=e.state)!=null&&I.openInstallment||v("installment","openInstallment")},color:"#7C3AED"},{id:"maintenance",label:"",icon:A5,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openMaintenanceDialog)&&v("maintenance","openMaintenanceDialog")},color:"#0EA5E9"},{id:"machine",label:"",icon:yee,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openMachineDailyDialog)&&v("machine-daily","openMachineDailyDialog")},color:"#F59E0B"},{id:"atm-withdraw",label:" ATM",icon:G3,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openAtmWithdrawDialog)&&v("atm-withdraw","openAtmWithdrawDialog")},color:"#10B981"},{id:"pending-operations",label:" ",icon:ax,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openPendingOperationsDialog)&&v("pending-operations","openPendingOperationsDialog")},color:"#ea580c"},{id:"credit-cards",label:" ",icon:j3,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openCreditCardsDialog)&&v("credit-cards","openCreditCardsDialog")},color:"#8B5CF6"},{id:"sales",label:"",icon:E5,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openSalesDialog)&&v("sales","openSalesDialog")},color:"#F59E0B"},{id:"shop-expenses",label:" ",icon:cx,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openShopExpensesDialog)&&v("shop-expenses","openShopExpensesDialog")},color:"#F97316"},{id:"deficiencies",label:"",icon:wk,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openDeficienciesDialog)&&v("deficiencies","openDeficienciesDialog")},color:"#DB2777"},{id:"branch-management",label:" ",icon:w5,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openBranchManagement)&&v("branch-management","openBranchManagement")},color:"#14b8a6"},{id:"my-client-numbers",label:"",icon:i5,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openMyClientNumbersDialog)&&v("my-client-numbers","openMyClientNumbersDialog")},color:"#22C55E"},{id:"add-wallet",label:" ",icon:lx,action:()=>{a(!1),v("wallet-management","openWalletManagement",{walletManagementMode:"add"},{autoStartAdd:!0})},color:"#EF4444"},{id:"cashier-shift",label:" ",icon:ax,action:()=>{var T;a(!1),!((T=e.state)!=null&&T.openCashierShiftModal)&&v("cashier-shift","openCashierShiftModal")},color:"#3B82F6"},{id:"logout",label:" ",icon:s0,action:async()=>{a(!1);try{await n()}catch(T){console.error("Logout error:",T)}},color:"#EF4444"}].filter(T=>!u.includes(T.id)),_=[{id:"shop-expenses-settings",label:" ",icon:cx,action:()=>{var T;c(!1),!((T=e.state)!=null&&T.openShopExpensesDialog)&&t("/user/dashboard",{state:{openShopExpensesDialog:!0}})},color:"#F97316"},{id:"profile-settings",label:"  ",icon:ux,action:()=>{c(!1),e.pathname.startsWith("/user/dashboard")?window.dispatchEvent(new CustomEvent("dashboard-navigation-action",{detail:{action:"profile-settings"}})):t("/user/dashboard",{state:{openProfileSettings:!0}})},color:"#6366F1"},{id:"logout",label:" ",icon:s0,action:async()=>{c(!1);try{await n()}catch(T){console.error("Logout error:",T)}},color:"#EF4444"}],S=(T,N,I,A)=>{var O;const k=((O=s==null?void 0:s.subscription)==null?void 0:O.planType)===Fl.TAHWEELA,C=X=>["/user/dashboard","/profile-settings"].includes(X),L=X=>X==="debts"||X==="support";if(I){if(k&&!L(A)&&!C(T)){i({title:"  ",description:"      .",variant:"destructive"});return}I()}else if(N&&T==="/add"){if(k){i({title:"  ",description:"      .",variant:"destructive"});return}a(!o)}else if(!N){if(k&&!C(T)){i({title:"  ",description:"      .",variant:"destructive"});return}if(e.pathname===T&&!I)return;t(T)}},P=T=>e.pathname===T;return f.jsxs("div",{className:"mobile-bottom-nav",children:[o&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"quick-actions-overlay",onClick:()=>a(!1)}),f.jsx("div",{className:"quick-actions-bottomsheet",children:f.jsx("div",{className:"quick-actions-grid",children:b.map((T,N)=>f.jsxs("button",{type:"button",className:"quick-action-tile",onClick:()=>{var A;if(((A=s==null?void 0:s.subscription)==null?void 0:A.planType)===Fl.TAHWEELA){i({title:"  ",description:"      .",variant:"destructive"});return}a(!1),T.action()},style:{"--action-color":T.color,"--animation-delay":"0s"},children:[f.jsx("div",{className:"quick-action-icon",children:f.jsx(T.icon,{className:"action-icon"})}),f.jsx("span",{className:"quick-action-label",children:T.label})]},T.id))})})]}),l&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"quick-actions-overlay",onClick:()=>c(!1)}),f.jsx("div",{className:"quick-actions-bottomsheet",children:f.jsx("div",{className:"quick-actions-grid",children:_.map((T,N)=>f.jsxs("button",{type:"button",className:"quick-action-tile",onClick:()=>{var R;const I=(R=s==null?void 0:s.subscription)==null?void 0:R.planType,A=new Set(["logout","profile-settings"]);if(I===Fl.TAHWEELA&&!A.has(T.id)){i({title:"  ",description:"      .",variant:"destructive"});return}c(!1),T.action()},style:{"--action-color":T.color,"--animation-delay":`${N*.06}s`},children:[f.jsx("div",{className:"quick-action-icon",children:f.jsx(T.icon,{className:"action-icon"})}),f.jsx("span",{className:"quick-action-label",children:T.label})]},T.id))})})]}),f.jsx("nav",{className:"mobile-bottom-nav-container",children:g.map(T=>{const N=T.icon,I=P(T.path);return f.jsxs("button",{onClick:()=>S(T.path,T.isSpecial,T.action,T.id),className:`mobile-nav-item ${I?"active":""} ${T.isSpecial?"special":""}`,type:"button","aria-label":T.label,style:{backgroundColor:"transparent"},children:[f.jsxs("div",{className:`nav-icon-container relative ${T.isSpecial?"special-icon":""} ${T.isSpecial&&T.id==="add"&&o?"special-open":""}`,children:[f.jsx(N,{className:`nav-icon ${I?"active-icon":""} ${T.isSpecial?"special-icon-svg":""} ${T.isSpecial&&T.id==="settings"&&l?"rotated":""}`}),T.id==="support"&&m>0&&f.jsx("span",{className:"absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white shadow-sm ring-1 ring-white",children:m>99?"99+":m})]}),!T.isSpecial&&f.jsx("span",{className:`nav-label ${I?"active-label":""}`,children:T.label})]},T.id)})})]})};var gR,yR;const mu=(yR=(gR=import.meta)==null?void 0:gR.env)==null?void 0:yR.VITE_ANDROID_DOWNLOAD_URL;var vR,wR;const pu=(wR=(vR=import.meta)==null?void 0:vR.env)==null?void 0:wR.VITE_PC_DOWNLOAD_URL;var _R,bR;const gu=(bR=(_R=import.meta)==null?void 0:_R.env)==null?void 0:bR.VITE_PC32_DOWNLOAD_URL;var ER,SR;const yu=(SR=(ER=import.meta)==null?void 0:ER.env)==null?void 0:SR.VITE_ANDROID_VERSION;var IR,TR;const vu=(TR=(IR=import.meta)==null?void 0:IR.env)==null?void 0:TR.VITE_PC_VERSION;var xR,AR;const wu=(AR=(xR=import.meta)==null?void 0:xR.env)==null?void 0:AR.VITE_PC32_VERSION;function Tr(t){if(t)try{const n=(t.split("?")[0].split("#")[0].split("/").pop()||"").match(/v?(\d+\.\d+(?:\.\d+)?)/i);return n==null?void 0:n[1]}catch{return}}const RP=["siteContent","sms_agent_updates"];async function wee(t,e){const n={};Object.entries(t||{}).forEach(([s,i])=>{i!==void 0&&(n[s]=i)});const r={...n,updatedAt:$e(),updatedBy:e||"admin"};await rn(ye(F,RP[0],RP[1]),r,{merge:!0})}function _ee(t){if(t&&Xp(t)!==void 0)try{const e=t.match(/drive\.google\.com\/file\/d\/([^/]+)\//),n=t.match(/drive\.google\.com\/open\?id=([^&]+)/),r=(e==null?void 0:e[1])||(n==null?void 0:n[1]);return r?`https://drive.google.com/uc?export=download&id=${r}`:(/drive\.google\.com\/uc\?/.test(t),t)}catch{return t}}const Ad=["siteContent","appDownloads"],my=["siteContent","desktop_updates"],py=["siteContent","android_updates"],Hs="appDownloadsCache",bee=6*60*60*1e3,Eee=["1LMXQdSVB3-gIW-89fwWoq113IIEelhxR"];function Xp(t){if(t){for(const e of Eee)if(t.includes(e))return;return t}}function $l(t){return{...t,androidUrl:Xp(t.androidUrl),pcUrl:Xp(t.pcUrl),pc32Url:Xp(t.pc32Url)}}function See(){try{const e=localStorage.getItem(Hs);if(e){const n=JSON.parse(e),r={androidUrl:(n==null?void 0:n.androidUrl)||mu,pcUrl:(n==null?void 0:n.pcUrl)||pu,pc32Url:(n==null?void 0:n.pc32Url)||gu,androidVersion:(n==null?void 0:n.androidVersion)||yu,pcVersion:(n==null?void 0:n.pcVersion)||vu,pc32Version:(n==null?void 0:n.pc32Version)||wu,updatedAt:n==null?void 0:n.updatedAt,updatedBy:n==null?void 0:n.updatedBy};return r.pcVersion||(r.pcVersion=Tr(r.pcUrl)),r.androidVersion||(r.androidVersion=Tr(r.androidUrl)),r.pc32Version||(r.pc32Version=Tr(r.pc32Url)),$l(r)}}catch{}const t={androidUrl:mu,pcUrl:pu,pc32Url:gu,androidVersion:yu,pcVersion:vu,pc32Version:wu};return t.pcVersion||(t.pcVersion=Tr(t.pcUrl)),t.androidVersion||(t.androidVersion=Tr(t.androidUrl)),t.pc32Version||(t.pc32Version=Tr(t.pc32Url)),$l(t)}async function aj(t=!1){try{if(!t)try{const r=localStorage.getItem(Hs),s=localStorage.getItem(Hs+"_ts");if(r&&s&&Date.now()-Number(s)<bee){const o=JSON.parse(r);return $l(o)}}catch{}const e=await Sn(ye(F,Ad[0],Ad[1]));if(e.exists()){const r=e.data();try{localStorage.setItem(Hs,JSON.stringify(r)),localStorage.setItem(Hs+"_ts",String(Date.now()))}catch{}const s={androidUrl:(r==null?void 0:r.androidUrl)||mu,pcUrl:(r==null?void 0:r.pcUrl)||pu,pc32Url:(r==null?void 0:r.pc32Url)||gu,androidVersion:(r==null?void 0:r.androidVersion)||yu,pcVersion:(r==null?void 0:r.pcVersion)||vu,pc32Version:(r==null?void 0:r.pc32Version)||wu,updatedAt:r==null?void 0:r.updatedAt,updatedBy:r==null?void 0:r.updatedBy};return s.pcVersion||(s.pcVersion=Tr(s.pcUrl)),s.androidVersion||(s.androidVersion=Tr(s.androidUrl)),s.pc32Version||(s.pc32Version=Tr(s.pc32Url)),$l(s)}const n={androidUrl:mu,pcUrl:pu,pc32Url:gu,androidVersion:yu,pcVersion:vu,pc32Version:wu};return n.pcVersion||(n.pcVersion=Tr(n.pcUrl)),n.androidVersion||(n.androidVersion=Tr(n.androidUrl)),n.pc32Version||(n.pc32Version=Tr(n.pc32Url)),$l(n)}catch(e){const n=(e==null?void 0:e.message)||"";((e==null?void 0:e.code)||"")==="permission-denied"||n.includes("Missing or insufficient permissions")?console.warn(" Cannot read app downloads (unauth/public). Using cached or empty.",e):console.error(" Error loading app downloads:",e);try{const i=localStorage.getItem(Hs);if(i){const o=JSON.parse(i),a={androidUrl:(o==null?void 0:o.androidUrl)||mu,pcUrl:(o==null?void 0:o.pcUrl)||pu,pc32Url:(o==null?void 0:o.pc32Url)||gu,androidVersion:(o==null?void 0:o.androidVersion)||yu,pcVersion:(o==null?void 0:o.pcVersion)||vu,pc32Version:(o==null?void 0:o.pc32Version)||wu,updatedAt:o==null?void 0:o.updatedAt,updatedBy:o==null?void 0:o.updatedBy};return a.pcVersion||(a.pcVersion=Tr(a.pcUrl)),a.androidVersion||(a.androidVersion=Tr(a.androidUrl)),a.pc32Version||(a.pc32Version=Tr(a.pc32Url)),$l(a)}}catch{}const s={androidUrl:mu,pcUrl:pu,pc32Url:gu,androidVersion:yu,pcVersion:vu,pc32Version:wu};return s.pcVersion||(s.pcVersion=Tr(s.pcUrl)),s.androidVersion||(s.androidVersion=Tr(s.androidUrl)),s.pc32Version||(s.pc32Version=Tr(s.pc32Url)),$l(s)}}function Iee(t){return aj().then(t),()=>{}}async function Tee(t,e,n,r,s,i=12e4){const o=iV(),a=t.name.replace(/[^a-zA-Z0-9_.-]/g,"_"),l=`public/apps/${e}/${Date.now()}_${a}`,c=cX(o,l);return new Promise((u,d)=>{const m=aX(c,t);let p=!1;const v=setTimeout(()=>{p=!0;try{m.cancel()}catch{}d(new Error("Upload timed out"))},i);m.on("state_changed",g=>{const E=Math.round(g.bytesTransferred/g.totalBytes*100);s&&s(E)},g=>{clearTimeout(v),d(g)},async()=>{try{if(clearTimeout(v),p)return;const g=await lX(c),E={updatedAt:$e(),updatedBy:n||"admin"};e==="android"?(E.androidUrl=g,r&&(E.androidVersion=r)):e==="pc"?(E.pcUrl=g,r&&(E.pcVersion=r)):(E.pc32Url=g,r&&(E.pc32Version=r));const b=Math.min(Math.max(2e4,Math.floor(i/10)),6e4),_=rn(ye(F,Ad[0],Ad[1]),E,{merge:!0});try{const T=localStorage.getItem(Hs),I={...T?JSON.parse(T):{},...E};localStorage.setItem(Hs,JSON.stringify(I)),localStorage.setItem(Hs+"_ts",String(Date.now()))}catch{}let S=!1;const P=new Promise(T=>setTimeout(()=>{S=!0,T()},b));try{await Promise.race([_,P])}catch(T){console.warn(" Firestore write error, proceeding with URL only:",T)}S&&console.warn(" Firestore update timed out;             ."),u(g)}catch(g){d(g)}})})}async function xee(t,e){const n={};Object.entries(t||{}).forEach(([s,i])=>{i!==void 0&&(n[s]=i)});const r={...n,updatedAt:$e(),updatedBy:e||"admin"};await rn(ye(F,Ad[0],Ad[1]),r,{merge:!0});try{const s=localStorage.getItem(Hs),i=s?JSON.parse(s):{},o={...r,updatedAt:Date.now()},a={...i,...o};localStorage.setItem(Hs,JSON.stringify(a)),localStorage.setItem(Hs+"_ts",String(Date.now()))}catch{}}async function Aee(t,e){const n={};Object.entries(t||{}).forEach(([s,i])=>{i!==void 0&&(n[s]=i)});const r={...n,updatedAt:$e(),updatedBy:e||"admin"};await rn(ye(F,my[0],my[1]),r,{merge:!0});try{const s=localStorage.getItem("desktop_update_cache"),i=s?JSON.parse(s):{},o={...r,updatedAt:Date.now()},a={...i,...o};localStorage.setItem("desktop_update_cache",JSON.stringify(a))}catch{}}function lj(t){const e=ye(F,my[0],my[1]);return $o(e,r=>{if(r.exists()){const s=r.data(),i={version:s!=null&&s.version?String(s.version):void 0,downloadURL_64:s!=null&&s.downloadURL_64?String(s.downloadURL_64):void 0,downloadURL_32:s!=null&&s.downloadURL_32?String(s.downloadURL_32):void 0,notes:s!=null&&s.notes?String(s.notes):void 0,force:(s==null?void 0:s.force)===!0||(s==null?void 0:s.force)==="true"};try{localStorage.setItem("desktop_update_cache",JSON.stringify(i))}catch{}t(i)}},r=>{console.warn("Error listening to desktop updates:",r)})}function cj(t){try{const e=(typeof navigator<"u"?navigator.userAgent.toLowerCase():"")||"",n=e.includes("win64")||e.includes("x64")||e.includes("wow64")||e.includes("amd64"),r=e.includes("arm64");return String(n||r?(t==null?void 0:t.downloadURL_64)||(t==null?void 0:t.downloadURL_32)||"":(t==null?void 0:t.downloadURL_32)||(t==null?void 0:t.downloadURL_64)||"")}catch{return(t==null?void 0:t.downloadURL_64)||(t==null?void 0:t.downloadURL_32)}}async function Pee(t,e){const n={};Object.entries(t||{}).forEach(([s,i])=>{i!==void 0&&(n[s]=i)});const r={...n,updatedAt:$e(),updatedBy:e||"admin"};await rn(ye(F,py[0],py[1]),r,{merge:!0});try{const s=localStorage.getItem("android_update_cache"),i=s?JSON.parse(s):{},o={...r,updatedAt:Date.now()},a={...i,...o};localStorage.setItem("android_update_cache",JSON.stringify(a))}catch{}}async function uj(){try{const t=ye(F,py[0],py[1]),e=await Sn(t),n=(e.exists()?e.data():{})||{},r={version:n!=null&&n.version?String(n.version):void 0,url:n!=null&&n.url?String(n.url):void 0,notes:n!=null&&n.notes?String(n.notes):void 0,force:!!(n!=null&&n.force),code:typeof(n==null?void 0:n.code)=="number"?n.code:typeof(n==null?void 0:n.versionCode)=="number"?n.versionCode:void 0};try{localStorage.setItem("android_update_cache",JSON.stringify(r))}catch{}return r}catch(t){console.warn("Error fetching android updates:",t);try{const e=localStorage.getItem("android_update_cache");if(e)return JSON.parse(e)}catch{}return{}}}function Ree(t){return uj().then(t),()=>{}}const Cee=Object.freeze(Object.defineProperty({__proto__:null,fetchAndroidUpdates:uj,getAppDownloads:aj,getCachedOrEnvAppDownloads:See,listenAndroidUpdates:Ree,listenAppDownloads:Iee,listenDesktopUpdates:lj,resolveDownloadUrl:_ee,selectDesktopUrl:cj,setAndroidUpdateInfo:Pee,setAppDownloadLinks:xee,setDesktopUpdateInfo:Aee,setSmsAgentUpdateInfo:wee,uploadAppBinaryResumable:Tee},Symbol.toStringTag,{value:"Module"})),Nee=()=>{const t=typeof window<"u"?window.electronAPI:void 0,e=!!t,[n,r]=M.useState(!1),[s,i]=M.useState(!1),[o,a]=M.useState(!1),[l,c]=M.useState(0),[u,d]=M.useState(""),[m,p]=M.useState(!1),v=async()=>{try{e&&t?await t.windowMinimize():console.info("windowMinimize (dev preview)")}catch(T){console.warn("failed to minimize",T)}},g=async()=>{try{e&&t?await t.windowClose():console.info("windowClose (dev preview)")}catch(T){console.warn("failed to close",T)}},E=async()=>{if(!m){p(!0);try{try{window.dispatchEvent(new CustomEvent("app:softRefresh"))}catch{}if(e&&t&&typeof t.windowReload=="function"){setTimeout(()=>{try{t.windowReload()}catch{}},50),setTimeout(()=>p(!1),600);return}try{window.location.reload()}catch{}}catch(T){console.warn("failed to soft refresh",T),p(!1)}}};if(M.useEffect(()=>{if(!(!e||!t))try{t.onUpdateAvailable(()=>r(!0)),t.onUpdateDownloaded(()=>r(!0)),typeof t.onUpdateError=="function"&&t.onUpdateError(()=>{a(!1)}),typeof t.onUpdateProgress=="function"&&t.onUpdateProgress(T=>{const N=(T==null?void 0:T.percent)==null?0:Number(T.percent);a(!0),c(Math.max(0,Math.min(100,isNaN(N)?0:N)))}),t.checkUpdate()}catch(T){console.warn("update init failed",T)}},[e,t]),M.useEffect(()=>{const T=lj(N=>{if(String((N==null?void 0:N.version)||"")){r(!0);const A=cj({downloadURL_64:N==null?void 0:N.downloadURL_64,downloadURL_32:N==null?void 0:N.downloadURL_32})||"";d(A)}});return()=>{try{T()}catch{}}},[]),!e)return null;const[_,S]=M.useState(!1),P=async()=>{try{if(!t)return;_?(typeof t.windowFullscreen=="function"&&await t.windowFullscreen(),S(!1)):(typeof t.windowWindowed=="function"&&await t.windowWindowed(),S(!0))}catch(T){console.warn("window toggle failed",T)}};return f.jsxs("div",{className:"fixed top-2 right-2 z-[9999] flex flex-col items-center gap-2",style:{pointerEvents:"auto"},children:[f.jsx("button",{type:"button","aria-label":"",title:"",onClick:g,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-red-600 hover:bg-red-500/10 focus:outline-none dark:text-red-400 dark:hover:bg-red-400/10",children:f.jsx($i,{className:"w-5 h-5"})}),f.jsx("button",{type:"button","aria-label":"",title:" ",onClick:E,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-blue-600 hover:bg-blue-500/10 focus:outline-none dark:text-blue-400 dark:hover:bg-blue-400/10",children:f.jsx(mE,{className:`w-5 h-5 ${m?"animate-spin":""}`})}),f.jsx("button",{type:"button","aria-label":"",title:"",onClick:v,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-gray-800 hover:bg-black/10 focus:outline-none dark:text-white/80 dark:hover:bg-white/10",children:f.jsx(r5,{className:"w-5 h-5"})}),f.jsx("button",{type:"button","aria-label":"/",title:_?"":" ",onClick:P,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-gray-700 hover:bg-black/10 focus:outline-none dark:text-white/80 dark:hover:bg-white/10",children:f.jsx(y5,{className:"w-5 h-5"})})]})},ub=({className:t=""})=>{var l,c;const n=typeof window<"u"&&window.location&&window.location.protocol==="file:"?"./":`${((c=(l=import.meta)==null?void 0:l.env)==null?void 0:c.BASE_URL)||"/"}`,[r,s]=y.useState(`${n}logo.svg`),[i,o]=y.useState(0),a=y.useCallback(()=>{o(u=>{const d=u+1;return d===1?s(`${n}logo.png`):d===2&&s(`${n}placeholder.svg`),d})},[]);return f.jsxs("div",{className:`min-h-screen bg-background flex items-center justify-center ${t}`,children:[f.jsx("style",{children:`
        @keyframes loaderSpin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `}),f.jsxs("div",{className:"flex flex-col items-center justify-center",children:[f.jsx("img",{src:r,onError:a,alt:"logo",className:"w-32 h-32",style:{filter:"drop-shadow(0 6px 12px rgba(0,0,0,0.15))",animation:"loaderSpin 0.7s linear infinite",willChange:"transform"}}),f.jsx("p",{className:"mt-5 text-2xl font-extrabold tracking-wide text-transparent bg-clip-text",style:{fontFamily:"'Cairo','Tajawal','Noto Sans Arabic',sans-serif",backgroundImage:"var(--gradient-hero)"},children:"  "})]})]})},CP=Yd("SplashScreen",{web:()=>ee(()=>import("./web-DHFI57F3.js"),[],import.meta.url).then(t=>new t.SplashScreenWeb)});var gy;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(gy||(gy={}));var NP;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(NP||(NP={}));const ia=Yd("StatusBar"),kP=Yd("AppLauncher",{web:()=>ee(()=>import("./web-8BICCLu4.js"),[],import.meta.url).then(t=>new t.AppLauncherWeb)});function kee(t,e){if(!t||!t.trim())throw new Error("USSD code is required");const n=`tel:${t.replace(/#/g,"%23")}`,s=`cashy://ussd?code=${t.replace(/#/g,"%23")}${e?`&sim=${e}`:""}`;let i=!1;try{ge&&ge.getPlatform()!=="web"&&(kP.openUrl({url:s}),i=!0)}catch{}if(!i)try{window.location.href=s,i=!0}catch{}if(!i){try{window.location.href=n}catch{}try{ge&&ge.getPlatform()!=="web"&&kP.openUrl({url:n})}catch{}}}function dj(t,e){const n=String(t||"").replace(/\D/g,""),r=Math.round(Number(e||0));return!n||n.length!==11||!n.startsWith("01")||!r||r<=0?null:n.startsWith("010")?`*9*7*${n}*${r}#`:n.startsWith("011")?`*323*${n}*${r}#`:n.startsWith("012")?`*115*1*${n}*${r}#`:n.startsWith("015")?`*322*${n}*${r}#`:null}function Dee(t,e,n){const r=String(t||"").replace(/\D/g,""),s=String(e||"").replace(/\D/g,""),i=Math.round(Number(n||0));return!s||s.length!==11||!s.startsWith("01")||!i||i<=0?null:!r||!r.startsWith("01")?dj(s,i):r.startsWith("010")?`*9*7*${s}*${i}#`:r.startsWith("011")?`*323*${s}*${i}#`:r.startsWith("012")?`*7115*7*${s}*${i}#`:r.startsWith("015")?`*322*${s}*${i}#`:null}function cne(t,e,n){const r=dj(t,e),s=String(n||"").replace(/\D/g,"");return!r||!s?r:`${r.endsWith("#")?r.slice(0,-1):r}*${s}#`}function Oee(t){const e=String(t||"").replace(/\D/g,"");return e.startsWith("010")?"vodafone":e.startsWith("011")?"etisalat":e.startsWith("012")?"orange":e.startsWith("015")?"we":null}function Lee(t){const e=Oee(t),n=e?`simSlot_${e}`:"simSlot_default";try{if(localStorage.getItem(n)==="sim2")return"sim2"}catch{}return"sim1"}function une(t,e,n){const r=Dee(t,e,n);if(!r)throw new Error("Unsupported network or invalid sender/receiver/amount");const s=Lee(t||e);kee(r,s)}async function Mee(t,e="Cashy"){if(!t||!t.trim())throw new Error("Notification message is required");try{if(typeof Notification<"u"&&(Notification.permission==="granted"?"granted":await Notification.requestPermission())==="granted"){new Notification(e||"Cashy",{body:t});return}typeof window<"u"&&typeof alert=="function"?alert(`${e||"Cashy"}
${t}`):console.log(`[${e||"Cashy"}] ${t}`)}catch(n){console.warn("Notification not available:",n)}}function vI(t,e){return e==="send"?0:Math.round(t*.01)}function Vee(t,e,n=0){const r=vI(t,e),s=Math.max(0,r-n);return Math.round(s)}const To=Object.freeze(Object.defineProperty({__proto__:null,calculateCommission:vI,calculateProfit:Vee},Symbol.toStringTag,{value:"Module"})),jee=t=>t==="withdraw"||t==="receive"?"receive":"send",Fee=async t=>{if(!t)return null;const e=Ye(Ae(F,"transactions"),Ne("reference","==",t),Uo(1)),n=await Ze(e);return n.empty?null:n.docs[0].id},Uee=async t=>{var e;try{const n=await Ul.get({key:"selected_wallet_id"}),r=String((n==null?void 0:n.value)||"").trim();if(r)return r}catch{}return Wee(t||((e=qt.currentUser)==null?void 0:e.uid)||"")||null},i_=async t=>{try{const e=String(t||"").trim();if(!e)return null;const n=await ka.getByMsisdn(e);return(n==null?void 0:n.id)||null}catch{return null}},hj=async t=>{if(!t||!t.shopId||!t.lineId||!t.provider)throw new Error("   :   shopId  lineId  provider");if(!t.amount||t.amount<=0)throw new Error("     ");const e=await Fee(t.reference);if(e)return{id:e,duplicate:!0};const n=jee(t.type);let r=t.walletId&&String(t.walletId).trim()?String(t.walletId).trim():"";if(!r){let o=await i_(t.receiverMsisdn);if(o||(o=await i_(t.senderMsisdn)),!o){const a=String(t.lineId||"").replace(/\D/g,"");a.length>=10&&(o=await i_(a))}r=o||await Uee(t.createdBy)||""}if(!r)throw new Error("     ");try{const{transactionServiceExtra:o}=await ee(async()=>{const{transactionServiceExtra:m}=await Promise.resolve().then(()=>mo);return{transactionServiceExtra:m}},void 0,import.meta.url),a=await o.getMerchantTransactions(t.createdBy,50),l=Date.now(),c=m=>String(m||"").replace(/\D/g,"").slice(-5),u=c(n==="send"?t.senderMsisdn||t.lineId:t.senderMsisdn),d=String(t.provider||"").toLowerCase();for(const m of a){const p=m!=null&&m.createdAt?new Date(m.createdAt).getTime():0;if(Math.abs(l-p)<=1e4){const v=Number((m==null?void 0:m.amount)||0)===Number(t.amount||0),g=String((m==null?void 0:m.provider)||"").toLowerCase()===d,E=c((m==null?void 0:m.senderMsisdn)||(m==null?void 0:m.receiverMsisdn)||(m==null?void 0:m.senderPhone)||(m==null?void 0:m.receiverPhone));if(v&&g&&E&&u&&E===u)return{id:String((m==null?void 0:m.id)||""),duplicate:!0}}}}catch{}const s={shopId:t.shopId,lineId:t.lineId,merchantUserId:t.merchantUserId||t.createdBy,walletId:r,provider:t.provider,txnType:n,originType:t.type,amount:t.amount,fee:void 0,commission:void 0,profit:0,reference:t.reference,senderMsisdn:t.senderMsisdn,receiverMsisdn:t.receiverMsisdn,note:t.note,status:"confirmed",createdBy:t.createdBy,createdAt:t.createdAt||new Date,confirmedAt:new Date},i=await uI.create(s);if(n==="send")try{const{calculateCommission:o}=await ee(async()=>{const{calculateCommission:b}=await Promise.resolve().then(()=>To);return{calculateCommission:b}},void 0,import.meta.url),a=o(t.amount,"send"),l=t.merchantUserId||t.createdBy,c=t.fee||0,u=await hr.getUserData(l),d={...(u==null?void 0:u.walletBalances)||{}},p=Number(d[r]||0)-(t.amount+c);d[r]=p;const v=Number((u==null?void 0:u.cashBalance)||0),g=Math.round(v+t.amount+a);if(await hr.updateUserData(l,{walletBalances:d,cashBalance:g,lastUpdated:new Date().toISOString()}),t.shopId)try{const b=ye(F,"dashboardData",t.shopId);await rn(b,{cashBalance:g,walletBalances:d,lastUpdated:new Date().toISOString()},{merge:!0})}catch(b){console.warn("   dashboardData:",b)}const{walletDailyLimitsService:E}=await ee(async()=>{const{walletDailyLimitsService:b}=await Promise.resolve().then(()=>Bf);return{walletDailyLimitsService:b}},void 0,import.meta.url);await E.updateUsage(r,t.amount,"transfer",!0)}catch(o){console.warn("     :",o)}else try{const{calculateCommission:o}=await ee(async()=>{const{calculateCommission:g}=await Promise.resolve().then(()=>To);return{calculateCommission:g}},void 0,import.meta.url),a=o(t.amount,"receive"),l=t.merchantUserId||t.createdBy,c=await hr.getUserData(l),u={...(c==null?void 0:c.walletBalances)||{}},m=Number(u[r]||0)+t.amount;u[r]=m;const p=Number((c==null?void 0:c.cashBalance)||0),v=Math.round(p-t.amount+a);if(await hr.updateUserData(l,{walletBalances:u,cashBalance:v,lastUpdated:new Date().toISOString()}),t.shopId)try{const g=ye(F,"dashboardData",t.shopId);await rn(g,{cashBalance:v,walletBalances:u,lastUpdated:new Date().toISOString()},{merge:!0})}catch(g){console.warn("   dashboardData:",g)}if(t.type==="withdraw"){const{walletDailyLimitsService:g}=await ee(async()=>{const{walletDailyLimitsService:E}=await Promise.resolve().then(()=>Bf);return{walletDailyLimitsService:E}},void 0,import.meta.url);await g.updateUsage(r,t.amount,"withdraw",!0)}}catch(o){console.warn("     /:",o)}try{const o="  ",a=`: ${t.type} | : ${t.amount} | : ${t.provider}`;await Mee(a,o)}catch(o){console.warn("   :",o)}try{const o=t.merchantUserId||t.createdBy;if(o){const a=n==="receive"?"withdraw":"send",l=vI(t.amount,n);await hr.saveUserTransaction(o,{type:a,amount:t.amount,commission:l,status:"completed",createdAt:new Date,senderMsisdn:t.senderMsisdn,receiverMsisdn:t.receiverMsisdn,senderName:t.senderName,walletId:r,lineId:t.lineId,provider:t.provider,note:t.note,transactionId:i})}else console.warn("    :   userId (merchantUserId  createdBy)  .")}catch(o){console.warn("      userTransactions   :",o)}return{id:i,duplicate:!1}},Zp=t=>{try{const e=String(t||"").replace(/[^0-9+]/g,"");if(!e)return"";if(e.startsWith("+20")){const n=e.slice(3);return n.startsWith("1")?"0"+n:n}if(e.startsWith("0020")){const n=e.slice(4);return n.startsWith("1")?"0"+n:n}if(e.startsWith("20")){const n=e.slice(2);return n.startsWith("1")?"0"+n:n}return e.startsWith("0")?e:/^(10|11|12|15)/.test(e)?"0"+e:e}catch{return""}},db=async(t=[],e)=>{var n;try{try{console.log("identifyWalletBySim  input",t)}catch{}const r=e||((n=qt.currentUser)==null?void 0:n.uid)||"default",s=Array.isArray(t)?t.map(g=>Zp(g)).filter(g=>!!g):[],i=`wallets_${r}`,o=typeof localStorage<"u"?localStorage.getItem(i):null,a=o?JSON.parse(o):[],l=g=>String(g||"").replace(/\D/g,""),c=Array.isArray(a)?a.map(g=>({walletId:String((g==null?void 0:g.id)||""),msisdn:Zp(String((g==null?void 0:g.phone)||(g==null?void 0:g.msisdn)||"")),isDefault:!!(g!=null&&g.isDefault)})).filter(g=>g.walletId&&g.msisdn):[],u=new Map;for(const g of s){const E=l(g);for(const b of c){const _=l(b.msisdn);if(b.msisdn===g){u.set(b.walletId,{msisdn:b.msisdn,isDefault:!!b.isDefault});continue}if(_.slice(-7)===E.slice(-7)){u.set(b.walletId,{msisdn:b.msisdn,isDefault:!!b.isDefault});continue}}}if(u.size>0){const g=Array.from(u.entries()),E=g.find(([S,P])=>P.isDefault),[b,_]=E||g[0];return{walletId:b,msisdn:_.msisdn}}const m=(await ka.getByMerchantId(r)||[]).map(g=>({walletId:String((g==null?void 0:g.id)||""),msisdn:Zp(String((g==null?void 0:g.msisdn)||"")),isDefault:!!(g!=null&&g.isDefault)})).filter(g=>g.walletId&&g.msisdn),p=[...c,...m],v=new Map;for(const g of s){const E=l(g);for(const b of p){const _=l(b.msisdn);if(b.msisdn===g){v.set(b.walletId,{msisdn:b.msisdn,isDefault:!!b.isDefault});continue}if(_.slice(-7)===E.slice(-7)){v.set(b.walletId,{msisdn:b.msisdn,isDefault:!!b.isDefault});continue}}}try{console.log("identifyWalletBySim  matched size",v.size)}catch{}if(v.size>0){const g=Array.from(v.entries()),E=g.find(([S,P])=>P.isDefault),[b,_]=E||g[0];try{console.log("identifyWalletBySim  selected match",{walletId:b,msisdn:_.msisdn})}catch{}return{walletId:b,msisdn:_.msisdn}}try{console.warn("identifyWalletBySim  no unique match")}catch{}return null}catch{return null}};async function $ee(t,e){try{const n=i=>Zp(String(i||"")),r=(e||[]).map(i=>({walletId:String(i.id||""),msisdn:n(String(i.msisdn||i.phone||"")),isDefault:!!i.isDefault})).filter(i=>i.walletId&&i.msisdn),s=i=>String(i||"").replace(/\D/g,"");for(const i of t||[]){const o=n(i),a=s(o),l=r.filter(u=>u.msisdn===o);if(l.length>0){const d=l.find(m=>m.isDefault)||l[0];return{walletId:d.walletId,msisdn:d.msisdn}}const c=r.filter(u=>s(u.msisdn).slice(-7)===a.slice(-7));if(c.length>0){const d=c.find(m=>m.isDefault)||c[0];return{walletId:d.walletId,msisdn:d.msisdn}}}return null}catch{return null}}async function Bee(t){var e;try{const n=t.userId||((e=qt.currentUser)==null?void 0:e.uid)||"default";if(t.slotIndex!==void 0&&t.slotIndex!==null&&t.slotIndex>=0){let c="";try{t.slotIndex===0?c=localStorage.getItem(`sim1Number_${n}`)||localStorage.getItem("sim1Number")||"":t.slotIndex===1&&(c=localStorage.getItem(`sim2Number_${n}`)||localStorage.getItem("sim2Number")||"")}catch{}if(c){const u=await db([c],n);if(u)return u}}const r=Array.isArray(t.simNumbers)?t.simNumbers:[],s=await db(r,n);if(s)return s;const i=`simWalletBindings_${n}`;let o={};try{const c=typeof localStorage<"u"?localStorage.getItem(i):null;o=c?JSON.parse(c):{}}catch{}const a=String(t.subId??""),l=String(t.slotIndex??"");return a&&o[a]&&o[a].walletId?{walletId:o[a].walletId,msisdn:String(o[a].msisdn||"")}:l&&o[`slot_${l}`]&&o[`slot_${l}`].walletId?{walletId:o[`slot_${l}`].walletId,msisdn:String(o[`slot_${l}`].msisdn||"")}:null}catch{return null}}function zee(t){var e;try{const r=`simWalletBindings_${t.userId||((e=qt.currentUser)==null?void 0:e.uid)||"default"}`;let s={};try{const i=typeof localStorage<"u"?localStorage.getItem(r):null;s=i?JSON.parse(i):{}}catch{}t.subId!=null&&(s[String(t.subId)]={walletId:t.walletId,msisdn:t.msisdn||""}),t.slotIndex!=null&&(s[`slot_${String(t.slotIndex)}`]={walletId:t.walletId,msisdn:t.msisdn||""});try{typeof localStorage<"u"&&localStorage.setItem(r,JSON.stringify(s))}catch{}}catch{}}const Wee=t=>{var e,n;try{const r=t||((e=qt.currentUser)==null?void 0:e.uid)||"",s=Object.keys(localStorage),i=`selectedWallet_${r}`,o=`wallets_${r}`,a=s.find(c=>c.startsWith(i));if(a){const c=localStorage.getItem(a)||"";if(c)return c}const l=s.find(c=>c.startsWith(o));if(l){const c=localStorage.getItem(l)||"";if(c){const u=JSON.parse(c);if(Array.isArray(u)&&u.length>0){const d=u.find(m=>m==null?void 0:m.isDefault);return(d==null?void 0:d.id)||((n=u[0])==null?void 0:n.id)||null}}}}catch{}return null};function fj(){return typeof window>"u"?()=>{}:()=>{}}const Oi=Object.freeze(Object.defineProperty({__proto__:null,bindSlotWalletMapping:zee,detectWalletFromSim:$ee,identifyWalletBySim:db,initMobileSmsBridge:fj,processMobileTransactionNotification:hj,resolveWalletBySimOrSlot:Bee},Symbol.toStringTag,{value:"Module"})),qee=t=>{try{let e=t.match(/(?:||)\s*[:]?\s*([0-9]+(?:[.,][0-9]+)?)/);return e?Number(e[1].replace(",",".")):(e=t.match(/received\s*EGP([0-9]+(?:[.,][0-9]+)?)/i),e||(e=t.match(/(?:amount|balance|transferred|received)\s*(?:is|:)?\s*(?:EGP)?\s*([0-9]+(?:[.,][0-9]+)?)/i),e)||(e=t.match(/EGP\s*([0-9]+(?:[.,][0-9]+)?)/i),e)||(e=t.match(/([0-9]+(?:[.,][0-9]+)?)\s*EGP/i),e)||(e=t.match(/([0-9]+[.,]?[0-9]*)\s*(?:)/),e)?Number(e[1].replace(",","")):(e=t.match(/([0-9]+(?:[.,][0-9]+)?)\s*\.?\s*\.?\.?/i)||t.match(/([0-9]+(?:[.,][0-9]+)?)\s*\s*/i),e?Number(String(e[1]).replace(",",".")):null))}catch{return null}},Hee=t=>{try{const e=t.match(/((?:002|\+2)?01[0-9]{9})/);if(e){let n=e[1];return n.startsWith("002")&&(n=n.substring(3)),n.startsWith("+2")&&(n=n.substring(2)),n}return}catch{return}},Kee=t=>{try{const e=t.match(/(?:|)(?:\s+(?:|))?\s*([0-9]+(?:[.,][0-9]+)?)/);if(!e)return;const n=e[1].replace(",",".");return Number(n)||0}catch{return}},Gee=()=>{var t,e;try{const n=((t=qt.currentUser)==null?void 0:t.uid)||"default",r=Object.keys(localStorage).find(i=>i.startsWith(`selectedWallet_${n}`));if(r){const i=localStorage.getItem(r)||"";if(i)return i}const s=Object.keys(localStorage).find(i=>i.startsWith(`wallets_${n}`));if(s){const i=localStorage.getItem(s)||"";if(i){const o=JSON.parse(i);if(Array.isArray(o)&&o.length>0){const a=o.find(l=>l==null?void 0:l.isDefault);return(a==null?void 0:a.id)||((e=o[0])==null?void 0:e.id)||null}}}}catch{}return null},Qee=()=>{var t;try{const e=((t=qt.currentUser)==null?void 0:t.uid)||"",n=e?`selectedShopId_${e}`:"selectedShopId";return localStorage.getItem(n)||""||null}catch{return null}},Yee=(t,e)=>{try{const n=`wallets_${t}`,r=localStorage.getItem(n);if(!r)return null;const s=JSON.parse(r);if(Array.isArray(s)){const i=e.trim(),o=s.find(a=>a.phone&&String(a.phone).trim()===i||a.msisdn&&String(a.msisdn).trim()===i);return o?o.id:null}}catch{}return null},eg=async(t,e)=>{var N,I;const n=String((t==null?void 0:t.text)||"").trim(),r=String((t==null?void 0:t.title)||"").trim(),s=String((t==null?void 0:t.packageName)||"").toLowerCase(),i=String((t==null?void 0:t.appName)||"").toLowerCase();if(!n||!(/vodafone|emeint|myservices|etisalat|e&|instapay/.test(s)||/vodafone|vf\-?cash|||etisalat|e&|money|instapay/.test(i)||/\s*?\s*|\s*|\s*|\s*|\s*|ana\s*vodafone|e&\s*money|etisalat|received|transferred|sent/i.test(n)))return;try{console.log("VF/ETISALAT NOTIFICATION RECEIVED",t)}catch{}if(t.handledInBackground){console.log("Transaction handled in background (Native). Skipping Web processing to prevent double counting."),e&&e.toast&&e.toast({title:" ",description:"     ."});return}const a=/|?||received/i.test(n),l=/\s*|\s*|transferred|sent/i.test(n);if(l){const A=((N=qt.currentUser)==null?void 0:N.uid)||void 0,R=A?localStorage.getItem(`autoTransferRecord_${A}`):null,k=localStorage.getItem("autoTransferRecord");if(!((R??k)!=="false")){console.log("Transfer detected but Auto-Record is disabled by user preference. Ignoring.");return}}let c=qee(n);if(l){const A=n.match(/\s*\s+(\d+(?:[.,]\d+)?)\s+/);if(A)c=Number(A[1].replace(",","."));else{const R=n.match(/\s*\s+([0-9.,]+)\s+/);if(R){const k=Number(R[1].replace(",","."));k>0&&(c=k)}}}const u=Hee(n),d=Kee(n)||0;if(!c||c<=0)return;let m="vodafone_cash";/etisalat|e&|/i.test(n)||/etisalat|e&/i.test(s)||/etisalat|e&/i.test(i)?m="etisalat_cash":(/instapay/i.test(n)||/instapay/i.test(s)||/instapay/i.test(i))&&(m="instapay");const p=((I=qt.currentUser)==null?void 0:I.uid)||"";let v;if((t==null?void 0:t.simSlot)!==void 0&&p)try{if(t.simSlot===0){const A=localStorage.getItem(`sim1Number_${p}`)??localStorage.getItem("sim1Number");A&&(v=String(A).trim()),!v&&Array.isArray(t.activeSimMsisdns)&&t.activeSimMsisdns[0]&&(v=String(t.activeSimMsisdns[0]).trim())}else if(t.simSlot===1){const A=localStorage.getItem(`sim2Number_${p}`)??localStorage.getItem("sim2Number");A&&(v=String(A).trim()),!v&&Array.isArray(t.activeSimMsisdns)&&t.activeSimMsisdns[1]&&(v=String(t.activeSimMsisdns[1]).trim())}}catch(A){console.error("Error resolving SIM from profile",A)}let g;if((t==null?void 0:t.simSlot)!==void 0){if(!v){console.warn("Transaction detected but no SIM number found in profile for slot",t==null?void 0:t.simSlot),e&&e.toast&&e.toast({title:"",description:`     ${t.simSlot+1}         .`,variant:"destructive"});return}const A=Yee(p,v);if(A)g=A;else{console.warn("Transaction detected but no wallet found for number",v),e&&e.toast&&e.toast({title:"",description:`       ${v}.       .`,variant:"destructive"});return}}else g=Gee()||void 0;const E=Qee()||"",b=g||"default-line";if(!p||!g||!E)return;try{const A=await AX(p);if((A==null?void 0:A.planType)===Fl.ZERO){console.log("Ignoring Notification for Zero Plan user");return}}catch{}const _=`${r}|${n}|${(t==null?void 0:t.sender)||""}|${(t==null?void 0:t.postedAt)||Date.now()}`,S=`VF-${btoa(unescape(encodeURIComponent(_))).slice(0,24)}`,P=a?"withdraw":l?"transfer":"withdraw";v||(v=(t==null?void 0:t.receiverMsisdn)||void 0);const T={type:P,amount:c,provider:m,shopId:E,lineId:b,walletId:g,senderMsisdn:P==="withdraw"?u||void 0:v,receiverMsisdn:P==="withdraw"?v:u||void 0,reference:S,fee:d,createdBy:p,merchantUserId:p,note:m==="etisalat_cash"?"  ":m==="instapay"?"  ":"  "};try{await hj(T)}catch{}};let oa={};const Cs={invalidateCache:t=>{const e=t||"default";delete oa[e]},async syncReportsDataFromFirebase(t){try{if(!t)return null;const e=await hr.getUserData(t),n=e==null?void 0:e.reportsData;if(!n)return null;const r=`reportsData_${t}`,s=a=>{if(!a)return null;try{return a!=null&&a.toDate?a.toDate():new Date(a)}catch{return null}},i={lastDailyResetDate:s(n.lastDailyResetDate),lastMonthlyResetDate:s(n.lastMonthlyResetDate),hiddenDailyTransactionIds:Array.isArray(n.hiddenDailyTransactionIds)?n.hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:Array.isArray(n.hiddenMonthlyTransactionIds)?n.hiddenMonthlyTransactionIds:[],dailyProfit:Number(n.dailyProfit??0),monthlyProfit:Number(n.monthlyProfit??0),lastDailyProfitResetDate:s(n.lastDailyProfitResetDate),lastMonthlyProfitResetDate:s(n.lastMonthlyProfitResetDate)},o=Cs.getReportsData(t);if(o.lastDailyResetDate&&(!i.lastDailyResetDate||o.lastDailyResetDate.getTime()>i.lastDailyResetDate.getTime())&&(i.lastDailyResetDate=o.lastDailyResetDate,i.dailyProfit=o.dailyProfit,i.lastDailyProfitResetDate=o.lastDailyProfitResetDate),Array.isArray(o.hiddenDailyTransactionIds)&&o.hiddenDailyTransactionIds.length){const a=new Set([...i.hiddenDailyTransactionIds,...o.hiddenDailyTransactionIds]);i.hiddenDailyTransactionIds=Array.from(a)}if(o.lastMonthlyResetDate&&(!i.lastMonthlyResetDate||o.lastMonthlyResetDate.getTime()>i.lastMonthlyResetDate.getTime())&&(i.lastMonthlyResetDate=o.lastMonthlyResetDate,i.monthlyProfit=o.monthlyProfit,i.lastMonthlyProfitResetDate=o.lastMonthlyProfitResetDate),Array.isArray(o.hiddenMonthlyTransactionIds)&&o.hiddenMonthlyTransactionIds.length){const a=new Set([...i.hiddenMonthlyTransactionIds,...o.hiddenMonthlyTransactionIds]);i.hiddenMonthlyTransactionIds=Array.from(a)}try{localStorage.setItem(r,JSON.stringify(i))}catch{}return i}catch(e){return console.warn("     Firebase:",e),null}},shouldResetDailyReports:t=>{if(!t)return!0;const e=new Date,n=new Date(t);return e.toDateString()!==n.toDateString()},shouldResetMonthlyReports:t=>{if(!t)return!0;const e=new Date,n=new Date(t),r=e.getDate()===1,s=e.getMonth()!==n.getMonth()||e.getFullYear()!==n.getFullYear();return r&&s},autoResetReportsIfNeeded:t=>{try{const e=t?`reportsData_${t}`:"reportsData";let n=Cs.getReportsData(t);const r=!1,s=!1;if(n.lastDailyResetDate||(n.lastDailyResetDate=new Date),n.lastDailyProfitResetDate||(n.lastDailyProfitResetDate=new Date),n.lastMonthlyResetDate||(n.lastMonthlyResetDate=new Date),n.lastMonthlyProfitResetDate||(n.lastMonthlyProfitResetDate=new Date),localStorage.setItem(e,JSON.stringify(n)),oa[t||"default"]=n,t)try{hr.updateUserData(t,{reportsData:{...n}})}catch(i){console.warn("     Firebase   :",i)}return{dailyReset:r,monthlyReset:s}}catch(e){return console.error("    :",e),{dailyReset:!1,monthlyReset:!1}}},resetReportsManually:(t,e,n)=>{try{const r=n?`reportsData_${n}`:"reportsData",s=localStorage.getItem(r);let i={lastDailyResetDate:null,lastMonthlyResetDate:null,hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:[],dailyProfit:0,monthlyProfit:0,lastDailyProfitResetDate:null,lastMonthlyProfitResetDate:null};if(s){const a=JSON.parse(s);i={lastDailyResetDate:a.lastDailyResetDate?new Date(a.lastDailyResetDate):null,lastMonthlyResetDate:a.lastMonthlyResetDate?new Date(a.lastMonthlyResetDate):null,hiddenDailyTransactionIds:a.hiddenDailyTransactionIds||[],hiddenMonthlyTransactionIds:a.hiddenMonthlyTransactionIds||[],dailyProfit:a.dailyProfit||0,monthlyProfit:a.monthlyProfit||0,lastDailyProfitResetDate:a.lastDailyProfitResetDate?new Date(a.lastDailyProfitResetDate):null,lastMonthlyProfitResetDate:a.lastMonthlyProfitResetDate?new Date(a.lastMonthlyProfitResetDate):null}}let o=[];if(t==="daily"){const a=new Date().toDateString();o=e.filter(l=>new Date(l.createdAt).toDateString()===a).map(l=>l.id),i.hiddenDailyTransactionIds=[...new Set([...i.hiddenDailyTransactionIds,...o])],i.lastDailyResetDate=new Date,i.dailyProfit=0,i.lastDailyProfitResetDate=new Date}else{const a=new Date,l=a.getMonth(),c=a.getFullYear();o=e.filter(u=>{const d=new Date(u.createdAt);return d.getMonth()===l&&d.getFullYear()===c}).map(u=>u.id),i.hiddenMonthlyTransactionIds=[...new Set([...i.hiddenMonthlyTransactionIds,...o])],i.hiddenDailyTransactionIds=[...new Set([...i.hiddenDailyTransactionIds,...o])],i.lastMonthlyResetDate=a,i.lastMonthlyProfitResetDate=a,i.lastDailyResetDate=a,i.lastDailyProfitResetDate=a,i.monthlyProfit=0,i.dailyProfit=0}if(localStorage.setItem(r,JSON.stringify(i)),oa[n||"default"]=i,n)try{hr.updateUserData(n,{reportsData:{...i}})}catch(a){console.warn("     Firebase   :",a)}return console.log(`   ${t==="daily"?"":""} `),o}catch(r){return console.error("    :",r),[]}},getReportsData:t=>{try{const e=t||"default";if(oa[e])return{...oa[e]};const n=t?`reportsData_${t}`:"reportsData",r=localStorage.getItem(n);let s={lastDailyResetDate:null,lastMonthlyResetDate:null,hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:[],dailyProfit:0,monthlyProfit:0,lastDailyProfitResetDate:null,lastMonthlyProfitResetDate:null};if(r){const i=JSON.parse(r);s={lastDailyResetDate:i.lastDailyResetDate?new Date(i.lastDailyResetDate):null,lastMonthlyResetDate:i.lastMonthlyResetDate?new Date(i.lastMonthlyResetDate):null,hiddenDailyTransactionIds:i.hiddenDailyTransactionIds||[],hiddenMonthlyTransactionIds:i.hiddenMonthlyTransactionIds||[],dailyProfit:i.dailyProfit||0,monthlyProfit:i.monthlyProfit||0,lastDailyProfitResetDate:i.lastDailyProfitResetDate?new Date(i.lastDailyProfitResetDate):null,lastMonthlyProfitResetDate:i.lastMonthlyProfitResetDate?new Date(i.lastMonthlyProfitResetDate):null}}else if(t){const i=localStorage.getItem("reportsData");if(i)try{const o=JSON.parse(i);s={lastDailyResetDate:o.lastDailyResetDate?new Date(o.lastDailyResetDate):null,lastMonthlyResetDate:o.lastMonthlyResetDate?new Date(o.lastMonthlyResetDate):null,hiddenDailyTransactionIds:o.hiddenDailyTransactionIds||[],hiddenMonthlyTransactionIds:o.hiddenMonthlyTransactionIds||[],dailyProfit:o.dailyProfit||0,monthlyProfit:o.monthlyProfit||0,lastDailyProfitResetDate:o.lastDailyProfitResetDate?new Date(o.lastDailyProfitResetDate):null,lastMonthlyProfitResetDate:o.lastMonthlyProfitResetDate?new Date(o.lastMonthlyProfitResetDate):null},localStorage.setItem(n,JSON.stringify(s))}catch{}}return oa[e]=s,{...s}}catch(e){return console.error("    :",e),{lastDailyResetDate:null,lastMonthlyResetDate:null,hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:[],dailyProfit:0,monthlyProfit:0,lastDailyProfitResetDate:null,lastMonthlyProfitResetDate:null}}},filterVisibleTransactions:(t,e,n)=>{try{const r=Cs.getReportsData(n),s=e==="daily"?r.hiddenDailyTransactionIds:r.hiddenMonthlyTransactionIds;return t.filter(o=>!s.includes(o.id))}catch(r){return console.error("   :",r),t}},addProfit:(t,e,n)=>{try{const r=n?`reportsData_${n}`:"reportsData",s=Cs.getReportsData(n);if(e==="daily"?s.dailyProfit+=t:s.monthlyProfit+=t,localStorage.setItem(r,JSON.stringify(s)),oa[n||"default"]=s,n)try{hr.updateUserData(n,{reportsData:{...s}})}catch(i){console.warn("     Firebase:",i)}try{window.dispatchEvent(new CustomEvent("reportsUpdated",{detail:{userId:n,type:e,amount:t}}))}catch{}}catch(r){console.error("   :",r)}},getProfits:t=>{try{const e=Cs.getReportsData(t);return{dailyProfit:e.dailyProfit,monthlyProfit:e.monthlyProfit}}catch(e){return console.error("   :",e),{dailyProfit:0,monthlyProfit:0}}},removeTransactionEffects:(t,e)=>{try{const n=e?`reportsData_${e}`:"reportsData",r=Cs.getReportsData(e),s=new Date(t.createdAt),i=new Date,o=i.getMonth(),a=i.getFullYear(),l=Cs.calculateTransactionProfit(t);if(s.toDateString()===i.toDateString()&&((r.hiddenDailyTransactionIds||[]).includes(t.id)||(r.dailyProfit=Math.round((r.dailyProfit-l)*100)/100)),s.getMonth()===o&&s.getFullYear()===a&&((r.hiddenMonthlyTransactionIds||[]).includes(t.id)||(r.monthlyProfit=Math.round((r.monthlyProfit-l)*100)/100)),localStorage.setItem(n,JSON.stringify(r)),oa[e||"default"]=r,e)try{hr.updateUserData(e,{reportsData:{...r}})}catch(c){console.warn("      Firebase:",c)}}catch(n){console.error("      :",n)}},calculateTransactionProfit:t=>{const e=String((t==null?void 0:t.status)||"").toLowerCase();if(e&&e!=="completed"&&e!=="confirmed")return 0;const n=String(t.type||t.txnType||"").toLowerCase();if(n==="atm_withdraw"){const i=Number(t.commission||0);return-1*Math.abs(i)}const r=Number((t==null?void 0:t.fee)??0);if(t.commission!==void 0){const i=Math.max(0,Number(t.commission||0));return Math.round((i+Math.max(0,r))*100)/100}const s=n==="withdrawal"?"withdraw":n;if(s==="withdraw"||s==="receive"||s==="send"||s==="transfer"){const i=Math.round(Number(t.amount||0)*.01*100)/100;return Math.round((i+Math.max(0,r))*100)/100}return 0}},Jee=Cs,dne=Object.freeze(Object.defineProperty({__proto__:null,ReportsService:Jee,reportsService:Cs},Symbol.toStringTag,{value:"Module"})),yy={parseNum(t,e){if(typeof t=="number"&&Number.isFinite(t))return t;if(typeof t=="string"){const n=t.replace(/[^0-9.-]/g,""),r=parseFloat(n);return Number.isFinite(r)?r:e}return e},getCurrentDayId(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},async setLimits(t,e){var n;try{const r=ye(F,"walletLimits",t),s={updatedAt:$e(),ownerId:(n=qt.currentUser)==null?void 0:n.uid};return e.dailyTransferLimit!==void 0&&(s.dailyTransferLimit=e.dailyTransferLimit),e.dailyWithdrawLimit!==void 0&&(s.dailyWithdrawLimit=e.dailyWithdrawLimit),e.monthlyTransferLimit!==void 0&&(s.monthlyTransferLimit=e.monthlyTransferLimit),e.monthlyWithdrawLimit!==void 0&&(s.monthlyWithdrawLimit=e.monthlyWithdrawLimit),await rn(r,s,{merge:!0}),await this.getWalletLimits(t)}catch(r){return console.error("    :",r),null}},getCurrentMonthId(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`},shouldResetDailyLimits(t){if(!t)return!0;const e=new Date,n=t.toDate();return e.getDate()!==n.getDate()||e.getMonth()!==n.getMonth()||e.getFullYear()!==n.getFullYear()},shouldResetMonthlyLimits(t){const e=new Date,n=e.getDate()===1;if(!t)return n;const r=t.toDate();return n&&(e.getMonth()!==r.getMonth()||e.getFullYear()!==r.getFullYear())},async getWalletLimits(t){var e;try{const n=ye(F,"walletLimits",t);let r;try{r=await Sn(n)}catch(i){return console.error("     (     ):",i),null}if(r.exists()){const i=r.data();return{walletId:t,dailyTransferLimit:this.parseNum(i.dailyTransferLimit,6e4),dailyWithdrawLimit:this.parseNum(i.dailyWithdrawLimit,1e5),dailyTransferUsed:this.parseNum(i.dailyTransferUsed,0),dailyWithdrawUsed:this.parseNum(i.dailyWithdrawUsed,0),lastDailyReset:i.lastDailyReset||null,monthlyTransferLimit:this.parseNum(i.monthlyTransferLimit,2e5),monthlyWithdrawLimit:this.parseNum(i.monthlyWithdrawLimit,2e5),monthlyTransferUsed:this.parseNum(i.monthlyTransferUsed,0),monthlyWithdrawUsed:this.parseNum(i.monthlyWithdrawUsed,0),lastMonthlyReset:i.lastMonthlyReset||null,updatedAt:i.updatedAt||sn.now()}}const s={walletId:t,dailyTransferLimit:6e4,dailyWithdrawLimit:1e5,dailyTransferUsed:0,dailyWithdrawUsed:0,lastDailyReset:null,monthlyTransferLimit:2e5,monthlyWithdrawLimit:2e5,monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:null,updatedAt:sn.now()};return await rn(n,{dailyTransferLimit:6e4,dailyWithdrawLimit:1e5,dailyTransferUsed:0,dailyWithdrawUsed:0,lastDailyReset:null,monthlyTransferLimit:2e5,monthlyWithdrawLimit:2e5,monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:null,updatedAt:$e(),ownerId:(e=qt.currentUser)==null?void 0:e.uid}),s}catch(n){return console.error("     :",n),null}},async resetDailyLimits(t){var e;try{const n=ye(F,"walletLimits",t);return await rn(n,{dailyTransferUsed:0,dailyWithdrawUsed:0,lastDailyReset:$e(),updatedAt:$e(),ownerId:(e=qt.currentUser)==null?void 0:e.uid},{merge:!0}),console.log(`       ${t}`),!0}catch(n){return console.error("     :",n),!1}},async resetMonthlyLimits(t){var e;try{const n=ye(F,"walletLimits",t);return await rn(n,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:$e(),updatedAt:$e(),ownerId:(e=qt.currentUser)==null?void 0:e.uid},{merge:!0}),console.log(`       ${t}`),!0}catch(n){return console.error("     :",n),!1}},async autoResetLimitsIfNeeded(t){try{const e=await this.getWalletLimits(t);if(!e)return null;let n=!1;return this.shouldResetDailyLimits(e.lastDailyReset)&&(await this.resetDailyLimits(t),n=!0),this.shouldResetMonthlyLimits(e.lastMonthlyReset)&&(await this.resetMonthlyLimits(t),n=!0),n?await this.getWalletLimits(t):e}catch(e){return console.error("     :",e),null}},async canPerformOperation(t,e,n){try{const r=await this.autoResetLimitsIfNeeded(t);if(!r)return{canPerform:!1,message:"      "};if(n==="transfer"){const s=Math.max(0,this.parseNum(r.dailyTransferLimit,6e4)-this.parseNum(r.dailyTransferUsed,0));if(e>s)return{canPerform:!1,message:`   . : ${s.toLocaleString()} .   ${r.dailyTransferLimit.toLocaleString()} .`,dailyRemaining:s,limitType:"daily"};const i=Math.max(0,this.parseNum(r.monthlyTransferLimit,2e5)-this.parseNum(r.monthlyTransferUsed,0));return e>i?{canPerform:!1,message:`   . : ${i.toLocaleString()} .   ${r.monthlyTransferLimit.toLocaleString()} .`,monthlyRemaining:i,limitType:"monthly"}:{canPerform:!0,dailyRemaining:Math.max(0,s-e),monthlyRemaining:Math.max(0,i-e)}}if(n==="withdraw"){const s=Math.max(0,this.parseNum(r.dailyWithdrawLimit,1e5)-this.parseNum(r.dailyWithdrawUsed,0));if(e>s)return{canPerform:!1,message:`   . : ${s.toLocaleString()} .   ${r.dailyWithdrawLimit.toLocaleString()} .`,dailyRemaining:s,limitType:"daily"};const i=Math.max(0,this.parseNum(r.monthlyWithdrawLimit,2e5)-this.parseNum(r.monthlyWithdrawUsed,0));return e>i?{canPerform:!1,message:`   . : ${i.toLocaleString()} .   ${r.monthlyWithdrawLimit.toLocaleString()} .`,monthlyRemaining:i,limitType:"monthly"}:{canPerform:!0,dailyRemaining:Math.max(0,s-e),monthlyRemaining:Math.max(0,i-e)}}return{canPerform:!1,message:"   "}}catch(r){return console.error("      :",r),{canPerform:!1,message:"    "}}},async updateUsage(t,e,n,r=!1){try{if(!r){const o=await this.canPerformOperation(t,e,n);if(!o.canPerform)throw new Error(o.message||"   ")}const s=ye(F,"walletLimits",t),i={updatedAt:$e()};return n==="transfer"?(i.dailyTransferUsed=Rh(e),i.monthlyTransferUsed=Rh(e)):n==="withdraw"&&(i.dailyWithdrawUsed=Rh(e),i.monthlyWithdrawUsed=Rh(e)),await rn(s,i,{merge:!0}),await this.getWalletLimits(t)}catch(s){throw console.error("    :",s),s}},async rollbackUsage(t,e,n,r){try{const s=ye(F,"walletLimits",t),i=await this.getWalletLimits(t);if(!i)throw new Error("      ");const o={updatedAt:$e()},a=new Date,l=r?new Date(r):a,c=l.getDate()===a.getDate()&&l.getMonth()===a.getMonth()&&l.getFullYear()===a.getFullYear(),u=l.getMonth()===a.getMonth()&&l.getFullYear()===a.getFullYear();return n==="transfer"?(c&&(o.dailyTransferUsed=Math.max(0,(i.dailyTransferUsed||0)-e)),u&&(o.monthlyTransferUsed=Math.max(0,(i.monthlyTransferUsed||0)-e))):(c&&(o.dailyWithdrawUsed=Math.max(0,(i.dailyWithdrawUsed||0)-e)),u&&(o.monthlyWithdrawUsed=Math.max(0,(i.monthlyWithdrawUsed||0)-e))),Object.keys(o).length<=1?i:(await rn(s,{...o},{merge:!0}),await this.getWalletLimits(t))}catch(s){throw console.error("      :",s),s}},calculateRemaining(t){return{dailyTransferRemaining:Math.max(0,t.dailyTransferLimit-t.dailyTransferUsed),dailyWithdrawRemaining:Math.max(0,t.dailyWithdrawLimit-t.dailyWithdrawUsed),monthlyTransferRemaining:Math.max(0,t.monthlyTransferLimit-t.monthlyTransferUsed),monthlyWithdrawRemaining:Math.max(0,t.monthlyWithdrawLimit-t.monthlyWithdrawUsed)}},async resetAllLimits(t){var e;try{const n=ye(F,"walletLimits",t);return await rn(n,{dailyTransferUsed:0,dailyWithdrawUsed:0,monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastDailyReset:$e(),lastMonthlyReset:$e(),updatedAt:$e(),ownerId:(e=qt.currentUser)==null?void 0:e.uid},{merge:!0}),console.log(`       ${t}`),await this.getWalletLimits(t)}catch(n){return console.error("     :",n),null}}},Bf=Object.freeze(Object.defineProperty({__proto__:null,default:yy,walletDailyLimitsService:yy},Symbol.toStringTag,{value:"Module"}));class Xee{constructor(){eh(this,"intervalId",null);eh(this,"isRunning",!1)}start(){if(this.isRunning){console.log(" ReportsResetScheduler  ");return}this.isRunning=!0;try{const e=()=>{const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1,0,0,0,0),s=Math.max(1e3,r.getTime()-n.getTime());this.intervalId=setTimeout(async()=>{await this.runResetSafely(),e()},s)};e(),console.log("        ")}catch{console.log("   ")}}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.isRunning=!1,console.log("     ")}async runResetSafely(){var e;try{const n=(e=qt.currentUser)==null?void 0:e.uid;if(!n){console.log("          ");return}const s=new Date().toISOString().slice(0,10),i=await ab.getToday(n);await ab.saveToHistory(n,s,i||{}),console.log("      :",s),await this.archivePreviousDayIfNeeded(n),await this.resetUserWalletLimits(n)}catch(n){console.error("     :",n)}}async archivePreviousDayIfNeeded(e){try{await Cs.syncReportsDataFromFirebase(e);const n=Cs.getReportsData(e);if(!n.lastDailyResetDate||!Cs.shouldResetDailyReports(n.lastDailyResetDate))return;const s=new Date,i=new Date(s.getFullYear(),s.getMonth(),s.getDate()-1),o=i.toDateString(),a=await hr.getUserTransactions(e),l=_=>{const S=String(_||"").toLowerCase();return["completed","confirmed","success"].includes(S)?"completed":["failed","error"].includes(S)?"failed":["cancelled","canceled"].includes(S)?"cancelled":"pending"},c=(a||[]).filter(_=>{var P,T;const S=(P=_==null?void 0:_.createdAt)!=null&&P.toDate?_.createdAt.toDate():(_==null?void 0:_.createdAt)instanceof Date?_.createdAt:new Date(_==null?void 0:_.createdAt);return((T=S==null?void 0:S.toDateString)==null?void 0:T.call(S))===o&&l(_==null?void 0:_.status)==="completed"}),u=c.length,d=c.reduce((_,S)=>_+Number(S.amount||0),0),m=_=>{const S=String(((_==null?void 0:_.type)??(_==null?void 0:_.txnType))||"").toLowerCase();return S==="withdraw"||S==="withdrawal"||S==="receive"},p=_=>{const S=String(((_==null?void 0:_.type)??(_==null?void 0:_.txnType))||"").toLowerCase();return S==="send"||S==="transfer"},v=c.filter(m).reduce((_,S)=>{const P=S.withdrawnAmount!==void 0?Number(S.withdrawnAmount):Number(S.amount||0);return _+P},0),g=c.filter(_=>p(_)&&!["  "].includes(String((_==null?void 0:_.title)||""))).reduce((_,S)=>{const P=S.sentAmount!==void 0?Number(S.sentAmount):Number(S.amount||0);return _+P},0),E=c.reduce((_,S)=>_+Number(Cs.calculateTransactionProfit(S)||0),0),b=new Date(i).toISOString().slice(0,10);await dV.add({userId:e,reportDate:b,totalTransactions:u,totalAmount:Math.round(d),totalWithdrawn:Math.round(v),totalSent:Math.round(g),profit:Math.round(E),walletId:null}),console.log("    :",b)}catch(n){console.warn("      :",n)}}async resetUserWalletLimits(e){try{const n=await ka.getByMerchantId(e),r=new Date().getDate()===1;for(const s of n){const i=String((s==null?void 0:s.id)||"");if(i){try{await yy.resetDailyLimits(i)}catch{}if(r)try{await yy.resetMonthlyLimits(i)}catch{}}}console.log("     "+(r?" ":""))}catch(n){console.warn("    :",n)}}}const DP=new Xee,o_=768;function mj(){const[t,e]=y.useState(void 0);return y.useEffect(()=>{const n=window.matchMedia(`(max-width: ${o_-1}px)`),r=()=>{e(window.innerWidth<o_)};return n.addEventListener("change",r),e(window.innerWidth<o_),()=>n.removeEventListener("change",r)},[]),!!t}function Zee(){const[t,e]=y.useState("default"),[n,r]=y.useState(!1);return y.useEffect(()=>{try{const i=localStorage.getItem("notificationPermission");(i==="granted"||i==="denied"||i==="default")&&e(i);const o=localStorage.getItem("notificationConsentRequested")==="true";r(o)}catch{}},[]),{permission:t,hasRequested:n,requestConsent:async()=>{if(typeof window<"u"&&"Notification"in window){const i=await Notification.requestPermission();e(i);try{localStorage.setItem("notificationPermission",i),localStorage.setItem("notificationConsentRequested","true"),r(!0)}catch{}return i}return"unsupported"}}}const pj=y.createContext(void 0);function ete({children:t}){const{profile:e,user:n,loading:r}=Zs(),[s,i]=y.useState(null),[o,a]=y.useState(null),[l,c]=y.useState(!0);y.useEffect(()=>{if(!r&&e){const d=e!=null&&e.userId?`selectedShopId_${e.userId}`:n!=null&&n.uid?`selectedShopId_${n==null?void 0:n.uid}`:"selectedShopId";let m=null;try{m=localStorage.getItem(d)||null}catch{}i(m||e.shopId),a((e==null?void 0:e.shopName)||(n==null?void 0:n.displayName)||""),c(!1)}else r||c(!1)},[e,r]),y.useEffect(()=>{const d=()=>{const p=e!=null&&e.userId?`selectedShopId_${e.userId}`:n!=null&&n.uid?`selectedShopId_${n==null?void 0:n.uid}`:"selectedShopId";try{const v=localStorage.getItem(p);i(v||((e==null?void 0:e.shopId)??null))}catch{}};window.addEventListener("selectedShopIdChanged",d);const m=p=>{const v=e!=null&&e.userId?`selectedShopId_${e.userId}`:n!=null&&n.uid?`selectedShopId_${n==null?void 0:n.uid}`:"selectedShopId";if(!(!p.key||p.key!==v))try{const g=localStorage.getItem(v);i(g||((e==null?void 0:e.shopId)??null))}catch{}};return window.addEventListener("storage",m),()=>{window.removeEventListener("selectedShopIdChanged",d),window.removeEventListener("storage",m)}},[e==null?void 0:e.userId,n==null?void 0:n.uid,e==null?void 0:e.shopId]);const u={shopId:s,shopName:o,loading:l};return f.jsx(pj.Provider,{value:u,children:t})}function tte(){const t=y.useContext(pj);return t===void 0?{shopId:null,shopName:null,loading:!1}:t}const Gr={phoneNumber:"201000392539",defaultMessage:"    ",isEnabled:!0,lastUpdated:new Date},gj="whatsapp-settings",yj="app-settings",tg="whatsapp_settings_cache",hb=async()=>{var t;try{if(!qt.currentUser){try{const r=localStorage.getItem(tg);if(r){const s=JSON.parse(r);return{phoneNumber:s.phoneNumber||Gr.phoneNumber,defaultMessage:s.defaultMessage||Gr.defaultMessage,isEnabled:s.isEnabled!==void 0?s.isEnabled:Gr.isEnabled,lastUpdated:s.lastUpdated?new Date(s.lastUpdated):Gr.lastUpdated}}}catch{}return Gr}const e=ye(F,yj,gj),n=await Sn(e);if(n.exists()){const r=n.data(),s={phoneNumber:r.phoneNumber||Gr.phoneNumber,defaultMessage:r.defaultMessage||Gr.defaultMessage,isEnabled:r.isEnabled!==void 0?r.isEnabled:Gr.isEnabled,lastUpdated:((t=r.lastUpdated)==null?void 0:t.toDate())||Gr.lastUpdated};try{localStorage.setItem(tg,JSON.stringify(s))}catch{}return s}else return await vj(Gr),Gr}catch{try{const n=localStorage.getItem(tg);if(n){const r=JSON.parse(n);return{phoneNumber:r.phoneNumber||Gr.phoneNumber,defaultMessage:r.defaultMessage||Gr.defaultMessage,isEnabled:r.isEnabled!==void 0?r.isEnabled:Gr.isEnabled,lastUpdated:r.lastUpdated?new Date(r.lastUpdated):Gr.lastUpdated}}}catch{}return Gr}},vj=async t=>{try{const e=ye(F,yj,gj),n={...t,lastUpdated:new Date};await rn(e,n,{merge:!0});try{localStorage.setItem(tg,JSON.stringify(n))}catch{}return!0}catch(e){return console.error("    :",e),!1}},wj=t=>{const e=t.replace(/\D/g,"");if(e.length<10)throw new Error("      10   ");return e},hne=t=>{try{const e=wj(t);return e.length>=10&&e.length<=15}catch{return!1}},nte=(t,e)=>{const n=wj(t),r=encodeURIComponent(e);return`https://wa.me/${n}?text=${r}`},fne=()=>{const[t,e]=M.useState(null),[n,r]=M.useState(!0),[s,i]=M.useState(null);return M.useEffect(()=>{(async()=>{try{r(!0);const l=await hb();e(l),i(null)}catch(l){i("    "),console.error(l)}finally{r(!1)}})()},[]),{settings:t,loading:n,error:s,updateSettings:async a=>{try{return r(!0),await vj(a)&&t?(e({...t,...a,lastUpdated:new Date}),i(null),!0):(i("   "),!1)}catch(l){return i("   "),console.error(l),!1}finally{r(!1)}},refreshSettings:()=>hb().then(e)}},yp="https://cashy-link-chat.shop",OP=({position:t="left"})=>{const[e,n]=y.useState(!0),[r,s]=y.useState(!1),[i,o]=y.useState(null),[a,l]=y.useState(""),[c,u]=y.useState(""),[d,m]=y.useState(()=>{if(typeof window<"u"){const Y=localStorage.getItem("support_chat_messages");return Y?JSON.parse(Y):[]}return[]}),[p,v]=y.useState(null),[g,E]=y.useState(null),[b,_]=y.useState(!1),[S,P]=y.useState(()=>{if(typeof window<"u"){const Y=localStorage.getItem("support_chat_unread_count");return Y?parseInt(Y,10):0}return 0}),[T,N]=y.useState(new Set),[I,A]=y.useState(null),[R,k]=y.useState(!1),[C,L]=y.useState({name:"",email:"",phone:""});y.useEffect(()=>{const Y=localStorage.getItem("support_chat_user_data");if(Y)try{const Te=JSON.parse(Y);L(we=>({...we,...Te}))}catch(Te){console.error("Error parsing saved chat user data",Te)}},[]);const[O,X]=y.useState(null),ke=y.useRef(null),Oe=y.useRef(null),je=y.useRef(null),W=y.useRef(r),G=y.useRef(null),ae=y.useRef(0),pe=y.useRef(0),fe=y.useRef(0);y.useEffect(()=>{window.dispatchEvent(new CustomEvent("support-chat-unread",{detail:{count:S}}))},[S]),y.useEffect(()=>{W.current=r},[r]),y.useEffect(()=>{const Y=()=>{I&&ue(I),s(!0),P(0)};return window.addEventListener("open-support-chat",Y),()=>window.removeEventListener("open-support-chat",Y)},[I]);const Ge=()=>{var Y;(Y=je.current)==null||Y.scrollIntoView({behavior:"auto"})};y.useEffect(()=>{Ge()},[d,r,R]);const{toast:xe}=hl(),{user:ve}=Zs(),Q=Ii(),qe=mj(),cn=typeof(ge==null?void 0:ge.isNativePlatform)=="function"?ge.isNativePlatform():!1,cr=cn&&typeof ge.getPlatform=="function"&&ge.getPlatform()==="android",Yn=qe||cn;y.useEffect(()=>{ve&&L(Y=>({...Y,name:ve.displayName||Y.name,email:ve.email||Y.email,phone:ve.phoneNumber||Y.phone}))},[ve]);const tr=Q.pathname.startsWith("/admin"),Nr=Q.pathname.startsWith("/profile-settings");y.useEffect(()=>{localStorage.setItem("support_chat_messages",JSON.stringify(d))},[d]),y.useEffect(()=>{localStorage.setItem("support_chat_unread_count",S.toString())},[S]),y.useEffect(()=>{const Y=localStorage.getItem("support_chat_user_id");Y&&(A(Y),ue(Y))},[]),y.useEffect(()=>()=>{Oe.current!==null&&(window.clearInterval(Oe.current),Oe.current=null)},[]);const kr=async()=>{k(!0)},Dr=async()=>{if(!C.name||!C.email||!C.phone){xe({title:" ",description:"    ",variant:"destructive"});return}try{let Y=ve==null?void 0:ve.uid;if(!Y){if(C.phone){const le=C.phone.replace(/[^0-9]/g,"");le.length>=5&&(Y=`user_${le}`)}if(!Y){const le=localStorage.getItem("support_chat_user_id");le?Y=le:Y=`guest_${Date.now()}_${Math.random().toString(36).slice(2,10)}`}}const we=await(await fetch(`${yp}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:Y,name:C.name,email:C.email,phone:C.phone})})).json().catch(()=>null);if((we==null?void 0:we.status)==="missing_fields"){xe({title:" ",description:"    ",variant:"destructive"});return}if((we==null?void 0:we.status)!=="registered"){const le=localStorage.getItem("support_chat_user_id");if(!(Y===le||(ve==null?void 0:ve.uid)&&Y===ve.uid)){xe({title:"",description:"    ",variant:"destructive"});return}}localStorage.setItem("support_chat_user_data",JSON.stringify({name:C.name,email:C.email,phone:C.phone})),o("local"),A(Y),localStorage.setItem("support_chat_user_id",Y),k(!1),ue(Y)}catch(Y){console.error("Registration check failed:",Y),xe({title:"  ",description:"    ",variant:"destructive"})}},J=Y=>{if(!Y)return new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});let Te;if(typeof Y=="object"&&Y.toDate)Te=Y.toDate();else if(typeof Y=="string")Te=new Date(Y);else return"";if(isNaN(Te.getTime()))return"";const we=new Date;return Te.getDate()===we.getDate()&&Te.getMonth()===we.getMonth()&&Te.getFullYear()===we.getFullYear()?Te.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):`${Te.toLocaleDateString()} ${Te.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`},ue=Y=>{if(Oe.current!==null)return;const Te=window.setInterval(async()=>{try{if(pe.current>Date.now())return;if(typeof navigator<"u"&&navigator&&"onLine"in navigator&&navigator.onLine===!1){ae.current++,ae.current>=3&&(pe.current=Date.now()+3e4,ae.current=0);return}const we=new AbortController,le=setTimeout(()=>we.abort(),6e3),ce=await fetch(`${yp}/get/${Y}`,{signal:we.signal,cache:"no-store"});if(clearTimeout(le),!ce.ok){ae.current++,ae.current>=3&&(pe.current=Date.now()+15e3,ae.current=0);return}const st=await ce.json().catch(()=>null);if(!st)return;ae.current=0,pe.current=0;const yt=`server_${Date.now()}_${Math.random().toString(36).slice(2,10)}`;let _n=null,tn=st.message||st.msg||st.text||st.imageUrl||st.url||st.image||st.data||st.content;st.imageBase64&&(tn=`data:image/jpeg;base64,${st.imageBase64}`);let j=st.type;if(tn&&typeof tn=="string"&&(tn.startsWith("data:image")||tn.match(/\.(jpeg|jpg|gif|png|webp)$/i)||tn.length>200&&!tn.includes(" ")&&/^[A-Za-z0-9+/=]+$/.test(tn))&&(j="image"),!j&&tn&&(j="text"),j==="text"&&tn&&(_n={id:yt,senderType:"admin",message:tn,content:tn,type:"text",timestamp:new Date().toISOString()}),j==="image"&&tn){let U=tn;!U.startsWith("http")&&!U.startsWith("data:image")&&(U=`data:image/jpeg;base64,${tn}`),_n={id:yt,senderType:"admin",message:"",content:U,imageUrl:U,type:"image",timestamp:new Date().toISOString()}}_n&&(m(U=>[...U,_n]),G.current&&(G.current.currentTime=0,G.current.play().catch(U=>console.error("Error playing notification sound:",U))),W.current||P(U=>U+1),N(U=>new Set([...U,yt])),setTimeout(()=>{N(U=>{const V=new Set(U);return V.delete(yt),V})},5e3))}catch(we){const le=Date.now();le-fe.current>6e4&&(fe.current=le,console.error("Error polling support messages:",we)),ae.current++,ae.current>=3&&(pe.current=Date.now()+3e4,ae.current=0)}},3e3);Oe.current=Te},Ee=()=>{Oe.current!==null&&(window.clearInterval(Oe.current),Oe.current=null)},et=async()=>{if(!a.trim())return;const Y=a;l("");let Te=I;if(!Te){const ce=localStorage.getItem("support_chat_user_id");if(ce)Te=ce;else{const st=`web_${Date.now()}_${Math.random().toString(36).slice(2,10)}`;localStorage.setItem("support_chat_user_id",st),Te=st}A(Te)}const we=`client_${Date.now()}_${Math.random().toString(36).slice(2,10)}`,le={id:we,senderType:"client",message:Y,content:Y,timestamp:new Date().toISOString()};m(ce=>[...ce,le]);try{await fetch(`${yp}/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:Te,type:"text",message:Y,name:C.name,email:C.email,phone:C.phone})}),ue(Te)}catch(ce){console.error("Error sending support message:",ce),m(st=>st.filter(yt=>yt.id!==we)),l(Y),xe({title:"  ",description:"   ",variant:"destructive"})}},he=async()=>{if(!c.trim())return;const Y=c;u("");try{const Te=await hb(),we=nte(Te.phoneNumber,Y);window.open(we,"_blank")}catch(Te){console.error("Error opening WhatsApp:",Te),xe({title:"",description:"      ",variant:"destructive"}),u(Y)}},Ce=async()=>{o(null),m([]),localStorage.removeItem("support_chat_messages"),localStorage.removeItem("support_chat_user_id"),l(""),v(null),E(null),P(0),Ee(),xe({title:"  ",description:"     "})},Fe=Y=>{var we;const Te=(we=Y.target.files)==null?void 0:we[0];if(Te){if(!Te.type.startsWith("image/")){xe({title:"   ",description:"   ",variant:"destructive"});return}if(Te.size>5*1024*1024){xe({title:"   ",description:"     5 ",variant:"destructive"});return}v(Te);const le=new FileReader;le.onload=ce=>{var st;E((st=ce.target)==null?void 0:st.result)},le.readAsDataURL(Te)}},rt=Y=>new Promise((Te,we)=>{const le=new FileReader;le.onload=()=>{const ce=le.result.split(",")[1];Te(ce)},le.onerror=we,le.readAsDataURL(Y)}),ct=async()=>{if(!p)return;const Y=p;v(null),E(null),_(!0);let Te=I;if(!Te){const we=localStorage.getItem("support_chat_user_id");if(we)Te=we;else{const le=`web_${Date.now()}_${Math.random().toString(36).slice(2,10)}`;localStorage.setItem("support_chat_user_id",le),Te=le}A(Te)}try{const we=await rt(Y);await fetch(`${yp}/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:Te,name:C.name,email:C.email,phone:C.phone,type:"image",imageBase64:we})});const ce={id:`client_img_${Date.now()}_${Math.random().toString(36).slice(2,10)}`,senderType:"client",message:"",content:"",imageUrl:`data:image/jpeg;base64,${we}`,type:"image",timestamp:new Date().toISOString()};m(st=>[...st,ce]),ue(Te),xe({title:" ",description:"   "})}catch(we){console.error("Error sending image:",we),xe({title:"",description:"   .    .",variant:"destructive"})}finally{_(!1),ke.current&&(ke.current.value="")}},Lt=()=>{var Y;(Y=ke.current)==null||Y.click()},Ct=()=>{s(!1),P(0)},dt=()=>{r||(P(0),I&&ue(I)),s(!r)};return tr||Nr||!e?null:f.jsxs(f.Fragment,{children:[f.jsx("style",{children:`
           @keyframes pulse {
             0% {
               transform: scale(1);
               box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
             }
             70% {
               transform: scale(1.05);
               box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
             }
             100% {
               transform: scale(1);
               box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
             }
           }

          @keyframes slideIn {
             0% {
               transform: translateX(${t==="left"?"-100%":"100%"});
               opacity: 0;
             }
             100% {
               transform: translateX(0);
               opacity: 1;
             }
           }

           .chat-container {
             position: fixed;
             bottom: 40px;
             ${t}: 40px;
             z-index: 100;
             animation: slideIn 0.8s ease-out;
           }

           .chat-float {
             width: 60px;
             height: 60px;
             background: linear-gradient(135deg, rgba(59, 130, 246, 0.9), rgba(37, 99, 235, 0.9));
             color: #FFF;
             border-radius: 50px;
             text-align: center;
             font-size: 30px;
             box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
             cursor: pointer;
             transition: all 0.3s ease;
             display: flex;
             align-items: center;
             justify-content: center;
             border: 2px solid rgba(255, 255, 255, 0.3);
             outline: none;
             position: relative;
             backdrop-filter: blur(10px);
           }

           .chat-float:hover {
             transform: scale(1.1) rotate(5deg);
             box-shadow: 0 6px 20px rgba(59, 130, 246, 0.5);
           }

           .chat-dialog {
             position: absolute;
             bottom: 80px;
             ${t}: 0;
             width: 350px;
             max-height: 70vh;
             background: white;
             border-radius: 16px;
             box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
             border: 1px solid rgba(59, 130, 246, 0.2);
             overflow: hidden;
             transform-origin: bottom ${t};
             animation: slideIn 0.3s ease-out;
             display: flex;
             flex-direction: column;
           }

           .chat-dialog-fullscreen {
             position: fixed;
             inset: 0;
             ${t}: 0;
             bottom: 0;
             width: 100vw;
             max-width: 100vw;
             max-height: 100vh;
             border-radius: 0;
             box-shadow: none;
             border-width: 0;
             animation: slideIn 0.3s ease-out;
             display: flex;
             flex-direction: column;
             z-index: 2000;
           }

           html.android-native .chat-dialog-fullscreen {
             padding-top: env(safe-area-inset-top);
             padding-bottom: env(safe-area-inset-bottom);
           }

           .messages-container {
             flex: 1;
             overflow-y: auto;
             padding: 16px;
             background: #f8fafc;
             min-height: 0;
           }

           .message {
             margin-bottom: 12px;
             padding: 8px 12px;
             border-radius: 12px;
             max-width: 80%;
             word-wrap: break-word;
           }

           .message.client {
             background: linear-gradient(135deg, #3b82f6, #2563eb);
             color: white;
             margin-left: auto;
             text-align: right;
           }

           .message.admin {
-                background: #e2e8f0;
-                color: #334155;
+                background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
+                color: #0f172a;
+                border: 2px solid #0ea5e9;
+                box-shadow: 0 2px 8px rgba(14, 165, 233, 0.2);
             margin-right: auto;
+             position: relative;
+           }
+           
+           .message.admin.new-message {
+             animation: newMessagePulse 2s ease-in-out;
+             border-color: #10b981;
+             background: linear-gradient(135deg, #f0fdf4, #dcfce7);
+             box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
+           }
+           
+           .message.admin.new-message::before {
+             content: "";
+             position: absolute;
+             top: -8px;
+             right: -8px;
+             background: #10b981;
+             color: white;
+             font-size: 10px;
+             padding: 2px 6px;
+             border-radius: 8px;
+             font-weight: bold;
+           }
+           
+           @keyframes newMessagePulse {
+             0% {
+               transform: scale(1);
+               box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
+             }
+             50% {
+               transform: scale(1.02);
+               box-shadow: 0 6px 16px rgba(16, 185, 129, 0.5);
+             }
+             100% {
+               transform: scale(1);
+               box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
+             }
            }
            margin-right: auto;
          }

          @media (max-width: 768px) {
            .chat-container {
              bottom: 80px;
              ${t}: 16px;
              pointer-events: none;
            }
            
            .chat-dialog {
              width: 300px;
              max-height: 400px;
              pointer-events: auto;
              bottom: 0;
            }

            html.android-native .chat-dialog-fullscreen {
              width: 100vw;
              max-height: 100vh;
              bottom: 0;
              pointer-events: auto;
            }
            
            .chat-float {
              display: none !important;
            }
          }
        `}),f.jsxs("div",{className:"chat-container",children:[r&&f.jsxs("div",{className:cr?"chat-dialog chat-dialog-fullscreen":"chat-dialog",children:[f.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Yc,{className:"h-5 w-5"}),f.jsx("span",{className:"font-semibold",children:"   cashy link"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[i&&f.jsx(bt,{variant:"ghost",size:"sm",onClick:Ce,className:"text-white hover:bg-red-500/20 h-8 w-8 p-0",title:" ",children:f.jsx(vk,{className:"h-4 w-4"})}),f.jsx(bt,{variant:"ghost",size:"sm",onClick:Ct,className:"text-white hover:bg-white/20 h-8 w-8 p-0",children:f.jsx($i,{className:"h-4 w-4"})})]})]}),!i&&!R?f.jsxs("div",{className:"p-6 space-y-4",children:[f.jsxs("div",{className:"text-center space-y-2",children:[f.jsx("h3",{className:"font-semibold text-lg",children:"    "}),f.jsx("p",{className:"text-sm text-gray-500",children:"  .    :"})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs(bt,{onClick:kr,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[f.jsx(Yc,{className:"w-4 h-4 ml-2"}),"   "]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-0 flex items-center",children:f.jsx("span",{className:"w-full border-t"})}),f.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:f.jsx("span",{className:"bg-white px-2 text-gray-500",children:""})})]}),f.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-100",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2 text-green-700 font-medium",children:[f.jsx(Yc,{className:"w-4 h-4"}),f.jsx("span",{children:""})]}),f.jsx(ir,{dir:"ltr",placeholder:"  ...",value:c,onChange:Y=>u(Y.target.value),className:"mb-2 bg-white"}),f.jsx(bt,{className:"w-full bg-[#25D366] hover:bg-[#128C7E] text-white",onClick:he,children:" "})]})]})]}):R&&!i?f.jsxs("div",{className:"p-6 space-y-4",children:[f.jsxs("div",{className:"text-center space-y-2",children:[f.jsx("h3",{className:"font-semibold text-lg",children:" "}),f.jsx("p",{className:"text-sm text-gray-500",children:"    "})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium mb-1 block",children:""}),f.jsx(ir,{placeholder:" ",value:C.name,onChange:Y=>L({...C,name:Y.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium mb-1 block",children:" "}),f.jsx(ir,{placeholder:"example@email.com",type:"email",value:C.email,onChange:Y=>L({...C,email:Y.target.value})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium mb-1 block",children:" "}),f.jsx(ir,{placeholder:"01xxxxxxxxx",type:"tel",value:C.phone,onChange:Y=>L({...C,phone:Y.target.value})})]}),f.jsx(bt,{onClick:Dr,className:"w-full mt-4 bg-blue-600 text-white hover:bg-blue-700",children:"  "}),f.jsx(bt,{variant:"ghost",onClick:()=>k(!1),className:"w-full",children:""})]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"messages-container",children:[d.length===0?f.jsxs("div",{className:"text-center text-gray-500 py-8",children:[f.jsx(Yc,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),f.jsx("p",{children:"   "}),f.jsx("p",{className:"text-sm",children:"   "})]}):d.map(Y=>f.jsx("div",{className:`flex mb-4 ${Y.senderType==="client"?"justify-end":"justify-start"}`,children:f.jsxs("div",{className:`max-w-[80%] p-3 rounded-lg ${Y.senderType==="client"?"bg-blue-600 text-white rounded-br-none":"bg-gray-100 text-gray-800 rounded-bl-none"}`,children:[Y.type==="image"?f.jsxs("div",{children:[f.jsx("img",{src:Y.imageUrl||"https://placehold.co/300x200?text=Image+Unavailable",alt:" ",className:"max-w-full h-auto rounded-lg mb-2 cursor-pointer",onClick:()=>Y.imageUrl&&X(Y.imageUrl),style:{maxHeight:"200px"}}),Y.message&&f.jsx("div",{className:"text-sm",children:Y.message})]}):f.jsx("div",{className:"text-sm",children:Y.message||Y.content||" "}),f.jsx("span",{className:"text-[10px] opacity-70 mt-1 block",children:J(Y.timestamp)})]})},Y.id)),f.jsx("div",{ref:je})]}),f.jsxs("div",{className:"p-4 border-t bg-white",children:[g&&f.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700",children:" :"}),f.jsx(bt,{variant:"ghost",size:"sm",onClick:()=>{v(null),E(null),ke.current&&(ke.current.value="")},className:"h-6 w-6 p-0 text-gray-500 hover:text-red-500",children:f.jsx($i,{className:"h-4 w-4"})})]}),f.jsx("img",{src:g,alt:"",className:"max-w-full h-auto rounded-lg",style:{maxHeight:"150px"}}),f.jsx("div",{className:"flex gap-2 mt-2",children:f.jsx(bt,{onClick:ct,disabled:b,size:"sm",className:"bg-green-600 hover:bg-green-700 flex-1",children:b?" ...":" "})})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(ir,{placeholder:"  ...",value:a,onChange:Y=>l(Y.target.value),onKeyPress:Y=>Y.key==="Enter"&&et(),className:"flex-1 text-right",dir:"rtl"}),f.jsx("input",{type:"file",ref:ke,onChange:Fe,accept:"image/*",className:"hidden"}),f.jsx(bt,{onClick:Lt,size:"sm",variant:"outline",className:"px-3",title:" ",children:f.jsx(H3,{className:"h-4 w-4"})}),f.jsx(bt,{onClick:et,disabled:!a.trim(),size:"sm",className:"bg-blue-600 hover:bg-blue-700 px-3",children:f.jsx(h5,{className:"h-4 w-4"})})]})]})]})]}),!Yn&&f.jsxs("div",{className:"relative inline-block",children:[!r&&f.jsx("div",{onClick:Y=>{Y.stopPropagation(),Y.preventDefault(),n(!1)},className:"absolute -top-1 -left-1 bg-gray-200 hover:bg-red-500 hover:text-white text-gray-600 rounded-full p-0.5 w-5 h-5 flex items-center justify-center shadow-md cursor-pointer transition-colors z-[102]",title:"",children:f.jsx($i,{size:12})}),f.jsxs("button",{className:"chat-float",onClick:dt,title:"  ",children:[!r&&S>0&&f.jsx("div",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full h-6 w-6 flex items-center justify-center min-w-[24px] shadow-lg",children:S>99?"99+":S}),r?f.jsx($i,{className:"h-6 w-6"}):f.jsx(Yc,{className:"h-6 w-6"})]})]}),O&&f.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/80 flex items-center justify-center p-4 backdrop-blur-sm",onClick:()=>X(null),children:f.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] w-full flex items-center justify-center",onClick:Y=>Y.stopPropagation(),children:[f.jsx("button",{onClick:()=>X(null),className:"absolute -top-12 right-0 bg-white/10 hover:bg-white/20 text-white rounded-full p-2 transition-colors",children:f.jsx($i,{className:"h-6 w-6"})}),f.jsx("img",{src:O,alt:"Full size",className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl"})]})}),f.jsx("audio",{ref:G,src:"https://res.cloudinary.com/dxfq3iotg/video/upload/v1557233524/success.mp3",hidden:!0})]})]})};var rte=y.createContext(void 0);function ste(t){const e=y.useContext(rte);return t||e||"ltr"}function ite(t,[e,n]){return Math.min(n,Math.max(e,t))}function ote(t,e){return y.useReducer((n,r)=>e[n][r]??n,t)}var wI="ScrollArea",[_j]=Ac(wI),[ate,ei]=_j(wI),bj=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...o}=t,[a,l]=y.useState(null),[c,u]=y.useState(null),[d,m]=y.useState(null),[p,v]=y.useState(null),[g,E]=y.useState(null),[b,_]=y.useState(0),[S,P]=y.useState(0),[T,N]=y.useState(!1),[I,A]=y.useState(!1),R=Kn(e,C=>l(C)),k=ste(s);return f.jsx(ate,{scope:n,type:r,dir:k,scrollHideDelay:i,scrollArea:a,viewport:c,onViewportChange:u,content:d,onContentChange:m,scrollbarX:p,onScrollbarXChange:v,scrollbarXEnabled:T,onScrollbarXEnabledChange:N,scrollbarY:g,onScrollbarYChange:E,scrollbarYEnabled:I,onScrollbarYEnabledChange:A,onCornerWidthChange:_,onCornerHeightChange:P,children:f.jsx(wn.div,{dir:k,...o,ref:R,style:{position:"relative","--radix-scroll-area-corner-width":b+"px","--radix-scroll-area-corner-height":S+"px",...t.style}})})});bj.displayName=wI;var Ej="ScrollAreaViewport",Sj=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=t,o=ei(Ej,n),a=y.useRef(null),l=Kn(e,a,o.onViewportChange);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),f.jsx(wn.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:f.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});Sj.displayName=Ej;var lo="ScrollAreaScrollbar",_I=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=ei(lo,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=s,a=t.orientation==="horizontal";return y.useEffect(()=>(a?i(!0):o(!0),()=>{a?i(!1):o(!1)}),[a,i,o]),s.type==="hover"?f.jsx(lte,{...r,ref:e,forceMount:n}):s.type==="scroll"?f.jsx(cte,{...r,ref:e,forceMount:n}):s.type==="auto"?f.jsx(Ij,{...r,ref:e,forceMount:n}):s.type==="always"?f.jsx(bI,{...r,ref:e}):null});_I.displayName=lo;var lte=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=ei(lo,t.__scopeScrollArea),[i,o]=y.useState(!1);return y.useEffect(()=>{const a=s.scrollArea;let l=0;if(a){const c=()=>{window.clearTimeout(l),o(!0)},u=()=>{l=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return a.addEventListener("pointerenter",c),a.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),a.removeEventListener("pointerenter",c),a.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),f.jsx(Si,{present:n||i,children:f.jsx(Ij,{"data-state":i?"visible":"hidden",...r,ref:e})})}),cte=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=ei(lo,t.__scopeScrollArea),i=t.orientation==="horizontal",o=$v(()=>l("SCROLL_END"),100),[a,l]=ote("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return y.useEffect(()=>{if(a==="idle"){const c=window.setTimeout(()=>l("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(c)}},[a,s.scrollHideDelay,l]),y.useEffect(()=>{const c=s.viewport,u=i?"scrollLeft":"scrollTop";if(c){let d=c[u];const m=()=>{const p=c[u];d!==p&&(l("SCROLL"),o()),d=p};return c.addEventListener("scroll",m),()=>c.removeEventListener("scroll",m)}},[s.viewport,i,l,o]),f.jsx(Si,{present:n||a!=="hidden",children:f.jsx(bI,{"data-state":a==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:Zt(t.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Zt(t.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),Ij=y.forwardRef((t,e)=>{const n=ei(lo,t.__scopeScrollArea),{forceMount:r,...s}=t,[i,o]=y.useState(!1),a=t.orientation==="horizontal",l=$v(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;o(a?c:u)}},10);return Pd(n.viewport,l),Pd(n.content,l),f.jsx(Si,{present:r||i,children:f.jsx(bI,{"data-state":i?"visible":"hidden",...s,ref:e})})}),bI=y.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,s=ei(lo,t.__scopeScrollArea),i=y.useRef(null),o=y.useRef(0),[a,l]=y.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=Rj(a.viewport,a.content),u={...r,sizes:a,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:m=>i.current=m,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:m=>o.current=m};function d(m,p){return pte(m,o.current,a,p)}return n==="horizontal"?f.jsx(ute,{...u,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const m=s.viewport.scrollLeft,p=LP(m,a,s.dir);i.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:m=>{s.viewport&&(s.viewport.scrollLeft=m)},onDragScroll:m=>{s.viewport&&(s.viewport.scrollLeft=d(m,s.dir))}}):n==="vertical"?f.jsx(dte,{...u,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const m=s.viewport.scrollTop,p=LP(m,a);i.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:m=>{s.viewport&&(s.viewport.scrollTop=m)},onDragScroll:m=>{s.viewport&&(s.viewport.scrollTop=d(m))}}):null}),ute=y.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=ei(lo,t.__scopeScrollArea),[o,a]=y.useState(),l=y.useRef(null),c=Kn(e,l,i.onScrollbarXChange);return y.useEffect(()=>{l.current&&a(getComputedStyle(l.current))},[l]),f.jsx(xj,{"data-orientation":"horizontal",...s,ref:c,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Uv(n)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.x),onDragScroll:u=>t.onDragScroll(u.x),onWheelScroll:(u,d)=>{if(i.viewport){const m=i.viewport.scrollLeft+u.deltaX;t.onWheelScroll(m),Nj(m,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:wy(o.paddingLeft),paddingEnd:wy(o.paddingRight)}})}})}),dte=y.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=ei(lo,t.__scopeScrollArea),[o,a]=y.useState(),l=y.useRef(null),c=Kn(e,l,i.onScrollbarYChange);return y.useEffect(()=>{l.current&&a(getComputedStyle(l.current))},[l]),f.jsx(xj,{"data-orientation":"vertical",...s,ref:c,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Uv(n)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.y),onDragScroll:u=>t.onDragScroll(u.y),onWheelScroll:(u,d)=>{if(i.viewport){const m=i.viewport.scrollTop+u.deltaY;t.onWheelScroll(m),Nj(m,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:wy(o.paddingTop),paddingEnd:wy(o.paddingBottom)}})}})}),[hte,Tj]=_j(lo),xj=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:a,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:d,...m}=t,p=ei(lo,n),[v,g]=y.useState(null),E=Kn(e,R=>g(R)),b=y.useRef(null),_=y.useRef(""),S=p.viewport,P=r.content-r.viewport,T=jr(u),N=jr(l),I=$v(d,10);function A(R){if(b.current){const k=R.clientX-b.current.left,C=R.clientY-b.current.top;c({x:k,y:C})}}return y.useEffect(()=>{const R=k=>{const C=k.target;(v==null?void 0:v.contains(C))&&T(k,P)};return document.addEventListener("wheel",R,{passive:!1}),()=>document.removeEventListener("wheel",R,{passive:!1})},[S,v,P,T]),y.useEffect(N,[r,N]),Pd(v,I),Pd(p.content,I),f.jsx(hte,{scope:n,scrollbar:v,hasThumb:s,onThumbChange:jr(i),onThumbPointerUp:jr(o),onThumbPositionChange:N,onThumbPointerDown:jr(a),children:f.jsx(wn.div,{...m,ref:E,style:{position:"absolute",...m.style},onPointerDown:Zt(t.onPointerDown,R=>{R.button===0&&(R.target.setPointerCapture(R.pointerId),b.current=v.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),A(R))}),onPointerMove:Zt(t.onPointerMove,A),onPointerUp:Zt(t.onPointerUp,R=>{const k=R.target;k.hasPointerCapture(R.pointerId)&&k.releasePointerCapture(R.pointerId),document.body.style.webkitUserSelect=_.current,p.viewport&&(p.viewport.style.scrollBehavior=""),b.current=null})})})}),vy="ScrollAreaThumb",Aj=y.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=Tj(vy,t.__scopeScrollArea);return f.jsx(Si,{present:n||s.hasThumb,children:f.jsx(fte,{ref:e,...r})})}),fte=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...s}=t,i=ei(vy,n),o=Tj(vy,n),{onThumbPositionChange:a}=o,l=Kn(e,d=>o.onThumbChange(d)),c=y.useRef(void 0),u=$v(()=>{c.current&&(c.current(),c.current=void 0)},100);return y.useEffect(()=>{const d=i.viewport;if(d){const m=()=>{if(u(),!c.current){const p=gte(d,a);c.current=p,a()}};return a(),d.addEventListener("scroll",m),()=>d.removeEventListener("scroll",m)}},[i.viewport,u,a]),f.jsx(wn.div,{"data-state":o.hasThumb?"visible":"hidden",...s,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Zt(t.onPointerDownCapture,d=>{const p=d.target.getBoundingClientRect(),v=d.clientX-p.left,g=d.clientY-p.top;o.onThumbPointerDown({x:v,y:g})}),onPointerUp:Zt(t.onPointerUp,o.onThumbPointerUp)})});Aj.displayName=vy;var EI="ScrollAreaCorner",Pj=y.forwardRef((t,e)=>{const n=ei(EI,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?f.jsx(mte,{...t,ref:e}):null});Pj.displayName=EI;var mte=y.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,s=ei(EI,n),[i,o]=y.useState(0),[a,l]=y.useState(0),c=!!(i&&a);return Pd(s.scrollbarX,()=>{var d;const u=((d=s.scrollbarX)==null?void 0:d.offsetHeight)||0;s.onCornerHeightChange(u),l(u)}),Pd(s.scrollbarY,()=>{var d;const u=((d=s.scrollbarY)==null?void 0:d.offsetWidth)||0;s.onCornerWidthChange(u),o(u)}),c?f.jsx(wn.div,{...r,ref:e,style:{width:i,height:a,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function wy(t){return t?parseInt(t,10):0}function Rj(t,e){const n=t/e;return isNaN(n)?0:n}function Uv(t){const e=Rj(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function pte(t,e,n,r="ltr"){const s=Uv(n),i=s/2,o=e||i,a=s-o,l=n.scrollbar.paddingStart+o,c=n.scrollbar.size-n.scrollbar.paddingEnd-a,u=n.content-n.viewport,d=r==="ltr"?[0,u]:[u*-1,0];return Cj([l,c],d)(t)}function LP(t,e,n="ltr"){const r=Uv(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,o=e.content-e.viewport,a=i-r,l=n==="ltr"?[0,o]:[o*-1,0],c=ite(t,l);return Cj([0,o],[0,a])(c)}function Cj(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function Nj(t,e){return t>0&&t<e}var gte=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function s(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,a=n.top!==i.top;(o||a)&&e(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function $v(t,e){const n=jr(t),r=y.useRef(0);return y.useEffect(()=>()=>window.clearTimeout(r.current),[]),y.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function Pd(t,e){const n=jr(e);eo(()=>{let r=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(t),()=>{window.cancelAnimationFrame(r),s.unobserve(t)}}},[t,n])}var kj=bj,yte=Sj,vte=Pj;const Dj=y.forwardRef(({className:t,children:e,...n},r)=>f.jsxs(kj,{ref:r,className:yn("relative overflow-hidden",t),...n,children:[f.jsx(yte,{className:"h-full w-full rounded-[inherit]",children:e}),f.jsx(Oj,{}),f.jsx(vte,{})]}));Dj.displayName=kj.displayName;const Oj=y.forwardRef(({className:t,orientation:e="vertical",...n},r)=>f.jsx(_I,{ref:r,orientation:e,className:yn("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-3 bg-muted rounded-md p-[2px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:f.jsx(Aj,{className:"relative flex-1 rounded-full bg-gray-400 hover:bg-gray-500 transition-colors"})}));Oj.displayName=_I.displayName;const wte=()=>{const[t,e]=y.useState(!1),[n,r]=y.useState([]),[s,i]=y.useState(!1);hl(),y.useRef([]),y.useEffect(()=>{const u=d=>{var m;if((m=d.detail)!=null&&m.isPending){const p={id:`pending-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,data:d.detail,status:"pending",receivedAt:Date.now()};r(v=>v.some(E=>E.data.postedAt===p.data.postedAt&&E.data.text===p.data.text)?v:[...v,p]),e(!0)}};return window.addEventListener("vfNotificationReceived",u),()=>{window.removeEventListener("vfNotificationReceived",u)}},[]),y.useEffect(()=>{t&&n.some(u=>u.status==="pending")&&!s&&o()},[t,n,s]);const o=async()=>{i(!0);const u=n.findIndex(m=>m.status==="pending");if(u===-1){i(!1);return}const d=n[u];a(d.id,"processing"),await new Promise(m=>setTimeout(m,800));try{const{isPending:m,...p}=d.data;await eg(p,{toast:()=>{}}),a(d.id,"success")}catch(m){console.error("Error processing pending transaction",m),a(d.id,"error"," ")}i(!1)},a=(u,d,m)=>{r(p=>p.map(v=>v.id===u?{...v,status:d,errorMessage:m}:v))},l=()=>{e(!1),setTimeout(()=>{r(u=>u.filter(d=>d.status!=="success"))},500)},c=n.length>0&&n.every(u=>u.status==="success"||u.status==="error");return!t&&n.length===0?null:f.jsx(Ha,{open:t,onOpenChange:u=>!u&&c&&l(),children:f.jsxs(Ro,{className:"sm:max-w-md",onPointerDownOutside:u=>!c&&u.preventDefault(),children:[f.jsxs(al,{children:[f.jsx(ll,{className:"text-center text-xl mb-2",children:" "}),f.jsx("p",{className:"text-center text-muted-foreground text-sm",children:"          "})]}),f.jsx(Dj,{className:"max-h-[60vh] mt-4 pr-4",children:f.jsx("div",{className:"space-y-4",children:n.map(u=>f.jsxs("div",{className:`p-4 rounded-lg border flex items-center justify-between transition-colors duration-300 ${u.status==="success"?"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800":u.status==="error"?"bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800":"bg-card border-border"}`,children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("span",{className:"font-bold text-lg",children:u.data.amount?`${Number(u.data.amount).toLocaleString("en-US",{maximumFractionDigits:0})} .`:"  "}),f.jsx("span",{className:"text-xs text-muted-foreground bg-secondary px-2 py-0.5 rounded-full",children:new Date(u.data.postedAt||Date.now()).toLocaleTimeString("ar-EG")})]}),f.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:u.data.text||u.data.title||"  "}),u.errorMessage&&f.jsx("p",{className:"text-xs text-red-500 mt-1",children:u.errorMessage})]}),f.jsxs("div",{className:"mr-4 flex-shrink-0",children:[u.status==="pending"&&f.jsx("div",{className:"h-8 w-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center animate-pulse",children:f.jsx($i,{className:"h-5 w-5"})}),u.status==="processing"&&f.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center",children:f.jsx(fE,{className:"h-5 w-5 animate-spin"})}),u.status==="success"&&f.jsx("div",{className:"h-8 w-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center animate-in zoom-in duration-300",children:f.jsx(gk,{className:"h-5 w-5"})}),u.status==="error"&&f.jsx("div",{className:"h-8 w-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center",children:f.jsx($i,{className:"h-5 w-5"})})]})]},u.id))})}),f.jsx("div",{className:"mt-6 flex justify-center",children:f.jsx(bt,{onClick:l,disabled:!c,className:`w-full transition-all duration-300 ${c?"bg-green-600 hover:bg-green-700":""}`,children:c?"  ":" ..."})})]})})},_te={},MP=M.lazy(()=>ee(()=>import("./Index-27Mveu3n.js"),[],import.meta.url)),vp=M.lazy(()=>ee(()=>import("./LandingPage-DoYGgVis.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url)),VP=M.lazy(()=>ee(()=>import("./SubscriptionsPage-CBhWDcn8.js"),__vite__mapDeps([9,10,11,1,2,12,7]),import.meta.url)),jP=M.lazy(()=>ee(()=>import("./AuthPage-6wJ4ilRc.js"),__vite__mapDeps([13,5,3]),import.meta.url)),wp=M.lazy(()=>ee(()=>import("./TopUpPage-BJoYNtD0.js"),__vite__mapDeps([14,15]),import.meta.url)),FP=M.lazy(()=>ee(()=>import("./AdminTopupsPage-CRJP3_Nt.js"),__vite__mapDeps([16,15]),import.meta.url)),UP=M.lazy(()=>ee(()=>import("./AdminNotificationsPage-DtfvHRp1.js"),__vite__mapDeps([17,18,19]),import.meta.url)),_p=M.lazy(()=>ee(()=>import("./UserRegisterPage-r8M0t8fy.js"),__vite__mapDeps([20,21,22,23]),import.meta.url)),$P=M.lazy(()=>ee(()=>import("./UserAccountSetupPage-BPoVexWs.js"),__vite__mapDeps([24,21,7]),import.meta.url)),BP=M.lazy(()=>ee(()=>import("./ForgotPasswordCodePage-XWhaKWL8.js"),[],import.meta.url)),zP=M.lazy(()=>ee(()=>import("./DashboardLoginPage-D-Y3X7-f.js"),[],import.meta.url)),WP=M.lazy(()=>ee(()=>import("./ProtectedDashboard-CMyGL1BE.js"),__vite__mapDeps([25,15,22,26,27,28]),import.meta.url)),ng=M.lazy(()=>ee(()=>import("./ProtectedUserDashboard-c6O-i0ck.js"),__vite__mapDeps([29,30,19]),import.meta.url)),qP=M.lazy(()=>ee(()=>import("./MerchantDashboard-BvehcK8E.js"),__vite__mapDeps([31,32,33,34,35,15,36,37,38,22,2,39,5,40]),import.meta.url)),HP=M.lazy(()=>ee(()=>import("./PendingApprovalPage-DxsLZkqf.js"),__vite__mapDeps([41,42]),import.meta.url)),KP=M.lazy(()=>ee(()=>import("./AdminLogin-DnJibcfp.js"),[],import.meta.url)),GP=M.lazy(()=>ee(()=>import("./ProtectedAdminDashboard-BS6A8Uip.js").then(t=>t.P),__vite__mapDeps([43,10,44,45,42,21,46,39,47,30,18,11,15,6,8,1,7,48,49,33,40,35,5,50,51,3,52]),import.meta.url)),QP=M.lazy(()=>ee(()=>import("./AuthTestPage-CvSaFgx5.js"),[],import.meta.url)),YP=M.lazy(()=>ee(()=>import("./ProfileSettingsPage-DnVs4YJB.js").then(t=>t.b),__vite__mapDeps([53,45,40,54,15,50,27,7,39,8,2]),import.meta.url)),JP=M.lazy(()=>ee(()=>import("./TransactionsPage-C1gBXxdf.js"),__vite__mapDeps([55,15,49,33,56,57,46,37,7,38,5,58,54,11,59,52,27,60,26,61,62,48,50,63,39,28,2,64]),import.meta.url)),XP=M.lazy(()=>ee(()=>import("./WalletAdditionPage-D8TejFVF.js"),[],import.meta.url)),ZP=M.lazy(()=>ee(()=>import("./ReferralsPage-D8GbRMX3.js"),__vite__mapDeps([65,21,23,19,7,47,50]),import.meta.url)),eR=M.lazy(()=>ee(()=>import("./NotFound-BT9R4nfz.js"),[],import.meta.url)),tR=M.lazy(()=>ee(()=>import("./PrivacyPolicyPage-CLvptPEP.js"),[],import.meta.url)),Bl=new p9({defaultOptions:{queries:{gcTime:3e5}}});if(typeof window<"u")try{const t=b9({storage:window.localStorage,key:"cashylink:rq-cache",throttleTime:1e3});_9({queryClient:Bl,persister:t,maxAge:24*60*60*1e3})}catch{}const bte=()=>{if(!((ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android"))return null;const e=()=>{try{window.location.reload()}catch{}};return f.jsx("div",{className:"fixed right-2 z-[2000] flex items-center gap-2",style:{pointerEvents:"auto",top:"calc(env(safe-area-inset-top, 0px) + 24px)"},children:f.jsx("button",{type:"button","aria-label":"",title:" ",onClick:e,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-blue-600 hover:bg-blue-500/10 focus:outline-none dark:text-blue-400 dark:hover:bg-blue-400/10",children:f.jsx(mE,{className:"w-5 h-5"})})})},nR=()=>{const t=Ii(),{user:e,loading:n}=Zs(),r=(ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android",s=t.pathname.startsWith("/user/dashboard"),i=r&&t.pathname==="/",o=!!e&&(s||i);return n?null:o?f.jsx(vee,{}):null},Ete=(t,e)=>{try{const n=String(e||"").toLowerCase(),r=String(t||"").toLowerCase();return!!(n.includes("vf-cash")||n.includes("vodafone")||n.includes("vfcash")||n.includes("etisalat")||n.includes("e&")||/\s*|etisalat|e&|money/i.test(t)||r.includes("vodafone cash")||r.includes("etisalat cash")||/Received\s*EGP/i.test(t))}catch{return!1}},a_=async t=>{try{const e=String(localStorage.getItem(`selectedWallet_${t}`)||"").trim();if(!e)return"";const{merchantWalletService:n}=await ee(async()=>{const{merchantWalletService:c}=await Promise.resolve().then(()=>Oi);return{merchantWalletService:c}},void 0,import.meta.url),r=await n.getByMerchantId(t),s=localStorage.getItem(`wallets_${t}`),i=s?JSON.parse(s):[],a=[...Array.isArray(i)?i:[],...Array.isArray(r)?r:[]].find(c=>String((c==null?void 0:c.id)||"")===e);return String((a==null?void 0:a.msisdn)||(a==null?void 0:a.phone)||"")}catch{return""}},rR=async t=>{var e;try{const n=Object.keys(localStorage),r=`selectedWallet_${t}`,s=`wallets_${t}`,i=n.find(d=>d.startsWith(r));if(i){const d=localStorage.getItem(i)||"";if(d)return d}const{merchantWalletService:o}=await ee(async()=>{const{merchantWalletService:d}=await Promise.resolve().then(()=>Oi);return{merchantWalletService:d}},void 0,import.meta.url),a=await o.getByMerchantId(t),l=localStorage.getItem(s),c=l?JSON.parse(l):[],u=[...Array.isArray(c)?c:[],...Array.isArray(a)?a:[]];if(u.length>0){const d=u.find(p=>!!(p!=null&&p.isDefault)),m=String(((d==null?void 0:d.id)??((e=u[0])==null?void 0:e.id))||"").trim();if(m)return m}}catch{}return""},sR=()=>{const t=mj(),e=(ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android",{profile:n,user:r}=Zs(),{shopId:s}=tte(),i=Ii(),o=(ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android"&&i.pathname==="/"&&!!r;M.useEffect(()=>{(async()=>{if(ge.isNativePlatform())try{await ia.setOverlaysWebView({overlay:!1}),await ia.setStyle({style:gy.Light}),ge.getPlatform()==="android"&&(await ia.setBackgroundColor({color:"#FFFFFF"}),await ia.show())}catch(V){console.warn("StatusBar config failed",V)}})(),(async()=>{if(ge.isNativePlatform()&&ge.getPlatform()==="android")try{await ia.setOverlaysWebView({overlay:!1}),await ia.setBackgroundColor({color:"#FFFFFF"}),await ia.setStyle({style:gy.Light}),await ia.show()}catch(V){console.warn("StatusBar re-config failed",V)}})()},[i.pathname]),M.useEffect(()=>{if(!e||!(r!=null&&r.uid))return;const j=async()=>{try{const V=await rR(r.uid),Z=V,q=s||"";if(window.CashyAndroid&&(window.CashyAndroid.setUserId&&window.CashyAndroid.setUserId(r.uid),window.CashyAndroid.setContext&&window.CashyAndroid.setContext(q,V,Z),window.CashyAndroid.setAutoTransferRecord)){const oe=localStorage.getItem("autoTransferRecord")==="true";window.CashyAndroid.setAutoTransferRecord(oe)}}catch(V){console.error("Context Sync Error",V)}};j();const U=setInterval(j,1e4);return()=>clearInterval(U)},[e,r==null?void 0:r.uid,s]),M.useEffect(()=>{const j=window.electronAPI;if(j){try{const U=localStorage.getItem("adbSmsReadingEnabled")==="true";j.toggleAdbSms&&j.toggleAdbSms(U)}catch{}j.onAdbSmsReceived&&j.onAdbSmsReceived(U=>{console.log("[App] ADB SMS Received:",U);const V={text:U.text,sender:U.sender,msisdn:U.sender,receivedAt:Date.now()};window.dispatchEvent(new CustomEvent("mobileSmsReceived",{detail:V}))})}},[]);const a=i.pathname.startsWith("/user/login")||i.pathname.startsWith("/auth")||i.pathname.startsWith("/landing")||i.pathname==="/"&&!o&&!r,l=!!r&&!a||i.pathname.startsWith("/user/dashboard")||o;M.useEffect(()=>{r&&console.log("Dashboard State Check:",{path:i.pathname,isUserDashboard:l,isAuthOrLanding:a,userUid:r.uid})},[i.pathname,l,r]);const c=oo(),{toast:u}=hl(),[d,m]=M.useState(!1),[p,v]=M.useState(null),[g,E]=M.useState(!1),[b,_]=M.useState(null),[S,P]=M.useState(!1),[T,N]=M.useState(""),[I,A]=M.useState(""),[R,k]=M.useState(null),[C,L]=M.useState(null),O=M.useRef(null),X=M.useRef(null),ke=M.useRef(!1),Oe=M.useRef(null),je=M.useRef(""),W=M.useRef(""),G=M.useRef(new Set);M.useEffect(()=>{try{const j=localStorage.getItem("sms_suppressed_ids")||"[]",U=Array.isArray(JSON.parse(j))?JSON.parse(j):[];G.current=new Set(U.map(V=>String(V||"")))}catch{}},[]);const[ae,pe]=M.useState(!1),fe=M.useRef(n),Ge=M.useRef([]);M.useEffect(()=>{fe.current=n},[n]),M.useEffect(()=>{if(!(r!=null&&r.uid))return;let j;return(async()=>{try{const{collection:U,query:V,where:Z,onSnapshot:q}=await ee(async()=>{const{collection:Pe,query:it,where:te,onSnapshot:ne}=await Promise.resolve().then(()=>kn);return{collection:Pe,query:it,where:te,onSnapshot:ne}},void 0,import.meta.url),{db:oe}=await ee(async()=>{const{db:Pe}=await Promise.resolve().then(()=>En);return{db:Pe}},void 0,import.meta.url),H=V(U(oe,"wallets"),Z("userId","==",r.uid));j=q(H,Pe=>{Ge.current=Pe.docs.map(it=>({id:it.id,...it.data()}))})}catch{}})(),()=>{j&&j()}},[r==null?void 0:r.uid]),Zee(),M.useEffect(()=>{const j=U=>{};return window.addEventListener("notificationListenerStatus",j),()=>window.removeEventListener("notificationListenerStatus",j)},[u,e]);const[xe,ve]=M.useState(!1),[Q,qe]=M.useState(null),[cn,cr]=M.useState(""),[Yn,tr]=M.useState(!1),[Nr,kr]=M.useState(!1),[Dr,J]=M.useState(""),[ue,Ee]=M.useState(""),[et,he]=M.useState(!1),[Ce,Fe]=M.useState(0),[rt,ct]=M.useState(!1),[Lt,Ct]=M.useState(""),[dt,Y]=M.useState("");M.useEffect(()=>{try{const j=(r==null?void 0:r.uid)||"default",U=localStorage.getItem(`sim1Number_${j}`)??localStorage.getItem("sim1Number")??"",V=localStorage.getItem(`sim2Number_${j}`)??localStorage.getItem("sim2Number")??"";Ct(U),Y(V),je.current=U,W.current=V}catch{}},[r==null?void 0:r.uid]);const Te=M.useCallback(()=>{try{localStorage.setItem("privacyPolicyAccepted","true")}catch{}ct(!1);try{c("/user/login")}catch{}},[c]);M.useEffect(()=>{ct(!1)},[r,e]);const we=M.useCallback(()=>{try{const j=window.AudioContext||window.webkitAudioContext;if(!j)return;const U=new j,V=U.createOscillator(),Z=U.createGain();V.type="sine",Z.gain.setValueAtTime(0,U.currentTime),V.connect(Z),Z.connect(U.destination);const q=U.currentTime;V.frequency.setValueAtTime(800,q),Z.gain.linearRampToValueAtTime(.15,q+.02),V.start(q),V.frequency.exponentialRampToValueAtTime(1200,q+.08),Z.gain.exponentialRampToValueAtTime(1e-5,q+.32),V.stop(q+.35)}catch{}},[]),le=M.useCallback(()=>{try{const j=window.AudioContext||window.webkitAudioContext;if(!j)return;const U=new j,V=U.createOscillator(),Z=U.createGain();V.type="sawtooth",Z.gain.setValueAtTime(.5,U.currentTime),V.connect(Z),Z.connect(U.destination);const q=U.currentTime;V.start(q);for(let oe=0;oe<14;oe++){const H=q+oe*.5;V.frequency.setValueAtTime(600,H),V.frequency.linearRampToValueAtTime(800,H+.25),V.frequency.setValueAtTime(800,H+.25),V.frequency.linearRampToValueAtTime(600,H+.5)}V.stop(q+7)}catch{}},[]),ce=j=>{try{const U=String(j||"").replace(/[^0-9+]/g,"");if(!U)return"";if(U.startsWith("+20")){const V=U.slice(3);return V.startsWith("1")?"0"+V:V}if(U.startsWith("0020")){const V=U.slice(4);return V.startsWith("1")?"0"+V:V}if(U.startsWith("20")){const V=U.slice(2);return V.startsWith("1")?"0"+V:V}return U.startsWith("0")?U:/^(10|11|12|15)/.test(U)?"0"+U:U}catch{return""}};M.useEffect(()=>{(async()=>{var j;try{if(!xe||!Q){tr(!1);return}const{auth:U}=await ee(async()=>{const{auth:oe}=await Promise.resolve().then(()=>En);return{auth:oe}},void 0,import.meta.url),V=((j=U.currentUser)==null?void 0:j.uid)||"",Z=V?`selectedWallet_${V}`:"selectedWallet_default",q=localStorage.getItem(Z)||"";if(!q){tr(!0);return}try{const{merchantWalletService:oe}=await ee(async()=>{const{merchantWalletService:it}=await Promise.resolve().then(()=>mo);return{merchantWalletService:it}},void 0,import.meta.url),H=await oe.getById(q),Pe=H&&H.defaultWithdrawCommission!=null;tr(!Pe)}catch{tr(!0)}}catch{tr(!0)}})()},[xe,Q]);const st=async j=>{try{const{merchantWalletService:U,detectWalletFromSim:V}=await ee(async()=>{const{merchantWalletService:ne,detectWalletFromSim:be}=await Promise.resolve().then(()=>Oi);return{merchantWalletService:ne,detectWalletFromSim:be}},void 0,import.meta.url),Z=(r==null?void 0:r.uid)||"";if(!Z)return;const q=`wallets_${Z}`,oe=typeof localStorage<"u"?localStorage.getItem(q):null,H=oe?JSON.parse(oe):[],Pe=await U.getByMerchantId(Z),it=[...(Array.isArray(H)?H:[]).map(ne=>({id:String((ne==null?void 0:ne.id)||""),phone:String((ne==null?void 0:ne.phone)||(ne==null?void 0:ne.msisdn)||""),isDefault:!!(ne!=null&&ne.isDefault)})),...(Array.isArray(Pe)?Pe:[]).map(ne=>({id:String((ne==null?void 0:ne.id)||""),msisdn:String((ne==null?void 0:ne.msisdn)||""),isDefault:!!(ne!=null&&ne.isDefault)}))],te=await V(j||[],it);if(te&&te.walletId)try{localStorage.setItem(`selectedWallet_${Z}`,te.walletId)}catch{}}catch{}};y.useEffect(()=>{const j=async U=>{var V,Z,q,oe,H,Pe,it;try{const te=(U==null?void 0:U.detail)||{};if(te.isPending){console.log("Skipping pending transaction in main listener (delegated to PendingTransactionsDialog)",te);return}const ne=String(te.text||"").trim(),be=String(te.title||"").trim();if(!ne)return;if(!/vodafone|vf\-?cash|||\s*[]?\s*|\s*|\s*|instapay|received\s*egp|transaction|etisalat|e&|money|/i.test(`${be} ${ne}`)){try{eg(te,{toast:u})}catch{}return}const Qe={...te,slot:te.simSlot,sender:te.sender||te.senderMsisdn};window.dispatchEvent(new CustomEvent("vfCashTransactionDetected",{detail:Qe}));return;if(!ht){try{u({title:"  ",description:"   "})}catch{}return}if(!Re)try{const{doc:xt,getDoc:vt}=await ee(async()=>{const{doc:lt,getDoc:De}=await Promise.resolve().then(()=>kn);return{doc:lt,getDoc:De}},void 0,import.meta.url),{db:ln}=await ee(async()=>{const{db:lt}=await Promise.resolve().then(()=>En);return{db:lt}},void 0,import.meta.url),He=await vt(xt(ln,"profiles",ht));if(He.exists()){const lt=He.data(),De=String((lt==null?void 0:lt.shopId)||"").trim();De&&(Re=De)}}catch{}try{const xt=ht||"default";ot=(localStorage.getItem(`sim1Number_${xt}`)??localStorage.getItem("sim1Number")??"").trim(),Bt=(localStorage.getItem(`sim2Number_${xt}`)??localStorage.getItem("sim2Number")??"").trim();const vt=localStorage.getItem(`smsAutoRegisterEnabled_${xt}`)??localStorage.getItem("smsAutoRegisterEnabled"),ln=((q=fe.current)==null?void 0:q.smsAutoRegisterEnabled)===!0;It=vt==="true"||ln}catch{}try{const xt=((oe=fe.current)==null?void 0:oe.smsReadingEnabled)!==void 0?!!fe.current.smsReadingEnabled:localStorage.getItem("smsReadingEnabled")==="true",vt=localStorage.getItem("adbSmsReadingEnabled")==="true";if(!xt&&!vt&&!It)return}catch{}try{const{Preferences:xt}=await ee(async()=>{const{Preferences:He}=await Promise.resolve().then(()=>up);return{Preferences:He}},void 0,import.meta.url),vt=await xt.get({key:"sim1_number"}),ln=await xt.get({key:"sim2_number"});!ot&&(vt!=null&&vt.value)&&(ot=String(vt.value).trim()),!Bt&&(ln!=null&&ln.value)&&(Bt=String(ln.value).trim()),!ot&&je.current&&(ot=je.current),!Bt&&W.current&&(Bt=W.current)}catch{}try{localStorage.setItem("lastActiveSimMsisdns",JSON.stringify(ut))}catch{}try{if(!Me){const xt=localStorage.getItem("lastSmsSimMsisdn")||"";xt&&ut.includes(xt)&&(Me=xt)}}catch{}if(Me)try{localStorage.setItem("lastSmsSimMsisdn",Me)}catch{}if(!Pn||Pn<=0){try{eg(te,{toast:u})}catch{}return}if(Mt.type==="transfer")try{await yt({...an,reference:on,walletMsisdn:ft})}catch{}else{const xt=It;try{const{addDoc:vt,collection:ln,serverTimestamp:He}=await ee(async()=>{const{addDoc:Ue,collection:se,serverTimestamp:nt}=await Promise.resolve().then(()=>kn);return{addDoc:Ue,collection:se,serverTimestamp:nt}},void 0,import.meta.url),{db:lt}=await ee(async()=>{const{db:Ue}=await Promise.resolve().then(()=>En);return{db:Ue}},void 0,import.meta.url),De=await vt(ln(lt,"pendingSmsPopups"),{userId:ht,shopId:Re,payload:{...an,reference:on,walletMsisdn:ft,sim1Number:ot,sim2Number:Bt,autoConfirm:xt,autoConfirmDuration:Number(((H=fe.current)==null?void 0:H.smsAutoConfirmDuration)??5)},status:"pending",createdAt:He()}),tt=/Received\s*EGP/i.test(String(ne))?"InstaPay":/etisalat|e&|/i.test(String(ne))?"Etisalat Cash":"VF-Cash";qe({...an,reference:on,providerLabel:tt,walletMsisdn:ft,popupId:De.id,autoConfirm:xt,autoConfirmDuration:Number(((Pe=fe.current)==null?void 0:Pe.smsAutoConfirmDuration)??5),isLocal:!0})}catch{const vt=/Received\s*EGP/i.test(String(ne))?"InstaPay":/etisalat|e&|/i.test(String(ne))?"Etisalat Cash":"VF-Cash";qe({...an,reference:on,providerLabel:vt,walletMsisdn:ft,autoConfirm:xt,autoConfirmDuration:Number(((it=fe.current)==null?void 0:it.smsAutoConfirmDuration)??5),isLocal:!0})}ve(!0);try{we()}catch{}}}catch{try{eg((U==null?void 0:U.detail)||{},{toast:u})}catch{}}};try{window.addEventListener("vfNotificationReceived",j)}catch{}return()=>{try{window.removeEventListener("vfNotificationReceived",j)}catch{}}},[u,s]),y.useEffect(()=>{const j=window.electronAPI;j&&typeof j.onAdbSmsReceived=="function"&&j.onAdbSmsReceived(U=>{const V={sender:U.sender,text:U.text,msisdn:U.sender,deviceId:U.deviceId,timestamp:Date.now()};window.dispatchEvent(new CustomEvent("mobileSmsReceived",{detail:V}))})},[]),y.useEffect(()=>{const j=async U=>{try{const V=(U==null?void 0:U.detail)||{},Z=String(V.text||"");if(!Z)return;const q=(n==null?void 0:n.smsReadingEnabled)!==void 0?!!n.smsReadingEnabled:localStorage.getItem("smsReadingEnabled")==="true",oe=localStorage.getItem("adbSmsReadingEnabled")==="true",H=(r==null?void 0:r.uid)||"",Pe=H?`smsAutoRegisterEnabled_${H}`:"smsAutoRegisterEnabled",te=(localStorage.getItem(Pe)??localStorage.getItem("smsAutoRegisterEnabled"))==="true"||(n==null?void 0:n.smsAutoRegisterEnabled)===!0;if(!q&&!oe&&!te)return;const ne=/Received\s*EGP/i.test(Z),be=/etisalat|e&|/i.test(Z),ze=Ete(Z,String(V.sender||V.msisdn||"")),Qe=/(?:\s*?\s*|?\s*|\s*|Deposit|\s*|\s*)/i.test(Z);if(!ne&&!ze&&!be&&!Qe||!H)return;let mt=s||(n==null?void 0:n.shopId)||localStorage.getItem("shopId")||"";const ht=fe.current;let Re=(ht==null?void 0:ht.sim1Number)||"",ot=(ht==null?void 0:ht.sim2Number)||"";Re||(Re=localStorage.getItem(`sim1Number_${userId}`)||localStorage.getItem("sim1Number")||""),ot||(ot=localStorage.getItem(`sim2Number_${userId}`)||localStorage.getItem("sim2Number")||""),!Re&&je.current&&(Re=je.current),!ot&&W.current&&(ot=W.current),Re=String(Re).trim(),ot=String(ot).trim();const Bt=String(V.msisdn||V.sender||""),It=ce(Bt),ut=Ou(Z);let Pt=Number(ut.amount||0),Me=ut.sender||It||String(V.sender||""),un=ut.senderName,Mt=ut.reference||"";if(ne){const Ue=String(Z).match(/Received\s*EGP\s*([0-9.,]+)/i)||String(Z).match(/Received\s*EGP([0-9.,]+)/i);Ue&&(Pt=parseFloat(String(Ue[1]).replace(/,/g,"")));const se=String(Z).match(/from\s+([0-9+]+)/i);se&&(Me=ce(se[1]));const nt=String(Z).match(/Ref:\s*([A-Za-z0-9\-]+)/i);nt&&(Mt=String(nt[1]).trim())}const Pn=ut.receiverAccountTail;if(!Pt||Pt<=0)return;let ft="",Yt="";const on=[Re,ot].filter(Boolean).map(Ue=>ce(Ue));if(It&&on.includes(It)&&(ft=It,ft===ce(Re)?Yt="SIM 1":ft===ce(ot)&&(Yt="SIM 2")),(V==null?void 0:V.slot)!==void 0&&(V==null?void 0:V.slot)!==null){const Ue=Number(V.slot),se=Ge.current||[];if(Ue===0){if(Yt="SIM 1",Re)ft=ce(Re);else if(se.length>0){const nt=ot?ce(ot):"",_t=se.find(zt=>ce(zt.phoneNumber)!==nt);_t&&(ft=ce(_t.phoneNumber))}}else if(Ue===1){if(Yt="SIM 2",ot)ft=ce(ot);else if(se.length>0){const nt=Re?ce(Re):"",_t=se.find(zt=>ce(zt.phoneNumber)!==nt);if(se.length>1){const zt=se[1];ft=ce(zt.phoneNumber)}else _t&&(ft=ce(_t.phoneNumber))}}}!Yt&&ft&&(ft===ce(Re)?Yt="SIM 1":ft===ce(ot)&&(Yt="SIM 2"));const an=ne?"InstaPay":be?"Etisalat Cash":"VF-Cash",xt=String(V.sender||V.msisdn||""),vt=/VF-Cash|Vodafone|Etisalat|e&|InstaPay/i.test(xt),ln=/Received\s*EGP/i.test(Z)&&/Ref:/i.test(Z),He=!vt&&!ln,lt={amount:Pt,sender:Me,senderName:un,text:Z,simNumber:ft,simLabel:Yt,lineId:V==null?void 0:V.slot,isFakeSender:He,type:ut.type},De=localStorage.getItem("autoTransferRecord")==="true",tt=!He&&(te||ut.type==="transfer"&&De);if(!tt)if(qe({...lt,reference:Mt,providerLabel:an,walletMsisdn:ft}),ve(!0),He)try{le()}catch{}else try{we()}catch{}(async()=>{var Ue;try{const{resolveWalletBySimOrSlot:se,bindSlotWalletMapping:nt,merchantWalletService:_t}=await ee(async()=>{const{resolveWalletBySimOrSlot:Be,bindSlotWalletMapping:In,merchantWalletService:Vt}=await Promise.resolve().then(()=>Oi);return{resolveWalletBySimOrSlot:Be,bindSlotWalletMapping:In,merchantWalletService:Vt}},void 0,import.meta.url);let zt=Array.isArray(V.activeSimMsisdns)&&V.activeSimMsisdns.length>0?V.activeSimMsisdns.map(Be=>ce(String(Be||""))):It?[It]:[];zt.length===0&&(zt=[ce(Re),ce(ot)].filter(Boolean));let dn=await se({simNumbers:zt,subId:Number((V==null?void 0:V.subId)||-1),slotIndex:Number((V==null?void 0:V.slot)||-1),userId:H});if(!dn&&zt.length>0){try{await st(zt)}catch{}const Be=localStorage.getItem(`selectedWallet_${H}`)||"";if(Be)try{const In=await _t.getById(Be),Vt=String((In==null?void 0:In.msisdn)||"");(!ft||ce(Vt)===ce(ft))&&(dn={walletId:Be,msisdn:Vt})}catch{}}if(dn&&dn.walletId){try{localStorage.setItem(`selectedWallet_${H}`,dn.walletId)}catch{}try{nt({userId:H,subId:Number((V==null?void 0:V.subId)||-1),slotIndex:Number((V==null?void 0:V.slot)||-1),walletId:dn.walletId,msisdn:dn.msisdn})}catch{}}const Jt=(dn==null?void 0:dn.msisdn)||ft||(H?await a_(H):"");if(qe(Be=>Be?{...Be,walletMsisdn:(dn==null?void 0:dn.msisdn)||ft,simNumber:ft,simLabel:Yt||Be.simLabel}:null),tt)try{await yt({...lt,reference:Mt,walletMsisdn:Jt,walletId:dn==null?void 0:dn.walletId,sim1Number:Re,sim2Number:ot})}catch(Be){console.error("Auto-register failed",Be)}else try{const{addDoc:Be,collection:In,serverTimestamp:Vt}=await ee(async()=>{const{addDoc:Xe,collection:Kt,serverTimestamp:wt}=await Promise.resolve().then(()=>kn);return{addDoc:Xe,collection:Kt,serverTimestamp:wt}},void 0,import.meta.url),{db:Xt}=await ee(async()=>{const{db:Xe}=await Promise.resolve().then(()=>En);return{db:Xe}},void 0,import.meta.url),nr=await Be(In(Xt,"pendingSmsPopups"),{userId:H,shopId:mt,payload:{...lt,reference:Mt,walletMsisdn:Jt,sim1Number:Re,sim2Number:ot,autoConfirm:!1,autoConfirmDuration:Number(((Ue=fe.current)==null?void 0:Ue.smsAutoConfirmDuration)??5)},status:"pending",createdAt:Vt()});qe(Xe=>{var wt;return{...Xe||{...lt,reference:Mt,walletMsisdn:Jt},popupId:nr.id,autoConfirm:!1,autoConfirmDuration:Number(((wt=fe.current)==null?void 0:wt.smsAutoConfirmDuration)??5),isLocal:!0}}),ve(!0)}catch(Be){console.error("Error creating pending popup",Be),qe(In=>{var Xt;return{...In||{...lt,reference:Mt,walletMsisdn:Jt},autoConfirm:!1,autoConfirmDuration:Number(((Xt=fe.current)==null?void 0:Xt.smsAutoConfirmDuration)??5),isLocal:!0}}),ve(!0)}}catch(se){console.error("Background SMS processing error",se)}})()}catch(V){console.error("SMS Handler Error",V)}};try{window.addEventListener("mobileSmsReceived",j)}catch{}return()=>{try{window.removeEventListener("mobileSmsReceived",j)}catch{}}},[u,s,n,r]),y.useEffect(()=>{const j=async U=>{var V,Z,q,oe;try{const H=(U==null?void 0:U.detail)||{},Pe=Number(H.amount||0),it=String(H.sender||H.senderMsisdn||""),te=Array.isArray(H.activeSimMsisdns)?H.activeSimMsisdns.map(He=>String(He||"")):[];try{console.log("VF Auto SMS  activeSimMsisdns",te)}catch{}const ne=String(H.text||""),be=Pe,{auth:ze}=await ee(async()=>{const{auth:He}=await Promise.resolve().then(()=>En);return{auth:He}},void 0,import.meta.url),Qe=((V=ze.currentUser)==null?void 0:V.uid)||"";let mt=s||"";if(!Qe)try{u({title:"  ",description:"   "})}catch{}if(!mt)try{const{doc:He,getDoc:lt}=await ee(async()=>{const{doc:Ue,getDoc:se}=await Promise.resolve().then(()=>kn);return{doc:Ue,getDoc:se}},void 0,import.meta.url),{db:De}=await ee(async()=>{const{db:Ue}=await Promise.resolve().then(()=>En);return{db:Ue}},void 0,import.meta.url),tt=await lt(He(De,"profiles",Qe));if(tt.exists()){const Ue=tt.data(),se=String((Ue==null?void 0:Ue.shopId)||"").trim();se&&(mt=se)}}catch{}if(!mt)try{u({title:"  ",description:"   "})}catch{}try{const{doc:He,getDoc:lt}=await ee(async()=>{const{doc:Ue,getDoc:se}=await Promise.resolve().then(()=>kn);return{doc:Ue,getDoc:se}},void 0,import.meta.url),{db:De}=await ee(async()=>{const{db:Ue}=await Promise.resolve().then(()=>En);return{db:Ue}},void 0,import.meta.url);sim1=localStorage.getItem(`sim1Number_${Qe}`)||localStorage.getItem("sim1Number")||"",sim2=localStorage.getItem(`sim2Number_${Qe}`)||localStorage.getItem("sim2Number")||"",!sim1&&je.current&&(sim1=je.current),!sim2&&W.current&&(sim2=W.current);const tt=fe.current;if(tt)smsEnabled=(tt==null?void 0:tt.smsReadingEnabled)!==void 0?!!tt.smsReadingEnabled:!1,smsAutoRegister=(tt==null?void 0:tt.smsAutoRegisterEnabled)===!0;else try{const Ue=await lt(He(De,"profiles",Qe));if(Ue.exists()){const se=Ue.data();smsEnabled=(se==null?void 0:se.smsReadingEnabled)!==void 0?!!se.smsReadingEnabled:!1,smsAutoRegister=(se==null?void 0:se.smsAutoRegisterEnabled)===!0}}catch{}}catch{}try{if(!sim1){const He=localStorage.getItem(`sim1Number_${Qe}`)??localStorage.getItem("sim1Number");He&&(sim1=String(He).trim())}if(!sim2){const He=localStorage.getItem(`sim2Number_${Qe}`)??localStorage.getItem("sim2Number");He&&(sim2=String(He).trim())}}catch{}try{const{Preferences:He}=await ee(async()=>{const{Preferences:lt}=await Promise.resolve().then(()=>up);return{Preferences:lt}},void 0,import.meta.url);if(!sim1){const lt=await He.get({key:"sim1_number"});lt!=null&&lt.value&&(sim1=String(lt.value).trim())}if(!sim2){const lt=await He.get({key:"sim2_number"});lt!=null&&lt.value&&(sim2=String(lt.value).trim())}}catch{}const ht=smsEnabled,Re=String((H==null?void 0:H.simNumber)||""),ot=ce(Re);let Bt=Array.isArray(te)&&te.length>0?te.map(He=>ce(String(He||""))):ot?[ot]:[];Bt.length===0&&(Bt=[ce(sim1),ce(sim2)].filter(Boolean));try{localStorage.setItem("lastActiveSimMsisdns",JSON.stringify(Bt))}catch{}let It="",ut="";const Pt=[sim1,sim2].filter(Boolean).map(He=>ce(He)),Me=ce(Re);if(Me&&Pt.includes(Me))It=Me,It===ce(sim1)?ut="SIM 1":It===ce(sim2)&&(ut="SIM 2");else{const He=(H==null?void 0:H.slot)!==void 0?H.slot:(H==null?void 0:H.subId)||-1,lt=Number(He);lt===0?(ut="SIM 1",It=sim1?ce(sim1):""):lt===1?(ut="SIM 2",It=sim2?ce(sim2):""):(It=ce(Bt[0]||sim1||sim2||""),It===ce(sim1)?ut="SIM 1":It===ce(sim2)&&(ut="SIM 2"))}if(It)try{localStorage.setItem("lastSmsSimMsisdn",It)}catch{}const{resolveWalletBySimOrSlot:un,bindSlotWalletMapping:Mt,merchantWalletService:Pn}=await ee(async()=>{const{resolveWalletBySimOrSlot:He,bindSlotWalletMapping:lt,merchantWalletService:De}=await Promise.resolve().then(()=>Oi);return{resolveWalletBySimOrSlot:He,bindSlotWalletMapping:lt,merchantWalletService:De}},void 0,import.meta.url),ft=Qe;let on=await un({simNumbers:It?[It]:Bt,userId:ft});if(!on&&Bt.length>0){try{await st(Bt)}catch{}const He=localStorage.getItem(`selectedWallet_${ft}`)||"";if(He)try{const lt=await Pn.getById(He),De=String((lt==null?void 0:lt.msisdn)||"");(!It||ce(De)===ce(It))&&(on={walletId:He,msisdn:De})}catch{}}if(on&&on.walletId){try{localStorage.setItem(`selectedWallet_${ft}`,on.walletId)}catch{}try{Mt({userId:ft,walletId:on.walletId,msisdn:on.msisdn})}catch{}}const an=String(H.reference||H.txnRefNumber||""),xt=(on==null?void 0:on.msisdn)||It||(Qe?await a_(Qe):"");let vt=it;try{const He=Ou(ne);(/[a-z\u0600-\u06FF]/i.test(vt)||!vt||vt.length<5)&&He.sender&&(vt=He.sender)}catch{}const ln={amount:be,sender:vt,senderName:String(H.senderName||""),text:ne,simNumber:It,simLabel:ut,type:H.type};if(smsAutoRegister)try{await yt({...ln,reference:an,walletMsisdn:xt,walletId:on==null?void 0:on.walletId,sim1Number:sim1,sim2Number:sim2,autoConfirm:!0});try{we()}catch{}return}catch(He){console.error("Auto-register failed",He)}try{const{addDoc:He,collection:lt,serverTimestamp:De}=await ee(async()=>{const{addDoc:nt,collection:_t,serverTimestamp:zt}=await Promise.resolve().then(()=>kn);return{addDoc:nt,collection:_t,serverTimestamp:zt}},void 0,import.meta.url),{db:tt}=await ee(async()=>{const{db:nt}=await Promise.resolve().then(()=>En);return{db:nt}},void 0,import.meta.url),Ue=await He(lt(tt,"pendingSmsPopups"),{userId:Qe,shopId:mt,payload:{...ln,reference:an,walletMsisdn:xt,sim1Number:sim1,sim2Number:sim2,autoConfirmDuration:Number(((Z=fe.current)==null?void 0:Z.smsAutoConfirmDuration)??5)},status:"pending",createdAt:De()});let se="VF-Cash";/Received\s*EGP/i.test(String(ne))?se="InstaPay":(/etisalat|e&|/i.test(String(ne))||/etisalat|e&|/i.test(String(ln.sender||"")))&&(se="Etisalat Cash"),qe({...ln,reference:an,providerLabel:se,walletMsisdn:xt,popupId:Ue.id,autoConfirmDuration:Number(((q=fe.current)==null?void 0:q.smsAutoConfirmDuration)??5)})}catch{let He="VF-Cash";/Received\s*EGP/i.test(String(ne))?He="InstaPay":(/etisalat|e&|/i.test(String(ne))||/etisalat|e&|/i.test(String(ln.sender||"")))&&(He="Etisalat Cash"),qe({...ln,reference:an,providerLabel:He,walletMsisdn:xt,autoConfirmDuration:Number(((oe=fe.current)==null?void 0:oe.smsAutoConfirmDuration)??5)})}ve(!0);try{we()}catch{}}catch{}};try{window.addEventListener("vfCashTransactionDetected",j)}catch{}return()=>{try{window.removeEventListener("vfCashTransactionDetected",j)}catch{}}},[u,s]),y.useEffect(()=>{},[u,s]);const yt=async j=>{var U,V,Z;try{const q=j||Q;if(!q)return;try{console.log("handleConfirmSmsRegister ",{simLabel:q.simLabel,simNumber:q.simNumber,slot:q.simSlot})}catch{}const{amount:oe,sender:H,text:Pe,simNumber:it,senderName:te}=q,ne=String(Pe||"");let be=Number(oe||0);const ze=typeof(j==null?void 0:j.deferredMode)=="boolean"?j.deferredMode:Nr,Qe=(j==null?void 0:j.debtorName)??Dr,mt=(j==null?void 0:j.debtorNote)??ue;try{ve(!1)}catch{}try{}catch{}const ht=/InstaPay|Received\s*EGP|You\s*have\s*received/i.test(ne)?"instapay":"vodafone_cash";if(!be||be<=0){const De=ne.match(/\s+(\d+(?:[\.,]\d+)?)\s*/i);if(De&&(be=parseFloat(String(De[1]).replace(",","."))),!be||be<=0){const tt=ne.match(/Received\s*EGP\s*([0-9.,]+)/i)||ne.match(/Received\s*EGP([0-9.,]+)/i)||ne.match(/amount\s*([0-9.,]+)\s*EGP/i)||ne.match(/received\s*([0-9.,]+)\s*EGP/i);tt&&(be=parseFloat(String(tt[1]).replace(/,/g,"")))}}let Re=String(H||"").trim();if(!Re){const De=ne.match(/\s+\s+(\d+)/i);if(Re=De?ce(De[1]):"",!Re){const tt=ne.match(/from\s+([0-9+]+)/i);tt&&(Re=ce(tt[1]))}}let ot=String((q==null?void 0:q.reference)||"").trim();if(!ot){const De=ne.match(/\s*\s*([\d\.]+)/i);if(De)ot=String(De[1]).trim();else{const tt=ne.match(/(?:Ref:|Ref)\s*([A-Za-z0-9\-]+)/i);tt?ot=String(tt[1]).trim():ot=String(Date.now())}}let Bt=String((q==null?void 0:q.walletMsisdn)||"").trim();if(!be||be<=0){try{u({title:"      ",variant:"destructive"})}catch{}return}const{auth:It}=await ee(async()=>{const{auth:De}=await Promise.resolve().then(()=>En);return{auth:De}},void 0,import.meta.url),ut=((U=It.currentUser)==null?void 0:U.uid)||"";let Pt=s||"";if(!ut){try{u({title:"  ",description:"   "})}catch{}return}if(!Pt)try{const{doc:De,getDoc:tt}=await ee(async()=>{const{doc:nt,getDoc:_t}=await Promise.resolve().then(()=>kn);return{doc:nt,getDoc:_t}},void 0,import.meta.url),{db:Ue}=await ee(async()=>{const{db:nt}=await Promise.resolve().then(()=>En);return{db:nt}},void 0,import.meta.url),se=await tt(De(Ue,"profiles",ut));if(se.exists()){const nt=se.data(),_t=String((nt==null?void 0:nt.shopId)||"").trim();_t&&(Pt=_t)}}catch{}if(!Pt){try{u({title:"  ",description:"   "})}catch{}return}let Me=(j==null?void 0:j.walletId)||"";if(!Me)try{const{resolveWalletBySimOrSlot:De}=await ee(async()=>{const{resolveWalletBySimOrSlot:nt}=await Promise.resolve().then(()=>Oi);return{resolveWalletBySimOrSlot:nt}},void 0,import.meta.url),tt=q==null?void 0:q.simLabel;let Ue=-1;(q==null?void 0:q.simSlot)!==void 0&&(q==null?void 0:q.simSlot)!==-1?Ue=Number(q.simSlot):Ue=tt==="SIM 1"?0:tt==="SIM 2"?1:-1;const se=await De({simNumbers:it?[it]:[],userId:ut,slotIndex:Ue});se&&se.walletId&&(Me=se.walletId)}catch{}if(!Me&&it)try{const{detectWalletFromSim:De}=await ee(async()=>{const{detectWalletFromSim:Be}=await Promise.resolve().then(()=>Oi);return{detectWalletFromSim:Be}},void 0,import.meta.url),{merchantWalletService:tt}=await ee(async()=>{const{merchantWalletService:Be}=await Promise.resolve().then(()=>mo);return{merchantWalletService:Be}},void 0,import.meta.url),Ue=await tt.getByMerchantId(ut),se=localStorage.getItem(`wallets_${ut}`),nt=se?JSON.parse(se):[],_t=(Array.isArray(nt)?nt:[]).map(Be=>({id:String((Be==null?void 0:Be.id)||""),phone:String((Be==null?void 0:Be.phone)||(Be==null?void 0:Be.msisdn)||""),isDefault:!!(Be!=null&&Be.isDefault)})),zt=(Array.isArray(Ue)?Ue:[]).map(Be=>({id:String((Be==null?void 0:Be.id)||""),msisdn:String((Be==null?void 0:Be.msisdn)||""),isDefault:!!(Be!=null&&Be.isDefault)})),dn=[..._t,...zt],Jt=await De([it],dn);Jt&&Jt.walletId&&(Me=Jt.walletId)}catch{}if(Me||(Me=await rR(ut)),!Me)try{const{doc:De,getDoc:tt}=await ee(async()=>{const{doc:Xe,getDoc:Kt}=await Promise.resolve().then(()=>kn);return{doc:Xe,getDoc:Kt}},void 0,import.meta.url),{db:Ue}=await ee(async()=>{const{db:Xe}=await Promise.resolve().then(()=>En);return{db:Xe}},void 0,import.meta.url);let se="",nt="";try{const Xe=await tt(De(Ue,"profiles",ut));if(Xe.exists()){const Kt=Xe.data();se=String((Kt==null?void 0:Kt.sim1Number)||"").trim(),nt=String((Kt==null?void 0:Kt.sim2Number)||"").trim()}}catch{}const{detectWalletFromSim:_t}=await ee(async()=>{const{detectWalletFromSim:Xe}=await Promise.resolve().then(()=>Oi);return{detectWalletFromSim:Xe}},void 0,import.meta.url),{merchantWalletService:zt}=await ee(async()=>{const{merchantWalletService:Xe}=await Promise.resolve().then(()=>mo);return{merchantWalletService:Xe}},void 0,import.meta.url),dn=`wallets_${ut}`,Jt=localStorage.getItem(dn),Be=Jt?JSON.parse(Jt):[],In=await zt.getByMerchantId(ut),Vt=(Array.isArray(Be)?Be:[]).map(Xe=>({id:String((Xe==null?void 0:Xe.id)||""),phone:String((Xe==null?void 0:Xe.phone)||(Xe==null?void 0:Xe.msisdn)||""),isDefault:!!(Xe!=null&&Xe.isDefault)})),Xt=(Array.isArray(In)?In:[]).map(Xe=>({id:String((Xe==null?void 0:Xe.id)||""),msisdn:String((Xe==null?void 0:Xe.msisdn)||""),isDefault:!!(Xe!=null&&Xe.isDefault)})),nr=[...Vt,...Xt];if(nr.length>0)Me=nr[0].id;else{const Xe=it||String(localStorage.getItem("lastSmsSimMsisdn")||"");let Kt=(Xe?[Xe]:[]).filter(Boolean);Kt.length===0&&(Kt=[se,nt].filter(Boolean));const wt=await _t(Kt,nr);if(wt&&wt.walletId){Me=wt.walletId;try{localStorage.setItem(`selectedWallet_${ut}`,Me)}catch{}}}}catch{}if(!Me){try{u({title:"   ",description:"       "})}catch{}return}try{const De=ut;try{localStorage.setItem(`selectedWallet_${De}`,Me)}catch{}try{localStorage.setItem(`selectedWallet_${De}_${Pt}`,Me)}catch{}if(Me)try{window.dispatchEvent(new CustomEvent("walletSelection:update",{detail:{walletId:Me}}))}catch{}try{const{Preferences:tt}=await ee(async()=>{const{Preferences:Ue}=await Promise.resolve().then(()=>up);return{Preferences:Ue}},void 0,import.meta.url);await tt.set({key:"selected_wallet_id",value:Me}),await tt.set({key:"current_user_id",value:De})}catch{}}catch{}const{recordAutoTransaction:un,userDataService:Mt}=await ee(async()=>{const{recordAutoTransaction:De,userDataService:tt}=await Promise.resolve().then(()=>mo);return{recordAutoTransaction:De,userDataService:tt}},void 0,import.meta.url),Pn=cn&&cn.trim()!==""?Math.max(0,parseFloat(cn)):null;let ft=0;if(Pn!=null)ft=Pn;else try{const{merchantWalletService:De}=await ee(async()=>{const{merchantWalletService:se}=await Promise.resolve().then(()=>mo);return{merchantWalletService:se}},void 0,import.meta.url),tt=await De.getById(String(Me)),Ue=tt&&tt.defaultWithdrawCommission;if(Ue!=null)ft=Math.round((Number(Ue)||0)*Number(be)/1e3*100)/100;else{const{calculateCommission:se}=await ee(async()=>{const{calculateCommission:nt}=await Promise.resolve().then(()=>To);return{calculateCommission:nt}},void 0,import.meta.url);ft=se(Number(be),"receive")}}catch{const{calculateCommission:De}=await ee(async()=>{const{calculateCommission:tt}=await Promise.resolve().then(()=>To);return{calculateCommission:tt}},void 0,import.meta.url);ft=De(Number(be),"receive")}try{const{walletDailyLimitsService:De}=await ee(async()=>{const{walletDailyLimitsService:Ue}=await Promise.resolve().then(()=>Bf);return{walletDailyLimitsService:Ue}},void 0,import.meta.url),tt=await De.canPerformOperation(String(Me),Math.max(0,Number(be||0)),"withdraw");if(!tt.canPerform)try{u({title:"  ",description:String(tt.message||"      "),variant:"destructive"})}catch{}}catch{}const Yt=ot||`${ne}|${Date.now()}`,on=it||String(localStorage.getItem("lastSmsSimMsisdn")||""),an=Bt||on||await a_(ut)||"",xt=(localStorage.getItem("commissionMode")||"").toLowerCase()==="add"?"add":"deduct";if(ze)try{const De=await Mt.getUserData(ut),tt=Array.isArray(De==null?void 0:De.debts)?De.debts:[],Ue=xt==="add"?Number(be)+Number(ft):Number(be),se={id:`DEBT-${Date.now()}`,debtorName:Qe||te||Re||"",amount:Math.round(Number(Ue)*100)/100,reason:mt||"  VodafoneCash",customerId:void 0,mobile:Re,status:"pending",createdAt:new Date},nt=[se,...tt];await Mt.updateUserData(ut,{debts:nt});try{const _t=ft;await Mt.saveUserTransaction(ut,{type:"withdraw",amount:be,withdrawnAmount:be,commission:_t,status:"pending",createdAt:new Date,senderMsisdn:Re,receiverMsisdn:an,senderName:te,walletId:Me,fromWallet:Me,lineId:an,provider:ht,reference:Yt,transactionId:`DEFER-${Date.now()}`,linkedDebtId:se.id})}catch{}try{const _t=(j==null?void 0:j.popupId)||(Q==null?void 0:Q.popupId)||"";if(_t){const{doc:zt,updateDoc:dn,serverTimestamp:Jt}=await ee(async()=>{const{doc:In,updateDoc:Vt,serverTimestamp:Xt}=await Promise.resolve().then(()=>kn);return{doc:In,updateDoc:Vt,serverTimestamp:Xt}},void 0,import.meta.url),{db:Be}=await ee(async()=>{const{db:In}=await Promise.resolve().then(()=>En);return{db:In}},void 0,import.meta.url);try{await dn(zt(Be,"pendingSmsPopups",_t),{status:"confirmed",confirmedAt:Jt()})}catch{}try{(Z=(V=G.current)==null?void 0:V.add)==null||Z.call(V,_t);const In=Array.from(G.current||[]);localStorage.setItem("sms_suppressed_ids",JSON.stringify(In))}catch{}}}catch{}try{u({title:"  ",description:"      "})}catch{}return}catch{}ve(!1),qe(null);const vt=(q==null?void 0:q.type)==="transfer"?"send":"withdraw";try{u({title:vt==="send"?"  ...":"  ..."})}catch{}const ln=`TX-${Date.now()}`,He=Math.max(0,Number(be||0)),lt=Math.max(0,ft);try{const De=`cashBalance_${ut}_${Pt||"main"}`,tt=`walletBalances_${ut}_${Pt||"main"}`,Ue=localStorage.getItem(De),se=localStorage.getItem(tt);let nt=Ue?parseFloat(Ue):0,_t=se?JSON.parse(se):{};vt==="send"?(_t[Me]=(Number(_t[Me])||0)-He,nt=nt+He+lt):(_t[Me]=(Number(_t[Me])||0)+He,nt=nt-He+lt);const zt={id:ln,type:vt,senderPhone:vt==="send"?an:Re,receiverPhone:vt==="send"?Re:an,amount:be,status:"completed",createdAt:new Date,withdrawnAmount:be,commission:lt,fromWallet:Me,senderName:te,provider:ht,reference:Yt,shopName:"  ()"};window.dispatchEvent(new CustomEvent("dashboard:external-update",{detail:{delta:{amount:He,commission:lt,walletId:Me,type:vt}}}))}catch(De){console.error("Optimistic update failed",De)}(async()=>{var tt,Ue,se,nt,_t,zt,dn;let De="";try{const{collection:Jt,query:Be,where:In,orderBy:Vt,limit:Xt,getDocs:nr,doc:Xe,updateDoc:Kt,serverTimestamp:wt}=await ee(async()=>{const{collection:Rn,query:Et,where:xs,orderBy:ni,limit:Br,getDocs:Ke,doc:hn,updateDoc:Vn,serverTimestamp:zr}=await Promise.resolve().then(()=>kn);return{collection:Rn,query:Et,where:xs,orderBy:ni,limit:Br,getDocs:Ke,doc:hn,updateDoc:Vn,serverTimestamp:zr}},void 0,import.meta.url),{db:ls}=await ee(async()=>{const{db:Rn}=await Promise.resolve().then(()=>En);return{db:Rn}},void 0,import.meta.url),ti=Be(Jt(ls,"transactions"),In("merchantUserId","==",ut),Vt("createdAt","desc"),Xt(12)),Jn=await nr(ti),Ts=Date.now();let cs=!1;for(const Rn of Jn.docs){const Et=Rn.data(),xs=Et!=null&&Et.createdAt&&typeof((tt=Et==null?void 0:Et.createdAt)==null?void 0:tt.toDate)=="function"?Et.createdAt.toDate().getTime():Et!=null&&Et.createdAt?new Date(String(Et.createdAt)).getTime():0,ni=Math.abs(Ts-xs)<=12e4,Br=Math.round(Number((Et==null?void 0:Et.amount)||0)*100)===Math.round(Number(be||0)*100),Ke=String((Et==null?void 0:Et.provider)||"").toLowerCase()===String(ht||"").toLowerCase(),hn=String(vt==="send"?(Et==null?void 0:Et.receiverMsisdn)||(Et==null?void 0:Et.receiverPhone)||"":(Et==null?void 0:Et.senderMsisdn)||(Et==null?void 0:Et.senderPhone)||""),Vn=ce(hn)===ce(Re);if(ni&&Br&&Vn&&Ke){cs=!0,De=Rn.id;break}}if(cs){const Rn=(j==null?void 0:j.popupId)||(Q==null?void 0:Q.popupId)||"";if(Rn){try{await Kt(Xe(ls,"pendingSmsPopups",Rn),{status:"confirmed",confirmedAt:wt()})}catch{}try{(se=(Ue=G.current)==null?void 0:Ue.add)==null||se.call(Ue,Rn);const Et=Array.from(G.current||[]);localStorage.setItem("sms_suppressed_ids",JSON.stringify(Et))}catch{}}}else{De=await un({shopId:Pt,lineId:an,walletId:Me,amount:be,note:"SMS-ManualConfirm",provider:ht,createdBy:ut,senderMsisdn:Re,senderName:te,reference:Yt,text:ne,txnType:vt==="send"?"send":"receive"});try{const Rn=(j==null?void 0:j.popupId)||(Q==null?void 0:Q.popupId)||"";if(Rn){try{await Kt(Xe(ls,"pendingSmsPopups",Rn),{status:"confirmed",confirmedAt:wt()})}catch{}try{(_t=(nt=G.current)==null?void 0:nt.add)==null||_t.call(nt,Rn);const Et=Array.from(G.current||[]);localStorage.setItem("sms_suppressed_ids",JSON.stringify(Et))}catch{}}}catch{}}}catch(Jt){console.error(Jt)}try{const{doc:Jt,getDoc:Be,updateDoc:In}=await ee(async()=>{const{doc:Jn,getDoc:Ts,updateDoc:cs}=await Promise.resolve().then(()=>kn);return{doc:Jn,getDoc:Ts,updateDoc:cs}},void 0,import.meta.url),{db:Vt}=await ee(async()=>{const{db:Jn}=await Promise.resolve().then(()=>En);return{db:Jn}},void 0,import.meta.url),Xt=Math.max(0,Number(be||0)),nr=Jt(Vt,"dashboardData",Pt),Xe=await Be(nr);let Kt=Xe.exists()?Number(((zt=Xe.data())==null?void 0:zt.cashBalance)||0):0;const wt=Xe.exists()?((dn=Xe.data())==null?void 0:dn.walletBalances)||{}:{},ls=Number(wt[Me]||0);(()=>{vt==="send"?(wt[Me]=ls-Xt,Kt=Kt+Xt+Math.max(0,ft)):(wt[Me]=ls+Xt,Kt=Kt-Xt+Math.max(0,ft))})(),await In(nr,{cashBalance:Kt,walletBalances:wt,lastUpdated:new Date().toISOString()});try{const Jn={id:De||`TX-${Date.now()}`,type:vt,senderPhone:vt==="send"?an:Re,receiverPhone:vt==="send"?Re:an,amount:be,status:"completed",createdAt:new Date,withdrawnAmount:be,commission:ft,fromWallet:Me,senderName:te,provider:ht,reference:Yt,shopName:" "};window.dispatchEvent(new CustomEvent("dashboard:external-update",{detail:{cashBalance:Kt,walletBalances:wt,newTransaction:Jn}}))}catch{}try{const{walletDailyLimitsService:Jn}=await ee(async()=>{const{walletDailyLimitsService:Ts}=await Promise.resolve().then(()=>Bf);return{walletDailyLimitsService:Ts}},void 0,import.meta.url);try{const{transactionServiceExtra:Ts}=await ee(async()=>{const{transactionServiceExtra:Ke}=await Promise.resolve().then(()=>mo);return{transactionServiceExtra:Ke}},void 0,import.meta.url),cs=await Ts.getMerchantTransactions(ut,50),Rn=Date.now(),Et=Ke=>String(Ke||"").replace(/\D/g,"").slice(-5),xs=Et(vt==="send"?Re||an:Re),ni=String(ht||"").toLowerCase();let Br=!1;for(const Ke of cs){const hn=Ke!=null&&Ke.createdAt?new Date(Ke.createdAt).getTime():0;if(Math.abs(Rn-hn)<=1e4){const Vn=Number((Ke==null?void 0:Ke.amount)||0)===Number(Xt||0),zr=String((Ke==null?void 0:Ke.provider)||"").toLowerCase()===ni,rr=Et((Ke==null?void 0:Ke.senderMsisdn)||(Ke==null?void 0:Ke.receiverMsisdn)||(Ke==null?void 0:Ke.senderPhone)||(Ke==null?void 0:Ke.receiverPhone));if(Vn&&zr&&rr&&xs&&rr===xs){Br=!0;break}}}Br||await Jn.updateUsage(String(Me),Xt,vt==="send"?"transfer":"withdraw",!0)}catch{await Jn.updateUsage(String(Me),Xt,vt==="send"?"transfer":"withdraw",!0)}try{window.dispatchEvent(new CustomEvent("walletLimitsUpdated",{detail:{walletId:String(Me)}}))}catch{}}catch{}}catch{}(async()=>{try{const Jt=ft;await Mt.saveUserTransaction(ut,{type:vt,amount:be,withdrawnAmount:be,commission:Jt,status:"completed",createdAt:new Date,senderMsisdn:vt==="send"?an:Re,receiverMsisdn:vt==="send"?Re:an,senderName:te,walletId:Me,fromWallet:Me,lineId:an,provider:ht,reference:Yt,transactionId:De||ln});try{window.dispatchEvent(new CustomEvent("transaction-created"))}catch{}}catch{}})(),Bl.invalidateQueries({queryKey:["dashboardData"]}),Bl.invalidateQueries({queryKey:["transactions"]}),Bl.invalidateQueries({queryKey:["walletDailyLimits"]}),Bl.invalidateQueries({queryKey:["wallets"]}),Bl.invalidateQueries({queryKey:["user-stats"]});try{const Jt=vt==="send"?`     ${De||ln}`:`     ${De||ln}`;u({title:Jt})}catch{}})()}catch(q){try{u({title:String((q==null?void 0:q.message)||"  "),variant:"destructive"})}catch{}}};y.useEffect(()=>{try{DP.start()}catch{}return()=>{try{DP.stop()}catch{}}},[]),y.useEffect(()=>{(async()=>{try{if(!(r!=null&&r.uid))return;const j=String(localStorage.getItem("android_last_ack_version_id")||"").trim(),U=String(localStorage.getItem("android_installed_version")||"").trim(),V=localStorage.getItem("android_last_ack_code"),Z=localStorage.getItem("android_installed_code"),q=V?Number(V):null,oe=Z?Number(Z):null,H=j||U,Pe=q??oe??null;H&&N(H),Pe&&L(Pe);const{doc:it,getDoc:te}=await ee(async()=>{const{doc:ze,getDoc:Qe}=await Promise.resolve().then(()=>kn);return{doc:ze,getDoc:Qe}},void 0,import.meta.url),{db:ne}=await ee(async()=>{const{db:ze}=await Promise.resolve().then(()=>En);return{db:ze}},void 0,import.meta.url),be=await te(it(ne,"profiles",r.uid));if(be.exists()){const ze=be.data(),Qe=String((ze==null?void 0:ze.lastAckAndroidVersion)||(ze==null?void 0:ze.androidInstalledVersion)||(ze==null?void 0:ze.lastAckUpdateId)||"").trim(),mt=typeof(ze==null?void 0:ze.lastAckAndroidCode)=="number"?ze.lastAckAndroidCode:typeof(ze==null?void 0:ze.androidInstalledCode)=="number"?ze.androidInstalledCode:null,ht=(ot,Bt)=>{const It=String(ot||"").replace(/^v/i,"").split(".").map(Pt=>parseInt(Pt,10)||0),ut=String(Bt||"").replace(/^v/i,"").split(".").map(Pt=>parseInt(Pt,10)||0);for(let Pt=0;Pt<Math.max(It.length,ut.length);Pt++){const Me=It[Pt]||0,un=ut[Pt]||0;if(Me>un)return 1;if(Me<un)return-1}return 0};let Re=!1;if(typeof mt=="number"&&typeof Pe=="number"?Re=mt>Pe:typeof mt=="number"&&Pe==null?Re=!0:Qe&&H?Re=ht(Qe,H)>0:Qe&&!H&&(Re=!0),Re){if(Qe){try{localStorage.setItem("android_installed_version",Qe)}catch{}N(Qe)}if(typeof mt=="number"){try{localStorage.setItem("android_installed_code",String(mt))}catch{}L(mt)}}else if(typeof mt=="number"&&Pe==null){try{localStorage.setItem("android_installed_code",String(mt))}catch{}L(mt)}}}catch{}})()},[r==null?void 0:r.uid]),y.useEffect(()=>{try{const U=String((window==null?void 0:window.__nativeAppVersion)||"").trim();U&&A(U);const V=window==null?void 0:window.__nativeAppVersionCode;if(typeof V=="number"){k(V);try{localStorage.setItem("android_installed_code",String(V))}catch{}}try{U&&localStorage.setItem("android_installed_version",U)}catch{}}catch{}const j=U=>{var V,Z;try{const q=String((((V=U==null?void 0:U.detail)==null?void 0:V.version)??"")||"").trim(),oe=(Z=U==null?void 0:U.detail)==null?void 0:Z.code;q&&A(q);try{q&&localStorage.setItem("android_installed_version",q)}catch{}typeof oe=="number"&&k(oe)}catch{}};try{window.addEventListener("native-app-version",j)}catch{}return()=>{try{window.removeEventListener("native-app-version",j)}catch{}}},[]),y.useEffect(()=>{try{const j=(ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android",U=String(I||"").trim();if(!j||!U||!(r!=null&&r.uid))return;(async()=>{try{const{doc:V,setDoc:Z,serverTimestamp:q}=await ee(async()=>{const{doc:H,setDoc:Pe,serverTimestamp:it}=await Promise.resolve().then(()=>kn);return{doc:H,setDoc:Pe,serverTimestamp:it}},void 0,import.meta.url),{db:oe}=await ee(async()=>{const{db:H}=await Promise.resolve().then(()=>En);return{db:H}},void 0,import.meta.url);await Z(V(oe,"profiles",r.uid),{androidInstalledVersion:U,androidInstalledAt:q()},{merge:!0});try{localStorage.setItem("android_installed_version",U)}catch{}}catch{}})()}catch{}},[I,r==null?void 0:r.uid]),y.useEffect(()=>{ge!=null&&ge.isNativePlatform&&ge.getPlatform()==="android"&&(async()=>{try{await ee(()=>import("./ProtectedUserDashboard-c6O-i0ck.js"),__vite__mapDeps([29,30,19]),import.meta.url),await ee(()=>import("./UserDashboardPage-XbIVMTiD.js").then(U=>U.U),__vite__mapDeps([66,57,15,54,53,45,40,50,27,7,39,8,2,49,33,32,44,42,30,18,26,11,28,22,38,1]),import.meta.url),await ee(()=>Promise.resolve().then(()=>mee),void 0,import.meta.url),await ee(()=>import("./ProfileSettingsPage-DnVs4YJB.js").then(U=>U.b),__vite__mapDeps([53,45,40,54,15,50,27,7,39,8,2]),import.meta.url),await ee(()=>import("./TransactionsPage-C1gBXxdf.js"),__vite__mapDeps([55,15,49,33,56,57,46,37,7,38,5,58,54,11,59,52,27,60,26,61,62,48,50,63,39,28,2,64]),import.meta.url)}catch{}})()},[]),y.useEffect(()=>{if(!t)return;const j=document.createElement("style");j.setAttribute("data-disable-pull-to-refresh","true"),j.textContent="html, body { overscroll-behavior-y: contain; touch-action: pan-y; }",document.head.appendChild(j);let U=0,V=null;const Z=oe=>{var H,Pe;U=((Pe=(H=oe.touches)==null?void 0:H[0])==null?void 0:Pe.clientY)||0,V=oe.target},q=oe=>{var ze,Qe;const H=((Qe=(ze=oe.touches)==null?void 0:ze[0])==null?void 0:Qe.clientY)||0,Pe=document.scrollingElement||document.documentElement,it=Pe.scrollTop||window.scrollY||0,te=Pe.scrollHeight-Pe.clientHeight||0,ne=V||null,be=(()=>{let mt=ne;for(;mt&&mt!==document.body;){const Re=window.getComputedStyle(mt).overflowY;if((Re==="auto"||Re==="scroll")&&mt.scrollHeight>mt.clientHeight)return!0;mt=mt.parentElement}return!1})();!be&&it<=0&&H>U&&oe.cancelable&&oe.preventDefault(),!be&&it>=te&&H<U&&oe.cancelable&&oe.preventDefault()};return document.addEventListener("touchstart",Z,{passive:!0}),document.addEventListener("touchmove",q,{passive:!1}),()=>{document.removeEventListener("touchstart",Z),document.removeEventListener("touchmove",q);try{document.head.removeChild(j)}catch{}}},[t]),y.useEffect(()=>{if(!((ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android"))return;try{const Z=(window.location.reload||(()=>{})).bind(window.location);window.__originalReload=Z,window.location.reload=()=>{try{window.dispatchEvent(new CustomEvent("app:softRefresh"))}catch{}}}catch{}try{const Z=(window.location.assign||(q=>{})).bind(window.location);window.__originalAssign=Z,window.location.assign=q=>{try{if(String(q||"").startsWith("/user/dashboard")){c("/user/dashboard");return}}catch{}try{Z(q)}catch{}}}catch{}let U=null,V=!1;return(async()=>{try{const{listenAndroidUpdates:Z}=await ee(async()=>{const{listenAndroidUpdates:q}=await Promise.resolve().then(()=>Cee);return{listenAndroidUpdates:q}},void 0,import.meta.url);U=Z(q=>{if(V)return;const oe=String((q==null?void 0:q.version)||"").trim(),H=String((q==null?void 0:q.url)||"").trim(),Pe=String((q==null?void 0:q.notes)||"").trim(),it=!!(q!=null&&q.force),te=typeof(q==null?void 0:q.code)=="number"?q.code:void 0,ne=String(localStorage.getItem("android_last_ack_version_id")||"").trim(),be=String(T||ne||"").trim(),ze=(un,Mt)=>{const Pn=String(un||"").replace(/^v/i,"").split(".").map(Yt=>parseInt(Yt,10)||0),ft=String(Mt||"").replace(/^v/i,"").split(".").map(Yt=>parseInt(Yt,10)||0);for(let Yt=0;Yt<Math.max(Pn.length,ft.length);Yt++){const on=Pn[Yt]||0,an=ft[Yt]||0;if(on>an)return 1;if(on<an)return-1}return 0},Qe=String(I||"").trim(),mt=String(localStorage.getItem("android_installed_version")||"").trim(),ht=localStorage.getItem("android_installed_code"),Re=ht?Number(ht):null,ot=[R,C,Re].filter(un=>typeof un=="number").reduce((un,Mt)=>un===void 0?Mt:Math.max(un,Mt),void 0),Bt=typeof te=="number"&&typeof ot=="number"?te>ot:void 0,It=(()=>{const un=[Qe,be,mt].filter(Boolean);return un.length===0?"":un.reduce((Mt,Pn)=>ze(Pn,Mt)>0?Pn:Mt)})(),ut=ze(oe,It)>0;if(!!H&&(!!oe||typeof te=="number")&&(Bt!==void 0?Bt:ut)){const un="   ",Mt=`${Pe?Pe+`
`:""} : ${oe}`;v({title:un,message:Mt,apkUrl:H,force:it,versionId:oe,versionCode:te}),m(!0);try{const Pn=localStorage.getItem("android_update_ready_version"),ft=localStorage.getItem("android_update_ready_code");(Pn&&Pn===oe||ft&&te&&String(te)===ft)&&P(!0)}catch{}}else try{m(!1)}catch{}})}catch{}})(),()=>{V=!0;try{typeof U=="function"&&U()}catch{}}},[T,I]),y.useEffect(()=>{if(r!=null&&r.uid)try{const j=localStorage.getItem("android_update_ready_version"),U=localStorage.getItem("android_update_ready_code"),V=String(I||"").trim(),Z=R,q=j&&V&&V===j,oe=U&&Z&&String(Z)===U;(q||oe)&&(async()=>{try{const{doc:H,setDoc:Pe,serverTimestamp:it}=await ee(async()=>{const{doc:be,setDoc:ze,serverTimestamp:Qe}=await Promise.resolve().then(()=>kn);return{doc:be,setDoc:ze,serverTimestamp:Qe}},void 0,import.meta.url),{db:te}=await ee(async()=>{const{db:be}=await Promise.resolve().then(()=>En);return{db:be}},void 0,import.meta.url),ne={lastAckAndroidVersion:V||j,androidInstalledVersion:V||j,lastAckAt:it(),androidInstalledAt:it()};Z&&(ne.lastAckAndroidCode=Z,ne.androidInstalledCode=Z),await Pe(H(te,"profiles",r.uid),ne,{merge:!0}),localStorage.removeItem("android_update_ready_version"),localStorage.removeItem("android_update_ready_code"),V&&localStorage.setItem("android_last_ack_version_id",V),V&&localStorage.setItem("android_installed_version",V),Z&&localStorage.setItem("android_last_ack_code",String(Z)),Z&&localStorage.setItem("android_installed_code",String(Z)),m(!1)}catch{}})()}catch{}},[r==null?void 0:r.uid,I,R]),y.useEffect(()=>{const j=V=>{const Z=(V==null?void 0:V.detail)||{};try{O.current&&(clearTimeout(O.current),O.current=null)}catch{}try{X.current&&(clearInterval(X.current),X.current=null)}catch{}E(!0),_({percent:Z.percent??null,downloaded:Z.downloaded??0,total:Z.total??0})},U=()=>{try{O.current&&(clearTimeout(O.current),O.current=null)}catch{}try{X.current&&(clearInterval(X.current),X.current=null)}catch{}E(!1),P(!0),_({percent:100,downloaded:((b==null?void 0:b.total)??(b==null?void 0:b.downloaded)??0)||0,total:(b==null?void 0:b.total)??0});try{const V=String((p==null?void 0:p.versionId)||"").trim(),Z=p==null?void 0:p.versionCode;if(V)try{localStorage.setItem("android_update_ready_version",V)}catch{}if(typeof Z=="number")try{localStorage.setItem("android_update_ready_code",String(Z))}catch{}}catch{}};return window.addEventListener("androidUpdateProgress",j),window.addEventListener("androidUpdateDownloaded",U),()=>{window.removeEventListener("androidUpdateProgress",j),window.removeEventListener("androidUpdateDownloaded",U)}},[]),M.useEffect(()=>{g&&(b!=null&&b.percent)&&b.percent>=99&&window.dispatchEvent(new CustomEvent("androidUpdateDownloaded"))},[b,g]),y.useEffect(()=>{let j=!0;return(async()=>{var U;try{const{auth:V}=await ee(async()=>{const{auth:ht}=await Promise.resolve().then(()=>En);return{auth:ht}},void 0,import.meta.url),Z=((U=V.currentUser)==null?void 0:U.uid)||"";if(!Z)return;const{db:q}=await ee(async()=>{const{db:ht}=await Promise.resolve().then(()=>En);return{db:ht}},void 0,import.meta.url),{collection:oe,query:H,where:Pe,onSnapshot:it,deleteDoc:te,limit:ne,orderBy:be,getDocs:ze}=await ee(async()=>{const{collection:ht,query:Re,where:ot,onSnapshot:Bt,deleteDoc:It,limit:ut,orderBy:Pt,getDocs:Me}=await Promise.resolve().then(()=>kn);return{collection:ht,query:Re,where:ot,onSnapshot:Bt,deleteDoc:It,limit:ut,orderBy:Pt,getDocs:Me}},void 0,import.meta.url),Qe=H(oe(q,"pendingSmsPopups"),Pe("userId","==",Z),Pe("status","==","pending")),mt=it(Qe,async ht=>{var Re,ot,Bt,It,ut,Pt,Me,un,Mt,Pn,ft,Yt,on,an,xt,vt,ln,He,lt,De;if(j)try{const tt=typeof ht.docChanges=="function"?ht.docChanges():[];console.log("Web Popup: Snapshot received",tt.length,"changes");for(const Ue of tt){if(Ue.type==="added"){if(Ue.doc.metadata.hasPendingWrites)continue;const se=Ue.doc.data()||{},nt=Ue.doc.id;console.log("Web Popup: Received document",nt,se),(ot=(Re=G.current)==null?void 0:Re.has)!=null&&ot.call(Re,nt)&&console.log("Web Popup: ID is in suppressed list",nt);try{const Ke=se.createdAt||se.timestamp||(se.payload||{}).createdAt||(se.payload||{}).timestamp,hn=Ke&&typeof Ke.toMillis=="function"?Ke.toMillis():typeof se.createdAtMs=="number"?se.createdAtMs:typeof(se.payload||{}).createdAtMs=="number"?(se.payload||{}).createdAtMs:null;if(typeof hn=="number"&&hn<Date.now()-36e5){console.log("Web Popup: Cleaning up old popup",nt),te(Ue.doc.ref).catch(()=>{});continue}}catch{}let _t=se.amount??((Bt=se.payload)==null?void 0:Bt.amount)??null,zt=se.sender??((It=se.payload)==null?void 0:It.sender)??"";const dn=se.senderName??((ut=se.payload)==null?void 0:ut.senderName)??"";let Jt=se.reference??((Pt=se.payload)==null?void 0:Pt.reference)??"";const Be=se.text??((Me=se.payload)==null?void 0:Me.text)??"";if((!_t||Number(_t)<=0)&&Be)try{const{parseSms:Ke}=await ee(async()=>{const{parseSms:Vn}=await Promise.resolve().then(()=>xP);return{parseSms:Vn}},void 0,import.meta.url),hn=Ke(Be);hn.amount>0&&(_t=hn.amount,zt=hn.sender||zt,hn.reference&&(Jt=hn.reference))}catch{}if(Jt&&Jt.length>5)try{const Ke=H(oe(q,"transactions"),Pe("reference","==",Jt),ne(1));if(!(await ze(Ke)).empty){console.log("Web Popup: Transaction already processed, confirming popup silently",nt);const{doc:Vn,updateDoc:zr,serverTimestamp:rr}=await ee(async()=>{const{doc:mr,updateDoc:jn,serverTimestamp:Or}=await Promise.resolve().then(()=>kn);return{doc:mr,updateDoc:jn,serverTimestamp:Or}},void 0,import.meta.url);await zr(Vn(q,"pendingSmsPopups",nt),{status:"confirmed",confirmedAt:rr()});continue}}catch(Ke){console.error("Error checking duplicate popup",Ke)}if(_t&&Number(_t)>0)try{const hn=H(oe(q,"transactions"),Pe("userId","==",nr),Pe("amount","==",Number(_t)),Pe("createdAt",">",new Date(Date.now()-864e5)),be("createdAt","desc"),ne(10)),Vn=await ze(hn);if(!Vn.empty){const zr=ce(String(zt||""));if(Vn.docs.find(mr=>{const jn=mr.data(),Or=ce(String(jn.senderMsisdn||jn.senderPhone||""));return!!(zr&&Or&&zr===Or)})){console.log("Web Popup: Duplicate transaction found by fuzzy match (Amount+Sender), confirming popup silently",nt);const{doc:mr,updateDoc:jn,serverTimestamp:Or}=await ee(async()=>{const{doc:pr,updateDoc:nn,serverTimestamp:jt}=await Promise.resolve().then(()=>kn);return{doc:pr,updateDoc:nn,serverTimestamp:jt}},void 0,import.meta.url);await jn(mr(q,"pendingSmsPopups",nt),{status:"confirmed",confirmedAt:Or()});continue}}}catch(Ke){console.warn("Fuzzy duplicate check failed",Ke)}let In=se.simNumber??((un=se.payload)==null?void 0:un.simNumber)??"",Vt=se.simSlot??((Mt=se.payload)==null?void 0:Mt.simSlot);Vt==null&&(Vt=se.slot??((Pn=se.payload)==null?void 0:Pn.slot)),Vt==null&&(Vt=se.sim_slot??((ft=se.payload)==null?void 0:ft.sim_slot)),Vt==null&&(Vt=se.lineId??((Yt=se.payload)==null?void 0:Yt.lineId));const Xt=Vt!=null?String(Vt):"",nr=(r==null?void 0:r.uid)||"default";let Xe=localStorage.getItem(`sim1Number_${nr}`)??localStorage.getItem("sim1Number")??"",Kt=localStorage.getItem(`sim2Number_${nr}`)??localStorage.getItem("sim2Number")??"";const wt=se.payload||{},ls=wt.sim1Number||wt.sim1||se.sim1Number||"",ti=wt.sim2Number||wt.sim2||se.sim2Number||"";ls&&(Xe=String(ls).trim(),Ct(Xe)),ti&&(Kt=String(ti).trim(),Y(Kt));let Jn=In,Ts="";Xt==="1"?(Ts="SIM 2",Kt&&(Jn=Kt)):(Xt==="0"||!Xt)&&(Ts="SIM 1",Xe&&(Jn=Xe));const cs=se.walletMsisdn??((on=se.payload)==null?void 0:on.walletMsisdn)??"";let Rn=se.walletId??((an=se.payload)==null?void 0:an.walletId)??"",Et="",xs="receive";const ni=se.type??(se.payload||{}).type;if(ni==="transfer")xs="transfer";else if(ni==="receive"||ni==="withdraw")xs="receive";else if(Be)try{const{parseSms:Ke}=await ee(async()=>{const{parseSms:Vn}=await Promise.resolve().then(()=>xP);return{parseSms:Vn}},void 0,import.meta.url);xs=Ke(Be).type}catch{}if(!Rn&&(cs||Jn))try{const Ke=cs||Jn,hn=(r==null?void 0:r.uid)||"default",Vn=`wallets_${hn}`,zr=localStorage.getItem(Vn);if(zr){const rr=JSON.parse(zr),mr=Array.isArray(rr)?rr.map(nn=>({id:String((nn==null?void 0:nn.id)||""),msisdn:ce(String((nn==null?void 0:nn.phone)||(nn==null?void 0:nn.msisdn)||"")),isDefault:!!(nn!=null&&nn.isDefault)})):[],jn=ce(Ke),Or=jn.replace(/\D/g,"");let pr=mr.find(nn=>nn.msisdn===jn);pr||(pr=mr.find(nn=>{const jt=(nn.msisdn||"").replace(/\D/g,"");return jt.length>=7&&Or.length>=7&&jt.slice(-7)===Or.slice(-7)})),pr&&(Rn=pr.id,Et=pr.msisdn)}if(!Rn){const{merchantWalletService:rr}=await ee(async()=>{const{merchantWalletService:jn}=await Promise.resolve().then(()=>mo);return{merchantWalletService:jn}},void 0,import.meta.url),mr=await rr.getByMerchantId(hn);if(mr&&mr.length>0){const jn=mr.map(jt=>({id:String((jt==null?void 0:jt.id)||""),msisdn:ce(String((jt==null?void 0:jt.phone)||(jt==null?void 0:jt.msisdn)||"")),isDefault:!!(jt!=null&&jt.isDefault)})),Or=ce(Ke),pr=Or.replace(/\D/g,"");let nn=jn.find(jt=>jt.msisdn===Or);if(nn||(nn=jn.find(jt=>{const Lr=(jt.msisdn||"").replace(/\D/g,"");return Lr.length>=7&&pr.length>=7&&Lr.slice(-7)===pr.slice(-7)})),nn){Rn=nn.id,Et=nn.msisdn;try{const jt=`wallets_${hn}`,Lr=localStorage.getItem(jt)?JSON.parse(localStorage.getItem(jt)):[]}catch{}}}}}catch(Ke){console.error("Immediate wallet resolution failed",Ke)}let Br="VF-Cash";if((/etisalat|/i.test(String(zt||""))||/etisalat|/i.test(String(Be||"")))&&(Br="Etisalat Cash"),/Received\s*EGP/i.test(String(Be))){Br="InstaPay";const Ke=String(Be).match(/Received\s*EGP\s*([0-9.,]+)/i);Ke&&(_t=parseFloat(String(Ke[1]).replace(/,/g,"")));const hn=String(Be).match(/from\s+([0-9+]+)/i);hn&&(zt=ce(hn[1]));const Vn=String(Be).match(/Ref:\s*([A-Za-z0-9\-]+)/i);Vn&&(Jt=String(Vn[1]).trim())}if(j){console.log("Web Popup: Opening modal for",nt);const Ke=!!se.isFakeSender||!!((xt=se.payload)!=null&&xt.isFakeSender),hn=localStorage.getItem(`smsAutoRegisterEnabled_${nr}`)??localStorage.getItem("smsAutoRegisterEnabled"),Vn=((vt=fe.current)==null?void 0:vt.smsAutoRegisterEnabled)===!0,zr=hn==="true"||Vn;let rr=!1;const mr=se.autoConfirm??((ln=se.payload)==null?void 0:ln.autoConfirm)??se.auto_confirm??((He=se.payload)==null?void 0:He.auto_confirm);mr!=null?rr=!!mr:rr=zr;const jn=se.autoConfirmDuration??((lt=se.payload)==null?void 0:lt.autoConfirmDuration)??(se==null?void 0:se.auto_confirm_duration)??((De=se.payload)==null?void 0:De.auto_confirm_duration),Or=Number.isFinite(Number(jn))?Math.max(0,Number(jn)):void 0;Or===0&&(rr=!0);const pr={amount:Number(_t||0),sender:String(zt||""),senderName:dn,reference:String(Jt||""),text:Be,simNumber:Et||cs||Jn,simLabel:Ts,simSlot:Vt,walletMsisdn:Et||cs,walletId:Rn,type:xs,providerLabel:Br,popupId:nt,sim1Number:Xe,sim2Number:Kt,isFakeSender:Ke,autoConfirm:rr,autoConfirmDuration:Or,isLocal:!0,lockedBy:se.lockedBy};let nn=!1;const jt=localStorage.getItem("deviceId")||`web-${Math.random().toString(36).slice(2)}`;if(localStorage.setItem("deviceId",jt),rr)try{const{doc:Lr,runTransaction:Sl}=await ee(async()=>{const{doc:uo,runTransaction:Ri}=await Promise.resolve().then(()=>kn);return{doc:uo,runTransaction:Ri}},void 0,import.meta.url),co=Lr(q,"pendingSmsPopups",nt);await Sl(q,async uo=>{const Jd=((await uo.get(co)).data()||{}).lockedBy;Jd?nn=Jd===jt:(uo.update(co,{lockedBy:jt}),nn=!0)})}catch(Lr){console.warn("Web Popup: Failed to acquire lock for auto-confirm",Lr)}else se.lockedBy&&(nn=se.lockedBy===jt);if(rr&&!nn&&(pr.autoConfirm=!1),pr.autoConfirm&&Number(pr.autoConfirmDuration)===0&&(!se.lockedBy||nn))try{await yt({...pr,walletId:Rn});try{const{doc:Lr,updateDoc:Sl,serverTimestamp:co}=await ee(async()=>{const{doc:uo,updateDoc:Ri,serverTimestamp:Ko}=await Promise.resolve().then(()=>kn);return{doc:uo,updateDoc:Ri,serverTimestamp:Ko}},void 0,import.meta.url);await Sl(Lr(q,"pendingSmsPopups",nt),{status:"confirmed",confirmedAt:co()})}catch{}continue}catch(Lr){console.error("Instant auto-confirm failed",Lr)}if(rr){console.log("Web Popup: Auto-confirming with countdown",nt),qe(pr),ve(!0);try{u({title:"  ( )",description:`   ${_t}  ${zt}`})}catch{}if(Ke)try{le()}catch{}else try{we()}catch(Lr){console.error("PlayBell failed",Lr)}}else{qe(pr),ve(!0);try{u({title:" ",description:se.lockedBy?"    ...":`   ${_t}  ${zt}`})}catch{}if(Ke)try{le()}catch{}else if(!se.lockedBy)try{we()}catch(Lr){console.error("PlayBell failed",Lr)}}}}Ue.type}}catch{}});Oe.current=mt}catch{}})(),()=>{j=!1;try{const U=Oe.current;typeof U=="function"&&U()}catch{}}},[r==null?void 0:r.uid]),y.useEffect(()=>{const j=(ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android"||/android/i.test(navigator.userAgent.toLowerCase()),U=typeof window<"u"&&(window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"));if(j||U)return;let V=!1;return(async()=>{try{const Z="0.0.0",q=await fetch("https://cashy-link.com/desktop_version.json",{cache:"no-store"});if(!q.ok)return;const oe=await q.json(),H=String((oe==null?void 0:oe.version)||"0.0.0"),Pe=!!(oe!=null&&oe.force);if(!V&&((te,ne)=>{const be=String(te).split(".").map(Qe=>parseInt(Qe,10)||0),ze=String(ne).split(".").map(Qe=>parseInt(Qe,10)||0);for(let Qe=0;Qe<Math.max(be.length,ze.length);Qe++){const mt=be[Qe]||0,ht=ze[Qe]||0;if(mt>ht)return 1;if(mt<ht)return-1}return 0})(H,Z)>0){if(Pe){try{window.location.reload()}catch{}return}try{u({title:"  ",description:` ${H}      `})}catch{}}}catch{}})(),()=>{V=!0}},[]),y.useEffect(()=>{(async()=>{try{const j=(r==null?void 0:r.uid)||"",U=s||"";if(j){const{Preferences:V}=await ee(async()=>{const{Preferences:H}=await Promise.resolve().then(()=>up);return{Preferences:H}},void 0,import.meta.url);await V.set({key:"bg_user_id",value:j}),await V.set({key:"bg_shop_id",value:U});const Z=localStorage.getItem(`sim1Number_${j}`)||localStorage.getItem("sim1Number")||"",q=localStorage.getItem(`sim2Number_${j}`)||localStorage.getItem("sim2Number")||"";Z&&await V.set({key:"sim1_number",value:Z}),q&&await V.set({key:"sim2_number",value:q});const oe=localStorage.getItem(`selectedWallet_${j}`)||"";oe&&await V.set({key:"bg_wallet_id",value:oe})}}catch(j){console.error("Failed to sync native preferences",j)}})()},[r==null?void 0:r.uid,s,Lt,dt]),y.useEffect(()=>{if(xe)try{const j=(r==null?void 0:r.uid)||"default",U=localStorage.getItem(`sim1Number_${j}`)??localStorage.getItem("sim1Number")??"",V=localStorage.getItem(`sim2Number_${j}`)??localStorage.getItem("sim2Number")??"";Ct(U),Y(V)}catch{}},[xe,r==null?void 0:r.uid]);const _n=(()=>{try{return String(localStorage.getItem("android_installed_version")||"").trim()}catch{return""}})(),tn=(()=>{const j=(V,Z)=>{const q=String(V||"").replace(/^v/i,"").split(".").map(H=>parseInt(H,10)||0),oe=String(Z||"").replace(/^v/i,"").split(".").map(H=>parseInt(H,10)||0);for(let H=0;H<Math.max(q.length,oe.length);H++){const Pe=q[H]||0,it=oe[H]||0;if(Pe>it)return 1;if(Pe<it)return-1}return 0},U=[I,T,_n].filter(Boolean);return U.length===0?"":U.reduce((V,Z)=>j(Z,V)>0?Z:V)})();return f.jsxs(f.Fragment,{children:[f.jsx(Ha,{open:rt,onOpenChange:()=>{},children:f.jsxs(Ro,{hideClose:!0,disableOutsideClose:!0,disableEscClose:!0,className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[92vw] max-w-md max-h-[86vh] overflow-y-auto rounded-2xl bg-white/95 backdrop-blur border border-gray-200 shadow-[0_10px_40px_rgba(16,24,40,0.12)] p-5",onInteractOutside:j=>{try{j.preventDefault()}catch{}},onEscapeKeyDown:j=>{try{j.preventDefault()}catch{}},style:{paddingBottom:"env(safe-area-inset-bottom, 16px)"},children:[f.jsx("div",{className:"absolute inset-x-0 -top-1 mx-auto h-1 w-24 rounded-full bg-gradient-to-r from-blue-600 via-emerald-500 to-purple-600"}),f.jsx(al,{className:"text-center",children:f.jsxs("div",{className:"flex items-center justify-center gap-3",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-11 h-11 rounded-xl bg-gradient-to-br from-blue-600 to-emerald-500 text-white",children:f.jsx(pE,{className:"w-6 h-6"})}),f.jsx(ll,{className:"text-lg font-extrabold tracking-tight text-gray-900",children:" "})]})}),f.jsx("div",{className:"mt-2 space-y-4 text-[0.95rem] leading-relaxed text-gray-800",children:f.jsxs("div",{className:"mt-4 text-center text-gray-700 leading-relaxed",children:[f.jsx("p",{children:"   .                    ."}),f.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"        ."})]})}),f.jsx("div",{className:"mt-4",children:f.jsx(bt,{className:"w-full h-10 rounded-xl bg-gradient-to-r from-blue-600 via-emerald-500 to-purple-600 hover:from-blue-700 hover:via-emerald-600 hover:to-purple-700 text-white font-semibold",onClick:Te,children:"  "})})]})}),(()=>{try{const j=(ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android",U=(typeof window<"u"?window.__uid:"")||""}catch{}return null})(),ae&&(ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android"&&f.jsx("div",{className:"fixed inset-0 z-[3000] flex items-center justify-center p-4",style:{background:"linear-gradient(135deg, #0f172a, #111827)"},children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 max-w-sm w-full p-5 text-center",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 rounded-full bg-red-100 text-red-600 mx-auto",children:f.jsx("span",{className:"text-2xl",children:"!"})}),f.jsx("h2",{className:"mt-3 text-base md:text-lg font-bold text-gray-900",children:"   "}),f.jsx("p",{className:"mt-1 text-sm text-gray-700",children:"        "}),f.jsx("div",{className:"mt-3 flex items-center justify-center gap-3",children:f.jsx(bt,{variant:"outline",className:"h-8 min-w-[100px]",onClick:retryConnectivity,children:"  "})})]})}),d&&p&&f.jsx(Ha,{open:d,onOpenChange:j=>{p!=null&&p.force||m(j)},children:f.jsxs(Ro,{className:"max-w-sm mx-auto bg-white border border-gray-200 shadow-2xl rounded-2xl sm:max-w-md",children:[f.jsxs(al,{className:"text-center",children:[f.jsx(ll,{className:"text-base md:text-lg font-bold text-gray-900",children:p.title}),f.jsx(mI,{className:"text-sm text-gray-700 whitespace-pre-line",children:p.message}),f.jsx("div",{className:"mt-2 text-xs text-muted-foreground",children:tn?`  : v${tn}`:""})]}),f.jsxs("div",{className:"flex items-center justify-center gap-3 mt-3",children:[!p.force&&!g&&!S&&f.jsx(bt,{variant:"outline",className:"h-8 min-w-[80px]",onClick:()=>m(!1),children:""}),!S&&f.jsx(bt,{className:"h-8 min-w-[120px] bg-emerald-600 hover:bg-emerald-700 text-white",onClick:()=>{try{const j=String((p==null?void 0:p.versionId)||"").trim(),U=p==null?void 0:p.versionCode;if(j)try{localStorage.setItem("android_last_ack_version_id",j)}catch{}if(typeof U=="number")try{localStorage.setItem("android_last_ack_code",String(U))}catch{}if((async()=>{try{if(r!=null&&r.uid&&j){const{doc:Z,setDoc:q,serverTimestamp:oe}=await ee(async()=>{const{doc:it,setDoc:te,serverTimestamp:ne}=await Promise.resolve().then(()=>kn);return{doc:it,setDoc:te,serverTimestamp:ne}},void 0,import.meta.url),{db:H}=await ee(async()=>{const{db:it}=await Promise.resolve().then(()=>En);return{db:it}},void 0,import.meta.url),Pe={lastAckAndroidVersion:j,lastAckAt:oe()};typeof U=="number"&&(Pe.lastAckAndroidCode=U),await q(Z(H,"profiles",r.uid),Pe,{merge:!0})}}catch{}})(),(ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android"){const Z=p.apkUrl,q=`cashy://update?url=${encodeURIComponent(Z)}`;E(!0),_({percent:0,downloaded:0,total:0});try{X.current&&clearInterval(X.current),X.current=setInterval(()=>{_(oe=>{const H=typeof(oe==null?void 0:oe.percent)=="number"?oe.percent:0,Pe=ke.current?2:1;return{percent:Math.min(99,Math.max(0,Math.round(H+Pe))),downloaded:(oe==null?void 0:oe.downloaded)??0,total:(oe==null?void 0:oe.total)??0}})},600)}catch{}window.location.href=q;try{O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{try{ke.current=!1}catch{}try{O.current=null}catch{}},8e3)}catch{}}else{const Z=p.apkUrl;try{window.open(Z,"_blank")}catch{}}}catch{}},children:g?" ...":" "}),S&&f.jsx(bt,{className:"h-8 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>{try{(ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android"&&(m(!1),window.location.href="cashy://applyUpdate")}catch{}},children:" "})]}),g&&f.jsxs("div",{className:"mt-3 text-center",children:[f.jsx("div",{className:"w-full h-2 bg-gray-200 rounded",children:f.jsx("div",{className:"h-2 bg-emerald-600 rounded",style:{width:`${Math.max(0,Math.min(100,Math.round((b==null?void 0:b.percent)||0)))}%`}})}),f.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[Math.round((b==null?void 0:b.percent)||0),"%"]})]})]})}),!!r&&xe&&f.jsx(Ha,{open:xe,onOpenChange:async j=>{j&&ve(!0)},children:f.jsxs(Ro,{className:"sm:max-w-[420px] rounded-2xl shadow-xl z-[9999] overflow-hidden border-0 p-0 gap-0",onInteractOutside:j=>{j.preventDefault()},onEscapeKeyDown:j=>{j.preventDefault()},hideClose:!0,children:[f.jsx("div",{className:"absolute left-4 top-4 z-50",children:f.jsx("button",{className:"p-2 rounded-full bg-black/10 hover:bg-black/20 text-white transition-colors backdrop-blur-sm",onClick:async()=>{if(ve(!1),Q!=null&&Q.popupId)try{const{db:j}=await ee(async()=>{const{db:q}=await Promise.resolve().then(()=>En);return{db:q}},void 0,import.meta.url),{doc:U,updateDoc:V,serverTimestamp:Z}=await ee(async()=>{const{doc:q,updateDoc:oe,serverTimestamp:H}=await Promise.resolve().then(()=>kn);return{doc:q,updateDoc:oe,serverTimestamp:H}},void 0,import.meta.url);await V(U(j,"pendingSmsPopups",Q.popupId),{status:"dismissed",dismissedAt:Z()})}catch{}},children:f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"M18 6 6 18"}),f.jsx("path",{d:"m6 6 12 12"})]})})}),f.jsxs("div",{className:"flex flex-col h-full bg-white",children:[f.jsxs("div",{className:`p-6 pb-10 relative overflow-hidden ${Q!=null&&Q.isFakeSender?"bg-gradient-to-br from-red-600 to-red-700":(Q==null?void 0:Q.type)==="transfer"?"bg-gradient-to-br from-orange-500 to-red-500":"bg-gradient-to-br from-emerald-500 to-emerald-700"}`,children:[f.jsx("div",{className:"absolute top-0 right-0 p-0 opacity-10",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"180",height:"180",viewBox:"0 0 24 24",fill:"currentColor",className:"-mr-8 -mt-8",children:f.jsx("path",{d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"})})}),f.jsxs("div",{className:"relative z-10 text-center text-white",children:[f.jsx("h2",{className:"text-lg font-bold mb-1 opacity-90 flex items-center justify-center gap-2",children:(Q==null?void 0:Q.type)==="transfer"?f.jsx("span",{children:"  "}):f.jsx("span",{children:" "})}),f.jsx("div",{className:"text-sm font-medium opacity-80 mb-4",children:(Q==null?void 0:Q.providerLabel)||"Vodafone Cash"}),f.jsxs("div",{className:"flex items-center justify-center gap-1 my-4 scale-110",dir:"rtl",children:[f.jsx("span",{className:"text-5xl font-extrabold tracking-tight drop-shadow-md",children:Number((Q==null?void 0:Q.amount)||0).toLocaleString()}),f.jsx("span",{className:"text-xl font-medium opacity-90 mt-3",children:"."})]}),!!(Q!=null&&Q.autoConfirm)&&f.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 bg-white/20 backdrop-blur-md px-4 py-1.5 rounded-full text-sm font-medium border border-white/10 shadow-sm",children:[f.jsx("span",{className:"animate-pulse",children:""}),f.jsx("span",{children:"  ()"})]})]})]}),f.jsxs("div",{className:"px-5 pb-5 -mt-6 relative z-20 flex-1 flex flex-col",children:[f.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden mb-4",children:[(Q==null?void 0:Q.isFakeSender)&&f.jsxs("div",{className:"p-3 bg-red-50 border-b border-red-100 text-red-700 text-center text-sm font-bold flex items-center justify-center gap-2",children:[f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),f.jsx("path",{d:"M12 9v4"}),f.jsx("path",{d:"M12 17h.01"})]}),"     !"]}),f.jsxs("div",{className:"divide-y divide-gray-100",children:[f.jsx("div",{className:"p-4 flex items-center justify-between",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center text-blue-600",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:f.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})})}),f.jsxs("div",{className:"text-right",children:[f.jsx("div",{className:"text-xs text-gray-500",children:(Q==null?void 0:Q.type)==="transfer"?"":""}),f.jsx("div",{className:"font-bold text-gray-900 text-sm",dir:"ltr",children:(Q==null?void 0:Q.sender)||" "}),(Q==null?void 0:Q.senderName)&&f.jsx("div",{className:"text-xs text-emerald-600 font-semibold mt-0.5",children:Q.senderName})]})]})}),f.jsx("div",{className:"p-4 flex items-center justify-between",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-50 flex items-center justify-center text-purple-600",children:f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("line",{x1:"4",x2:"20",y1:"9",y2:"9"}),f.jsx("line",{x1:"4",x2:"20",y1:"15",y2:"15"}),f.jsx("line",{x1:"10",x2:"8",y1:"3",y2:"21"}),f.jsx("line",{x1:"16",x2:"14",y1:"3",y2:"21"})]})}),f.jsxs("div",{className:"text-right",children:[f.jsx("div",{className:"text-xs text-gray-500",children:" "}),f.jsx("div",{className:"font-mono text-sm font-medium text-gray-700 max-w-[200px] truncate",title:Q==null?void 0:Q.reference,children:(Q==null?void 0:Q.reference)||"---"})]})]})}),f.jsx("div",{className:"p-4 flex items-center justify-between bg-gray-50/50",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-50 flex items-center justify-center text-amber-600",children:f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1"}),f.jsx("path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4"})]})}),f.jsxs("div",{className:"text-right",children:[f.jsx("div",{className:"text-xs text-gray-500",children:" "}),f.jsx("div",{className:"font-bold text-gray-900 text-sm",dir:"ltr",children:(Q==null?void 0:Q.walletMsisdn)||f.jsx("span",{className:"text-amber-600 text-xs px-2 py-0.5 rounded bg-amber-100",children:" ..."})})]})]})})]})]}),(Q==null?void 0:Q.simSelectionRequired)&&f.jsxs("div",{className:"mb-4 bg-amber-50 rounded-xl p-3 border border-amber-200 animate-in fade-in zoom-in duration-300",children:[f.jsx("div",{className:"text-xs font-bold text-amber-800 mb-2 text-center",children:"   "}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("button",{className:"flex-1 py-2.5 bg-white border border-amber-300 rounded-lg text-amber-900 font-bold hover:bg-amber-100 transition-colors shadow-sm",onClick:async()=>{const j=Q.sim1Number||localStorage.getItem("sim1Number")||"",U={...Q,simSelectionRequired:!1,simLabel:"SIM 1",simNumber:ce(j),simSlot:0};qe(U);try{const{resolveWalletBySimOrSlot:V}=await ee(async()=>{const{resolveWalletBySimOrSlot:q}=await Promise.resolve().then(()=>Oi);return{resolveWalletBySimOrSlot:q}},void 0,import.meta.url),Z=await V({simNumbers:[U.simNumber],userId:r==null?void 0:r.uid,slotIndex:0});Z&&Z.walletId&&qe({...U,walletMsisdn:Z.msisdn,walletId:Z.walletId})}catch{}},children:["SIM 1",Lt&&f.jsx("div",{className:"text-[10px] font-normal opacity-75",children:Lt})]}),f.jsxs("button",{className:"flex-1 py-2.5 bg-white border border-amber-300 rounded-lg text-amber-900 font-bold hover:bg-amber-100 transition-colors shadow-sm",onClick:async()=>{const j=Q.sim2Number||localStorage.getItem("sim2Number")||"",U={...Q,simSelectionRequired:!1,simLabel:"SIM 2",simNumber:ce(j),simSlot:1};qe(U);try{const{resolveWalletBySimOrSlot:V}=await ee(async()=>{const{resolveWalletBySimOrSlot:q}=await Promise.resolve().then(()=>Oi);return{resolveWalletBySimOrSlot:q}},void 0,import.meta.url),Z=await V({simNumbers:[U.simNumber],userId:r==null?void 0:r.uid,slotIndex:1});Z&&Z.walletId&&qe({...U,walletMsisdn:Z.msisdn,walletId:Z.walletId})}catch{}},children:["SIM 2",dt&&f.jsx("div",{className:"text-[10px] font-normal opacity-75",children:dt})]})]})]}),Yn&&f.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 p-3 rounded-xl border border-gray-100 mb-4",children:[f.jsx("input",{type:"number",step:"0.01",min:"0",value:cn,onChange:j=>cr(j.target.value),className:"w-24 text-center font-bold border rounded-lg px-2 py-1.5 focus:ring-2 focus:ring-emerald-500 outline-none",placeholder:"0.00"}),f.jsx("span",{className:"text-sm font-medium text-gray-600 flex-1 text-right",children:"  ()"})]}),et&&f.jsxs("div",{className:"bg-amber-50 rounded-xl p-4 border border-amber-100 space-y-3 animate-in fade-in slide-in-from-top-2 mb-4",children:[f.jsxs("div",{className:"flex items-center justify-between text-amber-800",children:[f.jsxs("span",{className:"font-bold text-lg",children:[Ce.toLocaleString()," ."]}),f.jsx("span",{className:"text-sm font-medium",children:"   ()"})]}),f.jsx("input",{type:"text",value:Dr,onChange:j=>J(j.target.value),className:"w-full border-amber-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-amber-500 outline-none",placeholder:"  ()",autoFocus:!0}),f.jsx(bt,{size:"sm",className:"w-full bg-amber-600 hover:bg-amber-700 text-white font-medium",onClick:()=>{kr(!0),he(!1)},children:"  "})]}),Nr&&!et&&f.jsxs("div",{className:"bg-amber-50 border border-amber-200 text-amber-800 rounded-lg p-3 text-sm flex items-center justify-between mb-4",children:[f.jsx("button",{onClick:()=>he(!0),className:"text-amber-600 underline text-xs",children:""}),f.jsxs("span",{children:["   ",f.jsx("b",{children:""})," : ",Dr||" "]})]}),f.jsxs("div",{className:"mt-auto space-y-3",children:[f.jsx(Ste,{enabled:!!(Q!=null&&Q.autoConfirm)&&Number((Q==null?void 0:Q.autoConfirmDuration)??(n==null?void 0:n.smsAutoConfirmDuration)??5)>0,isLocal:!!(Q!=null&&Q.isLocal),duration:Math.max(0,Number((Q==null?void 0:Q.autoConfirmDuration)??(n==null?void 0:n.smsAutoConfirmDuration)??5)),onConfirm:()=>{try{yt({...Q,deferredMode:Nr,debtorName:Dr,debtorNote:ue})}catch{yt()}}}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx(bt,{variant:"outline",className:"flex-1 border-amber-200 text-amber-700 hover:bg-amber-50 hover:text-amber-800 h-12 text-base rounded-xl",disabled:!1,onClick:async()=>{var j;try{const V=String((Q==null?void 0:Q.text)||"").match(/\s+(\d+(?:[\.,]\d+)?)\s*/i),Z=V?parseFloat(String(V[1]).replace(",",".")):Number((Q==null?void 0:Q.amount)||0),{auth:q}=await ee(async()=>{const{auth:Qe}=await Promise.resolve().then(()=>En);return{auth:Qe}},void 0,import.meta.url),oe=((j=q.currentUser)==null?void 0:j.uid)||"",H=Q==null?void 0:Q.walletId,Pe=oe?`selectedWallet_${oe}`:"selectedWallet_default",it=H||localStorage.getItem(Pe)||"",te=cn&&cn.trim()!==""?Math.max(0,parseFloat(cn)):null;let ne=0;if(te!=null)ne=te;else try{const{merchantWalletService:Qe}=await ee(async()=>{const{merchantWalletService:Re}=await Promise.resolve().then(()=>mo);return{merchantWalletService:Re}},void 0,import.meta.url),mt=await Qe.getById(String(it)),ht=mt&&mt.defaultWithdrawCommission;if(ht!=null)ne=Math.round((Number(ht)||0)*Number(Z)/1e3*100)/100;else{const{calculateCommission:Re}=await ee(async()=>{const{calculateCommission:ot}=await Promise.resolve().then(()=>To);return{calculateCommission:ot}},void 0,import.meta.url);ne=Re(Number(Z),"receive")}}catch{const{calculateCommission:Qe}=await ee(async()=>{const{calculateCommission:mt}=await Promise.resolve().then(()=>To);return{calculateCommission:mt}},void 0,import.meta.url);ne=Qe(Number(Z),"receive")}const ze=((localStorage.getItem("commissionMode")||"").toLowerCase()==="add"?"add":"deduct")==="add"?Number(Z)+Number(ne):Number(Z);Fe(Math.round(ze*100)/100),he(!0)}catch{he(!0)}},children:" ()"}),f.jsx(bt,{className:`flex-[2] h-12 text-base font-bold shadow-lg rounded-xl text-white ${(Q==null?void 0:Q.type)==="transfer"?"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 shadow-orange-200":"bg-gradient-to-r from-emerald-600 to-emerald-500 hover:from-emerald-700 hover:to-emerald-600 shadow-emerald-200"}`,disabled:!1,onClick:()=>{try{yt({...Q,deferredMode:Nr,debtorName:Dr,debtorNote:ue})}catch{yt()}},children:" "})]})]})]})]})]})})]})},Ste=({enabled:t,duration:e,onConfirm:n,isLocal:r})=>{const[s,i]=M.useState(e),[o,a]=M.useState(!1),l=M.useRef(n),c=M.useRef(null);if(M.useEffect(()=>{l.current=n},[n]),M.useEffect(()=>{t&&(i(e),a(!1),c.current=Date.now()+e*1e3)},[t,e]),M.useEffect(()=>{if(!t||o){c.current=null;return}c.current===null&&(c.current=Date.now()+s*1e3);const d=setInterval(()=>{const m=Date.now(),p=c.current||m+1e3,v=Math.max(0,(p-m)/1e3);i(v),v<=0&&(clearInterval(d),l.current())},100);return()=>clearInterval(d)},[t,o,r]),!t)return null;const u=Math.min(100,Math.max(0,s/e*100));return f.jsxs("div",{className:"mb-4 relative overflow-hidden rounded-xl bg-emerald-50 border border-emerald-100 p-3 shadow-inner",children:[f.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[f.jsxs("div",{className:"flex items-center gap-2 text-emerald-900 font-bold text-sm",children:[f.jsx("div",{className:"relative w-5 h-5 flex items-center justify-center",children:f.jsxs("svg",{className:"animate-spin text-emerald-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),f.jsxs("span",{children:["   ",Math.ceil(s)," "]})]}),f.jsx("button",{onClick:()=>a(!0),className:"text-xs font-bold text-white bg-emerald-500 hover:bg-emerald-600 px-3 py-1.5 rounded-lg shadow-sm transition-all active:scale-95",children:""})]}),f.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-emerald-200 w-full"}),f.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-emerald-600 transition-all duration-100 ease-linear",style:{width:`${u}%`}})]})},iR=()=>{const t=Ii(),{user:e}=Zs(),n=t.pathname.startsWith("/user/login")||t.pathname.startsWith("/auth")||t.pathname.startsWith("/admin/login")||t.pathname.startsWith("/cpanel/login")||t.pathname.startsWith("/dashboard/login")||t.pathname==="/"||t.pathname.startsWith("/landing");return e&&!n?f.jsxs(f.Fragment,{children:[f.jsx(u$,{}),f.jsx(Nk,{})]}):null},oR=()=>{const{user:t,loading:e}=Zs(),[n,r]=y.useState(!0),s=oo();return y.useEffect(()=>{const i=setTimeout(()=>r(!1),7e3);return()=>clearTimeout(i)},[]),y.useEffect(()=>{(async()=>{if(ge.isNativePlatform()&&ge.getPlatform()==="android")if(!e)setTimeout(async()=>{try{await CP.hide()}catch(o){console.warn("Error hiding splash:",o)}},100);else{const o=setTimeout(async()=>{try{await CP.hide()}catch{}},8e3);return()=>clearTimeout(o)}})()},[e]),y.useEffect(()=>{if(e)r(!0);else{try{window.dispatchEvent(new CustomEvent("loader:finish"))}catch{}const i=()=>r(!1);try{window.addEventListener("loader:progress-done",i)}catch{}const o=setTimeout(()=>r(!1),1500);return()=>{try{window.removeEventListener("loader:progress-done",i)}catch{}clearTimeout(o)}}},[e]),y.useEffect(()=>{if(!n&&!e&&!t)try{s("/user/login")}catch{}},[n,e,t]),n?f.jsx(ub,{}):t?f.jsx(ng,{}):f.jsx(fy,{})},Ite=()=>(y.useEffect(()=>{const t=document.getElementById("app-loading-screen");t&&(t.style.opacity="0",t.style.transition="opacity 0.2s ease",setTimeout(()=>t.remove(),200))},[]),y.useEffect(()=>{try{const t=(ge==null?void 0:ge.isNativePlatform)&&ge.getPlatform()==="android",e=document.documentElement;e&&e.classList.toggle("android-native",!!t)}catch{}},[]),f.jsx(g9,{client:Bl,children:f.jsx(Az,{children:f.jsxs(DB,{children:[typeof window<"u"&&(window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"))&&!(ge!=null&&ge.isNativePlatform&&ge.getPlatform()==="android")&&f.jsx(Nee,{}),f.jsx(wte,{}),f.jsx(bte,{}),typeof window<"u"&&(window.electronAPI||window.location.protocol==="file:"||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron")||typeof window.location.hash=="string"&&window.location.hash.startsWith("#/")||typeof import.meta<"u"&&_te||ge!=null&&ge.isNativePlatform&&ge.getPlatform()==="android")?f.jsxs(Sz,{children:[f.jsx(sR,{}),f.jsx(iR,{}),f.jsx(y.Suspense,{fallback:f.jsx(ub,{}),children:f.jsxs(qx,{children:[f.jsx(Ve,{path:"/",element:ge!=null&&ge.isNativePlatform&&ge.getPlatform()==="android"?f.jsx(oR,{}):f.jsx(vp,{})}),f.jsx(Ve,{path:"/dashboard-redirect",element:f.jsx(MP,{})}),f.jsx(Ve,{path:"/landing",element:f.jsx(vp,{})}),f.jsx(Ve,{path:"/subscriptions",element:f.jsx(VP,{})}),f.jsx(Ve,{path:"/auth",element:f.jsx(jP,{})}),f.jsx(Ve,{path:"/user/login",element:f.jsx(fy,{})}),f.jsx(Ve,{path:"/user/forgot-password",element:f.jsx(BP,{})}),f.jsx(Ve,{path:"/user/register",element:f.jsx(_p,{})}),f.jsx(Ve,{path:"/register",element:f.jsx(_p,{})}),f.jsx(Ve,{path:"/user/account-setup",element:f.jsx($P,{})}),f.jsx(Ve,{path:"/user/pending-approval",element:f.jsx(HP,{})}),f.jsx(Ve,{path:"/user/dashboard",element:f.jsx(ng,{})}),f.jsx(Ve,{path:"/branch/:shopId/dashboard",element:f.jsx(ng,{})}),f.jsx(Ve,{path:"/user/add-wallet",element:f.jsx(XP,{})}),f.jsx(Ve,{path:"/admin/login",element:f.jsx(KP,{})}),f.jsx(Ve,{path:"/admin/dashboard",element:f.jsx(GP,{})}),f.jsx(Ve,{path:"/admin/topups",element:f.jsx(FP,{})}),f.jsx(Ve,{path:"/admin/notifications",element:f.jsx(UP,{})}),f.jsx(Ve,{path:"/profile-settings",element:f.jsx(YP,{})}),f.jsx(Ve,{path:"/transactions",element:f.jsx(JP,{})}),f.jsx(Ve,{path:"/referrals",element:f.jsx(ZP,{})}),f.jsx(Ve,{path:"/privacy-policy",element:f.jsx(tR,{})}),f.jsx(Ve,{path:"/cpanel",element:f.jsx(EP,{})}),f.jsx(Ve,{path:"/cpanel/login",element:f.jsx(SP,{})}),f.jsx(Ve,{path:"/auth-test",element:f.jsx(QP,{})}),f.jsx(Ve,{path:"/topup",element:f.jsx(wp,{})}),f.jsx(Ve,{path:"/recharge",element:f.jsx(wp,{})}),f.jsx(Ve,{path:"/merchant/*",element:f.jsx(qP,{})}),f.jsx(Ve,{path:"/dashboard/login",element:f.jsx(zP,{})}),f.jsx(Ve,{path:"/dashboard",element:f.jsx(WP,{})}),f.jsxs(Ve,{path:"/sms-portal",element:f.jsx(IP,{}),children:[f.jsx(Ve,{index:!0,element:f.jsx(gp,{})}),f.jsx(Ve,{path:"login",element:f.jsx(gp,{})}),f.jsx(Ve,{path:"dashboard",element:f.jsx(AP,{})})]}),f.jsx(Ve,{path:"*",element:f.jsx(eR,{})})]})}),f.jsx(OP,{position:"right"}),f.jsx(nR,{})]}):f.jsxs(Ez,{children:[f.jsx(sR,{}),f.jsx(iR,{}),f.jsx(y.Suspense,{fallback:f.jsx(ub,{}),children:f.jsxs(qx,{children:[f.jsx(Ve,{path:"/",element:ge!=null&&ge.isNativePlatform&&ge.getPlatform()==="android"?f.jsx(oR,{}):f.jsx(vp,{})}),f.jsx(Ve,{path:"/dashboard-redirect",element:f.jsx(MP,{})}),f.jsx(Ve,{path:"/landing",element:f.jsx(vp,{})}),f.jsx(Ve,{path:"/subscriptions",element:f.jsx(VP,{})}),f.jsx(Ve,{path:"/auth",element:f.jsx(jP,{})}),f.jsx(Ve,{path:"/user/login",element:f.jsx(fy,{})}),f.jsx(Ve,{path:"/user/forgot-password",element:f.jsx(BP,{})}),f.jsx(Ve,{path:"/user/register",element:f.jsx(_p,{})}),f.jsx(Ve,{path:"/register",element:f.jsx(_p,{})}),f.jsx(Ve,{path:"/user/account-setup",element:f.jsx($P,{})}),f.jsx(Ve,{path:"/user/pending-approval",element:f.jsx(HP,{})}),f.jsx(Ve,{path:"/user/dashboard",element:f.jsx(ng,{})}),f.jsx(Ve,{path:"/user/add-wallet",element:f.jsx(XP,{})}),f.jsx(Ve,{path:"/admin/login",element:f.jsx(KP,{})}),f.jsx(Ve,{path:"/admin/dashboard",element:f.jsx(GP,{})}),f.jsx(Ve,{path:"/admin/topups",element:f.jsx(FP,{})}),f.jsx(Ve,{path:"/admin/notifications",element:f.jsx(UP,{})}),f.jsx(Ve,{path:"/profile-settings",element:f.jsx(YP,{})}),f.jsx(Ve,{path:"/transactions",element:f.jsx(JP,{})}),f.jsx(Ve,{path:"/referrals",element:f.jsx(ZP,{})}),f.jsx(Ve,{path:"/privacy-policy",element:f.jsx(tR,{})}),f.jsx(Ve,{path:"/cpanel",element:f.jsx(EP,{})}),f.jsx(Ve,{path:"/cpanel/login",element:f.jsx(SP,{})}),f.jsx(Ve,{path:"/auth-test",element:f.jsx(QP,{})}),f.jsx(Ve,{path:"/topup",element:f.jsx(wp,{})}),f.jsx(Ve,{path:"/recharge",element:f.jsx(wp,{})}),f.jsx(Ve,{path:"/merchant/*",element:f.jsx(qP,{})}),f.jsx(Ve,{path:"/dashboard/login",element:f.jsx(zP,{})}),f.jsx(Ve,{path:"/dashboard",element:f.jsx(WP,{})}),f.jsxs(Ve,{path:"/sms-portal",element:f.jsx(IP,{}),children:[f.jsx(Ve,{index:!0,element:f.jsx(gp,{})}),f.jsx(Ve,{path:"login",element:f.jsx(gp,{})}),f.jsx(Ve,{path:"dashboard",element:f.jsx(AP,{})})]}),f.jsx(Ve,{path:"*",element:f.jsx(eR,{})})]})}),f.jsx(OP,{position:"right"}),f.jsx(nR,{})]})]})})})),Lj=y.createContext(void 0),Tte=({children:t})=>{const[e,n]=y.useState(null),[r,s]=y.useState(!1),[i,o]=y.useState(null),{profile:a,user:l}=Zs();y.useEffect(()=>{try{const p=localStorage.getItem("cashier_shift_user"),v=localStorage.getItem("cashier_shift_active"),g=localStorage.getItem("cashier_shift_start_at");p&&n(JSON.parse(p)),v&&s(v==="true"),g&&o(Number(g))}catch{}},[]);const c=async()=>{if(a!=null&&a.shopId)try{const p=ye(F,"cashierShift",a.shopId),v=await Sn(p);if(v.exists()){const g=v.data(),E=!!(g!=null&&g.isShiftActive),b=(g==null?void 0:g.shiftStartAt)??null,_=localStorage.getItem("cashier_shift_active")==="true";if(!E&&_){s(!1),n(null),localStorage.setItem("cashier_shift_active","false"),localStorage.removeItem("cashier_shift_user");return}if(E&&!_){s(!1),n(null);return}if(E&&_){s(!0);try{const S=localStorage.getItem("cashier_shift_user");S&&n(JSON.parse(S))}catch{}b&&(o(Number(b)),localStorage.setItem("cashier_shift_start_at",String(b)))}}else await rn(p,{isShiftActive:!1,shiftStartAt:null,shiftUser:null})}catch(p){console.warn("Failed to refresh shift status:",p)}};y.useEffect(()=>{c()},[a==null?void 0:a.shopId]);const u=p=>{n(p);try{p?localStorage.setItem("cashier_shift_user",JSON.stringify(p)):localStorage.removeItem("cashier_shift_user")}catch{}try{if(a!=null&&a.shopId){const v=ye(F,"cashierShift",a.shopId);xn(v,{shiftUser:p||null})}}catch{}},d=()=>{s(!0);try{localStorage.setItem("cashier_shift_active","true")}catch{}const p=Date.now();o(p);try{localStorage.setItem("cashier_shift_start_at",String(p))}catch{}try{if(a!=null&&a.shopId){const v=ye(F,"cashierShift",a.shopId);xn(v,{isShiftActive:!0,shiftStartAt:p})}}catch{}try{const g=`cashBalance_${(l==null?void 0:l.uid)||"default"}`,E=`userCashBalance_${(l==null?void 0:l.uid)||"default"}`,b=`walletBalances_${(l==null?void 0:l.uid)||"default"}`,_=localStorage.getItem("lastKnownCashBalance"),S=localStorage.getItem("lastKnownWalletBalances");let P=localStorage.getItem(g);if((!P||P==="0")&&_&&_!=="0"&&(P=_),P==null){const N=localStorage.getItem(E);if(N!=null){P=N;try{localStorage.setItem(g,N),localStorage.removeItem(E)}catch{}}}if(P==null&&(l!=null&&l.uid)){const N=localStorage.getItem("cashBalance"),I=localStorage.getItem("userCashBalance");if(N!=null){try{localStorage.setItem(g,N),localStorage.removeItem("cashBalance")}catch{}P=N}else if(I!=null){try{localStorage.setItem(g,I),localStorage.removeItem("userCashBalance")}catch{}P=I}}let T=localStorage.getItem(b);(!T||T==="{}")&&S&&S!=="{}"&&(T=S),P?localStorage.setItem("shiftStartDrawerFunds",P):localStorage.setItem("shiftStartDrawerFunds","0"),T?localStorage.setItem("shiftStartWalletBalances",T):localStorage.setItem("shiftStartWalletBalances","{}")}catch{}try{a!=null&&a.shopId&&(async()=>{try{const v=ye(F,"dashboardData",a.shopId),g=await Sn(v);if(g.exists()){const E=g.data(),b=Number((E==null?void 0:E.cashBalance)??0),_=(E==null?void 0:E.walletBalances)??{};try{const S=localStorage.getItem("lastKnownCashBalance"),P=localStorage.getItem("lastKnownWalletBalances"),T=localStorage.getItem("shiftStartDrawerFunds"),N=localStorage.getItem("shiftStartWalletBalances"),I=T?parseFloat(T):0,A=N?JSON.parse(N):{},R=!T||!Number.isFinite(I)||I===0,k=!N||Object.keys(A||{}).length===0;R&&(b===0&&S&&S!=="0"?localStorage.setItem("shiftStartDrawerFunds",S):localStorage.setItem("shiftStartDrawerFunds",String(Number.isFinite(b)?b:0))),k&&((!_||Object.keys(_).length===0)&&P&&P!=="{}"?localStorage.setItem("shiftStartWalletBalances",P):localStorage.setItem("shiftStartWalletBalances",JSON.stringify(_||{})))}catch{}}}catch(v){console.warn("Shift start Firebase read failed:",v)}})()}catch{}},m=()=>{s(!1);try{localStorage.setItem("cashier_shift_active","false")}catch{}try{if(a!=null&&a.shopId){const p=ye(F,"cashierShift",a.shopId);xn(p,{isShiftActive:!1})}}catch{}};return f.jsx(Lj.Provider,{value:{shiftUser:e,isShiftActive:r,shiftStartAt:i,setShiftUser:u,startShift:d,endShift:m,refreshShiftStatus:c},children:t})},mne=()=>{const t=y.useContext(Lj);if(!t)throw new Error("useShift must be used within ShiftProvider");return t};class xte extends y.Component{constructor(){super(...arguments);eh(this,"state",{hasError:!1,error:null});eh(this,"handleReload",()=>{window.location.reload()})}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("Uncaught error:",n,r)}render(){var n,r,s,i,o,a,l;if(this.state.hasError){const c=((r=(n=this.state.error)==null?void 0:n.message)==null?void 0:r.includes("removeChild"))||((i=(s=this.state.error)==null?void 0:s.message)==null?void 0:i.includes("NotFoundError"))||((a=(o=this.state.error)==null?void 0:o.message)==null?void 0:a.includes("The node to be removed is not a child of this node"));if(c){const u=parseInt(sessionStorage.getItem("node_error_reload_count")||"0");if(u<2)return sessionStorage.setItem("node_error_reload_count",String(u+1)),window.location.reload(),null;setTimeout(()=>sessionStorage.removeItem("node_error_reload_count"),1e4)}return f.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50 p-4 text-center dark:bg-gray-900",children:f.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 space-y-4",children:[f.jsx("div",{className:"flex justify-center",children:f.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 rounded-full",children:f.jsx(wk,{className:"w-8 h-8 text-red-600 dark:text-red-400"})})}),f.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"    "}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:c?"         .   .":"    .    ."}),typeof window<"u"&&window.Capacitor&&f.jsx("pre",{className:"text-xs text-left bg-gray-100 dark:bg-gray-950 p-2 rounded overflow-auto max-h-32 dir-ltr",children:(l=this.state.error)==null?void 0:l.toString()}),f.jsxs(bt,{onClick:this.handleReload,className:"w-full gap-2",children:[f.jsx(mE,{className:"w-4 h-4"})," "]})]})})}return this.props.children}}try{const t=navigator.userAgent||navigator.vendor||"",e=/iPad|iPhone|iPod/.test(t),n=document.documentElement;n&&(n.classList.toggle("ios",e),n.classList.toggle("android",!e))}catch{}try{fj()}catch{}try{window.useState=M.useState,window.useEffect=M.useEffect,window.useRef=M.useRef,window.createContext=M.createContext}catch{}const Ate=()=>{const{theme:t="system"}=Ck();return y.useEffect(()=>{try{const e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,n=t==="system"?e?"dark":"light":t;document.documentElement.setAttribute("data-theme",n||"light"),document.documentElement.classList.toggle("dark",n==="dark")}catch{}},[t]),null};BN(document.getElementById("root")).render(f.jsx(xte,{children:f.jsx(f$,{attribute:"class",defaultTheme:"system",enableSystem:!0,storageKey:"theme",children:f.jsx(lee,{children:f.jsx(Tte,{children:f.jsxs(ete,{children:[f.jsx(Ite,{}),f.jsx(Ate,{})]})})})})}));export{rn as $,oV as A,bt as B,ax as C,Vs as D,$e as E,w5 as F,i0 as G,$y as H,ir as I,Uh as J,$h as K,v0 as L,Yc as M,Bte as N,pk as O,i5 as P,d7 as Q,M as R,yk as S,oj as T,T5 as U,$o as V,ye as W,aP as X,pE as Y,kt as Z,_2 as _,oo as a,bX as a$,Ot as a0,Sn as a1,ob as a2,TP as a3,yn as a4,Uy as a5,Ii as a6,Cs as a7,hr as a8,tte as a9,_U as aA,fV as aB,j3 as aC,D3 as aD,ux as aE,r5 as aF,cb as aG,Ne as aH,mI as aI,Nte as aJ,Wn as aK,kv as aL,mne as aM,ee as aN,yee as aO,mE as aP,rj as aQ,Vv as aR,dV as aS,Fl as aT,ka as aU,tf as aV,s0 as aW,ij as aX,qx as aY,Ve as aZ,AX as a_,Ha as aa,Ro as ab,al as ac,ll as ad,Ac as ae,PU as af,Iw as ag,wn as ah,Zt as ai,Kn as aj,ste as ak,cE as al,jr as am,xn as an,cx as ao,vk as ap,$i as aq,Al as ar,wj as as,hne as at,iV as au,cX as av,Xte as aw,lX as ax,lx as ay,EX as az,fne as b,wk as b$,C3 as b0,B3 as b1,A5 as b2,gk as b3,GV as b4,ge as b5,kP as b6,T3 as b7,u5 as b8,_X as b9,yy as bA,Nc as bB,u7 as bC,Kte as bD,lj as bE,cj as bF,Xf as bG,Hk as bH,Dte as bI,eo as bJ,XU as bK,dB as bL,lE as bM,Jf as bN,VZ as bO,JX as bP,TV as bQ,gV as bR,Vy as bS,hB as bT,ite as bU,fB as bV,uI as bW,Vee as bX,zN as bY,h5 as bZ,ine as b_,Dj as ba,fE as bb,L3 as bc,mj as bd,P3 as be,ZQ as bf,vI as bg,ub as bh,_Y as bi,Si as bj,cee as bk,Wk as bl,ND as bm,rne as bn,ZZ as bo,tee as bp,sne as bq,WV as br,qV as bs,HV as bt,nee as bu,zV as bv,eee as bw,Mz as bx,Iee as by,E5 as bz,Sd as c,WD as c0,dy as c1,Gte as c2,xQ as c3,mA as c4,pA as c5,Hte as c6,Wte as c7,Ck as c8,dj as c9,Gy as cA,QB as cB,$B as cC,Mte as cD,h0 as cE,rs as cF,Qy as cG,FB as cH,UB as cI,kg as cJ,dD as cK,c9 as cL,WB as cM,ss as cN,Vte as cO,kn as cP,En as cQ,mo as cR,up as cS,one as cT,ane as cU,lne as cV,Cee as cW,dne as cX,Bf as cY,PX as ca,tne as cb,nne as cc,IX as cd,cne as ce,kee as cf,PR as cg,Rte as ch,sn as ci,Rh as cj,$te as ck,Ute as cl,Ul as cm,G3 as cn,Oee as co,Dee as cp,une as cq,ic as cr,SX as cs,Cte as ct,Yd as cu,Ree as cv,Zte as cw,Pee as cx,ene as cy,Aee as cz,Id as d,Td as e,Fv as f,xd as g,sj as h,nte as i,f as j,zte as k,See as l,hl as m,aj as n,_ee as o,qt as p,Ye as q,y as r,Ae as s,F as t,Zs as u,Gs as v,Uo as w,Ze as x,vr as y,XY as z};
//# sourceMappingURL=index-DhbnydJl.js.map
