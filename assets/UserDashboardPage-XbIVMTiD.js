const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-DhbnydJl.js","./index-DLaPizfT.css","./WalletManagement-lpVl8Tb_.js","./select-Bn8RCTk-.js","./wallet--cZcBirk.js","./star-BSPZIAqJ.js","./square-pen-CSLFtBCt.js","./arrow-left-DTf_k4UZ.js","./progress-QxZkw5ok.js","./separator-Cn84CDdZ.js","./calendar-4dCWv1Gk.js","./chart-column-CP9zHq0e.js","./trending-down-CYLWGiMe.js","./dollar-sign-AUKMnGdi.js","./activity-NKT3hJFE.js","./users-D9PlfCO2.js","./circle-check-big-Dtvck6_a.js","./TransactionDetailsModal-Bpv925j7.js","./SimCardsAccessDialog-Z5OgVyJn.js","./printer-DeiqlOce.js","./ReceiptModal-Dqs_G1Fp.js","./html2canvas.esm-BfYXEYrK.js","./download-CAzB5lkL.js","./EditBalanceDialog-BgDrnmkH.js","./ChangePinDialog-CtkqDawM.js","./ChangeCashPinDialog-D25KmpUO.js","./ChangeWalletTotalPinDialog-CC56Q8bH.js","./AddToWalletDialog-Dr55h_jx.js","./CalculatorDialog-Z7R2w5Q2.js","./SalesDataDialog-DbxS8Orm.js","./table-B1_nzBiE.js","./tabs-VyDQ-WsJ.js","./index-xL9tDy8r.js","./dropdown-menu-DhUxXtWv.js","./alert-dialog-BwXlZ7hY.js","./VideoModal-w5Ot-7KI.js","./save-DZuHrrpv.js","./pen-line-DHrJReBO.js","./ProfileSettingsPage-DnVs4YJB.js","./switch-klIFyYmY.js","./crown-D1WD830B.js","./ProfileIcon-IxzO755X.js","./freeTrialService-u-lJSTVe.js","./broadcastService-BQWgcmoe.js","./bell-C-d1sJAh.js","./profitService-QTJQLMA0.js","./arrow-down-left-DcYD3MrR.js","./CashSummaryDialog-C52yFq-V.js","./battery-charging-BKlgE6-N.js","./CreditCardsDialog-CCiftUNp.js","./InstallmentModal-BmQdY6-Y.js","./SimCardsDialog-BmPZk43L.js","./wifi-bFidCAXd.js","./AdslCardsDialog-DnwdWQ1o.js","./MaintenanceDialog-nfkRI82d.js","./MachineDailyDialog-C6u48mG9.js","./WalletsManagement-BtpHhaWq.js","./WalletPrinterDialog-B3yID8sa.js","./WalletsListDialog-BjLLZll8.js","./PendingOperationsDialog-DHtlVqdx.js","./DailyArchiveHistoryDialog-BdBPcYco.js","./CashierShiftModal-DYko4Nf1.js","./functions-DxNA6i1h.js","./ShiftProfileDialog-BgmLjeqX.js","./ChangeLogDialog-DGhk6mEY.js","./sparkles-CZWxysoS.js","./dailyOperationCountService-BDMlwDJn.js"])))=>i.map(i=>d[i]);
import{a0 as As,R as Q,j as e,r as u,B as A,bG as Dp,bH as nh,al as ih,bI as kp,ae as vc,ag as Cp,aj as wn,ah as gr,ai as ds,bL as oh,bj as wc,bM as Ip,bO as Ap,bQ as _p,bP as Tp,bR as Pp,bS as Mp,bT as Op,bV as Ep,a4 as Ia,bx as jm,aU as yn,W as Me,t as F,$ as ra,E as wt,p as or,ci as Ns,a1 as fa,q as Ce,s as ie,aH as K,x as pe,u as Nc,a6 as lh,bN as Rp,b5 as lr,a8 as se,a7 as vt,K as mr,aa as ue,ab as me,ac as be,ad as he,aG as Wp,aA as Sm,ar as Jt,aT as aa,a_ as ch,m as to,H as Dm,y as Z,I as X,J as km,aD as Lp,a9 as dh,ak as Fp,bk as $p,bl as Bp,aI as Ze,aR as $e,O as Up,bb as cs,bA as Ka,aL as gc,cj as ec,a as Vp,ck as qp,aM as zp,cl as Yp,bd as Kp,X as Cm,V as ln,n as Jp,b9 as js,aN as le,aS as rr,w as Im,v as $i,aK as Am,cm as cn,bh as Hp,c as rs,d as Ss,e as Ds,ap as Sa,b1 as Bi,be as dn,g as ns,ay as Lt,cn as Qp,C as tc,S as Gp,b0 as Xp,F as un,aC as Zp,bZ as ex,U as mn,b2 as _m,aO as tx,ao as hn,b$ as ac,P as Ui,aq as Vi,b3 as qi,b8 as sc,a3 as Ba,M as rc,aF as zi,c0 as ax,c1 as sx,c2 as rx,c3 as nx,c4 as ix,D as fn,c5 as ox,c6 as Tm,an as ea,Y as Pm,a$ as gn,bW as lx,co as cx,cf as nc,cp as Mm,cq as dx}from"./index-DhbnydJl.js";import{A as ux,m as mx,a as uh,u as pn,f as ks,B as Om,C as hx,b as ic,S as Em,c as Rm}from"./SimCardsAccessDialog-Z5OgVyJn.js";import{C as Ki,V as mh}from"./VideoModal-w5Ot-7KI.js";import{C as fx,S as gx,P as px,a as xx,w as yx}from"./ProfileSettingsPage-DnVs4YJB.js";import{S as Wm,T as bx,a as vx,b as Lm,c as Fm}from"./tabs-VyDQ-WsJ.js";import{S as Va,a as qa,b as za,c as Ya,d as la,C as wx,e as Nx}from"./select-Bn8RCTk-.js";import{C as jx,D as Sx,a as Dx,b as kx,f as Cx}from"./dropdown-menu-DhUxXtWv.js";import{S as Ix}from"./switch-klIFyYmY.js";import{P as Ax}from"./ProfileIcon-IxzO755X.js";import{E as _x,a as Tx}from"./broadcastService-BQWgcmoe.js";import{B as Yi}from"./bell-C-d1sJAh.js";import{C as Xi}from"./circle-check-big-Dtvck6_a.js";import{ProfitService as Ja}from"./profitService-QTJQLMA0.js";import{C as Ji}from"./calendar-4dCWv1Gk.js";import{A as cr}from"./arrow-down-left-DcYD3MrR.js";import{D as Da}from"./dollar-sign-AUKMnGdi.js";import{c as hh,R as Px,I as Mx}from"./index-xL9tDy8r.js";import{FreeTrialService as $m}from"./freeTrialService-u-lJSTVe.js";import{W as nr}from"./wallet--cZcBirk.js";import{C as Ox}from"./crown-D1WD830B.js";import{S as Bm}from"./square-pen-CSLFtBCt.js";import{P as Ex}from"./printer-DeiqlOce.js";import{S as Rx}from"./star-BSPZIAqJ.js";import{C as Wx}from"./users-D9PlfCO2.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lx=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Um=As("calendar-days",Lx);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fx=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],$x=As("chevron-left",Fx);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bx=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Ux=As("circle-plus",Bx);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]],Vm=As("notebook",Vx);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qx=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],fh=As("package",qx);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zx=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],Yx=As("party-popper",zx);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kx=[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]],Jx=As("youtube",Kx);var Hi={linear:function(s,t,n,o){var l=n-t;return l*s/o+t},easeInQuad:function(s,t,n,o){var l=n-t;return l*(s/=o)*s+t},easeOutQuad:function(s,t,n,o){var l=n-t;return-l*(s/=o)*(s-2)+t},easeInOutQuad:function(s,t,n,o){var l=n-t;return(s/=o/2)<1?l/2*s*s+t:-l/2*(--s*(s-2)-1)+t},easeInCubic:function(s,t,n,o){var l=n-t;return l*(s/=o)*s*s+t},easeOutCubic:function(s,t,n,o){var l=n-t;return l*((s=s/o-1)*s*s+1)+t},easeInOutCubic:function(s,t,n,o){var l=n-t;return(s/=o/2)<1?l/2*s*s*s+t:l/2*((s-=2)*s*s+2)+t},easeInQuart:function(s,t,n,o){var l=n-t;return l*(s/=o)*s*s*s+t},easeOutQuart:function(s,t,n,o){var l=n-t;return-l*((s=s/o-1)*s*s*s-1)+t},easeInOutQuart:function(s,t,n,o){var l=n-t;return(s/=o/2)<1?l/2*s*s*s*s+t:-l/2*((s-=2)*s*s*s-2)+t},easeInQuint:function(s,t,n,o){var l=n-t;return l*(s/=o)*s*s*s*s+t},easeOutQuint:function(s,t,n,o){var l=n-t;return l*((s=s/o-1)*s*s*s*s+1)+t},easeInOutQuint:function(s,t,n,o){var l=n-t;return(s/=o/2)<1?l/2*s*s*s*s*s+t:l/2*((s-=2)*s*s*s*s+2)+t},easeInSine:function(s,t,n,o){var l=n-t;return-l*Math.cos(s/o*(Math.PI/2))+l+t},easeOutSine:function(s,t,n,o){var l=n-t;return l*Math.sin(s/o*(Math.PI/2))+t},easeInOutSine:function(s,t,n,o){var l=n-t;return-l/2*(Math.cos(Math.PI*s/o)-1)+t},easeInExpo:function(s,t,n,o){var l=n-t;return s==0?t:l*Math.pow(2,10*(s/o-1))+t},easeOutExpo:function(s,t,n,o){var l=n-t;return s==o?t+l:l*(-Math.pow(2,-10*s/o)+1)+t},easeInOutExpo:function(s,t,n,o){var l=n-t;return s===0?t:s===o?t+l:(s/=o/2)<1?l/2*Math.pow(2,10*(s-1))+t:l/2*(-Math.pow(2,-10*--s)+2)+t},easeInCirc:function(s,t,n,o){var l=n-t;return-l*(Math.sqrt(1-(s/=o)*s)-1)+t},easeOutCirc:function(s,t,n,o){var l=n-t;return l*Math.sqrt(1-(s=s/o-1)*s)+t},easeInOutCirc:function(s,t,n,o){var l=n-t;return(s/=o/2)<1?-l/2*(Math.sqrt(1-s*s)-1)+t:l/2*(Math.sqrt(1-(s-=2)*s)+1)+t},easeInElastic:function(s,t,n,o){var l=n-t,h,p,j;return j=1.70158,p=0,h=l,s===0?t:(s/=o)===1?t+l:(p||(p=o*.3),h<Math.abs(l)?(h=l,j=p/4):j=p/(2*Math.PI)*Math.asin(l/h),-(h*Math.pow(2,10*(s-=1))*Math.sin((s*o-j)*(2*Math.PI)/p))+t)},easeOutElastic:function(s,t,n,o){var l=n-t,h,p,j;return j=1.70158,p=0,h=l,s===0?t:(s/=o)===1?t+l:(p||(p=o*.3),h<Math.abs(l)?(h=l,j=p/4):j=p/(2*Math.PI)*Math.asin(l/h),h*Math.pow(2,-10*s)*Math.sin((s*o-j)*(2*Math.PI)/p)+l+t)},easeInOutElastic:function(s,t,n,o){var l=n-t,h,p,j;return j=1.70158,p=0,h=l,s===0?t:(s/=o/2)===2?t+l:(p||(p=o*(.3*1.5)),h<Math.abs(l)?(h=l,j=p/4):j=p/(2*Math.PI)*Math.asin(l/h),s<1?-.5*(h*Math.pow(2,10*(s-=1))*Math.sin((s*o-j)*(2*Math.PI)/p))+t:h*Math.pow(2,-10*(s-=1))*Math.sin((s*o-j)*(2*Math.PI)/p)*.5+l+t)},easeInBack:function(s,t,n,o,l){var h=n-t;return l===void 0&&(l=1.70158),h*(s/=o)*s*((l+1)*s-l)+t},easeOutBack:function(s,t,n,o,l){var h=n-t;return l===void 0&&(l=1.70158),h*((s=s/o-1)*s*((l+1)*s+l)+1)+t},easeInOutBack:function(s,t,n,o,l){var h=n-t;return l===void 0&&(l=1.70158),(s/=o/2)<1?h/2*(s*s*(((l*=1.525)+1)*s-l))+t:h/2*((s-=2)*s*(((l*=1.525)+1)*s+l)+2)+t},easeInBounce:function(s,t,n,o){var l=n-t,h;return h=Hi.easeOutBounce(o-s,0,l,o),l-h+t},easeOutBounce:function(s,t,n,o){var l=n-t;return(s/=o)<1/2.75?l*(7.5625*s*s)+t:s<2/2.75?l*(7.5625*(s-=1.5/2.75)*s+.75)+t:s<2.5/2.75?l*(7.5625*(s-=2.25/2.75)*s+.9375)+t:l*(7.5625*(s-=2.625/2.75)*s+.984375)+t},easeInOutBounce:function(s,t,n,o){var l=n-t,h;return s<o/2?(h=Hi.easeInBounce(s*2,0,l,o),h*.5+t):(h=Hi.easeOutBounce(s*2-o,0,l,o),h*.5+l*.5+t)}},Hx=Hi;function Qx(s){return s*Math.PI/180}function sa(s,t){return s+Math.random()*(t-s)}function Gx(s,t){return Math.floor(s+Math.random()*(t-s+1))}var bn;(function(s){s[s.Circle=0]="Circle",s[s.Square=1]="Square",s[s.Strip=2]="Strip"})(bn||(bn={}));var ls;(function(s){s[s.Positive=1]="Positive",s[s.Negative=-1]="Negative"})(ls||(ls={}));const Xx=1e3/60;class Zx{constructor(t,n,o,l){this.getOptions=n;const{colors:h,initialVelocityX:p,initialVelocityY:j}=this.getOptions();this.context=t,this.x=o,this.y=l,this.w=sa(5,20),this.h=sa(5,20),this.radius=sa(5,10),this.vx=typeof p=="number"?sa(-p,p):sa(p.min,p.max),this.vy=typeof j=="number"?sa(-j,0):sa(j.min,j.max),this.shape=Gx(0,2),this.angle=Qx(sa(0,360)),this.angularSpin=sa(-.2,.2),this.color=h[Math.floor(Math.random()*h.length)],this.rotateY=sa(0,1),this.rotationDirection=sa(0,1)?ls.Positive:ls.Negative}update(t){const{gravity:n,wind:o,friction:l,opacity:h,drawShape:p}=this.getOptions(),j=t/Xx;this.x+=this.vx*j,this.y+=this.vy*j,this.vy+=n*j,this.vx+=o*j,this.vx*=l**j,this.vy*=l**j,this.rotateY>=1&&this.rotationDirection===ls.Positive?this.rotationDirection=ls.Negative:this.rotateY<=-1&&this.rotationDirection===ls.Negative&&(this.rotationDirection=ls.Positive);const C=.1*this.rotationDirection*j;if(this.rotateY+=C,this.angle+=this.angularSpin,this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(this.angle),this.context.scale(1,this.rotateY),this.context.rotate(this.angle),this.context.beginPath(),this.context.fillStyle=this.color,this.context.strokeStyle=this.color,this.context.globalAlpha=h,this.context.lineCap="round",this.context.lineWidth=2,p&&typeof p=="function")p.call(this,this.context);else switch(this.shape){case bn.Circle:{this.context.beginPath(),this.context.arc(0,0,this.radius,0,2*Math.PI),this.context.fill();break}case bn.Square:{this.context.fillRect(-this.w/2,-this.h/2,this.w,this.h);break}case bn.Strip:{this.context.fillRect(-this.w/6,-this.h/2,this.w/3,this.h);break}}this.context.closePath(),this.context.restore()}}class ey{constructor(t,n){this.x=0,this.y=0,this.w=0,this.h=0,this.lastNumberOfPieces=0,this.tweenProgress=0,this.tweenFrom=0,this.particles=[],this.particlesGenerated=0,this.removeParticleAt=l=>{this.particles.splice(l,1)},this.getParticle=()=>{const l=sa(this.x,this.w+this.x),h=sa(this.y,this.h+this.y);return new Zx(this.context,this.getOptions,l,h)},this.animate=l=>{const{canvas:h,context:p,particlesGenerated:j,lastNumberOfPieces:C}=this,{run:D,recycle:k,numberOfPieces:T,debug:E,tweenFunction:O,tweenDuration:U}=this.getOptions();if(!D)return!1;const w=this.particles.length,$=k?w:j;if($<T){C!==T&&(this.tweenProgress=0,this.tweenFrom=$,this.lastNumberOfPieces=T),this.tweenProgress=Math.min(U,Math.max(0,this.tweenProgress+l));const ce=O(this.tweenProgress,this.tweenFrom,T,U),ee=Math.round(ce-$);for(let q=0;q<ee;q++)this.particles.push(this.getParticle());this.particlesGenerated+=ee}E&&(p.font="12px sans-serif",p.fillStyle="#333",p.textAlign="right",p.fillText(`Particles: ${w}`,h.width-10,h.height-20));for(let ce=this.particles.length-1;ce>=0;ce--){const ee=this.particles[ce];ee.update(l),(ee.y>h.height||ee.y<-100||ee.x>h.width+100||ee.x<-100)&&(k&&$<=T?this.particles[ce]=this.getParticle():this.removeParticleAt(ce))}return w>0||$<T},this.canvas=t;const o=this.canvas.getContext("2d");if(!o)throw new Error("Could not get canvas context");this.context=o,this.getOptions=n}}const jc={width:typeof window<"u"?window.innerWidth:300,height:typeof window<"u"?window.innerHeight:200,numberOfPieces:200,friction:.99,wind:0,gravity:.1,initialVelocityX:4,initialVelocityY:10,colors:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"],opacity:1,debug:!1,tweenFunction:Hx.easeInOutQuad,tweenDuration:5e3,recycle:!0,run:!0};class ty{constructor(t,n){this.lastFrameTime=0,this.setOptionsWithDefaults=l=>{const h={confettiSource:{x:0,y:0,w:this.canvas.width,h:0}};this._options={...h,...jc,...l},Object.assign(this,l.confettiSource)},this.update=(l=0)=>{const{options:{run:h,onConfettiComplete:p,frameRate:j},canvas:C,context:D}=this,k=Math.min(l-this.lastFrameTime,50);if(j&&k<1e3/j){this.rafId=requestAnimationFrame(this.update);return}this.lastFrameTime=l-(j?k%j:0),h&&(D.fillStyle="white",D.clearRect(0,0,C.width,C.height)),this.generator.animate(k)?this.rafId=requestAnimationFrame(this.update):(p&&typeof p=="function"&&this.generator.particlesGenerated>0&&p.call(this,this),this._options.run=!1)},this.reset=()=>{this.generator&&this.generator.particlesGenerated>0&&(this.generator.particlesGenerated=0,this.generator.particles=[],this.generator.lastNumberOfPieces=0)},this.stop=()=>{this.options={run:!1},this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0)},this.canvas=t;const o=this.canvas.getContext("2d");if(!o)throw new Error("Could not get canvas context");this.context=o,this.generator=new ey(this.canvas,()=>this.options),this.options=n,this.update()}get options(){return this._options}set options(t){var l,h;const n=(l=this._options)==null?void 0:l.run,o=(h=this._options)==null?void 0:h.recycle;this.setOptionsWithDefaults(t),this.generator&&(Object.assign(this.generator,this.options.confettiSource),typeof t.recycle=="boolean"&&t.recycle&&o===!1&&(this.generator.lastNumberOfPieces=this.generator.particles.length)),typeof t.run=="boolean"&&t.run&&n===!1&&this.update()}}const ay=Q.createRef();class Sc extends Q.Component{constructor(t){super(t),this.canvas=Q.createRef(),this.canvas=t.canvasRef||ay}componentDidMount(){if(this.canvas.current){const t=oc(this.props)[0];this.confetti=new ty(this.canvas.current,t)}}componentDidUpdate(){const t=oc(this.props)[0];this.confetti&&(this.confetti.options=t)}componentWillUnmount(){this.confetti&&this.confetti.stop(),this.confetti=void 0}render(){const[t,n]=oc(this.props),o={zIndex:2,position:"absolute",pointerEvents:"none",top:0,left:0,bottom:0,right:0,...n.style};return e.jsx("canvas",{width:t.width,height:t.height,ref:this.canvas,...n,style:o})}}Sc.defaultProps={...jc};Sc.displayName="ReactConfetti";function oc(s){const t={},n={},o={},l=[...Object.keys(jc),"confettiSource","drawShape","onConfettiComplete","frameRate"],h=["canvasRef"];for(const p in s){const j=s[p];l.includes(p)?t[p]=j:h.includes(p)?h[p]=j:o[p]=j}return[t,o,n]}const sy=Q.forwardRef((s,t)=>e.jsx(Sc,{canvasRef:t,...s})),ry=({isOpen:s,onClose:t,userName:n})=>{const[o,l]=u.useState({width:window.innerWidth,height:window.innerHeight});return u.useEffect(()=>{const h=()=>{l({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]),e.jsx(ux,{children:s&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:[e.jsx(sy,{width:o.width,height:o.height,recycle:!0,numberOfPieces:200,gravity:.15}),e.jsxs(mx.div,{initial:{scale:.5,opacity:0,y:50},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0},transition:{type:"spring",duration:.8,bounce:.5},className:"relative w-full max-w-lg bg-white dark:bg-slate-900 rounded-3xl shadow-2xl overflow-hidden border-4 border-indigo-100 dark:border-indigo-900",children:[e.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-purple-200 dark:bg-purple-900/30 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-32 h-32 bg-blue-200 dark:bg-blue-900/30 rounded-full blur-3xl translate-x-1/2 translate-y-1/2"}),e.jsxs("div",{className:"relative p-8 text-center space-y-6",children:[e.jsx("div",{className:"mx-auto w-24 h-24 bg-gradient-to-tr from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-4 ring-4 ring-white dark:ring-slate-800",children:e.jsx(Yx,{className:"w-12 h-12 text-white animate-bounce"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-3xl font-extrabold leading-tight bg-clip-text text-transparent bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 dark:from-indigo-400 dark:via-purple-400 dark:to-pink-400",children:["Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¹Ø§Ø¦Ù„Ø©",e.jsx("br",{}),e.jsx("span",{className:"text-4xl",children:"Cashy Link! ðŸš€"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xl text-gray-800 dark:text-gray-200 font-bold",children:n?`Ø£Ù‡Ù„Ø§Ù‹ ${n}ØŒ`:""}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 font-medium",children:"Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ ØªØ¬Ø±Ø¨Ø© Ø³Ø¹ÙŠØ¯Ø© ÙˆÙ…Ù…ÙŠØ²Ø© Ù…Ø¹Ù†Ø§."})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-slate-800/50 p-4 rounded-xl border border-gray-100 dark:border-slate-800",children:"Ù„Ù‚Ø¯ Ø£ØµØ¨Ø­Øª Ø§Ù„Ø¢Ù† Ø¬Ø²Ø¡Ø§Ù‹ Ù…Ù† Ù…Ø¬ØªÙ…Ø¹Ù†Ø§ Ø§Ù„Ù…Ù…ÙŠØ². Ø§Ø³ØªÙ…ØªØ¹ Ø¨ÙƒÙ„ Ø§Ù„Ù…Ø²Ø§ÙŠØ§ Ø§Ù„Ø­ØµØ±ÙŠØ© Ø§Ù„ØªÙŠ Ù†Ù‚Ø¯Ù…Ù‡Ø§ Ù„Ùƒ!"})]}),e.jsx("div",{className:"pt-2",children:e.jsx(A,{onClick:t,size:"lg",className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-6 rounded-xl text-lg shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 active:translate-y-0",children:"Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø¢Ù†"})})]})]})]})})};function ny(s){const t=iy(s),n=u.forwardRef((o,l)=>{const{children:h,...p}=o,j=u.Children.toArray(h),C=j.find(ly);if(C){const D=C.props.children,k=j.map(T=>T===C?u.Children.count(D)>1?u.Children.only(null):u.isValidElement(D)?D.props.children:null:T);return e.jsx(t,{...p,ref:l,children:u.isValidElement(D)?u.cloneElement(D,void 0,k):null})}return e.jsx(t,{...p,ref:l,children:h})});return n.displayName=`${s}.Slot`,n}function iy(s){const t=u.forwardRef((n,o)=>{const{children:l,...h}=n;if(u.isValidElement(l)){const p=dy(l),j=cy(h,l.props);return l.type!==u.Fragment&&(j.ref=o?Dp(o,p):p),u.cloneElement(l,j)}return u.Children.count(l)>1?u.Children.only(null):null});return t.displayName=`${s}.SlotClone`,t}var oy=Symbol("radix.slottable");function ly(s){return u.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===oy}function cy(s,t){const n={...t};for(const o in t){const l=s[o],h=t[o];/^on[A-Z]/.test(o)?l&&h?n[o]=(...j)=>{const C=h(...j);return l(...j),C}:l&&(n[o]=l):o==="style"?n[o]={...l,...h}:o==="className"&&(n[o]=[l,h].filter(Boolean).join(" "))}return{...s,...n}}function dy(s){var o,l;let t=(o=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?s.ref:(t=(l=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:l.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?s.props.ref:s.props.ref||s.ref)}var ao="Popover",[gh]=vc(ao,[nh]),Nn=nh(),[uy,us]=gh(ao),ph=s=>{const{__scopePopover:t,children:n,open:o,defaultOpen:l,onOpenChange:h,modal:p=!1}=s,j=Nn(t),C=u.useRef(null),[D,k]=u.useState(!1),[T,E]=ih({prop:o,defaultProp:l??!1,onChange:h,caller:ao});return e.jsx(kp,{...j,children:e.jsx(uy,{scope:t,contentId:Cp(),triggerRef:C,open:T,onOpenChange:E,onOpenToggle:u.useCallback(()=>E(O=>!O),[E]),hasCustomAnchor:D,onCustomAnchorAdd:u.useCallback(()=>k(!0),[]),onCustomAnchorRemove:u.useCallback(()=>k(!1),[]),modal:p,children:n})})};ph.displayName=ao;var xh="PopoverAnchor",my=u.forwardRef((s,t)=>{const{__scopePopover:n,...o}=s,l=us(xh,n),h=Nn(n),{onCustomAnchorAdd:p,onCustomAnchorRemove:j}=l;return u.useEffect(()=>(p(),()=>j()),[p,j]),e.jsx(oh,{...h,...o,ref:t})});my.displayName=xh;var yh="PopoverTrigger",bh=u.forwardRef((s,t)=>{const{__scopePopover:n,...o}=s,l=us(yh,n),h=Nn(n),p=wn(t,l.triggerRef),j=e.jsx(gr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":l.open,"aria-controls":l.contentId,"data-state":Sh(l.open),...o,ref:p,onClick:ds(s.onClick,l.onOpenToggle)});return l.hasCustomAnchor?j:e.jsx(oh,{asChild:!0,...h,children:j})});bh.displayName=yh;var Dc="PopoverPortal",[hy,fy]=gh(Dc,{forceMount:void 0}),vh=s=>{const{__scopePopover:t,forceMount:n,children:o,container:l}=s,h=us(Dc,t);return e.jsx(hy,{scope:t,forceMount:n,children:e.jsx(wc,{present:n||h.open,children:e.jsx(Ip,{asChild:!0,container:l,children:o})})})};vh.displayName=Dc;var hr="PopoverContent",wh=u.forwardRef((s,t)=>{const n=fy(hr,s.__scopePopover),{forceMount:o=n.forceMount,...l}=s,h=us(hr,s.__scopePopover);return e.jsx(wc,{present:o||h.open,children:h.modal?e.jsx(py,{...l,ref:t}):e.jsx(xy,{...l,ref:t})})});wh.displayName=hr;var gy=ny("PopoverContent.RemoveScroll"),py=u.forwardRef((s,t)=>{const n=us(hr,s.__scopePopover),o=u.useRef(null),l=wn(t,o),h=u.useRef(!1);return u.useEffect(()=>{const p=o.current;if(p)return Ap(p)},[]),e.jsx(_p,{as:gy,allowPinchZoom:!0,children:e.jsx(Nh,{...s,ref:l,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ds(s.onCloseAutoFocus,p=>{var j;p.preventDefault(),h.current||(j=n.triggerRef.current)==null||j.focus()}),onPointerDownOutside:ds(s.onPointerDownOutside,p=>{const j=p.detail.originalEvent,C=j.button===0&&j.ctrlKey===!0,D=j.button===2||C;h.current=D},{checkForDefaultPrevented:!1}),onFocusOutside:ds(s.onFocusOutside,p=>p.preventDefault(),{checkForDefaultPrevented:!1})})})}),xy=u.forwardRef((s,t)=>{const n=us(hr,s.__scopePopover),o=u.useRef(!1),l=u.useRef(!1);return e.jsx(Nh,{...s,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:h=>{var p,j;(p=s.onCloseAutoFocus)==null||p.call(s,h),h.defaultPrevented||(o.current||(j=n.triggerRef.current)==null||j.focus(),h.preventDefault()),o.current=!1,l.current=!1},onInteractOutside:h=>{var C,D;(C=s.onInteractOutside)==null||C.call(s,h),h.defaultPrevented||(o.current=!0,h.detail.originalEvent.type==="pointerdown"&&(l.current=!0));const p=h.target;((D=n.triggerRef.current)==null?void 0:D.contains(p))&&h.preventDefault(),h.detail.originalEvent.type==="focusin"&&l.current&&h.preventDefault()}})}),Nh=u.forwardRef((s,t)=>{const{__scopePopover:n,trapFocus:o,onOpenAutoFocus:l,onCloseAutoFocus:h,disableOutsidePointerEvents:p,onEscapeKeyDown:j,onPointerDownOutside:C,onFocusOutside:D,onInteractOutside:k,...T}=s,E=us(hr,n),O=Nn(n);return Tp(),e.jsx(Pp,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:l,onUnmountAutoFocus:h,children:e.jsx(Mp,{asChild:!0,disableOutsidePointerEvents:p,onInteractOutside:k,onEscapeKeyDown:j,onPointerDownOutside:C,onFocusOutside:D,onDismiss:()=>E.onOpenChange(!1),children:e.jsx(Op,{"data-state":Sh(E.open),role:"dialog",id:E.contentId,...O,...T,ref:t,style:{...T.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),jh="PopoverClose",yy=u.forwardRef((s,t)=>{const{__scopePopover:n,...o}=s,l=us(jh,n);return e.jsx(gr.button,{type:"button",...o,ref:t,onClick:ds(s.onClick,()=>l.onOpenChange(!1))})});yy.displayName=jh;var by="PopoverArrow",vy=u.forwardRef((s,t)=>{const{__scopePopover:n,...o}=s,l=Nn(n);return e.jsx(Ep,{...l,...o,ref:t})});vy.displayName=by;function Sh(s){return s?"open":"closed"}var wy=ph,Ny=bh,jy=vh,Dh=wh;const qm=wy,zm=Ny,pc=u.forwardRef(({className:s,align:t="center",sideOffset:n=4,...o},l)=>e.jsx(jy,{children:e.jsx(Dh,{ref:l,align:t,sideOffset:n,className:Ia("z-[9999] w-72 rounded-xl border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...o})}));pc.displayName=Dh.displayName;function Be(s){const t=Object.prototype.toString.call(s);return s instanceof Date||typeof s=="object"&&t==="[object Date]"?new s.constructor(+s):typeof s=="number"||t==="[object Number]"||typeof s=="string"||t==="[object String]"?new Date(s):new Date(NaN)}function na(s,t){return s instanceof Date?new s.constructor(t):new Date(t)}function Vt(s,t){const n=Be(s);return isNaN(t)?na(s,NaN):(t&&n.setDate(n.getDate()+t),n)}function pa(s,t){const n=Be(s);if(isNaN(t))return na(s,NaN);if(!t)return n;const o=n.getDate(),l=na(s,n.getTime());l.setMonth(n.getMonth()+t+1,0);const h=l.getDate();return o>=h?l:(n.setFullYear(l.getFullYear(),l.getMonth(),o),n)}const kc=6048e5,Sy=864e5;let Dy={};function jn(){return Dy}function _a(s,t){var j,C,D,k;const n=jn(),o=(t==null?void 0:t.weekStartsOn)??((C=(j=t==null?void 0:t.locale)==null?void 0:j.options)==null?void 0:C.weekStartsOn)??n.weekStartsOn??((k=(D=n.locale)==null?void 0:D.options)==null?void 0:k.weekStartsOn)??0,l=Be(s),h=l.getDay(),p=(h<o?7:0)+h-o;return l.setDate(l.getDate()-p),l.setHours(0,0,0,0),l}function Is(s){return _a(s,{weekStartsOn:1})}function kh(s){const t=Be(s),n=t.getFullYear(),o=na(s,0);o.setFullYear(n+1,0,4),o.setHours(0,0,0,0);const l=Is(o),h=na(s,0);h.setFullYear(n,0,4),h.setHours(0,0,0,0);const p=Is(h);return t.getTime()>=l.getTime()?n+1:t.getTime()>=p.getTime()?n:n-1}function fr(s){const t=Be(s);return t.setHours(0,0,0,0),t}function Zi(s){const t=Be(s),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+s-+n}function Aa(s,t){const n=fr(s),o=fr(t),l=+n-Zi(n),h=+o-Zi(o);return Math.round((l-h)/Sy)}function ky(s){const t=kh(s),n=na(s,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),Is(n)}function xc(s,t){const n=t*7;return Vt(s,n)}function Cy(s,t){return pa(s,t*12)}function Iy(s){let t;return s.forEach(function(n){const o=Be(n);(t===void 0||t<o||isNaN(Number(o)))&&(t=o)}),t||new Date(NaN)}function Ay(s){let t;return s.forEach(n=>{const o=Be(n);(!t||t>o||isNaN(+o))&&(t=o)}),t||new Date(NaN)}function Ht(s,t){const n=fr(s),o=fr(t);return+n==+o}function Cc(s){return s instanceof Date||typeof s=="object"&&Object.prototype.toString.call(s)==="[object Date]"}function _y(s){if(!Cc(s)&&typeof s!="number")return!1;const t=Be(s);return!isNaN(Number(t))}function vn(s,t){const n=Be(s),o=Be(t),l=n.getFullYear()-o.getFullYear(),h=n.getMonth()-o.getMonth();return l*12+h}function Ty(s,t,n){const o=_a(s,n),l=_a(t,n),h=+o-Zi(o),p=+l-Zi(l);return Math.round((h-p)/kc)}function Ic(s){const t=Be(s),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Qt(s){const t=Be(s);return t.setDate(1),t.setHours(0,0,0,0),t}function Ch(s){const t=Be(s),n=na(s,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Ac(s,t){var j,C,D,k;const n=jn(),o=(t==null?void 0:t.weekStartsOn)??((C=(j=t==null?void 0:t.locale)==null?void 0:j.options)==null?void 0:C.weekStartsOn)??n.weekStartsOn??((k=(D=n.locale)==null?void 0:D.options)==null?void 0:k.weekStartsOn)??0,l=Be(s),h=l.getDay(),p=(h<o?-7:0)+6-(h-o);return l.setDate(l.getDate()+p),l.setHours(23,59,59,999),l}function Ih(s){return Ac(s,{weekStartsOn:1})}const Py={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},My=(s,t,n)=>{let o;const l=Py[s];return typeof l=="string"?o=l:t===1?o=l.one:o=l.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+o:o+" ago":o};function ur(s){return(t={})=>{const n=t.width?String(t.width):s.defaultWidth;return s.formats[n]||s.formats[s.defaultWidth]}}const Oy={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Ey={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Ry={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Wy={date:ur({formats:Oy,defaultWidth:"full"}),time:ur({formats:Ey,defaultWidth:"full"}),dateTime:ur({formats:Ry,defaultWidth:"full"})},Ly={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Fy=(s,t,n,o)=>Ly[s];function ka(s){return(t,n)=>{const o=n!=null&&n.context?String(n.context):"standalone";let l;if(o==="formatting"&&s.formattingValues){const p=s.defaultFormattingWidth||s.defaultWidth,j=n!=null&&n.width?String(n.width):p;l=s.formattingValues[j]||s.formattingValues[p]}else{const p=s.defaultWidth,j=n!=null&&n.width?String(n.width):s.defaultWidth;l=s.values[j]||s.values[p]}const h=s.argumentCallback?s.argumentCallback(t):t;return l[h]}}const $y={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},By={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Uy={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Vy={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},qy={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},zy={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Yy=(s,t)=>{const n=Number(s),o=n%100;if(o>20||o<10)switch(o%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Ky={ordinalNumber:Yy,era:ka({values:$y,defaultWidth:"wide"}),quarter:ka({values:By,defaultWidth:"wide",argumentCallback:s=>s-1}),month:ka({values:Uy,defaultWidth:"wide"}),day:ka({values:Vy,defaultWidth:"wide"}),dayPeriod:ka({values:qy,defaultWidth:"wide",formattingValues:zy,defaultFormattingWidth:"wide"})};function Ca(s){return(t,n={})=>{const o=n.width,l=o&&s.matchPatterns[o]||s.matchPatterns[s.defaultMatchWidth],h=t.match(l);if(!h)return null;const p=h[0],j=o&&s.parsePatterns[o]||s.parsePatterns[s.defaultParseWidth],C=Array.isArray(j)?Hy(j,T=>T.test(p)):Jy(j,T=>T.test(p));let D;D=s.valueCallback?s.valueCallback(C):C,D=n.valueCallback?n.valueCallback(D):D;const k=t.slice(p.length);return{value:D,rest:k}}}function Jy(s,t){for(const n in s)if(Object.prototype.hasOwnProperty.call(s,n)&&t(s[n]))return n}function Hy(s,t){for(let n=0;n<s.length;n++)if(t(s[n]))return n}function Ah(s){return(t,n={})=>{const o=t.match(s.matchPattern);if(!o)return null;const l=o[0],h=t.match(s.parsePattern);if(!h)return null;let p=s.valueCallback?s.valueCallback(h[0]):h[0];p=n.valueCallback?n.valueCallback(p):p;const j=t.slice(l.length);return{value:p,rest:j}}}const Qy=/^(\d+)(th|st|nd|rd)?/i,Gy=/\d+/i,Xy={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Zy={any:[/^b/i,/^(a|c)/i]},eb={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},tb={any:[/1/i,/2/i,/3/i,/4/i]},ab={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},sb={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},rb={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},nb={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},ib={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ob={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},lb={ordinalNumber:Ah({matchPattern:Qy,parsePattern:Gy,valueCallback:s=>parseInt(s,10)}),era:Ca({matchPatterns:Xy,defaultMatchWidth:"wide",parsePatterns:Zy,defaultParseWidth:"any"}),quarter:Ca({matchPatterns:eb,defaultMatchWidth:"wide",parsePatterns:tb,defaultParseWidth:"any",valueCallback:s=>s+1}),month:Ca({matchPatterns:ab,defaultMatchWidth:"wide",parsePatterns:sb,defaultParseWidth:"any"}),day:Ca({matchPatterns:rb,defaultMatchWidth:"wide",parsePatterns:nb,defaultParseWidth:"any"}),dayPeriod:Ca({matchPatterns:ib,defaultMatchWidth:"any",parsePatterns:ob,defaultParseWidth:"any"})},_h={code:"en-US",formatDistance:My,formatLong:Wy,formatRelative:Fy,localize:Ky,match:lb,options:{weekStartsOn:0,firstWeekContainsDate:1}};function cb(s){const t=Be(s);return Aa(t,Ch(t))+1}function Th(s){const t=Be(s),n=+Is(t)-+ky(t);return Math.round(n/kc)+1}function Ph(s,t){var k,T,E,O;const n=Be(s),o=n.getFullYear(),l=jn(),h=(t==null?void 0:t.firstWeekContainsDate)??((T=(k=t==null?void 0:t.locale)==null?void 0:k.options)==null?void 0:T.firstWeekContainsDate)??l.firstWeekContainsDate??((O=(E=l.locale)==null?void 0:E.options)==null?void 0:O.firstWeekContainsDate)??1,p=na(s,0);p.setFullYear(o+1,0,h),p.setHours(0,0,0,0);const j=_a(p,t),C=na(s,0);C.setFullYear(o,0,h),C.setHours(0,0,0,0);const D=_a(C,t);return n.getTime()>=j.getTime()?o+1:n.getTime()>=D.getTime()?o:o-1}function db(s,t){var j,C,D,k;const n=jn(),o=(t==null?void 0:t.firstWeekContainsDate)??((C=(j=t==null?void 0:t.locale)==null?void 0:j.options)==null?void 0:C.firstWeekContainsDate)??n.firstWeekContainsDate??((k=(D=n.locale)==null?void 0:D.options)==null?void 0:k.firstWeekContainsDate)??1,l=Ph(s,t),h=na(s,0);return h.setFullYear(l,0,o),h.setHours(0,0,0,0),_a(h,t)}function Mh(s,t){const n=Be(s),o=+_a(n,t)-+db(n,t);return Math.round(o/kc)+1}function Ye(s,t){const n=s<0?"-":"",o=Math.abs(s).toString().padStart(t,"0");return n+o}const is={y(s,t){const n=s.getFullYear(),o=n>0?n:1-n;return Ye(t==="yy"?o%100:o,t.length)},M(s,t){const n=s.getMonth();return t==="M"?String(n+1):Ye(n+1,2)},d(s,t){return Ye(s.getDate(),t.length)},a(s,t){const n=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(s,t){return Ye(s.getHours()%12||12,t.length)},H(s,t){return Ye(s.getHours(),t.length)},m(s,t){return Ye(s.getMinutes(),t.length)},s(s,t){return Ye(s.getSeconds(),t.length)},S(s,t){const n=t.length,o=s.getMilliseconds(),l=Math.trunc(o*Math.pow(10,n-3));return Ye(l,t.length)}},ir={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ym={G:function(s,t,n){const o=s.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(o,{width:"abbreviated"});case"GGGGG":return n.era(o,{width:"narrow"});case"GGGG":default:return n.era(o,{width:"wide"})}},y:function(s,t,n){if(t==="yo"){const o=s.getFullYear(),l=o>0?o:1-o;return n.ordinalNumber(l,{unit:"year"})}return is.y(s,t)},Y:function(s,t,n,o){const l=Ph(s,o),h=l>0?l:1-l;if(t==="YY"){const p=h%100;return Ye(p,2)}return t==="Yo"?n.ordinalNumber(h,{unit:"year"}):Ye(h,t.length)},R:function(s,t){const n=kh(s);return Ye(n,t.length)},u:function(s,t){const n=s.getFullYear();return Ye(n,t.length)},Q:function(s,t,n){const o=Math.ceil((s.getMonth()+1)/3);switch(t){case"Q":return String(o);case"QQ":return Ye(o,2);case"Qo":return n.ordinalNumber(o,{unit:"quarter"});case"QQQ":return n.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(o,{width:"wide",context:"formatting"})}},q:function(s,t,n){const o=Math.ceil((s.getMonth()+1)/3);switch(t){case"q":return String(o);case"qq":return Ye(o,2);case"qo":return n.ordinalNumber(o,{unit:"quarter"});case"qqq":return n.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(o,{width:"wide",context:"standalone"})}},M:function(s,t,n){const o=s.getMonth();switch(t){case"M":case"MM":return is.M(s,t);case"Mo":return n.ordinalNumber(o+1,{unit:"month"});case"MMM":return n.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(o,{width:"wide",context:"formatting"})}},L:function(s,t,n){const o=s.getMonth();switch(t){case"L":return String(o+1);case"LL":return Ye(o+1,2);case"Lo":return n.ordinalNumber(o+1,{unit:"month"});case"LLL":return n.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(o,{width:"wide",context:"standalone"})}},w:function(s,t,n,o){const l=Mh(s,o);return t==="wo"?n.ordinalNumber(l,{unit:"week"}):Ye(l,t.length)},I:function(s,t,n){const o=Th(s);return t==="Io"?n.ordinalNumber(o,{unit:"week"}):Ye(o,t.length)},d:function(s,t,n){return t==="do"?n.ordinalNumber(s.getDate(),{unit:"date"}):is.d(s,t)},D:function(s,t,n){const o=cb(s);return t==="Do"?n.ordinalNumber(o,{unit:"dayOfYear"}):Ye(o,t.length)},E:function(s,t,n){const o=s.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(o,{width:"short",context:"formatting"});case"EEEE":default:return n.day(o,{width:"wide",context:"formatting"})}},e:function(s,t,n,o){const l=s.getDay(),h=(l-o.weekStartsOn+8)%7||7;switch(t){case"e":return String(h);case"ee":return Ye(h,2);case"eo":return n.ordinalNumber(h,{unit:"day"});case"eee":return n.day(l,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(l,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(l,{width:"short",context:"formatting"});case"eeee":default:return n.day(l,{width:"wide",context:"formatting"})}},c:function(s,t,n,o){const l=s.getDay(),h=(l-o.weekStartsOn+8)%7||7;switch(t){case"c":return String(h);case"cc":return Ye(h,t.length);case"co":return n.ordinalNumber(h,{unit:"day"});case"ccc":return n.day(l,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(l,{width:"narrow",context:"standalone"});case"cccccc":return n.day(l,{width:"short",context:"standalone"});case"cccc":default:return n.day(l,{width:"wide",context:"standalone"})}},i:function(s,t,n){const o=s.getDay(),l=o===0?7:o;switch(t){case"i":return String(l);case"ii":return Ye(l,t.length);case"io":return n.ordinalNumber(l,{unit:"day"});case"iii":return n.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(o,{width:"short",context:"formatting"});case"iiii":default:return n.day(o,{width:"wide",context:"formatting"})}},a:function(s,t,n){const l=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(l,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(l,{width:"wide",context:"formatting"})}},b:function(s,t,n){const o=s.getHours();let l;switch(o===12?l=ir.noon:o===0?l=ir.midnight:l=o/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(l,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(l,{width:"wide",context:"formatting"})}},B:function(s,t,n){const o=s.getHours();let l;switch(o>=17?l=ir.evening:o>=12?l=ir.afternoon:o>=4?l=ir.morning:l=ir.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(l,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(l,{width:"wide",context:"formatting"})}},h:function(s,t,n){if(t==="ho"){let o=s.getHours()%12;return o===0&&(o=12),n.ordinalNumber(o,{unit:"hour"})}return is.h(s,t)},H:function(s,t,n){return t==="Ho"?n.ordinalNumber(s.getHours(),{unit:"hour"}):is.H(s,t)},K:function(s,t,n){const o=s.getHours()%12;return t==="Ko"?n.ordinalNumber(o,{unit:"hour"}):Ye(o,t.length)},k:function(s,t,n){let o=s.getHours();return o===0&&(o=24),t==="ko"?n.ordinalNumber(o,{unit:"hour"}):Ye(o,t.length)},m:function(s,t,n){return t==="mo"?n.ordinalNumber(s.getMinutes(),{unit:"minute"}):is.m(s,t)},s:function(s,t,n){return t==="so"?n.ordinalNumber(s.getSeconds(),{unit:"second"}):is.s(s,t)},S:function(s,t){return is.S(s,t)},X:function(s,t,n){const o=s.getTimezoneOffset();if(o===0)return"Z";switch(t){case"X":return Jm(o);case"XXXX":case"XX":return Cs(o);case"XXXXX":case"XXX":default:return Cs(o,":")}},x:function(s,t,n){const o=s.getTimezoneOffset();switch(t){case"x":return Jm(o);case"xxxx":case"xx":return Cs(o);case"xxxxx":case"xxx":default:return Cs(o,":")}},O:function(s,t,n){const o=s.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Km(o,":");case"OOOO":default:return"GMT"+Cs(o,":")}},z:function(s,t,n){const o=s.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Km(o,":");case"zzzz":default:return"GMT"+Cs(o,":")}},t:function(s,t,n){const o=Math.trunc(s.getTime()/1e3);return Ye(o,t.length)},T:function(s,t,n){const o=s.getTime();return Ye(o,t.length)}};function Km(s,t=""){const n=s>0?"-":"+",o=Math.abs(s),l=Math.trunc(o/60),h=o%60;return h===0?n+String(l):n+String(l)+t+Ye(h,2)}function Jm(s,t){return s%60===0?(s>0?"-":"+")+Ye(Math.abs(s)/60,2):Cs(s,t)}function Cs(s,t=""){const n=s>0?"-":"+",o=Math.abs(s),l=Ye(Math.trunc(o/60),2),h=Ye(o%60,2);return n+l+t+h}const Hm=(s,t)=>{switch(s){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Oh=(s,t)=>{switch(s){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},ub=(s,t)=>{const n=s.match(/(P+)(p+)?/)||[],o=n[1],l=n[2];if(!l)return Hm(s,t);let h;switch(o){case"P":h=t.dateTime({width:"short"});break;case"PP":h=t.dateTime({width:"medium"});break;case"PPP":h=t.dateTime({width:"long"});break;case"PPPP":default:h=t.dateTime({width:"full"});break}return h.replace("{{date}}",Hm(o,t)).replace("{{time}}",Oh(l,t))},mb={p:Oh,P:ub},hb=/^D+$/,fb=/^Y+$/,gb=["D","DD","YY","YYYY"];function pb(s){return hb.test(s)}function xb(s){return fb.test(s)}function yb(s,t,n){const o=bb(s,t,n);if(console.warn(o),gb.includes(s))throw new RangeError(o)}function bb(s,t,n){const o=s[0]==="Y"?"years":"days of the month";return`Use \`${s.toLowerCase()}\` instead of \`${s}\` (in \`${t}\`) for formatting ${o} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const vb=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,wb=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Nb=/^'([^]*?)'?$/,jb=/''/g,Sb=/[a-zA-Z]/;function ga(s,t,n){var k,T,E,O,U,w,$,ce;const o=jn(),l=(n==null?void 0:n.locale)??o.locale??_h,h=(n==null?void 0:n.firstWeekContainsDate)??((T=(k=n==null?void 0:n.locale)==null?void 0:k.options)==null?void 0:T.firstWeekContainsDate)??o.firstWeekContainsDate??((O=(E=o.locale)==null?void 0:E.options)==null?void 0:O.firstWeekContainsDate)??1,p=(n==null?void 0:n.weekStartsOn)??((w=(U=n==null?void 0:n.locale)==null?void 0:U.options)==null?void 0:w.weekStartsOn)??o.weekStartsOn??((ce=($=o.locale)==null?void 0:$.options)==null?void 0:ce.weekStartsOn)??0,j=Be(s);if(!_y(j))throw new RangeError("Invalid time value");let C=t.match(wb).map(ee=>{const q=ee[0];if(q==="p"||q==="P"){const re=mb[q];return re(ee,l.formatLong)}return ee}).join("").match(vb).map(ee=>{if(ee==="''")return{isToken:!1,value:"'"};const q=ee[0];if(q==="'")return{isToken:!1,value:Db(ee)};if(Ym[q])return{isToken:!0,value:ee};if(q.match(Sb))throw new RangeError("Format string contains an unescaped latin alphabet character `"+q+"`");return{isToken:!1,value:ee}});l.localize.preprocessor&&(C=l.localize.preprocessor(j,C));const D={firstWeekContainsDate:h,weekStartsOn:p,locale:l};return C.map(ee=>{if(!ee.isToken)return ee.value;const q=ee.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&xb(q)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&pb(q))&&yb(q,t,String(s));const re=Ym[q[0]];return re(j,q,l.localize,D)}).join("")}function Db(s){const t=s.match(Nb);return t?t[1].replace(jb,"'"):s}function kb(s){const t=Be(s),n=t.getFullYear(),o=t.getMonth(),l=na(s,0);return l.setFullYear(n,o+1,0),l.setHours(0,0,0,0),l.getDate()}function Cb(s){return Math.trunc(+Be(s)/1e3)}function Ib(s){const t=Be(s),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}function Ab(s,t){return Ty(Ib(s),Qt(s),t)+1}function yc(s,t){const n=Be(s),o=Be(t);return n.getTime()>o.getTime()}function Eh(s,t){const n=Be(s),o=Be(t);return+n<+o}function _c(s,t){const n=Be(s),o=Be(t);return n.getFullYear()===o.getFullYear()&&n.getMonth()===o.getMonth()}function _b(s,t){const n=Be(s),o=Be(t);return n.getFullYear()===o.getFullYear()}function lc(s,t){return Vt(s,-t)}function cc(s,t){const n=Be(s),o=n.getFullYear(),l=n.getDate(),h=na(s,0);h.setFullYear(o,t,15),h.setHours(0,0,0,0);const p=kb(h);return n.setMonth(t,Math.min(l,p)),n}function Qm(s,t){const n=Be(s);return isNaN(+n)?na(s,NaN):(n.setFullYear(t),n)}const Tb={lessThanXSeconds:{one:"Ø£Ù‚Ù„ Ù…Ù† Ø«Ø§Ù†ÙŠØ©",two:"Ø£Ù‚Ù„ Ù…Ù† Ø«Ø§Ù†ÙŠØªÙŠÙ†",threeToTen:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø«ÙˆØ§Ù†ÙŠ",other:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø«Ø§Ù†ÙŠØ©"},xSeconds:{one:"Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø©",two:"Ø«Ø§Ù†ÙŠØªØ§Ù†",threeToTen:"{{count}} Ø«ÙˆØ§Ù†ÙŠ",other:"{{count}} Ø«Ø§Ù†ÙŠØ©"},halfAMinute:"Ù†ØµÙ Ø¯Ù‚ÙŠÙ‚Ø©",lessThanXMinutes:{one:"Ø£Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚Ø©",two:"Ø£Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†",threeToTen:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø¯Ù‚Ø§Ø¦Ù‚",other:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø¯Ù‚ÙŠÙ‚Ø©"},xMinutes:{one:"Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©",two:"Ø¯Ù‚ÙŠÙ‚ØªØ§Ù†",threeToTen:"{{count}} Ø¯Ù‚Ø§Ø¦Ù‚",other:"{{count}} Ø¯Ù‚ÙŠÙ‚Ø©"},aboutXHours:{one:"Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",two:"Ø³Ø§Ø¹ØªÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø³Ø§Ø¹Ø§Øª ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",other:"{{count}} Ø³Ø§Ø¹Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹"},xHours:{one:"Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©",two:"Ø³Ø§Ø¹ØªØ§Ù†",threeToTen:"{{count}} Ø³Ø§Ø¹Ø§Øª",other:"{{count}} Ø³Ø§Ø¹Ø©"},xDays:{one:"ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯",two:"ÙŠÙˆÙ…Ø§Ù†",threeToTen:"{{count}} Ø£ÙŠØ§Ù…",other:"{{count}} ÙŠÙˆÙ…"},aboutXWeeks:{one:"Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯ ØªÙ‚Ø±ÙŠØ¨Ø§",two:"Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø£Ø³Ø§Ø¨ÙŠØ¹ ØªÙ‚Ø±ÙŠØ¨Ø§",other:"{{count}} Ø£Ø³Ø¨ÙˆØ¹Ø§ ØªÙ‚Ø±ÙŠØ¨Ø§"},xWeeks:{one:"Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯",two:"Ø£Ø³Ø¨ÙˆØ¹Ø§Ù†",threeToTen:"{{count}} Ø£Ø³Ø§Ø¨ÙŠØ¹",other:"{{count}} Ø£Ø³Ø¨ÙˆØ¹Ø§"},aboutXMonths:{one:"Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",two:"Ø´Ù‡Ø±ÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø£Ø´Ù‡Ø± ØªÙ‚Ø±ÙŠØ¨Ø§",other:"{{count}} Ø´Ù‡Ø±Ø§ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹"},xMonths:{one:"Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯",two:"Ø´Ù‡Ø±Ø§Ù†",threeToTen:"{{count}} Ø£Ø´Ù‡Ø±",other:"{{count}} Ø´Ù‡Ø±Ø§"},aboutXYears:{one:"Ø³Ù†Ø© ÙˆØ§Ø­Ø¯Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",two:"Ø³Ù†ØªÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø³Ù†ÙˆØ§Øª ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",other:"{{count}} Ø³Ù†Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹"},xYears:{one:"Ø³Ù†Ø© ÙˆØ§Ø­Ø¯",two:"Ø³Ù†ØªØ§Ù†",threeToTen:"{{count}} Ø³Ù†ÙˆØ§Øª",other:"{{count}} Ø³Ù†Ø©"},overXYears:{one:"Ø£ÙƒØ«Ø± Ù…Ù† Ø³Ù†Ø©",two:"Ø£ÙƒØ«Ø± Ù…Ù† Ø³Ù†ØªÙŠÙ†",threeToTen:"Ø£ÙƒØ«Ø± Ù…Ù† {{count}} Ø³Ù†ÙˆØ§Øª",other:"Ø£ÙƒØ«Ø± Ù…Ù† {{count}} Ø³Ù†Ø©"},almostXYears:{one:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ Ø³Ù†Ø© ÙˆØ§Ø­Ø¯Ø©",two:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ Ø³Ù†ØªÙŠÙ†",threeToTen:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ {{count}} Ø³Ù†ÙˆØ§Øª",other:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ {{count}} Ø³Ù†Ø©"}},Pb=(s,t,n)=>{const o=Tb[s];let l;return typeof o=="string"?l=o:t===1?l=o.one:t===2?l=o.two:t<=10?l=o.threeToTen.replace("{{count}}",String(t)):l=o.other.replace("{{count}}",String(t)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"Ø®Ù„Ø§Ù„ "+l:"Ù…Ù†Ø° "+l:l},Mb={full:"EEEEØŒ do MMMM y",long:"do MMMM y",medium:"d MMM y",short:"dd/MM/yyyy"},Ob={full:"HH:mm:ss",long:"HH:mm:ss",medium:"HH:mm:ss",short:"HH:mm"},Eb={full:"{{date}} 'Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' {{time}}",long:"{{date}} 'Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Rb={date:ur({formats:Mb,defaultWidth:"full"}),time:ur({formats:Ob,defaultWidth:"full"}),dateTime:ur({formats:Eb,defaultWidth:"full"})},Wb={lastWeek:"eeee 'Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",yesterday:"'Ø§Ù„Ø£Ù…Ø³ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",today:"'Ø§Ù„ÙŠÙˆÙ… Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",tomorrow:"'ØºØ¯Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",nextWeek:"eeee 'Ø§Ù„Ù‚Ø§Ø¯Ù… Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",other:"P"},Lb=s=>Wb[s],Fb={narrow:["Ù‚","Ø¨"],abbreviated:["Ù‚.Ù….","Ø¨.Ù…."],wide:["Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯","Ø¨Ø¹Ø¯ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯"]},$b={narrow:["1","2","3","4"],abbreviated:["Ø±1","Ø±2","Ø±3","Ø±4"],wide:["Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø£ÙˆÙ„","Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ","Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù„Ø«","Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø¹"]},Bb={narrow:["ÙŠ","Ù","Ù…","Ø£","Ù…","ÙŠ","ÙŠ","Ø£","Ø³","Ø£","Ù†","Ø¯"],abbreviated:["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"],wide:["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"]},Ub={narrow:["Ø­","Ù†","Ø«","Ø±","Ø®","Ø¬","Ø³"],short:["Ø£Ø­Ø¯","Ø§Ø«Ù†ÙŠÙ†","Ø«Ù„Ø§Ø«Ø§Ø¡","Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø®Ù…ÙŠØ³","Ø¬Ù…Ø¹Ø©","Ø³Ø¨Øª"],abbreviated:["Ø£Ø­Ø¯","Ø§Ø«Ù†ÙŠÙ†","Ø«Ù„Ø§Ø«Ø§Ø¡","Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø®Ù…ÙŠØ³","Ø¬Ù…Ø¹Ø©","Ø³Ø¨Øª"],wide:["Ø§Ù„Ø£Ø­Ø¯","Ø§Ù„Ø§Ø«Ù†ÙŠÙ†","Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡","Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø§Ù„Ø®Ù…ÙŠØ³","Ø§Ù„Ø¬Ù…Ø¹Ø©","Ø§Ù„Ø³Ø¨Øª"]},Vb={narrow:{am:"Øµ",pm:"Ù…",morning:"Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"Ø§Ù„Ù…Ø³Ø§Ø¡",night:"Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},abbreviated:{am:"Øµ",pm:"Ù…",morning:"Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"Ø§Ù„Ù…Ø³Ø§Ø¡",night:"Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},wide:{am:"Øµ",pm:"Ù…",morning:"Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"Ø§Ù„Ù…Ø³Ø§Ø¡",night:"Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"}},qb={narrow:{am:"Øµ",pm:"Ù…",morning:"ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡",night:"ÙÙŠ Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},abbreviated:{am:"Øµ",pm:"Ù…",morning:"ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡",night:"ÙÙŠ Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},wide:{am:"Øµ",pm:"Ù…",morning:"ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡",night:"ÙÙŠ Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"}},zb=s=>String(s),Yb={ordinalNumber:zb,era:ka({values:Fb,defaultWidth:"wide"}),quarter:ka({values:$b,defaultWidth:"wide",argumentCallback:s=>s-1}),month:ka({values:Bb,defaultWidth:"wide"}),day:ka({values:Ub,defaultWidth:"wide"}),dayPeriod:ka({values:Vb,defaultWidth:"wide",formattingValues:qb,defaultFormattingWidth:"wide"})},Kb=/^(\d+)(th|st|nd|rd)?/i,Jb=/\d+/i,Hb={narrow:/[Ù‚Ø¨]/,abbreviated:/[Ù‚Ø¨]\.Ù…\./,wide:/(Ù‚Ø¨Ù„|Ø¨Ø¹Ø¯) Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯/},Qb={any:[/Ù‚Ø¨Ù„/,/Ø¨Ø¹Ø¯/]},Gb={narrow:/^[1234]/i,abbreviated:/Ø±[1234]/,wide:/Ø§Ù„Ø±Ø¨Ø¹ (Ø§Ù„Ø£ÙˆÙ„|Ø§Ù„Ø«Ø§Ù†ÙŠ|Ø§Ù„Ø«Ø§Ù„Ø«|Ø§Ù„Ø±Ø§Ø¨Ø¹)/},Xb={any:[/1/i,/2/i,/3/i,/4/i]},Zb={narrow:/^[Ø£ÙŠÙÙ…Ø³Ù†Ø¯]/,abbreviated:/^(ÙŠÙ†Ø§ÙŠØ±|ÙØ¨Ø±Ø§ÙŠØ±|Ù…Ø§Ø±Ø³|Ø£Ø¨Ø±ÙŠÙ„|Ù…Ø§ÙŠÙˆ|ÙŠÙˆÙ†ÙŠÙˆ|ÙŠÙˆÙ„ÙŠÙˆ|Ø£ØºØ³Ø·Ø³|Ø³Ø¨ØªÙ…Ø¨Ø±|Ø£ÙƒØªÙˆØ¨Ø±|Ù†ÙˆÙÙ…Ø¨Ø±|Ø¯ÙŠØ³Ù…Ø¨Ø±)/,wide:/^(ÙŠÙ†Ø§ÙŠØ±|ÙØ¨Ø±Ø§ÙŠØ±|Ù…Ø§Ø±Ø³|Ø£Ø¨Ø±ÙŠÙ„|Ù…Ø§ÙŠÙˆ|ÙŠÙˆÙ†ÙŠÙˆ|ÙŠÙˆÙ„ÙŠÙˆ|Ø£ØºØ³Ø·Ø³|Ø³Ø¨ØªÙ…Ø¨Ø±|Ø£ÙƒØªÙˆØ¨Ø±|Ù†ÙˆÙÙ…Ø¨Ø±|Ø¯ÙŠØ³Ù…Ø¨Ø±)/},ev={narrow:[/^ÙŠ/i,/^Ù/i,/^Ù…/i,/^Ø£/i,/^Ù…/i,/^ÙŠ/i,/^ÙŠ/i,/^Ø£/i,/^Ø³/i,/^Ø£/i,/^Ù†/i,/^Ø¯/i],any:[/^ÙŠÙ†Ø§ÙŠØ±/i,/^ÙØ¨Ø±Ø§ÙŠØ±/i,/^Ù…Ø§Ø±Ø³/i,/^Ø£Ø¨Ø±ÙŠÙ„/i,/^Ù…Ø§ÙŠÙˆ/i,/^ÙŠÙˆÙ†ÙŠÙˆ/i,/^ÙŠÙˆÙ„ÙŠÙˆ/i,/^Ø£ØºØ³Ø·Ø³/i,/^Ø³Ø¨ØªÙ…Ø¨Ø±/i,/^Ø£ÙƒØªÙˆØ¨Ø±/i,/^Ù†ÙˆÙÙ…Ø¨Ø±/i,/^Ø¯ÙŠØ³Ù…Ø¨Ø±/i]},tv={narrow:/^[Ø­Ù†Ø«Ø±Ø®Ø¬Ø³]/i,short:/^(Ø£Ø­Ø¯|Ø§Ø«Ù†ÙŠÙ†|Ø«Ù„Ø§Ø«Ø§Ø¡|Ø£Ø±Ø¨Ø¹Ø§Ø¡|Ø®Ù…ÙŠØ³|Ø¬Ù…Ø¹Ø©|Ø³Ø¨Øª)/i,abbreviated:/^(Ø£Ø­Ø¯|Ø§Ø«Ù†ÙŠÙ†|Ø«Ù„Ø§Ø«Ø§Ø¡|Ø£Ø±Ø¨Ø¹Ø§Ø¡|Ø®Ù…ÙŠØ³|Ø¬Ù…Ø¹Ø©|Ø³Ø¨Øª)/i,wide:/^(Ø§Ù„Ø£Ø­Ø¯|Ø§Ù„Ø§Ø«Ù†ÙŠÙ†|Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡|Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡|Ø§Ù„Ø®Ù…ÙŠØ³|Ø§Ù„Ø¬Ù…Ø¹Ø©|Ø§Ù„Ø³Ø¨Øª)/i},av={narrow:[/^Ø­/i,/^Ù†/i,/^Ø«/i,/^Ø±/i,/^Ø®/i,/^Ø¬/i,/^Ø³/i],wide:[/^Ø§Ù„Ø£Ø­Ø¯/i,/^Ø§Ù„Ø§Ø«Ù†ÙŠÙ†/i,/^Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡/i,/^Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡/i,/^Ø§Ù„Ø®Ù…ÙŠØ³/i,/^Ø§Ù„Ø¬Ù…Ø¹Ø©/i,/^Ø§Ù„Ø³Ø¨Øª/i],any:[/^Ø£Ø­/i,/^Ø§Ø«/i,/^Ø«/i,/^Ø£Ø±/i,/^Ø®/i,/^Ø¬/i,/^Ø³/i]},sv={narrow:/^(Øµ|Ù…|Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„|Ø§Ù„Ø¸Ù‡Ø±|Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±|ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­|ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡|ÙÙŠ Ø§Ù„Ù„ÙŠÙ„)/,any:/^(Øµ|Ù…|Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„|Ø§Ù„Ø¸Ù‡Ø±|Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±|ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­|ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡|ÙÙŠ Ø§Ù„Ù„ÙŠÙ„)/},rv={any:{am:/^Øµ/,pm:/^Ù…/,midnight:/Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„/,noon:/Ø§Ù„Ø¸Ù‡Ø±/,afternoon:/Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±/,morning:/ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­/,evening:/ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡/,night:/ÙÙŠ Ø§Ù„Ù„ÙŠÙ„/}},nv={ordinalNumber:Ah({matchPattern:Kb,parsePattern:Jb,valueCallback:s=>parseInt(s,10)}),era:Ca({matchPatterns:Hb,defaultMatchWidth:"wide",parsePatterns:Qb,defaultParseWidth:"any"}),quarter:Ca({matchPatterns:Gb,defaultMatchWidth:"wide",parsePatterns:Xb,defaultParseWidth:"any",valueCallback:s=>s+1}),month:Ca({matchPatterns:Zb,defaultMatchWidth:"wide",parsePatterns:ev,defaultParseWidth:"any"}),day:Ca({matchPatterns:tv,defaultMatchWidth:"wide",parsePatterns:av,defaultParseWidth:"any"}),dayPeriod:Ca({matchPatterns:sv,defaultMatchWidth:"any",parsePatterns:rv,defaultParseWidth:"any"})},Gm={code:"ar",formatDistance:Pb,formatLong:Rb,formatRelative:Lb,localize:Yb,match:nv,options:{weekStartsOn:6,firstWeekContainsDate:1}};var ge=function(){return ge=Object.assign||function(t){for(var n,o=1,l=arguments.length;o<l;o++){n=arguments[o];for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&(t[h]=n[h])}return t},ge.apply(this,arguments)};function iv(s,t){var n={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&t.indexOf(o)<0&&(n[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(s);l<o.length;l++)t.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(s,o[l])&&(n[o[l]]=s[o[l]]);return n}function Rh(s,t,n){for(var o=0,l=t.length,h;o<l;o++)(h||!(o in t))&&(h||(h=Array.prototype.slice.call(t,0,o)),h[o]=t[o]);return s.concat(h||Array.prototype.slice.call(t))}function Sn(s){return s.mode==="multiple"}function Dn(s){return s.mode==="range"}function so(s){return s.mode==="single"}var ov={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function lv(s,t){return ga(s,"LLLL y",t)}function cv(s,t){return ga(s,"d",t)}function dv(s,t){return ga(s,"LLLL",t)}function uv(s){return"".concat(s)}function mv(s,t){return ga(s,"cccccc",t)}function hv(s,t){return ga(s,"yyyy",t)}var fv=Object.freeze({__proto__:null,formatCaption:lv,formatDay:cv,formatMonthCaption:dv,formatWeekNumber:uv,formatWeekdayName:mv,formatYearCaption:hv}),gv=function(s,t,n){return ga(s,"do MMMM (EEEE)",n)},pv=function(){return"Month: "},xv=function(){return"Go to next month"},yv=function(){return"Go to previous month"},bv=function(s,t){return ga(s,"cccc",t)},vv=function(s){return"Week n. ".concat(s)},wv=function(){return"Year: "},Nv=Object.freeze({__proto__:null,labelDay:gv,labelMonthDropdown:pv,labelNext:xv,labelPrevious:yv,labelWeekNumber:vv,labelWeekday:bv,labelYearDropdown:wv});function jv(){var s="buttons",t=ov,n=_h,o={},l={},h=1,p={},j=new Date;return{captionLayout:s,classNames:t,formatters:fv,labels:Nv,locale:n,modifiersClassNames:o,modifiers:l,numberOfMonths:h,styles:p,today:j,mode:"default"}}function Sv(s){var t=s.fromYear,n=s.toYear,o=s.fromMonth,l=s.toMonth,h=s.fromDate,p=s.toDate;return o?h=Qt(o):t&&(h=new Date(t,0,1)),l?p=Ic(l):n&&(p=new Date(n,11,31)),{fromDate:h?fr(h):void 0,toDate:p?fr(p):void 0}}var Wh=u.createContext(void 0);function Dv(s){var t,n=s.initialProps,o=jv(),l=Sv(n),h=l.fromDate,p=l.toDate,j=(t=n.captionLayout)!==null&&t!==void 0?t:o.captionLayout;j!=="buttons"&&(!h||!p)&&(j="buttons");var C;(so(n)||Sn(n)||Dn(n))&&(C=n.onSelect);var D=ge(ge(ge({},o),n),{captionLayout:j,classNames:ge(ge({},o.classNames),n.classNames),components:ge({},n.components),formatters:ge(ge({},o.formatters),n.formatters),fromDate:h,labels:ge(ge({},o.labels),n.labels),mode:n.mode||o.mode,modifiers:ge(ge({},o.modifiers),n.modifiers),modifiersClassNames:ge(ge({},o.modifiersClassNames),n.modifiersClassNames),onSelect:C,styles:ge(ge({},o.styles),n.styles),toDate:p});return e.jsx(Wh.Provider,{value:D,children:s.children})}function et(){var s=u.useContext(Wh);if(!s)throw new Error("useDayPicker must be used within a DayPickerProvider.");return s}function Lh(s){var t=et(),n=t.locale,o=t.classNames,l=t.styles,h=t.formatters.formatCaption;return e.jsx("div",{className:o.caption_label,style:l.caption_label,"aria-live":"polite",role:"presentation",id:s.id,children:h(s.displayMonth,{locale:n})})}function kv(s){return e.jsx("svg",ge({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},s,{children:e.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Fh(s){var t,n,o=s.onChange,l=s.value,h=s.children,p=s.caption,j=s.className,C=s.style,D=et(),k=(n=(t=D.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&n!==void 0?n:kv;return e.jsxs("div",{className:j,style:C,children:[e.jsx("span",{className:D.classNames.vhidden,children:s["aria-label"]}),e.jsx("select",{name:s.name,"aria-label":s["aria-label"],className:D.classNames.dropdown,style:D.styles.dropdown,value:l,onChange:o,children:h}),e.jsxs("div",{className:D.classNames.caption_label,style:D.styles.caption_label,"aria-hidden":"true",children:[p,e.jsx(k,{className:D.classNames.dropdown_icon,style:D.styles.dropdown_icon})]})]})}function Cv(s){var t,n=et(),o=n.fromDate,l=n.toDate,h=n.styles,p=n.locale,j=n.formatters.formatMonthCaption,C=n.classNames,D=n.components,k=n.labels.labelMonthDropdown;if(!o)return e.jsx(e.Fragment,{});if(!l)return e.jsx(e.Fragment,{});var T=[];if(_b(o,l))for(var E=Qt(o),O=o.getMonth();O<=l.getMonth();O++)T.push(cc(E,O));else for(var E=Qt(new Date),O=0;O<=11;O++)T.push(cc(E,O));var U=function($){var ce=Number($.target.value),ee=cc(Qt(s.displayMonth),ce);s.onChange(ee)},w=(t=D==null?void 0:D.Dropdown)!==null&&t!==void 0?t:Fh;return e.jsx(w,{name:"months","aria-label":k(),className:C.dropdown_month,style:h.dropdown_month,onChange:U,value:s.displayMonth.getMonth(),caption:j(s.displayMonth,{locale:p}),children:T.map(function($){return e.jsx("option",{value:$.getMonth(),children:j($,{locale:p})},$.getMonth())})})}function Iv(s){var t,n=s.displayMonth,o=et(),l=o.fromDate,h=o.toDate,p=o.locale,j=o.styles,C=o.classNames,D=o.components,k=o.formatters.formatYearCaption,T=o.labels.labelYearDropdown,E=[];if(!l)return e.jsx(e.Fragment,{});if(!h)return e.jsx(e.Fragment,{});for(var O=l.getFullYear(),U=h.getFullYear(),w=O;w<=U;w++)E.push(Qm(Ch(new Date),w));var $=function(ee){var q=Qm(Qt(n),Number(ee.target.value));s.onChange(q)},ce=(t=D==null?void 0:D.Dropdown)!==null&&t!==void 0?t:Fh;return e.jsx(ce,{name:"years","aria-label":T(),className:C.dropdown_year,style:j.dropdown_year,onChange:$,value:n.getFullYear(),caption:k(n,{locale:p}),children:E.map(function(ee){return e.jsx("option",{value:ee.getFullYear(),children:k(ee,{locale:p})},ee.getFullYear())})})}function Av(s,t){var n=u.useState(s),o=n[0],l=n[1],h=t===void 0?o:t;return[h,l]}function _v(s){var t=s.month,n=s.defaultMonth,o=s.today,l=t||n||o||new Date,h=s.toDate,p=s.fromDate,j=s.numberOfMonths,C=j===void 0?1:j;if(h&&vn(h,l)<0){var D=-1*(C-1);l=pa(h,D)}return p&&vn(l,p)<0&&(l=p),Qt(l)}function Tv(){var s=et(),t=_v(s),n=Av(t,s.month),o=n[0],l=n[1],h=function(p){var j;if(!s.disableNavigation){var C=Qt(p);l(C),(j=s.onMonthChange)===null||j===void 0||j.call(s,C)}};return[o,h]}function Pv(s,t){for(var n=t.reverseMonths,o=t.numberOfMonths,l=Qt(s),h=Qt(pa(l,o)),p=vn(h,l),j=[],C=0;C<p;C++){var D=pa(l,C);j.push(D)}return n&&(j=j.reverse()),j}function Mv(s,t){if(!t.disableNavigation){var n=t.toDate,o=t.pagedNavigation,l=t.numberOfMonths,h=l===void 0?1:l,p=o?h:1,j=Qt(s);if(!n)return pa(j,p);var C=vn(n,s);if(!(C<h))return pa(j,p)}}function Ov(s,t){if(!t.disableNavigation){var n=t.fromDate,o=t.pagedNavigation,l=t.numberOfMonths,h=l===void 0?1:l,p=o?h:1,j=Qt(s);if(!n)return pa(j,-p);var C=vn(j,n);if(!(C<=0))return pa(j,-p)}}var $h=u.createContext(void 0);function Ev(s){var t=et(),n=Tv(),o=n[0],l=n[1],h=Pv(o,t),p=Mv(o,t),j=Ov(o,t),C=function(T){return h.some(function(E){return _c(T,E)})},D=function(T,E){C(T)||(E&&Eh(T,E)?l(pa(T,1+t.numberOfMonths*-1)):l(T))},k={currentMonth:o,displayMonths:h,goToMonth:l,goToDate:D,previousMonth:j,nextMonth:p,isDateDisplayed:C};return e.jsx($h.Provider,{value:k,children:s.children})}function kn(){var s=u.useContext($h);if(!s)throw new Error("useNavigation must be used within a NavigationProvider");return s}function Xm(s){var t,n=et(),o=n.classNames,l=n.styles,h=n.components,p=kn().goToMonth,j=function(k){p(pa(k,s.displayIndex?-s.displayIndex:0))},C=(t=h==null?void 0:h.CaptionLabel)!==null&&t!==void 0?t:Lh,D=e.jsx(C,{id:s.id,displayMonth:s.displayMonth});return e.jsxs("div",{className:o.caption_dropdowns,style:l.caption_dropdowns,children:[e.jsx("div",{className:o.vhidden,children:D}),e.jsx(Cv,{onChange:j,displayMonth:s.displayMonth}),e.jsx(Iv,{onChange:j,displayMonth:s.displayMonth})]})}function Rv(s){return e.jsx("svg",ge({width:"16px",height:"16px",viewBox:"0 0 120 120"},s,{children:e.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Wv(s){return e.jsx("svg",ge({width:"16px",height:"16px",viewBox:"0 0 120 120"},s,{children:e.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var eo=u.forwardRef(function(s,t){var n=et(),o=n.classNames,l=n.styles,h=[o.button_reset,o.button];s.className&&h.push(s.className);var p=h.join(" "),j=ge(ge({},l.button_reset),l.button);return s.style&&Object.assign(j,s.style),e.jsx("button",ge({},s,{ref:t,type:"button",className:p,style:j}))});function Lv(s){var t,n,o=et(),l=o.dir,h=o.locale,p=o.classNames,j=o.styles,C=o.labels,D=C.labelPrevious,k=C.labelNext,T=o.components;if(!s.nextMonth&&!s.previousMonth)return e.jsx(e.Fragment,{});var E=D(s.previousMonth,{locale:h}),O=[p.nav_button,p.nav_button_previous].join(" "),U=k(s.nextMonth,{locale:h}),w=[p.nav_button,p.nav_button_next].join(" "),$=(t=T==null?void 0:T.IconRight)!==null&&t!==void 0?t:Wv,ce=(n=T==null?void 0:T.IconLeft)!==null&&n!==void 0?n:Rv;return e.jsxs("div",{className:p.nav,style:j.nav,children:[!s.hidePrevious&&e.jsx(eo,{name:"previous-month","aria-label":E,className:O,style:j.nav_button_previous,disabled:!s.previousMonth,onClick:s.onPreviousClick,children:l==="rtl"?e.jsx($,{className:p.nav_icon,style:j.nav_icon}):e.jsx(ce,{className:p.nav_icon,style:j.nav_icon})}),!s.hideNext&&e.jsx(eo,{name:"next-month","aria-label":U,className:w,style:j.nav_button_next,disabled:!s.nextMonth,onClick:s.onNextClick,children:l==="rtl"?e.jsx(ce,{className:p.nav_icon,style:j.nav_icon}):e.jsx($,{className:p.nav_icon,style:j.nav_icon})})]})}function Zm(s){var t=et().numberOfMonths,n=kn(),o=n.previousMonth,l=n.nextMonth,h=n.goToMonth,p=n.displayMonths,j=p.findIndex(function(U){return _c(s.displayMonth,U)}),C=j===0,D=j===p.length-1,k=t>1&&(C||!D),T=t>1&&(D||!C),E=function(){o&&h(o)},O=function(){l&&h(l)};return e.jsx(Lv,{displayMonth:s.displayMonth,hideNext:k,hidePrevious:T,nextMonth:l,previousMonth:o,onPreviousClick:E,onNextClick:O})}function Fv(s){var t,n=et(),o=n.classNames,l=n.disableNavigation,h=n.styles,p=n.captionLayout,j=n.components,C=(t=j==null?void 0:j.CaptionLabel)!==null&&t!==void 0?t:Lh,D;return l?D=e.jsx(C,{id:s.id,displayMonth:s.displayMonth}):p==="dropdown"?D=e.jsx(Xm,{displayMonth:s.displayMonth,id:s.id}):p==="dropdown-buttons"?D=e.jsxs(e.Fragment,{children:[e.jsx(Xm,{displayMonth:s.displayMonth,displayIndex:s.displayIndex,id:s.id}),e.jsx(Zm,{displayMonth:s.displayMonth,displayIndex:s.displayIndex,id:s.id})]}):D=e.jsxs(e.Fragment,{children:[e.jsx(C,{id:s.id,displayMonth:s.displayMonth,displayIndex:s.displayIndex}),e.jsx(Zm,{displayMonth:s.displayMonth,id:s.id})]}),e.jsx("div",{className:o.caption,style:h.caption,children:D})}function $v(s){var t=et(),n=t.footer,o=t.styles,l=t.classNames.tfoot;return n?e.jsx("tfoot",{className:l,style:o.tfoot,children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:n})})}):e.jsx(e.Fragment,{})}function Bv(s,t,n){for(var o=n?Is(new Date):_a(new Date,{locale:s,weekStartsOn:t}),l=[],h=0;h<7;h++){var p=Vt(o,h);l.push(p)}return l}function Uv(){var s=et(),t=s.classNames,n=s.styles,o=s.showWeekNumber,l=s.locale,h=s.weekStartsOn,p=s.ISOWeek,j=s.formatters.formatWeekdayName,C=s.labels.labelWeekday,D=Bv(l,h,p);return e.jsxs("tr",{style:n.head_row,className:t.head_row,children:[o&&e.jsx("td",{style:n.head_cell,className:t.head_cell}),D.map(function(k,T){return e.jsx("th",{scope:"col",className:t.head_cell,style:n.head_cell,"aria-label":C(k,{locale:l}),children:j(k,{locale:l})},T)})]})}function Vv(){var s,t=et(),n=t.classNames,o=t.styles,l=t.components,h=(s=l==null?void 0:l.HeadRow)!==null&&s!==void 0?s:Uv;return e.jsx("thead",{style:o.head,className:n.head,children:e.jsx(h,{})})}function qv(s){var t=et(),n=t.locale,o=t.formatters.formatDay;return e.jsx(e.Fragment,{children:o(s.date,{locale:n})})}var Tc=u.createContext(void 0);function zv(s){if(!Sn(s.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return e.jsx(Tc.Provider,{value:t,children:s.children})}return e.jsx(Yv,{initialProps:s.initialProps,children:s.children})}function Yv(s){var t=s.initialProps,n=s.children,o=t.selected,l=t.min,h=t.max,p=function(D,k,T){var E,O;(E=t.onDayClick)===null||E===void 0||E.call(t,D,k,T);var U=!!(k.selected&&l&&(o==null?void 0:o.length)===l);if(!U){var w=!!(!k.selected&&h&&(o==null?void 0:o.length)===h);if(!w){var $=o?Rh([],o):[];if(k.selected){var ce=$.findIndex(function(ee){return Ht(D,ee)});$.splice(ce,1)}else $.push(D);(O=t.onSelect)===null||O===void 0||O.call(t,$,D,k,T)}}},j={disabled:[]};o&&j.disabled.push(function(D){var k=h&&o.length>h-1,T=o.some(function(E){return Ht(E,D)});return!!(k&&!T)});var C={selected:o,onDayClick:p,modifiers:j};return e.jsx(Tc.Provider,{value:C,children:n})}function Pc(){var s=u.useContext(Tc);if(!s)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return s}function Kv(s,t){var n=t||{},o=n.from,l=n.to;return o&&l?Ht(l,s)&&Ht(o,s)?void 0:Ht(l,s)?{from:l,to:void 0}:Ht(o,s)?void 0:yc(o,s)?{from:s,to:l}:{from:o,to:s}:l?yc(s,l)?{from:l,to:s}:{from:s,to:l}:o?Eh(s,o)?{from:s,to:o}:{from:o,to:s}:{from:s,to:void 0}}var Mc=u.createContext(void 0);function Jv(s){if(!Dn(s.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return e.jsx(Mc.Provider,{value:t,children:s.children})}return e.jsx(Hv,{initialProps:s.initialProps,children:s.children})}function Hv(s){var t=s.initialProps,n=s.children,o=t.selected,l=o||{},h=l.from,p=l.to,j=t.min,C=t.max,D=function(O,U,w){var $,ce;($=t.onDayClick)===null||$===void 0||$.call(t,O,U,w);var ee=Kv(O,o);(ce=t.onSelect)===null||ce===void 0||ce.call(t,ee,O,U,w)},k={range_start:[],range_end:[],range_middle:[],disabled:[]};if(h?(k.range_start=[h],p?(k.range_end=[p],Ht(h,p)||(k.range_middle=[{after:h,before:p}])):k.range_end=[h]):p&&(k.range_start=[p],k.range_end=[p]),j&&(h&&!p&&k.disabled.push({after:lc(h,j-1),before:Vt(h,j-1)}),h&&p&&k.disabled.push({after:h,before:Vt(h,j-1)}),!h&&p&&k.disabled.push({after:lc(p,j-1),before:Vt(p,j-1)})),C){if(h&&!p&&(k.disabled.push({before:Vt(h,-C+1)}),k.disabled.push({after:Vt(h,C-1)})),h&&p){var T=Aa(p,h)+1,E=C-T;k.disabled.push({before:lc(h,E)}),k.disabled.push({after:Vt(p,E)})}!h&&p&&(k.disabled.push({before:Vt(p,-C+1)}),k.disabled.push({after:Vt(p,C-1)}))}return e.jsx(Mc.Provider,{value:{selected:o,onDayClick:D,modifiers:k},children:n})}function Oc(){var s=u.useContext(Mc);if(!s)throw new Error("useSelectRange must be used within a SelectRangeProvider");return s}function Qi(s){return Array.isArray(s)?Rh([],s):s!==void 0?[s]:[]}function Qv(s){var t={};return Object.entries(s).forEach(function(n){var o=n[0],l=n[1];t[o]=Qi(l)}),t}var xa;(function(s){s.Outside="outside",s.Disabled="disabled",s.Selected="selected",s.Hidden="hidden",s.Today="today",s.RangeStart="range_start",s.RangeEnd="range_end",s.RangeMiddle="range_middle"})(xa||(xa={}));var Gv=xa.Selected,Ua=xa.Disabled,Xv=xa.Hidden,Zv=xa.Today,dc=xa.RangeEnd,uc=xa.RangeMiddle,mc=xa.RangeStart,ew=xa.Outside;function tw(s,t,n){var o,l=(o={},o[Gv]=Qi(s.selected),o[Ua]=Qi(s.disabled),o[Xv]=Qi(s.hidden),o[Zv]=[s.today],o[dc]=[],o[uc]=[],o[mc]=[],o[ew]=[],o);return s.fromDate&&l[Ua].push({before:s.fromDate}),s.toDate&&l[Ua].push({after:s.toDate}),Sn(s)?l[Ua]=l[Ua].concat(t.modifiers[Ua]):Dn(s)&&(l[Ua]=l[Ua].concat(n.modifiers[Ua]),l[mc]=n.modifiers[mc],l[uc]=n.modifiers[uc],l[dc]=n.modifiers[dc]),l}var Bh=u.createContext(void 0);function aw(s){var t=et(),n=Pc(),o=Oc(),l=tw(t,n,o),h=Qv(t.modifiers),p=ge(ge({},l),h);return e.jsx(Bh.Provider,{value:p,children:s.children})}function Uh(){var s=u.useContext(Bh);if(!s)throw new Error("useModifiers must be used within a ModifiersProvider");return s}function sw(s){return!!(s&&typeof s=="object"&&"before"in s&&"after"in s)}function rw(s){return!!(s&&typeof s=="object"&&"from"in s)}function nw(s){return!!(s&&typeof s=="object"&&"after"in s)}function iw(s){return!!(s&&typeof s=="object"&&"before"in s)}function ow(s){return!!(s&&typeof s=="object"&&"dayOfWeek"in s)}function lw(s,t){var n,o=t.from,l=t.to;if(o&&l){var h=Aa(l,o)<0;h&&(n=[l,o],o=n[0],l=n[1]);var p=Aa(s,o)>=0&&Aa(l,s)>=0;return p}return l?Ht(l,s):o?Ht(o,s):!1}function cw(s){return Cc(s)}function dw(s){return Array.isArray(s)&&s.every(Cc)}function uw(s,t){return t.some(function(n){if(typeof n=="boolean")return n;if(cw(n))return Ht(s,n);if(dw(n))return n.includes(s);if(rw(n))return lw(s,n);if(ow(n))return n.dayOfWeek.includes(s.getDay());if(sw(n)){var o=Aa(n.before,s),l=Aa(n.after,s),h=o>0,p=l<0,j=yc(n.before,n.after);return j?p&&h:h||p}return nw(n)?Aa(s,n.after)>0:iw(n)?Aa(n.before,s)>0:typeof n=="function"?n(s):!1})}function Ec(s,t,n){var o=Object.keys(t).reduce(function(h,p){var j=t[p];return uw(s,j)&&h.push(p),h},[]),l={};return o.forEach(function(h){return l[h]=!0}),n&&!_c(s,n)&&(l.outside=!0),l}function mw(s,t){for(var n=Qt(s[0]),o=Ic(s[s.length-1]),l,h,p=n;p<=o;){var j=Ec(p,t),C=!j.disabled&&!j.hidden;if(!C){p=Vt(p,1);continue}if(j.selected)return p;j.today&&!h&&(h=p),l||(l=p),p=Vt(p,1)}return h||l}var hw=365;function Vh(s,t){var n=t.moveBy,o=t.direction,l=t.context,h=t.modifiers,p=t.retry,j=p===void 0?{count:0,lastFocused:s}:p,C=l.weekStartsOn,D=l.fromDate,k=l.toDate,T=l.locale,E={day:Vt,week:xc,month:pa,year:Cy,startOfWeek:function($){return l.ISOWeek?Is($):_a($,{locale:T,weekStartsOn:C})},endOfWeek:function($){return l.ISOWeek?Ih($):Ac($,{locale:T,weekStartsOn:C})}},O=E[n](s,o==="after"?1:-1);o==="before"&&D?O=Iy([D,O]):o==="after"&&k&&(O=Ay([k,O]));var U=!0;if(h){var w=Ec(O,h);U=!w.disabled&&!w.hidden}return U?O:j.count>hw?j.lastFocused:Vh(O,{moveBy:n,direction:o,context:l,modifiers:h,retry:ge(ge({},j),{count:j.count+1})})}var qh=u.createContext(void 0);function fw(s){var t=kn(),n=Uh(),o=u.useState(),l=o[0],h=o[1],p=u.useState(),j=p[0],C=p[1],D=mw(t.displayMonths,n),k=l??(j&&t.isDateDisplayed(j))?j:D,T=function(){C(l),h(void 0)},E=function($){h($)},O=et(),U=function($,ce){if(l){var ee=Vh(l,{moveBy:$,direction:ce,context:O,modifiers:n});Ht(l,ee)||(t.goToDate(ee,l),E(ee))}},w={focusedDay:l,focusTarget:k,blur:T,focus:E,focusDayAfter:function(){return U("day","after")},focusDayBefore:function(){return U("day","before")},focusWeekAfter:function(){return U("week","after")},focusWeekBefore:function(){return U("week","before")},focusMonthBefore:function(){return U("month","before")},focusMonthAfter:function(){return U("month","after")},focusYearBefore:function(){return U("year","before")},focusYearAfter:function(){return U("year","after")},focusStartOfWeek:function(){return U("startOfWeek","before")},focusEndOfWeek:function(){return U("endOfWeek","after")}};return e.jsx(qh.Provider,{value:w,children:s.children})}function Rc(){var s=u.useContext(qh);if(!s)throw new Error("useFocusContext must be used within a FocusProvider");return s}function gw(s,t){var n=Uh(),o=Ec(s,n,t);return o}var Wc=u.createContext(void 0);function pw(s){if(!so(s.initialProps)){var t={selected:void 0};return e.jsx(Wc.Provider,{value:t,children:s.children})}return e.jsx(xw,{initialProps:s.initialProps,children:s.children})}function xw(s){var t=s.initialProps,n=s.children,o=function(h,p,j){var C,D,k;if((C=t.onDayClick)===null||C===void 0||C.call(t,h,p,j),p.selected&&!t.required){(D=t.onSelect)===null||D===void 0||D.call(t,void 0,h,p,j);return}(k=t.onSelect)===null||k===void 0||k.call(t,h,h,p,j)},l={selected:t.selected,onDayClick:o};return e.jsx(Wc.Provider,{value:l,children:n})}function zh(){var s=u.useContext(Wc);if(!s)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return s}function yw(s,t){var n=et(),o=zh(),l=Pc(),h=Oc(),p=Rc(),j=p.focusDayAfter,C=p.focusDayBefore,D=p.focusWeekAfter,k=p.focusWeekBefore,T=p.blur,E=p.focus,O=p.focusMonthBefore,U=p.focusMonthAfter,w=p.focusYearBefore,$=p.focusYearAfter,ce=p.focusStartOfWeek,ee=p.focusEndOfWeek,q=function(ne){var L,Ke,xt,_t;so(n)?(L=o.onDayClick)===null||L===void 0||L.call(o,s,t,ne):Sn(n)?(Ke=l.onDayClick)===null||Ke===void 0||Ke.call(l,s,t,ne):Dn(n)?(xt=h.onDayClick)===null||xt===void 0||xt.call(h,s,t,ne):(_t=n.onDayClick)===null||_t===void 0||_t.call(n,s,t,ne)},re=function(ne){var L;E(s),(L=n.onDayFocus)===null||L===void 0||L.call(n,s,t,ne)},Oe=function(ne){var L;T(),(L=n.onDayBlur)===null||L===void 0||L.call(n,s,t,ne)},ve=function(ne){var L;(L=n.onDayMouseEnter)===null||L===void 0||L.call(n,s,t,ne)},je=function(ne){var L;(L=n.onDayMouseLeave)===null||L===void 0||L.call(n,s,t,ne)},At=function(ne){var L;(L=n.onDayPointerEnter)===null||L===void 0||L.call(n,s,t,ne)},xe=function(ne){var L;(L=n.onDayPointerLeave)===null||L===void 0||L.call(n,s,t,ne)},de=function(ne){var L;(L=n.onDayTouchCancel)===null||L===void 0||L.call(n,s,t,ne)},Te=function(ne){var L;(L=n.onDayTouchEnd)===null||L===void 0||L.call(n,s,t,ne)},Le=function(ne){var L;(L=n.onDayTouchMove)===null||L===void 0||L.call(n,s,t,ne)},pt=function(ne){var L;(L=n.onDayTouchStart)===null||L===void 0||L.call(n,s,t,ne)},ht=function(ne){var L;(L=n.onDayKeyUp)===null||L===void 0||L.call(n,s,t,ne)},Ue=function(ne){var L;switch(ne.key){case"ArrowLeft":ne.preventDefault(),ne.stopPropagation(),n.dir==="rtl"?j():C();break;case"ArrowRight":ne.preventDefault(),ne.stopPropagation(),n.dir==="rtl"?C():j();break;case"ArrowDown":ne.preventDefault(),ne.stopPropagation(),D();break;case"ArrowUp":ne.preventDefault(),ne.stopPropagation(),k();break;case"PageUp":ne.preventDefault(),ne.stopPropagation(),ne.shiftKey?w():O();break;case"PageDown":ne.preventDefault(),ne.stopPropagation(),ne.shiftKey?$():U();break;case"Home":ne.preventDefault(),ne.stopPropagation(),ce();break;case"End":ne.preventDefault(),ne.stopPropagation(),ee();break}(L=n.onDayKeyDown)===null||L===void 0||L.call(n,s,t,ne)},tt={onClick:q,onFocus:re,onBlur:Oe,onKeyDown:Ue,onKeyUp:ht,onMouseEnter:ve,onMouseLeave:je,onPointerEnter:At,onPointerLeave:xe,onTouchCancel:de,onTouchEnd:Te,onTouchMove:Le,onTouchStart:pt};return tt}function bw(){var s=et(),t=zh(),n=Pc(),o=Oc(),l=so(s)?t.selected:Sn(s)?n.selected:Dn(s)?o.selected:void 0;return l}function vw(s){return Object.values(xa).includes(s)}function ww(s,t){var n=[s.classNames.day];return Object.keys(t).forEach(function(o){var l=s.modifiersClassNames[o];if(l)n.push(l);else if(vw(o)){var h=s.classNames["day_".concat(o)];h&&n.push(h)}}),n}function Nw(s,t){var n=ge({},s.styles.day);return Object.keys(t).forEach(function(o){var l;n=ge(ge({},n),(l=s.modifiersStyles)===null||l===void 0?void 0:l[o])}),n}function jw(s,t,n){var o,l,h,p=et(),j=Rc(),C=gw(s,t),D=yw(s,C),k=bw(),T=!!(p.onDayClick||p.mode!=="default");u.useEffect(function(){var ve;C.outside||j.focusedDay&&T&&Ht(j.focusedDay,s)&&((ve=n.current)===null||ve===void 0||ve.focus())},[j.focusedDay,s,n,T,C.outside]);var E=ww(p,C).join(" "),O=Nw(p,C),U=!!(C.outside&&!p.showOutsideDays||C.hidden),w=(h=(l=p.components)===null||l===void 0?void 0:l.DayContent)!==null&&h!==void 0?h:qv,$=e.jsx(w,{date:s,displayMonth:t,activeModifiers:C}),ce={style:O,className:E,children:$,role:"gridcell"},ee=j.focusTarget&&Ht(j.focusTarget,s)&&!C.outside,q=j.focusedDay&&Ht(j.focusedDay,s),re=ge(ge(ge({},ce),(o={disabled:C.disabled,role:"gridcell"},o["aria-selected"]=C.selected,o.tabIndex=q||ee?0:-1,o)),D),Oe={isButton:T,isHidden:U,activeModifiers:C,selectedDays:k,buttonProps:re,divProps:ce};return Oe}function Sw(s){var t=u.useRef(null),n=jw(s.date,s.displayMonth,t);return n.isHidden?e.jsx("div",{role:"gridcell"}):n.isButton?e.jsx(eo,ge({name:"day",ref:t},n.buttonProps)):e.jsx("div",ge({},n.divProps))}function Dw(s){var t=s.number,n=s.dates,o=et(),l=o.onWeekNumberClick,h=o.styles,p=o.classNames,j=o.locale,C=o.labels.labelWeekNumber,D=o.formatters.formatWeekNumber,k=D(Number(t),{locale:j});if(!l)return e.jsx("span",{className:p.weeknumber,style:h.weeknumber,children:k});var T=C(Number(t),{locale:j}),E=function(O){l(t,n,O)};return e.jsx(eo,{name:"week-number","aria-label":T,className:p.weeknumber,style:h.weeknumber,onClick:E,children:k})}function kw(s){var t,n,o=et(),l=o.styles,h=o.classNames,p=o.showWeekNumber,j=o.components,C=(t=j==null?void 0:j.Day)!==null&&t!==void 0?t:Sw,D=(n=j==null?void 0:j.WeekNumber)!==null&&n!==void 0?n:Dw,k;return p&&(k=e.jsx("td",{className:h.cell,style:l.cell,children:e.jsx(D,{number:s.weekNumber,dates:s.dates})})),e.jsxs("tr",{className:h.row,style:l.row,children:[k,s.dates.map(function(T){return e.jsx("td",{className:h.cell,style:l.cell,role:"presentation",children:e.jsx(C,{displayMonth:s.displayMonth,date:T})},Cb(T))})]})}function eh(s,t,n){for(var o=n!=null&&n.ISOWeek?Ih(t):Ac(t,n),l=n!=null&&n.ISOWeek?Is(s):_a(s,n),h=Aa(o,l),p=[],j=0;j<=h;j++)p.push(Vt(l,j));var C=p.reduce(function(D,k){var T=n!=null&&n.ISOWeek?Th(k):Mh(k,n),E=D.find(function(O){return O.weekNumber===T});return E?(E.dates.push(k),D):(D.push({weekNumber:T,dates:[k]}),D)},[]);return C}function Cw(s,t){var n=eh(Qt(s),Ic(s),t);if(t!=null&&t.useFixedWeeks){var o=Ab(s,t);if(o<6){var l=n[n.length-1],h=l.dates[l.dates.length-1],p=xc(h,6-o),j=eh(xc(h,1),p,t);n.push.apply(n,j)}}return n}function Iw(s){var t,n,o,l=et(),h=l.locale,p=l.classNames,j=l.styles,C=l.hideHead,D=l.fixedWeeks,k=l.components,T=l.weekStartsOn,E=l.firstWeekContainsDate,O=l.ISOWeek,U=Cw(s.displayMonth,{useFixedWeeks:!!D,ISOWeek:O,locale:h,weekStartsOn:T,firstWeekContainsDate:E}),w=(t=k==null?void 0:k.Head)!==null&&t!==void 0?t:Vv,$=(n=k==null?void 0:k.Row)!==null&&n!==void 0?n:kw,ce=(o=k==null?void 0:k.Footer)!==null&&o!==void 0?o:$v;return e.jsxs("table",{id:s.id,className:p.table,style:j.table,role:"grid","aria-labelledby":s["aria-labelledby"],children:[!C&&e.jsx(w,{}),e.jsx("tbody",{className:p.tbody,style:j.tbody,children:U.map(function(ee){return e.jsx($,{displayMonth:s.displayMonth,dates:ee.dates,weekNumber:ee.weekNumber},ee.weekNumber)})}),e.jsx(ce,{displayMonth:s.displayMonth})]})}function Aw(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var _w=Aw()?u.useLayoutEffect:u.useEffect,hc=!1,Tw=0;function th(){return"react-day-picker-".concat(++Tw)}function Pw(s){var t,n=s??(hc?th():null),o=u.useState(n),l=o[0],h=o[1];return _w(function(){l===null&&h(th())},[]),u.useEffect(function(){hc===!1&&(hc=!0)},[]),(t=s??l)!==null&&t!==void 0?t:void 0}function Mw(s){var t,n,o=et(),l=o.dir,h=o.classNames,p=o.styles,j=o.components,C=kn().displayMonths,D=Pw(o.id?"".concat(o.id,"-").concat(s.displayIndex):void 0),k=o.id?"".concat(o.id,"-grid-").concat(s.displayIndex):void 0,T=[h.month],E=p.month,O=s.displayIndex===0,U=s.displayIndex===C.length-1,w=!O&&!U;l==="rtl"&&(t=[O,U],U=t[0],O=t[1]),O&&(T.push(h.caption_start),E=ge(ge({},E),p.caption_start)),U&&(T.push(h.caption_end),E=ge(ge({},E),p.caption_end)),w&&(T.push(h.caption_between),E=ge(ge({},E),p.caption_between));var $=(n=j==null?void 0:j.Caption)!==null&&n!==void 0?n:Fv;return e.jsxs("div",{className:T.join(" "),style:E,children:[e.jsx($,{id:D,displayMonth:s.displayMonth,displayIndex:s.displayIndex}),e.jsx(Iw,{id:k,"aria-labelledby":D,displayMonth:s.displayMonth})]},s.displayIndex)}function Ow(s){var t=et(),n=t.classNames,o=t.styles;return e.jsx("div",{className:n.months,style:o.months,children:s.children})}function Ew(s){var t,n,o=s.initialProps,l=et(),h=Rc(),p=kn(),j=u.useState(!1),C=j[0],D=j[1];u.useEffect(function(){l.initialFocus&&h.focusTarget&&(C||(h.focus(h.focusTarget),D(!0)))},[l.initialFocus,C,h.focus,h.focusTarget,h]);var k=[l.classNames.root,l.className];l.numberOfMonths>1&&k.push(l.classNames.multiple_months),l.showWeekNumber&&k.push(l.classNames.with_weeknumber);var T=ge(ge({},l.styles.root),l.style),E=Object.keys(o).filter(function(U){return U.startsWith("data-")}).reduce(function(U,w){var $;return ge(ge({},U),($={},$[w]=o[w],$))},{}),O=(n=(t=o.components)===null||t===void 0?void 0:t.Months)!==null&&n!==void 0?n:Ow;return e.jsx("div",ge({className:k.join(" "),style:T,dir:l.dir,id:l.id,nonce:o.nonce,title:o.title,lang:o.lang},E,{children:e.jsx(O,{children:p.displayMonths.map(function(U,w){return e.jsx(Mw,{displayIndex:w,displayMonth:U},w)})})}))}function Rw(s){var t=s.children,n=iv(s,["children"]);return e.jsx(Dv,{initialProps:n,children:e.jsx(Ev,{children:e.jsx(pw,{initialProps:n,children:e.jsx(zv,{initialProps:n,children:e.jsx(Jv,{initialProps:n,children:e.jsx(aw,{children:e.jsx(fw,{children:t})})})})})})})}function Ww(s){return e.jsx(Rw,ge({},s,{children:e.jsx(Ew,{initialProps:s})}))}function bc({className:s,classNames:t,showOutsideDays:n=!0,...o}){return e.jsx(Ww,{showOutsideDays:n,className:Ia("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Ia(jm({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Ia(jm({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...l})=>e.jsx($x,{className:"h-4 w-4"}),IconRight:({...l})=>e.jsx(jx,{className:"h-4 w-4"})},...o})}bc.displayName="Calendar";const ah={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"0.0.0",VITE_DEV_MODE:"true",VITE_ENABLE_OFFLINE_PERSISTENCE:"false",VITE_FIREBASE_API_KEY:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),VITE_FIREBASE_APP_ID:"1:483702062341:web:b1ff06ad175cb7ae428b6c",VITE_FIREBASE_AUTH_DOMAIN:"voda-c6abd.firebaseapp.com",VITE_FIREBASE_AUTH_EMULATOR_URL:"http://localhost:9099",VITE_FIREBASE_FIRESTORE_EMULATOR_HOST:"localhost:8080",VITE_FIREBASE_FUNCTIONS_EMULATOR_HOST:"localhost:5001",VITE_FIREBASE_MEASUREMENT_ID:"G-CV6QGH7G7P",VITE_FIREBASE_MESSAGING_SENDER_ID:"483702062341",VITE_FIREBASE_PROJECT_ID:"voda-c6abd",VITE_FIREBASE_STORAGE_BUCKET:"voda-c6abd.appspot.com",VITE_FORCE_HASH_ROUTER:"true",VITE_SHOP_ID:"demo-shop-001",VITE_SHOP_NAME:"Ù…Ø­Ù„ ÙƒØ§Ø´ÙŠ Ù„ÙŠÙ†Ùƒ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ",VITE_SHOW_ENV_BANNER:"true",VITE_USE_EMULATORS:"false",VITE_USE_FIREBASE_EMULATOR:"false"},os=s=>typeof s=="string"&&s.trim().length>0,Lw={getCurrentMonthId(){const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`},async getWalletUsage(s){var t;try{if(!os(s))return console.error("Error getting wallet usage: invalid walletId",s),null;const n=Me(F,"walletLimits",s),o=await fa(n);if(o.exists()){const h=o.data();return{walletId:s,used_transfer:h.monthlyTransferUsed??h.used_transfer??0,used_withdraw:h.monthlyWithdrawUsed??h.used_withdraw??0,monthly_limit:h.monthlyLimit??h.monthlyTransferLimit??h.monthlyWithdrawLimit??2e5,last_reset:h.lastMonthlyReset??h.last_reset??null,updatedAt:h.updatedAt||Ns.now()}}const l={walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:2e5,last_reset:null,updatedAt:Ns.now()};return await ra(n,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,monthlyTransferLimit:2e5,monthlyWithdrawLimit:2e5,lastMonthlyReset:null,updatedAt:wt(),ownerId:(t=or.currentUser)==null?void 0:t.uid}),l}catch(n){return console.error("Error getting wallet usage:",n),{walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:2e5,last_reset:null,updatedAt:Ns.now()}}},shouldResetLimits(s){const t=new Date,n=t.getDate();if(!s)return n===1;if(n===1){const o=s.toDate(),l=t.getMonth(),h=t.getFullYear();return o.getMonth()!==l||o.getFullYear()!==h}return!1},async autoResetLimitsIfNeeded(s){try{if(!os(s))return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),!1;typeof import.meta<"u";const t=await this.getWalletUsage(s);return t&&this.shouldResetLimits(t.last_reset)?(console.log(`ðŸ”„ ØªØµÙÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯ Ù„Ù„Ù…Ø­ÙØ¸Ø© ${s} - Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø£ÙˆÙ„ Ù…Ù† Ø§Ù„Ø´Ù‡Ø±`),await this.resetWalletUsage(s)):!1}catch(t){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯:",t),!1}},async resetWalletUsage(s){try{if(!os(s))return console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),!1;const t=Me(F,"walletLimits",s);return await ra(t,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:wt(),updatedAt:wt()},{merge:!0}),console.log(`ðŸ”„ ØªÙ… ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${s} Ø¨Ù†Ø¬Ø§Ø­`),!0}catch(t){return console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©:",t),!1}},async calculateUsageFromTransactions(s){var t,n;try{if(!os(s))return console.error("Ø®Ø·Ø£ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),{used_transfer:0,used_withdraw:0};const o=Me(F,"walletLimits",s),l=new Date;let h=Ns.fromDate(new Date(l.getFullYear(),l.getMonth(),1));try{const k=await fa(o);h=k.exists()?((t=k.data())==null?void 0:t.lastMonthlyReset)??((n=k.data())==null?void 0:n.last_reset)??h:h}catch{}const p=Ce(ie(F,"tx"),K("uid","==",s),...h?[K("createdAt",">=",h)]:[]),j=await pe(p);let C=0,D=0;return j.forEach(k=>{const T=k.data();T.status==="completed"&&(T.type==="transfer"?C+=T.amount:T.type==="withdraw"&&(D+=T.amount))}),{used_transfer:C,used_withdraw:D}}catch(o){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª:",o),{used_transfer:0,used_withdraw:0}}},async getWalletUsageWithRefresh(s){var t,n;try{if(!os(s))return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠØ«: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),null;typeof import.meta<"u";const o=await this.getWalletUsage(s);if(!o){const h=await this.calculateUsageFromTransactions(s),p=Me(F,"walletLimits",s);try{await ra(p,{monthlyTransferUsed:h.used_transfer,monthlyWithdrawUsed:h.used_withdraw,updatedAt:wt(),ownerId:(t=or.currentUser)==null?void 0:t.uid},{merge:!0})}catch{}return{walletId:s,used_transfer:h.used_transfer,used_withdraw:h.used_withdraw,monthly_limit:2e5,last_reset:null,updatedAt:Ns.now()}}const l=await this.calculateUsageFromTransactions(s);if(o.used_transfer!==l.used_transfer||o.used_withdraw!==l.used_withdraw){const h=Me(F,"walletLimits",s);try{await ra(h,{monthlyTransferUsed:l.used_transfer,monthlyWithdrawUsed:l.used_withdraw,updatedAt:wt(),ownerId:(n=or.currentUser)==null?void 0:n.uid},{merge:!0})}catch{}return await this.getWalletUsage(s)}return o}catch(o){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠØ«:",o),{walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:2e5,last_reset:null,updatedAt:Ns.now()}}},calculateRemaining(s){return{remainingTransfer:Math.max(0,s.monthly_limit-s.used_transfer),remainingWithdraw:Math.max(0,s.monthly_limit-s.used_withdraw)}},async canPerformOperation(s,t,n){try{if(!os(s))return console.error("Error checking operation limits: invalid walletId",s),{canPerform:!1,message:"walletId ØºÙŠØ± ØµØ§Ù„Ø­"};const o=await this.getWalletUsageWithRefresh(s);if(!o)return{canPerform:!1,message:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù…Ø­ÙØ¸Ø©"};const l=this.calculateRemaining(o);return n==="transfer"&&t>l.remainingTransfer?{canPerform:!1,message:`ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø³Ù…ÙˆØ­. Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${l.remainingTransfer.toLocaleString()} Ø¬.Ù… Ù…Ù† Ø£ØµÙ„ ${o.monthly_limit.toLocaleString()} Ø¬.Ù…`,remaining:l.remainingTransfer}:n==="withdraw"&&t>l.remainingWithdraw?{canPerform:!1,message:`ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…Ø³Ù…ÙˆØ­. Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${l.remainingWithdraw.toLocaleString()} Ø¬.Ù… Ù…Ù† Ø£ØµÙ„ ${o.monthly_limit.toLocaleString()} Ø¬.Ù…`,remaining:l.remainingWithdraw}:{canPerform:!0}}catch(o){return console.error("Error checking operation limits:",o),{canPerform:!1,message:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¯ÙˆØ¯"}}},async updateUsage(s,t,n){var o;try{if(!os(s))throw new Error("walletId ØºÙŠØ± ØµØ§Ù„Ø­");const l=await this.getWalletUsageWithRefresh(s);if(!l)throw new Error("Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù…Ø­ÙØ¸Ø©");const h=await this.canPerformOperation(s,t,n);if(!h.canPerform)throw new Error(h.message||"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©");const p=n==="transfer"?l.used_transfer+t:l.used_transfer,j=n==="withdraw"?l.used_withdraw+t:l.used_withdraw,C=Me(F,"walletLimits",l.walletId);try{await ra(C,{monthlyTransferUsed:p,monthlyWithdrawUsed:j,updatedAt:wt(),ownerId:(o=or.currentUser)==null?void 0:o.uid},{merge:!0})}catch{}let D=await this.getWalletUsageWithRefresh(s);return D||(D={walletId:s,used_transfer:p,used_withdraw:j,monthly_limit:l.monthly_limit,last_reset:l.last_reset,updatedAt:Ns.now()}),D}catch(l){throw console.error("Error updating wallet usage:",l),l}},async resetWalletUsageManually(s){try{if(!os(s))throw new Error("walletId ØºÙŠØ± ØµØ§Ù„Ø­");const t=Me(F,"walletLimits",s),n={walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:0,last_reset:null,updatedAt:new Date};return ra(t,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:wt(),updatedAt:wt()},{merge:!0}).catch(o=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ ØªØµÙÙŠØ± Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Firebase:",o)}),console.log(`âœ… ØªÙ… ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${s} Ø¨Ù†Ø¬Ø§Ø­`),n}catch(t){throw console.error("Error resetting wallet usage:",t),t}},async getAllWalletsUsage(s){try{const n=(await yn.getByMerchantId(s)).map(l=>this.getWalletUsageWithRefresh(l.id));return(await Promise.all(n)).filter(l=>l!==null)}catch(t){return console.error("Error getting all wallets usage:",t),[]}}};function Fw(s){return s?`readBroadcastIds_${s}`:"readBroadcastIds_guest"}function $w({className:s}){const{user:t,profile:n,isSubscriptionActive:o}=Nc(),l=lh(),[h,p]=u.useState([]),[j,C]=u.useState(new Set),[D,k]=u.useState(!1),[T,E]=u.useState(""),[O,U]=u.useState(!1),[w,$]=u.useState(null),[ce,ee]=u.useState("none"),[q,re]=u.useState(null),[Oe,ve]=u.useState(!1),je=u.useRef(new Set);u.useRef(!1);const At=u.useRef(!0),xe=u.useRef(null),de=u.useRef(null),Te=u.useRef(null),[Le,pt]=u.useState({position:"fixed",top:0,left:0,zIndex:1e4}),ht=u.useMemo(()=>{const J=["global"];return t!=null&&t.uid&&J.push(`user:${t.uid}`),n!=null&&n.shopId&&J.push(`shop:${n.shopId}`),J},[t==null?void 0:t.uid,n==null?void 0:n.shopId]),Ue=Fw(t==null?void 0:t.uid),tt=u.useMemo(()=>{var te;const J=(te=l==null?void 0:l.pathname)==null?void 0:te.includes("/user/pending-approval");return!!(t!=null&&t.uid)&&!J},[t==null?void 0:t.uid,l==null?void 0:l.pathname]);u.useEffect(()=>{try{const J=localStorage.getItem(Ue);if(J){const oe=JSON.parse(J);Array.isArray(oe)&&C(new Set(oe.filter(Boolean)))}else C(new Set)}catch(J){console.warn("Failed to load read ids",J),C(new Set)}},[Ue]),u.useEffect(()=>{if(!tt){p([]);return}At.current=!0;const J=()=>{Tx(ht,te=>{if(At.current){const Fe=Date.now(),Ie=60*1e3,ke=te.filter(it=>{var Ta,ia;const Ft=(Ta=it.createdAt)!=null&&Ta.toMillis?it.createdAt.toMillis():(ia=it.createdAt)!=null&&ia.seconds?it.createdAt.seconds*1e3:0;return!(Fe-Ft<Ie)}).map(it=>it.id).filter(Boolean);je.current=new Set(ke),At.current=!1}p(te)})};J();const oe=te=>{console.log("ðŸ”” OneSignal Notification received",te);try{const Fe=te.notification||te;if(Fe&&(Fe.title||Fe.body)){const Ie={id:`temp_${Date.now()}`,title:Fe.title||"Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯",message:Fe.body||Fe.message||"",audienceKey:"global",active:!0,createdAt:{toMillis:()=>Date.now(),seconds:Math.floor(Date.now()/1e3),nanoseconds:0}};re(Ie),ve(!0),xe.current&&clearTimeout(xe.current),xe.current=window.setTimeout(()=>{ve(!1),re(null)},5e3)}}catch(Fe){console.error("Error parsing OneSignal event for instant alert",Fe)}J()};try{const te=window.OneSignal;te&&te.Notifications&&te.Notifications.addEventListener&&te.Notifications.addEventListener("foregroundWillDisplay",oe)}catch(te){console.error("Failed to add OneSignal listener",te)}return()=>{try{const te=window.OneSignal;te&&te.Notifications&&te.Notifications.removeEventListener&&te.Notifications.removeEventListener("foregroundWillDisplay",oe)}catch{}}},[ht,tt]),u.useEffect(()=>{const J=new Set(h.map(te=>te.id).filter(Boolean)),oe=h.filter(te=>te.id&&!je.current.has(te.id));oe.length>0&&(re(oe[0]),ve(!0),xe.current&&clearTimeout(xe.current),xe.current=window.setTimeout(()=>{ve(!1),re(null)},5e3)),je.current=J},[h]),u.useEffect(()=>()=>{xe.current&&clearTimeout(xe.current)},[]);const ne=h.reduce((J,oe)=>J+(oe.id&&!j.has(oe.id)?1:0),0),L=J=>{if(!J)return;let oe=new Set(j);try{const te=localStorage.getItem(Ue);if(te){const Fe=JSON.parse(te);Array.isArray(Fe)&&Fe.forEach(Ie=>oe.add(Ie))}}catch{}if(!oe.has(J)){oe.add(J),C(oe);try{localStorage.setItem(Ue,JSON.stringify(Array.from(oe)))}catch{}}},Ke=()=>{const J=h.map(te=>te.id).filter(Boolean);if(J.length===0)return;let oe=new Set(j);try{const te=localStorage.getItem(Ue);if(te){const Fe=JSON.parse(te);Array.isArray(Fe)&&Fe.forEach(Ie=>oe.add(Ie))}}catch{}J.forEach(te=>oe.add(te)),C(oe);try{localStorage.setItem(Ue,JSON.stringify(Array.from(oe)))}catch{}},xt=(J,oe)=>{var te;if(J)try{const Fe=((te=lr)==null?void 0:te.isNativePlatform)&&lr.getPlatform()==="android",Ie=/\.apk(\?|$)/i.test(J);if(Fe&&Ie){const ke=`cashy://update?url=${encodeURIComponent(J)}`;window.location.href=ke}else window.open(J,"_blank")}catch{try{window.open(J,"_blank")}catch{}}oe&&L(oe)},_t=()=>{if(!de.current||!Te.current)return;const J=de.current.getBoundingClientRect(),oe=8,te=Te.current.offsetWidth||320,Fe=J.bottom+oe;let Ie=J.right-te;const ke=window.innerWidth;Ie=Math.min(Math.max(Ie,oe),ke-te-oe),pt(it=>({...it,top:Fe,left:Ie}))};return u.useEffect(()=>{if(!Oe)return;_t();const J=()=>_t();return window.addEventListener("resize",J),window.addEventListener("scroll",J,!0),()=>{window.removeEventListener("resize",J),window.removeEventListener("scroll",J,!0)}},[Oe]),u.useEffect(()=>{if(!(t!=null&&t.uid)){ee("none");return}(async()=>{try{const oe=Ce(ie(F,"waiting_list"),K("userId","==",t.uid)),Fe=(await pe(oe)).docs.map(it=>({id:it.id,...it.data()})).sort((it,Ft)=>{var ia,Cn,_s,Ts,pr,In;const ya=((Cn=(ia=it==null?void 0:it.createdAt)==null?void 0:ia.toMillis)==null?void 0:Cn.call(ia))??((_s=it==null?void 0:it.createdAt)==null?void 0:_s.seconds)*1e3??0;return(((pr=(Ts=Ft==null?void 0:Ft.createdAt)==null?void 0:Ts.toMillis)==null?void 0:pr.call(Ts))??((In=Ft==null?void 0:Ft.createdAt)==null?void 0:In.seconds)*1e3??0)-ya});if(Fe.length===0){ee("none");return}const Ie=Fe[0],ke=(Ie==null?void 0:Ie.contacted)===!0||(Ie==null?void 0:Ie.status)==="contacted";ee(ke?"contacted":"pending")}catch(oe){console.warn("âš ï¸ ÙØ´Ù„ Ø¬Ù„Ø¨ Ø­Ø§Ù„Ø© waiting_list:",oe),ee("none")}})()},[t==null?void 0:t.uid]),tt?e.jsxs("div",{className:`relative inline-flex items-center gap-2 ${s||""}`,ref:de,children:[e.jsxs(Sx,{onOpenChange:J=>{J&&ne>0&&Ke()},children:[e.jsx(Dx,{asChild:!0,children:e.jsxs(A,{variant:"ghost",size:"icon",className:"relative h-10 w-10 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",children:[e.jsx(Yi,{className:`h-5 w-5 transition-colors ${ne>0?"text-primary":"text-gray-600 dark:text-gray-300"}`}),ne>0&&e.jsx("span",{className:"absolute top-2 right-2 h-4 min-w-[16px] px-0.5 bg-red-600 text-white text-[10px] font-bold flex items-center justify-center rounded-full ring-2 ring-white dark:ring-gray-950 shadow-sm animate-in zoom-in duration-200",children:ne>99?"99+":ne})]})}),e.jsxs(kx,{className:"w-96 p-0 rounded-xl shadow-xl border-gray-100 dark:border-gray-800",align:"end",forceMount:!0,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 dark:border-gray-800 bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm",children:[e.jsx("span",{className:"font-bold text-base text-gray-900 dark:text-gray-100",children:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"}),h.length>0&&e.jsxs(A,{variant:"ghost",size:"sm",className:"h-8 text-xs text-primary hover:text-primary hover:bg-primary/5 transition-colors",onClick:Ke,children:[e.jsx(Xi,{className:"h-3.5 w-3.5 ml-1.5"}),"ØªÙ…ÙŠÙŠØ² Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡"]})]}),h.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center",children:e.jsx(Yi,{className:"w-6 h-6 text-gray-300 dark:text-gray-600"})}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù‡Ù†Ø§ ÙÙˆØ± ÙˆØµÙˆÙ„Ù‡Ø§"})]}):e.jsx("div",{className:"max-h-[400px] overflow-y-auto overflow-x-hidden scrollbar-thin scrollbar-thumb-gray-200 dark:scrollbar-thumb-gray-700 scrollbar-track-transparent",children:h.map(J=>{var Fe,Ie;const oe=J.id?!j.has(J.id):!1;let te="";try{const ke=(Fe=J.createdAt)!=null&&Fe.toMillis?J.createdAt.toMillis():(Ie=J.createdAt)!=null&&Ie.seconds?J.createdAt.seconds*1e3:null;if(ke){const it=Date.now()-ke,Ft=Math.floor(it/6e4),ya=Math.floor(Ft/60),Ta=Math.floor(ya/24);Ta>0?te=`Ù…Ù†Ø° ${Ta} ÙŠÙˆÙ…`:ya>0?te=`Ù…Ù†Ø° ${ya} Ø³Ø§Ø¹Ø©`:Ft>0?te=`Ù…Ù†Ø° ${Ft} Ø¯Ù‚ÙŠÙ‚Ø©`:te="Ø§Ù„Ø¢Ù†"}}catch{}return e.jsx("div",{className:`relative group px-4 py-3.5 border-b border-gray-50 dark:border-gray-800/50 last:border-0 transition-all duration-200 hover:bg-gray-50 dark:hover:bg-gray-800/50 ${oe?"bg-blue-50/40 dark:bg-blue-900/10":""}`,children:e.jsxs("div",{className:"flex items-start gap-3.5",children:[e.jsxs("div",{className:`relative shrink-0 w-10 h-10 rounded-full flex items-center justify-center transition-colors ${oe?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400"}`,children:[e.jsx(Yi,{className:"h-5 w-5"}),oe&&e.jsx("span",{className:"absolute top-0 right-0 w-2.5 h-2.5 bg-blue-600 rounded-full ring-2 ring-white dark:ring-gray-950 animate-pulse"})]}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:`text-sm leading-none ${oe?"font-bold text-gray-900 dark:text-gray-100":"font-medium text-gray-700 dark:text-gray-300"}`,children:J.title||"Ø¥Ø´Ø¹Ø§Ø±"}),te&&e.jsx("span",{className:"text-[10px] text-gray-400 whitespace-nowrap",children:te})]}),e.jsx("p",{className:`text-xs leading-relaxed ${oe?"text-gray-800 dark:text-gray-200":"text-gray-500 dark:text-gray-400"} whitespace-pre-line`,children:J.message}),J.linkUrl&&e.jsx("div",{className:"pt-2",children:e.jsxs(A,{variant:"outline",size:"sm",className:"h-7 text-xs gap-1.5 rounded-full hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200 dark:hover:bg-blue-900/20 dark:hover:border-blue-800 transition-all",onClick:()=>xt(J.linkUrl,J.id),children:[e.jsx(_x,{className:"h-3 w-3"}),"ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·"]})})]}),e.jsx("div",{className:"shrink-0 self-center opacity-0 group-hover:opacity-100 transition-opacity focus-within:opacity-100",children:oe&&e.jsx(A,{variant:"ghost",size:"icon",className:"h-7 w-7 rounded-full text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",onClick:ke=>{ke.stopPropagation(),L(J.id)},title:"ØªÙ…ÙŠÙŠØ² ÙƒÙ…Ù‚Ø±ÙˆØ¡",children:e.jsx(Xi,{className:"h-4 w-4"})})})]})},J.id)})})]})]}),q&&Rp.createPortal(e.jsx("div",{ref:Te,style:Le,className:`pointer-events-auto transition-all duration-300 ${Oe?"opacity-100 translate-y-0":"opacity-0 -translate-y-3"}`,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl border border-gray-200 p-4 w-80 max-w-[calc(100vw-16px)] flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Yi,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-semibold",children:q.title||"Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯"}),e.jsx("div",{className:"text-xs text-muted-foreground whitespace-pre-line",children:q.message}),q.linkUrl&&e.jsx(A,{variant:"link",className:"px-0 h-6 text-xs",onClick:()=>xt(q.linkUrl,q.id),children:"ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·"})]})]})}),document.body)]}):null}function Bw(s,t=300){const[n,o]=Q.useState(s);return Q.useEffect(()=>{const l=setTimeout(()=>o(s),t);return()=>clearTimeout(l)},[s,t]),n}const Uw=({userId:s,transactions:t})=>{const[n,o]=u.useState(!1),[l,h]=u.useState(!1),[p,j]=u.useState(!1),[C,D]=u.useState({monthlyWithdrawalProfit:0,monthlyTransferProfit:0,monthlySalesProfit:0,lastUpdated:new Date}),{userSubscription:k,user:T,profile:E}=Nc();u.useEffect(()=>{s&&n&&p&&U()},[s,n,p]),u.useEffect(()=>{if(!n||!p)return;const q=setInterval(()=>{const re=new Date;(C.lastUpdated.getMonth()!==re.getMonth()||C.lastUpdated.getFullYear()!==re.getFullYear())&&U()},3e4);return()=>clearInterval(q)},[n,p,C.lastUpdated]);const O=async()=>{try{if(!s)return 0;const q=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),re=new Date,Oe=q.format(re),[ve,je]=Oe.split("-"),At=parseInt(ve,10),xe=parseInt(je,10);if(!At||!xe)return 0;const de=new Date(At,xe,0).getDate(),Te=`${ve}-${je}-01`,Le=`${ve}-${je}-${String(de).padStart(2,"0")}`,pt=await pe(Ce(ie(F,"dailySales"),K("userId","==",s))),ht=await pe(ie(F,"users",s,"dailySales")),Ue=[];pt.forEach(L=>Ue.push({id:L.id,data:L.data()})),ht.forEach(L=>Ue.push({id:L.id,data:L.data()}));const tt=new Map;Ue.forEach(L=>{const Ke=String(L.data.clientId||L.id);tt.has(Ke)||tt.set(Ke,L.data)});let ne=0;return tt.forEach(L=>{if(L.isDeferred)return;let Ke="";if(L.date)Ke=String(L.date).slice(0,10);else if(L.createdAt){let te=null;typeof L.createdAt.toDate=="function"?te=L.createdAt.toDate():L.createdAt instanceof Date?te=L.createdAt:typeof L.createdAt=="number"?te=new Date(L.createdAt):typeof L.createdAt=="string"&&(te=new Date(L.createdAt)),te&&!isNaN(te.getTime())&&(Ke=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(te))}if(!Ke||Ke<Te||Ke>Le)return;const xt=Number(L.quantity||1),_t=Number(L.sellingPrice??L.price??0),J=Number(L.wholesalePrice??0),oe=Number(L.profit??(_t-J)*xt);ne+=oe}),Math.round(ne*100)/100}catch(q){return console.warn("ØªØ¹Ø°Ø± Ø­Ø³Ø§Ø¨ Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©:",q),0}},U=async()=>{if(s)try{const q=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),re=new Date,[Oe,ve]=q.format(re).split("-"),je=new Date(`${Oe}-${ve}-01T00:00:00`),At=new Date(new Date(je.getFullYear(),je.getMonth()+1,0).setHours(23,59,59,999)),de=(await se.getUserTransactionsForDateRange(s,je,At)).filter(Ue=>{const tt=String(Ue.status||Ue.status||"completed").toLowerCase();return tt==="completed"||tt==="confirmed"||tt==="pending"}),Te=vt.filterVisibleTransactions(de,"monthly",s);let Le=0,pt=0;Te.forEach(Ue=>{const tt=(Ue.type||Ue.txnType||"").toLowerCase(),ne=String(Ue.title||""),L=tt==="machine_withdrawal"||ne==="Ø¥ÙŠØµØ§Ù„ Ø³Ø­Ø¨ ÙÙˆØ±ÙŠ",Ke=tt==="withdrawal"||tt==="machine_withdrawal"?"withdraw":tt,xt=!L&&(Ke==="withdraw"||Ke==="receive"),_t=!L&&(Ke==="send"||Ke==="transfer"),J={type:Ke,amount:Number(Ue.amount||0),commission:Ue.commission,fee:Ue.fee},oe=Ja.calculateProfitFromTransaction(J);Ke==="atm_withdraw"||xt?Le+=oe:_t&&(pt+=oe)});const ht=await O();D({monthlyWithdrawalProfit:Math.round(Le*100)/100,monthlyTransferProfit:Math.round(pt*100)/100,monthlySalesProfit:ht,lastUpdated:new Date})}catch(q){console.error("Error loading profit data:",q)}},w=q=>`${Number(q).toLocaleString("en-US",{maximumFractionDigits:0})} Ø¬.Ù…`,$=async()=>{try{const q=(k==null?void 0:k.subscription)||null,re=(q==null?void 0:q.planType)??(q==null?void 0:q.plan)??null,Oe=typeof re=="string"?re.toLowerCase():null;if(re===aa.ZERO||Oe==="zero"||Oe==="0"||re===0)return!0}catch{}try{if(s){const q=await ch(s),re=(q==null?void 0:q.planType)??(q==null?void 0:q.plan)??null,Oe=typeof re=="string"?re.toLowerCase():null;if(re===aa.ZERO||Oe==="zero"||Oe==="0"||re===0)return!0}}catch{}return!1},ce=async()=>{try{if(await $()){Sm({title:"Ø§Ù„Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ",description:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±.",variant:"destructive"});return}}catch{}const q=s||(T==null?void 0:T.uid),re=q?`monthlyReportsLock_v4_${q}`:"monthlyReportsLock_v4",Oe=(localStorage.getItem(re)??localStorage.getItem("monthlyReportsLock_v4"))==="true",ve=await Jt.hasMasterPin(q);Oe&&ve?h(!0):(j(!0),o(!0))},ee=async()=>{try{if(await $()){Sm({title:"Ø§Ù„Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ",description:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±.",variant:"destructive"}),h(!1);return}}catch{}j(!0),o(!0),h(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(A,{size:"sm",variant:"ghost",onClick:ce,className:"h-6 w-6 p-0 text-gray-400 hover:text-purple-600 hover:bg-purple-50 rounded-full transition-colors duration-200",title:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",children:e.jsx(mr,{className:"h-4 w-4"})}),e.jsx(ue,{open:n,onOpenChange:o,children:e.jsxs(me,{className:"max-w-[280px] sm:max-w-[320px] mx-auto bg-white dark:bg-[#0f172a] border border-gray-200 dark:border-slate-800 shadow-xl rounded-xl p-0 overflow-hidden",children:[e.jsx(be,{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-b border-gray-100 dark:border-slate-800",children:e.jsxs(he,{className:"text-sm font-bold text-gray-900 dark:text-slate-100 flex items-center justify-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-full border border-gray-200 dark:border-slate-700",children:e.jsx(Ji,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"})}),"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±"]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-red-50 dark:bg-red-900/20 rounded-md",children:e.jsx(cr,{className:"h-3.5 w-3.5 text-red-600 dark:text-red-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø§Ø³ØªÙ„Ø§Ù…"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:w(C.monthlyWithdrawalProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-green-50 dark:bg-green-900/20 rounded-md",children:e.jsx(uh,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"ØªØ­ÙˆÙŠÙ„"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:w(C.monthlyTransferProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-violet-50 dark:bg-violet-900/20 rounded-md",children:e.jsx(fh,{className:"h-3.5 w-3.5 text-violet-600 dark:text-violet-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:w(C.monthlySalesProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-100 dark:border-purple-900/30 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-md shadow-sm",children:e.jsx(Da,{className:"h-3.5 w-3.5 text-purple-600 dark:text-purple-400"})}),e.jsx("span",{className:"font-bold text-purple-900 dark:text-purple-100 text-sm",children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"})]}),e.jsx("span",{className:"font-bold text-base text-purple-700 dark:text-purple-300",children:w(C.monthlyWithdrawalProfit+C.monthlyTransferProfit+C.monthlySalesProfit)})]})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-t border-gray-100 dark:border-slate-800 flex justify-center",children:e.jsx(A,{onClick:()=>o(!1),className:"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 hover:text-gray-900 w-full sm:w-auto px-8 rounded-lg text-sm font-medium shadow-sm",children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(Wp,{open:l,onOpenChange:h,mode:"verify",title:"Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",description:"Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",userId:s||(T==null?void 0:T.uid),userRole:E==null?void 0:E.role,onSuccess:ee})]})},Vw=s=>e.jsx(Uw,{...s});function qw({open:s,onOpenChange:t,onSuccess:n,userId:o}){const[l,h]=u.useState(""),[p,j]=u.useState(""),[C,D]=u.useState(!1),[k,T]=u.useState(!1),[E,O]=u.useState(""),[U,w]=u.useState(!1),[$,ce]=u.useState(!1),{toast:ee}=to(),q=Q.useRef(null);u.useEffect(()=>{let ve=!0;return(async()=>{const je=await Jt.hasMasterPin(o);ve&&ce(je)})(),()=>{ve=!1}},[o,s]);const re=()=>{h(""),j(""),O(""),D(!1),T(!1),t(!1)},Oe=async ve=>{ve.preventDefault(),O(""),w(!0);try{if($){if(!await Jt.verifyMasterPin(l,o)){O("Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­"),w(!1);return}}else{if(l.length<4){O("ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ 4 Ø£Ø±Ù‚Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„"),w(!1);return}if(l!==p){O("Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚"),w(!1);return}if(!await Jt.createMasterPin(l,o)){O("ØªØ¹Ø°Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"),w(!1);return}}ee({title:"Ù†Ø¬Ø­ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",description:$?"ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¨Ù†Ø¬Ø§Ø­":"ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¨Ù†Ø¬Ø§Ø­"}),n(),re()}catch{O("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ")}finally{w(!1)}};return e.jsx(ue,{open:s,onOpenChange:t,children:e.jsxs(me,{className:"sm:max-w-md",dir:"rtl",children:[e.jsx(be,{children:e.jsxs(he,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(Dm,{className:"h-5 w-5 text-green-600"}),$?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ":"Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"]})}),e.jsxs("form",{ref:q,onSubmit:Oe,className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600 bg-blue-50 p-3 rounded-lg",children:$?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø±Ø¨Ø§Ø­":"Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø±Ø¨Ø§Ø­. ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ±Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø±ÙˆÙÙŠÙ„."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"pin",children:$?"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ":"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{id:"pin",type:C?"text":"password",value:l,onChange:ve=>h(ve.target.value),onKeyDown:ve=>{var je;ve.key==="Enter"&&(ve.preventDefault(),(je=q.current)==null||je.requestSubmit())},placeholder:$?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ":"Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø³Ø±ÙŠ Ø¬Ø¯ÙŠØ¯ (4 Ø£Ø±Ù‚Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)",className:"pr-10",dir:"ltr",autoComplete:"off",required:!0}),e.jsx(A,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>D(!C),children:C?e.jsx(km,{className:"h-4 w-4"}):e.jsx(mr,{className:"h-4 w-4"})})]})]}),!$&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"confirmPin",children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{id:"confirmPin",type:k?"text":"password",value:p,onChange:ve=>j(ve.target.value),onKeyDown:ve=>{var je;ve.key==="Enter"&&(ve.preventDefault(),(je=q.current)==null||je.requestSubmit())},placeholder:"Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",className:"pr-10",dir:"ltr",autoComplete:"off",required:!0}),e.jsx(A,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>T(!k),children:k?e.jsx(km,{className:"h-4 w-4"}):e.jsx(mr,{className:"h-4 w-4"})})]})]}),E&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(Lp,{className:"h-4 w-4"}),E]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(A,{type:"submit",disabled:U,className:"flex-1 bg-green-600 hover:bg-green-700",children:[e.jsx(Dm,{className:"h-4 w-4 mr-2"}),U?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...":$?"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­":"Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"]}),e.jsx(A,{type:"button",variant:"outline",onClick:re,disabled:U,children:"Ø¥Ù„ØºØ§Ø¡"})]})]})]})})}const zw=({userId:s,transactions:t})=>{const[n,o]=u.useState(!1),[l,h]=u.useState(!1),[p,j]=u.useState(!1),[C,D]=u.useState({dailyWithdrawalProfit:0,dailyTransferProfit:0,dailySalesProfit:0,lastUpdated:new Date}),{shopId:k}=dh();u.useEffect(()=>{s&&n&&p&&E()},[s,n,p,t,k]),u.useEffect(()=>{if(!n||!p)return;const $=setInterval(()=>{const ce=new Date;C.lastUpdated.getDate()!==ce.getDate()&&E()},3e4);return()=>clearInterval($)},[n,p,C.lastUpdated]);const T=async()=>{if(!s)return 0;const $=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),ce=$.format(new Date),q=vt.getReportsData(s).lastDailyProfitResetDate||null;let re=0;try{const Oe=Ce(ie(F,"dailySales"),K("userId","==",s),...k?[K("shopId","==",k)]:[]),ve=await pe(Oe),je=[];ve.forEach(de=>{je.push({id:de.id,data:de.data()})}),(await pe(ie(F,"users",s,"dailySales"))).forEach(de=>{const Te=de.data();k&&Te.shopId&&Te.shopId!==k||je.push({id:de.id,data:Te})});const xe=new Map;je.forEach(de=>{const Te=String(de.data.clientId||de.id);xe.has(Te)||xe.set(Te,de.data)}),xe.forEach(de=>{if(de.isDeferred)return;let Te=null;if(de.createdAt)typeof de.createdAt.toDate=="function"?Te=de.createdAt.toDate():de.createdAt instanceof Date?Te=de.createdAt:typeof de.createdAt=="number"?Te=new Date(de.createdAt):typeof de.createdAt=="string"&&(Te=new Date(de.createdAt));else if(de.date){const ht=de.time||"00:00";Te=new Date(`${de.date}T${ht}:00`)}let Le=!1,pt=!0;if(Te&&!isNaN(Te.getTime()))$.format(Te)===ce&&(Le=!0),q&&(pt=Te>=q);else{const ht=String(de.date||"").slice(0,10);if(ht===ce&&(Le=!0),q){const Ue=$.format(q);ht<Ue&&(pt=!1)}}if(Le&&pt){const ht=Number(de.quantity||1),Ue=Number(de.profit??(Number(de.sellingPrice||0)-Number(de.wholesalePrice||0))*ht);re+=Ue}})}catch(Oe){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©:",Oe)}return Math.round(re*100)/100},E=async()=>{if(s)try{if(Array.isArray(t)&&t.length>0){const ee=new Date,q=vt.filterVisibleTransactions(t,"daily",s);let re=0,Oe=0;q.forEach(je=>{const At=new Date(je.createdAt),xe=String(je.status||"confirmed").toLowerCase();if(At.toDateString()!==ee.toDateString())return;const de=(je.type||je.txnType||"").toLowerCase(),Te=String(je.title||"");if(de==="cash_addition"||Te.includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"))return;const Le={type:de==="withdrawal"||de==="machine_withdrawal"?"withdraw":de,amount:Number(je.amount||0),commission:je.commission};Le.type==="withdraw"||Le.type==="atm_withdraw"?re+=Ja.calculateProfitFromTransaction(Le):(Le.type==="send"||Le.type==="receive"||Le.type==="transfer")&&(Oe+=Ja.calculateProfitFromTransaction(Le))});const ve=await T();D({dailyWithdrawalProfit:Math.round(re*100)/100,dailyTransferProfit:Math.round(Oe*100)/100,dailySalesProfit:ve,lastUpdated:new Date});try{Ja.updateProfitsFromTransactions(t,s)}catch{}return}const $=Ja.getWithdrawTransferProfits(s),ce=await T();D({dailyWithdrawalProfit:$.dailyWithdrawProfit||0,dailyTransferProfit:$.dailyTransferProfit||0,dailySalesProfit:ce,lastUpdated:new Date})}catch($){console.error("Error loading profit data:",$)}},O=$=>`${Number($).toLocaleString("en-US",{maximumFractionDigits:0})} Ø¬.Ù…`,U=()=>{Ja.hasProfitPin(s),h(!0)},w=()=>{j(!0),o(!0),h(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(A,{size:"sm",variant:"ghost",onClick:U,className:"h-6 w-6 p-0 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors duration-200",title:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©",children:e.jsx(mr,{className:"h-4 w-4"})}),e.jsx(ue,{open:n,onOpenChange:o,children:e.jsxs(me,{className:"max-w-[280px] sm:max-w-[320px] mx-auto bg-white dark:bg-[#0f172a] border border-gray-200 dark:border-slate-800 shadow-xl rounded-xl p-0 overflow-hidden",children:[e.jsx(be,{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-b border-gray-100 dark:border-slate-800",children:e.jsxs(he,{className:"text-sm font-bold text-gray-900 dark:text-slate-100 flex items-center justify-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-full border border-gray-200 dark:border-slate-700",children:e.jsx(Da,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…"]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-red-50 dark:bg-red-900/20 rounded-md",children:e.jsx(cr,{className:"h-3.5 w-3.5 text-red-600 dark:text-red-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø§Ø³ØªÙ„Ø§Ù…"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:O(C.dailyWithdrawalProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-green-50 dark:bg-green-900/20 rounded-md",children:e.jsx(uh,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"ØªØ­ÙˆÙŠÙ„"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:O(C.dailyTransferProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-violet-50 dark:bg-violet-900/20 rounded-md",children:e.jsx(fh,{className:"h-3.5 w-3.5 text-violet-600 dark:text-violet-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:O(C.dailySalesProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-900/30 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-md shadow-sm",children:e.jsx(Da,{className:"h-3.5 w-3.5 text-blue-600 dark:text-blue-400"})}),e.jsx("span",{className:"font-bold text-blue-900 dark:text-blue-100 text-sm",children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"})]}),e.jsx("span",{className:"font-bold text-base text-blue-700 dark:text-blue-300",children:O(C.dailyWithdrawalProfit+C.dailyTransferProfit+C.dailySalesProfit)})]})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-t border-gray-100 dark:border-slate-800 flex justify-center",children:e.jsx(A,{onClick:()=>o(!1),className:"bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-700 text-gray-700 dark:text-slate-200 hover:bg-gray-50 dark:hover:bg-slate-700 hover:text-gray-900 w-full sm:w-auto px-8 rounded-lg text-sm font-medium shadow-sm",children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(qw,{open:l,onOpenChange:h,onSuccess:w,userId:s})]})},Yw=s=>e.jsx(zw,{...s});var Lc="Radio",[Kw,Yh]=vc(Lc),[Jw,Hw]=Kw(Lc),Kh=u.forwardRef((s,t)=>{const{__scopeRadio:n,name:o,checked:l=!1,required:h,disabled:p,value:j="on",onCheck:C,form:D,...k}=s,[T,E]=u.useState(null),O=wn(t,$=>E($)),U=u.useRef(!1),w=T?D||!!T.closest("form"):!0;return e.jsxs(Jw,{scope:n,checked:l,disabled:p,children:[e.jsx(gr.button,{type:"button",role:"radio","aria-checked":l,"data-state":Gh(l),"data-disabled":p?"":void 0,disabled:p,value:j,...k,ref:O,onClick:ds(s.onClick,$=>{l||C==null||C(),w&&(U.current=$.isPropagationStopped(),U.current||$.stopPropagation())})}),w&&e.jsx(Qh,{control:T,bubbles:!U.current,name:o,value:j,checked:l,required:h,disabled:p,form:D,style:{transform:"translateX(-100%)"}})]})});Kh.displayName=Lc;var Jh="RadioIndicator",Hh=u.forwardRef((s,t)=>{const{__scopeRadio:n,forceMount:o,...l}=s,h=Hw(Jh,n);return e.jsx(wc,{present:o||h.checked,children:e.jsx(gr.span,{"data-state":Gh(h.checked),"data-disabled":h.disabled?"":void 0,...l,ref:t})})});Hh.displayName=Jh;var Qw="RadioBubbleInput",Qh=u.forwardRef(({__scopeRadio:s,control:t,checked:n,bubbles:o=!0,...l},h)=>{const p=u.useRef(null),j=wn(p,h),C=$p(n),D=Bp(t);return u.useEffect(()=>{const k=p.current;if(!k)return;const T=window.HTMLInputElement.prototype,O=Object.getOwnPropertyDescriptor(T,"checked").set;if(C!==n&&O){const U=new Event("click",{bubbles:o});O.call(k,n),k.dispatchEvent(U)}},[C,n,o]),e.jsx(gr.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...l,tabIndex:-1,ref:j,style:{...l.style,...D,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Qh.displayName=Qw;function Gh(s){return s?"checked":"unchecked"}var Gw=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ro="RadioGroup",[Xw]=vc(ro,[hh,Yh]),Xh=hh(),Zh=Yh(),[Zw,eN]=Xw(ro),e0=u.forwardRef((s,t)=>{const{__scopeRadioGroup:n,name:o,defaultValue:l,value:h,required:p=!1,disabled:j=!1,orientation:C,dir:D,loop:k=!0,onValueChange:T,...E}=s,O=Xh(n),U=Fp(D),[w,$]=ih({prop:h,defaultProp:l??null,onChange:T,caller:ro});return e.jsx(Zw,{scope:n,name:o,required:p,disabled:j,value:w,onValueChange:$,children:e.jsx(Px,{asChild:!0,...O,orientation:C,dir:U,loop:k,children:e.jsx(gr.div,{role:"radiogroup","aria-required":p,"aria-orientation":C,"data-disabled":j?"":void 0,dir:U,...E,ref:t})})})});e0.displayName=ro;var t0="RadioGroupItem",a0=u.forwardRef((s,t)=>{const{__scopeRadioGroup:n,disabled:o,...l}=s,h=eN(t0,n),p=h.disabled||o,j=Xh(n),C=Zh(n),D=u.useRef(null),k=wn(t,D),T=h.value===l.value,E=u.useRef(!1);return u.useEffect(()=>{const O=w=>{Gw.includes(w.key)&&(E.current=!0)},U=()=>E.current=!1;return document.addEventListener("keydown",O),document.addEventListener("keyup",U),()=>{document.removeEventListener("keydown",O),document.removeEventListener("keyup",U)}},[]),e.jsx(Mx,{asChild:!0,...j,focusable:!p,active:T,children:e.jsx(Kh,{disabled:p,required:h.required,checked:T,...C,...l,name:h.name,ref:k,onCheck:()=>h.onValueChange(l.value),onKeyDown:ds(O=>{O.key==="Enter"&&O.preventDefault()}),onFocus:ds(l.onFocus,()=>{var O;E.current&&((O=D.current)==null||O.click())})})})});a0.displayName=t0;var tN="RadioGroupIndicator",s0=u.forwardRef((s,t)=>{const{__scopeRadioGroup:n,...o}=s,l=Zh(n);return e.jsx(Hh,{...l,...o,ref:t})});s0.displayName=tN;var r0=e0,n0=a0,aN=s0;const i0=u.forwardRef(({className:s,...t},n)=>e.jsx(r0,{className:Ia("grid gap-2",s),...t,ref:n}));i0.displayName=r0.displayName;const Gi=u.forwardRef(({className:s,...t},n)=>e.jsx(n0,{ref:n,className:Ia("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:e.jsx(aN,{className:"flex items-center justify-center",children:e.jsx(Cx,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Gi.displayName=n0.displayName;const sN=({isOpen:s,onClose:t,userId:n,wallets:o,walletBalances:l,onSuccess:h})=>{const{toast:p}=to(),[j,C]=u.useState(1),[D,k]=u.useState(""),[T,E]=u.useState(""),[O,U]=u.useState(""),[w,$]=u.useState("cash"),[ce,ee]=u.useState(""),[q,re]=u.useState(!1),[Oe,ve]=u.useState(!1);u.useEffect(()=>{s&&(C(1),k(""),E(""),U(""),$("cash"),ee(""))},[s]);const je=()=>{if(!D||parseFloat(D)<=0){p({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}if(!O){p({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}const xe=l[O]||0;if(parseFloat(D)>xe){p({title:"Ø®Ø·Ø£",description:"Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ØºÙŠØ± ÙƒØ§ÙÙ",variant:"destructive"});return}C(2)},At=async()=>{var xe;if(w==="wallet"&&!ce){p({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ©",variant:"destructive"});return}re(!0);try{const de=parseFloat(D),Te=T?parseFloat(T):0,Le=de+Te,pt=de,ht=Me(F,"users",n),Ue=await fa(ht);if(!Ue.exists())throw"User document not found";const ne=Ue.data().walletBalances||{},L=Number(ne[O]||0);if(console.log("[AtmWithdrawDialog] Validation:",{sourceWalletId:O,currentSourceBalance:L,numericAmount:de,numericCommission:Te,totalDeductedFromWallet:Le}),L<Le)throw`Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ØºÙŠØ± ÙƒØ§ÙÙ (Ø§Ù„Ù…ØªØ§Ø­: ${L}, Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø®ØµÙ…Ù‡: ${Le})`;const Ke=await Ka.canPerformOperation(O,de,"transfer");if(!Ke.canPerform)throw Ke.message||"ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø³Ù…ÙˆØ­";const xt=gc(F),_t={};_t[`walletBalances.${O}`]=ec(-Le);let J="";w==="wallet"&&ce?(_t[`walletBalances.${ce}`]=ec(pt),J=`Wallet: ${(xe=o.find(Ie=>Ie.id===ce))==null?void 0:xe.name}`):w==="cash"?(_t.cashBalance=ec(pt),J="Cash Drawer"):J="No Addition",xt.update(ht,_t);const oe=o.find(Ie=>Ie.id===O),te=Me(ie(F,"userTransactions"));xt.set(te,{userId:n,type:"atm_withdraw",amount:de,commission:Te,totalCharged:Le,netAmount:pt,sourceWalletId:O,destinationType:w,destinationWalletId:w==="wallet"?ce:null,status:"completed",createdAt:wt(),note:`Ø³Ø­Ø¨ ATM Ù…Ù† ${oe==null?void 0:oe.name}`,walletId:O,sender_msisdn:(oe==null?void 0:oe.phone)||"",details:`ATM Withdraw from ${oe==null?void 0:oe.name} -> ${J}`}),await xt.commit();try{await Ka.updateUsage(O,de,"transfer")}catch(Ie){console.error("Failed to update wallet limits:",Ie)}if(Te>0)try{Ja.addProfit(-Te,n)}catch(Ie){console.error("Failed to update profits:",Ie)}let Fe={};if(w==="cash")Fe={delta:{amount:pt,commission:Te,totalDeducted:Le,type:"atm_withdraw",walletId:O}};else{const Ie={...l};Ie[O]=(Ie[O]||0)-Le,w==="wallet"&&(Ie[ce]=(Ie[ce]||0)+pt),Fe={walletBalances:Ie}}window.dispatchEvent(new CustomEvent("dashboard:external-update",{detail:Fe})),p({title:"Ù†Ø¬Ø§Ø­",description:"ØªÙ…Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­"}),h==null||h(),t()}catch(de){console.error("ATM Withdraw Error:",de),p({title:"Ø®Ø·Ø£",description:typeof de=="string"?de:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",variant:"destructive"})}finally{re(!1)}};return e.jsxs(ue,{open:s,onOpenChange:t,children:[e.jsxs(me,{className:"sm:max-w-[425px]",dir:"rtl",children:[e.jsxs(be,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:["Ø³Ø­Ø¨ ATM",e.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>ve(!0),className:"gap-1 px-2 text-rose-600 hover:text-rose-700 hover:bg-rose-50 mx-2",children:[e.jsx(Ki,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Ø´Ø±Ø­ Ù‚Ø³Ù… atm"})]})]}),e.jsx(Ze,{children:j===1?"Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø³Ø­Ø¨":"Ø§Ø®ØªØ± Ù…ÙƒØ§Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"})]}),j===1?e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{children:"Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø­Ø¨"}),e.jsx(X,{type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:D,onChange:xe=>k(xe.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø®ØµÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx(X,{type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©",value:T,onChange:xe=>E(xe.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{children:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø³Ø­Ø¨ Ù…Ù†Ù‡Ø§"}),e.jsxs(Va,{value:O,onValueChange:U,children:[e.jsx(qa,{children:e.jsx(za,{placeholder:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})}),e.jsx(Ya,{children:o.map(xe=>e.jsx(la,{value:xe.id,children:e.jsxs("div",{className:"flex justify-between w-full gap-4",children:[e.jsx("span",{children:xe.phone||xe.name}),e.jsx("span",{className:"text-muted-foreground text-xs",children:l[xe.id]?`${Number(l[xe.id]).toLocaleString("en-US",{maximumFractionDigits:0})} Ø¬.Ù…`:"0 Ø¬.Ù…"})]})},xe.id))})]})]})]}):e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-muted p-4 rounded-lg mb-4",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Ø§Ù„Ù…Ø¨Ù„Øº:"}),e.jsxs("span",{className:"font-bold",children:[D?Number(D).toLocaleString("en-US",{maximumFractionDigits:0}):0," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (Ø®ØµÙ… Ø¥Ø¶Ø§ÙÙŠ):"}),e.jsxs("span",{className:"font-bold text-red-500",children:[T?Number(T).toLocaleString("en-US",{maximumFractionDigits:0}):0," Ø¬.Ù…"]})]}),parseFloat(T)>0&&e.jsx("div",{className:"text-[10px] text-amber-600 mb-2 text-right",children:"* Ø³ÙŠØªÙ… Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ù…Ù† Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø´Ù‡Ø±"}),e.jsxs("div",{className:"flex justify-between mb-2 pt-2 border-t border-dashed",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©:"}),e.jsxs("span",{className:"font-bold text-red-600",children:[(Number(D)+(Number(T)||0)).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¶Ø§Ù Ù„Ù„ÙˆØ¬Ù‡Ø©:"}),e.jsxs("span",{className:"font-bold text-green-600",children:[D?Number(D).toLocaleString("en-US",{maximumFractionDigits:0}):0," Ø¬.Ù…"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Z,{children:"Ù…ÙƒØ§Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),e.jsxs(i0,{value:w,onValueChange:xe=>$(xe),className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(Gi,{value:"cash",id:"r1"}),e.jsx(Z,{htmlFor:"r1",className:"cursor-pointer",children:"Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ (Cash Drawer)"})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(Gi,{value:"wallet",id:"r2"}),e.jsx(Z,{htmlFor:"r2",className:"cursor-pointer",children:"Ù…Ø­ÙØ¸Ø© Ø£Ø®Ø±Ù‰"})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(Gi,{value:"none",id:"r3"}),e.jsx(Z,{htmlFor:"r3",className:"cursor-pointer",children:"Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ© (Ø³Ø­Ø¨ ÙÙ‚Ø·)"})]})]})]}),w==="wallet"&&e.jsxs("div",{className:"space-y-2 mt-4 animate-in fade-in slide-in-from-top-2",children:[e.jsx(Z,{children:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ©"}),e.jsxs(Va,{value:ce,onValueChange:ee,children:[e.jsx(qa,{children:e.jsx(za,{placeholder:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})}),e.jsx(Ya,{children:o.filter(xe=>xe.id!==O).map(xe=>e.jsx(la,{value:xe.id,children:xe.phone||xe.name},xe.id))})]})]})]}),e.jsxs($e,{className:"flex-col sm:flex-row gap-2",children:[j===2&&e.jsx(A,{variant:"outline",onClick:()=>C(1),disabled:q,children:"Ø¹ÙˆØ¯Ø©"}),j===1?e.jsxs(A,{onClick:je,className:"w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white",children:["Ø§Ù„ØªØ§Ù„ÙŠ ",e.jsx(Up,{className:"mr-2 h-4 w-4"})]}):e.jsxs(A,{onClick:At,disabled:q,className:"w-full sm:w-auto bg-green-600 hover:bg-green-700",children:[q&&e.jsx(cs,{className:"mr-2 h-4 w-4 animate-spin"}),"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³Ø­Ø¨"]})]})]}),e.jsx(mh,{isOpen:Oe,onClose:()=>ve(!1),videoUrl:"https://www.youtube.com/watch?v=V_wM36ICBck",title:"Ø´Ø±Ø­ Ù‚Ø³Ù… ATM",className:"z-[10002]"})]})};class dr{static async processTransfer(t){const{amount:n,currentCashBalance:o,currentWalletBalances:l,wallets:h,selectedWalletId:p}=t;if(n<=0)return{success:!1,newCashBalance:o,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};if(p&&!t.skipRemoteLimitsCheck)try{const k=await Ka.canPerformOperation(p,n,"transfer");if(!k.canPerform)return{success:!1,newCashBalance:o,newWalletBalances:l,message:k.message||"ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰",error:"LIMIT_EXCEEDED"}}catch(k){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„:",k),{success:!1,newCashBalance:o,newWalletBalances:l,message:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",error:"LIMIT_CHECK_ERROR"}}if(n<=0)return{success:!1,newCashBalance:o,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};if(p){const k=Math.max(l[p]||0,0);if(k<n){const T=h.find(E=>E.id===p);return{success:!1,newCashBalance:o,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©${T?` ${T.name}`:""}. Ø§Ù„Ù…ØªØ§Ø­: ${k} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${n} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_WALLET_BALANCE"}}}else{const k=dr.calculateTotalWalletBalance(l);if(k<n)return{success:!1,newCashBalance:o,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­: ${k} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${n} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_WALLET_BALANCE"}}const j={...l};if(p){const k=j[p]||0;j[p]=k-n}else{let k=n;for(const T of h){if(k<=0)break;const E=Math.max(j[T.id]||0,0),O=Math.min(E,k);O>0&&(j[T.id]=(j[T.id]||0)-O,k-=O)}}const C=o+n;let D="ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­";if(p){const k=j[p]||0;k<0&&(D=`ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­ Ù…Ø¹ ØªØ­Ø°ÙŠØ±: Ø±ØµÙŠØ¯ Ù…Ø­ÙØ¸Ø© ${p} Ø£ØµØ¨Ø­ ${k} Ø¬Ù†ÙŠÙ‡.`)}return{success:!0,newCashBalance:C,newWalletBalances:j,message:D}}static processDeposit(t){const{amount:n,currentCashBalance:o,currentWalletBalances:l,wallets:h}=t;if(n<=0)return{success:!1,newCashBalance:o,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};const p=this.calculateTotalWalletBalance(l);if(p<n)return{success:!1,newCashBalance:o,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­: ${p} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${n} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_WALLET_BALANCE"};const j=o+n,C={...l};let D=n;const k=h.find(E=>E.isDefault);if(k&&C[k.id]>=D)C[k.id]-=D,D=0;else for(const E of h){if(D<=0)break;const O=C[E.id]||0;if(O>0){const U=Math.min(O,D);C[E.id]=O-U,D-=U}}const T=D>0?`ØªÙ… Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ø¬Ø²Ø¦ÙŠØ§Ù‹. ØªÙ… Ø¥ÙŠØ¯Ø§Ø¹ ${n-D} Ø¬Ù†ÙŠÙ‡ ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©`:`ØªÙ… Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ø¨Ù†Ø¬Ø§Ø­. ØªÙ… Ø¥Ø¶Ø§ÙØ© ${n} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©`;return{success:!0,newCashBalance:j,newWalletBalances:C,message:T}}static async processWithdraw(t){const{amount:n,currentCashBalance:o,currentWalletBalances:l,wallets:h,selectedWalletId:p}=t;if(n<=0)return{success:!1,newCashBalance:o,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};if(p&&!t.skipRemoteLimitsCheck)try{const k=await Ka.canPerformOperation(p,n,"withdraw");if(!k.canPerform)return{success:!1,newCashBalance:o,newWalletBalances:l,message:k.message||"ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰",error:"LIMIT_EXCEEDED"}}catch(k){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø³Ø­Ø¨:",k),{success:!1,newCashBalance:o,newWalletBalances:l,message:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø³Ø­Ø¨",error:"LIMIT_CHECK_ERROR"}}if(o<n)return{success:!1,newCashBalance:o,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­: ${o} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${n} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_CASH_BALANCE"};const j=Math.round(o-n),C={...l},D=p?h.find(k=>k.id===p):h.find(k=>k.isDefault)||h[0];if(D){const k=C[D.id]||0;C[D.id]=k+n}else return{success:!1,newCashBalance:o,newWalletBalances:l,message:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…ØªØ§Ø­Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø¥Ù„ÙŠÙ‡Ø§",error:"NO_WALLETS_AVAILABLE"};return{success:!0,newCashBalance:j,newWalletBalances:C,message:`ØªÙ… Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­. ØªÙ… Ø¥Ø¶Ø§ÙØ© ${n} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ Ù…Ø­ÙØ¸Ø© ${(D==null?void 0:D.name)||""}`}}static validateOperation(t,n){return t<=0?{valid:!1,error:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±"}:!n||n.length===0?{valid:!1,error:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…ØªØ§Ø­Ø©"}:{valid:!0}}static calculateTotalWalletBalance(t){return Object.values(t).reduce((n,o)=>n+Math.max(o,0),0)}static deductFromWalletsAddToCash(t,n,o,l){return this.processTransfer({amount:t,currentCashBalance:n,currentWalletBalances:o,wallets:l})}static deductFromWalletsAddToCashDeposit(t,n,o,l){return this.processDeposit({amount:t,currentCashBalance:n,currentWalletBalances:o,wallets:l})}static deductFromCashAddToWallets(t,n,o,l){return this.processWithdraw({amount:t,currentCashBalance:n,currentWalletBalances:o,wallets:l})}static applyTransactionResult(t,n,o){t.success&&(n(t.newCashBalance),o(t.newWalletBalances))}static validateTransaction(t,n,o,l){if(t<=0)return{isValid:!1,error:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±"};if(n==="transfer"){const h=this.calculateTotalWalletBalance(l);if(h<t)return{isValid:!1,error:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸ (${h} Ø¬Ù†ÙŠÙ‡) ØºÙŠØ± ÙƒØ§ÙÙŠ Ù„Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (${t} Ø¬Ù†ÙŠÙ‡)`}}else if(n==="withdraw"){if(o<t)return{isValid:!1,error:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© (${o} Ø¬Ù†ÙŠÙ‡) ØºÙŠØ± ÙƒØ§ÙÙŠ Ù„Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (${t} Ø¬Ù†ÙŠÙ‡)`}}else if(n==="deposit"){const h=this.calculateTotalWalletBalance(l);if(h<t)return{isValid:!1,error:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸ (${h} Ø¬Ù†ÙŠÙ‡) ØºÙŠØ± ÙƒØ§ÙÙŠ Ù„Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (${t} Ø¬Ù†ÙŠÙ‡)`}}return{isValid:!0}}static getDeductionPreview(t,n,o){const l=[];let h=t;for(const p of o){if(h<=0)break;const j=n[p.id]||0,C=Math.min(Math.max(j,0),h);C>0&&(l.push({walletId:p.id,walletName:p.name,currentBalance:j,deductedAmount:C,newBalance:j-C}),h-=C)}return l}}let xn=null;function rN(){const s=window;if(!xn){const t=s.AudioContext||s.webkitAudioContext;xn=new t}return xn.state==="suspended"&&xn.resume(),xn}function nN(s,t,n){const o=n/1e3,l=Math.floor(s.sampleRate*o),h=s.createBuffer(1,l,s.sampleRate),p=h.getChannelData(0);for(let k=0;k<l;k++)p[k]=(Math.random()*2-1)*.6;const j=s.createBufferSource();j.buffer=h;const C=s.createBiquadFilter();C.type="highpass",C.frequency.value=1500,C.Q.value=.7;const D=s.createGain();D.gain.setValueAtTime(1e-4,t),D.gain.exponentialRampToValueAtTime(.4,t+.015),D.gain.exponentialRampToValueAtTime(1e-4,t+o),j.connect(C),C.connect(D),D.connect(s.destination),j.start(t),j.stop(t+o+.01)}function iN(s,t,n,o,l,h="triangle"){const p=s.createOscillator(),j=s.createGain();p.type=h;const C=l/1e3;p.frequency.setValueAtTime(n,t),p.frequency.linearRampToValueAtTime(o,t+C),j.gain.setValueAtTime(1e-4,t),j.gain.exponentialRampToValueAtTime(.25,t+.02),j.gain.exponentialRampToValueAtTime(1e-4,t+C),p.connect(j),j.connect(s.destination),p.start(t),p.stop(t+C+.02)}function oN(){try{const s=rN(),t=s.currentTime;nN(s,t,90),iN(s,t+.12,1900,1100,180,"sawtooth")}catch{}}function lN(s){if(!s)return!1;const n=s.replace(/[^0-9Ù -Ù©]/g,"").replace(/[Ù -Ù©]/g,o=>"0123456789"["Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©".indexOf(o)]);return/^(010|011|012|015)[0-9]{8}$/.test(n)}const cN=({isOpen:s,onClose:t,senderPhone:n,receiverPhone:o,amount:l,deviceId:h,api:p})=>{const{toast:j}=to(),[C,D]=u.useState(1),[k,T]=u.useState(!1),[E,O]=u.useState("");u.useEffect(()=>{s&&(D(1),O(""))},[s]);const U=async re=>{try{return p&&typeof p.enterPin=="function"?(await p.enterPin(h,re),!0):!1}catch(Oe){return console.error("ADB error:",Oe),j({title:"Ø®Ø·Ø£ ADB",description:Oe.message||"ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„",variant:"destructive"}),!1}},w=async()=>{if(!E){j({title:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}T(!0);const re=await U(E);T(!1),re&&D(2)},$=async()=>{T(!0);const re=await U(String(l));T(!1),re&&D(3)},ce=async()=>{T(!0);const re=await U(o);T(!1),re&&D(4)},ee=async()=>{T(!0);const re=await U(o);T(!1),re&&D(5)},q=async()=>{T(!0);const re=await U("1");T(!1),re&&(j({title:"ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­",description:"ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©"}),t())};return e.jsx(ue,{open:s,onOpenChange:re=>!re&&t(),children:e.jsxs(me,{className:"sm:max-w-[400px]",children:[e.jsxs(be,{children:[e.jsx(he,{children:"ØªØ­ÙˆÙŠÙ„ Ø§ØªØµØ§Ù„Ø§Øª ÙƒØ§Ø´ (USSD)"}),e.jsxs(Ze,{children:[C===1&&"Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©",C===2&&"Ø§Ù„Ø®Ø·ÙˆØ© 2: ØªØ£ÙƒÙŠØ¯ Ù…Ø¨Ù„Øº Ø§Ù„ØªØ­ÙˆÙŠÙ„",C===3&&"Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",C===4&&"Ø§Ù„Ø®Ø·ÙˆØ© 4: ØªØ£ÙƒÙŠØ¯ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",C===5&&"Ø§Ù„Ø®Ø·ÙˆØ© 5: ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©"]})]}),e.jsxs("div",{className:"py-4 space-y-4",children:[C===1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ (PIN)"}),e.jsx(X,{type:"password",value:E,onChange:re=>O(re.target.value),placeholder:"****",autoFocus:!0,className:"text-center text-lg tracking-widest",maxLength:6,onKeyDown:re=>{re.key==="Enter"&&E&&w()}})]}),C===2&&e.jsxs("div",{className:"text-center bg-gray-50 dark:bg-slate-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¨Ù„Øº:"}),e.jsx("p",{className:"text-2xl font-bold font-mono tracking-wider",children:l})]}),C===3&&e.jsxs("div",{className:"text-center bg-gray-50 dark:bg-slate-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„:"}),e.jsx("p",{className:"text-2xl font-bold font-mono tracking-wider",children:o})]}),C===4&&e.jsxs("div",{className:"text-center bg-gray-50 dark:bg-slate-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù‚Ù… Ù…Ø±Ø© Ø£Ø®Ø±Ù‰:"}),e.jsx("p",{className:"text-2xl font-bold font-mono tracking-wider",children:o})]}),C===5&&e.jsxs("div",{className:"text-center bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-100 dark:border-green-900",children:[e.jsx("p",{className:"text-lg font-bold text-green-700 dark:text-green-400 mb-2",children:"Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ£ÙƒÙŠØ¯"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù‚Ù… 1 Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„"})]})]}),e.jsxs($e,{children:[C===1&&e.jsx(A,{onClick:w,disabled:k||!E,className:"w-full bg-black hover:bg-neutral-800 text-white",children:k?e.jsx(cs,{className:"animate-spin h-4 w-4 mr-2"}):"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ"}),C===2&&e.jsx(A,{onClick:$,disabled:k,className:"w-full bg-black hover:bg-neutral-800 text-white",children:k?e.jsx(cs,{className:"animate-spin h-4 w-4 mr-2"}):"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¨Ù„Øº"}),C===3&&e.jsx(A,{onClick:ce,disabled:k,className:"w-full bg-black hover:bg-neutral-800 text-white",children:k?e.jsx(cs,{className:"animate-spin h-4 w-4 mr-2"}):"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù‚Ù…"}),C===4&&e.jsx(A,{onClick:ee,disabled:k,className:"w-full bg-black hover:bg-neutral-800 text-white",children:k?e.jsx(cs,{className:"animate-spin h-4 w-4 mr-2"}):"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù‚Ù…"}),C===5&&e.jsx(A,{onClick:q,disabled:k,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:k?e.jsx(cs,{className:"animate-spin h-4 w-4 mr-2"}):"ØªØ£ÙƒÙŠØ¯ (1)"})]})]})})},dN=Q.lazy(()=>le(()=>import("./index-DhbnydJl.js").then(s=>s.cV),__vite__mapDeps([0,1]),import.meta.url).then(s=>({default:s.BranchRequestDialog}))),uN=Q.lazy(()=>le(()=>import("./WalletManagement-lpVl8Tb_.js"),__vite__mapDeps([2,0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url)),mN=Q.lazy(()=>le(()=>import("./TransactionDetailsModal-Bpv925j7.js"),__vite__mapDeps([17,0,1,18,3,13,10,19,15,16]),import.meta.url)),hN=Q.lazy(()=>le(()=>import("./ReceiptModal-Dqs_G1Fp.js"),__vite__mapDeps([20,0,1,18,3,9,21,16,19,22]),import.meta.url)),sh=Q.lazy(()=>le(()=>import("./EditBalanceDialog-BgDrnmkH.js"),__vite__mapDeps([23,0,1,13]),import.meta.url).then(s=>({default:s.EditBalanceDialog}))),fN=Q.lazy(()=>le(()=>import("./ChangePinDialog-CtkqDawM.js"),__vite__mapDeps([24,0,1]),import.meta.url).then(s=>({default:s.ChangePinDialog}))),gN=Q.lazy(()=>le(()=>import("./ChangeCashPinDialog-D25KmpUO.js"),__vite__mapDeps([25,0,1,13]),import.meta.url).then(s=>({default:s.ChangeCashPinDialog}))),pN=Q.lazy(()=>le(()=>import("./ChangeWalletTotalPinDialog-CC56Q8bH.js"),__vite__mapDeps([26,0,1,4]),import.meta.url).then(s=>({default:s.ChangeWalletTotalPinDialog}))),xN=Q.lazy(()=>le(()=>import("./index-DhbnydJl.js").then(s=>s.cT),__vite__mapDeps([0,1]),import.meta.url)),ta=Q.lazy(()=>le(()=>import("./index-DhbnydJl.js").then(s=>s.cU),__vite__mapDeps([0,1]),import.meta.url)),yN=Q.lazy(()=>le(()=>import("./AddToWalletDialog-Dr55h_jx.js"),__vite__mapDeps([27,0,1]),import.meta.url).then(s=>({default:s.AddToWalletDialog}))),bN=Q.lazy(()=>le(()=>import("./CalculatorDialog-Z7R2w5Q2.js"),__vite__mapDeps([28,0,1,18,3]),import.meta.url).then(s=>({default:s.CalculatorDialog}))),vN=Q.lazy(()=>le(()=>import("./SalesDataDialog-DbxS8Orm.js"),__vite__mapDeps([29,0,1,30,31,32,33,9,3,34,35,11,13,10,36,19,37,7,12,15,18,38,39,6,16,40,41,42,43,44,45,46,4,5]),import.meta.url).then(s=>({default:s.SalesDataDialog}))),wN=Q.lazy(()=>le(()=>import("./CashSummaryDialog-C52yFq-V.js"),__vite__mapDeps([47,0,1,13,18,3,48,35,38,39,6,15,16,36,40,7,31,32,33,41,42,43,44,45,10,46,4,19,5]),import.meta.url).then(s=>({default:s.CashSummaryDialog}))),NN=Q.lazy(()=>le(()=>import("./CreditCardsDialog-CCiftUNp.js"),__vite__mapDeps([49,0,1,16,37,10,13]),import.meta.url)),jN=Q.lazy(()=>le(()=>import("./InstallmentModal-BmQdY6-Y.js"),__vite__mapDeps([50,0,1,35,18,3,10]),import.meta.url)),SN=Q.lazy(()=>le(()=>import("./SimCardsDialog-BmPZk43L.js"),__vite__mapDeps([51,0,1,34,30,3,15,18,31,32,52,36]),import.meta.url).then(s=>({default:s.SimCardsDialog}))),DN=Q.lazy(()=>le(()=>import("./AdslCardsDialog-DnwdWQ1o.js"),__vite__mapDeps([53,0,1,30,52,18,3,31,32,36]),import.meta.url).then(s=>({default:s.AdslCardsDialog}))),kN=Q.lazy(()=>le(()=>import("./MaintenanceDialog-nfkRI82d.js"),__vite__mapDeps([54,0,1,9,35,45,16]),import.meta.url).then(s=>({default:s.default}))),CN=Q.lazy(()=>le(()=>import("./MachineDailyDialog-C6u48mG9.js"),__vite__mapDeps([55,0,1,9,34,3,35,10]),import.meta.url)),IN=Q.lazy(()=>le(()=>import("./WalletsManagement-BtpHhaWq.js"),__vite__mapDeps([56,0,1,8,3,57,21,19,4,7,36,22,6]),import.meta.url).then(s=>({default:s.WalletsManagement}))),AN=Q.lazy(()=>le(()=>import("./WalletsListDialog-BjLLZll8.js"),__vite__mapDeps([58,0,1,4]),import.meta.url).then(s=>({default:s.WalletsListDialog}))),rh=Q.lazy(()=>le(()=>import("./WalletPrinterDialog-B3yID8sa.js"),__vite__mapDeps([57,0,1,21,19,4,7,36,22]),import.meta.url)),_N=Q.lazy(()=>le(()=>import("./PendingOperationsDialog-DHtlVqdx.js"),__vite__mapDeps([59,0,1]),import.meta.url).then(s=>({default:s.PendingOperationsDialog}))),TN=Q.lazy(()=>le(()=>import("./DailyArchiveHistoryDialog-BdBPcYco.js"),__vite__mapDeps([60,0,1]),import.meta.url).then(s=>({default:s.DailyArchiveHistoryDialog}))),PN=Q.lazy(()=>le(()=>import("./CashierShiftModal-DYko4Nf1.js"),__vite__mapDeps([61,0,1,3,35,62]),import.meta.url)),MN=Q.lazy(()=>le(()=>import("./ShiftProfileDialog-BgmLjeqX.js"),__vite__mapDeps([63,0,1]),import.meta.url)),ON=Q.lazy(()=>le(()=>import("./ChangeLogDialog-DGhk6mEY.js"),__vite__mapDeps([64,0,1,65]),import.meta.url));function EN({userId:s}){const[t,n]=Q.useState(null),[o,l]=Q.useState("");return null}const fc=s=>{try{const t=String(s||"").replace(/[^0-9+]/g,"");if(!t)return"";if(t.startsWith("+20")){const n=t.slice(3);return n.startsWith("1")?"0"+n:n}if(t.startsWith("0020")){const n=t.slice(4);return n.startsWith("1")?"0"+n:n}if(t.startsWith("20")){const n=t.slice(2);return n.startsWith("1")?"0"+n:n}return t.startsWith("0")?t:/^(10|11|12|15)/.test(t)?"0"+t:t}catch{return""}},RN=()=>{var fm,gm,pm,xm,ym,bm,vm,wm,Nm;console.log("ðŸ”¥ UserDashboardPage component is loading...");const{signOut:s,user:t,profile:n,userData:o}=Nc(),l=((t==null?void 0:t.email)||"").toLowerCase()==="vodafonecash00@gmail.com",h=lh(),p=Vp(),j=qp(),{isShiftActive:C,shiftUser:D}=zp(),{shopId:k,shopName:T}=dh(),E=Yp(),O=Kp(),U=((fm=lr)==null?void 0:fm.isNativePlatform)&&lr.getPlatform()==="android",{toast:w}=to(),[$,ce]=u.useState(!1),[ee,q]=u.useState(""),[re,Oe]=u.useState("");u.useEffect(()=>{const a=()=>{try{const i=(t==null?void 0:t.uid)||"default",c=localStorage.getItem(`sim1Number_${i}`)??localStorage.getItem("sim1Number")??"",d=localStorage.getItem(`sim2Number_${i}`)??localStorage.getItem("sim2Number")??"";q(c),Oe(d)}catch{}};a();const r=i=>{i.detail?(q(i.detail.sim1||""),Oe(i.detail.sim2||"")):a()};return window.addEventListener("simNumbersChanged",r),window.addEventListener("storage",a),()=>{window.removeEventListener("simNumbersChanged",r),window.removeEventListener("storage",a)}},[t==null?void 0:t.uid]);const[ve,je]=u.useState(!1),[At,xe]=u.useState(""),[de,Te]=u.useState(""),Le=(a,r)=>{xe(a),Te(r),je(!0)};u.useEffect(()=>{if(t&&o){const a=o.isActive,r=Cm(o.subscription),i=o.isOnFreeTrial||!1,c=o.hasSeenWelcomeModal===!0;if(a&&(r||i)&&!c){const d=setTimeout(()=>{ce(!0)},1500);return()=>clearTimeout(d)}}},[t,o]);const pt=async()=>{if(ce(!1),t!=null&&t.uid)try{await ea(Me(F,"users",t.uid),{hasSeenWelcomeModal:!0})}catch(a){console.error("Failed to update welcome modal status",a)}},ht=u.useRef(null),[Ue,tt]=u.useState(0),[ne,L]=u.useState(!1),[Ke,xt]=u.useState(!1),[_t,J]=u.useState(!1),[oe,te]=u.useState(!1),[Fe,Ie]=u.useState(0);u.useEffect(()=>{if(!(t!=null&&t.uid))return;const a=Ce(ie(F,"pendingOperations"),K("userId","==",t.uid),K("status","==","pending")),r=ln(a,i=>{Ie(i.size)});return()=>r()},[t==null?void 0:t.uid]);const ke=(a,r)=>{if(C&&(D!=null&&D.permissions)&&D.permissions[a]===!1){xt(!0);return}r()},it=()=>{const a=(o==null?void 0:o.simSubscription)||(t==null?void 0:t.simSubscription);let r=!1;a!=null&&a.active&&(a!=null&&a.endsAt)&&(a.endsAt.seconds?new Date(a.endsAt.seconds*1e3):new Date(a.endsAt))>new Date&&(r=!0),r?ei(!0):ia(!0)},[Ft,ya]=u.useState(!1),[Ta,ia]=u.useState(!1),[Cn,_s]=u.useState(!1),[Ts,pr]=u.useState(!1),[In,An]=u.useState(!1),[Fc,no]=u.useState(!1),_n=u.useRef(!1),[ae,Pa]=u.useState(()=>{try{const a=Object.keys(localStorage).find(i=>i.startsWith("wallets_")),r=a?localStorage.getItem(a):null;if(r){const i=JSON.parse(r);if(Array.isArray(i))return i}}catch{}return[]}),[Ps,io]=u.useState([]);u.useEffect(()=>{var a;(a=h.state)!=null&&a.openProfileSettings&&(L(!0),window.history.replaceState({},document.title))},[h.state]),u.useEffect(()=>{if(t!=null&&t.uid){const a=`linesPinEnabled_${t.uid}`;if((localStorage.getItem(a)??localStorage.getItem("linesPinEnabled"))==="true"&&pr(!0),o&&o.linesPinEnabled!==void 0){const i=o.linesPinEnabled;pr(i),localStorage.setItem(a,i?"true":"false")}}},[t==null?void 0:t.uid,o]);const o0=async()=>{var i,c,d;const a="alkaptin678678@gmail.com",r=(c=(i=or.currentUser)==null?void 0:i.email)==null?void 0:c.toLowerCase();if(!r||r!==a){w({title:"Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹."});return}if(!vi||!wi||!Ni){w({title:"Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©",description:"Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ØŒ Ø§Ù„Ø´Ø±ÙƒØ© ÙˆØ§Ù„Ù…Ø¨Ù„Øº",variant:"destructive"});return}try{Eu(!0);const m=await((d=or.currentUser)==null?void 0:d.getIdToken()),f=await fetch("/api/topup",{method:"POST",headers:{"Content-Type":"application/json",...m?{Authorization:`Bearer ${m}`}:{}},body:JSON.stringify({phone:vi,countryCode:"EG",operator:wi,amount:Number(Ni),useLocalAmount:!0})}),g=await f.json().catch(()=>({}));f.ok&&(g!=null&&g.success)?(w({title:"ØªÙ… Ø§Ù„Ø´Ø­Ù†",description:(g==null?void 0:g.message)||"ØªÙ… ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø­Ù† Ø¨Ù†Ø¬Ø§Ø­"}),Tl(!1),Tu(""),Pu(""),Mu("")):w({title:"ÙØ´Ù„ Ø§Ù„Ø´Ø­Ù†",description:(g==null?void 0:g.message)||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø­Ù†",variant:"destructive"})}catch(m){console.error("Topup request error:",m),w({title:"Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹",description:"ØªØ¹Ø°Ù‘Ø± ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø­Ù†. Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹.",variant:"destructive"})}finally{Eu(!1)}};(()=>{try{return!!window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron")||typeof window<"u"&&window.location&&window.location.protocol==="file:"}catch{return!1}})();const[l0,Tn]=u.useState(!1),[c0,d0]=u.useState(!1),[u0,m0]=u.useState(!1),[h0,oo]=u.useState(!1),[xr,yr]=u.useState(!1),[f0,br]=u.useState(!1),[vr,lo]=u.useState([]),[$c,co]=u.useState(""),[Bc,uo]=u.useState(""),[Uc,mo]=u.useState(""),[Vc,ho]=u.useState(""),[fo,Pn]=u.useState(!1),[g0,go]=u.useState(!1),[p0,WN]=u.useState(null),[qc,zc]=u.useState(""),[Yc,Kc]=u.useState(""),[x0,Jc]=u.useState(!1),[y0,Mn]=u.useState(!1),[b0,Hc]=u.useState(!1),[$t,v0]=u.useState(null),[Ms,Qc]=u.useState(!1),[Gc,w0]=u.useState(!1),[Nt,N0]=u.useState(null);u.useEffect(()=>{Jp().then(N0).catch(()=>{})},[]);const[Xc,j0]=u.useState(void 0);u.useEffect(()=>{try{const a=window.electronAPI;a&&typeof a.appVersion=="function"&&a.appVersion().then(r=>{typeof r=="string"&&!r.startsWith("err:")&&j0(r)}).catch(()=>{})}catch{}},[]);const Zc=(()=>{var i,c;const a=(c=(i=import.meta)==null?void 0:i.env)==null?void 0:c.VITE_APP_VERSION,r=typeof window<"u"&&(window.electronAPI||window.location.protocol==="file:"||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"));if(r&&(n!=null&&n.desktopInstalledVersion))return n==null?void 0:n.desktopInstalledVersion;if(r&&Xc)return Xc;if(a)return a;if(!(!Nt&&!n))return O?(n==null?void 0:n.androidInstalledVersion)||(n==null?void 0:n.lastAckAndroidVersion)||(Nt==null?void 0:Nt.androidVersion)||(Nt==null?void 0:Nt.pcVersion):(Nt==null?void 0:Nt.pcVersion)||(Nt==null?void 0:Nt.androidVersion)})();u.useEffect(()=>{xr&&(t!=null&&t.uid)&&!Gc&&(async()=>{Pn(!0);try{let r=[],i=[];try{const f=ie(F,"users",t.uid,"branches");r=(await pe(f)).docs.map(y=>({id:y.id,...y.data(),source:"sub"}))}catch(f){console.warn("Failed to fetch subcollection branches:",f)}try{const f=Ce(ie(F,"branches"),K("ownerId","==",t.uid));i=(await pe(f)).docs.map(y=>({id:y.id,...y.data(),source:"root"}))}catch(f){console.warn("Failed to fetch root branches:",f)}const c=[...r,...i],d=new Map;c.forEach(f=>{const g=f.branchUserId||f.id;(!d.has(g)||f.source==="sub")&&d.set(g,f)});const m=Array.from(d.values());console.log("Loaded branches:",m),lo(m),w0(!0)}catch(r){console.error("Error in branch loading process:",r),w({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©",variant:"destructive"})}finally{Pn(!1)}})()},[xr,t==null?void 0:t.uid,Gc]),u.useEffect(()=>{xr||Qc(!1)},[xr]);const[S0,On]=u.useState(!1),[ed,td]=u.useState(!1),[Os,D0]=u.useState(null),[En,ad]=u.useState(""),[Rn,sd]=u.useState(""),[k0,C0]=u.useState(""),[rd,nd]=u.useState(!1),I0=a=>{D0(a),ad(a.branchName||""),sd(a.managerName||""),C0(a.loginUsername||a.email||a.username||""),On(!0)},A0=async()=>{if(!(!Os||!En||!Rn)){nd(!0);try{const a={branchName:En,managerName:Rn,updatedAt:new Date};if(Os.branchUserId)try{await ra(Me(F,"users",(t==null?void 0:t.uid)||"","branches",String(Os.branchUserId)),a,{merge:!0});try{await ea(Me(F,"users",Os.branchUserId),{displayName:En,managerName:Rn})}catch(r){console.warn("Could not update branch root user doc",r)}}catch(r){console.warn("Sub branch update failed:",r)}try{await ea(Me(F,"branches",Os.id),a)}catch{}lo(r=>r.map(i=>i.id===Os.id?{...i,...a}:i)),w({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ Ø¨Ù†Ø¬Ø§Ø­"}),On(!1)}catch(a){console.error("Error updating branch:",a),w({title:"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",description:a.message,variant:"destructive"})}finally{nd(!1)}}},_0=async a=>{if(!(a!=null&&a.branchUserId)){w({title:"Ø®Ø·Ø£",description:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",variant:"destructive"});return}Hc(!0),Mn(!0);try{const r=a.branchUserId;if(t!=null&&t.uid&&a.branchUserId&&a.source!=="sub")try{await ra(Me(F,"users",t.uid,"branches",a.branchUserId),{branchUserId:a.branchUserId,branchName:a.branchName||"Unknown Branch",managerName:a.managerName||"",active:!0,lastSynced:wt()},{merge:!0}),console.log("âœ… Branch link synced successfully"),await new Promise(Pe=>setTimeout(Pe,500))}catch(Pe){console.error("âŒ Failed to sync branch link:",Pe)}const[i,c,d,m]=await Promise.all([fa(Me(F,"users",r)),(async()=>{try{const Pe=Ce(ie(F,"merchantWallets"),K("merchantUserId","==",r)),fe=await pe(Pe);if(!fe.empty)return fe;const st=await pe(ie(F,"users",r,"wallets"));return st.empty?await pe(Ce(ie(F,"wallets"),K("userId","==",r))):st}catch(Pe){console.error("Error fetching wallets",Pe);try{return await pe(Ce(ie(F,"wallets"),K("userId","==",r)))}catch{return{docs:[]}}}})(),(async()=>{try{return await pe(Ce(ie(F,"debts"),K("userId","==",r)))}catch{return await pe(ie(F,"users",r,"debts"))}})(),(async()=>{try{const Pe=Ce(ie(F,"dailySales"),K("userId","==",r)),fe=await pe(Pe);return fe.empty?await pe(ie(F,"users",r,"dailySales")):fe}catch(Pe){return console.error("Error fetching sales",Pe),await pe(ie(F,"users",r,"dailySales"))}})()]),f=i.exists()?i.data():{},g=Number(f.cashBalance||0),y=f.reportsData||{},b=Number(y.dailyProfit||0),x=Number(y.monthlyProfit||0),N=f.walletBalances||{},v=c.docs.filter(Pe=>Pe.data().isActive===!0),S=new Set(v.map(Pe=>Pe.id));let I=0;S.size>0&&(I=Object.entries(N).filter(([Pe])=>S.has(Pe)).reduce((Pe,[fe,st])=>Pe+Number(st||0),0)),I===0&&v.length>0&&(I=v.reduce((Pe,fe)=>Pe+Number(fe.data().balance||fe.data().amount||0),0));let P=0;d.forEach(Pe=>{const fe=Pe.data();if(fe.type!=="debtor"){const st=Number(fe.paidAmount||0),Ge=Math.max(0,Number(fe.amount||0)-st);P+=Ge}});const M=new Date().toISOString().split("T")[0],V=M.slice(0,7);let H=0,Y=0,Ne=b,Je=x,gt=0;console.log(`Branch Details - UID: ${r}, Wallets: ${c.size}, Sales: ${m.size}, ReportsDaily: ${b}`),m.forEach(Pe=>{const fe=Pe.data(),st=String(fe.date||""),Ge=Number(fe.sellingPrice||0)*Number(fe.quantity||1),mt=Number(fe.profit||0);gt+=Ge,st===M&&(H+=Ge,Ne+=mt),st.startsWith(V)&&(Y+=Ge,Je+=mt)}),v0({branchName:a.branchName,managerName:a.managerName,todaySales:H,monthSales:Y,todayProfit:Ne,monthProfit:Je,walletsTotal:I,cashBalance:g,totalSalesSection:gt,debtsTotal:P})}catch(r){console.error("Error fetching branch details:",r),w({title:"ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹",description:r.message,variant:"destructive"}),Mn(!1)}finally{Hc(!1)}},[R,ms]=u.useState("");u.useEffect(()=>{if(!C||!(D!=null&&D.allowedWalletIds)||D.allowedWalletIds.length===0)return;const a=new Set(D.allowedWalletIds.map(r=>String(r)));Pa(r=>{const i=r.filter(c=>a.has(String(c.id)));if(i.length>0&&!(R&&i.some(d=>d.id===R))){const d=i[0];ms(d.id),Ga(d.phone);try{localStorage.setItem(La(),d.id)}catch{}}return i})},[C,D==null?void 0:D.allowedWalletIds,R]),u.useEffect(()=>{if(C||!(t!=null&&t.uid))return;let a=!1;return(async()=>{try{const i=await Fa(()=>yn.getByMerchantId(t.uid));if(a)return;if(i&&i.length>0){const d=i.filter(g=>g.isActive===!0).map(g=>({id:g.id,name:g.label||"Ù…Ø­ÙØ¸Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",phone:g.msisdn,isDefault:!1,monthlyWithdrawalLimit:g.monthlyWithdrawalLimit??g.withdrawLimit??2e5,monthlyTransferLimit:g.monthlyTransferLimit??g.transferLimit??2e5,defaultTransferCommission:g.defaultTransferCommission!=null?Number(g.defaultTransferCommission):null,defaultWithdrawCommission:g.defaultWithdrawCommission!=null?Number(g.defaultWithdrawCommission):null,ownerName:g.ownerName,nationalId:g.nationalId,providerName:g.provider}));Pa(d);const m=localStorage.getItem(La());let f=null;m&&d.find(g=>g.id===m)?f=d.find(g=>g.id===m):f=d[0],f&&(ms(f.id),Ga(f.phone))}else Pa([])}catch(i){console.error("Failed to reload wallets after ending shift:",i)}})(),()=>{a=!0}},[C,t==null?void 0:t.uid]),u.useEffect(()=>{const a=j==null?void 0:j.shopId;if(a&&(t!=null&&t.uid))try{const r=`selectedShopId_${t.uid}`;localStorage.setItem(r,String(a)),window.dispatchEvent(new Event("selectedShopIdChanged"))}catch{}},[j==null?void 0:j.shopId,t==null?void 0:t.uid]);const[po,T0]=u.useState([]),[hs,fs]=u.useState(()=>{try{return localStorage.getItem("cashySelectedDevice")||null}catch{return null}});u.useEffect(()=>{},[]),u.useEffect(()=>{(async()=>{if(R)try{await cn.set({key:"selected_wallet_id",value:R}),console.log("ðŸ“± Synced selected_wallet_id to Native:",R)}catch(r){console.error("Failed to sync wallet to native:",r)}else await cn.remove({key:"selected_wallet_id"})})()},[R]),u.useEffect(()=>{(async()=>{if(k)try{await cn.set({key:"shopId",value:k}),console.log("ðŸ“± Synced shopId to Native:",k)}catch(r){console.error("Failed to sync shopId to native:",r)}})()},[k]);const xo=a=>!!(a&&po.some(r=>r.id===a));async function yo(){const a=window.electronAPI,r=hs||"";if(!a||typeof a.sendUssd!="function")return null;if(!r)return w({title:"Ø§Ù„Ø¬Ù‡Ø§Ø² ØºÙŠØ± Ù…Ø­Ø¯Ø¯",description:"Ø§ØªØµÙ„ Ø¨Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù‡Ø§Ø² Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©",variant:"destructive"}),null;if(xo(r))return r;try{const m=po.find(f=>f&&f.id&&!String(f.id).includes(":"));if(m&&m.id)return fs(m.id),m.id}catch{}const i=r.includes(":")?r.split(":").slice(0,2).join(":"):"";if(i&&typeof a.connectWifi=="function"){try{const m=await a.connectWifi(i);if(typeof m=="string"&&(m.includes("âœ…")||m.toLowerCase().includes("connected")))return r}catch{}if(typeof a.refreshAdbDevices=="function")try{await a.refreshAdbDevices()}catch{}await new Promise(m=>setTimeout(m,250))}const c=r.split(":")[0],d=po.find(m=>(m.id.startsWith(c)||m.id.includes(c))&&m.id.includes(":"));if(d!=null&&d.id){const m=d.id.split(":").slice(0,2).join(":");if(!xo(d.id)&&typeof a.connectWifi=="function"){try{const f=await a.connectWifi(m);if(typeof f=="string"&&(f.includes("âœ…")||f.toLowerCase().includes("connected")))return fs(d.id),d.id}catch{}await new Promise(f=>setTimeout(f,250))}if(xo(d.id))return fs(d.id),d.id}return r&&i?r:(w({title:"Ø§Ù„Ø¬Ù‡Ø§Ø² ØºÙŠØ± Ù…ØªØµÙ„",description:"ÙØ¹Ù‘Ù„ Wireless debugging Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø§ØªØµØ§Ù„ Wiâ€‘Fi Ø«Ù… Ø£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©",variant:"destructive"}),null)}u.useEffect(()=>{const a=window.electronAPI;a&&typeof a.onAdbDevices=="function"&&a.onAdbDevices(r=>{var m;const i=Array.isArray(r)?r:[];T0(i);const c=(()=>{try{return localStorage.getItem("cashySelectedDevice")||""}catch{return""}})();if(c&&i.some(f=>f.id===c))fs(c);else{const f=c?String(c).split(":")[0]:"",g=f?i.find(y=>(y.id.startsWith(f)||y.id.includes(f))&&String(y.type||"").toLowerCase().includes("wifi")):void 0;g!=null&&g.id?fs(g.id):!c&&((m=i[0])!=null&&m.id)?fs(y=>y||i[0].id):i.length||fs(null)}})},[]);function P0(a,r){try{const i=dt==null?void 0:dt(),c=(i==null?void 0:i.phone)||"";if(!c){w({title:"ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø©",description:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…ÙØ±Ø³Ù„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}if(O&&c.startsWith("011")){nc("*777*1#"),w({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… Ø·Ù„Ø¨ ÙƒÙˆØ¯ Ø§ØªØµØ§Ù„Ø§Øª *777*1#"}),da(!1),Ea(!1);return}dx(c,a,r),w({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ"}),da(!1),Ea(!1)}catch(i){const c=(i==null?void 0:i.message)||"ØªØ¹Ø°Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ â€” ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";throw w({title:"ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:c,variant:"destructive"}),i}}const[qt,bo]=u.useState(null),M0=async()=>{var f;if(!bt||!bt.receiver||!bt.amount){w({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",variant:"destructive"});return}const a=String(bt.receiver),r=Math.round(Number(bt.amount));ua(!0);const i=dt==null?void 0:dt(),c=(i==null?void 0:i.phone)||"",d=cx(c),m=window.electronAPI;if(d==="etisalat"&&c.startsWith("011")&&m&&typeof m.sendUssd=="function"&&hs){try{const g=await yo();if(!g){ua(!1);return}let y=g;qt!==null&&(y=`${g}:sim${qt}`),al(y),await m.sendUssd(y,"*777*1#"),Kd(!0),da(!1)}catch(g){console.error("Etisalat flow init error",g),w({title:"Ø®Ø·Ø£",description:"ÙØ´Ù„ Ø¨Ø¯Ø¡ ØªØ­ÙˆÙŠÙ„ Ø§ØªØµØ§Ù„Ø§Øª: "+(g.message||""),variant:"destructive"})}finally{ua(!1)}return}if(d==="orange"&&c.startsWith("012")&&m&&typeof m.sendUssd=="function"&&hs){try{const g=await yo();if(!g){ua(!1);return}const y=`*7115*7*${a}*${r}#`;let b=g;qt!==null&&(b=`${g}:sim${qt}`),al(b),await m.sendUssd(b,y),Ea(!0),da(!1)}catch(g){console.error("Orange flow init error",g),w({title:"Ø®Ø·Ø£",description:"ÙØ´Ù„ Ø¨Ø¯Ø¡ ØªØ­ÙˆÙŠÙ„ Ø£ÙˆØ±Ù†Ø¬: "+(g.message||""),variant:"destructive"})}finally{ua(!1)}return}try{if((f=lr)!=null&&f.isNativePlatform&&lr.getPlatform()==="android"){const y=dt==null?void 0:dt(),b=(y==null?void 0:y.phone)||"";if(!b){w({title:"ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø©",description:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…ÙØ±Ø³Ù„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"}),ua(!1);return}if(b.startsWith("011")){nc("*777*1#",qt===0?"sim1":qt===1?"sim2":void 0),w({title:"ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„",description:"ØªÙ… Ø·Ù„Ø¨ ÙƒÙˆØ¯ Ø§ØªØµØ§Ù„Ø§Øª *777*1#"}),da(!1),Ea(!1);return}const x=Mm(b,a,r);if(!x){w({title:"Ø±Ù‚Ù… ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø±Ù‚Ù… 010/011/012/015",variant:"destructive"}),ua(!1);return}nc(x,qt===0?"sim1":qt===1?"sim2":void 0),w({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ"}),da(!1),Ea(!1);return}const g=window.electronAPI;if(g&&typeof g.sendUssd=="function"&&hs){const y=dt==null?void 0:dt(),b=(y==null?void 0:y.phone)||"";if(!b){w({title:"ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø©",description:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…ÙØ±Ø³Ù„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"}),ua(!1);return}const x=await yo();if(!x){ua(!1);return}const N=Mm(b,a,r);if(!N){w({title:"Ø±Ù‚Ù… ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø±Ù‚Ù… 010/011/012/015",variant:"destructive"}),ua(!1);return}try{let v="";if(qt!==null)v=`${x}:sim${qt}`;else{const S=typeof g.pickSimAutomatically=="function"?await g.pickSimAutomatically(x,b):{deviceId:x,slot:0};v=`${S.deviceId}:sim${S.slot}`}al(v),await g.sendUssd(v,N)}catch{try{await g.sendUssd(x,N)}catch(S){const I=x.includes(":")?x.split(":").slice(0,2).join(":"):"";if(I&&typeof g.connectWifi=="function")await g.connectWifi(I),await g.sendUssd(x,N);else throw S}}if(w({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ° Ø¨Ù†Ø¬Ø§Ø­"}),da(!1),Yd(void 0),g&&typeof g.getRecipientName=="function"&&x){zd(!0);try{const v=await g.getRecipientName(x);v&&typeof v=="string"&&Yd(v)}catch(v){console.error("Name fetch error",v)}finally{zd(!1)}}Ea(!0)}else P0(a,r)}catch(g){const y=g&&g.message?g.message:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„";w({title:"Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:`Ø§Ù„Ø¬Ù‡Ø§Ø²: ${tl||hs||"ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"} â€” ${y}`,variant:"destructive"})}finally{ua(!1)}},O0=async(a,r)=>{const i=window.electronAPI;try{if(i&&typeof i.enterPin=="function"&&a){await i.enterPin(a,r),Ea(!1),bd(!0);try{const x=await i.getTransactionResult(a);x==="success"?(Ma("success"),Ar(null)):x==="limit_exceeded"?(Ma("limit_exceeded"),Fs&&(console.log("â†©ï¸ Reverting transaction due to limit exceeded:",Fs),await Ql(Fs),Ar(null))):x==="no_wallet"&&(Ma("no_wallet"),Fs&&(console.log("â†©ï¸ Reverting transaction due to no wallet:",Fs),await Ql(Fs),Ar(null)))}catch(x){console.error("Transaction check error",x)}finally{bd(!1)}return}const c=String((n==null?void 0:n.bridgeLink)||"").trim(),d=String((n==null?void 0:n.bridgeDeviceId)||"").trim()||void 0;if(!c){w({title:"Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙØ¹Ø¯Ù‘",description:"Ø§Ø­ÙØ¸ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø³Ø± Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}const m=String((bt==null?void 0:bt.receiver)||Mt||"").replace(/\D/g,""),f=Math.max(1,Math.round(Number((bt==null?void 0:bt.amount)||jt||0))||0),g=String(r||"").replace(/\D/g,""),b=(x=>{let N=(x||"").trim();return N=N.replace(/\/+$/,""),/^https?:\/\//i.test(N)||(N=`https://${N}`),N})(c);Ea(!1)}catch(c){const d=(c==null?void 0:c.message)||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ";w({title:"ÙØ´Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„",description:d,variant:"destructive"})}};console.log("ðŸ”¥ UserDashboardPage - user:",t?"exists":"null");const[wr,Ha]=u.useState(!0),[vo,Nr]=u.useState(!0),[E0,Es]=u.useState(!1),[R0,jr]=u.useState(!1),[id,LN]=u.useState(()=>{try{const a=t!=null&&t.uid?`shopExpensesPinRequired_${t==null?void 0:t.uid}`:"shopExpensesPinRequired";return(localStorage.getItem(a)??localStorage.getItem("shopExpensesPinRequired"))==="true"}catch{return!1}}),[Wn,od]=u.useState(""),[wo,ld]=u.useState(""),[No,cd]=u.useState(""),[Ln,jo]=u.useState([]),[W0,Fn]=u.useState(!1),[Tt,Sr]=u.useState(null),[Rs,So]=u.useState(""),[FN,$N]=u.useState(!1),[L0,Do]=u.useState(!1),[F0,Qa]=u.useState(!1),[$0,Dr]=u.useState(!1),[kr,ko]=u.useState(""),[dd,Co]=u.useState(""),[ud,Ws]=u.useState([]),[B0,$n]=u.useState(!1),[Io,Ls]=u.useState({}),[Bn,Un]=u.useState(null),[md,Cr]=u.useState(""),[hd,Ir]=u.useState(""),[BN,fd]=u.useState(!1),[UN,gd]=u.useState(0),[VN,pd]=u.useState(!1),[Bt,xd]=u.useState(null),[Pt,U0]=u.useState(null),[qN,yd]=u.useState(!1),[Ao,Ma]=u.useState(null),[V0,bd]=u.useState(!1),[Fs,Ar]=u.useState(null),[Gt,Ga]=u.useState(""),[Mt,_r]=u.useState(""),[jt,$s]=u.useState(""),[gs,vd]=u.useState(""),[Tr,wd]=u.useState(""),[_o,Bs]=u.useState(!1),[To,Po]=u.useState(""),[q0,Us]=u.useState(""),[Nd,jd]=u.useState(""),[Mo,z0]=u.useState(""),[kt,Oo]=u.useState(null),[Y0,Sd]=u.useState(!1),[K0,Dd]=u.useState(!1),[J0,Vn]=u.useState(!1),[H0,Eo]=u.useState(!1),[kd,Ro]=u.useState(null),[yt,qn]=u.useState(""),[Ot,zn]=u.useState(""),[Cd,Q0]=u.useState(""),[Pr,Wo]=u.useState(""),[G0,Yn]=u.useState(!1),[X0,Id]=u.useState(!1),[zN,YN]=u.useState(null),[Lo,Ad]=u.useState(null),[Z0,Fo]=u.useState(!1),[$o,Bo]=u.useState(!0);u.useEffect(()=>{(async()=>{try{const r=t!=null&&t.uid?`withdrawSenderNameInputEnabled_${t==null?void 0:t.uid}`:"withdrawSenderNameInputEnabled";let i=null;try{i=localStorage.getItem(r)??localStorage.getItem("withdrawSenderNameInputEnabled")}catch{}if(t!=null&&t.uid)try{const c=await Fa(()=>se.getUserData(t.uid)),d=c==null?void 0:c.withdrawSenderNameInputEnabled;if(typeof d=="boolean"){Fo(d);try{localStorage.setItem(r,d?"true":"false")}catch{}return}}catch{}Fo(i==="true")}catch{Fo(!1)}})()},[t==null?void 0:t.uid]),u.useEffect(()=>{(async()=>{try{const r=t!=null&&t.uid?`receiverPhoneInputEnabled_${t==null?void 0:t.uid}`:"receiverPhoneInputEnabled";let i=null;try{i=localStorage.getItem(r)??localStorage.getItem("receiverPhoneInputEnabled")}catch{}if(t!=null&&t.uid)try{const c=await Fa(()=>se.getUserData(t.uid)),d=c==null?void 0:c.receiverPhoneInputEnabled;if(typeof d=="boolean"){Bo(d);try{localStorage.setItem(r,d?"true":"false")}catch{}return}}catch{}Bo(i===null?!0:i==="true")}catch{Bo(!0)}})()},[t==null?void 0:t.uid]),u.useEffect(()=>{try{const a=`clientNumberAssignments_${(t==null?void 0:t.uid)||"default"}`,r=localStorage.getItem(a);if(!r){Ls({});return}const i=JSON.parse(r);if(i&&typeof i=="object"){const c={};Object.entries(i).forEach(([d,m])=>{if(typeof m=="string")c[d]={name:m,amount:""};else if(m&&typeof m=="object"){const f=m,g=typeof f.name=="string"?f.name:"",y=typeof f.amount=="string"||typeof f.amount=="number"?String(f.amount):"";(g||y)&&(c[d]={name:g,amount:y})}}),Ls(c)}else Ls({})}catch{Ls({})}},[t==null?void 0:t.uid]);const Mr=a=>{const r="Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©",i="Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹";return(a||"").split("").map(c=>{const d=r.indexOf(c);if(d>-1)return String(d);const m=i.indexOf(c);return m>-1?String(m):c}).join("")},[ct,ef]=u.useState(!0),_d=Q.useMemo(()=>{if((n==null?void 0:n.transferFeesEnabled)!==void 0)return n.transferFeesEnabled;try{const a=t!=null&&t.uid?`transferFeesEnabled_${t.uid}`:"transferFeesEnabled";return(localStorage.getItem(a)??localStorage.getItem("transferFeesEnabled"))!=="false"}catch{return!0}},[n,t==null?void 0:t.uid]),[B,Uo]=u.useState("transfer"),tf=Q.useMemo(()=>{const a=Mr(Gt||"").replace(/\D/g,""),r=Mr(Mt||"").replace(/\D/g,"");return!_d||B!=="transfer"?!1:a.startsWith("010")&&r.startsWith("010")||a.startsWith("010")&&(r.startsWith("011")||r.startsWith("012")||r.startsWith("015"))||a.startsWith("012")&&r.startsWith("010")||a.startsWith("011")&&r.startsWith("010")||a.startsWith("015")&&r.startsWith("010")},[Gt,Mt,_d,B]),[ye,zt]=u.useState([]),[Xt,Or]=u.useState("all"),[_e,Yt]=u.useState([]),[Vo,af]=u.useState(!1),[qo,sf]=u.useState([]),[Vs,rf]=u.useState(new Date().toISOString().split("T")[0]),[ps,Td]=u.useState("day");u.useEffect(()=>{if(!Vo||!(t!=null&&t.uid))return;(async()=>{try{let r;if(ps==="day"){const d=new Date(Vs);d.setHours(0,0,0,0);const m=new Date(Vs);m.setHours(23,59,59,999),r=Ce(ie(F,"debtReceipts"),K("userId","==",t.uid),K("createdAt",">=",d),K("createdAt","<=",m),$i("createdAt","desc"))}else{const[d,m]=Vs.split("-").map(Number),f=new Date(d,m-1,1),g=new Date(d,m,0,23,59,59,999);r=Ce(ie(F,"debtReceipts"),K("userId","==",t.uid),K("createdAt",">=",f),K("createdAt","<=",g),$i("createdAt","desc"))}const c=(await pe(r)).docs.map(d=>({id:d.id,...d.data()}));sf(c)}catch(r){console.error("Error fetching debt receipts:",r),w({title:"Ø®Ø·Ø£",description:"ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„ Ø§Ù„Ø³Ø¯Ø§Ø¯",variant:"destructive"})}})()},[Vo,t==null?void 0:t.uid,Vs,ps]);const Oa=u.useRef([]),[zo,Yo]=u.useState(!1),[Xa,nf]=u.useState(""),[Kn,of]=u.useState("daily"),[Za,lf]=u.useState(""),[xs,Er]=u.useState(null),[KN,Jn]=u.useState(!1),cf=async(a,r)=>{try{const i=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),c=new Date(`${r}T00:00:00`),d=i.format(c),m=await pe(Ce(ie(F,"dailySales"),K("userId","==",a))),f=await pe(ie(F,"users",a,"dailySales")),g=[];m.forEach(x=>g.push({id:x.id,data:x.data()})),f.forEach(x=>g.push({id:x.id,data:x.data()}));const y=new Map;g.forEach(x=>{const N=String(x.data.clientId||x.id);y.has(N)||y.set(N,x.data)});let b=0;return y.forEach(x=>{if(x.isDeferred)return;let N=null;if(x.createdAt)typeof x.createdAt.toDate=="function"?N=x.createdAt.toDate():x.createdAt instanceof Date?N=x.createdAt:typeof x.createdAt=="number"?N=new Date(x.createdAt):typeof x.createdAt=="string"&&(N=new Date(x.createdAt));else if(x.date){const M=x.time||"00:00";N=new Date(`${x.date}T${M}:00`)}let v=!1;if(N&&!isNaN(N.getTime())?i.format(N)===d&&(v=!0):x.date&&(v=String(x.date||"").slice(0,10)===d),!v)return;const S=Number(x.quantity||1),I=Number(x.sellingPrice??x.price??0),P=Number(x.wholesalePrice??0),_=Number(x.profit??(I-P)*S);b+=_}),Math.round(b*100)/100}catch{return 0}},df=async(a,r)=>{try{const[i,c]=r.split("-"),d=parseInt(i,10),m=parseInt(c,10);if(!d||!m)return 0;const f=new Date(d,m,0).getDate(),g=`${i}-${c}-01`,y=`${i}-${c}-${String(f).padStart(2,"0")}`,b=await pe(Ce(ie(F,"dailySales"),K("userId","==",a))),x=await pe(ie(F,"users",a,"dailySales")),N=[];b.forEach(I=>N.push({id:I.id,data:I.data()})),x.forEach(I=>N.push({id:I.id,data:I.data()}));const v=new Map;N.forEach(I=>{const P=String(I.data.clientId||I.id);v.has(P)||v.set(P,I.data)});let S=0;return v.forEach(I=>{if(I.isDeferred)return;let P="";if(I.date)P=String(I.date).slice(0,10);else if(I.createdAt){let Y=null;typeof I.createdAt.toDate=="function"?Y=I.createdAt.toDate():I.createdAt instanceof Date?Y=I.createdAt:typeof I.createdAt=="number"?Y=new Date(I.createdAt):typeof I.createdAt=="string"&&(Y=new Date(I.createdAt)),Y&&!isNaN(Y.getTime())&&(P=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(Y))}if(!P||P<g||P>y)return;const _=Number(I.quantity||1),M=Number(I.sellingPrice??I.price??0),V=Number(I.wholesalePrice??0),H=Number(I.profit??(M-V)*_);S+=H}),Math.round(S*100)/100}catch{return 0}},uf=async a=>{if(!a||!(t!=null&&t.uid)){Er(null);return}Jn(!0);try{const r=new Date(`${a}T00:00:00`),i=new Date(`${a}T23:59:59.999`),d=(await se.getUserTransactionsForDateRange(t.uid,r,i)).filter(v=>{const S=String(v.status||v.status||"completed").toLowerCase();return S==="completed"||S==="confirmed"}),m=vt.filterVisibleTransactions(d,"daily",t.uid);let f=0,g=0,y=0,b=0,x=0;m.forEach(v=>{f++,g+=Number(v.amount||0);const S=(v.type||v.txnType||"").toLowerCase(),I=S==="machine_withdrawal"||v.title==="Ø¥ÙŠØµØ§Ù„ Ø³Ø­Ø¨ ÙÙˆØ±ÙŠ";!I&&(S==="withdraw"||S==="withdrawal"||S==="receive")?y+=Number(v.amount||0):!I&&(S==="send"||S==="transfer")&&(b+=Number(v.amount||0)),x+=Ja.calculateProfitFromTransaction(v)});const N=await cf(t.uid,a);x+=N,Er({count:f,totalAmount:g,totalWithdrawn:y,totalSent:b,totalProfit:x,salesProfit:N})}catch(r){console.error("Error fetching daily report:",r),w({title:"Ø®Ø·Ø£",description:"ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ",variant:"destructive"})}finally{Jn(!1)}},mf=async a=>{if(!a||!(t!=null&&t.uid)){Er(null);return}Jn(!0);try{const r=new Date(`${a}-01T00:00:00`),i=new Date(new Date(r.getFullYear(),r.getMonth()+1,0).setHours(23,59,59,999)),d=(await se.getUserTransactionsForDateRange(t.uid,r,i)).filter(v=>{const S=String(v.status||v.status||"completed").toLowerCase();return S==="completed"||S==="confirmed"||S==="pending"}),m=vt.filterVisibleTransactions(d,"monthly",t.uid);let f=0,g=0,y=0,b=0,x=0;m.forEach(v=>{f++,g+=Number(v.amount||0);const S=(v.type||v.txnType||"").toLowerCase(),I=String(v.title||""),P=S==="machine_withdrawal"||I==="Ø¥ÙŠØµØ§Ù„ Ø³Ø­Ø¨ ÙÙˆØ±ÙŠ",_=S==="withdrawal"||S==="machine_withdrawal"?"withdraw":S;!P&&(_==="withdraw"||_==="receive")?y+=Number(v.amount||0):!P&&(_==="send"||_==="transfer")&&(b+=Number(v.amount||0));const H={type:_,amount:Number(v.amount||0),commission:v.commission,fee:v.fee};x+=Ja.calculateProfitFromTransaction(H)});const N=await df(t.uid,a);x+=N,Er({count:f,totalAmount:g,totalWithdrawn:y,totalSent:b,totalProfit:x,salesProfit:N})}catch(r){console.error("Error fetching monthly report:",r),w({title:"Ø®Ø·Ø£",description:"ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ",variant:"destructive"})}finally{Jn(!1)}};u.useEffect(()=>{zo&&(Kn==="daily"&&Xa?uf(Xa):Kn==="monthly"&&Za?mf(Za):Er(null))},[Xa,Za,Kn,zo]);const Rr=pn({enabled:!!(t!=null&&t.uid),queryKey:["recentTransactions",t==null?void 0:t.uid,k||"main"],queryFn:async()=>{const{collection:a,query:r,where:i,orderBy:c,limit:d,getDocs:m}=await le(async()=>{const{collection:_,query:M,where:V,orderBy:H,limit:Y,getDocs:Ne}=await import("./index-DhbnydJl.js").then(Je=>Je.cP);return{collection:_,query:M,where:V,orderBy:H,limit:Y,getDocs:Ne}},__vite__mapDeps([0,1]),import.meta.url),{db:f}=await le(async()=>{const{db:_}=await import("./index-DhbnydJl.js").then(M=>M.cQ);return{db:_}},__vite__mapDeps([0,1]),import.meta.url),g=r(a(f,"userTransactions"),i("userId","==",String((t==null?void 0:t.uid)||"")),c("createdAt","desc"),d(100)),x=(await m(g)).docs.map(_=>{var fe;const M=_.data(),V=(fe=M.createdAt)!=null&&fe.toDate?M.createdAt.toDate():new Date(M.createdAt),H=String(M.transactionType||M.txnType||M.type||"").toLowerCase();let Y="send";H==="withdraw"||H==="receive"?Y="withdraw":H==="machine_withdrawal"?Y="machine_withdrawal":H==="cash_addition"||H==="add"?Y="cash_addition":Y="send";const Ne=M.status==="confirmed"?"completed":M.status||"completed",Je=M.senderMsisdn||M.senderPhone||"",gt=M.receiverMsisdn||M.receiverPhone||"",Pe=Number(M.amount??M.transferredAmount??M.withdrawnAmount??0);return{id:_.id,...M,type:Y,status:Ne,senderPhone:Je,receiverPhone:gt,amount:Pe,createdAt:V}}).filter(_=>!((_==null?void 0:_.type)==="report"||String((_==null?void 0:_.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"))),N=new Set(($r||[]).map(_=>String(_.id||_.originalTransactionId||""))),v=x.filter(_=>!N.has(String(_.id||""))),S=_=>{var M;return String(_.transactionId||_.id||_.reference||((M=_.receipt)==null?void 0:M.reference)||`${new Date(_.createdAt).getTime()}`)},I=new Set,P=[];for(const _ of v){const M=S(_);I.has(M)||(I.add(M),P.push(_))}return P},staleTime:6e4,gcTime:3e5,refetchOnWindowFocus:!1,refetchOnReconnect:!0});u.useEffect(()=>{const a=()=>{try{Rr.refetch()}catch{}};return window.addEventListener("transaction-created",a),()=>{window.removeEventListener("transaction-created",a)}},[Rr]),u.useEffect(()=>{const a=Rr.data;if(a&&Array.isArray(a)){const r=Oa.current,i=Date.now(),c=r.filter(y=>{const b=a.some(v=>v.id===y.id),x=y.reference?a.some(v=>v.reference===y.reference):!1,N=i-new Date(y.createdAt).getTime()>3e5;return!b&&!x&&!N});Oa.current=c;const d=[...c,...a].sort((y,b)=>new Date(b.createdAt).getTime()-new Date(y.createdAt).getTime()),m=new Set,f=[];for(const y of d)m.has(y.id)||(m.add(y.id),f.push(y));let g=f;if(C&&(D!=null&&D.name||D!=null&&D.username)){const y=new Set;D!=null&&D.name&&y.add(D.name),D!=null&&D.username&&y.add(D.username),g=f.filter(b=>{const x=b==null?void 0:b.cashierName;return x?y.has(String(x)):!1})}zt(g)}},[Rr.data,C,D==null?void 0:D.name,D==null?void 0:D.username]),u.useEffect(()=>{try{if(localStorage.setItem("commissionMode",ct?"add":"deduct"),t!=null&&t.uid){const a=`commissionMode_${t.uid}`;localStorage.setItem(a,ct?"add":"deduct")}}catch{}},[ct,t==null?void 0:t.uid]),u.useEffect(()=>{try{const a=new Set((ye||[]).filter(c=>String((c==null?void 0:c.status)||"")==="completed"&&(c==null?void 0:c.linkedDebtId)).map(c=>String(c.linkedDebtId)));if(a.size===0||_e.length===0)return;const r=_e.map(c=>{if(!a.has(String(c.id)))return c;const d=Number(c.amount||0),m=Number(c.paidAmount||0);return m>=d&&c.status!=="paid"?{...c,amount:d,paidAmount:d,status:"paid"}:m>d?{...c,amount:d,paidAmount:d}:c});if(r.some((c,d)=>c!==_e[d])){Yt(r),(async()=>await Wa(r))();try{t!=null&&t.uid&&r.filter((d,m)=>d!==_e[m]&&d.status==="paid").forEach(d=>{try{const m=Number(d.paidAmount||0),f=m>0?m:Number(d.amount||0);js.send(t.uid,`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${d.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${f} Ø¬Ù†ÙŠÙ‡`).catch(()=>{})}catch{}})}catch{}}}catch{}},[ye,_e,t==null?void 0:t.uid]),u.useEffect(()=>{try{const a=t!=null&&t.uid?localStorage.getItem(`commissionMode_${t.uid}`):null,r=localStorage.getItem("commissionMode"),i=localStorage.getItem("commissionMode_default"),c=a??r??i;c&&ef(c==="add")}catch{}},[t==null?void 0:t.uid]);const[Ko,Wr]=u.useState(!1),[hf,ff]=u.useState(null),Hn=Q.useRef(""),Pd=Q.useRef(0);u.useEffect(()=>{const a=r=>{var c;if(Ko)return;try{const d=document.activeElement;if(d){const m=(c=d.tagName)==null?void 0:c.toLowerCase();if(m==="input"||m==="textarea"||m==="select"||m==="button"||d.isContentEditable===!0)return}}catch{}const i=Date.now();if(r.key==="Enter"){const d=(Hn.current||"").trim();if(Hn.current="",d){if(d.length<2&&/^\d+$/.test(d))return;ff(d),Wr(!0)}return}r.key.length===1&&(i-(Pd.current||0)>100&&(Hn.current=""),Hn.current+=r.key,Pd.current=i)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[Ko]);const[gf,qs]=u.useState(!1),[pf,zs]=u.useState(!1),[xf,Jo]=u.useState(!1),[yf,bf]=u.useState(null);u.useEffect(()=>{if(!_o)return;const a=dt(),r=parseFloat(jt||"0")||0;let i=0;if(B==="transfer")if((a==null?void 0:a.defaultTransferCommission)!=null){const d=Number(a.defaultTransferCommission)||0;i=Math.round(d*r/1e3*100)/100}else{const d=Ot&&Ot.trim()!==""?parseFloat(Ot):0;i=Math.max(0,d)}else if((a==null?void 0:a.defaultWithdrawCommission)!=null){const d=Number(a.defaultWithdrawCommission)||0;i=Math.round(d*r/1e3*100)/100}else{const d=yt&&yt.trim()!==""?parseFloat(yt):Math.round(r*.01*100)/100;i=Math.max(0,d)}const c=Math.max(0,Math.round((r+i)*100)/100);Us((c||0).toString())},[_o,jt,Ot,yt,R,ct,B]);const dt=()=>{var r,i;let a=ae.find(c=>c.id===R);if(!a)try{const c=localStorage.getItem(Vu());if(c){const d=JSON.parse(c);if(Array.isArray(d)&&d.length>0){const f=localStorage.getItem(La())||((r=d.find(g=>g.isDefault))==null?void 0:r.id)||((i=d[0])==null?void 0:i.id);a=d.find(g=>g.id===f)}}}catch{}return a};u.useLayoutEffect(()=>{try{const a=`wallets_${(t==null?void 0:t.uid)||"default"}`;let r=localStorage.getItem(a);if(!r){const i=Object.keys(localStorage).find(c=>c.startsWith("wallets_"));i&&(r=localStorage.getItem(i)||null)}if(r){const i=JSON.parse(r);if(Array.isArray(i)&&i.length>0){Pa(i);const c=localStorage.getItem(La()),d=c&&i.find(m=>m.id===c)||i.find(m=>m.isDefault)||i[0];d&&(ms(d.id),Ga(d.phone))}}}catch(a){console.error("ØªÙ‡ÙŠØ¦Ø© ÙÙˆØ±ÙŠØ© Ù„Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ ÙØ´Ù„Øª:",a)}},[]),u.useEffect(()=>{console.log("ðŸ” selectedWallet state changed to:",R)},[R]),u.useEffect(()=>{Bu()},[t==null?void 0:t.uid]),u.useEffect(()=>{Fg()},[]);const Qn=pn({enabled:!!(t!=null&&t.uid),queryKey:["wallets",t==null?void 0:t.uid],queryFn:async()=>{const{merchantWalletService:a}=await le(async()=>{const{merchantWalletService:c}=await import("./index-DhbnydJl.js").then(d=>d.cR);return{merchantWalletService:c}},__vite__mapDeps([0,1]),import.meta.url),r=await a.getByMerchantId(String((t==null?void 0:t.uid)||""));return(Array.isArray(r)?r:[]).filter(c=>c.isActive===!0).map(c=>({id:c.id,name:c.label||"Ù…Ø­ÙØ¸Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",phone:c.msisdn,isDefault:!!c.isDefault,monthlyWithdrawalLimit:c.monthlyWithdrawalLimit??c.withdrawLimit??2e5,monthlyTransferLimit:c.monthlyTransferLimit??c.transferLimit??2e5,defaultTransferCommission:c.defaultTransferCommission!=null?Number(c.defaultTransferCommission):null,defaultWithdrawCommission:c.defaultWithdrawCommission!=null?Number(c.defaultWithdrawCommission):null}))},staleTime:6e4,gcTime:3e5,refetchOnReconnect:!0});u.useEffect(()=>{var r;const a=Qn.data;if(a&&Array.isArray(a)){Pa(a);const i=localStorage.getItem(La());if(!!!(R&&a.find(d=>d.id===R))){const d=i&&a.find(m=>m.id===i)?i:((r=a[0])==null?void 0:r.id)||"";if(d){ms(d);const m=a.find(f=>f.id===d);Ga(String((m==null?void 0:m.phone)||""))}}}},[Qn.data]),u.useEffect(()=>{const a=r=>{const{cashBalance:i,walletBalances:c,newTransaction:d,limitUpdate:m,delta:f}=r.detail||{};if(f){const{amount:g,type:y,walletId:b,commission:x,totalDeducted:N}=f,v=Number(g||0),S=Number(x||0),I=Number(N||v+S);let P=0;y==="withdraw"?P=-v+S:y==="send"||y==="transfer"?P=v+S:y==="atm_withdraw"&&(P=v);const _=qe+P;try{const M=at();localStorage.setItem(M,String(_));const V=new Date().toISOString();if(localStorage.setItem(M+"_lastUpdated",V),t!=null&&t.uid){const H=`userData_${t.uid}`,Y=localStorage.getItem(H),Je={...Y?JSON.parse(Y):{},cashBalance:_,lastUpdated:V};localStorage.setItem(H,JSON.stringify(Je)),we(!0)}}catch{}lt(_),b&&ft(M=>{const V=Number(M[b]||0);let H=0;y==="withdraw"?H=v:y==="send"||y==="transfer"?H=-v:y==="atm_withdraw"&&(H=-I);const Y=V+H,Ne={...M,[b]:Y};try{const Je=ot();localStorage.setItem(Je,JSON.stringify(Ne));const gt=new Date().toISOString();if(localStorage.setItem(Je+"_lastUpdated",gt),t!=null&&t.uid){const Pe=`userData_${t.uid}`,fe=localStorage.getItem(Pe),Ge={...fe?JSON.parse(fe):{},walletBalances:Ne,lastUpdated:gt};localStorage.setItem(Pe,JSON.stringify(Ge)),we(!0)}}catch{}return Ne})}if(typeof i=="number"){lt(i);try{const g=at();localStorage.setItem(g,String(i));const y=new Date().toISOString();if(localStorage.setItem(g+"_lastUpdated",y),t!=null&&t.uid){const b=`userData_${t.uid}`,x=localStorage.getItem(b),v={...x?JSON.parse(x):{},cashBalance:i,lastUpdated:y};localStorage.setItem(b,JSON.stringify(v)),we(!0)}}catch{}}if(c&&typeof c=="object"){ft(c);try{const g=ot();localStorage.setItem(g,JSON.stringify(c));const y=new Date().toISOString();if(localStorage.setItem(g+"_lastUpdated",y),t!=null&&t.uid){const b=`userData_${t.uid}`,x=localStorage.getItem(b),v={...x?JSON.parse(x):{},walletBalances:c,lastUpdated:y};localStorage.setItem(b,JSON.stringify(v)),we(!0)}}catch{}}if(m&&m.walletId===R&&Zs(g=>{if(!g)return g;const y=Number(m.amount||0),b=m.type==="transfer",x={...g};return b?(x.dailyTransferUsed=(x.dailyTransferUsed||0)+y,x.monthlyTransferUsed=(x.monthlyTransferUsed||0)+y):(x.dailyWithdrawUsed=(x.dailyWithdrawUsed||0)+y,x.monthlyWithdrawUsed=(x.monthlyWithdrawUsed||0)+y),x}),d){const g=d.type==="machine_withdrawal"||d.txnType==="machine_withdrawal",y=Ld.current||[];if(g&&y.find(x=>{if((x.type||x.txnType)!=="machine_withdrawal")return!1;const v=Number(x.amount)===Number(d.amount),S=x.senderName===d.senderName,I=new Date(x.createdAt).getTime(),P=new Date(d.createdAt||Date.now()).getTime(),_=Math.abs(P-I);return v&&S&&_<6e4})){console.log("Skipping duplicate machine withdrawal event (fuzzy match):",d);return}try{Oa.current&&(Oa.current.some(b=>b.id===d.id)||Oa.current.push(d))}catch{}zt(b=>b.some(x=>x.id===d.id)?b:[d,...b]),w({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ© Ø®Ø§Ø±Ø¬ÙŠØ©",description:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙˆØ§Ù„Ø³Ø¬Ù„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­"});try{Rr.refetch()}catch{}}};return window.addEventListener("dashboard:external-update",a),()=>window.removeEventListener("dashboard:external-update",a)},[R]);const[Md,vf]=u.useState(""),Od=(()=>{const a=Md.replace(/\D/g,"");return a?ae.filter(r=>(r.phone||"").replace(/\D/g,"").includes(a)):ae})();u.useEffect(()=>{(async()=>{try{let r=[];if(t!=null&&t.uid)try{const i=await Fa(()=>se.getUserData(t.uid)),c=i==null?void 0:i.favoriteWalletIds;Array.isArray(c)&&(r=c.map(d=>String(d)))}catch{}if(!r.length)try{const i=t!=null&&t.uid?`favoriteWallets_${t.uid}`:"favoriteWallets",c=localStorage.getItem(i)??localStorage.getItem("favoriteWallets");if(c){const d=JSON.parse(c);Array.isArray(d)&&(r=d.filter(m=>typeof m=="string"))}}catch{}r.length&&io(r)}catch{io([])}})()},[t==null?void 0:t.uid]),u.useEffect(()=>{try{const a=t!=null&&t.uid?`favoriteWallets_${t.uid}`:"favoriteWallets";localStorage.setItem(a,JSON.stringify(Ps)),t!=null&&t.uid&&se.updateUserData(t.uid,{favoriteWalletIds:Ps})}catch{}},[Ps,t==null?void 0:t.uid]);const Ed=Q.useMemo(()=>{const a=new Set(Ps);return[...Od].sort((r,i)=>{const c=a.has(r.id),d=a.has(i.id);return c===d?0:c?-1:1})},[Od,Ps]),wf=a=>{io(r=>r.includes(a)?r.filter(i=>i!==a):[...r,a])},[Nf,JN]=u.useState(null),[jf,Rd]=u.useState(!1),[Sf,Gn]=u.useState(!1),[Df,kf]=u.useState(null),[HN,Cf]=u.useState([]),[QN,GN]=u.useState([]),[If,ys]=u.useState(!1),[Lr,Wd]=u.useState("daily"),[Af,Fr]=u.useState(!1),[$r,Br]=u.useState([]),[_f,XN]=u.useState(!1),ba=Q.useRef(new Set);Q.useRef(new Set);const Ld=Q.useRef([]);u.useEffect(()=>{Ld.current=ye},[ye]);const Ho=async a=>{try{if(!t)return;const r=at(),i=ot(),c=localStorage.getItem(r),d=localStorage.getItem(i);let m=c?parseFloat(c):qe,f=d?JSON.parse(d):{...De};const g=Number(a.withdrawnAmount??a.sentAmount??a.transferredAmount??a.amount??0);if(a.type==="send"&&(a.fromWallet||R)){m=Math.round(m-g);const N=a.fromWallet||R;f[N]=(f[N]||0)+g}else if(a.type==="withdraw"&&(a.fromWallet||R)){m=Math.round(m+g);const N=a.fromWallet||R;f[N]=Math.max(0,(f[N]||0)-g)}lt(m),ft(f);const y=new Date().toISOString();localStorage.setItem(r,m.toString()),localStorage.setItem(r+"_lastUpdated",y),localStorage.setItem(i,JSON.stringify(f)),localStorage.setItem(i+"_lastUpdated",y);const b={cashBalance:m,walletBalances:f,lastUpdated:new Date().toISOString()},x=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(x,JSON.stringify(b));try{await se.updateUserData(t.uid,b),localStorage.removeItem(x),we(!1)}catch(N){console.warn("ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙÙŠ Firebase Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù (Ù…Ø²Ø§Ù…Ù†Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©):",N),we(!0)}try{const N=a.fromWallet||R,v=a.type==="send"?"transfer":"withdraw";await Ka.rollbackUsage(N,g,v,a.createdAt)}catch(N){console.warn("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù (Ù…Ø²Ø§Ù…Ù†Ø©):",N)}try{vt.removeTransactionEffects(a,t.uid)}catch(N){console.warn("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù (Ù…Ø²Ø§Ù…Ù†Ø©):",N)}}catch(r){console.warn("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø°Ù Ù…Ø­Ù„ÙŠÙ‹Ø§:",r)}},Tf=async a=>{try{const r=ye.find(f=>f.id===a);if(!r||!t)return;const i=String(a),c=String((r==null?void 0:r.transactionId)||(r==null?void 0:r.reference)||""),d=ba.current.has(i)||c&&ba.current.has(c),m=ye.filter(f=>f.id!==a);zt(m);try{await se.removeUserTransaction(t.uid,a),await gn.permanentlyDeleteTransaction(a,t.uid)}catch(f){console.warn("ØªØ¹Ø°Ø± Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù…Ù† Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„:",f)}if(!d){ba.current.add(i),c&&ba.current.add(c),await Ho(r);try{t!=null&&t.uid&&se.removeLocalReceiptById(t.uid,a)}catch{}}w({title:"ØªÙ… Ø§Ù„Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ ÙˆØ¹ÙƒØ³ ØªØ£Ø«ÙŠØ±Ø§ØªÙ‡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙˆØ§Ù„Ø­Ø¯ÙˆØ¯ ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±."}),Gn(!1)}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„:",r),w({title:"Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù.",variant:"destructive"})}},Pf=async a=>{try{const r=ye.find(i=>i.id===a);if(!r||!t)return;try{const i=Bt==null?void 0:Bt.planType;if(i===aa.ZERO){const{dailyOperationCountService:c}=await le(async()=>{const{dailyOperationCountService:f}=await import("./dailyOperationCountService-BDMlwDJn.js");return{dailyOperationCountService:f}},__vite__mapDeps([66,0,1]),import.meta.url),d=r.type==="send"?"transfer":"withdraw";if(!(await c.checkAndIncrement(t.uid,d,5)).allowed){w({title:"ØªÙ… Ø¨Ù„ÙˆØº Ø­Ø¯ Ø¨Ø§Ù‚Ø© Ø§Ù„Ø²ÙŠØ±Ùˆ",description:"Ù…Ø³Ù…ÙˆØ­ Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 5 ØªØ£ÙƒÙŠØ¯Ø§Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§ Ù„Ù„ØªØ­ÙˆÙŠÙ„/Ø§Ù„Ø³Ø­Ø¨. Ø¬Ø±Ù‘Ø¨ ØºØ¯Ù‹Ø§ Ø£Ùˆ Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}}else if(i===aa.TAHWEELA){const{dailyOperationCountService:c}=await le(async()=>{const{dailyOperationCountService:f}=await import("./dailyOperationCountService-BDMlwDJn.js");return{dailyOperationCountService:f}},__vite__mapDeps([66,0,1]),import.meta.url),d=r.type==="send"?"transfer":"withdraw";if(!(await c.checkAndIncrementCombined(t.uid,d,40)).allowed){w({title:"ØªÙ… Ø¨Ù„ÙˆØº Ø­Ø¯ Ø¨Ø§Ù‚Ø© ØªØ­ÙˆÙŠÙ„Ù‡",description:"Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø§Ù‚Ø© ØªØ³Ù…Ø­ Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 40 Ø¹Ù…Ù„ÙŠØ© ØªØ­ÙˆÙŠÙ„/Ø³Ø­Ø¨ ÙŠÙˆÙ…ÙŠØ§Ù‹.",variant:"destructive"});return}}}catch(i){console.warn("ØªØ¹Ø°Ø± Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ:",i)}await ea(Me(F,"userTransactions",a),{status:"completed",confirmedAt:new Date}),zt(i=>i.map(c=>c.id===a?{...c,status:"completed"}:c)),w({title:"ØªÙ… Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„",description:"ØªÙ… ÙˆØ³Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙƒÙ…ÙƒØªÙ…Ù„Ø©."}),Gn(!1)}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„:",r),w({title:"ÙØ´Ù„ Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©.",variant:"destructive"})}};u.useEffect(()=>{if(!t)return;(async()=>{try{const r=Ce(ie(F,"deletedTransactions"),K("userId","==",t.uid),$i("createdAt","desc"),Im(50));(await pe(r)).docs.forEach(c=>{const d=c.data(),m=String((d==null?void 0:d.originalTransactionId)||""),f=String((d==null?void 0:d.transactionId)||""),g=String((d==null?void 0:d.reference)||""),y=m||f||g||String(c.id);y&&(ba.current.has(y)||(ba.current.add(y),zt(b=>{const x=b.find(N=>N.id===m);return x?((async()=>await Ho(x))(),b.filter(N=>N.id!==m)):b})))})}catch(r){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©:",r)}})()},[t==null?void 0:t.uid]),u.useEffect(()=>{if(!t)return;(async()=>{try{const r=Me(F,"users",t.uid),i=await fa(r);if(!i.exists())return;const c=i.data();if(!(c!=null&&c.reportsData))return;try{await vt.syncReportsDataFromFirebase(t.uid),Cf(om())}catch(d){console.warn("ØªØ¹Ø°Ø± Ù…Ø²Ø§Ù…Ù†Ø© reportsData Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©:",d)}}catch(r){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ users.reportsData:",r)}})()},[t==null?void 0:t.uid]);const[Qo,Fd]=u.useState(""),$d=Bw(Qo,300),[Xn,Bd]=u.useState(""),[Zn,Ud]=u.useState(""),[va,ZN]=u.useState(""),[Go,Ys]=u.useState(!1),[Xo,Ur]=u.useState(!1),[Mf,Vd]=u.useState(null),[ca,Zo]=u.useState(!1),[Of,da]=u.useState(!1),[nt,el]=u.useState(null),[bt,Ef]=u.useState(null),[qd,ua]=u.useState(!1),[Rf,Ea]=u.useState(!1),[Wf,zd]=u.useState(!1),[Lf,Yd]=u.useState(void 0),[Ff,Kd]=u.useState(!1),[tl,al]=u.useState(""),[$f,Jd]=u.useState(!1),[Bf,Vr]=u.useState(!1),[Uf,Hd]=u.useState(!1),[Vf,ei]=u.useState(!1),[qf,Qd]=u.useState(!1),[zf,ti]=u.useState(!1),[Yf,ai]=u.useState(!1),[Kf,si]=u.useState(!1),[Gd,ri]=u.useState(()=>{try{const a=t!=null&&t.uid?`monthlyReportsLock_v4_${t==null?void 0:t.uid}`:"monthlyReportsLock_v4";return(localStorage.getItem(a)??localStorage.getItem("monthlyReportsLock_v4"))==="true"}catch{return!1}});u.useEffect(()=>{const a=()=>{try{const i=t!=null&&t.uid?`monthlyReportsLock_v4_${t==null?void 0:t.uid}`:"monthlyReportsLock_v4",c=localStorage.getItem(i)??localStorage.getItem("monthlyReportsLock_v4");ri(c==="true")}catch{}};a();const r=i=>{i.detail&&typeof i.detail.enabled=="boolean"?ri(i.detail.enabled):a()};return window.addEventListener("monthlyReportsLockChanged",r),()=>window.removeEventListener("monthlyReportsLockChanged",r)},[t==null?void 0:t.uid]);const[qr,Jf]=u.useState(!1),[Hf,ni]=u.useState(!1),[Qf,Xd]=u.useState(!1),[ii,Gf]=u.useState(""),[Zd,Xf]=u.useState(!1),[Zf,sl]=u.useState(!1),[Zt,eu]=u.useState(()=>{try{const a=(t==null?void 0:t.uid)||"default",r=localStorage.getItem(`hiddenQuickActions_${a}`)??localStorage.getItem("hiddenQuickActions"),i=r?JSON.parse(r):[];return Array.isArray(i)?i.filter(c=>typeof c=="string"):[]}catch{return[]}}),[eg,tu]=u.useState(()=>{try{const a=t!=null&&t.uid?`dailyReportsLockEnabled_${t==null?void 0:t.uid}`:"dailyReportsLockEnabled";return(localStorage.getItem(a)??localStorage.getItem("dailyReportsLockEnabled"))==="true"}catch{return!1}}),[tg,rl]=u.useState(!1);u.useEffect(()=>{try{const a=t!=null&&t.uid?`dailyReportsLockEnabled_${t==null?void 0:t.uid}`:"dailyReportsLockEnabled",r=localStorage.getItem(a)??localStorage.getItem("dailyReportsLockEnabled");tu(r==="true")}catch{}},[t==null?void 0:t.uid]);const[ag,Ks]=u.useState(!1),[sg,nl]=u.useState(!1),[rg,au]=u.useState(()=>{try{const a=t==null?void 0:t.uid,r=a?`debtsPinRequired_${a}`:"debtsPinRequired";return(localStorage.getItem(r)??localStorage.getItem("debtsPinRequired"))==="true"}catch{return!1}}),[ng,su]=u.useState(!1),[ru,ig]=u.useState(null),[il,ol]=u.useState(""),[ll,nu]=u.useState(""),[iu,ou]=u.useState(""),[wa,lu]=u.useState(null),[W,zr]=u.useState(null),[og,es]=u.useState(!1),[lg,oi]=u.useState(!1),[Na,cg]=u.useState(null),[cu,du]=u.useState(""),[uu,li]=u.useState(""),[ut,mu]=u.useState(null),[ej,tj]=u.useState(!1),[dg,ci]=u.useState(!1),[Js,hu]=u.useState(()=>{try{return localStorage.getItem("eyeComfortMode")==="true"}catch{return!1}});u.useEffect(()=>{localStorage.setItem("eyeComfortMode",String(Js))},[Js]);const[fu,Yr]=u.useState(""),[cl,bs]=u.useState(!1),[gu,di]=u.useState(1),[Kr,pu]=u.useState(""),ug=O?10:20,ui=Q.useMemo(()=>{if(!Kr)return _e;const a=Kr.toLowerCase();return _e.filter(r=>r.debtorName&&r.debtorName.toLowerCase().includes(a)||r.amount&&r.amount.toString().includes(a))},[_e,Kr]),mi=Q.useMemo(()=>ui.slice(0,gu*ug),[ui,gu]);u.useEffect(()=>{di(1)},[Kr]),u.useEffect(()=>{cl&&(di(1),pu(""))},[cl]),u.useEffect(()=>{try{const a=(t==null?void 0:t.uid)||"default",r=localStorage.getItem(`hiddenQuickActions_${a}`)??localStorage.getItem("hiddenQuickActions"),i=r?JSON.parse(r):[];Array.isArray(i)&&eu(i.filter(c=>typeof c=="string"))}catch{}},[t==null?void 0:t.uid]),u.useEffect(()=>{const a=r=>{var i;try{const c=(i=r==null?void 0:r.detail)==null?void 0:i.hiddenQuickActions;Array.isArray(c)&&eu(c.map(d=>String(d)))}catch{}};try{window.addEventListener("hiddenQuickActionsChanged",a)}catch{}return()=>{try{window.removeEventListener("hiddenQuickActionsChanged",a)}catch{}}},[]);const dl=async()=>{if(Ee){w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†/Ø§Ù„Ø£Ø¬Ù„ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}try{const a=await Jt.hasMasterPin(t==null?void 0:t.uid);rg&&a?nl(!0):Ks(!0)}catch{Ks(!0)}};u.useEffect(()=>{try{const a=t==null?void 0:t.uid,r=a?`debtsPinRequired_${a}`:"debtsPinRequired",i=localStorage.getItem(r)??localStorage.getItem("debtsPinRequired");(i==="true"||i==="false")&&au(i==="true")}catch{}},[t==null?void 0:t.uid]),u.useEffect(()=>{const a=()=>{try{kl()}catch{}};try{window.addEventListener("debtsUpdated",a)}catch{}return()=>{try{window.removeEventListener("debtsUpdated",a)}catch{}}},[t==null?void 0:t.uid,k,n==null?void 0:n.shopId]);const[mg,ul]=u.useState(!1),[Hs,ml]=u.useState("customers_list"),[Ct,hl]=u.useState([]),[fl,xu]=u.useState(""),[gl,yu]=u.useState(""),[ts,pl]=u.useState(""),[bu,hg]=u.useState(""),[fg,hi]=u.useState(!1),[gg,vu]=u.useState(""),[wu,xl]=u.useState(""),[Nu,yl]=u.useState(""),[pg,fi]=u.useState(!1),[xg,bl]=u.useState(""),[ju,vl]=u.useState(""),[yg,wl]=u.useState(!1),[Nl,bg]=u.useState(""),[vg,Qs]=u.useState(!1),[Ra,Jr]=u.useState(null),[It,Hr]=u.useState(null),[Gs,jl]=u.useState(""),[wg,Xs]=u.useState(!1),[Su,gi]=u.useState(0),[Ut,as]=u.useState(null),[ss,Sl]=u.useState(""),[Du,Dl]=u.useState(""),[Se,Zs]=u.useState(null),[Ng,ku]=u.useState(""),[ze,vs]=u.useState("deduct"),Wa=async a=>{try{const r=JSON.stringify(a);localStorage.setItem(Qr(),r);try{localStorage.setItem(Ol(),r)}catch{}try{localStorage.setItem(El(),Date.now().toString())}catch{}if(t!=null&&t.uid){try{localStorage.setItem(`debts_unsynced_${t.uid}`,"true")}catch{}const i=[];i.push(se.updateUserData(t.uid,{debts:a,debtsDeletedAt:null})),Promise.all(i).then(()=>{try{localStorage.removeItem(`debts_unsynced_${t.uid}`)}catch{}}).catch(c=>{console.error("ÙØ´Ù„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†:",c),we(!0)})}}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¯ÙŠÙˆÙ†:",r)}},kl=async()=>{try{const a=Qr(),r=Ol(),i=El(),c=localStorage.getItem(a),d=localStorage.getItem(r),m=localStorage.getItem(i),f=m?Number(m):0,g=b=>{if(!b)return null;try{const x=JSON.parse(b);return Array.isArray(x)?x.map(N=>{var v;return{...N,createdAt:(v=N.createdAt)!=null&&v.toDate?N.createdAt.toDate():new Date(N.createdAt),partialPayments:Array.isArray(N.partialPayments)?N.partialPayments.map(S=>{var I;return{amount:Number(S.amount)||0,paidAt:(I=S.paidAt)!=null&&I.toDate?S.paidAt.toDate():new Date(S.paidAt)}}):[],additionReceipts:Array.isArray(N.additionReceipts)?N.additionReceipts.map(S=>{var I;return{amount:Number(S.amount)||0,note:typeof S.note=="string"?S.note:void 0,addedAt:(I=S.addedAt)!=null&&I.toDate?S.addedAt.toDate():new Date(S.addedAt)}}):[]}}):[]}catch(x){return console.warn("ÙØ´Ù„ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø¯ÙŠÙˆÙ† localStorage:",x),null}};let y=g(c);if(!y||y.length===0){const b=g(d);if(b&&b.length>0){y=b,Yt(b);try{localStorage.setItem(Qr(),JSON.stringify(b)),localStorage.removeItem(r)}catch(x){console.warn("ØªØ¹Ø°Ø± ØªØ±Ø­ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙˆÙ† Ù…Ø­Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ:",x)}}}if(y&&y.length>0&&Yt(y),t!=null&&t.uid)try{const b=`debts_unsynced_${t.uid}`,x=localStorage.getItem(b)==="true",N=await fa(Me(F,"users",t.uid)),v=[];try{const S=query(ie(F,"debts"),K("userId","==",t.uid));(await pe(S)).forEach(P=>{var M;const _=P.data();v.push({id:P.id,..._,amount:Number(_.amount||0),paidAmount:Number(_.paidAmount||0),createdAt:(M=_.createdAt)!=null&&M.toDate?_.createdAt.toDate():new Date(_.createdAt||Date.now()),partialPayments:Array.isArray(_.partialPayments)?_.partialPayments:[],additionReceipts:Array.isArray(_.additionReceipts)?_.additionReceipts.map(V=>{var H;return{amount:Number(V.amount)||0,note:typeof V.note=="string"?V.note:void 0,addedAt:(H=V.addedAt)!=null&&H.toDate?V.addedAt.toDate():new Date(V.addedAt)}}):[]})})}catch(S){console.warn("Failed to fetch from debts collection:",S)}if(N.exists()){const S=N.data();let I=S.debts&&Array.isArray(S.debts)?S.debts.map(M=>{var V;return{...M,amount:Number(M.amount||0),paidAmount:Number(M.paidAmount||0),createdAt:(V=M.createdAt)!=null&&V.toDate?M.createdAt.toDate():new Date(M.createdAt),partialPayments:Array.isArray(M.partialPayments)?M.partialPayments.map(H=>{var Y;return{amount:Number(H.amount)||0,paidAt:(Y=H.paidAt)!=null&&Y.toDate?H.paidAt.toDate():new Date(H.paidAt)}}):[],additionReceipts:Array.isArray(M.additionReceipts)?M.additionReceipts.map(H=>{var Y;return{amount:Number(H.amount)||0,note:typeof H.note=="string"?H.note:void 0,addedAt:(Y=H.addedAt)!=null&&Y.toDate?H.addedAt.toDate():new Date(H.addedAt)}}):[]}}):[];if(!!S.debtsDeletedAt){Yt([]);try{localStorage.setItem(a,JSON.stringify([])),localStorage.setItem(r,JSON.stringify([]))}catch{}return}if(((I==null?void 0:I.length)||0)>0)if(x)console.log("âš ï¸ ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø¯ÙŠÙˆÙ† ØºÙŠØ± Ù…ØªØ²Ø§Ù…Ù†Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… ØªØ¬Ø§Ù‡Ù„ Ù†Ø³Ø®Ø© Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ù…Ø¤Ù‚ØªØ§Ù‹ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©.");else{Yt(I);try{localStorage.setItem(a,JSON.stringify(I))}catch{}}}else if(v.length>0){Yt(v);try{localStorage.setItem(a,JSON.stringify(v))}catch{}}else y&&y.length>0}catch(b){console.warn("ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙˆÙ† Ù…Ù† FirebaseØŒ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ù„ÙŠ:",b)}}catch(a){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙˆÙ†:",a)}};u.useEffect(()=>{try{window.exportDebts=()=>{try{return JSON.stringify(_e||[])}catch{return"[]"}},window.importDebts=async a=>{try{const r=JSON.parse(a);if(!Array.isArray(r))throw new Error("ØµÙŠØºØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø© â€” ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù…ØµÙÙˆÙØ©");return await Wa(r),{ok:!0,count:r.length}}catch(r){return console.error("ÙØ´Ù„ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙˆÙ†:",r),{ok:!1,error:String(r)}}},window.fixWalletsForCurrentUser=async a=>{try{if(!(t!=null&&t.uid))throw new Error("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹");return await(await le(async()=>{const{merchantWalletService:i}=await import("./index-DhbnydJl.js").then(c=>c.cR);return{merchantWalletService:i}},__vite__mapDeps([0,1]),import.meta.url)).merchantWalletService.reassignByMsisdns(a,t.uid)}catch(r){return console.error("ÙØ´Ù„ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:",r),{updated:0,failed:(a==null?void 0:a.length)||0,error:String(r)}}}}catch{}},[_e,t==null?void 0:t.uid]),u.useEffect(()=>{t!=null&&t.uid&&kl()},[t==null?void 0:t.uid]),u.useEffect(()=>{if(!(t!=null&&t.uid))return;const a=ln(Me(F,"users",t.uid),async r=>{var i;if(r.exists()){const c=r.data(),d=c.isActive===!0;c.subscription&&xd(c.subscription),U0(c.branchPackage||null);const m=await $m.checkTrialValidity(t.uid),f=m.isValid&&!m.isExpired;Ha(d||f),fd(f),gd(m.hoursRemaining),pd(m.hasUsedTrial);const g=!d&&!f;Qa(g),g&&(console.log("â›” User not active, redirecting to pending approval..."),p("/user/pending-approval",{replace:!0})),console.log("ðŸ”„ ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Real-time):",{isActive:d,isOnTrial:f,plan:(i=c.subscription)==null?void 0:i.planType,showModal:g})}});return()=>a()},[t==null?void 0:t.uid]);const jg=async()=>{if(t!=null&&t.uid)try{yd(!0);const a=await ch(t.uid);xd(a)}catch(a){console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:",a)}finally{yd(!1)}},[aj,sj]=u.useState(!1),[Sg,Cl]=u.useState(!1),[qe,Dg]=u.useState(0),[rj,Cu]=u.useState([]),[kg,Cg]=u.useState(null),[De,ft]=u.useState({}),[Ig,Iu]=u.useState(!1),[Ag,Au]=u.useState(!1),[_g,Il]=u.useState(!1),[Tg,pi]=u.useState(!1),[_u,Al]=u.useState(""),[Pg,xi]=u.useState(!1),[Mg,yi]=u.useState(!1),[_l,bi]=u.useState(""),[Og,Tl]=u.useState(!1),[vi,Tu]=u.useState(""),[wi,Pu]=u.useState(""),[Ni,Mu]=u.useState(""),[Ou,Eu]=u.useState(!1),[Pl,Ml]=u.useState(!1),[Eg,Ru]=u.useState(!1),[Wu,Rg]=u.useState([]);u.useEffect(()=>{(async()=>{try{if(!(t!=null&&t.uid)||!Pl)return;try{await rr.trimToMaxCount(t.uid,30)}catch{}const a=await rr.getByUser(t.uid,30);Rg(a)}catch{}})()},[t==null?void 0:t.uid,Pl]);const ot=()=>{const a=k||(n==null?void 0:n.shopId)||"main";return`walletBalances_${(t==null?void 0:t.uid)||"default"}_${a}`},at=()=>{const a=k||(n==null?void 0:n.shopId)||"main";return`cashBalance_${(t==null?void 0:t.uid)||"default"}_${a}`},Lu=()=>{const a=k||(n==null?void 0:n.shopId)||"main";return`cashDrawers_${(t==null?void 0:t.uid)||"default"}_${a}`},Fu=()=>{const a=k||(n==null?void 0:n.shopId)||"main";return`cashDrawerActive_${(t==null?void 0:t.uid)||"default"}_${a}`},$u=(a,r)=>{try{localStorage.setItem(Lu(),JSON.stringify(a)),r&&localStorage.setItem(Fu(),r)}catch{}},lt=a=>{const r=Math.round(Number(a)||0);Cu(i=>{if(!i||i.length===0)return i;const c=kg||i[0].id,d=i.map(m=>m.id===c?{...m,balance:r}:m);return $u(d,c),d}),Dg(r)},Qr=()=>{const a=k||(n==null?void 0:n.shopId)||"main";return`debts_${(t==null?void 0:t.uid)||"default"}_${a}`},Wg=()=>{const a=k||(n==null?void 0:n.shopId)||"main";return`customers_${(t==null?void 0:t.uid)||"default"}_${a}`},Ol=()=>`debts_default_${k||(n==null?void 0:n.shopId)||"main"}`,El=()=>{const a=k||(n==null?void 0:n.shopId)||"main";return`debts_last_write_${(t==null?void 0:t.uid)||"default"}_${a}`},Rl=()=>`shopExpenses_${k||(n==null?void 0:n.shopId)||(t==null?void 0:t.uid)||"default"}`,Bu=()=>{try{const a=localStorage.getItem(Rl());if(a){const r=JSON.parse(a);jo(r.map(i=>({...i,createdAt:new Date(i.createdAt)})))}}catch(a){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ†:",a)}},Uu=async a=>{try{localStorage.setItem(Rl(),JSON.stringify(a)),jo(a)}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ†:",r)}},Lg=async a=>{try{const r=Ln.filter(i=>i.id!==a);await Uu(r);try{if(t!=null&&t.uid&&a){const{doc:i,deleteDoc:c}=await le(async()=>{const{doc:f,deleteDoc:g}=await import("./index-DhbnydJl.js").then(y=>y.cP);return{doc:f,deleteDoc:g}},__vite__mapDeps([0,1]),import.meta.url),{db:d}=await le(async()=>{const{db:f}=await import("./index-DhbnydJl.js").then(g=>g.cQ);return{db:f}},__vite__mapDeps([0,1]),import.meta.url),m=i(d,"shop_expenses",a);await c(m)}}catch(i){console.warn("ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ù…ØµØ±ÙˆÙ Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ø§Ù„Ø¢Ù†ØŒ ØªÙ… Ø§Ù„Ø­Ø°Ù Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙˆØ³ÙŠØ¨Ù‚Ù‰ Ù…Ø®Ø²Ù‘Ù†Ù‹Ø§ Ø¯ÙˆÙ† Ù‡Ø°Ø§ Ø§Ù„Ø¥ÙŠØµØ§Ù„:",i)}w({title:"ØªÙ… Ø§Ù„Ø­Ø°Ù",description:"ØªÙ… Ø­Ø°Ù Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ù…ØµØ±ÙˆÙ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§."})}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ù…ØµØ±ÙˆÙ:",r),w({title:"ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù",description:"ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"})}};Q.useEffect(()=>{let a;return(async()=>{try{if(!(t!=null&&t.uid)){Bu();return}const{collection:r,query:i,where:c,getDocs:d}=await le(async()=>{const{collection:N,query:v,where:S,getDocs:I}=await import("./index-DhbnydJl.js").then(P=>P.cP);return{collection:N,query:v,where:S,getDocs:I}},__vite__mapDeps([0,1]),import.meta.url),{db:m}=await le(async()=>{const{db:N}=await import("./index-DhbnydJl.js").then(v=>v.cQ);return{db:N}},__vite__mapDeps([0,1]),import.meta.url),f=k||(n==null?void 0:n.shopId),g=f?i(r(m,"shop_expenses"),c("shopId","==",f)):i(r(m,"shop_expenses"),c("userId","==",t.uid)),x=(await d(g)).docs.map(N=>{var I;const v=N.data(),S=(I=v.createdAt)!=null&&I.toDate?v.createdAt.toDate():v.createdAt?new Date(v.createdAt):new Date;return{id:N.id,name:String(v.name||""),amount:Number(v.amount||0),notes:v.notes?String(v.notes):void 0,source:v.source==="wallet"?"wallet":"cash",walletId:v.walletId?String(v.walletId):void 0,createdAt:S}}).sort((N,v)=>{const S=N.createdAt instanceof Date?N.createdAt.getTime():0;return(v.createdAt instanceof Date?v.createdAt.getTime():0)-S});jo(x);try{localStorage.setItem(Rl(),JSON.stringify(x))}catch{}}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ Ù…Ù† Firestore:",r)}})(),()=>a==null?void 0:a()},[t==null?void 0:t.uid,n==null?void 0:n.shopId,k]);const ji=()=>`deficiencies_${k||(n==null?void 0:n.shopId)||(t==null?void 0:t.uid)||"default-shop"}`,Fg=()=>{try{const a=ji(),r=`deficiencies_${(t==null?void 0:t.uid)||"default"}`;if(r!==a){const c=localStorage.getItem(r),d=localStorage.getItem(a);if(c)try{const m=JSON.parse(c)||[],f=d?JSON.parse(d):[],g=Array.isArray(f)?[...f]:[],y=(b,x)=>b.some(N=>(N==null?void 0:N.id)&&(x==null?void 0:x.id)&&String(N.id)===String(x.id)||String((N==null?void 0:N.name)||"")===String((x==null?void 0:x.name)||"")&&String((N==null?void 0:N.status)||"pending")===String((x==null?void 0:x.status)||"pending"));if(Array.isArray(m))for(const b of m)y(g,b)||g.push(b);localStorage.setItem(a,JSON.stringify(g));try{localStorage.removeItem(r)}catch{}}catch{}}const i=localStorage.getItem(a);if(i){const c=JSON.parse(i);Ws(c.map(d=>({...d,createdAt:new Date(d.createdAt)})))}}catch(a){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ†:",a)}},Wl=async a=>{try{localStorage.setItem(ji(),JSON.stringify(a)),Ws(a)}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ†:",r)}};Q.useEffect(()=>{(async()=>{try{if(!(t!=null&&t.uid))return;const{collection:r,query:i,where:c,orderBy:d,getDocs:m}=await le(async()=>{const{collection:N,query:v,where:S,orderBy:I,getDocs:P}=await import("./index-DhbnydJl.js").then(_=>_.cP);return{collection:N,query:v,where:S,orderBy:I,getDocs:P}},__vite__mapDeps([0,1]),import.meta.url),{db:f}=await le(async()=>{const{db:N}=await import("./index-DhbnydJl.js").then(v=>v.cQ);return{db:N}},__vite__mapDeps([0,1]),import.meta.url),g=k||(n==null?void 0:n.shopId)||t.uid||"default-shop",y=i(r(f,"deficiencies"),c("shopId","==",g),d("createdAt","desc")),x=(await m(y)).docs.map(N=>{var I;const v=N.data(),S=(I=v.createdAt)!=null&&I.toDate?v.createdAt.toDate():v.createdAt?new Date(v.createdAt):new Date;return{id:N.id,name:String(v.name||""),quantity:Number(v.quantity||1),status:v.status==="purchased"?"purchased":"pending",createdAt:S}});Ws(x);try{localStorage.setItem(ji(),JSON.stringify(x))}catch{}}catch(r){console.warn("ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ù…Ù† Firestore:",r)}})()},[t==null?void 0:t.uid,n==null?void 0:n.shopId,k]);const Ll=async a=>{try{localStorage.setItem(Wg(),JSON.stringify(a)),hl(a),t!=null&&t.uid&&await se.updateUserData(t.uid,{customers:a})}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ†:",r)}},$g=async()=>{try{if(t!=null&&t.uid){const a=await fa(Me(F,"users",t.uid));if(a.exists()){const r=a.data();if(r.customers&&Array.isArray(r.customers)){const i=r.customers.map(c=>{var d;return{...c,createdAt:(d=c.createdAt)!=null&&d.toDate?c.createdAt.toDate():new Date(c.createdAt)}});hl(i);return}}}hl([])}catch(a){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù…Ù† Firestore:",a)}},Fl=()=>{const a=k||(n==null?void 0:n.shopId)||"main";return`transactions_${(t==null?void 0:t.uid)||"default"}_${a}`},Vu=()=>{const a=k||(n==null?void 0:n.shopId)||"main";return`wallets_${(t==null?void 0:t.uid)||"default"}_${a}`},La=()=>{const a=k||(n==null?void 0:n.shopId)||"main";return`selectedWallet_${(t==null?void 0:t.uid)||"default"}_${a}`},$l=a=>{var d;const r=String((a==null?void 0:a.transactionId)||(a==null?void 0:a.id)||""),i=String((a==null?void 0:a.reference)||(a==null?void 0:a.transactionReference)||((d=a==null?void 0:a.receipt)==null?void 0:d.reference)||""),c=new Date((a==null?void 0:a.createdAt)||0).getTime();return r||i||`${i||"ref"}-${c}`},{data:Bl,refetch:nj}=pn({queryKey:["userTransactions",t==null?void 0:t.uid],queryFn:async()=>{if(!(t!=null&&t.uid))return[];const{collection:a,query:r,where:i,orderBy:c,limit:d,getDocs:m}=await le(async()=>{const{collection:b,query:x,where:N,orderBy:v,limit:S,getDocs:I}=await import("./index-DhbnydJl.js").then(P=>P.cP);return{collection:b,query:x,where:N,orderBy:v,limit:S,getDocs:I}},__vite__mapDeps([0,1]),import.meta.url),{db:f}=await le(async()=>{const{db:b}=await import("./index-DhbnydJl.js").then(x=>x.cQ);return{db:b}},__vite__mapDeps([0,1]),import.meta.url),g=r(a(f,"userTransactions"),i("userId","==",t.uid),c("createdAt","desc"),d(100));return(await m(g)).docs.map(b=>{var V;const x=b.data(),N=(V=x.createdAt)!=null&&V.toDate?x.createdAt.toDate():new Date(x.createdAt),v=(x.txnType||"").toLowerCase(),S=v==="send"?"send":v==="receive"?"withdraw":x.type||"withdraw",I=x.status==="confirmed"?"completed":x.status||"completed",P=x.senderMsisdn||x.senderPhone||"",_=x.receiverMsisdn||x.receiverPhone||"",M=Number(x.amount??x.transferredAmount??x.withdrawnAmount??0);return{id:b.id,...x,type:S,status:I,senderPhone:P,receiverPhone:_,amount:M,createdAt:N,provider:x.provider||void 0}})},enabled:!!(t!=null&&t.uid),staleTime:1e3*60*5,gcTime:1e3*60*10});u.useEffect(()=>{if(Bl){const r=Bl.filter(f=>!((f==null?void 0:f.type)==="report"||String((f==null?void 0:f.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"))),i=new Set(($r||[]).map(f=>String(f.id||f.originalTransactionId||""))),c=r.filter(f=>!i.has(String(f.id||""))),d=new Set,m=[];for(const f of c){const g=$l(f);d.has(g)||(d.add(g),m.push(f))}zt(m)}},[Bl,$r]),u.useEffect(()=>{if(!(t!=null&&t.uid))return;let a=!0;return(async()=>{try{const{collection:i,query:c,where:d,getDocs:m,orderBy:f,limit:g}=await le(async()=>{const{collection:N,query:v,where:S,getDocs:I,orderBy:P,limit:_}=await import("./index-DhbnydJl.js").then(M=>M.cP);return{collection:N,query:v,where:S,getDocs:I,orderBy:P,limit:_}},__vite__mapDeps([0,1]),import.meta.url),{db:y}=await le(async()=>{const{db:N}=await import("./index-DhbnydJl.js").then(v=>v.cQ);return{db:N}},__vite__mapDeps([0,1]),import.meta.url),b=c(i(y,"deletedTransactions"),d("userId","==",t.uid),f("createdAt","desc"),g(50)),x=await m(b);if(!a)return;x.docs.forEach(N=>{const v=N.data(),S=String((v==null?void 0:v.originalTransactionId)||""),I=String((v==null?void 0:v.transactionId)||""),P=String((v==null?void 0:v.reference)||""),_=S||I||P||String(N.id);_&&(ba.current.has(_)||(ba.current.add(_),zt(M=>{const V=M.find(H=>H.id===S);return V?((async()=>await Ho(V))(),M.filter(H=>H.id!==S)):M})))})}catch(i){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©:",i)}})(),()=>{a=!1}},[t==null?void 0:t.uid]);const[Ul,Si]=u.useState(""),[Kt,qu]=u.useState(""),ma=Q.useMemo(()=>{const a=Bt;if(!a)return!1;const r=Cm(a),i=a.planType??a.plan??null,c=typeof i=="string"?i.toLowerCase():null,d=c==="monthly"||c==="quarterly"||c==="half_yearly"||c==="yearly"||c==="lifetime"||i===aa.MONTHLY||i===aa.QUARTERLY||i===aa.HALF_YEARLY||i===aa.YEARLY||i===aa.LIFETIME;return r&&d},[Bt]),Ee=Q.useMemo(()=>{var c,d;const a=Bt;if(!a)return!1;const r=((c=a.subscription)==null?void 0:c.planType)??((d=a.subscription)==null?void 0:d.plan)??a.planType??a.plan??null,i=typeof r=="string"?r.toLowerCase():null;return r===aa.ZERO||i==="zero"},[Bt]),Ve=Q.useMemo(()=>{var c,d;const a=Bt;if(!a)return!1;const r=((c=a.subscription)==null?void 0:c.planType)??((d=a.subscription)==null?void 0:d.plan)??a.planType??a.plan??null,i=typeof r=="string"?String(r).trim().toLowerCase():null;return r===aa.TAHWEELA||i==="tahweela"||i==="ØªØ­ÙˆÙŠÙ„Ù‡"},[Bt]),Bg=()=>{if(!ma){w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ù†ØµÙ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒÙƒ.",variant:"destructive"});return}Tn(!0)},[ij,oj]=u.useState(!1),[Ug,Vg]=u.useState(!1),[qg,zg]=u.useState(!1),[Yg,Kg]=u.useState(!1),[Jg,Gr]=u.useState(!1),[ws,Di]=u.useState(""),[Xr,ki]=u.useState(""),[zu,Ci]=u.useState(!1),[Zr,en]=u.useState(null),[Vl,Ii]=u.useState(""),[Hg,Yu]=u.useState(!1),[lj,cj]=u.useState(!1),[Qg,Ai]=u.useState(!1),[Ku,ql]=u.useState(""),[Ju,zl]=u.useState(""),[Hu,Qu]=u.useState(!1);u.useEffect(()=>{const a=r=>{var d,m;const i=(d=r.detail)==null?void 0:d.action,c=((m=r.detail)==null?void 0:m.payload)||{};if(console.log("ðŸ”” Dashboard Navigation Action:",i,c),i==="lines")ke("lines",()=>{const f=(o==null?void 0:o.simSubscription)||(t==null?void 0:t.simSubscription);let g=!1;f!=null&&f.active&&(f!=null&&f.endsAt)&&(f.endsAt.seconds?new Date(f.endsAt.seconds*1e3):new Date(f.endsAt))>new Date&&(g=!0),g?ei(!0):ia(!0)});else if(i==="profile-settings")ke("settings",()=>L(!0));else if(i==="debts")ke("debts",()=>dl());else if(i==="sales")ke("sales",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Wr(!0)});else if(i==="maintenance")ke("maintenance",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„ØµÙŠØ§Ù†Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):ai(!0)});else if(i==="credit-cards")ke("cards",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙƒØ±ÙˆØª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù† ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):ti(!0)});else if(i==="shop-expenses")ke("expenses",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Jt.hasMasterPin()?jr(!0):Es(!0)});else if(i==="deficiencies")ke("deficiencies",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Dr(!0)});else if(i==="installment")ke("installments",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ· ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Vr(!0)});else if(i==="cashier-shift")!ma||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ÙƒØ§Ø´ÙŠØ± Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):Tn(!0);else if(i==="machine-daily")ke("machines",()=>{!ma||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):si(!0)});else if(i==="atm-withdraw")ke("withdrawals",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø³Ø­Ø¨ ATM ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ Ø£Ùˆ ØªØ­ÙˆÙŠÙ„Ù‡. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):J(!0)});else if(i==="pending-operations")te(!0);else if(i==="branch-management")ke("branches",()=>{(Pt==null?void 0:Pt.status)==="active"?yr(!0):br(!0)});else if(i==="wallet-management")zs(!!c.autoStartAdd),qs(!0);else if(i==="my-client-numbers")ke("myNumbers",()=>$n(!0));else if(i==="transaction-section"){const f=()=>{const g=document.getElementById("transaction-section");if(g){const y=c.skipAnimation?"auto":"smooth";g.scrollIntoView({behavior:y})}c.transactionType&&Uo(c.transactionType),c.startNewTransaction&&(_r(""),$s(""),qn(""),zn(""),console.log("ðŸ”’ Starting new transaction via event"))};c.transactionType==="transfer"?ke("transfers",f):c.transactionType==="withdraw"?ke("withdrawals",f):f()}};return window.addEventListener("dashboard-navigation-action",a),()=>window.removeEventListener("dashboard-navigation-action",a)},[ae,Ve,Pt,Ee,ma]);const Gu=async()=>{var a;if(t!=null&&t.uid)try{const r=`userData_${t.uid}`,i=localStorage.getItem(r),c=`debts_unsynced_${t.uid}`,d=localStorage.getItem(Qr()),m=localStorage.getItem(c)==="true";if(i){const f=JSON.parse(i);console.log("ðŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ù…Ø¹ Firebase...",f);const g={lastSynced:new Date().toISOString()};typeof f.cashBalance=="number"&&(g.cashBalance=f.cashBalance),f.walletBalances&&typeof f.walletBalances=="object"&&(g.walletBalances=f.walletBalances),await se.updateUserData(t.uid,g),localStorage.removeItem(r),we(!1),console.log("âœ… ØªÙ…Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©")}else console.log("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ© ØªØ­ØªØ§Ø¬ Ù„Ù„Ù…Ø²Ø§Ù…Ù†Ø©");if(m&&d)try{const f=JSON.parse(d)||[],g=_=>_ instanceof Date?_:typeof(_==null?void 0:_.toDate)=="function"?_.toDate():_?new Date(String(_)):new Date,y=_=>(Array.isArray(_)?_:[]).map(M=>({...M,amount:Number(M.amount||0),paidAmount:Number(M.paidAmount||0),createdAt:g(M.createdAt),partialPayments:Array.isArray(M.partialPayments)?M.partialPayments.map(V=>({amount:Number(V.amount||0),paidAt:g(V.paidAt)})):[]})),b=await fa(Me(F,"users",t.uid)),x=b.exists()?((a=b.data())==null?void 0:a.debts)||[]:[],N=y(x),v=y(f),S={};for(const _ of N)S[String(_.id||"")]=_;const I=[],P=new Set;for(const _ of v){const M=String(_.id||""),V=S[M];if(V){const H=Number(V.paidAmount||0),Y=Number(_.paidAmount||0),Ne=String(V.status||"pending"),Je=String(_.status||"pending"),gt=Ne==="paid"||H>=Number(V.amount||0)?V:Je==="paid"?{...V,paidAmount:Number(_.paidAmount||0),partialPayments:_.partialPayments,status:"paid"}:Y>H?{...V,paidAmount:Number(_.paidAmount||0),partialPayments:_.partialPayments,status:Y>=Number(V.amount||0)?"paid":"pending"}:V;I.push(gt),P.add(M)}else I.push(_),P.add(M)}for(const _ of N){const M=String(_.id||"");P.has(M)||I.push(_)}await se.updateUserData(t.uid,{debts:I});try{localStorage.removeItem(c)}catch{}we(!1)}catch{we(!0)}}catch(r){console.error("âŒ ÙØ´Ù„ ÙÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:",r),w({title:"ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…",variant:"destructive"})}},[Xu,_i]=u.useState({keepLastCount:30,intervalDays:7,lastResetAt:null});u.useEffect(()=>{(async()=>{if(t!=null&&t.uid)try{const r=await se.getUserData(t.uid),i=(r==null?void 0:r.recentReset)||{},c=Number(i==null?void 0:i.keepLastCount)>0?Number(i.keepLastCount):30,d=Number(i==null?void 0:i.intervalDays)>0?Number(i.intervalDays):7,m=b=>b instanceof Date?b:typeof(b==null?void 0:b.toDate)=="function"?b.toDate():b?new Date(String(b)):null,f=i!=null&&i.lastResetAt?m(i.lastResetAt):null,g=new Date;!f||g.getTime()-f.getTime()>=d*24*60*60*1e3?(await se.updateUserData(t.uid,{recentReset:{keepLastCount:c,intervalDays:d,lastResetAt:g}}),_i({keepLastCount:c,intervalDays:d,lastResetAt:g})):_i({keepLastCount:c,intervalDays:d,lastResetAt:f})}catch{_i({keepLastCount:30,intervalDays:7,lastResetAt:null})}})()},[t==null?void 0:t.uid]);const Zu=Q.useMemo(()=>{const a=ye||[],r=f=>f instanceof Date?f:typeof(f==null?void 0:f.toDate)=="function"?f.toDate():new Date(String(f)),i=new Date,c=new Date(i.getFullYear(),i.getMonth(),1),d=new Date(i.getFullYear(),i.getMonth()+1,1);return[...a].sort((f,g)=>r(g.createdAt).getTime()-r(f.createdAt).getTime()).filter(f=>{const g=r(f.createdAt);return g>=c&&g<d})},[ye]);Q.useMemo(()=>{const a=ye||[],r=f=>f instanceof Date?f:typeof(f==null?void 0:f.toDate)=="function"?f.toDate():new Date(String(f)),i=new Date,c=new Date(i.getFullYear(),i.getMonth(),1),d=new Date(i.getFullYear(),i.getMonth()+1,1),m=a.filter(f=>{const g=r(f.createdAt);return g>=c&&g<d}).length;return Math.max(0,((ye==null?void 0:ye.length)||0)-m)},[ye==null?void 0:ye.length]);const Ti=Q.useMemo(()=>{const a=new Date,r=new Date(a.getFullYear(),a.getMonth(),1),i=new Date(a.getFullYear(),a.getMonth()+1,1),c={};for(const m of ye){const f=new Date(m.createdAt||0);if(!(f>=r&&f<i))continue;const g=String(m.type||m.txnType||"").toLowerCase();if(!(g==="send"||g==="withdraw"||g==="transfer"))continue;const y=String(m.receiverPhone||m.senderPhone||"").trim();if(!y)continue;const b=ks(y),x=Number(m.amount||m.withdrawnAmount||m.sentAmount||0)||0;c[b]||(c[b]={phone:b,count:0,total:0}),c[b].count+=1,c[b].total+=x}return Object.values(c).sort((m,f)=>f.count!==m.count?f.count-m.count:f.total-m.total).slice(0,10)},[ye]),Gg=a=>{const r=ks(String(a));return r.startsWith("+20")?"20"+r.slice(3):r.startsWith("0")?"20"+r.slice(1):r.replace(/[^0-9]/g,"")},Xg=a=>{const r=Gg(a.phone),i=`Ø¹Ù…ÙŠÙ„ VIP Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±
Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª: ${a.count}
Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${a.total} Ø¬Ù†ÙŠÙ‡`,c=`https://wa.me/${r}?text=${encodeURIComponent(i)}`;try{window.open(c,"_blank")}catch{}};u.useEffect(()=>{(async()=>{try{if(!(t!=null&&t.uid))return;const a=`${new Date().getFullYear()}-${new Date().getMonth()+1}`;await se.updateUserData(t.uid,{vipTop10:Ti,vipMonthTag:a})}catch{}})()},[t==null?void 0:t.uid,Ti]);async function em(){const a=new Date,r=new Intl.DateTimeFormat("ar-EG",{timeZone:"Africa/Cairo",year:"numeric",month:"2-digit",day:"2-digit"}).format(a),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999),d=(ye||[]).filter(S=>{const I=new Date(S.createdAt||0);return I>=i&&I<=c}),m=d.length,f=d.filter(S=>String(S.type||S.txnType||"").toLowerCase()==="withdraw"||String(S.type||"").toLowerCase()==="receive").reduce((S,I)=>S+(I.withdrawnAmount!=null?Number(I.withdrawnAmount):Number(I.amount||0)),0),g=d.filter(S=>String(S.type||S.txnType||"").toLowerCase()==="send"||String(S.type||"").toLowerCase()==="transfer").reduce((S,I)=>S+(I.sentAmount!=null?Number(I.sentAmount):Number(I.amount||0)),0);let y=0;try{y=d.reduce((S,I)=>S+vt.calculateTransactionProfit(I),0)}catch{}let b=0;try{const S=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(a),I=Ce(ie(F,"dailySales"),K("userId","==",(t==null?void 0:t.uid)||""));b=(await pe(I)).docs.map(M=>M.data()).filter(M=>String(M.date||S)===S).reduce((M,V)=>M+Number(V.sellingPrice||V.price||0)*Number(V.quantity||1),0)}catch{}let x=0;try{x=(_e||[]).filter(I=>String(I.status||"")==="pending").reduce((I,P)=>{const _=Number(P.paidAmount||0);return I+Math.max(0,Number(P.amount||0)-_)},0)}catch{}let N="";try{const S=k||(n==null?void 0:n.shopId)||null,I=S?Ce(ie(F,"deficiencies"),K("shopId","==",S)):Ce(ie(F,"deficiencies"),K("userId","==",(t==null?void 0:t.uid)||""));N=(await pe(I)).docs.map(V=>V.data()).filter(V=>String(V.status||"pending")==="pending").slice(0,10).map((V,H)=>`${H+1}- ${String(V.name||V.productName||"Ø¹Ù†ØµØ±")} Ã— ${Number(V.quantity||V.qty||0)}`).join(`
`)}catch{}return[`ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ - ${r}`,`Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª: ${m}`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª: ${f} Ø¬Ù†ÙŠÙ‡`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ${g} Ø¬Ù†ÙŠÙ‡`,`Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: ${y} Ø¬Ù†ÙŠÙ‡`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±: ${b} Ø¬Ù†ÙŠÙ‡`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙŠÙˆÙ†: ${x} Ø¬Ù†ÙŠÙ‡`,"Ù†ÙˆØ§Ù‚Øµ Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±:",N||"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³Ø¬Ù„Ø©"].join(`
`)}const tm=Q.useCallback(()=>{let a=Zu;const r=$d.trim();if(r&&(a=a.filter(i=>{const c=i;return String(c.type||"").toLowerCase()==="cash_addition"||String(c.txnType||"").toLowerCase()==="cash_addition"||String(c.title||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©")?!0:i.senderPhone&&i.senderPhone.includes(r)||i.receiverPhone&&i.receiverPhone.includes(r)})),Xn){const i=new Date(Xn);a=a.filter(c=>{const d=new Date(c.createdAt);if(Zn){const[m,f]=Zn.split(":"),g=new Date(i);g.setHours(parseInt(m),parseInt(f),0,0);const y=new Date(g);return y.setHours(y.getHours()+1),d>=g&&d<y}else return d.toDateString()===i.toDateString()})}try{a=[...a].sort((i,c)=>{const d=new Date(i.createdAt||0).getTime();return new Date(c.createdAt||0).getTime()-d})}catch{}return a},[Zu,$d,Xn,Zn]),am=async()=>{if(Ee||Ve){w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"});return}if(!(t!=null&&t.uid)){w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©",description:"ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}try{const a=await em(),r=t!=null&&t.uid?`tg_daily_report_last_${t.uid}`:"tg_daily_report_last",i=Date.now();let c=!0;try{const d=localStorage.getItem(r);if(d){const m=JSON.parse(d),f=Number((m==null?void 0:m.at)||0);i-f<3e4&&(c=!1)}}catch{}if(c){await js.send(t.uid,a);try{localStorage.setItem(r,JSON.stringify({at:i}))}catch{}}w({title:"ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",variant:"default"})}catch{w({title:"ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:"ØªØ¹Ø°Ù‘Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",variant:"destructive"})}},[Zg,Pi]=u.useState(!1),[sm,Mi]=u.useState(""),[ep,Oi]=u.useState(!1),[Yl,Kl]=u.useState(""),[tp,we]=u.useState(!1),[ap,Jl]=u.useState(!1),Fa=async(a,r=2,i=700)=>{let c;for(let d=0;d<=r;d++)try{return await a()}catch(m){if(c=m,d===r)break;await new Promise(f=>setTimeout(f,i*Math.pow(2,d)))}throw c};ae.reduce((a,r)=>a+(De[r.id]||0),0);const sp=async a=>await Jt.verifyMasterPin(a,t==null?void 0:t.uid),Ei=async a=>await Jt.verifyMasterPin(a,t==null?void 0:t.uid);u.useEffect(()=>{if(t!=null&&t.uid){try{const a=ot(),r=`walletBalances_${t.uid}`,i=localStorage.getItem(a)??localStorage.getItem(r);if(i){const c=JSON.parse(i);ft(c&&typeof c=="object"?c:{});try{localStorage.setItem(a,JSON.stringify(c||{}))}catch{}}}catch{}try{const a=at(),r=`cashBalance_${t.uid}`,i=`userCashBalance_${t.uid}`;let c=localStorage.getItem(a)??localStorage.getItem(r)??localStorage.getItem(i);if(c!=null){const d=parseFloat(c),m=Number.isFinite(d)?Math.round(d):0;lt(m);try{localStorage.setItem(a,String(m)),localStorage.removeItem(r),localStorage.removeItem(i)}catch{}}}catch{}try{const a=localStorage.getItem(Lu());let r=[];if(a){const d=JSON.parse(a);Array.isArray(d)&&(r=d.map(m=>({id:String(m.id||`drawer_${Date.now()}`),name:String(m.name||"Ø¯Ø±Ø¬ Ù†Ù‚Ø¯ÙŠØ©"),balance:Number(m.balance||0),isDefault:!!m.isDefault})))}(!r||r.length===0)&&(r=[{id:"drawer_main",name:"Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",balance:0,isDefault:!0}]);const i=localStorage.getItem(Fu());let c=i&&r.some(d=>d.id===i)?i:null;!c&&r.length>0&&(c=(r.find(m=>m.isDefault)||r[0]).id),Cu(r),Cg(c),$u(r,c)}catch{}}},[t==null?void 0:t.uid,k,n==null?void 0:n.shopId]),u.useEffect(()=>{const a=r=>{var i;try{const c=Number((i=r==null?void 0:r.detail)==null?void 0:i.value);if(Number.isFinite(c))lt(Math.round(c));else{const d=localStorage.getItem(at());d!=null&&lt(Math.round(parseFloat(d))||0)}}catch{const c=localStorage.getItem(at());c!=null&&lt(Math.round(parseFloat(c))||0)}};return window.addEventListener("cashBalanceChanged",a),()=>window.removeEventListener("cashBalanceChanged",a)},[t==null?void 0:t.uid,k,n==null?void 0:n.shopId]),u.useEffect(()=>{const a=k||(n==null?void 0:n.shopId);if(!(t!=null&&t.uid)||!a)return;const r=Me(F,"dashboardData",a),i=ln(r,c=>{var d;if(c.exists()){const m=c.data();console.log("ðŸ”„ Dashboard data updated in real-time:",m);const f=Math.round(Number((m==null?void 0:m.cashBalance)||0)),g=m!=null&&m.walletBalances&&typeof m.walletBalances=="object"?m.walletBalances:{};lt(f),ft(g);try{if(localStorage.setItem(at(),String(f)),localStorage.setItem(ot(),JSON.stringify(g)),m!=null&&m.lastUpdated){let y=String(m.lastUpdated);typeof((d=m.lastUpdated)==null?void 0:d.toDate)=="function"?y=m.lastUpdated.toDate().toISOString():m.lastUpdated instanceof Date&&(y=m.lastUpdated.toISOString()),localStorage.setItem(at()+"_lastUpdated",y),localStorage.setItem(ot()+"_lastUpdated",y)}}catch(y){console.error("Error saving dashboard data to local storage:",y)}}},c=>{console.error("Error subscribing to dashboard data:",c)});return()=>i()},[t==null?void 0:t.uid,k,n==null?void 0:n.shopId]),u.useEffect(()=>{const a=k||(n==null?void 0:n.shopId);if(!(t!=null&&t.uid)||!a)return;const r=Ce(ie(F,"transactions"),K("shopId","==",a),$i("createdAt","desc"),Im(1)),i=ln(r,async c=>{if(!c.empty){console.log("ðŸ”„ New transaction detected via listener, IMMEDIATELY refreshing limits/balances..."),Wi();try{const d=Me(F,"dashboardData",a),m=await fa(d);if(m.exists()){const f=m.data(),g=Math.round(Number((f==null?void 0:f.cashBalance)||0)),y=f!=null&&f.walletBalances&&typeof f.walletBalances=="object"?f.walletBalances:{};lt(g),ft(b=>JSON.stringify(b)!==JSON.stringify(y)?y:b)}}catch(d){console.error("Error manual refresh of dashboard data:",d)}}});return()=>i()},[t==null?void 0:t.uid,k,n==null?void 0:n.shopId]);const rm=a=>`walletLimits_${(t==null?void 0:t.uid)||"default"}_${a||"none"}`,[Ri,rp]=u.useState(null);u.useEffect(()=>{if(!R)return;const a=Me(F,"walletLimits",String(R)),r=ln(a,i=>{i.exists()&&(console.log("ðŸ”„ Wallet limits updated in real-time:",i.data()),rp(i.data()))});return()=>r()},[R]),u.useEffect(()=>{if(R)try{const a=rm(R),r=localStorage.getItem(a);if(r&&!Ri){const i=JSON.parse(r);Zs(i)}if(Ri){const i=Ri,c={walletId:R,dailyTransferLimit:i.dailyTransferLimit??6e4,dailyWithdrawLimit:i.dailyWithdrawLimit??1e5,dailyTransferUsed:i.dailyTransferUsed??0,dailyWithdrawUsed:i.dailyWithdrawUsed??0,monthlyTransferLimit:i.monthlyTransferLimit??2e5,monthlyWithdrawLimit:i.monthlyWithdrawLimit??2e5,monthlyTransferUsed:i.monthlyTransferUsed??0,monthlyWithdrawUsed:i.monthlyWithdrawUsed??0};Zs(c);try{localStorage.setItem(rm(R),JSON.stringify(c))}catch{}}}catch{}},[R,Ri]),u.useEffect(()=>{if(!R)return;const a=ae.find(r=>r.id===R);if(a!=null&&a.name){ku(String(a.name));try{localStorage.setItem(`walletName_${(t==null?void 0:t.uid)||"default"}_${R}`,String(a.name))}catch{}return}try{const r=localStorage.getItem(`walletName_${(t==null?void 0:t.uid)||"default"}_${R}`);r&&ku(String(r))}catch{}},[R,ae]);const Wi=async()=>{try{if(!R)return;const a=await Ka.autoResetLimitsIfNeeded(R);Zs(a)}catch(a){console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:",a)}};u.useEffect(()=>{Wi()},[R]),u.useEffect(()=>{const a=r=>{var i;(i=r==null?void 0:r.detail)!=null&&i.walletId&&r.detail.walletId===R&&Wi()};return window.addEventListener("walletLimitsUpdated",a),()=>window.removeEventListener("walletLimitsUpdated",a)},[R]),u.useEffect(()=>{const a=r=>{var i;try{const c=String(((i=r==null?void 0:r.detail)==null?void 0:i.walletId)||"");c&&tn(c,"sms:auto")}catch{}};return window.addEventListener("walletSelection:update",a),()=>window.removeEventListener("walletSelection:update",a)},[ae]),u.useEffect(()=>{if(h.state){if(console.log("Location state:",h.state),h.state.openDebtDialog&&(dl(),window.history.replaceState({},document.title)),h.state.openSalesDialog&&(Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Wr(!0),window.history.replaceState({},document.title)),h.state.openMaintenanceDialog&&(Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„ØµÙŠØ§Ù†Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):ai(!0),window.history.replaceState({},document.title)),h.state.openCreditCardsDialog&&(console.log("Opening credit cards dialog"),Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙƒØ±ÙˆØª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù† ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):ti(!0),window.history.replaceState({},document.title)),h.state.openShopExpensesDialog&&(Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):id&&Jt.hasMasterPin()?jr(!0):Es(!0),window.history.replaceState({},document.title)),h.state.openDeficienciesDialog&&(Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Dr(!0),window.history.replaceState({},document.title)),h.state.openInstallment&&(Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ· ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Vr(!0),window.history.replaceState({},document.title)),h.state.openTransactionSection){const a=document.getElementById("transaction-section");a&&a.scrollIntoView({behavior:"smooth"}),h.state.transactionType&&Uo(h.state.transactionType),h.state.startNewTransaction&&(_r(""),$s(""),qn(""),zn(""),console.log("ðŸ”’ Starting new transaction without changing wallet selection")),h.state.focusWalletSelection&&setTimeout(()=>{const r=document.querySelector('[data-testid="wallet-select"]');r&&r.focus()},500),window.history.replaceState({},document.title)}h.state.openCashierShiftModal&&(!ma||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ÙƒØ§Ø´ÙŠØ± Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):Tn(!0),window.history.replaceState({},document.title)),h.state.openMachineDailyDialog&&(!ma||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):si(!0),window.history.replaceState({},document.title)),h.state.openBranchManagement&&((Pt==null?void 0:Pt.status)==="active"?yr(!0):br(!0),window.history.replaceState({},document.title)),h.state.openMyClientNumbersDialog&&($n(!0),window.history.replaceState({},document.title)),h.state.openPendingOperationsDialog&&(te(!0),window.history.replaceState({},document.title)),h.state.openWalletManagement&&(zs(h.state.walletManagementMode==="add"),qs(!0),window.history.replaceState({},document.title))}},[h.state,ae,Ve,Pt]),u.useEffect(()=>{h.pathname==="/user/dashboard"&&sessionStorage.getItem("previousPath")==="/user/add-wallet"&&(console.log("ðŸ”„ Returned from wallet addition page - reloading wallets"),Hl(),sessionStorage.removeItem("previousPath")),sessionStorage.setItem("previousPath",h.pathname)},[h.pathname,t==null?void 0:t.uid]),u.useEffect(()=>{if(!(t!=null&&t.uid))return;(async()=>{try{const r=Me(F,"users",t.uid),i=await fa(r);if(i.exists()){const d=i.data().isActive===!0;d&&!wr?(Ha(!0),Qa(!1),Nr(!1)):!d&&wr&&(Ha(!1),Qa(!0))}}catch(r){console.error("Check user status error",r)}})()},[t==null?void 0:t.uid]),u.useEffect(()=>{if(!(t!=null&&t.uid))return;const a=i=>{const{userId:c}=i.detail;c===t.uid&&(console.log("ðŸŽ‰ Subscription activation event received for current user!"),Ha(!0),Qa(!1),Nr(!1),setTimeout(()=>{console.log("âœ… User activation completed - data updated")},1e3))},r=i=>{const c=i.detail||{},{userId:d,isActive:m}=c;d&&d===t.uid&&(console.log("ðŸ”„ User subscription update event received:",{userId:d,isActive:m}),m&&!wr&&(Ha(!0),Qa(!1),Nr(!1),setTimeout(()=>{console.log("âœ… User subscription updated - data refreshed")},1e3)))};return window.addEventListener("subscriptionActivated",a),window.addEventListener("userSubscriptionUpdated",r),()=>{window.removeEventListener("subscriptionActivated",a),window.removeEventListener("userSubscriptionUpdated",r)}},[t==null?void 0:t.uid,wr]),u.useEffect(()=>{const a=r=>{var m;const i=r.target,c=(m=i==null?void 0:i.tagName)==null?void 0:m.toLowerCase();if(!(c==="input"||c==="textarea"||c==="select"||((i==null?void 0:i.isContentEditable)??!1))&&!(r.ctrlKey||r.altKey||r.metaKey)&&!r.repeat){if((Ee||Ve)&&r.key>="1"&&r.key<="9"){r.preventDefault();return}switch(r.key){}}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[Ee,Ve,ma]),u.useEffect(()=>{console.log("ðŸ”¥ useEffect loadUserData started",{user:t==null?void 0:t.uid,isCheckingActivation:vo}),(async()=>{try{if(!(t!=null&&t.uid)){console.log("ðŸ”¥ No user UID, setting isCheckingActivation to false"),Nr(!1);return}try{const m=await fa(Me(F,"users",t.uid));if(m.exists()){const g=m.data().isActive===!0,y=await $m.checkTrialValidity(t.uid),b=y.isValid&&!y.isExpired;Ha(g||b),fd(b),gd(y.hoursRemaining),pd(y.hasUsedTrial),Qa(!g&&!b),console.log("ðŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",{isActive:g,isOnTrial:b,hoursRemaining:y.hoursRemaining,hasUsedTrial:y.hasUsedTrial})}else Ha(!1),Qa(!0)}catch(m){console.error("Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø­Ø§Ù„Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",m),Ha(!1),Qa(!0)}finally{Nr(!1)}if(console.log("ðŸ”„ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firebase...",{userId:t==null?void 0:t.uid}),t!=null&&t.uid){const m=await Fa(()=>se.getUserData(t.uid)),f=`userData_${t==null?void 0:t.uid}`;let g=null;try{const y=localStorage.getItem(f);y&&(g=JSON.parse(y))}catch{}if(m){let y=(m==null?void 0:m.walletBalances)||{},b=m==null?void 0:m.cashBalance;const x=m.lastUpdated?new Date(m.lastUpdated).getTime():0;g&&(g.lastUpdated?new Date(g.lastUpdated).getTime():0)>=x&&(g.walletBalances&&(y=g.walletBalances),g.cashBalance!==void 0&&(b=g.cashBalance));try{const N=at(),v=ot(),S=localStorage.getItem(N+"_lastUpdated"),I=localStorage.getItem(v+"_lastUpdated"),P=S?new Date(S).getTime():0,_=I?new Date(I).getTime():0;if(P>x){const M=localStorage.getItem(N);M!==null&&(b=parseFloat(M))}if(_>x){const M=localStorage.getItem(v);if(M!==null)try{y=JSON.parse(M)}catch{}}}catch(N){console.error("Error checking individual keys fallback:",N)}ft(y),b!==void 0&&lt(b);try{const N=t!=null&&t.uid?await Fa(()=>gn.getDeletedTransactionsByUser(t.uid)):[];Br(N||[])}catch{Br([])}}else{ft({});try{const y=t!=null&&t.uid?await gn.getDeletedTransactionsByUser(t.uid):[];Br(y||[])}catch{Br([])}}}console.log("ðŸ”„ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase...");try{const m=await Fa(()=>yn.getByMerchantId((t==null?void 0:t.uid)||""));if(m&&m.length>0){console.log("âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",m.length);const f=m.filter(N=>N.isActive===!0);let g=f.map(N=>({id:N.id,name:N.label||"Ù…Ø­ÙØ¸Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",phone:N.msisdn,isDefault:!1,monthlyWithdrawalLimit:N.monthlyWithdrawalLimit??N.withdrawLimit??2e5,monthlyTransferLimit:N.monthlyTransferLimit??N.transferLimit??2e5,defaultTransferCommission:N.defaultTransferCommission!=null?Number(N.defaultTransferCommission):null,defaultWithdrawCommission:N.defaultWithdrawCommission!=null?Number(N.defaultWithdrawCommission):null,ownerName:N.ownerName,nationalId:N.nationalId,providerName:N.provider}));if(C&&(D!=null&&D.allowedWalletIds)&&D.allowedWalletIds.length>0){const N=new Set(D.allowedWalletIds.map(v=>String(v)));g=g.filter(v=>N.has(String(v.id)))}Pa(g);const y={};f.forEach(N=>{N.balance!==void 0&&(y[N.id]=Number(N.balance))}),Object.keys(y).length>0&&ft(N=>({...N,...y}));const b=localStorage.getItem(La());let x=null;b&&g.find(N=>N.id===b)?x=g.find(N=>N.id===b):x=g[0],x&&(ms(x.id),Ga(x.phone)),console.log("ðŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase ÙˆØ­ÙØ¸Ù‡Ø§ ÙÙŠ localStorage")}else console.log("âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase. Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© ÙØ§Ø±ØºØ© Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ù…Ø­Ù„ÙŠ."),Pa([])}catch(m){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase:",m),Pa([])}const d=t!=null&&t.uid?await Fa(()=>se.getUserTransactions(t.uid)):[];if(d&&d.length>0){console.log("ðŸ“Š ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù…Ù† Firebase:",d.length);const m=d.map(x=>({...x,createdAt:new Date(x.createdAt),senderPhone:x.senderMsisdn||x.senderPhone||"",receiverPhone:x.receiverMsisdn||x.receiverPhone||"",type:x.txnType==="send"?"send":x.txnType==="receive"?"withdraw":x.type||"withdraw",status:x.status==="confirmed"?"completed":x.status||"completed"})),f=$r.map(x=>x.id||x.originalTransactionId);let g=[];try{const x=Ce(ie(F,"deletedTransactions"),K("userId","==",(t==null?void 0:t.uid)||""),K("permanent","==",!0));g=(await pe(x)).docs.map(v=>{const S=v.data();return String(S.originalTransactionId||S.transactionId||v.id||"")}).filter(Boolean)}catch{}const y=new Set(g),b=m.filter(x=>{var _;const N=String(x.id||""),v=String(x.transactionId||""),S=String(x.reference||x.transactionReference||((_=x.receipt)==null?void 0:_.reference)||""),I=f.includes(N),P=y.has(N)||v&&y.has(v);return!I&&!P});console.log("âœ… ØªÙ… ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©:",{total:d.length,deleted:f.length,active:b.length});{const x=new Set,N=[];for(const v of b){const S=$l(v);x.has(S)||(x.add(S),N.push(v))}_f||zt(N)}}await Gu()}catch(d){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firebase:",d)}})().then(async()=>{await c(),await r(),await i()});const r=async()=>{try{if(!(t!=null&&t.uid))return;const d=await yn.getByMerchantId(t.uid);await Promise.all(d.map(m=>Lw.autoResetLimitsIfNeeded(m.id)))}catch(d){console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯:",d)}},i=async()=>{try{await vt.syncReportsDataFromFirebase(t==null?void 0:t.uid);const d=vt.getReportsData(t==null?void 0:t.uid);if((d.lastDailyResetDate?vt.shouldResetDailyReports(d.lastDailyResetDate):!1)&&(t!=null&&t.uid)&&d.lastDailyResetDate){const g=new Date(d.lastDailyResetDate),y=g.toDateString(),b=ye.filter(_=>new Date(_.createdAt).toDateString()===y&&_.status==="completed"),x=b.length,N=b.reduce((_,M)=>_+M.amount,0),v=b.filter(an).reduce((_,M)=>{const V=M.withdrawnAmount!==void 0?M.withdrawnAmount:M.amount;return _+V},0),S=b.filter(sn).reduce((_,M)=>{const V=M.sentAmount!==void 0?M.sentAmount:M.amount;return _+V},0),I=b.reduce((_,M)=>_+vt.calculateTransactionProfit(M),0),P=new Date(g).toISOString().slice(0,10);await rr.add({userId:t.uid,reportDate:P,totalTransactions:x,totalAmount:Math.round(N),totalWithdrawn:Math.round(v),totalSent:Math.round(S),profit:Math.round(I),walletId:null})}const f=vt.autoResetReportsIfNeeded(t==null?void 0:t.uid);(f.dailyReset||f.monthlyReset)&&console.log("ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ:",f)}catch(d){console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ØªÙ‚Ø§Ø±ÙŠØ±:",d)}},c=async()=>{try{if(!(t!=null&&t.uid))return;const d=new Date;if(d.getDate()!==1)return;const m=`${d.getFullYear()}-${d.getMonth()+1}`,f=`lastMonthlyDbCleanup:${t.uid}`;if(localStorage.getItem(f)===m)return;const y=new Date(d.getFullYear(),d.getMonth(),1,0,0,0,0),b=v=>v instanceof Date?v:typeof(v==null?void 0:v.toDate)=="function"?v.toDate():new Date(String(v));let x=[];try{const v=Ce(ie(F,"userTransactions"),K("userId","==",t.uid),K("createdAt","<",y));x=(await pe(v)).docs}catch{const v=Ce(ie(F,"userTransactions"),K("userId","==",t.uid));x=(await pe(v)).docs.filter(I=>{var P;return b((P=I.data())==null?void 0:P.createdAt)<y})}await Promise.allSettled(x.map(v=>Am(v.ref)));let N=[];try{const v=Ce(ie(F,"transactions"),K("userId","==",t.uid),K("createdAt","<",y));N=(await pe(v)).docs}catch{const v=Ce(ie(F,"transactions"),K("userId","==",t.uid));N=(await pe(v)).docs.filter(I=>{var P;return b((P=I.data())==null?void 0:P.createdAt)<y})}await Promise.allSettled(N.map(v=>Am(v.ref)));try{localStorage.setItem(f,m)}catch{}console.log("âœ… ØªÙ… ØªÙ†Ø¸ÙŠÙ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ù‡Ø±ÙŠÙ‹Ø§ (Firebase ÙÙ‚Ø·):",{userTransactionsDeleted:x.length,globalTransactionsDeleted:N.length,monthStart:y})}catch(d){console.error("ÙØ´Ù„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:",d)}};jg(),kl(),$g(),console.log("ðŸ”¥ useEffect loadUserData completed")},[t==null?void 0:t.uid]),u.useEffect(()=>{if(!(t!=null&&t.uid))return;const a=se.subscribeToUserTransactions(t.uid,r=>{if(!r||r.length===0)return;const i=r.map(c=>({...c,createdAt:new Date(c.createdAt),senderPhone:c.senderMsisdn||c.senderPhone||"",receiverPhone:c.receiverMsisdn||c.receiverPhone||"",type:c.txnType==="send"?"send":c.txnType==="receive"?"withdraw":c.type||"withdraw",status:c.status==="confirmed"?"completed":c.status||"completed"}));zt(c=>{const d=[...i,...c],m=new Set,f=[];for(const g of d){const y=$l(g);m.has(y)||(m.add(y),f.push(g))}return f.sort((g,y)=>{const b=g.createdAt instanceof Date?g.createdAt.getTime():new Date(g.createdAt).getTime();return(y.createdAt instanceof Date?y.createdAt.getTime():new Date(y.createdAt).getTime())-b})})},30);return()=>a()},[t==null?void 0:t.uid]),u.useEffect(()=>{const a=k||(n==null?void 0:n.shopId);if(!a)return;const r=se.subscribeToDashboardData(a,i=>{if(!i)return;const c=Number(i.cashBalance||0);lt(c);const d=i.walletBalances&&typeof i.walletBalances=="object"?i.walletBalances:{};ft(d);try{if(localStorage.setItem(at(),String(c)),localStorage.setItem(ot(),JSON.stringify(d)),i.lastUpdated){const m=String(i.lastUpdated);localStorage.setItem(at()+"_lastUpdated",m),localStorage.setItem(ot()+"_lastUpdated",m)}}catch(m){console.error("Error saving real-time dashboard data to local storage",m)}});return()=>r()},[k,n==null?void 0:n.shopId]);const Hl=async()=>{var a;if(t!=null&&t.uid)try{const r=await Fa(()=>yn.getByMerchantId(t.uid));if(r&&r.length>0){const c=r.filter(d=>d.isActive===!0).map(d=>({id:d.id,name:d.label||"Ù…Ø­ÙØ¸Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",phone:d.msisdn,isDefault:!1,monthlyWithdrawalLimit:d.monthlyWithdrawalLimit??d.withdrawLimit??2e5,monthlyTransferLimit:d.monthlyTransferLimit??d.transferLimit??2e5,defaultTransferCommission:d.defaultTransferCommission!=null?Number(d.defaultTransferCommission):void 0,defaultWithdrawCommission:d.defaultWithdrawCommission!=null?Number(d.defaultWithdrawCommission):void 0}));if(Pa(c),t!=null&&t.uid){const d=localStorage.getItem(La());if(!!(R&&c.find(f=>f.id===R)))console.log("ðŸ”’ Preserving current wallet selection:",R);else{const g=(d&&c.find(y=>y.id===d)?d:null)||((a=c[0])==null?void 0:a.id);g&&(console.log("ðŸ”„ Fixing invalid wallet selection:",g),tn(g))}}console.log("ðŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase:",c.length)}}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase:",r)}};u.useEffect(()=>{const a=h.pathname;if(sessionStorage.getItem("previousPath")==="/user/add-wallet"&&a==="/user/dashboard"){E.invalidateQueries({queryKey:["wallets",t==null?void 0:t.uid]});try{Qn.refetch()}catch{}sessionStorage.removeItem("previousPath")}sessionStorage.setItem("previousPath",a)},[h.pathname,t==null?void 0:t.uid]),u.useEffect(()=>{const a=()=>{E.invalidateQueries({queryKey:["wallets",t==null?void 0:t.uid]});try{Qn.refetch()}catch{}};return window.addEventListener("focus",a),()=>{window.removeEventListener("focus",a)}},[t==null?void 0:t.uid,R,ae]);const tn=async(a,r="unknown")=>{console.log(`ðŸŽ¯ setWalletSelection called from ${r} with walletId:`,a),console.log("ðŸ” Previous selectedWallet:",R),ms(a);const i=ae.find(c=>c.id===a);if(i&&(Ga(i.phone),console.log("âœ… Wallet set successfully:",a,"Phone:",i.phone)),t!=null&&t.uid){localStorage.setItem(La(),a),console.log("ðŸ’¾ Saved wallet to localStorage:",a);try{await cn.set({key:"selected_wallet_id",value:a}),await cn.set({key:"current_user_id",value:t.uid}),console.log("ðŸ“± Saved wallet and user ID to Capacitor Preferences:",a,t.uid)}catch(c){console.error("âŒ Failed to save to Capacitor Preferences:",c)}}};u.useEffect(()=>{const a=()=>{Hl()};try{window.addEventListener("wallets:activation-updated",a)}catch{}return()=>{try{window.removeEventListener("wallets:activation-updated",a)}catch{}}},[t==null?void 0:t.uid]);const np=a=>{if(a==="__add_wallet"){zs(!0),qs(!0);return}if(a==="__view_wallets"){Vn(!0);return}yx.isEnabled(t==null?void 0:t.uid)?(Ro(a),Eo(!0)):tn(a,"walletSelectionNoPin")},Li=a=>{console.log("ðŸ”„ handleTransactionTypeChange called with type:",a),console.log("ðŸ” Current selectedWallet before change:",R),console.log("ðŸ” Available wallets count:",ae.length),Uo(a),_r(""),$s(""),qn(""),zn(""),Wo(""),Yn(!1),console.log("âœ… Transaction type changed to:",a,"- Wallet selection preserved:",R),setTimeout(()=>{const r=document.getElementById("transaction-section");if(r){const i=r.getBoundingClientRect();(i.top<0||i.top>80)&&r.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}},100)};u.useEffect(()=>{const a=r=>{const i=r.target;if(!!i&&(i.tagName==="INPUT"||i.tagName==="TEXTAREA"||i.tagName==="SELECT"||i.isContentEditable)||(r.key==="ArrowLeft"?(r.preventDefault(),Li("withdraw")):r.key==="ArrowRight"&&(r.preventDefault(),Li("transfer"))),r.key==="Enter"){if(document.querySelector('[role="dialog"]'))return;const d=B==="transfer"?"transferSubmitButton":"withdrawSubmitButton",m=document.getElementById(d);m&&!m.disabled&&(r.preventDefault(),m.click())}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[B]);const nm=a=>{kf((i=>{const c=String(i.description||""),d=String(i.title||""),m=c.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡")||c.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||c.includes("machine transfer")||d.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡")||d.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡"),f=String((i==null?void 0:i.provider)||"").toLowerCase(),g=f.includes("vodafone")?"vf-cash":f.includes("instapay")?"instapay":"",y=i.type==="send"?"ØªØ­ÙˆÙŠÙ„":"Ø³Ø­Ø¨";let b=i.type==="withdraw"&&g?`${y} ${g}`:y;return m?b="ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡":i.title&&(b=i.title),{id:i.id,type:m||i.type==="send"||i.type==="transfer"?"transfer":"withdraw",sender_msisdn:i.senderPhone,receiver_msisdn:i.receiverPhone,amount:i.amount,commission:i.commission||0,fee:(i==null?void 0:i.fee)??0,status:i.status==="failed"?"failed":i.status==="completed"?"completed":"pending",createdAt:new Date(i.createdAt).toISOString(),updatedAt:new Date(i.createdAt).toISOString(),shopName:T??(n==null?void 0:n.shopName)??(t==null?void 0:t.displayName)??"Ø§Ù„Ù…Ø­Ù„",cashierName:(i==null?void 0:i.cashierName)??null,commissionMode:(i==null?void 0:i.commissionMode)??(i.type==="send"||ct?"add":"deduct"),totalCharged:(i==null?void 0:i.totalCharged)??(i.type==="send"?Number(i.amount||0)+Number(i.commission||0)+Number((i==null?void 0:i.fee)||0):ct?Number(i.amount||0)+Number(i.commission||0):Number(i.amount||0)),note:(i==null?void 0:i.note)??(i==null?void 0:i.notes)??void 0,senderName:(i==null?void 0:i.senderName)??void 0,provider:(i==null?void 0:i.provider)??void 0,title:b,description:(i==null?void 0:i.description)??void 0}})(a)),Gn(!0)},Ql=async a=>{var d;if(!(t!=null&&t.uid)){w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©",description:"ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª",variant:"destructive"});return}const r=ye.find(m=>m.id===a);if(!r){w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù",description:"Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø­Ø°ÙÙ‡Ø§",variant:"destructive"});return}const i=String(a),c=String((r==null?void 0:r.transactionId)||(r==null?void 0:r.reference)||"");ba.current.add(i),c&&ba.current.add(c);try{console.log("ðŸ—‘ï¸ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©:",a),console.log("ðŸ”„ Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Firebase...",{transactionId:r.id,userId:t.uid,transactionData:r}),await se.removeUserTransaction(t.uid,r.id),console.log("âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Firebase userTransactions");try{await gn.saveDeletedTransaction({...r,userId:t.uid,originalTransactionId:r.id,transactionId:r.transactionId||r.id,reference:r.reference||r.transactionReference||((d=r.receipt)==null?void 0:d.reference),deletedAt:new Date().toISOString(),permanent:!0}),console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§Øª Ù…Ø¹ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø°Ù")}catch(g){console.warn("âš ï¸ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§ØªØŒ Ù„ÙƒÙ† Ø§Ù„Ø­Ø°Ù Ù…Ù† Firebase Ù†Ø¬Ø­:",g)}try{await gn.permanentlyDeleteTransaction(r.id,t.uid)}catch(g){console.warn("âš ï¸ ÙØ´Ù„ ÙˆØ³Ù… Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø£Ùˆ Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ:",g)}const m=[...$r,r],f=ye.filter(g=>g.id!==a);Br(m),zt(f),Rd(!1),console.log("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù Ù…Ù† Firebase (Ø¨Ø¯ÙˆÙ† Ù†Ø³Ø® Ù…Ø­Ù„ÙŠØ©)");try{const g=r.walletId||r.fromWallet;try{const y=await se.getUserData(t.uid),b={...(y==null?void 0:y.walletBalances)||{}},x=Number((y==null?void 0:y.cashBalance)||0);if(g&&b[g]!==void 0){const N=Number(r.amount||0),v=Number(r.commission||0),S=(r.type||"").toLowerCase(),I=S==="send"||S==="transfer";let P=x,_=Number(b[g]);console.log("ðŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø£Ø±ØµØ¯Ø©...",{type:S,amount:N,commission:v,currentCash:x,walletBalance:_}),I?(_+=N,P=P-N-v):(_-=N,P=P+N-v),b[g]=_,await se.updateUserData(t.uid,{walletBalances:b,cashBalance:P,lastUpdated:new Date().toISOString()}),console.log("âœ… ØªÙ… Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ù„Ù…Ø­ÙØ¸Ø© ÙˆØ¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©",{newCash:P,newWalletBalance:_})}}catch(y){console.warn("âš ï¸ ÙØ´Ù„ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø£Ø±ØµØ¯Ø©:",y)}if(g){const{walletDailyLimitsService:y}=await le(async()=>{const{walletDailyLimitsService:x}=await import("./index-DhbnydJl.js").then(N=>N.cY);return{walletDailyLimitsService:x}},__vite__mapDeps([0,1]),import.meta.url),b=await y.getWalletLimits(g);if(b){const x=r.type==="send",N={updatedAt:(await le(async()=>{const{serverTimestamp:_}=await import("./index-DhbnydJl.js").then(M=>M.cP);return{serverTimestamp:_}},__vite__mapDeps([0,1]),import.meta.url)).serverTimestamp()};x?(N.dailyTransferUsed=Math.max(0,(b.dailyTransferUsed||0)-r.amount),N.monthlyTransferUsed=Math.max(0,(b.monthlyTransferUsed||0)-r.amount)):(N.dailyWithdrawUsed=Math.max(0,(b.dailyWithdrawUsed||0)-r.amount),N.monthlyWithdrawUsed=Math.max(0,(b.monthlyWithdrawUsed||0)-r.amount));const{doc:v,setDoc:S}=await le(async()=>{const{doc:_,setDoc:M}=await import("./index-DhbnydJl.js").then(V=>V.cP);return{doc:_,setDoc:M}},__vite__mapDeps([0,1]),import.meta.url),{db:I}=await le(async()=>{const{db:_}=await import("./index-DhbnydJl.js").then(M=>M.cQ);return{db:_}},__vite__mapDeps([0,1]),import.meta.url),P=v(I,"walletLimits",g);await S(P,N,{merge:!0}),console.log("âœ… ØªÙ… Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©")}}}catch(g){console.warn("ÙØ´Ù„ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù:",g)}try{const{ReportsService:g}=await le(async()=>{const{ReportsService:y}=await import("./index-DhbnydJl.js").then(b=>b.cX);return{ReportsService:y}},__vite__mapDeps([0,1]),import.meta.url);g.removeTransactionEffects(r,t.uid)}catch(g){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù:",g)}w({title:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„ÙŠÙ‡Ø§ ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§Øª"})}catch(m){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† Firebase:",m);let f="ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";m instanceof Error&&(m.message.includes("network")||m.message.includes("offline")?f="Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰":m.message.includes("permission")||m.message.includes("unauthorized")?f="Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©":m.message.includes("not-found")&&(f="Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© Ø£Ùˆ ØªÙ… Ø­Ø°ÙÙ‡Ø§ Ù…Ø³Ø¨Ù‚Ø§Ù‹")),w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù",description:f,variant:"destructive"})}},an=a=>{const r=(a.type||"").toLowerCase(),i=(a.txnType||"").toLowerCase();return r==="withdraw"||r==="withdrawal"||r==="receive"||i==="receive"},sn=a=>{const r=(a.type||"").toLowerCase(),i=(a.txnType||"").toLowerCase();return r==="send"||r==="transfer"||i==="send"},im=a=>a.title==="Ø¥ÙŠØµØ§Ù„ Ø³Ø­Ø¨ ÙÙˆØ±ÙŠ",Fi=a=>{const r=(a.type||"").toLowerCase(),i=(a.txnType||"").toLowerCase(),c=String(a.title||"");return r==="sales"||i==="sales"||c.includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||c.includes("Ù…Ø¨ÙŠØ¹Ø§Øª")},om=(a,r)=>{const i=new Date().toDateString(),c=Array.isArray(rn==null?void 0:rn.data)?rn.data:[],d=new Map;for(const v of ye)v!=null&&v.id&&d.set(String(v.id),v);for(const v of c)v!=null&&v.id&&!d.has(String(v.id))&&d.set(String(v.id),v);let f=Array.from(d.values()).filter(v=>{const S=new Date(v.createdAt).toDateString()===i,I=String(v.status||"").toLowerCase();return S&&(I==="completed"||I==="confirmed"||I==="pending")});va&&va.trim()!==""&&(f=f.filter(v=>v.senderPhone&&v.senderPhone.includes(va)||v.receiverPhone&&v.receiverPhone.includes(va)));const g=vt.filterVisibleTransactions(f,"daily",t==null?void 0:t.uid),y=g.length,b=g.reduce((v,S)=>v+S.amount,0),x=g.filter(v=>an(v)&&!Fi(v)).reduce((v,S)=>{const I=S.withdrawnAmount!==void 0?S.withdrawnAmount:S.amount;return v+I},0),N=g.filter(v=>sn(v)&&!im(v)&&!Fi(v)).reduce((v,S)=>{const I=S.sentAmount!==void 0?S.sentAmount:S.amount;return v+I},0);return{totalTransactions:y,totalAmount:b,totalWithdrawn:x,totalSent:N}},ip=(a,r)=>{const i=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),c=i.format(new Date),[d,m]=c.split("-"),f=Number(d),g=Number(m);let y=a.filter(I=>{var Je;const P=(Je=I.createdAt)!=null&&Je.toDate?I.createdAt.toDate():new Date(I.createdAt),_=String(I.status||"completed").toLowerCase(),M=i.format(P),[V,H]=M.split("-"),Y=Number(V),Ne=Number(H);return Y===f&&Ne===g&&(_==="completed"||_==="confirmed")});va&&va.trim()!==""&&(y=y.filter(I=>I.senderPhone&&I.senderPhone.includes(va)||I.receiverPhone&&I.receiverPhone.includes(va)));const b=vt.filterVisibleTransactions(y,"monthly",t==null?void 0:t.uid),x=b.length,N=b.reduce((I,P)=>I+Number(P.amount||0),0),v=b.filter(I=>an(I)&&!Fi(I)).reduce((I,P)=>{const _=P.withdrawnAmount!==void 0?Number(P.withdrawnAmount):Number(P.amount||0);return I+_},0),S=b.filter(I=>sn(I)&&!im(I)&&!Fi(I)).reduce((I,P)=>{const _=P.sentAmount!==void 0?Number(P.sentAmount):Number(P.amount||0);return I+_},0);return{totalTransactions:x,totalAmount:N,totalWithdrawn:v,totalSent:S}},op=a=>{const r=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),i=r.format(new Date),[c,d]=i.split("-"),m=Number(c),f=Number(d),g=ye.filter(x=>{var M;const N=(M=x.createdAt)!=null&&M.toDate?x.createdAt.toDate():new Date(x.createdAt),v=r.format(N),[S,I]=v.split("-"),P=Number(S),_=Number(I);return P===m&&_===f&&x.status==="completed"&&x.fromWallet===a}),y=g.filter(an).reduce((x,N)=>{const v=N.withdrawnAmount||N.amount;return x+v},0),b=g.filter(sn).reduce((x,N)=>{const v=N.sentAmount||N.amount;return x+v},0);return{totalWithdrawn:y,totalTransferred:b}},lp=a=>{const r=new Date,i=r.getDate(),c=r.getMonth(),d=r.getFullYear(),m=ye.filter(y=>{const b=new Date(y.createdAt);return b.getDate()===i&&b.getMonth()===c&&b.getFullYear()===d&&y.status==="completed"&&y.fromWallet===a}),f=m.filter(an).reduce((y,b)=>{const x=b.withdrawnAmount||b.amount;return y+x},0),g=m.filter(sn).reduce((y,b)=>{const x=b.sentAmount||b.amount;return y+x},0);return{totalWithdrawn:f,totalTransferred:g}},cp=Q.useMemo(()=>{const a=new Date;return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`},[]),Gl=pn({enabled:!!(t!=null&&t.uid),queryKey:["monthRangeTransactions",t==null?void 0:t.uid,cp],queryFn:async()=>{const a=new Date,r=new Date(a.getFullYear(),a.getMonth(),1,0,0,0,0),i=new Date(a.getFullYear(),a.getMonth()+1,0,23,59,59,999);return(await se.getUserTransactionsForDateRange(String((t==null?void 0:t.uid)||""),r,i)).map(d=>{var v;const m=(v=d.createdAt)!=null&&v.toDate?d.createdAt.toDate():new Date(d.createdAt),f=String(d.transactionType||d.txnType||d.type||"").toLowerCase();let g="send";f==="withdraw"||f==="receive"?g="withdraw":f==="machine_withdrawal"?g="machine_withdrawal":f==="cash_addition"||f==="add"?g="cash_addition":g="send";const y=d.status==="confirmed"?"completed":d.status||"completed",b=d.senderMsisdn||d.senderPhone||"",x=d.receiverMsisdn||d.receiverPhone||"",N=Number(d.amount??d.transferredAmount??d.withdrawnAmount??0);return{...d,type:g,status:y,senderPhone:b,receiverPhone:x,amount:N,createdAt:m}})},staleTime:6e4,gcTime:3e5,refetchOnWindowFocus:!1,refetchOnReconnect:!0}),rn=pn({enabled:!!(t!=null&&t.uid),queryKey:["dayRangeTransactions",t==null?void 0:t.uid,(()=>{const a=new Date;return`${a.getFullYear()}-${a.getMonth()+1}-${a.getDate()}`})()],queryFn:async()=>{const a=new Date,r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),i=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999);return(await se.getUserTransactionsForDateRange(String((t==null?void 0:t.uid)||""),r,i)).map(d=>{var v;const m=(v=d.createdAt)!=null&&v.toDate?d.createdAt.toDate():new Date(d.createdAt),f=String(d.transactionType||d.txnType||d.type||"").toLowerCase();let g="send";f==="withdraw"||f==="receive"?g="withdraw":f==="machine_withdrawal"?g="machine_withdrawal":f==="cash_addition"||f==="add"?g="cash_addition":g="send";const y=d.status==="confirmed"?"completed":d.status||"completed",b=d.senderMsisdn||d.senderPhone||"",x=d.receiverMsisdn||d.receiverPhone||"",N=Number(d.amount??d.transferredAmount??d.withdrawnAmount??0);return{...d,type:g,status:y,senderPhone:b,receiverPhone:x,amount:N,createdAt:m}})},staleTime:3e4,gcTime:18e4,refetchOnWindowFocus:!1,refetchOnReconnect:!0}),er=Q.useMemo(()=>{const a=Array.isArray(Gl.data)?Gl.data:[],r=new Map;for(const c of a)c!=null&&c.id&&r.set(String(c.id),c);for(const c of ye)c!=null&&c.id&&r.set(String(c.id),c);const i=Array.from(r.values());return ip(i)},[Gl.data,ye,R,va]),nn=Q.useMemo(()=>om(),[ye,rn.data,R,va,t==null?void 0:t.uid]);er.totalWithdrawn,er.totalSent;const $a=Q.useMemo(()=>op(R),[ye,R]),dp=Q.useMemo(()=>lp(R),[ye,R]),tr=Q.useMemo(()=>{try{return JSON.parse(localStorage.getItem(Vu())||"[]")}catch{return[]}},[t==null?void 0:t.uid]),[up,Xl]=u.useState(!1),[mp,lm]=u.useState(!1),[hp,cm]=u.useState(!1),fp=()=>{const a=new Date,r=a.getFullYear(),i=String(a.getMonth()+1).padStart(2,"0"),c=String(a.getDate()).padStart(2,"0");return`${r}-${i}-${c}`},gp=async()=>{try{if(!(t!=null&&t.uid)){w({title:"ØªØ¹Ø°Ø± Ø§Ù„ØªÙ‚ÙÙŠÙ„",description:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",variant:"destructive"});return}const a=t.uid,r=fp(),i=new Date().toDateString(),d=ye.filter(N=>{const v=new Date(N.createdAt).toDateString()===i,S=String(N.status||"").toLowerCase();return v&&(S==="completed"||S==="confirmed")}).reduce((N,v)=>N+Number(vt.calculateTransactionProfit(v)||0),0);let m=0;try{const N=ie(F,"users",a,"dailySales");(await pe(Ce(N,K("date","==",r)))).forEach(S=>{const I=S.data(),P=Number(I.quantity||1),_=Number(I.sellingPrice||I.price||0);m+=_*P})}catch{}let f=0;try{(await pe(Ce(ie(F,"debts"),K("userId","==",a)))).forEach(v=>{var P,_;const S=v.data(),I=((_=(P=S==null?void 0:S.createdAt)==null?void 0:P.toDate)==null?void 0:_.call(P))||((S==null?void 0:S.createdAt)instanceof Date?S.createdAt:new Date(S==null?void 0:S.createdAt));I&&I.toDateString()===i&&(f+=Number(S.amount||0))})}catch{try{(await pe(ie(F,"users",a,"debts"))).forEach(v=>{var P,_;const S=v.data(),I=((_=(P=S==null?void 0:S.createdAt)==null?void 0:P.toDate)==null?void 0:_.call(P))||((S==null?void 0:S.createdAt)instanceof Date?S.createdAt:new Date(S==null?void 0:S.createdAt));I&&I.toDateString()===i&&(f+=Number(S.amount||0))})}catch{}}let g=0;try{const N=Ce(ie(F,"maintenance_items"),K("userId","==",a));(await pe(N)).forEach(S=>{var H,Y;const I=S.data();if(String(I.status||"").toLowerCase()!=="completed")return;const _=((Y=(H=I==null?void 0:I.completedAt)==null?void 0:H.toDate)==null?void 0:Y.call(H))||((I==null?void 0:I.completedAt)instanceof Date?I.completedAt:new Date((I==null?void 0:I.completedAt)||(I==null?void 0:I.createdAt))),M=_?new Date(_.getFullYear(),_.getMonth(),_.getDate()):null,V=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate());if(M&&M.getTime()===V.getTime()){const Ne=I.profit!==void 0?Number(I.profit||0):Number(I.repairPrice||I.customerPrice||0)-Number(I.wholesalePrice||0);g+=Number.isFinite(Ne)?Ne:0}})}catch{}const y={};ae.forEach(N=>{y[N.id]=Number(De[N.id]||0)});const b=Object.values(y).reduce((N,v)=>N+Number(v||0),0),x=nn;await rr.add({userId:a,reportDate:r,totalTransactions:x.totalTransactions,totalAmount:Math.round(x.totalAmount),totalWithdrawn:Math.round(x.totalWithdrawn),totalSent:Math.round(x.totalSent),profit:Math.round(d),walletId:null,cashBalance:Math.round(Number(qe||0)),walletsTotal:Math.round(b),walletBalances:y,salesToday:Math.round(m),debtsToday:Math.round(f),maintenanceProfitToday:Math.round(g)}),w({title:"ØªÙ… ØªÙ‚ÙÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…",description:`ØªÙ… Ø­ÙØ¸ snapshot Ø¨ØªØ§Ø±ÙŠØ® ${r}`}),Xl(!1)}catch(a){console.error("Daily closing failed",a),w({title:"ÙØ´Ù„ Ø§Ù„ØªÙ‚ÙÙŠÙ„",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸",variant:"destructive"})}};u.useEffect(()=>{try{if(!R||ae.length===0)return;const a=ae.find(S=>S.id===R);if(!a)return;const r=(Se==null?void 0:Se.monthlyWithdrawLimit)??(a==null?void 0:a.monthlyWithdrawalLimit)??2e5,i=(Se==null?void 0:Se.monthlyTransferLimit)??(a==null?void 0:a.monthlyTransferLimit)??2e5,c=parseFloat(jt||"0")||0,d=($a==null?void 0:$a.totalWithdrawn)??(Se==null?void 0:Se.monthlyWithdrawUsed)??0,m=($a==null?void 0:$a.totalTransferred)??(Se==null?void 0:Se.monthlyTransferUsed)??0,f=d+(B==="withdraw"?c:0),g=m+(B==="transfer"?c:0),y=.85,b=Math.floor(Math.max(r,1)*y),x=Math.floor(Math.max(i,1)*y),N=(()=>{const S=new Date;return`${S.getFullYear()}-${String(S.getMonth()+1).padStart(2,"0")}`})(),v=`monthlyLimitWarnShown:${R}:${N}`;if(f>=b){const S=`${v}:withdraw`;if(!(localStorage.getItem(S)==="true")){Ad({type:"withdraw",used:f,limit:r,walletName:a.name}),Id(!0);try{localStorage.setItem(S,"true")}catch{}return}}if(g>=x){const S=`${v}:transfer`;if(!(localStorage.getItem(S)==="true")){Ad({type:"transfer",used:g,limit:i,walletName:a.name}),Id(!0);try{localStorage.setItem(S,"true")}catch{}return}}}catch{}},[R,ae,Se,$a,B,jt]);const dm=async(a,r=!1)=>{var d,m,f,g;if(_n.current)return;if(C&&(D!=null&&D.permissions)){if(B==="transfer"&&D.permissions.transfers===!1){xt(!0);return}if(B==="withdraw"&&D.permissions.withdrawals===!1){xt(!0);return}}const i=B==="withdraw"&&(r||ca||!ct);_n.current=!0,no(!0);const c=()=>{B==="transfer"?Ys(!1):Ur(!1),_n.current=!1,no(!1)};try{if(oN(),console.log("ðŸ”„ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­ÙˆÙŠÙ„/Ø§Ù„Ø³Ø­Ø¨"),console.log("ðŸ“Š Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:",{senderPhone:Gt,receiverPhone:Mt,amount:jt,transactionType:B}),(()=>{B==="transfer"?Ys(!0):Ur(!0)})(),!Gt||!jt){console.log("âŒ Ø®Ø·Ø£: Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©"),w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",description:"ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",variant:"destructive"}),c();return}if(B==="transfer"&&$o&&!Mt&&!l){console.log("âŒ Ø®Ø·Ø£: Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ù…ÙÙ‚ÙˆØ¯"),w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",variant:"destructive"}),c();return}if(B==="transfer"&&$o&&!l){const z=String(Mt||"").replace(/[^0-9Ù -Ù©]/g,"");if(!/[^0-9Ù -Ù©\s]/.test(String(Mt||""))&&!lN(Mt)){w({title:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ØºÙŠØ± ØµØ§Ù„Ø­",description:"Ø§ÙƒØªØ¨ Ø±Ù‚Ù… ØµØ­ÙŠØ­ Ù…ÙƒÙˆÙ† Ù…Ù† 11 Ø±Ù‚Ù… ÙˆÙŠØ¨Ø¯Ø£ Ø¨Ù€ 015 Ø£Ùˆ 010 Ø£Ùˆ 012 Ø£Ùˆ 011",variant:"destructive"}),c();return}}const b=parseFloat(jt);if(console.log("ðŸ’° Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­ÙˆÙ„:",b),b<=0){console.log("âŒ Ø®Ø·Ø£: Ù…Ø¨Ù„Øº ØºÙŠØ± ØµØ­ÙŠØ­"),w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø¨Ù„Øº",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"}),c();return}if(Ee)try{const z=new Date,G=z.getFullYear(),Re=String(z.getMonth()+1).padStart(2,"0"),Xe=String(z.getDate()).padStart(2,"0"),We=`zeroPlanDailyConfirmCount:${(t==null?void 0:t.uid)||"default"}:${G}-${Re}-${Xe}`,rt=localStorage.getItem(We);if((rt&&parseInt(rt,10)||0)>=10){w({title:"Ø­Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ",description:"Ø¨Ø§Ù‚Ø© Ø²ÙŠØ±Ùˆ ØªØ³Ù…Ø­ Ø¨Ù€ 10 ØªØ£ÙƒÙŠØ¯Ø§Øª ØªØ­ÙˆÙŠÙ„/Ø³Ø­Ø¨ ÙŠÙˆÙ…ÙŠØ§Ù‹ ÙÙ‚Ø·.",variant:"destructive"}),c();return}}catch(z){console.warn("ÙØ´Ù„ Ù‚Ø±Ø§Ø¡Ø© Ø¹Ø¯Ø§Ø¯ ØªØ£ÙƒÙŠØ¯Ø§Øª Ø¨Ø§Ù‚Ø© Ø²ÙŠØ±Ùˆ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",z)}const x=ae.find(z=>z.id===R);if(!x){w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© ØµØ­ÙŠØ­Ø©",variant:"destructive"}),c();return}const N=$a;if(console.log("ðŸ“ˆ ÙØ­Øµ Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ù„Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©"),console.log("ðŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ù„Ù„Ù…Ø­ÙØ¸Ø©:",{walletId:R,walletName:x.name,currentWithdrawn:N.totalWithdrawn,currentTransferred:N.totalTransferred,withdrawalLimit:x.monthlyWithdrawalLimit,transferLimit:x.monthlyTransferLimit}),B==="withdraw"){if(console.log("ðŸ§ ÙØ­Øµ Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),console.log(`ðŸ’¸ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨ Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${N.totalWithdrawn}, Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${b}, Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: ${x.monthlyWithdrawalLimit}`),N.totalWithdrawn+b>x.monthlyWithdrawalLimit){console.log("âŒ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),w({title:"ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ",description:`Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø³Ø­Ø¨ Ø£ÙƒØ«Ø± Ù…Ù† ${x.monthlyWithdrawalLimit} Ø¬Ù†ÙŠÙ‡ Ø´Ù‡Ø±ÙŠØ§Ù‹ Ù…Ù† Ù…Ø­ÙØ¸Ø© ${x.name}`,variant:"destructive"}),c();return}}else if(console.log("ðŸ’¸ ÙØ­Øµ Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),console.log(`ðŸ“¤ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${N.totalTransferred}, Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${b}, Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: ${x.monthlyTransferLimit}`),N.totalTransferred+b>x.monthlyTransferLimit){console.log("âŒ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),w({title:"ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø´Ù‡Ø±ÙŠ",description:`Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„ Ø£ÙƒØ«Ø± Ù…Ù† ${x.monthlyTransferLimit} Ø¬Ù†ÙŠÙ‡ Ø´Ù‡Ø±ÙŠØ§Ù‹ Ù…Ù† Ù…Ø­ÙØ¸Ø© ${x.name}`,variant:"destructive"}),c();return}const v=(n==null?void 0:n.shopName)||(t==null?void 0:t.displayName)||"Ù…Ø­Ù„ ÙƒØ§Ø´ÙŠ Ù„ÙŠÙ†Ùƒ",S={id:Date.now().toString(),type:B==="transfer"?"send":B==="deposit"?"deposit":"withdraw",senderPhone:Gt,receiverPhone:B==="transfer"?Mt:Gt,amount:b,status:"completed",createdAt:new Date,withdrawnAmount:B==="withdraw"?b:void 0,sentAmount:B==="transfer"?b:void 0,depositedAmount:void 0,fromWallet:R,senderNumber:Gt,senderName:B==="withdraw"&&Tr.trim()!==""?Tr.trim():void 0,shopName:(x==null?void 0:x.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",transferredAmount:B==="transfer"?b:void 0,receiverNumber:B==="transfer"?Mt:void 0,withdrawnAmountDetailed:B==="withdraw"?b:void 0,depositedAmountDetailed:void 0,merchantShopName:v,transactionReference:`TXN-${Date.now()}`,commission:0,notes:B==="transfer"?void 0:gs&&gs.trim()!==""?gs.trim():void 0};if(B==="transfer"){const z=parseFloat(Pr||"0")||0;z>0&&(S.customerDiscount=Math.round(z*100)/100)}Ar(S.id),C&&(D!=null&&D.name||D!=null&&D.username)&&(S.cashierName=(D==null?void 0:D.name)||(D==null?void 0:D.username));const I=dr.validateTransaction(b,B,qe,De);if(!I.isValid){w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",description:I.error,variant:"destructive"}),c();return}I.warning&&w({title:"ØªØ­Ø°ÙŠØ±",description:I.warning,variant:"destructive"});let P;if(B==="transfer")if((x==null?void 0:x.defaultTransferCommission)!=null){const z=Number(x.defaultTransferCommission)||0;P=Math.round(z*b/1e3*100)/100}else Ot&&Ot.trim()!==""?P=Math.max(0,parseFloat(Ot)):P=0;else if((x==null?void 0:x.defaultWithdrawCommission)!=null){const z=Number(x.defaultWithdrawCommission)||0;P=Math.round(z*b/1e3*100)/100}else yt&&yt.trim()!==""?P=Math.max(0,parseFloat(yt)):P=Math.round(b*.01*100)/100;if(S.commission=P,B!=="transfer"&&!ct&&P>=b){w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©",description:"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø£ÙƒØ¨Ø± Ù…Ù† Ø£Ùˆ ØªØ³Ø§ÙˆÙŠ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯Ø®Ù„",variant:"destructive"}),c();return}const _=B==="transfer"?b:i?Math.round((b-P)*100)/100:b;B==="withdraw"&&Vd(i?`Ø³Ù„Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„: ${_} Ø¬Ù†ÙŠÙ‡`:null),S.amount=i?b:_,S.withdrawnAmount=B==="withdraw"?i?b:_:void 0,S.sentAmount=B==="transfer"?_:void 0,S.transferredAmount=B==="transfer"?_:void 0,S.withdrawnAmountDetailed=B==="withdraw"?i?b:_:void 0;let M;const V=B==="transfer"&&!!kt,H=B==="withdraw"&&!!kt,Y=V||H;let Ne=null;const Je=Mr(Gt||"").replace(/\D/g,""),gt=Mr(Mt||"").replace(/\D/g,""),Pe=B==="transfer"&&(Je.startsWith("010")&&(gt.startsWith("011")||gt.startsWith("012")||gt.startsWith("015"))||Je.startsWith("012")&&gt.startsWith("010")||Je.startsWith("011")&&gt.startsWith("010")||Je.startsWith("015")&&gt.startsWith("010")),fe=Math.max(0,parseFloat(Cd||"0")),st=Math.round(P*100)/100;if(S.commission=st,S.fee=fe,S.totalCharged=B==="transfer"?Number(_)+Number(st)+Number(fe):ct?Number(_)+Number(st):Number(b),B==="transfer"){const z=Number(b)+Number(st)+Number(fe),G=parseFloat(Pr||"0")||0;if(Math.max(0,Math.round(G*100)/100)>z){w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®ØµÙ…",description:"Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ… Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„",variant:"destructive"}),c();return}}if(B==="transfer"&&!Y){const z=Number(De[R]||0),G=Number(_)+Number(fe);if(z<G){w({title:"Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ØºÙŠØ± ÙƒØ§ÙÙ",description:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ ${z} Ù„Ø§ ÙŠÙƒÙÙŠ Ù„Ø®ØµÙ… ${G}`,variant:"destructive"}),c();return}}if(Y)if(V){const z=dr.validateTransaction(_,"transfer",qe,De);if(!z.isValid)M={success:!1,newCashBalance:qe,newWalletBalances:De,message:z.error||"Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙ Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¤Ø¬Ù„",error:"INSUFFICIENT_WALLET_BALANCE"};else{const G=R||((d=ae.find(Ae=>Ae.isDefault))==null?void 0:d.id)||((m=ae[0])==null?void 0:m.id),Re=Se??await Ka.getWalletLimits(G),Xe=new Date().toDateString(),We=ye.filter(Ae=>Ae.type==="send"&&String(Ae.status||"").toLowerCase()==="pending"&&Ae.fromWallet===G&&new Date(Ae.createdAt).toDateString()===Xe).reduce((Ae,Wt)=>Ae+Number(Wt.sentAmount??Wt.transferredAmount??Wt.amount??0),0),rt=Number((Re==null?void 0:Re.dailyTransferLimit)??6e4),St=Number((Re==null?void 0:Re.dailyTransferUsed)??0);if(St+We+Number(_)>rt){w({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„ØªØ­ÙˆÙŠÙ„",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø§Ù„ÙŠÙˆÙ…: ${(rt-St-We).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}const Qe=new Date,Dt=ye.filter(Ae=>Ae.type==="send"&&String(Ae.status||"").toLowerCase()==="pending"&&Ae.fromWallet===G&&new Date(Ae.createdAt).getMonth()===Qe.getMonth()&&new Date(Ae.createdAt).getFullYear()===Qe.getFullYear()).reduce((Ae,Wt)=>Ae+Number(Wt.sentAmount??Wt.transferredAmount??Wt.amount??0),0),Rt=Number((Re==null?void 0:Re.monthlyTransferLimit)??2e5),ja=Number((Re==null?void 0:Re.monthlyTransferUsed)??0);if(ja+Dt+Number(_)>Rt){w({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„ØªØ­ÙˆÙŠÙ„",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±: ${(Rt-ja-Dt).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}M={success:!0,newCashBalance:qe,newWalletBalances:De}}}else{const z=R||((f=ae.find(Ae=>Ae.isDefault))==null?void 0:f.id)||((g=ae[0])==null?void 0:g.id),G=Se??await Ka.getWalletLimits(z),Re=new Date().toDateString(),Xe=ye.filter(Ae=>Ae.type==="withdraw"&&String(Ae.status||"").toLowerCase()==="pending"&&Ae.fromWallet===z&&new Date(Ae.createdAt).toDateString()===Re).reduce((Ae,Wt)=>Ae+Number(Wt.withdrawnAmount??Wt.amount??0),0),We=Number((G==null?void 0:G.dailyWithdrawLimit)??1e5),rt=Number((G==null?void 0:G.dailyWithdrawUsed)??0);if(rt+Xe+Number(_)>We){w({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø³Ø­Ø¨",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø§Ù„ÙŠÙˆÙ…: ${(We-rt-Xe).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}const St=new Date,Qe=ye.filter(Ae=>Ae.type==="withdraw"&&String(Ae.status||"").toLowerCase()==="pending"&&Ae.fromWallet===z&&new Date(Ae.createdAt).getMonth()===St.getMonth()&&new Date(Ae.createdAt).getFullYear()===St.getFullYear()).reduce((Ae,Wt)=>Ae+Number(Wt.withdrawnAmount??Wt.amount??0),0),Dt=Number((G==null?void 0:G.monthlyWithdrawLimit)??2e5),Rt=Number((G==null?void 0:G.monthlyWithdrawUsed)??0);if(Rt+Qe+Number(_)>Dt){w({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ø³Ø­Ø¨",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±: ${(Dt-Rt-Qe).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}M={success:!0,newCashBalance:Math.round((Number(qe)-Number(_))*100)/100,newWalletBalances:De}}else B==="transfer"?M=await dr.processTransfer({amount:_,currentCashBalance:qe,currentWalletBalances:De,wallets:ae,selectedWalletId:R,skipRemoteLimitsCheck:!1,nonBlockingUsageUpdate:!0}):M=await dr.processWithdraw({amount:_,currentCashBalance:qe,currentWalletBalances:De,wallets:ae,selectedWalletId:R,skipRemoteLimitsCheck:!1,nonBlockingUsageUpdate:!0});if(!M.success){w({title:"ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",description:M.error||M.message,variant:"destructive"}),c();return}let Ge=Y?H?M.newCashBalance:qe:M.newCashBalance,mt=Y?De:M.newWalletBalances;if(!Y&&i&&B==="withdraw"){const z=R,G=Number(mt[z]||0);mt={...mt,[z]:Math.round((G+P)*100)/100}}if(!Y&&B==="transfer"&&fe>0){const z=Number(mt[R]||0);mt={...mt,[R]:Math.round((z-Number(fe))*100)/100}}if(Y&&V){const z=ae.find(Xe=>Xe.id===R)??ae.find(Xe=>Xe.isDefault)??ae[0],G=(z==null?void 0:z.id)||R;if(G!==R)try{tn(G)}catch{}const Re=Number(De[G]||0);mt={...De,[G]:Math.round((Re-Number(_)-Number(fe))*100)/100}}if((V||H)&&kt&&!Y0){const z=new Date;let G;if(kt.customerId&&(G=_e.find(We=>We.status==="pending"&&We.customerId&&We.customerId===kt.customerId)),!G&&kt.mobile&&(G=_e.find(We=>We.status==="pending"&&We.mobile&&We.mobile===kt.mobile)),!G){const We=(kt.debtorName||"").trim();G=_e.find(rt=>rt.status==="pending"&&(rt.debtorName||"").trim()===We)}let Re=_e,Xe;if(G){const We=Number(G.amount||0),rt=Number(G.paidAmount||0),St=Number(kt.amount||0),Qe=We+St,Dt=rt>=Qe,Rt={amount:St,note:kt.notes||void 0,addedAt:z},ja={...G,amount:Math.round(Qe),status:Dt?"paid":"pending",additionReceipts:[...G.additionReceipts||[],Rt],lastUpdated:z};Xe=ja,Re=_e.map(Ae=>Ae.id===G.id?ja:Ae),Ne=ja.id,w({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù†ÙØ³ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø£Ø¬Ù„",description:`Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${Qe} Ø¬Ù†ÙŠÙ‡`,variant:"default"})}else{const We={id:`DEBT-${Date.now()}`,debtorName:kt.debtorName,amount:kt.amount,reason:kt.notes||"",customerId:kt.customerId,mobile:kt.mobile,status:"pending",createdAt:z,lastUpdated:z};Xe=We,Ne=We.id,Re=[We,..._e],w({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙŠÙ†",description:"Ø£Ø¶ÙŠÙ Ø¥Ù„Ù‰ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ† Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ù„Ø³Ø¯Ø§Ø¯",variant:"default"})}S.linkedDebtId=Ne,Yt(Re);try{if(await Wa(Re),t!=null&&t.uid){const We=Me(F,"debts",Xe.id),rt={...Xe,userId:t.uid,shopId:k||(n==null?void 0:n.shopId)||null,lastUpdated:z.toISOString()};Object.keys(rt).forEach(St=>rt[St]===void 0&&delete rt[St]),await ra(We,rt,{merge:!0})}}catch(We){console.error("âš ï¸ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¯ÙŠÙ† Ø§Ù„Ù…Ø¤Ø¬Ù„ Ù…Ø­Ù„ÙŠØ§Ù‹ Ø£Ùˆ Ø³Ø­Ø§Ø¨ÙŠØ§Ù‹:",We)}}if(!Y&&!i){const z=Math.max(0,Number(P))+Math.max(0,Number(fe));z>0&&(Ge=Math.round((Ge+z)*100)/100,console.log(`ðŸ’° ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙˆÙ„Ø©/Ø±Ø³ÙˆÙ… ${z} Ø¬Ù†ÙŠÙ‡ Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©`))}if(!Y&&B==="transfer"){const z=parseFloat(Pr||"0")||0,G=Math.max(0,Math.round(z*100)/100);if(G>0){const Re=Ge;Ge=Math.round((Ge-G)*100)/100,console.log(`ðŸ’¸ ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ù‚ÙŠÙ…Ø© ${G} Ø¬Ù†ÙŠÙ‡ Ø¹Ù„Ù‰ Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© (Ù…Ù† ${Re} Ø¥Ù„Ù‰ ${Ge})`)}}console.log("âš¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙÙˆØ±Ø§Ù‹ Ø¨Ø¯ÙˆÙ† Ø­Ø¬Ø¨ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… startTransition...");const oa="temp_"+Date.now()+"_"+Math.random().toString(36).substring(7),Et={reference:oa,shopId:k||(n==null?void 0:n.shopId)||(t==null?void 0:t.uid)||"default-shop",lineId:R||"default-line",walletId:R||void 0,merchantUserId:(t==null?void 0:t.uid)||null,provider:"vodafone_cash",txnType:B==="transfer"?"send":"receive",originType:B==="transfer"?"transfer":"withdraw",amount:i?b:_,commission:st,fee:fe,profit:0,senderMsisdn:Gt,receiverMsisdn:B==="transfer"?Mt:Gt,note:B==="transfer"?void 0:gs&&gs.trim()!==""?gs.trim():void 0,status:Y?"pending":"confirmed",linkedDebtId:Ne||void 0,createdBy:(t==null?void 0:t.uid)||null,walletEffectAppliedOnCreation:!1,cashEffectAppliedOnCreation:!!(Y&&H),limitsReservedOnCreation:!!Y,limitReservedType:B==="transfer"?"transfer":"withdraw",profitAddedOnCreation:!1},He={...Et,id:oa,status:Y?"pending":"completed",commissionMode:B==="transfer"||ct?"add":"deduct",totalCharged:B==="transfer"?_+st+fe:ct?_+P:b,walletEffectAppliedOnCreation:!1,cashEffectAppliedOnCreation:!!(Y&&H),limitsReservedOnCreation:!!Y,limitReservedType:B==="transfer"?"transfer":"withdraw",sentAmount:B==="transfer"?_:void 0,transferredAmount:B==="transfer"?_:void 0,withdrawnAmount:B==="withdraw"?i?b:_:void 0,senderName:B==="withdraw"&&Tr.trim()!==""?Tr.trim():void 0,createdAt:new Date,type:B==="transfer"?"send":"withdraw",senderPhone:Gt||"",receiverPhone:Mt||""};try{Oa.current=[He,...Oa.current],E.setQueryData(["recentTransactions",t==null?void 0:t.uid,k||"main"],z=>!z||!Array.isArray(z)?[He]:[He,...z])}catch(z){console.error("Error in optimistic update:",z)}if(R&&Se)try{const z=B==="transfer",G={...Se};z?(G.dailyTransferUsed=(G.dailyTransferUsed||0)+_,G.monthlyTransferUsed=(G.monthlyTransferUsed||0)+_):(G.dailyWithdrawUsed=(G.dailyWithdrawUsed||0)+_,G.monthlyWithdrawUsed=(G.monthlyWithdrawUsed||0)+_),Zs(G)}catch(z){console.error("Error in optimistic limit update:",z)}const ha=[He,...ye];Q.startTransition(()=>{lt(Ge),ft(mt),Y&&(S.status="pending"),zt(ha),i&&!Y&&w({title:"ØªÙ… Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡",description:`Ø³Ù„Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„: ${_} Ø¬Ù†ÙŠÙ‡`,variant:"default",duration:5e3})});try{setTimeout(()=>{try{localStorage.setItem(Fl(),JSON.stringify(ha))}catch{}},0)}catch{}if(Ee)try{const z=new Date,G=z.getFullYear(),Re=String(z.getMonth()+1).padStart(2,"0"),Xe=String(z.getDate()).padStart(2,"0"),We=`zeroPlanDailyConfirmCount:${(t==null?void 0:t.uid)||"default"}:${G}-${Re}-${Xe}`,rt=localStorage.getItem(We),St=rt&&parseInt(rt,10)||0;localStorage.setItem(We,String(St+1))}catch{}setTimeout(()=>{try{const z=new Date().toISOString();localStorage.setItem(at(),Ge.toString()),localStorage.setItem(at()+"_lastUpdated",z),localStorage.setItem(ot(),JSON.stringify(mt)),localStorage.setItem(ot()+"_lastUpdated",z)}catch{}},0);try{if(t!=null&&t.uid){const z=ae.find(ar=>ar.id===R)??ae.find(ar=>ar.isDefault)??ae[0],G=(z==null?void 0:z.id)||R,Re=Number(mt[G]||0),Xe=String((z==null?void 0:z.phone)||Gt||"").trim(),We=String(Mt||"").trim(),rt=Number(fe)>0,St=B==="transfer"?"ðŸŸ¢":"ðŸ”´",Qe=Number(st)>0?`${Number(st)} Ø¬Ù†ÙŠÙ‡`:"0 Ø¬Ù†ÙŠÙ‡",Dt=rt?` Ùˆ Ø±Ø³ÙˆÙ… ${Number(fe)} Ø¬Ù†ÙŠÙ‡`:"",Rt=B==="transfer"?`${St} ØªÙ… ØªØ­ÙˆÙŠÙ„ Ù…Ø¨Ù„Øº ${Number(_)} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${Xe} Ø¥Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${We} ÙˆØªÙ… Ø£Ø®Ø° Ø¹Ù…ÙˆÙ„Ø© ${Qe}${Dt}. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${Re} Ø¬Ù†ÙŠÙ‡. Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${Number(Ge)} Ø¬Ù†ÙŠÙ‡.`:`${St} ØªÙ… Ø§Ù„Ø³Ø­Ø¨ Ù…Ø¨Ù„Øº ${Number(_)} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø§Ù„Ø¯Ø±Ø¬ Ø¥Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${Xe} ÙˆØªÙ… Ø£Ø®Ø° Ø¹Ù…ÙˆÙ„Ø© ${Qe}${Dt}. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${Re} Ø¬Ù†ÙŠÙ‡. Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${Number(Ge)} Ø¬Ù†ÙŠÙ‡.`,ja=t!=null&&t.uid?`tg_last_msg_${t.uid}`:"tg_last_msg",Ae=Date.now();let Wt=!0;try{const ar=localStorage.getItem(ja);if(ar){const sr=JSON.parse(ar),jp=String((sr==null?void 0:sr.text)||""),Sp=Number((sr==null?void 0:sr.at)||0);jp===Rt&&Ae-Sp<5e3&&(Wt=!1)}}catch{}if(Wt){Promise.resolve(js.send(t.uid,Rt)).catch(()=>{});try{localStorage.setItem(ja,JSON.stringify({text:Rt,at:Ae}))}catch{}}}}catch{}if((async()=>{try{console.log("ðŸ”„ Ø¨Ø¯Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Firebase ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©...");const z={...Et},G={...He},{ProfitService:Re}=await le(async()=>{const{ProfitService:Qe}=await import("./profitService-QTJQLMA0.js");return{ProfitService:Qe}},__vite__mapDeps([45,0,1]),import.meta.url),Xe=Re.calculateProfitFromTransaction({...G,status:"confirmed"});Xe>0&&(Re.addProfit(Xe,t==null?void 0:t.uid),z.profitAddedOnCreation=!0,G.profitAddedOnCreation=!0,console.log("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø¨Ø­:",Xe,"Ø¬Ù†ÙŠÙ‡"));const We=await lx.create(z);if(R)try{const Qe=await Ka.updateUsage(R,_,B==="transfer"?"transfer":"withdraw");Qe&&Zs(Qe);try{window.dispatchEvent(new CustomEvent("walletLimitsUpdated",{detail:{walletId:R}}))}catch{}}catch{}await Promise.all([...t!=null&&t.uid?[se.updateUserData(t.uid,{cashBalance:Ge,walletBalances:mt,lastUpdated:new Date().toISOString()})]:[],...t!=null&&t.uid?[se.saveUserTransaction(t.uid,{...G,transactionId:We,transactionType:B,fromWallet:R,toWallet:B==="transfer"?V?null:"cash":null,cashierName:C&&((D==null?void 0:D.name)||(D==null?void 0:D.username))||"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",linkedDebtId:Ne||void 0,description:`${B==="transfer"?"ØªØ­ÙˆÙŠÙ„":"Ø³Ø­Ø¨"} ${_} Ù…Ù† ${R} ${B==="transfer"?V?"":"Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ":""} â€” Ø¹Ù…ÙˆÙ„Ø©: ${P} (${B==="transfer"||ct?"Ù…Ø¶Ø§ÙØ©":"Ù…Ø®ØµÙˆÙ…Ø©"})${fe>0?` â€” Ø±Ø³ÙˆÙ…: ${fe}`:""}${Y?" â€” Ø¯ÙŠÙ† Ù…Ø¤Ø¬Ù„ (Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©)":""}`})]:[]]),console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­");try{const Qe={...He,id:We};Oa.current=Oa.current.map(Dt=>Dt.id===oa?Qe:Dt),E.setQueryData(["recentTransactions",t==null?void 0:t.uid,k||"main"],Dt=>!Dt||!Array.isArray(Dt)?[Qe]:Dt.map(Rt=>Rt.id===oa?Qe:Rt)),Q.startTransition(()=>{zt(Dt=>Dt.map(Rt=>Rt.id===oa?Qe:Rt))})}catch(Qe){console.error("Error updating query cache with real ID:",Qe)}setTimeout(()=>{try{console.log("ðŸ”„ ØªÙ†ÙÙŠØ° Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ø¬Ù„ (10 Ø«ÙˆØ§Ù†ÙŠ) Ù„Ø¶Ù…Ø§Ù† ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª..."),E.invalidateQueries({queryKey:["recentTransactions",t==null?void 0:t.uid,k||"main"]}),E.invalidateQueries({queryKey:["dashboardData",k||(n==null?void 0:n.shopId)]}),R&&(E.invalidateQueries({queryKey:["walletLimits",R]}),Wi())}catch(Qe){console.error("Error in delayed refresh:",Qe)}},1e4);const rt=`userData_${t==null?void 0:t.uid}`,St={cashBalance:Ge,walletBalances:mt,lastUpdated:new Date().toISOString()};localStorage.setItem(rt,JSON.stringify(St))}catch(z){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Firebase (ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©):",z);try{t!=null&&t.uid&&se.saveLocalReceipt(t.uid,{...transactionDataForUser,transactionType:B,fromWallet:R,toWallet:B==="transfer"?V?null:"cash":null,cashierName:C&&((D==null?void 0:D.name)||(D==null?void 0:D.username))||"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",linkedDebtId:Ne||void 0,description:`${B==="transfer"?"ØªØ­ÙˆÙŠÙ„":"Ø³Ø­Ø¨"} ${_} Ù…Ù† ${R} ${B==="transfer"?V?"":"Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ":""} â€” Ø¹Ù…ÙˆÙ„Ø©: ${P} (${B==="transfer"||ct?"Ù…Ø¶Ø§ÙØ©":"Ù…Ø®ØµÙˆÙ…Ø©"})${fe>0?` â€” Ø±Ø³ÙˆÙ…: ${fe}`:""}${Y?" â€” Ø¯ÙŠÙ† Ù…Ø¤Ø¬Ù„ (Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©)":""}`})}catch{}w({title:"ØªØ­Ø°ÙŠØ±",description:"ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ù„ÙƒÙ† ÙØ´Ù„Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…. Ø³ØªØªÙ… Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.",variant:"destructive"})}})(),B==="transfer"){Ys(!0);const z=Number(b)+Number(P)+Math.max(0,Number(fe)),G=B==="transfer"&&parseFloat(Pr||"0")||0,Re=Math.max(0,Math.round(G*100)/100),Xe=Math.max(0,Math.round((z-Re)*100)/100);el({type:"transfer",amount:Xe}),Ef({receiver:Mt,amount:b}),bo(null),da(!0),setTimeout(()=>{Ys(!1)},2e3)}else Ur(!0),el({type:"withdraw",amount:_,isDeduct:i}),da(!0),setTimeout(()=>{Ur(!1)},2e3);_r(""),$s(""),Wo(""),Yn(!1),Zo(!1),vd(""),wd(""),Oo(null),Po(""),Us(""),jd(""),Sd(!1),setTimeout(()=>{_n.current=!1,no(!1)},1500)}catch(y){console.error("CRITICAL ERROR IN TRANSACTION:",y),w({title:"Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"}),c()}},on=Q.useMemo(()=>new Intl.DateTimeFormat("ar-EG"),[]),um=Q.useMemo(()=>new Intl.DateTimeFormat("ar-EG",{hour:"2-digit",minute:"2-digit"}),[]),mm=Q.useMemo(()=>{try{return _e.reduce((a,r)=>{const i=Number(r.paidAmount||0),c=Math.max(0,Number(r.amount||0)-i);return r.type==="debtor"?a.debtor+=c:a.creditor+=c,a},{creditor:0,debtor:0})}catch{return{creditor:0,debtor:0}}},[_e]),Zl=Q.useMemo(()=>{const a=tm(),r=new Set;return a.filter(c=>!c||!c.id||r.has(c.id)?!1:(r.add(c.id),!0)).filter(c=>Xt==="all"?!0:Xt==="send"?c.type==="send":Xt==="receive"?c.type==="receive":Xt==="withdraw"?c.type==="withdraw":Xt==="deferred"?c.status==="pending":Xt==="wallet"?c.fromWallet===R:Xt!=="deleted")},[tm,Xt,R]),hm=async()=>{try{let a=[];if(Lr==="daily"){const r=new Date,i=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0),c=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999);if(t!=null&&t.uid)try{a=await se.getUserTransactionsForDateRange(t.uid,i,c)}catch{}const d=vt.resetReportsManually("daily",Array.isArray(a)&&a.length?a:ye,t==null?void 0:t.uid);ys(!1),w({title:"ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©",description:`ØªÙ… Ø¥Ø®ÙØ§Ø¡ ${d.length} Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… (Ø§Ù„Ø­Ø¯ÙˆØ¯ Ù„Ù… ØªØªØ£Ø«Ø±)`})}else{const r=new Date,i=new Date(r.getFullYear(),r.getMonth(),1,0,0,0,0),c=new Date(r.getFullYear(),r.getMonth()+1,0,23,59,59,999);if(t!=null&&t.uid)try{a=await se.getUserTransactionsForDateRange(t.uid,i,c)}catch{}const d=vt.resetReportsManually("monthly",Array.isArray(a)&&a.length?a:ye,t==null?void 0:t.uid);Fr(!1),ys(!1),w({title:"ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",description:`ØªÙ… Ø¥Ø®ÙØ§Ø¡ ${d.length} Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± (ÙˆØ§Ù„ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…) (Ø§Ù„Ø­Ø¯ÙˆØ¯ Ù„Ù… ØªØªØ£Ø«Ø±)`})}try{window.dispatchEvent(new CustomEvent("reportsUpdated",{detail:{userId:t==null?void 0:t.uid,type:Lr}}))}catch{}}catch{Fr(!1),ys(!1),w({title:"ÙØ´Ù„ Ø§Ù„ØªØµÙÙŠØ±",description:"ØªØ¹Ø°Ù‘Ø± Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØµÙÙŠØ±",variant:"destructive"})}},pp=()=>{if(Lr==="monthly"){ys(!1),Fr(!0);return}hm()},xp=()=>Lr==="daily"?"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©":"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",yp=()=>Lr==="daily"?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªØµÙÙŠØ± ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¥Ø®ÙØ§Ø¡ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ… Ù…Ù† Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±":"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªØµÙÙŠØ± ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¥Ø®ÙØ§Ø¡ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø± Ù…Ù† Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±",bp=a=>{qu(a),Il(!0)},vp=a=>{const r=qe,i=Number(a)-Number(r);lt(a);const c=new Date().toISOString();localStorage.setItem(at(),a.toString()),localStorage.setItem(at()+"_lastUpdated",c),Iu(!1);const d={cashBalance:a,lastUpdated:c},m=`userData_${t==null?void 0:t.uid}`;try{localStorage.setItem(m,JSON.stringify(d))}catch{}const f=[];if(t!=null&&t.uid){f.push(se.updateUserData(t.uid,d).then(()=>{try{localStorage.removeItem(m)}catch{}}).catch(()=>{}));const g=`${i>0?"CASHADD":"CASHDEDUCT"}-${(t==null?void 0:t.uid)||"anon"}-${Date.now()}`,y=i>0?{txnType:"cash_addition",type:"cash_addition",amount:i,status:"confirmed",senderMsisdn:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",receiverMsisdn:"",reference:g,title:"Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",merchantUserId:t.uid,createdBy:t.uid,shopId:(n==null?void 0:n.shopId)||void 0}:i<0?{amount:Math.abs(i),status:"completed",title:"Ø§ÙŠØµØ§Ù„ Ø®ØµÙ… Ù…Ù† Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠÙ‡",merchantUserId:t.uid,createdBy:t.uid,shopId:(n==null?void 0:n.shopId)||void 0}:null;y&&f.push(se.saveUserTransaction(t.uid,y));const b=n==null?void 0:n.shopId;if(b){const x=Me(F,"dashboardData",b);f.push(ea(x,{cashBalance:a}))}}Promise.allSettled(f).then(()=>{}).catch(()=>{}),w({title:i>0?"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©":i<0?"ØªÙ… Ø®ØµÙ… Ù†Ù‚Ø¯ÙŠØ©":"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ",description:i!==0?`Ø§Ù„ØªØºÙŠÙŠØ±: ${Math.abs(i)} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${a} Ø¬Ù†ÙŠÙ‡`:`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø¥Ù„Ù‰ ${a} Ø¬Ù†ÙŠÙ‡`})},wp=async a=>{var f;if(!Kt){console.warn("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù Ù…Ø­ÙØ¸Ø© Ù…Ø­Ø¯Ø¯ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±ØµÙŠØ¯");return}const r={...De,[Kt]:a};ft(r);const i=new Date().toISOString(),c={walletBalances:r,lastUpdated:i},d=`userData_${t==null?void 0:t.uid}`;try{localStorage.setItem(d,JSON.stringify(c)),localStorage.setItem(ot(),JSON.stringify(r)),localStorage.setItem(ot()+"_lastUpdated",i),localStorage.setItem(`walletBalances_backup_${i}`,JSON.stringify(r))}catch{}try{t!=null&&t.uid&&await se.updateUserData(t.uid,c)}catch(g){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙÙŠ Firebase:",g)}Au(!1);const m=((f=ae.find(g=>g.id===Kt))==null?void 0:f.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©";w({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ ${m} Ø¥Ù„Ù‰ ${a.toLocaleString()} Ø¬Ù†ÙŠÙ‡`})},Np=async a=>{var r;if(console.log("ðŸ’° Ø¨Ø¯Ø¡ ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©"),console.log("ðŸ“Š Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø­Ø±Ø±Ø©:",Kt),console.log("ðŸ’µ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¶Ø§Ù/Ø§Ù„Ù…Ø®ØµÙˆÙ…:",a),Kt){const i=De[Kt]||0;console.log("ðŸ’° Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ:",i);const c=i+a;console.log("ðŸ’° Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯:",c);const d={...De,[Kt]:c};console.log("ðŸ“Š Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø©:",d),ft(d);const m=new Date().toISOString(),f={walletBalances:d,lastUpdated:m},g=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(g,JSON.stringify(f)),localStorage.setItem(ot(),JSON.stringify(d)),localStorage.setItem(`walletBalances_backup_${m}`,JSON.stringify(d));try{if(t!=null&&t.uid){console.log("ðŸ”„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase...");try{await se.updateUserData(t.uid,f),console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­"),setTimeout(()=>{localStorage.removeItem(g),console.log("ðŸ§¹ ØªÙ… Ø­Ø°Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ø§Ù„Ù…Ø¤Ù‚ØªØ© Ø¨Ø¹Ø¯ Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©")},6e4)}catch(N){console.error("âŒ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase:",N),we(!0)}}else console.log("âš ï¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ØŒ Ø­ÙØ¸ ÙÙŠ localStorage"),localStorage.setItem(ot(),JSON.stringify(d));const y=((r=ae.find(N=>N.id===Kt))==null?void 0:r.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©",b=a>0?"Ø¥Ø¶Ø§ÙØ©":"Ø®ØµÙ…",x=Math.abs(a);w({title:`ØªÙ… ${b} Ù…Ø¨Ù„Øº ${b==="Ø¥Ø¶Ø§ÙØ©"?"Ø¥Ù„Ù‰":"Ù…Ù†"} Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©`,description:`ØªÙ… ${b} ${x} Ø¬Ù†ÙŠÙ‡ ${b==="Ø¥Ø¶Ø§ÙØ©"?"Ø¥Ù„Ù‰":"Ù…Ù†"} Ø±ØµÙŠØ¯ ${y}. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${c.toLocaleString()} Ø¬Ù†ÙŠÙ‡`})}catch(y){if(console.error("âŒ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase:",y),localStorage.setItem(ot(),JSON.stringify(d)),t!=null&&t.uid){const b=`userData_${t.uid}`,x={walletBalances:d,lastUpdated:new Date().toISOString()};localStorage.setItem(b,JSON.stringify(x)),we(!0)}w({title:"ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹",description:"ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹ ÙˆØ³ÙŠØªÙ… Ù…Ø²Ø§Ù…Ù†ØªÙ‡Ø§ Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ø§Ø­Ù‚Ø§Ù‹",variant:"default"})}}else console.log("âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù Ù…Ø­ÙØ¸Ø© Ù„Ù„ØªØ­Ø±ÙŠØ±");setTimeout(()=>{const c=Object.keys(localStorage).filter(d=>d.startsWith("walletBalances_backup_")).sort();c.length>5&&c.slice(0,c.length-5).forEach(m=>{localStorage.removeItem(m),console.log("ðŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©:",m)})},5e3),Il(!1),qu("")};return console.log("ðŸ”¥ UserDashboardPage - Render conditions:",{isCheckingActivation:vo,isUserActive:wr,showActivationModal:F0}),vo?(console.log("ðŸ”¥ UserDashboardPage - Showing loading screen"),e.jsx(Hp,{})):(console.log("ðŸ”¥ UserDashboardPage - Rendering main dashboard"),e.jsxs("div",{id:"dashboard-content-container",className:"user-dashboard h-[100dvh] overflow-y-auto px-2 sm:px-4 pt-2 sm:py-4 relative bg-gray-100 bg-[radial-gradient(140%_140%_at_10%_10%,#e5e7eb_0%,#d1d5db_45%,#9ca3af_100%)] no-scrollbar",style:{paddingTop:U?"env(safe-area-inset-top, 0px)":void 0},children:[Js&&e.jsx("div",{className:"fixed inset-0 z-[99999] pointer-events-none bg-orange-300/30 mix-blend-multiply",style:{pointerEvents:"none"}}),e.jsx(EN,{userId:t==null?void 0:t.uid}),e.jsxs("div",{className:"max-w-screen-2xl mx-auto grid grid-cols-1 xl:grid-cols-3 gap-4 xl:gap-6 relative z-10",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-2 sm:gap-3 fade-in-up",children:[!qr&&e.jsxs(rs,{className:"bg-gray-100 dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 relative overflow-hidden",children:[e.jsx(Ss,{className:"pb-2 px-3 pt-3 relative z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ds,{className:"text-sm font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded-md bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700",children:e.jsx(Um,{className:"h-4 w-4 text-gray-700 dark:text-gray-300"})}),e.jsx("span",{className:"text-sm",children:"Ø§Ù„Ø´Ù‡Ø±"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(A,{size:"sm",variant:"ghost",onClick:()=>{Wd("monthly"),ys(!0)},className:"h-8 w-8 p-0 bg-transparent hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 rounded-full transition-colors duration-200",title:"ØªØµÙÙŠØ± Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø±",children:e.jsx(Sa,{className:"h-3.5 w-3.5"})}),e.jsx(A,{size:"sm",variant:"ghost",onClick:()=>Yo(!0),className:"h-8 w-8 p-0 bg-transparent hover:bg-purple-50 dark:hover:bg-purple-900/20 text-purple-600 hover:text-purple-700 dark:text-purple-400 dark:hover:text-purple-300 rounded-full transition-colors duration-200",title:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± ÙŠÙˆÙ…/Ø´Ù‡Ø± Ù…Ø­Ø¯Ø¯",children:e.jsx(Ji,{className:"h-3.5 w-3.5"})}),e.jsx(A,{size:"sm",variant:"ghost",onClick:()=>Yo(!0),className:"h-8 w-8 p-0 bg-transparent hover:bg-blue-50 dark:hover:bg-blue-900/20 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 rounded-full transition-colors duration-200",title:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",children:e.jsx(Bi,{className:"h-3.5 w-3.5"})}),e.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900/20 rounded-full border border-green-100 dark:border-green-900/30",children:e.jsx(dn,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})})]})]})}),!qr&&e.jsxs(ns,{className:"pt-0 px-2 pb-2",children:[e.jsxs("div",{className:`grid grid-cols-2 gap-0 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-800 divide-x divide-y divide-gray-200 dark:divide-gray-800 bg-white dark:bg-gray-900 ${Gd?"blur-sm select-none":""}`,children:[e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-blue-600 dark:text-blue-400",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-blue-800 dark:text-blue-300 mt-0.5 sm:mt-0",children:er.totalTransactions})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø§Ø¬Ù…Ø§Ù„ÙŠ"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-gray-900 dark:text-gray-100 mt-0.5 sm:mt-0",children:er.totalAmount.toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-green-600 dark:text-green-400",children:"Ø§Ù„Ù…Ø³ØªÙ„Ù…"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-green-800 dark:text-green-300 mt-0.5 sm:mt-0",children:er.totalWithdrawn.toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-red-600 dark:text-red-400",children:"Ø§Ù„Ù…Ø±Ø³Ù„"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-red-800 dark:text-red-300 mt-0.5 sm:mt-0",children:er.totalSent.toLocaleString("en-US",{maximumFractionDigits:0})})]})]}),e.jsxs("div",{className:"mt-2 rounded-lg border border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900 px-2 py-1.5 flex items-center justify-between",children:[e.jsx("span",{className:"text-[12px] font-bold text-yellow-600 dark:text-yellow-400",children:"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),e.jsx(Vw,{userId:t==null?void 0:t.uid,transactions:ye})]})]}),Gd&&e.jsx("div",{className:"absolute inset-0 z-20 backdrop-blur-sm bg-white/60 dark:bg-black/60 flex items-center justify-center p-0 pointer-events-auto",children:e.jsxs(A,{size:"sm",variant:"ghost",onClick:async()=>{if(Ee){w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}ni(!0)},className:"px-4 py-2 rounded-full bg-white dark:bg-card border border-gray-100 dark:border-gray-800 text-gray-900 dark:text-gray-100 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-800 hover:shadow-md transition-all duration-200 flex items-center gap-2 text-xs font-medium",title:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± (ÙŠØªØ·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ)",children:[e.jsx("span",{children:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±"}),e.jsx(mr,{className:"h-3.5 w-3.5 text-gray-600 dark:text-gray-400"})]})})]}),e.jsx(ta,{open:Hf,onOpenChange:ni,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±",description:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø± Ø¥Ù„Ø§ Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",onSuccess:()=>{if(Ee){w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}),ni(!1),ri(!0);return}ri(!1),ni(!1)},userId:t==null?void 0:t.uid,userRole:n==null?void 0:n.role}),e.jsx(ue,{open:up,onOpenChange:Xl,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsxs(be,{children:[e.jsx(he,{children:"ØªÙ‚ÙÙŠÙ„ ÙŠÙˆÙ…ÙŠÙ‘Ø©"}),e.jsx(Ze,{children:"ÙŠØ­ÙØ¸ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ØŒ Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ø¯Ø±Ø¬ØŒ Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…ØŒ Ø¯ÙŠÙˆÙ† Ø§Ù„ÙŠÙˆÙ…ØŒ ÙˆØ£Ø±Ø¨Ø§Ø­ Ø§Ù„ØµÙŠØ§Ù†Ø© Ù…Ø¹ ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„."})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(A,{variant:"ghost",className:"text-blue-700 hover:text-blue-800",onClick:()=>cm(!0),children:"Ø§ÙŠØµØ§Ù„Ø§Øª Ø§Ù„ØªÙ‚ÙÙŠÙ„"}),e.jsx(A,{variant:"outline",onClick:()=>Xl(!1),children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{variant:"default",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>lm(!0),children:"ØªÙ‚ÙÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…"})]})]})}),e.jsx(ta,{open:mp,onOpenChange:lm,mode:"verify",title:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªÙ‚ÙÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…",onSuccess:gp,userId:t==null?void 0:t.uid,userRole:n==null?void 0:n.role}),e.jsx(TN,{open:hp,onOpenChange:cm,userId:t==null?void 0:t.uid}),(Bt==null?void 0:Bt.planType)!==aa.TAHWEELA&&e.jsxs(rs,{className:"bg-gray-50 dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 relative overflow-hidden",children:[e.jsx(Ss,{className:"pb-2 px-3 pt-3 relative z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ds,{className:"text-sm font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded-md bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700",children:e.jsx(Um,{className:"h-4 w-4 text-gray-700 dark:text-gray-300"})}),e.jsx("span",{className:"text-sm",children:"Ø§Ù„ÙŠÙˆÙ…"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(A,{size:"sm",variant:"ghost",onClick:()=>{Wd("daily"),ys(!0)},className:"h-8 w-8 p-0 bg-transparent hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 rounded-full transition-colors duration-200",title:"ØªØµÙÙŠØ± Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…",children:e.jsx(Sa,{className:"h-3.5 w-3.5"})}),e.jsx(A,{size:"sm",variant:"ghost",onClick:()=>Le("https://www.youtube.com/watch?v=MjAFbvhgjYg","Ø´Ø±Ø­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…"),className:"h-8 w-8 p-0 bg-transparent hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 rounded-full transition-colors duration-200",title:"Ø´Ø±Ø­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…",children:e.jsx(Jx,{className:"h-4 w-4"})}),e.jsx(A,{size:"sm",variant:"ghost",onClick:()=>Jf(a=>!a),className:"h-8 w-8 p-0 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 rounded-full transition-colors duration-200",title:qr?"ØªÙˆØ³ÙŠØ¹ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø´Ù‡Ø±":"Ø·ÙŠ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø´Ù‡Ø±",children:qr?e.jsx(wx,{className:"h-3.5 w-3.5"}):e.jsx(Nx,{className:"h-3.5 w-3.5"})}),e.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900/20 rounded-full border border-green-100 dark:border-green-900/30",children:e.jsx(dn,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})})]})]})}),!qr&&e.jsxs(ns,{className:"pt-0 px-2 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-0 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-800 divide-x divide-y divide-gray-200 dark:divide-gray-800 bg-white dark:bg-gray-900",children:[e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-blue-600 dark:text-blue-400",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-blue-800 dark:text-blue-300 mt-0.5 sm:mt-0",children:nn.totalTransactions})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø§Ø¬Ù…Ø§Ù„ÙŠ"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-gray-900 dark:text-gray-100 mt-0.5 sm:mt-0",children:nn.totalAmount.toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-green-600 dark:text-green-400",children:"Ø§Ù„Ù…Ø³ØªÙ„Ù…"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-green-800 dark:text-green-300 mt-0.5 sm:mt-0",children:nn.totalWithdrawn.toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-red-600 dark:text-red-400",children:"Ø§Ù„Ù…Ø±Ø³Ù„"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-red-800 dark:text-red-300 mt-0.5 sm:mt-0",children:nn.totalSent.toLocaleString("en-US",{maximumFractionDigits:0})})]})]}),e.jsxs("div",{className:"mt-2 rounded-lg border border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900 px-2 py-1.5 flex items-center justify-between",children:[e.jsx("span",{className:"text-[12px] font-bold text-yellow-600 dark:text-yellow-400",children:"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),e.jsx(Yw,{userId:t==null?void 0:t.uid,transactions:ye})]})]}),eg&&e.jsx("div",{className:"absolute inset-0 z-20 backdrop-blur-sm bg-white/60 dark:bg-black/60 flex items-center justify-center p-0 pointer-events-auto",children:e.jsxs(A,{size:"sm",variant:"ghost",onClick:()=>rl(!0),className:"px-4 py-2 rounded-full bg-white dark:bg-card border border-gray-100 dark:border-gray-800 text-gray-900 dark:text-gray-100 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-800 hover:shadow-md transition-all duration-200 flex items-center gap-2 text-xs font-medium",title:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… (ÙŠØªØ·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ)",children:[e.jsx("span",{children:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…"}),e.jsx(mr,{className:"h-3.5 w-3.5 text-gray-600 dark:text-gray-400"})]})})]}),e.jsx(ta,{open:tg,onOpenChange:rl,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…",description:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… Ø¥Ù„Ø§ Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",onSuccess:()=>{tu(!1),rl(!1)},userId:t==null?void 0:t.uid})]}),e.jsxs(rs,{className:"balance-bar bg-gray-200 border-2 border-gray-200/50 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 group relative overflow-hidden   transform fade-in-up mb-6",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-500/5 via-blue-500/5 to-emerald-500/5 opacity-0 group-hover:opacity-100 transition-opacity duration-200"}),e.jsx("div",{className:"absolute top-0 left-0 w-40 h-40 bg-gradient-to-br from-emerald-300/10 to-transparent rounded-full -translate-y-20 -translate-x-20 group-hover:scale-150 transition-transform duration-200"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-40 h-40 bg-gradient-to-br from-blue-300/10 to-transparent rounded-full translate-y-20 translate-x-20 group-hover:scale-150 transition-transform duration-200"}),e.jsx(ns,{className:"p-2 relative z-10",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[e.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-gray-800 p-1 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 group/cash relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/10 to-transparent opacity-0 group-hover/cash:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"flex flex-col relative z-10 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx("div",{className:"p-0.5 bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/30 dark:to-emerald-800/30 rounded-lg shadow-sm",children:e.jsx(Da,{className:"h-1.5 w-1.5 text-emerald-600 dark:text-emerald-400"})}),e.jsx("span",{className:"text-[11px] font-extrabold text-emerald-800 dark:text-emerald-300",children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",onClick:()=>Gr(!0),children:e.jsx(Lt,{className:"h-4 w-4"})}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-emerald-600 dark:text-emerald-400 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 transition-colors",onClick:()=>Yu(!0),title:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©",children:e.jsx(Om,{className:"h-4 w-4"})}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",onClick:()=>Oi(!0),children:e.jsx(Sa,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-0.5 flex items-center justify-between gap-1",children:e.jsxs("span",{className:"text-[14px] sm:text-xl font-bold text-emerald-800 dark:text-emerald-200 bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/30 dark:to-emerald-800/30 px-1 py-0.5 rounded-lg shadow-sm block w-fit",children:[qe.toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-gray-800 p-1 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 group/wallet relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/10 to-transparent opacity-0 group-hover/wallet:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"flex flex-col relative z-10 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx("div",{className:"p-0.5 bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/30 dark:to-blue-800/30 rounded-lg shadow-sm",children:e.jsx(nr,{className:"h-1.5 w-1.5 text-blue-600 dark:text-blue-400"})}),e.jsx("span",{className:"text-[11px] font-extrabold text-blue-800 dark:text-blue-300",children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",onClick:()=>Ai(!0),title:"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„ Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©",children:e.jsx(Lt,{className:"h-4 w-4"})}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",onClick:()=>Jo(!0),title:"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø§ÙØ¸",children:e.jsx(nr,{className:"h-4 w-4"})}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",onClick:()=>{Pi(!0),Mi("")},title:"ØªØµÙÙŠØ± Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©",children:e.jsx(Sa,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-0.5",children:e.jsxs("span",{className:"text-[14px] sm:text-xl font-bold text-blue-800 dark:text-blue-200 bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/30 dark:to-blue-800/30 px-1 py-0.5 rounded-lg shadow-sm block w-fit",children:[ae.reduce((a,r)=>a+(Number(De[r.id])||0),0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})})]})]}),e.jsxs("div",{className:"col-span-2 sm:col-span-1 bg-white dark:bg-card border border-gray-200 dark:border-gray-800 p-1 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 group/selwallet relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-transparent opacity-0 group-hover/selwallet:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"flex flex-col relative z-10 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx("div",{className:"p-0.5 bg-gradient-to-r from-indigo-100 to-indigo-200 dark:from-indigo-900/30 dark:to-indigo-800/30 rounded-lg shadow-sm",children:e.jsx(nr,{className:"h-1.5 w-1.5 text-indigo-600 dark:text-indigo-400"})}),e.jsx("span",{className:"text-[11px] font-extrabold text-indigo-800 dark:text-indigo-300",children:"Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ù‡"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",onClick:()=>{if(!R){w({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}bp(R)},title:"Ø¥Ø¶Ø§ÙØ©/Ø®ØµÙ… Ø¥Ù„Ù‰ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",children:e.jsx(Lt,{className:"h-4 w-4"})}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",onClick:()=>{if(!R){w({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„ØªØµÙÙŠØ± Ø±ØµÙŠØ¯Ù‡Ø§ ÙÙ‚Ø·",variant:"destructive"});return}pi(!0)},title:"ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",children:e.jsx(Sa,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-0.5",children:e.jsxs("span",{className:"text-[14px] sm:text-xl font-bold text-indigo-800 dark:text-indigo-200 bg-gradient-to-r from-indigo-100 to-indigo-200 dark:from-indigo-900/30 dark:to-indigo-800/30 px-1 py-0.5 rounded-lg shadow-sm block w-fit",children:[(R&&De[R]||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})})]})]})]})})]}),e.jsxs(rs,{className:"bg-gray-100 dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 group relative overflow-hidden fade-in-up",children:[e.jsxs(Ss,{className:`pb-2 px-4 pt-4 relative z-10 ${O?"sticky top-0 z-20 bg-white/90 dark:bg-card/90 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-card/60":""}`,children:[e.jsxs("div",{className:`flex items-center ${O?"justify-between":"justify-end"}`,children:[O&&e.jsx(Ds,{className:"text-sm font-bold flex items-center gap-2 text-gray-900 dark:text-gray-100",children:e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©"})}),e.jsx("div",{className:"flex items-center gap-2",children:!O&&e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-green-600 mb-1 whitespace-nowrap",children:"Ø³Ø­Ø¨ ATM"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-green-100 text-green-600 hover:bg-green-200 border border-green-200 ring-3 ring-green-300 transition-all duration-200 hover:scale-105 active:bg-green-600 active:text-white active:border-green-600",onClick:()=>J(!0),title:"Ø³Ø­Ø¨ ATM",children:e.jsx(Qp,{className:"h-5 w-5 text-green-600"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx("span",{className:"text-[10px] font-semibold text-orange-600 whitespace-nowrap",children:"Ù…Ø¹Ù„Ù‚Ø©"}),Fe>0&&e.jsx("span",{className:"h-4 w-4 rounded-full bg-orange-600 text-white text-[10px] flex items-center justify-center ring-2 ring-white",children:Fe})]}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-orange-100 text-orange-600 hover:bg-orange-200 border border-orange-200 ring-3 ring-orange-300 transition-all duration-200 hover:scale-105 active:bg-orange-600 active:text-white active:border-orange-600",onClick:()=>te(!0),title:"Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ø¹Ù„Ù‚Ø©",children:e.jsx(tc,{className:"h-5 w-5 text-orange-600"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"Ø®Ø·ÙˆØ·"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>ke("lines",()=>{Ts?_s(!0):it()}),title:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø·ÙˆØ·",children:e.jsx(Gp,{className:"h-5 w-5 text-purple-600"})})]}),!Zt.includes("installment")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"ØªÙ‚Ø³ÙŠØ·"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>ke("installments",()=>{if(Ee||Ve){w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ· ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"});return}Vr(!0)}),title:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ·",children:e.jsx(Xp,{className:"h-5 w-5 text-purple-600"})})]}),!Zt.includes("store")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-blue-600 mb-1",children:"Ù…ØªØ¬Ø±Ùƒ"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 border border-blue-200 ring-3 ring-blue-300 transition-all duration-200 hover:scale-105 active:bg-blue-600 active:text-white active:border-blue-600",onClick:()=>An(!0),title:"Ù…ØªØ¬Ø±Ùƒ",children:e.jsx(un,{className:"h-5 w-5 text-blue-600"})})]}),!Zt.includes("calculator")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"Ø­Ø§Ø³Ø¨Ø©"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>Jd(!0),title:"Ø¢Ù„Ø© Ø­Ø§Ø³Ø¨Ø©",children:e.jsx(hx,{className:"h-5 w-5 text-purple-600"})})]}),!Zt.includes("credit-cards")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"ÙƒØ±ÙˆØª"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>ke("cards",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):ti(!0)}),title:"ÙƒØ±ÙˆØª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†",children:e.jsx(Zp,{className:"h-5 w-5 text-purple-600"})})]}),e.jsxs("div",{className:"hidden flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-blue-600 mb-1",children:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 border border-blue-200 ring-3 ring-blue-300 transition-all duration-200 hover:scale-105 active:bg-blue-600 active:text-white active:border-blue-600",onClick:()=>{if(Ee||Ve){w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"});return}Ru(!0)},title:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",children:e.jsx(Vm,{className:"h-5 w-5 text-blue-600"})})]}),!Zt.includes("telegram")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-sky-600 mb-1",children:"ØªÙ„Ø¬Ø±Ø§Ù…"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-sky-100 text-sky-600 hover:bg-sky-200 border border-sky-200 ring-3 ring-sky-300 transition-all duration-200 hover:scale-105 active:bg-sky-600 active:text-white active:border-sky-600",onClick:()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Jt.hasMasterPin()?Jl(!0):am()},title:"Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",children:e.jsx(ex,{className:"h-5 w-5 text-sky-600"})})]}),!Zt.includes("cashier-shift")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-blue-600 mb-1",children:"Ø§Ù„ÙˆØ±Ø¯ÙŠØ©"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 border border-blue-200 ring-3 ring-blue-300 transition-all duration-200 hover:scale-105 active:bg-blue-600 active:text-white active:border-blue-600",onClick:Bg,title:C&&(D!=null&&D.name||D!=null&&D.username)?`Ø¨Ø±ÙˆÙÙŠÙ„ Ø§Ù„ÙˆØ±Ø¯ÙŠØ©: ${(D==null?void 0:D.name)||(D==null?void 0:D.username)}`:"ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ÙƒØ§Ø´ÙŠØ±",children:e.jsx(mn,{className:"h-5 w-5 text-blue-600"})})]}),!Zt.includes("sales")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>ke("sales",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Wr(!0)}),title:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª",children:e.jsx(ic,{className:"h-5 w-5 text-purple-600"})})]}),!Zt.includes("debts")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600",children:"Ø§Ù„Ø¯ÙŠÙˆÙ†"}),_e.filter(a=>a.status==="pending").length>0&&e.jsx("span",{className:"h-4 w-4 rounded-full bg-red-600 text-white text-[10px] flex items-center justify-center ring-2 ring-white",children:_e.filter(a=>a.status==="pending").length})]}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>ke("debts",()=>{dl()}),title:"Ø§Ù„Ø¯ÙŠÙˆÙ†",children:e.jsx(Bi,{className:"h-5 w-5 text-purple-600"})})]}),!Zt.includes("maintenance")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-amber-700 mb-1",children:"Ø§Ù„ØµÙŠØ§Ù†Ø©"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-amber-100 text-amber-700 hover:bg-amber-200 border border-amber-200 ring-3 ring-amber-300 transition-all duration-200 hover:scale-105 active:bg-amber-600 active:text-white active:border-amber-600",onClick:()=>ke("maintenance",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):ai(!0)}),title:"Ø§Ù„ØµÙŠØ§Ù†Ø©",children:e.jsx(_m,{className:"h-5 w-5 text-amber-700"})})]}),!Zt.includes("machine")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-yellow-500 mb-1",children:"Ø§Ù„Ù…ÙƒÙ†Ø©"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-violet-100 text-violet-700 hover:bg-violet-200 border border-violet-200 ring-3 ring-violet-300 transition-all duration-200 hover:scale-105 active:bg-violet-700 active:text-white active:border-violet-700",onClick:()=>ke("machines",()=>{!ma||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):si(!0)}),title:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø©",children:e.jsx(tx,{className:"h-5 w-5 text-yellow-500"})})]}),!Zt.includes("shop-expenses")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-orange-600 mb-1",children:"Ù…ØµØ±ÙˆÙØ§Øª"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-orange-100 text-orange-600 hover:bg-orange-200 border border-orange-200 ring-3 ring-orange-300 transition-all duration-200 hover:scale-105 active:bg-orange-600 active:text-white active:border-orange-600",onClick:()=>ke("expenses",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):id&&Jt.hasMasterPin()?jr(!0):Es(!0)}),title:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„",children:e.jsx(hn,{className:"h-5 w-5 text-orange-600"})})]}),!Zt.includes("deficiencies")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-rose-600 mb-1",children:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-rose-100 text-rose-600 hover:bg-rose-200 border border-rose-200 ring-3 ring-rose-300 transition-all duration-200 hover:scale-105 active:bg-rose-600 active:text-white active:border-rose-600",onClick:()=>ke("deficiencies",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Dr(!0)}),title:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ",children:e.jsx(ac,{className:"h-5 w-5 text-rose-600"})})]}),!Zt.includes("my-client-numbers")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-emerald-600 mb-1",children:"Ø£Ø±Ù‚Ø§Ù…ÙŠ"}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-emerald-100 text-emerald-700 hover:bg-emerald-200 border border-emerald-200 ring-3 ring-emerald-300 transition-all duration-200 hover:scale-105 active:bg-emerald-600 active:text-white active:border-emerald-600",onClick:()=>ke("myNumbers",()=>{Ee||Ve?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):$n(!0)}),title:"Ø£Ø±Ù‚Ø§Ù…ÙŠ",children:e.jsx(Ui,{className:"h-5 w-5 text-emerald-700"})})]})]})})]}),!O&&e.jsx("div",{className:"mt-2 w-full",children:e.jsxs("div",{className:"filters-bar flex items-center justify-center gap-3 bg-gray-100 rounded-md p-3 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:e.jsx(dn,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5 text-gray-700 dark:text-gray-300"})}),e.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-gray-100",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©"})]}),e.jsxs("div",{className:"relative flex items-center h-9 w-[200px] md:w-[240px] bg-white dark:bg-gray-900 rounded-full border border-gray-200 dark:border-gray-700 hover:border-blue-400 dark:hover:border-blue-500 focus-within:border-blue-500 focus-within:ring-4 focus-within:ring-blue-50 dark:focus-within:ring-blue-900/30 transition-all duration-300 shadow-sm hover:shadow-md group",children:[e.jsx(Wm,{className:"absolute right-3 h-4 w-4 text-gray-400 group-hover:text-blue-500 transition-colors pointer-events-none"}),e.jsx(X,{placeholder:"Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ...",value:Qo,onChange:a=>Fd(a.target.value),className:"h-full w-full pr-10 pl-8 py-0 text-xs font-medium border-0 bg-transparent focus:ring-0 focus-visible:ring-0 shadow-none placeholder:text-gray-400 text-gray-700 dark:text-gray-200 rounded-full"}),Qo&&e.jsx("button",{onClick:()=>Fd(""),className:"absolute left-2 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-400 hover:text-red-500 transition-colors",title:"Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø«",children:e.jsx(Vi,{className:"h-3.5 w-3.5"})})]}),e.jsx(A,{variant:"ghost",size:"sm",className:`btn-filter-send h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Xt==="send"?"bg-green-600 text-white border-green-600":"text-green-700 border-green-300 hover:bg-green-100"}`,onClick:()=>Or("send"),title:"ØªØµÙÙŠØ© Ø§Ù„ØªØ­ÙˆÙŠÙ„",children:"Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),e.jsx(A,{variant:"ghost",size:"sm",className:`btn-filter-withdraw h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Xt==="withdraw"?"bg-red-600 text-white border-red-600":"text-red-700 border-red-300 hover:bg-red-100"}`,onClick:()=>Or("withdraw"),title:"ØªØµÙÙŠØ© Ø§Ù„Ø³Ø­Ø¨",children:"Ø§Ù„Ø³Ø­Ø¨"}),e.jsx(A,{variant:"ghost",size:"sm",className:`btn-filter-deferred h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Xt==="deferred"?"bg-yellow-600 text-white border-yellow-600":"text-yellow-700 border-yellow-300 hover:bg-yellow-100"}`,onClick:()=>Or("deferred"),title:"ØªØµÙÙŠØ© Ø§Ù„Ù…Ø¤Ø¬Ù„",children:"Ù…Ø¤Ø¬Ù„"}),e.jsx(A,{variant:"ghost",size:"sm",className:`btn-filter-wallet h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Xt==="wallet"?"bg-blue-600 text-white border-blue-600":"text-blue-700 border-blue-300 hover:bg-blue-100"}`,onClick:()=>{R?Or("wallet"):w({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÙ‡Ø§",variant:"destructive"})},title:"Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­ÙØ¸Ù‡ Ø§Ù„Ù…Ø®ØªØ§Ø±Ù‡ ÙÙ‚Ø·",children:"Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­ÙØ¸Ù‡"}),e.jsx(A,{variant:"ghost",size:"sm",className:`btn-filter-all h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Xt==="all"?"bg-green-600 text-white border-green-600":"text-green-700 border-green-300 hover:bg-green-100"}`,onClick:()=>Or("all"),title:"Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„",children:"Ø§Ù„ÙƒÙ„"})]})})]}),e.jsx(ta,{open:Bf,onOpenChange:Vr,mode:"verify",title:"ÙØªØ­ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ·",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ·",onSuccess:()=>{Vr(!1),Hd(!0)}}),e.jsx(jN,{open:Uf,onOpenChange:Hd}),e.jsx(ta,{open:Cn,onOpenChange:_s,mode:"verify",title:"ÙØªØ­ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø·ÙˆØ·",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø·ÙˆØ·",onSuccess:()=>{_s(!1),it()}}),e.jsx(SN,{isOpen:Vf,onClose:()=>ei(!1),shopId:k,onOpenAdsl:()=>{ei(!1),Qd(!0)}}),e.jsx(Em,{isOpen:Ta,onClose:()=>ia(!1),userId:(t==null?void 0:t.uid)||"",userEmail:(t==null?void 0:t.email)||""}),e.jsx(DN,{isOpen:qf,onClose:()=>Qd(!1),shopId:k}),e.jsx(ta,{open:ap,onOpenChange:Jl,mode:"verify",title:"Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",onSuccess:()=>{Jl(!1),am()},userId:t==null?void 0:t.uid,userRole:n==null?void 0:n.role}),e.jsxs(ns,{className:"space-y-2 pt-0 px-4 pb-4 relative z-10",children:[Zl.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(dn,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†"})]}):O?e.jsx("div",{className:"overflow-y-auto overscroll-contain scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400 transition-colors max-h-[310px]",children:e.jsx("div",{className:"space-y-2 pr-2",children:Zl.map(a=>e.jsxs("div",{className:"relative flex items-center gap-4 p-4 rounded-xl bg-gray-50 border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>nm(a),children:[e.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center shrink-0 ${a.type==="withdraw"?"bg-red-100":"bg-green-100"}`,children:(()=>{const r=a,i=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª";return i?e.jsx(hn,{className:"h-5 w-5 text-gray-600"}):c?e.jsx(Lt,{className:"h-5 w-5 text-green-600"}):d?e.jsx(hn,{className:"h-5 w-5 text-green-600"}):a.type==="withdraw"?e.jsx(cr,{className:"h-5 w-5 text-red-600"}):e.jsx(Rm,{className:"h-5 w-5 text-green-600"})})()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"text-base font-bold truncate",children:(()=>{const r=a,i=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",m=String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((r==null?void 0:r.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡");return i?e.jsx("span",{className:"text-foreground",children:"ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"}):m?e.jsx("span",{className:"text-foreground",children:"Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡"}):c?e.jsx("span",{className:"text-foreground",children:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"}):d?e.jsx("span",{className:"text-foreground",children:"Ù…Ø¨ÙŠØ¹Ø§Øª"}):a.type==="atm_withdraw"?e.jsx("span",{className:"text-green-600",children:"Ø³Ø­Ø¨ atm"}):a.type==="send"?e.jsx("span",{className:"text-green-600",children:"ØªØ­ÙˆÙŠÙ„ Ø£Ù…ÙˆØ§Ù„"}):e.jsx("span",{className:"text-red-600",children:"Ø³Ø­Ø¨ Ù†Ù‚Ø¯ÙŠ"})})()}),e.jsxs("span",{className:`text-base font-bold whitespace-nowrap ${a.type==="withdraw"?"text-red-600":"text-green-600"}`,children:[a.type==="withdraw"||a.type==="cash_addition"||a.txnType==="cash_addition"||a.type==="sales"||a.txnType==="sales"?"+":"-"," ",ks(a.amount)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:(()=>{const r=a,i=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",m=String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((r==null?void 0:r.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡"),f=(r==null?void 0:r.note)||(r==null?void 0:r.notes)||"";if(i)return`Ø¥Ù„Ù‰: ${a.receiverPhone}`;if(c)return f||"Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠØ©";if(d){const g=((r==null?void 0:r.saleProductName)||"").trim(),y=((r==null?void 0:r.saleQuantity)??"").toString();return g&&y?`${g} Ã— ${y}`:g||"Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹"}return m?`Ù…Ù†: ${r.senderName||"Ù…Ø§ÙƒÙŠÙ†Ø©"}`:a.type==="send"?e.jsx("span",{dir:"ltr",children:a.receiverPhone}):e.jsx("span",{dir:"ltr",children:a.senderPhone})})()}),e.jsxs("p",{className:"text-sm font-medium text-gray-500 mt-0.5",children:[on.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))," - ",um.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))]})]}),e.jsxs("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium flex items-center gap-1 ${a.status==="completed"?a.type==="withdraw"?"bg-red-100 text-red-700":"bg-green-100 text-green-700":a.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[a.status==="completed"&&e.jsx(qi,{className:"h-3 w-3"}),a.status==="pending"&&e.jsx(tc,{className:"h-3 w-3"}),a.status==="failed"&&e.jsx(Vi,{className:"h-3 w-3"}),e.jsx("span",{children:a.status==="completed"?"Ù†Ø§Ø¬Ø­Ø©":a.status==="pending"?"Ù…Ø¹Ø§Ù„Ø¬Ø©":"ÙØ´Ù„Øª"})]})]})]})]},a.id))})}):e.jsx("div",{className:"overflow-y-auto overscroll-contain scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400 transition-colors max-h-[calc(100dvh-300px)]",children:e.jsx("div",{className:"space-y-2 pr-2",children:Zl.map(a=>e.jsxs("div",{className:"relative flex items-center gap-4 p-4 rounded-xl bg-gray-50 border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>nm(a),children:[e.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center shrink-0 ${a.type==="withdraw"?"bg-red-100":"bg-green-100"}`,children:(()=>{const r=a,i=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª";return i?e.jsx(hn,{className:"h-5 w-5 text-gray-600"}):c?e.jsx(Lt,{className:"h-5 w-5 text-green-600"}):d?e.jsx(hn,{className:"h-5 w-5 text-green-600"}):a.type==="withdraw"?e.jsx(cr,{className:"h-5 w-5 text-red-600"}):e.jsx(Rm,{className:"h-5 w-5 text-green-600"})})()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"text-base font-bold truncate",children:(()=>{const r=a,i=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",m=String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((r==null?void 0:r.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡");return i?e.jsx("span",{className:"text-foreground",children:"ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"}):c?e.jsx("span",{className:"text-foreground",children:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"}):d?e.jsx("span",{className:"text-foreground",children:"Ù…Ø¨ÙŠØ¹Ø§Øª"}):m?e.jsx("span",{className:"text-foreground",children:"Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡"}):a.type==="atm_withdraw"?e.jsx("span",{className:"text-green-600",children:"Ø³Ø­Ø¨ atm"}):a.type==="send"?e.jsx("span",{className:"text-green-600",children:"ØªØ­ÙˆÙŠÙ„ Ø£Ù…ÙˆØ§Ù„"}):e.jsx("span",{className:"text-red-600",children:"Ø³Ø­Ø¨ Ù†Ù‚Ø¯ÙŠ"})})()}),e.jsxs("span",{className:`text-base font-bold whitespace-nowrap ${a.type==="withdraw"?"text-red-600":"text-green-600"}`,children:[a.type==="withdraw"||a.type==="cash_addition"||a.txnType==="cash_addition"||a.type==="sales"||a.txnType==="sales"?"+":"-"," ",ks(a.amount)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:(()=>{const r=a,i=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",m=String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((r==null?void 0:r.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡"),f=(r==null?void 0:r.note)||(r==null?void 0:r.notes)||"";if(i)return`Ø¥Ù„Ù‰: ${a.receiverPhone}`;if(c)return f||"Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠØ©";if(d){const g=((r==null?void 0:r.saleProductName)||"").trim(),y=((r==null?void 0:r.saleQuantity)??"").toString();return g&&y?`${g} Ã— ${y}`:g||"Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹"}return m?`Ù…Ù†: ${r.senderName||"Ù…Ø§ÙƒÙŠÙ†Ø©"}`:a.type==="send"?e.jsx("span",{dir:"ltr",children:a.receiverPhone}):e.jsx("span",{dir:"ltr",children:a.senderPhone})})()}),e.jsxs("p",{className:"text-sm font-medium text-gray-500 mt-0.5",children:[on.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))," - ",um.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))]})]}),e.jsxs("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium flex items-center gap-1 ${a.status==="completed"?a.type==="withdraw"?"bg-red-100 text-red-700":"bg-green-100 text-green-700":a.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[a.status==="completed"&&e.jsx(qi,{className:"h-3 w-3"}),a.status==="pending"&&e.jsx(tc,{className:"h-3 w-3"}),a.status==="failed"&&e.jsx(Vi,{className:"h-3 w-3"}),e.jsx("span",{children:a.status==="completed"?"Ù†Ø§Ø¬Ø­Ø©":a.status==="pending"?"Ù…Ø¹Ø§Ù„Ø¬Ø©":"ÙØ´Ù„Øª"})]})]})]})]},a.id))})}),O&&e.jsxs("div",{className:"mt-2 flex justify-end",children:[e.jsxs(A,{variant:"ghost",size:"sm",className:"h-7 px-2 text-[11px] rounded-full border bg-red-100 text-red-700 border-red-300 hover:bg-red-200",onClick:()=>xi(!0),title:"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©",children:[e.jsx(Sa,{className:"h-3 w-3 mr-1"}),"ØªØµÙÙŠØ±"]}),(t==null?void 0:t.uid)&&localStorage.getItem(`recentTransactionsResetAt:${t.uid}`)&&e.jsx("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-red-500 ml-1 align-middle"})]})]})]})]}),e.jsx(hN,{isOpen:Sf,onClose:()=>Gn(!1),transaction:Df,onPrint:()=>window.print(),onDelete:Tf,onComplete:Pf}),e.jsx(ue,{open:h0,onOpenChange:oo,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(he,{children:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø·ÙˆØ±"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4 bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-900/20 dark:to-blue-900/20 p-6 rounded-xl border border-blue-100 dark:border-blue-800 text-center",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400 shadow-sm",children:e.jsx(fx,{className:"h-8 w-8"})}),e.jsxs("div",{className:"space-y-3 w-full",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ·ÙˆÙŠØ±"}),e.jsx("p",{className:"text-lg font-bold bg-gradient-to-r from-blue-700 to-indigo-700 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent leading-relaxed",children:"ØªÙ… ØªØ·ÙˆÙŠØ± Ø§Ù„Ø§Ø¨Ù„ÙƒÙŠØ´Ù† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨ÙˆØ§Ø³Ø·Ø© Ù…/Ø£Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­ÙŠÙ… Ù…Ø­Ù…Ø¯"}),e.jsxs("div",{className:"flex flex-col items-center gap-1 mt-4",children:[e.jsx("p",{className:"text-base font-semibold text-gray-800 dark:text-gray-300",children:"Ø±Ù‚Ù… Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„ÙˆØ­ÙŠØ¯ Ù„Ù†Ø§"}),e.jsx("a",{href:"tel:01000392539",className:"text-2xl font-black text-blue-600 dark:text-blue-400 tracking-wider hover:underline",dir:"ltr",children:"01000392539"})]}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 font-bold bg-red-50 dark:bg-red-900/20 py-1 px-3 rounded-full inline-block mt-2",children:"Ù„ÙŠØ³ Ù„Ù†Ø§ Ø§ÙŠ Ø§Ø±Ù‚Ø§Ù… Ø§Ø®Ø±ÙŠ"})]})]}),e.jsx("div",{className:"text-center text-xs text-gray-400 mt-2",children:Zc?`v${Zc}`:"v1.0.0"})]}),e.jsx($e,{children:e.jsx(A,{onClick:()=>oo(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsxs("div",{className:"space-y-1 fade-in-right w-full",children:[e.jsxs(rs,{id:"transaction-section",className:"bg-gray-100 border border-blue-200/40 rounded-lg shadow-lg hover:shadow-lg transition-all duration-200 group relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 via-indigo-500/3 to-purple-500/5 opacity-0 group-hover:opacity-100 transition-opacity duration-200"}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 sm:w-28 sm:h-28 lg:w-20 lg:h-20 bg-gradient-to-bl from-blue-400/10 to-transparent rounded-full  "}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-indigo-400/10 to-transparent rounded-full  ",style:{animationDelay:"1s"}}),e.jsx(Ss,{className:"sticky top-0 z-20 bg-white/80 dark:bg-gray-900/80 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-gray-900/60 pb-0.5 px-3 pt-1 lg:pt-0.5 lg:pb-0.5 lg:px-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ds,{className:"text-sm font-bold flex items-center gap-2 text-gray-800",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Xi,{className:"h-1 w-1 text-emerald-500 "}),e.jsx("div",{className:"absolute inset-0 h-1 w-1 bg-emerald-400 rounded-full opacity-20 "})]}),e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Ø¥Ø¬Ø±Ø§Ø¡ Ù…Ø¹Ø§Ù…Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"top-icons-bar hidden md:flex items-center gap-2 bg-gradient-to-r from-gray-50 to-slate-50 hover:from-gray-100 hover:to-slate-100 border border-gray-200 transition-all duration-300 hover:scale-105 h-9 px-3 rounded-xl shadow-sm",children:[e.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Ø±Ø§Ø­Ø© Ø§Ù„Ø¹ÙŠÙ†",onClick:()=>hu(!Js),children:e.jsx(gx,{className:`h-5 w-5 transition-colors duration-300 ${Js?"text-orange-500 fill-orange-500":"text-gray-600"}`})}),e.jsx($w,{}),e.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"VIP",onClick:()=>sl(!0),children:e.jsx(Ox,{className:"h-5 w-5 text-yellow-500"})}),e.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ±ÙˆØ¹",onClick:()=>(Pt==null?void 0:Pt.status)==="active"?yr(!0):br(!0),children:e.jsx(un,{className:"h-5 w-5"})}),e.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø·ÙˆØ±",onClick:()=>oo(!0),children:e.jsx(_m,{className:"h-5 w-5 text-gray-600"})}),e.jsx(Ax,{})]})}),tp&&e.jsxs(A,{variant:"outline",size:"sm",className:"hidden flex items-center gap-1.5 sm:gap-2 bg-gradient-to-r from-cyan-50 to-blue-50 hover:from-cyan-100 hover:to-blue-100 border-cyan-200 text-cyan-800 text-xs sm:text-sm transition-all duration-300 hover:scale-105 hover:shadow-lg h-10 sm:h-12 px-4 sm:px-5 rounded-xl min-w-[44px] touch-manipulation",onClick:Gu,title:"Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…",children:[e.jsx(sc,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 animate-spin"}),e.jsx("span",{className:"text-xs sm:text-sm font-semibold whitespace-nowrap",children:"Ù…Ø²Ø§Ù…Ù†Ø©"})]})]})}),e.jsx(ue,{open:Zf,onOpenChange:sl,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(he,{children:"Ø£ÙØ¶Ù„ 10 Ø¹Ù…Ù„Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±"})}),e.jsx("div",{className:"space-y-2",children:Ti.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±"}):Ti.map((a,r)=>e.jsxs("div",{className:`flex items-center justify-between border rounded-md px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700 ${r===0?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-300 dark:border-yellow-700":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ba,{variant:"outline",className:`min-w-[28px] justify-center ${r===0?"border-yellow-300 text-yellow-700 dark:text-yellow-400 bg-yellow-50 dark:bg-yellow-900/20":""}`,children:r+1}),e.jsx("span",{className:`font-semibold ${r===0?"text-yellow-700":""}`,children:a.phone})]}),e.jsxs("div",{className:"text-sm text-gray-700 flex items-center gap-3",children:[e.jsxs("span",{children:["Ø¹Ø¯Ø¯: ",a.count]}),e.jsxs("span",{children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ",a.total]}),e.jsx(A,{variant:"outline",size:"sm",className:"h-8",onClick:()=>Xg(a),title:"Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨",children:e.jsx(rc,{className:"h-4 w-4"})})]})]},a.phone+r))}),e.jsx($e,{children:e.jsx(A,{onClick:()=>sl(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(ue,{open:Qf,onOpenChange:Xd,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(he,{children:"Ø±Ø¨Ø· Ø¨ÙˆØª Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù…"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{children:"Telegram Chat ID"}),e.jsx(X,{value:ii,onChange:a=>Gf(a.target.value),placeholder:"Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Z,{children:"Ø¥Ø±Ø³Ø§Ù„ ÙŠÙˆÙ…ÙŠ 12 ØµØ¨Ø§Ø­Ø§Ù‹"}),e.jsx(Ix,{checked:Zd,onCheckedChange:a=>Xf(!!a)})]})]}),e.jsxs($e,{children:[e.jsx(A,{variant:"outline",onClick:()=>Xd(!1),children:"Ø¥ØºÙ„Ø§Ù‚"}),e.jsx(A,{onClick:async()=>{t!=null&&t.uid&&(await se.updateUserData(t.uid,{telegramChatId:ii,telegramDailyEnabled:Zd}),w({title:"ØªÙ… Ø§Ù„Ø­ÙØ¸"}))},children:"Ø­ÙØ¸"}),e.jsx(A,{onClick:async()=>{if(!(t!=null&&t.uid)||!ii){w({title:"Ø£Ø¯Ø®Ù„ Chat ID"});return}const a=await em();try{const{sendTelegramMessage:r}=await le(async()=>{const{sendTelegramMessage:i}=await import("./functions-DxNA6i1h.js");return{sendTelegramMessage:i}},__vite__mapDeps([62,0,1]),import.meta.url);await r({chatId:ii,text:a}),w({title:"ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„"})}catch{w({title:"ØªØ¹Ø°Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ø¨Ø· Ø§Ù„Ø¨ÙˆØª",variant:"destructive"})}},children:"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¢Ù†"})]})]})}),e.jsx(ue,{open:xr,onOpenChange:yr,children:e.jsxs(me,{className:"sm:max-w-2xl bg-gray-50/80 backdrop-blur-sm",children:[e.jsx(be,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:e.jsx(un,{className:"w-6 h-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx(he,{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ±ÙˆØ¹"}),e.jsx(Ze,{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Ø£Ø¶Ù ÙØ±ÙˆØ¹Ø§Ù‹ Ø¬Ø¯ÙŠØ¯Ø© ÙˆØªØ§Ø¨Ø¹ Ø£Ø¯Ø§Ø¡ ÙƒÙ„ ÙØ±Ø¹ Ø¨Ø³Ù‡ÙˆÙ„Ø©"})]})]}),e.jsx(A,{size:"icon",variant:Ms?"destructive":"default",className:`rounded-full transition-all duration-300 ${Ms?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200":"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg hover:shadow-indigo-200"}`,onClick:()=>Qc(!Ms),title:Ms?"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¥Ø¶Ø§ÙØ©":"Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¹ Ø¬Ø¯ÙŠØ¯",children:Ms?e.jsx(zi,{className:"w-6 h-6"}):e.jsx(Lt,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"space-y-6",children:[Ms&&e.jsxs("div",{className:"bg-white dark:bg-card p-5 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm space-y-4 animate-in slide-in-from-top-4 fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-indigo-700 dark:text-indigo-400 font-semibold",children:[e.jsx(Lt,{className:"w-5 h-5"}),e.jsx("h3",{children:"Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¹ Ø¬Ø¯ÙŠØ¯"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(A,{onClick:()=>checkSubscriptionStatus(!0).then(()=>w({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"})),variant:"ghost",size:"icon",title:"ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ",children:e.jsx(sc,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})}),e.jsxs(A,{onClick:()=>br(!0),variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Ux,{className:"w-4 h-4"}),"Ø·Ù„Ø¨ Ø²ÙŠØ§Ø¯Ø© ÙØ±Ø¹"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{className:"text-gray-700 dark:text-gray-300",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±"}),e.jsxs("div",{className:"relative",children:[e.jsx(mn,{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400"}),e.jsx(X,{className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:$c,onChange:a=>co(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{className:"text-gray-700 dark:text-gray-300",children:"Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹"}),e.jsxs("div",{className:"relative",children:[e.jsx(un,{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400"}),e.jsx(X,{className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:Bc,onChange:a=>uo(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: ÙØ±Ø¹ ÙˆØ³Ø· Ø§Ù„Ø¨Ù„Ø¯"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{className:"text-gray-700 dark:text-gray-300",children:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø¯Ø®ÙˆÙ„"}),e.jsxs("div",{className:"relative",children:[e.jsx(rc,{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400"}),e.jsx(X,{className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:Uc,onChange:a=>mo(a.target.value),placeholder:"branch@example.com"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{className:"text-gray-700 dark:text-gray-300",children:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400",children:"ðŸ”’"}),e.jsx(X,{type:"password",className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:Vc,onChange:a=>ho(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("create-branch-btn"))==null||r.click())},placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx(A,{variant:"ghost",onClick:()=>{co(""),uo(""),mo(""),ho("")},className:"text-gray-500 hover:text-gray-700",children:"Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„"}),e.jsx(A,{id:"create-branch-btn",className:"bg-indigo-600 hover:bg-indigo-700 text-white min-w-[120px]",disabled:fo,onClick:async()=>{if(!(t!=null&&t.uid))return;const a=$c.trim(),r=Bc.trim(),i=Uc.trim(),c=Vc.trim();if(!a||!r||!i||!c){w({title:"ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)){w({title:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­",variant:"destructive"});return}if(c.length<6){w({title:"ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„",variant:"destructive"});return}const m=(Pt==null?void 0:Pt.limit)||0;if(vr.length>=m){w({title:"Ø¹ÙÙˆØ§Ù‹",description:`Ù„Ù‚Ø¯ ÙˆØµÙ„Øª Ù„Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù…Ù† Ø§Ù„ÙØ±ÙˆØ¹ (${m} ÙØ±ÙˆØ¹)`,variant:"destructive"});return}try{Pn(!0);let f="",g="";const y=`tempApp_${Date.now()}`,b=ax(sx,y),x=rx(b),N=nx(b);try{f=(await ix(x,i,c)).user.uid;try{await ra(Me(N,"users",f),{email:i,isBranch:!0,ownerId:t.uid,createdAt:wt(),updatedAt:wt(),role:"branch",isActive:!1,subscription:{isActive:!1,planType:null,startDate:null,endDate:null}})}catch(I){console.error("Error creating branch user document:",I)}try{g=(await fn(ie(N,"shops"),{name:r,ownerId:f,managerName:a,createdAt:wt(),updatedAt:wt(),isActive:!0})).id}catch(I){console.error("Error creating shop as new user:",I);try{g=(await fn(ie(N,"users",f,"shops"),{name:r,ownerId:f,managerName:a,createdAt:wt(),updatedAt:wt(),isActive:!0})).id}catch(P){throw console.error("Error creating shop in subcollection:",P),I}}await ox(x)}catch(S){console.error("Registration/Shop Creation Error:",S);let I="ØªØ¹Ø°Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ù…ØªØ¬Ø±";S.code==="auth/email-already-in-use"&&(I="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„"),S.code==="auth/invalid-email"&&(I="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­"),S.code==="auth/weak-password"&&(I="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ©"),S.code==="permission-denied"&&(I="Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù…ØªØ¬Ø± Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"),w({title:I,description:S.message,variant:"destructive"});try{await Tm(b)}catch{}return}finally{try{await Tm(b)}catch(S){console.warn("Error deleting temp app:",S)}}if(!f||!g)return;const v=S=>{try{return btoa(unescape(encodeURIComponent(S)))}catch{return btoa(S)}};try{const S={ownerId:t.uid,shopId:g,branchUserId:f,branchName:r,managerName:a,loginUsername:i,passwordEncoded:v(c),createdAt:wt()};await ra(Me(F,"users",t.uid,"branches",f),S);try{await fn(ie(F,"branches"),S)}catch(P){console.warn("Branch ref creation error in root collection (non-fatal):",P)}const I={id:f,branchUserId:f,branchName:r,managerName:a,source:"sub",...S};lo(P=>[...P,I])}catch(S){console.error("Branch ref creation error:",S),w({title:"Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹",description:"ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙ„ÙƒÙ† ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",variant:"destructive"})}co(""),uo(""),mo(""),ho(""),w({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ±Ø¹ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­"})}catch(f){console.error("General Error adding branch:",f),w({title:"ØªØ¹Ø°Ù‘Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ±Ø¹",description:f.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹"})}finally{Pn(!1)}},children:fo?"Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø¶Ø§ÙØ©...":"Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¹"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-6 bg-indigo-500 rounded-full"}),"Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠØ©",e.jsxs(Ba,{variant:"secondary",className:"mr-auto",children:[vr.length," / ",(Pt==null?void 0:Pt.limit)||0]})]}),fo&&vr.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-gray-500",children:[e.jsx(sc,{className:"w-8 h-8 animate-spin mb-2 text-indigo-400"}),e.jsx("p",{children:"Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ±ÙˆØ¹..."})]}):vr.length===0?e.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-200 dark:border-gray-800 rounded-xl bg-gray-50 dark:bg-gray-900/50",children:[e.jsx(un,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙØ±ÙˆØ¹ Ù…Ø¶Ø§ÙØ© Ø­Ø§Ù„ÙŠØ§Ù‹"})]}):e.jsx("div",{className:"grid grid-cols-1 gap-3",children:vr.map(a=>{var r;return e.jsx("div",{className:"group relative bg-white dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl p-4 shadow-sm hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-700 dark:text-indigo-400 font-bold text-lg",children:((r=a.branchName)==null?void 0:r.charAt(0))||"B"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-gray-900 dark:text-gray-100 text-lg",children:a.branchName}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(mn,{className:"w-3 h-3"}),e.jsxs("span",{children:["Ø§Ù„Ù…Ø¯ÙŠØ±: ",a.managerName]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto mt-2 sm:mt-0",children:[e.jsxs(A,{className:"flex-1 sm:flex-none bg-indigo-50 text-indigo-700 hover:bg-indigo-100 border border-indigo-200 dark:bg-indigo-900/20 dark:text-indigo-300 dark:hover:bg-indigo-900/30 dark:border-indigo-800",onClick:()=>_0(a),children:[e.jsx(ic,{className:"w-4 h-4 ml-2"}),"Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"]}),e.jsx(A,{variant:"ghost",size:"icon",className:"text-blue-500 hover:text-blue-700 hover:bg-blue-50 dark:text-blue-400 dark:hover:text-blue-300 dark:hover:bg-blue-900/20",title:"ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹",onClick:()=>I0(a),children:e.jsx(Bm,{className:"w-4 h-4"})})]})]})},a.id)})})]})]})]})}),e.jsx(ue,{open:g0,onOpenChange:go,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsxs(be,{children:[e.jsx(he,{children:"Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ±Ø¹"}),e.jsx(Ze,{children:"Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙØ±Ø¹ Ø§Ù„Ù…Ø­Ø¯Ø¯"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(Z,{children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ)"}),e.jsx(X,{value:qc,onChange:a=>zc(a.target.value),placeholder:"example@email.com"})]}),e.jsxs("div",{children:[e.jsx(Z,{children:"ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±"}),e.jsx(X,{type:"password",value:Yc,onChange:a=>Kc(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("branch-login-btn"))==null||r.click())},placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(A,{variant:"outline",onClick:()=>{zc(""),Kc("")},children:"Ù…Ø³Ø­"}),e.jsx(A,{id:"branch-login-btn",className:"bg-blue-600 hover:bg-blue-700",disabled:x0,onClick:async()=>{const a=p0;if(!a){go(!1);return}const r=String(a.loginUsername||"");let i="";try{const m=String(a.passwordEncoded||"");i=m?decodeURIComponent(escape(atob(m))):""}catch{try{i=a.passwordEncoded?atob(String(a.passwordEncoded)):""}catch{i=""}}const c=qc.trim(),d=Yc.trim();if(!c||!d){w({title:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±"});return}if(c!==r||d!==i){w({title:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©",variant:"destructive"});return}try{Jc(!0);const m=t!=null&&t.uid?`selectedShopId_${t.uid}`:"selectedShopId";localStorage.setItem(m,String(a.shopId)),w({title:"ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙØ±Ø¹",description:String(a.branchName||"")}),go(!1),yr(!1),p("/user/dashboard")}catch{}Jc(!1)},children:"Ø¯Ø®ÙˆÙ„"})]})]})]})}),e.jsx(ue,{open:y0,onOpenChange:Mn,children:e.jsxs(me,{className:"sm:max-w-2xl",children:[e.jsxs(be,{children:[e.jsxs(he,{children:["Ø¨ÙŠØ§Ù†Ø§Øª ÙØ±Ø¹ ",$t==null?void 0:$t.branchName]}),e.jsxs(Ze,{children:["Ù…Ø¯ÙŠØ± Ø§Ù„ÙØ±Ø¹: ",$t==null?void 0:$t.managerName]})]}),b0?e.jsx("div",{className:"py-8 flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):$t?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 py-4",children:[e.jsxs("div",{className:"p-4 border rounded-xl bg-green-50 dark:bg-green-950/20 dark:border-green-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…"}),e.jsxs("div",{className:"text-xl font-bold text-green-700 dark:text-green-400",children:[Number($t.todaySales||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-blue-50 dark:bg-blue-950/20 dark:border-blue-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø´Ù‡Ø±"}),e.jsxs("div",{className:"text-xl font-bold text-blue-700 dark:text-blue-400",children:[Number($t.monthSales||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-emerald-50 dark:bg-emerald-950/20 dark:border-emerald-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ø§Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…"}),e.jsxs("div",{className:"text-xl font-bold text-emerald-700 dark:text-emerald-400",children:[Number($t.todayProfit||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-cyan-50 dark:bg-cyan-950/20 dark:border-cyan-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ø§Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±"}),e.jsxs("div",{className:"text-xl font-bold text-cyan-700 dark:text-cyan-400",children:[Number($t.monthProfit||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-purple-50 dark:bg-purple-950/20 dark:border-purple-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),e.jsxs("div",{className:"text-xl font-bold text-purple-700 dark:text-purple-400",children:[Number($t.walletsTotal||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-yellow-50 dark:bg-yellow-950/20 dark:border-yellow-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ø¯Ø±Ø¬"}),e.jsxs("div",{className:"text-xl font-bold text-yellow-700 dark:text-yellow-400",children:[Number($t.cashBalance||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-indigo-50 dark:bg-indigo-950/20 dark:border-indigo-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¨ÙŠØ¹Ø§Øª Ù‚Ø³Ù… Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"}),e.jsxs("div",{className:"text-xl font-bold text-indigo-700 dark:text-indigo-400",children:[Number($t.totalSalesSection||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-red-50 dark:bg-red-950/20 dark:border-red-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¯ÙŠÙˆÙ†"}),e.jsxs("div",{className:"text-xl font-bold text-red-700 dark:text-red-400",children:[Number($t.debtsTotal||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]})]}):null,e.jsx($e,{children:e.jsx(A,{onClick:()=>Mn(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(ue,{open:S0,onOpenChange:On,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsxs(be,{children:[e.jsx(he,{children:"ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹"}),e.jsx(Ze,{children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹ ÙˆØ§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±"})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{children:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)"}),e.jsx(X,{value:k0,readOnly:!0,disabled:!0,placeholder:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø±ÙŠØ¯ Ù…Ø³Ø¬Ù„",className:"bg-gray-100 dark:bg-gray-800 text-black dark:text-gray-100 opacity-100 font-medium"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{children:"Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹"}),e.jsx(X,{value:En,onChange:a=>ad(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: ÙØ±Ø¹ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±"}),e.jsx(X,{value:Rn,onChange:a=>sd(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯"})]})]}),e.jsxs($e,{children:[e.jsx(A,{variant:"outline",onClick:()=>On(!1),children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{onClick:A0,disabled:rd,children:rd?"Ø¬Ø§Ø±Ù Ø§Ù„Ø­ÙØ¸...":"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª"})]})]})}),e.jsxs(ns,{ref:ht,className:"space-y-1 px-2 pb-2 relative z-10 transition-transform duration-200 ease-out will-change-transform",style:{transform:Ue?`translateY(${Ue}px)`:void 0},onFocusCapture:a=>{const r=a.target;if(!((r==null?void 0:r.id)==="transferExtraFeeInput")){tt(0);return}const c=document.getElementById("transferSubmitButton");if(c){const d=c.getBoundingClientRect(),m=window.innerHeight;if(d.bottom>m){const f=d.bottom-m,g=Math.min(f,220);tt(-g)}else tt(0)}else tt(0)},onBlurCapture:a=>{a.currentTarget.contains(a.relatedTarget)||tt(0)},children:[e.jsxs("div",{className:"transaction-type-tabs flex w-full rounded-full border border-gray-300 dark:border-gray-700 overflow-hidden bg-surface dark:bg-card",children:[e.jsxs("button",{type:"button",onClick:()=>Li("transfer"),className:`flex-1 h-10 text-sm font-medium transition-colors duration-200 flex items-center justify-center gap-2 ${B==="transfer"?"bg-blue-100 text-blue-900 dark:bg-blue-900/40 dark:text-blue-100":"bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:[B==="transfer"&&e.jsx(qi,{className:"h-4 w-4"}),e.jsx(dn,{className:"h-4 w-4"}),"ØªØ­ÙˆÙŠÙ„"]}),e.jsx("div",{className:"w-[1px] bg-gray-300 dark:bg-gray-700"}),e.jsxs("button",{type:"button",onClick:()=>ke("withdrawals",()=>Li("withdraw")),className:`flex-1 h-10 text-sm font-medium transition-colors duration-200 flex items-center justify-center gap-2 ${B==="withdraw"?"bg-red-100 text-red-900 dark:bg-red-900/40 dark:text-red-100":"bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:[B==="withdraw"&&e.jsx(qi,{className:"h-4 w-4"}),e.jsx(cr,{className:"h-4 w-4"}),"Ø§Ø³ØªÙ„Ø§Ù…"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-3",children:[e.jsxs("label",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 whitespace-nowrap",children:[e.jsx(nr,{className:"h-4 w-4 text-blue-600"}),"Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø©"]}),e.jsxs("div",{className:"flex items-center gap-1 justify-end overflow-x-auto scrollbar-hide",children:[e.jsxs(A,{variant:"outline",size:"sm",className:"h-7 rounded-md px-2 text-[10px] font-medium bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border-emerald-200 shadow-sm whitespace-nowrap",onClick:()=>{zs(!0),qs(!0)},title:"Ø¥Ø¶Ø§ÙØ© Ù…Ø­ÙØ¸Ø©",children:[e.jsx(Lt,{className:"h-3 w-3 mr-1"}),"Ø¥Ø¶Ø§ÙØ© Ù…Ø­ÙØ¸Ø©"]}),e.jsxs(A,{variant:"outline",size:"sm",className:"h-7 rounded-md px-2 text-[10px] font-medium bg-orange-50 text-orange-700 hover:bg-orange-100 border-orange-200 shadow-sm whitespace-nowrap",onClick:()=>ya(!0),title:"Ø·Ø¨Ø§Ø¹Ø© Ù…Ø­ÙØ¸Ø©",children:[e.jsx(Ex,{className:"h-3 w-3 mr-1"}),"Ø·Ø¨Ø§Ø¹Ø©"]}),e.jsxs(A,{variant:"outline",size:"sm",className:"h-7 rounded-md px-2 text-[10px] font-medium bg-indigo-50 text-indigo-700 hover:bg-indigo-100 border-indigo-200 shadow-sm whitespace-nowrap",onClick:()=>{Vn(!0)},title:"Ø§Ù„Ù…Ø­Ø§ÙØ¸",children:[e.jsx(nr,{className:"h-3 w-3 mr-1"}),"Ø§Ù„Ù…Ø­Ø§ÙØ¸"]})]})]}),ae.length>0?e.jsxs(Va,{value:R,onValueChange:np,children:[e.jsx(qa,{"data-testid":"wallet-select",className:"w-full h-14 text-base bg-surface border border-gray-400 hover:border-gray-800 focus:border-primary rounded-xl transition-colors duration-200 flex items-center",children:e.jsx(za,{placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ù…Ø¹Ø§Ù…Ù„Ø©",className:"text-gray-700"})}),e.jsxs(Ya,{className:"rounded-xl border border-gray-200 dark:border-gray-800 shadow-md z-[9999] bg-white dark:bg-gray-900",children:[e.jsx("div",{"data-fixed-header":"true",className:"sticky top-0 z-10 bg-white dark:bg-gray-900 p-2 border-b border-gray-100 dark:border-gray-800",children:e.jsx(X,{value:Md,onChange:a=>vf(a.target.value),placeholder:"Ø§Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©",className:"h-10 text-sm border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-950 text-gray-900 dark:text-gray-100 rounded-lg"})}),e.jsx("div",{className:"p-1",children:Ed.length===0?e.jsx("div",{className:"text-sm text-gray-500 p-3 text-center",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©"}):Ed.map(a=>{const r=Ps.includes(a.id);let i=null;const c=fc(a.phone),d=fc(ee),m=fc(re);return d&&c===d?i=e.jsx("span",{className:"mr-1 text-[10px] font-bold bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded border border-blue-200 whitespace-nowrap",children:"SIM 1"}):m&&c===m&&(i=e.jsx("span",{className:"mr-1 text-[10px] font-bold bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded border border-purple-200 whitespace-nowrap",children:"SIM 2"})),e.jsx(la,{value:a.id,className:"rounded-lg my-1 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 focus:bg-blue-50 dark:focus:bg-blue-900/20 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center gap-3 py-2 w-full",children:[e.jsx(nr,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),e.jsxs("div",{className:"flex items-center gap-2 text-right",children:[e.jsx("span",{className:"text-base font-medium text-gray-900 dark:text-gray-100",children:a.name}),e.jsx("span",{className:"text-sm font-bold text-red-600 dark:text-red-400",children:a.phone}),i]}),a.isDefault&&e.jsx("span",{className:"mr-auto text-[10px] bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 px-2 py-0.5 rounded-full border border-gray-200 dark:border-gray-700",children:"Ø§ÙØªØ±Ø§Ø¶ÙŠ"}),e.jsx("button",{type:"button",onMouseDown:f=>{f.preventDefault(),f.stopPropagation(),wf(a.id)},className:"ml-2 mr-auto rounded-full p-1 hover:bg-yellow-50 dark:hover:bg-yellow-900/20 cursor-pointer",title:r?"Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©":"ØªØ¹ÙŠÙŠÙ† ÙƒÙ…Ø­ÙØ¸Ø© Ù…ÙØ¶Ù„Ø©",children:e.jsx(Rx,{className:`h-4 w-4 ${r?"text-yellow-500 fill-yellow-400 drop-shadow-[0_0_4px_rgba(250,204,21,0.8)]":"text-gray-400"}`})})]})},a.id)})})]})]}):e.jsx("div",{className:"rounded-xl border-2 border-dashed border-gray-200 bg-gray-50 px-3 py-3 text-xs text-gray-600",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†. Ø§Ø¶ØºØ· â€œØ¥Ø¶Ø§ÙØ© Ù…Ø­ÙØ¸Ø©â€ Ù„Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ù…Ø­ÙØ¸Ø©."})]}),e.jsx(ue,{open:K0,onOpenChange:Dd,children:e.jsxs(me,{className:"sm:max-w-3xl w-[95vw] sm:w-auto max-h-[80vh] overflow-y-auto",children:[e.jsx(be,{children:e.jsx(he,{children:"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø§ÙØ¸"})}),e.jsx("div",{className:"mt-2",children:e.jsx(IN,{showAddButton:!1,showUsageBars:!1,showLimitCards:!1,showEditButton:!0,onWalletEdit:a=>{bf({id:a.id,name:a.label||"",phone:a.msisdn,ownerName:"",nationalId:"",isDefault:!1,monthlyWithdrawalLimit:a.withdrawLimit||0,monthlyTransferLimit:a.transferLimit||0,dailyWithdrawalLimit:a.dailyWithdrawLimit||0,dailyTransferLimit:a.dailyTransferLimit||0}),zs(!1),qs(!0)}})})]})}),e.jsx(ta,{open:J0,onOpenChange:Vn,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ Ø§Ù„Ù…Ø­Ø§ÙØ¸",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸",onSuccess:()=>{Vn(!1),Dd(!0)},userId:t==null?void 0:t.uid,userRole:n==null?void 0:n.role}),e.jsx(rh,{isOpen:Ft,onClose:()=>ya(!1),wallets:ae}),e.jsx(ta,{open:H0,onOpenChange:a=>{Eo(a),a||Ro(null)},mode:"verify",title:"ØªØ£ÙƒÙŠØ¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",onSuccess:()=>{kd&&(tn(kd,"walletSelectionPin"),Ro(null)),Eo(!1)},userId:t==null?void 0:t.uid,userRole:n==null?void 0:n.role}),R&&ae.length>0&&(()=>{var M;const a=ae.find(V=>V.id===R),r=$a,i=dp,c=(Se==null?void 0:Se.monthlyWithdrawLimit)??(a==null?void 0:a.monthlyWithdrawalLimit)??2e5,d=(Se==null?void 0:Se.monthlyTransferLimit)??(a==null?void 0:a.monthlyTransferLimit)??2e5,m=(Se==null?void 0:Se.monthlyWithdrawUsed)??r.totalWithdrawn??0,f=(Se==null?void 0:Se.monthlyTransferUsed)??r.totalTransferred??0,g=((M=Bt==null?void 0:Bt.subscription)==null?void 0:M.planType)===aa.TAHWEELA,y=g?0:(Se==null?void 0:Se.dailyWithdrawLimit)??1e5,b=g?0:(Se==null?void 0:Se.dailyTransferLimit)??6e4,x=g?0:(Se==null?void 0:Se.dailyWithdrawUsed)??i.totalWithdrawn??0,N=g?0:(Se==null?void 0:Se.dailyTransferUsed)??i.totalTransferred??0,v=parseFloat(jt||"0")||0,S=m+(B==="withdraw"?v:0),I=f+(B==="transfer"?v:0),P=x+(B==="withdraw"?v:0),_=N+(B==="transfer"?v:0);return a?e.jsxs("div",{className:"mb-2 space-y-2 p-2 bg-gray-50 dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 dark:border-gray-800 pb-1",children:[e.jsx("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-200",children:"Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©"}),e.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 px-2 py-0.5 rounded-full border border-gray-200 dark:border-gray-700",children:Ng||(a==null?void 0:a.name)})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[e.jsx("span",{className:"text-green-600",children:"Ø§Ø³ØªÙ„Ø§Ù… Ø´Ù‡Ø±ÙŠ"}),e.jsxs("span",{className:"text-green-600 dir-ltr",children:[Math.max(c-S,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),e.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:e.jsx("div",{className:"h-full bg-gradient-to-l from-red-500 to-red-600 rounded-full transition-all duration-500 ease-out shadow-sm",style:{width:`${Math.min(S/Math.max(c,1)*100,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-green-700 dark:text-green-400 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",S.toLocaleString("en-US",{maximumFractionDigits:0})]}),e.jsxs("span",{className:"text-[10px] text-green-700 dark:text-green-400 font-medium",children:["Ø§Ù„Ø­Ø¯: ",c.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]}),e.jsx("div",{className:"w-[1px] bg-gray-200 self-stretch"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"ØªØ­ÙˆÙŠÙ„ Ø´Ù‡Ø±ÙŠ"}),e.jsxs("span",{className:"text-red-600 dark:text-red-400 dir-ltr",children:[Math.max(d-I,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),e.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:e.jsx("div",{className:"h-full bg-gradient-to-l from-blue-500 to-blue-600 rounded-full transition-all duration-500 ease-out shadow-sm",style:{width:`${Math.min(I/Math.max(d,1)*100,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-red-700 dark:text-red-400 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",I.toLocaleString("en-US",{maximumFractionDigits:0})]}),e.jsxs("span",{className:"text-[10px] text-red-700 dark:text-red-400 font-medium",children:["Ø§Ù„Ø­Ø¯: ",d.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]})]})]}),e.jsxs("div",{className:"space-y-1 pt-1.5 border-t border-gray-200 dark:border-gray-800",children:[e.jsx("div",{className:"flex items-center justify-between mb-0.5",children:e.jsx("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-200",children:"Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400",children:"Ø§Ø³ØªÙ„Ø§Ù… ÙŠÙˆÙ…ÙŠ"}),e.jsxs("span",{className:"text-green-600 dark:text-green-400 dir-ltr",children:[Math.max(y-P,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),e.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:e.jsx("div",{className:"h-full bg-gradient-to-l from-orange-400 to-orange-500 rounded-full transition-all duration-500 ease-out",style:{width:`${Math.min(P/Math.max(y,1)*100,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-green-700 dark:text-green-400 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",P.toLocaleString("en-US",{maximumFractionDigits:0})]}),e.jsxs("span",{className:"text-[10px] text-green-700 dark:text-green-400 font-medium",children:["Ø§Ù„Ø­Ø¯: ",y.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]}),e.jsx("div",{className:"w-[1px] bg-gray-200 dark:bg-gray-800 self-stretch"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"ØªØ­ÙˆÙŠÙ„ ÙŠÙˆÙ…ÙŠ"}),e.jsxs("span",{className:"text-red-600 dark:text-red-400 dir-ltr",children:[Math.max(b-_,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),e.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:e.jsx("div",{className:"h-full bg-gradient-to-l from-green-500 to-green-600 rounded-full transition-all duration-500 ease-out",style:{width:`${Math.min(_/Math.max(b,1)*100,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-red-700 dark:text-red-400 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",_.toLocaleString("en-US",{maximumFractionDigits:0})]}),e.jsxs("span",{className:"text-[10px] text-red-700 dark:text-red-400 font-medium",children:["Ø§Ù„Ø­Ø¯: ",b.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]})]})]})]}):null})(),B==="transfer"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø³Ù„"}),e.jsxs("div",{className:"relative group",children:[e.jsx(Ui,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-green-600 group-focus-within:text-green-700"}),e.jsx(X,{value:Gt,onChange:a=>Ga(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){const r=document.getElementById("receiverPhoneInput");if(r)r.focus();else{const i=document.getElementById("amountInput");i==null||i.focus()}}},placeholder:"01030302038",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-blue-600 focus:ring-1 focus:ring-blue-600 dark:text-gray-100"})]})]}),!l&&$o&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„"}),e.jsxs("div",{className:"relative group",children:[e.jsx(Ui,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-green-600 group-focus-within:text-green-700"}),e.jsx(X,{id:"receiverPhoneInput",value:Mt,onChange:a=>{_r(a.target.value),Go&&Ys(!1)},onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("amountInput");r==null||r.focus()}},inputMode:"numeric",maxLength:11,placeholder:"Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-blue-600 focus:ring-1 focus:ring-blue-600 dark:text-gray-100"})]})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ui,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-gray-400"}),e.jsx(X,{value:R&&((gm=ae.find(a=>a.id===R))==null?void 0:gm.phone)||"",readOnly:!0,placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹",className:"pl-10 h-10 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl dark:text-gray-100"})]})]}),B==="transfer"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬Ù†ÙŠÙ‡)"}),e.jsxs("div",{className:"relative flex items-center gap-2 group",children:[e.jsx(Da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-yellow-600 group-focus-within:text-yellow-700"}),e.jsx(X,{id:"amountInput",value:jt,onChange:a=>{$s(a.target.value),Go&&Ys(!1)},onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("transferCommissionInput");if(r)r.focus();else{const i=document.getElementById("quickDebtButton");i==null||i.focus()}}},placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",type:"number",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-blue-600 focus:ring-1 focus:ring-blue-600 dark:text-gray-100"})]}),kt?e.jsxs("div",{className:"mt-2 text-xs text-green-700 dark:text-green-400 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-900/30 rounded px-2 py-1 flex items-center gap-2",children:[e.jsxs("span",{children:["ØªÙ… Ø¥Ø¯Ø®Ø§Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø¬Ù„ Ù„Ù€ ",kt.debtorName," Ø¨Ù…Ø¨Ù„Øº ",kt.amount," Ø¬Ù†ÙŠÙ‡"]}),e.jsx(A,{type:"button",variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>Oo(null),children:"Ø¥Ù„ØºØ§Ø¡"})]}):null]}),(()=>{if(l)return null;const a=dt();return a&&a.defaultTransferCommission!=null?e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ (ØªÙ„Ù‚Ø§Ø¦ÙŠØ©)"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Ø³ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„ÙƒÙ„ Ø£Ù„Ù: ",a==null?void 0:a.defaultTransferCommission," Ø¬Ù†ÙŠÙ‡ Ù„ÙƒÙ„ Ø£Ù„Ù"]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(A,{id:"quickDebtButton",type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium",onClick:()=>{const i=dt(),c=(i==null?void 0:i.defaultTransferCommission)!=null?Number(i.defaultTransferCommission):0,d=parseFloat(jt||"0")||0,m=Math.round((c||0)*d/1e3*100)/100,f=d+m;Us((f||0).toString()),Ee?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Bs(!0)},children:"Ø£Ø¬Ù„"}),e.jsx(A,{type:"button",variant:"outline",size:"sm",className:"border-orange-500 text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/20",onClick:()=>{Yn(i=>!i)},children:"Ø®ØµÙ… Ù„Ù„Ø¹Ù…ÙŠÙ„"}),e.jsx(A,{type:"button",variant:"outline",size:"icon",className:"hidden",title:ct?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…",children:ct?e.jsx(Lt,{className:"h-4 w-4 text-green-600"}):e.jsx(zi,{className:"h-4 w-4 text-red-600"})}),e.jsx("span",{className:"hidden",children:ct?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…"})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (Ø¬Ù†ÙŠÙ‡)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1 group",children:[e.jsx(Da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-yellow-600 group-focus-within:text-yellow-700"}),e.jsx(X,{id:"transferCommissionInput",value:Ot,onChange:i=>zn(i.target.value),onKeyDown:i=>{if(i.key==="Enter"){i.preventDefault(),i.stopPropagation();const c=document.getElementById("transferExtraFeeInput");if(c)c.focus();else{const d=document.getElementById("transferSubmitButton");d==null||d.click()}}},placeholder:"Ø£Ø¯Ø®Ù„ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„",type:"number",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-orange-500 focus:ring-1 focus:ring-orange-500 dark:text-gray-100"})]}),e.jsx(A,{type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium dark:bg-red-700 dark:hover:bg-red-800",onClick:()=>{const i=dt(),c=parseFloat(jt||"0")||0;let d=0;if((i==null?void 0:i.defaultTransferCommission)!=null){const f=Number(i.defaultTransferCommission)||0;d=Math.round(f*c/1e3*100)/100}else{const f=Ot&&Ot.trim()!==""?parseFloat(Ot):0;d=Math.max(0,f)}const m=c+d;Us((m||0).toString()),Ee?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Bs(!0)},children:"Ø£Ø¬Ù„"}),e.jsx(A,{type:"button",variant:"outline",size:"sm",className:"border-orange-500 text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/20",onClick:()=>{Yn(i=>!i)},children:"Ø®ØµÙ… Ù„Ù„Ø¹Ù…ÙŠÙ„"}),e.jsx(A,{type:"button",variant:"outline",size:"icon",className:"hidden",title:ct?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…",children:ct?e.jsx(Lt,{className:"h-4 w-4 text-green-600"}):e.jsx(zi,{className:"h-4 w-4 text-red-600"})}),e.jsx("span",{className:"hidden",children:ct?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…"})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"})]})})(),G0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ø®ØµÙ… Ù„Ù„Ø¹Ù…ÙŠÙ„ (Ø¬Ù†ÙŠÙ‡)"}),e.jsxs("div",{className:"relative",children:[e.jsx(Da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-orange-500"}),e.jsx(X,{id:"customerDiscountInput",value:Pr,onChange:a=>Wo(a.target.value),placeholder:"Ø£Ø¯Ø®Ù„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ… Ù„Ù„Ø¹Ù…ÙŠÙ„",type:"number",className:"pl-10 h-10 text-sm lg:text-base bg-orange-50/60 dark:bg-gray-900 border-orange-300 dark:border-orange-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-orange-500 focus:ring-1 focus:ring-orange-500 dark:text-gray-100"})]}),e.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Ø³ÙŠØªÙ… Ø®ØµÙ… Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¨Ù„Øº Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©."})]}),tf&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ø±Ø³ÙˆÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ (Ø¬Ù†ÙŠÙ‡)"}),e.jsxs("div",{className:"relative",children:[e.jsx(Da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-yellow-600"}),e.jsx(X,{id:"transferExtraFeeInput",value:Cd,onChange:a=>Q0(a.target.value),placeholder:"Ø£Ø¯Ø®Ù„ Ø±Ø³ÙˆÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„",type:"number",className:"pl-10 h-10 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 hover:border-blue-400 focus:border-blue-500 dark:text-gray-100"})]}),e.jsx("div",{className:"hidden",children:"ØªÙØ®ØµÙ… Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙˆØªØ¶Ø§Ù Ù„Ù„Ø¯Ø±Ø¬ â€” Ù„Ø¹Ù…Ù„ÙŠØ§Øª 010 â†’ 011/012/015 Ø£Ùˆ 012 â†’ 010 Ø£Ùˆ 011 â†’ 010 Ø£Ùˆ 015 â†’ 010"})]}),e.jsxs("div",{className:"sticky bottom-0 z-20 pt-2 pb-2 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-800 backdrop-blur supports-[backdrop-filter]:bg-white/90 dark:supports-[backdrop-filter]:bg-gray-900/90",children:[e.jsx(A,{id:"transferSubmitButton",onClick:dm,className:"w-full h-12 text-base font-medium rounded-full bg-blue-600 hover:bg-blue-700 text-white shadow-none hover:shadow-md",children:Go?"ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),X0&&e.jsxs("div",{className:"flex items-start gap-2 mt-2 px-1",children:[e.jsx(ac,{className:"h-4 w-4 text-amber-500 shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-xs text-gray-500 leading-tight",children:["ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ 85% Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø© ",Lo==null?void 0:Lo.walletName]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ù…Ø¨Ù„Øº Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (Ø¬Ù†ÙŠÙ‡)"}),e.jsxs("div",{className:"relative group",children:[e.jsx(cr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-primary"}),e.jsx(X,{id:"amountInput",value:jt,onChange:a=>{$s(a.target.value),Xo&&Ur(!1)},onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("manualWithdrawCommissionInput");if(r)r.focus();else{const i=document.getElementById("withdrawSubmitButton");i==null||i.focus()}}},placeholder:"Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…",type:"number",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-primary focus:ring-1 focus:ring-primary dark:text-gray-100"})]})]}),Z0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø§Ø³Ù… Ø§Ù„Ø±Ø§Ø³Ù„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsxs("div",{className:"relative",children:[e.jsx(mn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-gray-500"}),e.jsx(X,{id:"withdrawSenderNameInput",value:Tr,onChange:a=>wd(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("manualWithdrawCommissionInput");r==null||r.focus()}},placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø±Ø§Ø³Ù„ Ø¥Ù† ÙˆØ¬Ø¯",className:"pl-10 h-10 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 hover:border-blue-400 focus:border-blue-500 dark:text-gray-100",type:"text"})]})]}),(()=>{const a=dt();return a&&a.defaultWithdrawCommission!=null?e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (ØªÙ„Ù‚Ø§Ø¦ÙŠØ©)"}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Ø³ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„ÙƒÙ„ Ø£Ù„Ù: ",a==null?void 0:a.defaultWithdrawCommission," Ø¬Ù†ÙŠÙ‡ Ù„ÙƒÙ„ Ø£Ù„Ù"]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(A,{type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium",onClick:()=>{const i=dt(),c=parseFloat(jt||"0")||0,d=(i==null?void 0:i.defaultWithdrawCommission)!=null&&Number(i.defaultWithdrawCommission)||0,m=Math.round(d*c/1e3*100)/100,f=ct?c+m:c;Us((f||0).toString()),Ee?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Bs(!0)},children:"Ø£Ø¬Ù„"}),e.jsx(A,{type:"button",variant:ca?"default":"outline",size:"sm",className:ca?"bg-green-600 hover:bg-green-700 text-white font-medium ring-2 ring-green-400 ring-offset-2":"bg-blue-600 hover:bg-blue-700 text-white font-medium",onClick:()=>Zo(!ca),children:ca?"Ø¥Ù„ØºØ§Ø¡ Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡":"Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡"})]}),ca&&e.jsxs("div",{className:"mt-2 text-sm font-semibold text-green-600 animate-in fade-in slide-in-from-top-1",children:["Ø³ÙŠØªÙ… ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø¹Ù…ÙŠÙ„: ",(()=>{const i=dt(),c=parseFloat(jt||"0")||0,d=(i==null?void 0:i.defaultWithdrawCommission)!=null&&Number(i.defaultWithdrawCommission)||0,m=Math.round(d*c/1e3*100)/100;return Math.round((c-m)*100)/100})()," Ø¬Ù†ÙŠÙ‡"]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (Ø¬Ù†ÙŠÙ‡)"}),e.jsxs("div",{className:"relative",children:[e.jsx(Da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-yellow-600"}),e.jsx(X,{id:"manualWithdrawCommissionInput",value:yt,onChange:i=>qn(i.target.value),onKeyDown:i=>{if(i.key==="Enter"){const c=document.getElementById("withdrawSubmitButton");c==null||c.focus()}},placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",type:"number",className:"pl-10 h-10 md:h-11 lg:h-12 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 hover:border-blue-400 focus:border-blue-500 dark:text-gray-100"})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(A,{type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium",onClick:()=>{const i=dt(),c=parseFloat(jt||"0")||0;let d=0;if((i==null?void 0:i.defaultWithdrawCommission)!=null){const f=Number(i.defaultWithdrawCommission)||0;d=Math.round(f*c/1e3*100)/100}else{const f=yt&&yt.trim()!==""?parseFloat(yt):Math.round(c*.01*100)/100;d=Math.max(0,f)}const m=ct?c+d:c;Us((m||0).toString()),Ee?w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Bs(!0)},children:"Ø£Ø¬Ù„"}),e.jsx(A,{type:"button",variant:ca?"default":"outline",size:"sm",className:ca?"bg-green-600 hover:bg-green-700 text-white font-medium ring-2 ring-green-400 ring-offset-2":"bg-blue-600 hover:bg-blue-700 text-white font-medium",onClick:()=>Zo(!ca),children:ca?"Ø¥Ù„ØºØ§Ø¡ Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡":"Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡"})]}),ca&&e.jsxs("div",{className:"mt-2 text-sm font-semibold text-green-600 animate-in fade-in slide-in-from-top-1",children:["Ø³ÙŠØªÙ… ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø¹Ù…ÙŠÙ„: ",(()=>{const i=parseFloat(jt||"0")||0,c=yt&&yt.trim()!==""?parseFloat(yt):Math.round(i*.01*100)/100,d=Math.max(0,c);return Math.round((i-d)*100)/100})()," Ø¬Ù†ÙŠÙ‡"]})]})})(),(n==null?void 0:n.showWithdrawNote)&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø³Ø­Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsxs("div",{className:"relative group",children:[e.jsx(rc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-primary"}),e.jsx(X,{id:"withdrawNoteInput",value:gs,onChange:a=>vd(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("withdrawSubmitButton");r==null||r.focus()}},placeholder:"Ø£Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ø³Ø­Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",className:"pl-10 h-10 text-base border-gray-400 dark:border-gray-600 rounded-xl focus:border-primary focus:ring-1 focus:ring-primary bg-white dark:bg-gray-900 dark:text-gray-100 dark:placeholder:text-gray-400"})]})]}),e.jsx("div",{className:"sticky bottom-0 z-20 pt-2 pb-2 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-800 backdrop-blur supports-[backdrop-filter]:bg-white/90 dark:supports-[backdrop-filter]:bg-gray-900/90",children:e.jsx(A,{id:"withdrawSubmitButton",onClick:dm,disabled:Fc||Xo,className:"w-full font-medium h-11 lg:h-12 text-sm lg:text-base bg-green-600 hover:bg-green-700 text-white disabled:opacity-70 disabled:cursor-not-allowed",children:Fc?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°...":Xo?Mf||"ØªÙ… Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³Ø­Ø¨"})})]}),e.jsx(ue,{open:_o,onOpenChange:Bs,children:e.jsxs(me,{children:[e.jsxs(be,{children:[e.jsx(he,{children:"ØªØ­ÙˆÙŠÙ„ Ù…Ø¤Ø¬Ù„"}),e.jsx(Ze,{children:"Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ø­Ø¨ Ø§Ù„Ø¯ÙŠÙ† ÙˆØ§Ù„Ù…Ø¨Ù„Øº ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø«Ù… Ø§Ø¶ØºØ· Ø­ÙØ¸"})]}),e.jsxs("div",{className:"space-y-3",children:[Ct&&Ct.length>0?e.jsxs("div",{children:[e.jsx(Z,{children:"Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù…ÙŠÙ„"}),e.jsxs(Va,{value:Mo,onValueChange:a=>{z0(a);const r=Ct.find(i=>i.id===a);r&&Po(r.name)},children:[e.jsx(qa,{className:"w-full",children:e.jsx(za,{placeholder:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„"})}),e.jsx(Ya,{children:Ct.map(a=>e.jsxs(la,{value:a.id,children:[a.name,a.mobile?` â€” ${a.mobile}`:""]},a.id))})]})]}):e.jsx("div",{className:"text-xs text-gray-500",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…ÙØ³Ø¬Ù„ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹. ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ù…Ù† Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†."}),e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"quickDebtName",children:"Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ø¯ÙŠÙ†"}),e.jsx(X,{id:"quickDebtName",value:To,onChange:a=>Po(a.target.value),placeholder:"Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…"})]}),e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"quickDebtAmount",children:"Ø§Ù„Ù…Ø¨Ù„Øº (Ù…Ø­Ø³ÙˆØ¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)"}),e.jsx(X,{id:"quickDebtAmount",type:"number",value:q0,readOnly:!0,placeholder:"Ø§Ù„Ù…Ø¨Ù„Øº + Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„"})]}),e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"quickDebtCommission",children:"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (Ù…Ø­Ø³ÙˆØ¨Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)"}),e.jsx(X,{id:"quickDebtCommission",type:"number",value:function(){const a=dt(),r=parseFloat((jt||"0").toString())||0;let i=0;if(B==="transfer")if((a==null?void 0:a.defaultTransferCommission)!=null){const c=Number(a.defaultTransferCommission)||0;i=Math.round(c*r/1e3*100)/100}else{const c=Ot&&Ot.trim()!==""?parseFloat(Ot):0;i=Math.max(0,c)}else if((a==null?void 0:a.defaultWithdrawCommission)!=null){const c=Number(a.defaultWithdrawCommission)||0;i=Math.round(c*r/1e3*100)/100}else{const c=yt&&yt.trim()!==""?parseFloat(yt):Math.round(r*.01*100)/100;i=Math.max(0,c)}return String(i||0)}(),readOnly:!0,placeholder:"Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©",className:"dark:bg-gray-800 dark:border-gray-700 dark:text-gray-300"})]}),e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"quickDebtNotes",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª"}),e.jsx(X,{id:"quickDebtNotes",value:Nd,onChange:a=>jd(a.target.value),placeholder:"Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"})]})]}),e.jsx($e,{children:e.jsx(A,{type:"button",variant:"default",className:"bg-green-600 text-white hover:bg-green-700",onClick:()=>{const a=dt(),r=parseFloat((jt||"").toString())||0;let i=0;if(B==="transfer")if((a==null?void 0:a.defaultTransferCommission)!=null){const m=Number(a.defaultTransferCommission)||0;i=Math.round(m*r/1e3*100)/100}else{const m=Ot&&Ot.trim()!==""?parseFloat(Ot):0;i=Math.max(0,m)}else if((a==null?void 0:a.defaultWithdrawCommission)!=null){const m=Number(a.defaultWithdrawCommission)||0;i=Math.round(m*r/1e3*100)/100}else{const m=yt&&yt.trim()!==""?parseFloat(yt):Math.round(r*.01*100)/100;i=Math.max(0,m)}const c=Math.max(0,Math.round((r+i)*100)/100);if(!To||isNaN(c)||c<=0){w({title:"Ø®Ø·Ø£ ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¬Ù„",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­",variant:"destructive"});return}const d=Ct.find(m=>m.id===Mo);Oo({debtorName:To,amount:c,notes:Nd,customerId:Mo||void 0,mobile:d==null?void 0:d.mobile}),Sd(!1),Bs(!1),w({title:"ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¬Ù„",description:"Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙŠÙ† Ø¹Ù†Ø¯ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",variant:"default"})},children:"Ø­ÙØ¸"})})]})})]})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mt-8 fade-in-up w-full",children:[e.jsxs(A,{variant:"outline",size:"sm",onClick:()=>Le("https://www.youtube.com/watch?v=CRHOlK3LZas","Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙˆØ§Ù„Ø³Ø­Ø¨ Ø§Ù„ÙŠØ¯ÙˆÙŠ"),className:"flex-1 min-w-[200px] max-w-sm h-9 text-xs justify-center bg-white text-indigo-600 border-indigo-200 hover:bg-indigo-50 shadow-sm",children:[e.jsx(Ki,{className:"h-3.5 w-3.5 ml-1.5"}),"Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙˆØ§Ù„Ø³Ø­Ø¨ Ø§Ù„ÙŠØ¯ÙˆÙŠ"]}),e.jsxs(A,{variant:"outline",size:"sm",onClick:()=>Le("https://www.youtube.com/watch?v=1_h1iFLDBaY","Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±"),className:"flex-1 min-w-[200px] max-w-sm h-9 text-xs justify-center bg-white text-emerald-600 border-emerald-200 hover:bg-emerald-50 shadow-sm",children:[e.jsx(Ki,{className:"h-3.5 w-3.5 ml-1.5"}),"Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±"]})]})]})]}),e.jsx(uN,{isOpen:gf,onClose:()=>{qs(!1),zs(!1)},initialEditingWallet:yf,autoStartAdd:pf,onWalletUpdate:async()=>{try{await Hl()}catch(a){console.error("Error reloading wallets after update:",a)}}}),e.jsx(mN,{isOpen:jf,onClose:()=>Rd(!1),transaction:Nf,onDelete:Ql}),e.jsx(ue,{open:Af,onOpenChange:Fr,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsxs(be,{children:[e.jsx(he,{children:"ØªØ£ÙƒÙŠØ¯ ØªØµÙÙŠØ± ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±"}),e.jsx(Ze,{children:"Ø³ÙŠØªÙ… ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© ØªØµÙÙŠØ± Ø´Ø§Ù…Ù„Ø© Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ ØªØ£ÙƒÙŠØ¯Ùƒ."})]}),e.jsxs("div",{className:"space-y-2 text-sm text-right",children:[e.jsx("p",{children:"Ø¹Ù†Ø¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø³ÙŠØªÙ…:"}),e.jsxs("ul",{className:"list-disc pr-5 space-y-1",children:[e.jsx("li",{children:"Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ù† ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±."}),e.jsx("li",{children:"Ø­Ø°Ù Ù†ÙØ³ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù…Ù† ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø§."}),e.jsx("li",{children:"ØªØµÙÙŠØ± Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ… ÙˆØ£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª."})]}),e.jsx("p",{className:"text-red-600 font-medium",children:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ© Ø¨Ø¹Ø¯ ØªÙ†ÙÙŠØ°Ù‡Ø§."})]}),e.jsxs($e,{className:"flex flex-row justify-between gap-2",children:[e.jsx(A,{type:"button",variant:"outline",onClick:()=>Fr(!1),children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{type:"button",variant:"destructive",onClick:hm,children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØµÙÙŠØ±"})]})]})}),e.jsx(ta,{open:If,onOpenChange:ys,onSuccess:pp,title:xp(),description:yp(),mode:"verify",userId:t==null?void 0:t.uid,userRole:n==null?void 0:n.role}),e.jsx(sh,{open:Ig,onOpenChange:Iu,onSuccess:vp,title:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬",currentBalance:qe,balanceLabel:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ",userId:t==null?void 0:t.uid}),e.jsx(sh,{open:Ag,onOpenChange:Au,onSuccess:wp,title:"ØªØ¹Ø¯ÙŠÙ„ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",currentBalance:Kt&&De[Kt]||0,balanceLabel:`Ø±ØµÙŠØ¯ ${((pm=ae.find(a=>a.id===Kt))==null?void 0:pm.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©"}`,userId:t==null?void 0:t.uid}),e.jsx(yN,{open:_g,onOpenChange:Il,onSuccess:Np,title:"Ø¥Ø¶Ø§ÙØ© Ø£Ùˆ Ø®ØµÙ… Ù…Ø¨Ù„Øº Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡ Ø£Ùˆ Ø®ØµÙ…Ù‡ Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",currentBalance:Kt&&De[Kt]||0,balanceLabel:`Ø±ØµÙŠØ¯ ${((xm=ae.find(a=>a.id===Kt))==null?void 0:xm.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©"}`,userId:t==null?void 0:t.uid}),e.jsx(fN,{open:Ug,onOpenChange:Vg,userId:t==null?void 0:t.uid}),e.jsx(gN,{open:qg,onOpenChange:zg,userId:t==null?void 0:t.uid}),e.jsx(pN,{open:Yg,onOpenChange:Kg}),e.jsx(ue,{open:Mg,onOpenChange:yi,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(he,{className:"text-right",children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"})}),e.jsxs("div",{className:"space-y-1 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{htmlFor:"amount",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(X,{id:"amount",type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:_l,onChange:a=>bi(a.target.value),className:"text-right flex-1",dir:"rtl",min:"0"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(A,{type:"button",size:"sm",className:"bg-green-600 hover:bg-green-700 text-white px-3 py-2",onClick:async()=>{if(!await Ei(Ul)){w({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}const a=parseFloat(_l);if(isNaN(a)||a<=0){w({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const r=qe+a;lt(r);const i={cashBalance:r,lastUpdated:new Date().toISOString()},c=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(c,JSON.stringify(i)),t!=null&&t.uid?se.updateUserData(t.uid,i).then(()=>{console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø±ØµÙŠØ¯ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­"),localStorage.removeItem(c),we(!1)}).catch(d=>{console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø±ØµÙŠØ¯ ÙÙŠ Firebase:",d),we(!0)}):we(!0),w({title:"ØªÙ… Ø¨Ù†Ø¬Ø§Ø­",description:`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${a} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙˆØ­ÙØ¸Ù‡ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©`}),yi(!1),bi(""),Si("")},children:[e.jsx(Lt,{className:"h-1 w-1 mr-1"}),"Ø¥Ø¶Ø§ÙØ©"]}),e.jsxs(A,{id:"confirm-deduct-cash-btn",type:"button",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2",onClick:async()=>{if(!await Ei(Ul)){w({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}const a=parseFloat(_l);if(isNaN(a)||a<=0){w({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const r=qe-a;lt(r);const i={cashBalance:r,lastUpdated:new Date().toISOString()},c=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(c,JSON.stringify(i)),t!=null&&t.uid?se.updateUserData(t.uid,i).then(()=>{console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø±ØµÙŠØ¯ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­"),localStorage.removeItem(c),we(!1)}).catch(d=>{console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø±ØµÙŠØ¯ ÙÙŠ Firebase:",d),we(!0)}):we(!0),w({title:"ØªÙ… Ø¨Ù†Ø¬Ø§Ø­",description:`ØªÙ… Ø®ØµÙ… ${a} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙˆØ­ÙØ¸Ù‡ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©`}),yi(!1),bi(""),Si("")},children:[e.jsx(zi,{className:"h-1 w-1 mr-1"}),"Ø®ØµÙ…"]})]})]}),e.jsxs("p",{className:"text-[10px] text-gray-500 text-right",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",qe.toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{htmlFor:"pin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ"}),e.jsx(X,{id:"pin",type:"password",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",value:Ul,onChange:a=>Si(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("confirm-deduct-cash-btn");r&&r.click()}},className:"text-right",dir:"rtl"})]})]}),e.jsx($e,{className:"flex gap-2",children:e.jsx(A,{variant:"outline",onClick:()=>{yi(!1),bi(""),Si("")},children:"Ø¥Ù„ØºØ§Ø¡"})})]})}),e.jsx(ue,{open:Zg,onOpenChange:Pi,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(he,{className:"text-right text-red-600",children:"ØªØµÙÙŠØ± Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©"})}),e.jsxs("div",{className:"space-y-1 py-4",children:[e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-red-800 font-medium mb-2",children:"ØªØ­Ø°ÙŠØ±!"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Ø³ÙŠØªÙ… ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø¥Ù„Ù‰ ØµÙØ±. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."}),e.jsxs("p",{className:"text-red-600 text-sm mt-2",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",ae.reduce((a,r)=>a+(Number(De[r.id])||0),0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{htmlFor:"resetWalletTotalPin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"}),e.jsx(X,{id:"resetWalletTotalPin",type:"password",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",value:sm,onChange:a=>Mi(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("confirm-reset-wallet-total-btn"))==null||r.click())},className:"text-right",dir:"rtl"})]})]}),e.jsxs($e,{className:"flex gap-2",children:[e.jsx(A,{variant:"outline",onClick:()=>{Pi(!1),Mi("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{id:"confirm-reset-wallet-total-btn",variant:"destructive",onClick:async()=>{if(!await Jt.verifyMasterPin(sm,t==null?void 0:t.uid)){w({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}try{const r={};Object.keys(De).forEach(m=>{r[m]=0}),ft(r),localStorage.setItem(ot(),JSON.stringify(r)),Pi(!1),Mi("");const i=new Date().toISOString(),c={walletBalances:r,lastUpdated:i},d=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(d,JSON.stringify(c)),t!=null&&t.uid?se.updateUserData(t.uid,c).then(()=>{localStorage.removeItem(d),we(!1)}).catch(m=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",m),we(!0),w({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù‚Ø±ÙŠØ¨Ø§Ù‹",variant:"default"})}):we(!0),setTimeout(()=>{ft({...r})},100)}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸:",r),w({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸",variant:"destructive"})}},children:"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})]})]})}),e.jsx(ue,{open:Tg,onOpenChange:pi,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(he,{className:"text-right text-red-600",children:"ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©"})}),e.jsxs("div",{className:"space-y-1 py-4",children:[e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-red-800 font-medium mb-2",children:"ØªØ­Ø°ÙŠØ±!"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Ø³ÙŠØªÙ… ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ø¥Ù„Ù‰ ØµÙØ±. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."}),e.jsxs("p",{className:"text-red-600 text-sm mt-2",children:["Ø§Ù„Ù…Ø­ÙØ¸Ø©: ",((ym=ae.find(a=>a.id===R))==null?void 0:ym.name)||R]}),e.jsxs("p",{className:"text-red-600 text-sm",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",(R&&De[R]?De[R]:0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{htmlFor:"resetSelectedWalletPin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"}),e.jsx(X,{id:"resetSelectedWalletPin",type:"password",autoComplete:"off",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",value:_u,onChange:a=>Al(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("confirm-reset-selected-wallet-btn"))==null||r.click())},className:"text-right",dir:"rtl"})]})]}),e.jsxs($e,{className:"flex gap-2",children:[e.jsx(A,{variant:"outline",onClick:()=>{pi(!1),Al("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{id:"confirm-reset-selected-wallet-btn",variant:"destructive",onClick:async()=>{var r;if(!R){w({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}if(!await Jt.verifyMasterPin(_u,t==null?void 0:t.uid)){w({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}try{const i={...De};i[R]=0,ft(i),localStorage.setItem(ot(),JSON.stringify(i)),pi(!1),Al("");const c=new Date().toISOString(),d={walletBalances:i,lastUpdated:c},m=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(m,JSON.stringify(d)),t!=null&&t.uid?se.updateUserData(t.uid,d).then(()=>{localStorage.removeItem(m),we(!1)}).catch(f=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",f),we(!0),w({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù‚Ø±ÙŠØ¨Ø§Ù‹",variant:"default"})}):we(!0),w({title:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ø¨Ù†Ø¬Ø§Ø­",description:`ØªÙ… ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ${((r=ae.find(f=>f.id===R))==null?void 0:r.name)||R}`})}catch(i){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:",i),w({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",variant:"destructive"})}},children:"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})]})]})}),e.jsx(rh,{isOpen:Ft,onClose:()=>ya(!1),wallets:ae}),e.jsx(ue,{open:Qg,onOpenChange:Ai,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsxs(he,{className:"text-right text-green-600 flex items-center gap-2 justify-end",children:[e.jsx(Lt,{className:"h-4 w-4"}),"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„ Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("p",{className:"text-green-800 font-medium mb-2",children:"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„"}),e.jsx("p",{className:"text-green-700 text-sm",children:"Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø¥Ù„Ù‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ø´ÙƒÙ„ Ù…ØªÙ†Ø§Ø³Ø¨ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙØ¸."}),e.jsxs("p",{className:"text-green-600 text-sm mt-2",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",ae.reduce((a,r)=>a+(Number(De[r.id])||0),0).toLocaleString()," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"addWalletTotalAmount",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡"}),e.jsx(X,{id:"addWalletTotalAmount",type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:Ku,onChange:a=>ql(a.target.value),className:"text-right",dir:"rtl"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"addWalletTotalPin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„ØªØ£ÙƒÙŠØ¯"}),e.jsx(X,{id:"addWalletTotalPin",type:"password",autoComplete:"off",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",value:Ju,onChange:a=>zl(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("confirm-add-wallet-total-btn"))==null||r.click())},className:"text-right",dir:"rtl"})]})]})]}),e.jsxs($e,{className:"flex gap-2",children:[e.jsx(A,{variant:"outline",onClick:()=>{Ai(!1),ql(""),zl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{id:"confirm-add-wallet-total-btn",variant:"default",className:"bg-green-600 hover:bg-green-700",disabled:Hu,onClick:async()=>{const a=parseFloat(Ku);if(!a||a<=0){w({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}if(!await sp(Ju)){w({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}Qu(!0);try{const r=ae.reduce((c,d)=>c+(Number(De[d.id])||0),0),i={...De};if(r===0){if(ae.length>0){const c=a/ae.length;ae.forEach(d=>{i[d.id]=(Number(i[d.id])||0)+c})}}else ae.forEach(c=>{const d=Number(De[c.id])||0,m=d/r,f=a*m;i[c.id]=d+f});ft(i),localStorage.setItem(ot(),JSON.stringify(i)),t!=null&&t.uid?await se.updateUserData(t.uid,{walletBalances:i,lastUpdated:new Date().toISOString()}):we(!0),setTimeout(()=>{ft(c=>({...c}))},100),Ai(!1),ql(""),zl("")}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",r),w({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",variant:"destructive"})}finally{Qu(!1)}},children:Hu?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©...":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù…ÙˆØ§Ù„"})]})]})}),e.jsx(ue,{open:ep,onOpenChange:Oi,children:e.jsxs(me,{className:"sm:max-w-[425px]",children:[e.jsx(be,{children:e.jsxs(he,{className:"text-red-600 flex items-center gap-2",children:[e.jsx(Sa,{className:"h-1 w-1"}),"ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ"]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-red-700",children:"âš ï¸ ØªØ­Ø°ÙŠØ±: Ø³ÙŠØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬ Ø¥Ù„Ù‰ ØµÙØ±. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{htmlFor:"resetCashPin",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"}),e.jsx(X,{id:"resetCashPin",type:"password",autoComplete:"off",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",value:Yl,onChange:a=>Kl(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("confirm-reset-cash-btn"))==null||r.click())}})]})]}),e.jsxs($e,{children:[e.jsx(A,{variant:"outline",onClick:()=>{Oi(!1),Kl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{id:"confirm-reset-cash-btn",variant:"destructive",onClick:async()=>{if(!Yl){w({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}if(!await Jt.verifyMasterPin(Yl,t==null?void 0:t.uid)){w({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}try{lt(0),Oi(!1),Kl("");const r={cashBalance:0,lastUpdated:new Date().toISOString()};localStorage.setItem(at(),"0"),localStorage.setItem(at()+"_lastUpdated",r.lastUpdated);const i=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(i,JSON.stringify(r)),t!=null&&t.uid?se.updateUserData(t.uid,r).then(()=>{localStorage.removeItem(i),we(!1)}).catch(c=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø±ØµÙŠØ¯ ÙÙŠ Firebase:",c),we(!0),w({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù‚Ø±ÙŠØ¨Ø§Ù‹",variant:"default"})}):we(!0)}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ:",r),w({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ",variant:"destructive"})}},children:"ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯"})]})]})}),e.jsx(wN,{open:Hg,onOpenChange:Yu,userId:t==null?void 0:t.uid,cashBalance:qe,walletBalances:De,transactions:ye}),e.jsx(ue,{open:Jg,onOpenChange:Gr,children:e.jsxs(me,{className:"sm:max-w-[425px]",children:[e.jsx(be,{children:e.jsxs(he,{className:"text-green-600 flex items-center gap-2",children:[e.jsx(Lt,{className:"h-4 w-4"}),"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„ Ù„Ù„Ø¯Ø±Ø¬"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-green-700",children:"ðŸ’° Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"addCashAmount",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡"}),e.jsx(X,{id:"addCashAmount",type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:ws,onChange:a=>Di(a.target.value),min:"0",step:"0.01"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{className:"text-right",children:"Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(A,{type:"button",variant:Zr==="yes"?"default":"outline",onClick:()=>en("yes"),className:"flex-1",children:"Ù†Ø¹Ù…"}),e.jsx(A,{type:"button",variant:Zr==="no"?"default":"outline",onClick:async()=>{if(en("no"),!ws||parseFloat(ws)<=0){w({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±",variant:"destructive"});return}if(!Xr){w({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}if(!await Ei(Xr)){w({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}Ci(!0);try{const a=parseFloat(ws),r=qe+a;lt(r);const i=new Date().toISOString();localStorage.setItem(at(),r.toString()),localStorage.setItem(at()+"_lastUpdated",i);const c={cashBalance:r,lastUpdated:i},d=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(d,JSON.stringify(c));const m=`CASHADD-${(t==null?void 0:t.uid)||"anon"}-${Date.now()}`;Gr(!1),Di(""),ki(""),en(null),Ii("");const f=[];if(t!=null&&t.uid){f.push(se.updateUserData(t.uid,c).then(()=>{localStorage.removeItem(d),we(!1)}).catch(()=>{we(!0)}));const g={txnType:"cash_addition",type:"cash_addition",amount:a,status:"confirmed",senderMsisdn:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",receiverMsisdn:"",reference:m,title:"Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",merchantUserId:t.uid,createdBy:t.uid,shopId:(n==null?void 0:n.shopId)||void 0};f.push(se.saveUserTransaction(t.uid,g));const y=n==null?void 0:n.shopId;if(y){const b=Me(F,"dashboardData",y);f.push(ea(b,{cashBalance:r}))}}Promise.allSettled(f).then(()=>{}).catch(()=>{})}catch{lt(qe),localStorage.setItem("cashBalance",qe.toString()),w({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",variant:"destructive"})}finally{Ci(!1)}},className:"flex-1",children:"Ù„Ø§"})]})]}),Zr==="yes"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"addCashNote",children:"Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©"}),e.jsx(X,{id:"addCashNote",type:"text",placeholder:"Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©",value:Vl,onChange:a=>Ii(a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"addCashPin",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),e.jsx(X,{id:"addCashPin",type:"password",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",value:Xr,onChange:a=>ki(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("confirm-add-cash-btn"))==null||r.click())}})]})]}),e.jsxs($e,{children:[e.jsx(A,{variant:"outline",onClick:()=>{Gr(!1),Di(""),ki(""),en(null),Ii("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{id:"confirm-add-cash-btn",variant:"default",className:"bg-green-600 hover:bg-green-700",disabled:zu,onClick:async()=>{if(!ws||parseFloat(ws)<=0){w({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±",variant:"destructive"});return}if(!Xr){w({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}if(!await Ei(Xr)){w({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}if(Zr==="yes"&&Vl.trim().length===0){w({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø£Ùˆ Ø§Ø®ØªØ± Ù„Ø§",variant:"destructive"});return}Ci(!0);try{const a=parseFloat(ws),r=qe+a;lt(r);const i=new Date().toISOString();localStorage.setItem(at(),r.toString()),localStorage.setItem(at()+"_lastUpdated",i);const c={cashBalance:r,lastUpdated:i},d=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(d,JSON.stringify(c));const m=`CASHADD-${(t==null?void 0:t.uid)||"anon"}-${Date.now()}`;Gr(!1),Di(""),ki(""),en(null),Ii("");const f=[];if(t!=null&&t.uid){f.push(se.updateUserData(t.uid,c).then(()=>{localStorage.removeItem(d),we(!1)}).catch(()=>{we(!0)}));const g={txnType:"cash_addition",type:"cash_addition",amount:a,status:"confirmed",senderMsisdn:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",receiverMsisdn:"",reference:m,note:Zr==="yes"?Vl.trim():void 0,title:"Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",merchantUserId:t.uid,createdBy:t.uid,shopId:(n==null?void 0:n.shopId)||void 0};f.push(se.saveUserTransaction(t.uid,g));const y=n==null?void 0:n.shopId;if(y){const b=Me(F,"dashboardData",y);f.push(ea(b,{cashBalance:r}))}}Promise.allSettled(f).then(()=>{}).catch(()=>{})}catch{lt(qe),localStorage.setItem("cashBalance",qe.toString()),w({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",variant:"destructive"})}finally{Ci(!1)}},children:zu?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©...":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù…ÙˆØ§Ù„"})]})]})}),e.jsx(ue,{open:Sg,onOpenChange:Cl,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(he,{className:"text-right",children:"Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª Ù„Ù„Ø¨Ø­Ø«"})}),e.jsxs("div",{className:"space-y-1 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{htmlFor:"search-date",className:"text-right block",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx(X,{id:"search-date",type:"date",value:Xn,onChange:a=>Bd(a.target.value),className:"text-right"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{htmlFor:"search-time",className:"text-right block",children:"Ø§Ù„ÙˆÙ‚Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx(X,{id:"search-time",type:"time",value:Zn,onChange:a=>Ud(a.target.value),className:"text-right",placeholder:"Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª Ù„Ù„Ø¨Ø­Ø« ÙÙŠ Ø³Ø§Ø¹Ø© Ù…Ø­Ø¯Ø¯Ø©"}),e.jsx("p",{className:"text-[10px] text-gray-500 text-right",children:"Ø¥Ø°Ø§ Ù„Ù… ØªØ®ØªØ± ÙˆÙ‚ØªØ§Ù‹ Ù…Ø­Ø¯Ø¯Ø§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ø¨Ø­Ø« ÙÙŠ ÙƒØ§Ù…Ù„ Ø§Ù„ÙŠÙˆÙ…"})]})]}),e.jsxs($e,{className:"flex justify-between",children:[e.jsx(A,{variant:"outline",onClick:()=>{Bd(""),Ud(""),Cl(!1)},children:"Ù…Ø³Ø­"}),e.jsx(A,{onClick:()=>Cl(!1),children:"ØªØ·Ø¨ÙŠÙ‚"})]})]})}),e.jsx(bN,{isOpen:$f,onClose:()=>Jd(!1)}),e.jsx(Em,{isOpen:Ta,onClose:()=>ia(!1),userId:(t==null?void 0:t.uid)||"",userEmail:(t==null?void 0:t.email)||""}),e.jsx(vN,{isOpen:Ko,onClose:()=>Wr(!1),initialBarcode:hf}),e.jsx(NN,{isOpen:zf,onClose:()=>ti(!1)}),e.jsx(kN,{open:Yf,onOpenChange:ai}),e.jsx(CN,{open:Kf,onOpenChange:a=>{if(a&&!ma){w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"});return}si(a)}}),e.jsx(PN,{open:l0,onOpenChange:a=>{if(a&&!ma){w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒÙƒ.",variant:"destructive"});return}Tn(a)}}),e.jsx(MN,{open:c0,onOpenChange:a=>{if(a&&!ma){w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒÙƒ.",variant:"destructive"});return}d0(a)}}),e.jsx(ta,{open:Eg,onOpenChange:Ru,onSuccess:()=>Ml(!0),title:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",mode:"verify",userId:t==null?void 0:t.uid,userRole:n==null?void 0:n.role}),e.jsx(ue,{open:Pl,onOpenChange:Ml,children:e.jsxs(me,{className:"sm:max-w-xl",children:[e.jsxs(be,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(ic,{className:"h-4 w-4 text-blue-600"}),"ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…"]}),e.jsx(Ze,{children:"Ù…Ù„Ø®Øµ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ… Ù…Ø­ÙÙˆØ¸ Ù„Ø¢Ø®Ø± 30 ÙŠÙˆÙ…Ù‹Ø§ Ù…Ø¹ Ø£Ø±Ø´ÙØ© ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©"})]}),e.jsxs("div",{className:"space-y-4",children:[(()=>{const a=new Date().toDateString(),r=ye.filter(g=>{const y=new Date(g.createdAt).toDateString(),b=String(g.status||"completed").toLowerCase();return y===a&&(b==="completed"||b==="confirmed")}),i=r.length,c=r.reduce((g,y)=>g+Number(y.amount||0),0),d=r.filter(g=>g.type==="withdraw").reduce((g,y)=>g+Number(y.amount||0),0),m=r.filter(g=>g.type==="send").reduce((g,y)=>g+Number(y.amount||0),0),f=r.reduce((g,y)=>g+Number(vt.calculateTransactionProfit(y)||0),0);return e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-blue-50 to-slate-100 border",children:[e.jsx("div",{className:"text-xs text-blue-700",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),e.jsx("div",{className:"text-lg font-bold text-blue-800",children:i})]}),e.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-indigo-50 to-slate-100 border",children:[e.jsx("div",{className:"text-xs text-indigo-700",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº"}),e.jsx("div",{className:"text-lg font-bold text-indigo-800",children:Number(c).toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-red-50 to-slate-100 border",children:[e.jsx("div",{className:"text-xs text-red-700",children:"Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø©"}),e.jsx("div",{className:"text-lg font-bold text-red-800",children:Number(d).toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-green-50 to-slate-100 border",children:[e.jsx("div",{className:"text-xs text-green-700",children:"Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ù…Ø±Ø³Ù„Ø©"}),e.jsx("div",{className:"text-lg font-bold text-green-800",children:Number(m).toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"col-span-2 rounded-lg p-3 bg-gradient-to-r from-amber-50 to-slate-100 border",children:[e.jsx("div",{className:"text-xs text-amber-700",children:"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),e.jsx("div",{className:"text-lg font-bold text-amber-800",children:Number(f).toLocaleString("en-US",{maximumFractionDigits:0})})]})]})})(),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{variant:"default",onClick:async()=>{try{if(!(t!=null&&t.uid))return;const a=new Date,r=a.getFullYear(),i=String(a.getMonth()+1).padStart(2,"0"),c=String(a.getDate()).padStart(2,"0"),d=`${r}-${i}-${c}`,m=a.toDateString(),f=ye.filter(v=>{const S=new Date(v.createdAt).toDateString(),I=String(v.status||"completed").toLowerCase();return S===m&&(I==="completed"||I==="confirmed")}),g=f.length,y=f.reduce((v,S)=>v+Number(S.amount||0),0),b=f.filter(v=>v.type==="withdraw").reduce((v,S)=>v+Number(S.amount||0),0),x=f.filter(v=>v.type==="send").reduce((v,S)=>v+Number(S.amount||0),0),N=f.reduce((v,S)=>v+Number(vt.calculateTransactionProfit(S)||0),0);await rr.add({userId:t.uid,reportDate:d,totalTransactions:g,totalAmount:Math.round(y),totalWithdrawn:Math.round(b),totalSent:Math.round(x),profit:Math.round(N),walletId:null});try{await rr.trimToMaxCount(t.uid,30)}catch{}w({title:"ØªÙ… Ø§Ù„Ø£Ø±Ø´ÙØ©",description:`ØªÙ… Ø­ÙØ¸ ØªÙ‚Ø±ÙŠØ± ${d}`})}catch{w({title:"ÙØ´Ù„ Ø§Ù„Ø£Ø±Ø´ÙØ©",description:"ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±",variant:"destructive"})}},children:"Ø£Ø±Ø´ÙØ© Ø§Ù„ÙŠÙˆÙ…"}),e.jsx(A,{variant:"outline",onClick:()=>Ml(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})]}),e.jsx("div",{className:"mt-2 border-t pt-2",children:e.jsx("div",{className:"space-y-2 max-h-[40vh] overflow-auto",children:Wu.length===0?e.jsx("div",{className:"text-xs text-muted-foreground",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø­ÙÙˆØ¸Ø©"}):Wu.map(a=>e.jsxs("div",{className:"border rounded-md p-2 bg-gradient-to-r from-white/80 to-blue-50/70",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-bold text-blue-800",children:a.reportDate}),e.jsxs("div",{className:"text-xs text-blue-700",children:["Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª: ",a.totalTransactions]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-1",children:[e.jsxs("div",{className:"text-xs text-blue-800",children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº: ",e.jsx("span",{className:"font-semibold",children:Number(a.totalAmount).toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"text-xs text-blue-800",children:["Ø§Ù„Ù…Ø³Ø­ÙˆØ¨: ",e.jsx("span",{className:"font-semibold",children:Number(a.totalWithdrawn).toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"text-xs text-blue-800",children:["Ø§Ù„Ù…Ø±Ø³Ù„: ",e.jsx("span",{className:"font-semibold",children:Number(a.totalSent).toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"text-xs text-blue-800",children:["Ø§Ù„Ø±Ø¨Ø­: ",e.jsx("span",{className:"font-semibold",children:Number(a.profit??0).toLocaleString("en-US",{maximumFractionDigits:0})})]})]})]},a.id||`${a.userId}-${a.reportDate}`))})})]})]})}),e.jsx(ue,{open:Og,onOpenChange:a=>{if(a){w({title:"Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹."});return}Tl(!1)},children:e.jsxs(me,{dir:"rtl",className:"sm:max-w-md w-[95vw] sm:w-auto rounded-2xl border border-emerald-200 shadow-xl bg-gradient-to-br from-white via-green-50 to-emerald-50 backdrop-blur-md data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-90 data-[state=open]:slide-in-from-bottom-8 duration-300",children:[e.jsxs(be,{children:[e.jsx(he,{className:"text-right text-green-700",children:"Ø´Ø­Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),e.jsx(Ze,{className:"text-right text-gray-600",children:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø«Ù… Ø§Ø¶ØºØ· ØªØ£ÙƒÙŠØ¯"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"topupPhone",className:"text-right block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),e.jsx(X,{id:"topupPhone",value:vi,onChange:a=>Tu(a.target.value),placeholder:"010xxxxxxx",className:"text-right"})]}),e.jsxs("div",{children:[e.jsx(Z,{className:"text-right block",children:"Ø´Ø±ÙƒØ© Ø§Ù„ØªØ´ØºÙŠÙ„"}),e.jsxs(Va,{value:wi,onValueChange:Pu,children:[e.jsx(qa,{className:"text-right",children:e.jsx(za,{placeholder:"Ø§Ø®ØªØ± Ø§Ù„Ø´Ø±ÙƒØ©"})}),e.jsxs(Ya,{children:[e.jsx(la,{value:"vodafone",children:"ÙÙˆØ¯Ø§ÙÙˆÙ†"}),e.jsx(la,{value:"orange",children:"Ø£ÙˆØ±Ù†Ø¬"}),e.jsx(la,{value:"etisalat",children:"Ø§ØªØµØ§Ù„Ø§Øª"}),e.jsx(la,{value:"we",children:"WE"})]})]})]}),e.jsxs("div",{children:[e.jsx(Z,{htmlFor:"topupAmount",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡"}),e.jsx(X,{id:"topupAmount",type:"number",value:Ni,onChange:a=>Mu(a.target.value?Number(a.target.value):""),placeholder:"50",className:"text-right"})]})]}),e.jsxs($e,{className:"flex gap-2 justify-between",children:[e.jsx(A,{variant:"outline",onClick:()=>Tl(!1),className:"border-gray-300",children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{onClick:o0,disabled:Ou||!vi||!wi||!Ni,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:Ou?"Ø¬Ø§Ø±Ù Ø§Ù„ØªÙ†ÙÙŠØ°...":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø´Ø­Ù†"})]})]})}),e.jsx(ta,{open:sg,onOpenChange:nl,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ÙØªØ­ Ø§Ù„Ø¯ÙŠÙˆÙ†",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†",className:"!bg-[#0f172a] !text-slate-100 border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",onSuccess:()=>{nl(!1),Ks(!0)},userId:t==null?void 0:t.uid,userRole:n==null?void 0:n.role}),e.jsx(ta,{open:ng,onOpenChange:su,mode:"verify",title:"ØªØ£ÙƒÙŠØ¯ ØªØºÙŠÙŠØ± Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ø¯ÙŠÙˆÙ†",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªÙØ¹ÙŠÙ„ Ø£Ùˆ Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ø¯ÙŠÙˆÙ†",userId:t==null?void 0:t.uid,userRole:n==null?void 0:n.role,onSuccess:async()=>{if(ru!==null){const a=ru;au(a);try{const r=t==null?void 0:t.uid,i=r?`debtsPinRequired_${r}`:"debtsPinRequired";localStorage.setItem(i,String(a)),r&&await se.updateUserData(r,{debtsPinRequired:a})}catch{}w({title:a?"ØªÙ… ØªÙØ¹ÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ø¯ÙŠÙˆÙ†":"ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ø¯ÙŠÙˆÙ†",description:a?"Ø³ÙŠÙØ·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†.":"ÙŠÙ…ÙƒÙ† ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙŠÙˆÙ† Ø¨Ø¯ÙˆÙ† Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ."})}ig(null),su(!1)}}),e.jsx(xN,{open:Pg,onOpenChange:xi,title:"ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶",description:"Ø³ÙŠØªÙ… Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù…Ù† Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙÙ‚Ø·ØŒ ÙˆÙ„Ù† ØªÙØ­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ Ù…Ù† Ø­Ø³Ø§Ø¨Ùƒ Ø£Ùˆ Ù…Ù† Firebase.",onSuccess:async()=>{try{if(!(t!=null&&t.uid)){xi(!1);return}const a=new Date,r=c=>c instanceof Date?c:typeof(c==null?void 0:c.toDate)=="function"?c.toDate():new Date(String(c)),i=ye.filter(c=>r(c.createdAt)<a);await se.updateUserData(t.uid,{recentReset:{keepLastCount:Xu.keepLastCount??30,intervalDays:Xu.intervalDays??7,lastResetAt:a}}),_i(c=>({...c,lastResetAt:a})),w({title:"ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©",description:"ØªÙ… Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø£Ù‚Ø¯Ù… Ù…Ù† ÙˆÙ‚Øª Ø§Ù„ØªØµÙÙŠØ± Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ø¯ÙˆÙ† Ø§Ù„ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…/Ø§Ù„Ø´Ù‡Ø± Ø£Ùˆ Ø§Ù„Ø­Ø¯ÙˆØ¯."})}catch(a){console.error("ÙØ´Ù„ ØªÙ†ÙÙŠØ° Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:",a),w({title:"ÙØ´Ù„ Ø§Ù„ØªØµÙÙŠØ±",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø«Ù… Ø£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.",variant:"destructive"})}finally{xi(!1)}}}),e.jsx(ta,{open:R0,onOpenChange:jr,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ÙØªØ­ Ù†Ø§ÙØ°Ø© Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„",onSuccess:()=>{jr(!1),Es(!0)},userId:t==null?void 0:t.uid,userRole:n==null?void 0:n.role}),e.jsx(ue,{open:In,onOpenChange:An,children:e.jsxs(me,{className:"sm:max-w-md md:max-w-lg border border-blue-100 dark:border-blue-900 bg-gradient-to-b from-blue-50 via-white to-blue-50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950 shadow-2xl rounded-2xl px-4 py-4",children:[e.jsxs(be,{className:"text-right space-y-2",children:[e.jsxs(he,{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-lg font-extrabold text-blue-800 dark:text-blue-100",children:"Ù…ØªØ¬Ø±Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"}),e.jsx("span",{className:"px-2 py-0.5 text-[10px] rounded-full bg-blue-100 text-blue-700 dark:bg-blue-900/60 dark:text-blue-200",children:"Ø®Ø¯Ù…Ø© Ù…ØªÙ‚Ø¯Ù…Ø©"})]}),e.jsx(Ze,{className:"text-xs leading-relaxed text-gray-700 dark:text-gray-200",children:"Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ù…ØªØ¬Ø±Ùƒ ØªÙ‚Ø¯Ø± ØªÙ†Ø´Ø¦ Ù…ØªØ¬Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØªØ¹Ø±Ø¶ Ø¹Ù„ÙŠÙ‡ Ù…Ù†ØªØ¬Ø§ØªÙƒØŒ ÙˆØ§Ù„Ù†Ø§Ø³ ØªØ¯Ø®Ù„ Ø¹Ù„ÙŠÙ‡ ÙˆØªØ·Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØªØ´Ø­Ù†Ù‡Ø§Ù„Ù‡Ù…ØŒ ÙˆÙ…Ø¹Ø§Ùƒ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ÙƒØ§Ù…Ù„Ø© Ø¹Ù„Ø´Ø§Ù† ØªØ¯ÙŠØ± Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØªØ¶ÙŠÙ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØªØªØ§Ø¨Ø¹ Ù…Ø¨ÙŠØ¹Ø§ØªÙƒ Ù…Ù† Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯."})]}),e.jsxs("div",{className:"mt-3 space-y-2 text-xs text-gray-700 dark:text-gray-200 text-right",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-blue-500"}),e.jsx("p",{children:"Ø§Ø¹Ø±Ø¶ Ù…Ù†ØªØ¬Ø§ØªÙƒ Ø¨ØµÙˆØ± ÙˆØ£Ø³Ø¹Ø§Ø± ÙˆÙˆØµÙ Ù…Ù†Ø¸Ù… Ù„ÙƒÙ„ Ù…Ù†ØªØ¬."})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-blue-500"}),e.jsx("p",{children:"Ø§Ø³ØªÙ‚Ø¨Ù„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† ÙˆØªØ§Ø¨Ø¹ Ø­Ø§Ù„Ø© ÙƒÙ„ Ø·Ù„Ø¨ Ø¨Ø³Ù‡ÙˆÙ„Ø©."})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-blue-500"}),e.jsx("p",{children:"ØªØ§Ø¨Ø¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ÙˆØ§Ù„Ø£Ø±Ø¨Ø§Ø­ Ù…Ù† Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¨Ø³ÙŠØ·Ø© ÙˆØ³Ø±ÙŠØ¹Ø©."})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-2",children:[e.jsx(A,{className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white text-sm h-9",onClick:()=>{window.open("https://naweshop.com/login","_blank","noopener,noreferrer"),An(!1)},children:"Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…ØªØ¬Ø±"}),e.jsx(A,{variant:"outline",className:"flex-1 text-xs h-9 border-gray-300 text-gray-700 dark:text-gray-200",onClick:()=>An(!1),children:"Ù„Ø§Ø­Ù‚Ù‹Ø§"})]})]})}),e.jsx(ue,{open:ag,onOpenChange:Ks,children:e.jsxs(me,{className:"sm:max-w-[425px] border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[e.jsxs(be,{className:"flex items-center justify-between",children:[e.jsx(he,{className:"text-right",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†"}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-emerald-700",children:[e.jsx("span",{className:"text-[10px] font-bold",children:"Ù„ÙŠÙ†Ø§:"}),e.jsxs("span",{className:"text-xs font-bold",children:[mm.creditor," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-red-700",children:[e.jsx("span",{className:"text-[10px] font-bold",children:"Ø¹Ù„ÙŠÙ†Ø§:"}),e.jsxs("span",{className:"text-xs font-bold",children:[mm.debtor," Ø¬Ù†ÙŠÙ‡"]})]})]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(A,{variant:"outline",onClick:()=>lu(wa==="debtor"?null:"debtor"),className:Ia("w-full transition-all duration-200",wa==="debtor"?"bg-red-600 hover:bg-red-700 text-white border-red-600":"border-red-200 text-red-700 hover:bg-red-50 hover:text-red-800"),children:"Ø¹Ù„ÙŠÙ†Ø§"}),e.jsx(A,{variant:"outline",onClick:()=>lu(wa==="creditor"?null:"creditor"),className:Ia("w-full transition-all duration-200",wa==="creditor"?"bg-emerald-600 hover:bg-emerald-700 text-white border-emerald-600":"border-emerald-200 text-emerald-700 hover:bg-emerald-50 hover:text-emerald-800"),children:"Ù„ÙŠÙ†Ø§"})]}),(wa==="creditor"||wa==="debtor")&&e.jsxs(e.Fragment,{children:[wa==="creditor"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Z,{htmlFor:"debtorName",className:"text-right col-span-1",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†"}),e.jsx(X,{id:"debtorName",value:il,onChange:a=>ol(a.target.value),className:"col-span-3 text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Z,{htmlFor:"customerSelect",className:"text-right col-span-1",children:"Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù…ÙŠÙ„"}),e.jsxs(Va,{value:ts,onValueChange:a=>{pl(a);const r=Ct.find(i=>i.id===a);r&&ol(r.name)},children:[e.jsx(qa,{className:"col-span-3 text-right",dir:"rtl",children:e.jsx(za,{placeholder:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†"})}),e.jsx(Ya,{className:"text-right",dir:"rtl",children:Ct.length>0?Ct.map(a=>e.jsxs(la,{value:a.id,className:"text-right",children:[a.name," ",a.mobile?`(${a.mobile})`:""]},a.id)):e.jsx("div",{className:"p-2 text-center text-gray-500 text-sm",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ø³Ø¬Ù„ÙŠÙ†"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Z,{htmlFor:"debtAmount",className:"text-right col-span-1",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx(X,{id:"debtAmount",type:"text",inputMode:"decimal",value:ll,onChange:a=>nu(Mr(a.target.value)),className:"col-span-3 text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Z,{htmlFor:"debtReason",className:"text-right col-span-1",children:"Ø³Ø¨Ø¨ Ø§Ù„Ø¯ÙŠÙ†"}),e.jsx(X,{id:"debtReason",value:iu,onChange:a=>ou(a.target.value),className:"col-span-3 text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø³Ø¨Ø¨ Ø§Ù„Ø¯ÙŠÙ†"})]})]})]}),e.jsx($e,{children:e.jsx(A,{onClick:()=>{const a=wa==="debtor";if(!a&&!(wa==="creditor")){w({title:"Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙŠÙ†",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¯ÙŠÙ† Ø£Ùˆ Ø¯Ø§Ø¦Ù† Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}const i=a?il||"Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…":il;if(!ll||!i){w({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù…Ø¨Ù„Øº",variant:"destructive"});return}const c={id:Date.now().toString(),debtorName:i,amount:parseFloat(ll),reason:iu||"",status:"pending",createdAt:new Date,paidAmount:0,partialPayments:[],type:wa||"creditor"};Jr(c),vs(a?"add":"deduct"),Qs(!0)},className:"bg-orange-500 hover:bg-orange-600",children:"Ø­ÙØ¸"})}),e.jsx("div",{className:"mt-2",children:e.jsx(A,{variant:"outline",className:"w-full",onClick:()=>bs(!0),children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†"})}),e.jsx("div",{className:"mt-2",children:e.jsx(A,{variant:"outline",className:"w-full",onClick:()=>ul(!0),children:"Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„"})}),e.jsx("div",{className:"mt-2",children:e.jsxs(A,{variant:"outline",className:"w-full text-rose-600 border-rose-200 hover:bg-rose-50 dark:border-rose-900/30 dark:text-rose-400 dark:hover:bg-rose-900/20",onClick:()=>Le("https://www.youtube.com/watch?v=v55ziGGuCWc","Ø´Ø±Ø­ Ù‚Ø³Ù… Ø§Ù„Ø¯ÙŠÙˆÙ† ÙˆØ§Ù„Ø§Ø¬Ù„ (ÙÙŠØ¯ÙŠÙˆ)"),children:[e.jsx(Ki,{className:"h-4 w-4 ml-2"}),"Ø´Ø±Ø­ Ù‚Ø³Ù… Ø§Ù„Ø¯ÙŠÙˆÙ† ÙˆØ§Ù„Ø§Ø¬Ù„ (ÙÙŠØ¯ÙŠÙˆ)"]})})]})}),e.jsx(ue,{open:cl,onOpenChange:bs,children:e.jsxs(me,{className:"w-[95vw] sm:w-auto sm:max-w-[520px] rounded-2xl border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[e.jsxs(be,{children:[e.jsx(he,{className:"text-right",children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†"}),e.jsx(Ze,{className:"text-right",children:"Ø§Ø®ØªØ± Ø¯ÙŠÙ†Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ø¥ÙŠØµØ§Ù„Ù‡ Ø¨Ø§Ù„ØªÙØµÙŠÙ„"})]}),e.jsx("div",{className:"px-1 mb-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(Wm,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"}),e.jsx(X,{placeholder:"Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ø¨Ù„Øº...",value:Kr,onChange:a=>pu(a.target.value),className:"pr-9 text-right"})]})}),_e.length>0?e.jsxs("div",{className:"max-h-[60vh] overflow-y-auto overscroll-contain scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400 space-y-2 px-1 -mx-1 sm:mx-0 sm:px-0",style:{contain:"layout paint"},onScroll:a=>{const r=a.currentTarget;mi.length<ui.length&&r.scrollTop+r.clientHeight>=r.scrollHeight-50&&di(i=>i+1)},children:[mi.length>0?mi.map(a=>e.jsx("div",{onClick:()=>{zr(a),es(!0),bs(!1),Ks(!1)},className:`p-4 sm:p-3 border rounded-xl cursor-pointer hover:bg-gray-50 transition-colors min-h-[64px] ${a.type==="debtor"?"border-r-4 border-r-red-500 bg-red-50/10":"border-r-4 border-r-emerald-500"}`,children:e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"text-right space-y-0.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium text-[14px] sm:text-sm",children:a.debtorName}),a.type==="debtor"&&e.jsx(Ba,{variant:"destructive",className:"h-5 text-[10px] px-1",children:"Ø¹Ù„ÙŠÙ†Ø§"}),(!a.type||a.type==="creditor")&&e.jsx(Ba,{variant:"outline",className:"h-5 text-[10px] px-1 text-emerald-700 border-emerald-200 bg-emerald-50",children:"Ù„Ù†Ø§"})]}),e.jsx("p",{className:"text-[13px] sm:text-sm text-gray-600",children:a.reason}),e.jsx("p",{className:"text-[12px] sm:text-sm text-gray-500",children:on.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("p",{className:"font-bold text-xl sm:text-lg",children:[(Number(a.amount||0)-Number(a.paidAmount||0)).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]}),e.jsx(Ba,{variant:a.status==="paid"?"default":"secondary",className:`${a.status==="paid"?"bg-green-500":"bg-yellow-500"} text-[12px] sm:text-xs`,children:a.status==="paid"?"Ù…Ø¯ÙÙˆØ¹":"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"})]})]})},a.id)):e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ø¨Ø­Ø«"})}),mi.length<ui.length&&e.jsx("div",{className:"flex justify-center pt-1",children:e.jsx(A,{variant:"outline",size:"sm",onClick:()=>di(a=>a+1),children:"ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯"})})]}):e.jsx("div",{className:"text-center text-sm text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙŠÙˆÙ† Ù…Ø³Ø¬Ù„Ø©"}),e.jsxs($e,{className:"flex justify-between mt-3",children:[e.jsx(A,{variant:"destructive",onClick:async()=>{try{if(!_e||_e.length===0){w({title:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙŠÙˆÙ†",description:"Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙØ§Ø±ØºØ© Ø¨Ø§Ù„ÙØ¹Ù„."});return}if(!window.confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù ÙƒÙ„ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†ØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."))return;const r=[];if(Yt(r),zr(null),await Wa(r),t!=null&&t.uid)try{await se.updateUserData(t.uid,{debts:[],debtsDeletedAt:wt()});try{localStorage.removeItem(`debts_unsynced_${t.uid}`)}catch{}}catch(i){console.error("ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ø¯ÙŠÙˆÙ† Ù…Ù† Firebase:",i),w({title:"ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©",description:"ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª Ù…Ù† FirebaseØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"});return}w({title:"ØªÙ… Ø­Ø°Ù ÙƒÙ„ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†",description:"ØªÙ… ØªÙØ±ÙŠØº Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„."}),bs(!1)}catch(a){console.error("ØªØ¹Ø°Ø± Ø­Ø°Ù ÙƒÙ„ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†:",a),w({title:"ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°ÙØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"})}},children:"Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª"}),e.jsx(A,{variant:"outline",onClick:()=>bs(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})]})]})}),e.jsx(ue,{open:Vo,onOpenChange:af,children:e.jsxs(me,{className:"max-w-2xl h-[80vh] flex flex-col p-0",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[e.jsxs(be,{className:"p-4 border-b",children:[e.jsx(he,{children:"Ø³Ø¬Ù„ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙˆÙ†"}),e.jsx(Ze,{children:"Ø¹Ø±Ø¶ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®"})]}),e.jsxs("div",{className:"p-4 border-b bg-gray-50 dark:bg-gray-900 flex flex-col sm:flex-row gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(Z,{children:"Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø­Ø«"}),e.jsxs("div",{className:"flex bg-white dark:bg-gray-800 rounded-md border p-1",children:[e.jsx("button",{onClick:()=>Td("day"),className:`flex-1 px-3 py-1.5 text-sm rounded-sm transition-colors ${ps==="day"?"bg-purple-100 text-purple-700 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"ÙŠÙˆÙ…ÙŠ"}),e.jsx("button",{onClick:()=>Td("month"),className:`flex-1 px-3 py-1.5 text-sm rounded-sm transition-colors ${ps==="month"?"bg-purple-100 text-purple-700 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Ø´Ù‡Ø±ÙŠ"})]})]}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(Z,{children:ps==="day"?"Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…":"Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±"}),e.jsx(X,{type:ps==="day"?"date":"month",value:ps==="day"?Vs:Vs.substring(0,7),onChange:a=>rf(a.target.value),className:"bg-white dark:bg-gray-800"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 mb-1",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØªØ±Ø©"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:ks(qo.reduce((a,r)=>a+(r.amount||0),0))})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-0",children:qo.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-gray-500",children:[e.jsx(Om,{className:"h-12 w-12 mb-2 opacity-20"}),e.jsx("p",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø³Ø¯Ø§Ø¯ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©"})]}):e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"grid grid-cols-3 bg-gray-50 dark:bg-gray-900 p-3 text-sm font-medium text-gray-500 border-b",children:[e.jsx("div",{className:"text-right",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx("div",{className:"text-right",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†"}),e.jsx("div",{className:"text-right",children:"Ø§Ù„Ù…Ø¨Ù„Øº"})]}),e.jsx("div",{className:"divide-y dark:divide-gray-800",children:qo.map(a=>{var r;return e.jsxs("div",{className:"grid grid-cols-3 p-3 items-center hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx("div",{className:"text-sm text-gray-500 font-mono",children:(r=a.createdAt)!=null&&r.seconds?new Date(a.createdAt.seconds*1e3).toLocaleString("ar-EG"):"Ø§Ù„Ø¢Ù†"}),e.jsx("div",{className:"font-medium",children:a.debtorName}),e.jsx("div",{className:"font-bold text-green-600",children:ks(a.amount)})]},a.id)})})]})})]})}),e.jsx(ue,{open:mg,onOpenChange:ul,children:e.jsxs(me,{className:"sm:max-w-[500px] w-full max-h-[90vh] overflow-hidden flex flex-col p-0 gap-0 !bg-[#0f172a] !text-slate-100 border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800 bg-[#0f172a]",children:[e.jsxs(be,{children:[e.jsx(he,{className:"text-right flex items-center justify-end",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mn,{className:"w-5 h-5 text-primary"}),"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ø¯ÙŠÙˆÙ†"]})}),e.jsx(Ze,{className:"text-right",children:"Ø³Ø¬Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ø¯ÙŠÙˆÙ† Ø¨Ø³Ù‡ÙˆÙ„Ø©"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",dir:"rtl",children:[e.jsx(A,{variant:Hs==="customers_list"?"default":"outline",onClick:()=>ml("customers_list"),size:"sm",className:"flex-1 text-xs h-8",children:"Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†"}),e.jsx(A,{variant:Hs==="add_debt"?"default":"outline",onClick:()=>ml("add_debt"),size:"sm",className:"flex-1 text-xs h-8",children:"ØªØ³Ø¬ÙŠÙ„ Ø¯ÙŠÙ†"}),e.jsx(A,{variant:Hs==="add_customer"?"default":"outline",onClick:()=>ml("add_customer"),size:"sm",className:"flex-1 text-xs h-8",children:"Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[Hs==="add_customer"&&e.jsxs(rs,{className:"border shadow-sm bg-white dark:bg-card dark:border-gray-800",children:[e.jsx(Ss,{className:"pb-2 pt-4 px-4",children:e.jsxs(Ds,{className:"text-sm font-medium text-right text-gray-700 dark:text-gray-200 flex items-center justify-end gap-2",children:[e.jsx(Lt,{className:"w-4 h-4"}),"Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯"]})}),e.jsxs(ns,{className:"p-4 pt-2 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{className:"text-right block text-xs text-gray-500 dark:text-gray-400",children:"Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„"}),e.jsx(X,{value:fl,onChange:a=>xu(a.target.value),className:"text-right h-9 dark:bg-gray-900 dark:border-gray-700",placeholder:"Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{className:"text-right block text-xs text-gray-500 dark:text-gray-400",children:"Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),e.jsx(X,{value:gl,onChange:a=>yu(a.target.value),className:"text-right h-9 dark:bg-gray-900 dark:border-gray-700",placeholder:"Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"})]}),e.jsxs(A,{className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white h-9 mt-2",onClick:async()=>{if(!fl||!gl){w({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„",variant:"destructive"});return}const a={id:Date.now().toString(),name:fl.trim(),mobile:gl.trim(),createdAt:new Date},r=[a,...Ct];await Ll(r),xu(""),yu(""),w({title:"ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„",description:`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${a.name}`})},children:[e.jsx(Lt,{className:"w-4 h-4 mr-2"}),"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„"]})]})]}),Hs==="add_debt"&&e.jsxs(rs,{className:"border shadow-sm bg-white dark:bg-card dark:border-gray-800",children:[e.jsx(Ss,{className:"pb-2 pt-4 px-4",children:e.jsxs(Ds,{className:"text-sm font-medium text-right text-gray-700 dark:text-gray-200 flex items-center justify-end gap-2",children:[e.jsx(Da,{className:"w-4 h-4 text-orange-600"}),"ØªØ³Ø¬ÙŠÙ„ Ù…Ø¨Ù„Øº Ø¯ÙŠÙ†"]})}),e.jsx(ns,{className:"p-4 pt-2 space-y-3",children:Ct.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{className:"text-right block text-xs text-gray-500 dark:text-gray-400",children:"Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…ÙŠÙ„"}),e.jsxs(Va,{value:ts,onValueChange:pl,children:[e.jsx(qa,{className:"w-full h-9 text-right dark:bg-gray-900 dark:border-gray-700",dir:"rtl",children:e.jsx(za,{placeholder:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„"})}),e.jsx(Ya,{className:"dark:bg-gray-900 dark:border-gray-800",children:Ct.map(a=>e.jsxs(la,{value:a.id,className:"text-right justify-end",children:[a.name," â€” ",a.mobile]},a.id))})]}),ts&&(()=>{const a=_e.filter(r=>r.customerId===ts&&r.status==="pending").reduce((r,i)=>r+(i.amount-(i.paidAmount||0)),0);return e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx(A,{variant:"ghost",size:"sm",className:"h-6 text-xs text-blue-600 hover:text-blue-700 hover:bg-blue-50 px-2",onClick:()=>{bg(ts),wl(!0)},children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø¯ÙŠÙˆÙ†Ù‡"}),a>0&&e.jsxs("div",{className:"text-xs text-red-600 font-semibold text-right",children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙŠÙˆÙ† Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ",a.toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})]})})()]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{className:"text-right block text-xs text-gray-500",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx(X,{type:"number",value:bu,onChange:a=>hg(a.target.value),className:"text-right h-9",placeholder:"0.00"})]}),e.jsx(A,{className:"w-full bg-orange-600 hover:bg-orange-700 text-white h-9 mt-2",onClick:async()=>{const a=parseFloat(bu);if(!ts){w({title:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}if(isNaN(a)||a<=0){w({title:"Ù‚ÙŠÙ…Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const r=Ct.find(c=>c.id===ts);if(!r)return;const i={id:Date.now().toString(),debtorName:r.name,customerId:r.id,mobile:r.mobile,amount:Math.round(a),reason:"Ø¯ÙŠÙ† Ø¹Ù…ÙŠÙ„",status:"pending",createdAt:new Date,paidAmount:0,partialPayments:[]};Jr(i),Qs(!0)},children:"Ù…ØªØ§Ø¨Ø¹Ø© ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº"})]}):e.jsx("div",{className:"text-center py-4 text-gray-500 text-sm bg-gray-50 rounded border border-dashed",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ø³Ø¬Ù„ÙŠÙ†. Ø£Ø¶Ù Ø¹Ù…ÙŠÙ„Ø§Ù‹ Ø£ÙˆÙ„Ø§Ù‹."})})]}),Hs==="customers_list"&&e.jsxs(rs,{className:"border shadow-sm bg-white dark:bg-card dark:border-gray-800",children:[e.jsx(Ss,{className:"pb-2 pt-4 px-4",children:e.jsxs(Ds,{className:"text-sm font-medium text-right text-gray-700 dark:text-gray-200 flex items-center justify-end gap-2",children:[e.jsx(Vm,{className:"w-4 h-4"}),"Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† (",Ct.length,")"]})}),e.jsx(ns,{className:"p-4 pt-2",children:Ct.length>0?e.jsx("div",{className:"space-y-2",children:Ct.map(a=>e.jsxs("div",{className:"p-3 border rounded-lg flex items-center justify-between bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors dark:border-gray-700",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8 text-blue-600 hover:text-blue-700 hover:bg-blue-50",onClick:()=>{vu(a.id),xl(a.name||""),yl(a.mobile||""),hi(!0)},children:e.jsx(Bm,{className:"h-4 w-4"})}),e.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>{bl(a.id),vl(a.name||""),fi(!0)},children:e.jsx(Sa,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:a.name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono",children:a.mobile})]})]},a.id))}):e.jsx("div",{className:"text-center py-4 text-gray-400 text-sm",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§"})})]})]}),e.jsx($e,{className:"p-4 border-t bg-white dark:bg-card dark:border-gray-800",children:e.jsx(A,{variant:"outline",className:"w-full sm:w-auto dark:bg-gray-800 dark:text-white dark:border-gray-700 dark:hover:bg-gray-700",onClick:()=>ul(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(ue,{open:yg,onOpenChange:wl,children:e.jsxs(me,{className:"sm:max-w-[500px] max-h-[80vh] overflow-hidden flex flex-col p-0 gap-0",children:[e.jsx("div",{className:"p-4 border-b bg-white dark:bg-card dark:border-gray-800",children:e.jsxs(be,{children:[e.jsxs(he,{className:"text-right flex items-center justify-end gap-2 dark:text-gray-100",children:[e.jsx(Bi,{className:"w-5 h-5 text-blue-600"}),"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„"]}),e.jsx(Ze,{className:"text-right dark:text-gray-400",children:(bm=Ct.find(a=>a.id===Nl))==null?void 0:bm.name})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50/50 dark:bg-black/50",children:[_e.filter(a=>a.customerId===Nl).sort((a,r)=>new Date(r.createdAt).getTime()-new Date(a.createdAt).getTime()).map(a=>e.jsxs("div",{className:"p-3 border rounded-lg bg-white dark:bg-card dark:border-gray-700 shadow-sm flex justify-between items-center",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-sm dark:text-gray-100",children:[(Number(a.amount||0)-Number(a.paidAmount||0)).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:a.reason}),e.jsx(Ba,{variant:a.status==="paid"?"default":"secondary",className:`mt-1 h-5 text-[10px] ${a.status==="paid"?"bg-green-500":"bg-yellow-500 text-yellow-950"}`,children:a.status==="paid"?"Ù…Ø¯ÙÙˆØ¹":"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"})]}),e.jsxs("div",{className:"text-left text-xs text-gray-400 flex flex-col items-end gap-1",children:[e.jsx("div",{className:"font-mono",children:on.format(new Date(a.createdAt))}),e.jsx("div",{className:"font-mono",children:new Date(a.createdAt).toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit"})})]})]},a.id)),_e.filter(a=>a.customerId===Nl).length===0&&e.jsxs("div",{className:"text-center text-gray-500 py-8 flex flex-col items-center gap-2",children:[e.jsx(Bi,{className:"w-8 h-8 text-gray-300"}),e.jsx("span",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥ÙŠØµØ§Ù„Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„"})]})]}),e.jsx($e,{className:"p-4 border-t bg-white dark:bg-card dark:border-gray-800",children:e.jsx(A,{variant:"outline",className:"w-full dark:bg-gray-800 dark:text-white dark:border-gray-700 dark:hover:bg-gray-700",onClick:()=>wl(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(ue,{open:pg,onOpenChange:fi,children:e.jsxs(me,{hideClose:!0,className:"sm:max-w-[420px] rounded-2xl bg-gradient-to-br from-white via-rose-50 to-red-50 dark:from-gray-900 dark:via-red-950/30 dark:to-red-900/10 shadow-2xl border border-red-100 dark:border-red-900/50 text-center",children:[e.jsxs(be,{children:[e.jsx(he,{className:"text-center text-xl font-bold text-red-700 dark:text-red-400",children:"ØªØ£ÙƒÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„"}),e.jsxs(Ze,{className:"text-center text-gray-600 dark:text-gray-300",children:["Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§: ",ju]})]}),e.jsx("div",{className:"py-2 text-sm text-gray-700 dark:text-gray-400",children:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡."}),e.jsxs($e,{className:"flex justify-center gap-3",children:[e.jsx(A,{variant:"outline",onClick:()=>{fi(!1),bl(""),vl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{variant:"destructive",className:"bg-red-600 hover:bg-red-700",onClick:async()=>{const a=xg,r=Ct.filter(i=>i.id!==a);await Ll(r),ts===a&&pl(""),fi(!1),bl(""),vl(""),w({title:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„",description:ju})},children:"Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ"})]})]})}),e.jsx(ue,{open:fg,onOpenChange:hi,children:e.jsxs(me,{className:"sm:max-w-[420px]",children:[e.jsx(be,{children:e.jsx(he,{className:"text-right",children:"ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Z,{htmlFor:"editCustomerName",className:"text-right col-span-1",children:"Ø§Ù„Ø§Ø³Ù…"}),e.jsx(X,{id:"editCustomerName",value:wu,onChange:a=>xl(a.target.value),className:"col-span-3 text-right"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Z,{htmlFor:"editCustomerMobile",className:"text-right col-span-1",children:"Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),e.jsx(X,{id:"editCustomerMobile",value:Nu,onChange:a=>yl(a.target.value),className:"col-span-3 text-right"})]})]}),e.jsxs($e,{className:"flex justify-between",children:[e.jsx(A,{variant:"outline",onClick:()=>hi(!1),children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{const a=gg,r=wu.trim(),i=Nu.trim();if(!a||!r||!i){w({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„",variant:"destructive"});return}const c=Ct.map(m=>m.id===a?{...m,name:r,mobile:i}:m);await Ll(c);const d=_e.map(m=>m.customerId===a?{...m,debtorName:r,mobile:i}:m);d!==_e&&(Yt(d),await Wa(d)),hi(!1),vu(""),xl(""),yl(""),w({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù…ÙŠÙ„",description:r})},children:"Ø­ÙØ¸"})]})]})}),e.jsx(ue,{open:E0,onOpenChange:Es,children:e.jsxs(me,{className:"sm:max-w-[520px]",children:[e.jsxs(be,{children:[e.jsx(he,{className:"text-right",children:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„"}),e.jsx(Ze,{className:"text-right",children:"Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ØµØ±ÙˆÙ Ø«Ù… Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø®ØµÙ…."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Z,{htmlFor:"expenseName",className:"text-right col-span-1",children:"Ø§Ø³Ù… Ø§Ù„Ù…ØµØ±ÙˆÙ"}),e.jsx(X,{id:"expenseName",value:Wn,onChange:a=>od(a.target.value),className:"col-span-3 text-right",placeholder:"Ù…Ø«Ø§Ù„: ÙƒÙ‡Ø±Ø¨Ø§Ø¡ØŒ ØµÙŠØ§Ù†Ø©ØŒ Ù…Ø´ØªØ±ÙŠØ§Øª"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Z,{htmlFor:"expenseAmount",className:"text-right col-span-1",children:"ØªÙ…Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"}),e.jsx(X,{id:"expenseAmount",type:"number",value:wo,onChange:a=>ld(a.target.value),className:"col-span-3 text-right",placeholder:"0.00"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Z,{htmlFor:"expenseNotes",className:"text-right col-span-1",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª"}),e.jsx(X,{id:"expenseNotes",value:No,onChange:a=>cd(a.target.value),className:"col-span-3 text-right",placeholder:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¥Ù† ÙˆØ¬Ø¯Øª"})]})]}),e.jsxs($e,{className:"flex justify-between",children:[e.jsx(A,{className:"bg-orange-600 hover:bg-orange-700",onClick:()=>{if(!Wn||!wo){w({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ØµØ±ÙˆÙ ÙˆÙ‚ÙŠÙ…ØªÙ‡",variant:"destructive"});return}Fn(!0)},children:"Ø¥Ø¶Ø§ÙØ© Ù…ØµØ±ÙˆÙ"}),e.jsx(A,{variant:"outline",onClick:()=>Do(!0),children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ"})]})]})}),e.jsx(ue,{open:L0,onOpenChange:Do,children:e.jsxs(me,{className:"sm:max-w-[420px]",dir:"rtl",children:[e.jsxs(be,{children:[e.jsx(he,{className:"text-right",children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ"}),e.jsx(Ze,{className:"text-right",children:"Ø¢Ø®Ø± Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©"})]}),Ln.length>0?e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Ln.map(a=>e.jsx("div",{className:"p-2 border rounded-lg bg-white dark:bg-card dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-sm dark:text-gray-200",children:a.name}),e.jsx("p",{className:"text-[11px] text-gray-600 dark:text-gray-400",children:a.notes||"Ø¨Ø¯ÙˆÙ† Ù…Ù„Ø§Ø­Ø¸Ø§Øª"}),e.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-500",children:new Date(a.createdAt).toLocaleString("ar-EG")})]}),e.jsxs("div",{className:"text-left flex items-start gap-2",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("p",{className:"font-bold text-sm dark:text-gray-200",children:[a.amount," Ø¬Ù†ÙŠÙ‡"]}),e.jsx(Ba,{variant:"secondary",className:a.source==="cash"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",children:a.source==="cash"?"Ù…Ù† Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©":`Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©${a.walletId?` (${a.walletId})`:""}`})]}),e.jsxs(A,{variant:"destructive",size:"sm",className:"shrink-0",onClick:()=>Lg(a.id),title:"Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ",children:[e.jsx(Sa,{className:"w-4 h-4 ml-1"}),"Ø­Ø°Ù"]})]})]})},a.id))}):e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØµØ§Ø±ÙŠÙ Ù…Ø³Ø¬Ù„Ø© Ø¨Ø¹Ø¯"})]})}),e.jsx(ue,{open:W0,onOpenChange:Fn,children:e.jsxs(me,{className:"sm:max-w-[480px]",children:[e.jsx(be,{children:e.jsx(he,{className:"text-right",children:"Ø§Ø®ØªÙŠØ§Ø± Ù…ØµØ¯Ø± Ø®ØµÙ… Ø§Ù„Ù…ØµØ±ÙˆÙ"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-right",children:"Ø§Ø®ØªØ± Ù‡Ù„ ØªØ±ÙŠØ¯ Ø®ØµÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØµØ±ÙˆÙ Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬ Ø£Ù… Ù…Ù† Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸."}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(A,{variant:Tt==="cash"?"default":"outline",className:Tt==="cash"?"bg-blue-600 hover:bg-blue-700 text-white":"",onClick:()=>Sr("cash"),children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),e.jsx(A,{variant:Tt==="wallet"?"default":"outline",className:Tt==="wallet"?"bg-purple-600 hover:bg-purple-700 text-white":"",onClick:()=>Sr("wallet"),children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),e.jsx(A,{variant:Tt==="fawry"?"default":"outline",className:Tt==="fawry"?"bg-amber-600 hover:bg-amber-700 text-white":"",onClick:()=>Sr("fawry"),children:"ÙÙˆØ±ÙŠ"})]}),Tt==="wallet"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{className:"text-right block",children:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…"}),e.jsxs(Va,{value:Rs,onValueChange:So,children:[e.jsx(qa,{className:"w-full",children:e.jsx(za,{placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©"})}),e.jsx(Ya,{children:ae.map(a=>e.jsx(la,{value:a.id,children:a.phone||a.name||a.id},a.id))})]})]})]}),e.jsxs($e,{className:"flex justify-between",children:[e.jsx(A,{variant:"outline",onClick:()=>{Fn(!1),Sr(null),So("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{const a=Number(wo);if(isNaN(a)||a<=0){w({title:"Ù‚ÙŠÙ…Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}if(!Tt){w({title:"Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø®ØµÙ…",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}try{if(Tt==="cash"){const d=Math.round(qe-a);lt(d),localStorage.setItem(at(),d.toString());const m={cashBalance:d,lastUpdated:new Date().toISOString()},f=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(f,JSON.stringify(m)),t!=null&&t.uid?(await se.updateUserData(t.uid,m),localStorage.removeItem(f),we(!1)):we(!0)}else if(Tt==="wallet"){if(!Rs){w({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…",variant:"destructive"});return}const d=De[Rs]||0,m=Math.round(d-a),f={...De,[Rs]:m};ft(f);const g=new Date().toISOString(),y={walletBalances:f,lastUpdated:g},b=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(b,JSON.stringify(y)),localStorage.setItem(ot(),JSON.stringify(f)),localStorage.setItem(`walletBalances_backup_${g}`,JSON.stringify(f)),t!=null&&t.uid&&se.updateUserData(t.uid,y).catch(()=>{})}}catch(d){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø¹Ù†Ø¯ Ø­ÙØ¸ Ø§Ù„Ù…ØµØ±ÙˆÙ:",d)}let r=Date.now().toString();try{if(t!=null&&t.uid){const{addDoc:d,collection:m,serverTimestamp:f}=await le(async()=>{const{addDoc:b,collection:x,serverTimestamp:N}=await import("./index-DhbnydJl.js").then(v=>v.cP);return{addDoc:b,collection:x,serverTimestamp:N}},__vite__mapDeps([0,1]),import.meta.url),{db:g}=await le(async()=>{const{db:b}=await import("./index-DhbnydJl.js").then(x=>x.cQ);return{db:b}},__vite__mapDeps([0,1]),import.meta.url);r=(await d(m(g,"shop_expenses"),{userId:t.uid,shopId:k||(n==null?void 0:n.shopId)||t.uid||"default-shop",name:Wn,amount:a,notes:No||"",source:Tt,walletId:Tt==="wallet"?Rs:null,createdAt:f()})).id}}catch(d){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…ØµØ±ÙˆÙ ÙÙŠ Firestore:",d)}const i={id:r,name:Wn,amount:a,notes:No,source:Tt,walletId:Tt==="wallet"?Rs:void 0,createdAt:new Date},c=[...Ln,i];await Uu(c),od(""),ld(""),cd(""),Sr(null),So(""),Fn(!1),Es(!0),Do(!0),w({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ØµØ±ÙˆÙ",description:Tt==="cash"?"ØªÙ… Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©":Tt==="wallet"?"ØªÙ… Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸":"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± ÙÙˆØ±ÙŠ"})},children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø®ØµÙ…"})]})]})}),e.jsx(ue,{open:$0,onOpenChange:Dr,children:e.jsxs(me,{className:"sm:max-w-[520px]",children:[e.jsxs(be,{children:[e.jsx(he,{className:"text-right",children:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"}),e.jsx(Ze,{className:"text-right",children:"Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Ø§Ù‚ØµØ© Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ø´Ø±Ø§Ø¡ ÙˆØªØ§Ø¨Ø¹ Ø­Ø§Ù„ØªÙ‡Ø§."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Z,{htmlFor:"deficiencyName",className:"text-right col-span-1",children:"Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±"}),e.jsx(X,{id:"deficiencyName",value:kr,onChange:a=>ko(a.target.value),className:"col-span-3 text-right",placeholder:"Ù…Ø«Ø§Ù„: Ø³ÙƒØ±ØŒ Ø²ÙŠØªØŒ Ù…Ù†Ø§Ø¯ÙŠÙ„"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Z,{htmlFor:"deficiencyQuantity",className:"text-right col-span-1",children:"Ø§Ù„ÙƒÙ…ÙŠØ©"}),e.jsx(X,{id:"deficiencyQuantity",type:"number",value:dd,onChange:a=>Co(a.target.value),className:"col-span-3 text-right",placeholder:"1"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(A,{className:"bg-rose-600 hover:bg-rose-700",onClick:()=>{if(Ee){w({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}const a=parseInt(dd||"1",10);if(!kr){w({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±",variant:"destructive"});return}if(isNaN(a)||a<=0){w({title:"ÙƒÙ…ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ…ÙŠØ© ØµØ­ÙŠØ­Ø©",variant:"destructive"});return}(async()=>{if(t!=null&&t.uid)try{const{collection:i,addDoc:c,serverTimestamp:d}=await le(async()=>{const{collection:g,addDoc:y,serverTimestamp:b}=await import("./index-DhbnydJl.js").then(x=>x.cP);return{collection:g,addDoc:y,serverTimestamp:b}},__vite__mapDeps([0,1]),import.meta.url),{db:m}=await le(async()=>{const{db:g}=await import("./index-DhbnydJl.js").then(y=>y.cQ);return{db:g}},__vite__mapDeps([0,1]),import.meta.url),f=await c(i(m,"deficiencies"),{userId:t.uid,shopId:k||(n==null?void 0:n.shopId)||t.uid||"default-shop",name:kr,quantity:a,status:"pending",createdAt:d()});try{const g=ji(),y=localStorage.getItem(g),b=y?JSON.parse(y):[],x=Array.isArray(b)?b:[],N=x.some(I=>String((I==null?void 0:I.id)||"")===f.id),v={id:f.id,name:kr,quantity:a,status:"pending",createdAt:new Date().toISOString()},S=N?x:[...x,v];localStorage.setItem(g,JSON.stringify(S))}catch{}ko(""),Co(""),w({title:"ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©",description:"ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†ØµØ± Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"});return}catch(i){console.warn("ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ø¥Ù„Ù‰ FirestoreØŒ Ø³ÙŠÙØ³ØªØ®Ø¯Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",i)}const r={id:Date.now().toString(),name:kr,quantity:a,status:"pending",createdAt:new Date};Ws(i=>{const c=[...i,r];return Wl(c),c}),ko(""),Co(""),w({title:"ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©",description:"ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†ØµØ± Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"})})()},children:"Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù†ÙˆØ§Ù‚Øµ"})}),ud.length>0?e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:ud.map(a=>e.jsx("div",{className:"p-2 border rounded-lg bg-white dark:bg-card dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-sm dark:text-gray-200",children:a.name}),e.jsxs("p",{className:"text-[11px] text-gray-600 dark:text-gray-400",children:["Ø§Ù„ÙƒÙ…ÙŠØ©: ",a.quantity]}),e.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-500",children:new Date(a.createdAt).toLocaleString("ar-EG")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ba,{variant:"secondary",className:a.status==="pending"?"bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-300":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:a.status==="pending"?"Ù‚ÙŠØ¯ Ø§Ù„Ø´Ø±Ø§Ø¡":"ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡"}),e.jsx(A,{variant:"outline",className:a.status==="pending"?"text-green-700 border-green-300 hover:bg-green-50":"text-rose-700 border-rose-300 hover:bg-rose-50",onClick:()=>{(async()=>{const r=a.status==="pending"?"purchased":"pending";if(t!=null&&t.uid)try{const{doc:i,updateDoc:c,serverTimestamp:d}=await le(async()=>{const{doc:f,updateDoc:g,serverTimestamp:y}=await import("./index-DhbnydJl.js").then(b=>b.cP);return{doc:f,updateDoc:g,serverTimestamp:y}},__vite__mapDeps([0,1]),import.meta.url),{db:m}=await le(async()=>{const{db:f}=await import("./index-DhbnydJl.js").then(g=>g.cQ);return{db:f}},__vite__mapDeps([0,1]),import.meta.url);await c(i(m,"deficiencies",a.id),{status:r,updatedAt:d()});return}catch(i){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ø¹Ù„Ù‰ FirestoreØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",i)}Ws(i=>{const c=i.map(d=>d.id===a.id?{...d,status:r}:d);return Wl(c),c})})()},title:a.status==="pending"?"ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡":"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø´Ø±Ø§Ø¡",children:a.status==="pending"?"ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡":"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø´Ø±Ø§Ø¡"}),e.jsx(A,{variant:"outline",className:"text-red-700 border-red-300 hover:bg-red-50",onClick:()=>{(async()=>{if(t!=null&&t.uid)try{const{doc:r,deleteDoc:i}=await le(async()=>{const{doc:d,deleteDoc:m}=await import("./index-DhbnydJl.js").then(f=>f.cP);return{doc:d,deleteDoc:m}},__vite__mapDeps([0,1]),import.meta.url),{db:c}=await le(async()=>{const{db:d}=await import("./index-DhbnydJl.js").then(m=>m.cQ);return{db:d}},__vite__mapDeps([0,1]),import.meta.url);await i(r(c,"deficiencies",a.id));return}catch(r){console.warn("ÙØ´Ù„ Ø­Ø°Ù Ø¹Ù†ØµØ± Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ù…Ù† FirestoreØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",r)}Ws(r=>{const i=r.filter(c=>c.id!==a.id);return Wl(i),i})})()},title:"Ø­Ø°Ù",children:"Ø­Ø°Ù"})]})]})},a.id))}):e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³Ø¬Ù„Ø© ÙÙŠ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"})]}),e.jsx($e,{className:"flex justify-end",children:e.jsx(A,{variant:"outline",onClick:()=>Dr(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(ue,{open:B0,onOpenChange:a=>{$n(a),a||(Un(null),Cr(""),Ir(""))},children:e.jsxs(me,{className:"sm:max-w-[520px]",children:[e.jsxs(be,{children:[e.jsx(he,{className:"text-right",children:"Ø£Ø±Ù‚Ø§Ù…ÙŠ Ù…Ø¹ Ø¹Ù…Ù„Ø§Ø¦ÙŠ"}),e.jsx(Ze,{className:"text-right",children:"Ø§Ø³ØªØ¹Ø±Ø¶ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø²Ø§Ø¦Ø¯ Ù„ØªØ³Ù„ÙŠÙ… Ø±Ù‚Ù… Ù„Ø¹Ù…ÙŠÙ„. Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù…Ø®ØµØµØ© Ù„Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØªÙŠ ØªØ¹Ø·ÙŠÙ‡Ø§ Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø­Ù„ Ù„ÙŠØ­ÙˆÙ‘Ù„ÙˆØ§ Ø¹Ù„ÙŠÙ‡Ø§ØŒ Ø­ØªÙ‰ ØªÙƒÙˆÙ† Ø¹Ø§Ø±Ù Ø£Ù† Ø§Ù„Ø®Ø·ÙˆØ· Ø¯ÙŠ Ù…Ø®ØµØµØ© Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù‡ÙŠØ­ÙˆÙ„Ùˆ Ø¹Ù„ÙŠÙ‡Ø§ Ù…Ù† Ø¨Ø±Ø§ Ø§Ù„Ù…Ø­Ù„ Ø¹Ù„Ø´Ø§Ù† Ù…ØªØ³ØªÙ„Ù…Ø´ Ø¹Ù„ÙŠÙ‡Ø§ ÙˆØªÙˆÙ‚Ù Ù„ÙŠÙ…ÙŠØªÙƒ"})]}),e.jsx("div",{className:"grid gap-3 py-2",children:ae.length===0?e.jsx("div",{className:"text-center text-sm text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…Ø¶Ø§ÙØ© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†."}):ae.map(a=>{const r=Io[a.id],i=!!r;return e.jsxs("div",{className:`p-3 rounded-lg border flex flex-col gap-2 ${i?"border-red-500 bg-red-50 text-red-700":"border-emerald-500 bg-emerald-50 text-emerald-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-semibold text-base",children:a.phone||"Ø¨Ø¯ÙˆÙ† Ø±Ù‚Ù…"}),a.name?e.jsx("span",{className:"text-xs text-gray-600",children:a.name}):null,i&&e.jsxs("span",{className:"text-xs mt-1",children:["Ù„Ø¹Ù…ÙŠÙ„: ",r.name,r.amount&&r.amount.trim()!==""?` - Ù…Ø¨Ù„Øº: ${r.amount}`:""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{type:"button",size:"icon",className:"h-9 w-9 rounded-full bg-emerald-600 hover:bg-emerald-700 text-white",onClick:()=>{Un(a.id),Cr((r==null?void 0:r.name)||""),Ir((r==null?void 0:r.amount)||"")},children:e.jsx(Lt,{className:"h-4 w-4"})}),i&&e.jsx(A,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 rounded-full border-red-300 text-red-600 hover:bg-red-50",onClick:()=>{const c=`clientNumberAssignments_${(t==null?void 0:t.uid)||"default"}`,d={...Io};delete d[a.id],Ls(d);try{localStorage.setItem(c,JSON.stringify(d))}catch{}Bn===a.id&&(Un(null),Cr(""),Ir(""))},children:e.jsx(Sa,{className:"h-4 w-4"})})]})]}),Bn===a.id&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[e.jsx(X,{placeholder:"Ø§Ø³Ù… Ù…Ø³ØªÙ„Ù… Ø§Ù„Ø±Ù‚Ù…",className:"text-right",value:md,onChange:c=>Cr(c.target.value)}),e.jsx(X,{placeholder:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ ØªØ­ÙˆÙŠÙ„Ù‡",className:"text-right sm:max-w-[160px]",value:hd,onChange:c=>Ir(c.target.value),inputMode:"decimal"}),e.jsx(A,{className:"bg-red-600 hover:bg-red-700 text-white px-4",onClick:()=>{const c=md.trim();if(!c){w({title:"Ø§Ø³Ù… ØºÙŠØ± ØµØ­ÙŠØ­",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ù…Ø³ØªÙ„Ù… Ø§Ù„Ø±Ù‚Ù…",variant:"destructive"});return}if(!Bn)return;const d=hd.trim(),m=`clientNumberAssignments_${(t==null?void 0:t.uid)||"default"}`,f={...Io,[Bn]:{name:c,amount:d}};Ls(f);try{localStorage.setItem(m,JSON.stringify(f))}catch{}Un(null),Cr(""),Ir("")},children:"ØªØ³Ù„ÙŠÙ…"})]})]},a.id)})})]})}),e.jsx(ue,{open:vg,onOpenChange:Qs,children:e.jsxs(me,{className:"sm:max-w-[480px]",children:[e.jsx(be,{children:e.jsx(he,{className:"text-right",children:(ut==null?void 0:ut.type)==="decrease"?"Ø§Ø®ØªÙŠØ§Ø± Ù…ÙƒØ§Ù† Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯":Ra?"Ø§Ø®ØªÙŠØ§Ø± Ù…ØµØ¯Ø± Ø§Ù„Ø®ØµÙ… / Ø§Ù„Ø¥Ø¶Ø§ÙØ©":"Ø§Ø®ØªÙŠØ§Ø± Ù…ØµØ¯Ø± Ø®ØµÙ… Ø§Ù„Ø¯ÙŠÙ†"})}),e.jsxs("div",{className:"space-y-4",children:[Ra&&e.jsxs("div",{className:"flex w-full rounded-lg border border-gray-300 dark:border-gray-700 overflow-hidden mb-4",children:[e.jsx("button",{type:"button",onClick:()=>vs("deduct"),className:`flex-1 py-2 text-sm font-medium transition-colors ${ze==="deduct"?"bg-red-100 text-red-900 dark:bg-red-900/40 dark:text-red-100":"bg-transparent hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:"Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯"}),e.jsx("div",{className:"w-[1px] bg-gray-300 dark:bg-gray-700"}),e.jsx("button",{type:"button",onClick:()=>vs("add"),className:`flex-1 py-2 text-sm font-medium transition-colors ${ze==="add"?"bg-green-100 text-green-900 dark:bg-green-900/40 dark:text-green-100":"bg-transparent hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:"Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯"})]}),e.jsx("p",{className:"text-sm text-gray-600 text-right",children:(ut==null?void 0:ut.type)==="decrease"?"Ø§Ø®ØªØ± Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø£Ù… Ø¥Ù„Ù‰ Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø£Ùˆ ØªØ³Ø¬ÙŠÙ„Ù‡ Ø¨Ø¯ÙˆÙ† Ø®ØµÙ….":ze==="add"?"Ø§Ø®ØªØ± Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ† Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø£Ù… Ø¥Ù„Ù‰ Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸.":"Ø§Ø®ØªØ± Ù‡Ù„ ØªØ±ÙŠØ¯ Ø®ØµÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ† Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬ Ø£Ù… Ù…Ù† Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸."}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(A,{variant:It==="cash"?"default":"outline",className:It==="cash"?"bg-blue-600 hover:bg-blue-700 text-white":"",onClick:()=>Hr("cash"),children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),e.jsx(A,{variant:It==="wallet"?"default":"outline",className:It==="wallet"?"bg-purple-600 hover:bg-purple-700 text-white":"",onClick:()=>Hr("wallet"),children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),e.jsx(A,{variant:It==="none"?"default":"outline",className:It==="none"?"bg-gray-600 hover:bg-gray-700 text-white":"",onClick:()=>Hr("none"),children:(ut==null?void 0:ut.type)==="decrease"||ze==="add"?"Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ©":"Ø¨Ø¯ÙˆÙ† Ø®ØµÙ…"})]}),It==="wallet"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{className:"text-right block",children:(ut==null?void 0:ut.type)==="decrease"||ze==="add"?"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø¥Ø¶Ø§ÙØ©":"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…"}),e.jsxs(Va,{value:Gs,onValueChange:jl,children:[e.jsx(qa,{className:"w-full",children:e.jsx(za,{placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©"})}),e.jsx(Ya,{children:ae.map(a=>e.jsx(la,{value:a.id,children:a.phone||a.name||a.id},a.id))})]})]})]}),e.jsxs($e,{className:"flex justify-between",children:[e.jsx(A,{variant:"outline",onClick:()=>{Qs(!1),Jr(null),Hr(null),jl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{const a=!!ut,r=a?(ut==null?void 0:ut.type)==="decrease":ze==="add",i=Number(a?ut.delta:(Ra==null?void 0:Ra.amount)||0);if(!It){w({title:r?"Ø§Ø®ØªØ± Ù…ÙƒØ§Ù† Ø§Ù„Ø¥Ø¶Ø§ÙØ©":"Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø®ØµÙ…",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}const c=new Date().toISOString();let d=qe,m=De,f=!1,g=!1;try{if(It==="cash")d=Math.round(r?qe+i:qe-i),f=!0;else if(It==="wallet"){if(!Gs){w({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:r?"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø¥Ø¶Ø§ÙØ©":"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…",variant:"destructive"});return}const S=De[Gs]||0,I=Math.round(r?S+i:S-i);m={...De,[Gs]:I},g=!0}}catch(S){console.error("Error calculating balances:",S);return}let y=[..._e],b=W,x=!1;if(a){if(!W)return;const S=Number(W.amount||0),I=Number(W.paidAmount||0),P=Number(ut.delta||0);if(ut.type==="decrease"){const _=W.type==="debtor",M=S-P;if(_&&M<0){const V=Math.round(Math.abs(M)),H={...W,amount:V,type:"creditor",paidAmount:0,status:"pending"};if(y=_e.map(Y=>Y.id===W.id?H:Y),b=H,x=!0,t!=null&&t.uid&&(async()=>{try{const[Y,Ne,Je]=[Ce(ie(F,"userTransactions"),K("userId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending")),Ce(ie(F,"transactions"),K("userId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending")),Ce(ie(F,"transactions"),K("merchantUserId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending"))],[gt,Pe,fe]=await Promise.all([pe(Y),pe(Ne),pe(Je)]),st=gc(F);let Ge=0;const mt=oa=>{oa.docs.forEach(Et=>{st.update(Et.ref,{status:"completed",confirmedAt:new Date}),Ge++})};mt(gt),mt(Pe),mt(fe),Ge>0&&await st.commit(),t!=null&&t.uid&&[...gt.docs.map(Et=>{var He;return String(((He=Et.data())==null?void 0:He.transactionId)||"")}),...Pe.docs.map(Et=>{var He;return String(Et.id||((He=Et.data())==null?void 0:He.transactionId)||"")}),...fe.docs.map(Et=>{var He;return String(Et.id||((He=Et.data())==null?void 0:He.transactionId)||"")})].filter(Boolean).forEach(Et=>se.removeLocalReceiptById(t.uid,Et))}catch(Y){console.error("Batch update failed for linked transactions (Flip):",Y)}})().catch(Y=>console.error("Transaction update error (Flip):",Y)),t!=null&&t.uid&&It!=="none")try{await fn(ie(F,"debtReceipts"),{debtId:W.id,debtorName:W.debtorName,amount:P,userId:t.uid,createdAt:wt(),type:"payment"});const Ne={transactionId:Me(ie(F,"dummy_collection")).id,amount:P,transactionType:"cash_addition",type:"cash_addition",status:"completed",createdAt:new Date,senderName:W.debtorName,receiverName:"Ø§Ù„Ù…Ø­Ù„",description:`Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ† ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø±ØµÙŠØ¯ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${W.debtorName}`,paymentMethod:It,walletId:It==="wallet"?Gs:null,linkedDebtId:W.id,isDebtRepayment:!0};await se.saveUserTransaction(t.uid,Ne);try{E.invalidateQueries({queryKey:["recentTransactions",t==null?void 0:t.uid]})}catch{}}catch(Y){console.error("Failed to create repayment receipt (Flip):",Y)}w({title:"ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ†",description:`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (${V} Ø¬Ù†ÙŠÙ‡) Ø¥Ù„Ù‰ "Ù„ÙŠÙ†Ø§"`})}else{const V=Math.round(M),H=I>=V,Y={...W,amount:V,status:H?"paid":"pending"};if(y=_e.map(Ne=>Ne.id===W.id?Y:Ne),b=Y,x=!0,H&&(t!=null&&t.uid)&&(async()=>{try{const[Ne,Je,gt]=[Ce(ie(F,"userTransactions"),K("userId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending")),Ce(ie(F,"transactions"),K("userId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending")),Ce(ie(F,"transactions"),K("merchantUserId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending"))],[Pe,fe,st]=await Promise.all([pe(Ne),pe(Je),pe(gt)]),Ge=gc(F);let mt=0;const oa=Et=>{Et.docs.forEach(He=>{Ge.update(He.ref,{status:"completed",confirmedAt:new Date}),mt++})};oa(Pe),oa(fe),oa(st),mt>0&&await Ge.commit(),t!=null&&t.uid&&[...Pe.docs.map(He=>{var ha;return String(((ha=He.data())==null?void 0:ha.transactionId)||"")}),...fe.docs.map(He=>{var ha;return String(He.id||((ha=He.data())==null?void 0:ha.transactionId)||"")}),...st.docs.map(He=>{var ha;return String(He.id||((ha=He.data())==null?void 0:ha.transactionId)||"")})].filter(Boolean).forEach(He=>se.removeLocalReceiptById(t.uid,He))}catch(Ne){console.error("Batch update failed for linked transactions:",Ne)}})().catch(Ne=>{console.error("Transaction update error:",Ne)}),t!=null&&t.uid&&It!=="none")try{await fn(ie(F,"debtReceipts"),{debtId:W.id,debtorName:W.debtorName,amount:P,userId:t.uid,createdAt:wt(),type:"payment"});const Je={transactionId:Me(ie(F,"dummy_collection")).id,amount:P,transactionType:"cash_addition",type:"cash_addition",status:"completed",createdAt:new Date,senderName:W.debtorName,receiverName:"Ø§Ù„Ù…Ø­Ù„",description:`Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ† Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ ${W.debtorName}`,paymentMethod:It,walletId:It==="wallet"?Gs:null,linkedDebtId:W.id,isDebtRepayment:!0};await se.saveUserTransaction(t.uid,Je);try{E.invalidateQueries({queryKey:["recentTransactions",t==null?void 0:t.uid]})}catch{}}catch(Ne){console.error("Failed to create repayment receipt:",Ne)}w({title:"ØªÙ… Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„Ù…Ø¨Ù„Øº",description:`Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${V} Ø¬Ù†ÙŠÙ‡`})}}else{const _=S+P,M=I>=_,V={amount:P,note:uu||void 0,addedAt:new Date},H={...W,amount:Math.round(_),status:M?"paid":"pending",additionReceipts:[...W.additionReceipts||[],V]};y=_e.map(Y=>Y.id===W.id?H:Y),b=H,x=!0,w({title:"ØªÙ… Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø¨Ù„Øº",description:`Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${_} Ø¬Ù†ÙŠÙ‡`})}}else if(Ra){y=[{...Ra,userId:t==null?void 0:t.uid,shopId:k||(n==null?void 0:n.shopId)||null},..._e],x=!0;try{t!=null&&t.uid&&js.send(t.uid,`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¯ÙŠÙ† Ø¹Ù„Ù‰ ${Ra.debtorName} Ø¨Ù…Ø¨Ù„Øº ${Ra.amount} Ø¬Ù†ÙŠÙ‡`).catch(()=>{})}catch{}}f&&lt(d),g&&ft(m),x&&(Yt(y),a&&zr(b)),ol(""),nu(""),ou(""),Ks(!1),Qs(!1),!a&&x&&bs(!0),Jr(null),mu(null),Hr(null),jl(""),li(""),w({title:a?"ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ†":"ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¯ÙŠÙ†",description:It==="none"?"Ù„Ù… ÙŠØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø©":It==="cash"?r?`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${i} Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ`:`ØªÙ… Ø®ØµÙ… ${i} Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ`:r?`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${i} Ø¥Ù„Ù‰ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©`:`ØªÙ… Ø®ØµÙ… ${i} Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©`});const N={lastUpdated:c};if(f&&(N.cashBalance=d),g&&(N.walletBalances=m),x&&(N.debts=y,N.debtsDeletedAt=null),f&&(localStorage.setItem(at(),d.toString()),localStorage.setItem(at()+"_lastUpdated",c)),g&&(localStorage.setItem(ot(),JSON.stringify(m)),localStorage.setItem(ot()+"_lastUpdated",c)),x){localStorage.setItem(Qr(),JSON.stringify(y));try{localStorage.setItem(Ol(),JSON.stringify(y))}catch{}try{localStorage.setItem(El(),Date.now().toString())}catch{}}const v=`userData_${t==null?void 0:t.uid}`;if(localStorage.setItem(v,JSON.stringify(N)),t!=null&&t.uid){if(x)try{localStorage.setItem(`debts_unsynced_${t.uid}`,"true")}catch{}const S=[];S.push(se.updateUserData(t.uid,N).then(()=>{(f||g)&&(localStorage.removeItem(v),we(!1))}));const I=k||(n==null?void 0:n.shopId);if(I&&(f||g)){const P={lastUpdated:c};f&&(P.cashBalance=d),g&&(P.walletBalances=m),S.push(ra(Me(F,"dashboardData",I),P,{merge:!0}).catch(_=>console.error("Failed to sync to dashboardData",_)))}Promise.all(S).then(()=>{if(x)try{localStorage.removeItem(`debts_unsynced_${t.uid}`)}catch{}}).catch(P=>{console.error("Sync error:",P),we(!0)})}},children:(ut==null?void 0:ut.type)==="decrease"?"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø®ØµÙ…"})]})]})}),e.jsx(ue,{open:og,onOpenChange:es,children:e.jsxs(me,{className:"w-[95vw] sm:w-auto sm:max-w-[425px] max-h-[90vh] overflow-y-auto rounded-2xl",hideClose:!0,children:[e.jsx("div",{className:"absolute left-4 top-4 z-50",children:e.jsxs(A,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full opacity-70 hover:opacity-100",onClick:()=>es(!1),children:[e.jsx(Vi,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Ø¥ØºÙ„Ø§Ù‚"})]})}),e.jsx(be,{children:e.jsx(he,{className:"text-right",children:"Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙŠÙ†"})}),W&&e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"text-center border-b pb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Ø¥ÙŠØµØ§Ù„ Ø¯ÙŠÙ†"}),e.jsx("p",{className:"text-sm text-gray-500",children:on.format(W.createdAt instanceof Date?W.createdAt:new Date(W.createdAt))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†:"}),e.jsx("span",{children:W.debtorName})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:justify-between sm:items-center",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{variant:"outline",className:"h-10 w-10 sm:h-8 sm:w-8 p-0","aria-label":"Ø¯ÙØ¹ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø¯ÙŠÙ†",onClick:()=>{Yr(""),ci(!0)},children:"âˆ’"}),e.jsxs("span",{className:"font-bold text-xl sm:text-lg",children:[W.amount," Ø¬Ù†ÙŠÙ‡"]}),e.jsx(A,{variant:"outline",className:"h-10 w-10 sm:h-8 sm:w-8 p-0","aria-label":"Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¯ÙŠÙ†",onClick:()=>{cg("increase"),du(""),li(""),es(!1),oi(!0)},children:"+"})]})]}),(()=>{try{const a=(ye||[]).filter(r=>String((r==null?void 0:r.linkedDebtId)||"")===String(W.id)).reduce((r,i)=>r+Math.max(0,Number((i==null?void 0:i.commission)||0)),0);return a>0?e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ø±Ø¨Ø­:"}),e.jsxs("span",{className:"text-green-700 font-semibold",children:[a," Ø¬Ù†ÙŠÙ‡"]})]}):null}catch{return null}})(),e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø³Ø¨Ø¨ Ø§Ù„Ø¯ÙŠÙ†:"}),e.jsx("span",{children:W.reason})]}),e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ø­Ø§Ù„Ø©:"}),e.jsx(Ba,{variant:W.status==="paid"?"default":"secondary",className:`${W.status==="paid"?"bg-green-500":"bg-yellow-500"} w-fit text-[12px] sm:text-xs`,children:W.status==="paid"?"Ù…Ø¯ÙÙˆØ¹":"Ù…Ø¤Ø¬Ù„"})]}),(()=>{const a=Number(W.amount||0),r=Number(W.paidAmount||0),i=Math.max(0,a-r);return e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:"}),e.jsxs("span",{className:"font-bold text-xl sm:text-lg",children:[i," Ø¬Ù†ÙŠÙ‡"]})]})})(),W.paidAmount?e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹:"}),e.jsxs("span",{className:"text-green-700",children:[W.paidAmount," Ø¬Ù†ÙŠÙ‡"]})]}):null,W.partialPayments&&W.partialPayments.length>0&&e.jsxs("div",{className:"mt-3 text-[12px] sm:text-xs text-gray-600",children:[e.jsx("p",{className:"font-medium mb-1",children:"Ø³Ø¬Ù„ Ø§Ù„Ø¯ÙØ¹Ø§Øª Ø§Ù„Ø¬Ø²Ø¦ÙŠØ©:"}),e.jsx("div",{className:"space-y-1 max-h-[30vh] sm:max-h-24 overflow-y-auto",children:W.partialPayments.map((a,r)=>e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsxs("span",{children:["Ø¯ÙØ¹: ",a.amount," Ø¬Ù†ÙŠÙ‡"]}),e.jsx("span",{children:new Date(a.paidAt).toLocaleString("ar-EG")})]},r))})]}),W.additionReceipts&&W.additionReceipts.length>0&&e.jsxs("div",{className:"mt-3 text-[12px] sm:text-xs text-gray-600",children:[e.jsx("p",{className:"font-medium mb-1",children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬Ø²Ø¦ÙŠØ©:"}),e.jsx("div",{className:"space-y-1 max-h-[20vh] sm:max-h-32 overflow-y-auto",children:W.additionReceipts.map((a,r)=>e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsxs("span",{children:["Ø¥Ø¶Ø§ÙØ©: ",a.amount," Ø¬Ù†ÙŠÙ‡"]}),e.jsx("span",{children:new Date(a.addedAt).toLocaleString("ar-EG")}),a.note&&e.jsxs("span",{className:"sm:col-span-2 text-right text-[11px] text-gray-500",children:["Ù…Ù„Ø§Ø­Ø¸Ø©: ",a.note]})]},r))})]})]})]}),e.jsxs($e,{className:"flex gap-2 justify-center",children:[e.jsx(A,{onClick:async()=>{if(W){const a=_e.map(r=>r.id===W.id?{...r,status:"pending"}:r);Yt(a),await Wa(a);try{if(t!=null&&t.uid){const r=computedRemaining;await js.send(t.uid,`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${W.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${r} Ø¬Ù†ÙŠÙ‡`)}}catch{}es(!1),w({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙŠÙ†",description:"ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¯ÙŠÙ† ÙƒÙ…Ø¤Ø¬Ù„"})}},variant:"outline",className:"bg-yellow-500 hover:bg-yellow-600 text-white",children:"Ù…Ø¤Ø¬Ù„"}),e.jsx(A,{onClick:async()=>{if(W){const a=Number(W.amount||0),r=Number(W.paidAmount||0);let i=Math.max(0,a-r);try{const m=(ye||[]).filter(x=>String((x==null?void 0:x.linkedDebtId)||"")===String(W.id)),f=m.reduce((x,N)=>x+Math.max(0,Number((N==null?void 0:N.commission)||0)),0),g=m.reduce((x,N)=>x+Math.max(0,Number(((N==null?void 0:N.sentAmount)??(N==null?void 0:N.transferredAmount)??(N==null?void 0:N.withdrawnAmount)??(N==null?void 0:N.amount))||0)),0),b=a<g+f?a+f:a;i=Math.max(0,Number(b)-r)}catch{}const c=i,d=_e.map(m=>{if(m.id!==W.id)return m;const f=Number(m.amount||0),g=Number(m.paidAmount||0),y=Math.round(g+c),b=y>=f;return{...m,amount:f,paidAmount:b?f:y,status:"paid",partialPayments:[...m.partialPayments||[],...c>0?[{amount:c,paidAt:new Date}]:[]]}});Yt(d);try{zr(d.find(m=>m.id===W.id)||null)}catch{}gi(c),as("none"),vs(W.type==="debtor"?"deduct":"add"),Xs(!0),await Wa(d);try{const m=d.find(f=>f.id===W.id);if(t!=null&&t.uid&&(m!=null&&m.id)){const f=Me(F,"debts",m.id),g={...m,userId:t.uid,shopId:k||(n==null?void 0:n.shopId)||null,lastUpdated:new Date().toISOString()};Object.keys(g).forEach(y=>g[y]===void 0&&delete g[y]),await ra(f,g,{merge:!0})}}catch(m){console.error("Failed to sync debt payment to collection:",m)}try{t!=null&&t.uid&&(W!=null&&W.id)&&(async()=>{const m=Ce(ie(F,"userTransactions"),K("userId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending")),f=await pe(m);await Promise.allSettled(f.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=f.docs.map(v=>{var S;return String(((S=v.data())==null?void 0:S.transactionId)||"")});t!=null&&t.uid&&N.forEach(v=>v&&se.removeLocalReceiptById(t.uid,v))}catch{}const g=Ce(ie(F,"transactions"),K("userId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending")),y=await pe(g);await Promise.allSettled(y.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=y.docs.map(v=>{var S;return String(v.id||((S=v.data())==null?void 0:S.transactionId)||"")});t!=null&&t.uid&&N.forEach(v=>v&&se.removeLocalReceiptById(t.uid,v))}catch{}const b=Ce(ie(F,"transactions"),K("merchantUserId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending")),x=await pe(b);await Promise.allSettled(x.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=x.docs.map(v=>{var S;return String(v.id||((S=v.data())==null?void 0:S.transactionId)||"")});t!=null&&t.uid&&N.forEach(v=>v&&se.removeLocalReceiptById(t.uid,v))}catch{}})().catch(m=>{console.error("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†:",m),w({title:"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©",description:"ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†",variant:"destructive"})})}catch(m){console.error("ØªØ¹Ø°Ø± ØªØ¬Ù‡ÙŠØ² ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©:",m)}try{const m=Fl(),f=localStorage.getItem(m);if(f){const y=(JSON.parse(f)||[]).map(b=>(b==null?void 0:b.linkedDebtId)===W.id&&(b==null?void 0:b.status)==="pending"?{...b,status:"completed",confirmedAt:new Date}:b);localStorage.setItem(m,JSON.stringify(y)),zt(b=>b.map(x=>(x==null?void 0:x.linkedDebtId)===W.id&&(x==null?void 0:x.status)==="pending"?{...x,status:"completed",confirmedAt:new Date}:x))}}catch(m){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ†:",m)}es(!1),w({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙŠÙ†",description:"ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¯ÙŠÙ† ÙƒÙ…Ø¯ÙÙˆØ¹"})}},className:"bg-green-500 hover:bg-green-600",children:"Ù…Ø¯ÙÙˆØ¹"}),e.jsx(A,{onClick:async()=>{if(W){const a=_e.filter(r=>r.id!==W.id);Yt(a),await Wa(a),es(!1),w({title:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¯ÙŠÙ†",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¯ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­"})}},variant:"destructive",children:"Ø­Ø°Ù"})]})]})}),e.jsx(ue,{open:dg,onOpenChange:a=>{ci(a),a||Yr("")},children:e.jsxs(me,{className:"w-[95vw] sm:max-w-[425px] rounded-2xl",children:[e.jsxs(be,{children:[e.jsx(he,{className:"text-right",children:"Ø¯ÙØ¹ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø¯ÙŠÙ†"}),e.jsx(Ze,{className:"text-right",children:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø¯ÙØ¹Ù‡ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙŠÙ† Ø«Ù… Ø§Ø¶ØºØ· Ø¯ÙØ¹."})]}),W&&e.jsxs("div",{className:"grid gap-4 py-2",children:[e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†:"}),e.jsx("span",{children:W.debtorName})]}),e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙƒÙ„ÙŠ:"}),e.jsxs("span",{children:[W.amount," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹:"}),e.jsxs("span",{className:"text-green-700",children:[Number(W.paidAmount||0)," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:"}),e.jsxs("span",{className:"font-semibold",children:[Math.max(0,Number(W.amount||0)-Number(W.paidAmount||0))," ","Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"partialAmountDialog",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¯ÙØ¹Ù‡"}),e.jsx(X,{id:"partialAmountDialog",type:"number",value:fu,onChange:a=>Yr(a.target.value),className:"text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº"})]})]}),e.jsxs($e,{className:"flex gap-2 justify-between",children:[e.jsx(A,{variant:"outline",onClick:()=>{ci(!1),Yr("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{className:"bg-blue-600 hover:bg-blue-700",onClick:async()=>{const a=parseFloat(fu);if(!W||isNaN(a)||a<=0){w({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const r=Math.max(0,Number(W.amount||0)-Number(W.paidAmount||0)),i=a>r;let c;if(i){const m=Math.round(a-r),g=(W.type||"creditor")==="debtor"?"creditor":"debtor";c={...W,type:g,amount:m,paidAmount:0,status:"pending",partialPayments:[]},w({title:"ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ†",description:`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (${m} Ø¬Ù†ÙŠÙ‡) Ø¥Ù„Ù‰ ${g==="debtor"?'"Ø¹Ù„ÙŠÙ†Ø§"':'"Ù„ÙŠÙ†Ø§"'}`})}else{const m=Math.round((W.paidAmount||0)+a),g=Number(W.amount||0)-m<.01;c={...W,amount:Number(W.amount||0),paidAmount:m,status:g?"paid":"pending",partialPayments:[...W.partialPayments||[],{amount:a,paidAt:new Date}]}}const d=_e.map(m=>m.id===W.id?c:m);Yt(d),zr(c),await Wa(d);try{if(t!=null&&t.uid){const m=Math.max(0,Number(c.amount||0)-Number(c.paidAmount||0)),f=i?`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${c.debtorName} ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (${c.amount} Ø¬Ù†ÙŠÙ‡) Ø¥Ù„Ù‰ ${c.type==="debtor"?'"Ø¹Ù„ÙŠÙ†Ø§"':'"Ù„ÙŠÙ†Ø§"'}`:`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø¬Ø²Ø¡ Ù…Ù† Ø¯ÙŠÙ† ${c.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${a} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ${m} Ø¬Ù†ÙŠÙ‡`;await js.send(t.uid,f)}}catch{}try{(c.status==="paid"||i)&&(t!=null&&t.uid)&&(async()=>{const m=Ce(ie(F,"userTransactions"),K("userId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending")),f=await pe(m);await Promise.allSettled(f.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=f.docs.map(v=>{var S;return String(((S=v.data())==null?void 0:S.transactionId)||"")});t!=null&&t.uid&&N.forEach(v=>v&&se.removeLocalReceiptById(t.uid,v))}catch{}const g=Ce(ie(F,"transactions"),K("userId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending")),y=await pe(g);await Promise.allSettled(y.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=y.docs.map(v=>{var S;return String(v.id||((S=v.data())==null?void 0:S.transactionId)||"")});t!=null&&t.uid&&N.forEach(v=>v&&se.removeLocalReceiptById(t.uid,v))}catch{}const b=Ce(ie(F,"transactions"),K("merchantUserId","==",t.uid),K("linkedDebtId","==",W.id),K("status","==","pending")),x=await pe(b);await Promise.allSettled(x.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=x.docs.map(v=>{var S;return String(v.id||((S=v.data())==null?void 0:S.transactionId)||"")});t!=null&&t.uid&&N.forEach(v=>v&&se.removeLocalReceiptById(t.uid,v))}catch{}})().catch(m=>{console.error("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†:",m),w({title:"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©",description:"ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†",variant:"destructive"})})}catch(m){console.error("ØªØ¹Ø°Ø± ØªØ¬Ù‡ÙŠØ² ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©:",m)}if(c.status==="paid")try{const m=Fl(),f=localStorage.getItem(m);if(f){const y=(JSON.parse(f)||[]).map(b=>(b==null?void 0:b.linkedDebtId)===W.id&&(b==null?void 0:b.status)==="pending"?{...b,status:"completed",confirmedAt:new Date}:b);localStorage.setItem(m,JSON.stringify(y)),zt(b=>b.map(x=>(x==null?void 0:x.linkedDebtId)===W.id&&(x==null?void 0:x.status)==="pending"?{...x,status:"completed",confirmedAt:new Date}:x))}}catch(m){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ†:",m)}gi(a),as("none"),vs(c.type==="debtor"?"deduct":"add"),Xs(!0),ci(!1),Yr(""),w({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹ Ø¬Ø²Ø¡",description:`ØªÙ… Ø¯ÙØ¹ ${a} Ø¬Ù†ÙŠÙ‡ Ø¨ØªØ§Ø±ÙŠØ® ${new Date().toLocaleString("ar-EG")}`})},children:"Ø¯ÙØ¹"})]})]})}),e.jsx(ue,{open:lg,onOpenChange:oi,children:e.jsxs(me,{className:"sm:max-w-md rounded-2xl shadow-elegant border border-gray-200",children:[e.jsxs(be,{children:[e.jsx(he,{className:`text-right ${Na==="decrease"?"text-red-600":"text-green-600"}`,children:Na==="increase"?"ÙƒØªØ§Ø¨Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¶Ø§ÙØ©":Na==="decrease"?"Ø¥Ù†Ù‚Ø§Øµ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†":"ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†"}),e.jsx(Ze,{className:"text-right",children:Na==="increase"?"Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¶Ø§ÙØ© ÙˆÙ…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø§Ø¶Ø§ÙØ© Ø«Ù… Ø§Ø¶ØºØ· ØªØ£ÙƒÙŠØ¯.":Na==="decrease"?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø«Ù… Ø§Ø¶ØºØ· ØªØ£ÙƒÙŠØ¯ Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¥Ù†Ù‚Ø§Øµ.":"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø«Ù… Ø§Ø¶ØºØ· ØªØ£ÙƒÙŠØ¯ Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„."})]}),e.jsxs("div",{className:"grid gap-4 py-2",children:[e.jsx(Z,{htmlFor:"debtAdjustAmount",className:"text-right",children:Na==="increase"?"Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¶Ø§ÙØ© (Ø¬Ù†ÙŠÙ‡)":"Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬Ù†ÙŠÙ‡)"}),e.jsx(X,{id:"debtAdjustAmount",type:"number",placeholder:"0.00",value:cu,onChange:a=>du(a.target.value)}),Na==="increase"&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{htmlFor:"debtAdditionNote",className:"text-right",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx(X,{id:"debtAdditionNote",placeholder:"Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù† Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø¶Ø§ÙØ©",value:uu,onChange:a=>li(a.target.value)})]}),W&&e.jsxs("div",{className:"text-right text-sm text-muted-foreground",children:["Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø­Ø§Ù„ÙŠ: ",e.jsx("span",{className:"font-semibold",children:Number(W.amount||0).toLocaleString("en-US",{maximumFractionDigits:0})})," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs($e,{className:"flex gap-2",children:[e.jsx(A,{variant:"secondary",onClick:()=>{oi(!1),es(!0),li("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{className:Na==="decrease"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700",onClick:async()=>{try{if(!W||!Na)return;const a=Math.round(parseFloat(cu||"0"));if(!a||isNaN(a)||a<=0){w({title:"Ù‚ÙŠÙ…Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±",variant:"destructive"});return}Jr(null),mu({debtId:W.id,delta:a,type:Na}),oi(!1),Qs(!0)}catch(a){console.error("ÙØ´Ù„ ØªØ¬Ù‡ÙŠØ² ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†:",a),w({title:"Ø®Ø·Ø£",description:"ØªØ¹Ø°Ù‘Ø± ØªØ¬Ù‡ÙŠØ² ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†",variant:"destructive"})}},children:"ØªØ£ÙƒÙŠØ¯"})]})]})}),e.jsx(ue,{open:wg,onOpenChange:Xs,children:e.jsxs(me,{className:"sm:max-w-[480px]",children:[e.jsxs(be,{children:[e.jsx(he,{className:"text-right",children:"Ø§Ø®ØªÙŠØ§Ø± ØªØ£Ø«ÙŠØ± Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯"}),e.jsx(Ze,{className:"text-right",children:"Ø­Ø¯Ø¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ø±ØµÙŠØ¯ (ÙˆØ§Ø±Ø¯) Ø£Ù… Ø®ØµÙ…Ù‡ Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ (ØµØ§Ø¯Ø±)."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex w-full rounded-lg border border-gray-300 dark:border-gray-700 overflow-hidden mb-4",children:[e.jsx("button",{type:"button",onClick:()=>vs("deduct"),className:`flex-1 py-2 text-sm font-medium transition-colors ${ze==="deduct"?"bg-red-100 text-red-900 dark:bg-red-900/40 dark:text-red-100":"bg-transparent hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:"Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯"}),e.jsx("div",{className:"w-[1px] bg-gray-300 dark:bg-gray-700"}),e.jsx("button",{type:"button",onClick:()=>vs("add"),className:`flex-1 py-2 text-sm font-medium transition-colors ${ze==="add"?"bg-green-100 text-green-900 dark:bg-green-900/40 dark:text-green-100":"bg-transparent hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:"Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsx(A,{variant:Ut==="cash"?"default":"outline",className:Ut==="cash"?"bg-blue-600 text-white":"",size:"sm",onClick:()=>as("cash"),children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),e.jsx(A,{variant:Ut==="wallet"?"default":"outline",className:Ut==="wallet"?"bg-blue-600 text-white":"",size:"sm",onClick:()=>as("wallet"),children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),e.jsx(A,{variant:Ut==="fawry"?"default":"outline",className:Ut==="fawry"?"bg-amber-600 text-white":"",size:"sm",onClick:()=>as("fawry"),children:"ÙÙˆØ±ÙŠ"}),e.jsx(A,{variant:Ut==="none"?"default":"outline",className:Ut==="none"?"bg-gray-600 text-white":"",size:"sm",onClick:()=>as("none"),children:"Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ©"})]}),Ut==="wallet"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-right",children:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø¥Ø¶Ø§ÙØ©"}),e.jsxs("select",{className:"w-full border rounded p-2 text-right",value:ss,onChange:a=>Sl(a.target.value),children:[e.jsx("option",{value:"",children:"â€” Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© â€”"}),ae&&ae.length>0?ae.map(a=>e.jsx("option",{value:a.id,children:a.phone||a.name||a.id},a.id)):Object.keys(De||{}).map(a=>{var r,i,c,d;return e.jsx("option",{value:a,children:((r=ae.find(m=>m.id===a))==null?void 0:r.phone)||((i=tr==null?void 0:tr.find(m=>m.id===a))==null?void 0:i.phone)||((c=tr==null?void 0:tr.find(m=>m.id===a))==null?void 0:c.name)||((d=ae.find(m=>m.id===a))==null?void 0:d.name)||a},a)})]})]}),e.jsxs("div",{className:"text-right text-sm text-gray-600",children:["Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡: ",e.jsxs("span",{className:"font-bold",children:[Su," Ø¬Ù†ÙŠÙ‡"]})]}),ze==="add"&&e.jsxs("div",{className:"mt-2 space-y-1 text-right",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ø®ØµÙ… Ù„Ù„Ø¹Ù…ÙŠÙ„ (Ø¬Ù†ÙŠÙ‡)"}),e.jsx(X,{type:"number",value:Du,onChange:a=>Dl(a.target.value),placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø®ØµÙ… Ø§Ù„Ø°Ù‰ Ø³ÙŠØªÙ… Ù…Ù†Ø­Ù‡ Ù„Ù„Ø¹Ù…ÙŠÙ„",className:"h-9 text-sm bg-orange-50/60 dark:bg-gray-900 border-orange-300 dark:border-orange-700 focus:border-orange-500 focus:ring-orange-500"}),e.jsx("div",{className:"text-[11px] text-gray-500",children:"Ø³ÙŠØªÙ… Ø®ØµÙ… Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¨Ù„Øº Ù…Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¶Ø§Ù Ù„Ù„Ù†Ù‚Ø¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù…Ø¹ Ø¨Ù‚Ø§Ø¡ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¯ÙŠÙ† Ø§Ù„Ù…Ø³Ø¯Ø¯Ø© ÙƒÙ…Ø§ Ù‡ÙŠ."})]})]}),e.jsxs($e,{className:"flex flex-wrap justify-between gap-2",children:[e.jsx(A,{variant:"outline",onClick:()=>{Xs(!1),gi(0),as(null),Sl(""),Dl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(A,{disabled:ed,onClick:async()=>{var c,d;if(ed)return;const a=Su;if(!a||a<=0){Xs(!1);return}const r=parseFloat(Du||"0")||0,i=ze==="add"?Math.max(0,Math.round(r*100)/100):0;if(ze==="add"&&i>a){w({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®ØµÙ…",description:"Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ… Ø£ÙƒØ¨Ø± Ù…Ù† Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯",variant:"destructive"});return}if(!Ut){w({title:"Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø¥Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}if(Ut==="wallet"&&!ss){w({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¥Ù„ÙŠÙ‡Ø§",variant:"destructive"});return}td(!0),Xs(!1);try{const m=async(f,g)=>{if(t!=null&&t.uid&&W)try{const b={transactionId:Me(ie(F,"dummy_collection")).id,amount:a,transactionType:ze==="deduct"?"withdraw":"cash_addition",type:ze==="deduct"?"withdraw":"cash_addition",status:"completed",createdAt:new Date,senderName:W.debtorName,receiverName:"Ø§Ù„Ù…Ø­Ù„",description:`Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ† ${W.type==="debtor"?"Ù„Ù„Ø¹Ù…ÙŠÙ„":"Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„"} ${W.debtorName} (${ze==="deduct"?"Ø®ØµÙ…":"Ø¥Ø¶Ø§ÙØ©"})`,paymentMethod:f,walletId:g||null,linkedDebtId:W.id,isDebtRepayment:!0,customerDiscount:i>0?i:void 0,netAmount:ze==="add"?Math.max(0,Math.round((a-i)*100)/100):a};await se.saveUserTransaction(t.uid,b);try{E.invalidateQueries({queryKey:["recentTransactions",t==null?void 0:t.uid]})}catch{}}catch(y){console.error("Failed to create repayment receipt:",y)}};if(Ut==="cash"){const f=ze==="add"?Math.max(0,Math.round((a-i)*100)/100):a,g=ze==="deduct"?qe-f:qe+f;lt(g),localStorage.setItem(at(),g.toString());const y={cashBalance:g,lastUpdated:new Date().toISOString()},b=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(b,JSON.stringify(y)),t!=null&&t.uid?(se.updateUserData(t.uid,y).catch(()=>we(!0)),localStorage.removeItem(b),we(!1)):we(!0),w({title:ze==="deduct"?"ØªÙ… Ø®ØµÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯":"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯",description:`ØªÙ… ${ze==="deduct"?"Ø®ØµÙ…":"Ø¥Ø¶Ø§ÙØ©"} ${ze==="add"?Math.max(0,Math.round((a-i)*100)/100):a} Ø¬Ù†ÙŠÙ‡ ${ze==="deduct"?"Ù…Ù†":"Ø¥Ù„Ù‰"} Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©${i>0&&ze==="add"?` (Ø¨Ø¹Ø¯ Ø®ØµÙ… ${i} Ø¬Ù†ÙŠÙ‡ Ù„Ù„Ø¹Ù…ÙŠÙ„)`:""}`}),await m("cash")}else if(Ut==="wallet"){const f=De[ss]||0,g=ze==="add"?Math.max(0,Math.round((a-i)*100)/100):a,y={...De,[ss]:f+(ze==="deduct"?-g:g)};ft(y);const b=new Date().toISOString(),x={walletBalances:y,lastUpdated:b},N=`userData_${t==null?void 0:t.uid}`;if(localStorage.setItem(N,JSON.stringify(x)),localStorage.setItem(ot(),JSON.stringify(y)),localStorage.setItem(`walletBalances_backup_${b}`,JSON.stringify(y)),t!=null&&t.uid){se.updateUserData(t.uid,x).catch(()=>we(!0));try{localStorage.removeItem(N)}catch{}we(!1)}else we(!0);const v=((c=ae.find(S=>S.id===ss))==null?void 0:c.phone)||((d=ae.find(S=>S.id===ss))==null?void 0:d.name)||ss;w({title:ze==="deduct"?"ØªÙ… Ø®ØµÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯":"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯",description:`ØªÙ… ${ze==="deduct"?"Ø®ØµÙ…":"Ø¥Ø¶Ø§ÙØ©"} ${ze==="add"?Math.max(0,Math.round((a-i)*100)/100):a} Ø¬Ù†ÙŠÙ‡ ${ze==="deduct"?"Ù…Ù†":"Ø¥Ù„Ù‰"} Ø§Ù„Ù…Ø­ÙØ¸Ø© ${v}${i>0&&ze==="add"?` (Ø¨Ø¹Ø¯ Ø®ØµÙ… ${i} Ø¬Ù†ÙŠÙ‡ Ù„Ù„Ø¹Ù…ÙŠÙ„)`:""}`}),await m("wallet",ss)}else Ut==="none"?w({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø³Ø¯Ø§Ø¯",description:`ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${a} Ø¬Ù†ÙŠÙ‡ Ø¨Ø¯ÙˆÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø©`}):Ut==="fawry"&&(w({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø³Ø¯Ø§Ø¯ Ø¹Ø¨Ø± ÙÙˆØ±ÙŠ",description:`ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${a} Ø¬Ù†ÙŠÙ‡ ÙƒØ³Ø¯Ø§Ø¯ Ø¹Ø¨Ø± ÙÙˆØ±ÙŠ Ø¨Ø¯ÙˆÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø©`}),await m("fawry"));try{if(t!=null&&t.uid&&W){const f=Number(W.amount||0),g=Number(W.paidAmount||0),y=W.status==="paid"||g>=f,b=a>0?a:g||f,x=y?`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${W.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${g||b} Ø¬Ù†ÙŠÙ‡`:`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø³Ø¯Ø§Ø¯ ${b} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø¯ÙŠÙ† Ø§Ù„Ø¹Ù…ÙŠÙ„ ${W.debtorName}`;await js.send(t.uid,x)}}catch{}}catch(m){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯:",m),w({title:"Ø­Ø¯Ø« Ø®Ø·Ø£",description:"ØªØ¹Ø°Ø± Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",variant:"destructive"})}finally{td(!1),gi(0),as(null),Sl(""),Dl("");try{bs(!0)}catch{}}},className:"bg-green-600 hover:bg-green-700",children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©"})]})]})}),e.jsx(ue,{open:Of,onOpenChange:da,children:e.jsxs(me,{hideClose:!0,className:"post-confirm-card sm:max-w-[420px] w-[90vw] rounded-2xl bg-gradient-to-br from-white via-indigo-50 to-blue-50 shadow-2xl border border-indigo-100",children:[e.jsxs(be,{children:[e.jsx(he,{className:"text-right text-2xl font-bold",children:(nt==null?void 0:nt.type)==="transfer"?"Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø§Ø³ØªÙ„Ø§Ù…Ù‡":"Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ ØªØ³Ù„ÙŠÙ…Ù‡"}),e.jsx(Ze,{className:"text-right text-gray-600",children:(nt==null?void 0:nt.type)==="transfer"?"Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø§Ø³ØªÙ„Ø§Ù…Ù‡ Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯.":"Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙˆØ§Ø¬Ø¨ ØªØ³Ù„ÙŠÙ…Ù‡ Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯."})]}),e.jsxs("div",{className:"py-3 flex flex-col items-center gap-1.5",children:[e.jsxs("div",{className:"text-xl sm:text-2xl font-bold text-blue-700 tracking-wide",children:[ks((nt==null?void 0:nt.amount)||0)," Ø¬Ù†ÙŠÙ‡"]}),e.jsx("div",{className:"text-sm text-gray-500 text-right w-full",children:(nt==null?void 0:nt.type)==="transfer"?"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶ Ø´Ø§Ù…Ù„ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„.":nt!=null&&nt.isDeduct||!ct?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ù…Ø®ØµÙˆÙ…Ø© Ù…Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³Ù„Ù‘Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„.":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ù…Ø¶Ø§ÙØ© ÙˆÙ„Ø§ ØªØ¤Ø«Ø± Ø¹Ù„Ù‰ Ù‚ÙŠÙ…Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ…."})]}),e.jsxs($e,{className:"flex justify-end gap-2",children:[(nt==null?void 0:nt.type)==="transfer"&&e.jsx(A,{variant:"default",id:"sendCodeBtn",onClick:M0,disabled:qd,className:"btn-transfer-confirm bg-blue-600 hover:bg-blue-700 text-white border-0",children:qd?"Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...":"Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),e.jsx(A,{onClick:()=>{da(!1),el(null),Ar(null)},className:"bg-green-600 hover:bg-green-700 text-white",children:(nt==null?void 0:nt.type)==="transfer"?"ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…":"ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…"})]}),(nt==null?void 0:nt.type)==="transfer"&&e.jsx("div",{className:"mt-4 border-t pt-4 w-full",children:e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(A,{variant:qt===0?"default":"outline",size:"sm",onClick:()=>bo(0),className:`flex-1 h-10 ${qt===0?"bg-blue-600 hover:bg-blue-700 text-white":"border-blue-200 text-blue-700 hover:bg-blue-50"}`,children:"SIM 1"}),e.jsx(A,{variant:qt===1?"default":"outline",size:"sm",onClick:()=>bo(1),className:`flex-1 h-10 ${qt===1?"bg-blue-600 hover:bg-blue-700 text-white":"border-blue-200 text-blue-700 hover:bg-blue-50"}`,children:"SIM 2"})]})})]})}),e.jsx(px,{open:Rf,onClose:()=>Ea(!1),onSubmit:O0,deviceId:tl||hs||"",recipientName:Lf,recipientMsisdn:String(B==="transfer"?(bt==null?void 0:bt.receiver)||Mt||"":((vm=ae.find(a=>a.id===R))==null?void 0:vm.phone)||"").replace(/\D/g,"")}),e.jsx(ue,{open:Wf,onOpenChange:()=>{},children:e.jsxs(me,{className:"w-fit p-8 flex flex-col items-center justify-center gap-6",hideClose:!0,children:[e.jsx(he,{className:"sr-only",children:"Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø§Ø³Ù…"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-blue-100 rounded-full animate-ping opacity-75"}),e.jsx("div",{className:"relative bg-white p-4 rounded-full shadow-md border border-blue-100",children:e.jsx(cs,{className:"h-10 w-10 animate-spin text-blue-600"})})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-lg font-bold text-gray-800",children:"Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§..."}),e.jsx("p",{className:"text-sm text-gray-500",children:"ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ Ø¸Ù‡ÙˆØ± Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"})]})]})}),e.jsx(cN,{isOpen:Ff,onClose:()=>Kd(!1),senderPhone:((wm=ae.find(a=>a.id===R))==null?void 0:wm.phone)||"",receiverPhone:(bt==null?void 0:bt.receiver)||"",amount:Number((bt==null?void 0:bt.amount)||0),deviceId:tl||hs||"",api:window.electronAPI}),e.jsx(ue,{open:Ao==="success",onOpenChange:()=>Ma(null),children:e.jsx(me,{className:"sm:max-w-[425px]",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 gap-4",children:[e.jsx(Xi,{className:"h-16 w-16 text-green-500"}),e.jsx(he,{className:"text-xl text-green-700",children:"ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­"}),e.jsx(A,{onClick:()=>Ma(null),className:"bg-green-600 hover:bg-green-700 w-full",children:"ØªÙ…"})]})})}),e.jsx(ue,{open:Ao==="limit_exceeded",onOpenChange:()=>Ma(null),children:e.jsx(me,{className:"sm:max-w-[425px]",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 gap-4",children:[e.jsx(Wx,{className:"h-16 w-16 text-red-500"}),e.jsx(he,{className:"text-xl text-red-700",children:"ÙØ´Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),e.jsx("p",{className:"text-center text-gray-600",children:"ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø§Ù‚ØµÙŠ"}),e.jsx(A,{onClick:()=>Ma(null),variant:"destructive",className:"w-full",children:"Ø¥ØºÙ„Ø§Ù‚"})]})})}),e.jsx(ue,{open:Ao==="no_wallet",onOpenChange:()=>Ma(null),children:e.jsx(me,{className:"sm:max-w-[425px]",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 gap-4",children:[e.jsx(ac,{className:"h-16 w-16 text-yellow-500"}),e.jsx(he,{className:"text-xl text-yellow-700",children:"ØªÙ†Ø¨ÙŠÙ‡"}),e.jsxs("p",{className:"text-center text-gray-600",children:["Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ÙØ¸Ù‡ Ù…Ø³Ø¬Ù„Ù‡ Ø¹Ù„ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…",e.jsx("br",{}),"ØªØ§ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ù‡ Ø§Ø®Ø±ÙŠ"]}),e.jsx(A,{onClick:()=>Ma(null),className:"bg-yellow-600 hover:bg-yellow-700 w-full",children:"Ø­Ø³Ù†Ø§Ù‹"})]})})}),e.jsx(ue,{open:V0,onOpenChange:()=>{},children:e.jsxs(me,{className:"w-fit p-8 flex flex-col items-center justify-center gap-6",hideClose:!0,children:[e.jsx(he,{className:"sr-only",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚"}),e.jsx(cs,{className:"h-10 w-10 animate-spin text-blue-600"}),e.jsx("p",{className:"text-lg font-bold text-gray-800",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ©..."})]})}),e.jsx(AN,{isOpen:xf,onClose:()=>Jo(!1),wallets:ae,walletBalances:De,userId:t==null?void 0:t.uid,onSelectWallet:a=>{ms(a);const r=ae.find(i=>i.id===a);if(r){Ga(r.phone);try{localStorage.setItem(La(),a)}catch{}}Jo(!1)},selectedWalletId:R||void 0}),e.jsx(ON,{open:u0,onOpenChange:m0}),e.jsx(dN,{open:f0,onOpenChange:br}),!1,ne&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-white dark:bg-slate-950 overflow-y-auto",children:e.jsx(xx,{onBack:()=>L(!1),eyeComfortMode:Js,setEyeComfortMode:hu})}),e.jsx(ue,{open:zo,onOpenChange:Yo,children:e.jsxs(me,{className:"sm:max-w-md",dir:"rtl",children:[e.jsxs(be,{children:[e.jsx(he,{children:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ"}),e.jsx(Ze,{children:"Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø«Ù… Ø­Ø¯Ù‘Ø¯ Ø§Ù„Ø´Ù‡Ø± Ø£Ùˆ Ø§Ù„ÙŠÙˆÙ…"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs(bx,{value:Kn,onValueChange:a=>of(a),children:[e.jsxs(vx,{className:"grid grid-cols-2 w-full",children:[e.jsx(Lm,{value:"monthly",children:"ØªÙ‚Ø§Ø±ÙŠØ± Ø´Ù‡Ø±"}),e.jsx(Lm,{value:"daily",children:"ØªÙ‚Ø§Ø±ÙŠØ± ÙŠÙˆÙ…"})]}),e.jsx(Fm,{value:"monthly",className:"mt-3",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(Z,{className:"text-right",children:"Ø§Ù„Ø´Ù‡Ø±"}),e.jsxs(qm,{children:[e.jsx(zm,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:Ia("w-full justify-start text-left font-normal",!Za&&"text-muted-foreground"),children:[e.jsx(Ji,{className:"mr-2 h-4 w-4"}),Za?ga(new Date(`${Za}-01`),"LLLL yyyy",{locale:Gm}):e.jsx("span",{children:"Ø§Ø®ØªØ± Ø´Ù‡Ø±"})]})}),e.jsx(pc,{className:"w-auto p-0",align:"start",children:e.jsx(bc,{mode:"single",selected:Za?new Date(`${Za}-01`):void 0,onSelect:a=>lf(a?ga(a,"yyyy-MM"):""),initialFocus:!0})})]})]})}),e.jsx(Fm,{value:"daily",className:"mt-3",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(Z,{className:"text-right",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsxs(qm,{children:[e.jsx(zm,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:Ia("w-full justify-start text-left font-normal",!Xa&&"text-muted-foreground"),children:[e.jsx(Ji,{className:"mr-2 h-4 w-4"}),Xa?ga(new Date(Xa),"PPP",{locale:Gm}):e.jsx("span",{children:"Ø§Ø®ØªØ± ØªØ§Ø±ÙŠØ®"})]})}),e.jsx(pc,{className:"w-auto p-0",align:"start",children:e.jsx(bc,{mode:"single",selected:Xa?new Date(Xa):void 0,onSelect:a=>nf(a?ga(a,"yyyy-MM-dd"):""),initialFocus:!0})})]})]})})]}),xs&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 p-3 rounded-lg border border-blue-100 dark:border-blue-900/30",children:[e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 mb-1",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),e.jsx("div",{className:"text-lg font-bold text-blue-800 dark:text-blue-200",children:xs.count})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-3 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº"}),e.jsx("div",{className:"text-lg font-bold text-gray-800 dark:text-gray-200",children:xs.totalAmount.toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-950/20 p-3 rounded-lg border border-red-100 dark:border-red-900/30",children:[e.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 mb-1",children:"Ø§Ù„Ù…Ø³Ø­ÙˆØ¨"}),e.jsx("div",{className:"text-lg font-bold text-red-800 dark:text-red-200",children:xs.totalWithdrawn.toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-950/20 p-3 rounded-lg border border-green-100 dark:border-green-900/30",children:[e.jsx("div",{className:"text-xs text-green-600 dark:text-green-400 mb-1",children:"Ø§Ù„Ù…Ø±Ø³Ù„"}),e.jsx("div",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:xs.totalSent.toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"bg-violet-50 dark:bg-violet-950/20 p-3 rounded-lg border border-violet-100 dark:border-violet-900/30",children:[e.jsx("div",{className:"text-xs text-violet-600 dark:text-violet-400 mb-1",children:"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"}),e.jsx("div",{className:"text-lg font-bold text-violet-800 dark:text-violet-200",children:xs.salesProfit.toLocaleString("en-US",{maximumFractionDigits:0})})]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-950/20 p-3 rounded-lg border border-yellow-100 dark:border-yellow-900/30 col-span-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),e.jsx("div",{className:"text-lg font-bold text-yellow-800 dark:text-yellow-200",children:xs.totalProfit.toLocaleString("en-US",{maximumFractionDigits:0})})]})})]})]})]})}),e.jsx(sN,{isOpen:_t,onClose:()=>J(!1),userId:(t==null?void 0:t.uid)||"",wallets:ae,walletBalances:De}),e.jsx(_N,{isOpen:oe,onClose:()=>te(!1)}),e.jsx(ue,{open:Ke,onOpenChange:xt,children:e.jsxs(me,{className:"sm:max-w-md",dir:"rtl",children:[e.jsx(be,{children:e.jsxs(he,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(Pm,{className:"h-5 w-5"}),"ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„"]})}),e.jsxs("div",{className:"flex flex-col items-center justify-center py-4 space-y-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(Pm,{className:"h-6 w-6 text-red-600"})}),e.jsxs("p",{className:"text-center text-gray-600",children:["Ø¹ÙÙˆØ§Ù‹ØŒ Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù….",e.jsx("br",{}),"ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ù…Ù† Ù‚Ø¨Ù„ Ù…Ø§Ù„Ùƒ Ø§Ù„Ø­Ø³Ø§Ø¨."]})]}),e.jsx($e,{className:"sm:justify-center",children:e.jsx(A,{variant:"outline",onClick:()=>xt(!1),className:"w-full sm:w-auto",children:"Ø­Ø³Ù†Ø§Ù‹"})})]})}),e.jsx(ry,{isOpen:$,onClose:pt,userName:(o==null?void 0:o.name)||((Nm=t==null?void 0:t.displayName)==null?void 0:Nm.split(" ")[0])||""}),e.jsx(mh,{isOpen:ve,onClose:()=>je(!1),videoUrl:At,title:de})]}))},Oj=Object.freeze(Object.defineProperty({__proto__:null,default:RN},Symbol.toStringTag,{value:"Module"}));export{bc as C,fh as P,Oj as U,ka as a,ur as b,Ca as c,Ah as d,qm as e,zm as f,ga as g,pc as h};
//# sourceMappingURL=UserDashboardPage-XbIVMTiD.js.map
