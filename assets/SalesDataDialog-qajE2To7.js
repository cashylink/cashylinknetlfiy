const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CgV0sHeM.js","./index-Cb-j8PFL.css"])))=>i.map(i=>d[i]);
import{a0 as ls,cg as Xu,ch as l0,r as Ue,m as zu,u as Yu,aQ as Ku,ag as qu,R as Ki,q as ir,aL as _t,s as Kt,t as ut,V as vc,af as Bn,x as Or,w as qi,j as w,ah as En,ai as _n,ak as An,B as it,ba as ql,ax as f0,c as bn,d as Zu,e as Ju,g as co,H as Zl,K as ks,y as lr,aa as ii,aY as yc,C as lo,a3 as si,I as er,aw as Zi,J as Qu,ab as Jl,av as Ec,aj as Ci,aM as Si,au as Ka,W as ha,E as Aa,bb as $u,aK as _c,a7 as ed,a6 as td,bA as rd,aV as h0,a5 as ad,D as Is,$ as Ql,v as nd,aO as Ti,aR as Ac}from"./index-CgV0sHeM.js";import{T as fo,a as ho,b as Ni,c as pr,d as uo,e as wr}from"./table-Ry-VsunV.js";import{T as id,a as sd,b as bc,c as Cc,S as Sc}from"./tabs-B1SNyKq6.js";import{D as $l,a as ef,b as tf,e as u0}from"./dropdown-menu-CLdLSeyn.js";import{S as xo}from"./separator-CArj5DvN.js";import{C as go,e as od,S as Tc,a as Nc,b as kc,c as Ic,d as Ds}from"./select-Cjxh7T8L.js";import{A as mo,a as po,b as wo,c as vo,d as yo,e as Eo,f as _o,g as Ao}from"./alert-dialog-CocjFfXp.js";import{b as Dc,a as d0,c as x0,d as cd,P as rf,e as af,f as nf,g as bo,h as sf,C as of}from"./UserDashboardPage-BxOlnKZi.js";import{C as ld,V as fd}from"./VideoModal-3NrJTmLh.js";import{C as hd}from"./chart-column-DR-1RCFv.js";import{D as Fs}from"./dollar-sign-CUtjmL1D.js";import{C as Co}from"./calendar-0_98-YC1.js";import{S as ud}from"./save-CK42wzuM.js";import{P as dd}from"./printer-D4O-3a9p.js";import{P as cf}from"./pen-line-dJR2NKoC.js";import{A as lf}from"./arrow-left-L-ZCLYHX.js";import{T as So}from"./trending-down-Kg7mUqrL.js";import{C as xd}from"./users-DcT8Qdqe.js";import"./index-BVTp5Qlg.js";import"./SimCardsAccessDialog-ja1xLiJY.js";import"./ProfileSettingsPage-6rJ-8Y1I.js";import"./switch-CQytG77E.js";import"./square-pen-B77-kNO1.js";import"./circle-check-big-iKMCgwGI.js";import"./crown-2lrrj6PS.js";import"./ProfileIcon-CCS5CeGE.js";import"./freeTrialService-DU5AUvYv.js";import"./broadcastService-DLuBcfgc.js";import"./bell-CyrMMN44.js";import"./profitService-9EsNGq16.js";import"./arrow-down-left-BR8IyOzF.js";import"./wallet-BjpRmBYz.js";import"./star-DyMukElk.js";function gd(e,r){for(var t=0;t<r.length;t++){const n=r[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const c=Object.getOwnPropertyDescriptor(n,s);c&&Object.defineProperty(e,s,c.get?c:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const md=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],ff=ls("ellipsis-vertical",md);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],wd=ls("file-down",pd);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],yd=ls("file-up",vd);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],_d=ls("info",Ed);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ad=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ln=ls("rotate-ccw",Ad);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]],g0=ls("scan-barcode",bd);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],hf=ls("shopping-cart",Cd),Sd={lessThanXSeconds:{one:"أقل من ثانية",two:"أقل من ثانيتين",threeToTen:"أقل من {{count}} ثواني",other:"أقل من {{count}} ثانية"},xSeconds:{one:"ثانية",two:"ثانيتين",threeToTen:"{{count}} ثواني",other:"{{count}} ثانية"},halfAMinute:"نص دقيقة",lessThanXMinutes:{one:"أقل من دقيقة",two:"أقل من دقيقتين",threeToTen:"أقل من {{count}} دقايق",other:"أقل من {{count}} دقيقة"},xMinutes:{one:"دقيقة",two:"دقيقتين",threeToTen:"{{count}} دقايق",other:"{{count}} دقيقة"},aboutXHours:{one:"حوالي ساعة",two:"حوالي ساعتين",threeToTen:"حوالي {{count}} ساعات",other:"حوالي {{count}} ساعة"},xHours:{one:"ساعة",two:"ساعتين",threeToTen:"{{count}} ساعات",other:"{{count}} ساعة"},xDays:{one:"يوم",two:"يومين",threeToTen:"{{count}} أيام",other:"{{count}} يوم"},aboutXWeeks:{one:"حوالي أسبوع",two:"حوالي أسبوعين",threeToTen:"حوالي {{count}} أسابيع",other:"حوالي {{count}} أسبوع"},xWeeks:{one:"أسبوع",two:"أسبوعين",threeToTen:"{{count}} أسابيع",other:"{{count}} أسبوع"},aboutXMonths:{one:"حوالي شهر",two:"حوالي شهرين",threeToTen:"حوالي {{count}} أشهر",other:"حوالي {{count}} شهر"},xMonths:{one:"شهر",two:"شهرين",threeToTen:"{{count}} أشهر",other:"{{count}} شهر"},aboutXYears:{one:"حوالي سنة",two:"حوالي سنتين",threeToTen:"حوالي {{count}} سنين",other:"حوالي {{count}} سنة"},xYears:{one:"عام",two:"عامين",threeToTen:"{{count}} أعوام",other:"{{count}} عام"},overXYears:{one:"أكثر من سنة",two:"أكثر من سنتين",threeToTen:"أكثر من {{count}} سنين",other:"أكثر من {{count}} سنة"},almostXYears:{one:"عام تقريبًا",two:"عامين تقريبًا",threeToTen:"{{count}} أعوام تقريبًا",other:"{{count}} عام تقريبًا"}},Td=(e,r,t)=>{let n;const s=Sd[e];return typeof s=="string"?n=s:r===1?n=s.one:r===2?n=s.two:r<=10?n=s.threeToTen.replace("{{count}}",String(r)):n=s.other.replace("{{count}}",String(r)),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?`في خلال ${n}`:`منذ ${n}`:n},Nd={full:"EEEE، do MMMM y",long:"do MMMM y",medium:"dd/MMM/y",short:"d/MM/y"},kd={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Id={full:"{{date}} 'الساعة' {{time}}",long:"{{date}} 'الساعة' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Dd={date:Dc({formats:Nd,defaultWidth:"full"}),time:Dc({formats:kd,defaultWidth:"full"}),dateTime:Dc({formats:Id,defaultWidth:"full"})},Fd={lastWeek:"eeee 'اللي جاي الساعة' p",yesterday:"'إمبارح الساعة' p",today:"'النهاردة الساعة' p",tomorrow:"'بكرة الساعة' p",nextWeek:"eeee 'الساعة' p",other:"P"},Od=(e,r,t,n)=>Fd[e],Rd={narrow:["ق","ب"],abbreviated:["ق.م","ب.م"],wide:["قبل الميلاد","بعد الميلاد"]},Md={narrow:["1","2","3","4"],abbreviated:["ر1","ر2","ر3","ر4"],wide:["الربع الأول","الربع الثاني","الربع الثالث","الربع الرابع"]},Pd={narrow:["ي","ف","م","أ","م","ي","ي","أ","س","أ","ن","د"],abbreviated:["ينا","فبر","مارس","أبريل","مايو","يونـ","يولـ","أغسـ","سبتـ","أكتـ","نوفـ","ديسـ"],wide:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"]},Bd={narrow:["ح","ن","ث","ر","خ","ج","س"],short:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],abbreviated:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],wide:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"]},Ld={narrow:{am:"ص",pm:"م",midnight:"ن",noon:"ظ",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءً",night:"ليلاً"},abbreviated:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهراً",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءً",night:"ليلاً"},wide:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهراً",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءً",night:"ليلاً"}},jd={narrow:{am:"ص",pm:"م",midnight:"ن",noon:"ظ",morning:"في الصباح",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل"},abbreviated:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهراً",morning:"في الصباح",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل"},wide:{am:"ص",pm:"م",midnight:"نصف الليل",morning:"في الصباح",noon:"ظهراً",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل"}},Ud=(e,r)=>String(e),Wd={ordinalNumber:Ud,era:d0({values:Rd,defaultWidth:"wide"}),quarter:d0({values:Md,defaultWidth:"wide",argumentCallback:e=>e-1}),month:d0({values:Pd,defaultWidth:"wide"}),day:d0({values:Bd,defaultWidth:"wide"}),dayPeriod:d0({values:Ld,defaultWidth:"wide",formattingValues:jd,defaultFormattingWidth:"wide"})},Vd=/^(\d+)/,Hd=/\d+/i,Gd={narrow:/^(ق|ب)/g,abbreviated:/^(ق.م|ب.م)/g,wide:/^(قبل الميلاد|بعد الميلاد)/g},Xd={any:[/^ق/g,/^ب/g]},zd={narrow:/^[1234]/,abbreviated:/^ر[1234]/,wide:/^الربع (الأول|الثاني|الثالث|الرابع)/},Yd={wide:[/الربع الأول/,/الربع الثاني/,/الربع الثالث/,/الربع الرابع/],any:[/1/,/2/,/3/,/4/]},Kd={narrow:/^(ي|ف|م|أ|س|ن|د)/,abbreviated:/^(ينا|فبر|مارس|أبريل|مايو|يونـ|يولـ|أغسـ|سبتـ|أكتـ|نوفـ|ديسـ)/,wide:/^(يناير|فبراير|مارس|أبريل|مايو|يونيو|يوليو|أغسطس|سبتمبر|أكتوبر|نوفمبر|ديسمبر)/},qd={narrow:[/^ي/,/^ف/,/^م/,/^أ/,/^م/,/^ي/,/^ي/,/^أ/,/^س/,/^أ/,/^ن/,/^د/],any:[/^ينا/,/^فبر/,/^مارس/,/^أبريل/,/^مايو/,/^يون/,/^يول/,/^أغس/,/^سبت/,/^أكت/,/^نوف/,/^ديس/]},Zd={narrow:/^(ح|ن|ث|ر|خ|ج|س)/,short:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/,abbreviated:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/,wide:/^(الأحد|الاثنين|الثلاثاء|الأربعاء|الخميس|الجمعة|السبت)/},Jd={narrow:[/^ح/,/^ن/,/^ث/,/^ر/,/^خ/,/^ج/,/^س/],any:[/أحد/,/اثنين/,/ثلاثاء/,/أربعاء/,/خميس/,/جمعة/,/سبت/]},Qd={narrow:/^(ص|م|ن|ظ|في الصباح|بعد الظهر|في المساء|في الليل)/,abbreviated:/^(ص|م|نصف الليل|ظهراً|في الصباح|بعد الظهر|في المساء|في الليل)/,wide:/^(ص|م|نصف الليل|في الصباح|ظهراً|بعد الظهر|في المساء|في الليل)/,any:/^(ص|م|صباح|ظهر|مساء|ليل)/},$d={any:{am:/^ص/,pm:/^م/,midnight:/^ن/,noon:/^ظ/,morning:/^ص/,afternoon:/^بعد/,evening:/^م/,night:/^ل/}},ex={ordinalNumber:cd({matchPattern:Vd,parsePattern:Hd,valueCallback:function(e){return parseInt(e,10)}}),era:x0({matchPatterns:Gd,defaultMatchWidth:"wide",parsePatterns:Xd,defaultParseWidth:"any"}),quarter:x0({matchPatterns:zd,defaultMatchWidth:"wide",parsePatterns:Yd,defaultParseWidth:"any",valueCallback:e=>e+1}),month:x0({matchPatterns:Kd,defaultMatchWidth:"wide",parsePatterns:qd,defaultParseWidth:"any"}),day:x0({matchPatterns:Zd,defaultMatchWidth:"wide",parsePatterns:Jd,defaultParseWidth:"any"}),dayPeriod:x0({matchPatterns:Qd,defaultMatchWidth:"any",parsePatterns:$d,defaultParseWidth:"any"})},To={code:"ar-EG",formatDistance:Td,formatLong:Dd,formatRelative:Od,localize:Wd,match:ex,options:{weekStartsOn:0,firstWeekContainsDate:1}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Vo={};Vo.version="0.18.5";var F1=1252,tx=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],sl={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ol=function(e){tx.indexOf(e)!=-1&&(F1=sl[0]=e)};function rx(){ol(1252)}var Sn=function(e){ol(e)};function cl(){Sn(1200),rx()}function uf(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function ax(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function O1(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var p0=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?ax(e.slice(2)):r==254&&t==255?O1(e.slice(2)):r==65279?e.slice(1):e},No=function(r){return String.fromCharCode(r)},df=function(r){return String.fromCharCode(r)},N0,Ii="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function k0(e){for(var r="",t=0,n=0,s=0,c=0,h=0,d=0,m=0,g=0;g<e.length;)t=e.charCodeAt(g++),c=t>>2,n=e.charCodeAt(g++),h=(t&3)<<4|n>>4,s=e.charCodeAt(g++),d=(n&15)<<2|s>>6,m=s&63,isNaN(n)?d=m=64:isNaN(s)&&(m=64),r+=Ii.charAt(c)+Ii.charAt(h)+Ii.charAt(d)+Ii.charAt(m);return r}function en(e){var r="",t=0,n=0,s=0,c=0,h=0,d=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var g=0;g<e.length;)c=Ii.indexOf(e.charAt(g++)),h=Ii.indexOf(e.charAt(g++)),t=c<<2|h>>4,r+=String.fromCharCode(t),d=Ii.indexOf(e.charAt(g++)),n=(h&15)<<4|d>>2,d!==64&&(r+=String.fromCharCode(n)),m=Ii.indexOf(e.charAt(g++)),s=(d&3)<<6|m,m!==64&&(r+=String.fromCharCode(s));return r}var Ht=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),di=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function Fi(e){return Ht?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function xf(e){return Ht?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Qa=function(r){return Ht?di(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function nc(e){if(typeof ArrayBuffer>"u")return Qa(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function Pi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function nx(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ll(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ll(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var da=Ht?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:di(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),s=0;for(r=0,t=0;r<e.length;t+=s,++r)if(s=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function ix(e){for(var r=[],t=0,n=e.length+250,s=Fi(e.length+255),c=0;c<e.length;++c){var h=e.charCodeAt(c);if(h<128)s[t++]=h;else if(h<2048)s[t++]=192|h>>6&31,s[t++]=128|h&63;else if(h>=55296&&h<57344){h=(h&1023)+64;var d=e.charCodeAt(++c)&1023;s[t++]=240|h>>8&7,s[t++]=128|h>>2&63,s[t++]=128|d>>6&15|(h&3)<<4,s[t++]=128|d&63}else s[t++]=224|h>>12&15,s[t++]=128|h>>6&63,s[t++]=128|h&63;t>n&&(r.push(s.slice(0,t)),t=0,s=Fi(65535),n=65530)}return r.push(s.slice(0,t)),da(r)}var La=/\u0000/g,w0=/[\u0001-\u0006]/g;function js(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function Tn(e,r){var t=""+e;return t.length>=r?t:Wr("0",r-t.length)+t}function fl(e,r){var t=""+e;return t.length>=r?t:Wr(" ",r-t.length)+t}function Ho(e,r){var t=""+e;return t.length>=r?t:t+Wr(" ",r-t.length)}function sx(e,r){var t=""+Math.round(e);return t.length>=r?t:Wr("0",r-t.length)+t}function ox(e,r){var t=""+e;return t.length>=r?t:Wr("0",r-t.length)+t}var gf=Math.pow(2,32);function Os(e,r){if(e>gf||e<-gf)return sx(e,r);var t=Math.round(e);return ox(t,r)}function Go(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var mf=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Fc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function cx(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var bt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},pf={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lx={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xo(e,r,t){for(var n=e<0?-1:1,s=e*n,c=0,h=1,d=0,m=1,g=0,v=0,_=Math.floor(s);g<r&&(_=Math.floor(s),d=_*h+c,v=_*g+m,!(s-_<5e-8));)s=1/(s-_),c=h,h=d,m=g,g=v;if(v>r&&(g>r?(v=m,d=c):(v=g,d=h)),!t)return[0,n*d,v];var S=Math.floor(n*d/v);return[S,n*d-S*v,v]}function Qi(e,r,t){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),c=0,h=[],d={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),r&&r.date1904&&(n+=1462),d.u>.9999&&(d.u=0,++s==86400&&(d.T=s=0,++n,++d.D)),n===60)h=t?[1317,10,29]:[1900,2,29],c=3;else if(n===0)h=t?[1317,8,29]:[1900,1,0],c=6;else{n>60&&--n;var m=new Date(1900,0,1);m.setDate(m.getDate()+n-1),h=[m.getFullYear(),m.getMonth()+1,m.getDate()],c=m.getDay(),n<60&&(c=(c+6)%7),t&&(c=gx(m,h))}return d.y=h[0],d.m=h[1],d.d=h[2],d.S=s%60,s=Math.floor(s/60),d.M=s%60,s=Math.floor(s/60),d.H=s,d.q=c,d}var R1=new Date(1899,11,31,0,0,0),fx=R1.getTime(),hx=new Date(1900,2,1,0,0,0);function M1(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=hx&&(t+=24*60*60*1e3),(t-(fx+(e.getTimezoneOffset()-R1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function hl(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ux(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function dx(e){var r=e<0?12:11,t=hl(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function xx(e){var r=hl(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function I0(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=dx(e):r===10?t=e.toFixed(10).substr(0,12):t=xx(e),hl(ux(t.toUpperCase()))}function as(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):I0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return mn(14,M1(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function gx(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function mx(e,r,t,n){var s="",c=0,h=0,d=t.y,m,g=0;switch(e){case 98:d=t.y+543;case 121:switch(r.length){case 1:case 2:m=d%100,g=2;break;default:m=d%1e4,g=4;break}break;case 109:switch(r.length){case 1:case 2:m=t.m,g=r.length;break;case 3:return Fc[t.m-1][1];case 5:return Fc[t.m-1][0];default:return Fc[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:m=t.d,g=r.length;break;case 3:return mf[t.q][0];default:return mf[t.q][1]}break;case 104:switch(r.length){case 1:case 2:m=1+(t.H+11)%12,g=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:m=t.H,g=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:m=t.M,g=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?Tn(t.S,r.length):(n>=2?h=n===3?1e3:100:h=n===1?10:1,c=Math.round(h*(t.S+t.u)),c>=60*h&&(c=0),r==="s"?c===0?"0":""+c/h:(s=Tn(c,2+n),r==="ss"?s.substr(0,2):"."+s.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":m=t.D*24+t.H;break;case"[m]":case"[mm]":m=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":m=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}g=r.length===3?1:2;break;case 101:m=d,g=1;break}var v=g>0?Tn(m,g):"";return v}function Di(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var P1=/%/g;function px(e,r,t){var n=r.replace(P1,""),s=r.length-n.length;return li(e,n,t*Math.pow(10,2*s))+Wr("%",s)}function wx(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return li(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function B1(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+B1(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var c=Math.floor(Math.log(r)*Math.LOG10E)%s;if(c<0&&(c+=s),t=(r/Math.pow(10,c)).toPrecision(n+1+(s+c)%s),t.indexOf("e")===-1){var h=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(h-t.length+c):t+="E+"+(h-c);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,g,v){return m+g+v.substr(0,(s+c)%s)+"."+v.substr(c)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var L1=/# (\?+)( ?)\/( ?)(\d+)/;function vx(e,r,t){var n=parseInt(e[4],10),s=Math.round(r*n),c=Math.floor(s/n),h=s-c*n,d=n;return t+(c===0?"":""+c)+" "+(h===0?Wr(" ",e[1].length+1+e[4].length):fl(h,e[1].length)+e[2]+"/"+e[3]+Tn(d,e[4].length))}function yx(e,r,t){return t+(r===0?"":""+r)+Wr(" ",e[1].length+2+e[4].length)}var j1=/^#*0*\.([0#]+)/,U1=/\).*[0#]/,W1=/\(###\) ###\\?-####/;function Pa(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function wf(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function vf(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function Ex(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function _x(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function fn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(U1)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?fn("n",n,t):"("+fn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return wx(e,r,t);if(r.indexOf("%")!==-1)return px(e,r,t);if(r.indexOf("E")!==-1)return B1(r,t);if(r.charCodeAt(0)===36)return"$"+fn(e,r.substr(r.charAt(1)==" "?2:1),t);var s,c,h,d,m=Math.abs(t),g=t<0?"-":"";if(r.match(/^00+$/))return g+Os(m,r.length);if(r.match(/^[#?]+$/))return s=Os(t,0),s==="0"&&(s=""),s.length>r.length?s:Pa(r.substr(0,r.length-s.length))+s;if(c=r.match(L1))return vx(c,m,g);if(r.match(/^#+0+$/))return g+Os(m,r.length-r.indexOf("0"));if(c=r.match(j1))return s=wf(t,c[1].length).replace(/^([^\.]+)$/,"$1."+Pa(c[1])).replace(/\.$/,"."+Pa(c[1])).replace(/\.(\d*)$/,function(N,C){return"."+C+Wr("0",Pa(c[1]).length-C.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),c=r.match(/^(0*)\.(#*)$/))return g+wf(m,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=r.match(/^#{1,3},##0(\.?)$/))return g+Di(Os(m,0));if(c=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+fn(e,r,-t):Di(""+(Math.floor(t)+Ex(t,c[1].length)))+"."+Tn(vf(t,c[1].length),c[1].length);if(c=r.match(/^#,#*,#0/))return fn(e,r.replace(/^#,#*,/,""),t);if(c=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=js(fn(e,r.replace(/[\\-]/g,""),t)),h=0,js(js(r.replace(/\\/g,"")).replace(/[0#]/g,function(N){return h<s.length?s.charAt(h++):N==="0"?"0":""}));if(r.match(W1))return s=fn(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var v="";if(c=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(c[4].length,7),d=Xo(m,Math.pow(10,h)-1,!1),s=""+g,v=li("n",c[1],d[1]),v.charAt(v.length-1)==" "&&(v=v.substr(0,v.length-1)+"0"),s+=v+c[2]+"/"+c[3],v=Ho(d[2],h),v.length<c[4].length&&(v=Pa(c[4].substr(c[4].length-v.length))+v),s+=v,s;if(c=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(c[1].length,c[4].length),7),d=Xo(m,Math.pow(10,h)-1,!0),g+(d[0]||(d[1]?"":"0"))+" "+(d[1]?fl(d[1],h)+c[2]+"/"+c[3]+Ho(d[2],h):Wr(" ",2*h+1+c[2].length+c[3].length));if(c=r.match(/^[#0?]+$/))return s=Os(t,0),r.length<=s.length?s:Pa(r.substr(0,r.length-s.length))+s;if(c=r.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),h=s.indexOf(".");var _=r.indexOf(".")-h,S=r.length-s.length-_;return Pa(r.substr(0,_)+s+r.substr(r.length-S))}if(c=r.match(/^00,000\.([#0]*0)$/))return h=vf(t,c[1].length),t<0?"-"+fn(e,r,-t):Di(_x(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?Tn(0,3-N.length):"")+N})+"."+Tn(h,c[1].length);switch(r){case"###,##0.00":return fn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var T=Di(Os(m,0));return T!=="0"?g+T:"";case"###,###.00":return fn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return fn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Ax(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return li(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function bx(e,r,t){var n=r.replace(P1,""),s=r.length-n.length;return li(e,n,t*Math.pow(10,2*s))+Wr("%",s)}function V1(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+V1(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var c=Math.floor(Math.log(r)*Math.LOG10E)%s;if(c<0&&(c+=s),t=(r/Math.pow(10,c)).toPrecision(n+1+(s+c)%s),!t.match(/[Ee]/)){var h=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(h-t.length+c):t+="E+"+(h-c),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,g,v){return m+g+v.substr(0,(s+c)%s)+"."+v.substr(c)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Un(e,r,t){if(e.charCodeAt(0)===40&&!r.match(U1)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Un("n",n,t):"("+Un("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Ax(e,r,t);if(r.indexOf("%")!==-1)return bx(e,r,t);if(r.indexOf("E")!==-1)return V1(r,t);if(r.charCodeAt(0)===36)return"$"+Un(e,r.substr(r.charAt(1)==" "?2:1),t);var s,c,h,d,m=Math.abs(t),g=t<0?"-":"";if(r.match(/^00+$/))return g+Tn(m,r.length);if(r.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>r.length?s:Pa(r.substr(0,r.length-s.length))+s;if(c=r.match(L1))return yx(c,m,g);if(r.match(/^#+0+$/))return g+Tn(m,r.length-r.indexOf("0"));if(c=r.match(j1))return s=(""+t).replace(/^([^\.]+)$/,"$1."+Pa(c[1])).replace(/\.$/,"."+Pa(c[1])),s=s.replace(/\.(\d*)$/,function(N,C){return"."+C+Wr("0",Pa(c[1]).length-C.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),c=r.match(/^(0*)\.(#*)$/))return g+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=r.match(/^#{1,3},##0(\.?)$/))return g+Di(""+m);if(c=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Un(e,r,-t):Di(""+t)+"."+Wr("0",c[1].length);if(c=r.match(/^#,#*,#0/))return Un(e,r.replace(/^#,#*,/,""),t);if(c=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=js(Un(e,r.replace(/[\\-]/g,""),t)),h=0,js(js(r.replace(/\\/g,"")).replace(/[0#]/g,function(N){return h<s.length?s.charAt(h++):N==="0"?"0":""}));if(r.match(W1))return s=Un(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var v="";if(c=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(c[4].length,7),d=Xo(m,Math.pow(10,h)-1,!1),s=""+g,v=li("n",c[1],d[1]),v.charAt(v.length-1)==" "&&(v=v.substr(0,v.length-1)+"0"),s+=v+c[2]+"/"+c[3],v=Ho(d[2],h),v.length<c[4].length&&(v=Pa(c[4].substr(c[4].length-v.length))+v),s+=v,s;if(c=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(c[1].length,c[4].length),7),d=Xo(m,Math.pow(10,h)-1,!0),g+(d[0]||(d[1]?"":"0"))+" "+(d[1]?fl(d[1],h)+c[2]+"/"+c[3]+Ho(d[2],h):Wr(" ",2*h+1+c[2].length+c[3].length));if(c=r.match(/^[#0?]+$/))return s=""+t,r.length<=s.length?s:Pa(r.substr(0,r.length-s.length))+s;if(c=r.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),h=s.indexOf(".");var _=r.indexOf(".")-h,S=r.length-s.length-_;return Pa(r.substr(0,_)+s+r.substr(r.length-S))}if(c=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Un(e,r,-t):Di(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?Tn(0,3-N.length):"")+N})+"."+Tn(0,c[1].length);switch(r){case"###,###":case"##,###":case"#,###":var T=Di(""+m);return T!=="0"?g+T:"";default:if(r.match(/\.[0#?]*$/))return Un(e,r.slice(0,r.lastIndexOf(".")),t)+Pa(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function li(e,r,t){return(t|0)===t?Un(e,r,t):fn(e,r,t)}function Cx(e){for(var r=[],t=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(s,n-s),s=n+1}if(r[r.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var H1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zs(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Go(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(H1))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Sx(e,r,t,n){for(var s=[],c="",h=0,d="",m="t",g,v,_,S="H";h<e.length;)switch(d=e.charAt(h)){case"G":if(!Go(e,h))throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"G",v:"General"},h+=7;break;case'"':for(c="";(_=e.charCodeAt(++h))!==34&&h<e.length;)c+=String.fromCharCode(_);s[s.length]={t:"t",v:c},++h;break;case"\\":var T=e.charAt(++h),N=T==="("||T===")"?T:"t";s[s.length]={t:N,v:T},++h;break;case"_":s[s.length]={t:"t",v:" "},h+=2;break;case"@":s[s.length]={t:"T",v:r},++h;break;case"B":case"b":if(e.charAt(h+1)==="1"||e.charAt(h+1)==="2"){if(g==null&&(g=Qi(r,t,e.charAt(h+1)==="2"),g==null))return"";s[s.length]={t:"X",v:e.substr(h,2)},m=d,h+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||g==null&&(g=Qi(r,t),g==null))return"";for(c=d;++h<e.length&&e.charAt(h).toLowerCase()===d;)c+=d;d==="m"&&m.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=S),s[s.length]={t:d,v:c},m=d;break;case"A":case"a":case"上":var C={t:d,v:d};if(g==null&&(g=Qi(r,t)),e.substr(h,3).toUpperCase()==="A/P"?(g!=null&&(C.v=g.H>=12?"P":"A"),C.t="T",S="h",h+=3):e.substr(h,5).toUpperCase()==="AM/PM"?(g!=null&&(C.v=g.H>=12?"PM":"AM"),C.t="T",h+=5,S="h"):e.substr(h,5).toUpperCase()==="上午/下午"?(g!=null&&(C.v=g.H>=12?"下午":"上午"),C.t="T",h+=5,S="h"):(C.t="t",++h),g==null&&C.t==="T")return"";s[s.length]=C,m=d;break;case"[":for(c=d;e.charAt(h++)!=="]"&&h<e.length;)c+=e.charAt(h);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(H1)){if(g==null&&(g=Qi(r,t),g==null))return"";s[s.length]={t:"Z",v:c.toLowerCase()},m=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",zs(e)||(s[s.length]={t:"t",v:c}));break;case".":if(g!=null){for(c=d;++h<e.length&&(d=e.charAt(h))==="0";)c+=d;s[s.length]={t:"s",v:c};break}case"0":case"#":for(c=d;++h<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(h))>-1;)c+=d;s[s.length]={t:"n",v:c};break;case"?":for(c=d;e.charAt(++h)===d;)c+=d;s[s.length]={t:d,v:c},m=d;break;case"*":++h,(e.charAt(h)==" "||e.charAt(h)=="*")&&++h;break;case"(":case")":s[s.length]={t:n===1?"t":d,v:d},++h;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=d;h<e.length&&"0123456789".indexOf(e.charAt(++h))>-1;)c+=e.charAt(h);s[s.length]={t:"D",v:c};break;case" ":s[s.length]={t:d,v:d},++h;break;case"$":s[s.length]={t:"t",v:"$"},++h;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"t",v:d},++h;break}var D=0,U=0,X;for(h=s.length-1,m="t";h>=0;--h)switch(s[h].t){case"h":case"H":s[h].t=S,m="h",D<1&&(D=1);break;case"s":(X=s[h].v.match(/\.0+$/))&&(U=Math.max(U,X[0].length-1)),D<3&&(D=3);case"d":case"y":case"M":case"e":m=s[h].t;break;case"m":m==="s"&&(s[h].t="M",D<2&&(D=2));break;case"X":break;case"Z":D<1&&s[h].v.match(/[Hh]/)&&(D=1),D<2&&s[h].v.match(/[Mm]/)&&(D=2),D<3&&s[h].v.match(/[Ss]/)&&(D=3)}switch(D){case 0:break;case 1:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M),g.M>=60&&(g.M=0,++g.H);break;case 2:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M);break}var O="",q;for(h=0;h<s.length;++h)switch(s[h].t){case"t":case"T":case" ":case"D":break;case"X":s[h].v="",s[h].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[h].v=mx(s[h].t.charCodeAt(0),s[h].v,g,U),s[h].t="t";break;case"n":case"?":for(q=h+1;s[q]!=null&&((d=s[q].t)==="?"||d==="D"||(d===" "||d==="t")&&s[q+1]!=null&&(s[q+1].t==="?"||s[q+1].t==="t"&&s[q+1].v==="/")||s[h].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(s[q].v==="/"||s[q].v===" "&&s[q+1]!=null&&s[q+1].t=="?"));)s[h].v+=s[q].v,s[q]={v:"",t:";"},++q;O+=s[h].v,h=q-1;break;case"G":s[h].t="t",s[h].v=as(r,t);break}var oe="",J,M;if(O.length>0){O.charCodeAt(0)==40?(J=r<0&&O.charCodeAt(0)===45?-r:r,M=li("n",O,J)):(J=r<0&&n>1?-r:r,M=li("n",O,J),J<0&&s[0]&&s[0].t=="t"&&(M=M.substr(1),s[0].v="-"+s[0].v)),q=M.length-1;var ie=s.length;for(h=0;h<s.length;++h)if(s[h]!=null&&s[h].t!="t"&&s[h].v.indexOf(".")>-1){ie=h;break}var j=s.length;if(ie===s.length&&M.indexOf("E")===-1){for(h=s.length-1;h>=0;--h)s[h]==null||"n?".indexOf(s[h].t)===-1||(q>=s[h].v.length-1?(q-=s[h].v.length,s[h].v=M.substr(q+1,s[h].v.length)):q<0?s[h].v="":(s[h].v=M.substr(0,q+1),q=-1),s[h].t="t",j=h);q>=0&&j<s.length&&(s[j].v=M.substr(0,q+1)+s[j].v)}else if(ie!==s.length&&M.indexOf("E")===-1){for(q=M.indexOf(".")-1,h=ie;h>=0;--h)if(!(s[h]==null||"n?".indexOf(s[h].t)===-1)){for(v=s[h].v.indexOf(".")>-1&&h===ie?s[h].v.indexOf(".")-1:s[h].v.length-1,oe=s[h].v.substr(v+1);v>=0;--v)q>=0&&(s[h].v.charAt(v)==="0"||s[h].v.charAt(v)==="#")&&(oe=M.charAt(q--)+oe);s[h].v=oe,s[h].t="t",j=h}for(q>=0&&j<s.length&&(s[j].v=M.substr(0,q+1)+s[j].v),q=M.indexOf(".")+1,h=ie;h<s.length;++h)if(!(s[h]==null||"n?(".indexOf(s[h].t)===-1&&h!==ie)){for(v=s[h].v.indexOf(".")>-1&&h===ie?s[h].v.indexOf(".")+1:0,oe=s[h].v.substr(0,v);v<s[h].v.length;++v)q<M.length&&(oe+=M.charAt(q++));s[h].v=oe,s[h].t="t",j=h}}}for(h=0;h<s.length;++h)s[h]!=null&&"n?".indexOf(s[h].t)>-1&&(J=n>1&&r<0&&h>0&&s[h-1].v==="-"?-r:r,s[h].v=li(s[h].t,s[h].v,J),s[h].t="t");var _e="";for(h=0;h!==s.length;++h)s[h]!=null&&(_e+=s[h].v);return _e}var yf=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ef(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function Tx(e,r){var t=Cx(e),n=t.length,s=t[n-1].indexOf("@");if(n<4&&s>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var c=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,c];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var h=t[0].match(yf),d=t[1].match(yf);return Ef(r,h)?[n,t[0]]:Ef(r,d)?[n,t[1]]:[n,t[h!=null&&d!=null?2:1]]}return[n,c]}function mn(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:bt)[e],n==null&&(n=t.table&&t.table[pf[e]]||bt[pf[e]]),n==null&&(n=lx[e]||"General");break}if(Go(n,0))return as(r,t);r instanceof Date&&(r=M1(r,t.date1904));var s=Tx(n,r);if(Go(s[1]))return as(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Sx(s[1],r,t,s[0])}function fi(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(bt[t]==null){r<0&&(r=t);continue}if(bt[t]==e){r=t;break}}r<0&&(r=391)}return bt[r]=e,r}function ic(e){for(var r=0;r!=392;++r)e[r]!==void 0&&fi(e[r],r)}function Ys(){bt=cx()}var Nx={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},G1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function kx(e){var r=typeof e=="number"?bt[e]:e;return r=r.replace(G1,"(\\d+)"),new RegExp("^"+r+"$")}function Ix(e,r,t){var n=-1,s=-1,c=-1,h=-1,d=-1,m=-1;(r.match(G1)||[]).forEach(function(_,S){var T=parseInt(t[S+1],10);switch(_.toLowerCase().charAt(0)){case"y":n=T;break;case"d":c=T;break;case"h":h=T;break;case"s":m=T;break;case"m":h>=0?d=T:s=T;break}}),m>=0&&d==-1&&s>=0&&(d=s,s=-1);var g=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);g.length==7&&(g="0"+g),g.length==8&&(g="20"+g);var v=("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return h==-1&&d==-1&&m==-1?g:n==-1&&s==-1&&c==-1?v:g+"T"+v}var Dx=function(){var e={};e.version="1.2.0";function r(){for(var M=0,ie=new Array(256),j=0;j!=256;++j)M=j,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,ie[j]=M;return typeof Int32Array<"u"?new Int32Array(ie):ie}var t=r();function n(M){var ie=0,j=0,_e=0,he=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(_e=0;_e!=256;++_e)he[_e]=M[_e];for(_e=0;_e!=256;++_e)for(j=M[_e],ie=256+_e;ie<4096;ie+=256)j=he[ie]=j>>>8^M[j&255];var te=[];for(_e=1;_e!=16;++_e)te[_e-1]=typeof Int32Array<"u"?he.subarray(_e*256,_e*256+256):he.slice(_e*256,_e*256+256);return te}var s=n(t),c=s[0],h=s[1],d=s[2],m=s[3],g=s[4],v=s[5],_=s[6],S=s[7],T=s[8],N=s[9],C=s[10],D=s[11],U=s[12],X=s[13],O=s[14];function q(M,ie){for(var j=ie^-1,_e=0,he=M.length;_e<he;)j=j>>>8^t[(j^M.charCodeAt(_e++))&255];return~j}function oe(M,ie){for(var j=ie^-1,_e=M.length-15,he=0;he<_e;)j=O[M[he++]^j&255]^X[M[he++]^j>>8&255]^U[M[he++]^j>>16&255]^D[M[he++]^j>>>24]^C[M[he++]]^N[M[he++]]^T[M[he++]]^S[M[he++]]^_[M[he++]]^v[M[he++]]^g[M[he++]]^m[M[he++]]^d[M[he++]]^h[M[he++]]^c[M[he++]]^t[M[he++]];for(_e+=15;he<_e;)j=j>>>8^t[(j^M[he++])&255];return~j}function J(M,ie){for(var j=ie^-1,_e=0,he=M.length,te=0,be=0;_e<he;)te=M.charCodeAt(_e++),te<128?j=j>>>8^t[(j^te)&255]:te<2048?(j=j>>>8^t[(j^(192|te>>6&31))&255],j=j>>>8^t[(j^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,be=M.charCodeAt(_e++)&1023,j=j>>>8^t[(j^(240|te>>8&7))&255],j=j>>>8^t[(j^(128|te>>2&63))&255],j=j>>>8^t[(j^(128|be>>6&15|(te&3)<<4))&255],j=j>>>8^t[(j^(128|be&63))&255]):(j=j>>>8^t[(j^(224|te>>12&15))&255],j=j>>>8^t[(j^(128|te>>6&63))&255],j=j>>>8^t[(j^(128|te&63))&255]);return~j}return e.table=t,e.bstr=q,e.buf=oe,e.str=J,e}(),gt=function(){var r={};r.version="1.2.1";function t(F,B){for(var L=F.split("/"),W=B.split("/"),H=0,z=0,me=Math.min(L.length,W.length);H<me;++H){if(z=L[H].length-W[H].length)return z;if(L[H]!=W[H])return L[H]<W[H]?-1:1}return L.length-W.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var B=F.lastIndexOf("/");return B===-1?F:F.slice(0,B+1)}function s(F){if(F.charAt(F.length-1)=="/")return s(F.slice(0,-1));var B=F.lastIndexOf("/");return B===-1?F:F.slice(B+1)}function c(F,B){typeof B=="string"&&(B=new Date(B));var L=B.getHours();L=L<<6|B.getMinutes(),L=L<<5|B.getSeconds()>>>1,F.write_shift(2,L);var W=B.getFullYear()-1980;W=W<<4|B.getMonth()+1,W=W<<5|B.getDate(),F.write_shift(2,W)}function h(F){var B=F.read_shift(2)&65535,L=F.read_shift(2)&65535,W=new Date,H=L&31;L>>>=5;var z=L&15;L>>>=4,W.setMilliseconds(0),W.setFullYear(L+1980),W.setMonth(z-1),W.setDate(H);var me=B&31;B>>>=5;var Ie=B&63;return B>>>=6,W.setHours(B),W.setMinutes(Ie),W.setSeconds(me<<1),W}function d(F){wa(F,0);for(var B={},L=0;F.l<=F.length-4;){var W=F.read_shift(2),H=F.read_shift(2),z=F.l+H,me={};switch(W){case 21589:L=F.read_shift(1),L&1&&(me.mtime=F.read_shift(4)),H>5&&(L&2&&(me.atime=F.read_shift(4)),L&4&&(me.ctime=F.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}F.l=z,B[W]=me}return B}var m;function g(){return m||(m={})}function v(F,B){if(F[0]==80&&F[1]==75)return mi(F,B);if((F[0]|32)==109&&(F[1]|32)==105)return na(F,B);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var L=3,W=512,H=0,z=0,me=0,Ie=0,ue=0,we=[],pe=F.slice(0,512);wa(pe,0);var We=_(pe);switch(L=We[0],L){case 3:W=512;break;case 4:W=4096;break;case 0:if(We[1]==0)return mi(F,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}W!==512&&(pe=F.slice(0,W),wa(pe,28));var ze=F.slice(0,W);S(pe,L);var Ye=pe.read_shift(4,"i");if(L===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);pe.l+=4,me=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),Ie=pe.read_shift(4,"i"),H=pe.read_shift(4,"i"),ue=pe.read_shift(4,"i"),z=pe.read_shift(4,"i");for(var Ke=-1,nt=0;nt<109&&(Ke=pe.read_shift(4,"i"),!(Ke<0));++nt)we[nt]=Ke;var yt=T(F,W);D(ue,z,yt,W,we);var Se=X(yt,me,we,W);Se[me].name="!Directory",H>0&&Ie!==be&&(Se[Ie].name="!MiniFAT"),Se[we[0]].name="!FAT",Se.fat_addrs=we,Se.ssz=W;var hr={},Mt=[],Jr=[],Xa=[];O(me,Se,yt,Mt,H,hr,Jr,Ie),N(Jr,Xa,Mt),Mt.shift();var It={FileIndex:Jr,FullPaths:Xa};return B&&B.raw&&(It.raw={header:ze,sectors:yt}),It}function _(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk($e,"Header Signature: "),F.l+=16;var B=F.read_shift(2,"u");return[F.read_shift(2,"u"),B]}function S(F,B){var L=9;switch(F.l+=2,L=F.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function T(F,B){for(var L=Math.ceil(F.length/B)-1,W=[],H=1;H<L;++H)W[H-1]=F.slice(H*B,(H+1)*B);return W[L-1]=F.slice(L*B),W}function N(F,B,L){for(var W=0,H=0,z=0,me=0,Ie=0,ue=L.length,we=[],pe=[];W<ue;++W)we[W]=pe[W]=W,B[W]=L[W];for(;Ie<pe.length;++Ie)W=pe[Ie],H=F[W].L,z=F[W].R,me=F[W].C,we[W]===W&&(H!==-1&&we[H]!==H&&(we[W]=we[H]),z!==-1&&we[z]!==z&&(we[W]=we[z])),me!==-1&&(we[me]=W),H!==-1&&W!=we[W]&&(we[H]=we[W],pe.lastIndexOf(H)<Ie&&pe.push(H)),z!==-1&&W!=we[W]&&(we[z]=we[W],pe.lastIndexOf(z)<Ie&&pe.push(z));for(W=1;W<ue;++W)we[W]===W&&(z!==-1&&we[z]!==z?we[W]=we[z]:H!==-1&&we[H]!==H&&(we[W]=we[H]));for(W=1;W<ue;++W)if(F[W].type!==0){if(Ie=W,Ie!=we[Ie])do Ie=we[Ie],B[W]=B[Ie]+"/"+B[W];while(Ie!==0&&we[Ie]!==-1&&Ie!=we[Ie]);we[W]=-1}for(B[0]+="/",W=1;W<ue;++W)F[W].type!==2&&(B[W]+="/")}function C(F,B,L){for(var W=F.start,H=F.size,z=[],me=W;L&&H>0&&me>=0;)z.push(B.slice(me*te,me*te+te)),H-=te,me=Ji(L,me*4);return z.length===0?Oe(0):da(z).slice(0,F.size)}function D(F,B,L,W,H){var z=be;if(F===be){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var me=L[F],Ie=(W>>>2)-1;if(!me)return;for(var ue=0;ue<Ie&&(z=Ji(me,ue*4))!==be;++ue)H.push(z);D(Ji(me,W-4),B-1,L,W,H)}}function U(F,B,L,W,H){var z=[],me=[];H||(H=[]);var Ie=W-1,ue=0,we=0;for(ue=B;ue>=0;){H[ue]=!0,z[z.length]=ue,me.push(F[ue]);var pe=L[Math.floor(ue*4/W)];if(we=ue*4&Ie,W<4+we)throw new Error("FAT boundary crossed: "+ue+" 4 "+W);if(!F[pe])break;ue=Ji(F[pe],we)}return{nodes:z,data:Of([me])}}function X(F,B,L,W){var H=F.length,z=[],me=[],Ie=[],ue=[],we=W-1,pe=0,We=0,ze=0,Ye=0;for(pe=0;pe<H;++pe)if(Ie=[],ze=pe+B,ze>=H&&(ze-=H),!me[ze]){ue=[];var Ke=[];for(We=ze;We>=0;){Ke[We]=!0,me[We]=!0,Ie[Ie.length]=We,ue.push(F[We]);var nt=L[Math.floor(We*4/W)];if(Ye=We*4&we,W<4+Ye)throw new Error("FAT boundary crossed: "+We+" 4 "+W);if(!F[nt]||(We=Ji(F[nt],Ye),Ke[We]))break}z[ze]={nodes:Ie,data:Of([ue])}}return z}function O(F,B,L,W,H,z,me,Ie){for(var ue=0,we=W.length?2:0,pe=B[F].data,We=0,ze=0,Ye;We<pe.length;We+=128){var Ke=pe.slice(We,We+128);wa(Ke,64),ze=Ke.read_shift(2),Ye=wl(Ke,0,ze-we),W.push(Ye);var nt={name:Ye,type:Ke.read_shift(1),color:Ke.read_shift(1),L:Ke.read_shift(4,"i"),R:Ke.read_shift(4,"i"),C:Ke.read_shift(4,"i"),clsid:Ke.read_shift(16),state:Ke.read_shift(4,"i"),start:0,size:0},yt=Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2);yt!==0&&(nt.ct=q(Ke,Ke.l-8));var Se=Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2);Se!==0&&(nt.mt=q(Ke,Ke.l-8)),nt.start=Ke.read_shift(4,"i"),nt.size=Ke.read_shift(4,"i"),nt.size<0&&nt.start<0&&(nt.size=nt.type=0,nt.start=be,nt.name=""),nt.type===5?(ue=nt.start,H>0&&ue!==be&&(B[ue].name="!StreamData")):nt.size>=4096?(nt.storage="fat",B[nt.start]===void 0&&(B[nt.start]=U(L,nt.start,B.fat_addrs,B.ssz)),B[nt.start].name=nt.name,nt.content=B[nt.start].data.slice(0,nt.size)):(nt.storage="minifat",nt.size<0?nt.size=0:ue!==be&&nt.start!==be&&B[ue]&&(nt.content=C(nt,B[ue].data,(B[Ie]||{}).data))),nt.content&&wa(nt.content,0),z[Ye]=nt,me.push(nt)}}function q(F,B){return new Date((Ja(F,B+4)/1e7*Math.pow(2,32)+Ja(F,B)/1e7-11644473600)*1e3)}function oe(F,B){return g(),v(m.readFileSync(F),B)}function J(F,B){var L=B&&B.type;switch(L||Ht&&Buffer.isBuffer(F)&&(L="buffer"),L||"base64"){case"file":return oe(F,B);case"base64":return v(Qa(en(F)),B);case"binary":return v(Qa(F),B)}return v(F,B)}function M(F,B){var L=B||{},W=L.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=W+"/",F.FileIndex[0]={name:W,type:5}),L.CLSID&&(F.FileIndex[0].clsid=L.CLSID),ie(F)}function ie(F){var B="Sh33tJ5";if(!gt.find(F,"/"+B)){var L=Oe(4);L[0]=55,L[1]=L[3]=50,L[2]=54,F.FileIndex.push({name:B,type:2,content:L,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+B),j(F)}}function j(F,B){M(F);for(var L=!1,W=!1,H=F.FullPaths.length-1;H>=0;--H){var z=F.FileIndex[H];switch(z.type){case 0:W?L=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(z.R*z.L*z.C)&&(L=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!B)){var me=new Date(1987,1,19),Ie=0,ue=Object.create?Object.create(null):{},we=[];for(H=0;H<F.FullPaths.length;++H)ue[F.FullPaths[H]]=!0,F.FileIndex[H].type!==0&&we.push([F.FullPaths[H],F.FileIndex[H]]);for(H=0;H<we.length;++H){var pe=n(we[H][0]);W=ue[pe],W||(we.push([pe,{name:s(pe).replace("/",""),type:1,clsid:tt,ct:me,mt:me,content:null}]),ue[pe]=!0)}for(we.sort(function(Ye,Ke){return t(Ye[0],Ke[0])}),F.FullPaths=[],F.FileIndex=[],H=0;H<we.length;++H)F.FullPaths[H]=we[H][0],F.FileIndex[H]=we[H][1];for(H=0;H<we.length;++H){var We=F.FileIndex[H],ze=F.FullPaths[H];if(We.name=s(ze).replace("/",""),We.L=We.R=We.C=-(We.color=1),We.size=We.content?We.content.length:0,We.start=0,We.clsid=We.clsid||tt,H===0)We.C=we.length>1?1:-1,We.size=0,We.type=5;else if(ze.slice(-1)=="/"){for(Ie=H+1;Ie<we.length&&n(F.FullPaths[Ie])!=ze;++Ie);for(We.C=Ie>=we.length?-1:Ie,Ie=H+1;Ie<we.length&&n(F.FullPaths[Ie])!=n(ze);++Ie);We.R=Ie>=we.length?-1:Ie,We.type=1}else n(F.FullPaths[H+1]||"")==n(ze)&&(We.R=H+1),We.type=2}}}function _e(F,B){var L=B||{};if(L.fileType=="mad")return Zr(F,L);switch(j(F),L.fileType){case"zip":return Ga(F,L)}var W=function(Ye){for(var Ke=0,nt=0,yt=0;yt<Ye.FileIndex.length;++yt){var Se=Ye.FileIndex[yt];if(Se.content){var hr=Se.content.length;hr>0&&(hr<4096?Ke+=hr+63>>6:nt+=hr+511>>9)}}for(var Mt=Ye.FullPaths.length+3>>2,Jr=Ke+7>>3,Xa=Ke+127>>7,It=Jr+nt+Mt+Xa,Nt=It+127>>7,jt=Nt<=109?0:Math.ceil((Nt-109)/127);It+Nt+jt+127>>7>Nt;)jt=++Nt<=109?0:Math.ceil((Nt-109)/127);var Qr=[1,jt,Nt,Xa,Mt,nt,Ke,0];return Ye.FileIndex[0].size=Ke<<6,Qr[7]=(Ye.FileIndex[0].start=Qr[0]+Qr[1]+Qr[2]+Qr[3]+Qr[4]+Qr[5])+(Qr[6]+7>>3),Qr}(F),H=Oe(W[7]<<9),z=0,me=0;{for(z=0;z<8;++z)H.write_shift(1,ae[z]);for(z=0;z<8;++z)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),z=0;z<3;++z)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,W[2]),H.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:be),H.write_shift(4,W[3]),H.write_shift(-4,W[1]?W[0]-1:be),H.write_shift(4,W[1]),z=0;z<109;++z)H.write_shift(-4,z<W[2]?W[1]+z:-1)}if(W[1])for(me=0;me<W[1];++me){for(;z<236+me*127;++z)H.write_shift(-4,z<W[2]?W[1]+z:-1);H.write_shift(-4,me===W[1]-1?be:me+1)}var Ie=function(Ye){for(me+=Ye;z<me-1;++z)H.write_shift(-4,z+1);Ye&&(++z,H.write_shift(-4,be))};for(me=z=0,me+=W[1];z<me;++z)H.write_shift(-4,Re.DIFSECT);for(me+=W[2];z<me;++z)H.write_shift(-4,Re.FATSECT);Ie(W[3]),Ie(W[4]);for(var ue=0,we=0,pe=F.FileIndex[0];ue<F.FileIndex.length;++ue)pe=F.FileIndex[ue],pe.content&&(we=pe.content.length,!(we<4096)&&(pe.start=me,Ie(we+511>>9)));for(Ie(W[6]+7>>3);H.l&511;)H.write_shift(-4,Re.ENDOFCHAIN);for(me=z=0,ue=0;ue<F.FileIndex.length;++ue)pe=F.FileIndex[ue],pe.content&&(we=pe.content.length,!(!we||we>=4096)&&(pe.start=me,Ie(we+63>>6)));for(;H.l&511;)H.write_shift(-4,Re.ENDOFCHAIN);for(z=0;z<W[4]<<2;++z){var We=F.FullPaths[z];if(!We||We.length===0){for(ue=0;ue<17;++ue)H.write_shift(4,0);for(ue=0;ue<3;++ue)H.write_shift(4,-1);for(ue=0;ue<12;++ue)H.write_shift(4,0);continue}pe=F.FileIndex[z],z===0&&(pe.start=pe.size?pe.start-1:be);var ze=z===0&&L.root||pe.name;if(we=2*(ze.length+1),H.write_shift(64,ze,"utf16le"),H.write_shift(2,we),H.write_shift(1,pe.type),H.write_shift(1,pe.color),H.write_shift(-4,pe.L),H.write_shift(-4,pe.R),H.write_shift(-4,pe.C),pe.clsid)H.write_shift(16,pe.clsid,"hex");else for(ue=0;ue<4;++ue)H.write_shift(4,0);H.write_shift(4,pe.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,pe.start),H.write_shift(4,pe.size),H.write_shift(4,0)}for(z=1;z<F.FileIndex.length;++z)if(pe=F.FileIndex[z],pe.size>=4096)if(H.l=pe.start+1<<9,Ht&&Buffer.isBuffer(pe.content))pe.content.copy(H,H.l,0,pe.size),H.l+=pe.size+511&-512;else{for(ue=0;ue<pe.size;++ue)H.write_shift(1,pe.content[ue]);for(;ue&511;++ue)H.write_shift(1,0)}for(z=1;z<F.FileIndex.length;++z)if(pe=F.FileIndex[z],pe.size>0&&pe.size<4096)if(Ht&&Buffer.isBuffer(pe.content))pe.content.copy(H,H.l,0,pe.size),H.l+=pe.size+63&-64;else{for(ue=0;ue<pe.size;++ue)H.write_shift(1,pe.content[ue]);for(;ue&63;++ue)H.write_shift(1,0)}if(Ht)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function he(F,B){var L=F.FullPaths.map(function(ue){return ue.toUpperCase()}),W=L.map(function(ue){var we=ue.split("/");return we[we.length-(ue.slice(-1)=="/"?2:1)]}),H=!1;B.charCodeAt(0)===47?(H=!0,B=L[0].slice(0,-1)+B):H=B.indexOf("/")!==-1;var z=B.toUpperCase(),me=H===!0?L.indexOf(z):W.indexOf(z);if(me!==-1)return F.FileIndex[me];var Ie=!z.match(w0);for(z=z.replace(La,""),Ie&&(z=z.replace(w0,"!")),me=0;me<L.length;++me)if((Ie?L[me].replace(w0,"!"):L[me]).replace(La,"")==z||(Ie?W[me].replace(w0,"!"):W[me]).replace(La,"")==z)return F.FileIndex[me];return null}var te=64,be=-2,$e="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],tt="00000000000000000000000000000000",Re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:be,FREESECT:-1,HEADER_SIGNATURE:$e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:tt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Lt(F,B,L){g();var W=_e(F,L);m.writeFileSync(B,W)}function fe(F){for(var B=new Array(F.length),L=0;L<F.length;++L)B[L]=String.fromCharCode(F[L]);return B.join("")}function ot(F,B){var L=_e(F,B);switch(B&&B.type||"buffer"){case"file":return g(),m.writeFileSync(B.filename,L),L;case"binary":return typeof L=="string"?L:fe(L);case"base64":return k0(typeof L=="string"?L:fe(L));case"buffer":if(Ht)return Buffer.isBuffer(L)?L:di(L);case"array":return typeof L=="string"?Qa(L):L}return L}var mt;function K(F){try{var B=F.InflateRaw,L=new B;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)mt=F;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function ce(F,B){if(!mt)return In(F,B);var L=mt.InflateRaw,W=new L,H=W._processChunk(F.slice(F.l),W._finishFlushFlag);return F.l+=W.bytesRead,H}function ee(F){return mt?mt.deflateRawSync(F):Ct(F)}var ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ze=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Le(F){var B=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(B>>16|B>>8|B)&255}for(var Pe=typeof Uint8Array<"u",Be=Pe?new Uint8Array(256):[],Te=0;Te<256;++Te)Be[Te]=Le(Te);function A(F,B){var L=Be[F&255];return B<=8?L>>>8-B:(L=L<<8|Be[F>>8&255],B<=16?L>>>16-B:(L=L<<8|Be[F>>16&255],L>>>24-B))}function Y(F,B){var L=B&7,W=B>>>3;return(F[W]|(L<=6?0:F[W+1]<<8))>>>L&3}function ht(F,B){var L=B&7,W=B>>>3;return(F[W]|(L<=5?0:F[W+1]<<8))>>>L&7}function lt(F,B){var L=B&7,W=B>>>3;return(F[W]|(L<=4?0:F[W+1]<<8))>>>L&15}function Xe(F,B){var L=B&7,W=B>>>3;return(F[W]|(L<=3?0:F[W+1]<<8))>>>L&31}function Me(F,B){var L=B&7,W=B>>>3;return(F[W]|(L<=1?0:F[W+1]<<8))>>>L&127}function ft(F,B,L){var W=B&7,H=B>>>3,z=(1<<L)-1,me=F[H]>>>W;return L<8-W||(me|=F[H+1]<<8-W,L<16-W)||(me|=F[H+2]<<16-W,L<24-W)||(me|=F[H+3]<<24-W),me&z}function vt(F,B,L){var W=B&7,H=B>>>3;return W<=5?F[H]|=(L&7)<<W:(F[H]|=L<<W&255,F[H+1]=(L&7)>>8-W),B+3}function qr(F,B,L){var W=B&7,H=B>>>3;return L=(L&1)<<W,F[H]|=L,B+1}function st(F,B,L){var W=B&7,H=B>>>3;return L<<=W,F[H]|=L&255,L>>>=8,F[H+1]=L,B+8}function wn(F,B,L){var W=B&7,H=B>>>3;return L<<=W,F[H]|=L&255,L>>>=8,F[H+1]=L&255,F[H+2]=L>>>8,B+16}function tn(F,B){var L=F.length,W=2*L>B?2*L:B+5,H=0;if(L>=B)return F;if(Ht){var z=xf(W);if(F.copy)F.copy(z);else for(;H<F.length;++H)z[H]=F[H];return z}else if(Pe){var me=new Uint8Array(W);if(me.set)me.set(F);else for(;H<L;++H)me[H]=F[H];return me}return F.length=W,F}function kr(F){for(var B=new Array(F),L=0;L<F;++L)B[L]=0;return B}function ga(F,B,L){var W=1,H=0,z=0,me=0,Ie=0,ue=F.length,we=Pe?new Uint16Array(32):kr(32);for(z=0;z<32;++z)we[z]=0;for(z=ue;z<L;++z)F[z]=0;ue=F.length;var pe=Pe?new Uint16Array(ue):kr(ue);for(z=0;z<ue;++z)we[H=F[z]]++,W<H&&(W=H),pe[z]=0;for(we[0]=0,z=1;z<=W;++z)we[z+16]=Ie=Ie+we[z-1]<<1;for(z=0;z<ue;++z)Ie=F[z],Ie!=0&&(pe[z]=we[Ie+16]++);var We=0;for(z=0;z<ue;++z)if(We=F[z],We!=0)for(Ie=A(pe[z],W)>>W-We,me=(1<<W+4-We)-1;me>=0;--me)B[Ie|me<<We]=We&15|z<<4;return W}var Rr=Pe?new Uint16Array(512):kr(512),Xn=Pe?new Uint16Array(32):kr(32);if(!Pe){for(var Ar=0;Ar<512;++Ar)Rr[Ar]=0;for(Ar=0;Ar<32;++Ar)Xn[Ar]=0}(function(){for(var F=[],B=0;B<32;B++)F.push(5);ga(F,Xn,32);var L=[];for(B=0;B<=143;B++)L.push(8);for(;B<=255;B++)L.push(9);for(;B<=279;B++)L.push(7);for(;B<=287;B++)L.push(8);ga(L,Rr,288)})();var Yt=function(){for(var B=Pe?new Uint8Array(32768):[],L=0,W=0;L<Ze.length-1;++L)for(;W<Ze[L+1];++W)B[W]=L;for(;W<32768;++W)B[W]=29;var H=Pe?new Uint8Array(259):[];for(L=0,W=0;L<le.length-1;++L)for(;W<le[L+1];++W)H[W]=L;function z(Ie,ue){for(var we=0;we<Ie.length;){var pe=Math.min(65535,Ie.length-we),We=we+pe==Ie.length;for(ue.write_shift(1,+We),ue.write_shift(2,pe),ue.write_shift(2,~pe&65535);pe-- >0;)ue[ue.l++]=Ie[we++]}return ue.l}function me(Ie,ue){for(var we=0,pe=0,We=Pe?new Uint16Array(32768):[];pe<Ie.length;){var ze=Math.min(65535,Ie.length-pe);if(ze<10){for(we=vt(ue,we,+(pe+ze==Ie.length)),we&7&&(we+=8-(we&7)),ue.l=we/8|0,ue.write_shift(2,ze),ue.write_shift(2,~ze&65535);ze-- >0;)ue[ue.l++]=Ie[pe++];we=ue.l*8;continue}we=vt(ue,we,+(pe+ze==Ie.length)+2);for(var Ye=0;ze-- >0;){var Ke=Ie[pe];Ye=(Ye<<5^Ke)&32767;var nt=-1,yt=0;if((nt=We[Ye])&&(nt|=pe&-32768,nt>pe&&(nt-=32768),nt<pe))for(;Ie[nt+yt]==Ie[pe+yt]&&yt<250;)++yt;if(yt>2){Ke=H[yt],Ke<=22?we=st(ue,we,Be[Ke+1]>>1)-1:(st(ue,we,3),we+=5,st(ue,we,Be[Ke-23]>>5),we+=3);var Se=Ke<8?0:Ke-4>>2;Se>0&&(wn(ue,we,yt-le[Ke]),we+=Se),Ke=B[pe-nt],we=st(ue,we,Be[Ke]>>3),we-=3;var hr=Ke<4?0:Ke-2>>1;hr>0&&(wn(ue,we,pe-nt-Ze[Ke]),we+=hr);for(var Mt=0;Mt<yt;++Mt)We[Ye]=pe&32767,Ye=(Ye<<5^Ie[pe])&32767,++pe;ze-=yt-1}else Ke<=143?Ke=Ke+48:we=qr(ue,we,1),we=st(ue,we,Be[Ke]),We[Ye]=pe&32767,++pe}we=st(ue,we,0)-1}return ue.l=(we+7)/8|0,ue.l}return function(ue,we){return ue.length<8?z(ue,we):me(ue,we)}}();function Ct(F){var B=Oe(50+Math.floor(F.length*1.1)),L=Yt(F,B);return B.slice(0,L)}var fr=Pe?new Uint16Array(32768):kr(32768),ca=Pe?new Uint16Array(32768):kr(32768),Ft=Pe?new Uint16Array(128):kr(128),Qe=1,br=1;function or(F,B){var L=Xe(F,B)+257;B+=5;var W=Xe(F,B)+1;B+=5;var H=lt(F,B)+4;B+=4;for(var z=0,me=Pe?new Uint8Array(19):kr(19),Ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue=1,we=Pe?new Uint8Array(8):kr(8),pe=Pe?new Uint8Array(8):kr(8),We=me.length,ze=0;ze<H;++ze)me[ne[ze]]=z=ht(F,B),ue<z&&(ue=z),we[z]++,B+=3;var Ye=0;for(we[0]=0,ze=1;ze<=ue;++ze)pe[ze]=Ye=Ye+we[ze-1]<<1;for(ze=0;ze<We;++ze)(Ye=me[ze])!=0&&(Ie[ze]=pe[Ye]++);var Ke=0;for(ze=0;ze<We;++ze)if(Ke=me[ze],Ke!=0){Ye=Be[Ie[ze]]>>8-Ke;for(var nt=(1<<7-Ke)-1;nt>=0;--nt)Ft[Ye|nt<<Ke]=Ke&7|ze<<3}var yt=[];for(ue=1;yt.length<L+W;)switch(Ye=Ft[Me(F,B)],B+=Ye&7,Ye>>>=3){case 16:for(z=3+Y(F,B),B+=2,Ye=yt[yt.length-1];z-- >0;)yt.push(Ye);break;case 17:for(z=3+ht(F,B),B+=3;z-- >0;)yt.push(0);break;case 18:for(z=11+Me(F,B),B+=7;z-- >0;)yt.push(0);break;default:yt.push(Ye),ue<Ye&&(ue=Ye);break}var Se=yt.slice(0,L),hr=yt.slice(L);for(ze=L;ze<286;++ze)Se[ze]=0;for(ze=W;ze<30;++ze)hr[ze]=0;return Qe=ga(Se,fr,286),br=ga(hr,ca,30),B}function yr(F,B){if(F[0]==3&&!(F[1]&3))return[Fi(B),2];for(var L=0,W=0,H=xf(B||1<<18),z=0,me=H.length>>>0,Ie=0,ue=0;!(W&1);){if(W=ht(F,L),L+=3,W>>>1)W>>1==1?(Ie=9,ue=5):(L=or(F,L),Ie=Qe,ue=br);else{L&7&&(L+=8-(L&7));var we=F[L>>>3]|F[(L>>>3)+1]<<8;if(L+=32,we>0)for(!B&&me<z+we&&(H=tn(H,z+we),me=H.length);we-- >0;)H[z++]=F[L>>>3],L+=8;continue}for(;;){!B&&me<z+32767&&(H=tn(H,z+32767),me=H.length);var pe=ft(F,L,Ie),We=W>>>1==1?Rr[pe]:fr[pe];if(L+=We&15,We>>>=4,!(We>>>8&255))H[z++]=We;else{if(We==256)break;We-=257;var ze=We<8?0:We-4>>2;ze>5&&(ze=0);var Ye=z+le[We];ze>0&&(Ye+=ft(F,L,ze),L+=ze),pe=ft(F,L,ue),We=W>>>1==1?Xn[pe]:ca[pe],L+=We&15,We>>>=4;var Ke=We<4?0:We-2>>1,nt=Ze[We];for(Ke>0&&(nt+=ft(F,L,Ke),L+=Ke),!B&&me<Ye&&(H=tn(H,Ye+100),me=H.length);z<Ye;)H[z]=H[z-nt],++z}}}return B?[H,L+7>>>3]:[H.slice(0,z),L+7>>>3]}function In(F,B){var L=F.slice(F.l||0),W=yr(L,B);return F.l+=W[1],W[0]}function rn(F,B){if(F)typeof console<"u"&&console.error(B);else throw new Error(B)}function mi(F,B){var L=F;wa(L,0);var W=[],H=[],z={FileIndex:W,FullPaths:H};M(z,{root:B.root});for(var me=L.length-4;(L[me]!=80||L[me+1]!=75||L[me+2]!=5||L[me+3]!=6)&&me>=0;)--me;L.l=me+4,L.l+=4;var Ie=L.read_shift(2);L.l+=6;var ue=L.read_shift(4);for(L.l=ue,me=0;me<Ie;++me){L.l+=20;var we=L.read_shift(4),pe=L.read_shift(4),We=L.read_shift(2),ze=L.read_shift(2),Ye=L.read_shift(2);L.l+=8;var Ke=L.read_shift(4),nt=d(L.slice(L.l+We,L.l+We+ze));L.l+=We+ze+Ye;var yt=L.l;L.l=Ke+4,Rt(L,we,pe,z,nt),L.l=yt}return z}function Rt(F,B,L,W,H){F.l+=2;var z=F.read_shift(2),me=F.read_shift(2),Ie=h(F);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var ue=F.read_shift(4),we=F.read_shift(4),pe=F.read_shift(4),We=F.read_shift(2),ze=F.read_shift(2),Ye="",Ke=0;Ke<We;++Ke)Ye+=String.fromCharCode(F[F.l++]);if(ze){var nt=d(F.slice(F.l,F.l+ze));(nt[21589]||{}).mt&&(Ie=nt[21589].mt),((H||{})[21589]||{}).mt&&(Ie=H[21589].mt)}F.l+=ze;var yt=F.slice(F.l,F.l+we);switch(me){case 8:yt=ce(F,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var Se=!1;z&8&&(ue=F.read_shift(4),ue==134695760&&(ue=F.read_shift(4),Se=!0),we=F.read_shift(4),pe=F.read_shift(4)),we!=B&&rn(Se,"Bad compressed size: "+B+" != "+we),pe!=L&&rn(Se,"Bad uncompressed size: "+L+" != "+pe),Fa(W,Ye,yt,{unsafe:!0,mt:Ie})}function Ga(F,B){var L=B||{},W=[],H=[],z=Oe(1),me=L.compression?8:0,Ie=0,ue=0,we=0,pe=0,We=0,ze=F.FullPaths[0],Ye=ze,Ke=F.FileIndex[0],nt=[],yt=0;for(ue=1;ue<F.FullPaths.length;++ue)if(Ye=F.FullPaths[ue].slice(ze.length),Ke=F.FileIndex[ue],!(!Ke.size||!Ke.content||Ye=="Sh33tJ5")){var Se=pe,hr=Oe(Ye.length);for(we=0;we<Ye.length;++we)hr.write_shift(1,Ye.charCodeAt(we)&127);hr=hr.slice(0,hr.l),nt[We]=Dx.buf(Ke.content,0);var Mt=Ke.content;me==8&&(Mt=ee(Mt)),z=Oe(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,Ie),z.write_shift(2,me),Ke.mt?c(z,Ke.mt):z.write_shift(4,0),z.write_shift(-4,nt[We]),z.write_shift(4,Mt.length),z.write_shift(4,Ke.content.length),z.write_shift(2,hr.length),z.write_shift(2,0),pe+=z.length,W.push(z),pe+=hr.length,W.push(hr),pe+=Mt.length,W.push(Mt),z=Oe(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,Ie),z.write_shift(2,me),z.write_shift(4,0),z.write_shift(-4,nt[We]),z.write_shift(4,Mt.length),z.write_shift(4,Ke.content.length),z.write_shift(2,hr.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Se),yt+=z.l,H.push(z),yt+=hr.length,H.push(hr),++We}return z=Oe(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,We),z.write_shift(2,We),z.write_shift(4,yt),z.write_shift(4,pe),z.write_shift(2,0),da([da(W),da(H),z])}var ja={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ji(F,B){if(F.ctype)return F.ctype;var L=F.name||"",W=L.match(/\.([^\.]+)$/);return W&&ja[W[1]]||B&&(W=(L=B).match(/[\.\\]([^\.\\])+$/),W&&ja[W[1]])?ja[W[1]]:"application/octet-stream"}function aa(F){for(var B=k0(F),L=[],W=0;W<B.length;W+=76)L.push(B.slice(W,W+76));return L.join(`\r
`)+`\r
`}function pi(F){var B=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(we){var pe=we.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],W=B.split(`\r
`),H=0;H<W.length;++H){var z=W[H];if(z.length==0){L.push("");continue}for(var me=0;me<z.length;){var Ie=76,ue=z.slice(me,me+Ie);ue.charAt(Ie-1)=="="?Ie--:ue.charAt(Ie-2)=="="?Ie-=2:ue.charAt(Ie-3)=="="&&(Ie-=3),ue=z.slice(me,me+Ie),me+=Ie,me<z.length&&(ue+="="),L.push(ue)}}return L.join(`\r
`)}function jr(F){for(var B=[],L=0;L<F.length;++L){for(var W=F[L];L<=F.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+F[++L];B.push(W)}for(var H=0;H<B.length;++H)B[H]=B[H].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return Qa(B.join(`\r
`))}function Dn(F,B,L){for(var W="",H="",z="",me,Ie=0;Ie<10;++Ie){var ue=B[Ie];if(!ue||ue.match(/^\s*$/))break;var we=ue.match(/^(.*?):\s*([^\s].*)$/);if(we)switch(we[1].toLowerCase()){case"content-location":W=we[2].trim();break;case"content-type":z=we[2].trim();break;case"content-transfer-encoding":H=we[2].trim();break}}switch(++Ie,H.toLowerCase()){case"base64":me=Qa(en(B.slice(Ie).join("")));break;case"quoted-printable":me=jr(B.slice(Ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var pe=Fa(F,W.slice(L.length),me,{unsafe:!0});z&&(pe.ctype=z)}function na(F,B){if(fe(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=B&&B.root||"",W=(Ht&&Buffer.isBuffer(F)?F.toString("binary"):fe(F)).split(`\r
`),H=0,z="";for(H=0;H<W.length;++H)if(z=W[H],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),L||(L=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),z.slice(0,L.length)!=L););var me=(W[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var Ie="--"+(me[1]||""),ue=[],we=[],pe={FileIndex:ue,FullPaths:we};M(pe);var We,ze=0;for(H=0;H<W.length;++H){var Ye=W[H];Ye!==Ie&&Ye!==Ie+"--"||(ze++&&Dn(pe,W.slice(We,H),L),We=H)}return pe}function Zr(F,B){var L=B||{},W=L.boundary||"SheetJS";W="------="+W;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],z=F.FullPaths[0],me=z,Ie=F.FileIndex[0],ue=1;ue<F.FullPaths.length;++ue)if(me=F.FullPaths[ue].slice(z.length),Ie=F.FileIndex[ue],!(!Ie.size||!Ie.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(yt){return"_x"+yt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(yt){return"_u"+yt.charCodeAt(0).toString(16)+"_"});for(var we=Ie.content,pe=Ht&&Buffer.isBuffer(we)?we.toString("binary"):fe(we),We=0,ze=Math.min(1024,pe.length),Ye=0,Ke=0;Ke<=ze;++Ke)(Ye=pe.charCodeAt(Ke))>=32&&Ye<128&&++We;var nt=We>=ze*4/5;H.push(W),H.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+me),H.push("Content-Transfer-Encoding: "+(nt?"quoted-printable":"base64")),H.push("Content-Type: "+ji(Ie,me)),H.push(""),H.push(nt?pi(pe):aa(pe))}return H.push(W+`--\r
`),H.join(`\r
`)}function zn(F){var B={};return M(B,F),B}function Fa(F,B,L,W){var H=W&&W.unsafe;H||M(F);var z=!H&&gt.find(F,B);if(!z){var me=F.FullPaths[0];B.slice(0,me.length)==me?me=B:(me.slice(-1)!="/"&&(me+="/"),me=(me+B).replace("//","/")),z={name:s(B),type:2},F.FileIndex.push(z),F.FullPaths.push(me),H||gt.utils.cfb_gc(F)}return z.content=L,z.size=L?L.length:0,W&&(W.CLSID&&(z.clsid=W.CLSID),W.mt&&(z.mt=W.mt),W.ct&&(z.ct=W.ct)),z}function vn(F,B){M(F);var L=gt.find(F,B);if(L){for(var W=0;W<F.FileIndex.length;++W)if(F.FileIndex[W]==L)return F.FileIndex.splice(W,1),F.FullPaths.splice(W,1),!0}return!1}function Gr(F,B,L){M(F);var W=gt.find(F,B);if(W){for(var H=0;H<F.FileIndex.length;++H)if(F.FileIndex[H]==W)return F.FileIndex[H].name=s(L),F.FullPaths[H]=L,!0}return!1}function an(F){j(F,!0)}return r.find=he,r.read=J,r.parse=v,r.write=ot,r.writeFile=Lt,r.utils={cfb_new:zn,cfb_add:Fa,cfb_del:vn,cfb_mov:Gr,cfb_gc:an,ReadShift:y0,CheckField:uh,prep_blob:wa,bconcat:da,use_zlib:K,_deflateRaw:Ct,_inflateRaw:In,consts:Re},r}();function Fx(e){return typeof e=="string"?nc(e):Array.isArray(e)?nx(e):e}function V0(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=nc(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?Vn(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([Fx(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:e,saveAs:!0});var h=document.createElement("a");if(h.download!=null)return h.download=e,h.href=c,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(r)&&(r=Pi(r)),d.write(r),d.close(),r}catch(m){if(!m.message||!m.message.match(/onstruct/))throw m}throw new Error("cannot save file "+e)}function Ox(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Hr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function _f(e,r){for(var t=[],n=Hr(e),s=0;s!==n.length;++s)t[e[n[s]][r]]==null&&(t[e[n[s]][r]]=n[s]);return t}function sc(e){for(var r=[],t=Hr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function oc(e){for(var r=[],t=Hr(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function Rx(e){for(var r=[],t=Hr(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var zo=new Date(1899,11,30,0,0,0);function oa(e,r){var t=e.getTime(),n=zo.getTime()+(e.getTimezoneOffset()-zo.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var X1=new Date,Mx=zo.getTime()+(X1.getTimezoneOffset()-zo.getTimezoneOffset())*6e4,Af=X1.getTimezoneOffset();function cc(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Mx),r.getTimezoneOffset()!==Af&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Af)*6e4),r}function Px(e){var r=0,t=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var c=1;c!=s.length;++c)if(s[c]){switch(t=1,c>3&&(n=!0),s[c].slice(s[c].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[c].slice(s[c].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(s[c],10)}return r}var bf=new Date("2017-02-19T19:06:09.000Z"),z1=isNaN(bf.getFullYear())?new Date("2/19/17"):bf,Bx=z1.getFullYear()==2017;function Tr(e,r){var t=new Date(e);if(Bx)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(z1.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function ns(e,r){if(Ht&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Vn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Vn(O1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Vn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Vn(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(c){return t[c]||c})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Nr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Nr(e[t]));return r}function Wr(e,r){for(var t="";t.length<r;)t+=e;return t}function Nn(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,c){return t=-t,c}),!isNaN(r=Number(n)))?r/t:r}var Lx=["january","february","march","april","may","june","july","august","september","october","november","december"];function Hs(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),s=r.getMonth(),c=r.getDate();if(isNaN(c))return t;var h=e.toLowerCase();if(h.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(h=h.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),h.length>3&&Lx.indexOf(h)==-1)return t}else if(h.match(/[a-z]/))return t;return n<0||n>8099?t:(s>0||c>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var jx=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,s){if(e||typeof n=="string")return t.split(n);for(var c=t.split(n),h=[c[0]],d=1;d<c.length;++d)h.push(s),h.push(c[d]);return h}}();function Y1(e){return e?e.content&&e.type?ns(e.content,!0):e.data?p0(e.data):e.asNodeBuffer&&Ht?p0(e.asNodeBuffer().toString("binary")):e.asBinary?p0(e.asBinary()):e._data&&e._data.getContent?p0(ns(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function K1(e){if(!e)return null;if(e.data)return uf(e.data);if(e.asNodeBuffer&&Ht)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?uf(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Ux(e){return e&&e.name.slice(-4)===".bin"?K1(e):Y1(e)}function dn(e,r){for(var t=e.FullPaths||Hr(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),c=0;c<t.length;++c){var h=t[c].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==h||s==h)return e.files?e.files[t[c]]:e.FileIndex[c]}return null}function ul(e,r){var t=dn(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function ta(e,r,t){if(!t)return Ux(ul(e,r));if(!r)return null;try{return ta(e,r)}catch{return null}}function $a(e,r,t){if(!t)return Y1(ul(e,r));if(!r)return null;try{return $a(e,r)}catch{return null}}function Wx(e,r,t){return K1(ul(e,r))}function Cf(e){for(var r=e.FullPaths||Hr(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function Vt(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Ht?n=di(t):n=ix(t),gt.utils.cfb_add(e,r,n)}gt.utils.cfb_add(e,r,t)}else e.file(r,t)}function dl(){return gt.utils.cfb_new()}function q1(e,r){switch(r.type){case"base64":return gt.read(e,{type:"base64"});case"binary":return gt.read(e,{type:"binary"});case"buffer":case"array":return gt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function v0(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?t.pop():s!=="."&&t.push(s)}return t.join("/")}var Kr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Vx=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Sf=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Hx=/<[^>]*>/g,Da=Kr.match(Sf)?Sf:Hx,Gx=/<\w*:/,Xx=/<(\/?)\w+:/;function Tt(e,r,t){for(var n={},s=0,c=0;s!==e.length&&!((c=e.charCodeAt(s))===32||c===10||c===13);++s);if(r||(n[0]=e.slice(0,s)),s===e.length)return n;var h=e.match(Vx),d=0,m="",g=0,v="",_="",S=1;if(h)for(g=0;g!=h.length;++g){for(_=h[g],c=0;c!=_.length&&_.charCodeAt(c)!==61;++c);for(v=_.slice(0,c).trim();_.charCodeAt(c+1)==32;)++c;for(S=(s=_.charCodeAt(c+1))==34||s==39?1:0,m=_.slice(c+1+S,_.length-S),d=0;d!=v.length&&v.charCodeAt(d)!==58;++d);if(d===v.length)v.indexOf("_")>0&&(v=v.slice(0,v.indexOf("_"))),n[v]=m,n[v.toLowerCase()]=m;else{var T=(d===5&&v.slice(0,5)==="xmlns"?"xmlns":"")+v.slice(d+1);if(n[T]&&v.slice(d-3,d)=="ext")continue;n[T]=m,n[T.toLowerCase()]=m}}return n}function Hn(e){return e.replace(Xx,"<$1")}var Z1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},xl=sc(Z1),rr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var s=n+"",c=s.indexOf("<![CDATA[");if(c==-1)return s.replace(e,function(d,m){return Z1[d]||String.fromCharCode(parseInt(m,d.indexOf("x")>-1?16:10))||d}).replace(r,function(d,m){return String.fromCharCode(parseInt(m,16))});var h=s.indexOf("]]>");return t(s.slice(0,c))+s.slice(c+9,h)+t(s.slice(h+3))}}(),gl=/[&<>'"]/g,zx=/[\u0000-\u0008\u000b-\u001f]/g;function mr(e){var r=e+"";return r.replace(gl,function(t){return xl[t]}).replace(zx,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Tf(e){return mr(e).replace(/ /g,"_x0020_")}var J1=/[\u0000-\u001f]/g;function ml(e){var r=e+"";return r.replace(gl,function(t){return xl[t]}).replace(/\n/g,"<br/>").replace(J1,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function Yx(e){var r=e+"";return r.replace(gl,function(t){return xl[t]}).replace(J1,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Nf=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function Kx(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Sr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Oc(e){for(var r="",t=0,n=0,s=0,c=0,h=0,d=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(s=e.charCodeAt(t++),n>191&&n<224){h=(n&31)<<6,h|=s&63,r+=String.fromCharCode(h);continue}if(c=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(s&63)<<6|c&63);continue}h=e.charCodeAt(t++),d=((n&7)<<18|(s&63)<<12|(c&63)<<6|h&63)-65536,r+=String.fromCharCode(55296+(d>>>10&1023)),r+=String.fromCharCode(56320+(d&1023))}return r}function kf(e){var r=Fi(2*e.length),t,n,s=1,c=0,h=0,d;for(n=0;n<e.length;n+=s)s=1,(d=e.charCodeAt(n))<128?t=d:d<224?(t=(d&31)*64+(e.charCodeAt(n+1)&63),s=2):d<240?(t=(d&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,t=(d&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,h=55296+(t>>>10&1023),t=56320+(t&1023)),h!==0&&(r[c++]=h&255,r[c++]=h>>>8,h=0),r[c++]=t%256,r[c++]=t>>>8;return r.slice(0,c).toString("ucs2")}function If(e){return di(e,"binary").toString("utf8")}var ko="foo bar bazâð£",vr=Ht&&(If(ko)==Oc(ko)&&If||kf(ko)==Oc(ko)&&kf)||Oc,Vn=Ht?function(e){return di(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,s=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(s>>18&7))),r.push(String.fromCharCode(144+(s>>12&63))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},D0=function(){var e={};return function(t,n){var s=t+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),Q1=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),qx=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Zx=/<\/?(?:vt:)?variant>/g,Jx=/<(?:vt:)([^>]*)>([\s\S]*)</;function Df(e,r){var t=Tt(e),n=e.match(qx(t.baseType))||[],s=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return s}return n.forEach(function(c){var h=c.replace(Zx,"").match(Jx);h&&s.push({v:vr(h[2]),t:h[1]})}),s}var $1=/(^\s|\s$|\n)/;function va(e,r){return"<"+e+(r.match($1)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function F0(e){return Hr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function rt(e,r,t){return"<"+e+(t!=null?F0(t):"")+(r!=null?(r.match($1)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function zc(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function Qx(e,r){switch(typeof e){case"string":var t=rt("vt:lpwstr",mr(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return rt((e|0)==e?"vt:i4":"vt:r8",mr(String(e)));case"boolean":return rt("vt:bool",e?"true":"false")}if(e instanceof Date)return rt("vt:filetime",zc(e));throw new Error("Unable to serialize "+e)}function pl(e){if(Ht&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return vr(Pi(ll(e)));throw new Error("Bad input format: expected Buffer or string")}var O0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,sa={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},fs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Za={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function $x(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),s=e[r+6]&15,c=5;c>=0;--c)s=s*256+e[r+c];return n==2047?s==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),t*Math.pow(2,n-52)*s)}function eg(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,s=0,c=0,h=n?-r:r;isFinite(h)?h==0?s=c=0:(s=Math.floor(Math.log(h)/Math.LN2),c=h*Math.pow(2,52-s),s<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?s=-1022:(c-=Math.pow(2,52),s+=1023)):(s=2047,c=isNaN(r)?26985:0);for(var d=0;d<=5;++d,c/=256)e[t+d]=c&255;e[t+6]=(s&15)<<4|c&15,e[t+7]=s>>4|n}var Ff=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,c=e[0][n].length;s<c;s+=t)r.push.apply(r,e[0][n].slice(s,s+t));return r},Of=Ht?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:di(r)})):Ff(e)}:Ff,Rf=function(e,r,t){for(var n=[],s=r;s<t;s+=2)n.push(String.fromCharCode(ci(e,s)));return n.join("").replace(La,"")},wl=Ht?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(La,""):Rf(e,r,t)}:Rf,Mf=function(e,r,t){for(var n=[],s=r;s<r+t;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},eh=Ht?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Mf(e,r,t)}:Mf,Pf=function(e,r,t){for(var n=[],s=r;s<t;s++)n.push(String.fromCharCode(Ps(e,s)));return n.join("")},H0=Ht?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):Pf(r,t,n)}:Pf,th=function(e,r){var t=Ja(e,r);return t>0?H0(e,r+4,r+4+t-1):""},rh=th,ah=function(e,r){var t=Ja(e,r);return t>0?H0(e,r+4,r+4+t-1):""},nh=ah,ih=function(e,r){var t=2*Ja(e,r);return t>0?H0(e,r+4,r+4+t-1):""},sh=ih,oh=function(r,t){var n=Ja(r,t);return n>0?wl(r,t+4,t+4+n):""},ch=oh,lh=function(e,r){var t=Ja(e,r);return t>0?H0(e,r+4,r+4+t):""},fh=lh,hh=function(e,r){return $x(e,r)},Yo=hh,vl=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Ht&&(rh=function(r,t){if(!Buffer.isBuffer(r))return th(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},nh=function(r,t){if(!Buffer.isBuffer(r))return ah(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},sh=function(r,t){if(!Buffer.isBuffer(r))return ih(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},ch=function(r,t){if(!Buffer.isBuffer(r))return oh(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},fh=function(r,t){if(!Buffer.isBuffer(r))return lh(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},Yo=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):hh(r,t)},vl=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Ps=function(e,r){return e[r]},ci=function(e,r){return e[r+1]*256+e[r]},tg=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Ja=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Ji=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},rg=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function y0(e,r){var t="",n,s,c=[],h,d,m,g;switch(r){case"dbcs":if(g=this.l,Ht&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)t+=String.fromCharCode(ci(this,g)),g+=2;e*=2;break;case"utf8":t=H0(this,this.l,this.l+e);break;case"utf16le":e*=2,t=wl(this,this.l,this.l+e);break;case"wstr":return y0.call(this,e,"dbcs");case"lpstr-ansi":t=rh(this,this.l),e=4+Ja(this,this.l);break;case"lpstr-cp":t=nh(this,this.l),e=4+Ja(this,this.l);break;case"lpwstr":t=sh(this,this.l),e=4+2*Ja(this,this.l);break;case"lpp4":e=4+Ja(this,this.l),t=ch(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ja(this,this.l),t=fh(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(h=Ps(this,this.l+e++))!==0;)c.push(No(h));t=c.join("");break;case"_wstr":for(e=0,t="";(h=ci(this,this.l+e))!==0;)c.push(No(h)),e+=2;e+=2,t=c.join("");break;case"dbcs-cont":for(t="",g=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(g)!==-1)return h=Ps(this,g),this.l=g+1,d=y0.call(this,e-m,h?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(No(ci(this,g))),g+=2}t=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",g=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(g)!==-1)return h=Ps(this,g),this.l=g+1,d=y0.call(this,e-m,h?"dbcs-cont":"sbcs-cont"),c.join("")+d;c.push(No(Ps(this,g))),g+=1}t=c.join("");break;default:switch(e){case 1:return n=Ps(this,this.l),this.l++,n;case 2:return n=(r==="i"?tg:ci)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?Ji:rg)(this,this.l),this.l+=4,n):(s=Ja(this,this.l),this.l+=4,s);case 8:case-8:if(r==="f")return e==8?s=Yo(this,this.l):s=Yo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=eh(this,this.l,e);break}}return this.l+=e,t}var ag=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},ng=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},ig=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function sg(e,r,t){var n=0,s=0;if(t==="dbcs"){for(s=0;s!=r.length;++s)ig(this,r.charCodeAt(s),this.l+2*s);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255;n=r.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var c=Math.min(this.l+e,this.length);for(s=0;s<Math.min(r.length,e);++s){var h=r.charCodeAt(s);this[this.l++]=h&255,this[this.l++]=h>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,ag(this,r,this.l);break;case 8:if(n=8,t==="f"){eg(this,r,this.l);break}case 16:break;case-4:n=4,ng(this,r,this.l);break}return this.l+=n,this}function uh(e,r){var t=eh(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function wa(e,r){e.l=r,e.read_shift=y0,e.chk=uh,e.write_shift=sg}function Ia(e,r){e.l+=r}function Oe(e){var r=Fi(e);return wa(r,0),r}function xi(e,r,t){if(e){var n,s,c;wa(e,e.l||0);for(var h=e.length,d=0,m=0;e.l<h;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var g=j0[d]||j0[65535];for(n=e.read_shift(1),c=n&127,s=1;s<4&&n&128;++s)c+=((n=e.read_shift(1))&127)<<7*s;m=e.l+c;var v=g.f&&g.f(e,c,t);if(e.l=m,r(v,g,d))return}}}function Va(){var e=[],r=Ht?256:2048,t=function(g){var v=Oe(g);return wa(v,0),v},n=t(r),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},c=function(g){return n&&g<n.length-n.l?n:(s(),n=t(Math.max(g+1,r)))},h=function(){return s(),da(e)},d=function(g){s(),n=g,n.l==null&&(n.l=n.length),c(r)};return{next:c,push:d,end:h,_bufs:e}}function Ve(e,r,t,n){var s=+r,c;if(!isNaN(s)){n||(n=j0[s].p||(t||[]).length||0),c=1+(s>=128?1:0)+1,n>=128&&++c,n>=16384&&++c,n>=2097152&&++c;var h=e.next(c);s<=127?h.write_shift(1,s):(h.write_shift(1,(s&127)+128),h.write_shift(1,s>>7));for(var d=0;d!=4;++d)if(n>=128)h.write_shift(1,(n&127)+128),n>>=7;else{h.write_shift(1,n);break}n>0&&vl(t)&&e.push(t)}}function E0(e,r,t){var n=Nr(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Bf(e,r,t){var n=Nr(e);return n.s=E0(n.s,r.s,t),n.e=E0(n.e,r.s,t),n}function _0(e,r){if(e.cRel&&e.c<0)for(e=Nr(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Nr(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=St(e);return!e.cRel&&e.cRel!=null&&(t=lg(t)),!e.rRel&&e.rRel!=null&&(t=og(t)),t}function Rc(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Br(e.s.c)+":"+(e.e.cRel?"":"$")+Br(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Yr(e.s.r)+":"+(e.e.rRel?"":"$")+Yr(e.e.r):_0(e.s,r.biff)+":"+_0(e.e,r.biff)}function yl(e){return parseInt(cg(e),10)-1}function Yr(e){return""+(e+1)}function og(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function cg(e){return e.replace(/\$(\d+)$/,"$1")}function El(e){for(var r=fg(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function Br(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function lg(e){return e.replace(/^([A-Z])/,"$$$1")}function fg(e){return e.replace(/^\$([A-Z])/,"$1")}function hg(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Lr(e){for(var r=0,t=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?r=10*r+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:r-1}}function St(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Ha(e){var r=e.indexOf(":");return r==-1?{s:Lr(e),e:Lr(e)}:{s:Lr(e.slice(0,r)),e:Lr(e.slice(r+1))}}function Bt(e,r){return typeof r>"u"||typeof r=="number"?Bt(e.s,e.e):(typeof e!="string"&&(e=St(e)),typeof r!="string"&&(r=St(r)),e==r?e:e+":"+r)}function ar(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,s=0,c=e.length;for(t=0;n<c&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.s.c=--t,t=0;n<c&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;if(r.s.r=--t,n===c||s!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=c&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.e.c=--t,t=0;n!=c&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;return r.e.r=--t,r}function Lf(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=mn(e.z,t?oa(r):r)}catch{}try{return e.w=mn((e.XF||{}).numFmtId||(t?14:0),t?oa(r):r)}catch{return""+r}}function ui(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?gi[e.v]||e.v:r==null?Lf(e,e.v):Lf(e,r))}function Bi(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function dh(e,r,t){var n=t||{},s=e?Array.isArray(e):n.dense,c=e||(s?[]:{}),h=0,d=0;if(c&&n.origin!=null){if(typeof n.origin=="number")h=n.origin;else{var m=typeof n.origin=="string"?Lr(n.origin):n.origin;h=m.r,d=m.c}c["!ref"]||(c["!ref"]="A1:A1")}var g={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var v=ar(c["!ref"]);g.s.c=v.s.c,g.s.r=v.s.r,g.e.c=Math.max(g.e.c,v.e.c),g.e.r=Math.max(g.e.r,v.e.r),h==-1&&(g.e.r=h=v.e.r+1)}for(var _=0;_!=r.length;++_)if(r[_]){if(!Array.isArray(r[_]))throw new Error("aoa_to_sheet expects an array of arrays");for(var S=0;S!=r[_].length;++S)if(!(typeof r[_][S]>"u")){var T={v:r[_][S]},N=h+_,C=d+S;if(g.s.r>N&&(g.s.r=N),g.s.c>C&&(g.s.c=C),g.e.r<N&&(g.e.r=N),g.e.c<C&&(g.e.c=C),r[_][S]&&typeof r[_][S]=="object"&&!Array.isArray(r[_][S])&&!(r[_][S]instanceof Date))T=r[_][S];else if(Array.isArray(T.v)&&(T.f=r[_][S][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(n.nullError)T.t="e",T.v=0;else if(n.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=n.dateNF||bt[14],n.cellDates?(T.t="d",T.w=mn(T.z,oa(T.v))):(T.t="n",T.v=oa(T.v),T.w=mn(T.z,T.v))):T.t="s";if(s)c[N]||(c[N]=[]),c[N][C]&&c[N][C].z&&(T.z=c[N][C].z),c[N][C]=T;else{var D=St({c:C,r:N});c[D]&&c[D].z&&(T.z=c[D].z),c[D]=T}}}return g.s.c<1e7&&(c["!ref"]=Bt(g)),c}function Ks(e,r){return dh(null,e,r)}function ug(e){return e.read_shift(4,"i")}function kn(e,r){return r||(r=Oe(4)),r.write_shift(4,e),r}function ka(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function xa(e,r){var t=!1;return r==null&&(t=!0,r=Oe(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function dg(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function xg(e,r){return r||(r=Oe(4)),r.write_shift(2,0),r.write_shift(2,0),r}function _l(e,r){var t=e.l,n=e.read_shift(1),s=ka(e),c=[],h={t:s,h:s};if(n&1){for(var d=e.read_shift(4),m=0;m!=d;++m)c.push(dg(e));h.r=c}else h.r=[{ich:0,ifnt:0}];return e.l=t+r,h}function gg(e,r){var t=!1;return r==null&&(t=!0,r=Oe(15+4*e.t.length)),r.write_shift(1,0),xa(e.t,r),t?r.slice(0,r.l):r}var mg=_l;function pg(e,r){var t=!1;return r==null&&(t=!0,r=Oe(23+4*e.t.length)),r.write_shift(1,1),xa(e.t,r),r.write_shift(4,1),xg({},r),t?r.slice(0,r.l):r}function pn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function hs(e,r){return r==null&&(r=Oe(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function us(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function ds(e,r){return r==null&&(r=Oe(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var wg=ka,xh=xa;function Al(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function Ko(e,r){var t=!1;return r==null&&(t=!0,r=Oe(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var vg=ka,Yc=Al,bl=Ko;function Cl(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var s=n===0?Yo([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Ji(r,0)>>2;return t?s/100:s}function gh(e,r){r==null&&(r=Oe(4));var t=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?s:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function mh(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function yg(e,r){return r||(r=Oe(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var xs=mh,qs=yg;function Na(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function is(e,r){return(r||Oe(8)).write_shift(8,e,"f")}function Eg(e){var r={},t=e.read_shift(1),n=t>>>1,s=e.read_shift(1),c=e.read_shift(2,"i"),h=e.read_shift(1),d=e.read_shift(1),m=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=s;var g=$i[s];g&&(r.rgb=M0(g));break;case 2:r.rgb=M0([h,d,m]);break;case 3:r.theme=s;break}return c!=0&&(r.tint=c>0?c/32767:c/32768),r}function qo(e,r){if(r||(r=Oe(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function _g(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Ag(e,r){r||(r=Oe(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}function ph(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function bg(e){return ph(e,1)}function Cg(e){return ph(e,2)}var Sl=2,Wa=3,Io=11,jf=12,Zo=19,Do=64,Sg=65,Tg=71,Ng=4108,kg=4126,ua=80,wh=81,Ig=[ua,wh],Kc={1:{n:"CodePage",t:Sl},2:{n:"Category",t:ua},3:{n:"PresentationFormat",t:ua},4:{n:"ByteCount",t:Wa},5:{n:"LineCount",t:Wa},6:{n:"ParagraphCount",t:Wa},7:{n:"SlideCount",t:Wa},8:{n:"NoteCount",t:Wa},9:{n:"HiddenCount",t:Wa},10:{n:"MultimediaClipCount",t:Wa},11:{n:"ScaleCrop",t:Io},12:{n:"HeadingPairs",t:Ng},13:{n:"TitlesOfParts",t:kg},14:{n:"Manager",t:ua},15:{n:"Company",t:ua},16:{n:"LinksUpToDate",t:Io},17:{n:"CharacterCount",t:Wa},19:{n:"SharedDoc",t:Io},22:{n:"HyperlinksChanged",t:Io},23:{n:"AppVersion",t:Wa,p:"version"},24:{n:"DigSig",t:Sg},26:{n:"ContentType",t:ua},27:{n:"ContentStatus",t:ua},28:{n:"Language",t:ua},29:{n:"Version",t:ua},255:{},2147483648:{n:"Locale",t:Zo},2147483651:{n:"Behavior",t:Zo},1919054434:{}},qc={1:{n:"CodePage",t:Sl},2:{n:"Title",t:ua},3:{n:"Subject",t:ua},4:{n:"Author",t:ua},5:{n:"Keywords",t:ua},6:{n:"Comments",t:ua},7:{n:"Template",t:ua},8:{n:"LastAuthor",t:ua},9:{n:"RevNumber",t:ua},10:{n:"EditTime",t:Do},11:{n:"LastPrinted",t:Do},12:{n:"CreatedDate",t:Do},13:{n:"ModifiedDate",t:Do},14:{n:"PageCount",t:Wa},15:{n:"WordCount",t:Wa},16:{n:"CharCount",t:Wa},17:{n:"Thumbnail",t:Tg},18:{n:"Application",t:ua},19:{n:"DocSecurity",t:Wa},255:{},2147483648:{n:"Locale",t:Zo},2147483651:{n:"Behavior",t:Zo},1919054434:{}},Uf={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Dg=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Fg(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Og=Fg([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),$i=Nr(Og),gi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},vh={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Zc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Fo={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Tl(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Rg(e){var r=Tl();if(!e||!e.match)return r;var t={};if((e.match(Da)||[]).forEach(function(n){var s=Tt(n);switch(s[0].replace(Gx,"<")){case"<?xml":break;case"<Types":r.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":r[Zc[s.ContentType]]!==void 0&&r[Zc[s.ContentType]].push(s.PartName);break}}),r.xmlns!==sa.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}function yh(e,r){var t=Rx(Zc),n=[],s;n[n.length]=Kr,n[n.length]=rt("Types",null,{xmlns:sa.CT,"xmlns:xsd":sa.xsd,"xmlns:xsi":sa.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(m){return rt("Default",null,{Extension:m[0],ContentType:m[1]})}));var c=function(m){e[m]&&e[m].length>0&&(s=e[m][0],n[n.length]=rt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Fo[m][r.bookType]||Fo[m].xlsx}))},h=function(m){(e[m]||[]).forEach(function(g){n[n.length]=rt("Override",null,{PartName:(g[0]=="/"?"":"/")+g,ContentType:Fo[m][r.bookType]||Fo[m].xlsx})})},d=function(m){(e[m]||[]).forEach(function(g){n[n.length]=rt("Override",null,{PartName:(g[0]=="/"?"":"/")+g,ContentType:t[m][0]})})};return c("workbooks"),h("sheets"),h("charts"),d("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),h("metadata"),d("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var zt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function R0(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function A0(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(Da)||[]).forEach(function(s){var c=Tt(s);if(c[0]==="<Relationship"){var h={};h.Type=c.Type,h.Target=c.Target,h.Id=c.Id,c.TargetMode&&(h.TargetMode=c.TargetMode);var d=c.TargetMode==="External"?c.Target:v0(c.Target,r);t[d]=h,n[c.Id]=h}}),t["!id"]=n,t}function Us(e){var r=[Kr,rt("Relationships",null,{xmlns:sa.RELS})];return Hr(e["!id"]).forEach(function(t){r[r.length]=rt("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function gr(e,r,t,n,s,c){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,s.Id="rId"+r,s.Type=n,s.Target=t,[zt.HLINK,zt.XPATH,zt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,r}var Mg="application/vnd.oasis.opendocument.spreadsheet";function Pg(e,r){for(var t=pl(e),n,s;n=O0.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Tt(n[0],!1),s.path=="/"&&s.type!==Mg)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}function Bg(e){var r=[Kr];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Wf(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function Lg(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function jg(e){var r=[Kr];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(Wf(e[t][0],e[t][1])),r.push(Lg("",e[t][0]));return r.push(Wf("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function Eh(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Vo.version+"</meta:generator></office:meta></office:document-meta>"}var gn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Ug=function(){for(var e=new Array(gn.length),r=0;r<gn.length;++r){var t=gn[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function _h(e){var r={};e=vr(e);for(var t=0;t<gn.length;++t){var n=gn[t],s=e.match(Ug[t]);s!=null&&s.length>0&&(r[n[1]]=rr(s[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=Tr(r[n[1]]))}return r}function Mc(e,r,t,n,s){s[e]!=null||r==null||r===""||(s[e]=r,r=mr(r),n[n.length]=t?rt(e,r,t):va(e,r))}function Ah(e,r){var t=r||{},n=[Kr,rt("cp:coreProperties",null,{"xmlns:cp":sa.CORE_PROPS,"xmlns:dc":sa.dc,"xmlns:dcterms":sa.dcterms,"xmlns:dcmitype":sa.dcmitype,"xmlns:xsi":sa.xsi})],s={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&Mc("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:zc(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Mc("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:zc(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var c=0;c!=gn.length;++c){var h=gn[c],d=t.Props&&t.Props[h[1]]!=null?t.Props[h[1]]:e?e[h[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&Mc(h[0],d,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var es=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],bh=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ch(e,r,t,n){var s=[];if(typeof e=="string")s=Df(e,n);else for(var c=0;c<e.length;++c)s=s.concat(e[c].map(function(v){return{v}}));var h=typeof r=="string"?Df(r,n).map(function(v){return v.v}):r,d=0,m=0;if(h.length>0)for(var g=0;g!==s.length;g+=2){switch(m=+s[g+1].v,s[g].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=m,t.SheetNames=h.slice(d,d+m);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=m,t.DefinedNames=h.slice(d,d+m);break;case"Charts":case"Diagramme":t.Chartsheets=m,t.ChartNames=h.slice(d,d+m);break}d+=m}}function Wg(e,r,t){var n={};return r||(r={}),e=vr(e),es.forEach(function(s){var c=(e.match(D0(s[0]))||[])[1];switch(s[2]){case"string":c&&(r[s[1]]=rr(c));break;case"bool":r[s[1]]=c==="true";break;case"raw":var h=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));h&&h.length>0&&(n[s[1]]=h[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Ch(n.HeadingPairs,n.TitlesOfParts,r,t),r}function Sh(e){var r=[],t=rt;return e||(e={}),e.Application="SheetJS",r[r.length]=Kr,r[r.length]=rt("Properties",null,{xmlns:sa.EXT_PROPS,"xmlns:vt":sa.vt}),es.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=mr(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(r[r.length]=t(n[0],s))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+mr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Vg=/<[^>]+>[^<]*/g;function Hg(e,r){var t={},n="",s=e.match(Vg);if(s)for(var c=0;c!=s.length;++c){var h=s[c],d=Tt(h);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":n=rr(d.name);break;case"</property>":n=null;break;default:if(h.indexOf("<vt:")===0){var m=h.split(">"),g=m[0].slice(4),v=m[1];switch(g){case"lpstr":case"bstr":case"lpwstr":t[n]=rr(v);break;case"bool":t[n]=Sr(v);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(v,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(v);break;case"filetime":case"date":t[n]=Tr(v);break;case"cy":case"error":t[n]=rr(v);break;default:if(g.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",h,g,m)}}else if(h.slice(0,2)!=="</"){if(r.WTF)throw new Error(h)}}}return t}function Th(e){var r=[Kr,rt("Properties",null,{xmlns:sa.CUST_PROPS,"xmlns:vt":sa.vt})];if(!e)return r.join("");var t=1;return Hr(e).forEach(function(s){++t,r[r.length]=rt("property",Qx(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:mr(s)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Jc={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Pc;function Gg(e,r,t){Pc||(Pc=sc(Jc)),r=Pc[r]||r,e[r]=t}function Xg(e,r){var t=[];return Hr(Jc).map(function(n){for(var s=0;s<gn.length;++s)if(gn[s][1]==n)return gn[s];for(s=0;s<es.length;++s)if(es[s][1]==n)return es[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(va(Jc[n[1]]||n[1],s))}}),rt("DocumentProperties",t.join(""),{xmlns:Za.o})}function zg(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Hr(e).forEach(function(c){if(Object.prototype.hasOwnProperty.call(e,c)){for(var h=0;h<gn.length;++h)if(c==gn[h][1])return;for(h=0;h<es.length;++h)if(c==es[h][1])return;for(h=0;h<t.length;++h)if(c==t[h])return;var d=e[c],m="string";typeof d=="number"?(m="float",d=String(d)):d===!0||d===!1?(m="boolean",d=d?"1":"0"):d=String(d),s.push(rt(Tf(c),d,{"dt:dt":m}))}}),r&&Hr(r).forEach(function(c){if(Object.prototype.hasOwnProperty.call(r,c)&&!(e&&Object.prototype.hasOwnProperty.call(e,c))){var h=r[c],d="string";typeof h=="number"?(d="float",h=String(h)):h===!0||h===!1?(d="boolean",h=h?"1":"0"):h instanceof Date?(d="dateTime.tz",h=h.toISOString()):h=String(h),s.push(rt(Tf(c),h,{"dt:dt":d}))}}),"<"+n+' xmlns="'+Za.o+'">'+s.join("")+"</"+n+">"}function Nl(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Yg(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),s=(t-n)/Math.pow(2,32);n*=1e7,s*=1e7;var c=n/Math.pow(2,32)|0;c>0&&(n=n%Math.pow(2,32),s+=c);var h=Oe(8);return h.write_shift(4,n),h.write_shift(4,s),h}function Nh(e,r,t){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return s}function kh(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function Ih(e,r,t){return r===31?kh(e):Nh(e,r,t)}function Qc(e,r,t){return Ih(e,r,t===!1?0:4)}function Kg(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Ih(e,r,0)}function qg(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var s=e.l;t[n]=e.read_shift(0,"lpwstr").replace(La,""),e.l-s&2&&(e.l+=2)}return t}function Zg(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(La,"");return t}function Jg(e){var r=e.l,t=Jo(e,wh);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Jo(e,Wa);return[t,n]}function Qg(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(Jg(e));return t}function Vf(e,r){for(var t=e.read_shift(4),n={},s=0;s!=t;++s){var c=e.read_shift(4),h=e.read_shift(4);n[c]=e.read_shift(h,r===1200?"utf16le":"utf8").replace(La,"").replace(w0,"!"),r===1200&&h%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Dh(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function $g(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Jo(e,r,t){var n=e.read_shift(2),s,c=t||{};if(e.l+=2,r!==jf&&n!==r&&Ig.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===jf?n:r){case 2:return s=e.read_shift(2,"i"),c.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Nh(e,n,4).replace(La,"");case 31:return kh(e);case 64:return Nl(e);case 65:return Dh(e);case 71:return $g(e);case 80:return Qc(e,n,!c.raw).replace(La,"");case 81:return Kg(e,n).replace(La,"");case 4108:return Qg(e);case 4126:case 4127:return n==4127?qg(e):Zg(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function Hf(e,r){var t=Oe(4),n=Oe(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=Oe(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=Yg(r);break;case 31:case 80:for(n=Oe(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return da([t,n])}function Gf(e,r){var t=e.l,n=e.read_shift(4),s=e.read_shift(4),c=[],h=0,d=0,m=-1,g={};for(h=0;h!=s;++h){var v=e.read_shift(4),_=e.read_shift(4);c[h]=[v,_+t]}c.sort(function(X,O){return X[1]-O[1]});var S={};for(h=0;h!=s;++h){if(e.l!==c[h][1]){var T=!0;if(h>0&&r)switch(r[c[h-1][0]].t){case 2:e.l+2===c[h][1]&&(e.l+=2,T=!1);break;case 80:e.l<=c[h][1]&&(e.l=c[h][1],T=!1);break;case 4108:e.l<=c[h][1]&&(e.l=c[h][1],T=!1);break}if((!r||h==0)&&e.l<=c[h][1]&&(T=!1,e.l=c[h][1]),T)throw new Error("Read Error: Expected address "+c[h][1]+" at "+e.l+" :"+h)}if(r){var N=r[c[h][0]];if(S[N.n]=Jo(e,N.t,{raw:!0}),N.p==="version"&&(S[N.n]=String(S[N.n]>>16)+"."+("0000"+String(S[N.n]&65535)).slice(-4)),N.n=="CodePage")switch(S[N.n]){case 0:S[N.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Sn(d=S[N.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+S[N.n])}}else if(c[h][0]===1){if(d=S.CodePage=Jo(e,Sl),Sn(d),m!==-1){var C=e.l;e.l=c[m][1],g=Vf(e,d),e.l=C}}else if(c[h][0]===0){if(d===0){m=h,e.l=c[h+1][1];continue}g=Vf(e,d)}else{var D=g[c[h][0]],U;switch(e[e.l]){case 65:e.l+=4,U=Dh(e);break;case 30:e.l+=4,U=Qc(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,U=Qc(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,U=e.read_shift(4,"i");break;case 19:e.l+=4,U=e.read_shift(4);break;case 5:e.l+=4,U=e.read_shift(8,"f");break;case 11:e.l+=4,U=zr(e,4);break;case 64:e.l+=4,U=Tr(Nl(e));break;default:throw new Error("unparsed value: "+e[e.l])}S[D]=U}}return e.l=t+n,S}var Fh=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function e2(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Xf(e,r,t){var n=Oe(8),s=[],c=[],h=8,d=0,m=Oe(8),g=Oe(8);if(m.write_shift(4,2),m.write_shift(4,1200),g.write_shift(4,1),c.push(m),s.push(g),h+=8+m.length,!r){g=Oe(8),g.write_shift(4,0),s.unshift(g);var v=[Oe(4)];for(v[0].write_shift(4,e.length),d=0;d<e.length;++d){var _=e[d][0];for(m=Oe(8+2*(_.length+1)+(_.length%2?0:2)),m.write_shift(4,d+2),m.write_shift(4,_.length+1),m.write_shift(0,_,"dbcs");m.l!=m.length;)m.write_shift(1,0);v.push(m)}m=da(v),c.unshift(m),h+=8+m.length}for(d=0;d<e.length;++d)if(!(r&&!r[e[d][0]])&&!(Fh.indexOf(e[d][0])>-1||bh.indexOf(e[d][0])>-1)&&e[d][1]!=null){var S=e[d][1],T=0;if(r){T=+r[e[d][0]];var N=t[T];if(N.p=="version"&&typeof S=="string"){var C=S.split(".");S=(+C[0]<<16)+(+C[1]||0)}m=Hf(N.t,S)}else{var D=e2(S);D==-1&&(D=31,S=String(S)),m=Hf(D,S)}c.push(m),g=Oe(8),g.write_shift(4,r?T:2+d),s.push(g),h+=8+m.length}var U=8*(c.length+1);for(d=0;d<c.length;++d)s[d].write_shift(4,U),U+=c[d].length;return n.write_shift(4,h),n.write_shift(4,c.length),da([n].concat(s).concat(c))}function zf(e,r,t){var n=e.content;if(!n)return{};wa(n,0);var s,c,h,d,m=0;n.chk("feff","Byte Order: "),n.read_shift(2);var g=n.read_shift(4),v=n.read_shift(16);if(v!==gt.utils.consts.HEADER_CLSID&&v!==t)throw new Error("Bad PropertySet CLSID "+v);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(c=n.read_shift(16),d=n.read_shift(4),s===1&&d!==n.l)throw new Error("Length mismatch: "+d+" !== "+n.l);s===2&&(h=n.read_shift(16),m=n.read_shift(4));var _=Gf(n,r),S={SystemIdentifier:g};for(var T in _)S[T]=_[T];if(S.FMTID=c,s===1)return S;if(m-n.l==2&&(n.l+=2),n.l!==m)throw new Error("Length mismatch 2: "+n.l+" !== "+m);var N;try{N=Gf(n,null)}catch{}for(T in N)S[T]=N[T];return S.FMTID=[c,h],S}function Yf(e,r,t,n,s,c){var h=Oe(s?68:48),d=[h];h.write_shift(2,65534),h.write_shift(2,0),h.write_shift(4,842412599),h.write_shift(16,gt.utils.consts.HEADER_CLSID,"hex"),h.write_shift(4,s?2:1),h.write_shift(16,r,"hex"),h.write_shift(4,s?68:48);var m=Xf(e,t,n);if(d.push(m),s){var g=Xf(s,null,null);h.write_shift(16,c,"hex"),h.write_shift(4,68+m.length),d.push(g)}return da(d)}function ki(e,r){return e.read_shift(r),null}function t2(e,r){r||(r=Oe(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function r2(e,r,t){for(var n=[],s=e.l+r;e.l<s;)n.push(t(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function zr(e,r){return e.read_shift(r)===1}function Ba(e,r){return r||(r=Oe(2)),r.write_shift(2,+!!e),r}function ra(e){return e.read_shift(2,"u")}function xn(e,r){return r||(r=Oe(2)),r.write_shift(2,e),r}function Oh(e,r){return r2(e,r,ra)}function a2(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Rh(e,r,t){return t||(t=Oe(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function G0(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var c=e.read_shift(1);c&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var h=n?e.read_shift(n,s):"";return h}function n2(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,s=t&8,c=1+(t&1),h=0,d,m={};s&&(h=e.read_shift(2)),n&&(d=e.read_shift(4));var g=c==2?"dbcs-cont":"sbcs-cont",v=r===0?"":e.read_shift(r,g);return s&&(e.l+=4*h),n&&(e.l+=d),m.t=v,s||(m.raw="<t>"+m.t+"</t>",m.r=m.t),m}function i2(e){var r=e.t||"",t=Oe(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=Oe(2*r.length);n.write_shift(2*r.length,r,"utf16le");var s=[t,n];return da(s)}function ss(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function X0(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):ss(e,n,t)}function gs(e,r,t){if(t.biff>5)return X0(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Mh(e,r,t){return t||(t=Oe(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function s2(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function o2(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var s=e.read_shift((n?r-24:r)>>1,"utf16le").replace(La,"");return n&&(e.l+=24),s}function c2(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return t+n.replace(/\\/g,"/");var c=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var h=e.read_shift(c>>1,"utf16le").replace(La,"");return t+h}function l2(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return o2(e);case"0303000000000000c000000000000046":return c2(e);default:throw new Error("Unsupported Moniker "+t)}}function Oo(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(La,""):"";return t}function Kf(e,r){r||(r=Oe(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function f2(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var c,h,d,m,g="",v,_;s&16&&(c=Oo(e,t-e.l)),s&128&&(h=Oo(e,t-e.l)),(s&257)===257&&(d=Oo(e,t-e.l)),(s&257)===1&&(m=l2(e,t-e.l)),s&8&&(g=Oo(e,t-e.l)),s&32&&(v=e.read_shift(16)),s&64&&(_=Nl(e)),e.l=t;var S=h||d||m||"";S&&g&&(S+="#"+g),S||(S="#"+g),s&2&&S.charAt(0)=="/"&&S.charAt(1)!="/"&&(S="file://"+S);var T={Target:S};return v&&(T.guid=v),_&&(T.time=_),c&&(T.Tooltip=c),T}function h2(e){var r=Oe(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),c=s>-1?31:23;switch(n.charAt(0)){case"#":c=28;break;case".":c&=-3;break}r.write_shift(4,2),r.write_shift(4,c);var h=[8,6815827,6619237,4849780,83];for(t=0;t<h.length;++t)r.write_shift(4,h[t]);if(c==28)n=n.slice(1),Kf(n,r);else if(c&2){for(h="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<h.length;++t)r.write_shift(1,parseInt(h[t],16));var d=s>-1?n.slice(0,s):n;for(r.write_shift(4,2*(d.length+1)),t=0;t<d.length;++t)r.write_shift(2,d.charCodeAt(t));r.write_shift(2,0),c&8&&Kf(s>-1?n.slice(s+1):"",r)}else{for(h="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<h.length;++t)r.write_shift(1,parseInt(h[t],16));for(var m=0;n.slice(m*3,m*3+3)=="../"||n.slice(m*3,m*3+3)=="..\\";)++m;for(r.write_shift(2,m),r.write_shift(4,n.length-3*m+1),t=0;t<n.length-3*m;++t)r.write_shift(1,n.charCodeAt(t+3*m)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function Ph(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[r,t,n,s]}function Bh(e,r){var t=Ph(e);return t[3]=0,t}function Gn(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function os(e,r,t,n){return n||(n=Oe(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function u2(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function d2(e,r,t){return r===0?"":gs(e,r,t)}function x2(e,r,t){var n=t.biff>8?4:2,s=e.read_shift(n),c=e.read_shift(n,"i"),h=e.read_shift(n,"i");return[s,c,h]}function Lh(e){var r=e.read_shift(2),t=Cl(e);return[r,t]}function g2(e,r,t){e.l+=4,r-=4;var n=e.l+r,s=G0(e,r,t),c=e.read_shift(2);if(n-=e.l,c!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+c);return e.l+=c,s}function lc(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r},e:{c:s,r:t}}}function jh(e,r){return r||(r=Oe(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function Uh(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r},e:{c:s,r:t}}}var m2=Uh;function Wh(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function p2(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function w2(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function ba(e){e.l+=2,e.l+=e.read_shift(2)}var v2={0:ba,4:ba,5:ba,6:ba,7:w2,8:ba,9:ba,10:ba,11:ba,12:ba,13:p2,14:ba,15:ba,16:ba,17:ba,18:ba,19:ba,20:ba,21:Wh};function y2(e,r){for(var t=e.l+r,n=[];e.l<t;){var s=e.read_shift(2);e.l-=2;try{n.push(v2[s](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function Ro(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function kl(e,r,t){var n=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=Oe(s);return c.write_shift(2,n),c.write_shift(2,r),s>4&&c.write_shift(2,29282),s>6&&c.write_shift(2,1997),s>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function E2(e,r){return r===0||e.read_shift(2),1200}function _2(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,s=gs(e,0,t);return e.read_shift(r+n-e.l),s}function A2(e,r){var t=!r||r.biff==8,n=Oe(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function b2(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function C2(e,r,t){var n=e.read_shift(4),s=e.read_shift(1)&3,c=e.read_shift(1);switch(c){case 0:c="Worksheet";break;case 1:c="Macrosheet";break;case 2:c="Chartsheet";break;case 6:c="VBAModule";break}var h=G0(e,0,t);return h.length===0&&(h="Sheet1"),{pos:n,hs:s,dt:c,name:h}}function S2(e,r){var t=!r||r.biff>=8?2:1,n=Oe(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function T2(e,r){for(var t=e.l+r,n=e.read_shift(4),s=e.read_shift(4),c=[],h=0;h!=s&&e.l<t;++h)c.push(n2(e));return c.Count=n,c.Unique=s,c}function N2(e,r){var t=Oe(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=i2(e[s]);var c=da([t].concat(n));return c.parts=[t.length].concat(n.map(function(h){return h.length})),c}function k2(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function I2(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function D2(e){var r=u2(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function F2(e){return e.read_shift(2),e.read_shift(4)}function qf(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);t&&t.biff==2&&(n=1-(s>>15),s&=32767);var c={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[c,s]}function O2(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),h=e.read_shift(2),d=e.read_shift(2),m=e.read_shift(2),g=e.read_shift(2);return{Pos:[r,t],Dim:[n,s],Flags:c,CurTab:h,FirstTab:d,Selected:m,TabRatio:g}}function R2(){var e=Oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function M2(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function P2(e){var r=Oe(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function B2(){}function L2(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=G0(e,0,t),n}function j2(e,r){var t=e.name||"Arial",n=r&&r.biff==5,s=n?15+t.length:16+2*t.length,c=Oe(s);return c.write_shift(2,e.sz*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,t.length),n||c.write_shift(1,1),c.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),c}function U2(e){var r=Gn(e);return r.isst=e.read_shift(4),r}function W2(e,r,t,n){var s=Oe(10);return os(e,r,n,s),s.write_shift(4,t),s}function V2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,s=Gn(e);t.biff==2&&e.l++;var c=X0(e,n-e.l,t);return s.val=c,s}function H2(e,r,t,n,s){var c=!s||s.biff==8,h=Oe(8+ +c+(1+c)*t.length);return os(e,r,n,h),h.write_shift(2,t.length),c&&h.write_shift(1,1),h.write_shift((1+c)*t.length,t,c?"utf16le":"sbcs"),h}function G2(e,r,t){var n=e.read_shift(2),s=gs(e,0,t);return[n,s]}function X2(e,r,t,n){var s=t&&t.biff==5;n||(n=Oe(s?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(s?1:2,r.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le");var c=n.length>n.l?n.slice(0,n.l):n;return c.l==null&&(c.l=c.length),c}var z2=gs;function Zf(e,r,t){var n=e.l+r,s=t.biff==8||!t.biff?4:2,c=e.read_shift(s),h=e.read_shift(s),d=e.read_shift(2),m=e.read_shift(2);return e.l=n,{s:{r:c,c:d},e:{r:h,c:m}}}function Y2(e,r){var t=r.biff==8||!r.biff?4:2,n=Oe(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function K2(e){var r=e.read_shift(2),t=e.read_shift(2),n=Lh(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function q2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),s=e.read_shift(2),c=[];e.l<t;)c.push(Lh(e));if(e.l!==t)throw new Error("MulRK read error");var h=e.read_shift(2);if(c.length!=h-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:h,rkrec:c}}function Z2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),s=e.read_shift(2),c=[];e.l<t;)c.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var h=e.read_shift(2);if(c.length!=h-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:h,ixfe:c}}function J2(e,r,t,n){var s={},c=e.read_shift(4),h=e.read_shift(4),d=e.read_shift(4),m=e.read_shift(2);return s.patternType=Dg[d>>26],n.cellStyles&&(s.alc=c&7,s.fWrap=c>>3&1,s.alcV=c>>4&7,s.fJustLast=c>>7&1,s.trot=c>>8&255,s.cIndent=c>>16&15,s.fShrinkToFit=c>>20&1,s.iReadOrder=c>>22&2,s.fAtrNum=c>>26&1,s.fAtrFnt=c>>27&1,s.fAtrAlc=c>>28&1,s.fAtrBdr=c>>29&1,s.fAtrPat=c>>30&1,s.fAtrProt=c>>31&1,s.dgLeft=h&15,s.dgRight=h>>4&15,s.dgTop=h>>8&15,s.dgBottom=h>>12&15,s.icvLeft=h>>16&127,s.icvRight=h>>23&127,s.grbitDiag=h>>30&3,s.icvTop=d&127,s.icvBottom=d>>7&127,s.icvDiag=d>>14&127,s.dgDiag=d>>21&15,s.icvFore=m&127,s.icvBack=m>>7&127,s.fsxButton=m>>14&1),s}function Q2(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=J2(e,r,n.fStyle,t),n}function Jf(e,r,t,n){var s=t&&t.biff==5;n||(n=Oe(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var c=0;return e.numFmtId>0&&s&&(c|=1024),n.write_shift(4,c),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function $2(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function em(e){var r=Oe(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function Qf(e,r,t){var n=Gn(e);(t.biff==2||r==9)&&++e.l;var s=a2(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function tm(e,r,t,n,s,c){var h=Oe(8);return os(e,r,n,h),Rh(t,c,h),h}function rm(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Gn(e),s=Na(e);return n.val=s,n}function am(e,r,t,n){var s=Oe(14);return os(e,r,n,s),is(t,s),s}var $f=d2;function nm(e,r,t){var n=e.l+r,s=e.read_shift(2),c=e.read_shift(2);if(t.sbcch=c,c==1025||c==14849)return[c,s];if(c<1||c>255)throw new Error("Unexpected SupBook type: "+c);for(var h=ss(e,c),d=[];n>e.l;)d.push(X0(e));return[c,s,h,d]}function e1(e,r,t){var n=e.read_shift(2),s,c={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(s=g2(e,r-2,t)),c.body=s||e.read_shift(r-2),typeof s=="string"&&(c.Name=s),c}var im=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function t1(e,r,t){var n=e.l+r,s=e.read_shift(2),c=e.read_shift(1),h=e.read_shift(1),d=e.read_shift(t&&t.biff==2?1:2),m=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),m=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var g=ss(e,h,t);s&32&&(g=im[g.charCodeAt(0)]);var v=n-e.l;t&&t.biff==2&&--v;var _=n==e.l||d===0||!(v>0)?[]:y3(e,v,t,d);return{chKey:c,Name:g,itab:m,rgce:_}}function Vh(e,r,t){if(t.biff<8)return sm(e,r,t);for(var n=[],s=e.l+r,c=e.read_shift(t.biff>8?4:2);c--!==0;)n.push(x2(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function sm(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=G0(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function om(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),s=e.read_shift(2),c=ss(e,n,t),h=ss(e,s,t);return[c,h]}function cm(e,r,t){var n=Uh(e);e.l++;var s=e.read_shift(1);return r-=8,[E3(e,r,t),s,n]}function r1(e,r,t){var n=m2(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,w3(e,r,t)]}function lm(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function fm(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),h=e.read_shift(2),d=gs(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:s},d,h,c]}}function hm(e,r,t){return fm(e,r,t)}function um(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(lc(e));return t}function dm(e){var r=Oe(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)jh(e[t],r);return r}function xm(e,r,t){if(t&&t.biff<8)return mm(e,r,t);var n=Wh(e),s=y2(e,r-22,n[1]);return{cmo:n,ft:s}}var gm={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=t,{fmt:n}}};function mm(e,r,t){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var h=[];return h.push((gm[n]||Ia)(e,r,t)),{cmo:[s,n,c],ft:h}}function pm(e,r,t){var n=e.l,s="";try{e.l+=4;var c=(t.lastobj||{cmo:[0,0]}).cmo[1],h;[0,5,7,11,12,14].indexOf(c)==-1?e.l+=6:h=s2(e,6,t);var d=e.read_shift(2);e.read_shift(2),ra(e,2);var m=e.read_shift(2);e.l+=m;for(var g=1;g<e.lens.length-1;++g){if(e.l-n!=e.lens[g])throw new Error("TxO: bad continue record");var v=e[e.l],_=ss(e,e.lens[g+1]-e.lens[g]-1);if(s+=_,s.length>=(v?d:2*d))break}if(s.length!==d&&s.length!==d*2)throw new Error("cchText: "+d+" != "+s.length);return e.l=n+r,{t:s}}catch{return e.l=n+r,{t:s}}}function wm(e,r){var t=lc(e);e.l+=16;var n=f2(e,r-24);return[t,n]}function vm(e){var r=Oe(24),t=Lr(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)r.write_shift(1,parseInt(n[s],16));return da([r,h2(e[1])])}function ym(e,r){e.read_shift(2);var t=lc(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(La,""),[t,n]}function Em(e){var r=e[1].Tooltip,t=Oe(10+2*(r.length+1));t.write_shift(2,2048);var n=Lr(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var s=0;s<r.length;++s)t.write_shift(2,r.charCodeAt(s));return t.write_shift(2,0),t}function _m(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=Uf[t]||t,t=e.read_shift(2),r[1]=Uf[t]||t,r}function Am(e){return e||(e=Oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function bm(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Bh(e));return t}function Cm(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Bh(e));return t}function Sm(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function Hh(e,r,t){if(!t.cellStyles)return Ia(e,r);var n=t&&t.biff>=12?4:2,s=e.read_shift(n),c=e.read_shift(n),h=e.read_shift(n),d=e.read_shift(n),m=e.read_shift(2);n==2&&(e.l+=2);var g={s,e:c,w:h,ixfe:d,flags:m};return(t.biff>=5||!t.biff)&&(g.level=m>>8&7),g}function Tm(e,r){var t=Oe(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function Nm(e,r){var t={};return r<32||(e.l+=16,t.header=Na(e),t.footer=Na(e),e.l+=2),t}function km(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function Im(e){for(var r=Oe(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}var Dm=Gn,Fm=Oh,Om=X0;function Rm(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function Mm(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Gn(e);++e.l;var s=gs(e,r-7,t);return n.t="str",n.val=s,n}function Pm(e){var r=Gn(e);++e.l;var t=Na(e);return r.t="n",r.val=t,r}function Bm(e,r,t){var n=Oe(15);return q0(n,e,r),n.write_shift(8,t,"f"),n}function Lm(e){var r=Gn(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function jm(e,r,t){var n=Oe(9);return q0(n,e,r),n.write_shift(2,t),n}function Um(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function Wm(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function Vm(e,r,t){var n=e.l+r,s=Gn(e),c=e.read_shift(2),h=ss(e,c,t);return e.l=n,s.t="str",s.val=h,s}var Hm=[2,3,48,49,131,139,140,245],$c=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=sc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(d,m){var g=[],v=Fi(1);switch(m.type){case"base64":v=Qa(en(d));break;case"binary":v=Qa(d);break;case"buffer":case"array":v=d;break}wa(v,0);var _=v.read_shift(1),S=!!(_&136),T=!1,N=!1;switch(_){case 2:break;case 3:break;case 48:T=!0,S=!0;break;case 49:T=!0,S=!0;break;case 131:break;case 139:break;case 140:N=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+_.toString(16))}var C=0,D=521;_==2&&(C=v.read_shift(2)),v.l+=3,_!=2&&(C=v.read_shift(4)),C>1048576&&(C=1e6),_!=2&&(D=v.read_shift(2));var U=v.read_shift(2),X=m.codepage||1252;_!=2&&(v.l+=16,v.read_shift(1),v[v.l]!==0&&(X=e[v[v.l]]),v.l+=1,v.l+=2),N&&(v.l+=36);for(var O=[],q={},oe=Math.min(v.length,_==2?521:D-10-(T?264:0)),J=N?32:11;v.l<oe&&v[v.l]!=13;)switch(q={},q.name=N0.utils.decode(X,v.slice(v.l,v.l+J)).replace(/[\u0000\r\n].*$/g,""),v.l+=J,q.type=String.fromCharCode(v.read_shift(1)),_!=2&&!N&&(q.offset=v.read_shift(4)),q.len=v.read_shift(1),_==2&&(q.offset=v.read_shift(2)),q.dec=v.read_shift(1),q.name.length&&O.push(q),_!=2&&(v.l+=N?13:14),q.type){case"B":(!T||q.len!=8)&&m.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+q.type)}if(v[v.l]!==13&&(v.l=D-1),v.read_shift(1)!==13)throw new Error("DBF Terminator not found "+v.l+" "+v[v.l]);v.l=D;var M=0,ie=0;for(g[0]=[],ie=0;ie!=O.length;++ie)g[0][ie]=O[ie].name;for(;C-- >0;){if(v[v.l]===42){v.l+=U;continue}for(++v.l,g[++M]=[],ie=0,ie=0;ie!=O.length;++ie){var j=v.slice(v.l,v.l+O[ie].len);v.l+=O[ie].len,wa(j,0);var _e=N0.utils.decode(X,j);switch(O[ie].type){case"C":_e.trim().length&&(g[M][ie]=_e.replace(/\s+$/,""));break;case"D":_e.length===8?g[M][ie]=new Date(+_e.slice(0,4),+_e.slice(4,6)-1,+_e.slice(6,8)):g[M][ie]=_e;break;case"F":g[M][ie]=parseFloat(_e.trim());break;case"+":case"I":g[M][ie]=N?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(_e.trim().toUpperCase()){case"Y":case"T":g[M][ie]=!0;break;case"N":case"F":g[M][ie]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+_e+"|")}break;case"M":if(!S)throw new Error("DBF Unexpected MEMO for type "+_.toString(16));g[M][ie]="##MEMO##"+(N?parseInt(_e.trim(),10):j.read_shift(4));break;case"N":_e=_e.replace(/\u0000/g,"").trim(),_e&&_e!="."&&(g[M][ie]=+_e||0);break;case"@":g[M][ie]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":g[M][ie]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":g[M][ie]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[M][ie]=-j.read_shift(-8,"f");break;case"B":if(T&&O[ie].len==8){g[M][ie]=j.read_shift(8,"f");break}case"G":case"P":j.l+=O[ie].len;break;case"0":if(O[ie].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+O[ie].type)}}}if(_!=2&&v.l<v.length&&v[v.l++]!=26)throw new Error("DBF EOF Marker missing "+(v.l-1)+" of "+v.length+" "+v[v.l-1].toString(16));return m&&m.sheetRows&&(g=g.slice(0,m.sheetRows)),m.DBF=O,g}function n(d,m){var g=m||{};g.dateNF||(g.dateNF="yyyymmdd");var v=Ks(t(d,g),g);return v["!cols"]=g.DBF.map(function(_){return{wch:_.len,DBF:_}}),delete g.DBF,v}function s(d,m){try{return Bi(n(d,m),m)}catch(g){if(m&&m.WTF)throw g}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function h(d,m){var g=m||{};if(+g.codepage>=0&&Sn(+g.codepage),g.type=="string")throw new Error("Cannot write DBF to JS string");var v=Va(),_=ec(d,{header:1,raw:!0,cellDates:!0}),S=_[0],T=_.slice(1),N=d["!cols"]||[],C=0,D=0,U=0,X=1;for(C=0;C<S.length;++C){if(((N[C]||{}).DBF||{}).name){S[C]=N[C].DBF.name,++U;continue}if(S[C]!=null){if(++U,typeof S[C]=="number"&&(S[C]=S[C].toString(10)),typeof S[C]!="string")throw new Error("DBF Invalid column name "+S[C]+" |"+typeof S[C]+"|");if(S.indexOf(S[C])!==C){for(D=0;D<1024;++D)if(S.indexOf(S[C]+"_"+D)==-1){S[C]+="_"+D;break}}}}var O=ar(d["!ref"]),q=[],oe=[],J=[];for(C=0;C<=O.e.c-O.s.c;++C){var M="",ie="",j=0,_e=[];for(D=0;D<T.length;++D)T[D][C]!=null&&_e.push(T[D][C]);if(_e.length==0||S[C]==null){q[C]="?";continue}for(D=0;D<_e.length;++D){switch(typeof _e[D]){case"number":ie="B";break;case"string":ie="C";break;case"boolean":ie="L";break;case"object":ie=_e[D]instanceof Date?"D":"C";break;default:ie="C"}j=Math.max(j,String(_e[D]).length),M=M&&M!=ie?"C":ie}j>250&&(j=250),ie=((N[C]||{}).DBF||{}).type,ie=="C"&&N[C].DBF.len>j&&(j=N[C].DBF.len),M=="B"&&ie=="N"&&(M="N",J[C]=N[C].DBF.dec,j=N[C].DBF.len),oe[C]=M=="C"||ie=="N"?j:c[M]||0,X+=oe[C],q[C]=M}var he=v.next(32);for(he.write_shift(4,318902576),he.write_shift(4,T.length),he.write_shift(2,296+32*U),he.write_shift(2,X),C=0;C<4;++C)he.write_shift(4,0);for(he.write_shift(4,0|(+r[F1]||3)<<8),C=0,D=0;C<S.length;++C)if(S[C]!=null){var te=v.next(32),be=(S[C].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,be,"sbcs"),te.write_shift(1,q[C]=="?"?"C":q[C],"sbcs"),te.write_shift(4,D),te.write_shift(1,oe[C]||c[q[C]]||0),te.write_shift(1,J[C]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),D+=oe[C]||c[q[C]]||0}var $e=v.next(264);for($e.write_shift(4,13),C=0;C<65;++C)$e.write_shift(4,0);for(C=0;C<T.length;++C){var ae=v.next(X);for(ae.write_shift(1,0),D=0;D<S.length;++D)if(S[D]!=null)switch(q[D]){case"L":ae.write_shift(1,T[C][D]==null?63:T[C][D]?84:70);break;case"B":ae.write_shift(8,T[C][D]||0,"f");break;case"N":var tt="0";for(typeof T[C][D]=="number"&&(tt=T[C][D].toFixed(J[D]||0)),U=0;U<oe[D]-tt.length;++U)ae.write_shift(1,32);ae.write_shift(1,tt,"sbcs");break;case"D":T[C][D]?(ae.write_shift(4,("0000"+T[C][D].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(T[C][D].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+T[C][D].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var Re=String(T[C][D]!=null?T[C][D]:"").slice(0,oe[D]);for(ae.write_shift(1,Re,"sbcs"),U=0;U<oe[D]-Re.length;++U)ae.write_shift(1,32);break}}return v.next(1).write_shift(1,26),v.end()}return{to_workbook:s,to_sheet:n,from_sheet:h}}(),Gh=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Hr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(S,T){var N=e[T];return typeof N=="number"?df(N):N},n=function(S,T,N){var C=T.charCodeAt(0)-32<<4|N.charCodeAt(0)-48;return C==59?S:df(C)};e["|"]=254;function s(S,T){switch(T.type){case"base64":return c(en(S),T);case"binary":return c(S,T);case"buffer":return c(Ht&&Buffer.isBuffer(S)?S.toString("binary"):Pi(S),T);case"array":return c(ns(S),T)}throw new Error("Unrecognized type "+T.type)}function c(S,T){var N=S.split(/[\n\r]+/),C=-1,D=-1,U=0,X=0,O=[],q=[],oe=null,J={},M=[],ie=[],j=[],_e=0,he;for(+T.codepage>=0&&Sn(+T.codepage);U!==N.length;++U){_e=0;var te=N[U].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),be=te.replace(/;;/g,"\0").split(";").map(function(ne){return ne.replace(/\u0000/g,";")}),$e=be[0],ae;if(te.length>0)switch($e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":be[1].charAt(0)=="P"&&q.push(te.slice(3).replace(/;;/g,";"));break;case"C":var tt=!1,Re=!1,Lt=!1,fe=!1,ot=-1,mt=-1;for(X=1;X<be.length;++X)switch(be[X].charAt(0)){case"A":break;case"X":D=parseInt(be[X].slice(1))-1,Re=!0;break;case"Y":for(C=parseInt(be[X].slice(1))-1,Re||(D=0),he=O.length;he<=C;++he)O[he]=[];break;case"K":ae=be[X].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(Nn(ae))?isNaN(Hs(ae).getDate())||(ae=Tr(ae)):(ae=Nn(ae),oe!==null&&zs(oe)&&(ae=cc(ae))),tt=!0;break;case"E":fe=!0;var K=Ws(be[X].slice(1),{r:C,c:D});O[C][D]=[O[C][D],K];break;case"S":Lt=!0,O[C][D]=[O[C][D],"S5S"];break;case"G":break;case"R":ot=parseInt(be[X].slice(1))-1;break;case"C":mt=parseInt(be[X].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}if(tt&&(O[C][D]&&O[C][D].length==2?O[C][D][0]=ae:O[C][D]=ae,oe=null),Lt){if(fe)throw new Error("SYLK shared formula cannot have own formula");var ce=ot>-1&&O[ot][mt];if(!ce||!ce[1])throw new Error("SYLK shared formula cannot find base");O[C][D][1]=cu(ce[1],{r:C-ot,c:D-mt})}break;case"F":var ee=0;for(X=1;X<be.length;++X)switch(be[X].charAt(0)){case"X":D=parseInt(be[X].slice(1))-1,++ee;break;case"Y":for(C=parseInt(be[X].slice(1))-1,he=O.length;he<=C;++he)O[he]=[];break;case"M":_e=parseInt(be[X].slice(1))/20;break;case"F":break;case"G":break;case"P":oe=q[parseInt(be[X].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=be[X].slice(1).split(" "),he=parseInt(j[0],10);he<=parseInt(j[1],10);++he)_e=parseInt(j[2],10),ie[he-1]=_e===0?{hidden:!0}:{wch:_e},Oi(ie[he-1]);break;case"C":D=parseInt(be[X].slice(1))-1,ie[D]||(ie[D]={});break;case"R":C=parseInt(be[X].slice(1))-1,M[C]||(M[C]={}),_e>0?(M[C].hpt=_e,M[C].hpx=Xs(_e)):_e===0&&(M[C].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}ee<1&&(oe=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}}return M.length>0&&(J["!rows"]=M),ie.length>0&&(J["!cols"]=ie),T&&T.sheetRows&&(O=O.slice(0,T.sheetRows)),[O,J]}function h(S,T){var N=s(S,T),C=N[0],D=N[1],U=Ks(C,T);return Hr(D).forEach(function(X){U[X]=D[X]}),U}function d(S,T){return Bi(h(S,T),T)}function m(S,T,N,C){var D="C;Y"+(N+1)+";X"+(C+1)+";K";switch(S.t){case"n":D+=S.v||0,S.f&&!S.F&&(D+=";E"+Ml(S.f,{r:N,c:C}));break;case"b":D+=S.v?"TRUE":"FALSE";break;case"e":D+=S.w||S.v;break;case"d":D+='"'+(S.w||S.v)+'"';break;case"s":D+='"'+S.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return D}function g(S,T){T.forEach(function(N,C){var D="F;W"+(C+1)+" "+(C+1)+" ";N.hidden?D+="0":(typeof N.width=="number"&&!N.wpx&&(N.wpx=P0(N.width)),typeof N.wpx=="number"&&!N.wch&&(N.wch=B0(N.wpx)),typeof N.wch=="number"&&(D+=Math.round(N.wch))),D.charAt(D.length-1)!=" "&&S.push(D)})}function v(S,T){T.forEach(function(N,C){var D="F;";N.hidden?D+="M0;":N.hpt?D+="M"+20*N.hpt+";":N.hpx&&(D+="M"+20*L0(N.hpx)+";"),D.length>2&&S.push(D+"R"+(C+1))})}function _(S,T){var N=["ID;PWXL;N;E"],C=[],D=ar(S["!ref"]),U,X=Array.isArray(S),O=`\r
`;N.push("P;PGeneral"),N.push("F;P0;DG0G8;M255"),S["!cols"]&&g(N,S["!cols"]),S["!rows"]&&v(N,S["!rows"]),N.push("B;Y"+(D.e.r-D.s.r+1)+";X"+(D.e.c-D.s.c+1)+";D"+[D.s.c,D.s.r,D.e.c,D.e.r].join(" "));for(var q=D.s.r;q<=D.e.r;++q)for(var oe=D.s.c;oe<=D.e.c;++oe){var J=St({r:q,c:oe});U=X?(S[q]||[])[oe]:S[J],!(!U||U.v==null&&(!U.f||U.F))&&C.push(m(U,S,q,oe))}return N.join(O)+O+C.join(O)+O+"E"+O}return{to_workbook:d,to_sheet:h,from_sheet:_}}(),Xh=function(){function e(c,h){switch(h.type){case"base64":return r(en(c),h);case"binary":return r(c,h);case"buffer":return r(Ht&&Buffer.isBuffer(c)?c.toString("binary"):Pi(c),h);case"array":return r(ns(c),h)}throw new Error("Unrecognized type "+h.type)}function r(c,h){for(var d=c.split(`
`),m=-1,g=-1,v=0,_=[];v!==d.length;++v){if(d[v].trim()==="BOT"){_[++m]=[],g=0;continue}if(!(m<0)){var S=d[v].trim().split(","),T=S[0],N=S[1];++v;for(var C=d[v]||"";(C.match(/["]/g)||[]).length&1&&v<d.length-1;)C+=`
`+d[++v];switch(C=C.trim(),+T){case-1:if(C==="BOT"){_[++m]=[],g=0;continue}else if(C!=="EOD")throw new Error("Unrecognized DIF special command "+C);break;case 0:C==="TRUE"?_[m][g]=!0:C==="FALSE"?_[m][g]=!1:isNaN(Nn(N))?isNaN(Hs(N).getDate())?_[m][g]=N:_[m][g]=Tr(N):_[m][g]=Nn(N),++g;break;case 1:C=C.slice(1,C.length-1),C=C.replace(/""/g,'"'),C&&C.match(/^=".*"$/)&&(C=C.slice(2,-1)),_[m][g++]=C!==""?C:null;break}if(C==="EOD")break}}return h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),_}function t(c,h){return Ks(e(c,h),h)}function n(c,h){return Bi(t(c,h),h)}var s=function(){var c=function(m,g,v,_,S){m.push(g),m.push(v+","+_),m.push('"'+S.replace(/"/g,'""')+'"')},h=function(m,g,v,_){m.push(g+","+v),m.push(g==1?'"'+_.replace(/"/g,'""')+'"':_)};return function(m){var g=[],v=ar(m["!ref"]),_,S=Array.isArray(m);c(g,"TABLE",0,1,"sheetjs"),c(g,"VECTORS",0,v.e.r-v.s.r+1,""),c(g,"TUPLES",0,v.e.c-v.s.c+1,""),c(g,"DATA",0,0,"");for(var T=v.s.r;T<=v.e.r;++T){h(g,-1,0,"BOT");for(var N=v.s.c;N<=v.e.c;++N){var C=St({r:T,c:N});if(_=S?(m[T]||[])[N]:m[C],!_){h(g,1,0,"");continue}switch(_.t){case"n":var D=_.w;!D&&_.v!=null&&(D=_.v),D==null?_.f&&!_.F?h(g,1,0,"="+_.f):h(g,1,0,""):h(g,0,D,"V");break;case"b":h(g,0,_.v?1:0,_.v?"TRUE":"FALSE");break;case"s":h(g,1,0,isNaN(_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=mn(_.z||bt[14],oa(Tr(_.v)))),h(g,0,_.w,"V");break;default:h(g,1,0,"")}}}h(g,-1,0,"EOD");var U=`\r
`,X=g.join(U);return X}}();return{to_workbook:n,to_sheet:t,from_sheet:s}}(),zh=function(){function e(_){return _.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(_){return _.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(_,S){for(var T=_.split(`
`),N=-1,C=-1,D=0,U=[];D!==T.length;++D){var X=T[D].trim().split(":");if(X[0]==="cell"){var O=Lr(X[1]);if(U.length<=O.r)for(N=U.length;N<=O.r;++N)U[N]||(U[N]=[]);switch(N=O.r,C=O.c,X[2]){case"t":U[N][C]=e(X[3]);break;case"v":U[N][C]=+X[3];break;case"vtf":var q=X[X.length-1];case"vtc":switch(X[3]){case"nl":U[N][C]=!!+X[4];break;default:U[N][C]=+X[4];break}X[2]=="vtf"&&(U[N][C]=[U[N][C],q])}}}return S&&S.sheetRows&&(U=U.slice(0,S.sheetRows)),U}function n(_,S){return Ks(t(_,S),S)}function s(_,S){return Bi(n(_,S),S)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),h=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function g(_){if(!_||!_["!ref"])return"";for(var S=[],T=[],N,C="",D=Ha(_["!ref"]),U=Array.isArray(_),X=D.s.r;X<=D.e.r;++X)for(var O=D.s.c;O<=D.e.c;++O)if(C=St({r:X,c:O}),N=U?(_[X]||[])[O]:_[C],!(!N||N.v==null||N.t==="z")){switch(T=["cell",C,"t"],N.t){case"s":case"str":T.push(r(N.v));break;case"n":N.f?(T[2]="vtf",T[3]="n",T[4]=N.v,T[5]=r(N.f)):(T[2]="v",T[3]=N.v);break;case"b":T[2]="vt"+(N.f?"f":"c"),T[3]="nl",T[4]=N.v?"1":"0",T[5]=r(N.f||(N.v?"TRUE":"FALSE"));break;case"d":var q=oa(Tr(N.v));T[2]="vtc",T[3]="nd",T[4]=""+q,T[5]=N.w||mn(N.z||bt[14],q);break;case"e":continue}S.push(T.join(":"))}return S.push("sheet:c:"+(D.e.c-D.s.c+1)+":r:"+(D.e.r-D.s.r+1)+":tvf:1"),S.push("valueformat:1:text-wiki"),S.join(`
`)}function v(_){return[c,h,d,h,g(_),m].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:v}}(),Gs=function(){function e(v,_,S,T,N){N.raw?_[S][T]=v:v===""||(v==="TRUE"?_[S][T]=!0:v==="FALSE"?_[S][T]=!1:isNaN(Nn(v))?isNaN(Hs(v).getDate())?_[S][T]=v:_[S][T]=Tr(v):_[S][T]=Nn(v))}function r(v,_){var S=_||{},T=[];if(!v||v.length===0)return T;for(var N=v.split(/[\r\n]/),C=N.length-1;C>=0&&N[C].length===0;)--C;for(var D=10,U=0,X=0;X<=C;++X)U=N[X].indexOf(" "),U==-1?U=N[X].length:U++,D=Math.max(D,U);for(X=0;X<=C;++X){T[X]=[];var O=0;for(e(N[X].slice(0,D).trim(),T,X,O,S),O=1;O<=(N[X].length-D)/10+1;++O)e(N[X].slice(D+(O-1)*10,D+O*10).trim(),T,X,O,S)}return S.sheetRows&&(T=T.slice(0,S.sheetRows)),T}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(v){for(var _={},S=!1,T=0,N=0;T<v.length;++T)(N=v.charCodeAt(T))==34?S=!S:!S&&N in t&&(_[N]=(_[N]||0)+1);N=[];for(T in _)Object.prototype.hasOwnProperty.call(_,T)&&N.push([_[T],T]);if(!N.length){_=n;for(T in _)Object.prototype.hasOwnProperty.call(_,T)&&N.push([_[T],T])}return N.sort(function(C,D){return C[0]-D[0]||n[C[1]]-n[D[1]]}),t[N.pop()[1]]||44}function c(v,_){var S=_||{},T="",N=S.dense?[]:{},C={s:{c:0,r:0},e:{c:0,r:0}};v.slice(0,4)=="sep="?v.charCodeAt(5)==13&&v.charCodeAt(6)==10?(T=v.charAt(4),v=v.slice(7)):v.charCodeAt(5)==13||v.charCodeAt(5)==10?(T=v.charAt(4),v=v.slice(6)):T=s(v.slice(0,1024)):S&&S.FS?T=S.FS:T=s(v.slice(0,1024));var D=0,U=0,X=0,O=0,q=0,oe=T.charCodeAt(0),J=!1,M=0,ie=v.charCodeAt(0);v=v.replace(/\r\n/mg,`
`);var j=S.dateNF!=null?kx(S.dateNF):null;function _e(){var he=v.slice(O,q),te={};if(he.charAt(0)=='"'&&he.charAt(he.length-1)=='"'&&(he=he.slice(1,-1).replace(/""/g,'"')),he.length===0)te.t="z";else if(S.raw)te.t="s",te.v=he;else if(he.trim().length===0)te.t="s",te.v=he;else if(he.charCodeAt(0)==61)he.charCodeAt(1)==34&&he.charCodeAt(he.length-1)==34?(te.t="s",te.v=he.slice(2,-1).replace(/""/g,'"')):nv(he)?(te.t="n",te.f=he.slice(1)):(te.t="s",te.v=he);else if(he=="TRUE")te.t="b",te.v=!0;else if(he=="FALSE")te.t="b",te.v=!1;else if(!isNaN(X=Nn(he)))te.t="n",S.cellText!==!1&&(te.w=he),te.v=X;else if(!isNaN(Hs(he).getDate())||j&&he.match(j)){te.z=S.dateNF||bt[14];var be=0;j&&he.match(j)&&(he=Ix(he,S.dateNF,he.match(j)||[]),be=1),S.cellDates?(te.t="d",te.v=Tr(he,be)):(te.t="n",te.v=oa(Tr(he,be))),S.cellText!==!1&&(te.w=mn(te.z,te.v instanceof Date?oa(te.v):te.v)),S.cellNF||delete te.z}else te.t="s",te.v=he;if(te.t=="z"||(S.dense?(N[D]||(N[D]=[]),N[D][U]=te):N[St({c:U,r:D})]=te),O=q+1,ie=v.charCodeAt(O),C.e.c<U&&(C.e.c=U),C.e.r<D&&(C.e.r=D),M==oe)++U;else if(U=0,++D,S.sheetRows&&S.sheetRows<=D)return!0}e:for(;q<v.length;++q)switch(M=v.charCodeAt(q)){case 34:ie===34&&(J=!J);break;case oe:case 10:case 13:if(!J&&_e())break e;break}return q-O>0&&_e(),N["!ref"]=Bt(C),N}function h(v,_){return!(_&&_.PRN)||_.FS||v.slice(0,4)=="sep="||v.indexOf("	")>=0||v.indexOf(",")>=0||v.indexOf(";")>=0?c(v,_):Ks(r(v,_),_)}function d(v,_){var S="",T=_.type=="string"?[0,0,0,0]:Hl(v,_);switch(_.type){case"base64":S=en(v);break;case"binary":S=v;break;case"buffer":_.codepage==65001?S=v.toString("utf8"):_.codepage&&typeof N0<"u"||(S=Ht&&Buffer.isBuffer(v)?v.toString("binary"):Pi(v));break;case"array":S=ns(v);break;case"string":S=v;break;default:throw new Error("Unrecognized type "+_.type)}return T[0]==239&&T[1]==187&&T[2]==191?S=vr(S.slice(3)):_.type!="string"&&_.type!="buffer"&&_.codepage==65001?S=vr(S):_.type=="binary"&&typeof N0<"u",S.slice(0,19)=="socialcalc:version:"?zh.to_sheet(_.type=="string"?S:vr(S),_):h(S,_)}function m(v,_){return Bi(d(v,_),_)}function g(v){for(var _=[],S=ar(v["!ref"]),T,N=Array.isArray(v),C=S.s.r;C<=S.e.r;++C){for(var D=[],U=S.s.c;U<=S.e.c;++U){var X=St({r:C,c:U});if(T=N?(v[C]||[])[U]:v[X],!T||T.v==null){D.push("          ");continue}for(var O=(T.w||(ui(T),T.w)||"").slice(0,10);O.length<10;)O+=" ";D.push(O+(U===0?" ":""))}_.push(D.join(""))}return _.join(`
`)}return{to_workbook:m,to_sheet:d,from_sheet:g}}();function Gm(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var s=Gh.to_workbook(e,t);return t.WTF=n,s}catch(c){if(t.WTF=n,!c.message.match(/SYLK bad record ID/)&&n)throw c;return Gs.to_workbook(e,r)}}var ts=function(){function e(K,ce,ee){if(K){wa(K,K.l||0);for(var ne=ee.Enum||ot;K.l<K.length;){var le=K.read_shift(2),Ze=ne[le]||ne[65535],Le=K.read_shift(2),Pe=K.l+Le,Be=Ze.f&&Ze.f(K,Le,ee);if(K.l=Pe,ce(Be,Ze,le))return}}}function r(K,ce){switch(ce.type){case"base64":return t(Qa(en(K)),ce);case"binary":return t(Qa(K),ce);case"buffer":case"array":return t(K,ce)}throw"Unsupported type "+ce.type}function t(K,ce){if(!K)return K;var ee=ce||{},ne=ee.dense?[]:{},le="Sheet1",Ze="",Le=0,Pe={},Be=[],Te=[],A={s:{r:0,c:0},e:{r:0,c:0}},Y=ee.sheetRows||0;if(K[2]==0&&(K[3]==8||K[3]==9)&&K.length>=16&&K[14]==5&&K[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(K[2]==2)ee.Enum=ot,e(K,function(Me,ft,vt){switch(vt){case 0:ee.vers=Me,Me>=4096&&(ee.qpro=!0);break;case 6:A=Me;break;case 204:Me&&(Ze=Me);break;case 222:Ze=Me;break;case 15:case 51:ee.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:vt==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=ee.dateNF||bt[14],ee.cellDates&&(Me[1].t="d",Me[1].v=cc(Me[1].v))),ee.qpro&&Me[3]>Le&&(ne["!ref"]=Bt(A),Pe[le]=ne,Be.push(le),ne=ee.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},Le=Me[3],le=Ze||"Sheet"+(Le+1),Ze="");var qr=ee.dense?(ne[Me[0].r]||[])[Me[0].c]:ne[St(Me[0])];if(qr){qr.t=Me[1].t,qr.v=Me[1].v,Me[1].z!=null&&(qr.z=Me[1].z),Me[1].f!=null&&(qr.f=Me[1].f);break}ee.dense?(ne[Me[0].r]||(ne[Me[0].r]=[]),ne[Me[0].r][Me[0].c]=Me[1]):ne[St(Me[0])]=Me[1];break}},ee);else if(K[2]==26||K[2]==14)ee.Enum=mt,K[2]==14&&(ee.qpro=!0,K.l=0),e(K,function(Me,ft,vt){switch(vt){case 204:le=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>Le&&(ne["!ref"]=Bt(A),Pe[le]=ne,Be.push(le),ne=ee.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},Le=Me[3],le="Sheet"+(Le+1)),Y>0&&Me[0].r>=Y)break;ee.dense?(ne[Me[0].r]||(ne[Me[0].r]=[]),ne[Me[0].r][Me[0].c]=Me[1]):ne[St(Me[0])]=Me[1],A.e.c<Me[0].c&&(A.e.c=Me[0].c),A.e.r<Me[0].r&&(A.e.r=Me[0].r);break;case 27:Me[14e3]&&(Te[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Te[Me[0]]=Me[1],Me[0]==Le&&(le=Me[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+K[2]);if(ne["!ref"]=Bt(A),Pe[Ze||le]=ne,Be.push(Ze||le),!Te.length)return{SheetNames:Be,Sheets:Pe};for(var ht={},lt=[],Xe=0;Xe<Te.length;++Xe)Pe[Be[Xe]]?(lt.push(Te[Xe]||Be[Xe]),ht[Te[Xe]]=Pe[Te[Xe]]||Pe[Be[Xe]]):(lt.push(Te[Xe]),ht[Te[Xe]]={"!ref":"A1"});return{SheetNames:lt,Sheets:ht}}function n(K,ce){var ee=ce||{};if(+ee.codepage>=0&&Sn(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var ne=Va(),le=ar(K["!ref"]),Ze=Array.isArray(K),Le=[];at(ne,0,c(1030)),at(ne,6,m(le));for(var Pe=Math.min(le.e.r,8191),Be=le.s.r;Be<=Pe;++Be)for(var Te=Yr(Be),A=le.s.c;A<=le.e.c;++A){Be===le.s.r&&(Le[A]=Br(A));var Y=Le[A]+Te,ht=Ze?(K[Be]||[])[A]:K[Y];if(!(!ht||ht.t=="z"))if(ht.t=="n")(ht.v|0)==ht.v&&ht.v>=-32768&&ht.v<=32767?at(ne,13,T(Be,A,ht.v)):at(ne,14,C(Be,A,ht.v));else{var lt=ui(ht);at(ne,15,_(Be,A,lt.slice(0,239)))}}return at(ne,1),ne.end()}function s(K,ce){var ee=ce||{};if(+ee.codepage>=0&&Sn(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var ne=Va();at(ne,0,h(K));for(var le=0,Ze=0;le<K.SheetNames.length;++le)(K.Sheets[K.SheetNames[le]]||{})["!ref"]&&at(ne,27,fe(K.SheetNames[le],Ze++));var Le=0;for(le=0;le<K.SheetNames.length;++le){var Pe=K.Sheets[K.SheetNames[le]];if(!(!Pe||!Pe["!ref"])){for(var Be=ar(Pe["!ref"]),Te=Array.isArray(Pe),A=[],Y=Math.min(Be.e.r,8191),ht=Be.s.r;ht<=Y;++ht)for(var lt=Yr(ht),Xe=Be.s.c;Xe<=Be.e.c;++Xe){ht===Be.s.r&&(A[Xe]=Br(Xe));var Me=A[Xe]+lt,ft=Te?(Pe[ht]||[])[Xe]:Pe[Me];if(!(!ft||ft.t=="z"))if(ft.t=="n")at(ne,23,_e(ht,Xe,Le,ft.v));else{var vt=ui(ft);at(ne,22,M(ht,Xe,Le,vt.slice(0,239)))}}++Le}}return at(ne,1),ne.end()}function c(K){var ce=Oe(2);return ce.write_shift(2,K),ce}function h(K){var ce=Oe(26);ce.write_shift(2,4096),ce.write_shift(2,4),ce.write_shift(4,0);for(var ee=0,ne=0,le=0,Ze=0;Ze<K.SheetNames.length;++Ze){var Le=K.SheetNames[Ze],Pe=K.Sheets[Le];if(!(!Pe||!Pe["!ref"])){++le;var Be=Ha(Pe["!ref"]);ee<Be.e.r&&(ee=Be.e.r),ne<Be.e.c&&(ne=Be.e.c)}}return ee>8191&&(ee=8191),ce.write_shift(2,ee),ce.write_shift(1,le),ce.write_shift(1,ne),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(1,1),ce.write_shift(1,2),ce.write_shift(4,0),ce.write_shift(4,0),ce}function d(K,ce,ee){var ne={s:{c:0,r:0},e:{c:0,r:0}};return ce==8&&ee.qpro?(ne.s.c=K.read_shift(1),K.l++,ne.s.r=K.read_shift(2),ne.e.c=K.read_shift(1),K.l++,ne.e.r=K.read_shift(2),ne):(ne.s.c=K.read_shift(2),ne.s.r=K.read_shift(2),ce==12&&ee.qpro&&(K.l+=2),ne.e.c=K.read_shift(2),ne.e.r=K.read_shift(2),ce==12&&ee.qpro&&(K.l+=2),ne.s.c==65535&&(ne.s.c=ne.e.c=ne.s.r=ne.e.r=0),ne)}function m(K){var ce=Oe(8);return ce.write_shift(2,K.s.c),ce.write_shift(2,K.s.r),ce.write_shift(2,K.e.c),ce.write_shift(2,K.e.r),ce}function g(K,ce,ee){var ne=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(ne[0].c=K.read_shift(1),ne[3]=K.read_shift(1),ne[0].r=K.read_shift(2),K.l+=2):(ne[2]=K.read_shift(1),ne[0].c=K.read_shift(2),ne[0].r=K.read_shift(2)),ne}function v(K,ce,ee){var ne=K.l+ce,le=g(K,ce,ee);if(le[1].t="s",ee.vers==20768){K.l++;var Ze=K.read_shift(1);return le[1].v=K.read_shift(Ze,"utf8"),le}return ee.qpro&&K.l++,le[1].v=K.read_shift(ne-K.l,"cstr"),le}function _(K,ce,ee){var ne=Oe(7+ee.length);ne.write_shift(1,255),ne.write_shift(2,ce),ne.write_shift(2,K),ne.write_shift(1,39);for(var le=0;le<ne.length;++le){var Ze=ee.charCodeAt(le);ne.write_shift(1,Ze>=128?95:Ze)}return ne.write_shift(1,0),ne}function S(K,ce,ee){var ne=g(K,ce,ee);return ne[1].v=K.read_shift(2,"i"),ne}function T(K,ce,ee){var ne=Oe(7);return ne.write_shift(1,255),ne.write_shift(2,ce),ne.write_shift(2,K),ne.write_shift(2,ee,"i"),ne}function N(K,ce,ee){var ne=g(K,ce,ee);return ne[1].v=K.read_shift(8,"f"),ne}function C(K,ce,ee){var ne=Oe(13);return ne.write_shift(1,255),ne.write_shift(2,ce),ne.write_shift(2,K),ne.write_shift(8,ee,"f"),ne}function D(K,ce,ee){var ne=K.l+ce,le=g(K,ce,ee);if(le[1].v=K.read_shift(8,"f"),ee.qpro)K.l=ne;else{var Ze=K.read_shift(2);q(K.slice(K.l,K.l+Ze),le),K.l+=Ze}return le}function U(K,ce,ee){var ne=ce&32768;return ce&=-32769,ce=(ne?K:0)+(ce>=8192?ce-16384:ce),(ne?"":"$")+(ee?Br(ce):Yr(ce))}var X={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},O=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function q(K,ce){wa(K,0);for(var ee=[],ne=0,le="",Ze="",Le="",Pe="";K.l<K.length;){var Be=K[K.l++];switch(Be){case 0:ee.push(K.read_shift(8,"f"));break;case 1:Ze=U(ce[0].c,K.read_shift(2),!0),le=U(ce[0].r,K.read_shift(2),!1),ee.push(Ze+le);break;case 2:{var Te=U(ce[0].c,K.read_shift(2),!0),A=U(ce[0].r,K.read_shift(2),!1);Ze=U(ce[0].c,K.read_shift(2),!0),le=U(ce[0].r,K.read_shift(2),!1),ee.push(Te+A+":"+Ze+le)}break;case 3:if(K.l<K.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(K.read_shift(2));break;case 6:{for(var Y="";Be=K[K.l++];)Y+=String.fromCharCode(Be);ee.push('"'+Y.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:Pe=ee.pop(),Le=ee.pop(),ee.push(["AND","OR"][Be-20]+"("+Le+","+Pe+")");break;default:if(Be<32&&O[Be])Pe=ee.pop(),Le=ee.pop(),ee.push(Le+O[Be]+Pe);else if(X[Be]){if(ne=X[Be][1],ne==69&&(ne=K[K.l++]),ne>ee.length){console.error("WK1 bad formula parse 0x"+Be.toString(16)+":|"+ee.join("|")+"|");return}var ht=ee.slice(-ne);ee.length-=ne,ee.push(X[Be][0]+"("+ht.join(",")+")")}else return Be<=7?console.error("WK1 invalid opcode "+Be.toString(16)):Be<=24?console.error("WK1 unsupported op "+Be.toString(16)):Be<=30?console.error("WK1 invalid opcode "+Be.toString(16)):Be<=115?console.error("WK1 unsupported function opcode "+Be.toString(16)):console.error("WK1 unrecognized opcode "+Be.toString(16))}}ee.length==1?ce[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function oe(K){var ce=[{c:0,r:0},{t:"n",v:0},0];return ce[0].r=K.read_shift(2),ce[3]=K[K.l++],ce[0].c=K[K.l++],ce}function J(K,ce){var ee=oe(K);return ee[1].t="s",ee[1].v=K.read_shift(ce-4,"cstr"),ee}function M(K,ce,ee,ne){var le=Oe(6+ne.length);le.write_shift(2,K),le.write_shift(1,ee),le.write_shift(1,ce),le.write_shift(1,39);for(var Ze=0;Ze<ne.length;++Ze){var Le=ne.charCodeAt(Ze);le.write_shift(1,Le>=128?95:Le)}return le.write_shift(1,0),le}function ie(K,ce){var ee=oe(K);ee[1].v=K.read_shift(2);var ne=ee[1].v>>1;if(ee[1].v&1)switch(ne&7){case 0:ne=(ne>>3)*5e3;break;case 1:ne=(ne>>3)*500;break;case 2:ne=(ne>>3)/20;break;case 3:ne=(ne>>3)/200;break;case 4:ne=(ne>>3)/2e3;break;case 5:ne=(ne>>3)/2e4;break;case 6:ne=(ne>>3)/16;break;case 7:ne=(ne>>3)/64;break}return ee[1].v=ne,ee}function j(K,ce){var ee=oe(K),ne=K.read_shift(4),le=K.read_shift(4),Ze=K.read_shift(2);if(Ze==65535)return ne===0&&le===3221225472?(ee[1].t="e",ee[1].v=15):ne===0&&le===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var Le=Ze&32768;return Ze=(Ze&32767)-16446,ee[1].v=(1-Le*2)*(le*Math.pow(2,Ze+32)+ne*Math.pow(2,Ze)),ee}function _e(K,ce,ee,ne){var le=Oe(14);if(le.write_shift(2,K),le.write_shift(1,ee),le.write_shift(1,ce),ne==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var Ze=0,Le=0,Pe=0,Be=0;return ne<0&&(Ze=1,ne=-ne),Le=Math.log2(ne)|0,ne/=Math.pow(2,Le-31),Be=ne>>>0,Be&2147483648||(ne/=2,++Le,Be=ne>>>0),ne-=Be,Be|=2147483648,Be>>>=0,ne*=Math.pow(2,32),Pe=ne>>>0,le.write_shift(4,Pe),le.write_shift(4,Be),Le+=16383+(Ze?32768:0),le.write_shift(2,Le),le}function he(K,ce){var ee=j(K);return K.l+=ce-14,ee}function te(K,ce){var ee=oe(K),ne=K.read_shift(4);return ee[1].v=ne>>6,ee}function be(K,ce){var ee=oe(K),ne=K.read_shift(8,"f");return ee[1].v=ne,ee}function $e(K,ce){var ee=be(K);return K.l+=ce-10,ee}function ae(K,ce){return K[K.l+ce-1]==0?K.read_shift(ce,"cstr"):""}function tt(K,ce){var ee=K[K.l++];ee>ce-1&&(ee=ce-1);for(var ne="";ne.length<ee;)ne+=String.fromCharCode(K[K.l++]);return ne}function Re(K,ce,ee){if(!(!ee.qpro||ce<21)){var ne=K.read_shift(1);K.l+=17,K.l+=1,K.l+=2;var le=K.read_shift(ce-21,"cstr");return[ne,le]}}function Lt(K,ce){for(var ee={},ne=K.l+ce;K.l<ne;){var le=K.read_shift(2);if(le==14e3){for(ee[le]=[0,""],ee[le][0]=K.read_shift(2);K[K.l];)ee[le][1]+=String.fromCharCode(K[K.l]),K.l++;K.l++}}return ee}function fe(K,ce){var ee=Oe(5+K.length);ee.write_shift(2,14e3),ee.write_shift(2,ce);for(var ne=0;ne<K.length;++ne){var le=K.charCodeAt(ne);ee[ee.l++]=le>127?95:le}return ee[ee.l++]=0,ee}var ot={0:{n:"BOF",f:ra},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:S},14:{n:"NUMBER",f:N},15:{n:"LABEL",f:v},16:{n:"FORMULA",f:D},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:v},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:tt},65535:{n:""}},mt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:J},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:ie},25:{n:"FORMULA19",f:he},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Lt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:be},40:{n:"FORMULA28",f:$e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Re},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:r}}();function Xm(e){var r={},t=e.match(Da),n=0,s=!1;if(t)for(;n!=t.length;++n){var c=Tt(t[n]);switch(c[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!c.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(c.val=="1")break;r.cp=sl[parseInt(c.val,10)];break;case"<outline":if(!c.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=c.val;break;case"<sz":r.sz=c.val;break;case"<strike":if(!c.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!c.val)break;switch(c.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(c.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(c.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":c.rgb&&(r.color=c.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=c.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=c.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(c[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+c[0])}}return r}var zm=function(){var e=D0("t"),r=D0("rPr");function t(c){var h=c.match(e);if(!h)return{t:"s",v:""};var d={t:"s",v:rr(h[1])},m=c.match(r);return m&&(d.s=Xm(m[1])),d}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(h){return h.replace(n,"").split(s).map(t).filter(function(d){return d.v})}}(),Ym=function(){var r=/(\r\n|\n)/g;function t(s,c,h){var d=[];s.u&&d.push("text-decoration: underline;"),s.uval&&d.push("text-underline-style:"+s.uval+";"),s.sz&&d.push("font-size:"+s.sz+"pt;"),s.outline&&d.push("text-effect: outline;"),s.shadow&&d.push("text-shadow: auto;"),c.push('<span style="'+d.join("")+'">'),s.b&&(c.push("<b>"),h.push("</b>")),s.i&&(c.push("<i>"),h.push("</i>")),s.strike&&(c.push("<s>"),h.push("</s>"));var m=s.valign||"";return m=="superscript"||m=="super"?m="sup":m=="subscript"&&(m="sub"),m!=""&&(c.push("<"+m+">"),h.push("</"+m+">")),h.push("</span>"),s}function n(s){var c=[[],s.v,[]];return s.v?(s.s&&t(s.s,c[0],c[2]),c[0].join("")+c[1].replace(r,"<br/>")+c[2].join("")):""}return function(c){return c.map(n).join("")}}(),Km=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,qm=/<(?:\w+:)?r>/,Zm=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Il(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=rr(vr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=vr(e),t&&(n.h=ml(n.t))):e.match(qm)&&(n.r=vr(e),n.t=rr(vr((e.replace(Zm,"").match(Km)||[]).join("").replace(Da,""))),t&&(n.h=Ym(zm(n.r)))),n):{t:""}}var Jm=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Qm=/<(?:\w+:)?(?:si|sstItem)>/g,$m=/<\/(?:\w+:)?(?:si|sstItem)>/;function ep(e,r){var t=[],n="";if(!e)return t;var s=e.match(Jm);if(s){n=s[2].replace(Qm,"").split($m);for(var c=0;c!=n.length;++c){var h=Il(n[c].trim(),r);h!=null&&(t[t.length]=h)}s=Tt(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}var tp=/^\s|\s$|[\t\n\r]/;function Yh(e,r){if(!r.bookSST)return"";var t=[Kr];t[t.length]=rt("sst",null,{xmlns:fs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],c="<si>";s.r?c+=s.r:(c+="<t",s.t||(s.t=""),s.t.match(tp)&&(c+=' xml:space="preserve"'),c+=">"+mr(s.t)+"</t>"),c+="</si>",t[t.length]=c}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function rp(e){return[e.read_shift(4),e.read_shift(4)]}function ap(e,r){var t=[],n=!1;return xi(e,function(c,h,d){switch(d){case 159:t.Count=c[0],t.Unique=c[1];break;case 19:t.push(c);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(h.T,!n||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),t}function np(e,r){return r||(r=Oe(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var ip=gg;function sp(e){var r=Va();Ve(r,159,np(e));for(var t=0;t<e.length;++t)Ve(r,19,ip(e[t]));return Ve(r,160),r.end()}function Kh(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function hi(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function op(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=hi(e,4),r.U=hi(e,4),r.W=hi(e,4),r}function cp(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},s=e.read_shift(4),c=[];s-- >0;)c.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=c,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function lp(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(cp(e));return r}function fp(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function hp(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=hi(e,4),r.U=hi(e,4),r.W=hi(e,4),r}function up(e){var r=hp(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function qh(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function Zh(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function dp(e){var r=hi(e);switch(r.Minor){case 2:return[r.Minor,xp(e)];case 3:return[r.Minor,gp()];case 4:return[r.Minor,mp(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function xp(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=qh(e,t),s=Zh(e,e.length-e.l);return{t:"Std",h:n,v:s}}function gp(){throw new Error("File is password-protected: ECMA-376 Extensible")}function mp(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(Da,function(c){var h=Tt(c);switch(Hn(h[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(d){n[d]=h[d]});break;case"<dataIntegrity":n.encryptedHmacKey=h.encryptedHmacKey,n.encryptedHmacValue=h.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=h.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(h);break;default:throw h[0]}}),n}function pp(e,r){var t={},n=t.EncryptionVersionInfo=hi(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var s=e.read_shift(4);return r-=4,t.EncryptionHeader=qh(e,s),r-=s,t.EncryptionVerifier=Zh(e,r),t}function wp(e){var r={},t=r.EncryptionVersionInfo=hi(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function Dl(e){var r=0,t,n=Kh(e),s=n.length+1,c,h,d,m,g;for(t=Fi(s),t[0]=n.length,c=1;c!=s;++c)t[c]=n[c-1];for(c=s-1;c>=0;--c)h=t[c],d=r&16384?1:0,m=r<<1&32767,g=d|m,r=g^h;return r^52811}var Jh=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(h){return(h/2|h*128)&255},s=function(h,d){return n(h^d)},c=function(h){for(var d=r[h.length-1],m=104,g=h.length-1;g>=0;--g)for(var v=h[g],_=0;_!=7;++_)v&64&&(d^=t[m]),v*=2,--m;return d};return function(h){for(var d=Kh(h),m=c(d),g=d.length,v=Fi(16),_=0;_!=16;++_)v[_]=0;var S,T,N;for((g&1)===1&&(S=m>>8,v[g]=s(e[0],S),--g,S=m&255,T=d[d.length-1],v[g]=s(T,S));g>0;)--g,S=m>>8,v[g]=s(d[g],S),--g,S=m&255,v[g]=s(d[g],S);for(g=15,N=15-d.length;N>0;)S=m>>8,v[g]=s(e[N],S),--g,--N,S=m&255,v[g]=s(d[g],S),--g,--N;return v}}(),vp=function(e,r,t,n,s){s||(s=r),n||(n=Jh(e));var c,h;for(c=0;c!=r.length;++c)h=r[c],h^=n[t],h=(h>>5|h<<3)&255,s[c]=h,++t;return[s,t,n]},yp=function(e){var r=0,t=Jh(e);return function(n){var s=vp("",n,r,t);return r=s[1],s[0]}};function Ep(e,r,t,n){var s={key:ra(e),verificationBytes:ra(e)};return t.password&&(s.verifier=Dl(t.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=yp(t.password)),s}function _p(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=wp(e):n.Data=pp(e,r),n}function Ap(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?_p(e,r-2,n):Ep(e,t.biff>=8?r:r-2,t,n),n}var Qh=function(){function e(s,c){switch(c.type){case"base64":return r(en(s),c);case"binary":return r(s,c);case"buffer":return r(Ht&&Buffer.isBuffer(s)?s.toString("binary"):Pi(s),c);case"array":return r(ns(s),c)}throw new Error("Unrecognized type "+c.type)}function r(s,c){var h=c||{},d=h.dense?[]:{},m=s.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(v,_){Array.isArray(d)&&(d[_]=[]);for(var S=/\\\w+\b/g,T=0,N,C=-1;N=S.exec(v);){switch(N[0]){case"\\cell":var D=v.slice(T,S.lastIndex-N[0].length);if(D[0]==" "&&(D=D.slice(1)),++C,D.length){var U={v:D,t:"s"};Array.isArray(d)?d[_][C]=U:d[St({r:_,c:C})]=U}break}T=S.lastIndex}C>g.e.c&&(g.e.c=C)}),d["!ref"]=Bt(g),d}function t(s,c){return Bi(e(s,c),c)}function n(s){for(var c=["{\\rtf1\\ansi"],h=ar(s["!ref"]),d,m=Array.isArray(s),g=h.s.r;g<=h.e.r;++g){c.push("\\trowd\\trautofit1");for(var v=h.s.c;v<=h.e.c;++v)c.push("\\cellx"+(v+1));for(c.push("\\pard\\intbl"),v=h.s.c;v<=h.e.c;++v){var _=St({r:g,c:v});d=m?(s[g]||[])[v]:s[_],!(!d||d.v==null&&(!d.f||d.F))&&(c.push(" "+(d.w||(ui(d),d.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function bp(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function M0(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Cp(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,s=Math.max(r,t,n),c=Math.min(r,t,n),h=s-c;if(h===0)return[0,0,r];var d=0,m=0,g=s+c;switch(m=h/(g>1?2-g:g),s){case r:d=((t-n)/h+6)%6;break;case t:d=(n-r)/h+2;break;case n:d=(r-t)/h+4;break}return[d/6,m,g/2]}function Sp(e){var r=e[0],t=e[1],n=e[2],s=t*2*(n<.5?n:1-n),c=n-s/2,h=[c,c,c],d=6*r,m;if(t!==0)switch(d|0){case 0:case 6:m=s*d,h[0]+=s,h[1]+=m;break;case 1:m=s*(2-d),h[0]+=m,h[1]+=s;break;case 2:m=s*(d-2),h[1]+=s,h[2]+=m;break;case 3:m=s*(4-d),h[1]+=m,h[2]+=s;break;case 4:m=s*(d-4),h[2]+=s,h[0]+=m;break;case 5:m=s*(6-d),h[2]+=m,h[0]+=s;break}for(var g=0;g!=3;++g)h[g]=Math.round(h[g]*255);return h}function Qo(e,r){if(r===0)return e;var t=Cp(bp(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),M0(Sp(t))}var $h=6,Tp=15,Np=1,Ta=$h;function P0(e){return Math.floor((e+Math.round(128/Ta)/256)*Ta)}function B0(e){return Math.floor((e-5)/Ta*100+.5)/100}function $o(e){return Math.round((e*Ta+5)/Ta*256)/256}function Bc(e){return $o(B0(P0(e)))}function Fl(e){var r=Math.abs(e-Bc(e)),t=Ta;if(r>.005)for(Ta=Np;Ta<Tp;++Ta)Math.abs(e-Bc(e))<=r&&(r=Math.abs(e-Bc(e)),t=Ta);Ta=t}function Oi(e){e.width?(e.wpx=P0(e.width),e.wch=B0(e.wpx),e.MDW=Ta):e.wpx?(e.wch=B0(e.wpx),e.width=$o(e.wch),e.MDW=Ta):typeof e.wch=="number"&&(e.width=$o(e.wch),e.wpx=P0(e.width),e.MDW=Ta),e.customWidth&&delete e.customWidth}var kp=96,eu=kp;function L0(e){return e*96/eu}function Xs(e){return e*eu/96}var Ip={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Dp(e,r,t,n){r.Borders=[];var s={},c=!1;(e[0].match(Da)||[]).forEach(function(h){var d=Tt(h);switch(Hn(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},d.diagonalUp&&(s.diagonalUp=Sr(d.diagonalUp)),d.diagonalDown&&(s.diagonalDown=Sr(d.diagonalDown)),r.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(n&&n.WTF&&!c)throw new Error("unrecognized "+d[0]+" in borders")}})}function Fp(e,r,t,n){r.Fills=[];var s={},c=!1;(e[0].match(Da)||[]).forEach(function(h){var d=Tt(h);switch(Hn(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},r.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":d.patternType&&(s.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),d.indexed&&(s.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(s.bgColor.theme=parseInt(d.theme,10)),d.tint&&(s.bgColor.tint=parseFloat(d.tint)),d.rgb&&(s.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),d.theme&&(s.fgColor.theme=parseInt(d.theme,10)),d.tint&&(s.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(s.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(n&&n.WTF&&!c)throw new Error("unrecognized "+d[0]+" in fills")}})}function Op(e,r,t,n){r.Fonts=[];var s={},c=!1;(e[0].match(Da)||[]).forEach(function(h){var d=Tt(h);switch(Hn(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(s),s={};break;case"<name":d.val&&(s.name=vr(d.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=d.val?Sr(d.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=d.val?Sr(d.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(d.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=d.val?Sr(d.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=d.val?Sr(d.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=d.val?Sr(d.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=d.val?Sr(d.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=d.val?Sr(d.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":d.val&&(s.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(s.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(s.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(s.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=sl[parseInt(d.val,10)];break;case"<color":if(s.color||(s.color={}),d.auto&&(s.color.auto=Sr(d.auto)),d.rgb)s.color.rgb=d.rgb.slice(-6);else if(d.indexed){s.color.index=parseInt(d.indexed,10);var m=$i[s.color.index];s.color.index==81&&(m=$i[1]),m||(m=$i[1]),s.color.rgb=m[0].toString(16)+m[1].toString(16)+m[2].toString(16)}else d.theme&&(s.color.theme=parseInt(d.theme,10),d.tint&&(s.color.tint=parseFloat(d.tint)),d.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=Qo(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":c=!0;break;case"</AlternateContent>":c=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(n&&n.WTF&&!c)throw new Error("unrecognized "+d[0]+" in fonts")}})}function Rp(e,r,t){r.NumberFmt=[];for(var n=Hr(bt),s=0;s<n.length;++s)r.NumberFmt[n[s]]=bt[n[s]];var c=e[0].match(Da);if(c)for(s=0;s<c.length;++s){var h=Tt(c[s]);switch(Hn(h[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=rr(vr(h.formatCode)),m=parseInt(h.numFmtId,10);if(r.NumberFmt[m]=d,m>0){if(m>392){for(m=392;m>60&&r.NumberFmt[m]!=null;--m);r.NumberFmt[m]=d}fi(d,m)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+h[0]+" in numFmts")}}}function Mp(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=rt("numFmt",null,{numFmtId:n,formatCode:mr(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=rt("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var Mo=["numFmtId","fillId","fontId","borderId","xfId"],Po=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Pp(e,r,t){r.CellXf=[];var n,s=!1;(e[0].match(Da)||[]).forEach(function(c){var h=Tt(c),d=0;switch(Hn(h[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=h,delete n[0],d=0;d<Mo.length;++d)n[Mo[d]]&&(n[Mo[d]]=parseInt(n[Mo[d]],10));for(d=0;d<Po.length;++d)n[Po[d]]&&(n[Po[d]]=Sr(n[Po[d]]));if(r.NumberFmt&&n.numFmtId>392){for(d=392;d>60;--d)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[d]){n.numFmtId=d;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var m={};h.vertical&&(m.vertical=h.vertical),h.horizontal&&(m.horizontal=h.horizontal),h.textRotation!=null&&(m.textRotation=h.textRotation),h.indent&&(m.indent=h.indent),h.wrapText&&(m.wrapText=Sr(h.wrapText)),n.alignment=m;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+h[0]+" in cellXfs")}})}function Bp(e){var r=[];return r[r.length]=rt("cellXfs",null),e.forEach(function(t){r[r.length]=rt("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=rt("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var Lp=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,c=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,m,g){var v={};if(!d)return v;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var _;return(_=d.match(r))&&Rp(_,v,g),(_=d.match(s))&&Op(_,v,m,g),(_=d.match(n))&&Fp(_,v,m,g),(_=d.match(c))&&Dp(_,v,m,g),(_=d.match(t))&&Pp(_,v,g),v}}();function tu(e,r){var t=[Kr,rt("styleSheet",null,{xmlns:fs[0],"xmlns:vt":sa.vt})],n;return e.SSF&&(n=Mp(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Bp(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function jp(e,r){var t=e.read_shift(2),n=ka(e);return[t,n]}function Up(e,r,t){t||(t=Oe(6+4*r.length)),t.write_shift(2,e),xa(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function Wp(e,r,t){var n={};n.sz=e.read_shift(2)/20;var s=_g(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var c=e.read_shift(2);switch(c===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var h=e.read_shift(1);h!=0&&(n.underline=h);var d=e.read_shift(1);d>0&&(n.family=d);var m=e.read_shift(1);switch(m>0&&(n.charset=m),e.l++,n.color=Eg(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ka(e),n}function Vp(e,r){r||(r=Oe(25+4*32)),r.write_shift(2,e.sz*20),Ag(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),qo(e.color,r);var n=0;return n=2,r.write_shift(1,n),xa(e.name,r),r.length>r.l?r.slice(0,r.l):r}var Hp=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Lc,Gp=Ia;function a1(e,r){r||(r=Oe(4*3+8*7+16*1)),Lc||(Lc=sc(Hp));var t=Lc[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(qo({auto:1},r),qo({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function Xp(e,r){var t=e.l+r,n=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:s}}function ru(e,r,t){t||(t=Oe(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function m0(e,r){return r||(r=Oe(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var zp=Ia;function Yp(e,r){return r||(r=Oe(51)),r.write_shift(1,0),m0(null,r),m0(null,r),m0(null,r),m0(null,r),m0(null,r),r.length>r.l?r.slice(0,r.l):r}function Kp(e,r){return r||(r=Oe(12+4*10)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),Ko(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function qp(e,r,t){var n=Oe(2052);return n.write_shift(4,e),Ko(r,n),Ko(t,n),n.length>n.l?n.slice(0,n.l):n}function Zp(e,r,t){var n={};n.NumberFmt=[];for(var s in bt)n.NumberFmt[s]=bt[s];n.CellXf=[],n.Fonts=[];var c=[],h=!1;return xi(e,function(m,g,v){switch(v){case 44:n.NumberFmt[m[0]]=m[1],fi(m[1],m[0]);break;case 43:n.Fonts.push(m),m.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(m.color.rgb=Qo(r.themeElements.clrScheme[m.color.theme].rgb,m.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:c[c.length-1]==617&&n.CellXf.push(m);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:h=!0;break;case 36:h=!1;break;case 37:c.push(v),h=!0;break;case 38:c.pop(),h=!1;break;default:if(g.T>0)c.push(v);else if(g.T<0)c.pop();else if(!h||t.WTF&&c[c.length-1]!=37)throw new Error("Unexpected record 0x"+v.toString(16))}}),n}function Jp(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&++t}),t!=0&&(Ve(e,615,kn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&Ve(e,44,Up(s,r[s]))}),Ve(e,616))}}function Qp(e){var r=1;Ve(e,611,kn(r)),Ve(e,43,Vp({sz:12,color:{theme:1},name:"Calibri",family:2})),Ve(e,612)}function $p(e){var r=2;Ve(e,603,kn(r)),Ve(e,45,a1({patternType:"none"})),Ve(e,45,a1({patternType:"gray125"})),Ve(e,604)}function ew(e){var r=1;Ve(e,613,kn(r)),Ve(e,46,Yp()),Ve(e,614)}function tw(e){var r=1;Ve(e,626,kn(r)),Ve(e,47,ru({numFmtId:0},65535)),Ve(e,627)}function rw(e,r){Ve(e,617,kn(r.length)),r.forEach(function(t){Ve(e,47,ru(t,0))}),Ve(e,618)}function aw(e){var r=1;Ve(e,619,kn(r)),Ve(e,48,Kp({xfId:0,name:"Normal"})),Ve(e,620)}function nw(e){var r=0;Ve(e,505,kn(r)),Ve(e,506)}function iw(e){var r=0;Ve(e,508,qp(r,"TableStyleMedium9","PivotStyleMedium4")),Ve(e,509)}function sw(e,r){var t=Va();return Ve(t,278),Jp(t,e.SSF),Qp(t),$p(t),ew(t),tw(t),rw(t,r.cellXfs),aw(t),nw(t),iw(t),Ve(t,279),t.end()}var ow=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function cw(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(Da)||[]).forEach(function(s){var c=Tt(s);switch(c[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=c.val;break;case"<a:sysClr":n.rgb=c.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":c[0].charAt(1)==="/"?(r.themeElements.clrScheme[ow.indexOf(c[0])]=n,n={}):n.name=c[0].slice(3,c[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+c[0]+" in clrScheme")}})}function lw(){}function fw(){}var hw=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,uw=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,dw=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function xw(e,r,t){r.themeElements={};var n;[["clrScheme",hw,cw],["fontScheme",uw,lw],["fmtScheme",dw,fw]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,r,t)})}var gw=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function au(e,r){(!e||e.length===0)&&(e=Ol());var t,n={};if(!(t=e.match(gw)))throw new Error("themeElements not found in theme");return xw(t[0],n,r),n.raw=e,n}function Ol(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Kr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function mw(e,r,t){var n=e.l+r,s=e.read_shift(4);if(s!==124226){if(!t.cellStyles){e.l=n;return}var c=e.slice(e.l);e.l=n;var h;try{h=q1(c,{type:"array"})}catch{return}var d=$a(h,"theme/theme/theme1.xml",!0);if(d)return au(d,t)}}function pw(e){return e.read_shift(4)}function ww(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=vw(e,4);break;case 2:r.xclrValue=Ph(e);break;case 3:r.xclrValue=pw(e);break;case 4:e.l+=4;break}return e.l+=8,r}function vw(e,r){return Ia(e,r)}function yw(e,r){return Ia(e,r)}function Ew(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=ww(e);break;case 6:n[1]=yw(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function _w(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),c=[];s-- >0;)c.push(Ew(e,t-e.l));return{ixfe:n,ext:c}}function Aw(e,r){r.forEach(function(t){switch(t[0]){}})}function bw(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:ka(e)}}function Cw(e){var r=Oe(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),xa(e.name,r),r.slice(0,r.l)}function Sw(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Tw(e){var r=Oe(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function Nw(e,r){var t=Oe(8+2*r.length);return t.write_shift(4,e),xa(r,t),t.slice(0,t.l)}function kw(e){return e.l+=4,e.read_shift(4)!=0}function Iw(e,r){var t=Oe(8);return t.write_shift(4,e),t.write_shift(4,1),t}function Dw(e,r,t){var n={Types:[],Cell:[],Value:[]},s=t||{},c=[],h=!1,d=2;return xi(e,function(m,g,v){switch(v){case 335:n.Types.push({name:m.name});break;case 51:m.forEach(function(_){d==1?n.Cell.push({type:n.Types[_[0]-1].name,index:_[1]}):d==0&&n.Value.push({type:n.Types[_[0]-1].name,index:_[1]})});break;case 337:d=m?1:0;break;case 338:d=2;break;case 35:c.push(v),h=!0;break;case 36:c.pop(),h=!1;break;default:if(!g.T){if(!h||s.WTF&&c[c.length-1]!=35)throw new Error("Unexpected record 0x"+v.toString(16))}}}),n}function Fw(){var e=Va();return Ve(e,332),Ve(e,334,kn(1)),Ve(e,335,Cw({name:"XLDAPR",version:12e4,flags:3496657072})),Ve(e,336),Ve(e,339,Nw(1,"XLDAPR")),Ve(e,52),Ve(e,35,kn(514)),Ve(e,4096,kn(0)),Ve(e,4097,xn(1)),Ve(e,36),Ve(e,53),Ve(e,340),Ve(e,337,Iw(1)),Ve(e,51,Tw([[1,0]])),Ve(e,338),Ve(e,333),e.end()}function Ow(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,c=2,h;return e.replace(Da,function(d){var m=Tt(d);switch(Hn(m[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:m.name});break;case"</metadataType>":break;case"<futureMetadata":for(var g=0;g<n.Types.length;++g)n.Types[g].name==m.name&&(h=n.Types[g]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":c==1?n.Cell.push({type:n.Types[m.t-1].name,index:+m.v}):c==0&&n.Value.push({type:n.Types[m.t-1].name,index:+m.v});break;case"</rc>":break;case"<cellMetadata":c=1;break;case"</cellMetadata>":c=2;break;case"<valueMetadata":c=0;break;case"</valueMetadata>":c=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!h)break;h.offsets||(h.offsets=[]),h.offsets.push(+m.i);break;default:if(!s&&t.WTF)throw new Error("unrecognized "+m[0]+" in metadata")}return d}),n}function nu(){var e=[Kr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Rw(e){var r=[];if(!e)return r;var t=1;return(e.match(Da)||[]).forEach(function(n){var s=Tt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,r.push(s);break}}),r}function Mw(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=St(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function Pw(e,r,t){var n=[];return xi(e,function(c,h,d){switch(d){case 63:n.push(c);break;default:if(!h.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function Bw(e,r,t,n){if(!e)return e;var s=n||{},c=!1;xi(e,function(d,m,g){switch(g){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:c=!0;break;case 36:c=!1;break;default:if(!m.T){if(!c||s.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}},s)}function Lw(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}var Bs=1024;function iu(e,r){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[rt("xml",null,{"xmlns:v":Za.v,"xmlns:o":Za.o,"xmlns:x":Za.x,"xmlns:mv":Za.mv}).replace(/\/>/,">"),rt("o:shapelayout",rt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),rt("v:shapetype",[rt("v:stroke",null,{joinstyle:"miter"}),rt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Bs<e*1e3;)Bs+=1e3;return r.forEach(function(c){var h=Lr(c[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var m=d.type=="gradient"?rt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,g=rt("v:fill",m,d),v={on:"t",obscured:"t"};++Bs,s=s.concat(["<v:shape"+F0({id:"_x0000_s"+Bs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",g,rt("v:shadow",null,v),rt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",va("x:Anchor",[h.c+1,0,h.r+1,0,h.c+3,20,h.r+5,20].join(",")),va("x:AutoFill","False"),va("x:Row",String(h.r)),va("x:Column",String(h.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function n1(e,r,t,n){var s=Array.isArray(e),c;r.forEach(function(h){var d=Lr(h.ref);if(s?(e[d.r]||(e[d.r]=[]),c=e[d.r][d.c]):c=e[h.ref],!c){c={t:"z"},s?e[d.r][d.c]=c:e[h.ref]=c;var m=ar(e["!ref"]||"BDWGO1000001:A1");m.s.r>d.r&&(m.s.r=d.r),m.e.r<d.r&&(m.e.r=d.r),m.s.c>d.c&&(m.s.c=d.c),m.e.c<d.c&&(m.e.c=d.c);var g=Bt(m);g!==e["!ref"]&&(e["!ref"]=g)}c.c||(c.c=[]);var v={a:h.author,t:h.t,r:h.r,T:t};h.h&&(v.h=h.h);for(var _=c.c.length-1;_>=0;--_){if(!t&&c.c[_].T)return;t&&!c.c[_].T&&c.c.splice(_,1)}if(t&&n){for(_=0;_<n.length;++_)if(v.a==n[_].id){v.a=n[_].name||v.a;break}}c.c.push(v)})}function jw(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(h){if(!(h===""||h.trim()==="")){var d=h.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&t.push(d[1])}});var c=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return c&&c[1]&&c[1].split(/<\/\w*:?comment>/).forEach(function(h){if(!(h===""||h.trim()==="")){var d=h.match(/<(?:\w+:)?comment[^>]*>/);if(d){var m=Tt(d[0]),g={author:m.authorId&&t[m.authorId]||"sheetjsghost",ref:m.ref,guid:m.guid},v=Lr(m.ref);if(!(r.sheetRows&&r.sheetRows<=v.r)){var _=h.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),S=!!_&&!!_[1]&&Il(_[1])||{r:"",t:"",h:""};g.r=S.r,S.r=="<t></t>"&&(S.t=S.h=""),g.t=(S.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(g.h=S.h),n.push(g)}}}}),n}function su(e){var r=[Kr,rt("comments",null,{xmlns:fs[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var c=mr(s.a);t.indexOf(c)==-1&&(t.push(c),r.push("<author>"+c+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),r.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var s=0,c=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(m){m.a&&(s=t.indexOf(mr(m.a))),c.push(m.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),c.length<=1)r.push(va("t",mr(c[0]||"")));else{for(var h=`Comment:
    `+c[0]+`
`,d=1;d<c.length;++d)h+=`Reply:
    `+c[d]+`
`;r.push(va("t",mr(h)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Uw(e,r){var t=[],n=!1,s={},c=0;return e.replace(Da,function(d,m){var g=Tt(d);switch(Hn(g[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:g.personId,guid:g.id,ref:g.ref,T:1};break;case"</threadedComment>":s.t!=null&&t.push(s);break;case"<text>":case"<text":c=m+d.length;break;case"</text>":s.t=e.slice(c,m).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+g[0]+" in threaded comments")}return d}),t}function Ww(e,r,t){var n=[Kr,rt("ThreadedComments",null,{xmlns:sa.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var c="";(s[1]||[]).forEach(function(h,d){if(!h.T){delete h.ID;return}h.a&&r.indexOf(h.a)==-1&&r.push(h.a);var m={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};d==0?c=m.id:m.parentId=c,h.ID=m.id,h.a&&(m.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(h.a)).slice(-12)+"}"),n.push(rt("threadedComment",va("text",h.t||""),m))})}),n.push("</ThreadedComments>"),n.join("")}function Vw(e,r){var t=[],n=!1;return e.replace(Da,function(c){var h=Tt(c);switch(Hn(h[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:h.displayname,id:h.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),t}function Hw(e){var r=[Kr,rt("personList",null,{xmlns:sa.TCMNT,"xmlns:x":fs[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(rt("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function Gw(e){var r={};r.iauthor=e.read_shift(4);var t=xs(e);return r.rfx=t.s,r.ref=St(t.s),e.l+=16,r}function Xw(e,r){return r==null&&(r=Oe(36)),r.write_shift(4,e[1].iauthor),qs(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var zw=ka;function Yw(e){return xa(e.slice(0,54))}function Kw(e,r){var t=[],n=[],s={},c=!1;return xi(e,function(d,m,g){switch(g){case 632:n.push(d);break;case 635:s=d;break;case 637:s.t=d.t,s.h=d.h,s.r=d.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,r.sheetRows&&s.rfx&&r.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!m.T){if(!c||r.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}),t}function qw(e){var r=Va(),t=[];return Ve(r,628),Ve(r,630),e.forEach(function(n){n[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),Ve(r,632,Yw(s.a)))})}),Ve(r,631),Ve(r,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var c={s:Lr(n[0]),e:Lr(n[0])};Ve(r,635,Xw([c,s])),s.t&&s.t.length>0&&Ve(r,637,pg(s)),Ve(r,636),delete s.iauthor})}),Ve(r,634),Ve(r,629),r.end()}var Zw="application/vnd.ms-office.vbaProject";function Jw(e){var r=gt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");gt.utils.cfb_add(r,s,e.FileIndex[n].content)}}),gt.write(r)}function Qw(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&gt.utils.cfb_add(e,s,r.FileIndex[n].content)}})}var ou=["xlsb","xlsm","xlam","biff8","xla"];function $w(){return{"!type":"dialog"}}function ev(){return{"!type":"dialog"}}function tv(){return{"!type":"macro"}}function rv(){return{"!type":"macro"}}var Ws=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,s,c,h){var d=!1,m=!1;c.length==0?m=!0:c.charAt(0)=="["&&(m=!0,c=c.slice(1,-1)),h.length==0?d=!0:h.charAt(0)=="["&&(d=!0,h=h.slice(1,-1));var g=c.length>0?parseInt(c,10)|0:0,v=h.length>0?parseInt(h,10)|0:0;return d?v+=r.c:--v,m?g+=r.r:--g,s+(d?"":"$")+Br(v)+(m?"":"$")+Yr(g)}return function(s,c){return r=c,s.replace(e,t)}}(),Rl=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ml=function(){return function(r,t){return r.replace(Rl,function(n,s,c,h,d,m){var g=El(h)-(c?0:t.c),v=yl(m)-(d?0:t.r),_=v==0?"":d?v+1:"["+v+"]",S=g==0?"":c?g+1:"["+g+"]";return s+"R"+_+"C"+S})}}();function cu(e,r){return e.replace(Rl,function(t,n,s,c,h,d){return n+(s=="$"?s+c:Br(El(c)+r.c))+(h=="$"?h+d:Yr(yl(d)+r.r))})}function av(e,r,t){var n=Ha(r),s=n.s,c=Lr(t),h={r:c.r-s.r,c:c.c-s.c};return cu(e,h)}function nv(e){return e.length!=1}function i1(e){return e.replace(/_xlfn\./g,"")}function ea(e){e.l+=1}function Ri(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function lu(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return fu(e);t.biff==12&&(n=4)}var s=e.read_shift(n),c=e.read_shift(n),h=Ri(e),d=Ri(e);return{s:{r:s,c:h[0],cRel:h[1],rRel:h[2]},e:{r:c,c:d[0],cRel:d[1],rRel:d[2]}}}function fu(e){var r=Ri(e),t=Ri(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function iv(e,r,t){if(t.biff<8)return fu(e);var n=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),c=Ri(e),h=Ri(e);return{s:{r:n,c:c[0],cRel:c[1],rRel:c[2]},e:{r:s,c:h[0],cRel:h[1],rRel:h[2]}}}function hu(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return sv(e);var n=e.read_shift(t&&t.biff==12?4:2),s=Ri(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function sv(e){var r=Ri(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function ov(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function cv(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return lv(e);var s=e.read_shift(n>=12?4:2),c=e.read_shift(2),h=(c&16384)>>14,d=(c&32768)>>15;if(c&=16383,d==1)for(;s>524287;)s-=1048576;if(h==1)for(;c>8191;)c=c-16384;return{r:s,c,cRel:h,rRel:d}}function lv(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,s=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),s==1&&t>=128&&(t=t-256),{r,c:t,cRel:s,rRel:n}}function fv(e,r,t){var n=(e[e.l++]&96)>>5,s=lu(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,s]}function hv(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}var h=lu(e,c,t);return[n,s,h]}function uv(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function dv(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}return e.l+=c,[n,s]}function xv(e,r,t){var n=(e[e.l++]&96)>>5,s=iv(e,r-1,t);return[n,s]}function gv(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function s1(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function mv(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),s=[],c=0;c<=n;++c)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function pv(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function wv(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function vv(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function yv(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function uu(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function Ev(e){return e.read_shift(2),uu(e)}function _v(e){return e.read_shift(2),uu(e)}function Av(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=hu(e,0,t);return[n,s]}function bv(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=cv(e,0,t);return[n,s]}function Cv(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var c=hu(e,0,t);return[n,s,c]}function Sv(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[k3[s],gu[s],n]}function Tv(e,r,t){var n=e[e.l++],s=e.read_shift(1),c=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:Nv(e);return[s,(c[0]===0?gu:N3)[c[1]]]}function Nv(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function kv(e,r,t){e.l+=t&&t.biff==2?3:4}function Iv(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function Dv(e){return e.l++,gi[e.read_shift(1)]}function Fv(e){return e.l++,e.read_shift(2)}function Ov(e){return e.l++,e.read_shift(1)!==0}function Rv(e){return e.l++,Na(e)}function Mv(e,r,t){return e.l++,G0(e,r-1,t)}function Pv(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=zr(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=gi[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Na(e);break;case 2:t[1]=gs(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Bv(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),s=[],c=0;c!=n;++c)s.push((t.biff==12?xs:lc)(e));return s}function Lv(e,r,t){var n=0,s=0;t.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--s==0&&(s=256));for(var c=0,h=[];c!=n&&(h[c]=[]);++c)for(var d=0;d!=s;++d)h[c][d]=Pv(e,t.biff);return h}function jv(e,r,t){var n=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,c=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,c]}function Uv(e,r,t){if(t.biff==5)return Wv(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),c=e.read_shift(4);return[n,s,c]}function Wv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function Vv(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function Hv(e,r,t){var n=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function Gv(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function Xv(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),c=4;if(t)switch(t.biff){case 5:c=15;break;case 12:c=6;break}return e.l+=c,[n,s]}var zv=Ia,Yv=Ia,Kv=Ia;function z0(e,r,t){return e.l+=2,[ov(e)]}function Pl(e){return e.l+=6,[]}var qv=z0,Zv=Pl,Jv=Pl,Qv=z0;function du(e){return e.l+=2,[ra(e),e.read_shift(2)&1]}var $v=z0,e3=du,t3=Pl,r3=z0,a3=z0,n3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function i3(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),c=e.read_shift(2),h=n3[t>>2&31];return{ixti:r,coltype:t&3,rt:h,idx:n,c:s,C:c}}function s3(e){return e.l+=2,[e.read_shift(4)]}function o3(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function c3(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function l3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function f3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function h3(e){return e.l+=4,[0,0]}var o1={1:{n:"PtgExp",f:Iv},2:{n:"PtgTbl",f:Kv},3:{n:"PtgAdd",f:ea},4:{n:"PtgSub",f:ea},5:{n:"PtgMul",f:ea},6:{n:"PtgDiv",f:ea},7:{n:"PtgPower",f:ea},8:{n:"PtgConcat",f:ea},9:{n:"PtgLt",f:ea},10:{n:"PtgLe",f:ea},11:{n:"PtgEq",f:ea},12:{n:"PtgGe",f:ea},13:{n:"PtgGt",f:ea},14:{n:"PtgNe",f:ea},15:{n:"PtgIsect",f:ea},16:{n:"PtgUnion",f:ea},17:{n:"PtgRange",f:ea},18:{n:"PtgUplus",f:ea},19:{n:"PtgUminus",f:ea},20:{n:"PtgPercent",f:ea},21:{n:"PtgParen",f:ea},22:{n:"PtgMissArg",f:ea},23:{n:"PtgStr",f:Mv},26:{n:"PtgSheet",f:o3},27:{n:"PtgEndSheet",f:c3},28:{n:"PtgErr",f:Dv},29:{n:"PtgBool",f:Ov},30:{n:"PtgInt",f:Fv},31:{n:"PtgNum",f:Rv},32:{n:"PtgArray",f:gv},33:{n:"PtgFunc",f:Sv},34:{n:"PtgFuncVar",f:Tv},35:{n:"PtgName",f:jv},36:{n:"PtgRef",f:Av},37:{n:"PtgArea",f:fv},38:{n:"PtgMemArea",f:Vv},39:{n:"PtgMemErr",f:zv},40:{n:"PtgMemNoMem",f:Yv},41:{n:"PtgMemFunc",f:Hv},42:{n:"PtgRefErr",f:Gv},43:{n:"PtgAreaErr",f:uv},44:{n:"PtgRefN",f:bv},45:{n:"PtgAreaN",f:xv},46:{n:"PtgMemAreaN",f:l3},47:{n:"PtgMemNoMemN",f:f3},57:{n:"PtgNameX",f:Uv},58:{n:"PtgRef3d",f:Cv},59:{n:"PtgArea3d",f:hv},60:{n:"PtgRefErr3d",f:Xv},61:{n:"PtgAreaErr3d",f:dv},255:{}},u3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},d3={1:{n:"PtgElfLel",f:du},2:{n:"PtgElfRw",f:r3},3:{n:"PtgElfCol",f:qv},6:{n:"PtgElfRwV",f:a3},7:{n:"PtgElfColV",f:Qv},10:{n:"PtgElfRadical",f:$v},11:{n:"PtgElfRadicalS",f:t3},13:{n:"PtgElfColS",f:Zv},15:{n:"PtgElfColSV",f:Jv},16:{n:"PtgElfRadicalLel",f:e3},25:{n:"PtgList",f:i3},29:{n:"PtgSxName",f:s3},255:{}},x3={0:{n:"PtgAttrNoop",f:h3},1:{n:"PtgAttrSemi",f:yv},2:{n:"PtgAttrIf",f:wv},4:{n:"PtgAttrChoose",f:mv},8:{n:"PtgAttrGoto",f:pv},16:{n:"PtgAttrSum",f:kv},32:{n:"PtgAttrBaxcel",f:s1},33:{n:"PtgAttrBaxcel",f:s1},64:{n:"PtgAttrSpace",f:Ev},65:{n:"PtgAttrSpaceSemi",f:_v},128:{n:"PtgAttrIfError",f:vv},255:{}};function Y0(e,r,t,n){if(n.biff<8)return Ia(e,r);for(var s=e.l+r,c=[],h=0;h!==t.length;++h)switch(t[h][0]){case"PtgArray":t[h][1]=Lv(e,0,n),c.push(t[h][1]);break;case"PtgMemArea":t[h][2]=Bv(e,t[h][1],n),c.push(t[h][2]);break;case"PtgExp":n&&n.biff==12&&(t[h][1][1]=e.read_shift(4),c.push(t[h][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[h][0]}return r=s-e.l,r!==0&&c.push(Ia(e,r)),c}function K0(e,r,t){for(var n=e.l+r,s,c,h=[];n!=e.l;)r=n-e.l,c=e[e.l],s=o1[c]||o1[u3[c]],(c===24||c===25)&&(s=(c===24?d3:x3)[e[e.l+1]]),!s||!s.f?Ia(e,r):h.push([s.n,s.f(e,r,t)]);return h}function g3(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],s=[],c=0;c<n.length;++c){var h=n[c];if(h)switch(h[0]){case 2:s.push('"'+h[1].replace(/"/g,'""')+'"');break;default:s.push(h[1])}else s.push("")}r.push(s.join(","))}return r.join(";")}var m3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function p3(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function xu(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function c1(e,r,t){var n=xu(e,r,t);return n=="#REF"?n:p3(n,t)}function Sa(e,r,t,n,s){var c=s&&s.biff||8,h={s:{c:0,r:0}},d=[],m,g,v,_=0,S=0,T,N="";if(!e[0]||!e[0][0])return"";for(var C=-1,D="",U=0,X=e[0].length;U<X;++U){var O=e[0][U];switch(O[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=d.pop(),g=d.pop(),C>=0){switch(e[0][C][1][0]){case 0:D=Wr(" ",e[0][C][1][1]);break;case 1:D=Wr("\r",e[0][C][1][1]);break;default:if(D="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][C][1][0])}g=g+D,C=-1}d.push(g+m3[O[0]]+m);break;case"PtgIsect":m=d.pop(),g=d.pop(),d.push(g+" "+m);break;case"PtgUnion":m=d.pop(),g=d.pop(),d.push(g+","+m);break;case"PtgRange":m=d.pop(),g=d.pop(),d.push(g+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":v=E0(O[1][1],h,s),d.push(_0(v,c));break;case"PtgRefN":v=t?E0(O[1][1],t,s):O[1][1],d.push(_0(v,c));break;case"PtgRef3d":_=O[1][1],v=E0(O[1][2],h,s),N=c1(n,_,s),d.push(N+"!"+_0(v,c));break;case"PtgFunc":case"PtgFuncVar":var q=O[1][0],oe=O[1][1];q||(q=0),q&=127;var J=q==0?[]:d.slice(-q);d.length-=q,oe==="User"&&(oe=J.shift()),d.push(oe+"("+J.join(",")+")");break;case"PtgBool":d.push(O[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(O[1]);break;case"PtgNum":d.push(String(O[1]));break;case"PtgStr":d.push('"'+O[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(O[1]);break;case"PtgAreaN":T=Bf(O[1][1],t?{s:t}:h,s),d.push(Rc(T,s));break;case"PtgArea":T=Bf(O[1][1],h,s),d.push(Rc(T,s));break;case"PtgArea3d":_=O[1][1],T=O[1][2],N=c1(n,_,s),d.push(N+"!"+Rc(T,s));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":S=O[1][2];var M=(n.names||[])[S-1]||(n[0]||[])[S],ie=M?M.Name:"SH33TJSNAME"+String(S);ie&&ie.slice(0,6)=="_xlfn."&&!s.xlfn&&(ie=ie.slice(6)),d.push(ie);break;case"PtgNameX":var j=O[1][1];S=O[1][2];var _e;if(s.biff<=5)j<0&&(j=-j),n[j]&&(_e=n[j][S]);else{var he="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][S]&&n[j][S].itab>0&&(he=n.SheetNames[n[j][S].itab-1]+"!"):he=n.SheetNames[S-1]+"!"),n[j]&&n[j][S])he+=n[j][S].Name;else if(n[0]&&n[0][S])he+=n[0][S].Name;else{var te=(xu(n,j,s)||"").split(";;");te[S-1]?he=te[S-1]:he+="SH33TJSERRX"}d.push(he);break}_e||(_e={Name:"SH33TJSERRY"}),d.push(_e.Name);break;case"PtgParen":var be="(",$e=")";if(C>=0){switch(D="",e[0][C][1][0]){case 2:be=Wr(" ",e[0][C][1][1])+be;break;case 3:be=Wr("\r",e[0][C][1][1])+be;break;case 4:$e=Wr(" ",e[0][C][1][1])+$e;break;case 5:$e=Wr("\r",e[0][C][1][1])+$e;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][C][1][0])}C=-1}d.push(be+d.pop()+$e);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":v={c:O[1][1],r:O[1][0]};var ae={c:t.c,r:t.r};if(n.sharedf[St(v)]){var tt=n.sharedf[St(v)];d.push(Sa(tt,h,ae,n,s))}else{var Re=!1;for(m=0;m!=n.arrayf.length;++m)if(g=n.arrayf[m],!(v.c<g[0].s.c||v.c>g[0].e.c)&&!(v.r<g[0].s.r||v.r>g[0].e.r)){d.push(Sa(g[1],h,ae,n,s)),Re=!0;break}Re||d.push(O[1])}break;case"PtgArray":d.push("{"+g3(O[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":C=U;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+O[1].idx+"[#"+O[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(O));default:throw new Error("Unrecognized Formula Token: "+String(O))}var Lt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&C>=0&&Lt.indexOf(e[0][U][0])==-1){O=e[0][C];var fe=!0;switch(O[1][0]){case 4:fe=!1;case 0:D=Wr(" ",O[1][1]);break;case 5:fe=!1;case 1:D=Wr("\r",O[1][1]);break;default:if(D="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+O[1][0])}d.push((fe?D:"")+d.pop()+(fe?"":D)),C=-1}}if(d.length>1&&s.WTF)throw new Error("bad formula stack");return d[0]}function w3(e,r,t){var n=e.l+r,s=t.biff==2?1:2,c,h=e.read_shift(s);if(h==65535)return[[],Ia(e,r-2)];var d=K0(e,h,t);return r!==h+s&&(c=Y0(e,r-h-s,d,t)),e.l=n,[d,c]}function v3(e,r,t){var n=e.l+r,s=t.biff==2?1:2,c,h=e.read_shift(s);if(h==65535)return[[],Ia(e,r-2)];var d=K0(e,h,t);return r!==h+s&&(c=Y0(e,r-h-s,d,t)),e.l=n,[d,c]}function y3(e,r,t,n){var s=e.l+r,c=K0(e,n,t),h;return s!==e.l&&(h=Y0(e,s-e.l,c,t)),[c,h]}function E3(e,r,t){var n=e.l+r,s,c=e.read_shift(2),h=K0(e,c,t);return c==65535?[[],Ia(e,r-2)]:(r!==c+2&&(s=Y0(e,n-c-2,h,t)),[h,s])}function _3(e){var r;if(ci(e,e.l+6)!==65535)return[Na(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function A3(e){if(e==null){var r=Oe(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return is(e);return is(0)}function jc(e,r,t){var n=e.l+r,s=Gn(e);t.biff==2&&++e.l;var c=_3(e),h=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var d=v3(e,n-e.l,t);return{cell:s,val:c[0],formula:d,shared:h>>3&1,tt:c[1]}}function b3(e,r,t,n,s){var c=os(r,t,s),h=A3(e.v),d=Oe(6),m=33;d.write_shift(2,m),d.write_shift(4,0);for(var g=Oe(e.bf.length),v=0;v<e.bf.length;++v)g[v]=e.bf[v];var _=da([c,h,d,g]);return _}function fc(e,r,t){var n=e.read_shift(4),s=K0(e,n,t),c=e.read_shift(4),h=c>0?Y0(e,c,s,t):null;return[s,h]}var C3=fc,hc=fc,S3=fc,T3=fc,N3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},gu={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},k3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function l1(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function I3(e){var r="of:="+e.replace(Rl,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function Uc(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function D3(e){return e.replace(/\./,"!")}var b0={},Vs={},C0=typeof Map<"u";function Bl(e,r,t){var n=0,s=e.length;if(t){if(C0?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var c=C0?t.get(r):t[r];n<c.length;++n)if(e[c[n]].t===r)return e.Count++,c[n]}}else for(;n<s;++n)if(e[n].t===r)return e.Count++,n;return e[s]={t:r},e.Count++,e.Unique++,t&&(C0?(t.has(r)||t.set(r,[]),t.get(r).push(s)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(s))),s}function uc(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(Ta=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=B0(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=$o(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function rs(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Li(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],s=60,c=e.length;if(n==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){fi(r.z,s),t.ssf[s]=r.z,t.revssf[r.z]=n=s;break}}for(s=0;s!=c;++s)if(e[s].numFmtId===n)return s;return e[c]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function mu(e,r,t,n,s,c){try{n.cellNF&&(e.z=bt[r])}catch(d){if(n.WTF)throw d}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Tr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(bt[r]==null&&fi(Nx[r]||"General",r),e.t==="e")e.w=e.w||gi[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=I0(e.v);else if(e.t==="d"){var h=oa(e.v);(h|0)===h?e.w=h.toString(10):e.w=I0(h)}else{if(e.v===void 0)return"";e.w=as(e.v,Vs)}else e.t==="d"?e.w=mn(r,oa(e.v),Vs):e.w=mn(r,e.v,Vs)}catch(d){if(n.WTF)throw d}if(n.cellStyles&&t!=null)try{e.s=c.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Qo(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Qo(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(n.WTF&&c.Fills)throw d}}}function F3(e,r,t){if(e&&e["!ref"]){var n=ar(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function O3(e,r){var t=ar(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Bt(t))}var R3=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,M3=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,P3=/<(?:\w:)?hyperlink [^>]*>/mg,B3=/"(\w*:\w*)"/,L3=/<(?:\w:)?col\b[^>]*[\/]?>/g,j3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,U3=/<(?:\w:)?pageMargins[^>]*\/>/g,pu=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,W3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,V3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function H3(e,r,t,n,s,c,h){if(!e)return e;n||(n={"!id":{}});var d=r.dense?[]:{},m={s:{r:2e6,c:2e6},e:{r:0,c:0}},g="",v="",_=e.match(M3);_?(g=e.slice(0,_.index),v=e.slice(_.index+_[0].length)):g=v=e;var S=g.match(pu);S?Ll(S[0],d,s,t):(S=g.match(W3))&&X3(S[0],S[1]||"",d,s,t);var T=(g.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var N=g.slice(T,T+50).match(B3);N&&O3(d,N[1])}var C=g.match(V3);C&&C[1]&&ny(C[1],s);var D=[];if(r.cellStyles){var U=g.match(L3);U&&$3(D,U)}_&&oy(_[1],d,r,m,c,h);var X=v.match(j3);X&&(d["!autofilter"]=ty(X[0]));var O=[],q=v.match(R3);if(q)for(T=0;T!=q.length;++T)O[T]=ar(q[T].slice(q[T].indexOf('"')+1));var oe=v.match(P3);oe&&Z3(d,oe,n);var J=v.match(U3);if(J&&(d["!margins"]=J3(Tt(J[0]))),!d["!ref"]&&m.e.c>=m.s.c&&m.e.r>=m.s.r&&(d["!ref"]=Bt(m)),r.sheetRows>0&&d["!ref"]){var M=ar(d["!ref"]);r.sheetRows<=+M.e.r&&(M.e.r=r.sheetRows-1,M.e.r>m.e.r&&(M.e.r=m.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>m.e.c&&(M.e.c=m.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Bt(M))}return D.length>0&&(d["!cols"]=D),O.length>0&&(d["!merges"]=O),d}function G3(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Bt(e[t])+'"/>';return r+"</mergeCells>"}function Ll(e,r,t,n){var s=Tt(e);t.Sheets[n]||(t.Sheets[n]={}),s.codeName&&(t.Sheets[n].CodeName=rr(vr(s.codeName)))}function X3(e,r,t,n,s){Ll(e.slice(0,e.indexOf(">")),t,n,s)}function z3(e,r,t,n,s){var c=!1,h={},d=null;if(n.bookType!=="xlsx"&&r.vbaraw){var m=r.SheetNames[t];try{r.Workbook&&(m=r.Workbook.Sheets[t].CodeName||m)}catch{}c=!0,h.codeName=Vn(mr(m))}if(e&&e["!outline"]){var g={summaryBelow:1,summaryRight:1};e["!outline"].above&&(g.summaryBelow=0),e["!outline"].left&&(g.summaryRight=0),d=(d||"")+rt("outlinePr",null,g)}!c&&!d||(s[s.length]=rt("sheetPr",d,h))}var Y3=["objects","scenarios","selectLockedCells","selectUnlockedCells"],K3=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function q3(e){var r={sheet:1};return Y3.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),K3.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=Dl(e.password).toString(16).toUpperCase()),rt("sheetProtection",null,r)}function Z3(e,r,t){for(var n=Array.isArray(e),s=0;s!=r.length;++s){var c=Tt(vr(r[s]),!0);if(!c.ref)return;var h=((t||{})["!id"]||[])[c.id];h?(c.Target=h.Target,c.location&&(c.Target+="#"+rr(c.location))):(c.Target="#"+rr(c.location),h={Target:c.Target,TargetMode:"Internal"}),c.Rel=h,c.tooltip&&(c.Tooltip=c.tooltip,delete c.tooltip);for(var d=ar(c.ref),m=d.s.r;m<=d.e.r;++m)for(var g=d.s.c;g<=d.e.c;++g){var v=St({c:g,r:m});n?(e[m]||(e[m]=[]),e[m][g]||(e[m][g]={t:"z",v:void 0}),e[m][g].l=c):(e[v]||(e[v]={t:"z",v:void 0}),e[v].l=c)}}}function J3(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function Q3(e){return rs(e),rt("pageMargins",null,e)}function $3(e,r){for(var t=!1,n=0;n!=r.length;++n){var s=Tt(r[n],!0);s.hidden&&(s.hidden=Sr(s.hidden));var c=parseInt(s.min,10)-1,h=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,Fl(s.width)),Oi(s);c<=h;)e[c++]=Nr(s)}}function ey(e,r){for(var t=["<cols>"],n,s=0;s!=r.length;++s)(n=r[s])&&(t[t.length]=rt("col",null,uc(s,n)));return t[t.length]="</cols>",t.join("")}function ty(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}function ry(e,r,t,n){var s=typeof e.ref=="string"?e.ref:Bt(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var c=t.Workbook.Names,h=Ha(s);h.s.r==h.e.r&&(h.e.r=Ha(r["!ref"]).e.r,s=Bt(h));for(var d=0;d<c.length;++d){var m=c[d];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==n){m.Ref="'"+t.SheetNames[n]+"'!"+s;break}}return d==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),rt("autoFilter",null,{ref:s})}var ay=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ny(e,r){r.Views||(r.Views=[{}]),(e.match(ay)||[]).forEach(function(t,n){var s=Tt(t);r.Views[n]||(r.Views[n]={}),+s.zoomScale&&(r.Views[n].zoom=+s.zoomScale),Sr(s.rightToLeft)&&(r.Views[n].RTL=!0)})}function iy(e,r,t,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),rt("sheetViews",rt("sheetView",null,s),{})}function sy(e,r,t,n){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",c=e.t,h=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=gi[e.v];break;case"d":n&&n.cellDates?s=Tr(e.v,-1).toISOString():(e=Nr(e),e.t="n",s=""+(e.v=oa(Tr(e.v)))),typeof e.z>"u"&&(e.z=bt[14]);break;default:s=e.v;break}var d=va("v",mr(s)),m={r},g=Li(n.cellXfs,e,n);switch(g!==0&&(m.s=g),e.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){d=va("v",""+Bl(n.Strings,e.v,n.revStrings)),m.t="s";break}m.t="str";break}if(e.t!=c&&(e.t=c,e.v=h),typeof e.f=="string"&&e.f){var v=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;d=rt("f",mr(e.f),v)+(e.v!=null?d:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(m.cm=1),rt("c",d,m)}var oy=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,c=D0("v"),h=D0("f");return function(m,g,v,_,S,T){for(var N=0,C="",D=[],U=[],X=0,O=0,q=0,oe="",J,M,ie=0,j=0,_e,he,te=0,be=0,$e=Array.isArray(T.CellXf),ae,tt=[],Re=[],Lt=Array.isArray(g),fe=[],ot={},mt=!1,K=!!v.sheetStubs,ce=m.split(r),ee=0,ne=ce.length;ee!=ne;++ee){C=ce[ee].trim();var le=C.length;if(le!==0){var Ze=0;e:for(N=0;N<le;++N)switch(C[N]){case">":if(C[N-1]!="/"){++N;break e}if(v&&v.cellStyles){if(M=Tt(C.slice(Ze,N),!0),ie=M.r!=null?parseInt(M.r,10):ie+1,j=-1,v.sheetRows&&v.sheetRows<ie)continue;ot={},mt=!1,M.ht&&(mt=!0,ot.hpt=parseFloat(M.ht),ot.hpx=Xs(ot.hpt)),M.hidden=="1"&&(mt=!0,ot.hidden=!0),M.outlineLevel!=null&&(mt=!0,ot.level=+M.outlineLevel),mt&&(fe[ie-1]=ot)}break;case"<":Ze=N;break}if(Ze>=N)break;if(M=Tt(C.slice(Ze,N),!0),ie=M.r!=null?parseInt(M.r,10):ie+1,j=-1,!(v.sheetRows&&v.sheetRows<ie)){_.s.r>ie-1&&(_.s.r=ie-1),_.e.r<ie-1&&(_.e.r=ie-1),v&&v.cellStyles&&(ot={},mt=!1,M.ht&&(mt=!0,ot.hpt=parseFloat(M.ht),ot.hpx=Xs(ot.hpt)),M.hidden=="1"&&(mt=!0,ot.hidden=!0),M.outlineLevel!=null&&(mt=!0,ot.level=+M.outlineLevel),mt&&(fe[ie-1]=ot)),D=C.slice(N).split(e);for(var Le=0;Le!=D.length&&D[Le].trim().charAt(0)=="<";++Le);for(D=D.slice(Le),N=0;N!=D.length;++N)if(C=D[N].trim(),C.length!==0){if(U=C.match(t),X=N,O=0,q=0,C="<c "+(C.slice(0,1)=="<"?">":"")+C,U!=null&&U.length===2){for(X=0,oe=U[1],O=0;O!=oe.length&&!((q=oe.charCodeAt(O)-64)<1||q>26);++O)X=26*X+q;--X,j=X}else++j;for(O=0;O!=C.length&&C.charCodeAt(O)!==62;++O);if(++O,M=Tt(C.slice(0,O),!0),M.r||(M.r=St({r:ie-1,c:j})),oe=C.slice(O),J={t:""},(U=oe.match(c))!=null&&U[1]!==""&&(J.v=rr(U[1])),v.cellFormula){if((U=oe.match(h))!=null&&U[1]!==""){if(J.f=rr(vr(U[1])).replace(/\r\n/g,`
`),v.xlfn||(J.f=i1(J.f)),U[0].indexOf('t="array"')>-1)J.F=(oe.match(s)||[])[1],J.F.indexOf(":")>-1&&tt.push([ar(J.F),J.F]);else if(U[0].indexOf('t="shared"')>-1){he=Tt(U[0]);var Pe=rr(vr(U[1]));v.xlfn||(Pe=i1(Pe)),Re[parseInt(he.si,10)]=[he,Pe,M.r]}}else(U=oe.match(/<f[^>]*\/>/))&&(he=Tt(U[0]),Re[he.si]&&(J.f=av(Re[he.si][1],Re[he.si][2],M.r)));var Be=Lr(M.r);for(O=0;O<tt.length;++O)Be.r>=tt[O][0].s.r&&Be.r<=tt[O][0].e.r&&Be.c>=tt[O][0].s.c&&Be.c<=tt[O][0].e.c&&(J.F=tt[O][1])}if(M.t==null&&J.v===void 0)if(J.f||J.F)J.v=0,J.t="n";else if(K)J.t="z";else continue;else J.t=M.t||"n";switch(_.s.c>j&&(_.s.c=j),_.e.c<j&&(_.e.c=j),J.t){case"n":if(J.v==""||J.v==null){if(!K)continue;J.t="z"}else J.v=parseFloat(J.v);break;case"s":if(typeof J.v>"u"){if(!K)continue;J.t="z"}else _e=b0[parseInt(J.v,10)],J.v=_e.t,J.r=_e.r,v.cellHTML&&(J.h=_e.h);break;case"str":J.t="s",J.v=J.v!=null?vr(J.v):"",v.cellHTML&&(J.h=ml(J.v));break;case"inlineStr":U=oe.match(n),J.t="s",U!=null&&(_e=Il(U[1]))?(J.v=_e.t,v.cellHTML&&(J.h=_e.h)):J.v="";break;case"b":J.v=Sr(J.v);break;case"d":v.cellDates?J.v=Tr(J.v,1):(J.v=oa(Tr(J.v,1)),J.t="n");break;case"e":(!v||v.cellText!==!1)&&(J.w=J.v),J.v=vh[J.v];break}if(te=be=0,ae=null,$e&&M.s!==void 0&&(ae=T.CellXf[M.s],ae!=null&&(ae.numFmtId!=null&&(te=ae.numFmtId),v.cellStyles&&ae.fillId!=null&&(be=ae.fillId))),mu(J,te,be,v,S,T),v.cellDates&&$e&&J.t=="n"&&zs(bt[te])&&(J.t="d",J.v=cc(J.v)),M.cm&&v.xlmeta){var Te=(v.xlmeta.Cell||[])[+M.cm-1];Te&&Te.type=="XLDAPR"&&(J.D=!0)}if(Lt){var A=Lr(M.r);g[A.r]||(g[A.r]=[]),g[A.r][A.c]=J}else g[M.r]=J}}}}fe.length>0&&(g["!rows"]=fe)}}();function cy(e,r,t,n){var s=[],c=[],h=ar(e["!ref"]),d="",m,g="",v=[],_=0,S=0,T=e["!rows"],N=Array.isArray(e),C={r:g},D,U=-1;for(S=h.s.c;S<=h.e.c;++S)v[S]=Br(S);for(_=h.s.r;_<=h.e.r;++_){for(c=[],g=Yr(_),S=h.s.c;S<=h.e.c;++S){m=v[S]+g;var X=N?(e[_]||[])[S]:e[m];X!==void 0&&(d=sy(X,m,e,r))!=null&&c.push(d)}(c.length>0||T&&T[_])&&(C={r:g},T&&T[_]&&(D=T[_],D.hidden&&(C.hidden=1),U=-1,D.hpx?U=L0(D.hpx):D.hpt&&(U=D.hpt),U>-1&&(C.ht=U,C.customHeight=1),D.level&&(C.outlineLevel=D.level)),s[s.length]=rt("row",c.join(""),C))}if(T)for(;_<T.length;++_)T&&T[_]&&(C={r:_+1},D=T[_],D.hidden&&(C.hidden=1),U=-1,D.hpx?U=L0(D.hpx):D.hpt&&(U=D.hpt),U>-1&&(C.ht=U,C.customHeight=1),D.level&&(C.outlineLevel=D.level),s[s.length]=rt("row","",C));return s.join("")}function wu(e,r,t,n){var s=[Kr,rt("worksheet",null,{xmlns:fs[0],"xmlns:r":sa.r})],c=t.SheetNames[e],h=0,d="",m=t.Sheets[c];m==null&&(m={});var g=m["!ref"]||"A1",v=ar(g);if(v.e.c>16383||v.e.r>1048575){if(r.WTF)throw new Error("Range "+g+" exceeds format limit A1:XFD1048576");v.e.c=Math.min(v.e.c,16383),v.e.r=Math.min(v.e.c,1048575),g=Bt(v)}n||(n={}),m["!comments"]=[];var _=[];z3(m,t,e,r,s),s[s.length]=rt("dimension",null,{ref:g}),s[s.length]=iy(m,r,e,t),r.sheetFormat&&(s[s.length]=rt("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),m["!cols"]!=null&&m["!cols"].length>0&&(s[s.length]=ey(m,m["!cols"])),s[h=s.length]="<sheetData/>",m["!links"]=[],m["!ref"]!=null&&(d=cy(m,r),d.length>0&&(s[s.length]=d)),s.length>h+1&&(s[s.length]="</sheetData>",s[h]=s[h].replace("/>",">")),m["!protect"]&&(s[s.length]=q3(m["!protect"])),m["!autofilter"]!=null&&(s[s.length]=ry(m["!autofilter"],m,t,e)),m["!merges"]!=null&&m["!merges"].length>0&&(s[s.length]=G3(m["!merges"]));var S=-1,T,N=-1;return m["!links"].length>0&&(s[s.length]="<hyperlinks>",m["!links"].forEach(function(C){C[1].Target&&(T={ref:C[0]},C[1].Target.charAt(0)!="#"&&(N=gr(n,-1,mr(C[1].Target).replace(/#.*$/,""),zt.HLINK),T["r:id"]="rId"+N),(S=C[1].Target.indexOf("#"))>-1&&(T.location=mr(C[1].Target.slice(S+1))),C[1].Tooltip&&(T.tooltip=mr(C[1].Tooltip)),s[s.length]=rt("hyperlink",null,T))}),s[s.length]="</hyperlinks>"),delete m["!links"],m["!margins"]!=null&&(s[s.length]=Q3(m["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(s[s.length]=va("ignoredErrors",rt("ignoredError",null,{numberStoredAsText:1,sqref:g}))),_.length>0&&(N=gr(n,-1,"../drawings/drawing"+(e+1)+".xml",zt.DRAW),s[s.length]=rt("drawing",null,{"r:id":"rId"+N}),m["!drawing"]=_),m["!comments"].length>0&&(N=gr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",zt.VML),s[s.length]=rt("legacyDrawing",null,{"r:id":"rId"+N}),m["!legacy"]=N),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function ly(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var c=e.read_shift(1);return e.l=n,c&7&&(t.level=c&7),c&16&&(t.hidden=!0),c&32&&(t.hpt=s/20),t}function fy(e,r,t){var n=Oe(145),s=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var c=320;s.hpx?c=L0(s.hpx)*20:s.hpt&&(c=s.hpt*20),n.write_shift(2,c),n.write_shift(1,0);var h=0;s.level&&(h|=s.level),s.hidden&&(h|=16),(s.hpx||s.hpt)&&(h|=32),n.write_shift(1,h),n.write_shift(1,0);var d=0,m=n.l;n.l+=4;for(var g={r:e,c:0},v=0;v<16;++v)if(!(r.s.c>v+1<<10||r.e.c<v<<10)){for(var _=-1,S=-1,T=v<<10;T<v+1<<10;++T){g.c=T;var N=Array.isArray(t)?(t[g.r]||[])[g.c]:t[St(g)];N&&(_<0&&(_=T),S=T)}_<0||(++d,n.write_shift(4,_),n.write_shift(4,S))}var C=n.l;return n.l=m,n.write_shift(4,d),n.l=C,n.length>n.l?n.slice(0,n.l):n}function hy(e,r,t,n){var s=fy(n,t,r);(s.length>17||(r["!rows"]||[])[n])&&Ve(e,0,s)}var uy=xs,dy=qs;function xy(){}function gy(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=wg(e),t}function my(e,r,t){t==null&&(t=Oe(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var s=1;s<3;++s)t.write_shift(1,0);return qo({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),xh(e,t),t.slice(0,t.l)}function py(e){var r=pn(e);return[r]}function wy(e,r,t){return t==null&&(t=Oe(8)),hs(r,t)}function vy(e){var r=us(e);return[r]}function yy(e,r,t){return t==null&&(t=Oe(4)),ds(r,t)}function Ey(e){var r=pn(e),t=e.read_shift(1);return[r,t,"b"]}function _y(e,r,t){return t==null&&(t=Oe(9)),hs(r,t),t.write_shift(1,e.v?1:0),t}function Ay(e){var r=us(e),t=e.read_shift(1);return[r,t,"b"]}function by(e,r,t){return t==null&&(t=Oe(5)),ds(r,t),t.write_shift(1,e.v?1:0),t}function Cy(e){var r=pn(e),t=e.read_shift(1);return[r,t,"e"]}function Sy(e,r,t){return t==null&&(t=Oe(9)),hs(r,t),t.write_shift(1,e.v),t}function Ty(e){var r=us(e),t=e.read_shift(1);return[r,t,"e"]}function Ny(e,r,t){return t==null&&(t=Oe(8)),ds(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function ky(e){var r=pn(e),t=e.read_shift(4);return[r,t,"s"]}function Iy(e,r,t){return t==null&&(t=Oe(12)),hs(r,t),t.write_shift(4,r.v),t}function Dy(e){var r=us(e),t=e.read_shift(4);return[r,t,"s"]}function Fy(e,r,t){return t==null&&(t=Oe(8)),ds(r,t),t.write_shift(4,r.v),t}function Oy(e){var r=pn(e),t=Na(e);return[r,t,"n"]}function Ry(e,r,t){return t==null&&(t=Oe(16)),hs(r,t),is(e.v,t),t}function vu(e){var r=us(e),t=Na(e);return[r,t,"n"]}function My(e,r,t){return t==null&&(t=Oe(12)),ds(r,t),is(e.v,t),t}function Py(e){var r=pn(e),t=Cl(e);return[r,t,"n"]}function By(e,r,t){return t==null&&(t=Oe(12)),hs(r,t),gh(e.v,t),t}function Ly(e){var r=us(e),t=Cl(e);return[r,t,"n"]}function jy(e,r,t){return t==null&&(t=Oe(8)),ds(r,t),gh(e.v,t),t}function Uy(e){var r=pn(e),t=_l(e);return[r,t,"is"]}function Wy(e){var r=pn(e),t=ka(e);return[r,t,"str"]}function Vy(e,r,t){return t==null&&(t=Oe(12+4*e.v.length)),hs(r,t),xa(e.v,t),t.length>t.l?t.slice(0,t.l):t}function Hy(e){var r=us(e),t=ka(e);return[r,t,"str"]}function Gy(e,r,t){return t==null&&(t=Oe(8+4*e.v.length)),ds(r,t),xa(e.v,t),t.length>t.l?t.slice(0,t.l):t}function Xy(e,r,t){var n=e.l+r,s=pn(e);s.r=t["!row"];var c=e.read_shift(1),h=[s,c,"b"];if(t.cellFormula){e.l+=2;var d=hc(e,n-e.l,t);h[3]=Sa(d,null,s,t.supbooks,t)}else e.l=n;return h}function zy(e,r,t){var n=e.l+r,s=pn(e);s.r=t["!row"];var c=e.read_shift(1),h=[s,c,"e"];if(t.cellFormula){e.l+=2;var d=hc(e,n-e.l,t);h[3]=Sa(d,null,s,t.supbooks,t)}else e.l=n;return h}function Yy(e,r,t){var n=e.l+r,s=pn(e);s.r=t["!row"];var c=Na(e),h=[s,c,"n"];if(t.cellFormula){e.l+=2;var d=hc(e,n-e.l,t);h[3]=Sa(d,null,s,t.supbooks,t)}else e.l=n;return h}function Ky(e,r,t){var n=e.l+r,s=pn(e);s.r=t["!row"];var c=ka(e),h=[s,c,"str"];if(t.cellFormula){e.l+=2;var d=hc(e,n-e.l,t);h[3]=Sa(d,null,s,t.supbooks,t)}else e.l=n;return h}var qy=xs,Zy=qs;function Jy(e,r){return r==null&&(r=Oe(4)),r.write_shift(4,e),r}function Qy(e,r){var t=e.l+r,n=xs(e),s=Al(e),c=ka(e),h=ka(e),d=ka(e);e.l=t;var m={rfx:n,relId:s,loc:c,display:d};return h&&(m.Tooltip=h),m}function $y(e,r){var t=Oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));qs({s:Lr(e[0]),e:Lr(e[0])},t),bl("rId"+r,t);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return xa(s||"",t),xa(e[1].Tooltip||"",t),xa("",t),t.slice(0,t.l)}function e4(){}function t4(e,r,t){var n=e.l+r,s=mh(e),c=e.read_shift(1),h=[s];if(h[2]=c,t.cellFormula){var d=C3(e,n-e.l,t);h[1]=d}else e.l=n;return h}function r4(e,r,t){var n=e.l+r,s=xs(e),c=[s];if(t.cellFormula){var h=T3(e,n-e.l,t);c[1]=h,e.l=n}else e.l=n;return c}function a4(e,r,t){t==null&&(t=Oe(18));var n=uc(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var s=0;return r.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),r.level&&(s|=r.level<<8),t.write_shift(2,s),t}var yu=["left","right","top","bottom","header","footer"];function n4(e){var r={};return yu.forEach(function(t){r[t]=Na(e)}),r}function i4(e,r){return r==null&&(r=Oe(6*8)),rs(e),yu.forEach(function(t){is(e[t],r)}),r}function s4(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function o4(e,r,t){t==null&&(t=Oe(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function c4(e){var r=Oe(24);return r.write_shift(4,4),r.write_shift(4,1),qs(e,r),r}function l4(e,r){return r==null&&(r=Oe(16*4+2)),r.write_shift(2,e.password?Dl(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function f4(){}function h4(){}function u4(e,r,t,n,s,c,h){if(!e)return e;var d=r||{};n||(n={"!id":{}});var m=d.dense?[]:{},g,v={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=!1,S=!1,T,N,C,D,U,X,O,q,oe,J=[];d.biff=12,d["!row"]=0;var M=0,ie=!1,j=[],_e={},he=d.supbooks||s.supbooks||[[]];if(he.sharedf=_e,he.arrayf=j,he.SheetNames=s.SheetNames||s.Sheets.map(function(Lt){return Lt.name}),!d.supbooks&&(d.supbooks=he,s.Names))for(var te=0;te<s.Names.length;++te)he[0][te+1]=s.Names[te];var be=[],$e=[],ae=!1;j0[16]={n:"BrtShortReal",f:vu};var tt;if(xi(e,function(fe,ot,mt){if(!S)switch(mt){case 148:g=fe;break;case 0:T=fe,d.sheetRows&&d.sheetRows<=T.r&&(S=!0),q=Yr(D=T.r),d["!row"]=T.r,(fe.hidden||fe.hpt||fe.level!=null)&&(fe.hpt&&(fe.hpx=Xs(fe.hpt)),$e[fe.r]=fe);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(N={t:fe[2]},fe[2]){case"n":N.v=fe[1];break;case"s":O=b0[fe[1]],N.v=O.t,N.r=O.r;break;case"b":N.v=!!fe[1];break;case"e":N.v=fe[1],d.cellText!==!1&&(N.w=gi[N.v]);break;case"str":N.t="s",N.v=fe[1];break;case"is":N.t="s",N.v=fe[1].t;break}if((C=h.CellXf[fe[0].iStyleRef])&&mu(N,C.numFmtId,null,d,c,h),U=fe[0].c==-1?U+1:fe[0].c,d.dense?(m[D]||(m[D]=[]),m[D][U]=N):m[Br(U)+q]=N,d.cellFormula){for(ie=!1,M=0;M<j.length;++M){var K=j[M];T.r>=K[0].s.r&&T.r<=K[0].e.r&&U>=K[0].s.c&&U<=K[0].e.c&&(N.F=Bt(K[0]),ie=!0)}!ie&&fe.length>3&&(N.f=fe[3])}if(v.s.r>T.r&&(v.s.r=T.r),v.s.c>U&&(v.s.c=U),v.e.r<T.r&&(v.e.r=T.r),v.e.c<U&&(v.e.c=U),d.cellDates&&C&&N.t=="n"&&zs(bt[C.numFmtId])){var ce=Qi(N.v);ce&&(N.t="d",N.v=new Date(ce.y,ce.m-1,ce.d,ce.H,ce.M,ce.S,ce.u))}tt&&(tt.type=="XLDAPR"&&(N.D=!0),tt=void 0);break;case 1:case 12:if(!d.sheetStubs||_)break;N={t:"z",v:void 0},U=fe[0].c==-1?U+1:fe[0].c,d.dense?(m[D]||(m[D]=[]),m[D][U]=N):m[Br(U)+q]=N,v.s.r>T.r&&(v.s.r=T.r),v.s.c>U&&(v.s.c=U),v.e.r<T.r&&(v.e.r=T.r),v.e.c<U&&(v.e.c=U),tt&&(tt.type=="XLDAPR"&&(N.D=!0),tt=void 0);break;case 176:J.push(fe);break;case 49:tt=((d.xlmeta||{}).Cell||[])[fe-1];break;case 494:var ee=n["!id"][fe.relId];for(ee?(fe.Target=ee.Target,fe.loc&&(fe.Target+="#"+fe.loc),fe.Rel=ee):fe.relId==""&&(fe.Target="#"+fe.loc),D=fe.rfx.s.r;D<=fe.rfx.e.r;++D)for(U=fe.rfx.s.c;U<=fe.rfx.e.c;++U)d.dense?(m[D]||(m[D]=[]),m[D][U]||(m[D][U]={t:"z",v:void 0}),m[D][U].l=fe):(X=St({c:U,r:D}),m[X]||(m[X]={t:"z",v:void 0}),m[X].l=fe);break;case 426:if(!d.cellFormula)break;j.push(fe),oe=d.dense?m[D][U]:m[Br(U)+q],oe.f=Sa(fe[1],v,{r:T.r,c:U},he,d),oe.F=Bt(fe[0]);break;case 427:if(!d.cellFormula)break;_e[St(fe[0].s)]=fe[1],oe=d.dense?m[D][U]:m[Br(U)+q],oe.f=Sa(fe[1],v,{r:T.r,c:U},he,d);break;case 60:if(!d.cellStyles)break;for(;fe.e>=fe.s;)be[fe.e--]={width:fe.w/256,hidden:!!(fe.flags&1),level:fe.level},ae||(ae=!0,Fl(fe.w/256)),Oi(be[fe.e+1]);break;case 161:m["!autofilter"]={ref:Bt(fe)};break;case 476:m["!margins"]=fe;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),fe.name&&(s.Sheets[t].CodeName=fe.name),(fe.above||fe.left)&&(m["!outline"]={above:fe.above,left:fe.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),fe.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_=!0;break;case 36:_=!1;break;case 37:_=!0;break;case 38:_=!1;break;default:if(!ot.T){if(!_||d.WTF)throw new Error("Unexpected record 0x"+mt.toString(16))}}},d),delete d.supbooks,delete d["!row"],!m["!ref"]&&(v.s.r<2e6||g&&(g.e.r>0||g.e.c>0||g.s.r>0||g.s.c>0))&&(m["!ref"]=Bt(g||v)),d.sheetRows&&m["!ref"]){var Re=ar(m["!ref"]);d.sheetRows<=+Re.e.r&&(Re.e.r=d.sheetRows-1,Re.e.r>v.e.r&&(Re.e.r=v.e.r),Re.e.r<Re.s.r&&(Re.s.r=Re.e.r),Re.e.c>v.e.c&&(Re.e.c=v.e.c),Re.e.c<Re.s.c&&(Re.s.c=Re.e.c),m["!fullref"]=m["!ref"],m["!ref"]=Bt(Re))}return J.length>0&&(m["!merges"]=J),be.length>0&&(m["!cols"]=be),$e.length>0&&(m["!rows"]=$e),m}function d4(e,r,t,n,s,c,h){if(r.v===void 0)return!1;var d="";switch(r.t){case"b":d=r.v?"1":"0";break;case"d":r=Nr(r),r.z=r.z||bt[14],r.v=oa(Tr(r.v)),r.t="n";break;case"n":case"e":d=""+r.v;break;default:d=r.v;break}var m={r:t,c:n};switch(m.s=Li(s.cellXfs,r,s),r.l&&c["!links"].push([St(m),r.l]),r.c&&c["!comments"].push([St(m),r.c]),r.t){case"s":case"str":return s.bookSST?(d=Bl(s.Strings,r.v,s.revStrings),m.t="s",m.v=d,h?Ve(e,18,Fy(r,m)):Ve(e,7,Iy(r,m))):(m.t="str",h?Ve(e,17,Gy(r,m)):Ve(e,6,Vy(r,m))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?h?Ve(e,13,jy(r,m)):Ve(e,2,By(r,m)):h?Ve(e,16,My(r,m)):Ve(e,5,Ry(r,m)),!0;case"b":return m.t="b",h?Ve(e,15,by(r,m)):Ve(e,4,_y(r,m)),!0;case"e":return m.t="e",h?Ve(e,14,Ny(r,m)):Ve(e,3,Sy(r,m)),!0}return h?Ve(e,12,yy(r,m)):Ve(e,1,wy(r,m)),!0}function x4(e,r,t,n){var s=ar(r["!ref"]||"A1"),c,h="",d=[];Ve(e,145);var m=Array.isArray(r),g=s.e.r;r["!rows"]&&(g=Math.max(s.e.r,r["!rows"].length-1));for(var v=s.s.r;v<=g;++v){h=Yr(v),hy(e,r,s,v);var _=!1;if(v<=s.e.r)for(var S=s.s.c;S<=s.e.c;++S){v===s.s.r&&(d[S]=Br(S)),c=d[S]+h;var T=m?(r[v]||[])[S]:r[c];if(!T){_=!1;continue}_=d4(e,T,v,S,n,r,_)}}Ve(e,146)}function g4(e,r){!r||!r["!merges"]||(Ve(e,177,Jy(r["!merges"].length)),r["!merges"].forEach(function(t){Ve(e,176,Zy(t))}),Ve(e,178))}function m4(e,r){!r||!r["!cols"]||(Ve(e,390),r["!cols"].forEach(function(t,n){t&&Ve(e,60,a4(n,t))}),Ve(e,391))}function p4(e,r){!r||!r["!ref"]||(Ve(e,648),Ve(e,649,c4(ar(r["!ref"]))),Ve(e,650))}function w4(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var s=gr(t,-1,n[1].Target.replace(/#.*$/,""),zt.HLINK);Ve(e,494,$y(n,s))}}),delete r["!links"]}function v4(e,r,t,n){if(r["!comments"].length>0){var s=gr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",zt.VML);Ve(e,551,bl("rId"+s)),r["!legacy"]=s}}function y4(e,r,t,n){if(r["!autofilter"]){var s=r["!autofilter"],c=typeof s.ref=="string"?s.ref:Bt(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var h=t.Workbook.Names,d=Ha(c);d.s.r==d.e.r&&(d.e.r=Ha(r["!ref"]).e.r,c=Bt(d));for(var m=0;m<h.length;++m){var g=h[m];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==n){g.Ref="'"+t.SheetNames[n]+"'!"+c;break}}m==h.length&&h.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+c}),Ve(e,161,qs(ar(c))),Ve(e,162)}}function E4(e,r,t){Ve(e,133),Ve(e,137,o4(r,t)),Ve(e,138),Ve(e,134)}function _4(e,r){r["!protect"]&&Ve(e,535,l4(r["!protect"]))}function A4(e,r,t,n){var s=Va(),c=t.SheetNames[e],h=t.Sheets[c]||{},d=c;try{t&&t.Workbook&&(d=t.Workbook.Sheets[e].CodeName||d)}catch{}var m=ar(h["!ref"]||"A1");if(m.e.c>16383||m.e.r>1048575){if(r.WTF)throw new Error("Range "+(h["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575)}return h["!links"]=[],h["!comments"]=[],Ve(s,129),(t.vbaraw||h["!outline"])&&Ve(s,147,my(d,h["!outline"])),Ve(s,148,dy(m)),E4(s,h,t.Workbook),m4(s,h),x4(s,h,e,r),_4(s,h),y4(s,h,t,e),g4(s,h),w4(s,h,n),h["!margins"]&&Ve(s,476,i4(h["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&p4(s,h),v4(s,h,e,n),Ve(s,130),s.end()}function b4(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(c){var h=c.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);h&&(r[+h[1]]=t?+h[2]:h[2])});var s=rr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(c){n=c.replace(/<.*?>/g,"")}),[r,s,n]}function C4(e,r,t,n,s,c){var h=c||{"!type":"chart"};if(!e)return c;var d=0,m=0,g="A",v={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(_){var S=b4(_);v.s.r=v.s.c=0,v.e.c=d,g=Br(d),S[0].forEach(function(T,N){h[g+Yr(N)]={t:"n",v:T,z:S[1]},m=N}),v.e.r<m&&(v.e.r=m),++d}),d>0&&(h["!ref"]=Bt(v)),h}function S4(e,r,t,n,s){if(!e)return e;n||(n={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},h,d=e.match(pu);return d&&Ll(d[0],c,s,t),(h=e.match(/drawing r:id="(.*?)"/))&&(c["!rel"]=h[1]),n["!id"][c["!rel"]]&&(c["!drawel"]=n["!id"][c["!rel"]]),c}function T4(e,r){e.l+=10;var t=ka(e);return{name:t}}function N4(e,r,t,n,s){if(!e)return e;n||(n={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},h=!1;return xi(e,function(m,g,v){switch(v){case 550:c["!rel"]=m;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),m.name&&(s.Sheets[t].CodeName=m.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:h=!0;break;case 36:h=!1;break;case 37:break;case 38:break;default:if(!(g.T>0)){if(!(g.T<0)){if(!h||r.WTF)throw new Error("Unexpected record 0x"+v.toString(16))}}}},r),n["!id"][c["!rel"]]&&(c["!drawel"]=n["!id"][c["!rel"]]),c}var jl=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],k4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],I4=[],D4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function f1(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],s=0;s!=r.length;++s){var c=r[s];if(n[c[0]]==null)n[c[0]]=c[1];else switch(c[2]){case"bool":typeof n[c[0]]=="string"&&(n[c[0]]=Sr(n[c[0]]));break;case"int":typeof n[c[0]]=="string"&&(n[c[0]]=parseInt(n[c[0]],10));break}}}function h1(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Sr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Eu(e){h1(e.WBProps,jl),h1(e.CalcPr,D4),f1(e.WBView,k4),f1(e.Sheets,I4),Vs.date1904=Sr(e.WBProps.date1904)}function F4(e){return!e.Workbook||!e.Workbook.WBProps?"false":Sr(e.Workbook.WBProps.date1904)?"true":"false"}var O4="][*?/\\".split("");function _u(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return O4.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function R4(e,r,t){e.forEach(function(n,s){_u(n);for(var c=0;c<s;++c)if(n==e[c])throw new Error("Duplicate Sheet Name: "+n);if(t){var h=r&&r[s]&&r[s].CodeName||n;if(h.charCodeAt(0)==95&&h.length>22)throw new Error("Bad Code Name: Worksheet"+h)}})}function M4(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];R4(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)F3(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var P4=/<\w+:workbook/;function B4(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",c={},h=0;if(e.replace(Da,function(m,g){var v=Tt(m);switch(Hn(v[0])){case"<?xml":break;case"<workbook":m.match(P4)&&(s="xmlns"+m.match(/<(\w+):/)[1]),t.xmlns=v[s];break;case"</workbook>":break;case"<fileVersion":delete v[0],t.AppVersion=v;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":jl.forEach(function(_){if(v[_[0]]!=null)switch(_[2]){case"bool":t.WBProps[_[0]]=Sr(v[_[0]]);break;case"int":t.WBProps[_[0]]=parseInt(v[_[0]],10);break;default:t.WBProps[_[0]]=v[_[0]]}}),v.codeName&&(t.WBProps.CodeName=vr(v.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete v[0],t.WBView.push(v);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(v.state){case"hidden":v.Hidden=1;break;case"veryHidden":v.Hidden=2;break;default:v.Hidden=0}delete v.state,v.name=rr(vr(v.name)),delete v[0],t.Sheets.push(v);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":c={},c.Name=vr(v.name),v.comment&&(c.Comment=v.comment),v.localSheetId&&(c.Sheet=+v.localSheetId),Sr(v.hidden||"0")&&(c.Hidden=!0),h=g+m.length;break;case"</definedName>":c.Ref=rr(vr(e.slice(h,g))),t.Names.push(c);break;case"<definedName/>":break;case"<calcPr":delete v[0],t.CalcPr=v;break;case"<calcPr/>":delete v[0],t.CalcPr=v;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+v[0]+" in workbook")}return m}),fs.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Eu(t),t}function Au(e){var r=[Kr];r[r.length]=rt("workbook",null,{xmlns:fs[0],"xmlns:r":sa.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(jl.forEach(function(d){e.Workbook.WBProps[d[0]]!=null&&e.Workbook.WBProps[d[0]]!=d[1]&&(n[d[0]]=e.Workbook.WBProps[d[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=rt("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],c=0;if(s&&s[0]&&s[0].Hidden){for(r[r.length]="<bookViews>",c=0;c!=e.SheetNames.length&&!(!s[c]||!s[c].Hidden);++c);c==e.SheetNames.length&&(c=0),r[r.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",c=0;c!=e.SheetNames.length;++c){var h={name:mr(e.SheetNames[c].slice(0,31))};if(h.sheetId=""+(c+1),h["r:id"]="rId"+(c+1),s[c])switch(s[c].Hidden){case 1:h.state="hidden";break;case 2:h.state="veryHidden";break}r[r.length]=rt("sheet",null,h)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(d){var m={name:d.Name};d.Comment&&(m.comment=d.Comment),d.Sheet!=null&&(m.localSheetId=""+d.Sheet),d.Hidden&&(m.hidden="1"),d.Ref&&(r[r.length]=rt("definedName",mr(d.Ref),m))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function L4(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Yc(e),t.name=ka(e),t}function j4(e,r){return r||(r=Oe(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),bl(e.strRelID,r),xa(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function U4(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=r>8?ka(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function W4(e,r){r||(r=Oe(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),xh(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function V4(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function H4(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var s=e.read_shift(4),c=vg(e),h=S3(e,0,t),d=Al(e);e.l=n;var m={Name:c,Ptg:h};return s<268435455&&(m.Sheet=s),d&&(m.Comment=d),m}function G4(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;r||(r={}),r.biff=12;var c=[],h=[[]];return h.SheetNames=[],h.XTI=[],j0[16]={n:"BrtFRTArchID$",f:V4},xi(e,function(m,g,v){switch(v){case 156:h.SheetNames.push(m.name),t.Sheets.push(m);break;case 153:t.WBProps=m;break;case 39:m.Sheet!=null&&(r.SID=m.Sheet),m.Ref=Sa(m.Ptg,null,null,h,r),delete r.SID,delete m.Ptg,c.push(m);break;case 1036:break;case 357:case 358:case 355:case 667:h[0].length?h.push([v,m]):h[0]=[v,m],h[h.length-1].XTI=[];break;case 362:h.length===0&&(h[0]=[],h[0].XTI=[]),h[h.length-1].XTI=h[h.length-1].XTI.concat(m),h.XTI=h.XTI.concat(m);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(v),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(v),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!g.T){if(!s||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+v.toString(16))}}},r),Eu(t),t.Names=c,t.supbooks=h,t}function X4(e,r){Ve(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,s={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};Ve(e,156,j4(s))}Ve(e,144)}function z4(e,r){r||(r=Oe(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return xa("SheetJS",r),xa(Vo.version,r),xa(Vo.version,r),xa("7262",r),r.length>r.l?r.slice(0,r.l):r}function Y4(e,r){r||(r=Oe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function K4(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,s=-1,c=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&s==-1?s=n:t[n].Hidden==1&&c==-1&&(c=n);c>s||(Ve(e,135),Ve(e,158,Y4(s)),Ve(e,136))}}function q4(e,r){var t=Va();return Ve(t,131),Ve(t,128,z4()),Ve(t,153,W4(e.Workbook&&e.Workbook.WBProps||null)),K4(t,e),X4(t,e),Ve(t,132),t.end()}function Z4(e,r,t){return r.slice(-4)===".bin"?G4(e,t):B4(e,t)}function J4(e,r,t,n,s,c,h,d){return r.slice(-4)===".bin"?u4(e,n,t,s,c,h,d):H3(e,n,t,s,c,h,d)}function Q4(e,r,t,n,s,c,h,d){return r.slice(-4)===".bin"?N4(e,n,t,s,c):S4(e,n,t,s,c)}function $4(e,r,t,n,s,c,h,d){return r.slice(-4)===".bin"?tv():rv()}function eE(e,r,t,n,s,c,h,d){return r.slice(-4)===".bin"?$w():ev()}function tE(e,r,t,n){return r.slice(-4)===".bin"?Zp(e,t,n):Lp(e,t,n)}function rE(e,r,t){return au(e,t)}function aE(e,r,t){return r.slice(-4)===".bin"?ap(e,t):ep(e,t)}function nE(e,r,t){return r.slice(-4)===".bin"?Kw(e,t):jw(e,t)}function iE(e,r,t){return r.slice(-4)===".bin"?Pw(e):Rw(e)}function sE(e,r,t,n){return t.slice(-4)===".bin"?Bw(e,r,t,n):void 0}function oE(e,r,t){return r.slice(-4)===".bin"?Dw(e,r,t):Ow(e,r,t)}function cE(e,r,t){return(r.slice(-4)===".bin"?q4:Au)(e)}function lE(e,r,t,n,s){return(r.slice(-4)===".bin"?A4:wu)(e,t,n,s)}function fE(e,r,t){return(r.slice(-4)===".bin"?sw:tu)(e,t)}function hE(e,r,t){return(r.slice(-4)===".bin"?sp:Yh)(e,t)}function uE(e,r,t){return(r.slice(-4)===".bin"?qw:su)(e)}function dE(e){return(e.slice(-4)===".bin"?Fw:nu)()}var bu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Cu=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Cn(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var s=e.match(bu),c,h,d,m;if(s)for(m=0;m!=s.length;++m)c=s[m].match(Cu),(h=c[1].indexOf(":"))===-1?n[c[1]]=c[2].slice(1,c[2].length-1):(c[1].slice(0,6)==="xmlns:"?d="xmlns"+c[1].slice(6):d=c[1].slice(h+1),n[d]=c[2].slice(1,c[2].length-1));return n}function xE(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(bu),s,c,h,d;if(n)for(d=0;d!=n.length;++d)s=n[d].match(Cu),(c=s[1].indexOf(":"))===-1?t[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?h="xmlns"+s[1].slice(6):h=s[1].slice(c+1),t[h]=s[2].slice(1,s[2].length-1));return t}var S0;function gE(e,r){var t=S0[e]||rr(e);return t==="General"?as(r):mn(t,r)}function mE(e,r,t,n){var s=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Sr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Tr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[rr(r)]=s}function pE(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||gi[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=I0(e.v):e.w=as(e.v):e.w=gE(r||"General",e.v)}catch(c){if(t.WTF)throw c}try{var n=S0[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&zs(n)){var s=Qi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(c){if(t.WTF)throw c}}}function wE(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=Ip[n.Pattern]||n.Pattern)}e[r.ID]=r}function vE(e,r,t,n,s,c,h,d,m,g){var v="General",_=n.StyleID,S={};g=g||{};var T=[],N=0;for(_===void 0&&d&&(_=d.StyleID),_===void 0&&h&&(_=h.StyleID);c[_]!==void 0&&(c[_].nf&&(v=c[_].nf),c[_].Interior&&T.push(c[_].Interior),!!c[_].Parent);)_=c[_].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Sr(e);break;case"String":n.t="s",n.r=Nf(rr(e)),n.v=e.indexOf("<")>-1?rr(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Tr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=rr(e):n.v<60&&(n.v=n.v-1),(!v||v=="General")&&(v="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=vh[e],g.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=Nf(r||e));break}if(pE(n,v,g),g.cellFormula!==!1)if(n.Formula){var C=rr(n.Formula);C.charCodeAt(0)==61&&(C=C.slice(1)),n.f=Ws(C,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Ws("RC:RC",s):n.ArrayRange&&(n.F=Ws(n.ArrayRange,s),m.push([ar(n.F),n.F]))}else for(N=0;N<m.length;++N)s.r>=m[N][0].s.r&&s.r<=m[N][0].e.r&&s.c>=m[N][0].s.c&&s.c<=m[N][0].e.c&&(n.F=m[N][1]);g.cellStyles&&(T.forEach(function(D){!S.patternType&&D.patternType&&(S.patternType=D.patternType)}),n.s=S),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function yE(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Wc(e,r){var t=r||{};Ys();var n=p0(pl(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=vr(n));var s=n.slice(0,1024).toLowerCase(),c=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var h=Nr(t);return h.type="string",Gs.to_workbook(n,h)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ft){s.indexOf("<"+ft)>=0&&(c=!0)}),c)return i_(n,t);S0={"General Number":"General","General Date":bt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":bt[15],"Short Date":bt[14],"Long Time":bt[19],"Medium Time":bt[18],"Short Time":bt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:bt[2],Standard:bt[4],Percent:bt[10],Scientific:bt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,m=[],g,v={},_=[],S=t.dense?[]:{},T="",N={},C={},D=Cn('<Data ss:Type="String">'),U=0,X=0,O=0,q={s:{r:2e6,c:2e6},e:{r:0,c:0}},oe={},J={},M="",ie=0,j=[],_e={},he={},te=0,be=[],$e=[],ae={},tt=[],Re,Lt=!1,fe=[],ot=[],mt={},K=0,ce=0,ee={Sheets:[],WBProps:{date1904:!1}},ne={};O0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";d=O0.exec(n);)switch(d[3]=(le=d[3]).toLowerCase()){case"data":if(le=="data"){if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break}if(m[m.length-1][1])break;d[1]==="/"?vE(n.slice(U,d.index),M,D,m[m.length-1][0]=="comment"?ae:N,{c:X,r:O},oe,tt[X],C,fe,t):(M="",D=Cn(d[0]),U=d.index+d[0].length);break;case"cell":if(d[1]==="/")if($e.length>0&&(N.c=$e),(!t.sheetRows||t.sheetRows>O)&&N.v!==void 0&&(t.dense?(S[O]||(S[O]=[]),S[O][X]=N):S[Br(X)+Yr(O)]=N),N.HRef&&(N.l={Target:rr(N.HRef)},N.HRefScreenTip&&(N.l.Tooltip=N.HRefScreenTip),delete N.HRef,delete N.HRefScreenTip),(N.MergeAcross||N.MergeDown)&&(K=X+(parseInt(N.MergeAcross,10)|0),ce=O+(parseInt(N.MergeDown,10)|0),j.push({s:{c:X,r:O},e:{c:K,r:ce}})),!t.sheetStubs)N.MergeAcross?X=K+1:++X;else if(N.MergeAcross||N.MergeDown){for(var Ze=X;Ze<=K;++Ze)for(var Le=O;Le<=ce;++Le)(Ze>X||Le>O)&&(t.dense?(S[Le]||(S[Le]=[]),S[Le][Ze]={t:"z"}):S[Br(Ze)+Yr(Le)]={t:"z"});X=K+1}else++X;else N=xE(d[0]),N.Index&&(X=+N.Index-1),X<q.s.c&&(q.s.c=X),X>q.e.c&&(q.e.c=X),d[0].slice(-2)==="/>"&&++X,$e=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(O<q.s.r&&(q.s.r=O),O>q.e.r&&(q.e.r=O),d[0].slice(-2)==="/>"&&(C=Cn(d[0]),C.Index&&(O=+C.Index-1)),X=0,++O):(C=Cn(d[0]),C.Index&&(O=+C.Index-1),mt={},(C.AutoFitHeight=="0"||C.Height)&&(mt.hpx=parseInt(C.Height,10),mt.hpt=L0(mt.hpx),ot[O]=mt),C.Hidden=="1"&&(mt.hidden=!0,ot[O]=mt));break;case"worksheet":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"));_.push(T),q.s.r<=q.e.r&&q.s.c<=q.e.c&&(S["!ref"]=Bt(q),t.sheetRows&&t.sheetRows<=q.e.r&&(S["!fullref"]=S["!ref"],q.e.r=t.sheetRows-1,S["!ref"]=Bt(q))),j.length&&(S["!merges"]=j),tt.length>0&&(S["!cols"]=tt),ot.length>0&&(S["!rows"]=ot),v[T]=S}else q={s:{r:2e6,c:2e6},e:{r:0,c:0}},O=X=0,m.push([d[3],!1]),g=Cn(d[0]),T=rr(g.Name),S=t.dense?[]:{},j=[],fe=[],ot=[],ne={name:T,Hidden:0},ee.Sheets.push(ne);break;case"table":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else{if(d[0].slice(-2)=="/>")break;m.push([d[3],!1]),tt=[],Lt=!1}break;case"style":d[1]==="/"?wE(oe,J,t):J=Cn(d[0]);break;case"numberformat":J.nf=rr(Cn(d[0]).Format||"General"),S0[J.nf]&&(J.nf=S0[J.nf]);for(var Pe=0;Pe!=392&&bt[Pe]!=J.nf;++Pe);if(Pe==392){for(Pe=57;Pe!=392;++Pe)if(bt[Pe]==null){fi(J.nf,Pe);break}}break;case"column":if(m[m.length-1][0]!=="table")break;if(Re=Cn(d[0]),Re.Hidden&&(Re.hidden=!0,delete Re.Hidden),Re.Width&&(Re.wpx=parseInt(Re.Width,10)),!Lt&&Re.wpx>10){Lt=!0,Ta=$h;for(var Be=0;Be<tt.length;++Be)tt[Be]&&Oi(tt[Be])}Lt&&Oi(Re),tt[Re.Index-1||tt.length]=Re;for(var Te=0;Te<+Re.Span;++Te)tt[tt.length]=Nr(Re);break;case"namedrange":if(d[1]==="/")break;ee.Names||(ee.Names=[]);var A=Tt(d[0]),Y={Name:A.Name,Ref:Ws(A.RefersTo.slice(1),{r:0,c:0})};ee.Sheets.length>0&&(Y.Sheet=ee.Sheets.length-1),ee.Names.push(Y);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?M+=n.slice(ie,d.index):ie=d.index+d[0].length;break;case"interior":if(!t.cellStyles)break;J.Interior=Cn(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?Gg(_e,le,n.slice(te,d.index)):te=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else m.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"));yE(ae),$e.push(ae)}else m.push([d[3],!1]),g=Cn(d[0]),ae={a:g.Author};break;case"autofilter":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var ht=Cn(d[0]);S["!autofilter"]={ref:Ws(ht.Range).replace(/\$/g,"")},m.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"null":break;default:if(m.length==0&&d[3]=="document"||m.length==0&&d[3]=="uof")return m1(n,t);var lt=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:lt=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:lt=!1}break;case"excelworkbook":switch(d[3]){case"date1904":ee.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:lt=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:lt=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(n.slice(te,d.index)){case"SheetHidden":ne.Hidden=1;break;case"SheetVeryHidden":ne.Hidden=2;break}else te=d.index+d[0].length;break;case"header":S["!margins"]||rs(S["!margins"]={},"xlml"),isNaN(+Tt(d[0]).Margin)||(S["!margins"].header=+Tt(d[0]).Margin);break;case"footer":S["!margins"]||rs(S["!margins"]={},"xlml"),isNaN(+Tt(d[0]).Margin)||(S["!margins"].footer=+Tt(d[0]).Margin);break;case"pagemargins":var Xe=Tt(d[0]);S["!margins"]||rs(S["!margins"]={},"xlml"),isNaN(+Xe.Top)||(S["!margins"].top=+Xe.Top),isNaN(+Xe.Left)||(S["!margins"].left=+Xe.Left),isNaN(+Xe.Right)||(S["!margins"].right=+Xe.Right),isNaN(+Xe.Bottom)||(S["!margins"].bottom=+Xe.Bottom);break;case"displayrighttoleft":ee.Views||(ee.Views=[]),ee.Views[0]||(ee.Views[0]={}),ee.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":S["!outline"]||(S["!outline"]={}),S["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":S["!outline"]||(S["!outline"]={}),S["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:lt=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:lt=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:lt=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:lt=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:lt=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:lt=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:lt=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:lt=!1}break;case"smarttags":break;default:lt=!1;break}if(lt||d[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+m.join("|");if(m[m.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?mE(he,le,be,n.slice(te,d.index)):(be=d,te=d.index+d[0].length);break}if(t.WTF)throw"Unrecognized tag: "+d[3]+"|"+m.join("|")}var Me={};return!t.bookSheets&&!t.bookProps&&(Me.Sheets=v),Me.SheetNames=_,Me.Workbook=ee,Me.SSF=Nr(bt),Me.Props=_e,Me.Custprops=he,Me}function el(e,r){switch(Wl(r=r||{}),r.type||"base64"){case"base64":return Wc(en(e),r);case"binary":case"buffer":case"file":return Wc(e,r);case"array":return Wc(Pi(e),r)}}function EE(e,r){var t=[];return e.Props&&t.push(Xg(e.Props,r)),e.Custprops&&t.push(zg(e.Props,e.Custprops)),t.join("")}function _E(){return""}function AE(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,s){var c=[];c.push(rt("NumberFormat",null,{"ss:Format":mr(bt[n.numFmtId])}));var h={"ss:ID":"s"+(21+s)};t.push(rt("Style",c.join(""),h))}),rt("Styles",t.join(""))}function Su(e){return rt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Ml(e.Ref,{r:0,c:0})})}function bE(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var s=r[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(Su(s)))}return rt("Names",t.join(""))}function CE(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,c=[],h=0;h<s.length;++h){var d=s[h];d.Sheet==t&&(d.Name.match(/^_xlfn\./)||c.push(Su(d)))}return c.join("")}function SE(e,r,t,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(rt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(rt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(rt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)s.push(rt("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<t&&!(n.Workbook.Sheets[c]&&!n.Workbook.Sheets[c].Hidden);++c);c==t&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(va("ProtectContents","True")),e["!protect"].objects&&s.push(va("ProtectObjects","True")),e["!protect"].scenarios&&s.push(va("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(va("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(va("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(h){e["!protect"][h[0]]&&s.push("<"+h[1]+"/>")})),s.length==0?"":rt("WorksheetOptions",s.join(""),{xmlns:Za.x})}function TE(e){return e.map(function(r){var t=Kx(r.t||""),n=rt("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return rt("Comment",n,{"ss:Author":r.a})}).join("")}function NE(e,r,t,n,s,c,h){if(!e||e.v==null&&e.f==null)return"";var d={};if(e.f&&(d["ss:Formula"]="="+mr(Ml(e.f,h))),e.F&&e.F.slice(0,r.length)==r){var m=Lr(e.F.slice(r.length+1));d["ss:ArrayRange"]="RC:R"+(m.r==h.r?"":"["+(m.r-h.r)+"]")+"C"+(m.c==h.c?"":"["+(m.c-h.c)+"]")}if(e.l&&e.l.Target&&(d["ss:HRef"]=mr(e.l.Target),e.l.Tooltip&&(d["x:HRefScreenTip"]=mr(e.l.Tooltip))),t["!merges"])for(var g=t["!merges"],v=0;v!=g.length;++v)g[v].s.c!=h.c||g[v].s.r!=h.r||(g[v].e.c>g[v].s.c&&(d["ss:MergeAcross"]=g[v].e.c-g[v].s.c),g[v].e.r>g[v].s.r&&(d["ss:MergeDown"]=g[v].e.r-g[v].s.r));var _="",S="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":_="Number",S=String(e.v);break;case"b":_="Boolean",S=e.v?"1":"0";break;case"e":_="Error",S=gi[e.v];break;case"d":_="DateTime",S=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||bt[14]);break;case"s":_="String",S=Yx(e.v||"");break}var T=Li(n.cellXfs,e,n);d["ss:StyleID"]="s"+(21+T),d["ss:Index"]=h.c+1;var N=e.v!=null?S:"",C=e.t=="z"?"":'<Data ss:Type="'+_+'">'+N+"</Data>";return(e.c||[]).length>0&&(C+=TE(e.c)),rt("Cell",C,d)}function kE(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Xs(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function IE(e,r,t,n){if(!e["!ref"])return"";var s=ar(e["!ref"]),c=e["!merges"]||[],h=0,d=[];e["!cols"]&&e["!cols"].forEach(function(D,U){Oi(D);var X=!!D.width,O=uc(U,D),q={"ss:Index":U+1};X&&(q["ss:Width"]=P0(O.width)),D.hidden&&(q["ss:Hidden"]="1"),d.push(rt("Column",null,q))});for(var m=Array.isArray(e),g=s.s.r;g<=s.e.r;++g){for(var v=[kE(g,(e["!rows"]||[])[g])],_=s.s.c;_<=s.e.c;++_){var S=!1;for(h=0;h!=c.length;++h)if(!(c[h].s.c>_)&&!(c[h].s.r>g)&&!(c[h].e.c<_)&&!(c[h].e.r<g)){(c[h].s.c!=_||c[h].s.r!=g)&&(S=!0);break}if(!S){var T={r:g,c:_},N=St(T),C=m?(e[g]||[])[_]:e[N];v.push(NE(C,N,e,r,t,n,T))}}v.push("</Row>"),v.length>2&&d.push(v.join(""))}return d.join("")}function DE(e,r,t){var n=[],s=t.SheetNames[e],c=t.Sheets[s],h=c?CE(c,r,e,t):"";return h.length>0&&n.push("<Names>"+h+"</Names>"),h=c?IE(c,r,e,t):"",h.length>0&&n.push("<Table>"+h+"</Table>"),n.push(SE(c,r,e,t)),n.join("")}function FE(e,r){r||(r={}),e.SSF||(e.SSF=Nr(bt)),e.SSF&&(Ys(),ic(e.SSF),r.revssf=oc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],Li(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(EE(e,r)),t.push(_E()),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push(rt("Worksheet",DE(n,r,e),{"ss:Name":mr(e.SheetNames[n])}));return t[2]=AE(e,r),t[3]=bE(e),Kr+rt("Workbook",t.join(""),{xmlns:Za.ss,"xmlns:o":Za.o,"xmlns:x":Za.x,"xmlns:ss":Za.ss,"xmlns:dt":Za.dt,"xmlns:html":Za.html})}function OE(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=bg(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=Cg(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var RE=[60,1084,2066,2165,2175];function ME(e,r,t,n,s){var c=n,h=[],d=t.slice(t.l,t.l+c);if(s&&s.enc&&s.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(d)}h.push(d),t.l+=c;for(var m=ci(t,t.l),g=tl[m],v=0;g!=null&&RE.indexOf(m)>-1;)c=ci(t,t.l+2),v=t.l+4,m==2066?v+=4:(m==2165||m==2175)&&(v+=12),d=t.slice(v,t.l+4+c),h.push(d),t.l+=4+c,g=tl[m=ci(t,t.l)];var _=da(h);wa(_,0);var S=0;_.lens=[];for(var T=0;T<h.length;++T)_.lens.push(S),S+=h[T].length;if(_.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+_.length+" < "+n;return r.f(_,_.length,s)}function jn(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=bt[n])}catch(c){if(r.WTF)throw c}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||gi[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=I0(e.v):e.w=as(e.v):e.w=mn(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(c){if(r.WTF)throw c}if(r.cellDates&&n&&e.t=="n"&&zs(bt[n]||String(n))){var s=Qi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Bo(e,r,t){return{v:e,ixfe:r,t}}function PE(e,r){var t={opts:{}},n={},s=r.dense?[]:{},c={},h={},d=null,m=[],g="",v={},_,S="",T,N,C,D,U={},X=[],O,q,oe=[],J=[],M={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ie={},j=function(Ct){return Ct<8?$i[Ct]:Ct<64&&J[Ct-8]||$i[Ct]},_e=function(Ct,fr,ca){var Ft=fr.XF.data;if(!(!Ft||!Ft.patternType||!ca||!ca.cellStyles)){fr.s={},fr.s.patternType=Ft.patternType;var Qe;(Qe=M0(j(Ft.icvFore)))&&(fr.s.fgColor={rgb:Qe}),(Qe=M0(j(Ft.icvBack)))&&(fr.s.bgColor={rgb:Qe})}},he=function(Ct,fr,ca){if(!(mt>1)&&!(ca.sheetRows&&Ct.r>=ca.sheetRows)){if(ca.cellStyles&&fr.XF&&fr.XF.data&&_e(Ct,fr,ca),delete fr.ixfe,delete fr.XF,_=Ct,S=St(Ct),(!h||!h.s||!h.e)&&(h={s:{r:0,c:0},e:{r:0,c:0}}),Ct.r<h.s.r&&(h.s.r=Ct.r),Ct.c<h.s.c&&(h.s.c=Ct.c),Ct.r+1>h.e.r&&(h.e.r=Ct.r+1),Ct.c+1>h.e.c&&(h.e.c=Ct.c+1),ca.cellFormula&&fr.f){for(var Ft=0;Ft<X.length;++Ft)if(!(X[Ft][0].s.c>Ct.c||X[Ft][0].s.r>Ct.r)&&!(X[Ft][0].e.c<Ct.c||X[Ft][0].e.r<Ct.r)){fr.F=Bt(X[Ft][0]),(X[Ft][0].s.c!=Ct.c||X[Ft][0].s.r!=Ct.r)&&delete fr.f,fr.f&&(fr.f=""+Sa(X[Ft][1],h,Ct,fe,te));break}}ca.dense?(s[Ct.r]||(s[Ct.r]=[]),s[Ct.r][Ct.c]=fr):s[S]=fr}},te={enc:!1,sbcch:0,snames:[],sharedf:U,arrayf:X,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(te.password=r.password);var be,$e=[],ae=[],tt=[],Re=[],Lt=!1,fe=[];fe.SheetNames=te.snames,fe.sharedf=te.sharedf,fe.arrayf=te.arrayf,fe.names=[],fe.XTI=[];var ot=0,mt=0,K=0,ce=[],ee=[],ne;te.codepage=1200,Sn(1200);for(var le=!1;e.l<e.length-1;){var Ze=e.l,Le=e.read_shift(2);if(Le===0&&ot===10)break;var Pe=e.l===e.length?0:e.read_shift(2),Be=tl[Le];if(Be&&Be.f){if(r.bookSheets&&ot===133&&Le!==133)break;if(ot=Le,Be.r===2||Be.r==12){var Te=e.read_shift(2);if(Pe-=2,!te.enc&&Te!==Le&&((Te&255)<<8|Te>>8)!==Le)throw new Error("rt mismatch: "+Te+"!="+Le);Be.r==12&&(e.l+=10,Pe-=10)}var A={};if(Le===10?A=Be.f(e,Pe,te):A=ME(Le,Be,e,Pe,te),mt==0&&[9,521,1033,2057].indexOf(ot)===-1)continue;switch(Le){case 34:t.opts.Date1904=M.WBProps.date1904=A;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(te.enc||(e.l=0),te.enc=A,!r.password)throw new Error("File is password-protected");if(A.valid==null)throw new Error("Encryption scheme unsupported");if(!A.valid)throw new Error("Password is incorrect");break;case 92:te.lastuser=A;break;case 66:var Y=Number(A);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252;break}Sn(te.codepage=Y),le=!0;break;case 317:te.rrtabid=A;break;case 25:te.winlocked=A;break;case 439:t.opts.RefreshAll=A;break;case 12:t.opts.CalcCount=A;break;case 16:t.opts.CalcDelta=A;break;case 17:t.opts.CalcIter=A;break;case 13:t.opts.CalcMode=A;break;case 14:t.opts.CalcPrecision=A;break;case 95:t.opts.CalcSaveRecalc=A;break;case 15:te.CalcRefMode=A;break;case 2211:t.opts.FullCalc=A;break;case 129:A.fDialog&&(s["!type"]="dialog"),A.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),A.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:oe.push(A);break;case 430:fe.push([A]),fe[fe.length-1].XTI=[];break;case 35:case 547:fe[fe.length-1].push(A);break;case 24:case 536:ne={Name:A.Name,Ref:Sa(A.rgce,h,null,fe,te)},A.itab>0&&(ne.Sheet=A.itab-1),fe.names.push(ne),fe[0]||(fe[0]=[],fe[0].XTI=[]),fe[fe.length-1].push(A),A.Name=="_xlnm._FilterDatabase"&&A.itab>0&&A.rgce&&A.rgce[0]&&A.rgce[0][0]&&A.rgce[0][0][0]=="PtgArea3d"&&(ee[A.itab-1]={ref:Bt(A.rgce[0][0][1][2])});break;case 22:te.ExternCount=A;break;case 23:fe.length==0&&(fe[0]=[],fe[0].XTI=[]),fe[fe.length-1].XTI=fe[fe.length-1].XTI.concat(A),fe.XTI=fe.XTI.concat(A);break;case 2196:if(te.biff<8)break;ne!=null&&(ne.Comment=A[1]);break;case 18:s["!protect"]=A;break;case 19:A!==0&&te.WTF&&console.error("Password verifier: "+A);break;case 133:c[A.pos]=A,te.snames.push(A.name);break;case 10:{if(--mt)break;if(h.e){if(h.e.r>0&&h.e.c>0){if(h.e.r--,h.e.c--,s["!ref"]=Bt(h),r.sheetRows&&r.sheetRows<=h.e.r){var ht=h.e.r;h.e.r=r.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Bt(h),h.e.r=ht}h.e.r++,h.e.c++}$e.length>0&&(s["!merges"]=$e),ae.length>0&&(s["!objects"]=ae),tt.length>0&&(s["!cols"]=tt),Re.length>0&&(s["!rows"]=Re),M.Sheets.push(ie)}g===""?v=s:n[g]=s,s=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(te.biff===8&&(te.biff={9:2,521:3,1033:4}[Le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[A.BIFFVer]||8),te.biffguess=A.BIFFVer==0,A.BIFFVer==0&&A.dt==4096&&(te.biff=5,le=!0,Sn(te.codepage=28591)),te.biff==8&&A.BIFFVer==0&&A.dt==16&&(te.biff=2),mt++)break;if(s=r.dense?[]:{},te.biff<8&&!le&&(le=!0,Sn(te.codepage=r.codepage||1252)),te.biff<5||A.BIFFVer==0&&A.dt==4096){g===""&&(g="Sheet1"),h={s:{r:0,c:0},e:{r:0,c:0}};var lt={pos:e.l-Pe,name:g};c[lt.pos]=lt,te.snames.push(g)}else g=(c[Ze]||{name:""}).name;A.dt==32&&(s["!type"]="chart"),A.dt==64&&(s["!type"]="macro"),$e=[],ae=[],te.arrayf=X=[],tt=[],Re=[],Lt=!1,ie={Hidden:(c[Ze]||{hs:0}).hs,name:g}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(r.dense?(s[A.r]||[])[A.c]:s[St({c:A.c,r:A.r})])&&++A.c,O={ixfe:A.ixfe,XF:oe[A.ixfe]||{},v:A.val,t:"n"},K>0&&(O.z=ce[O.ixfe>>8&63]),jn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r);break;case 5:case 517:O={ixfe:A.ixfe,XF:oe[A.ixfe],v:A.val,t:A.t},K>0&&(O.z=ce[O.ixfe>>8&63]),jn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r);break;case 638:O={ixfe:A.ixfe,XF:oe[A.ixfe],v:A.rknum,t:"n"},K>0&&(O.z=ce[O.ixfe>>8&63]),jn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r);break;case 189:for(var Xe=A.c;Xe<=A.C;++Xe){var Me=A.rkrec[Xe-A.c][0];O={ixfe:Me,XF:oe[Me],v:A.rkrec[Xe-A.c][1],t:"n"},K>0&&(O.z=ce[O.ixfe>>8&63]),jn(O,r,t.opts.Date1904),he({c:Xe,r:A.r},O,r)}break;case 6:case 518:case 1030:{if(A.val=="String"){d=A;break}if(O=Bo(A.val,A.cell.ixfe,A.tt),O.XF=oe[O.ixfe],r.cellFormula){var ft=A.formula;if(ft&&ft[0]&&ft[0][0]&&ft[0][0][0]=="PtgExp"){var vt=ft[0][0][1][0],qr=ft[0][0][1][1],st=St({r:vt,c:qr});U[st]?O.f=""+Sa(A.formula,h,A.cell,fe,te):O.F=((r.dense?(s[vt]||[])[qr]:s[st])||{}).F}else O.f=""+Sa(A.formula,h,A.cell,fe,te)}K>0&&(O.z=ce[O.ixfe>>8&63]),jn(O,r,t.opts.Date1904),he(A.cell,O,r),d=A}break;case 7:case 519:if(d)d.val=A,O=Bo(A,d.cell.ixfe,"s"),O.XF=oe[O.ixfe],r.cellFormula&&(O.f=""+Sa(d.formula,h,d.cell,fe,te)),K>0&&(O.z=ce[O.ixfe>>8&63]),jn(O,r,t.opts.Date1904),he(d.cell,O,r),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{X.push(A);var wn=St(A[0].s);if(T=r.dense?(s[A[0].s.r]||[])[A[0].s.c]:s[wn],r.cellFormula&&T){if(!d||!wn||!T)break;T.f=""+Sa(A[1],h,A[0],fe,te),T.F=Bt(A[0])}}break;case 1212:{if(!r.cellFormula)break;if(S){if(!d)break;U[St(d.cell)]=A[0],T=r.dense?(s[d.cell.r]||[])[d.cell.c]:s[St(d.cell)],(T||{}).f=""+Sa(A[0],h,_,fe,te)}}break;case 253:O=Bo(m[A.isst].t,A.ixfe,"s"),m[A.isst].h&&(O.h=m[A.isst].h),O.XF=oe[O.ixfe],K>0&&(O.z=ce[O.ixfe>>8&63]),jn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r);break;case 513:r.sheetStubs&&(O={ixfe:A.ixfe,XF:oe[A.ixfe],t:"z"},K>0&&(O.z=ce[O.ixfe>>8&63]),jn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r));break;case 190:if(r.sheetStubs)for(var tn=A.c;tn<=A.C;++tn){var kr=A.ixfe[tn-A.c];O={ixfe:kr,XF:oe[kr],t:"z"},K>0&&(O.z=ce[O.ixfe>>8&63]),jn(O,r,t.opts.Date1904),he({c:tn,r:A.r},O,r)}break;case 214:case 516:case 4:O=Bo(A.val,A.ixfe,"s"),O.XF=oe[O.ixfe],K>0&&(O.z=ce[O.ixfe>>8&63]),jn(O,r,t.opts.Date1904),he({c:A.c,r:A.r},O,r);break;case 0:case 512:mt===1&&(h=A);break;case 252:m=A;break;case 1054:if(te.biff==4){ce[K++]=A[1];for(var ga=0;ga<K+163&&bt[ga]!=A[1];++ga);ga>=163&&fi(A[1],K+163)}else fi(A[1],A[0]);break;case 30:{ce[K++]=A;for(var Rr=0;Rr<K+163&&bt[Rr]!=A;++Rr);Rr>=163&&fi(A,K+163)}break;case 229:$e=$e.concat(A);break;case 93:ae[A.cmo[0]]=te.lastobj=A;break;case 438:te.lastobj.TxO=A;break;case 127:te.lastobj.ImData=A;break;case 440:for(D=A[0].s.r;D<=A[0].e.r;++D)for(C=A[0].s.c;C<=A[0].e.c;++C)T=r.dense?(s[D]||[])[C]:s[St({c:C,r:D})],T&&(T.l=A[1]);break;case 2048:for(D=A[0].s.r;D<=A[0].e.r;++D)for(C=A[0].s.c;C<=A[0].e.c;++C)T=r.dense?(s[D]||[])[C]:s[St({c:C,r:D})],T&&T.l&&(T.l.Tooltip=A[1]);break;case 28:{if(te.biff<=5&&te.biff>=2)break;T=r.dense?(s[A[0].r]||[])[A[0].c]:s[St(A[0])];var Xn=ae[A[2]];T||(r.dense?(s[A[0].r]||(s[A[0].r]=[]),T=s[A[0].r][A[0].c]={t:"z"}):T=s[St(A[0])]={t:"z"},h.e.r=Math.max(h.e.r,A[0].r),h.s.r=Math.min(h.s.r,A[0].r),h.e.c=Math.max(h.e.c,A[0].c),h.s.c=Math.min(h.s.c,A[0].c)),T.c||(T.c=[]),N={a:A[1],t:Xn.TxO.t},T.c.push(N)}break;case 2173:Aw(oe[A.ixfe],A.ext);break;case 125:{if(!te.cellStyles)break;for(;A.e>=A.s;)tt[A.e--]={width:A.w/256,level:A.level||0,hidden:!!(A.flags&1)},Lt||(Lt=!0,Fl(A.w/256)),Oi(tt[A.e+1])}break;case 520:{var Ar={};A.level!=null&&(Re[A.r]=Ar,Ar.level=A.level),A.hidden&&(Re[A.r]=Ar,Ar.hidden=!0),A.hpt&&(Re[A.r]=Ar,Ar.hpt=A.hpt,Ar.hpx=Xs(A.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||rs(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Le]]=A;break;case 161:s["!margins"]||rs(s["!margins"]={}),s["!margins"].header=A.header,s["!margins"].footer=A.footer;break;case 574:A.RTL&&(M.Views[0].RTL=!0);break;case 146:J=A;break;case 2198:be=A;break;case 140:q=A;break;case 442:g?ie.CodeName=A||ie.name:M.WBProps.CodeName=A||"ThisWorkbook";break}}else Be||console.error("Missing Info for XLS Record 0x"+Le.toString(16)),e.l+=Pe}return t.SheetNames=Hr(c).sort(function(Yt,Ct){return Number(Yt)-Number(Ct)}).map(function(Yt){return c[Yt].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&v["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=v)):t.Preamble=v,t.Sheets&&ee.forEach(function(Yt,Ct){t.Sheets[t.SheetNames[Ct]]["!autofilter"]=Yt}),t.Strings=m,t.SSF=Nr(bt),te.enc&&(t.Encryption=te.enc),be&&(t.Themes=be),t.Metadata={},q!==void 0&&(t.Metadata.Country=q),fe.names.length>0&&(M.Names=fe.names),t.Workbook=M,t}var T0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function BE(e,r,t){var n=gt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=zf(n,Kc,T0.DSI);for(var c in s)r[c]=s[c]}catch(g){if(t.WTF)throw g}var h=gt.find(e,"/!SummaryInformation");if(h&&h.size>0)try{var d=zf(h,qc,T0.SI);for(var m in d)r[m]==null&&(r[m]=d[m])}catch(g){if(t.WTF)throw g}r.HeadingPairs&&r.TitlesOfParts&&(Ch(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function LE(e,r){var t=[],n=[],s=[],c=0,h,d=_f(Kc,"n"),m=_f(qc,"n");if(e.Props)for(h=Hr(e.Props),c=0;c<h.length;++c)(Object.prototype.hasOwnProperty.call(d,h[c])?t:Object.prototype.hasOwnProperty.call(m,h[c])?n:s).push([h[c],e.Props[h[c]]]);if(e.Custprops)for(h=Hr(e.Custprops),c=0;c<h.length;++c)Object.prototype.hasOwnProperty.call(e.Props||{},h[c])||(Object.prototype.hasOwnProperty.call(d,h[c])?t:Object.prototype.hasOwnProperty.call(m,h[c])?n:s).push([h[c],e.Custprops[h[c]]]);var g=[];for(c=0;c<s.length;++c)Fh.indexOf(s[c][0])>-1||bh.indexOf(s[c][0])>-1||s[c][1]!=null&&g.push(s[c]);n.length&&gt.utils.cfb_add(r,"/SummaryInformation",Yf(n,T0.SI,m,qc)),(t.length||g.length)&&gt.utils.cfb_add(r,"/DocumentSummaryInformation",Yf(t,T0.DSI,d,Kc,g.length?g:null,T0.UDI))}function Tu(e,r){r||(r={}),Wl(r),cl(),r.codepage&&ol(r.codepage);var t,n;if(e.FullPaths){if(gt.find(e,"/encryption"))throw new Error("File is password-protected");t=gt.find(e,"!CompObj"),n=gt.find(e,"/Workbook")||gt.find(e,"/Book")}else{switch(r.type){case"base64":e=Qa(en(e));break;case"binary":e=Qa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wa(e,0),n={content:e}}var s,c;if(t&&OE(t),r.bookProps&&!r.bookSheets)s={};else{var h=Ht?"buffer":"array";if(n&&n.content)s=PE(n.content,r);else if((c=gt.find(e,"PerfectOffice_MAIN"))&&c.content)s=ts.to_workbook(c.content,(r.type=h,r));else if((c=gt.find(e,"NativeContent_MAIN"))&&c.content)s=ts.to_workbook(c.content,(r.type=h,r));else throw(c=gt.find(e,"MN0"))&&c.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&gt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Jw(e))}var d={};return e.FullPaths&&BE(e,d,r),s.Props=s.Custprops=d,r.bookFiles&&(s.cfb=e),s}function jE(e,r){var t=r||{},n=gt.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return gt.utils.cfb_add(n,s,Nu(e,t)),t.biff==8&&(e.Props||e.Custprops)&&LE(e,n),t.biff==8&&e.vbaraw&&Qw(n,gt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var j0={0:{f:ly},1:{f:py},2:{f:Py},3:{f:Cy},4:{f:Ey},5:{f:Oy},6:{f:Wy},7:{f:ky},8:{f:Ky},9:{f:Yy},10:{f:Xy},11:{f:zy},12:{f:vy},13:{f:Ly},14:{f:Ty},15:{f:Ay},16:{f:vu},17:{f:Hy},18:{f:Dy},19:{f:_l},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:H4},40:{},42:{},43:{f:Wp},44:{f:jp},45:{f:Gp},46:{f:zp},47:{f:Xp},48:{},49:{f:ug},50:{},51:{f:Sw},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Hh},62:{f:Uy},63:{f:Mw},64:{f:f4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ia,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:s4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:gy},148:{f:uy,p:16},151:{f:e4},152:{},153:{f:U4},154:{},155:{},156:{f:L4},157:{},158:{},159:{T:1,f:rp},160:{T:-1},161:{T:1,f:xs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qy},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bw},336:{T:-1},337:{f:kw,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Yc},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Vh},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:t4},427:{f:r4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:n4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:xy},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Qy},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Yc},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zw},633:{T:1},634:{T:-1},635:{T:1,f:Gw},636:{T:-1},637:{f:mg},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:T4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:h4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},tl={6:{f:jc},10:{f:ki},12:{f:ra},13:{f:ra},14:{f:zr},15:{f:zr},16:{f:Na},17:{f:zr},18:{f:zr},19:{f:ra},20:{f:$f},21:{f:$f},23:{f:Vh},24:{f:t1},25:{f:zr},26:{},27:{},28:{f:hm},29:{},34:{f:zr},35:{f:e1},38:{f:Na},39:{f:Na},40:{f:Na},41:{f:Na},42:{f:zr},43:{f:zr},47:{f:Ap},49:{f:L2},51:{f:ra},60:{},61:{f:O2},64:{f:zr},65:{f:B2},66:{f:ra},77:{},80:{},81:{},82:{},85:{f:ra},89:{},90:{},91:{},92:{f:_2},93:{f:xm},94:{},95:{f:zr},96:{},97:{},99:{f:zr},125:{f:Hh},128:{f:$2},129:{f:b2},130:{f:ra},131:{f:zr},132:{f:zr},133:{f:C2},134:{},140:{f:_m},141:{f:ra},144:{},146:{f:Cm},151:{},152:{},153:{},154:{},155:{},156:{f:ra},157:{},158:{},160:{f:Fm},161:{f:Nm},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:q2},190:{f:Z2},193:{f:ki},197:{},198:{},199:{},200:{},201:{},202:{f:zr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ra},220:{},221:{f:zr},222:{},224:{f:Q2},225:{f:E2},226:{f:ki},227:{},229:{f:um},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:T2},253:{f:U2},255:{f:k2},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Oh},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zr},353:{f:ki},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:nm},431:{f:zr},432:{},433:{},434:{},437:{},438:{f:pm},439:{f:zr},440:{f:wm},441:{},442:{f:X0},443:{},444:{f:ra},445:{},446:{},448:{f:ki},449:{f:F2,r:2},450:{f:ki},512:{f:Zf},513:{f:Dm},515:{f:rm},516:{f:V2},517:{f:Qf},519:{f:Om},520:{f:I2},523:{},545:{f:r1},549:{f:qf},566:{},574:{f:M2},638:{f:K2},659:{},1048:{},1054:{f:G2},1084:{},1212:{f:cm},2048:{f:ym},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ro},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ki},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Sm,r:12},2173:{f:_w,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:om,r:12},2197:{},2198:{f:mw,r:12},2199:{},2200:{},2201:{},2202:{f:lm,r:12},2203:{f:ki},2204:{},2205:{},2206:{},2207:{},2211:{f:D2},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ra},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:km},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:bm},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Zf},1:{},2:{f:Lm},3:{f:Pm},4:{f:Mm},5:{f:Qf},7:{f:Um},8:{},9:{f:Ro},11:{},22:{f:ra},30:{f:z2},31:{},32:{},33:{f:r1},36:{},37:{f:qf},50:{f:Wm},62:{},52:{},67:{},68:{f:ra},69:{},86:{},126:{},127:{f:Rm},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Vm},223:{},234:{},354:{},421:{},518:{f:jc},521:{f:Ro},536:{f:t1},547:{f:e1},561:{},579:{},1030:{f:jc},1033:{f:Ro},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function at(e,r,t,n){var s=r;if(!isNaN(s)){var c=n||(t||[]).length||0,h=e.next(4);h.write_shift(2,s),h.write_shift(2,c),c>0&&vl(t)&&e.push(t)}}function UE(e,r,t,n){var s=(t||[]).length||0;if(s<=8224)return at(e,r,t,s);var c=r;if(!isNaN(c)){for(var h=t.parts||[],d=0,m=0,g=0;g+(h[d]||8224)<=8224;)g+=h[d]||8224,d++;var v=e.next(4);for(v.write_shift(2,c),v.write_shift(2,g),e.push(t.slice(m,m+g)),m+=g;m<s;){for(v=e.next(4),v.write_shift(2,60),g=0;g+(h[d]||8224)<=8224;)g+=h[d]||8224,d++;v.write_shift(2,g),e.push(t.slice(m,m+g)),m+=g}}}function q0(e,r,t){return e||(e=Oe(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function WE(e,r,t,n){var s=Oe(9);return q0(s,e,r),Rh(t,n||"b",s),s}function VE(e,r,t){var n=Oe(8+2*t.length);return q0(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function HE(e,r,t,n){if(r.v!=null)switch(r.t){case"d":case"n":var s=r.t=="d"?oa(Tr(r.v)):r.v;s==(s|0)&&s>=0&&s<65536?at(e,2,jm(t,n,s)):at(e,3,Bm(t,n,s));return;case"b":case"e":at(e,5,WE(t,n,r.v,r.t));return;case"s":case"str":at(e,4,VE(t,n,(r.v||"").slice(0,255)));return}at(e,1,q0(null,t,n))}function GE(e,r,t,n){var s=Array.isArray(r),c=ar(r["!ref"]||"A1"),h,d="",m=[];if(c.e.c>255||c.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),h=Bt(c)}for(var g=c.s.r;g<=c.e.r;++g){d=Yr(g);for(var v=c.s.c;v<=c.e.c;++v){g===c.s.r&&(m[v]=Br(v)),h=m[v]+d;var _=s?(r[g]||[])[v]:r[h];_&&HE(e,_,g,v)}}}function XE(e,r){for(var t=r||{},n=Va(),s=0,c=0;c<e.SheetNames.length;++c)e.SheetNames[c]==t.sheet&&(s=c);if(s==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return at(n,t.biff==4?1033:t.biff==3?521:9,kl(e,16,t)),GE(n,e.Sheets[e.SheetNames[s]],s,t),at(n,10),n.end()}function zE(e,r,t){at(e,49,j2({sz:12,name:"Arial"},t))}function YE(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&at(e,1054,X2(s,r[s],t))})}function KE(e,r){var t=Oe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),at(e,2151,t),t=Oe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),jh(ar(r["!ref"]||"A1"),t),t.write_shift(4,4),at(e,2152,t)}function qE(e,r){for(var t=0;t<16;++t)at(e,224,Jf({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){at(e,224,Jf(n,0,r))})}function ZE(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];at(e,440,vm(n)),n[1].Tooltip&&at(e,2048,Em(n))}delete r["!links"]}function JE(e,r){if(r){var t=0;r.forEach(function(n,s){++t<=256&&n&&at(e,125,Tm(uc(s,n),s))})}}function QE(e,r,t,n,s){var c=16+Li(s.cellXfs,r,s);if(r.v==null&&!r.bf){at(e,513,os(t,n,c));return}if(r.bf)at(e,6,b3(r,t,n,s,c));else switch(r.t){case"d":case"n":var h=r.t=="d"?oa(Tr(r.v)):r.v;at(e,515,am(t,n,h,c));break;case"b":case"e":at(e,517,tm(t,n,r.v,c,s,r.t));break;case"s":case"str":if(s.bookSST){var d=Bl(s.Strings,r.v,s.revStrings);at(e,253,W2(t,n,d,c))}else at(e,516,H2(t,n,(r.v||"").slice(0,255),c,s));break;default:at(e,513,os(t,n,c))}}function $E(e,r,t){var n=Va(),s=t.SheetNames[e],c=t.Sheets[s]||{},h=(t||{}).Workbook||{},d=(h.Sheets||[])[e]||{},m=Array.isArray(c),g=r.biff==8,v,_="",S=[],T=ar(c["!ref"]||"A1"),N=g?65536:16384;if(T.e.c>255||T.e.r>=N){if(r.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,N-1)}at(n,2057,kl(t,16,r)),at(n,13,xn(1)),at(n,12,xn(100)),at(n,15,Ba(!0)),at(n,17,Ba(!1)),at(n,16,is(.001)),at(n,95,Ba(!0)),at(n,42,Ba(!1)),at(n,43,Ba(!1)),at(n,130,xn(1)),at(n,128,em()),at(n,131,Ba(!1)),at(n,132,Ba(!1)),g&&JE(n,c["!cols"]),at(n,512,Y2(T,r)),g&&(c["!links"]=[]);for(var C=T.s.r;C<=T.e.r;++C){_=Yr(C);for(var D=T.s.c;D<=T.e.c;++D){C===T.s.r&&(S[D]=Br(D)),v=S[D]+_;var U=m?(c[C]||[])[D]:c[v];U&&(QE(n,U,C,D,r),g&&U.l&&c["!links"].push([v,U.l]))}}var X=d.CodeName||d.name||s;return g&&at(n,574,P2((h.Views||[])[0])),g&&(c["!merges"]||[]).length&&at(n,229,dm(c["!merges"])),g&&ZE(n,c),at(n,442,Mh(X)),g&&KE(n,c),at(n,10),n.end()}function e_(e,r,t){var n=Va(),s=(e||{}).Workbook||{},c=s.Sheets||[],h=s.WBProps||{},d=t.biff==8,m=t.biff==5;if(at(n,2057,kl(e,5,t)),t.bookType=="xla"&&at(n,135),at(n,225,d?xn(1200):null),at(n,193,t2(2)),m&&at(n,191),m&&at(n,192),at(n,226),at(n,92,A2("SheetJS",t)),at(n,66,xn(d?1200:1252)),d&&at(n,353,xn(0)),d&&at(n,448),at(n,317,Im(e.SheetNames.length)),d&&e.vbaraw&&at(n,211),d&&e.vbaraw){var g=h.CodeName||"ThisWorkbook";at(n,442,Mh(g))}at(n,156,xn(17)),at(n,25,Ba(!1)),at(n,18,Ba(!1)),at(n,19,xn(0)),d&&at(n,431,Ba(!1)),d&&at(n,444,xn(0)),at(n,61,R2()),at(n,64,Ba(!1)),at(n,141,xn(0)),at(n,34,Ba(F4(e)=="true")),at(n,14,Ba(!0)),d&&at(n,439,Ba(!1)),at(n,218,xn(0)),zE(n,e,t),YE(n,e.SSF,t),qE(n,t),d&&at(n,352,Ba(!1));var v=n.end(),_=Va();d&&at(_,140,Am()),d&&t.Strings&&UE(_,252,N2(t.Strings)),at(_,10);var S=_.end(),T=Va(),N=0,C=0;for(C=0;C<e.SheetNames.length;++C)N+=(d?12:11)+(d?2:1)*e.SheetNames[C].length;var D=v.length+N+S.length;for(C=0;C<e.SheetNames.length;++C){var U=c[C]||{};at(T,133,S2({pos:D,hs:U.Hidden||0,dt:0,name:e.SheetNames[C]},t)),D+=r[C].length}var X=T.end();if(N!=X.length)throw new Error("BS8 "+N+" != "+X.length);var O=[];return v.length&&O.push(v),X.length&&O.push(X),S.length&&O.push(S),da(O)}function t_(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=Nr(bt)),e&&e.SSF&&(Ys(),ic(e.SSF),t.revssf=oc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Vl(t),t.cellXfs=[],Li(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=$E(s,t,e);return n.unshift(e_(e,n,t)),da(n)}function Nu(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var s=Ha(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var c=r||{};switch(c.biff||2){case 8:case 5:return t_(e,r);case 4:case 3:case 2:return XE(e,r)}throw new Error("invalid type "+c.bookType+" for BIFF")}function u1(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var c=e.match(/<\/table/i),h=s.index,d=c&&c.index||e.length,m=jx(e.slice(h,d),/(:?<tr[^>]*>)/i,"<tr>"),g=-1,v=0,_=0,S=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},N=[];for(h=0;h<m.length;++h){var C=m[h].trim(),D=C.slice(0,3).toLowerCase();if(D=="<tr"){if(++g,t.sheetRows&&t.sheetRows<=g){--g;break}v=0;continue}if(!(D!="<td"&&D!="<th")){var U=C.split(/<\/t[dh]>/i);for(d=0;d<U.length;++d){var X=U[d].trim();if(X.match(/<t[dh]/i)){for(var O=X,q=0;O.charAt(0)=="<"&&(q=O.indexOf(">"))>-1;)O=O.slice(q+1);for(var oe=0;oe<N.length;++oe){var J=N[oe];J.s.c==v&&J.s.r<g&&g<=J.e.r&&(v=J.e.c+1,oe=-1)}var M=Tt(X.slice(0,X.indexOf(">")));S=M.colspan?+M.colspan:1,((_=+M.rowspan)>1||S>1)&&N.push({s:{r:g,c:v},e:{r:g+(_||1)-1,c:v+S-1}});var ie=M.t||M["data-t"]||"";if(!O.length){v+=S;continue}if(O=Q1(O),T.s.r>g&&(T.s.r=g),T.e.r<g&&(T.e.r=g),T.s.c>v&&(T.s.c=v),T.e.c<v&&(T.e.c=v),!O.length){v+=S;continue}var j={t:"s",v:O};t.raw||!O.trim().length||ie=="s"||(O==="TRUE"?j={t:"b",v:!0}:O==="FALSE"?j={t:"b",v:!1}:isNaN(Nn(O))?isNaN(Hs(O).getDate())||(j={t:"d",v:Tr(O)},t.cellDates||(j={t:"n",v:oa(j.v)}),j.z=t.dateNF||bt[14]):j={t:"n",v:Nn(O)}),t.dense?(n[g]||(n[g]=[]),n[g][v]=j):n[St({r:g,c:v})]=j,v+=S}}}}return n["!ref"]=Bt(T),N.length&&(n["!merges"]=N),n}function r_(e,r,t,n){for(var s=e["!merges"]||[],c=[],h=r.s.c;h<=r.e.c;++h){for(var d=0,m=0,g=0;g<s.length;++g)if(!(s[g].s.r>t||s[g].s.c>h)&&!(s[g].e.r<t||s[g].e.c<h)){if(s[g].s.r<t||s[g].s.c<h){d=-1;break}d=s[g].e.r-s[g].s.r+1,m=s[g].e.c-s[g].s.c+1;break}if(!(d<0)){var v=St({r:t,c:h}),_=n.dense?(e[t]||[])[h]:e[v],S=_&&_.v!=null&&(_.h||ml(_.w||(ui(_),_.w)||""))||"",T={};d>1&&(T.rowspan=d),m>1&&(T.colspan=m),n.editable?S='<span contenteditable="true">'+S+"</span>":_&&(T["data-t"]=_&&_.t||"z",_.v!=null&&(T["data-v"]=_.v),_.z!=null&&(T["data-z"]=_.z),_.l&&(_.l.Target||"#").charAt(0)!="#"&&(S='<a href="'+_.l.Target+'">'+S+"</a>")),T.id=(n.id||"sjs")+"-"+v,c.push(rt("td",S,T))}}var N="<tr>";return N+c.join("")+"</tr>"}var a_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',n_="</body></html>";function i_(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Bi(u1(t[0],r),r);var n=Xl();return t.forEach(function(s,c){zl(n,u1(s,r),"Sheet"+(c+1))}),n}function s_(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function ku(e,r){var t=r||{},n=t.header!=null?t.header:a_,s=t.footer!=null?t.footer:n_,c=[n],h=Ha(e["!ref"]);t.dense=Array.isArray(e),c.push(s_(e,h,t));for(var d=h.s.r;d<=h.e.r;++d)c.push(r_(e,h,d,t));return c.push("</table>"+s),c.join("")}function Iu(e,r,t){var n=t||{},s=0,c=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var h=typeof n.origin=="string"?Lr(n.origin):n.origin;s=h.r,c=h.c}var d=r.getElementsByTagName("tr"),m=Math.min(n.sheetRows||1e7,d.length),g={s:{r:0,c:0},e:{r:s,c}};if(e["!ref"]){var v=Ha(e["!ref"]);g.s.r=Math.min(g.s.r,v.s.r),g.s.c=Math.min(g.s.c,v.s.c),g.e.r=Math.max(g.e.r,v.e.r),g.e.c=Math.max(g.e.c,v.e.c),s==-1&&(g.e.r=s=v.e.r+1)}var _=[],S=0,T=e["!rows"]||(e["!rows"]=[]),N=0,C=0,D=0,U=0,X=0,O=0;for(e["!cols"]||(e["!cols"]=[]);N<d.length&&C<m;++N){var q=d[N];if(d1(q)){if(n.display)continue;T[C]={hidden:!0}}var oe=q.children;for(D=U=0;D<oe.length;++D){var J=oe[D];if(!(n.display&&d1(J))){var M=J.hasAttribute("data-v")?J.getAttribute("data-v"):J.hasAttribute("v")?J.getAttribute("v"):Q1(J.innerHTML),ie=J.getAttribute("data-z")||J.getAttribute("z");for(S=0;S<_.length;++S){var j=_[S];j.s.c==U+c&&j.s.r<C+s&&C+s<=j.e.r&&(U=j.e.c+1-c,S=-1)}O=+J.getAttribute("colspan")||1,((X=+J.getAttribute("rowspan")||1)>1||O>1)&&_.push({s:{r:C+s,c:U+c},e:{r:C+s+(X||1)-1,c:U+c+(O||1)-1}});var _e={t:"s",v:M},he=J.getAttribute("data-t")||J.getAttribute("t")||"";M!=null&&(M.length==0?_e.t=he||"z":n.raw||M.trim().length==0||he=="s"||(M==="TRUE"?_e={t:"b",v:!0}:M==="FALSE"?_e={t:"b",v:!1}:isNaN(Nn(M))?isNaN(Hs(M).getDate())||(_e={t:"d",v:Tr(M)},n.cellDates||(_e={t:"n",v:oa(_e.v)}),_e.z=n.dateNF||bt[14]):_e={t:"n",v:Nn(M)})),_e.z===void 0&&ie!=null&&(_e.z=ie);var te="",be=J.getElementsByTagName("A");if(be&&be.length)for(var $e=0;$e<be.length&&!(be[$e].hasAttribute("href")&&(te=be[$e].getAttribute("href"),te.charAt(0)!="#"));++$e);te&&te.charAt(0)!="#"&&(_e.l={Target:te}),n.dense?(e[C+s]||(e[C+s]=[]),e[C+s][U+c]=_e):e[St({c:U+c,r:C+s})]=_e,g.e.c<U+c&&(g.e.c=U+c),U+=O}}++C}return _.length&&(e["!merges"]=(e["!merges"]||[]).concat(_)),g.e.r=Math.max(g.e.r,C-1+s),e["!ref"]=Bt(g),C>=m&&(e["!fullref"]=Bt((g.e.r=d.length-N+C-1+s,g))),e}function Du(e,r){var t=r||{},n=t.dense?[]:{};return Iu(n,e,r)}function o_(e,r){return Bi(Du(e,r),r)}function d1(e){var r="",t=c_(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function c_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function l_(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=rr(r.replace(/<[^>]*>/g,""));return[t]}var x1={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Fu(e,r){var t=r||{},n=pl(e),s=[],c,h,d={name:""},m="",g=0,v,_,S={},T=[],N=t.dense?[]:{},C,D,U={value:""},X="",O=0,q=[],oe=-1,J=-1,M={s:{r:1e6,c:1e7},e:{r:0,c:0}},ie=0,j={},_e=[],he={},te=0,be=0,$e=[],ae=1,tt=1,Re=[],Lt={Names:[]},fe={},ot=["",""],mt=[],K={},ce="",ee=0,ne=!1,le=!1,Ze=0;for(O0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");C=O0.exec(n);)switch(C[3]=C[3].replace(/_.*$/,"")){case"table":case"工作表":C[1]==="/"?(M.e.c>=M.s.c&&M.e.r>=M.s.r?N["!ref"]=Bt(M):N["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=M.e.r&&(N["!fullref"]=N["!ref"],M.e.r=t.sheetRows-1,N["!ref"]=Bt(M)),_e.length&&(N["!merges"]=_e),$e.length&&(N["!rows"]=$e),v.name=v.名称||v.name,typeof JSON<"u"&&JSON.stringify(v),T.push(v.name),S[v.name]=N,le=!1):C[0].charAt(C[0].length-2)!=="/"&&(v=Tt(C[0],!1),oe=J=-1,M.s.r=M.s.c=1e7,M.e.r=M.e.c=0,N=t.dense?[]:{},_e=[],$e=[],le=!0);break;case"table-row-group":C[1]==="/"?--ie:++ie;break;case"table-row":case"行":if(C[1]==="/"){oe+=ae,ae=1;break}if(_=Tt(C[0],!1),_.行号?oe=_.行号-1:oe==-1&&(oe=0),ae=+_["number-rows-repeated"]||1,ae<10)for(Ze=0;Ze<ae;++Ze)ie>0&&($e[oe+Ze]={level:ie});J=-1;break;case"covered-table-cell":C[1]!=="/"&&++J,t.sheetStubs&&(t.dense?(N[oe]||(N[oe]=[]),N[oe][J]={t:"z"}):N[St({r:oe,c:J})]={t:"z"}),X="",q=[];break;case"table-cell":case"数据":if(C[0].charAt(C[0].length-2)==="/")++J,U=Tt(C[0],!1),tt=parseInt(U["number-columns-repeated"]||"1",10),D={t:"z",v:null},U.formula&&t.cellFormula!=!1&&(D.f=l1(rr(U.formula))),(U.数据类型||U["value-type"])=="string"&&(D.t="s",D.v=rr(U["string-value"]||""),t.dense?(N[oe]||(N[oe]=[]),N[oe][J]=D):N[St({r:oe,c:J})]=D),J+=tt-1;else if(C[1]!=="/"){++J,X="",O=0,q=[],tt=1;var Le=ae?oe+ae-1:oe;if(J>M.e.c&&(M.e.c=J),J<M.s.c&&(M.s.c=J),oe<M.s.r&&(M.s.r=oe),Le>M.e.r&&(M.e.r=Le),U=Tt(C[0],!1),mt=[],K={},D={t:U.数据类型||U["value-type"],v:null},t.cellFormula)if(U.formula&&(U.formula=rr(U.formula)),U["number-matrix-columns-spanned"]&&U["number-matrix-rows-spanned"]&&(te=parseInt(U["number-matrix-rows-spanned"],10)||0,be=parseInt(U["number-matrix-columns-spanned"],10)||0,he={s:{r:oe,c:J},e:{r:oe+te-1,c:J+be-1}},D.F=Bt(he),Re.push([he,D.F])),U.formula)D.f=l1(U.formula);else for(Ze=0;Ze<Re.length;++Ze)oe>=Re[Ze][0].s.r&&oe<=Re[Ze][0].e.r&&J>=Re[Ze][0].s.c&&J<=Re[Ze][0].e.c&&(D.F=Re[Ze][1]);switch((U["number-columns-spanned"]||U["number-rows-spanned"])&&(te=parseInt(U["number-rows-spanned"],10)||0,be=parseInt(U["number-columns-spanned"],10)||0,he={s:{r:oe,c:J},e:{r:oe+te-1,c:J+be-1}},_e.push(he)),U["number-columns-repeated"]&&(tt=parseInt(U["number-columns-repeated"],10)),D.t){case"boolean":D.t="b",D.v=Sr(U["boolean-value"]);break;case"float":D.t="n",D.v=parseFloat(U.value);break;case"percentage":D.t="n",D.v=parseFloat(U.value);break;case"currency":D.t="n",D.v=parseFloat(U.value);break;case"date":D.t="d",D.v=Tr(U["date-value"]),t.cellDates||(D.t="n",D.v=oa(D.v)),D.z="m/d/yy";break;case"time":D.t="n",D.v=Px(U["time-value"])/86400,t.cellDates&&(D.t="d",D.v=cc(D.v)),D.z="HH:MM:SS";break;case"number":D.t="n",D.v=parseFloat(U.数据数值);break;default:if(D.t==="string"||D.t==="text"||!D.t)D.t="s",U["string-value"]!=null&&(X=rr(U["string-value"]),q=[]);else throw new Error("Unsupported value type "+D.t)}}else{if(ne=!1,D.t==="s"&&(D.v=X||"",q.length&&(D.R=q),ne=O==0),fe.Target&&(D.l=fe),mt.length>0&&(D.c=mt,mt=[]),X&&t.cellText!==!1&&(D.w=X),ne&&(D.t="z",delete D.v),(!ne||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=oe))for(var Pe=0;Pe<ae;++Pe){if(tt=parseInt(U["number-columns-repeated"]||"1",10),t.dense)for(N[oe+Pe]||(N[oe+Pe]=[]),N[oe+Pe][J]=Pe==0?D:Nr(D);--tt>0;)N[oe+Pe][J+tt]=Nr(D);else for(N[St({r:oe+Pe,c:J})]=D;--tt>0;)N[St({r:oe+Pe,c:J+tt})]=Nr(D);M.e.c<=J&&(M.e.c=J)}tt=parseInt(U["number-columns-repeated"]||"1",10),J+=tt-1,tt=0,D={},X="",q=[]}fe={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(C[1]==="/"){if((c=s.pop())[0]!==C[3])throw"Bad state: "+c}else C[0].charAt(C[0].length-2)!=="/"&&s.push([C[3],!0]);break;case"annotation":if(C[1]==="/"){if((c=s.pop())[0]!==C[3])throw"Bad state: "+c;K.t=X,q.length&&(K.R=q),K.a=ce,mt.push(K)}else C[0].charAt(C[0].length-2)!=="/"&&s.push([C[3],!1]);ce="",ee=0,X="",O=0,q=[];break;case"creator":C[1]==="/"?ce=n.slice(ee,C.index):ee=C.index+C[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(C[1]==="/"){if((c=s.pop())[0]!==C[3])throw"Bad state: "+c}else C[0].charAt(C[0].length-2)!=="/"&&s.push([C[3],!1]);X="",O=0,q=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(C[1]==="/"){if(j[d.name]=m,(c=s.pop())[0]!==C[3])throw"Bad state: "+c}else C[0].charAt(C[0].length-2)!=="/"&&(m="",d=Tt(C[0],!1),s.push([C[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":h=Tt(C[0],!1),m+=x1[C[3]][h.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":h=Tt(C[0],!1),m+=x1[C[3]][h.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(C[0].slice(-2)==="/>")break;if(C[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":m+=n.slice(g,C.index);break}else g=C.index+C[0].length;break;case"named-range":h=Tt(C[0],!1),ot=Uc(h["cell-range-address"]);var Be={Name:h.name,Ref:ot[0]+"!"+ot[1]};le&&(Be.Sheet=T.length),Lt.Names.push(Be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(C[1]==="/"&&(!U||!U["string-value"])){var Te=l_(n.slice(O,C.index));X=(X.length>0?X+`
`:"")+Te[0]}else Tt(C[0],!1),O=C.index+C[0].length;break;case"s":break;case"database-range":if(C[1]==="/")break;try{ot=Uc(Tt(C[0])["target-range-address"]),S[ot[0]]["!autofilter"]={ref:ot[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(C[1]!=="/"){if(fe=Tt(C[0],!1),!fe.href)break;fe.Target=rr(fe.href),delete fe.href,fe.Target.charAt(0)=="#"&&fe.Target.indexOf(".")>-1?(ot=Uc(fe.Target.slice(1)),fe.Target="#"+ot[0]+"!"+ot[1]):fe.Target.match(/^\.\.[\\\/]/)&&(fe.Target=fe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(C[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(C)}}var A={Sheets:S,SheetNames:T,Workbook:Lt};return t.bookSheets&&delete A.Sheets,A}function g1(e,r){r=r||{},dn(e,"META-INF/manifest.xml")&&Pg(ta(e,"META-INF/manifest.xml"),r);var t=$a(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=Fu(vr(t),r);return dn(e,"meta.xml")&&(n.Props=_h(ta(e,"meta.xml"))),n}function m1(e,r){return Fu(e,r)}var f_=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+F0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Kr+r}}(),p1=function(){var e=function(c){return mr(c).replace(/  +/g,function(h){return'<text:s text:c="'+h.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(c,h,d){var m=[];m.push('      <table:table table:name="'+mr(h.SheetNames[d])+`" table:style-name="ta1">
`);var g=0,v=0,_=Ha(c["!ref"]||"A1"),S=c["!merges"]||[],T=0,N=Array.isArray(c);if(c["!cols"])for(v=0;v<=_.e.c;++v)m.push("        <table:table-column"+(c["!cols"][v]?' table:style-name="co'+c["!cols"][v].ods+'"':"")+`></table:table-column>
`);var C="",D=c["!rows"]||[];for(g=0;g<_.s.r;++g)C=D[g]?' table:style-name="ro'+D[g].ods+'"':"",m.push("        <table:table-row"+C+`></table:table-row>
`);for(;g<=_.e.r;++g){for(C=D[g]?' table:style-name="ro'+D[g].ods+'"':"",m.push("        <table:table-row"+C+`>
`),v=0;v<_.s.c;++v)m.push(r);for(;v<=_.e.c;++v){var U=!1,X={},O="";for(T=0;T!=S.length;++T)if(!(S[T].s.c>v)&&!(S[T].s.r>g)&&!(S[T].e.c<v)&&!(S[T].e.r<g)){(S[T].s.c!=v||S[T].s.r!=g)&&(U=!0),X["table:number-columns-spanned"]=S[T].e.c-S[T].s.c+1,X["table:number-rows-spanned"]=S[T].e.r-S[T].s.r+1;break}if(U){m.push(t);continue}var q=St({r:g,c:v}),oe=N?(c[g]||[])[v]:c[q];if(oe&&oe.f&&(X["table:formula"]=mr(I3(oe.f)),oe.F&&oe.F.slice(0,q.length)==q)){var J=Ha(oe.F);X["table:number-matrix-columns-spanned"]=J.e.c-J.s.c+1,X["table:number-matrix-rows-spanned"]=J.e.r-J.s.r+1}if(!oe){m.push(r);continue}switch(oe.t){case"b":O=oe.v?"TRUE":"FALSE",X["office:value-type"]="boolean",X["office:boolean-value"]=oe.v?"true":"false";break;case"n":O=oe.w||String(oe.v||0),X["office:value-type"]="float",X["office:value"]=oe.v||0;break;case"s":case"str":O=oe.v==null?"":oe.v,X["office:value-type"]="string";break;case"d":O=oe.w||Tr(oe.v).toISOString(),X["office:value-type"]="date",X["office:date-value"]=Tr(oe.v).toISOString(),X["table:style-name"]="ce1";break;default:m.push(r);continue}var M=e(O);if(oe.l&&oe.l.Target){var ie=oe.l.Target;ie=ie.charAt(0)=="#"?"#"+D3(ie.slice(1)):ie,ie.charAt(0)!="#"&&!ie.match(/^\w+:/)&&(ie="../"+ie),M=rt("text:a",M,{"xlink:href":ie.replace(/&/g,"&amp;")})}m.push("          "+rt("table:table-cell",rt("text:p",M,{}),X)+`
`)}m.push(`        </table:table-row>
`)}return m.push(`      </table:table>
`),m.join("")},s=function(c,h){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var d=0;h.SheetNames.map(function(g){return h.Sheets[g]}).forEach(function(g){if(g&&g["!cols"]){for(var v=0;v<g["!cols"].length;++v)if(g["!cols"][v]){var _=g["!cols"][v];if(_.width==null&&_.wpx==null&&_.wch==null)continue;Oi(_),_.ods=d;var S=g["!cols"][v].wpx+"px";c.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+S+`"/>
`),c.push(`  </style:style>
`),++d}}});var m=0;h.SheetNames.map(function(g){return h.Sheets[g]}).forEach(function(g){if(g&&g["!rows"]){for(var v=0;v<g["!rows"].length;++v)if(g["!rows"][v]){g["!rows"][v].ods=m;var _=g["!rows"][v].hpx+"px";c.push('  <style:style style:name="ro'+m+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+_+`"/>
`),c.push(`  </style:style>
`),++m}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(h,d){var m=[Kr],g=F0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),v=F0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(m.push("<office:document"+g+v+`>
`),m.push(Eh().replace(/office:document-meta/g,"office:meta"))):m.push("<office:document-content"+g+`>
`),s(m,h),m.push(`  <office:body>
`),m.push(`    <office:spreadsheet>
`);for(var _=0;_!=h.SheetNames.length;++_)m.push(n(h.Sheets[h.SheetNames[_]],h,_));return m.push(`    </office:spreadsheet>
`),m.push(`  </office:body>
`),d.bookType=="fods"?m.push("</office:document>"):m.push("</office:document-content>"),m.join("")}}();function Ou(e,r){if(r.bookType=="fods")return p1(e,r);var t=dl(),n="",s=[],c=[];return n="mimetype",Vt(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Vt(t,n,p1(e,r)),s.push([n,"text/xml"]),c.push([n,"ContentFile"]),n="styles.xml",Vt(t,n,f_(e,r)),s.push([n,"text/xml"]),c.push([n,"StylesFile"]),n="meta.xml",Vt(t,n,Kr+Eh()),s.push([n,"text/xml"]),c.push([n,"MetadataFile"]),n="manifest.rdf",Vt(t,n,jg(c)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Vt(t,n,Bg(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function cs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rl(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):vr(Pi(e))}function h_(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Qa(Vn(e))}function u_(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var n=0;n<r.length;++n)if(e[t+n]!=r[n])continue e;return!0}return!1}function Mi(e){var r=e.reduce(function(s,c){return s+c.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(s){t.set(s,n),n+=s.length}),t}function w1(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function d_(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,s=r+13;s>=r;--s)n=n*256+e[s];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function x_(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var c=0;s>=1;++c,s/=256)e[r+c]=s&255;e[r+15]|=t>=0?0:128}function U0(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function xr(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function Vr(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function sr(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],s=U0(e,t),c=s&7;s=Math.floor(s/8);var h=0,d;if(s==0)break;switch(c){case 0:{for(var m=t[0];e[t[0]++]>=128;);d=e.slice(m,t[0])}break;case 5:h=4,d=e.slice(t[0],t[0]+h),t[0]+=h;break;case 1:h=8,d=e.slice(t[0],t[0]+h),t[0]+=h;break;case 2:h=U0(e,t),d=e.slice(t[0],t[0]+h),t[0]+=h;break;case 3:case 4:default:throw new Error("PB Type ".concat(c," for Field ").concat(s," at offset ").concat(n))}var g={data:d,type:c};r[s]==null?r[s]=[g]:r[s].push(g)}return r}function pa(e){var r=[];return e.forEach(function(t,n){t.forEach(function(s){s.data&&(r.push(xr(n*8+s.type)),s.type==2&&r.push(xr(s.data.length)),r.push(s.data))})}),Mi(r)}function Ul(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function hn(e){for(var r,t=[],n=[0];n[0]<e.length;){var s=U0(e,n),c=sr(e.slice(n[0],n[0]+s));n[0]+=s;var h={id:Vr(c[1][0].data),messages:[]};c[2].forEach(function(d){var m=sr(d.data),g=Vr(m[3][0].data);h.messages.push({meta:m,data:e.slice(n[0],n[0]+g)}),n[0]+=g}),(r=c[3])!=null&&r[0]&&(h.merge=Vr(c[3][0].data)>>>0>0),t.push(h)}return t}function Rs(e){var r=[];return e.forEach(function(t){var n=[];n[1]=[{data:xr(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:xr(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(h){s.push(h.data),h.meta[3]=[{type:0,data:xr(h.data.length)}],n[2].push({data:pa(h.meta),type:2})});var c=pa(n);r.push(xr(c.length)),r.push(c),s.forEach(function(h){return r.push(h)})}),Mi(r)}function g_(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=U0(r,t),s=[];t[0]<r.length;){var c=r[t[0]]&3;if(c==0){var h=r[t[0]++]>>2;if(h<60)++h;else{var d=h-59;h=r[t[0]],d>1&&(h|=r[t[0]+1]<<8),d>2&&(h|=r[t[0]+2]<<16),d>3&&(h|=r[t[0]+3]<<24),h>>>=0,h++,t[0]+=d}s.push(r.slice(t[0],t[0]+h)),t[0]+=h;continue}else{var m=0,g=0;if(c==1?(g=(r[t[0]]>>2&7)+4,m=(r[t[0]++]&224)<<3,m|=r[t[0]++]):(g=(r[t[0]++]>>2)+1,c==2?(m=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(m=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),s=[Mi(s)],m==0)throw new Error("Invalid offset 0");if(m>s[0].length)throw new Error("Invalid offset beyond length");if(g>=m)for(s.push(s[0].slice(-m)),g-=m;g>=s[s.length-1].length;)s.push(s[s.length-1]),g-=s[s.length-1].length;s.push(s[0].slice(-m,-m+g))}}var v=Mi(s);if(v.length!=n)throw new Error("Unexpected length: ".concat(v.length," != ").concat(n));return v}function un(e){for(var r=[],t=0;t<e.length;){var n=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(g_(n,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Mi(r)}function Ms(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),s=new Uint8Array(4);r.push(s);var c=xr(n),h=c.length;r.push(c),n<=60?(h++,r.push(new Uint8Array([n-1<<2]))):n<=256?(h+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(h+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(h+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(h+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e.slice(t,t+n)),h+=n,s[0]=0,s[1]=h&255,s[2]=h>>8&255,s[3]=h>>16&255,t+=n}return Mi(r)}function m_(e,r,t,n){var s=cs(e),c=s.getUint32(4,!0),h=(n>1?12:8)+w1(c&(n>1?3470:398))*4,d=-1,m=-1,g=NaN,v=new Date(2001,0,1);c&512&&(d=s.getUint32(h,!0),h+=4),h+=w1(c&(n>1?12288:4096))*4,c&16&&(m=s.getUint32(h,!0),h+=4),c&32&&(g=s.getFloat64(h,!0),h+=8),c&64&&(v.setTime(v.getTime()+s.getFloat64(h,!0)*1e3),h+=8);var _;switch(e[2]){case 0:break;case 2:_={t:"n",v:g};break;case 3:_={t:"s",v:r[m]};break;case 5:_={t:"d",v};break;case 6:_={t:"b",v:g>0};break;case 7:_={t:"n",v:g/86400};break;case 8:_={t:"e",v:0};break;case 9:if(d>-1)_={t:"s",v:t[d]};else if(m>-1)_={t:"s",v:r[m]};else if(!isNaN(g))_={t:"n",v:g};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return _}function p_(e,r,t){var n=cs(e),s=n.getUint32(8,!0),c=12,h=-1,d=-1,m=NaN,g=NaN,v=new Date(2001,0,1);s&1&&(m=d_(e,c),c+=16),s&2&&(g=n.getFloat64(c,!0),c+=8),s&4&&(v.setTime(v.getTime()+n.getFloat64(c,!0)*1e3),c+=8),s&8&&(d=n.getUint32(c,!0),c+=4),s&16&&(h=n.getUint32(c,!0),c+=4);var _;switch(e[1]){case 0:break;case 2:_={t:"n",v:m};break;case 3:_={t:"s",v:r[d]};break;case 5:_={t:"d",v};break;case 6:_={t:"b",v:g>0};break;case 7:_={t:"n",v:g/86400};break;case 8:_={t:"e",v:0};break;case 9:if(h>-1)_={t:"s",v:t[h]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:_={t:"n",v:m};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return _}function Vc(e,r){var t=new Uint8Array(32),n=cs(t),s=12,c=0;switch(t[0]=5,e.t){case"n":t[1]=2,x_(t,s,e.v),c|=1,s+=16;break;case"b":t[1]=6,n.setFloat64(s,e.v?1:0,!0),c|=2,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,n.setUint32(s,r.indexOf(e.v),!0),c|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,c,!0),t.slice(0,s)}function Hc(e,r){var t=new Uint8Array(32),n=cs(t),s=12,c=0;switch(t[0]=3,e.t){case"n":t[2]=2,n.setFloat64(s,e.v,!0),c|=32,s+=8;break;case"b":t[2]=6,n.setFloat64(s,e.v?1:0,!0),c|=32,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,n.setUint32(s,r.indexOf(e.v),!0),c|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,c,!0),t.slice(0,s)}function w_(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return m_(e,r,t,e[0]);case 5:return p_(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ca(e){var r=sr(e);return U0(r[1][0].data)}function v1(e,r){var t=sr(r.data),n=Vr(t[1][0].data),s=t[3],c=[];return(s||[]).forEach(function(h){var d=sr(h.data),m=Vr(d[1][0].data)>>>0;switch(n){case 1:c[m]=rl(d[3][0].data);break;case 8:{var g=e[Ca(d[9][0].data)][0],v=sr(g.data),_=e[Ca(v[1][0].data)][0],S=Vr(_.meta[1][0].data);if(S!=2001)throw new Error("2000 unexpected reference to ".concat(S));var T=sr(_.data);c[m]=T[3].map(function(N){return rl(N.data)}).join("")}break}}),c}function v_(e,r){var t,n,s,c,h,d,m,g,v,_,S,T,N,C,D=sr(e),U=Vr(D[1][0].data)>>>0,X=Vr(D[2][0].data)>>>0,O=((n=(t=D[8])==null?void 0:t[0])==null?void 0:n.data)&&Vr(D[8][0].data)>0||!1,q,oe;if((c=(s=D[7])==null?void 0:s[0])!=null&&c.data&&r!=0)q=(d=(h=D[7])==null?void 0:h[0])==null?void 0:d.data,oe=(g=(m=D[6])==null?void 0:m[0])==null?void 0:g.data;else if((_=(v=D[4])==null?void 0:v[0])!=null&&_.data&&r!=1)q=(T=(S=D[4])==null?void 0:S[0])==null?void 0:T.data,oe=(C=(N=D[3])==null?void 0:N[0])==null?void 0:C.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var J=O?4:1,M=cs(q),ie=[],j=0;j<q.length/2;++j){var _e=M.getUint16(j*2,!0);_e<65535&&ie.push([j,_e])}if(ie.length!=X)throw"Expected ".concat(X," cells, found ").concat(ie.length);var he=[];for(j=0;j<ie.length-1;++j)he[ie[j][0]]=oe.subarray(ie[j][1]*J,ie[j+1][1]*J);return ie.length>=1&&(he[ie[ie.length-1][0]]=oe.subarray(ie[ie.length-1][1]*J)),{R:U,cells:he}}function y_(e,r){var t,n=sr(r.data),s=(t=n==null?void 0:n[7])!=null&&t[0]?Vr(n[7][0].data)>>>0>0?1:0:-1,c=Ul(n[5],function(h){return v_(h,s)});return{nrows:Vr(n[4][0].data)>>>0,data:c.reduce(function(h,d){return h[d.R]||(h[d.R]=[]),d.cells.forEach(function(m,g){if(h[d.R][g])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(g));h[d.R][g]=m}),h},[])}}function E_(e,r,t){var n,s=sr(r.data),c={s:{r:0,c:0},e:{r:0,c:0}};if(c.e.r=(Vr(s[6][0].data)>>>0)-1,c.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(c.e.c=(Vr(s[7][0].data)>>>0)-1,c.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=Bt(c);var h=sr(s[4][0].data),d=v1(e,e[Ca(h[4][0].data)][0]),m=(n=h[17])!=null&&n[0]?v1(e,e[Ca(h[17][0].data)][0]):[],g=sr(h[3][0].data),v=0;g[1].forEach(function(_){var S=sr(_.data),T=e[Ca(S[2][0].data)][0],N=Vr(T.meta[1][0].data);if(N!=6002)throw new Error("6001 unexpected reference to ".concat(N));var C=y_(e,T);C.data.forEach(function(D,U){D.forEach(function(X,O){var q=St({r:v+U,c:O}),oe=w_(X,d,m);oe&&(t[q]=oe)})}),v+=C.nrows})}function __(e,r){var t=sr(r.data),n={"!ref":"A1"},s=e[Ca(t[2][0].data)],c=Vr(s[0].meta[1][0].data);if(c!=6001)throw new Error("6000 unexpected reference to ".concat(c));return E_(e,s[0],n),n}function A_(e,r){var t,n=sr(r.data),s={name:(t=n[1])!=null&&t[0]?rl(n[1][0].data):"",sheets:[]},c=Ul(n[2],Ca);return c.forEach(function(h){e[h].forEach(function(d){var m=Vr(d.meta[1][0].data);m==6e3&&s.sheets.push(__(e,d))})}),s}function b_(e,r){var t=Xl(),n=sr(r.data),s=Ul(n[1],Ca);if(s.forEach(function(c){e[c].forEach(function(h){var d=Vr(h.meta[1][0].data);if(d==2){var m=A_(e,h);m.sheets.forEach(function(g,v){zl(t,g,v==0?m.name:m.name+"_"+v,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Gc(e){var r,t,n,s,c={},h=[];if(e.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var g;try{g=un(m.content)}catch(_){return console.log("?? "+m.content.length+" "+(_.message||_))}var v;try{v=hn(g)}catch(_){return console.log("## "+(_.message||_))}v.forEach(function(_){c[_.id]=_.messages,h.push(_.id)})}}),!h.length)throw new Error("File has no messages");var d=((s=(n=(t=(r=c==null?void 0:c[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Vr(c[1][0].meta[1][0].data)==1&&c[1][0];if(d||h.forEach(function(m){c[m].forEach(function(g){var v=Vr(g.meta[1][0].data)>>>0;if(v==1)if(!d)d=g;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return b_(c,d)}function C_(e,r,t){var n,s,c,h;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var d=((h=(c=e[8])==null?void 0:c[0])==null?void 0:h.data)&&Vr(e[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var m=0,g=cs(e[7][0].data),v=0,_=[],S=cs(e[4][0].data),T=0,N=[],C=0;C<r.length;++C){if(r[C]==null){g.setUint16(C*2,65535,!0),S.setUint16(C*2,65535);continue}g.setUint16(C*2,v,!0),S.setUint16(C*2,T,!0);var D,U;switch(typeof r[C]){case"string":D=Vc({t:"s",v:r[C]},t),U=Hc({t:"s",v:r[C]},t);break;case"number":D=Vc({t:"n",v:r[C]},t),U=Hc({t:"n",v:r[C]},t);break;case"boolean":D=Vc({t:"b",v:r[C]},t),U=Hc({t:"b",v:r[C]},t);break;default:throw new Error("Unsupported value "+r[C])}_.push(D),v+=D.length,N.push(U),T+=U.length,++m}for(e[2][0].data=xr(m);C<e[7][0].data.length/2;++C)g.setUint16(C*2,65535,!0),S.setUint16(C*2,65535,!0);return e[6][0].data=Mi(_),e[3][0].data=Mi(N),m}function S_(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ha(t["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Bt(n)));var c=ec(t,{range:n,header:1}),h=["~Sh33tJ5~"];c.forEach(function(ce){return ce.forEach(function(ee){typeof ee=="string"&&h.push(ee)})});var d={},m=[],g=gt.read(r.numbers,{type:"base64"});g.FileIndex.map(function(ce,ee){return[ce,g.FullPaths[ee]]}).forEach(function(ce){var ee=ce[0],ne=ce[1];if(ee.type==2&&ee.name.match(/\.iwa/)){var le=ee.content,Ze=un(le),Le=hn(Ze);Le.forEach(function(Pe){m.push(Pe.id),d[Pe.id]={deps:[],location:ne,type:Vr(Pe.messages[0].meta[1][0].data)}})}}),m.sort(function(ce,ee){return ce-ee});var v=m.filter(function(ce){return ce>1}).map(function(ce){return[ce,xr(ce)]});g.FileIndex.map(function(ce,ee){return[ce,g.FullPaths[ee]]}).forEach(function(ce){var ee=ce[0];if(ce[1],!!ee.name.match(/\.iwa/)){var ne=hn(un(ee.content));ne.forEach(function(le){le.messages.forEach(function(Ze){v.forEach(function(Le){le.messages.some(function(Pe){return Vr(Pe.meta[1][0].data)!=11006&&u_(Pe.data,Le[1])})&&d[Le[0]].deps.push(le.id)})})})}});for(var _=gt.find(g,d[1].location),S=hn(un(_.content)),T,N=0;N<S.length;++N){var C=S[N];C.id==1&&(T=C)}var D=Ca(sr(T.messages[0].data)[1][0].data);for(_=gt.find(g,d[D].location),S=hn(un(_.content)),N=0;N<S.length;++N)C=S[N],C.id==D&&(T=C);for(D=Ca(sr(T.messages[0].data)[2][0].data),_=gt.find(g,d[D].location),S=hn(un(_.content)),N=0;N<S.length;++N)C=S[N],C.id==D&&(T=C);for(D=Ca(sr(T.messages[0].data)[2][0].data),_=gt.find(g,d[D].location),S=hn(un(_.content)),N=0;N<S.length;++N)C=S[N],C.id==D&&(T=C);var U=sr(T.messages[0].data);{U[6][0].data=xr(n.e.r+1),U[7][0].data=xr(n.e.c+1);var X=Ca(U[46][0].data),O=gt.find(g,d[X].location),q=hn(un(O.content));{for(var oe=0;oe<q.length&&q[oe].id!=X;++oe);if(q[oe].id!=X)throw"Bad ColumnRowUIDMapArchive";var J=sr(q[oe].messages[0].data);J[1]=[],J[2]=[],J[3]=[];for(var M=0;M<=n.e.c;++M){var ie=[];ie[1]=ie[2]=[{type:0,data:xr(M+420690)}],J[1].push({type:2,data:pa(ie)}),J[2].push({type:0,data:xr(M)}),J[3].push({type:0,data:xr(M)})}J[4]=[],J[5]=[],J[6]=[];for(var j=0;j<=n.e.r;++j)ie=[],ie[1]=ie[2]=[{type:0,data:xr(j+726270)}],J[4].push({type:2,data:pa(ie)}),J[5].push({type:0,data:xr(j)}),J[6].push({type:0,data:xr(j)});q[oe].messages[0].data=pa(J)}O.content=Ms(Rs(q)),O.size=O.content.length,delete U[46];var _e=sr(U[4][0].data);{_e[7][0].data=xr(n.e.r+1);var he=sr(_e[1][0].data),te=Ca(he[2][0].data);O=gt.find(g,d[te].location),q=hn(un(O.content));{if(q[0].id!=te)throw"Bad HeaderStorageBucket";var be=sr(q[0].messages[0].data);for(j=0;j<c.length;++j){var $e=sr(be[2][0].data);$e[1][0].data=xr(j),$e[4][0].data=xr(c[j].length),be[2][j]={type:be[2][0].type,data:pa($e)}}q[0].messages[0].data=pa(be)}O.content=Ms(Rs(q)),O.size=O.content.length;var ae=Ca(_e[2][0].data);O=gt.find(g,d[ae].location),q=hn(un(O.content));{if(q[0].id!=ae)throw"Bad HeaderStorageBucket";for(be=sr(q[0].messages[0].data),M=0;M<=n.e.c;++M)$e=sr(be[2][0].data),$e[1][0].data=xr(M),$e[4][0].data=xr(n.e.r+1),be[2][M]={type:be[2][0].type,data:pa($e)};q[0].messages[0].data=pa(be)}O.content=Ms(Rs(q)),O.size=O.content.length;var tt=Ca(_e[4][0].data);(function(){for(var ce=gt.find(g,d[tt].location),ee=hn(un(ce.content)),ne,le=0;le<ee.length;++le){var Ze=ee[le];Ze.id==tt&&(ne=Ze)}var Le=sr(ne.messages[0].data);{Le[3]=[];var Pe=[];h.forEach(function(A,Y){Pe[1]=[{type:0,data:xr(Y)}],Pe[2]=[{type:0,data:xr(1)}],Pe[3]=[{type:2,data:h_(A)}],Le[3].push({type:2,data:pa(Pe)})})}ne.messages[0].data=pa(Le);var Be=Rs(ee),Te=Ms(Be);ce.content=Te,ce.size=ce.content.length})();var Re=sr(_e[3][0].data);{var Lt=Re[1][0];delete Re[2];var fe=sr(Lt.data);{var ot=Ca(fe[2][0].data);(function(){for(var ce=gt.find(g,d[ot].location),ee=hn(un(ce.content)),ne,le=0;le<ee.length;++le){var Ze=ee[le];Ze.id==ot&&(ne=Ze)}var Le=sr(ne.messages[0].data);{delete Le[6],delete Re[7];var Pe=new Uint8Array(Le[5][0].data);Le[5]=[];for(var Be=0,Te=0;Te<=n.e.r;++Te){var A=sr(Pe);Be+=C_(A,c[Te],h),A[1][0].data=xr(Te),Le[5].push({data:pa(A),type:2})}Le[1]=[{type:0,data:xr(n.e.c+1)}],Le[2]=[{type:0,data:xr(n.e.r+1)}],Le[3]=[{type:0,data:xr(Be)}],Le[4]=[{type:0,data:xr(n.e.r+1)}]}ne.messages[0].data=pa(Le);var Y=Rs(ee),ht=Ms(Y);ce.content=ht,ce.size=ce.content.length})()}Lt.data=pa(fe)}_e[3][0].data=pa(Re)}U[4][0].data=pa(_e)}T.messages[0].data=pa(U);var mt=Rs(S),K=Ms(mt);return _.content=K,_.size=_.content.length,g}function Ru(e){return function(t){for(var n=0;n!=e.length;++n){var s=e[n];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function Wl(e){Ru([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Vl(e){Ru([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function T_(e){return zt.WS.indexOf(e)>-1?"sheet":e==zt.CS?"chart":e==zt.DS?"dialog":e==zt.MS?"macro":e&&e.length?e:"sheet"}function N_(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,T_(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function k_(e,r,t,n,s,c,h,d,m,g,v,_){try{c[n]=A0($a(e,t,!0),r);var S=ta(e,r),T;switch(d){case"sheet":T=J4(S,r,s,m,c[n],g,v,_);break;case"chart":if(T=Q4(S,r,s,m,c[n],g,v,_),!T||!T["!drawel"])break;var N=v0(T["!drawel"].Target,r),C=R0(N),D=Lw($a(e,N,!0),A0($a(e,C,!0),N)),U=v0(D,N),X=R0(U);T=C4($a(e,U,!0),U,m,A0($a(e,X,!0),U),g,T);break;case"macro":T=$4(S,r,s,m,c[n],g,v,_);break;case"dialog":T=eE(S,r,s,m,c[n],g,v,_);break;default:throw new Error("Unrecognized sheet type "+d)}h[n]=T;var O=[];c&&c[n]&&Hr(c[n]).forEach(function(q){var oe="";if(c[n][q].Type==zt.CMNT){oe=v0(c[n][q].Target,r);var J=nE(ta(e,oe,!0),oe,m);if(!J||!J.length)return;n1(T,J,!1)}c[n][q].Type==zt.TCMNT&&(oe=v0(c[n][q].Target,r),O=O.concat(Uw(ta(e,oe,!0),m)))}),O&&O.length&&n1(T,O,!0,m.people||[])}catch(q){if(m.WTF)throw q}}function ln(e){return e.charAt(0)=="/"?e.slice(1):e}function I_(e,r){if(Ys(),r=r||{},Wl(r),dn(e,"META-INF/manifest.xml")||dn(e,"objectdata.xml"))return g1(e,r);if(dn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Gc<"u"){if(e.FileIndex)return Gc(e);var t=gt.utils.cfb_new();return Cf(e).forEach(function($e){Vt(t,$e,Wx(e,$e))}),Gc(t)}throw new Error("Unsupported NUMBERS file")}if(!dn(e,"[Content_Types].xml"))throw dn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):dn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Cf(e),s=Rg($a(e,"[Content_Types].xml")),c=!1,h,d;if(s.workbooks.length===0&&(d="xl/workbook.xml",ta(e,d,!0)&&s.workbooks.push(d)),s.workbooks.length===0){if(d="xl/workbook.bin",!ta(e,d,!0))throw new Error("Could not find workbook");s.workbooks.push(d),c=!0}s.workbooks[0].slice(-3)=="bin"&&(c=!0);var m={},g={};if(!r.bookSheets&&!r.bookProps){if(b0=[],s.sst)try{b0=aE(ta(e,ln(s.sst)),s.sst,r)}catch($e){if(r.WTF)throw $e}r.cellStyles&&s.themes.length&&(m=rE($a(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],r)),s.style&&(g=tE(ta(e,ln(s.style)),s.style,m,r))}s.links.map(function($e){try{var ae=A0($a(e,R0(ln($e))),$e);return sE(ta(e,ln($e)),ae,$e,r)}catch{}});var v=Z4(ta(e,ln(s.workbooks[0])),s.workbooks[0],r),_={},S="";s.coreprops.length&&(S=ta(e,ln(s.coreprops[0]),!0),S&&(_=_h(S)),s.extprops.length!==0&&(S=ta(e,ln(s.extprops[0]),!0),S&&Wg(S,_,r)));var T={};(!r.bookSheets||r.bookProps)&&s.custprops.length!==0&&(S=$a(e,ln(s.custprops[0]),!0),S&&(T=Hg(S,r)));var N={};if((r.bookSheets||r.bookProps)&&(v.Sheets?h=v.Sheets.map(function(ae){return ae.name}):_.Worksheets&&_.SheetNames.length>0&&(h=_.SheetNames),r.bookProps&&(N.Props=_,N.Custprops=T),r.bookSheets&&typeof h<"u"&&(N.SheetNames=h),r.bookSheets?N.SheetNames:r.bookProps))return N;h={};var C={};r.bookDeps&&s.calcchain&&(C=iE(ta(e,ln(s.calcchain)),s.calcchain));var D=0,U={},X,O;{var q=v.Sheets;_.Worksheets=q.length,_.SheetNames=[];for(var oe=0;oe!=q.length;++oe)_.SheetNames[oe]=q[oe].name}var J=c?"bin":"xml",M=s.workbooks[0].lastIndexOf("/"),ie=(s.workbooks[0].slice(0,M+1)+"_rels/"+s.workbooks[0].slice(M+1)+".rels").replace(/^\//,"");dn(e,ie)||(ie="xl/_rels/workbook."+J+".rels");var j=A0($a(e,ie,!0),ie.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(r.xlmeta=oE(ta(e,ln(s.metadata[0])),s.metadata[0],r)),(s.people||[]).length>=1&&(r.people=Vw(ta(e,ln(s.people[0])),r)),j&&(j=N_(j,v.Sheets));var _e=ta(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(D=0;D!=_.Worksheets;++D){var he="sheet";if(j&&j[D]?(X="xl/"+j[D][1].replace(/[\/]?xl\//,""),dn(e,X)||(X=j[D][1]),dn(e,X)||(X=ie.replace(/_rels\/.*$/,"")+j[D][1]),he=j[D][2]):(X="xl/worksheets/sheet"+(D+1-_e)+"."+J,X=X.replace(/sheet0\./,"sheet.")),O=X.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(D!=r.sheets)continue e;break;case"string":if(_.SheetNames[D].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var te=!1,be=0;be!=r.sheets.length;++be)typeof r.sheets[be]=="number"&&r.sheets[be]==D&&(te=1),typeof r.sheets[be]=="string"&&r.sheets[be].toLowerCase()==_.SheetNames[D].toLowerCase()&&(te=1);if(!te)continue e}}k_(e,X,O,_.SheetNames[D],D,U,h,he,r,v,m,g)}return N={Directory:s,Workbook:v,Props:_,Custprops:T,Deps:C,Sheets:h,SheetNames:_.SheetNames,Strings:b0,Styles:g,Themes:m,SSF:Nr(bt)},r&&r.bookFiles&&(e.files?(N.keys=n,N.files=e.files):(N.keys=[],N.files={},e.FullPaths.forEach(function($e,ae){$e=$e.replace(/^Root Entry[\/]/,""),N.keys.push($e),N.files[$e]=e.FileIndex[ae]}))),r&&r.bookVBA&&(s.vba.length>0?N.vbaraw=ta(e,ln(s.vba[0]),!0):s.defaults&&s.defaults.bin===Zw&&(N.vbaraw=ta(e,"xl/vbaProject.bin",!0))),N}function D_(e,r){var t=r||{},n="Workbook",s=gt.find(e,n);try{if(n="/!DataSpaces/Version",s=gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(op(s.content),n="/!DataSpaces/DataSpaceMap",s=gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=lp(s.content);if(c.length!==1||c[0].comps.length!==1||c[0].comps[0].t!==0||c[0].name!=="StrongEncryptionDataSpace"||c[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var h=fp(s.content);if(h.length!=1||h[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);up(s.content)}catch{}if(n="/EncryptionInfo",s=gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var d=dp(s.content);if(n="/EncryptedPackage",s=gt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],s.content,t.password||"",t);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],s.content,t.password||"",t);throw new Error("File is password-protected")}function F_(e,r){return r.bookType=="ods"?Ou(e,r):r.bookType=="numbers"?S_(e,r):r.bookType=="xlsb"?O_(e,r):R_(e,r)}function O_(e,r){Bs=1024,e&&!e.SSF&&(e.SSF=Nr(bt)),e&&e.SSF&&(Ys(),ic(e.SSF),r.revssf=oc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,C0?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",n=ou.indexOf(r.bookType)>-1,s=Tl();Vl(r=r||{});var c=dl(),h="",d=0;if(r.cellXfs=[],Li(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),h="docProps/core.xml",Vt(c,h,Ah(e.Props,r)),s.coreprops.push(h),gr(r.rels,2,h,zt.CORE_PROPS),h="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],g=0;g<e.SheetNames.length;++g)(e.Workbook.Sheets[g]||{}).Hidden!=2&&m.push(e.SheetNames[g]);e.Props.SheetNames=m}for(e.Props.Worksheets=e.Props.SheetNames.length,Vt(c,h,Sh(e.Props)),s.extprops.push(h),gr(r.rels,3,h,zt.EXT_PROPS),e.Custprops!==e.Props&&Hr(e.Custprops||{}).length>0&&(h="docProps/custom.xml",Vt(c,h,Th(e.Custprops)),s.custprops.push(h),gr(r.rels,4,h,zt.CUST_PROPS)),d=1;d<=e.SheetNames.length;++d){var v={"!id":{}},_=e.Sheets[e.SheetNames[d-1]],S=(_||{})["!type"]||"sheet";switch(S){case"chart":default:h="xl/worksheets/sheet"+d+"."+t,Vt(c,h,lE(d-1,h,r,e,v)),s.sheets.push(h),gr(r.wbrels,-1,"worksheets/sheet"+d+"."+t,zt.WS[0])}if(_){var T=_["!comments"],N=!1,C="";T&&T.length>0&&(C="xl/comments"+d+"."+t,Vt(c,C,uE(T,C)),s.comments.push(C),gr(v,-1,"../comments"+d+"."+t,zt.CMNT),N=!0),_["!legacy"]&&N&&Vt(c,"xl/drawings/vmlDrawing"+d+".vml",iu(d,_["!comments"])),delete _["!comments"],delete _["!legacy"]}v["!id"].rId1&&Vt(c,R0(h),Us(v))}return r.Strings!=null&&r.Strings.length>0&&(h="xl/sharedStrings."+t,Vt(c,h,hE(r.Strings,h,r)),s.strs.push(h),gr(r.wbrels,-1,"sharedStrings."+t,zt.SST)),h="xl/workbook."+t,Vt(c,h,cE(e,h)),s.workbooks.push(h),gr(r.rels,1,h,zt.WB),h="xl/theme/theme1.xml",Vt(c,h,Ol(e.Themes,r)),s.themes.push(h),gr(r.wbrels,-1,"theme/theme1.xml",zt.THEME),h="xl/styles."+t,Vt(c,h,fE(e,h,r)),s.styles.push(h),gr(r.wbrels,-1,"styles."+t,zt.STY),e.vbaraw&&n&&(h="xl/vbaProject.bin",Vt(c,h,e.vbaraw),s.vba.push(h),gr(r.wbrels,-1,"vbaProject.bin",zt.VBA)),h="xl/metadata."+t,Vt(c,h,dE(h)),s.metadata.push(h),gr(r.wbrels,-1,"metadata."+t,zt.XLMETA),Vt(c,"[Content_Types].xml",yh(s,r)),Vt(c,"_rels/.rels",Us(r.rels)),Vt(c,"xl/_rels/workbook."+t+".rels",Us(r.wbrels)),delete r.revssf,delete r.ssf,c}function R_(e,r){Bs=1024,e&&!e.SSF&&(e.SSF=Nr(bt)),e&&e.SSF&&(Ys(),ic(e.SSF),r.revssf=oc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,C0?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=ou.indexOf(r.bookType)>-1,s=Tl();Vl(r=r||{});var c=dl(),h="",d=0;if(r.cellXfs=[],Li(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),h="docProps/core.xml",Vt(c,h,Ah(e.Props,r)),s.coreprops.push(h),gr(r.rels,2,h,zt.CORE_PROPS),h="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],g=0;g<e.SheetNames.length;++g)(e.Workbook.Sheets[g]||{}).Hidden!=2&&m.push(e.SheetNames[g]);e.Props.SheetNames=m}e.Props.Worksheets=e.Props.SheetNames.length,Vt(c,h,Sh(e.Props)),s.extprops.push(h),gr(r.rels,3,h,zt.EXT_PROPS),e.Custprops!==e.Props&&Hr(e.Custprops||{}).length>0&&(h="docProps/custom.xml",Vt(c,h,Th(e.Custprops)),s.custprops.push(h),gr(r.rels,4,h,zt.CUST_PROPS));var v=["SheetJ5"];for(r.tcid=0,d=1;d<=e.SheetNames.length;++d){var _={"!id":{}},S=e.Sheets[e.SheetNames[d-1]],T=(S||{})["!type"]||"sheet";switch(T){case"chart":default:h="xl/worksheets/sheet"+d+"."+t,Vt(c,h,wu(d-1,r,e,_)),s.sheets.push(h),gr(r.wbrels,-1,"worksheets/sheet"+d+"."+t,zt.WS[0])}if(S){var N=S["!comments"],C=!1,D="";if(N&&N.length>0){var U=!1;N.forEach(function(X){X[1].forEach(function(O){O.T==!0&&(U=!0)})}),U&&(D="xl/threadedComments/threadedComment"+d+"."+t,Vt(c,D,Ww(N,v,r)),s.threadedcomments.push(D),gr(_,-1,"../threadedComments/threadedComment"+d+"."+t,zt.TCMNT)),D="xl/comments"+d+"."+t,Vt(c,D,su(N)),s.comments.push(D),gr(_,-1,"../comments"+d+"."+t,zt.CMNT),C=!0}S["!legacy"]&&C&&Vt(c,"xl/drawings/vmlDrawing"+d+".vml",iu(d,S["!comments"])),delete S["!comments"],delete S["!legacy"]}_["!id"].rId1&&Vt(c,R0(h),Us(_))}return r.Strings!=null&&r.Strings.length>0&&(h="xl/sharedStrings."+t,Vt(c,h,Yh(r.Strings,r)),s.strs.push(h),gr(r.wbrels,-1,"sharedStrings."+t,zt.SST)),h="xl/workbook."+t,Vt(c,h,Au(e)),s.workbooks.push(h),gr(r.rels,1,h,zt.WB),h="xl/theme/theme1.xml",Vt(c,h,Ol(e.Themes,r)),s.themes.push(h),gr(r.wbrels,-1,"theme/theme1.xml",zt.THEME),h="xl/styles."+t,Vt(c,h,tu(e,r)),s.styles.push(h),gr(r.wbrels,-1,"styles."+t,zt.STY),e.vbaraw&&n&&(h="xl/vbaProject.bin",Vt(c,h,e.vbaraw),s.vba.push(h),gr(r.wbrels,-1,"vbaProject.bin",zt.VBA)),h="xl/metadata."+t,Vt(c,h,nu()),s.metadata.push(h),gr(r.wbrels,-1,"metadata."+t,zt.XLMETA),v.length>1&&(h="xl/persons/person.xml",Vt(c,h,Hw(v)),s.people.push(h),gr(r.wbrels,-1,"persons/person.xml",zt.PEOPLE)),Vt(c,"[Content_Types].xml",yh(s,r)),Vt(c,"_rels/.rels",Us(r.rels)),Vt(c,"xl/_rels/workbook."+t+".rels",Us(r.wbrels)),delete r.revssf,delete r.ssf,c}function Hl(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=en(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function M_(e,r){return gt.find(e,"EncryptedPackage")?D_(e,r):Tu(e,r)}function P_(e,r){var t,n=e,s=r||{};return s.type||(s.type=Ht&&Buffer.isBuffer(e)?"buffer":"base64"),t=q1(n,s),I_(t,s)}function Mu(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return el(e.slice(t),r);default:break e}return Gs.to_workbook(e,r)}function B_(e,r){var t="",n=Hl(e,r);switch(r.type){case"base64":t=en(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=ns(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=vr(t)),r.type="binary",Mu(t,r)}function L_(e,r){var t=e;return r.type=="base64"&&(t=en(t)),t=N0.utils.decode(1200,t.slice(2),"str"),r.type="binary",Mu(t,r)}function j_(e){return e.match(/[^\x00-\x7F]/)?Vn(e):e}function Xc(e,r,t,n){return n?(t.type="string",Gs.to_workbook(e,t)):Gs.to_workbook(r,t)}function al(e,r){cl();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return al(new Uint8Array(e),(t=Nr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],c=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Vs={},t.dateNF&&(Vs.dateNF=t.dateNF),t.type||(t.type=Ht&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Ht?"buffer":"binary",n=Ox(e),typeof Uint8Array<"u"&&!Ht&&(t.type="array")),t.type=="string"&&(c=!0,t.type="binary",t.codepage=65001,n=j_(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var h=new ArrayBuffer(3),d=new Uint8Array(h);if(d.foo="bar",!d.foo)return t=Nr(t),t.type="array",al(ll(n),t)}switch((s=Hl(n,t))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return M_(gt.read(n,t),t);break;case 9:if(s[1]<=8)return Tu(n,t);break;case 60:return el(n,t);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Gm(n,t);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Xh.to_workbook(n,t);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?P_(n,t):Xc(e,n,t,c);case 239:return s[3]===60?el(n,t):Xc(e,n,t,c);case 255:if(s[1]===254)return L_(n,t);if(s[1]===0&&s[2]===2&&s[3]===0)return ts.to_workbook(n,t);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ts.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return $c.to_workbook(n,t);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Qh.to_workbook(n,t);break;case 10:case 13:case 32:return B_(n,t);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Hm.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?$c.to_workbook(n,t):Xc(e,n,t,c)}function Pu(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return V0(r.file,gt.write(e,{type:Ht?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return gt.write(e,r)}function U_(e,r){var t=Nr(r||{}),n=F_(e,t);return W_(n,t)}function W_(e,r){var t={},n=Ht?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var s=e.FullPaths?gt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(r.type=="binary"||r.type=="base64")return s;s=new Uint8Array(nc(s))}return r.password&&typeof encrypt_agile<"u"?Pu(encrypt_agile(s,r.password),r):r.type==="file"?V0(r.file,s):r.type=="string"?vr(s):s}function V_(e,r){var t=r||{},n=jE(e,t);return Pu(n,t)}function Wn(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return k0(Vn(n));case"binary":return Vn(n);case"string":return e;case"file":return V0(r.file,n,"utf8");case"buffer":return Ht?di(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Wn(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function H_(e,r){switch(r.type){case"base64":return k0(e);case"binary":return e;case"string":return e;case"file":return V0(r.file,e,"binary");case"buffer":return Ht?di(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Lo(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?k0(t):r.type=="string"?vr(t):t;case"file":return V0(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function Bu(e,r){cl(),M4(e);var t=Nr(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=Bu(e,t);return t.type="array",nc(n)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=e.SheetNames.indexOf(t.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Wn(FE(e,t),t);case"slk":case"sylk":return Wn(Gh.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"htm":case"html":return Wn(ku(e.Sheets[e.SheetNames[s]],t),t);case"txt":return H_(Lu(e.Sheets[e.SheetNames[s]],t),t);case"csv":return Wn(Gl(e.Sheets[e.SheetNames[s]],t),t,"\uFEFF");case"dif":return Wn(Xh.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"dbf":return Lo($c.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"prn":return Wn(Gs.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"rtf":return Wn(Qh.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"eth":return Wn(zh.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"fods":return Wn(Ou(e,t),t);case"wk1":return Lo(ts.sheet_to_wk1(e.Sheets[e.SheetNames[s]],t),t);case"wk3":return Lo(ts.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Lo(Nu(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),V_(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return U_(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function G_(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function X_(e,r,t){var n={};return n.type="file",n.file=r,G_(n),Bu(e,n)}function z_(e,r,t,n,s,c,h,d){var m=Yr(t),g=d.defval,v=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),_=!0,S=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(S,"__rowNum__",{value:t,enumerable:!1})}catch{S.__rowNum__=t}else S.__rowNum__=t;if(!h||e[t])for(var T=r.s.c;T<=r.e.c;++T){var N=h?e[t][T]:e[n[T]+m];if(N===void 0||N.t===void 0){if(g===void 0)continue;c[T]!=null&&(S[c[T]]=g);continue}var C=N.v;switch(N.t){case"z":if(C==null)break;continue;case"e":C=C==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+N.t)}if(c[T]!=null){if(C==null)if(N.t=="e"&&C===null)S[c[T]]=null;else if(g!==void 0)S[c[T]]=g;else if(v&&C===null)S[c[T]]=null;else continue;else S[c[T]]=v&&(N.t!=="n"||N.t==="n"&&d.rawNumbers!==!1)?C:ui(N,C,d);C!=null&&(_=!1)}}return{row:S,isempty:_}}function ec(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,s=1,c=[],h=0,d="",m={s:{r:0,c:0},e:{r:0,c:0}},g=r||{},v=g.range!=null?g.range:e["!ref"];switch(g.header===1?n=1:g.header==="A"?n=2:Array.isArray(g.header)?n=3:g.header==null&&(n=0),typeof v){case"string":m=ar(v);break;case"number":m=ar(e["!ref"]),m.s.r=v;break;default:m=v}n>0&&(s=0);var _=Yr(m.s.r),S=[],T=[],N=0,C=0,D=Array.isArray(e),U=m.s.r,X=0,O={};D&&!e[U]&&(e[U]=[]);var q=g.skipHidden&&e["!cols"]||[],oe=g.skipHidden&&e["!rows"]||[];for(X=m.s.c;X<=m.e.c;++X)if(!(q[X]||{}).hidden)switch(S[X]=Br(X),t=D?e[U][X]:e[S[X]+_],n){case 1:c[X]=X-m.s.c;break;case 2:c[X]=S[X];break;case 3:c[X]=g.header[X-m.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),d=h=ui(t,null,g),C=O[h]||0,!C)O[h]=1;else{do d=h+"_"+C++;while(O[d]);O[h]=C,O[d]=1}c[X]=d}for(U=m.s.r+s;U<=m.e.r;++U)if(!(oe[U]||{}).hidden){var J=z_(e,m,U,S,n,c,D,g);(J.isempty===!1||(n===1?g.blankrows!==!1:g.blankrows))&&(T[N++]=J.row)}return T.length=N,T}var y1=/"/g;function Y_(e,r,t,n,s,c,h,d){for(var m=!0,g=[],v="",_=Yr(t),S=r.s.c;S<=r.e.c;++S)if(n[S]){var T=d.dense?(e[t]||[])[S]:e[n[S]+_];if(T==null)v="";else if(T.v!=null){m=!1,v=""+(d.rawNumbers&&T.t=="n"?T.v:ui(T,null,d));for(var N=0,C=0;N!==v.length;++N)if((C=v.charCodeAt(N))===s||C===c||C===34||d.forceQuotes){v='"'+v.replace(y1,'""')+'"';break}v=="ID"&&(v='"ID"')}else T.f!=null&&!T.F?(m=!1,v="="+T.f,v.indexOf(",")>=0&&(v='"'+v.replace(y1,'""')+'"')):v="";g.push(v)}return d.blankrows===!1&&m?null:g.join(h)}function Gl(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var s=ar(e["!ref"]),c=n.FS!==void 0?n.FS:",",h=c.charCodeAt(0),d=n.RS!==void 0?n.RS:`
`,m=d.charCodeAt(0),g=new RegExp((c=="|"?"\\|":c)+"+$"),v="",_=[];n.dense=Array.isArray(e);for(var S=n.skipHidden&&e["!cols"]||[],T=n.skipHidden&&e["!rows"]||[],N=s.s.c;N<=s.e.c;++N)(S[N]||{}).hidden||(_[N]=Br(N));for(var C=0,D=s.s.r;D<=s.e.r;++D)(T[D]||{}).hidden||(v=Y_(e,s,D,_,h,m,c,n),v!=null&&(n.strip&&(v=v.replace(g,"")),(v||n.blankrows!==!1)&&t.push((C++?d:"")+v)));return delete n.dense,t.join("")}function Lu(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Gl(e,r);return t}function K_(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var s=ar(e["!ref"]),c="",h=[],d,m=[],g=Array.isArray(e);for(d=s.s.c;d<=s.e.c;++d)h[d]=Br(d);for(var v=s.s.r;v<=s.e.r;++v)for(c=Yr(v),d=s.s.c;d<=s.e.c;++d)if(r=h[d]+c,t=g?(e[v]||[])[d]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}m[m.length]=r+"="+n}return m}function ju(e,r,t){var n=t||{},s=+!n.skipHeader,c=e||{},h=0,d=0;if(c&&n.origin!=null)if(typeof n.origin=="number")h=n.origin;else{var m=typeof n.origin=="string"?Lr(n.origin):n.origin;h=m.r,d=m.c}var g,v={s:{c:0,r:0},e:{c:d,r:h+r.length-1+s}};if(c["!ref"]){var _=ar(c["!ref"]);v.e.c=Math.max(v.e.c,_.e.c),v.e.r=Math.max(v.e.r,_.e.r),h==-1&&(h=_.e.r+1,v.e.r=h+r.length-1+s)}else h==-1&&(h=0,v.e.r=r.length-1+s);var S=n.header||[],T=0;r.forEach(function(C,D){Hr(C).forEach(function(U){(T=S.indexOf(U))==-1&&(S[T=S.length]=U);var X=C[U],O="z",q="",oe=St({c:d+T,r:h+D+s});g=W0(c,oe),X&&typeof X=="object"&&!(X instanceof Date)?c[oe]=X:(typeof X=="number"?O="n":typeof X=="boolean"?O="b":typeof X=="string"?O="s":X instanceof Date?(O="d",n.cellDates||(O="n",X=oa(X)),q=n.dateNF||bt[14]):X===null&&n.nullError&&(O="e",X=0),g?(g.t=O,g.v=X,delete g.w,delete g.R,q&&(g.z=q)):c[oe]=g={t:O,v:X},q&&(g.z=q))})}),v.e.c=Math.max(v.e.c,d+S.length-1);var N=Yr(h);if(s)for(T=0;T<S.length;++T)c[Br(T+d)+N]={t:"s",v:S[T]};return c["!ref"]=Bt(v),c}function q_(e,r){return ju(null,e,r)}function W0(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Lr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?W0(e,St(r)):W0(e,St({r,c:t||0}))}function Z_(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Xl(){return{SheetNames:[],Sheets:{}}}function zl(e,r,t,n){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var c=t.match(/(^.*?)(\d+)$/);s=c&&+c[2]||0;var h=c&&c[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=h+s)!=-1;++s);}if(_u(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function J_(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Z_(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function Q_(e,r){return e.z=r,e}function Uu(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function $_(e,r,t){return Uu(e,"#"+r,t)}function e8(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function t8(e,r,t,n){for(var s=typeof r!="string"?r:ar(r),c=typeof r=="string"?r:Bt(r),h=s.s.r;h<=s.e.r;++h)for(var d=s.s.c;d<=s.e.c;++d){var m=W0(e,h,d);m.t="n",m.F=c,delete m.v,h==s.s.r&&d==s.s.c&&(m.f=t,n&&(m.D=!0))}return e}var jo={encode_col:Br,encode_row:Yr,encode_cell:St,encode_range:Bt,decode_col:El,decode_row:yl,split_cell:hg,decode_cell:Lr,decode_range:Ha,format_cell:ui,sheet_add_aoa:dh,sheet_add_json:ju,sheet_add_dom:Iu,aoa_to_sheet:Ks,json_to_sheet:q_,table_to_sheet:Du,table_to_book:o_,sheet_to_csv:Gl,sheet_to_txt:Lu,sheet_to_json:ec,sheet_to_html:ku,sheet_to_formulae:K_,sheet_to_row_object_array:ec,sheet_get_cell:W0,book_new:Xl,book_append_sheet:zl,book_set_sheet_visibility:J_,cell_set_number_format:Q_,cell_set_hyperlink:Uu,cell_set_internal_link:$_,cell_add_comment:e8,sheet_set_array_formula:t8,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},ct;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ct||(ct={}));var E1=new Map([[ct.QR_CODE,"QR_CODE"],[ct.AZTEC,"AZTEC"],[ct.CODABAR,"CODABAR"],[ct.CODE_39,"CODE_39"],[ct.CODE_93,"CODE_93"],[ct.CODE_128,"CODE_128"],[ct.DATA_MATRIX,"DATA_MATRIX"],[ct.MAXICODE,"MAXICODE"],[ct.ITF,"ITF"],[ct.EAN_13,"EAN_13"],[ct.EAN_8,"EAN_8"],[ct.PDF_417,"PDF_417"],[ct.RSS_14,"RSS_14"],[ct.RSS_EXPANDED,"RSS_EXPANDED"],[ct.UPC_A,"UPC_A"],[ct.UPC_E,"UPC_E"],[ct.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),_1;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(_1||(_1={}));function r8(e){return Object.values(ct).includes(e)}var tc;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(tc||(tc={}));var a8=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[tc.SCAN_TYPE_CAMERA,tc.SCAN_TYPE_FILE],e}(),Wu=function(){function e(r,t){this.format=r,this.formatName=t}return e.prototype.toString=function(){return this.formatName},e.create=function(r){if(!E1.has(r))throw"".concat(r," not in html5QrcodeSupportedFormatsTextMap");return new e(r,E1.get(r))},e}(),A1=function(){function e(){}return e.createFromText=function(r){var t={text:r};return{decodedText:r,result:t}},e.createFromQrcodeResult=function(r){return{decodedText:r.text,result:r}},e}(),nl;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(nl||(nl={}));var n8=function(){function e(){}return e.createFrom=function(r){return{errorMessage:r,type:nl.UNKWOWN_ERROR}},e}(),i8=function(){function e(r){this.verbose=r}return e.prototype.log=function(r){this.verbose&&console.log(r)},e.prototype.warn=function(r){this.verbose&&console.warn(r)},e.prototype.logError=function(r,t){(this.verbose||t===!0)&&console.error(r)},e.prototype.logErrors=function(r){if(r.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(r)},e}();function oi(e){return typeof e>"u"||e===null}var Ls=function(){function e(){}return e.codeParseError=function(r){return"QR code parse error, error = ".concat(r)},e.errorGettingUserMedia=function(r){return"Error getting userMedia, error = ".concat(r)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),Vu=function(){function e(){}return e.isMediaStreamConstraintsValid=function(r,t){if(typeof r!="object"){var n=typeof r;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(n,"."),!0),!1}for(var s=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],c=new Set(s),h=Object.keys(r),d=0,m=h;d<m.length;d++){var g=m[d];if(c.has(g))return t.logError("".concat(g," is not supported videoConstaints."),!0),!1}return!0},e}(),il={exports:{}};(function(e,r){(function(t,n){n(r)})(l0,function(t){function n(k){return k==null}var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,a){k.__proto__=a}||function(k,a){for(var i in a)a.hasOwnProperty(i)&&(k[i]=a[i])};function c(k,a){s(k,a);function i(){this.constructor=k}k.prototype=a===null?Object.create(a):(i.prototype=a.prototype,new i)}function h(k,a){var i=Object.setPrototypeOf;i?i(k,a):k.__proto__=a}function d(k,a){a===void 0&&(a=k.constructor);var i=Error.captureStackTrace;i&&i(k,a)}var m=function(k){c(a,k);function a(i){var o=this.constructor,l=k.call(this,i)||this;return Object.defineProperty(l,"name",{value:o.name,enumerable:!1}),h(l,o.prototype),d(l),l}return a}(Error);class g extends m{constructor(a=void 0){super(a),this.message=a}getKind(){return this.constructor.kind}}g.kind="Exception";class v extends g{}v.kind="ArgumentException";class _ extends g{}_.kind="IllegalArgumentException";class S{constructor(a){if(this.binarizer=a,a===null)throw new _("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(a,i){return this.binarizer.getBlackRow(a,i)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(a,i,o,l){const f=this.binarizer.getLuminanceSource().crop(a,i,o,l);return new S(this.binarizer.createBinarizer(f))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const a=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new S(this.binarizer.createBinarizer(a))}rotateCounterClockwise45(){const a=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new S(this.binarizer.createBinarizer(a))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class T extends g{static getChecksumInstance(){return new T}}T.kind="ChecksumException";class N{constructor(a){this.source=a}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class C{static arraycopy(a,i,o,l,f){for(;f--;)o[l++]=a[i++]}static currentTimeMillis(){return Date.now()}}class D extends g{}D.kind="IndexOutOfBoundsException";class U extends D{constructor(a=void 0,i=void 0){super(i),this.index=a,this.message=i}}U.kind="ArrayIndexOutOfBoundsException";class X{static fill(a,i){for(let o=0,l=a.length;o<l;o++)a[o]=i}static fillWithin(a,i,o,l){X.rangeCheck(a.length,i,o);for(let f=i;f<o;f++)a[f]=l}static rangeCheck(a,i,o){if(i>o)throw new _("fromIndex("+i+") > toIndex("+o+")");if(i<0)throw new U(i);if(o>a)throw new U(o)}static asList(...a){return a}static create(a,i,o){return Array.from({length:a}).map(f=>Array.from({length:i}).fill(o))}static createInt32Array(a,i,o){return Array.from({length:a}).map(f=>Int32Array.from({length:i}).fill(o))}static equals(a,i){if(!a||!i||!a.length||!i.length||a.length!==i.length)return!1;for(let o=0,l=a.length;o<l;o++)if(a[o]!==i[o])return!1;return!0}static hashCode(a){if(a===null)return 0;let i=1;for(const o of a)i=31*i+o;return i}static fillUint8Array(a,i){for(let o=0;o!==a.length;o++)a[o]=i}static copyOf(a,i){return a.slice(0,i)}static copyOfUint8Array(a,i){if(a.length<=i){const o=new Uint8Array(i);return o.set(a),o}return a.slice(0,i)}static copyOfRange(a,i,o){const l=o-i,f=new Int32Array(l);return C.arraycopy(a,i,f,0,l),f}static binarySearch(a,i,o){o===void 0&&(o=X.numberComparator);let l=0,f=a.length-1;for(;l<=f;){const u=f+l>>1,x=o(i,a[u]);if(x>0)l=u+1;else if(x<0)f=u-1;else return u}return-l-1}static numberComparator(a,i){return a-i}}class O{static numberOfTrailingZeros(a){let i;if(a===0)return 32;let o=31;return i=a<<16,i!==0&&(o-=16,a=i),i=a<<8,i!==0&&(o-=8,a=i),i=a<<4,i!==0&&(o-=4,a=i),i=a<<2,i!==0&&(o-=2,a=i),o-(a<<1>>>31)}static numberOfLeadingZeros(a){if(a===0)return 32;let i=1;return a>>>16||(i+=16,a<<=16),a>>>24||(i+=8,a<<=8),a>>>28||(i+=4,a<<=4),a>>>30||(i+=2,a<<=2),i-=a>>>31,i}static toHexString(a){return a.toString(16)}static toBinaryString(a){return String(parseInt(String(a),2))}static bitCount(a){return a=a-(a>>>1&1431655765),a=(a&858993459)+(a>>>2&858993459),a=a+(a>>>4)&252645135,a=a+(a>>>8),a=a+(a>>>16),a&63}static truncDivision(a,i){return Math.trunc(a/i)}static parseInt(a,i=void 0){return parseInt(a,i)}}O.MIN_VALUE_32_BITS=-2147483648,O.MAX_VALUE=Number.MAX_SAFE_INTEGER;class q{constructor(a,i){a===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=a,i==null?this.bits=q.makeArray(a):this.bits=i)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(a){if(a>this.bits.length*32){const i=q.makeArray(a);C.arraycopy(this.bits,0,i,0,this.bits.length),this.bits=i}}get(a){return(this.bits[Math.floor(a/32)]&1<<(a&31))!==0}set(a){this.bits[Math.floor(a/32)]|=1<<(a&31)}flip(a){this.bits[Math.floor(a/32)]^=1<<(a&31)}getNextSet(a){const i=this.size;if(a>=i)return i;const o=this.bits;let l=Math.floor(a/32),f=o[l];f&=~((1<<(a&31))-1);const u=o.length;for(;f===0;){if(++l===u)return i;f=o[l]}const x=l*32+O.numberOfTrailingZeros(f);return x>i?i:x}getNextUnset(a){const i=this.size;if(a>=i)return i;const o=this.bits;let l=Math.floor(a/32),f=~o[l];f&=~((1<<(a&31))-1);const u=o.length;for(;f===0;){if(++l===u)return i;f=~o[l]}const x=l*32+O.numberOfTrailingZeros(f);return x>i?i:x}setBulk(a,i){this.bits[Math.floor(a/32)]=i}setRange(a,i){if(i<a||a<0||i>this.size)throw new _;if(i===a)return;i--;const o=Math.floor(a/32),l=Math.floor(i/32),f=this.bits;for(let u=o;u<=l;u++){const x=u>o?0:a&31,y=(2<<(u<l?31:i&31))-(1<<x);f[u]|=y}}clear(){const a=this.bits.length,i=this.bits;for(let o=0;o<a;o++)i[o]=0}isRange(a,i,o){if(i<a||a<0||i>this.size)throw new _;if(i===a)return!0;i--;const l=Math.floor(a/32),f=Math.floor(i/32),u=this.bits;for(let x=l;x<=f;x++){const p=x>l?0:a&31,b=(2<<(x<f?31:i&31))-(1<<p)&4294967295;if((u[x]&b)!==(o?b:0))return!1}return!0}appendBit(a){this.ensureCapacity(this.size+1),a&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(a,i){if(i<0||i>32)throw new _("Num bits must be between 0 and 32");this.ensureCapacity(this.size+i);for(let o=i;o>0;o--)this.appendBit((a>>o-1&1)===1)}appendBitArray(a){const i=a.size;this.ensureCapacity(this.size+i);for(let o=0;o<i;o++)this.appendBit(a.get(o))}xor(a){if(this.size!==a.size)throw new _("Sizes don't match");const i=this.bits;for(let o=0,l=i.length;o<l;o++)i[o]^=a.bits[o]}toBytes(a,i,o,l){for(let f=0;f<l;f++){let u=0;for(let x=0;x<8;x++)this.get(a)&&(u|=1<<7-x),a++;i[o+f]=u}}getBitArray(){return this.bits}reverse(){const a=new Int32Array(this.bits.length),i=Math.floor((this.size-1)/32),o=i+1,l=this.bits;for(let f=0;f<o;f++){let u=l[f];u=u>>1&1431655765|(u&1431655765)<<1,u=u>>2&858993459|(u&858993459)<<2,u=u>>4&252645135|(u&252645135)<<4,u=u>>8&16711935|(u&16711935)<<8,u=u>>16&65535|(u&65535)<<16,a[i-f]=u}if(this.size!==o*32){const f=o*32-this.size;let u=a[0]>>>f;for(let x=1;x<o;x++){const p=a[x];u|=p<<32-f,a[x-1]=u,u=p>>>f}a[o-1]=u}this.bits=a}static makeArray(a){return new Int32Array(Math.floor((a+31)/32))}equals(a){if(!(a instanceof q))return!1;const i=a;return this.size===i.size&&X.equals(this.bits,i.bits)}hashCode(){return 31*this.size+X.hashCode(this.bits)}toString(){let a="";for(let i=0,o=this.size;i<o;i++)i&7||(a+=" "),a+=this.get(i)?"X":".";return a}clone(){return new q(this.size,this.bits.slice())}}var oe;(function(k){k[k.OTHER=0]="OTHER",k[k.PURE_BARCODE=1]="PURE_BARCODE",k[k.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",k[k.TRY_HARDER=3]="TRY_HARDER",k[k.CHARACTER_SET=4]="CHARACTER_SET",k[k.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",k[k.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",k[k.ASSUME_GS1=7]="ASSUME_GS1",k[k.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",k[k.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",k[k.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(oe||(oe={}));var J=oe;class M extends g{static getFormatInstance(){return new M}}M.kind="FormatException";var ie;(function(k){k[k.Cp437=0]="Cp437",k[k.ISO8859_1=1]="ISO8859_1",k[k.ISO8859_2=2]="ISO8859_2",k[k.ISO8859_3=3]="ISO8859_3",k[k.ISO8859_4=4]="ISO8859_4",k[k.ISO8859_5=5]="ISO8859_5",k[k.ISO8859_6=6]="ISO8859_6",k[k.ISO8859_7=7]="ISO8859_7",k[k.ISO8859_8=8]="ISO8859_8",k[k.ISO8859_9=9]="ISO8859_9",k[k.ISO8859_10=10]="ISO8859_10",k[k.ISO8859_11=11]="ISO8859_11",k[k.ISO8859_13=12]="ISO8859_13",k[k.ISO8859_14=13]="ISO8859_14",k[k.ISO8859_15=14]="ISO8859_15",k[k.ISO8859_16=15]="ISO8859_16",k[k.SJIS=16]="SJIS",k[k.Cp1250=17]="Cp1250",k[k.Cp1251=18]="Cp1251",k[k.Cp1252=19]="Cp1252",k[k.Cp1256=20]="Cp1256",k[k.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",k[k.UTF8=22]="UTF8",k[k.ASCII=23]="ASCII",k[k.Big5=24]="Big5",k[k.GB18030=25]="GB18030",k[k.EUC_KR=26]="EUC_KR"})(ie||(ie={}));class j{constructor(a,i,o,...l){this.valueIdentifier=a,this.name=o,typeof i=="number"?this.values=Int32Array.from([i]):this.values=i,this.otherEncodingNames=l,j.VALUE_IDENTIFIER_TO_ECI.set(a,this),j.NAME_TO_ECI.set(o,this);const f=this.values;for(let u=0,x=f.length;u!==x;u++){const p=f[u];j.VALUES_TO_ECI.set(p,this)}for(const u of l)j.NAME_TO_ECI.set(u,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(a){if(a<0||a>=900)throw new M("incorect value");const i=j.VALUES_TO_ECI.get(a);if(i===void 0)throw new M("incorect value");return i}static getCharacterSetECIByName(a){const i=j.NAME_TO_ECI.get(a);if(i===void 0)throw new M("incorect value");return i}equals(a){if(!(a instanceof j))return!1;const i=a;return this.getName()===i.getName()}}j.VALUE_IDENTIFIER_TO_ECI=new Map,j.VALUES_TO_ECI=new Map,j.NAME_TO_ECI=new Map,j.Cp437=new j(ie.Cp437,Int32Array.from([0,2]),"Cp437"),j.ISO8859_1=new j(ie.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),j.ISO8859_2=new j(ie.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),j.ISO8859_3=new j(ie.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),j.ISO8859_4=new j(ie.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),j.ISO8859_5=new j(ie.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),j.ISO8859_6=new j(ie.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),j.ISO8859_7=new j(ie.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),j.ISO8859_8=new j(ie.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),j.ISO8859_9=new j(ie.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),j.ISO8859_10=new j(ie.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),j.ISO8859_11=new j(ie.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),j.ISO8859_13=new j(ie.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),j.ISO8859_14=new j(ie.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),j.ISO8859_15=new j(ie.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),j.ISO8859_16=new j(ie.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),j.SJIS=new j(ie.SJIS,20,"SJIS","Shift_JIS"),j.Cp1250=new j(ie.Cp1250,21,"Cp1250","windows-1250"),j.Cp1251=new j(ie.Cp1251,22,"Cp1251","windows-1251"),j.Cp1252=new j(ie.Cp1252,23,"Cp1252","windows-1252"),j.Cp1256=new j(ie.Cp1256,24,"Cp1256","windows-1256"),j.UnicodeBigUnmarked=new j(ie.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),j.UTF8=new j(ie.UTF8,26,"UTF8","UTF-8"),j.ASCII=new j(ie.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),j.Big5=new j(ie.Big5,28,"Big5"),j.GB18030=new j(ie.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),j.EUC_KR=new j(ie.EUC_KR,30,"EUC_KR","EUC-KR");class _e extends g{}_e.kind="UnsupportedOperationException";class he{static decode(a,i){const o=this.encodingName(i);return this.customDecoder?this.customDecoder(a,o):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(o)?this.decodeFallback(a,o):new TextDecoder(o).decode(a)}static shouldDecodeOnFallback(a){return!he.isBrowser()&&a==="ISO-8859-1"}static encode(a,i){const o=this.encodingName(i);return this.customEncoder?this.customEncoder(a,o):typeof TextEncoder>"u"?this.encodeFallback(a):new TextEncoder().encode(a)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(a){return typeof a=="string"?a:a.getName()}static encodingCharacterSet(a){return a instanceof j?a:j.getCharacterSetECIByName(a)}static decodeFallback(a,i){const o=this.encodingCharacterSet(i);if(he.isDecodeFallbackSupported(o)){let l="";for(let f=0,u=a.length;f<u;f++){let x=a[f].toString(16);x.length<2&&(x="0"+x),l+="%"+x}return decodeURIComponent(l)}if(o.equals(j.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(a.buffer));throw new _e(`Encoding ${this.encodingName(i)} not supported by fallback.`)}static isDecodeFallbackSupported(a){return a.equals(j.UTF8)||a.equals(j.ISO8859_1)||a.equals(j.ASCII)}static encodeFallback(a){const o=btoa(unescape(encodeURIComponent(a))).split(""),l=[];for(let f=0;f<o.length;f++)l.push(o[f].charCodeAt(0));return new Uint8Array(l)}}class te{static castAsNonUtf8Char(a,i=null){const o=i?i.getName():this.ISO88591;return he.decode(new Uint8Array([a]),o)}static guessEncoding(a,i){if(i!=null&&i.get(J.CHARACTER_SET)!==void 0)return i.get(J.CHARACTER_SET).toString();const o=a.length;let l=!0,f=!0,u=!0,x=0,p=0,y=0,b=0,I=0,R=0,G=0,Q=0,re=0,de=0,Ae=0;const qe=a.length>3&&a[0]===239&&a[1]===187&&a[2]===191;for(let Je=0;Je<o&&(l||f||u);Je++){const Ge=a[Je]&255;u&&(x>0?Ge&128?x--:u=!1:Ge&128&&(Ge&64?(x++,Ge&32?(x++,Ge&16?(x++,Ge&8?u=!1:b++):y++):p++):u=!1)),l&&(Ge>127&&Ge<160?l=!1:Ge>159&&(Ge<192||Ge===215||Ge===247)&&Ae++),f&&(I>0?Ge<64||Ge===127||Ge>252?f=!1:I--:Ge===128||Ge===160||Ge>239?f=!1:Ge>160&&Ge<224?(R++,Q=0,G++,G>re&&(re=G)):Ge>127?(I++,G=0,Q++,Q>de&&(de=Q)):(G=0,Q=0))}return u&&x>0&&(u=!1),f&&I>0&&(f=!1),u&&(qe||p+y+b>0)?te.UTF8:f&&(te.ASSUME_SHIFT_JIS||re>=3||de>=3)?te.SHIFT_JIS:l&&f?re===2&&R===2||Ae*10>=o?te.SHIFT_JIS:te.ISO88591:l?te.ISO88591:f?te.SHIFT_JIS:u?te.UTF8:te.PLATFORM_DEFAULT_ENCODING}static format(a,...i){let o=-1;function l(u,x,p,y,b,I){if(u==="%%")return"%";if(i[++o]===void 0)return;u=y?parseInt(y.substr(1)):void 0;let R=b?parseInt(b.substr(1)):void 0,G;switch(I){case"s":G=i[o];break;case"c":G=i[o][0];break;case"f":G=parseFloat(i[o]).toFixed(u);break;case"p":G=parseFloat(i[o]).toPrecision(u);break;case"e":G=parseFloat(i[o]).toExponential(u);break;case"x":G=parseInt(i[o]).toString(R||16);break;case"d":G=parseFloat(parseInt(i[o],R||10).toPrecision(u)).toFixed(0);break}G=typeof G=="object"?JSON.stringify(G):(+G).toString(R);let Q=parseInt(p),re=p&&p[0]+""=="0"?"0":" ";for(;G.length<Q;)G=x!==void 0?G+re:re+G;return G}let f=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return a.replace(f,l)}static getBytes(a,i){return he.encode(a,i)}static getCharCode(a,i=0){return a.charCodeAt(i)}static getCharAt(a){return String.fromCharCode(a)}}te.SHIFT_JIS=j.SJIS.getName(),te.GB2312="GB2312",te.ISO88591=j.ISO8859_1.getName(),te.EUC_JP="EUC_JP",te.UTF8=j.UTF8.getName(),te.PLATFORM_DEFAULT_ENCODING=te.UTF8,te.ASSUME_SHIFT_JIS=!1;class be{constructor(a=""){this.value=a}enableDecoding(a){return this.encoding=a,this}append(a){return typeof a=="string"?this.value+=a.toString():this.encoding?this.value+=te.castAsNonUtf8Char(a,this.encoding):this.value+=String.fromCharCode(a),this}appendChars(a,i,o){for(let l=i;i<i+o;l++)this.append(a[l]);return this}length(){return this.value.length}charAt(a){return this.value.charAt(a)}deleteCharAt(a){this.value=this.value.substr(0,a)+this.value.substring(a+1)}setCharAt(a,i){this.value=this.value.substr(0,a)+i+this.value.substr(a+1)}substring(a,i){return this.value.substring(a,i)}setLengthToZero(){this.value=""}toString(){return this.value}insert(a,i){this.value=this.value.substr(0,a)+i+this.value.substr(a+i.length)}}class $e{constructor(a,i,o,l){if(this.width=a,this.height=i,this.rowSize=o,this.bits=l,i==null&&(i=a),this.height=i,a<1||i<1)throw new _("Both dimensions must be greater than 0");o==null&&(o=Math.floor((a+31)/32)),this.rowSize=o,l==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(a){const i=a.length,o=a[0].length,l=new $e(o,i);for(let f=0;f<i;f++){const u=a[f];for(let x=0;x<o;x++)u[x]&&l.set(x,f)}return l}static parseFromString(a,i,o){if(a===null)throw new _("stringRepresentation cannot be null");const l=new Array(a.length);let f=0,u=0,x=-1,p=0,y=0;for(;y<a.length;)if(a.charAt(y)===`
`||a.charAt(y)==="\r"){if(f>u){if(x===-1)x=f-u;else if(f-u!==x)throw new _("row lengths do not match");u=f,p++}y++}else if(a.substring(y,y+i.length)===i)y+=i.length,l[f]=!0,f++;else if(a.substring(y,y+o.length)===o)y+=o.length,l[f]=!1,f++;else throw new _("illegal character encountered: "+a.substring(y));if(f>u){if(x===-1)x=f-u;else if(f-u!==x)throw new _("row lengths do not match");p++}const b=new $e(x,p);for(let I=0;I<f;I++)l[I]&&b.set(Math.floor(I%x),Math.floor(I/x));return b}get(a,i){const o=i*this.rowSize+Math.floor(a/32);return(this.bits[o]>>>(a&31)&1)!==0}set(a,i){const o=i*this.rowSize+Math.floor(a/32);this.bits[o]|=1<<(a&31)&4294967295}unset(a,i){const o=i*this.rowSize+Math.floor(a/32);this.bits[o]&=~(1<<(a&31)&4294967295)}flip(a,i){const o=i*this.rowSize+Math.floor(a/32);this.bits[o]^=1<<(a&31)&4294967295}xor(a){if(this.width!==a.getWidth()||this.height!==a.getHeight()||this.rowSize!==a.getRowSize())throw new _("input matrix dimensions do not match");const i=new q(Math.floor(this.width/32)+1),o=this.rowSize,l=this.bits;for(let f=0,u=this.height;f<u;f++){const x=f*o,p=a.getRow(f,i).getBitArray();for(let y=0;y<o;y++)l[x+y]^=p[y]}}clear(){const a=this.bits,i=a.length;for(let o=0;o<i;o++)a[o]=0}setRegion(a,i,o,l){if(i<0||a<0)throw new _("Left and top must be nonnegative");if(l<1||o<1)throw new _("Height and width must be at least 1");const f=a+o,u=i+l;if(u>this.height||f>this.width)throw new _("The region must fit inside the matrix");const x=this.rowSize,p=this.bits;for(let y=i;y<u;y++){const b=y*x;for(let I=a;I<f;I++)p[b+Math.floor(I/32)]|=1<<(I&31)&4294967295}}getRow(a,i){i==null||i.getSize()<this.width?i=new q(this.width):i.clear();const o=this.rowSize,l=this.bits,f=a*o;for(let u=0;u<o;u++)i.setBulk(u*32,l[f+u]);return i}setRow(a,i){C.arraycopy(i.getBitArray(),0,this.bits,a*this.rowSize,this.rowSize)}rotate180(){const a=this.getWidth(),i=this.getHeight();let o=new q(a),l=new q(a);for(let f=0,u=Math.floor((i+1)/2);f<u;f++)o=this.getRow(f,o),l=this.getRow(i-1-f,l),o.reverse(),l.reverse(),this.setRow(f,l),this.setRow(i-1-f,o)}getEnclosingRectangle(){const a=this.width,i=this.height,o=this.rowSize,l=this.bits;let f=a,u=i,x=-1,p=-1;for(let y=0;y<i;y++)for(let b=0;b<o;b++){const I=l[y*o+b];if(I!==0){if(y<u&&(u=y),y>p&&(p=y),b*32<f){let R=0;for(;!(I<<31-R&4294967295);)R++;b*32+R<f&&(f=b*32+R)}if(b*32+31>x){let R=31;for(;!(I>>>R);)R--;b*32+R>x&&(x=b*32+R)}}}return x<f||p<u?null:Int32Array.from([f,u,x-f+1,p-u+1])}getTopLeftOnBit(){const a=this.rowSize,i=this.bits;let o=0;for(;o<i.length&&i[o]===0;)o++;if(o===i.length)return null;const l=o/a;let f=o%a*32;const u=i[o];let x=0;for(;!(u<<31-x&4294967295);)x++;return f+=x,Int32Array.from([f,l])}getBottomRightOnBit(){const a=this.rowSize,i=this.bits;let o=i.length-1;for(;o>=0&&i[o]===0;)o--;if(o<0)return null;const l=Math.floor(o/a);let f=Math.floor(o%a)*32;const u=i[o];let x=31;for(;!(u>>>x);)x--;return f+=x,Int32Array.from([f,l])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(a){if(!(a instanceof $e))return!1;const i=a;return this.width===i.width&&this.height===i.height&&this.rowSize===i.rowSize&&X.equals(this.bits,i.bits)}hashCode(){let a=this.width;return a=31*a+this.width,a=31*a+this.height,a=31*a+this.rowSize,a=31*a+X.hashCode(this.bits),a}toString(a="X ",i="  ",o=`
`){return this.buildToString(a,i,o)}buildToString(a,i,o){let l=new be;for(let f=0,u=this.height;f<u;f++){for(let x=0,p=this.width;x<p;x++)l.append(this.get(x,f)?a:i);l.append(o)}return l.toString()}clone(){return new $e(this.width,this.height,this.rowSize,this.bits.slice())}}class ae extends g{static getNotFoundInstance(){return new ae}}ae.kind="NotFoundException";class tt extends N{constructor(a){super(a),this.luminances=tt.EMPTY,this.buckets=new Int32Array(tt.LUMINANCE_BUCKETS)}getBlackRow(a,i){const o=this.getLuminanceSource(),l=o.getWidth();i==null||i.getSize()<l?i=new q(l):i.clear(),this.initArrays(l);const f=o.getRow(a,this.luminances),u=this.buckets;for(let p=0;p<l;p++)u[(f[p]&255)>>tt.LUMINANCE_SHIFT]++;const x=tt.estimateBlackPoint(u);if(l<3)for(let p=0;p<l;p++)(f[p]&255)<x&&i.set(p);else{let p=f[0]&255,y=f[1]&255;for(let b=1;b<l-1;b++){const I=f[b+1]&255;(y*4-p-I)/2<x&&i.set(b),p=y,y=I}}return i}getBlackMatrix(){const a=this.getLuminanceSource(),i=a.getWidth(),o=a.getHeight(),l=new $e(i,o);this.initArrays(i);const f=this.buckets;for(let p=1;p<5;p++){const y=Math.floor(o*p/5),b=a.getRow(y,this.luminances),I=Math.floor(i*4/5);for(let R=Math.floor(i/5);R<I;R++){const G=b[R]&255;f[G>>tt.LUMINANCE_SHIFT]++}}const u=tt.estimateBlackPoint(f),x=a.getMatrix();for(let p=0;p<o;p++){const y=p*i;for(let b=0;b<i;b++)(x[y+b]&255)<u&&l.set(b,p)}return l}createBinarizer(a){return new tt(a)}initArrays(a){this.luminances.length<a&&(this.luminances=new Uint8ClampedArray(a));const i=this.buckets;for(let o=0;o<tt.LUMINANCE_BUCKETS;o++)i[o]=0}static estimateBlackPoint(a){const i=a.length;let o=0,l=0,f=0;for(let b=0;b<i;b++)a[b]>f&&(l=b,f=a[b]),a[b]>o&&(o=a[b]);let u=0,x=0;for(let b=0;b<i;b++){const I=b-l,R=a[b]*I*I;R>x&&(u=b,x=R)}if(l>u){const b=l;l=u,u=b}if(u-l<=i/16)throw new ae;let p=u-1,y=-1;for(let b=u-1;b>l;b--){const I=b-l,R=I*I*(u-b)*(o-a[b]);R>y&&(p=b,y=R)}return p<<tt.LUMINANCE_SHIFT}}tt.LUMINANCE_BITS=5,tt.LUMINANCE_SHIFT=8-tt.LUMINANCE_BITS,tt.LUMINANCE_BUCKETS=1<<tt.LUMINANCE_BITS,tt.EMPTY=Uint8ClampedArray.from([0]);class Re extends tt{constructor(a){super(a),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const a=this.getLuminanceSource(),i=a.getWidth(),o=a.getHeight();if(i>=Re.MINIMUM_DIMENSION&&o>=Re.MINIMUM_DIMENSION){const l=a.getMatrix();let f=i>>Re.BLOCK_SIZE_POWER;i&Re.BLOCK_SIZE_MASK&&f++;let u=o>>Re.BLOCK_SIZE_POWER;o&Re.BLOCK_SIZE_MASK&&u++;const x=Re.calculateBlackPoints(l,f,u,i,o),p=new $e(i,o);Re.calculateThresholdForBlock(l,f,u,i,o,x,p),this.matrix=p}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(a){return new Re(a)}static calculateThresholdForBlock(a,i,o,l,f,u,x){const p=f-Re.BLOCK_SIZE,y=l-Re.BLOCK_SIZE;for(let b=0;b<o;b++){let I=b<<Re.BLOCK_SIZE_POWER;I>p&&(I=p);const R=Re.cap(b,2,o-3);for(let G=0;G<i;G++){let Q=G<<Re.BLOCK_SIZE_POWER;Q>y&&(Q=y);const re=Re.cap(G,2,i-3);let de=0;for(let qe=-2;qe<=2;qe++){const Je=u[R+qe];de+=Je[re-2]+Je[re-1]+Je[re]+Je[re+1]+Je[re+2]}const Ae=de/25;Re.thresholdBlock(a,Q,I,Ae,l,x)}}}static cap(a,i,o){return a<i?i:a>o?o:a}static thresholdBlock(a,i,o,l,f,u){for(let x=0,p=o*f+i;x<Re.BLOCK_SIZE;x++,p+=f)for(let y=0;y<Re.BLOCK_SIZE;y++)(a[p+y]&255)<=l&&u.set(i+y,o+x)}static calculateBlackPoints(a,i,o,l,f){const u=f-Re.BLOCK_SIZE,x=l-Re.BLOCK_SIZE,p=new Array(o);for(let y=0;y<o;y++){p[y]=new Int32Array(i);let b=y<<Re.BLOCK_SIZE_POWER;b>u&&(b=u);for(let I=0;I<i;I++){let R=I<<Re.BLOCK_SIZE_POWER;R>x&&(R=x);let G=0,Q=255,re=0;for(let Ae=0,qe=b*l+R;Ae<Re.BLOCK_SIZE;Ae++,qe+=l){for(let Je=0;Je<Re.BLOCK_SIZE;Je++){const Ge=a[qe+Je]&255;G+=Ge,Ge<Q&&(Q=Ge),Ge>re&&(re=Ge)}if(re-Q>Re.MIN_DYNAMIC_RANGE)for(Ae++,qe+=l;Ae<Re.BLOCK_SIZE;Ae++,qe+=l)for(let Je=0;Je<Re.BLOCK_SIZE;Je++)G+=a[qe+Je]&255}let de=G>>Re.BLOCK_SIZE_POWER*2;if(re-Q<=Re.MIN_DYNAMIC_RANGE&&(de=Q/2,y>0&&I>0)){const Ae=(p[y-1][I]+2*p[y][I-1]+p[y-1][I-1])/4;Q<Ae&&(de=Ae)}p[y][I]=de}}return p}}Re.BLOCK_SIZE_POWER=3,Re.BLOCK_SIZE=1<<Re.BLOCK_SIZE_POWER,Re.BLOCK_SIZE_MASK=Re.BLOCK_SIZE-1,Re.MINIMUM_DIMENSION=Re.BLOCK_SIZE*5,Re.MIN_DYNAMIC_RANGE=24;class Lt{constructor(a,i){this.width=a,this.height=i}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(a,i,o,l){throw new _e("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new _e("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new _e("This luminance source does not support rotation by 45 degrees.")}toString(){const a=new Uint8ClampedArray(this.width);let i=new be;for(let o=0;o<this.height;o++){const l=this.getRow(o,a);for(let f=0;f<this.width;f++){const u=l[f]&255;let x;u<64?x="#":u<128?x="+":u<192?x=".":x=" ",i.append(x)}i.append(`
`)}return i.toString()}}class fe extends Lt{constructor(a){super(a.getWidth(),a.getHeight()),this.delegate=a}getRow(a,i){const o=this.delegate.getRow(a,i),l=this.getWidth();for(let f=0;f<l;f++)o[f]=255-(o[f]&255);return o}getMatrix(){const a=this.delegate.getMatrix(),i=this.getWidth()*this.getHeight(),o=new Uint8ClampedArray(i);for(let l=0;l<i;l++)o[l]=255-(a[l]&255);return o}isCropSupported(){return this.delegate.isCropSupported()}crop(a,i,o,l){return new fe(this.delegate.crop(a,i,o,l))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new fe(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new fe(this.delegate.rotateCounterClockwise45())}}class ot extends Lt{constructor(a){super(a.width,a.height),this.canvas=a,this.tempCanvasElement=null,this.buffer=ot.makeBufferFromCanvasImageData(a)}static makeBufferFromCanvasImageData(a){const i=a.getContext("2d").getImageData(0,0,a.width,a.height);return ot.toGrayscaleBuffer(i.data,a.width,a.height)}static toGrayscaleBuffer(a,i,o){const l=new Uint8ClampedArray(i*o);for(let f=0,u=0,x=a.length;f<x;f+=4,u++){let p;if(a[f+3]===0)p=255;else{const b=a[f],I=a[f+1],R=a[f+2];p=306*b+601*I+117*R+512>>10}l[u]=p}return l}getRow(a,i){if(a<0||a>=this.getHeight())throw new _("Requested row is outside the image: "+a);const o=this.getWidth(),l=a*o;return i===null?i=this.buffer.slice(l,l+o):(i.length<o&&(i=new Uint8ClampedArray(o)),i.set(this.buffer.slice(l,l+o))),i}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(a,i,o,l){return super.crop(a,i,o,l),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const a=this.canvas.ownerDocument.createElement("canvas");a.width=this.canvas.width,a.height=this.canvas.height,this.tempCanvasElement=a}return this.tempCanvasElement}rotate(a){const i=this.getTempCanvasElement(),o=i.getContext("2d"),l=a*ot.DEGREE_TO_RADIANS,f=this.canvas.width,u=this.canvas.height,x=Math.ceil(Math.abs(Math.cos(l))*f+Math.abs(Math.sin(l))*u),p=Math.ceil(Math.abs(Math.sin(l))*f+Math.abs(Math.cos(l))*u);return i.width=x,i.height=p,o.translate(x/2,p/2),o.rotate(l),o.drawImage(this.canvas,f/-2,u/-2),this.buffer=ot.makeBufferFromCanvasImageData(i),this}invert(){return new fe(this)}}ot.DEGREE_TO_RADIANS=Math.PI/180;class mt{constructor(a,i,o){this.deviceId=a,this.label=i,this.kind="videoinput",this.groupId=o||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var K=(globalThis||l0||self||window||void 0)&&(globalThis||l0||self||window||void 0).__awaiter||function(k,a,i,o){function l(f){return f instanceof i?f:new i(function(u){u(f)})}return new(i||(i=Promise))(function(f,u){function x(b){try{y(o.next(b))}catch(I){u(I)}}function p(b){try{y(o.throw(b))}catch(I){u(I)}}function y(b){b.done?f(b.value):l(b.value).then(x,p)}y((o=o.apply(k,a||[])).next())})};class ce{constructor(a,i=500,o){this.reader=a,this.timeBetweenScansMillis=i,this._hints=o,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(a){this._timeBetweenDecodingAttempts=a<0?0:a}set hints(a){this._hints=a||null}get hints(){return this._hints}listVideoInputDevices(){return K(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const a=yield navigator.mediaDevices.enumerateDevices(),i=[];for(const o of a){const l=o.kind==="video"?"videoinput":o.kind;if(l!=="videoinput")continue;const f=o.deviceId||o.id,u=o.label||`Video device ${i.length+1}`,x=o.groupId,p={deviceId:f,label:u,kind:l,groupId:x};i.push(p)}return i})}getVideoInputDevices(){return K(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(i=>new mt(i.deviceId,i.label))})}findDeviceById(a){return K(this,void 0,void 0,function*(){const i=yield this.listVideoInputDevices();return i?i.find(o=>o.deviceId===a):null})}decodeFromInputVideoDevice(a,i){return K(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(a,i)})}decodeOnceFromVideoDevice(a,i){return K(this,void 0,void 0,function*(){this.reset();let o;a?o={deviceId:{exact:a}}:o={facingMode:"environment"};const l={video:o};return yield this.decodeOnceFromConstraints(l,i)})}decodeOnceFromConstraints(a,i){return K(this,void 0,void 0,function*(){const o=yield navigator.mediaDevices.getUserMedia(a);return yield this.decodeOnceFromStream(o,i)})}decodeOnceFromStream(a,i){return K(this,void 0,void 0,function*(){this.reset();const o=yield this.attachStreamToVideo(a,i);return yield this.decodeOnce(o)})}decodeFromInputVideoDeviceContinuously(a,i,o){return K(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(a,i,o)})}decodeFromVideoDevice(a,i,o){return K(this,void 0,void 0,function*(){let l;a?l={deviceId:{exact:a}}:l={facingMode:"environment"};const f={video:l};return yield this.decodeFromConstraints(f,i,o)})}decodeFromConstraints(a,i,o){return K(this,void 0,void 0,function*(){const l=yield navigator.mediaDevices.getUserMedia(a);return yield this.decodeFromStream(l,i,o)})}decodeFromStream(a,i,o){return K(this,void 0,void 0,function*(){this.reset();const l=yield this.attachStreamToVideo(a,i);return yield this.decodeContinuously(l,o)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(a,i){return K(this,void 0,void 0,function*(){const o=this.prepareVideoElement(i);return this.addVideoSource(o,a),this.videoElement=o,this.stream=a,yield this.playVideoOnLoadAsync(o),o})}playVideoOnLoadAsync(a){return new Promise((i,o)=>this.playVideoOnLoad(a,()=>i()))}playVideoOnLoad(a,i){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(a),a.addEventListener("ended",this.videoEndedListener),a.addEventListener("canplay",this.videoCanPlayListener),a.addEventListener("playing",i),this.tryPlayVideo(a)}isVideoPlaying(a){return a.currentTime>0&&!a.paused&&!a.ended&&a.readyState>2}tryPlayVideo(a){return K(this,void 0,void 0,function*(){if(this.isVideoPlaying(a)){console.warn("Trying to play video that is already playing.");return}try{yield a.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(a,i){const o=document.getElementById(a);if(!o)throw new v(`element with id '${a}' not found`);if(o.nodeName.toLowerCase()!==i.toLowerCase())throw new v(`element with id '${a}' must be an ${i} element`);return o}decodeFromImage(a,i){if(!a&&!i)throw new v("either imageElement with a src set or an url must be provided");return i&&!a?this.decodeFromImageUrl(i):this.decodeFromImageElement(a)}decodeFromVideo(a,i){if(!a&&!i)throw new v("Either an element with a src set or an URL must be provided");return i&&!a?this.decodeFromVideoUrl(i):this.decodeFromVideoElement(a)}decodeFromVideoContinuously(a,i,o){if(a===void 0&&i===void 0)throw new v("Either an element with a src set or an URL must be provided");return i&&!a?this.decodeFromVideoUrlContinuously(i,o):this.decodeFromVideoElementContinuously(a,o)}decodeFromImageElement(a){if(!a)throw new v("An image element must be provided.");this.reset();const i=this.prepareImageElement(a);this.imageElement=i;let o;return this.isImageLoaded(i)?o=this.decodeOnce(i,!1,!0):o=this._decodeOnLoadImage(i),o}decodeFromVideoElement(a){const i=this._decodeFromVideoElementSetup(a);return this._decodeOnLoadVideo(i)}decodeFromVideoElementContinuously(a,i){const o=this._decodeFromVideoElementSetup(a);return this._decodeOnLoadVideoContinuously(o,i)}_decodeFromVideoElementSetup(a){if(!a)throw new v("A video element must be provided.");this.reset();const i=this.prepareVideoElement(a);return this.videoElement=i,i}decodeFromImageUrl(a){if(!a)throw new v("An URL must be provided.");this.reset();const i=this.prepareImageElement();this.imageElement=i;const o=this._decodeOnLoadImage(i);return i.src=a,o}decodeFromVideoUrl(a){if(!a)throw new v("An URL must be provided.");this.reset();const i=this.prepareVideoElement(),o=this.decodeFromVideoElement(i);return i.src=a,o}decodeFromVideoUrlContinuously(a,i){if(!a)throw new v("An URL must be provided.");this.reset();const o=this.prepareVideoElement(),l=this.decodeFromVideoElementContinuously(o,i);return o.src=a,l}_decodeOnLoadImage(a){return new Promise((i,o)=>{this.imageLoadedListener=()=>this.decodeOnce(a,!1,!0).then(i,o),a.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(a){return K(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(a),yield this.decodeOnce(a)})}_decodeOnLoadVideoContinuously(a,i){return K(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(a),this.decodeContinuously(a,i)})}isImageLoaded(a){return!(!a.complete||a.naturalWidth===0)}prepareImageElement(a){let i;return typeof a>"u"&&(i=document.createElement("img"),i.width=200,i.height=200),typeof a=="string"&&(i=this.getMediaElement(a,"img")),a instanceof HTMLImageElement&&(i=a),i}prepareVideoElement(a){let i;return!a&&typeof document<"u"&&(i=document.createElement("video"),i.width=200,i.height=200),typeof a=="string"&&(i=this.getMediaElement(a,"video")),a instanceof HTMLVideoElement&&(i=a),i.setAttribute("autoplay","true"),i.setAttribute("muted","true"),i.setAttribute("playsinline","true"),i}decodeOnce(a,i=!0,o=!0){this._stopAsyncDecode=!1;const l=(f,u)=>{if(this._stopAsyncDecode){u(new ae("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const x=this.decode(a);f(x)}catch(x){const p=i&&x instanceof ae,b=(x instanceof T||x instanceof M)&&o;if(p||b)return setTimeout(l,this._timeBetweenDecodingAttempts,f,u);u(x)}};return new Promise((f,u)=>l(f,u))}decodeContinuously(a,i){this._stopContinuousDecode=!1;const o=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const l=this.decode(a);i(l,null),setTimeout(o,this.timeBetweenScansMillis)}catch(l){i(null,l);const f=l instanceof T||l instanceof M,u=l instanceof ae;(f||u)&&setTimeout(o,this._timeBetweenDecodingAttempts)}};o()}decode(a){const i=this.createBinaryBitmap(a);return this.decodeBitmap(i)}_isHTMLVideoElement(a){return a.videoWidth!==0}drawFrameOnCanvas(a,i,o){i||(i={sx:0,sy:0,sWidth:a.videoWidth,sHeight:a.videoHeight,dx:0,dy:0,dWidth:a.videoWidth,dHeight:a.videoHeight}),o||(o=this.captureCanvasContext),o.drawImage(a,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}drawImageOnCanvas(a,i,o=this.captureCanvasContext){i||(i={sx:0,sy:0,sWidth:a.naturalWidth,sHeight:a.naturalHeight,dx:0,dy:0,dWidth:a.naturalWidth,dHeight:a.naturalHeight}),o||(o=this.captureCanvasContext),o.drawImage(a,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}createBinaryBitmap(a){this.getCaptureCanvasContext(a),this._isHTMLVideoElement(a)?this.drawFrameOnCanvas(a):this.drawImageOnCanvas(a);const i=this.getCaptureCanvas(a),o=new ot(i),l=new Re(o);return new S(l)}getCaptureCanvasContext(a){if(!this.captureCanvasContext){const o=this.getCaptureCanvas(a).getContext("2d");this.captureCanvasContext=o}return this.captureCanvasContext}getCaptureCanvas(a){if(!this.captureCanvas){const i=this.createCaptureCanvas(a);this.captureCanvas=i}return this.captureCanvas}decodeBitmap(a){return this.reader.decode(a,this._hints)}createCaptureCanvas(a){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const i=document.createElement("canvas");let o,l;return typeof a<"u"&&(a instanceof HTMLVideoElement?(o=a.videoWidth,l=a.videoHeight):a instanceof HTMLImageElement&&(o=a.naturalWidth||a.width,l=a.naturalHeight||a.height)),i.style.width=o+"px",i.style.height=l+"px",i.width=o,i.height=l,i}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(a=>a.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(a,i){try{a.srcObject=i}catch{a.src=URL.createObjectURL(i)}}cleanVideoSource(a){try{a.srcObject=null}catch{a.src=""}this.videoElement.removeAttribute("src")}}class ee{constructor(a,i,o=i==null?0:8*i.length,l,f,u=C.currentTimeMillis()){this.text=a,this.rawBytes=i,this.numBits=o,this.resultPoints=l,this.format=f,this.timestamp=u,this.text=a,this.rawBytes=i,o==null?this.numBits=i==null?0:8*i.length:this.numBits=o,this.resultPoints=l,this.format=f,this.resultMetadata=null,u==null?this.timestamp=C.currentTimeMillis():this.timestamp=u}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(a,i){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(a,i)}putAllMetadata(a){a!==null&&(this.resultMetadata===null?this.resultMetadata=a:this.resultMetadata=new Map(a))}addResultPoints(a){const i=this.resultPoints;if(i===null)this.resultPoints=a;else if(a!==null&&a.length>0){const o=new Array(i.length+a.length);C.arraycopy(i,0,o,0,i.length),C.arraycopy(a,0,o,i.length,a.length),this.resultPoints=o}}getTimestamp(){return this.timestamp}toString(){return this.text}}var ne;(function(k){k[k.AZTEC=0]="AZTEC",k[k.CODABAR=1]="CODABAR",k[k.CODE_39=2]="CODE_39",k[k.CODE_93=3]="CODE_93",k[k.CODE_128=4]="CODE_128",k[k.DATA_MATRIX=5]="DATA_MATRIX",k[k.EAN_8=6]="EAN_8",k[k.EAN_13=7]="EAN_13",k[k.ITF=8]="ITF",k[k.MAXICODE=9]="MAXICODE",k[k.PDF_417=10]="PDF_417",k[k.QR_CODE=11]="QR_CODE",k[k.RSS_14=12]="RSS_14",k[k.RSS_EXPANDED=13]="RSS_EXPANDED",k[k.UPC_A=14]="UPC_A",k[k.UPC_E=15]="UPC_E",k[k.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ne||(ne={}));var le=ne,Ze;(function(k){k[k.OTHER=0]="OTHER",k[k.ORIENTATION=1]="ORIENTATION",k[k.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",k[k.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",k[k.ISSUE_NUMBER=4]="ISSUE_NUMBER",k[k.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",k[k.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",k[k.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",k[k.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",k[k.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",k[k.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Ze||(Ze={}));var Le=Ze;class Pe{constructor(a,i,o,l,f=-1,u=-1){this.rawBytes=a,this.text=i,this.byteSegments=o,this.ecLevel=l,this.structuredAppendSequenceNumber=f,this.structuredAppendParity=u,this.numBits=a==null?0:8*a.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(a){this.numBits=a}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(a){this.errorsCorrected=a}getErasures(){return this.erasures}setErasures(a){this.erasures=a}getOther(){return this.other}setOther(a){this.other=a}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Be{exp(a){return this.expTable[a]}log(a){if(a===0)throw new _;return this.logTable[a]}static addOrSubtract(a,i){return a^i}}class Te{constructor(a,i){if(i.length===0)throw new _;this.field=a;const o=i.length;if(o>1&&i[0]===0){let l=1;for(;l<o&&i[l]===0;)l++;l===o?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(o-l),C.arraycopy(i,l,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(a){return this.coefficients[this.coefficients.length-1-a]}evaluateAt(a){if(a===0)return this.getCoefficient(0);const i=this.coefficients;let o;if(a===1){o=0;for(let u=0,x=i.length;u!==x;u++){const p=i[u];o=Be.addOrSubtract(o,p)}return o}o=i[0];const l=i.length,f=this.field;for(let u=1;u<l;u++)o=Be.addOrSubtract(f.multiply(a,o),i[u]);return o}addOrSubtract(a){if(!this.field.equals(a.field))throw new _("GenericGFPolys do not have same GenericGF field");if(this.isZero())return a;if(a.isZero())return this;let i=this.coefficients,o=a.coefficients;if(i.length>o.length){const u=i;i=o,o=u}let l=new Int32Array(o.length);const f=o.length-i.length;C.arraycopy(o,0,l,0,f);for(let u=f;u<o.length;u++)l[u]=Be.addOrSubtract(i[u-f],o[u]);return new Te(this.field,l)}multiply(a){if(!this.field.equals(a.field))throw new _("GenericGFPolys do not have same GenericGF field");if(this.isZero()||a.isZero())return this.field.getZero();const i=this.coefficients,o=i.length,l=a.coefficients,f=l.length,u=new Int32Array(o+f-1),x=this.field;for(let p=0;p<o;p++){const y=i[p];for(let b=0;b<f;b++)u[p+b]=Be.addOrSubtract(u[p+b],x.multiply(y,l[b]))}return new Te(x,u)}multiplyScalar(a){if(a===0)return this.field.getZero();if(a===1)return this;const i=this.coefficients.length,o=this.field,l=new Int32Array(i),f=this.coefficients;for(let u=0;u<i;u++)l[u]=o.multiply(f[u],a);return new Te(o,l)}multiplyByMonomial(a,i){if(a<0)throw new _;if(i===0)return this.field.getZero();const o=this.coefficients,l=o.length,f=new Int32Array(l+a),u=this.field;for(let x=0;x<l;x++)f[x]=u.multiply(o[x],i);return new Te(u,f)}divide(a){if(!this.field.equals(a.field))throw new _("GenericGFPolys do not have same GenericGF field");if(a.isZero())throw new _("Divide by 0");const i=this.field;let o=i.getZero(),l=this;const f=a.getCoefficient(a.getDegree()),u=i.inverse(f);for(;l.getDegree()>=a.getDegree()&&!l.isZero();){const x=l.getDegree()-a.getDegree(),p=i.multiply(l.getCoefficient(l.getDegree()),u),y=a.multiplyByMonomial(x,p),b=i.buildMonomial(x,p);o=o.addOrSubtract(b),l=l.addOrSubtract(y)}return[o,l]}toString(){let a="";for(let i=this.getDegree();i>=0;i--){let o=this.getCoefficient(i);if(o!==0){if(o<0?(a+=" - ",o=-o):a.length>0&&(a+=" + "),i===0||o!==1){const l=this.field.log(o);l===0?a+="1":l===1?a+="a":(a+="a^",a+=l)}i!==0&&(i===1?a+="x":(a+="x^",a+=i))}}return a}}class A extends g{}A.kind="ArithmeticException";class Y extends Be{constructor(a,i,o){super(),this.primitive=a,this.size=i,this.generatorBase=o;const l=new Int32Array(i);let f=1;for(let x=0;x<i;x++)l[x]=f,f*=2,f>=i&&(f^=a,f&=i-1);this.expTable=l;const u=new Int32Array(i);for(let x=0;x<i-1;x++)u[l[x]]=x;this.logTable=u,this.zero=new Te(this,Int32Array.from([0])),this.one=new Te(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(a,i){if(a<0)throw new _;if(i===0)return this.zero;const o=new Int32Array(a+1);return o[0]=i,new Te(this,o)}inverse(a){if(a===0)throw new A;return this.expTable[this.size-this.logTable[a]-1]}multiply(a,i){return a===0||i===0?0:this.expTable[(this.logTable[a]+this.logTable[i])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+O.toHexString(this.primitive)+","+this.size+")"}equals(a){return a===this}}Y.AZTEC_DATA_12=new Y(4201,4096,1),Y.AZTEC_DATA_10=new Y(1033,1024,1),Y.AZTEC_DATA_6=new Y(67,64,1),Y.AZTEC_PARAM=new Y(19,16,1),Y.QR_CODE_FIELD_256=new Y(285,256,0),Y.DATA_MATRIX_FIELD_256=new Y(301,256,1),Y.AZTEC_DATA_8=Y.DATA_MATRIX_FIELD_256,Y.MAXICODE_FIELD_64=Y.AZTEC_DATA_6;class ht extends g{}ht.kind="ReedSolomonException";class lt extends g{}lt.kind="IllegalStateException";class Xe{constructor(a){this.field=a}decode(a,i){const o=this.field,l=new Te(o,a),f=new Int32Array(i);let u=!0;for(let G=0;G<i;G++){const Q=l.evaluateAt(o.exp(G+o.getGeneratorBase()));f[f.length-1-G]=Q,Q!==0&&(u=!1)}if(u)return;const x=new Te(o,f),p=this.runEuclideanAlgorithm(o.buildMonomial(i,1),x,i),y=p[0],b=p[1],I=this.findErrorLocations(y),R=this.findErrorMagnitudes(b,I);for(let G=0;G<I.length;G++){const Q=a.length-1-o.log(I[G]);if(Q<0)throw new ht("Bad error location");a[Q]=Y.addOrSubtract(a[Q],R[G])}}runEuclideanAlgorithm(a,i,o){if(a.getDegree()<i.getDegree()){const G=a;a=i,i=G}const l=this.field;let f=a,u=i,x=l.getZero(),p=l.getOne();for(;u.getDegree()>=(o/2|0);){let G=f,Q=x;if(f=u,x=p,f.isZero())throw new ht("r_{i-1} was zero");u=G;let re=l.getZero();const de=f.getCoefficient(f.getDegree()),Ae=l.inverse(de);for(;u.getDegree()>=f.getDegree()&&!u.isZero();){const qe=u.getDegree()-f.getDegree(),Je=l.multiply(u.getCoefficient(u.getDegree()),Ae);re=re.addOrSubtract(l.buildMonomial(qe,Je)),u=u.addOrSubtract(f.multiplyByMonomial(qe,Je))}if(p=re.multiply(x).addOrSubtract(Q),u.getDegree()>=f.getDegree())throw new lt("Division algorithm failed to reduce polynomial?")}const y=p.getCoefficient(0);if(y===0)throw new ht("sigmaTilde(0) was zero");const b=l.inverse(y),I=p.multiplyScalar(b),R=u.multiplyScalar(b);return[I,R]}findErrorLocations(a){const i=a.getDegree();if(i===1)return Int32Array.from([a.getCoefficient(1)]);const o=new Int32Array(i);let l=0;const f=this.field;for(let u=1;u<f.getSize()&&l<i;u++)a.evaluateAt(u)===0&&(o[l]=f.inverse(u),l++);if(l!==i)throw new ht("Error locator degree does not match number of roots");return o}findErrorMagnitudes(a,i){const o=i.length,l=new Int32Array(o),f=this.field;for(let u=0;u<o;u++){const x=f.inverse(i[u]);let p=1;for(let y=0;y<o;y++)if(u!==y){const b=f.multiply(i[y],x),I=b&1?b&-2:b|1;p=f.multiply(p,I)}l[u]=f.multiply(a.evaluateAt(x),f.inverse(p)),f.getGeneratorBase()!==0&&(l[u]=f.multiply(l[u],x))}return l}}var Me;(function(k){k[k.UPPER=0]="UPPER",k[k.LOWER=1]="LOWER",k[k.MIXED=2]="MIXED",k[k.DIGIT=3]="DIGIT",k[k.PUNCT=4]="PUNCT",k[k.BINARY=5]="BINARY"})(Me||(Me={}));class ft{decode(a){this.ddata=a;let i=a.getBits(),o=this.extractBits(i),l=this.correctBits(o),f=ft.convertBoolArrayToByteArray(l),u=ft.getEncodedData(l),x=new Pe(f,u,null,null);return x.setNumBits(l.length),x}static highLevelDecode(a){return this.getEncodedData(a)}static getEncodedData(a){let i=a.length,o=Me.UPPER,l=Me.UPPER,f="",u=0;for(;u<i;)if(l===Me.BINARY){if(i-u<5)break;let x=ft.readCode(a,u,5);if(u+=5,x===0){if(i-u<11)break;x=ft.readCode(a,u,11)+31,u+=11}for(let p=0;p<x;p++){if(i-u<8){u=i;break}const y=ft.readCode(a,u,8);f+=te.castAsNonUtf8Char(y),u+=8}l=o}else{let x=l===Me.DIGIT?4:5;if(i-u<x)break;let p=ft.readCode(a,u,x);u+=x;let y=ft.getCharacter(l,p);y.startsWith("CTRL_")?(o=l,l=ft.getTable(y.charAt(5)),y.charAt(6)==="L"&&(o=l)):(f+=y,l=o)}return f}static getTable(a){switch(a){case"L":return Me.LOWER;case"P":return Me.PUNCT;case"M":return Me.MIXED;case"D":return Me.DIGIT;case"B":return Me.BINARY;case"U":default:return Me.UPPER}}static getCharacter(a,i){switch(a){case Me.UPPER:return ft.UPPER_TABLE[i];case Me.LOWER:return ft.LOWER_TABLE[i];case Me.MIXED:return ft.MIXED_TABLE[i];case Me.PUNCT:return ft.PUNCT_TABLE[i];case Me.DIGIT:return ft.DIGIT_TABLE[i];default:throw new lt("Bad table")}}correctBits(a){let i,o;this.ddata.getNbLayers()<=2?(o=6,i=Y.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(o=8,i=Y.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(o=10,i=Y.AZTEC_DATA_10):(o=12,i=Y.AZTEC_DATA_12);let l=this.ddata.getNbDatablocks(),f=a.length/o;if(f<l)throw new M;let u=a.length%o,x=new Int32Array(f);for(let R=0;R<f;R++,u+=o)x[R]=ft.readCode(a,u,o);try{new Xe(i).decode(x,f-l)}catch(R){throw new M(R)}let p=(1<<o)-1,y=0;for(let R=0;R<l;R++){let G=x[R];if(G===0||G===p)throw new M;(G===1||G===p-1)&&y++}let b=new Array(l*o-y),I=0;for(let R=0;R<l;R++){let G=x[R];if(G===1||G===p-1)b.fill(G>1,I,I+o-1),I+=o-1;else for(let Q=o-1;Q>=0;--Q)b[I++]=(G&1<<Q)!==0}return b}extractBits(a){let i=this.ddata.isCompact(),o=this.ddata.getNbLayers(),l=(i?11:14)+o*4,f=new Int32Array(l),u=new Array(this.totalBitsInLayer(o,i));if(i)for(let x=0;x<f.length;x++)f[x]=x;else{let x=l+1+2*O.truncDivision(O.truncDivision(l,2)-1,15),p=l/2,y=O.truncDivision(x,2);for(let b=0;b<p;b++){let I=b+O.truncDivision(b,15);f[p-b-1]=y-I-1,f[p+b]=y+I+1}}for(let x=0,p=0;x<o;x++){let y=(o-x)*4+(i?9:12),b=x*2,I=l-1-b;for(let R=0;R<y;R++){let G=R*2;for(let Q=0;Q<2;Q++)u[p+G+Q]=a.get(f[b+Q],f[b+R]),u[p+2*y+G+Q]=a.get(f[b+R],f[I-Q]),u[p+4*y+G+Q]=a.get(f[I-Q],f[I-R]),u[p+6*y+G+Q]=a.get(f[I-R],f[b+Q])}p+=y*8}return u}static readCode(a,i,o){let l=0;for(let f=i;f<i+o;f++)l<<=1,a[f]&&(l|=1);return l}static readByte(a,i){let o=a.length-i;return o>=8?ft.readCode(a,i,8):ft.readCode(a,i,o)<<8-o}static convertBoolArrayToByteArray(a){let i=new Uint8Array((a.length+7)/8);for(let o=0;o<i.length;o++)i[o]=ft.readByte(a,8*o);return i}totalBitsInLayer(a,i){return((i?88:112)+16*a)*a}}ft.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],ft.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],ft.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],ft.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],ft.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class vt{constructor(){}static round(a){return a===NaN?0:a<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:a>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:a+(a<0?-.5:.5)|0}static distance(a,i,o,l){const f=a-o,u=i-l;return Math.sqrt(f*f+u*u)}static sum(a){let i=0;for(let o=0,l=a.length;o!==l;o++){const f=a[o];i+=f}return i}}class qr{static floatToIntBits(a){return a}}qr.MAX_VALUE=Number.MAX_SAFE_INTEGER;class st{constructor(a,i){this.x=a,this.y=i}getX(){return this.x}getY(){return this.y}equals(a){if(a instanceof st){const i=a;return this.x===i.x&&this.y===i.y}return!1}hashCode(){return 31*qr.floatToIntBits(this.x)+qr.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(a){const i=this.distance(a[0],a[1]),o=this.distance(a[1],a[2]),l=this.distance(a[0],a[2]);let f,u,x;if(o>=i&&o>=l?(u=a[0],f=a[1],x=a[2]):l>=o&&l>=i?(u=a[1],f=a[0],x=a[2]):(u=a[2],f=a[0],x=a[1]),this.crossProductZ(f,u,x)<0){const p=f;f=x,x=p}a[0]=f,a[1]=u,a[2]=x}static distance(a,i){return vt.distance(a.x,a.y,i.x,i.y)}static crossProductZ(a,i,o){const l=i.x,f=i.y;return(o.x-l)*(a.y-f)-(o.y-f)*(a.x-l)}}class wn{constructor(a,i){this.bits=a,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class tn extends wn{constructor(a,i,o,l,f){super(a,i),this.compact=o,this.nbDatablocks=l,this.nbLayers=f}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class kr{constructor(a,i,o,l){this.image=a,this.height=a.getHeight(),this.width=a.getWidth(),i==null&&(i=kr.INIT_SIZE),o==null&&(o=a.getWidth()/2|0),l==null&&(l=a.getHeight()/2|0);const f=i/2|0;if(this.leftInit=o-f,this.rightInit=o+f,this.upInit=l-f,this.downInit=l+f,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new ae}detect(){let a=this.leftInit,i=this.rightInit,o=this.upInit,l=this.downInit,f=!1,u=!0,x=!1,p=!1,y=!1,b=!1,I=!1;const R=this.width,G=this.height;for(;u;){u=!1;let Q=!0;for(;(Q||!p)&&i<R;)Q=this.containsBlackPoint(o,l,i,!1),Q?(i++,u=!0,p=!0):p||i++;if(i>=R){f=!0;break}let re=!0;for(;(re||!y)&&l<G;)re=this.containsBlackPoint(a,i,l,!0),re?(l++,u=!0,y=!0):y||l++;if(l>=G){f=!0;break}let de=!0;for(;(de||!b)&&a>=0;)de=this.containsBlackPoint(o,l,a,!1),de?(a--,u=!0,b=!0):b||a--;if(a<0){f=!0;break}let Ae=!0;for(;(Ae||!I)&&o>=0;)Ae=this.containsBlackPoint(a,i,o,!0),Ae?(o--,u=!0,I=!0):I||o--;if(o<0){f=!0;break}u&&(x=!0)}if(!f&&x){const Q=i-a;let re=null;for(let Je=1;re===null&&Je<Q;Je++)re=this.getBlackPointOnSegment(a,l-Je,a+Je,l);if(re==null)throw new ae;let de=null;for(let Je=1;de===null&&Je<Q;Je++)de=this.getBlackPointOnSegment(a,o+Je,a+Je,o);if(de==null)throw new ae;let Ae=null;for(let Je=1;Ae===null&&Je<Q;Je++)Ae=this.getBlackPointOnSegment(i,o+Je,i-Je,o);if(Ae==null)throw new ae;let qe=null;for(let Je=1;qe===null&&Je<Q;Je++)qe=this.getBlackPointOnSegment(i,l-Je,i-Je,l);if(qe==null)throw new ae;return this.centerEdges(qe,re,Ae,de)}else throw new ae}getBlackPointOnSegment(a,i,o,l){const f=vt.round(vt.distance(a,i,o,l)),u=(o-a)/f,x=(l-i)/f,p=this.image;for(let y=0;y<f;y++){const b=vt.round(a+y*u),I=vt.round(i+y*x);if(p.get(b,I))return new st(b,I)}return null}centerEdges(a,i,o,l){const f=a.getX(),u=a.getY(),x=i.getX(),p=i.getY(),y=o.getX(),b=o.getY(),I=l.getX(),R=l.getY(),G=kr.CORR;return f<this.width/2?[new st(I-G,R+G),new st(x+G,p+G),new st(y-G,b-G),new st(f+G,u-G)]:[new st(I+G,R+G),new st(x+G,p-G),new st(y-G,b+G),new st(f-G,u-G)]}containsBlackPoint(a,i,o,l){const f=this.image;if(l){for(let u=a;u<=i;u++)if(f.get(u,o))return!0}else for(let u=a;u<=i;u++)if(f.get(o,u))return!0;return!1}}kr.INIT_SIZE=10,kr.CORR=1;class ga{static checkAndNudgePoints(a,i){const o=a.getWidth(),l=a.getHeight();let f=!0;for(let u=0;u<i.length&&f;u+=2){const x=Math.floor(i[u]),p=Math.floor(i[u+1]);if(x<-1||x>o||p<-1||p>l)throw new ae;f=!1,x===-1?(i[u]=0,f=!0):x===o&&(i[u]=o-1,f=!0),p===-1?(i[u+1]=0,f=!0):p===l&&(i[u+1]=l-1,f=!0)}f=!0;for(let u=i.length-2;u>=0&&f;u-=2){const x=Math.floor(i[u]),p=Math.floor(i[u+1]);if(x<-1||x>o||p<-1||p>l)throw new ae;f=!1,x===-1?(i[u]=0,f=!0):x===o&&(i[u]=o-1,f=!0),p===-1?(i[u+1]=0,f=!0):p===l&&(i[u+1]=l-1,f=!0)}}}class Rr{constructor(a,i,o,l,f,u,x,p,y){this.a11=a,this.a21=i,this.a31=o,this.a12=l,this.a22=f,this.a32=u,this.a13=x,this.a23=p,this.a33=y}static quadrilateralToQuadrilateral(a,i,o,l,f,u,x,p,y,b,I,R,G,Q,re,de){const Ae=Rr.quadrilateralToSquare(a,i,o,l,f,u,x,p);return Rr.squareToQuadrilateral(y,b,I,R,G,Q,re,de).times(Ae)}transformPoints(a){const i=a.length,o=this.a11,l=this.a12,f=this.a13,u=this.a21,x=this.a22,p=this.a23,y=this.a31,b=this.a32,I=this.a33;for(let R=0;R<i;R+=2){const G=a[R],Q=a[R+1],re=f*G+p*Q+I;a[R]=(o*G+u*Q+y)/re,a[R+1]=(l*G+x*Q+b)/re}}transformPointsWithValues(a,i){const o=this.a11,l=this.a12,f=this.a13,u=this.a21,x=this.a22,p=this.a23,y=this.a31,b=this.a32,I=this.a33,R=a.length;for(let G=0;G<R;G++){const Q=a[G],re=i[G],de=f*Q+p*re+I;a[G]=(o*Q+u*re+y)/de,i[G]=(l*Q+x*re+b)/de}}static squareToQuadrilateral(a,i,o,l,f,u,x,p){const y=a-o+f-x,b=i-l+u-p;if(y===0&&b===0)return new Rr(o-a,f-o,a,l-i,u-l,i,0,0,1);{const I=o-f,R=x-f,G=l-u,Q=p-u,re=I*Q-R*G,de=(y*Q-R*b)/re,Ae=(I*b-y*G)/re;return new Rr(o-a+de*o,x-a+Ae*x,a,l-i+de*l,p-i+Ae*p,i,de,Ae,1)}}static quadrilateralToSquare(a,i,o,l,f,u,x,p){return Rr.squareToQuadrilateral(a,i,o,l,f,u,x,p).buildAdjoint()}buildAdjoint(){return new Rr(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(a){return new Rr(this.a11*a.a11+this.a21*a.a12+this.a31*a.a13,this.a11*a.a21+this.a21*a.a22+this.a31*a.a23,this.a11*a.a31+this.a21*a.a32+this.a31*a.a33,this.a12*a.a11+this.a22*a.a12+this.a32*a.a13,this.a12*a.a21+this.a22*a.a22+this.a32*a.a23,this.a12*a.a31+this.a22*a.a32+this.a32*a.a33,this.a13*a.a11+this.a23*a.a12+this.a33*a.a13,this.a13*a.a21+this.a23*a.a22+this.a33*a.a23,this.a13*a.a31+this.a23*a.a32+this.a33*a.a33)}}class Xn extends ga{sampleGrid(a,i,o,l,f,u,x,p,y,b,I,R,G,Q,re,de,Ae,qe,Je){const Ge=Rr.quadrilateralToQuadrilateral(l,f,u,x,p,y,b,I,R,G,Q,re,de,Ae,qe,Je);return this.sampleGridWithTransform(a,i,o,Ge)}sampleGridWithTransform(a,i,o,l){if(i<=0||o<=0)throw new ae;const f=new $e(i,o),u=new Float32Array(2*i);for(let x=0;x<o;x++){const p=u.length,y=x+.5;for(let b=0;b<p;b+=2)u[b]=b/2+.5,u[b+1]=y;l.transformPoints(u),ga.checkAndNudgePoints(a,u);try{for(let b=0;b<p;b+=2)a.get(Math.floor(u[b]),Math.floor(u[b+1]))&&f.set(b/2,x)}catch{throw new ae}}return f}}class Ar{static setGridSampler(a){Ar.gridSampler=a}static getInstance(){return Ar.gridSampler}}Ar.gridSampler=new Xn;class Yt{constructor(a,i){this.x=a,this.y=i}toResultPoint(){return new st(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Ct{constructor(a){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=a}detect(){return this.detectMirror(!1)}detectMirror(a){let i=this.getMatrixCenter(),o=this.getBullsEyeCorners(i);if(a){let u=o[0];o[0]=o[2],o[2]=u}this.extractParameters(o);let l=this.sampleGrid(this.image,o[this.shift%4],o[(this.shift+1)%4],o[(this.shift+2)%4],o[(this.shift+3)%4]),f=this.getMatrixCornerPoints(o);return new tn(l,f,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(a){if(!this.isValidPoint(a[0])||!this.isValidPoint(a[1])||!this.isValidPoint(a[2])||!this.isValidPoint(a[3]))throw new ae;let i=2*this.nbCenterLayers,o=new Int32Array([this.sampleLine(a[0],a[1],i),this.sampleLine(a[1],a[2],i),this.sampleLine(a[2],a[3],i),this.sampleLine(a[3],a[0],i)]);this.shift=this.getRotation(o,i);let l=0;for(let u=0;u<4;u++){let x=o[(this.shift+u)%4];this.compact?(l<<=7,l+=x>>1&127):(l<<=10,l+=(x>>2&992)+(x>>1&31))}let f=this.getCorrectedParameterData(l,this.compact);this.compact?(this.nbLayers=(f>>6)+1,this.nbDataBlocks=(f&63)+1):(this.nbLayers=(f>>11)+1,this.nbDataBlocks=(f&2047)+1)}getRotation(a,i){let o=0;a.forEach((l,f,u)=>{let x=(l>>i-2<<1)+(l&1);o=(o<<3)+x}),o=((o&1)<<11)+(o>>1);for(let l=0;l<4;l++)if(O.bitCount(o^this.EXPECTED_CORNER_BITS[l])<=2)return l;throw new ae}getCorrectedParameterData(a,i){let o,l;i?(o=7,l=2):(o=10,l=4);let f=o-l,u=new Int32Array(o);for(let p=o-1;p>=0;--p)u[p]=a&15,a>>=4;try{new Xe(Y.AZTEC_PARAM).decode(u,f)}catch{throw new ae}let x=0;for(let p=0;p<l;p++)x=(x<<4)+u[p];return x}getBullsEyeCorners(a){let i=a,o=a,l=a,f=a,u=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let I=this.getFirstDifferent(i,u,1,-1),R=this.getFirstDifferent(o,u,1,1),G=this.getFirstDifferent(l,u,-1,1),Q=this.getFirstDifferent(f,u,-1,-1);if(this.nbCenterLayers>2){let re=this.distancePoint(Q,I)*this.nbCenterLayers/(this.distancePoint(f,i)*(this.nbCenterLayers+2));if(re<.75||re>1.25||!this.isWhiteOrBlackRectangle(I,R,G,Q))break}i=I,o=R,l=G,f=Q,u=!u}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new ae;this.compact=this.nbCenterLayers===5;let x=new st(i.getX()+.5,i.getY()-.5),p=new st(o.getX()+.5,o.getY()+.5),y=new st(l.getX()-.5,l.getY()+.5),b=new st(f.getX()-.5,f.getY()-.5);return this.expandSquare([x,p,y,b],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let a,i,o,l;try{let x=new kr(this.image).detect();a=x[0],i=x[1],o=x[2],l=x[3]}catch{let p=this.image.getWidth()/2,y=this.image.getHeight()/2;a=this.getFirstDifferent(new Yt(p+7,y-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new Yt(p+7,y+7),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new Yt(p-7,y+7),!1,-1,1).toResultPoint(),l=this.getFirstDifferent(new Yt(p-7,y-7),!1,-1,-1).toResultPoint()}let f=vt.round((a.getX()+l.getX()+i.getX()+o.getX())/4),u=vt.round((a.getY()+l.getY()+i.getY()+o.getY())/4);try{let x=new kr(this.image,15,f,u).detect();a=x[0],i=x[1],o=x[2],l=x[3]}catch{a=this.getFirstDifferent(new Yt(f+7,u-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new Yt(f+7,u+7),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new Yt(f-7,u+7),!1,-1,1).toResultPoint(),l=this.getFirstDifferent(new Yt(f-7,u-7),!1,-1,-1).toResultPoint()}return f=vt.round((a.getX()+l.getX()+i.getX()+o.getX())/4),u=vt.round((a.getY()+l.getY()+i.getY()+o.getY())/4),new Yt(f,u)}getMatrixCornerPoints(a){return this.expandSquare(a,2*this.nbCenterLayers,this.getDimension())}sampleGrid(a,i,o,l,f){let u=Ar.getInstance(),x=this.getDimension(),p=x/2-this.nbCenterLayers,y=x/2+this.nbCenterLayers;return u.sampleGrid(a,x,x,p,p,y,p,y,y,p,y,i.getX(),i.getY(),o.getX(),o.getY(),l.getX(),l.getY(),f.getX(),f.getY())}sampleLine(a,i,o){let l=0,f=this.distanceResultPoint(a,i),u=f/o,x=a.getX(),p=a.getY(),y=u*(i.getX()-a.getX())/f,b=u*(i.getY()-a.getY())/f;for(let I=0;I<o;I++)this.image.get(vt.round(x+I*y),vt.round(p+I*b))&&(l|=1<<o-I-1);return l}isWhiteOrBlackRectangle(a,i,o,l){let f=3;a=new Yt(a.getX()-f,a.getY()+f),i=new Yt(i.getX()-f,i.getY()-f),o=new Yt(o.getX()+f,o.getY()-f),l=new Yt(l.getX()+f,l.getY()+f);let u=this.getColor(l,a);if(u===0)return!1;let x=this.getColor(a,i);return x!==u||(x=this.getColor(i,o),x!==u)?!1:(x=this.getColor(o,l),x===u)}getColor(a,i){let o=this.distancePoint(a,i),l=(i.getX()-a.getX())/o,f=(i.getY()-a.getY())/o,u=0,x=a.getX(),p=a.getY(),y=this.image.get(a.getX(),a.getY()),b=Math.ceil(o);for(let R=0;R<b;R++)x+=l,p+=f,this.image.get(vt.round(x),vt.round(p))!==y&&u++;let I=u/o;return I>.1&&I<.9?0:I<=.1===y?1:-1}getFirstDifferent(a,i,o,l){let f=a.getX()+o,u=a.getY()+l;for(;this.isValid(f,u)&&this.image.get(f,u)===i;)f+=o,u+=l;for(f-=o,u-=l;this.isValid(f,u)&&this.image.get(f,u)===i;)f+=o;for(f-=o;this.isValid(f,u)&&this.image.get(f,u)===i;)u+=l;return u-=l,new Yt(f,u)}expandSquare(a,i,o){let l=o/(2*i),f=a[0].getX()-a[2].getX(),u=a[0].getY()-a[2].getY(),x=(a[0].getX()+a[2].getX())/2,p=(a[0].getY()+a[2].getY())/2,y=new st(x+l*f,p+l*u),b=new st(x-l*f,p-l*u);f=a[1].getX()-a[3].getX(),u=a[1].getY()-a[3].getY(),x=(a[1].getX()+a[3].getX())/2,p=(a[1].getY()+a[3].getY())/2;let I=new st(x+l*f,p+l*u),R=new st(x-l*f,p-l*u);return[y,I,b,R]}isValid(a,i){return a>=0&&a<this.image.getWidth()&&i>0&&i<this.image.getHeight()}isValidPoint(a){let i=vt.round(a.getX()),o=vt.round(a.getY());return this.isValid(i,o)}distancePoint(a,i){return vt.distance(a.getX(),a.getY(),i.getX(),i.getY())}distanceResultPoint(a,i){return vt.distance(a.getX(),a.getY(),i.getX(),i.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(O.truncDivision(this.nbLayers-4,8)+1)+15}}class fr{decode(a,i=null){let o=null,l=new Ct(a.getBlackMatrix()),f=null,u=null;try{let b=l.detectMirror(!1);f=b.getPoints(),this.reportFoundResultPoints(i,f),u=new ft().decode(b)}catch(b){o=b}if(u==null)try{let b=l.detectMirror(!0);f=b.getPoints(),this.reportFoundResultPoints(i,f),u=new ft().decode(b)}catch(b){throw o??b}let x=new ee(u.getText(),u.getRawBytes(),u.getNumBits(),f,le.AZTEC,C.currentTimeMillis()),p=u.getByteSegments();p!=null&&x.putMetadata(Le.BYTE_SEGMENTS,p);let y=u.getECLevel();return y!=null&&x.putMetadata(Le.ERROR_CORRECTION_LEVEL,y),x}reportFoundResultPoints(a,i){if(a!=null){let o=a.get(J.NEED_RESULT_POINT_CALLBACK);o!=null&&i.forEach((l,f,u)=>{o.foundPossibleResultPoint(l)})}}reset(){}}class ca extends ce{constructor(a=500){super(new fr,a)}}class Ft{decode(a,i){try{return this.doDecode(a,i)}catch{if(i&&i.get(J.TRY_HARDER)===!0&&a.isRotateSupported()){const f=a.rotateCounterClockwise(),u=this.doDecode(f,i),x=u.getResultMetadata();let p=270;x!==null&&x.get(Le.ORIENTATION)===!0&&(p=p+x.get(Le.ORIENTATION)%360),u.putMetadata(Le.ORIENTATION,p);const y=u.getResultPoints();if(y!==null){const b=f.getHeight();for(let I=0;I<y.length;I++)y[I]=new st(b-y[I].getY()-1,y[I].getX())}return u}else throw new ae}}reset(){}doDecode(a,i){const o=a.getWidth(),l=a.getHeight();let f=new q(o);const u=i&&i.get(J.TRY_HARDER)===!0,x=Math.max(1,l>>(u?8:5));let p;u?p=l:p=15;const y=Math.trunc(l/2);for(let b=0;b<p;b++){const I=Math.trunc((b+1)/2),R=(b&1)===0,G=y+x*(R?I:-I);if(G<0||G>=l)break;try{f=a.getBlackRow(G,f)}catch{continue}for(let Q=0;Q<2;Q++){if(Q===1&&(f.reverse(),i&&i.get(J.NEED_RESULT_POINT_CALLBACK)===!0)){const re=new Map;i.forEach((de,Ae)=>re.set(Ae,de)),re.delete(J.NEED_RESULT_POINT_CALLBACK),i=re}try{const re=this.decodeRow(G,f,i);if(Q===1){re.putMetadata(Le.ORIENTATION,180);const de=re.getResultPoints();de!==null&&(de[0]=new st(o-de[0].getX()-1,de[0].getY()),de[1]=new st(o-de[1].getX()-1,de[1].getY()))}return re}catch{}}}throw new ae}static recordPattern(a,i,o){const l=o.length;for(let y=0;y<l;y++)o[y]=0;const f=a.getSize();if(i>=f)throw new ae;let u=!a.get(i),x=0,p=i;for(;p<f;){if(a.get(p)!==u)o[x]++;else{if(++x===l)break;o[x]=1,u=!u}p++}if(!(x===l||x===l-1&&p===f))throw new ae}static recordPatternInReverse(a,i,o){let l=o.length,f=a.get(i);for(;i>0&&l>=0;)a.get(--i)!==f&&(l--,f=!f);if(l>=0)throw new ae;Ft.recordPattern(a,i+1,o)}static patternMatchVariance(a,i,o){const l=a.length;let f=0,u=0;for(let y=0;y<l;y++)f+=a[y],u+=i[y];if(f<u)return Number.POSITIVE_INFINITY;const x=f/u;o*=x;let p=0;for(let y=0;y<l;y++){const b=a[y],I=i[y]*x,R=b>I?b-I:I-b;if(R>o)return Number.POSITIVE_INFINITY;p+=R}return p/f}}class Qe extends Ft{static findStartPattern(a){const i=a.getSize(),o=a.getNextSet(0);let l=0,f=Int32Array.from([0,0,0,0,0,0]),u=o,x=!1;const p=6;for(let y=o;y<i;y++)if(a.get(y)!==x)f[l]++;else{if(l===p-1){let b=Qe.MAX_AVG_VARIANCE,I=-1;for(let R=Qe.CODE_START_A;R<=Qe.CODE_START_C;R++){const G=Ft.patternMatchVariance(f,Qe.CODE_PATTERNS[R],Qe.MAX_INDIVIDUAL_VARIANCE);G<b&&(b=G,I=R)}if(I>=0&&a.isRange(Math.max(0,u-(y-u)/2),u,!1))return Int32Array.from([u,y,I]);u+=f[0]+f[1],f=f.slice(2,f.length-1),f[l-1]=0,f[l]=0,l--}else l++;f[l]=1,x=!x}throw new ae}static decodeCode(a,i,o){Ft.recordPattern(a,o,i);let l=Qe.MAX_AVG_VARIANCE,f=-1;for(let u=0;u<Qe.CODE_PATTERNS.length;u++){const x=Qe.CODE_PATTERNS[u],p=this.patternMatchVariance(i,x,Qe.MAX_INDIVIDUAL_VARIANCE);p<l&&(l=p,f=u)}if(f>=0)return f;throw new ae}decodeRow(a,i,o){const l=o&&o.get(J.ASSUME_GS1)===!0,f=Qe.findStartPattern(i),u=f[2];let x=0;const p=new Uint8Array(20);p[x++]=u;let y;switch(u){case Qe.CODE_START_A:y=Qe.CODE_CODE_A;break;case Qe.CODE_START_B:y=Qe.CODE_CODE_B;break;case Qe.CODE_START_C:y=Qe.CODE_CODE_C;break;default:throw new M}let b=!1,I=!1,R="",G=f[0],Q=f[1];const re=Int32Array.from([0,0,0,0,0,0]);let de=0,Ae=0,qe=u,Je=0,Ge=!0,Gt=!1,Dt=!1;for(;!b;){const E=I;switch(I=!1,de=Ae,Ae=Qe.decodeCode(i,re,Q),p[x++]=Ae,Ae!==Qe.CODE_STOP&&(Ge=!0),Ae!==Qe.CODE_STOP&&(Je++,qe+=Je*Ae),G=Q,Q+=re.reduce((P,Z)=>P+Z,0),Ae){case Qe.CODE_START_A:case Qe.CODE_START_B:case Qe.CODE_START_C:throw new M}switch(y){case Qe.CODE_CODE_A:if(Ae<64)Dt===Gt?R+=String.fromCharCode(32+Ae):R+=String.fromCharCode(32+Ae+128),Dt=!1;else if(Ae<96)Dt===Gt?R+=String.fromCharCode(Ae-64):R+=String.fromCharCode(Ae+64),Dt=!1;else switch(Ae!==Qe.CODE_STOP&&(Ge=!1),Ae){case Qe.CODE_FNC_1:l&&(R.length===0?R+="]C1":R+="");break;case Qe.CODE_FNC_2:case Qe.CODE_FNC_3:break;case Qe.CODE_FNC_4_A:!Gt&&Dt?(Gt=!0,Dt=!1):Gt&&Dt?(Gt=!1,Dt=!1):Dt=!0;break;case Qe.CODE_SHIFT:I=!0,y=Qe.CODE_CODE_B;break;case Qe.CODE_CODE_B:y=Qe.CODE_CODE_B;break;case Qe.CODE_CODE_C:y=Qe.CODE_CODE_C;break;case Qe.CODE_STOP:b=!0;break}break;case Qe.CODE_CODE_B:if(Ae<96)Dt===Gt?R+=String.fromCharCode(32+Ae):R+=String.fromCharCode(32+Ae+128),Dt=!1;else switch(Ae!==Qe.CODE_STOP&&(Ge=!1),Ae){case Qe.CODE_FNC_1:l&&(R.length===0?R+="]C1":R+="");break;case Qe.CODE_FNC_2:case Qe.CODE_FNC_3:break;case Qe.CODE_FNC_4_B:!Gt&&Dt?(Gt=!0,Dt=!1):Gt&&Dt?(Gt=!1,Dt=!1):Dt=!0;break;case Qe.CODE_SHIFT:I=!0,y=Qe.CODE_CODE_A;break;case Qe.CODE_CODE_A:y=Qe.CODE_CODE_A;break;case Qe.CODE_CODE_C:y=Qe.CODE_CODE_C;break;case Qe.CODE_STOP:b=!0;break}break;case Qe.CODE_CODE_C:if(Ae<100)Ae<10&&(R+="0"),R+=Ae;else switch(Ae!==Qe.CODE_STOP&&(Ge=!1),Ae){case Qe.CODE_FNC_1:l&&(R.length===0?R+="]C1":R+="");break;case Qe.CODE_CODE_A:y=Qe.CODE_CODE_A;break;case Qe.CODE_CODE_B:y=Qe.CODE_CODE_B;break;case Qe.CODE_STOP:b=!0;break}break}E&&(y=y===Qe.CODE_CODE_A?Qe.CODE_CODE_B:Qe.CODE_CODE_A)}const la=Q-G;if(Q=i.getNextUnset(Q),!i.isRange(Q,Math.min(i.getSize(),Q+(Q-G)/2),!1))throw new ae;if(qe-=Je*de,qe%103!==de)throw new T;const Ra=R.length;if(Ra===0)throw new ae;Ra>0&&Ge&&(y===Qe.CODE_CODE_C?R=R.substring(0,Ra-2):R=R.substring(0,Ra-1));const fa=(f[1]+f[0])/2,dr=G+la/2,Fr=p.length,Ma=new Uint8Array(Fr);for(let E=0;E<Fr;E++)Ma[E]=p[E];const ai=[new st(fa,a),new st(dr,a)];return new ee(R,Ma,0,ai,le.CODE_128,new Date().getTime())}}Qe.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Qe.MAX_AVG_VARIANCE=.25,Qe.MAX_INDIVIDUAL_VARIANCE=.7,Qe.CODE_SHIFT=98,Qe.CODE_CODE_C=99,Qe.CODE_CODE_B=100,Qe.CODE_CODE_A=101,Qe.CODE_FNC_1=102,Qe.CODE_FNC_2=97,Qe.CODE_FNC_3=96,Qe.CODE_FNC_4_A=101,Qe.CODE_FNC_4_B=100,Qe.CODE_START_A=103,Qe.CODE_START_B=104,Qe.CODE_START_C=105,Qe.CODE_STOP=106;class br extends Ft{constructor(a=!1,i=!1){super(),this.usingCheckDigit=a,this.extendedMode=i,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(a,i,o){let l=this.counters;l.fill(0),this.decodeRowResult="";let f=br.findAsteriskPattern(i,l),u=i.getNextSet(f[1]),x=i.getSize(),p,y;do{br.recordPattern(i,u,l);let re=br.toNarrowWidePattern(l);if(re<0)throw new ae;p=br.patternToChar(re),this.decodeRowResult+=p,y=u;for(let de of l)u+=de;u=i.getNextSet(u)}while(p!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let b=0;for(let re of l)b+=re;let I=u-y-b;if(u!==x&&I*2<b)throw new ae;if(this.usingCheckDigit){let re=this.decodeRowResult.length-1,de=0;for(let Ae=0;Ae<re;Ae++)de+=br.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(Ae));if(this.decodeRowResult.charAt(re)!==br.ALPHABET_STRING.charAt(de%43))throw new T;this.decodeRowResult=this.decodeRowResult.substring(0,re)}if(this.decodeRowResult.length===0)throw new ae;let R;this.extendedMode?R=br.decodeExtended(this.decodeRowResult):R=this.decodeRowResult;let G=(f[1]+f[0])/2,Q=y+b/2;return new ee(R,null,0,[new st(G,a),new st(Q,a)],le.CODE_39,new Date().getTime())}static findAsteriskPattern(a,i){let o=a.getSize(),l=a.getNextSet(0),f=0,u=l,x=!1,p=i.length;for(let y=l;y<o;y++)if(a.get(y)!==x)i[f]++;else{if(f===p-1){if(this.toNarrowWidePattern(i)===br.ASTERISK_ENCODING&&a.isRange(Math.max(0,u-Math.floor((y-u)/2)),u,!1))return[u,y];u+=i[0]+i[1],i.copyWithin(0,2,2+f-1),i[f-1]=0,i[f]=0,f--}else f++;i[f]=1,x=!x}throw new ae}static toNarrowWidePattern(a){let i=a.length,o=0,l;do{let f=2147483647;for(let p of a)p<f&&p>o&&(f=p);o=f,l=0;let u=0,x=0;for(let p=0;p<i;p++){let y=a[p];y>o&&(x|=1<<i-1-p,l++,u+=y)}if(l===3){for(let p=0;p<i&&l>0;p++){let y=a[p];if(y>o&&(l--,y*2>=u))return-1}return x}}while(l>3);return-1}static patternToChar(a){for(let i=0;i<br.CHARACTER_ENCODINGS.length;i++)if(br.CHARACTER_ENCODINGS[i]===a)return br.ALPHABET_STRING.charAt(i);if(a===br.ASTERISK_ENCODING)return"*";throw new ae}static decodeExtended(a){let i=a.length,o="";for(let l=0;l<i;l++){let f=a.charAt(l);if(f==="+"||f==="$"||f==="%"||f==="/"){let u=a.charAt(l+1),x="\0";switch(f){case"+":if(u>="A"&&u<="Z")x=String.fromCharCode(u.charCodeAt(0)+32);else throw new M;break;case"$":if(u>="A"&&u<="Z")x=String.fromCharCode(u.charCodeAt(0)-64);else throw new M;break;case"%":if(u>="A"&&u<="E")x=String.fromCharCode(u.charCodeAt(0)-38);else if(u>="F"&&u<="J")x=String.fromCharCode(u.charCodeAt(0)-11);else if(u>="K"&&u<="O")x=String.fromCharCode(u.charCodeAt(0)+16);else if(u>="P"&&u<="T")x=String.fromCharCode(u.charCodeAt(0)+43);else if(u==="U")x="\0";else if(u==="V")x="@";else if(u==="W")x="`";else if(u==="X"||u==="Y"||u==="Z")x="";else throw new M;break;case"/":if(u>="A"&&u<="O")x=String.fromCharCode(u.charCodeAt(0)-32);else if(u==="Z")x=":";else throw new M;break}o+=x,l++}else o+=f}return o}}br.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",br.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],br.ASTERISK_ENCODING=148;class or extends Ft{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(a,i,o){let l=this.decodeStart(i),f=this.decodeEnd(i),u=new be;or.decodeMiddle(i,l[1],f[0],u);let x=u.toString(),p=null;o!=null&&(p=o.get(J.ALLOWED_LENGTHS)),p==null&&(p=or.DEFAULT_ALLOWED_LENGTHS);let y=x.length,b=!1,I=0;for(let Q of p){if(y===Q){b=!0;break}Q>I&&(I=Q)}if(!b&&y>I&&(b=!0),!b)throw new M;const R=[new st(l[1],a),new st(f[0],a)];return new ee(x,null,0,R,le.ITF,new Date().getTime())}static decodeMiddle(a,i,o,l){let f=new Int32Array(10),u=new Int32Array(5),x=new Int32Array(5);for(f.fill(0),u.fill(0),x.fill(0);i<o;){Ft.recordPattern(a,i,f);for(let y=0;y<5;y++){let b=2*y;u[y]=f[b],x[y]=f[b+1]}let p=or.decodeDigit(u);l.append(p.toString()),p=this.decodeDigit(x),l.append(p.toString()),f.forEach(function(y){i+=y})}}decodeStart(a){let i=or.skipWhiteSpace(a),o=or.findGuardPattern(a,i,or.START_PATTERN);return this.narrowLineWidth=(o[1]-o[0])/4,this.validateQuietZone(a,o[0]),o}validateQuietZone(a,i){let o=this.narrowLineWidth*10;o=o<i?o:i;for(let l=i-1;o>0&&l>=0&&!a.get(l);l--)o--;if(o!==0)throw new ae}static skipWhiteSpace(a){const i=a.getSize(),o=a.getNextSet(0);if(o===i)throw new ae;return o}decodeEnd(a){a.reverse();try{let i=or.skipWhiteSpace(a),o;try{o=or.findGuardPattern(a,i,or.END_PATTERN_REVERSED[0])}catch(f){f instanceof ae&&(o=or.findGuardPattern(a,i,or.END_PATTERN_REVERSED[1]))}this.validateQuietZone(a,o[0]);let l=o[0];return o[0]=a.getSize()-o[1],o[1]=a.getSize()-l,o}finally{a.reverse()}}static findGuardPattern(a,i,o){let l=o.length,f=new Int32Array(l),u=a.getSize(),x=!1,p=0,y=i;f.fill(0);for(let b=i;b<u;b++)if(a.get(b)!==x)f[p]++;else{if(p===l-1){if(Ft.patternMatchVariance(f,o,or.MAX_INDIVIDUAL_VARIANCE)<or.MAX_AVG_VARIANCE)return[y,b];y+=f[0]+f[1],C.arraycopy(f,2,f,0,p-1),f[p-1]=0,f[p]=0,p--}else p++;f[p]=1,x=!x}throw new ae}static decodeDigit(a){let i=or.MAX_AVG_VARIANCE,o=-1,l=or.PATTERNS.length;for(let f=0;f<l;f++){let u=or.PATTERNS[f],x=Ft.patternMatchVariance(a,u,or.MAX_INDIVIDUAL_VARIANCE);x<i?(i=x,o=f):x===i&&(o=-1)}if(o>=0)return o%10;throw new ae}}or.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],or.MAX_AVG_VARIANCE=.38,or.MAX_INDIVIDUAL_VARIANCE=.5,or.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],or.START_PATTERN=Int32Array.from([1,1,1,1]),or.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class yr extends Ft{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(a){let i=!1,o,l=0,f=Int32Array.from([0,0,0]);for(;!i;){f=Int32Array.from([0,0,0]),o=yr.findGuardPattern(a,l,!1,this.START_END_PATTERN,f);let u=o[0];l=o[1];let x=u-(l-u);x>=0&&(i=a.isRange(x,u,!1))}return o}static checkChecksum(a){return yr.checkStandardUPCEANChecksum(a)}static checkStandardUPCEANChecksum(a){let i=a.length;if(i===0)return!1;let o=parseInt(a.charAt(i-1),10);return yr.getStandardUPCEANChecksum(a.substring(0,i-1))===o}static getStandardUPCEANChecksum(a){let i=a.length,o=0;for(let l=i-1;l>=0;l-=2){let f=a.charAt(l).charCodeAt(0)-48;if(f<0||f>9)throw new M;o+=f}o*=3;for(let l=i-2;l>=0;l-=2){let f=a.charAt(l).charCodeAt(0)-48;if(f<0||f>9)throw new M;o+=f}return(1e3-o)%10}static decodeEnd(a,i){return yr.findGuardPattern(a,i,!1,yr.START_END_PATTERN,new Int32Array(yr.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(a,i,o,l){return this.findGuardPattern(a,i,o,l,new Int32Array(l.length))}static findGuardPattern(a,i,o,l,f){let u=a.getSize();i=o?a.getNextUnset(i):a.getNextSet(i);let x=0,p=i,y=l.length,b=o;for(let I=i;I<u;I++)if(a.get(I)!==b)f[x]++;else{if(x===y-1){if(Ft.patternMatchVariance(f,l,yr.MAX_INDIVIDUAL_VARIANCE)<yr.MAX_AVG_VARIANCE)return Int32Array.from([p,I]);p+=f[0]+f[1];let R=f.slice(2,f.length-1);for(let G=0;G<x-1;G++)f[G]=R[G];f[x-1]=0,f[x]=0,x--}else x++;f[x]=1,b=!b}throw new ae}static decodeDigit(a,i,o,l){this.recordPattern(a,o,i);let f=this.MAX_AVG_VARIANCE,u=-1,x=l.length;for(let p=0;p<x;p++){let y=l[p],b=Ft.patternMatchVariance(i,y,yr.MAX_INDIVIDUAL_VARIANCE);b<f&&(f=b,u=p)}if(u>=0)return u;throw new ae}}yr.MAX_AVG_VARIANCE=.48,yr.MAX_INDIVIDUAL_VARIANCE=.7,yr.START_END_PATTERN=Int32Array.from([1,1,1]),yr.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),yr.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),yr.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class In{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(a,i,o){let l=this.decodeRowStringBuffer,f=this.decodeMiddle(i,o,l),u=l.toString(),x=In.parseExtensionString(u),p=[new st((o[0]+o[1])/2,a),new st(f,a)],y=new ee(u,null,0,p,le.UPC_EAN_EXTENSION,new Date().getTime());return x!=null&&y.putAllMetadata(x),y}decodeMiddle(a,i,o){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let f=a.getSize(),u=i[1],x=0;for(let y=0;y<5&&u<f;y++){let b=yr.decodeDigit(a,l,u,yr.L_AND_G_PATTERNS);o+=String.fromCharCode(48+b%10);for(let I of l)u+=I;b>=10&&(x|=1<<4-y),y!==4&&(u=a.getNextSet(u),u=a.getNextUnset(u))}if(o.length!==5)throw new ae;let p=this.determineCheckDigit(x);if(In.extensionChecksum(o.toString())!==p)throw new ae;return u}static extensionChecksum(a){let i=a.length,o=0;for(let l=i-2;l>=0;l-=2)o+=a.charAt(l).charCodeAt(0)-48;o*=3;for(let l=i-1;l>=0;l-=2)o+=a.charAt(l).charCodeAt(0)-48;return o*=3,o%10}determineCheckDigit(a){for(let i=0;i<10;i++)if(a===this.CHECK_DIGIT_ENCODINGS[i])return i;throw new ae}static parseExtensionString(a){if(a.length!==5)return null;let i=In.parseExtension5String(a);return i==null?null:new Map([[Le.SUGGESTED_PRICE,i]])}static parseExtension5String(a){let i;switch(a.charAt(0)){case"0":i="£";break;case"5":i="$";break;case"9":switch(a){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}i="";break;default:i="";break}let o=parseInt(a.substring(1)),l=(o/100).toString(),f=o%100,u=f<10?"0"+f:f.toString();return i+l+"."+u}}class rn{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(a,i,o){let l=this.decodeRowStringBuffer,f=this.decodeMiddle(i,o,l),u=l.toString(),x=rn.parseExtensionString(u),p=[new st((o[0]+o[1])/2,a),new st(f,a)],y=new ee(u,null,0,p,le.UPC_EAN_EXTENSION,new Date().getTime());return x!=null&&y.putAllMetadata(x),y}decodeMiddle(a,i,o){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let f=a.getSize(),u=i[1],x=0;for(let p=0;p<2&&u<f;p++){let y=yr.decodeDigit(a,l,u,yr.L_AND_G_PATTERNS);o+=String.fromCharCode(48+y%10);for(let b of l)u+=b;y>=10&&(x|=1<<1-p),p!==1&&(u=a.getNextSet(u),u=a.getNextUnset(u))}if(o.length!==2)throw new ae;if(parseInt(o.toString())%4!==x)throw new ae;return u}static parseExtensionString(a){return a.length!==2?null:new Map([[Le.ISSUE_NUMBER,parseInt(a)]])}}class mi{static decodeRow(a,i,o){let l=yr.findGuardPattern(i,o,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new In().decodeRow(a,i,l)}catch{return new rn().decodeRow(a,i,l)}}}mi.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Rt extends yr{constructor(){super(),this.decodeRowStringBuffer="",Rt.L_AND_G_PATTERNS=Rt.L_PATTERNS.map(a=>Int32Array.from(a));for(let a=10;a<20;a++){let i=Rt.L_PATTERNS[a-10],o=new Int32Array(i.length);for(let l=0;l<i.length;l++)o[l]=i[i.length-l-1];Rt.L_AND_G_PATTERNS[a]=o}}decodeRow(a,i,o){let l=Rt.findStartGuardPattern(i),f=o==null?null:o.get(J.NEED_RESULT_POINT_CALLBACK);if(f!=null){const Ge=new st((l[0]+l[1])/2,a);f.foundPossibleResultPoint(Ge)}let u=this.decodeMiddle(i,l,this.decodeRowStringBuffer),x=u.rowOffset,p=u.resultString;if(f!=null){const Ge=new st(x,a);f.foundPossibleResultPoint(Ge)}let y=this.decodeEnd(i,x);if(f!=null){const Ge=new st((y[0]+y[1])/2,a);f.foundPossibleResultPoint(Ge)}let b=y[1],I=b+(b-y[0]);if(I>=i.getSize()||!i.isRange(b,I,!1))throw new ae;let R=p.toString();if(R.length<8)throw new M;if(!Rt.checkChecksum(R))throw new T;let G=(l[1]+l[0])/2,Q=(y[1]+y[0])/2,re=this.getBarcodeFormat(),de=[new st(G,a),new st(Q,a)],Ae=new ee(R,null,0,de,re,new Date().getTime()),qe=0;try{let Ge=mi.decodeRow(a,i,y[1]);Ae.putMetadata(Le.UPC_EAN_EXTENSION,Ge.getText()),Ae.putAllMetadata(Ge.getResultMetadata()),Ae.addResultPoints(Ge.getResultPoints()),qe=Ge.getText().length}catch{}let Je=o==null?null:o.get(J.ALLOWED_EAN_EXTENSIONS);if(Je!=null){let Ge=!1;for(let Gt in Je)if(qe.toString()===Gt){Ge=!0;break}if(!Ge)throw new ae}return Ae}decodeEnd(a,i){return Rt.findGuardPattern(a,i,!1,Rt.START_END_PATTERN,new Int32Array(Rt.START_END_PATTERN.length).fill(0))}static checkChecksum(a){return Rt.checkStandardUPCEANChecksum(a)}static checkStandardUPCEANChecksum(a){let i=a.length;if(i===0)return!1;let o=parseInt(a.charAt(i-1),10);return Rt.getStandardUPCEANChecksum(a.substring(0,i-1))===o}static getStandardUPCEANChecksum(a){let i=a.length,o=0;for(let l=i-1;l>=0;l-=2){let f=a.charAt(l).charCodeAt(0)-48;if(f<0||f>9)throw new M;o+=f}o*=3;for(let l=i-2;l>=0;l-=2){let f=a.charAt(l).charCodeAt(0)-48;if(f<0||f>9)throw new M;o+=f}return(1e3-o)%10}}class Ga extends Rt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(a,i,o){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let f=a.getSize(),u=i[1],x=0;for(let y=0;y<6&&u<f;y++){let b=Rt.decodeDigit(a,l,u,Rt.L_AND_G_PATTERNS);o+=String.fromCharCode(48+b%10);for(let I of l)u+=I;b>=10&&(x|=1<<5-y)}o=Ga.determineFirstDigit(o,x),u=Rt.findGuardPattern(a,u,!0,Rt.MIDDLE_PATTERN,new Int32Array(Rt.MIDDLE_PATTERN.length).fill(0))[1];for(let y=0;y<6&&u<f;y++){let b=Rt.decodeDigit(a,l,u,Rt.L_PATTERNS);o+=String.fromCharCode(48+b);for(let I of l)u+=I}return{rowOffset:u,resultString:o}}getBarcodeFormat(){return le.EAN_13}static determineFirstDigit(a,i){for(let o=0;o<10;o++)if(i===this.FIRST_DIGIT_ENCODINGS[o])return a=String.fromCharCode(48+o)+a,a;throw new ae}}Ga.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class ja extends Rt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(a,i,o){const l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let f=a.getSize(),u=i[1];for(let p=0;p<4&&u<f;p++){let y=Rt.decodeDigit(a,l,u,Rt.L_PATTERNS);o+=String.fromCharCode(48+y);for(let b of l)u+=b}u=Rt.findGuardPattern(a,u,!0,Rt.MIDDLE_PATTERN,new Int32Array(Rt.MIDDLE_PATTERN.length).fill(0))[1];for(let p=0;p<4&&u<f;p++){let y=Rt.decodeDigit(a,l,u,Rt.L_PATTERNS);o+=String.fromCharCode(48+y);for(let b of l)u+=b}return{rowOffset:u,resultString:o}}getBarcodeFormat(){return le.EAN_8}}class ji extends Rt{constructor(){super(...arguments),this.ean13Reader=new Ga}getBarcodeFormat(){return le.UPC_A}decode(a,i){return this.maybeReturnResult(this.ean13Reader.decode(a))}decodeRow(a,i,o){return this.maybeReturnResult(this.ean13Reader.decodeRow(a,i,o))}decodeMiddle(a,i,o){return this.ean13Reader.decodeMiddle(a,i,o)}maybeReturnResult(a){let i=a.getText();if(i.charAt(0)==="0"){let o=new ee(i.substring(1),null,null,a.getResultPoints(),le.UPC_A);return a.getResultMetadata()!=null&&o.putAllMetadata(a.getResultMetadata()),o}else throw new ae}reset(){this.ean13Reader.reset()}}class aa extends Rt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(a,i,o){const l=this.decodeMiddleCounters.map(y=>y);l[0]=0,l[1]=0,l[2]=0,l[3]=0;const f=a.getSize();let u=i[1],x=0;for(let y=0;y<6&&u<f;y++){const b=aa.decodeDigit(a,l,u,aa.L_AND_G_PATTERNS);o+=String.fromCharCode(48+b%10);for(let I of l)u+=I;b>=10&&(x|=1<<5-y)}let p=aa.determineNumSysAndCheckDigit(o,x);return{rowOffset:u,resultString:p}}decodeEnd(a,i){return aa.findGuardPatternWithoutCounters(a,i,!0,aa.MIDDLE_END_PATTERN)}checkChecksum(a){return Rt.checkChecksum(aa.convertUPCEtoUPCA(a))}static determineNumSysAndCheckDigit(a,i){for(let o=0;o<=1;o++)for(let l=0;l<10;l++)if(i===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[o][l]){let f=String.fromCharCode(48+o),u=String.fromCharCode(48+l);return f+a+u}throw ae.getNotFoundInstance()}getBarcodeFormat(){return le.UPC_E}static convertUPCEtoUPCA(a){const i=a.slice(1,7).split("").map(f=>f.charCodeAt(0)),o=new be;o.append(a.charAt(0));let l=i[5];switch(l){case 0:case 1:case 2:o.appendChars(i,0,2),o.append(l),o.append("0000"),o.appendChars(i,2,3);break;case 3:o.appendChars(i,0,3),o.append("00000"),o.appendChars(i,3,2);break;case 4:o.appendChars(i,0,4),o.append("00000"),o.append(i[4]);break;default:o.appendChars(i,0,5),o.append("0000"),o.append(l);break}return a.length>=8&&o.append(a.charAt(7)),o.toString()}}aa.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),aa.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class pi extends Ft{constructor(a){super();let i=a==null?null:a.get(J.POSSIBLE_FORMATS),o=[];n(i)?(o.push(new Ga),o.push(new ji),o.push(new ja),o.push(new aa)):(i.indexOf(le.EAN_13)>-1&&o.push(new Ga),i.indexOf(le.UPC_A)>-1&&o.push(new ji),i.indexOf(le.EAN_8)>-1&&o.push(new ja),i.indexOf(le.UPC_E)>-1&&o.push(new aa)),this.readers=o}decodeRow(a,i,o){for(let l of this.readers)try{const f=l.decodeRow(a,i,o),u=f.getBarcodeFormat()===le.EAN_13&&f.getText().charAt(0)==="0",x=o==null?null:o.get(J.POSSIBLE_FORMATS),p=x==null||x.includes(le.UPC_A);if(u&&p){const y=f.getRawBytes(),b=new ee(f.getText().substring(1),y,y?y.length:null,f.getResultPoints(),le.UPC_A);return b.putAllMetadata(f.getResultMetadata()),b}return f}catch{}throw new ae}reset(){for(let a of this.readers)a.reset()}}class jr extends Ft{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(a,i){for(let o=0;o<i.length;o++)if(Ft.patternMatchVariance(a,i[o],jr.MAX_INDIVIDUAL_VARIANCE)<jr.MAX_AVG_VARIANCE)return o;throw new ae}static count(a){return vt.sum(new Int32Array(a))}static increment(a,i){let o=0,l=i[0];for(let f=1;f<a.length;f++)i[f]>l&&(l=i[f],o=f);a[o]++}static decrement(a,i){let o=0,l=i[0];for(let f=1;f<a.length;f++)i[f]<l&&(l=i[f],o=f);a[o]--}static isFinderPattern(a){let i=a[0]+a[1],o=i+a[2]+a[3],l=i/o;if(l>=jr.MIN_FINDER_PATTERN_RATIO&&l<=jr.MAX_FINDER_PATTERN_RATIO){let f=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;for(let x of a)x>u&&(u=x),x<f&&(f=x);return u<10*f}return!1}}jr.MAX_AVG_VARIANCE=.2,jr.MAX_INDIVIDUAL_VARIANCE=.45,jr.MIN_FINDER_PATTERN_RATIO=9.5/12,jr.MAX_FINDER_PATTERN_RATIO=12.5/14;class Dn{constructor(a,i){this.value=a,this.checksumPortion=i}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(a){if(!(a instanceof Dn))return!1;const i=a;return this.value===i.value&&this.checksumPortion===i.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class na{constructor(a,i,o,l,f){this.value=a,this.startEnd=i,this.value=a,this.startEnd=i,this.resultPoints=new Array,this.resultPoints.push(new st(o,f)),this.resultPoints.push(new st(l,f))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(a){if(!(a instanceof na))return!1;const i=a;return this.value===i.value}hashCode(){return this.value}}class Zr{constructor(){}static getRSSvalue(a,i,o){let l=0;for(let p of a)l+=p;let f=0,u=0,x=a.length;for(let p=0;p<x-1;p++){let y;for(y=1,u|=1<<p;y<a[p];y++,u&=~(1<<p)){let b=Zr.combins(l-y-1,x-p-2);if(o&&u===0&&l-y-(x-p-1)>=x-p-1&&(b-=Zr.combins(l-y-(x-p),x-p-2)),x-p-1>1){let I=0;for(let R=l-y-(x-p-2);R>i;R--)I+=Zr.combins(l-y-R-1,x-p-3);b-=I*(x-1-p)}else l-y>i&&b--;f+=b}l-=y}return f}static combins(a,i){let o,l;a-i>i?(l=i,o=a-i):(l=a-i,o=i);let f=1,u=1;for(let x=a;x>o;x--)f*=x,u<=l&&(f/=u,u++);for(;u<=l;)f/=u,u++;return f}}class zn{static buildBitArray(a){let i=a.length*2-1;a[a.length-1].getRightChar()==null&&(i-=1);let o=12*i,l=new q(o),f=0,x=a[0].getRightChar().getValue();for(let p=11;p>=0;--p)x&1<<p&&l.set(f),f++;for(let p=1;p<a.length;++p){let y=a[p],b=y.getLeftChar().getValue();for(let I=11;I>=0;--I)b&1<<I&&l.set(f),f++;if(y.getRightChar()!=null){let I=y.getRightChar().getValue();for(let R=11;R>=0;--R)I&1<<R&&l.set(f),f++}}return l}}class Fa{constructor(a,i){i?this.decodedInformation=null:(this.finished=a,this.decodedInformation=i)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class vn{constructor(a){this.newPosition=a}getNewPosition(){return this.newPosition}}class Gr extends vn{constructor(a,i){super(a),this.value=i}getValue(){return this.value}isFNC1(){return this.value===Gr.FNC1}}Gr.FNC1="$";class an extends vn{constructor(a,i,o){super(a),o?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=i}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class F extends vn{constructor(a,i,o){if(super(a),i<0||i>10||o<0||o>10)throw new M;this.firstDigit=i,this.secondDigit=o}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===F.FNC1}isSecondDigitFNC1(){return this.secondDigit===F.FNC1}isAnyFNC1(){return this.firstDigit===F.FNC1||this.secondDigit===F.FNC1}}F.FNC1=10;class B{constructor(){}static parseFieldsInGeneralPurpose(a){if(!a)return null;if(a.length<2)throw new ae;let i=a.substring(0,2);for(let f of B.TWO_DIGIT_DATA_LENGTH)if(f[0]===i)return f[1]===B.VARIABLE_LENGTH?B.processVariableAI(2,f[2],a):B.processFixedAI(2,f[1],a);if(a.length<3)throw new ae;let o=a.substring(0,3);for(let f of B.THREE_DIGIT_DATA_LENGTH)if(f[0]===o)return f[1]===B.VARIABLE_LENGTH?B.processVariableAI(3,f[2],a):B.processFixedAI(3,f[1],a);for(let f of B.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(f[0]===o)return f[1]===B.VARIABLE_LENGTH?B.processVariableAI(4,f[2],a):B.processFixedAI(4,f[1],a);if(a.length<4)throw new ae;let l=a.substring(0,4);for(let f of B.FOUR_DIGIT_DATA_LENGTH)if(f[0]===l)return f[1]===B.VARIABLE_LENGTH?B.processVariableAI(4,f[2],a):B.processFixedAI(4,f[1],a);throw new ae}static processFixedAI(a,i,o){if(o.length<a)throw new ae;let l=o.substring(0,a);if(o.length<a+i)throw new ae;let f=o.substring(a,a+i),u=o.substring(a+i),x="("+l+")"+f,p=B.parseFieldsInGeneralPurpose(u);return p==null?x:x+p}static processVariableAI(a,i,o){let l=o.substring(0,a),f;o.length<a+i?f=o.length:f=a+i;let u=o.substring(a,f),x=o.substring(f),p="("+l+")"+u,y=B.parseFieldsInGeneralPurpose(x);return y==null?p:p+y}}B.VARIABLE_LENGTH=[],B.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",B.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",B.VARIABLE_LENGTH,20],["22",B.VARIABLE_LENGTH,29],["30",B.VARIABLE_LENGTH,8],["37",B.VARIABLE_LENGTH,8],["90",B.VARIABLE_LENGTH,30],["91",B.VARIABLE_LENGTH,30],["92",B.VARIABLE_LENGTH,30],["93",B.VARIABLE_LENGTH,30],["94",B.VARIABLE_LENGTH,30],["95",B.VARIABLE_LENGTH,30],["96",B.VARIABLE_LENGTH,30],["97",B.VARIABLE_LENGTH,3],["98",B.VARIABLE_LENGTH,30],["99",B.VARIABLE_LENGTH,30]],B.THREE_DIGIT_DATA_LENGTH=[["240",B.VARIABLE_LENGTH,30],["241",B.VARIABLE_LENGTH,30],["242",B.VARIABLE_LENGTH,6],["250",B.VARIABLE_LENGTH,30],["251",B.VARIABLE_LENGTH,30],["253",B.VARIABLE_LENGTH,17],["254",B.VARIABLE_LENGTH,20],["400",B.VARIABLE_LENGTH,30],["401",B.VARIABLE_LENGTH,30],["402",17],["403",B.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",B.VARIABLE_LENGTH,20],["421",B.VARIABLE_LENGTH,15],["422",3],["423",B.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],B.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",B.VARIABLE_LENGTH,15],["391",B.VARIABLE_LENGTH,18],["392",B.VARIABLE_LENGTH,15],["393",B.VARIABLE_LENGTH,18],["703",B.VARIABLE_LENGTH,30]],B.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",B.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",B.VARIABLE_LENGTH,20],["8003",B.VARIABLE_LENGTH,30],["8004",B.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",B.VARIABLE_LENGTH,30],["8008",B.VARIABLE_LENGTH,12],["8018",18],["8020",B.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",B.VARIABLE_LENGTH,70],["8200",B.VARIABLE_LENGTH,70]];class L{constructor(a){this.buffer=new be,this.information=a}decodeAllCodes(a,i){let o=i,l=null;do{let f=this.decodeGeneralPurposeField(o,l),u=B.parseFieldsInGeneralPurpose(f.getNewString());if(u!=null&&a.append(u),f.isRemaining()?l=""+f.getRemainingValue():l=null,o===f.getNewPosition())break;o=f.getNewPosition()}while(!0);return a.toString()}isStillNumeric(a){if(a+7>this.information.getSize())return a+4<=this.information.getSize();for(let i=a;i<a+3;++i)if(this.information.get(i))return!0;return this.information.get(a+3)}decodeNumeric(a){if(a+7>this.information.getSize()){let f=this.extractNumericValueFromBitArray(a,4);return f===0?new F(this.information.getSize(),F.FNC1,F.FNC1):new F(this.information.getSize(),f-1,F.FNC1)}let i=this.extractNumericValueFromBitArray(a,7),o=(i-8)/11,l=(i-8)%11;return new F(a+7,o,l)}extractNumericValueFromBitArray(a,i){return L.extractNumericValueFromBitArray(this.information,a,i)}static extractNumericValueFromBitArray(a,i,o){let l=0;for(let f=0;f<o;++f)a.get(i+f)&&(l|=1<<o-f-1);return l}decodeGeneralPurposeField(a,i){this.buffer.setLengthToZero(),i!=null&&this.buffer.append(i),this.current.setPosition(a);let o=this.parseBlocks();return o!=null&&o.isRemaining()?new an(this.current.getPosition(),this.buffer.toString(),o.getRemainingValue()):new an(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let a,i;do{let o=this.current.getPosition();if(this.current.isAlpha()?(i=this.parseAlphaBlock(),a=i.isFinished()):this.current.isIsoIec646()?(i=this.parseIsoIec646Block(),a=i.isFinished()):(i=this.parseNumericBlock(),a=i.isFinished()),!(o!==this.current.getPosition())&&!a)break}while(!a);return i.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let a=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFirstDigitFNC1()){let i;return a.isSecondDigitFNC1()?i=new an(this.current.getPosition(),this.buffer.toString()):i=new an(this.current.getPosition(),this.buffer.toString(),a.getSecondDigit()),new Fa(!0,i)}if(this.buffer.append(a.getFirstDigit()),a.isSecondDigitFNC1()){let i=new an(this.current.getPosition(),this.buffer.toString());return new Fa(!0,i)}this.buffer.append(a.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Fa(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let a=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFNC1()){let i=new an(this.current.getPosition(),this.buffer.toString());return new Fa(!0,i)}this.buffer.append(a.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Fa(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let a=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFNC1()){let i=new an(this.current.getPosition(),this.buffer.toString());return new Fa(!0,i)}this.buffer.append(a.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Fa(!1)}isStillIsoIec646(a){if(a+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(a,5);if(i>=5&&i<16)return!0;if(a+7>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(a,7);if(o>=64&&o<116)return!0;if(a+8>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(a,8);return l>=232&&l<253}decodeIsoIec646(a){let i=this.extractNumericValueFromBitArray(a,5);if(i===15)return new Gr(a+5,Gr.FNC1);if(i>=5&&i<15)return new Gr(a+5,"0"+(i-5));let o=this.extractNumericValueFromBitArray(a,7);if(o>=64&&o<90)return new Gr(a+7,""+(o+1));if(o>=90&&o<116)return new Gr(a+7,""+(o+7));let l=this.extractNumericValueFromBitArray(a,8),f;switch(l){case 232:f="!";break;case 233:f='"';break;case 234:f="%";break;case 235:f="&";break;case 236:f="'";break;case 237:f="(";break;case 238:f=")";break;case 239:f="*";break;case 240:f="+";break;case 241:f=",";break;case 242:f="-";break;case 243:f=".";break;case 244:f="/";break;case 245:f=":";break;case 246:f=";";break;case 247:f="<";break;case 248:f="=";break;case 249:f=">";break;case 250:f="?";break;case 251:f="_";break;case 252:f=" ";break;default:throw new M}return new Gr(a+8,f)}isStillAlpha(a){if(a+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(a,5);if(i>=5&&i<16)return!0;if(a+6>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(a,6);return o>=16&&o<63}decodeAlphanumeric(a){let i=this.extractNumericValueFromBitArray(a,5);if(i===15)return new Gr(a+5,Gr.FNC1);if(i>=5&&i<15)return new Gr(a+5,"0"+(i-5));let o=this.extractNumericValueFromBitArray(a,6);if(o>=32&&o<58)return new Gr(a+6,""+(o+33));let l;switch(o){case 58:l="*";break;case 59:l=",";break;case 60:l="-";break;case 61:l=".";break;case 62:l="/";break;default:throw new lt("Decoding invalid alphanumeric value: "+o)}return new Gr(a+6,l)}isAlphaTo646ToAlphaLatch(a){if(a+1>this.information.getSize())return!1;for(let i=0;i<5&&i+a<this.information.getSize();++i)if(i===2){if(!this.information.get(a+2))return!1}else if(this.information.get(a+i))return!1;return!0}isAlphaOr646ToNumericLatch(a){if(a+3>this.information.getSize())return!1;for(let i=a;i<a+3;++i)if(this.information.get(i))return!1;return!0}isNumericToAlphaNumericLatch(a){if(a+1>this.information.getSize())return!1;for(let i=0;i<4&&i+a<this.information.getSize();++i)if(this.information.get(a+i))return!1;return!0}}class W{constructor(a){this.information=a,this.generalDecoder=new L(a)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class H extends W{constructor(a){super(a)}encodeCompressedGtin(a,i){a.append("(01)");let o=a.length();a.append("9"),this.encodeCompressedGtinWithoutAI(a,i,o)}encodeCompressedGtinWithoutAI(a,i,o){for(let l=0;l<4;++l){let f=this.getGeneralDecoder().extractNumericValueFromBitArray(i+10*l,10);f/100===0&&a.append("0"),f/10===0&&a.append("0"),a.append(f)}H.appendCheckDigit(a,o)}static appendCheckDigit(a,i){let o=0;for(let l=0;l<13;l++){let f=a.charAt(l+i).charCodeAt(0)-48;o+=l&1?f:3*f}o=10-o%10,o===10&&(o=0),a.append(o)}}H.GTIN_SIZE=40;class z extends H{constructor(a){super(a)}parseInformation(){let a=new be;a.append("(01)");let i=a.length(),o=this.getGeneralDecoder().extractNumericValueFromBitArray(z.HEADER_SIZE,4);return a.append(o),this.encodeCompressedGtinWithoutAI(a,z.HEADER_SIZE+4,i),this.getGeneralDecoder().decodeAllCodes(a,z.HEADER_SIZE+44)}}z.HEADER_SIZE=4;class me extends W{constructor(a){super(a)}parseInformation(){let a=new be;return this.getGeneralDecoder().decodeAllCodes(a,me.HEADER_SIZE)}}me.HEADER_SIZE=5;class Ie extends H{constructor(a){super(a)}encodeCompressedWeight(a,i,o){let l=this.getGeneralDecoder().extractNumericValueFromBitArray(i,o);this.addWeightCode(a,l);let f=this.checkWeight(l),u=1e5;for(let x=0;x<5;++x)f/u===0&&a.append("0"),u/=10;a.append(f)}}class ue extends Ie{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()!=ue.HEADER_SIZE+Ie.GTIN_SIZE+ue.WEIGHT_SIZE)throw new ae;let a=new be;return this.encodeCompressedGtin(a,ue.HEADER_SIZE),this.encodeCompressedWeight(a,ue.HEADER_SIZE+Ie.GTIN_SIZE,ue.WEIGHT_SIZE),a.toString()}}ue.HEADER_SIZE=5,ue.WEIGHT_SIZE=15;class we extends ue{constructor(a){super(a)}addWeightCode(a,i){a.append("(3103)")}checkWeight(a){return a}}class pe extends ue{constructor(a){super(a)}addWeightCode(a,i){i<1e4?a.append("(3202)"):a.append("(3203)")}checkWeight(a){return a<1e4?a:a-1e4}}class We extends H{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()<We.HEADER_SIZE+H.GTIN_SIZE)throw new ae;let a=new be;this.encodeCompressedGtin(a,We.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(We.HEADER_SIZE+H.GTIN_SIZE,We.LAST_DIGIT_SIZE);a.append("(392"),a.append(i),a.append(")");let o=this.getGeneralDecoder().decodeGeneralPurposeField(We.HEADER_SIZE+H.GTIN_SIZE+We.LAST_DIGIT_SIZE,null);return a.append(o.getNewString()),a.toString()}}We.HEADER_SIZE=8,We.LAST_DIGIT_SIZE=2;class ze extends H{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()<ze.HEADER_SIZE+H.GTIN_SIZE)throw new ae;let a=new be;this.encodeCompressedGtin(a,ze.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(ze.HEADER_SIZE+H.GTIN_SIZE,ze.LAST_DIGIT_SIZE);a.append("(393"),a.append(i),a.append(")");let o=this.getGeneralDecoder().extractNumericValueFromBitArray(ze.HEADER_SIZE+H.GTIN_SIZE+ze.LAST_DIGIT_SIZE,ze.FIRST_THREE_DIGITS_SIZE);o/100==0&&a.append("0"),o/10==0&&a.append("0"),a.append(o);let l=this.getGeneralDecoder().decodeGeneralPurposeField(ze.HEADER_SIZE+H.GTIN_SIZE+ze.LAST_DIGIT_SIZE+ze.FIRST_THREE_DIGITS_SIZE,null);return a.append(l.getNewString()),a.toString()}}ze.HEADER_SIZE=8,ze.LAST_DIGIT_SIZE=2,ze.FIRST_THREE_DIGITS_SIZE=10;class Ye extends Ie{constructor(a,i,o){super(a),this.dateCode=o,this.firstAIdigits=i}parseInformation(){if(this.getInformation().getSize()!=Ye.HEADER_SIZE+Ye.GTIN_SIZE+Ye.WEIGHT_SIZE+Ye.DATE_SIZE)throw new ae;let a=new be;return this.encodeCompressedGtin(a,Ye.HEADER_SIZE),this.encodeCompressedWeight(a,Ye.HEADER_SIZE+Ye.GTIN_SIZE,Ye.WEIGHT_SIZE),this.encodeCompressedDate(a,Ye.HEADER_SIZE+Ye.GTIN_SIZE+Ye.WEIGHT_SIZE),a.toString()}encodeCompressedDate(a,i){let o=this.getGeneralDecoder().extractNumericValueFromBitArray(i,Ye.DATE_SIZE);if(o==38400)return;a.append("("),a.append(this.dateCode),a.append(")");let l=o%32;o/=32;let f=o%12+1;o/=12;let u=o;u/10==0&&a.append("0"),a.append(u),f/10==0&&a.append("0"),a.append(f),l/10==0&&a.append("0"),a.append(l)}addWeightCode(a,i){a.append("("),a.append(this.firstAIdigits),a.append(i/1e5),a.append(")")}checkWeight(a){return a%1e5}}Ye.HEADER_SIZE=8,Ye.WEIGHT_SIZE=20,Ye.DATE_SIZE=16;function Ke(k){try{if(k.get(1))return new z(k);if(!k.get(2))return new me(k);switch(L.extractNumericValueFromBitArray(k,1,4)){case 4:return new we(k);case 5:return new pe(k)}switch(L.extractNumericValueFromBitArray(k,1,5)){case 12:return new We(k);case 13:return new ze(k)}switch(L.extractNumericValueFromBitArray(k,1,7)){case 56:return new Ye(k,"310","11");case 57:return new Ye(k,"320","11");case 58:return new Ye(k,"310","13");case 59:return new Ye(k,"320","13");case 60:return new Ye(k,"310","15");case 61:return new Ye(k,"320","15");case 62:return new Ye(k,"310","17");case 63:return new Ye(k,"320","17")}}catch(a){throw console.log(a),new lt("unknown decoder: "+k)}}class nt{constructor(a,i,o,l){this.leftchar=a,this.rightchar=i,this.finderpattern=o,this.maybeLast=l}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(a,i){return a instanceof nt?nt.equalsOrNull(a.leftchar,i.leftchar)&&nt.equalsOrNull(a.rightchar,i.rightchar)&&nt.equalsOrNull(a.finderpattern,i.finderpattern):!1}static equalsOrNull(a,i){return a===null?i===null:nt.equals(a,i)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class yt{constructor(a,i,o){this.pairs=a,this.rowNumber=i,this.wasReversed=o}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(a){return this.checkEqualitity(this,a)}toString(){return"{ "+this.pairs+" }"}equals(a,i){return a instanceof yt?this.checkEqualitity(a,i)&&a.wasReversed===i.wasReversed:!1}checkEqualitity(a,i){if(!a||!i)return;let o;return a.forEach((l,f)=>{i.forEach(u=>{l.getLeftChar().getValue()===u.getLeftChar().getValue()&&l.getRightChar().getValue()===u.getRightChar().getValue()&&l.getFinderPatter().getValue()===u.getFinderPatter().getValue()&&(o=!0)})}),o}}class Se extends jr{constructor(a){super(...arguments),this.pairs=new Array(Se.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=a===!0}decodeRow(a,i,o){this.pairs.length=0,this.startFromEven=!1;try{return Se.constructResult(this.decodeRow2pairs(a,i))}catch(l){this.verbose&&console.log(l)}return this.pairs.length=0,this.startFromEven=!0,Se.constructResult(this.decodeRow2pairs(a,i))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(a,i){let o=!1;for(;!o;)try{this.pairs.push(this.retrieveNextPair(i,this.pairs,a))}catch(f){if(f instanceof ae){if(!this.pairs.length)throw new ae;o=!0}}if(this.checkChecksum())return this.pairs;let l;if(this.rows.length?l=!0:l=!1,this.storeRow(a,!1),l){let f=this.checkRowsBoolean(!1);if(f!=null||(f=this.checkRowsBoolean(!0),f!=null))return f}throw new ae}checkRowsBoolean(a){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,a&&(this.rows=this.rows.reverse());let i=null;try{i=this.checkRows(new Array,0)}catch(o){this.verbose&&console.log(o)}return a&&(this.rows=this.rows.reverse()),i}checkRows(a,i){for(let o=i;o<this.rows.length;o++){let l=this.rows[o];this.pairs.length=0;for(let u of a)this.pairs.push(u.getPairs());if(this.pairs.push(l.getPairs()),!Se.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let f=new Array(a);f.push(l);try{return this.checkRows(f,o+1)}catch(u){this.verbose&&console.log(u)}}throw new ae}static isValidSequence(a){for(let i of Se.FINDER_PATTERN_SEQUENCES){if(a.length>i.length)continue;let o=!0;for(let l=0;l<a.length;l++)if(a[l].getFinderPattern().getValue()!=i[l]){o=!1;break}if(o)return!0}return!1}storeRow(a,i){let o=0,l=!1,f=!1;for(;o<this.rows.length;){let u=this.rows[o];if(u.getRowNumber()>a){f=u.isEquivalent(this.pairs);break}l=u.isEquivalent(this.pairs),o++}f||l||Se.isPartialRow(this.pairs,this.rows)||(this.rows.push(o,new yt(this.pairs,a,i)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(a,i){for(let o of i)if(o.getPairs().length!==a.length){for(let l of o.getPairs())for(let f of a)if(nt.equals(l,f))break}}static isPartialRow(a,i){for(let o of i){let l=!0;for(let f of a){let u=!1;for(let x of o.getPairs())if(f.equals(x)){u=!0;break}if(!u){l=!1;break}}if(l)return!0}return!1}getRows(){return this.rows}static constructResult(a){let i=zn.buildBitArray(a),l=Ke(i).parseInformation(),f=a[0].getFinderPattern().getResultPoints(),u=a[a.length-1].getFinderPattern().getResultPoints(),x=[f[0],f[1],u[0],u[1]];return new ee(l,null,null,x,le.RSS_EXPANDED,null)}checkChecksum(){let a=this.pairs.get(0),i=a.getLeftChar(),o=a.getRightChar();if(o==null)return!1;let l=o.getChecksumPortion(),f=2;for(let x=1;x<this.pairs.size();++x){let p=this.pairs.get(x);l+=p.getLeftChar().getChecksumPortion(),f++;let y=p.getRightChar();y!=null&&(l+=y.getChecksumPortion(),f++)}return l%=211,211*(f-4)+l==i.getValue()}static getNextSecondBar(a,i){let o;return a.get(i)?(o=a.getNextUnset(i),o=a.getNextSet(o)):(o=a.getNextSet(i),o=a.getNextUnset(o)),o}retrieveNextPair(a,i,o){let l=i.length%2==0;this.startFromEven&&(l=!l);let f,u=!0,x=-1;do this.findNextPair(a,i,x),f=this.parseFoundFinderPattern(a,o,l),f==null?x=Se.getNextSecondBar(a,this.startEnd[0]):u=!1;while(u);let p=this.decodeDataCharacter(a,f,l,!0);if(!this.isEmptyPair(i)&&i[i.length-1].mustBeLast())throw new ae;let y;try{y=this.decodeDataCharacter(a,f,l,!1)}catch(b){y=null,this.verbose&&console.log(b)}return new nt(p,y,f,!0)}isEmptyPair(a){return a.length===0}findNextPair(a,i,o){let l=this.getDecodeFinderCounters();l[0]=0,l[1]=0,l[2]=0,l[3]=0;let f=a.getSize(),u;o>=0?u=o:this.isEmptyPair(i)?u=0:u=i[i.length-1].getFinderPattern().getStartEnd()[1];let x=i.length%2!=0;this.startFromEven&&(x=!x);let p=!1;for(;u<f&&(p=!a.get(u),!!p);)u++;let y=0,b=u;for(let I=u;I<f;I++)if(a.get(I)!=p)l[y]++;else{if(y==3){if(x&&Se.reverseCounters(l),Se.isFinderPattern(l)){this.startEnd[0]=b,this.startEnd[1]=I;return}x&&Se.reverseCounters(l),b+=l[0]+l[1],l[0]=l[2],l[1]=l[3],l[2]=0,l[3]=0,y--}else y++;l[y]=1,p=!p}throw new ae}static reverseCounters(a){let i=a.length;for(let o=0;o<i/2;++o){let l=a[o];a[o]=a[i-o-1],a[i-o-1]=l}}parseFoundFinderPattern(a,i,o){let l,f,u;if(o){let y=this.startEnd[0]-1;for(;y>=0&&!a.get(y);)y--;y++,l=this.startEnd[0]-y,f=y,u=this.startEnd[1]}else f=this.startEnd[0],u=a.getNextUnset(this.startEnd[1]+1),l=u-this.startEnd[1];let x=this.getDecodeFinderCounters();C.arraycopy(x,0,x,1,x.length-1),x[0]=l;let p;try{p=this.parseFinderValue(x,Se.FINDER_PATTERNS)}catch{return null}return new na(p,[f,u],f,u,i)}decodeDataCharacter(a,i,o,l){let f=this.getDataCharacterCounters();for(let dr=0;dr<f.length;dr++)f[dr]=0;if(l)Se.recordPatternInReverse(a,i.getStartEnd()[0],f);else{Se.recordPattern(a,i.getStartEnd()[1],f);for(let dr=0,Fr=f.length-1;dr<Fr;dr++,Fr--){let Ma=f[dr];f[dr]=f[Fr],f[Fr]=Ma}}let u=17,x=vt.sum(new Int32Array(f))/u,p=(i.getStartEnd()[1]-i.getStartEnd()[0])/15;if(Math.abs(x-p)/p>.3)throw new ae;let y=this.getOddCounts(),b=this.getEvenCounts(),I=this.getOddRoundingErrors(),R=this.getEvenRoundingErrors();for(let dr=0;dr<f.length;dr++){let Fr=1*f[dr]/x,Ma=Fr+.5;if(Ma<1){if(Fr<.3)throw new ae;Ma=1}else if(Ma>8){if(Fr>8.7)throw new ae;Ma=8}let ai=dr/2;dr&1?(b[ai]=Ma,R[ai]=Fr-Ma):(y[ai]=Ma,I[ai]=Fr-Ma)}this.adjustOddEvenCounts(u);let G=4*i.getValue()+(o?0:2)+(l?0:1)-1,Q=0,re=0;for(let dr=y.length-1;dr>=0;dr--){if(Se.isNotA1left(i,o,l)){let Fr=Se.WEIGHTS[G][2*dr];re+=y[dr]*Fr}Q+=y[dr]}let de=0;for(let dr=b.length-1;dr>=0;dr--)if(Se.isNotA1left(i,o,l)){let Fr=Se.WEIGHTS[G][2*dr+1];de+=b[dr]*Fr}let Ae=re+de;if(Q&1||Q>13||Q<4)throw new ae;let qe=(13-Q)/2,Je=Se.SYMBOL_WIDEST[qe],Ge=9-Je,Gt=Zr.getRSSvalue(y,Je,!0),Dt=Zr.getRSSvalue(b,Ge,!1),la=Se.EVEN_TOTAL_SUBSET[qe],Ra=Se.GSUM[qe],fa=Gt*la+Dt+Ra;return new Dn(fa,Ae)}static isNotA1left(a,i,o){return!(a.getValue()==0&&i&&o)}adjustOddEvenCounts(a){let i=vt.sum(new Int32Array(this.getOddCounts())),o=vt.sum(new Int32Array(this.getEvenCounts())),l=!1,f=!1;i>13?f=!0:i<4&&(l=!0);let u=!1,x=!1;o>13?x=!0:o<4&&(u=!0);let p=i+o-a,y=(i&1)==1,b=(o&1)==0;if(p==1)if(y){if(b)throw new ae;f=!0}else{if(!b)throw new ae;x=!0}else if(p==-1)if(y){if(b)throw new ae;l=!0}else{if(!b)throw new ae;u=!0}else if(p==0){if(y){if(!b)throw new ae;i<o?(l=!0,x=!0):(f=!0,u=!0)}else if(b)throw new ae}else throw new ae;if(l){if(f)throw new ae;Se.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(f&&Se.decrement(this.getOddCounts(),this.getOddRoundingErrors()),u){if(x)throw new ae;Se.increment(this.getEvenCounts(),this.getOddRoundingErrors())}x&&Se.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Se.SYMBOL_WIDEST=[7,5,4,3,1],Se.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Se.GSUM=[0,348,1388,2948,3988],Se.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Se.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Se.FINDER_PAT_A=0,Se.FINDER_PAT_B=1,Se.FINDER_PAT_C=2,Se.FINDER_PAT_D=3,Se.FINDER_PAT_E=4,Se.FINDER_PAT_F=5,Se.FINDER_PATTERN_SEQUENCES=[[Se.FINDER_PAT_A,Se.FINDER_PAT_A],[Se.FINDER_PAT_A,Se.FINDER_PAT_B,Se.FINDER_PAT_B],[Se.FINDER_PAT_A,Se.FINDER_PAT_C,Se.FINDER_PAT_B,Se.FINDER_PAT_D],[Se.FINDER_PAT_A,Se.FINDER_PAT_E,Se.FINDER_PAT_B,Se.FINDER_PAT_D,Se.FINDER_PAT_C],[Se.FINDER_PAT_A,Se.FINDER_PAT_E,Se.FINDER_PAT_B,Se.FINDER_PAT_D,Se.FINDER_PAT_D,Se.FINDER_PAT_F],[Se.FINDER_PAT_A,Se.FINDER_PAT_E,Se.FINDER_PAT_B,Se.FINDER_PAT_D,Se.FINDER_PAT_E,Se.FINDER_PAT_F,Se.FINDER_PAT_F],[Se.FINDER_PAT_A,Se.FINDER_PAT_A,Se.FINDER_PAT_B,Se.FINDER_PAT_B,Se.FINDER_PAT_C,Se.FINDER_PAT_C,Se.FINDER_PAT_D,Se.FINDER_PAT_D],[Se.FINDER_PAT_A,Se.FINDER_PAT_A,Se.FINDER_PAT_B,Se.FINDER_PAT_B,Se.FINDER_PAT_C,Se.FINDER_PAT_C,Se.FINDER_PAT_D,Se.FINDER_PAT_E,Se.FINDER_PAT_E],[Se.FINDER_PAT_A,Se.FINDER_PAT_A,Se.FINDER_PAT_B,Se.FINDER_PAT_B,Se.FINDER_PAT_C,Se.FINDER_PAT_C,Se.FINDER_PAT_D,Se.FINDER_PAT_E,Se.FINDER_PAT_F,Se.FINDER_PAT_F],[Se.FINDER_PAT_A,Se.FINDER_PAT_A,Se.FINDER_PAT_B,Se.FINDER_PAT_B,Se.FINDER_PAT_C,Se.FINDER_PAT_D,Se.FINDER_PAT_D,Se.FINDER_PAT_E,Se.FINDER_PAT_E,Se.FINDER_PAT_F,Se.FINDER_PAT_F]],Se.MAX_PAIRS=11;class hr extends Dn{constructor(a,i,o){super(a,i),this.count=0,this.finderPattern=o}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Mt extends jr{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(a,i,o){const l=this.decodePair(i,!1,a,o);Mt.addOrTally(this.possibleLeftPairs,l),i.reverse();let f=this.decodePair(i,!0,a,o);Mt.addOrTally(this.possibleRightPairs,f),i.reverse();for(let u of this.possibleLeftPairs)if(u.getCount()>1){for(let x of this.possibleRightPairs)if(x.getCount()>1&&Mt.checkChecksum(u,x))return Mt.constructResult(u,x)}throw new ae}static addOrTally(a,i){if(i==null)return;let o=!1;for(let l of a)if(l.getValue()===i.getValue()){l.incrementCount(),o=!0;break}o||a.push(i)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(a,i){let o=4537077*a.getValue()+i.getValue(),l=new String(o).toString(),f=new be;for(let y=13-l.length;y>0;y--)f.append("0");f.append(l);let u=0;for(let y=0;y<13;y++){let b=f.charAt(y).charCodeAt(0)-48;u+=y&1?b:3*b}u=10-u%10,u===10&&(u=0),f.append(u.toString());let x=a.getFinderPattern().getResultPoints(),p=i.getFinderPattern().getResultPoints();return new ee(f.toString(),null,0,[x[0],x[1],p[0],p[1]],le.RSS_14,new Date().getTime())}static checkChecksum(a,i){let o=(a.getChecksumPortion()+16*i.getChecksumPortion())%79,l=9*a.getFinderPattern().getValue()+i.getFinderPattern().getValue();return l>72&&l--,l>8&&l--,o===l}decodePair(a,i,o,l){try{let f=this.findFinderPattern(a,i),u=this.parseFoundFinderPattern(a,o,i,f),x=l==null?null:l.get(J.NEED_RESULT_POINT_CALLBACK);if(x!=null){let b=(f[0]+f[1])/2;i&&(b=a.getSize()-1-b),x.foundPossibleResultPoint(new st(b,o))}let p=this.decodeDataCharacter(a,u,!0),y=this.decodeDataCharacter(a,u,!1);return new hr(1597*p.getValue()+y.getValue(),p.getChecksumPortion()+4*y.getChecksumPortion(),u)}catch{return null}}decodeDataCharacter(a,i,o){let l=this.getDataCharacterCounters();for(let de=0;de<l.length;de++)l[de]=0;if(o)Ft.recordPatternInReverse(a,i.getStartEnd()[0],l);else{Ft.recordPattern(a,i.getStartEnd()[1]+1,l);for(let de=0,Ae=l.length-1;de<Ae;de++,Ae--){let qe=l[de];l[de]=l[Ae],l[Ae]=qe}}let f=o?16:15,u=vt.sum(new Int32Array(l))/f,x=this.getOddCounts(),p=this.getEvenCounts(),y=this.getOddRoundingErrors(),b=this.getEvenRoundingErrors();for(let de=0;de<l.length;de++){let Ae=l[de]/u,qe=Math.floor(Ae+.5);qe<1?qe=1:qe>8&&(qe=8);let Je=Math.floor(de/2);de&1?(p[Je]=qe,b[Je]=Ae-qe):(x[Je]=qe,y[Je]=Ae-qe)}this.adjustOddEvenCounts(o,f);let I=0,R=0;for(let de=x.length-1;de>=0;de--)R*=9,R+=x[de],I+=x[de];let G=0,Q=0;for(let de=p.length-1;de>=0;de--)G*=9,G+=p[de],Q+=p[de];let re=R+3*G;if(o){if(I&1||I>12||I<4)throw new ae;let de=(12-I)/2,Ae=Mt.OUTSIDE_ODD_WIDEST[de],qe=9-Ae,Je=Zr.getRSSvalue(x,Ae,!1),Ge=Zr.getRSSvalue(p,qe,!0),Gt=Mt.OUTSIDE_EVEN_TOTAL_SUBSET[de],Dt=Mt.OUTSIDE_GSUM[de];return new Dn(Je*Gt+Ge+Dt,re)}else{if(Q&1||Q>10||Q<4)throw new ae;let de=(10-Q)/2,Ae=Mt.INSIDE_ODD_WIDEST[de],qe=9-Ae,Je=Zr.getRSSvalue(x,Ae,!0),Ge=Zr.getRSSvalue(p,qe,!1),Gt=Mt.INSIDE_ODD_TOTAL_SUBSET[de],Dt=Mt.INSIDE_GSUM[de];return new Dn(Ge*Gt+Je+Dt,re)}}findFinderPattern(a,i){let o=this.getDecodeFinderCounters();o[0]=0,o[1]=0,o[2]=0,o[3]=0;let l=a.getSize(),f=!1,u=0;for(;u<l&&(f=!a.get(u),i!==f);)u++;let x=0,p=u;for(let y=u;y<l;y++)if(a.get(y)!==f)o[x]++;else{if(x===3){if(jr.isFinderPattern(o))return[p,y];p+=o[0]+o[1],o[0]=o[2],o[1]=o[3],o[2]=0,o[3]=0,x--}else x++;o[x]=1,f=!f}throw new ae}parseFoundFinderPattern(a,i,o,l){let f=a.get(l[0]),u=l[0]-1;for(;u>=0&&f!==a.get(u);)u--;u++;const x=l[0]-u,p=this.getDecodeFinderCounters(),y=new Int32Array(p.length);C.arraycopy(p,0,y,1,p.length-1),y[0]=x;const b=this.parseFinderValue(y,Mt.FINDER_PATTERNS);let I=u,R=l[1];return o&&(I=a.getSize()-1-I,R=a.getSize()-1-R),new na(b,[u,l[1]],I,R,i)}adjustOddEvenCounts(a,i){let o=vt.sum(new Int32Array(this.getOddCounts())),l=vt.sum(new Int32Array(this.getEvenCounts())),f=!1,u=!1,x=!1,p=!1;a?(o>12?u=!0:o<4&&(f=!0),l>12?p=!0:l<4&&(x=!0)):(o>11?u=!0:o<5&&(f=!0),l>10?p=!0:l<4&&(x=!0));let y=o+l-i,b=(o&1)===(a?1:0),I=(l&1)===1;if(y===1)if(b){if(I)throw new ae;u=!0}else{if(!I)throw new ae;p=!0}else if(y===-1)if(b){if(I)throw new ae;f=!0}else{if(!I)throw new ae;x=!0}else if(y===0){if(b){if(!I)throw new ae;o<l?(f=!0,p=!0):(u=!0,x=!0)}else if(I)throw new ae}else throw new ae;if(f){if(u)throw new ae;jr.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(u&&jr.decrement(this.getOddCounts(),this.getOddRoundingErrors()),x){if(p)throw new ae;jr.increment(this.getEvenCounts(),this.getOddRoundingErrors())}p&&jr.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Mt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Mt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Mt.OUTSIDE_GSUM=[0,161,961,2015,2715],Mt.INSIDE_GSUM=[0,336,1036,1516],Mt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Mt.INSIDE_ODD_WIDEST=[2,4,6,8],Mt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Jr extends Ft{constructor(a,i){super(),this.readers=[],this.verbose=i===!0;const o=a?a.get(J.POSSIBLE_FORMATS):null,l=a&&a.get(J.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;o?((o.includes(le.EAN_13)||o.includes(le.UPC_A)||o.includes(le.EAN_8)||o.includes(le.UPC_E))&&this.readers.push(new pi(a)),o.includes(le.CODE_39)&&this.readers.push(new br(l)),o.includes(le.CODE_128)&&this.readers.push(new Qe),o.includes(le.ITF)&&this.readers.push(new or),o.includes(le.RSS_14)&&this.readers.push(new Mt),o.includes(le.RSS_EXPANDED)&&this.readers.push(new Se(this.verbose))):(this.readers.push(new pi(a)),this.readers.push(new br),this.readers.push(new pi(a)),this.readers.push(new Qe),this.readers.push(new or),this.readers.push(new Mt),this.readers.push(new Se(this.verbose)))}decodeRow(a,i,o){for(let l=0;l<this.readers.length;l++)try{return this.readers[l].decodeRow(a,i,o)}catch{}throw new ae}reset(){this.readers.forEach(a=>a.reset())}}class Xa extends ce{constructor(a=500,i){super(new Jr(i),a,i)}}class It{constructor(a,i,o){this.ecCodewords=a,this.ecBlocks=[i],o&&this.ecBlocks.push(o)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Nt{constructor(a,i){this.count=a,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class jt{constructor(a,i,o,l,f,u){this.versionNumber=a,this.symbolSizeRows=i,this.symbolSizeColumns=o,this.dataRegionSizeRows=l,this.dataRegionSizeColumns=f,this.ecBlocks=u;let x=0;const p=u.getECCodewords(),y=u.getECBlocks();for(let b of y)x+=b.getCount()*(b.getDataCodewords()+p);this.totalCodewords=x}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(a,i){if(a&1||i&1)throw new M;for(let o of jt.VERSIONS)if(o.symbolSizeRows===a&&o.symbolSizeColumns===i)return o;throw new M}toString(){return""+this.versionNumber}static buildVersions(){return[new jt(1,10,10,8,8,new It(5,new Nt(1,3))),new jt(2,12,12,10,10,new It(7,new Nt(1,5))),new jt(3,14,14,12,12,new It(10,new Nt(1,8))),new jt(4,16,16,14,14,new It(12,new Nt(1,12))),new jt(5,18,18,16,16,new It(14,new Nt(1,18))),new jt(6,20,20,18,18,new It(18,new Nt(1,22))),new jt(7,22,22,20,20,new It(20,new Nt(1,30))),new jt(8,24,24,22,22,new It(24,new Nt(1,36))),new jt(9,26,26,24,24,new It(28,new Nt(1,44))),new jt(10,32,32,14,14,new It(36,new Nt(1,62))),new jt(11,36,36,16,16,new It(42,new Nt(1,86))),new jt(12,40,40,18,18,new It(48,new Nt(1,114))),new jt(13,44,44,20,20,new It(56,new Nt(1,144))),new jt(14,48,48,22,22,new It(68,new Nt(1,174))),new jt(15,52,52,24,24,new It(42,new Nt(2,102))),new jt(16,64,64,14,14,new It(56,new Nt(2,140))),new jt(17,72,72,16,16,new It(36,new Nt(4,92))),new jt(18,80,80,18,18,new It(48,new Nt(4,114))),new jt(19,88,88,20,20,new It(56,new Nt(4,144))),new jt(20,96,96,22,22,new It(68,new Nt(4,174))),new jt(21,104,104,24,24,new It(56,new Nt(6,136))),new jt(22,120,120,18,18,new It(68,new Nt(6,175))),new jt(23,132,132,20,20,new It(62,new Nt(8,163))),new jt(24,144,144,22,22,new It(62,new Nt(8,156),new Nt(2,155))),new jt(25,8,18,6,16,new It(7,new Nt(1,5))),new jt(26,8,32,6,14,new It(11,new Nt(1,10))),new jt(27,12,26,10,24,new It(14,new Nt(1,16))),new jt(28,12,36,10,16,new It(18,new Nt(1,22))),new jt(29,16,36,14,16,new It(24,new Nt(1,32))),new jt(30,16,48,14,22,new It(28,new Nt(1,49)))]}}jt.VERSIONS=jt.buildVersions();class Qr{constructor(a){const i=a.getHeight();if(i<8||i>144||i&1)throw new M;this.version=Qr.readVersion(a),this.mappingBitMatrix=this.extractDataRegion(a),this.readMappingMatrix=new $e(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(a){const i=a.getHeight(),o=a.getWidth();return jt.getVersionForDimensions(i,o)}readCodewords(){const a=new Int8Array(this.version.getTotalCodewords());let i=0,o=4,l=0;const f=this.mappingBitMatrix.getHeight(),u=this.mappingBitMatrix.getWidth();let x=!1,p=!1,y=!1,b=!1;do if(o===f&&l===0&&!x)a[i++]=this.readCorner1(f,u)&255,o-=2,l+=2,x=!0;else if(o===f-2&&l===0&&u&3&&!p)a[i++]=this.readCorner2(f,u)&255,o-=2,l+=2,p=!0;else if(o===f+4&&l===2&&!(u&7)&&!y)a[i++]=this.readCorner3(f,u)&255,o-=2,l+=2,y=!0;else if(o===f-2&&l===0&&(u&7)===4&&!b)a[i++]=this.readCorner4(f,u)&255,o-=2,l+=2,b=!0;else{do o<f&&l>=0&&!this.readMappingMatrix.get(l,o)&&(a[i++]=this.readUtah(o,l,f,u)&255),o-=2,l+=2;while(o>=0&&l<u);o+=1,l+=3;do o>=0&&l<u&&!this.readMappingMatrix.get(l,o)&&(a[i++]=this.readUtah(o,l,f,u)&255),o+=2,l-=2;while(o<f&&l>=0);o+=3,l+=1}while(o<f||l<u);if(i!==this.version.getTotalCodewords())throw new M;return a}readModule(a,i,o,l){return a<0&&(a+=o,i+=4-(o+4&7)),i<0&&(i+=l,a+=4-(l+4&7)),this.readMappingMatrix.set(i,a),this.mappingBitMatrix.get(i,a)}readUtah(a,i,o,l){let f=0;return this.readModule(a-2,i-2,o,l)&&(f|=1),f<<=1,this.readModule(a-2,i-1,o,l)&&(f|=1),f<<=1,this.readModule(a-1,i-2,o,l)&&(f|=1),f<<=1,this.readModule(a-1,i-1,o,l)&&(f|=1),f<<=1,this.readModule(a-1,i,o,l)&&(f|=1),f<<=1,this.readModule(a,i-2,o,l)&&(f|=1),f<<=1,this.readModule(a,i-1,o,l)&&(f|=1),f<<=1,this.readModule(a,i,o,l)&&(f|=1),f}readCorner1(a,i){let o=0;return this.readModule(a-1,0,a,i)&&(o|=1),o<<=1,this.readModule(a-1,1,a,i)&&(o|=1),o<<=1,this.readModule(a-1,2,a,i)&&(o|=1),o<<=1,this.readModule(0,i-2,a,i)&&(o|=1),o<<=1,this.readModule(0,i-1,a,i)&&(o|=1),o<<=1,this.readModule(1,i-1,a,i)&&(o|=1),o<<=1,this.readModule(2,i-1,a,i)&&(o|=1),o<<=1,this.readModule(3,i-1,a,i)&&(o|=1),o}readCorner2(a,i){let o=0;return this.readModule(a-3,0,a,i)&&(o|=1),o<<=1,this.readModule(a-2,0,a,i)&&(o|=1),o<<=1,this.readModule(a-1,0,a,i)&&(o|=1),o<<=1,this.readModule(0,i-4,a,i)&&(o|=1),o<<=1,this.readModule(0,i-3,a,i)&&(o|=1),o<<=1,this.readModule(0,i-2,a,i)&&(o|=1),o<<=1,this.readModule(0,i-1,a,i)&&(o|=1),o<<=1,this.readModule(1,i-1,a,i)&&(o|=1),o}readCorner3(a,i){let o=0;return this.readModule(a-1,0,a,i)&&(o|=1),o<<=1,this.readModule(a-1,i-1,a,i)&&(o|=1),o<<=1,this.readModule(0,i-3,a,i)&&(o|=1),o<<=1,this.readModule(0,i-2,a,i)&&(o|=1),o<<=1,this.readModule(0,i-1,a,i)&&(o|=1),o<<=1,this.readModule(1,i-3,a,i)&&(o|=1),o<<=1,this.readModule(1,i-2,a,i)&&(o|=1),o<<=1,this.readModule(1,i-1,a,i)&&(o|=1),o}readCorner4(a,i){let o=0;return this.readModule(a-3,0,a,i)&&(o|=1),o<<=1,this.readModule(a-2,0,a,i)&&(o|=1),o<<=1,this.readModule(a-1,0,a,i)&&(o|=1),o<<=1,this.readModule(0,i-2,a,i)&&(o|=1),o<<=1,this.readModule(0,i-1,a,i)&&(o|=1),o<<=1,this.readModule(1,i-1,a,i)&&(o|=1),o<<=1,this.readModule(2,i-1,a,i)&&(o|=1),o<<=1,this.readModule(3,i-1,a,i)&&(o|=1),o}extractDataRegion(a){const i=this.version.getSymbolSizeRows(),o=this.version.getSymbolSizeColumns();if(a.getHeight()!==i)throw new _("Dimension of bitMatrix must match the version size");const l=this.version.getDataRegionSizeRows(),f=this.version.getDataRegionSizeColumns(),u=i/l|0,x=o/f|0,p=u*l,y=x*f,b=new $e(y,p);for(let I=0;I<u;++I){const R=I*l;for(let G=0;G<x;++G){const Q=G*f;for(let re=0;re<l;++re){const de=I*(l+2)+1+re,Ae=R+re;for(let qe=0;qe<f;++qe){const Je=G*(f+2)+1+qe;if(a.get(Je,de)){const Ge=Q+qe;b.set(Ge,Ae)}}}}}return b}}class Ui{constructor(a,i){this.numDataCodewords=a,this.codewords=i}static getDataBlocks(a,i){const o=i.getECBlocks();let l=0;const f=o.getECBlocks();for(let re of f)l+=re.getCount();const u=new Array(l);let x=0;for(let re of f)for(let de=0;de<re.getCount();de++){const Ae=re.getDataCodewords(),qe=o.getECCodewords()+Ae;u[x++]=new Ui(Ae,new Uint8Array(qe))}const y=u[0].codewords.length-o.getECCodewords(),b=y-1;let I=0;for(let re=0;re<b;re++)for(let de=0;de<x;de++)u[de].codewords[re]=a[I++];const R=i.getVersionNumber()===24,G=R?8:x;for(let re=0;re<G;re++)u[re].codewords[y-1]=a[I++];const Q=u[0].codewords.length;for(let re=y;re<Q;re++)for(let de=0;de<x;de++){const Ae=R?(de+8)%x:de,qe=R&&Ae>7?re-1:re;u[Ae].codewords[qe]=a[I++]}if(I!==a.length)throw new _;return u}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Yn{constructor(a){this.bytes=a,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(a){if(a<1||a>32||a>this.available())throw new _(""+a);let i=0,o=this.bitOffset,l=this.byteOffset;const f=this.bytes;if(o>0){const u=8-o,x=a<u?a:u,p=u-x,y=255>>8-x<<p;i=(f[l]&y)>>p,a-=x,o+=x,o===8&&(o=0,l++)}if(a>0){for(;a>=8;)i=i<<8|f[l]&255,l++,a-=8;if(a>0){const u=8-a,x=255>>u<<u;i=i<<a|(f[l]&x)>>u,o+=a}}return this.bitOffset=o,this.byteOffset=l,i}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var qt;(function(k){k[k.PAD_ENCODE=0]="PAD_ENCODE",k[k.ASCII_ENCODE=1]="ASCII_ENCODE",k[k.C40_ENCODE=2]="C40_ENCODE",k[k.TEXT_ENCODE=3]="TEXT_ENCODE",k[k.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",k[k.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",k[k.BASE256_ENCODE=6]="BASE256_ENCODE"})(qt||(qt={}));class nn{static decode(a){const i=new Yn(a),o=new be,l=new be,f=new Array;let u=qt.ASCII_ENCODE;do if(u===qt.ASCII_ENCODE)u=this.decodeAsciiSegment(i,o,l);else{switch(u){case qt.C40_ENCODE:this.decodeC40Segment(i,o);break;case qt.TEXT_ENCODE:this.decodeTextSegment(i,o);break;case qt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(i,o);break;case qt.EDIFACT_ENCODE:this.decodeEdifactSegment(i,o);break;case qt.BASE256_ENCODE:this.decodeBase256Segment(i,o,f);break;default:throw new M}u=qt.ASCII_ENCODE}while(u!==qt.PAD_ENCODE&&i.available()>0);return l.length()>0&&o.append(l.toString()),new Pe(a,o.toString(),f.length===0?null:f,null)}static decodeAsciiSegment(a,i,o){let l=!1;do{let f=a.readBits(8);if(f===0)throw new M;if(f<=128)return l&&(f+=128),i.append(String.fromCharCode(f-1)),qt.ASCII_ENCODE;if(f===129)return qt.PAD_ENCODE;if(f<=229){const u=f-130;u<10&&i.append("0"),i.append(""+u)}else switch(f){case 230:return qt.C40_ENCODE;case 231:return qt.BASE256_ENCODE;case 232:i.append("");break;case 233:case 234:break;case 235:l=!0;break;case 236:i.append("[)>05"),o.insert(0,"");break;case 237:i.append("[)>06"),o.insert(0,"");break;case 238:return qt.ANSIX12_ENCODE;case 239:return qt.TEXT_ENCODE;case 240:return qt.EDIFACT_ENCODE;case 241:break;default:if(f!==254||a.available()!==0)throw new M;break}}while(a.available()>0);return qt.ASCII_ENCODE}static decodeC40Segment(a,i){let o=!1;const l=[];let f=0;do{if(a.available()===8)return;const u=a.readBits(8);if(u===254)return;this.parseTwoBytes(u,a.readBits(8),l);for(let x=0;x<3;x++){const p=l[x];switch(f){case 0:if(p<3)f=p+1;else if(p<this.C40_BASIC_SET_CHARS.length){const y=this.C40_BASIC_SET_CHARS[p];o?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),o=!1):i.append(y)}else throw new M;break;case 1:o?(i.append(String.fromCharCode(p+128)),o=!1):i.append(String.fromCharCode(p)),f=0;break;case 2:if(p<this.C40_SHIFT2_SET_CHARS.length){const y=this.C40_SHIFT2_SET_CHARS[p];o?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),o=!1):i.append(y)}else switch(p){case 27:i.append("");break;case 30:o=!0;break;default:throw new M}f=0;break;case 3:o?(i.append(String.fromCharCode(p+224)),o=!1):i.append(String.fromCharCode(p+96)),f=0;break;default:throw new M}}}while(a.available()>0)}static decodeTextSegment(a,i){let o=!1,l=[],f=0;do{if(a.available()===8)return;const u=a.readBits(8);if(u===254)return;this.parseTwoBytes(u,a.readBits(8),l);for(let x=0;x<3;x++){const p=l[x];switch(f){case 0:if(p<3)f=p+1;else if(p<this.TEXT_BASIC_SET_CHARS.length){const y=this.TEXT_BASIC_SET_CHARS[p];o?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),o=!1):i.append(y)}else throw new M;break;case 1:o?(i.append(String.fromCharCode(p+128)),o=!1):i.append(String.fromCharCode(p)),f=0;break;case 2:if(p<this.TEXT_SHIFT2_SET_CHARS.length){const y=this.TEXT_SHIFT2_SET_CHARS[p];o?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),o=!1):i.append(y)}else switch(p){case 27:i.append("");break;case 30:o=!0;break;default:throw new M}f=0;break;case 3:if(p<this.TEXT_SHIFT3_SET_CHARS.length){const y=this.TEXT_SHIFT3_SET_CHARS[p];o?(i.append(String.fromCharCode(y.charCodeAt(0)+128)),o=!1):i.append(y),f=0}else throw new M;break;default:throw new M}}}while(a.available()>0)}static decodeAnsiX12Segment(a,i){const o=[];do{if(a.available()===8)return;const l=a.readBits(8);if(l===254)return;this.parseTwoBytes(l,a.readBits(8),o);for(let f=0;f<3;f++){const u=o[f];switch(u){case 0:i.append("\r");break;case 1:i.append("*");break;case 2:i.append(">");break;case 3:i.append(" ");break;default:if(u<14)i.append(String.fromCharCode(u+44));else if(u<40)i.append(String.fromCharCode(u+51));else throw new M;break}}}while(a.available()>0)}static parseTwoBytes(a,i,o){let l=(a<<8)+i-1,f=Math.floor(l/1600);o[0]=f,l-=f*1600,f=Math.floor(l/40),o[1]=f,o[2]=l-f*40}static decodeEdifactSegment(a,i){do{if(a.available()<=16)return;for(let o=0;o<4;o++){let l=a.readBits(6);if(l===31){const f=8-a.getBitOffset();f!==8&&a.readBits(f);return}l&32||(l|=64),i.append(String.fromCharCode(l))}}while(a.available()>0)}static decodeBase256Segment(a,i,o){let l=1+a.getByteOffset();const f=this.unrandomize255State(a.readBits(8),l++);let u;if(f===0?u=a.available()/8|0:f<250?u=f:u=250*(f-249)+this.unrandomize255State(a.readBits(8),l++),u<0)throw new M;const x=new Uint8Array(u);for(let p=0;p<u;p++){if(a.available()<8)throw new M;x[p]=this.unrandomize255State(a.readBits(8),l++)}o.push(x);try{i.append(he.decode(x,te.ISO88591))}catch(p){throw new lt("Platform does not support required encoding: "+p.message)}}static unrandomize255State(a,i){const o=149*i%255+1,l=a-o;return l>=0?l:l+256}}nn.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],nn.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],nn.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],nn.TEXT_SHIFT2_SET_CHARS=nn.C40_SHIFT2_SET_CHARS,nn.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Zs{constructor(){this.rsDecoder=new Xe(Y.DATA_MATRIX_FIELD_256)}decode(a){const i=new Qr(a),o=i.getVersion(),l=i.readCodewords(),f=Ui.getDataBlocks(l,o);let u=0;for(let y of f)u+=y.getNumDataCodewords();const x=new Uint8Array(u),p=f.length;for(let y=0;y<p;y++){const b=f[y],I=b.getCodewords(),R=b.getNumDataCodewords();this.correctErrors(I,R);for(let G=0;G<R;G++)x[G*p+y]=I[G]}return nn.decode(x)}correctErrors(a,i){const o=new Int32Array(a);try{this.rsDecoder.decode(o,a.length-i)}catch{throw new T}for(let l=0;l<i;l++)a[l]=o[l]}}class Ir{constructor(a){this.image=a,this.rectangleDetector=new kr(this.image)}detect(){const a=this.rectangleDetector.detect();let i=this.detectSolid1(a);if(i=this.detectSolid2(i),i[3]=this.correctTopRight(i),!i[3])throw new ae;i=this.shiftToModuleCenter(i);const o=i[0],l=i[1],f=i[2],u=i[3];let x=this.transitionsBetween(o,u)+1,p=this.transitionsBetween(f,u)+1;(x&1)===1&&(x+=1),(p&1)===1&&(p+=1),4*x<7*p&&4*p<7*x&&(x=p=Math.max(x,p));let y=Ir.sampleGrid(this.image,o,l,f,u,x,p);return new wn(y,[o,l,f,u])}static shiftPoint(a,i,o){let l=(i.getX()-a.getX())/(o+1),f=(i.getY()-a.getY())/(o+1);return new st(a.getX()+l,a.getY()+f)}static moveAway(a,i,o){let l=a.getX(),f=a.getY();return l<i?l-=1:l+=1,f<o?f-=1:f+=1,new st(l,f)}detectSolid1(a){let i=a[0],o=a[1],l=a[3],f=a[2],u=this.transitionsBetween(i,o),x=this.transitionsBetween(o,l),p=this.transitionsBetween(l,f),y=this.transitionsBetween(f,i),b=u,I=[f,i,o,l];return b>x&&(b=x,I[0]=i,I[1]=o,I[2]=l,I[3]=f),b>p&&(b=p,I[0]=o,I[1]=l,I[2]=f,I[3]=i),b>y&&(I[0]=l,I[1]=f,I[2]=i,I[3]=o),I}detectSolid2(a){let i=a[0],o=a[1],l=a[2],f=a[3],u=this.transitionsBetween(i,f),x=Ir.shiftPoint(o,l,(u+1)*4),p=Ir.shiftPoint(l,o,(u+1)*4),y=this.transitionsBetween(x,i),b=this.transitionsBetween(p,f);return y<b?(a[0]=i,a[1]=o,a[2]=l,a[3]=f):(a[0]=o,a[1]=l,a[2]=f,a[3]=i),a}correctTopRight(a){let i=a[0],o=a[1],l=a[2],f=a[3],u=this.transitionsBetween(i,f),x=this.transitionsBetween(o,f),p=Ir.shiftPoint(i,o,(x+1)*4),y=Ir.shiftPoint(l,o,(u+1)*4);u=this.transitionsBetween(p,f),x=this.transitionsBetween(y,f);let b=new st(f.getX()+(l.getX()-o.getX())/(u+1),f.getY()+(l.getY()-o.getY())/(u+1)),I=new st(f.getX()+(i.getX()-o.getX())/(x+1),f.getY()+(i.getY()-o.getY())/(x+1));if(!this.isValid(b))return this.isValid(I)?I:null;if(!this.isValid(I))return b;let R=this.transitionsBetween(p,b)+this.transitionsBetween(y,b),G=this.transitionsBetween(p,I)+this.transitionsBetween(y,I);return R>G?b:I}shiftToModuleCenter(a){let i=a[0],o=a[1],l=a[2],f=a[3],u=this.transitionsBetween(i,f)+1,x=this.transitionsBetween(l,f)+1,p=Ir.shiftPoint(i,o,x*4),y=Ir.shiftPoint(l,o,u*4);u=this.transitionsBetween(p,f)+1,x=this.transitionsBetween(y,f)+1,(u&1)===1&&(u+=1),(x&1)===1&&(x+=1);let b=(i.getX()+o.getX()+l.getX()+f.getX())/4,I=(i.getY()+o.getY()+l.getY()+f.getY())/4;i=Ir.moveAway(i,b,I),o=Ir.moveAway(o,b,I),l=Ir.moveAway(l,b,I),f=Ir.moveAway(f,b,I);let R,G;return p=Ir.shiftPoint(i,o,x*4),p=Ir.shiftPoint(p,f,u*4),R=Ir.shiftPoint(o,i,x*4),R=Ir.shiftPoint(R,l,u*4),y=Ir.shiftPoint(l,f,x*4),y=Ir.shiftPoint(y,o,u*4),G=Ir.shiftPoint(f,l,x*4),G=Ir.shiftPoint(G,i,u*4),[p,R,y,G]}isValid(a){return a.getX()>=0&&a.getX()<this.image.getWidth()&&a.getY()>0&&a.getY()<this.image.getHeight()}static sampleGrid(a,i,o,l,f,u,x){return Ar.getInstance().sampleGrid(a,u,x,.5,.5,u-.5,.5,u-.5,x-.5,.5,x-.5,i.getX(),i.getY(),f.getX(),f.getY(),l.getX(),l.getY(),o.getX(),o.getY())}transitionsBetween(a,i){let o=Math.trunc(a.getX()),l=Math.trunc(a.getY()),f=Math.trunc(i.getX()),u=Math.trunc(i.getY()),x=Math.abs(u-l)>Math.abs(f-o);if(x){let re=o;o=l,l=re,re=f,f=u,u=re}let p=Math.abs(f-o),y=Math.abs(u-l),b=-p/2,I=l<u?1:-1,R=o<f?1:-1,G=0,Q=this.image.get(x?l:o,x?o:l);for(let re=o,de=l;re!==f;re+=R){let Ae=this.image.get(x?de:re,x?re:de);if(Ae!==Q&&(G++,Q=Ae),b+=y,b>0){if(de===u)break;de+=I,b-=p}}return G}}class sn{constructor(){this.decoder=new Zs}decode(a,i=null){let o,l;if(i!=null&&i.has(J.PURE_BARCODE)){const y=sn.extractPureBits(a.getBlackMatrix());o=this.decoder.decode(y),l=sn.NO_POINTS}else{const y=new Ir(a.getBlackMatrix()).detect();o=this.decoder.decode(y.getBits()),l=y.getPoints()}const f=o.getRawBytes(),u=new ee(o.getText(),f,8*f.length,l,le.DATA_MATRIX,C.currentTimeMillis()),x=o.getByteSegments();x!=null&&u.putMetadata(Le.BYTE_SEGMENTS,x);const p=o.getECLevel();return p!=null&&u.putMetadata(Le.ERROR_CORRECTION_LEVEL,p),u}reset(){}static extractPureBits(a){const i=a.getTopLeftOnBit(),o=a.getBottomRightOnBit();if(i==null||o==null)throw new ae;const l=this.moduleSize(i,a);let f=i[1];const u=o[1];let x=i[0];const y=(o[0]-x+1)/l,b=(u-f+1)/l;if(y<=0||b<=0)throw new ae;const I=l/2;f+=I,x+=I;const R=new $e(y,b);for(let G=0;G<b;G++){const Q=f+G*l;for(let re=0;re<y;re++)a.get(x+re*l,Q)&&R.set(re,G)}return R}static moduleSize(a,i){const o=i.getWidth();let l=a[0];const f=a[1];for(;l<o&&i.get(l,f);)l++;if(l===o)throw new ae;const u=l-a[0];if(u===0)throw new ae;return u}}sn.NO_POINTS=[];class dc extends ce{constructor(a=500){super(new sn,a)}}var wi;(function(k){k[k.L=0]="L",k[k.M=1]="M",k[k.Q=2]="Q",k[k.H=3]="H"})(wi||(wi={}));class ur{constructor(a,i,o){this.value=a,this.stringValue=i,this.bits=o,ur.FOR_BITS.set(o,this),ur.FOR_VALUE.set(a,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(a){switch(a){case"L":return ur.L;case"M":return ur.M;case"Q":return ur.Q;case"H":return ur.H;default:throw new v(a+"not available")}}toString(){return this.stringValue}equals(a){if(!(a instanceof ur))return!1;const i=a;return this.value===i.value}static forBits(a){if(a<0||a>=ur.FOR_BITS.size)throw new _;return ur.FOR_BITS.get(a)}}ur.FOR_BITS=new Map,ur.FOR_VALUE=new Map,ur.L=new ur(wi.L,"L",1),ur.M=new ur(wi.M,"M",0),ur.Q=new ur(wi.Q,"Q",3),ur.H=new ur(wi.H,"H",2);class ma{constructor(a){this.errorCorrectionLevel=ur.forBits(a>>3&3),this.dataMask=a&7}static numBitsDiffering(a,i){return O.bitCount(a^i)}static decodeFormatInformation(a,i){const o=ma.doDecodeFormatInformation(a,i);return o!==null?o:ma.doDecodeFormatInformation(a^ma.FORMAT_INFO_MASK_QR,i^ma.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(a,i){let o=Number.MAX_SAFE_INTEGER,l=0;for(const f of ma.FORMAT_INFO_DECODE_LOOKUP){const u=f[0];if(u===a||u===i)return new ma(f[1]);let x=ma.numBitsDiffering(a,u);x<o&&(l=f[1],o=x),a!==i&&(x=ma.numBitsDiffering(i,u),x<o&&(l=f[1],o=x))}return o<=3?new ma(l):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(a){if(!(a instanceof ma))return!1;const i=a;return this.errorCorrectionLevel===i.errorCorrectionLevel&&this.dataMask===i.dataMask}}ma.FORMAT_INFO_MASK_QR=21522,ma.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class ge{constructor(a,...i){this.ecCodewordsPerBlock=a,this.ecBlocks=i}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let a=0;const i=this.ecBlocks;for(const o of i)a+=o.getCount();return a}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class V{constructor(a,i){this.count=a,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class dt{constructor(a,i,...o){this.versionNumber=a,this.alignmentPatternCenters=i,this.ecBlocks=o;let l=0;const f=o[0].getECCodewordsPerBlock(),u=o[0].getECBlocks();for(const x of u)l+=x.getCount()*(x.getDataCodewords()+f);this.totalCodewords=l}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(a){return this.ecBlocks[a.getValue()]}static getProvisionalVersionForDimension(a){if(a%4!==1)throw new M;try{return this.getVersionForNumber((a-17)/4)}catch{throw new M}}static getVersionForNumber(a){if(a<1||a>40)throw new _;return dt.VERSIONS[a-1]}static decodeVersionInformation(a){let i=Number.MAX_SAFE_INTEGER,o=0;for(let l=0;l<dt.VERSION_DECODE_INFO.length;l++){const f=dt.VERSION_DECODE_INFO[l];if(f===a)return dt.getVersionForNumber(l+7);const u=ma.numBitsDiffering(a,f);u<i&&(o=l+7,i=u)}return i<=3?dt.getVersionForNumber(o):null}buildFunctionPattern(){const a=this.getDimensionForVersion(),i=new $e(a);i.setRegion(0,0,9,9),i.setRegion(a-8,0,8,9),i.setRegion(0,a-8,9,8);const o=this.alignmentPatternCenters.length;for(let l=0;l<o;l++){const f=this.alignmentPatternCenters[l]-2;for(let u=0;u<o;u++)l===0&&(u===0||u===o-1)||l===o-1&&u===0||i.setRegion(this.alignmentPatternCenters[u]-2,f,5,5)}return i.setRegion(6,9,1,a-17),i.setRegion(9,6,a-17,1),this.versionNumber>6&&(i.setRegion(a-11,0,3,6),i.setRegion(0,a-11,6,3)),i}toString(){return""+this.versionNumber}}dt.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),dt.VERSIONS=[new dt(1,new Int32Array(0),new ge(7,new V(1,19)),new ge(10,new V(1,16)),new ge(13,new V(1,13)),new ge(17,new V(1,9))),new dt(2,Int32Array.from([6,18]),new ge(10,new V(1,34)),new ge(16,new V(1,28)),new ge(22,new V(1,22)),new ge(28,new V(1,16))),new dt(3,Int32Array.from([6,22]),new ge(15,new V(1,55)),new ge(26,new V(1,44)),new ge(18,new V(2,17)),new ge(22,new V(2,13))),new dt(4,Int32Array.from([6,26]),new ge(20,new V(1,80)),new ge(18,new V(2,32)),new ge(26,new V(2,24)),new ge(16,new V(4,9))),new dt(5,Int32Array.from([6,30]),new ge(26,new V(1,108)),new ge(24,new V(2,43)),new ge(18,new V(2,15),new V(2,16)),new ge(22,new V(2,11),new V(2,12))),new dt(6,Int32Array.from([6,34]),new ge(18,new V(2,68)),new ge(16,new V(4,27)),new ge(24,new V(4,19)),new ge(28,new V(4,15))),new dt(7,Int32Array.from([6,22,38]),new ge(20,new V(2,78)),new ge(18,new V(4,31)),new ge(18,new V(2,14),new V(4,15)),new ge(26,new V(4,13),new V(1,14))),new dt(8,Int32Array.from([6,24,42]),new ge(24,new V(2,97)),new ge(22,new V(2,38),new V(2,39)),new ge(22,new V(4,18),new V(2,19)),new ge(26,new V(4,14),new V(2,15))),new dt(9,Int32Array.from([6,26,46]),new ge(30,new V(2,116)),new ge(22,new V(3,36),new V(2,37)),new ge(20,new V(4,16),new V(4,17)),new ge(24,new V(4,12),new V(4,13))),new dt(10,Int32Array.from([6,28,50]),new ge(18,new V(2,68),new V(2,69)),new ge(26,new V(4,43),new V(1,44)),new ge(24,new V(6,19),new V(2,20)),new ge(28,new V(6,15),new V(2,16))),new dt(11,Int32Array.from([6,30,54]),new ge(20,new V(4,81)),new ge(30,new V(1,50),new V(4,51)),new ge(28,new V(4,22),new V(4,23)),new ge(24,new V(3,12),new V(8,13))),new dt(12,Int32Array.from([6,32,58]),new ge(24,new V(2,92),new V(2,93)),new ge(22,new V(6,36),new V(2,37)),new ge(26,new V(4,20),new V(6,21)),new ge(28,new V(7,14),new V(4,15))),new dt(13,Int32Array.from([6,34,62]),new ge(26,new V(4,107)),new ge(22,new V(8,37),new V(1,38)),new ge(24,new V(8,20),new V(4,21)),new ge(22,new V(12,11),new V(4,12))),new dt(14,Int32Array.from([6,26,46,66]),new ge(30,new V(3,115),new V(1,116)),new ge(24,new V(4,40),new V(5,41)),new ge(20,new V(11,16),new V(5,17)),new ge(24,new V(11,12),new V(5,13))),new dt(15,Int32Array.from([6,26,48,70]),new ge(22,new V(5,87),new V(1,88)),new ge(24,new V(5,41),new V(5,42)),new ge(30,new V(5,24),new V(7,25)),new ge(24,new V(11,12),new V(7,13))),new dt(16,Int32Array.from([6,26,50,74]),new ge(24,new V(5,98),new V(1,99)),new ge(28,new V(7,45),new V(3,46)),new ge(24,new V(15,19),new V(2,20)),new ge(30,new V(3,15),new V(13,16))),new dt(17,Int32Array.from([6,30,54,78]),new ge(28,new V(1,107),new V(5,108)),new ge(28,new V(10,46),new V(1,47)),new ge(28,new V(1,22),new V(15,23)),new ge(28,new V(2,14),new V(17,15))),new dt(18,Int32Array.from([6,30,56,82]),new ge(30,new V(5,120),new V(1,121)),new ge(26,new V(9,43),new V(4,44)),new ge(28,new V(17,22),new V(1,23)),new ge(28,new V(2,14),new V(19,15))),new dt(19,Int32Array.from([6,30,58,86]),new ge(28,new V(3,113),new V(4,114)),new ge(26,new V(3,44),new V(11,45)),new ge(26,new V(17,21),new V(4,22)),new ge(26,new V(9,13),new V(16,14))),new dt(20,Int32Array.from([6,34,62,90]),new ge(28,new V(3,107),new V(5,108)),new ge(26,new V(3,41),new V(13,42)),new ge(30,new V(15,24),new V(5,25)),new ge(28,new V(15,15),new V(10,16))),new dt(21,Int32Array.from([6,28,50,72,94]),new ge(28,new V(4,116),new V(4,117)),new ge(26,new V(17,42)),new ge(28,new V(17,22),new V(6,23)),new ge(30,new V(19,16),new V(6,17))),new dt(22,Int32Array.from([6,26,50,74,98]),new ge(28,new V(2,111),new V(7,112)),new ge(28,new V(17,46)),new ge(30,new V(7,24),new V(16,25)),new ge(24,new V(34,13))),new dt(23,Int32Array.from([6,30,54,78,102]),new ge(30,new V(4,121),new V(5,122)),new ge(28,new V(4,47),new V(14,48)),new ge(30,new V(11,24),new V(14,25)),new ge(30,new V(16,15),new V(14,16))),new dt(24,Int32Array.from([6,28,54,80,106]),new ge(30,new V(6,117),new V(4,118)),new ge(28,new V(6,45),new V(14,46)),new ge(30,new V(11,24),new V(16,25)),new ge(30,new V(30,16),new V(2,17))),new dt(25,Int32Array.from([6,32,58,84,110]),new ge(26,new V(8,106),new V(4,107)),new ge(28,new V(8,47),new V(13,48)),new ge(30,new V(7,24),new V(22,25)),new ge(30,new V(22,15),new V(13,16))),new dt(26,Int32Array.from([6,30,58,86,114]),new ge(28,new V(10,114),new V(2,115)),new ge(28,new V(19,46),new V(4,47)),new ge(28,new V(28,22),new V(6,23)),new ge(30,new V(33,16),new V(4,17))),new dt(27,Int32Array.from([6,34,62,90,118]),new ge(30,new V(8,122),new V(4,123)),new ge(28,new V(22,45),new V(3,46)),new ge(30,new V(8,23),new V(26,24)),new ge(30,new V(12,15),new V(28,16))),new dt(28,Int32Array.from([6,26,50,74,98,122]),new ge(30,new V(3,117),new V(10,118)),new ge(28,new V(3,45),new V(23,46)),new ge(30,new V(4,24),new V(31,25)),new ge(30,new V(11,15),new V(31,16))),new dt(29,Int32Array.from([6,30,54,78,102,126]),new ge(30,new V(7,116),new V(7,117)),new ge(28,new V(21,45),new V(7,46)),new ge(30,new V(1,23),new V(37,24)),new ge(30,new V(19,15),new V(26,16))),new dt(30,Int32Array.from([6,26,52,78,104,130]),new ge(30,new V(5,115),new V(10,116)),new ge(28,new V(19,47),new V(10,48)),new ge(30,new V(15,24),new V(25,25)),new ge(30,new V(23,15),new V(25,16))),new dt(31,Int32Array.from([6,30,56,82,108,134]),new ge(30,new V(13,115),new V(3,116)),new ge(28,new V(2,46),new V(29,47)),new ge(30,new V(42,24),new V(1,25)),new ge(30,new V(23,15),new V(28,16))),new dt(32,Int32Array.from([6,34,60,86,112,138]),new ge(30,new V(17,115)),new ge(28,new V(10,46),new V(23,47)),new ge(30,new V(10,24),new V(35,25)),new ge(30,new V(19,15),new V(35,16))),new dt(33,Int32Array.from([6,30,58,86,114,142]),new ge(30,new V(17,115),new V(1,116)),new ge(28,new V(14,46),new V(21,47)),new ge(30,new V(29,24),new V(19,25)),new ge(30,new V(11,15),new V(46,16))),new dt(34,Int32Array.from([6,34,62,90,118,146]),new ge(30,new V(13,115),new V(6,116)),new ge(28,new V(14,46),new V(23,47)),new ge(30,new V(44,24),new V(7,25)),new ge(30,new V(59,16),new V(1,17))),new dt(35,Int32Array.from([6,30,54,78,102,126,150]),new ge(30,new V(12,121),new V(7,122)),new ge(28,new V(12,47),new V(26,48)),new ge(30,new V(39,24),new V(14,25)),new ge(30,new V(22,15),new V(41,16))),new dt(36,Int32Array.from([6,24,50,76,102,128,154]),new ge(30,new V(6,121),new V(14,122)),new ge(28,new V(6,47),new V(34,48)),new ge(30,new V(46,24),new V(10,25)),new ge(30,new V(2,15),new V(64,16))),new dt(37,Int32Array.from([6,28,54,80,106,132,158]),new ge(30,new V(17,122),new V(4,123)),new ge(28,new V(29,46),new V(14,47)),new ge(30,new V(49,24),new V(10,25)),new ge(30,new V(24,15),new V(46,16))),new dt(38,Int32Array.from([6,32,58,84,110,136,162]),new ge(30,new V(4,122),new V(18,123)),new ge(28,new V(13,46),new V(32,47)),new ge(30,new V(48,24),new V(14,25)),new ge(30,new V(42,15),new V(32,16))),new dt(39,Int32Array.from([6,26,54,82,110,138,166]),new ge(30,new V(20,117),new V(4,118)),new ge(28,new V(40,47),new V(7,48)),new ge(30,new V(43,24),new V(22,25)),new ge(30,new V(10,15),new V(67,16))),new dt(40,Int32Array.from([6,30,58,86,114,142,170]),new ge(30,new V(19,118),new V(6,119)),new ge(28,new V(18,47),new V(31,48)),new ge(30,new V(34,24),new V(34,25)),new ge(30,new V(20,15),new V(61,16)))];var $r;(function(k){k[k.DATA_MASK_000=0]="DATA_MASK_000",k[k.DATA_MASK_001=1]="DATA_MASK_001",k[k.DATA_MASK_010=2]="DATA_MASK_010",k[k.DATA_MASK_011=3]="DATA_MASK_011",k[k.DATA_MASK_100=4]="DATA_MASK_100",k[k.DATA_MASK_101=5]="DATA_MASK_101",k[k.DATA_MASK_110=6]="DATA_MASK_110",k[k.DATA_MASK_111=7]="DATA_MASK_111"})($r||($r={}));class ya{constructor(a,i){this.value=a,this.isMasked=i}unmaskBitMatrix(a,i){for(let o=0;o<i;o++)for(let l=0;l<i;l++)this.isMasked(o,l)&&a.flip(l,o)}}ya.values=new Map([[$r.DATA_MASK_000,new ya($r.DATA_MASK_000,(k,a)=>(k+a&1)===0)],[$r.DATA_MASK_001,new ya($r.DATA_MASK_001,(k,a)=>(k&1)===0)],[$r.DATA_MASK_010,new ya($r.DATA_MASK_010,(k,a)=>a%3===0)],[$r.DATA_MASK_011,new ya($r.DATA_MASK_011,(k,a)=>(k+a)%3===0)],[$r.DATA_MASK_100,new ya($r.DATA_MASK_100,(k,a)=>(Math.floor(k/2)+Math.floor(a/3)&1)===0)],[$r.DATA_MASK_101,new ya($r.DATA_MASK_101,(k,a)=>k*a%6===0)],[$r.DATA_MASK_110,new ya($r.DATA_MASK_110,(k,a)=>k*a%6<3)],[$r.DATA_MASK_111,new ya($r.DATA_MASK_111,(k,a)=>(k+a+k*a%3&1)===0)]]);class Z0{constructor(a){const i=a.getHeight();if(i<21||(i&3)!==1)throw new M;this.bitMatrix=a}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let a=0;for(let f=0;f<6;f++)a=this.copyBit(f,8,a);a=this.copyBit(7,8,a),a=this.copyBit(8,8,a),a=this.copyBit(8,7,a);for(let f=5;f>=0;f--)a=this.copyBit(8,f,a);const i=this.bitMatrix.getHeight();let o=0;const l=i-7;for(let f=i-1;f>=l;f--)o=this.copyBit(8,f,o);for(let f=i-8;f<i;f++)o=this.copyBit(f,8,o);if(this.parsedFormatInfo=ma.decodeFormatInformation(a,o),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new M}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const a=this.bitMatrix.getHeight(),i=Math.floor((a-17)/4);if(i<=6)return dt.getVersionForNumber(i);let o=0;const l=a-11;for(let u=5;u>=0;u--)for(let x=a-9;x>=l;x--)o=this.copyBit(x,u,o);let f=dt.decodeVersionInformation(o);if(f!==null&&f.getDimensionForVersion()===a)return this.parsedVersion=f,f;o=0;for(let u=5;u>=0;u--)for(let x=a-9;x>=l;x--)o=this.copyBit(u,x,o);if(f=dt.decodeVersionInformation(o),f!==null&&f.getDimensionForVersion()===a)return this.parsedVersion=f,f;throw new M}copyBit(a,i,o){return(this.isMirror?this.bitMatrix.get(i,a):this.bitMatrix.get(a,i))?o<<1|1:o<<1}readCodewords(){const a=this.readFormatInformation(),i=this.readVersion(),o=ya.values.get(a.getDataMask()),l=this.bitMatrix.getHeight();o.unmaskBitMatrix(this.bitMatrix,l);const f=i.buildFunctionPattern();let u=!0;const x=new Uint8Array(i.getTotalCodewords());let p=0,y=0,b=0;for(let I=l-1;I>0;I-=2){I===6&&I--;for(let R=0;R<l;R++){const G=u?l-1-R:R;for(let Q=0;Q<2;Q++)f.get(I-Q,G)||(b++,y<<=1,this.bitMatrix.get(I-Q,G)&&(y|=1),b===8&&(x[p++]=y,b=0,y=0))}u=!u}if(p!==i.getTotalCodewords())throw new M;return x}remask(){if(this.parsedFormatInfo===null)return;const a=ya.values[this.parsedFormatInfo.getDataMask()],i=this.bitMatrix.getHeight();a.unmaskBitMatrix(this.bitMatrix,i)}setMirror(a){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=a}mirror(){const a=this.bitMatrix;for(let i=0,o=a.getWidth();i<o;i++)for(let l=i+1,f=a.getHeight();l<f;l++)a.get(i,l)!==a.get(l,i)&&(a.flip(l,i),a.flip(i,l))}}class Js{constructor(a,i){this.numDataCodewords=a,this.codewords=i}static getDataBlocks(a,i,o){if(a.length!==i.getTotalCodewords())throw new _;const l=i.getECBlocksForLevel(o);let f=0;const u=l.getECBlocks();for(const Q of u)f+=Q.getCount();const x=new Array(f);let p=0;for(const Q of u)for(let re=0;re<Q.getCount();re++){const de=Q.getDataCodewords(),Ae=l.getECCodewordsPerBlock()+de;x[p++]=new Js(de,new Uint8Array(Ae))}const y=x[0].codewords.length;let b=x.length-1;for(;b>=0&&x[b].codewords.length!==y;)b--;b++;const I=y-l.getECCodewordsPerBlock();let R=0;for(let Q=0;Q<I;Q++)for(let re=0;re<p;re++)x[re].codewords[Q]=a[R++];for(let Q=b;Q<p;Q++)x[Q].codewords[I]=a[R++];const G=x[0].codewords.length;for(let Q=I;Q<G;Q++)for(let re=0;re<p;re++){const de=re<b?Q:Q+1;x[re].codewords[de]=a[R++]}return x}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Ea;(function(k){k[k.TERMINATOR=0]="TERMINATOR",k[k.NUMERIC=1]="NUMERIC",k[k.ALPHANUMERIC=2]="ALPHANUMERIC",k[k.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",k[k.BYTE=4]="BYTE",k[k.ECI=5]="ECI",k[k.KANJI=6]="KANJI",k[k.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",k[k.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",k[k.HANZI=9]="HANZI"})(Ea||(Ea={}));class xt{constructor(a,i,o,l){this.value=a,this.stringValue=i,this.characterCountBitsForVersions=o,this.bits=l,xt.FOR_BITS.set(l,this),xt.FOR_VALUE.set(a,this)}static forBits(a){const i=xt.FOR_BITS.get(a);if(i===void 0)throw new _;return i}getCharacterCountBits(a){const i=a.getVersionNumber();let o;return i<=9?o=0:i<=26?o=1:o=2,this.characterCountBitsForVersions[o]}getValue(){return this.value}getBits(){return this.bits}equals(a){if(!(a instanceof xt))return!1;const i=a;return this.value===i.value}toString(){return this.stringValue}}xt.FOR_BITS=new Map,xt.FOR_VALUE=new Map,xt.TERMINATOR=new xt(Ea.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),xt.NUMERIC=new xt(Ea.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),xt.ALPHANUMERIC=new xt(Ea.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),xt.STRUCTURED_APPEND=new xt(Ea.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),xt.BYTE=new xt(Ea.BYTE,"BYTE",Int32Array.from([8,16,16]),4),xt.ECI=new xt(Ea.ECI,"ECI",Int32Array.from([0,0,0]),7),xt.KANJI=new xt(Ea.KANJI,"KANJI",Int32Array.from([8,10,12]),8),xt.FNC1_FIRST_POSITION=new xt(Ea.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),xt.FNC1_SECOND_POSITION=new xt(Ea.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),xt.HANZI=new xt(Ea.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Er{static decode(a,i,o,l){const f=new Yn(a);let u=new be;const x=new Array;let p=-1,y=-1;try{let b=null,I=!1,R;do{if(f.available()<4)R=xt.TERMINATOR;else{const G=f.readBits(4);R=xt.forBits(G)}switch(R){case xt.TERMINATOR:break;case xt.FNC1_FIRST_POSITION:case xt.FNC1_SECOND_POSITION:I=!0;break;case xt.STRUCTURED_APPEND:if(f.available()<16)throw new M;p=f.readBits(8),y=f.readBits(8);break;case xt.ECI:const G=Er.parseECIValue(f);if(b=j.getCharacterSetECIByValue(G),b===null)throw new M;break;case xt.HANZI:const Q=f.readBits(4),re=f.readBits(R.getCharacterCountBits(i));Q===Er.GB2312_SUBSET&&Er.decodeHanziSegment(f,u,re);break;default:const de=f.readBits(R.getCharacterCountBits(i));switch(R){case xt.NUMERIC:Er.decodeNumericSegment(f,u,de);break;case xt.ALPHANUMERIC:Er.decodeAlphanumericSegment(f,u,de,I);break;case xt.BYTE:Er.decodeByteSegment(f,u,de,b,x,l);break;case xt.KANJI:Er.decodeKanjiSegment(f,u,de);break;default:throw new M}break}}while(R!==xt.TERMINATOR)}catch{throw new M}return new Pe(a,u.toString(),x.length===0?null:x,o===null?null:o.toString(),p,y)}static decodeHanziSegment(a,i,o){if(o*13>a.available())throw new M;const l=new Uint8Array(2*o);let f=0;for(;o>0;){const u=a.readBits(13);let x=u/96<<8&4294967295|u%96;x<959?x+=41377:x+=42657,l[f]=x>>8&255,l[f+1]=x&255,f+=2,o--}try{i.append(he.decode(l,te.GB2312))}catch(u){throw new M(u)}}static decodeKanjiSegment(a,i,o){if(o*13>a.available())throw new M;const l=new Uint8Array(2*o);let f=0;for(;o>0;){const u=a.readBits(13);let x=u/192<<8&4294967295|u%192;x<7936?x+=33088:x+=49472,l[f]=x>>8,l[f+1]=x,f+=2,o--}try{i.append(he.decode(l,te.SHIFT_JIS))}catch(u){throw new M(u)}}static decodeByteSegment(a,i,o,l,f,u){if(8*o>a.available())throw new M;const x=new Uint8Array(o);for(let y=0;y<o;y++)x[y]=a.readBits(8);let p;l===null?p=te.guessEncoding(x,u):p=l.getName();try{i.append(he.decode(x,p))}catch(y){throw new M(y)}f.push(x)}static toAlphaNumericChar(a){if(a>=Er.ALPHANUMERIC_CHARS.length)throw new M;return Er.ALPHANUMERIC_CHARS[a]}static decodeAlphanumericSegment(a,i,o,l){const f=i.length();for(;o>1;){if(a.available()<11)throw new M;const u=a.readBits(11);i.append(Er.toAlphaNumericChar(Math.floor(u/45))),i.append(Er.toAlphaNumericChar(u%45)),o-=2}if(o===1){if(a.available()<6)throw new M;i.append(Er.toAlphaNumericChar(a.readBits(6)))}if(l)for(let u=f;u<i.length();u++)i.charAt(u)==="%"&&(u<i.length()-1&&i.charAt(u+1)==="%"?i.deleteCharAt(u+1):i.setCharAt(u,""))}static decodeNumericSegment(a,i,o){for(;o>=3;){if(a.available()<10)throw new M;const l=a.readBits(10);if(l>=1e3)throw new M;i.append(Er.toAlphaNumericChar(Math.floor(l/100))),i.append(Er.toAlphaNumericChar(Math.floor(l/10)%10)),i.append(Er.toAlphaNumericChar(l%10)),o-=3}if(o===2){if(a.available()<7)throw new M;const l=a.readBits(7);if(l>=100)throw new M;i.append(Er.toAlphaNumericChar(Math.floor(l/10))),i.append(Er.toAlphaNumericChar(l%10))}else if(o===1){if(a.available()<4)throw new M;const l=a.readBits(4);if(l>=10)throw new M;i.append(Er.toAlphaNumericChar(l))}}static parseECIValue(a){const i=a.readBits(8);if(!(i&128))return i&127;if((i&192)===128){const o=a.readBits(8);return(i&63)<<8&4294967295|o}if((i&224)===192){const o=a.readBits(16);return(i&31)<<16&4294967295|o}throw new M}}Er.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Er.GB2312_SUBSET=1;class ms{constructor(a){this.mirrored=a}isMirrored(){return this.mirrored}applyMirroredCorrection(a){if(!this.mirrored||a===null||a.length<3)return;const i=a[0];a[0]=a[2],a[2]=i}}class xc{constructor(){this.rsDecoder=new Xe(Y.QR_CODE_FIELD_256)}decodeBooleanArray(a,i){return this.decodeBitMatrix($e.parseFromBooleanArray(a),i)}decodeBitMatrix(a,i){const o=new Z0(a);let l=null;try{return this.decodeBitMatrixParser(o,i)}catch(f){l=f}try{o.remask(),o.setMirror(!0),o.readVersion(),o.readFormatInformation(),o.mirror();const f=this.decodeBitMatrixParser(o,i);return f.setOther(new ms(!0)),f}catch(f){throw l!==null?l:f}}decodeBitMatrixParser(a,i){const o=a.readVersion(),l=a.readFormatInformation().getErrorCorrectionLevel(),f=a.readCodewords(),u=Js.getDataBlocks(f,o,l);let x=0;for(const b of u)x+=b.getNumDataCodewords();const p=new Uint8Array(x);let y=0;for(const b of u){const I=b.getCodewords(),R=b.getNumDataCodewords();this.correctErrors(I,R);for(let G=0;G<R;G++)p[y++]=I[G]}return Er.decode(p,o,l,i)}correctErrors(a,i){const o=new Int32Array(a);try{this.rsDecoder.decode(o,a.length-i)}catch{throw new T}for(let l=0;l<i;l++)a[l]=o[l]}}class Qs extends st{constructor(a,i,o){super(a,i),this.estimatedModuleSize=o}aboutEquals(a,i,o){if(Math.abs(i-this.getY())<=a&&Math.abs(o-this.getX())<=a){const l=Math.abs(a-this.estimatedModuleSize);return l<=1||l<=this.estimatedModuleSize}return!1}combineEstimate(a,i,o){const l=(this.getX()+i)/2,f=(this.getY()+a)/2,u=(this.estimatedModuleSize+o)/2;return new Qs(l,f,u)}}class ps{constructor(a,i,o,l,f,u,x){this.image=a,this.startX=i,this.startY=o,this.width=l,this.height=f,this.moduleSize=u,this.resultPointCallback=x,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const a=this.startX,i=this.height,o=this.width,l=a+o,f=this.startY+i/2,u=new Int32Array(3),x=this.image;for(let p=0;p<i;p++){const y=f+(p&1?-Math.floor((p+1)/2):Math.floor((p+1)/2));u[0]=0,u[1]=0,u[2]=0;let b=a;for(;b<l&&!x.get(b,y);)b++;let I=0;for(;b<l;){if(x.get(b,y))if(I===1)u[1]++;else if(I===2){if(this.foundPatternCross(u)){const R=this.handlePossibleCenter(u,y,b);if(R!==null)return R}u[0]=u[2],u[1]=1,u[2]=0,I=1}else u[++I]++;else I===1&&I++,u[I]++;b++}if(this.foundPatternCross(u)){const R=this.handlePossibleCenter(u,y,l);if(R!==null)return R}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new ae}static centerFromEnd(a,i){return i-a[2]-a[1]/2}foundPatternCross(a){const i=this.moduleSize,o=i/2;for(let l=0;l<3;l++)if(Math.abs(i-a[l])>=o)return!1;return!0}crossCheckVertical(a,i,o,l){const f=this.image,u=f.getHeight(),x=this.crossCheckStateCount;x[0]=0,x[1]=0,x[2]=0;let p=a;for(;p>=0&&f.get(i,p)&&x[1]<=o;)x[1]++,p--;if(p<0||x[1]>o)return NaN;for(;p>=0&&!f.get(i,p)&&x[0]<=o;)x[0]++,p--;if(x[0]>o)return NaN;for(p=a+1;p<u&&f.get(i,p)&&x[1]<=o;)x[1]++,p++;if(p===u||x[1]>o)return NaN;for(;p<u&&!f.get(i,p)&&x[2]<=o;)x[2]++,p++;if(x[2]>o)return NaN;const y=x[0]+x[1]+x[2];return 5*Math.abs(y-l)>=2*l?NaN:this.foundPatternCross(x)?ps.centerFromEnd(x,p):NaN}handlePossibleCenter(a,i,o){const l=a[0]+a[1]+a[2],f=ps.centerFromEnd(a,o),u=this.crossCheckVertical(i,f,2*a[1],l);if(!isNaN(u)){const x=(a[0]+a[1]+a[2])/3;for(const y of this.possibleCenters)if(y.aboutEquals(x,u,f))return y.combineEstimate(u,f,x);const p=new Qs(f,u,x);this.possibleCenters.push(p),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(p)}return null}}class $s extends st{constructor(a,i,o,l){super(a,i),this.estimatedModuleSize=o,this.count=l,l===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(a,i,o){if(Math.abs(i-this.getY())<=a&&Math.abs(o-this.getX())<=a){const l=Math.abs(a-this.estimatedModuleSize);return l<=1||l<=this.estimatedModuleSize}return!1}combineEstimate(a,i,o){const l=this.count+1,f=(this.count*this.getX()+i)/l,u=(this.count*this.getY()+a)/l,x=(this.count*this.estimatedModuleSize+o)/l;return new $s(f,u,x,l)}}class e0{constructor(a){this.bottomLeft=a[0],this.topLeft=a[1],this.topRight=a[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Zt{constructor(a,i){this.image=a,this.resultPointCallback=i,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=i}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(a){const i=a!=null&&a.get(J.TRY_HARDER)!==void 0,o=a!=null&&a.get(J.PURE_BARCODE)!==void 0,l=this.image,f=l.getHeight(),u=l.getWidth();let x=Math.floor(3*f/(4*Zt.MAX_MODULES));(x<Zt.MIN_SKIP||i)&&(x=Zt.MIN_SKIP);let p=!1;const y=new Int32Array(5);for(let I=x-1;I<f&&!p;I+=x){y[0]=0,y[1]=0,y[2]=0,y[3]=0,y[4]=0;let R=0;for(let G=0;G<u;G++)if(l.get(G,I))(R&1)===1&&R++,y[R]++;else if(R&1)y[R]++;else if(R===4)if(Zt.foundPatternCross(y)){if(this.handlePossibleCenter(y,I,G,o)===!0)if(x=2,this.hasSkipped===!0)p=this.haveMultiplyConfirmedCenters();else{const re=this.findRowSkip();re>y[2]&&(I+=re-y[2]-x,G=u-1)}else{y[0]=y[2],y[1]=y[3],y[2]=y[4],y[3]=1,y[4]=0,R=3;continue}R=0,y[0]=0,y[1]=0,y[2]=0,y[3]=0,y[4]=0}else y[0]=y[2],y[1]=y[3],y[2]=y[4],y[3]=1,y[4]=0,R=3;else y[++R]++;Zt.foundPatternCross(y)&&this.handlePossibleCenter(y,I,u,o)===!0&&(x=y[0],this.hasSkipped&&(p=this.haveMultiplyConfirmedCenters()))}const b=this.selectBestPatterns();return st.orderBestPatterns(b),new e0(b)}static centerFromEnd(a,i){return i-a[4]-a[3]-a[2]/2}static foundPatternCross(a){let i=0;for(let f=0;f<5;f++){const u=a[f];if(u===0)return!1;i+=u}if(i<7)return!1;const o=i/7,l=o/2;return Math.abs(o-a[0])<l&&Math.abs(o-a[1])<l&&Math.abs(3*o-a[2])<3*l&&Math.abs(o-a[3])<l&&Math.abs(o-a[4])<l}getCrossCheckStateCount(){const a=this.crossCheckStateCount;return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a}crossCheckDiagonal(a,i,o,l){const f=this.getCrossCheckStateCount();let u=0;const x=this.image;for(;a>=u&&i>=u&&x.get(i-u,a-u);)f[2]++,u++;if(a<u||i<u)return!1;for(;a>=u&&i>=u&&!x.get(i-u,a-u)&&f[1]<=o;)f[1]++,u++;if(a<u||i<u||f[1]>o)return!1;for(;a>=u&&i>=u&&x.get(i-u,a-u)&&f[0]<=o;)f[0]++,u++;if(f[0]>o)return!1;const p=x.getHeight(),y=x.getWidth();for(u=1;a+u<p&&i+u<y&&x.get(i+u,a+u);)f[2]++,u++;if(a+u>=p||i+u>=y)return!1;for(;a+u<p&&i+u<y&&!x.get(i+u,a+u)&&f[3]<o;)f[3]++,u++;if(a+u>=p||i+u>=y||f[3]>=o)return!1;for(;a+u<p&&i+u<y&&x.get(i+u,a+u)&&f[4]<o;)f[4]++,u++;if(f[4]>=o)return!1;const b=f[0]+f[1]+f[2]+f[3]+f[4];return Math.abs(b-l)<2*l&&Zt.foundPatternCross(f)}crossCheckVertical(a,i,o,l){const f=this.image,u=f.getHeight(),x=this.getCrossCheckStateCount();let p=a;for(;p>=0&&f.get(i,p);)x[2]++,p--;if(p<0)return NaN;for(;p>=0&&!f.get(i,p)&&x[1]<=o;)x[1]++,p--;if(p<0||x[1]>o)return NaN;for(;p>=0&&f.get(i,p)&&x[0]<=o;)x[0]++,p--;if(x[0]>o)return NaN;for(p=a+1;p<u&&f.get(i,p);)x[2]++,p++;if(p===u)return NaN;for(;p<u&&!f.get(i,p)&&x[3]<o;)x[3]++,p++;if(p===u||x[3]>=o)return NaN;for(;p<u&&f.get(i,p)&&x[4]<o;)x[4]++,p++;if(x[4]>=o)return NaN;const y=x[0]+x[1]+x[2]+x[3]+x[4];return 5*Math.abs(y-l)>=2*l?NaN:Zt.foundPatternCross(x)?Zt.centerFromEnd(x,p):NaN}crossCheckHorizontal(a,i,o,l){const f=this.image,u=f.getWidth(),x=this.getCrossCheckStateCount();let p=a;for(;p>=0&&f.get(p,i);)x[2]++,p--;if(p<0)return NaN;for(;p>=0&&!f.get(p,i)&&x[1]<=o;)x[1]++,p--;if(p<0||x[1]>o)return NaN;for(;p>=0&&f.get(p,i)&&x[0]<=o;)x[0]++,p--;if(x[0]>o)return NaN;for(p=a+1;p<u&&f.get(p,i);)x[2]++,p++;if(p===u)return NaN;for(;p<u&&!f.get(p,i)&&x[3]<o;)x[3]++,p++;if(p===u||x[3]>=o)return NaN;for(;p<u&&f.get(p,i)&&x[4]<o;)x[4]++,p++;if(x[4]>=o)return NaN;const y=x[0]+x[1]+x[2]+x[3]+x[4];return 5*Math.abs(y-l)>=l?NaN:Zt.foundPatternCross(x)?Zt.centerFromEnd(x,p):NaN}handlePossibleCenter(a,i,o,l){const f=a[0]+a[1]+a[2]+a[3]+a[4];let u=Zt.centerFromEnd(a,o),x=this.crossCheckVertical(i,Math.floor(u),a[2],f);if(!isNaN(x)&&(u=this.crossCheckHorizontal(Math.floor(u),Math.floor(x),a[2],f),!isNaN(u)&&(!l||this.crossCheckDiagonal(Math.floor(x),Math.floor(u),a[2],f)))){const p=f/7;let y=!1;const b=this.possibleCenters;for(let I=0,R=b.length;I<R;I++){const G=b[I];if(G.aboutEquals(p,x,u)){b[I]=G.combineEstimate(x,u,p),y=!0;break}}if(!y){const I=new $s(u,x,p);b.push(I),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(I)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let i=null;for(const o of this.possibleCenters)if(o.getCount()>=Zt.CENTER_QUORUM)if(i==null)i=o;else return this.hasSkipped=!0,Math.floor((Math.abs(i.getX()-o.getX())-Math.abs(i.getY()-o.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let a=0,i=0;const o=this.possibleCenters.length;for(const u of this.possibleCenters)u.getCount()>=Zt.CENTER_QUORUM&&(a++,i+=u.getEstimatedModuleSize());if(a<3)return!1;const l=i/o;let f=0;for(const u of this.possibleCenters)f+=Math.abs(u.getEstimatedModuleSize()-l);return f<=.05*i}selectBestPatterns(){const a=this.possibleCenters.length;if(a<3)throw new ae;const i=this.possibleCenters;let o;if(a>3){let l=0,f=0;for(const p of this.possibleCenters){const y=p.getEstimatedModuleSize();l+=y,f+=y*y}o=l/a;let u=Math.sqrt(f/a-o*o);i.sort((p,y)=>{const b=Math.abs(y.getEstimatedModuleSize()-o),I=Math.abs(p.getEstimatedModuleSize()-o);return b<I?-1:b>I?1:0});const x=Math.max(.2*o,u);for(let p=0;p<i.length&&i.length>3;p++){const y=i[p];Math.abs(y.getEstimatedModuleSize()-o)>x&&(i.splice(p,1),p--)}}if(i.length>3){let l=0;for(const f of i)l+=f.getEstimatedModuleSize();o=l/i.length,i.sort((f,u)=>{if(u.getCount()===f.getCount()){const x=Math.abs(u.getEstimatedModuleSize()-o),p=Math.abs(f.getEstimatedModuleSize()-o);return x<p?1:x>p?-1:0}else return u.getCount()-f.getCount()}),i.splice(3)}return[i[0],i[1],i[2]]}}Zt.CENTER_QUORUM=2,Zt.MIN_SKIP=3,Zt.MAX_MODULES=57;class vi{constructor(a){this.image=a}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(a){this.resultPointCallback=a==null?null:a.get(J.NEED_RESULT_POINT_CALLBACK);const o=new Zt(this.image,this.resultPointCallback).find(a);return this.processFinderPatternInfo(o)}processFinderPatternInfo(a){const i=a.getTopLeft(),o=a.getTopRight(),l=a.getBottomLeft(),f=this.calculateModuleSize(i,o,l);if(f<1)throw new ae("No pattern found in proccess finder.");const u=vi.computeDimension(i,o,l,f),x=dt.getProvisionalVersionForDimension(u),p=x.getDimensionForVersion()-7;let y=null;if(x.getAlignmentPatternCenters().length>0){const G=o.getX()-i.getX()+l.getX(),Q=o.getY()-i.getY()+l.getY(),re=1-3/p,de=Math.floor(i.getX()+re*(G-i.getX())),Ae=Math.floor(i.getY()+re*(Q-i.getY()));for(let qe=4;qe<=16;qe<<=1)try{y=this.findAlignmentInRegion(f,de,Ae,qe);break}catch(Je){if(!(Je instanceof ae))throw Je}}const b=vi.createTransform(i,o,l,y,u),I=vi.sampleGrid(this.image,b,u);let R;return y===null?R=[l,i,o]:R=[l,i,o,y],new wn(I,R)}static createTransform(a,i,o,l,f){const u=f-3.5;let x,p,y,b;return l!==null?(x=l.getX(),p=l.getY(),y=u-3,b=y):(x=i.getX()-a.getX()+o.getX(),p=i.getY()-a.getY()+o.getY(),y=u,b=u),Rr.quadrilateralToQuadrilateral(3.5,3.5,u,3.5,y,b,3.5,u,a.getX(),a.getY(),i.getX(),i.getY(),x,p,o.getX(),o.getY())}static sampleGrid(a,i,o){return Ar.getInstance().sampleGridWithTransform(a,o,o,i)}static computeDimension(a,i,o,l){const f=vt.round(st.distance(a,i)/l),u=vt.round(st.distance(a,o)/l);let x=Math.floor((f+u)/2)+7;switch(x&3){case 0:x++;break;case 2:x--;break;case 3:throw new ae("Dimensions could be not found.")}return x}calculateModuleSize(a,i,o){return(this.calculateModuleSizeOneWay(a,i)+this.calculateModuleSizeOneWay(a,o))/2}calculateModuleSizeOneWay(a,i){const o=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(a.getX()),Math.floor(a.getY()),Math.floor(i.getX()),Math.floor(i.getY())),l=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(i.getX()),Math.floor(i.getY()),Math.floor(a.getX()),Math.floor(a.getY()));return isNaN(o)?l/7:isNaN(l)?o/7:(o+l)/14}sizeOfBlackWhiteBlackRunBothWays(a,i,o,l){let f=this.sizeOfBlackWhiteBlackRun(a,i,o,l),u=1,x=a-(o-a);x<0?(u=a/(a-x),x=0):x>=this.image.getWidth()&&(u=(this.image.getWidth()-1-a)/(x-a),x=this.image.getWidth()-1);let p=Math.floor(i-(l-i)*u);return u=1,p<0?(u=i/(i-p),p=0):p>=this.image.getHeight()&&(u=(this.image.getHeight()-1-i)/(p-i),p=this.image.getHeight()-1),x=Math.floor(a+(x-a)*u),f+=this.sizeOfBlackWhiteBlackRun(a,i,x,p),f-1}sizeOfBlackWhiteBlackRun(a,i,o,l){const f=Math.abs(l-i)>Math.abs(o-a);if(f){let G=a;a=i,i=G,G=o,o=l,l=G}const u=Math.abs(o-a),x=Math.abs(l-i);let p=-u/2;const y=a<o?1:-1,b=i<l?1:-1;let I=0;const R=o+y;for(let G=a,Q=i;G!==R;G+=y){const re=f?Q:G,de=f?G:Q;if(I===1===this.image.get(re,de)){if(I===2)return vt.distance(G,Q,a,i);I++}if(p+=x,p>0){if(Q===l)break;Q+=b,p-=u}}return I===2?vt.distance(o+y,l,a,i):NaN}findAlignmentInRegion(a,i,o,l){const f=Math.floor(l*a),u=Math.max(0,i-f),x=Math.min(this.image.getWidth()-1,i+f);if(x-u<a*3)throw new ae("Alignment top exceeds estimated module size.");const p=Math.max(0,o-f),y=Math.min(this.image.getHeight()-1,o+f);if(y-p<a*3)throw new ae("Alignment bottom exceeds estimated module size.");return new ps(this.image,u,p,x-u,y-p,a,this.resultPointCallback).find()}}class Fn{constructor(){this.decoder=new xc}getDecoder(){return this.decoder}decode(a,i){let o,l;if(i!=null&&i.get(J.PURE_BARCODE)!==void 0){const p=Fn.extractPureBits(a.getBlackMatrix());o=this.decoder.decodeBitMatrix(p,i),l=Fn.NO_POINTS}else{const p=new vi(a.getBlackMatrix()).detect(i);o=this.decoder.decodeBitMatrix(p.getBits(),i),l=p.getPoints()}o.getOther()instanceof ms&&o.getOther().applyMirroredCorrection(l);const f=new ee(o.getText(),o.getRawBytes(),void 0,l,le.QR_CODE,void 0),u=o.getByteSegments();u!==null&&f.putMetadata(Le.BYTE_SEGMENTS,u);const x=o.getECLevel();return x!==null&&f.putMetadata(Le.ERROR_CORRECTION_LEVEL,x),o.hasStructuredAppend()&&(f.putMetadata(Le.STRUCTURED_APPEND_SEQUENCE,o.getStructuredAppendSequenceNumber()),f.putMetadata(Le.STRUCTURED_APPEND_PARITY,o.getStructuredAppendParity())),f}reset(){}static extractPureBits(a){const i=a.getTopLeftOnBit(),o=a.getBottomRightOnBit();if(i===null||o===null)throw new ae;const l=this.moduleSize(i,a);let f=i[1],u=o[1],x=i[0],p=o[0];if(x>=p||f>=u)throw new ae;if(u-f!==p-x&&(p=x+(u-f),p>=a.getWidth()))throw new ae;const y=Math.round((p-x+1)/l),b=Math.round((u-f+1)/l);if(y<=0||b<=0)throw new ae;if(b!==y)throw new ae;const I=Math.floor(l/2);f+=I,x+=I;const R=x+Math.floor((y-1)*l)-p;if(R>0){if(R>I)throw new ae;x-=R}const G=f+Math.floor((b-1)*l)-u;if(G>0){if(G>I)throw new ae;f-=G}const Q=new $e(y,b);for(let re=0;re<b;re++){const de=f+Math.floor(re*l);for(let Ae=0;Ae<y;Ae++)a.get(x+Math.floor(Ae*l),de)&&Q.set(Ae,re)}return Q}static moduleSize(a,i){const o=i.getHeight(),l=i.getWidth();let f=a[0],u=a[1],x=!0,p=0;for(;f<l&&u<o;){if(x!==i.get(f,u)){if(++p===5)break;x=!x}f++,u++}if(f===l||u===o)throw new ae;return(f-a[0])/7}}Fn.NO_POINTS=new Array;class Et{PDF417Common(){}static getBitCountSum(a){return vt.sum(a)}static toIntArray(a){if(a==null||!a.length)return Et.EMPTY_INT_ARRAY;const i=new Int32Array(a.length);let o=0;for(const l of a)i[o++]=l;return i}static getCodeword(a){const i=X.binarySearch(Et.SYMBOL_TABLE,a&262143);return i<0?-1:(Et.CODEWORD_TABLE[i]-1)%Et.NUMBER_OF_CODEWORDS}}Et.NUMBER_OF_CODEWORDS=929,Et.MAX_CODEWORDS_IN_BARCODE=Et.NUMBER_OF_CODEWORDS-1,Et.MIN_ROWS_IN_BARCODE=3,Et.MAX_ROWS_IN_BARCODE=90,Et.MODULES_IN_CODEWORD=17,Et.MODULES_IN_STOP_PATTERN=18,Et.BARS_IN_MODULE=8,Et.EMPTY_INT_ARRAY=new Int32Array([]),Et.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Et.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class J0{constructor(a,i){this.bits=a,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class Pt{static detectMultiple(a,i,o){let l=a.getBlackMatrix(),f=Pt.detect(o,l);return f.length||(l=l.clone(),l.rotate180(),f=Pt.detect(o,l)),new J0(l,f)}static detect(a,i){const o=new Array;let l=0,f=0,u=!1;for(;l<i.getHeight();){const x=Pt.findVertices(i,l,f);if(x[0]==null&&x[3]==null){if(!u)break;u=!1,f=0;for(const p of o)p[1]!=null&&(l=Math.trunc(Math.max(l,p[1].getY()))),p[3]!=null&&(l=Math.max(l,Math.trunc(p[3].getY())));l+=Pt.ROW_STEP;continue}if(u=!0,o.push(x),!a)break;x[2]!=null?(f=Math.trunc(x[2].getX()),l=Math.trunc(x[2].getY())):(f=Math.trunc(x[4].getX()),l=Math.trunc(x[4].getY()))}return o}static findVertices(a,i,o){const l=a.getHeight(),f=a.getWidth(),u=new Array(8);return Pt.copyToResult(u,Pt.findRowsWithPattern(a,l,f,i,o,Pt.START_PATTERN),Pt.INDEXES_START_PATTERN),u[4]!=null&&(o=Math.trunc(u[4].getX()),i=Math.trunc(u[4].getY())),Pt.copyToResult(u,Pt.findRowsWithPattern(a,l,f,i,o,Pt.STOP_PATTERN),Pt.INDEXES_STOP_PATTERN),u}static copyToResult(a,i,o){for(let l=0;l<o.length;l++)a[o[l]]=i[l]}static findRowsWithPattern(a,i,o,l,f,u){const x=new Array(4);let p=!1;const y=new Int32Array(u.length);for(;l<i;l+=Pt.ROW_STEP){let I=Pt.findGuardPattern(a,f,l,o,!1,u,y);if(I!=null){for(;l>0;){const R=Pt.findGuardPattern(a,f,--l,o,!1,u,y);if(R!=null)I=R;else{l++;break}}x[0]=new st(I[0],l),x[1]=new st(I[1],l),p=!0;break}}let b=l+1;if(p){let I=0,R=Int32Array.from([Math.trunc(x[0].getX()),Math.trunc(x[1].getX())]);for(;b<i;b++){const G=Pt.findGuardPattern(a,R[0],b,o,!1,u,y);if(G!=null&&Math.abs(R[0]-G[0])<Pt.MAX_PATTERN_DRIFT&&Math.abs(R[1]-G[1])<Pt.MAX_PATTERN_DRIFT)R=G,I=0;else{if(I>Pt.SKIPPED_ROW_COUNT_MAX)break;I++}}b-=I+1,x[2]=new st(R[0],b),x[3]=new st(R[1],b)}return b-l<Pt.BARCODE_MIN_HEIGHT&&X.fill(x,null),x}static findGuardPattern(a,i,o,l,f,u,x){X.fillWithin(x,0,x.length,0);let p=i,y=0;for(;a.get(p,o)&&p>0&&y++<Pt.MAX_PIXEL_DRIFT;)p--;let b=p,I=0,R=u.length;for(let G=f;b<l;b++)if(a.get(b,o)!==G)x[I]++;else{if(I===R-1){if(Pt.patternMatchVariance(x,u,Pt.MAX_INDIVIDUAL_VARIANCE)<Pt.MAX_AVG_VARIANCE)return new Int32Array([p,b]);p+=x[0]+x[1],C.arraycopy(x,2,x,0,I-1),x[I-1]=0,x[I]=0,I--}else I++;x[I]=1,G=!G}return I===R-1&&Pt.patternMatchVariance(x,u,Pt.MAX_INDIVIDUAL_VARIANCE)<Pt.MAX_AVG_VARIANCE?new Int32Array([p,b-1]):null}static patternMatchVariance(a,i,o){let l=a.length,f=0,u=0;for(let y=0;y<l;y++)f+=a[y],u+=i[y];if(f<u)return 1/0;let x=f/u;o*=x;let p=0;for(let y=0;y<l;y++){let b=a[y],I=i[y]*x,R=b>I?b-I:I-b;if(R>o)return 1/0;p+=R}return p/f}}Pt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Pt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Pt.MAX_AVG_VARIANCE=.42,Pt.MAX_INDIVIDUAL_VARIANCE=.8,Pt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Pt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Pt.MAX_PIXEL_DRIFT=3,Pt.MAX_PATTERN_DRIFT=5,Pt.SKIPPED_ROW_COUNT_MAX=25,Pt.ROW_STEP=5,Pt.BARCODE_MIN_HEIGHT=10;class ia{constructor(a,i){if(i.length===0)throw new _;this.field=a;let o=i.length;if(o>1&&i[0]===0){let l=1;for(;l<o&&i[l]===0;)l++;l===o?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(o-l),C.arraycopy(i,l,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(a){return this.coefficients[this.coefficients.length-1-a]}evaluateAt(a){if(a===0)return this.getCoefficient(0);if(a===1){let l=0;for(let f of this.coefficients)l=this.field.add(l,f);return l}let i=this.coefficients[0],o=this.coefficients.length;for(let l=1;l<o;l++)i=this.field.add(this.field.multiply(a,i),this.coefficients[l]);return i}add(a){if(!this.field.equals(a.field))throw new _("ModulusPolys do not have same ModulusGF field");if(this.isZero())return a;if(a.isZero())return this;let i=this.coefficients,o=a.coefficients;if(i.length>o.length){let u=i;i=o,o=u}let l=new Int32Array(o.length),f=o.length-i.length;C.arraycopy(o,0,l,0,f);for(let u=f;u<o.length;u++)l[u]=this.field.add(i[u-f],o[u]);return new ia(this.field,l)}subtract(a){if(!this.field.equals(a.field))throw new _("ModulusPolys do not have same ModulusGF field");return a.isZero()?this:this.add(a.negative())}multiply(a){return a instanceof ia?this.multiplyOther(a):this.multiplyScalar(a)}multiplyOther(a){if(!this.field.equals(a.field))throw new _("ModulusPolys do not have same ModulusGF field");if(this.isZero()||a.isZero())return new ia(this.field,new Int32Array([0]));let i=this.coefficients,o=i.length,l=a.coefficients,f=l.length,u=new Int32Array(o+f-1);for(let x=0;x<o;x++){let p=i[x];for(let y=0;y<f;y++)u[x+y]=this.field.add(u[x+y],this.field.multiply(p,l[y]))}return new ia(this.field,u)}negative(){let a=this.coefficients.length,i=new Int32Array(a);for(let o=0;o<a;o++)i[o]=this.field.subtract(0,this.coefficients[o]);return new ia(this.field,i)}multiplyScalar(a){if(a===0)return new ia(this.field,new Int32Array([0]));if(a===1)return this;let i=this.coefficients.length,o=new Int32Array(i);for(let l=0;l<i;l++)o[l]=this.field.multiply(this.coefficients[l],a);return new ia(this.field,o)}multiplyByMonomial(a,i){if(a<0)throw new _;if(i===0)return new ia(this.field,new Int32Array([0]));let o=this.coefficients.length,l=new Int32Array(o+a);for(let f=0;f<o;f++)l[f]=this.field.multiply(this.coefficients[f],i);return new ia(this.field,l)}toString(){let a=new be;for(let i=this.getDegree();i>=0;i--){let o=this.getCoefficient(i);o!==0&&(o<0?(a.append(" - "),o=-o):a.length()>0&&a.append(" + "),(i===0||o!==1)&&a.append(o),i!==0&&(i===1?a.append("x"):(a.append("x^"),a.append(i))))}return a.toString()}}class t0{add(a,i){return(a+i)%this.modulus}subtract(a,i){return(this.modulus+a-i)%this.modulus}exp(a){return this.expTable[a]}log(a){if(a===0)throw new _;return this.logTable[a]}inverse(a){if(a===0)throw new A;return this.expTable[this.modulus-this.logTable[a]-1]}multiply(a,i){return a===0||i===0?0:this.expTable[(this.logTable[a]+this.logTable[i])%(this.modulus-1)]}getSize(){return this.modulus}equals(a){return a===this}}class ws extends t0{constructor(a,i){super(),this.modulus=a,this.expTable=new Int32Array(a),this.logTable=new Int32Array(a);let o=1;for(let l=0;l<a;l++)this.expTable[l]=o,o=o*i%a;for(let l=0;l<a-1;l++)this.logTable[this.expTable[l]]=l;this.zero=new ia(this,new Int32Array([0])),this.one=new ia(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(a,i){if(a<0)throw new _;if(i===0)return this.zero;let o=new Int32Array(a+1);return o[0]=i,new ia(this,o)}}ws.PDF417_GF=new ws(Et.NUMBER_OF_CODEWORDS,3);class Kn{constructor(){this.field=ws.PDF417_GF}decode(a,i,o){let l=new ia(this.field,a),f=new Int32Array(i),u=!1;for(let Q=i;Q>0;Q--){let re=l.evaluateAt(this.field.exp(Q));f[i-Q]=re,re!==0&&(u=!0)}if(!u)return 0;let x=this.field.getOne();if(o!=null)for(const Q of o){let re=this.field.exp(a.length-1-Q),de=new ia(this.field,new Int32Array([this.field.subtract(0,re),1]));x=x.multiply(de)}let p=new ia(this.field,f),y=this.runEuclideanAlgorithm(this.field.buildMonomial(i,1),p,i),b=y[0],I=y[1],R=this.findErrorLocations(b),G=this.findErrorMagnitudes(I,b,R);for(let Q=0;Q<R.length;Q++){let re=a.length-1-this.field.log(R[Q]);if(re<0)throw T.getChecksumInstance();a[re]=this.field.subtract(a[re],G[Q])}return R.length}runEuclideanAlgorithm(a,i,o){if(a.getDegree()<i.getDegree()){let R=a;a=i,i=R}let l=a,f=i,u=this.field.getZero(),x=this.field.getOne();for(;f.getDegree()>=Math.round(o/2);){let R=l,G=u;if(l=f,u=x,l.isZero())throw T.getChecksumInstance();f=R;let Q=this.field.getZero(),re=l.getCoefficient(l.getDegree()),de=this.field.inverse(re);for(;f.getDegree()>=l.getDegree()&&!f.isZero();){let Ae=f.getDegree()-l.getDegree(),qe=this.field.multiply(f.getCoefficient(f.getDegree()),de);Q=Q.add(this.field.buildMonomial(Ae,qe)),f=f.subtract(l.multiplyByMonomial(Ae,qe))}x=Q.multiply(u).subtract(G).negative()}let p=x.getCoefficient(0);if(p===0)throw T.getChecksumInstance();let y=this.field.inverse(p),b=x.multiply(y),I=f.multiply(y);return[b,I]}findErrorLocations(a){let i=a.getDegree(),o=new Int32Array(i),l=0;for(let f=1;f<this.field.getSize()&&l<i;f++)a.evaluateAt(f)===0&&(o[l]=this.field.inverse(f),l++);if(l!==i)throw T.getChecksumInstance();return o}findErrorMagnitudes(a,i,o){let l=i.getDegree(),f=new Int32Array(l);for(let y=1;y<=l;y++)f[l-y]=this.field.multiply(y,i.getCoefficient(y));let u=new ia(this.field,f),x=o.length,p=new Int32Array(x);for(let y=0;y<x;y++){let b=this.field.inverse(o[y]),I=this.field.subtract(0,a.evaluateAt(b)),R=this.field.inverse(u.evaluateAt(b));p[y]=this.field.multiply(I,R)}return p}}class On{constructor(a,i,o,l,f){a instanceof On?this.constructor_2(a):this.constructor_1(a,i,o,l,f)}constructor_1(a,i,o,l,f){const u=i==null||o==null,x=l==null||f==null;if(u&&x)throw new ae;u?(i=new st(0,l.getY()),o=new st(0,f.getY())):x&&(l=new st(a.getWidth()-1,i.getY()),f=new st(a.getWidth()-1,o.getY())),this.image=a,this.topLeft=i,this.bottomLeft=o,this.topRight=l,this.bottomRight=f,this.minX=Math.trunc(Math.min(i.getX(),o.getX())),this.maxX=Math.trunc(Math.max(l.getX(),f.getX())),this.minY=Math.trunc(Math.min(i.getY(),l.getY())),this.maxY=Math.trunc(Math.max(o.getY(),f.getY()))}constructor_2(a){this.image=a.image,this.topLeft=a.getTopLeft(),this.bottomLeft=a.getBottomLeft(),this.topRight=a.getTopRight(),this.bottomRight=a.getBottomRight(),this.minX=a.getMinX(),this.maxX=a.getMaxX(),this.minY=a.getMinY(),this.maxY=a.getMaxY()}static merge(a,i){return a==null?i:i==null?a:new On(a.image,a.topLeft,a.bottomLeft,i.topRight,i.bottomRight)}addMissingRows(a,i,o){let l=this.topLeft,f=this.bottomLeft,u=this.topRight,x=this.bottomRight;if(a>0){let p=o?this.topLeft:this.topRight,y=Math.trunc(p.getY()-a);y<0&&(y=0);let b=new st(p.getX(),y);o?l=b:u=b}if(i>0){let p=o?this.bottomLeft:this.bottomRight,y=Math.trunc(p.getY()+i);y>=this.image.getHeight()&&(y=this.image.getHeight()-1);let b=new st(p.getX(),y);o?f=b:x=b}return new On(this.image,l,f,u,x)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class gc{constructor(a,i,o,l){this.columnCount=a,this.errorCorrectionLevel=l,this.rowCountUpperPart=i,this.rowCountLowerPart=o,this.rowCount=i+o}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class qn{constructor(){this.buffer=""}static form(a,i){let o=-1;function l(u,x,p,y,b,I){if(u==="%%")return"%";if(i[++o]===void 0)return;u=y?parseInt(y.substr(1)):void 0;let R=b?parseInt(b.substr(1)):void 0,G;switch(I){case"s":G=i[o];break;case"c":G=i[o][0];break;case"f":G=parseFloat(i[o]).toFixed(u);break;case"p":G=parseFloat(i[o]).toPrecision(u);break;case"e":G=parseFloat(i[o]).toExponential(u);break;case"x":G=parseInt(i[o]).toString(R||16);break;case"d":G=parseFloat(parseInt(i[o],R||10).toPrecision(u)).toFixed(0);break}G=typeof G=="object"?JSON.stringify(G):(+G).toString(R);let Q=parseInt(p),re=p&&p[0]+""=="0"?"0":" ";for(;G.length<Q;)G=x!==void 0?G+re:re+G;return G}let f=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return a.replace(f,l)}format(a,...i){this.buffer+=qn.form(a,i)}toString(){return this.buffer}}class Zn{constructor(a){this.boundingBox=new On(a),this.codewords=new Array(a.getMaxY()-a.getMinY()+1)}getCodewordNearby(a){let i=this.getCodeword(a);if(i!=null)return i;for(let o=1;o<Zn.MAX_NEARBY_DISTANCE;o++){let l=this.imageRowToCodewordIndex(a)-o;if(l>=0&&(i=this.codewords[l],i!=null)||(l=this.imageRowToCodewordIndex(a)+o,l<this.codewords.length&&(i=this.codewords[l],i!=null)))return i}return null}imageRowToCodewordIndex(a){return a-this.boundingBox.getMinY()}setCodeword(a,i){this.codewords[this.imageRowToCodewordIndex(a)]=i}getCodeword(a){return this.codewords[this.imageRowToCodewordIndex(a)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const a=new qn;let i=0;for(const o of this.codewords){if(o==null){a.format("%3d:    |   %n",i++);continue}a.format("%3d: %3d|%3d%n",i++,o.getRowNumber(),o.getValue())}return a.toString()}}Zn.MAX_NEARBY_DISTANCE=5;class yi{constructor(){this.values=new Map}setValue(a){a=Math.trunc(a);let i=this.values.get(a);i==null&&(i=0),i++,this.values.set(a,i)}getValue(){let a=-1,i=new Array;for(const[o,l]of this.values.entries()){const f={getKey:()=>o,getValue:()=>l};f.getValue()>a?(a=f.getValue(),i=[],i.push(f.getKey())):f.getValue()===a&&i.push(f.getKey())}return Et.toIntArray(i)}getConfidence(a){return this.values.get(a)}}class Q0 extends Zn{constructor(a,i){super(a),this._isLeft=i}setRowNumbers(){for(let a of this.getCodewords())a!=null&&a.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(a){let i=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(i,a);let o=this.getBoundingBox(),l=this._isLeft?o.getTopLeft():o.getTopRight(),f=this._isLeft?o.getBottomLeft():o.getBottomRight(),u=this.imageRowToCodewordIndex(Math.trunc(l.getY())),x=this.imageRowToCodewordIndex(Math.trunc(f.getY())),p=-1,y=1,b=0;for(let I=u;I<x;I++){if(i[I]==null)continue;let R=i[I],G=R.getRowNumber()-p;if(G===0)b++;else if(G===1)y=Math.max(y,b),b=1,p=R.getRowNumber();else if(G<0||R.getRowNumber()>=a.getRowCount()||G>I)i[I]=null;else{let Q;y>2?Q=(y-2)*G:Q=G;let re=Q>=I;for(let de=1;de<=Q&&!re;de++)re=i[I-de]!=null;re?i[I]=null:(p=R.getRowNumber(),b=1)}}}getRowHeights(){let a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);let i=new Int32Array(a.getRowCount());for(let o of this.getCodewords())if(o!=null){let l=o.getRowNumber();if(l>=i.length)continue;i[l]++}return i}adjustIncompleteIndicatorColumnRowNumbers(a){let i=this.getBoundingBox(),o=this._isLeft?i.getTopLeft():i.getTopRight(),l=this._isLeft?i.getBottomLeft():i.getBottomRight(),f=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=this.imageRowToCodewordIndex(Math.trunc(l.getY())),x=this.getCodewords(),p=-1;for(let y=f;y<u;y++){if(x[y]==null)continue;let b=x[y];b.setRowNumberAsRowIndicatorColumn();let I=b.getRowNumber()-p;I===0||(I===1?p=b.getRowNumber():b.getRowNumber()>=a.getRowCount()?x[y]=null:p=b.getRowNumber())}}getBarcodeMetadata(){let a=this.getCodewords(),i=new yi,o=new yi,l=new yi,f=new yi;for(let x of a){if(x==null)continue;x.setRowNumberAsRowIndicatorColumn();let p=x.getValue()%30,y=x.getRowNumber();switch(this._isLeft||(y+=2),y%3){case 0:o.setValue(p*3+1);break;case 1:f.setValue(p/3),l.setValue(p%3);break;case 2:i.setValue(p+1);break}}if(i.getValue().length===0||o.getValue().length===0||l.getValue().length===0||f.getValue().length===0||i.getValue()[0]<1||o.getValue()[0]+l.getValue()[0]<Et.MIN_ROWS_IN_BARCODE||o.getValue()[0]+l.getValue()[0]>Et.MAX_ROWS_IN_BARCODE)return null;let u=new gc(i.getValue()[0],o.getValue()[0],l.getValue()[0],f.getValue()[0]);return this.removeIncorrectCodewords(a,u),u}removeIncorrectCodewords(a,i){for(let o=0;o<a.length;o++){let l=a[o];if(a[o]==null)continue;let f=l.getValue()%30,u=l.getRowNumber();if(u>i.getRowCount()){a[o]=null;continue}switch(this._isLeft||(u+=2),u%3){case 0:f*3+1!==i.getRowCountUpperPart()&&(a[o]=null);break;case 1:(Math.trunc(f/3)!==i.getErrorCorrectionLevel()||f%3!==i.getRowCountLowerPart())&&(a[o]=null);break;case 2:f+1!==i.getColumnCount()&&(a[o]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Wi{constructor(a,i){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=a,this.barcodeColumnCount=a.getColumnCount(),this.boundingBox=i,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let a=Et.MAX_CODEWORDS_IN_BARCODE,i;do i=a,a=this.adjustRowNumbersAndGetCount();while(a>0&&a<i);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(a){a!=null&&a.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let a=this.adjustRowNumbersByRow();if(a===0)return 0;for(let i=1;i<this.barcodeColumnCount+1;i++){let o=this.detectionResultColumns[i].getCodewords();for(let l=0;l<o.length;l++)o[l]!=null&&(o[l].hasValidRowNumber()||this.adjustRowNumbers(i,l,o))}return a}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let a=this.detectionResultColumns[0].getCodewords(),i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<a.length;o++)if(a[o]!=null&&i[o]!=null&&a[o].getRowNumber()===i[o].getRowNumber())for(let l=1;l<=this.barcodeColumnCount;l++){let f=this.detectionResultColumns[l].getCodewords()[o];f!=null&&(f.setRowNumber(a[o].getRowNumber()),f.hasValidRowNumber()||(this.detectionResultColumns[l].getCodewords()[o]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let a=0,i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<i.length;o++){if(i[o]==null)continue;let l=i[o].getRowNumber(),f=0;for(let u=this.barcodeColumnCount+1;u>0&&f<this.ADJUST_ROW_NUMBER_SKIP;u--){let x=this.detectionResultColumns[u].getCodewords()[o];x!=null&&(f=Wi.adjustRowNumberIfValid(l,f,x),x.hasValidRowNumber()||a++)}}return a}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let a=0,i=this.detectionResultColumns[0].getCodewords();for(let o=0;o<i.length;o++){if(i[o]==null)continue;let l=i[o].getRowNumber(),f=0;for(let u=1;u<this.barcodeColumnCount+1&&f<this.ADJUST_ROW_NUMBER_SKIP;u++){let x=this.detectionResultColumns[u].getCodewords()[o];x!=null&&(f=Wi.adjustRowNumberIfValid(l,f,x),x.hasValidRowNumber()||a++)}}return a}static adjustRowNumberIfValid(a,i,o){return o==null||o.hasValidRowNumber()||(o.isValidRowNumber(a)?(o.setRowNumber(a),i=0):++i),i}adjustRowNumbers(a,i,o){if(!this.detectionResultColumns[a-1])return;let l=o[i],f=this.detectionResultColumns[a-1].getCodewords(),u=f;this.detectionResultColumns[a+1]!=null&&(u=this.detectionResultColumns[a+1].getCodewords());let x=new Array(14);x[2]=f[i],x[3]=u[i],i>0&&(x[0]=o[i-1],x[4]=f[i-1],x[5]=u[i-1]),i>1&&(x[8]=o[i-2],x[10]=f[i-2],x[11]=u[i-2]),i<o.length-1&&(x[1]=o[i+1],x[6]=f[i+1],x[7]=u[i+1]),i<o.length-2&&(x[9]=o[i+2],x[12]=f[i+2],x[13]=u[i+2]);for(let p of x)if(Wi.adjustRowNumber(l,p))return}static adjustRowNumber(a,i){return i==null?!1:i.hasValidRowNumber()&&i.getBucket()===a.getBucket()?(a.setRowNumber(i.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(a){this.boundingBox=a}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(a,i){this.detectionResultColumns[a]=i}getDetectionResultColumn(a){return this.detectionResultColumns[a]}toString(){let a=this.detectionResultColumns[0];a==null&&(a=this.detectionResultColumns[this.barcodeColumnCount+1]);let i=new qn;for(let o=0;o<a.getCodewords().length;o++){i.format("CW %3d:",o);for(let l=0;l<this.barcodeColumnCount+2;l++){if(this.detectionResultColumns[l]==null){i.format("    |   ");continue}let f=this.detectionResultColumns[l].getCodewords()[o];if(f==null){i.format("    |   ");continue}i.format(" %3d|%3d",f.getRowNumber(),f.getValue())}i.format("%n")}return i.toString()}}class Vi{constructor(a,i,o,l){this.rowNumber=Vi.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(a),this.endX=Math.trunc(i),this.bucket=Math.trunc(o),this.value=Math.trunc(l)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(a){return a!==Vi.BARCODE_ROW_UNKNOWN&&this.bucket===a%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(a){this.rowNumber=a}toString(){return this.rowNumber+"|"+this.value}}Vi.BARCODE_ROW_UNKNOWN=-1;class _a{static initialize(){for(let a=0;a<Et.SYMBOL_TABLE.length;a++){let i=Et.SYMBOL_TABLE[a],o=i&1;for(let l=0;l<Et.BARS_IN_MODULE;l++){let f=0;for(;(i&1)===o;)f+=1,i>>=1;o=i&1,_a.RATIOS_TABLE[a]||(_a.RATIOS_TABLE[a]=new Array(Et.BARS_IN_MODULE)),_a.RATIOS_TABLE[a][Et.BARS_IN_MODULE-l-1]=Math.fround(f/Et.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(a){let i=_a.getDecodedCodewordValue(_a.sampleBitCounts(a));return i!==-1?i:_a.getClosestDecodedValue(a)}static sampleBitCounts(a){let i=vt.sum(a),o=new Int32Array(Et.BARS_IN_MODULE),l=0,f=0;for(let u=0;u<Et.MODULES_IN_CODEWORD;u++){let x=i/(2*Et.MODULES_IN_CODEWORD)+u*i/Et.MODULES_IN_CODEWORD;f+a[l]<=x&&(f+=a[l],l++),o[l]++}return o}static getDecodedCodewordValue(a){let i=_a.getBitValue(a);return Et.getCodeword(i)===-1?-1:i}static getBitValue(a){let i=0;for(let o=0;o<a.length;o++)for(let l=0;l<a[o];l++)i=i<<1|(o%2===0?1:0);return Math.trunc(i)}static getClosestDecodedValue(a){let i=vt.sum(a),o=new Array(Et.BARS_IN_MODULE);if(i>1)for(let u=0;u<o.length;u++)o[u]=Math.fround(a[u]/i);let l=qr.MAX_VALUE,f=-1;this.bSymbolTableReady||_a.initialize();for(let u=0;u<_a.RATIOS_TABLE.length;u++){let x=0,p=_a.RATIOS_TABLE[u];for(let y=0;y<Et.BARS_IN_MODULE;y++){let b=Math.fround(p[y]-o[y]);if(x+=Math.fround(b*b),x>=l)break}x<l&&(l=x,f=Et.SYMBOL_TABLE[u])}return f}}_a.bSymbolTableReady=!1,_a.RATIOS_TABLE=new Array(Et.SYMBOL_TABLE.length).map(k=>new Array(Et.BARS_IN_MODULE));class Jn{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(a){this.segmentIndex=a}getFileId(){return this.fileId}setFileId(a){this.fileId=a}getOptionalData(){return this.optionalData}setOptionalData(a){this.optionalData=a}isLastSegment(){return this.lastSegment}setLastSegment(a){this.lastSegment=a}getSegmentCount(){return this.segmentCount}setSegmentCount(a){this.segmentCount=a}getSender(){return this.sender||null}setSender(a){this.sender=a}getAddressee(){return this.addressee||null}setAddressee(a){this.addressee=a}getFileName(){return this.fileName}setFileName(a){this.fileName=a}getFileSize(){return this.fileSize}setFileSize(a){this.fileSize=a}getChecksum(){return this.checksum}setChecksum(a){this.checksum=a}getTimestamp(){return this.timestamp}setTimestamp(a){this.timestamp=a}}class r0{static parseLong(a,i=void 0){return parseInt(a,i)}}class $0 extends g{}$0.kind="NullPointerException";class eo{writeBytes(a){this.writeBytesOffset(a,0,a.length)}writeBytesOffset(a,i,o){if(a==null)throw new $0;if(i<0||i>a.length||o<0||i+o>a.length||i+o<0)throw new D;if(o===0)return;for(let l=0;l<o;l++)this.write(a[i+l])}flush(){}close(){}}class to extends g{}class ro extends eo{constructor(a=32){if(super(),this.count=0,a<0)throw new _("Negative initial size: "+a);this.buf=new Uint8Array(a)}ensureCapacity(a){a-this.buf.length>0&&this.grow(a)}grow(a){let o=this.buf.length<<1;if(o-a<0&&(o=a),o<0){if(a<0)throw new to;o=O.MAX_VALUE}this.buf=X.copyOfUint8Array(this.buf,o)}write(a){this.ensureCapacity(this.count+1),this.buf[this.count]=a,this.count+=1}writeBytesOffset(a,i,o){if(i<0||i>a.length||o<0||i+o-a.length>0)throw new D;this.ensureCapacity(this.count+o),C.arraycopy(a,i,this.buf,this.count,o),this.count+=o}writeTo(a){a.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return X.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(a){return a?typeof a=="string"?this.toString_string(a):this.toString_number(a):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(a){return new String(this.buf).toString()}toString_number(a){return new String(this.buf).toString()}close(){}}var cr;(function(k){k[k.ALPHA=0]="ALPHA",k[k.LOWER=1]="LOWER",k[k.MIXED=2]="MIXED",k[k.PUNCT=3]="PUNCT",k[k.ALPHA_SHIFT=4]="ALPHA_SHIFT",k[k.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(cr||(cr={}));function ao(){if(typeof window<"u")return window.BigInt||null;if(typeof l0<"u")return l0.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Ei;function Rn(k){if(typeof Ei>"u"&&(Ei=ao()),Ei===null)throw new Error("BigInt is not supported!");return Ei(k)}function vs(){let k=[];k[0]=Rn(1);let a=Rn(900);k[1]=a;for(let i=2;i<16;i++)k[i]=k[i-1]*a;return k}class ye{static decode(a,i){let o=new be(""),l=j.ISO8859_1;o.enableDecoding(l);let f=1,u=a[f++],x=new Jn;for(;f<a[0];){switch(u){case ye.TEXT_COMPACTION_MODE_LATCH:f=ye.textCompaction(a,f,o);break;case ye.BYTE_COMPACTION_MODE_LATCH:case ye.BYTE_COMPACTION_MODE_LATCH_6:f=ye.byteCompaction(u,a,l,f,o);break;case ye.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(a[f++]);break;case ye.NUMERIC_COMPACTION_MODE_LATCH:f=ye.numericCompaction(a,f,o);break;case ye.ECI_CHARSET:j.getCharacterSetECIByValue(a[f++]);break;case ye.ECI_GENERAL_PURPOSE:f+=2;break;case ye.ECI_USER_DEFINED:f++;break;case ye.BEGIN_MACRO_PDF417_CONTROL_BLOCK:f=ye.decodeMacroBlock(a,f,x);break;case ye.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ye.MACRO_PDF417_TERMINATOR:throw new M;default:f--,f=ye.textCompaction(a,f,o);break}if(f<a.length)u=a[f++];else throw M.getFormatInstance()}if(o.length()===0)throw M.getFormatInstance();let p=new Pe(null,o.toString(),null,i);return p.setOther(x),p}static decodeMacroBlock(a,i,o){if(i+ye.NUMBER_OF_SEQUENCE_CODEWORDS>a[0])throw M.getFormatInstance();let l=new Int32Array(ye.NUMBER_OF_SEQUENCE_CODEWORDS);for(let x=0;x<ye.NUMBER_OF_SEQUENCE_CODEWORDS;x++,i++)l[x]=a[i];o.setSegmentIndex(O.parseInt(ye.decodeBase900toBase10(l,ye.NUMBER_OF_SEQUENCE_CODEWORDS)));let f=new be;i=ye.textCompaction(a,i,f),o.setFileId(f.toString());let u=-1;for(a[i]===ye.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(u=i+1);i<a[0];)switch(a[i]){case ye.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(i++,a[i]){case ye.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let x=new be;i=ye.textCompaction(a,i+1,x),o.setFileName(x.toString());break;case ye.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let p=new be;i=ye.textCompaction(a,i+1,p),o.setSender(p.toString());break;case ye.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let y=new be;i=ye.textCompaction(a,i+1,y),o.setAddressee(y.toString());break;case ye.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let b=new be;i=ye.numericCompaction(a,i+1,b),o.setSegmentCount(O.parseInt(b.toString()));break;case ye.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let I=new be;i=ye.numericCompaction(a,i+1,I),o.setTimestamp(r0.parseLong(I.toString()));break;case ye.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let R=new be;i=ye.numericCompaction(a,i+1,R),o.setChecksum(O.parseInt(R.toString()));break;case ye.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let G=new be;i=ye.numericCompaction(a,i+1,G),o.setFileSize(r0.parseLong(G.toString()));break;default:throw M.getFormatInstance()}break;case ye.MACRO_PDF417_TERMINATOR:i++,o.setLastSegment(!0);break;default:throw M.getFormatInstance()}if(u!==-1){let x=i-u;o.isLastSegment()&&x--,o.setOptionalData(X.copyOfRange(a,u,u+x))}return i}static textCompaction(a,i,o){let l=new Int32Array((a[0]-i)*2),f=new Int32Array((a[0]-i)*2),u=0,x=!1;for(;i<a[0]&&!x;){let p=a[i++];if(p<ye.TEXT_COMPACTION_MODE_LATCH)l[u]=p/30,l[u+1]=p%30,u+=2;else switch(p){case ye.TEXT_COMPACTION_MODE_LATCH:l[u++]=ye.TEXT_COMPACTION_MODE_LATCH;break;case ye.BYTE_COMPACTION_MODE_LATCH:case ye.BYTE_COMPACTION_MODE_LATCH_6:case ye.NUMERIC_COMPACTION_MODE_LATCH:case ye.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ye.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ye.MACRO_PDF417_TERMINATOR:i--,x=!0;break;case ye.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l[u]=ye.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,p=a[i++],f[u]=p,u++;break}}return ye.decodeTextCompaction(l,f,u,o),i}static decodeTextCompaction(a,i,o,l){let f=cr.ALPHA,u=cr.ALPHA,x=0;for(;x<o;){let p=a[x],y="";switch(f){case cr.ALPHA:if(p<26)y=String.fromCharCode(65+p);else switch(p){case 26:y=" ";break;case ye.LL:f=cr.LOWER;break;case ye.ML:f=cr.MIXED;break;case ye.PS:u=f,f=cr.PUNCT_SHIFT;break;case ye.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(i[x]);break;case ye.TEXT_COMPACTION_MODE_LATCH:f=cr.ALPHA;break}break;case cr.LOWER:if(p<26)y=String.fromCharCode(97+p);else switch(p){case 26:y=" ";break;case ye.AS:u=f,f=cr.ALPHA_SHIFT;break;case ye.ML:f=cr.MIXED;break;case ye.PS:u=f,f=cr.PUNCT_SHIFT;break;case ye.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(i[x]);break;case ye.TEXT_COMPACTION_MODE_LATCH:f=cr.ALPHA;break}break;case cr.MIXED:if(p<ye.PL)y=ye.MIXED_CHARS[p];else switch(p){case ye.PL:f=cr.PUNCT;break;case 26:y=" ";break;case ye.LL:f=cr.LOWER;break;case ye.AL:f=cr.ALPHA;break;case ye.PS:u=f,f=cr.PUNCT_SHIFT;break;case ye.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(i[x]);break;case ye.TEXT_COMPACTION_MODE_LATCH:f=cr.ALPHA;break}break;case cr.PUNCT:if(p<ye.PAL)y=ye.PUNCT_CHARS[p];else switch(p){case ye.PAL:f=cr.ALPHA;break;case ye.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(i[x]);break;case ye.TEXT_COMPACTION_MODE_LATCH:f=cr.ALPHA;break}break;case cr.ALPHA_SHIFT:if(f=u,p<26)y=String.fromCharCode(65+p);else switch(p){case 26:y=" ";break;case ye.TEXT_COMPACTION_MODE_LATCH:f=cr.ALPHA;break}break;case cr.PUNCT_SHIFT:if(f=u,p<ye.PAL)y=ye.PUNCT_CHARS[p];else switch(p){case ye.PAL:f=cr.ALPHA;break;case ye.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(i[x]);break;case ye.TEXT_COMPACTION_MODE_LATCH:f=cr.ALPHA;break}break}y!==""&&l.append(y),x++}}static byteCompaction(a,i,o,l,f){let u=new ro,x=0,p=0,y=!1;switch(a){case ye.BYTE_COMPACTION_MODE_LATCH:let b=new Int32Array(6),I=i[l++];for(;l<i[0]&&!y;)switch(b[x++]=I,p=900*p+I,I=i[l++],I){case ye.TEXT_COMPACTION_MODE_LATCH:case ye.BYTE_COMPACTION_MODE_LATCH:case ye.NUMERIC_COMPACTION_MODE_LATCH:case ye.BYTE_COMPACTION_MODE_LATCH_6:case ye.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ye.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ye.MACRO_PDF417_TERMINATOR:l--,y=!0;break;default:if(x%5===0&&x>0){for(let R=0;R<6;++R)u.write(Number(Rn(p)>>Rn(8*(5-R))));p=0,x=0}break}l===i[0]&&I<ye.TEXT_COMPACTION_MODE_LATCH&&(b[x++]=I);for(let R=0;R<x;R++)u.write(b[R]);break;case ye.BYTE_COMPACTION_MODE_LATCH_6:for(;l<i[0]&&!y;){let R=i[l++];if(R<ye.TEXT_COMPACTION_MODE_LATCH)x++,p=900*p+R;else switch(R){case ye.TEXT_COMPACTION_MODE_LATCH:case ye.BYTE_COMPACTION_MODE_LATCH:case ye.NUMERIC_COMPACTION_MODE_LATCH:case ye.BYTE_COMPACTION_MODE_LATCH_6:case ye.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ye.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ye.MACRO_PDF417_TERMINATOR:l--,y=!0;break}if(x%5===0&&x>0){for(let G=0;G<6;++G)u.write(Number(Rn(p)>>Rn(8*(5-G))));p=0,x=0}}break}return f.append(he.decode(u.toByteArray(),o)),l}static numericCompaction(a,i,o){let l=0,f=!1,u=new Int32Array(ye.MAX_NUMERIC_CODEWORDS);for(;i<a[0]&&!f;){let x=a[i++];if(i===a[0]&&(f=!0),x<ye.TEXT_COMPACTION_MODE_LATCH)u[l]=x,l++;else switch(x){case ye.TEXT_COMPACTION_MODE_LATCH:case ye.BYTE_COMPACTION_MODE_LATCH:case ye.BYTE_COMPACTION_MODE_LATCH_6:case ye.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ye.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ye.MACRO_PDF417_TERMINATOR:i--,f=!0;break}(l%ye.MAX_NUMERIC_CODEWORDS===0||x===ye.NUMERIC_COMPACTION_MODE_LATCH||f)&&l>0&&(o.append(ye.decodeBase900toBase10(u,l)),l=0)}return i}static decodeBase900toBase10(a,i){let o=Rn(0);for(let f=0;f<i;f++)o+=ye.EXP900[i-f-1]*Rn(a[f]);let l=o.toString();if(l.charAt(0)!=="1")throw new M;return l.substring(1)}}ye.TEXT_COMPACTION_MODE_LATCH=900,ye.BYTE_COMPACTION_MODE_LATCH=901,ye.NUMERIC_COMPACTION_MODE_LATCH=902,ye.BYTE_COMPACTION_MODE_LATCH_6=924,ye.ECI_USER_DEFINED=925,ye.ECI_GENERAL_PURPOSE=926,ye.ECI_CHARSET=927,ye.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,ye.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,ye.MACRO_PDF417_TERMINATOR=922,ye.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,ye.MAX_NUMERIC_CODEWORDS=15,ye.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,ye.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,ye.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,ye.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,ye.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,ye.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,ye.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,ye.PL=25,ye.LL=27,ye.AS=27,ye.ML=28,ye.AL=28,ye.PS=29,ye.PAL=29,ye.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,ye.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",ye.EXP900=ao()?vs():[],ye.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Ut{constructor(){}static decode(a,i,o,l,f,u,x){let p=new On(a,i,o,l,f),y=null,b=null,I;for(let Q=!0;;Q=!1){if(i!=null&&(y=Ut.getRowIndicatorColumn(a,p,i,!0,u,x)),l!=null&&(b=Ut.getRowIndicatorColumn(a,p,l,!1,u,x)),I=Ut.merge(y,b),I==null)throw ae.getNotFoundInstance();let re=I.getBoundingBox();if(Q&&re!=null&&(re.getMinY()<p.getMinY()||re.getMaxY()>p.getMaxY()))p=re;else break}I.setBoundingBox(p);let R=I.getBarcodeColumnCount()+1;I.setDetectionResultColumn(0,y),I.setDetectionResultColumn(R,b);let G=y!=null;for(let Q=1;Q<=R;Q++){let re=G?Q:R-Q;if(I.getDetectionResultColumn(re)!==void 0)continue;let de;re===0||re===R?de=new Q0(p,re===0):de=new Zn(p),I.setDetectionResultColumn(re,de);let Ae=-1,qe=Ae;for(let Je=p.getMinY();Je<=p.getMaxY();Je++){if(Ae=Ut.getStartColumn(I,re,Je,G),Ae<0||Ae>p.getMaxX()){if(qe===-1)continue;Ae=qe}let Ge=Ut.detectCodeword(a,p.getMinX(),p.getMaxX(),G,Ae,Je,u,x);Ge!=null&&(de.setCodeword(Je,Ge),qe=Ae,u=Math.min(u,Ge.getWidth()),x=Math.max(x,Ge.getWidth()))}}return Ut.createDecoderResult(I)}static merge(a,i){if(a==null&&i==null)return null;let o=Ut.getBarcodeMetadata(a,i);if(o==null)return null;let l=On.merge(Ut.adjustBoundingBox(a),Ut.adjustBoundingBox(i));return new Wi(o,l)}static adjustBoundingBox(a){if(a==null)return null;let i=a.getRowHeights();if(i==null)return null;let o=Ut.getMax(i),l=0;for(let x of i)if(l+=o-x,x>0)break;let f=a.getCodewords();for(let x=0;l>0&&f[x]==null;x++)l--;let u=0;for(let x=i.length-1;x>=0&&(u+=o-i[x],!(i[x]>0));x--);for(let x=f.length-1;u>0&&f[x]==null;x--)u--;return a.getBoundingBox().addMissingRows(l,u,a.isLeft())}static getMax(a){let i=-1;for(let o of a)i=Math.max(i,o);return i}static getBarcodeMetadata(a,i){let o;if(a==null||(o=a.getBarcodeMetadata())==null)return i==null?null:i.getBarcodeMetadata();let l;return i==null||(l=i.getBarcodeMetadata())==null?o:o.getColumnCount()!==l.getColumnCount()&&o.getErrorCorrectionLevel()!==l.getErrorCorrectionLevel()&&o.getRowCount()!==l.getRowCount()?null:o}static getRowIndicatorColumn(a,i,o,l,f,u){let x=new Q0(i,l);for(let p=0;p<2;p++){let y=p===0?1:-1,b=Math.trunc(Math.trunc(o.getX()));for(let I=Math.trunc(Math.trunc(o.getY()));I<=i.getMaxY()&&I>=i.getMinY();I+=y){let R=Ut.detectCodeword(a,0,a.getWidth(),l,b,I,f,u);R!=null&&(x.setCodeword(I,R),l?b=R.getStartX():b=R.getEndX())}}return x}static adjustCodewordCount(a,i){let o=i[0][1],l=o.getValue(),f=a.getBarcodeColumnCount()*a.getBarcodeRowCount()-Ut.getNumberOfECCodeWords(a.getBarcodeECLevel());if(l.length===0){if(f<1||f>Et.MAX_CODEWORDS_IN_BARCODE)throw ae.getNotFoundInstance();o.setValue(f)}else l[0]!==f&&o.setValue(f)}static createDecoderResult(a){let i=Ut.createBarcodeMatrix(a);Ut.adjustCodewordCount(a,i);let o=new Array,l=new Int32Array(a.getBarcodeRowCount()*a.getBarcodeColumnCount()),f=[],u=new Array;for(let p=0;p<a.getBarcodeRowCount();p++)for(let y=0;y<a.getBarcodeColumnCount();y++){let b=i[p][y+1].getValue(),I=p*a.getBarcodeColumnCount()+y;b.length===0?o.push(I):b.length===1?l[I]=b[0]:(u.push(I),f.push(b))}let x=new Array(f.length);for(let p=0;p<x.length;p++)x[p]=f[p];return Ut.createDecoderResultFromAmbiguousValues(a.getBarcodeECLevel(),l,Et.toIntArray(o),Et.toIntArray(u),x)}static createDecoderResultFromAmbiguousValues(a,i,o,l,f){let u=new Int32Array(l.length),x=100;for(;x-- >0;){for(let p=0;p<u.length;p++)i[l[p]]=f[p][u[p]];try{return Ut.decodeCodewords(i,a,o)}catch(p){if(!(p instanceof T))throw p}if(u.length===0)throw T.getChecksumInstance();for(let p=0;p<u.length;p++)if(u[p]<f[p].length-1){u[p]++;break}else if(u[p]=0,p===u.length-1)throw T.getChecksumInstance()}throw T.getChecksumInstance()}static createBarcodeMatrix(a){let i=Array.from({length:a.getBarcodeRowCount()},()=>new Array(a.getBarcodeColumnCount()+2));for(let l=0;l<i.length;l++)for(let f=0;f<i[l].length;f++)i[l][f]=new yi;let o=0;for(let l of a.getDetectionResultColumns()){if(l!=null){for(let f of l.getCodewords())if(f!=null){let u=f.getRowNumber();if(u>=0){if(u>=i.length)continue;i[u][o].setValue(f.getValue())}}}o++}return i}static isValidBarcodeColumn(a,i){return i>=0&&i<=a.getBarcodeColumnCount()+1}static getStartColumn(a,i,o,l){let f=l?1:-1,u=null;if(Ut.isValidBarcodeColumn(a,i-f)&&(u=a.getDetectionResultColumn(i-f).getCodeword(o)),u!=null)return l?u.getEndX():u.getStartX();if(u=a.getDetectionResultColumn(i).getCodewordNearby(o),u!=null)return l?u.getStartX():u.getEndX();if(Ut.isValidBarcodeColumn(a,i-f)&&(u=a.getDetectionResultColumn(i-f).getCodewordNearby(o)),u!=null)return l?u.getEndX():u.getStartX();let x=0;for(;Ut.isValidBarcodeColumn(a,i-f);){i-=f;for(let p of a.getDetectionResultColumn(i).getCodewords())if(p!=null)return(l?p.getEndX():p.getStartX())+f*x*(p.getEndX()-p.getStartX());x++}return l?a.getBoundingBox().getMinX():a.getBoundingBox().getMaxX()}static detectCodeword(a,i,o,l,f,u,x,p){f=Ut.adjustCodewordStartColumn(a,i,o,l,f,u);let y=Ut.getModuleBitCount(a,i,o,l,f,u);if(y==null)return null;let b,I=vt.sum(y);if(l)b=f+I;else{for(let Q=0;Q<y.length/2;Q++){let re=y[Q];y[Q]=y[y.length-1-Q],y[y.length-1-Q]=re}b=f,f=b-I}if(!Ut.checkCodewordSkew(I,x,p))return null;let R=_a.getDecodedValue(y),G=Et.getCodeword(R);return G===-1?null:new Vi(f,b,Ut.getCodewordBucketNumber(R),G)}static getModuleBitCount(a,i,o,l,f,u){let x=f,p=new Int32Array(8),y=0,b=l?1:-1,I=l;for(;(l?x<o:x>=i)&&y<p.length;)a.get(x,u)===I?(p[y]++,x+=b):(y++,I=!I);return y===p.length||x===(l?o:i)&&y===p.length-1?p:null}static getNumberOfECCodeWords(a){return 2<<a}static adjustCodewordStartColumn(a,i,o,l,f,u){let x=f,p=l?-1:1;for(let y=0;y<2;y++){for(;(l?x>=i:x<o)&&l===a.get(x,u);){if(Math.abs(f-x)>Ut.CODEWORD_SKEW_SIZE)return f;x+=p}p=-p,l=!l}return x}static checkCodewordSkew(a,i,o){return i-Ut.CODEWORD_SKEW_SIZE<=a&&a<=o+Ut.CODEWORD_SKEW_SIZE}static decodeCodewords(a,i,o){if(a.length===0)throw M.getFormatInstance();let l=1<<i+1,f=Ut.correctErrors(a,o,l);Ut.verifyCodewordCount(a,l);let u=ye.decode(a,""+i);return u.setErrorsCorrected(f),u.setErasures(o.length),u}static correctErrors(a,i,o){if(i!=null&&i.length>o/2+Ut.MAX_ERRORS||o<0||o>Ut.MAX_EC_CODEWORDS)throw T.getChecksumInstance();return Ut.errorCorrection.decode(a,o,i)}static verifyCodewordCount(a,i){if(a.length<4)throw M.getFormatInstance();let o=a[0];if(o>a.length)throw M.getFormatInstance();if(o===0)if(i<a.length)a[0]=a.length-i;else throw M.getFormatInstance()}static getBitCountForCodeword(a){let i=new Int32Array(8),o=0,l=i.length-1;for(;!((a&1)!==o&&(o=a&1,l--,l<0));)i[l]++,a>>=1;return i}static getCodewordBucketNumber(a){return a instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(a):this.getCodewordBucketNumber_number(a)}static getCodewordBucketNumber_number(a){return Ut.getCodewordBucketNumber(Ut.getBitCountForCodeword(a))}static getCodewordBucketNumber_Int32Array(a){return(a[0]-a[2]+a[4]-a[6]+9)%9}static toString(a){let i=new qn;for(let o=0;o<a.length;o++){i.format("Row %2d: ",o);for(let l=0;l<a[o].length;l++){let f=a[o][l];f.getValue().length===0?i.format("        ",null):i.format("%4d(%2d)",f.getValue()[0],f.getConfidence(f.getValue()[0]))}i.format("%n")}return i.toString()}}Ut.CODEWORD_SKEW_SIZE=2,Ut.MAX_ERRORS=3,Ut.MAX_EC_CODEWORDS=512,Ut.errorCorrection=new Kn;class Dr{decode(a,i=null){let o=Dr.decode(a,i,!1);if(o==null||o.length===0||o[0]==null)throw ae.getNotFoundInstance();return o[0]}decodeMultiple(a,i=null){try{return Dr.decode(a,i,!0)}catch(o){throw o instanceof M||o instanceof T?ae.getNotFoundInstance():o}}static decode(a,i,o){const l=new Array,f=Pt.detectMultiple(a,i,o);for(const u of f.getPoints()){const x=Ut.decode(f.getBits(),u[4],u[5],u[6],u[7],Dr.getMinCodewordWidth(u),Dr.getMaxCodewordWidth(u)),p=new ee(x.getText(),x.getRawBytes(),void 0,u,le.PDF_417);p.putMetadata(Le.ERROR_CORRECTION_LEVEL,x.getECLevel());const y=x.getOther();y!=null&&p.putMetadata(Le.PDF417_EXTRA_METADATA,y),l.push(p)}return l.map(u=>u)}static getMaxWidth(a,i){return a==null||i==null?0:Math.trunc(Math.abs(a.getX()-i.getX()))}static getMinWidth(a,i){return a==null||i==null?O.MAX_VALUE:Math.trunc(Math.abs(a.getX()-i.getX()))}static getMaxCodewordWidth(a){return Math.floor(Math.max(Math.max(Dr.getMaxWidth(a[0],a[4]),Dr.getMaxWidth(a[6],a[2])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN),Math.max(Dr.getMaxWidth(a[1],a[5]),Dr.getMaxWidth(a[7],a[3])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(a){return Math.floor(Math.min(Math.min(Dr.getMinWidth(a[0],a[4]),Dr.getMinWidth(a[6],a[2])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN),Math.min(Dr.getMinWidth(a[1],a[5]),Dr.getMinWidth(a[7],a[3])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN)))}reset(){}}class ys extends g{}ys.kind="ReaderException";class Hi{constructor(a,i){this.verbose=a===!0,i&&this.setHints(i)}decode(a,i){return i&&this.setHints(i),this.decodeInternal(a)}decodeWithState(a){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(a)}setHints(a){this.hints=a;const i=!n(a)&&a.get(J.TRY_HARDER)===!0,o=n(a)?null:a.get(J.POSSIBLE_FORMATS),l=new Array;if(!n(o)){const f=o.some(u=>u===le.UPC_A||u===le.UPC_E||u===le.EAN_13||u===le.EAN_8||u===le.CODABAR||u===le.CODE_39||u===le.CODE_93||u===le.CODE_128||u===le.ITF||u===le.RSS_14||u===le.RSS_EXPANDED);f&&!i&&l.push(new Jr(a,this.verbose)),o.includes(le.QR_CODE)&&l.push(new Fn),o.includes(le.DATA_MATRIX)&&l.push(new sn),o.includes(le.AZTEC)&&l.push(new fr),o.includes(le.PDF_417)&&l.push(new Dr),f&&i&&l.push(new Jr(a,this.verbose))}l.length===0&&(i||l.push(new Jr(a,this.verbose)),l.push(new Fn),l.push(new sn),l.push(new fr),l.push(new Dr),i&&l.push(new Jr(a,this.verbose))),this.readers=l}reset(){if(this.readers!==null)for(const a of this.readers)a.reset()}decodeInternal(a){if(this.readers===null)throw new ys("No readers where selected, nothing can be read.");for(const i of this.readers)try{return i.decode(a,this.hints)}catch(o){if(o instanceof ys)continue}throw new ae("No MultiFormat Readers were able to detect the code.")}}class Qn extends ce{constructor(a=null,i=500){const o=new Hi;o.setHints(a),super(o,i)}decodeBitmap(a){return this.reader.decodeWithState(a)}}class a0 extends ce{constructor(a=500){super(new Dr,a)}}class mc extends ce{constructor(a=500){super(new Fn,a)}}var Gi;(function(k){k[k.ERROR_CORRECTION=0]="ERROR_CORRECTION",k[k.CHARACTER_SET=1]="CHARACTER_SET",k[k.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",k[k.MIN_SIZE=3]="MIN_SIZE",k[k.MAX_SIZE=4]="MAX_SIZE",k[k.MARGIN=5]="MARGIN",k[k.PDF417_COMPACT=6]="PDF417_COMPACT",k[k.PDF417_COMPACTION=7]="PDF417_COMPACTION",k[k.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",k[k.AZTEC_LAYERS=9]="AZTEC_LAYERS",k[k.QR_VERSION=10]="QR_VERSION"})(Gi||(Gi={}));var Mr=Gi;class n0{constructor(a){this.field=a,this.cachedGenerators=[],this.cachedGenerators.push(new Te(a,Int32Array.from([1])))}buildGenerator(a){const i=this.cachedGenerators;if(a>=i.length){let o=i[i.length-1];const l=this.field;for(let f=i.length;f<=a;f++){const u=o.multiply(new Te(l,Int32Array.from([1,l.exp(f-1+l.getGeneratorBase())])));i.push(u),o=u}}return i[a]}encode(a,i){if(i===0)throw new _("No error correction bytes");const o=a.length-i;if(o<=0)throw new _("No data bytes provided");const l=this.buildGenerator(i),f=new Int32Array(o);C.arraycopy(a,0,f,0,o);let u=new Te(this.field,f);u=u.multiplyByMonomial(i,1);const p=u.divide(l)[1].getCoefficients(),y=i-p.length;for(let b=0;b<y;b++)a[o+b]=0;C.arraycopy(p,0,a,o+y,p.length)}}class _r{constructor(){}static applyMaskPenaltyRule1(a){return _r.applyMaskPenaltyRule1Internal(a,!0)+_r.applyMaskPenaltyRule1Internal(a,!1)}static applyMaskPenaltyRule2(a){let i=0;const o=a.getArray(),l=a.getWidth(),f=a.getHeight();for(let u=0;u<f-1;u++){const x=o[u];for(let p=0;p<l-1;p++){const y=x[p];y===x[p+1]&&y===o[u+1][p]&&y===o[u+1][p+1]&&i++}}return _r.N2*i}static applyMaskPenaltyRule3(a){let i=0;const o=a.getArray(),l=a.getWidth(),f=a.getHeight();for(let u=0;u<f;u++)for(let x=0;x<l;x++){const p=o[u];x+6<l&&p[x]===1&&p[x+1]===0&&p[x+2]===1&&p[x+3]===1&&p[x+4]===1&&p[x+5]===0&&p[x+6]===1&&(_r.isWhiteHorizontal(p,x-4,x)||_r.isWhiteHorizontal(p,x+7,x+11))&&i++,u+6<f&&o[u][x]===1&&o[u+1][x]===0&&o[u+2][x]===1&&o[u+3][x]===1&&o[u+4][x]===1&&o[u+5][x]===0&&o[u+6][x]===1&&(_r.isWhiteVertical(o,x,u-4,u)||_r.isWhiteVertical(o,x,u+7,u+11))&&i++}return i*_r.N3}static isWhiteHorizontal(a,i,o){i=Math.max(i,0),o=Math.min(o,a.length);for(let l=i;l<o;l++)if(a[l]===1)return!1;return!0}static isWhiteVertical(a,i,o,l){o=Math.max(o,0),l=Math.min(l,a.length);for(let f=o;f<l;f++)if(a[f][i]===1)return!1;return!0}static applyMaskPenaltyRule4(a){let i=0;const o=a.getArray(),l=a.getWidth(),f=a.getHeight();for(let p=0;p<f;p++){const y=o[p];for(let b=0;b<l;b++)y[b]===1&&i++}const u=a.getHeight()*a.getWidth();return Math.floor(Math.abs(i*2-u)*10/u)*_r.N4}static getDataMaskBit(a,i,o){let l,f;switch(a){case 0:l=o+i&1;break;case 1:l=o&1;break;case 2:l=i%3;break;case 3:l=(o+i)%3;break;case 4:l=Math.floor(o/2)+Math.floor(i/3)&1;break;case 5:f=o*i,l=(f&1)+f%3;break;case 6:f=o*i,l=(f&1)+f%3&1;break;case 7:f=o*i,l=f%3+(o+i&1)&1;break;default:throw new _("Invalid mask pattern: "+a)}return l===0}static applyMaskPenaltyRule1Internal(a,i){let o=0;const l=i?a.getHeight():a.getWidth(),f=i?a.getWidth():a.getHeight(),u=a.getArray();for(let x=0;x<l;x++){let p=0,y=-1;for(let b=0;b<f;b++){const I=i?u[x][b]:u[b][x];I===y?p++:(p>=5&&(o+=_r.N1+(p-5)),p=1,y=I)}p>=5&&(o+=_r.N1+(p-5))}return o}}_r.N1=3,_r.N2=3,_r.N3=40,_r.N4=10;class _i{constructor(a,i){this.width=a,this.height=i;const o=new Array(i);for(let l=0;l!==i;l++)o[l]=new Uint8Array(a);this.bytes=o}getHeight(){return this.height}getWidth(){return this.width}get(a,i){return this.bytes[i][a]}getArray(){return this.bytes}setNumber(a,i,o){this.bytes[i][a]=o}setBoolean(a,i,o){this.bytes[i][a]=o?1:0}clear(a){for(const i of this.bytes)X.fill(i,a)}equals(a){if(!(a instanceof _i))return!1;const i=a;if(this.width!==i.width||this.height!==i.height)return!1;for(let o=0,l=this.height;o<l;++o){const f=this.bytes[o],u=i.bytes[o];for(let x=0,p=this.width;x<p;++x)if(f[x]!==u[x])return!1}return!0}toString(){const a=new be;for(let i=0,o=this.height;i<o;++i){const l=this.bytes[i];for(let f=0,u=this.width;f<u;++f)switch(l[f]){case 0:a.append(" 0");break;case 1:a.append(" 1");break;default:a.append("  ");break}a.append(`
`)}return a.toString()}}class za{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const a=new be;return a.append(`<<
`),a.append(" mode: "),a.append(this.mode?this.mode.toString():"null"),a.append(`
 ecLevel: `),a.append(this.ecLevel?this.ecLevel.toString():"null"),a.append(`
 version: `),a.append(this.version?this.version.toString():"null"),a.append(`
 maskPattern: `),a.append(this.maskPattern.toString()),this.matrix?(a.append(`
 matrix:
`),a.append(this.matrix.toString())):a.append(`
 matrix: null
`),a.append(`>>
`),a.toString()}setMode(a){this.mode=a}setECLevel(a){this.ecLevel=a}setVersion(a){this.version=a}setMaskPattern(a){this.maskPattern=a}setMatrix(a){this.matrix=a}static isValidMaskPattern(a){return a>=0&&a<za.NUM_MASK_PATTERNS}}za.NUM_MASK_PATTERNS=8;class nr extends g{}nr.kind="WriterException";class wt{constructor(){}static clearMatrix(a){a.clear(255)}static buildMatrix(a,i,o,l,f){wt.clearMatrix(f),wt.embedBasicPatterns(o,f),wt.embedTypeInfo(i,l,f),wt.maybeEmbedVersionInfo(o,f),wt.embedDataBits(a,l,f)}static embedBasicPatterns(a,i){wt.embedPositionDetectionPatternsAndSeparators(i),wt.embedDarkDotAtLeftBottomCorner(i),wt.maybeEmbedPositionAdjustmentPatterns(a,i),wt.embedTimingPatterns(i)}static embedTypeInfo(a,i,o){const l=new q;wt.makeTypeInfoBits(a,i,l);for(let f=0,u=l.getSize();f<u;++f){const x=l.get(l.getSize()-1-f),p=wt.TYPE_INFO_COORDINATES[f],y=p[0],b=p[1];if(o.setBoolean(y,b,x),f<8){const I=o.getWidth()-f-1;o.setBoolean(I,8,x)}else{const R=o.getHeight()-7+(f-8);o.setBoolean(8,R,x)}}}static maybeEmbedVersionInfo(a,i){if(a.getVersionNumber()<7)return;const o=new q;wt.makeVersionInfoBits(a,o);let l=6*3-1;for(let f=0;f<6;++f)for(let u=0;u<3;++u){const x=o.get(l);l--,i.setBoolean(f,i.getHeight()-11+u,x),i.setBoolean(i.getHeight()-11+u,f,x)}}static embedDataBits(a,i,o){let l=0,f=-1,u=o.getWidth()-1,x=o.getHeight()-1;for(;u>0;){for(u===6&&(u-=1);x>=0&&x<o.getHeight();){for(let p=0;p<2;++p){const y=u-p;if(!wt.isEmpty(o.get(y,x)))continue;let b;l<a.getSize()?(b=a.get(l),++l):b=!1,i!==255&&_r.getDataMaskBit(i,y,x)&&(b=!b),o.setBoolean(y,x,b)}x+=f}f=-f,x+=f,u-=2}if(l!==a.getSize())throw new nr("Not all bits consumed: "+l+"/"+a.getSize())}static findMSBSet(a){return 32-O.numberOfLeadingZeros(a)}static calculateBCHCode(a,i){if(i===0)throw new _("0 polynomial");const o=wt.findMSBSet(i);for(a<<=o-1;wt.findMSBSet(a)>=o;)a^=i<<wt.findMSBSet(a)-o;return a}static makeTypeInfoBits(a,i,o){if(!za.isValidMaskPattern(i))throw new nr("Invalid mask pattern");const l=a.getBits()<<3|i;o.appendBits(l,5);const f=wt.calculateBCHCode(l,wt.TYPE_INFO_POLY);o.appendBits(f,10);const u=new q;if(u.appendBits(wt.TYPE_INFO_MASK_PATTERN,15),o.xor(u),o.getSize()!==15)throw new nr("should not happen but we got: "+o.getSize())}static makeVersionInfoBits(a,i){i.appendBits(a.getVersionNumber(),6);const o=wt.calculateBCHCode(a.getVersionNumber(),wt.VERSION_INFO_POLY);if(i.appendBits(o,12),i.getSize()!==18)throw new nr("should not happen but we got: "+i.getSize())}static isEmpty(a){return a===255}static embedTimingPatterns(a){for(let i=8;i<a.getWidth()-8;++i){const o=(i+1)%2;wt.isEmpty(a.get(i,6))&&a.setNumber(i,6,o),wt.isEmpty(a.get(6,i))&&a.setNumber(6,i,o)}}static embedDarkDotAtLeftBottomCorner(a){if(a.get(8,a.getHeight()-8)===0)throw new nr;a.setNumber(8,a.getHeight()-8,1)}static embedHorizontalSeparationPattern(a,i,o){for(let l=0;l<8;++l){if(!wt.isEmpty(o.get(a+l,i)))throw new nr;o.setNumber(a+l,i,0)}}static embedVerticalSeparationPattern(a,i,o){for(let l=0;l<7;++l){if(!wt.isEmpty(o.get(a,i+l)))throw new nr;o.setNumber(a,i+l,0)}}static embedPositionAdjustmentPattern(a,i,o){for(let l=0;l<5;++l){const f=wt.POSITION_ADJUSTMENT_PATTERN[l];for(let u=0;u<5;++u)o.setNumber(a+u,i+l,f[u])}}static embedPositionDetectionPattern(a,i,o){for(let l=0;l<7;++l){const f=wt.POSITION_DETECTION_PATTERN[l];for(let u=0;u<7;++u)o.setNumber(a+u,i+l,f[u])}}static embedPositionDetectionPatternsAndSeparators(a){const i=wt.POSITION_DETECTION_PATTERN[0].length;wt.embedPositionDetectionPattern(0,0,a),wt.embedPositionDetectionPattern(a.getWidth()-i,0,a),wt.embedPositionDetectionPattern(0,a.getWidth()-i,a);const o=8;wt.embedHorizontalSeparationPattern(0,o-1,a),wt.embedHorizontalSeparationPattern(a.getWidth()-o,o-1,a),wt.embedHorizontalSeparationPattern(0,a.getWidth()-o,a);const l=7;wt.embedVerticalSeparationPattern(l,0,a),wt.embedVerticalSeparationPattern(a.getHeight()-l-1,0,a),wt.embedVerticalSeparationPattern(l,a.getHeight()-l,a)}static maybeEmbedPositionAdjustmentPatterns(a,i){if(a.getVersionNumber()<2)return;const o=a.getVersionNumber()-1,l=wt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[o];for(let f=0,u=l.length;f!==u;f++){const x=l[f];if(x>=0)for(let p=0;p!==u;p++){const y=l[p];y>=0&&wt.isEmpty(i.get(y,x))&&wt.embedPositionAdjustmentPattern(y-2,x-2,i)}}}}wt.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),wt.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),wt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),wt.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),wt.VERSION_INFO_POLY=7973,wt.TYPE_INFO_POLY=1335,wt.TYPE_INFO_MASK_PATTERN=21522;class Es{constructor(a,i){this.dataBytes=a,this.errorCorrectionBytes=i}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class $t{constructor(){}static calculateMaskPenalty(a){return _r.applyMaskPenaltyRule1(a)+_r.applyMaskPenaltyRule2(a)+_r.applyMaskPenaltyRule3(a)+_r.applyMaskPenaltyRule4(a)}static encode(a,i,o=null){let l=$t.DEFAULT_BYTE_MODE_ENCODING;const f=o!==null&&o.get(Mr.CHARACTER_SET)!==void 0;f&&(l=o.get(Mr.CHARACTER_SET).toString());const u=this.chooseMode(a,l),x=new q;if(u===xt.BYTE&&(f||$t.DEFAULT_BYTE_MODE_ENCODING!==l)){const Je=j.getCharacterSetECIByName(l);Je!==void 0&&this.appendECI(Je,x)}this.appendModeInfo(u,x);const p=new q;this.appendBytes(a,u,p,l);let y;if(o!==null&&o.get(Mr.QR_VERSION)!==void 0){const Je=Number.parseInt(o.get(Mr.QR_VERSION).toString(),10);y=dt.getVersionForNumber(Je);const Ge=this.calculateBitsNeeded(u,x,p,y);if(!this.willFit(Ge,y,i))throw new nr("Data too big for requested version")}else y=this.recommendVersion(i,u,x,p);const b=new q;b.appendBitArray(x);const I=u===xt.BYTE?p.getSizeInBytes():a.length;this.appendLengthInfo(I,y,u,b),b.appendBitArray(p);const R=y.getECBlocksForLevel(i),G=y.getTotalCodewords()-R.getTotalECCodewords();this.terminateBits(G,b);const Q=this.interleaveWithECBytes(b,y.getTotalCodewords(),G,R.getNumBlocks()),re=new za;re.setECLevel(i),re.setMode(u),re.setVersion(y);const de=y.getDimensionForVersion(),Ae=new _i(de,de),qe=this.chooseMaskPattern(Q,i,y,Ae);return re.setMaskPattern(qe),wt.buildMatrix(Q,i,y,qe,Ae),re.setMatrix(Ae),re}static recommendVersion(a,i,o,l){const f=this.calculateBitsNeeded(i,o,l,dt.getVersionForNumber(1)),u=this.chooseVersion(f,a),x=this.calculateBitsNeeded(i,o,l,u);return this.chooseVersion(x,a)}static calculateBitsNeeded(a,i,o,l){return i.getSize()+a.getCharacterCountBits(l)+o.getSize()}static getAlphanumericCode(a){return a<$t.ALPHANUMERIC_TABLE.length?$t.ALPHANUMERIC_TABLE[a]:-1}static chooseMode(a,i=null){if(j.SJIS.getName()===i&&this.isOnlyDoubleByteKanji(a))return xt.KANJI;let o=!1,l=!1;for(let f=0,u=a.length;f<u;++f){const x=a.charAt(f);if($t.isDigit(x))o=!0;else if(this.getAlphanumericCode(x.charCodeAt(0))!==-1)l=!0;else return xt.BYTE}return l?xt.ALPHANUMERIC:o?xt.NUMERIC:xt.BYTE}static isOnlyDoubleByteKanji(a){let i;try{i=he.encode(a,j.SJIS)}catch{return!1}const o=i.length;if(o%2!==0)return!1;for(let l=0;l<o;l+=2){const f=i[l]&255;if((f<129||f>159)&&(f<224||f>235))return!1}return!0}static chooseMaskPattern(a,i,o,l){let f=Number.MAX_SAFE_INTEGER,u=-1;for(let x=0;x<za.NUM_MASK_PATTERNS;x++){wt.buildMatrix(a,i,o,x,l);let p=this.calculateMaskPenalty(l);p<f&&(f=p,u=x)}return u}static chooseVersion(a,i){for(let o=1;o<=40;o++){const l=dt.getVersionForNumber(o);if($t.willFit(a,l,i))return l}throw new nr("Data too big")}static willFit(a,i,o){const l=i.getTotalCodewords(),u=i.getECBlocksForLevel(o).getTotalECCodewords(),x=l-u,p=(a+7)/8;return x>=p}static terminateBits(a,i){const o=a*8;if(i.getSize()>o)throw new nr("data bits cannot fit in the QR Code"+i.getSize()+" > "+o);for(let u=0;u<4&&i.getSize()<o;++u)i.appendBit(!1);const l=i.getSize()&7;if(l>0)for(let u=l;u<8;u++)i.appendBit(!1);const f=a-i.getSizeInBytes();for(let u=0;u<f;++u)i.appendBits(u&1?17:236,8);if(i.getSize()!==o)throw new nr("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(a,i,o,l,f,u){if(l>=o)throw new nr("Block ID too large");const x=a%o,p=o-x,y=Math.floor(a/o),b=y+1,I=Math.floor(i/o),R=I+1,G=y-I,Q=b-R;if(G!==Q)throw new nr("EC bytes mismatch");if(o!==p+x)throw new nr("RS blocks mismatch");if(a!==(I+G)*p+(R+Q)*x)throw new nr("Total bytes mismatch");l<p?(f[0]=I,u[0]=G):(f[0]=R,u[0]=Q)}static interleaveWithECBytes(a,i,o,l){if(a.getSizeInBytes()!==o)throw new nr("Number of bits and data bytes does not match");let f=0,u=0,x=0;const p=new Array;for(let b=0;b<l;++b){const I=new Int32Array(1),R=new Int32Array(1);$t.getNumDataBytesAndNumECBytesForBlockID(i,o,l,b,I,R);const G=I[0],Q=new Uint8Array(G);a.toBytes(8*f,Q,0,G);const re=$t.generateECBytes(Q,R[0]);p.push(new Es(Q,re)),u=Math.max(u,G),x=Math.max(x,re.length),f+=I[0]}if(o!==f)throw new nr("Data bytes does not match offset");const y=new q;for(let b=0;b<u;++b)for(const I of p){const R=I.getDataBytes();b<R.length&&y.appendBits(R[b],8)}for(let b=0;b<x;++b)for(const I of p){const R=I.getErrorCorrectionBytes();b<R.length&&y.appendBits(R[b],8)}if(i!==y.getSizeInBytes())throw new nr("Interleaving error: "+i+" and "+y.getSizeInBytes()+" differ.");return y}static generateECBytes(a,i){const o=a.length,l=new Int32Array(o+i);for(let u=0;u<o;u++)l[u]=a[u]&255;new n0(Y.QR_CODE_FIELD_256).encode(l,i);const f=new Uint8Array(i);for(let u=0;u<i;u++)f[u]=l[o+u];return f}static appendModeInfo(a,i){i.appendBits(a.getBits(),4)}static appendLengthInfo(a,i,o,l){const f=o.getCharacterCountBits(i);if(a>=1<<f)throw new nr(a+" is bigger than "+((1<<f)-1));l.appendBits(a,f)}static appendBytes(a,i,o,l){switch(i){case xt.NUMERIC:$t.appendNumericBytes(a,o);break;case xt.ALPHANUMERIC:$t.appendAlphanumericBytes(a,o);break;case xt.BYTE:$t.append8BitBytes(a,o,l);break;case xt.KANJI:$t.appendKanjiBytes(a,o);break;default:throw new nr("Invalid mode: "+i)}}static getDigit(a){return a.charCodeAt(0)-48}static isDigit(a){const i=$t.getDigit(a);return i>=0&&i<=9}static appendNumericBytes(a,i){const o=a.length;let l=0;for(;l<o;){const f=$t.getDigit(a.charAt(l));if(l+2<o){const u=$t.getDigit(a.charAt(l+1)),x=$t.getDigit(a.charAt(l+2));i.appendBits(f*100+u*10+x,10),l+=3}else if(l+1<o){const u=$t.getDigit(a.charAt(l+1));i.appendBits(f*10+u,7),l+=2}else i.appendBits(f,4),l++}}static appendAlphanumericBytes(a,i){const o=a.length;let l=0;for(;l<o;){const f=$t.getAlphanumericCode(a.charCodeAt(l));if(f===-1)throw new nr;if(l+1<o){const u=$t.getAlphanumericCode(a.charCodeAt(l+1));if(u===-1)throw new nr;i.appendBits(f*45+u,11),l+=2}else i.appendBits(f,6),l++}}static append8BitBytes(a,i,o){let l;try{l=he.encode(a,o)}catch(f){throw new nr(f)}for(let f=0,u=l.length;f!==u;f++){const x=l[f];i.appendBits(x,8)}}static appendKanjiBytes(a,i){let o;try{o=he.encode(a,j.SJIS)}catch(f){throw new nr(f)}const l=o.length;for(let f=0;f<l;f+=2){const u=o[f]&255,x=o[f+1]&255,p=u<<8&4294967295|x;let y=-1;if(p>=33088&&p<=40956?y=p-33088:p>=57408&&p<=60351&&(y=p-49472),y===-1)throw new nr("Invalid byte sequence");const b=(y>>8)*192+(y&255);i.appendBits(b,13)}}static appendECI(a,i){i.appendBits(xt.ECI.getBits(),4),i.appendBits(a.getValue(),8)}}$t.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),$t.DEFAULT_BYTE_MODE_ENCODING=j.UTF8.getName();class $n{write(a,i,o,l=null){if(a.length===0)throw new _("Found empty contents");if(i<0||o<0)throw new _("Requested dimensions are too small: "+i+"x"+o);let f=ur.L,u=$n.QUIET_ZONE_SIZE;l!==null&&(l.get(Mr.ERROR_CORRECTION)!==void 0&&(f=ur.fromString(l.get(Mr.ERROR_CORRECTION).toString())),l.get(Mr.MARGIN)!==void 0&&(u=Number.parseInt(l.get(Mr.MARGIN).toString(),10)));const x=$t.encode(a,f,l);return this.renderResult(x,i,o,u)}writeToDom(a,i,o,l,f=null){typeof a=="string"&&(a=document.querySelector(a));const u=this.write(i,o,l,f);a&&a.appendChild(u)}renderResult(a,i,o,l){const f=a.getMatrix();if(f===null)throw new lt;const u=f.getWidth(),x=f.getHeight(),p=u+l*2,y=x+l*2,b=Math.max(i,p),I=Math.max(o,y),R=Math.min(Math.floor(b/p),Math.floor(I/y)),G=Math.floor((b-u*R)/2),Q=Math.floor((I-x*R)/2),re=this.createSVGElement(b,I);for(let de=0,Ae=Q;de<x;de++,Ae+=R)for(let qe=0,Je=G;qe<u;qe++,Je+=R)if(f.get(qe,de)===1){const Ge=this.createSvgRectElement(Je,Ae,R,R);re.appendChild(Ge)}return re}createSVGElement(a,i){const o=document.createElementNS($n.SVG_NS,"svg");return o.setAttributeNS(null,"height",a.toString()),o.setAttributeNS(null,"width",i.toString()),o}createSvgRectElement(a,i,o,l){const f=document.createElementNS($n.SVG_NS,"rect");return f.setAttributeNS(null,"x",a.toString()),f.setAttributeNS(null,"y",i.toString()),f.setAttributeNS(null,"height",o.toString()),f.setAttributeNS(null,"width",l.toString()),f.setAttributeNS(null,"fill","#000000"),f}}$n.QUIET_ZONE_SIZE=4,$n.SVG_NS="http://www.w3.org/2000/svg";class ei{encode(a,i,o,l,f){if(a.length===0)throw new _("Found empty contents");if(i!==le.QR_CODE)throw new _("Can only encode QR_CODE, but got "+i);if(o<0||l<0)throw new _(`Requested dimensions are too small: ${o}x${l}`);let u=ur.L,x=ei.QUIET_ZONE_SIZE;f!==null&&(f.get(Mr.ERROR_CORRECTION)!==void 0&&(u=ur.fromString(f.get(Mr.ERROR_CORRECTION).toString())),f.get(Mr.MARGIN)!==void 0&&(x=Number.parseInt(f.get(Mr.MARGIN).toString(),10)));const p=$t.encode(a,u,f);return ei.renderResult(p,o,l,x)}static renderResult(a,i,o,l){const f=a.getMatrix();if(f===null)throw new lt;const u=f.getWidth(),x=f.getHeight(),p=u+l*2,y=x+l*2,b=Math.max(i,p),I=Math.max(o,y),R=Math.min(Math.floor(b/p),Math.floor(I/y)),G=Math.floor((b-u*R)/2),Q=Math.floor((I-x*R)/2),re=new $e(b,I);for(let de=0,Ae=Q;de<x;de++,Ae+=R)for(let qe=0,Je=G;qe<u;qe++,Je+=R)f.get(qe,de)===1&&re.setRegion(Je,Ae,R,R);return re}}ei.QUIET_ZONE_SIZE=4;class _s{encode(a,i,o,l,f){let u;switch(i){case le.QR_CODE:u=new ei;break;default:throw new _("No encoder available for format "+i)}return u.encode(a,i,o,l,f)}}class Ua extends Lt{constructor(a,i,o,l,f,u,x,p){if(super(u,x),this.yuvData=a,this.dataWidth=i,this.dataHeight=o,this.left=l,this.top=f,l+u>i||f+x>o)throw new _("Crop rectangle does not fit within image data.");p&&this.reverseHorizontal(u,x)}getRow(a,i){if(a<0||a>=this.getHeight())throw new _("Requested row is outside the image: "+a);const o=this.getWidth();(i==null||i.length<o)&&(i=new Uint8ClampedArray(o));const l=(a+this.top)*this.dataWidth+this.left;return C.arraycopy(this.yuvData,l,i,0,o),i}getMatrix(){const a=this.getWidth(),i=this.getHeight();if(a===this.dataWidth&&i===this.dataHeight)return this.yuvData;const o=a*i,l=new Uint8ClampedArray(o);let f=this.top*this.dataWidth+this.left;if(a===this.dataWidth)return C.arraycopy(this.yuvData,f,l,0,o),l;for(let u=0;u<i;u++){const x=u*a;C.arraycopy(this.yuvData,f,l,x,a),f+=this.dataWidth}return l}isCropSupported(){return!0}crop(a,i,o,l){return new Ua(this.yuvData,this.dataWidth,this.dataHeight,this.left+a,this.top+i,o,l,!1)}renderThumbnail(){const a=this.getWidth()/Ua.THUMBNAIL_SCALE_FACTOR,i=this.getHeight()/Ua.THUMBNAIL_SCALE_FACTOR,o=new Int32Array(a*i),l=this.yuvData;let f=this.top*this.dataWidth+this.left;for(let u=0;u<i;u++){const x=u*a;for(let p=0;p<a;p++){const y=l[f+p*Ua.THUMBNAIL_SCALE_FACTOR]&255;o[x+p]=4278190080|y*65793}f+=this.dataWidth*Ua.THUMBNAIL_SCALE_FACTOR}return o}getThumbnailWidth(){return this.getWidth()/Ua.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Ua.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(a,i){const o=this.yuvData;for(let l=0,f=this.top*this.dataWidth+this.left;l<i;l++,f+=this.dataWidth){const u=f+a/2;for(let x=f,p=f+a-1;x<u;x++,p--){const y=o[x];o[x]=o[p],o[p]=y}}}invert(){return new fe(this)}}Ua.THUMBNAIL_SCALE_FACTOR=2;class As extends Lt{constructor(a,i,o,l,f,u,x){if(super(i,o),this.dataWidth=l,this.dataHeight=f,this.left=u,this.top=x,a.BYTES_PER_ELEMENT===4){const p=i*o,y=new Uint8ClampedArray(p);for(let b=0;b<p;b++){const I=a[b],R=I>>16&255,G=I>>7&510,Q=I&255;y[b]=(R+G+Q)/4&255}this.luminances=y}else this.luminances=a;if(l===void 0&&(this.dataWidth=i),f===void 0&&(this.dataHeight=o),u===void 0&&(this.left=0),x===void 0&&(this.top=0),this.left+i>this.dataWidth||this.top+o>this.dataHeight)throw new _("Crop rectangle does not fit within image data.")}getRow(a,i){if(a<0||a>=this.getHeight())throw new _("Requested row is outside the image: "+a);const o=this.getWidth();(i==null||i.length<o)&&(i=new Uint8ClampedArray(o));const l=(a+this.top)*this.dataWidth+this.left;return C.arraycopy(this.luminances,l,i,0,o),i}getMatrix(){const a=this.getWidth(),i=this.getHeight();if(a===this.dataWidth&&i===this.dataHeight)return this.luminances;const o=a*i,l=new Uint8ClampedArray(o);let f=this.top*this.dataWidth+this.left;if(a===this.dataWidth)return C.arraycopy(this.luminances,f,l,0,o),l;for(let u=0;u<i;u++){const x=u*a;C.arraycopy(this.luminances,f,l,x,a),f+=this.dataWidth}return l}isCropSupported(){return!0}crop(a,i,o,l){return new As(this.luminances,o,l,this.dataWidth,this.dataHeight,this.left+a,this.top+i)}invert(){return new fe(this)}}class no extends j{static forName(a){return this.getCharacterSetECIByName(a)}}class Ya{}Ya.ISO_8859_1=j.ISO8859_1;class yn{isCompact(){return this.compact}setCompact(a){this.compact=a}getSize(){return this.size}setSize(a){this.size=a}getLayers(){return this.layers}setLayers(a){this.layers=a}getCodeWords(){return this.codeWords}setCodeWords(a){this.codeWords=a}getMatrix(){return this.matrix}setMatrix(a){this.matrix=a}}class bs{static singletonList(a){return[a]}static min(a,i){return a.sort(i)[0]}}class Xi{constructor(a){this.previous=a}getPrevious(){return this.previous}}class ti extends Xi{constructor(a,i,o){super(a),this.value=i,this.bitCount=o}appendTo(a,i){a.appendBits(this.value,this.bitCount)}add(a,i){return new ti(this,a,i)}addBinaryShift(a,i){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new ti(this,a,i)}toString(){let a=this.value&(1<<this.bitCount)-1;return a|=1<<this.bitCount,"<"+O.toBinaryString(a|1<<this.bitCount).substring(1)+">"}}class i0 extends ti{constructor(a,i,o){super(a,0,0),this.binaryShiftStart=i,this.binaryShiftByteCount=o}appendTo(a,i){for(let o=0;o<this.binaryShiftByteCount;o++)(o===0||o===31&&this.binaryShiftByteCount<=62)&&(a.appendBits(31,5),this.binaryShiftByteCount>62?a.appendBits(this.binaryShiftByteCount-31,16):o===0?a.appendBits(Math.min(this.binaryShiftByteCount,31),5):a.appendBits(this.binaryShiftByteCount-31,5)),a.appendBits(i[this.binaryShiftStart+o],8)}addBinaryShift(a,i){return new i0(this,a,i)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function ri(k,a,i){return new i0(k,a,i)}function Mn(k,a,i){return new ti(k,a,i)}const zi=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Pn=0,Yi=1,Oa=2,s0=3,on=4,pc=new ti(null,0,0),o0=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Cs(k){for(let a of k)X.fill(a,-1);return k[Pn][on]=0,k[Yi][on]=0,k[Yi][Pn]=28,k[s0][on]=0,k[Oa][on]=0,k[Oa][Pn]=15,k}const io=Cs(X.createInt32Array(6,6));class cn{constructor(a,i,o,l){this.token=a,this.mode=i,this.binaryShiftByteCount=o,this.bitCount=l}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(a,i){let o=this.bitCount,l=this.token;if(a!==this.mode){let u=o0[this.mode][a];l=Mn(l,u&65535,u>>16),o+=u>>16}let f=a===Oa?4:5;return l=Mn(l,i,f),new cn(l,a,0,o+f)}shiftAndAppend(a,i){let o=this.token,l=this.mode===Oa?4:5;return o=Mn(o,io[this.mode][a],l),o=Mn(o,i,5),new cn(o,this.mode,0,this.bitCount+l+5)}addBinaryShiftChar(a){let i=this.token,o=this.mode,l=this.bitCount;if(this.mode===on||this.mode===Oa){let x=o0[o][Pn];i=Mn(i,x&65535,x>>16),l+=x>>16,o=Pn}let f=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,u=new cn(i,o,this.binaryShiftByteCount+1,l+f);return u.binaryShiftByteCount===2078&&(u=u.endBinaryShift(a+1)),u}endBinaryShift(a){if(this.binaryShiftByteCount===0)return this;let i=this.token;return i=ri(i,a-this.binaryShiftByteCount,this.binaryShiftByteCount),new cn(i,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(a){let i=this.bitCount+(o0[this.mode][a.mode]>>16);return this.binaryShiftByteCount<a.binaryShiftByteCount?i+=cn.calculateBinaryShiftCost(a)-cn.calculateBinaryShiftCost(this):this.binaryShiftByteCount>a.binaryShiftByteCount&&a.binaryShiftByteCount>0&&(i+=10),i<=a.bitCount}toBitArray(a){let i=[];for(let l=this.endBinaryShift(a.length).token;l!==null;l=l.getPrevious())i.unshift(l);let o=new q;for(const l of i)l.appendTo(o,a);return o}toString(){return te.format("%s bits=%d bytes=%d",zi[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(a){return a.binaryShiftByteCount>62?21:a.binaryShiftByteCount>31?20:a.binaryShiftByteCount>0?10:0}}cn.INITIAL_STATE=new cn(pc,Pn,0,0);function so(k){const a=te.getCharCode(" "),i=te.getCharCode("."),o=te.getCharCode(",");k[Pn][a]=1;const l=te.getCharCode("Z"),f=te.getCharCode("A");for(let R=f;R<=l;R++)k[Pn][R]=R-f+2;k[Yi][a]=1;const u=te.getCharCode("z"),x=te.getCharCode("a");for(let R=x;R<=u;R++)k[Yi][R]=R-x+2;k[Oa][a]=1;const p=te.getCharCode("9"),y=te.getCharCode("0");for(let R=y;R<=p;R++)k[Oa][R]=R-y+2;k[Oa][o]=12,k[Oa][i]=13;const b=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let R=0;R<b.length;R++)k[s0][te.getCharCode(b[R])]=R;const I=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let R=0;R<I.length;R++)te.getCharCode(I[R])>0&&(k[on][te.getCharCode(I[R])]=R);return k}const c0=so(X.createInt32Array(5,256));class Ai{constructor(a){this.text=a}encode(){const a=te.getCharCode(" "),i=te.getCharCode(`
`);let o=bs.singletonList(cn.INITIAL_STATE);for(let f=0;f<this.text.length;f++){let u,x=f+1<this.text.length?this.text[f+1]:0;switch(this.text[f]){case te.getCharCode("\r"):u=x===i?2:0;break;case te.getCharCode("."):u=x===a?3:0;break;case te.getCharCode(","):u=x===a?4:0;break;case te.getCharCode(":"):u=x===a?5:0;break;default:u=0}u>0?(o=Ai.updateStateListForPair(o,f,u),f++):o=this.updateStateListForChar(o,f)}return bs.min(o,(f,u)=>f.getBitCount()-u.getBitCount()).toBitArray(this.text)}updateStateListForChar(a,i){const o=[];for(let l of a)this.updateStateForChar(l,i,o);return Ai.simplifyStates(o)}updateStateForChar(a,i,o){let l=this.text[i]&255,f=c0[a.getMode()][l]>0,u=null;for(let x=0;x<=on;x++){let p=c0[x][l];if(p>0){if(u==null&&(u=a.endBinaryShift(i)),!f||x===a.getMode()||x===Oa){const y=u.latchAndAppend(x,p);o.push(y)}if(!f&&io[a.getMode()][x]>=0){const y=u.shiftAndAppend(x,p);o.push(y)}}}if(a.getBinaryShiftByteCount()>0||c0[a.getMode()][l]===0){let x=a.addBinaryShiftChar(i);o.push(x)}}static updateStateListForPair(a,i,o){const l=[];for(let f of a)this.updateStateForPair(f,i,o,l);return this.simplifyStates(l)}static updateStateForPair(a,i,o,l){let f=a.endBinaryShift(i);if(l.push(f.latchAndAppend(on,o)),a.getMode()!==on&&l.push(f.shiftAndAppend(on,o)),o===3||o===4){let u=f.latchAndAppend(Oa,16-o).latchAndAppend(Oa,1);l.push(u)}if(a.getBinaryShiftByteCount()>0){let u=a.addBinaryShiftChar(i).addBinaryShiftChar(i+1);l.push(u)}}static simplifyStates(a){let i=[];for(const o of a){let l=!0;for(const f of i){if(f.isBetterThanOrEqualTo(o)){l=!1;break}o.isBetterThanOrEqualTo(f)&&(i=i.filter(u=>u!==f))}l&&i.push(o)}return i}}class Jt{constructor(){}static encodeBytes(a){return Jt.encode(a,Jt.DEFAULT_EC_PERCENT,Jt.DEFAULT_AZTEC_LAYERS)}static encode(a,i,o){let l=new Ai(a).encode(),f=O.truncDivision(l.getSize()*i,100)+11,u=l.getSize()+f,x,p,y,b,I;if(o!==Jt.DEFAULT_AZTEC_LAYERS){if(x=o<0,p=Math.abs(o),p>(x?Jt.MAX_NB_BITS_COMPACT:Jt.MAX_NB_BITS))throw new _(te.format("Illegal value %s for layers",o));y=Jt.totalBitsInLayer(p,x),b=Jt.WORD_SIZE[p];let Ge=y-y%b;if(I=Jt.stuffBits(l,b),I.getSize()+f>Ge)throw new _("Data to large for user specified layer");if(x&&I.getSize()>b*64)throw new _("Data to large for user specified layer")}else{b=0,I=null;for(let Ge=0;;Ge++){if(Ge>Jt.MAX_NB_BITS)throw new _("Data too large for an Aztec code");if(x=Ge<=3,p=x?Ge+1:Ge,y=Jt.totalBitsInLayer(p,x),u>y)continue;(I==null||b!==Jt.WORD_SIZE[p])&&(b=Jt.WORD_SIZE[p],I=Jt.stuffBits(l,b));let Gt=y-y%b;if(!(x&&I.getSize()>b*64)&&I.getSize()+f<=Gt)break}}let R=Jt.generateCheckWords(I,y,b),G=I.getSize()/b,Q=Jt.generateModeMessage(x,p,G),re=(x?11:14)+p*4,de=new Int32Array(re),Ae;if(x){Ae=re;for(let Ge=0;Ge<de.length;Ge++)de[Ge]=Ge}else{Ae=re+1+2*O.truncDivision(O.truncDivision(re,2)-1,15);let Ge=O.truncDivision(re,2),Gt=O.truncDivision(Ae,2);for(let Dt=0;Dt<Ge;Dt++){let la=Dt+O.truncDivision(Dt,15);de[Ge-Dt-1]=Gt-la-1,de[Ge+Dt]=Gt+la+1}}let qe=new $e(Ae);for(let Ge=0,Gt=0;Ge<p;Ge++){let Dt=(p-Ge)*4+(x?9:12);for(let la=0;la<Dt;la++){let Ra=la*2;for(let fa=0;fa<2;fa++)R.get(Gt+Ra+fa)&&qe.set(de[Ge*2+fa],de[Ge*2+la]),R.get(Gt+Dt*2+Ra+fa)&&qe.set(de[Ge*2+la],de[re-1-Ge*2-fa]),R.get(Gt+Dt*4+Ra+fa)&&qe.set(de[re-1-Ge*2-fa],de[re-1-Ge*2-la]),R.get(Gt+Dt*6+Ra+fa)&&qe.set(de[re-1-Ge*2-la],de[Ge*2+fa])}Gt+=Dt*8}if(Jt.drawModeMessage(qe,x,Ae,Q),x)Jt.drawBullsEye(qe,O.truncDivision(Ae,2),5);else{Jt.drawBullsEye(qe,O.truncDivision(Ae,2),7);for(let Ge=0,Gt=0;Ge<O.truncDivision(re,2)-1;Ge+=15,Gt+=16)for(let Dt=O.truncDivision(Ae,2)&1;Dt<Ae;Dt+=2)qe.set(O.truncDivision(Ae,2)-Gt,Dt),qe.set(O.truncDivision(Ae,2)+Gt,Dt),qe.set(Dt,O.truncDivision(Ae,2)-Gt),qe.set(Dt,O.truncDivision(Ae,2)+Gt)}let Je=new yn;return Je.setCompact(x),Je.setSize(Ae),Je.setLayers(p),Je.setCodeWords(G),Je.setMatrix(qe),Je}static drawBullsEye(a,i,o){for(let l=0;l<o;l+=2)for(let f=i-l;f<=i+l;f++)a.set(f,i-l),a.set(f,i+l),a.set(i-l,f),a.set(i+l,f);a.set(i-o,i-o),a.set(i-o+1,i-o),a.set(i-o,i-o+1),a.set(i+o,i-o),a.set(i+o,i-o+1),a.set(i+o,i+o-1)}static generateModeMessage(a,i,o){let l=new q;return a?(l.appendBits(i-1,2),l.appendBits(o-1,6),l=Jt.generateCheckWords(l,28,4)):(l.appendBits(i-1,5),l.appendBits(o-1,11),l=Jt.generateCheckWords(l,40,4)),l}static drawModeMessage(a,i,o,l){let f=O.truncDivision(o,2);if(i)for(let u=0;u<7;u++){let x=f-3+u;l.get(u)&&a.set(x,f-5),l.get(u+7)&&a.set(f+5,x),l.get(20-u)&&a.set(x,f+5),l.get(27-u)&&a.set(f-5,x)}else for(let u=0;u<10;u++){let x=f-5+u+O.truncDivision(u,5);l.get(u)&&a.set(x,f-7),l.get(u+10)&&a.set(f+7,x),l.get(29-u)&&a.set(x,f+7),l.get(39-u)&&a.set(f-7,x)}}static generateCheckWords(a,i,o){let l=a.getSize()/o,f=new n0(Jt.getGF(o)),u=O.truncDivision(i,o),x=Jt.bitsToWords(a,o,u);f.encode(x,u-l);let p=i%o,y=new q;y.appendBits(0,p);for(const b of Array.from(x))y.appendBits(b,o);return y}static bitsToWords(a,i,o){let l=new Int32Array(o),f,u;for(f=0,u=a.getSize()/i;f<u;f++){let x=0;for(let p=0;p<i;p++)x|=a.get(f*i+p)?1<<i-p-1:0;l[f]=x}return l}static getGF(a){switch(a){case 4:return Y.AZTEC_PARAM;case 6:return Y.AZTEC_DATA_6;case 8:return Y.AZTEC_DATA_8;case 10:return Y.AZTEC_DATA_10;case 12:return Y.AZTEC_DATA_12;default:throw new _("Unsupported word size "+a)}}static stuffBits(a,i){let o=new q,l=a.getSize(),f=(1<<i)-2;for(let u=0;u<l;u+=i){let x=0;for(let p=0;p<i;p++)(u+p>=l||a.get(u+p))&&(x|=1<<i-1-p);(x&f)===f?(o.appendBits(x&f,i),u--):x&f?o.appendBits(x,i):(o.appendBits(x|1,i),u--)}return o}static totalBitsInLayer(a,i){return((i?88:112)+16*a)*a}}Jt.DEFAULT_EC_PERCENT=33,Jt.DEFAULT_AZTEC_LAYERS=0,Jt.MAX_NB_BITS=32,Jt.MAX_NB_BITS_COMPACT=4,Jt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Ss{encode(a,i,o,l){return this.encodeWithHints(a,i,o,l,null)}encodeWithHints(a,i,o,l,f){let u=Ya.ISO_8859_1,x=Jt.DEFAULT_EC_PERCENT,p=Jt.DEFAULT_AZTEC_LAYERS;return f!=null&&(f.has(Mr.CHARACTER_SET)&&(u=no.forName(f.get(Mr.CHARACTER_SET).toString())),f.has(Mr.ERROR_CORRECTION)&&(x=O.parseInt(f.get(Mr.ERROR_CORRECTION).toString())),f.has(Mr.AZTEC_LAYERS)&&(p=O.parseInt(f.get(Mr.AZTEC_LAYERS).toString()))),Ss.encodeLayers(a,i,o,l,u,x,p)}static encodeLayers(a,i,o,l,f,u,x){if(i!==le.AZTEC)throw new _("Can only encode AZTEC, but got "+i);let p=Jt.encode(te.getBytes(a,f),u,x);return Ss.renderResult(p,o,l)}static renderResult(a,i,o){let l=a.getMatrix();if(l==null)throw new lt;let f=l.getWidth(),u=l.getHeight(),x=Math.max(i,f),p=Math.max(o,u),y=Math.min(x/f,p/u),b=(x-f*y)/2,I=(p-u*y)/2,R=new $e(x,p);for(let G=0,Q=I;G<u;G++,Q+=y)for(let re=0,de=b;re<f;re++,de+=y)l.get(re,G)&&R.setRegion(de,Q,y,y);return R}}t.AbstractExpandedDecoder=W,t.ArgumentException=v,t.ArithmeticException=A,t.AztecCode=yn,t.AztecCodeReader=fr,t.AztecCodeWriter=Ss,t.AztecDecoder=ft,t.AztecDetector=Ct,t.AztecDetectorResult=tn,t.AztecEncoder=Jt,t.AztecHighLevelEncoder=Ai,t.AztecPoint=Yt,t.BarcodeFormat=le,t.Binarizer=N,t.BinaryBitmap=S,t.BitArray=q,t.BitMatrix=$e,t.BitSource=Yn,t.BrowserAztecCodeReader=ca,t.BrowserBarcodeReader=Xa,t.BrowserCodeReader=ce,t.BrowserDatamatrixCodeReader=dc,t.BrowserMultiFormatReader=Qn,t.BrowserPDF417Reader=a0,t.BrowserQRCodeReader=mc,t.BrowserQRCodeSvgWriter=$n,t.CharacterSetECI=j,t.ChecksumException=T,t.Code128Reader=Qe,t.Code39Reader=br,t.DataMatrixDecodedBitStreamParser=nn,t.DataMatrixReader=sn,t.DecodeHintType=J,t.DecoderResult=Pe,t.DefaultGridSampler=Xn,t.DetectorResult=wn,t.EAN13Reader=Ga,t.EncodeHintType=Mr,t.Exception=g,t.FormatException=M,t.GenericGF=Y,t.GenericGFPoly=Te,t.GlobalHistogramBinarizer=tt,t.GridSampler=ga,t.GridSamplerInstance=Ar,t.HTMLCanvasElementLuminanceSource=ot,t.HybridBinarizer=Re,t.ITFReader=or,t.IllegalArgumentException=_,t.IllegalStateException=lt,t.InvertedLuminanceSource=fe,t.LuminanceSource=Lt,t.MathUtils=vt,t.MultiFormatOneDReader=Jr,t.MultiFormatReader=Hi,t.MultiFormatWriter=_s,t.NotFoundException=ae,t.OneDReader=Ft,t.PDF417DecodedBitStreamParser=ye,t.PDF417DecoderErrorCorrection=Kn,t.PDF417Reader=Dr,t.PDF417ResultMetadata=Jn,t.PerspectiveTransform=Rr,t.PlanarYUVLuminanceSource=Ua,t.QRCodeByteMatrix=_i,t.QRCodeDataMask=ya,t.QRCodeDecodedBitStreamParser=Er,t.QRCodeDecoderErrorCorrectionLevel=ur,t.QRCodeDecoderFormatInformation=ma,t.QRCodeEncoder=$t,t.QRCodeEncoderQRCode=za,t.QRCodeMaskUtil=_r,t.QRCodeMatrixUtil=wt,t.QRCodeMode=xt,t.QRCodeReader=Fn,t.QRCodeVersion=dt,t.QRCodeWriter=ei,t.RGBLuminanceSource=As,t.RSS14Reader=Mt,t.RSSExpandedReader=Se,t.ReaderException=ys,t.ReedSolomonDecoder=Xe,t.ReedSolomonEncoder=n0,t.ReedSolomonException=ht,t.Result=ee,t.ResultMetadataType=Le,t.ResultPoint=st,t.StringUtils=te,t.UnsupportedOperationException=_e,t.VideoInputDevice=mt,t.WhiteRectangleDetector=kr,t.WriterException=nr,t.ZXingArrays=X,t.ZXingCharset=no,t.ZXingInteger=O,t.ZXingStandardCharsets=Ya,t.ZXingStringBuilder=be,t.ZXingStringEncoding=he,t.ZXingSystem=C,t.createAbstractExpandedDecoder=Ke,Object.defineProperty(t,"__esModule",{value:!0})})})(il,il.exports);var Cr=il.exports;const s8=Xu(Cr),o8=gd({__proto__:null,default:s8},[Cr]);var b1=function(){function e(r,t,n){if(this.formatMap=new Map([[ct.QR_CODE,Cr.BarcodeFormat.QR_CODE],[ct.AZTEC,Cr.BarcodeFormat.AZTEC],[ct.CODABAR,Cr.BarcodeFormat.CODABAR],[ct.CODE_39,Cr.BarcodeFormat.CODE_39],[ct.CODE_93,Cr.BarcodeFormat.CODE_93],[ct.CODE_128,Cr.BarcodeFormat.CODE_128],[ct.DATA_MATRIX,Cr.BarcodeFormat.DATA_MATRIX],[ct.MAXICODE,Cr.BarcodeFormat.MAXICODE],[ct.ITF,Cr.BarcodeFormat.ITF],[ct.EAN_13,Cr.BarcodeFormat.EAN_13],[ct.EAN_8,Cr.BarcodeFormat.EAN_8],[ct.PDF_417,Cr.BarcodeFormat.PDF_417],[ct.RSS_14,Cr.BarcodeFormat.RSS_14],[ct.RSS_EXPANDED,Cr.BarcodeFormat.RSS_EXPANDED],[ct.UPC_A,Cr.BarcodeFormat.UPC_A],[ct.UPC_E,Cr.BarcodeFormat.UPC_E],[ct.UPC_EAN_EXTENSION,Cr.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!o8)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=n;var s=this.createZXingFormats(r),c=new Map;c.set(Cr.DecodeHintType.POSSIBLE_FORMATS,s),c.set(Cr.DecodeHintType.TRY_HARDER,!1),this.hints=c}return e.prototype.decodeAsync=function(r){var t=this;return new Promise(function(n,s){try{n(t.decode(r))}catch(c){s(c)}})},e.prototype.decode=function(r){var t=new Cr.MultiFormatReader(this.verbose,this.hints),n=new Cr.HTMLCanvasElementLuminanceSource(r),s=new Cr.BinaryBitmap(new Cr.HybridBinarizer(n)),c=t.decode(s);return{text:c.text,format:Wu.create(this.toHtml5QrcodeSupportedFormats(c.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(t,n,s){r.set(t,n)}),r},e.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},e.prototype.createZXingFormats=function(r){for(var t=[],n=0,s=r;n<s.length;n++){var c=s[n];this.formatMap.has(c)?t.push(this.formatMap.get(c)):this.logger.logError("".concat(c," is not supported by")+"ZXingHtml5QrcodeShim")}return t},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),c8=function(e,r,t,n){function s(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function d(v){try{g(n.next(v))}catch(_){h(_)}}function m(v){try{g(n.throw(v))}catch(_){h(_)}}function g(v){v.done?c(v.value):s(v.value).then(d,m)}g((n=n.apply(e,r||[])).next())})},l8=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,h;return h={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function d(g){return function(v){return m([g,v])}}function m(g){if(n)throw new TypeError("Generator is already executing.");for(;h&&(h=0,g[0]&&(t=0)),t;)try{if(n=1,s&&(c=g[0]&2?s.return:g[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,g[1])).done)return c;switch(s=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,s=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=r.call(e,t)}catch(v){g=[6,v],s=0}finally{n=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},C1=function(){function e(r,t,n){if(this.formatMap=new Map([[ct.QR_CODE,"qr_code"],[ct.AZTEC,"aztec"],[ct.CODABAR,"codabar"],[ct.CODE_39,"code_39"],[ct.CODE_93,"code_93"],[ct.CODE_128,"code_128"],[ct.DATA_MATRIX,"data_matrix"],[ct.ITF,"itf"],[ct.EAN_13,"ean_13"],[ct.EAN_8,"ean_8"],[ct.PDF_417,"pdf417"],[ct.UPC_A,"upc_a"],[ct.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t,this.logger=n;var s=this.createBarcodeDetectorFormats(r);if(this.detector=new BarcodeDetector(s),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var r=new BarcodeDetector({formats:["qr_code"]});return typeof r<"u"},e.prototype.decodeAsync=function(r){return c8(this,void 0,void 0,function(){var t,n;return l8(this,function(s){switch(s.label){case 0:return[4,this.detector.detect(r)];case 1:if(t=s.sent(),!t||t.length===0)throw"No barcode or QR code detected.";return n=this.selectLargestBarcode(t),[2,{text:n.rawValue,format:Wu.create(this.toHtml5QrcodeSupportedFormats(n.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(r){for(var t=null,n=0,s=0,c=r;s<c.length;s++){var h=c[s],d=h.boundingBox.width*h.boundingBox.height;d>n&&(n=d,t=h)}if(!t)throw"No largest barcode found";return t},e.prototype.createBarcodeDetectorFormats=function(r){for(var t=[],n=0,s=r;n<s.length;n++){var c=s[n];this.formatMap.has(c)?t.push(this.formatMap.get(c)):this.logger.warn("".concat(c," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},e.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},e.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(t,n,s){r.set(t,n)}),r},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),S1=function(e,r,t,n){function s(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function d(v){try{g(n.next(v))}catch(_){h(_)}}function m(v){try{g(n.throw(v))}catch(_){h(_)}}function g(v){v.done?c(v.value):s(v.value).then(d,m)}g((n=n.apply(e,r||[])).next())})},T1=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,h;return h={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function d(g){return function(v){return m([g,v])}}function m(g){if(n)throw new TypeError("Generator is already executing.");for(;h&&(h=0,g[0]&&(t=0)),t;)try{if(n=1,s&&(c=g[0]&2?s.return:g[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,g[1])).done)return c;switch(s=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,s=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=r.call(e,t)}catch(v){g=[6,v],s=0}finally{n=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},f8=function(){function e(r,t,n,s){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=n,t&&C1.isSupported()?(this.primaryDecoder=new C1(r,n,s),this.secondaryDecoder=new b1(r,n,s)):this.primaryDecoder=new b1(r,n,s)}return e.prototype.decodeAsync=function(r){return S1(this,void 0,void 0,function(){var t;return T1(this,function(n){switch(n.label){case 0:t=performance.now(),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(r)];case 2:return[2,n.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(r){return S1(this,void 0,void 0,function(){var t,n;return T1(this,function(s){switch(s.label){case 0:t=performance.now(),s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(r)];case 2:return[2,s.sent()];case 3:if(n=s.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(r)];throw n;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(r){if(this.verbose){var t=performance.now()-r;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var r=0,t=0,n=this.executionResults;t<n.length;t++){var s=n[t];r+=s}var c=r/this.executionResults.length;console.log("".concat(c," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e}(),Yl=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(n[c]=s[c])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),rc=function(e,r,t,n){function s(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function d(v){try{g(n.next(v))}catch(_){h(_)}}function m(v){try{g(n.throw(v))}catch(_){h(_)}}function g(v){v.done?c(v.value):s(v.value).then(d,m)}g((n=n.apply(e,r||[])).next())})},ac=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,h;return h={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function d(g){return function(v){return m([g,v])}}function m(g){if(n)throw new TypeError("Generator is already executing.");for(;h&&(h=0,g[0]&&(t=0)),t;)try{if(n=1,s&&(c=g[0]&2?s.return:g[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,g[1])).done)return c;switch(s=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,s=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=r.call(e,t)}catch(v){g=[6,v],s=0}finally{n=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},Hu=function(){function e(r,t){this.name=r,this.track=t}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(r){var t={};t[this.name]=r;var n={advanced:[t]};return this.track.applyConstraints(n)},e.prototype.value=function(){var r=this.track.getSettings();if(this.name in r){var t=r[this.name];return t}return null},e}(),h8=function(e){Yl(r,e);function r(t,n){return e.call(this,t,n)||this}return r.prototype.min=function(){return this.getCapabilities().min},r.prototype.max=function(){return this.getCapabilities().max},r.prototype.step=function(){return this.getCapabilities().step},r.prototype.apply=function(t){var n={};n[this.name]=t;var s={advanced:[n]};return this.track.applyConstraints(s)},r.prototype.getCapabilities=function(){this.failIfNotSupported();var t=this.track.getCapabilities(),n=t[this.name];return{min:n.min,max:n.max,step:n.step}},r.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},r}(Hu),u8=function(e){Yl(r,e);function r(t){return e.call(this,"zoom",t)||this}return r}(h8),d8=function(e){Yl(r,e);function r(t){return e.call(this,"torch",t)||this}return r}(Hu),x8=function(){function e(r){this.track=r}return e.prototype.zoomFeature=function(){return new u8(this.track)},e.prototype.torchFeature=function(){return new d8(this.track)},e}(),g8=function(){function e(r,t,n){this.isClosed=!1,this.parentElement=r,this.mediaStream=t,this.callbacks=n,this.surface=this.createVideoElement(this.parentElement.clientWidth),r.append(this.surface)}return e.prototype.createVideoElement=function(r){var t=document.createElement("video");return t.style.width="".concat(r,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},e.prototype.setupSurface=function(){var r=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var n=r.surface.clientWidth,s=r.surface.clientHeight;r.callbacks.onRenderSurfaceReady(n,s),r.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(r,t,n,s){return rc(this,void 0,void 0,function(){var c,h;return ac(this,function(d){switch(d.label){case 0:return c=new e(r,t,s),n.aspectRatio?(h={aspectRatio:n.aspectRatio},[4,c.getFirstTrackOrFail().applyConstraints(h)]):[3,2];case 1:d.sent(),d.label=2;case 2:return c.setupSurface(),[2,c]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(r){this.failIfClosed();var t=this,n=function(){setTimeout(r,200),t.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(r){return rc(this,void 0,void 0,function(){return ac(this,function(t){if("aspectRatio"in r)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(r)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var r=this;return new Promise(function(t,n){var s=r.mediaStream.getVideoTracks(),c=s.length,h=0;r.mediaStream.getVideoTracks().forEach(function(d){r.mediaStream.removeTrack(d),d.stop(),++h,h>=c&&(r.isClosed=!0,r.parentElement.removeChild(r.surface),t())})})},e.prototype.getCapabilities=function(){return new x8(this.getFirstTrackOrFail())},e}(),m8=function(){function e(r){this.mediaStream=r}return e.prototype.render=function(r,t,n){return rc(this,void 0,void 0,function(){return ac(this,function(s){return[2,g8.create(r,this.mediaStream,t,n)]})})},e.create=function(r){return rc(this,void 0,void 0,function(){var t,n;return ac(this,function(s){switch(s.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return t={audio:!1,video:r},[4,navigator.mediaDevices.getUserMedia(t)];case 1:return n=s.sent(),[2,new e(n)]}})})},e}(),N1=function(e,r,t,n){function s(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function d(v){try{g(n.next(v))}catch(_){h(_)}}function m(v){try{g(n.throw(v))}catch(_){h(_)}}function g(v){v.done?c(v.value):s(v.value).then(d,m)}g((n=n.apply(e,r||[])).next())})},k1=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,h;return h={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function d(g){return function(v){return m([g,v])}}function m(g){if(n)throw new TypeError("Generator is already executing.");for(;h&&(h=0,g[0]&&(t=0)),t;)try{if(n=1,s&&(c=g[0]&2?s.return:g[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,g[1])).done)return c;switch(s=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,s=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=r.call(e,t)}catch(v){g=[6,v],s=0}finally{n=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},p8=function(){function e(){}return e.failIfNotSupported=function(){return N1(this,void 0,void 0,function(){return k1(this,function(r){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(r){return N1(this,void 0,void 0,function(){return k1(this,function(t){return[2,m8.create(r)]})})},e}(),w8=function(e,r,t,n){function s(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function d(v){try{g(n.next(v))}catch(_){h(_)}}function m(v){try{g(n.throw(v))}catch(_){h(_)}}function g(v){v.done?c(v.value):s(v.value).then(d,m)}g((n=n.apply(e,r||[])).next())})},v8=function(e,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,h;return h={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function d(g){return function(v){return m([g,v])}}function m(g){if(n)throw new TypeError("Generator is already executing.");for(;h&&(h=0,g[0]&&(t=0)),t;)try{if(n=1,s&&(c=g[0]&2?s.return:g[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,g[1])).done)return c;switch(s=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,s=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=r.call(e,t)}catch(v){g=[6,v],s=0}finally{n=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},y8=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var r=MediaStreamTrack;return MediaStreamTrack&&r.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var r=Ls.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(r=Ls.insecureContextCameraQueryError()),Promise.reject(r)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var r=location.host.split(":")[0];return r==="127.0.0.1"||r==="localhost"},e.getCamerasFromMediaDevices=function(){return w8(this,void 0,void 0,function(){var r,t,n,s,c,h,d;return v8(this,function(m){switch(m.label){case 0:return r=function(g){for(var v=g.getVideoTracks(),_=0,S=v;_<S.length;_++){var T=S[_];T.enabled=!1,T.stop(),g.removeTrack(T)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=m.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(n=m.sent(),s=[],c=0,h=n;c<h.length;c++)d=h[c],d.kind==="videoinput"&&s.push({id:d.deviceId,label:d.label});return r(t),[2,s]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(r,t){var n=function(c){for(var h=[],d=0,m=c;d<m.length;d++){var g=m[d];g.kind==="video"&&h.push({id:g.id,label:g.label})}r(h)},s=MediaStreamTrack;s.getSources(n)})},e}(),Ur;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(Ur||(Ur={}));var E8=function(){function e(){this.state=Ur.NOT_STARTED,this.onGoingTransactionNewState=Ur.UNKNOWN}return e.prototype.directTransition=function(r){this.failIfTransitionOngoing(),this.validateTransition(r),this.state=r},e.prototype.startTransition=function(r){return this.failIfTransitionOngoing(),this.validateTransition(r),this.onGoingTransactionNewState=r,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===Ur.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var r=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Ur.UNKNOWN,this.directTransition(r)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===Ur.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Ur.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Ur.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(r){switch(this.state){case Ur.UNKNOWN:throw"Transition from unknown is not allowed";case Ur.NOT_STARTED:this.failIfNewStateIs(r,[Ur.PAUSED]);break;case Ur.SCANNING:break;case Ur.PAUSED:break}},e.prototype.failIfNewStateIs=function(r,t){for(var n=0,s=t;n<s.length;n++){var c=s[n];if(r===c)throw"Cannot transition from ".concat(this.state," to ").concat(r)}},e}(),_8=function(){function e(r){this.stateManager=r}return e.prototype.startTransition=function(r){return this.stateManager.startTransition(r)},e.prototype.directTransition=function(r){this.stateManager.directTransition(r)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===Ur.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==Ur.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Ur.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===Ur.PAUSED},e}(),A8=function(){function e(){}return e.create=function(){return new _8(new E8)},e}(),b8=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(n[c]=s[c])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),qa=function(e){b8(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.DEFAULT_WIDTH=300,r.DEFAULT_WIDTH_OFFSET=2,r.FILE_SCAN_MIN_HEIGHT=300,r.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,r.MIN_QR_BOX_SIZE=50,r.SHADED_LEFT=1,r.SHADED_RIGHT=2,r.SHADED_TOP=3,r.SHADED_BOTTOM=4,r.SHADED_REGION_ELEMENT_ID="qr-shaded-region",r.VERBOSE=!1,r.BORDER_SHADER_DEFAULT_COLOR="#ffffff",r.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",r}(a8),C8=function(){function e(r,t){this.logger=t,this.fps=qa.SCAN_DEFAULT_FPS,r?(r.fps&&(this.fps=r.fps),this.disableFlip=r.disableFlip===!0,this.qrbox=r.qrbox,this.aspectRatio=r.aspectRatio,this.videoConstraints=r.videoConstraints):this.disableFlip=qa.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Vu.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!oi(this.qrbox)},e.create=function(r,t){return new e(r,t)},e}(),Uo=function(){function e(r,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(r))throw"HTML Element with id=".concat(r," not found");this.elementId=r,this.verbose=!1;var n;typeof t=="boolean"?this.verbose=t===!0:t&&(n=t,this.verbose=n.verbose===!0,n.experimentalFeatures),this.logger=new i8(this.verbose),this.qrcode=new f8(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(n),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=A8.create()}return e.prototype.start=function(r,t,n,s){var c=this;if(!r)throw"cameraIdOrConfig is required";if(!n||typeof n!="function")throw"qrCodeSuccessCallback is required and should be a function.";var h;s?h=s:h=this.verbose?this.logger.log:function(){};var d=C8.create(t,this.logger);this.clearElement();var m=!1;d.videoConstraints&&(d.isMediaStreamConstraintsValid()?m=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var g=m,v=document.getElementById(this.elementId);v.clientWidth?v.clientWidth:qa.DEFAULT_WIDTH,v.style.position="relative",this.shouldScan=!0,this.element=v;var _=this,S=this.stateManagerProxy.startTransition(Ur.SCANNING);return new Promise(function(T,N){var C=g?d.videoConstraints:_.createVideoConstraints(r);if(!C){S.cancel(),N("videoConstraints should be defined");return}var D={};(!g||d.aspectRatio)&&(D.aspectRatio=d.aspectRatio);var U={onRenderSurfaceReady:function(X,O){_.setupUi(X,O,d),_.isScanning=!0,_.foreverScan(d,n,h)}};p8.failIfNotSupported().then(function(X){X.create(C).then(function(O){return O.render(c.element,D,U).then(function(q){_.renderedCamera=q,S.execute(),T(null)}).catch(function(q){S.cancel(),N(q)})}).catch(function(O){S.cancel(),N(Ls.errorGettingUserMedia(O))})}).catch(function(X){S.cancel(),N(Ls.cameraStreamingNotSupported())})})},e.prototype.pause=function(r){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Ur.PAUSED),this.showPausedState(),(oi(r)||r!==!0)&&(r=!1),r&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var r=this,t=function(){r.stateManagerProxy.directTransition(Ur.SCANNING),r.hidePausedState()};if(!this.renderedCamera.isPaused()){t();return}this.renderedCamera.resume(function(){t()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var r=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(Ur.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var n=function(){if(r.element){var c=document.getElementById(qa.SHADED_REGION_ELEMENT_ID);c&&r.element.removeChild(c)}},s=this;return this.renderedCamera.close().then(function(){return s.renderedCamera=null,s.element&&(s.element.removeChild(s.canvasElement),s.canvasElement=null),n(),s.qrRegion&&(s.qrRegion=null),s.context&&(s.context=null),t.execute(),s.hidePausedState(),s.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(r,t){return this.scanFileV2(r,t).then(function(n){return n.decodedText})},e.prototype.scanFileV2=function(r,t){var n=this;if(!r||!(r instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(oi(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(s,c){n.possiblyCloseLastScanImageFile(),n.clearElement(),n.lastScanImageFile=URL.createObjectURL(r);var h=new Image;h.onload=function(){var d=h.width,m=h.height,g=document.getElementById(n.elementId),v=g.clientWidth?g.clientWidth:qa.DEFAULT_WIDTH,_=Math.max(g.clientHeight?g.clientHeight:m,qa.FILE_SCAN_MIN_HEIGHT),S=n.computeCanvasDrawConfig(d,m,v,_);if(t){var T=n.createCanvasElement(v,_,"qr-canvas-visible");T.style.display="inline-block",g.appendChild(T);var N=T.getContext("2d");if(!N)throw"Unable to get 2d context from canvas";N.canvas.width=v,N.canvas.height=_,N.drawImage(h,0,0,d,m,S.x,S.y,S.width,S.height)}var C=qa.FILE_SCAN_HIDDEN_CANVAS_PADDING,D=Math.max(h.width,S.width),U=Math.max(h.height,S.height),X=D+2*C,O=U+2*C,q=n.createCanvasElement(X,O);g.appendChild(q);var oe=q.getContext("2d");if(!oe)throw"Unable to get 2d context from canvas";oe.canvas.width=X,oe.canvas.height=O,oe.drawImage(h,0,0,d,m,C,C,D,U);try{n.qrcode.decodeRobustlyAsync(q).then(function(J){s(A1.createFromQrcodeResult(J))}).catch(c)}catch(J){c("QR code parse error, error = ".concat(J))}},h.onerror=c,h.onabort=c,h.onstalled=c,h.onsuspend=c,h.src=URL.createObjectURL(r)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return y8.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(r){if(r){if(!Vu.isMediaStreamConstraintsValid(r,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(r)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(r){var t=[ct.QR_CODE,ct.AZTEC,ct.CODABAR,ct.CODE_39,ct.CODE_93,ct.CODE_128,ct.DATA_MATRIX,ct.MAXICODE,ct.ITF,ct.EAN_13,ct.EAN_8,ct.PDF_417,ct.RSS_14,ct.RSS_EXPANDED,ct.UPC_A,ct.UPC_E,ct.UPC_EAN_EXTENSION];if(!r||typeof r=="boolean"||!r.formatsToSupport)return t;if(!Array.isArray(r.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(r.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var n=[],s=0,c=r.formatsToSupport;s<c.length;s++){var h=c[s];r8(h)?n.push(h):this.logger.warn("Invalid format: ".concat(h," passed in config, ignoring."))}if(n.length===0)throw"None of formatsToSupport match supported values.";return n},e.prototype.getUseBarCodeDetectorIfSupported=function(r){if(oi(r))return!0;if(!oi(r.useBarCodeDetectorIfSupported))return r.useBarCodeDetectorIfSupported!==!1;if(oi(r.experimentalFeatures))return!0;var t=r.experimentalFeatures;return oi(t.useBarCodeDetectorIfSupported)?!0:t.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(r,t,n){var s=this,c=n.qrbox;this.validateQrboxConfig(c);var h=this.toQrdimensions(r,t,c),d=function(g){if(g<qa.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(qa.MIN_QR_BOX_SIZE,"px.")},m=function(g){return g>r&&(s.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),g=r),g};d(h.width),d(h.height),h.width=m(h.width)},e.prototype.validateQrboxConfig=function(r){if(typeof r!="number"&&typeof r!="function"&&(r.width===void 0||r.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(r,t,n){if(typeof n=="number")return{width:n,height:n};if(typeof n=="function")try{return n(r,t)}catch(s){throw new Error("qrbox config was passed as a function but it failed with unknown error"+s)}return n},e.prototype.setupUi=function(r,t,n){n.isShadedBoxEnabled()&&this.validateQrboxSize(r,t,n);var s=oi(n.qrbox)?{width:r,height:t}:n.qrbox;this.validateQrboxConfig(s);var c=this.toQrdimensions(r,t,s);c.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var h=n.isShadedBoxEnabled()&&c.height<=t,d={x:0,y:0,width:r,height:t},m=h?this.getShadedRegionBounds(r,t,c):d,g=this.createCanvasElement(m.width,m.height),v={willReadFrequently:!0},_=g.getContext("2d",v);_.canvas.width=m.width,_.canvas.height=m.height,this.element.append(g),h&&this.possiblyInsertShadingElement(this.element,r,t,c),this.createScannerPausedUiElement(this.element),this.qrRegion=m,this.context=_,this.canvasElement=g},e.prototype.createScannerPausedUiElement=function(r){var t=document.createElement("div");t.innerText=Ls.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",r.appendChild(t),this.scannerPausedUiElement=t},e.prototype.scanContext=function(r,t){var n=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(s){return r(s.text,A1.createFromQrcodeResult(s)),n.possiblyUpdateShaders(!0),!0}).catch(function(s){n.possiblyUpdateShaders(!1);var c=Ls.codeParseError(s);return t(c,n8.createFrom(c)),!1})},e.prototype.foreverScan=function(r,t,n){var s=this;if(this.shouldScan&&this.renderedCamera){var c=this.renderedCamera.getSurface(),h=c.videoWidth/c.clientWidth,d=c.videoHeight/c.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var m=this.qrRegion.width*h,g=this.qrRegion.height*d,v=this.qrRegion.x*h,_=this.qrRegion.y*d;this.context.drawImage(c,v,_,m,g,0,0,this.qrRegion.width,this.qrRegion.height);var S=function(){s.foreverScanTimeout=setTimeout(function(){s.foreverScan(r,t,n)},s.getTimeoutFps(r.fps))};this.scanContext(t,n).then(function(T){!T&&r.disableFlip!==!0?(s.context.translate(s.context.canvas.width,0),s.context.scale(-1,1),s.scanContext(t,n).finally(function(){S()})):S()}).catch(function(T){s.logger.logError("Error happend while scanning context",T),S()})}},e.prototype.createVideoConstraints=function(r){if(typeof r=="string")return{deviceId:{exact:r}};if(typeof r=="object"){var t="facingMode",n="deviceId",s={user:!0,environment:!0},c="exact",h=function(N){if(N in s)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(N,"'")},d=Object.keys(r);if(d.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(d.length," keys");var m=Object.keys(r)[0];if(m!==t&&m!==n)throw"Only '".concat(t,"' and '").concat(n,"' ")+" are supported for 'cameraIdOrConfig'";if(m===t){var g=r.facingMode;if(typeof g=="string"){if(h(g))return{facingMode:g}}else if(typeof g=="object")if(c in g){if(h(g["".concat(c)]))return{facingMode:{exact:g["".concat(c)]}}}else throw"'facingMode' should be string or object with"+" ".concat(c," as key.");else{var v=typeof g;throw"Invalid type of 'facingMode' = ".concat(v)}}else{var _=r.deviceId;if(typeof _=="string")return{deviceId:_};if(typeof _=="object"){if(c in _)return{deviceId:{exact:_["".concat(c)]}};throw"'deviceId' should be string or object with"+" ".concat(c," as key.")}else{var S=typeof _;throw"Invalid type of 'deviceId' = ".concat(S)}}}var T=typeof r;throw"Invalid type of 'cameraIdOrConfig' = ".concat(T)},e.prototype.computeCanvasDrawConfig=function(r,t,n,s){if(r<=n&&t<=s){var c=(n-r)/2,h=(s-t)/2;return{x:c,y:h,width:r,height:t}}else{var d=r,m=t;return r>n&&(t=n/r*t,r=n),t>s&&(r=s/t*r,t=s),this.logger.log("Image downsampled from "+"".concat(d,"X").concat(m)+" to ".concat(r,"X").concat(t,".")),this.computeCanvasDrawConfig(r,t,n,s)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var r=document.getElementById(this.elementId);r&&(r.innerHTML="")},e.prototype.possiblyUpdateShaders=function(r){this.qrMatch!==r&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=r?qa.BORDER_SHADER_MATCH_COLOR:qa.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=r)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(r,t,n){var s=r,c=t,h=document.createElement("canvas");return h.style.width="".concat(s,"px"),h.style.height="".concat(c,"px"),h.style.display="none",h.id=oi(n)?"qr-canvas":n,h},e.prototype.getShadedRegionBounds=function(r,t,n){if(n.width>r||n.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(r-n.width)/2,y:(t-n.height)/2,width:n.width,height:n.height}},e.prototype.possiblyInsertShadingElement=function(r,t,n,s){if(!(t-s.width<1||n-s.height<1)){var c=document.createElement("div");c.style.position="absolute";var h=(t-s.width)/2,d=(n-s.height)/2;if(c.style.borderLeft="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderRight="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderTop="".concat(d,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderBottom="".concat(d,"px solid rgba(0, 0, 0, 0.48)"),c.style.boxSizing="border-box",c.style.top="0px",c.style.bottom="0px",c.style.left="0px",c.style.right="0px",c.id="".concat(qa.SHADED_REGION_ELEMENT_ID),t-s.width<11||n-s.height<11)this.hasBorderShaders=!1;else{var m=5,g=40;this.insertShaderBorders(c,g,m,-m,null,0,!0),this.insertShaderBorders(c,g,m,-m,null,0,!1),this.insertShaderBorders(c,g,m,null,-m,0,!0),this.insertShaderBorders(c,g,m,null,-m,0,!1),this.insertShaderBorders(c,m,g+m,-m,null,-m,!0),this.insertShaderBorders(c,m,g+m,null,-m,-m,!0),this.insertShaderBorders(c,m,g+m,-m,null,-m,!1),this.insertShaderBorders(c,m,g+m,null,-m,-m,!1),this.hasBorderShaders=!0}r.append(c)}},e.prototype.insertShaderBorders=function(r,t,n,s,c,h,d){var m=document.createElement("div");m.style.position="absolute",m.style.backgroundColor=qa.BORDER_SHADER_DEFAULT_COLOR,m.style.width="".concat(t,"px"),m.style.height="".concat(n,"px"),s!==null&&(m.style.top="".concat(s,"px")),c!==null&&(m.style.bottom="".concat(c,"px")),d?m.style.left="".concat(h,"px"):m.style.right="".concat(h,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(m),r.appendChild(m)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(r){return 1e3/r},e}(),I1;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(I1||(I1={}));function iA({isOpen:e,onClose:r,initialBarcode:t}){var ai;const[n,s]=Ue.useState(new Date);Ue.useEffect(()=>{const E=setInterval(()=>{const P=new Date;(P.getDate()!==n.getDate()||P.getMonth()!==n.getMonth())&&s(P)},1e4);return()=>clearInterval(E)},[n]);const c=Ue.useMemo(()=>{const E=n,P=E.getFullYear(),Z=String(E.getMonth()+1).padStart(2,"0"),xe=String(E.getDate()).padStart(2,"0");return`${P}-${Z}-${xe}`},[n]),h=Ue.useMemo(()=>{const E=n,P=E.getFullYear(),Z=String(E.getMonth()+1).padStart(2,"0");return`${P}-${Z}`},[n]),[d,m]=Ue.useState(!1),[g,v]=Ue.useState(!1),[_,S]=Ue.useState(""),[T,N]=Ue.useState(""),C=(E,P)=>{S(E),N(P),v(!0)},[D,U]=Ue.useState(null),[X,O]=Ue.useState(""),[q,oe]=Ue.useState(null),[J,M]=Ue.useState(!1),ie=async E=>{if(!(!(A!=null&&A.uid)||!E)){M(!0),oe(null);try{const P=Kt(ut,"users",A.uid,"dailySales"),Z=ir(P,_t("date","==",E)),xe=await Or(Z);let Ce=0,Fe=0,je=0,Ne=0;xe.forEach(se=>{const Ee=se.data(),ve=Number(Ee.quantity||1);Ce++,Fe+=Number(Ee.sellingPrice||0)*ve,je+=Number(Ee.wholesalePrice||0)*ve,Ne+=Number(Ee.profit||0)}),oe({count:Ce,sales:Fe,cost:je,profit:Ne})}catch(P){console.error(P),Te({title:"خطأ",description:"فشل جلب التقارير",variant:"destructive"})}finally{M(!1)}}},[j,_e]=Ue.useState([]),[he,te]=Ue.useState(""),[be,$e]=Ue.useState(""),ae=async()=>{if(A!=null&&A.uid){if(!he&&!be){Te({title:"تنبيه",description:"يرجى اختيار تاريخ للبحث",variant:"destructive"});return}try{const E=Xe||(Y==null?void 0:Y.shopId)||null,P=ir(Kt(ut,"users",A.uid,"dailySales"),...E?[_t("shopId","==",E)]:[],...he?[_t("date",">=",he)]:[],...be?[_t("date","<=",be)]:[]);let Z=ir(Kt(ut,"dailySales"),_t("userId","==",A.uid),...E?[_t("shopId","==",E)]:[]);he&&(Z=ir(Z,_t("date",">=",he))),be&&(Z=ir(Z,_t("date","<=",be)));let xe=[],Ce=[];try{Ce=(await Or(P)).docs}catch(se){console.warn("Sub-collection query failed",se)}try{xe=(await Or(Z)).docs}catch(se){console.warn("Root collection indexed query failed (likely missing index). Falling back to basic fetch.",se);try{const Ee=ir(Kt(ut,"dailySales"),_t("userId","==",A.uid),...E?[_t("shopId","==",E)]:[],nd("date","desc"),qi(1e3)),ve=ir(Kt(ut,"dailySales"),_t("userId","==",A.uid),...E?[_t("shopId","==",E)]:[],qi(2e3));xe=(await Or(ve)).docs.filter(ke=>{const De=ke.data();return!(he&&De.date<he||be&&De.date>be)})}catch(Ee){console.error("Fallback query also failed",Ee)}}const Fe=[...xe,...Ce];if(Fe.length===0){_e([]),Te({title:"بحث",description:"لم يتم العثور على نتائج"});return}const je=new Map;Fe.forEach(se=>{const Ee=se.data(),ve=Ee.clientId||se.id;je.has(ve)||je.set(ve,{...Ee,firestoreId:se.id})});const Ne=Array.from(je.values()).map(se=>{var Ee,ve;return{id:se.clientId||se.firestoreId,productName:se.productName,price:Number(se.sellingPrice||0),wholesalePrice:Number(se.wholesalePrice||0),quantity:Number(se.quantity||0),date:se.date,time:se.time,serialNumber:se.serialNumber,barcode:se.barcode,performedByType:se.performedByType,performedByName:se.performedByName,performedByUsername:se.performedByUsername,isDeferred:!!se.isDeferred,customerName:se.customerName,customerMobile:se.customerMobile,customerId:se.customerId,firestoreId:se.firestoreId,cartItems:se.cartItems,createdAtMs:(ve=(Ee=se.createdAt)==null?void 0:Ee.toDate)!=null&&ve.call(Ee)?se.createdAt.toDate().getTime():0,transactionReference:se.reference}});Ne.sort((se,Ee)=>se.date!==Ee.date?Ee.date.localeCompare(se.date):(Ee.time||"").localeCompare(se.time||"")),_e(Ne),Te({title:"تم البحث",description:`تم العثور على ${Ne.length} عملية بيع`})}catch(E){console.error("Search error:",E),Te({title:"خطأ",description:"حدث خطأ أثناء البحث",variant:"destructive"})}}},tt=()=>{te(""),$e(""),bs()},[Re,Lt]=Ue.useState(null),[fe,ot]=Ue.useState({productName:"",price:"",wholesalePrice:"",quantity:"",barcode:"",serialNumber:""}),[mt,K]=Ue.useState(!1),[ce,ee]=Ue.useState(null),[ne,le]=Ue.useState(!1),[Ze,Le]=Ue.useState(null),[Pe,Be]=Ue.useState({productName:"",price:"",wholesalePrice:"",quantity:"",barcode:"",serialNumber:""}),{toast:Te}=zu(),{user:A,profile:Y}=Yu(),{isShiftActive:ht,shiftUser:lt}=Ku(),{shopId:Xe}=qu(),[Me,ft]=Ue.useState([]),[vt,qr]=Ue.useState({}),[st,wn]=Ue.useState({}),[tn,kr]=Ue.useState({}),[ga,Rr]=Ue.useState(""),[Xn,Ar]=Ue.useState(!1),[Yt,Ct]=Ue.useState({}),[fr,ca]=Ue.useState(!1),[Ft,Qe]=Ue.useState(""),[br,or]=Ue.useState(""),[yr,In]=Ue.useState(""),[rn,mi]=Ue.useState(!1),[Rt,Ga]=Ue.useState(""),ja=Ki.useRef(null),ji=Object.values(Yt).reduce((E,P)=>E+(Number(P)||0),0),[aa,pi]=Ue.useState(!1),[jr,Dn]=Ue.useState(!1),[na,Zr]=Ue.useState({productName:"",price:"",wholesalePrice:"",quantity:"1",barcode:"",serialNumber:""}),[zn,Fa]=Ue.useState(""),[vn,Gr]=Ue.useState(""),[an,F]=Ue.useState(!1),B=()=>{const P=(Date.now().toString().slice(-9)+Math.floor(Math.random()*1e3).toString().padStart(3,"0")).slice(0,12);ot(Z=>({...Z,barcode:P}))},L=async()=>{window.JsBarcode||await new Promise((E,P)=>{const Z=document.createElement("script");Z.src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js",Z.onload=()=>E(),Z.onerror=()=>P(new Error("Failed to load JsBarcode")),document.head.appendChild(Z)})},W=async E=>{const P=`https://bwipjs-api.metafloor.com/?bcid=code128&text=${encodeURIComponent(E)}&scale=3&height=10&includetext=1`,xe=await(await fetch(P,{cache:"no-store"})).blob();return await new Promise((Ce,Fe)=>{const je=new FileReader;je.onloadend=()=>Ce(je.result||""),je.onerror=Ne=>Fe(Ne),je.readAsDataURL(xe)})};Ue.useEffect(()=>{const E=(fe.barcode||"").trim();if(!E){Gr(""),Fa("");return}F(!0),(async()=>{try{if(await L(),!window.JsBarcode)throw new Error("JsBarcode unavailable");const P=document.createElementNS("http://www.w3.org/2000/svg","svg");window.JsBarcode(P,E,{format:"CODE128",displayValue:!0,fontSize:12,height:70,margin:0});const Z=new XMLSerializer().serializeToString(P),xe="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(Z)));Gr(xe),Fa("")}catch(P){console.warn("JsBarcode failed, using bwip fallback",P);try{const Z=await W(E);Gr(Z),Fa("")}catch(Z){console.error("barcode fallback error",Z),Gr("")}}finally{F(!1)}})()},[fe.barcode]);const H=E=>(E||"").replace(/[&<>]/g,P=>({"&":"&amp;","<":"&lt;",">":"&gt;"})[P]),z=()=>{if(!(fe.barcode||"").trim()||!(vn||zn)){Te({title:"الباركود مطلوب",description:"أنشئ باركود أو أدخله قبل الطباعة",variant:"destructive"});return}try{const P=vn||zn,Z=window.open("","PRINT","width=600,height=400");Z==null||Z.document.write(`
      <html dir="rtl">
        <head>
          <meta charset="utf-8" />
          <title>طباعة باركود</title>
          <style>
            @page { size: 50mm 30mm; margin: 4mm; }
            body { margin: 0; padding: 0; font-family: system-ui, sans-serif; }
            .label { width: 100%; height: 100%; display:flex; flex-direction:column; align-items:center; justify-content:center; }
            .name { font-size: 12px; margin-bottom: 6px; }
            img { width: 100%; height: auto; }
          </style>
        </head>
        <body>
          <div class="label">
            <div class="name">${H(fe.productName||"")}</div>
            <img src="${P}" alt="barcode" />
          </div>
          <script>setTimeout(() => window.print(), 150);<\/script>
        </body>
      </html>
    `),Z==null||Z.document.close()}catch(P){console.error(P),Te({title:"فشل الطباعة",description:"تعذّر فتح نافذة الطباعة",variant:"destructive"})}},[me,Ie]=Ue.useState(!1),[ue,we]=Ue.useState(""),pe=Ki.useRef(null),We="barcode-scanner-container",ze=async()=>{try{const E=ct,P=await Uo.getCameras();if(!P||P.length===0)throw new Error("لا توجد كاميرات متاحة");const xe=(P.find(Ce=>/back|rear|خلف/i.test(Ce.label))||P[P.length-1]).id;pe.current=new Uo(We),await pe.current.start(xe,{fps:10,qrbox:{width:250,height:120},formatsToSupport:[E.CODE_128,E.EAN_13,E.EAN_8,E.CODE_39]},Ce=>{ot(Fe=>({...Fe,barcode:Ce})),Ye()},()=>{})}catch(E){console.error("scanner start error",E),we((E==null?void 0:E.message)||"تعذّر بدء الكاميرا")}},Ye=async()=>{try{pe.current&&(await pe.current.stop(),await pe.current.clear(),pe.current=null)}catch(E){console.warn("scanner stop warn",E)}Ie(!1)};Ue.useEffect(()=>()=>{pe.current&&(pe.current.stop().catch(()=>{}),pe.current.clear().catch(()=>{}),pe.current=null)},[]);const[Ke,nt]=Ue.useState(!0);Ue.useEffect(()=>{e&&nt(!0)},[e]);const[yt,Se]=Ue.useState(!1),hr=Ki.useRef(""),Mt=Ki.useRef(0),[Jr,Xa]=Ue.useState(0),[It,Nt]=Ue.useState(0),[jt,Qr]=Ue.useState(!1),[Ui,Yn]=Ue.useState(!1),[qt,nn]=Ue.useState(!0),Zs=Ki.useRef(0),Ir=Ki.useRef(0);Ue.useEffect(()=>{e&&nn(!0)},[e]);const[sn,dc]=Ue.useState(!1),[wi,ur]=Ue.useState(!1),[ma,ge]=Ue.useState(!0),[V,dt]=Ue.useState(!0),[$r,ya]=Ue.useState(!1),[Z0,Js]=Ue.useState("day"),[Ea,xt]=Ue.useState({}),[Er,ms]=Ue.useState(!1),[xc,Qs]=Ue.useState("التحقق قبل العملية"),[ps,$s]=Ue.useState("أدخل الرقم السري الرئيسي للمتابعة"),e0=Ki.useRef(null),Zt=(E,P,Z)=>{Qs(E),$s(P),e0.current=Z,ms(!0)},[vi,Fn]=Ue.useState([]),[Et,J0]=Ue.useState(0);Ue.useEffect(()=>{if(A!=null&&A.uid){const E=`inventoryOffset_v4_${A.uid}`,P=localStorage.getItem(E);P&&J0(Number(P))}},[A==null?void 0:A.uid]);const Pt=E=>{A!=null&&A.uid&&localStorage.setItem(`inventoryOffset_v4_${A.uid}`,String(E))},ia=()=>{Zt("إخفاء إجمالي المخزون","هل تريد تصفير عداد إجمالي المخزون مؤقتاً؟",async()=>{const E=Me.reduce((P,Z)=>P+(Number(Z.wholesalePrice)||0)*(Number(Z.quantity)||0),0);J0(E),Pt(E),Te({title:"تم التصفير",description:"تم تصفير عداد المخزون مؤقتاً"})})},[t0,ws]=Ue.useState([]),[Kn,On]=Ue.useState(null),[gc,qn]=Ue.useState(!1),[Zn,yi]=Ue.useState("");Ue.useEffect(()=>{if(!(A!=null&&A.uid))return;const E=(Y==null?void 0:Y.shopId)||Xe||null;try{const xe=E?`categories_${A.uid}_${E}`:`categories_${A.uid}_main`,Ce=localStorage.getItem(xe),Fe=Ce?JSON.parse(Ce):[];Array.isArray(Fe)&&Fe.length>0&&ws(Fe)}catch{}const P=E?ir(Kt(ut,"categories"),_t("shopId","==",E)):ir(Kt(ut,"categories"),_t("userId","==",A.uid)),Z=vc(P,xe=>{const Ce=xe.docs.map(Ne=>{var Ee,ve;const se=Ne.data();return{id:Ne.id,name:String(se.name||""),shopId:se.shopId||E||void 0,createdAt:((ve=(Ee=se.createdAt)==null?void 0:Ee.toDate)==null?void 0:ve.call(Ee))||new Date}}),Fe=new Map;for(const Ne of Ce)Fe.set(Ne.id,Ne);const je=Array.from(Fe.values()).sort((Ne,se)=>{const Ee=new Date(String(Ne.createdAt||"")).getTime(),ve=new Date(String(se.createdAt||"")).getTime();return Ee-ve});ws(je);try{const Ne=E?`categories_${A.uid}_${E}`:`categories_${A.uid}_main`;localStorage.setItem(Ne,JSON.stringify(je))}catch{}});return()=>Z()},[A==null?void 0:A.uid,Y==null?void 0:Y.shopId,Xe]);const Q0=async()=>{if(Zn.trim())try{await Is(Kt(ut,"categories"),{name:Zn.trim(),shopId:(Y==null?void 0:Y.shopId)||Xe||void 0,userId:(A==null?void 0:A.uid)||void 0,createdAt:Aa()}),yi(""),qn(!1),Te({title:"تمت الإضافة",description:"تم إضافة القسم بنجاح"})}catch(E){console.error(E),Te({title:"خطأ",description:"فشل إضافة القسم",variant:"destructive"})}},Wi=async(E,P)=>{P.stopPropagation(),Zt("حذف القسم","أدخل الرقم السري الرئيسي لحذف هذا القسم",()=>{U(E)})},Vi=async()=>{if(D)try{await Ti(ha(ut,"categories",D)),Te({title:"تم الحذف",description:"تم حذف القسم بنجاح"})}catch(E){console.error(E),Te({title:"خطأ",description:"فشل حذف القسم",variant:"destructive"})}finally{U(null)}},[_a,Jn]=Ue.useState(!1),[r0,$0]=Ue.useState(""),[eo,to]=Ue.useState(""),[ro,cr]=Ue.useState(""),[ao,Ei]=Ue.useState(null);Ue.useEffect(()=>{(async()=>{try{if(!e||!(A!=null&&A.uid))return;const E=await Bn.getUserData(A.uid),P=Array.isArray(E==null?void 0:E.customers)?E.customers.map(Z=>({id:String(Z.id||""),name:String(Z.name||""),mobile:Z.mobile||void 0})):[];Fn(P)}catch{}})()},[e,A==null?void 0:A.uid]);const[Rn,vs]=Ue.useState(!1),[ye,Ut]=Ue.useState(null),[Dr,ys]=Ue.useState(null),Hi=(E,P)=>{Ut(E),ys(P),vs(!0)},[Qn,a0]=Ue.useState(null),[mc,Gi]=Ue.useState(!1),[Mr,n0]=Ue.useState(""),_r=E=>E.replace(/[\u0660-\u0669]/g,P=>String("0123456789"["٠١٢٣٤٥٦٧٨٩".indexOf(P)])),_i=Ue.useMemo(()=>{const E=Mr.trim(),P=E.toLowerCase(),Z=new Map;for(const je of Me){const Ne=Z.get(je.id);if(!Ne)Z.set(je.id,je);else{const se=new Date(Ne.updatedAt||"").getTime(),Ee=new Date(je.updatedAt||"").getTime();Z.set(je.id,isFinite(se)&&isFinite(Ee)?Ee>=se?je:Ne:je)}}let xe=Array.from(Z.values());if(!P)return xe;const Ce=_r(E);return/^[0-9]+$/.test(Ce)?xe.filter(je=>String(je.barcode||"")===Ce):xe.filter(je=>(je.name||"").toLowerCase().includes(P))},[Me,Mr]),[za,nr]=Ue.useState({}),[wt,Es]=Ue.useState(!1),[$t,$n]=Ue.useState(null),[ei,_s]=Ue.useState("1"),Ua=E=>{$n(E),_s("1"),Es(!0)},As=()=>{if(!$t)return;const E=parseInt(ei);E>0&&(Es(!1),Zt("إضافة مخزون",`إضافة ${E} قطع للمنتج ${$t.name}`,async()=>{try{const P=$t.quantity+E;await Ka(ha(ut,"products",$t.id),{quantity:P,updatedAt:Aa()}),ft(Z=>Z.map(xe=>xe.id===$t.id?{...xe,quantity:P}:xe)),Te({title:"تمت الإضافة",description:`تمت إضافة ${E} قطعة`})}catch(P){console.error(P)}}))};Ue.useEffect(()=>{e&&(A!=null&&A.uid)&&(bs(),qt||ri())},[e,A==null?void 0:A.uid,qt]),Ue.useEffect(()=>{const E=P=>{var Z;try{const xe=!!((Z=P==null?void 0:P.detail)!=null&&Z.enabled);nn(xe)}catch{}};return window.addEventListener("monthlyReportsLockChanged",E),()=>window.removeEventListener("monthlyReportsLockChanged",E)},[]),Ue.useEffect(()=>{if(!e)return;const E=P=>{var je;const Z=P.target,xe=(je=Z==null?void 0:Z.tagName)==null?void 0:je.toLowerCase();if(xe==="input"||xe==="textarea"||!!(Z&&Z.isContentEditable)||Er||Ui||yt)return;const Fe=Date.now();if(P.key==="Enter"){const Ne=(hr.current||"").trim();hr.current="",Ne&&i(Ne);return}P.key.length===1&&(Fe-(Mt.current||0)>100&&(hr.current=""),hr.current+=P.key,Mt.current=Fe)};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[e,Me,Er,Ui,yt]),Ue.useEffect(()=>{e&&t&&i(t)},[e,t]);const no=async()=>{var Fe,je;if(!(A!=null&&A.uid))return;const E=(Y==null?void 0:Y.shopId)||Xe||"main",P=`shopProducts_${A.uid}_${E}`,Z=`shopProducts_lastSync_${A.uid}_${E}`;let xe=[],Ce=null;try{const Ne=localStorage.getItem(P);if(Ne){const Ee=JSON.parse(Ne);Array.isArray(Ee)&&Ee.length>0&&(xe=Ee,ft(xe))}const se=localStorage.getItem(Z);se&&(Ce=new Date(se))}catch(Ne){console.warn("Failed to load products from cache",Ne)}try{const Ne=[_t("userId","==",A.uid),...E?[_t("shopId","==",E)]:[]],se=ir(Kt(ut,"products"),...Ne,qi(2e3)),Ee=await Or(se),ve=Ee.docs.map(De=>{var pt,At,et;return{id:De.id,name:String(De.data().name??""),sellingPrice:Number(De.data().sellingPrice??0),wholesalePrice:Number(De.data().wholesalePrice??0),quantity:Number(De.data().quantity??0),barcode:String(De.data().barcode??""),serialNumber:String(De.data().serialNumber??""),categoryId:De.data().categoryId||void 0,supplierName:De.data().supplierName||void 0,updatedAt:((et=(At=(pt=De.data().updatedAt)==null?void 0:pt.toDate)==null?void 0:At.call(pt))==null?void 0:et.toISOString())||new Date().toISOString()}}),He=new Map(xe.map(De=>[De.id,De]));ve.forEach(De=>{He.set(De.id,De)});const ke=Array.from(He.values());ke.sort((De,pt)=>new Date(String(De.updatedAt||"")).getTime()-new Date(String(pt.updatedAt||"")).getTime()),ft(ke);try{if(localStorage.setItem(P,JSON.stringify(ke)),ve.length>0){const De=ve[ve.length-1].updatedAt;localStorage.setItem(Z,De)}}catch{}Y!=null&&Y.shopId&&ve.length>0&&ve.filter(pt=>{var et;const At=(et=Ee.docs.find(kt=>kt.id===pt.id))==null?void 0:et.data();return!(At!=null&&At.shopId)}).length>0}catch(Ne){if((Ne==null?void 0:Ne.code)==="failed-precondition"||(Fe=Ne==null?void 0:Ne.message)!=null&&Fe.includes("index")){const se=[_t("userId","==",A.uid),...Y!=null&&Y.shopId?[_t("shopId","==",Y.shopId)]:[]],Ee=ir(Kt(ut,"products"),...se,qi(2e3));let He=(await Or(Ee)).docs.map(ke=>{var De,pt,At;return{id:ke.id,name:String(ke.data().name??""),sellingPrice:Number(ke.data().sellingPrice??0),wholesalePrice:Number(ke.data().wholesalePrice??0),quantity:Number(ke.data().quantity??0),barcode:String(ke.data().barcode??""),serialNumber:String(ke.data().serialNumber??""),categoryId:ke.data().categoryId||void 0,supplierName:ke.data().supplierName||void 0,updatedAt:((At=(pt=(De=ke.data().updatedAt)==null?void 0:De.toDate)==null?void 0:pt.call(De))==null?void 0:At.toISOString())||new Date().toISOString()}});if(Ce){const ke=Ce.getTime();He=He.filter(De=>{const pt=new Date(De.updatedAt).getTime();return isFinite(pt)?pt>ke:!0})}He=He.sort((ke,De)=>new Date(ke.updatedAt).getTime()-new Date(De.updatedAt).getTime()),ft(He);try{localStorage.setItem(P,JSON.stringify(He));const ke=((je=He[He.length-1])==null?void 0:je.updatedAt)||new Date().toISOString();localStorage.setItem(Z,ke)}catch{}}else console.error("Error loading shop products with sync:",Ne)}};Ue.useEffect(()=>{e&&(A!=null&&A.uid)&&(no(),ri(),bs(),Oa())},[e,A==null?void 0:A.uid,Y==null?void 0:Y.shopId,h]),Ue.useEffect(()=>{if(!e||!(A!=null&&A.uid))return;const E=Xe||(Y==null?void 0:Y.shopId)||null,P=new Date().toISOString().split("T")[0],Z={current:""},xe=(je,Ne)=>{var Ee,ve;const se=je;return{id:String(se.clientId||Ne),firestoreId:Ne,productName:String(se.productName||""),price:Number(se.sellingPrice||0),wholesalePrice:se.wholesalePrice!==void 0?Number(se.wholesalePrice):null,quantity:Number(se.quantity||0),date:String(se.date||P),time:String(se.time||""),serialNumber:se.serialNumber||void 0,barcode:se.barcode||void 0,performedByType:se.performedByType||void 0,performedByName:se.performedByName||void 0,performedByUsername:se.performedByUsername||void 0,isDeferred:!!se.isDeferred,paymentMethod:se.paymentMethod==="visa"?"visa":"cash",customerName:se.customerName||void 0,customerMobile:se.customerMobile||void 0,customerId:se.customerId||void 0,createdAtMs:(ve=(Ee=se==null?void 0:se.createdAt)==null?void 0:Ee.toDate)!=null&&ve.call(Ee)?se.createdAt.toDate().getTime():new Date(String(se.date||P)).getTime()}},Ce=E?ir(Kt(ut,"dailySales"),_t("shopId","==",E)):ir(Kt(ut,"dailySales"),_t("userId","==",A.uid)),Fe=vc(Ce,je=>{let Ne=[];try{const ke=`deletedSaleIds_${A.uid}`,De=localStorage.getItem(ke);De&&(Ne=JSON.parse(De))}catch{}const se=je.docs.map(ke=>xe(ke.data(),ke.id)).filter(ke=>!Ne.includes(ke.id)&&!Ne.includes(ke.firestoreId||"")),Ee=se.map(ke=>`${ke.id}:${ke.createdAtMs}:${ke.quantity}:${ke.price}`).join("|");if(Ee===Z.current)return;Z.current=Ee;const ve={};[...j,...se].forEach(ke=>{ve[ke.id]=ke});const He=Object.values(ve);ti(He),ri()});return()=>{try{Fe()}catch{}}},[e,A==null?void 0:A.uid,Y==null?void 0:Y.shopId,Xe]),Ue.useEffect(()=>{if(!e||!(A!=null&&A.uid))return;const E=(Y==null?void 0:Y.shopId)||Xe||void 0,P={current:[]},Z={current:""};try{const Ee=`shopProducts_${A.uid}_${E||"main"}`,ve=`shopProducts_${A.uid}_main`,He=localStorage.getItem(Ee),ke=localStorage.getItem(ve),De=He?JSON.parse(He):[],pt=ke?JSON.parse(ke):[],At=new Map;[...Array.isArray(De)?De:[],...Array.isArray(pt)?pt:[]].forEach(kt=>{kt&&kt.id&&At.set(kt.id,kt)});const et=Array.from(At.values());et.length>0&&(ft(et),P.current=et)}catch{}const xe=E?ir(Kt(ut,"products"),_t("shopId","==",E)):ir(Kt(ut,"products"),_t("userId","==",A.uid));let Ce=[],Fe=null;const je=()=>{Fe||(Fe=setTimeout(()=>{Fe=null,Ne()},100))},Ne=()=>{var ke;const Ee=new Map;for(const De of P.current||[])De&&De.id&&Ee.set(De.id,De);for(const De of Ce){const pt=Ee.get(De.id);if(!pt)Ee.set(De.id,De);else{const At=new Date(String(pt.updatedAt||"")).getTime(),et=new Date(String(De.updatedAt||"")).getTime();Ee.set(De.id,isFinite(At)&&isFinite(et)?et>=At?De:pt:De)}}let ve=Array.from(Ee.values());ve=ve.sort((De,pt)=>{const At=new Date(String(De.updatedAt||"")).getTime(),et=new Date(String(pt.updatedAt||"")).getTime();if(isFinite(et)&&isFinite(At))return et-At;if(isFinite(et))return-1;if(isFinite(At))return 1;const kt=String(De.name||"").toLowerCase(),tr=String(pt.name||"").toLowerCase();return kt.localeCompare(tr)});const He=ve.map(De=>`${De.id}:${String(De.updatedAt||"")}`).join("|");if(He!==Z.current){if(Z.current=He,ve.length===0){P.current.length>0?ft(P.current):ft([]);return}P.current=ve,ft(ve);try{const De=`shopProducts_${A.uid}_${E||"main"}`;localStorage.setItem(De,JSON.stringify(ve));const pt=`shopProducts_lastSync_${A.uid}_${E||"main"}`,At=((ke=ve[ve.length-1])==null?void 0:ke.updatedAt)||new Date().toISOString();localStorage.setItem(pt,At)}catch{}}},se=vc(xe,Ee=>{Ce=Ee.docs.map(ve=>{var He,ke,De;return{id:ve.id,name:String(ve.data().name??""),sellingPrice:Number(ve.data().sellingPrice??0),wholesalePrice:Number(ve.data().wholesalePrice??0),quantity:Number(ve.data().quantity??0),barcode:String(ve.data().barcode??""),serialNumber:String(ve.data().serialNumber??""),categoryId:ve.data().categoryId||void 0,supplierName:ve.data().supplierName||void 0,updatedAt:((De=(ke=(He=ve.data().updatedAt)==null?void 0:He.toDate)==null?void 0:ke.call(He))==null?void 0:De.toISOString())||new Date().toISOString()}}),je()});return()=>{try{se()}catch{}if(Fe){try{clearTimeout(Fe)}catch{}Fe=null}}},[e,A==null?void 0:A.uid,Y==null?void 0:Y.shopId,Xe]);const Ya=()=>{const E=new Date,P=E.getFullYear(),Z=String(E.getMonth()+1).padStart(2,"0"),xe=String(E.getDate()).padStart(2,"0");return`${P}-${Z}-${xe}`},yn=E=>{const P=Z=>{if(typeof Z.createdAtMs=="number")return Z.createdAtMs;const xe=parseInt(Z.id,10);if(!isNaN(xe))return xe;const Ce=new Date(Z.date);return isNaN(Ce.getTime())?0:Ce.getTime()};return[...E].sort((Z,xe)=>P(xe)-P(Z))},bs=()=>{if(!(A!=null&&A.uid)){console.log("No user authenticated, cannot load sales data");return}let E=[];try{const He=`deletedSaleIds_${A.uid}`,ke=localStorage.getItem(He);ke&&(E=JSON.parse(ke))}catch{}const P=He=>Array.isArray(He)?He.filter(ke=>!E.includes(ke.id)&&!E.includes(ke.firestoreId||"")):[],Z=Xe||(Y==null?void 0:Y.shopId)||"main",xe=`salesData_all_${A.uid}_${Z}`,Ce=localStorage.getItem(xe);if(Ce)try{const He=JSON.parse(Ce),ke=P(He);_e(yn(ke)),ke.length!==He.length&&localStorage.setItem(xe,JSON.stringify(ke));return}catch{}const Fe=Ya(),je=`salesData_${A.uid}_${Z}_${Fe}`,Ne=localStorage.getItem(je);if(Ne){const He=JSON.parse(Ne),ke=P(He),De=yn(ke);_e(De);try{localStorage.setItem(xe,JSON.stringify(De))}catch{}return}const se=new Date().toISOString().split("T")[0],Ee=`salesData_${A.uid}_${Z}_${se}`,ve=localStorage.getItem(Ee);if(ve){const He=JSON.parse(ve),ke=P(He),De=yn(ke);_e(De);try{localStorage.setItem(je,JSON.stringify(De)),localStorage.setItem(xe,JSON.stringify(De))}catch{}return}i0()},Xi=E=>{if(!(A!=null&&A.uid)){console.log("No user authenticated, cannot save sales data");return}const P=Xe||(Y==null?void 0:Y.shopId)||"main",Z=Ya(),xe=`salesData_${A.uid}_${P}_${Z}`,Ce=`salesData_all_${A.uid}_${P}`,Fe=yn(E);localStorage.setItem(xe,JSON.stringify(Fe));try{const je=localStorage.getItem(Ce),Ne=je?JSON.parse(je):[],se={};[...Array.isArray(Ne)?Ne:[],...Fe].forEach(He=>{se[He.id]=He});const Ee=Object.values(se),ve=yn(Ee);localStorage.setItem(Ce,JSON.stringify(ve))}catch{}_e(Fe)},ti=E=>{if(!(A!=null&&A.uid)){console.log("No user authenticated, cannot save sales data");return}const P=Xe||(Y==null?void 0:Y.shopId)||"main",Z=`salesData_all_${A.uid}_${P}`;try{const Ce=localStorage.getItem(Z),Fe=Ce?JSON.parse(Ce):[],je={};[...Array.isArray(Fe)?Fe:[],...E].forEach(Ee=>{je[Ee.id]=Ee});const Ne=Object.values(je),se=yn(Ne);localStorage.setItem(Z,JSON.stringify(se))}catch{}const xe=yn(E);_e(xe)},i0=async()=>{if(A!=null&&A.uid)try{const E=Xe||(Y==null?void 0:Y.shopId)||null,P=new Date().toISOString().split("T")[0],Z=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(new Date);let xe,Ce,Fe,je;try{const ke=ir(Kt(ut,"dailySales"),_t("userId","==",A.uid),...E?[_t("shopId","==",E)]:[]);xe=await Or(ke)}catch{}try{const ke=ir(Kt(ut,"dailySales"),_t("userId","==",A.uid));Fe=await Or(ke)}catch{}try{const ke=ir(Kt(ut,"users",A.uid,"dailySales"),...E?[_t("shopId","==",E)]:[]);Ce=await Or(ke)}catch{}try{const ke=ir(Kt(ut,"users",A.uid,"dailySales"));je=await Or(ke)}catch{}const Ne=[...xe?xe.docs:[],...Ce?Ce.docs:[],...Fe?Fe.docs:[],...je?je.docs:[]];let se=[];try{const ke=`deletedSaleIds_${A.uid}`,De=localStorage.getItem(ke);De&&(se=JSON.parse(De))}catch{}const Ee=Ne.map(ke=>{var pt,At;const De=ke.data();return{id:String(De.clientId||ke.id),firestoreId:ke.id,productName:String(De.productName||""),price:Number(De.sellingPrice||0),wholesalePrice:De.wholesalePrice!==void 0?Number(De.wholesalePrice):null,quantity:Number(De.quantity||0),date:String(De.date||P),time:String(De.time||""),serialNumber:De.serialNumber||void 0,barcode:De.barcode||void 0,performedByType:De.performedByType||void 0,performedByName:De.performedByName||void 0,performedByUsername:De.performedByUsername||void 0,isDeferred:!!De.isDeferred,paymentMethod:De.paymentMethod==="visa"?"visa":"cash",customerName:De.customerName||void 0,customerMobile:De.customerMobile||void 0,customerId:De.customerId||void 0,createdAtMs:(At=(pt=De==null?void 0:De.createdAt)==null?void 0:pt.toDate)!=null&&At.call(pt)?De.createdAt.toDate().getTime():new Date(String(De.date||P)).getTime()}}).filter(ke=>!se.includes(ke.id)&&!se.includes(ke.firestoreId||"")),ve={};[...j,...Ee].forEach(ke=>{ve[ke.id]=ke});const He=Object.values(ve);ti(He)}catch{}},ri=async()=>{if(A!=null&&A.uid)try{const E=Date.now();if(Zs.current&&E<Zs.current||E-(Ir.current||0)<6e4)return;const P=new Date,Z=new Date(P.getFullYear(),P.getMonth(),1),xe=new Date(P.getFullYear(),P.getMonth()+1,0),Ce=He=>He.toISOString().split("T")[0],Fe=Ce(Z),je=Ce(xe),Ne=Xe||(Y==null?void 0:Y.shopId)||null;let se;try{const He=ir(Kt(ut,"dailySales"),_t("userId","==",A.uid),...Ne?[_t("shopId","==",Ne)]:[]);se=await Or(He)}catch{const He=ir(Kt(ut,"users",A.uid,"dailySales"),...Ne?[_t("shopId","==",Ne)]:[]);se=await Or(He)}let Ee=0,ve=0;se.forEach(He=>{const ke=He.data(),De=String(ke.date??"").slice(0,10);if(!ke.isDeferred&&De>=Fe&&De<=je){const pt=Number(ke.sellingPrice??0),At=Number(ke.quantity??0),et=Number(ke.profit??(Number(ke.sellingPrice??0)-Number(ke.wholesalePrice??0))*At);Ee+=pt*At,ve+=et}}),Xa(Ee),Nt(ve),Ir.current=Date.now()}catch(E){console.error("Error loading monthly stats:",E);try{const P=(E==null?void 0:E.code)||"";String(P)==="resource-exhausted"&&(Zs.current=Date.now()+5*60*1e3,Te({title:"تم تجاوز الحصة",description:"تم إيقاف استعلامات تقارير الشهر مؤقتاً لمدة 5 دقائق لتجنب الضغط على الخادم.",variant:"destructive"}))}catch{}}},Mn=async E=>{if(!(A!=null&&A.uid))return null;try{const P=((E.price??0)-(E.wholesalePrice??0))*(E.quantity??0),Z=ht&&lt?"cashier":"admin",xe=Z==="cashier"?(lt==null?void 0:lt.name)||"كاشير":(Y==null?void 0:Y.fullName)||(A==null?void 0:A.displayName)||"الحساب الرئيسي",Ce=Z==="cashier"&&(lt==null?void 0:lt.username)||null,Fe=await Is(Kt(ut,"dailySales"),{userId:A.uid,clientId:E.id,productName:E.productName,quantity:E.quantity,wholesalePrice:E.wholesalePrice??null,sellingPrice:E.price,profit:P,date:E.date,time:E.time,performedByType:Z,performedByName:xe,performedByUsername:Ce,serialNumber:E.serialNumber??null,barcode:E.barcode??null,isDeferred:!!E.isDeferred,paymentMethod:E.paymentMethod||"cash",customerName:E.customerName||null,customerMobile:E.customerMobile||null,customerId:E.customerId||null,...Y!=null&&Y.shopId?{shopId:Y.shopId}:Xe?{shopId:Xe}:{},...E.cartItems?{cartItems:E.cartItems}:{},createdAt:Aa()});try{await Ql(ha(ut,"users",A.uid,"dailySales",Fe.id),{userId:A.uid,clientId:E.id,productName:E.productName,quantity:E.quantity,wholesalePrice:E.wholesalePrice??null,sellingPrice:E.price,profit:P,date:E.date,time:E.time,performedByType:Z,performedByName:xe,performedByUsername:Ce,serialNumber:E.serialNumber??null,barcode:E.barcode??null,isDeferred:!!E.isDeferred,paymentMethod:E.paymentMethod||"cash",customerName:E.customerName||null,customerMobile:E.customerMobile||null,customerId:E.customerId||null,...Y!=null&&Y.shopId?{shopId:Y.shopId}:Xe?{shopId:Xe}:{},...E.cartItems?{cartItems:E.cartItems}:{},createdAt:Aa()})}catch{}return Fe.id}catch{try{const P=await Is(Kt(ut,"users",A.uid,"dailySales"),{userId:A.uid,clientId:E.id,productName:E.productName,quantity:E.quantity,wholesalePrice:E.wholesalePrice??null,sellingPrice:E.price,profit,date:E.date,time:E.time,performedByType,performedByName,performedByUsername,serialNumber:E.serialNumber??null,barcode:E.barcode??null,isDeferred:!!E.isDeferred,paymentMethod:E.paymentMethod||"cash",customerName:E.customerName||null,customerMobile:E.customerMobile||null,customerId:E.customerId||null,...Y!=null&&Y.shopId?{shopId:Y.shopId}:Xe?{shopId:Xe}:{},...E.cartItems?{cartItems:E.cartItems}:{},createdAt:Aa()});try{await Ql(ha(ut,"dailySales",P.id),{userId:A.uid,clientId:E.id,productName:E.productName,quantity:E.quantity,wholesalePrice:E.wholesalePrice??null,sellingPrice:E.price,profit,date:E.date,time:E.time,performedByType,performedByName,performedByUsername,serialNumber:E.serialNumber??null,barcode:E.barcode??null,isDeferred:!!E.isDeferred,paymentMethod:E.paymentMethod||"cash",customerName:E.customerName||null,customerMobile:E.customerMobile||null,customerId:E.customerId||null,...Y!=null&&Y.shopId?{shopId:Y.shopId}:Xe?{shopId:Xe}:{},...E.cartItems?{cartItems:E.cartItems}:{},createdAt:Aa()})}catch{}return P.id}catch(P){return console.error("Error saving sale:",P),null}}},zi=()=>{const E=Xe||(Y==null?void 0:Y.shopId)||"main";return`cashBalance_${(A==null?void 0:A.uid)||"default"}_${E}`},Pn=async(E,P)=>{if(A!=null&&A.uid)try{const Z=ha(ut,"dailySales",E);await Ka(Z,P)}catch{try{const Z=ha(ut,"users",A.uid,"dailySales",E);await Ka(Z,P)}catch(Z){console.error("Error updating sale:",Z)}}},Yi=async E=>{try{const P=E.firestoreId;if(P)await Pn(P,{isDeferred:!1});else try{const Z=ir(Kt(ut,"dailySales"),_t("userId","==",(A==null?void 0:A.uid)||""),_t("date","==",E.date),_t("productName","==",E.productName),qi(5)),Ce=(await Or(Z)).docs[0];Ce&&await Ka(Ce.ref,{isDeferred:!1})}catch{}_e(Z=>Z.map(xe=>xe.id===E.id?{...xe,isDeferred:!1}:xe));try{await ri()}catch{}Te({title:"تم التسديد",description:`تم تسديد أجل ${E.productName}`})}catch(P){console.error("Error marking deferred sale as paid:",P),Te({title:"فشل التسديد",description:"تعذّر تحديث حالة البيع المؤجّل",variant:"destructive"})}},Oa=async()=>{if(!(A!=null&&A.uid))return;const E=j.filter(P=>!P.firestoreId);if(E.length!==0)for(const P of E)try{let Z;try{const Ce=ir(Kt(ut,"dailySales"),_t("userId","==",A.uid),_t("clientId","==",P.id),qi(1));Z=await Or(Ce)}catch{const Ce=ir(Kt(ut,"users",A.uid,"dailySales"),_t("clientId","==",P.id),qi(1));Z=await Or(Ce)}if(!Z.empty){const Ce=Z.docs[0].id,Fe=j.map(je=>je.id===P.id?{...je,firestoreId:Ce}:je);Xi(Fe);continue}const xe=await Mn(P);if(xe){const Ce=j.map(Fe=>Fe.id===P.id?{...Fe,firestoreId:xe}:Fe);Xi(Ce)}}catch{}},s0=async E=>{try{if(A!=null&&A.uid)try{const se=Kt(ut,"deficiencies"),Ee=await Is(se,{shopId:(Y==null?void 0:Y.shopId)||A.uid||"default-shop",name:E,quantity:1,status:"pending",createdAt:Aa()});try{const ve=`deficiencies_${(Y==null?void 0:Y.shopId)||(A==null?void 0:A.uid)||"default-shop"}`,He=localStorage.getItem(ve),ke=He?JSON.parse(He):[],De=Array.isArray(ke)?ke:[],pt=De.some(kt=>String((kt==null?void 0:kt.id)||"")===Ee.id),At={id:Ee.id,name:E,quantity:1,status:"pending",createdAt:new Date().toISOString()},et=pt?De:[...De,At];localStorage.setItem(ve,JSON.stringify(et))}catch{}Te({title:"تمت الإضافة للنواقص",description:`المنتج ${E} نفد من المخزون وتمت إضافته للنواقص`});return}catch(se){console.warn("Failed to add deficiency to Firestore, falling back to local storage:",se)}const P=`deficiencies_${(Y==null?void 0:Y.shopId)||(A==null?void 0:A.uid)||"default-shop"}`,Z=localStorage.getItem(P),xe=Z?JSON.parse(Z):[],Ce=Array.isArray(xe)?xe:[];if(Ce.some(se=>String((se==null?void 0:se.name)||"").trim()===E&&String((se==null?void 0:se.status)||"pending")==="pending"))return;const je={id:Date.now().toString(),name:E,quantity:1,status:"pending",createdAt:new Date().toISOString()},Ne=[...Ce,je];localStorage.setItem(P,JSON.stringify(Ne)),Te({title:"تمت الإضافة للنواقص",description:`المنتج ${E} نفد من المخزون وتمت إضافته للنواقص`})}catch(P){console.error("Error adding deficiency for out-of-stock:",P)}},on=()=>{try{if(Me.length===0){Te({title:"لا توجد بيانات",description:"لا توجد منتجات لتصديرها",variant:"destructive"});return}const E=Me.map(xe=>({"اسم المنتج":xe.name,"سعر البيع":xe.sellingPrice,"سعر الجملة":xe.wholesalePrice||0,الكمية:xe.quantity,الباركود:xe.barcode||"","الرقم التسلسلي":xe.serialNumber||""})),P=jo.json_to_sheet(E),Z=jo.book_new();jo.book_append_sheet(Z,P,"المنتجات"),X_(Z,"المنتجات.xlsx"),Te({title:"تم التصدير",description:"تم تصدير المنتجات بنجاح"})}catch(E){console.error("Error exporting excel:",E),Te({title:"خطأ",description:"حدث خطأ أثناء تصدير البيانات",variant:"destructive"})}},pc=E=>{var Z;const P=(Z=E.target.files)==null?void 0:Z[0];if(P){if(ht){Te({title:"غير مسموح",description:"لا يمكن استيراد منتجات أثناء الوردية",variant:"destructive"}),E.target.value="";return}Zt("استيراد منتجات","أدخل الرقم السري للمتابعة",async()=>{const xe=new FileReader;xe.onload=async Ce=>{var Fe;try{const je=(Fe=Ce.target)==null?void 0:Fe.result,Ne=al(je,{type:"binary"}),se=Ne.SheetNames[0],Ee=Ne.Sheets[se],ve=jo.sheet_to_json(Ee);if(!ve||ve.length===0){Te({title:"خطأ",description:"الملف فارغ أو التنسيق غير صحيح",variant:"destructive"});return}let He=0,ke=0;for(const et of ve)try{const kt=et["اسم المنتج"]||et.name,tr=Number(et["سعر البيع"]||et.sellingPrice),Ot=Number(et.الكمية||et.quantity),Qt=Number(et["سعر الجملة"]||et.wholesalePrice||0),Xt=et.الباركود||et.barcode||"",Pr=et["الرقم التسلسلي"]||et.serialNumber||"";if(kt&&!isNaN(tr)&&!isNaN(Ot)){const Xr={name:String(kt).trim(),sellingPrice:tr,wholesalePrice:Qt,quantity:Ot,userId:A==null?void 0:A.uid,createdAt:Aa(),updatedAt:Aa()};Xt&&(Xr.barcode=String(Xt).trim()),Pr&&(Xr.serialNumber=String(Pr).trim()),Y!=null&&Y.shopId?Xr.shopId=Y.shopId:Xe&&(Xr.shopId=Xe),await Is(Kt(ut,"products"),Xr),He++}}catch{ke++}const De=ir(Kt(ut,"products"),_t("userId","==",A==null?void 0:A.uid),...Y!=null&&Y.shopId?[_t("shopId","==",Y.shopId)]:[]),At=(await Or(De)).docs.map(et=>({id:et.id,...et.data()}));ft(At),Te({title:"تم الاستيراد",description:`تم إضافة ${He} منتج بنجاح.${ke>0?` فشل ${ke} منتج.`:""}`})}catch(je){console.error("Error importing excel:",je),Te({title:"خطأ",description:"حدث خطأ أثناء قراءة الملف",variant:"destructive"})}E.target&&(E.target.value="")},xe.readAsBinaryString(P)})}},o0=async()=>{const E=String(na.productName||"").trim(),P=parseFloat(String(na.price||"")),Z=parseFloat(String(na.wholesalePrice||"")),xe=parseInt(String(na.quantity||"1"));if(!E||isNaN(P)||P<=0||isNaN(xe)||xe<=0){Te({title:"بيانات غير صالحة",description:"أدخل اسم المنتج وسعر بيع صحيح والكمية",variant:"destructive"});return}const Ce=new Date,Fe=ht&&lt?"cashier":"admin",je=Fe==="cashier"?(lt==null?void 0:lt.name)||"كاشير":(Y==null?void 0:Y.fullName)||(A==null?void 0:A.displayName)||"الحساب الرئيسي",Ne=Fe==="cashier"&&(lt==null?void 0:lt.username)||null,se=A!=null&&A.uid?`SALECASH-${A.uid}-${Date.now()}`:void 0,Ee={id:Date.now().toString(),productName:E,price:P,wholesalePrice:isNaN(Z)?0:Z,quantity:xe,date:Ce.toISOString().split("T")[0],time:Ce.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),createdAtMs:Ce.getTime(),performedByType:Fe,performedByName:je,performedByUsername:Ne,serialNumber:String(na.serialNumber||"").trim()||void 0,barcode:String(na.barcode||"").trim()||void 0,isDeferred:!1,transactionReference:se};try{const ve=await Mn(Ee),He=ve?{...Ee,firestoreId:ve}:Ee;Xi([...j,He]);const ke=P*xe;try{const De=zi(),pt=localStorage.getItem(De),et=(pt?parseFloat(pt):0)+ke;localStorage.setItem(De,et.toString());const kt=`userData_${A==null?void 0:A.uid}`,tr={cashBalance:et,lastUpdated:new Date().toISOString()};localStorage.setItem(kt,JSON.stringify(tr)),A!=null&&A.uid&&Bn.updateUserData(A.uid,tr).catch(()=>{});const Ot=(Y==null?void 0:Y.shopId)||Xe;if(Ot)try{await Ka(ha(ut,"dashboardData",Ot),{cashBalance:et})}catch{}try{window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:et}}))}catch{}try{if(A!=null&&A.uid&&se){const Xt={txnType:"sales",type:"sales",amount:ke,status:"confirmed",senderMsisdn:"مبيعات",receiverMsisdn:"",reference:se,title:"إيصال مبيعات",merchantUserId:A.uid,createdBy:A.uid,shopId:(Y==null?void 0:Y.shopId)||Xe||void 0,cashierName:je,performedByType:Fe,performedByUsername:Ne,saleProductName:E,saleQuantity:xe,createdAt:new Date};await Bn.saveUserTransaction(A.uid,Xt)}}catch{}Xa(Xt=>Xt+ke);const Qt=(P-(isNaN(Z)?0:Z))*xe;Nt(Xt=>Xt+Qt)}catch(De){console.warn("تعذر تحديث رصيد الدرج النقدي بعد البيع الفوري:",De)}Zr({productName:"",price:"",wholesalePrice:"",quantity:"1",barcode:"",serialNumber:""}),Te({title:"تم البيع",description:`تم بيع ${xe} قطعة من ${E} (بدون تسجيل بالمخزون)`})}catch(ve){console.error("Error quick selling ad-hoc product:",ve),Te({title:"فشل البيع",description:"تعذّر تنفيذ عملية البيع الفوري",variant:"destructive"})}},Cs=async(E,P=!1,Z,xe)=>{const Ce=vt[E.id]||"",Fe=parseInt(Ce);if(isNaN(Fe)||Fe<=0){Te({title:"كمية غير صالحة",description:"أدخل كمية صحيحة للبيـع",variant:"destructive"});return}if(Fe>E.quantity){Te({title:"كمية أكبر من المتاح",description:"الكمية المطلوب بيعها تتجاوز المخزون المتاح",variant:"destructive"});return}const je=new Date,Ne=Ya(),se=ht&&lt?"cashier":"admin",Ee=se==="cashier"?(lt==null?void 0:lt.name)||"كاشير":(Y==null?void 0:Y.fullName)||(A==null?void 0:A.displayName)||"الحساب الرئيسي",ve=se==="cashier"&&(lt==null?void 0:lt.username)||null,He=A!=null&&A.uid?`SALECASH-${A.uid}-${Date.now()}`:void 0,ke=(E.serialNumber||"").trim(),De=Ea[E.id]||"",pt=parseFloat(De),At=!isNaN(pt)&&pt>0?pt:E.sellingPrice,et=za[E.id]||"cash",kt={id:Date.now().toString(),productName:E.name,price:At,wholesalePrice:E.wholesalePrice,quantity:Fe,date:Ne,time:je.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),createdAtMs:je.getTime(),performedByType:se,performedByName:Ee,performedByUsername:ve,serialNumber:ke||void 0,barcode:E.barcode,isDeferred:P,paymentMethod:et,customerName:Z==null?void 0:Z.name,customerMobile:Z==null?void 0:Z.mobile,customerId:Z==null?void 0:Z.id,transactionReference:He};try{Xi([kt,...j]);const tr=E.quantity-Fe;if(ft(Qt=>Qt.map(Xt=>Xt.id===E.id?{...Xt,quantity:tr}:Xt)),qr(Qt=>({...Qt,[E.id]:""})),xt(Qt=>({...Qt,[E.id]:""})),tr===0)try{s0(E.name)}catch{}if(!P){const Qt=At*Fe;if(et==="cash")try{const Pr=zi(),Xr=localStorage.getItem(Pr),ni=(Xr?parseFloat(Xr):0)+Qt;localStorage.setItem(Pr,ni.toString());const Ts=`userData_${A==null?void 0:A.uid}`,oo={cashBalance:ni,lastUpdated:new Date().toISOString()};try{localStorage.setItem(Ts,JSON.stringify(oo))}catch{}try{window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:ni}}))}catch{}}catch(Pr){console.warn("تعذر تحديث رصيد الدرج محلياً:",Pr)}const Xt=(At-(E.wholesalePrice||0))*Fe;Xa(Pr=>Pr+Qt),Nt(Pr=>Pr+Xt),Ge(Pr=>Pr+Xt)}const Ot=[];if(Ot.push(Mn(kt).then(Qt=>{if(Qt)try{const Xt=Xe||(Y==null?void 0:Y.shopId)||"main",Pr=Ya(),Xr=`salesData_${A==null?void 0:A.uid}_${Xt}_${Pr}`,bi=`salesData_all_${A==null?void 0:A.uid}_${Xt}`,ni=localStorage.getItem(Xr),Ts=ni?JSON.parse(ni):[],oo=(Array.isArray(Ts)?Ts:[]).map(Ns=>Ns.id===kt.id?{...Ns,firestoreId:Qt}:Ns);localStorage.setItem(Xr,JSON.stringify(oo));try{const Ns=localStorage.getItem(bi),Kl=Ns?JSON.parse(Ns):[],Gu=(Array.isArray(Kl)?Kl:[]).map(wc=>wc.id===kt.id?{...wc,firestoreId:Qt}:wc);localStorage.setItem(bi,JSON.stringify(Gu))}catch{}_e(yn(oo))}catch{}})),Ot.push(Ka(ha(ut,"products",E.id),{quantity:tr,updatedAt:Aa()}).catch(()=>{})),!P){const Qt=At*Fe;if(et==="cash"){const Xt=(Y==null?void 0:Y.shopId)||Xe,Pr=`userData_${A==null?void 0:A.uid}`,Xr=localStorage.getItem(zi()),ni=Xr?parseFloat(Xr):0,Ts={cashBalance:ni,lastUpdated:new Date().toISOString()};A!=null&&A.uid&&Ot.push(Bn.updateUserData(A.uid,Ts).catch(()=>{})),Xt&&Ot.push(Ka(ha(ut,"dashboardData",Xt),{cashBalance:ni}).catch(()=>{}))}if(A!=null&&A.uid&&He){const Xt={txnType:"sales",type:"sales",amount:At*Fe,status:"confirmed",senderMsisdn:"مبيعات",receiverMsisdn:"",reference:He,title:"إيصال مبيعات",merchantUserId:A.uid,createdBy:A.uid,shopId:(Y==null?void 0:Y.shopId)||Xe||void 0,cashierName:Ee,performedByType:se,performedByUsername:ve,saleProductName:E.name,saleQuantity:Fe,paymentMethod:et,createdAt:new Date};Ot.push(Bn.saveUserTransaction(A.uid,Xt).catch(()=>{}))}}Promise.allSettled(Ot).catch(()=>{}),Te({title:"تم البيع",description:`تم بيع ${Fe} قطعة من ${E.name}`})}catch(tr){console.error("Error selling product:",tr),Te({title:"فشل البيع",description:"تعذّر تنفيذ عملية البيع",variant:"destructive"})}},io=async E=>{if(A!=null&&A.uid){if(ht){Te({title:"غير مسموح في وضع الكاشير",description:"لا يمكن حذف إيصالات البيع أثناء الورديه",variant:"destructive"});return}Zt("تأكيد حذف إيصال بيع","أدخل الرقم السري الرئيسي لحذف الإيصال وعكس الآثار",async()=>{try{try{const Ne=`deletedSaleIds_${A.uid}`,se=localStorage.getItem(Ne),ve=[...se?JSON.parse(se):[],E.id,E.firestoreId].filter(Boolean);localStorage.setItem(Ne,JSON.stringify(ve))}catch{}const P=Xe||(Y==null?void 0:Y.shopId)||"main",Z=Ya(),xe=`salesData_${A.uid}_${P}_${Z}`,Ce=`salesData_all_${A.uid}_${P}`,Fe=j.filter(Ne=>Ne.id!==E.id);try{localStorage.setItem(xe,JSON.stringify(Fe));const Ne=localStorage.getItem(Ce),se=Ne?JSON.parse(Ne):[],Ee=(Array.isArray(se)?se:[]).filter(ve=>(ve==null?void 0:ve.id)!==E.id);localStorage.setItem(Ce,JSON.stringify(Ee))}catch{}_e(Fe);const je=[];if(!E.isDeferred)try{const Ne=(E.price??0)*(E.quantity??0),se=zi(),Ee=localStorage.getItem(se),He=(Ee?parseFloat(Ee):0)-Ne;localStorage.setItem(se,He.toString());const ke=`userData_${A==null?void 0:A.uid}`,De={cashBalance:He,lastUpdated:new Date().toISOString()};try{localStorage.setItem(ke,JSON.stringify(De))}catch{}A!=null&&A.uid&&je.push(Bn.updateUserData(A.uid,De));const pt=(Y==null?void 0:Y.shopId)||Xe;pt&&je.push(Ka(ha(ut,"dashboardData",pt),{cashBalance:He}).catch(()=>{}));try{window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:He}}))}catch{}const At=((E.price??0)-(E.wholesalePrice??0))*(E.quantity??0);Xa(et=>et-Ne),Nt(et=>et-At),Ge(et=>et-At)}catch(Ne){console.warn("تعذر عكس رصيد الدرج النقدي عند حذف الإيصال:",Ne)}try{if(E.cartItems&&E.cartItems.length>0){const Ne=[];for(const se of E.cartItems){const Ee=Me.find(ve=>ve.id===se.productId||ve.name===se.productName);if(Ee){const ve=(Ee.quantity||0)+(se.quantity||0);Ne.push({id:Ee.id,qty:ve}),je.push(Ka(ha(ut,"products",Ee.id),{quantity:ve,updatedAt:Aa()}))}}ft(se=>se.map(Ee=>{const ve=Ne.find(He=>He.id===Ee.id);return ve?{...Ee,quantity:ve.qty}:Ee}))}else{const Ne=Me.find(se=>E.barcode&&se.barcode===E.barcode||se.name===E.productName);if(Ne){const se=(Ne.quantity||0)+(E.quantity||0);ft(Ee=>Ee.map(ve=>ve.id===Ne.id?{...ve,quantity:se}:ve)),je.push(Ka(ha(ut,"products",Ne.id),{quantity:se,updatedAt:Aa()}))}}}catch(Ne){console.warn("تعذر عكس المخزون عند حذف الإيصال:",Ne)}try{je.push((async()=>{try{if(E.transactionReference){const se=ir(Kt(ut,"userTransactions"),_t("userId","==",A.uid),_t("reference","==",E.transactionReference)),Ee=await Or(se);await Promise.all(Ee.docs.map(ve=>Ti(ve.ref)))}else{const se=(E.price??0)*(E.quantity??0),Ee=E.createdAtMs||new Date(E.date+"T"+(E.time||"00:00")).getTime(),ve=Ee-6e4*2,He=Ee+6e4*2,ke=ir(Kt(ut,"userTransactions"),_t("userId","==",A.uid),_t("type","==","sales"),_t("saleProductName","==",E.productName),_t("amount","==",se)),pt=(await Or(ke)).docs.filter(At=>{var tr,Ot,Qt;const et=At.data(),kt=((Qt=(Ot=(tr=et.createdAt)==null?void 0:tr.toDate)==null?void 0:Ot.call(tr))==null?void 0:Qt.getTime())||new Date(et.createdAt).getTime();return kt>=ve&&kt<=He});await Promise.all(pt.map(At=>Ti(At.ref)))}}catch(se){console.warn("Failed to delete from userTransactions",se)}})());const Ne=async()=>{try{const se=ir(Kt(ut,"dailySales"),_t("userId","==",A.uid),_t("clientId","==",E.id)),Ee=await Or(se);await Promise.all(Ee.docs.map(ke=>Ti(ke.ref)));const ve=ir(Kt(ut,"users",A.uid,"dailySales"),_t("clientId","==",E.id)),He=await Or(ve);await Promise.all(He.docs.map(ke=>Ti(ke.ref)))}catch(se){console.warn("تعذر حذف سجل البيع عبر الاستعلام:",se)}};E.firestoreId?(je.push((async()=>{try{await Ti(ha(ut,"dailySales",E.firestoreId))}catch(se){console.warn("Failed to delete from root dailySales by ID, trying fallback...",se),await Ne()}})()),je.push(Ti(ha(ut,"users",A.uid,"dailySales",E.firestoreId)).catch(()=>{}))):je.push(Ne())}catch(Ne){console.warn("تعذر جدولة حذف سجل البيع من Firestore:",Ne)}try{qt||setTimeout(()=>{try{ri()}catch{}},0)}catch{}try{await Promise.allSettled(je)}catch{}Te({title:"تم حذف الإيصال",description:`تم حذف إيصال بيع للمنتج ${E.productName} وتم عكس الآثار`})}catch(P){console.error("Error deleting sale:",P),Te({title:"فشل حذف الإيصال",description:"تعذّر حذف إيصال البيع",variant:"destructive"})}})}},cn=async E=>{try{qr(P=>({...P,[E.id]:"1"})),await Cs(E)}catch(P){console.error("Error selling by barcode:",P)}},so=E=>{if(A!=null&&A.uid){if(ht){Te({title:"غير مسموح في وضع الكاشير",description:"لا يمكن حذف المنتجات أثناء الورديه",variant:"destructive"});return}Zt("تأكيد حذف منتج","لا يمكن حذف المنتجات إلا بإدخال الرقم السري الرئيسي",()=>{a0(E)})}},c0=async()=>{if(!(!Qn||!(A!=null&&A.uid)))try{const{getDoc:E}=await Ac(async()=>{const{getDoc:Ne}=await import("./index-CgV0sHeM.js").then(se=>se.cP);return{getDoc:Ne}},__vite__mapDeps([0,1]),import.meta.url),P=(Y==null?void 0:Y.shopId)||Xe,Z=ha(ut,"products",Qn.id),xe=await E(Z);if(!xe.exists()){Te({title:"غير موجود",description:"هذا المنتج غير موجود أو تم حذفه مسبقاً",variant:"destructive"});return}const Ce=xe.data(),Fe=String((Ce==null?void 0:Ce.userId)||"")===String(A.uid),je=P?String((Ce==null?void 0:Ce.shopId)||"")===String(P):!0;if(!Fe||!je){Te({title:"ممنوع",description:"لا يمكنك حذف منتج لا يخص الحساب الحالي أو هذا المحل",variant:"destructive"});return}await Ti(Z),ft(Ne=>{const se=Ne.filter(Ee=>Ee.id!==Qn.id);try{const Ee=(Y==null?void 0:Y.shopId)||Xe||"main",ve=`shopProducts_${A.uid}_${Ee}`;localStorage.setItem(ve,JSON.stringify(se))}catch(Ee){console.error(Ee)}return se}),Te({title:"تم الحذف",description:`تم حذف المنتج ${Qn.name}`})}catch(E){console.error("Error deleting product:",E),Te({title:"فشل الحذف",description:"تعذّر حذف المنتج",variant:"destructive"})}finally{a0(null)}},Ai=()=>{if(A!=null&&A.uid){if(ht){Te({title:"غير مسموح",description:"لا يمكن حذف المنتجات أثناء الوردية",variant:"destructive"});return}if(Me.length===0){Te({title:"تنبيه",description:"لا توجد منتجات لحذفها"});return}Zt("حذف جميع المنتجات","تحذير: سيتم حذف كل المنتجات من المخزون نهائياً. هذا الإجراء لا يمكن التراجع عنه.",()=>{Gi(!0)})}},Jt=async()=>{if(A!=null&&A.uid)try{const{collection:E,query:P,where:Z,getDocs:xe,writeBatch:Ce}=await Ac(async()=>{const{collection:Ee,query:ve,where:He,getDocs:ke,writeBatch:De}=await import("./index-CgV0sHeM.js").then(pt=>pt.cP);return{collection:Ee,query:ve,where:He,getDocs:ke,writeBatch:De}},__vite__mapDeps([0,1]),import.meta.url),Fe=(Y==null?void 0:Y.shopId)||Xe,je=[Z("userId","==",A.uid)];Fe&&je.push(Z("shopId","==",Fe));const Ne=P(E(ut,"products"),...je),se=await xe(Ne);if(!se.empty){let Ee=Ce(ut),ve=0;for(const He of se.docs)Ee.delete(He.ref),ve++,ve%400===0&&(await Ee.commit(),Ee=Ce(ut));ve%400!==0&&await Ee.commit()}ft([]);try{const Ee=(Y==null?void 0:Y.shopId)||Xe||"main",ve=`shopProducts_${A.uid}_${Ee}`,He=`shopProducts_lastSync_${A.uid}_${Ee}`;localStorage.removeItem(ve),localStorage.removeItem(He)}catch(Ee){console.error(Ee)}Te({title:"تم الحذف",description:"تم حذف جميع المنتجات بنجاح"})}catch(E){console.error("Error deleting all products:",E),Te({title:"خطأ",description:"حدث خطأ أثناء حذف المنتجات",variant:"destructive"})}finally{Gi(!1)}},Ss=async()=>{try{if(!(A!=null&&A.uid)){Te({title:"خطأ",description:"غير مسجّل دخول",variant:"destructive"});return}if(ht){Te({title:"غير مسموح في وضع الكاشير",description:"لا يمكن إضافة منتجات أثناء الورديه",variant:"destructive"});return}const E=fe.productName.trim(),P=parseFloat(fe.price),Z=parseFloat(fe.wholesalePrice||"0"),xe=parseInt(fe.quantity);if(!E||isNaN(P)||isNaN(xe)){Te({title:"بيانات غير مكتملة",description:"أدخل اسم المنتج والسعر والكمية",variant:"destructive"});return}const Ce={name:E,sellingPrice:P,wholesalePrice:isNaN(Z)?0:Z,quantity:isNaN(xe)?0:xe,userId:A.uid,createdAt:Aa(),updatedAt:Aa()},Fe=(fe.barcode||"").trim();Fe&&(Ce.barcode=Fe);const je=(fe.serialNumber||"").trim();je&&(Ce.serialNumber=je);const Ne=(fe.supplierName||"").trim();Ne&&(Ce.supplierName=Ne),fe.categoryId&&(Ce.categoryId=fe.categoryId),Y!=null&&Y.shopId?Ce.shopId=Y.shopId:Xe&&(Ce.shopId=Xe);const se=await Is(Kt(ut,"products"),Ce);ft(Ee=>{const He=[{id:se.id,name:E,sellingPrice:P,wholesalePrice:isNaN(Z)?0:Z,quantity:isNaN(xe)?0:xe,barcode:(fe.barcode||"").trim()||void 0,serialNumber:(fe.serialNumber||"").trim()||void 0,supplierName:(fe.supplierName||"").trim()||void 0,categoryId:fe.categoryId,updatedAt:new Date().toISOString(),...Y!=null&&Y.shopId?{shopId:Y.shopId}:Xe?{shopId:Xe}:{}},...Ee];try{const ke=(Y==null?void 0:Y.shopId)||Xe||"main",De=`shopProducts_${A.uid}_${ke}`;localStorage.setItem(De,JSON.stringify(He))}catch(ke){console.error("Failed to persist products locally",ke)}return He}),ot({productName:"",price:"",wholesalePrice:"",quantity:"",barcode:"",serialNumber:"",supplierName:"",categoryId:void 0}),Te({title:"تمت الإضافة",description:`تم إضافة المنتج ${E} بنجاح`})}catch(E){console.error("createProduct error",E),Te({title:"فشل الإضافة",description:"تعذّر إضافة المنتج. حاول مجددًا",variant:"destructive"})}},k=E=>{Le(E),Be({productName:E.name,price:String(E.sellingPrice??""),wholesalePrice:String(E.wholesalePrice??""),quantity:String(E.quantity??""),barcode:E.barcode||"",serialNumber:E.serialNumber||"",supplierName:E.supplierName||"",categoryId:E.categoryId||""}),le(!0)},a=async()=>{try{if(!(A!=null&&A.uid)||!Ze){Te({title:"خطأ",description:"لا يوجد مستخدم أو منتج محدد",variant:"destructive"});return}if(ht){Te({title:"غير مسموح في وضع الكاشير",description:"لا يمكن تعديل المنتجات أثناء الورديه",variant:"destructive"});return}const E=(Pe.productName||"").trim(),P=parseFloat(Pe.price||""),Z=parseFloat(Pe.wholesalePrice||"0"),xe=parseInt(Pe.quantity||"");if(!E||isNaN(P)){Te({title:"بيانات غير مكتملة",description:"أدخل اسم المنتج وسعر البيع",variant:"destructive"});return}const Ce={name:E,sellingPrice:P,wholesalePrice:isNaN(Z)?0:Z,updatedAt:Aa()};isNaN(xe)||(Ce.quantity=xe);const Fe=(Pe.barcode||"").trim();Fe?Ce.barcode=Fe:Ce.barcode="";const je=(Pe.serialNumber||"").trim();je?Ce.serialNumber=je:Ce.serialNumber="";const Ne=(Pe.supplierName||"").trim();Ne?Ce.supplierName=Ne:Ce.supplierName="",Pe.categoryId?Ce.categoryId=Pe.categoryId:Ce.categoryId=null,await Ka(ha(ut,"products",Ze.id),Ce),ft(se=>{const Ee=se.map(ve=>ve.id===Ze.id?{...ve,name:E,sellingPrice:P,wholesalePrice:isNaN(Z)?0:Z,quantity:isNaN(xe)?ve.quantity:xe,barcode:Fe,serialNumber:je,supplierName:Ne,categoryId:Pe.categoryId}:ve);try{const ve=(Y==null?void 0:Y.shopId)||Xe,He=`shopProducts_${A.uid}_${ve}`;localStorage.setItem(He,JSON.stringify(Ee))}catch(ve){console.error("Failed to persist products locally",ve)}return Ee}),le(!1),Le(null),Te({title:"تم الحفظ",description:`تم تعديل المنتج ${E} بنجاح`})}catch(E){console.error("updateProduct error",E),Te({title:"فشل التعديل",description:"تعذّر تعديل المنتج. حاول مجددًا",variant:"destructive"})}},i=async E=>{const P=(E||"").trim();if(!P)return;const Z=Me.find(xe=>(xe.barcode||"")===P);if(!Z){Te({title:"باركود غير معروف",description:"لم يتم العثور على منتج بهذا الباركود"});return}await cn(Z)},o=E=>{const P=Me.find(Z=>Z.barcode===E);P?(Ct(Z=>({...Z,[P.id]:Number(Z[P.id]||0)+1})),Te({title:"تمت الإضافة",description:`تم إضافة ${P.name} للعربة`}),Ga("")):Te({title:"غير موجود",description:"المنتج غير موجود",variant:"destructive"})},l=async()=>{try{const E=ct,P=await Uo.getCameras();if(!P||P.length===0)throw new Error("لا توجد كاميرات متاحة");const xe=(P.find(Ce=>/back|rear|خلف/i.test(Ce.label))||P[P.length-1]).id;ja.current=new Uo("cart-scanner-container"),await ja.current.start(xe,{fps:10,qrbox:{width:250,height:120},formatsToSupport:[E.CODE_128,E.EAN_13,E.EAN_8,E.CODE_39]},Ce=>{o(Ce),f()},()=>{}),mi(!0)}catch(E){console.error("cart scanner start error",E),Te({title:"خطأ",description:"تعذّر تشغيل الكاميرا",variant:"destructive"})}},f=async()=>{try{ja.current&&(await ja.current.stop(),await ja.current.clear(),ja.current=null)}catch(E){console.warn(E)}mi(!1)};Ue.useEffect(()=>{fr||f()},[fr]);const u=()=>{const E=Object.entries(Yt).map(([Ee,ve])=>{const He=Number(ve),ke=Me.find(De=>De.id===Ee);return!ke||!He||He<=0?null:{name:ke.name,qty:He,price:ke.sellingPrice,total:He*ke.sellingPrice}}).filter(Boolean);if(E.length===0){Te({title:"لم يتم اختيار منتجات",description:"اختر منتجات عبر زر + لإضافتها للفاتورة"});return}const P=Ft||(Y==null?void 0:Y.shopName)||(A==null?void 0:A.displayName)||"المحل",Z=br||(Y==null?void 0:Y.phone)||(A==null?void 0:A.phoneNumber)||"",xe=yr||(Y==null?void 0:Y.address)||"",Ce=E.reduce((Ee,ve)=>Ee+ve.total,0),Fe=new Date().toLocaleString("ar-EG"),je=E.map(Ee=>`
        <tr>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;font-size:12px">${Ee.name}</td>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;text-align:center;font-size:12px">${Ee.qty}</td>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;text-align:center;font-size:12px">${Wt(Ee.price)}</td>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;text-align:center;font-weight:bold;font-size:12px">${Wt(Ee.total)}</td>
        </tr>
      `).join(""),Ne=`
      <html>
        <head>
          <meta charset="utf-8" />
          <title>فاتورة</title>
          <style>
            @media print {
                @page { size: 80mm auto; margin: 0; }
                body { width: 80mm; margin: 0; padding: 5px; }
            }
            body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; direction: rtl; padding: 10px; margin: 0; width: 80mm; box-sizing: border-box; }
            .header { text-align: center; margin-bottom: 10px; border-bottom: 2px solid #000; padding-bottom: 5px; }
            .header h2 { margin: 0; font-size: 18px; font-weight: bold; }
            .meta { text-align: center; font-size: 11px; margin-bottom: 3px; color: #333; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
            th { border-bottom: 2px solid #000; font-size: 12px; padding: 4px 2px; text-align: center; }
            .total-section { border-top: 2px solid #000; padding-top: 5px; margin-top: 5px; }
            .total-row { display: flex; justify-content: space-between; font-weight: bold; font-size: 14px; margin-top: 5px; }
            .footer { text-align: center; font-size: 10px; margin-top: 15px; border-top: 1px dotted #ccc; padding-top: 5px; }
          </style>
        </head>
        <body>
          <div class="header">
            <h2>${P}</h2>
            ${xe?`<div class="meta">${xe}</div>`:""}
            ${Z?`<div class="meta">ت: ${Z}</div>`:""}
            <div class="meta">${Fe}</div>
          </div>
          <table>
            <thead>
              <tr>
                <th style="text-align:right">الصنف</th>
                <th>العدد</th>
                <th>سعر</th>
                <th>الإجمالي</th>
              </tr>
            </thead>
            <tbody>
              ${je}
            </tbody>
          </table>
          <div class="total-section">
            <div class="total-row">
                <span>الإجمالي:</span>
                <span>${Wt(Ce)}</span>
            </div>
          </div>
          <div class="footer">شكراً لتعاملكم معنا</div>
        </body>
      </html>
    `,se=window.open("","_blank");se&&(se.document.write(Ne),se.document.close(),se.focus(),setTimeout(()=>{se.print(),se.close()},500))},[x,p]=Ue.useState(0),[y,b]=Ue.useState(0),[I,R]=Ue.useState(0),[G,Q]=Ue.useState(0),[re,de]=Ue.useState(!1),[Ae,qe]=Ue.useState(!1),[Je,Ge]=Ue.useState(0),Gt=()=>new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(new Date),Dt=async()=>{if(!(A!=null&&A.uid))return 0;const E=Gt(),P=new Date().toISOString().split("T")[0],Z=Ya(),xe=Xe||(Y==null?void 0:Y.shopId)||null;let Ce=0;try{const Fe=ir(Kt(ut,"dailySales"),_t("userId","==",A.uid),...xe?[_t("shopId","==",xe)]:[]),je=await Or(Fe),Ne=[];je.forEach(ve=>{Ne.push({id:ve.id,data:ve.data()})}),(await Or(Kt(ut,"users",A.uid,"dailySales"))).forEach(ve=>{const He=ve.data();xe&&He.shopId&&He.shopId!==xe||Ne.push({id:ve.id,data:He})});const Ee=new Map;Ne.forEach(ve=>{const He=String(ve.data.clientId||ve.id);Ee.has(He)||Ee.set(He,ve)}),Ee.forEach(({data:ve})=>{const He=String(ve.date||"").slice(0,10);if(!ve.isDeferred&&(He===E||He===P||He===Z)){const ke=Number(ve.quantity||1),De=Number(ve.profit??(Number(ve.sellingPrice||0)-Number(ve.wholesalePrice||0))*ke);Ce+=De}})}catch(Fe){console.warn("تعذر جلب أرباح المبيعات اليومية للملخص:",Fe)}return Math.round(Ce*100)/100};Ue.useEffect(()=>{!e||!(A!=null&&A.uid)||(async()=>{try{Ge(await Dt())}catch{}})()},[e,A==null?void 0:A.uid,Xe,c]);const la=()=>{const E=Xe||(Y==null?void 0:Y.shopId)||"main",P=(A==null?void 0:A.uid)||"guest";return{daily:`dailyOffset_${P}_${E}_${c}`,monthly:`monthlyOffset_${P}_${E}_${h}`}};Ue.useEffect(()=>{if(!(A!=null&&A.uid))return;const E=la(),P=Xe||(Y==null?void 0:Y.shopId)||"main",Z=(A==null?void 0:A.uid)||"guest";try{let xe=localStorage.getItem(E.daily);if(!xe&&P!=="main"&&(xe=localStorage.getItem(`dailyOffset_${Z}_main_${c}`)),xe){const{sales:Fe,profit:je}=JSON.parse(xe);p(Number(Fe)||0),b(Number(je)||0)}else de(!0),p(0),b(0);let Ce=localStorage.getItem(E.monthly);if(!Ce&&P!=="main"&&(Ce=localStorage.getItem(`monthlyOffset_${Z}_main_${h}`)),Ce){const{sales:Fe,profit:je}=JSON.parse(Ce);R(Number(Fe)||0),Q(Number(je)||0)}else qe(!0),R(0),Q(0)}catch(xe){console.error("Failed to load offsets",xe)}},[A==null?void 0:A.uid,Xe,Y==null?void 0:Y.shopId,e,c,h]);const Ra=(E,P)=>{const Z=la();localStorage.setItem(Z.daily,JSON.stringify({sales:E,profit:P}))},fa=(E,P)=>{const Z=la();localStorage.setItem(Z.monthly,JSON.stringify({sales:E,profit:P}))};Ue.useEffect(()=>{if(e&&re){const E=j.filter(Z=>!Z.isDeferred&&Z.date===c).reduce((Z,xe)=>Z+xe.price*xe.quantity,0),P=j.filter(Z=>!Z.isDeferred&&Z.date===c).reduce((Z,xe)=>Z+(xe.price-(xe.wholesalePrice??0))*xe.quantity,0);p(E),b(P),Ra(E,P),de(!1)}},[e,re,j]),Ue.useEffect(()=>{e&&Ae&&(R(Jr),Q(It),fa(Jr,It),qe(!1))},[e,Ae,Jr,It]);const dr=()=>{Zt("بدء وردية جديدة (تصفير العرض)","هل تريد تصفير عدادات اليوم وبدء جلسة جديدة؟ (لن يتم حذف البيانات من السجل)",async()=>{try{const E=j.filter(Z=>!Z.isDeferred&&Z.date===c).reduce((Z,xe)=>Z+xe.price*xe.quantity,0),P=j.filter(Z=>!Z.isDeferred&&Z.date===c).reduce((Z,xe)=>Z+(xe.price-(xe.wholesalePrice??0))*xe.quantity,0);p(E),b(P),Ra(E,P),Te({title:"تم التصفير",description:"تم تصفير عدادات اليوم بنجاح (بياناتك آمنة في السجل)"})}catch(E){console.error(E),Te({title:"خطأ",description:"حدث خطأ أثناء التصفير",variant:"destructive"})}})},Fr=()=>{Zt("إخفاء ملخص الشهر","هل تريد تصفير عدادات الشهر مؤقتاً؟ (لن يتم حذف البيانات من السجل)",async()=>{try{R(Jr),Q(It),fa(Jr,It),Te({title:"تم التصفير",description:"تم تصفير عدادات الشهر مؤقتاً"})}catch(E){console.error(E),Te({title:"خطأ",description:"حدث خطأ أثناء تصفير الشهر",variant:"destructive"})}})},Ma=async E=>{if(A!=null&&A.uid)try{const P=Xe||(Y==null?void 0:Y.shopId)||null,Z=Ya(),xe=new Date().toISOString().split("T")[0],Ce=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(new Date),Fe=new Date,je=new Date(Fe.getFullYear(),Fe.getMonth(),1),Ne=new Date(Fe.getFullYear(),Fe.getMonth()+1,0),se=je.toISOString().split("T")[0],Ee=Ne.toISOString().split("T")[0],ve=Ot=>Ot?E==="day"?Ot===Ce||Ot===xe||Ot===Z:Ot>=se&&Ot<=Ee:!1,{writeBatch:He}=await Ac(async()=>{const{writeBatch:Ot}=await import("./index-CgV0sHeM.js").then(Qt=>Qt.cP);return{writeBatch:Ot}},__vite__mapDeps([0,1]),import.meta.url),ke=He(ut),De=ir(Kt(ut,"dailySales"),_t("userId","==",A.uid),...P?[_t("shopId","==",P)]:[]);(await Or(De)).docs.forEach(Ot=>{var Xt;const Qt=String(((Xt=Ot.data())==null?void 0:Xt.date)||"").slice(0,10);ve(Qt)&&ke.delete(Ot.ref)});const At=ir(Kt(ut,"users",A.uid,"dailySales"),...P?[_t("shopId","==",P)]:[]);(await Or(At)).docs.forEach(Ot=>{var Xt;const Qt=String(((Xt=Ot.data())==null?void 0:Xt.date)||"").slice(0,10);ve(Qt)&&ke.delete(Ot.ref)}),await ke.commit();const kt=Ot=>{const Qt=String(Ot.date||"").slice(0,10);return!ve(Qt)},tr=(j||[]).filter(kt);Xi(tr);try{const Ot=Xe||(Y==null?void 0:Y.shopId)||"main",Qt=`salesData_all_${A==null?void 0:A.uid}_${Ot}`,Xt=localStorage.getItem(Qt);if(Xt){const Pr=JSON.parse(Xt).filter(Xr=>{const bi=String((Xr==null?void 0:Xr.date)||"").slice(0,10);return!ve(bi)});localStorage.setItem(Qt,JSON.stringify(Pr))}}catch{}_e(tr),E==="day"?(p(0),b(0),Ra(0,0)):(R(0),Q(0),fa(0,0));try{await ri()}catch{}Te({title:"تم التصفير النهائي",description:E==="day"?"تم حذف مبيعات اليوم نهائياً":"تم حذف مبيعات الشهر نهائياً"})}catch(P){console.error("Permanent reset failed:",P),Te({title:"فشل التصفير",description:"تعذّر التصفير النهائي لسجلات المبيعات",variant:"destructive"})}};return w.jsxs(En,{open:e,onOpenChange:r,children:[w.jsxs(_n,{className:"max-w-none w-[100vw] h-[100dvh] p-0 overflow-hidden bg-background",children:[w.jsxs("div",{className:"flex flex-col h-full",dir:"rtl",children:[w.jsxs("div",{className:"bg-background dark:bg-card border-b border-border px-3 py-2 flex items-center justify-between shrink-0 z-10 h-14 sm:h-auto",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"bg-primary/10 p-1.5 rounded-full",children:w.jsx(hd,{className:"h-4 w-4 text-primary"})}),w.jsxs("div",{className:"flex flex-col justify-center",children:[w.jsx(An,{className:"text-sm font-bold leading-tight text-foreground",children:"المبيعات والمنتجات"}),w.jsx("p",{className:"text-[10px] text-muted-foreground hidden sm:block leading-none mt-0.5",children:"إدارة عمليات البيع والمخزون"})]})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs(it,{variant:"outline",size:"sm",onClick:()=>C("https://www.youtube.com/watch?v=a8wsEloObOs&t=3s","شرح القسم (فيديو)"),className:"hidden sm:flex h-7 text-[10px] px-2 text-rose-600 border-rose-200 hover:bg-rose-50 dark:border-rose-900/30 dark:text-rose-400 dark:hover:bg-rose-900/20",children:[w.jsx(ld,{className:"h-3 w-3 ml-1.5"}),"شرح القسم (فيديو)"]}),w.jsxs("span",{className:"hidden sm:flex items-center gap-1 h-7 text-[10px] px-2 rounded-full bg-amber-50 text-amber-700 border border-amber-200",children:[w.jsx(_d,{className:"h-3 w-3"}),"الرجاء أخذ نسخة احتياطية من المنتجات المضافة — الشرح موجود في الفيديو"]}),w.jsxs(it,{variant:"outline",size:"sm",onClick:()=>Oa(),className:"hidden sm:flex h-7 text-[10px] px-2 dark:border-gray-700 dark:text-gray-300",children:[w.jsx(ql,{className:"h-3 w-3 ml-1.5"}),"مزامنة"]}),w.jsxs(it,{variant:"outline",size:"sm",onClick:()=>ya(!0),className:"hidden sm:flex h-7 text-[10px] px-2 text-red-600 border-red-200 hover:bg-red-50 dark:border-red-900/30 dark:text-red-400 dark:hover:bg-red-900/20",children:[w.jsx(Ln,{className:"h-3 w-3 ml-1.5"}),"تصفير نهائي"]}),w.jsx(it,{variant:"ghost",size:"icon",onClick:r,className:"rounded-full h-8 w-8 hover:bg-muted",children:w.jsx(f0,{className:"h-4 w-4"})})]})]}),w.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row",children:[w.jsx("div",{className:"w-full md:w-80 bg-muted/30 dark:bg-card/50 border-l dark:border-border flex flex-col shrink-0 order-2 md:order-1",children:w.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin",children:w.jsxs("div",{className:"p-4 space-y-4",children:[w.jsxs(bn,{className:"hidden md:block dark:bg-card dark:border-border",children:[w.jsxs(Zu,{className:"p-4 pb-2 flex flex-row items-center justify-between space-y-0",children:[w.jsxs(Ju,{className:"text-sm font-medium flex items-center gap-2 text-foreground",children:[w.jsx(Fs,{className:"h-4 w-4 text-primary"}),"ملخص اليوم"]}),w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-red-600 dark:hover:text-red-400",onClick:dr,title:"تصفير اليوم",children:w.jsx(Ln,{className:"h-3.5 w-3.5"})})]}),w.jsxs(co,{className:"p-4 pt-2 space-y-3",children:[w.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border dark:border-gray-700",children:[w.jsx("span",{className:"text-sm text-muted-foreground",children:"المبيعات"}),w.jsx("span",{className:"text-lg font-bold text-primary",children:Wt(Math.max(0,j.filter(E=>!E.isDeferred&&E.date===c).reduce((E,P)=>E+P.price*P.quantity,0)-x))})]}),w.jsxs("div",{className:"relative overflow-hidden p-3 bg-emerald-50/50 dark:bg-emerald-950/20 rounded-lg border border-emerald-100 dark:border-emerald-900/50",children:[w.jsxs("div",{className:`flex justify-between items-center ${Ke?"blur-sm":""}`,children:[w.jsx("span",{className:"text-sm text-emerald-700 dark:text-emerald-400",children:"الأرباح"}),w.jsx("span",{className:"text-lg font-bold text-emerald-700 dark:text-emerald-400",children:Wt(Je)})]}),Ke&&w.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 dark:bg-black/50",children:w.jsxs(it,{size:"sm",variant:"outline",onClick:()=>Se(!0),className:"h-7 text-xs bg-white dark:bg-gray-800 dark:border-gray-700",children:[w.jsx(Zl,{className:"h-3 w-3 ml-1"}),"عرض"]})})]})]})]}),w.jsxs(bn,{className:"shadow-none border-none bg-transparent hidden md:block",children:[w.jsxs("div",{className:"flex items-center justify-between w-full p-2",children:[w.jsxs("button",{onClick:()=>dc(!sn),className:"flex items-center gap-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-primary transition-colors",children:[w.jsx(Co,{className:"h-4 w-4"}),"تقارير الشهر",sn?w.jsx(go,{className:"h-4 w-4"}):w.jsx(od,{className:"h-4 w-4"})]}),w.jsx(it,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-red-600 dark:hover:text-red-400",onClick:Fr,title:"تصفير الشهر",children:w.jsx(Ln,{className:"h-3.5 w-3.5"})})]}),!sn&&w.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 animate-in slide-in-from-top-2",children:w.jsxs("div",{className:"col-span-2 relative",children:[w.jsxs("div",{className:`grid grid-cols-2 gap-2 ${qt?"blur-md select-none":""}`,children:[w.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-950/20 p-3 rounded-xl border border-indigo-100 dark:border-indigo-900/50 text-center relative overflow-hidden group",children:[w.jsxs("div",{className:"flex justify-center items-center relative",children:[w.jsx("span",{className:"text-[10px] text-indigo-600 dark:text-indigo-400 block mb-1",children:"المبيعات"}),!qt&&w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 absolute -left-2 top-0 text-indigo-400 hover:text-red-600 hover:bg-white/50 rounded-full z-20",onClick:Fr,title:"تصفير الشهر",children:w.jsx(Ln,{className:"h-3.5 w-3.5"})})]}),w.jsx("span",{className:"text-sm font-bold text-indigo-700 dark:text-indigo-300",children:Wt(Math.max(0,Jr-I))})]}),w.jsxs("div",{className:"bg-pink-50 dark:bg-pink-950/20 p-3 rounded-xl border border-pink-100 dark:border-pink-900/50 text-center relative overflow-hidden group",children:[w.jsxs("div",{className:"flex justify-center items-center relative",children:[w.jsx("span",{className:"text-[10px] text-pink-600 dark:text-pink-400 block mb-1",children:"الأرباح"}),!qt&&w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 absolute -left-2 top-0 text-pink-400 hover:text-red-600 hover:bg-white/50 rounded-full z-20",onClick:Fr,title:"تصفير الشهر",children:w.jsx(Ln,{className:"h-3.5 w-3.5"})})]}),w.jsx("span",{className:"text-sm font-bold text-pink-700 dark:text-pink-300",children:Wt(Math.max(0,It-G))})]})]}),qt&&w.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/20 dark:bg-black/20 backdrop-blur-[2px]",children:w.jsx(it,{"aria-label":"عرض",variant:"ghost",size:"icon",onClick:()=>Yn(!0),className:"rounded-full h-8 w-8 bg-white/80 dark:bg-black/50 backdrop-blur-sm shadow hover:bg-white dark:hover:bg-black/70",children:w.jsx(ks,{className:"h-4 w-4 text-indigo-700 dark:text-indigo-400"})})})]})})]}),w.jsxs(bn,{className:"shadow-none border-none bg-transparent hidden md:block mt-2 relative",children:[w.jsxs("div",{className:`bg-amber-50 dark:bg-amber-950/20 p-3 rounded-xl border border-amber-100 dark:border-amber-900/50 text-center relative overflow-hidden ${qt?"blur-md select-none":""}`,children:[w.jsxs("div",{className:"flex justify-between items-start mb-1",children:[w.jsx("span",{className:"text-[10px] text-amber-600 dark:text-amber-400",children:"إجمالي المخزون (جملة)"}),!qt&&w.jsx(it,{variant:"ghost",size:"icon",className:"h-4 w-4 text-amber-600/50 hover:text-red-600 -mt-1 -mr-1",onClick:ia,title:"تصفير المخزون",children:w.jsx(Ln,{className:"h-3 w-3"})})]}),w.jsx("span",{className:"text-sm font-bold text-amber-700 dark:text-amber-300",children:Wt(Math.max(0,Me.reduce((E,P)=>E+(Number(P.wholesalePrice)||0)*(Number(P.quantity)||0),0)-Et))})]}),qt&&w.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/20 dark:bg-black/20 backdrop-blur-[2px]",children:w.jsx(it,{"aria-label":"عرض",variant:"ghost",size:"icon",onClick:()=>Yn(!0),className:"rounded-full h-8 w-8 bg-white/80 dark:bg-black/50 backdrop-blur-sm shadow hover:bg-white dark:hover:bg-black/70",children:w.jsx(ks,{className:"h-4 w-4 text-amber-700 dark:text-amber-400"})})})]}),w.jsx(xo,{className:"hidden md:block"})]})})}),w.jsx(mo,{open:$r,onOpenChange:ya,children:w.jsxs(po,{children:[w.jsxs(wo,{children:[w.jsx(vo,{children:"تصفير المبيعات"}),w.jsx(yo,{children:"اختر النطاق الذي تريد تصفيره نهائياً"})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsx(lr,{className:"text-sm",children:"النطاق"}),w.jsxs(Tc,{value:Z0,onValueChange:E=>Js(E),children:[w.jsx(Nc,{children:w.jsx(kc,{placeholder:"اختر النطاق"})}),w.jsxs(Ic,{children:[w.jsx(Ds,{value:"day",children:"مبيعات اليوم"}),w.jsx(Ds,{value:"month",children:"مبيعات الشهر"})]})]}),w.jsx("div",{className:"text-xs text-red-600 bg-red-50 border border-red-200 rounded p-2",children:"تحذير: سيتم حذف سجلات المبيعات نهائياً للنطاق المختار ولا يمكن التراجع."})]}),w.jsxs(Eo,{children:[w.jsx(_o,{children:"إلغاء"}),w.jsx(Ao,{onClick:()=>{Zt("تأكيد التصفير النهائي","أدخل الرقم السري الرئيسي لتأكيد الحذف النهائي لسجلات المبيعات",async()=>{await Ma(Z0),ya(!1)})},className:"bg-red-600 hover:bg-red-700 text-white",children:"تصفير نهائي"})]})]})}),w.jsx("div",{className:"flex-1 overflow-hidden flex flex-col order-1 md:order-2 bg-background dark:bg-background",children:w.jsxs(id,{defaultValue:"products",className:"flex-1 flex flex-col overflow-hidden",children:[w.jsxs("div",{className:"px-2 py-1.5 bg-gray-50 dark:bg-card border-b border-dashed border-gray-300/60 dark:border-gray-700 flex items-center justify-between shrink-0",children:[w.jsxs(sd,{className:"h-8 dark:bg-gray-800",children:[w.jsx(bc,{value:"products",className:"text-xs px-2 sm:px-3 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 dark:text-gray-300 dark:data-[state=active]:text-white",children:"المنتجات والبيع"}),w.jsx(bc,{value:"categories",className:"text-xs px-2 sm:px-3 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 dark:text-gray-300 dark:data-[state=active]:text-white",children:"الاقسام"}),w.jsxs(bc,{value:"sales-log",className:"text-xs px-2 sm:px-3 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 dark:text-gray-300 dark:data-[state=active]:text-white",children:["سجل المبيعات",w.jsx(ii,{variant:"secondary",className:"mr-2 h-5 px-1.5 text-[10px] hidden sm:inline-flex dark:bg-gray-600 dark:text-white",children:j.filter(E=>!E.isDeferred).length})]})]}),w.jsxs(it,{variant:"ghost",size:"sm",className:"md:hidden text-xs h-8 px-2 bg-white/50 dark:bg-gray-800/50 border dark:border-gray-700 mr-1 text-primary dark:text-primary-foreground",onClick:()=>Qr(!0),children:[w.jsx(yc,{className:"h-3 w-3 ml-1"}),"تفاصيل اليوم"]}),w.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 font-mono",dir:"ltr",children:[w.jsx("span",{className:"hidden sm:inline",children:new Date().toLocaleDateString("ar-EG")}),w.jsx(lo,{className:"h-3.5 w-3.5 text-gray-400"})]})]}),w.jsx(Cc,{value:"products",className:"flex-1 p-0 m-0 overflow-hidden h-full relative",children:w.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-thin",children:w.jsxs("div",{className:"p-4 space-y-4",children:[w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.jsxs(bn,{className:"border-dashed border-2 border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 transition-all bg-gray-50/30 dark:bg-gray-900/30 overflow-hidden",children:[w.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",onClick:()=>K(!mt),children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"bg-emerald-100 dark:bg-emerald-900/30 p-2 rounded-full",children:w.jsx(si,{className:"h-5 w-5 text-emerald-600 dark:text-emerald-400"})}),w.jsxs("div",{className:"text-right",children:[w.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:"إضافة منتج جديد"}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"تسجيل منتج جديد في المخزون"})]})]}),w.jsx(it,{variant:"ghost",size:"sm",className:"rounded-full h-8 w-8 p-0",children:w.jsx(go,{className:`h-5 w-5 text-gray-400 transition-transform duration-200 ${mt?"rotate-180":""}`})})]}),mt&&w.jsxs("div",{className:"px-4 pb-4 pt-0 animate-in slide-in-from-top-2",children:[w.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent mb-4 opacity-50"}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(lr,{className:"text-xs font-medium text-gray-700",children:["اسم المنتج ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(er,{value:fe.productName,onChange:E=>ot(P=>({...P,productName:E.target.value})),className:"h-9 bg-white",placeholder:"مثال: شاحن آيفون أصلي"})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(lr,{className:"text-xs font-medium text-gray-700",children:["سعر البيع ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(er,{type:"number",value:fe.price,onChange:E=>ot(P=>({...P,price:E.target.value})),className:"h-9 bg-white",placeholder:"0.00"})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(lr,{className:"text-xs font-medium text-gray-700",children:"سعر الجملة"}),w.jsx(er,{type:"number",value:fe.wholesalePrice||"",onChange:E=>ot(P=>({...P,wholesalePrice:E.target.value})),className:"h-9 bg-white",placeholder:"0.00"})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(lr,{className:"text-xs font-medium text-gray-700",children:["الكمية ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(er,{type:"number",value:fe.quantity,onChange:E=>ot(P=>({...P,quantity:E.target.value})),className:"h-9 bg-white",placeholder:"1"})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(lr,{className:"text-xs font-medium text-gray-700",children:"الباركود (اختياري)"}),w.jsxs("div",{className:"relative",children:[w.jsx(er,{value:fe.barcode||"",onChange:E=>ot(P=>({...P,barcode:E.target.value})),className:"h-9 bg-white pl-8",placeholder:"Scan..."}),w.jsx("button",{type:"button",onClick:()=>{Ie(!0),we(""),ze()},title:"مسح الباركود بالكاميرا",className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-7 w-7 rounded hover:bg-gray-100 flex items-center justify-center",children:w.jsx(g0,{className:"h-4 w-4 text-gray-600"})})]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mt-2",children:[w.jsxs(it,{variant:"outline",size:"sm",onClick:B,title:"إنشاء باركود","aria-label":"إنشاء باركود",className:"h-9 w-full bg-white flex items-center justify-center",children:[w.jsx(ud,{className:"h-4 w-4"}),w.jsx("span",{className:"sr-only",children:"إنشاء باركود"})]}),w.jsxs(it,{variant:"secondary",size:"sm",onClick:z,title:"طباعة الباركود","aria-label":"طباعة الباركود",className:"h-9 w-full bg-white flex items-center justify-center",disabled:an||!(vn||zn),children:[w.jsx(dd,{className:"h-4 w-4"}),w.jsx("span",{className:"sr-only",children:"طباعة الباركود"})]})]}),w.jsx("div",{className:"mt-2",children:me?w.jsxs("div",{className:"bg-white border rounded p-2",children:[w.jsx("div",{id:We,className:"w-full h-[220px]"}),ue&&w.jsx("div",{className:"text-[11px] text-red-600 text-center mt-1",children:ue}),w.jsx("div",{className:"flex justify-end gap-2 mt-2",children:w.jsxs(it,{size:"sm",variant:"outline",onClick:Ye,title:"إيقاف الماسح","aria-label":"إيقاف الماسح",children:[w.jsx(f0,{className:"h-4 w-4"}),w.jsx("span",{className:"sr-only",children:"إيقاف الماسح"})]})})]}):an?w.jsx("div",{className:"text-[11px] text-gray-500 text-center",children:"جاري إنشاء المعاينة..."}):vn||zn?w.jsx("img",{src:vn||zn,alt:"barcode",className:"w-full max-w-xs h-[70px] mx-auto bg-white rounded border"}):w.jsx("div",{className:"text-[11px] text-gray-500 text-center",children:"لا توجد معاينة بعد"})})]})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(lr,{className:"text-xs font-medium text-gray-700",children:"القسم (اختياري)"}),w.jsxs(Tc,{value:fe.categoryId||"none",onValueChange:E=>ot(P=>({...P,categoryId:E==="none"?void 0:E})),children:[w.jsx(Nc,{className:"h-9 bg-white text-right",dir:"rtl",children:w.jsx(kc,{placeholder:"اختر القسم"})}),w.jsxs(Ic,{children:[w.jsx(Ds,{value:"none",children:"بدون قسم"}),t0.map(E=>w.jsx(Ds,{value:E.id,children:E.name},E.id))]})]})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(lr,{className:"text-xs font-medium text-gray-700",children:"اسم المورد (اختياري)"}),w.jsx(er,{value:fe.supplierName||"",onChange:E=>ot(P=>({...P,supplierName:E.target.value})),className:"h-9 bg-white",placeholder:"مثال: شركة إلكترونيات"})]}),w.jsx("div",{className:"col-span-1 md:col-span-2 flex items-end",children:w.jsxs(it,{className:"w-full h-9 bg-emerald-600 hover:bg-emerald-700 text-white shadow-sm",onClick:()=>{if(ht){Te({title:"غير مسموح",description:"لا يمكن إضافة منتج أثناء الوردية",variant:"destructive"});return}Zt("إضافة منتج","أدخل الرقم السري للمتابعة",Ss)},children:[w.jsx(si,{className:"h-4 w-4 ml-2"}),"حفظ المنتج الجديد"]})})]})]})]}),w.jsxs(bn,{className:"border-dashed border-2 border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 transition-all bg-gray-50/30 dark:bg-gray-900/30 overflow-hidden",children:[w.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",onClick:()=>Dn(!jr),children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"bg-indigo-100 dark:bg-indigo-900/30 p-2 rounded-full",children:w.jsx(Fs,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),w.jsxs("div",{className:"text-right",children:[w.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:"بيع منتج فوري (غير مسجل)"}),w.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"أدخل بيانات المنتج الآن وسيتم البيع بدون إضافته للمخزون"})]})]}),w.jsx(it,{variant:"ghost",size:"sm",className:"rounded-full h-8 w-8 p-0",children:w.jsx(go,{className:`h-5 w-5 text-gray-400 transition-transform duration-200 ${jr?"rotate-180":""}`})})]}),jr&&w.jsxs("div",{className:"px-4 pb-4 pt-0 animate-in slide-in-from-top-2",children:[w.jsx("div",{className:"h-px bg-gray-200 mb-4"}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(lr,{className:"text-xs font-medium text-gray-700",children:["اسم المنتج ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(er,{value:na.productName,onChange:E=>Zr(P=>({...P,productName:E.target.value})),className:"h-9 bg-white",placeholder:"مثال: منتج خاص"})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(lr,{className:"text-xs font-medium text-gray-700",children:["سعر البيع ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(er,{type:"number",value:na.price,onChange:E=>Zr(P=>({...P,price:E.target.value})),className:"h-9 bg-white dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100",placeholder:"0.00"})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(lr,{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"سعر الجملة (اختياري)"}),w.jsx(er,{type:"number",value:na.wholesalePrice||"",onChange:E=>Zr(P=>({...P,wholesalePrice:E.target.value})),className:"h-9 bg-white dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100",placeholder:"0.00"})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsxs(lr,{className:"text-xs font-medium text-gray-700",children:["الكمية ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(er,{type:"number",value:na.quantity,onChange:E=>Zr(P=>({...P,quantity:E.target.value})),className:"h-9 bg-white",placeholder:"1"})]}),w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(lr,{className:"text-xs font-medium text-gray-700",children:"الباركود (اختياري)"}),w.jsxs("div",{className:"relative",children:[w.jsx(er,{value:na.barcode||"",onChange:E=>Zr(P=>({...P,barcode:E.target.value})),className:"h-9 bg-white pl-8",placeholder:"Scan..."}),w.jsx(g0,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400"})]})]})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[w.jsxs("div",{className:"space-y-1.5",children:[w.jsx(lr,{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"الرقم التسلسلي (اختياري)"}),w.jsx(er,{value:na.serialNumber||"",onChange:E=>Zr(P=>({...P,serialNumber:E.target.value})),className:"h-9 bg-white dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100",placeholder:"SN..."})]}),w.jsx("div",{className:"flex items-end",children:w.jsxs(it,{className:"w-full h-9 bg-indigo-600 hover:bg-indigo-700 text-white shadow-sm",onClick:o0,children:[w.jsx(Fs,{className:"h-4 w-4 ml-2"}),"بيع الآن"]})})]})]})]})]})]}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-stretch sm:items-center justify-between bg-white p-2 rounded-xl border border-gray-100 shadow-sm",children:[w.jsxs("div",{className:"relative flex-1 w-full sm:max-w-md group",children:[w.jsx(Sc,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-primary transition-colors"}),w.jsx(er,{value:Mr,onChange:E=>n0(E.target.value),placeholder:"بحث عن منتج بالاسم...",className:"pl-3 pr-9 h-10 border-0 bg-transparent focus-visible:ring-0 placeholder:text-gray-400"})]}),w.jsx("div",{className:"h-8 w-px bg-gray-200 hidden sm:block"}),w.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[w.jsxs("div",{className:"relative flex-1 sm:w-48 group",children:[w.jsx(g0,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-primary transition-colors"}),w.jsx(er,{value:ga,onChange:E=>Rr(E.target.value),onKeyDown:async E=>{E.key==="Enter"&&ga.trim()&&(await i(ga.trim()),Rr(""))},placeholder:"ماسح الباركود...",className:"pr-9 h-9 bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 focus:bg-white dark:focus:bg-gray-950 transition-all text-sm dark:text-gray-100"})]}),w.jsxs("div",{className:"flex items-center gap-1 border-r dark:border-gray-700 pr-2 mr-1",children:[w.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:pc,className:"hidden",id:"excel-upload",disabled:ht}),w.jsx("label",{htmlFor:"excel-upload",children:w.jsx(it,{variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-full cursor-pointer",asChild:!0,disabled:ht,children:w.jsx("span",{children:w.jsx(yd,{className:"h-4 w-4"})})})}),w.jsx(it,{variant:"ghost",size:"icon",onClick:on,className:"h-9 w-9 shrink-0 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-full",title:"تصدير لملف Excel",children:w.jsx(wd,{className:"h-4 w-4"})}),w.jsxs(it,{variant:"ghost",size:"icon",onClick:()=>ca(!0),className:"h-9 w-9 shrink-0 transition-all rounded-full text-gray-500 hover:text-primary hover:bg-primary/10 relative",title:"عربة المبيعات",children:[w.jsx(hf,{className:"h-4 w-4"}),ji>0&&w.jsx("span",{className:"absolute -top-2 -right-2 bg-red-600 text-white text-[10px] font-bold rounded-full h-5 w-5 flex items-center justify-center border-2 border-white shadow-sm",children:ji})]}),w.jsx(it,{variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-full",title:"حذف جميع المنتجات نهائياً",onClick:Ai,disabled:ht||Me.length===0,children:w.jsx(Zi,{className:"h-4 w-4"})}),w.jsxs($l,{children:[w.jsx(ef,{asChild:!0,children:w.jsx(it,{variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-full",title:"خيارات إضافية",children:w.jsx(ff,{className:"h-4 w-4"})})}),w.jsx(tf,{align:"end",className:"w-48",children:w.jsxs(u0,{onClick:Ai,className:"text-red-600 focus:text-red-700 focus:bg-red-50 dark:focus:bg-red-950/30 cursor-pointer",children:[w.jsx(Zi,{className:"h-4 w-4 ml-2"}),"حذف جميع المنتجات"]})})]})]})]})]}),w.jsx("div",{className:"space-y-4",children:_i.length===0?w.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 bg-white rounded-xl border border-dashed border-gray-200 text-center shadow-sm",children:[w.jsx("div",{className:"bg-gray-50 p-4 rounded-full mb-4",children:w.jsx(rf,{className:"h-10 w-10 text-gray-300"})}),w.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"لا توجد منتجات"}),w.jsx("p",{className:"text-gray-500 text-sm max-w-xs mx-auto mb-4",children:"لم يتم العثور على منتجات تطابق بحثك."}),w.jsxs(it,{variant:"outline",onClick:()=>K(!0),className:"gap-2",children:[w.jsx(si,{className:"h-4 w-4"}),"إضافة منتج جديد"]})]}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"hidden md:block bg-[#fcf9f2] dark:bg-card rounded-xl border border-gray-100 dark:border-border shadow-sm overflow-hidden",children:w.jsxs(fo,{children:[w.jsx(ho,{className:"bg-gray-50/80 dark:bg-gray-900/80",children:w.jsxs(Ni,{className:"hover:bg-transparent border-gray-100 dark:border-gray-800",children:[w.jsx(pr,{className:"text-right h-11 font-semibold text-gray-700 dark:text-gray-300",children:"المنتج"}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-28",children:"السعر"}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-28",children:w.jsxs("div",{className:"flex items-center justify-center gap-1.5 cursor-pointer hover:text-primary transition-colors select-none",onClick:()=>{aa?pi(!1):Zt("عرض سعر الجملة","أدخل الرقم السري الرئيسي لعرض سعر الجملة",()=>pi(!0))},children:[w.jsx("span",{children:"الجملة"}),aa?w.jsx(Qu,{className:"h-3.5 w-3.5"}):w.jsx(ks,{className:"h-3.5 w-3.5"})]})}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-24",children:"الكمية"}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-[360px]",children:"إجراءات البيع"})]})}),w.jsx(uo,{children:_i.map(E=>w.jsxs(Ni,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 transition-colors border-gray-100 dark:border-gray-800",children:[w.jsxs(wr,{className:"font-medium py-3",children:[w.jsx("div",{className:"text-gray-900 dark:text-gray-100 font-bold",children:E.name}),E.barcode&&w.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-gray-500 dark:text-gray-400 font-mono mt-0.5",children:[w.jsx(g0,{className:"h-3 w-3"}),E.barcode]})]}),w.jsx(wr,{className:"text-center py-3",children:w.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-950/30 px-2 py-1 rounded-md",children:Wt(E.sellingPrice)})}),w.jsx(wr,{className:"text-center py-3",children:w.jsx("span",{className:`font-medium text-xs ${aa?"text-gray-600 dark:text-gray-400":"blur-sm select-none text-gray-300 dark:text-gray-600"}`,children:Wt(E.wholesalePrice)})}),w.jsx(wr,{className:"text-center py-3",children:w.jsxs("div",{className:"flex items-center justify-center gap-1",children:[w.jsx(ii,{variant:E.quantity>0?"outline":"destructive",className:`font-mono ${E.quantity>0?"bg-gray-50 dark:bg-gray-900 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700":""}`,children:E.quantity}),w.jsx(it,{size:"icon",variant:"ghost",className:"h-5 w-5 rounded-full text-emerald-600 hover:bg-emerald-50 hover:text-emerald-700",onClick:()=>Ua(E),title:"إضافة مخزون",children:w.jsx(si,{className:"h-3 w-3"})})]})}),w.jsx(wr,{className:"py-3",children:w.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[w.jsxs("div",{className:"relative group",children:[w.jsx(er,{type:"number",className:"h-8 w-14 text-center px-1 text-sm bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 focus:border-primary/50 dark:text-gray-100",placeholder:"0",value:vt[E.id]||"",onChange:P=>qr(Z=>({...Z,[E.id]:P.target.value}))}),w.jsx("span",{className:"absolute -top-2 -right-1 text-[9px] bg-white dark:bg-gray-800 px-0.5 text-gray-400 rounded",children:"العدد"})]}),w.jsxs("div",{className:"relative group",children:[w.jsx(er,{type:"number",className:"h-8 w-16 text-center px-1 bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 focus:border-primary/50 text-sm focus:bg-white dark:focus:bg-gray-950 transition-colors dark:text-gray-100",placeholder:"سعر",value:Ea[E.id]||"",onChange:P=>xt(Z=>({...Z,[E.id]:P.target.value})),title:"سعر بيع مخصص"}),w.jsx("span",{className:"absolute -top-2 -right-1 text-[9px] bg-white dark:bg-gray-800 px-0.5 text-gray-400 rounded",children:"مخصص"})]}),w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsx(it,{size:"sm",className:"h-8 bg-indigo-600 hover:bg-indigo-700 text-white shadow-sm px-3 font-medium",onClick:()=>Cs(E),children:"بيع"}),w.jsxs("div",{className:"flex items-center bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-md overflow-hidden",children:[w.jsx("button",{className:`px-2 h-8 text-[11px] ${(za[E.id]||"cash")==="cash"?"bg-green-50 text-green-700 dark:bg-green-900/30":"text-gray-600 dark:text-gray-300"}`,onClick:()=>nr(P=>({...P,[E.id]:"cash"})),title:"الدفع نقدي",children:"كاش"}),w.jsx("button",{className:`px-2 h-8 text-[11px] border-r border-gray-200 dark:border-gray-700 ${(za[E.id]||"cash")==="visa"?"bg-purple-50 text-purple-700 dark:bg-purple-900/30":"text-gray-600 dark:text-gray-300"}`,onClick:()=>nr(P=>({...P,[E.id]:"visa"})),title:"الدفع بالفيزا",children:"فيزا"})]})]}),w.jsx(it,{size:"icon",variant:"outline",className:"h-8 w-8 rounded-full border-indigo-200 text-indigo-600 hover:bg-indigo-50",onClick:()=>Ct(P=>({...P,[E.id]:Number(P[E.id]||0)+1})),title:"إضافة للفاتورة",children:w.jsx(si,{className:"h-4 w-4"})}),(Yt[E.id]||0)>0&&w.jsx(ii,{variant:"outline",className:"font-mono bg-indigo-50 text-indigo-700 border-indigo-200",children:Yt[E.id]}),w.jsxs($l,{children:[w.jsx(ef,{asChild:!0,children:w.jsx(it,{size:"icon",variant:"ghost",className:"h-8 w-8 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full",children:w.jsx(ff,{className:"h-4 w-4"})})}),w.jsxs(tf,{align:"end",className:"w-40",children:[w.jsxs(u0,{onClick:()=>{ht||Zt("تعديل المنتج","أدخل الرقم السري الرئيسي لتعديل بيانات المنتج",()=>k(E))},disabled:ht,children:[w.jsx(cf,{className:"h-3.5 w-3.5 ml-2 text-blue-600"}),"تعديل المنتج"]}),w.jsxs(u0,{onClick:()=>Ua(E),children:[w.jsx(si,{className:"h-3.5 w-3.5 ml-2 text-emerald-600"}),"إضافة مخزون"]}),w.jsxs(u0,{onClick:()=>{Ei(E),Jn(!0)},children:[w.jsx(lo,{className:"h-3.5 w-3.5 ml-2 text-amber-600"}),"بيع مؤجل"]}),w.jsxs(u0,{onClick:()=>so(E),disabled:ht,className:"text-red-600 focus:text-red-700",children:[w.jsx(Zi,{className:"h-3.5 w-3.5 ml-2"}),"حذف المنتج"]})]})]})]})})]},E.id))})]})}),w.jsx("div",{className:"md:hidden grid grid-cols-1 gap-3",children:_i.map(E=>w.jsx(bn,{className:"overflow-hidden border-gray-100 dark:border-gray-800 shadow-sm hover:shadow-md transition-shadow bg-[#fcf9f2] dark:bg-card",children:w.jsxs(co,{className:"p-4 space-y-4",children:[w.jsxs("div",{className:"flex justify-between items-start",children:[w.jsxs("div",{children:[w.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100 text-base",children:E.name}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[w.jsx(ii,{variant:"secondary",className:"bg-emerald-50 dark:bg-emerald-950/30 text-emerald-700 dark:text-emerald-400 border-emerald-100 dark:border-emerald-900/50",children:Wt(E.sellingPrice)}),w.jsxs("span",{className:`text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1 ${!aa&&"blur-sm select-none"}`,children:[w.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"جملة:"}),Wt(E.wholesalePrice)]}),w.jsx("span",{className:"text-gray-300 dark:text-gray-700",children:"|"}),w.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300 font-medium flex items-center gap-1",children:["متاح: ",E.quantity,w.jsx(it,{size:"icon",variant:"ghost",className:"h-5 w-5 rounded-full text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-950/30",onClick:()=>Ua(E),children:w.jsx(si,{className:"h-3 w-3"})})]})]})]}),w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsx(it,{size:"icon",variant:"ghost",className:"h-8 w-8 -mt-1 -ml-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-950/30 rounded-full",onClick:()=>{ht||Zt("تعديل المنتج","أدخل الرقم السري الرئيسي لتعديل بيانات المنتج",()=>k(E))},disabled:ht,children:w.jsx(cf,{className:"h-4 w-4"})}),w.jsx(it,{size:"icon",variant:"ghost",className:"h-8 w-8 -mt-1 -ml-2 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>so(E),disabled:ht,children:w.jsx(Zi,{className:"h-4 w-4"})})]})]}),w.jsxs("div",{className:"flex items-center gap-2 bg-gray-50/50 dark:bg-gray-800/50 p-2 rounded-lg border border-gray-100 dark:border-gray-700",children:[w.jsxs("div",{className:"relative flex-1",children:[w.jsx(er,{type:"number",className:"h-9 w-full bg-white dark:bg-gray-900 text-center border-gray-200 dark:border-gray-700 focus:border-indigo-300 dark:text-gray-100",placeholder:"الكمية",value:vt[E.id]||"",onChange:P=>qr(Z=>({...Z,[E.id]:P.target.value}))}),w.jsx("span",{className:"absolute inset-y-0 right-2 flex items-center text-[10px] text-gray-400 pointer-events-none",children:"عدد"})]}),w.jsxs("div",{className:"relative w-28",children:[w.jsx(er,{type:"number",className:"h-9 w-full bg-white dark:bg-gray-900 text-center border-gray-200 dark:border-gray-700 focus:border-indigo-300 dark:text-gray-100",placeholder:"سعر مخصص",value:Ea[E.id]||"",onChange:P=>xt(Z=>({...Z,[E.id]:P.target.value}))}),w.jsx("span",{className:"absolute inset-y-0 right-2 flex items-center text-[10px] text-gray-400 pointer-events-none",children:"سعر"})]})]}),w.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[w.jsxs(it,{className:"h-10 bg-indigo-600 text-white hover:bg-indigo-700 shadow-sm font-bold",onClick:()=>Cs(E),children:[w.jsx(Fs,{className:"h-4 w-4 ml-2"}),"بيع فوري"]}),w.jsxs(it,{variant:"outline",className:"h-10 border-amber-200 text-amber-700 bg-amber-50 hover:bg-amber-100 dark:bg-amber-950/30 dark:border-amber-900/50 dark:text-amber-400 font-bold",onClick:()=>{Ei(E),Jn(!0)},children:[w.jsx(lo,{className:"h-4 w-4 ml-2"}),"بيع أجل"]}),w.jsxs(it,{variant:"outline",className:"h-10 border-indigo-200 text-indigo-700 bg-indigo-50 hover:bg-indigo-100 dark:bg-indigo-950/30 dark:border-indigo-900/50 dark:text-indigo-400 font-bold",onClick:()=>Ct(P=>({...P,[E.id]:Number(P[E.id]||0)+1})),title:"إضافة للفاتورة",children:[w.jsx(si,{className:"h-4 w-4 ml-2"}),"إضافة +"]})]}),(Yt[E.id]||0)>0&&w.jsx("div",{className:"pt-3 border-t border-dashed border-gray-200 dark:border-gray-700",children:w.jsxs("div",{className:"text-xs text-indigo-700 dark:text-indigo-400",children:["مضاف للفاتورة: ",Yt[E.id]]})})]})},E.id))})]})})]})})}),w.jsx(Cc,{value:"categories",className:"flex-1 p-0 m-0 overflow-hidden h-full relative",children:w.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-thin bg-gray-50/50 dark:bg-gray-950/50",children:w.jsx("div",{className:"p-4",children:Kn?w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"flex flex-col gap-4",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs(it,{variant:"ghost",size:"sm",onClick:()=>On(null),className:"hover:bg-gray-100 dark:hover:bg-gray-800 dark:text-gray-200",children:[w.jsx(lf,{className:"h-4 w-4 ml-1"}),"رجوع"]}),w.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:Kn.name})]}),w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[w.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-border rounded-xl p-3 shadow-sm flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"bg-indigo-50 dark:bg-indigo-950/30 p-2 rounded-lg",children:w.jsx(rf,{className:"h-4 w-4 text-indigo-600 dark:text-indigo-400"})}),w.jsx("div",{className:"flex items-center justify-end gap-2",children:w.jsxs("div",{className:"flex items-center bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-md overflow-hidden",children:[w.jsx("button",{className:`px-2 h-8 text-[11px] ${(za[product.id]||"cash")==="cash"?"bg-green-50 text-green-700 dark:bg-green-900/30":"text-gray-600 dark:text-gray-300"}`,onClick:()=>nr(E=>({...E,[product.id]:"cash"})),title:"الدفع نقدي",children:"كاش"}),w.jsx("button",{className:`px-2 h-8 text-[11px] border-r border-gray-200 dark:border-gray-700 ${(za[product.id]||"cash")==="visa"?"bg-purple-50 text-purple-700 dark:bg-purple-900/30":"text-gray-600 dark:text-gray-300"}`,onClick:()=>nr(E=>({...E,[product.id]:"visa"})),title:"الدفع بالفيزا",children:"فيزا"})]})}),w.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:"عدد المنتجات"})]}),w.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:Me.filter(E=>E.categoryId===Kn.id).length})]}),w.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-border rounded-xl p-3 shadow-sm flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"bg-amber-50 dark:bg-amber-950/30 p-2 rounded-lg",children:w.jsx(Fs,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),w.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:"إجمالي الجملة (لهذا القسم)"})]}),w.jsx("span",{className:"text-lg font-bold text-amber-700 dark:text-amber-400",children:Wt(Me.filter(E=>E.categoryId===Kn.id).reduce((E,P)=>E+(Number(P.wholesalePrice)||0)*(Number(P.quantity)||0),0))})]})]})]}),w.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:Me.filter(E=>E.categoryId===Kn.id).length===0?w.jsx("div",{className:"col-span-full text-center py-10 text-gray-500 dark:text-gray-400 bg-white dark:bg-card rounded-lg border border-dashed border-gray-300 dark:border-gray-700",children:"لا توجد منتجات في هذا القسم"}):Me.filter(E=>E.categoryId===Kn.id).map(E=>w.jsx(bn,{className:"overflow-hidden hover:shadow-md transition-all group relative bg-white dark:bg-card border-gray-200 dark:border-gray-700 cursor-pointer",onClick:()=>handleAddProductToInvoice(E),children:w.jsxs("div",{className:"p-3",children:[w.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate text-right",title:E.name,children:E.name}),w.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[w.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400",children:Wt(E.sellingPrice)}),w.jsx(ii,{variant:"outline",className:"text-xs dark:text-gray-300 dark:border-gray-600",children:E.quantity})]})]})},E.id))})]}):w.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[w.jsxs(bn,{className:"border-dashed border-2 border-emerald-200 dark:border-emerald-800/50 hover:border-emerald-400 dark:hover:border-emerald-700 hover:bg-emerald-50/50 dark:hover:bg-emerald-950/20 transition-all cursor-pointer flex flex-col items-center justify-center p-6 h-32 group dark:bg-card/50",onClick:()=>qn(!0),children:[w.jsx("div",{className:"bg-emerald-100 dark:bg-emerald-900/30 p-3 rounded-full mb-2 group-hover:scale-110 transition-transform",children:w.jsx(si,{className:"h-6 w-6 text-emerald-600 dark:text-emerald-400"})}),w.jsx("span",{className:"font-semibold text-emerald-700 dark:text-emerald-400",children:"إضافة قسم جديد"})]}),t0.map(E=>w.jsxs(bn,{className:"overflow-hidden hover:shadow-md transition-all h-32 flex flex-col items-center justify-center relative group bg-white dark:bg-card border-gray-100 dark:border-gray-700 cursor-pointer",onClick:()=>On(E),children:[w.jsx("div",{className:"absolute top-2 left-2 z-10",children:w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",onClick:P=>Wi(E.id,P),title:"حذف القسم",children:w.jsx(Zi,{className:"h-4 w-4"})})}),w.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-100 text-center px-2",children:E.name}),w.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[Me.filter(P=>P.categoryId===E.id).length," منتج"]})]},E.id))]})})})}),w.jsx(Cc,{value:"sales-log",className:"flex-1 p-0 m-0 overflow-hidden h-full relative",children:w.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-thin",children:w.jsxs("div",{className:"p-4 space-y-4 min-h-full",children:[w.jsx("div",{className:"md:hidden",children:w.jsxs(it,{variant:"outline",className:"w-full justify-between bg-white dark:bg-card border-dashed border-2 border-gray-200 dark:border-gray-700 h-12 text-gray-700 dark:text-gray-200 hover:text-primary hover:border-primary/50 hover:bg-primary/5 shadow-sm",onClick:()=>Qr(!0),children:[w.jsxs("span",{className:"flex items-center gap-2 font-semibold",children:[w.jsx(yc,{className:"h-4 w-4 text-primary"}),"تفاصيل اليوم"]}),w.jsx("span",{className:"text-xs text-muted-foreground font-normal bg-gray-50 dark:bg-gray-800 px-2 py-1 rounded-full border dark:border-gray-700",children:"اضغط لعرض التقارير"})]})}),w.jsxs("div",{className:"flex flex-wrap items-end gap-2 bg-white dark:bg-card p-3 rounded-lg border border-gray-100 dark:border-gray-700 shadow-sm",children:[w.jsxs("div",{className:"grid gap-1",children:[w.jsx(lr,{className:"text-[10px] text-gray-500 dark:text-gray-400",children:"من تاريخ"}),w.jsxs(af,{children:[w.jsx(nf,{asChild:!0,children:w.jsxs(it,{variant:"outline",className:Jl("h-8 w-[140px] justify-start text-right font-normal text-xs dark:bg-gray-900 dark:border-gray-700 dark:text-gray-200",!he&&"text-muted-foreground"),children:[w.jsx(Co,{className:"ml-2 h-3.5 w-3.5"}),he?bo(new Date(he),"P",{locale:To}):w.jsx("span",{children:"اختر تاريخ"})]})}),w.jsx(sf,{className:"w-auto p-0",align:"start",children:w.jsx(of,{mode:"single",selected:he?new Date(he):void 0,onSelect:E=>te(E?bo(E,"yyyy-MM-dd"):""),initialFocus:!0,locale:To})})]})]}),w.jsxs("div",{className:"grid gap-1",children:[w.jsx(lr,{className:"text-[10px] text-gray-500 dark:text-gray-400",children:"إلى تاريخ"}),w.jsxs(af,{children:[w.jsx(nf,{asChild:!0,children:w.jsxs(it,{variant:"outline",className:Jl("h-8 w-[140px] justify-start text-right font-normal text-xs dark:bg-gray-900 dark:border-gray-700 dark:text-gray-200",!be&&"text-muted-foreground"),children:[w.jsx(Co,{className:"ml-2 h-3.5 w-3.5"}),be?bo(new Date(be),"P",{locale:To}):w.jsx("span",{children:"اختر تاريخ"})]})}),w.jsx(sf,{className:"w-auto p-0",align:"start",children:w.jsx(of,{mode:"single",selected:be?new Date(be):void 0,onSelect:E=>$e(E?bo(E,"yyyy-MM-dd"):""),initialFocus:!0,locale:To})})]})]}),w.jsxs(it,{size:"sm",onClick:ae,className:"h-8 gap-1 bg-indigo-600 hover:bg-indigo-700 text-white",children:[w.jsx(Sc,{className:"h-3.5 w-3.5"}),w.jsx("span",{className:"hidden sm:inline",children:"بحث"})]}),(he||be)&&w.jsx(it,{size:"sm",variant:"ghost",onClick:tt,className:"h-8 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/30",children:"إلغاء"})]}),j.length===0?w.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-12 px-4 bg-[#fcf9f2]/50 dark:bg-card/50 rounded-xl border border-dashed border-gray-200 dark:border-gray-700 text-center",children:[w.jsx("div",{className:"bg-[#fcf9f2] dark:bg-gray-800 p-4 rounded-full shadow-sm mb-4",children:w.jsx(Ec,{className:"h-8 w-8 text-gray-400"})}),w.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-1",children:"لا توجد مبيعات"}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:he||be?"لم يتم العثور على مبيعات في الفترة المحددة.":"لم يتم تسجيل أي عمليات بيع اليوم."})]}):w.jsxs("div",{className:"space-y-4",children:[w.jsx("div",{className:"hidden md:block bg-[#fcf9f2] dark:bg-card rounded-xl border border-gray-100 dark:border-gray-700 shadow-sm overflow-hidden",children:w.jsxs(fo,{children:[w.jsx(ho,{className:"bg-gray-50/80 dark:bg-gray-800",children:w.jsxs(Ni,{className:"hover:bg-transparent",children:[w.jsx(pr,{className:"text-right h-11 font-semibold text-gray-700 dark:text-gray-300",children:"المنتج"}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"السعر"}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"الكمية"}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"الإجمالي"}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"طريقة الدفع"}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"الربح"}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"التاريخ"}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"الوقت"}),w.jsx(pr,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"إجراءات"})]})}),w.jsx(uo,{children:j.map(E=>w.jsxs(Ni,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 transition-colors dark:border-gray-800",children:[w.jsxs(wr,{className:"py-3",children:[w.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[w.jsx("span",{className:E.cartItems&&E.cartItems.length>0?"cursor-pointer hover:text-indigo-600 dark:hover:text-indigo-400 underline-offset-4 hover:underline":"",onClick:()=>E.cartItems&&E.cartItems.length>0&&Lt(E),children:E.productName}),E.cartItems&&E.cartItems.length>0&&w.jsx(it,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 rounded-full hover:bg-indigo-100 dark:hover:bg-indigo-950/30 text-indigo-600 dark:text-indigo-400",onClick:()=>Lt(E),title:"عرض التفاصيل",children:w.jsx(ks,{className:"h-3.5 w-3.5"})})]}),E.isDeferred&&w.jsx(ii,{variant:"secondary",className:"mt-1 text-[10px] bg-amber-100 dark:bg-amber-950/30 text-amber-700 dark:text-amber-400 border-amber-200 dark:border-amber-900/50",children:"مؤجل"})]}),w.jsx(wr,{className:"text-center py-3 text-gray-700 dark:text-gray-300",children:Wt(E.price)}),w.jsx(wr,{className:"text-center py-3",children:w.jsx(ii,{variant:"outline",className:"font-mono bg-gray-50 dark:bg-gray-900 dark:text-gray-300 dark:border-gray-700",children:E.quantity})}),w.jsx(wr,{className:"text-center font-bold text-green-600 dark:text-green-400 py-3",children:Wt(E.price*E.quantity)}),w.jsx(wr,{className:"text-center py-3",children:w.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${(E.paymentMethod||"cash")==="cash"?"bg-green-50 text-green-700":"bg-purple-50 text-purple-700"}`,children:(E.paymentMethod||"cash")==="cash"?"كاش":"فيزا"})}),w.jsx(wr,{className:"text-center text-indigo-600 dark:text-indigo-400 py-3",children:w.jsx("span",{className:aa?"":"blur-sm select-none text-gray-300 dark:text-gray-700",children:Wt(((E.price??0)-(E.wholesalePrice??0))*E.quantity)})}),w.jsx(wr,{className:"text-center text-gray-500 dark:text-gray-400 text-xs py-3 font-mono",children:Wo(E.date)}),w.jsx(wr,{className:"text-center text-gray-500 dark:text-gray-400 text-xs py-3 font-mono",children:E.time}),w.jsx(wr,{className:"py-3",children:w.jsxs("div",{className:"flex justify-center gap-2",children:[E.isDeferred&&w.jsx(it,{size:"sm",variant:"outline",className:"h-8 text-xs border-amber-200 text-amber-700 bg-amber-50 hover:bg-amber-100 dark:bg-amber-950/30 dark:border-amber-900/50 dark:text-amber-400",onClick:()=>Zt("تأكيد سداد بيع مؤجل","أدخل الرقم السري الرئيسي لتأكيد السداد",()=>Yi(E)),children:"سداد"}),w.jsx(it,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>Hi(E,"return"),title:"مرتجع",children:w.jsx(So,{className:"h-4 w-4"})}),w.jsx(it,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>Hi(E,"delete"),title:"حذف نهائي",children:w.jsx(xd,{className:"h-4 w-4"})})]})})]},E.id))})]})}),w.jsx("div",{className:"md:hidden space-y-3",children:j.map(E=>w.jsx(bn,{className:"overflow-hidden border-gray-100 dark:border-gray-700 shadow-sm bg-[#fcf9f2] dark:bg-card",children:w.jsxs(co,{className:"p-4",children:[w.jsxs("div",{className:"flex justify-between items-start mb-3",children:[w.jsxs("div",{children:[w.jsxs("h4",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm flex items-center gap-2",children:[w.jsx("span",{className:E.cartItems&&E.cartItems.length>0?"cursor-pointer hover:text-indigo-600 dark:hover:text-indigo-400 underline-offset-4 hover:underline":"",onClick:()=>E.cartItems&&E.cartItems.length>0&&Lt(E),children:E.productName}),E.cartItems&&E.cartItems.length>0&&w.jsx(it,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 rounded-full hover:bg-indigo-100 dark:hover:bg-indigo-950/30 text-indigo-600 dark:text-indigo-400",onClick:()=>Lt(E),children:w.jsx(ks,{className:"h-3.5 w-3.5"})})]}),w.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 flex items-center gap-2",children:[w.jsx("span",{className:"bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded text-gray-600 dark:text-gray-300 font-mono",children:E.time}),w.jsx("span",{className:"text-gray-400 dark:text-gray-600",children:"|"}),w.jsx("span",{children:Wo(E.date)}),E.isDeferred&&w.jsx(ii,{variant:"outline",className:"text-[10px] bg-amber-50 dark:bg-amber-950/30 text-amber-700 dark:text-amber-400 border-amber-100 dark:border-amber-900/50 px-1.5 py-0 h-5",children:"مؤجل"})]})]}),w.jsxs("div",{className:"text-left",children:[w.jsx("div",{className:"font-bold text-green-600 dark:text-green-400 text-sm",children:Wt(E.price*E.quantity)}),w.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-0.5",children:[E.quantity," × ",Wt(E.price)]}),w.jsx("div",{className:"mt-1",children:w.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-medium ${(E.paymentMethod||"cash")==="cash"?"bg-green-50 text-green-700":"bg-purple-50 text-purple-700"}`,children:(E.paymentMethod||"cash")==="cash"?"كاش":"فيزا"})})]})]}),w.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-50 dark:border-gray-800",children:[E.isDeferred&&w.jsx(it,{size:"sm",variant:"ghost",className:"h-8 text-xs text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-950/30 hover:bg-amber-100 dark:hover:bg-amber-900/50",onClick:()=>Zt("تأكيد سداد بيع مؤجل","أدخل الرقم السري الرئيسي لتأكيد السداد",()=>Yi(E)),children:"تسديد"}),w.jsxs(it,{size:"sm",variant:"ghost",className:"h-8 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-950/30",onClick:()=>Hi(E,"return"),children:[w.jsx(So,{className:"h-3.5 w-3.5 ml-1.5"}),"مرتجع"]}),w.jsx(it,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-gray-400 dark:text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>Hi(E,"delete"),children:w.jsx(Zi,{className:"h-4 w-4"})})]})]})},E.id))})]})]})})})]})})]})]}),w.jsx(it,{variant:"ghost",size:"icon",className:"fixed bottom-6 right-6 h-14 w-14 rounded-full bg-red-600 text-white shadow-lg hover:bg-red-700 hover:scale-105 transition-all duration-300 z-[60] animate-in fade-in zoom-in",onClick:E=>{E.preventDefault(),E.stopPropagation(),r()},children:w.jsx(lf,{className:"h-6 w-6"})})]}),w.jsx(En,{open:fr,onOpenChange:ca,children:w.jsxs(_n,{className:"sm:max-w-md",dir:"rtl",children:[w.jsxs(Ci,{children:[w.jsxs(An,{className:"flex items-center gap-2",children:[w.jsx(hf,{className:"h-5 w-5 text-primary"}),"عربة المبيعات"]}),w.jsx(Si,{className:"text-xs",children:"راجع المنتجات المختارة، عدّل اسم المحل، ثم بع أو اطبع الفاتورة"})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-3 rounded-lg space-y-2 border border-dashed border-gray-200 dark:border-gray-700",children:[w.jsx(lr,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"بيانات الفاتورة (اختياري)"}),w.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[w.jsx(er,{value:Ft,onChange:E=>Qe(E.target.value),placeholder:(Y==null?void 0:Y.shopName)||(A==null?void 0:A.displayName)||"اسم المحل",className:"h-8 text-xs bg-white dark:bg-gray-900"}),w.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[w.jsx(er,{value:br,onChange:E=>or(E.target.value),placeholder:(Y==null?void 0:Y.phone)||"رقم التليفون",className:"h-8 text-xs bg-white dark:bg-gray-900"}),w.jsx(er,{value:yr,onChange:E=>In(E.target.value),placeholder:(Y==null?void 0:Y.address)||"العنوان",className:"h-8 text-xs bg-white dark:bg-gray-900"})]})]})]}),w.jsx(xo,{}),w.jsxs("div",{className:"space-y-2 relative",children:[w.jsx(lr,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"إضافة منتج للفاتورة"}),w.jsxs("div",{className:"flex gap-2 relative",children:[w.jsxs("div",{className:"relative flex-1",children:[w.jsx(Sc,{className:"absolute right-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400"}),w.jsx(er,{value:Rt,onChange:E=>{const P=E.target.value,Z=_r(P);Ga(Z),/^[0-9]+$/.test(Z)&&Me.find(Ce=>String(Ce.barcode||"")===Z)&&o(Z)},onKeyDown:E=>{E.key==="Enter"&&o(_r(Rt))},placeholder:"بحث بالاسم أو الباركود...",className:"h-9 pr-8 text-xs",autoComplete:"off"})]}),w.jsx(it,{size:"icon",variant:"outline",className:"h-9 w-9 shrink-0",onClick:()=>{rn?f():l()},title:rn?"إغلاق الكاميرا":"فتح الكاميرا",children:rn?w.jsx(f0,{className:"h-4 w-4 text-red-500"}):w.jsx(g0,{className:"h-4 w-4"})})]}),rn&&w.jsxs("div",{className:"relative bg-black rounded-lg overflow-hidden border border-gray-200 shadow-sm mt-2",children:[w.jsx("div",{id:"cart-scanner-container",className:"w-full h-[200px]"}),w.jsx(it,{size:"sm",variant:"ghost",className:"absolute top-2 right-2 text-white bg-black/50 hover:bg-black/70 h-6 w-6 p-0 rounded-full",onClick:f,children:w.jsx(f0,{className:"h-3 w-3"})})]}),Rt&&Rt.length>1&&!rn&&w.jsxs("div",{className:"border rounded-md max-h-40 overflow-y-auto bg-white dark:bg-gray-800 shadow-lg absolute z-50 w-full top-full mt-1",children:[Me.filter(E=>{var P;return E.name.toLowerCase().includes(Rt.toLowerCase())||((P=E.barcode)==null?void 0:P.includes(Rt))}).slice(0,10).map(E=>w.jsxs("div",{className:"p-2 text-xs border-b last:border-0 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer flex justify-between items-center",onClick:()=>{Ct(P=>({...P,[E.id]:Number(P[E.id]||0)+1})),Ga(""),Te({title:"تمت الإضافة",description:`تم إضافة ${E.name}`})},children:[w.jsx("span",{className:"font-medium",children:E.name}),w.jsx("span",{className:"text-emerald-600",children:Wt(E.sellingPrice)})]},E.id)),Me.filter(E=>{var P;return E.name.toLowerCase().includes(Rt.toLowerCase())||((P=E.barcode)==null?void 0:P.includes(Rt))}).length===0&&w.jsx("div",{className:"p-2 text-xs text-center text-gray-500",children:"لا توجد نتائج"})]})]}),w.jsxs("div",{className:"text-xs text-gray-500",children:["التاريخ والوقت: ",new Date().toLocaleString("ar-EG")]}),w.jsx(xo,{}),w.jsxs("div",{className:"space-y-2 max-h-64 overflow-auto",children:[Object.entries(Yt).filter(([E,P])=>Number(P)>0).map(([E,P])=>{const Z=Me.find(Fe=>Fe.id===E),xe=Number(P);if(!Z||!xe)return null;const Ce=xe*Z.sellingPrice;return w.jsxs("div",{className:"flex items-center justify-between gap-2",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("div",{className:"font-medium text-gray-900 text-sm",children:Z.name}),w.jsxs("div",{className:"text-xs text-gray-500",children:["سعر: ",Wt(Z.sellingPrice)]})]}),w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsx(it,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:()=>Ct(Fe=>({...Fe,[E]:Math.max(0,Number(Fe[E]||0)-1)})),children:"-"}),w.jsx(ii,{variant:"outline",className:"font-mono bg-indigo-50 text-indigo-700 border-indigo-200",children:xe}),w.jsx(it,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:()=>Ct(Fe=>({...Fe,[E]:Number(Fe[E]||0)+1})),children:"+"})]}),w.jsx("div",{className:"w-24 text-left font-semibold text-emerald-700",children:Wt(Ce)})]},E)}),Object.entries(Yt).filter(([E,P])=>Number(P)>0).length===0&&w.jsx("div",{className:"text-center text-sm text-gray-500",children:"لا توجد منتجات مضافة. استخدم زر + بجوار المنتجات."})]}),w.jsx(xo,{}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"font-bold",children:"الإجمالي:"}),w.jsx("span",{className:"font-bold text-emerald-700",children:Wt(Object.entries(Yt).reduce((E,[P,Z])=>{const xe=Me.find(Fe=>Fe.id===P),Ce=Number(Z)||0;return E+(xe?Ce*xe.sellingPrice:0)},0))})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[w.jsx(it,{className:"bg-indigo-600 text-white hover:bg-indigo-700",onClick:async()=>{const E=Object.entries(Yt).filter(([Z,xe])=>Number(xe)>0);if(E.length===0){Te({title:"لا توجد منتجات",description:"أضف منتجات للعربة أولاً"});return}const P=[];for(const[Z,xe]of E){const Ce=Me.find(je=>je.id===Z),Fe=Number(xe);if(!(!Ce||!Fe)){if(Fe>Ce.quantity){Te({title:"كمية غير كافية",description:`الكمية المطلوبة للمنتج ${Ce.name} غير متوفرة (المتاح: ${Ce.quantity})`,variant:"destructive"});return}P.push({prod:Ce,qty:Fe})}}ca(!1),Ct({}),Te({title:"جاري التنفيذ",description:"يتم الآن معالجة عملية البيع..."});try{const Z=new Date,xe=Ya(),Ce=ht&&lt?"cashier":"admin",Fe=Ce==="cashier"?(lt==null?void 0:lt.name)||"كاشير":(Y==null?void 0:Y.fullName)||(A==null?void 0:A.displayName)||"الحساب الرئيسي",je=Ce==="cashier"&&(lt==null?void 0:lt.username)||null,Ne=A!=null&&A.uid?`CART-${A.uid}-${Date.now()}`:void 0;if(P.length>0){let se=0,Ee=0;const ve=[],He=[];for(const{prod:et,qty:kt}of P){se+=et.sellingPrice*kt,Ee+=(et.wholesalePrice||0)*kt;const tr=et.quantity-kt;ve.push({id:et.id,qty:tr}),He.push({productId:et.id,productName:et.name,quantity:kt,price:et.sellingPrice,wholesalePrice:et.wholesalePrice,barcode:et.barcode})}const ke={id:Date.now().toString(),productName:`فاتورة مجمعة (${P.length} منتج)`,price:se,wholesalePrice:Ee,quantity:1,date:xe,time:Z.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),createdAtMs:Z.getTime(),performedByType:Ce,performedByName:Fe,performedByUsername:je,isDeferred:!1,transactionReference:Ne,cartItems:He},De=await Mn(ke),pt=De?{...ke,firestoreId:De}:ke;for(const{prod:et,qty:kt}of P){const tr=et.quantity-kt;await Ka(ha(ut,"products",et.id),{quantity:tr,updatedAt:Aa()}),tr===0&&s0(et.name)}if(A!=null&&A.uid&&Ne){const et={txnType:"sales",type:"sales",amount:se,status:"confirmed",senderMsisdn:"مبيعات",receiverMsisdn:"",reference:Ne,title:"فاتورة مبيعات مجمعة",merchantUserId:A.uid,createdBy:A.uid,shopId:(Y==null?void 0:Y.shopId)||Xe||void 0,cashierName:Fe,performedByType:Ce,performedByUsername:je,saleProductName:`فاتورة مجمعة (${P.length} منتج)`,saleQuantity:1,createdAt:new Date};await Bn.saveUserTransaction(A.uid,et)}ft(et=>et.map(kt=>{const tr=ve.find(Ot=>Ot.id===kt.id);return tr?{...kt,quantity:tr.qty}:kt})),_e(et=>{const kt=[pt,...et],tr=Xe||(Y==null?void 0:Y.shopId)||"main",Ot=Ya(),Qt=`salesData_${A==null?void 0:A.uid}_${tr}_${Ot}`,Xt=`salesData_all_${A==null?void 0:A.uid}_${tr}`;localStorage.setItem(Qt,JSON.stringify(kt));try{const Pr=localStorage.getItem(Xt),Xr=Pr?JSON.parse(Pr):[],bi=[pt,...Array.isArray(Xr)?Xr:[]];localStorage.setItem(Xt,JSON.stringify(bi))}catch(Pr){console.warn("Failed to update all sales storage:",Pr)}return kt}),Xa(et=>et+se);const At=se-Ee;Nt(et=>et+At),Ge(et=>et+At),Te({title:"تم البيع بنجاح",description:"تم حفظ الفاتورة المجمعة وخصم الكميات"});try{const et=zi(),kt=localStorage.getItem(et),Ot=(kt?parseFloat(kt):0)+se;if(localStorage.setItem(et,Ot.toString()),A!=null&&A.uid){const Qt={cashBalance:Ot,lastUpdated:new Date().toISOString()};await Bn.updateUserData(A.uid,Qt);const Xt=(Y==null?void 0:Y.shopId)||Xe;Xt&&await Ka(ha(ut,"dashboardData",Xt),{cashBalance:Ot})}window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:Ot}}))}catch(et){console.warn("Error updating cash balance batch:",et)}Te({title:"تم البيع بنجاح",description:`تم بيع الفاتورة بإجمالي ${Wt(se)}`})}}catch(Z){console.error("Batch sell error:",Z),Te({title:"خطأ",description:"حدث خطأ أثناء معالجة البيع",variant:"destructive"})}},children:"بيع"}),w.jsx(it,{variant:"outline",onClick:()=>u(),className:"border-indigo-200 text-indigo-700 hover:bg-indigo-50",children:"طباعة فاتورة"})]})]})}),w.jsx(En,{open:_a,onOpenChange:Jn,children:w.jsxs(_n,{className:"max-w-sm mx-auto bg-white dark:bg-card border border-gray-100 dark:border-border shadow-xl rounded-2xl sm:max-w-md p-6 gap-5",children:[w.jsxs(Ci,{className:"text-center space-y-2",children:[w.jsx("div",{className:"mx-auto bg-amber-100 dark:bg-amber-900/30 p-3 rounded-full w-fit",children:w.jsx(lo,{className:"h-6 w-6 text-amber-600 dark:text-amber-500"})}),w.jsx(An,{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"تسجيل بيع أجل"}),w.jsx(Si,{className:"text-gray-500 dark:text-gray-400 text-sm",children:"أدخل بيانات العميل لتسجيل عملية البيع الآجل"})]}),w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[w.jsx(lr,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"اختيار عميل (اختياري)"}),w.jsxs("div",{className:"relative",children:[w.jsxs("select",{className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background dark:bg-gray-900 px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none dark:text-gray-100",value:r0,onChange:E=>{const P=E.target.value;$0(P);const Z=vi.find(xe=>xe.id===P);Z&&(to(Z.name),cr(Z.mobile||""))},children:[w.jsx("option",{value:"",children:"-- اختر عميل مسجل --"}),vi.map(E=>w.jsxs("option",{value:E.id,children:[E.name,E.mobile?` - ${E.mobile}`:""]},E.id))]}),w.jsx(go,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]})]}),w.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[w.jsxs(lr,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["اسم العميل ",w.jsx("span",{className:"text-red-500",children:"*"})]}),w.jsx(er,{value:eo,onChange:E=>to(E.target.value),placeholder:"أدخل اسم العميل...",className:"h-10 dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100"})]}),w.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[w.jsx(lr,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"رقم التليفون (اختياري)"}),w.jsx(er,{value:ro,onChange:E=>cr(E.target.value),placeholder:"أدخل رقم التليفون...",className:"h-10 dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100"})]})]}),w.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[w.jsx(it,{variant:"outline",className:"flex-1 h-10 border-gray-200 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",onClick:()=>Jn(!1),children:"إلغاء"}),w.jsx(it,{className:"flex-1 h-10 bg-amber-600 hover:bg-amber-700 text-white shadow-sm",onClick:async()=>{try{const E=ao;if(!E){Jn(!1);return}const P=eo.trim(),Z=ro.trim()||void 0,xe=r0||void 0;if(!P){Te({title:"بيانات مطلوبة",description:"أدخل اسم العميل",variant:"destructive"});return}await Cs(E,!0,{id:xe,name:P,mobile:Z});try{if(A!=null&&A.uid){const Ce=E.sellingPrice*(parseInt(vt[E.id]||"0")||0),Fe=await Bn.getUserData(A.uid),je=Array.isArray(Fe==null?void 0:Fe.debts)?Fe.debts:[],Ne={id:Date.now().toString(),debtorName:P,customerId:xe||null,mobile:Z||null,amount:Ce,reason:`بيع أجل للمنتج ${E.name}`,status:"pending",createdAt:new Date,partialPayments:[]},se=[Ne,...je];Bn.updateUserData(A.uid,{debts:se}).catch(()=>{});try{const Ee=Xe||(Y==null?void 0:Y.shopId)||"main";localStorage.setItem(`debts_${A.uid}_${Ee}`,JSON.stringify(se)),localStorage.setItem(`debts_default_${Ee}`,JSON.stringify(se)),localStorage.setItem(`debts_last_write_${A.uid}_${Ee}`,Date.now().toString())}catch{}try{window.dispatchEvent(new CustomEvent("debtsUpdated",{detail:{count:se.length}}))}catch{}try{$u.send(A.uid,`تم إضافة دين على ${Ne.debtorName} بمبلغ ${Ne.amount} جنيه`).catch(()=>{})}catch{}}}catch{}Jn(!1),Ei(null)}catch{}},children:"تأكيد البيع"})]})]})}),w.jsx(En,{open:wi,onOpenChange:ur,children:w.jsxs(_n,{className:"sm:max-w-4xl max-h-[85vh] flex flex-col p-0 overflow-hidden gap-0 bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",children:[w.jsxs("div",{className:"p-4 border-b dark:border-gray-800 flex items-center justify-between bg-gray-50/50 dark:bg-gray-800/50",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"bg-white dark:bg-gray-700 p-2 rounded-full border dark:border-gray-600 shadow-sm",children:w.jsx(Ec,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),w.jsxs("div",{children:[w.jsx(An,{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:"سجل الإيصالات"}),w.jsx(Si,{className:"text-xs text-gray-500 dark:text-gray-400",children:"عرض تفاصيل عمليات البيع الفورية"})]})]}),w.jsx(it,{variant:"ghost",size:"icon",onClick:()=>ur(!1),className:"rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800",children:w.jsx(f0,{className:"h-5 w-5"})})]}),w.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:j.filter(E=>!E.isDeferred).length===0?w.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[w.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-full mb-3",children:w.jsx(Ec,{className:"h-8 w-8 text-gray-300 dark:text-gray-600"})}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"لا توجد إيصالات بيع حتى الآن"})]}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"hidden md:block border dark:border-gray-800 rounded-xl overflow-hidden shadow-sm",children:w.jsxs(fo,{children:[w.jsx(ho,{className:"bg-gray-50/80 dark:bg-gray-800",children:w.jsxs(Ni,{className:"hover:bg-transparent dark:border-gray-800",children:[w.jsx(pr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"المنتج"}),w.jsx(pr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"سعر البيع"}),w.jsx(pr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"سعر الجملة"}),w.jsx(pr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"الكمية"}),w.jsx(pr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"الإجمالي"}),w.jsx(pr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"طريقة الدفع"}),w.jsx(pr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"الربح"}),w.jsx(pr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"التاريخ"}),w.jsx(pr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"الوقت"}),w.jsx(pr,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"المنفذ"})]})}),w.jsx(uo,{children:j.filter(E=>!E.isDeferred).map(E=>w.jsxs(Ni,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 dark:border-gray-800",children:[w.jsx(wr,{className:"font-medium text-gray-900 dark:text-gray-100 py-3",children:E.productName}),w.jsx(wr,{className:"text-gray-700 dark:text-gray-300 py-3",children:Wt(E.price)}),w.jsx(wr,{className:"text-gray-700 dark:text-gray-300 py-3",children:Wt(E.wholesalePrice??0)}),w.jsx(wr,{className:"text-gray-700 dark:text-gray-300 py-3 font-mono",children:D1(E.quantity)}),w.jsx(wr,{className:"text-gray-700 dark:text-gray-300 py-3 font-bold text-emerald-600 dark:text-emerald-400",children:Wt((E.price??0)*(E.quantity??0))}),w.jsx(wr,{className:"text-gray-700 dark:text-gray-300 py-3",children:w.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${(E.paymentMethod||"cash")==="cash"?"bg-green-50 text-green-700":"bg-purple-50 text-purple-700"}`,children:(E.paymentMethod||"cash")==="cash"?"كاش":"فيزا"})}),w.jsx(wr,{className:"text-gray-700 dark:text-gray-300 py-3 text-indigo-600 dark:text-indigo-400",children:Wt(((E.price??0)-(E.wholesalePrice??0))*(E.quantity??0))}),w.jsx(wr,{className:"text-gray-500 dark:text-gray-400 py-3 text-xs",children:Wo(E.date)}),w.jsx(wr,{className:"text-gray-500 dark:text-gray-400 py-3 text-xs font-mono",children:E.time}),w.jsx(wr,{className:"text-gray-700 dark:text-gray-300 py-3 text-xs",children:E.executedBy||"-"})]},E.id))})]})}),w.jsx("div",{className:"md:hidden space-y-3",children:j.filter(E=>!E.isDeferred).map(E=>w.jsx(bn,{className:"overflow-hidden border-gray-100 dark:border-gray-800 shadow-sm bg-white dark:bg-card",children:w.jsxs(co,{className:"p-4 space-y-3",children:[w.jsxs("div",{className:"flex justify-between items-start",children:[w.jsxs("div",{children:[w.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:E.productName}),w.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 flex items-center gap-2",children:[w.jsx("span",{className:"bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded text-gray-600 dark:text-gray-300 font-mono",children:E.time}),w.jsx("span",{className:"text-gray-400",children:"|"}),w.jsx("span",{children:Wo(E.date)})]})]}),w.jsxs("div",{className:"text-left",children:[w.jsx("div",{className:"font-bold text-emerald-600 dark:text-emerald-400 text-sm",children:Wt((E.price??0)*(E.quantity??0))}),w.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:[E.quantity," × ",Wt(E.price)]}),w.jsx("div",{className:"mt-1",children:w.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-medium ${(E.paymentMethod||"cash")==="cash"?"bg-green-50 text-green-700":"bg-purple-50 text-purple-700"}`,children:(E.paymentMethod||"cash")==="cash"?"كاش":"فيزا"})})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-3 border-t border-dashed border-gray-100 dark:border-gray-800 text-xs",children:[w.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-2 rounded flex flex-col items-center justify-center",children:[w.jsx("span",{className:"text-gray-400 mb-1",children:"الربح"}),w.jsx("span",{className:"font-bold text-indigo-600 dark:text-indigo-400",children:Wt(((E.price??0)-(E.wholesalePrice??0))*(E.quantity??0))})]}),w.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-2 rounded flex flex-col items-center justify-center",children:[w.jsx("span",{className:"text-gray-400 mb-1",children:"المنفذ"}),w.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300 truncate max-w-full px-1",children:E.executedBy||"-"})]})]})]})},E.id))})]})}),w.jsx("div",{className:"p-4 border-t dark:border-border bg-gray-50/30 dark:bg-gray-900/30 flex justify-end",children:w.jsx(it,{variant:"outline",onClick:()=>ur(!1),className:"px-6 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",children:"إغلاق"})})]})}),w.jsx(En,{open:Rn,onOpenChange:vs,children:w.jsxs(_n,{className:"max-w-sm mx-auto bg-white border border-gray-100 shadow-xl rounded-2xl sm:max-w-md p-6 gap-6",children:[w.jsxs("div",{className:"flex flex-col items-center text-center gap-2",children:[w.jsx("div",{className:`p-3 rounded-full ${Dr==="return"?"bg-amber-100 text-amber-600":"bg-red-100 text-red-600"}`,children:Dr==="return"?w.jsx(So,{className:"h-6 w-6"}):w.jsx(Zi,{className:"h-6 w-6"})}),w.jsx(An,{className:"text-xl font-bold text-gray-900 mt-2",children:Dr==="return"?"تأكيد المرتجع":"تأكيد الحذف"}),w.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[w.jsxs("p",{children:["هل أنت متأكد من ",Dr==="return"?"إرجاع":"حذف"," المنتج",w.jsx("span",{className:"font-bold text-gray-900 mx-1",children:ye==null?void 0:ye.productName}),"بكمية",w.jsx("span",{className:"font-bold text-gray-900 mx-1 font-mono",children:D1((ye==null?void 0:ye.quantity)||0)}),"؟"]}),w.jsx("p",{className:"text-xs text-gray-400",children:"سيتم تحديث المخزون والرصيد تلقائياً."})]})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsx(it,{variant:"outline",className:"h-10 border-gray-200",onClick:()=>vs(!1),children:"إلغاء"}),w.jsx(it,{className:`h-10 ${Dr==="return"?"bg-amber-600 hover:bg-amber-700":"bg-red-600 hover:bg-red-700"} text-white shadow-sm`,onClick:()=>{const E=ye;vs(!1),E&&io(E)},children:Dr==="return"?"تأكيد المرتجع":"تأكيد الحذف"})]})]})}),w.jsx(En,{open:d,onOpenChange:m,children:w.jsxs(_n,{className:"sm:max-w-md bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",dir:"rtl",children:[w.jsxs(Ci,{children:[w.jsxs(An,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[w.jsx(yc,{className:"h-5 w-5 text-primary"}),"تقارير يومية"]}),w.jsx(Si,{className:"text-gray-500 dark:text-gray-400",children:"اختر تاريخاً لعرض تفاصيل العمليات لذلك اليوم"})]}),w.jsxs("div",{className:"space-y-4 py-4",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx(lr,{className:"text-gray-700 dark:text-gray-300",children:"اختر التاريخ"}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx(er,{type:"date",value:X,onChange:E=>O(E.target.value),className:"flex-1 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100"}),w.jsx(it,{onClick:()=>ie(X),disabled:!X||J,className:"bg-indigo-600 hover:bg-indigo-700 text-white",children:J?w.jsx(ql,{className:"h-4 w-4 animate-spin"}):"عرض التقرير"})]})]}),q&&w.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-4 border-t border-gray-100 dark:border-gray-800",children:[w.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg text-center border border-blue-100 dark:border-blue-800/50",children:[w.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 block mb-1",children:"المعاملات"}),w.jsx("span",{className:"font-bold text-blue-700 dark:text-blue-300 text-lg",children:q.count})]}),w.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 p-3 rounded-lg text-center border border-emerald-100 dark:border-emerald-800/50",children:[w.jsx("span",{className:"text-xs text-emerald-600 dark:text-emerald-400 block mb-1",children:"إجمالي المسحوب"}),w.jsx("span",{className:"font-bold text-emerald-700 dark:text-emerald-300 text-lg",children:Wt(q.sales)})]}),w.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-3 rounded-lg text-center border border-amber-100 dark:border-amber-800/50",children:[w.jsx("span",{className:"text-xs text-amber-600 dark:text-amber-400 block mb-1",children:"إجمالي المرسل"}),w.jsx("span",{className:"font-bold text-amber-700 dark:text-amber-300 text-lg",children:Wt(q.cost)})]}),w.jsxs("div",{className:"bg-pink-50 dark:bg-pink-900/20 p-3 rounded-lg text-center border border-pink-100 dark:border-pink-800/50",children:[w.jsx("span",{className:"text-xs text-pink-600 dark:text-pink-400 block mb-1",children:"الأرباح"}),w.jsx("span",{className:"font-bold text-pink-700 dark:text-pink-300 text-lg",children:Wt(q.profit)})]})]})]})]})}),w.jsx(_c,{open:yt,onOpenChange:Se,mode:"verify",title:"قفل إجمالي الأرباح",description:"أدخل الرقم السري الرئيسي لعرض إجمالي الأرباح",userId:A==null?void 0:A.uid,userRole:Y==null?void 0:Y.role,onSuccess:()=>{nt(!1),Se(!1)}}),w.jsx(_c,{open:Ui,onOpenChange:Yn,mode:"verify",title:"قفل إحصائيات الشهر",description:"لا يمكن الاطلاع على تقارير الشهر إلا بإدخال الرقم السري الرئيسي",onSuccess:async()=>{try{const E=A==null?void 0:A.uid;if(E){const P=await ed(E),Z=(P==null?void 0:P.planType)??(P==null?void 0:P.plan)??null,xe=typeof Z=="string"?Z.toLowerCase():null;if(Z===td.ZERO||xe==="zero"){Te({title:"الخطة زيرو",description:"التقارير الشهرية غير متاحة في خطة زيرو. قم بالترقية للوصول إلى التقارير.",variant:"destructive"});return}}}catch{}nn(!1),Yn(!1),ri()}}),w.jsx(_c,{open:Er,onOpenChange:ms,mode:"verify",title:xc,description:ps,userId:A==null?void 0:A.uid,userRole:Y==null?void 0:Y.role,onSuccess:()=>{const E=e0.current;e0.current=null,ms(!1),E&&setTimeout(()=>{E()},100)}}),w.jsx(En,{open:wt,onOpenChange:Es,children:w.jsxs(_n,{className:"sm:max-w-[400px]",children:[w.jsxs(Ci,{children:[w.jsx(An,{className:"text-center",children:"إضافة مخزون"}),w.jsxs(Si,{className:"text-center",children:["إضافة كمية للمنتج: ",w.jsx("span",{className:"font-bold text-black",children:$t==null?void 0:$t.name})]})]}),w.jsx("div",{className:"py-6 flex flex-col items-center gap-4",children:w.jsxs("div",{className:"flex items-center gap-4 w-full justify-center",children:[w.jsx(it,{variant:"outline",size:"icon",onClick:()=>_s(E=>String(Math.max(1,parseInt(E||"0")-1))),children:w.jsx(So,{className:"h-4 w-4"})}),w.jsx(er,{id:"qty",type:"number",value:ei,onChange:E=>_s(E.target.value),className:"w-32 text-center text-2xl font-bold h-12",autoFocus:!0,onKeyDown:E=>{E.key==="Enter"&&As()}}),w.jsx(it,{variant:"outline",size:"icon",onClick:()=>_s(E=>String(parseInt(E||"0")+1)),children:w.jsx(rd,{className:"h-4 w-4"})})]})}),w.jsxs(h0,{className:"flex gap-2 sm:justify-center",children:[w.jsx(it,{variant:"outline",onClick:()=>Es(!1),className:"flex-1",children:"إلغاء"}),w.jsx(it,{onClick:As,className:"flex-1 bg-emerald-600 hover:bg-emerald-700",children:"تأكيد الإضافة"})]})]})}),w.jsx(En,{open:ne,onOpenChange:le,children:w.jsxs(_n,{className:"sm:max-w-[500px] bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",dir:"rtl",children:[w.jsxs(Ci,{children:[w.jsx(An,{className:"text-center text-gray-900 dark:text-gray-100",children:"تعديل المنتج"}),w.jsx(Si,{className:"text-center text-gray-500 dark:text-gray-400",children:"عدّل بيانات المنتج ثم اضغط حفظ"})]}),w.jsxs("div",{className:"grid gap-4 py-4",children:[w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(lr,{htmlFor:"ep_name",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"المنتج"}),w.jsx(er,{id:"ep_name",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.productName,onChange:E=>Be(P=>({...P,productName:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(lr,{htmlFor:"ep_price",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"سعر البيع"}),w.jsx(er,{id:"ep_price",type:"number",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.price,onChange:E=>Be(P=>({...P,price:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(lr,{htmlFor:"ep_wholesale",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"سعر الجملة"}),w.jsx(er,{id:"ep_wholesale",type:"number",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.wholesalePrice??"",onChange:E=>Be(P=>({...P,wholesalePrice:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(lr,{htmlFor:"ep_qty",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"الكمية"}),w.jsx(er,{id:"ep_qty",type:"number",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.quantity,onChange:E=>Be(P=>({...P,quantity:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(lr,{htmlFor:"ep_barcode",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"باركود"}),w.jsx(er,{id:"ep_barcode",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.barcode??"",onChange:E=>Be(P=>({...P,barcode:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(lr,{htmlFor:"ep_serial",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"سيريال"}),w.jsx(er,{id:"ep_serial",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.serialNumber??"",onChange:E=>Be(P=>({...P,serialNumber:E.target.value}))})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(lr,{htmlFor:"ep_category",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"القسم"}),w.jsx("div",{className:"col-span-3",children:w.jsxs(Tc,{value:Pe.categoryId||"none",onValueChange:E=>Be(P=>({...P,categoryId:E==="none"?void 0:E})),children:[w.jsx(Nc,{id:"ep_category",className:"bg-white dark:bg-gray-800 text-right dark:text-gray-100 border-gray-200 dark:border-gray-700",dir:"rtl",children:w.jsx(kc,{placeholder:"اختر القسم"})}),w.jsxs(Ic,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[w.jsx(Ds,{value:"none",className:"dark:text-gray-100 dark:focus:bg-gray-700",children:"بدون قسم"}),t0.map(E=>w.jsx(Ds,{value:E.id,className:"dark:text-gray-100 dark:focus:bg-gray-700",children:E.name},E.id))]})]})})]}),w.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[w.jsx(lr,{htmlFor:"ep_supplier",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"المورد"}),w.jsx(er,{id:"ep_supplier",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:Pe.supplierName??"",onChange:E=>Be(P=>({...P,supplierName:E.target.value})),placeholder:"اسم المورد (اختياري)"})]})]}),w.jsxs(h0,{className:"flex gap-2 sm:justify-center",children:[w.jsx(it,{variant:"outline",onClick:()=>{le(!1),Le(null)},className:"flex-1 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",children:"إلغاء"}),w.jsx(it,{onClick:a,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white shadow-sm dark:shadow-none",disabled:ht,children:"حفظ"})]})]})}),w.jsx(En,{open:jt,onOpenChange:Qr,children:w.jsxs(_n,{className:"sm:max-w-md",dir:"rtl",children:[w.jsx(Ci,{children:w.jsx(An,{children:"تقرير اليوم والشهر"})}),w.jsxs("div",{className:"space-y-4 py-4",children:[w.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[w.jsxs("div",{className:"flex items-center justify-between mb-3",children:[w.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[w.jsx(Fs,{className:"h-4 w-4 text-primary"}),"ملخص اليوم"]}),w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-red-600",onClick:dr,title:"تصفير اليوم",children:w.jsx(Ln,{className:"h-3.5 w-3.5"})})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"text-center p-2 bg-white rounded border",children:[w.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"المبيعات"}),w.jsx("div",{className:"font-bold text-primary",children:Wt(Math.max(0,j.filter(E=>!E.isDeferred).reduce((E,P)=>E+P.price*P.quantity,0)-x))})]}),w.jsxs("div",{className:"text-center p-2 bg-white rounded border relative overflow-hidden",children:[w.jsx("div",{className:"text-xs text-emerald-700 mb-1",children:"الأرباح"}),w.jsx("div",{className:`font-bold text-emerald-700 ${Ke?"blur-sm":""}`,children:Wt(Je)}),Ke&&w.jsxs("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50",children:[w.jsx(it,{size:"sm",variant:"ghost",onClick:()=>{Qr(!1),Se(!0)},className:"h-full w-full opacity-0 absolute inset-0"}),w.jsx(Zl,{className:"h-3 w-3 text-muted-foreground"})]})]})]})]}),w.jsxs("div",{className:"bg-indigo-50/50 p-4 rounded-lg border border-indigo-100",children:[w.jsxs("div",{className:"flex items-center justify-between mb-3",children:[w.jsxs("h3",{className:"font-semibold flex items-center gap-2 text-indigo-900",children:[w.jsx(Co,{className:"h-4 w-4 text-indigo-600"}),"تقارير الشهر"]}),w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-red-600",onClick:Fr,title:"تصفير الشهر",children:w.jsx(Ln,{className:"h-3 w-3"})})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4 relative",children:[w.jsxs("div",{className:`text-center p-2 bg-white rounded border border-indigo-100 relative overflow-hidden group ${qt?"blur-md select-none":""}`,children:[w.jsxs("div",{className:"flex justify-center items-center relative",children:[w.jsx("div",{className:"text-xs text-indigo-600 mb-1",children:"المبيعات"}),!qt&&w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 absolute -left-2 top-0 text-indigo-400 hover:text-red-600 hover:bg-white/50 rounded-full z-20",onClick:Fr,title:"تصفير الشهر",children:w.jsx(Ln,{className:"h-3.5 w-3.5"})})]}),w.jsx("div",{className:"font-bold text-indigo-700",children:Wt(Math.max(0,Jr-I))})]}),w.jsxs("div",{className:`text-center p-2 bg-white rounded border border-indigo-100 relative overflow-hidden group ${qt?"blur-md select-none":""}`,children:[w.jsxs("div",{className:"flex justify-center items-center relative",children:[w.jsx("div",{className:"text-xs text-pink-600 mb-1",children:"الأرباح"}),!qt&&w.jsx(it,{variant:"ghost",size:"icon",className:"h-6 w-6 absolute -left-2 top-0 text-pink-400 hover:text-red-600 hover:bg-white/50 rounded-full z-20",onClick:Fr,title:"تصفير الشهر",children:w.jsx(Ln,{className:"h-3.5 w-3.5"})})]}),w.jsx("div",{className:"font-bold text-pink-700",children:Wt(Math.max(0,It-G))})]}),qt&&w.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/20 dark:bg-black/20 backdrop-blur-[2px]",children:w.jsx(it,{"aria-label":"عرض",variant:"ghost",size:"icon",onClick:()=>{Qr(!1),Yn(!0)},className:"rounded-full h-8 w-8 bg-white/80 backdrop-blur-sm shadow hover:bg-white dark:hover:bg-black/70",children:w.jsx(ks,{className:"h-4 w-4 text-indigo-700"})})})]})]})]}),w.jsx(h0,{children:w.jsx(it,{onClick:()=>Qr(!1),children:"إغلاق"})})]})}),w.jsx(En,{open:gc,onOpenChange:qn,children:w.jsxs(_n,{className:"sm:max-w-[425px]",children:[w.jsxs(Ci,{children:[w.jsx(An,{children:"إضافة قسم جديد"}),w.jsx(Si,{children:"أدخل اسم القسم الجديد لإضافته إلى قائمة الأقسام."})]}),w.jsx("div",{className:"grid gap-4 py-4",children:w.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[w.jsx(lr,{htmlFor:"categoryName",className:"text-right",children:"اسم القسم"}),w.jsx(er,{id:"categoryName",value:Zn,onChange:E=>yi(E.target.value),className:"col-span-3",placeholder:"مثال: إلكترونيات"})]})}),w.jsx(h0,{children:w.jsx(it,{onClick:Q0,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:"إضافة"})})]})}),w.jsx(mo,{open:!!Qn,onOpenChange:E=>!E&&a0(null),children:w.jsxs(po,{children:[w.jsxs(wo,{children:[w.jsx(vo,{className:"text-right",children:"حذف المنتج"}),w.jsxs(yo,{className:"text-right",children:[Qn?`هل أنت متأكد من حذف المنتج "${Qn.name}" من قائمة المنتجات؟`:"هل أنت متأكد من حذف هذا المنتج من قائمة المنتجات؟",w.jsx("br",{}),"سيتم حذفه من المخزون ولن يظهر في شاشة البيع."]})]}),w.jsxs(Eo,{className:"flex-row-reverse sm:justify-start",children:[w.jsx(_o,{children:"إلغاء"}),w.jsx(Ao,{onClick:c0,className:"bg-red-600 hover:bg-red-700",children:"حذف"})]})]})}),w.jsx(mo,{open:!!D,onOpenChange:E=>!E&&U(null),children:w.jsxs(po,{children:[w.jsxs(wo,{children:[w.jsx(vo,{className:"text-right",children:"حذف القسم"}),w.jsxs(yo,{className:"text-right",children:["هل أنت متأكد من حذف هذا القسم؟",w.jsx("br",{}),"سيتم حذف القسم ولكن ستبقى المنتجات المرتبطة به بدون قسم."]})]}),w.jsxs(Eo,{className:"flex-row-reverse sm:justify-start",children:[w.jsx(_o,{children:"إلغاء"}),w.jsx(Ao,{onClick:Vi,className:"bg-red-600 hover:bg-red-700",children:"حذف"})]})]})}),w.jsx(mo,{open:mc,onOpenChange:Gi,children:w.jsxs(po,{children:[w.jsxs(wo,{children:[w.jsxs(vo,{className:"text-right text-red-600 flex items-center gap-2",children:[w.jsx(ad,{className:"h-5 w-5"}),"حذف جميع المنتجات"]}),w.jsxs(yo,{className:"text-right pt-2",children:["هل أنت متأكد تماماً من رغبتك في ",w.jsxs("strong",{children:["حذف جميع المنتجات (",Me.length," منتج)"]}),"؟",w.jsx("br",{}),w.jsx("br",{}),w.jsx("span",{className:"text-red-500 font-bold",children:"هذا الإجراء نهائي ولا يمكن استرجاع البيانات المحذوفة."})]})]}),w.jsxs(Eo,{className:"flex-row-reverse sm:justify-start",children:[w.jsx(_o,{children:"إلغاء"}),w.jsx(Ao,{onClick:Jt,className:"bg-red-600 hover:bg-red-700",children:"نعم، احذف الكل"})]})]})}),w.jsx(En,{open:!!Re,onOpenChange:E=>!E&&Lt(null),children:w.jsxs(_n,{className:"sm:max-w-lg bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",dir:"rtl",children:[w.jsxs(Ci,{children:[w.jsx(An,{className:"text-gray-900 dark:text-gray-100",children:"تفاصيل الفاتورة المجمعة"}),w.jsx(Si,{className:"text-gray-500 dark:text-gray-400",children:"قائمة المنتجات المدرجة في هذه الفاتورة"})]}),w.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[w.jsxs(fo,{children:[w.jsx(ho,{className:"bg-gray-50/80 dark:bg-gray-800",children:w.jsxs(Ni,{className:"hover:bg-transparent dark:border-gray-800",children:[w.jsx(pr,{className:"text-right text-gray-700 dark:text-gray-300",children:"المنتج"}),w.jsx(pr,{className:"text-center text-gray-700 dark:text-gray-300",children:"الكمية"}),w.jsx(pr,{className:"text-center text-gray-700 dark:text-gray-300",children:"السعر"}),w.jsx(pr,{className:"text-center text-gray-700 dark:text-gray-300",children:"الإجمالي"})]})}),w.jsx(uo,{children:(ai=Re==null?void 0:Re.cartItems)==null?void 0:ai.map((E,P)=>w.jsxs(Ni,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 dark:border-gray-800",children:[w.jsx(wr,{className:"font-medium text-gray-900 dark:text-gray-100",children:E.productName}),w.jsx(wr,{className:"text-center text-gray-700 dark:text-gray-300",children:E.quantity}),w.jsx(wr,{className:"text-center text-gray-700 dark:text-gray-300",children:Wt(E.price)}),w.jsx(wr,{className:"text-center font-bold text-emerald-600 dark:text-emerald-400",children:Wt(E.price*E.quantity)})]},P))})]}),w.jsxs("div",{className:"mt-4 flex justify-between items-center bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border border-gray-100 dark:border-gray-700",children:[w.jsx("span",{className:"font-bold text-gray-900 dark:text-gray-100",children:"الإجمالي الكلي:"}),w.jsx("span",{className:"font-bold text-lg text-emerald-700 dark:text-emerald-400",children:Wt((Re==null?void 0:Re.price)||0)})]})]}),w.jsx(h0,{children:w.jsx(it,{onClick:()=>Lt(null),className:"dark:bg-gray-800 dark:text-gray-100 dark:hover:bg-gray-700",children:"إغلاق"})})]})}),w.jsx(fd,{isOpen:g,onClose:()=>v(!1),videoUrl:_,title:T})]})}const D1=e=>new Intl.NumberFormat("ar-EG",{maximumFractionDigits:0}).format(Number(e||0)),Wt=e=>`${new Intl.NumberFormat("ar-EG",{maximumFractionDigits:0}).format(Number(e||0))} ج.م`,Wo=e=>{try{const r=new Date(e);return isNaN(r.getTime())?new Date(`${e}T00:00:00`).toLocaleDateString("ar-EG"):r.toLocaleDateString("ar-EG")}catch{return e}};export{iA as SalesDataDialog};
//# sourceMappingURL=SalesDataDialog-qajE2To7.js.map
