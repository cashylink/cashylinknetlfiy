import{W as I,S as l,I as e,a as p,aI as K,aJ as P,aK as q,aL as G,t as d,aZ as H,o as W,g as D}from"./index-BsVRzvOf.js";import{o as J,c as L,i as M,l as O}from"./card-SlwaggFS-BswsJdJN.js";import{u as c}from"./label-_mnIMROJ-DudSd8Mh.js";function E(){var j;const{user:g,profile:i,isSubscriptionActive:y,userSubscription:v}=I(),[$,n]=l.useState(!1),[o,f]=l.useState(""),[m,N]=l.useState(""),[h,S]=l.useState(""),[u,w]=l.useState(""),[x,C]=l.useState(!1),[b,r]=l.useState(null),k=((j=v==null?void 0:v.branchPackage)==null?void 0:j.status)==="active",t=(i==null?void 0:i.role)==="admin"||(i==null?void 0:i.role)==="merchant"||y||k,F=()=>{f(""),N(""),S(""),w("")},A=async()=>{if(r(null),!t){r("هذه العملية تتطلب اشتراكًا مفعلًا أو صلاحية مدير/تاجر.");return}if(!o||!m||!h||!u){r("يرجى ملء جميع الحقول المطلوبة.");return}try{C(!0);const a=await W(D,"createShopAndManager")({shopName:o,managerName:m,email:h,password:u}),s=a==null?void 0:a.data;r(s!=null&&s.success?`تم إنشاء المتجر (${s.shopId}) ومدير الحساب بنجاح.`:"فشل إنشاء الحساب، حاول مرة أخرى."),s!=null&&s.success&&(F(),n(!1))}catch(a){const s=(a==null?void 0:a.message)||"حدث خطأ غير متوقع أثناء الإنشاء";r(s)}finally{C(!1)}};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs(J,{children:[e.jsx(L,{children:e.jsx(M,{children:"لوحة التحكم (CPanel)"})}),e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"إضافة محل جديد مع إنشاء حساب المدير ليتسجل من صفحة الدخول العادية."})}),e.jsx(p,{onClick:()=>n(!0),disabled:!t,children:"إضافة محل"})]}),!g&&e.jsx("p",{className:"mt-3 text-sm text-red-600",children:"يجب تسجيل الدخول للوصول إلى لوحة التحكم."}),g&&!t&&e.jsx("p",{className:"mt-3 text-sm text-red-600",children:"حسابك ليس لديه صلاحيات كافية أو اشتراك/باقة فروع مفعّلة لإنشاء المحلات. إذا كنت مشتركًا بباقة مدفوعة أو لديك باقة فروع مفعّلة، ستتمكن من إضافة الحسابات مباشرة."})]})]}),e.jsx(K,{open:$,onOpenChange:n,children:e.jsxs(P,{children:[e.jsx(q,{children:e.jsx(G,{children:"إضافة محل ومدير"})}),e.jsxs("div",{className:"grid gap-4 py-2",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"shopName",children:"اسم المحل"}),e.jsx(d,{id:"shopName",value:o,onChange:a=>f(a.target.value),placeholder:"مثال: متجر أحمد"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"managerName",children:"اسم المدير"}),e.jsx(d,{id:"managerName",value:m,onChange:a=>N(a.target.value),placeholder:"مثال: أحمد علي"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"email",children:"الإيميل"}),e.jsx(d,{id:"email",type:"email",value:h,onChange:a=>S(a.target.value),placeholder:"example@mail.com"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"password",children:"الباسوورد"}),e.jsx(d,{id:"password",type:"password",value:u,onChange:a=>w(a.target.value),placeholder:"••••••••"})]}),b&&e.jsx("p",{className:"text-sm text-muted-foreground",children:b})]}),e.jsxs(H,{children:[e.jsx(p,{variant:"outline",onClick:()=>n(!1),disabled:x,children:"إلغاء"}),e.jsx(p,{onClick:A,disabled:x||!t,children:x?"جاري الإنشاء...":"إنشاء الحساب"})]})]})})]})}export{E as default};
//# sourceMappingURL=CPanelPage-DnPtgr8M-BWe-kZaO.js.map
