import{W as X,r as o,j as e,a4 as Me,a7 as Z,ab as Oe,bg as J,Z as Q,u as oe,i as ie,aC as ce,aD as le,aE as de,aF as ue,aG as Fe,v as B,I as H,B as E,E as W,D as z,aH as Te,aI as Ve,aJ as Ge,bj as $e,a as Ke,ah as Be,bk as He,bl as We,ap as ze,O as qe,ak as Ye}from"./index-Cty74lt-.js";import{D as Je,a as Xe,b as Ze,c as Qe,d as re,e as q}from"./dropdown-menu-O9u3SxYy.js";import{M as es}from"./MasterPinDialog-CPdrS7WM.js";import{g as ss}from"./switch--dmtmMXZ.js";import{FreeTrialService as ts}from"./freeTrialService-DGi7iREK.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Ms=X("activity",as);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]],ns=X("cloud-download",rs);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],is=X("loader-circle",os);var fe={exports:{}},me={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U=o;function cs(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var ls=typeof Object.is=="function"?Object.is:cs,ds=U.useState,us=U.useEffect,fs=U.useLayoutEffect,ms=U.useDebugValue;function hs(n,s){var t=s(),d=ds({inst:{value:t,getSnapshot:s}}),i=d[0].inst,l=d[1];return fs(function(){i.value=t,i.getSnapshot=s,Y(i)&&l({inst:i})},[n,t,s]),us(function(){return Y(i)&&l({inst:i}),n(function(){Y(i)&&l({inst:i})})},[n]),ms(t),t}function Y(n){var s=n.getSnapshot;n=n.value;try{var t=s();return!ls(n,t)}catch{return!0}}function ws(n,s){return s()}var gs=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ws:hs;me.useSyncExternalStore=U.useSyncExternalStore!==void 0?U.useSyncExternalStore:gs;fe.exports=me;var ps=fe.exports;function xs(){return ps.useSyncExternalStore(vs,()=>!0,()=>!1)}function vs(){return()=>{}}var ee="Avatar",[js]=Me(ee),[Ss,he]=js(ee),we=o.forwardRef((n,s)=>{const{__scopeAvatar:t,...d}=n,[i,l]=o.useState("idle");return e.jsx(Ss,{scope:t,imageLoadingStatus:i,onImageLoadingStatusChange:l,children:e.jsx(Z.span,{...d,ref:s})})});we.displayName=ee;var ge="AvatarImage",pe=o.forwardRef((n,s)=>{const{__scopeAvatar:t,src:d,onLoadingStatusChange:i=()=>{},...l}=n,y=he(ge,t),v=bs(d,l),g=Oe(f=>{i(f),y.onImageLoadingStatusChange(f)});return J(()=>{v!=="idle"&&g(v)},[v,g]),v==="loaded"?e.jsx(Z.img,{...l,ref:s,src:d}):null});pe.displayName=ge;var xe="AvatarFallback",ve=o.forwardRef((n,s)=>{const{__scopeAvatar:t,delayMs:d,...i}=n,l=he(xe,t),[y,v]=o.useState(d===void 0);return o.useEffect(()=>{if(d!==void 0){const g=window.setTimeout(()=>v(!0),d);return()=>window.clearTimeout(g)}},[d]),y&&l.imageLoadingStatus!=="loaded"?e.jsx(Z.span,{...i,ref:s}):null});ve.displayName=xe;function ne(n,s){return n?s?(n.src!==s&&(n.src=s),n.complete&&n.naturalWidth>0?"loaded":"loading"):"error":"idle"}function bs(n,{referrerPolicy:s,crossOrigin:t}){const d=xs(),i=o.useRef(null),l=d?(i.current||(i.current=new window.Image),i.current):null,[y,v]=o.useState(()=>ne(l,n));return J(()=>{v(ne(l,n))},[l,n]),J(()=>{const g=M=>()=>{v(M)};if(!l)return;const f=g("loaded"),I=g("error");return l.addEventListener("load",f),l.addEventListener("error",I),s&&(l.referrerPolicy=s),typeof t=="string"&&(l.crossOrigin=t),()=>{l.removeEventListener("load",f),l.removeEventListener("error",I)}},[l,t,s]),y}var je=we,Se=pe,be=ve;const ye=o.forwardRef(({className:n,...s},t)=>e.jsx(je,{ref:t,className:Q("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",n),...s}));ye.displayName=je.displayName;const Ne=o.forwardRef(({className:n,...s},t)=>e.jsx(Se,{ref:t,className:Q("aspect-square h-full w-full",n),...s}));Ne.displayName=Se.displayName;const Pe=o.forwardRef(({className:n,...s},t)=>e.jsx(be,{ref:t,className:Q("flex h-full w-full items-center justify-center rounded-full bg-muted",n),...s}));Pe.displayName=be.displayName;function ys({open:n,onOpenChange:s}){const{user:t}=oe(),{toast:d}=ie(),[i,l]=o.useState(!1),[y,v]=o.useState(!1),[g,f]=o.useState(!1),[I,M]=o.useState(!1),[se,A]=o.useState(!1),[te,_]=o.useState(!1),[j,O]=o.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[c,w]=o.useState({currentPassword:"",newPassword:"",confirmPassword:""}),R=()=>{const u={currentPassword:"",newPassword:"",confirmPassword:""};return j.currentPassword||(u.currentPassword="كلمة المرور الحالية مطلوبة"),j.newPassword?j.newPassword.length<6&&(u.newPassword="كلمة المرور يجب أن تكون 6 أحرف على الأقل"):u.newPassword="كلمة المرور الجديدة مطلوبة",j.confirmPassword?j.newPassword!==j.confirmPassword&&(u.confirmPassword="كلمات المرور غير متطابقة"):u.confirmPassword="تأكيد كلمة المرور مطلوب",w(u),!Object.values(u).some(h=>h!=="")},S=async u=>{if(u.preventDefault(),!(!R()||!t||!t.email)){l(!0);try{const h=Ve.credential(t.email,j.currentPassword);await Ge(t,h),_(!0),A(!0),d({title:"تأكيد الهوية",description:"أدخل الرقم السري الرئيسي لتأكيد تغيير كلمة المرور"})}catch(h){console.error("خطأ في تغيير كلمة المرور:",h);let P="حدث خطأ أثناء تغيير كلمة المرور";if(h.code==="auth/wrong-password"){w(k=>({...k,currentPassword:"كلمة المرور الحالية غير صحيحة"}));return}else if(h.code==="auth/weak-password"){w(k=>({...k,newPassword:"كلمة المرور ضعيفة جداً"}));return}else h.code==="auth/requires-recent-login"&&(P="يجب تسجيل الدخول مرة أخرى لتغيير كلمة المرور");d({title:"خطأ في تغيير كلمة المرور",description:P,variant:"destructive"})}finally{l(!1)}}},G=async()=>{if(t){l(!0);try{await $e(t,j.newPassword),d({title:"تم تغيير كلمة المرور بنجاح",description:"تم تحديث كلمة المرور الخاصة بك بنجاح"}),O({currentPassword:"",newPassword:"",confirmPassword:""}),w({currentPassword:"",newPassword:"",confirmPassword:""}),A(!1),_(!1),s(!1)}catch(u){console.error("خطأ في تحديث كلمة المرور:",u);let h="حدث خطأ أثناء تغيير كلمة المرور";u.code==="auth/requires-recent-login"&&(h="انتهت جلسة المصادقة. يرجى إعادة إدخال كلمة المرور الحالية"),d({title:"خطأ في تغيير كلمة المرور",description:h,variant:"destructive"})}finally{l(!1)}}},N=u=>h=>{O(P=>({...P,[u]:h.target.value})),c[u]&&w(P=>({...P,[u]:""}))},p=()=>{O({currentPassword:"",newPassword:"",confirmPassword:""}),w({currentPassword:"",newPassword:"",confirmPassword:""}),A(!1),_(!1),s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(ce,{open:n,onOpenChange:p,children:e.jsxs(le,{className:"sm:max-w-[425px]",children:[e.jsxs(de,{children:[e.jsx(ue,{children:"تغيير كلمة المرور"}),e.jsx(Fe,{children:"أدخل كلمة المرور الحالية وكلمة المرور الجديدة لتحديث حسابك"})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"currentPassword",children:"كلمة المرور الحالية"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{id:"currentPassword",type:y?"text":"password",value:j.currentPassword,onChange:N("currentPassword"),className:c.currentPassword?"border-red-500":"",autoComplete:"off",disabled:i}),e.jsx(E,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>v(!y),disabled:i,children:y?e.jsx(W,{className:"h-4 w-4"}):e.jsx(z,{className:"h-4 w-4"})})]}),c.currentPassword&&e.jsx("p",{className:"text-sm text-red-500",children:c.currentPassword})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"newPassword",children:"كلمة المرور الجديدة"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{id:"newPassword",type:g?"text":"password",value:j.newPassword,onChange:N("newPassword"),className:c.newPassword?"border-red-500":"",autoComplete:"new-password",disabled:i}),e.jsx(E,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>f(!g),disabled:i,children:g?e.jsx(W,{className:"h-4 w-4"}):e.jsx(z,{className:"h-4 w-4"})})]}),c.newPassword&&e.jsx("p",{className:"text-sm text-red-500",children:c.newPassword})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"confirmPassword",children:"تأكيد كلمة المرور الجديدة"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{id:"confirmPassword",type:I?"text":"password",value:j.confirmPassword,onChange:N("confirmPassword"),className:c.confirmPassword?"border-red-500":"",autoComplete:"new-password",disabled:i}),e.jsx(E,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>M(!I),disabled:i,children:I?e.jsx(W,{className:"h-4 w-4"}):e.jsx(z,{className:"h-4 w-4"})})]}),c.confirmPassword&&e.jsx("p",{className:"text-sm text-red-500",children:c.confirmPassword})]}),e.jsxs(Te,{children:[e.jsx(E,{type:"button",variant:"outline",onClick:p,disabled:i,children:"إلغاء"}),e.jsxs(E,{type:"submit",disabled:i,children:[i&&e.jsx(is,{className:"mr-2 h-4 w-4 animate-spin"}),"تغيير كلمة المرور"]})]})]})]})}),e.jsx(es,{open:se&&te,onOpenChange:u=>{A(u),u||_(!1)},mode:"verify",title:"التحقق من الرقم السري الرئيسي",description:"لا يمكن تغيير كلمة المرور إلا بعد التحقق من الرقم السري الرئيسي",onSuccess:G,onCancel:()=>{A(!1),_(!1)}})]})}const Ns="cashy.google.accessToken",Ps="cashy.google.email",ks="cashy.google.expiresAt";function Es(){try{const n=localStorage.getItem(Ns),s=localStorage.getItem(Ps),t=localStorage.getItem(ks),d=t?Number(t):null;return{token:n,email:s,expiresAt:d}}catch{return{token:null,email:null,expiresAt:null}}}async function Cs(n,s,t){try{const d=await fetch("/user/google-backup-token",{method:"POST",headers:{"Content-Type":"application/json","X-USER-ID":n},body:JSON.stringify({email:s,refresh_token:t})}),i=await d.json().catch(()=>({}));return!!(d.ok&&(i!=null&&i.ok))}catch{return!1}}function Os({className:n}){const{user:s,profile:t,signOut:d,updateUserProfile:i}=oe(),l=Ke(),[y,v]=o.useState(!1),{isShiftActive:g}=Be(),{toast:f}=ie(),[I,M]=o.useState(!1),[se,A]=o.useState(!1),[te,_]=o.useState(!1),[{token:j},O]=o.useState(()=>Es()),c=typeof window<"u"?window.electronAPI:void 0,w=!!c,[R,S]=o.useState(!1),[G,N]=o.useState(!1),[p,u]=o.useState(""),[h,P]=o.useState(""),[k,$]=o.useState(0),[K,F]=o.useState(!1),[ke,Ee]=o.useState(""),[C,Ce]=o.useState(""),[Is,As]=o.useState(!1),[T,Ie]=o.useState(0),[Ae,_e]=o.useState(!1);o.useEffect(()=>{(async()=>{if(!(s!=null&&s.uid))return;const r=await ts.checkTrialValidity(s.uid);_e(r.isValid&&!r.isExpired),Ie(r.hoursRemaining)})()},[s==null?void 0:s.uid]);const L=(a,r)=>{const m=String(a||"").split(".").map(x=>parseInt(x,10)||0),b=String(r||"").split(".").map(x=>parseInt(x,10)||0);for(let x=0;x<Math.max(m.length,b.length);x++){const D=m[x]||0,V=b[x]||0;if(D>V)return 1;if(D<V)return-1}return 0};o.useEffect(()=>{if(!(!w||!c))try{c.onUpdateAvailable(a=>{var m,b;const r=String(((m=a==null?void 0:a.info)==null?void 0:m.version)||"");u(r),P(String(((b=a==null?void 0:a.info)==null?void 0:b.notes)||"")),L(r,C)>0?S(!0):S(!1)}),c.onUpdateDownloaded(a=>{var m,b;const r=String(((m=a==null?void 0:a.info)==null?void 0:m.version)||"");u(r),P(String(((b=a==null?void 0:a.info)==null?void 0:b.notes)||"")),F(!1),$(100),L(r,C)>0?S(!0):S(!1);try{w&&(s!=null&&s.uid)&&r&&(i==null||i({lastAckDesktopVersion:r}))}catch{}}),c.onUpdateError(a=>{try{f({title:"فشل التحديث",description:String((a==null?void 0:a.message)||(a==null?void 0:a.code)||"تعذر التحميل"),variant:"destructive"})}catch{}}),typeof c.onUpdateProgress=="function"&&c.onUpdateProgress(a=>{const r=(a==null?void 0:a.percent)==null?0:Number(a.percent);F(!0),$(Math.max(0,Math.min(100,isNaN(r)?0:r)))}),typeof c.appVersion=="function"&&c.appVersion().then(a=>{typeof a=="string"&&Ce(a);try{w&&(s!=null&&s.uid)&&typeof a=="string"&&a&&(i==null||i({desktopInstalledVersion:a}))}catch{}}).catch(()=>{})}catch{}},[w,c]),o.useEffect(()=>{w&&k>=100&&N(!0)},[w,k]),o.useEffect(()=>{const a=He(r=>{const m=String((r==null?void 0:r.version)||""),x=`desktop_update_seen_${String((s==null?void 0:s.uid)||"anon")}`;let D="";try{D=localStorage.getItem(x)||""}catch{}if(m&&m!==p){if(L(m,C)>0)if(D===m)S(!1),N(!1);else{S(!0),N(!0);try{localStorage.setItem(x,m)}catch{}}else S(!1);u(m),P(String((r==null?void 0:r.notes)||""));const V=We({downloadURL_64:r==null?void 0:r.downloadURL_64,downloadURL_32:r==null?void 0:r.downloadURL_32})||"";Ee(V)}});return()=>{try{a()}catch{}}},[p,C,s==null?void 0:s.uid]);const Le=async()=>{var a;try{if(c){try{await c.checkUpdate()}catch{}N(!0),F(!0),$(0);const r=await((a=c.downloadUpdate)==null?void 0:a.call(c,ke))??await c.downloadUpdate();if(typeof r=="string"&&r.startsWith("err:")){try{f({title:"فشل التحديث",description:r.slice(4),variant:"destructive"})}catch{}F(!1)}else if(r==="noop")try{f({title:"لا يوجد تحديث",description:"لا تتوفر نسخة أحدث حالياً."})}catch{}else if(r==="manual")try{f({title:"جارٍ تنزيل التحديث",description:"سيتم تطبيق التحديث تلقائيًا بعد اكتمال التنزيل."})}catch{}else if(r==="autoUpdater")try{f({title:"تنزيل تلقائي",description:"سيتم تطبيق التحديث تلقائياً بواسطة النظام."})}catch{}}}catch(r){try{f({title:"فشل التحديث",description:(r==null?void 0:r.message)||"حدث خطأ أثناء التنزيل",variant:"destructive"})}catch{}}},De=async()=>{try{if(c){const a=await c.applyUpdate();if(typeof a=="string"&&a.startsWith("err:"))try{f({title:"فشل تطبيق التحديث",description:a.slice(4),variant:"destructive"})}catch{}}}catch(a){try{f({title:"فشل تطبيق التحديث",description:(a==null?void 0:a.message)||"حدث خطأ أثناء تطبيق التحديث",variant:"destructive"})}catch{}}},Ue=()=>t!=null&&t.fullName?t==null?void 0:t.fullName.split(" ").map(a=>a.charAt(0)).join("").toUpperCase().slice(0,2):s.email?s.email.charAt(0).toUpperCase():"U",ae=t!=null&&t.avatarId?ss(t.avatarId):null;if(o.useEffect(()=>{console.log("Profile updated in ProfileIcon:",t==null?void 0:t.avatarId)},[t==null?void 0:t.avatarId]),o.useEffect(()=>{const a=async r=>{try{if(!(r!=null&&r.data)||typeof r.data!="object"||r.origin!=="https://cashy.link")return;const{type:m,email:b,refresh_token:x}=r.data||{};m==="cashy_oauth_token"&&(s!=null&&s.uid)&&b&&x&&await Cs(s.uid,String(b),String(x))&&f({title:"تم ربط جوجل",description:"تم حفظ توكن النسخ الاحتياطي عبر الخادم."})}catch{}};return window.addEventListener("message",a),()=>window.removeEventListener("message",a)},[s==null?void 0:s.uid]),!s)return null;const Re=async()=>{try{await d()}catch(a){console.error("خطأ في تسجيل الخروج:",a)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[w&&e.jsxs(E,{type:"button",onClick:()=>{N(!0),L(p,C)>0&&S(!0)},title:"تحديث التطبيق",className:"relative inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-blue-600 hover:bg-blue-500/10 focus:outline-none dark:text-blue-400 dark:hover:bg-blue-400/10",variant:"ghost",children:[e.jsx(ns,{className:"w-5 h-5"}),R&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 inline-block w-2 h-2 rounded-full bg-red-500"})]}),e.jsxs(Je,{children:[e.jsx(Xe,{asChild:!0,children:e.jsx(E,{variant:"ghost",disabled:g,title:g?"غير متاح أثناء وجود وردية كاشير نشطة":void 0,className:`relative h-8 w-8 rounded-full p-0 hover:bg-transparent focus:ring-1 focus:ring-primary focus:ring-offset-1 transition-all duration-200 disabled:opacity-60 disabled:cursor-not-allowed ${n}`,children:e.jsx(ye,{className:"h-8 w-8 border border-border shadow-sm hover:shadow-md transition-all duration-200 hover:scale-105 bg-white",children:ae?e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-white dark:bg-neutral-900/20 rounded-full overflow-hidden",children:e.jsx("div",{className:"w-full h-full flex items-center justify-center scale-[2.5]",children:ae.component})}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{src:s.photoURL||void 0,alt:(t==null?void 0:t.fullName)||s.email||"المستخدم",className:"object-cover"}),e.jsx(Pe,{className:"bg-white text-gray-900 font-semibold text-lg border-0",children:Ue()})]})})})}),e.jsxs(Ze,{className:"w-64",align:"end",forceMount:!0,children:[e.jsx(Qe,{className:"font-normal",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:(t==null?void 0:t.fullName)||"المستخدم"}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:s.email}),(t==null?void 0:t.role)&&e.jsxs("p",{className:"text-xs leading-none text-muted-foreground",children:["الدور: ",t.role==="staff"?"مدير":t.role==="merchant"?"تاجر":"مستخدم"]}),Ae&&e.jsx("div",{className:"mt-2 flex items-center justify-center gap-1 bg-emerald-50 border border-emerald-200 text-emerald-800 text-xs rounded-md py-1",children:e.jsxs("span",{className:"font-semibold",children:["تجربة: ",T," ",T>=3&&T<=10?"ساعات":T===2?"ساعتين":"ساعة"]})})]})}),e.jsx(re,{}),e.jsxs(q,{onClick:()=>l("/profile-settings"),className:"cursor-pointer",children:[e.jsx(ze,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"إعدادات البروفيل"})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="staff")&&e.jsxs(q,{onClick:()=>l("/admin"),className:"cursor-pointer",children:[e.jsx(qe,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"لوحة الإدارة"})]}),e.jsx(re,{}),e.jsxs(q,{onClick:Re,className:"cursor-pointer text-red-600 focus:text-red-600",children:[e.jsx(Ye,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"تسجيل الخروج"})]})]})]})]}),w&&e.jsx(ce,{open:G,onOpenChange:a=>{if(N(a),!a){const m=`desktop_update_seen_${String((s==null?void 0:s.uid)||"anon")}`;try{p&&localStorage.setItem(m,p)}catch{}S(!1)}},children:e.jsxs(le,{className:"sm:max-w-md",children:[e.jsx(de,{children:e.jsx(ue,{children:"يوجد تحديث جديد للبرنامج"})}),e.jsx("div",{className:"text-sm",children:K?"جارٍ تنزيل التحديث...":R&&L(p,C)>0?"هل ترغب في تنزيله الآن؟":"التطبيق مُحدَّث لآخر إصدار"}),p&&e.jsxs("div",{className:"mt-2 text-xs",children:["الإصدار الجديد: ",e.jsxs("span",{className:"font-semibold",children:["v",p]})]}),C&&e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["إصدار التطبيق لديك: ",e.jsxs("span",{className:"font-semibold",children:["v",C]})]}),h&&e.jsx("div",{className:"mt-2 text-xs text-muted-foreground whitespace-pre-line",children:h}),K&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"w-full h-2 bg-gray-200 rounded",children:e.jsx("div",{className:"h-2 bg-blue-600 rounded",style:{width:`${k}%`}})}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:[Math.round(k),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 mt-3",children:[e.jsx(E,{variant:"outline",onClick:()=>{const r=`desktop_update_seen_${String((s==null?void 0:s.uid)||"anon")}`;try{p&&localStorage.setItem(r,p)}catch{}S(!1),N(!1)},children:"إلغاء"}),!K&&k<100&&R&&L(p,C)>0&&e.jsx(E,{className:"bg-blue-600 hover:bg-blue-700",onClick:Le,children:"بدء التنزيل"}),k>=100&&e.jsx(E,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{try{if(c!=null&&c.openUpdateFolder){const a=await c.openUpdateFolder();typeof a=="string"&&a.startsWith("err:")?f({title:"تعذر فتح مجلد التحديث",description:a.slice(4),variant:"destructive"}):f({title:"افتح ملف التثبيت",description:"تم فتح مجلد التحديث — اضغط على الملف لتثبيت."})}else await De()}catch(a){f({title:"تعذر فتح مجلد التحديث",description:(a==null?void 0:a.message)||"حدث خطأ غير متوقع",variant:"destructive"})}},children:"تحديث الآن"})]})]})}),e.jsx(ys,{open:y,onOpenChange:v})]})}export{Ms as A,Os as P};
//# sourceMappingURL=ProfileIcon-DRvQJYrX.js.map
