const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CgV0sHeM.js","./index-Cb-j8PFL.css","./WalletManagement-Jf_BAba-.js","./select-Cjxh7T8L.js","./wallet-BjpRmBYz.js","./star-DyMukElk.js","./square-pen-B77-kNO1.js","./arrow-left-L-ZCLYHX.js","./progress-BGmEOiQZ.js","./separator-CArj5DvN.js","./calendar-0_98-YC1.js","./chart-column-DR-1RCFv.js","./trending-down-Kg7mUqrL.js","./dollar-sign-CUtjmL1D.js","./activity-BzRIRPYu.js","./users-DcT8Qdqe.js","./circle-check-big-iKMCgwGI.js","./TransactionDetailsModal-BF2_poqo.js","./SimCardsAccessDialog-ja1xLiJY.js","./printer-D4O-3a9p.js","./ReceiptModal-VfKDuN84.js","./html2canvas.esm-BfYXEYrK.js","./download-DwDr96vs.js","./EditBalanceDialog-D7bP2BFo.js","./ChangePinDialog-B49Baih-.js","./ChangeCashPinDialog-D7JhkTBN.js","./ChangeWalletTotalPinDialog-BGVtWOwo.js","./AddToWalletDialog-U15fsOOe.js","./CalculatorDialog-Ct_uazvC.js","./SalesDataDialog-qajE2To7.js","./table-Ry-VsunV.js","./tabs-B1SNyKq6.js","./index-BVTp5Qlg.js","./dropdown-menu-CLdLSeyn.js","./alert-dialog-CocjFfXp.js","./VideoModal-3NrJTmLh.js","./save-CK42wzuM.js","./pen-line-dJR2NKoC.js","./ProfileSettingsPage-6rJ-8Y1I.js","./switch-CQytG77E.js","./crown-2lrrj6PS.js","./ProfileIcon-CCS5CeGE.js","./freeTrialService-DU5AUvYv.js","./broadcastService-DLuBcfgc.js","./bell-CyrMMN44.js","./profitService-9EsNGq16.js","./arrow-down-left-BR8IyOzF.js","./CashSummaryDialog-C_k_cUDk.js","./battery-charging-DTcxFVrm.js","./CreditCardsDialog-HYhlYCyp.js","./InstallmentModal-CNygnL1g.js","./SimCardsDialog-Ca3l7QZk.js","./wifi-D5OhFBQF.js","./AdslCardsDialog-BRMgPD80.js","./MaintenanceDialog-DP7Ch7_c.js","./MachineDailyDialog-bYSTPv0Q.js","./WalletsManagement-DwgeheI5.js","./WalletPrinterDialog-D0giMR7D.js","./WalletsListDialog-Q840NGnL.js","./building-2-D9Ovqzwm.js","./PendingOperationsDialog-D8YM2DQ6.js","./DailyArchiveHistoryDialog-CixX5AvI.js","./CashierShiftModal-DPV2__M_.js","./functions-VHUwf-oY.js","./ShiftProfileDialog-BD7YmYPO.js","./ChangeLogDialog-BLh_ksJO.js","./sparkles-Dox-dZ7m.js","./dailyOperationCountService-Dsy59IZk.js"])))=>i.map(i=>d[i]);
import{a0 as Ss,R as K,j as t,r as u,B as I,bB as ap,bC as qm,as as Ym,bD as sp,al as uc,an as rp,aq as pn,ao as mr,ap as ns,bG as zm,bk as mc,bH as np,bJ as ip,bL as op,bK as lp,bM as cp,bN as dp,bO as up,bQ as mp,ab as Ca,by as lm,a2 as Bi,W as Ae,t as F,$ as sa,E as gt,p as rr,ci as xs,a1 as fa,q as Ie,s as ce,aL as q,x as ve,u as hc,ad as Km,bI as hp,b7 as nr,ae as At,K as cr,ah as ue,ai as me,aj as ye,ak as he,aK as fp,aG as cm,ay as zt,a6 as ta,a7 as Jm,m as Hi,H as dm,y as G,I as Z,J as um,a5 as gp,ag as Hm,ar as pp,bl as xp,bm as yp,aM as et,aV as We,O as bp,bc as rs,a8 as qa,aP as ic,cj as Yl,a as vp,ck as wp,aQ as Np,cl as jp,be as Sp,X as mm,V as an,n as Dp,bb as ys,af as ae,aR as ne,aZ as tr,w as hm,v as Oi,aO as fm,cm as sn,bi as kp,c as Za,d as bs,e as vs,aw as Sa,aY as Ei,bf as rn,g as es,a3 as Pt,cn as Cp,C as zl,S as Ip,b4 as _p,F as nn,a4 as Ap,bU as Tp,U as on,b5 as gm,aS as Pp,av as ln,bW as Kl,P as Ri,ax as cn,aX as Li,ba as Jl,aa as La,M as Hl,aJ as Wi,bX as Mp,bY as Op,bZ as Ep,b_ as Rp,b$ as Lp,D as dn,c0 as Wp,c1 as pm,au as Zt,Y as xm,b3 as un,bR as Fp,co as Bp,ca as Ql,cp as ym,cq as $p}from"./index-CgV0sHeM.js";import{A as Up,m as Vp,a as Qm,u as mn,f as ws,B as bm,C as qp,b as Gl,S as vm,c as wm}from"./SimCardsAccessDialog-ja1xLiJY.js";import{C as $i,V as Gm}from"./VideoModal-3NrJTmLh.js";import{C as Yp,S as zp,P as Kp,a as Jp,w as Hp}from"./ProfileSettingsPage-6rJ-8Y1I.js";import{S as Nm,T as Qp,a as Gp,b as jm,c as Sm}from"./tabs-B1SNyKq6.js";import{S as Fa,a as Ba,b as $a,c as Ua,d as oa,C as Xp,e as Zp}from"./select-Cjxh7T8L.js";import{C as ex,D as tx,a as ax,b as sx,f as rx}from"./dropdown-menu-CLdLSeyn.js";import{S as nx}from"./switch-CQytG77E.js";import{P as ix}from"./ProfileIcon-CCS5CeGE.js";import{E as ox,a as lx}from"./broadcastService-DLuBcfgc.js";import{B as Fi}from"./bell-CyrMMN44.js";import{C as zi}from"./circle-check-big-iKMCgwGI.js";import{ProfitService as ga}from"./profitService-9EsNGq16.js";import{C as Ui}from"./calendar-0_98-YC1.js";import{A as ir}from"./arrow-down-left-BR8IyOzF.js";import{D as Va}from"./dollar-sign-CUtjmL1D.js";import{c as Xm,R as cx,I as dx}from"./index-BVTp5Qlg.js";import{FreeTrialService as Dm}from"./freeTrialService-DU5AUvYv.js";import{W as ar}from"./wallet-BjpRmBYz.js";import{C as ux}from"./crown-2lrrj6PS.js";import{S as km}from"./square-pen-B77-kNO1.js";import{P as mx}from"./printer-D4O-3a9p.js";import{S as hx}from"./star-DyMukElk.js";import{C as fx}from"./users-DcT8Qdqe.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gx=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Cm=Ss("calendar-days",gx);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const px=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],xx=Ss("chevron-left",px);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yx=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],bx=Ss("circle-plus",yx);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vx=[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]],Im=Ss("notebook",vx);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wx=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Zm=Ss("package",wx);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],jx=Ss("party-popper",Nx);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sx=[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]],Dx=Ss("youtube",Sx);var Vi={linear:function(s,e,n,i){var l=n-e;return l*s/i+e},easeInQuad:function(s,e,n,i){var l=n-e;return l*(s/=i)*s+e},easeOutQuad:function(s,e,n,i){var l=n-e;return-l*(s/=i)*(s-2)+e},easeInOutQuad:function(s,e,n,i){var l=n-e;return(s/=i/2)<1?l/2*s*s+e:-l/2*(--s*(s-2)-1)+e},easeInCubic:function(s,e,n,i){var l=n-e;return l*(s/=i)*s*s+e},easeOutCubic:function(s,e,n,i){var l=n-e;return l*((s=s/i-1)*s*s+1)+e},easeInOutCubic:function(s,e,n,i){var l=n-e;return(s/=i/2)<1?l/2*s*s*s+e:l/2*((s-=2)*s*s+2)+e},easeInQuart:function(s,e,n,i){var l=n-e;return l*(s/=i)*s*s*s+e},easeOutQuart:function(s,e,n,i){var l=n-e;return-l*((s=s/i-1)*s*s*s-1)+e},easeInOutQuart:function(s,e,n,i){var l=n-e;return(s/=i/2)<1?l/2*s*s*s*s+e:-l/2*((s-=2)*s*s*s-2)+e},easeInQuint:function(s,e,n,i){var l=n-e;return l*(s/=i)*s*s*s*s+e},easeOutQuint:function(s,e,n,i){var l=n-e;return l*((s=s/i-1)*s*s*s*s+1)+e},easeInOutQuint:function(s,e,n,i){var l=n-e;return(s/=i/2)<1?l/2*s*s*s*s*s+e:l/2*((s-=2)*s*s*s*s+2)+e},easeInSine:function(s,e,n,i){var l=n-e;return-l*Math.cos(s/i*(Math.PI/2))+l+e},easeOutSine:function(s,e,n,i){var l=n-e;return l*Math.sin(s/i*(Math.PI/2))+e},easeInOutSine:function(s,e,n,i){var l=n-e;return-l/2*(Math.cos(Math.PI*s/i)-1)+e},easeInExpo:function(s,e,n,i){var l=n-e;return s==0?e:l*Math.pow(2,10*(s/i-1))+e},easeOutExpo:function(s,e,n,i){var l=n-e;return s==i?e+l:l*(-Math.pow(2,-10*s/i)+1)+e},easeInOutExpo:function(s,e,n,i){var l=n-e;return s===0?e:s===i?e+l:(s/=i/2)<1?l/2*Math.pow(2,10*(s-1))+e:l/2*(-Math.pow(2,-10*--s)+2)+e},easeInCirc:function(s,e,n,i){var l=n-e;return-l*(Math.sqrt(1-(s/=i)*s)-1)+e},easeOutCirc:function(s,e,n,i){var l=n-e;return l*Math.sqrt(1-(s=s/i-1)*s)+e},easeInOutCirc:function(s,e,n,i){var l=n-e;return(s/=i/2)<1?-l/2*(Math.sqrt(1-s*s)-1)+e:l/2*(Math.sqrt(1-(s-=2)*s)+1)+e},easeInElastic:function(s,e,n,i){var l=n-e,h,p,b;return b=1.70158,p=0,h=l,s===0?e:(s/=i)===1?e+l:(p||(p=i*.3),h<Math.abs(l)?(h=l,b=p/4):b=p/(2*Math.PI)*Math.asin(l/h),-(h*Math.pow(2,10*(s-=1))*Math.sin((s*i-b)*(2*Math.PI)/p))+e)},easeOutElastic:function(s,e,n,i){var l=n-e,h,p,b;return b=1.70158,p=0,h=l,s===0?e:(s/=i)===1?e+l:(p||(p=i*.3),h<Math.abs(l)?(h=l,b=p/4):b=p/(2*Math.PI)*Math.asin(l/h),h*Math.pow(2,-10*s)*Math.sin((s*i-b)*(2*Math.PI)/p)+l+e)},easeInOutElastic:function(s,e,n,i){var l=n-e,h,p,b;return b=1.70158,p=0,h=l,s===0?e:(s/=i/2)===2?e+l:(p||(p=i*(.3*1.5)),h<Math.abs(l)?(h=l,b=p/4):b=p/(2*Math.PI)*Math.asin(l/h),s<1?-.5*(h*Math.pow(2,10*(s-=1))*Math.sin((s*i-b)*(2*Math.PI)/p))+e:h*Math.pow(2,-10*(s-=1))*Math.sin((s*i-b)*(2*Math.PI)/p)*.5+l+e)},easeInBack:function(s,e,n,i,l){var h=n-e;return l===void 0&&(l=1.70158),h*(s/=i)*s*((l+1)*s-l)+e},easeOutBack:function(s,e,n,i,l){var h=n-e;return l===void 0&&(l=1.70158),h*((s=s/i-1)*s*((l+1)*s+l)+1)+e},easeInOutBack:function(s,e,n,i,l){var h=n-e;return l===void 0&&(l=1.70158),(s/=i/2)<1?h/2*(s*s*(((l*=1.525)+1)*s-l))+e:h/2*((s-=2)*s*(((l*=1.525)+1)*s+l)+2)+e},easeInBounce:function(s,e,n,i){var l=n-e,h;return h=Vi.easeOutBounce(i-s,0,l,i),l-h+e},easeOutBounce:function(s,e,n,i){var l=n-e;return(s/=i)<1/2.75?l*(7.5625*s*s)+e:s<2/2.75?l*(7.5625*(s-=1.5/2.75)*s+.75)+e:s<2.5/2.75?l*(7.5625*(s-=2.25/2.75)*s+.9375)+e:l*(7.5625*(s-=2.625/2.75)*s+.984375)+e},easeInOutBounce:function(s,e,n,i){var l=n-e,h;return s<i/2?(h=Vi.easeInBounce(s*2,0,l,i),h*.5+e):(h=Vi.easeOutBounce(s*2-i,0,l,i),h*.5+l*.5+e)}},kx=Vi;function Cx(s){return s*Math.PI/180}function aa(s,e){return s+Math.random()*(e-s)}function Ix(s,e){return Math.floor(s+Math.random()*(e-s+1))}var fn;(function(s){s[s.Circle=0]="Circle",s[s.Square=1]="Square",s[s.Strip=2]="Strip"})(fn||(fn={}));var ss;(function(s){s[s.Positive=1]="Positive",s[s.Negative=-1]="Negative"})(ss||(ss={}));const _x=1e3/60;class Ax{constructor(e,n,i,l){this.getOptions=n;const{colors:h,initialVelocityX:p,initialVelocityY:b}=this.getOptions();this.context=e,this.x=i,this.y=l,this.w=aa(5,20),this.h=aa(5,20),this.radius=aa(5,10),this.vx=typeof p=="number"?aa(-p,p):aa(p.min,p.max),this.vy=typeof b=="number"?aa(-b,0):aa(b.min,b.max),this.shape=Ix(0,2),this.angle=Cx(aa(0,360)),this.angularSpin=aa(-.2,.2),this.color=h[Math.floor(Math.random()*h.length)],this.rotateY=aa(0,1),this.rotationDirection=aa(0,1)?ss.Positive:ss.Negative}update(e){const{gravity:n,wind:i,friction:l,opacity:h,drawShape:p}=this.getOptions(),b=e/_x;this.x+=this.vx*b,this.y+=this.vy*b,this.vy+=n*b,this.vx+=i*b,this.vx*=l**b,this.vy*=l**b,this.rotateY>=1&&this.rotationDirection===ss.Positive?this.rotationDirection=ss.Negative:this.rotateY<=-1&&this.rotationDirection===ss.Negative&&(this.rotationDirection=ss.Positive);const C=.1*this.rotationDirection*b;if(this.rotateY+=C,this.angle+=this.angularSpin,this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(this.angle),this.context.scale(1,this.rotateY),this.context.rotate(this.angle),this.context.beginPath(),this.context.fillStyle=this.color,this.context.strokeStyle=this.color,this.context.globalAlpha=h,this.context.lineCap="round",this.context.lineWidth=2,p&&typeof p=="function")p.call(this,this.context);else switch(this.shape){case fn.Circle:{this.context.beginPath(),this.context.arc(0,0,this.radius,0,2*Math.PI),this.context.fill();break}case fn.Square:{this.context.fillRect(-this.w/2,-this.h/2,this.w,this.h);break}case fn.Strip:{this.context.fillRect(-this.w/6,-this.h/2,this.w/3,this.h);break}}this.context.closePath(),this.context.restore()}}class Tx{constructor(e,n){this.x=0,this.y=0,this.w=0,this.h=0,this.lastNumberOfPieces=0,this.tweenProgress=0,this.tweenFrom=0,this.particles=[],this.particlesGenerated=0,this.removeParticleAt=l=>{this.particles.splice(l,1)},this.getParticle=()=>{const l=aa(this.x,this.w+this.x),h=aa(this.y,this.h+this.y);return new Ax(this.context,this.getOptions,l,h)},this.animate=l=>{const{canvas:h,context:p,particlesGenerated:b,lastNumberOfPieces:C}=this,{run:k,recycle:D,numberOfPieces:T,debug:E,tweenFunction:M,tweenDuration:$}=this.getOptions();if(!k)return!1;const y=this.particles.length,W=D?y:b;if(W<T){C!==T&&(this.tweenProgress=0,this.tweenFrom=W,this.lastNumberOfPieces=T),this.tweenProgress=Math.min($,Math.max(0,this.tweenProgress+l));const ie=M(this.tweenProgress,this.tweenFrom,T,$),J=Math.round(ie-W);for(let V=0;V<J;V++)this.particles.push(this.getParticle());this.particlesGenerated+=J}E&&(p.font="12px sans-serif",p.fillStyle="#333",p.textAlign="right",p.fillText(`Particles: ${y}`,h.width-10,h.height-20));for(let ie=this.particles.length-1;ie>=0;ie--){const J=this.particles[ie];J.update(l),(J.y>h.height||J.y<-100||J.x>h.width+100||J.x<-100)&&(D&&W<=T?this.particles[ie]=this.getParticle():this.removeParticleAt(ie))}return y>0||W<T},this.canvas=e;const i=this.canvas.getContext("2d");if(!i)throw new Error("Could not get canvas context");this.context=i,this.getOptions=n}}const fc={width:typeof window<"u"?window.innerWidth:300,height:typeof window<"u"?window.innerHeight:200,numberOfPieces:200,friction:.99,wind:0,gravity:.1,initialVelocityX:4,initialVelocityY:10,colors:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"],opacity:1,debug:!1,tweenFunction:kx.easeInOutQuad,tweenDuration:5e3,recycle:!0,run:!0};class Px{constructor(e,n){this.lastFrameTime=0,this.setOptionsWithDefaults=l=>{const h={confettiSource:{x:0,y:0,w:this.canvas.width,h:0}};this._options={...h,...fc,...l},Object.assign(this,l.confettiSource)},this.update=(l=0)=>{const{options:{run:h,onConfettiComplete:p,frameRate:b},canvas:C,context:k}=this,D=Math.min(l-this.lastFrameTime,50);if(b&&D<1e3/b){this.rafId=requestAnimationFrame(this.update);return}this.lastFrameTime=l-(b?D%b:0),h&&(k.fillStyle="white",k.clearRect(0,0,C.width,C.height)),this.generator.animate(D)?this.rafId=requestAnimationFrame(this.update):(p&&typeof p=="function"&&this.generator.particlesGenerated>0&&p.call(this,this),this._options.run=!1)},this.reset=()=>{this.generator&&this.generator.particlesGenerated>0&&(this.generator.particlesGenerated=0,this.generator.particles=[],this.generator.lastNumberOfPieces=0)},this.stop=()=>{this.options={run:!1},this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0)},this.canvas=e;const i=this.canvas.getContext("2d");if(!i)throw new Error("Could not get canvas context");this.context=i,this.generator=new Tx(this.canvas,()=>this.options),this.options=n,this.update()}get options(){return this._options}set options(e){var l,h;const n=(l=this._options)==null?void 0:l.run,i=(h=this._options)==null?void 0:h.recycle;this.setOptionsWithDefaults(e),this.generator&&(Object.assign(this.generator,this.options.confettiSource),typeof e.recycle=="boolean"&&e.recycle&&i===!1&&(this.generator.lastNumberOfPieces=this.generator.particles.length)),typeof e.run=="boolean"&&e.run&&n===!1&&this.update()}}const Mx=K.createRef();class gc extends K.Component{constructor(e){super(e),this.canvas=K.createRef(),this.canvas=e.canvasRef||Mx}componentDidMount(){if(this.canvas.current){const e=Xl(this.props)[0];this.confetti=new Px(this.canvas.current,e)}}componentDidUpdate(){const e=Xl(this.props)[0];this.confetti&&(this.confetti.options=e)}componentWillUnmount(){this.confetti&&this.confetti.stop(),this.confetti=void 0}render(){const[e,n]=Xl(this.props),i={zIndex:2,position:"absolute",pointerEvents:"none",top:0,left:0,bottom:0,right:0,...n.style};return t.jsx("canvas",{width:e.width,height:e.height,ref:this.canvas,...n,style:i})}}gc.defaultProps={...fc};gc.displayName="ReactConfetti";function Xl(s){const e={},n={},i={},l=[...Object.keys(fc),"confettiSource","drawShape","onConfettiComplete","frameRate"],h=["canvasRef"];for(const p in s){const b=s[p];l.includes(p)?e[p]=b:h.includes(p)?h[p]=b:i[p]=b}return[e,i,n]}const Ox=K.forwardRef((s,e)=>t.jsx(gc,{canvasRef:e,...s})),Ex=({isOpen:s,onClose:e,userName:n})=>{const[i,l]=u.useState({width:window.innerWidth,height:window.innerHeight});return u.useEffect(()=>{const h=()=>{l({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]),t.jsx(Up,{children:s&&t.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:[t.jsx(Ox,{width:i.width,height:i.height,recycle:!0,numberOfPieces:200,gravity:.15}),t.jsxs(Vp.div,{initial:{scale:.5,opacity:0,y:50},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0},transition:{type:"spring",duration:.8,bounce:.5},className:"relative w-full max-w-lg bg-white dark:bg-slate-900 rounded-3xl shadow-2xl overflow-hidden border-4 border-indigo-100 dark:border-indigo-900",children:[t.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-purple-200 dark:bg-purple-900/30 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2"}),t.jsx("div",{className:"absolute bottom-0 right-0 w-32 h-32 bg-blue-200 dark:bg-blue-900/30 rounded-full blur-3xl translate-x-1/2 translate-y-1/2"}),t.jsxs("div",{className:"relative p-8 text-center space-y-6",children:[t.jsx("div",{className:"mx-auto w-24 h-24 bg-gradient-to-tr from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-4 ring-4 ring-white dark:ring-slate-800",children:t.jsx(jx,{className:"w-12 h-12 text-white animate-bounce"})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h2",{className:"text-3xl font-extrabold leading-tight bg-clip-text text-transparent bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 dark:from-indigo-400 dark:via-purple-400 dark:to-pink-400",children:["Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¹Ø§Ø¦Ù„Ø©",t.jsx("br",{}),t.jsx("span",{className:"text-4xl",children:"Cashy Link! ðŸš€"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"text-xl text-gray-800 dark:text-gray-200 font-bold",children:n?`Ø£Ù‡Ù„Ø§Ù‹ ${n}ØŒ`:""}),t.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 font-medium",children:"Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ ØªØ¬Ø±Ø¨Ø© Ø³Ø¹ÙŠØ¯Ø© ÙˆÙ…Ù…ÙŠØ²Ø© Ù…Ø¹Ù†Ø§."})]}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-slate-800/50 p-4 rounded-xl border border-gray-100 dark:border-slate-800",children:"Ù„Ù‚Ø¯ Ø£ØµØ¨Ø­Øª Ø§Ù„Ø¢Ù† Ø¬Ø²Ø¡Ø§Ù‹ Ù…Ù† Ù…Ø¬ØªÙ…Ø¹Ù†Ø§ Ø§Ù„Ù…Ù…ÙŠØ². Ø§Ø³ØªÙ…ØªØ¹ Ø¨ÙƒÙ„ Ø§Ù„Ù…Ø²Ø§ÙŠØ§ Ø§Ù„Ø­ØµØ±ÙŠØ© Ø§Ù„ØªÙŠ Ù†Ù‚Ø¯Ù…Ù‡Ø§ Ù„Ùƒ!"})]}),t.jsx("div",{className:"pt-2",children:t.jsx(I,{onClick:e,size:"lg",className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-6 rounded-xl text-lg shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 active:translate-y-0",children:"Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø¢Ù† âœ¨"})})]})]})]})})};function Rx(s){const e=Lx(s),n=u.forwardRef((i,l)=>{const{children:h,...p}=i,b=u.Children.toArray(h),C=b.find(Fx);if(C){const k=C.props.children,D=b.map(T=>T===C?u.Children.count(k)>1?u.Children.only(null):u.isValidElement(k)?k.props.children:null:T);return t.jsx(e,{...p,ref:l,children:u.isValidElement(k)?u.cloneElement(k,void 0,D):null})}return t.jsx(e,{...p,ref:l,children:h})});return n.displayName=`${s}.Slot`,n}function Lx(s){const e=u.forwardRef((n,i)=>{const{children:l,...h}=n;if(u.isValidElement(l)){const p=$x(l),b=Bx(h,l.props);return l.type!==u.Fragment&&(b.ref=i?ap(i,p):p),u.cloneElement(l,b)}return u.Children.count(l)>1?u.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var Wx=Symbol("radix.slottable");function Fx(s){return u.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===Wx}function Bx(s,e){const n={...e};for(const i in e){const l=s[i],h=e[i];/^on[A-Z]/.test(i)?l&&h?n[i]=(...b)=>{const C=h(...b);return l(...b),C}:l&&(n[i]=l):i==="style"?n[i]={...l,...h}:i==="className"&&(n[i]=[l,h].filter(Boolean).join(" "))}return{...s,...n}}function $x(s){var i,l;let e=(i=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?s.ref:(e=(l=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:l.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?s.props.ref:s.props.ref||s.ref)}var Qi="Popover",[eh]=uc(Qi,[qm]),xn=qm(),[Ux,is]=eh(Qi),th=s=>{const{__scopePopover:e,children:n,open:i,defaultOpen:l,onOpenChange:h,modal:p=!1}=s,b=xn(e),C=u.useRef(null),[k,D]=u.useState(!1),[T,E]=Ym({prop:i,defaultProp:l??!1,onChange:h,caller:Qi});return t.jsx(sp,{...b,children:t.jsx(Ux,{scope:e,contentId:rp(),triggerRef:C,open:T,onOpenChange:E,onOpenToggle:u.useCallback(()=>E(M=>!M),[E]),hasCustomAnchor:k,onCustomAnchorAdd:u.useCallback(()=>D(!0),[]),onCustomAnchorRemove:u.useCallback(()=>D(!1),[]),modal:p,children:n})})};th.displayName=Qi;var ah="PopoverAnchor",Vx=u.forwardRef((s,e)=>{const{__scopePopover:n,...i}=s,l=is(ah,n),h=xn(n),{onCustomAnchorAdd:p,onCustomAnchorRemove:b}=l;return u.useEffect(()=>(p(),()=>b()),[p,b]),t.jsx(zm,{...h,...i,ref:e})});Vx.displayName=ah;var sh="PopoverTrigger",rh=u.forwardRef((s,e)=>{const{__scopePopover:n,...i}=s,l=is(sh,n),h=xn(n),p=pn(e,l.triggerRef),b=t.jsx(mr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":l.open,"aria-controls":l.contentId,"data-state":ch(l.open),...i,ref:p,onClick:ns(s.onClick,l.onOpenToggle)});return l.hasCustomAnchor?b:t.jsx(zm,{asChild:!0,...h,children:b})});rh.displayName=sh;var pc="PopoverPortal",[qx,Yx]=eh(pc,{forceMount:void 0}),nh=s=>{const{__scopePopover:e,forceMount:n,children:i,container:l}=s,h=is(pc,e);return t.jsx(qx,{scope:e,forceMount:n,children:t.jsx(mc,{present:n||h.open,children:t.jsx(np,{asChild:!0,container:l,children:i})})})};nh.displayName=pc;var dr="PopoverContent",ih=u.forwardRef((s,e)=>{const n=Yx(dr,s.__scopePopover),{forceMount:i=n.forceMount,...l}=s,h=is(dr,s.__scopePopover);return t.jsx(mc,{present:i||h.open,children:h.modal?t.jsx(Kx,{...l,ref:e}):t.jsx(Jx,{...l,ref:e})})});ih.displayName=dr;var zx=Rx("PopoverContent.RemoveScroll"),Kx=u.forwardRef((s,e)=>{const n=is(dr,s.__scopePopover),i=u.useRef(null),l=pn(e,i),h=u.useRef(!1);return u.useEffect(()=>{const p=i.current;if(p)return ip(p)},[]),t.jsx(op,{as:zx,allowPinchZoom:!0,children:t.jsx(oh,{...s,ref:l,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ns(s.onCloseAutoFocus,p=>{var b;p.preventDefault(),h.current||(b=n.triggerRef.current)==null||b.focus()}),onPointerDownOutside:ns(s.onPointerDownOutside,p=>{const b=p.detail.originalEvent,C=b.button===0&&b.ctrlKey===!0,k=b.button===2||C;h.current=k},{checkForDefaultPrevented:!1}),onFocusOutside:ns(s.onFocusOutside,p=>p.preventDefault(),{checkForDefaultPrevented:!1})})})}),Jx=u.forwardRef((s,e)=>{const n=is(dr,s.__scopePopover),i=u.useRef(!1),l=u.useRef(!1);return t.jsx(oh,{...s,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:h=>{var p,b;(p=s.onCloseAutoFocus)==null||p.call(s,h),h.defaultPrevented||(i.current||(b=n.triggerRef.current)==null||b.focus(),h.preventDefault()),i.current=!1,l.current=!1},onInteractOutside:h=>{var C,k;(C=s.onInteractOutside)==null||C.call(s,h),h.defaultPrevented||(i.current=!0,h.detail.originalEvent.type==="pointerdown"&&(l.current=!0));const p=h.target;((k=n.triggerRef.current)==null?void 0:k.contains(p))&&h.preventDefault(),h.detail.originalEvent.type==="focusin"&&l.current&&h.preventDefault()}})}),oh=u.forwardRef((s,e)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:l,onCloseAutoFocus:h,disableOutsidePointerEvents:p,onEscapeKeyDown:b,onPointerDownOutside:C,onFocusOutside:k,onInteractOutside:D,...T}=s,E=is(dr,n),M=xn(n);return lp(),t.jsx(cp,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:l,onUnmountAutoFocus:h,children:t.jsx(dp,{asChild:!0,disableOutsidePointerEvents:p,onInteractOutside:D,onEscapeKeyDown:b,onPointerDownOutside:C,onFocusOutside:k,onDismiss:()=>E.onOpenChange(!1),children:t.jsx(up,{"data-state":ch(E.open),role:"dialog",id:E.contentId,...M,...T,ref:e,style:{...T.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),lh="PopoverClose",Hx=u.forwardRef((s,e)=>{const{__scopePopover:n,...i}=s,l=is(lh,n);return t.jsx(mr.button,{type:"button",...i,ref:e,onClick:ns(s.onClick,()=>l.onOpenChange(!1))})});Hx.displayName=lh;var Qx="PopoverArrow",Gx=u.forwardRef((s,e)=>{const{__scopePopover:n,...i}=s,l=xn(n);return t.jsx(mp,{...l,...i,ref:e})});Gx.displayName=Qx;function ch(s){return s?"open":"closed"}var Xx=th,Zx=rh,ey=nh,dh=ih;const _m=Xx,Am=Zx,oc=u.forwardRef(({className:s,align:e="center",sideOffset:n=4,...i},l)=>t.jsx(ey,{children:t.jsx(dh,{ref:l,align:e,sideOffset:n,className:Ca("z-[9999] w-72 rounded-xl border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})}));oc.displayName=dh.displayName;function Re(s){const e=Object.prototype.toString.call(s);return s instanceof Date||typeof s=="object"&&e==="[object Date]"?new s.constructor(+s):typeof s=="number"||e==="[object Number]"||typeof s=="string"||e==="[object String]"?new Date(s):new Date(NaN)}function ra(s,e){return s instanceof Date?new s.constructor(e):new Date(e)}function Bt(s,e){const n=Re(s);return isNaN(e)?ra(s,NaN):(e&&n.setDate(n.getDate()+e),n)}function xa(s,e){const n=Re(s);if(isNaN(e))return ra(s,NaN);if(!e)return n;const i=n.getDate(),l=ra(s,n.getTime());l.setMonth(n.getMonth()+e+1,0);const h=l.getDate();return i>=h?l:(n.setFullYear(l.getFullYear(),l.getMonth(),i),n)}const xc=6048e5,ty=864e5;let ay={};function yn(){return ay}function _a(s,e){var b,C,k,D;const n=yn(),i=(e==null?void 0:e.weekStartsOn)??((C=(b=e==null?void 0:e.locale)==null?void 0:b.options)==null?void 0:C.weekStartsOn)??n.weekStartsOn??((D=(k=n.locale)==null?void 0:k.options)==null?void 0:D.weekStartsOn)??0,l=Re(s),h=l.getDay(),p=(h<i?7:0)+h-i;return l.setDate(l.getDate()-p),l.setHours(0,0,0,0),l}function js(s){return _a(s,{weekStartsOn:1})}function uh(s){const e=Re(s),n=e.getFullYear(),i=ra(s,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const l=js(i),h=ra(s,0);h.setFullYear(n,0,4),h.setHours(0,0,0,0);const p=js(h);return e.getTime()>=l.getTime()?n+1:e.getTime()>=p.getTime()?n:n-1}function ur(s){const e=Re(s);return e.setHours(0,0,0,0),e}function Ki(s){const e=Re(s),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+s-+n}function Ia(s,e){const n=ur(s),i=ur(e),l=+n-Ki(n),h=+i-Ki(i);return Math.round((l-h)/ty)}function sy(s){const e=uh(s),n=ra(s,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),js(n)}function lc(s,e){const n=e*7;return Bt(s,n)}function ry(s,e){return xa(s,e*12)}function ny(s){let e;return s.forEach(function(n){const i=Re(n);(e===void 0||e<i||isNaN(Number(i)))&&(e=i)}),e||new Date(NaN)}function iy(s){let e;return s.forEach(n=>{const i=Re(n);(!e||e>i||isNaN(+i))&&(e=i)}),e||new Date(NaN)}function Kt(s,e){const n=ur(s),i=ur(e);return+n==+i}function yc(s){return s instanceof Date||typeof s=="object"&&Object.prototype.toString.call(s)==="[object Date]"}function oy(s){if(!yc(s)&&typeof s!="number")return!1;const e=Re(s);return!isNaN(Number(e))}function gn(s,e){const n=Re(s),i=Re(e),l=n.getFullYear()-i.getFullYear(),h=n.getMonth()-i.getMonth();return l*12+h}function ly(s,e,n){const i=_a(s,n),l=_a(e,n),h=+i-Ki(i),p=+l-Ki(l);return Math.round((h-p)/xc)}function bc(s){const e=Re(s),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function Jt(s){const e=Re(s);return e.setDate(1),e.setHours(0,0,0,0),e}function mh(s){const e=Re(s),n=ra(s,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function vc(s,e){var b,C,k,D;const n=yn(),i=(e==null?void 0:e.weekStartsOn)??((C=(b=e==null?void 0:e.locale)==null?void 0:b.options)==null?void 0:C.weekStartsOn)??n.weekStartsOn??((D=(k=n.locale)==null?void 0:k.options)==null?void 0:D.weekStartsOn)??0,l=Re(s),h=l.getDay(),p=(h<i?-7:0)+6-(h-i);return l.setDate(l.getDate()+p),l.setHours(23,59,59,999),l}function hh(s){return vc(s,{weekStartsOn:1})}const cy={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},dy=(s,e,n)=>{let i;const l=cy[s];return typeof l=="string"?i=l:e===1?i=l.one:i=l.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function lr(s){return(e={})=>{const n=e.width?String(e.width):s.defaultWidth;return s.formats[n]||s.formats[s.defaultWidth]}}const uy={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},my={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},hy={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},fy={date:lr({formats:uy,defaultWidth:"full"}),time:lr({formats:my,defaultWidth:"full"}),dateTime:lr({formats:hy,defaultWidth:"full"})},gy={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},py=(s,e,n,i)=>gy[s];function Da(s){return(e,n)=>{const i=n!=null&&n.context?String(n.context):"standalone";let l;if(i==="formatting"&&s.formattingValues){const p=s.defaultFormattingWidth||s.defaultWidth,b=n!=null&&n.width?String(n.width):p;l=s.formattingValues[b]||s.formattingValues[p]}else{const p=s.defaultWidth,b=n!=null&&n.width?String(n.width):s.defaultWidth;l=s.values[b]||s.values[p]}const h=s.argumentCallback?s.argumentCallback(e):e;return l[h]}}const xy={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},yy={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},by={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},vy={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},wy={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ny={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},jy=(s,e)=>{const n=Number(s),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Sy={ordinalNumber:jy,era:Da({values:xy,defaultWidth:"wide"}),quarter:Da({values:yy,defaultWidth:"wide",argumentCallback:s=>s-1}),month:Da({values:by,defaultWidth:"wide"}),day:Da({values:vy,defaultWidth:"wide"}),dayPeriod:Da({values:wy,defaultWidth:"wide",formattingValues:Ny,defaultFormattingWidth:"wide"})};function ka(s){return(e,n={})=>{const i=n.width,l=i&&s.matchPatterns[i]||s.matchPatterns[s.defaultMatchWidth],h=e.match(l);if(!h)return null;const p=h[0],b=i&&s.parsePatterns[i]||s.parsePatterns[s.defaultParseWidth],C=Array.isArray(b)?ky(b,T=>T.test(p)):Dy(b,T=>T.test(p));let k;k=s.valueCallback?s.valueCallback(C):C,k=n.valueCallback?n.valueCallback(k):k;const D=e.slice(p.length);return{value:k,rest:D}}}function Dy(s,e){for(const n in s)if(Object.prototype.hasOwnProperty.call(s,n)&&e(s[n]))return n}function ky(s,e){for(let n=0;n<s.length;n++)if(e(s[n]))return n}function fh(s){return(e,n={})=>{const i=e.match(s.matchPattern);if(!i)return null;const l=i[0],h=e.match(s.parsePattern);if(!h)return null;let p=s.valueCallback?s.valueCallback(h[0]):h[0];p=n.valueCallback?n.valueCallback(p):p;const b=e.slice(l.length);return{value:p,rest:b}}}const Cy=/^(\d+)(th|st|nd|rd)?/i,Iy=/\d+/i,_y={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Ay={any:[/^b/i,/^(a|c)/i]},Ty={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Py={any:[/1/i,/2/i,/3/i,/4/i]},My={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Oy={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Ey={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Ry={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ly={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Wy={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Fy={ordinalNumber:fh({matchPattern:Cy,parsePattern:Iy,valueCallback:s=>parseInt(s,10)}),era:ka({matchPatterns:_y,defaultMatchWidth:"wide",parsePatterns:Ay,defaultParseWidth:"any"}),quarter:ka({matchPatterns:Ty,defaultMatchWidth:"wide",parsePatterns:Py,defaultParseWidth:"any",valueCallback:s=>s+1}),month:ka({matchPatterns:My,defaultMatchWidth:"wide",parsePatterns:Oy,defaultParseWidth:"any"}),day:ka({matchPatterns:Ey,defaultMatchWidth:"wide",parsePatterns:Ry,defaultParseWidth:"any"}),dayPeriod:ka({matchPatterns:Ly,defaultMatchWidth:"any",parsePatterns:Wy,defaultParseWidth:"any"})},gh={code:"en-US",formatDistance:dy,formatLong:fy,formatRelative:py,localize:Sy,match:Fy,options:{weekStartsOn:0,firstWeekContainsDate:1}};function By(s){const e=Re(s);return Ia(e,mh(e))+1}function ph(s){const e=Re(s),n=+js(e)-+sy(e);return Math.round(n/xc)+1}function xh(s,e){var D,T,E,M;const n=Re(s),i=n.getFullYear(),l=yn(),h=(e==null?void 0:e.firstWeekContainsDate)??((T=(D=e==null?void 0:e.locale)==null?void 0:D.options)==null?void 0:T.firstWeekContainsDate)??l.firstWeekContainsDate??((M=(E=l.locale)==null?void 0:E.options)==null?void 0:M.firstWeekContainsDate)??1,p=ra(s,0);p.setFullYear(i+1,0,h),p.setHours(0,0,0,0);const b=_a(p,e),C=ra(s,0);C.setFullYear(i,0,h),C.setHours(0,0,0,0);const k=_a(C,e);return n.getTime()>=b.getTime()?i+1:n.getTime()>=k.getTime()?i:i-1}function $y(s,e){var b,C,k,D;const n=yn(),i=(e==null?void 0:e.firstWeekContainsDate)??((C=(b=e==null?void 0:e.locale)==null?void 0:b.options)==null?void 0:C.firstWeekContainsDate)??n.firstWeekContainsDate??((D=(k=n.locale)==null?void 0:k.options)==null?void 0:D.firstWeekContainsDate)??1,l=xh(s,e),h=ra(s,0);return h.setFullYear(l,0,i),h.setHours(0,0,0,0),_a(h,e)}function yh(s,e){const n=Re(s),i=+_a(n,e)-+$y(n,e);return Math.round(i/xc)+1}function qe(s,e){const n=s<0?"-":"",i=Math.abs(s).toString().padStart(e,"0");return n+i}const ts={y(s,e){const n=s.getFullYear(),i=n>0?n:1-n;return qe(e==="yy"?i%100:i,e.length)},M(s,e){const n=s.getMonth();return e==="M"?String(n+1):qe(n+1,2)},d(s,e){return qe(s.getDate(),e.length)},a(s,e){const n=s.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(s,e){return qe(s.getHours()%12||12,e.length)},H(s,e){return qe(s.getHours(),e.length)},m(s,e){return qe(s.getMinutes(),e.length)},s(s,e){return qe(s.getSeconds(),e.length)},S(s,e){const n=e.length,i=s.getMilliseconds(),l=Math.trunc(i*Math.pow(10,n-3));return qe(l,e.length)}},sr={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Tm={G:function(s,e,n){const i=s.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(s,e,n){if(e==="yo"){const i=s.getFullYear(),l=i>0?i:1-i;return n.ordinalNumber(l,{unit:"year"})}return ts.y(s,e)},Y:function(s,e,n,i){const l=xh(s,i),h=l>0?l:1-l;if(e==="YY"){const p=h%100;return qe(p,2)}return e==="Yo"?n.ordinalNumber(h,{unit:"year"}):qe(h,e.length)},R:function(s,e){const n=uh(s);return qe(n,e.length)},u:function(s,e){const n=s.getFullYear();return qe(n,e.length)},Q:function(s,e,n){const i=Math.ceil((s.getMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return qe(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(s,e,n){const i=Math.ceil((s.getMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return qe(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(s,e,n){const i=s.getMonth();switch(e){case"M":case"MM":return ts.M(s,e);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(s,e,n){const i=s.getMonth();switch(e){case"L":return String(i+1);case"LL":return qe(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(s,e,n,i){const l=yh(s,i);return e==="wo"?n.ordinalNumber(l,{unit:"week"}):qe(l,e.length)},I:function(s,e,n){const i=ph(s);return e==="Io"?n.ordinalNumber(i,{unit:"week"}):qe(i,e.length)},d:function(s,e,n){return e==="do"?n.ordinalNumber(s.getDate(),{unit:"date"}):ts.d(s,e)},D:function(s,e,n){const i=By(s);return e==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):qe(i,e.length)},E:function(s,e,n){const i=s.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(s,e,n,i){const l=s.getDay(),h=(l-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(h);case"ee":return qe(h,2);case"eo":return n.ordinalNumber(h,{unit:"day"});case"eee":return n.day(l,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(l,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(l,{width:"short",context:"formatting"});case"eeee":default:return n.day(l,{width:"wide",context:"formatting"})}},c:function(s,e,n,i){const l=s.getDay(),h=(l-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(h);case"cc":return qe(h,e.length);case"co":return n.ordinalNumber(h,{unit:"day"});case"ccc":return n.day(l,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(l,{width:"narrow",context:"standalone"});case"cccccc":return n.day(l,{width:"short",context:"standalone"});case"cccc":default:return n.day(l,{width:"wide",context:"standalone"})}},i:function(s,e,n){const i=s.getDay(),l=i===0?7:i;switch(e){case"i":return String(l);case"ii":return qe(l,e.length);case"io":return n.ordinalNumber(l,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(s,e,n){const l=s.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(l,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(l,{width:"wide",context:"formatting"})}},b:function(s,e,n){const i=s.getHours();let l;switch(i===12?l=sr.noon:i===0?l=sr.midnight:l=i/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(l,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(l,{width:"wide",context:"formatting"})}},B:function(s,e,n){const i=s.getHours();let l;switch(i>=17?l=sr.evening:i>=12?l=sr.afternoon:i>=4?l=sr.morning:l=sr.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(l,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(l,{width:"wide",context:"formatting"})}},h:function(s,e,n){if(e==="ho"){let i=s.getHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return ts.h(s,e)},H:function(s,e,n){return e==="Ho"?n.ordinalNumber(s.getHours(),{unit:"hour"}):ts.H(s,e)},K:function(s,e,n){const i=s.getHours()%12;return e==="Ko"?n.ordinalNumber(i,{unit:"hour"}):qe(i,e.length)},k:function(s,e,n){let i=s.getHours();return i===0&&(i=24),e==="ko"?n.ordinalNumber(i,{unit:"hour"}):qe(i,e.length)},m:function(s,e,n){return e==="mo"?n.ordinalNumber(s.getMinutes(),{unit:"minute"}):ts.m(s,e)},s:function(s,e,n){return e==="so"?n.ordinalNumber(s.getSeconds(),{unit:"second"}):ts.s(s,e)},S:function(s,e){return ts.S(s,e)},X:function(s,e,n){const i=s.getTimezoneOffset();if(i===0)return"Z";switch(e){case"X":return Mm(i);case"XXXX":case"XX":return Ns(i);case"XXXXX":case"XXX":default:return Ns(i,":")}},x:function(s,e,n){const i=s.getTimezoneOffset();switch(e){case"x":return Mm(i);case"xxxx":case"xx":return Ns(i);case"xxxxx":case"xxx":default:return Ns(i,":")}},O:function(s,e,n){const i=s.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Pm(i,":");case"OOOO":default:return"GMT"+Ns(i,":")}},z:function(s,e,n){const i=s.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Pm(i,":");case"zzzz":default:return"GMT"+Ns(i,":")}},t:function(s,e,n){const i=Math.trunc(s.getTime()/1e3);return qe(i,e.length)},T:function(s,e,n){const i=s.getTime();return qe(i,e.length)}};function Pm(s,e=""){const n=s>0?"-":"+",i=Math.abs(s),l=Math.trunc(i/60),h=i%60;return h===0?n+String(l):n+String(l)+e+qe(h,2)}function Mm(s,e){return s%60===0?(s>0?"-":"+")+qe(Math.abs(s)/60,2):Ns(s,e)}function Ns(s,e=""){const n=s>0?"-":"+",i=Math.abs(s),l=qe(Math.trunc(i/60),2),h=qe(i%60,2);return n+l+e+h}const Om=(s,e)=>{switch(s){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},bh=(s,e)=>{switch(s){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Uy=(s,e)=>{const n=s.match(/(P+)(p+)?/)||[],i=n[1],l=n[2];if(!l)return Om(s,e);let h;switch(i){case"P":h=e.dateTime({width:"short"});break;case"PP":h=e.dateTime({width:"medium"});break;case"PPP":h=e.dateTime({width:"long"});break;case"PPPP":default:h=e.dateTime({width:"full"});break}return h.replace("{{date}}",Om(i,e)).replace("{{time}}",bh(l,e))},Vy={p:bh,P:Uy},qy=/^D+$/,Yy=/^Y+$/,zy=["D","DD","YY","YYYY"];function Ky(s){return qy.test(s)}function Jy(s){return Yy.test(s)}function Hy(s,e,n){const i=Qy(s,e,n);if(console.warn(i),zy.includes(s))throw new RangeError(i)}function Qy(s,e,n){const i=s[0]==="Y"?"years":"days of the month";return`Use \`${s.toLowerCase()}\` instead of \`${s}\` (in \`${e}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Gy=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Xy=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Zy=/^'([^]*?)'?$/,eb=/''/g,tb=/[a-zA-Z]/;function pa(s,e,n){var D,T,E,M,$,y,W,ie;const i=yn(),l=(n==null?void 0:n.locale)??i.locale??gh,h=(n==null?void 0:n.firstWeekContainsDate)??((T=(D=n==null?void 0:n.locale)==null?void 0:D.options)==null?void 0:T.firstWeekContainsDate)??i.firstWeekContainsDate??((M=(E=i.locale)==null?void 0:E.options)==null?void 0:M.firstWeekContainsDate)??1,p=(n==null?void 0:n.weekStartsOn)??((y=($=n==null?void 0:n.locale)==null?void 0:$.options)==null?void 0:y.weekStartsOn)??i.weekStartsOn??((ie=(W=i.locale)==null?void 0:W.options)==null?void 0:ie.weekStartsOn)??0,b=Re(s);if(!oy(b))throw new RangeError("Invalid time value");let C=e.match(Xy).map(J=>{const V=J[0];if(V==="p"||V==="P"){const se=Vy[V];return se(J,l.formatLong)}return J}).join("").match(Gy).map(J=>{if(J==="''")return{isToken:!1,value:"'"};const V=J[0];if(V==="'")return{isToken:!1,value:ab(J)};if(Tm[V])return{isToken:!0,value:J};if(V.match(tb))throw new RangeError("Format string contains an unescaped latin alphabet character `"+V+"`");return{isToken:!1,value:J}});l.localize.preprocessor&&(C=l.localize.preprocessor(b,C));const k={firstWeekContainsDate:h,weekStartsOn:p,locale:l};return C.map(J=>{if(!J.isToken)return J.value;const V=J.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&Jy(V)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&Ky(V))&&Hy(V,e,String(s));const se=Tm[V[0]];return se(b,V,l.localize,k)}).join("")}function ab(s){const e=s.match(Zy);return e?e[1].replace(eb,"'"):s}function sb(s){const e=Re(s),n=e.getFullYear(),i=e.getMonth(),l=ra(s,0);return l.setFullYear(n,i+1,0),l.setHours(0,0,0,0),l.getDate()}function rb(s){return Math.trunc(+Re(s)/1e3)}function nb(s){const e=Re(s),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(0,0,0,0),e}function ib(s,e){return ly(nb(s),Jt(s),e)+1}function cc(s,e){const n=Re(s),i=Re(e);return n.getTime()>i.getTime()}function vh(s,e){const n=Re(s),i=Re(e);return+n<+i}function wc(s,e){const n=Re(s),i=Re(e);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}function ob(s,e){const n=Re(s),i=Re(e);return n.getFullYear()===i.getFullYear()}function Zl(s,e){return Bt(s,-e)}function ec(s,e){const n=Re(s),i=n.getFullYear(),l=n.getDate(),h=ra(s,0);h.setFullYear(i,e,15),h.setHours(0,0,0,0);const p=sb(h);return n.setMonth(e,Math.min(l,p)),n}function Em(s,e){const n=Re(s);return isNaN(+n)?ra(s,NaN):(n.setFullYear(e),n)}const lb={lessThanXSeconds:{one:"Ø£Ù‚Ù„ Ù…Ù† Ø«Ø§Ù†ÙŠØ©",two:"Ø£Ù‚Ù„ Ù…Ù† Ø«Ø§Ù†ÙŠØªÙŠÙ†",threeToTen:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø«ÙˆØ§Ù†ÙŠ",other:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø«Ø§Ù†ÙŠØ©"},xSeconds:{one:"Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø©",two:"Ø«Ø§Ù†ÙŠØªØ§Ù†",threeToTen:"{{count}} Ø«ÙˆØ§Ù†ÙŠ",other:"{{count}} Ø«Ø§Ù†ÙŠØ©"},halfAMinute:"Ù†ØµÙ Ø¯Ù‚ÙŠÙ‚Ø©",lessThanXMinutes:{one:"Ø£Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚Ø©",two:"Ø£Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†",threeToTen:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø¯Ù‚Ø§Ø¦Ù‚",other:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø¯Ù‚ÙŠÙ‚Ø©"},xMinutes:{one:"Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©",two:"Ø¯Ù‚ÙŠÙ‚ØªØ§Ù†",threeToTen:"{{count}} Ø¯Ù‚Ø§Ø¦Ù‚",other:"{{count}} Ø¯Ù‚ÙŠÙ‚Ø©"},aboutXHours:{one:"Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",two:"Ø³Ø§Ø¹ØªÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø³Ø§Ø¹Ø§Øª ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",other:"{{count}} Ø³Ø§Ø¹Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹"},xHours:{one:"Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©",two:"Ø³Ø§Ø¹ØªØ§Ù†",threeToTen:"{{count}} Ø³Ø§Ø¹Ø§Øª",other:"{{count}} Ø³Ø§Ø¹Ø©"},xDays:{one:"ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯",two:"ÙŠÙˆÙ…Ø§Ù†",threeToTen:"{{count}} Ø£ÙŠØ§Ù…",other:"{{count}} ÙŠÙˆÙ…"},aboutXWeeks:{one:"Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯ ØªÙ‚Ø±ÙŠØ¨Ø§",two:"Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø£Ø³Ø§Ø¨ÙŠØ¹ ØªÙ‚Ø±ÙŠØ¨Ø§",other:"{{count}} Ø£Ø³Ø¨ÙˆØ¹Ø§ ØªÙ‚Ø±ÙŠØ¨Ø§"},xWeeks:{one:"Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯",two:"Ø£Ø³Ø¨ÙˆØ¹Ø§Ù†",threeToTen:"{{count}} Ø£Ø³Ø§Ø¨ÙŠØ¹",other:"{{count}} Ø£Ø³Ø¨ÙˆØ¹Ø§"},aboutXMonths:{one:"Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",two:"Ø´Ù‡Ø±ÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø£Ø´Ù‡Ø± ØªÙ‚Ø±ÙŠØ¨Ø§",other:"{{count}} Ø´Ù‡Ø±Ø§ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹"},xMonths:{one:"Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯",two:"Ø´Ù‡Ø±Ø§Ù†",threeToTen:"{{count}} Ø£Ø´Ù‡Ø±",other:"{{count}} Ø´Ù‡Ø±Ø§"},aboutXYears:{one:"Ø³Ù†Ø© ÙˆØ§Ø­Ø¯Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",two:"Ø³Ù†ØªÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø³Ù†ÙˆØ§Øª ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",other:"{{count}} Ø³Ù†Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹"},xYears:{one:"Ø³Ù†Ø© ÙˆØ§Ø­Ø¯",two:"Ø³Ù†ØªØ§Ù†",threeToTen:"{{count}} Ø³Ù†ÙˆØ§Øª",other:"{{count}} Ø³Ù†Ø©"},overXYears:{one:"Ø£ÙƒØ«Ø± Ù…Ù† Ø³Ù†Ø©",two:"Ø£ÙƒØ«Ø± Ù…Ù† Ø³Ù†ØªÙŠÙ†",threeToTen:"Ø£ÙƒØ«Ø± Ù…Ù† {{count}} Ø³Ù†ÙˆØ§Øª",other:"Ø£ÙƒØ«Ø± Ù…Ù† {{count}} Ø³Ù†Ø©"},almostXYears:{one:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ Ø³Ù†Ø© ÙˆØ§Ø­Ø¯Ø©",two:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ Ø³Ù†ØªÙŠÙ†",threeToTen:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ {{count}} Ø³Ù†ÙˆØ§Øª",other:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ {{count}} Ø³Ù†Ø©"}},cb=(s,e,n)=>{const i=lb[s];let l;return typeof i=="string"?l=i:e===1?l=i.one:e===2?l=i.two:e<=10?l=i.threeToTen.replace("{{count}}",String(e)):l=i.other.replace("{{count}}",String(e)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"Ø®Ù„Ø§Ù„ "+l:"Ù…Ù†Ø° "+l:l},db={full:"EEEEØŒ do MMMM y",long:"do MMMM y",medium:"d MMM y",short:"dd/MM/yyyy"},ub={full:"HH:mm:ss",long:"HH:mm:ss",medium:"HH:mm:ss",short:"HH:mm"},mb={full:"{{date}} 'Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' {{time}}",long:"{{date}} 'Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},hb={date:lr({formats:db,defaultWidth:"full"}),time:lr({formats:ub,defaultWidth:"full"}),dateTime:lr({formats:mb,defaultWidth:"full"})},fb={lastWeek:"eeee 'Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",yesterday:"'Ø§Ù„Ø£Ù…Ø³ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",today:"'Ø§Ù„ÙŠÙˆÙ… Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",tomorrow:"'ØºØ¯Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",nextWeek:"eeee 'Ø§Ù„Ù‚Ø§Ø¯Ù… Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",other:"P"},gb=s=>fb[s],pb={narrow:["Ù‚","Ø¨"],abbreviated:["Ù‚.Ù….","Ø¨.Ù…."],wide:["Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯","Ø¨Ø¹Ø¯ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯"]},xb={narrow:["1","2","3","4"],abbreviated:["Ø±1","Ø±2","Ø±3","Ø±4"],wide:["Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø£ÙˆÙ„","Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ","Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù„Ø«","Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø¹"]},yb={narrow:["ÙŠ","Ù","Ù…","Ø£","Ù…","ÙŠ","ÙŠ","Ø£","Ø³","Ø£","Ù†","Ø¯"],abbreviated:["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"],wide:["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"]},bb={narrow:["Ø­","Ù†","Ø«","Ø±","Ø®","Ø¬","Ø³"],short:["Ø£Ø­Ø¯","Ø§Ø«Ù†ÙŠÙ†","Ø«Ù„Ø§Ø«Ø§Ø¡","Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø®Ù…ÙŠØ³","Ø¬Ù…Ø¹Ø©","Ø³Ø¨Øª"],abbreviated:["Ø£Ø­Ø¯","Ø§Ø«Ù†ÙŠÙ†","Ø«Ù„Ø§Ø«Ø§Ø¡","Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø®Ù…ÙŠØ³","Ø¬Ù…Ø¹Ø©","Ø³Ø¨Øª"],wide:["Ø§Ù„Ø£Ø­Ø¯","Ø§Ù„Ø§Ø«Ù†ÙŠÙ†","Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡","Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø§Ù„Ø®Ù…ÙŠØ³","Ø§Ù„Ø¬Ù…Ø¹Ø©","Ø§Ù„Ø³Ø¨Øª"]},vb={narrow:{am:"Øµ",pm:"Ù…",morning:"Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"Ø§Ù„Ù…Ø³Ø§Ø¡",night:"Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},abbreviated:{am:"Øµ",pm:"Ù…",morning:"Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"Ø§Ù„Ù…Ø³Ø§Ø¡",night:"Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},wide:{am:"Øµ",pm:"Ù…",morning:"Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"Ø§Ù„Ù…Ø³Ø§Ø¡",night:"Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"}},wb={narrow:{am:"Øµ",pm:"Ù…",morning:"ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡",night:"ÙÙŠ Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},abbreviated:{am:"Øµ",pm:"Ù…",morning:"ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡",night:"ÙÙŠ Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},wide:{am:"Øµ",pm:"Ù…",morning:"ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡",night:"ÙÙŠ Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"}},Nb=s=>String(s),jb={ordinalNumber:Nb,era:Da({values:pb,defaultWidth:"wide"}),quarter:Da({values:xb,defaultWidth:"wide",argumentCallback:s=>s-1}),month:Da({values:yb,defaultWidth:"wide"}),day:Da({values:bb,defaultWidth:"wide"}),dayPeriod:Da({values:vb,defaultWidth:"wide",formattingValues:wb,defaultFormattingWidth:"wide"})},Sb=/^(\d+)(th|st|nd|rd)?/i,Db=/\d+/i,kb={narrow:/[Ù‚Ø¨]/,abbreviated:/[Ù‚Ø¨]\.Ù…\./,wide:/(Ù‚Ø¨Ù„|Ø¨Ø¹Ø¯) Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯/},Cb={any:[/Ù‚Ø¨Ù„/,/Ø¨Ø¹Ø¯/]},Ib={narrow:/^[1234]/i,abbreviated:/Ø±[1234]/,wide:/Ø§Ù„Ø±Ø¨Ø¹ (Ø§Ù„Ø£ÙˆÙ„|Ø§Ù„Ø«Ø§Ù†ÙŠ|Ø§Ù„Ø«Ø§Ù„Ø«|Ø§Ù„Ø±Ø§Ø¨Ø¹)/},_b={any:[/1/i,/2/i,/3/i,/4/i]},Ab={narrow:/^[Ø£ÙŠÙÙ…Ø³Ù†Ø¯]/,abbreviated:/^(ÙŠÙ†Ø§ÙŠØ±|ÙØ¨Ø±Ø§ÙŠØ±|Ù…Ø§Ø±Ø³|Ø£Ø¨Ø±ÙŠÙ„|Ù…Ø§ÙŠÙˆ|ÙŠÙˆÙ†ÙŠÙˆ|ÙŠÙˆÙ„ÙŠÙˆ|Ø£ØºØ³Ø·Ø³|Ø³Ø¨ØªÙ…Ø¨Ø±|Ø£ÙƒØªÙˆØ¨Ø±|Ù†ÙˆÙÙ…Ø¨Ø±|Ø¯ÙŠØ³Ù…Ø¨Ø±)/,wide:/^(ÙŠÙ†Ø§ÙŠØ±|ÙØ¨Ø±Ø§ÙŠØ±|Ù…Ø§Ø±Ø³|Ø£Ø¨Ø±ÙŠÙ„|Ù…Ø§ÙŠÙˆ|ÙŠÙˆÙ†ÙŠÙˆ|ÙŠÙˆÙ„ÙŠÙˆ|Ø£ØºØ³Ø·Ø³|Ø³Ø¨ØªÙ…Ø¨Ø±|Ø£ÙƒØªÙˆØ¨Ø±|Ù†ÙˆÙÙ…Ø¨Ø±|Ø¯ÙŠØ³Ù…Ø¨Ø±)/},Tb={narrow:[/^ÙŠ/i,/^Ù/i,/^Ù…/i,/^Ø£/i,/^Ù…/i,/^ÙŠ/i,/^ÙŠ/i,/^Ø£/i,/^Ø³/i,/^Ø£/i,/^Ù†/i,/^Ø¯/i],any:[/^ÙŠÙ†Ø§ÙŠØ±/i,/^ÙØ¨Ø±Ø§ÙŠØ±/i,/^Ù…Ø§Ø±Ø³/i,/^Ø£Ø¨Ø±ÙŠÙ„/i,/^Ù…Ø§ÙŠÙˆ/i,/^ÙŠÙˆÙ†ÙŠÙˆ/i,/^ÙŠÙˆÙ„ÙŠÙˆ/i,/^Ø£ØºØ³Ø·Ø³/i,/^Ø³Ø¨ØªÙ…Ø¨Ø±/i,/^Ø£ÙƒØªÙˆØ¨Ø±/i,/^Ù†ÙˆÙÙ…Ø¨Ø±/i,/^Ø¯ÙŠØ³Ù…Ø¨Ø±/i]},Pb={narrow:/^[Ø­Ù†Ø«Ø±Ø®Ø¬Ø³]/i,short:/^(Ø£Ø­Ø¯|Ø§Ø«Ù†ÙŠÙ†|Ø«Ù„Ø§Ø«Ø§Ø¡|Ø£Ø±Ø¨Ø¹Ø§Ø¡|Ø®Ù…ÙŠØ³|Ø¬Ù…Ø¹Ø©|Ø³Ø¨Øª)/i,abbreviated:/^(Ø£Ø­Ø¯|Ø§Ø«Ù†ÙŠÙ†|Ø«Ù„Ø§Ø«Ø§Ø¡|Ø£Ø±Ø¨Ø¹Ø§Ø¡|Ø®Ù…ÙŠØ³|Ø¬Ù…Ø¹Ø©|Ø³Ø¨Øª)/i,wide:/^(Ø§Ù„Ø£Ø­Ø¯|Ø§Ù„Ø§Ø«Ù†ÙŠÙ†|Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡|Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡|Ø§Ù„Ø®Ù…ÙŠØ³|Ø§Ù„Ø¬Ù…Ø¹Ø©|Ø§Ù„Ø³Ø¨Øª)/i},Mb={narrow:[/^Ø­/i,/^Ù†/i,/^Ø«/i,/^Ø±/i,/^Ø®/i,/^Ø¬/i,/^Ø³/i],wide:[/^Ø§Ù„Ø£Ø­Ø¯/i,/^Ø§Ù„Ø§Ø«Ù†ÙŠÙ†/i,/^Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡/i,/^Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡/i,/^Ø§Ù„Ø®Ù…ÙŠØ³/i,/^Ø§Ù„Ø¬Ù…Ø¹Ø©/i,/^Ø§Ù„Ø³Ø¨Øª/i],any:[/^Ø£Ø­/i,/^Ø§Ø«/i,/^Ø«/i,/^Ø£Ø±/i,/^Ø®/i,/^Ø¬/i,/^Ø³/i]},Ob={narrow:/^(Øµ|Ù…|Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„|Ø§Ù„Ø¸Ù‡Ø±|Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±|ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­|ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡|ÙÙŠ Ø§Ù„Ù„ÙŠÙ„)/,any:/^(Øµ|Ù…|Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„|Ø§Ù„Ø¸Ù‡Ø±|Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±|ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­|ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡|ÙÙŠ Ø§Ù„Ù„ÙŠÙ„)/},Eb={any:{am:/^Øµ/,pm:/^Ù…/,midnight:/Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„/,noon:/Ø§Ù„Ø¸Ù‡Ø±/,afternoon:/Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±/,morning:/ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­/,evening:/ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡/,night:/ÙÙŠ Ø§Ù„Ù„ÙŠÙ„/}},Rb={ordinalNumber:fh({matchPattern:Sb,parsePattern:Db,valueCallback:s=>parseInt(s,10)}),era:ka({matchPatterns:kb,defaultMatchWidth:"wide",parsePatterns:Cb,defaultParseWidth:"any"}),quarter:ka({matchPatterns:Ib,defaultMatchWidth:"wide",parsePatterns:_b,defaultParseWidth:"any",valueCallback:s=>s+1}),month:ka({matchPatterns:Ab,defaultMatchWidth:"wide",parsePatterns:Tb,defaultParseWidth:"any"}),day:ka({matchPatterns:Pb,defaultMatchWidth:"wide",parsePatterns:Mb,defaultParseWidth:"any"}),dayPeriod:ka({matchPatterns:Ob,defaultMatchWidth:"any",parsePatterns:Eb,defaultParseWidth:"any"})},Rm={code:"ar",formatDistance:cb,formatLong:hb,formatRelative:gb,localize:jb,match:Rb,options:{weekStartsOn:6,firstWeekContainsDate:1}};var fe=function(){return fe=Object.assign||function(e){for(var n,i=1,l=arguments.length;i<l;i++){n=arguments[i];for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&(e[h]=n[h])}return e},fe.apply(this,arguments)};function Lb(s,e){var n={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(n[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,i=Object.getOwnPropertySymbols(s);l<i.length;l++)e.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(s,i[l])&&(n[i[l]]=s[i[l]]);return n}function wh(s,e,n){for(var i=0,l=e.length,h;i<l;i++)(h||!(i in e))&&(h||(h=Array.prototype.slice.call(e,0,i)),h[i]=e[i]);return s.concat(h||Array.prototype.slice.call(e))}function bn(s){return s.mode==="multiple"}function vn(s){return s.mode==="range"}function Gi(s){return s.mode==="single"}var Wb={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Fb(s,e){return pa(s,"LLLL y",e)}function Bb(s,e){return pa(s,"d",e)}function $b(s,e){return pa(s,"LLLL",e)}function Ub(s){return"".concat(s)}function Vb(s,e){return pa(s,"cccccc",e)}function qb(s,e){return pa(s,"yyyy",e)}var Yb=Object.freeze({__proto__:null,formatCaption:Fb,formatDay:Bb,formatMonthCaption:$b,formatWeekNumber:Ub,formatWeekdayName:Vb,formatYearCaption:qb}),zb=function(s,e,n){return pa(s,"do MMMM (EEEE)",n)},Kb=function(){return"Month: "},Jb=function(){return"Go to next month"},Hb=function(){return"Go to previous month"},Qb=function(s,e){return pa(s,"cccc",e)},Gb=function(s){return"Week n. ".concat(s)},Xb=function(){return"Year: "},Zb=Object.freeze({__proto__:null,labelDay:zb,labelMonthDropdown:Kb,labelNext:Jb,labelPrevious:Hb,labelWeekNumber:Gb,labelWeekday:Qb,labelYearDropdown:Xb});function ev(){var s="buttons",e=Wb,n=gh,i={},l={},h=1,p={},b=new Date;return{captionLayout:s,classNames:e,formatters:Yb,labels:Zb,locale:n,modifiersClassNames:i,modifiers:l,numberOfMonths:h,styles:p,today:b,mode:"default"}}function tv(s){var e=s.fromYear,n=s.toYear,i=s.fromMonth,l=s.toMonth,h=s.fromDate,p=s.toDate;return i?h=Jt(i):e&&(h=new Date(e,0,1)),l?p=bc(l):n&&(p=new Date(n,11,31)),{fromDate:h?ur(h):void 0,toDate:p?ur(p):void 0}}var Nh=u.createContext(void 0);function av(s){var e,n=s.initialProps,i=ev(),l=tv(n),h=l.fromDate,p=l.toDate,b=(e=n.captionLayout)!==null&&e!==void 0?e:i.captionLayout;b!=="buttons"&&(!h||!p)&&(b="buttons");var C;(Gi(n)||bn(n)||vn(n))&&(C=n.onSelect);var k=fe(fe(fe({},i),n),{captionLayout:b,classNames:fe(fe({},i.classNames),n.classNames),components:fe({},n.components),formatters:fe(fe({},i.formatters),n.formatters),fromDate:h,labels:fe(fe({},i.labels),n.labels),mode:n.mode||i.mode,modifiers:fe(fe({},i.modifiers),n.modifiers),modifiersClassNames:fe(fe({},i.modifiersClassNames),n.modifiersClassNames),onSelect:C,styles:fe(fe({},i.styles),n.styles),toDate:p});return t.jsx(Nh.Provider,{value:k,children:s.children})}function He(){var s=u.useContext(Nh);if(!s)throw new Error("useDayPicker must be used within a DayPickerProvider.");return s}function jh(s){var e=He(),n=e.locale,i=e.classNames,l=e.styles,h=e.formatters.formatCaption;return t.jsx("div",{className:i.caption_label,style:l.caption_label,"aria-live":"polite",role:"presentation",id:s.id,children:h(s.displayMonth,{locale:n})})}function sv(s){return t.jsx("svg",fe({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},s,{children:t.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Sh(s){var e,n,i=s.onChange,l=s.value,h=s.children,p=s.caption,b=s.className,C=s.style,k=He(),D=(n=(e=k.components)===null||e===void 0?void 0:e.IconDropdown)!==null&&n!==void 0?n:sv;return t.jsxs("div",{className:b,style:C,children:[t.jsx("span",{className:k.classNames.vhidden,children:s["aria-label"]}),t.jsx("select",{name:s.name,"aria-label":s["aria-label"],className:k.classNames.dropdown,style:k.styles.dropdown,value:l,onChange:i,children:h}),t.jsxs("div",{className:k.classNames.caption_label,style:k.styles.caption_label,"aria-hidden":"true",children:[p,t.jsx(D,{className:k.classNames.dropdown_icon,style:k.styles.dropdown_icon})]})]})}function rv(s){var e,n=He(),i=n.fromDate,l=n.toDate,h=n.styles,p=n.locale,b=n.formatters.formatMonthCaption,C=n.classNames,k=n.components,D=n.labels.labelMonthDropdown;if(!i)return t.jsx(t.Fragment,{});if(!l)return t.jsx(t.Fragment,{});var T=[];if(ob(i,l))for(var E=Jt(i),M=i.getMonth();M<=l.getMonth();M++)T.push(ec(E,M));else for(var E=Jt(new Date),M=0;M<=11;M++)T.push(ec(E,M));var $=function(W){var ie=Number(W.target.value),J=ec(Jt(s.displayMonth),ie);s.onChange(J)},y=(e=k==null?void 0:k.Dropdown)!==null&&e!==void 0?e:Sh;return t.jsx(y,{name:"months","aria-label":D(),className:C.dropdown_month,style:h.dropdown_month,onChange:$,value:s.displayMonth.getMonth(),caption:b(s.displayMonth,{locale:p}),children:T.map(function(W){return t.jsx("option",{value:W.getMonth(),children:b(W,{locale:p})},W.getMonth())})})}function nv(s){var e,n=s.displayMonth,i=He(),l=i.fromDate,h=i.toDate,p=i.locale,b=i.styles,C=i.classNames,k=i.components,D=i.formatters.formatYearCaption,T=i.labels.labelYearDropdown,E=[];if(!l)return t.jsx(t.Fragment,{});if(!h)return t.jsx(t.Fragment,{});for(var M=l.getFullYear(),$=h.getFullYear(),y=M;y<=$;y++)E.push(Em(mh(new Date),y));var W=function(J){var V=Em(Jt(n),Number(J.target.value));s.onChange(V)},ie=(e=k==null?void 0:k.Dropdown)!==null&&e!==void 0?e:Sh;return t.jsx(ie,{name:"years","aria-label":T(),className:C.dropdown_year,style:b.dropdown_year,onChange:W,value:n.getFullYear(),caption:D(n,{locale:p}),children:E.map(function(J){return t.jsx("option",{value:J.getFullYear(),children:D(J,{locale:p})},J.getFullYear())})})}function iv(s,e){var n=u.useState(s),i=n[0],l=n[1],h=e===void 0?i:e;return[h,l]}function ov(s){var e=s.month,n=s.defaultMonth,i=s.today,l=e||n||i||new Date,h=s.toDate,p=s.fromDate,b=s.numberOfMonths,C=b===void 0?1:b;if(h&&gn(h,l)<0){var k=-1*(C-1);l=xa(h,k)}return p&&gn(l,p)<0&&(l=p),Jt(l)}function lv(){var s=He(),e=ov(s),n=iv(e,s.month),i=n[0],l=n[1],h=function(p){var b;if(!s.disableNavigation){var C=Jt(p);l(C),(b=s.onMonthChange)===null||b===void 0||b.call(s,C)}};return[i,h]}function cv(s,e){for(var n=e.reverseMonths,i=e.numberOfMonths,l=Jt(s),h=Jt(xa(l,i)),p=gn(h,l),b=[],C=0;C<p;C++){var k=xa(l,C);b.push(k)}return n&&(b=b.reverse()),b}function dv(s,e){if(!e.disableNavigation){var n=e.toDate,i=e.pagedNavigation,l=e.numberOfMonths,h=l===void 0?1:l,p=i?h:1,b=Jt(s);if(!n)return xa(b,p);var C=gn(n,s);if(!(C<h))return xa(b,p)}}function uv(s,e){if(!e.disableNavigation){var n=e.fromDate,i=e.pagedNavigation,l=e.numberOfMonths,h=l===void 0?1:l,p=i?h:1,b=Jt(s);if(!n)return xa(b,-p);var C=gn(b,n);if(!(C<=0))return xa(b,-p)}}var Dh=u.createContext(void 0);function mv(s){var e=He(),n=lv(),i=n[0],l=n[1],h=cv(i,e),p=dv(i,e),b=uv(i,e),C=function(T){return h.some(function(E){return wc(T,E)})},k=function(T,E){C(T)||(E&&vh(T,E)?l(xa(T,1+e.numberOfMonths*-1)):l(T))},D={currentMonth:i,displayMonths:h,goToMonth:l,goToDate:k,previousMonth:b,nextMonth:p,isDateDisplayed:C};return t.jsx(Dh.Provider,{value:D,children:s.children})}function wn(){var s=u.useContext(Dh);if(!s)throw new Error("useNavigation must be used within a NavigationProvider");return s}function Lm(s){var e,n=He(),i=n.classNames,l=n.styles,h=n.components,p=wn().goToMonth,b=function(D){p(xa(D,s.displayIndex?-s.displayIndex:0))},C=(e=h==null?void 0:h.CaptionLabel)!==null&&e!==void 0?e:jh,k=t.jsx(C,{id:s.id,displayMonth:s.displayMonth});return t.jsxs("div",{className:i.caption_dropdowns,style:l.caption_dropdowns,children:[t.jsx("div",{className:i.vhidden,children:k}),t.jsx(rv,{onChange:b,displayMonth:s.displayMonth}),t.jsx(nv,{onChange:b,displayMonth:s.displayMonth})]})}function hv(s){return t.jsx("svg",fe({width:"16px",height:"16px",viewBox:"0 0 120 120"},s,{children:t.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function fv(s){return t.jsx("svg",fe({width:"16px",height:"16px",viewBox:"0 0 120 120"},s,{children:t.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Ji=u.forwardRef(function(s,e){var n=He(),i=n.classNames,l=n.styles,h=[i.button_reset,i.button];s.className&&h.push(s.className);var p=h.join(" "),b=fe(fe({},l.button_reset),l.button);return s.style&&Object.assign(b,s.style),t.jsx("button",fe({},s,{ref:e,type:"button",className:p,style:b}))});function gv(s){var e,n,i=He(),l=i.dir,h=i.locale,p=i.classNames,b=i.styles,C=i.labels,k=C.labelPrevious,D=C.labelNext,T=i.components;if(!s.nextMonth&&!s.previousMonth)return t.jsx(t.Fragment,{});var E=k(s.previousMonth,{locale:h}),M=[p.nav_button,p.nav_button_previous].join(" "),$=D(s.nextMonth,{locale:h}),y=[p.nav_button,p.nav_button_next].join(" "),W=(e=T==null?void 0:T.IconRight)!==null&&e!==void 0?e:fv,ie=(n=T==null?void 0:T.IconLeft)!==null&&n!==void 0?n:hv;return t.jsxs("div",{className:p.nav,style:b.nav,children:[!s.hidePrevious&&t.jsx(Ji,{name:"previous-month","aria-label":E,className:M,style:b.nav_button_previous,disabled:!s.previousMonth,onClick:s.onPreviousClick,children:l==="rtl"?t.jsx(W,{className:p.nav_icon,style:b.nav_icon}):t.jsx(ie,{className:p.nav_icon,style:b.nav_icon})}),!s.hideNext&&t.jsx(Ji,{name:"next-month","aria-label":$,className:y,style:b.nav_button_next,disabled:!s.nextMonth,onClick:s.onNextClick,children:l==="rtl"?t.jsx(ie,{className:p.nav_icon,style:b.nav_icon}):t.jsx(W,{className:p.nav_icon,style:b.nav_icon})})]})}function Wm(s){var e=He().numberOfMonths,n=wn(),i=n.previousMonth,l=n.nextMonth,h=n.goToMonth,p=n.displayMonths,b=p.findIndex(function($){return wc(s.displayMonth,$)}),C=b===0,k=b===p.length-1,D=e>1&&(C||!k),T=e>1&&(k||!C),E=function(){i&&h(i)},M=function(){l&&h(l)};return t.jsx(gv,{displayMonth:s.displayMonth,hideNext:D,hidePrevious:T,nextMonth:l,previousMonth:i,onPreviousClick:E,onNextClick:M})}function pv(s){var e,n=He(),i=n.classNames,l=n.disableNavigation,h=n.styles,p=n.captionLayout,b=n.components,C=(e=b==null?void 0:b.CaptionLabel)!==null&&e!==void 0?e:jh,k;return l?k=t.jsx(C,{id:s.id,displayMonth:s.displayMonth}):p==="dropdown"?k=t.jsx(Lm,{displayMonth:s.displayMonth,id:s.id}):p==="dropdown-buttons"?k=t.jsxs(t.Fragment,{children:[t.jsx(Lm,{displayMonth:s.displayMonth,displayIndex:s.displayIndex,id:s.id}),t.jsx(Wm,{displayMonth:s.displayMonth,displayIndex:s.displayIndex,id:s.id})]}):k=t.jsxs(t.Fragment,{children:[t.jsx(C,{id:s.id,displayMonth:s.displayMonth,displayIndex:s.displayIndex}),t.jsx(Wm,{displayMonth:s.displayMonth,id:s.id})]}),t.jsx("div",{className:i.caption,style:h.caption,children:k})}function xv(s){var e=He(),n=e.footer,i=e.styles,l=e.classNames.tfoot;return n?t.jsx("tfoot",{className:l,style:i.tfoot,children:t.jsx("tr",{children:t.jsx("td",{colSpan:8,children:n})})}):t.jsx(t.Fragment,{})}function yv(s,e,n){for(var i=n?js(new Date):_a(new Date,{locale:s,weekStartsOn:e}),l=[],h=0;h<7;h++){var p=Bt(i,h);l.push(p)}return l}function bv(){var s=He(),e=s.classNames,n=s.styles,i=s.showWeekNumber,l=s.locale,h=s.weekStartsOn,p=s.ISOWeek,b=s.formatters.formatWeekdayName,C=s.labels.labelWeekday,k=yv(l,h,p);return t.jsxs("tr",{style:n.head_row,className:e.head_row,children:[i&&t.jsx("td",{style:n.head_cell,className:e.head_cell}),k.map(function(D,T){return t.jsx("th",{scope:"col",className:e.head_cell,style:n.head_cell,"aria-label":C(D,{locale:l}),children:b(D,{locale:l})},T)})]})}function vv(){var s,e=He(),n=e.classNames,i=e.styles,l=e.components,h=(s=l==null?void 0:l.HeadRow)!==null&&s!==void 0?s:bv;return t.jsx("thead",{style:i.head,className:n.head,children:t.jsx(h,{})})}function wv(s){var e=He(),n=e.locale,i=e.formatters.formatDay;return t.jsx(t.Fragment,{children:i(s.date,{locale:n})})}var Nc=u.createContext(void 0);function Nv(s){if(!bn(s.initialProps)){var e={selected:void 0,modifiers:{disabled:[]}};return t.jsx(Nc.Provider,{value:e,children:s.children})}return t.jsx(jv,{initialProps:s.initialProps,children:s.children})}function jv(s){var e=s.initialProps,n=s.children,i=e.selected,l=e.min,h=e.max,p=function(k,D,T){var E,M;(E=e.onDayClick)===null||E===void 0||E.call(e,k,D,T);var $=!!(D.selected&&l&&(i==null?void 0:i.length)===l);if(!$){var y=!!(!D.selected&&h&&(i==null?void 0:i.length)===h);if(!y){var W=i?wh([],i):[];if(D.selected){var ie=W.findIndex(function(J){return Kt(k,J)});W.splice(ie,1)}else W.push(k);(M=e.onSelect)===null||M===void 0||M.call(e,W,k,D,T)}}},b={disabled:[]};i&&b.disabled.push(function(k){var D=h&&i.length>h-1,T=i.some(function(E){return Kt(E,k)});return!!(D&&!T)});var C={selected:i,onDayClick:p,modifiers:b};return t.jsx(Nc.Provider,{value:C,children:n})}function jc(){var s=u.useContext(Nc);if(!s)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return s}function Sv(s,e){var n=e||{},i=n.from,l=n.to;return i&&l?Kt(l,s)&&Kt(i,s)?void 0:Kt(l,s)?{from:l,to:void 0}:Kt(i,s)?void 0:cc(i,s)?{from:s,to:l}:{from:i,to:s}:l?cc(s,l)?{from:l,to:s}:{from:s,to:l}:i?vh(s,i)?{from:s,to:i}:{from:i,to:s}:{from:s,to:void 0}}var Sc=u.createContext(void 0);function Dv(s){if(!vn(s.initialProps)){var e={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return t.jsx(Sc.Provider,{value:e,children:s.children})}return t.jsx(kv,{initialProps:s.initialProps,children:s.children})}function kv(s){var e=s.initialProps,n=s.children,i=e.selected,l=i||{},h=l.from,p=l.to,b=e.min,C=e.max,k=function(M,$,y){var W,ie;(W=e.onDayClick)===null||W===void 0||W.call(e,M,$,y);var J=Sv(M,i);(ie=e.onSelect)===null||ie===void 0||ie.call(e,J,M,$,y)},D={range_start:[],range_end:[],range_middle:[],disabled:[]};if(h?(D.range_start=[h],p?(D.range_end=[p],Kt(h,p)||(D.range_middle=[{after:h,before:p}])):D.range_end=[h]):p&&(D.range_start=[p],D.range_end=[p]),b&&(h&&!p&&D.disabled.push({after:Zl(h,b-1),before:Bt(h,b-1)}),h&&p&&D.disabled.push({after:h,before:Bt(h,b-1)}),!h&&p&&D.disabled.push({after:Zl(p,b-1),before:Bt(p,b-1)})),C){if(h&&!p&&(D.disabled.push({before:Bt(h,-C+1)}),D.disabled.push({after:Bt(h,C-1)})),h&&p){var T=Ia(p,h)+1,E=C-T;D.disabled.push({before:Zl(h,E)}),D.disabled.push({after:Bt(p,E)})}!h&&p&&(D.disabled.push({before:Bt(p,-C+1)}),D.disabled.push({after:Bt(p,C-1)}))}return t.jsx(Sc.Provider,{value:{selected:i,onDayClick:k,modifiers:D},children:n})}function Dc(){var s=u.useContext(Sc);if(!s)throw new Error("useSelectRange must be used within a SelectRangeProvider");return s}function qi(s){return Array.isArray(s)?wh([],s):s!==void 0?[s]:[]}function Cv(s){var e={};return Object.entries(s).forEach(function(n){var i=n[0],l=n[1];e[i]=qi(l)}),e}var ya;(function(s){s.Outside="outside",s.Disabled="disabled",s.Selected="selected",s.Hidden="hidden",s.Today="today",s.RangeStart="range_start",s.RangeEnd="range_end",s.RangeMiddle="range_middle"})(ya||(ya={}));var Iv=ya.Selected,Wa=ya.Disabled,_v=ya.Hidden,Av=ya.Today,tc=ya.RangeEnd,ac=ya.RangeMiddle,sc=ya.RangeStart,Tv=ya.Outside;function Pv(s,e,n){var i,l=(i={},i[Iv]=qi(s.selected),i[Wa]=qi(s.disabled),i[_v]=qi(s.hidden),i[Av]=[s.today],i[tc]=[],i[ac]=[],i[sc]=[],i[Tv]=[],i);return s.fromDate&&l[Wa].push({before:s.fromDate}),s.toDate&&l[Wa].push({after:s.toDate}),bn(s)?l[Wa]=l[Wa].concat(e.modifiers[Wa]):vn(s)&&(l[Wa]=l[Wa].concat(n.modifiers[Wa]),l[sc]=n.modifiers[sc],l[ac]=n.modifiers[ac],l[tc]=n.modifiers[tc]),l}var kh=u.createContext(void 0);function Mv(s){var e=He(),n=jc(),i=Dc(),l=Pv(e,n,i),h=Cv(e.modifiers),p=fe(fe({},l),h);return t.jsx(kh.Provider,{value:p,children:s.children})}function Ch(){var s=u.useContext(kh);if(!s)throw new Error("useModifiers must be used within a ModifiersProvider");return s}function Ov(s){return!!(s&&typeof s=="object"&&"before"in s&&"after"in s)}function Ev(s){return!!(s&&typeof s=="object"&&"from"in s)}function Rv(s){return!!(s&&typeof s=="object"&&"after"in s)}function Lv(s){return!!(s&&typeof s=="object"&&"before"in s)}function Wv(s){return!!(s&&typeof s=="object"&&"dayOfWeek"in s)}function Fv(s,e){var n,i=e.from,l=e.to;if(i&&l){var h=Ia(l,i)<0;h&&(n=[l,i],i=n[0],l=n[1]);var p=Ia(s,i)>=0&&Ia(l,s)>=0;return p}return l?Kt(l,s):i?Kt(i,s):!1}function Bv(s){return yc(s)}function $v(s){return Array.isArray(s)&&s.every(yc)}function Uv(s,e){return e.some(function(n){if(typeof n=="boolean")return n;if(Bv(n))return Kt(s,n);if($v(n))return n.includes(s);if(Ev(n))return Fv(s,n);if(Wv(n))return n.dayOfWeek.includes(s.getDay());if(Ov(n)){var i=Ia(n.before,s),l=Ia(n.after,s),h=i>0,p=l<0,b=cc(n.before,n.after);return b?p&&h:h||p}return Rv(n)?Ia(s,n.after)>0:Lv(n)?Ia(n.before,s)>0:typeof n=="function"?n(s):!1})}function kc(s,e,n){var i=Object.keys(e).reduce(function(h,p){var b=e[p];return Uv(s,b)&&h.push(p),h},[]),l={};return i.forEach(function(h){return l[h]=!0}),n&&!wc(s,n)&&(l.outside=!0),l}function Vv(s,e){for(var n=Jt(s[0]),i=bc(s[s.length-1]),l,h,p=n;p<=i;){var b=kc(p,e),C=!b.disabled&&!b.hidden;if(!C){p=Bt(p,1);continue}if(b.selected)return p;b.today&&!h&&(h=p),l||(l=p),p=Bt(p,1)}return h||l}var qv=365;function Ih(s,e){var n=e.moveBy,i=e.direction,l=e.context,h=e.modifiers,p=e.retry,b=p===void 0?{count:0,lastFocused:s}:p,C=l.weekStartsOn,k=l.fromDate,D=l.toDate,T=l.locale,E={day:Bt,week:lc,month:xa,year:ry,startOfWeek:function(W){return l.ISOWeek?js(W):_a(W,{locale:T,weekStartsOn:C})},endOfWeek:function(W){return l.ISOWeek?hh(W):vc(W,{locale:T,weekStartsOn:C})}},M=E[n](s,i==="after"?1:-1);i==="before"&&k?M=ny([k,M]):i==="after"&&D&&(M=iy([D,M]));var $=!0;if(h){var y=kc(M,h);$=!y.disabled&&!y.hidden}return $?M:b.count>qv?b.lastFocused:Ih(M,{moveBy:n,direction:i,context:l,modifiers:h,retry:fe(fe({},b),{count:b.count+1})})}var _h=u.createContext(void 0);function Yv(s){var e=wn(),n=Ch(),i=u.useState(),l=i[0],h=i[1],p=u.useState(),b=p[0],C=p[1],k=Vv(e.displayMonths,n),D=l??(b&&e.isDateDisplayed(b))?b:k,T=function(){C(l),h(void 0)},E=function(W){h(W)},M=He(),$=function(W,ie){if(l){var J=Ih(l,{moveBy:W,direction:ie,context:M,modifiers:n});Kt(l,J)||(e.goToDate(J,l),E(J))}},y={focusedDay:l,focusTarget:D,blur:T,focus:E,focusDayAfter:function(){return $("day","after")},focusDayBefore:function(){return $("day","before")},focusWeekAfter:function(){return $("week","after")},focusWeekBefore:function(){return $("week","before")},focusMonthBefore:function(){return $("month","before")},focusMonthAfter:function(){return $("month","after")},focusYearBefore:function(){return $("year","before")},focusYearAfter:function(){return $("year","after")},focusStartOfWeek:function(){return $("startOfWeek","before")},focusEndOfWeek:function(){return $("endOfWeek","after")}};return t.jsx(_h.Provider,{value:y,children:s.children})}function Cc(){var s=u.useContext(_h);if(!s)throw new Error("useFocusContext must be used within a FocusProvider");return s}function zv(s,e){var n=Ch(),i=kc(s,n,e);return i}var Ic=u.createContext(void 0);function Kv(s){if(!Gi(s.initialProps)){var e={selected:void 0};return t.jsx(Ic.Provider,{value:e,children:s.children})}return t.jsx(Jv,{initialProps:s.initialProps,children:s.children})}function Jv(s){var e=s.initialProps,n=s.children,i=function(h,p,b){var C,k,D;if((C=e.onDayClick)===null||C===void 0||C.call(e,h,p,b),p.selected&&!e.required){(k=e.onSelect)===null||k===void 0||k.call(e,void 0,h,p,b);return}(D=e.onSelect)===null||D===void 0||D.call(e,h,h,p,b)},l={selected:e.selected,onDayClick:i};return t.jsx(Ic.Provider,{value:l,children:n})}function Ah(){var s=u.useContext(Ic);if(!s)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return s}function Hv(s,e){var n=He(),i=Ah(),l=jc(),h=Dc(),p=Cc(),b=p.focusDayAfter,C=p.focusDayBefore,k=p.focusWeekAfter,D=p.focusWeekBefore,T=p.blur,E=p.focus,M=p.focusMonthBefore,$=p.focusMonthAfter,y=p.focusYearBefore,W=p.focusYearAfter,ie=p.focusStartOfWeek,J=p.focusEndOfWeek,V=function(ee){var Q,Mt,dt,pt;Gi(n)?(Q=i.onDayClick)===null||Q===void 0||Q.call(i,s,e,ee):bn(n)?(Mt=l.onDayClick)===null||Mt===void 0||Mt.call(l,s,e,ee):vn(n)?(dt=h.onDayClick)===null||dt===void 0||dt.call(h,s,e,ee):(pt=n.onDayClick)===null||pt===void 0||pt.call(n,s,e,ee)},se=function(ee){var Q;E(s),(Q=n.onDayFocus)===null||Q===void 0||Q.call(n,s,e,ee)},_e=function(ee){var Q;T(),(Q=n.onDayBlur)===null||Q===void 0||Q.call(n,s,e,ee)},Ne=function(ee){var Q;(Q=n.onDayMouseEnter)===null||Q===void 0||Q.call(n,s,e,ee)},Ce=function(ee){var Q;(Q=n.onDayMouseLeave)===null||Q===void 0||Q.call(n,s,e,ee)},xe=function(ee){var Q;(Q=n.onDayPointerEnter)===null||Q===void 0||Q.call(n,s,e,ee)},oe=function(ee){var Q;(Q=n.onDayPointerLeave)===null||Q===void 0||Q.call(n,s,e,ee)},Fe=function(ee){var Q;(Q=n.onDayTouchCancel)===null||Q===void 0||Q.call(n,s,e,ee)},ze=function(ee){var Q;(Q=n.onDayTouchEnd)===null||Q===void 0||Q.call(n,s,e,ee)},Be=function(ee){var Q;(Q=n.onDayTouchMove)===null||Q===void 0||Q.call(n,s,e,ee)},vt=function(ee){var Q;(Q=n.onDayTouchStart)===null||Q===void 0||Q.call(n,s,e,ee)},$t=function(ee){var Q;(Q=n.onDayKeyUp)===null||Q===void 0||Q.call(n,s,e,ee)},$e=function(ee){var Q;switch(ee.key){case"ArrowLeft":ee.preventDefault(),ee.stopPropagation(),n.dir==="rtl"?b():C();break;case"ArrowRight":ee.preventDefault(),ee.stopPropagation(),n.dir==="rtl"?C():b();break;case"ArrowDown":ee.preventDefault(),ee.stopPropagation(),k();break;case"ArrowUp":ee.preventDefault(),ee.stopPropagation(),D();break;case"PageUp":ee.preventDefault(),ee.stopPropagation(),ee.shiftKey?y():M();break;case"PageDown":ee.preventDefault(),ee.stopPropagation(),ee.shiftKey?W():$();break;case"Home":ee.preventDefault(),ee.stopPropagation(),ie();break;case"End":ee.preventDefault(),ee.stopPropagation(),J();break}(Q=n.onDayKeyDown)===null||Q===void 0||Q.call(n,s,e,ee)},Ke={onClick:V,onFocus:se,onBlur:_e,onKeyDown:$e,onKeyUp:$t,onMouseEnter:Ne,onMouseLeave:Ce,onPointerEnter:xe,onPointerLeave:oe,onTouchCancel:Fe,onTouchEnd:ze,onTouchMove:Be,onTouchStart:vt};return Ke}function Qv(){var s=He(),e=Ah(),n=jc(),i=Dc(),l=Gi(s)?e.selected:bn(s)?n.selected:vn(s)?i.selected:void 0;return l}function Gv(s){return Object.values(ya).includes(s)}function Xv(s,e){var n=[s.classNames.day];return Object.keys(e).forEach(function(i){var l=s.modifiersClassNames[i];if(l)n.push(l);else if(Gv(i)){var h=s.classNames["day_".concat(i)];h&&n.push(h)}}),n}function Zv(s,e){var n=fe({},s.styles.day);return Object.keys(e).forEach(function(i){var l;n=fe(fe({},n),(l=s.modifiersStyles)===null||l===void 0?void 0:l[i])}),n}function ew(s,e,n){var i,l,h,p=He(),b=Cc(),C=zv(s,e),k=Hv(s,C),D=Qv(),T=!!(p.onDayClick||p.mode!=="default");u.useEffect(function(){var Ne;C.outside||b.focusedDay&&T&&Kt(b.focusedDay,s)&&((Ne=n.current)===null||Ne===void 0||Ne.focus())},[b.focusedDay,s,n,T,C.outside]);var E=Xv(p,C).join(" "),M=Zv(p,C),$=!!(C.outside&&!p.showOutsideDays||C.hidden),y=(h=(l=p.components)===null||l===void 0?void 0:l.DayContent)!==null&&h!==void 0?h:wv,W=t.jsx(y,{date:s,displayMonth:e,activeModifiers:C}),ie={style:M,className:E,children:W,role:"gridcell"},J=b.focusTarget&&Kt(b.focusTarget,s)&&!C.outside,V=b.focusedDay&&Kt(b.focusedDay,s),se=fe(fe(fe({},ie),(i={disabled:C.disabled,role:"gridcell"},i["aria-selected"]=C.selected,i.tabIndex=V||J?0:-1,i)),k),_e={isButton:T,isHidden:$,activeModifiers:C,selectedDays:D,buttonProps:se,divProps:ie};return _e}function tw(s){var e=u.useRef(null),n=ew(s.date,s.displayMonth,e);return n.isHidden?t.jsx("div",{role:"gridcell"}):n.isButton?t.jsx(Ji,fe({name:"day",ref:e},n.buttonProps)):t.jsx("div",fe({},n.divProps))}function aw(s){var e=s.number,n=s.dates,i=He(),l=i.onWeekNumberClick,h=i.styles,p=i.classNames,b=i.locale,C=i.labels.labelWeekNumber,k=i.formatters.formatWeekNumber,D=k(Number(e),{locale:b});if(!l)return t.jsx("span",{className:p.weeknumber,style:h.weeknumber,children:D});var T=C(Number(e),{locale:b}),E=function(M){l(e,n,M)};return t.jsx(Ji,{name:"week-number","aria-label":T,className:p.weeknumber,style:h.weeknumber,onClick:E,children:D})}function sw(s){var e,n,i=He(),l=i.styles,h=i.classNames,p=i.showWeekNumber,b=i.components,C=(e=b==null?void 0:b.Day)!==null&&e!==void 0?e:tw,k=(n=b==null?void 0:b.WeekNumber)!==null&&n!==void 0?n:aw,D;return p&&(D=t.jsx("td",{className:h.cell,style:l.cell,children:t.jsx(k,{number:s.weekNumber,dates:s.dates})})),t.jsxs("tr",{className:h.row,style:l.row,children:[D,s.dates.map(function(T){return t.jsx("td",{className:h.cell,style:l.cell,role:"presentation",children:t.jsx(C,{displayMonth:s.displayMonth,date:T})},rb(T))})]})}function Fm(s,e,n){for(var i=n!=null&&n.ISOWeek?hh(e):vc(e,n),l=n!=null&&n.ISOWeek?js(s):_a(s,n),h=Ia(i,l),p=[],b=0;b<=h;b++)p.push(Bt(l,b));var C=p.reduce(function(k,D){var T=n!=null&&n.ISOWeek?ph(D):yh(D,n),E=k.find(function(M){return M.weekNumber===T});return E?(E.dates.push(D),k):(k.push({weekNumber:T,dates:[D]}),k)},[]);return C}function rw(s,e){var n=Fm(Jt(s),bc(s),e);if(e!=null&&e.useFixedWeeks){var i=ib(s,e);if(i<6){var l=n[n.length-1],h=l.dates[l.dates.length-1],p=lc(h,6-i),b=Fm(lc(h,1),p,e);n.push.apply(n,b)}}return n}function nw(s){var e,n,i,l=He(),h=l.locale,p=l.classNames,b=l.styles,C=l.hideHead,k=l.fixedWeeks,D=l.components,T=l.weekStartsOn,E=l.firstWeekContainsDate,M=l.ISOWeek,$=rw(s.displayMonth,{useFixedWeeks:!!k,ISOWeek:M,locale:h,weekStartsOn:T,firstWeekContainsDate:E}),y=(e=D==null?void 0:D.Head)!==null&&e!==void 0?e:vv,W=(n=D==null?void 0:D.Row)!==null&&n!==void 0?n:sw,ie=(i=D==null?void 0:D.Footer)!==null&&i!==void 0?i:xv;return t.jsxs("table",{id:s.id,className:p.table,style:b.table,role:"grid","aria-labelledby":s["aria-labelledby"],children:[!C&&t.jsx(y,{}),t.jsx("tbody",{className:p.tbody,style:b.tbody,children:$.map(function(J){return t.jsx(W,{displayMonth:s.displayMonth,dates:J.dates,weekNumber:J.weekNumber},J.weekNumber)})}),t.jsx(ie,{displayMonth:s.displayMonth})]})}function iw(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var ow=iw()?u.useLayoutEffect:u.useEffect,rc=!1,lw=0;function Bm(){return"react-day-picker-".concat(++lw)}function cw(s){var e,n=s??(rc?Bm():null),i=u.useState(n),l=i[0],h=i[1];return ow(function(){l===null&&h(Bm())},[]),u.useEffect(function(){rc===!1&&(rc=!0)},[]),(e=s??l)!==null&&e!==void 0?e:void 0}function dw(s){var e,n,i=He(),l=i.dir,h=i.classNames,p=i.styles,b=i.components,C=wn().displayMonths,k=cw(i.id?"".concat(i.id,"-").concat(s.displayIndex):void 0),D=i.id?"".concat(i.id,"-grid-").concat(s.displayIndex):void 0,T=[h.month],E=p.month,M=s.displayIndex===0,$=s.displayIndex===C.length-1,y=!M&&!$;l==="rtl"&&(e=[M,$],$=e[0],M=e[1]),M&&(T.push(h.caption_start),E=fe(fe({},E),p.caption_start)),$&&(T.push(h.caption_end),E=fe(fe({},E),p.caption_end)),y&&(T.push(h.caption_between),E=fe(fe({},E),p.caption_between));var W=(n=b==null?void 0:b.Caption)!==null&&n!==void 0?n:pv;return t.jsxs("div",{className:T.join(" "),style:E,children:[t.jsx(W,{id:k,displayMonth:s.displayMonth,displayIndex:s.displayIndex}),t.jsx(nw,{id:D,"aria-labelledby":k,displayMonth:s.displayMonth})]},s.displayIndex)}function uw(s){var e=He(),n=e.classNames,i=e.styles;return t.jsx("div",{className:n.months,style:i.months,children:s.children})}function mw(s){var e,n,i=s.initialProps,l=He(),h=Cc(),p=wn(),b=u.useState(!1),C=b[0],k=b[1];u.useEffect(function(){l.initialFocus&&h.focusTarget&&(C||(h.focus(h.focusTarget),k(!0)))},[l.initialFocus,C,h.focus,h.focusTarget,h]);var D=[l.classNames.root,l.className];l.numberOfMonths>1&&D.push(l.classNames.multiple_months),l.showWeekNumber&&D.push(l.classNames.with_weeknumber);var T=fe(fe({},l.styles.root),l.style),E=Object.keys(i).filter(function($){return $.startsWith("data-")}).reduce(function($,y){var W;return fe(fe({},$),(W={},W[y]=i[y],W))},{}),M=(n=(e=i.components)===null||e===void 0?void 0:e.Months)!==null&&n!==void 0?n:uw;return t.jsx("div",fe({className:D.join(" "),style:T,dir:l.dir,id:l.id,nonce:i.nonce,title:i.title,lang:i.lang},E,{children:t.jsx(M,{children:p.displayMonths.map(function($,y){return t.jsx(dw,{displayIndex:y,displayMonth:$},y)})})}))}function hw(s){var e=s.children,n=Lb(s,["children"]);return t.jsx(av,{initialProps:n,children:t.jsx(mv,{children:t.jsx(Kv,{initialProps:n,children:t.jsx(Nv,{initialProps:n,children:t.jsx(Dv,{initialProps:n,children:t.jsx(Mv,{children:t.jsx(Yv,{children:e})})})})})})})}function fw(s){return t.jsx(hw,fe({},s,{children:t.jsx(mw,{initialProps:s})}))}function dc({className:s,classNames:e,showOutsideDays:n=!0,...i}){return t.jsx(fw,{showOutsideDays:n,className:Ca("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Ca(lm({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Ca(lm({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...e},components:{IconLeft:({...l})=>t.jsx(xx,{className:"h-4 w-4"}),IconRight:({...l})=>t.jsx(ex,{className:"h-4 w-4"})},...i})}dc.displayName="Calendar";const $m={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"0.0.0",VITE_DEV_MODE:"true",VITE_ENABLE_OFFLINE_PERSISTENCE:"false",VITE_FIREBASE_API_KEY:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),VITE_FIREBASE_APP_ID:"1:483702062341:web:b1ff06ad175cb7ae428b6c",VITE_FIREBASE_AUTH_DOMAIN:"voda-c6abd.firebaseapp.com",VITE_FIREBASE_AUTH_EMULATOR_URL:"http://localhost:9099",VITE_FIREBASE_FIRESTORE_EMULATOR_HOST:"localhost:8080",VITE_FIREBASE_FUNCTIONS_EMULATOR_HOST:"localhost:5001",VITE_FIREBASE_MEASUREMENT_ID:"G-CV6QGH7G7P",VITE_FIREBASE_MESSAGING_SENDER_ID:"483702062341",VITE_FIREBASE_PROJECT_ID:"voda-c6abd",VITE_FIREBASE_STORAGE_BUCKET:"voda-c6abd.appspot.com",VITE_FORCE_HASH_ROUTER:"true",VITE_SHOP_ID:"demo-shop-001",VITE_SHOP_NAME:"Ù…Ø­Ù„ ÙƒØ§Ø´ÙŠ Ù„ÙŠÙ†Ùƒ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ",VITE_SHOW_ENV_BANNER:"true",VITE_USE_EMULATORS:"false",VITE_USE_FIREBASE_EMULATOR:"false"},as=s=>typeof s=="string"&&s.trim().length>0,gw={getCurrentMonthId(){const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`},async getWalletUsage(s){var e;try{if(!as(s))return console.error("Error getting wallet usage: invalid walletId",s),null;const n=Ae(F,"walletLimits",s),i=await fa(n);if(i.exists()){const h=i.data();return{walletId:s,used_transfer:h.monthlyTransferUsed??h.used_transfer??0,used_withdraw:h.monthlyWithdrawUsed??h.used_withdraw??0,monthly_limit:h.monthlyLimit??h.monthlyTransferLimit??h.monthlyWithdrawLimit??2e5,last_reset:h.lastMonthlyReset??h.last_reset??null,updatedAt:h.updatedAt||xs.now()}}const l={walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:2e5,last_reset:null,updatedAt:xs.now()};return await sa(n,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,monthlyTransferLimit:2e5,monthlyWithdrawLimit:2e5,lastMonthlyReset:null,updatedAt:gt(),ownerId:(e=rr.currentUser)==null?void 0:e.uid}),l}catch(n){return console.error("Error getting wallet usage:",n),{walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:2e5,last_reset:null,updatedAt:xs.now()}}},shouldResetLimits(s){const e=new Date,n=e.getDate();if(!s)return n===1;if(n===1){const i=s.toDate(),l=e.getMonth(),h=e.getFullYear();return i.getMonth()!==l||i.getFullYear()!==h}return!1},async autoResetLimitsIfNeeded(s){try{if(!as(s))return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),!1;typeof import.meta<"u";const e=await this.getWalletUsage(s);return e&&this.shouldResetLimits(e.last_reset)?(console.log(`ðŸ”„ ØªØµÙÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯ Ù„Ù„Ù…Ø­ÙØ¸Ø© ${s} - Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø£ÙˆÙ„ Ù…Ù† Ø§Ù„Ø´Ù‡Ø±`),await this.resetWalletUsage(s)):!1}catch(e){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯:",e),!1}},async resetWalletUsage(s){try{if(!as(s))return console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),!1;const e=Ae(F,"walletLimits",s);return await sa(e,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:gt(),updatedAt:gt()},{merge:!0}),console.log(`ðŸ”„ ØªÙ… ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${s} Ø¨Ù†Ø¬Ø§Ø­`),!0}catch(e){return console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©:",e),!1}},async calculateUsageFromTransactions(s){var e,n;try{if(!as(s))return console.error("Ø®Ø·Ø£ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),{used_transfer:0,used_withdraw:0};const i=Ae(F,"walletLimits",s),l=new Date;let h=xs.fromDate(new Date(l.getFullYear(),l.getMonth(),1));try{const D=await fa(i);h=D.exists()?((e=D.data())==null?void 0:e.lastMonthlyReset)??((n=D.data())==null?void 0:n.last_reset)??h:h}catch{}const p=Ie(ce(F,"tx"),q("uid","==",s),...h?[q("createdAt",">=",h)]:[]),b=await ve(p);let C=0,k=0;return b.forEach(D=>{const T=D.data();T.status==="completed"&&(T.type==="transfer"?C+=T.amount:T.type==="withdraw"&&(k+=T.amount))}),{used_transfer:C,used_withdraw:k}}catch(i){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª:",i),{used_transfer:0,used_withdraw:0}}},async getWalletUsageWithRefresh(s){var e,n;try{if(!as(s))return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠØ«: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),null;typeof import.meta<"u";const i=await this.getWalletUsage(s);if(!i){const h=await this.calculateUsageFromTransactions(s),p=Ae(F,"walletLimits",s);try{await sa(p,{monthlyTransferUsed:h.used_transfer,monthlyWithdrawUsed:h.used_withdraw,updatedAt:gt(),ownerId:(e=rr.currentUser)==null?void 0:e.uid},{merge:!0})}catch{}return{walletId:s,used_transfer:h.used_transfer,used_withdraw:h.used_withdraw,monthly_limit:2e5,last_reset:null,updatedAt:xs.now()}}const l=await this.calculateUsageFromTransactions(s);if(i.used_transfer!==l.used_transfer||i.used_withdraw!==l.used_withdraw){const h=Ae(F,"walletLimits",s);try{await sa(h,{monthlyTransferUsed:l.used_transfer,monthlyWithdrawUsed:l.used_withdraw,updatedAt:gt(),ownerId:(n=rr.currentUser)==null?void 0:n.uid},{merge:!0})}catch{}return await this.getWalletUsage(s)}return i}catch(i){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠØ«:",i),{walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:2e5,last_reset:null,updatedAt:xs.now()}}},calculateRemaining(s){return{remainingTransfer:Math.max(0,s.monthly_limit-s.used_transfer),remainingWithdraw:Math.max(0,s.monthly_limit-s.used_withdraw)}},async canPerformOperation(s,e,n){try{if(!as(s))return console.error("Error checking operation limits: invalid walletId",s),{canPerform:!1,message:"walletId ØºÙŠØ± ØµØ§Ù„Ø­"};const i=await this.getWalletUsageWithRefresh(s);if(!i)return{canPerform:!1,message:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù…Ø­ÙØ¸Ø©"};const l=this.calculateRemaining(i);return n==="transfer"&&e>l.remainingTransfer?{canPerform:!1,message:`ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø³Ù…ÙˆØ­. Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${l.remainingTransfer.toLocaleString()} Ø¬.Ù… Ù…Ù† Ø£ØµÙ„ ${i.monthly_limit.toLocaleString()} Ø¬.Ù…`,remaining:l.remainingTransfer}:n==="withdraw"&&e>l.remainingWithdraw?{canPerform:!1,message:`ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…Ø³Ù…ÙˆØ­. Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${l.remainingWithdraw.toLocaleString()} Ø¬.Ù… Ù…Ù† Ø£ØµÙ„ ${i.monthly_limit.toLocaleString()} Ø¬.Ù…`,remaining:l.remainingWithdraw}:{canPerform:!0}}catch(i){return console.error("Error checking operation limits:",i),{canPerform:!1,message:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¯ÙˆØ¯"}}},async updateUsage(s,e,n){var i;try{if(!as(s))throw new Error("walletId ØºÙŠØ± ØµØ§Ù„Ø­");const l=await this.getWalletUsageWithRefresh(s);if(!l)throw new Error("Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù…Ø­ÙØ¸Ø©");const h=await this.canPerformOperation(s,e,n);if(!h.canPerform)throw new Error(h.message||"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©");const p=n==="transfer"?l.used_transfer+e:l.used_transfer,b=n==="withdraw"?l.used_withdraw+e:l.used_withdraw,C=Ae(F,"walletLimits",l.walletId);try{await sa(C,{monthlyTransferUsed:p,monthlyWithdrawUsed:b,updatedAt:gt(),ownerId:(i=rr.currentUser)==null?void 0:i.uid},{merge:!0})}catch{}let k=await this.getWalletUsageWithRefresh(s);return k||(k={walletId:s,used_transfer:p,used_withdraw:b,monthly_limit:l.monthly_limit,last_reset:l.last_reset,updatedAt:xs.now()}),k}catch(l){throw console.error("Error updating wallet usage:",l),l}},async resetWalletUsageManually(s){try{if(!as(s))throw new Error("walletId ØºÙŠØ± ØµØ§Ù„Ø­");const e=Ae(F,"walletLimits",s),n={walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:0,last_reset:null,updatedAt:new Date};return sa(e,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:gt(),updatedAt:gt()},{merge:!0}).catch(i=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ ØªØµÙÙŠØ± Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Firebase:",i)}),console.log(`âœ… ØªÙ… ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${s} Ø¨Ù†Ø¬Ø§Ø­`),n}catch(e){throw console.error("Error resetting wallet usage:",e),e}},async getAllWalletsUsage(s){try{const n=(await Bi.getByMerchantId(s)).map(l=>this.getWalletUsageWithRefresh(l.id));return(await Promise.all(n)).filter(l=>l!==null)}catch(e){return console.error("Error getting all wallets usage:",e),[]}}};function pw(s){return s?`readBroadcastIds_${s}`:"readBroadcastIds_guest"}function xw({className:s}){const{user:e,profile:n,isSubscriptionActive:i}=hc(),l=Km(),[h,p]=u.useState([]),[b,C]=u.useState(new Set),[k,D]=u.useState(!1),[T,E]=u.useState(""),[M,$]=u.useState(!1),[y,W]=u.useState(null),[ie,J]=u.useState("none"),[V,se]=u.useState(null),[_e,Ne]=u.useState(!1),Ce=u.useRef(new Set);u.useRef(!1);const xe=u.useRef(!0),oe=u.useRef(null),Fe=u.useRef(null),ze=u.useRef(null),[Be,vt]=u.useState({position:"fixed",top:0,left:0,zIndex:1e4}),$t=u.useMemo(()=>{const Y=["global"];return e!=null&&e.uid&&Y.push(`user:${e.uid}`),n!=null&&n.shopId&&Y.push(`shop:${n.shopId}`),Y},[e==null?void 0:e.uid,n==null?void 0:n.shopId]),$e=pw(e==null?void 0:e.uid),Ke=u.useMemo(()=>{var re;const Y=(re=l==null?void 0:l.pathname)==null?void 0:re.includes("/user/pending-approval");return!!(e!=null&&e.uid)&&!Y},[e==null?void 0:e.uid,l==null?void 0:l.pathname]);u.useEffect(()=>{try{const Y=localStorage.getItem($e);if(Y){const le=JSON.parse(Y);Array.isArray(le)&&C(new Set(le.filter(Boolean)))}else C(new Set)}catch(Y){console.warn("Failed to load read ids",Y),C(new Set)}},[$e]),u.useEffect(()=>{if(!Ke){p([]);return}xe.current=!0;const Y=()=>{lx($t,re=>{if(xe.current){const Te=Date.now(),be=60*1e3,ke=re.filter(tt=>{var Aa,na;const Ot=(Aa=tt.createdAt)!=null&&Aa.toMillis?tt.createdAt.toMillis():(na=tt.createdAt)!=null&&na.seconds?tt.createdAt.seconds*1e3:0;return!(Te-Ot<be)}).map(tt=>tt.id).filter(Boolean);Ce.current=new Set(ke),xe.current=!1}p(re)})};Y();const le=re=>{console.log("ðŸ”” OneSignal Notification received",re);try{const Te=re.notification||re;if(Te&&(Te.title||Te.body)){const be={id:`temp_${Date.now()}`,title:Te.title||"Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯",message:Te.body||Te.message||"",audienceKey:"global",active:!0,createdAt:{toMillis:()=>Date.now(),seconds:Math.floor(Date.now()/1e3),nanoseconds:0}};se(be),Ne(!0),oe.current&&clearTimeout(oe.current),oe.current=window.setTimeout(()=>{Ne(!1),se(null)},5e3)}}catch(Te){console.error("Error parsing OneSignal event for instant alert",Te)}Y()};try{const re=window.OneSignal;re&&re.Notifications&&re.Notifications.addEventListener&&re.Notifications.addEventListener("foregroundWillDisplay",le)}catch(re){console.error("Failed to add OneSignal listener",re)}return()=>{try{const re=window.OneSignal;re&&re.Notifications&&re.Notifications.removeEventListener&&re.Notifications.removeEventListener("foregroundWillDisplay",le)}catch{}}},[$t,Ke]),u.useEffect(()=>{const Y=new Set(h.map(re=>re.id).filter(Boolean)),le=h.filter(re=>re.id&&!Ce.current.has(re.id));le.length>0&&(se(le[0]),Ne(!0),oe.current&&clearTimeout(oe.current),oe.current=window.setTimeout(()=>{Ne(!1),se(null)},5e3)),Ce.current=Y},[h]),u.useEffect(()=>()=>{oe.current&&clearTimeout(oe.current)},[]);const ee=h.reduce((Y,le)=>Y+(le.id&&!b.has(le.id)?1:0),0),Q=Y=>{if(!Y)return;let le=new Set(b);try{const re=localStorage.getItem($e);if(re){const Te=JSON.parse(re);Array.isArray(Te)&&Te.forEach(be=>le.add(be))}}catch{}if(!le.has(Y)){le.add(Y),C(le);try{localStorage.setItem($e,JSON.stringify(Array.from(le)))}catch{}}},Mt=()=>{const Y=h.map(re=>re.id).filter(Boolean);if(Y.length===0)return;let le=new Set(b);try{const re=localStorage.getItem($e);if(re){const Te=JSON.parse(re);Array.isArray(Te)&&Te.forEach(be=>le.add(be))}}catch{}Y.forEach(re=>le.add(re)),C(le);try{localStorage.setItem($e,JSON.stringify(Array.from(le)))}catch{}},dt=(Y,le)=>{var re;if(Y)try{const Te=((re=nr)==null?void 0:re.isNativePlatform)&&nr.getPlatform()==="android",be=/\.apk(\?|$)/i.test(Y);if(Te&&be){const ke=`cashy://update?url=${encodeURIComponent(Y)}`;window.location.href=ke}else window.open(Y,"_blank")}catch{try{window.open(Y,"_blank")}catch{}}le&&Q(le)},pt=()=>{if(!Fe.current||!ze.current)return;const Y=Fe.current.getBoundingClientRect(),le=8,re=ze.current.offsetWidth||320,Te=Y.bottom+le;let be=Y.right-re;const ke=window.innerWidth;be=Math.min(Math.max(be,le),ke-re-le),vt(tt=>({...tt,top:Te,left:be}))};return u.useEffect(()=>{if(!_e)return;pt();const Y=()=>pt();return window.addEventListener("resize",Y),window.addEventListener("scroll",Y,!0),()=>{window.removeEventListener("resize",Y),window.removeEventListener("scroll",Y,!0)}},[_e]),u.useEffect(()=>{if(!(e!=null&&e.uid)){J("none");return}(async()=>{try{const le=Ie(ce(F,"waiting_list"),q("userId","==",e.uid)),Te=(await ve(le)).docs.map(tt=>({id:tt.id,...tt.data()})).sort((tt,Ot)=>{var na,Nn,Ds,ks,hr,jn;const ba=((Nn=(na=tt==null?void 0:tt.createdAt)==null?void 0:na.toMillis)==null?void 0:Nn.call(na))??((Ds=tt==null?void 0:tt.createdAt)==null?void 0:Ds.seconds)*1e3??0;return(((hr=(ks=Ot==null?void 0:Ot.createdAt)==null?void 0:ks.toMillis)==null?void 0:hr.call(ks))??((jn=Ot==null?void 0:Ot.createdAt)==null?void 0:jn.seconds)*1e3??0)-ba});if(Te.length===0){J("none");return}const be=Te[0],ke=(be==null?void 0:be.contacted)===!0||(be==null?void 0:be.status)==="contacted";J(ke?"contacted":"pending")}catch(le){console.warn("âš ï¸ ÙØ´Ù„ Ø¬Ù„Ø¨ Ø­Ø§Ù„Ø© waiting_list:",le),J("none")}})()},[e==null?void 0:e.uid]),Ke?t.jsxs("div",{className:`relative inline-flex items-center gap-2 ${s||""}`,ref:Fe,children:[t.jsxs(tx,{onOpenChange:Y=>{Y&&ee>0&&Mt()},children:[t.jsx(ax,{asChild:!0,children:t.jsxs(I,{variant:"ghost",size:"icon",className:"relative h-10 w-10 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",children:[t.jsx(Fi,{className:`h-5 w-5 transition-colors ${ee>0?"text-primary":"text-gray-600 dark:text-gray-300"}`}),ee>0&&t.jsx("span",{className:"absolute top-2 right-2 h-4 min-w-[16px] px-0.5 bg-red-600 text-white text-[10px] font-bold flex items-center justify-center rounded-full ring-2 ring-white dark:ring-gray-950 shadow-sm animate-in zoom-in duration-200",children:ee>99?"99+":ee})]})}),t.jsxs(sx,{className:"w-96 p-0 rounded-xl shadow-xl border-gray-100 dark:border-gray-800",align:"end",forceMount:!0,children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 dark:border-gray-800 bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm",children:[t.jsx("span",{className:"font-bold text-base text-gray-900 dark:text-gray-100",children:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"}),h.length>0&&t.jsxs(I,{variant:"ghost",size:"sm",className:"h-8 text-xs text-primary hover:text-primary hover:bg-primary/5 transition-colors",onClick:Mt,children:[t.jsx(zi,{className:"h-3.5 w-3.5 ml-1.5"}),"ØªÙ…ÙŠÙŠØ² Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡"]})]}),h.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center space-y-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center",children:t.jsx(Fi,{className:"w-6 h-6 text-gray-300 dark:text-gray-600"})}),t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹"}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù‡Ù†Ø§ ÙÙˆØ± ÙˆØµÙˆÙ„Ù‡Ø§"})]}):t.jsx("div",{className:"max-h-[400px] overflow-y-auto overflow-x-hidden scrollbar-thin scrollbar-thumb-gray-200 dark:scrollbar-thumb-gray-700 scrollbar-track-transparent",children:h.map(Y=>{var Te,be;const le=Y.id?!b.has(Y.id):!1;let re="";try{const ke=(Te=Y.createdAt)!=null&&Te.toMillis?Y.createdAt.toMillis():(be=Y.createdAt)!=null&&be.seconds?Y.createdAt.seconds*1e3:null;if(ke){const tt=Date.now()-ke,Ot=Math.floor(tt/6e4),ba=Math.floor(Ot/60),Aa=Math.floor(ba/24);Aa>0?re=`Ù…Ù†Ø° ${Aa} ÙŠÙˆÙ…`:ba>0?re=`Ù…Ù†Ø° ${ba} Ø³Ø§Ø¹Ø©`:Ot>0?re=`Ù…Ù†Ø° ${Ot} Ø¯Ù‚ÙŠÙ‚Ø©`:re="Ø§Ù„Ø¢Ù†"}}catch{}return t.jsx("div",{className:`relative group px-4 py-3.5 border-b border-gray-50 dark:border-gray-800/50 last:border-0 transition-all duration-200 hover:bg-gray-50 dark:hover:bg-gray-800/50 ${le?"bg-blue-50/40 dark:bg-blue-900/10":""}`,children:t.jsxs("div",{className:"flex items-start gap-3.5",children:[t.jsxs("div",{className:`relative shrink-0 w-10 h-10 rounded-full flex items-center justify-center transition-colors ${le?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400"}`,children:[t.jsx(Fi,{className:"h-5 w-5"}),le&&t.jsx("span",{className:"absolute top-0 right-0 w-2.5 h-2.5 bg-blue-600 rounded-full ring-2 ring-white dark:ring-gray-950 animate-pulse"})]}),t.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsx("p",{className:`text-sm leading-none ${le?"font-bold text-gray-900 dark:text-gray-100":"font-medium text-gray-700 dark:text-gray-300"}`,children:Y.title||"Ø¥Ø´Ø¹Ø§Ø±"}),re&&t.jsx("span",{className:"text-[10px] text-gray-400 whitespace-nowrap",children:re})]}),t.jsx("p",{className:`text-xs leading-relaxed ${le?"text-gray-800 dark:text-gray-200":"text-gray-500 dark:text-gray-400"} whitespace-pre-line`,children:Y.message}),Y.linkUrl&&t.jsx("div",{className:"pt-2",children:t.jsxs(I,{variant:"outline",size:"sm",className:"h-7 text-xs gap-1.5 rounded-full hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200 dark:hover:bg-blue-900/20 dark:hover:border-blue-800 transition-all",onClick:()=>dt(Y.linkUrl,Y.id),children:[t.jsx(ox,{className:"h-3 w-3"}),"ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·"]})})]}),t.jsx("div",{className:"shrink-0 self-center opacity-0 group-hover:opacity-100 transition-opacity focus-within:opacity-100",children:le&&t.jsx(I,{variant:"ghost",size:"icon",className:"h-7 w-7 rounded-full text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",onClick:ke=>{ke.stopPropagation(),Q(Y.id)},title:"ØªÙ…ÙŠÙŠØ² ÙƒÙ…Ù‚Ø±ÙˆØ¡",children:t.jsx(zi,{className:"h-4 w-4"})})})]})},Y.id)})})]})]}),V&&hp.createPortal(t.jsx("div",{ref:ze,style:Be,className:`pointer-events-auto transition-all duration-300 ${_e?"opacity-100 translate-y-0":"opacity-0 -translate-y-3"}`,children:t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl border border-gray-200 p-4 w-80 max-w-[calc(100vw-16px)] flex items-start gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:t.jsx(Fi,{className:"w-4 h-4 text-primary"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-semibold",children:V.title||"Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯"}),t.jsx("div",{className:"text-xs text-muted-foreground whitespace-pre-line",children:V.message}),V.linkUrl&&t.jsx(I,{variant:"link",className:"px-0 h-6 text-xs",onClick:()=>dt(V.linkUrl,V.id),children:"ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·"})]})]})}),document.body)]}):null}function yw(s,e=300){const[n,i]=K.useState(s);return K.useEffect(()=>{const l=setTimeout(()=>i(s),e);return()=>clearTimeout(l)},[s,e]),n}const bw=({userId:s,transactions:e})=>{const[n,i]=u.useState(!1),[l,h]=u.useState(!1),[p,b]=u.useState(!1),[C,k]=u.useState({monthlyWithdrawalProfit:0,monthlyTransferProfit:0,monthlySalesProfit:0,lastUpdated:new Date}),{userSubscription:D,user:T,profile:E}=hc();u.useEffect(()=>{s&&n&&p&&$()},[s,n,p]),u.useEffect(()=>{if(!n||!p)return;const V=setInterval(()=>{const se=new Date;(C.lastUpdated.getMonth()!==se.getMonth()||C.lastUpdated.getFullYear()!==se.getFullYear())&&$()},3e4);return()=>clearInterval(V)},[n,p,C.lastUpdated]);const M=async()=>{try{if(!s)return 0;const V=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),se=new Date,_e=V.format(se),[Ne,Ce]=_e.split("-"),xe=`${Ne}-${Ce}-01`,oe=parseInt(Ne),Fe=parseInt(Ce),ze=new Date(oe,Fe,0).getDate(),Be=`${Ne}-${Ce}-${String(ze).padStart(2,"0")}`;let vt;try{const $e=Ie(ce(F,"dailySales"),q("userId","==",s));vt=await ve($e)}catch{const $e=Ie(ce(F,"users",s,"dailySales"));vt=await ve($e)}let $t=0;return vt.forEach($e=>{const Ke=$e.data(),ee=String(Ke.date??"").slice(0,10);if(ee&&!Ke.isDeferred&&ee>=xe&&ee<=Be){const Q=Number(Ke.sellingPrice??Ke.price??0),Mt=Number(Ke.wholesalePrice??0),dt=Number(Ke.quantity??Ke.qty??0),pt=Number(Ke.profit??(Q-Mt)*dt);$t+=pt}}),Math.round($t*100)/100}catch(V){return console.warn("ØªØ¹Ø°Ø± Ø­Ø³Ø§Ø¨ Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©:",V),0}},$=async()=>{if(s)try{if(Array.isArray(e)&&e.length>0){const _e=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),Ne=new Date,[Ce,xe]=_e.format(Ne).split("-"),oe=parseInt(Ce),Fe=parseInt(xe)-1,ze=At.filterVisibleTransactions(e,"monthly",s);let Be=0,vt=0;ze.forEach($e=>{var le,re,Te;let Ke;$e.createdAt instanceof Date?Ke=$e.createdAt:typeof((le=$e.createdAt)==null?void 0:le.toDate)=="function"?Ke=$e.createdAt.toDate():Ke=new Date($e.createdAt||0);const ee=_e.formatToParts(Ke),Q=parseInt(((re=ee.find(be=>be.type==="year"))==null?void 0:re.value)||"0"),Mt=parseInt(((Te=ee.find(be=>be.type==="month"))==null?void 0:Te.value)||"0")-1,dt=String($e.status||"confirmed").toLowerCase();if(Q!==oe||Mt!==Fe||dt!=="completed"&&dt!=="confirmed")return;const pt=($e.type||$e.txnType||"").toLowerCase(),Y={type:pt==="withdrawal"||pt==="machine_withdrawal"?"withdraw":pt,amount:Number($e.amount||0),commission:$e.commission};Y.type==="withdraw"||Y.type==="atm_withdraw"?Be+=ga.calculateProfitFromTransaction(Y):(Y.type==="send"||Y.type==="receive"||Y.type==="transfer")&&(vt+=ga.calculateProfitFromTransaction(Y))});const $t=await M();k({monthlyWithdrawalProfit:Math.round(Be*100)/100,monthlyTransferProfit:Math.round(vt*100)/100,monthlySalesProfit:$t,lastUpdated:new Date});return}const V=ga.getWithdrawTransferProfits(s),se=await M();k({monthlyWithdrawalProfit:V.monthlyWithdrawProfit||0,monthlyTransferProfit:V.monthlyTransferProfit||0,monthlySalesProfit:se,lastUpdated:new Date})}catch(V){console.error("Error loading profit data:",V)}},y=V=>`${Number(V).toLocaleString("en-US",{maximumFractionDigits:0})} Ø¬.Ù…`,W=async()=>{try{const V=(D==null?void 0:D.subscription)||null,se=(V==null?void 0:V.planType)??(V==null?void 0:V.plan)??null,_e=typeof se=="string"?se.toLowerCase():null;if(se===ta.ZERO||_e==="zero"||_e==="0"||se===0)return!0}catch{}try{if(s){const V=await Jm(s),se=(V==null?void 0:V.planType)??(V==null?void 0:V.plan)??null,_e=typeof se=="string"?se.toLowerCase():null;if(se===ta.ZERO||_e==="zero"||_e==="0"||se===0)return!0}}catch{}return!1},ie=async()=>{try{if(await W()){cm({title:"Ø§Ù„Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ",description:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±.",variant:"destructive"});return}}catch{}const V=s||(T==null?void 0:T.uid),se=V?`monthlyReportsLock_v4_${V}`:"monthlyReportsLock_v4",_e=(localStorage.getItem(se)??localStorage.getItem("monthlyReportsLock_v4"))==="true",Ne=await zt.hasMasterPin(V);_e&&Ne?h(!0):(b(!0),i(!0))},J=async()=>{try{if(await W()){cm({title:"Ø§Ù„Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ",description:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±.",variant:"destructive"}),h(!1);return}}catch{}b(!0),i(!0),h(!1)};return t.jsxs(t.Fragment,{children:[t.jsx(I,{size:"sm",variant:"ghost",onClick:ie,className:"h-6 w-6 p-0 text-gray-400 hover:text-purple-600 hover:bg-purple-50 rounded-full transition-colors duration-200",title:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",children:t.jsx(cr,{className:"h-4 w-4"})}),t.jsx(ue,{open:n,onOpenChange:i,children:t.jsxs(me,{className:"max-w-[280px] sm:max-w-[320px] mx-auto bg-white dark:bg-[#0f172a] border border-gray-200 dark:border-slate-800 shadow-xl rounded-xl p-0 overflow-hidden",children:[t.jsx(ye,{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-b border-gray-100 dark:border-slate-800",children:t.jsxs(he,{className:"text-sm font-bold text-gray-900 dark:text-slate-100 flex items-center justify-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-full border border-gray-200 dark:border-slate-700",children:t.jsx(Ui,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"})}),"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±"]})}),t.jsxs("div",{className:"p-4 space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-red-50 dark:bg-red-900/20 rounded-md",children:t.jsx(ir,{className:"h-3.5 w-3.5 text-red-600 dark:text-red-400"})}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø³Ø­Ø¨"})]}),t.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:y(C.monthlyWithdrawalProfit)})]}),t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-green-50 dark:bg-green-900/20 rounded-md",children:t.jsx(Qm,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"ØªØ­ÙˆÙŠÙ„"})]}),t.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:y(C.monthlyTransferProfit)})]}),t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-violet-50 dark:bg-violet-900/20 rounded-md",children:t.jsx(Zm,{className:"h-3.5 w-3.5 text-violet-600 dark:text-violet-400"})}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"})]}),t.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:y(C.monthlySalesProfit)})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-100 dark:border-purple-900/30 mt-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-md shadow-sm",children:t.jsx(Va,{className:"h-3.5 w-3.5 text-purple-600 dark:text-purple-400"})}),t.jsx("span",{className:"font-bold text-purple-900 dark:text-purple-100 text-sm",children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"})]}),t.jsx("span",{className:"font-bold text-base text-purple-700 dark:text-purple-300",children:y(C.monthlyWithdrawalProfit+C.monthlyTransferProfit+C.monthlySalesProfit)})]})]}),t.jsx("div",{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-t border-gray-100 dark:border-slate-800 flex justify-center",children:t.jsx(I,{onClick:()=>i(!1),className:"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 hover:text-gray-900 w-full sm:w-auto px-8 rounded-lg text-sm font-medium shadow-sm",children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),t.jsx(fp,{open:l,onOpenChange:h,mode:"verify",title:"Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",description:"Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",userId:s||(T==null?void 0:T.uid),userRole:E==null?void 0:E.role,onSuccess:J})]})},vw=s=>t.jsx(bw,{...s});function ww({open:s,onOpenChange:e,onSuccess:n,userId:i}){const[l,h]=u.useState(""),[p,b]=u.useState(""),[C,k]=u.useState(!1),[D,T]=u.useState(!1),[E,M]=u.useState(""),[$,y]=u.useState(!1),[W,ie]=u.useState(!1),{toast:J}=Hi(),V=K.useRef(null);u.useEffect(()=>{let Ne=!0;return(async()=>{const Ce=await zt.hasMasterPin(i);Ne&&ie(Ce)})(),()=>{Ne=!1}},[i,s]);const se=()=>{h(""),b(""),M(""),k(!1),T(!1),e(!1)},_e=async Ne=>{Ne.preventDefault(),M(""),y(!0);try{if(W){if(!await zt.verifyMasterPin(l,i)){M("Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­"),y(!1);return}}else{if(l.length<4){M("ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ 4 Ø£Ø±Ù‚Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„"),y(!1);return}if(l!==p){M("Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚"),y(!1);return}if(!await zt.createMasterPin(l,i)){M("ØªØ¹Ø°Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"),y(!1);return}}J({title:"Ù†Ø¬Ø­ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",description:W?"ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¨Ù†Ø¬Ø§Ø­":"ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¨Ù†Ø¬Ø§Ø­"}),n(),se()}catch{M("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ")}finally{y(!1)}};return t.jsx(ue,{open:s,onOpenChange:e,children:t.jsxs(me,{className:"sm:max-w-md",dir:"rtl",children:[t.jsx(ye,{children:t.jsxs(he,{className:"flex items-center gap-2 text-lg font-semibold",children:[t.jsx(dm,{className:"h-5 w-5 text-green-600"}),W?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ":"Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"]})}),t.jsxs("form",{ref:V,onSubmit:_e,className:"space-y-4",children:[t.jsx("div",{className:"text-sm text-gray-600 bg-blue-50 p-3 rounded-lg",children:W?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø±Ø¨Ø§Ø­":"Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø±Ø¨Ø§Ø­. ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ±Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø±ÙˆÙÙŠÙ„."}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{htmlFor:"pin",children:W?"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ":"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯"}),t.jsxs("div",{className:"relative",children:[t.jsx(Z,{id:"pin",type:C?"text":"password",value:l,onChange:Ne=>h(Ne.target.value),onKeyDown:Ne=>{var Ce;Ne.key==="Enter"&&(Ne.preventDefault(),(Ce=V.current)==null||Ce.requestSubmit())},placeholder:W?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ":"Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø³Ø±ÙŠ Ø¬Ø¯ÙŠØ¯ (4 Ø£Ø±Ù‚Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)",className:"pr-10",dir:"ltr",autoComplete:"off",required:!0}),t.jsx(I,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>k(!C),children:C?t.jsx(um,{className:"h-4 w-4"}):t.jsx(cr,{className:"h-4 w-4"})})]})]}),!W&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{htmlFor:"confirmPin",children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ"}),t.jsxs("div",{className:"relative",children:[t.jsx(Z,{id:"confirmPin",type:D?"text":"password",value:p,onChange:Ne=>b(Ne.target.value),onKeyDown:Ne=>{var Ce;Ne.key==="Enter"&&(Ne.preventDefault(),(Ce=V.current)==null||Ce.requestSubmit())},placeholder:"Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",className:"pr-10",dir:"ltr",autoComplete:"off",required:!0}),t.jsx(I,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>T(!D),children:D?t.jsx(um,{className:"h-4 w-4"}):t.jsx(cr,{className:"h-4 w-4"})})]})]}),E&&t.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[t.jsx(gp,{className:"h-4 w-4"}),E]}),t.jsxs("div",{className:"flex gap-2 pt-4",children:[t.jsxs(I,{type:"submit",disabled:$,className:"flex-1 bg-green-600 hover:bg-green-700",children:[t.jsx(dm,{className:"h-4 w-4 mr-2"}),$?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...":W?"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­":"Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"]}),t.jsx(I,{type:"button",variant:"outline",onClick:se,disabled:$,children:"Ø¥Ù„ØºØ§Ø¡"})]})]})]})})}const Nw=({userId:s,transactions:e})=>{const[n,i]=u.useState(!1),[l,h]=u.useState(!1),[p,b]=u.useState(!1),[C,k]=u.useState({dailyWithdrawalProfit:0,dailyTransferProfit:0,dailySalesProfit:0,lastUpdated:new Date}),{shopId:D}=Hm();u.useEffect(()=>{s&&n&&p&&E()},[s,n,p,e,D]),u.useEffect(()=>{if(!n||!p)return;const W=setInterval(()=>{const ie=new Date;C.lastUpdated.getDate()!==ie.getDate()&&E()},3e4);return()=>clearInterval(W)},[n,p,C.lastUpdated]);const T=async()=>{if(!s)return 0;const W=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),ie=W.format(new Date);let J=0;try{const V=Ie(ce(F,"dailySales"),q("userId","==",s),...D?[q("shopId","==",D)]:[]),se=await ve(V),_e=[];se.forEach(xe=>{_e.push({id:xe.id,data:xe.data()})}),(await ve(ce(F,"users",s,"dailySales"))).forEach(xe=>{const oe=xe.data();D&&oe.shopId&&oe.shopId!==D||_e.push({id:xe.id,data:oe})});const Ce=new Map;_e.forEach(xe=>{const oe=String(xe.data.clientId||xe.id);Ce.has(oe)||Ce.set(oe,xe.data)}),Ce.forEach(xe=>{if(xe.isDeferred)return;let oe=null;if(xe.createdAt)typeof xe.createdAt.toDate=="function"?oe=xe.createdAt.toDate():xe.createdAt instanceof Date?oe=xe.createdAt:typeof xe.createdAt=="number"?oe=new Date(xe.createdAt):typeof xe.createdAt=="string"&&(oe=new Date(xe.createdAt));else if(xe.date){const ze=xe.time||"00:00";oe=new Date(`${xe.date}T${ze}:00`)}let Fe=!1;if(oe&&!isNaN(oe.getTime())?W.format(oe)===ie&&(Fe=!0):String(xe.date||"").slice(0,10)===ie&&(Fe=!0),Fe){const ze=Number(xe.quantity||1),Be=Number(xe.profit??(Number(xe.sellingPrice||0)-Number(xe.wholesalePrice||0))*ze);J+=Be}})}catch(V){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©:",V)}return Math.round(J*100)/100},E=async()=>{if(s)try{if(Array.isArray(e)&&e.length>0){const J=new Date,V=At.filterVisibleTransactions(e,"daily",s);let se=0,_e=0;V.forEach(Ce=>{const xe=new Date(Ce.createdAt),oe=String(Ce.status||"confirmed").toLowerCase();if(xe.toDateString()!==J.toDateString())return;const Fe=(Ce.type||Ce.txnType||"").toLowerCase(),ze=String(Ce.title||"");if(Fe==="cash_addition"||ze.includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"))return;const Be={type:Fe==="withdrawal"||Fe==="machine_withdrawal"?"withdraw":Fe,amount:Number(Ce.amount||0),commission:Ce.commission};Be.type==="withdraw"||Be.type==="atm_withdraw"?se+=ga.calculateProfitFromTransaction(Be):(Be.type==="send"||Be.type==="receive"||Be.type==="transfer")&&(_e+=ga.calculateProfitFromTransaction(Be))});const Ne=await T();k({dailyWithdrawalProfit:Math.round(se*100)/100,dailyTransferProfit:Math.round(_e*100)/100,dailySalesProfit:Ne,lastUpdated:new Date});try{ga.updateProfitsFromTransactions(e,s)}catch{}return}const W=ga.getWithdrawTransferProfits(s),ie=await T();k({dailyWithdrawalProfit:W.dailyWithdrawProfit||0,dailyTransferProfit:W.dailyTransferProfit||0,dailySalesProfit:ie,lastUpdated:new Date})}catch(W){console.error("Error loading profit data:",W)}},M=W=>`${Number(W).toLocaleString("en-US",{maximumFractionDigits:0})} Ø¬.Ù…`,$=()=>{ga.hasProfitPin(s),h(!0)},y=()=>{b(!0),i(!0),h(!1)};return t.jsxs(t.Fragment,{children:[t.jsx(I,{size:"sm",variant:"ghost",onClick:$,className:"h-6 w-6 p-0 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors duration-200",title:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©",children:t.jsx(cr,{className:"h-4 w-4"})}),t.jsx(ue,{open:n,onOpenChange:i,children:t.jsxs(me,{className:"max-w-[280px] sm:max-w-[320px] mx-auto bg-white dark:bg-[#0f172a] border border-gray-200 dark:border-slate-800 shadow-xl rounded-xl p-0 overflow-hidden",children:[t.jsx(ye,{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-b border-gray-100 dark:border-slate-800",children:t.jsxs(he,{className:"text-sm font-bold text-gray-900 dark:text-slate-100 flex items-center justify-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-full border border-gray-200 dark:border-slate-700",children:t.jsx(Va,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…"]})}),t.jsxs("div",{className:"p-4 space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-red-50 dark:bg-red-900/20 rounded-md",children:t.jsx(ir,{className:"h-3.5 w-3.5 text-red-600 dark:text-red-400"})}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø³Ø­Ø¨"})]}),t.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:M(C.dailyWithdrawalProfit)})]}),t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-green-50 dark:bg-green-900/20 rounded-md",children:t.jsx(Qm,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"ØªØ­ÙˆÙŠÙ„"})]}),t.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:M(C.dailyTransferProfit)})]}),t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-violet-50 dark:bg-violet-900/20 rounded-md",children:t.jsx(Zm,{className:"h-3.5 w-3.5 text-violet-600 dark:text-violet-400"})}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"})]}),t.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:M(C.dailySalesProfit)})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-900/30 mt-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-md shadow-sm",children:t.jsx(Va,{className:"h-3.5 w-3.5 text-blue-600 dark:text-blue-400"})}),t.jsx("span",{className:"font-bold text-blue-900 dark:text-blue-100 text-sm",children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"})]}),t.jsx("span",{className:"font-bold text-base text-blue-700 dark:text-blue-300",children:M(C.dailyWithdrawalProfit+C.dailyTransferProfit+C.dailySalesProfit)})]})]}),t.jsx("div",{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-t border-gray-100 dark:border-slate-800 flex justify-center",children:t.jsx(I,{onClick:()=>i(!1),className:"bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-700 text-gray-700 dark:text-slate-200 hover:bg-gray-50 dark:hover:bg-slate-700 hover:text-gray-900 w-full sm:w-auto px-8 rounded-lg text-sm font-medium shadow-sm",children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),t.jsx(ww,{open:l,onOpenChange:h,onSuccess:y,userId:s})]})},jw=s=>t.jsx(Nw,{...s});var _c="Radio",[Sw,Th]=uc(_c),[Dw,kw]=Sw(_c),Ph=u.forwardRef((s,e)=>{const{__scopeRadio:n,name:i,checked:l=!1,required:h,disabled:p,value:b="on",onCheck:C,form:k,...D}=s,[T,E]=u.useState(null),M=pn(e,W=>E(W)),$=u.useRef(!1),y=T?k||!!T.closest("form"):!0;return t.jsxs(Dw,{scope:n,checked:l,disabled:p,children:[t.jsx(mr.button,{type:"button",role:"radio","aria-checked":l,"data-state":Rh(l),"data-disabled":p?"":void 0,disabled:p,value:b,...D,ref:M,onClick:ns(s.onClick,W=>{l||C==null||C(),y&&($.current=W.isPropagationStopped(),$.current||W.stopPropagation())})}),y&&t.jsx(Eh,{control:T,bubbles:!$.current,name:i,value:b,checked:l,required:h,disabled:p,form:k,style:{transform:"translateX(-100%)"}})]})});Ph.displayName=_c;var Mh="RadioIndicator",Oh=u.forwardRef((s,e)=>{const{__scopeRadio:n,forceMount:i,...l}=s,h=kw(Mh,n);return t.jsx(mc,{present:i||h.checked,children:t.jsx(mr.span,{"data-state":Rh(h.checked),"data-disabled":h.disabled?"":void 0,...l,ref:e})})});Oh.displayName=Mh;var Cw="RadioBubbleInput",Eh=u.forwardRef(({__scopeRadio:s,control:e,checked:n,bubbles:i=!0,...l},h)=>{const p=u.useRef(null),b=pn(p,h),C=xp(n),k=yp(e);return u.useEffect(()=>{const D=p.current;if(!D)return;const T=window.HTMLInputElement.prototype,M=Object.getOwnPropertyDescriptor(T,"checked").set;if(C!==n&&M){const $=new Event("click",{bubbles:i});M.call(D,n),D.dispatchEvent($)}},[C,n,i]),t.jsx(mr.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...l,tabIndex:-1,ref:b,style:{...l.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Eh.displayName=Cw;function Rh(s){return s?"checked":"unchecked"}var Iw=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Xi="RadioGroup",[_w]=uc(Xi,[Xm,Th]),Lh=Xm(),Wh=Th(),[Aw,Tw]=_w(Xi),Fh=u.forwardRef((s,e)=>{const{__scopeRadioGroup:n,name:i,defaultValue:l,value:h,required:p=!1,disabled:b=!1,orientation:C,dir:k,loop:D=!0,onValueChange:T,...E}=s,M=Lh(n),$=pp(k),[y,W]=Ym({prop:h,defaultProp:l??null,onChange:T,caller:Xi});return t.jsx(Aw,{scope:n,name:i,required:p,disabled:b,value:y,onValueChange:W,children:t.jsx(cx,{asChild:!0,...M,orientation:C,dir:$,loop:D,children:t.jsx(mr.div,{role:"radiogroup","aria-required":p,"aria-orientation":C,"data-disabled":b?"":void 0,dir:$,...E,ref:e})})})});Fh.displayName=Xi;var Bh="RadioGroupItem",$h=u.forwardRef((s,e)=>{const{__scopeRadioGroup:n,disabled:i,...l}=s,h=Tw(Bh,n),p=h.disabled||i,b=Lh(n),C=Wh(n),k=u.useRef(null),D=pn(e,k),T=h.value===l.value,E=u.useRef(!1);return u.useEffect(()=>{const M=y=>{Iw.includes(y.key)&&(E.current=!0)},$=()=>E.current=!1;return document.addEventListener("keydown",M),document.addEventListener("keyup",$),()=>{document.removeEventListener("keydown",M),document.removeEventListener("keyup",$)}},[]),t.jsx(dx,{asChild:!0,...b,focusable:!p,active:T,children:t.jsx(Ph,{disabled:p,required:h.required,checked:T,...C,...l,name:h.name,ref:D,onCheck:()=>h.onValueChange(l.value),onKeyDown:ns(M=>{M.key==="Enter"&&M.preventDefault()}),onFocus:ns(l.onFocus,()=>{var M;E.current&&((M=k.current)==null||M.click())})})})});$h.displayName=Bh;var Pw="RadioGroupIndicator",Uh=u.forwardRef((s,e)=>{const{__scopeRadioGroup:n,...i}=s,l=Wh(n);return t.jsx(Oh,{...l,...i,ref:e})});Uh.displayName=Pw;var Vh=Fh,qh=$h,Mw=Uh;const Yh=u.forwardRef(({className:s,...e},n)=>t.jsx(Vh,{className:Ca("grid gap-2",s),...e,ref:n}));Yh.displayName=Vh.displayName;const Yi=u.forwardRef(({className:s,...e},n)=>t.jsx(qh,{ref:n,className:Ca("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...e,children:t.jsx(Mw,{className:"flex items-center justify-center",children:t.jsx(rx,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Yi.displayName=qh.displayName;const Ow=({isOpen:s,onClose:e,userId:n,wallets:i,walletBalances:l,onSuccess:h})=>{const{toast:p}=Hi(),[b,C]=u.useState(1),[k,D]=u.useState(""),[T,E]=u.useState(""),[M,$]=u.useState(""),[y,W]=u.useState("cash"),[ie,J]=u.useState(""),[V,se]=u.useState(!1),[_e,Ne]=u.useState(!1);u.useEffect(()=>{s&&(C(1),D(""),E(""),$(""),W("cash"),J(""))},[s]);const Ce=()=>{if(!k||parseFloat(k)<=0){p({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}if(!M){p({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}const oe=l[M]||0;if(parseFloat(k)>oe){p({title:"Ø®Ø·Ø£",description:"Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ØºÙŠØ± ÙƒØ§ÙÙ",variant:"destructive"});return}C(2)},xe=async()=>{var oe;if(y==="wallet"&&!ie){p({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ©",variant:"destructive"});return}se(!0);try{const Fe=parseFloat(k),ze=T?parseFloat(T):0,Be=Fe+ze,vt=Fe,$t=Ae(F,"users",n),$e=await fa($t);if(!$e.exists())throw"User document not found";const ee=$e.data().walletBalances||{},Q=Number(ee[M]||0);if(console.log("[AtmWithdrawDialog] Validation:",{sourceWalletId:M,currentSourceBalance:Q,numericAmount:Fe,numericCommission:ze,totalDeductedFromWallet:Be}),Q<Be)throw`Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ØºÙŠØ± ÙƒØ§ÙÙ (Ø§Ù„Ù…ØªØ§Ø­: ${Q}, Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø®ØµÙ…Ù‡: ${Be})`;const Mt=await qa.canPerformOperation(M,Fe,"transfer");if(!Mt.canPerform)throw Mt.message||"ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø³Ù…ÙˆØ­";const dt=ic(F),pt={};pt[`walletBalances.${M}`]=Yl(-Be);let Y="";y==="wallet"&&ie?(pt[`walletBalances.${ie}`]=Yl(vt),Y=`Wallet: ${(oe=i.find(be=>be.id===ie))==null?void 0:oe.name}`):y==="cash"?(pt.cashBalance=Yl(vt),Y="Cash Drawer"):Y="No Addition",dt.update($t,pt);const le=i.find(be=>be.id===M),re=Ae(ce(F,"userTransactions"));dt.set(re,{userId:n,type:"atm_withdraw",amount:Fe,commission:ze,totalCharged:Be,netAmount:vt,sourceWalletId:M,destinationType:y,destinationWalletId:y==="wallet"?ie:null,status:"completed",createdAt:gt(),note:`Ø³Ø­Ø¨ ATM Ù…Ù† ${le==null?void 0:le.name}`,walletId:M,sender_msisdn:(le==null?void 0:le.phone)||"",details:`ATM Withdraw from ${le==null?void 0:le.name} -> ${Y}`}),await dt.commit();try{await qa.updateUsage(M,Fe,"transfer")}catch(be){console.error("Failed to update wallet limits:",be)}if(ze>0)try{ga.addProfit(-ze,n)}catch(be){console.error("Failed to update profits:",be)}let Te={};if(y==="cash")Te={delta:{amount:vt,commission:ze,totalDeducted:Be,type:"atm_withdraw",walletId:M}};else{const be={...l};be[M]=(be[M]||0)-Be,y==="wallet"&&(be[ie]=(be[ie]||0)+vt),Te={walletBalances:be}}window.dispatchEvent(new CustomEvent("dashboard:external-update",{detail:Te})),p({title:"Ù†Ø¬Ø§Ø­",description:"ØªÙ…Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­"}),h==null||h(),e()}catch(Fe){console.error("ATM Withdraw Error:",Fe),p({title:"Ø®Ø·Ø£",description:typeof Fe=="string"?Fe:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",variant:"destructive"})}finally{se(!1)}};return t.jsxs(ue,{open:s,onOpenChange:e,children:[t.jsxs(me,{className:"sm:max-w-[425px]",dir:"rtl",children:[t.jsxs(ye,{children:[t.jsxs(he,{className:"flex items-center gap-2",children:["Ø³Ø­Ø¨ ATM",t.jsxs(I,{variant:"ghost",size:"sm",onClick:()=>Ne(!0),className:"gap-1 px-2 text-rose-600 hover:text-rose-700 hover:bg-rose-50 mx-2",children:[t.jsx($i,{className:"h-4 w-4"}),t.jsx("span",{className:"text-xs font-medium",children:"Ø´Ø±Ø­ Ù‚Ø³Ù… atm"})]})]}),t.jsx(et,{children:b===1?"Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø³Ø­Ø¨":"Ø§Ø®ØªØ± Ù…ÙƒØ§Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"})]}),b===1?t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{children:"Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø­Ø¨"}),t.jsx(Z,{type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:k,onChange:oe=>D(oe.target.value)})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø®ØµÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),t.jsx(Z,{type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©",value:T,onChange:oe=>E(oe.target.value)})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{children:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø³Ø­Ø¨ Ù…Ù†Ù‡Ø§"}),t.jsxs(Fa,{value:M,onValueChange:$,children:[t.jsx(Ba,{children:t.jsx($a,{placeholder:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})}),t.jsx(Ua,{children:i.map(oe=>t.jsx(oa,{value:oe.id,children:t.jsxs("div",{className:"flex justify-between w-full gap-4",children:[t.jsx("span",{children:oe.phone||oe.name}),t.jsx("span",{className:"text-muted-foreground text-xs",children:l[oe.id]?`${Number(l[oe.id]).toLocaleString("en-US",{maximumFractionDigits:0})} Ø¬.Ù…`:"0 Ø¬.Ù…"})]})},oe.id))})]})]})]}):t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"bg-muted p-4 rounded-lg mb-4",children:[t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Ø§Ù„Ù…Ø¨Ù„Øº:"}),t.jsxs("span",{className:"font-bold",children:[k?Number(k).toLocaleString("en-US",{maximumFractionDigits:0}):0," Ø¬.Ù…"]})]}),t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (Ø®ØµÙ… Ø¥Ø¶Ø§ÙÙŠ):"}),t.jsxs("span",{className:"font-bold text-red-500",children:[T?Number(T).toLocaleString("en-US",{maximumFractionDigits:0}):0," Ø¬.Ù…"]})]}),parseFloat(T)>0&&t.jsx("div",{className:"text-[10px] text-amber-600 mb-2 text-right",children:"* Ø³ÙŠØªÙ… Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ù…Ù† Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø´Ù‡Ø±"}),t.jsxs("div",{className:"flex justify-between mb-2 pt-2 border-t border-dashed",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©:"}),t.jsxs("span",{className:"font-bold text-red-600",children:[(Number(k)+(Number(T)||0)).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),t.jsxs("div",{className:"border-t pt-2 flex justify-between",children:[t.jsx("span",{className:"text-sm font-semibold",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¶Ø§Ù Ù„Ù„ÙˆØ¬Ù‡Ø©:"}),t.jsxs("span",{className:"font-bold text-green-600",children:[k?Number(k).toLocaleString("en-US",{maximumFractionDigits:0}):0," Ø¬.Ù…"]})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(G,{children:"Ù…ÙƒØ§Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),t.jsxs(Yh,{value:y,onValueChange:oe=>W(oe),className:"flex flex-col gap-2",children:[t.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[t.jsx(Yi,{value:"cash",id:"r1"}),t.jsx(G,{htmlFor:"r1",className:"cursor-pointer",children:"Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ (Cash Drawer)"})]}),t.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[t.jsx(Yi,{value:"wallet",id:"r2"}),t.jsx(G,{htmlFor:"r2",className:"cursor-pointer",children:"Ù…Ø­ÙØ¸Ø© Ø£Ø®Ø±Ù‰"})]}),t.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[t.jsx(Yi,{value:"none",id:"r3"}),t.jsx(G,{htmlFor:"r3",className:"cursor-pointer",children:"Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ© (Ø³Ø­Ø¨ ÙÙ‚Ø·)"})]})]})]}),y==="wallet"&&t.jsxs("div",{className:"space-y-2 mt-4 animate-in fade-in slide-in-from-top-2",children:[t.jsx(G,{children:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ©"}),t.jsxs(Fa,{value:ie,onValueChange:J,children:[t.jsx(Ba,{children:t.jsx($a,{placeholder:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})}),t.jsx(Ua,{children:i.filter(oe=>oe.id!==M).map(oe=>t.jsx(oa,{value:oe.id,children:oe.phone||oe.name},oe.id))})]})]})]}),t.jsxs(We,{className:"flex-col sm:flex-row gap-2",children:[b===2&&t.jsx(I,{variant:"outline",onClick:()=>C(1),disabled:V,children:"Ø¹ÙˆØ¯Ø©"}),b===1?t.jsxs(I,{onClick:Ce,className:"w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white",children:["Ø§Ù„ØªØ§Ù„ÙŠ ",t.jsx(bp,{className:"mr-2 h-4 w-4"})]}):t.jsxs(I,{onClick:xe,disabled:V,className:"w-full sm:w-auto bg-green-600 hover:bg-green-700",children:[V&&t.jsx(rs,{className:"mr-2 h-4 w-4 animate-spin"}),"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³Ø­Ø¨"]})]})]}),t.jsx(Gm,{isOpen:_e,onClose:()=>Ne(!1),videoUrl:"https://www.youtube.com/watch?v=V_wM36ICBck",title:"Ø´Ø±Ø­ Ù‚Ø³Ù… ATM",className:"z-[10002]"})]})};class or{static async processTransfer(e){const{amount:n,currentCashBalance:i,currentWalletBalances:l,wallets:h,selectedWalletId:p}=e;if(n<=0)return{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};if(p&&!e.skipRemoteLimitsCheck)try{const D=await qa.canPerformOperation(p,n,"transfer");if(!D.canPerform)return{success:!1,newCashBalance:i,newWalletBalances:l,message:D.message||"ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰",error:"LIMIT_EXCEEDED"}}catch(D){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„:",D),{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",error:"LIMIT_CHECK_ERROR"}}if(n<=0)return{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};if(p){const D=Math.max(l[p]||0,0);if(D<n){const T=h.find(E=>E.id===p);return{success:!1,newCashBalance:i,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©${T?` ${T.name}`:""}. Ø§Ù„Ù…ØªØ§Ø­: ${D} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${n} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_WALLET_BALANCE"}}}else{const D=or.calculateTotalWalletBalance(l);if(D<n)return{success:!1,newCashBalance:i,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­: ${D} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${n} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_WALLET_BALANCE"}}const b={...l};if(p){const D=b[p]||0;b[p]=D-n}else{let D=n;for(const T of h){if(D<=0)break;const E=Math.max(b[T.id]||0,0),M=Math.min(E,D);M>0&&(b[T.id]=(b[T.id]||0)-M,D-=M)}}const C=i+n;let k="ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­";if(p){const D=b[p]||0;D<0&&(k=`ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­ Ù…Ø¹ ØªØ­Ø°ÙŠØ±: Ø±ØµÙŠØ¯ Ù…Ø­ÙØ¸Ø© ${p} Ø£ØµØ¨Ø­ ${D} Ø¬Ù†ÙŠÙ‡.`)}return{success:!0,newCashBalance:C,newWalletBalances:b,message:k}}static processDeposit(e){const{amount:n,currentCashBalance:i,currentWalletBalances:l,wallets:h}=e;if(n<=0)return{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};const p=this.calculateTotalWalletBalance(l);if(p<n)return{success:!1,newCashBalance:i,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­: ${p} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${n} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_WALLET_BALANCE"};const b=i+n,C={...l};let k=n;const D=h.find(E=>E.isDefault);if(D&&C[D.id]>=k)C[D.id]-=k,k=0;else for(const E of h){if(k<=0)break;const M=C[E.id]||0;if(M>0){const $=Math.min(M,k);C[E.id]=M-$,k-=$}}const T=k>0?`ØªÙ… Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ø¬Ø²Ø¦ÙŠØ§Ù‹. ØªÙ… Ø¥ÙŠØ¯Ø§Ø¹ ${n-k} Ø¬Ù†ÙŠÙ‡ ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©`:`ØªÙ… Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ø¨Ù†Ø¬Ø§Ø­. ØªÙ… Ø¥Ø¶Ø§ÙØ© ${n} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©`;return{success:!0,newCashBalance:b,newWalletBalances:C,message:T}}static async processWithdraw(e){const{amount:n,currentCashBalance:i,currentWalletBalances:l,wallets:h,selectedWalletId:p}=e;if(n<=0)return{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};if(p&&!e.skipRemoteLimitsCheck)try{const D=await qa.canPerformOperation(p,n,"withdraw");if(!D.canPerform)return{success:!1,newCashBalance:i,newWalletBalances:l,message:D.message||"ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰",error:"LIMIT_EXCEEDED"}}catch(D){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø³Ø­Ø¨:",D),{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø³Ø­Ø¨",error:"LIMIT_CHECK_ERROR"}}if(i<n)return{success:!1,newCashBalance:i,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­: ${i} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${n} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_CASH_BALANCE"};const b=Math.round(i-n),C={...l},k=p?h.find(D=>D.id===p):h.find(D=>D.isDefault)||h[0];if(k){const D=C[k.id]||0;C[k.id]=D+n}else return{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…ØªØ§Ø­Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø¥Ù„ÙŠÙ‡Ø§",error:"NO_WALLETS_AVAILABLE"};return{success:!0,newCashBalance:b,newWalletBalances:C,message:`ØªÙ… Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­. ØªÙ… Ø¥Ø¶Ø§ÙØ© ${n} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ Ù…Ø­ÙØ¸Ø© ${(k==null?void 0:k.name)||""}`}}static validateOperation(e,n){return e<=0?{valid:!1,error:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±"}:!n||n.length===0?{valid:!1,error:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…ØªØ§Ø­Ø©"}:{valid:!0}}static calculateTotalWalletBalance(e){return Object.values(e).reduce((n,i)=>n+Math.max(i,0),0)}static deductFromWalletsAddToCash(e,n,i,l){return this.processTransfer({amount:e,currentCashBalance:n,currentWalletBalances:i,wallets:l})}static deductFromWalletsAddToCashDeposit(e,n,i,l){return this.processDeposit({amount:e,currentCashBalance:n,currentWalletBalances:i,wallets:l})}static deductFromCashAddToWallets(e,n,i,l){return this.processWithdraw({amount:e,currentCashBalance:n,currentWalletBalances:i,wallets:l})}static applyTransactionResult(e,n,i){e.success&&(n(e.newCashBalance),i(e.newWalletBalances))}static validateTransaction(e,n,i,l){if(e<=0)return{isValid:!1,error:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±"};if(n==="transfer"){const h=this.calculateTotalWalletBalance(l);if(h<e)return{isValid:!1,error:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸ (${h} Ø¬Ù†ÙŠÙ‡) ØºÙŠØ± ÙƒØ§ÙÙŠ Ù„Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (${e} Ø¬Ù†ÙŠÙ‡)`}}else if(n==="withdraw"){if(i<e)return{isValid:!1,error:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© (${i} Ø¬Ù†ÙŠÙ‡) ØºÙŠØ± ÙƒØ§ÙÙŠ Ù„Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (${e} Ø¬Ù†ÙŠÙ‡)`}}else if(n==="deposit"){const h=this.calculateTotalWalletBalance(l);if(h<e)return{isValid:!1,error:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸ (${h} Ø¬Ù†ÙŠÙ‡) ØºÙŠØ± ÙƒØ§ÙÙŠ Ù„Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (${e} Ø¬Ù†ÙŠÙ‡)`}}return{isValid:!0}}static getDeductionPreview(e,n,i){const l=[];let h=e;for(const p of i){if(h<=0)break;const b=n[p.id]||0,C=Math.min(Math.max(b,0),h);C>0&&(l.push({walletId:p.id,walletName:p.name,currentBalance:b,deductedAmount:C,newBalance:b-C}),h-=C)}return l}}let hn=null;function Ew(){const s=window;if(!hn){const e=s.AudioContext||s.webkitAudioContext;hn=new e}return hn.state==="suspended"&&hn.resume(),hn}function Rw(s,e,n){const i=n/1e3,l=Math.floor(s.sampleRate*i),h=s.createBuffer(1,l,s.sampleRate),p=h.getChannelData(0);for(let D=0;D<l;D++)p[D]=(Math.random()*2-1)*.6;const b=s.createBufferSource();b.buffer=h;const C=s.createBiquadFilter();C.type="highpass",C.frequency.value=1500,C.Q.value=.7;const k=s.createGain();k.gain.setValueAtTime(1e-4,e),k.gain.exponentialRampToValueAtTime(.4,e+.015),k.gain.exponentialRampToValueAtTime(1e-4,e+i),b.connect(C),C.connect(k),k.connect(s.destination),b.start(e),b.stop(e+i+.01)}function Lw(s,e,n,i,l,h="triangle"){const p=s.createOscillator(),b=s.createGain();p.type=h;const C=l/1e3;p.frequency.setValueAtTime(n,e),p.frequency.linearRampToValueAtTime(i,e+C),b.gain.setValueAtTime(1e-4,e),b.gain.exponentialRampToValueAtTime(.25,e+.02),b.gain.exponentialRampToValueAtTime(1e-4,e+C),p.connect(b),b.connect(s.destination),p.start(e),p.stop(e+C+.02)}function Ww(){try{const s=Ew(),e=s.currentTime;Rw(s,e,90),Lw(s,e+.12,1900,1100,180,"sawtooth")}catch{}}function Fw(s){if(!s)return!1;const n=s.replace(/[^0-9Ù -Ù©]/g,"").replace(/[Ù -Ù©]/g,i=>"0123456789"["Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©".indexOf(i)]);return/^(010|011|012|015)[0-9]{8}$/.test(n)}const Bw=({isOpen:s,onClose:e,senderPhone:n,receiverPhone:i,amount:l,deviceId:h,api:p})=>{const{toast:b}=Hi(),[C,k]=u.useState(1),[D,T]=u.useState(!1),[E,M]=u.useState("");u.useEffect(()=>{s&&(k(1),M(""))},[s]);const $=async se=>{try{return p&&typeof p.enterPin=="function"?(await p.enterPin(h,se),!0):!1}catch(_e){return console.error("ADB error:",_e),b({title:"Ø®Ø·Ø£ ADB",description:_e.message||"ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„",variant:"destructive"}),!1}},y=async()=>{if(!E){b({title:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}T(!0);const se=await $(E);T(!1),se&&k(2)},W=async()=>{T(!0);const se=await $(String(l));T(!1),se&&k(3)},ie=async()=>{T(!0);const se=await $(i);T(!1),se&&k(4)},J=async()=>{T(!0);const se=await $(i);T(!1),se&&k(5)},V=async()=>{T(!0);const se=await $("1");T(!1),se&&(b({title:"ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­",description:"ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©"}),e())};return t.jsx(ue,{open:s,onOpenChange:se=>!se&&e(),children:t.jsxs(me,{className:"sm:max-w-[400px]",children:[t.jsxs(ye,{children:[t.jsx(he,{children:"ØªØ­ÙˆÙŠÙ„ Ø§ØªØµØ§Ù„Ø§Øª ÙƒØ§Ø´ (USSD)"}),t.jsxs(et,{children:[C===1&&"Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©",C===2&&"Ø§Ù„Ø®Ø·ÙˆØ© 2: ØªØ£ÙƒÙŠØ¯ Ù…Ø¨Ù„Øº Ø§Ù„ØªØ­ÙˆÙŠÙ„",C===3&&"Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",C===4&&"Ø§Ù„Ø®Ø·ÙˆØ© 4: ØªØ£ÙƒÙŠØ¯ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",C===5&&"Ø§Ù„Ø®Ø·ÙˆØ© 5: ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©"]})]}),t.jsxs("div",{className:"py-4 space-y-4",children:[C===1&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ (PIN)"}),t.jsx(Z,{type:"password",value:E,onChange:se=>M(se.target.value),placeholder:"****",autoFocus:!0,className:"text-center text-lg tracking-widest",maxLength:6,onKeyDown:se=>{se.key==="Enter"&&E&&y()}})]}),C===2&&t.jsxs("div",{className:"text-center bg-gray-50 dark:bg-slate-800 p-4 rounded-lg",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¨Ù„Øº:"}),t.jsx("p",{className:"text-2xl font-bold font-mono tracking-wider",children:l})]}),C===3&&t.jsxs("div",{className:"text-center bg-gray-50 dark:bg-slate-800 p-4 rounded-lg",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„:"}),t.jsx("p",{className:"text-2xl font-bold font-mono tracking-wider",children:i})]}),C===4&&t.jsxs("div",{className:"text-center bg-gray-50 dark:bg-slate-800 p-4 rounded-lg",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù‚Ù… Ù…Ø±Ø© Ø£Ø®Ø±Ù‰:"}),t.jsx("p",{className:"text-2xl font-bold font-mono tracking-wider",children:i})]}),C===5&&t.jsxs("div",{className:"text-center bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-100 dark:border-green-900",children:[t.jsx("p",{className:"text-lg font-bold text-green-700 dark:text-green-400 mb-2",children:"Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ£ÙƒÙŠØ¯"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù‚Ù… 1 Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„"})]})]}),t.jsxs(We,{children:[C===1&&t.jsx(I,{onClick:y,disabled:D||!E,className:"w-full bg-black hover:bg-neutral-800 text-white",children:D?t.jsx(rs,{className:"animate-spin h-4 w-4 mr-2"}):"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ"}),C===2&&t.jsx(I,{onClick:W,disabled:D,className:"w-full bg-black hover:bg-neutral-800 text-white",children:D?t.jsx(rs,{className:"animate-spin h-4 w-4 mr-2"}):"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¨Ù„Øº"}),C===3&&t.jsx(I,{onClick:ie,disabled:D,className:"w-full bg-black hover:bg-neutral-800 text-white",children:D?t.jsx(rs,{className:"animate-spin h-4 w-4 mr-2"}):"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù‚Ù…"}),C===4&&t.jsx(I,{onClick:J,disabled:D,className:"w-full bg-black hover:bg-neutral-800 text-white",children:D?t.jsx(rs,{className:"animate-spin h-4 w-4 mr-2"}):"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù‚Ù…"}),C===5&&t.jsx(I,{onClick:V,disabled:D,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:D?t.jsx(rs,{className:"animate-spin h-4 w-4 mr-2"}):"ØªØ£ÙƒÙŠØ¯ (1)"})]})]})})},$w=K.lazy(()=>ne(()=>import("./index-CgV0sHeM.js").then(s=>s.cV),__vite__mapDeps([0,1]),import.meta.url).then(s=>({default:s.BranchRequestDialog}))),Uw=K.lazy(()=>ne(()=>import("./WalletManagement-Jf_BAba-.js"),__vite__mapDeps([2,0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url)),Vw=K.lazy(()=>ne(()=>import("./TransactionDetailsModal-BF2_poqo.js"),__vite__mapDeps([17,0,1,18,3,13,10,19,15,16]),import.meta.url)),qw=K.lazy(()=>ne(()=>import("./ReceiptModal-VfKDuN84.js"),__vite__mapDeps([20,0,1,18,3,9,21,16,19,22]),import.meta.url)),Um=K.lazy(()=>ne(()=>import("./EditBalanceDialog-D7bP2BFo.js"),__vite__mapDeps([23,0,1,13]),import.meta.url).then(s=>({default:s.EditBalanceDialog}))),Yw=K.lazy(()=>ne(()=>import("./ChangePinDialog-B49Baih-.js"),__vite__mapDeps([24,0,1]),import.meta.url).then(s=>({default:s.ChangePinDialog}))),zw=K.lazy(()=>ne(()=>import("./ChangeCashPinDialog-D7JhkTBN.js"),__vite__mapDeps([25,0,1,13]),import.meta.url).then(s=>({default:s.ChangeCashPinDialog}))),Kw=K.lazy(()=>ne(()=>import("./ChangeWalletTotalPinDialog-BGVtWOwo.js"),__vite__mapDeps([26,0,1,4]),import.meta.url).then(s=>({default:s.ChangeWalletTotalPinDialog}))),Jw=K.lazy(()=>ne(()=>import("./index-CgV0sHeM.js").then(s=>s.cT),__vite__mapDeps([0,1]),import.meta.url)),ea=K.lazy(()=>ne(()=>import("./index-CgV0sHeM.js").then(s=>s.cU),__vite__mapDeps([0,1]),import.meta.url)),Hw=K.lazy(()=>ne(()=>import("./AddToWalletDialog-U15fsOOe.js"),__vite__mapDeps([27,0,1]),import.meta.url).then(s=>({default:s.AddToWalletDialog}))),Qw=K.lazy(()=>ne(()=>import("./CalculatorDialog-Ct_uazvC.js"),__vite__mapDeps([28,0,1,18,3]),import.meta.url).then(s=>({default:s.CalculatorDialog}))),Gw=K.lazy(()=>ne(()=>import("./SalesDataDialog-qajE2To7.js"),__vite__mapDeps([29,0,1,30,31,32,33,9,3,34,35,11,13,10,36,19,37,7,12,15,18,38,39,6,16,40,41,42,43,44,45,46,4,5]),import.meta.url).then(s=>({default:s.SalesDataDialog}))),Xw=K.lazy(()=>ne(()=>import("./CashSummaryDialog-C_k_cUDk.js"),__vite__mapDeps([47,0,1,13,18,3,48,35,38,39,6,15,16,36,40,7,31,32,33,41,42,43,44,45,10,46,4,19,5]),import.meta.url).then(s=>({default:s.CashSummaryDialog}))),Zw=K.lazy(()=>ne(()=>import("./CreditCardsDialog-HYhlYCyp.js"),__vite__mapDeps([49,0,1,16,37,10,13]),import.meta.url)),eN=K.lazy(()=>ne(()=>import("./InstallmentModal-CNygnL1g.js"),__vite__mapDeps([50,0,1,35,18,3,10]),import.meta.url)),tN=K.lazy(()=>ne(()=>import("./SimCardsDialog-Ca3l7QZk.js"),__vite__mapDeps([51,0,1,34,30,3,15,18,31,32,52,36]),import.meta.url).then(s=>({default:s.SimCardsDialog}))),aN=K.lazy(()=>ne(()=>import("./AdslCardsDialog-BRMgPD80.js"),__vite__mapDeps([53,0,1,30,52,18,3,31,32,36]),import.meta.url).then(s=>({default:s.AdslCardsDialog}))),sN=K.lazy(()=>ne(()=>import("./MaintenanceDialog-DP7Ch7_c.js"),__vite__mapDeps([54,0,1,9,35,45,16]),import.meta.url).then(s=>({default:s.default}))),rN=K.lazy(()=>ne(()=>import("./MachineDailyDialog-bYSTPv0Q.js"),__vite__mapDeps([55,0,1,9,34,3,35,10]),import.meta.url)),nN=K.lazy(()=>ne(()=>import("./WalletsManagement-DwgeheI5.js"),__vite__mapDeps([56,0,1,8,3,57,21,19,4,7,36,22,6]),import.meta.url).then(s=>({default:s.WalletsManagement}))),iN=K.lazy(()=>ne(()=>import("./WalletsListDialog-Q840NGnL.js"),__vite__mapDeps([58,0,1,4,59]),import.meta.url).then(s=>({default:s.WalletsListDialog}))),Vm=K.lazy(()=>ne(()=>import("./WalletPrinterDialog-D0giMR7D.js"),__vite__mapDeps([57,0,1,21,19,4,7,36,22]),import.meta.url)),oN=K.lazy(()=>ne(()=>import("./PendingOperationsDialog-D8YM2DQ6.js"),__vite__mapDeps([60,0,1]),import.meta.url).then(s=>({default:s.PendingOperationsDialog}))),lN=K.lazy(()=>ne(()=>import("./DailyArchiveHistoryDialog-CixX5AvI.js"),__vite__mapDeps([61,0,1]),import.meta.url).then(s=>({default:s.DailyArchiveHistoryDialog}))),cN=K.lazy(()=>ne(()=>import("./CashierShiftModal-DPV2__M_.js"),__vite__mapDeps([62,0,1,3,35,63]),import.meta.url)),dN=K.lazy(()=>ne(()=>import("./ShiftProfileDialog-BD7YmYPO.js"),__vite__mapDeps([64,0,1]),import.meta.url)),uN=K.lazy(()=>ne(()=>import("./ChangeLogDialog-BLh_ksJO.js"),__vite__mapDeps([65,0,1,66]),import.meta.url));function mN({userId:s}){const[e,n]=K.useState(null),[i,l]=K.useState("");return null}const nc=s=>{try{const e=String(s||"").replace(/[^0-9+]/g,"");if(!e)return"";if(e.startsWith("+20")){const n=e.slice(3);return n.startsWith("1")?"0"+n:n}if(e.startsWith("0020")){const n=e.slice(4);return n.startsWith("1")?"0"+n:n}if(e.startsWith("20")){const n=e.slice(2);return n.startsWith("1")?"0"+n:n}return e.startsWith("0")?e:/^(10|11|12|15)/.test(e)?"0"+e:e}catch{return""}},hN=()=>{var Zu,em,tm,am,sm,rm,nm,im,om;console.log("ðŸ”¥ UserDashboardPage component is loading...");const{signOut:s,user:e,profile:n,userData:i}=hc(),l=((e==null?void 0:e.email)||"").toLowerCase()==="vodafonecash00@gmail.com",h=Km(),p=vp(),b=wp(),{isShiftActive:C,shiftUser:k}=Np(),{shopId:D,shopName:T}=Hm(),E=jp(),M=Sp(),$=((Zu=nr)==null?void 0:Zu.isNativePlatform)&&nr.getPlatform()==="android",{toast:y}=Hi(),[W,ie]=u.useState(!1),[J,V]=u.useState(""),[se,_e]=u.useState("");u.useEffect(()=>{const a=()=>{try{const o=(e==null?void 0:e.uid)||"default",c=localStorage.getItem(`sim1Number_${o}`)??localStorage.getItem("sim1Number")??"",d=localStorage.getItem(`sim2Number_${o}`)??localStorage.getItem("sim2Number")??"";V(c),_e(d)}catch{}};a();const r=o=>{o.detail?(V(o.detail.sim1||""),_e(o.detail.sim2||"")):a()};return window.addEventListener("simNumbersChanged",r),window.addEventListener("storage",a),()=>{window.removeEventListener("simNumbersChanged",r),window.removeEventListener("storage",a)}},[e==null?void 0:e.uid]);const[Ne,Ce]=u.useState(!1),[xe,oe]=u.useState(""),[Fe,ze]=u.useState(""),Be=(a,r)=>{oe(a),ze(r),Ce(!0)};u.useEffect(()=>{if(e&&i){const a=i.isActive,r=mm(i.subscription),o=i.isOnFreeTrial||!1,c=i.hasSeenWelcomeModal===!0;if(a&&(r||o)&&!c){const d=setTimeout(()=>{ie(!0)},1500);return()=>clearTimeout(d)}}},[e,i]);const vt=async()=>{if(ie(!1),e!=null&&e.uid)try{await Zt(Ae(F,"users",e.uid),{hasSeenWelcomeModal:!0})}catch(a){console.error("Failed to update welcome modal status",a)}},$t=u.useRef(null),[$e,Ke]=u.useState(0),[ee,Q]=u.useState(!1),[Mt,dt]=u.useState(!1),[pt,Y]=u.useState(!1),[le,re]=u.useState(!1),[Te,be]=u.useState(0);u.useEffect(()=>{if(!(e!=null&&e.uid))return;const a=Ie(ce(F,"pendingOperations"),q("userId","==",e.uid),q("status","==","pending")),r=an(a,o=>{be(o.size)});return()=>r()},[e==null?void 0:e.uid]);const ke=(a,r)=>{if(C&&(k!=null&&k.permissions)&&k.permissions[a]===!1){dt(!0);return}r()},tt=()=>{const a=(i==null?void 0:i.simSubscription)||(e==null?void 0:e.simSubscription);let r=!1;a!=null&&a.active&&(a!=null&&a.endsAt)&&(a.endsAt.seconds?new Date(a.endsAt.seconds*1e3):new Date(a.endsAt))>new Date&&(r=!0),r?Jn(!0):na(!0)},[Ot,ba]=u.useState(!1),[Aa,na]=u.useState(!1),[Nn,Ds]=u.useState(!1),[ks,hr]=u.useState(!1),[jn,Zi]=u.useState(!1),[Ac,eo]=u.useState(!1),Sn=u.useRef(!1),[X,Cs]=u.useState(()=>{try{const a=Object.keys(localStorage).find(o=>o.startsWith("wallets_")),r=a?localStorage.getItem(a):null;if(r){const o=JSON.parse(r);if(Array.isArray(o))return o}}catch{}return[]}),[Is,to]=u.useState([]);u.useEffect(()=>{var a;(a=h.state)!=null&&a.openProfileSettings&&(Q(!0),window.history.replaceState({},document.title))},[h.state]),u.useEffect(()=>{if(e!=null&&e.uid){const a=`linesPinEnabled_${e.uid}`;if((localStorage.getItem(a)??localStorage.getItem("linesPinEnabled"))==="true"&&hr(!0),i&&i.linesPinEnabled!==void 0){const o=i.linesPinEnabled;hr(o),localStorage.setItem(a,o?"true":"false")}}},[e==null?void 0:e.uid,i]);const zh=async()=>{var o,c,d;const a="alkaptin678678@gmail.com",r=(c=(o=rr.currentUser)==null?void 0:o.email)==null?void 0:c.toLowerCase();if(!r||r!==a){y({title:"Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹."});return}if(!fi||!gi||!pi){y({title:"Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©",description:"Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ØŒ Ø§Ù„Ø´Ø±ÙƒØ© ÙˆØ§Ù„Ù…Ø¨Ù„Øº",variant:"destructive"});return}try{Su(!0);const m=await((d=rr.currentUser)==null?void 0:d.getIdToken()),f=await fetch("/api/topup",{method:"POST",headers:{"Content-Type":"application/json",...m?{Authorization:`Bearer ${m}`}:{}},body:JSON.stringify({phone:fi,countryCode:"EG",operator:gi,amount:Number(pi),useLocalAmount:!0})}),g=await f.json().catch(()=>({}));f.ok&&(g!=null&&g.success)?(y({title:"ØªÙ… Ø§Ù„Ø´Ø­Ù†",description:(g==null?void 0:g.message)||"ØªÙ… ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø­Ù† Ø¨Ù†Ø¬Ø§Ø­"}),Nl(!1),vu(""),wu(""),Nu("")):y({title:"ÙØ´Ù„ Ø§Ù„Ø´Ø­Ù†",description:(g==null?void 0:g.message)||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø­Ù†",variant:"destructive"})}catch(m){console.error("Topup request error:",m),y({title:"Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹",description:"ØªØ¹Ø°Ù‘Ø± ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø­Ù†. Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹.",variant:"destructive"})}finally{Su(!1)}};(()=>{try{return!!window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron")||typeof window<"u"&&window.location&&window.location.protocol==="file:"}catch{return!1}})();const[Kh,Dn]=u.useState(!1),[Jh,Hh]=u.useState(!1),[Qh,Gh]=u.useState(!1),[Xh,ao]=u.useState(!1),[fr,gr]=u.useState(!1),[Zh,pr]=u.useState(!1),[xr,so]=u.useState([]),[Tc,ro]=u.useState(""),[Pc,no]=u.useState(""),[Mc,io]=u.useState(""),[Oc,oo]=u.useState(""),[lo,kn]=u.useState(!1),[e0,co]=u.useState(!1),[t0,fN]=u.useState(null),[Ec,Rc]=u.useState(""),[Lc,Wc]=u.useState(""),[a0,Fc]=u.useState(!1),[s0,Cn]=u.useState(!1),[r0,Bc]=u.useState(!1),[Et,n0]=u.useState(null),[_s,$c]=u.useState(!1),[Uc,i0]=u.useState(!1),[xt,o0]=u.useState(null);u.useEffect(()=>{Dp().then(o0).catch(()=>{})},[]);const[Vc,l0]=u.useState(void 0);u.useEffect(()=>{try{const a=window.electronAPI;a&&typeof a.appVersion=="function"&&a.appVersion().then(r=>{typeof r=="string"&&!r.startsWith("err:")&&l0(r)}).catch(()=>{})}catch{}},[]);const qc=(()=>{var o,c;const a=(c=(o=import.meta)==null?void 0:o.env)==null?void 0:c.VITE_APP_VERSION,r=typeof window<"u"&&(window.electronAPI||window.location.protocol==="file:"||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"));if(r&&(n!=null&&n.desktopInstalledVersion))return n==null?void 0:n.desktopInstalledVersion;if(r&&Vc)return Vc;if(a)return a;if(!(!xt&&!n))return M?(n==null?void 0:n.androidInstalledVersion)||(n==null?void 0:n.lastAckAndroidVersion)||(xt==null?void 0:xt.androidVersion)||(xt==null?void 0:xt.pcVersion):(xt==null?void 0:xt.pcVersion)||(xt==null?void 0:xt.androidVersion)})();u.useEffect(()=>{fr&&(e!=null&&e.uid)&&!Uc&&(async()=>{kn(!0);try{let r=[],o=[];try{const f=ce(F,"users",e.uid,"branches");r=(await ve(f)).docs.map(w=>({id:w.id,...w.data(),source:"sub"}))}catch(f){console.warn("Failed to fetch subcollection branches:",f)}try{const f=Ie(ce(F,"branches"),q("ownerId","==",e.uid));o=(await ve(f)).docs.map(w=>({id:w.id,...w.data(),source:"root"}))}catch(f){console.warn("Failed to fetch root branches:",f)}const c=[...r,...o],d=new Map;c.forEach(f=>{const g=f.branchUserId||f.id;(!d.has(g)||f.source==="sub")&&d.set(g,f)});const m=Array.from(d.values());console.log("Loaded branches:",m),so(m),i0(!0)}catch(r){console.error("Error in branch loading process:",r),y({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©",variant:"destructive"})}finally{kn(!1)}})()},[fr,e==null?void 0:e.uid,Uc]),u.useEffect(()=>{fr||$c(!1)},[fr]);const[c0,In]=u.useState(!1),[Yc,zc]=u.useState(!1),[As,d0]=u.useState(null),[_n,Kc]=u.useState(""),[An,Jc]=u.useState(""),[u0,m0]=u.useState(""),[Hc,Qc]=u.useState(!1),h0=a=>{d0(a),Kc(a.branchName||""),Jc(a.managerName||""),m0(a.loginUsername||a.email||a.username||""),In(!0)},f0=async()=>{if(!(!As||!_n||!An)){Qc(!0);try{const a={branchName:_n,managerName:An,updatedAt:new Date};if(As.branchUserId)try{await sa(Ae(F,"users",(e==null?void 0:e.uid)||"","branches",String(As.branchUserId)),a,{merge:!0});try{await Zt(Ae(F,"users",As.branchUserId),{displayName:_n,managerName:An})}catch(r){console.warn("Could not update branch root user doc",r)}}catch(r){console.warn("Sub branch update failed:",r)}try{await Zt(Ae(F,"branches",As.id),a)}catch{}so(r=>r.map(o=>o.id===As.id?{...o,...a}:o)),y({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ Ø¨Ù†Ø¬Ø§Ø­"}),In(!1)}catch(a){console.error("Error updating branch:",a),y({title:"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",description:a.message,variant:"destructive"})}finally{Qc(!1)}}},g0=async a=>{if(!(a!=null&&a.branchUserId)){y({title:"Ø®Ø·Ø£",description:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",variant:"destructive"});return}Bc(!0),Cn(!0);try{const r=a.branchUserId;if(e!=null&&e.uid&&a.branchUserId&&a.source!=="sub")try{await sa(Ae(F,"users",e.uid,"branches",a.branchUserId),{branchUserId:a.branchUserId,branchName:a.branchName||"Unknown Branch",managerName:a.managerName||"",active:!0,lastSynced:gt()},{merge:!0}),console.log("âœ… Branch link synced successfully"),await new Promise(Oe=>setTimeout(Oe,500))}catch(Oe){console.error("âŒ Failed to sync branch link:",Oe)}const[o,c,d,m]=await Promise.all([fa(Ae(F,"users",r)),(async()=>{try{const Oe=Ie(ce(F,"merchantWallets"),q("merchantUserId","==",r)),pe=await ve(Oe);if(!pe.empty)return pe;const nt=await ve(ce(F,"users",r,"wallets"));return nt.empty?await ve(Ie(ce(F,"wallets"),q("userId","==",r))):nt}catch(Oe){console.error("Error fetching wallets",Oe);try{return await ve(Ie(ce(F,"wallets"),q("userId","==",r)))}catch{return{docs:[]}}}})(),(async()=>{try{return await ve(Ie(ce(F,"debts"),q("userId","==",r)))}catch{return await ve(ce(F,"users",r,"debts"))}})(),(async()=>{try{const Oe=Ie(ce(F,"dailySales"),q("userId","==",r)),pe=await ve(Oe);return pe.empty?await ve(ce(F,"users",r,"dailySales")):pe}catch(Oe){return console.error("Error fetching sales",Oe),await ve(ce(F,"users",r,"dailySales"))}})()]),f=o.exists()?o.data():{},g=Number(f.cashBalance||0),w=f.reportsData||{},N=Number(w.dailyProfit||0),x=Number(w.monthlyProfit||0),v=f.walletBalances||{},j=c.docs.filter(Oe=>Oe.data().isActive===!0),S=new Set(j.map(Oe=>Oe.id));let _=0;S.size>0&&(_=Object.entries(v).filter(([Oe])=>S.has(Oe)).reduce((Oe,[pe,nt])=>Oe+Number(nt||0),0)),_===0&&j.length>0&&(_=j.reduce((Oe,pe)=>Oe+Number(pe.data().balance||pe.data().amount||0),0));let O=0;d.forEach(Oe=>{const pe=Oe.data();if(pe.type!=="debtor"){const nt=Number(pe.paidAmount||0),ft=Math.max(0,Number(pe.amount||0)-nt);O+=ft}});const P=new Date().toISOString().split("T")[0],U=P.slice(0,7);let te=0,H=0,De=N,Je=x,rt=0;console.log(`Branch Details - UID: ${r}, Wallets: ${c.size}, Sales: ${m.size}, ReportsDaily: ${N}`),m.forEach(Oe=>{const pe=Oe.data(),nt=String(pe.date||""),ft=Number(pe.sellingPrice||0)*Number(pe.quantity||1),ct=Number(pe.profit||0);rt+=ft,nt===P&&(te+=ft,De+=ct),nt.startsWith(U)&&(H+=ft,Je+=ct)}),n0({branchName:a.branchName,managerName:a.managerName,todaySales:te,monthSales:H,todayProfit:De,monthProfit:Je,walletsTotal:_,cashBalance:g,totalSalesSection:rt,debtsTotal:O})}catch(r){console.error("Error fetching branch details:",r),y({title:"ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹",description:r.message,variant:"destructive"}),Cn(!1)}finally{Bc(!1)}},[L,yr]=u.useState("");u.useEffect(()=>{const a=b==null?void 0:b.shopId;if(a&&(e!=null&&e.uid))try{const r=`selectedShopId_${e.uid}`;localStorage.setItem(r,String(a)),window.dispatchEvent(new Event("selectedShopIdChanged"))}catch{}},[b==null?void 0:b.shopId,e==null?void 0:e.uid]);const[uo,p0]=u.useState([]),[os,ls]=u.useState(()=>{try{return localStorage.getItem("cashySelectedDevice")||null}catch{return null}});u.useEffect(()=>{},[]),u.useEffect(()=>{(async()=>{if(L)try{await sn.set({key:"selected_wallet_id",value:L}),console.log("ðŸ“± Synced selected_wallet_id to Native:",L)}catch(r){console.error("Failed to sync wallet to native:",r)}else await sn.remove({key:"selected_wallet_id"})})()},[L]),u.useEffect(()=>{(async()=>{if(D)try{await sn.set({key:"shopId",value:D}),console.log("ðŸ“± Synced shopId to Native:",D)}catch(r){console.error("Failed to sync shopId to native:",r)}})()},[D]);const mo=a=>!!(a&&uo.some(r=>r.id===a));async function ho(){const a=window.electronAPI,r=os||"";if(!a||typeof a.sendUssd!="function")return null;if(!r)return y({title:"Ø§Ù„Ø¬Ù‡Ø§Ø² ØºÙŠØ± Ù…Ø­Ø¯Ø¯",description:"Ø§ØªØµÙ„ Ø¨Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù‡Ø§Ø² Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©",variant:"destructive"}),null;if(mo(r))return r;try{const m=uo.find(f=>f&&f.id&&!String(f.id).includes(":"));if(m&&m.id)return ls(m.id),m.id}catch{}const o=r.includes(":")?r.split(":").slice(0,2).join(":"):"";if(o&&typeof a.connectWifi=="function"){try{const m=await a.connectWifi(o);if(typeof m=="string"&&(m.includes("âœ…")||m.toLowerCase().includes("connected")))return r}catch{}if(typeof a.refreshAdbDevices=="function")try{await a.refreshAdbDevices()}catch{}await new Promise(m=>setTimeout(m,250))}const c=r.split(":")[0],d=uo.find(m=>(m.id.startsWith(c)||m.id.includes(c))&&m.id.includes(":"));if(d!=null&&d.id){const m=d.id.split(":").slice(0,2).join(":");if(!mo(d.id)&&typeof a.connectWifi=="function"){try{const f=await a.connectWifi(m);if(typeof f=="string"&&(f.includes("âœ…")||f.toLowerCase().includes("connected")))return ls(d.id),d.id}catch{}await new Promise(f=>setTimeout(f,250))}if(mo(d.id))return ls(d.id),d.id}return r&&o?r:(y({title:"Ø§Ù„Ø¬Ù‡Ø§Ø² ØºÙŠØ± Ù…ØªØµÙ„",description:"ÙØ¹Ù‘Ù„ Wireless debugging Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø§ØªØµØ§Ù„ Wiâ€‘Fi Ø«Ù… Ø£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©",variant:"destructive"}),null)}u.useEffect(()=>{const a=window.electronAPI;a&&typeof a.onAdbDevices=="function"&&a.onAdbDevices(r=>{var m;const o=Array.isArray(r)?r:[];p0(o);const c=(()=>{try{return localStorage.getItem("cashySelectedDevice")||""}catch{return""}})();if(c&&o.some(f=>f.id===c))ls(c);else{const f=c?String(c).split(":")[0]:"",g=f?o.find(w=>(w.id.startsWith(f)||w.id.includes(f))&&String(w.type||"").toLowerCase().includes("wifi")):void 0;g!=null&&g.id?ls(g.id):!c&&((m=o[0])!=null&&m.id)?ls(w=>w||o[0].id):o.length||ls(null)}})},[]);function x0(a,r){try{const o=ot==null?void 0:ot(),c=(o==null?void 0:o.phone)||"";if(!c){y({title:"ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø©",description:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…ÙØ±Ø³Ù„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}if(M&&c.startsWith("011")){Ql("*777*1#"),y({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… Ø·Ù„Ø¨ ÙƒÙˆØ¯ Ø§ØªØµØ§Ù„Ø§Øª *777*1#"}),da(!1),Ma(!1);return}$p(c,a,r),y({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ"}),da(!1),Ma(!1)}catch(o){const c=(o==null?void 0:o.message)||"ØªØ¹Ø°Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ â€” ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";throw y({title:"ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:c,variant:"destructive"}),o}}const[Ut,fo]=u.useState(null),y0=async()=>{var f;if(!ht||!ht.receiver||!ht.amount){y({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",variant:"destructive"});return}const a=String(ht.receiver),r=Math.round(Number(ht.amount));ua(!0);const o=ot==null?void 0:ot(),c=(o==null?void 0:o.phone)||"",d=Bp(c),m=window.electronAPI;if(d==="etisalat"&&c.startsWith("011")&&m&&typeof m.sendUssd=="function"&&os){try{const g=await ho();if(!g){ua(!1);return}let w=g;Ut!==null&&(w=`${g}:sim${Ut}`),Jo(w),await m.sendUssd(w,"*777*1#"),Wd(!0),da(!1)}catch(g){console.error("Etisalat flow init error",g),y({title:"Ø®Ø·Ø£",description:"ÙØ´Ù„ Ø¨Ø¯Ø¡ ØªØ­ÙˆÙŠÙ„ Ø§ØªØµØ§Ù„Ø§Øª: "+(g.message||""),variant:"destructive"})}finally{ua(!1)}return}if(d==="orange"&&c.startsWith("012")&&m&&typeof m.sendUssd=="function"&&os){try{const g=await ho();if(!g){ua(!1);return}const w=`*7115*7*${a}*${r}#`;let N=g;Ut!==null&&(N=`${g}:sim${Ut}`),Jo(N),await m.sendUssd(N,w),Ma(!0),da(!1)}catch(g){console.error("Orange flow init error",g),y({title:"Ø®Ø·Ø£",description:"ÙØ´Ù„ Ø¨Ø¯Ø¡ ØªØ­ÙˆÙŠÙ„ Ø£ÙˆØ±Ù†Ø¬: "+(g.message||""),variant:"destructive"})}finally{ua(!1)}return}try{if((f=nr)!=null&&f.isNativePlatform&&nr.getPlatform()==="android"){const w=ot==null?void 0:ot(),N=(w==null?void 0:w.phone)||"";if(!N){y({title:"ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø©",description:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…ÙØ±Ø³Ù„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"}),ua(!1);return}if(N.startsWith("011")){Ql("*777*1#",Ut===0?"sim1":Ut===1?"sim2":void 0),y({title:"ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„",description:"ØªÙ… Ø·Ù„Ø¨ ÙƒÙˆØ¯ Ø§ØªØµØ§Ù„Ø§Øª *777*1#"}),da(!1),Ma(!1);return}const x=ym(N,a,r);if(!x){y({title:"Ø±Ù‚Ù… ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø±Ù‚Ù… 010/011/012/015",variant:"destructive"}),ua(!1);return}Ql(x,Ut===0?"sim1":Ut===1?"sim2":void 0),y({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ"}),da(!1),Ma(!1);return}const g=window.electronAPI;if(g&&typeof g.sendUssd=="function"&&os){const w=ot==null?void 0:ot(),N=(w==null?void 0:w.phone)||"";if(!N){y({title:"ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø©",description:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…ÙØ±Ø³Ù„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"}),ua(!1);return}const x=await ho();if(!x){ua(!1);return}const v=ym(N,a,r);if(!v){y({title:"Ø±Ù‚Ù… ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø±Ù‚Ù… 010/011/012/015",variant:"destructive"}),ua(!1);return}try{let j="";if(Ut!==null)j=`${x}:sim${Ut}`;else{const S=typeof g.pickSimAutomatically=="function"?await g.pickSimAutomatically(x,N):{deviceId:x,slot:0};j=`${S.deviceId}:sim${S.slot}`}Jo(j),await g.sendUssd(j,v)}catch{try{await g.sendUssd(x,v)}catch(S){const _=x.includes(":")?x.split(":").slice(0,2).join(":"):"";if(_&&typeof g.connectWifi=="function")await g.connectWifi(_),await g.sendUssd(x,v);else throw S}}if(y({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ° Ø¨Ù†Ø¬Ø§Ø­"}),da(!1),Ld(void 0),g&&typeof g.getRecipientName=="function"&&x){Rd(!0);try{const j=await g.getRecipientName(x);j&&typeof j=="string"&&Ld(j)}catch(j){console.error("Name fetch error",j)}finally{Rd(!1)}}Ma(!0)}else x0(a,r)}catch(g){const w=g&&g.message?g.message:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„";y({title:"Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:`Ø§Ù„Ø¬Ù‡Ø§Ø²: ${Ko||os||"ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"} â€” ${w}`,variant:"destructive"})}finally{ua(!1)}},b0=async(a,r)=>{const o=window.electronAPI;try{if(o&&typeof o.enterPin=="function"&&a){await o.enterPin(a,r),Ma(!1),dd(!0);try{const x=await o.getTransactionResult(a);x==="success"?(Ta("success"),Cr(null)):x==="limit_exceeded"?(Ta("limit_exceeded"),Es&&(console.log("â†©ï¸ Reverting transaction due to limit exceeded:",Es),await $l(Es),Cr(null))):x==="no_wallet"&&(Ta("no_wallet"),Es&&(console.log("â†©ï¸ Reverting transaction due to no wallet:",Es),await $l(Es),Cr(null)))}catch(x){console.error("Transaction check error",x)}finally{dd(!1)}return}const c=String((n==null?void 0:n.bridgeLink)||"").trim(),d=String((n==null?void 0:n.bridgeDeviceId)||"").trim()||void 0;if(!c){y({title:"Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙØ¹Ø¯Ù‘",description:"Ø§Ø­ÙØ¸ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø³Ø± Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}const m=String((ht==null?void 0:ht.receiver)||kt||"").replace(/\D/g,""),f=Math.max(1,Math.round(Number((ht==null?void 0:ht.amount)||yt||0))||0),g=String(r||"").replace(/\D/g,""),N=(x=>{let v=(x||"").trim();return v=v.replace(/\/+$/,""),/^https?:\/\//i.test(v)||(v=`https://${v}`),v})(c);Ma(!1)}catch(c){const d=(c==null?void 0:c.message)||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ";y({title:"ÙØ´Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„",description:d,variant:"destructive"})}};console.log("ðŸ”¥ UserDashboardPage - user:",e?"exists":"null");const[br,Ya]=u.useState(!0),[go,vr]=u.useState(!0),[v0,Ts]=u.useState(!1),[w0,wr]=u.useState(!1),[Gc,gN]=u.useState(()=>{try{const a=e!=null&&e.uid?`shopExpensesPinRequired_${e==null?void 0:e.uid}`:"shopExpensesPinRequired";return(localStorage.getItem(a)??localStorage.getItem("shopExpensesPinRequired"))==="true"}catch{return!1}}),[Tn,Xc]=u.useState(""),[po,Zc]=u.useState(""),[xo,ed]=u.useState(""),[Pn,yo]=u.useState([]),[N0,Mn]=u.useState(!1),[St,Nr]=u.useState(null),[Ps,bo]=u.useState(""),[pN,xN]=u.useState(!1),[j0,vo]=u.useState(!1),[S0,za]=u.useState(!1),[D0,jr]=u.useState(!1),[Sr,wo]=u.useState(""),[td,No]=u.useState(""),[ad,Ms]=u.useState([]),[k0,On]=u.useState(!1),[jo,Os]=u.useState({}),[En,Rn]=u.useState(null),[sd,Dr]=u.useState(""),[rd,kr]=u.useState(""),[yN,nd]=u.useState(!1),[bN,id]=u.useState(0),[vN,od]=u.useState(!1),[Rt,ld]=u.useState(null),[Dt,C0]=u.useState(null),[wN,cd]=u.useState(!1),[So,Ta]=u.useState(null),[I0,dd]=u.useState(!1),[Es,Cr]=u.useState(null),[Ht,Rs]=u.useState(""),[kt,Ir]=u.useState(""),[yt,Ls]=u.useState(""),[cs,ud]=u.useState(""),[_r,md]=u.useState(""),[Do,Ws]=u.useState(!1),[ko,Co]=u.useState(""),[_0,ds]=u.useState(""),[hd,fd]=u.useState(""),[Io,A0]=u.useState(""),[la,_o]=u.useState(null),[T0,gd]=u.useState(!1),[P0,pd]=u.useState(!1),[M0,Ln]=u.useState(!1),[O0,Ao]=u.useState(!1),[xd,To]=u.useState(null),[mt,Wn]=u.useState(""),[Ct,Fn]=u.useState(""),[yd,E0]=u.useState(""),[R0,bd]=u.useState(!1),[NN,jN]=u.useState(null),[Po,vd]=u.useState(null),[L0,Mo]=u.useState(!1);u.useEffect(()=>{(async()=>{try{const r=e!=null&&e.uid?`withdrawSenderNameInputEnabled_${e==null?void 0:e.uid}`:"withdrawSenderNameInputEnabled";let o=null;try{o=localStorage.getItem(r)??localStorage.getItem("withdrawSenderNameInputEnabled")}catch{}if(e!=null&&e.uid)try{const c=await ps(()=>ae.getUserData(e.uid)),d=c==null?void 0:c.withdrawSenderNameInputEnabled;if(typeof d=="boolean"){Mo(d);try{localStorage.setItem(r,d?"true":"false")}catch{}return}}catch{}Mo(o==="true")}catch{Mo(!1)}})()},[e==null?void 0:e.uid]),u.useEffect(()=>{try{const a=`clientNumberAssignments_${(e==null?void 0:e.uid)||"default"}`,r=localStorage.getItem(a);if(!r){Os({});return}const o=JSON.parse(r);if(o&&typeof o=="object"){const c={};Object.entries(o).forEach(([d,m])=>{if(typeof m=="string")c[d]={name:m,amount:""};else if(m&&typeof m=="object"){const f=m,g=typeof f.name=="string"?f.name:"",w=typeof f.amount=="string"||typeof f.amount=="number"?String(f.amount):"";(g||w)&&(c[d]={name:g,amount:w})}}),Os(c)}else Os({})}catch{Os({})}},[e==null?void 0:e.uid]);const Ar=a=>{const r="Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©",o="Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹";return(a||"").split("").map(c=>{const d=r.indexOf(c);if(d>-1)return String(d);const m=o.indexOf(c);return m>-1?String(m):c}).join("")},[Ge,W0]=u.useState(!0),wd=K.useMemo(()=>{if((n==null?void 0:n.transferFeesEnabled)!==void 0)return n.transferFeesEnabled;try{const a=e!=null&&e.uid?`transferFeesEnabled_${e.uid}`:"transferFeesEnabled";return(localStorage.getItem(a)??localStorage.getItem("transferFeesEnabled"))!=="false"}catch{return!0}},[n,e==null?void 0:e.uid]),[B,Oo]=u.useState("transfer"),F0=K.useMemo(()=>{const a=Ar(Ht||"").replace(/\D/g,""),r=Ar(kt||"").replace(/\D/g,"");return!wd||B!=="transfer"?!1:a.startsWith("010")&&r.startsWith("010")||a.startsWith("010")&&(r.startsWith("011")||r.startsWith("012")||r.startsWith("015"))||a.startsWith("012")&&r.startsWith("010")||a.startsWith("011")&&r.startsWith("010")||a.startsWith("015")&&r.startsWith("010")},[Ht,kt,wd,B]),[ge,Vt]=u.useState([]),[Qt,Tr]=u.useState("all"),[Ee,qt]=u.useState([]),[Eo,B0]=u.useState(!1),[Ro,$0]=u.useState([]),[Fs,U0]=u.useState(new Date().toISOString().split("T")[0]),[us,Nd]=u.useState("day");u.useEffect(()=>{if(!Eo||!(e!=null&&e.uid))return;(async()=>{try{let r;if(us==="day"){const d=new Date(Fs);d.setHours(0,0,0,0);const m=new Date(Fs);m.setHours(23,59,59,999),r=Ie(ce(F,"debtReceipts"),q("userId","==",e.uid),q("createdAt",">=",d),q("createdAt","<=",m),Oi("createdAt","desc"))}else{const[d,m]=Fs.split("-").map(Number),f=new Date(d,m-1,1),g=new Date(d,m,0,23,59,59,999);r=Ie(ce(F,"debtReceipts"),q("userId","==",e.uid),q("createdAt",">=",f),q("createdAt","<=",g),Oi("createdAt","desc"))}const c=(await ve(r)).docs.map(d=>({id:d.id,...d.data()}));$0(c)}catch(r){console.error("Error fetching debt receipts:",r),y({title:"Ø®Ø·Ø£",description:"ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„ Ø§Ù„Ø³Ø¯Ø§Ø¯",variant:"destructive"})}})()},[Eo,e==null?void 0:e.uid,Fs,us]);const Pa=u.useRef([]),[Lo,Wo]=u.useState(!1),[Ka,V0]=u.useState(""),[Bn,q0]=u.useState("daily"),[Ja,Y0]=u.useState(""),[Bs,Pr]=u.useState(null),[SN,$n]=u.useState(!1),z0=async a=>{if(!a||!(e!=null&&e.uid)){Pr(null);return}$n(!0);try{const r=new Date(`${a}T00:00:00`),o=new Date(`${a}T23:59:59.999`),d=(await ae.getUserTransactionsForDateRange(e.uid,r,o)).filter(x=>{const v=String(x.status||x.status||"completed").toLowerCase();return v==="completed"||v==="confirmed"});let m=0,f=0,g=0,w=0,N=0;d.forEach(x=>{m++,f+=Number(x.amount||0);const v=(x.type||x.txnType||"").toLowerCase(),j=v==="machine_withdrawal"||x.title==="Ø¥ÙŠØµØ§Ù„ Ø³Ø­Ø¨ ÙÙˆØ±ÙŠ";!j&&(v==="withdraw"||v==="withdrawal"||v==="receive")?g+=Number(x.amount||0):!j&&(v==="send"||v==="transfer")&&(w+=Number(x.amount||0)),N+=ga.calculateProfitFromTransaction(x)}),Pr({count:m,totalAmount:f,totalWithdrawn:g,totalSent:w,totalProfit:N})}catch(r){console.error("Error fetching daily report:",r),y({title:"Ø®Ø·Ø£",description:"ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ",variant:"destructive"})}finally{$n(!1)}},K0=async a=>{if(!a||!(e!=null&&e.uid)){Pr(null);return}$n(!0);try{const r=new Date(`${a}-01T00:00:00`),o=new Date(new Date(r.getFullYear(),r.getMonth()+1,0).setHours(23,59,59,999)),d=(await ae.getUserTransactionsForDateRange(e.uid,r,o)).filter(x=>{const v=String(x.status||x.status||"completed").toLowerCase();return v==="completed"||v==="confirmed"});let m=0,f=0,g=0,w=0,N=0;d.forEach(x=>{m++,f+=Number(x.amount||0);const v=(x.type||x.txnType||"").toLowerCase(),j=v==="machine_withdrawal"||x.title==="Ø¥ÙŠØµØ§Ù„ Ø³Ø­Ø¨ ÙÙˆØ±ÙŠ";!j&&(v==="withdraw"||v==="withdrawal"||v==="receive")?g+=Number(x.amount||0):!j&&(v==="send"||v==="transfer")&&(w+=Number(x.amount||0)),N+=ga.calculateProfitFromTransaction(x)}),Pr({count:m,totalAmount:f,totalWithdrawn:g,totalSent:w,totalProfit:N})}catch(r){console.error("Error fetching monthly report:",r),y({title:"Ø®Ø·Ø£",description:"ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ",variant:"destructive"})}finally{$n(!1)}};u.useEffect(()=>{Lo&&(Bn==="daily"&&Ka?z0(Ka):Bn==="monthly"&&Ja?K0(Ja):Pr(null))},[Ka,Ja,Bn,Lo]);const Mr=mn({enabled:!!(e!=null&&e.uid),queryKey:["recentTransactions",e==null?void 0:e.uid,D||"main"],queryFn:async()=>{const{collection:a,query:r,where:o,orderBy:c,limit:d,getDocs:m}=await ne(async()=>{const{collection:A,query:P,where:U,orderBy:te,limit:H,getDocs:De}=await import("./index-CgV0sHeM.js").then(Je=>Je.cP);return{collection:A,query:P,where:U,orderBy:te,limit:H,getDocs:De}},__vite__mapDeps([0,1]),import.meta.url),{db:f}=await ne(async()=>{const{db:A}=await import("./index-CgV0sHeM.js").then(P=>P.cQ);return{db:A}},__vite__mapDeps([0,1]),import.meta.url),g=r(a(f,"userTransactions"),o("userId","==",String((e==null?void 0:e.uid)||"")),c("createdAt","desc"),d(100)),x=(await m(g)).docs.map(A=>{var pe;const P=A.data(),U=(pe=P.createdAt)!=null&&pe.toDate?P.createdAt.toDate():new Date(P.createdAt),te=String(P.transactionType||P.txnType||P.type||"").toLowerCase();let H="send";te==="withdraw"||te==="receive"?H="withdraw":te==="machine_withdrawal"?H="machine_withdrawal":te==="cash_addition"||te==="add"?H="cash_addition":H="send";const De=P.status==="confirmed"?"completed":P.status||"completed",Je=P.senderMsisdn||P.senderPhone||"",rt=P.receiverMsisdn||P.receiverPhone||"",Oe=Number(P.amount??P.transferredAmount??P.withdrawnAmount??0);return{id:A.id,...P,type:H,status:De,senderPhone:Je,receiverPhone:rt,amount:Oe,createdAt:U}}).filter(A=>!((A==null?void 0:A.type)==="report"||String((A==null?void 0:A.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"))),v=new Set((Er||[]).map(A=>String(A.id||A.originalTransactionId||""))),j=x.filter(A=>!v.has(String(A.id||""))),S=A=>{var P;return String(A.transactionId||A.id||A.reference||((P=A.receipt)==null?void 0:P.reference)||`${new Date(A.createdAt).getTime()}`)},_=new Set,O=[];for(const A of j){const P=S(A);_.has(P)||(_.add(P),O.push(A))}return O},staleTime:6e4,gcTime:3e5,refetchOnWindowFocus:!1,refetchOnReconnect:!0});u.useEffect(()=>{const a=()=>{try{Mr.refetch()}catch{}};return window.addEventListener("transaction-created",a),()=>{window.removeEventListener("transaction-created",a)}},[Mr]),u.useEffect(()=>{const a=Mr.data;if(a&&Array.isArray(a)){const r=Pa.current,o=Date.now(),c=r.filter(g=>{const w=a.some(v=>v.id===g.id),N=g.reference?a.some(v=>v.reference===g.reference):!1,x=o-new Date(g.createdAt).getTime()>3e5;return!w&&!N&&!x});Pa.current=c;const d=[...c,...a].sort((g,w)=>new Date(w.createdAt).getTime()-new Date(g.createdAt).getTime()),m=new Set,f=[];for(const g of d)m.has(g.id)||(m.add(g.id),f.push(g));Vt(f)}},[Mr.data]),u.useEffect(()=>{try{if(localStorage.setItem("commissionMode",Ge?"add":"deduct"),e!=null&&e.uid){const a=`commissionMode_${e.uid}`;localStorage.setItem(a,Ge?"add":"deduct")}}catch{}},[Ge,e==null?void 0:e.uid]),u.useEffect(()=>{try{const a=new Set((ge||[]).filter(c=>String((c==null?void 0:c.status)||"")==="completed"&&(c==null?void 0:c.linkedDebtId)).map(c=>String(c.linkedDebtId)));if(a.size===0||Ee.length===0)return;const r=Ee.map(c=>{if(!a.has(String(c.id)))return c;const d=Number(c.amount||0),m=Number(c.paidAmount||0);return m>=d&&c.status!=="paid"?{...c,amount:d,paidAmount:d,status:"paid"}:m>d?{...c,amount:d,paidAmount:d}:c});if(r.some((c,d)=>c!==Ee[d])){qt(r),(async()=>await Ea(r))();try{e!=null&&e.uid&&r.filter((d,m)=>d!==Ee[m]&&d.status==="paid").forEach(d=>{try{const m=Number(d.paidAmount||0),f=m>0?m:Number(d.amount||0);ys.send(e.uid,`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${d.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${f} Ø¬Ù†ÙŠÙ‡`).catch(()=>{})}catch{}})}catch{}}}catch{}},[ge,Ee,e==null?void 0:e.uid]),u.useEffect(()=>{try{const a=e!=null&&e.uid?localStorage.getItem(`commissionMode_${e.uid}`):null,r=localStorage.getItem("commissionMode"),o=localStorage.getItem("commissionMode_default"),c=a??r??o;c&&W0(c==="add")}catch{}},[e==null?void 0:e.uid]);const[Fo,Or]=u.useState(!1),[J0,H0]=u.useState(null),Un=K.useRef(""),jd=K.useRef(0);u.useEffect(()=>{const a=r=>{var c;if(Fo)return;try{const d=document.activeElement;if(d){const m=(c=d.tagName)==null?void 0:c.toLowerCase();if(m==="input"||m==="textarea"||m==="select"||m==="button"||d.isContentEditable===!0)return}}catch{}const o=Date.now();if(r.key==="Enter"){const d=(Un.current||"").trim();if(Un.current="",d){if(d.length<2&&/^\d+$/.test(d))return;H0(d),Or(!0)}return}r.key.length===1&&(o-(jd.current||0)>100&&(Un.current=""),Un.current+=r.key,jd.current=o)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[Fo]);const[Q0,G0]=u.useState(!1),[X0,Bo]=u.useState(!1),[Z0,DN]=u.useState(null);u.useEffect(()=>{if(!Do)return;const a=ot(),r=parseFloat(yt||"0")||0;let o=0;if(B==="transfer"){if((a==null?void 0:a.defaultTransferCommission)!=null){const d=Number(a.defaultTransferCommission)||0;o=Math.round(d*r/1e3*100)/100}else{const d=Ct&&Ct.trim()!==""?parseFloat(Ct):0;o=Math.max(0,d)}const c=r+o;ds((c||0).toString())}else{if((a==null?void 0:a.defaultWithdrawCommission)!=null){const d=Number(a.defaultWithdrawCommission)||0;o=Math.round(d*r/1e3*100)/100}else{const d=mt&&mt.trim()!==""?parseFloat(mt):Math.round(r*.01*100)/100;o=Math.max(0,d)}const c=Ge?r:Math.max(0,Math.round((r-o)*100)/100);ds((c||0).toString())}},[Do,yt,Ct,mt,L,Ge,B]);const ot=()=>{var r,o;let a=X.find(c=>c.id===L);if(!a)try{const c=localStorage.getItem(_u());if(c){const d=JSON.parse(c);if(Array.isArray(d)&&d.length>0){const f=localStorage.getItem(fs())||((r=d.find(g=>g.isDefault))==null?void 0:r.id)||((o=d[0])==null?void 0:o.id);a=d.find(g=>g.id===f)}}}catch{}return a};u.useLayoutEffect(()=>{try{const a=`wallets_${(e==null?void 0:e.uid)||"default"}`;let r=localStorage.getItem(a);if(!r){const o=Object.keys(localStorage).find(c=>c.startsWith("wallets_"));o&&(r=localStorage.getItem(o)||null)}if(r){const o=JSON.parse(r);if(Array.isArray(o)&&o.length>0){Cs(o);const c=localStorage.getItem(fs()),d=c&&o.find(m=>m.id===c)||o.find(m=>m.isDefault)||o[0];d&&(yr(d.id),Rs(d.phone))}}}catch(a){console.error("ØªÙ‡ÙŠØ¦Ø© ÙÙˆØ±ÙŠØ© Ù„Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ ÙØ´Ù„Øª:",a)}},[]),u.useEffect(()=>{console.log("ðŸ” selectedWallet state changed to:",L)},[L]),u.useEffect(()=>{Cu()},[e==null?void 0:e.uid]),u.useEffect(()=>{pg()},[]);const Vn=mn({enabled:!!(e!=null&&e.uid),queryKey:["wallets",e==null?void 0:e.uid],queryFn:async()=>{const{merchantWalletService:a}=await ne(async()=>{const{merchantWalletService:c}=await import("./index-CgV0sHeM.js").then(d=>d.cR);return{merchantWalletService:c}},__vite__mapDeps([0,1]),import.meta.url),r=await a.getByMerchantId(String((e==null?void 0:e.uid)||""));return(Array.isArray(r)?r:[]).filter(c=>c.isActive===!0).map(c=>({id:c.id,name:c.label||"Ù…Ø­ÙØ¸Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",phone:c.msisdn,isDefault:!!c.isDefault,monthlyWithdrawalLimit:c.monthlyWithdrawalLimit??c.withdrawLimit??2e5,monthlyTransferLimit:c.monthlyTransferLimit??c.transferLimit??2e5,defaultTransferCommission:c.defaultTransferCommission!=null?Number(c.defaultTransferCommission):null,defaultWithdrawCommission:c.defaultWithdrawCommission!=null?Number(c.defaultWithdrawCommission):null}))},staleTime:6e4,gcTime:3e5,refetchOnReconnect:!0});u.useEffect(()=>{var r;const a=Vn.data;if(a&&Array.isArray(a)){Cs(a);const o=localStorage.getItem(fs());if(!!!(L&&a.find(d=>d.id===L))){const d=o&&a.find(m=>m.id===o)?o:((r=a[0])==null?void 0:r.id)||"";if(d){yr(d);const m=a.find(f=>f.id===d);Rs(String((m==null?void 0:m.phone)||""))}}}},[Vn.data]),u.useEffect(()=>{const a=r=>{const{cashBalance:o,walletBalances:c,newTransaction:d,limitUpdate:m,delta:f}=r.detail||{};if(f){const{amount:g,type:w,walletId:N,commission:x,totalDeducted:v}=f,j=Number(g||0),S=Number(x||0),_=Number(v||j+S);at(O=>{let A=0;w==="withdraw"?A=-j+S:w==="send"||w==="transfer"?A=j+S:w==="atm_withdraw"&&(A=j);const P=O+A;try{const U=Qe();localStorage.setItem(U,String(P));const te=new Date().toISOString();if(localStorage.setItem(U+"_lastUpdated",te),e!=null&&e.uid){const H=`userData_${e.uid}`,De=localStorage.getItem(H),rt={...De?JSON.parse(De):{},cashBalance:P,lastUpdated:te};localStorage.setItem(H,JSON.stringify(rt)),we(!0)}}catch{}return P}),N&&ut(O=>{const A=Number(O[N]||0);let P=0;w==="withdraw"?P=j:w==="send"||w==="transfer"?P=-j:w==="atm_withdraw"&&(P=-_);const U=A+P,te={...O,[N]:U};try{const H=st();localStorage.setItem(H,JSON.stringify(te));const De=new Date().toISOString();if(localStorage.setItem(H+"_lastUpdated",De),e!=null&&e.uid){const Je=`userData_${e.uid}`,rt=localStorage.getItem(Je),pe={...rt?JSON.parse(rt):{},walletBalances:te,lastUpdated:De};localStorage.setItem(Je,JSON.stringify(pe)),we(!0)}}catch{}return te})}if(typeof o=="number"){at(o);try{const g=Qe();localStorage.setItem(g,String(o));const w=new Date().toISOString();if(localStorage.setItem(g+"_lastUpdated",w),e!=null&&e.uid){const N=`userData_${e.uid}`,x=localStorage.getItem(N),j={...x?JSON.parse(x):{},cashBalance:o,lastUpdated:w};localStorage.setItem(N,JSON.stringify(j)),we(!0)}}catch{}}if(c&&typeof c=="object"){ut(c);try{const g=st();localStorage.setItem(g,JSON.stringify(c));const w=new Date().toISOString();if(localStorage.setItem(g+"_lastUpdated",w),e!=null&&e.uid){const N=`userData_${e.uid}`,x=localStorage.getItem(N),j={...x?JSON.parse(x):{},walletBalances:c,lastUpdated:w};localStorage.setItem(N,JSON.stringify(j)),we(!0)}}catch{}}if(m&&m.walletId===L&&Hs(g=>{if(!g)return g;const w=Number(m.amount||0),N=m.type==="transfer",x={...g};return N?(x.dailyTransferUsed=(x.dailyTransferUsed||0)+w,x.monthlyTransferUsed=(x.monthlyTransferUsed||0)+w):(x.dailyWithdrawUsed=(x.dailyWithdrawUsed||0)+w,x.monthlyWithdrawUsed=(x.monthlyWithdrawUsed||0)+w),x}),d){const g=d.type==="machine_withdrawal"||d.txnType==="machine_withdrawal",w=_d.current||[];if(g&&w.find(x=>{if((x.type||x.txnType)!=="machine_withdrawal")return!1;const j=Number(x.amount)===Number(d.amount),S=x.senderName===d.senderName,_=new Date(x.createdAt).getTime(),O=new Date(d.createdAt||Date.now()).getTime(),A=Math.abs(O-_);return j&&S&&A<6e4})){console.log("Skipping duplicate machine withdrawal event (fuzzy match):",d);return}try{Pa.current&&(Pa.current.some(N=>N.id===d.id)||Pa.current.push(d))}catch{}Vt(N=>N.some(x=>x.id===d.id)?N:[d,...N]),y({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ© Ø®Ø§Ø±Ø¬ÙŠØ©",description:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙˆØ§Ù„Ø³Ø¬Ù„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­"});try{Mr.refetch()}catch{}}};return window.addEventListener("dashboard:external-update",a),()=>window.removeEventListener("dashboard:external-update",a)},[L]);const[Sd,ef]=u.useState(""),Dd=(()=>{const a=Sd.replace(/\D/g,"");return a?X.filter(r=>(r.phone||"").replace(/\D/g,"").includes(a)):X})();u.useEffect(()=>{(async()=>{try{let r=[];if(e!=null&&e.uid)try{const o=await ps(()=>ae.getUserData(e.uid)),c=o==null?void 0:o.favoriteWalletIds;Array.isArray(c)&&(r=c.map(d=>String(d)))}catch{}if(!r.length)try{const o=e!=null&&e.uid?`favoriteWallets_${e.uid}`:"favoriteWallets",c=localStorage.getItem(o)??localStorage.getItem("favoriteWallets");if(c){const d=JSON.parse(c);Array.isArray(d)&&(r=d.filter(m=>typeof m=="string"))}}catch{}r.length&&to(r)}catch{to([])}})()},[e==null?void 0:e.uid]),u.useEffect(()=>{try{const a=e!=null&&e.uid?`favoriteWallets_${e.uid}`:"favoriteWallets";localStorage.setItem(a,JSON.stringify(Is)),e!=null&&e.uid&&ae.updateUserData(e.uid,{favoriteWalletIds:Is})}catch{}},[Is,e==null?void 0:e.uid]);const kd=K.useMemo(()=>{const a=new Set(Is);return[...Dd].sort((r,o)=>{const c=a.has(r.id),d=a.has(o.id);return c===d?0:c?-1:1})},[Dd,Is]),tf=a=>{to(r=>r.includes(a)?r.filter(o=>o!==a):[...r,a])},[af,kN]=u.useState(null),[sf,Cd]=u.useState(!1),[rf,qn]=u.useState(!1),[nf,of]=u.useState(null),[CN,lf]=u.useState([]),[IN,_N]=u.useState([]),[cf,$s]=u.useState(!1),[Yn,Id]=u.useState("daily"),[Er,Rr]=u.useState([]),[df,AN]=u.useState(!1),va=K.useRef(new Set);K.useRef(new Set);const _d=K.useRef([]);u.useEffect(()=>{_d.current=ge},[ge]);const $o=async a=>{try{if(!e)return;const r=Qe(),o=st(),c=localStorage.getItem(r),d=localStorage.getItem(o);let m=c?parseFloat(c):Ve,f=d?JSON.parse(d):{...Se};const g=Number(a.withdrawnAmount??a.sentAmount??a.transferredAmount??a.amount??0);if(a.type==="send"&&(a.fromWallet||L)){m=Math.round(m-g);const v=a.fromWallet||L;f[v]=(f[v]||0)+g}else if(a.type==="withdraw"&&(a.fromWallet||L)){m=Math.round(m+g);const v=a.fromWallet||L;f[v]=Math.max(0,(f[v]||0)-g)}at(m),ut(f);const w=new Date().toISOString();localStorage.setItem(r,m.toString()),localStorage.setItem(r+"_lastUpdated",w),localStorage.setItem(o,JSON.stringify(f)),localStorage.setItem(o+"_lastUpdated",w);const N={cashBalance:m,walletBalances:f,lastUpdated:new Date().toISOString()},x=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(x,JSON.stringify(N));try{await ae.updateUserData(e.uid,N),localStorage.removeItem(x),we(!1)}catch(v){console.warn("ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙÙŠ Firebase Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù (Ù…Ø²Ø§Ù…Ù†Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©):",v),we(!0)}try{const v=a.fromWallet||L,j=a.type==="send"?"transfer":"withdraw";await qa.rollbackUsage(v,g,j,a.createdAt)}catch(v){console.warn("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù (Ù…Ø²Ø§Ù…Ù†Ø©):",v)}try{At.removeTransactionEffects(a,e.uid)}catch(v){console.warn("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù (Ù…Ø²Ø§Ù…Ù†Ø©):",v)}}catch(r){console.warn("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø°Ù Ù…Ø­Ù„ÙŠÙ‹Ø§:",r)}},uf=async a=>{try{const r=ge.find(f=>f.id===a);if(!r||!e)return;const o=String(a),c=String((r==null?void 0:r.transactionId)||(r==null?void 0:r.reference)||""),d=va.current.has(o)||c&&va.current.has(c),m=ge.filter(f=>f.id!==a);Vt(m);try{await ae.removeUserTransaction(e.uid,a),await un.permanentlyDeleteTransaction(a,e.uid)}catch(f){console.warn("ØªØ¹Ø°Ø± Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù…Ù† Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„:",f)}if(!d){va.current.add(o),c&&va.current.add(c),await $o(r);try{e!=null&&e.uid&&ae.removeLocalReceiptById(e.uid,a)}catch{}}y({title:"ØªÙ… Ø§Ù„Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ ÙˆØ¹ÙƒØ³ ØªØ£Ø«ÙŠØ±Ø§ØªÙ‡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙˆØ§Ù„Ø­Ø¯ÙˆØ¯ ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±."}),qn(!1)}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„:",r),y({title:"Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù.",variant:"destructive"})}},mf=async a=>{try{const r=ge.find(o=>o.id===a);if(!r||!e)return;try{const o=Rt==null?void 0:Rt.planType;if(o===ta.ZERO){const{dailyOperationCountService:c}=await ne(async()=>{const{dailyOperationCountService:f}=await import("./dailyOperationCountService-Dsy59IZk.js");return{dailyOperationCountService:f}},__vite__mapDeps([67,0,1]),import.meta.url),d=r.type==="send"?"transfer":"withdraw";if(!(await c.checkAndIncrement(e.uid,d,5)).allowed){y({title:"ØªÙ… Ø¨Ù„ÙˆØº Ø­Ø¯ Ø¨Ø§Ù‚Ø© Ø§Ù„Ø²ÙŠØ±Ùˆ",description:"Ù…Ø³Ù…ÙˆØ­ Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 5 ØªØ£ÙƒÙŠØ¯Ø§Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§ Ù„Ù„ØªØ­ÙˆÙŠÙ„/Ø§Ù„Ø³Ø­Ø¨. Ø¬Ø±Ù‘Ø¨ ØºØ¯Ù‹Ø§ Ø£Ùˆ Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}}else if(o===ta.TAHWEELA){const{dailyOperationCountService:c}=await ne(async()=>{const{dailyOperationCountService:f}=await import("./dailyOperationCountService-Dsy59IZk.js");return{dailyOperationCountService:f}},__vite__mapDeps([67,0,1]),import.meta.url),d=r.type==="send"?"transfer":"withdraw";if(!(await c.checkAndIncrementCombined(e.uid,d,40)).allowed){y({title:"ØªÙ… Ø¨Ù„ÙˆØº Ø­Ø¯ Ø¨Ø§Ù‚Ø© ØªØ­ÙˆÙŠÙ„Ù‡",description:"Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø§Ù‚Ø© ØªØ³Ù…Ø­ Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 40 Ø¹Ù…Ù„ÙŠØ© ØªØ­ÙˆÙŠÙ„/Ø³Ø­Ø¨ ÙŠÙˆÙ…ÙŠØ§Ù‹.",variant:"destructive"});return}}}catch(o){console.warn("ØªØ¹Ø°Ø± Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ:",o)}await Zt(Ae(F,"userTransactions",a),{status:"completed",confirmedAt:new Date}),Vt(o=>o.map(c=>c.id===a?{...c,status:"completed"}:c)),y({title:"ØªÙ… Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„",description:"ØªÙ… ÙˆØ³Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙƒÙ…ÙƒØªÙ…Ù„Ø©."}),qn(!1)}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„:",r),y({title:"ÙØ´Ù„ Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©.",variant:"destructive"})}};u.useEffect(()=>{if(!e)return;(async()=>{try{const r=Ie(ce(F,"deletedTransactions"),q("userId","==",e.uid),Oi("createdAt","desc"),hm(50));(await ve(r)).docs.forEach(c=>{const d=c.data(),m=String((d==null?void 0:d.originalTransactionId)||""),f=String((d==null?void 0:d.transactionId)||""),g=String((d==null?void 0:d.reference)||""),w=m||f||g||String(c.id);w&&(va.current.has(w)||(va.current.add(w),Vt(N=>{const x=N.find(v=>v.id===m);return x?((async()=>await $o(x))(),N.filter(v=>v.id!==m)):N})))})}catch(r){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©:",r)}})()},[e==null?void 0:e.uid]),u.useEffect(()=>{if(!e)return;(async()=>{try{const r=Ae(F,"users",e.uid),o=await fa(r);if(!o.exists())return;const c=o.data();if(!(c!=null&&c.reportsData))return;try{await At.syncReportsDataFromFirebase(e.uid),lf(Ku())}catch(d){console.warn("ØªØ¹Ø°Ø± Ù…Ø²Ø§Ù…Ù†Ø© reportsData Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©:",d)}}catch(r){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ users.reportsData:",r)}})()},[e==null?void 0:e.uid]);const[Uo,Ad]=u.useState(""),Td=yw(Uo,300),[zn,Pd]=u.useState(""),[Kn,Md]=u.useState(""),[wa,TN]=u.useState(""),[Vo,Us]=u.useState(!1),[qo,Lr]=u.useState(!1),[hf,Od]=u.useState(null),[ca,Yo]=u.useState(!1),[ff,da]=u.useState(!1),[Xe,zo]=u.useState(null),[ht,gf]=u.useState(null),[Ed,ua]=u.useState(!1),[pf,Ma]=u.useState(!1),[xf,Rd]=u.useState(!1),[yf,Ld]=u.useState(void 0),[bf,Wd]=u.useState(!1),[Ko,Jo]=u.useState(""),[vf,Fd]=u.useState(!1),[wf,Wr]=u.useState(!1),[Nf,Bd]=u.useState(!1),[jf,Jn]=u.useState(!1),[Sf,$d]=u.useState(!1),[Df,Hn]=u.useState(!1),[kf,Qn]=u.useState(!1),[Cf,Gn]=u.useState(!1),[Ud,Xn]=u.useState(()=>{try{const a=e!=null&&e.uid?`monthlyReportsLock_v4_${e==null?void 0:e.uid}`:"monthlyReportsLock_v4";return(localStorage.getItem(a)??localStorage.getItem("monthlyReportsLock_v4"))==="true"}catch{return!1}});u.useEffect(()=>{const a=()=>{try{const o=e!=null&&e.uid?`monthlyReportsLock_v4_${e==null?void 0:e.uid}`:"monthlyReportsLock_v4",c=localStorage.getItem(o)??localStorage.getItem("monthlyReportsLock_v4");Xn(c==="true")}catch{}};a();const r=o=>{o.detail&&typeof o.detail.enabled=="boolean"?Xn(o.detail.enabled):a()};return window.addEventListener("monthlyReportsLockChanged",r),()=>window.removeEventListener("monthlyReportsLockChanged",r)},[e==null?void 0:e.uid]);const[Fr,If]=u.useState(!1),[_f,Zn]=u.useState(!1),[Af,Vd]=u.useState(!1),[ei,Tf]=u.useState(""),[qd,Pf]=u.useState(!1),[Mf,Ho]=u.useState(!1),[Gt,Yd]=u.useState(()=>{try{const a=(e==null?void 0:e.uid)||"default",r=localStorage.getItem(`hiddenQuickActions_${a}`)??localStorage.getItem("hiddenQuickActions"),o=r?JSON.parse(r):[];return Array.isArray(o)?o.filter(c=>typeof c=="string"):[]}catch{return[]}}),[Of,zd]=u.useState(()=>{try{const a=e!=null&&e.uid?`dailyReportsLockEnabled_${e==null?void 0:e.uid}`:"dailyReportsLockEnabled";return(localStorage.getItem(a)??localStorage.getItem("dailyReportsLockEnabled"))==="true"}catch{return!1}}),[Ef,Qo]=u.useState(!1);u.useEffect(()=>{try{const a=e!=null&&e.uid?`dailyReportsLockEnabled_${e==null?void 0:e.uid}`:"dailyReportsLockEnabled",r=localStorage.getItem(a)??localStorage.getItem("dailyReportsLockEnabled");zd(r==="true")}catch{}},[e==null?void 0:e.uid]);const[Rf,Vs]=u.useState(!1),[Lf,Go]=u.useState(!1),[Wf,Kd]=u.useState(()=>{try{const a=e==null?void 0:e.uid,r=a?`debtsPinRequired_${a}`:"debtsPinRequired";return(localStorage.getItem(r)??localStorage.getItem("debtsPinRequired"))==="true"}catch{return!1}}),[Ff,Jd]=u.useState(!1),[Hd,Bf]=u.useState(null),[Xo,Zo]=u.useState(""),[el,Qd]=u.useState(""),[Gd,Xd]=u.useState(""),[Na,Zd]=u.useState(null),[R,Br]=u.useState(null),[$f,Ha]=u.useState(!1),[Uf,ti]=u.useState(!1),[ja,Vf]=u.useState(null),[eu,tu]=u.useState(""),[au,ai]=u.useState(""),[lt,su]=u.useState(null),[PN,MN]=u.useState(!1),[qf,si]=u.useState(!1),[qs,ru]=u.useState(()=>{try{return localStorage.getItem("eyeComfortMode")==="true"}catch{return!1}});u.useEffect(()=>{localStorage.setItem("eyeComfortMode",String(qs))},[qs]);const[nu,$r]=u.useState(""),[tl,ms]=u.useState(!1),[iu,ri]=u.useState(1),[Ur,ou]=u.useState(""),Yf=M?10:20,ni=K.useMemo(()=>{if(!Ur)return Ee;const a=Ur.toLowerCase();return Ee.filter(r=>r.debtorName&&r.debtorName.toLowerCase().includes(a)||r.amount&&r.amount.toString().includes(a))},[Ee,Ur]),ii=K.useMemo(()=>ni.slice(0,iu*Yf),[ni,iu]);u.useEffect(()=>{ri(1)},[Ur]),u.useEffect(()=>{tl&&(ri(1),ou(""))},[tl]),u.useEffect(()=>{try{const a=(e==null?void 0:e.uid)||"default",r=localStorage.getItem(`hiddenQuickActions_${a}`)??localStorage.getItem("hiddenQuickActions"),o=r?JSON.parse(r):[];Array.isArray(o)&&Yd(o.filter(c=>typeof c=="string"))}catch{}},[e==null?void 0:e.uid]),u.useEffect(()=>{const a=r=>{var o;try{const c=(o=r==null?void 0:r.detail)==null?void 0:o.hiddenQuickActions;Array.isArray(c)&&Yd(c.map(d=>String(d)))}catch{}};try{window.addEventListener("hiddenQuickActionsChanged",a)}catch{}return()=>{try{window.removeEventListener("hiddenQuickActionsChanged",a)}catch{}}},[]);const al=async()=>{if(Pe){y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†/Ø§Ù„Ø£Ø¬Ù„ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}try{const a=await zt.hasMasterPin(e==null?void 0:e.uid);Wf&&a?Go(!0):Vs(!0)}catch{Vs(!0)}};u.useEffect(()=>{try{const a=e==null?void 0:e.uid,r=a?`debtsPinRequired_${a}`:"debtsPinRequired",o=localStorage.getItem(r)??localStorage.getItem("debtsPinRequired");(o==="true"||o==="false")&&Kd(o==="true")}catch{}},[e==null?void 0:e.uid]),u.useEffect(()=>{const a=()=>{try{xl()}catch{}};try{window.addEventListener("debtsUpdated",a)}catch{}return()=>{try{window.removeEventListener("debtsUpdated",a)}catch{}}},[e==null?void 0:e.uid,D,n==null?void 0:n.shopId]);const[zf,sl]=u.useState(!1),[Ys,rl]=u.useState("customers_list"),[wt,nl]=u.useState([]),[il,lu]=u.useState(""),[ol,cu]=u.useState(""),[Qa,ll]=u.useState(""),[du,Kf]=u.useState(""),[Jf,oi]=u.useState(!1),[Hf,uu]=u.useState(""),[mu,cl]=u.useState(""),[hu,dl]=u.useState(""),[Qf,li]=u.useState(!1),[Gf,ul]=u.useState(""),[fu,ml]=u.useState(""),[Xf,hl]=u.useState(!1),[fl,Zf]=u.useState(""),[eg,zs]=u.useState(!1),[Oa,Vr]=u.useState(null),[Nt,qr]=u.useState(null),[Ks,gl]=u.useState(""),[tg,Js]=u.useState(!1),[gu,ci]=u.useState(0),[Lt,Ga]=u.useState(null),[Xa,pl]=u.useState(""),[je,Hs]=u.useState(null),[ag,pu]=u.useState(""),[bt,hs]=u.useState("deduct"),Ea=async a=>{try{const r=JSON.stringify(a);localStorage.setItem(Yr(),r);try{localStorage.setItem(Dl(),r)}catch{}try{localStorage.setItem(kl(),Date.now().toString())}catch{}if(e!=null&&e.uid){try{localStorage.setItem(`debts_unsynced_${e.uid}`,"true")}catch{}const o=[];o.push(ae.updateUserData(e.uid,{debts:a,debtsDeletedAt:null})),Promise.all(o).then(()=>{try{localStorage.removeItem(`debts_unsynced_${e.uid}`)}catch{}}).catch(c=>{console.error("ÙØ´Ù„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†:",c),we(!0)})}}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¯ÙŠÙˆÙ†:",r)}},xl=async()=>{try{const a=Yr(),r=Dl(),o=kl(),c=localStorage.getItem(a),d=localStorage.getItem(r),m=localStorage.getItem(o),f=m?Number(m):0,g=N=>{if(!N)return null;try{const x=JSON.parse(N);return Array.isArray(x)?x.map(v=>{var j;return{...v,createdAt:(j=v.createdAt)!=null&&j.toDate?v.createdAt.toDate():new Date(v.createdAt),partialPayments:Array.isArray(v.partialPayments)?v.partialPayments.map(S=>{var _;return{amount:Number(S.amount)||0,paidAt:(_=S.paidAt)!=null&&_.toDate?S.paidAt.toDate():new Date(S.paidAt)}}):[],additionReceipts:Array.isArray(v.additionReceipts)?v.additionReceipts.map(S=>{var _;return{amount:Number(S.amount)||0,note:typeof S.note=="string"?S.note:void 0,addedAt:(_=S.addedAt)!=null&&_.toDate?S.addedAt.toDate():new Date(S.addedAt)}}):[]}}):[]}catch(x){return console.warn("ÙØ´Ù„ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø¯ÙŠÙˆÙ† localStorage:",x),null}};let w=g(c);if(!w||w.length===0){const N=g(d);if(N&&N.length>0){w=N,qt(N);try{localStorage.setItem(Yr(),JSON.stringify(N)),localStorage.removeItem(r)}catch(x){console.warn("ØªØ¹Ø°Ø± ØªØ±Ø­ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙˆÙ† Ù…Ø­Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ:",x)}}}if(w&&w.length>0&&qt(w),e!=null&&e.uid)try{const N=`debts_unsynced_${e.uid}`,x=localStorage.getItem(N)==="true",v=await fa(Ae(F,"users",e.uid)),j=[];try{const S=query(ce(F,"debts"),q("userId","==",e.uid));(await ve(S)).forEach(O=>{var P;const A=O.data();j.push({id:O.id,...A,amount:Number(A.amount||0),paidAmount:Number(A.paidAmount||0),createdAt:(P=A.createdAt)!=null&&P.toDate?A.createdAt.toDate():new Date(A.createdAt||Date.now()),partialPayments:Array.isArray(A.partialPayments)?A.partialPayments:[],additionReceipts:Array.isArray(A.additionReceipts)?A.additionReceipts.map(U=>{var te;return{amount:Number(U.amount)||0,note:typeof U.note=="string"?U.note:void 0,addedAt:(te=U.addedAt)!=null&&te.toDate?U.addedAt.toDate():new Date(U.addedAt)}}):[]})})}catch(S){console.warn("Failed to fetch from debts collection:",S)}if(v.exists()){const S=v.data();let _=S.debts&&Array.isArray(S.debts)?S.debts.map(P=>{var U;return{...P,amount:Number(P.amount||0),paidAmount:Number(P.paidAmount||0),createdAt:(U=P.createdAt)!=null&&U.toDate?P.createdAt.toDate():new Date(P.createdAt),partialPayments:Array.isArray(P.partialPayments)?P.partialPayments.map(te=>{var H;return{amount:Number(te.amount)||0,paidAt:(H=te.paidAt)!=null&&H.toDate?te.paidAt.toDate():new Date(te.paidAt)}}):[],additionReceipts:Array.isArray(P.additionReceipts)?P.additionReceipts.map(te=>{var H;return{amount:Number(te.amount)||0,note:typeof te.note=="string"?te.note:void 0,addedAt:(H=te.addedAt)!=null&&H.toDate?te.addedAt.toDate():new Date(te.addedAt)}}):[]}}):[];if(!!S.debtsDeletedAt){qt([]);try{localStorage.setItem(a,JSON.stringify([])),localStorage.setItem(r,JSON.stringify([]))}catch{}return}if(((_==null?void 0:_.length)||0)>0)if(x)console.log("âš ï¸ ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø¯ÙŠÙˆÙ† ØºÙŠØ± Ù…ØªØ²Ø§Ù…Ù†Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… ØªØ¬Ø§Ù‡Ù„ Ù†Ø³Ø®Ø© Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ù…Ø¤Ù‚ØªØ§Ù‹ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©.");else{qt(_);try{localStorage.setItem(a,JSON.stringify(_))}catch{}}}else if(j.length>0){qt(j);try{localStorage.setItem(a,JSON.stringify(j))}catch{}}else w&&w.length>0}catch(N){console.warn("ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙˆÙ† Ù…Ù† FirebaseØŒ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ù„ÙŠ:",N)}}catch(a){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙˆÙ†:",a)}};u.useEffect(()=>{try{window.exportDebts=()=>{try{return JSON.stringify(Ee||[])}catch{return"[]"}},window.importDebts=async a=>{try{const r=JSON.parse(a);if(!Array.isArray(r))throw new Error("ØµÙŠØºØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø© â€” ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù…ØµÙÙˆÙØ©");return await Ea(r),{ok:!0,count:r.length}}catch(r){return console.error("ÙØ´Ù„ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙˆÙ†:",r),{ok:!1,error:String(r)}}},window.fixWalletsForCurrentUser=async a=>{try{if(!(e!=null&&e.uid))throw new Error("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹");return await(await ne(async()=>{const{merchantWalletService:o}=await import("./index-CgV0sHeM.js").then(c=>c.cR);return{merchantWalletService:o}},__vite__mapDeps([0,1]),import.meta.url)).merchantWalletService.reassignByMsisdns(a,e.uid)}catch(r){return console.error("ÙØ´Ù„ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:",r),{updated:0,failed:(a==null?void 0:a.length)||0,error:String(r)}}}}catch{}},[Ee,e==null?void 0:e.uid]),u.useEffect(()=>{e!=null&&e.uid&&xl()},[e==null?void 0:e.uid]),u.useEffect(()=>{if(!(e!=null&&e.uid))return;const a=an(Ae(F,"users",e.uid),async r=>{var o;if(r.exists()){const c=r.data(),d=c.isActive===!0;c.subscription&&ld(c.subscription),C0(c.branchPackage||null);const m=await Dm.checkTrialValidity(e.uid),f=m.isValid&&!m.isExpired;Ya(d||f),nd(f),id(m.hoursRemaining),od(m.hasUsedTrial);const g=!d&&!f;za(g),g&&(console.log("â›” User not active, redirecting to pending approval..."),p("/user/pending-approval",{replace:!0})),console.log("ðŸ”„ ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Real-time):",{isActive:d,isOnTrial:f,plan:(o=c.subscription)==null?void 0:o.planType,showModal:g})}});return()=>a()},[e==null?void 0:e.uid]);const sg=async()=>{if(e!=null&&e.uid)try{cd(!0);const a=await Jm(e.uid);ld(a)}catch(a){console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:",a)}finally{cd(!1)}},[ON,EN]=u.useState(!1),[rg,yl]=u.useState(!1),[Ve,at]=u.useState(0),[Se,ut]=u.useState({}),[ng,xu]=u.useState(!1),[ig,yu]=u.useState(!1),[og,bl]=u.useState(!1),[lg,di]=u.useState(!1),[bu,vl]=u.useState(""),[cg,ui]=u.useState(!1),[dg,mi]=u.useState(!1),[wl,hi]=u.useState(""),[ug,Nl]=u.useState(!1),[fi,vu]=u.useState(""),[gi,wu]=u.useState(""),[pi,Nu]=u.useState(""),[ju,Su]=u.useState(!1),[jl,Sl]=u.useState(!1),[mg,Du]=u.useState(!1),[ku,hg]=u.useState([]);u.useEffect(()=>{(async()=>{try{if(!(e!=null&&e.uid)||!jl)return;try{await tr.trimToMaxCount(e.uid,30)}catch{}const a=await tr.getByUser(e.uid,30);hg(a)}catch{}})()},[e==null?void 0:e.uid,jl]);const st=()=>{const a=D||(n==null?void 0:n.shopId)||"main";return`walletBalances_${(e==null?void 0:e.uid)||"default"}_${a}`},Qe=()=>{const a=D||(n==null?void 0:n.shopId)||"main";return`cashBalance_${(e==null?void 0:e.uid)||"default"}_${a}`},Yr=()=>{const a=D||(n==null?void 0:n.shopId)||"main";return`debts_${(e==null?void 0:e.uid)||"default"}_${a}`},fg=()=>{const a=D||(n==null?void 0:n.shopId)||"main";return`customers_${(e==null?void 0:e.uid)||"default"}_${a}`},Dl=()=>`debts_default_${D||(n==null?void 0:n.shopId)||"main"}`,kl=()=>{const a=D||(n==null?void 0:n.shopId)||"main";return`debts_last_write_${(e==null?void 0:e.uid)||"default"}_${a}`},Cl=()=>`shopExpenses_${D||(n==null?void 0:n.shopId)||(e==null?void 0:e.uid)||"default"}`,Cu=()=>{try{const a=localStorage.getItem(Cl());if(a){const r=JSON.parse(a);yo(r.map(o=>({...o,createdAt:new Date(o.createdAt)})))}}catch(a){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ†:",a)}},Iu=async a=>{try{localStorage.setItem(Cl(),JSON.stringify(a)),yo(a)}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ†:",r)}},gg=async a=>{try{const r=Pn.filter(o=>o.id!==a);await Iu(r);try{if(e!=null&&e.uid&&a){const{doc:o,deleteDoc:c}=await ne(async()=>{const{doc:f,deleteDoc:g}=await import("./index-CgV0sHeM.js").then(w=>w.cP);return{doc:f,deleteDoc:g}},__vite__mapDeps([0,1]),import.meta.url),{db:d}=await ne(async()=>{const{db:f}=await import("./index-CgV0sHeM.js").then(g=>g.cQ);return{db:f}},__vite__mapDeps([0,1]),import.meta.url),m=o(d,"shop_expenses",a);await c(m)}}catch(o){console.warn("ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ù…ØµØ±ÙˆÙ Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ø§Ù„Ø¢Ù†ØŒ ØªÙ… Ø§Ù„Ø­Ø°Ù Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙˆØ³ÙŠØ¨Ù‚Ù‰ Ù…Ø®Ø²Ù‘Ù†Ù‹Ø§ Ø¯ÙˆÙ† Ù‡Ø°Ø§ Ø§Ù„Ø¥ÙŠØµØ§Ù„:",o)}y({title:"ØªÙ… Ø§Ù„Ø­Ø°Ù",description:"ØªÙ… Ø­Ø°Ù Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ù…ØµØ±ÙˆÙ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§."})}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ù…ØµØ±ÙˆÙ:",r),y({title:"ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù",description:"ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"})}};K.useEffect(()=>{let a;return(async()=>{try{if(!(e!=null&&e.uid)){Cu();return}const{collection:r,query:o,where:c,getDocs:d}=await ne(async()=>{const{collection:v,query:j,where:S,getDocs:_}=await import("./index-CgV0sHeM.js").then(O=>O.cP);return{collection:v,query:j,where:S,getDocs:_}},__vite__mapDeps([0,1]),import.meta.url),{db:m}=await ne(async()=>{const{db:v}=await import("./index-CgV0sHeM.js").then(j=>j.cQ);return{db:v}},__vite__mapDeps([0,1]),import.meta.url),f=D||(n==null?void 0:n.shopId),g=f?o(r(m,"shop_expenses"),c("shopId","==",f)):o(r(m,"shop_expenses"),c("userId","==",e.uid)),x=(await d(g)).docs.map(v=>{var _;const j=v.data(),S=(_=j.createdAt)!=null&&_.toDate?j.createdAt.toDate():j.createdAt?new Date(j.createdAt):new Date;return{id:v.id,name:String(j.name||""),amount:Number(j.amount||0),notes:j.notes?String(j.notes):void 0,source:j.source==="wallet"?"wallet":"cash",walletId:j.walletId?String(j.walletId):void 0,createdAt:S}}).sort((v,j)=>{const S=v.createdAt instanceof Date?v.createdAt.getTime():0;return(j.createdAt instanceof Date?j.createdAt.getTime():0)-S});yo(x);try{localStorage.setItem(Cl(),JSON.stringify(x))}catch{}}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ Ù…Ù† Firestore:",r)}})(),()=>a==null?void 0:a()},[e==null?void 0:e.uid,n==null?void 0:n.shopId,D]);const xi=()=>`deficiencies_${D||(n==null?void 0:n.shopId)||(e==null?void 0:e.uid)||"default-shop"}`,pg=()=>{try{const a=xi(),r=`deficiencies_${(e==null?void 0:e.uid)||"default"}`;if(r!==a){const c=localStorage.getItem(r),d=localStorage.getItem(a);if(c)try{const m=JSON.parse(c)||[],f=d?JSON.parse(d):[],g=Array.isArray(f)?[...f]:[],w=(N,x)=>N.some(v=>(v==null?void 0:v.id)&&(x==null?void 0:x.id)&&String(v.id)===String(x.id)||String((v==null?void 0:v.name)||"")===String((x==null?void 0:x.name)||"")&&String((v==null?void 0:v.status)||"pending")===String((x==null?void 0:x.status)||"pending"));if(Array.isArray(m))for(const N of m)w(g,N)||g.push(N);localStorage.setItem(a,JSON.stringify(g));try{localStorage.removeItem(r)}catch{}}catch{}}const o=localStorage.getItem(a);if(o){const c=JSON.parse(o);Ms(c.map(d=>({...d,createdAt:new Date(d.createdAt)})))}}catch(a){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ†:",a)}},Il=async a=>{try{localStorage.setItem(xi(),JSON.stringify(a)),Ms(a)}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ†:",r)}};K.useEffect(()=>{(async()=>{try{if(!(e!=null&&e.uid))return;const{collection:r,query:o,where:c,orderBy:d,getDocs:m}=await ne(async()=>{const{collection:v,query:j,where:S,orderBy:_,getDocs:O}=await import("./index-CgV0sHeM.js").then(A=>A.cP);return{collection:v,query:j,where:S,orderBy:_,getDocs:O}},__vite__mapDeps([0,1]),import.meta.url),{db:f}=await ne(async()=>{const{db:v}=await import("./index-CgV0sHeM.js").then(j=>j.cQ);return{db:v}},__vite__mapDeps([0,1]),import.meta.url),g=D||(n==null?void 0:n.shopId)||e.uid||"default-shop",w=o(r(f,"deficiencies"),c("shopId","==",g),d("createdAt","desc")),x=(await m(w)).docs.map(v=>{var _;const j=v.data(),S=(_=j.createdAt)!=null&&_.toDate?j.createdAt.toDate():j.createdAt?new Date(j.createdAt):new Date;return{id:v.id,name:String(j.name||""),quantity:Number(j.quantity||1),status:j.status==="purchased"?"purchased":"pending",createdAt:S}});Ms(x);try{localStorage.setItem(xi(),JSON.stringify(x))}catch{}}catch(r){console.warn("ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ù…Ù† Firestore:",r)}})()},[e==null?void 0:e.uid,n==null?void 0:n.shopId,D]);const _l=async a=>{try{localStorage.setItem(fg(),JSON.stringify(a)),nl(a),e!=null&&e.uid&&await ae.updateUserData(e.uid,{customers:a})}catch(r){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ†:",r)}},xg=async()=>{try{if(e!=null&&e.uid){const a=await fa(Ae(F,"users",e.uid));if(a.exists()){const r=a.data();if(r.customers&&Array.isArray(r.customers)){const o=r.customers.map(c=>{var d;return{...c,createdAt:(d=c.createdAt)!=null&&d.toDate?c.createdAt.toDate():new Date(c.createdAt)}});nl(o);return}}}nl([])}catch(a){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù…Ù† Firestore:",a)}},Al=()=>{const a=D||(n==null?void 0:n.shopId)||"main";return`transactions_${(e==null?void 0:e.uid)||"default"}_${a}`},_u=()=>{const a=D||(n==null?void 0:n.shopId)||"main";return`wallets_${(e==null?void 0:e.uid)||"default"}_${a}`},fs=()=>{const a=D||(n==null?void 0:n.shopId)||"main";return`selectedWallet_${(e==null?void 0:e.uid)||"default"}_${a}`},Tl=a=>{var d;const r=String((a==null?void 0:a.transactionId)||(a==null?void 0:a.id)||""),o=String((a==null?void 0:a.reference)||(a==null?void 0:a.transactionReference)||((d=a==null?void 0:a.receipt)==null?void 0:d.reference)||""),c=new Date((a==null?void 0:a.createdAt)||0).getTime();return r||o||`${o||"ref"}-${c}`},{data:Pl,refetch:RN}=mn({queryKey:["userTransactions",e==null?void 0:e.uid],queryFn:async()=>{if(!(e!=null&&e.uid))return[];const{collection:a,query:r,where:o,orderBy:c,limit:d,getDocs:m}=await ne(async()=>{const{collection:N,query:x,where:v,orderBy:j,limit:S,getDocs:_}=await import("./index-CgV0sHeM.js").then(O=>O.cP);return{collection:N,query:x,where:v,orderBy:j,limit:S,getDocs:_}},__vite__mapDeps([0,1]),import.meta.url),{db:f}=await ne(async()=>{const{db:N}=await import("./index-CgV0sHeM.js").then(x=>x.cQ);return{db:N}},__vite__mapDeps([0,1]),import.meta.url),g=r(a(f,"userTransactions"),o("userId","==",e.uid),c("createdAt","desc"),d(100));return(await m(g)).docs.map(N=>{var U;const x=N.data(),v=(U=x.createdAt)!=null&&U.toDate?x.createdAt.toDate():new Date(x.createdAt),j=(x.txnType||"").toLowerCase(),S=j==="send"?"send":j==="receive"?"withdraw":x.type||"withdraw",_=x.status==="confirmed"?"completed":x.status||"completed",O=x.senderMsisdn||x.senderPhone||"",A=x.receiverMsisdn||x.receiverPhone||"",P=Number(x.amount??x.transferredAmount??x.withdrawnAmount??0);return{id:N.id,...x,type:S,status:_,senderPhone:O,receiverPhone:A,amount:P,createdAt:v,provider:x.provider||void 0}})},enabled:!!(e!=null&&e.uid),staleTime:1e3*60*5,gcTime:1e3*60*10});u.useEffect(()=>{if(Pl){const r=Pl.filter(f=>!((f==null?void 0:f.type)==="report"||String((f==null?void 0:f.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"))),o=new Set((Er||[]).map(f=>String(f.id||f.originalTransactionId||""))),c=r.filter(f=>!o.has(String(f.id||""))),d=new Set,m=[];for(const f of c){const g=Tl(f);d.has(g)||(d.add(g),m.push(f))}Vt(m)}},[Pl,Er]),u.useEffect(()=>{if(!(e!=null&&e.uid))return;let a=!0;return(async()=>{try{const{collection:o,query:c,where:d,getDocs:m,orderBy:f,limit:g}=await ne(async()=>{const{collection:v,query:j,where:S,getDocs:_,orderBy:O,limit:A}=await import("./index-CgV0sHeM.js").then(P=>P.cP);return{collection:v,query:j,where:S,getDocs:_,orderBy:O,limit:A}},__vite__mapDeps([0,1]),import.meta.url),{db:w}=await ne(async()=>{const{db:v}=await import("./index-CgV0sHeM.js").then(j=>j.cQ);return{db:v}},__vite__mapDeps([0,1]),import.meta.url),N=c(o(w,"deletedTransactions"),d("userId","==",e.uid),f("createdAt","desc"),g(50)),x=await m(N);if(!a)return;x.docs.forEach(v=>{const j=v.data(),S=String((j==null?void 0:j.originalTransactionId)||""),_=String((j==null?void 0:j.transactionId)||""),O=String((j==null?void 0:j.reference)||""),A=S||_||O||String(v.id);A&&(va.current.has(A)||(va.current.add(A),Vt(P=>{const U=P.find(te=>te.id===S);return U?((async()=>await $o(U))(),P.filter(te=>te.id!==S)):P})))})}catch(o){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©:",o)}})(),()=>{a=!1}},[e==null?void 0:e.uid]);const[Ml,yi]=u.useState(""),[Yt,Au]=u.useState(""),ma=K.useMemo(()=>{const a=Rt;if(!a)return!1;const r=mm(a),o=a.planType??a.plan??null,c=typeof o=="string"?o.toLowerCase():null,d=c==="monthly"||c==="quarterly"||c==="half_yearly"||c==="yearly"||c==="lifetime"||o===ta.MONTHLY||o===ta.QUARTERLY||o===ta.HALF_YEARLY||o===ta.YEARLY||o===ta.LIFETIME;return r&&d},[Rt]),Pe=K.useMemo(()=>{var c,d;const a=Rt;if(!a)return!1;const r=((c=a.subscription)==null?void 0:c.planType)??((d=a.subscription)==null?void 0:d.plan)??a.planType??a.plan??null,o=typeof r=="string"?r.toLowerCase():null;return r===ta.ZERO||o==="zero"},[Rt]),Le=K.useMemo(()=>{var c,d;const a=Rt;if(!a)return!1;const r=((c=a.subscription)==null?void 0:c.planType)??((d=a.subscription)==null?void 0:d.plan)??a.planType??a.plan??null,o=typeof r=="string"?String(r).trim().toLowerCase():null;return r===ta.TAHWEELA||o==="tahweela"||o==="ØªØ­ÙˆÙŠÙ„Ù‡"},[Rt]),yg=()=>{if(!ma){y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ù†ØµÙ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒÙƒ.",variant:"destructive"});return}Dn(!0)},[LN,WN]=u.useState(!1),[bg,vg]=u.useState(!1),[wg,Ng]=u.useState(!1),[jg,Sg]=u.useState(!1),[Dg,zr]=u.useState(!1),[gs,bi]=u.useState(""),[Kr,vi]=u.useState(""),[Tu,wi]=u.useState(!1),[Jr,Hr]=u.useState(null),[Ol,Ni]=u.useState(""),[kg,Pu]=u.useState(!1),[FN,BN]=u.useState(!1),[Cg,ji]=u.useState(!1),[Mu,El]=u.useState(""),[Ou,Rl]=u.useState(""),[Eu,Ru]=u.useState(!1);u.useEffect(()=>{const a=r=>{var d,m;const o=(d=r.detail)==null?void 0:d.action,c=((m=r.detail)==null?void 0:m.payload)||{};if(console.log("ðŸ”” Dashboard Navigation Action:",o,c),o==="lines")ke("lines",()=>{const f=(i==null?void 0:i.simSubscription)||(e==null?void 0:e.simSubscription);let g=!1;f!=null&&f.active&&(f!=null&&f.endsAt)&&(f.endsAt.seconds?new Date(f.endsAt.seconds*1e3):new Date(f.endsAt))>new Date&&(g=!0),g?Jn(!0):na(!0)});else if(o==="profile-settings")ke("settings",()=>Q(!0));else if(o==="debts")ke("debts",()=>al());else if(o==="sales")ke("sales",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Or(!0)});else if(o==="maintenance")ke("maintenance",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„ØµÙŠØ§Ù†Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Qn(!0)});else if(o==="credit-cards")ke("cards",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙƒØ±ÙˆØª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù† ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Hn(!0)});else if(o==="shop-expenses")ke("expenses",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):zt.hasMasterPin()?wr(!0):Ts(!0)});else if(o==="deficiencies")ke("deficiencies",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):jr(!0)});else if(o==="installment")ke("installments",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ· ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Wr(!0)});else if(o==="cashier-shift")!ma||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ÙƒØ§Ø´ÙŠØ± Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):Dn(!0);else if(o==="machine-daily")ke("machines",()=>{!ma||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):Gn(!0)});else if(o==="atm-withdraw")ke("withdrawals",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø³Ø­Ø¨ ATM ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ Ø£Ùˆ ØªØ­ÙˆÙŠÙ„Ù‡. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Y(!0)});else if(o==="pending-operations")re(!0);else if(o==="branch-management")ke("branches",()=>{(Dt==null?void 0:Dt.status)==="active"?gr(!0):pr(!0)});else if(o==="my-client-numbers")ke("myNumbers",()=>On(!0));else if(o==="transaction-section"){const f=()=>{const g=document.getElementById("transaction-section");if(g){const w=c.skipAnimation?"auto":"smooth";g.scrollIntoView({behavior:w})}c.transactionType&&Oo(c.transactionType),c.startNewTransaction&&(Ir(""),Ls(""),Wn(""),Fn(""),console.log("ðŸ”’ Starting new transaction via event"))};c.transactionType==="transfer"?ke("transfers",f):c.transactionType==="withdraw"?ke("withdrawals",f):f()}};return window.addEventListener("dashboard-navigation-action",a),()=>window.removeEventListener("dashboard-navigation-action",a)},[X,Le,Dt,Pe,ma]);const Lu=async()=>{var a;if(e!=null&&e.uid)try{const r=`userData_${e.uid}`,o=localStorage.getItem(r),c=`debts_unsynced_${e.uid}`,d=localStorage.getItem(Yr()),m=localStorage.getItem(c)==="true";if(o){const f=JSON.parse(o);console.log("ðŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ù…Ø¹ Firebase...",f);const g={lastSynced:new Date().toISOString()};typeof f.cashBalance=="number"&&(g.cashBalance=f.cashBalance),f.walletBalances&&typeof f.walletBalances=="object"&&(g.walletBalances=f.walletBalances),await ae.updateUserData(e.uid,g),localStorage.removeItem(r),we(!1),console.log("âœ… ØªÙ…Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©")}else console.log("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ© ØªØ­ØªØ§Ø¬ Ù„Ù„Ù…Ø²Ø§Ù…Ù†Ø©");if(m&&d)try{const f=JSON.parse(d)||[],g=A=>A instanceof Date?A:typeof(A==null?void 0:A.toDate)=="function"?A.toDate():A?new Date(String(A)):new Date,w=A=>(Array.isArray(A)?A:[]).map(P=>({...P,amount:Number(P.amount||0),paidAmount:Number(P.paidAmount||0),createdAt:g(P.createdAt),partialPayments:Array.isArray(P.partialPayments)?P.partialPayments.map(U=>({amount:Number(U.amount||0),paidAt:g(U.paidAt)})):[]})),N=await fa(Ae(F,"users",e.uid)),x=N.exists()?((a=N.data())==null?void 0:a.debts)||[]:[],v=w(x),j=w(f),S={};for(const A of v)S[String(A.id||"")]=A;const _=[],O=new Set;for(const A of j){const P=String(A.id||""),U=S[P];if(U){const te=Number(U.paidAmount||0),H=Number(A.paidAmount||0),De=String(U.status||"pending"),Je=String(A.status||"pending"),rt=De==="paid"||te>=Number(U.amount||0)?U:Je==="paid"?{...U,paidAmount:Number(A.paidAmount||0),partialPayments:A.partialPayments,status:"paid"}:H>te?{...U,paidAmount:Number(A.paidAmount||0),partialPayments:A.partialPayments,status:H>=Number(U.amount||0)?"paid":"pending"}:U;_.push(rt),O.add(P)}else _.push(A),O.add(P)}for(const A of v){const P=String(A.id||"");O.has(P)||_.push(A)}await ae.updateUserData(e.uid,{debts:_});try{localStorage.removeItem(c)}catch{}we(!1)}catch{we(!0)}}catch(r){console.error("âŒ ÙØ´Ù„ ÙÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:",r),y({title:"ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…",variant:"destructive"})}},[Wu,Si]=u.useState({keepLastCount:30,intervalDays:7,lastResetAt:null});u.useEffect(()=>{(async()=>{if(e!=null&&e.uid)try{const r=await ae.getUserData(e.uid),o=(r==null?void 0:r.recentReset)||{},c=Number(o==null?void 0:o.keepLastCount)>0?Number(o.keepLastCount):30,d=Number(o==null?void 0:o.intervalDays)>0?Number(o.intervalDays):7,m=N=>N instanceof Date?N:typeof(N==null?void 0:N.toDate)=="function"?N.toDate():N?new Date(String(N)):null,f=o!=null&&o.lastResetAt?m(o.lastResetAt):null,g=new Date;!f||g.getTime()-f.getTime()>=d*24*60*60*1e3?(await ae.updateUserData(e.uid,{recentReset:{keepLastCount:c,intervalDays:d,lastResetAt:g}}),Si({keepLastCount:c,intervalDays:d,lastResetAt:g})):Si({keepLastCount:c,intervalDays:d,lastResetAt:f})}catch{Si({keepLastCount:30,intervalDays:7,lastResetAt:null})}})()},[e==null?void 0:e.uid]);const Fu=K.useMemo(()=>{const a=ge||[],r=f=>f instanceof Date?f:typeof(f==null?void 0:f.toDate)=="function"?f.toDate():new Date(String(f)),o=new Date,c=new Date(o.getFullYear(),o.getMonth(),1),d=new Date(o.getFullYear(),o.getMonth()+1,1);return[...a].sort((f,g)=>r(g.createdAt).getTime()-r(f.createdAt).getTime()).filter(f=>{const g=r(f.createdAt);return g>=c&&g<d})},[ge]);K.useMemo(()=>{const a=ge||[],r=f=>f instanceof Date?f:typeof(f==null?void 0:f.toDate)=="function"?f.toDate():new Date(String(f)),o=new Date,c=new Date(o.getFullYear(),o.getMonth(),1),d=new Date(o.getFullYear(),o.getMonth()+1,1),m=a.filter(f=>{const g=r(f.createdAt);return g>=c&&g<d}).length;return Math.max(0,((ge==null?void 0:ge.length)||0)-m)},[ge==null?void 0:ge.length]);const Di=K.useMemo(()=>{const a=new Date,r=new Date(a.getFullYear(),a.getMonth(),1),o=new Date(a.getFullYear(),a.getMonth()+1,1),c={};for(const m of ge){const f=new Date(m.createdAt||0);if(!(f>=r&&f<o))continue;const g=String(m.type||m.txnType||"").toLowerCase();if(!(g==="send"||g==="withdraw"||g==="transfer"))continue;const w=String(m.receiverPhone||m.senderPhone||"").trim();if(!w)continue;const N=ws(w),x=Number(m.amount||m.withdrawnAmount||m.sentAmount||0)||0;c[N]||(c[N]={phone:N,count:0,total:0}),c[N].count+=1,c[N].total+=x}return Object.values(c).sort((m,f)=>f.count!==m.count?f.count-m.count:f.total-m.total).slice(0,10)},[ge]),Ig=a=>{const r=ws(String(a));return r.startsWith("+20")?"20"+r.slice(3):r.startsWith("0")?"20"+r.slice(1):r.replace(/[^0-9]/g,"")},_g=a=>{const r=Ig(a.phone),o=`Ø¹Ù…ÙŠÙ„ VIP Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±
Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª: ${a.count}
Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${a.total} Ø¬Ù†ÙŠÙ‡`,c=`https://wa.me/${r}?text=${encodeURIComponent(o)}`;try{window.open(c,"_blank")}catch{}};u.useEffect(()=>{(async()=>{try{if(!(e!=null&&e.uid))return;const a=`${new Date().getFullYear()}-${new Date().getMonth()+1}`;await ae.updateUserData(e.uid,{vipTop10:Di,vipMonthTag:a})}catch{}})()},[e==null?void 0:e.uid,Di]);async function Bu(){const a=new Date,r=new Intl.DateTimeFormat("ar-EG",{timeZone:"Africa/Cairo",year:"numeric",month:"2-digit",day:"2-digit"}).format(a),o=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999),d=(ge||[]).filter(S=>{const _=new Date(S.createdAt||0);return _>=o&&_<=c}),m=d.length,f=d.filter(S=>String(S.type||S.txnType||"").toLowerCase()==="withdraw"||String(S.type||"").toLowerCase()==="receive").reduce((S,_)=>S+(_.withdrawnAmount!=null?Number(_.withdrawnAmount):Number(_.amount||0)),0),g=d.filter(S=>String(S.type||S.txnType||"").toLowerCase()==="send"||String(S.type||"").toLowerCase()==="transfer").reduce((S,_)=>S+(_.sentAmount!=null?Number(_.sentAmount):Number(_.amount||0)),0);let w=0;try{w=d.reduce((S,_)=>S+At.calculateTransactionProfit(_),0)}catch{}let N=0;try{const S=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(a),_=Ie(ce(F,"dailySales"),q("userId","==",(e==null?void 0:e.uid)||""));N=(await ve(_)).docs.map(P=>P.data()).filter(P=>String(P.date||S)===S).reduce((P,U)=>P+Number(U.sellingPrice||U.price||0)*Number(U.quantity||1),0)}catch{}let x=0;try{x=(Ee||[]).filter(_=>String(_.status||"")==="pending").reduce((_,O)=>{const A=Number(O.paidAmount||0);return _+Math.max(0,Number(O.amount||0)-A)},0)}catch{}let v="";try{const S=D||(n==null?void 0:n.shopId)||null,_=S?Ie(ce(F,"deficiencies"),q("shopId","==",S)):Ie(ce(F,"deficiencies"),q("userId","==",(e==null?void 0:e.uid)||""));v=(await ve(_)).docs.map(U=>U.data()).filter(U=>String(U.status||"pending")==="pending").slice(0,10).map((U,te)=>`${te+1}- ${String(U.name||U.productName||"Ø¹Ù†ØµØ±")} Ã— ${Number(U.quantity||U.qty||0)}`).join(`
`)}catch{}return[`ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ - ${r}`,`Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª: ${m}`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª: ${f} Ø¬Ù†ÙŠÙ‡`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ${g} Ø¬Ù†ÙŠÙ‡`,`Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: ${w} Ø¬Ù†ÙŠÙ‡`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±: ${N} Ø¬Ù†ÙŠÙ‡`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙŠÙˆÙ†: ${x} Ø¬Ù†ÙŠÙ‡`,"Ù†ÙˆØ§Ù‚Øµ Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±:",v||"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³Ø¬Ù„Ø©"].join(`
`)}const $u=K.useCallback(()=>{let a=Fu;const r=Td.trim();if(r&&(a=a.filter(o=>{const c=o;return String(c.type||"").toLowerCase()==="cash_addition"||String(c.txnType||"").toLowerCase()==="cash_addition"||String(c.title||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©")?!0:o.senderPhone&&o.senderPhone.includes(r)||o.receiverPhone&&o.receiverPhone.includes(r)})),zn){const o=new Date(zn);a=a.filter(c=>{const d=new Date(c.createdAt);if(Kn){const[m,f]=Kn.split(":"),g=new Date(o);g.setHours(parseInt(m),parseInt(f),0,0);const w=new Date(g);return w.setHours(w.getHours()+1),d>=g&&d<w}else return d.toDateString()===o.toDateString()})}try{a=[...a].sort((o,c)=>{const d=new Date(o.createdAt||0).getTime();return new Date(c.createdAt||0).getTime()-d})}catch{}return a},[Fu,Td,zn,Kn]),Uu=async()=>{if(Pe||Le){y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"});return}if(!(e!=null&&e.uid)){y({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©",description:"ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}try{const a=await Bu(),r=e!=null&&e.uid?`tg_daily_report_last_${e.uid}`:"tg_daily_report_last",o=Date.now();let c=!0;try{const d=localStorage.getItem(r);if(d){const m=JSON.parse(d),f=Number((m==null?void 0:m.at)||0);o-f<3e4&&(c=!1)}}catch{}if(c){await ys.send(e.uid,a);try{localStorage.setItem(r,JSON.stringify({at:o}))}catch{}}y({title:"ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",variant:"default"})}catch{y({title:"ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:"ØªØ¹Ø°Ù‘Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",variant:"destructive"})}},[Ag,ki]=u.useState(!1),[Vu,Ci]=u.useState(""),[Tg,Ii]=u.useState(!1),[Ll,Wl]=u.useState(""),[Pg,we]=u.useState(!1),[Mg,Fl]=u.useState(!1),ps=async(a,r=2,o=700)=>{let c;for(let d=0;d<=r;d++)try{return await a()}catch(m){if(c=m,d===r)break;await new Promise(f=>setTimeout(f,o*Math.pow(2,d)))}throw c};X.reduce((a,r)=>a+(Se[r.id]||0),0);const Og=async a=>await zt.verifyMasterPin(a,e==null?void 0:e.uid),_i=async a=>await zt.verifyMasterPin(a,e==null?void 0:e.uid);u.useEffect(()=>{if(e!=null&&e.uid){try{const a=st(),r=`walletBalances_${e.uid}`,o=localStorage.getItem(a)??localStorage.getItem(r);if(o){const c=JSON.parse(o);ut(c&&typeof c=="object"?c:{});try{localStorage.setItem(a,JSON.stringify(c||{}))}catch{}}}catch{}try{const a=Qe(),r=`cashBalance_${e.uid}`,o=`userCashBalance_${e.uid}`;let c=localStorage.getItem(a)??localStorage.getItem(r)??localStorage.getItem(o);if(c!=null){const d=parseFloat(c);at(Number.isFinite(d)?Math.round(d):0);try{localStorage.setItem(a,String(Number.isFinite(d)?Math.round(d):0)),localStorage.removeItem(r),localStorage.removeItem(o)}catch{}}}catch{}}},[e==null?void 0:e.uid,D,n==null?void 0:n.shopId]),u.useEffect(()=>{const a=r=>{var o;try{const c=Number((o=r==null?void 0:r.detail)==null?void 0:o.value);if(Number.isFinite(c))at(Math.round(c));else{const d=localStorage.getItem(Qe());d!=null&&at(Math.round(parseFloat(d))||0)}}catch{const c=localStorage.getItem(Qe());c!=null&&at(Math.round(parseFloat(c))||0)}};return window.addEventListener("cashBalanceChanged",a),()=>window.removeEventListener("cashBalanceChanged",a)},[e==null?void 0:e.uid,D,n==null?void 0:n.shopId]),u.useEffect(()=>{const a=D||(n==null?void 0:n.shopId);if(!(e!=null&&e.uid)||!a)return;const r=Ae(F,"dashboardData",a),o=an(r,c=>{var d;if(c.exists()){const m=c.data();console.log("ðŸ”„ Dashboard data updated in real-time:",m);const f=Math.round(Number((m==null?void 0:m.cashBalance)||0)),g=m!=null&&m.walletBalances&&typeof m.walletBalances=="object"?m.walletBalances:{};at(f),ut(g);try{if(localStorage.setItem(Qe(),String(f)),localStorage.setItem(st(),JSON.stringify(g)),m!=null&&m.lastUpdated){let w=String(m.lastUpdated);typeof((d=m.lastUpdated)==null?void 0:d.toDate)=="function"?w=m.lastUpdated.toDate().toISOString():m.lastUpdated instanceof Date&&(w=m.lastUpdated.toISOString()),localStorage.setItem(Qe()+"_lastUpdated",w),localStorage.setItem(st()+"_lastUpdated",w)}}catch(w){console.error("Error saving dashboard data to local storage:",w)}}},c=>{console.error("Error subscribing to dashboard data:",c)});return()=>o()},[e==null?void 0:e.uid,D,n==null?void 0:n.shopId]),u.useEffect(()=>{const a=D||(n==null?void 0:n.shopId);if(!(e!=null&&e.uid)||!a)return;const r=Ie(ce(F,"transactions"),q("shopId","==",a),Oi("createdAt","desc"),hm(1)),o=an(r,async c=>{if(!c.empty){console.log("ðŸ”„ New transaction detected via listener, IMMEDIATELY refreshing limits/balances..."),Ti();try{const d=Ae(F,"dashboardData",a),m=await fa(d);if(m.exists()){const f=m.data(),g=Math.round(Number((f==null?void 0:f.cashBalance)||0)),w=f!=null&&f.walletBalances&&typeof f.walletBalances=="object"?f.walletBalances:{};at(N=>N!==g?g:N),ut(N=>JSON.stringify(N)!==JSON.stringify(w)?w:N)}}catch(d){console.error("Error manual refresh of dashboard data:",d)}}});return()=>o()},[e==null?void 0:e.uid,D,n==null?void 0:n.shopId]);const qu=a=>`walletLimits_${(e==null?void 0:e.uid)||"default"}_${a||"none"}`,[Ai,Eg]=u.useState(null);u.useEffect(()=>{if(!L)return;const a=Ae(F,"walletLimits",String(L)),r=an(a,o=>{o.exists()&&(console.log("ðŸ”„ Wallet limits updated in real-time:",o.data()),Eg(o.data()))});return()=>r()},[L]),u.useEffect(()=>{if(L)try{const a=qu(L),r=localStorage.getItem(a);if(r&&!Ai){const o=JSON.parse(r);Hs(o)}if(Ai){const o=Ai,c={walletId:L,dailyTransferLimit:o.dailyTransferLimit??6e4,dailyWithdrawLimit:o.dailyWithdrawLimit??1e5,dailyTransferUsed:o.dailyTransferUsed??0,dailyWithdrawUsed:o.dailyWithdrawUsed??0,monthlyTransferLimit:o.monthlyTransferLimit??2e5,monthlyWithdrawLimit:o.monthlyWithdrawLimit??2e5,monthlyTransferUsed:o.monthlyTransferUsed??0,monthlyWithdrawUsed:o.monthlyWithdrawUsed??0};Hs(c);try{localStorage.setItem(qu(L),JSON.stringify(c))}catch{}}}catch{}},[L,Ai]),u.useEffect(()=>{if(!L)return;const a=X.find(r=>r.id===L);if(a!=null&&a.name){pu(String(a.name));try{localStorage.setItem(`walletName_${(e==null?void 0:e.uid)||"default"}_${L}`,String(a.name))}catch{}return}try{const r=localStorage.getItem(`walletName_${(e==null?void 0:e.uid)||"default"}_${L}`);r&&pu(String(r))}catch{}},[L,X]);const Ti=async()=>{try{if(!L)return;const a=await qa.autoResetLimitsIfNeeded(L);Hs(a)}catch(a){console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:",a)}};u.useEffect(()=>{Ti()},[L]),u.useEffect(()=>{const a=r=>{var o;(o=r==null?void 0:r.detail)!=null&&o.walletId&&r.detail.walletId===L&&Ti()};return window.addEventListener("walletLimitsUpdated",a),()=>window.removeEventListener("walletLimitsUpdated",a)},[L]),u.useEffect(()=>{const a=r=>{var o;try{const c=String(((o=r==null?void 0:r.detail)==null?void 0:o.walletId)||"");c&&Qr(c,"sms:auto")}catch{}};return window.addEventListener("walletSelection:update",a),()=>window.removeEventListener("walletSelection:update",a)},[X]),u.useEffect(()=>{if(h.state){if(console.log("Location state:",h.state),h.state.openDebtDialog&&(al(),window.history.replaceState({},document.title)),h.state.openSalesDialog&&(Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Or(!0),window.history.replaceState({},document.title)),h.state.openMaintenanceDialog&&(Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„ØµÙŠØ§Ù†Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Qn(!0),window.history.replaceState({},document.title)),h.state.openCreditCardsDialog&&(console.log("Opening credit cards dialog"),Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙƒØ±ÙˆØª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù† ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Hn(!0),window.history.replaceState({},document.title)),h.state.openShopExpensesDialog&&(Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Gc&&zt.hasMasterPin()?wr(!0):Ts(!0),window.history.replaceState({},document.title)),h.state.openDeficienciesDialog&&(Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):jr(!0),window.history.replaceState({},document.title)),h.state.openInstallment&&(Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ· ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Wr(!0),window.history.replaceState({},document.title)),h.state.openTransactionSection){const a=document.getElementById("transaction-section");a&&a.scrollIntoView({behavior:"smooth"}),h.state.transactionType&&Oo(h.state.transactionType),h.state.startNewTransaction&&(Ir(""),Ls(""),Wn(""),Fn(""),console.log("ðŸ”’ Starting new transaction without changing wallet selection")),h.state.focusWalletSelection&&setTimeout(()=>{const r=document.querySelector('[data-testid="wallet-select"]');r&&r.focus()},500),window.history.replaceState({},document.title)}h.state.openCashierShiftModal&&(!ma||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ÙƒØ§Ø´ÙŠØ± Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):Dn(!0),window.history.replaceState({},document.title)),h.state.openMachineDailyDialog&&(!ma||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):Gn(!0),window.history.replaceState({},document.title)),h.state.openBranchManagement&&((Dt==null?void 0:Dt.status)==="active"?gr(!0):pr(!0),window.history.replaceState({},document.title)),h.state.openMyClientNumbersDialog&&(On(!0),window.history.replaceState({},document.title)),h.state.openPendingOperationsDialog&&(re(!0),window.history.replaceState({},document.title))}},[h.state,X,Le,Dt]),u.useEffect(()=>{h.pathname==="/user/dashboard"&&sessionStorage.getItem("previousPath")==="/user/add-wallet"&&(console.log("ðŸ”„ Returned from wallet addition page - reloading wallets"),Bl(),sessionStorage.removeItem("previousPath")),sessionStorage.setItem("previousPath",h.pathname)},[h.pathname,e==null?void 0:e.uid]),u.useEffect(()=>{if(!(e!=null&&e.uid))return;(async()=>{try{const r=Ae(F,"users",e.uid),o=await fa(r);if(o.exists()){const d=o.data().isActive===!0;d&&!br?(Ya(!0),za(!1),vr(!1)):!d&&br&&(Ya(!1),za(!0))}}catch(r){console.error("Check user status error",r)}})()},[e==null?void 0:e.uid]),u.useEffect(()=>{if(!(e!=null&&e.uid))return;const a=o=>{const{userId:c}=o.detail;c===e.uid&&(console.log("ðŸŽ‰ Subscription activation event received for current user!"),Ya(!0),za(!1),vr(!1),setTimeout(()=>{console.log("âœ… User activation completed - data updated")},1e3))},r=o=>{const c=o.detail||{},{userId:d,isActive:m}=c;d&&d===e.uid&&(console.log("ðŸ”„ User subscription update event received:",{userId:d,isActive:m}),m&&!br&&(Ya(!0),za(!1),vr(!1),setTimeout(()=>{console.log("âœ… User subscription updated - data refreshed")},1e3)))};return window.addEventListener("subscriptionActivated",a),window.addEventListener("userSubscriptionUpdated",r),()=>{window.removeEventListener("subscriptionActivated",a),window.removeEventListener("userSubscriptionUpdated",r)}},[e==null?void 0:e.uid,br]),u.useEffect(()=>{const a=r=>{var m;const o=r.target,c=(m=o==null?void 0:o.tagName)==null?void 0:m.toLowerCase();if(!(c==="input"||c==="textarea"||c==="select"||((o==null?void 0:o.isContentEditable)??!1))&&!(r.ctrlKey||r.altKey||r.metaKey)&&!r.repeat){if((Pe||Le)&&r.key>="1"&&r.key<="9"){r.preventDefault();return}switch(r.key){}}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[Pe,Le,ma]),u.useEffect(()=>{console.log("ðŸ”¥ useEffect loadUserData started",{user:e==null?void 0:e.uid,isCheckingActivation:go}),(async()=>{try{if(!(e!=null&&e.uid)){console.log("ðŸ”¥ No user UID, setting isCheckingActivation to false"),vr(!1);return}try{const m=await fa(Ae(F,"users",e.uid));if(m.exists()){const g=m.data().isActive===!0,w=await Dm.checkTrialValidity(e.uid),N=w.isValid&&!w.isExpired;Ya(g||N),nd(N),id(w.hoursRemaining),od(w.hasUsedTrial),za(!g&&!N),console.log("ðŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",{isActive:g,isOnTrial:N,hoursRemaining:w.hoursRemaining,hasUsedTrial:w.hasUsedTrial})}else Ya(!1),za(!0)}catch(m){console.error("Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø­Ø§Ù„Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",m),Ya(!1),za(!0)}finally{vr(!1)}if(console.log("ðŸ”„ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firebase...",{userId:e==null?void 0:e.uid}),e!=null&&e.uid){const m=await ps(()=>ae.getUserData(e.uid)),f=`userData_${e==null?void 0:e.uid}`;let g=null;try{const w=localStorage.getItem(f);w&&(g=JSON.parse(w))}catch{}if(m){let w=(m==null?void 0:m.walletBalances)||{},N=m==null?void 0:m.cashBalance;const x=m.lastUpdated?new Date(m.lastUpdated).getTime():0;g&&(g.lastUpdated?new Date(g.lastUpdated).getTime():0)>=x&&(g.walletBalances&&(w=g.walletBalances),g.cashBalance!==void 0&&(N=g.cashBalance));try{const v=Qe(),j=st(),S=localStorage.getItem(v+"_lastUpdated"),_=localStorage.getItem(j+"_lastUpdated"),O=S?new Date(S).getTime():0,A=_?new Date(_).getTime():0;if(O>x){const P=localStorage.getItem(v);P!==null&&(N=parseFloat(P))}if(A>x){const P=localStorage.getItem(j);if(P!==null)try{w=JSON.parse(P)}catch{}}}catch(v){console.error("Error checking individual keys fallback:",v)}ut(w),N!==void 0&&at(N);try{const v=e!=null&&e.uid?await ps(()=>un.getDeletedTransactionsByUser(e.uid)):[];Rr(v||[])}catch{Rr([])}}else{ut({});try{const w=e!=null&&e.uid?await un.getDeletedTransactionsByUser(e.uid):[];Rr(w||[])}catch{Rr([])}}}console.log("ðŸ”„ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase...");try{const m=await ps(()=>Bi.getByMerchantId((e==null?void 0:e.uid)||""));if(m&&m.length>0){console.log("âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",m.length);const f=m.filter(v=>v.isActive===!0),g=f.map(v=>({id:v.id,name:v.label||"Ù…Ø­ÙØ¸Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",phone:v.msisdn,isDefault:!1,monthlyWithdrawalLimit:v.monthlyWithdrawalLimit??v.withdrawLimit??2e5,monthlyTransferLimit:v.monthlyTransferLimit??v.transferLimit??2e5,defaultTransferCommission:v.defaultTransferCommission!=null?Number(v.defaultTransferCommission):null,defaultWithdrawCommission:v.defaultWithdrawCommission!=null?Number(v.defaultWithdrawCommission):null,ownerName:v.ownerName,nationalId:v.nationalId,providerName:v.provider}));Cs(g);const w={};f.forEach(v=>{v.balance!==void 0&&(w[v.id]=Number(v.balance))}),Object.keys(w).length>0&&ut(v=>({...v,...w}));const N=localStorage.getItem(fs());let x=null;N&&g.find(v=>v.id===N)?x=g.find(v=>v.id===N):x=g[0],x&&(yr(x.id),Rs(x.phone)),console.log("ðŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase ÙˆØ­ÙØ¸Ù‡Ø§ ÙÙŠ localStorage")}else console.log("âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase. Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© ÙØ§Ø±ØºØ© Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ù…Ø­Ù„ÙŠ."),Cs([])}catch(m){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase:",m),Cs([])}const d=e!=null&&e.uid?await ps(()=>ae.getUserTransactions(e.uid)):[];if(d&&d.length>0){console.log("ðŸ“Š ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù…Ù† Firebase:",d.length);const m=d.map(x=>({...x,createdAt:new Date(x.createdAt),senderPhone:x.senderMsisdn||x.senderPhone||"",receiverPhone:x.receiverMsisdn||x.receiverPhone||"",type:x.txnType==="send"?"send":x.txnType==="receive"?"withdraw":x.type||"withdraw",status:x.status==="confirmed"?"completed":x.status||"completed"})),f=Er.map(x=>x.id||x.originalTransactionId);let g=[];try{const x=Ie(ce(F,"deletedTransactions"),q("userId","==",(e==null?void 0:e.uid)||""),q("permanent","==",!0));g=(await ve(x)).docs.map(j=>{const S=j.data();return String(S.originalTransactionId||S.transactionId||j.id||"")}).filter(Boolean)}catch{}const w=new Set(g),N=m.filter(x=>{var A;const v=String(x.id||""),j=String(x.transactionId||""),S=String(x.reference||x.transactionReference||((A=x.receipt)==null?void 0:A.reference)||""),_=f.includes(v),O=w.has(v)||j&&w.has(j);return!_&&!O});console.log("âœ… ØªÙ… ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©:",{total:d.length,deleted:f.length,active:N.length});{const x=new Set,v=[];for(const j of N){const S=Tl(j);x.has(S)||(x.add(S),v.push(j))}df||Vt(v)}}await Lu()}catch(d){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firebase:",d)}})().then(async()=>{await c(),await r(),await o()});const r=async()=>{try{if(!(e!=null&&e.uid))return;const d=await Bi.getByMerchantId(e.uid);await Promise.all(d.map(m=>gw.autoResetLimitsIfNeeded(m.id)))}catch(d){console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯:",d)}},o=async()=>{try{await At.syncReportsDataFromFirebase(e==null?void 0:e.uid);const d=At.getReportsData(e==null?void 0:e.uid);if((d.lastDailyResetDate?At.shouldResetDailyReports(d.lastDailyResetDate):!1)&&(e!=null&&e.uid)&&d.lastDailyResetDate){const g=new Date(d.lastDailyResetDate),w=g.toDateString(),N=ge.filter(A=>new Date(A.createdAt).toDateString()===w&&A.status==="completed"),x=N.length,v=N.reduce((A,P)=>A+P.amount,0),j=N.filter(Gr).reduce((A,P)=>{const U=P.withdrawnAmount!==void 0?P.withdrawnAmount:P.amount;return A+U},0),S=N.filter(Xr).reduce((A,P)=>{const U=P.sentAmount!==void 0?P.sentAmount:P.amount;return A+U},0),_=N.reduce((A,P)=>A+At.calculateTransactionProfit(P),0),O=new Date(g).toISOString().slice(0,10);await tr.add({userId:e.uid,reportDate:O,totalTransactions:x,totalAmount:Math.round(v),totalWithdrawn:Math.round(j),totalSent:Math.round(S),profit:Math.round(_),walletId:null})}const f=At.autoResetReportsIfNeeded(e==null?void 0:e.uid);(f.dailyReset||f.monthlyReset)&&console.log("ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ:",f)}catch(d){console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ØªÙ‚Ø§Ø±ÙŠØ±:",d)}},c=async()=>{try{if(!(e!=null&&e.uid))return;const d=new Date;if(d.getDate()!==1)return;const m=`${d.getFullYear()}-${d.getMonth()+1}`,f=`lastMonthlyDbCleanup:${e.uid}`;if(localStorage.getItem(f)===m)return;const w=new Date(d.getFullYear(),d.getMonth(),1,0,0,0,0),N=j=>j instanceof Date?j:typeof(j==null?void 0:j.toDate)=="function"?j.toDate():new Date(String(j));let x=[];try{const j=Ie(ce(F,"userTransactions"),q("userId","==",e.uid),q("createdAt","<",w));x=(await ve(j)).docs}catch{const j=Ie(ce(F,"userTransactions"),q("userId","==",e.uid));x=(await ve(j)).docs.filter(_=>{var O;return N((O=_.data())==null?void 0:O.createdAt)<w})}await Promise.allSettled(x.map(j=>fm(j.ref)));let v=[];try{const j=Ie(ce(F,"transactions"),q("userId","==",e.uid),q("createdAt","<",w));v=(await ve(j)).docs}catch{const j=Ie(ce(F,"transactions"),q("userId","==",e.uid));v=(await ve(j)).docs.filter(_=>{var O;return N((O=_.data())==null?void 0:O.createdAt)<w})}await Promise.allSettled(v.map(j=>fm(j.ref)));try{localStorage.setItem(f,m)}catch{}console.log("âœ… ØªÙ… ØªÙ†Ø¸ÙŠÙ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ù‡Ø±ÙŠÙ‹Ø§ (Firebase ÙÙ‚Ø·):",{userTransactionsDeleted:x.length,globalTransactionsDeleted:v.length,monthStart:w})}catch(d){console.error("ÙØ´Ù„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:",d)}};sg(),xl(),xg(),console.log("ðŸ”¥ useEffect loadUserData completed")},[e==null?void 0:e.uid]),u.useEffect(()=>{if(!(e!=null&&e.uid))return;const a=ae.subscribeToUserTransactions(e.uid,r=>{if(!r||r.length===0)return;const o=r.map(c=>({...c,createdAt:new Date(c.createdAt),senderPhone:c.senderMsisdn||c.senderPhone||"",receiverPhone:c.receiverMsisdn||c.receiverPhone||"",type:c.txnType==="send"?"send":c.txnType==="receive"?"withdraw":c.type||"withdraw",status:c.status==="confirmed"?"completed":c.status||"completed"}));Vt(c=>{const d=[...o,...c],m=new Set,f=[];for(const g of d){const w=Tl(g);m.has(w)||(m.add(w),f.push(g))}return f.sort((g,w)=>{const N=g.createdAt instanceof Date?g.createdAt.getTime():new Date(g.createdAt).getTime();return(w.createdAt instanceof Date?w.createdAt.getTime():new Date(w.createdAt).getTime())-N})})},30);return()=>a()},[e==null?void 0:e.uid]),u.useEffect(()=>{const a=D||(n==null?void 0:n.shopId);if(!a)return;const r=ae.subscribeToDashboardData(a,o=>{if(!o)return;const c=Number(o.cashBalance||0);at(c);const d=o.walletBalances&&typeof o.walletBalances=="object"?o.walletBalances:{};ut(d);try{if(localStorage.setItem(Qe(),String(c)),localStorage.setItem(st(),JSON.stringify(d)),o.lastUpdated){const m=String(o.lastUpdated);localStorage.setItem(Qe()+"_lastUpdated",m),localStorage.setItem(st()+"_lastUpdated",m)}}catch(m){console.error("Error saving real-time dashboard data to local storage",m)}});return()=>r()},[D,n==null?void 0:n.shopId]);const Bl=async()=>{var a;if(e!=null&&e.uid)try{const r=await ps(()=>Bi.getByMerchantId(e.uid));if(r&&r.length>0){const c=r.filter(d=>d.isActive===!0).map(d=>({id:d.id,name:d.label||"Ù…Ø­ÙØ¸Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",phone:d.msisdn,isDefault:!1,monthlyWithdrawalLimit:d.monthlyWithdrawalLimit??d.withdrawLimit??2e5,monthlyTransferLimit:d.monthlyTransferLimit??d.transferLimit??2e5,defaultTransferCommission:d.defaultTransferCommission!=null?Number(d.defaultTransferCommission):void 0,defaultWithdrawCommission:d.defaultWithdrawCommission!=null?Number(d.defaultWithdrawCommission):void 0}));if(Cs(c),e!=null&&e.uid){const d=localStorage.getItem(fs());if(!!(L&&c.find(f=>f.id===L)))console.log("ðŸ”’ Preserving current wallet selection:",L);else{const g=(d&&c.find(w=>w.id===d)?d:null)||((a=c[0])==null?void 0:a.id);g&&(console.log("ðŸ”„ Fixing invalid wallet selection:",g),Qr(g))}}console.log("ðŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase:",c.length)}}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase:",r)}};u.useEffect(()=>{const a=h.pathname;if(sessionStorage.getItem("previousPath")==="/user/add-wallet"&&a==="/user/dashboard"){E.invalidateQueries({queryKey:["wallets",e==null?void 0:e.uid]});try{Vn.refetch()}catch{}sessionStorage.removeItem("previousPath")}sessionStorage.setItem("previousPath",a)},[h.pathname,e==null?void 0:e.uid]),u.useEffect(()=>{const a=()=>{E.invalidateQueries({queryKey:["wallets",e==null?void 0:e.uid]});try{Vn.refetch()}catch{}};return window.addEventListener("focus",a),()=>{window.removeEventListener("focus",a)}},[e==null?void 0:e.uid,L,X]);const Qr=async(a,r="unknown")=>{console.log(`ðŸŽ¯ setWalletSelection called from ${r} with walletId:`,a),console.log("ðŸ” Previous selectedWallet:",L),yr(a);const o=X.find(c=>c.id===a);if(o&&(Rs(o.phone),console.log("âœ… Wallet set successfully:",a,"Phone:",o.phone)),e!=null&&e.uid){localStorage.setItem(fs(),a),console.log("ðŸ’¾ Saved wallet to localStorage:",a);try{await sn.set({key:"selected_wallet_id",value:a}),await sn.set({key:"current_user_id",value:e.uid}),console.log("ðŸ“± Saved wallet and user ID to Capacitor Preferences:",a,e.uid)}catch(c){console.error("âŒ Failed to save to Capacitor Preferences:",c)}}};u.useEffect(()=>{const a=()=>{Bl()};try{window.addEventListener("wallets:activation-updated",a)}catch{}return()=>{try{window.removeEventListener("wallets:activation-updated",a)}catch{}}},[e==null?void 0:e.uid]);const Rg=a=>{if(a==="__add_wallet"){p("/user/add-wallet");return}if(a==="__view_wallets"){Ln(!0);return}Hp.isEnabled(e==null?void 0:e.uid)?(To(a),Ao(!0)):Qr(a,"walletSelectionNoPin")},Pi=a=>{console.log("ðŸ”„ handleTransactionTypeChange called with type:",a),console.log("ðŸ” Current selectedWallet before change:",L),console.log("ðŸ” Available wallets count:",X.length),Oo(a),Ir(""),Ls(""),Wn(""),Fn(""),console.log("âœ… Transaction type changed to:",a,"- Wallet selection preserved:",L),setTimeout(()=>{const r=document.getElementById("transaction-section");r&&r.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)};u.useEffect(()=>{const a=r=>{const o=r.target;if(!!o&&(o.tagName==="INPUT"||o.tagName==="TEXTAREA"||o.tagName==="SELECT"||o.isContentEditable)||(r.key==="ArrowLeft"?(r.preventDefault(),Pi("withdraw")):r.key==="ArrowRight"&&(r.preventDefault(),Pi("transfer"))),r.key==="Enter"){if(document.querySelector('[role="dialog"]'))return;const d=B==="transfer"?"transferSubmitButton":"withdrawSubmitButton",m=document.getElementById(d);m&&!m.disabled&&(r.preventDefault(),m.click())}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[B]);const Yu=a=>{of((o=>{const c=String(o.description||""),d=String(o.title||""),m=c.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡")||c.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||c.includes("machine transfer")||d.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡")||d.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡"),f=String((o==null?void 0:o.provider)||"").toLowerCase(),g=f.includes("vodafone")?"vf-cash":f.includes("instapay")?"instapay":"",w=o.type==="send"?"ØªØ­ÙˆÙŠÙ„":"Ø³Ø­Ø¨";let N=o.type==="withdraw"&&g?`${w} ${g}`:w;return m?N="ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡":o.title&&(N=o.title),{id:o.id,type:m||o.type==="send"||o.type==="transfer"?"transfer":"withdraw",sender_msisdn:o.senderPhone,receiver_msisdn:o.receiverPhone,amount:o.amount,commission:o.commission||0,fee:(o==null?void 0:o.fee)??0,status:o.status==="failed"?"failed":o.status==="completed"?"completed":"pending",createdAt:new Date(o.createdAt).toISOString(),updatedAt:new Date(o.createdAt).toISOString(),shopName:T??(n==null?void 0:n.shopName)??(e==null?void 0:e.displayName)??"Ø§Ù„Ù…Ø­Ù„",cashierName:(o==null?void 0:o.cashierName)??null,commissionMode:(o==null?void 0:o.commissionMode)??(o.type==="send"||Ge?"add":"deduct"),totalCharged:(o==null?void 0:o.totalCharged)??(o.type==="send"?Number(o.amount||0)+Number(o.commission||0)+Number((o==null?void 0:o.fee)||0):Ge?Number(o.amount||0)+Number(o.commission||0):Number(o.amount||0)),note:(o==null?void 0:o.note)??(o==null?void 0:o.notes)??void 0,senderName:(o==null?void 0:o.senderName)??void 0,provider:(o==null?void 0:o.provider)??void 0,title:N,description:(o==null?void 0:o.description)??void 0}})(a)),qn(!0)},$l=async a=>{var d;if(!(e!=null&&e.uid)){y({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©",description:"ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª",variant:"destructive"});return}const r=ge.find(m=>m.id===a);if(!r){y({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù",description:"Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø­Ø°ÙÙ‡Ø§",variant:"destructive"});return}const o=String(a),c=String((r==null?void 0:r.transactionId)||(r==null?void 0:r.reference)||"");va.current.add(o),c&&va.current.add(c);try{console.log("ðŸ—‘ï¸ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©:",a),console.log("ðŸ”„ Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Firebase...",{transactionId:r.id,userId:e.uid,transactionData:r}),await ae.removeUserTransaction(e.uid,r.id),console.log("âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Firebase userTransactions");try{await un.saveDeletedTransaction({...r,userId:e.uid,originalTransactionId:r.id,transactionId:r.transactionId||r.id,reference:r.reference||r.transactionReference||((d=r.receipt)==null?void 0:d.reference),deletedAt:new Date().toISOString(),permanent:!0}),console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§Øª Ù…Ø¹ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø°Ù")}catch(g){console.warn("âš ï¸ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§ØªØŒ Ù„ÙƒÙ† Ø§Ù„Ø­Ø°Ù Ù…Ù† Firebase Ù†Ø¬Ø­:",g)}try{await un.permanentlyDeleteTransaction(r.id,e.uid)}catch(g){console.warn("âš ï¸ ÙØ´Ù„ ÙˆØ³Ù… Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø£Ùˆ Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ:",g)}const m=[...Er,r],f=ge.filter(g=>g.id!==a);Rr(m),Vt(f),Cd(!1),console.log("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù Ù…Ù† Firebase (Ø¨Ø¯ÙˆÙ† Ù†Ø³Ø® Ù…Ø­Ù„ÙŠØ©)");try{const g=r.walletId||r.fromWallet;try{const w=await ae.getUserData(e.uid),N={...(w==null?void 0:w.walletBalances)||{}},x=Number((w==null?void 0:w.cashBalance)||0);if(g&&N[g]!==void 0){const v=Number(r.amount||0),j=Number(r.commission||0),S=(r.type||"").toLowerCase(),_=S==="send"||S==="transfer";let O=x,A=Number(N[g]);console.log("ðŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø£Ø±ØµØ¯Ø©...",{type:S,amount:v,commission:j,currentCash:x,walletBalance:A}),_?(A+=v,O=O-v-j):(A-=v,O=O+v-j),N[g]=A,await ae.updateUserData(e.uid,{walletBalances:N,cashBalance:O,lastUpdated:new Date().toISOString()}),console.log("âœ… ØªÙ… Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ù„Ù…Ø­ÙØ¸Ø© ÙˆØ¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©",{newCash:O,newWalletBalance:A})}}catch(w){console.warn("âš ï¸ ÙØ´Ù„ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø£Ø±ØµØ¯Ø©:",w)}if(g){const{walletDailyLimitsService:w}=await ne(async()=>{const{walletDailyLimitsService:x}=await import("./index-CgV0sHeM.js").then(v=>v.cY);return{walletDailyLimitsService:x}},__vite__mapDeps([0,1]),import.meta.url),N=await w.getWalletLimits(g);if(N){const x=r.type==="send",v={updatedAt:(await ne(async()=>{const{serverTimestamp:A}=await import("./index-CgV0sHeM.js").then(P=>P.cP);return{serverTimestamp:A}},__vite__mapDeps([0,1]),import.meta.url)).serverTimestamp()};x?(v.dailyTransferUsed=Math.max(0,(N.dailyTransferUsed||0)-r.amount),v.monthlyTransferUsed=Math.max(0,(N.monthlyTransferUsed||0)-r.amount)):(v.dailyWithdrawUsed=Math.max(0,(N.dailyWithdrawUsed||0)-r.amount),v.monthlyWithdrawUsed=Math.max(0,(N.monthlyWithdrawUsed||0)-r.amount));const{doc:j,setDoc:S}=await ne(async()=>{const{doc:A,setDoc:P}=await import("./index-CgV0sHeM.js").then(U=>U.cP);return{doc:A,setDoc:P}},__vite__mapDeps([0,1]),import.meta.url),{db:_}=await ne(async()=>{const{db:A}=await import("./index-CgV0sHeM.js").then(P=>P.cQ);return{db:A}},__vite__mapDeps([0,1]),import.meta.url),O=j(_,"walletLimits",g);await S(O,v,{merge:!0}),console.log("âœ… ØªÙ… Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©")}}}catch(g){console.warn("ÙØ´Ù„ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù:",g)}try{const{ReportsService:g}=await ne(async()=>{const{ReportsService:w}=await import("./index-CgV0sHeM.js").then(N=>N.cX);return{ReportsService:w}},__vite__mapDeps([0,1]),import.meta.url);g.removeTransactionEffects(r,e.uid)}catch(g){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù:",g)}y({title:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„ÙŠÙ‡Ø§ ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§Øª"})}catch(m){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† Firebase:",m);let f="ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";m instanceof Error&&(m.message.includes("network")||m.message.includes("offline")?f="Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰":m.message.includes("permission")||m.message.includes("unauthorized")?f="Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©":m.message.includes("not-found")&&(f="Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© Ø£Ùˆ ØªÙ… Ø­Ø°ÙÙ‡Ø§ Ù…Ø³Ø¨Ù‚Ø§Ù‹")),y({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù",description:f,variant:"destructive"})}},Gr=a=>{const r=(a.type||"").toLowerCase(),o=(a.txnType||"").toLowerCase();return r==="withdraw"||r==="withdrawal"||r==="receive"||o==="receive"},Xr=a=>{const r=(a.type||"").toLowerCase(),o=(a.txnType||"").toLowerCase();return r==="send"||r==="transfer"||o==="send"},zu=a=>a.title==="Ø¥ÙŠØµØ§Ù„ Ø³Ø­Ø¨ ÙÙˆØ±ÙŠ",Mi=a=>{const r=(a.type||"").toLowerCase(),o=(a.txnType||"").toLowerCase(),c=String(a.title||"");return r==="sales"||o==="sales"||c.includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||c.includes("Ù…Ø¨ÙŠØ¹Ø§Øª")},Ku=(a,r)=>{const o=new Date().toDateString(),c=Array.isArray(Zr==null?void 0:Zr.data)?Zr.data:[],d=new Map;for(const j of ge)j!=null&&j.id&&d.set(String(j.id),j);for(const j of c)j!=null&&j.id&&!d.has(String(j.id))&&d.set(String(j.id),j);let f=Array.from(d.values()).filter(j=>{const S=new Date(j.createdAt).toDateString()===o,_=String(j.status||"").toLowerCase();return S&&(_==="completed"||_==="confirmed"||_==="pending")});wa&&wa.trim()!==""&&(f=f.filter(j=>j.senderPhone&&j.senderPhone.includes(wa)||j.receiverPhone&&j.receiverPhone.includes(wa)));const g=At.filterVisibleTransactions(f,"daily",e==null?void 0:e.uid),w=g.length,N=g.reduce((j,S)=>j+S.amount,0),x=g.filter(j=>Gr(j)&&!Mi(j)).reduce((j,S)=>{const _=S.withdrawnAmount!==void 0?S.withdrawnAmount:S.amount;return j+_},0),v=g.filter(j=>Xr(j)&&!zu(j)&&!Mi(j)).reduce((j,S)=>{const _=S.sentAmount!==void 0?S.sentAmount:S.amount;return j+_},0);return{totalTransactions:w,totalAmount:N,totalWithdrawn:x,totalSent:v}},Lg=(a,r)=>{const o=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),c=o.format(new Date),[d,m]=c.split("-"),f=Number(d),g=Number(m);let w=a.filter(_=>{var Je;const O=(Je=_.createdAt)!=null&&Je.toDate?_.createdAt.toDate():new Date(_.createdAt),A=String(_.status||"completed").toLowerCase(),P=o.format(O),[U,te]=P.split("-"),H=Number(U),De=Number(te);return H===f&&De===g&&(A==="completed"||A==="confirmed")});wa&&wa.trim()!==""&&(w=w.filter(_=>_.senderPhone&&_.senderPhone.includes(wa)||_.receiverPhone&&_.receiverPhone.includes(wa)));const N=At.filterVisibleTransactions(w,"monthly",e==null?void 0:e.uid),x=N.length,v=N.reduce((_,O)=>_+Number(O.amount||0),0),j=N.filter(_=>Gr(_)&&!Mi(_)).reduce((_,O)=>{const A=O.withdrawnAmount!==void 0?Number(O.withdrawnAmount):Number(O.amount||0);return _+A},0),S=N.filter(_=>Xr(_)&&!zu(_)&&!Mi(_)).reduce((_,O)=>{const A=O.sentAmount!==void 0?Number(O.sentAmount):Number(O.amount||0);return _+A},0);return{totalTransactions:x,totalAmount:v,totalWithdrawn:j,totalSent:S}},Wg=a=>{const r=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),o=r.format(new Date),[c,d]=o.split("-"),m=Number(c),f=Number(d),g=ge.filter(x=>{var P;const v=(P=x.createdAt)!=null&&P.toDate?x.createdAt.toDate():new Date(x.createdAt),j=r.format(v),[S,_]=j.split("-"),O=Number(S),A=Number(_);return O===m&&A===f&&x.status==="completed"&&x.fromWallet===a}),w=g.filter(Gr).reduce((x,v)=>{const j=v.withdrawnAmount||v.amount;return x+j},0),N=g.filter(Xr).reduce((x,v)=>{const j=v.sentAmount||v.amount;return x+j},0);return{totalWithdrawn:w,totalTransferred:N}},Fg=a=>{const r=new Date,o=r.getDate(),c=r.getMonth(),d=r.getFullYear(),m=ge.filter(w=>{const N=new Date(w.createdAt);return N.getDate()===o&&N.getMonth()===c&&N.getFullYear()===d&&w.status==="completed"&&w.fromWallet===a}),f=m.filter(Gr).reduce((w,N)=>{const x=N.withdrawnAmount||N.amount;return w+x},0),g=m.filter(Xr).reduce((w,N)=>{const x=N.sentAmount||N.amount;return w+x},0);return{totalWithdrawn:f,totalTransferred:g}},Bg=K.useMemo(()=>{const a=new Date;return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`},[]),Ul=mn({enabled:!!(e!=null&&e.uid),queryKey:["monthRangeTransactions",e==null?void 0:e.uid,Bg],queryFn:async()=>{const a=new Date,r=new Date(a.getFullYear(),a.getMonth(),1,0,0,0,0),o=new Date(a.getFullYear(),a.getMonth()+1,0,23,59,59,999);return(await ae.getUserTransactionsForDateRange(String((e==null?void 0:e.uid)||""),r,o)).map(d=>{var j;const m=(j=d.createdAt)!=null&&j.toDate?d.createdAt.toDate():new Date(d.createdAt),f=String(d.transactionType||d.txnType||d.type||"").toLowerCase();let g="send";f==="withdraw"||f==="receive"?g="withdraw":f==="machine_withdrawal"?g="machine_withdrawal":f==="cash_addition"||f==="add"?g="cash_addition":g="send";const w=d.status==="confirmed"?"completed":d.status||"completed",N=d.senderMsisdn||d.senderPhone||"",x=d.receiverMsisdn||d.receiverPhone||"",v=Number(d.amount??d.transferredAmount??d.withdrawnAmount??0);return{...d,type:g,status:w,senderPhone:N,receiverPhone:x,amount:v,createdAt:m}})},staleTime:6e4,gcTime:3e5,refetchOnWindowFocus:!1,refetchOnReconnect:!0}),Zr=mn({enabled:!!(e!=null&&e.uid),queryKey:["dayRangeTransactions",e==null?void 0:e.uid,(()=>{const a=new Date;return`${a.getFullYear()}-${a.getMonth()+1}-${a.getDate()}`})()],queryFn:async()=>{const a=new Date,r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),o=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999);return(await ae.getUserTransactionsForDateRange(String((e==null?void 0:e.uid)||""),r,o)).map(d=>{var j;const m=(j=d.createdAt)!=null&&j.toDate?d.createdAt.toDate():new Date(d.createdAt),f=String(d.transactionType||d.txnType||d.type||"").toLowerCase();let g="send";f==="withdraw"||f==="receive"?g="withdraw":f==="machine_withdrawal"?g="machine_withdrawal":f==="cash_addition"||f==="add"?g="cash_addition":g="send";const w=d.status==="confirmed"?"completed":d.status||"completed",N=d.senderMsisdn||d.senderPhone||"",x=d.receiverMsisdn||d.receiverPhone||"",v=Number(d.amount??d.transferredAmount??d.withdrawnAmount??0);return{...d,type:g,status:w,senderPhone:N,receiverPhone:x,amount:v,createdAt:m}})},staleTime:3e4,gcTime:18e4,refetchOnWindowFocus:!1,refetchOnReconnect:!0}),Qs=K.useMemo(()=>{const a=Array.isArray(Ul.data)?Ul.data:[],r=new Map;for(const c of a)c!=null&&c.id&&r.set(String(c.id),c);for(const c of ge)c!=null&&c.id&&r.set(String(c.id),c);const o=Array.from(r.values());return Lg(o)},[Ul.data,ge,L,wa]),en=K.useMemo(()=>Ku(),[ge,Zr.data,L,wa,e==null?void 0:e.uid]);Qs.totalWithdrawn,Qs.totalSent;const Ra=K.useMemo(()=>Wg(L),[ge,L]),$g=K.useMemo(()=>Fg(L),[ge,L]),Gs=K.useMemo(()=>{try{return JSON.parse(localStorage.getItem(_u())||"[]")}catch{return[]}},[e==null?void 0:e.uid]),[Ug,Vl]=u.useState(!1),[Vg,Ju]=u.useState(!1),[qg,Hu]=u.useState(!1),Yg=()=>{const a=new Date,r=a.getFullYear(),o=String(a.getMonth()+1).padStart(2,"0"),c=String(a.getDate()).padStart(2,"0");return`${r}-${o}-${c}`},zg=async()=>{try{if(!(e!=null&&e.uid)){y({title:"ØªØ¹Ø°Ø± Ø§Ù„ØªÙ‚ÙÙŠÙ„",description:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",variant:"destructive"});return}const a=e.uid,r=Yg(),o=new Date().toDateString(),d=ge.filter(v=>{const j=new Date(v.createdAt).toDateString()===o,S=String(v.status||"").toLowerCase();return j&&(S==="completed"||S==="confirmed")}).reduce((v,j)=>v+Number(At.calculateTransactionProfit(j)||0),0);let m=0;try{const v=ce(F,"users",a,"dailySales");(await ve(Ie(v,q("date","==",r)))).forEach(S=>{const _=S.data(),O=Number(_.quantity||1),A=Number(_.sellingPrice||_.price||0);m+=A*O})}catch{}let f=0;try{(await ve(Ie(ce(F,"debts"),q("userId","==",a)))).forEach(j=>{var O,A;const S=j.data(),_=((A=(O=S==null?void 0:S.createdAt)==null?void 0:O.toDate)==null?void 0:A.call(O))||((S==null?void 0:S.createdAt)instanceof Date?S.createdAt:new Date(S==null?void 0:S.createdAt));_&&_.toDateString()===o&&(f+=Number(S.amount||0))})}catch{try{(await ve(ce(F,"users",a,"debts"))).forEach(j=>{var O,A;const S=j.data(),_=((A=(O=S==null?void 0:S.createdAt)==null?void 0:O.toDate)==null?void 0:A.call(O))||((S==null?void 0:S.createdAt)instanceof Date?S.createdAt:new Date(S==null?void 0:S.createdAt));_&&_.toDateString()===o&&(f+=Number(S.amount||0))})}catch{}}let g=0;try{const v=Ie(ce(F,"maintenance_items"),q("userId","==",a));(await ve(v)).forEach(S=>{var te,H;const _=S.data();if(String(_.status||"").toLowerCase()!=="completed")return;const A=((H=(te=_==null?void 0:_.completedAt)==null?void 0:te.toDate)==null?void 0:H.call(te))||((_==null?void 0:_.completedAt)instanceof Date?_.completedAt:new Date((_==null?void 0:_.completedAt)||(_==null?void 0:_.createdAt))),P=A?new Date(A.getFullYear(),A.getMonth(),A.getDate()):null,U=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate());if(P&&P.getTime()===U.getTime()){const De=_.profit!==void 0?Number(_.profit||0):Number(_.repairPrice||_.customerPrice||0)-Number(_.wholesalePrice||0);g+=Number.isFinite(De)?De:0}})}catch{}const w={};X.forEach(v=>{w[v.id]=Number(Se[v.id]||0)});const N=Object.values(w).reduce((v,j)=>v+Number(j||0),0),x=en;await tr.add({userId:a,reportDate:r,totalTransactions:x.totalTransactions,totalAmount:Math.round(x.totalAmount),totalWithdrawn:Math.round(x.totalWithdrawn),totalSent:Math.round(x.totalSent),profit:Math.round(d),walletId:null,cashBalance:Math.round(Number(Ve||0)),walletsTotal:Math.round(N),walletBalances:w,salesToday:Math.round(m),debtsToday:Math.round(f),maintenanceProfitToday:Math.round(g)}),y({title:"ØªÙ… ØªÙ‚ÙÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…",description:`ØªÙ… Ø­ÙØ¸ snapshot Ø¨ØªØ§Ø±ÙŠØ® ${r}`}),Vl(!1)}catch(a){console.error("Daily closing failed",a),y({title:"ÙØ´Ù„ Ø§Ù„ØªÙ‚ÙÙŠÙ„",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸",variant:"destructive"})}};u.useEffect(()=>{try{if(!L||X.length===0)return;const a=X.find(S=>S.id===L);if(!a)return;const r=(je==null?void 0:je.monthlyWithdrawLimit)??(a==null?void 0:a.monthlyWithdrawalLimit)??2e5,o=(je==null?void 0:je.monthlyTransferLimit)??(a==null?void 0:a.monthlyTransferLimit)??2e5,c=parseFloat(yt||"0")||0,d=(Ra==null?void 0:Ra.totalWithdrawn)??(je==null?void 0:je.monthlyWithdrawUsed)??0,m=(Ra==null?void 0:Ra.totalTransferred)??(je==null?void 0:je.monthlyTransferUsed)??0,f=d+(B==="withdraw"?c:0),g=m+(B==="transfer"?c:0),w=.85,N=Math.floor(Math.max(r,1)*w),x=Math.floor(Math.max(o,1)*w),v=(()=>{const S=new Date;return`${S.getFullYear()}-${String(S.getMonth()+1).padStart(2,"0")}`})(),j=`monthlyLimitWarnShown:${L}:${v}`;if(f>=N){const S=`${j}:withdraw`;if(!(localStorage.getItem(S)==="true")){vd({type:"withdraw",used:f,limit:r,walletName:a.name}),bd(!0);try{localStorage.setItem(S,"true")}catch{}return}}if(g>=x){const S=`${j}:transfer`;if(!(localStorage.getItem(S)==="true")){vd({type:"transfer",used:g,limit:o,walletName:a.name}),bd(!0);try{localStorage.setItem(S,"true")}catch{}return}}}catch{}},[L,X,je,Ra,B,yt]);const Qu=async(a,r=!1)=>{var d,m,f,g;if(Sn.current)return;if(C&&(k!=null&&k.permissions)){if(B==="transfer"&&k.permissions.transfers===!1){dt(!0);return}if(B==="withdraw"&&k.permissions.withdrawals===!1){dt(!0);return}}const o=B==="withdraw"&&(r||ca||!Ge);Sn.current=!0,eo(!0);const c=()=>{B==="transfer"?Us(!1):Lr(!1),Sn.current=!1,eo(!1)};try{if(Ww(),console.log("ðŸ”„ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­ÙˆÙŠÙ„/Ø§Ù„Ø³Ø­Ø¨"),console.log("ðŸ“Š Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:",{senderPhone:Ht,receiverPhone:kt,amount:yt,transactionType:B}),(()=>{B==="transfer"?Us(!0):Lr(!0)})(),!Ht||!yt){console.log("âŒ Ø®Ø·Ø£: Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©"),y({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",description:"ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",variant:"destructive"}),c();return}if(B==="transfer"&&!kt&&!l){console.log("âŒ Ø®Ø·Ø£: Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ù…ÙÙ‚ÙˆØ¯"),y({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",variant:"destructive"}),c();return}if(B==="transfer"&&!l){const z=String(kt||"").replace(/[^0-9Ù -Ù©]/g,"");if(!/[^0-9Ù -Ù©\s]/.test(String(kt||""))&&!Fw(kt)){y({title:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ØºÙŠØ± ØµØ§Ù„Ø­",description:"Ø§ÙƒØªØ¨ Ø±Ù‚Ù… ØµØ­ÙŠØ­ Ù…ÙƒÙˆÙ† Ù…Ù† 11 Ø±Ù‚Ù… ÙˆÙŠØ¨Ø¯Ø£ Ø¨Ù€ 015 Ø£Ùˆ 010 Ø£Ùˆ 012 Ø£Ùˆ 011",variant:"destructive"}),c();return}}const N=parseFloat(yt);if(console.log("ðŸ’° Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­ÙˆÙ„:",N),N<=0){console.log("âŒ Ø®Ø·Ø£: Ù…Ø¨Ù„Øº ØºÙŠØ± ØµØ­ÙŠØ­"),y({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø¨Ù„Øº",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"}),c();return}if(Pe)try{const z=new Date,de=z.getFullYear(),Ue=String(z.getMonth()+1).padStart(2,"0"),Ze=String(z.getDate()).padStart(2,"0"),jt=`zeroPlanDailyConfirmCount:${(e==null?void 0:e.uid)||"default"}:${de}-${Ue}-${Ze}`,Wt=localStorage.getItem(jt);if((Wt&&parseInt(Wt,10)||0)>=10){y({title:"Ø­Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ",description:"Ø¨Ø§Ù‚Ø© Ø²ÙŠØ±Ùˆ ØªØ³Ù…Ø­ Ø¨Ù€ 10 ØªØ£ÙƒÙŠØ¯Ø§Øª ØªØ­ÙˆÙŠÙ„/Ø³Ø­Ø¨ ÙŠÙˆÙ…ÙŠØ§Ù‹ ÙÙ‚Ø·.",variant:"destructive"}),c();return}}catch(z){console.warn("ÙØ´Ù„ Ù‚Ø±Ø§Ø¡Ø© Ø¹Ø¯Ø§Ø¯ ØªØ£ÙƒÙŠØ¯Ø§Øª Ø¨Ø§Ù‚Ø© Ø²ÙŠØ±Ùˆ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",z)}const x=X.find(z=>z.id===L);if(!x){y({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© ØµØ­ÙŠØ­Ø©",variant:"destructive"}),c();return}const v=Ra;if(console.log("ðŸ“ˆ ÙØ­Øµ Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ù„Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©"),console.log("ðŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ù„Ù„Ù…Ø­ÙØ¸Ø©:",{walletId:L,walletName:x.name,currentWithdrawn:v.totalWithdrawn,currentTransferred:v.totalTransferred,withdrawalLimit:x.monthlyWithdrawalLimit,transferLimit:x.monthlyTransferLimit}),B==="withdraw"){if(console.log("ðŸ§ ÙØ­Øµ Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),console.log(`ðŸ’¸ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨ Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${v.totalWithdrawn}, Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${N}, Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: ${x.monthlyWithdrawalLimit}`),v.totalWithdrawn+N>x.monthlyWithdrawalLimit){console.log("âŒ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),y({title:"ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ",description:`Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø³Ø­Ø¨ Ø£ÙƒØ«Ø± Ù…Ù† ${x.monthlyWithdrawalLimit} Ø¬Ù†ÙŠÙ‡ Ø´Ù‡Ø±ÙŠØ§Ù‹ Ù…Ù† Ù…Ø­ÙØ¸Ø© ${x.name}`,variant:"destructive"}),c();return}}else if(console.log("ðŸ’¸ ÙØ­Øµ Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),console.log(`ðŸ“¤ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${v.totalTransferred}, Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${N}, Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: ${x.monthlyTransferLimit}`),v.totalTransferred+N>x.monthlyTransferLimit){console.log("âŒ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),y({title:"ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø´Ù‡Ø±ÙŠ",description:`Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„ Ø£ÙƒØ«Ø± Ù…Ù† ${x.monthlyTransferLimit} Ø¬Ù†ÙŠÙ‡ Ø´Ù‡Ø±ÙŠØ§Ù‹ Ù…Ù† Ù…Ø­ÙØ¸Ø© ${x.name}`,variant:"destructive"}),c();return}const j=(n==null?void 0:n.shopName)||(e==null?void 0:e.displayName)||"Ù…Ø­Ù„ ÙƒØ§Ø´ÙŠ Ù„ÙŠÙ†Ùƒ",S={id:Date.now().toString(),type:B==="transfer"?"send":B==="deposit"?"deposit":"withdraw",senderPhone:Ht,receiverPhone:B==="transfer"?kt:Ht,amount:N,status:"completed",createdAt:new Date,withdrawnAmount:B==="withdraw"?N:void 0,sentAmount:B==="transfer"?N:void 0,depositedAmount:void 0,fromWallet:L,senderNumber:Ht,senderName:B==="withdraw"&&_r.trim()!==""?_r.trim():void 0,shopName:(x==null?void 0:x.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",transferredAmount:B==="transfer"?N:void 0,receiverNumber:B==="transfer"?kt:void 0,withdrawnAmountDetailed:B==="withdraw"?N:void 0,depositedAmountDetailed:void 0,merchantShopName:j,transactionReference:`TXN-${Date.now()}`,commission:0,notes:B==="transfer"?void 0:cs&&cs.trim()!==""?cs.trim():void 0};Cr(S.id),C&&(k!=null&&k.name||k!=null&&k.username)&&(S.cashierName=(k==null?void 0:k.name)||(k==null?void 0:k.username));const _=or.validateTransaction(N,B,Ve,Se);if(!_.isValid){y({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",description:_.error,variant:"destructive"}),c();return}_.warning&&y({title:"ØªØ­Ø°ÙŠØ±",description:_.warning,variant:"destructive"});let O;if(B==="transfer")if((x==null?void 0:x.defaultTransferCommission)!=null){const z=Number(x.defaultTransferCommission)||0;O=Math.round(z*N/1e3*100)/100}else Ct&&Ct.trim()!==""?O=Math.max(0,parseFloat(Ct)):O=0;else if((x==null?void 0:x.defaultWithdrawCommission)!=null){const z=Number(x.defaultWithdrawCommission)||0;O=Math.round(z*N/1e3*100)/100}else mt&&mt.trim()!==""?O=Math.max(0,parseFloat(mt)):O=Math.round(N*.01*100)/100;if(S.commission=O,B!=="transfer"&&!Ge&&O>=N){y({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©",description:"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø£ÙƒØ¨Ø± Ù…Ù† Ø£Ùˆ ØªØ³Ø§ÙˆÙŠ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯Ø®Ù„",variant:"destructive"}),c();return}const A=B==="transfer"?N:o?Math.round((N-O)*100)/100:N;B==="withdraw"&&Od(o?`Ø³Ù„Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„: ${A} Ø¬Ù†ÙŠÙ‡`:null),S.amount=o?N:A,S.withdrawnAmount=B==="withdraw"?o?N:A:void 0,S.sentAmount=B==="transfer"?A:void 0,S.transferredAmount=B==="transfer"?A:void 0,S.withdrawnAmountDetailed=B==="withdraw"?o?N:A:void 0;let P;const U=B==="transfer"&&!!la,te=B==="withdraw"&&!!la,H=U||te;let De=null;const Je=Ar(Ht||"").replace(/\D/g,""),rt=Ar(kt||"").replace(/\D/g,""),Oe=B==="transfer"&&(Je.startsWith("010")&&(rt.startsWith("011")||rt.startsWith("012")||rt.startsWith("015"))||Je.startsWith("012")&&rt.startsWith("010")||Je.startsWith("011")&&rt.startsWith("010")||Je.startsWith("015")&&rt.startsWith("010")),pe=Math.max(0,parseFloat(yd||"0")),nt=Math.round(O*100)/100;if(S.commission=nt,S.fee=pe,S.totalCharged=B==="transfer"?Number(A)+Number(nt)+Number(pe):Ge?Number(A)+Number(nt):Number(N),B==="transfer"&&!H){const z=Number(Se[L]||0),de=Number(A)+Number(pe);if(z<de){y({title:"Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ØºÙŠØ± ÙƒØ§ÙÙ",description:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ ${z} Ù„Ø§ ÙŠÙƒÙÙŠ Ù„Ø®ØµÙ… ${de}`,variant:"destructive"}),c();return}}if(H)if(U){const z=or.validateTransaction(A,"transfer",Ve,Se);if(!z.isValid)P={success:!1,newCashBalance:Ve,newWalletBalances:Se,message:z.error||"Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙ Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¤Ø¬Ù„",error:"INSUFFICIENT_WALLET_BALANCE"};else{const de=L||((d=X.find(Me=>Me.isDefault))==null?void 0:d.id)||((m=X[0])==null?void 0:m.id),Ue=je??await qa.getWalletLimits(de),Ze=new Date().toDateString(),jt=ge.filter(Me=>Me.type==="send"&&String(Me.status||"").toLowerCase()==="pending"&&Me.fromWallet===de&&new Date(Me.createdAt).toDateString()===Ze).reduce((Me,Tt)=>Me+Number(Tt.sentAmount??Tt.transferredAmount??Tt.amount??0),0),Wt=Number((Ue==null?void 0:Ue.dailyTransferLimit)??6e4),Xt=Number((Ue==null?void 0:Ue.dailyTransferUsed)??0);if(Xt+jt+Number(A)>Wt){y({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„ØªØ­ÙˆÙŠÙ„",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø§Ù„ÙŠÙˆÙ…: ${(Wt-Xt-jt).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}const it=new Date,_t=ge.filter(Me=>Me.type==="send"&&String(Me.status||"").toLowerCase()==="pending"&&Me.fromWallet===de&&new Date(Me.createdAt).getMonth()===it.getMonth()&&new Date(Me.createdAt).getFullYear()===it.getFullYear()).reduce((Me,Tt)=>Me+Number(Tt.sentAmount??Tt.transferredAmount??Tt.amount??0),0),Ft=Number((Ue==null?void 0:Ue.monthlyTransferLimit)??2e5),Xs=Number((Ue==null?void 0:Ue.monthlyTransferUsed)??0);if(Xs+_t+Number(A)>Ft){y({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„ØªØ­ÙˆÙŠÙ„",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±: ${(Ft-Xs-_t).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}P={success:!0,newCashBalance:Ve,newWalletBalances:Se}}}else{const z=L||((f=X.find(Me=>Me.isDefault))==null?void 0:f.id)||((g=X[0])==null?void 0:g.id),de=je??await qa.getWalletLimits(z),Ue=new Date().toDateString(),Ze=ge.filter(Me=>Me.type==="withdraw"&&String(Me.status||"").toLowerCase()==="pending"&&Me.fromWallet===z&&new Date(Me.createdAt).toDateString()===Ue).reduce((Me,Tt)=>Me+Number(Tt.withdrawnAmount??Tt.amount??0),0),jt=Number((de==null?void 0:de.dailyWithdrawLimit)??1e5),Wt=Number((de==null?void 0:de.dailyWithdrawUsed)??0);if(Wt+Ze+Number(A)>jt){y({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø³Ø­Ø¨",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø§Ù„ÙŠÙˆÙ…: ${(jt-Wt-Ze).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}const Xt=new Date,it=ge.filter(Me=>Me.type==="withdraw"&&String(Me.status||"").toLowerCase()==="pending"&&Me.fromWallet===z&&new Date(Me.createdAt).getMonth()===Xt.getMonth()&&new Date(Me.createdAt).getFullYear()===Xt.getFullYear()).reduce((Me,Tt)=>Me+Number(Tt.withdrawnAmount??Tt.amount??0),0),_t=Number((de==null?void 0:de.monthlyWithdrawLimit)??2e5),Ft=Number((de==null?void 0:de.monthlyWithdrawUsed)??0);if(Ft+it+Number(A)>_t){y({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ø³Ø­Ø¨",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±: ${(_t-Ft-it).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}P={success:!0,newCashBalance:Math.round((Number(Ve)-Number(A))*100)/100,newWalletBalances:Se}}else B==="transfer"?P=await or.processTransfer({amount:A,currentCashBalance:Ve,currentWalletBalances:Se,wallets:X,selectedWalletId:L,skipRemoteLimitsCheck:!1,nonBlockingUsageUpdate:!0}):P=await or.processWithdraw({amount:A,currentCashBalance:Ve,currentWalletBalances:Se,wallets:X,selectedWalletId:L,skipRemoteLimitsCheck:!1,nonBlockingUsageUpdate:!0});if(!P.success){y({title:"ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",description:P.error||P.message,variant:"destructive"}),c();return}let ft=H?te?P.newCashBalance:Ve:P.newCashBalance,ct=H?Se:P.newWalletBalances;if(!H&&o&&B==="withdraw"){const z=L,de=Number(ct[z]||0);ct={...ct,[z]:Math.round((de+O)*100)/100}}if(!H&&B==="transfer"&&pe>0){const z=Number(ct[L]||0);ct={...ct,[L]:Math.round((z-Number(pe))*100)/100}}if(H&&U){const z=X.find(Ze=>Ze.id===L)??X.find(Ze=>Ze.isDefault)??X[0],de=(z==null?void 0:z.id)||L;if(de!==L)try{Qr(de)}catch{}const Ue=Number(Se[de]||0);ct={...Se,[de]:Math.round((Ue-Number(A)-Number(pe))*100)/100}}if((U||te)&&la&&!T0){const z={id:`DEBT-${Date.now()}`,debtorName:la.debtorName,amount:la.amount,reason:la.notes||"",customerId:la.customerId,mobile:la.mobile,status:"pending",createdAt:new Date};De=z.id,S.linkedDebtId=De;const de=[z,...Ee];qt(de);try{if(await Ea(de),e!=null&&e.uid){const Ue=Ae(F,"debts",z.id),Ze={...z,userId:e.uid,shopId:D||(n==null?void 0:n.shopId)||null,lastUpdated:new Date().toISOString()};Object.keys(Ze).forEach(jt=>Ze[jt]===void 0&&delete Ze[jt]),await sa(Ue,Ze,{merge:!0})}}catch(Ue){console.error("âš ï¸ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¯ÙŠÙ† Ø§Ù„Ù…Ø¤Ø¬Ù„ Ù…Ø­Ù„ÙŠØ§Ù‹ Ø£Ùˆ Ø³Ø­Ø§Ø¨ÙŠØ§Ù‹:",Ue)}y({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙŠÙ†",description:"Ø£Ø¶ÙŠÙ Ø¥Ù„Ù‰ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ† Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ù„Ø³Ø¯Ø§Ø¯",variant:"default"})}if(!H&&!o){const z=Math.max(0,Number(O))+Math.max(0,Number(pe));z>0&&(ft=Math.round((ft+z)*100)/100,console.log(`ðŸ’° ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙˆÙ„Ø©/Ø±Ø³ÙˆÙ… ${z} Ø¬Ù†ÙŠÙ‡ Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©`))}console.log("âš¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙÙˆØ±Ø§Ù‹ Ø¨Ø¯ÙˆÙ† Ø­Ø¬Ø¨ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… startTransition...");const ia="temp_"+Date.now()+"_"+Math.random().toString(36).substring(7),It={reference:ia,shopId:D||(n==null?void 0:n.shopId)||(e==null?void 0:e.uid)||"default-shop",lineId:L||"default-line",walletId:L||void 0,merchantUserId:(e==null?void 0:e.uid)||null,provider:"vodafone_cash",txnType:B==="transfer"?"send":"receive",originType:B==="transfer"?"transfer":"withdraw",amount:o?N:A,commission:nt,fee:pe,profit:0,senderMsisdn:Ht,receiverMsisdn:B==="transfer"?kt:Ht,note:B==="transfer"?void 0:cs&&cs.trim()!==""?cs.trim():void 0,status:H?"pending":"confirmed",linkedDebtId:De||void 0,createdBy:(e==null?void 0:e.uid)||null,walletEffectAppliedOnCreation:!1,cashEffectAppliedOnCreation:!!(H&&te),limitsReservedOnCreation:!!H,limitReservedType:B==="transfer"?"transfer":"withdraw",profitAddedOnCreation:!1},Ye={...It,id:ia,status:H?"pending":"completed",commissionMode:B==="transfer"||Ge?"add":"deduct",totalCharged:B==="transfer"?A+nt+pe:Ge?A+O:N,walletEffectAppliedOnCreation:!1,cashEffectAppliedOnCreation:!!(H&&te),limitsReservedOnCreation:!!H,limitReservedType:B==="transfer"?"transfer":"withdraw",sentAmount:B==="transfer"?A:void 0,transferredAmount:B==="transfer"?A:void 0,withdrawnAmount:B==="withdraw"?o?N:A:void 0,senderName:B==="withdraw"&&_r.trim()!==""?_r.trim():void 0,createdAt:new Date,type:B==="transfer"?"send":"withdraw",senderPhone:Ht||"",receiverPhone:kt||""};try{Pa.current=[Ye,...Pa.current],E.setQueryData(["recentTransactions",e==null?void 0:e.uid,D||"main"],z=>!z||!Array.isArray(z)?[Ye]:[Ye,...z])}catch(z){console.error("Error in optimistic update:",z)}if(L&&je)try{const z=B==="transfer",de={...je};z?(de.dailyTransferUsed=(de.dailyTransferUsed||0)+A,de.monthlyTransferUsed=(de.monthlyTransferUsed||0)+A):(de.dailyWithdrawUsed=(de.dailyWithdrawUsed||0)+A,de.monthlyWithdrawUsed=(de.monthlyWithdrawUsed||0)+A),Hs(de)}catch(z){console.error("Error in optimistic limit update:",z)}const ha=[Ye,...ge];K.startTransition(()=>{at(ft),ut(ct),H&&(S.status="pending"),Vt(ha),o&&!H&&y({title:"ØªÙ… Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡",description:`Ø³Ù„Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„: ${A} Ø¬Ù†ÙŠÙ‡`,variant:"default",duration:5e3})});try{setTimeout(()=>{try{localStorage.setItem(Al(),JSON.stringify(ha))}catch{}},0)}catch{}if(Pe)try{const z=new Date,de=z.getFullYear(),Ue=String(z.getMonth()+1).padStart(2,"0"),Ze=String(z.getDate()).padStart(2,"0"),jt=`zeroPlanDailyConfirmCount:${(e==null?void 0:e.uid)||"default"}:${de}-${Ue}-${Ze}`,Wt=localStorage.getItem(jt),Xt=Wt&&parseInt(Wt,10)||0;localStorage.setItem(jt,String(Xt+1))}catch{}setTimeout(()=>{try{const z=new Date().toISOString();localStorage.setItem(Qe(),ft.toString()),localStorage.setItem(Qe()+"_lastUpdated",z),localStorage.setItem(st(),JSON.stringify(ct)),localStorage.setItem(st()+"_lastUpdated",z)}catch{}},0);try{if(e!=null&&e.uid){const z=X.find(Zs=>Zs.id===L)??X.find(Zs=>Zs.isDefault)??X[0],de=(z==null?void 0:z.id)||L,Ue=Number(ct[de]||0),Ze=String((z==null?void 0:z.phone)||Ht||"").trim(),jt=String(kt||"").trim(),Wt=Number(pe)>0,Xt=B==="transfer"?"ðŸŸ¢":"ðŸ”´",it=Number(nt)>0?`${Number(nt)} Ø¬Ù†ÙŠÙ‡`:"0 Ø¬Ù†ÙŠÙ‡",_t=Wt?` Ùˆ Ø±Ø³ÙˆÙ… ${Number(pe)} Ø¬Ù†ÙŠÙ‡`:"",Ft=B==="transfer"?`${Xt} ØªÙ… ØªØ­ÙˆÙŠÙ„ Ù…Ø¨Ù„Øº ${Number(A)} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${Ze} Ø¥Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${jt} ÙˆØªÙ… Ø£Ø®Ø° Ø¹Ù…ÙˆÙ„Ø© ${it}${_t}. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${Ue} Ø¬Ù†ÙŠÙ‡. Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${Number(ft)} Ø¬Ù†ÙŠÙ‡.`:`${Xt} ØªÙ… Ø§Ù„Ø³Ø­Ø¨ Ù…Ø¨Ù„Øº ${Number(A)} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø§Ù„Ø¯Ø±Ø¬ Ø¥Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${Ze} ÙˆØªÙ… Ø£Ø®Ø° Ø¹Ù…ÙˆÙ„Ø© ${it}${_t}. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${Ue} Ø¬Ù†ÙŠÙ‡. Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${Number(ft)} Ø¬Ù†ÙŠÙ‡.`,Xs=e!=null&&e.uid?`tg_last_msg_${e.uid}`:"tg_last_msg",Me=Date.now();let Tt=!0;try{const Zs=localStorage.getItem(Xs);if(Zs){const er=JSON.parse(Zs),ep=String((er==null?void 0:er.text)||""),tp=Number((er==null?void 0:er.at)||0);ep===Ft&&Me-tp<5e3&&(Tt=!1)}}catch{}if(Tt){Promise.resolve(ys.send(e.uid,Ft)).catch(()=>{});try{localStorage.setItem(Xs,JSON.stringify({text:Ft,at:Me}))}catch{}}}}catch{}if((async()=>{try{console.log("ðŸ”„ Ø¨Ø¯Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Firebase ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©...");const z={...It},de={...Ye},{ProfitService:Ue}=await ne(async()=>{const{ProfitService:it}=await import("./profitService-9EsNGq16.js");return{ProfitService:it}},__vite__mapDeps([45,0,1]),import.meta.url),Ze=Ue.calculateProfitFromTransaction({...de,status:"confirmed"});Ze>0&&(Ue.addProfit(Ze,e==null?void 0:e.uid),z.profitAddedOnCreation=!0,de.profitAddedOnCreation=!0,console.log("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø¨Ø­:",Ze,"Ø¬Ù†ÙŠÙ‡"));const jt=await Fp.create(z);if(L)try{const it=await qa.updateUsage(L,A,B==="transfer"?"transfer":"withdraw");it&&Hs(it);try{window.dispatchEvent(new CustomEvent("walletLimitsUpdated",{detail:{walletId:L}}))}catch{}}catch{}await Promise.all([...e!=null&&e.uid?[ae.updateUserData(e.uid,{cashBalance:ft,walletBalances:ct,lastUpdated:new Date().toISOString()})]:[],...e!=null&&e.uid?[ae.saveUserTransaction(e.uid,{...de,transactionId:jt,transactionType:B,fromWallet:L,toWallet:B==="transfer"?U?null:"cash":null,cashierName:C&&((k==null?void 0:k.name)||(k==null?void 0:k.username))||"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",linkedDebtId:De||void 0,description:`${B==="transfer"?"ØªØ­ÙˆÙŠÙ„":"Ø³Ø­Ø¨"} ${A} Ù…Ù† ${L} ${B==="transfer"?U?"":"Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ":""} â€” Ø¹Ù…ÙˆÙ„Ø©: ${O} (${B==="transfer"||Ge?"Ù…Ø¶Ø§ÙØ©":"Ù…Ø®ØµÙˆÙ…Ø©"})${pe>0?` â€” Ø±Ø³ÙˆÙ…: ${pe}`:""}${H?" â€” Ø¯ÙŠÙ† Ù…Ø¤Ø¬Ù„ (Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©)":""}`})]:[]]),console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­");try{const it={...Ye,id:jt};Pa.current=Pa.current.map(_t=>_t.id===ia?it:_t),E.setQueryData(["recentTransactions",e==null?void 0:e.uid,D||"main"],_t=>!_t||!Array.isArray(_t)?[it]:_t.map(Ft=>Ft.id===ia?it:Ft)),K.startTransition(()=>{Vt(_t=>_t.map(Ft=>Ft.id===ia?it:Ft))})}catch(it){console.error("Error updating query cache with real ID:",it)}setTimeout(()=>{try{console.log("ðŸ”„ ØªÙ†ÙÙŠØ° Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ø¬Ù„ (10 Ø«ÙˆØ§Ù†ÙŠ) Ù„Ø¶Ù…Ø§Ù† ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª..."),E.invalidateQueries({queryKey:["recentTransactions",e==null?void 0:e.uid,D||"main"]}),E.invalidateQueries({queryKey:["dashboardData",D||(n==null?void 0:n.shopId)]}),L&&(E.invalidateQueries({queryKey:["walletLimits",L]}),Ti())}catch(it){console.error("Error in delayed refresh:",it)}},1e4);const Wt=`userData_${e==null?void 0:e.uid}`,Xt={cashBalance:ft,walletBalances:ct,lastUpdated:new Date().toISOString()};localStorage.setItem(Wt,JSON.stringify(Xt))}catch(z){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Firebase (ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©):",z);try{e!=null&&e.uid&&ae.saveLocalReceipt(e.uid,{...transactionDataForUser,transactionType:B,fromWallet:L,toWallet:B==="transfer"?U?null:"cash":null,cashierName:C&&((k==null?void 0:k.name)||(k==null?void 0:k.username))||"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",linkedDebtId:De||void 0,description:`${B==="transfer"?"ØªØ­ÙˆÙŠÙ„":"Ø³Ø­Ø¨"} ${A} Ù…Ù† ${L} ${B==="transfer"?U?"":"Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ":""} â€” Ø¹Ù…ÙˆÙ„Ø©: ${O} (${B==="transfer"||Ge?"Ù…Ø¶Ø§ÙØ©":"Ù…Ø®ØµÙˆÙ…Ø©"})${pe>0?` â€” Ø±Ø³ÙˆÙ…: ${pe}`:""}${H?" â€” Ø¯ÙŠÙ† Ù…Ø¤Ø¬Ù„ (Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©)":""}`})}catch{}y({title:"ØªØ­Ø°ÙŠØ±",description:"ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ù„ÙƒÙ† ÙØ´Ù„Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…. Ø³ØªØªÙ… Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.",variant:"destructive"})}})(),B==="transfer"){Us(!0);const z=Number(N)+Number(O)+Math.max(0,Number(pe));zo({type:"transfer",amount:Math.max(0,Math.round(z*100)/100)}),gf({receiver:kt,amount:N}),fo(null),da(!0),setTimeout(()=>{Us(!1)},2e3)}else Lr(!0),zo({type:"withdraw",amount:A,isDeduct:o}),da(!0),setTimeout(()=>{Lr(!1)},2e3);Ir(""),Ls(""),Yo(!1),ud(""),md(""),_o(null),Co(""),ds(""),fd(""),gd(!1),setTimeout(()=>{Sn.current=!1,eo(!1)},1500)}catch(w){console.error("CRITICAL ERROR IN TRANSACTION:",w),y({title:"Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"}),c()}},tn=K.useMemo(()=>new Intl.DateTimeFormat("ar-EG"),[]),Gu=K.useMemo(()=>new Intl.DateTimeFormat("ar-EG",{hour:"2-digit",minute:"2-digit"}),[]),Xu=K.useMemo(()=>{try{return Ee.reduce((a,r)=>{const o=Number(r.paidAmount||0),c=Math.max(0,Number(r.amount||0)-o);return r.type==="debtor"?a.debtor+=c:a.creditor+=c,a},{creditor:0,debtor:0})}catch{return{creditor:0,debtor:0}}},[Ee]),ql=K.useMemo(()=>{const a=$u(),r=new Set;return a.filter(c=>!c||!c.id||r.has(c.id)?!1:(r.add(c.id),!0)).filter(c=>Qt==="all"?!0:Qt==="send"?c.type==="send":Qt==="receive"?c.type==="receive":Qt==="withdraw"?c.type==="withdraw":Qt==="deferred"?c.status==="pending":Qt==="wallet"?c.fromWallet===L:Qt!=="deleted")},[$u,Qt,L]),Kg=()=>{(async()=>{try{let r=[];if(Yn==="daily"){const o=new Date,c=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0),d=new Date(o.getFullYear(),o.getMonth(),o.getDate(),23,59,59,999);if(e!=null&&e.uid)try{r=await ae.getUserTransactionsForDateRange(e.uid,c,d)}catch{}const m=At.resetReportsManually("daily",Array.isArray(r)&&r.length?r:ge,e==null?void 0:e.uid);$s(!1),y({title:"ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©",description:`ØªÙ… Ø¥Ø®ÙØ§Ø¡ ${m.length} Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… (Ø§Ù„Ø­Ø¯ÙˆØ¯ Ù„Ù… ØªØªØ£Ø«Ø±)`})}else{const o=new Date,c=new Date(o.getFullYear(),o.getMonth(),1,0,0,0,0),d=new Date(o.getFullYear(),o.getMonth()+1,0,23,59,59,999);if(e!=null&&e.uid)try{r=await ae.getUserTransactionsForDateRange(e.uid,c,d)}catch{}const m=At.resetReportsManually("monthly",Array.isArray(r)&&r.length?r:ge,e==null?void 0:e.uid);$s(!1),y({title:"ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",description:`ØªÙ… Ø¥Ø®ÙØ§Ø¡ ${m.length} Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± (Ø§Ù„Ø­Ø¯ÙˆØ¯ Ù„Ù… ØªØªØ£Ø«Ø±)`})}try{window.dispatchEvent(new CustomEvent("reportsUpdated",{detail:{userId:e==null?void 0:e.uid,type:Yn}}))}catch{}}catch{$s(!1),y({title:"ÙØ´Ù„ Ø§Ù„ØªØµÙÙŠØ±",description:"ØªØ¹Ø°Ù‘Ø± Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØµÙÙŠØ±",variant:"destructive"})}})()},Jg=()=>Yn==="daily"?"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©":"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",Hg=()=>Yn==="daily"?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªØµÙÙŠØ± ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¥Ø®ÙØ§Ø¡ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ… Ù…Ù† Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±":"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªØµÙÙŠØ± ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¥Ø®ÙØ§Ø¡ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø± Ù…Ù† Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±",Qg=a=>{Au(a),bl(!0)},Gg=a=>{const r=Ve,o=Number(a)-Number(r);at(a);const c=new Date().toISOString();localStorage.setItem(Qe(),a.toString()),localStorage.setItem(Qe()+"_lastUpdated",c),xu(!1);const d={cashBalance:a,lastUpdated:c},m=`userData_${e==null?void 0:e.uid}`;try{localStorage.setItem(m,JSON.stringify(d))}catch{}const f=[];if(e!=null&&e.uid){f.push(ae.updateUserData(e.uid,d).then(()=>{try{localStorage.removeItem(m)}catch{}}).catch(()=>{}));const g=`${o>0?"CASHADD":"CASHDEDUCT"}-${(e==null?void 0:e.uid)||"anon"}-${Date.now()}`,w=o>0?{txnType:"cash_addition",type:"cash_addition",amount:o,status:"confirmed",senderMsisdn:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",receiverMsisdn:"",reference:g,title:"Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",merchantUserId:e.uid,createdBy:e.uid,shopId:(n==null?void 0:n.shopId)||void 0}:o<0?{amount:Math.abs(o),status:"completed",title:"Ø§ÙŠØµØ§Ù„ Ø®ØµÙ… Ù…Ù† Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠÙ‡",merchantUserId:e.uid,createdBy:e.uid,shopId:(n==null?void 0:n.shopId)||void 0}:null;w&&f.push(ae.saveUserTransaction(e.uid,w));const N=n==null?void 0:n.shopId;if(N){const x=Ae(F,"dashboardData",N);f.push(Zt(x,{cashBalance:a}))}}Promise.allSettled(f).then(()=>{}).catch(()=>{}),y({title:o>0?"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©":o<0?"ØªÙ… Ø®ØµÙ… Ù†Ù‚Ø¯ÙŠØ©":"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ",description:o!==0?`Ø§Ù„ØªØºÙŠÙŠØ±: ${Math.abs(o)} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${a} Ø¬Ù†ÙŠÙ‡`:`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø¥Ù„Ù‰ ${a} Ø¬Ù†ÙŠÙ‡`})},Xg=async a=>{var f;if(!Yt){console.warn("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù Ù…Ø­ÙØ¸Ø© Ù…Ø­Ø¯Ø¯ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±ØµÙŠØ¯");return}const r={...Se,[Yt]:a};ut(r);const o=new Date().toISOString(),c={walletBalances:r,lastUpdated:o},d=`userData_${e==null?void 0:e.uid}`;try{localStorage.setItem(d,JSON.stringify(c)),localStorage.setItem(st(),JSON.stringify(r)),localStorage.setItem(st()+"_lastUpdated",o),localStorage.setItem(`walletBalances_backup_${o}`,JSON.stringify(r))}catch{}try{e!=null&&e.uid&&await ae.updateUserData(e.uid,c)}catch(g){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙÙŠ Firebase:",g)}yu(!1);const m=((f=X.find(g=>g.id===Yt))==null?void 0:f.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©";y({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ ${m} Ø¥Ù„Ù‰ ${a.toLocaleString()} Ø¬Ù†ÙŠÙ‡`})},Zg=async a=>{var r;if(console.log("ðŸ’° Ø¨Ø¯Ø¡ ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©"),console.log("ðŸ“Š Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø­Ø±Ø±Ø©:",Yt),console.log("ðŸ’µ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¶Ø§Ù/Ø§Ù„Ù…Ø®ØµÙˆÙ…:",a),Yt){const o=Se[Yt]||0;console.log("ðŸ’° Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ:",o);const c=o+a;console.log("ðŸ’° Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯:",c);const d={...Se,[Yt]:c};console.log("ðŸ“Š Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø©:",d),ut(d);const m=new Date().toISOString(),f={walletBalances:d,lastUpdated:m},g=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(g,JSON.stringify(f)),localStorage.setItem(st(),JSON.stringify(d)),localStorage.setItem(`walletBalances_backup_${m}`,JSON.stringify(d));try{if(e!=null&&e.uid){console.log("ðŸ”„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase...");try{await ae.updateUserData(e.uid,f),console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­"),setTimeout(()=>{localStorage.removeItem(g),console.log("ðŸ§¹ ØªÙ… Ø­Ø°Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ø§Ù„Ù…Ø¤Ù‚ØªØ© Ø¨Ø¹Ø¯ Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©")},6e4)}catch(v){console.error("âŒ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase:",v),we(!0)}}else console.log("âš ï¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ØŒ Ø­ÙØ¸ ÙÙŠ localStorage"),localStorage.setItem(st(),JSON.stringify(d));const w=((r=X.find(v=>v.id===Yt))==null?void 0:r.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©",N=a>0?"Ø¥Ø¶Ø§ÙØ©":"Ø®ØµÙ…",x=Math.abs(a);y({title:`ØªÙ… ${N} Ù…Ø¨Ù„Øº ${N==="Ø¥Ø¶Ø§ÙØ©"?"Ø¥Ù„Ù‰":"Ù…Ù†"} Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©`,description:`ØªÙ… ${N} ${x} Ø¬Ù†ÙŠÙ‡ ${N==="Ø¥Ø¶Ø§ÙØ©"?"Ø¥Ù„Ù‰":"Ù…Ù†"} Ø±ØµÙŠØ¯ ${w}. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${c.toLocaleString()} Ø¬Ù†ÙŠÙ‡`})}catch(w){if(console.error("âŒ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase:",w),localStorage.setItem(st(),JSON.stringify(d)),e!=null&&e.uid){const N=`userData_${e.uid}`,x={walletBalances:d,lastUpdated:new Date().toISOString()};localStorage.setItem(N,JSON.stringify(x)),we(!0)}y({title:"ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹",description:"ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹ ÙˆØ³ÙŠØªÙ… Ù…Ø²Ø§Ù…Ù†ØªÙ‡Ø§ Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ø§Ø­Ù‚Ø§Ù‹",variant:"default"})}}else console.log("âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù Ù…Ø­ÙØ¸Ø© Ù„Ù„ØªØ­Ø±ÙŠØ±");setTimeout(()=>{const c=Object.keys(localStorage).filter(d=>d.startsWith("walletBalances_backup_")).sort();c.length>5&&c.slice(0,c.length-5).forEach(m=>{localStorage.removeItem(m),console.log("ðŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©:",m)})},5e3),bl(!1),Au("")};return console.log("ðŸ”¥ UserDashboardPage - Render conditions:",{isCheckingActivation:go,isUserActive:br,showActivationModal:S0}),go?(console.log("ðŸ”¥ UserDashboardPage - Showing loading screen"),t.jsx(kp,{})):(console.log("ðŸ”¥ UserDashboardPage - Rendering main dashboard"),t.jsxs("div",{id:"dashboard-content-container",className:"user-dashboard h-[100dvh] overflow-y-auto px-2 sm:px-4 pt-2 sm:py-4 relative bg-gray-100 bg-[radial-gradient(140%_140%_at_10%_10%,#e5e7eb_0%,#d1d5db_45%,#9ca3af_100%)] no-scrollbar",style:{paddingTop:$?"env(safe-area-inset-top, 0px)":void 0},children:[qs&&t.jsx("div",{className:"fixed inset-0 z-[99999] pointer-events-none bg-orange-300/30 mix-blend-multiply",style:{pointerEvents:"none"}}),t.jsx(mN,{userId:e==null?void 0:e.uid}),t.jsxs("div",{className:"max-w-screen-2xl mx-auto grid grid-cols-1 xl:grid-cols-3 gap-4 xl:gap-6 relative z-10",children:[t.jsxs("div",{className:"lg:col-span-2 space-y-2 sm:space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-2 sm:gap-3 fade-in-up",children:[!Fr&&t.jsxs(Za,{className:"bg-gray-100 dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 relative overflow-hidden",children:[t.jsx(bs,{className:"pb-2 px-3 pt-3 relative z-10",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(vs,{className:"text-sm font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[t.jsx("div",{className:"p-1 rounded-md bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700",children:t.jsx(Cm,{className:"h-4 w-4 text-gray-700 dark:text-gray-300"})}),t.jsx("span",{className:"text-sm",children:"Ø§Ù„Ø´Ù‡Ø±"})]}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(I,{size:"sm",variant:"ghost",onClick:()=>{Id("monthly"),$s(!0)},className:"h-8 w-8 p-0 bg-transparent hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 rounded-full transition-colors duration-200",title:"ØªØµÙÙŠØ± Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø±",children:t.jsx(Sa,{className:"h-3.5 w-3.5"})}),t.jsx(I,{size:"sm",variant:"ghost",onClick:()=>Wo(!0),className:"h-8 w-8 p-0 bg-transparent hover:bg-purple-50 dark:hover:bg-purple-900/20 text-purple-600 hover:text-purple-700 dark:text-purple-400 dark:hover:text-purple-300 rounded-full transition-colors duration-200",title:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± ÙŠÙˆÙ…/Ø´Ù‡Ø± Ù…Ø­Ø¯Ø¯",children:t.jsx(Ui,{className:"h-3.5 w-3.5"})}),t.jsx(I,{size:"sm",variant:"ghost",onClick:()=>Wo(!0),className:"h-8 w-8 p-0 bg-transparent hover:bg-blue-50 dark:hover:bg-blue-900/20 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 rounded-full transition-colors duration-200",title:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",children:t.jsx(Ei,{className:"h-3.5 w-3.5"})}),t.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900/20 rounded-full border border-green-100 dark:border-green-900/30",children:t.jsx(rn,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})})]})]})}),!Fr&&t.jsxs(es,{className:"pt-0 px-2 pb-2",children:[t.jsxs("div",{className:`grid grid-cols-2 gap-0 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-800 divide-x divide-y divide-gray-200 dark:divide-gray-800 bg-white dark:bg-gray-900 ${Ud?"blur-sm select-none":""}`,children:[t.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[t.jsx("span",{className:"text-[12px] font-bold text-blue-600 dark:text-blue-400",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),t.jsx("span",{className:"text-sm sm:text-lg font-bold text-blue-800 dark:text-blue-300 mt-0.5 sm:mt-0",children:Qs.totalTransactions})]}),t.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[t.jsx("span",{className:"text-[12px] font-bold text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø§Ø¬Ù…Ø§Ù„ÙŠ"}),t.jsx("span",{className:"text-sm sm:text-lg font-bold text-gray-900 dark:text-gray-100 mt-0.5 sm:mt-0",children:Qs.totalAmount.toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[t.jsx("span",{className:"text-[12px] font-bold text-red-600 dark:text-red-400",children:"Ø§Ù„Ù…Ø³Ø­ÙˆØ¨"}),t.jsx("span",{className:"text-sm sm:text-lg font-bold text-red-800 dark:text-red-300 mt-0.5 sm:mt-0",children:Qs.totalWithdrawn.toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[t.jsx("span",{className:"text-[12px] font-bold text-green-600 dark:text-green-400",children:"Ø§Ù„Ù…Ø±Ø³Ù„"}),t.jsx("span",{className:"text-sm sm:text-lg font-bold text-green-800 dark:text-green-300 mt-0.5 sm:mt-0",children:Qs.totalSent.toLocaleString("en-US",{maximumFractionDigits:0})})]})]}),t.jsxs("div",{className:"mt-2 rounded-lg border border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900 px-2 py-1.5 flex items-center justify-between",children:[t.jsx("span",{className:"text-[12px] font-bold text-yellow-600 dark:text-yellow-400",children:"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),t.jsx(vw,{userId:e==null?void 0:e.uid,transactions:ge})]})]}),Ud&&t.jsx("div",{className:"absolute inset-0 z-20 backdrop-blur-sm bg-white/60 dark:bg-black/60 flex items-center justify-center p-0 pointer-events-auto",children:t.jsxs(I,{size:"sm",variant:"ghost",onClick:async()=>{if(Pe){y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}Zn(!0)},className:"px-4 py-2 rounded-full bg-white dark:bg-card border border-gray-100 dark:border-gray-800 text-gray-900 dark:text-gray-100 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-800 hover:shadow-md transition-all duration-200 flex items-center gap-2 text-xs font-medium",title:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± (ÙŠØªØ·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ)",children:[t.jsx("span",{children:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±"}),t.jsx(cr,{className:"h-3.5 w-3.5 text-gray-600 dark:text-gray-400"})]})})]}),t.jsx(ea,{open:_f,onOpenChange:Zn,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±",description:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø± Ø¥Ù„Ø§ Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",onSuccess:()=>{if(Pe){y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}),Zn(!1),Xn(!0);return}Xn(!1),Zn(!1)},userId:e==null?void 0:e.uid,userRole:n==null?void 0:n.role}),t.jsx(ue,{open:Ug,onOpenChange:Vl,children:t.jsxs(me,{className:"sm:max-w-md",children:[t.jsxs(ye,{children:[t.jsx(he,{children:"ØªÙ‚ÙÙŠÙ„ ÙŠÙˆÙ…ÙŠÙ‘Ø©"}),t.jsx(et,{children:"ÙŠØ­ÙØ¸ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ØŒ Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ø¯Ø±Ø¬ØŒ Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…ØŒ Ø¯ÙŠÙˆÙ† Ø§Ù„ÙŠÙˆÙ…ØŒ ÙˆØ£Ø±Ø¨Ø§Ø­ Ø§Ù„ØµÙŠØ§Ù†Ø© Ù…Ø¹ ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„."})]}),t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsx(I,{variant:"ghost",className:"text-blue-700 hover:text-blue-800",onClick:()=>Hu(!0),children:"Ø§ÙŠØµØ§Ù„Ø§Øª Ø§Ù„ØªÙ‚ÙÙŠÙ„"}),t.jsx(I,{variant:"outline",onClick:()=>Vl(!1),children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{variant:"default",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>Ju(!0),children:"ØªÙ‚ÙÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…"})]})]})}),t.jsx(ea,{open:Vg,onOpenChange:Ju,mode:"verify",title:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªÙ‚ÙÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…",onSuccess:zg,userId:e==null?void 0:e.uid,userRole:n==null?void 0:n.role}),t.jsx(lN,{open:qg,onOpenChange:Hu,userId:e==null?void 0:e.uid}),(Rt==null?void 0:Rt.planType)!==ta.TAHWEELA&&t.jsxs(Za,{className:"bg-gray-50 dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 relative overflow-hidden",children:[t.jsx(bs,{className:"pb-2 px-3 pt-3 relative z-10",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(vs,{className:"text-sm font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[t.jsx("div",{className:"p-1 rounded-md bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700",children:t.jsx(Cm,{className:"h-4 w-4 text-gray-700 dark:text-gray-300"})}),t.jsx("span",{className:"text-sm",children:"Ø§Ù„ÙŠÙˆÙ…"})]}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(I,{size:"sm",variant:"ghost",onClick:()=>{Id("daily"),$s(!0)},className:"h-8 w-8 p-0 bg-transparent hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 rounded-full transition-colors duration-200",title:"ØªØµÙÙŠØ± Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…",children:t.jsx(Sa,{className:"h-3.5 w-3.5"})}),t.jsx(I,{size:"sm",variant:"ghost",onClick:()=>Be("https://www.youtube.com/watch?v=MjAFbvhgjYg","Ø´Ø±Ø­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…"),className:"h-8 w-8 p-0 bg-transparent hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 rounded-full transition-colors duration-200",title:"Ø´Ø±Ø­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…",children:t.jsx(Dx,{className:"h-4 w-4"})}),t.jsx(I,{size:"sm",variant:"ghost",onClick:()=>If(a=>!a),className:"h-8 w-8 p-0 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 rounded-full transition-colors duration-200",title:Fr?"ØªÙˆØ³ÙŠØ¹ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø´Ù‡Ø±":"Ø·ÙŠ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø´Ù‡Ø±",children:Fr?t.jsx(Xp,{className:"h-3.5 w-3.5"}):t.jsx(Zp,{className:"h-3.5 w-3.5"})}),t.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900/20 rounded-full border border-green-100 dark:border-green-900/30",children:t.jsx(rn,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})})]})]})}),!Fr&&t.jsxs(es,{className:"pt-0 px-2 pb-2",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-0 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-800 divide-x divide-y divide-gray-200 dark:divide-gray-800 bg-white dark:bg-gray-900",children:[t.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[t.jsx("span",{className:"text-[12px] font-bold text-blue-600 dark:text-blue-400",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),t.jsx("span",{className:"text-sm sm:text-lg font-bold text-blue-800 dark:text-blue-300 mt-0.5 sm:mt-0",children:en.totalTransactions})]}),t.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[t.jsx("span",{className:"text-[12px] font-bold text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø§Ø¬Ù…Ø§Ù„ÙŠ"}),t.jsx("span",{className:"text-sm sm:text-lg font-bold text-gray-900 dark:text-gray-100 mt-0.5 sm:mt-0",children:en.totalAmount.toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[t.jsx("span",{className:"text-[12px] font-bold text-red-600 dark:text-red-400",children:"Ø§Ù„Ù…Ø³Ø­ÙˆØ¨"}),t.jsx("span",{className:"text-sm sm:text-lg font-bold text-red-800 dark:text-red-300 mt-0.5 sm:mt-0",children:en.totalWithdrawn.toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[t.jsx("span",{className:"text-[12px] font-bold text-green-600 dark:text-green-400",children:"Ø§Ù„Ù…Ø±Ø³Ù„"}),t.jsx("span",{className:"text-sm sm:text-lg font-bold text-green-800 dark:text-green-300 mt-0.5 sm:mt-0",children:en.totalSent.toLocaleString("en-US",{maximumFractionDigits:0})})]})]}),t.jsxs("div",{className:"mt-2 rounded-lg border border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900 px-2 py-1.5 flex items-center justify-between",children:[t.jsx("span",{className:"text-[12px] font-bold text-yellow-600 dark:text-yellow-400",children:"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),t.jsx(jw,{userId:e==null?void 0:e.uid,transactions:ge})]})]}),Of&&t.jsx("div",{className:"absolute inset-0 z-20 backdrop-blur-sm bg-white/60 dark:bg-black/60 flex items-center justify-center p-0 pointer-events-auto",children:t.jsxs(I,{size:"sm",variant:"ghost",onClick:()=>Qo(!0),className:"px-4 py-2 rounded-full bg-white dark:bg-card border border-gray-100 dark:border-gray-800 text-gray-900 dark:text-gray-100 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-800 hover:shadow-md transition-all duration-200 flex items-center gap-2 text-xs font-medium",title:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… (ÙŠØªØ·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ)",children:[t.jsx("span",{children:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…"}),t.jsx(cr,{className:"h-3.5 w-3.5 text-gray-600 dark:text-gray-400"})]})})]}),t.jsx(ea,{open:Ef,onOpenChange:Qo,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…",description:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… Ø¥Ù„Ø§ Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",onSuccess:()=>{zd(!1),Qo(!1)},userId:e==null?void 0:e.uid})]}),t.jsxs(Za,{className:"balance-bar bg-gray-200 border-2 border-gray-200/50 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 group relative overflow-hidden   transform fade-in-up mb-6",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-500/5 via-blue-500/5 to-emerald-500/5 opacity-0 group-hover:opacity-100 transition-opacity duration-200"}),t.jsx("div",{className:"absolute top-0 left-0 w-40 h-40 bg-gradient-to-br from-emerald-300/10 to-transparent rounded-full -translate-y-20 -translate-x-20 group-hover:scale-150 transition-transform duration-200"}),t.jsx("div",{className:"absolute bottom-0 right-0 w-40 h-40 bg-gradient-to-br from-blue-300/10 to-transparent rounded-full translate-y-20 translate-x-20 group-hover:scale-150 transition-transform duration-200"}),t.jsx(es,{className:"p-2 relative z-10",children:t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[t.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-gray-800 p-1 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 group/cash relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/10 to-transparent opacity-0 group-hover/cash:opacity-100 transition-opacity duration-300"}),t.jsxs("div",{className:"flex flex-col relative z-10 w-full",children:[t.jsxs("div",{className:"flex items-center justify-between w-full",children:[t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("div",{className:"p-0.5 bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/30 dark:to-emerald-800/30 rounded-lg shadow-sm",children:t.jsx(Va,{className:"h-1.5 w-1.5 text-emerald-600 dark:text-emerald-400"})}),t.jsx("span",{className:"text-[11px] font-extrabold text-emerald-800 dark:text-emerald-300",children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",onClick:()=>zr(!0),children:t.jsx(Pt,{className:"h-4 w-4"})}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-emerald-600 dark:text-emerald-400 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 transition-colors",onClick:()=>Pu(!0),title:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©",children:t.jsx(bm,{className:"h-4 w-4"})}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",onClick:()=>Ii(!0),children:t.jsx(Sa,{className:"h-4 w-4"})})]})]}),t.jsx("div",{className:"mt-0.5",children:t.jsxs("span",{className:"text-[14px] sm:text-xl font-bold text-emerald-800 dark:text-emerald-200 bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/30 dark:to-emerald-800/30 px-1 py-0.5 rounded-lg shadow-sm block w-fit",children:[Ve.toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})})]})]}),t.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-gray-800 p-1 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 group/wallet relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/10 to-transparent opacity-0 group-hover/wallet:opacity-100 transition-opacity duration-300"}),t.jsxs("div",{className:"flex flex-col relative z-10 w-full",children:[t.jsxs("div",{className:"flex items-center justify-between w-full",children:[t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("div",{className:"p-0.5 bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/30 dark:to-blue-800/30 rounded-lg shadow-sm",children:t.jsx(ar,{className:"h-1.5 w-1.5 text-blue-600 dark:text-blue-400"})}),t.jsx("span",{className:"text-[11px] font-extrabold text-blue-800 dark:text-blue-300",children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",onClick:()=>ji(!0),title:"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„ Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©",children:t.jsx(Pt,{className:"h-4 w-4"})}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",onClick:()=>Bo(!0),title:"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø§ÙØ¸",children:t.jsx(ar,{className:"h-4 w-4"})}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",onClick:()=>{ki(!0),Ci("")},title:"ØªØµÙÙŠØ± Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©",children:t.jsx(Sa,{className:"h-4 w-4"})})]})]}),t.jsx("div",{className:"mt-0.5",children:t.jsxs("span",{className:"text-[14px] sm:text-xl font-bold text-blue-800 dark:text-blue-200 bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/30 dark:to-blue-800/30 px-1 py-0.5 rounded-lg shadow-sm block w-fit",children:[X.reduce((a,r)=>a+(Number(Se[r.id])||0),0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})})]})]}),t.jsxs("div",{className:"col-span-2 sm:col-span-1 bg-white dark:bg-card border border-gray-200 dark:border-gray-800 p-1 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 group/selwallet relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-transparent opacity-0 group-hover/selwallet:opacity-100 transition-opacity duration-300"}),t.jsxs("div",{className:"flex flex-col relative z-10 w-full",children:[t.jsxs("div",{className:"flex items-center justify-between w-full",children:[t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("div",{className:"p-0.5 bg-gradient-to-r from-indigo-100 to-indigo-200 dark:from-indigo-900/30 dark:to-indigo-800/30 rounded-lg shadow-sm",children:t.jsx(ar,{className:"h-1.5 w-1.5 text-indigo-600 dark:text-indigo-400"})}),t.jsx("span",{className:"text-[11px] font-extrabold text-indigo-800 dark:text-indigo-300",children:"Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ù‡"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",onClick:()=>{if(!L){y({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}Qg(L)},title:"Ø¥Ø¶Ø§ÙØ©/Ø®ØµÙ… Ø¥Ù„Ù‰ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",children:t.jsx(Pt,{className:"h-4 w-4"})}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",onClick:()=>{if(!L){y({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„ØªØµÙÙŠØ± Ø±ØµÙŠØ¯Ù‡Ø§ ÙÙ‚Ø·",variant:"destructive"});return}di(!0)},title:"ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",children:t.jsx(Sa,{className:"h-4 w-4"})})]})]}),t.jsx("div",{className:"mt-0.5",children:t.jsxs("span",{className:"text-[14px] sm:text-xl font-bold text-indigo-800 dark:text-indigo-200 bg-gradient-to-r from-indigo-100 to-indigo-200 dark:from-indigo-900/30 dark:to-indigo-800/30 px-1 py-0.5 rounded-lg shadow-sm block w-fit",children:[(L&&Se[L]||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})})]})]})]})})]}),t.jsxs(Za,{className:"bg-gray-100 dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 group relative overflow-hidden fade-in-up",children:[t.jsxs(bs,{className:`pb-2 px-4 pt-4 relative z-10 ${M?"sticky top-0 z-20 bg-white/90 dark:bg-card/90 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-card/60":""}`,children:[t.jsxs("div",{className:`flex items-center ${M?"justify-between":"justify-end"}`,children:[M&&t.jsx(vs,{className:"text-sm font-bold flex items-center gap-2 text-gray-900 dark:text-gray-100",children:t.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©"})}),t.jsx("div",{className:"flex items-center gap-2",children:!M&&t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-green-600 mb-1 whitespace-nowrap",children:"Ø³Ø­Ø¨ ATM"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-green-100 text-green-600 hover:bg-green-200 border border-green-200 ring-3 ring-green-300 transition-all duration-200 hover:scale-105 active:bg-green-600 active:text-white active:border-green-600",onClick:()=>Y(!0),title:"Ø³Ø­Ø¨ ATM",children:t.jsx(Cp,{className:"h-5 w-5 text-green-600"})})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[t.jsx("span",{className:"text-[10px] font-semibold text-orange-600 whitespace-nowrap",children:"Ù…Ø¹Ù„Ù‚Ø©"}),Te>0&&t.jsx("span",{className:"h-4 w-4 rounded-full bg-orange-600 text-white text-[10px] flex items-center justify-center ring-2 ring-white",children:Te})]}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-orange-100 text-orange-600 hover:bg-orange-200 border border-orange-200 ring-3 ring-orange-300 transition-all duration-200 hover:scale-105 active:bg-orange-600 active:text-white active:border-orange-600",onClick:()=>re(!0),title:"Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ø¹Ù„Ù‚Ø©",children:t.jsx(zl,{className:"h-5 w-5 text-orange-600"})})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"Ø®Ø·ÙˆØ·"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>ke("lines",()=>{ks?Ds(!0):tt()}),title:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø·ÙˆØ·",children:t.jsx(Ip,{className:"h-5 w-5 text-purple-600"})})]}),!Gt.includes("installment")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"ØªÙ‚Ø³ÙŠØ·"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>ke("installments",()=>{if(Pe||Le){y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ· ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"});return}Wr(!0)}),title:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ·",children:t.jsx(_p,{className:"h-5 w-5 text-purple-600"})})]}),!Gt.includes("store")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-blue-600 mb-1",children:"Ù…ØªØ¬Ø±Ùƒ"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 border border-blue-200 ring-3 ring-blue-300 transition-all duration-200 hover:scale-105 active:bg-blue-600 active:text-white active:border-blue-600",onClick:()=>Zi(!0),title:"Ù…ØªØ¬Ø±Ùƒ",children:t.jsx(nn,{className:"h-5 w-5 text-blue-600"})})]}),!Gt.includes("calculator")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"Ø­Ø§Ø³Ø¨Ø©"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>Fd(!0),title:"Ø¢Ù„Ø© Ø­Ø§Ø³Ø¨Ø©",children:t.jsx(qp,{className:"h-5 w-5 text-purple-600"})})]}),!Gt.includes("credit-cards")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"ÙƒØ±ÙˆØª"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>ke("cards",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Hn(!0)}),title:"ÙƒØ±ÙˆØª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†",children:t.jsx(Ap,{className:"h-5 w-5 text-purple-600"})})]}),t.jsxs("div",{className:"hidden flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-blue-600 mb-1",children:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 border border-blue-200 ring-3 ring-blue-300 transition-all duration-200 hover:scale-105 active:bg-blue-600 active:text-white active:border-blue-600",onClick:()=>{if(Pe||Le){y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"});return}Du(!0)},title:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",children:t.jsx(Im,{className:"h-5 w-5 text-blue-600"})})]}),!Gt.includes("telegram")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-sky-600 mb-1",children:"ØªÙ„Ø¬Ø±Ø§Ù…"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-sky-100 text-sky-600 hover:bg-sky-200 border border-sky-200 ring-3 ring-sky-300 transition-all duration-200 hover:scale-105 active:bg-sky-600 active:text-white active:border-sky-600",onClick:()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):zt.hasMasterPin()?Fl(!0):Uu()},title:"Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",children:t.jsx(Tp,{className:"h-5 w-5 text-sky-600"})})]}),!Gt.includes("cashier-shift")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-blue-600 mb-1",children:"Ø§Ù„ÙˆØ±Ø¯ÙŠØ©"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 border border-blue-200 ring-3 ring-blue-300 transition-all duration-200 hover:scale-105 active:bg-blue-600 active:text-white active:border-blue-600",onClick:yg,title:C&&(k!=null&&k.name||k!=null&&k.username)?`Ø¨Ø±ÙˆÙÙŠÙ„ Ø§Ù„ÙˆØ±Ø¯ÙŠØ©: ${(k==null?void 0:k.name)||(k==null?void 0:k.username)}`:"ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ÙƒØ§Ø´ÙŠØ±",children:t.jsx(on,{className:"h-5 w-5 text-blue-600"})})]}),!Gt.includes("sales")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>ke("sales",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Or(!0)}),title:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª",children:t.jsx(Gl,{className:"h-5 w-5 text-purple-600"})})]}),!Gt.includes("debts")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:"text-[10px] font-semibold text-purple-600",children:"Ø§Ù„Ø¯ÙŠÙˆÙ†"}),Ee.filter(a=>a.status==="pending").length>0&&t.jsx("span",{className:"h-4 w-4 rounded-full bg-red-600 text-white text-[10px] flex items-center justify-center ring-2 ring-white",children:Ee.filter(a=>a.status==="pending").length})]}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>ke("debts",()=>{al()}),title:"Ø§Ù„Ø¯ÙŠÙˆÙ†",children:t.jsx(Ei,{className:"h-5 w-5 text-purple-600"})})]}),!Gt.includes("maintenance")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-amber-700 mb-1",children:"Ø§Ù„ØµÙŠØ§Ù†Ø©"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-amber-100 text-amber-700 hover:bg-amber-200 border border-amber-200 ring-3 ring-amber-300 transition-all duration-200 hover:scale-105 active:bg-amber-600 active:text-white active:border-amber-600",onClick:()=>ke("maintenance",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Qn(!0)}),title:"Ø§Ù„ØµÙŠØ§Ù†Ø©",children:t.jsx(gm,{className:"h-5 w-5 text-amber-700"})})]}),!Gt.includes("machine")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-yellow-500 mb-1",children:"Ø§Ù„Ù…ÙƒÙ†Ø©"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-violet-100 text-violet-700 hover:bg-violet-200 border border-violet-200 ring-3 ring-violet-300 transition-all duration-200 hover:scale-105 active:bg-violet-700 active:text-white active:border-violet-700",onClick:()=>ke("machines",()=>{!ma||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Gn(!0)}),title:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø©",children:t.jsx(Pp,{className:"h-5 w-5 text-yellow-500"})})]}),!Gt.includes("shop-expenses")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-orange-600 mb-1",children:"Ù…ØµØ±ÙˆÙØ§Øª"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-orange-100 text-orange-600 hover:bg-orange-200 border border-orange-200 ring-3 ring-orange-300 transition-all duration-200 hover:scale-105 active:bg-orange-600 active:text-white active:border-orange-600",onClick:()=>ke("expenses",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Gc&&zt.hasMasterPin()?wr(!0):Ts(!0)}),title:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„",children:t.jsx(ln,{className:"h-5 w-5 text-orange-600"})})]}),!Gt.includes("deficiencies")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-rose-600 mb-1",children:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-rose-100 text-rose-600 hover:bg-rose-200 border border-rose-200 ring-3 ring-rose-300 transition-all duration-200 hover:scale-105 active:bg-rose-600 active:text-white active:border-rose-600",onClick:()=>ke("deficiencies",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):jr(!0)}),title:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ",children:t.jsx(Kl,{className:"h-5 w-5 text-rose-600"})})]}),!Gt.includes("my-client-numbers")&&t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-[10px] font-semibold text-emerald-600 mb-1",children:"Ø£Ø±Ù‚Ø§Ù…ÙŠ"}),t.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-emerald-100 text-emerald-700 hover:bg-emerald-200 border border-emerald-200 ring-3 ring-emerald-300 transition-all duration-200 hover:scale-105 active:bg-emerald-600 active:text-white active:border-emerald-600",onClick:()=>ke("myNumbers",()=>{Pe||Le?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):On(!0)}),title:"Ø£Ø±Ù‚Ø§Ù…ÙŠ",children:t.jsx(Ri,{className:"h-5 w-5 text-emerald-700"})})]})]})})]}),!M&&t.jsx("div",{className:"mt-2 w-full",children:t.jsxs("div",{className:"filters-bar flex items-center justify-center gap-3 bg-gray-100 rounded-md p-3 border border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[t.jsx("div",{className:"p-1.5 sm:p-2 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:t.jsx(rn,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5 text-gray-700 dark:text-gray-300"})}),t.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-gray-100",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©"})]}),t.jsxs("div",{className:"relative flex items-center h-9 w-[200px] md:w-[240px] bg-white dark:bg-gray-900 rounded-full border border-gray-200 dark:border-gray-700 hover:border-blue-400 dark:hover:border-blue-500 focus-within:border-blue-500 focus-within:ring-4 focus-within:ring-blue-50 dark:focus-within:ring-blue-900/30 transition-all duration-300 shadow-sm hover:shadow-md group",children:[t.jsx(Nm,{className:"absolute right-3 h-4 w-4 text-gray-400 group-hover:text-blue-500 transition-colors pointer-events-none"}),t.jsx(Z,{placeholder:"Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ...",value:Uo,onChange:a=>Ad(a.target.value),className:"h-full w-full pr-10 pl-8 py-0 text-xs font-medium border-0 bg-transparent focus:ring-0 focus-visible:ring-0 shadow-none placeholder:text-gray-400 text-gray-700 dark:text-gray-200 rounded-full"}),Uo&&t.jsx("button",{onClick:()=>Ad(""),className:"absolute left-2 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-400 hover:text-red-500 transition-colors",title:"Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø«",children:t.jsx(cn,{className:"h-3.5 w-3.5"})})]}),t.jsx(I,{variant:"ghost",size:"sm",className:`btn-filter-send h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Qt==="send"?"bg-green-600 text-white border-green-600":"text-green-700 border-green-300 hover:bg-green-100"}`,onClick:()=>Tr("send"),title:"ØªØµÙÙŠØ© Ø§Ù„ØªØ­ÙˆÙŠÙ„",children:"Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),t.jsx(I,{variant:"ghost",size:"sm",className:`btn-filter-withdraw h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Qt==="withdraw"?"bg-red-600 text-white border-red-600":"text-red-700 border-red-300 hover:bg-red-100"}`,onClick:()=>Tr("withdraw"),title:"ØªØµÙÙŠØ© Ø§Ù„Ø³Ø­Ø¨",children:"Ø§Ù„Ø³Ø­Ø¨"}),t.jsx(I,{variant:"ghost",size:"sm",className:`btn-filter-deferred h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Qt==="deferred"?"bg-yellow-600 text-white border-yellow-600":"text-yellow-700 border-yellow-300 hover:bg-yellow-100"}`,onClick:()=>Tr("deferred"),title:"ØªØµÙÙŠØ© Ø§Ù„Ù…Ø¤Ø¬Ù„",children:"Ù…Ø¤Ø¬Ù„"}),t.jsx(I,{variant:"ghost",size:"sm",className:`btn-filter-wallet h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Qt==="wallet"?"bg-blue-600 text-white border-blue-600":"text-blue-700 border-blue-300 hover:bg-blue-100"}`,onClick:()=>{L?Tr("wallet"):y({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÙ‡Ø§",variant:"destructive"})},title:"Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­ÙØ¸Ù‡ Ø§Ù„Ù…Ø®ØªØ§Ø±Ù‡ ÙÙ‚Ø·",children:"Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­ÙØ¸Ù‡"}),t.jsx(I,{variant:"ghost",size:"sm",className:`btn-filter-all h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Qt==="all"?"bg-green-600 text-white border-green-600":"text-green-700 border-green-300 hover:bg-green-100"}`,onClick:()=>Tr("all"),title:"Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„",children:"Ø§Ù„ÙƒÙ„"})]})})]}),t.jsx(ea,{open:wf,onOpenChange:Wr,mode:"verify",title:"ÙØªØ­ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ·",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ·",onSuccess:()=>{Wr(!1),Bd(!0)}}),t.jsx(eN,{open:Nf,onOpenChange:Bd}),t.jsx(ea,{open:Nn,onOpenChange:Ds,mode:"verify",title:"ÙØªØ­ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø·ÙˆØ·",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø·ÙˆØ·",onSuccess:()=>{Ds(!1),tt()}}),t.jsx(tN,{isOpen:jf,onClose:()=>Jn(!1),shopId:D,onOpenAdsl:()=>{Jn(!1),$d(!0)}}),t.jsx(vm,{isOpen:Aa,onClose:()=>na(!1),userId:(e==null?void 0:e.uid)||"",userEmail:(e==null?void 0:e.email)||""}),t.jsx(aN,{isOpen:Sf,onClose:()=>$d(!1),shopId:D}),t.jsx(ea,{open:Mg,onOpenChange:Fl,mode:"verify",title:"Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",onSuccess:()=>{Fl(!1),Uu()},userId:e==null?void 0:e.uid,userRole:n==null?void 0:n.role}),t.jsxs(es,{className:"space-y-2 pt-0 px-4 pb-4 relative z-10",children:[ql.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx(rn,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),t.jsx("p",{className:"text-sm",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†"})]}):M?t.jsx("div",{className:"overflow-y-auto overscroll-contain scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400 transition-colors max-h-[310px]",children:t.jsx("div",{className:"space-y-2 pr-2",children:ql.map(a=>t.jsxs("div",{className:"relative flex items-center gap-4 p-4 rounded-xl bg-gray-50 border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>Yu(a),children:[t.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center shrink-0 ${a.type==="withdraw"?"bg-red-100":"bg-green-100"}`,children:(()=>{const r=a,o=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª";return o?t.jsx(ln,{className:"h-5 w-5 text-gray-600"}):c?t.jsx(Pt,{className:"h-5 w-5 text-green-600"}):d?t.jsx(ln,{className:"h-5 w-5 text-green-600"}):a.type==="withdraw"?t.jsx(ir,{className:"h-5 w-5 text-red-600"}):t.jsx(wm,{className:"h-5 w-5 text-green-600"})})()}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("h4",{className:"text-base font-bold truncate",children:(()=>{const r=a,o=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",m=String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((r==null?void 0:r.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡");return o?t.jsx("span",{className:"text-foreground",children:"ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"}):m?t.jsx("span",{className:"text-foreground",children:"Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡"}):c?t.jsx("span",{className:"text-foreground",children:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"}):d?t.jsx("span",{className:"text-foreground",children:"Ù…Ø¨ÙŠØ¹Ø§Øª"}):a.type==="atm_withdraw"?t.jsx("span",{className:"text-green-600",children:"Ø³Ø­Ø¨ atm"}):a.type==="send"?t.jsx("span",{className:"text-green-600",children:"ØªØ­ÙˆÙŠÙ„ Ø£Ù…ÙˆØ§Ù„"}):t.jsx("span",{className:"text-red-600",children:"Ø³Ø­Ø¨ Ù†Ù‚Ø¯ÙŠ"})})()}),t.jsxs("span",{className:`text-base font-bold whitespace-nowrap ${a.type==="withdraw"?"text-red-600":"text-green-600"}`,children:[a.type==="withdraw"||a.type==="cash_addition"||a.txnType==="cash_addition"||a.type==="sales"||a.txnType==="sales"?"+":"-"," ",ws(a.amount)," Ø¬.Ù…"]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex flex-col gap-0.5",children:[t.jsx("p",{className:"text-sm text-muted-foreground truncate",children:(()=>{const r=a,o=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",m=String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((r==null?void 0:r.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡"),f=(r==null?void 0:r.note)||(r==null?void 0:r.notes)||"";if(o)return`Ø¥Ù„Ù‰: ${a.receiverPhone}`;if(c)return f||"Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠØ©";if(d){const g=((r==null?void 0:r.saleProductName)||"").trim(),w=((r==null?void 0:r.saleQuantity)??"").toString();return g&&w?`${g} Ã— ${w}`:g||"Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹"}return m?`Ù…Ù†: ${r.senderName||"Ù…Ø§ÙƒÙŠÙ†Ø©"}`:a.type==="send"?t.jsx("span",{dir:"ltr",children:a.receiverPhone}):t.jsx("span",{dir:"ltr",children:a.senderPhone})})()}),t.jsxs("p",{className:"text-sm font-medium text-gray-500 mt-0.5",children:[tn.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))," - ",Gu.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))]})]}),t.jsxs("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium flex items-center gap-1 ${a.status==="completed"?a.type==="withdraw"?"bg-red-100 text-red-700":"bg-green-100 text-green-700":a.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[a.status==="completed"&&t.jsx(Li,{className:"h-3 w-3"}),a.status==="pending"&&t.jsx(zl,{className:"h-3 w-3"}),a.status==="failed"&&t.jsx(cn,{className:"h-3 w-3"}),t.jsx("span",{children:a.status==="completed"?"Ù†Ø§Ø¬Ø­Ø©":a.status==="pending"?"Ù…Ø¹Ø§Ù„Ø¬Ø©":"ÙØ´Ù„Øª"})]})]})]})]},a.id))})}):t.jsx("div",{className:"overflow-y-auto overscroll-contain scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400 transition-colors max-h-[calc(100dvh-300px)]",children:t.jsx("div",{className:"space-y-2 pr-2",children:ql.map(a=>t.jsxs("div",{className:"relative flex items-center gap-4 p-4 rounded-xl bg-gray-50 border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>Yu(a),children:[t.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center shrink-0 ${a.type==="withdraw"?"bg-red-100":"bg-green-100"}`,children:(()=>{const r=a,o=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª";return o?t.jsx(ln,{className:"h-5 w-5 text-gray-600"}):c?t.jsx(Pt,{className:"h-5 w-5 text-green-600"}):d?t.jsx(ln,{className:"h-5 w-5 text-green-600"}):a.type==="withdraw"?t.jsx(ir,{className:"h-5 w-5 text-red-600"}):t.jsx(wm,{className:"h-5 w-5 text-green-600"})})()}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("h4",{className:"text-base font-bold truncate",children:(()=>{const r=a,o=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",m=String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((r==null?void 0:r.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡");return o?t.jsx("span",{className:"text-foreground",children:"ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"}):c?t.jsx("span",{className:"text-foreground",children:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"}):d?t.jsx("span",{className:"text-foreground",children:"Ù…Ø¨ÙŠØ¹Ø§Øª"}):m?t.jsx("span",{className:"text-foreground",children:"Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡"}):a.type==="atm_withdraw"?t.jsx("span",{className:"text-green-600",children:"Ø³Ø­Ø¨ atm"}):a.type==="send"?t.jsx("span",{className:"text-green-600",children:"ØªØ­ÙˆÙŠÙ„ Ø£Ù…ÙˆØ§Ù„"}):t.jsx("span",{className:"text-red-600",children:"Ø³Ø­Ø¨ Ù†Ù‚Ø¯ÙŠ"})})()}),t.jsxs("span",{className:`text-base font-bold whitespace-nowrap ${a.type==="withdraw"?"text-red-600":"text-green-600"}`,children:[a.type==="withdraw"||a.type==="cash_addition"||a.txnType==="cash_addition"||a.type==="sales"||a.txnType==="sales"?"+":"-"," ",ws(a.amount)," Ø¬.Ù…"]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex flex-col gap-0.5",children:[t.jsx("p",{className:"text-sm text-muted-foreground truncate",children:(()=>{const r=a,o=(r==null?void 0:r.type)==="report"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((r==null?void 0:r.type)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.type)||"").toLowerCase()==="add"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="cash_addition"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),d=String((r==null?void 0:r.type)||"").toLowerCase()==="sales"||String((r==null?void 0:r.txnType)||"").toLowerCase()==="sales"||String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((r==null?void 0:r.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",m=String((r==null?void 0:r.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((r==null?void 0:r.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡"),f=(r==null?void 0:r.note)||(r==null?void 0:r.notes)||"";if(o)return`Ø¥Ù„Ù‰: ${a.receiverPhone}`;if(c)return f||"Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠØ©";if(d){const g=((r==null?void 0:r.saleProductName)||"").trim(),w=((r==null?void 0:r.saleQuantity)??"").toString();return g&&w?`${g} Ã— ${w}`:g||"Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹"}return m?`Ù…Ù†: ${r.senderName||"Ù…Ø§ÙƒÙŠÙ†Ø©"}`:a.type==="send"?t.jsx("span",{dir:"ltr",children:a.receiverPhone}):t.jsx("span",{dir:"ltr",children:a.senderPhone})})()}),t.jsxs("p",{className:"text-sm font-medium text-gray-500 mt-0.5",children:[tn.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))," - ",Gu.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))]})]}),t.jsxs("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium flex items-center gap-1 ${a.status==="completed"?a.type==="withdraw"?"bg-red-100 text-red-700":"bg-green-100 text-green-700":a.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[a.status==="completed"&&t.jsx(Li,{className:"h-3 w-3"}),a.status==="pending"&&t.jsx(zl,{className:"h-3 w-3"}),a.status==="failed"&&t.jsx(cn,{className:"h-3 w-3"}),t.jsx("span",{children:a.status==="completed"?"Ù†Ø§Ø¬Ø­Ø©":a.status==="pending"?"Ù…Ø¹Ø§Ù„Ø¬Ø©":"ÙØ´Ù„Øª"})]})]})]})]},a.id))})}),M&&t.jsxs("div",{className:"mt-2 flex justify-end",children:[t.jsxs(I,{variant:"ghost",size:"sm",className:"h-7 px-2 text-[11px] rounded-full border bg-red-100 text-red-700 border-red-300 hover:bg-red-200",onClick:()=>ui(!0),title:"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©",children:[t.jsx(Sa,{className:"h-3 w-3 mr-1"}),"ØªØµÙÙŠØ±"]}),(e==null?void 0:e.uid)&&localStorage.getItem(`recentTransactionsResetAt:${e.uid}`)&&t.jsx("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-red-500 ml-1 align-middle"})]})]})]})]}),t.jsx(qw,{isOpen:rf,onClose:()=>qn(!1),transaction:nf,onPrint:()=>window.print(),onDelete:uf,onComplete:mf}),t.jsx(ue,{open:Xh,onOpenChange:ao,children:t.jsxs(me,{className:"sm:max-w-md",children:[t.jsx(ye,{children:t.jsx(he,{children:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø·ÙˆØ±"})}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"flex flex-col items-center gap-4 bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-900/20 dark:to-blue-900/20 p-6 rounded-xl border border-blue-100 dark:border-blue-800 text-center",children:[t.jsx("div",{className:"h-16 w-16 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400 shadow-sm",children:t.jsx(Yp,{className:"h-8 w-8"})}),t.jsxs("div",{className:"space-y-3 w-full",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ·ÙˆÙŠØ±"}),t.jsx("p",{className:"text-lg font-bold bg-gradient-to-r from-blue-700 to-indigo-700 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent leading-relaxed",children:"ØªÙ… ØªØ·ÙˆÙŠØ± Ø§Ù„Ø§Ø¨Ù„ÙƒÙŠØ´Ù† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨ÙˆØ§Ø³Ø·Ø© Ù…/Ø£Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­ÙŠÙ… Ù…Ø­Ù…Ø¯"}),t.jsxs("div",{className:"flex flex-col items-center gap-1 mt-4",children:[t.jsx("p",{className:"text-base font-semibold text-gray-800 dark:text-gray-300",children:"Ø±Ù‚Ù… Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„ÙˆØ­ÙŠØ¯ Ù„Ù†Ø§"}),t.jsx("a",{href:"tel:01000392539",className:"text-2xl font-black text-blue-600 dark:text-blue-400 tracking-wider hover:underline",dir:"ltr",children:"01000392539"})]}),t.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 font-bold bg-red-50 dark:bg-red-900/20 py-1 px-3 rounded-full inline-block mt-2",children:"Ù„ÙŠØ³ Ù„Ù†Ø§ Ø§ÙŠ Ø§Ø±Ù‚Ø§Ù… Ø§Ø®Ø±ÙŠ"})]})]}),t.jsx("div",{className:"text-center text-xs text-gray-400 mt-2",children:qc?`v${qc}`:"v1.0.0"})]}),t.jsx(We,{children:t.jsx(I,{onClick:()=>ao(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),t.jsxs("div",{className:"space-y-1 fade-in-right w-full",children:[t.jsxs(Za,{id:"transaction-section",className:"bg-gray-100 border border-blue-200/40 rounded-lg shadow-lg hover:shadow-lg transition-all duration-200 group relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 via-indigo-500/3 to-purple-500/5 opacity-0 group-hover:opacity-100 transition-opacity duration-200"}),t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 sm:w-28 sm:h-28 lg:w-20 lg:h-20 bg-gradient-to-bl from-blue-400/10 to-transparent rounded-full  "}),t.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-indigo-400/10 to-transparent rounded-full  ",style:{animationDelay:"1s"}}),t.jsx(bs,{className:"sticky top-0 z-20 bg-white/80 dark:bg-gray-900/80 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-gray-900/60 pb-0.5 px-3 pt-1 lg:pt-0.5 lg:pb-0.5 lg:px-2",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(vs,{className:"text-sm font-bold flex items-center gap-2 text-gray-800",children:[t.jsxs("div",{className:"relative",children:[t.jsx(zi,{className:"h-1 w-1 text-emerald-500 "}),t.jsx("div",{className:"absolute inset-0 h-1 w-1 bg-emerald-400 rounded-full opacity-20 "})]}),t.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Ø¥Ø¬Ø±Ø§Ø¡ Ù…Ø¹Ø§Ù…Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©"})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsxs("div",{className:"top-icons-bar hidden md:flex items-center gap-2 bg-gradient-to-r from-gray-50 to-slate-50 hover:from-gray-100 hover:to-slate-100 border border-gray-200 transition-all duration-300 hover:scale-105 h-9 px-3 rounded-xl shadow-sm",children:[t.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Ø±Ø§Ø­Ø© Ø§Ù„Ø¹ÙŠÙ†",onClick:()=>ru(!qs),children:t.jsx(zp,{className:`h-5 w-5 transition-colors duration-300 ${qs?"text-orange-500 fill-orange-500":"text-gray-600"}`})}),t.jsx(xw,{}),t.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"VIP",onClick:()=>Ho(!0),children:t.jsx(ux,{className:"h-5 w-5 text-yellow-500"})}),t.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ±ÙˆØ¹",onClick:()=>(Dt==null?void 0:Dt.status)==="active"?gr(!0):pr(!0),children:t.jsx(nn,{className:"h-5 w-5"})}),t.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø·ÙˆØ±",onClick:()=>ao(!0),children:t.jsx(gm,{className:"h-5 w-5 text-gray-600"})}),t.jsx(ix,{})]})}),Pg&&t.jsxs(I,{variant:"outline",size:"sm",className:"hidden flex items-center gap-1.5 sm:gap-2 bg-gradient-to-r from-cyan-50 to-blue-50 hover:from-cyan-100 hover:to-blue-100 border-cyan-200 text-cyan-800 text-xs sm:text-sm transition-all duration-300 hover:scale-105 hover:shadow-lg h-10 sm:h-12 px-4 sm:px-5 rounded-xl min-w-[44px] touch-manipulation",onClick:Lu,title:"Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…",children:[t.jsx(Jl,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 animate-spin"}),t.jsx("span",{className:"text-xs sm:text-sm font-semibold whitespace-nowrap",children:"Ù…Ø²Ø§Ù…Ù†Ø©"})]})]})}),t.jsx(ue,{open:Mf,onOpenChange:Ho,children:t.jsxs(me,{className:"sm:max-w-md",children:[t.jsx(ye,{children:t.jsx(he,{children:"Ø£ÙØ¶Ù„ 10 Ø¹Ù…Ù„Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±"})}),t.jsx("div",{className:"space-y-2",children:Di.length===0?t.jsx("div",{className:"text-sm text-gray-600",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±"}):Di.map((a,r)=>t.jsxs("div",{className:`flex items-center justify-between border rounded-md px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700 ${r===0?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-300 dark:border-yellow-700":""}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(La,{variant:"outline",className:`min-w-[28px] justify-center ${r===0?"border-yellow-300 text-yellow-700 dark:text-yellow-400 bg-yellow-50 dark:bg-yellow-900/20":""}`,children:r+1}),t.jsx("span",{className:`font-semibold ${r===0?"text-yellow-700":""}`,children:a.phone})]}),t.jsxs("div",{className:"text-sm text-gray-700 flex items-center gap-3",children:[t.jsxs("span",{children:["Ø¹Ø¯Ø¯: ",a.count]}),t.jsxs("span",{children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ",a.total]}),t.jsx(I,{variant:"outline",size:"sm",className:"h-8",onClick:()=>_g(a),title:"Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨",children:t.jsx(Hl,{className:"h-4 w-4"})})]})]},a.phone+r))}),t.jsx(We,{children:t.jsx(I,{onClick:()=>Ho(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),t.jsx(ue,{open:Af,onOpenChange:Vd,children:t.jsxs(me,{className:"sm:max-w-md",children:[t.jsx(ye,{children:t.jsx(he,{children:"Ø±Ø¨Ø· Ø¨ÙˆØª Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù…"})}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{children:"Telegram Chat ID"}),t.jsx(Z,{value:ei,onChange:a=>Tf(a.target.value),placeholder:"Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(G,{children:"Ø¥Ø±Ø³Ø§Ù„ ÙŠÙˆÙ…ÙŠ 12 ØµØ¨Ø§Ø­Ø§Ù‹"}),t.jsx(nx,{checked:qd,onCheckedChange:a=>Pf(!!a)})]})]}),t.jsxs(We,{children:[t.jsx(I,{variant:"outline",onClick:()=>Vd(!1),children:"Ø¥ØºÙ„Ø§Ù‚"}),t.jsx(I,{onClick:async()=>{e!=null&&e.uid&&(await ae.updateUserData(e.uid,{telegramChatId:ei,telegramDailyEnabled:qd}),y({title:"ØªÙ… Ø§Ù„Ø­ÙØ¸"}))},children:"Ø­ÙØ¸"}),t.jsx(I,{onClick:async()=>{if(!(e!=null&&e.uid)||!ei){y({title:"Ø£Ø¯Ø®Ù„ Chat ID"});return}const a=await Bu();try{const{sendTelegramMessage:r}=await ne(async()=>{const{sendTelegramMessage:o}=await import("./functions-VHUwf-oY.js");return{sendTelegramMessage:o}},__vite__mapDeps([63,0,1]),import.meta.url);await r({chatId:ei,text:a}),y({title:"ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„"})}catch{y({title:"ØªØ¹Ø°Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ø¨Ø· Ø§Ù„Ø¨ÙˆØª",variant:"destructive"})}},children:"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¢Ù†"})]})]})}),t.jsx(ue,{open:fr,onOpenChange:gr,children:t.jsxs(me,{className:"sm:max-w-2xl bg-gray-50/80 backdrop-blur-sm",children:[t.jsx(ye,{className:"border-b pb-4 mb-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:t.jsx(nn,{className:"w-6 h-6 text-indigo-600"})}),t.jsxs("div",{children:[t.jsx(he,{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ±ÙˆØ¹"}),t.jsx(et,{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Ø£Ø¶Ù ÙØ±ÙˆØ¹Ø§Ù‹ Ø¬Ø¯ÙŠØ¯Ø© ÙˆØªØ§Ø¨Ø¹ Ø£Ø¯Ø§Ø¡ ÙƒÙ„ ÙØ±Ø¹ Ø¨Ø³Ù‡ÙˆÙ„Ø©"})]})]}),t.jsx(I,{size:"icon",variant:_s?"destructive":"default",className:`rounded-full transition-all duration-300 ${_s?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200":"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg hover:shadow-indigo-200"}`,onClick:()=>$c(!_s),title:_s?"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¥Ø¶Ø§ÙØ©":"Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¹ Ø¬Ø¯ÙŠØ¯",children:_s?t.jsx(Wi,{className:"w-6 h-6"}):t.jsx(Pt,{className:"w-6 h-6"})})]})}),t.jsxs("div",{className:"space-y-6",children:[_s&&t.jsxs("div",{className:"bg-white dark:bg-card p-5 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm space-y-4 animate-in slide-in-from-top-4 fade-in duration-300",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-indigo-700 dark:text-indigo-400 font-semibold",children:[t.jsx(Pt,{className:"w-5 h-5"}),t.jsx("h3",{children:"Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¹ Ø¬Ø¯ÙŠØ¯"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(I,{onClick:()=>checkSubscriptionStatus(!0).then(()=>y({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"})),variant:"ghost",size:"icon",title:"ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ",children:t.jsx(Jl,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})}),t.jsxs(I,{onClick:()=>pr(!0),variant:"outline",size:"sm",className:"gap-2",children:[t.jsx(bx,{className:"w-4 h-4"}),"Ø·Ù„Ø¨ Ø²ÙŠØ§Ø¯Ø© ÙØ±Ø¹"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{className:"text-gray-700 dark:text-gray-300",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±"}),t.jsxs("div",{className:"relative",children:[t.jsx(on,{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400"}),t.jsx(Z,{className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:Tc,onChange:a=>ro(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{className:"text-gray-700 dark:text-gray-300",children:"Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹"}),t.jsxs("div",{className:"relative",children:[t.jsx(nn,{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400"}),t.jsx(Z,{className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:Pc,onChange:a=>no(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: ÙØ±Ø¹ ÙˆØ³Ø· Ø§Ù„Ø¨Ù„Ø¯"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{className:"text-gray-700 dark:text-gray-300",children:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø¯Ø®ÙˆÙ„"}),t.jsxs("div",{className:"relative",children:[t.jsx(Hl,{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400"}),t.jsx(Z,{className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:Mc,onChange:a=>io(a.target.value),placeholder:"branch@example.com"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{className:"text-gray-700 dark:text-gray-300",children:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400",children:"ðŸ”’"}),t.jsx(Z,{type:"password",className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:Oc,onChange:a=>oo(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("create-branch-btn"))==null||r.click())},placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢"})]})]})]}),t.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[t.jsx(I,{variant:"ghost",onClick:()=>{ro(""),no(""),io(""),oo("")},className:"text-gray-500 hover:text-gray-700",children:"Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„"}),t.jsx(I,{id:"create-branch-btn",className:"bg-indigo-600 hover:bg-indigo-700 text-white min-w-[120px]",disabled:lo,onClick:async()=>{if(!(e!=null&&e.uid))return;const a=Tc.trim(),r=Pc.trim(),o=Mc.trim(),c=Oc.trim();if(!a||!r||!o||!c){y({title:"ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)){y({title:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­",variant:"destructive"});return}if(c.length<6){y({title:"ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„",variant:"destructive"});return}const m=(Dt==null?void 0:Dt.limit)||0;if(xr.length>=m){y({title:"Ø¹ÙÙˆØ§Ù‹",description:`Ù„Ù‚Ø¯ ÙˆØµÙ„Øª Ù„Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù…Ù† Ø§Ù„ÙØ±ÙˆØ¹ (${m} ÙØ±ÙˆØ¹)`,variant:"destructive"});return}try{kn(!0);let f="",g="";const w=`tempApp_${Date.now()}`,N=Mp(Op,w),x=Ep(N),v=Rp(N);try{f=(await Lp(x,o,c)).user.uid;try{await sa(Ae(v,"users",f),{email:o,isBranch:!0,ownerId:e.uid,createdAt:gt(),updatedAt:gt(),role:"branch",isActive:!1,subscription:{isActive:!1,planType:null,startDate:null,endDate:null}})}catch(_){console.error("Error creating branch user document:",_)}try{g=(await dn(ce(v,"shops"),{name:r,ownerId:f,managerName:a,createdAt:gt(),updatedAt:gt(),isActive:!0})).id}catch(_){console.error("Error creating shop as new user:",_);try{g=(await dn(ce(v,"users",f,"shops"),{name:r,ownerId:f,managerName:a,createdAt:gt(),updatedAt:gt(),isActive:!0})).id}catch(O){throw console.error("Error creating shop in subcollection:",O),_}}await Wp(x)}catch(S){console.error("Registration/Shop Creation Error:",S);let _="ØªØ¹Ø°Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ù…ØªØ¬Ø±";S.code==="auth/email-already-in-use"&&(_="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„"),S.code==="auth/invalid-email"&&(_="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­"),S.code==="auth/weak-password"&&(_="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ©"),S.code==="permission-denied"&&(_="Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù…ØªØ¬Ø± Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"),y({title:_,description:S.message,variant:"destructive"});try{await pm(N)}catch{}return}finally{try{await pm(N)}catch(S){console.warn("Error deleting temp app:",S)}}if(!f||!g)return;const j=S=>{try{return btoa(unescape(encodeURIComponent(S)))}catch{return btoa(S)}};try{const S={ownerId:e.uid,shopId:g,branchUserId:f,branchName:r,managerName:a,loginUsername:o,passwordEncoded:j(c),createdAt:gt()};await sa(Ae(F,"users",e.uid,"branches",f),S);try{await dn(ce(F,"branches"),S)}catch(O){console.warn("Branch ref creation error in root collection (non-fatal):",O)}const _={id:f,branchUserId:f,branchName:r,managerName:a,source:"sub",...S};so(O=>[...O,_])}catch(S){console.error("Branch ref creation error:",S),y({title:"Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹",description:"ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙ„ÙƒÙ† ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",variant:"destructive"})}ro(""),no(""),io(""),oo(""),y({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ±Ø¹ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­"})}catch(f){console.error("General Error adding branch:",f),y({title:"ØªØ¹Ø°Ù‘Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ±Ø¹",description:f.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹"})}finally{kn(!1)}},children:lo?"Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø¶Ø§ÙØ©...":"Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¹"})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[t.jsx("div",{className:"w-1.5 h-6 bg-indigo-500 rounded-full"}),"Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠØ©",t.jsxs(La,{variant:"secondary",className:"mr-auto",children:[xr.length," / ",(Dt==null?void 0:Dt.limit)||0]})]}),lo&&xr.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-gray-500",children:[t.jsx(Jl,{className:"w-8 h-8 animate-spin mb-2 text-indigo-400"}),t.jsx("p",{children:"Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ±ÙˆØ¹..."})]}):xr.length===0?t.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-200 dark:border-gray-800 rounded-xl bg-gray-50 dark:bg-gray-900/50",children:[t.jsx(nn,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-2"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙØ±ÙˆØ¹ Ù…Ø¶Ø§ÙØ© Ø­Ø§Ù„ÙŠØ§Ù‹"})]}):t.jsx("div",{className:"grid grid-cols-1 gap-3",children:xr.map(a=>{var r;return t.jsx("div",{className:"group relative bg-white dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl p-4 shadow-sm hover:shadow-md transition-all duration-200",children:t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-700 dark:text-indigo-400 font-bold text-lg",children:((r=a.branchName)==null?void 0:r.charAt(0))||"B"}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-bold text-gray-900 dark:text-gray-100 text-lg",children:a.branchName}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[t.jsx(on,{className:"w-3 h-3"}),t.jsxs("span",{children:["Ø§Ù„Ù…Ø¯ÙŠØ±: ",a.managerName]})]})]})]}),t.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto mt-2 sm:mt-0",children:[t.jsxs(I,{className:"flex-1 sm:flex-none bg-indigo-50 text-indigo-700 hover:bg-indigo-100 border border-indigo-200 dark:bg-indigo-900/20 dark:text-indigo-300 dark:hover:bg-indigo-900/30 dark:border-indigo-800",onClick:()=>g0(a),children:[t.jsx(Gl,{className:"w-4 h-4 ml-2"}),"Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"]}),t.jsx(I,{variant:"ghost",size:"icon",className:"text-blue-500 hover:text-blue-700 hover:bg-blue-50 dark:text-blue-400 dark:hover:text-blue-300 dark:hover:bg-blue-900/20",title:"ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹",onClick:()=>h0(a),children:t.jsx(km,{className:"w-4 h-4"})})]})]})},a.id)})})]})]})]})}),t.jsx(ue,{open:e0,onOpenChange:co,children:t.jsxs(me,{className:"sm:max-w-md",children:[t.jsxs(ye,{children:[t.jsx(he,{children:"Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ±Ø¹"}),t.jsx(et,{children:"Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙØ±Ø¹ Ø§Ù„Ù…Ø­Ø¯Ø¯"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx(G,{children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ)"}),t.jsx(Z,{value:Ec,onChange:a=>Rc(a.target.value),placeholder:"example@email.com"})]}),t.jsxs("div",{children:[t.jsx(G,{children:"ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±"}),t.jsx(Z,{type:"password",value:Lc,onChange:a=>Wc(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("branch-login-btn"))==null||r.click())},placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢"})]}),t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx(I,{variant:"outline",onClick:()=>{Rc(""),Wc("")},children:"Ù…Ø³Ø­"}),t.jsx(I,{id:"branch-login-btn",className:"bg-blue-600 hover:bg-blue-700",disabled:a0,onClick:async()=>{const a=t0;if(!a){co(!1);return}const r=String(a.loginUsername||"");let o="";try{const m=String(a.passwordEncoded||"");o=m?decodeURIComponent(escape(atob(m))):""}catch{try{o=a.passwordEncoded?atob(String(a.passwordEncoded)):""}catch{o=""}}const c=Ec.trim(),d=Lc.trim();if(!c||!d){y({title:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±"});return}if(c!==r||d!==o){y({title:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©",variant:"destructive"});return}try{Fc(!0);const m=e!=null&&e.uid?`selectedShopId_${e.uid}`:"selectedShopId";localStorage.setItem(m,String(a.shopId)),y({title:"ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙØ±Ø¹",description:String(a.branchName||"")}),co(!1),gr(!1),p("/user/dashboard")}catch{}Fc(!1)},children:"Ø¯Ø®ÙˆÙ„"})]})]})]})}),t.jsx(ue,{open:s0,onOpenChange:Cn,children:t.jsxs(me,{className:"sm:max-w-2xl",children:[t.jsxs(ye,{children:[t.jsxs(he,{children:["Ø¨ÙŠØ§Ù†Ø§Øª ÙØ±Ø¹ ",Et==null?void 0:Et.branchName]}),t.jsxs(et,{children:["Ù…Ø¯ÙŠØ± Ø§Ù„ÙØ±Ø¹: ",Et==null?void 0:Et.managerName]})]}),r0?t.jsx("div",{className:"py-8 flex justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):Et?t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 py-4",children:[t.jsxs("div",{className:"p-4 border rounded-xl bg-green-50 dark:bg-green-950/20 dark:border-green-900/30",children:[t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…"}),t.jsxs("div",{className:"text-xl font-bold text-green-700 dark:text-green-400",children:[Number(Et.todaySales||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),t.jsxs("div",{className:"p-4 border rounded-xl bg-blue-50 dark:bg-blue-950/20 dark:border-blue-900/30",children:[t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø´Ù‡Ø±"}),t.jsxs("div",{className:"text-xl font-bold text-blue-700 dark:text-blue-400",children:[Number(Et.monthSales||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),t.jsxs("div",{className:"p-4 border rounded-xl bg-emerald-50 dark:bg-emerald-950/20 dark:border-emerald-900/30",children:[t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ø§Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…"}),t.jsxs("div",{className:"text-xl font-bold text-emerald-700 dark:text-emerald-400",children:[Number(Et.todayProfit||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),t.jsxs("div",{className:"p-4 border rounded-xl bg-cyan-50 dark:bg-cyan-950/20 dark:border-cyan-900/30",children:[t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ø§Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±"}),t.jsxs("div",{className:"text-xl font-bold text-cyan-700 dark:text-cyan-400",children:[Number(Et.monthProfit||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),t.jsxs("div",{className:"p-4 border rounded-xl bg-purple-50 dark:bg-purple-950/20 dark:border-purple-900/30",children:[t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),t.jsxs("div",{className:"text-xl font-bold text-purple-700 dark:text-purple-400",children:[Number(Et.walletsTotal||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),t.jsxs("div",{className:"p-4 border rounded-xl bg-yellow-50 dark:bg-yellow-950/20 dark:border-yellow-900/30",children:[t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ø¯Ø±Ø¬"}),t.jsxs("div",{className:"text-xl font-bold text-yellow-700 dark:text-yellow-400",children:[Number(Et.cashBalance||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),t.jsxs("div",{className:"p-4 border rounded-xl bg-indigo-50 dark:bg-indigo-950/20 dark:border-indigo-900/30",children:[t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¨ÙŠØ¹Ø§Øª Ù‚Ø³Ù… Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"}),t.jsxs("div",{className:"text-xl font-bold text-indigo-700 dark:text-indigo-400",children:[Number(Et.totalSalesSection||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]}),t.jsxs("div",{className:"p-4 border rounded-xl bg-red-50 dark:bg-red-950/20 dark:border-red-900/30",children:[t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¯ÙŠÙˆÙ†"}),t.jsxs("div",{className:"text-xl font-bold text-red-700 dark:text-red-400",children:[Number(Et.debtsTotal||0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬.Ù…"]})]})]}):null,t.jsx(We,{children:t.jsx(I,{onClick:()=>Cn(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),t.jsx(ue,{open:c0,onOpenChange:In,children:t.jsxs(me,{className:"sm:max-w-md",children:[t.jsxs(ye,{children:[t.jsx(he,{children:"ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹"}),t.jsx(et,{children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹ ÙˆØ§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±"})]}),t.jsxs("div",{className:"space-y-4 py-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{children:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)"}),t.jsx(Z,{value:u0,readOnly:!0,disabled:!0,placeholder:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø±ÙŠØ¯ Ù…Ø³Ø¬Ù„",className:"bg-gray-100 dark:bg-gray-800 text-black dark:text-gray-100 opacity-100 font-medium"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{children:"Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹"}),t.jsx(Z,{value:_n,onChange:a=>Kc(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: ÙØ±Ø¹ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±"}),t.jsx(Z,{value:An,onChange:a=>Jc(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯"})]})]}),t.jsxs(We,{children:[t.jsx(I,{variant:"outline",onClick:()=>In(!1),children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{onClick:f0,disabled:Hc,children:Hc?"Ø¬Ø§Ø±Ù Ø§Ù„Ø­ÙØ¸...":"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª"})]})]})}),t.jsxs(es,{ref:$t,className:"space-y-1 px-2 pb-2 relative z-10 transition-transform duration-200 ease-out will-change-transform",style:{transform:$e?`translateY(${$e}px)`:void 0},onFocusCapture:a=>{const r=a.target;if(!((r==null?void 0:r.id)==="transferExtraFeeInput")){Ke(0);return}const c=document.getElementById("transferSubmitButton");if(c){const d=c.getBoundingClientRect(),m=window.innerHeight;if(d.bottom>m){const f=d.bottom-m,g=Math.min(f,220);Ke(-g)}else Ke(0)}else Ke(0)},onBlurCapture:a=>{a.currentTarget.contains(a.relatedTarget)||Ke(0)},children:[t.jsxs("div",{className:"transaction-type-tabs flex w-full rounded-full border border-gray-300 dark:border-gray-700 overflow-hidden bg-surface dark:bg-card",children:[t.jsxs("button",{type:"button",onClick:()=>Pi("transfer"),className:`flex-1 h-10 text-sm font-medium transition-colors duration-200 flex items-center justify-center gap-2 ${B==="transfer"?"bg-blue-100 text-blue-900 dark:bg-blue-900/40 dark:text-blue-100":"bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:[B==="transfer"&&t.jsx(Li,{className:"h-4 w-4"}),t.jsx(rn,{className:"h-4 w-4"}),"ØªØ­ÙˆÙŠÙ„"]}),t.jsx("div",{className:"w-[1px] bg-gray-300 dark:bg-gray-700"}),t.jsxs("button",{type:"button",onClick:()=>ke("withdrawals",()=>Pi("withdraw")),className:`flex-1 h-10 text-sm font-medium transition-colors duration-200 flex items-center justify-center gap-2 ${B==="withdraw"?"bg-red-100 text-red-900 dark:bg-red-900/40 dark:text-red-100":"bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:[B==="withdraw"&&t.jsx(Li,{className:"h-4 w-4"}),t.jsx(ir,{className:"h-4 w-4"}),"Ø³Ø­Ø¨"]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-3",children:[t.jsxs("label",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 whitespace-nowrap",children:[t.jsx(ar,{className:"h-4 w-4 text-blue-600"}),"Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø©"]}),t.jsxs("div",{className:"flex items-center gap-1 justify-end overflow-x-auto scrollbar-hide",children:[t.jsxs(I,{variant:"outline",size:"sm",className:"h-7 rounded-md px-2 text-[10px] font-medium bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border-emerald-200 shadow-sm whitespace-nowrap",onClick:()=>p("/user/add-wallet"),title:"Ø¥Ø¶Ø§ÙØ© Ù…Ø­ÙØ¸Ø©",children:[t.jsx(Pt,{className:"h-3 w-3 mr-1"}),"Ø¥Ø¶Ø§ÙØ© Ù…Ø­ÙØ¸Ø©"]}),t.jsxs(I,{variant:"outline",size:"sm",className:"h-7 rounded-md px-2 text-[10px] font-medium bg-orange-50 text-orange-700 hover:bg-orange-100 border-orange-200 shadow-sm whitespace-nowrap",onClick:()=>ba(!0),title:"Ø·Ø¨Ø§Ø¹Ø© Ù…Ø­ÙØ¸Ø©",children:[t.jsx(mx,{className:"h-3 w-3 mr-1"}),"Ø·Ø¨Ø§Ø¹Ø©"]}),t.jsxs(I,{variant:"outline",size:"sm",className:"h-7 rounded-md px-2 text-[10px] font-medium bg-indigo-50 text-indigo-700 hover:bg-indigo-100 border-indigo-200 shadow-sm whitespace-nowrap",onClick:()=>{Ln(!0)},title:"Ø§Ù„Ù…Ø­Ø§ÙØ¸",children:[t.jsx(ar,{className:"h-3 w-3 mr-1"}),"Ø§Ù„Ù…Ø­Ø§ÙØ¸"]})]})]}),X.length>0?t.jsxs(Fa,{value:L,onValueChange:Rg,children:[t.jsx(Ba,{"data-testid":"wallet-select",className:"w-full h-14 text-base bg-surface border border-gray-400 hover:border-gray-800 focus:border-primary rounded-xl transition-colors duration-200 flex items-center",children:t.jsx($a,{placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ù…Ø¹Ø§Ù…Ù„Ø©",className:"text-gray-700"})}),t.jsxs(Ua,{className:"rounded-xl border border-gray-200 dark:border-gray-800 shadow-md z-[9999] bg-white dark:bg-gray-900",children:[t.jsx("div",{"data-fixed-header":"true",className:"sticky top-0 z-10 bg-white dark:bg-gray-900 p-2 border-b border-gray-100 dark:border-gray-800",children:t.jsx(Z,{value:Sd,onChange:a=>ef(a.target.value),placeholder:"Ø§Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©",className:"h-10 text-sm border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-950 text-gray-900 dark:text-gray-100 rounded-lg"})}),t.jsx("div",{className:"p-1",children:kd.length===0?t.jsx("div",{className:"text-sm text-gray-500 p-3 text-center",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©"}):kd.map(a=>{const r=Is.includes(a.id);let o=null;const c=nc(a.phone),d=nc(J),m=nc(se);return d&&c===d?o=t.jsx("span",{className:"mr-1 text-[10px] font-bold bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded border border-blue-200 whitespace-nowrap",children:"SIM 1"}):m&&c===m&&(o=t.jsx("span",{className:"mr-1 text-[10px] font-bold bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded border border-purple-200 whitespace-nowrap",children:"SIM 2"})),t.jsx(oa,{value:a.id,className:"rounded-lg my-1 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 focus:bg-blue-50 dark:focus:bg-blue-900/20 transition-colors duration-200",children:t.jsxs("div",{className:"flex items-center gap-3 py-2 w-full",children:[t.jsx(ar,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),t.jsxs("div",{className:"flex items-center gap-2 text-right",children:[t.jsx("span",{className:"text-base font-medium text-gray-900 dark:text-gray-100",children:a.name}),t.jsx("span",{className:"text-sm font-bold text-red-600 dark:text-red-400",children:a.phone}),o]}),a.isDefault&&t.jsx("span",{className:"mr-auto text-[10px] bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 px-2 py-0.5 rounded-full border border-gray-200 dark:border-gray-700",children:"Ø§ÙØªØ±Ø§Ø¶ÙŠ"}),t.jsx("button",{type:"button",onMouseDown:f=>{f.preventDefault(),f.stopPropagation(),tf(a.id)},className:"ml-2 mr-auto rounded-full p-1 hover:bg-yellow-50 dark:hover:bg-yellow-900/20 cursor-pointer",title:r?"Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©":"ØªØ¹ÙŠÙŠÙ† ÙƒÙ…Ø­ÙØ¸Ø© Ù…ÙØ¶Ù„Ø©",children:t.jsx(hx,{className:`h-4 w-4 ${r?"text-yellow-500 fill-yellow-400 drop-shadow-[0_0_4px_rgba(250,204,21,0.8)]":"text-gray-400"}`})})]})},a.id)})})]})]}):t.jsx("div",{className:"rounded-xl border-2 border-dashed border-gray-200 bg-gray-50 px-3 py-3 text-xs text-gray-600",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†. Ø§Ø¶ØºØ· â€œØ¥Ø¶Ø§ÙØ© Ù…Ø­ÙØ¸Ø©â€ Ù„Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ù…Ø­ÙØ¸Ø©."})]}),t.jsx(ue,{open:P0,onOpenChange:pd,children:t.jsxs(me,{className:"sm:max-w-3xl w-[95vw] sm:w-auto max-h-[80vh] overflow-y-auto",children:[t.jsx(ye,{children:t.jsx(he,{children:"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø§ÙØ¸"})}),t.jsx("div",{className:"mt-2",children:t.jsx(nN,{showAddButton:!1,showUsageBars:!1,showLimitCards:!1,showEditButton:!0})})]})}),t.jsx(ea,{open:M0,onOpenChange:Ln,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ Ø§Ù„Ù…Ø­Ø§ÙØ¸",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸",onSuccess:()=>{Ln(!1),pd(!0)},userId:e==null?void 0:e.uid,userRole:n==null?void 0:n.role}),t.jsx(Vm,{isOpen:Ot,onClose:()=>ba(!1),wallets:X}),t.jsx(ea,{open:O0,onOpenChange:a=>{Ao(a),a||To(null)},mode:"verify",title:"ØªØ£ÙƒÙŠØ¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",onSuccess:()=>{xd&&(Qr(xd,"walletSelectionPin"),To(null)),Ao(!1)},userId:e==null?void 0:e.uid,userRole:n==null?void 0:n.role}),L&&X.length>0&&(()=>{var P;const a=X.find(U=>U.id===L),r=Ra,o=$g,c=(je==null?void 0:je.monthlyWithdrawLimit)??(a==null?void 0:a.monthlyWithdrawalLimit)??2e5,d=(je==null?void 0:je.monthlyTransferLimit)??(a==null?void 0:a.monthlyTransferLimit)??2e5,m=(je==null?void 0:je.monthlyWithdrawUsed)??r.totalWithdrawn??0,f=(je==null?void 0:je.monthlyTransferUsed)??r.totalTransferred??0,g=((P=Rt==null?void 0:Rt.subscription)==null?void 0:P.planType)===ta.TAHWEELA,w=g?0:(je==null?void 0:je.dailyWithdrawLimit)??1e5,N=g?0:(je==null?void 0:je.dailyTransferLimit)??6e4,x=g?0:(je==null?void 0:je.dailyWithdrawUsed)??o.totalWithdrawn??0,v=g?0:(je==null?void 0:je.dailyTransferUsed)??o.totalTransferred??0,j=parseFloat(yt||"0")||0,S=m+(B==="withdraw"?j:0),_=f+(B==="transfer"?j:0),O=x+(B==="withdraw"?j:0),A=v+(B==="transfer"?j:0);return a?t.jsxs("div",{className:"mb-2 space-y-2 p-2 bg-gray-50 dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 dark:border-gray-800 pb-1",children:[t.jsx("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-200",children:"Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©"}),t.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 px-2 py-0.5 rounded-full border border-gray-200 dark:border-gray-700",children:ag||(a==null?void 0:a.name)})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[t.jsx("span",{className:"text-gray-700",children:"Ø³Ø­Ø¨ Ø´Ù‡Ø±ÙŠ"}),t.jsxs("span",{className:"text-gray-600 dir-ltr",children:[Math.max(c-S,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),t.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:t.jsx("div",{className:"h-full bg-gradient-to-l from-red-500 to-red-600 rounded-full transition-all duration-500 ease-out shadow-sm",style:{width:`${Math.min(S/Math.max(c,1)*100,100)}%`}})}),t.jsxs("div",{className:"flex justify-between mt-0.5",children:[t.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",S.toLocaleString("en-US",{maximumFractionDigits:0})]}),t.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ø­Ø¯: ",c.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]}),t.jsx("div",{className:"w-[1px] bg-gray-200 self-stretch"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"ØªØ­ÙˆÙŠÙ„ Ø´Ù‡Ø±ÙŠ"}),t.jsxs("span",{className:"text-gray-600 dark:text-gray-400 dir-ltr",children:[Math.max(d-_,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),t.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:t.jsx("div",{className:"h-full bg-gradient-to-l from-blue-500 to-blue-600 rounded-full transition-all duration-500 ease-out shadow-sm",style:{width:`${Math.min(_/Math.max(d,1)*100,100)}%`}})}),t.jsxs("div",{className:"flex justify-between mt-0.5",children:[t.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",_.toLocaleString("en-US",{maximumFractionDigits:0})]}),t.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ø­Ø¯: ",d.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]})]})]}),t.jsxs("div",{className:"space-y-1 pt-1.5 border-t border-gray-200 dark:border-gray-800",children:[t.jsx("div",{className:"flex items-center justify-between mb-0.5",children:t.jsx("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-200",children:"Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©"})}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Ø³Ø­Ø¨ ÙŠÙˆÙ…ÙŠ"}),t.jsxs("span",{className:"text-gray-600 dark:text-gray-400 dir-ltr",children:[Math.max(w-O,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),t.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:t.jsx("div",{className:"h-full bg-gradient-to-l from-orange-400 to-orange-500 rounded-full transition-all duration-500 ease-out",style:{width:`${Math.min(O/Math.max(w,1)*100,100)}%`}})}),t.jsxs("div",{className:"flex justify-between mt-0.5",children:[t.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",O.toLocaleString("en-US",{maximumFractionDigits:0})]}),t.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ø­Ø¯: ",w.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]}),t.jsx("div",{className:"w-[1px] bg-gray-200 dark:bg-gray-800 self-stretch"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"ØªØ­ÙˆÙŠÙ„ ÙŠÙˆÙ…ÙŠ"}),t.jsxs("span",{className:"text-gray-600 dark:text-gray-400 dir-ltr",children:[Math.max(N-A,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),t.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:t.jsx("div",{className:"h-full bg-gradient-to-l from-green-500 to-green-600 rounded-full transition-all duration-500 ease-out",style:{width:`${Math.min(A/Math.max(N,1)*100,100)}%`}})}),t.jsxs("div",{className:"flex justify-between mt-0.5",children:[t.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",A.toLocaleString("en-US",{maximumFractionDigits:0})]}),t.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ø­Ø¯: ",N.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]})]})]})]}):null})(),B==="transfer"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø³Ù„"}),t.jsxs("div",{className:"relative group",children:[t.jsx(Ri,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-green-600 group-focus-within:text-green-700"}),t.jsx(Z,{value:Ht,onChange:a=>Rs(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){const r=document.getElementById("receiverPhoneInput");if(r)r.focus();else{const o=document.getElementById("amountInput");o==null||o.focus()}}},placeholder:"01030302038",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-blue-600 focus:ring-1 focus:ring-blue-600 dark:text-gray-100"})]})]}),!l&&t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„"}),t.jsxs("div",{className:"relative group",children:[t.jsx(Ri,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-green-600 group-focus-within:text-green-700"}),t.jsx(Z,{id:"receiverPhoneInput",value:kt,onChange:a=>{Ir(a.target.value),Vo&&Us(!1)},onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("amountInput");r==null||r.focus()}},inputMode:"numeric",maxLength:11,placeholder:"Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-blue-600 focus:ring-1 focus:ring-blue-600 dark:text-gray-100"})]})]})]}):t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„"}),t.jsxs("div",{className:"relative",children:[t.jsx(Ri,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-gray-400"}),t.jsx(Z,{value:L&&((em=X.find(a=>a.id===L))==null?void 0:em.phone)||"",readOnly:!0,placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹",className:"pl-10 h-10 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl dark:text-gray-100"})]})]}),B==="transfer"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬Ù†ÙŠÙ‡)"}),t.jsxs("div",{className:"relative flex items-center gap-2 group",children:[t.jsx(Va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-yellow-600 group-focus-within:text-yellow-700"}),t.jsx(Z,{id:"amountInput",value:yt,onChange:a=>{Ls(a.target.value),Vo&&Us(!1)},onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("transferCommissionInput");if(r)r.focus();else{const o=document.getElementById("quickDebtButton");o==null||o.focus()}}},placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",type:"number",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-blue-600 focus:ring-1 focus:ring-blue-600 dark:text-gray-100"})]}),la?t.jsxs("div",{className:"mt-2 text-xs text-green-700 dark:text-green-400 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-900/30 rounded px-2 py-1 flex items-center gap-2",children:[t.jsxs("span",{children:["ØªÙ… Ø¥Ø¯Ø®Ø§Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø¬Ù„ Ù„Ù€ ",la.debtorName," Ø¨Ù…Ø¨Ù„Øº ",la.amount," Ø¬Ù†ÙŠÙ‡"]}),t.jsx(I,{type:"button",variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>_o(null),children:"Ø¥Ù„ØºØ§Ø¡"})]}):null]}),(()=>{if(l)return null;const a=ot();return a&&a.defaultTransferCommission!=null?t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ (ØªÙ„Ù‚Ø§Ø¦ÙŠØ©)"}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Ø³ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„ÙƒÙ„ Ø£Ù„Ù: ",a==null?void 0:a.defaultTransferCommission," Ø¬Ù†ÙŠÙ‡ Ù„ÙƒÙ„ Ø£Ù„Ù"]}),t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx(I,{id:"quickDebtButton",type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium",onClick:()=>{const o=ot(),c=(o==null?void 0:o.defaultTransferCommission)!=null?Number(o.defaultTransferCommission):0,d=parseFloat(yt||"0")||0,m=Math.round((c||0)*d/1e3*100)/100,f=d+m;ds((f||0).toString()),Pe?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Ws(!0)},children:"Ø£Ø¬Ù„"}),t.jsx(I,{type:"button",variant:"outline",size:"icon",className:"hidden",title:Ge?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…",children:Ge?t.jsx(Pt,{className:"h-4 w-4 text-green-600"}):t.jsx(Wi,{className:"h-4 w-4 text-red-600"})}),t.jsx("span",{className:"hidden",children:Ge?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…"})]})]}):t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (Ø¬Ù†ÙŠÙ‡)"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1 group",children:[t.jsx(Va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-yellow-600 group-focus-within:text-yellow-700"}),t.jsx(Z,{id:"transferCommissionInput",value:Ct,onChange:o=>Fn(o.target.value),onKeyDown:o=>{if(o.key==="Enter"){o.preventDefault(),o.stopPropagation();const c=document.getElementById("transferExtraFeeInput");if(c)c.focus();else{const d=document.getElementById("transferSubmitButton");d==null||d.click()}}},placeholder:"Ø£Ø¯Ø®Ù„ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„",type:"number",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-orange-500 focus:ring-1 focus:ring-orange-500 dark:text-gray-100"})]}),t.jsx(I,{type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium dark:bg-red-700 dark:hover:bg-red-800",onClick:()=>{const o=ot(),c=parseFloat(yt||"0")||0;let d=0;if((o==null?void 0:o.defaultTransferCommission)!=null){const f=Number(o.defaultTransferCommission)||0;d=Math.round(f*c/1e3*100)/100}else{const f=Ct&&Ct.trim()!==""?parseFloat(Ct):0;d=Math.max(0,f)}const m=c+d;ds((m||0).toString()),Pe?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Ws(!0)},children:"Ø£Ø¬Ù„"}),t.jsx(I,{type:"button",variant:"outline",size:"icon",className:"hidden",title:Ge?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…",children:Ge?t.jsx(Pt,{className:"h-4 w-4 text-green-600"}):t.jsx(Wi,{className:"h-4 w-4 text-red-600"})}),t.jsx("span",{className:"hidden",children:Ge?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…"})]}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"})]})})(),F0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ø±Ø³ÙˆÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ (Ø¬Ù†ÙŠÙ‡)"}),t.jsxs("div",{className:"relative",children:[t.jsx(Va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-yellow-600"}),t.jsx(Z,{id:"transferExtraFeeInput",value:yd,onChange:a=>E0(a.target.value),placeholder:"Ø£Ø¯Ø®Ù„ Ø±Ø³ÙˆÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„",type:"number",className:"pl-10 h-10 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 hover:border-blue-400 focus:border-blue-500 dark:text-gray-100"})]}),t.jsx("div",{className:"hidden",children:"ØªÙØ®ØµÙ… Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙˆØªØ¶Ø§Ù Ù„Ù„Ø¯Ø±Ø¬ â€” Ù„Ø¹Ù…Ù„ÙŠØ§Øª 010 â†’ 011/012/015 Ø£Ùˆ 012 â†’ 010 Ø£Ùˆ 011 â†’ 010 Ø£Ùˆ 015 â†’ 010"})]}),t.jsxs("div",{className:"sticky bottom-0 z-20 pt-2 pb-2 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-800 backdrop-blur supports-[backdrop-filter]:bg-white/90 dark:supports-[backdrop-filter]:bg-gray-900/90",children:[t.jsx(I,{id:"transferSubmitButton",onClick:Qu,className:"w-full h-12 text-base font-medium rounded-full bg-blue-600 hover:bg-blue-700 text-white shadow-none hover:shadow-md",children:Vo?"ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),R0&&t.jsxs("div",{className:"flex items-start gap-2 mt-2 px-1",children:[t.jsx(Kl,{className:"h-4 w-4 text-amber-500 shrink-0 mt-0.5"}),t.jsxs("p",{className:"text-xs text-gray-500 leading-tight",children:["ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ 85% Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø© ",Po==null?void 0:Po.walletName]})]})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø­Ø¨ (Ø¬Ù†ÙŠÙ‡)"}),t.jsxs("div",{className:"relative group",children:[t.jsx(ir,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-primary"}),t.jsx(Z,{id:"amountInput",value:yt,onChange:a=>{Ls(a.target.value),qo&&Lr(!1)},onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("manualWithdrawCommissionInput");if(r)r.focus();else{const o=document.getElementById("withdrawSubmitButton");o==null||o.focus()}}},placeholder:"Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø­Ø¨",type:"number",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-primary focus:ring-1 focus:ring-primary dark:text-gray-100"})]})]}),L0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø§Ø³Ù… Ø§Ù„Ø±Ø§Ø³Ù„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),t.jsxs("div",{className:"relative",children:[t.jsx(on,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-gray-500"}),t.jsx(Z,{id:"withdrawSenderNameInput",value:_r,onChange:a=>md(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("manualWithdrawCommissionInput");r==null||r.focus()}},placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø±Ø§Ø³Ù„ Ø¥Ù† ÙˆØ¬Ø¯",className:"pl-10 h-10 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 hover:border-blue-400 focus:border-blue-500 dark:text-gray-100",type:"text"})]})]}),(()=>{const a=ot();return a&&a.defaultWithdrawCommission!=null?t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø³Ø­Ø¨ (ØªÙ„Ù‚Ø§Ø¦ÙŠØ©)"}),t.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Ø³ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„ÙƒÙ„ Ø£Ù„Ù: ",a==null?void 0:a.defaultWithdrawCommission," Ø¬Ù†ÙŠÙ‡ Ù„ÙƒÙ„ Ø£Ù„Ù"]}),t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx(I,{type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium",onClick:()=>{const o=ot(),c=parseFloat(yt||"0")||0,d=(o==null?void 0:o.defaultWithdrawCommission)!=null&&Number(o.defaultWithdrawCommission)||0,m=Math.round(d*c/1e3*100)/100,f=Ge?c+m:c;ds((f||0).toString()),Pe?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Ws(!0)},children:"Ø£Ø¬Ù„"}),t.jsx(I,{type:"button",variant:ca?"default":"outline",size:"sm",className:ca?"bg-green-600 hover:bg-green-700 text-white font-medium ring-2 ring-green-400 ring-offset-2":"bg-blue-600 hover:bg-blue-700 text-white font-medium",onClick:()=>Yo(!ca),children:ca?"Ø¥Ù„ØºØ§Ø¡ Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡":"Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡"})]}),ca&&t.jsxs("div",{className:"mt-2 text-sm font-semibold text-green-600 animate-in fade-in slide-in-from-top-1",children:["Ø³ÙŠØªÙ… ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø¹Ù…ÙŠÙ„: ",(()=>{const o=ot(),c=parseFloat(yt||"0")||0,d=(o==null?void 0:o.defaultWithdrawCommission)!=null&&Number(o.defaultWithdrawCommission)||0,m=Math.round(d*c/1e3*100)/100;return Math.round((c-m)*100)/100})()," Ø¬Ù†ÙŠÙ‡"]})]}):t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø³Ø­Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (Ø¬Ù†ÙŠÙ‡)"}),t.jsxs("div",{className:"relative",children:[t.jsx(Va,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-yellow-600"}),t.jsx(Z,{id:"manualWithdrawCommissionInput",value:mt,onChange:o=>Wn(o.target.value),onKeyDown:o=>{if(o.key==="Enter"){const c=document.getElementById("withdrawSubmitButton");c==null||c.focus()}},placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",type:"number",className:"pl-10 h-10 md:h-11 lg:h-12 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 hover:border-blue-400 focus:border-blue-500 dark:text-gray-100"})]}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø³Ø­Ø¨"}),t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx(I,{type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium",onClick:()=>{const o=ot(),c=parseFloat(yt||"0")||0;let d=0;if((o==null?void 0:o.defaultWithdrawCommission)!=null){const f=Number(o.defaultWithdrawCommission)||0;d=Math.round(f*c/1e3*100)/100}else{const f=mt&&mt.trim()!==""?parseFloat(mt):Math.round(c*.01*100)/100;d=Math.max(0,f)}const m=Ge?c+d:c;ds((m||0).toString()),Pe?y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Ws(!0)},children:"Ø£Ø¬Ù„"}),t.jsx(I,{type:"button",variant:ca?"default":"outline",size:"sm",className:ca?"bg-green-600 hover:bg-green-700 text-white font-medium ring-2 ring-green-400 ring-offset-2":"bg-blue-600 hover:bg-blue-700 text-white font-medium",onClick:()=>Yo(!ca),children:ca?"Ø¥Ù„ØºØ§Ø¡ Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡":"Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡"})]}),ca&&t.jsxs("div",{className:"mt-2 text-sm font-semibold text-green-600 animate-in fade-in slide-in-from-top-1",children:["Ø³ÙŠØªÙ… ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø¹Ù…ÙŠÙ„: ",(()=>{const o=parseFloat(yt||"0")||0,c=mt&&mt.trim()!==""?parseFloat(mt):Math.round(o*.01*100)/100,d=Math.max(0,c);return Math.round((o-d)*100)/100})()," Ø¬Ù†ÙŠÙ‡"]})]})})(),(n==null?void 0:n.showWithdrawNote)&&t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø³Ø­Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),t.jsxs("div",{className:"relative group",children:[t.jsx(Hl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-primary"}),t.jsx(Z,{id:"withdrawNoteInput",value:cs,onChange:a=>ud(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("withdrawSubmitButton");r==null||r.focus()}},placeholder:"Ø£Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ø³Ø­Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",className:"pl-10 h-10 text-base border-gray-400 dark:border-gray-600 rounded-xl focus:border-primary focus:ring-1 focus:ring-primary bg-white dark:bg-gray-900 dark:text-gray-100 dark:placeholder:text-gray-400"})]})]}),t.jsx("div",{className:"sticky bottom-0 z-20 pt-2 pb-2 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-800 backdrop-blur supports-[backdrop-filter]:bg-white/90 dark:supports-[backdrop-filter]:bg-gray-900/90",children:t.jsx(I,{id:"withdrawSubmitButton",onClick:Qu,disabled:Ac||qo,className:"w-full font-medium h-11 lg:h-12 text-sm lg:text-base bg-green-600 hover:bg-green-700 text-white disabled:opacity-70 disabled:cursor-not-allowed",children:Ac?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°...":qo?hf||"ØªÙ… Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³Ø­Ø¨"})})]}),t.jsx(ue,{open:Do,onOpenChange:Ws,children:t.jsxs(me,{children:[t.jsxs(ye,{children:[t.jsx(he,{children:"ØªØ­ÙˆÙŠÙ„ Ù…Ø¤Ø¬Ù„"}),t.jsx(et,{children:"Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ø­Ø¨ Ø§Ù„Ø¯ÙŠÙ† ÙˆØ§Ù„Ù…Ø¨Ù„Øº ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø«Ù… Ø§Ø¶ØºØ· Ø­ÙØ¸"})]}),t.jsxs("div",{className:"space-y-3",children:[wt&&wt.length>0?t.jsxs("div",{children:[t.jsx(G,{children:"Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù…ÙŠÙ„"}),t.jsxs(Fa,{value:Io,onValueChange:a=>{A0(a);const r=wt.find(o=>o.id===a);r&&Co(r.name)},children:[t.jsx(Ba,{className:"w-full",children:t.jsx($a,{placeholder:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„"})}),t.jsx(Ua,{children:wt.map(a=>t.jsxs(oa,{value:a.id,children:[a.name,a.mobile?` â€” ${a.mobile}`:""]},a.id))})]})]}):t.jsx("div",{className:"text-xs text-gray-500",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…ÙØ³Ø¬Ù„ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹. ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ù…Ù† Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†."}),t.jsxs("div",{children:[t.jsx(G,{htmlFor:"quickDebtName",children:"Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ø¯ÙŠÙ†"}),t.jsx(Z,{id:"quickDebtName",value:ko,onChange:a=>Co(a.target.value),placeholder:"Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…"})]}),t.jsxs("div",{children:[t.jsx(G,{htmlFor:"quickDebtAmount",children:"Ø§Ù„Ù…Ø¨Ù„Øº (Ù…Ø­Ø³ÙˆØ¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)"}),t.jsx(Z,{id:"quickDebtAmount",type:"number",value:_0,readOnly:!0,placeholder:"Ø§Ù„Ù…Ø¨Ù„Øº + Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„"})]}),t.jsxs("div",{children:[t.jsx(G,{htmlFor:"quickDebtCommission",children:"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (Ù…Ø­Ø³ÙˆØ¨Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)"}),t.jsx(Z,{id:"quickDebtCommission",type:"number",value:function(){const a=ot(),r=parseFloat((yt||"0").toString())||0;let o=0;if(B==="transfer")if((a==null?void 0:a.defaultTransferCommission)!=null){const c=Number(a.defaultTransferCommission)||0;o=Math.round(c*r/1e3*100)/100}else{const c=Ct&&Ct.trim()!==""?parseFloat(Ct):0;o=Math.max(0,c)}else if((a==null?void 0:a.defaultWithdrawCommission)!=null){const c=Number(a.defaultWithdrawCommission)||0;o=Math.round(c*r/1e3*100)/100}else{const c=mt&&mt.trim()!==""?parseFloat(mt):Math.round(r*.01*100)/100;o=Math.max(0,c)}return String(o||0)}(),readOnly:!0,placeholder:"Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©",className:"dark:bg-gray-800 dark:border-gray-700 dark:text-gray-300"})]}),t.jsxs("div",{children:[t.jsx(G,{htmlFor:"quickDebtNotes",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª"}),t.jsx(Z,{id:"quickDebtNotes",value:hd,onChange:a=>fd(a.target.value),placeholder:"Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"})]})]}),t.jsx(We,{children:t.jsx(I,{type:"button",variant:"default",className:"bg-green-600 text-white hover:bg-green-700",onClick:()=>{const a=ot(),r=parseFloat((yt||"").toString())||0;let o=0;if(B==="transfer")if((a==null?void 0:a.defaultTransferCommission)!=null){const m=Number(a.defaultTransferCommission)||0;o=Math.round(m*r/1e3*100)/100}else{const m=Ct&&Ct.trim()!==""?parseFloat(Ct):0;o=Math.max(0,m)}else if((a==null?void 0:a.defaultWithdrawCommission)!=null){const m=Number(a.defaultWithdrawCommission)||0;o=Math.round(m*r/1e3*100)/100}else{const m=mt&&mt.trim()!==""?parseFloat(mt):Math.round(r*.01*100)/100;o=Math.max(0,m)}let c=0;if(B==="withdraw"?c=Ge?r:Math.max(0,Math.round((r-o)*100)/100):c=Math.max(0,Math.round((r+o)*100)/100),!ko||isNaN(c)||c<=0){y({title:"Ø®Ø·Ø£ ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¬Ù„",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­",variant:"destructive"});return}const d=wt.find(m=>m.id===Io);_o({debtorName:ko,amount:c,notes:hd,customerId:Io||void 0,mobile:d==null?void 0:d.mobile}),gd(!1),Ws(!1),y({title:"ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¬Ù„",description:"Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙŠÙ† Ø¹Ù†Ø¯ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",variant:"default"})},children:"Ø­ÙØ¸"})})]})})]})]}),t.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mt-8 fade-in-up w-full",children:[t.jsxs(I,{variant:"outline",size:"sm",onClick:()=>Be("https://www.youtube.com/watch?v=CRHOlK3LZas","Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙˆØ§Ù„Ø³Ø­Ø¨ Ø§Ù„ÙŠØ¯ÙˆÙŠ"),className:"flex-1 min-w-[200px] max-w-sm h-9 text-xs justify-center bg-white text-indigo-600 border-indigo-200 hover:bg-indigo-50 shadow-sm",children:[t.jsx($i,{className:"h-3.5 w-3.5 ml-1.5"}),"Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙˆØ§Ù„Ø³Ø­Ø¨ Ø§Ù„ÙŠØ¯ÙˆÙŠ"]}),t.jsxs(I,{variant:"outline",size:"sm",onClick:()=>Be("https://www.youtube.com/watch?v=1_h1iFLDBaY","Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±"),className:"flex-1 min-w-[200px] max-w-sm h-9 text-xs justify-center bg-white text-emerald-600 border-emerald-200 hover:bg-emerald-50 shadow-sm",children:[t.jsx($i,{className:"h-3.5 w-3.5 ml-1.5"}),"Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±"]})]})]})]}),t.jsx(Uw,{isOpen:Q0,onClose:()=>G0(!1),initialEditingWallet:Z0,onWalletUpdate:async()=>{try{await Bl()}catch(a){console.error("Error reloading wallets after update:",a)}}}),t.jsx(Vw,{isOpen:sf,onClose:()=>Cd(!1),transaction:af,onDelete:$l}),t.jsx(ea,{open:cf,onOpenChange:$s,onSuccess:Kg,title:Jg(),description:Hg(),mode:"verify",userId:e==null?void 0:e.uid,userRole:n==null?void 0:n.role}),t.jsx(Um,{open:ng,onOpenChange:xu,onSuccess:Gg,title:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬",currentBalance:Ve,balanceLabel:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ",userId:e==null?void 0:e.uid}),t.jsx(Um,{open:ig,onOpenChange:yu,onSuccess:Xg,title:"ØªØ¹Ø¯ÙŠÙ„ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",currentBalance:Yt&&Se[Yt]||0,balanceLabel:`Ø±ØµÙŠØ¯ ${((tm=X.find(a=>a.id===Yt))==null?void 0:tm.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©"}`,userId:e==null?void 0:e.uid}),t.jsx(Hw,{open:og,onOpenChange:bl,onSuccess:Zg,title:"Ø¥Ø¶Ø§ÙØ© Ø£Ùˆ Ø®ØµÙ… Ù…Ø¨Ù„Øº Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡ Ø£Ùˆ Ø®ØµÙ…Ù‡ Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",currentBalance:Yt&&Se[Yt]||0,balanceLabel:`Ø±ØµÙŠØ¯ ${((am=X.find(a=>a.id===Yt))==null?void 0:am.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©"}`,userId:e==null?void 0:e.uid}),t.jsx(Yw,{open:bg,onOpenChange:vg,userId:e==null?void 0:e.uid}),t.jsx(zw,{open:wg,onOpenChange:Ng,userId:e==null?void 0:e.uid}),t.jsx(Kw,{open:jg,onOpenChange:Sg}),t.jsx(ue,{open:dg,onOpenChange:mi,children:t.jsxs(me,{className:"sm:max-w-md",children:[t.jsx(ye,{children:t.jsx(he,{className:"text-right",children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"})}),t.jsxs("div",{className:"space-y-1 py-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{htmlFor:"amount",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsx(Z,{id:"amount",type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:wl,onChange:a=>hi(a.target.value),className:"text-right flex-1",dir:"rtl",min:"0"}),t.jsxs("div",{className:"flex gap-1",children:[t.jsxs(I,{type:"button",size:"sm",className:"bg-green-600 hover:bg-green-700 text-white px-3 py-2",onClick:async()=>{if(!await _i(Ml)){y({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}const a=parseFloat(wl);if(isNaN(a)||a<=0){y({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const r=Ve+a;at(r);const o={cashBalance:r,lastUpdated:new Date().toISOString()},c=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(c,JSON.stringify(o)),e!=null&&e.uid?ae.updateUserData(e.uid,o).then(()=>{console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø±ØµÙŠØ¯ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­"),localStorage.removeItem(c),we(!1)}).catch(d=>{console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø±ØµÙŠØ¯ ÙÙŠ Firebase:",d),we(!0)}):we(!0),y({title:"ØªÙ… Ø¨Ù†Ø¬Ø§Ø­",description:`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${a} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙˆØ­ÙØ¸Ù‡ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©`}),mi(!1),hi(""),yi("")},children:[t.jsx(Pt,{className:"h-1 w-1 mr-1"}),"Ø¥Ø¶Ø§ÙØ©"]}),t.jsxs(I,{id:"confirm-deduct-cash-btn",type:"button",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2",onClick:async()=>{if(!await _i(Ml)){y({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}const a=parseFloat(wl);if(isNaN(a)||a<=0){y({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const r=Ve-a;at(r);const o={cashBalance:r,lastUpdated:new Date().toISOString()},c=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(c,JSON.stringify(o)),e!=null&&e.uid?ae.updateUserData(e.uid,o).then(()=>{console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø±ØµÙŠØ¯ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­"),localStorage.removeItem(c),we(!1)}).catch(d=>{console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø±ØµÙŠØ¯ ÙÙŠ Firebase:",d),we(!0)}):we(!0),y({title:"ØªÙ… Ø¨Ù†Ø¬Ø§Ø­",description:`ØªÙ… Ø®ØµÙ… ${a} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙˆØ­ÙØ¸Ù‡ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©`}),mi(!1),hi(""),yi("")},children:[t.jsx(Wi,{className:"h-1 w-1 mr-1"}),"Ø®ØµÙ…"]})]})]}),t.jsxs("p",{className:"text-[10px] text-gray-500 text-right",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",Ve.toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{htmlFor:"pin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ"}),t.jsx(Z,{id:"pin",type:"password",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",value:Ml,onChange:a=>yi(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const r=document.getElementById("confirm-deduct-cash-btn");r&&r.click()}},className:"text-right",dir:"rtl"})]})]}),t.jsx(We,{className:"flex gap-2",children:t.jsx(I,{variant:"outline",onClick:()=>{mi(!1),hi(""),yi("")},children:"Ø¥Ù„ØºØ§Ø¡"})})]})}),t.jsx(ue,{open:Ag,onOpenChange:ki,children:t.jsxs(me,{className:"sm:max-w-md",children:[t.jsx(ye,{children:t.jsx(he,{className:"text-right text-red-600",children:"ØªØµÙÙŠØ± Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©"})}),t.jsxs("div",{className:"space-y-1 py-4",children:[t.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg border border-red-200",children:[t.jsx("p",{className:"text-red-800 font-medium mb-2",children:"ØªØ­Ø°ÙŠØ±!"}),t.jsx("p",{className:"text-red-700 text-sm",children:"Ø³ÙŠØªÙ… ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø¥Ù„Ù‰ ØµÙØ±. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."}),t.jsxs("p",{className:"text-red-600 text-sm mt-2",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",X.reduce((a,r)=>a+(Number(Se[r.id])||0),0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{htmlFor:"resetWalletTotalPin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"}),t.jsx(Z,{id:"resetWalletTotalPin",type:"password",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",value:Vu,onChange:a=>Ci(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("confirm-reset-wallet-total-btn"))==null||r.click())},className:"text-right",dir:"rtl"})]})]}),t.jsxs(We,{className:"flex gap-2",children:[t.jsx(I,{variant:"outline",onClick:()=>{ki(!1),Ci("")},children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{id:"confirm-reset-wallet-total-btn",variant:"destructive",onClick:async()=>{if(!await zt.verifyMasterPin(Vu,e==null?void 0:e.uid)){y({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}try{const r={};Object.keys(Se).forEach(m=>{r[m]=0}),ut(r),localStorage.setItem(st(),JSON.stringify(r)),ki(!1),Ci("");const o=new Date().toISOString(),c={walletBalances:r,lastUpdated:o},d=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(d,JSON.stringify(c)),e!=null&&e.uid?ae.updateUserData(e.uid,c).then(()=>{localStorage.removeItem(d),we(!1)}).catch(m=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",m),we(!0),y({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù‚Ø±ÙŠØ¨Ø§Ù‹",variant:"default"})}):we(!0),setTimeout(()=>{ut({...r})},100)}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸:",r),y({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸",variant:"destructive"})}},children:"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})]})]})}),t.jsx(ue,{open:lg,onOpenChange:di,children:t.jsxs(me,{className:"sm:max-w-md",children:[t.jsx(ye,{children:t.jsx(he,{className:"text-right text-red-600",children:"ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©"})}),t.jsxs("div",{className:"space-y-1 py-4",children:[t.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg border border-red-200",children:[t.jsx("p",{className:"text-red-800 font-medium mb-2",children:"ØªØ­Ø°ÙŠØ±!"}),t.jsx("p",{className:"text-red-700 text-sm",children:"Ø³ÙŠØªÙ… ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ø¥Ù„Ù‰ ØµÙØ±. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."}),t.jsxs("p",{className:"text-red-600 text-sm mt-2",children:["Ø§Ù„Ù…Ø­ÙØ¸Ø©: ",((sm=X.find(a=>a.id===L))==null?void 0:sm.name)||L]}),t.jsxs("p",{className:"text-red-600 text-sm",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",(L&&Se[L]?Se[L]:0).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{htmlFor:"resetSelectedWalletPin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"}),t.jsx(Z,{id:"resetSelectedWalletPin",type:"password",autoComplete:"off",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",value:bu,onChange:a=>vl(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("confirm-reset-selected-wallet-btn"))==null||r.click())},className:"text-right",dir:"rtl"})]})]}),t.jsxs(We,{className:"flex gap-2",children:[t.jsx(I,{variant:"outline",onClick:()=>{di(!1),vl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{id:"confirm-reset-selected-wallet-btn",variant:"destructive",onClick:async()=>{var r;if(!L){y({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}if(!await zt.verifyMasterPin(bu,e==null?void 0:e.uid)){y({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}try{const o={...Se};o[L]=0,ut(o),localStorage.setItem(st(),JSON.stringify(o)),di(!1),vl("");const c=new Date().toISOString(),d={walletBalances:o,lastUpdated:c},m=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(m,JSON.stringify(d)),e!=null&&e.uid?ae.updateUserData(e.uid,d).then(()=>{localStorage.removeItem(m),we(!1)}).catch(f=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",f),we(!0),y({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù‚Ø±ÙŠØ¨Ø§Ù‹",variant:"default"})}):we(!0),y({title:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ø¨Ù†Ø¬Ø§Ø­",description:`ØªÙ… ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ${((r=X.find(f=>f.id===L))==null?void 0:r.name)||L}`})}catch(o){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:",o),y({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",variant:"destructive"})}},children:"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})]})]})}),t.jsx(Vm,{isOpen:Ot,onClose:()=>ba(!1),wallets:X}),t.jsx(ue,{open:Cg,onOpenChange:ji,children:t.jsxs(me,{className:"sm:max-w-md",children:[t.jsx(ye,{children:t.jsxs(he,{className:"text-right text-green-600 flex items-center gap-2 justify-end",children:[t.jsx(Pt,{className:"h-4 w-4"}),"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„ Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©"]})}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg border border-green-200",children:[t.jsx("p",{className:"text-green-800 font-medium mb-2",children:"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„"}),t.jsx("p",{className:"text-green-700 text-sm",children:"Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø¥Ù„Ù‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ø´ÙƒÙ„ Ù…ØªÙ†Ø§Ø³Ø¨ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙØ¸."}),t.jsxs("p",{className:"text-green-600 text-sm mt-2",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",X.reduce((a,r)=>a+(Number(Se[r.id])||0),0).toLocaleString()," Ø¬Ù†ÙŠÙ‡"]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{htmlFor:"addWalletTotalAmount",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡"}),t.jsx(Z,{id:"addWalletTotalAmount",type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:Mu,onChange:a=>El(a.target.value),className:"text-right",dir:"rtl"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{htmlFor:"addWalletTotalPin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„ØªØ£ÙƒÙŠØ¯"}),t.jsx(Z,{id:"addWalletTotalPin",type:"password",autoComplete:"off",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",value:Ou,onChange:a=>Rl(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("confirm-add-wallet-total-btn"))==null||r.click())},className:"text-right",dir:"rtl"})]})]})]}),t.jsxs(We,{className:"flex gap-2",children:[t.jsx(I,{variant:"outline",onClick:()=>{ji(!1),El(""),Rl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{id:"confirm-add-wallet-total-btn",variant:"default",className:"bg-green-600 hover:bg-green-700",disabled:Eu,onClick:async()=>{const a=parseFloat(Mu);if(!a||a<=0){y({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}if(!await Og(Ou)){y({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}Ru(!0);try{const r=X.reduce((c,d)=>c+(Number(Se[d.id])||0),0),o={...Se};if(r===0){if(X.length>0){const c=a/X.length;X.forEach(d=>{o[d.id]=(Number(o[d.id])||0)+c})}}else X.forEach(c=>{const d=Number(Se[c.id])||0,m=d/r,f=a*m;o[c.id]=d+f});ut(o),localStorage.setItem(st(),JSON.stringify(o)),e!=null&&e.uid?await ae.updateUserData(e.uid,{walletBalances:o,lastUpdated:new Date().toISOString()}):we(!0),setTimeout(()=>{ut(c=>({...c}))},100),ji(!1),El(""),Rl("")}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",r),y({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",variant:"destructive"})}finally{Ru(!1)}},children:Eu?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©...":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù…ÙˆØ§Ù„"})]})]})}),t.jsx(ue,{open:Tg,onOpenChange:Ii,children:t.jsxs(me,{className:"sm:max-w-[425px]",children:[t.jsx(ye,{children:t.jsxs(he,{className:"text-red-600 flex items-center gap-2",children:[t.jsx(Sa,{className:"h-1 w-1"}),"ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ"]})}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-red-700",children:"âš ï¸ ØªØ­Ø°ÙŠØ±: Ø³ÙŠØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬ Ø¥Ù„Ù‰ ØµÙØ±. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."})}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{htmlFor:"resetCashPin",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"}),t.jsx(Z,{id:"resetCashPin",type:"password",autoComplete:"off",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",value:Ll,onChange:a=>Wl(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("confirm-reset-cash-btn"))==null||r.click())}})]})]}),t.jsxs(We,{children:[t.jsx(I,{variant:"outline",onClick:()=>{Ii(!1),Wl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{id:"confirm-reset-cash-btn",variant:"destructive",onClick:async()=>{if(!Ll){y({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}if(!await zt.verifyMasterPin(Ll,e==null?void 0:e.uid)){y({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}try{at(0),Ii(!1),Wl("");const r={cashBalance:0,lastUpdated:new Date().toISOString()};localStorage.setItem(Qe(),"0"),localStorage.setItem(Qe()+"_lastUpdated",r.lastUpdated);const o=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(o,JSON.stringify(r)),e!=null&&e.uid?ae.updateUserData(e.uid,r).then(()=>{localStorage.removeItem(o),we(!1)}).catch(c=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø±ØµÙŠØ¯ ÙÙŠ Firebase:",c),we(!0),y({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù‚Ø±ÙŠØ¨Ø§Ù‹",variant:"default"})}):we(!0)}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ:",r),y({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ",variant:"destructive"})}},children:"ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯"})]})]})}),t.jsx(Xw,{open:kg,onOpenChange:Pu,userId:e==null?void 0:e.uid,cashBalance:Ve,walletBalances:Se,transactions:ge}),t.jsx(ue,{open:Dg,onOpenChange:zr,children:t.jsxs(me,{className:"sm:max-w-[425px]",children:[t.jsx(ye,{children:t.jsxs(he,{className:"text-green-600 flex items-center gap-2",children:[t.jsx(Pt,{className:"h-4 w-4"}),"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„ Ù„Ù„Ø¯Ø±Ø¬"]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-green-700",children:"ðŸ’° Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬"})}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{htmlFor:"addCashAmount",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡"}),t.jsx(Z,{id:"addCashAmount",type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:gs,onChange:a=>bi(a.target.value),min:"0",step:"0.01"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{className:"text-right",children:"Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(I,{type:"button",variant:Jr==="yes"?"default":"outline",onClick:()=>Hr("yes"),className:"flex-1",children:"Ù†Ø¹Ù…"}),t.jsx(I,{type:"button",variant:Jr==="no"?"default":"outline",onClick:async()=>{if(Hr("no"),!gs||parseFloat(gs)<=0){y({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±",variant:"destructive"});return}if(!Kr){y({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}if(!await _i(Kr)){y({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}wi(!0);try{const a=parseFloat(gs),r=Ve+a;at(r);const o=new Date().toISOString();localStorage.setItem(Qe(),r.toString()),localStorage.setItem(Qe()+"_lastUpdated",o);const c={cashBalance:r,lastUpdated:o},d=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(d,JSON.stringify(c));const m=`CASHADD-${(e==null?void 0:e.uid)||"anon"}-${Date.now()}`;zr(!1),bi(""),vi(""),Hr(null),Ni("");const f=[];if(e!=null&&e.uid){f.push(ae.updateUserData(e.uid,c).then(()=>{localStorage.removeItem(d),we(!1)}).catch(()=>{we(!0)}));const g={txnType:"cash_addition",type:"cash_addition",amount:a,status:"confirmed",senderMsisdn:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",receiverMsisdn:"",reference:m,title:"Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",merchantUserId:e.uid,createdBy:e.uid,shopId:(n==null?void 0:n.shopId)||void 0};f.push(ae.saveUserTransaction(e.uid,g));const w=n==null?void 0:n.shopId;if(w){const N=Ae(F,"dashboardData",w);f.push(Zt(N,{cashBalance:r}))}}Promise.allSettled(f).then(()=>{}).catch(()=>{})}catch{at(Ve),localStorage.setItem("cashBalance",Ve.toString()),y({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",variant:"destructive"})}finally{wi(!1)}},className:"flex-1",children:"Ù„Ø§"})]})]}),Jr==="yes"&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{htmlFor:"addCashNote",children:"Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©"}),t.jsx(Z,{id:"addCashNote",type:"text",placeholder:"Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©",value:Ol,onChange:a=>Ni(a.target.value)})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{htmlFor:"addCashPin",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),t.jsx(Z,{id:"addCashPin",type:"password",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",value:Kr,onChange:a=>vi(a.target.value),onKeyDown:a=>{var r;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(r=document.getElementById("confirm-add-cash-btn"))==null||r.click())}})]})]}),t.jsxs(We,{children:[t.jsx(I,{variant:"outline",onClick:()=>{zr(!1),bi(""),vi(""),Hr(null),Ni("")},children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{id:"confirm-add-cash-btn",variant:"default",className:"bg-green-600 hover:bg-green-700",disabled:Tu,onClick:async()=>{if(!gs||parseFloat(gs)<=0){y({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±",variant:"destructive"});return}if(!Kr){y({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}if(!await _i(Kr)){y({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}if(Jr==="yes"&&Ol.trim().length===0){y({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø£Ùˆ Ø§Ø®ØªØ± Ù„Ø§",variant:"destructive"});return}wi(!0);try{const a=parseFloat(gs),r=Ve+a;at(r);const o=new Date().toISOString();localStorage.setItem(Qe(),r.toString()),localStorage.setItem(Qe()+"_lastUpdated",o);const c={cashBalance:r,lastUpdated:o},d=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(d,JSON.stringify(c));const m=`CASHADD-${(e==null?void 0:e.uid)||"anon"}-${Date.now()}`;zr(!1),bi(""),vi(""),Hr(null),Ni("");const f=[];if(e!=null&&e.uid){f.push(ae.updateUserData(e.uid,c).then(()=>{localStorage.removeItem(d),we(!1)}).catch(()=>{we(!0)}));const g={txnType:"cash_addition",type:"cash_addition",amount:a,status:"confirmed",senderMsisdn:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",receiverMsisdn:"",reference:m,note:Jr==="yes"?Ol.trim():void 0,title:"Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",merchantUserId:e.uid,createdBy:e.uid,shopId:(n==null?void 0:n.shopId)||void 0};f.push(ae.saveUserTransaction(e.uid,g));const w=n==null?void 0:n.shopId;if(w){const N=Ae(F,"dashboardData",w);f.push(Zt(N,{cashBalance:r}))}}Promise.allSettled(f).then(()=>{}).catch(()=>{})}catch{at(Ve),localStorage.setItem("cashBalance",Ve.toString()),y({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",variant:"destructive"})}finally{wi(!1)}},children:Tu?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©...":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù…ÙˆØ§Ù„"})]})]})}),t.jsx(ue,{open:rg,onOpenChange:yl,children:t.jsxs(me,{className:"sm:max-w-md",children:[t.jsx(ye,{children:t.jsx(he,{className:"text-right",children:"Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª Ù„Ù„Ø¨Ø­Ø«"})}),t.jsxs("div",{className:"space-y-1 py-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{htmlFor:"search-date",className:"text-right block",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),t.jsx(Z,{id:"search-date",type:"date",value:zn,onChange:a=>Pd(a.target.value),className:"text-right"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{htmlFor:"search-time",className:"text-right block",children:"Ø§Ù„ÙˆÙ‚Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),t.jsx(Z,{id:"search-time",type:"time",value:Kn,onChange:a=>Md(a.target.value),className:"text-right",placeholder:"Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª Ù„Ù„Ø¨Ø­Ø« ÙÙŠ Ø³Ø§Ø¹Ø© Ù…Ø­Ø¯Ø¯Ø©"}),t.jsx("p",{className:"text-[10px] text-gray-500 text-right",children:"Ø¥Ø°Ø§ Ù„Ù… ØªØ®ØªØ± ÙˆÙ‚ØªØ§Ù‹ Ù…Ø­Ø¯Ø¯Ø§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ø¨Ø­Ø« ÙÙŠ ÙƒØ§Ù…Ù„ Ø§Ù„ÙŠÙˆÙ…"})]})]}),t.jsxs(We,{className:"flex justify-between",children:[t.jsx(I,{variant:"outline",onClick:()=>{Pd(""),Md(""),yl(!1)},children:"Ù…Ø³Ø­"}),t.jsx(I,{onClick:()=>yl(!1),children:"ØªØ·Ø¨ÙŠÙ‚"})]})]})}),t.jsx(Qw,{isOpen:vf,onClose:()=>Fd(!1)}),t.jsx(vm,{isOpen:Aa,onClose:()=>na(!1),userId:(e==null?void 0:e.uid)||"",userEmail:(e==null?void 0:e.email)||""}),t.jsx(Gw,{isOpen:Fo,onClose:()=>Or(!1),initialBarcode:J0}),t.jsx(Zw,{isOpen:Df,onClose:()=>Hn(!1)}),t.jsx(sN,{open:kf,onOpenChange:Qn}),t.jsx(rN,{open:Cf,onOpenChange:a=>{if(a&&!ma){y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"});return}Gn(a)}}),t.jsx(cN,{open:Kh,onOpenChange:a=>{if(a&&!ma){y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒÙƒ.",variant:"destructive"});return}Dn(a)}}),t.jsx(dN,{open:Jh,onOpenChange:a=>{if(a&&!ma){y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒÙƒ.",variant:"destructive"});return}Hh(a)}}),t.jsx(ea,{open:mg,onOpenChange:Du,onSuccess:()=>Sl(!0),title:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",mode:"verify",userId:e==null?void 0:e.uid,userRole:n==null?void 0:n.role}),t.jsx(ue,{open:jl,onOpenChange:Sl,children:t.jsxs(me,{className:"sm:max-w-xl",children:[t.jsxs(ye,{children:[t.jsxs(he,{className:"flex items-center gap-2",children:[t.jsx(Gl,{className:"h-4 w-4 text-blue-600"}),"ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…"]}),t.jsx(et,{children:"Ù…Ù„Ø®Øµ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ… Ù…Ø­ÙÙˆØ¸ Ù„Ø¢Ø®Ø± 30 ÙŠÙˆÙ…Ù‹Ø§ Ù…Ø¹ Ø£Ø±Ø´ÙØ© ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©"})]}),t.jsxs("div",{className:"space-y-4",children:[(()=>{const a=new Date().toDateString(),r=ge.filter(g=>{const w=new Date(g.createdAt).toDateString(),N=String(g.status||"completed").toLowerCase();return w===a&&(N==="completed"||N==="confirmed")}),o=r.length,c=r.reduce((g,w)=>g+Number(w.amount||0),0),d=r.filter(g=>g.type==="withdraw").reduce((g,w)=>g+Number(w.amount||0),0),m=r.filter(g=>g.type==="send").reduce((g,w)=>g+Number(w.amount||0),0),f=r.reduce((g,w)=>g+Number(At.calculateTransactionProfit(w)||0),0);return t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-blue-50 to-slate-100 border",children:[t.jsx("div",{className:"text-xs text-blue-700",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),t.jsx("div",{className:"text-lg font-bold text-blue-800",children:o})]}),t.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-indigo-50 to-slate-100 border",children:[t.jsx("div",{className:"text-xs text-indigo-700",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº"}),t.jsx("div",{className:"text-lg font-bold text-indigo-800",children:Number(c).toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-red-50 to-slate-100 border",children:[t.jsx("div",{className:"text-xs text-red-700",children:"Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø©"}),t.jsx("div",{className:"text-lg font-bold text-red-800",children:Number(d).toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-green-50 to-slate-100 border",children:[t.jsx("div",{className:"text-xs text-green-700",children:"Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ù…Ø±Ø³Ù„Ø©"}),t.jsx("div",{className:"text-lg font-bold text-green-800",children:Number(m).toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"col-span-2 rounded-lg p-3 bg-gradient-to-r from-amber-50 to-slate-100 border",children:[t.jsx("div",{className:"text-xs text-amber-700",children:"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),t.jsx("div",{className:"text-lg font-bold text-amber-800",children:Number(f).toLocaleString("en-US",{maximumFractionDigits:0})})]})]})})(),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(I,{variant:"default",onClick:async()=>{try{if(!(e!=null&&e.uid))return;const a=new Date,r=a.getFullYear(),o=String(a.getMonth()+1).padStart(2,"0"),c=String(a.getDate()).padStart(2,"0"),d=`${r}-${o}-${c}`,m=a.toDateString(),f=ge.filter(j=>{const S=new Date(j.createdAt).toDateString(),_=String(j.status||"completed").toLowerCase();return S===m&&(_==="completed"||_==="confirmed")}),g=f.length,w=f.reduce((j,S)=>j+Number(S.amount||0),0),N=f.filter(j=>j.type==="withdraw").reduce((j,S)=>j+Number(S.amount||0),0),x=f.filter(j=>j.type==="send").reduce((j,S)=>j+Number(S.amount||0),0),v=f.reduce((j,S)=>j+Number(At.calculateTransactionProfit(S)||0),0);await tr.add({userId:e.uid,reportDate:d,totalTransactions:g,totalAmount:Math.round(w),totalWithdrawn:Math.round(N),totalSent:Math.round(x),profit:Math.round(v),walletId:null});try{await tr.trimToMaxCount(e.uid,30)}catch{}y({title:"ØªÙ… Ø§Ù„Ø£Ø±Ø´ÙØ©",description:`ØªÙ… Ø­ÙØ¸ ØªÙ‚Ø±ÙŠØ± ${d}`})}catch{y({title:"ÙØ´Ù„ Ø§Ù„Ø£Ø±Ø´ÙØ©",description:"ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±",variant:"destructive"})}},children:"Ø£Ø±Ø´ÙØ© Ø§Ù„ÙŠÙˆÙ…"}),t.jsx(I,{variant:"outline",onClick:()=>Sl(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})]}),t.jsx("div",{className:"mt-2 border-t pt-2",children:t.jsx("div",{className:"space-y-2 max-h-[40vh] overflow-auto",children:ku.length===0?t.jsx("div",{className:"text-xs text-muted-foreground",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø­ÙÙˆØ¸Ø©"}):ku.map(a=>t.jsxs("div",{className:"border rounded-md p-2 bg-gradient-to-r from-white/80 to-blue-50/70",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("div",{className:"font-bold text-blue-800",children:a.reportDate}),t.jsxs("div",{className:"text-xs text-blue-700",children:["Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª: ",a.totalTransactions]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-1",children:[t.jsxs("div",{className:"text-xs text-blue-800",children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº: ",t.jsx("span",{className:"font-semibold",children:Number(a.totalAmount).toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"text-xs text-blue-800",children:["Ø§Ù„Ù…Ø³Ø­ÙˆØ¨: ",t.jsx("span",{className:"font-semibold",children:Number(a.totalWithdrawn).toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"text-xs text-blue-800",children:["Ø§Ù„Ù…Ø±Ø³Ù„: ",t.jsx("span",{className:"font-semibold",children:Number(a.totalSent).toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"text-xs text-blue-800",children:["Ø§Ù„Ø±Ø¨Ø­: ",t.jsx("span",{className:"font-semibold",children:Number(a.profit??0).toLocaleString("en-US",{maximumFractionDigits:0})})]})]})]},a.id||`${a.userId}-${a.reportDate}`))})})]})]})}),t.jsx(ue,{open:ug,onOpenChange:a=>{if(a){y({title:"Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹."});return}Nl(!1)},children:t.jsxs(me,{dir:"rtl",className:"sm:max-w-md w-[95vw] sm:w-auto rounded-2xl border border-emerald-200 shadow-xl bg-gradient-to-br from-white via-green-50 to-emerald-50 backdrop-blur-md data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-90 data-[state=open]:slide-in-from-bottom-8 duration-300",children:[t.jsxs(ye,{children:[t.jsx(he,{className:"text-right text-green-700",children:"Ø´Ø­Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),t.jsx(et,{className:"text-right text-gray-600",children:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø«Ù… Ø§Ø¶ØºØ· ØªØ£ÙƒÙŠØ¯"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx(G,{htmlFor:"topupPhone",className:"text-right block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),t.jsx(Z,{id:"topupPhone",value:fi,onChange:a=>vu(a.target.value),placeholder:"010xxxxxxx",className:"text-right"})]}),t.jsxs("div",{children:[t.jsx(G,{className:"text-right block",children:"Ø´Ø±ÙƒØ© Ø§Ù„ØªØ´ØºÙŠÙ„"}),t.jsxs(Fa,{value:gi,onValueChange:wu,children:[t.jsx(Ba,{className:"text-right",children:t.jsx($a,{placeholder:"Ø§Ø®ØªØ± Ø§Ù„Ø´Ø±ÙƒØ©"})}),t.jsxs(Ua,{children:[t.jsx(oa,{value:"vodafone",children:"ÙÙˆØ¯Ø§ÙÙˆÙ†"}),t.jsx(oa,{value:"orange",children:"Ø£ÙˆØ±Ù†Ø¬"}),t.jsx(oa,{value:"etisalat",children:"Ø§ØªØµØ§Ù„Ø§Øª"}),t.jsx(oa,{value:"we",children:"WE"})]})]})]}),t.jsxs("div",{children:[t.jsx(G,{htmlFor:"topupAmount",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡"}),t.jsx(Z,{id:"topupAmount",type:"number",value:pi,onChange:a=>Nu(a.target.value?Number(a.target.value):""),placeholder:"50",className:"text-right"})]})]}),t.jsxs(We,{className:"flex gap-2 justify-between",children:[t.jsx(I,{variant:"outline",onClick:()=>Nl(!1),className:"border-gray-300",children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{onClick:zh,disabled:ju||!fi||!gi||!pi,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:ju?"Ø¬Ø§Ø±Ù Ø§Ù„ØªÙ†ÙÙŠØ°...":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø´Ø­Ù†"})]})]})}),t.jsx(ea,{open:Lf,onOpenChange:Go,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ÙØªØ­ Ø§Ù„Ø¯ÙŠÙˆÙ†",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†",className:"!bg-[#0f172a] !text-slate-100 border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",onSuccess:()=>{Go(!1),Vs(!0)},userId:e==null?void 0:e.uid,userRole:n==null?void 0:n.role}),t.jsx(ea,{open:Ff,onOpenChange:Jd,mode:"verify",title:"ØªØ£ÙƒÙŠØ¯ ØªØºÙŠÙŠØ± Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ø¯ÙŠÙˆÙ†",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªÙØ¹ÙŠÙ„ Ø£Ùˆ Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ø¯ÙŠÙˆÙ†",userId:e==null?void 0:e.uid,userRole:n==null?void 0:n.role,onSuccess:async()=>{if(Hd!==null){const a=Hd;Kd(a);try{const r=e==null?void 0:e.uid,o=r?`debtsPinRequired_${r}`:"debtsPinRequired";localStorage.setItem(o,String(a)),r&&await ae.updateUserData(r,{debtsPinRequired:a})}catch{}y({title:a?"ØªÙ… ØªÙØ¹ÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ø¯ÙŠÙˆÙ†":"ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ø¯ÙŠÙˆÙ†",description:a?"Ø³ÙŠÙØ·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†.":"ÙŠÙ…ÙƒÙ† ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙŠÙˆÙ† Ø¨Ø¯ÙˆÙ† Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ."})}Bf(null),Jd(!1)}}),t.jsx(Jw,{open:cg,onOpenChange:ui,title:"ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶",description:"Ø³ÙŠØªÙ… Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù…Ù† Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙÙ‚Ø·ØŒ ÙˆÙ„Ù† ØªÙØ­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ Ù…Ù† Ø­Ø³Ø§Ø¨Ùƒ Ø£Ùˆ Ù…Ù† Firebase.",onSuccess:async()=>{try{if(!(e!=null&&e.uid)){ui(!1);return}const a=new Date,r=c=>c instanceof Date?c:typeof(c==null?void 0:c.toDate)=="function"?c.toDate():new Date(String(c)),o=ge.filter(c=>r(c.createdAt)<a);await ae.updateUserData(e.uid,{recentReset:{keepLastCount:Wu.keepLastCount??30,intervalDays:Wu.intervalDays??7,lastResetAt:a}}),Si(c=>({...c,lastResetAt:a})),y({title:"ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©",description:"ØªÙ… Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø£Ù‚Ø¯Ù… Ù…Ù† ÙˆÙ‚Øª Ø§Ù„ØªØµÙÙŠØ± Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ø¯ÙˆÙ† Ø§Ù„ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…/Ø§Ù„Ø´Ù‡Ø± Ø£Ùˆ Ø§Ù„Ø­Ø¯ÙˆØ¯."})}catch(a){console.error("ÙØ´Ù„ ØªÙ†ÙÙŠØ° Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:",a),y({title:"ÙØ´Ù„ Ø§Ù„ØªØµÙÙŠØ±",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø«Ù… Ø£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.",variant:"destructive"})}finally{ui(!1)}}}),t.jsx(ea,{open:w0,onOpenChange:wr,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ÙØªØ­ Ù†Ø§ÙØ°Ø© Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„",onSuccess:()=>{wr(!1),Ts(!0)},userId:e==null?void 0:e.uid,userRole:n==null?void 0:n.role}),t.jsx(ue,{open:jn,onOpenChange:Zi,children:t.jsxs(me,{className:"w-full h-full max-w-full max-h-full p-0 m-0 rounded-none border-none",children:[t.jsx(he,{className:"sr-only",children:"Ù…ØªØ¬Ø± Ù†ÙŠÙˆ"}),t.jsxs("div",{className:"relative w-full h-full",children:[t.jsx(I,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 z-50 bg-white/50 dark:bg-black/50 hover:bg-white dark:hover:bg-black/80 rounded-full",onClick:()=>Zi(!1),children:t.jsx(cn,{className:"h-6 w-6"})}),t.jsx("iframe",{src:"https://naweshop.com/login",className:"w-full h-full border-none",title:"NaweShop Login"})]})]})}),t.jsx(ue,{open:Rf,onOpenChange:Vs,children:t.jsxs(me,{className:"sm:max-w-[425px] border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[t.jsxs(ye,{className:"flex items-center justify-between",children:[t.jsx(he,{className:"text-right",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†"}),t.jsxs("div",{className:"flex flex-col items-end gap-1",children:[t.jsxs("div",{className:"flex items-center gap-1 text-emerald-700",children:[t.jsx("span",{className:"text-[10px] font-bold",children:"Ù„ÙŠÙ†Ø§:"}),t.jsxs("span",{className:"text-xs font-bold",children:[Xu.creditor," Ø¬Ù†ÙŠÙ‡"]})]}),t.jsxs("div",{className:"flex items-center gap-1 text-red-700",children:[t.jsx("span",{className:"text-[10px] font-bold",children:"Ø¹Ù„ÙŠÙ†Ø§:"}),t.jsxs("span",{className:"text-xs font-bold",children:[Xu.debtor," Ø¬Ù†ÙŠÙ‡"]})]})]})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx(I,{variant:"outline",onClick:()=>Zd(Na==="debtor"?null:"debtor"),className:Ca("w-full transition-all duration-200",Na==="debtor"?"bg-red-600 hover:bg-red-700 text-white border-red-600":"border-red-200 text-red-700 hover:bg-red-50 hover:text-red-800"),children:"Ø¹Ù„ÙŠÙ†Ø§"}),t.jsx(I,{variant:"outline",onClick:()=>Zd(Na==="creditor"?null:"creditor"),className:Ca("w-full transition-all duration-200",Na==="creditor"?"bg-emerald-600 hover:bg-emerald-700 text-white border-emerald-600":"border-emerald-200 text-emerald-700 hover:bg-emerald-50 hover:text-emerald-800"),children:"Ù„ÙŠÙ†Ø§"})]}),(Na==="creditor"||Na==="debtor")&&t.jsxs(t.Fragment,{children:[Na==="creditor"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(G,{htmlFor:"debtorName",className:"text-right col-span-1",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†"}),t.jsx(Z,{id:"debtorName",value:Xo,onChange:a=>Zo(a.target.value),className:"col-span-3 text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(G,{htmlFor:"customerSelect",className:"text-right col-span-1",children:"Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù…ÙŠÙ„"}),t.jsxs(Fa,{value:Qa,onValueChange:a=>{ll(a);const r=wt.find(o=>o.id===a);r&&Zo(r.name)},children:[t.jsx(Ba,{className:"col-span-3 text-right",dir:"rtl",children:t.jsx($a,{placeholder:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†"})}),t.jsx(Ua,{className:"text-right",dir:"rtl",children:wt.length>0?wt.map(a=>t.jsxs(oa,{value:a.id,className:"text-right",children:[a.name," ",a.mobile?`(${a.mobile})`:""]},a.id)):t.jsx("div",{className:"p-2 text-center text-gray-500 text-sm",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ø³Ø¬Ù„ÙŠÙ†"})})]})]})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(G,{htmlFor:"debtAmount",className:"text-right col-span-1",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),t.jsx(Z,{id:"debtAmount",type:"text",inputMode:"decimal",value:el,onChange:a=>Qd(Ar(a.target.value)),className:"col-span-3 text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(G,{htmlFor:"debtReason",className:"text-right col-span-1",children:"Ø³Ø¨Ø¨ Ø§Ù„Ø¯ÙŠÙ†"}),t.jsx(Z,{id:"debtReason",value:Gd,onChange:a=>Xd(a.target.value),className:"col-span-3 text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø³Ø¨Ø¨ Ø§Ù„Ø¯ÙŠÙ†"})]})]})]}),t.jsx(We,{children:t.jsx(I,{onClick:()=>{const a=Na==="debtor";if(!a&&!(Na==="creditor")){y({title:"Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙŠÙ†",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¯ÙŠÙ† Ø£Ùˆ Ø¯Ø§Ø¦Ù† Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}const o=a?Xo||"Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…":Xo;if(!el||!o){y({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù…Ø¨Ù„Øº",variant:"destructive"});return}const c={id:Date.now().toString(),debtorName:o,amount:parseFloat(el),reason:Gd||"",status:"pending",createdAt:new Date,paidAmount:0,partialPayments:[],type:Na||"creditor"};Vr(c),hs(a?"add":"deduct"),zs(!0)},className:"bg-orange-500 hover:bg-orange-600",children:"Ø­ÙØ¸"})}),t.jsx("div",{className:"mt-2",children:t.jsx(I,{variant:"outline",className:"w-full",onClick:()=>ms(!0),children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†"})}),t.jsx("div",{className:"mt-2",children:t.jsx(I,{variant:"outline",className:"w-full",onClick:()=>sl(!0),children:"Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„"})}),t.jsx("div",{className:"mt-2",children:t.jsxs(I,{variant:"outline",className:"w-full text-rose-600 border-rose-200 hover:bg-rose-50 dark:border-rose-900/30 dark:text-rose-400 dark:hover:bg-rose-900/20",onClick:()=>Be("https://www.youtube.com/watch?v=v55ziGGuCWc","Ø´Ø±Ø­ Ù‚Ø³Ù… Ø§Ù„Ø¯ÙŠÙˆÙ† ÙˆØ§Ù„Ø§Ø¬Ù„ (ÙÙŠØ¯ÙŠÙˆ)"),children:[t.jsx($i,{className:"h-4 w-4 ml-2"}),"Ø´Ø±Ø­ Ù‚Ø³Ù… Ø§Ù„Ø¯ÙŠÙˆÙ† ÙˆØ§Ù„Ø§Ø¬Ù„ (ÙÙŠØ¯ÙŠÙˆ)"]})})]})}),t.jsx(ue,{open:tl,onOpenChange:ms,children:t.jsxs(me,{className:"w-[95vw] sm:w-auto sm:max-w-[520px] rounded-2xl border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[t.jsxs(ye,{children:[t.jsx(he,{className:"text-right",children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†"}),t.jsx(et,{className:"text-right",children:"Ø§Ø®ØªØ± Ø¯ÙŠÙ†Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ø¥ÙŠØµØ§Ù„Ù‡ Ø¨Ø§Ù„ØªÙØµÙŠÙ„"})]}),t.jsx("div",{className:"px-1 mb-2",children:t.jsxs("div",{className:"relative",children:[t.jsx(Nm,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"}),t.jsx(Z,{placeholder:"Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ø¨Ù„Øº...",value:Ur,onChange:a=>ou(a.target.value),className:"pr-9 text-right"})]})}),Ee.length>0?t.jsxs("div",{className:"max-h-[60vh] overflow-y-auto overscroll-contain scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400 space-y-2 px-1 -mx-1 sm:mx-0 sm:px-0",style:{contain:"layout paint"},onScroll:a=>{const r=a.currentTarget;ii.length<ni.length&&r.scrollTop+r.clientHeight>=r.scrollHeight-50&&ri(o=>o+1)},children:[ii.length>0?ii.map(a=>t.jsx("div",{onClick:()=>{Br(a),Ha(!0),ms(!1),Vs(!1)},className:`p-4 sm:p-3 border rounded-xl cursor-pointer hover:bg-gray-50 transition-colors min-h-[64px] ${a.type==="debtor"?"border-r-4 border-r-red-500 bg-red-50/10":"border-r-4 border-r-emerald-500"}`,children:t.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:justify-between sm:items-center",children:[t.jsxs("div",{className:"text-right space-y-0.5",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"font-medium text-[14px] sm:text-sm",children:a.debtorName}),a.type==="debtor"&&t.jsx(La,{variant:"destructive",className:"h-5 text-[10px] px-1",children:"Ø¹Ù„ÙŠÙ†Ø§"}),(!a.type||a.type==="creditor")&&t.jsx(La,{variant:"outline",className:"h-5 text-[10px] px-1 text-emerald-700 border-emerald-200 bg-emerald-50",children:"Ù„Ù†Ø§"})]}),t.jsx("p",{className:"text-[13px] sm:text-sm text-gray-600",children:a.reason}),t.jsx("p",{className:"text-[12px] sm:text-sm text-gray-500",children:tn.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))})]}),t.jsxs("div",{className:"text-left",children:[t.jsxs("p",{className:"font-bold text-xl sm:text-lg",children:[(Number(a.amount||0)-Number(a.paidAmount||0)).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]}),t.jsx(La,{variant:a.status==="paid"?"default":"secondary",className:`${a.status==="paid"?"bg-green-500":"bg-yellow-500"} text-[12px] sm:text-xs`,children:a.status==="paid"?"Ù…Ø¯ÙÙˆØ¹":"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"})]})]})},a.id)):t.jsx("div",{className:"text-center py-8 text-gray-500",children:t.jsx("p",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ø¨Ø­Ø«"})}),ii.length<ni.length&&t.jsx("div",{className:"flex justify-center pt-1",children:t.jsx(I,{variant:"outline",size:"sm",onClick:()=>ri(a=>a+1),children:"ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯"})})]}):t.jsx("div",{className:"text-center text-sm text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙŠÙˆÙ† Ù…Ø³Ø¬Ù„Ø©"}),t.jsxs(We,{className:"flex justify-between mt-3",children:[t.jsx(I,{variant:"destructive",onClick:async()=>{try{if(!Ee||Ee.length===0){y({title:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙŠÙˆÙ†",description:"Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙØ§Ø±ØºØ© Ø¨Ø§Ù„ÙØ¹Ù„."});return}if(!window.confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù ÙƒÙ„ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†ØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."))return;const r=[];if(qt(r),Br(null),await Ea(r),e!=null&&e.uid)try{await ae.updateUserData(e.uid,{debts:[],debtsDeletedAt:gt()});try{localStorage.removeItem(`debts_unsynced_${e.uid}`)}catch{}}catch(o){console.error("ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ø¯ÙŠÙˆÙ† Ù…Ù† Firebase:",o),y({title:"ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©",description:"ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª Ù…Ù† FirebaseØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"});return}y({title:"ØªÙ… Ø­Ø°Ù ÙƒÙ„ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†",description:"ØªÙ… ØªÙØ±ÙŠØº Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„."}),ms(!1)}catch(a){console.error("ØªØ¹Ø°Ø± Ø­Ø°Ù ÙƒÙ„ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†:",a),y({title:"ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°ÙØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"})}},children:"Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª"}),t.jsx(I,{variant:"outline",onClick:()=>ms(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})]})]})}),t.jsx(ue,{open:Eo,onOpenChange:B0,children:t.jsxs(me,{className:"max-w-2xl h-[80vh] flex flex-col p-0",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[t.jsxs(ye,{className:"p-4 border-b",children:[t.jsx(he,{children:"Ø³Ø¬Ù„ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙˆÙ†"}),t.jsx(et,{children:"Ø¹Ø±Ø¶ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®"})]}),t.jsxs("div",{className:"p-4 border-b bg-gray-50 dark:bg-gray-900 flex flex-col sm:flex-row gap-4 items-end",children:[t.jsxs("div",{className:"space-y-2 flex-1",children:[t.jsx(G,{children:"Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø­Ø«"}),t.jsxs("div",{className:"flex bg-white dark:bg-gray-800 rounded-md border p-1",children:[t.jsx("button",{onClick:()=>Nd("day"),className:`flex-1 px-3 py-1.5 text-sm rounded-sm transition-colors ${us==="day"?"bg-purple-100 text-purple-700 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"ÙŠÙˆÙ…ÙŠ"}),t.jsx("button",{onClick:()=>Nd("month"),className:`flex-1 px-3 py-1.5 text-sm rounded-sm transition-colors ${us==="month"?"bg-purple-100 text-purple-700 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Ø´Ù‡Ø±ÙŠ"})]})]}),t.jsxs("div",{className:"space-y-2 flex-1",children:[t.jsx(G,{children:us==="day"?"Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…":"Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±"}),t.jsx(Z,{type:us==="day"?"date":"month",value:us==="day"?Fs:Fs.substring(0,7),onChange:a=>U0(a.target.value),className:"bg-white dark:bg-gray-800"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"text-sm font-medium text-gray-500 mb-1",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØªØ±Ø©"}),t.jsx("div",{className:"text-lg font-bold text-green-600",children:ws(Ro.reduce((a,r)=>a+(r.amount||0),0))})]})]}),t.jsx("div",{className:"flex-1 overflow-auto p-0",children:Ro.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-gray-500",children:[t.jsx(bm,{className:"h-12 w-12 mb-2 opacity-20"}),t.jsx("p",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø³Ø¯Ø§Ø¯ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©"})]}):t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"grid grid-cols-3 bg-gray-50 dark:bg-gray-900 p-3 text-sm font-medium text-gray-500 border-b",children:[t.jsx("div",{className:"text-right",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),t.jsx("div",{className:"text-right",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†"}),t.jsx("div",{className:"text-right",children:"Ø§Ù„Ù…Ø¨Ù„Øº"})]}),t.jsx("div",{className:"divide-y dark:divide-gray-800",children:Ro.map(a=>{var r;return t.jsxs("div",{className:"grid grid-cols-3 p-3 items-center hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[t.jsx("div",{className:"text-sm text-gray-500 font-mono",children:(r=a.createdAt)!=null&&r.seconds?new Date(a.createdAt.seconds*1e3).toLocaleString("ar-EG"):"Ø§Ù„Ø¢Ù†"}),t.jsx("div",{className:"font-medium",children:a.debtorName}),t.jsx("div",{className:"font-bold text-green-600",children:ws(a.amount)})]},a.id)})})]})})]})}),t.jsx(ue,{open:zf,onOpenChange:sl,children:t.jsxs(me,{className:"sm:max-w-[500px] w-full max-h-[90vh] overflow-hidden flex flex-col p-0 gap-0 !bg-[#0f172a] !text-slate-100 border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[t.jsxs("div",{className:"p-4 border-b border-slate-800 bg-[#0f172a]",children:[t.jsxs(ye,{children:[t.jsx(he,{className:"text-right flex items-center justify-end",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(on,{className:"w-5 h-5 text-primary"}),"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ø¯ÙŠÙˆÙ†"]})}),t.jsx(et,{className:"text-right",children:"Ø³Ø¬Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ø¯ÙŠÙˆÙ† Ø¨Ø³Ù‡ÙˆÙ„Ø©"})]}),t.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",dir:"rtl",children:[t.jsx(I,{variant:Ys==="customers_list"?"default":"outline",onClick:()=>rl("customers_list"),size:"sm",className:"flex-1 text-xs h-8",children:"Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†"}),t.jsx(I,{variant:Ys==="add_debt"?"default":"outline",onClick:()=>rl("add_debt"),size:"sm",className:"flex-1 text-xs h-8",children:"ØªØ³Ø¬ÙŠÙ„ Ø¯ÙŠÙ†"}),t.jsx(I,{variant:Ys==="add_customer"?"default":"outline",onClick:()=>rl("add_customer"),size:"sm",className:"flex-1 text-xs h-8",children:"Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„"})]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[Ys==="add_customer"&&t.jsxs(Za,{className:"border shadow-sm bg-white dark:bg-card dark:border-gray-800",children:[t.jsx(bs,{className:"pb-2 pt-4 px-4",children:t.jsxs(vs,{className:"text-sm font-medium text-right text-gray-700 dark:text-gray-200 flex items-center justify-end gap-2",children:[t.jsx(Pt,{className:"w-4 h-4"}),"Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯"]})}),t.jsxs(es,{className:"p-4 pt-2 space-y-3",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{className:"text-right block text-xs text-gray-500 dark:text-gray-400",children:"Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„"}),t.jsx(Z,{value:il,onChange:a=>lu(a.target.value),className:"text-right h-9 dark:bg-gray-900 dark:border-gray-700",placeholder:"Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{className:"text-right block text-xs text-gray-500 dark:text-gray-400",children:"Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),t.jsx(Z,{value:ol,onChange:a=>cu(a.target.value),className:"text-right h-9 dark:bg-gray-900 dark:border-gray-700",placeholder:"Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"})]}),t.jsxs(I,{className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white h-9 mt-2",onClick:async()=>{if(!il||!ol){y({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„",variant:"destructive"});return}const a={id:Date.now().toString(),name:il.trim(),mobile:ol.trim(),createdAt:new Date},r=[a,...wt];await _l(r),lu(""),cu(""),y({title:"ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„",description:`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${a.name}`})},children:[t.jsx(Pt,{className:"w-4 h-4 mr-2"}),"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„"]})]})]}),Ys==="add_debt"&&t.jsxs(Za,{className:"border shadow-sm bg-white dark:bg-card dark:border-gray-800",children:[t.jsx(bs,{className:"pb-2 pt-4 px-4",children:t.jsxs(vs,{className:"text-sm font-medium text-right text-gray-700 dark:text-gray-200 flex items-center justify-end gap-2",children:[t.jsx(Va,{className:"w-4 h-4 text-orange-600"}),"ØªØ³Ø¬ÙŠÙ„ Ù…Ø¨Ù„Øº Ø¯ÙŠÙ†"]})}),t.jsx(es,{className:"p-4 pt-2 space-y-3",children:wt.length>0?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{className:"text-right block text-xs text-gray-500 dark:text-gray-400",children:"Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…ÙŠÙ„"}),t.jsxs(Fa,{value:Qa,onValueChange:ll,children:[t.jsx(Ba,{className:"w-full h-9 text-right dark:bg-gray-900 dark:border-gray-700",dir:"rtl",children:t.jsx($a,{placeholder:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„"})}),t.jsx(Ua,{className:"dark:bg-gray-900 dark:border-gray-800",children:wt.map(a=>t.jsxs(oa,{value:a.id,className:"text-right justify-end",children:[a.name," â€” ",a.mobile]},a.id))})]}),Qa&&(()=>{const a=Ee.filter(r=>r.customerId===Qa&&r.status==="pending").reduce((r,o)=>r+(o.amount-(o.paidAmount||0)),0);return t.jsxs("div",{className:"flex items-center justify-between mt-1",children:[t.jsx(I,{variant:"ghost",size:"sm",className:"h-6 text-xs text-blue-600 hover:text-blue-700 hover:bg-blue-50 px-2",onClick:()=>{Zf(Qa),hl(!0)},children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø¯ÙŠÙˆÙ†Ù‡"}),a>0&&t.jsxs("div",{className:"text-xs text-red-600 font-semibold text-right",children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙŠÙˆÙ† Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ",a.toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]})]})})()]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(G,{className:"text-right block text-xs text-gray-500",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),t.jsx(Z,{type:"number",value:du,onChange:a=>Kf(a.target.value),className:"text-right h-9",placeholder:"0.00"})]}),t.jsx(I,{className:"w-full bg-orange-600 hover:bg-orange-700 text-white h-9 mt-2",onClick:async()=>{const a=parseFloat(du);if(!Qa){y({title:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}if(isNaN(a)||a<=0){y({title:"Ù‚ÙŠÙ…Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const r=wt.find(c=>c.id===Qa);if(!r)return;const o={id:Date.now().toString(),debtorName:r.name,customerId:r.id,mobile:r.mobile,amount:Math.round(a),reason:"Ø¯ÙŠÙ† Ø¹Ù…ÙŠÙ„",status:"pending",createdAt:new Date,paidAmount:0,partialPayments:[]};Vr(o),zs(!0)},children:"Ù…ØªØ§Ø¨Ø¹Ø© ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº"})]}):t.jsx("div",{className:"text-center py-4 text-gray-500 text-sm bg-gray-50 rounded border border-dashed",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ø³Ø¬Ù„ÙŠÙ†. Ø£Ø¶Ù Ø¹Ù…ÙŠÙ„Ø§Ù‹ Ø£ÙˆÙ„Ø§Ù‹."})})]}),Ys==="customers_list"&&t.jsxs(Za,{className:"border shadow-sm bg-white dark:bg-card dark:border-gray-800",children:[t.jsx(bs,{className:"pb-2 pt-4 px-4",children:t.jsxs(vs,{className:"text-sm font-medium text-right text-gray-700 dark:text-gray-200 flex items-center justify-end gap-2",children:[t.jsx(Im,{className:"w-4 h-4"}),"Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† (",wt.length,")"]})}),t.jsx(es,{className:"p-4 pt-2",children:wt.length>0?t.jsx("div",{className:"space-y-2",children:wt.map(a=>t.jsxs("div",{className:"p-3 border rounded-lg flex items-center justify-between bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors dark:border-gray-700",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8 text-blue-600 hover:text-blue-700 hover:bg-blue-50",onClick:()=>{uu(a.id),cl(a.name||""),dl(a.mobile||""),oi(!0)},children:t.jsx(km,{className:"h-4 w-4"})}),t.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>{ul(a.id),ml(a.name||""),li(!0)},children:t.jsx(Sa,{className:"h-4 w-4"})})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:a.name}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono",children:a.mobile})]})]},a.id))}):t.jsx("div",{className:"text-center py-4 text-gray-400 text-sm",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§"})})]})]}),t.jsx(We,{className:"p-4 border-t bg-white dark:bg-card dark:border-gray-800",children:t.jsx(I,{variant:"outline",className:"w-full sm:w-auto dark:bg-gray-800 dark:text-white dark:border-gray-700 dark:hover:bg-gray-700",onClick:()=>sl(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),t.jsx(ue,{open:Xf,onOpenChange:hl,children:t.jsxs(me,{className:"sm:max-w-[500px] max-h-[80vh] overflow-hidden flex flex-col p-0 gap-0",children:[t.jsx("div",{className:"p-4 border-b bg-white dark:bg-card dark:border-gray-800",children:t.jsxs(ye,{children:[t.jsxs(he,{className:"text-right flex items-center justify-end gap-2 dark:text-gray-100",children:[t.jsx(Ei,{className:"w-5 h-5 text-blue-600"}),"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„"]}),t.jsx(et,{className:"text-right dark:text-gray-400",children:(rm=wt.find(a=>a.id===fl))==null?void 0:rm.name})]})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50/50 dark:bg-black/50",children:[Ee.filter(a=>a.customerId===fl).sort((a,r)=>new Date(r.createdAt).getTime()-new Date(a.createdAt).getTime()).map(a=>t.jsxs("div",{className:"p-3 border rounded-lg bg-white dark:bg-card dark:border-gray-700 shadow-sm flex justify-between items-center",children:[t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"font-bold text-sm dark:text-gray-100",children:[(Number(a.amount||0)-Number(a.paidAmount||0)).toLocaleString("en-US",{maximumFractionDigits:0})," Ø¬Ù†ÙŠÙ‡"]}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:a.reason}),t.jsx(La,{variant:a.status==="paid"?"default":"secondary",className:`mt-1 h-5 text-[10px] ${a.status==="paid"?"bg-green-500":"bg-yellow-500 text-yellow-950"}`,children:a.status==="paid"?"Ù…Ø¯ÙÙˆØ¹":"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"})]}),t.jsxs("div",{className:"text-left text-xs text-gray-400 flex flex-col items-end gap-1",children:[t.jsx("div",{className:"font-mono",children:tn.format(new Date(a.createdAt))}),t.jsx("div",{className:"font-mono",children:new Date(a.createdAt).toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit"})})]})]},a.id)),Ee.filter(a=>a.customerId===fl).length===0&&t.jsxs("div",{className:"text-center text-gray-500 py-8 flex flex-col items-center gap-2",children:[t.jsx(Ei,{className:"w-8 h-8 text-gray-300"}),t.jsx("span",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥ÙŠØµØ§Ù„Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„"})]})]}),t.jsx(We,{className:"p-4 border-t bg-white dark:bg-card dark:border-gray-800",children:t.jsx(I,{variant:"outline",className:"w-full dark:bg-gray-800 dark:text-white dark:border-gray-700 dark:hover:bg-gray-700",onClick:()=>hl(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),t.jsx(ue,{open:Qf,onOpenChange:li,children:t.jsxs(me,{hideClose:!0,className:"sm:max-w-[420px] rounded-2xl bg-gradient-to-br from-white via-rose-50 to-red-50 dark:from-gray-900 dark:via-red-950/30 dark:to-red-900/10 shadow-2xl border border-red-100 dark:border-red-900/50 text-center",children:[t.jsxs(ye,{children:[t.jsx(he,{className:"text-center text-xl font-bold text-red-700 dark:text-red-400",children:"ØªØ£ÙƒÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„"}),t.jsxs(et,{className:"text-center text-gray-600 dark:text-gray-300",children:["Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§: ",fu]})]}),t.jsx("div",{className:"py-2 text-sm text-gray-700 dark:text-gray-400",children:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡."}),t.jsxs(We,{className:"flex justify-center gap-3",children:[t.jsx(I,{variant:"outline",onClick:()=>{li(!1),ul(""),ml("")},children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{variant:"destructive",className:"bg-red-600 hover:bg-red-700",onClick:async()=>{const a=Gf,r=wt.filter(o=>o.id!==a);await _l(r),Qa===a&&ll(""),li(!1),ul(""),ml(""),y({title:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„",description:fu})},children:"Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ"})]})]})}),t.jsx(ue,{open:Jf,onOpenChange:oi,children:t.jsxs(me,{className:"sm:max-w-[420px]",children:[t.jsx(ye,{children:t.jsx(he,{className:"text-right",children:"ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„"})}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(G,{htmlFor:"editCustomerName",className:"text-right col-span-1",children:"Ø§Ù„Ø§Ø³Ù…"}),t.jsx(Z,{id:"editCustomerName",value:mu,onChange:a=>cl(a.target.value),className:"col-span-3 text-right"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(G,{htmlFor:"editCustomerMobile",className:"text-right col-span-1",children:"Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),t.jsx(Z,{id:"editCustomerMobile",value:hu,onChange:a=>dl(a.target.value),className:"col-span-3 text-right"})]})]}),t.jsxs(We,{className:"flex justify-between",children:[t.jsx(I,{variant:"outline",onClick:()=>oi(!1),children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{const a=Hf,r=mu.trim(),o=hu.trim();if(!a||!r||!o){y({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„",variant:"destructive"});return}const c=wt.map(m=>m.id===a?{...m,name:r,mobile:o}:m);await _l(c);const d=Ee.map(m=>m.customerId===a?{...m,debtorName:r,mobile:o}:m);d!==Ee&&(qt(d),await Ea(d)),oi(!1),uu(""),cl(""),dl(""),y({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù…ÙŠÙ„",description:r})},children:"Ø­ÙØ¸"})]})]})}),t.jsx(ue,{open:v0,onOpenChange:Ts,children:t.jsxs(me,{className:"sm:max-w-[520px]",children:[t.jsxs(ye,{children:[t.jsx(he,{className:"text-right",children:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„"}),t.jsx(et,{className:"text-right",children:"Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ØµØ±ÙˆÙ Ø«Ù… Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø®ØµÙ…."})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(G,{htmlFor:"expenseName",className:"text-right col-span-1",children:"Ø§Ø³Ù… Ø§Ù„Ù…ØµØ±ÙˆÙ"}),t.jsx(Z,{id:"expenseName",value:Tn,onChange:a=>Xc(a.target.value),className:"col-span-3 text-right",placeholder:"Ù…Ø«Ø§Ù„: ÙƒÙ‡Ø±Ø¨Ø§Ø¡ØŒ ØµÙŠØ§Ù†Ø©ØŒ Ù…Ø´ØªØ±ÙŠØ§Øª"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(G,{htmlFor:"expenseAmount",className:"text-right col-span-1",children:"ØªÙ…Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"}),t.jsx(Z,{id:"expenseAmount",type:"number",value:po,onChange:a=>Zc(a.target.value),className:"col-span-3 text-right",placeholder:"0.00"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(G,{htmlFor:"expenseNotes",className:"text-right col-span-1",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª"}),t.jsx(Z,{id:"expenseNotes",value:xo,onChange:a=>ed(a.target.value),className:"col-span-3 text-right",placeholder:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¥Ù† ÙˆØ¬Ø¯Øª"})]})]}),t.jsxs(We,{className:"flex justify-between",children:[t.jsx(I,{className:"bg-orange-600 hover:bg-orange-700",onClick:()=>{if(!Tn||!po){y({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ØµØ±ÙˆÙ ÙˆÙ‚ÙŠÙ…ØªÙ‡",variant:"destructive"});return}Mn(!0)},children:"Ø¥Ø¶Ø§ÙØ© Ù…ØµØ±ÙˆÙ"}),t.jsx(I,{variant:"outline",onClick:()=>vo(!0),children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ"})]})]})}),t.jsx(ue,{open:j0,onOpenChange:vo,children:t.jsxs(me,{className:"sm:max-w-[420px]",dir:"rtl",children:[t.jsxs(ye,{children:[t.jsx(he,{className:"text-right",children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ"}),t.jsx(et,{className:"text-right",children:"Ø¢Ø®Ø± Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©"})]}),Pn.length>0?t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Pn.map(a=>t.jsx("div",{className:"p-2 border rounded-lg bg-white dark:bg-card dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"font-medium text-sm dark:text-gray-200",children:a.name}),t.jsx("p",{className:"text-[11px] text-gray-600 dark:text-gray-400",children:a.notes||"Ø¨Ø¯ÙˆÙ† Ù…Ù„Ø§Ø­Ø¸Ø§Øª"}),t.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-500",children:new Date(a.createdAt).toLocaleString("ar-EG")})]}),t.jsxs("div",{className:"text-left flex items-start gap-2",children:[t.jsxs("div",{className:"text-left",children:[t.jsxs("p",{className:"font-bold text-sm dark:text-gray-200",children:[a.amount," Ø¬Ù†ÙŠÙ‡"]}),t.jsx(La,{variant:"secondary",className:a.source==="cash"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",children:a.source==="cash"?"Ù…Ù† Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©":`Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©${a.walletId?` (${a.walletId})`:""}`})]}),t.jsxs(I,{variant:"destructive",size:"sm",className:"shrink-0",onClick:()=>gg(a.id),title:"Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ",children:[t.jsx(Sa,{className:"w-4 h-4 ml-1"}),"Ø­Ø°Ù"]})]})]})},a.id))}):t.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØµØ§Ø±ÙŠÙ Ù…Ø³Ø¬Ù„Ø© Ø¨Ø¹Ø¯"})]})}),t.jsx(ue,{open:N0,onOpenChange:Mn,children:t.jsxs(me,{className:"sm:max-w-[480px]",children:[t.jsx(ye,{children:t.jsx(he,{className:"text-right",children:"Ø§Ø®ØªÙŠØ§Ø± Ù…ØµØ¯Ø± Ø®ØµÙ… Ø§Ù„Ù…ØµØ±ÙˆÙ"})}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-right",children:"Ø§Ø®ØªØ± Ù‡Ù„ ØªØ±ÙŠØ¯ Ø®ØµÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØµØ±ÙˆÙ Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬ Ø£Ù… Ù…Ù† Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸."}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsx(I,{variant:St==="cash"?"default":"outline",className:St==="cash"?"bg-blue-600 hover:bg-blue-700 text-white":"",onClick:()=>Nr("cash"),children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),t.jsx(I,{variant:St==="wallet"?"default":"outline",className:St==="wallet"?"bg-purple-600 hover:bg-purple-700 text-white":"",onClick:()=>Nr("wallet"),children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),t.jsx(I,{variant:St==="fawry"?"default":"outline",className:St==="fawry"?"bg-amber-600 hover:bg-amber-700 text-white":"",onClick:()=>Nr("fawry"),children:"ÙÙˆØ±ÙŠ"})]}),St==="wallet"&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{className:"text-right block",children:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…"}),t.jsxs(Fa,{value:Ps,onValueChange:bo,children:[t.jsx(Ba,{className:"w-full",children:t.jsx($a,{placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©"})}),t.jsx(Ua,{children:X.map(a=>t.jsx(oa,{value:a.id,children:a.phone||a.name||a.id},a.id))})]})]})]}),t.jsxs(We,{className:"flex justify-between",children:[t.jsx(I,{variant:"outline",onClick:()=>{Mn(!1),Nr(null),bo("")},children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{const a=Number(po);if(isNaN(a)||a<=0){y({title:"Ù‚ÙŠÙ…Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}if(!St){y({title:"Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø®ØµÙ…",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}try{if(St==="cash"){const d=Math.round(Ve-a);at(d),localStorage.setItem(Qe(),d.toString());const m={cashBalance:d,lastUpdated:new Date().toISOString()},f=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(f,JSON.stringify(m)),e!=null&&e.uid?(await ae.updateUserData(e.uid,m),localStorage.removeItem(f),we(!1)):we(!0)}else if(St==="wallet"){if(!Ps){y({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…",variant:"destructive"});return}const d=Se[Ps]||0,m=Math.round(d-a),f={...Se,[Ps]:m};ut(f);const g=new Date().toISOString(),w={walletBalances:f,lastUpdated:g},N=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(N,JSON.stringify(w)),localStorage.setItem(st(),JSON.stringify(f)),localStorage.setItem(`walletBalances_backup_${g}`,JSON.stringify(f)),e!=null&&e.uid&&ae.updateUserData(e.uid,w).catch(()=>{})}}catch(d){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø¹Ù†Ø¯ Ø­ÙØ¸ Ø§Ù„Ù…ØµØ±ÙˆÙ:",d)}let r=Date.now().toString();try{if(e!=null&&e.uid){const{addDoc:d,collection:m,serverTimestamp:f}=await ne(async()=>{const{addDoc:N,collection:x,serverTimestamp:v}=await import("./index-CgV0sHeM.js").then(j=>j.cP);return{addDoc:N,collection:x,serverTimestamp:v}},__vite__mapDeps([0,1]),import.meta.url),{db:g}=await ne(async()=>{const{db:N}=await import("./index-CgV0sHeM.js").then(x=>x.cQ);return{db:N}},__vite__mapDeps([0,1]),import.meta.url);r=(await d(m(g,"shop_expenses"),{userId:e.uid,shopId:D||(n==null?void 0:n.shopId)||e.uid||"default-shop",name:Tn,amount:a,notes:xo||"",source:St,walletId:St==="wallet"?Ps:null,createdAt:f()})).id}}catch(d){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…ØµØ±ÙˆÙ ÙÙŠ Firestore:",d)}const o={id:r,name:Tn,amount:a,notes:xo,source:St,walletId:St==="wallet"?Ps:void 0,createdAt:new Date},c=[...Pn,o];await Iu(c),Xc(""),Zc(""),ed(""),Nr(null),bo(""),Mn(!1),Ts(!0),vo(!0),y({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ØµØ±ÙˆÙ",description:St==="cash"?"ØªÙ… Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©":St==="wallet"?"ØªÙ… Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸":"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± ÙÙˆØ±ÙŠ"})},children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø®ØµÙ…"})]})]})}),t.jsx(ue,{open:D0,onOpenChange:jr,children:t.jsxs(me,{className:"sm:max-w-[520px]",children:[t.jsxs(ye,{children:[t.jsx(he,{className:"text-right",children:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"}),t.jsx(et,{className:"text-right",children:"Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Ø§Ù‚ØµØ© Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ø´Ø±Ø§Ø¡ ÙˆØªØ§Ø¨Ø¹ Ø­Ø§Ù„ØªÙ‡Ø§."})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(G,{htmlFor:"deficiencyName",className:"text-right col-span-1",children:"Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±"}),t.jsx(Z,{id:"deficiencyName",value:Sr,onChange:a=>wo(a.target.value),className:"col-span-3 text-right",placeholder:"Ù…Ø«Ø§Ù„: Ø³ÙƒØ±ØŒ Ø²ÙŠØªØŒ Ù…Ù†Ø§Ø¯ÙŠÙ„"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(G,{htmlFor:"deficiencyQuantity",className:"text-right col-span-1",children:"Ø§Ù„ÙƒÙ…ÙŠØ©"}),t.jsx(Z,{id:"deficiencyQuantity",type:"number",value:td,onChange:a=>No(a.target.value),className:"col-span-3 text-right",placeholder:"1"})]}),t.jsx("div",{className:"flex justify-end",children:t.jsx(I,{className:"bg-rose-600 hover:bg-rose-700",onClick:()=>{if(Pe){y({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}const a=parseInt(td||"1",10);if(!Sr){y({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±",variant:"destructive"});return}if(isNaN(a)||a<=0){y({title:"ÙƒÙ…ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ…ÙŠØ© ØµØ­ÙŠØ­Ø©",variant:"destructive"});return}(async()=>{if(e!=null&&e.uid)try{const{collection:o,addDoc:c,serverTimestamp:d}=await ne(async()=>{const{collection:g,addDoc:w,serverTimestamp:N}=await import("./index-CgV0sHeM.js").then(x=>x.cP);return{collection:g,addDoc:w,serverTimestamp:N}},__vite__mapDeps([0,1]),import.meta.url),{db:m}=await ne(async()=>{const{db:g}=await import("./index-CgV0sHeM.js").then(w=>w.cQ);return{db:g}},__vite__mapDeps([0,1]),import.meta.url),f=await c(o(m,"deficiencies"),{userId:e.uid,shopId:D||(n==null?void 0:n.shopId)||e.uid||"default-shop",name:Sr,quantity:a,status:"pending",createdAt:d()});try{const g=xi(),w=localStorage.getItem(g),N=w?JSON.parse(w):[],x=Array.isArray(N)?N:[],v=x.some(_=>String((_==null?void 0:_.id)||"")===f.id),j={id:f.id,name:Sr,quantity:a,status:"pending",createdAt:new Date().toISOString()},S=v?x:[...x,j];localStorage.setItem(g,JSON.stringify(S))}catch{}wo(""),No(""),y({title:"ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©",description:"ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†ØµØ± Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"});return}catch(o){console.warn("ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ø¥Ù„Ù‰ FirestoreØŒ Ø³ÙŠÙØ³ØªØ®Ø¯Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",o)}const r={id:Date.now().toString(),name:Sr,quantity:a,status:"pending",createdAt:new Date};Ms(o=>{const c=[...o,r];return Il(c),c}),wo(""),No(""),y({title:"ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©",description:"ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†ØµØ± Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"})})()},children:"Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù†ÙˆØ§Ù‚Øµ"})}),ad.length>0?t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:ad.map(a=>t.jsx("div",{className:"p-2 border rounded-lg bg-white dark:bg-card dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"font-medium text-sm dark:text-gray-200",children:a.name}),t.jsxs("p",{className:"text-[11px] text-gray-600 dark:text-gray-400",children:["Ø§Ù„ÙƒÙ…ÙŠØ©: ",a.quantity]}),t.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-500",children:new Date(a.createdAt).toLocaleString("ar-EG")})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(La,{variant:"secondary",className:a.status==="pending"?"bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-300":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:a.status==="pending"?"Ù‚ÙŠØ¯ Ø§Ù„Ø´Ø±Ø§Ø¡":"ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡"}),t.jsx(I,{variant:"outline",className:a.status==="pending"?"text-green-700 border-green-300 hover:bg-green-50":"text-rose-700 border-rose-300 hover:bg-rose-50",onClick:()=>{(async()=>{const r=a.status==="pending"?"purchased":"pending";if(e!=null&&e.uid)try{const{doc:o,updateDoc:c,serverTimestamp:d}=await ne(async()=>{const{doc:f,updateDoc:g,serverTimestamp:w}=await import("./index-CgV0sHeM.js").then(N=>N.cP);return{doc:f,updateDoc:g,serverTimestamp:w}},__vite__mapDeps([0,1]),import.meta.url),{db:m}=await ne(async()=>{const{db:f}=await import("./index-CgV0sHeM.js").then(g=>g.cQ);return{db:f}},__vite__mapDeps([0,1]),import.meta.url);await c(o(m,"deficiencies",a.id),{status:r,updatedAt:d()});return}catch(o){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ø¹Ù„Ù‰ FirestoreØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",o)}Ms(o=>{const c=o.map(d=>d.id===a.id?{...d,status:r}:d);return Il(c),c})})()},title:a.status==="pending"?"ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡":"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø´Ø±Ø§Ø¡",children:a.status==="pending"?"ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡":"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø´Ø±Ø§Ø¡"}),t.jsx(I,{variant:"outline",className:"text-red-700 border-red-300 hover:bg-red-50",onClick:()=>{(async()=>{if(e!=null&&e.uid)try{const{doc:r,deleteDoc:o}=await ne(async()=>{const{doc:d,deleteDoc:m}=await import("./index-CgV0sHeM.js").then(f=>f.cP);return{doc:d,deleteDoc:m}},__vite__mapDeps([0,1]),import.meta.url),{db:c}=await ne(async()=>{const{db:d}=await import("./index-CgV0sHeM.js").then(m=>m.cQ);return{db:d}},__vite__mapDeps([0,1]),import.meta.url);await o(r(c,"deficiencies",a.id));return}catch(r){console.warn("ÙØ´Ù„ Ø­Ø°Ù Ø¹Ù†ØµØ± Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ù…Ù† FirestoreØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",r)}Ms(r=>{const o=r.filter(c=>c.id!==a.id);return Il(o),o})})()},title:"Ø­Ø°Ù",children:"Ø­Ø°Ù"})]})]})},a.id))}):t.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³Ø¬Ù„Ø© ÙÙŠ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"})]}),t.jsx(We,{className:"flex justify-end",children:t.jsx(I,{variant:"outline",onClick:()=>jr(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),t.jsx(ue,{open:k0,onOpenChange:a=>{On(a),a||(Rn(null),Dr(""),kr(""))},children:t.jsxs(me,{className:"sm:max-w-[520px]",children:[t.jsxs(ye,{children:[t.jsx(he,{className:"text-right",children:"Ø£Ø±Ù‚Ø§Ù…ÙŠ Ù…Ø¹ Ø¹Ù…Ù„Ø§Ø¦ÙŠ"}),t.jsx(et,{className:"text-right",children:"Ø§Ø³ØªØ¹Ø±Ø¶ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø²Ø§Ø¦Ø¯ Ù„ØªØ³Ù„ÙŠÙ… Ø±Ù‚Ù… Ù„Ø¹Ù…ÙŠÙ„. Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù…Ø®ØµØµØ© Ù„Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØªÙŠ ØªØ¹Ø·ÙŠÙ‡Ø§ Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø­Ù„ Ù„ÙŠØ­ÙˆÙ‘Ù„ÙˆØ§ Ø¹Ù„ÙŠÙ‡Ø§ØŒ Ø­ØªÙ‰ ØªÙƒÙˆÙ† Ø¹Ø§Ø±Ù Ø£Ù† Ø§Ù„Ø®Ø·ÙˆØ· Ø¯ÙŠ Ù…Ø®ØµØµØ© Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù‡ÙŠØ­ÙˆÙ„Ùˆ Ø¹Ù„ÙŠÙ‡Ø§ Ù…Ù† Ø¨Ø±Ø§ Ø§Ù„Ù…Ø­Ù„ Ø¹Ù„Ø´Ø§Ù† Ù…ØªØ³ØªÙ„Ù…Ø´ Ø¹Ù„ÙŠÙ‡Ø§ ÙˆØªÙˆÙ‚Ù Ù„ÙŠÙ…ÙŠØªÙƒ"})]}),t.jsx("div",{className:"grid gap-3 py-2",children:X.length===0?t.jsx("div",{className:"text-center text-sm text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…Ø¶Ø§ÙØ© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†."}):X.map(a=>{const r=jo[a.id],o=!!r;return t.jsxs("div",{className:`p-3 rounded-lg border flex flex-col gap-2 ${o?"border-red-500 bg-red-50 text-red-700":"border-emerald-500 bg-emerald-50 text-emerald-700"}`,children:[t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsxs("div",{className:"flex flex-col items-end",children:[t.jsx("span",{className:"font-semibold text-base",children:a.phone||"Ø¨Ø¯ÙˆÙ† Ø±Ù‚Ù…"}),a.name?t.jsx("span",{className:"text-xs text-gray-600",children:a.name}):null,o&&t.jsxs("span",{className:"text-xs mt-1",children:["Ù„Ø¹Ù…ÙŠÙ„: ",r.name,r.amount&&r.amount.trim()!==""?` - Ù…Ø¨Ù„Øº: ${r.amount}`:""]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(I,{type:"button",size:"icon",className:"h-9 w-9 rounded-full bg-emerald-600 hover:bg-emerald-700 text-white",onClick:()=>{Rn(a.id),Dr((r==null?void 0:r.name)||""),kr((r==null?void 0:r.amount)||"")},children:t.jsx(Pt,{className:"h-4 w-4"})}),o&&t.jsx(I,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 rounded-full border-red-300 text-red-600 hover:bg-red-50",onClick:()=>{const c=`clientNumberAssignments_${(e==null?void 0:e.uid)||"default"}`,d={...jo};delete d[a.id],Os(d);try{localStorage.setItem(c,JSON.stringify(d))}catch{}En===a.id&&(Rn(null),Dr(""),kr(""))},children:t.jsx(Sa,{className:"h-4 w-4"})})]})]}),En===a.id&&t.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[t.jsx(Z,{placeholder:"Ø§Ø³Ù… Ù…Ø³ØªÙ„Ù… Ø§Ù„Ø±Ù‚Ù…",className:"text-right",value:sd,onChange:c=>Dr(c.target.value)}),t.jsx(Z,{placeholder:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ ØªØ­ÙˆÙŠÙ„Ù‡",className:"text-right sm:max-w-[160px]",value:rd,onChange:c=>kr(c.target.value),inputMode:"decimal"}),t.jsx(I,{className:"bg-red-600 hover:bg-red-700 text-white px-4",onClick:()=>{const c=sd.trim();if(!c){y({title:"Ø§Ø³Ù… ØºÙŠØ± ØµØ­ÙŠØ­",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ù…Ø³ØªÙ„Ù… Ø§Ù„Ø±Ù‚Ù…",variant:"destructive"});return}if(!En)return;const d=rd.trim(),m=`clientNumberAssignments_${(e==null?void 0:e.uid)||"default"}`,f={...jo,[En]:{name:c,amount:d}};Os(f);try{localStorage.setItem(m,JSON.stringify(f))}catch{}Rn(null),Dr(""),kr("")},children:"ØªØ³Ù„ÙŠÙ…"})]})]},a.id)})})]})}),t.jsx(ue,{open:eg,onOpenChange:zs,children:t.jsxs(me,{className:"sm:max-w-[480px]",children:[t.jsx(ye,{children:t.jsx(he,{className:"text-right",children:(lt==null?void 0:lt.type)==="decrease"?"Ø§Ø®ØªÙŠØ§Ø± Ù…ÙƒØ§Ù† Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯":Oa?"Ø§Ø®ØªÙŠØ§Ø± Ù…ØµØ¯Ø± Ø§Ù„Ø®ØµÙ… / Ø§Ù„Ø¥Ø¶Ø§ÙØ©":"Ø§Ø®ØªÙŠØ§Ø± Ù…ØµØ¯Ø± Ø®ØµÙ… Ø§Ù„Ø¯ÙŠÙ†"})}),t.jsxs("div",{className:"space-y-4",children:[Oa&&t.jsxs("div",{className:"flex w-full rounded-lg border border-gray-300 dark:border-gray-700 overflow-hidden mb-4",children:[t.jsx("button",{type:"button",onClick:()=>hs("deduct"),className:`flex-1 py-2 text-sm font-medium transition-colors ${bt==="deduct"?"bg-red-100 text-red-900 dark:bg-red-900/40 dark:text-red-100":"bg-transparent hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:"Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯"}),t.jsx("div",{className:"w-[1px] bg-gray-300 dark:bg-gray-700"}),t.jsx("button",{type:"button",onClick:()=>hs("add"),className:`flex-1 py-2 text-sm font-medium transition-colors ${bt==="add"?"bg-green-100 text-green-900 dark:bg-green-900/40 dark:text-green-100":"bg-transparent hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:"Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯"})]}),t.jsx("p",{className:"text-sm text-gray-600 text-right",children:(lt==null?void 0:lt.type)==="decrease"?"Ø§Ø®ØªØ± Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø£Ù… Ø¥Ù„Ù‰ Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø£Ùˆ ØªØ³Ø¬ÙŠÙ„Ù‡ Ø¨Ø¯ÙˆÙ† Ø®ØµÙ….":bt==="add"?"Ø§Ø®ØªØ± Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ† Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø£Ù… Ø¥Ù„Ù‰ Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸.":"Ø§Ø®ØªØ± Ù‡Ù„ ØªØ±ÙŠØ¯ Ø®ØµÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ† Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬ Ø£Ù… Ù…Ù† Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸."}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsx(I,{variant:Nt==="cash"?"default":"outline",className:Nt==="cash"?"bg-blue-600 hover:bg-blue-700 text-white":"",onClick:()=>qr("cash"),children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),t.jsx(I,{variant:Nt==="wallet"?"default":"outline",className:Nt==="wallet"?"bg-purple-600 hover:bg-purple-700 text-white":"",onClick:()=>qr("wallet"),children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),t.jsx(I,{variant:Nt==="none"?"default":"outline",className:Nt==="none"?"bg-gray-600 hover:bg-gray-700 text-white":"",onClick:()=>qr("none"),children:(lt==null?void 0:lt.type)==="decrease"||bt==="add"?"Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ©":"Ø¨Ø¯ÙˆÙ† Ø®ØµÙ…"})]}),Nt==="wallet"&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{className:"text-right block",children:(lt==null?void 0:lt.type)==="decrease"||bt==="add"?"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø¥Ø¶Ø§ÙØ©":"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…"}),t.jsxs(Fa,{value:Ks,onValueChange:gl,children:[t.jsx(Ba,{className:"w-full",children:t.jsx($a,{placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©"})}),t.jsx(Ua,{children:X.map(a=>t.jsx(oa,{value:a.id,children:a.phone||a.name||a.id},a.id))})]})]})]}),t.jsxs(We,{className:"flex justify-between",children:[t.jsx(I,{variant:"outline",onClick:()=>{zs(!1),Vr(null),qr(null),gl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{const a=!!lt,r=a?(lt==null?void 0:lt.type)==="decrease":bt==="add",o=Number(a?lt.delta:(Oa==null?void 0:Oa.amount)||0);if(!Nt){y({title:r?"Ø§Ø®ØªØ± Ù…ÙƒØ§Ù† Ø§Ù„Ø¥Ø¶Ø§ÙØ©":"Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø®ØµÙ…",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}const c=new Date().toISOString();let d=Ve,m=Se,f=!1,g=!1;try{if(Nt==="cash")d=Math.round(r?Ve+o:Ve-o),f=!0;else if(Nt==="wallet"){if(!Ks){y({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:r?"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø¥Ø¶Ø§ÙØ©":"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…",variant:"destructive"});return}const S=Se[Ks]||0,_=Math.round(r?S+o:S-o);m={...Se,[Ks]:_},g=!0}}catch(S){console.error("Error calculating balances:",S);return}let w=[...Ee],N=R,x=!1;if(a){if(!R)return;const S=Number(R.amount||0),_=Number(R.paidAmount||0),O=Number(lt.delta||0);if(lt.type==="decrease"){const A=R.type==="debtor",P=S-O;if(A&&P<0){const U=Math.round(Math.abs(P)),te={...R,amount:U,type:"creditor",paidAmount:0,status:"pending"};if(w=Ee.map(H=>H.id===R.id?te:H),N=te,x=!0,e!=null&&e.uid&&(async()=>{try{const[H,De,Je]=[Ie(ce(F,"userTransactions"),q("userId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending")),Ie(ce(F,"transactions"),q("userId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending")),Ie(ce(F,"transactions"),q("merchantUserId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending"))],[rt,Oe,pe]=await Promise.all([ve(H),ve(De),ve(Je)]),nt=ic(F);let ft=0;const ct=ia=>{ia.docs.forEach(It=>{nt.update(It.ref,{status:"completed",confirmedAt:new Date}),ft++})};ct(rt),ct(Oe),ct(pe),ft>0&&await nt.commit(),e!=null&&e.uid&&[...rt.docs.map(It=>{var Ye;return String(((Ye=It.data())==null?void 0:Ye.transactionId)||"")}),...Oe.docs.map(It=>{var Ye;return String(It.id||((Ye=It.data())==null?void 0:Ye.transactionId)||"")}),...pe.docs.map(It=>{var Ye;return String(It.id||((Ye=It.data())==null?void 0:Ye.transactionId)||"")})].filter(Boolean).forEach(It=>ae.removeLocalReceiptById(e.uid,It))}catch(H){console.error("Batch update failed for linked transactions (Flip):",H)}})().catch(H=>console.error("Transaction update error (Flip):",H)),e!=null&&e.uid&&Nt!=="none")try{await dn(ce(F,"debtReceipts"),{debtId:R.id,debtorName:R.debtorName,amount:O,userId:e.uid,createdAt:gt(),type:"payment"});const De={transactionId:Ae(ce(F,"dummy_collection")).id,amount:O,transactionType:"cash_addition",type:"cash_addition",status:"completed",createdAt:new Date,senderName:R.debtorName,receiverName:"Ø§Ù„Ù…Ø­Ù„",description:`Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ† ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø±ØµÙŠØ¯ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${R.debtorName}`,paymentMethod:Nt,walletId:Nt==="wallet"?Ks:null,linkedDebtId:R.id,isDebtRepayment:!0};await ae.saveUserTransaction(e.uid,De);try{E.invalidateQueries({queryKey:["recentTransactions",e==null?void 0:e.uid]})}catch{}}catch(H){console.error("Failed to create repayment receipt (Flip):",H)}y({title:"ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ†",description:`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (${U} Ø¬Ù†ÙŠÙ‡) Ø¥Ù„Ù‰ "Ù„ÙŠÙ†Ø§"`})}else{const U=Math.round(P),te=_>=U,H={...R,amount:U,status:te?"paid":"pending"};if(w=Ee.map(De=>De.id===R.id?H:De),N=H,x=!0,te&&(e!=null&&e.uid)&&(async()=>{try{const[De,Je,rt]=[Ie(ce(F,"userTransactions"),q("userId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending")),Ie(ce(F,"transactions"),q("userId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending")),Ie(ce(F,"transactions"),q("merchantUserId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending"))],[Oe,pe,nt]=await Promise.all([ve(De),ve(Je),ve(rt)]),ft=ic(F);let ct=0;const ia=It=>{It.docs.forEach(Ye=>{ft.update(Ye.ref,{status:"completed",confirmedAt:new Date}),ct++})};ia(Oe),ia(pe),ia(nt),ct>0&&await ft.commit(),e!=null&&e.uid&&[...Oe.docs.map(Ye=>{var ha;return String(((ha=Ye.data())==null?void 0:ha.transactionId)||"")}),...pe.docs.map(Ye=>{var ha;return String(Ye.id||((ha=Ye.data())==null?void 0:ha.transactionId)||"")}),...nt.docs.map(Ye=>{var ha;return String(Ye.id||((ha=Ye.data())==null?void 0:ha.transactionId)||"")})].filter(Boolean).forEach(Ye=>ae.removeLocalReceiptById(e.uid,Ye))}catch(De){console.error("Batch update failed for linked transactions:",De)}})().catch(De=>{console.error("Transaction update error:",De)}),e!=null&&e.uid&&Nt!=="none")try{await dn(ce(F,"debtReceipts"),{debtId:R.id,debtorName:R.debtorName,amount:O,userId:e.uid,createdAt:gt(),type:"payment"});const Je={transactionId:Ae(ce(F,"dummy_collection")).id,amount:O,transactionType:"cash_addition",type:"cash_addition",status:"completed",createdAt:new Date,senderName:R.debtorName,receiverName:"Ø§Ù„Ù…Ø­Ù„",description:`Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ† Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ ${R.debtorName}`,paymentMethod:Nt,walletId:Nt==="wallet"?Ks:null,linkedDebtId:R.id,isDebtRepayment:!0};await ae.saveUserTransaction(e.uid,Je);try{E.invalidateQueries({queryKey:["recentTransactions",e==null?void 0:e.uid]})}catch{}}catch(De){console.error("Failed to create repayment receipt:",De)}y({title:"ØªÙ… Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„Ù…Ø¨Ù„Øº",description:`Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${U} Ø¬Ù†ÙŠÙ‡`})}}else{const A=S+O,P=_>=A,U={amount:O,note:au||void 0,addedAt:new Date},te={...R,amount:Math.round(A),status:P?"paid":"pending",additionReceipts:[...R.additionReceipts||[],U]};w=Ee.map(H=>H.id===R.id?te:H),N=te,x=!0,y({title:"ØªÙ… Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø¨Ù„Øº",description:`Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${A} Ø¬Ù†ÙŠÙ‡`})}}else if(Oa){w=[{...Oa,userId:e==null?void 0:e.uid,shopId:D||(n==null?void 0:n.shopId)||null},...Ee],x=!0;try{e!=null&&e.uid&&ys.send(e.uid,`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¯ÙŠÙ† Ø¹Ù„Ù‰ ${Oa.debtorName} Ø¨Ù…Ø¨Ù„Øº ${Oa.amount} Ø¬Ù†ÙŠÙ‡`).catch(()=>{})}catch{}}f&&at(d),g&&ut(m),x&&(qt(w),a&&Br(N)),Zo(""),Qd(""),Xd(""),Vs(!1),zs(!1),!a&&x&&ms(!0),Vr(null),su(null),qr(null),gl(""),ai(""),y({title:a?"ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ†":"ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¯ÙŠÙ†",description:Nt==="none"?"Ù„Ù… ÙŠØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø©":Nt==="cash"?r?`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${o} Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ`:`ØªÙ… Ø®ØµÙ… ${o} Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ`:r?`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${o} Ø¥Ù„Ù‰ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©`:`ØªÙ… Ø®ØµÙ… ${o} Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©`});const v={lastUpdated:c};if(f&&(v.cashBalance=d),g&&(v.walletBalances=m),x&&(v.debts=w,v.debtsDeletedAt=null),f&&(localStorage.setItem(Qe(),d.toString()),localStorage.setItem(Qe()+"_lastUpdated",c)),g&&(localStorage.setItem(st(),JSON.stringify(m)),localStorage.setItem(st()+"_lastUpdated",c)),x){localStorage.setItem(Yr(),JSON.stringify(w));try{localStorage.setItem(Dl(),JSON.stringify(w))}catch{}try{localStorage.setItem(kl(),Date.now().toString())}catch{}}const j=`userData_${e==null?void 0:e.uid}`;if(localStorage.setItem(j,JSON.stringify(v)),e!=null&&e.uid){if(x)try{localStorage.setItem(`debts_unsynced_${e.uid}`,"true")}catch{}const S=[];S.push(ae.updateUserData(e.uid,v).then(()=>{(f||g)&&(localStorage.removeItem(j),we(!1))}));const _=D||(n==null?void 0:n.shopId);if(_&&(f||g)){const O={lastUpdated:c};f&&(O.cashBalance=d),g&&(O.walletBalances=m),S.push(sa(Ae(F,"dashboardData",_),O,{merge:!0}).catch(A=>console.error("Failed to sync to dashboardData",A)))}Promise.all(S).then(()=>{if(x)try{localStorage.removeItem(`debts_unsynced_${e.uid}`)}catch{}}).catch(O=>{console.error("Sync error:",O),we(!0)})}},children:(lt==null?void 0:lt.type)==="decrease"?"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø®ØµÙ…"})]})]})}),t.jsx(ue,{open:$f,onOpenChange:Ha,children:t.jsxs(me,{className:"w-[95vw] sm:w-auto sm:max-w-[425px] max-h-[90vh] overflow-y-auto rounded-2xl",hideClose:!0,children:[t.jsx("div",{className:"absolute left-4 top-4 z-50",children:t.jsxs(I,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full opacity-70 hover:opacity-100",onClick:()=>Ha(!1),children:[t.jsx(cn,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Ø¥ØºÙ„Ø§Ù‚"})]})}),t.jsx(ye,{children:t.jsx(he,{className:"text-right",children:"Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙŠÙ†"})}),R&&t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"text-center border-b pb-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Ø¥ÙŠØµØ§Ù„ Ø¯ÙŠÙ†"}),t.jsx("p",{className:"text-sm text-gray-500",children:tn.format(R.createdAt instanceof Date?R.createdAt:new Date(R.createdAt))})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsx("span",{className:"font-medium",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†:"}),t.jsx("span",{children:R.debtorName})]}),t.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:justify-between sm:items-center",children:[t.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº:"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(I,{variant:"outline",className:"h-10 w-10 sm:h-8 sm:w-8 p-0","aria-label":"Ø¯ÙØ¹ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø¯ÙŠÙ†",onClick:()=>{$r(""),si(!0)},children:"âˆ’"}),t.jsxs("span",{className:"font-bold text-xl sm:text-lg",children:[R.amount," Ø¬Ù†ÙŠÙ‡"]}),t.jsx(I,{variant:"outline",className:"h-10 w-10 sm:h-8 sm:w-8 p-0","aria-label":"Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¯ÙŠÙ†",onClick:()=>{Vf("increase"),tu(""),ai(""),Ha(!1),ti(!0)},children:"+"})]})]}),(()=>{try{const a=(ge||[]).filter(r=>String((r==null?void 0:r.linkedDebtId)||"")===String(R.id)).reduce((r,o)=>r+Math.max(0,Number((o==null?void 0:o.commission)||0)),0);return a>0?t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsx("span",{className:"font-medium",children:"Ø§Ù„Ø±Ø¨Ø­:"}),t.jsxs("span",{className:"text-green-700 font-semibold",children:[a," Ø¬Ù†ÙŠÙ‡"]})]}):null}catch{return null}})(),t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsx("span",{className:"font-medium",children:"Ø³Ø¨Ø¨ Ø§Ù„Ø¯ÙŠÙ†:"}),t.jsx("span",{children:R.reason})]}),t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsx("span",{className:"font-medium",children:"Ø§Ù„Ø­Ø§Ù„Ø©:"}),t.jsx(La,{variant:R.status==="paid"?"default":"secondary",className:`${R.status==="paid"?"bg-green-500":"bg-yellow-500"} w-fit text-[12px] sm:text-xs`,children:R.status==="paid"?"Ù…Ø¯ÙÙˆØ¹":"Ù…Ø¤Ø¬Ù„"})]}),(()=>{const a=Number(R.amount||0),r=Number(R.paidAmount||0),o=Math.max(0,a-r);return t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:"}),t.jsxs("span",{className:"font-bold text-xl sm:text-lg",children:[o," Ø¬Ù†ÙŠÙ‡"]})]})})(),R.paidAmount?t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsx("span",{className:"font-medium",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹:"}),t.jsxs("span",{className:"text-green-700",children:[R.paidAmount," Ø¬Ù†ÙŠÙ‡"]})]}):null,R.partialPayments&&R.partialPayments.length>0&&t.jsxs("div",{className:"mt-3 text-[12px] sm:text-xs text-gray-600",children:[t.jsx("p",{className:"font-medium mb-1",children:"Ø³Ø¬Ù„ Ø§Ù„Ø¯ÙØ¹Ø§Øª Ø§Ù„Ø¬Ø²Ø¦ÙŠØ©:"}),t.jsx("div",{className:"space-y-1 max-h-[30vh] sm:max-h-24 overflow-y-auto",children:R.partialPayments.map((a,r)=>t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsxs("span",{children:["Ø¯ÙØ¹: ",a.amount," Ø¬Ù†ÙŠÙ‡"]}),t.jsx("span",{children:new Date(a.paidAt).toLocaleString("ar-EG")})]},r))})]}),R.additionReceipts&&R.additionReceipts.length>0&&t.jsxs("div",{className:"mt-3 text-[12px] sm:text-xs text-gray-600",children:[t.jsx("p",{className:"font-medium mb-1",children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬Ø²Ø¦ÙŠØ©:"}),t.jsx("div",{className:"space-y-1 max-h-[20vh] sm:max-h-32 overflow-y-auto",children:R.additionReceipts.map((a,r)=>t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsxs("span",{children:["Ø¥Ø¶Ø§ÙØ©: ",a.amount," Ø¬Ù†ÙŠÙ‡"]}),t.jsx("span",{children:new Date(a.addedAt).toLocaleString("ar-EG")}),a.note&&t.jsxs("span",{className:"sm:col-span-2 text-right text-[11px] text-gray-500",children:["Ù…Ù„Ø§Ø­Ø¸Ø©: ",a.note]})]},r))})]})]})]}),t.jsxs(We,{className:"flex gap-2 justify-center",children:[t.jsx(I,{onClick:async()=>{if(R){const a=Ee.map(r=>r.id===R.id?{...r,status:"pending"}:r);qt(a),await Ea(a);try{if(e!=null&&e.uid){const r=computedRemaining;await ys.send(e.uid,`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${R.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${r} Ø¬Ù†ÙŠÙ‡`)}}catch{}Ha(!1),y({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙŠÙ†",description:"ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¯ÙŠÙ† ÙƒÙ…Ø¤Ø¬Ù„"})}},variant:"outline",className:"bg-yellow-500 hover:bg-yellow-600 text-white",children:"Ù…Ø¤Ø¬Ù„"}),t.jsx(I,{onClick:async()=>{if(R){const a=Number(R.amount||0),r=Number(R.paidAmount||0);let o=Math.max(0,a-r);try{const m=(ge||[]).filter(x=>String((x==null?void 0:x.linkedDebtId)||"")===String(R.id)),f=m.reduce((x,v)=>x+Math.max(0,Number((v==null?void 0:v.commission)||0)),0),g=m.reduce((x,v)=>x+Math.max(0,Number(((v==null?void 0:v.sentAmount)??(v==null?void 0:v.transferredAmount)??(v==null?void 0:v.withdrawnAmount)??(v==null?void 0:v.amount))||0)),0),N=a<g+f?a+f:a;o=Math.max(0,Number(N)-r)}catch{}const c=o,d=Ee.map(m=>{if(m.id!==R.id)return m;const f=Number(m.amount||0),g=Number(m.paidAmount||0),w=Math.round(g+c),N=w>=f;return{...m,amount:f,paidAmount:N?f:w,status:"paid",partialPayments:[...m.partialPayments||[],...c>0?[{amount:c,paidAt:new Date}]:[]]}});qt(d);try{Br(d.find(m=>m.id===R.id)||null)}catch{}ci(c),Ga("none"),hs(R.type==="debtor"?"deduct":"add"),Js(!0),await Ea(d);try{const m=d.find(f=>f.id===R.id);if(e!=null&&e.uid&&(m!=null&&m.id)){const f=Ae(F,"debts",m.id),g={...m,userId:e.uid,shopId:D||(n==null?void 0:n.shopId)||null,lastUpdated:new Date().toISOString()};Object.keys(g).forEach(w=>g[w]===void 0&&delete g[w]),await sa(f,g,{merge:!0})}}catch(m){console.error("Failed to sync debt payment to collection:",m)}try{e!=null&&e.uid&&(R!=null&&R.id)&&(async()=>{const m=Ie(ce(F,"userTransactions"),q("userId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending")),f=await ve(m);await Promise.allSettled(f.docs.map(v=>Zt(v.ref,{status:"completed",confirmedAt:new Date})));try{const v=f.docs.map(j=>{var S;return String(((S=j.data())==null?void 0:S.transactionId)||"")});e!=null&&e.uid&&v.forEach(j=>j&&ae.removeLocalReceiptById(e.uid,j))}catch{}const g=Ie(ce(F,"transactions"),q("userId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending")),w=await ve(g);await Promise.allSettled(w.docs.map(v=>Zt(v.ref,{status:"completed",confirmedAt:new Date})));try{const v=w.docs.map(j=>{var S;return String(j.id||((S=j.data())==null?void 0:S.transactionId)||"")});e!=null&&e.uid&&v.forEach(j=>j&&ae.removeLocalReceiptById(e.uid,j))}catch{}const N=Ie(ce(F,"transactions"),q("merchantUserId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending")),x=await ve(N);await Promise.allSettled(x.docs.map(v=>Zt(v.ref,{status:"completed",confirmedAt:new Date})));try{const v=x.docs.map(j=>{var S;return String(j.id||((S=j.data())==null?void 0:S.transactionId)||"")});e!=null&&e.uid&&v.forEach(j=>j&&ae.removeLocalReceiptById(e.uid,j))}catch{}})().catch(m=>{console.error("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†:",m),y({title:"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©",description:"ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†",variant:"destructive"})})}catch(m){console.error("ØªØ¹Ø°Ø± ØªØ¬Ù‡ÙŠØ² ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©:",m)}try{const m=Al(),f=localStorage.getItem(m);if(f){const w=(JSON.parse(f)||[]).map(N=>(N==null?void 0:N.linkedDebtId)===R.id&&(N==null?void 0:N.status)==="pending"?{...N,status:"completed",confirmedAt:new Date}:N);localStorage.setItem(m,JSON.stringify(w)),Vt(N=>N.map(x=>(x==null?void 0:x.linkedDebtId)===R.id&&(x==null?void 0:x.status)==="pending"?{...x,status:"completed",confirmedAt:new Date}:x))}}catch(m){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ†:",m)}Ha(!1),y({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙŠÙ†",description:"ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¯ÙŠÙ† ÙƒÙ…Ø¯ÙÙˆØ¹"})}},className:"bg-green-500 hover:bg-green-600",children:"Ù…Ø¯ÙÙˆØ¹"}),t.jsx(I,{onClick:async()=>{if(R){const a=Ee.filter(r=>r.id!==R.id);qt(a),await Ea(a),Ha(!1),y({title:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¯ÙŠÙ†",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¯ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­"})}},variant:"destructive",children:"Ø­Ø°Ù"})]})]})}),t.jsx(ue,{open:qf,onOpenChange:a=>{si(a),a||$r("")},children:t.jsxs(me,{className:"w-[95vw] sm:max-w-[425px] rounded-2xl",children:[t.jsxs(ye,{children:[t.jsx(he,{className:"text-right",children:"Ø¯ÙØ¹ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø¯ÙŠÙ†"}),t.jsx(et,{className:"text-right",children:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø¯ÙØ¹Ù‡ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙŠÙ† Ø«Ù… Ø§Ø¶ØºØ· Ø¯ÙØ¹."})]}),R&&t.jsxs("div",{className:"grid gap-4 py-2",children:[t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsx("span",{className:"font-medium",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†:"}),t.jsx("span",{children:R.debtorName})]}),t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙƒÙ„ÙŠ:"}),t.jsxs("span",{children:[R.amount," Ø¬Ù†ÙŠÙ‡"]})]}),t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsx("span",{className:"font-medium",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹:"}),t.jsxs("span",{className:"text-green-700",children:[Number(R.paidAmount||0)," Ø¬Ù†ÙŠÙ‡"]})]}),t.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[t.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:"}),t.jsxs("span",{className:"font-semibold",children:[Math.max(0,Number(R.amount||0)-Number(R.paidAmount||0))," ","Ø¬Ù†ÙŠÙ‡"]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(G,{htmlFor:"partialAmountDialog",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¯ÙØ¹Ù‡"}),t.jsx(Z,{id:"partialAmountDialog",type:"number",value:nu,onChange:a=>$r(a.target.value),className:"text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº"})]})]}),t.jsxs(We,{className:"flex gap-2 justify-between",children:[t.jsx(I,{variant:"outline",onClick:()=>{si(!1),$r("")},children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{className:"bg-blue-600 hover:bg-blue-700",onClick:async()=>{const a=parseFloat(nu);if(!R||isNaN(a)||a<=0){y({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const r=Math.max(0,Number(R.amount||0)-Number(R.paidAmount||0)),o=a>r;let c;if(o){const m=Math.round(a-r),g=(R.type||"creditor")==="debtor"?"creditor":"debtor";c={...R,type:g,amount:m,paidAmount:0,status:"pending",partialPayments:[]},y({title:"ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ†",description:`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (${m} Ø¬Ù†ÙŠÙ‡) Ø¥Ù„Ù‰ ${g==="debtor"?'"Ø¹Ù„ÙŠÙ†Ø§"':'"Ù„ÙŠÙ†Ø§"'}`})}else{const m=Math.round((R.paidAmount||0)+a),g=Number(R.amount||0)-m<.01;c={...R,amount:Number(R.amount||0),paidAmount:m,status:g?"paid":"pending",partialPayments:[...R.partialPayments||[],{amount:a,paidAt:new Date}]}}const d=Ee.map(m=>m.id===R.id?c:m);qt(d),Br(c),await Ea(d);try{if(e!=null&&e.uid){const m=Math.max(0,Number(c.amount||0)-Number(c.paidAmount||0)),f=o?`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${c.debtorName} ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (${c.amount} Ø¬Ù†ÙŠÙ‡) Ø¥Ù„Ù‰ ${c.type==="debtor"?'"Ø¹Ù„ÙŠÙ†Ø§"':'"Ù„ÙŠÙ†Ø§"'}`:`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø¬Ø²Ø¡ Ù…Ù† Ø¯ÙŠÙ† ${c.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${a} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ${m} Ø¬Ù†ÙŠÙ‡`;await ys.send(e.uid,f)}}catch{}try{(c.status==="paid"||o)&&(e!=null&&e.uid)&&(async()=>{const m=Ie(ce(F,"userTransactions"),q("userId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending")),f=await ve(m);await Promise.allSettled(f.docs.map(v=>Zt(v.ref,{status:"completed",confirmedAt:new Date})));try{const v=f.docs.map(j=>{var S;return String(((S=j.data())==null?void 0:S.transactionId)||"")});e!=null&&e.uid&&v.forEach(j=>j&&ae.removeLocalReceiptById(e.uid,j))}catch{}const g=Ie(ce(F,"transactions"),q("userId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending")),w=await ve(g);await Promise.allSettled(w.docs.map(v=>Zt(v.ref,{status:"completed",confirmedAt:new Date})));try{const v=w.docs.map(j=>{var S;return String(j.id||((S=j.data())==null?void 0:S.transactionId)||"")});e!=null&&e.uid&&v.forEach(j=>j&&ae.removeLocalReceiptById(e.uid,j))}catch{}const N=Ie(ce(F,"transactions"),q("merchantUserId","==",e.uid),q("linkedDebtId","==",R.id),q("status","==","pending")),x=await ve(N);await Promise.allSettled(x.docs.map(v=>Zt(v.ref,{status:"completed",confirmedAt:new Date})));try{const v=x.docs.map(j=>{var S;return String(j.id||((S=j.data())==null?void 0:S.transactionId)||"")});e!=null&&e.uid&&v.forEach(j=>j&&ae.removeLocalReceiptById(e.uid,j))}catch{}})().catch(m=>{console.error("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†:",m),y({title:"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©",description:"ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†",variant:"destructive"})})}catch(m){console.error("ØªØ¹Ø°Ø± ØªØ¬Ù‡ÙŠØ² ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©:",m)}if(c.status==="paid")try{const m=Al(),f=localStorage.getItem(m);if(f){const w=(JSON.parse(f)||[]).map(N=>(N==null?void 0:N.linkedDebtId)===R.id&&(N==null?void 0:N.status)==="pending"?{...N,status:"completed",confirmedAt:new Date}:N);localStorage.setItem(m,JSON.stringify(w)),Vt(N=>N.map(x=>(x==null?void 0:x.linkedDebtId)===R.id&&(x==null?void 0:x.status)==="pending"?{...x,status:"completed",confirmedAt:new Date}:x))}}catch(m){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ†:",m)}ci(a),Ga("none"),hs(c.type==="debtor"?"deduct":"add"),Js(!0),si(!1),$r(""),y({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹ Ø¬Ø²Ø¡",description:`ØªÙ… Ø¯ÙØ¹ ${a} Ø¬Ù†ÙŠÙ‡ Ø¨ØªØ§Ø±ÙŠØ® ${new Date().toLocaleString("ar-EG")}`})},children:"Ø¯ÙØ¹"})]})]})}),t.jsx(ue,{open:Uf,onOpenChange:ti,children:t.jsxs(me,{className:"sm:max-w-md rounded-2xl shadow-elegant border border-gray-200",children:[t.jsxs(ye,{children:[t.jsx(he,{className:`text-right ${ja==="decrease"?"text-red-600":"text-green-600"}`,children:ja==="increase"?"ÙƒØªØ§Ø¨Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¶Ø§ÙØ©":ja==="decrease"?"Ø¥Ù†Ù‚Ø§Øµ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†":"ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†"}),t.jsx(et,{className:"text-right",children:ja==="increase"?"Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¶Ø§ÙØ© ÙˆÙ…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø§Ø¶Ø§ÙØ© Ø«Ù… Ø§Ø¶ØºØ· ØªØ£ÙƒÙŠØ¯.":ja==="decrease"?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø«Ù… Ø§Ø¶ØºØ· ØªØ£ÙƒÙŠØ¯ Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¥Ù†Ù‚Ø§Øµ.":"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø«Ù… Ø§Ø¶ØºØ· ØªØ£ÙƒÙŠØ¯ Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„."})]}),t.jsxs("div",{className:"grid gap-4 py-2",children:[t.jsx(G,{htmlFor:"debtAdjustAmount",className:"text-right",children:ja==="increase"?"Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¶Ø§ÙØ© (Ø¬Ù†ÙŠÙ‡)":"Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬Ù†ÙŠÙ‡)"}),t.jsx(Z,{id:"debtAdjustAmount",type:"number",placeholder:"0.00",value:eu,onChange:a=>tu(a.target.value)}),ja==="increase"&&t.jsxs(t.Fragment,{children:[t.jsx(G,{htmlFor:"debtAdditionNote",className:"text-right",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),t.jsx(Z,{id:"debtAdditionNote",placeholder:"Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù† Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø¶Ø§ÙØ©",value:au,onChange:a=>ai(a.target.value)})]}),R&&t.jsxs("div",{className:"text-right text-sm text-muted-foreground",children:["Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø­Ø§Ù„ÙŠ: ",t.jsx("span",{className:"font-semibold",children:Number(R.amount||0).toLocaleString("en-US",{maximumFractionDigits:0})})," Ø¬Ù†ÙŠÙ‡"]})]}),t.jsxs(We,{className:"flex gap-2",children:[t.jsx(I,{variant:"secondary",onClick:()=>{ti(!1),Ha(!0),ai("")},children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{className:ja==="decrease"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700",onClick:async()=>{try{if(!R||!ja)return;const a=Math.round(parseFloat(eu||"0"));if(!a||isNaN(a)||a<=0){y({title:"Ù‚ÙŠÙ…Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±",variant:"destructive"});return}Vr(null),su({debtId:R.id,delta:a,type:ja}),ti(!1),zs(!0)}catch(a){console.error("ÙØ´Ù„ ØªØ¬Ù‡ÙŠØ² ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†:",a),y({title:"Ø®Ø·Ø£",description:"ØªØ¹Ø°Ù‘Ø± ØªØ¬Ù‡ÙŠØ² ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†",variant:"destructive"})}},children:"ØªØ£ÙƒÙŠØ¯"})]})]})}),t.jsx(ue,{open:tg,onOpenChange:Js,children:t.jsxs(me,{className:"sm:max-w-[480px]",children:[t.jsxs(ye,{children:[t.jsx(he,{className:"text-right",children:"Ø§Ø®ØªÙŠØ§Ø± ØªØ£Ø«ÙŠØ± Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯"}),t.jsx(et,{className:"text-right",children:"Ø­Ø¯Ø¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ø±ØµÙŠØ¯ (ÙˆØ§Ø±Ø¯) Ø£Ù… Ø®ØµÙ…Ù‡ Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ (ØµØ§Ø¯Ø±)."})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex w-full rounded-lg border border-gray-300 dark:border-gray-700 overflow-hidden mb-4",children:[t.jsx("button",{type:"button",onClick:()=>hs("deduct"),className:`flex-1 py-2 text-sm font-medium transition-colors ${bt==="deduct"?"bg-red-100 text-red-900 dark:bg-red-900/40 dark:text-red-100":"bg-transparent hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:"Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯"}),t.jsx("div",{className:"w-[1px] bg-gray-300 dark:bg-gray-700"}),t.jsx("button",{type:"button",onClick:()=>hs("add"),className:`flex-1 py-2 text-sm font-medium transition-colors ${bt==="add"?"bg-green-100 text-green-900 dark:bg-green-900/40 dark:text-green-100":"bg-transparent hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:"Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯"})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[t.jsx(I,{variant:Lt==="cash"?"default":"outline",className:Lt==="cash"?"bg-blue-600 text-white":"",size:"sm",onClick:()=>Ga("cash"),children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),t.jsx(I,{variant:Lt==="wallet"?"default":"outline",className:Lt==="wallet"?"bg-blue-600 text-white":"",size:"sm",onClick:()=>Ga("wallet"),children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),t.jsx(I,{variant:Lt==="fawry"?"default":"outline",className:Lt==="fawry"?"bg-amber-600 text-white":"",size:"sm",onClick:()=>Ga("fawry"),children:"ÙÙˆØ±ÙŠ"}),t.jsx(I,{variant:Lt==="none"?"default":"outline",className:Lt==="none"?"bg-gray-600 text-white":"",size:"sm",onClick:()=>Ga("none"),children:"Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ©"})]}),Lt==="wallet"&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-right",children:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø¥Ø¶Ø§ÙØ©"}),t.jsxs("select",{className:"w-full border rounded p-2 text-right",value:Xa,onChange:a=>pl(a.target.value),children:[t.jsx("option",{value:"",children:"â€” Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© â€”"}),X&&X.length>0?X.map(a=>t.jsx("option",{value:a.id,children:a.phone||a.name||a.id},a.id)):Object.keys(Se||{}).map(a=>{var r,o,c,d;return t.jsx("option",{value:a,children:((r=X.find(m=>m.id===a))==null?void 0:r.phone)||((o=Gs==null?void 0:Gs.find(m=>m.id===a))==null?void 0:o.phone)||((c=Gs==null?void 0:Gs.find(m=>m.id===a))==null?void 0:c.name)||((d=X.find(m=>m.id===a))==null?void 0:d.name)||a},a)})]})]}),t.jsxs("div",{className:"text-right text-sm text-gray-600",children:["Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡: ",t.jsxs("span",{className:"font-bold",children:[gu," Ø¬Ù†ÙŠÙ‡"]})]})]}),t.jsxs(We,{className:"flex flex-wrap justify-between gap-2",children:[t.jsx(I,{variant:"outline",onClick:()=>{Js(!1),ci(0),Ga(null),pl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),t.jsx(I,{disabled:Yc,onClick:async()=>{var r,o;if(Yc)return;const a=gu;if(!a||a<=0){Js(!1);return}if(!Lt){y({title:"Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø¥Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}if(Lt==="wallet"&&!Xa){y({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¥Ù„ÙŠÙ‡Ø§",variant:"destructive"});return}zc(!0),Js(!1);try{const c=async(d,m)=>{if(e!=null&&e.uid&&R)try{const g={transactionId:Ae(ce(F,"dummy_collection")).id,amount:a,transactionType:bt==="deduct"?"withdraw":"cash_addition",type:bt==="deduct"?"withdraw":"cash_addition",status:"completed",createdAt:new Date,senderName:R.debtorName,receiverName:"Ø§Ù„Ù…Ø­Ù„",description:`Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ† ${R.type==="debtor"?"Ù„Ù„Ø¹Ù…ÙŠÙ„":"Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„"} ${R.debtorName} (${bt==="deduct"?"Ø®ØµÙ…":"Ø¥Ø¶Ø§ÙØ©"})`,paymentMethod:d,walletId:m||null,linkedDebtId:R.id,isDebtRepayment:!0};await ae.saveUserTransaction(e.uid,g);try{E.invalidateQueries({queryKey:["recentTransactions",e==null?void 0:e.uid]})}catch{}}catch(f){console.error("Failed to create repayment receipt:",f)}};if(Lt==="cash"){const d=bt==="deduct"?Ve-a:Ve+a;at(d),localStorage.setItem(Qe(),d.toString());const m={cashBalance:d,lastUpdated:new Date().toISOString()},f=`userData_${e==null?void 0:e.uid}`;localStorage.setItem(f,JSON.stringify(m)),e!=null&&e.uid?(ae.updateUserData(e.uid,m).catch(()=>we(!0)),localStorage.removeItem(f),we(!1)):we(!0),y({title:bt==="deduct"?"ØªÙ… Ø®ØµÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯":"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯",description:`ØªÙ… ${bt==="deduct"?"Ø®ØµÙ…":"Ø¥Ø¶Ø§ÙØ©"} ${a} Ø¬Ù†ÙŠÙ‡ ${bt==="deduct"?"Ù…Ù†":"Ø¥Ù„Ù‰"} Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©`}),await c("cash")}else if(Lt==="wallet"){const d=Se[Xa]||0,m={...Se,[Xa]:d+(bt==="deduct"?-a:a)};ut(m);const f=new Date().toISOString(),g={walletBalances:m,lastUpdated:f},w=`userData_${e==null?void 0:e.uid}`;if(localStorage.setItem(w,JSON.stringify(g)),localStorage.setItem(st(),JSON.stringify(m)),localStorage.setItem(`walletBalances_backup_${f}`,JSON.stringify(m)),e!=null&&e.uid){ae.updateUserData(e.uid,g).catch(()=>we(!0));try{localStorage.removeItem(w)}catch{}we(!1)}else we(!0);const N=((r=X.find(x=>x.id===Xa))==null?void 0:r.phone)||((o=X.find(x=>x.id===Xa))==null?void 0:o.name)||Xa;y({title:bt==="deduct"?"ØªÙ… Ø®ØµÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯":"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯",description:`ØªÙ… ${bt==="deduct"?"Ø®ØµÙ…":"Ø¥Ø¶Ø§ÙØ©"} ${a} Ø¬Ù†ÙŠÙ‡ ${bt==="deduct"?"Ù…Ù†":"Ø¥Ù„Ù‰"} Ø§Ù„Ù…Ø­ÙØ¸Ø© ${N}`}),await c("wallet",Xa)}else Lt==="none"?y({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø³Ø¯Ø§Ø¯",description:`ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${a} Ø¬Ù†ÙŠÙ‡ Ø¨Ø¯ÙˆÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø©`}):Lt==="fawry"&&(y({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø³Ø¯Ø§Ø¯ Ø¹Ø¨Ø± ÙÙˆØ±ÙŠ",description:`ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${a} Ø¬Ù†ÙŠÙ‡ ÙƒØ³Ø¯Ø§Ø¯ Ø¹Ø¨Ø± ÙÙˆØ±ÙŠ Ø¨Ø¯ÙˆÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø©`}),await c("fawry"));try{if(e!=null&&e.uid&&R){const d=Number(R.amount||0),m=Number(R.paidAmount||0),f=R.status==="paid"||m>=d,g=a>0?a:m||d,w=f?`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${R.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${m||g} Ø¬Ù†ÙŠÙ‡`:`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø³Ø¯Ø§Ø¯ ${g} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø¯ÙŠÙ† Ø§Ù„Ø¹Ù…ÙŠÙ„ ${R.debtorName}`;await ys.send(e.uid,w)}}catch{}}catch(c){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯:",c),y({title:"Ø­Ø¯Ø« Ø®Ø·Ø£",description:"ØªØ¹Ø°Ø± Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",variant:"destructive"})}finally{zc(!1),ci(0),Ga(null),pl("");try{ms(!0)}catch{}}},className:"bg-green-600 hover:bg-green-700",children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©"})]})]})}),t.jsx(ue,{open:ff,onOpenChange:da,children:t.jsxs(me,{hideClose:!0,className:"post-confirm-card sm:max-w-[420px] w-[90vw] rounded-2xl bg-gradient-to-br from-white via-indigo-50 to-blue-50 shadow-2xl border border-indigo-100",children:[t.jsxs(ye,{children:[t.jsx(he,{className:"text-right text-2xl font-bold",children:(Xe==null?void 0:Xe.type)==="transfer"?"Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø§Ø³ØªÙ„Ø§Ù…Ù‡":"Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ ØªØ³Ù„ÙŠÙ…Ù‡"}),t.jsx(et,{className:"text-right text-gray-600",children:(Xe==null?void 0:Xe.type)==="transfer"?"Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø§Ø³ØªÙ„Ø§Ù…Ù‡ Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯.":"Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙˆØ§Ø¬Ø¨ ØªØ³Ù„ÙŠÙ…Ù‡ Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯."})]}),t.jsxs("div",{className:"py-3 flex flex-col items-center gap-1.5",children:[t.jsxs("div",{className:"text-xl sm:text-2xl font-bold text-blue-700 tracking-wide",children:[ws((Xe==null?void 0:Xe.amount)||0)," Ø¬Ù†ÙŠÙ‡"]}),t.jsx("div",{className:"text-sm text-gray-500 text-right w-full",children:(Xe==null?void 0:Xe.type)==="transfer"?"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶ Ø´Ø§Ù…Ù„ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„.":Xe!=null&&Xe.isDeduct||!Ge?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ù…Ø®ØµÙˆÙ…Ø© Ù…Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³Ù„Ù‘Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„.":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ù…Ø¶Ø§ÙØ© ÙˆÙ„Ø§ ØªØ¤Ø«Ø± Ø¹Ù„Ù‰ Ù‚ÙŠÙ…Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ…."})]}),t.jsxs(We,{className:"flex justify-end gap-2",children:[(Xe==null?void 0:Xe.type)==="transfer"&&t.jsx(I,{variant:"default",id:"sendCodeBtn",onClick:y0,disabled:Ed,className:"btn-transfer-confirm bg-blue-600 hover:bg-blue-700 text-white border-0",children:Ed?"Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...":"Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),t.jsx(I,{onClick:()=>{da(!1),zo(null),Cr(null)},className:"bg-green-600 hover:bg-green-700 text-white",children:(Xe==null?void 0:Xe.type)==="transfer"?"ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…":"ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…"})]}),(Xe==null?void 0:Xe.type)==="transfer"&&t.jsx("div",{className:"mt-4 border-t pt-4 w-full",children:t.jsxs("div",{className:"flex justify-center gap-4",children:[t.jsx(I,{variant:Ut===0?"default":"outline",size:"sm",onClick:()=>fo(0),className:`flex-1 h-10 ${Ut===0?"bg-blue-600 hover:bg-blue-700 text-white":"border-blue-200 text-blue-700 hover:bg-blue-50"}`,children:"SIM 1"}),t.jsx(I,{variant:Ut===1?"default":"outline",size:"sm",onClick:()=>fo(1),className:`flex-1 h-10 ${Ut===1?"bg-blue-600 hover:bg-blue-700 text-white":"border-blue-200 text-blue-700 hover:bg-blue-50"}`,children:"SIM 2"})]})})]})}),t.jsx(Kp,{open:pf,onClose:()=>Ma(!1),onSubmit:b0,deviceId:Ko||os||"",recipientName:yf,recipientMsisdn:String(B==="transfer"?(ht==null?void 0:ht.receiver)||kt||"":((nm=X.find(a=>a.id===L))==null?void 0:nm.phone)||"").replace(/\D/g,"")}),t.jsx(ue,{open:xf,onOpenChange:()=>{},children:t.jsxs(me,{className:"w-fit p-8 flex flex-col items-center justify-center gap-6",hideClose:!0,children:[t.jsx(he,{className:"sr-only",children:"Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø§Ø³Ù…"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 bg-blue-100 rounded-full animate-ping opacity-75"}),t.jsx("div",{className:"relative bg-white p-4 rounded-full shadow-md border border-blue-100",children:t.jsx(rs,{className:"h-10 w-10 animate-spin text-blue-600"})})]}),t.jsxs("div",{className:"text-center space-y-2",children:[t.jsx("p",{className:"text-lg font-bold text-gray-800",children:"Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§..."}),t.jsx("p",{className:"text-sm text-gray-500",children:"ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ Ø¸Ù‡ÙˆØ± Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"})]})]})}),t.jsx(Bw,{isOpen:bf,onClose:()=>Wd(!1),senderPhone:((im=X.find(a=>a.id===L))==null?void 0:im.phone)||"",receiverPhone:(ht==null?void 0:ht.receiver)||"",amount:Number((ht==null?void 0:ht.amount)||0),deviceId:Ko||os||"",api:window.electronAPI}),t.jsx(ue,{open:So==="success",onOpenChange:()=>Ta(null),children:t.jsx(me,{className:"sm:max-w-[425px]",children:t.jsxs("div",{className:"flex flex-col items-center justify-center p-4 gap-4",children:[t.jsx(zi,{className:"h-16 w-16 text-green-500"}),t.jsx(he,{className:"text-xl text-green-700",children:"ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­"}),t.jsx(I,{onClick:()=>Ta(null),className:"bg-green-600 hover:bg-green-700 w-full",children:"ØªÙ…"})]})})}),t.jsx(ue,{open:So==="limit_exceeded",onOpenChange:()=>Ta(null),children:t.jsx(me,{className:"sm:max-w-[425px]",children:t.jsxs("div",{className:"flex flex-col items-center justify-center p-4 gap-4",children:[t.jsx(fx,{className:"h-16 w-16 text-red-500"}),t.jsx(he,{className:"text-xl text-red-700",children:"ÙØ´Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),t.jsx("p",{className:"text-center text-gray-600",children:"ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø§Ù‚ØµÙŠ"}),t.jsx(I,{onClick:()=>Ta(null),variant:"destructive",className:"w-full",children:"Ø¥ØºÙ„Ø§Ù‚"})]})})}),t.jsx(ue,{open:So==="no_wallet",onOpenChange:()=>Ta(null),children:t.jsx(me,{className:"sm:max-w-[425px]",children:t.jsxs("div",{className:"flex flex-col items-center justify-center p-4 gap-4",children:[t.jsx(Kl,{className:"h-16 w-16 text-yellow-500"}),t.jsx(he,{className:"text-xl text-yellow-700",children:"ØªÙ†Ø¨ÙŠÙ‡"}),t.jsxs("p",{className:"text-center text-gray-600",children:["Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ÙØ¸Ù‡ Ù…Ø³Ø¬Ù„Ù‡ Ø¹Ù„ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…",t.jsx("br",{}),"ØªØ§ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ù‡ Ø§Ø®Ø±ÙŠ"]}),t.jsx(I,{onClick:()=>Ta(null),className:"bg-yellow-600 hover:bg-yellow-700 w-full",children:"Ø­Ø³Ù†Ø§Ù‹"})]})})}),t.jsx(ue,{open:I0,onOpenChange:()=>{},children:t.jsxs(me,{className:"w-fit p-8 flex flex-col items-center justify-center gap-6",hideClose:!0,children:[t.jsx(he,{className:"sr-only",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚"}),t.jsx(rs,{className:"h-10 w-10 animate-spin text-blue-600"}),t.jsx("p",{className:"text-lg font-bold text-gray-800",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ©..."})]})}),t.jsx(iN,{isOpen:X0,onClose:()=>Bo(!1),wallets:X,walletBalances:Se,userId:e==null?void 0:e.uid,onSelectWallet:a=>{yr(a);const r=X.find(o=>o.id===a);if(r){Rs(r.phone);try{localStorage.setItem(fs(),a)}catch{}}Bo(!1)},selectedWalletId:L||void 0}),t.jsx(uN,{open:Qh,onOpenChange:Gh}),t.jsx($w,{open:Zh,onOpenChange:pr}),!1,ee&&t.jsx("div",{className:"fixed inset-0 z-[100] bg-white dark:bg-slate-950 overflow-y-auto",children:t.jsx(Jp,{onBack:()=>Q(!1),eyeComfortMode:qs,setEyeComfortMode:ru})}),t.jsx(ue,{open:Lo,onOpenChange:Wo,children:t.jsxs(me,{className:"sm:max-w-md",dir:"rtl",children:[t.jsxs(ye,{children:[t.jsx(he,{children:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ"}),t.jsx(et,{children:"Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø«Ù… Ø­Ø¯Ù‘Ø¯ Ø§Ù„Ø´Ù‡Ø± Ø£Ùˆ Ø§Ù„ÙŠÙˆÙ…"})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs(Qp,{value:Bn,onValueChange:a=>q0(a),children:[t.jsxs(Gp,{className:"grid grid-cols-2 w-full",children:[t.jsx(jm,{value:"monthly",children:"ØªÙ‚Ø§Ø±ÙŠØ± Ø´Ù‡Ø±"}),t.jsx(jm,{value:"daily",children:"ØªÙ‚Ø§Ø±ÙŠØ± ÙŠÙˆÙ…"})]}),t.jsx(Sm,{value:"monthly",className:"mt-3",children:t.jsxs("div",{className:"flex flex-col space-y-2",children:[t.jsx(G,{className:"text-right",children:"Ø§Ù„Ø´Ù‡Ø±"}),t.jsxs(_m,{children:[t.jsx(Am,{asChild:!0,children:t.jsxs(I,{variant:"outline",className:Ca("w-full justify-start text-left font-normal",!Ja&&"text-muted-foreground"),children:[t.jsx(Ui,{className:"mr-2 h-4 w-4"}),Ja?pa(new Date(`${Ja}-01`),"LLLL yyyy",{locale:Rm}):t.jsx("span",{children:"Ø§Ø®ØªØ± Ø´Ù‡Ø±"})]})}),t.jsx(oc,{className:"w-auto p-0",align:"start",children:t.jsx(dc,{mode:"single",selected:Ja?new Date(`${Ja}-01`):void 0,onSelect:a=>Y0(a?pa(a,"yyyy-MM"):""),initialFocus:!0})})]})]})}),t.jsx(Sm,{value:"daily",className:"mt-3",children:t.jsxs("div",{className:"flex flex-col space-y-2",children:[t.jsx(G,{className:"text-right",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),t.jsxs(_m,{children:[t.jsx(Am,{asChild:!0,children:t.jsxs(I,{variant:"outline",className:Ca("w-full justify-start text-left font-normal",!Ka&&"text-muted-foreground"),children:[t.jsx(Ui,{className:"mr-2 h-4 w-4"}),Ka?pa(new Date(Ka),"PPP",{locale:Rm}):t.jsx("span",{children:"Ø§Ø®ØªØ± ØªØ§Ø±ÙŠØ®"})]})}),t.jsx(oc,{className:"w-auto p-0",align:"start",children:t.jsx(dc,{mode:"single",selected:Ka?new Date(Ka):void 0,onSelect:a=>V0(a?pa(a,"yyyy-MM-dd"):""),initialFocus:!0})})]})]})})]}),Bs&&t.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 p-3 rounded-lg border border-blue-100 dark:border-blue-900/30",children:[t.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 mb-1",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),t.jsx("div",{className:"text-lg font-bold text-blue-800 dark:text-blue-200",children:Bs.count})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-3 rounded-lg border border-gray-100 dark:border-gray-700",children:[t.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº"}),t.jsx("div",{className:"text-lg font-bold text-gray-800 dark:text-gray-200",children:Bs.totalAmount.toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"bg-red-50 dark:bg-red-950/20 p-3 rounded-lg border border-red-100 dark:border-red-900/30",children:[t.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 mb-1",children:"Ø§Ù„Ù…Ø³Ø­ÙˆØ¨"}),t.jsx("div",{className:"text-lg font-bold text-red-800 dark:text-red-200",children:Bs.totalWithdrawn.toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsxs("div",{className:"bg-green-50 dark:bg-green-950/20 p-3 rounded-lg border border-green-100 dark:border-green-900/30",children:[t.jsx("div",{className:"text-xs text-green-600 dark:text-green-400 mb-1",children:"Ø§Ù„Ù…Ø±Ø³Ù„"}),t.jsx("div",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:Bs.totalSent.toLocaleString("en-US",{maximumFractionDigits:0})})]}),t.jsx("div",{className:"col-span-2 bg-yellow-50 dark:bg-yellow-950/20 p-3 rounded-lg border border-yellow-100 dark:border-yellow-900/30",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),t.jsx("div",{className:"text-lg font-bold text-yellow-800 dark:text-yellow-200",children:Bs.totalProfit.toLocaleString("en-US",{maximumFractionDigits:0})})]})})]})]})]})}),t.jsx(Ow,{isOpen:pt,onClose:()=>Y(!1),userId:(e==null?void 0:e.uid)||"",wallets:X,walletBalances:Se}),t.jsx(oN,{isOpen:le,onClose:()=>re(!1)}),t.jsx(ue,{open:Mt,onOpenChange:dt,children:t.jsxs(me,{className:"sm:max-w-md",dir:"rtl",children:[t.jsx(ye,{children:t.jsxs(he,{className:"flex items-center gap-2 text-destructive",children:[t.jsx(xm,{className:"h-5 w-5"}),"ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„"]})}),t.jsxs("div",{className:"flex flex-col items-center justify-center py-4 space-y-4",children:[t.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center",children:t.jsx(xm,{className:"h-6 w-6 text-red-600"})}),t.jsxs("p",{className:"text-center text-gray-600",children:["Ø¹ÙÙˆØ§Ù‹ØŒ Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù….",t.jsx("br",{}),"ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ù…Ù† Ù‚Ø¨Ù„ Ù…Ø§Ù„Ùƒ Ø§Ù„Ø­Ø³Ø§Ø¨."]})]}),t.jsx(We,{className:"sm:justify-center",children:t.jsx(I,{variant:"outline",onClick:()=>dt(!1),className:"w-full sm:w-auto",children:"Ø­Ø³Ù†Ø§Ù‹"})})]})}),t.jsx(Ex,{isOpen:W,onClose:vt,userName:(i==null?void 0:i.name)||((om=e==null?void 0:e.displayName)==null?void 0:om.split(" ")[0])||""}),t.jsx(Gm,{isOpen:Ne,onClose:()=>Ce(!1),videoUrl:xe,title:Fe})]}))},uj=Object.freeze(Object.defineProperty({__proto__:null,default:hN},Symbol.toStringTag,{value:"Module"}));export{dc as C,Zm as P,uj as U,Da as a,lr as b,ka as c,fh as d,_m as e,Am as f,pa as g,oc as h};
//# sourceMappingURL=UserDashboardPage-BxOlnKZi.js.map
