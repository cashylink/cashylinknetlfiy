{"version":3,"mappings":"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","names":["__iconNode","MapPin","createLucideIcon","UserAccountSetupPage","searchParams","useSearchParams","userName","navigate","useNavigate","toast","useToast","user","useFirebaseAuth","formData","setFormData","useState","loading","setLoading","error","setError","showTrialModal","setShowTrialModal","accountSetupComplete","setAccountSetupComplete","useEffect","handleInputChange","e","name","value","prev","validateForm","handleSubmit","addDoc","collection","serverTimestamp","__vitePreload","n","db","shopId","profileService","jsxs","jsx","Store","Card","CardHeader","CardTitle","User","CardContent","Alert","AlertDescription","Label","Input","Phone","Button","CheckCircle","ArrowRight"],"ignoreList":[0],"sources":["../../node_modules/lucide-react/dist/esm/icons/map-pin.js","../../src/pages/UserAccountSetupPage.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.561.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0\",\n      key: \"1r0f0z\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"10\", r: \"3\", key: \"ilqhr7\" }]\n];\nconst MapPin = createLucideIcon(\"map-pin\", __iconNode);\n\nexport { __iconNode, MapPin as default };\n//# sourceMappingURL=map-pin.js.map\n","import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { User, Store, Phone, MapPin, ArrowRight, CheckCircle } from 'lucide-react';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\r\n// تم إزالة TrialOfferModal\r\nimport { profileService } from '@/integrations/firebase/services';\r\n\r\nconst UserAccountSetupPage = () => {\r\n  const [searchParams] = useSearchParams();\r\n  const userName = searchParams.get('user_name') || '';\r\n  const navigate = useNavigate();\r\n  const { toast } = useToast();\r\n  const { user } = useFirebaseAuth();\r\n  \r\n  const [formData, setFormData] = useState({\r\n    shopName: '',\r\n    shopAddress: '',\r\n    phoneNumber: '',\r\n    description: ''\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [showTrialModal, setShowTrialModal] = useState(false);\r\n  const [accountSetupComplete, setAccountSetupComplete] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      navigate('/auth');\r\n      return;\r\n    }\r\n  }, [user, navigate]);\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n  };\r\n\r\n  const validateForm = () => {\r\n    if (!formData.shopName.trim()) {\r\n      setError('اسم المتجر مطلوب');\r\n      return false;\r\n    }\r\n    if (!formData.phoneNumber.trim()) {\r\n      setError('رقم الهاتف مطلوب');\r\n      return false;\r\n    }\r\n    if (!formData.shopAddress.trim()) {\r\n      setError('عنوان المتجر مطلوب');\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError('');\r\n    \r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    \r\n    try {\r\n      // إنشاء profile للتاجر مع بيانات المتجر\r\n      if (user) {\r\n        const { addDoc, collection, serverTimestamp } = await import('firebase/firestore');\r\n        const { db } = await import('@/firebase');\r\n        const shopRef = await addDoc(collection(db, 'shops'), {\r\n          name: formData.shopName || 'متجر جديد',\r\n          ownerId: user.uid,\r\n          createdAt: serverTimestamp(),\r\n          updatedAt: serverTimestamp(),\r\n          isActive: true,\r\n        });\r\n        const shopId = shopRef.id;\r\n        \r\n        await profileService.create({\r\n          userId: user.uid,\r\n          shopId,\r\n          role: 'merchant',\r\n          fullName: userName,\r\n          phone: formData.phoneNumber,\r\n        });\r\n      }\r\n      \r\n      toast({\r\n        title: \"تم إعداد الحساب بنجاح\",\r\n        description: `مرحباً ${userName}! تم إعداد متجرك \"${formData.shopName}\" بنجاح`,\r\n      });\r\n      \r\n      // إظهار نافذة التجربة المجانية بدلاً من التوجيه المباشر\r\n      setAccountSetupComplete(true);\r\n      setShowTrialModal(true);\r\n      \r\n    } catch (error: any) {\r\n      console.error('Account setup error:', error);\r\n      setError('حدث خطأ أثناء إعداد الحساب');\r\n      toast({\r\n        title: \"خطأ في إعداد الحساب\",\r\n        description: \"حدث خطأ أثناء إعداد الحساب، يرجى المحاولة مرة أخرى\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleStartTrial = async () => {\r\n    // تم إزالة منطق التجربة المجانية\r\n    setShowTrialModal(false);\r\n    navigate('/user/login');\r\n  };\r\n\r\n  const handleSkipTrial = () => {\r\n    setShowTrialModal(false);\r\n    navigate('/user/dashboard');\r\n  };\r\n\r\n  if (!user) {\r\n    return null; // سيتم التوجيه إلى صفحة المصادقة\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\r\n      <div className=\"w-full max-w-2xl\">\r\n        {/* Header */}\r\n        <div className=\"text-center mb-8 fade-in-up\">\r\n          <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full mb-4 shadow-md\">\r\n            <Store className=\"h-8 w-8 text-white\" />\r\n          </div>\r\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">مرحباً {userName}!</h1>\r\n          <p className=\"text-gray-600\">دعنا نقوم بإعداد حساب متجرك</p>\r\n        </div>\r\n\r\n        {/* Setup Form */}\r\n        <Card className=\"shadow-md border-0 bg-white/80 backdrop-blur-sm card-glow fade-in-up rounded-2xl\">\r\n          <CardHeader className=\"text-center pb-4\">\r\n            <CardTitle className=\"text-2xl font-bold text-gray-900 flex items-center justify-center gap-2\">\r\n              <User className=\"h-6 w-6 text-blue-600\" />\r\n              إعداد حساب التاجر\r\n            </CardTitle>\r\n            <p className=\"text-gray-600 text-sm mt-2\">\r\n              أدخل بيانات متجرك لإكمال إعداد الحساب\r\n            </p>\r\n          </CardHeader>\r\n          \r\n          <CardContent className=\"space-y-6\">\r\n            {error && (\r\n              <Alert variant=\"destructive\" className=\"fade-in-up\">\r\n                <AlertDescription>{error}</AlertDescription>\r\n              </Alert>\r\n            )}\r\n\r\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n              {/* Shop Name */}\r\n              <div className=\"space-y-2 fade-in-up\">\r\n                <Label htmlFor=\"shopName\" className=\"text-sm font-medium text-gray-700 flex items-center gap-2\">\r\n                  <Store className=\"h-4 w-4 text-blue-600\" />\r\n                  اسم المتجر\r\n                </Label>\r\n                <Input\r\n                  id=\"shopName\"\r\n                  name=\"shopName\"\r\n                  type=\"text\"\r\n                  placeholder=\"أدخل اسم متجرك\"\r\n                  value={formData.shopName}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                  className=\"h-12 transition-all duration-300 focus:ring-2 focus:ring-blue-500 rounded-2xl\"\r\n                />\r\n              </div>\r\n\r\n              {/* Phone Number */}\r\n              <div className=\"space-y-2 fade-in-up\">\r\n                <Label htmlFor=\"phoneNumber\" className=\"text-sm font-medium text-gray-700 flex items-center gap-2\">\r\n                  <Phone className=\"h-4 w-4 text-blue-600\" />\r\n                  رقم الهاتف\r\n                </Label>\r\n                <Input\r\n                  id=\"phoneNumber\"\r\n                  name=\"phoneNumber\"\r\n                  type=\"tel\"\r\n                  placeholder=\"أدخل رقم هاتف المتجر\"\r\n                  value={formData.phoneNumber}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                  className=\"h-12 transition-all duration-300 focus:ring-2 focus:ring-blue-500\"\r\n                />\r\n              </div>\r\n\r\n              {/* Shop Address */}\r\n              <div className=\"space-y-2 fade-in-up\">\r\n                <Label htmlFor=\"shopAddress\" className=\"text-sm font-medium text-gray-700 flex items-center gap-2\">\r\n                  <MapPin className=\"h-4 w-4 text-blue-600\" />\r\n                  عنوان المتجر\r\n                </Label>\r\n                <Input\r\n                  id=\"shopAddress\"\r\n                  name=\"shopAddress\"\r\n                  type=\"text\"\r\n                  placeholder=\"أدخل عنوان المتجر\"\r\n                  value={formData.shopAddress}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                  className=\"h-12 transition-all duration-300 focus:ring-2 focus:ring-blue-500\"\r\n                />\r\n              </div>\r\n\r\n              {/* Description */}\r\n              <div className=\"space-y-2 fade-in-up\">\r\n                <Label htmlFor=\"description\" className=\"text-sm font-medium text-gray-700\">\r\n                  وصف المتجر (اختياري)\r\n                </Label>\r\n                <textarea\r\n                  id=\"description\"\r\n                  name=\"description\"\r\n                  placeholder=\"أدخل وصفاً مختصراً عن متجرك\"\r\n                  value={formData.description}\r\n                  onChange={handleInputChange}\r\n                  rows={3}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300\"\r\n                />\r\n              </div>\r\n\r\n              {/* Submit Button */}\r\n              <Button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                className=\"w-full h-12 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-medium transition-all duration-300 btn-bounce hover-glow fade-in-up\"\r\n              >\r\n                {loading ? (\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\"></div>\r\n                    جاري إعداد الحساب...\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <CheckCircle className=\"h-4 w-4\" />\r\n                    إكمال إعداد الحساب\r\n                    <ArrowRight className=\"h-4 w-4\" />\r\n                  </div>\r\n                )}\r\n              </Button>\r\n            </form>\r\n\r\n            {/* Info */}\r\n            <div className=\"text-center pt-4 border-t border-gray-200 fade-in-up\">\r\n              <p className=\"text-sm text-gray-600\">\r\n                بعد إكمال الإعداد، ستتمكن من الوصول إلى لوحة تحكم التاجر وإدارة متجرك\r\n              </p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Footer */}\r\n        <div className=\"text-center mt-8 fade-in-up\">\r\n          <p className=\"text-xs text-gray-500\">\r\n            © 2024 كاشي لينك. جميع الحقوق محفوظة.\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* تم إزالة TrialOfferModal */}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserAccountSetupPage;\r\n"],"file":"assets/UserAccountSetupPage-BPoVexWs.js"}