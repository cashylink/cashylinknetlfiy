import{r as i,R as E,j as e,af as A,ag as L,ah as F,ai as k,y as h,I as v,B as g,J as M,K as R,a4 as q,H,av as y}from"./index-F79wE54_.js";import{D as I}from"./dollar-sign-C1EWy7pl.js";function O({open:n,onOpenChange:u,onSuccess:w,title:b,description:S,currentBalance:t,balanceLabel:D,userId:p}){const[c,o]=i.useState(""),[d,r]=i.useState(t.toString()),[m,P]=i.useState(!1),[f,s]=i.useState(""),[j,x]=i.useState(!1),C=async a=>{a.preventDefault(),s(""),x(!0);try{const l=parseFloat(d);if(isNaN(l)||l<0){s("يرجى إدخال مبلغ صحيح"),x(!1);return}await y.hasMasterPin(p)?await y.verifyMasterPin(c,p)?(w(l),u(!1),o(""),r("")):s("الرقم السري غير صحيح"):s("لم يتم تعيين رقم سري رئيسي. يرجى تعيين رقم سري رئيسي أولاً من إعدادات التطبيق")}catch{s("حدث خطأ أثناء التحقق من الرقم السري")}finally{x(!1)}},N=()=>{o(""),r(t.toString()),s(""),u(!1)};return E.useEffect(()=>{n&&r(t.toString())},[t,n]),e.jsx(A,{open:n,onOpenChange:N,children:e.jsxs(L,{className:"sm:max-w-md",dir:"rtl",children:[e.jsx(F,{children:e.jsxs(k,{className:"flex items-center gap-2 text-right",children:[e.jsx(I,{className:"h-5 w-5"}),b]})}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground text-right",children:S}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs(h,{className:"text-sm font-medium text-gray-700",children:[D," الحالي"]}),e.jsxs("div",{className:"text-lg font-bold text-gray-900 mt-1",children:[t.toLocaleString()," جنيه"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"newAmount",className:"text-right",children:"المبلغ الجديد"}),e.jsx(v,{id:"newAmount",type:"number",step:"0.01",min:"0",value:d,onChange:a=>r(a.target.value),placeholder:"أدخل المبلغ الجديد",className:"text-right",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"pin",className:"text-right",children:"الرقم السري"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{id:"pin",type:m?"text":"password",value:c,onChange:a=>o(a.target.value),placeholder:"أدخل الرقم السري",className:"text-right pr-10",required:!0}),e.jsx(g,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>P(!m),children:m?e.jsx(M,{className:"h-4 w-4"}):e.jsx(R,{className:"h-4 w-4"})})]})]}),f&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 bg-red-50 p-2 rounded",children:[e.jsx(q,{className:"h-4 w-4"}),f]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(g,{type:"button",variant:"outline",onClick:N,className:"flex-1",children:"إلغاء"}),e.jsx(g,{type:"submit",disabled:j||!c||!d,className:"flex-1",children:j?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"جاري التحديث..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"تحديث الرصيد"]})})]})]})]})})}export{O as EditBalanceDialog};
//# sourceMappingURL=EditBalanceDialog-BEXZtmH-.js.map
