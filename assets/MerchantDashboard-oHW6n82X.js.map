{"version":3,"file":"MerchantDashboard-oHW6n82X.js","sources":["../../src/components/layout/Header.tsx","../../src/pages/merchant/MerchantDashboard.tsx"],"sourcesContent":["import { LogOut, Settings, User, GitBranch, Store } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { useFirebaseAuth } from \"@/contexts/FirebaseAuthContext\";\r\nimport { useState } from \"react\";\r\nimport { BranchRequestDialog } from \"@/components/BranchRequestDialog\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nexport function Header() {\r\n  const { profile, signOut, userSubscription } = useFirebaseAuth();\r\n  const [branchRequestOpen, setBranchRequestOpen] = useState(false);\r\n  const navigate = useNavigate();\r\n  \r\n  const isBranchActive = userSubscription?.branchPackage?.status === 'active';\r\n  const isBranchPending = userSubscription?.branchPackage?.status === 'pending';\r\n\r\n  const handleBranchClick = () => {\r\n    if (isBranchActive) {\r\n      navigate('/cpanel');\r\n    } else if (!isBranchPending) {\r\n      setBranchRequestOpen(true);\r\n    }\r\n  };\r\n\r\n  const getRoleLabel = (role: string) => {\r\n    switch (role) {\r\n      case 'staff': return 'مدير';\r\n      case 'merchant': return 'تاجر';\r\n      case 'user': return 'مستخدم';\r\n      default: return role;\r\n    }\r\n  };\r\n\r\n  const getRoleColor = (role: string) => {\r\n    switch (role) {\r\n      case 'staff': return 'bg-secondary text-secondary-foreground';\r\n      case 'merchant': return 'bg-success text-success-foreground';\r\n      case 'user': return 'bg-blue-500 text-white';\r\n      default: return 'bg-muted text-muted-foreground';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <header className=\"h-16 border-b border-border bg-card/50 backdrop-blur-sm\">\r\n      <div className=\"flex h-full items-center justify-between px-6\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <h1 className=\"text-xl font-bold text-foreground\">منصة إدارة المحول</h1>\r\n          {profile && (\r\n            <Badge className={getRoleColor(profile.role)}>\r\n              {getRoleLabel(profile.role)}\r\n            </Badge>\r\n          )}\r\n          \r\n        </div>\r\n        \r\n        <div className=\"flex items-center gap-4\">\r\n          {/* User Menu */}\r\n          <DropdownMenu>\r\n            <DropdownMenuTrigger asChild>\r\n              <Button variant=\"ghost\" className=\"flex items-center gap-2\">\r\n                <div className=\"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center\">\r\n                  <User className=\"h-4 w-4 text-primary\" />\r\n                </div>\r\n                <span className=\"text-sm\">{profile?.fullName || 'المستخدم'}</span>\r\n              </Button>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent align=\"end\" className=\"w-56\">\r\n              <DropdownMenuLabel>حسابي</DropdownMenuLabel>\r\n              <DropdownMenuSeparator />\r\n              <DropdownMenuItem>\r\n                <Settings className=\"mr-2 h-4 w-4\" />\r\n                <span>الإعدادات</span>\r\n              </DropdownMenuItem>\r\n              <DropdownMenuSeparator />\r\n              <DropdownMenuItem onClick={() => signOut()} className=\"text-destructive\">\r\n                <LogOut className=\"mr-2 h-4 w-4\" />\r\n                <span>تسجيل الخروج</span>\r\n              </DropdownMenuItem>\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n\r\n          {/* Branch Management Button */}\r\n          {profile && (\r\n            <Button \r\n              variant=\"ghost\" \r\n              size=\"icon\"\r\n              className={`rounded-full w-10 h-10 ${isBranchPending ? 'opacity-70 cursor-not-allowed' : ''}`}\r\n              onClick={handleBranchClick}\r\n              disabled={isBranchPending}\r\n              title={isBranchActive ? 'إدارة الفروع' : isBranchPending ? 'طلب الفروع قيد المراجعة' : 'إدارة الفروع'}\r\n            >\r\n              <Store className=\"h-5 w-5\" />\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n      <BranchRequestDialog \r\n        open={branchRequestOpen} \r\n        onOpenChange={setBranchRequestOpen} \r\n      />\r\n    </header>\r\n  );\r\n}","import { useEffect, useState } from \"react\";\r\nimport { Routes, Route, Navigate } from \"react-router-dom\";\r\nimport { Header } from \"@/components/layout/Header\";\r\nimport { WalletsManagement } from \"@/components/merchant/WalletsManagement\";\r\nimport { useFirebaseAuth } from \"@/contexts/FirebaseAuthContext\";\r\n// تم إزالة trialService\r\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\r\nimport { Clock, AlertTriangle } from \"lucide-react\";\r\n\r\nexport default function MerchantDashboard() {\r\n  const { user, profile, loading } = useFirebaseAuth();\r\n\r\n  useEffect(() => {\r\n    if (!loading && (!user || !profile || profile.role !== 'merchant')) {\r\n      window.location.href = '/auth';\r\n    }\r\n  }, [user, profile, loading]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\r\n        <div className=\"text-center\">\r\n          <div className=\"h-8 w-8 animate-spin border-4 border-primary border-r-transparent rounded-full mx-auto mb-4\"></div>\r\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!user || !profile || profile.role !== 'merchant') {\r\n    return null;\r\n  }\r\n\r\n  // السماح بالدخول حتى إذا لم تكن الموافقة مكتملة\r\n  if (profile && !profile.approved) {\r\n    // لا تحويل لصفحة انتظار الموافقة\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      <Header />\r\n      <main className=\"container mx-auto p-6\">\r\n        <Routes>\r\n          <Route path=\"/\" element={<Navigate to=\"/merchant/wallets\" replace />} />\r\n          <Route path=\"/wallets\" element={<WalletsManagement />} />\r\n        </Routes>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["Header","profile","signOut","userSubscription","useFirebaseAuth","branchRequestOpen","setBranchRequestOpen","useState","navigate","useNavigate","isBranchActive","_a","isBranchPending","_b","handleBranchClick","getRoleLabel","role","getRoleColor","jsxs","jsx","Badge","DropdownMenu","DropdownMenuTrigger","Button","User","DropdownMenuContent","DropdownMenuLabel","DropdownMenuSeparator","DropdownMenuItem","Settings","LogOut","Store","BranchRequestDialog","MerchantDashboard","user","loading","useEffect","Routes","Route","Navigate","WalletsManagement"],"mappings":"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"}