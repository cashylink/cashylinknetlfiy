import{_ as hs,cr as xu,cs as Cs,r as Fe,l as gu,u as mu,aK as pu,ae as wu,R as Ts,q as dr,t as ol,p as Vt,s as st,Q as vu,ad as xn,aF as vt,w as Cr,v as Ss,j as y,af as Qa,ag as $a,ai as en,B as He,au as Ns,C as tn,c as yu,d as Eu,f as k0,G as cl,J as ks,aR as Bo,a8 as I0,a1 as In,x as Ut,I as Rt,H as _u,at as Is,a9 as ll,as as Lo,ah as qn,aG as Zn,ar as ya,T as Lr,D as qr,b4 as Au,aE as jo,a5 as bu,a4 as Cu,bo as Tu,aP as Fs,A as Zi,Z as fl,aI as Jn}from"./index-CzMrJEuC.js";import{T as F0,a as D0,b as Qn,c as ar,d as O0,e as nr}from"./table-B3xDson-.js";import{B as Fn}from"./badge-D-234tiw.js";import{T as Su,a as Nu,b as Uo,c as Wo,S as Vo}from"./tabs-CUOI6ynQ.js";import{D as ku,a as Iu,b as Fu,e as R0}from"./dropdown-menu-BbnyNGMu.js";import{S as M0}from"./separator-CRdC0eUh.js";import{C as P0,f as Du,S as hl,a as ul,b as dl,c as xl,d as B0}from"./select-DHMtOuee.js";import{A as gl,a as ml,b as pl,c as wl,d as vl,e as yl,f as El,g as _l}from"./alert-dialog-BuOo2tJw.js";import{b as Ho,a as Ds,c as Os,d as Ou,P as Al,e as bl,f as Cl,g as L0,h as Tl,C as Sl}from"./UserDashboardPage-njIiAjYE.js";import{C as Ru}from"./chart-column-CC631eCQ.js";import{R as Nl}from"./refresh-cw-oGf6rkWG.js";import{D as Ji}from"./dollar-sign-0aC_iCk7.js";import{C as j0}from"./calendar-DNLMAp6O.js";import{S as Mu}from"./save-C_zXO1pj.js";import{P as Pu}from"./printer-BxRsauDr.js";import{P as kl}from"./pen-line-CXGYdlEQ.js";import{A as Il}from"./arrow-left-DE7YICBa.js";import{T as U0}from"./trending-down-CokIdY6w.js";import{C as Bu}from"./circle-x-BIAaVYIX.js";import"./index-BBRmOonx.js";import"./ProfileSettingsPage-C3UNZtns.js";import"./switch-BsQLD5QZ.js";import"./square-pen-BXn6dQmK.js";import"./textarea-DH9YvORw.js";import"./users-DCm2SxTc.js";import"./circle-check-big-CujdvfsP.js";import"./crown-CHbbJHO0.js";import"./ProfileIcon-CoHGJzAB.js";import"./freeTrialService-BlbSJwfx.js";import"./broadcastService-D5PHNSZD.js";import"./bell-BJOCCReM.js";import"./profitService-D3SXiBSD.js";import"./arrow-down-left-Do7B1AJE.js";import"./SimCardsAccessDialog-p84rP6ZI.js";import"./wallet-BpRPCgGm.js";import"./star-C4GDXCGa.js";function Lu(e,r){for(var t=0;t<r.length;t++){const n=r[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const f=Object.getOwnPropertyDescriptor(n,s);f&&Object.defineProperty(e,s,f.get?f:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Uu=hs("ellipsis-vertical",ju);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Fl=hs("file-down",Wu);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],Dl=hs("file-up",Vu);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ol=hs("rotate-ccw",Hu);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]],Rs=hs("scan-barcode",Gu);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],Rl=hs("shopping-cart",Xu),zu={lessThanXSeconds:{one:"أقل من ثانية",two:"أقل من ثانيتين",threeToTen:"أقل من {{count}} ثواني",other:"أقل من {{count}} ثانية"},xSeconds:{one:"ثانية",two:"ثانيتين",threeToTen:"{{count}} ثواني",other:"{{count}} ثانية"},halfAMinute:"نص دقيقة",lessThanXMinutes:{one:"أقل من دقيقة",two:"أقل من دقيقتين",threeToTen:"أقل من {{count}} دقايق",other:"أقل من {{count}} دقيقة"},xMinutes:{one:"دقيقة",two:"دقيقتين",threeToTen:"{{count}} دقايق",other:"{{count}} دقيقة"},aboutXHours:{one:"حوالي ساعة",two:"حوالي ساعتين",threeToTen:"حوالي {{count}} ساعات",other:"حوالي {{count}} ساعة"},xHours:{one:"ساعة",two:"ساعتين",threeToTen:"{{count}} ساعات",other:"{{count}} ساعة"},xDays:{one:"يوم",two:"يومين",threeToTen:"{{count}} أيام",other:"{{count}} يوم"},aboutXWeeks:{one:"حوالي أسبوع",two:"حوالي أسبوعين",threeToTen:"حوالي {{count}} أسابيع",other:"حوالي {{count}} أسبوع"},xWeeks:{one:"أسبوع",two:"أسبوعين",threeToTen:"{{count}} أسابيع",other:"{{count}} أسبوع"},aboutXMonths:{one:"حوالي شهر",two:"حوالي شهرين",threeToTen:"حوالي {{count}} أشهر",other:"حوالي {{count}} شهر"},xMonths:{one:"شهر",two:"شهرين",threeToTen:"{{count}} أشهر",other:"{{count}} شهر"},aboutXYears:{one:"حوالي سنة",two:"حوالي سنتين",threeToTen:"حوالي {{count}} سنين",other:"حوالي {{count}} سنة"},xYears:{one:"عام",two:"عامين",threeToTen:"{{count}} أعوام",other:"{{count}} عام"},overXYears:{one:"أكثر من سنة",two:"أكثر من سنتين",threeToTen:"أكثر من {{count}} سنين",other:"أكثر من {{count}} سنة"},almostXYears:{one:"عام تقريبًا",two:"عامين تقريبًا",threeToTen:"{{count}} أعوام تقريبًا",other:"{{count}} عام تقريبًا"}},Yu=(e,r,t)=>{let n;const s=zu[e];return typeof s=="string"?n=s:r===1?n=s.one:r===2?n=s.two:r<=10?n=s.threeToTen.replace("{{count}}",String(r)):n=s.other.replace("{{count}}",String(r)),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?`في خلال ${n}`:`منذ ${n}`:n},Ku={full:"EEEE، do MMMM y",long:"do MMMM y",medium:"dd/MMM/y",short:"d/MM/y"},qu={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Zu={full:"{{date}} 'الساعة' {{time}}",long:"{{date}} 'الساعة' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ju={date:Ho({formats:Ku,defaultWidth:"full"}),time:Ho({formats:qu,defaultWidth:"full"}),dateTime:Ho({formats:Zu,defaultWidth:"full"})},Qu={lastWeek:"eeee 'اللي جاي الساعة' p",yesterday:"'إمبارح الساعة' p",today:"'النهاردة الساعة' p",tomorrow:"'بكرة الساعة' p",nextWeek:"eeee 'الساعة' p",other:"P"},$u=(e,r,t,n)=>Qu[e],ed={narrow:["ق","ب"],abbreviated:["ق.م","ب.م"],wide:["قبل الميلاد","بعد الميلاد"]},td={narrow:["1","2","3","4"],abbreviated:["ر1","ر2","ر3","ر4"],wide:["الربع الأول","الربع الثاني","الربع الثالث","الربع الرابع"]},rd={narrow:["ي","ف","م","أ","م","ي","ي","أ","س","أ","ن","د"],abbreviated:["ينا","فبر","مارس","أبريل","مايو","يونـ","يولـ","أغسـ","سبتـ","أكتـ","نوفـ","ديسـ"],wide:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"]},ad={narrow:["ح","ن","ث","ر","خ","ج","س"],short:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],abbreviated:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],wide:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"]},nd={narrow:{am:"ص",pm:"م",midnight:"ن",noon:"ظ",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءً",night:"ليلاً"},abbreviated:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهراً",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءً",night:"ليلاً"},wide:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهراً",morning:"صباحاً",afternoon:"بعد الظهر",evening:"مساءً",night:"ليلاً"}},id={narrow:{am:"ص",pm:"م",midnight:"ن",noon:"ظ",morning:"في الصباح",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل"},abbreviated:{am:"ص",pm:"م",midnight:"نصف الليل",noon:"ظهراً",morning:"في الصباح",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل"},wide:{am:"ص",pm:"م",midnight:"نصف الليل",morning:"في الصباح",noon:"ظهراً",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل"}},sd=(e,r)=>String(e),od={ordinalNumber:sd,era:Ds({values:ed,defaultWidth:"wide"}),quarter:Ds({values:td,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ds({values:rd,defaultWidth:"wide"}),day:Ds({values:ad,defaultWidth:"wide"}),dayPeriod:Ds({values:nd,defaultWidth:"wide",formattingValues:id,defaultFormattingWidth:"wide"})},cd=/^(\d+)/,ld=/\d+/i,fd={narrow:/^(ق|ب)/g,abbreviated:/^(ق.م|ب.م)/g,wide:/^(قبل الميلاد|بعد الميلاد)/g},hd={any:[/^ق/g,/^ب/g]},ud={narrow:/^[1234]/,abbreviated:/^ر[1234]/,wide:/^الربع (الأول|الثاني|الثالث|الرابع)/},dd={wide:[/الربع الأول/,/الربع الثاني/,/الربع الثالث/,/الربع الرابع/],any:[/1/,/2/,/3/,/4/]},xd={narrow:/^(ي|ف|م|أ|س|ن|د)/,abbreviated:/^(ينا|فبر|مارس|أبريل|مايو|يونـ|يولـ|أغسـ|سبتـ|أكتـ|نوفـ|ديسـ)/,wide:/^(يناير|فبراير|مارس|أبريل|مايو|يونيو|يوليو|أغسطس|سبتمبر|أكتوبر|نوفمبر|ديسمبر)/},gd={narrow:[/^ي/,/^ف/,/^م/,/^أ/,/^م/,/^ي/,/^ي/,/^أ/,/^س/,/^أ/,/^ن/,/^د/],any:[/^ينا/,/^فبر/,/^مارس/,/^أبريل/,/^مايو/,/^يون/,/^يول/,/^أغس/,/^سبت/,/^أكت/,/^نوف/,/^ديس/]},md={narrow:/^(ح|ن|ث|ر|خ|ج|س)/,short:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/,abbreviated:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/,wide:/^(الأحد|الاثنين|الثلاثاء|الأربعاء|الخميس|الجمعة|السبت)/},pd={narrow:[/^ح/,/^ن/,/^ث/,/^ر/,/^خ/,/^ج/,/^س/],any:[/أحد/,/اثنين/,/ثلاثاء/,/أربعاء/,/خميس/,/جمعة/,/سبت/]},wd={narrow:/^(ص|م|ن|ظ|في الصباح|بعد الظهر|في المساء|في الليل)/,abbreviated:/^(ص|م|نصف الليل|ظهراً|في الصباح|بعد الظهر|في المساء|في الليل)/,wide:/^(ص|م|نصف الليل|في الصباح|ظهراً|بعد الظهر|في المساء|في الليل)/,any:/^(ص|م|صباح|ظهر|مساء|ليل)/},vd={any:{am:/^ص/,pm:/^م/,midnight:/^ن/,noon:/^ظ/,morning:/^ص/,afternoon:/^بعد/,evening:/^م/,night:/^ل/}},yd={ordinalNumber:Ou({matchPattern:cd,parsePattern:ld,valueCallback:function(e){return parseInt(e,10)}}),era:Os({matchPatterns:fd,defaultMatchWidth:"wide",parsePatterns:hd,defaultParseWidth:"any"}),quarter:Os({matchPatterns:ud,defaultMatchWidth:"wide",parsePatterns:dd,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Os({matchPatterns:xd,defaultMatchWidth:"wide",parsePatterns:gd,defaultParseWidth:"any"}),day:Os({matchPatterns:md,defaultMatchWidth:"wide",parsePatterns:pd,defaultParseWidth:"any"}),dayPeriod:Os({matchPatterns:wd,defaultMatchWidth:"any",parsePatterns:vd,defaultParseWidth:"any"})},W0={code:"ar-EG",formatDistance:Yu,formatLong:Ju,formatRelative:$u,localize:od,match:yd,options:{weekStartsOn:0,firstWeekContainsDate:1}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ro={};ro.version="0.18.5";var r1=1252,Ed=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wc={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},vc=function(e){Ed.indexOf(e)!=-1&&(r1=wc[0]=e)};function _d(){vc(1252)}var an=function(e){vc(e)};function yc(){an(1200),_d()}function Ml(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function Ad(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function a1(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Ps=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?Ad(e.slice(2)):r==254&&t==255?a1(e.slice(2)):r==65279?e.slice(1):e},V0=function(r){return String.fromCharCode(r)},Pl=function(r){return String.fromCharCode(r)},Ys,ei="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ks(e){for(var r="",t=0,n=0,s=0,f=0,u=0,x=0,p=0,m=0;m<e.length;)t=e.charCodeAt(m++),f=t>>2,n=e.charCodeAt(m++),u=(t&3)<<4|n>>4,s=e.charCodeAt(m++),x=(n&15)<<2|s>>6,p=s&63,isNaN(n)?x=p=64:isNaN(s)&&(p=64),r+=ei.charAt(f)+ei.charAt(u)+ei.charAt(x)+ei.charAt(p);return r}function Ma(e){var r="",t=0,n=0,s=0,f=0,u=0,x=0,p=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)f=ei.indexOf(e.charAt(m++)),u=ei.indexOf(e.charAt(m++)),t=f<<2|u>>4,r+=String.fromCharCode(t),x=ei.indexOf(e.charAt(m++)),n=(u&15)<<4|x>>2,x!==64&&(r+=String.fromCharCode(n)),p=ei.indexOf(e.charAt(m++)),s=(x&3)<<6|p,p!==64&&(r+=String.fromCharCode(s));return r}var At=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ln=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function ri(e){return At?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Bl(e){return At?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Oa=function(r){return At?Ln(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function vo(e){if(typeof ArrayBuffer>"u")return Oa(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=e.charCodeAt(n)&255;return r}function si(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function bd(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Ec(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ec(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Gr=At?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Ln(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),s=0;for(r=0,t=0;r<e.length;t+=s,++r)if(s=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(f){return Array.isArray(f)?f:[].slice.call(f)}))};function Cd(e){for(var r=[],t=0,n=e.length+250,s=ri(e.length+255),f=0;f<e.length;++f){var u=e.charCodeAt(f);if(u<128)s[t++]=u;else if(u<2048)s[t++]=192|u>>6&31,s[t++]=128|u&63;else if(u>=55296&&u<57344){u=(u&1023)+64;var x=e.charCodeAt(++f)&1023;s[t++]=240|u>>8&7,s[t++]=128|u>>2&63,s[t++]=128|x>>6&15|(u&3)<<4,s[t++]=128|x&63}else s[t++]=224|u>>12&15,s[t++]=128|u>>6&63,s[t++]=128|u&63;t>n&&(r.push(s.slice(0,t)),t=0,s=ri(65535),n=65530)}return r.push(s.slice(0,t)),Gr(r)}var ma=/\u0000/g,Bs=/[\u0001-\u0006]/g;function ns(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function nn(e,r){var t=""+e;return t.length>=r?t:Er("0",r-t.length)+t}function _c(e,r){var t=""+e;return t.length>=r?t:Er(" ",r-t.length)+t}function ao(e,r){var t=""+e;return t.length>=r?t:t+Er(" ",r-t.length)}function Td(e,r){var t=""+Math.round(e);return t.length>=r?t:Er("0",r-t.length)+t}function Sd(e,r){var t=""+e;return t.length>=r?t:Er("0",r-t.length)+t}var Ll=Math.pow(2,32);function Qi(e,r){if(e>Ll||e<-Ll)return Td(e,r);var t=Math.round(e);return Sd(t,r)}function no(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var jl=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Go=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Nd(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var at={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Ul={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},kd={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function io(e,r,t){for(var n=e<0?-1:1,s=e*n,f=0,u=1,x=0,p=1,m=0,v=0,E=Math.floor(s);m<r&&(E=Math.floor(s),x=E*u+f,v=E*m+p,!(s-E<5e-8));)s=1/(s-E),f=u,u=x,p=m,m=v;if(v>r&&(m>r?(v=p,x=f):(v=m,x=u)),!t)return[0,n*x,v];var b=Math.floor(n*x/v);return[b,n*x-b*v,v]}function _i(e,r,t){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),f=0,u=[],x={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(x.u)<1e-6&&(x.u=0),r&&r.date1904&&(n+=1462),x.u>.9999&&(x.u=0,++s==86400&&(x.T=s=0,++n,++x.D)),n===60)u=t?[1317,10,29]:[1900,2,29],f=3;else if(n===0)u=t?[1317,8,29]:[1900,1,0],f=6;else{n>60&&--n;var p=new Date(1900,0,1);p.setDate(p.getDate()+n-1),u=[p.getFullYear(),p.getMonth()+1,p.getDate()],f=p.getDay(),n<60&&(f=(f+6)%7),t&&(f=Md(p,u))}return x.y=u[0],x.m=u[1],x.d=u[2],x.S=s%60,s=Math.floor(s/60),x.M=s%60,s=Math.floor(s/60),x.H=s,x.q=f,x}var n1=new Date(1899,11,31,0,0,0),Id=n1.getTime(),Fd=new Date(1900,2,1,0,0,0);function i1(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=Fd&&(t+=24*60*60*1e3),(t-(Id+(e.getTimezoneOffset()-n1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ac(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Dd(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Od(e){var r=e<0?12:11,t=Ac(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function Rd(e){var r=Ac(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function qs(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=Od(e):r===10?t=e.toFixed(10).substr(0,12):t=Rd(e),Ac(Dd(t.toUpperCase()))}function Si(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):qs(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return za(14,i1(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Md(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Pd(e,r,t,n){var s="",f=0,u=0,x=t.y,p,m=0;switch(e){case 98:x=t.y+543;case 121:switch(r.length){case 1:case 2:p=x%100,m=2;break;default:p=x%1e4,m=4;break}break;case 109:switch(r.length){case 1:case 2:p=t.m,m=r.length;break;case 3:return Go[t.m-1][1];case 5:return Go[t.m-1][0];default:return Go[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:p=t.d,m=r.length;break;case 3:return jl[t.q][0];default:return jl[t.q][1]}break;case 104:switch(r.length){case 1:case 2:p=1+(t.H+11)%12,m=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:p=t.H,m=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:p=t.M,m=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?nn(t.S,r.length):(n>=2?u=n===3?1e3:100:u=n===1?10:1,f=Math.round(u*(t.S+t.u)),f>=60*u&&(f=0),r==="s"?f===0?"0":""+f/u:(s=nn(f,2+n),r==="ss"?s.substr(0,2):"."+s.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":p=t.D*24+t.H;break;case"[m]":case"[mm]":p=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":p=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}m=r.length===3?1:2;break;case 101:p=x,m=1;break}var v=m>0?nn(p,m):"";return v}function ti(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var s1=/%/g;function Bd(e,r,t){var n=r.replace(s1,""),s=r.length-n.length;return Rn(e,n,t*Math.pow(10,2*s))+Er("%",s)}function Ld(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Rn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function o1(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+o1(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var f=Math.floor(Math.log(r)*Math.LOG10E)%s;if(f<0&&(f+=s),t=(r/Math.pow(10,f)).toPrecision(n+1+(s+f)%s),t.indexOf("e")===-1){var u=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+f):t+="E+"+(u-f);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(x,p,m,v){return p+m+v.substr(0,(s+f)%s)+"."+v.substr(f)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var c1=/# (\?+)( ?)\/( ?)(\d+)/;function jd(e,r,t){var n=parseInt(e[4],10),s=Math.round(r*n),f=Math.floor(s/n),u=s-f*n,x=n;return t+(f===0?"":""+f)+" "+(u===0?Er(" ",e[1].length+1+e[4].length):_c(u,e[1].length)+e[2]+"/"+e[3]+nn(x,e[4].length))}function Ud(e,r,t){return t+(r===0?"":""+r)+Er(" ",e[1].length+2+e[4].length)}var l1=/^#*0*\.([0#]+)/,f1=/\).*[0#]/,h1=/\(###\) ###\\?-####/;function xa(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Wl(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Vl(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function Wd(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Vd(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ua(e,r,t){if(e.charCodeAt(0)===40&&!r.match(f1)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ua("n",n,t):"("+Ua("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Ld(e,r,t);if(r.indexOf("%")!==-1)return Bd(e,r,t);if(r.indexOf("E")!==-1)return o1(r,t);if(r.charCodeAt(0)===36)return"$"+Ua(e,r.substr(r.charAt(1)==" "?2:1),t);var s,f,u,x,p=Math.abs(t),m=t<0?"-":"";if(r.match(/^00+$/))return m+Qi(p,r.length);if(r.match(/^[#?]+$/))return s=Qi(t,0),s==="0"&&(s=""),s.length>r.length?s:xa(r.substr(0,r.length-s.length))+s;if(f=r.match(c1))return jd(f,p,m);if(r.match(/^#+0+$/))return m+Qi(p,r.length-r.indexOf("0"));if(f=r.match(l1))return s=Wl(t,f[1].length).replace(/^([^\.]+)$/,"$1."+xa(f[1])).replace(/\.$/,"."+xa(f[1])).replace(/\.(\d*)$/,function(k,A){return"."+A+Er("0",xa(f[1]).length-A.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),f=r.match(/^(0*)\.(#*)$/))return m+Wl(p,f[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=r.match(/^#{1,3},##0(\.?)$/))return m+ti(Qi(p,0));if(f=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ua(e,r,-t):ti(""+(Math.floor(t)+Wd(t,f[1].length)))+"."+nn(Vl(t,f[1].length),f[1].length);if(f=r.match(/^#,#*,#0/))return Ua(e,r.replace(/^#,#*,/,""),t);if(f=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ns(Ua(e,r.replace(/[\\-]/g,""),t)),u=0,ns(ns(r.replace(/\\/g,"")).replace(/[0#]/g,function(k){return u<s.length?s.charAt(u++):k==="0"?"0":""}));if(r.match(h1))return s=Ua(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var v="";if(f=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(f[4].length,7),x=io(p,Math.pow(10,u)-1,!1),s=""+m,v=Rn("n",f[1],x[1]),v.charAt(v.length-1)==" "&&(v=v.substr(0,v.length-1)+"0"),s+=v+f[2]+"/"+f[3],v=ao(x[2],u),v.length<f[4].length&&(v=xa(f[4].substr(f[4].length-v.length))+v),s+=v,s;if(f=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(f[1].length,f[4].length),7),x=io(p,Math.pow(10,u)-1,!0),m+(x[0]||(x[1]?"":"0"))+" "+(x[1]?_c(x[1],u)+f[2]+"/"+f[3]+ao(x[2],u):Er(" ",2*u+1+f[2].length+f[3].length));if(f=r.match(/^[#0?]+$/))return s=Qi(t,0),r.length<=s.length?s:xa(r.substr(0,r.length-s.length))+s;if(f=r.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),u=s.indexOf(".");var E=r.indexOf(".")-u,b=r.length-s.length-E;return xa(r.substr(0,E)+s+r.substr(r.length-b))}if(f=r.match(/^00,000\.([#0]*0)$/))return u=Vl(t,f[1].length),t<0?"-"+Ua(e,r,-t):ti(Vd(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?nn(0,3-k.length):"")+k})+"."+nn(u,f[1].length);switch(r){case"###,##0.00":return Ua(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var S=ti(Qi(p,0));return S!=="0"?m+S:"";case"###,###.00":return Ua(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ua(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Hd(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Rn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Gd(e,r,t){var n=r.replace(s1,""),s=r.length-n.length;return Rn(e,n,t*Math.pow(10,2*s))+Er("%",s)}function u1(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+u1(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var f=Math.floor(Math.log(r)*Math.LOG10E)%s;if(f<0&&(f+=s),t=(r/Math.pow(10,f)).toPrecision(n+1+(s+f)%s),!t.match(/[Ee]/)){var u=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(u-t.length+f):t+="E+"+(u-f),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(x,p,m,v){return p+m+v.substr(0,(s+f)%s)+"."+v.substr(f)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function mn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(f1)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?mn("n",n,t):"("+mn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Hd(e,r,t);if(r.indexOf("%")!==-1)return Gd(e,r,t);if(r.indexOf("E")!==-1)return u1(r,t);if(r.charCodeAt(0)===36)return"$"+mn(e,r.substr(r.charAt(1)==" "?2:1),t);var s,f,u,x,p=Math.abs(t),m=t<0?"-":"";if(r.match(/^00+$/))return m+nn(p,r.length);if(r.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>r.length?s:xa(r.substr(0,r.length-s.length))+s;if(f=r.match(c1))return Ud(f,p,m);if(r.match(/^#+0+$/))return m+nn(p,r.length-r.indexOf("0"));if(f=r.match(l1))return s=(""+t).replace(/^([^\.]+)$/,"$1."+xa(f[1])).replace(/\.$/,"."+xa(f[1])),s=s.replace(/\.(\d*)$/,function(k,A){return"."+A+Er("0",xa(f[1]).length-A.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),f=r.match(/^(0*)\.(#*)$/))return m+(""+p).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=r.match(/^#{1,3},##0(\.?)$/))return m+ti(""+p);if(f=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+mn(e,r,-t):ti(""+t)+"."+Er("0",f[1].length);if(f=r.match(/^#,#*,#0/))return mn(e,r.replace(/^#,#*,/,""),t);if(f=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ns(mn(e,r.replace(/[\\-]/g,""),t)),u=0,ns(ns(r.replace(/\\/g,"")).replace(/[0#]/g,function(k){return u<s.length?s.charAt(u++):k==="0"?"0":""}));if(r.match(h1))return s=mn(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var v="";if(f=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(f[4].length,7),x=io(p,Math.pow(10,u)-1,!1),s=""+m,v=Rn("n",f[1],x[1]),v.charAt(v.length-1)==" "&&(v=v.substr(0,v.length-1)+"0"),s+=v+f[2]+"/"+f[3],v=ao(x[2],u),v.length<f[4].length&&(v=xa(f[4].substr(f[4].length-v.length))+v),s+=v,s;if(f=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(f[1].length,f[4].length),7),x=io(p,Math.pow(10,u)-1,!0),m+(x[0]||(x[1]?"":"0"))+" "+(x[1]?_c(x[1],u)+f[2]+"/"+f[3]+ao(x[2],u):Er(" ",2*u+1+f[2].length+f[3].length));if(f=r.match(/^[#0?]+$/))return s=""+t,r.length<=s.length?s:xa(r.substr(0,r.length-s.length))+s;if(f=r.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),u=s.indexOf(".");var E=r.indexOf(".")-u,b=r.length-s.length-E;return xa(r.substr(0,E)+s+r.substr(r.length-b))}if(f=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+mn(e,r,-t):ti(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?nn(0,3-k.length):"")+k})+"."+nn(0,f[1].length);switch(r){case"###,###":case"##,###":case"#,###":var S=ti(""+p);return S!=="0"?m+S:"";default:if(r.match(/\.[0#?]*$/))return mn(e,r.slice(0,r.lastIndexOf(".")),t)+xa(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Rn(e,r,t){return(t|0)===t?mn(e,r,t):Ua(e,r,t)}function Xd(e){for(var r=[],t=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(s,n-s),s=n+1}if(r[r.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var d1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function us(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":no(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(d1))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function zd(e,r,t,n){for(var s=[],f="",u=0,x="",p="t",m,v,E,b="H";u<e.length;)switch(x=e.charAt(u)){case"G":if(!no(e,u))throw new Error("unrecognized character "+x+" in "+e);s[s.length]={t:"G",v:"General"},u+=7;break;case'"':for(f="";(E=e.charCodeAt(++u))!==34&&u<e.length;)f+=String.fromCharCode(E);s[s.length]={t:"t",v:f},++u;break;case"\\":var S=e.charAt(++u),k=S==="("||S===")"?S:"t";s[s.length]={t:k,v:S},++u;break;case"_":s[s.length]={t:"t",v:" "},u+=2;break;case"@":s[s.length]={t:"T",v:r},++u;break;case"B":case"b":if(e.charAt(u+1)==="1"||e.charAt(u+1)==="2"){if(m==null&&(m=_i(r,t,e.charAt(u+1)==="2"),m==null))return"";s[s.length]={t:"X",v:e.substr(u,2)},p=x,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":x=x.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||m==null&&(m=_i(r,t),m==null))return"";for(f=x;++u<e.length&&e.charAt(u).toLowerCase()===x;)f+=x;x==="m"&&p.toLowerCase()==="h"&&(x="M"),x==="h"&&(x=b),s[s.length]={t:x,v:f},p=x;break;case"A":case"a":case"上":var A={t:x,v:x};if(m==null&&(m=_i(r,t)),e.substr(u,3).toUpperCase()==="A/P"?(m!=null&&(A.v=m.H>=12?"P":"A"),A.t="T",b="h",u+=3):e.substr(u,5).toUpperCase()==="AM/PM"?(m!=null&&(A.v=m.H>=12?"PM":"AM"),A.t="T",u+=5,b="h"):e.substr(u,5).toUpperCase()==="上午/下午"?(m!=null&&(A.v=m.H>=12?"下午":"上午"),A.t="T",u+=5,b="h"):(A.t="t",++u),m==null&&A.t==="T")return"";s[s.length]=A,p=x;break;case"[":for(f=x;e.charAt(u++)!=="]"&&u<e.length;)f+=e.charAt(u);if(f.slice(-1)!=="]")throw'unterminated "[" block: |'+f+"|";if(f.match(d1)){if(m==null&&(m=_i(r,t),m==null))return"";s[s.length]={t:"Z",v:f.toLowerCase()},p=f.charAt(1)}else f.indexOf("$")>-1&&(f=(f.match(/\$([^-\[\]]*)/)||[])[1]||"$",us(e)||(s[s.length]={t:"t",v:f}));break;case".":if(m!=null){for(f=x;++u<e.length&&(x=e.charAt(u))==="0";)f+=x;s[s.length]={t:"s",v:f};break}case"0":case"#":for(f=x;++u<e.length&&"0#?.,E+-%".indexOf(x=e.charAt(u))>-1;)f+=x;s[s.length]={t:"n",v:f};break;case"?":for(f=x;e.charAt(++u)===x;)f+=x;s[s.length]={t:x,v:f},p=x;break;case"*":++u,(e.charAt(u)==" "||e.charAt(u)=="*")&&++u;break;case"(":case")":s[s.length]={t:n===1?"t":x,v:x},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(f=x;u<e.length&&"0123456789".indexOf(e.charAt(++u))>-1;)f+=e.charAt(u);s[s.length]={t:"D",v:f};break;case" ":s[s.length]={t:x,v:x},++u;break;case"$":s[s.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(x)===-1)throw new Error("unrecognized character "+x+" in "+e);s[s.length]={t:"t",v:x},++u;break}var F=0,V=0,G;for(u=s.length-1,p="t";u>=0;--u)switch(s[u].t){case"h":case"H":s[u].t=b,p="h",F<1&&(F=1);break;case"s":(G=s[u].v.match(/\.0+$/))&&(V=Math.max(V,G[0].length-1)),F<3&&(F=3);case"d":case"y":case"M":case"e":p=s[u].t;break;case"m":p==="s"&&(s[u].t="M",F<2&&(F=2));break;case"X":break;case"Z":F<1&&s[u].v.match(/[Hh]/)&&(F=1),F<2&&s[u].v.match(/[Mm]/)&&(F=2),F<3&&s[u].v.match(/[Ss]/)&&(F=3)}switch(F){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var D="",J;for(u=0;u<s.length;++u)switch(s[u].t){case"t":case"T":case" ":case"D":break;case"X":s[u].v="",s[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[u].v=Pd(s[u].t.charCodeAt(0),s[u].v,m,V),s[u].t="t";break;case"n":case"?":for(J=u+1;s[J]!=null&&((x=s[J].t)==="?"||x==="D"||(x===" "||x==="t")&&s[J+1]!=null&&(s[J+1].t==="?"||s[J+1].t==="t"&&s[J+1].v==="/")||s[u].t==="("&&(x===" "||x==="n"||x===")")||x==="t"&&(s[J].v==="/"||s[J].v===" "&&s[J+1]!=null&&s[J+1].t=="?"));)s[u].v+=s[J].v,s[J]={v:"",t:";"},++J;D+=s[u].v,u=J-1;break;case"G":s[u].t="t",s[u].v=Si(r,t);break}var ie="",Q,M;if(D.length>0){D.charCodeAt(0)==40?(Q=r<0&&D.charCodeAt(0)===45?-r:r,M=Rn("n",D,Q)):(Q=r<0&&n>1?-r:r,M=Rn("n",D,Q),Q<0&&s[0]&&s[0].t=="t"&&(M=M.substr(1),s[0].v="-"+s[0].v)),J=M.length-1;var ne=s.length;for(u=0;u<s.length;++u)if(s[u]!=null&&s[u].t!="t"&&s[u].v.indexOf(".")>-1){ne=u;break}var X=s.length;if(ne===s.length&&M.indexOf("E")===-1){for(u=s.length-1;u>=0;--u)s[u]==null||"n?".indexOf(s[u].t)===-1||(J>=s[u].v.length-1?(J-=s[u].v.length,s[u].v=M.substr(J+1,s[u].v.length)):J<0?s[u].v="":(s[u].v=M.substr(0,J+1),J=-1),s[u].t="t",X=u);J>=0&&X<s.length&&(s[X].v=M.substr(0,J+1)+s[X].v)}else if(ne!==s.length&&M.indexOf("E")===-1){for(J=M.indexOf(".")-1,u=ne;u>=0;--u)if(!(s[u]==null||"n?".indexOf(s[u].t)===-1)){for(v=s[u].v.indexOf(".")>-1&&u===ne?s[u].v.indexOf(".")-1:s[u].v.length-1,ie=s[u].v.substr(v+1);v>=0;--v)J>=0&&(s[u].v.charAt(v)==="0"||s[u].v.charAt(v)==="#")&&(ie=M.charAt(J--)+ie);s[u].v=ie,s[u].t="t",X=u}for(J>=0&&X<s.length&&(s[X].v=M.substr(0,J+1)+s[X].v),J=M.indexOf(".")+1,u=ne;u<s.length;++u)if(!(s[u]==null||"n?(".indexOf(s[u].t)===-1&&u!==ne)){for(v=s[u].v.indexOf(".")>-1&&u===ne?s[u].v.indexOf(".")+1:0,ie=s[u].v.substr(0,v);v<s[u].v.length;++v)J<M.length&&(ie+=M.charAt(J++));s[u].v=ie,s[u].t="t",X=u}}}for(u=0;u<s.length;++u)s[u]!=null&&"n?".indexOf(s[u].t)>-1&&(Q=n>1&&r<0&&u>0&&s[u-1].v==="-"?-r:r,s[u].v=Rn(s[u].t,s[u].v,Q),s[u].t="t");var me="";for(u=0;u!==s.length;++u)s[u]!=null&&(me+=s[u].v);return me}var Hl=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gl(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function Yd(e,r){var t=Xd(e),n=t.length,s=t[n-1].indexOf("@");if(n<4&&s>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var f=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,f];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var u=t[0].match(Hl),x=t[1].match(Hl);return Gl(r,u)?[n,t[0]]:Gl(r,x)?[n,t[1]]:[n,t[u!=null&&x!=null?2:1]]}return[n,f]}function za(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:at)[e],n==null&&(n=t.table&&t.table[Ul[e]]||at[Ul[e]]),n==null&&(n=kd[e]||"General");break}if(no(n,0))return Si(r,t);r instanceof Date&&(r=i1(r,t.date1904));var s=Yd(n,r);if(no(s[1]))return Si(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return zd(s[1],r,t,s[0])}function Mn(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(at[t]==null){r<0&&(r=t);continue}if(at[t]==e){r=t;break}}r<0&&(r=391)}return at[r]=e,r}function yo(e){for(var r=0;r!=392;++r)e[r]!==void 0&&Mn(e[r],r)}function ds(){at=Nd()}var Kd={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},x1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function qd(e){var r=typeof e=="number"?at[e]:e;return r=r.replace(x1,"(\\d+)"),new RegExp("^"+r+"$")}function Zd(e,r,t){var n=-1,s=-1,f=-1,u=-1,x=-1,p=-1;(r.match(x1)||[]).forEach(function(E,b){var S=parseInt(t[b+1],10);switch(E.toLowerCase().charAt(0)){case"y":n=S;break;case"d":f=S;break;case"h":u=S;break;case"s":p=S;break;case"m":u>=0?x=S:s=S;break}}),p>=0&&x==-1&&s>=0&&(x=s,s=-1);var m=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(f>=1?f:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var v=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(x>=0?x:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2);return u==-1&&x==-1&&p==-1?m:n==-1&&s==-1&&f==-1?v:m+"T"+v}var Jd=function(){var e={};e.version="1.2.0";function r(){for(var M=0,ne=new Array(256),X=0;X!=256;++X)M=X,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,ne[X]=M;return typeof Int32Array<"u"?new Int32Array(ne):ne}var t=r();function n(M){var ne=0,X=0,me=0,le=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(me=0;me!=256;++me)le[me]=M[me];for(me=0;me!=256;++me)for(X=M[me],ne=256+me;ne<4096;ne+=256)X=le[ne]=X>>>8^M[X&255];var ee=[];for(me=1;me!=16;++me)ee[me-1]=typeof Int32Array<"u"?le.subarray(me*256,me*256+256):le.slice(me*256,me*256+256);return ee}var s=n(t),f=s[0],u=s[1],x=s[2],p=s[3],m=s[4],v=s[5],E=s[6],b=s[7],S=s[8],k=s[9],A=s[10],F=s[11],V=s[12],G=s[13],D=s[14];function J(M,ne){for(var X=ne^-1,me=0,le=M.length;me<le;)X=X>>>8^t[(X^M.charCodeAt(me++))&255];return~X}function ie(M,ne){for(var X=ne^-1,me=M.length-15,le=0;le<me;)X=D[M[le++]^X&255]^G[M[le++]^X>>8&255]^V[M[le++]^X>>16&255]^F[M[le++]^X>>>24]^A[M[le++]]^k[M[le++]]^S[M[le++]]^b[M[le++]]^E[M[le++]]^v[M[le++]]^m[M[le++]]^p[M[le++]]^x[M[le++]]^u[M[le++]]^f[M[le++]]^t[M[le++]];for(me+=15;le<me;)X=X>>>8^t[(X^M[le++])&255];return~X}function Q(M,ne){for(var X=ne^-1,me=0,le=M.length,ee=0,pe=0;me<le;)ee=M.charCodeAt(me++),ee<128?X=X>>>8^t[(X^ee)&255]:ee<2048?(X=X>>>8^t[(X^(192|ee>>6&31))&255],X=X>>>8^t[(X^(128|ee&63))&255]):ee>=55296&&ee<57344?(ee=(ee&1023)+64,pe=M.charCodeAt(me++)&1023,X=X>>>8^t[(X^(240|ee>>8&7))&255],X=X>>>8^t[(X^(128|ee>>2&63))&255],X=X>>>8^t[(X^(128|pe>>6&15|(ee&3)<<4))&255],X=X>>>8^t[(X^(128|pe&63))&255]):(X=X>>>8^t[(X^(224|ee>>12&15))&255],X=X>>>8^t[(X^(128|ee>>6&63))&255],X=X>>>8^t[(X^(128|ee&63))&255]);return~X}return e.table=t,e.bstr=J,e.buf=ie,e.str=Q,e}(),Je=function(){var r={};r.version="1.2.1";function t(O,P){for(var j=O.split("/"),U=P.split("/"),Y=0,q=0,he=Math.min(j.length,U.length);Y<he;++Y){if(q=j[Y].length-U[Y].length)return q;if(j[Y]!=U[Y])return j[Y]<U[Y]?-1:1}return j.length-U.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var P=O.lastIndexOf("/");return P===-1?O:O.slice(0,P+1)}function s(O){if(O.charAt(O.length-1)=="/")return s(O.slice(0,-1));var P=O.lastIndexOf("/");return P===-1?O:O.slice(P+1)}function f(O,P){typeof P=="string"&&(P=new Date(P));var j=P.getHours();j=j<<6|P.getMinutes(),j=j<<5|P.getSeconds()>>>1,O.write_shift(2,j);var U=P.getFullYear()-1980;U=U<<4|P.getMonth()+1,U=U<<5|P.getDate(),O.write_shift(2,U)}function u(O){var P=O.read_shift(2)&65535,j=O.read_shift(2)&65535,U=new Date,Y=j&31;j>>>=5;var q=j&15;j>>>=4,U.setMilliseconds(0),U.setFullYear(j+1980),U.setMonth(q-1),U.setDate(Y);var he=P&31;P>>>=5;var ye=P&63;return P>>>=6,U.setHours(P),U.setMinutes(ye),U.setSeconds(he<<1),U}function x(O){Jr(O,0);for(var P={},j=0;O.l<=O.length-4;){var U=O.read_shift(2),Y=O.read_shift(2),q=O.l+Y,he={};switch(U){case 21589:j=O.read_shift(1),j&1&&(he.mtime=O.read_shift(4)),Y>5&&(j&2&&(he.atime=O.read_shift(4)),j&4&&(he.ctime=O.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}O.l=q,P[U]=he}return P}var p;function m(){return p||(p={})}function v(O,P){if(O[0]==80&&O[1]==75)return _n(O,P);if((O[0]|32)==109&&(O[1]|32)==105)return An(O,P);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var j=3,U=512,Y=0,q=0,he=0,ye=0,oe=0,de=[],xe=O.slice(0,512);Jr(xe,0);var Se=E(xe);switch(j=Se[0],j){case 3:U=512;break;case 4:U=4096;break;case 0:if(Se[1]==0)return _n(O,P);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}U!==512&&(xe=O.slice(0,U),Jr(xe,28));var Oe=O.slice(0,U);b(xe,j);var Ie=xe.read_shift(4,"i");if(j===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);xe.l+=4,he=xe.read_shift(4,"i"),xe.l+=4,xe.chk("00100000","Mini Stream Cutoff Size: "),ye=xe.read_shift(4,"i"),Y=xe.read_shift(4,"i"),oe=xe.read_shift(4,"i"),q=xe.read_shift(4,"i");for(var Re=-1,Be=0;Be<109&&(Re=xe.read_shift(4,"i"),!(Re<0));++Be)de[Be]=Re;var et=S(O,U);F(oe,q,et,U,de);var Ee=G(et,he,de,U);Ee[he].name="!Directory",Y>0&&ye!==pe&&(Ee[ye].name="!MiniFAT"),Ee[de[0]].name="!FAT",Ee.fat_addrs=de,Ee.ssz=U;var Bt={},ht=[],Kr=[],ea=[];D(he,Ee,et,ht,Y,Bt,Kr,ye),k(Kr,ea,ht),ht.shift();var mt={FileIndex:Kr,FullPaths:ea};return P&&P.raw&&(mt.raw={header:Oe,sectors:et}),mt}function E(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(Pe,"Header Signature: "),O.l+=16;var P=O.read_shift(2,"u");return[O.read_shift(2,"u"),P]}function b(O,P){var j=9;switch(O.l+=2,j=O.read_shift(2)){case 9:if(P!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(P!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function S(O,P){for(var j=Math.ceil(O.length/P)-1,U=[],Y=1;Y<j;++Y)U[Y-1]=O.slice(Y*P,(Y+1)*P);return U[j-1]=O.slice(j*P),U}function k(O,P,j){for(var U=0,Y=0,q=0,he=0,ye=0,oe=j.length,de=[],xe=[];U<oe;++U)de[U]=xe[U]=U,P[U]=j[U];for(;ye<xe.length;++ye)U=xe[ye],Y=O[U].L,q=O[U].R,he=O[U].C,de[U]===U&&(Y!==-1&&de[Y]!==Y&&(de[U]=de[Y]),q!==-1&&de[q]!==q&&(de[U]=de[q])),he!==-1&&(de[he]=U),Y!==-1&&U!=de[U]&&(de[Y]=de[U],xe.lastIndexOf(Y)<ye&&xe.push(Y)),q!==-1&&U!=de[U]&&(de[q]=de[U],xe.lastIndexOf(q)<ye&&xe.push(q));for(U=1;U<oe;++U)de[U]===U&&(q!==-1&&de[q]!==q?de[U]=de[q]:Y!==-1&&de[Y]!==Y&&(de[U]=de[Y]));for(U=1;U<oe;++U)if(O[U].type!==0){if(ye=U,ye!=de[ye])do ye=de[ye],P[U]=P[ye]+"/"+P[U];while(ye!==0&&de[ye]!==-1&&ye!=de[ye]);de[U]=-1}for(P[0]+="/",U=1;U<oe;++U)O[U].type!==2&&(P[U]+="/")}function A(O,P,j){for(var U=O.start,Y=O.size,q=[],he=U;j&&Y>0&&he>=0;)q.push(P.slice(he*ee,he*ee+ee)),Y-=ee,he=Ei(j,he*4);return q.length===0?_e(0):Gr(q).slice(0,O.size)}function F(O,P,j,U,Y){var q=pe;if(O===pe){if(P!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var he=j[O],ye=(U>>>2)-1;if(!he)return;for(var oe=0;oe<ye&&(q=Ei(he,oe*4))!==pe;++oe)Y.push(q);F(Ei(he,U-4),P-1,j,U,Y)}}function V(O,P,j,U,Y){var q=[],he=[];Y||(Y=[]);var ye=U-1,oe=0,de=0;for(oe=P;oe>=0;){Y[oe]=!0,q[q.length]=oe,he.push(O[oe]);var xe=j[Math.floor(oe*4/U)];if(de=oe*4&ye,U<4+de)throw new Error("FAT boundary crossed: "+oe+" 4 "+U);if(!O[xe])break;oe=Ei(O[xe],de)}return{nodes:q,data:rf([he])}}function G(O,P,j,U){var Y=O.length,q=[],he=[],ye=[],oe=[],de=U-1,xe=0,Se=0,Oe=0,Ie=0;for(xe=0;xe<Y;++xe)if(ye=[],Oe=xe+P,Oe>=Y&&(Oe-=Y),!he[Oe]){oe=[];var Re=[];for(Se=Oe;Se>=0;){Re[Se]=!0,he[Se]=!0,ye[ye.length]=Se,oe.push(O[Se]);var Be=j[Math.floor(Se*4/U)];if(Ie=Se*4&de,U<4+Ie)throw new Error("FAT boundary crossed: "+Se+" 4 "+U);if(!O[Be]||(Se=Ei(O[Be],Ie),Re[Se]))break}q[Oe]={nodes:ye,data:rf([oe])}}return q}function D(O,P,j,U,Y,q,he,ye){for(var oe=0,de=U.length?2:0,xe=P[O].data,Se=0,Oe=0,Ie;Se<xe.length;Se+=128){var Re=xe.slice(Se,Se+128);Jr(Re,64),Oe=Re.read_shift(2),Ie=Ic(Re,0,Oe-de),U.push(Ie);var Be={name:Ie,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},et=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);et!==0&&(Be.ct=J(Re,Re.l-8));var Ee=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);Ee!==0&&(Be.mt=J(Re,Re.l-8)),Be.start=Re.read_shift(4,"i"),Be.size=Re.read_shift(4,"i"),Be.size<0&&Be.start<0&&(Be.size=Be.type=0,Be.start=pe,Be.name=""),Be.type===5?(oe=Be.start,Y>0&&oe!==pe&&(P[oe].name="!StreamData")):Be.size>=4096?(Be.storage="fat",P[Be.start]===void 0&&(P[Be.start]=V(j,Be.start,P.fat_addrs,P.ssz)),P[Be.start].name=Be.name,Be.content=P[Be.start].data.slice(0,Be.size)):(Be.storage="minifat",Be.size<0?Be.size=0:oe!==pe&&Be.start!==pe&&P[oe]&&(Be.content=A(Be,P[oe].data,(P[ye]||{}).data))),Be.content&&Jr(Be.content,0),q[Ie]=Be,he.push(Be)}}function J(O,P){return new Date((Da(O,P+4)/1e7*Math.pow(2,32)+Da(O,P)/1e7-11644473600)*1e3)}function ie(O,P){return m(),v(p.readFileSync(O),P)}function Q(O,P){var j=P&&P.type;switch(j||At&&Buffer.isBuffer(O)&&(j="buffer"),j||"base64"){case"file":return ie(O,P);case"base64":return v(Oa(Ma(O)),P);case"binary":return v(Oa(O),P)}return v(O,P)}function M(O,P){var j=P||{},U=j.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=U+"/",O.FileIndex[0]={name:U,type:5}),j.CLSID&&(O.FileIndex[0].clsid=j.CLSID),ne(O)}function ne(O){var P="Sh33tJ5";if(!Je.find(O,"/"+P)){var j=_e(4);j[0]=55,j[1]=j[3]=50,j[2]=54,O.FileIndex.push({name:P,type:2,content:j,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+P),X(O)}}function X(O,P){M(O);for(var j=!1,U=!1,Y=O.FullPaths.length-1;Y>=0;--Y){var q=O.FileIndex[Y];switch(q.type){case 0:U?j=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(q.R*q.L*q.C)&&(j=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!P)){var he=new Date(1987,1,19),ye=0,oe=Object.create?Object.create(null):{},de=[];for(Y=0;Y<O.FullPaths.length;++Y)oe[O.FullPaths[Y]]=!0,O.FileIndex[Y].type!==0&&de.push([O.FullPaths[Y],O.FileIndex[Y]]);for(Y=0;Y<de.length;++Y){var xe=n(de[Y][0]);U=oe[xe],U||(de.push([xe,{name:s(xe).replace("/",""),type:1,clsid:Le,ct:he,mt:he,content:null}]),oe[xe]=!0)}for(de.sort(function(Ie,Re){return t(Ie[0],Re[0])}),O.FullPaths=[],O.FileIndex=[],Y=0;Y<de.length;++Y)O.FullPaths[Y]=de[Y][0],O.FileIndex[Y]=de[Y][1];for(Y=0;Y<de.length;++Y){var Se=O.FileIndex[Y],Oe=O.FullPaths[Y];if(Se.name=s(Oe).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||Le,Y===0)Se.C=de.length>1?1:-1,Se.size=0,Se.type=5;else if(Oe.slice(-1)=="/"){for(ye=Y+1;ye<de.length&&n(O.FullPaths[ye])!=Oe;++ye);for(Se.C=ye>=de.length?-1:ye,ye=Y+1;ye<de.length&&n(O.FullPaths[ye])!=n(Oe);++ye);Se.R=ye>=de.length?-1:ye,Se.type=1}else n(O.FullPaths[Y+1]||"")==n(Oe)&&(Se.R=Y+1),Se.type=2}}}function me(O,P){var j=P||{};if(j.fileType=="mad")return wa(O,j);switch(X(O),j.fileType){case"zip":return wr(O,j)}var U=function(Ie){for(var Re=0,Be=0,et=0;et<Ie.FileIndex.length;++et){var Ee=Ie.FileIndex[et];if(Ee.content){var Bt=Ee.content.length;Bt>0&&(Bt<4096?Re+=Bt+63>>6:Be+=Bt+511>>9)}}for(var ht=Ie.FullPaths.length+3>>2,Kr=Re+7>>3,ea=Re+127>>7,mt=Kr+Be+ht+ea,ut=mt+127>>7,pt=ut<=109?0:Math.ceil((ut-109)/127);mt+ut+pt+127>>7>ut;)pt=++ut<=109?0:Math.ceil((ut-109)/127);var fa=[1,pt,ut,ea,ht,Be,Re,0];return Ie.FileIndex[0].size=Re<<6,fa[7]=(Ie.FileIndex[0].start=fa[0]+fa[1]+fa[2]+fa[3]+fa[4]+fa[5])+(fa[6]+7>>3),fa}(O),Y=_e(U[7]<<9),q=0,he=0;{for(q=0;q<8;++q)Y.write_shift(1,re[q]);for(q=0;q<8;++q)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),q=0;q<3;++q)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,U[2]),Y.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:pe),Y.write_shift(4,U[3]),Y.write_shift(-4,U[1]?U[0]-1:pe),Y.write_shift(4,U[1]),q=0;q<109;++q)Y.write_shift(-4,q<U[2]?U[1]+q:-1)}if(U[1])for(he=0;he<U[1];++he){for(;q<236+he*127;++q)Y.write_shift(-4,q<U[2]?U[1]+q:-1);Y.write_shift(-4,he===U[1]-1?pe:he+1)}var ye=function(Ie){for(he+=Ie;q<he-1;++q)Y.write_shift(-4,q+1);Ie&&(++q,Y.write_shift(-4,pe))};for(he=q=0,he+=U[1];q<he;++q)Y.write_shift(-4,be.DIFSECT);for(he+=U[2];q<he;++q)Y.write_shift(-4,be.FATSECT);ye(U[3]),ye(U[4]);for(var oe=0,de=0,xe=O.FileIndex[0];oe<O.FileIndex.length;++oe)xe=O.FileIndex[oe],xe.content&&(de=xe.content.length,!(de<4096)&&(xe.start=he,ye(de+511>>9)));for(ye(U[6]+7>>3);Y.l&511;)Y.write_shift(-4,be.ENDOFCHAIN);for(he=q=0,oe=0;oe<O.FileIndex.length;++oe)xe=O.FileIndex[oe],xe.content&&(de=xe.content.length,!(!de||de>=4096)&&(xe.start=he,ye(de+63>>6)));for(;Y.l&511;)Y.write_shift(-4,be.ENDOFCHAIN);for(q=0;q<U[4]<<2;++q){var Se=O.FullPaths[q];if(!Se||Se.length===0){for(oe=0;oe<17;++oe)Y.write_shift(4,0);for(oe=0;oe<3;++oe)Y.write_shift(4,-1);for(oe=0;oe<12;++oe)Y.write_shift(4,0);continue}xe=O.FileIndex[q],q===0&&(xe.start=xe.size?xe.start-1:pe);var Oe=q===0&&j.root||xe.name;if(de=2*(Oe.length+1),Y.write_shift(64,Oe,"utf16le"),Y.write_shift(2,de),Y.write_shift(1,xe.type),Y.write_shift(1,xe.color),Y.write_shift(-4,xe.L),Y.write_shift(-4,xe.R),Y.write_shift(-4,xe.C),xe.clsid)Y.write_shift(16,xe.clsid,"hex");else for(oe=0;oe<4;++oe)Y.write_shift(4,0);Y.write_shift(4,xe.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,xe.start),Y.write_shift(4,xe.size),Y.write_shift(4,0)}for(q=1;q<O.FileIndex.length;++q)if(xe=O.FileIndex[q],xe.size>=4096)if(Y.l=xe.start+1<<9,At&&Buffer.isBuffer(xe.content))xe.content.copy(Y,Y.l,0,xe.size),Y.l+=xe.size+511&-512;else{for(oe=0;oe<xe.size;++oe)Y.write_shift(1,xe.content[oe]);for(;oe&511;++oe)Y.write_shift(1,0)}for(q=1;q<O.FileIndex.length;++q)if(xe=O.FileIndex[q],xe.size>0&&xe.size<4096)if(At&&Buffer.isBuffer(xe.content))xe.content.copy(Y,Y.l,0,xe.size),Y.l+=xe.size+63&-64;else{for(oe=0;oe<xe.size;++oe)Y.write_shift(1,xe.content[oe]);for(;oe&63;++oe)Y.write_shift(1,0)}if(At)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function le(O,P){var j=O.FullPaths.map(function(oe){return oe.toUpperCase()}),U=j.map(function(oe){var de=oe.split("/");return de[de.length-(oe.slice(-1)=="/"?2:1)]}),Y=!1;P.charCodeAt(0)===47?(Y=!0,P=j[0].slice(0,-1)+P):Y=P.indexOf("/")!==-1;var q=P.toUpperCase(),he=Y===!0?j.indexOf(q):U.indexOf(q);if(he!==-1)return O.FileIndex[he];var ye=!q.match(Bs);for(q=q.replace(ma,""),ye&&(q=q.replace(Bs,"!")),he=0;he<j.length;++he)if((ye?j[he].replace(Bs,"!"):j[he]).replace(ma,"")==q||(ye?U[he].replace(Bs,"!"):U[he]).replace(ma,"")==q)return O.FileIndex[he];return null}var ee=64,pe=-2,Pe="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],Le="00000000000000000000000000000000",be={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:pe,FREESECT:-1,HEADER_SIGNATURE:Pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Le,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function St(O,P,j){m();var U=me(O,j);p.writeFileSync(P,U)}function ue(O){for(var P=new Array(O.length),j=0;j<O.length;++j)P[j]=String.fromCharCode(O[j]);return P.join("")}function Ye(O,P){var j=me(O,P);switch(P&&P.type||"buffer"){case"file":return m(),p.writeFileSync(P.filename,j),j;case"binary":return typeof j=="string"?j:ue(j);case"base64":return Ks(typeof j=="string"?j:ue(j));case"buffer":if(At)return Buffer.isBuffer(j)?j:Ln(j);case"array":return typeof j=="string"?Oa(j):j}return j}var Qe;function K(O){try{var P=O.InflateRaw,j=new P;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)Qe=O;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function ae(O,P){if(!Qe)return pa(O,P);var j=Qe.InflateRaw,U=new j,Y=U._processChunk(O.slice(O.l),U._finishFlushFlag);return O.l+=U.bytesRead,Y}function z(O){return Qe?Qe.deflateRawSync(O):lt(O)}var N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],B=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function we(O){var P=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(P>>16|P>>8|P)&255}for(var ve=typeof Uint8Array<"u",Ae=ve?new Uint8Array(256):[],Xe=0;Xe<256;++Xe)Ae[Xe]=we(Xe);function Z(O,P){var j=Ae[O&255];return P<=8?j>>>8-P:(j=j<<8|Ae[O>>8&255],P<=16?j>>>16-P:(j=j<<8|Ae[O>>16&255],j>>>24-P))}function Ke(O,P){var j=P&7,U=P>>>3;return(O[U]|(j<=6?0:O[U+1]<<8))>>>j&3}function xt(O,P){var j=P&7,U=P>>>3;return(O[U]|(j<=5?0:O[U+1]<<8))>>>j&7}function _t(O,P){var j=P&7,U=P>>>3;return(O[U]|(j<=4?0:O[U+1]<<8))>>>j&15}function ct(O,P){var j=P&7,U=P>>>3;return(O[U]|(j<=3?0:O[U+1]<<8))>>>j&31}function Me(O,P){var j=P&7,U=P>>>3;return(O[U]|(j<=1?0:O[U+1]<<8))>>>j&127}function tt(O,P,j){var U=P&7,Y=P>>>3,q=(1<<j)-1,he=O[Y]>>>U;return j<8-U||(he|=O[Y+1]<<8-U,j<16-U)||(he|=O[Y+2]<<16-U,j<24-U)||(he|=O[Y+3]<<24-U),he&q}function nt(O,P,j){var U=P&7,Y=P>>>3;return U<=5?O[Y]|=(j&7)<<U:(O[Y]|=j<<U&255,O[Y+1]=(j&7)>>8-U),P+3}function $r(O,P,j){var U=P&7,Y=P>>>3;return j=(j&1)<<U,O[Y]|=j,P+1}function We(O,P,j){var U=P&7,Y=P>>>3;return j<<=U,O[Y]|=j&255,j>>>=8,O[Y+1]=j,P+8}function br(O,P,j){var U=P&7,Y=P>>>3;return j<<=U,O[Y]|=j&255,j>>>=8,O[Y+1]=j&255,O[Y+2]=j>>>8,P+16}function Br(O,P){var j=O.length,U=2*j>P?2*j:P+5,Y=0;if(j>=P)return O;if(At){var q=Bl(U);if(O.copy)O.copy(q);else for(;Y<O.length;++Y)q[Y]=O[Y];return q}else if(ve){var he=new Uint8Array(U);if(he.set)he.set(O);else for(;Y<j;++Y)he[Y]=O[Y];return he}return O.length=U,O}function Zt(O){for(var P=new Array(O),j=0;j<O;++j)P[j]=0;return P}function zr(O,P,j){var U=1,Y=0,q=0,he=0,ye=0,oe=O.length,de=ve?new Uint16Array(32):Zt(32);for(q=0;q<32;++q)de[q]=0;for(q=oe;q<j;++q)O[q]=0;oe=O.length;var xe=ve?new Uint16Array(oe):Zt(oe);for(q=0;q<oe;++q)de[Y=O[q]]++,U<Y&&(U=Y),xe[q]=0;for(de[0]=0,q=1;q<=U;++q)de[q+16]=ye=ye+de[q-1]<<1;for(q=0;q<oe;++q)ye=O[q],ye!=0&&(xe[q]=de[ye+16]++);var Se=0;for(q=0;q<oe;++q)if(Se=O[q],Se!=0)for(ye=Z(xe[q],U)>>U-Se,he=(1<<U+4-Se)-1;he>=0;--he)P[ye|he<<Se]=Se&15|q<<4;return U}var xr=ve?new Uint16Array(512):Zt(512),cn=ve?new Uint16Array(32):Zt(32);if(!ve){for(var Jt=0;Jt<512;++Jt)xr[Jt]=0;for(Jt=0;Jt<32;++Jt)cn[Jt]=0}(function(){for(var O=[],P=0;P<32;P++)O.push(5);zr(O,cn,32);var j=[];for(P=0;P<=143;P++)j.push(8);for(;P<=255;P++)j.push(9);for(;P<=279;P++)j.push(7);for(;P<=287;P++)j.push(8);zr(j,xr,288)})();var zt=function(){for(var P=ve?new Uint8Array(32768):[],j=0,U=0;j<Ne.length-1;++j)for(;U<Ne[j+1];++U)P[U]=j;for(;U<32768;++U)P[U]=29;var Y=ve?new Uint8Array(259):[];for(j=0,U=0;j<B.length-1;++j)for(;U<B[j+1];++U)Y[U]=j;function q(ye,oe){for(var de=0;de<ye.length;){var xe=Math.min(65535,ye.length-de),Se=de+xe==ye.length;for(oe.write_shift(1,+Se),oe.write_shift(2,xe),oe.write_shift(2,~xe&65535);xe-- >0;)oe[oe.l++]=ye[de++]}return oe.l}function he(ye,oe){for(var de=0,xe=0,Se=ve?new Uint16Array(32768):[];xe<ye.length;){var Oe=Math.min(65535,ye.length-xe);if(Oe<10){for(de=nt(oe,de,+(xe+Oe==ye.length)),de&7&&(de+=8-(de&7)),oe.l=de/8|0,oe.write_shift(2,Oe),oe.write_shift(2,~Oe&65535);Oe-- >0;)oe[oe.l++]=ye[xe++];de=oe.l*8;continue}de=nt(oe,de,+(xe+Oe==ye.length)+2);for(var Ie=0;Oe-- >0;){var Re=ye[xe];Ie=(Ie<<5^Re)&32767;var Be=-1,et=0;if((Be=Se[Ie])&&(Be|=xe&-32768,Be>xe&&(Be-=32768),Be<xe))for(;ye[Be+et]==ye[xe+et]&&et<250;)++et;if(et>2){Re=Y[et],Re<=22?de=We(oe,de,Ae[Re+1]>>1)-1:(We(oe,de,3),de+=5,We(oe,de,Ae[Re-23]>>5),de+=3);var Ee=Re<8?0:Re-4>>2;Ee>0&&(br(oe,de,et-B[Re]),de+=Ee),Re=P[xe-Be],de=We(oe,de,Ae[Re]>>3),de-=3;var Bt=Re<4?0:Re-2>>1;Bt>0&&(br(oe,de,xe-Be-Ne[Re]),de+=Bt);for(var ht=0;ht<et;++ht)Se[Ie]=xe&32767,Ie=(Ie<<5^ye[xe])&32767,++xe;Oe-=et-1}else Re<=143?Re=Re+48:de=$r(oe,de,1),de=We(oe,de,Ae[Re]),Se[Ie]=xe&32767,++xe}de=We(oe,de,0)-1}return oe.l=(de+7)/8|0,oe.l}return function(oe,de){return oe.length<8?q(oe,de):he(oe,de)}}();function lt(O){var P=_e(50+Math.floor(O.length*1.1)),j=zt(O,P);return P.slice(0,j)}var Yt=ve?new Uint16Array(32768):Zt(32768),kr=ve?new Uint16Array(32768):Zt(32768),ft=ve?new Uint16Array(128):Zt(128),De=1,tr=1;function Nt(O,P){var j=ct(O,P)+257;P+=5;var U=ct(O,P)+1;P+=5;var Y=_t(O,P)+4;P+=4;for(var q=0,he=ve?new Uint8Array(19):Zt(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,de=ve?new Uint8Array(8):Zt(8),xe=ve?new Uint8Array(8):Zt(8),Se=he.length,Oe=0;Oe<Y;++Oe)he[N[Oe]]=q=xt(O,P),oe<q&&(oe=q),de[q]++,P+=3;var Ie=0;for(de[0]=0,Oe=1;Oe<=oe;++Oe)xe[Oe]=Ie=Ie+de[Oe-1]<<1;for(Oe=0;Oe<Se;++Oe)(Ie=he[Oe])!=0&&(ye[Oe]=xe[Ie]++);var Re=0;for(Oe=0;Oe<Se;++Oe)if(Re=he[Oe],Re!=0){Ie=Ae[ye[Oe]]>>8-Re;for(var Be=(1<<7-Re)-1;Be>=0;--Be)ft[Ie|Be<<Re]=Re&7|Oe<<3}var et=[];for(oe=1;et.length<j+U;)switch(Ie=ft[Me(O,P)],P+=Ie&7,Ie>>>=3){case 16:for(q=3+Ke(O,P),P+=2,Ie=et[et.length-1];q-- >0;)et.push(Ie);break;case 17:for(q=3+xt(O,P),P+=3;q-- >0;)et.push(0);break;case 18:for(q=11+Me(O,P),P+=7;q-- >0;)et.push(0);break;default:et.push(Ie),oe<Ie&&(oe=Ie);break}var Ee=et.slice(0,j),Bt=et.slice(j);for(Oe=j;Oe<286;++Oe)Ee[Oe]=0;for(Oe=U;Oe<30;++Oe)Bt[Oe]=0;return De=zr(Ee,Yt,286),tr=zr(Bt,kr,30),P}function Qt(O,P){if(O[0]==3&&!(O[1]&3))return[ri(P),2];for(var j=0,U=0,Y=Bl(P||1<<18),q=0,he=Y.length>>>0,ye=0,oe=0;!(U&1);){if(U=xt(O,j),j+=3,U>>>1)U>>1==1?(ye=9,oe=5):(j=Nt(O,j),ye=De,oe=tr);else{j&7&&(j+=8-(j&7));var de=O[j>>>3]|O[(j>>>3)+1]<<8;if(j+=32,de>0)for(!P&&he<q+de&&(Y=Br(Y,q+de),he=Y.length);de-- >0;)Y[q++]=O[j>>>3],j+=8;continue}for(;;){!P&&he<q+32767&&(Y=Br(Y,q+32767),he=Y.length);var xe=tt(O,j,ye),Se=U>>>1==1?xr[xe]:Yt[xe];if(j+=Se&15,Se>>>=4,!(Se>>>8&255))Y[q++]=Se;else{if(Se==256)break;Se-=257;var Oe=Se<8?0:Se-4>>2;Oe>5&&(Oe=0);var Ie=q+B[Se];Oe>0&&(Ie+=tt(O,j,Oe),j+=Oe),xe=tt(O,j,oe),Se=U>>>1==1?cn[xe]:kr[xe],j+=Se&15,Se>>>=4;var Re=Se<4?0:Se-2>>1,Be=Ne[Se];for(Re>0&&(Be+=tt(O,j,Re),j+=Re),!P&&he<Ie&&(Y=Br(Y,Ie+100),he=Y.length);q<Ie;)Y[q]=Y[q-Be],++q}}}return P?[Y,j+7>>>3]:[Y.slice(0,q),j+7>>>3]}function pa(O,P){var j=O.slice(O.l||0),U=Qt(j,P);return O.l+=U[1],U[0]}function En(O,P){if(O)typeof console<"u"&&console.error(P);else throw new Error(P)}function _n(O,P){var j=O;Jr(j,0);var U=[],Y=[],q={FileIndex:U,FullPaths:Y};M(q,{root:P.root});for(var he=j.length-4;(j[he]!=80||j[he+1]!=75||j[he+2]!=5||j[he+3]!=6)&&he>=0;)--he;j.l=he+4,j.l+=4;var ye=j.read_shift(2);j.l+=6;var oe=j.read_shift(4);for(j.l=oe,he=0;he<ye;++he){j.l+=20;var de=j.read_shift(4),xe=j.read_shift(4),Se=j.read_shift(2),Oe=j.read_shift(2),Ie=j.read_shift(2);j.l+=8;var Re=j.read_shift(4),Be=x(j.slice(j.l+Se,j.l+Se+Oe));j.l+=Se+Oe+Ie;var et=j.l;j.l=Re+4,Ft(j,de,xe,q,Be),j.l=et}return q}function Ft(O,P,j,U,Y){O.l+=2;var q=O.read_shift(2),he=O.read_shift(2),ye=u(O);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var oe=O.read_shift(4),de=O.read_shift(4),xe=O.read_shift(4),Se=O.read_shift(2),Oe=O.read_shift(2),Ie="",Re=0;Re<Se;++Re)Ie+=String.fromCharCode(O[O.l++]);if(Oe){var Be=x(O.slice(O.l,O.l+Oe));(Be[21589]||{}).mt&&(ye=Be[21589].mt),((Y||{})[21589]||{}).mt&&(ye=Y[21589].mt)}O.l+=Oe;var et=O.slice(O.l,O.l+de);switch(he){case 8:et=ae(O,xe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var Ee=!1;q&8&&(oe=O.read_shift(4),oe==134695760&&(oe=O.read_shift(4),Ee=!0),de=O.read_shift(4),xe=O.read_shift(4)),de!=P&&En(Ee,"Bad compressed size: "+P+" != "+de),xe!=j&&En(Ee,"Bad uncompressed size: "+j+" != "+xe),ba(U,Ie,et,{unsafe:!0,mt:ye})}function wr(O,P){var j=P||{},U=[],Y=[],q=_e(1),he=j.compression?8:0,ye=0,oe=0,de=0,xe=0,Se=0,Oe=O.FullPaths[0],Ie=Oe,Re=O.FileIndex[0],Be=[],et=0;for(oe=1;oe<O.FullPaths.length;++oe)if(Ie=O.FullPaths[oe].slice(Oe.length),Re=O.FileIndex[oe],!(!Re.size||!Re.content||Ie=="Sh33tJ5")){var Ee=xe,Bt=_e(Ie.length);for(de=0;de<Ie.length;++de)Bt.write_shift(1,Ie.charCodeAt(de)&127);Bt=Bt.slice(0,Bt.l),Be[Se]=Jd.buf(Re.content,0);var ht=Re.content;he==8&&(ht=z(ht)),q=_e(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,ye),q.write_shift(2,he),Re.mt?f(q,Re.mt):q.write_shift(4,0),q.write_shift(-4,Be[Se]),q.write_shift(4,ht.length),q.write_shift(4,Re.content.length),q.write_shift(2,Bt.length),q.write_shift(2,0),xe+=q.length,U.push(q),xe+=Bt.length,U.push(Bt),xe+=ht.length,U.push(ht),q=_e(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,ye),q.write_shift(2,he),q.write_shift(4,0),q.write_shift(-4,Be[Se]),q.write_shift(4,ht.length),q.write_shift(4,Re.content.length),q.write_shift(2,Bt.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,Ee),et+=q.l,Y.push(q),et+=Bt.length,Y.push(Bt),++Se}return q=_e(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,Se),q.write_shift(2,Se),q.write_shift(4,et),q.write_shift(4,xe),q.write_shift(2,0),Gr([Gr(U),Gr(Y),q])}var la={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ln(O,P){if(O.ctype)return O.ctype;var j=O.name||"",U=j.match(/\.([^\.]+)$/);return U&&la[U[1]]||P&&(U=(j=P).match(/[\.\\]([^\.\\])+$/),U&&la[U[1]])?la[U[1]]:"application/octet-stream"}function Yr(O){for(var P=Ks(O),j=[],U=0;U<P.length;U+=76)j.push(P.slice(U,U+76));return j.join(`\r
`)+`\r
`}function Ka(O){var P=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var xe=de.charCodeAt(0).toString(16).toUpperCase();return"="+(xe.length==1?"0"+xe:xe)});P=P.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),P.charAt(0)==`
`&&(P="=0D"+P.slice(1)),P=P.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],U=P.split(`\r
`),Y=0;Y<U.length;++Y){var q=U[Y];if(q.length==0){j.push("");continue}for(var he=0;he<q.length;){var ye=76,oe=q.slice(he,he+ye);oe.charAt(ye-1)=="="?ye--:oe.charAt(ye-2)=="="?ye-=2:oe.charAt(ye-3)=="="&&(ye-=3),oe=q.slice(he,he+ye),he+=ye,he<q.length&&(oe+="="),j.push(oe)}}return j.join(`\r
`)}function gr(O){for(var P=[],j=0;j<O.length;++j){for(var U=O[j];j<=O.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+O[++j];P.push(U)}for(var Y=0;Y<P.length;++Y)P[Y]=P[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return Oa(P.join(`\r
`))}function qa(O,P,j){for(var U="",Y="",q="",he,ye=0;ye<10;++ye){var oe=P[ye];if(!oe||oe.match(/^\s*$/))break;var de=oe.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":U=de[2].trim();break;case"content-type":q=de[2].trim();break;case"content-transfer-encoding":Y=de[2].trim();break}}switch(++ye,Y.toLowerCase()){case"base64":he=Oa(Ma(P.slice(ye).join("")));break;case"quoted-printable":he=gr(P.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var xe=ba(O,U.slice(j.length),he,{unsafe:!0});q&&(xe.ctype=q)}function An(O,P){if(ue(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=P&&P.root||"",U=(At&&Buffer.isBuffer(O)?O.toString("binary"):ue(O)).split(`\r
`),Y=0,q="";for(Y=0;Y<U.length;++Y)if(q=U[Y],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),j||(j=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),q.slice(0,j.length)!=j););var he=(U[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var ye="--"+(he[1]||""),oe=[],de=[],xe={FileIndex:oe,FullPaths:de};M(xe);var Se,Oe=0;for(Y=0;Y<U.length;++Y){var Ie=U[Y];Ie!==ye&&Ie!==ye+"--"||(Oe++&&qa(xe,U.slice(Se,Y),j),Se=Y)}return xe}function wa(O,P){var j=P||{},U=j.boundary||"SheetJS";U="------="+U;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],q=O.FullPaths[0],he=q,ye=O.FileIndex[0],oe=1;oe<O.FullPaths.length;++oe)if(he=O.FullPaths[oe].slice(q.length),ye=O.FileIndex[oe],!(!ye.size||!ye.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(et){return"_x"+et.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(et){return"_u"+et.charCodeAt(0).toString(16)+"_"});for(var de=ye.content,xe=At&&Buffer.isBuffer(de)?de.toString("binary"):ue(de),Se=0,Oe=Math.min(1024,xe.length),Ie=0,Re=0;Re<=Oe;++Re)(Ie=xe.charCodeAt(Re))>=32&&Ie<128&&++Se;var Be=Se>=Oe*4/5;Y.push(U),Y.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+he),Y.push("Content-Transfer-Encoding: "+(Be?"quoted-printable":"base64")),Y.push("Content-Type: "+ln(ye,he)),Y.push(""),Y.push(Be?Ka(xe):Yr(xe))}return Y.push(U+`--\r
`),Y.join(`\r
`)}function ms(O){var P={};return M(P,O),P}function ba(O,P,j,U){var Y=U&&U.unsafe;Y||M(O);var q=!Y&&Je.find(O,P);if(!q){var he=O.FullPaths[0];P.slice(0,he.length)==he?he=P:(he.slice(-1)!="/"&&(he+="/"),he=(he+P).replace("//","/")),q={name:s(P),type:2},O.FileIndex.push(q),O.FullPaths.push(he),Y||Je.utils.cfb_gc(O)}return q.content=j,q.size=j?j.length:0,U&&(U.CLSID&&(q.clsid=U.CLSID),U.mt&&(q.mt=U.mt),U.ct&&(q.ct=U.ct)),q}function li(O,P){M(O);var j=Je.find(O,P);if(j){for(var U=0;U<O.FileIndex.length;++U)if(O.FileIndex[U]==j)return O.FileIndex.splice(U,1),O.FullPaths.splice(U,1),!0}return!1}function Wr(O,P,j){M(O);var U=Je.find(O,P);if(U){for(var Y=0;Y<O.FileIndex.length;++Y)if(O.FileIndex[Y]==U)return O.FileIndex[Y].name=s(j),O.FullPaths[Y]=j,!0}return!1}function Za(O){X(O,!0)}return r.find=le,r.read=Q,r.parse=v,r.write=Ye,r.writeFile=St,r.utils={cfb_new:ms,cfb_add:ba,cfb_del:li,cfb_mov:Wr,cfb_gc:Za,ReadShift:js,CheckField:P1,prep_blob:Jr,bconcat:Gr,use_zlib:K,_deflateRaw:lt,_inflateRaw:pa,consts:be},r}();function Qd(e){return typeof e=="string"?vo(e):Array.isArray(e)?bd(e):e}function o0(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=vo(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n=t=="utf8"?wn(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([Qd(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var f=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(f)},6e4),chrome.downloads.download({url:f,filename:e,saveAs:!0});var u=document.createElement("a");if(u.download!=null)return u.download=e,u.href=f,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(f)},6e4),f}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var x=File(e);return x.open("w"),x.encoding="binary",Array.isArray(r)&&(r=si(r)),x.write(r),x.close(),r}catch(p){if(!p.message||!p.message.match(/onstruct/))throw p}throw new Error("cannot save file "+e)}function $d(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ar(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Xl(e,r){for(var t=[],n=Ar(e),s=0;s!==n.length;++s)t[e[n[s]][r]]==null&&(t[e[n[s]][r]]=n[s]);return t}function Eo(e){for(var r=[],t=Ar(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function _o(e){for(var r=[],t=Ar(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}function ex(e){for(var r=[],t=Ar(e),n=0;n!==t.length;++n)r[e[t[n]]]==null&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}var so=new Date(1899,11,30,0,0,0);function Ur(e,r){var t=e.getTime(),n=so.getTime()+(e.getTimezoneOffset()-so.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var g1=new Date,tx=so.getTime()+(g1.getTimezoneOffset()-so.getTimezoneOffset())*6e4,zl=g1.getTimezoneOffset();function Ao(e){var r=new Date;return r.setTime(e*24*60*60*1e3+tx),r.getTimezoneOffset()!==zl&&r.setTime(r.getTime()+(r.getTimezoneOffset()-zl)*6e4),r}function rx(e){var r=0,t=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var f=1;f!=s.length;++f)if(s[f]){switch(t=1,f>3&&(n=!0),s[f].slice(s[f].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[f].slice(s[f].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(s[f],10)}return r}var Yl=new Date("2017-02-19T19:06:09.000Z"),m1=isNaN(Yl.getFullYear())?new Date("2/19/17"):Yl,ax=m1.getFullYear()==2017;function lr(e,r){var t=new Date(e);if(ax)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(m1.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],f=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(f=new Date(f.getTime()-f.getTimezoneOffset()*60*1e3)),f}function Ni(e,r){if(At&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return wn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return wn(a1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return wn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return wn(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(f){return t[f]||f})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function fr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=fr(e[t]));return r}function Er(e,r){for(var t="";t.length<r;)t+=e;return t}function sn(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,f){return t=-t,f}),!isNaN(r=Number(n)))?r/t:r}var nx=["january","february","march","april","may","june","july","august","september","october","november","december"];function cs(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),s=r.getMonth(),f=r.getDate();if(isNaN(f))return t;var u=e.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),u.length>3&&nx.indexOf(u)==-1)return t}else if(u.match(/[a-z]/))return t;return n<0||n>8099?t:(s>0||f>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var ix=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,s){if(e||typeof n=="string")return t.split(n);for(var f=t.split(n),u=[f[0]],x=1;x<f.length;++x)u.push(s),u.push(f[x]);return u}}();function p1(e){return e?e.content&&e.type?Ni(e.content,!0):e.data?Ps(e.data):e.asNodeBuffer&&At?Ps(e.asNodeBuffer().toString("binary")):e.asBinary?Ps(e.asBinary()):e._data&&e._data.getContent?Ps(Ni(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function w1(e){if(!e)return null;if(e.data)return Ml(e.data);if(e.asNodeBuffer&&At)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Ml(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function sx(e){return e&&e.name.slice(-4)===".bin"?w1(e):p1(e)}function Ha(e,r){for(var t=e.FullPaths||Ar(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),f=0;f<t.length;++f){var u=t[f].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==u||s==u)return e.files?e.files[t[f]]:e.FileIndex[f]}return null}function bc(e,r){var t=Ha(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function Mr(e,r,t){if(!t)return sx(bc(e,r));if(!r)return null;try{return Mr(e,r)}catch{return null}}function Ra(e,r,t){if(!t)return p1(bc(e,r));if(!r)return null;try{return Ra(e,r)}catch{return null}}function ox(e,r,t){return w1(bc(e,r))}function Kl(e){for(var r=e.FullPaths||Ar(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function Et(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return At?n=Ln(t):n=Cd(t),Je.utils.cfb_add(e,r,n)}Je.utils.cfb_add(e,r,t)}else e.file(r,t)}function Cc(){return Je.utils.cfb_new()}function v1(e,r){switch(r.type){case"base64":return Je.read(e,{type:"base64"});case"binary":return Je.read(e,{type:"binary"});case"buffer":case"array":return Je.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Ls(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?t.pop():s!=="."&&t.push(s)}return t.join("/")}var Nr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,cx=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ql=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,lx=/<[^>]*>/g,ca=Nr.match(ql)?ql:lx,fx=/<\w*:/,hx=/<(\/?)\w+:/;function ot(e,r,t){for(var n={},s=0,f=0;s!==e.length&&!((f=e.charCodeAt(s))===32||f===10||f===13);++s);if(r||(n[0]=e.slice(0,s)),s===e.length)return n;var u=e.match(cx),x=0,p="",m=0,v="",E="",b=1;if(u)for(m=0;m!=u.length;++m){for(E=u[m],f=0;f!=E.length&&E.charCodeAt(f)!==61;++f);for(v=E.slice(0,f).trim();E.charCodeAt(f+1)==32;)++f;for(b=(s=E.charCodeAt(f+1))==34||s==39?1:0,p=E.slice(f+1+b,E.length-b),x=0;x!=v.length&&v.charCodeAt(x)!==58;++x);if(x===v.length)v.indexOf("_")>0&&(v=v.slice(0,v.indexOf("_"))),n[v]=p,n[v.toLowerCase()]=p;else{var S=(x===5&&v.slice(0,5)==="xmlns"?"xmlns":"")+v.slice(x+1);if(n[S]&&v.slice(x-3,x)=="ext")continue;n[S]=p,n[S.toLowerCase()]=p}}return n}function vn(e){return e.replace(hx,"<$1")}var y1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Tc=Eo(y1),Mt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var s=n+"",f=s.indexOf("<![CDATA[");if(f==-1)return s.replace(e,function(x,p){return y1[x]||String.fromCharCode(parseInt(p,x.indexOf("x")>-1?16:10))||x}).replace(r,function(x,p){return String.fromCharCode(parseInt(p,16))});var u=s.indexOf("]]>");return t(s.slice(0,f))+s.slice(f+9,u)+t(s.slice(u+3))}}(),Sc=/[&<>'"]/g,ux=/[\u0000-\u0008\u000b-\u001f]/g;function Xt(e){var r=e+"";return r.replace(Sc,function(t){return Tc[t]}).replace(ux,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Zl(e){return Xt(e).replace(/ /g,"_x0020_")}var E1=/[\u0000-\u001f]/g;function Nc(e){var r=e+"";return r.replace(Sc,function(t){return Tc[t]}).replace(/\n/g,"<br/>").replace(E1,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function dx(e){var r=e+"";return r.replace(Sc,function(t){return Tc[t]}).replace(E1,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Jl=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function xx(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function cr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Xo(e){for(var r="",t=0,n=0,s=0,f=0,u=0,x=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(s=e.charCodeAt(t++),n>191&&n<224){u=(n&31)<<6,u|=s&63,r+=String.fromCharCode(u);continue}if(f=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(s&63)<<6|f&63);continue}u=e.charCodeAt(t++),x=((n&7)<<18|(s&63)<<12|(f&63)<<6|u&63)-65536,r+=String.fromCharCode(55296+(x>>>10&1023)),r+=String.fromCharCode(56320+(x&1023))}return r}function Ql(e){var r=ri(2*e.length),t,n,s=1,f=0,u=0,x;for(n=0;n<e.length;n+=s)s=1,(x=e.charCodeAt(n))<128?t=x:x<224?(t=(x&31)*64+(e.charCodeAt(n+1)&63),s=2):x<240?(t=(x&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,t=(x&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,u=55296+(t>>>10&1023),t=56320+(t&1023)),u!==0&&(r[f++]=u&255,r[f++]=u>>>8,u=0),r[f++]=t%256,r[f++]=t>>>8;return r.slice(0,f).toString("ucs2")}function $l(e){return Ln(e,"binary").toString("utf8")}var H0="foo bar bazâð£",qt=At&&($l(H0)==Xo(H0)&&$l||Ql(H0)==Xo(H0)&&Ql)||Xo,wn=At?function(e){return Ln(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,s=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(s>>18&7))),r.push(String.fromCharCode(144+(s>>12&63))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Zs=function(){var e={};return function(t,n){var s=t+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),_1=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),gx=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),mx=/<\/?(?:vt:)?variant>/g,px=/<(?:vt:)([^>]*)>([\s\S]*)</;function ef(e,r){var t=ot(e),n=e.match(gx(t.baseType))||[],s=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return s}return n.forEach(function(f){var u=f.replace(mx,"").match(px);u&&s.push({v:qt(u[2]),t:u[1]})}),s}var A1=/(^\s|\s$|\n)/;function Qr(e,r){return"<"+e+(r.match(A1)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Js(e){return Ar(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function je(e,r,t){return"<"+e+(t!=null?Js(t):"")+(r!=null?(r.match(A1)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function nc(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function wx(e,r){switch(typeof e){case"string":var t=je("vt:lpwstr",Xt(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return je((e|0)==e?"vt:i4":"vt:r8",Xt(String(e)));case"boolean":return je("vt:bool",e?"true":"false")}if(e instanceof Date)return je("vt:filetime",nc(e));throw new Error("Unable to serialize "+e)}function kc(e){if(At&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return qt(si(Ec(e)));throw new Error("Bad input format: expected Buffer or string")}var Qs=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,jr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Oi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Fa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function vx(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),s=e[r+6]&15,f=5;f>=0;--f)s=s*256+e[r+f];return n==2047?s==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),t*Math.pow(2,n-52)*s)}function yx(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,s=0,f=0,u=n?-r:r;isFinite(u)?u==0?s=f=0:(s=Math.floor(Math.log(u)/Math.LN2),f=u*Math.pow(2,52-s),s<=-1023&&(!isFinite(f)||f<Math.pow(2,52))?s=-1022:(f-=Math.pow(2,52),s+=1023)):(s=2047,f=isNaN(r)?26985:0);for(var x=0;x<=5;++x,f/=256)e[t+x]=f&255;e[t+6]=(s&15)<<4|f&15,e[t+7]=s>>4|n}var tf=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,f=e[0][n].length;s<f;s+=t)r.push.apply(r,e[0][n].slice(s,s+t));return r},rf=At?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Ln(r)})):tf(e)}:tf,af=function(e,r,t){for(var n=[],s=r;s<t;s+=2)n.push(String.fromCharCode(On(e,s)));return n.join("").replace(ma,"")},Ic=At?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(ma,""):af(e,r,t)}:af,nf=function(e,r,t){for(var n=[],s=r;s<r+t;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},b1=At?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):nf(e,r,t)}:nf,sf=function(e,r,t){for(var n=[],s=r;s<t;s++)n.push(String.fromCharCode(ts(e,s)));return n.join("")},c0=At?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):sf(r,t,n)}:sf,C1=function(e,r){var t=Da(e,r);return t>0?c0(e,r+4,r+4+t-1):""},T1=C1,S1=function(e,r){var t=Da(e,r);return t>0?c0(e,r+4,r+4+t-1):""},N1=S1,k1=function(e,r){var t=2*Da(e,r);return t>0?c0(e,r+4,r+4+t-1):""},I1=k1,F1=function(r,t){var n=Da(r,t);return n>0?Ic(r,t+4,t+4+n):""},D1=F1,O1=function(e,r){var t=Da(e,r);return t>0?c0(e,r+4,r+4+t):""},R1=O1,M1=function(e,r){return vx(e,r)},oo=M1,Fc=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};At&&(T1=function(r,t){if(!Buffer.isBuffer(r))return C1(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},N1=function(r,t){if(!Buffer.isBuffer(r))return S1(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},I1=function(r,t){if(!Buffer.isBuffer(r))return k1(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},D1=function(r,t){if(!Buffer.isBuffer(r))return F1(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},R1=function(r,t){if(!Buffer.isBuffer(r))return O1(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},oo=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):M1(r,t)},Fc=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var ts=function(e,r){return e[r]},On=function(e,r){return e[r+1]*256+e[r]},Ex=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Da=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Ei=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},_x=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function js(e,r){var t="",n,s,f=[],u,x,p,m;switch(r){case"dbcs":if(m=this.l,At&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(p=0;p<e;++p)t+=String.fromCharCode(On(this,m)),m+=2;e*=2;break;case"utf8":t=c0(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Ic(this,this.l,this.l+e);break;case"wstr":return js.call(this,e,"dbcs");case"lpstr-ansi":t=T1(this,this.l),e=4+Da(this,this.l);break;case"lpstr-cp":t=N1(this,this.l),e=4+Da(this,this.l);break;case"lpwstr":t=I1(this,this.l),e=4+2*Da(this,this.l);break;case"lpp4":e=4+Da(this,this.l),t=D1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Da(this,this.l),t=R1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(u=ts(this,this.l+e++))!==0;)f.push(V0(u));t=f.join("");break;case"_wstr":for(e=0,t="";(u=On(this,this.l+e))!==0;)f.push(V0(u)),e+=2;e+=2,t=f.join("");break;case"dbcs-cont":for(t="",m=this.l,p=0;p<e;++p){if(this.lens&&this.lens.indexOf(m)!==-1)return u=ts(this,m),this.l=m+1,x=js.call(this,e-p,u?"dbcs-cont":"sbcs-cont"),f.join("")+x;f.push(V0(On(this,m))),m+=2}t=f.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",m=this.l,p=0;p!=e;++p){if(this.lens&&this.lens.indexOf(m)!==-1)return u=ts(this,m),this.l=m+1,x=js.call(this,e-p,u?"dbcs-cont":"sbcs-cont"),f.join("")+x;f.push(V0(ts(this,m))),m+=1}t=f.join("");break;default:switch(e){case 1:return n=ts(this,this.l),this.l++,n;case 2:return n=(r==="i"?Ex:On)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?Ei:_x)(this,this.l),this.l+=4,n):(s=Da(this,this.l),this.l+=4,s);case 8:case-8:if(r==="f")return e==8?s=oo(this,this.l):s=oo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=b1(this,this.l,e);break}}return this.l+=e,t}var Ax=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},bx=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},Cx=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function Tx(e,r,t){var n=0,s=0;if(t==="dbcs"){for(s=0;s!=r.length;++s)Cx(this,r.charCodeAt(s),this.l+2*s);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255;n=r.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var f=Math.min(this.l+e,this.length);for(s=0;s<Math.min(r.length,e);++s){var u=r.charCodeAt(s);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<f;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,Ax(this,r,this.l);break;case 8:if(n=8,t==="f"){yx(this,r,this.l);break}case 16:break;case-4:n=4,bx(this,r,this.l);break}return this.l+=n,this}function P1(e,r){var t=b1(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Jr(e,r){e.l=r,e.read_shift=js,e.chk=P1,e.write_shift=Tx}function oa(e,r){e.l+=r}function _e(e){var r=ri(e);return Jr(r,0),r}function jn(e,r,t){if(e){var n,s,f;Jr(e,e.l||0);for(var u=e.length,x=0,p=0;e.l<u;){x=e.read_shift(1),x&128&&(x=(x&127)+((e.read_shift(1)&127)<<7));var m=n0[x]||n0[65535];for(n=e.read_shift(1),f=n&127,s=1;s<4&&n&128;++s)f+=((n=e.read_shift(1))&127)<<7*s;p=e.l+f;var v=m.f&&m.f(e,f,t);if(e.l=p,r(v,m,x))return}}}function _a(){var e=[],r=At?256:2048,t=function(m){var v=_e(m);return Jr(v,0),v},n=t(r),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},f=function(m){return n&&m<n.length-n.l?n:(s(),n=t(Math.max(m+1,r)))},u=function(){return s(),Gr(e)},x=function(m){s(),n=m,n.l==null&&(n.l=n.length),f(r)};return{next:f,push:x,end:u,_bufs:e}}function ke(e,r,t,n){var s=+r,f;if(!isNaN(s)){n||(n=n0[s].p||(t||[]).length||0),f=1+(s>=128?1:0)+1,n>=128&&++f,n>=16384&&++f,n>=2097152&&++f;var u=e.next(f);s<=127?u.write_shift(1,s):(u.write_shift(1,(s&127)+128),u.write_shift(1,s>>7));for(var x=0;x!=4;++x)if(n>=128)u.write_shift(1,(n&127)+128),n>>=7;else{u.write_shift(1,n);break}n>0&&Fc(t)&&e.push(t)}}function Us(e,r,t){var n=fr(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function of(e,r,t){var n=fr(e);return n.s=Us(n.s,r.s,t),n.e=Us(n.e,r.s,t),n}function Ws(e,r){if(e.cRel&&e.c<0)for(e=fr(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=fr(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=it(e);return!e.cRel&&e.cRel!=null&&(t=kx(t)),!e.rRel&&e.rRel!=null&&(t=Sx(t)),t}function zo(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+mr(e.s.c)+":"+(e.e.cRel?"":"$")+mr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Sr(e.s.r)+":"+(e.e.rRel?"":"$")+Sr(e.e.r):Ws(e.s,r.biff)+":"+Ws(e.e,r.biff)}function Dc(e){return parseInt(Nx(e),10)-1}function Sr(e){return""+(e+1)}function Sx(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Nx(e){return e.replace(/\$(\d+)$/,"$1")}function Oc(e){for(var r=Ix(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function mr(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function kx(e){return e.replace(/^([A-Z])/,"$$$1")}function Ix(e){return e.replace(/^\$([A-Z])/,"$1")}function Fx(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function pr(e){for(var r=0,t=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?r=10*r+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:r-1}}function it(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Aa(e){var r=e.indexOf(":");return r==-1?{s:pr(e),e:pr(e)}:{s:pr(e.slice(0,r)),e:pr(e.slice(r+1))}}function gt(e,r){return typeof r>"u"||typeof r=="number"?gt(e.s,e.e):(typeof e!="string"&&(e=it(e)),typeof r!="string"&&(r=it(r)),e==r?e:e+":"+r)}function Pt(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,s=0,f=e.length;for(t=0;n<f&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.s.c=--t,t=0;n<f&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;if(r.s.r=--t,n===f||s!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=f&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)t=26*t+s;for(r.e.c=--t,t=0;n!=f&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)t=10*t+s;return r.e.r=--t,r}function cf(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=za(e.z,t?Ur(r):r)}catch{}try{return e.w=za((e.XF||{}).numFmtId||(t?14:0),t?Ur(r):r)}catch{return""+r}}function Bn(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Un[e.v]||e.v:r==null?cf(e,e.v):cf(e,r))}function oi(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function B1(e,r,t){var n=t||{},s=e?Array.isArray(e):n.dense,f=e||(s?[]:{}),u=0,x=0;if(f&&n.origin!=null){if(typeof n.origin=="number")u=n.origin;else{var p=typeof n.origin=="string"?pr(n.origin):n.origin;u=p.r,x=p.c}f["!ref"]||(f["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(f["!ref"]){var v=Pt(f["!ref"]);m.s.c=v.s.c,m.s.r=v.s.r,m.e.c=Math.max(m.e.c,v.e.c),m.e.r=Math.max(m.e.r,v.e.r),u==-1&&(m.e.r=u=v.e.r+1)}for(var E=0;E!=r.length;++E)if(r[E]){if(!Array.isArray(r[E]))throw new Error("aoa_to_sheet expects an array of arrays");for(var b=0;b!=r[E].length;++b)if(!(typeof r[E][b]>"u")){var S={v:r[E][b]},k=u+E,A=x+b;if(m.s.r>k&&(m.s.r=k),m.s.c>A&&(m.s.c=A),m.e.r<k&&(m.e.r=k),m.e.c<A&&(m.e.c=A),r[E][b]&&typeof r[E][b]=="object"&&!Array.isArray(r[E][b])&&!(r[E][b]instanceof Date))S=r[E][b];else if(Array.isArray(S.v)&&(S.f=r[E][b][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(n.nullError)S.t="e",S.v=0;else if(n.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?S.t="n":typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=n.dateNF||at[14],n.cellDates?(S.t="d",S.w=za(S.z,Ur(S.v))):(S.t="n",S.v=Ur(S.v),S.w=za(S.z,S.v))):S.t="s";if(s)f[k]||(f[k]=[]),f[k][A]&&f[k][A].z&&(S.z=f[k][A].z),f[k][A]=S;else{var F=it({c:A,r:k});f[F]&&f[F].z&&(S.z=f[F].z),f[F]=S}}}return m.s.c<1e7&&(f["!ref"]=gt(m)),f}function xs(e,r){return B1(null,e,r)}function Dx(e){return e.read_shift(4,"i")}function on(e,r){return r||(r=_e(4)),r.write_shift(4,e),r}function sa(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Xr(e,r){var t=!1;return r==null&&(t=!0,r=_e(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function Ox(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Rx(e,r){return r||(r=_e(4)),r.write_shift(2,0),r.write_shift(2,0),r}function Rc(e,r){var t=e.l,n=e.read_shift(1),s=sa(e),f=[],u={t:s,h:s};if(n&1){for(var x=e.read_shift(4),p=0;p!=x;++p)f.push(Ox(e));u.r=f}else u.r=[{ich:0,ifnt:0}];return e.l=t+r,u}function Mx(e,r){var t=!1;return r==null&&(t=!0,r=_e(15+4*e.t.length)),r.write_shift(1,0),Xr(e.t,r),t?r.slice(0,r.l):r}var Px=Rc;function Bx(e,r){var t=!1;return r==null&&(t=!0,r=_e(23+4*e.t.length)),r.write_shift(1,1),Xr(e.t,r),r.write_shift(4,1),Rx({},r),t?r.slice(0,r.l):r}function Ya(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Ri(e,r){return r==null&&(r=_e(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Mi(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Pi(e,r){return r==null&&(r=_e(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var Lx=sa,L1=Xr;function Mc(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function co(e,r){var t=!1;return r==null&&(t=!0,r=_e(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var jx=sa,ic=Mc,Pc=co;function Bc(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var s=n===0?oo([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Ei(r,0)>>2;return t?s/100:s}function j1(e,r){r==null&&(r=_e(4));var t=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,t=1),n)r.write_shift(-4,((t?s:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function U1(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function Ux(e,r){return r||(r=_e(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var Bi=U1,gs=Ux;function ia(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ki(e,r){return(r||_e(8)).write_shift(8,e,"f")}function Wx(e){var r={},t=e.read_shift(1),n=t>>>1,s=e.read_shift(1),f=e.read_shift(2,"i"),u=e.read_shift(1),x=e.read_shift(1),p=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=s;var m=Ai[s];m&&(r.rgb=e0(m));break;case 2:r.rgb=e0([u,x,p]);break;case 3:r.theme=s;break}return f!=0&&(r.tint=f>0?f/32767:f/32768),r}function lo(e,r){if(r||(r=_e(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function Vx(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Hx(e,r){r||(r=_e(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}function W1(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function Gx(e){return W1(e,1)}function Xx(e){return W1(e,2)}var Lc=2,Ea=3,G0=11,lf=12,fo=19,X0=64,zx=65,Yx=71,Kx=4108,qx=4126,Hr=80,V1=81,Zx=[Hr,V1],sc={1:{n:"CodePage",t:Lc},2:{n:"Category",t:Hr},3:{n:"PresentationFormat",t:Hr},4:{n:"ByteCount",t:Ea},5:{n:"LineCount",t:Ea},6:{n:"ParagraphCount",t:Ea},7:{n:"SlideCount",t:Ea},8:{n:"NoteCount",t:Ea},9:{n:"HiddenCount",t:Ea},10:{n:"MultimediaClipCount",t:Ea},11:{n:"ScaleCrop",t:G0},12:{n:"HeadingPairs",t:Kx},13:{n:"TitlesOfParts",t:qx},14:{n:"Manager",t:Hr},15:{n:"Company",t:Hr},16:{n:"LinksUpToDate",t:G0},17:{n:"CharacterCount",t:Ea},19:{n:"SharedDoc",t:G0},22:{n:"HyperlinksChanged",t:G0},23:{n:"AppVersion",t:Ea,p:"version"},24:{n:"DigSig",t:zx},26:{n:"ContentType",t:Hr},27:{n:"ContentStatus",t:Hr},28:{n:"Language",t:Hr},29:{n:"Version",t:Hr},255:{},2147483648:{n:"Locale",t:fo},2147483651:{n:"Behavior",t:fo},1919054434:{}},oc={1:{n:"CodePage",t:Lc},2:{n:"Title",t:Hr},3:{n:"Subject",t:Hr},4:{n:"Author",t:Hr},5:{n:"Keywords",t:Hr},6:{n:"Comments",t:Hr},7:{n:"Template",t:Hr},8:{n:"LastAuthor",t:Hr},9:{n:"RevNumber",t:Hr},10:{n:"EditTime",t:X0},11:{n:"LastPrinted",t:X0},12:{n:"CreatedDate",t:X0},13:{n:"ModifiedDate",t:X0},14:{n:"PageCount",t:Ea},15:{n:"WordCount",t:Ea},16:{n:"CharCount",t:Ea},17:{n:"Thumbnail",t:Yx},18:{n:"Application",t:Hr},19:{n:"DocSecurity",t:Ea},255:{},2147483648:{n:"Locale",t:fo},2147483651:{n:"Behavior",t:fo},1919054434:{}},ff={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Jx=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Qx(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var $x=Qx([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ai=fr($x),Un={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},H1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},cc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},z0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function jc(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function eg(e){var r=jc();if(!e||!e.match)return r;var t={};if((e.match(ca)||[]).forEach(function(n){var s=ot(n);switch(s[0].replace(fx,"<")){case"<?xml":break;case"<Types":r.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":r[cc[s.ContentType]]!==void 0&&r[cc[s.ContentType]].push(s.PartName);break}}),r.xmlns!==jr.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}function G1(e,r){var t=ex(cc),n=[],s;n[n.length]=Nr,n[n.length]=je("Types",null,{xmlns:jr.CT,"xmlns:xsd":jr.xsd,"xmlns:xsi":jr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(p){return je("Default",null,{Extension:p[0],ContentType:p[1]})}));var f=function(p){e[p]&&e[p].length>0&&(s=e[p][0],n[n.length]=je("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:z0[p][r.bookType]||z0[p].xlsx}))},u=function(p){(e[p]||[]).forEach(function(m){n[n.length]=je("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:z0[p][r.bookType]||z0[p].xlsx})})},x=function(p){(e[p]||[]).forEach(function(m){n[n.length]=je("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:t[p][0]})})};return f("workbooks"),u("sheets"),u("charts"),x("themes"),["strs","styles"].forEach(f),["coreprops","extprops","custprops"].forEach(x),x("vba"),x("comments"),x("threadedcomments"),x("drawings"),u("metadata"),x("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ct={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $s(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Vs(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(ca)||[]).forEach(function(s){var f=ot(s);if(f[0]==="<Relationship"){var u={};u.Type=f.Type,u.Target=f.Target,u.Id=f.Id,f.TargetMode&&(u.TargetMode=f.TargetMode);var x=f.TargetMode==="External"?f.Target:Ls(f.Target,r);t[x]=u,n[f.Id]=u}}),t["!id"]=n,t}function is(e){var r=[Nr,je("Relationships",null,{xmlns:jr.RELS})];return Ar(e["!id"]).forEach(function(t){r[r.length]=je("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Gt(e,r,t,n,s,f){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,s.Id="rId"+r,s.Type=n,s.Target=t,[Ct.HLINK,Ct.XPATH,Ct.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,r}var tg="application/vnd.oasis.opendocument.spreadsheet";function rg(e,r){for(var t=kc(e),n,s;n=Qs.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(s=ot(n[0],!1),s.path=="/"&&s.type!==tg)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}function ag(e){var r=[Nr];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function hf(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function ng(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function ig(e){var r=[Nr];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(hf(e[t][0],e[t][1])),r.push(ng("",e[t][0]));return r.push(hf("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function X1(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ro.version+"</meta:generator></office:meta></office:document-meta>"}var Xa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],sg=function(){for(var e=new Array(Xa.length),r=0;r<Xa.length;++r){var t=Xa[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function z1(e){var r={};e=qt(e);for(var t=0;t<Xa.length;++t){var n=Xa[t],s=e.match(sg[t]);s!=null&&s.length>0&&(r[n[1]]=Mt(s[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=lr(r[n[1]]))}return r}function Yo(e,r,t,n,s){s[e]!=null||r==null||r===""||(s[e]=r,r=Xt(r),n[n.length]=t?je(e,r,t):Qr(e,r))}function Y1(e,r){var t=r||{},n=[Nr,je("cp:coreProperties",null,{"xmlns:cp":jr.CORE_PROPS,"xmlns:dc":jr.dc,"xmlns:dcterms":jr.dcterms,"xmlns:dcmitype":jr.dcmitype,"xmlns:xsi":jr.xsi})],s={};if(!e&&!t.Props)return n.join("");e&&(e.CreatedDate!=null&&Yo("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:nc(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Yo("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:nc(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var f=0;f!=Xa.length;++f){var u=Xa[f],x=t.Props&&t.Props[u[1]]!=null?t.Props[u[1]]:e?e[u[1]]:null;x===!0?x="1":x===!1?x="0":typeof x=="number"&&(x=String(x)),x!=null&&Yo(u[0],x,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var bi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],K1=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function q1(e,r,t,n){var s=[];if(typeof e=="string")s=ef(e,n);else for(var f=0;f<e.length;++f)s=s.concat(e[f].map(function(v){return{v}}));var u=typeof r=="string"?ef(r,n).map(function(v){return v.v}):r,x=0,p=0;if(u.length>0)for(var m=0;m!==s.length;m+=2){switch(p=+s[m+1].v,s[m].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=p,t.SheetNames=u.slice(x,x+p);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=p,t.DefinedNames=u.slice(x,x+p);break;case"Charts":case"Diagramme":t.Chartsheets=p,t.ChartNames=u.slice(x,x+p);break}x+=p}}function og(e,r,t){var n={};return r||(r={}),e=qt(e),bi.forEach(function(s){var f=(e.match(Zs(s[0]))||[])[1];switch(s[2]){case"string":f&&(r[s[1]]=Mt(f));break;case"bool":r[s[1]]=f==="true";break;case"raw":var u=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));u&&u.length>0&&(n[s[1]]=u[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&q1(n.HeadingPairs,n.TitlesOfParts,r,t),r}function Z1(e){var r=[],t=je;return e||(e={}),e.Application="SheetJS",r[r.length]=Nr,r[r.length]=je("Properties",null,{xmlns:jr.EXT_PROPS,"xmlns:vt":jr.vt}),bi.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Xt(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(r[r.length]=t(n[0],s))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Xt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var cg=/<[^>]+>[^<]*/g;function lg(e,r){var t={},n="",s=e.match(cg);if(s)for(var f=0;f!=s.length;++f){var u=s[f],x=ot(u);switch(x[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Mt(x.name);break;case"</property>":n=null;break;default:if(u.indexOf("<vt:")===0){var p=u.split(">"),m=p[0].slice(4),v=p[1];switch(m){case"lpstr":case"bstr":case"lpwstr":t[n]=Mt(v);break;case"bool":t[n]=cr(v);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(v,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(v);break;case"filetime":case"date":t[n]=lr(v);break;case"cy":case"error":t[n]=Mt(v);break;default:if(m.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",u,m,p)}}else if(u.slice(0,2)!=="</"){if(r.WTF)throw new Error(u)}}}return t}function J1(e){var r=[Nr,je("Properties",null,{xmlns:jr.CUST_PROPS,"xmlns:vt":jr.vt})];if(!e)return r.join("");var t=1;return Ar(e).forEach(function(s){++t,r[r.length]=je("property",wx(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Xt(s)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var lc={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ko;function fg(e,r,t){Ko||(Ko=Eo(lc)),r=Ko[r]||r,e[r]=t}function hg(e,r){var t=[];return Ar(lc).map(function(n){for(var s=0;s<Xa.length;++s)if(Xa[s][1]==n)return Xa[s];for(s=0;s<bi.length;++s)if(bi[s][1]==n)return bi[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(Qr(lc[n[1]]||n[1],s))}}),je("DocumentProperties",t.join(""),{xmlns:Fa.o})}function ug(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Ar(e).forEach(function(f){if(Object.prototype.hasOwnProperty.call(e,f)){for(var u=0;u<Xa.length;++u)if(f==Xa[u][1])return;for(u=0;u<bi.length;++u)if(f==bi[u][1])return;for(u=0;u<t.length;++u)if(f==t[u])return;var x=e[f],p="string";typeof x=="number"?(p="float",x=String(x)):x===!0||x===!1?(p="boolean",x=x?"1":"0"):x=String(x),s.push(je(Zl(f),x,{"dt:dt":p}))}}),r&&Ar(r).forEach(function(f){if(Object.prototype.hasOwnProperty.call(r,f)&&!(e&&Object.prototype.hasOwnProperty.call(e,f))){var u=r[f],x="string";typeof u=="number"?(x="float",u=String(u)):u===!0||u===!1?(x="boolean",u=u?"1":"0"):u instanceof Date?(x="dateTime.tz",u=u.toISOString()):u=String(u),s.push(je(Zl(f),u,{"dt:dt":x}))}}),"<"+n+' xmlns="'+Fa.o+'">'+s.join("")+"</"+n+">"}function Uc(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function dg(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,n=t%Math.pow(2,32),s=(t-n)/Math.pow(2,32);n*=1e7,s*=1e7;var f=n/Math.pow(2,32)|0;f>0&&(n=n%Math.pow(2,32),s+=f);var u=_e(8);return u.write_shift(4,n),u.write_shift(4,s),u}function Q1(e,r,t){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return s}function $1(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function eh(e,r,t){return r===31?$1(e):Q1(e,r,t)}function fc(e,r,t){return eh(e,r,t===!1?0:4)}function xg(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return eh(e,r,0)}function gg(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var s=e.l;t[n]=e.read_shift(0,"lpwstr").replace(ma,""),e.l-s&2&&(e.l+=2)}return t}function mg(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(ma,"");return t}function pg(e){var r=e.l,t=ho(e,V1);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=ho(e,Ea);return[t,n]}function wg(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(pg(e));return t}function uf(e,r){for(var t=e.read_shift(4),n={},s=0;s!=t;++s){var f=e.read_shift(4),u=e.read_shift(4);n[f]=e.read_shift(u,r===1200?"utf16le":"utf8").replace(ma,"").replace(Bs,"!"),r===1200&&u%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function th(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function vg(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function ho(e,r,t){var n=e.read_shift(2),s,f=t||{};if(e.l+=2,r!==lf&&n!==r&&Zx.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===lf?n:r){case 2:return s=e.read_shift(2,"i"),f.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Q1(e,n,4).replace(ma,"");case 31:return $1(e);case 64:return Uc(e);case 65:return th(e);case 71:return vg(e);case 80:return fc(e,n,!f.raw).replace(ma,"");case 81:return xg(e,n).replace(ma,"");case 4108:return wg(e);case 4126:case 4127:return n==4127?gg(e):mg(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function df(e,r){var t=_e(4),n=_e(4);switch(t.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,r);break;case 5:n=_e(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=dg(r);break;case 31:case 80:for(n=_e(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return Gr([t,n])}function xf(e,r){var t=e.l,n=e.read_shift(4),s=e.read_shift(4),f=[],u=0,x=0,p=-1,m={};for(u=0;u!=s;++u){var v=e.read_shift(4),E=e.read_shift(4);f[u]=[v,E+t]}f.sort(function(G,D){return G[1]-D[1]});var b={};for(u=0;u!=s;++u){if(e.l!==f[u][1]){var S=!0;if(u>0&&r)switch(r[f[u-1][0]].t){case 2:e.l+2===f[u][1]&&(e.l+=2,S=!1);break;case 80:e.l<=f[u][1]&&(e.l=f[u][1],S=!1);break;case 4108:e.l<=f[u][1]&&(e.l=f[u][1],S=!1);break}if((!r||u==0)&&e.l<=f[u][1]&&(S=!1,e.l=f[u][1]),S)throw new Error("Read Error: Expected address "+f[u][1]+" at "+e.l+" :"+u)}if(r){var k=r[f[u][0]];if(b[k.n]=ho(e,k.t,{raw:!0}),k.p==="version"&&(b[k.n]=String(b[k.n]>>16)+"."+("0000"+String(b[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(b[k.n]){case 0:b[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:an(x=b[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+b[k.n])}}else if(f[u][0]===1){if(x=b.CodePage=ho(e,Lc),an(x),p!==-1){var A=e.l;e.l=f[p][1],m=uf(e,x),e.l=A}}else if(f[u][0]===0){if(x===0){p=u,e.l=f[u+1][1];continue}m=uf(e,x)}else{var F=m[f[u][0]],V;switch(e[e.l]){case 65:e.l+=4,V=th(e);break;case 30:e.l+=4,V=fc(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,V=fc(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,V=e.read_shift(4,"i");break;case 19:e.l+=4,V=e.read_shift(4);break;case 5:e.l+=4,V=e.read_shift(8,"f");break;case 11:e.l+=4,V=Tr(e,4);break;case 64:e.l+=4,V=lr(Uc(e));break;default:throw new Error("unparsed value: "+e[e.l])}b[F]=V}}return e.l=t+n,b}var rh=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function yg(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function gf(e,r,t){var n=_e(8),s=[],f=[],u=8,x=0,p=_e(8),m=_e(8);if(p.write_shift(4,2),p.write_shift(4,1200),m.write_shift(4,1),f.push(p),s.push(m),u+=8+p.length,!r){m=_e(8),m.write_shift(4,0),s.unshift(m);var v=[_e(4)];for(v[0].write_shift(4,e.length),x=0;x<e.length;++x){var E=e[x][0];for(p=_e(8+2*(E.length+1)+(E.length%2?0:2)),p.write_shift(4,x+2),p.write_shift(4,E.length+1),p.write_shift(0,E,"dbcs");p.l!=p.length;)p.write_shift(1,0);v.push(p)}p=Gr(v),f.unshift(p),u+=8+p.length}for(x=0;x<e.length;++x)if(!(r&&!r[e[x][0]])&&!(rh.indexOf(e[x][0])>-1||K1.indexOf(e[x][0])>-1)&&e[x][1]!=null){var b=e[x][1],S=0;if(r){S=+r[e[x][0]];var k=t[S];if(k.p=="version"&&typeof b=="string"){var A=b.split(".");b=(+A[0]<<16)+(+A[1]||0)}p=df(k.t,b)}else{var F=yg(b);F==-1&&(F=31,b=String(b)),p=df(F,b)}f.push(p),m=_e(8),m.write_shift(4,r?S:2+x),s.push(m),u+=8+p.length}var V=8*(f.length+1);for(x=0;x<f.length;++x)s[x].write_shift(4,V),V+=f[x].length;return n.write_shift(4,u),n.write_shift(4,f.length),Gr([n].concat(s).concat(f))}function mf(e,r,t){var n=e.content;if(!n)return{};Jr(n,0);var s,f,u,x,p=0;n.chk("feff","Byte Order: "),n.read_shift(2);var m=n.read_shift(4),v=n.read_shift(16);if(v!==Je.utils.consts.HEADER_CLSID&&v!==t)throw new Error("Bad PropertySet CLSID "+v);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(f=n.read_shift(16),x=n.read_shift(4),s===1&&x!==n.l)throw new Error("Length mismatch: "+x+" !== "+n.l);s===2&&(u=n.read_shift(16),p=n.read_shift(4));var E=xf(n,r),b={SystemIdentifier:m};for(var S in E)b[S]=E[S];if(b.FMTID=f,s===1)return b;if(p-n.l==2&&(n.l+=2),n.l!==p)throw new Error("Length mismatch 2: "+n.l+" !== "+p);var k;try{k=xf(n,null)}catch{}for(S in k)b[S]=k[S];return b.FMTID=[f,u],b}function pf(e,r,t,n,s,f){var u=_e(s?68:48),x=[u];u.write_shift(2,65534),u.write_shift(2,0),u.write_shift(4,842412599),u.write_shift(16,Je.utils.consts.HEADER_CLSID,"hex"),u.write_shift(4,s?2:1),u.write_shift(16,r,"hex"),u.write_shift(4,s?68:48);var p=gf(e,t,n);if(x.push(p),s){var m=gf(s,null,null);u.write_shift(16,f,"hex"),u.write_shift(4,68+p.length),x.push(m)}return Gr(x)}function $n(e,r){return e.read_shift(r),null}function Eg(e,r){r||(r=_e(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function _g(e,r,t){for(var n=[],s=e.l+r;e.l<s;)n.push(t(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Tr(e,r){return e.read_shift(r)===1}function ga(e,r){return r||(r=_e(2)),r.write_shift(2,+!!e),r}function Pr(e){return e.read_shift(2,"u")}function Ga(e,r){return r||(r=_e(2)),r.write_shift(2,e),r}function ah(e,r){return _g(e,r,Pr)}function Ag(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function nh(e,r,t){return t||(t=_e(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function l0(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var f=e.read_shift(1);f&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var u=n?e.read_shift(n,s):"";return u}function bg(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,s=t&8,f=1+(t&1),u=0,x,p={};s&&(u=e.read_shift(2)),n&&(x=e.read_shift(4));var m=f==2?"dbcs-cont":"sbcs-cont",v=r===0?"":e.read_shift(r,m);return s&&(e.l+=4*u),n&&(e.l+=x),p.t=v,s||(p.raw="<t>"+p.t+"</t>",p.r=p.t),p}function Cg(e){var r=e.t||"",t=_e(3);t.write_shift(2,r.length),t.write_shift(1,1);var n=_e(2*r.length);n.write_shift(2*r.length,r,"utf16le");var s=[t,n];return Gr(s)}function Ii(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function f0(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):Ii(e,n,t)}function Li(e,r,t){if(t.biff>5)return f0(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ih(e,r,t){return t||(t=_e(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function Tg(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function Sg(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var s=e.read_shift((n?r-24:r)>>1,"utf16le").replace(ma,"");return n&&(e.l+=24),s}function Ng(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return t+n.replace(/\\/g,"/");var f=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var u=e.read_shift(f>>1,"utf16le").replace(ma,"");return t+u}function kg(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Sg(e);case"0303000000000000c000000000000046":return Ng(e);default:throw new Error("Unsupported Moniker "+t)}}function Y0(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(ma,""):"";return t}function wf(e,r){r||(r=_e(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function Ig(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var f,u,x,p,m="",v,E;s&16&&(f=Y0(e,t-e.l)),s&128&&(u=Y0(e,t-e.l)),(s&257)===257&&(x=Y0(e,t-e.l)),(s&257)===1&&(p=kg(e,t-e.l)),s&8&&(m=Y0(e,t-e.l)),s&32&&(v=e.read_shift(16)),s&64&&(E=Uc(e)),e.l=t;var b=u||x||p||"";b&&m&&(b+="#"+m),b||(b="#"+m),s&2&&b.charAt(0)=="/"&&b.charAt(1)!="/"&&(b="file://"+b);var S={Target:b};return v&&(S.guid=v),E&&(S.time=E),f&&(S.Tooltip=f),S}function Fg(e){var r=_e(512),t=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),f=s>-1?31:23;switch(n.charAt(0)){case"#":f=28;break;case".":f&=-3;break}r.write_shift(4,2),r.write_shift(4,f);var u=[8,6815827,6619237,4849780,83];for(t=0;t<u.length;++t)r.write_shift(4,u[t]);if(f==28)n=n.slice(1),wf(n,r);else if(f&2){for(u="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<u.length;++t)r.write_shift(1,parseInt(u[t],16));var x=s>-1?n.slice(0,s):n;for(r.write_shift(4,2*(x.length+1)),t=0;t<x.length;++t)r.write_shift(2,x.charCodeAt(t));r.write_shift(2,0),f&8&&wf(s>-1?n.slice(s+1):"",r)}else{for(u="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<u.length;++t)r.write_shift(1,parseInt(u[t],16));for(var p=0;n.slice(p*3,p*3+3)=="../"||n.slice(p*3,p*3+3)=="..\\";)++p;for(r.write_shift(2,p),r.write_shift(4,n.length-3*p+1),t=0;t<n.length-3*p;++t)r.write_shift(1,n.charCodeAt(t+3*p)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function sh(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[r,t,n,s]}function oh(e,r){var t=sh(e);return t[3]=0,t}function yn(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function Fi(e,r,t,n){return n||(n=_e(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function Dg(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function Og(e,r,t){return r===0?"":Li(e,r,t)}function Rg(e,r,t){var n=t.biff>8?4:2,s=e.read_shift(n),f=e.read_shift(n,"i"),u=e.read_shift(n,"i");return[s,f,u]}function ch(e){var r=e.read_shift(2),t=Bc(e);return[r,t]}function Mg(e,r,t){e.l+=4,r-=4;var n=e.l+r,s=l0(e,r,t),f=e.read_shift(2);if(n-=e.l,f!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+f);return e.l+=f,s}function bo(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r},e:{c:s,r:t}}}function lh(e,r){return r||(r=_e(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function fh(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r},e:{c:s,r:t}}}var Pg=fh;function hh(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function Bg(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function Lg(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function ta(e){e.l+=2,e.l+=e.read_shift(2)}var jg={0:ta,4:ta,5:ta,6:ta,7:Lg,8:ta,9:ta,10:ta,11:ta,12:ta,13:Bg,14:ta,15:ta,16:ta,17:ta,18:ta,19:ta,20:ta,21:hh};function Ug(e,r){for(var t=e.l+r,n=[];e.l<t;){var s=e.read_shift(2);e.l-=2;try{n.push(jg[s](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function K0(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function Wc(e,r,t){var n=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var f=_e(s);return f.write_shift(2,n),f.write_shift(2,r),s>4&&f.write_shift(2,29282),s>6&&f.write_shift(2,1997),s>8&&(f.write_shift(2,49161),f.write_shift(2,1),f.write_shift(2,1798),f.write_shift(2,0)),f}function Wg(e,r){return r===0||e.read_shift(2),1200}function Vg(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,s=Li(e,0,t);return e.read_shift(r+n-e.l),s}function Hg(e,r){var t=!r||r.biff==8,n=_e(t?112:54);for(n.write_shift(r.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function Gg(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Xg(e,r,t){var n=e.read_shift(4),s=e.read_shift(1)&3,f=e.read_shift(1);switch(f){case 0:f="Worksheet";break;case 1:f="Macrosheet";break;case 2:f="Chartsheet";break;case 6:f="VBAModule";break}var u=l0(e,0,t);return u.length===0&&(u="Sheet1"),{pos:n,hs:s,dt:f,name:u}}function zg(e,r){var t=!r||r.biff>=8?2:1,n=_e(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function Yg(e,r){for(var t=e.l+r,n=e.read_shift(4),s=e.read_shift(4),f=[],u=0;u!=s&&e.l<t;++u)f.push(bg(e));return f.Count=n,f.Unique=s,f}function Kg(e,r){var t=_e(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=Cg(e[s]);var f=Gr([t].concat(n));return f.parts=[t.length].concat(n.map(function(u){return u.length})),f}function qg(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function Zg(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function Jg(e){var r=Dg(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function Qg(e){return e.read_shift(2),e.read_shift(4)}function vf(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);t&&t.biff==2&&(n=1-(s>>15),s&=32767);var f={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[f,s]}function $g(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),f=e.read_shift(2),u=e.read_shift(2),x=e.read_shift(2),p=e.read_shift(2),m=e.read_shift(2);return{Pos:[r,t],Dim:[n,s],Flags:f,CurTab:u,FirstTab:x,Selected:p,TabRatio:m}}function e2(){var e=_e(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function t2(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function r2(e){var r=_e(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function a2(){}function n2(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=l0(e,0,t),n}function i2(e,r){var t=e.name||"Arial",n=r&&r.biff==5,s=n?15+t.length:16+2*t.length,f=_e(s);return f.write_shift(2,e.sz*20),f.write_shift(4,0),f.write_shift(2,400),f.write_shift(4,0),f.write_shift(2,0),f.write_shift(1,t.length),n||f.write_shift(1,1),f.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),f}function s2(e){var r=yn(e);return r.isst=e.read_shift(4),r}function o2(e,r,t,n){var s=_e(10);return Fi(e,r,n,s),s.write_shift(4,t),s}function c2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,s=yn(e);t.biff==2&&e.l++;var f=f0(e,n-e.l,t);return s.val=f,s}function l2(e,r,t,n,s){var f=!s||s.biff==8,u=_e(8+ +f+(1+f)*t.length);return Fi(e,r,n,u),u.write_shift(2,t.length),f&&u.write_shift(1,1),u.write_shift((1+f)*t.length,t,f?"utf16le":"sbcs"),u}function f2(e,r,t){var n=e.read_shift(2),s=Li(e,0,t);return[n,s]}function h2(e,r,t,n){var s=t&&t.biff==5;n||(n=_e(s?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(s?1:2,r.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le");var f=n.length>n.l?n.slice(0,n.l):n;return f.l==null&&(f.l=f.length),f}var u2=Li;function yf(e,r,t){var n=e.l+r,s=t.biff==8||!t.biff?4:2,f=e.read_shift(s),u=e.read_shift(s),x=e.read_shift(2),p=e.read_shift(2);return e.l=n,{s:{r:f,c:x},e:{r:u,c:p}}}function d2(e,r){var t=r.biff==8||!r.biff?4:2,n=_e(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function x2(e){var r=e.read_shift(2),t=e.read_shift(2),n=ch(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function g2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),s=e.read_shift(2),f=[];e.l<t;)f.push(ch(e));if(e.l!==t)throw new Error("MulRK read error");var u=e.read_shift(2);if(f.length!=u-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:u,rkrec:f}}function m2(e,r){for(var t=e.l+r-2,n=e.read_shift(2),s=e.read_shift(2),f=[];e.l<t;)f.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var u=e.read_shift(2);if(f.length!=u-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:u,ixfe:f}}function p2(e,r,t,n){var s={},f=e.read_shift(4),u=e.read_shift(4),x=e.read_shift(4),p=e.read_shift(2);return s.patternType=Jx[x>>26],n.cellStyles&&(s.alc=f&7,s.fWrap=f>>3&1,s.alcV=f>>4&7,s.fJustLast=f>>7&1,s.trot=f>>8&255,s.cIndent=f>>16&15,s.fShrinkToFit=f>>20&1,s.iReadOrder=f>>22&2,s.fAtrNum=f>>26&1,s.fAtrFnt=f>>27&1,s.fAtrAlc=f>>28&1,s.fAtrBdr=f>>29&1,s.fAtrPat=f>>30&1,s.fAtrProt=f>>31&1,s.dgLeft=u&15,s.dgRight=u>>4&15,s.dgTop=u>>8&15,s.dgBottom=u>>12&15,s.icvLeft=u>>16&127,s.icvRight=u>>23&127,s.grbitDiag=u>>30&3,s.icvTop=x&127,s.icvBottom=x>>7&127,s.icvDiag=x>>14&127,s.dgDiag=x>>21&15,s.icvFore=p&127,s.icvBack=p>>7&127,s.fsxButton=p>>14&1),s}function w2(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=p2(e,r,n.fStyle,t),n}function Ef(e,r,t,n){var s=t&&t.biff==5;n||(n=_e(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var f=0;return e.numFmtId>0&&s&&(f|=1024),n.write_shift(4,f),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function v2(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function y2(e){var r=_e(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function _f(e,r,t){var n=yn(e);(t.biff==2||r==9)&&++e.l;var s=Ag(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function E2(e,r,t,n,s,f){var u=_e(8);return Fi(e,r,n,u),nh(t,f,u),u}function _2(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=yn(e),s=ia(e);return n.val=s,n}function A2(e,r,t,n){var s=_e(14);return Fi(e,r,n,s),ki(t,s),s}var Af=Og;function b2(e,r,t){var n=e.l+r,s=e.read_shift(2),f=e.read_shift(2);if(t.sbcch=f,f==1025||f==14849)return[f,s];if(f<1||f>255)throw new Error("Unexpected SupBook type: "+f);for(var u=Ii(e,f),x=[];n>e.l;)x.push(f0(e));return[f,s,u,x]}function bf(e,r,t){var n=e.read_shift(2),s,f={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(s=Mg(e,r-2,t)),f.body=s||e.read_shift(r-2),typeof s=="string"&&(f.Name=s),f}var C2=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Cf(e,r,t){var n=e.l+r,s=e.read_shift(2),f=e.read_shift(1),u=e.read_shift(1),x=e.read_shift(t&&t.biff==2?1:2),p=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),p=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var m=Ii(e,u,t);s&32&&(m=C2[m.charCodeAt(0)]);var v=n-e.l;t&&t.biff==2&&--v;var E=n==e.l||x===0||!(v>0)?[]:Uv(e,v,t,x);return{chKey:f,Name:m,itab:p,rgce:E}}function uh(e,r,t){if(t.biff<8)return T2(e,r,t);for(var n=[],s=e.l+r,f=e.read_shift(t.biff>8?4:2);f--!==0;)n.push(Rg(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function T2(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=l0(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function S2(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),s=e.read_shift(2),f=Ii(e,n,t),u=Ii(e,s,t);return[f,u]}function N2(e,r,t){var n=fh(e);e.l++;var s=e.read_shift(1);return r-=8,[Wv(e,r,t),s,n]}function Tf(e,r,t){var n=Pg(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,Lv(e,r,t)]}function k2(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function I2(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),f=e.read_shift(2),u=e.read_shift(2),x=Li(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:s},x,u,f]}}function F2(e,r,t){return I2(e,r,t)}function D2(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(bo(e));return t}function O2(e){var r=_e(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)lh(e[t],r);return r}function R2(e,r,t){if(t&&t.biff<8)return P2(e,r,t);var n=hh(e),s=Ug(e,r-22,n[1]);return{cmo:n,ft:s}}var M2={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=t,{fmt:n}}};function P2(e,r,t){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),f=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var u=[];return u.push((M2[n]||oa)(e,r,t)),{cmo:[s,n,f],ft:u}}function B2(e,r,t){var n=e.l,s="";try{e.l+=4;var f=(t.lastobj||{cmo:[0,0]}).cmo[1],u;[0,5,7,11,12,14].indexOf(f)==-1?e.l+=6:u=Tg(e,6,t);var x=e.read_shift(2);e.read_shift(2),Pr(e,2);var p=e.read_shift(2);e.l+=p;for(var m=1;m<e.lens.length-1;++m){if(e.l-n!=e.lens[m])throw new Error("TxO: bad continue record");var v=e[e.l],E=Ii(e,e.lens[m+1]-e.lens[m]-1);if(s+=E,s.length>=(v?x:2*x))break}if(s.length!==x&&s.length!==x*2)throw new Error("cchText: "+x+" != "+s.length);return e.l=n+r,{t:s}}catch{return e.l=n+r,{t:s}}}function L2(e,r){var t=bo(e);e.l+=16;var n=Ig(e,r-24);return[t,n]}function j2(e){var r=_e(24),t=pr(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)r.write_shift(1,parseInt(n[s],16));return Gr([r,Fg(e[1])])}function U2(e,r){e.read_shift(2);var t=bo(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(ma,""),[t,n]}function W2(e){var r=e[1].Tooltip,t=_e(10+2*(r.length+1));t.write_shift(2,2048);var n=pr(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var s=0;s<r.length;++s)t.write_shift(2,r.charCodeAt(s));return t.write_shift(2,0),t}function V2(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=ff[t]||t,t=e.read_shift(2),r[1]=ff[t]||t,r}function H2(e){return e||(e=_e(4)),e.write_shift(2,1),e.write_shift(2,1),e}function G2(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(oh(e));return t}function X2(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(oh(e));return t}function z2(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function dh(e,r,t){if(!t.cellStyles)return oa(e,r);var n=t&&t.biff>=12?4:2,s=e.read_shift(n),f=e.read_shift(n),u=e.read_shift(n),x=e.read_shift(n),p=e.read_shift(2);n==2&&(e.l+=2);var m={s,e:f,w:u,ixfe:x,flags:p};return(t.biff>=5||!t.biff)&&(m.level=p>>8&7),m}function Y2(e,r){var t=_e(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),n=e.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function K2(e,r){var t={};return r<32||(e.l+=16,t.header=ia(e),t.footer=ia(e),e.l+=2),t}function q2(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function Z2(e){for(var r=_e(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}var J2=yn,Q2=ah,$2=f0;function em(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function tm(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=yn(e);++e.l;var s=Li(e,r-7,t);return n.t="str",n.val=s,n}function rm(e){var r=yn(e);++e.l;var t=ia(e);return r.t="n",r.val=t,r}function am(e,r,t){var n=_e(15);return x0(n,e,r),n.write_shift(8,t,"f"),n}function nm(e){var r=yn(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function im(e,r,t){var n=_e(9);return x0(n,e,r),n.write_shift(2,t),n}function sm(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function om(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function cm(e,r,t){var n=e.l+r,s=yn(e),f=e.read_shift(2),u=Ii(e,f,t);return e.l=n,s.t="str",s.val=u,s}var lm=[2,3,48,49,131,139,140,245],hc=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Eo({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(x,p){var m=[],v=ri(1);switch(p.type){case"base64":v=Oa(Ma(x));break;case"binary":v=Oa(x);break;case"buffer":case"array":v=x;break}Jr(v,0);var E=v.read_shift(1),b=!!(E&136),S=!1,k=!1;switch(E){case 2:break;case 3:break;case 48:S=!0,b=!0;break;case 49:S=!0,b=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+E.toString(16))}var A=0,F=521;E==2&&(A=v.read_shift(2)),v.l+=3,E!=2&&(A=v.read_shift(4)),A>1048576&&(A=1e6),E!=2&&(F=v.read_shift(2));var V=v.read_shift(2),G=p.codepage||1252;E!=2&&(v.l+=16,v.read_shift(1),v[v.l]!==0&&(G=e[v[v.l]]),v.l+=1,v.l+=2),k&&(v.l+=36);for(var D=[],J={},ie=Math.min(v.length,E==2?521:F-10-(S?264:0)),Q=k?32:11;v.l<ie&&v[v.l]!=13;)switch(J={},J.name=Ys.utils.decode(G,v.slice(v.l,v.l+Q)).replace(/[\u0000\r\n].*$/g,""),v.l+=Q,J.type=String.fromCharCode(v.read_shift(1)),E!=2&&!k&&(J.offset=v.read_shift(4)),J.len=v.read_shift(1),E==2&&(J.offset=v.read_shift(2)),J.dec=v.read_shift(1),J.name.length&&D.push(J),E!=2&&(v.l+=k?13:14),J.type){case"B":(!S||J.len!=8)&&p.WTF&&console.log("Skipping "+J.name+":"+J.type);break;case"G":case"P":p.WTF&&console.log("Skipping "+J.name+":"+J.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+J.type)}if(v[v.l]!==13&&(v.l=F-1),v.read_shift(1)!==13)throw new Error("DBF Terminator not found "+v.l+" "+v[v.l]);v.l=F;var M=0,ne=0;for(m[0]=[],ne=0;ne!=D.length;++ne)m[0][ne]=D[ne].name;for(;A-- >0;){if(v[v.l]===42){v.l+=V;continue}for(++v.l,m[++M]=[],ne=0,ne=0;ne!=D.length;++ne){var X=v.slice(v.l,v.l+D[ne].len);v.l+=D[ne].len,Jr(X,0);var me=Ys.utils.decode(G,X);switch(D[ne].type){case"C":me.trim().length&&(m[M][ne]=me.replace(/\s+$/,""));break;case"D":me.length===8?m[M][ne]=new Date(+me.slice(0,4),+me.slice(4,6)-1,+me.slice(6,8)):m[M][ne]=me;break;case"F":m[M][ne]=parseFloat(me.trim());break;case"+":case"I":m[M][ne]=k?X.read_shift(-4,"i")^2147483648:X.read_shift(4,"i");break;case"L":switch(me.trim().toUpperCase()){case"Y":case"T":m[M][ne]=!0;break;case"N":case"F":m[M][ne]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+me+"|")}break;case"M":if(!b)throw new Error("DBF Unexpected MEMO for type "+E.toString(16));m[M][ne]="##MEMO##"+(k?parseInt(me.trim(),10):X.read_shift(4));break;case"N":me=me.replace(/\u0000/g,"").trim(),me&&me!="."&&(m[M][ne]=+me||0);break;case"@":m[M][ne]=new Date(X.read_shift(-8,"f")-621356832e5);break;case"T":m[M][ne]=new Date((X.read_shift(4)-2440588)*864e5+X.read_shift(4));break;case"Y":m[M][ne]=X.read_shift(4,"i")/1e4+X.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[M][ne]=-X.read_shift(-8,"f");break;case"B":if(S&&D[ne].len==8){m[M][ne]=X.read_shift(8,"f");break}case"G":case"P":X.l+=D[ne].len;break;case"0":if(D[ne].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+D[ne].type)}}}if(E!=2&&v.l<v.length&&v[v.l++]!=26)throw new Error("DBF EOF Marker missing "+(v.l-1)+" of "+v.length+" "+v[v.l-1].toString(16));return p&&p.sheetRows&&(m=m.slice(0,p.sheetRows)),p.DBF=D,m}function n(x,p){var m=p||{};m.dateNF||(m.dateNF="yyyymmdd");var v=xs(t(x,m),m);return v["!cols"]=m.DBF.map(function(E){return{wch:E.len,DBF:E}}),delete m.DBF,v}function s(x,p){try{return oi(n(x,p),p)}catch(m){if(p&&p.WTF)throw m}return{SheetNames:[],Sheets:{}}}var f={B:8,C:250,L:1,D:8,"?":0,"":0};function u(x,p){var m=p||{};if(+m.codepage>=0&&an(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var v=_a(),E=go(x,{header:1,raw:!0,cellDates:!0}),b=E[0],S=E.slice(1),k=x["!cols"]||[],A=0,F=0,V=0,G=1;for(A=0;A<b.length;++A){if(((k[A]||{}).DBF||{}).name){b[A]=k[A].DBF.name,++V;continue}if(b[A]!=null){if(++V,typeof b[A]=="number"&&(b[A]=b[A].toString(10)),typeof b[A]!="string")throw new Error("DBF Invalid column name "+b[A]+" |"+typeof b[A]+"|");if(b.indexOf(b[A])!==A){for(F=0;F<1024;++F)if(b.indexOf(b[A]+"_"+F)==-1){b[A]+="_"+F;break}}}}var D=Pt(x["!ref"]),J=[],ie=[],Q=[];for(A=0;A<=D.e.c-D.s.c;++A){var M="",ne="",X=0,me=[];for(F=0;F<S.length;++F)S[F][A]!=null&&me.push(S[F][A]);if(me.length==0||b[A]==null){J[A]="?";continue}for(F=0;F<me.length;++F){switch(typeof me[F]){case"number":ne="B";break;case"string":ne="C";break;case"boolean":ne="L";break;case"object":ne=me[F]instanceof Date?"D":"C";break;default:ne="C"}X=Math.max(X,String(me[F]).length),M=M&&M!=ne?"C":ne}X>250&&(X=250),ne=((k[A]||{}).DBF||{}).type,ne=="C"&&k[A].DBF.len>X&&(X=k[A].DBF.len),M=="B"&&ne=="N"&&(M="N",Q[A]=k[A].DBF.dec,X=k[A].DBF.len),ie[A]=M=="C"||ne=="N"?X:f[M]||0,G+=ie[A],J[A]=M}var le=v.next(32);for(le.write_shift(4,318902576),le.write_shift(4,S.length),le.write_shift(2,296+32*V),le.write_shift(2,G),A=0;A<4;++A)le.write_shift(4,0);for(le.write_shift(4,0|(+r[r1]||3)<<8),A=0,F=0;A<b.length;++A)if(b[A]!=null){var ee=v.next(32),pe=(b[A].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ee.write_shift(1,pe,"sbcs"),ee.write_shift(1,J[A]=="?"?"C":J[A],"sbcs"),ee.write_shift(4,F),ee.write_shift(1,ie[A]||f[J[A]]||0),ee.write_shift(1,Q[A]||0),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(1,0),ee.write_shift(4,0),ee.write_shift(4,0),F+=ie[A]||f[J[A]]||0}var Pe=v.next(264);for(Pe.write_shift(4,13),A=0;A<65;++A)Pe.write_shift(4,0);for(A=0;A<S.length;++A){var re=v.next(G);for(re.write_shift(1,0),F=0;F<b.length;++F)if(b[F]!=null)switch(J[F]){case"L":re.write_shift(1,S[A][F]==null?63:S[A][F]?84:70);break;case"B":re.write_shift(8,S[A][F]||0,"f");break;case"N":var Le="0";for(typeof S[A][F]=="number"&&(Le=S[A][F].toFixed(Q[F]||0)),V=0;V<ie[F]-Le.length;++V)re.write_shift(1,32);re.write_shift(1,Le,"sbcs");break;case"D":S[A][F]?(re.write_shift(4,("0000"+S[A][F].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(S[A][F].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+S[A][F].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var be=String(S[A][F]!=null?S[A][F]:"").slice(0,ie[F]);for(re.write_shift(1,be,"sbcs"),V=0;V<ie[F]-be.length;++V)re.write_shift(1,32);break}}return v.next(1).write_shift(1,26),v.end()}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),xh=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Ar(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(b,S){var k=e[S];return typeof k=="number"?Pl(k):k},n=function(b,S,k){var A=S.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return A==59?b:Pl(A)};e["|"]=254;function s(b,S){switch(S.type){case"base64":return f(Ma(b),S);case"binary":return f(b,S);case"buffer":return f(At&&Buffer.isBuffer(b)?b.toString("binary"):si(b),S);case"array":return f(Ni(b),S)}throw new Error("Unrecognized type "+S.type)}function f(b,S){var k=b.split(/[\n\r]+/),A=-1,F=-1,V=0,G=0,D=[],J=[],ie=null,Q={},M=[],ne=[],X=[],me=0,le;for(+S.codepage>=0&&an(+S.codepage);V!==k.length;++V){me=0;var ee=k[V].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),pe=ee.replace(/;;/g,"\0").split(";").map(function(N){return N.replace(/\u0000/g,";")}),Pe=pe[0],re;if(ee.length>0)switch(Pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":pe[1].charAt(0)=="P"&&J.push(ee.slice(3).replace(/;;/g,";"));break;case"C":var Le=!1,be=!1,St=!1,ue=!1,Ye=-1,Qe=-1;for(G=1;G<pe.length;++G)switch(pe[G].charAt(0)){case"A":break;case"X":F=parseInt(pe[G].slice(1))-1,be=!0;break;case"Y":for(A=parseInt(pe[G].slice(1))-1,be||(F=0),le=D.length;le<=A;++le)D[le]=[];break;case"K":re=pe[G].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(sn(re))?isNaN(cs(re).getDate())||(re=lr(re)):(re=sn(re),ie!==null&&us(ie)&&(re=Ao(re))),Le=!0;break;case"E":ue=!0;var K=ss(pe[G].slice(1),{r:A,c:F});D[A][F]=[D[A][F],K];break;case"S":St=!0,D[A][F]=[D[A][F],"S5S"];break;case"G":break;case"R":Ye=parseInt(pe[G].slice(1))-1;break;case"C":Qe=parseInt(pe[G].slice(1))-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ee)}if(Le&&(D[A][F]&&D[A][F].length==2?D[A][F][0]=re:D[A][F]=re,ie=null),St){if(ue)throw new Error("SYLK shared formula cannot have own formula");var ae=Ye>-1&&D[Ye][Qe];if(!ae||!ae[1])throw new Error("SYLK shared formula cannot find base");D[A][F][1]=Dh(ae[1],{r:A-Ye,c:F-Qe})}break;case"F":var z=0;for(G=1;G<pe.length;++G)switch(pe[G].charAt(0)){case"X":F=parseInt(pe[G].slice(1))-1,++z;break;case"Y":for(A=parseInt(pe[G].slice(1))-1,le=D.length;le<=A;++le)D[le]=[];break;case"M":me=parseInt(pe[G].slice(1))/20;break;case"F":break;case"G":break;case"P":ie=J[parseInt(pe[G].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(X=pe[G].slice(1).split(" "),le=parseInt(X[0],10);le<=parseInt(X[1],10);++le)me=parseInt(X[2],10),ne[le-1]=me===0?{hidden:!0}:{wch:me},ai(ne[le-1]);break;case"C":F=parseInt(pe[G].slice(1))-1,ne[F]||(ne[F]={});break;case"R":A=parseInt(pe[G].slice(1))-1,M[A]||(M[A]={}),me>0?(M[A].hpt=me,M[A].hpx=fs(me)):me===0&&(M[A].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ee)}z<1&&(ie=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ee)}}return M.length>0&&(Q["!rows"]=M),ne.length>0&&(Q["!cols"]=ne),S&&S.sheetRows&&(D=D.slice(0,S.sheetRows)),[D,Q]}function u(b,S){var k=s(b,S),A=k[0],F=k[1],V=xs(A,S);return Ar(F).forEach(function(G){V[G]=F[G]}),V}function x(b,S){return oi(u(b,S),S)}function p(b,S,k,A){var F="C;Y"+(k+1)+";X"+(A+1)+";K";switch(b.t){case"n":F+=b.v||0,b.f&&!b.F&&(F+=";E"+Yc(b.f,{r:k,c:A}));break;case"b":F+=b.v?"TRUE":"FALSE";break;case"e":F+=b.w||b.v;break;case"d":F+='"'+(b.w||b.v)+'"';break;case"s":F+='"'+b.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return F}function m(b,S){S.forEach(function(k,A){var F="F;W"+(A+1)+" "+(A+1)+" ";k.hidden?F+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=t0(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=r0(k.wpx)),typeof k.wch=="number"&&(F+=Math.round(k.wch))),F.charAt(F.length-1)!=" "&&b.push(F)})}function v(b,S){S.forEach(function(k,A){var F="F;";k.hidden?F+="M0;":k.hpt?F+="M"+20*k.hpt+";":k.hpx&&(F+="M"+20*a0(k.hpx)+";"),F.length>2&&b.push(F+"R"+(A+1))})}function E(b,S){var k=["ID;PWXL;N;E"],A=[],F=Pt(b["!ref"]),V,G=Array.isArray(b),D=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),b["!cols"]&&m(k,b["!cols"]),b["!rows"]&&v(k,b["!rows"]),k.push("B;Y"+(F.e.r-F.s.r+1)+";X"+(F.e.c-F.s.c+1)+";D"+[F.s.c,F.s.r,F.e.c,F.e.r].join(" "));for(var J=F.s.r;J<=F.e.r;++J)for(var ie=F.s.c;ie<=F.e.c;++ie){var Q=it({r:J,c:ie});V=G?(b[J]||[])[ie]:b[Q],!(!V||V.v==null&&(!V.f||V.F))&&A.push(p(V,b,J,ie))}return k.join(D)+D+A.join(D)+D+"E"+D}return{to_workbook:x,to_sheet:u,from_sheet:E}}(),gh=function(){function e(f,u){switch(u.type){case"base64":return r(Ma(f),u);case"binary":return r(f,u);case"buffer":return r(At&&Buffer.isBuffer(f)?f.toString("binary"):si(f),u);case"array":return r(Ni(f),u)}throw new Error("Unrecognized type "+u.type)}function r(f,u){for(var x=f.split(`
`),p=-1,m=-1,v=0,E=[];v!==x.length;++v){if(x[v].trim()==="BOT"){E[++p]=[],m=0;continue}if(!(p<0)){var b=x[v].trim().split(","),S=b[0],k=b[1];++v;for(var A=x[v]||"";(A.match(/["]/g)||[]).length&1&&v<x.length-1;)A+=`
`+x[++v];switch(A=A.trim(),+S){case-1:if(A==="BOT"){E[++p]=[],m=0;continue}else if(A!=="EOD")throw new Error("Unrecognized DIF special command "+A);break;case 0:A==="TRUE"?E[p][m]=!0:A==="FALSE"?E[p][m]=!1:isNaN(sn(k))?isNaN(cs(k).getDate())?E[p][m]=k:E[p][m]=lr(k):E[p][m]=sn(k),++m;break;case 1:A=A.slice(1,A.length-1),A=A.replace(/""/g,'"'),A&&A.match(/^=".*"$/)&&(A=A.slice(2,-1)),E[p][m++]=A!==""?A:null;break}if(A==="EOD")break}}return u&&u.sheetRows&&(E=E.slice(0,u.sheetRows)),E}function t(f,u){return xs(e(f,u),u)}function n(f,u){return oi(t(f,u),u)}var s=function(){var f=function(p,m,v,E,b){p.push(m),p.push(v+","+E),p.push('"'+b.replace(/"/g,'""')+'"')},u=function(p,m,v,E){p.push(m+","+v),p.push(m==1?'"'+E.replace(/"/g,'""')+'"':E)};return function(p){var m=[],v=Pt(p["!ref"]),E,b=Array.isArray(p);f(m,"TABLE",0,1,"sheetjs"),f(m,"VECTORS",0,v.e.r-v.s.r+1,""),f(m,"TUPLES",0,v.e.c-v.s.c+1,""),f(m,"DATA",0,0,"");for(var S=v.s.r;S<=v.e.r;++S){u(m,-1,0,"BOT");for(var k=v.s.c;k<=v.e.c;++k){var A=it({r:S,c:k});if(E=b?(p[S]||[])[k]:p[A],!E){u(m,1,0,"");continue}switch(E.t){case"n":var F=E.w;!F&&E.v!=null&&(F=E.v),F==null?E.f&&!E.F?u(m,1,0,"="+E.f):u(m,1,0,""):u(m,0,F,"V");break;case"b":u(m,0,E.v?1:0,E.v?"TRUE":"FALSE");break;case"s":u(m,1,0,isNaN(E.v)?E.v:'="'+E.v+'"');break;case"d":E.w||(E.w=za(E.z||at[14],Ur(lr(E.v)))),u(m,0,E.w,"V");break;default:u(m,1,0,"")}}}u(m,-1,0,"EOD");var V=`\r
`,G=m.join(V);return G}}();return{to_workbook:n,to_sheet:t,from_sheet:s}}(),mh=function(){function e(E){return E.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(E){return E.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(E,b){for(var S=E.split(`
`),k=-1,A=-1,F=0,V=[];F!==S.length;++F){var G=S[F].trim().split(":");if(G[0]==="cell"){var D=pr(G[1]);if(V.length<=D.r)for(k=V.length;k<=D.r;++k)V[k]||(V[k]=[]);switch(k=D.r,A=D.c,G[2]){case"t":V[k][A]=e(G[3]);break;case"v":V[k][A]=+G[3];break;case"vtf":var J=G[G.length-1];case"vtc":switch(G[3]){case"nl":V[k][A]=!!+G[4];break;default:V[k][A]=+G[4];break}G[2]=="vtf"&&(V[k][A]=[V[k][A],J])}}}return b&&b.sheetRows&&(V=V.slice(0,b.sheetRows)),V}function n(E,b){return xs(t(E,b),b)}function s(E,b){return oi(n(E,b),b)}var f=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,x=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),p="--SocialCalcSpreadsheetControlSave--";function m(E){if(!E||!E["!ref"])return"";for(var b=[],S=[],k,A="",F=Aa(E["!ref"]),V=Array.isArray(E),G=F.s.r;G<=F.e.r;++G)for(var D=F.s.c;D<=F.e.c;++D)if(A=it({r:G,c:D}),k=V?(E[G]||[])[D]:E[A],!(!k||k.v==null||k.t==="z")){switch(S=["cell",A,"t"],k.t){case"s":case"str":S.push(r(k.v));break;case"n":k.f?(S[2]="vtf",S[3]="n",S[4]=k.v,S[5]=r(k.f)):(S[2]="v",S[3]=k.v);break;case"b":S[2]="vt"+(k.f?"f":"c"),S[3]="nl",S[4]=k.v?"1":"0",S[5]=r(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var J=Ur(lr(k.v));S[2]="vtc",S[3]="nd",S[4]=""+J,S[5]=k.w||za(k.z||at[14],J);break;case"e":continue}b.push(S.join(":"))}return b.push("sheet:c:"+(F.e.c-F.s.c+1)+":r:"+(F.e.r-F.s.r+1)+":tvf:1"),b.push("valueformat:1:text-wiki"),b.join(`
`)}function v(E){return[f,u,x,u,m(E),p].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:v}}(),ls=function(){function e(v,E,b,S,k){k.raw?E[b][S]=v:v===""||(v==="TRUE"?E[b][S]=!0:v==="FALSE"?E[b][S]=!1:isNaN(sn(v))?isNaN(cs(v).getDate())?E[b][S]=v:E[b][S]=lr(v):E[b][S]=sn(v))}function r(v,E){var b=E||{},S=[];if(!v||v.length===0)return S;for(var k=v.split(/[\r\n]/),A=k.length-1;A>=0&&k[A].length===0;)--A;for(var F=10,V=0,G=0;G<=A;++G)V=k[G].indexOf(" "),V==-1?V=k[G].length:V++,F=Math.max(F,V);for(G=0;G<=A;++G){S[G]=[];var D=0;for(e(k[G].slice(0,F).trim(),S,G,D,b),D=1;D<=(k[G].length-F)/10+1;++D)e(k[G].slice(F+(D-1)*10,F+D*10).trim(),S,G,D,b)}return b.sheetRows&&(S=S.slice(0,b.sheetRows)),S}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(v){for(var E={},b=!1,S=0,k=0;S<v.length;++S)(k=v.charCodeAt(S))==34?b=!b:!b&&k in t&&(E[k]=(E[k]||0)+1);k=[];for(S in E)Object.prototype.hasOwnProperty.call(E,S)&&k.push([E[S],S]);if(!k.length){E=n;for(S in E)Object.prototype.hasOwnProperty.call(E,S)&&k.push([E[S],S])}return k.sort(function(A,F){return A[0]-F[0]||n[A[1]]-n[F[1]]}),t[k.pop()[1]]||44}function f(v,E){var b=E||{},S="",k=b.dense?[]:{},A={s:{c:0,r:0},e:{c:0,r:0}};v.slice(0,4)=="sep="?v.charCodeAt(5)==13&&v.charCodeAt(6)==10?(S=v.charAt(4),v=v.slice(7)):v.charCodeAt(5)==13||v.charCodeAt(5)==10?(S=v.charAt(4),v=v.slice(6)):S=s(v.slice(0,1024)):b&&b.FS?S=b.FS:S=s(v.slice(0,1024));var F=0,V=0,G=0,D=0,J=0,ie=S.charCodeAt(0),Q=!1,M=0,ne=v.charCodeAt(0);v=v.replace(/\r\n/mg,`
`);var X=b.dateNF!=null?qd(b.dateNF):null;function me(){var le=v.slice(D,J),ee={};if(le.charAt(0)=='"'&&le.charAt(le.length-1)=='"'&&(le=le.slice(1,-1).replace(/""/g,'"')),le.length===0)ee.t="z";else if(b.raw)ee.t="s",ee.v=le;else if(le.trim().length===0)ee.t="s",ee.v=le;else if(le.charCodeAt(0)==61)le.charCodeAt(1)==34&&le.charCodeAt(le.length-1)==34?(ee.t="s",ee.v=le.slice(2,-1).replace(/""/g,'"')):bw(le)?(ee.t="n",ee.f=le.slice(1)):(ee.t="s",ee.v=le);else if(le=="TRUE")ee.t="b",ee.v=!0;else if(le=="FALSE")ee.t="b",ee.v=!1;else if(!isNaN(G=sn(le)))ee.t="n",b.cellText!==!1&&(ee.w=le),ee.v=G;else if(!isNaN(cs(le).getDate())||X&&le.match(X)){ee.z=b.dateNF||at[14];var pe=0;X&&le.match(X)&&(le=Zd(le,b.dateNF,le.match(X)||[]),pe=1),b.cellDates?(ee.t="d",ee.v=lr(le,pe)):(ee.t="n",ee.v=Ur(lr(le,pe))),b.cellText!==!1&&(ee.w=za(ee.z,ee.v instanceof Date?Ur(ee.v):ee.v)),b.cellNF||delete ee.z}else ee.t="s",ee.v=le;if(ee.t=="z"||(b.dense?(k[F]||(k[F]=[]),k[F][V]=ee):k[it({c:V,r:F})]=ee),D=J+1,ne=v.charCodeAt(D),A.e.c<V&&(A.e.c=V),A.e.r<F&&(A.e.r=F),M==ie)++V;else if(V=0,++F,b.sheetRows&&b.sheetRows<=F)return!0}e:for(;J<v.length;++J)switch(M=v.charCodeAt(J)){case 34:ne===34&&(Q=!Q);break;case ie:case 10:case 13:if(!Q&&me())break e;break}return J-D>0&&me(),k["!ref"]=gt(A),k}function u(v,E){return!(E&&E.PRN)||E.FS||v.slice(0,4)=="sep="||v.indexOf("	")>=0||v.indexOf(",")>=0||v.indexOf(";")>=0?f(v,E):xs(r(v,E),E)}function x(v,E){var b="",S=E.type=="string"?[0,0,0,0]:tl(v,E);switch(E.type){case"base64":b=Ma(v);break;case"binary":b=v;break;case"buffer":E.codepage==65001?b=v.toString("utf8"):E.codepage&&typeof Ys<"u"||(b=At&&Buffer.isBuffer(v)?v.toString("binary"):si(v));break;case"array":b=Ni(v);break;case"string":b=v;break;default:throw new Error("Unrecognized type "+E.type)}return S[0]==239&&S[1]==187&&S[2]==191?b=qt(b.slice(3)):E.type!="string"&&E.type!="buffer"&&E.codepage==65001?b=qt(b):E.type=="binary"&&typeof Ys<"u",b.slice(0,19)=="socialcalc:version:"?mh.to_sheet(E.type=="string"?b:qt(b),E):u(b,E)}function p(v,E){return oi(x(v,E),E)}function m(v){for(var E=[],b=Pt(v["!ref"]),S,k=Array.isArray(v),A=b.s.r;A<=b.e.r;++A){for(var F=[],V=b.s.c;V<=b.e.c;++V){var G=it({r:A,c:V});if(S=k?(v[A]||[])[V]:v[G],!S||S.v==null){F.push("          ");continue}for(var D=(S.w||(Bn(S),S.w)||"").slice(0,10);D.length<10;)D+=" ";F.push(D+(V===0?" ":""))}E.push(F.join(""))}return E.join(`
`)}return{to_workbook:p,to_sheet:x,from_sheet:m}}();function fm(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var s=xh.to_workbook(e,t);return t.WTF=n,s}catch(f){if(t.WTF=n,!f.message.match(/SYLK bad record ID/)&&n)throw f;return ls.to_workbook(e,r)}}var Ci=function(){function e(K,ae,z){if(K){Jr(K,K.l||0);for(var N=z.Enum||Ye;K.l<K.length;){var B=K.read_shift(2),Ne=N[B]||N[65535],we=K.read_shift(2),ve=K.l+we,Ae=Ne.f&&Ne.f(K,we,z);if(K.l=ve,ae(Ae,Ne,B))return}}}function r(K,ae){switch(ae.type){case"base64":return t(Oa(Ma(K)),ae);case"binary":return t(Oa(K),ae);case"buffer":case"array":return t(K,ae)}throw"Unsupported type "+ae.type}function t(K,ae){if(!K)return K;var z=ae||{},N=z.dense?[]:{},B="Sheet1",Ne="",we=0,ve={},Ae=[],Xe=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Ke=z.sheetRows||0;if(K[2]==0&&(K[3]==8||K[3]==9)&&K.length>=16&&K[14]==5&&K[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(K[2]==2)z.Enum=Ye,e(K,function(Me,tt,nt){switch(nt){case 0:z.vers=Me,Me>=4096&&(z.qpro=!0);break;case 6:Z=Me;break;case 204:Me&&(Ne=Me);break;case 222:Ne=Me;break;case 15:case 51:z.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:nt==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=z.dateNF||at[14],z.cellDates&&(Me[1].t="d",Me[1].v=Ao(Me[1].v))),z.qpro&&Me[3]>we&&(N["!ref"]=gt(Z),ve[B]=N,Ae.push(B),N=z.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},we=Me[3],B=Ne||"Sheet"+(we+1),Ne="");var $r=z.dense?(N[Me[0].r]||[])[Me[0].c]:N[it(Me[0])];if($r){$r.t=Me[1].t,$r.v=Me[1].v,Me[1].z!=null&&($r.z=Me[1].z),Me[1].f!=null&&($r.f=Me[1].f);break}z.dense?(N[Me[0].r]||(N[Me[0].r]=[]),N[Me[0].r][Me[0].c]=Me[1]):N[it(Me[0])]=Me[1];break}},z);else if(K[2]==26||K[2]==14)z.Enum=Qe,K[2]==14&&(z.qpro=!0,K.l=0),e(K,function(Me,tt,nt){switch(nt){case 204:B=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>we&&(N["!ref"]=gt(Z),ve[B]=N,Ae.push(B),N=z.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},we=Me[3],B="Sheet"+(we+1)),Ke>0&&Me[0].r>=Ke)break;z.dense?(N[Me[0].r]||(N[Me[0].r]=[]),N[Me[0].r][Me[0].c]=Me[1]):N[it(Me[0])]=Me[1],Z.e.c<Me[0].c&&(Z.e.c=Me[0].c),Z.e.r<Me[0].r&&(Z.e.r=Me[0].r);break;case 27:Me[14e3]&&(Xe[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Xe[Me[0]]=Me[1],Me[0]==we&&(B=Me[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+K[2]);if(N["!ref"]=gt(Z),ve[Ne||B]=N,Ae.push(Ne||B),!Xe.length)return{SheetNames:Ae,Sheets:ve};for(var xt={},_t=[],ct=0;ct<Xe.length;++ct)ve[Ae[ct]]?(_t.push(Xe[ct]||Ae[ct]),xt[Xe[ct]]=ve[Xe[ct]]||ve[Ae[ct]]):(_t.push(Xe[ct]),xt[Xe[ct]]={"!ref":"A1"});return{SheetNames:_t,Sheets:xt}}function n(K,ae){var z=ae||{};if(+z.codepage>=0&&an(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var N=_a(),B=Pt(K["!ref"]),Ne=Array.isArray(K),we=[];Ue(N,0,f(1030)),Ue(N,6,p(B));for(var ve=Math.min(B.e.r,8191),Ae=B.s.r;Ae<=ve;++Ae)for(var Xe=Sr(Ae),Z=B.s.c;Z<=B.e.c;++Z){Ae===B.s.r&&(we[Z]=mr(Z));var Ke=we[Z]+Xe,xt=Ne?(K[Ae]||[])[Z]:K[Ke];if(!(!xt||xt.t=="z"))if(xt.t=="n")(xt.v|0)==xt.v&&xt.v>=-32768&&xt.v<=32767?Ue(N,13,S(Ae,Z,xt.v)):Ue(N,14,A(Ae,Z,xt.v));else{var _t=Bn(xt);Ue(N,15,E(Ae,Z,_t.slice(0,239)))}}return Ue(N,1),N.end()}function s(K,ae){var z=ae||{};if(+z.codepage>=0&&an(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var N=_a();Ue(N,0,u(K));for(var B=0,Ne=0;B<K.SheetNames.length;++B)(K.Sheets[K.SheetNames[B]]||{})["!ref"]&&Ue(N,27,ue(K.SheetNames[B],Ne++));var we=0;for(B=0;B<K.SheetNames.length;++B){var ve=K.Sheets[K.SheetNames[B]];if(!(!ve||!ve["!ref"])){for(var Ae=Pt(ve["!ref"]),Xe=Array.isArray(ve),Z=[],Ke=Math.min(Ae.e.r,8191),xt=Ae.s.r;xt<=Ke;++xt)for(var _t=Sr(xt),ct=Ae.s.c;ct<=Ae.e.c;++ct){xt===Ae.s.r&&(Z[ct]=mr(ct));var Me=Z[ct]+_t,tt=Xe?(ve[xt]||[])[ct]:ve[Me];if(!(!tt||tt.t=="z"))if(tt.t=="n")Ue(N,23,me(xt,ct,we,tt.v));else{var nt=Bn(tt);Ue(N,22,M(xt,ct,we,nt.slice(0,239)))}}++we}}return Ue(N,1),N.end()}function f(K){var ae=_e(2);return ae.write_shift(2,K),ae}function u(K){var ae=_e(26);ae.write_shift(2,4096),ae.write_shift(2,4),ae.write_shift(4,0);for(var z=0,N=0,B=0,Ne=0;Ne<K.SheetNames.length;++Ne){var we=K.SheetNames[Ne],ve=K.Sheets[we];if(!(!ve||!ve["!ref"])){++B;var Ae=Aa(ve["!ref"]);z<Ae.e.r&&(z=Ae.e.r),N<Ae.e.c&&(N=Ae.e.c)}}return z>8191&&(z=8191),ae.write_shift(2,z),ae.write_shift(1,B),ae.write_shift(1,N),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(1,1),ae.write_shift(1,2),ae.write_shift(4,0),ae.write_shift(4,0),ae}function x(K,ae,z){var N={s:{c:0,r:0},e:{c:0,r:0}};return ae==8&&z.qpro?(N.s.c=K.read_shift(1),K.l++,N.s.r=K.read_shift(2),N.e.c=K.read_shift(1),K.l++,N.e.r=K.read_shift(2),N):(N.s.c=K.read_shift(2),N.s.r=K.read_shift(2),ae==12&&z.qpro&&(K.l+=2),N.e.c=K.read_shift(2),N.e.r=K.read_shift(2),ae==12&&z.qpro&&(K.l+=2),N.s.c==65535&&(N.s.c=N.e.c=N.s.r=N.e.r=0),N)}function p(K){var ae=_e(8);return ae.write_shift(2,K.s.c),ae.write_shift(2,K.s.r),ae.write_shift(2,K.e.c),ae.write_shift(2,K.e.r),ae}function m(K,ae,z){var N=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(N[0].c=K.read_shift(1),N[3]=K.read_shift(1),N[0].r=K.read_shift(2),K.l+=2):(N[2]=K.read_shift(1),N[0].c=K.read_shift(2),N[0].r=K.read_shift(2)),N}function v(K,ae,z){var N=K.l+ae,B=m(K,ae,z);if(B[1].t="s",z.vers==20768){K.l++;var Ne=K.read_shift(1);return B[1].v=K.read_shift(Ne,"utf8"),B}return z.qpro&&K.l++,B[1].v=K.read_shift(N-K.l,"cstr"),B}function E(K,ae,z){var N=_e(7+z.length);N.write_shift(1,255),N.write_shift(2,ae),N.write_shift(2,K),N.write_shift(1,39);for(var B=0;B<N.length;++B){var Ne=z.charCodeAt(B);N.write_shift(1,Ne>=128?95:Ne)}return N.write_shift(1,0),N}function b(K,ae,z){var N=m(K,ae,z);return N[1].v=K.read_shift(2,"i"),N}function S(K,ae,z){var N=_e(7);return N.write_shift(1,255),N.write_shift(2,ae),N.write_shift(2,K),N.write_shift(2,z,"i"),N}function k(K,ae,z){var N=m(K,ae,z);return N[1].v=K.read_shift(8,"f"),N}function A(K,ae,z){var N=_e(13);return N.write_shift(1,255),N.write_shift(2,ae),N.write_shift(2,K),N.write_shift(8,z,"f"),N}function F(K,ae,z){var N=K.l+ae,B=m(K,ae,z);if(B[1].v=K.read_shift(8,"f"),z.qpro)K.l=N;else{var Ne=K.read_shift(2);J(K.slice(K.l,K.l+Ne),B),K.l+=Ne}return B}function V(K,ae,z){var N=ae&32768;return ae&=-32769,ae=(N?K:0)+(ae>=8192?ae-16384:ae),(N?"":"$")+(z?mr(ae):Sr(ae))}var G={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},D=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function J(K,ae){Jr(K,0);for(var z=[],N=0,B="",Ne="",we="",ve="";K.l<K.length;){var Ae=K[K.l++];switch(Ae){case 0:z.push(K.read_shift(8,"f"));break;case 1:Ne=V(ae[0].c,K.read_shift(2),!0),B=V(ae[0].r,K.read_shift(2),!1),z.push(Ne+B);break;case 2:{var Xe=V(ae[0].c,K.read_shift(2),!0),Z=V(ae[0].r,K.read_shift(2),!1);Ne=V(ae[0].c,K.read_shift(2),!0),B=V(ae[0].r,K.read_shift(2),!1),z.push(Xe+Z+":"+Ne+B)}break;case 3:if(K.l<K.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(K.read_shift(2));break;case 6:{for(var Ke="";Ae=K[K.l++];)Ke+=String.fromCharCode(Ae);z.push('"'+Ke.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:ve=z.pop(),we=z.pop(),z.push(["AND","OR"][Ae-20]+"("+we+","+ve+")");break;default:if(Ae<32&&D[Ae])ve=z.pop(),we=z.pop(),z.push(we+D[Ae]+ve);else if(G[Ae]){if(N=G[Ae][1],N==69&&(N=K[K.l++]),N>z.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+z.join("|")+"|");return}var xt=z.slice(-N);z.length-=N,z.push(G[Ae][0]+"("+xt.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}z.length==1?ae[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function ie(K){var ae=[{c:0,r:0},{t:"n",v:0},0];return ae[0].r=K.read_shift(2),ae[3]=K[K.l++],ae[0].c=K[K.l++],ae}function Q(K,ae){var z=ie(K);return z[1].t="s",z[1].v=K.read_shift(ae-4,"cstr"),z}function M(K,ae,z,N){var B=_e(6+N.length);B.write_shift(2,K),B.write_shift(1,z),B.write_shift(1,ae),B.write_shift(1,39);for(var Ne=0;Ne<N.length;++Ne){var we=N.charCodeAt(Ne);B.write_shift(1,we>=128?95:we)}return B.write_shift(1,0),B}function ne(K,ae){var z=ie(K);z[1].v=K.read_shift(2);var N=z[1].v>>1;if(z[1].v&1)switch(N&7){case 0:N=(N>>3)*5e3;break;case 1:N=(N>>3)*500;break;case 2:N=(N>>3)/20;break;case 3:N=(N>>3)/200;break;case 4:N=(N>>3)/2e3;break;case 5:N=(N>>3)/2e4;break;case 6:N=(N>>3)/16;break;case 7:N=(N>>3)/64;break}return z[1].v=N,z}function X(K,ae){var z=ie(K),N=K.read_shift(4),B=K.read_shift(4),Ne=K.read_shift(2);if(Ne==65535)return N===0&&B===3221225472?(z[1].t="e",z[1].v=15):N===0&&B===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var we=Ne&32768;return Ne=(Ne&32767)-16446,z[1].v=(1-we*2)*(B*Math.pow(2,Ne+32)+N*Math.pow(2,Ne)),z}function me(K,ae,z,N){var B=_e(14);if(B.write_shift(2,K),B.write_shift(1,z),B.write_shift(1,ae),N==0)return B.write_shift(4,0),B.write_shift(4,0),B.write_shift(2,65535),B;var Ne=0,we=0,ve=0,Ae=0;return N<0&&(Ne=1,N=-N),we=Math.log2(N)|0,N/=Math.pow(2,we-31),Ae=N>>>0,Ae&2147483648||(N/=2,++we,Ae=N>>>0),N-=Ae,Ae|=2147483648,Ae>>>=0,N*=Math.pow(2,32),ve=N>>>0,B.write_shift(4,ve),B.write_shift(4,Ae),we+=16383+(Ne?32768:0),B.write_shift(2,we),B}function le(K,ae){var z=X(K);return K.l+=ae-14,z}function ee(K,ae){var z=ie(K),N=K.read_shift(4);return z[1].v=N>>6,z}function pe(K,ae){var z=ie(K),N=K.read_shift(8,"f");return z[1].v=N,z}function Pe(K,ae){var z=pe(K);return K.l+=ae-10,z}function re(K,ae){return K[K.l+ae-1]==0?K.read_shift(ae,"cstr"):""}function Le(K,ae){var z=K[K.l++];z>ae-1&&(z=ae-1);for(var N="";N.length<z;)N+=String.fromCharCode(K[K.l++]);return N}function be(K,ae,z){if(!(!z.qpro||ae<21)){var N=K.read_shift(1);K.l+=17,K.l+=1,K.l+=2;var B=K.read_shift(ae-21,"cstr");return[N,B]}}function St(K,ae){for(var z={},N=K.l+ae;K.l<N;){var B=K.read_shift(2);if(B==14e3){for(z[B]=[0,""],z[B][0]=K.read_shift(2);K[K.l];)z[B][1]+=String.fromCharCode(K[K.l]),K.l++;K.l++}}return z}function ue(K,ae){var z=_e(5+K.length);z.write_shift(2,14e3),z.write_shift(2,ae);for(var N=0;N<K.length;++N){var B=K.charCodeAt(N);z[z.l++]=B>127?95:B}return z[z.l++]=0,z}var Ye={0:{n:"BOF",f:Pr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:x},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:b},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:v},16:{n:"FORMULA",f:F},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:v},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:Le},65535:{n:""}},Qe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Q},23:{n:"NUMBER17",f:X},24:{n:"NUMBER18",f:ne},25:{n:"FORMULA19",f:le},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:St},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ee},38:{n:"??"},39:{n:"NUMBER27",f:pe},40:{n:"FORMULA28",f:Pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:be},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:r}}();function hm(e){var r={},t=e.match(ca),n=0,s=!1;if(t)for(;n!=t.length;++n){var f=ot(t[n]);switch(f[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!f.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(f.val=="1")break;r.cp=wc[parseInt(f.val,10)];break;case"<outline":if(!f.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=f.val;break;case"<sz":r.sz=f.val;break;case"<strike":if(!f.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!f.val)break;switch(f.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(f.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(f.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":f.rgb&&(r.color=f.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=f.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=f.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(f[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+f[0])}}return r}var um=function(){var e=Zs("t"),r=Zs("rPr");function t(f){var u=f.match(e);if(!u)return{t:"s",v:""};var x={t:"s",v:Mt(u[1])},p=f.match(r);return p&&(x.s=hm(p[1])),x}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(u){return u.replace(n,"").split(s).map(t).filter(function(x){return x.v})}}(),dm=function(){var r=/(\r\n|\n)/g;function t(s,f,u){var x=[];s.u&&x.push("text-decoration: underline;"),s.uval&&x.push("text-underline-style:"+s.uval+";"),s.sz&&x.push("font-size:"+s.sz+"pt;"),s.outline&&x.push("text-effect: outline;"),s.shadow&&x.push("text-shadow: auto;"),f.push('<span style="'+x.join("")+'">'),s.b&&(f.push("<b>"),u.push("</b>")),s.i&&(f.push("<i>"),u.push("</i>")),s.strike&&(f.push("<s>"),u.push("</s>"));var p=s.valign||"";return p=="superscript"||p=="super"?p="sup":p=="subscript"&&(p="sub"),p!=""&&(f.push("<"+p+">"),u.push("</"+p+">")),u.push("</span>"),s}function n(s){var f=[[],s.v,[]];return s.v?(s.s&&t(s.s,f[0],f[2]),f[0].join("")+f[1].replace(r,"<br/>")+f[2].join("")):""}return function(f){return f.map(n).join("")}}(),xm=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,gm=/<(?:\w+:)?r>/,mm=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Vc(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Mt(qt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=qt(e),t&&(n.h=Nc(n.t))):e.match(gm)&&(n.r=qt(e),n.t=Mt(qt((e.replace(mm,"").match(xm)||[]).join("").replace(ca,""))),t&&(n.h=dm(um(n.r)))),n):{t:""}}var pm=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,wm=/<(?:\w+:)?(?:si|sstItem)>/g,vm=/<\/(?:\w+:)?(?:si|sstItem)>/;function ym(e,r){var t=[],n="";if(!e)return t;var s=e.match(pm);if(s){n=s[2].replace(wm,"").split(vm);for(var f=0;f!=n.length;++f){var u=Vc(n[f].trim(),r);u!=null&&(t[t.length]=u)}s=ot(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}var Em=/^\s|\s$|[\t\n\r]/;function ph(e,r){if(!r.bookSST)return"";var t=[Nr];t[t.length]=je("sst",null,{xmlns:Oi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],f="<si>";s.r?f+=s.r:(f+="<t",s.t||(s.t=""),s.t.match(Em)&&(f+=' xml:space="preserve"'),f+=">"+Xt(s.t)+"</t>"),f+="</si>",t[t.length]=f}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function _m(e){return[e.read_shift(4),e.read_shift(4)]}function Am(e,r){var t=[],n=!1;return jn(e,function(f,u,x){switch(x){case 159:t.Count=f[0],t.Unique=f[1];break;case 19:t.push(f);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(u.T,!n||r.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}),t}function bm(e,r){return r||(r=_e(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var Cm=Mx;function Tm(e){var r=_a();ke(r,159,bm(e));for(var t=0;t<e.length;++t)ke(r,19,Cm(e[t]));return ke(r,160),r.end()}function wh(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Pn(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function Sm(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Pn(e,4),r.U=Pn(e,4),r.W=Pn(e,4),r}function Nm(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},s=e.read_shift(4),f=[];s-- >0;)f.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=f,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function km(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(Nm(e));return r}function Im(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function Fm(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Pn(e,4),r.U=Pn(e,4),r.W=Pn(e,4),r}function Dm(e){var r=Fm(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function vh(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function yh(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function Om(e){var r=Pn(e);switch(r.Minor){case 2:return[r.Minor,Rm(e)];case 3:return[r.Minor,Mm()];case 4:return[r.Minor,Pm(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function Rm(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=vh(e,t),s=yh(e,e.length-e.l);return{t:"Std",h:n,v:s}}function Mm(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Pm(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(ca,function(f){var u=ot(f);switch(vn(u[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(x){n[x]=u[x]});break;case"<dataIntegrity":n.encryptedHmacKey=u.encryptedHmacKey,n.encryptedHmacValue=u.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=u.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(u);break;default:throw u[0]}}),n}function Bm(e,r){var t={},n=t.EncryptionVersionInfo=Pn(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var s=e.read_shift(4);return r-=4,t.EncryptionHeader=vh(e,s),r-=s,t.EncryptionVerifier=yh(e,r),t}function Lm(e){var r={},t=r.EncryptionVersionInfo=Pn(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function Hc(e){var r=0,t,n=wh(e),s=n.length+1,f,u,x,p,m;for(t=ri(s),t[0]=n.length,f=1;f!=s;++f)t[f]=n[f-1];for(f=s-1;f>=0;--f)u=t[f],x=r&16384?1:0,p=r<<1&32767,m=x|p,r=m^u;return r^52811}var Eh=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(u){return(u/2|u*128)&255},s=function(u,x){return n(u^x)},f=function(u){for(var x=r[u.length-1],p=104,m=u.length-1;m>=0;--m)for(var v=u[m],E=0;E!=7;++E)v&64&&(x^=t[p]),v*=2,--p;return x};return function(u){for(var x=wh(u),p=f(x),m=x.length,v=ri(16),E=0;E!=16;++E)v[E]=0;var b,S,k;for((m&1)===1&&(b=p>>8,v[m]=s(e[0],b),--m,b=p&255,S=x[x.length-1],v[m]=s(S,b));m>0;)--m,b=p>>8,v[m]=s(x[m],b),--m,b=p&255,v[m]=s(x[m],b);for(m=15,k=15-x.length;k>0;)b=p>>8,v[m]=s(e[k],b),--m,--k,b=p&255,v[m]=s(x[m],b),--m,--k;return v}}(),jm=function(e,r,t,n,s){s||(s=r),n||(n=Eh(e));var f,u;for(f=0;f!=r.length;++f)u=r[f],u^=n[t],u=(u>>5|u<<3)&255,s[f]=u,++t;return[s,t,n]},Um=function(e){var r=0,t=Eh(e);return function(n){var s=jm("",n,r,t);return r=s[1],s[0]}};function Wm(e,r,t,n){var s={key:Pr(e),verificationBytes:Pr(e)};return t.password&&(s.verifier=Hc(t.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Um(t.password)),s}function Vm(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Lm(e):n.Data=Bm(e,r),n}function Hm(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?Vm(e,r-2,n):Wm(e,t.biff>=8?r:r-2,t,n),n}var _h=function(){function e(s,f){switch(f.type){case"base64":return r(Ma(s),f);case"binary":return r(s,f);case"buffer":return r(At&&Buffer.isBuffer(s)?s.toString("binary"):si(s),f);case"array":return r(Ni(s),f)}throw new Error("Unrecognized type "+f.type)}function r(s,f){var u=f||{},x=u.dense?[]:{},p=s.match(/\\trowd.*?\\row\b/g);if(!p.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:p.length-1}};return p.forEach(function(v,E){Array.isArray(x)&&(x[E]=[]);for(var b=/\\\w+\b/g,S=0,k,A=-1;k=b.exec(v);){switch(k[0]){case"\\cell":var F=v.slice(S,b.lastIndex-k[0].length);if(F[0]==" "&&(F=F.slice(1)),++A,F.length){var V={v:F,t:"s"};Array.isArray(x)?x[E][A]=V:x[it({r:E,c:A})]=V}break}S=b.lastIndex}A>m.e.c&&(m.e.c=A)}),x["!ref"]=gt(m),x}function t(s,f){return oi(e(s,f),f)}function n(s){for(var f=["{\\rtf1\\ansi"],u=Pt(s["!ref"]),x,p=Array.isArray(s),m=u.s.r;m<=u.e.r;++m){f.push("\\trowd\\trautofit1");for(var v=u.s.c;v<=u.e.c;++v)f.push("\\cellx"+(v+1));for(f.push("\\pard\\intbl"),v=u.s.c;v<=u.e.c;++v){var E=it({r:m,c:v});x=p?(s[m]||[])[v]:s[E],!(!x||x.v==null&&(!x.f||x.F))&&(f.push(" "+(x.w||(Bn(x),x.w))),f.push("\\cell"))}f.push("\\pard\\intbl\\row")}return f.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function Gm(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function e0(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Xm(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,s=Math.max(r,t,n),f=Math.min(r,t,n),u=s-f;if(u===0)return[0,0,r];var x=0,p=0,m=s+f;switch(p=u/(m>1?2-m:m),s){case r:x=((t-n)/u+6)%6;break;case t:x=(n-r)/u+2;break;case n:x=(r-t)/u+4;break}return[x/6,p,m/2]}function zm(e){var r=e[0],t=e[1],n=e[2],s=t*2*(n<.5?n:1-n),f=n-s/2,u=[f,f,f],x=6*r,p;if(t!==0)switch(x|0){case 0:case 6:p=s*x,u[0]+=s,u[1]+=p;break;case 1:p=s*(2-x),u[0]+=p,u[1]+=s;break;case 2:p=s*(x-2),u[1]+=s,u[2]+=p;break;case 3:p=s*(4-x),u[1]+=p,u[2]+=s;break;case 4:p=s*(x-4),u[2]+=s,u[0]+=p;break;case 5:p=s*(6-x),u[2]+=p,u[0]+=s;break}for(var m=0;m!=3;++m)u[m]=Math.round(u[m]*255);return u}function uo(e,r){if(r===0)return e;var t=Xm(Gm(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),e0(zm(t))}var Ah=6,Ym=15,Km=1,na=Ah;function t0(e){return Math.floor((e+Math.round(128/na)/256)*na)}function r0(e){return Math.floor((e-5)/na*100+.5)/100}function xo(e){return Math.round((e*na+5)/na*256)/256}function qo(e){return xo(r0(t0(e)))}function Gc(e){var r=Math.abs(e-qo(e)),t=na;if(r>.005)for(na=Km;na<Ym;++na)Math.abs(e-qo(e))<=r&&(r=Math.abs(e-qo(e)),t=na);na=t}function ai(e){e.width?(e.wpx=t0(e.width),e.wch=r0(e.wpx),e.MDW=na):e.wpx?(e.wch=r0(e.wpx),e.width=xo(e.wch),e.MDW=na):typeof e.wch=="number"&&(e.width=xo(e.wch),e.wpx=t0(e.width),e.MDW=na),e.customWidth&&delete e.customWidth}var qm=96,bh=qm;function a0(e){return e*96/bh}function fs(e){return e*bh/96}var Zm={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Jm(e,r,t,n){r.Borders=[];var s={},f=!1;(e[0].match(ca)||[]).forEach(function(u){var x=ot(u);switch(vn(x[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},x.diagonalUp&&(s.diagonalUp=cr(x.diagonalUp)),x.diagonalDown&&(s.diagonalDown=cr(x.diagonalDown)),r.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(n&&n.WTF&&!f)throw new Error("unrecognized "+x[0]+" in borders")}})}function Qm(e,r,t,n){r.Fills=[];var s={},f=!1;(e[0].match(ca)||[]).forEach(function(u){var x=ot(u);switch(vn(x[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},r.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":x.patternType&&(s.patternType=x.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),x.indexed&&(s.bgColor.indexed=parseInt(x.indexed,10)),x.theme&&(s.bgColor.theme=parseInt(x.theme,10)),x.tint&&(s.bgColor.tint=parseFloat(x.tint)),x.rgb&&(s.bgColor.rgb=x.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),x.theme&&(s.fgColor.theme=parseInt(x.theme,10)),x.tint&&(s.fgColor.tint=parseFloat(x.tint)),x.rgb!=null&&(s.fgColor.rgb=x.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(n&&n.WTF&&!f)throw new Error("unrecognized "+x[0]+" in fills")}})}function $m(e,r,t,n){r.Fonts=[];var s={},f=!1;(e[0].match(ca)||[]).forEach(function(u){var x=ot(u);switch(vn(x[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(s),s={};break;case"<name":x.val&&(s.name=qt(x.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=x.val?cr(x.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=x.val?cr(x.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(x.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=x.val?cr(x.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=x.val?cr(x.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=x.val?cr(x.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=x.val?cr(x.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=x.val?cr(x.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":x.val&&(s.sz=+x.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":x.val&&(s.vertAlign=x.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":x.val&&(s.family=parseInt(x.val,10));break;case"<family/>":case"</family>":break;case"<scheme":x.val&&(s.scheme=x.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(x.val=="1")break;x.codepage=wc[parseInt(x.val,10)];break;case"<color":if(s.color||(s.color={}),x.auto&&(s.color.auto=cr(x.auto)),x.rgb)s.color.rgb=x.rgb.slice(-6);else if(x.indexed){s.color.index=parseInt(x.indexed,10);var p=Ai[s.color.index];s.color.index==81&&(p=Ai[1]),p||(p=Ai[1]),s.color.rgb=p[0].toString(16)+p[1].toString(16)+p[2].toString(16)}else x.theme&&(s.color.theme=parseInt(x.theme,10),x.tint&&(s.color.tint=parseFloat(x.tint)),x.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=uo(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":f=!0;break;case"</AlternateContent>":f=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(n&&n.WTF&&!f)throw new Error("unrecognized "+x[0]+" in fonts")}})}function ep(e,r,t){r.NumberFmt=[];for(var n=Ar(at),s=0;s<n.length;++s)r.NumberFmt[n[s]]=at[n[s]];var f=e[0].match(ca);if(f)for(s=0;s<f.length;++s){var u=ot(f[s]);switch(vn(u[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var x=Mt(qt(u.formatCode)),p=parseInt(u.numFmtId,10);if(r.NumberFmt[p]=x,p>0){if(p>392){for(p=392;p>60&&r.NumberFmt[p]!=null;--p);r.NumberFmt[p]=x}Mn(x,p)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+u[0]+" in numFmts")}}}function tp(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)e[n]!=null&&(r[r.length]=je("numFmt",null,{numFmtId:n,formatCode:Xt(e[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=je("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var q0=["numFmtId","fillId","fontId","borderId","xfId"],Z0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function rp(e,r,t){r.CellXf=[];var n,s=!1;(e[0].match(ca)||[]).forEach(function(f){var u=ot(f),x=0;switch(vn(u[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=u,delete n[0],x=0;x<q0.length;++x)n[q0[x]]&&(n[q0[x]]=parseInt(n[q0[x]],10));for(x=0;x<Z0.length;++x)n[Z0[x]]&&(n[Z0[x]]=cr(n[Z0[x]]));if(r.NumberFmt&&n.numFmtId>392){for(x=392;x>60;--x)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[x]){n.numFmtId=x;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var p={};u.vertical&&(p.vertical=u.vertical),u.horizontal&&(p.horizontal=u.horizontal),u.textRotation!=null&&(p.textRotation=u.textRotation),u.indent&&(p.indent=u.indent),u.wrapText&&(p.wrapText=cr(u.wrapText)),n.alignment=p;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+u[0]+" in cellXfs")}})}function ap(e){var r=[];return r[r.length]=je("cellXfs",null),e.forEach(function(t){r[r.length]=je("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=je("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var np=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,f=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(x,p,m){var v={};if(!x)return v;x=x.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var E;return(E=x.match(r))&&ep(E,v,m),(E=x.match(s))&&$m(E,v,p,m),(E=x.match(n))&&Qm(E,v,p,m),(E=x.match(f))&&Jm(E,v,p,m),(E=x.match(t))&&rp(E,v,m),v}}();function Ch(e,r){var t=[Nr,je("styleSheet",null,{xmlns:Oi[0],"xmlns:vt":jr.vt})],n;return e.SSF&&(n=tp(e.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=ap(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function ip(e,r){var t=e.read_shift(2),n=sa(e);return[t,n]}function sp(e,r,t){t||(t=_e(6+4*r.length)),t.write_shift(2,e),Xr(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function op(e,r,t){var n={};n.sz=e.read_shift(2)/20;var s=Vx(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var f=e.read_shift(2);switch(f===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var u=e.read_shift(1);u!=0&&(n.underline=u);var x=e.read_shift(1);x>0&&(n.family=x);var p=e.read_shift(1);switch(p>0&&(n.charset=p),e.l++,n.color=Wx(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=sa(e),n}function cp(e,r){r||(r=_e(25+4*32)),r.write_shift(2,e.sz*20),Hx(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),lo(e.color,r);var n=0;return n=2,r.write_shift(1,n),Xr(e.name,r),r.length>r.l?r.slice(0,r.l):r}var lp=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Zo,fp=oa;function Sf(e,r){r||(r=_e(4*3+8*7+16*1)),Zo||(Zo=Eo(lp));var t=Zo[e.patternType];t==null&&(t=40),r.write_shift(4,t);var n=0;if(t!=40)for(lo({auto:1},r),lo({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function hp(e,r){var t=e.l+r,n=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:s}}function Th(e,r,t){t||(t=_e(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Ms(e,r){return r||(r=_e(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var up=oa;function dp(e,r){return r||(r=_e(51)),r.write_shift(1,0),Ms(null,r),Ms(null,r),Ms(null,r),Ms(null,r),Ms(null,r),r.length>r.l?r.slice(0,r.l):r}function xp(e,r){return r||(r=_e(12+4*10)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),co(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function gp(e,r,t){var n=_e(2052);return n.write_shift(4,e),co(r,n),co(t,n),n.length>n.l?n.slice(0,n.l):n}function mp(e,r,t){var n={};n.NumberFmt=[];for(var s in at)n.NumberFmt[s]=at[s];n.CellXf=[],n.Fonts=[];var f=[],u=!1;return jn(e,function(p,m,v){switch(v){case 44:n.NumberFmt[p[0]]=p[1],Mn(p[1],p[0]);break;case 43:n.Fonts.push(p),p.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(p.color.rgb=uo(r.themeElements.clrScheme[p.color.theme].rgb,p.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:f[f.length-1]==617&&n.CellXf.push(p);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:f.push(v),u=!0;break;case 38:f.pop(),u=!1;break;default:if(m.T>0)f.push(v);else if(m.T<0)f.pop();else if(!u||t.WTF&&f[f.length-1]!=37)throw new Error("Unexpected record 0x"+v.toString(16))}}),n}function pp(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&++t}),t!=0&&(ke(e,615,on(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&ke(e,44,sp(s,r[s]))}),ke(e,616))}}function wp(e){var r=1;ke(e,611,on(r)),ke(e,43,cp({sz:12,color:{theme:1},name:"Calibri",family:2})),ke(e,612)}function vp(e){var r=2;ke(e,603,on(r)),ke(e,45,Sf({patternType:"none"})),ke(e,45,Sf({patternType:"gray125"})),ke(e,604)}function yp(e){var r=1;ke(e,613,on(r)),ke(e,46,dp()),ke(e,614)}function Ep(e){var r=1;ke(e,626,on(r)),ke(e,47,Th({numFmtId:0},65535)),ke(e,627)}function _p(e,r){ke(e,617,on(r.length)),r.forEach(function(t){ke(e,47,Th(t,0))}),ke(e,618)}function Ap(e){var r=1;ke(e,619,on(r)),ke(e,48,xp({xfId:0,name:"Normal"})),ke(e,620)}function bp(e){var r=0;ke(e,505,on(r)),ke(e,506)}function Cp(e){var r=0;ke(e,508,gp(r,"TableStyleMedium9","PivotStyleMedium4")),ke(e,509)}function Tp(e,r){var t=_a();return ke(t,278),pp(t,e.SSF),wp(t),vp(t),yp(t),Ep(t),_p(t,r.cellXfs),Ap(t),bp(t),Cp(t),ke(t,279),t.end()}var Sp=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Np(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(ca)||[]).forEach(function(s){var f=ot(s);switch(f[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=f.val;break;case"<a:sysClr":n.rgb=f.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":f[0].charAt(1)==="/"?(r.themeElements.clrScheme[Sp.indexOf(f[0])]=n,n={}):n.name=f[0].slice(3,f[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+f[0]+" in clrScheme")}})}function kp(){}function Ip(){}var Fp=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Dp=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Op=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Rp(e,r,t){r.themeElements={};var n;[["clrScheme",Fp,Np],["fontScheme",Dp,kp],["fmtScheme",Op,Ip]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,r,t)})}var Mp=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Sh(e,r){(!e||e.length===0)&&(e=Xc());var t,n={};if(!(t=e.match(Mp)))throw new Error("themeElements not found in theme");return Rp(t[0],n,r),n.raw=e,n}function Xc(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Nr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Pp(e,r,t){var n=e.l+r,s=e.read_shift(4);if(s!==124226){if(!t.cellStyles){e.l=n;return}var f=e.slice(e.l);e.l=n;var u;try{u=v1(f,{type:"array"})}catch{return}var x=Ra(u,"theme/theme/theme1.xml",!0);if(x)return Sh(x,t)}}function Bp(e){return e.read_shift(4)}function Lp(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=jp(e,4);break;case 2:r.xclrValue=sh(e);break;case 3:r.xclrValue=Bp(e);break;case 4:e.l+=4;break}return e.l+=8,r}function jp(e,r){return oa(e,r)}function Up(e,r){return oa(e,r)}function Wp(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Lp(e);break;case 6:n[1]=Up(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function Vp(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),f=[];s-- >0;)f.push(Wp(e,t-e.l));return{ixfe:n,ext:f}}function Hp(e,r){r.forEach(function(t){switch(t[0]){}})}function Gp(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:sa(e)}}function Xp(e){var r=_e(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),Xr(e.name,r),r.slice(0,r.l)}function zp(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Yp(e){var r=_e(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function Kp(e,r){var t=_e(8+2*r.length);return t.write_shift(4,e),Xr(r,t),t.slice(0,t.l)}function qp(e){return e.l+=4,e.read_shift(4)!=0}function Zp(e,r){var t=_e(8);return t.write_shift(4,e),t.write_shift(4,1),t}function Jp(e,r,t){var n={Types:[],Cell:[],Value:[]},s=t||{},f=[],u=!1,x=2;return jn(e,function(p,m,v){switch(v){case 335:n.Types.push({name:p.name});break;case 51:p.forEach(function(E){x==1?n.Cell.push({type:n.Types[E[0]-1].name,index:E[1]}):x==0&&n.Value.push({type:n.Types[E[0]-1].name,index:E[1]})});break;case 337:x=p?1:0;break;case 338:x=2;break;case 35:f.push(v),u=!0;break;case 36:f.pop(),u=!1;break;default:if(!m.T){if(!u||s.WTF&&f[f.length-1]!=35)throw new Error("Unexpected record 0x"+v.toString(16))}}}),n}function Qp(){var e=_a();return ke(e,332),ke(e,334,on(1)),ke(e,335,Xp({name:"XLDAPR",version:12e4,flags:3496657072})),ke(e,336),ke(e,339,Kp(1,"XLDAPR")),ke(e,52),ke(e,35,on(514)),ke(e,4096,on(0)),ke(e,4097,Ga(1)),ke(e,36),ke(e,53),ke(e,340),ke(e,337,Zp(1)),ke(e,51,Yp([[1,0]])),ke(e,338),ke(e,333),e.end()}function $p(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,f=2,u;return e.replace(ca,function(x){var p=ot(x);switch(vn(p[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:p.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<n.Types.length;++m)n.Types[m].name==p.name&&(u=n.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":f==1?n.Cell.push({type:n.Types[p.t-1].name,index:+p.v}):f==0&&n.Value.push({type:n.Types[p.t-1].name,index:+p.v});break;case"</rc>":break;case"<cellMetadata":f=1;break;case"</cellMetadata>":f=2;break;case"<valueMetadata":f=0;break;case"</valueMetadata>":f=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!u)break;u.offsets||(u.offsets=[]),u.offsets.push(+p.i);break;default:if(!s&&t.WTF)throw new Error("unrecognized "+p[0]+" in metadata")}return x}),n}function Nh(){var e=[Nr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function ew(e){var r=[];if(!e)return r;var t=1;return(e.match(ca)||[]).forEach(function(n){var s=ot(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,r.push(s);break}}),r}function tw(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=it(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function rw(e,r,t){var n=[];return jn(e,function(f,u,x){switch(x){case 63:n.push(f);break;default:if(!u.T)throw new Error("Unexpected record 0x"+x.toString(16))}}),n}function aw(e,r,t,n){if(!e)return e;var s=n||{},f=!1;jn(e,function(x,p,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:f=!0;break;case 36:f=!1;break;default:if(!p.T){if(!f||s.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},s)}function nw(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}var rs=1024;function kh(e,r){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[je("xml",null,{"xmlns:v":Fa.v,"xmlns:o":Fa.o,"xmlns:x":Fa.x,"xmlns:mv":Fa.mv}).replace(/\/>/,">"),je("o:shapelayout",je("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),je("v:shapetype",[je("v:stroke",null,{joinstyle:"miter"}),je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];rs<e*1e3;)rs+=1e3;return r.forEach(function(f){var u=pr(f[0]),x={color2:"#BEFF82",type:"gradient"};x.type=="gradient"&&(x.angle="-180");var p=x.type=="gradient"?je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=je("v:fill",p,x),v={on:"t",obscured:"t"};++rs,s=s.concat(["<v:shape"+Js({id:"_x0000_s"+rs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(f[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,je("v:shadow",null,v),je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qr("x:Anchor",[u.c+1,0,u.r+1,0,u.c+3,20,u.r+5,20].join(",")),Qr("x:AutoFill","False"),Qr("x:Row",String(u.r)),Qr("x:Column",String(u.c)),f[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Nf(e,r,t,n){var s=Array.isArray(e),f;r.forEach(function(u){var x=pr(u.ref);if(s?(e[x.r]||(e[x.r]=[]),f=e[x.r][x.c]):f=e[u.ref],!f){f={t:"z"},s?e[x.r][x.c]=f:e[u.ref]=f;var p=Pt(e["!ref"]||"BDWGO1000001:A1");p.s.r>x.r&&(p.s.r=x.r),p.e.r<x.r&&(p.e.r=x.r),p.s.c>x.c&&(p.s.c=x.c),p.e.c<x.c&&(p.e.c=x.c);var m=gt(p);m!==e["!ref"]&&(e["!ref"]=m)}f.c||(f.c=[]);var v={a:u.author,t:u.t,r:u.r,T:t};u.h&&(v.h=u.h);for(var E=f.c.length-1;E>=0;--E){if(!t&&f.c[E].T)return;t&&!f.c[E].T&&f.c.splice(E,1)}if(t&&n){for(E=0;E<n.length;++E)if(v.a==n[E].id){v.a=n[E].name||v.a;break}}f.c.push(v)})}function iw(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(u){if(!(u===""||u.trim()==="")){var x=u.match(/<(?:\w+:)?author[^>]*>(.*)/);x&&t.push(x[1])}});var f=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return f&&f[1]&&f[1].split(/<\/\w*:?comment>/).forEach(function(u){if(!(u===""||u.trim()==="")){var x=u.match(/<(?:\w+:)?comment[^>]*>/);if(x){var p=ot(x[0]),m={author:p.authorId&&t[p.authorId]||"sheetjsghost",ref:p.ref,guid:p.guid},v=pr(p.ref);if(!(r.sheetRows&&r.sheetRows<=v.r)){var E=u.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),b=!!E&&!!E[1]&&Vc(E[1])||{r:"",t:"",h:""};m.r=b.r,b.r=="<t></t>"&&(b.t=b.h=""),m.t=(b.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(m.h=b.h),n.push(m)}}}}),n}function Ih(e){var r=[Nr,je("comments",null,{xmlns:Oi[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var f=Xt(s.a);t.indexOf(f)==-1&&(t.push(f),r.push("<author>"+f+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),r.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var s=0,f=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(p){p.a&&(s=t.indexOf(Xt(p.a))),f.push(p.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),f.length<=1)r.push(Qr("t",Xt(f[0]||"")));else{for(var u=`Comment:
    `+f[0]+`
`,x=1;x<f.length;++x)u+=`Reply:
    `+f[x]+`
`;r.push(Qr("t",Xt(u)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function sw(e,r){var t=[],n=!1,s={},f=0;return e.replace(ca,function(x,p){var m=ot(x);switch(vn(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":s.t!=null&&t.push(s);break;case"<text>":case"<text":f=p+x.length;break;case"</text>":s.t=e.slice(f,p).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return x}),t}function ow(e,r,t){var n=[Nr,je("ThreadedComments",null,{xmlns:jr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var f="";(s[1]||[]).forEach(function(u,x){if(!u.T){delete u.ID;return}u.a&&r.indexOf(u.a)==-1&&r.push(u.a);var p={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};x==0?f=p.id:p.parentId=f,u.ID=p.id,u.a&&(p.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(u.a)).slice(-12)+"}"),n.push(je("threadedComment",Qr("text",u.t||""),p))})}),n.push("</ThreadedComments>"),n.join("")}function cw(e,r){var t=[],n=!1;return e.replace(ca,function(f){var u=ot(f);switch(vn(u[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:u.displayname,id:u.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return f}),t}function lw(e){var r=[Nr,je("personList",null,{xmlns:jr.TCMNT,"xmlns:x":Oi[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(je("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function fw(e){var r={};r.iauthor=e.read_shift(4);var t=Bi(e);return r.rfx=t.s,r.ref=it(t.s),e.l+=16,r}function hw(e,r){return r==null&&(r=_e(36)),r.write_shift(4,e[1].iauthor),gs(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var uw=sa;function dw(e){return Xr(e.slice(0,54))}function xw(e,r){var t=[],n=[],s={},f=!1;return jn(e,function(x,p,m){switch(m){case 632:n.push(x);break;case 635:s=x;break;case 637:s.t=x.t,s.h=x.h,s.r=x.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,r.sheetRows&&s.rfx&&r.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:break;case 38:break;default:if(!p.T){if(!f||r.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),t}function gw(e){var r=_a(),t=[];return ke(r,628),ke(r,630),e.forEach(function(n){n[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),ke(r,632,dw(s.a)))})}),ke(r,631),ke(r,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var f={s:pr(n[0]),e:pr(n[0])};ke(r,635,hw([f,s])),s.t&&s.t.length>0&&ke(r,637,Bx(s)),ke(r,636),delete s.iauthor})}),ke(r,634),ke(r,629),r.end()}var mw="application/vnd.ms-office.vbaProject";function pw(e){var r=Je.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Je.utils.cfb_add(r,s,e.FileIndex[n].content)}}),Je.write(r)}function ww(e,r){r.FullPaths.forEach(function(t,n){if(n!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Je.utils.cfb_add(e,s,r.FileIndex[n].content)}})}var Fh=["xlsb","xlsm","xlam","biff8","xla"];function vw(){return{"!type":"dialog"}}function yw(){return{"!type":"dialog"}}function Ew(){return{"!type":"macro"}}function _w(){return{"!type":"macro"}}var ss=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,s,f,u){var x=!1,p=!1;f.length==0?p=!0:f.charAt(0)=="["&&(p=!0,f=f.slice(1,-1)),u.length==0?x=!0:u.charAt(0)=="["&&(x=!0,u=u.slice(1,-1));var m=f.length>0?parseInt(f,10)|0:0,v=u.length>0?parseInt(u,10)|0:0;return x?v+=r.c:--v,p?m+=r.r:--m,s+(x?"":"$")+mr(v)+(p?"":"$")+Sr(m)}return function(s,f){return r=f,s.replace(e,t)}}(),zc=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Yc=function(){return function(r,t){return r.replace(zc,function(n,s,f,u,x,p){var m=Oc(u)-(f?0:t.c),v=Dc(p)-(x?0:t.r),E=v==0?"":x?v+1:"["+v+"]",b=m==0?"":f?m+1:"["+m+"]";return s+"R"+E+"C"+b})}}();function Dh(e,r){return e.replace(zc,function(t,n,s,f,u,x){return n+(s=="$"?s+f:mr(Oc(f)+r.c))+(u=="$"?u+x:Sr(Dc(x)+r.r))})}function Aw(e,r,t){var n=Aa(r),s=n.s,f=pr(t),u={r:f.r-s.r,c:f.c-s.c};return Dh(e,u)}function bw(e){return e.length!=1}function kf(e){return e.replace(/_xlfn\./g,"")}function Rr(e){e.l+=1}function ni(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Oh(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Rh(e);t.biff==12&&(n=4)}var s=e.read_shift(n),f=e.read_shift(n),u=ni(e),x=ni(e);return{s:{r:s,c:u[0],cRel:u[1],rRel:u[2]},e:{r:f,c:x[0],cRel:x[1],rRel:x[2]}}}function Rh(e){var r=ni(e),t=ni(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function Cw(e,r,t){if(t.biff<8)return Rh(e);var n=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),f=ni(e),u=ni(e);return{s:{r:n,c:f[0],cRel:f[1],rRel:f[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function Mh(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return Tw(e);var n=e.read_shift(t&&t.biff==12?4:2),s=ni(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Tw(e){var r=ni(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function Sw(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Nw(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return kw(e);var s=e.read_shift(n>=12?4:2),f=e.read_shift(2),u=(f&16384)>>14,x=(f&32768)>>15;if(f&=16383,x==1)for(;s>524287;)s-=1048576;if(u==1)for(;f>8191;)f=f-16384;return{r:s,c:f,cRel:u,rRel:x}}function kw(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,s=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),s==1&&t>=128&&(t=t-256),{r,c:t,cRel:s,rRel:n}}function Iw(e,r,t){var n=(e[e.l++]&96)>>5,s=Oh(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,s]}function Fw(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),f=8;if(t)switch(t.biff){case 5:e.l+=12,f=6;break;case 12:f=12;break}var u=Oh(e,f,t);return[n,s,u]}function Dw(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function Ow(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),f=8;if(t)switch(t.biff){case 5:e.l+=12,f=6;break;case 12:f=12;break}return e.l+=f,[n,s]}function Rw(e,r,t){var n=(e[e.l++]&96)>>5,s=Cw(e,r-1,t);return[n,s]}function Mw(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function If(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function Pw(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),s=[],f=0;f<=n;++f)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function Bw(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function Lw(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function jw(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function Uw(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function Ph(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function Ww(e){return e.read_shift(2),Ph(e)}function Vw(e){return e.read_shift(2),Ph(e)}function Hw(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=Mh(e,0,t);return[n,s]}function Gw(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=Nw(e,0,t);return[n,s]}function Xw(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var f=Mh(e,0,t);return[n,s,f]}function zw(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[qv[s],jh[s],n]}function Yw(e,r,t){var n=e[e.l++],s=e.read_shift(1),f=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:Kw(e);return[s,(f[0]===0?jh:Kv)[f[1]]]}function Kw(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function qw(e,r,t){e.l+=t&&t.biff==2?3:4}function Zw(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function Jw(e){return e.l++,Un[e.read_shift(1)]}function Qw(e){return e.l++,e.read_shift(2)}function $w(e){return e.l++,e.read_shift(1)!==0}function ev(e){return e.l++,ia(e)}function tv(e,r,t){return e.l++,l0(e,r-1,t)}function rv(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Tr(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Un[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=ia(e);break;case 2:t[1]=Li(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function av(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),s=[],f=0;f!=n;++f)s.push((t.biff==12?Bi:bo)(e));return s}function nv(e,r,t){var n=0,s=0;t.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--s==0&&(s=256));for(var f=0,u=[];f!=n&&(u[f]=[]);++f)for(var x=0;x!=s;++x)u[f][x]=rv(e,t.biff);return u}function iv(e,r,t){var n=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,f=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,f]}function sv(e,r,t){if(t.biff==5)return ov(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),f=e.read_shift(4);return[n,s,f]}function ov(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function cv(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function lv(e,r,t){var n=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[n,s]}function fv(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function hv(e,r,t){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),f=4;if(t)switch(t.biff){case 5:f=15;break;case 12:f=6;break}return e.l+=f,[n,s]}var uv=oa,dv=oa,xv=oa;function h0(e,r,t){return e.l+=2,[Sw(e)]}function Kc(e){return e.l+=6,[]}var gv=h0,mv=Kc,pv=Kc,wv=h0;function Bh(e){return e.l+=2,[Pr(e),e.read_shift(2)&1]}var vv=h0,yv=Bh,Ev=Kc,_v=h0,Av=h0,bv=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Cv(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),f=e.read_shift(2),u=bv[t>>2&31];return{ixti:r,coltype:t&3,rt:u,idx:n,c:s,C:f}}function Tv(e){return e.l+=2,[e.read_shift(4)]}function Sv(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function Nv(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function kv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Iv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Fv(e){return e.l+=4,[0,0]}var Ff={1:{n:"PtgExp",f:Zw},2:{n:"PtgTbl",f:xv},3:{n:"PtgAdd",f:Rr},4:{n:"PtgSub",f:Rr},5:{n:"PtgMul",f:Rr},6:{n:"PtgDiv",f:Rr},7:{n:"PtgPower",f:Rr},8:{n:"PtgConcat",f:Rr},9:{n:"PtgLt",f:Rr},10:{n:"PtgLe",f:Rr},11:{n:"PtgEq",f:Rr},12:{n:"PtgGe",f:Rr},13:{n:"PtgGt",f:Rr},14:{n:"PtgNe",f:Rr},15:{n:"PtgIsect",f:Rr},16:{n:"PtgUnion",f:Rr},17:{n:"PtgRange",f:Rr},18:{n:"PtgUplus",f:Rr},19:{n:"PtgUminus",f:Rr},20:{n:"PtgPercent",f:Rr},21:{n:"PtgParen",f:Rr},22:{n:"PtgMissArg",f:Rr},23:{n:"PtgStr",f:tv},26:{n:"PtgSheet",f:Sv},27:{n:"PtgEndSheet",f:Nv},28:{n:"PtgErr",f:Jw},29:{n:"PtgBool",f:$w},30:{n:"PtgInt",f:Qw},31:{n:"PtgNum",f:ev},32:{n:"PtgArray",f:Mw},33:{n:"PtgFunc",f:zw},34:{n:"PtgFuncVar",f:Yw},35:{n:"PtgName",f:iv},36:{n:"PtgRef",f:Hw},37:{n:"PtgArea",f:Iw},38:{n:"PtgMemArea",f:cv},39:{n:"PtgMemErr",f:uv},40:{n:"PtgMemNoMem",f:dv},41:{n:"PtgMemFunc",f:lv},42:{n:"PtgRefErr",f:fv},43:{n:"PtgAreaErr",f:Dw},44:{n:"PtgRefN",f:Gw},45:{n:"PtgAreaN",f:Rw},46:{n:"PtgMemAreaN",f:kv},47:{n:"PtgMemNoMemN",f:Iv},57:{n:"PtgNameX",f:sv},58:{n:"PtgRef3d",f:Xw},59:{n:"PtgArea3d",f:Fw},60:{n:"PtgRefErr3d",f:hv},61:{n:"PtgAreaErr3d",f:Ow},255:{}},Dv={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ov={1:{n:"PtgElfLel",f:Bh},2:{n:"PtgElfRw",f:_v},3:{n:"PtgElfCol",f:gv},6:{n:"PtgElfRwV",f:Av},7:{n:"PtgElfColV",f:wv},10:{n:"PtgElfRadical",f:vv},11:{n:"PtgElfRadicalS",f:Ev},13:{n:"PtgElfColS",f:mv},15:{n:"PtgElfColSV",f:pv},16:{n:"PtgElfRadicalLel",f:yv},25:{n:"PtgList",f:Cv},29:{n:"PtgSxName",f:Tv},255:{}},Rv={0:{n:"PtgAttrNoop",f:Fv},1:{n:"PtgAttrSemi",f:Uw},2:{n:"PtgAttrIf",f:Lw},4:{n:"PtgAttrChoose",f:Pw},8:{n:"PtgAttrGoto",f:Bw},16:{n:"PtgAttrSum",f:qw},32:{n:"PtgAttrBaxcel",f:If},33:{n:"PtgAttrBaxcel",f:If},64:{n:"PtgAttrSpace",f:Ww},65:{n:"PtgAttrSpaceSemi",f:Vw},128:{n:"PtgAttrIfError",f:jw},255:{}};function u0(e,r,t,n){if(n.biff<8)return oa(e,r);for(var s=e.l+r,f=[],u=0;u!==t.length;++u)switch(t[u][0]){case"PtgArray":t[u][1]=nv(e,0,n),f.push(t[u][1]);break;case"PtgMemArea":t[u][2]=av(e,t[u][1],n),f.push(t[u][2]);break;case"PtgExp":n&&n.biff==12&&(t[u][1][1]=e.read_shift(4),f.push(t[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[u][0]}return r=s-e.l,r!==0&&f.push(oa(e,r)),f}function d0(e,r,t){for(var n=e.l+r,s,f,u=[];n!=e.l;)r=n-e.l,f=e[e.l],s=Ff[f]||Ff[Dv[f]],(f===24||f===25)&&(s=(f===24?Ov:Rv)[e[e.l+1]]),!s||!s.f?oa(e,r):u.push([s.n,s.f(e,r,t)]);return u}function Mv(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],s=[],f=0;f<n.length;++f){var u=n[f];if(u)switch(u[0]){case 2:s.push('"'+u[1].replace(/"/g,'""')+'"');break;default:s.push(u[1])}else s.push("")}r.push(s.join(","))}return r.join(";")}var Pv={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Bv(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Lh(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(f){return f.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Df(e,r,t){var n=Lh(e,r,t);return n=="#REF"?n:Bv(n,t)}function aa(e,r,t,n,s){var f=s&&s.biff||8,u={s:{c:0,r:0}},x=[],p,m,v,E=0,b=0,S,k="";if(!e[0]||!e[0][0])return"";for(var A=-1,F="",V=0,G=e[0].length;V<G;++V){var D=e[0][V];switch(D[0]){case"PtgUminus":x.push("-"+x.pop());break;case"PtgUplus":x.push("+"+x.pop());break;case"PtgPercent":x.push(x.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(p=x.pop(),m=x.pop(),A>=0){switch(e[0][A][1][0]){case 0:F=Er(" ",e[0][A][1][1]);break;case 1:F=Er("\r",e[0][A][1][1]);break;default:if(F="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][A][1][0])}m=m+F,A=-1}x.push(m+Pv[D[0]]+p);break;case"PtgIsect":p=x.pop(),m=x.pop(),x.push(m+" "+p);break;case"PtgUnion":p=x.pop(),m=x.pop(),x.push(m+","+p);break;case"PtgRange":p=x.pop(),m=x.pop(),x.push(m+":"+p);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":v=Us(D[1][1],u,s),x.push(Ws(v,f));break;case"PtgRefN":v=t?Us(D[1][1],t,s):D[1][1],x.push(Ws(v,f));break;case"PtgRef3d":E=D[1][1],v=Us(D[1][2],u,s),k=Df(n,E,s),x.push(k+"!"+Ws(v,f));break;case"PtgFunc":case"PtgFuncVar":var J=D[1][0],ie=D[1][1];J||(J=0),J&=127;var Q=J==0?[]:x.slice(-J);x.length-=J,ie==="User"&&(ie=Q.shift()),x.push(ie+"("+Q.join(",")+")");break;case"PtgBool":x.push(D[1]?"TRUE":"FALSE");break;case"PtgInt":x.push(D[1]);break;case"PtgNum":x.push(String(D[1]));break;case"PtgStr":x.push('"'+D[1].replace(/"/g,'""')+'"');break;case"PtgErr":x.push(D[1]);break;case"PtgAreaN":S=of(D[1][1],t?{s:t}:u,s),x.push(zo(S,s));break;case"PtgArea":S=of(D[1][1],u,s),x.push(zo(S,s));break;case"PtgArea3d":E=D[1][1],S=D[1][2],k=Df(n,E,s),x.push(k+"!"+zo(S,s));break;case"PtgAttrSum":x.push("SUM("+x.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":b=D[1][2];var M=(n.names||[])[b-1]||(n[0]||[])[b],ne=M?M.Name:"SH33TJSNAME"+String(b);ne&&ne.slice(0,6)=="_xlfn."&&!s.xlfn&&(ne=ne.slice(6)),x.push(ne);break;case"PtgNameX":var X=D[1][1];b=D[1][2];var me;if(s.biff<=5)X<0&&(X=-X),n[X]&&(me=n[X][b]);else{var le="";if(((n[X]||[])[0]||[])[0]==14849||(((n[X]||[])[0]||[])[0]==1025?n[X][b]&&n[X][b].itab>0&&(le=n.SheetNames[n[X][b].itab-1]+"!"):le=n.SheetNames[b-1]+"!"),n[X]&&n[X][b])le+=n[X][b].Name;else if(n[0]&&n[0][b])le+=n[0][b].Name;else{var ee=(Lh(n,X,s)||"").split(";;");ee[b-1]?le=ee[b-1]:le+="SH33TJSERRX"}x.push(le);break}me||(me={Name:"SH33TJSERRY"}),x.push(me.Name);break;case"PtgParen":var pe="(",Pe=")";if(A>=0){switch(F="",e[0][A][1][0]){case 2:pe=Er(" ",e[0][A][1][1])+pe;break;case 3:pe=Er("\r",e[0][A][1][1])+pe;break;case 4:Pe=Er(" ",e[0][A][1][1])+Pe;break;case 5:Pe=Er("\r",e[0][A][1][1])+Pe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][A][1][0])}A=-1}x.push(pe+x.pop()+Pe);break;case"PtgRefErr":x.push("#REF!");break;case"PtgRefErr3d":x.push("#REF!");break;case"PtgExp":v={c:D[1][1],r:D[1][0]};var re={c:t.c,r:t.r};if(n.sharedf[it(v)]){var Le=n.sharedf[it(v)];x.push(aa(Le,u,re,n,s))}else{var be=!1;for(p=0;p!=n.arrayf.length;++p)if(m=n.arrayf[p],!(v.c<m[0].s.c||v.c>m[0].e.c)&&!(v.r<m[0].s.r||v.r>m[0].e.r)){x.push(aa(m[1],u,re,n,s)),be=!0;break}be||x.push(D[1])}break;case"PtgArray":x.push("{"+Mv(D[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":A=V;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":x.push("");break;case"PtgAreaErr":x.push("#REF!");break;case"PtgAreaErr3d":x.push("#REF!");break;case"PtgList":x.push("Table"+D[1].idx+"[#"+D[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(D));default:throw new Error("Unrecognized Formula Token: "+String(D))}var St=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&A>=0&&St.indexOf(e[0][V][0])==-1){D=e[0][A];var ue=!0;switch(D[1][0]){case 4:ue=!1;case 0:F=Er(" ",D[1][1]);break;case 5:ue=!1;case 1:F=Er("\r",D[1][1]);break;default:if(F="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+D[1][0])}x.push((ue?F:"")+x.pop()+(ue?"":F)),A=-1}}if(x.length>1&&s.WTF)throw new Error("bad formula stack");return x[0]}function Lv(e,r,t){var n=e.l+r,s=t.biff==2?1:2,f,u=e.read_shift(s);if(u==65535)return[[],oa(e,r-2)];var x=d0(e,u,t);return r!==u+s&&(f=u0(e,r-u-s,x,t)),e.l=n,[x,f]}function jv(e,r,t){var n=e.l+r,s=t.biff==2?1:2,f,u=e.read_shift(s);if(u==65535)return[[],oa(e,r-2)];var x=d0(e,u,t);return r!==u+s&&(f=u0(e,r-u-s,x,t)),e.l=n,[x,f]}function Uv(e,r,t,n){var s=e.l+r,f=d0(e,n,t),u;return s!==e.l&&(u=u0(e,s-e.l,f,t)),[f,u]}function Wv(e,r,t){var n=e.l+r,s,f=e.read_shift(2),u=d0(e,f,t);return f==65535?[[],oa(e,r-2)]:(r!==f+2&&(s=u0(e,n-f-2,u,t)),[u,s])}function Vv(e){var r;if(On(e,e.l+6)!==65535)return[ia(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Hv(e){if(e==null){var r=_e(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return ki(e);return ki(0)}function Jo(e,r,t){var n=e.l+r,s=yn(e);t.biff==2&&++e.l;var f=Vv(e),u=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var x=jv(e,n-e.l,t);return{cell:s,val:f[0],formula:x,shared:u>>3&1,tt:f[1]}}function Gv(e,r,t,n,s){var f=Fi(r,t,s),u=Hv(e.v),x=_e(6),p=33;x.write_shift(2,p),x.write_shift(4,0);for(var m=_e(e.bf.length),v=0;v<e.bf.length;++v)m[v]=e.bf[v];var E=Gr([f,u,x,m]);return E}function Co(e,r,t){var n=e.read_shift(4),s=d0(e,n,t),f=e.read_shift(4),u=f>0?u0(e,f,s,t):null;return[s,u]}var Xv=Co,To=Co,zv=Co,Yv=Co,Kv={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},jh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qv={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Of(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Zv(e){var r="of:="+e.replace(zc,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function Qo(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function Jv(e){return e.replace(/\./,"!")}var Hs={},os={},Gs=typeof Map<"u";function qc(e,r,t){var n=0,s=e.length;if(t){if(Gs?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var f=Gs?t.get(r):t[r];n<f.length;++n)if(e[f[n]].t===r)return e.Count++,f[n]}}else for(;n<s;++n)if(e[n].t===r)return e.Count++,n;return e[s]={t:r},e.Count++,e.Unique++,t&&(Gs?(t.has(r)||t.set(r,[]),t.get(r).push(s)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(s))),s}function So(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(na=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?n=r0(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(t.width=xo(n),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function Ti(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function ci(e,r,t){var n=t.revssf[r.z!=null?r.z:"General"],s=60,f=e.length;if(n==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){Mn(r.z,s),t.ssf[s]=r.z,t.revssf[r.z]=n=s;break}}for(s=0;s!=f;++s)if(e[s].numFmtId===n)return s;return e[f]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},f}function Uh(e,r,t,n,s,f){try{n.cellNF&&(e.z=at[r])}catch(x){if(n.WTF)throw x}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=lr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(at[r]==null&&Mn(Kd[r]||"General",r),e.t==="e")e.w=e.w||Un[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qs(e.v);else if(e.t==="d"){var u=Ur(e.v);(u|0)===u?e.w=u.toString(10):e.w=qs(u)}else{if(e.v===void 0)return"";e.w=Si(e.v,os)}else e.t==="d"?e.w=za(r,Ur(e.v),os):e.w=za(r,e.v,os)}catch(x){if(n.WTF)throw x}if(n.cellStyles&&t!=null)try{e.s=f.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=uo(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=uo(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(x){if(n.WTF&&f.Fills)throw x}}}function Qv(e,r,t){if(e&&e["!ref"]){var n=Pt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function $v(e,r){var t=Pt(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=gt(t))}var e3=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,t3=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,r3=/<(?:\w:)?hyperlink [^>]*>/mg,a3=/"(\w*:\w*)"/,n3=/<(?:\w:)?col\b[^>]*[\/]?>/g,i3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,s3=/<(?:\w:)?pageMargins[^>]*\/>/g,Wh=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,o3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,c3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function l3(e,r,t,n,s,f,u){if(!e)return e;n||(n={"!id":{}});var x=r.dense?[]:{},p={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",v="",E=e.match(t3);E?(m=e.slice(0,E.index),v=e.slice(E.index+E[0].length)):m=v=e;var b=m.match(Wh);b?Zc(b[0],x,s,t):(b=m.match(o3))&&h3(b[0],b[1]||"",x,s,t);var S=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(S>0){var k=m.slice(S,S+50).match(a3);k&&$v(x,k[1])}var A=m.match(c3);A&&A[1]&&b3(A[1],s);var F=[];if(r.cellStyles){var V=m.match(n3);V&&v3(F,V)}E&&S3(E[1],x,r,p,f,u);var G=v.match(i3);G&&(x["!autofilter"]=E3(G[0]));var D=[],J=v.match(e3);if(J)for(S=0;S!=J.length;++S)D[S]=Pt(J[S].slice(J[S].indexOf('"')+1));var ie=v.match(r3);ie&&m3(x,ie,n);var Q=v.match(s3);if(Q&&(x["!margins"]=p3(ot(Q[0]))),!x["!ref"]&&p.e.c>=p.s.c&&p.e.r>=p.s.r&&(x["!ref"]=gt(p)),r.sheetRows>0&&x["!ref"]){var M=Pt(x["!ref"]);r.sheetRows<=+M.e.r&&(M.e.r=r.sheetRows-1,M.e.r>p.e.r&&(M.e.r=p.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>p.e.c&&(M.e.c=p.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),x["!fullref"]=x["!ref"],x["!ref"]=gt(M))}return F.length>0&&(x["!cols"]=F),D.length>0&&(x["!merges"]=D),x}function f3(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+gt(e[t])+'"/>';return r+"</mergeCells>"}function Zc(e,r,t,n){var s=ot(e);t.Sheets[n]||(t.Sheets[n]={}),s.codeName&&(t.Sheets[n].CodeName=Mt(qt(s.codeName)))}function h3(e,r,t,n,s){Zc(e.slice(0,e.indexOf(">")),t,n,s)}function u3(e,r,t,n,s){var f=!1,u={},x=null;if(n.bookType!=="xlsx"&&r.vbaraw){var p=r.SheetNames[t];try{r.Workbook&&(p=r.Workbook.Sheets[t].CodeName||p)}catch{}f=!0,u.codeName=wn(Xt(p))}if(e&&e["!outline"]){var m={summaryBelow:1,summaryRight:1};e["!outline"].above&&(m.summaryBelow=0),e["!outline"].left&&(m.summaryRight=0),x=(x||"")+je("outlinePr",null,m)}!f&&!x||(s[s.length]=je("sheetPr",x,u))}var d3=["objects","scenarios","selectLockedCells","selectUnlockedCells"],x3=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function g3(e){var r={sheet:1};return d3.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),x3.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=Hc(e.password).toString(16).toUpperCase()),je("sheetProtection",null,r)}function m3(e,r,t){for(var n=Array.isArray(e),s=0;s!=r.length;++s){var f=ot(qt(r[s]),!0);if(!f.ref)return;var u=((t||{})["!id"]||[])[f.id];u?(f.Target=u.Target,f.location&&(f.Target+="#"+Mt(f.location))):(f.Target="#"+Mt(f.location),u={Target:f.Target,TargetMode:"Internal"}),f.Rel=u,f.tooltip&&(f.Tooltip=f.tooltip,delete f.tooltip);for(var x=Pt(f.ref),p=x.s.r;p<=x.e.r;++p)for(var m=x.s.c;m<=x.e.c;++m){var v=it({c:m,r:p});n?(e[p]||(e[p]=[]),e[p][m]||(e[p][m]={t:"z",v:void 0}),e[p][m].l=f):(e[v]||(e[v]={t:"z",v:void 0}),e[v].l=f)}}}function p3(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function w3(e){return Ti(e),je("pageMargins",null,e)}function v3(e,r){for(var t=!1,n=0;n!=r.length;++n){var s=ot(r[n],!0);s.hidden&&(s.hidden=cr(s.hidden));var f=parseInt(s.min,10)-1,u=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,Gc(s.width)),ai(s);f<=u;)e[f++]=fr(s)}}function y3(e,r){for(var t=["<cols>"],n,s=0;s!=r.length;++s)(n=r[s])&&(t[t.length]=je("col",null,So(s,n)));return t[t.length]="</cols>",t.join("")}function E3(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}function _3(e,r,t,n){var s=typeof e.ref=="string"?e.ref:gt(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var f=t.Workbook.Names,u=Aa(s);u.s.r==u.e.r&&(u.e.r=Aa(r["!ref"]).e.r,s=gt(u));for(var x=0;x<f.length;++x){var p=f[x];if(p.Name=="_xlnm._FilterDatabase"&&p.Sheet==n){p.Ref="'"+t.SheetNames[n]+"'!"+s;break}}return x==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),je("autoFilter",null,{ref:s})}var A3=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function b3(e,r){r.Views||(r.Views=[{}]),(e.match(A3)||[]).forEach(function(t,n){var s=ot(t);r.Views[n]||(r.Views[n]={}),+s.zoomScale&&(r.Views[n].zoom=+s.zoomScale),cr(s.rightToLeft)&&(r.Views[n].RTL=!0)})}function C3(e,r,t,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),je("sheetViews",je("sheetView",null,s),{})}function T3(e,r,t,n){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",f=e.t,u=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Un[e.v];break;case"d":n&&n.cellDates?s=lr(e.v,-1).toISOString():(e=fr(e),e.t="n",s=""+(e.v=Ur(lr(e.v)))),typeof e.z>"u"&&(e.z=at[14]);break;default:s=e.v;break}var x=Qr("v",Xt(s)),p={r},m=ci(n.cellXfs,e,n);switch(m!==0&&(p.s=m),e.t){case"n":break;case"d":p.t="d";break;case"b":p.t="b";break;case"e":p.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){x=Qr("v",""+qc(n.Strings,e.v,n.revStrings)),p.t="s";break}p.t="str";break}if(e.t!=f&&(e.t=f,e.v=u),typeof e.f=="string"&&e.f){var v=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;x=je("f",Xt(e.f),v)+(e.v!=null?x:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(p.cm=1),je("c",x,p)}var S3=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,f=Zs("v"),u=Zs("f");return function(p,m,v,E,b,S){for(var k=0,A="",F=[],V=[],G=0,D=0,J=0,ie="",Q,M,ne=0,X=0,me,le,ee=0,pe=0,Pe=Array.isArray(S.CellXf),re,Le=[],be=[],St=Array.isArray(m),ue=[],Ye={},Qe=!1,K=!!v.sheetStubs,ae=p.split(r),z=0,N=ae.length;z!=N;++z){A=ae[z].trim();var B=A.length;if(B!==0){var Ne=0;e:for(k=0;k<B;++k)switch(A[k]){case">":if(A[k-1]!="/"){++k;break e}if(v&&v.cellStyles){if(M=ot(A.slice(Ne,k),!0),ne=M.r!=null?parseInt(M.r,10):ne+1,X=-1,v.sheetRows&&v.sheetRows<ne)continue;Ye={},Qe=!1,M.ht&&(Qe=!0,Ye.hpt=parseFloat(M.ht),Ye.hpx=fs(Ye.hpt)),M.hidden=="1"&&(Qe=!0,Ye.hidden=!0),M.outlineLevel!=null&&(Qe=!0,Ye.level=+M.outlineLevel),Qe&&(ue[ne-1]=Ye)}break;case"<":Ne=k;break}if(Ne>=k)break;if(M=ot(A.slice(Ne,k),!0),ne=M.r!=null?parseInt(M.r,10):ne+1,X=-1,!(v.sheetRows&&v.sheetRows<ne)){E.s.r>ne-1&&(E.s.r=ne-1),E.e.r<ne-1&&(E.e.r=ne-1),v&&v.cellStyles&&(Ye={},Qe=!1,M.ht&&(Qe=!0,Ye.hpt=parseFloat(M.ht),Ye.hpx=fs(Ye.hpt)),M.hidden=="1"&&(Qe=!0,Ye.hidden=!0),M.outlineLevel!=null&&(Qe=!0,Ye.level=+M.outlineLevel),Qe&&(ue[ne-1]=Ye)),F=A.slice(k).split(e);for(var we=0;we!=F.length&&F[we].trim().charAt(0)=="<";++we);for(F=F.slice(we),k=0;k!=F.length;++k)if(A=F[k].trim(),A.length!==0){if(V=A.match(t),G=k,D=0,J=0,A="<c "+(A.slice(0,1)=="<"?">":"")+A,V!=null&&V.length===2){for(G=0,ie=V[1],D=0;D!=ie.length&&!((J=ie.charCodeAt(D)-64)<1||J>26);++D)G=26*G+J;--G,X=G}else++X;for(D=0;D!=A.length&&A.charCodeAt(D)!==62;++D);if(++D,M=ot(A.slice(0,D),!0),M.r||(M.r=it({r:ne-1,c:X})),ie=A.slice(D),Q={t:""},(V=ie.match(f))!=null&&V[1]!==""&&(Q.v=Mt(V[1])),v.cellFormula){if((V=ie.match(u))!=null&&V[1]!==""){if(Q.f=Mt(qt(V[1])).replace(/\r\n/g,`
`),v.xlfn||(Q.f=kf(Q.f)),V[0].indexOf('t="array"')>-1)Q.F=(ie.match(s)||[])[1],Q.F.indexOf(":")>-1&&Le.push([Pt(Q.F),Q.F]);else if(V[0].indexOf('t="shared"')>-1){le=ot(V[0]);var ve=Mt(qt(V[1]));v.xlfn||(ve=kf(ve)),be[parseInt(le.si,10)]=[le,ve,M.r]}}else(V=ie.match(/<f[^>]*\/>/))&&(le=ot(V[0]),be[le.si]&&(Q.f=Aw(be[le.si][1],be[le.si][2],M.r)));var Ae=pr(M.r);for(D=0;D<Le.length;++D)Ae.r>=Le[D][0].s.r&&Ae.r<=Le[D][0].e.r&&Ae.c>=Le[D][0].s.c&&Ae.c<=Le[D][0].e.c&&(Q.F=Le[D][1])}if(M.t==null&&Q.v===void 0)if(Q.f||Q.F)Q.v=0,Q.t="n";else if(K)Q.t="z";else continue;else Q.t=M.t||"n";switch(E.s.c>X&&(E.s.c=X),E.e.c<X&&(E.e.c=X),Q.t){case"n":if(Q.v==""||Q.v==null){if(!K)continue;Q.t="z"}else Q.v=parseFloat(Q.v);break;case"s":if(typeof Q.v>"u"){if(!K)continue;Q.t="z"}else me=Hs[parseInt(Q.v,10)],Q.v=me.t,Q.r=me.r,v.cellHTML&&(Q.h=me.h);break;case"str":Q.t="s",Q.v=Q.v!=null?qt(Q.v):"",v.cellHTML&&(Q.h=Nc(Q.v));break;case"inlineStr":V=ie.match(n),Q.t="s",V!=null&&(me=Vc(V[1]))?(Q.v=me.t,v.cellHTML&&(Q.h=me.h)):Q.v="";break;case"b":Q.v=cr(Q.v);break;case"d":v.cellDates?Q.v=lr(Q.v,1):(Q.v=Ur(lr(Q.v,1)),Q.t="n");break;case"e":(!v||v.cellText!==!1)&&(Q.w=Q.v),Q.v=H1[Q.v];break}if(ee=pe=0,re=null,Pe&&M.s!==void 0&&(re=S.CellXf[M.s],re!=null&&(re.numFmtId!=null&&(ee=re.numFmtId),v.cellStyles&&re.fillId!=null&&(pe=re.fillId))),Uh(Q,ee,pe,v,b,S),v.cellDates&&Pe&&Q.t=="n"&&us(at[ee])&&(Q.t="d",Q.v=Ao(Q.v)),M.cm&&v.xlmeta){var Xe=(v.xlmeta.Cell||[])[+M.cm-1];Xe&&Xe.type=="XLDAPR"&&(Q.D=!0)}if(St){var Z=pr(M.r);m[Z.r]||(m[Z.r]=[]),m[Z.r][Z.c]=Q}else m[M.r]=Q}}}}ue.length>0&&(m["!rows"]=ue)}}();function N3(e,r,t,n){var s=[],f=[],u=Pt(e["!ref"]),x="",p,m="",v=[],E=0,b=0,S=e["!rows"],k=Array.isArray(e),A={r:m},F,V=-1;for(b=u.s.c;b<=u.e.c;++b)v[b]=mr(b);for(E=u.s.r;E<=u.e.r;++E){for(f=[],m=Sr(E),b=u.s.c;b<=u.e.c;++b){p=v[b]+m;var G=k?(e[E]||[])[b]:e[p];G!==void 0&&(x=T3(G,p,e,r))!=null&&f.push(x)}(f.length>0||S&&S[E])&&(A={r:m},S&&S[E]&&(F=S[E],F.hidden&&(A.hidden=1),V=-1,F.hpx?V=a0(F.hpx):F.hpt&&(V=F.hpt),V>-1&&(A.ht=V,A.customHeight=1),F.level&&(A.outlineLevel=F.level)),s[s.length]=je("row",f.join(""),A))}if(S)for(;E<S.length;++E)S&&S[E]&&(A={r:E+1},F=S[E],F.hidden&&(A.hidden=1),V=-1,F.hpx?V=a0(F.hpx):F.hpt&&(V=F.hpt),V>-1&&(A.ht=V,A.customHeight=1),F.level&&(A.outlineLevel=F.level),s[s.length]=je("row","",A));return s.join("")}function Vh(e,r,t,n){var s=[Nr,je("worksheet",null,{xmlns:Oi[0],"xmlns:r":jr.r})],f=t.SheetNames[e],u=0,x="",p=t.Sheets[f];p==null&&(p={});var m=p["!ref"]||"A1",v=Pt(m);if(v.e.c>16383||v.e.r>1048575){if(r.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");v.e.c=Math.min(v.e.c,16383),v.e.r=Math.min(v.e.c,1048575),m=gt(v)}n||(n={}),p["!comments"]=[];var E=[];u3(p,t,e,r,s),s[s.length]=je("dimension",null,{ref:m}),s[s.length]=C3(p,r,e,t),r.sheetFormat&&(s[s.length]=je("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),p["!cols"]!=null&&p["!cols"].length>0&&(s[s.length]=y3(p,p["!cols"])),s[u=s.length]="<sheetData/>",p["!links"]=[],p["!ref"]!=null&&(x=N3(p,r),x.length>0&&(s[s.length]=x)),s.length>u+1&&(s[s.length]="</sheetData>",s[u]=s[u].replace("/>",">")),p["!protect"]&&(s[s.length]=g3(p["!protect"])),p["!autofilter"]!=null&&(s[s.length]=_3(p["!autofilter"],p,t,e)),p["!merges"]!=null&&p["!merges"].length>0&&(s[s.length]=f3(p["!merges"]));var b=-1,S,k=-1;return p["!links"].length>0&&(s[s.length]="<hyperlinks>",p["!links"].forEach(function(A){A[1].Target&&(S={ref:A[0]},A[1].Target.charAt(0)!="#"&&(k=Gt(n,-1,Xt(A[1].Target).replace(/#.*$/,""),Ct.HLINK),S["r:id"]="rId"+k),(b=A[1].Target.indexOf("#"))>-1&&(S.location=Xt(A[1].Target.slice(b+1))),A[1].Tooltip&&(S.tooltip=Xt(A[1].Tooltip)),s[s.length]=je("hyperlink",null,S))}),s[s.length]="</hyperlinks>"),delete p["!links"],p["!margins"]!=null&&(s[s.length]=w3(p["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(s[s.length]=Qr("ignoredErrors",je("ignoredError",null,{numberStoredAsText:1,sqref:m}))),E.length>0&&(k=Gt(n,-1,"../drawings/drawing"+(e+1)+".xml",Ct.DRAW),s[s.length]=je("drawing",null,{"r:id":"rId"+k}),p["!drawing"]=E),p["!comments"].length>0&&(k=Gt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ct.VML),s[s.length]=je("legacyDrawing",null,{"r:id":"rId"+k}),p["!legacy"]=k),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function k3(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var f=e.read_shift(1);return e.l=n,f&7&&(t.level=f&7),f&16&&(t.hidden=!0),f&32&&(t.hpt=s/20),t}function I3(e,r,t){var n=_e(145),s=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var f=320;s.hpx?f=a0(s.hpx)*20:s.hpt&&(f=s.hpt*20),n.write_shift(2,f),n.write_shift(1,0);var u=0;s.level&&(u|=s.level),s.hidden&&(u|=16),(s.hpx||s.hpt)&&(u|=32),n.write_shift(1,u),n.write_shift(1,0);var x=0,p=n.l;n.l+=4;for(var m={r:e,c:0},v=0;v<16;++v)if(!(r.s.c>v+1<<10||r.e.c<v<<10)){for(var E=-1,b=-1,S=v<<10;S<v+1<<10;++S){m.c=S;var k=Array.isArray(t)?(t[m.r]||[])[m.c]:t[it(m)];k&&(E<0&&(E=S),b=S)}E<0||(++x,n.write_shift(4,E),n.write_shift(4,b))}var A=n.l;return n.l=p,n.write_shift(4,x),n.l=A,n.length>n.l?n.slice(0,n.l):n}function F3(e,r,t,n){var s=I3(n,t,r);(s.length>17||(r["!rows"]||[])[n])&&ke(e,0,s)}var D3=Bi,O3=gs;function R3(){}function M3(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=Lx(e),t}function P3(e,r,t){t==null&&(t=_e(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var s=1;s<3;++s)t.write_shift(1,0);return lo({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),L1(e,t),t.slice(0,t.l)}function B3(e){var r=Ya(e);return[r]}function L3(e,r,t){return t==null&&(t=_e(8)),Ri(r,t)}function j3(e){var r=Mi(e);return[r]}function U3(e,r,t){return t==null&&(t=_e(4)),Pi(r,t)}function W3(e){var r=Ya(e),t=e.read_shift(1);return[r,t,"b"]}function V3(e,r,t){return t==null&&(t=_e(9)),Ri(r,t),t.write_shift(1,e.v?1:0),t}function H3(e){var r=Mi(e),t=e.read_shift(1);return[r,t,"b"]}function G3(e,r,t){return t==null&&(t=_e(5)),Pi(r,t),t.write_shift(1,e.v?1:0),t}function X3(e){var r=Ya(e),t=e.read_shift(1);return[r,t,"e"]}function z3(e,r,t){return t==null&&(t=_e(9)),Ri(r,t),t.write_shift(1,e.v),t}function Y3(e){var r=Mi(e),t=e.read_shift(1);return[r,t,"e"]}function K3(e,r,t){return t==null&&(t=_e(8)),Pi(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function q3(e){var r=Ya(e),t=e.read_shift(4);return[r,t,"s"]}function Z3(e,r,t){return t==null&&(t=_e(12)),Ri(r,t),t.write_shift(4,r.v),t}function J3(e){var r=Mi(e),t=e.read_shift(4);return[r,t,"s"]}function Q3(e,r,t){return t==null&&(t=_e(8)),Pi(r,t),t.write_shift(4,r.v),t}function $3(e){var r=Ya(e),t=ia(e);return[r,t,"n"]}function e4(e,r,t){return t==null&&(t=_e(16)),Ri(r,t),ki(e.v,t),t}function Hh(e){var r=Mi(e),t=ia(e);return[r,t,"n"]}function t4(e,r,t){return t==null&&(t=_e(12)),Pi(r,t),ki(e.v,t),t}function r4(e){var r=Ya(e),t=Bc(e);return[r,t,"n"]}function a4(e,r,t){return t==null&&(t=_e(12)),Ri(r,t),j1(e.v,t),t}function n4(e){var r=Mi(e),t=Bc(e);return[r,t,"n"]}function i4(e,r,t){return t==null&&(t=_e(8)),Pi(r,t),j1(e.v,t),t}function s4(e){var r=Ya(e),t=Rc(e);return[r,t,"is"]}function o4(e){var r=Ya(e),t=sa(e);return[r,t,"str"]}function c4(e,r,t){return t==null&&(t=_e(12+4*e.v.length)),Ri(r,t),Xr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function l4(e){var r=Mi(e),t=sa(e);return[r,t,"str"]}function f4(e,r,t){return t==null&&(t=_e(8+4*e.v.length)),Pi(r,t),Xr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function h4(e,r,t){var n=e.l+r,s=Ya(e);s.r=t["!row"];var f=e.read_shift(1),u=[s,f,"b"];if(t.cellFormula){e.l+=2;var x=To(e,n-e.l,t);u[3]=aa(x,null,s,t.supbooks,t)}else e.l=n;return u}function u4(e,r,t){var n=e.l+r,s=Ya(e);s.r=t["!row"];var f=e.read_shift(1),u=[s,f,"e"];if(t.cellFormula){e.l+=2;var x=To(e,n-e.l,t);u[3]=aa(x,null,s,t.supbooks,t)}else e.l=n;return u}function d4(e,r,t){var n=e.l+r,s=Ya(e);s.r=t["!row"];var f=ia(e),u=[s,f,"n"];if(t.cellFormula){e.l+=2;var x=To(e,n-e.l,t);u[3]=aa(x,null,s,t.supbooks,t)}else e.l=n;return u}function x4(e,r,t){var n=e.l+r,s=Ya(e);s.r=t["!row"];var f=sa(e),u=[s,f,"str"];if(t.cellFormula){e.l+=2;var x=To(e,n-e.l,t);u[3]=aa(x,null,s,t.supbooks,t)}else e.l=n;return u}var g4=Bi,m4=gs;function p4(e,r){return r==null&&(r=_e(4)),r.write_shift(4,e),r}function w4(e,r){var t=e.l+r,n=Bi(e),s=Mc(e),f=sa(e),u=sa(e),x=sa(e);e.l=t;var p={rfx:n,relId:s,loc:f,display:x};return u&&(p.Tooltip=u),p}function v4(e,r){var t=_e(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));gs({s:pr(e[0]),e:pr(e[0])},t),Pc("rId"+r,t);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Xr(s||"",t),Xr(e[1].Tooltip||"",t),Xr("",t),t.slice(0,t.l)}function y4(){}function E4(e,r,t){var n=e.l+r,s=U1(e),f=e.read_shift(1),u=[s];if(u[2]=f,t.cellFormula){var x=Xv(e,n-e.l,t);u[1]=x}else e.l=n;return u}function _4(e,r,t){var n=e.l+r,s=Bi(e),f=[s];if(t.cellFormula){var u=Yv(e,n-e.l,t);f[1]=u,e.l=n}else e.l=n;return f}function A4(e,r,t){t==null&&(t=_e(18));var n=So(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var s=0;return r.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),r.level&&(s|=r.level<<8),t.write_shift(2,s),t}var Gh=["left","right","top","bottom","header","footer"];function b4(e){var r={};return Gh.forEach(function(t){r[t]=ia(e)}),r}function C4(e,r){return r==null&&(r=_e(6*8)),Ti(e),Gh.forEach(function(t){ki(e[t],r)}),r}function T4(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function S4(e,r,t){t==null&&(t=_e(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function N4(e){var r=_e(24);return r.write_shift(4,4),r.write_shift(4,1),gs(e,r),r}function k4(e,r){return r==null&&(r=_e(16*4+2)),r.write_shift(2,e.password?Hc(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function I4(){}function F4(){}function D4(e,r,t,n,s,f,u){if(!e)return e;var x=r||{};n||(n={"!id":{}});var p=x.dense?[]:{},m,v={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=!1,b=!1,S,k,A,F,V,G,D,J,ie,Q=[];x.biff=12,x["!row"]=0;var M=0,ne=!1,X=[],me={},le=x.supbooks||s.supbooks||[[]];if(le.sharedf=me,le.arrayf=X,le.SheetNames=s.SheetNames||s.Sheets.map(function(St){return St.name}),!x.supbooks&&(x.supbooks=le,s.Names))for(var ee=0;ee<s.Names.length;++ee)le[0][ee+1]=s.Names[ee];var pe=[],Pe=[],re=!1;n0[16]={n:"BrtShortReal",f:Hh};var Le;if(jn(e,function(ue,Ye,Qe){if(!b)switch(Qe){case 148:m=ue;break;case 0:S=ue,x.sheetRows&&x.sheetRows<=S.r&&(b=!0),J=Sr(F=S.r),x["!row"]=S.r,(ue.hidden||ue.hpt||ue.level!=null)&&(ue.hpt&&(ue.hpx=fs(ue.hpt)),Pe[ue.r]=ue);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:ue[2]},ue[2]){case"n":k.v=ue[1];break;case"s":D=Hs[ue[1]],k.v=D.t,k.r=D.r;break;case"b":k.v=!!ue[1];break;case"e":k.v=ue[1],x.cellText!==!1&&(k.w=Un[k.v]);break;case"str":k.t="s",k.v=ue[1];break;case"is":k.t="s",k.v=ue[1].t;break}if((A=u.CellXf[ue[0].iStyleRef])&&Uh(k,A.numFmtId,null,x,f,u),V=ue[0].c==-1?V+1:ue[0].c,x.dense?(p[F]||(p[F]=[]),p[F][V]=k):p[mr(V)+J]=k,x.cellFormula){for(ne=!1,M=0;M<X.length;++M){var K=X[M];S.r>=K[0].s.r&&S.r<=K[0].e.r&&V>=K[0].s.c&&V<=K[0].e.c&&(k.F=gt(K[0]),ne=!0)}!ne&&ue.length>3&&(k.f=ue[3])}if(v.s.r>S.r&&(v.s.r=S.r),v.s.c>V&&(v.s.c=V),v.e.r<S.r&&(v.e.r=S.r),v.e.c<V&&(v.e.c=V),x.cellDates&&A&&k.t=="n"&&us(at[A.numFmtId])){var ae=_i(k.v);ae&&(k.t="d",k.v=new Date(ae.y,ae.m-1,ae.d,ae.H,ae.M,ae.S,ae.u))}Le&&(Le.type=="XLDAPR"&&(k.D=!0),Le=void 0);break;case 1:case 12:if(!x.sheetStubs||E)break;k={t:"z",v:void 0},V=ue[0].c==-1?V+1:ue[0].c,x.dense?(p[F]||(p[F]=[]),p[F][V]=k):p[mr(V)+J]=k,v.s.r>S.r&&(v.s.r=S.r),v.s.c>V&&(v.s.c=V),v.e.r<S.r&&(v.e.r=S.r),v.e.c<V&&(v.e.c=V),Le&&(Le.type=="XLDAPR"&&(k.D=!0),Le=void 0);break;case 176:Q.push(ue);break;case 49:Le=((x.xlmeta||{}).Cell||[])[ue-1];break;case 494:var z=n["!id"][ue.relId];for(z?(ue.Target=z.Target,ue.loc&&(ue.Target+="#"+ue.loc),ue.Rel=z):ue.relId==""&&(ue.Target="#"+ue.loc),F=ue.rfx.s.r;F<=ue.rfx.e.r;++F)for(V=ue.rfx.s.c;V<=ue.rfx.e.c;++V)x.dense?(p[F]||(p[F]=[]),p[F][V]||(p[F][V]={t:"z",v:void 0}),p[F][V].l=ue):(G=it({c:V,r:F}),p[G]||(p[G]={t:"z",v:void 0}),p[G].l=ue);break;case 426:if(!x.cellFormula)break;X.push(ue),ie=x.dense?p[F][V]:p[mr(V)+J],ie.f=aa(ue[1],v,{r:S.r,c:V},le,x),ie.F=gt(ue[0]);break;case 427:if(!x.cellFormula)break;me[it(ue[0].s)]=ue[1],ie=x.dense?p[F][V]:p[mr(V)+J],ie.f=aa(ue[1],v,{r:S.r,c:V},le,x);break;case 60:if(!x.cellStyles)break;for(;ue.e>=ue.s;)pe[ue.e--]={width:ue.w/256,hidden:!!(ue.flags&1),level:ue.level},re||(re=!0,Gc(ue.w/256)),ai(pe[ue.e+1]);break;case 161:p["!autofilter"]={ref:gt(ue)};break;case 476:p["!margins"]=ue;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),ue.name&&(s.Sheets[t].CodeName=ue.name),(ue.above||ue.left)&&(p["!outline"]={above:ue.above,left:ue.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),ue.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:E=!0;break;case 36:E=!1;break;case 37:E=!0;break;case 38:E=!1;break;default:if(!Ye.T){if(!E||x.WTF)throw new Error("Unexpected record 0x"+Qe.toString(16))}}},x),delete x.supbooks,delete x["!row"],!p["!ref"]&&(v.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(p["!ref"]=gt(m||v)),x.sheetRows&&p["!ref"]){var be=Pt(p["!ref"]);x.sheetRows<=+be.e.r&&(be.e.r=x.sheetRows-1,be.e.r>v.e.r&&(be.e.r=v.e.r),be.e.r<be.s.r&&(be.s.r=be.e.r),be.e.c>v.e.c&&(be.e.c=v.e.c),be.e.c<be.s.c&&(be.s.c=be.e.c),p["!fullref"]=p["!ref"],p["!ref"]=gt(be))}return Q.length>0&&(p["!merges"]=Q),pe.length>0&&(p["!cols"]=pe),Pe.length>0&&(p["!rows"]=Pe),p}function O4(e,r,t,n,s,f,u){if(r.v===void 0)return!1;var x="";switch(r.t){case"b":x=r.v?"1":"0";break;case"d":r=fr(r),r.z=r.z||at[14],r.v=Ur(lr(r.v)),r.t="n";break;case"n":case"e":x=""+r.v;break;default:x=r.v;break}var p={r:t,c:n};switch(p.s=ci(s.cellXfs,r,s),r.l&&f["!links"].push([it(p),r.l]),r.c&&f["!comments"].push([it(p),r.c]),r.t){case"s":case"str":return s.bookSST?(x=qc(s.Strings,r.v,s.revStrings),p.t="s",p.v=x,u?ke(e,18,Q3(r,p)):ke(e,7,Z3(r,p))):(p.t="str",u?ke(e,17,f4(r,p)):ke(e,6,c4(r,p))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?u?ke(e,13,i4(r,p)):ke(e,2,a4(r,p)):u?ke(e,16,t4(r,p)):ke(e,5,e4(r,p)),!0;case"b":return p.t="b",u?ke(e,15,G3(r,p)):ke(e,4,V3(r,p)),!0;case"e":return p.t="e",u?ke(e,14,K3(r,p)):ke(e,3,z3(r,p)),!0}return u?ke(e,12,U3(r,p)):ke(e,1,L3(r,p)),!0}function R4(e,r,t,n){var s=Pt(r["!ref"]||"A1"),f,u="",x=[];ke(e,145);var p=Array.isArray(r),m=s.e.r;r["!rows"]&&(m=Math.max(s.e.r,r["!rows"].length-1));for(var v=s.s.r;v<=m;++v){u=Sr(v),F3(e,r,s,v);var E=!1;if(v<=s.e.r)for(var b=s.s.c;b<=s.e.c;++b){v===s.s.r&&(x[b]=mr(b)),f=x[b]+u;var S=p?(r[v]||[])[b]:r[f];if(!S){E=!1;continue}E=O4(e,S,v,b,n,r,E)}}ke(e,146)}function M4(e,r){!r||!r["!merges"]||(ke(e,177,p4(r["!merges"].length)),r["!merges"].forEach(function(t){ke(e,176,m4(t))}),ke(e,178))}function P4(e,r){!r||!r["!cols"]||(ke(e,390),r["!cols"].forEach(function(t,n){t&&ke(e,60,A4(n,t))}),ke(e,391))}function B4(e,r){!r||!r["!ref"]||(ke(e,648),ke(e,649,N4(Pt(r["!ref"]))),ke(e,650))}function L4(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var s=Gt(t,-1,n[1].Target.replace(/#.*$/,""),Ct.HLINK);ke(e,494,v4(n,s))}}),delete r["!links"]}function j4(e,r,t,n){if(r["!comments"].length>0){var s=Gt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ct.VML);ke(e,551,Pc("rId"+s)),r["!legacy"]=s}}function U4(e,r,t,n){if(r["!autofilter"]){var s=r["!autofilter"],f=typeof s.ref=="string"?s.ref:gt(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var u=t.Workbook.Names,x=Aa(f);x.s.r==x.e.r&&(x.e.r=Aa(r["!ref"]).e.r,f=gt(x));for(var p=0;p<u.length;++p){var m=u[p];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==n){m.Ref="'"+t.SheetNames[n]+"'!"+f;break}}p==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+f}),ke(e,161,gs(Pt(f))),ke(e,162)}}function W4(e,r,t){ke(e,133),ke(e,137,S4(r,t)),ke(e,138),ke(e,134)}function V4(e,r){r["!protect"]&&ke(e,535,k4(r["!protect"]))}function H4(e,r,t,n){var s=_a(),f=t.SheetNames[e],u=t.Sheets[f]||{},x=f;try{t&&t.Workbook&&(x=t.Workbook.Sheets[e].CodeName||x)}catch{}var p=Pt(u["!ref"]||"A1");if(p.e.c>16383||p.e.r>1048575){if(r.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575)}return u["!links"]=[],u["!comments"]=[],ke(s,129),(t.vbaraw||u["!outline"])&&ke(s,147,P3(x,u["!outline"])),ke(s,148,O3(p)),W4(s,u,t.Workbook),P4(s,u),R4(s,u,e,r),V4(s,u),U4(s,u,t,e),M4(s,u),L4(s,u,n),u["!margins"]&&ke(s,476,C4(u["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&B4(s,u),j4(s,u,e,n),ke(s,130),s.end()}function G4(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(f){var u=f.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);u&&(r[+u[1]]=t?+u[2]:u[2])});var s=Mt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(f){n=f.replace(/<.*?>/g,"")}),[r,s,n]}function X4(e,r,t,n,s,f){var u=f||{"!type":"chart"};if(!e)return f;var x=0,p=0,m="A",v={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(E){var b=G4(E);v.s.r=v.s.c=0,v.e.c=x,m=mr(x),b[0].forEach(function(S,k){u[m+Sr(k)]={t:"n",v:S,z:b[1]},p=k}),v.e.r<p&&(v.e.r=p),++x}),x>0&&(u["!ref"]=gt(v)),u}function z4(e,r,t,n,s){if(!e)return e;n||(n={"!id":{}});var f={"!type":"chart","!drawel":null,"!rel":""},u,x=e.match(Wh);return x&&Zc(x[0],f,s,t),(u=e.match(/drawing r:id="(.*?)"/))&&(f["!rel"]=u[1]),n["!id"][f["!rel"]]&&(f["!drawel"]=n["!id"][f["!rel"]]),f}function Y4(e,r){e.l+=10;var t=sa(e);return{name:t}}function K4(e,r,t,n,s){if(!e)return e;n||(n={"!id":{}});var f={"!type":"chart","!drawel":null,"!rel":""},u=!1;return jn(e,function(p,m,v){switch(v){case 550:f["!rel"]=p;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),p.name&&(s.Sheets[t].CodeName=p.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!u||r.WTF)throw new Error("Unexpected record 0x"+v.toString(16))}}}},r),n["!id"][f["!rel"]]&&(f["!drawel"]=n["!id"][f["!rel"]]),f}var Jc=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],q4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Z4=[],J4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Rf(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],s=0;s!=r.length;++s){var f=r[s];if(n[f[0]]==null)n[f[0]]=f[1];else switch(f[2]){case"bool":typeof n[f[0]]=="string"&&(n[f[0]]=cr(n[f[0]]));break;case"int":typeof n[f[0]]=="string"&&(n[f[0]]=parseInt(n[f[0]],10));break}}}function Mf(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=cr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Xh(e){Mf(e.WBProps,Jc),Mf(e.CalcPr,J4),Rf(e.WBView,q4),Rf(e.Sheets,Z4),os.date1904=cr(e.WBProps.date1904)}function Q4(e){return!e.Workbook||!e.Workbook.WBProps?"false":cr(e.Workbook.WBProps.date1904)?"true":"false"}var $4="][*?/\\".split("");function zh(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return $4.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function ey(e,r,t){e.forEach(function(n,s){zh(n);for(var f=0;f<s;++f)if(n==e[f])throw new Error("Duplicate Sheet Name: "+n);if(t){var u=r&&r[s]&&r[s].CodeName||n;if(u.charCodeAt(0)==95&&u.length>22)throw new Error("Bad Code Name: Worksheet"+u)}})}function ty(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];ey(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)Qv(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var ry=/<\w+:workbook/;function ay(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",f={},u=0;if(e.replace(ca,function(p,m){var v=ot(p);switch(vn(v[0])){case"<?xml":break;case"<workbook":p.match(ry)&&(s="xmlns"+p.match(/<(\w+):/)[1]),t.xmlns=v[s];break;case"</workbook>":break;case"<fileVersion":delete v[0],t.AppVersion=v;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Jc.forEach(function(E){if(v[E[0]]!=null)switch(E[2]){case"bool":t.WBProps[E[0]]=cr(v[E[0]]);break;case"int":t.WBProps[E[0]]=parseInt(v[E[0]],10);break;default:t.WBProps[E[0]]=v[E[0]]}}),v.codeName&&(t.WBProps.CodeName=qt(v.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete v[0],t.WBView.push(v);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(v.state){case"hidden":v.Hidden=1;break;case"veryHidden":v.Hidden=2;break;default:v.Hidden=0}delete v.state,v.name=Mt(qt(v.name)),delete v[0],t.Sheets.push(v);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":f={},f.Name=qt(v.name),v.comment&&(f.Comment=v.comment),v.localSheetId&&(f.Sheet=+v.localSheetId),cr(v.hidden||"0")&&(f.Hidden=!0),u=m+p.length;break;case"</definedName>":f.Ref=Mt(qt(e.slice(u,m))),t.Names.push(f);break;case"<definedName/>":break;case"<calcPr":delete v[0],t.CalcPr=v;break;case"<calcPr/>":delete v[0],t.CalcPr=v;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+v[0]+" in workbook")}return p}),Oi.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Xh(t),t}function Yh(e){var r=[Nr];r[r.length]=je("workbook",null,{xmlns:Oi[0],"xmlns:r":jr.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Jc.forEach(function(x){e.Workbook.WBProps[x[0]]!=null&&e.Workbook.WBProps[x[0]]!=x[1]&&(n[x[0]]=e.Workbook.WBProps[x[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=je("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],f=0;if(s&&s[0]&&s[0].Hidden){for(r[r.length]="<bookViews>",f=0;f!=e.SheetNames.length&&!(!s[f]||!s[f].Hidden);++f);f==e.SheetNames.length&&(f=0),r[r.length]='<workbookView firstSheet="'+f+'" activeTab="'+f+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",f=0;f!=e.SheetNames.length;++f){var u={name:Xt(e.SheetNames[f].slice(0,31))};if(u.sheetId=""+(f+1),u["r:id"]="rId"+(f+1),s[f])switch(s[f].Hidden){case 1:u.state="hidden";break;case 2:u.state="veryHidden";break}r[r.length]=je("sheet",null,u)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(x){var p={name:x.Name};x.Comment&&(p.comment=x.Comment),x.Sheet!=null&&(p.localSheetId=""+x.Sheet),x.Hidden&&(p.hidden="1"),x.Ref&&(r[r.length]=je("definedName",Xt(x.Ref),p))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function ny(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=ic(e),t.name=sa(e),t}function iy(e,r){return r||(r=_e(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),Pc(e.strRelID,r),Xr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function sy(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=r>8?sa(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function oy(e,r){r||(r=_e(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),L1(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function cy(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function ly(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var s=e.read_shift(4),f=jx(e),u=zv(e,0,t),x=Mc(e);e.l=n;var p={Name:f,Ptg:u};return s<268435455&&(p.Sheet=s),x&&(p.Comment=x),p}function fy(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;r||(r={}),r.biff=12;var f=[],u=[[]];return u.SheetNames=[],u.XTI=[],n0[16]={n:"BrtFRTArchID$",f:cy},jn(e,function(p,m,v){switch(v){case 156:u.SheetNames.push(p.name),t.Sheets.push(p);break;case 153:t.WBProps=p;break;case 39:p.Sheet!=null&&(r.SID=p.Sheet),p.Ref=aa(p.Ptg,null,null,u,r),delete r.SID,delete p.Ptg,f.push(p);break;case 1036:break;case 357:case 358:case 355:case 667:u[0].length?u.push([v,p]):u[0]=[v,p],u[u.length-1].XTI=[];break;case 362:u.length===0&&(u[0]=[],u[0].XTI=[]),u[u.length-1].XTI=u[u.length-1].XTI.concat(p),u.XTI=u.XTI.concat(p);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(v),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(v),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!m.T){if(!s||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+v.toString(16))}}},r),Xh(t),t.Names=f,t.supbooks=u,t}function hy(e,r){ke(e,143);for(var t=0;t!=r.SheetNames.length;++t){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,s={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};ke(e,156,iy(s))}ke(e,144)}function uy(e,r){r||(r=_e(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return Xr("SheetJS",r),Xr(ro.version,r),Xr(ro.version,r),Xr("7262",r),r.length>r.l?r.slice(0,r.l):r}function dy(e,r){r||(r=_e(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function xy(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,n=0,s=-1,f=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&s==-1?s=n:t[n].Hidden==1&&f==-1&&(f=n);f>s||(ke(e,135),ke(e,158,dy(s)),ke(e,136))}}function gy(e,r){var t=_a();return ke(t,131),ke(t,128,uy()),ke(t,153,oy(e.Workbook&&e.Workbook.WBProps||null)),xy(t,e),hy(t,e),ke(t,132),t.end()}function my(e,r,t){return r.slice(-4)===".bin"?fy(e,t):ay(e,t)}function py(e,r,t,n,s,f,u,x){return r.slice(-4)===".bin"?D4(e,n,t,s,f,u,x):l3(e,n,t,s,f,u,x)}function wy(e,r,t,n,s,f,u,x){return r.slice(-4)===".bin"?K4(e,n,t,s,f):z4(e,n,t,s,f)}function vy(e,r,t,n,s,f,u,x){return r.slice(-4)===".bin"?Ew():_w()}function yy(e,r,t,n,s,f,u,x){return r.slice(-4)===".bin"?vw():yw()}function Ey(e,r,t,n){return r.slice(-4)===".bin"?mp(e,t,n):np(e,t,n)}function _y(e,r,t){return Sh(e,t)}function Ay(e,r,t){return r.slice(-4)===".bin"?Am(e,t):ym(e,t)}function by(e,r,t){return r.slice(-4)===".bin"?xw(e,t):iw(e,t)}function Cy(e,r,t){return r.slice(-4)===".bin"?rw(e):ew(e)}function Ty(e,r,t,n){return t.slice(-4)===".bin"?aw(e,r,t,n):void 0}function Sy(e,r,t){return r.slice(-4)===".bin"?Jp(e,r,t):$p(e,r,t)}function Ny(e,r,t){return(r.slice(-4)===".bin"?gy:Yh)(e)}function ky(e,r,t,n,s){return(r.slice(-4)===".bin"?H4:Vh)(e,t,n,s)}function Iy(e,r,t){return(r.slice(-4)===".bin"?Tp:Ch)(e,t)}function Fy(e,r,t){return(r.slice(-4)===".bin"?Tm:ph)(e,t)}function Dy(e,r,t){return(r.slice(-4)===".bin"?gw:Ih)(e)}function Oy(e){return(e.slice(-4)===".bin"?Qp:Nh)()}var Kh=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,qh=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function rn(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var s=e.match(Kh),f,u,x,p;if(s)for(p=0;p!=s.length;++p)f=s[p].match(qh),(u=f[1].indexOf(":"))===-1?n[f[1]]=f[2].slice(1,f[2].length-1):(f[1].slice(0,6)==="xmlns:"?x="xmlns"+f[1].slice(6):x=f[1].slice(u+1),n[x]=f[2].slice(1,f[2].length-1));return n}function Ry(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(Kh),s,f,u,x;if(n)for(x=0;x!=n.length;++x)s=n[x].match(qh),(f=s[1].indexOf(":"))===-1?t[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?u="xmlns"+s[1].slice(6):u=s[1].slice(f+1),t[u]=s[2].slice(1,s[2].length-1));return t}var Xs;function My(e,r){var t=Xs[e]||Mt(e);return t==="General"?Si(r):za(t,r)}function Py(e,r,t,n){var s=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=cr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=lr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Mt(r)]=s}function By(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Un[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qs(e.v):e.w=Si(e.v):e.w=My(r||"General",e.v)}catch(f){if(t.WTF)throw f}try{var n=Xs[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&us(n)){var s=_i(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(f){if(t.WTF)throw f}}}function Ly(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=Zm[n.Pattern]||n.Pattern)}e[r.ID]=r}function jy(e,r,t,n,s,f,u,x,p,m){var v="General",E=n.StyleID,b={};m=m||{};var S=[],k=0;for(E===void 0&&x&&(E=x.StyleID),E===void 0&&u&&(E=u.StyleID);f[E]!==void 0&&(f[E].nf&&(v=f[E].nf),f[E].Interior&&S.push(f[E].Interior),!!f[E].Parent);)E=f[E].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=cr(e);break;case"String":n.t="s",n.r=Jl(Mt(e)),n.v=e.indexOf("<")>-1?Mt(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(lr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Mt(e):n.v<60&&(n.v=n.v-1),(!v||v=="General")&&(v="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=H1[e],m.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=Jl(r||e));break}if(By(n,v,m),m.cellFormula!==!1)if(n.Formula){var A=Mt(n.Formula);A.charCodeAt(0)==61&&(A=A.slice(1)),n.f=ss(A,s),delete n.Formula,n.ArrayRange=="RC"?n.F=ss("RC:RC",s):n.ArrayRange&&(n.F=ss(n.ArrayRange,s),p.push([Pt(n.F),n.F]))}else for(k=0;k<p.length;++k)s.r>=p[k][0].s.r&&s.r<=p[k][0].e.r&&s.c>=p[k][0].s.c&&s.c<=p[k][0].e.c&&(n.F=p[k][1]);m.cellStyles&&(S.forEach(function(F){!b.patternType&&F.patternType&&(b.patternType=F.patternType)}),n.s=b),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Uy(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function $o(e,r){var t=r||{};ds();var n=Ps(kc(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=qt(n));var s=n.slice(0,1024).toLowerCase(),f=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var u=fr(t);return u.type="string",ls.to_workbook(n,u)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(tt){s.indexOf("<"+tt)>=0&&(f=!0)}),f)return CE(n,t);Xs={"General Number":"General","General Date":at[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":at[15],"Short Date":at[14],"Long Time":at[19],"Medium Time":at[18],"Short Time":at[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:at[2],Standard:at[4],Percent:at[10],Scientific:at[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var x,p=[],m,v={},E=[],b=t.dense?[]:{},S="",k={},A={},F=rn('<Data ss:Type="String">'),V=0,G=0,D=0,J={s:{r:2e6,c:2e6},e:{r:0,c:0}},ie={},Q={},M="",ne=0,X=[],me={},le={},ee=0,pe=[],Pe=[],re={},Le=[],be,St=!1,ue=[],Ye=[],Qe={},K=0,ae=0,z={Sheets:[],WBProps:{date1904:!1}},N={};Qs.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var B="";x=Qs.exec(n);)switch(x[3]=(B=x[3]).toLowerCase()){case"data":if(B=="data"){if(x[1]==="/"){if((m=p.pop())[0]!==x[3])throw new Error("Bad state: "+m.join("|"))}else x[0].charAt(x[0].length-2)!=="/"&&p.push([x[3],!0]);break}if(p[p.length-1][1])break;x[1]==="/"?jy(n.slice(V,x.index),M,F,p[p.length-1][0]=="comment"?re:k,{c:G,r:D},ie,Le[G],A,ue,t):(M="",F=rn(x[0]),V=x.index+x[0].length);break;case"cell":if(x[1]==="/")if(Pe.length>0&&(k.c=Pe),(!t.sheetRows||t.sheetRows>D)&&k.v!==void 0&&(t.dense?(b[D]||(b[D]=[]),b[D][G]=k):b[mr(G)+Sr(D)]=k),k.HRef&&(k.l={Target:Mt(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(K=G+(parseInt(k.MergeAcross,10)|0),ae=D+(parseInt(k.MergeDown,10)|0),X.push({s:{c:G,r:D},e:{c:K,r:ae}})),!t.sheetStubs)k.MergeAcross?G=K+1:++G;else if(k.MergeAcross||k.MergeDown){for(var Ne=G;Ne<=K;++Ne)for(var we=D;we<=ae;++we)(Ne>G||we>D)&&(t.dense?(b[we]||(b[we]=[]),b[we][Ne]={t:"z"}):b[mr(Ne)+Sr(we)]={t:"z"});G=K+1}else++G;else k=Ry(x[0]),k.Index&&(G=+k.Index-1),G<J.s.c&&(J.s.c=G),G>J.e.c&&(J.e.c=G),x[0].slice(-2)==="/>"&&++G,Pe=[];break;case"row":x[1]==="/"||x[0].slice(-2)==="/>"?(D<J.s.r&&(J.s.r=D),D>J.e.r&&(J.e.r=D),x[0].slice(-2)==="/>"&&(A=rn(x[0]),A.Index&&(D=+A.Index-1)),G=0,++D):(A=rn(x[0]),A.Index&&(D=+A.Index-1),Qe={},(A.AutoFitHeight=="0"||A.Height)&&(Qe.hpx=parseInt(A.Height,10),Qe.hpt=a0(Qe.hpx),Ye[D]=Qe),A.Hidden=="1"&&(Qe.hidden=!0,Ye[D]=Qe));break;case"worksheet":if(x[1]==="/"){if((m=p.pop())[0]!==x[3])throw new Error("Bad state: "+m.join("|"));E.push(S),J.s.r<=J.e.r&&J.s.c<=J.e.c&&(b["!ref"]=gt(J),t.sheetRows&&t.sheetRows<=J.e.r&&(b["!fullref"]=b["!ref"],J.e.r=t.sheetRows-1,b["!ref"]=gt(J))),X.length&&(b["!merges"]=X),Le.length>0&&(b["!cols"]=Le),Ye.length>0&&(b["!rows"]=Ye),v[S]=b}else J={s:{r:2e6,c:2e6},e:{r:0,c:0}},D=G=0,p.push([x[3],!1]),m=rn(x[0]),S=Mt(m.Name),b=t.dense?[]:{},X=[],ue=[],Ye=[],N={name:S,Hidden:0},z.Sheets.push(N);break;case"table":if(x[1]==="/"){if((m=p.pop())[0]!==x[3])throw new Error("Bad state: "+m.join("|"))}else{if(x[0].slice(-2)=="/>")break;p.push([x[3],!1]),Le=[],St=!1}break;case"style":x[1]==="/"?Ly(ie,Q,t):Q=rn(x[0]);break;case"numberformat":Q.nf=Mt(rn(x[0]).Format||"General"),Xs[Q.nf]&&(Q.nf=Xs[Q.nf]);for(var ve=0;ve!=392&&at[ve]!=Q.nf;++ve);if(ve==392){for(ve=57;ve!=392;++ve)if(at[ve]==null){Mn(Q.nf,ve);break}}break;case"column":if(p[p.length-1][0]!=="table")break;if(be=rn(x[0]),be.Hidden&&(be.hidden=!0,delete be.Hidden),be.Width&&(be.wpx=parseInt(be.Width,10)),!St&&be.wpx>10){St=!0,na=Ah;for(var Ae=0;Ae<Le.length;++Ae)Le[Ae]&&ai(Le[Ae])}St&&ai(be),Le[be.Index-1||Le.length]=be;for(var Xe=0;Xe<+be.Span;++Xe)Le[Le.length]=fr(be);break;case"namedrange":if(x[1]==="/")break;z.Names||(z.Names=[]);var Z=ot(x[0]),Ke={Name:Z.Name,Ref:ss(Z.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(Ke.Sheet=z.Sheets.length-1),z.Names.push(Ke);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(x[0].slice(-2)==="/>")break;x[1]==="/"?M+=n.slice(ne,x.index):ne=x.index+x[0].length;break;case"interior":if(!t.cellStyles)break;Q.Interior=rn(x[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(x[0].slice(-2)==="/>")break;x[1]==="/"?fg(me,B,n.slice(ee,x.index)):ee=x.index+x[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(x[1]==="/"){if((m=p.pop())[0]!==x[3])throw new Error("Bad state: "+m.join("|"))}else p.push([x[3],!1]);break;case"comment":if(x[1]==="/"){if((m=p.pop())[0]!==x[3])throw new Error("Bad state: "+m.join("|"));Uy(re),Pe.push(re)}else p.push([x[3],!1]),m=rn(x[0]),re={a:m.Author};break;case"autofilter":if(x[1]==="/"){if((m=p.pop())[0]!==x[3])throw new Error("Bad state: "+m.join("|"))}else if(x[0].charAt(x[0].length-2)!=="/"){var xt=rn(x[0]);b["!autofilter"]={ref:ss(xt.Range).replace(/\$/g,"")},p.push([x[3],!0])}break;case"name":break;case"datavalidation":if(x[1]==="/"){if((m=p.pop())[0]!==x[3])throw new Error("Bad state: "+m.join("|"))}else x[0].charAt(x[0].length-2)!=="/"&&p.push([x[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(x[1]==="/"){if((m=p.pop())[0]!==x[3])throw new Error("Bad state: "+m.join("|"))}else x[0].charAt(x[0].length-2)!=="/"&&p.push([x[3],!0]);break;case"null":break;default:if(p.length==0&&x[3]=="document"||p.length==0&&x[3]=="uof")return Uf(n,t);var _t=!0;switch(p[p.length-1][0]){case"officedocumentsettings":switch(x[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:_t=!1}break;case"componentoptions":switch(x[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:_t=!1}break;case"excelworkbook":switch(x[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:_t=!1}break;case"workbookoptions":switch(x[3]){case"owcversion":break;case"height":break;case"width":break;default:_t=!1}break;case"worksheetoptions":switch(x[3]){case"visible":if(x[0].slice(-2)!=="/>")if(x[1]==="/")switch(n.slice(ee,x.index)){case"SheetHidden":N.Hidden=1;break;case"SheetVeryHidden":N.Hidden=2;break}else ee=x.index+x[0].length;break;case"header":b["!margins"]||Ti(b["!margins"]={},"xlml"),isNaN(+ot(x[0]).Margin)||(b["!margins"].header=+ot(x[0]).Margin);break;case"footer":b["!margins"]||Ti(b["!margins"]={},"xlml"),isNaN(+ot(x[0]).Margin)||(b["!margins"].footer=+ot(x[0]).Margin);break;case"pagemargins":var ct=ot(x[0]);b["!margins"]||Ti(b["!margins"]={},"xlml"),isNaN(+ct.Top)||(b["!margins"].top=+ct.Top),isNaN(+ct.Left)||(b["!margins"].left=+ct.Left),isNaN(+ct.Right)||(b["!margins"].right=+ct.Right),isNaN(+ct.Bottom)||(b["!margins"].bottom=+ct.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":b["!outline"]||(b["!outline"]={}),b["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":b["!outline"]||(b["!outline"]={}),b["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:_t=!1}break;case"pivottable":case"pivotcache":switch(x[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:_t=!1}break;case"pagebreaks":switch(x[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:_t=!1}break;case"autofilter":switch(x[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:_t=!1}break;case"querytable":switch(x[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:_t=!1}break;case"datavalidation":switch(x[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:_t=!1}break;case"sorting":case"conditionalformatting":switch(x[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:_t=!1}break;case"mapinfo":case"schema":case"data":switch(x[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:_t=!1}break;case"smarttags":break;default:_t=!1;break}if(_t||x[3].match(/!\[CDATA/))break;if(!p[p.length-1][1])throw"Unrecognized tag: "+x[3]+"|"+p.join("|");if(p[p.length-1][0]==="customdocumentproperties"){if(x[0].slice(-2)==="/>")break;x[1]==="/"?Py(le,B,pe,n.slice(ee,x.index)):(pe=x,ee=x.index+x[0].length);break}if(t.WTF)throw"Unrecognized tag: "+x[3]+"|"+p.join("|")}var Me={};return!t.bookSheets&&!t.bookProps&&(Me.Sheets=v),Me.SheetNames=E,Me.Workbook=z,Me.SSF=fr(at),Me.Props=me,Me.Custprops=le,Me}function uc(e,r){switch($c(r=r||{}),r.type||"base64"){case"base64":return $o(Ma(e),r);case"binary":case"buffer":case"file":return $o(e,r);case"array":return $o(si(e),r)}}function Wy(e,r){var t=[];return e.Props&&t.push(hg(e.Props,r)),e.Custprops&&t.push(ug(e.Props,e.Custprops)),t.join("")}function Vy(){return""}function Hy(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,s){var f=[];f.push(je("NumberFormat",null,{"ss:Format":Xt(at[n.numFmtId])}));var u={"ss:ID":"s"+(21+s)};t.push(je("Style",f.join(""),u))}),je("Styles",t.join(""))}function Zh(e){return je("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Yc(e.Ref,{r:0,c:0})})}function Gy(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var s=r[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(Zh(s)))}return je("Names",t.join(""))}function Xy(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,f=[],u=0;u<s.length;++u){var x=s[u];x.Sheet==t&&(x.Name.match(/^_xlfn\./)||f.push(Zh(x)))}return f.join("")}function zy(e,r,t,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(je("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(je("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(je("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)s.push(je("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var f=0;f<t&&!(n.Workbook.Sheets[f]&&!n.Workbook.Sheets[f].Hidden);++f);f==t&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Qr("ProtectContents","True")),e["!protect"].objects&&s.push(Qr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Qr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Qr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Qr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(u){e["!protect"][u[0]]&&s.push("<"+u[1]+"/>")})),s.length==0?"":je("WorksheetOptions",s.join(""),{xmlns:Fa.x})}function Yy(e){return e.map(function(r){var t=xx(r.t||""),n=je("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return je("Comment",n,{"ss:Author":r.a})}).join("")}function Ky(e,r,t,n,s,f,u){if(!e||e.v==null&&e.f==null)return"";var x={};if(e.f&&(x["ss:Formula"]="="+Xt(Yc(e.f,u))),e.F&&e.F.slice(0,r.length)==r){var p=pr(e.F.slice(r.length+1));x["ss:ArrayRange"]="RC:R"+(p.r==u.r?"":"["+(p.r-u.r)+"]")+"C"+(p.c==u.c?"":"["+(p.c-u.c)+"]")}if(e.l&&e.l.Target&&(x["ss:HRef"]=Xt(e.l.Target),e.l.Tooltip&&(x["x:HRefScreenTip"]=Xt(e.l.Tooltip))),t["!merges"])for(var m=t["!merges"],v=0;v!=m.length;++v)m[v].s.c!=u.c||m[v].s.r!=u.r||(m[v].e.c>m[v].s.c&&(x["ss:MergeAcross"]=m[v].e.c-m[v].s.c),m[v].e.r>m[v].s.r&&(x["ss:MergeDown"]=m[v].e.r-m[v].s.r));var E="",b="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":E="Number",b=String(e.v);break;case"b":E="Boolean",b=e.v?"1":"0";break;case"e":E="Error",b=Un[e.v];break;case"d":E="DateTime",b=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||at[14]);break;case"s":E="String",b=dx(e.v||"");break}var S=ci(n.cellXfs,e,n);x["ss:StyleID"]="s"+(21+S),x["ss:Index"]=u.c+1;var k=e.v!=null?b:"",A=e.t=="z"?"":'<Data ss:Type="'+E+'">'+k+"</Data>";return(e.c||[]).length>0&&(A+=Yy(e.c)),je("Cell",A,x)}function qy(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=fs(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function Zy(e,r,t,n){if(!e["!ref"])return"";var s=Pt(e["!ref"]),f=e["!merges"]||[],u=0,x=[];e["!cols"]&&e["!cols"].forEach(function(F,V){ai(F);var G=!!F.width,D=So(V,F),J={"ss:Index":V+1};G&&(J["ss:Width"]=t0(D.width)),F.hidden&&(J["ss:Hidden"]="1"),x.push(je("Column",null,J))});for(var p=Array.isArray(e),m=s.s.r;m<=s.e.r;++m){for(var v=[qy(m,(e["!rows"]||[])[m])],E=s.s.c;E<=s.e.c;++E){var b=!1;for(u=0;u!=f.length;++u)if(!(f[u].s.c>E)&&!(f[u].s.r>m)&&!(f[u].e.c<E)&&!(f[u].e.r<m)){(f[u].s.c!=E||f[u].s.r!=m)&&(b=!0);break}if(!b){var S={r:m,c:E},k=it(S),A=p?(e[m]||[])[E]:e[k];v.push(Ky(A,k,e,r,t,n,S))}}v.push("</Row>"),v.length>2&&x.push(v.join(""))}return x.join("")}function Jy(e,r,t){var n=[],s=t.SheetNames[e],f=t.Sheets[s],u=f?Xy(f,r,e,t):"";return u.length>0&&n.push("<Names>"+u+"</Names>"),u=f?Zy(f,r,e,t):"",u.length>0&&n.push("<Table>"+u+"</Table>"),n.push(zy(f,r,e,t)),n.join("")}function Qy(e,r){r||(r={}),e.SSF||(e.SSF=fr(at)),e.SSF&&(ds(),yo(e.SSF),r.revssf=_o(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],ci(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Wy(e,r)),t.push(Vy()),t.push(""),t.push("");for(var n=0;n<e.SheetNames.length;++n)t.push(je("Worksheet",Jy(n,r,e),{"ss:Name":Xt(e.SheetNames[n])}));return t[2]=Hy(e,r),t[3]=Gy(e),Nr+je("Workbook",t.join(""),{xmlns:Fa.ss,"xmlns:o":Fa.o,"xmlns:x":Fa.x,"xmlns:ss":Fa.ss,"xmlns:dt":Fa.dt,"xmlns:html":Fa.html})}function $y(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=Gx(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=Xx(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var eE=[60,1084,2066,2165,2175];function tE(e,r,t,n,s){var f=n,u=[],x=t.slice(t.l,t.l+f);if(s&&s.enc&&s.enc.insitu&&x.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(x)}u.push(x),t.l+=f;for(var p=On(t,t.l),m=dc[p],v=0;m!=null&&eE.indexOf(p)>-1;)f=On(t,t.l+2),v=t.l+4,p==2066?v+=4:(p==2165||p==2175)&&(v+=12),x=t.slice(v,t.l+4+f),u.push(x),t.l+=4+f,m=dc[p=On(t,t.l)];var E=Gr(u);Jr(E,0);var b=0;E.lens=[];for(var S=0;S<u.length;++S)E.lens.push(b),b+=u[S].length;if(E.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+E.length+" < "+n;return r.f(E,E.length,s)}function gn(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=at[n])}catch(f){if(r.WTF)throw f}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Un[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qs(e.v):e.w=Si(e.v):e.w=za(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(f){if(r.WTF)throw f}if(r.cellDates&&n&&e.t=="n"&&us(at[n]||String(n))){var s=_i(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function J0(e,r,t){return{v:e,ixfe:r,t}}function rE(e,r){var t={opts:{}},n={},s=r.dense?[]:{},f={},u={},x=null,p=[],m="",v={},E,b="",S,k,A,F,V={},G=[],D,J,ie=[],Q=[],M={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ne={},X=function(lt){return lt<8?Ai[lt]:lt<64&&Q[lt-8]||Ai[lt]},me=function(lt,Yt,kr){var ft=Yt.XF.data;if(!(!ft||!ft.patternType||!kr||!kr.cellStyles)){Yt.s={},Yt.s.patternType=ft.patternType;var De;(De=e0(X(ft.icvFore)))&&(Yt.s.fgColor={rgb:De}),(De=e0(X(ft.icvBack)))&&(Yt.s.bgColor={rgb:De})}},le=function(lt,Yt,kr){if(!(Qe>1)&&!(kr.sheetRows&&lt.r>=kr.sheetRows)){if(kr.cellStyles&&Yt.XF&&Yt.XF.data&&me(lt,Yt,kr),delete Yt.ixfe,delete Yt.XF,E=lt,b=it(lt),(!u||!u.s||!u.e)&&(u={s:{r:0,c:0},e:{r:0,c:0}}),lt.r<u.s.r&&(u.s.r=lt.r),lt.c<u.s.c&&(u.s.c=lt.c),lt.r+1>u.e.r&&(u.e.r=lt.r+1),lt.c+1>u.e.c&&(u.e.c=lt.c+1),kr.cellFormula&&Yt.f){for(var ft=0;ft<G.length;++ft)if(!(G[ft][0].s.c>lt.c||G[ft][0].s.r>lt.r)&&!(G[ft][0].e.c<lt.c||G[ft][0].e.r<lt.r)){Yt.F=gt(G[ft][0]),(G[ft][0].s.c!=lt.c||G[ft][0].s.r!=lt.r)&&delete Yt.f,Yt.f&&(Yt.f=""+aa(G[ft][1],u,lt,ue,ee));break}}kr.dense?(s[lt.r]||(s[lt.r]=[]),s[lt.r][lt.c]=Yt):s[b]=Yt}},ee={enc:!1,sbcch:0,snames:[],sharedf:V,arrayf:G,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(ee.password=r.password);var pe,Pe=[],re=[],Le=[],be=[],St=!1,ue=[];ue.SheetNames=ee.snames,ue.sharedf=ee.sharedf,ue.arrayf=ee.arrayf,ue.names=[],ue.XTI=[];var Ye=0,Qe=0,K=0,ae=[],z=[],N;ee.codepage=1200,an(1200);for(var B=!1;e.l<e.length-1;){var Ne=e.l,we=e.read_shift(2);if(we===0&&Ye===10)break;var ve=e.l===e.length?0:e.read_shift(2),Ae=dc[we];if(Ae&&Ae.f){if(r.bookSheets&&Ye===133&&we!==133)break;if(Ye=we,Ae.r===2||Ae.r==12){var Xe=e.read_shift(2);if(ve-=2,!ee.enc&&Xe!==we&&((Xe&255)<<8|Xe>>8)!==we)throw new Error("rt mismatch: "+Xe+"!="+we);Ae.r==12&&(e.l+=10,ve-=10)}var Z={};if(we===10?Z=Ae.f(e,ve,ee):Z=tE(we,Ae,e,ve,ee),Qe==0&&[9,521,1033,2057].indexOf(Ye)===-1)continue;switch(we){case 34:t.opts.Date1904=M.WBProps.date1904=Z;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(ee.enc||(e.l=0),ee.enc=Z,!r.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:ee.lastuser=Z;break;case 66:var Ke=Number(Z);switch(Ke){case 21010:Ke=1200;break;case 32768:Ke=1e4;break;case 32769:Ke=1252;break}an(ee.codepage=Ke),B=!0;break;case 317:ee.rrtabid=Z;break;case 25:ee.winlocked=Z;break;case 439:t.opts.RefreshAll=Z;break;case 12:t.opts.CalcCount=Z;break;case 16:t.opts.CalcDelta=Z;break;case 17:t.opts.CalcIter=Z;break;case 13:t.opts.CalcMode=Z;break;case 14:t.opts.CalcPrecision=Z;break;case 95:t.opts.CalcSaveRecalc=Z;break;case 15:ee.CalcRefMode=Z;break;case 2211:t.opts.FullCalc=Z;break;case 129:Z.fDialog&&(s["!type"]="dialog"),Z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:ie.push(Z);break;case 430:ue.push([Z]),ue[ue.length-1].XTI=[];break;case 35:case 547:ue[ue.length-1].push(Z);break;case 24:case 536:N={Name:Z.Name,Ref:aa(Z.rgce,u,null,ue,ee)},Z.itab>0&&(N.Sheet=Z.itab-1),ue.names.push(N),ue[0]||(ue[0]=[],ue[0].XTI=[]),ue[ue.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(z[Z.itab-1]={ref:gt(Z.rgce[0][0][1][2])});break;case 22:ee.ExternCount=Z;break;case 23:ue.length==0&&(ue[0]=[],ue[0].XTI=[]),ue[ue.length-1].XTI=ue[ue.length-1].XTI.concat(Z),ue.XTI=ue.XTI.concat(Z);break;case 2196:if(ee.biff<8)break;N!=null&&(N.Comment=Z[1]);break;case 18:s["!protect"]=Z;break;case 19:Z!==0&&ee.WTF&&console.error("Password verifier: "+Z);break;case 133:f[Z.pos]=Z,ee.snames.push(Z.name);break;case 10:{if(--Qe)break;if(u.e){if(u.e.r>0&&u.e.c>0){if(u.e.r--,u.e.c--,s["!ref"]=gt(u),r.sheetRows&&r.sheetRows<=u.e.r){var xt=u.e.r;u.e.r=r.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=gt(u),u.e.r=xt}u.e.r++,u.e.c++}Pe.length>0&&(s["!merges"]=Pe),re.length>0&&(s["!objects"]=re),Le.length>0&&(s["!cols"]=Le),be.length>0&&(s["!rows"]=be),M.Sheets.push(ne)}m===""?v=s:n[m]=s,s=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ee.biff===8&&(ee.biff={9:2,521:3,1033:4}[we]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),ee.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(ee.biff=5,B=!0,an(ee.codepage=28591)),ee.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(ee.biff=2),Qe++)break;if(s=r.dense?[]:{},ee.biff<8&&!B&&(B=!0,an(ee.codepage=r.codepage||1252)),ee.biff<5||Z.BIFFVer==0&&Z.dt==4096){m===""&&(m="Sheet1"),u={s:{r:0,c:0},e:{r:0,c:0}};var _t={pos:e.l-ve,name:m};f[_t.pos]=_t,ee.snames.push(m)}else m=(f[Ne]||{name:""}).name;Z.dt==32&&(s["!type"]="chart"),Z.dt==64&&(s["!type"]="macro"),Pe=[],re=[],ee.arrayf=G=[],Le=[],be=[],St=!1,ne={Hidden:(f[Ne]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(r.dense?(s[Z.r]||[])[Z.c]:s[it({c:Z.c,r:Z.r})])&&++Z.c,D={ixfe:Z.ixfe,XF:ie[Z.ixfe]||{},v:Z.val,t:"n"},K>0&&(D.z=ae[D.ixfe>>8&63]),gn(D,r,t.opts.Date1904),le({c:Z.c,r:Z.r},D,r);break;case 5:case 517:D={ixfe:Z.ixfe,XF:ie[Z.ixfe],v:Z.val,t:Z.t},K>0&&(D.z=ae[D.ixfe>>8&63]),gn(D,r,t.opts.Date1904),le({c:Z.c,r:Z.r},D,r);break;case 638:D={ixfe:Z.ixfe,XF:ie[Z.ixfe],v:Z.rknum,t:"n"},K>0&&(D.z=ae[D.ixfe>>8&63]),gn(D,r,t.opts.Date1904),le({c:Z.c,r:Z.r},D,r);break;case 189:for(var ct=Z.c;ct<=Z.C;++ct){var Me=Z.rkrec[ct-Z.c][0];D={ixfe:Me,XF:ie[Me],v:Z.rkrec[ct-Z.c][1],t:"n"},K>0&&(D.z=ae[D.ixfe>>8&63]),gn(D,r,t.opts.Date1904),le({c:ct,r:Z.r},D,r)}break;case 6:case 518:case 1030:{if(Z.val=="String"){x=Z;break}if(D=J0(Z.val,Z.cell.ixfe,Z.tt),D.XF=ie[D.ixfe],r.cellFormula){var tt=Z.formula;if(tt&&tt[0]&&tt[0][0]&&tt[0][0][0]=="PtgExp"){var nt=tt[0][0][1][0],$r=tt[0][0][1][1],We=it({r:nt,c:$r});V[We]?D.f=""+aa(Z.formula,u,Z.cell,ue,ee):D.F=((r.dense?(s[nt]||[])[$r]:s[We])||{}).F}else D.f=""+aa(Z.formula,u,Z.cell,ue,ee)}K>0&&(D.z=ae[D.ixfe>>8&63]),gn(D,r,t.opts.Date1904),le(Z.cell,D,r),x=Z}break;case 7:case 519:if(x)x.val=Z,D=J0(Z,x.cell.ixfe,"s"),D.XF=ie[D.ixfe],r.cellFormula&&(D.f=""+aa(x.formula,u,x.cell,ue,ee)),K>0&&(D.z=ae[D.ixfe>>8&63]),gn(D,r,t.opts.Date1904),le(x.cell,D,r),x=null;else throw new Error("String record expects Formula");break;case 33:case 545:{G.push(Z);var br=it(Z[0].s);if(S=r.dense?(s[Z[0].s.r]||[])[Z[0].s.c]:s[br],r.cellFormula&&S){if(!x||!br||!S)break;S.f=""+aa(Z[1],u,Z[0],ue,ee),S.F=gt(Z[0])}}break;case 1212:{if(!r.cellFormula)break;if(b){if(!x)break;V[it(x.cell)]=Z[0],S=r.dense?(s[x.cell.r]||[])[x.cell.c]:s[it(x.cell)],(S||{}).f=""+aa(Z[0],u,E,ue,ee)}}break;case 253:D=J0(p[Z.isst].t,Z.ixfe,"s"),p[Z.isst].h&&(D.h=p[Z.isst].h),D.XF=ie[D.ixfe],K>0&&(D.z=ae[D.ixfe>>8&63]),gn(D,r,t.opts.Date1904),le({c:Z.c,r:Z.r},D,r);break;case 513:r.sheetStubs&&(D={ixfe:Z.ixfe,XF:ie[Z.ixfe],t:"z"},K>0&&(D.z=ae[D.ixfe>>8&63]),gn(D,r,t.opts.Date1904),le({c:Z.c,r:Z.r},D,r));break;case 190:if(r.sheetStubs)for(var Br=Z.c;Br<=Z.C;++Br){var Zt=Z.ixfe[Br-Z.c];D={ixfe:Zt,XF:ie[Zt],t:"z"},K>0&&(D.z=ae[D.ixfe>>8&63]),gn(D,r,t.opts.Date1904),le({c:Br,r:Z.r},D,r)}break;case 214:case 516:case 4:D=J0(Z.val,Z.ixfe,"s"),D.XF=ie[D.ixfe],K>0&&(D.z=ae[D.ixfe>>8&63]),gn(D,r,t.opts.Date1904),le({c:Z.c,r:Z.r},D,r);break;case 0:case 512:Qe===1&&(u=Z);break;case 252:p=Z;break;case 1054:if(ee.biff==4){ae[K++]=Z[1];for(var zr=0;zr<K+163&&at[zr]!=Z[1];++zr);zr>=163&&Mn(Z[1],K+163)}else Mn(Z[1],Z[0]);break;case 30:{ae[K++]=Z;for(var xr=0;xr<K+163&&at[xr]!=Z;++xr);xr>=163&&Mn(Z,K+163)}break;case 229:Pe=Pe.concat(Z);break;case 93:re[Z.cmo[0]]=ee.lastobj=Z;break;case 438:ee.lastobj.TxO=Z;break;case 127:ee.lastobj.ImData=Z;break;case 440:for(F=Z[0].s.r;F<=Z[0].e.r;++F)for(A=Z[0].s.c;A<=Z[0].e.c;++A)S=r.dense?(s[F]||[])[A]:s[it({c:A,r:F})],S&&(S.l=Z[1]);break;case 2048:for(F=Z[0].s.r;F<=Z[0].e.r;++F)for(A=Z[0].s.c;A<=Z[0].e.c;++A)S=r.dense?(s[F]||[])[A]:s[it({c:A,r:F})],S&&S.l&&(S.l.Tooltip=Z[1]);break;case 28:{if(ee.biff<=5&&ee.biff>=2)break;S=r.dense?(s[Z[0].r]||[])[Z[0].c]:s[it(Z[0])];var cn=re[Z[2]];S||(r.dense?(s[Z[0].r]||(s[Z[0].r]=[]),S=s[Z[0].r][Z[0].c]={t:"z"}):S=s[it(Z[0])]={t:"z"},u.e.r=Math.max(u.e.r,Z[0].r),u.s.r=Math.min(u.s.r,Z[0].r),u.e.c=Math.max(u.e.c,Z[0].c),u.s.c=Math.min(u.s.c,Z[0].c)),S.c||(S.c=[]),k={a:Z[1],t:cn.TxO.t},S.c.push(k)}break;case 2173:Hp(ie[Z.ixfe],Z.ext);break;case 125:{if(!ee.cellStyles)break;for(;Z.e>=Z.s;)Le[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},St||(St=!0,Gc(Z.w/256)),ai(Le[Z.e+1])}break;case 520:{var Jt={};Z.level!=null&&(be[Z.r]=Jt,Jt.level=Z.level),Z.hidden&&(be[Z.r]=Jt,Jt.hidden=!0),Z.hpt&&(be[Z.r]=Jt,Jt.hpt=Z.hpt,Jt.hpx=fs(Z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Ti(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[we]]=Z;break;case 161:s["!margins"]||Ti(s["!margins"]={}),s["!margins"].header=Z.header,s["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(M.Views[0].RTL=!0);break;case 146:Q=Z;break;case 2198:pe=Z;break;case 140:J=Z;break;case 442:m?ne.CodeName=Z||ne.name:M.WBProps.CodeName=Z||"ThisWorkbook";break}}else Ae||console.error("Missing Info for XLS Record 0x"+we.toString(16)),e.l+=ve}return t.SheetNames=Ar(f).sort(function(zt,lt){return Number(zt)-Number(lt)}).map(function(zt){return f[zt].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&v["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=v)):t.Preamble=v,t.Sheets&&z.forEach(function(zt,lt){t.Sheets[t.SheetNames[lt]]["!autofilter"]=zt}),t.Strings=p,t.SSF=fr(at),ee.enc&&(t.Encryption=ee.enc),pe&&(t.Themes=pe),t.Metadata={},J!==void 0&&(t.Metadata.Country=J),ue.names.length>0&&(M.Names=ue.names),t.Workbook=M,t}var zs={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function aE(e,r,t){var n=Je.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=mf(n,sc,zs.DSI);for(var f in s)r[f]=s[f]}catch(m){if(t.WTF)throw m}var u=Je.find(e,"/!SummaryInformation");if(u&&u.size>0)try{var x=mf(u,oc,zs.SI);for(var p in x)r[p]==null&&(r[p]=x[p])}catch(m){if(t.WTF)throw m}r.HeadingPairs&&r.TitlesOfParts&&(q1(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function nE(e,r){var t=[],n=[],s=[],f=0,u,x=Xl(sc,"n"),p=Xl(oc,"n");if(e.Props)for(u=Ar(e.Props),f=0;f<u.length;++f)(Object.prototype.hasOwnProperty.call(x,u[f])?t:Object.prototype.hasOwnProperty.call(p,u[f])?n:s).push([u[f],e.Props[u[f]]]);if(e.Custprops)for(u=Ar(e.Custprops),f=0;f<u.length;++f)Object.prototype.hasOwnProperty.call(e.Props||{},u[f])||(Object.prototype.hasOwnProperty.call(x,u[f])?t:Object.prototype.hasOwnProperty.call(p,u[f])?n:s).push([u[f],e.Custprops[u[f]]]);var m=[];for(f=0;f<s.length;++f)rh.indexOf(s[f][0])>-1||K1.indexOf(s[f][0])>-1||s[f][1]!=null&&m.push(s[f]);n.length&&Je.utils.cfb_add(r,"/SummaryInformation",pf(n,zs.SI,p,oc)),(t.length||m.length)&&Je.utils.cfb_add(r,"/DocumentSummaryInformation",pf(t,zs.DSI,x,sc,m.length?m:null,zs.UDI))}function Jh(e,r){r||(r={}),$c(r),yc(),r.codepage&&vc(r.codepage);var t,n;if(e.FullPaths){if(Je.find(e,"/encryption"))throw new Error("File is password-protected");t=Je.find(e,"!CompObj"),n=Je.find(e,"/Workbook")||Je.find(e,"/Book")}else{switch(r.type){case"base64":e=Oa(Ma(e));break;case"binary":e=Oa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Jr(e,0),n={content:e}}var s,f;if(t&&$y(t),r.bookProps&&!r.bookSheets)s={};else{var u=At?"buffer":"array";if(n&&n.content)s=rE(n.content,r);else if((f=Je.find(e,"PerfectOffice_MAIN"))&&f.content)s=Ci.to_workbook(f.content,(r.type=u,r));else if((f=Je.find(e,"NativeContent_MAIN"))&&f.content)s=Ci.to_workbook(f.content,(r.type=u,r));else throw(f=Je.find(e,"MN0"))&&f.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Je.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=pw(e))}var x={};return e.FullPaths&&aE(e,x,r),s.Props=s.Custprops=x,r.bookFiles&&(s.cfb=e),s}function iE(e,r){var t=r||{},n=Je.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Je.utils.cfb_add(n,s,Qh(e,t)),t.biff==8&&(e.Props||e.Custprops)&&nE(e,n),t.biff==8&&e.vbaraw&&ww(n,Je.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var n0={0:{f:k3},1:{f:B3},2:{f:r4},3:{f:X3},4:{f:W3},5:{f:$3},6:{f:o4},7:{f:q3},8:{f:x4},9:{f:d4},10:{f:h4},11:{f:u4},12:{f:j3},13:{f:n4},14:{f:Y3},15:{f:H3},16:{f:Hh},17:{f:l4},18:{f:J3},19:{f:Rc},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ly},40:{},42:{},43:{f:op},44:{f:ip},45:{f:fp},46:{f:up},47:{f:hp},48:{},49:{f:Dx},50:{},51:{f:zp},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:dh},62:{f:s4},63:{f:tw},64:{f:I4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:oa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:T4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:M3},148:{f:D3,p:16},151:{f:y4},152:{},153:{f:sy},154:{},155:{},156:{f:ny},157:{},158:{},159:{T:1,f:_m},160:{T:-1},161:{T:1,f:Bi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:g4},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Gp},336:{T:-1},337:{f:qp,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ic},357:{},358:{},359:{},360:{T:1},361:{},362:{f:uh},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:E4},427:{f:_4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:b4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:R3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:w4},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ic},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:uw},633:{T:1},634:{T:-1},635:{T:1,f:fw},636:{T:-1},637:{f:Px},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Y4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:F4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},dc={6:{f:Jo},10:{f:$n},12:{f:Pr},13:{f:Pr},14:{f:Tr},15:{f:Tr},16:{f:ia},17:{f:Tr},18:{f:Tr},19:{f:Pr},20:{f:Af},21:{f:Af},23:{f:uh},24:{f:Cf},25:{f:Tr},26:{},27:{},28:{f:F2},29:{},34:{f:Tr},35:{f:bf},38:{f:ia},39:{f:ia},40:{f:ia},41:{f:ia},42:{f:Tr},43:{f:Tr},47:{f:Hm},49:{f:n2},51:{f:Pr},60:{},61:{f:$g},64:{f:Tr},65:{f:a2},66:{f:Pr},77:{},80:{},81:{},82:{},85:{f:Pr},89:{},90:{},91:{},92:{f:Vg},93:{f:R2},94:{},95:{f:Tr},96:{},97:{},99:{f:Tr},125:{f:dh},128:{f:v2},129:{f:Gg},130:{f:Pr},131:{f:Tr},132:{f:Tr},133:{f:Xg},134:{},140:{f:V2},141:{f:Pr},144:{},146:{f:X2},151:{},152:{},153:{},154:{},155:{},156:{f:Pr},157:{},158:{},160:{f:Q2},161:{f:K2},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:g2},190:{f:m2},193:{f:$n},197:{},198:{},199:{},200:{},201:{},202:{f:Tr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Pr},220:{},221:{f:Tr},222:{},224:{f:w2},225:{f:Wg},226:{f:$n},227:{},229:{f:D2},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Yg},253:{f:s2},255:{f:qg},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ah},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Tr},353:{f:$n},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:b2},431:{f:Tr},432:{},433:{},434:{},437:{},438:{f:B2},439:{f:Tr},440:{f:L2},441:{},442:{f:f0},443:{},444:{f:Pr},445:{},446:{},448:{f:$n},449:{f:Qg,r:2},450:{f:$n},512:{f:yf},513:{f:J2},515:{f:_2},516:{f:c2},517:{f:_f},519:{f:$2},520:{f:Zg},523:{},545:{f:Tf},549:{f:vf},566:{},574:{f:t2},638:{f:x2},659:{},1048:{},1054:{f:f2},1084:{},1212:{f:N2},2048:{f:U2},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:K0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:$n},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:z2,r:12},2173:{f:Vp,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Tr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:S2,r:12},2197:{},2198:{f:Pp,r:12},2199:{},2200:{},2201:{},2202:{f:k2,r:12},2203:{f:$n},2204:{},2205:{},2206:{},2207:{},2211:{f:Jg},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Pr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:q2},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:G2},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:yf},1:{},2:{f:nm},3:{f:rm},4:{f:tm},5:{f:_f},7:{f:sm},8:{},9:{f:K0},11:{},22:{f:Pr},30:{f:u2},31:{},32:{},33:{f:Tf},36:{},37:{f:vf},50:{f:om},62:{},52:{},67:{},68:{f:Pr},69:{},86:{},126:{},127:{f:em},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:cm},223:{},234:{},354:{},421:{},518:{f:Jo},521:{f:K0},536:{f:Cf},547:{f:bf},561:{},579:{},1030:{f:Jo},1033:{f:K0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ue(e,r,t,n){var s=r;if(!isNaN(s)){var f=n||(t||[]).length||0,u=e.next(4);u.write_shift(2,s),u.write_shift(2,f),f>0&&Fc(t)&&e.push(t)}}function sE(e,r,t,n){var s=(t||[]).length||0;if(s<=8224)return Ue(e,r,t,s);var f=r;if(!isNaN(f)){for(var u=t.parts||[],x=0,p=0,m=0;m+(u[x]||8224)<=8224;)m+=u[x]||8224,x++;var v=e.next(4);for(v.write_shift(2,f),v.write_shift(2,m),e.push(t.slice(p,p+m)),p+=m;p<s;){for(v=e.next(4),v.write_shift(2,60),m=0;m+(u[x]||8224)<=8224;)m+=u[x]||8224,x++;v.write_shift(2,m),e.push(t.slice(p,p+m)),p+=m}}}function x0(e,r,t){return e||(e=_e(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function oE(e,r,t,n){var s=_e(9);return x0(s,e,r),nh(t,n||"b",s),s}function cE(e,r,t){var n=_e(8+2*t.length);return x0(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function lE(e,r,t,n){if(r.v!=null)switch(r.t){case"d":case"n":var s=r.t=="d"?Ur(lr(r.v)):r.v;s==(s|0)&&s>=0&&s<65536?Ue(e,2,im(t,n,s)):Ue(e,3,am(t,n,s));return;case"b":case"e":Ue(e,5,oE(t,n,r.v,r.t));return;case"s":case"str":Ue(e,4,cE(t,n,(r.v||"").slice(0,255)));return}Ue(e,1,x0(null,t,n))}function fE(e,r,t,n){var s=Array.isArray(r),f=Pt(r["!ref"]||"A1"),u,x="",p=[];if(f.e.c>255||f.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,16383),u=gt(f)}for(var m=f.s.r;m<=f.e.r;++m){x=Sr(m);for(var v=f.s.c;v<=f.e.c;++v){m===f.s.r&&(p[v]=mr(v)),u=p[v]+x;var E=s?(r[m]||[])[v]:r[u];E&&lE(e,E,m,v)}}}function hE(e,r){for(var t=r||{},n=_a(),s=0,f=0;f<e.SheetNames.length;++f)e.SheetNames[f]==t.sheet&&(s=f);if(s==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ue(n,t.biff==4?1033:t.biff==3?521:9,Wc(e,16,t)),fE(n,e.Sheets[e.SheetNames[s]],s,t),Ue(n,10),n.end()}function uE(e,r,t){Ue(e,49,i2({sz:12,name:"Arial"},t))}function dE(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)r[s]!=null&&Ue(e,1054,h2(s,r[s],t))})}function xE(e,r){var t=_e(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Ue(e,2151,t),t=_e(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),lh(Pt(r["!ref"]||"A1"),t),t.write_shift(4,4),Ue(e,2152,t)}function gE(e,r){for(var t=0;t<16;++t)Ue(e,224,Ef({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){Ue(e,224,Ef(n,0,r))})}function mE(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];Ue(e,440,j2(n)),n[1].Tooltip&&Ue(e,2048,W2(n))}delete r["!links"]}function pE(e,r){if(r){var t=0;r.forEach(function(n,s){++t<=256&&n&&Ue(e,125,Y2(So(s,n),s))})}}function wE(e,r,t,n,s){var f=16+ci(s.cellXfs,r,s);if(r.v==null&&!r.bf){Ue(e,513,Fi(t,n,f));return}if(r.bf)Ue(e,6,Gv(r,t,n,s,f));else switch(r.t){case"d":case"n":var u=r.t=="d"?Ur(lr(r.v)):r.v;Ue(e,515,A2(t,n,u,f));break;case"b":case"e":Ue(e,517,E2(t,n,r.v,f,s,r.t));break;case"s":case"str":if(s.bookSST){var x=qc(s.Strings,r.v,s.revStrings);Ue(e,253,o2(t,n,x,f))}else Ue(e,516,l2(t,n,(r.v||"").slice(0,255),f,s));break;default:Ue(e,513,Fi(t,n,f))}}function vE(e,r,t){var n=_a(),s=t.SheetNames[e],f=t.Sheets[s]||{},u=(t||{}).Workbook||{},x=(u.Sheets||[])[e]||{},p=Array.isArray(f),m=r.biff==8,v,E="",b=[],S=Pt(f["!ref"]||"A1"),k=m?65536:16384;if(S.e.c>255||S.e.r>=k){if(r.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:IV16384");S.e.c=Math.min(S.e.c,255),S.e.r=Math.min(S.e.c,k-1)}Ue(n,2057,Wc(t,16,r)),Ue(n,13,Ga(1)),Ue(n,12,Ga(100)),Ue(n,15,ga(!0)),Ue(n,17,ga(!1)),Ue(n,16,ki(.001)),Ue(n,95,ga(!0)),Ue(n,42,ga(!1)),Ue(n,43,ga(!1)),Ue(n,130,Ga(1)),Ue(n,128,y2()),Ue(n,131,ga(!1)),Ue(n,132,ga(!1)),m&&pE(n,f["!cols"]),Ue(n,512,d2(S,r)),m&&(f["!links"]=[]);for(var A=S.s.r;A<=S.e.r;++A){E=Sr(A);for(var F=S.s.c;F<=S.e.c;++F){A===S.s.r&&(b[F]=mr(F)),v=b[F]+E;var V=p?(f[A]||[])[F]:f[v];V&&(wE(n,V,A,F,r),m&&V.l&&f["!links"].push([v,V.l]))}}var G=x.CodeName||x.name||s;return m&&Ue(n,574,r2((u.Views||[])[0])),m&&(f["!merges"]||[]).length&&Ue(n,229,O2(f["!merges"])),m&&mE(n,f),Ue(n,442,ih(G)),m&&xE(n,f),Ue(n,10),n.end()}function yE(e,r,t){var n=_a(),s=(e||{}).Workbook||{},f=s.Sheets||[],u=s.WBProps||{},x=t.biff==8,p=t.biff==5;if(Ue(n,2057,Wc(e,5,t)),t.bookType=="xla"&&Ue(n,135),Ue(n,225,x?Ga(1200):null),Ue(n,193,Eg(2)),p&&Ue(n,191),p&&Ue(n,192),Ue(n,226),Ue(n,92,Hg("SheetJS",t)),Ue(n,66,Ga(x?1200:1252)),x&&Ue(n,353,Ga(0)),x&&Ue(n,448),Ue(n,317,Z2(e.SheetNames.length)),x&&e.vbaraw&&Ue(n,211),x&&e.vbaraw){var m=u.CodeName||"ThisWorkbook";Ue(n,442,ih(m))}Ue(n,156,Ga(17)),Ue(n,25,ga(!1)),Ue(n,18,ga(!1)),Ue(n,19,Ga(0)),x&&Ue(n,431,ga(!1)),x&&Ue(n,444,Ga(0)),Ue(n,61,e2()),Ue(n,64,ga(!1)),Ue(n,141,Ga(0)),Ue(n,34,ga(Q4(e)=="true")),Ue(n,14,ga(!0)),x&&Ue(n,439,ga(!1)),Ue(n,218,Ga(0)),uE(n,e,t),dE(n,e.SSF,t),gE(n,t),x&&Ue(n,352,ga(!1));var v=n.end(),E=_a();x&&Ue(E,140,H2()),x&&t.Strings&&sE(E,252,Kg(t.Strings)),Ue(E,10);var b=E.end(),S=_a(),k=0,A=0;for(A=0;A<e.SheetNames.length;++A)k+=(x?12:11)+(x?2:1)*e.SheetNames[A].length;var F=v.length+k+b.length;for(A=0;A<e.SheetNames.length;++A){var V=f[A]||{};Ue(S,133,zg({pos:F,hs:V.Hidden||0,dt:0,name:e.SheetNames[A]},t)),F+=r[A].length}var G=S.end();if(k!=G.length)throw new Error("BS8 "+k+" != "+G.length);var D=[];return v.length&&D.push(v),G.length&&D.push(G),b.length&&D.push(b),Gr(D)}function EE(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=fr(at)),e&&e.SSF&&(ds(),yo(e.SSF),t.revssf=_o(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,el(t),t.cellXfs=[],ci(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=vE(s,t,e);return n.unshift(yE(e,n,t)),Gr(n)}function Qh(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(!(!n||!n["!ref"])){var s=Aa(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var f=r||{};switch(f.biff||2){case 8:case 5:return EE(e,r);case 4:case 3:case 2:return hE(e,r)}throw new Error("invalid type "+f.bookType+" for BIFF")}function Pf(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var f=e.match(/<\/table/i),u=s.index,x=f&&f.index||e.length,p=ix(e.slice(u,x),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,v=0,E=0,b=0,S={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(u=0;u<p.length;++u){var A=p[u].trim(),F=A.slice(0,3).toLowerCase();if(F=="<tr"){if(++m,t.sheetRows&&t.sheetRows<=m){--m;break}v=0;continue}if(!(F!="<td"&&F!="<th")){var V=A.split(/<\/t[dh]>/i);for(x=0;x<V.length;++x){var G=V[x].trim();if(G.match(/<t[dh]/i)){for(var D=G,J=0;D.charAt(0)=="<"&&(J=D.indexOf(">"))>-1;)D=D.slice(J+1);for(var ie=0;ie<k.length;++ie){var Q=k[ie];Q.s.c==v&&Q.s.r<m&&m<=Q.e.r&&(v=Q.e.c+1,ie=-1)}var M=ot(G.slice(0,G.indexOf(">")));b=M.colspan?+M.colspan:1,((E=+M.rowspan)>1||b>1)&&k.push({s:{r:m,c:v},e:{r:m+(E||1)-1,c:v+b-1}});var ne=M.t||M["data-t"]||"";if(!D.length){v+=b;continue}if(D=_1(D),S.s.r>m&&(S.s.r=m),S.e.r<m&&(S.e.r=m),S.s.c>v&&(S.s.c=v),S.e.c<v&&(S.e.c=v),!D.length){v+=b;continue}var X={t:"s",v:D};t.raw||!D.trim().length||ne=="s"||(D==="TRUE"?X={t:"b",v:!0}:D==="FALSE"?X={t:"b",v:!1}:isNaN(sn(D))?isNaN(cs(D).getDate())||(X={t:"d",v:lr(D)},t.cellDates||(X={t:"n",v:Ur(X.v)}),X.z=t.dateNF||at[14]):X={t:"n",v:sn(D)}),t.dense?(n[m]||(n[m]=[]),n[m][v]=X):n[it({r:m,c:v})]=X,v+=b}}}}return n["!ref"]=gt(S),k.length&&(n["!merges"]=k),n}function _E(e,r,t,n){for(var s=e["!merges"]||[],f=[],u=r.s.c;u<=r.e.c;++u){for(var x=0,p=0,m=0;m<s.length;++m)if(!(s[m].s.r>t||s[m].s.c>u)&&!(s[m].e.r<t||s[m].e.c<u)){if(s[m].s.r<t||s[m].s.c<u){x=-1;break}x=s[m].e.r-s[m].s.r+1,p=s[m].e.c-s[m].s.c+1;break}if(!(x<0)){var v=it({r:t,c:u}),E=n.dense?(e[t]||[])[u]:e[v],b=E&&E.v!=null&&(E.h||Nc(E.w||(Bn(E),E.w)||""))||"",S={};x>1&&(S.rowspan=x),p>1&&(S.colspan=p),n.editable?b='<span contenteditable="true">'+b+"</span>":E&&(S["data-t"]=E&&E.t||"z",E.v!=null&&(S["data-v"]=E.v),E.z!=null&&(S["data-z"]=E.z),E.l&&(E.l.Target||"#").charAt(0)!="#"&&(b='<a href="'+E.l.Target+'">'+b+"</a>")),S.id=(n.id||"sjs")+"-"+v,f.push(je("td",b,S))}}var k="<tr>";return k+f.join("")+"</tr>"}var AE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bE="</body></html>";function CE(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return oi(Pf(t[0],r),r);var n=al();return t.forEach(function(s,f){nl(n,Pf(s,r),"Sheet"+(f+1))}),n}function TE(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function $h(e,r){var t=r||{},n=t.header!=null?t.header:AE,s=t.footer!=null?t.footer:bE,f=[n],u=Aa(e["!ref"]);t.dense=Array.isArray(e),f.push(TE(e,u,t));for(var x=u.s.r;x<=u.e.r;++x)f.push(_E(e,u,x,t));return f.push("</table>"+s),f.join("")}function eu(e,r,t){var n=t||{},s=0,f=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?pr(n.origin):n.origin;s=u.r,f=u.c}var x=r.getElementsByTagName("tr"),p=Math.min(n.sheetRows||1e7,x.length),m={s:{r:0,c:0},e:{r:s,c:f}};if(e["!ref"]){var v=Aa(e["!ref"]);m.s.r=Math.min(m.s.r,v.s.r),m.s.c=Math.min(m.s.c,v.s.c),m.e.r=Math.max(m.e.r,v.e.r),m.e.c=Math.max(m.e.c,v.e.c),s==-1&&(m.e.r=s=v.e.r+1)}var E=[],b=0,S=e["!rows"]||(e["!rows"]=[]),k=0,A=0,F=0,V=0,G=0,D=0;for(e["!cols"]||(e["!cols"]=[]);k<x.length&&A<p;++k){var J=x[k];if(Bf(J)){if(n.display)continue;S[A]={hidden:!0}}var ie=J.children;for(F=V=0;F<ie.length;++F){var Q=ie[F];if(!(n.display&&Bf(Q))){var M=Q.hasAttribute("data-v")?Q.getAttribute("data-v"):Q.hasAttribute("v")?Q.getAttribute("v"):_1(Q.innerHTML),ne=Q.getAttribute("data-z")||Q.getAttribute("z");for(b=0;b<E.length;++b){var X=E[b];X.s.c==V+f&&X.s.r<A+s&&A+s<=X.e.r&&(V=X.e.c+1-f,b=-1)}D=+Q.getAttribute("colspan")||1,((G=+Q.getAttribute("rowspan")||1)>1||D>1)&&E.push({s:{r:A+s,c:V+f},e:{r:A+s+(G||1)-1,c:V+f+(D||1)-1}});var me={t:"s",v:M},le=Q.getAttribute("data-t")||Q.getAttribute("t")||"";M!=null&&(M.length==0?me.t=le||"z":n.raw||M.trim().length==0||le=="s"||(M==="TRUE"?me={t:"b",v:!0}:M==="FALSE"?me={t:"b",v:!1}:isNaN(sn(M))?isNaN(cs(M).getDate())||(me={t:"d",v:lr(M)},n.cellDates||(me={t:"n",v:Ur(me.v)}),me.z=n.dateNF||at[14]):me={t:"n",v:sn(M)})),me.z===void 0&&ne!=null&&(me.z=ne);var ee="",pe=Q.getElementsByTagName("A");if(pe&&pe.length)for(var Pe=0;Pe<pe.length&&!(pe[Pe].hasAttribute("href")&&(ee=pe[Pe].getAttribute("href"),ee.charAt(0)!="#"));++Pe);ee&&ee.charAt(0)!="#"&&(me.l={Target:ee}),n.dense?(e[A+s]||(e[A+s]=[]),e[A+s][V+f]=me):e[it({c:V+f,r:A+s})]=me,m.e.c<V+f&&(m.e.c=V+f),V+=D}}++A}return E.length&&(e["!merges"]=(e["!merges"]||[]).concat(E)),m.e.r=Math.max(m.e.r,A-1+s),e["!ref"]=gt(m),A>=p&&(e["!fullref"]=gt((m.e.r=x.length-k+A-1+s,m))),e}function tu(e,r){var t=r||{},n=t.dense?[]:{};return eu(n,e,r)}function SE(e,r){return oi(tu(e,r),r)}function Bf(e){var r="",t=NE(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function NE(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function kE(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Mt(r.replace(/<[^>]*>/g,""));return[t]}var Lf={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ru(e,r){var t=r||{},n=kc(e),s=[],f,u,x={name:""},p="",m=0,v,E,b={},S=[],k=t.dense?[]:{},A,F,V={value:""},G="",D=0,J=[],ie=-1,Q=-1,M={s:{r:1e6,c:1e7},e:{r:0,c:0}},ne=0,X={},me=[],le={},ee=0,pe=0,Pe=[],re=1,Le=1,be=[],St={Names:[]},ue={},Ye=["",""],Qe=[],K={},ae="",z=0,N=!1,B=!1,Ne=0;for(Qs.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");A=Qs.exec(n);)switch(A[3]=A[3].replace(/_.*$/,"")){case"table":case"工作表":A[1]==="/"?(M.e.c>=M.s.c&&M.e.r>=M.s.r?k["!ref"]=gt(M):k["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=M.e.r&&(k["!fullref"]=k["!ref"],M.e.r=t.sheetRows-1,k["!ref"]=gt(M)),me.length&&(k["!merges"]=me),Pe.length&&(k["!rows"]=Pe),v.name=v.名称||v.name,typeof JSON<"u"&&JSON.stringify(v),S.push(v.name),b[v.name]=k,B=!1):A[0].charAt(A[0].length-2)!=="/"&&(v=ot(A[0],!1),ie=Q=-1,M.s.r=M.s.c=1e7,M.e.r=M.e.c=0,k=t.dense?[]:{},me=[],Pe=[],B=!0);break;case"table-row-group":A[1]==="/"?--ne:++ne;break;case"table-row":case"行":if(A[1]==="/"){ie+=re,re=1;break}if(E=ot(A[0],!1),E.行号?ie=E.行号-1:ie==-1&&(ie=0),re=+E["number-rows-repeated"]||1,re<10)for(Ne=0;Ne<re;++Ne)ne>0&&(Pe[ie+Ne]={level:ne});Q=-1;break;case"covered-table-cell":A[1]!=="/"&&++Q,t.sheetStubs&&(t.dense?(k[ie]||(k[ie]=[]),k[ie][Q]={t:"z"}):k[it({r:ie,c:Q})]={t:"z"}),G="",J=[];break;case"table-cell":case"数据":if(A[0].charAt(A[0].length-2)==="/")++Q,V=ot(A[0],!1),Le=parseInt(V["number-columns-repeated"]||"1",10),F={t:"z",v:null},V.formula&&t.cellFormula!=!1&&(F.f=Of(Mt(V.formula))),(V.数据类型||V["value-type"])=="string"&&(F.t="s",F.v=Mt(V["string-value"]||""),t.dense?(k[ie]||(k[ie]=[]),k[ie][Q]=F):k[it({r:ie,c:Q})]=F),Q+=Le-1;else if(A[1]!=="/"){++Q,G="",D=0,J=[],Le=1;var we=re?ie+re-1:ie;if(Q>M.e.c&&(M.e.c=Q),Q<M.s.c&&(M.s.c=Q),ie<M.s.r&&(M.s.r=ie),we>M.e.r&&(M.e.r=we),V=ot(A[0],!1),Qe=[],K={},F={t:V.数据类型||V["value-type"],v:null},t.cellFormula)if(V.formula&&(V.formula=Mt(V.formula)),V["number-matrix-columns-spanned"]&&V["number-matrix-rows-spanned"]&&(ee=parseInt(V["number-matrix-rows-spanned"],10)||0,pe=parseInt(V["number-matrix-columns-spanned"],10)||0,le={s:{r:ie,c:Q},e:{r:ie+ee-1,c:Q+pe-1}},F.F=gt(le),be.push([le,F.F])),V.formula)F.f=Of(V.formula);else for(Ne=0;Ne<be.length;++Ne)ie>=be[Ne][0].s.r&&ie<=be[Ne][0].e.r&&Q>=be[Ne][0].s.c&&Q<=be[Ne][0].e.c&&(F.F=be[Ne][1]);switch((V["number-columns-spanned"]||V["number-rows-spanned"])&&(ee=parseInt(V["number-rows-spanned"],10)||0,pe=parseInt(V["number-columns-spanned"],10)||0,le={s:{r:ie,c:Q},e:{r:ie+ee-1,c:Q+pe-1}},me.push(le)),V["number-columns-repeated"]&&(Le=parseInt(V["number-columns-repeated"],10)),F.t){case"boolean":F.t="b",F.v=cr(V["boolean-value"]);break;case"float":F.t="n",F.v=parseFloat(V.value);break;case"percentage":F.t="n",F.v=parseFloat(V.value);break;case"currency":F.t="n",F.v=parseFloat(V.value);break;case"date":F.t="d",F.v=lr(V["date-value"]),t.cellDates||(F.t="n",F.v=Ur(F.v)),F.z="m/d/yy";break;case"time":F.t="n",F.v=rx(V["time-value"])/86400,t.cellDates&&(F.t="d",F.v=Ao(F.v)),F.z="HH:MM:SS";break;case"number":F.t="n",F.v=parseFloat(V.数据数值);break;default:if(F.t==="string"||F.t==="text"||!F.t)F.t="s",V["string-value"]!=null&&(G=Mt(V["string-value"]),J=[]);else throw new Error("Unsupported value type "+F.t)}}else{if(N=!1,F.t==="s"&&(F.v=G||"",J.length&&(F.R=J),N=D==0),ue.Target&&(F.l=ue),Qe.length>0&&(F.c=Qe,Qe=[]),G&&t.cellText!==!1&&(F.w=G),N&&(F.t="z",delete F.v),(!N||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=ie))for(var ve=0;ve<re;++ve){if(Le=parseInt(V["number-columns-repeated"]||"1",10),t.dense)for(k[ie+ve]||(k[ie+ve]=[]),k[ie+ve][Q]=ve==0?F:fr(F);--Le>0;)k[ie+ve][Q+Le]=fr(F);else for(k[it({r:ie+ve,c:Q})]=F;--Le>0;)k[it({r:ie+ve,c:Q+Le})]=fr(F);M.e.c<=Q&&(M.e.c=Q)}Le=parseInt(V["number-columns-repeated"]||"1",10),Q+=Le-1,Le=0,F={},G="",J=[]}ue={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(A[1]==="/"){if((f=s.pop())[0]!==A[3])throw"Bad state: "+f}else A[0].charAt(A[0].length-2)!=="/"&&s.push([A[3],!0]);break;case"annotation":if(A[1]==="/"){if((f=s.pop())[0]!==A[3])throw"Bad state: "+f;K.t=G,J.length&&(K.R=J),K.a=ae,Qe.push(K)}else A[0].charAt(A[0].length-2)!=="/"&&s.push([A[3],!1]);ae="",z=0,G="",D=0,J=[];break;case"creator":A[1]==="/"?ae=n.slice(z,A.index):z=A.index+A[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(A[1]==="/"){if((f=s.pop())[0]!==A[3])throw"Bad state: "+f}else A[0].charAt(A[0].length-2)!=="/"&&s.push([A[3],!1]);G="",D=0,J=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(A[1]==="/"){if(X[x.name]=p,(f=s.pop())[0]!==A[3])throw"Bad state: "+f}else A[0].charAt(A[0].length-2)!=="/"&&(p="",x=ot(A[0],!1),s.push([A[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":u=ot(A[0],!1),p+=Lf[A[3]][u.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":u=ot(A[0],!1),p+=Lf[A[3]][u.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(A[0].slice(-2)==="/>")break;if(A[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":p+=n.slice(m,A.index);break}else m=A.index+A[0].length;break;case"named-range":u=ot(A[0],!1),Ye=Qo(u["cell-range-address"]);var Ae={Name:u.name,Ref:Ye[0]+"!"+Ye[1]};B&&(Ae.Sheet=S.length),St.Names.push(Ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(A[1]==="/"&&(!V||!V["string-value"])){var Xe=kE(n.slice(D,A.index));G=(G.length>0?G+`
`:"")+Xe[0]}else ot(A[0],!1),D=A.index+A[0].length;break;case"s":break;case"database-range":if(A[1]==="/")break;try{Ye=Qo(ot(A[0])["target-range-address"]),b[Ye[0]]["!autofilter"]={ref:Ye[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(A[1]!=="/"){if(ue=ot(A[0],!1),!ue.href)break;ue.Target=Mt(ue.href),delete ue.href,ue.Target.charAt(0)=="#"&&ue.Target.indexOf(".")>-1?(Ye=Qo(ue.Target.slice(1)),ue.Target="#"+Ye[0]+"!"+Ye[1]):ue.Target.match(/^\.\.[\\\/]/)&&(ue.Target=ue.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(A[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(A)}}var Z={Sheets:b,SheetNames:S,Workbook:St};return t.bookSheets&&delete Z.Sheets,Z}function jf(e,r){r=r||{},Ha(e,"META-INF/manifest.xml")&&rg(Mr(e,"META-INF/manifest.xml"),r);var t=Ra(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=ru(qt(t),r);return Ha(e,"meta.xml")&&(n.Props=z1(Mr(e,"meta.xml"))),n}function Uf(e,r){return ru(e,r)}var IE=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Js({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Nr+r}}(),Wf=function(){var e=function(f){return Xt(f).replace(/  +/g,function(u){return'<text:s text:c="'+u.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(f,u,x){var p=[];p.push('      <table:table table:name="'+Xt(u.SheetNames[x])+`" table:style-name="ta1">
`);var m=0,v=0,E=Aa(f["!ref"]||"A1"),b=f["!merges"]||[],S=0,k=Array.isArray(f);if(f["!cols"])for(v=0;v<=E.e.c;++v)p.push("        <table:table-column"+(f["!cols"][v]?' table:style-name="co'+f["!cols"][v].ods+'"':"")+`></table:table-column>
`);var A="",F=f["!rows"]||[];for(m=0;m<E.s.r;++m)A=F[m]?' table:style-name="ro'+F[m].ods+'"':"",p.push("        <table:table-row"+A+`></table:table-row>
`);for(;m<=E.e.r;++m){for(A=F[m]?' table:style-name="ro'+F[m].ods+'"':"",p.push("        <table:table-row"+A+`>
`),v=0;v<E.s.c;++v)p.push(r);for(;v<=E.e.c;++v){var V=!1,G={},D="";for(S=0;S!=b.length;++S)if(!(b[S].s.c>v)&&!(b[S].s.r>m)&&!(b[S].e.c<v)&&!(b[S].e.r<m)){(b[S].s.c!=v||b[S].s.r!=m)&&(V=!0),G["table:number-columns-spanned"]=b[S].e.c-b[S].s.c+1,G["table:number-rows-spanned"]=b[S].e.r-b[S].s.r+1;break}if(V){p.push(t);continue}var J=it({r:m,c:v}),ie=k?(f[m]||[])[v]:f[J];if(ie&&ie.f&&(G["table:formula"]=Xt(Zv(ie.f)),ie.F&&ie.F.slice(0,J.length)==J)){var Q=Aa(ie.F);G["table:number-matrix-columns-spanned"]=Q.e.c-Q.s.c+1,G["table:number-matrix-rows-spanned"]=Q.e.r-Q.s.r+1}if(!ie){p.push(r);continue}switch(ie.t){case"b":D=ie.v?"TRUE":"FALSE",G["office:value-type"]="boolean",G["office:boolean-value"]=ie.v?"true":"false";break;case"n":D=ie.w||String(ie.v||0),G["office:value-type"]="float",G["office:value"]=ie.v||0;break;case"s":case"str":D=ie.v==null?"":ie.v,G["office:value-type"]="string";break;case"d":D=ie.w||lr(ie.v).toISOString(),G["office:value-type"]="date",G["office:date-value"]=lr(ie.v).toISOString(),G["table:style-name"]="ce1";break;default:p.push(r);continue}var M=e(D);if(ie.l&&ie.l.Target){var ne=ie.l.Target;ne=ne.charAt(0)=="#"?"#"+Jv(ne.slice(1)):ne,ne.charAt(0)!="#"&&!ne.match(/^\w+:/)&&(ne="../"+ne),M=je("text:a",M,{"xlink:href":ne.replace(/&/g,"&amp;")})}p.push("          "+je("table:table-cell",je("text:p",M,{}),G)+`
`)}p.push(`        </table:table-row>
`)}return p.push(`      </table:table>
`),p.join("")},s=function(f,u){f.push(` <office:automatic-styles>
`),f.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),f.push(`   <number:month number:style="long"/>
`),f.push(`   <number:text>/</number:text>
`),f.push(`   <number:day number:style="long"/>
`),f.push(`   <number:text>/</number:text>
`),f.push(`   <number:year/>
`),f.push(`  </number:date-style>
`);var x=0;u.SheetNames.map(function(m){return u.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var v=0;v<m["!cols"].length;++v)if(m["!cols"][v]){var E=m["!cols"][v];if(E.width==null&&E.wpx==null&&E.wch==null)continue;ai(E),E.ods=x;var b=m["!cols"][v].wpx+"px";f.push('  <style:style style:name="co'+x+`" style:family="table-column">
`),f.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+b+`"/>
`),f.push(`  </style:style>
`),++x}}});var p=0;u.SheetNames.map(function(m){return u.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var v=0;v<m["!rows"].length;++v)if(m["!rows"][v]){m["!rows"][v].ods=p;var E=m["!rows"][v].hpx+"px";f.push('  <style:style style:name="ro'+p+`" style:family="table-row">
`),f.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+E+`"/>
`),f.push(`  </style:style>
`),++p}}}),f.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),f.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),f.push(`  </style:style>
`),f.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),f.push(` </office:automatic-styles>
`)};return function(u,x){var p=[Nr],m=Js({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),v=Js({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});x.bookType=="fods"?(p.push("<office:document"+m+v+`>
`),p.push(X1().replace(/office:document-meta/g,"office:meta"))):p.push("<office:document-content"+m+`>
`),s(p,u),p.push(`  <office:body>
`),p.push(`    <office:spreadsheet>
`);for(var E=0;E!=u.SheetNames.length;++E)p.push(n(u.Sheets[u.SheetNames[E]],u,E));return p.push(`    </office:spreadsheet>
`),p.push(`  </office:body>
`),x.bookType=="fods"?p.push("</office:document>"):p.push("</office:document-content>"),p.join("")}}();function au(e,r){if(r.bookType=="fods")return Wf(e,r);var t=Cc(),n="",s=[],f=[];return n="mimetype",Et(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Et(t,n,Wf(e,r)),s.push([n,"text/xml"]),f.push([n,"ContentFile"]),n="styles.xml",Et(t,n,IE(e,r)),s.push([n,"text/xml"]),f.push([n,"StylesFile"]),n="meta.xml",Et(t,n,Nr+X1()),s.push([n,"text/xml"]),f.push([n,"MetadataFile"]),n="manifest.rdf",Et(t,n,ig(f)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Et(t,n,ag(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Di(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function xc(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):qt(si(e))}function FE(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Oa(wn(e))}function DE(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var n=0;n<r.length;++n)if(e[t+n]!=r[n])continue e;return!0}return!1}function ii(e){var r=e.reduce(function(s,f){return s+f.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(s){t.set(s,n),n+=s.length}),t}function Vf(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function OE(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,s=r+13;s>=r;--s)n=n*256+e[s];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function RE(e,r,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(n&127)<<1;for(var f=0;s>=1;++f,s/=256)e[r+f]=s&255;e[r+15]|=t>=0?0:128}function i0(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function Ht(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function _r(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Lt(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],s=i0(e,t),f=s&7;s=Math.floor(s/8);var u=0,x;if(s==0)break;switch(f){case 0:{for(var p=t[0];e[t[0]++]>=128;);x=e.slice(p,t[0])}break;case 5:u=4,x=e.slice(t[0],t[0]+u),t[0]+=u;break;case 1:u=8,x=e.slice(t[0],t[0]+u),t[0]+=u;break;case 2:u=i0(e,t),x=e.slice(t[0],t[0]+u),t[0]+=u;break;case 3:case 4:default:throw new Error("PB Type ".concat(f," for Field ").concat(s," at offset ").concat(n))}var m={data:x,type:f};r[s]==null?r[s]=[m]:r[s].push(m)}return r}function Zr(e){var r=[];return e.forEach(function(t,n){t.forEach(function(s){s.data&&(r.push(Ht(n*8+s.type)),s.type==2&&r.push(Ht(s.data.length)),r.push(s.data))})}),ii(r)}function Qc(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function Wa(e){for(var r,t=[],n=[0];n[0]<e.length;){var s=i0(e,n),f=Lt(e.slice(n[0],n[0]+s));n[0]+=s;var u={id:_r(f[1][0].data),messages:[]};f[2].forEach(function(x){var p=Lt(x.data),m=_r(p[3][0].data);u.messages.push({meta:p,data:e.slice(n[0],n[0]+m)}),n[0]+=m}),(r=f[3])!=null&&r[0]&&(u.merge=_r(f[3][0].data)>>>0>0),t.push(u)}return t}function $i(e){var r=[];return e.forEach(function(t){var n=[];n[1]=[{data:Ht(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:Ht(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(u){s.push(u.data),u.meta[3]=[{type:0,data:Ht(u.data.length)}],n[2].push({data:Zr(u.meta),type:2})});var f=Zr(n);r.push(Ht(f.length)),r.push(f),s.forEach(function(u){return r.push(u)})}),ii(r)}function ME(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=i0(r,t),s=[];t[0]<r.length;){var f=r[t[0]]&3;if(f==0){var u=r[t[0]++]>>2;if(u<60)++u;else{var x=u-59;u=r[t[0]],x>1&&(u|=r[t[0]+1]<<8),x>2&&(u|=r[t[0]+2]<<16),x>3&&(u|=r[t[0]+3]<<24),u>>>=0,u++,t[0]+=x}s.push(r.slice(t[0],t[0]+u)),t[0]+=u;continue}else{var p=0,m=0;if(f==1?(m=(r[t[0]]>>2&7)+4,p=(r[t[0]++]&224)<<3,p|=r[t[0]++]):(m=(r[t[0]++]>>2)+1,f==2?(p=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(p=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),s=[ii(s)],p==0)throw new Error("Invalid offset 0");if(p>s[0].length)throw new Error("Invalid offset beyond length");if(m>=p)for(s.push(s[0].slice(-p)),m-=p;m>=s[s.length-1].length;)s.push(s[s.length-1]),m-=s[s.length-1].length;s.push(s[0].slice(-p,-p+m))}}var v=ii(s);if(v.length!=n)throw new Error("Unexpected length: ".concat(v.length," != ").concat(n));return v}function Va(e){for(var r=[],t=0;t<e.length;){var n=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(ME(n,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return ii(r)}function es(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),s=new Uint8Array(4);r.push(s);var f=Ht(n),u=f.length;r.push(f),n<=60?(u++,r.push(new Uint8Array([n-1<<2]))):n<=256?(u+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(u+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(u+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(u+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e.slice(t,t+n)),u+=n,s[0]=0,s[1]=u&255,s[2]=u>>8&255,s[3]=u>>16&255,t+=n}return ii(r)}function PE(e,r,t,n){var s=Di(e),f=s.getUint32(4,!0),u=(n>1?12:8)+Vf(f&(n>1?3470:398))*4,x=-1,p=-1,m=NaN,v=new Date(2001,0,1);f&512&&(x=s.getUint32(u,!0),u+=4),u+=Vf(f&(n>1?12288:4096))*4,f&16&&(p=s.getUint32(u,!0),u+=4),f&32&&(m=s.getFloat64(u,!0),u+=8),f&64&&(v.setTime(v.getTime()+s.getFloat64(u,!0)*1e3),u+=8);var E;switch(e[2]){case 0:break;case 2:E={t:"n",v:m};break;case 3:E={t:"s",v:r[p]};break;case 5:E={t:"d",v};break;case 6:E={t:"b",v:m>0};break;case 7:E={t:"n",v:m/86400};break;case 8:E={t:"e",v:0};break;case 9:if(x>-1)E={t:"s",v:t[x]};else if(p>-1)E={t:"s",v:r[p]};else if(!isNaN(m))E={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return E}function BE(e,r,t){var n=Di(e),s=n.getUint32(8,!0),f=12,u=-1,x=-1,p=NaN,m=NaN,v=new Date(2001,0,1);s&1&&(p=OE(e,f),f+=16),s&2&&(m=n.getFloat64(f,!0),f+=8),s&4&&(v.setTime(v.getTime()+n.getFloat64(f,!0)*1e3),f+=8),s&8&&(x=n.getUint32(f,!0),f+=4),s&16&&(u=n.getUint32(f,!0),f+=4);var E;switch(e[1]){case 0:break;case 2:E={t:"n",v:p};break;case 3:E={t:"s",v:r[x]};break;case 5:E={t:"d",v};break;case 6:E={t:"b",v:m>0};break;case 7:E={t:"n",v:m/86400};break;case 8:E={t:"e",v:0};break;case 9:if(u>-1)E={t:"s",v:t[u]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:E={t:"n",v:p};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return E}function ec(e,r){var t=new Uint8Array(32),n=Di(t),s=12,f=0;switch(t[0]=5,e.t){case"n":t[1]=2,RE(t,s,e.v),f|=1,s+=16;break;case"b":t[1]=6,n.setFloat64(s,e.v?1:0,!0),f|=2,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,n.setUint32(s,r.indexOf(e.v),!0),f|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,f,!0),t.slice(0,s)}function tc(e,r){var t=new Uint8Array(32),n=Di(t),s=12,f=0;switch(t[0]=3,e.t){case"n":t[2]=2,n.setFloat64(s,e.v,!0),f|=32,s+=8;break;case"b":t[2]=6,n.setFloat64(s,e.v?1:0,!0),f|=32,s+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,n.setUint32(s,r.indexOf(e.v),!0),f|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,f,!0),t.slice(0,s)}function LE(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return PE(e,r,t,e[0]);case 5:return BE(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ra(e){var r=Lt(e);return i0(r[1][0].data)}function Hf(e,r){var t=Lt(r.data),n=_r(t[1][0].data),s=t[3],f=[];return(s||[]).forEach(function(u){var x=Lt(u.data),p=_r(x[1][0].data)>>>0;switch(n){case 1:f[p]=xc(x[3][0].data);break;case 8:{var m=e[ra(x[9][0].data)][0],v=Lt(m.data),E=e[ra(v[1][0].data)][0],b=_r(E.meta[1][0].data);if(b!=2001)throw new Error("2000 unexpected reference to ".concat(b));var S=Lt(E.data);f[p]=S[3].map(function(k){return xc(k.data)}).join("")}break}}),f}function jE(e,r){var t,n,s,f,u,x,p,m,v,E,b,S,k,A,F=Lt(e),V=_r(F[1][0].data)>>>0,G=_r(F[2][0].data)>>>0,D=((n=(t=F[8])==null?void 0:t[0])==null?void 0:n.data)&&_r(F[8][0].data)>0||!1,J,ie;if((f=(s=F[7])==null?void 0:s[0])!=null&&f.data&&r!=0)J=(x=(u=F[7])==null?void 0:u[0])==null?void 0:x.data,ie=(m=(p=F[6])==null?void 0:p[0])==null?void 0:m.data;else if((E=(v=F[4])==null?void 0:v[0])!=null&&E.data&&r!=1)J=(S=(b=F[4])==null?void 0:b[0])==null?void 0:S.data,ie=(A=(k=F[3])==null?void 0:k[0])==null?void 0:A.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var Q=D?4:1,M=Di(J),ne=[],X=0;X<J.length/2;++X){var me=M.getUint16(X*2,!0);me<65535&&ne.push([X,me])}if(ne.length!=G)throw"Expected ".concat(G," cells, found ").concat(ne.length);var le=[];for(X=0;X<ne.length-1;++X)le[ne[X][0]]=ie.subarray(ne[X][1]*Q,ne[X+1][1]*Q);return ne.length>=1&&(le[ne[ne.length-1][0]]=ie.subarray(ne[ne.length-1][1]*Q)),{R:V,cells:le}}function UE(e,r){var t,n=Lt(r.data),s=(t=n==null?void 0:n[7])!=null&&t[0]?_r(n[7][0].data)>>>0>0?1:0:-1,f=Qc(n[5],function(u){return jE(u,s)});return{nrows:_r(n[4][0].data)>>>0,data:f.reduce(function(u,x){return u[x.R]||(u[x.R]=[]),x.cells.forEach(function(p,m){if(u[x.R][m])throw new Error("Duplicate cell r=".concat(x.R," c=").concat(m));u[x.R][m]=p}),u},[])}}function WE(e,r,t){var n,s=Lt(r.data),f={s:{r:0,c:0},e:{r:0,c:0}};if(f.e.r=(_r(s[6][0].data)>>>0)-1,f.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(f.e.c=(_r(s[7][0].data)>>>0)-1,f.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=gt(f);var u=Lt(s[4][0].data),x=Hf(e,e[ra(u[4][0].data)][0]),p=(n=u[17])!=null&&n[0]?Hf(e,e[ra(u[17][0].data)][0]):[],m=Lt(u[3][0].data),v=0;m[1].forEach(function(E){var b=Lt(E.data),S=e[ra(b[2][0].data)][0],k=_r(S.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var A=UE(e,S);A.data.forEach(function(F,V){F.forEach(function(G,D){var J=it({r:v+V,c:D}),ie=LE(G,x,p);ie&&(t[J]=ie)})}),v+=A.nrows})}function VE(e,r){var t=Lt(r.data),n={"!ref":"A1"},s=e[ra(t[2][0].data)],f=_r(s[0].meta[1][0].data);if(f!=6001)throw new Error("6000 unexpected reference to ".concat(f));return WE(e,s[0],n),n}function HE(e,r){var t,n=Lt(r.data),s={name:(t=n[1])!=null&&t[0]?xc(n[1][0].data):"",sheets:[]},f=Qc(n[2],ra);return f.forEach(function(u){e[u].forEach(function(x){var p=_r(x.meta[1][0].data);p==6e3&&s.sheets.push(VE(e,x))})}),s}function GE(e,r){var t=al(),n=Lt(r.data),s=Qc(n[1],ra);if(s.forEach(function(f){e[f].forEach(function(u){var x=_r(u.meta[1][0].data);if(x==2){var p=HE(e,u);p.sheets.forEach(function(m,v){nl(t,m,v==0?p.name:p.name+"_"+v,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function rc(e){var r,t,n,s,f={},u=[];if(e.FullPaths.forEach(function(p){if(p.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(p){if(p.name.match(/\.iwa$/)){var m;try{m=Va(p.content)}catch(E){return console.log("?? "+p.content.length+" "+(E.message||E))}var v;try{v=Wa(m)}catch(E){return console.log("## "+(E.message||E))}v.forEach(function(E){f[E.id]=E.messages,u.push(E.id)})}}),!u.length)throw new Error("File has no messages");var x=((s=(n=(t=(r=f==null?void 0:f[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&_r(f[1][0].meta[1][0].data)==1&&f[1][0];if(x||u.forEach(function(p){f[p].forEach(function(m){var v=_r(m.meta[1][0].data)>>>0;if(v==1)if(!x)x=m;else throw new Error("Document has multiple roots")})}),!x)throw new Error("Cannot find Document root");return GE(f,x)}function XE(e,r,t){var n,s,f,u;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var x=((u=(f=e[8])==null?void 0:f[0])==null?void 0:u.data)&&_r(e[8][0].data)>0||!1;if(x)throw"Math only works with normal offsets";for(var p=0,m=Di(e[7][0].data),v=0,E=[],b=Di(e[4][0].data),S=0,k=[],A=0;A<r.length;++A){if(r[A]==null){m.setUint16(A*2,65535,!0),b.setUint16(A*2,65535);continue}m.setUint16(A*2,v,!0),b.setUint16(A*2,S,!0);var F,V;switch(typeof r[A]){case"string":F=ec({t:"s",v:r[A]},t),V=tc({t:"s",v:r[A]},t);break;case"number":F=ec({t:"n",v:r[A]},t),V=tc({t:"n",v:r[A]},t);break;case"boolean":F=ec({t:"b",v:r[A]},t),V=tc({t:"b",v:r[A]},t);break;default:throw new Error("Unsupported value "+r[A])}E.push(F),v+=F.length,k.push(V),S+=V.length,++p}for(e[2][0].data=Ht(p);A<e[7][0].data.length/2;++A)m.setUint16(A*2,65535,!0),b.setUint16(A*2,65535,!0);return e[6][0].data=ii(E),e[3][0].data=ii(k),p}function zE(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Aa(t["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(gt(n)));var f=go(t,{range:n,header:1}),u=["~Sh33tJ5~"];f.forEach(function(ae){return ae.forEach(function(z){typeof z=="string"&&u.push(z)})});var x={},p=[],m=Je.read(r.numbers,{type:"base64"});m.FileIndex.map(function(ae,z){return[ae,m.FullPaths[z]]}).forEach(function(ae){var z=ae[0],N=ae[1];if(z.type==2&&z.name.match(/\.iwa/)){var B=z.content,Ne=Va(B),we=Wa(Ne);we.forEach(function(ve){p.push(ve.id),x[ve.id]={deps:[],location:N,type:_r(ve.messages[0].meta[1][0].data)}})}}),p.sort(function(ae,z){return ae-z});var v=p.filter(function(ae){return ae>1}).map(function(ae){return[ae,Ht(ae)]});m.FileIndex.map(function(ae,z){return[ae,m.FullPaths[z]]}).forEach(function(ae){var z=ae[0];if(ae[1],!!z.name.match(/\.iwa/)){var N=Wa(Va(z.content));N.forEach(function(B){B.messages.forEach(function(Ne){v.forEach(function(we){B.messages.some(function(ve){return _r(ve.meta[1][0].data)!=11006&&DE(ve.data,we[1])})&&x[we[0]].deps.push(B.id)})})})}});for(var E=Je.find(m,x[1].location),b=Wa(Va(E.content)),S,k=0;k<b.length;++k){var A=b[k];A.id==1&&(S=A)}var F=ra(Lt(S.messages[0].data)[1][0].data);for(E=Je.find(m,x[F].location),b=Wa(Va(E.content)),k=0;k<b.length;++k)A=b[k],A.id==F&&(S=A);for(F=ra(Lt(S.messages[0].data)[2][0].data),E=Je.find(m,x[F].location),b=Wa(Va(E.content)),k=0;k<b.length;++k)A=b[k],A.id==F&&(S=A);for(F=ra(Lt(S.messages[0].data)[2][0].data),E=Je.find(m,x[F].location),b=Wa(Va(E.content)),k=0;k<b.length;++k)A=b[k],A.id==F&&(S=A);var V=Lt(S.messages[0].data);{V[6][0].data=Ht(n.e.r+1),V[7][0].data=Ht(n.e.c+1);var G=ra(V[46][0].data),D=Je.find(m,x[G].location),J=Wa(Va(D.content));{for(var ie=0;ie<J.length&&J[ie].id!=G;++ie);if(J[ie].id!=G)throw"Bad ColumnRowUIDMapArchive";var Q=Lt(J[ie].messages[0].data);Q[1]=[],Q[2]=[],Q[3]=[];for(var M=0;M<=n.e.c;++M){var ne=[];ne[1]=ne[2]=[{type:0,data:Ht(M+420690)}],Q[1].push({type:2,data:Zr(ne)}),Q[2].push({type:0,data:Ht(M)}),Q[3].push({type:0,data:Ht(M)})}Q[4]=[],Q[5]=[],Q[6]=[];for(var X=0;X<=n.e.r;++X)ne=[],ne[1]=ne[2]=[{type:0,data:Ht(X+726270)}],Q[4].push({type:2,data:Zr(ne)}),Q[5].push({type:0,data:Ht(X)}),Q[6].push({type:0,data:Ht(X)});J[ie].messages[0].data=Zr(Q)}D.content=es($i(J)),D.size=D.content.length,delete V[46];var me=Lt(V[4][0].data);{me[7][0].data=Ht(n.e.r+1);var le=Lt(me[1][0].data),ee=ra(le[2][0].data);D=Je.find(m,x[ee].location),J=Wa(Va(D.content));{if(J[0].id!=ee)throw"Bad HeaderStorageBucket";var pe=Lt(J[0].messages[0].data);for(X=0;X<f.length;++X){var Pe=Lt(pe[2][0].data);Pe[1][0].data=Ht(X),Pe[4][0].data=Ht(f[X].length),pe[2][X]={type:pe[2][0].type,data:Zr(Pe)}}J[0].messages[0].data=Zr(pe)}D.content=es($i(J)),D.size=D.content.length;var re=ra(me[2][0].data);D=Je.find(m,x[re].location),J=Wa(Va(D.content));{if(J[0].id!=re)throw"Bad HeaderStorageBucket";for(pe=Lt(J[0].messages[0].data),M=0;M<=n.e.c;++M)Pe=Lt(pe[2][0].data),Pe[1][0].data=Ht(M),Pe[4][0].data=Ht(n.e.r+1),pe[2][M]={type:pe[2][0].type,data:Zr(Pe)};J[0].messages[0].data=Zr(pe)}D.content=es($i(J)),D.size=D.content.length;var Le=ra(me[4][0].data);(function(){for(var ae=Je.find(m,x[Le].location),z=Wa(Va(ae.content)),N,B=0;B<z.length;++B){var Ne=z[B];Ne.id==Le&&(N=Ne)}var we=Lt(N.messages[0].data);{we[3]=[];var ve=[];u.forEach(function(Z,Ke){ve[1]=[{type:0,data:Ht(Ke)}],ve[2]=[{type:0,data:Ht(1)}],ve[3]=[{type:2,data:FE(Z)}],we[3].push({type:2,data:Zr(ve)})})}N.messages[0].data=Zr(we);var Ae=$i(z),Xe=es(Ae);ae.content=Xe,ae.size=ae.content.length})();var be=Lt(me[3][0].data);{var St=be[1][0];delete be[2];var ue=Lt(St.data);{var Ye=ra(ue[2][0].data);(function(){for(var ae=Je.find(m,x[Ye].location),z=Wa(Va(ae.content)),N,B=0;B<z.length;++B){var Ne=z[B];Ne.id==Ye&&(N=Ne)}var we=Lt(N.messages[0].data);{delete we[6],delete be[7];var ve=new Uint8Array(we[5][0].data);we[5]=[];for(var Ae=0,Xe=0;Xe<=n.e.r;++Xe){var Z=Lt(ve);Ae+=XE(Z,f[Xe],u),Z[1][0].data=Ht(Xe),we[5].push({data:Zr(Z),type:2})}we[1]=[{type:0,data:Ht(n.e.c+1)}],we[2]=[{type:0,data:Ht(n.e.r+1)}],we[3]=[{type:0,data:Ht(Ae)}],we[4]=[{type:0,data:Ht(n.e.r+1)}]}N.messages[0].data=Zr(we);var Ke=$i(z),xt=es(Ke);ae.content=xt,ae.size=ae.content.length})()}St.data=Zr(ue)}me[3][0].data=Zr(be)}V[4][0].data=Zr(me)}S.messages[0].data=Zr(V);var Qe=$i(b),K=es(Qe);return E.content=K,E.size=E.content.length,m}function nu(e){return function(t){for(var n=0;n!=e.length;++n){var s=e[n];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function $c(e){nu([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function el(e){nu([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function YE(e){return Ct.WS.indexOf(e)>-1?"sheet":e==Ct.CS?"chart":e==Ct.DS?"dialog":e==Ct.MS?"macro":e&&e.length?e:"sheet"}function KE(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,YE(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function qE(e,r,t,n,s,f,u,x,p,m,v,E){try{f[n]=Vs(Ra(e,t,!0),r);var b=Mr(e,r),S;switch(x){case"sheet":S=py(b,r,s,p,f[n],m,v,E);break;case"chart":if(S=wy(b,r,s,p,f[n],m,v,E),!S||!S["!drawel"])break;var k=Ls(S["!drawel"].Target,r),A=$s(k),F=nw(Ra(e,k,!0),Vs(Ra(e,A,!0),k)),V=Ls(F,k),G=$s(V);S=X4(Ra(e,V,!0),V,p,Vs(Ra(e,G,!0),V),m,S);break;case"macro":S=vy(b,r,s,p,f[n],m,v,E);break;case"dialog":S=yy(b,r,s,p,f[n],m,v,E);break;default:throw new Error("Unrecognized sheet type "+x)}u[n]=S;var D=[];f&&f[n]&&Ar(f[n]).forEach(function(J){var ie="";if(f[n][J].Type==Ct.CMNT){ie=Ls(f[n][J].Target,r);var Q=by(Mr(e,ie,!0),ie,p);if(!Q||!Q.length)return;Nf(S,Q,!1)}f[n][J].Type==Ct.TCMNT&&(ie=Ls(f[n][J].Target,r),D=D.concat(sw(Mr(e,ie,!0),p)))}),D&&D.length&&Nf(S,D,!0,p.people||[])}catch(J){if(p.WTF)throw J}}function ja(e){return e.charAt(0)=="/"?e.slice(1):e}function ZE(e,r){if(ds(),r=r||{},$c(r),Ha(e,"META-INF/manifest.xml")||Ha(e,"objectdata.xml"))return jf(e,r);if(Ha(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof rc<"u"){if(e.FileIndex)return rc(e);var t=Je.utils.cfb_new();return Kl(e).forEach(function(Pe){Et(t,Pe,ox(e,Pe))}),rc(t)}throw new Error("Unsupported NUMBERS file")}if(!Ha(e,"[Content_Types].xml"))throw Ha(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ha(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Kl(e),s=eg(Ra(e,"[Content_Types].xml")),f=!1,u,x;if(s.workbooks.length===0&&(x="xl/workbook.xml",Mr(e,x,!0)&&s.workbooks.push(x)),s.workbooks.length===0){if(x="xl/workbook.bin",!Mr(e,x,!0))throw new Error("Could not find workbook");s.workbooks.push(x),f=!0}s.workbooks[0].slice(-3)=="bin"&&(f=!0);var p={},m={};if(!r.bookSheets&&!r.bookProps){if(Hs=[],s.sst)try{Hs=Ay(Mr(e,ja(s.sst)),s.sst,r)}catch(Pe){if(r.WTF)throw Pe}r.cellStyles&&s.themes.length&&(p=_y(Ra(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],r)),s.style&&(m=Ey(Mr(e,ja(s.style)),s.style,p,r))}s.links.map(function(Pe){try{var re=Vs(Ra(e,$s(ja(Pe))),Pe);return Ty(Mr(e,ja(Pe)),re,Pe,r)}catch{}});var v=my(Mr(e,ja(s.workbooks[0])),s.workbooks[0],r),E={},b="";s.coreprops.length&&(b=Mr(e,ja(s.coreprops[0]),!0),b&&(E=z1(b)),s.extprops.length!==0&&(b=Mr(e,ja(s.extprops[0]),!0),b&&og(b,E,r)));var S={};(!r.bookSheets||r.bookProps)&&s.custprops.length!==0&&(b=Ra(e,ja(s.custprops[0]),!0),b&&(S=lg(b,r)));var k={};if((r.bookSheets||r.bookProps)&&(v.Sheets?u=v.Sheets.map(function(re){return re.name}):E.Worksheets&&E.SheetNames.length>0&&(u=E.SheetNames),r.bookProps&&(k.Props=E,k.Custprops=S),r.bookSheets&&typeof u<"u"&&(k.SheetNames=u),r.bookSheets?k.SheetNames:r.bookProps))return k;u={};var A={};r.bookDeps&&s.calcchain&&(A=Cy(Mr(e,ja(s.calcchain)),s.calcchain));var F=0,V={},G,D;{var J=v.Sheets;E.Worksheets=J.length,E.SheetNames=[];for(var ie=0;ie!=J.length;++ie)E.SheetNames[ie]=J[ie].name}var Q=f?"bin":"xml",M=s.workbooks[0].lastIndexOf("/"),ne=(s.workbooks[0].slice(0,M+1)+"_rels/"+s.workbooks[0].slice(M+1)+".rels").replace(/^\//,"");Ha(e,ne)||(ne="xl/_rels/workbook."+Q+".rels");var X=Vs(Ra(e,ne,!0),ne.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(r.xlmeta=Sy(Mr(e,ja(s.metadata[0])),s.metadata[0],r)),(s.people||[]).length>=1&&(r.people=cw(Mr(e,ja(s.people[0])),r)),X&&(X=KE(X,v.Sheets));var me=Mr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(F=0;F!=E.Worksheets;++F){var le="sheet";if(X&&X[F]?(G="xl/"+X[F][1].replace(/[\/]?xl\//,""),Ha(e,G)||(G=X[F][1]),Ha(e,G)||(G=ne.replace(/_rels\/.*$/,"")+X[F][1]),le=X[F][2]):(G="xl/worksheets/sheet"+(F+1-me)+"."+Q,G=G.replace(/sheet0\./,"sheet.")),D=G.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(F!=r.sheets)continue e;break;case"string":if(E.SheetNames[F].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var ee=!1,pe=0;pe!=r.sheets.length;++pe)typeof r.sheets[pe]=="number"&&r.sheets[pe]==F&&(ee=1),typeof r.sheets[pe]=="string"&&r.sheets[pe].toLowerCase()==E.SheetNames[F].toLowerCase()&&(ee=1);if(!ee)continue e}}qE(e,G,D,E.SheetNames[F],F,V,u,le,r,v,p,m)}return k={Directory:s,Workbook:v,Props:E,Custprops:S,Deps:A,Sheets:u,SheetNames:E.SheetNames,Strings:Hs,Styles:m,Themes:p,SSF:fr(at)},r&&r.bookFiles&&(e.files?(k.keys=n,k.files=e.files):(k.keys=[],k.files={},e.FullPaths.forEach(function(Pe,re){Pe=Pe.replace(/^Root Entry[\/]/,""),k.keys.push(Pe),k.files[Pe]=e.FileIndex[re]}))),r&&r.bookVBA&&(s.vba.length>0?k.vbaraw=Mr(e,ja(s.vba[0]),!0):s.defaults&&s.defaults.bin===mw&&(k.vbaraw=Mr(e,"xl/vbaProject.bin",!0))),k}function JE(e,r){var t=r||{},n="Workbook",s=Je.find(e,n);try{if(n="/!DataSpaces/Version",s=Je.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Sm(s.content),n="/!DataSpaces/DataSpaceMap",s=Je.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var f=km(s.content);if(f.length!==1||f[0].comps.length!==1||f[0].comps[0].t!==0||f[0].name!=="StrongEncryptionDataSpace"||f[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Je.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=Im(s.content);if(u.length!=1||u[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Je.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Dm(s.content)}catch{}if(n="/EncryptionInfo",s=Je.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var x=Om(s.content);if(n="/EncryptedPackage",s=Je.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(x[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(x[1],s.content,t.password||"",t);if(x[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(x[1],s.content,t.password||"",t);throw new Error("File is password-protected")}function QE(e,r){return r.bookType=="ods"?au(e,r):r.bookType=="numbers"?zE(e,r):r.bookType=="xlsb"?$E(e,r):e_(e,r)}function $E(e,r){rs=1024,e&&!e.SSF&&(e.SSF=fr(at)),e&&e.SSF&&(ds(),yo(e.SSF),r.revssf=_o(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Gs?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",n=Fh.indexOf(r.bookType)>-1,s=jc();el(r=r||{});var f=Cc(),u="",x=0;if(r.cellXfs=[],ci(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),u="docProps/core.xml",Et(f,u,Y1(e.Props,r)),s.coreprops.push(u),Gt(r.rels,2,u,Ct.CORE_PROPS),u="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var p=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&p.push(e.SheetNames[m]);e.Props.SheetNames=p}for(e.Props.Worksheets=e.Props.SheetNames.length,Et(f,u,Z1(e.Props)),s.extprops.push(u),Gt(r.rels,3,u,Ct.EXT_PROPS),e.Custprops!==e.Props&&Ar(e.Custprops||{}).length>0&&(u="docProps/custom.xml",Et(f,u,J1(e.Custprops)),s.custprops.push(u),Gt(r.rels,4,u,Ct.CUST_PROPS)),x=1;x<=e.SheetNames.length;++x){var v={"!id":{}},E=e.Sheets[e.SheetNames[x-1]],b=(E||{})["!type"]||"sheet";switch(b){case"chart":default:u="xl/worksheets/sheet"+x+"."+t,Et(f,u,ky(x-1,u,r,e,v)),s.sheets.push(u),Gt(r.wbrels,-1,"worksheets/sheet"+x+"."+t,Ct.WS[0])}if(E){var S=E["!comments"],k=!1,A="";S&&S.length>0&&(A="xl/comments"+x+"."+t,Et(f,A,Dy(S,A)),s.comments.push(A),Gt(v,-1,"../comments"+x+"."+t,Ct.CMNT),k=!0),E["!legacy"]&&k&&Et(f,"xl/drawings/vmlDrawing"+x+".vml",kh(x,E["!comments"])),delete E["!comments"],delete E["!legacy"]}v["!id"].rId1&&Et(f,$s(u),is(v))}return r.Strings!=null&&r.Strings.length>0&&(u="xl/sharedStrings."+t,Et(f,u,Fy(r.Strings,u,r)),s.strs.push(u),Gt(r.wbrels,-1,"sharedStrings."+t,Ct.SST)),u="xl/workbook."+t,Et(f,u,Ny(e,u)),s.workbooks.push(u),Gt(r.rels,1,u,Ct.WB),u="xl/theme/theme1.xml",Et(f,u,Xc(e.Themes,r)),s.themes.push(u),Gt(r.wbrels,-1,"theme/theme1.xml",Ct.THEME),u="xl/styles."+t,Et(f,u,Iy(e,u,r)),s.styles.push(u),Gt(r.wbrels,-1,"styles."+t,Ct.STY),e.vbaraw&&n&&(u="xl/vbaProject.bin",Et(f,u,e.vbaraw),s.vba.push(u),Gt(r.wbrels,-1,"vbaProject.bin",Ct.VBA)),u="xl/metadata."+t,Et(f,u,Oy(u)),s.metadata.push(u),Gt(r.wbrels,-1,"metadata."+t,Ct.XLMETA),Et(f,"[Content_Types].xml",G1(s,r)),Et(f,"_rels/.rels",is(r.rels)),Et(f,"xl/_rels/workbook."+t+".rels",is(r.wbrels)),delete r.revssf,delete r.ssf,f}function e_(e,r){rs=1024,e&&!e.SSF&&(e.SSF=fr(at)),e&&e.SSF&&(ds(),yo(e.SSF),r.revssf=_o(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Gs?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=Fh.indexOf(r.bookType)>-1,s=jc();el(r=r||{});var f=Cc(),u="",x=0;if(r.cellXfs=[],ci(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),u="docProps/core.xml",Et(f,u,Y1(e.Props,r)),s.coreprops.push(u),Gt(r.rels,2,u,Ct.CORE_PROPS),u="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var p=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&p.push(e.SheetNames[m]);e.Props.SheetNames=p}e.Props.Worksheets=e.Props.SheetNames.length,Et(f,u,Z1(e.Props)),s.extprops.push(u),Gt(r.rels,3,u,Ct.EXT_PROPS),e.Custprops!==e.Props&&Ar(e.Custprops||{}).length>0&&(u="docProps/custom.xml",Et(f,u,J1(e.Custprops)),s.custprops.push(u),Gt(r.rels,4,u,Ct.CUST_PROPS));var v=["SheetJ5"];for(r.tcid=0,x=1;x<=e.SheetNames.length;++x){var E={"!id":{}},b=e.Sheets[e.SheetNames[x-1]],S=(b||{})["!type"]||"sheet";switch(S){case"chart":default:u="xl/worksheets/sheet"+x+"."+t,Et(f,u,Vh(x-1,r,e,E)),s.sheets.push(u),Gt(r.wbrels,-1,"worksheets/sheet"+x+"."+t,Ct.WS[0])}if(b){var k=b["!comments"],A=!1,F="";if(k&&k.length>0){var V=!1;k.forEach(function(G){G[1].forEach(function(D){D.T==!0&&(V=!0)})}),V&&(F="xl/threadedComments/threadedComment"+x+"."+t,Et(f,F,ow(k,v,r)),s.threadedcomments.push(F),Gt(E,-1,"../threadedComments/threadedComment"+x+"."+t,Ct.TCMNT)),F="xl/comments"+x+"."+t,Et(f,F,Ih(k)),s.comments.push(F),Gt(E,-1,"../comments"+x+"."+t,Ct.CMNT),A=!0}b["!legacy"]&&A&&Et(f,"xl/drawings/vmlDrawing"+x+".vml",kh(x,b["!comments"])),delete b["!comments"],delete b["!legacy"]}E["!id"].rId1&&Et(f,$s(u),is(E))}return r.Strings!=null&&r.Strings.length>0&&(u="xl/sharedStrings."+t,Et(f,u,ph(r.Strings,r)),s.strs.push(u),Gt(r.wbrels,-1,"sharedStrings."+t,Ct.SST)),u="xl/workbook."+t,Et(f,u,Yh(e)),s.workbooks.push(u),Gt(r.rels,1,u,Ct.WB),u="xl/theme/theme1.xml",Et(f,u,Xc(e.Themes,r)),s.themes.push(u),Gt(r.wbrels,-1,"theme/theme1.xml",Ct.THEME),u="xl/styles."+t,Et(f,u,Ch(e,r)),s.styles.push(u),Gt(r.wbrels,-1,"styles."+t,Ct.STY),e.vbaraw&&n&&(u="xl/vbaProject.bin",Et(f,u,e.vbaraw),s.vba.push(u),Gt(r.wbrels,-1,"vbaProject.bin",Ct.VBA)),u="xl/metadata."+t,Et(f,u,Nh()),s.metadata.push(u),Gt(r.wbrels,-1,"metadata."+t,Ct.XLMETA),v.length>1&&(u="xl/persons/person.xml",Et(f,u,lw(v)),s.people.push(u),Gt(r.wbrels,-1,"persons/person.xml",Ct.PEOPLE)),Et(f,"[Content_Types].xml",G1(s,r)),Et(f,"_rels/.rels",is(r.rels)),Et(f,"xl/_rels/workbook."+t+".rels",is(r.wbrels)),delete r.revssf,delete r.ssf,f}function tl(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Ma(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function t_(e,r){return Je.find(e,"EncryptedPackage")?JE(e,r):Jh(e,r)}function r_(e,r){var t,n=e,s=r||{};return s.type||(s.type=At&&Buffer.isBuffer(e)?"buffer":"base64"),t=v1(n,s),ZE(t,s)}function iu(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return uc(e.slice(t),r);default:break e}return ls.to_workbook(e,r)}function a_(e,r){var t="",n=tl(e,r);switch(r.type){case"base64":t=Ma(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Ni(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=qt(t)),r.type="binary",iu(t,r)}function n_(e,r){var t=e;return r.type=="base64"&&(t=Ma(t)),t=Ys.utils.decode(1200,t.slice(2),"str"),r.type="binary",iu(t,r)}function i_(e){return e.match(/[^\x00-\x7F]/)?wn(e):e}function ac(e,r,t,n){return n?(t.type="string",ls.to_workbook(e,t)):ls.to_workbook(r,t)}function gc(e,r){yc();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return gc(new Uint8Array(e),(t=fr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],f=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),os={},t.dateNF&&(os.dateNF=t.dateNF),t.type||(t.type=At&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=At?"buffer":"binary",n=$d(e),typeof Uint8Array<"u"&&!At&&(t.type="array")),t.type=="string"&&(f=!0,t.type="binary",t.codepage=65001,n=i_(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var u=new ArrayBuffer(3),x=new Uint8Array(u);if(x.foo="bar",!x.foo)return t=fr(t),t.type="array",gc(Ec(n),t)}switch((s=tl(n,t))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return t_(Je.read(n,t),t);break;case 9:if(s[1]<=8)return Jh(n,t);break;case 60:return uc(n,t);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return fm(n,t);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return gh.to_workbook(n,t);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?r_(n,t):ac(e,n,t,f);case 239:return s[3]===60?uc(n,t):ac(e,n,t,f);case 255:if(s[1]===254)return n_(n,t);if(s[1]===0&&s[2]===2&&s[3]===0)return Ci.to_workbook(n,t);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Ci.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return hc.to_workbook(n,t);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return _h.to_workbook(n,t);break;case 10:case 13:case 32:return a_(n,t);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return lm.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?hc.to_workbook(n,t):ac(e,n,t,f)}function su(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return o0(r.file,Je.write(e,{type:At?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Je.write(e,r)}function s_(e,r){var t=fr(r||{}),n=QE(e,t);return o_(n,t)}function o_(e,r){var t={},n=At?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var s=e.FullPaths?Je.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(r.type=="binary"||r.type=="base64")return s;s=new Uint8Array(vo(s))}return r.password&&typeof encrypt_agile<"u"?su(encrypt_agile(s,r.password),r):r.type==="file"?o0(r.file,s):r.type=="string"?qt(s):s}function c_(e,r){var t=r||{},n=iE(e,t);return su(n,t)}function pn(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return Ks(wn(n));case"binary":return wn(n);case"string":return e;case"file":return o0(r.file,n,"utf8");case"buffer":return At?Ln(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):pn(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function l_(e,r){switch(r.type){case"base64":return Ks(e);case"binary":return e;case"string":return e;case"file":return o0(r.file,e,"binary");case"buffer":return At?Ln(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Q0(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return r.type=="base64"?Ks(t):r.type=="string"?qt(t):t;case"file":return o0(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function ou(e,r){yc(),ty(e);var t=fr(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=ou(e,t);return t.type="array",vo(n)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=e.SheetNames.indexOf(t.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return pn(Qy(e,t),t);case"slk":case"sylk":return pn(xh.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"htm":case"html":return pn($h(e.Sheets[e.SheetNames[s]],t),t);case"txt":return l_(cu(e.Sheets[e.SheetNames[s]],t),t);case"csv":return pn(rl(e.Sheets[e.SheetNames[s]],t),t,"\uFEFF");case"dif":return pn(gh.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"dbf":return Q0(hc.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"prn":return pn(ls.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"rtf":return pn(_h.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"eth":return pn(mh.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"fods":return pn(au(e,t),t);case"wk1":return Q0(Ci.sheet_to_wk1(e.Sheets[e.SheetNames[s]],t),t);case"wk3":return Q0(Ci.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Q0(Qh(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),c_(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return s_(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function f_(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function h_(e,r,t){var n={};return n.type="file",n.file=r,f_(n),ou(e,n)}function u_(e,r,t,n,s,f,u,x){var p=Sr(t),m=x.defval,v=x.raw||!Object.prototype.hasOwnProperty.call(x,"raw"),E=!0,b=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(b,"__rowNum__",{value:t,enumerable:!1})}catch{b.__rowNum__=t}else b.__rowNum__=t;if(!u||e[t])for(var S=r.s.c;S<=r.e.c;++S){var k=u?e[t][S]:e[n[S]+p];if(k===void 0||k.t===void 0){if(m===void 0)continue;f[S]!=null&&(b[f[S]]=m);continue}var A=k.v;switch(k.t){case"z":if(A==null)break;continue;case"e":A=A==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(f[S]!=null){if(A==null)if(k.t=="e"&&A===null)b[f[S]]=null;else if(m!==void 0)b[f[S]]=m;else if(v&&A===null)b[f[S]]=null;else continue;else b[f[S]]=v&&(k.t!=="n"||k.t==="n"&&x.rawNumbers!==!1)?A:Bn(k,A,x);A!=null&&(E=!1)}}return{row:b,isempty:E}}function go(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,s=1,f=[],u=0,x="",p={s:{r:0,c:0},e:{r:0,c:0}},m=r||{},v=m.range!=null?m.range:e["!ref"];switch(m.header===1?n=1:m.header==="A"?n=2:Array.isArray(m.header)?n=3:m.header==null&&(n=0),typeof v){case"string":p=Pt(v);break;case"number":p=Pt(e["!ref"]),p.s.r=v;break;default:p=v}n>0&&(s=0);var E=Sr(p.s.r),b=[],S=[],k=0,A=0,F=Array.isArray(e),V=p.s.r,G=0,D={};F&&!e[V]&&(e[V]=[]);var J=m.skipHidden&&e["!cols"]||[],ie=m.skipHidden&&e["!rows"]||[];for(G=p.s.c;G<=p.e.c;++G)if(!(J[G]||{}).hidden)switch(b[G]=mr(G),t=F?e[V][G]:e[b[G]+E],n){case 1:f[G]=G-p.s.c;break;case 2:f[G]=b[G];break;case 3:f[G]=m.header[G-p.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),x=u=Bn(t,null,m),A=D[u]||0,!A)D[u]=1;else{do x=u+"_"+A++;while(D[x]);D[u]=A,D[x]=1}f[G]=x}for(V=p.s.r+s;V<=p.e.r;++V)if(!(ie[V]||{}).hidden){var Q=u_(e,p,V,b,n,f,F,m);(Q.isempty===!1||(n===1?m.blankrows!==!1:m.blankrows))&&(S[k++]=Q.row)}return S.length=k,S}var Gf=/"/g;function d_(e,r,t,n,s,f,u,x){for(var p=!0,m=[],v="",E=Sr(t),b=r.s.c;b<=r.e.c;++b)if(n[b]){var S=x.dense?(e[t]||[])[b]:e[n[b]+E];if(S==null)v="";else if(S.v!=null){p=!1,v=""+(x.rawNumbers&&S.t=="n"?S.v:Bn(S,null,x));for(var k=0,A=0;k!==v.length;++k)if((A=v.charCodeAt(k))===s||A===f||A===34||x.forceQuotes){v='"'+v.replace(Gf,'""')+'"';break}v=="ID"&&(v='"ID"')}else S.f!=null&&!S.F?(p=!1,v="="+S.f,v.indexOf(",")>=0&&(v='"'+v.replace(Gf,'""')+'"')):v="";m.push(v)}return x.blankrows===!1&&p?null:m.join(u)}function rl(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var s=Pt(e["!ref"]),f=n.FS!==void 0?n.FS:",",u=f.charCodeAt(0),x=n.RS!==void 0?n.RS:`
`,p=x.charCodeAt(0),m=new RegExp((f=="|"?"\\|":f)+"+$"),v="",E=[];n.dense=Array.isArray(e);for(var b=n.skipHidden&&e["!cols"]||[],S=n.skipHidden&&e["!rows"]||[],k=s.s.c;k<=s.e.c;++k)(b[k]||{}).hidden||(E[k]=mr(k));for(var A=0,F=s.s.r;F<=s.e.r;++F)(S[F]||{}).hidden||(v=d_(e,s,F,E,u,p,f,n),v!=null&&(n.strip&&(v=v.replace(m,"")),(v||n.blankrows!==!1)&&t.push((A++?x:"")+v)));return delete n.dense,t.join("")}function cu(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=rl(e,r);return t}function x_(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var s=Pt(e["!ref"]),f="",u=[],x,p=[],m=Array.isArray(e);for(x=s.s.c;x<=s.e.c;++x)u[x]=mr(x);for(var v=s.s.r;v<=s.e.r;++v)for(f=Sr(v),x=s.s.c;x<=s.e.c;++x)if(r=u[x]+f,t=m?(e[v]||[])[x]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}p[p.length]=r+"="+n}return p}function lu(e,r,t){var n=t||{},s=+!n.skipHeader,f=e||{},u=0,x=0;if(f&&n.origin!=null)if(typeof n.origin=="number")u=n.origin;else{var p=typeof n.origin=="string"?pr(n.origin):n.origin;u=p.r,x=p.c}var m,v={s:{c:0,r:0},e:{c:x,r:u+r.length-1+s}};if(f["!ref"]){var E=Pt(f["!ref"]);v.e.c=Math.max(v.e.c,E.e.c),v.e.r=Math.max(v.e.r,E.e.r),u==-1&&(u=E.e.r+1,v.e.r=u+r.length-1+s)}else u==-1&&(u=0,v.e.r=r.length-1+s);var b=n.header||[],S=0;r.forEach(function(A,F){Ar(A).forEach(function(V){(S=b.indexOf(V))==-1&&(b[S=b.length]=V);var G=A[V],D="z",J="",ie=it({c:x+S,r:u+F+s});m=s0(f,ie),G&&typeof G=="object"&&!(G instanceof Date)?f[ie]=G:(typeof G=="number"?D="n":typeof G=="boolean"?D="b":typeof G=="string"?D="s":G instanceof Date?(D="d",n.cellDates||(D="n",G=Ur(G)),J=n.dateNF||at[14]):G===null&&n.nullError&&(D="e",G=0),m?(m.t=D,m.v=G,delete m.w,delete m.R,J&&(m.z=J)):f[ie]=m={t:D,v:G},J&&(m.z=J))})}),v.e.c=Math.max(v.e.c,x+b.length-1);var k=Sr(u);if(s)for(S=0;S<b.length;++S)f[mr(S+x)+k]={t:"s",v:b[S]};return f["!ref"]=gt(v),f}function g_(e,r){return lu(null,e,r)}function s0(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=pr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?s0(e,it(r)):s0(e,it({r,c:t||0}))}function m_(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function al(){return{SheetNames:[],Sheets:{}}}function nl(e,r,t,n){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var f=t.match(/(^.*?)(\d+)$/);s=f&&+f[2]||0;var u=f&&f[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=u+s)!=-1;++s);}if(zh(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function p_(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=m_(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function w_(e,r){return e.z=r,e}function fu(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function v_(e,r,t){return fu(e,"#"+r,t)}function y_(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function E_(e,r,t,n){for(var s=typeof r!="string"?r:Pt(r),f=typeof r=="string"?r:gt(r),u=s.s.r;u<=s.e.r;++u)for(var x=s.s.c;x<=s.e.c;++x){var p=s0(e,u,x);p.t="n",p.F=f,delete p.v,u==s.s.r&&x==s.s.c&&(p.f=t,n&&(p.D=!0))}return e}var $0={encode_col:mr,encode_row:Sr,encode_cell:it,encode_range:gt,decode_col:Oc,decode_row:Dc,split_cell:Fx,decode_cell:pr,decode_range:Aa,format_cell:Bn,sheet_add_aoa:B1,sheet_add_json:lu,sheet_add_dom:eu,aoa_to_sheet:xs,json_to_sheet:g_,table_to_sheet:tu,table_to_book:SE,sheet_to_csv:rl,sheet_to_txt:cu,sheet_to_json:go,sheet_to_html:$h,sheet_to_formulae:x_,sheet_to_row_object_array:go,sheet_get_cell:s0,book_new:al,book_append_sheet:nl,book_set_sheet_visibility:p_,cell_set_number_format:w_,cell_set_hyperlink:fu,cell_set_internal_link:v_,cell_add_comment:y_,sheet_set_array_formula:E_,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Ge;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ge||(Ge={}));var Xf=new Map([[Ge.QR_CODE,"QR_CODE"],[Ge.AZTEC,"AZTEC"],[Ge.CODABAR,"CODABAR"],[Ge.CODE_39,"CODE_39"],[Ge.CODE_93,"CODE_93"],[Ge.CODE_128,"CODE_128"],[Ge.DATA_MATRIX,"DATA_MATRIX"],[Ge.MAXICODE,"MAXICODE"],[Ge.ITF,"ITF"],[Ge.EAN_13,"EAN_13"],[Ge.EAN_8,"EAN_8"],[Ge.PDF_417,"PDF_417"],[Ge.RSS_14,"RSS_14"],[Ge.RSS_EXPANDED,"RSS_EXPANDED"],[Ge.UPC_A,"UPC_A"],[Ge.UPC_E,"UPC_E"],[Ge.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),zf;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(zf||(zf={}));function __(e){return Object.values(Ge).includes(e)}var mo;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(mo||(mo={}));var A_=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[mo.SCAN_TYPE_CAMERA,mo.SCAN_TYPE_FILE],e}(),hu=function(){function e(r,t){this.format=r,this.formatName=t}return e.prototype.toString=function(){return this.formatName},e.create=function(r){if(!Xf.has(r))throw"".concat(r," not in html5QrcodeSupportedFormatsTextMap");return new e(r,Xf.get(r))},e}(),Yf=function(){function e(){}return e.createFromText=function(r){var t={text:r};return{decodedText:r,result:t}},e.createFromQrcodeResult=function(r){return{decodedText:r.text,result:r}},e}(),mc;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(mc||(mc={}));var b_=function(){function e(){}return e.createFrom=function(r){return{errorMessage:r,type:mc.UNKWOWN_ERROR}},e}(),C_=function(){function e(r){this.verbose=r}return e.prototype.log=function(r){this.verbose&&console.log(r)},e.prototype.warn=function(r){this.verbose&&console.warn(r)},e.prototype.logError=function(r,t){(this.verbose||t===!0)&&console.error(r)},e.prototype.logErrors=function(r){if(r.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(r)},e}();function Dn(e){return typeof e>"u"||e===null}var as=function(){function e(){}return e.codeParseError=function(r){return"QR code parse error, error = ".concat(r)},e.errorGettingUserMedia=function(r){return"Error getting userMedia, error = ".concat(r)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),uu=function(){function e(){}return e.isMediaStreamConstraintsValid=function(r,t){if(typeof r!="object"){var n=typeof r;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(n,"."),!0),!1}for(var s=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],f=new Set(s),u=Object.keys(r),x=0,p=u;x<p.length;x++){var m=p[x];if(f.has(m))return t.logError("".concat(m," is not supported videoConstaints."),!0),!1}return!0},e}(),pc={exports:{}};(function(e,r){(function(t,n){n(r)})(Cs,function(t){function n(I){return I==null}var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,a){I.__proto__=a}||function(I,a){for(var i in a)a.hasOwnProperty(i)&&(I[i]=a[i])};function f(I,a){s(I,a);function i(){this.constructor=I}I.prototype=a===null?Object.create(a):(i.prototype=a.prototype,new i)}function u(I,a){var i=Object.setPrototypeOf;i?i(I,a):I.__proto__=a}function x(I,a){a===void 0&&(a=I.constructor);var i=Error.captureStackTrace;i&&i(I,a)}var p=function(I){f(a,I);function a(i){var c=this.constructor,o=I.call(this,i)||this;return Object.defineProperty(o,"name",{value:c.name,enumerable:!1}),u(o,c.prototype),x(o),o}return a}(Error);class m extends p{constructor(a=void 0){super(a),this.message=a}getKind(){return this.constructor.kind}}m.kind="Exception";class v extends m{}v.kind="ArgumentException";class E extends m{}E.kind="IllegalArgumentException";class b{constructor(a){if(this.binarizer=a,a===null)throw new E("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(a,i){return this.binarizer.getBlackRow(a,i)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(a,i,c,o){const l=this.binarizer.getLuminanceSource().crop(a,i,c,o);return new b(this.binarizer.createBinarizer(l))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const a=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new b(this.binarizer.createBinarizer(a))}rotateCounterClockwise45(){const a=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new b(this.binarizer.createBinarizer(a))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class S extends m{static getChecksumInstance(){return new S}}S.kind="ChecksumException";class k{constructor(a){this.source=a}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class A{static arraycopy(a,i,c,o,l){for(;l--;)c[o++]=a[i++]}static currentTimeMillis(){return Date.now()}}class F extends m{}F.kind="IndexOutOfBoundsException";class V extends F{constructor(a=void 0,i=void 0){super(i),this.index=a,this.message=i}}V.kind="ArrayIndexOutOfBoundsException";class G{static fill(a,i){for(let c=0,o=a.length;c<o;c++)a[c]=i}static fillWithin(a,i,c,o){G.rangeCheck(a.length,i,c);for(let l=i;l<c;l++)a[l]=o}static rangeCheck(a,i,c){if(i>c)throw new E("fromIndex("+i+") > toIndex("+c+")");if(i<0)throw new V(i);if(c>a)throw new V(c)}static asList(...a){return a}static create(a,i,c){return Array.from({length:a}).map(l=>Array.from({length:i}).fill(c))}static createInt32Array(a,i,c){return Array.from({length:a}).map(l=>Int32Array.from({length:i}).fill(c))}static equals(a,i){if(!a||!i||!a.length||!i.length||a.length!==i.length)return!1;for(let c=0,o=a.length;c<o;c++)if(a[c]!==i[c])return!1;return!0}static hashCode(a){if(a===null)return 0;let i=1;for(const c of a)i=31*i+c;return i}static fillUint8Array(a,i){for(let c=0;c!==a.length;c++)a[c]=i}static copyOf(a,i){return a.slice(0,i)}static copyOfUint8Array(a,i){if(a.length<=i){const c=new Uint8Array(i);return c.set(a),c}return a.slice(0,i)}static copyOfRange(a,i,c){const o=c-i,l=new Int32Array(o);return A.arraycopy(a,i,l,0,o),l}static binarySearch(a,i,c){c===void 0&&(c=G.numberComparator);let o=0,l=a.length-1;for(;o<=l;){const h=l+o>>1,d=c(i,a[h]);if(d>0)o=h+1;else if(d<0)l=h-1;else return h}return-o-1}static numberComparator(a,i){return a-i}}class D{static numberOfTrailingZeros(a){let i;if(a===0)return 32;let c=31;return i=a<<16,i!==0&&(c-=16,a=i),i=a<<8,i!==0&&(c-=8,a=i),i=a<<4,i!==0&&(c-=4,a=i),i=a<<2,i!==0&&(c-=2,a=i),c-(a<<1>>>31)}static numberOfLeadingZeros(a){if(a===0)return 32;let i=1;return a>>>16||(i+=16,a<<=16),a>>>24||(i+=8,a<<=8),a>>>28||(i+=4,a<<=4),a>>>30||(i+=2,a<<=2),i-=a>>>31,i}static toHexString(a){return a.toString(16)}static toBinaryString(a){return String(parseInt(String(a),2))}static bitCount(a){return a=a-(a>>>1&1431655765),a=(a&858993459)+(a>>>2&858993459),a=a+(a>>>4)&252645135,a=a+(a>>>8),a=a+(a>>>16),a&63}static truncDivision(a,i){return Math.trunc(a/i)}static parseInt(a,i=void 0){return parseInt(a,i)}}D.MIN_VALUE_32_BITS=-2147483648,D.MAX_VALUE=Number.MAX_SAFE_INTEGER;class J{constructor(a,i){a===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=a,i==null?this.bits=J.makeArray(a):this.bits=i)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(a){if(a>this.bits.length*32){const i=J.makeArray(a);A.arraycopy(this.bits,0,i,0,this.bits.length),this.bits=i}}get(a){return(this.bits[Math.floor(a/32)]&1<<(a&31))!==0}set(a){this.bits[Math.floor(a/32)]|=1<<(a&31)}flip(a){this.bits[Math.floor(a/32)]^=1<<(a&31)}getNextSet(a){const i=this.size;if(a>=i)return i;const c=this.bits;let o=Math.floor(a/32),l=c[o];l&=~((1<<(a&31))-1);const h=c.length;for(;l===0;){if(++o===h)return i;l=c[o]}const d=o*32+D.numberOfTrailingZeros(l);return d>i?i:d}getNextUnset(a){const i=this.size;if(a>=i)return i;const c=this.bits;let o=Math.floor(a/32),l=~c[o];l&=~((1<<(a&31))-1);const h=c.length;for(;l===0;){if(++o===h)return i;l=~c[o]}const d=o*32+D.numberOfTrailingZeros(l);return d>i?i:d}setBulk(a,i){this.bits[Math.floor(a/32)]=i}setRange(a,i){if(i<a||a<0||i>this.size)throw new E;if(i===a)return;i--;const c=Math.floor(a/32),o=Math.floor(i/32),l=this.bits;for(let h=c;h<=o;h++){const d=h>c?0:a&31,w=(2<<(h<o?31:i&31))-(1<<d);l[h]|=w}}clear(){const a=this.bits.length,i=this.bits;for(let c=0;c<a;c++)i[c]=0}isRange(a,i,c){if(i<a||a<0||i>this.size)throw new E;if(i===a)return!0;i--;const o=Math.floor(a/32),l=Math.floor(i/32),h=this.bits;for(let d=o;d<=l;d++){const g=d>o?0:a&31,_=(2<<(d<l?31:i&31))-(1<<g)&4294967295;if((h[d]&_)!==(c?_:0))return!1}return!0}appendBit(a){this.ensureCapacity(this.size+1),a&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(a,i){if(i<0||i>32)throw new E("Num bits must be between 0 and 32");this.ensureCapacity(this.size+i);for(let c=i;c>0;c--)this.appendBit((a>>c-1&1)===1)}appendBitArray(a){const i=a.size;this.ensureCapacity(this.size+i);for(let c=0;c<i;c++)this.appendBit(a.get(c))}xor(a){if(this.size!==a.size)throw new E("Sizes don't match");const i=this.bits;for(let c=0,o=i.length;c<o;c++)i[c]^=a.bits[c]}toBytes(a,i,c,o){for(let l=0;l<o;l++){let h=0;for(let d=0;d<8;d++)this.get(a)&&(h|=1<<7-d),a++;i[c+l]=h}}getBitArray(){return this.bits}reverse(){const a=new Int32Array(this.bits.length),i=Math.floor((this.size-1)/32),c=i+1,o=this.bits;for(let l=0;l<c;l++){let h=o[l];h=h>>1&1431655765|(h&1431655765)<<1,h=h>>2&858993459|(h&858993459)<<2,h=h>>4&252645135|(h&252645135)<<4,h=h>>8&16711935|(h&16711935)<<8,h=h>>16&65535|(h&65535)<<16,a[i-l]=h}if(this.size!==c*32){const l=c*32-this.size;let h=a[0]>>>l;for(let d=1;d<c;d++){const g=a[d];h|=g<<32-l,a[d-1]=h,h=g>>>l}a[c-1]=h}this.bits=a}static makeArray(a){return new Int32Array(Math.floor((a+31)/32))}equals(a){if(!(a instanceof J))return!1;const i=a;return this.size===i.size&&G.equals(this.bits,i.bits)}hashCode(){return 31*this.size+G.hashCode(this.bits)}toString(){let a="";for(let i=0,c=this.size;i<c;i++)i&7||(a+=" "),a+=this.get(i)?"X":".";return a}clone(){return new J(this.size,this.bits.slice())}}var ie;(function(I){I[I.OTHER=0]="OTHER",I[I.PURE_BARCODE=1]="PURE_BARCODE",I[I.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",I[I.TRY_HARDER=3]="TRY_HARDER",I[I.CHARACTER_SET=4]="CHARACTER_SET",I[I.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",I[I.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",I[I.ASSUME_GS1=7]="ASSUME_GS1",I[I.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",I[I.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",I[I.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(ie||(ie={}));var Q=ie;class M extends m{static getFormatInstance(){return new M}}M.kind="FormatException";var ne;(function(I){I[I.Cp437=0]="Cp437",I[I.ISO8859_1=1]="ISO8859_1",I[I.ISO8859_2=2]="ISO8859_2",I[I.ISO8859_3=3]="ISO8859_3",I[I.ISO8859_4=4]="ISO8859_4",I[I.ISO8859_5=5]="ISO8859_5",I[I.ISO8859_6=6]="ISO8859_6",I[I.ISO8859_7=7]="ISO8859_7",I[I.ISO8859_8=8]="ISO8859_8",I[I.ISO8859_9=9]="ISO8859_9",I[I.ISO8859_10=10]="ISO8859_10",I[I.ISO8859_11=11]="ISO8859_11",I[I.ISO8859_13=12]="ISO8859_13",I[I.ISO8859_14=13]="ISO8859_14",I[I.ISO8859_15=14]="ISO8859_15",I[I.ISO8859_16=15]="ISO8859_16",I[I.SJIS=16]="SJIS",I[I.Cp1250=17]="Cp1250",I[I.Cp1251=18]="Cp1251",I[I.Cp1252=19]="Cp1252",I[I.Cp1256=20]="Cp1256",I[I.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",I[I.UTF8=22]="UTF8",I[I.ASCII=23]="ASCII",I[I.Big5=24]="Big5",I[I.GB18030=25]="GB18030",I[I.EUC_KR=26]="EUC_KR"})(ne||(ne={}));class X{constructor(a,i,c,...o){this.valueIdentifier=a,this.name=c,typeof i=="number"?this.values=Int32Array.from([i]):this.values=i,this.otherEncodingNames=o,X.VALUE_IDENTIFIER_TO_ECI.set(a,this),X.NAME_TO_ECI.set(c,this);const l=this.values;for(let h=0,d=l.length;h!==d;h++){const g=l[h];X.VALUES_TO_ECI.set(g,this)}for(const h of o)X.NAME_TO_ECI.set(h,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(a){if(a<0||a>=900)throw new M("incorect value");const i=X.VALUES_TO_ECI.get(a);if(i===void 0)throw new M("incorect value");return i}static getCharacterSetECIByName(a){const i=X.NAME_TO_ECI.get(a);if(i===void 0)throw new M("incorect value");return i}equals(a){if(!(a instanceof X))return!1;const i=a;return this.getName()===i.getName()}}X.VALUE_IDENTIFIER_TO_ECI=new Map,X.VALUES_TO_ECI=new Map,X.NAME_TO_ECI=new Map,X.Cp437=new X(ne.Cp437,Int32Array.from([0,2]),"Cp437"),X.ISO8859_1=new X(ne.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),X.ISO8859_2=new X(ne.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),X.ISO8859_3=new X(ne.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),X.ISO8859_4=new X(ne.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),X.ISO8859_5=new X(ne.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),X.ISO8859_6=new X(ne.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),X.ISO8859_7=new X(ne.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),X.ISO8859_8=new X(ne.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),X.ISO8859_9=new X(ne.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),X.ISO8859_10=new X(ne.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),X.ISO8859_11=new X(ne.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),X.ISO8859_13=new X(ne.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),X.ISO8859_14=new X(ne.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),X.ISO8859_15=new X(ne.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),X.ISO8859_16=new X(ne.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),X.SJIS=new X(ne.SJIS,20,"SJIS","Shift_JIS"),X.Cp1250=new X(ne.Cp1250,21,"Cp1250","windows-1250"),X.Cp1251=new X(ne.Cp1251,22,"Cp1251","windows-1251"),X.Cp1252=new X(ne.Cp1252,23,"Cp1252","windows-1252"),X.Cp1256=new X(ne.Cp1256,24,"Cp1256","windows-1256"),X.UnicodeBigUnmarked=new X(ne.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),X.UTF8=new X(ne.UTF8,26,"UTF8","UTF-8"),X.ASCII=new X(ne.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),X.Big5=new X(ne.Big5,28,"Big5"),X.GB18030=new X(ne.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),X.EUC_KR=new X(ne.EUC_KR,30,"EUC_KR","EUC-KR");class me extends m{}me.kind="UnsupportedOperationException";class le{static decode(a,i){const c=this.encodingName(i);return this.customDecoder?this.customDecoder(a,c):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(c)?this.decodeFallback(a,c):new TextDecoder(c).decode(a)}static shouldDecodeOnFallback(a){return!le.isBrowser()&&a==="ISO-8859-1"}static encode(a,i){const c=this.encodingName(i);return this.customEncoder?this.customEncoder(a,c):typeof TextEncoder>"u"?this.encodeFallback(a):new TextEncoder().encode(a)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(a){return typeof a=="string"?a:a.getName()}static encodingCharacterSet(a){return a instanceof X?a:X.getCharacterSetECIByName(a)}static decodeFallback(a,i){const c=this.encodingCharacterSet(i);if(le.isDecodeFallbackSupported(c)){let o="";for(let l=0,h=a.length;l<h;l++){let d=a[l].toString(16);d.length<2&&(d="0"+d),o+="%"+d}return decodeURIComponent(o)}if(c.equals(X.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(a.buffer));throw new me(`Encoding ${this.encodingName(i)} not supported by fallback.`)}static isDecodeFallbackSupported(a){return a.equals(X.UTF8)||a.equals(X.ISO8859_1)||a.equals(X.ASCII)}static encodeFallback(a){const c=btoa(unescape(encodeURIComponent(a))).split(""),o=[];for(let l=0;l<c.length;l++)o.push(c[l].charCodeAt(0));return new Uint8Array(o)}}class ee{static castAsNonUtf8Char(a,i=null){const c=i?i.getName():this.ISO88591;return le.decode(new Uint8Array([a]),c)}static guessEncoding(a,i){if(i!=null&&i.get(Q.CHARACTER_SET)!==void 0)return i.get(Q.CHARACTER_SET).toString();const c=a.length;let o=!0,l=!0,h=!0,d=0,g=0,w=0,_=0,C=0,T=0,R=0,L=0,W=0,te=0,se=0;const Ce=a.length>3&&a[0]===239&&a[1]===187&&a[2]===191;for(let Te=0;Te<c&&(o||l||h);Te++){const ce=a[Te]&255;h&&(d>0?ce&128?d--:h=!1:ce&128&&(ce&64?(d++,ce&32?(d++,ce&16?(d++,ce&8?h=!1:_++):w++):g++):h=!1)),o&&(ce>127&&ce<160?o=!1:ce>159&&(ce<192||ce===215||ce===247)&&se++),l&&(C>0?ce<64||ce===127||ce>252?l=!1:C--:ce===128||ce===160||ce>239?l=!1:ce>160&&ce<224?(T++,L=0,R++,R>W&&(W=R)):ce>127?(C++,R=0,L++,L>te&&(te=L)):(R=0,L=0))}return h&&d>0&&(h=!1),l&&C>0&&(l=!1),h&&(Ce||g+w+_>0)?ee.UTF8:l&&(ee.ASSUME_SHIFT_JIS||W>=3||te>=3)?ee.SHIFT_JIS:o&&l?W===2&&T===2||se*10>=c?ee.SHIFT_JIS:ee.ISO88591:o?ee.ISO88591:l?ee.SHIFT_JIS:h?ee.UTF8:ee.PLATFORM_DEFAULT_ENCODING}static format(a,...i){let c=-1;function o(h,d,g,w,_,C){if(h==="%%")return"%";if(i[++c]===void 0)return;h=w?parseInt(w.substr(1)):void 0;let T=_?parseInt(_.substr(1)):void 0,R;switch(C){case"s":R=i[c];break;case"c":R=i[c][0];break;case"f":R=parseFloat(i[c]).toFixed(h);break;case"p":R=parseFloat(i[c]).toPrecision(h);break;case"e":R=parseFloat(i[c]).toExponential(h);break;case"x":R=parseInt(i[c]).toString(T||16);break;case"d":R=parseFloat(parseInt(i[c],T||10).toPrecision(h)).toFixed(0);break}R=typeof R=="object"?JSON.stringify(R):(+R).toString(T);let L=parseInt(g),W=g&&g[0]+""=="0"?"0":" ";for(;R.length<L;)R=d!==void 0?R+W:W+R;return R}let l=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return a.replace(l,o)}static getBytes(a,i){return le.encode(a,i)}static getCharCode(a,i=0){return a.charCodeAt(i)}static getCharAt(a){return String.fromCharCode(a)}}ee.SHIFT_JIS=X.SJIS.getName(),ee.GB2312="GB2312",ee.ISO88591=X.ISO8859_1.getName(),ee.EUC_JP="EUC_JP",ee.UTF8=X.UTF8.getName(),ee.PLATFORM_DEFAULT_ENCODING=ee.UTF8,ee.ASSUME_SHIFT_JIS=!1;class pe{constructor(a=""){this.value=a}enableDecoding(a){return this.encoding=a,this}append(a){return typeof a=="string"?this.value+=a.toString():this.encoding?this.value+=ee.castAsNonUtf8Char(a,this.encoding):this.value+=String.fromCharCode(a),this}appendChars(a,i,c){for(let o=i;i<i+c;o++)this.append(a[o]);return this}length(){return this.value.length}charAt(a){return this.value.charAt(a)}deleteCharAt(a){this.value=this.value.substr(0,a)+this.value.substring(a+1)}setCharAt(a,i){this.value=this.value.substr(0,a)+i+this.value.substr(a+1)}substring(a,i){return this.value.substring(a,i)}setLengthToZero(){this.value=""}toString(){return this.value}insert(a,i){this.value=this.value.substr(0,a)+i+this.value.substr(a+i.length)}}class Pe{constructor(a,i,c,o){if(this.width=a,this.height=i,this.rowSize=c,this.bits=o,i==null&&(i=a),this.height=i,a<1||i<1)throw new E("Both dimensions must be greater than 0");c==null&&(c=Math.floor((a+31)/32)),this.rowSize=c,o==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(a){const i=a.length,c=a[0].length,o=new Pe(c,i);for(let l=0;l<i;l++){const h=a[l];for(let d=0;d<c;d++)h[d]&&o.set(d,l)}return o}static parseFromString(a,i,c){if(a===null)throw new E("stringRepresentation cannot be null");const o=new Array(a.length);let l=0,h=0,d=-1,g=0,w=0;for(;w<a.length;)if(a.charAt(w)===`
`||a.charAt(w)==="\r"){if(l>h){if(d===-1)d=l-h;else if(l-h!==d)throw new E("row lengths do not match");h=l,g++}w++}else if(a.substring(w,w+i.length)===i)w+=i.length,o[l]=!0,l++;else if(a.substring(w,w+c.length)===c)w+=c.length,o[l]=!1,l++;else throw new E("illegal character encountered: "+a.substring(w));if(l>h){if(d===-1)d=l-h;else if(l-h!==d)throw new E("row lengths do not match");g++}const _=new Pe(d,g);for(let C=0;C<l;C++)o[C]&&_.set(Math.floor(C%d),Math.floor(C/d));return _}get(a,i){const c=i*this.rowSize+Math.floor(a/32);return(this.bits[c]>>>(a&31)&1)!==0}set(a,i){const c=i*this.rowSize+Math.floor(a/32);this.bits[c]|=1<<(a&31)&4294967295}unset(a,i){const c=i*this.rowSize+Math.floor(a/32);this.bits[c]&=~(1<<(a&31)&4294967295)}flip(a,i){const c=i*this.rowSize+Math.floor(a/32);this.bits[c]^=1<<(a&31)&4294967295}xor(a){if(this.width!==a.getWidth()||this.height!==a.getHeight()||this.rowSize!==a.getRowSize())throw new E("input matrix dimensions do not match");const i=new J(Math.floor(this.width/32)+1),c=this.rowSize,o=this.bits;for(let l=0,h=this.height;l<h;l++){const d=l*c,g=a.getRow(l,i).getBitArray();for(let w=0;w<c;w++)o[d+w]^=g[w]}}clear(){const a=this.bits,i=a.length;for(let c=0;c<i;c++)a[c]=0}setRegion(a,i,c,o){if(i<0||a<0)throw new E("Left and top must be nonnegative");if(o<1||c<1)throw new E("Height and width must be at least 1");const l=a+c,h=i+o;if(h>this.height||l>this.width)throw new E("The region must fit inside the matrix");const d=this.rowSize,g=this.bits;for(let w=i;w<h;w++){const _=w*d;for(let C=a;C<l;C++)g[_+Math.floor(C/32)]|=1<<(C&31)&4294967295}}getRow(a,i){i==null||i.getSize()<this.width?i=new J(this.width):i.clear();const c=this.rowSize,o=this.bits,l=a*c;for(let h=0;h<c;h++)i.setBulk(h*32,o[l+h]);return i}setRow(a,i){A.arraycopy(i.getBitArray(),0,this.bits,a*this.rowSize,this.rowSize)}rotate180(){const a=this.getWidth(),i=this.getHeight();let c=new J(a),o=new J(a);for(let l=0,h=Math.floor((i+1)/2);l<h;l++)c=this.getRow(l,c),o=this.getRow(i-1-l,o),c.reverse(),o.reverse(),this.setRow(l,o),this.setRow(i-1-l,c)}getEnclosingRectangle(){const a=this.width,i=this.height,c=this.rowSize,o=this.bits;let l=a,h=i,d=-1,g=-1;for(let w=0;w<i;w++)for(let _=0;_<c;_++){const C=o[w*c+_];if(C!==0){if(w<h&&(h=w),w>g&&(g=w),_*32<l){let T=0;for(;!(C<<31-T&4294967295);)T++;_*32+T<l&&(l=_*32+T)}if(_*32+31>d){let T=31;for(;!(C>>>T);)T--;_*32+T>d&&(d=_*32+T)}}}return d<l||g<h?null:Int32Array.from([l,h,d-l+1,g-h+1])}getTopLeftOnBit(){const a=this.rowSize,i=this.bits;let c=0;for(;c<i.length&&i[c]===0;)c++;if(c===i.length)return null;const o=c/a;let l=c%a*32;const h=i[c];let d=0;for(;!(h<<31-d&4294967295);)d++;return l+=d,Int32Array.from([l,o])}getBottomRightOnBit(){const a=this.rowSize,i=this.bits;let c=i.length-1;for(;c>=0&&i[c]===0;)c--;if(c<0)return null;const o=Math.floor(c/a);let l=Math.floor(c%a)*32;const h=i[c];let d=31;for(;!(h>>>d);)d--;return l+=d,Int32Array.from([l,o])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(a){if(!(a instanceof Pe))return!1;const i=a;return this.width===i.width&&this.height===i.height&&this.rowSize===i.rowSize&&G.equals(this.bits,i.bits)}hashCode(){let a=this.width;return a=31*a+this.width,a=31*a+this.height,a=31*a+this.rowSize,a=31*a+G.hashCode(this.bits),a}toString(a="X ",i="  ",c=`
`){return this.buildToString(a,i,c)}buildToString(a,i,c){let o=new pe;for(let l=0,h=this.height;l<h;l++){for(let d=0,g=this.width;d<g;d++)o.append(this.get(d,l)?a:i);o.append(c)}return o.toString()}clone(){return new Pe(this.width,this.height,this.rowSize,this.bits.slice())}}class re extends m{static getNotFoundInstance(){return new re}}re.kind="NotFoundException";class Le extends k{constructor(a){super(a),this.luminances=Le.EMPTY,this.buckets=new Int32Array(Le.LUMINANCE_BUCKETS)}getBlackRow(a,i){const c=this.getLuminanceSource(),o=c.getWidth();i==null||i.getSize()<o?i=new J(o):i.clear(),this.initArrays(o);const l=c.getRow(a,this.luminances),h=this.buckets;for(let g=0;g<o;g++)h[(l[g]&255)>>Le.LUMINANCE_SHIFT]++;const d=Le.estimateBlackPoint(h);if(o<3)for(let g=0;g<o;g++)(l[g]&255)<d&&i.set(g);else{let g=l[0]&255,w=l[1]&255;for(let _=1;_<o-1;_++){const C=l[_+1]&255;(w*4-g-C)/2<d&&i.set(_),g=w,w=C}}return i}getBlackMatrix(){const a=this.getLuminanceSource(),i=a.getWidth(),c=a.getHeight(),o=new Pe(i,c);this.initArrays(i);const l=this.buckets;for(let g=1;g<5;g++){const w=Math.floor(c*g/5),_=a.getRow(w,this.luminances),C=Math.floor(i*4/5);for(let T=Math.floor(i/5);T<C;T++){const R=_[T]&255;l[R>>Le.LUMINANCE_SHIFT]++}}const h=Le.estimateBlackPoint(l),d=a.getMatrix();for(let g=0;g<c;g++){const w=g*i;for(let _=0;_<i;_++)(d[w+_]&255)<h&&o.set(_,g)}return o}createBinarizer(a){return new Le(a)}initArrays(a){this.luminances.length<a&&(this.luminances=new Uint8ClampedArray(a));const i=this.buckets;for(let c=0;c<Le.LUMINANCE_BUCKETS;c++)i[c]=0}static estimateBlackPoint(a){const i=a.length;let c=0,o=0,l=0;for(let _=0;_<i;_++)a[_]>l&&(o=_,l=a[_]),a[_]>c&&(c=a[_]);let h=0,d=0;for(let _=0;_<i;_++){const C=_-o,T=a[_]*C*C;T>d&&(h=_,d=T)}if(o>h){const _=o;o=h,h=_}if(h-o<=i/16)throw new re;let g=h-1,w=-1;for(let _=h-1;_>o;_--){const C=_-o,T=C*C*(h-_)*(c-a[_]);T>w&&(g=_,w=T)}return g<<Le.LUMINANCE_SHIFT}}Le.LUMINANCE_BITS=5,Le.LUMINANCE_SHIFT=8-Le.LUMINANCE_BITS,Le.LUMINANCE_BUCKETS=1<<Le.LUMINANCE_BITS,Le.EMPTY=Uint8ClampedArray.from([0]);class be extends Le{constructor(a){super(a),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const a=this.getLuminanceSource(),i=a.getWidth(),c=a.getHeight();if(i>=be.MINIMUM_DIMENSION&&c>=be.MINIMUM_DIMENSION){const o=a.getMatrix();let l=i>>be.BLOCK_SIZE_POWER;i&be.BLOCK_SIZE_MASK&&l++;let h=c>>be.BLOCK_SIZE_POWER;c&be.BLOCK_SIZE_MASK&&h++;const d=be.calculateBlackPoints(o,l,h,i,c),g=new Pe(i,c);be.calculateThresholdForBlock(o,l,h,i,c,d,g),this.matrix=g}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(a){return new be(a)}static calculateThresholdForBlock(a,i,c,o,l,h,d){const g=l-be.BLOCK_SIZE,w=o-be.BLOCK_SIZE;for(let _=0;_<c;_++){let C=_<<be.BLOCK_SIZE_POWER;C>g&&(C=g);const T=be.cap(_,2,c-3);for(let R=0;R<i;R++){let L=R<<be.BLOCK_SIZE_POWER;L>w&&(L=w);const W=be.cap(R,2,i-3);let te=0;for(let Ce=-2;Ce<=2;Ce++){const Te=h[T+Ce];te+=Te[W-2]+Te[W-1]+Te[W]+Te[W+1]+Te[W+2]}const se=te/25;be.thresholdBlock(a,L,C,se,o,d)}}}static cap(a,i,c){return a<i?i:a>c?c:a}static thresholdBlock(a,i,c,o,l,h){for(let d=0,g=c*l+i;d<be.BLOCK_SIZE;d++,g+=l)for(let w=0;w<be.BLOCK_SIZE;w++)(a[g+w]&255)<=o&&h.set(i+w,c+d)}static calculateBlackPoints(a,i,c,o,l){const h=l-be.BLOCK_SIZE,d=o-be.BLOCK_SIZE,g=new Array(c);for(let w=0;w<c;w++){g[w]=new Int32Array(i);let _=w<<be.BLOCK_SIZE_POWER;_>h&&(_=h);for(let C=0;C<i;C++){let T=C<<be.BLOCK_SIZE_POWER;T>d&&(T=d);let R=0,L=255,W=0;for(let se=0,Ce=_*o+T;se<be.BLOCK_SIZE;se++,Ce+=o){for(let Te=0;Te<be.BLOCK_SIZE;Te++){const ce=a[Ce+Te]&255;R+=ce,ce<L&&(L=ce),ce>W&&(W=ce)}if(W-L>be.MIN_DYNAMIC_RANGE)for(se++,Ce+=o;se<be.BLOCK_SIZE;se++,Ce+=o)for(let Te=0;Te<be.BLOCK_SIZE;Te++)R+=a[Ce+Te]&255}let te=R>>be.BLOCK_SIZE_POWER*2;if(W-L<=be.MIN_DYNAMIC_RANGE&&(te=L/2,w>0&&C>0)){const se=(g[w-1][C]+2*g[w][C-1]+g[w-1][C-1])/4;L<se&&(te=se)}g[w][C]=te}}return g}}be.BLOCK_SIZE_POWER=3,be.BLOCK_SIZE=1<<be.BLOCK_SIZE_POWER,be.BLOCK_SIZE_MASK=be.BLOCK_SIZE-1,be.MINIMUM_DIMENSION=be.BLOCK_SIZE*5,be.MIN_DYNAMIC_RANGE=24;class St{constructor(a,i){this.width=a,this.height=i}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(a,i,c,o){throw new me("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new me("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new me("This luminance source does not support rotation by 45 degrees.")}toString(){const a=new Uint8ClampedArray(this.width);let i=new pe;for(let c=0;c<this.height;c++){const o=this.getRow(c,a);for(let l=0;l<this.width;l++){const h=o[l]&255;let d;h<64?d="#":h<128?d="+":h<192?d=".":d=" ",i.append(d)}i.append(`
`)}return i.toString()}}class ue extends St{constructor(a){super(a.getWidth(),a.getHeight()),this.delegate=a}getRow(a,i){const c=this.delegate.getRow(a,i),o=this.getWidth();for(let l=0;l<o;l++)c[l]=255-(c[l]&255);return c}getMatrix(){const a=this.delegate.getMatrix(),i=this.getWidth()*this.getHeight(),c=new Uint8ClampedArray(i);for(let o=0;o<i;o++)c[o]=255-(a[o]&255);return c}isCropSupported(){return this.delegate.isCropSupported()}crop(a,i,c,o){return new ue(this.delegate.crop(a,i,c,o))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new ue(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new ue(this.delegate.rotateCounterClockwise45())}}class Ye extends St{constructor(a){super(a.width,a.height),this.canvas=a,this.tempCanvasElement=null,this.buffer=Ye.makeBufferFromCanvasImageData(a)}static makeBufferFromCanvasImageData(a){const i=a.getContext("2d").getImageData(0,0,a.width,a.height);return Ye.toGrayscaleBuffer(i.data,a.width,a.height)}static toGrayscaleBuffer(a,i,c){const o=new Uint8ClampedArray(i*c);for(let l=0,h=0,d=a.length;l<d;l+=4,h++){let g;if(a[l+3]===0)g=255;else{const _=a[l],C=a[l+1],T=a[l+2];g=306*_+601*C+117*T+512>>10}o[h]=g}return o}getRow(a,i){if(a<0||a>=this.getHeight())throw new E("Requested row is outside the image: "+a);const c=this.getWidth(),o=a*c;return i===null?i=this.buffer.slice(o,o+c):(i.length<c&&(i=new Uint8ClampedArray(c)),i.set(this.buffer.slice(o,o+c))),i}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(a,i,c,o){return super.crop(a,i,c,o),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const a=this.canvas.ownerDocument.createElement("canvas");a.width=this.canvas.width,a.height=this.canvas.height,this.tempCanvasElement=a}return this.tempCanvasElement}rotate(a){const i=this.getTempCanvasElement(),c=i.getContext("2d"),o=a*Ye.DEGREE_TO_RADIANS,l=this.canvas.width,h=this.canvas.height,d=Math.ceil(Math.abs(Math.cos(o))*l+Math.abs(Math.sin(o))*h),g=Math.ceil(Math.abs(Math.sin(o))*l+Math.abs(Math.cos(o))*h);return i.width=d,i.height=g,c.translate(d/2,g/2),c.rotate(o),c.drawImage(this.canvas,l/-2,h/-2),this.buffer=Ye.makeBufferFromCanvasImageData(i),this}invert(){return new ue(this)}}Ye.DEGREE_TO_RADIANS=Math.PI/180;class Qe{constructor(a,i,c){this.deviceId=a,this.label=i,this.kind="videoinput",this.groupId=c||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var K=(globalThis||Cs||self||window||void 0)&&(globalThis||Cs||self||window||void 0).__awaiter||function(I,a,i,c){function o(l){return l instanceof i?l:new i(function(h){h(l)})}return new(i||(i=Promise))(function(l,h){function d(_){try{w(c.next(_))}catch(C){h(C)}}function g(_){try{w(c.throw(_))}catch(C){h(C)}}function w(_){_.done?l(_.value):o(_.value).then(d,g)}w((c=c.apply(I,a||[])).next())})};class ae{constructor(a,i=500,c){this.reader=a,this.timeBetweenScansMillis=i,this._hints=c,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(a){this._timeBetweenDecodingAttempts=a<0?0:a}set hints(a){this._hints=a||null}get hints(){return this._hints}listVideoInputDevices(){return K(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const a=yield navigator.mediaDevices.enumerateDevices(),i=[];for(const c of a){const o=c.kind==="video"?"videoinput":c.kind;if(o!=="videoinput")continue;const l=c.deviceId||c.id,h=c.label||`Video device ${i.length+1}`,d=c.groupId,g={deviceId:l,label:h,kind:o,groupId:d};i.push(g)}return i})}getVideoInputDevices(){return K(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(i=>new Qe(i.deviceId,i.label))})}findDeviceById(a){return K(this,void 0,void 0,function*(){const i=yield this.listVideoInputDevices();return i?i.find(c=>c.deviceId===a):null})}decodeFromInputVideoDevice(a,i){return K(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(a,i)})}decodeOnceFromVideoDevice(a,i){return K(this,void 0,void 0,function*(){this.reset();let c;a?c={deviceId:{exact:a}}:c={facingMode:"environment"};const o={video:c};return yield this.decodeOnceFromConstraints(o,i)})}decodeOnceFromConstraints(a,i){return K(this,void 0,void 0,function*(){const c=yield navigator.mediaDevices.getUserMedia(a);return yield this.decodeOnceFromStream(c,i)})}decodeOnceFromStream(a,i){return K(this,void 0,void 0,function*(){this.reset();const c=yield this.attachStreamToVideo(a,i);return yield this.decodeOnce(c)})}decodeFromInputVideoDeviceContinuously(a,i,c){return K(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(a,i,c)})}decodeFromVideoDevice(a,i,c){return K(this,void 0,void 0,function*(){let o;a?o={deviceId:{exact:a}}:o={facingMode:"environment"};const l={video:o};return yield this.decodeFromConstraints(l,i,c)})}decodeFromConstraints(a,i,c){return K(this,void 0,void 0,function*(){const o=yield navigator.mediaDevices.getUserMedia(a);return yield this.decodeFromStream(o,i,c)})}decodeFromStream(a,i,c){return K(this,void 0,void 0,function*(){this.reset();const o=yield this.attachStreamToVideo(a,i);return yield this.decodeContinuously(o,c)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(a,i){return K(this,void 0,void 0,function*(){const c=this.prepareVideoElement(i);return this.addVideoSource(c,a),this.videoElement=c,this.stream=a,yield this.playVideoOnLoadAsync(c),c})}playVideoOnLoadAsync(a){return new Promise((i,c)=>this.playVideoOnLoad(a,()=>i()))}playVideoOnLoad(a,i){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(a),a.addEventListener("ended",this.videoEndedListener),a.addEventListener("canplay",this.videoCanPlayListener),a.addEventListener("playing",i),this.tryPlayVideo(a)}isVideoPlaying(a){return a.currentTime>0&&!a.paused&&!a.ended&&a.readyState>2}tryPlayVideo(a){return K(this,void 0,void 0,function*(){if(this.isVideoPlaying(a)){console.warn("Trying to play video that is already playing.");return}try{yield a.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(a,i){const c=document.getElementById(a);if(!c)throw new v(`element with id '${a}' not found`);if(c.nodeName.toLowerCase()!==i.toLowerCase())throw new v(`element with id '${a}' must be an ${i} element`);return c}decodeFromImage(a,i){if(!a&&!i)throw new v("either imageElement with a src set or an url must be provided");return i&&!a?this.decodeFromImageUrl(i):this.decodeFromImageElement(a)}decodeFromVideo(a,i){if(!a&&!i)throw new v("Either an element with a src set or an URL must be provided");return i&&!a?this.decodeFromVideoUrl(i):this.decodeFromVideoElement(a)}decodeFromVideoContinuously(a,i,c){if(a===void 0&&i===void 0)throw new v("Either an element with a src set or an URL must be provided");return i&&!a?this.decodeFromVideoUrlContinuously(i,c):this.decodeFromVideoElementContinuously(a,c)}decodeFromImageElement(a){if(!a)throw new v("An image element must be provided.");this.reset();const i=this.prepareImageElement(a);this.imageElement=i;let c;return this.isImageLoaded(i)?c=this.decodeOnce(i,!1,!0):c=this._decodeOnLoadImage(i),c}decodeFromVideoElement(a){const i=this._decodeFromVideoElementSetup(a);return this._decodeOnLoadVideo(i)}decodeFromVideoElementContinuously(a,i){const c=this._decodeFromVideoElementSetup(a);return this._decodeOnLoadVideoContinuously(c,i)}_decodeFromVideoElementSetup(a){if(!a)throw new v("A video element must be provided.");this.reset();const i=this.prepareVideoElement(a);return this.videoElement=i,i}decodeFromImageUrl(a){if(!a)throw new v("An URL must be provided.");this.reset();const i=this.prepareImageElement();this.imageElement=i;const c=this._decodeOnLoadImage(i);return i.src=a,c}decodeFromVideoUrl(a){if(!a)throw new v("An URL must be provided.");this.reset();const i=this.prepareVideoElement(),c=this.decodeFromVideoElement(i);return i.src=a,c}decodeFromVideoUrlContinuously(a,i){if(!a)throw new v("An URL must be provided.");this.reset();const c=this.prepareVideoElement(),o=this.decodeFromVideoElementContinuously(c,i);return c.src=a,o}_decodeOnLoadImage(a){return new Promise((i,c)=>{this.imageLoadedListener=()=>this.decodeOnce(a,!1,!0).then(i,c),a.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(a){return K(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(a),yield this.decodeOnce(a)})}_decodeOnLoadVideoContinuously(a,i){return K(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(a),this.decodeContinuously(a,i)})}isImageLoaded(a){return!(!a.complete||a.naturalWidth===0)}prepareImageElement(a){let i;return typeof a>"u"&&(i=document.createElement("img"),i.width=200,i.height=200),typeof a=="string"&&(i=this.getMediaElement(a,"img")),a instanceof HTMLImageElement&&(i=a),i}prepareVideoElement(a){let i;return!a&&typeof document<"u"&&(i=document.createElement("video"),i.width=200,i.height=200),typeof a=="string"&&(i=this.getMediaElement(a,"video")),a instanceof HTMLVideoElement&&(i=a),i.setAttribute("autoplay","true"),i.setAttribute("muted","true"),i.setAttribute("playsinline","true"),i}decodeOnce(a,i=!0,c=!0){this._stopAsyncDecode=!1;const o=(l,h)=>{if(this._stopAsyncDecode){h(new re("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const d=this.decode(a);l(d)}catch(d){const g=i&&d instanceof re,_=(d instanceof S||d instanceof M)&&c;if(g||_)return setTimeout(o,this._timeBetweenDecodingAttempts,l,h);h(d)}};return new Promise((l,h)=>o(l,h))}decodeContinuously(a,i){this._stopContinuousDecode=!1;const c=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const o=this.decode(a);i(o,null),setTimeout(c,this.timeBetweenScansMillis)}catch(o){i(null,o);const l=o instanceof S||o instanceof M,h=o instanceof re;(l||h)&&setTimeout(c,this._timeBetweenDecodingAttempts)}};c()}decode(a){const i=this.createBinaryBitmap(a);return this.decodeBitmap(i)}_isHTMLVideoElement(a){return a.videoWidth!==0}drawFrameOnCanvas(a,i,c){i||(i={sx:0,sy:0,sWidth:a.videoWidth,sHeight:a.videoHeight,dx:0,dy:0,dWidth:a.videoWidth,dHeight:a.videoHeight}),c||(c=this.captureCanvasContext),c.drawImage(a,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}drawImageOnCanvas(a,i,c=this.captureCanvasContext){i||(i={sx:0,sy:0,sWidth:a.naturalWidth,sHeight:a.naturalHeight,dx:0,dy:0,dWidth:a.naturalWidth,dHeight:a.naturalHeight}),c||(c=this.captureCanvasContext),c.drawImage(a,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}createBinaryBitmap(a){this.getCaptureCanvasContext(a),this._isHTMLVideoElement(a)?this.drawFrameOnCanvas(a):this.drawImageOnCanvas(a);const i=this.getCaptureCanvas(a),c=new Ye(i),o=new be(c);return new b(o)}getCaptureCanvasContext(a){if(!this.captureCanvasContext){const c=this.getCaptureCanvas(a).getContext("2d");this.captureCanvasContext=c}return this.captureCanvasContext}getCaptureCanvas(a){if(!this.captureCanvas){const i=this.createCaptureCanvas(a);this.captureCanvas=i}return this.captureCanvas}decodeBitmap(a){return this.reader.decode(a,this._hints)}createCaptureCanvas(a){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const i=document.createElement("canvas");let c,o;return typeof a<"u"&&(a instanceof HTMLVideoElement?(c=a.videoWidth,o=a.videoHeight):a instanceof HTMLImageElement&&(c=a.naturalWidth||a.width,o=a.naturalHeight||a.height)),i.style.width=c+"px",i.style.height=o+"px",i.width=c,i.height=o,i}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(a=>a.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(a,i){try{a.srcObject=i}catch{a.src=URL.createObjectURL(i)}}cleanVideoSource(a){try{a.srcObject=null}catch{a.src=""}this.videoElement.removeAttribute("src")}}class z{constructor(a,i,c=i==null?0:8*i.length,o,l,h=A.currentTimeMillis()){this.text=a,this.rawBytes=i,this.numBits=c,this.resultPoints=o,this.format=l,this.timestamp=h,this.text=a,this.rawBytes=i,c==null?this.numBits=i==null?0:8*i.length:this.numBits=c,this.resultPoints=o,this.format=l,this.resultMetadata=null,h==null?this.timestamp=A.currentTimeMillis():this.timestamp=h}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(a,i){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(a,i)}putAllMetadata(a){a!==null&&(this.resultMetadata===null?this.resultMetadata=a:this.resultMetadata=new Map(a))}addResultPoints(a){const i=this.resultPoints;if(i===null)this.resultPoints=a;else if(a!==null&&a.length>0){const c=new Array(i.length+a.length);A.arraycopy(i,0,c,0,i.length),A.arraycopy(a,0,c,i.length,a.length),this.resultPoints=c}}getTimestamp(){return this.timestamp}toString(){return this.text}}var N;(function(I){I[I.AZTEC=0]="AZTEC",I[I.CODABAR=1]="CODABAR",I[I.CODE_39=2]="CODE_39",I[I.CODE_93=3]="CODE_93",I[I.CODE_128=4]="CODE_128",I[I.DATA_MATRIX=5]="DATA_MATRIX",I[I.EAN_8=6]="EAN_8",I[I.EAN_13=7]="EAN_13",I[I.ITF=8]="ITF",I[I.MAXICODE=9]="MAXICODE",I[I.PDF_417=10]="PDF_417",I[I.QR_CODE=11]="QR_CODE",I[I.RSS_14=12]="RSS_14",I[I.RSS_EXPANDED=13]="RSS_EXPANDED",I[I.UPC_A=14]="UPC_A",I[I.UPC_E=15]="UPC_E",I[I.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(N||(N={}));var B=N,Ne;(function(I){I[I.OTHER=0]="OTHER",I[I.ORIENTATION=1]="ORIENTATION",I[I.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",I[I.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",I[I.ISSUE_NUMBER=4]="ISSUE_NUMBER",I[I.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",I[I.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",I[I.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",I[I.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",I[I.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",I[I.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Ne||(Ne={}));var we=Ne;class ve{constructor(a,i,c,o,l=-1,h=-1){this.rawBytes=a,this.text=i,this.byteSegments=c,this.ecLevel=o,this.structuredAppendSequenceNumber=l,this.structuredAppendParity=h,this.numBits=a==null?0:8*a.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(a){this.numBits=a}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(a){this.errorsCorrected=a}getErasures(){return this.erasures}setErasures(a){this.erasures=a}getOther(){return this.other}setOther(a){this.other=a}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Ae{exp(a){return this.expTable[a]}log(a){if(a===0)throw new E;return this.logTable[a]}static addOrSubtract(a,i){return a^i}}class Xe{constructor(a,i){if(i.length===0)throw new E;this.field=a;const c=i.length;if(c>1&&i[0]===0){let o=1;for(;o<c&&i[o]===0;)o++;o===c?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(c-o),A.arraycopy(i,o,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(a){return this.coefficients[this.coefficients.length-1-a]}evaluateAt(a){if(a===0)return this.getCoefficient(0);const i=this.coefficients;let c;if(a===1){c=0;for(let h=0,d=i.length;h!==d;h++){const g=i[h];c=Ae.addOrSubtract(c,g)}return c}c=i[0];const o=i.length,l=this.field;for(let h=1;h<o;h++)c=Ae.addOrSubtract(l.multiply(a,c),i[h]);return c}addOrSubtract(a){if(!this.field.equals(a.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero())return a;if(a.isZero())return this;let i=this.coefficients,c=a.coefficients;if(i.length>c.length){const h=i;i=c,c=h}let o=new Int32Array(c.length);const l=c.length-i.length;A.arraycopy(c,0,o,0,l);for(let h=l;h<c.length;h++)o[h]=Ae.addOrSubtract(i[h-l],c[h]);return new Xe(this.field,o)}multiply(a){if(!this.field.equals(a.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero()||a.isZero())return this.field.getZero();const i=this.coefficients,c=i.length,o=a.coefficients,l=o.length,h=new Int32Array(c+l-1),d=this.field;for(let g=0;g<c;g++){const w=i[g];for(let _=0;_<l;_++)h[g+_]=Ae.addOrSubtract(h[g+_],d.multiply(w,o[_]))}return new Xe(d,h)}multiplyScalar(a){if(a===0)return this.field.getZero();if(a===1)return this;const i=this.coefficients.length,c=this.field,o=new Int32Array(i),l=this.coefficients;for(let h=0;h<i;h++)o[h]=c.multiply(l[h],a);return new Xe(c,o)}multiplyByMonomial(a,i){if(a<0)throw new E;if(i===0)return this.field.getZero();const c=this.coefficients,o=c.length,l=new Int32Array(o+a),h=this.field;for(let d=0;d<o;d++)l[d]=h.multiply(c[d],i);return new Xe(h,l)}divide(a){if(!this.field.equals(a.field))throw new E("GenericGFPolys do not have same GenericGF field");if(a.isZero())throw new E("Divide by 0");const i=this.field;let c=i.getZero(),o=this;const l=a.getCoefficient(a.getDegree()),h=i.inverse(l);for(;o.getDegree()>=a.getDegree()&&!o.isZero();){const d=o.getDegree()-a.getDegree(),g=i.multiply(o.getCoefficient(o.getDegree()),h),w=a.multiplyByMonomial(d,g),_=i.buildMonomial(d,g);c=c.addOrSubtract(_),o=o.addOrSubtract(w)}return[c,o]}toString(){let a="";for(let i=this.getDegree();i>=0;i--){let c=this.getCoefficient(i);if(c!==0){if(c<0?(a+=" - ",c=-c):a.length>0&&(a+=" + "),i===0||c!==1){const o=this.field.log(c);o===0?a+="1":o===1?a+="a":(a+="a^",a+=o)}i!==0&&(i===1?a+="x":(a+="x^",a+=i))}}return a}}class Z extends m{}Z.kind="ArithmeticException";class Ke extends Ae{constructor(a,i,c){super(),this.primitive=a,this.size=i,this.generatorBase=c;const o=new Int32Array(i);let l=1;for(let d=0;d<i;d++)o[d]=l,l*=2,l>=i&&(l^=a,l&=i-1);this.expTable=o;const h=new Int32Array(i);for(let d=0;d<i-1;d++)h[o[d]]=d;this.logTable=h,this.zero=new Xe(this,Int32Array.from([0])),this.one=new Xe(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(a,i){if(a<0)throw new E;if(i===0)return this.zero;const c=new Int32Array(a+1);return c[0]=i,new Xe(this,c)}inverse(a){if(a===0)throw new Z;return this.expTable[this.size-this.logTable[a]-1]}multiply(a,i){return a===0||i===0?0:this.expTable[(this.logTable[a]+this.logTable[i])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+D.toHexString(this.primitive)+","+this.size+")"}equals(a){return a===this}}Ke.AZTEC_DATA_12=new Ke(4201,4096,1),Ke.AZTEC_DATA_10=new Ke(1033,1024,1),Ke.AZTEC_DATA_6=new Ke(67,64,1),Ke.AZTEC_PARAM=new Ke(19,16,1),Ke.QR_CODE_FIELD_256=new Ke(285,256,0),Ke.DATA_MATRIX_FIELD_256=new Ke(301,256,1),Ke.AZTEC_DATA_8=Ke.DATA_MATRIX_FIELD_256,Ke.MAXICODE_FIELD_64=Ke.AZTEC_DATA_6;class xt extends m{}xt.kind="ReedSolomonException";class _t extends m{}_t.kind="IllegalStateException";class ct{constructor(a){this.field=a}decode(a,i){const c=this.field,o=new Xe(c,a),l=new Int32Array(i);let h=!0;for(let R=0;R<i;R++){const L=o.evaluateAt(c.exp(R+c.getGeneratorBase()));l[l.length-1-R]=L,L!==0&&(h=!1)}if(h)return;const d=new Xe(c,l),g=this.runEuclideanAlgorithm(c.buildMonomial(i,1),d,i),w=g[0],_=g[1],C=this.findErrorLocations(w),T=this.findErrorMagnitudes(_,C);for(let R=0;R<C.length;R++){const L=a.length-1-c.log(C[R]);if(L<0)throw new xt("Bad error location");a[L]=Ke.addOrSubtract(a[L],T[R])}}runEuclideanAlgorithm(a,i,c){if(a.getDegree()<i.getDegree()){const R=a;a=i,i=R}const o=this.field;let l=a,h=i,d=o.getZero(),g=o.getOne();for(;h.getDegree()>=(c/2|0);){let R=l,L=d;if(l=h,d=g,l.isZero())throw new xt("r_{i-1} was zero");h=R;let W=o.getZero();const te=l.getCoefficient(l.getDegree()),se=o.inverse(te);for(;h.getDegree()>=l.getDegree()&&!h.isZero();){const Ce=h.getDegree()-l.getDegree(),Te=o.multiply(h.getCoefficient(h.getDegree()),se);W=W.addOrSubtract(o.buildMonomial(Ce,Te)),h=h.addOrSubtract(l.multiplyByMonomial(Ce,Te))}if(g=W.multiply(d).addOrSubtract(L),h.getDegree()>=l.getDegree())throw new _t("Division algorithm failed to reduce polynomial?")}const w=g.getCoefficient(0);if(w===0)throw new xt("sigmaTilde(0) was zero");const _=o.inverse(w),C=g.multiplyScalar(_),T=h.multiplyScalar(_);return[C,T]}findErrorLocations(a){const i=a.getDegree();if(i===1)return Int32Array.from([a.getCoefficient(1)]);const c=new Int32Array(i);let o=0;const l=this.field;for(let h=1;h<l.getSize()&&o<i;h++)a.evaluateAt(h)===0&&(c[o]=l.inverse(h),o++);if(o!==i)throw new xt("Error locator degree does not match number of roots");return c}findErrorMagnitudes(a,i){const c=i.length,o=new Int32Array(c),l=this.field;for(let h=0;h<c;h++){const d=l.inverse(i[h]);let g=1;for(let w=0;w<c;w++)if(h!==w){const _=l.multiply(i[w],d),C=_&1?_&-2:_|1;g=l.multiply(g,C)}o[h]=l.multiply(a.evaluateAt(d),l.inverse(g)),l.getGeneratorBase()!==0&&(o[h]=l.multiply(o[h],d))}return o}}var Me;(function(I){I[I.UPPER=0]="UPPER",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.DIGIT=3]="DIGIT",I[I.PUNCT=4]="PUNCT",I[I.BINARY=5]="BINARY"})(Me||(Me={}));class tt{decode(a){this.ddata=a;let i=a.getBits(),c=this.extractBits(i),o=this.correctBits(c),l=tt.convertBoolArrayToByteArray(o),h=tt.getEncodedData(o),d=new ve(l,h,null,null);return d.setNumBits(o.length),d}static highLevelDecode(a){return this.getEncodedData(a)}static getEncodedData(a){let i=a.length,c=Me.UPPER,o=Me.UPPER,l="",h=0;for(;h<i;)if(o===Me.BINARY){if(i-h<5)break;let d=tt.readCode(a,h,5);if(h+=5,d===0){if(i-h<11)break;d=tt.readCode(a,h,11)+31,h+=11}for(let g=0;g<d;g++){if(i-h<8){h=i;break}const w=tt.readCode(a,h,8);l+=ee.castAsNonUtf8Char(w),h+=8}o=c}else{let d=o===Me.DIGIT?4:5;if(i-h<d)break;let g=tt.readCode(a,h,d);h+=d;let w=tt.getCharacter(o,g);w.startsWith("CTRL_")?(c=o,o=tt.getTable(w.charAt(5)),w.charAt(6)==="L"&&(c=o)):(l+=w,o=c)}return l}static getTable(a){switch(a){case"L":return Me.LOWER;case"P":return Me.PUNCT;case"M":return Me.MIXED;case"D":return Me.DIGIT;case"B":return Me.BINARY;case"U":default:return Me.UPPER}}static getCharacter(a,i){switch(a){case Me.UPPER:return tt.UPPER_TABLE[i];case Me.LOWER:return tt.LOWER_TABLE[i];case Me.MIXED:return tt.MIXED_TABLE[i];case Me.PUNCT:return tt.PUNCT_TABLE[i];case Me.DIGIT:return tt.DIGIT_TABLE[i];default:throw new _t("Bad table")}}correctBits(a){let i,c;this.ddata.getNbLayers()<=2?(c=6,i=Ke.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(c=8,i=Ke.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(c=10,i=Ke.AZTEC_DATA_10):(c=12,i=Ke.AZTEC_DATA_12);let o=this.ddata.getNbDatablocks(),l=a.length/c;if(l<o)throw new M;let h=a.length%c,d=new Int32Array(l);for(let T=0;T<l;T++,h+=c)d[T]=tt.readCode(a,h,c);try{new ct(i).decode(d,l-o)}catch(T){throw new M(T)}let g=(1<<c)-1,w=0;for(let T=0;T<o;T++){let R=d[T];if(R===0||R===g)throw new M;(R===1||R===g-1)&&w++}let _=new Array(o*c-w),C=0;for(let T=0;T<o;T++){let R=d[T];if(R===1||R===g-1)_.fill(R>1,C,C+c-1),C+=c-1;else for(let L=c-1;L>=0;--L)_[C++]=(R&1<<L)!==0}return _}extractBits(a){let i=this.ddata.isCompact(),c=this.ddata.getNbLayers(),o=(i?11:14)+c*4,l=new Int32Array(o),h=new Array(this.totalBitsInLayer(c,i));if(i)for(let d=0;d<l.length;d++)l[d]=d;else{let d=o+1+2*D.truncDivision(D.truncDivision(o,2)-1,15),g=o/2,w=D.truncDivision(d,2);for(let _=0;_<g;_++){let C=_+D.truncDivision(_,15);l[g-_-1]=w-C-1,l[g+_]=w+C+1}}for(let d=0,g=0;d<c;d++){let w=(c-d)*4+(i?9:12),_=d*2,C=o-1-_;for(let T=0;T<w;T++){let R=T*2;for(let L=0;L<2;L++)h[g+R+L]=a.get(l[_+L],l[_+T]),h[g+2*w+R+L]=a.get(l[_+T],l[C-L]),h[g+4*w+R+L]=a.get(l[C-L],l[C-T]),h[g+6*w+R+L]=a.get(l[C-T],l[_+L])}g+=w*8}return h}static readCode(a,i,c){let o=0;for(let l=i;l<i+c;l++)o<<=1,a[l]&&(o|=1);return o}static readByte(a,i){let c=a.length-i;return c>=8?tt.readCode(a,i,8):tt.readCode(a,i,c)<<8-c}static convertBoolArrayToByteArray(a){let i=new Uint8Array((a.length+7)/8);for(let c=0;c<i.length;c++)i[c]=tt.readByte(a,8*c);return i}totalBitsInLayer(a,i){return((i?88:112)+16*a)*a}}tt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],tt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],tt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],tt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],tt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class nt{constructor(){}static round(a){return a===NaN?0:a<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:a>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:a+(a<0?-.5:.5)|0}static distance(a,i,c,o){const l=a-c,h=i-o;return Math.sqrt(l*l+h*h)}static sum(a){let i=0;for(let c=0,o=a.length;c!==o;c++){const l=a[c];i+=l}return i}}class $r{static floatToIntBits(a){return a}}$r.MAX_VALUE=Number.MAX_SAFE_INTEGER;class We{constructor(a,i){this.x=a,this.y=i}getX(){return this.x}getY(){return this.y}equals(a){if(a instanceof We){const i=a;return this.x===i.x&&this.y===i.y}return!1}hashCode(){return 31*$r.floatToIntBits(this.x)+$r.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(a){const i=this.distance(a[0],a[1]),c=this.distance(a[1],a[2]),o=this.distance(a[0],a[2]);let l,h,d;if(c>=i&&c>=o?(h=a[0],l=a[1],d=a[2]):o>=c&&o>=i?(h=a[1],l=a[0],d=a[2]):(h=a[2],l=a[0],d=a[1]),this.crossProductZ(l,h,d)<0){const g=l;l=d,d=g}a[0]=l,a[1]=h,a[2]=d}static distance(a,i){return nt.distance(a.x,a.y,i.x,i.y)}static crossProductZ(a,i,c){const o=i.x,l=i.y;return(c.x-o)*(a.y-l)-(c.y-l)*(a.x-o)}}class br{constructor(a,i){this.bits=a,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class Br extends br{constructor(a,i,c,o,l){super(a,i),this.compact=c,this.nbDatablocks=o,this.nbLayers=l}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Zt{constructor(a,i,c,o){this.image=a,this.height=a.getHeight(),this.width=a.getWidth(),i==null&&(i=Zt.INIT_SIZE),c==null&&(c=a.getWidth()/2|0),o==null&&(o=a.getHeight()/2|0);const l=i/2|0;if(this.leftInit=c-l,this.rightInit=c+l,this.upInit=o-l,this.downInit=o+l,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new re}detect(){let a=this.leftInit,i=this.rightInit,c=this.upInit,o=this.downInit,l=!1,h=!0,d=!1,g=!1,w=!1,_=!1,C=!1;const T=this.width,R=this.height;for(;h;){h=!1;let L=!0;for(;(L||!g)&&i<T;)L=this.containsBlackPoint(c,o,i,!1),L?(i++,h=!0,g=!0):g||i++;if(i>=T){l=!0;break}let W=!0;for(;(W||!w)&&o<R;)W=this.containsBlackPoint(a,i,o,!0),W?(o++,h=!0,w=!0):w||o++;if(o>=R){l=!0;break}let te=!0;for(;(te||!_)&&a>=0;)te=this.containsBlackPoint(c,o,a,!1),te?(a--,h=!0,_=!0):_||a--;if(a<0){l=!0;break}let se=!0;for(;(se||!C)&&c>=0;)se=this.containsBlackPoint(a,i,c,!0),se?(c--,h=!0,C=!0):C||c--;if(c<0){l=!0;break}h&&(d=!0)}if(!l&&d){const L=i-a;let W=null;for(let Te=1;W===null&&Te<L;Te++)W=this.getBlackPointOnSegment(a,o-Te,a+Te,o);if(W==null)throw new re;let te=null;for(let Te=1;te===null&&Te<L;Te++)te=this.getBlackPointOnSegment(a,c+Te,a+Te,c);if(te==null)throw new re;let se=null;for(let Te=1;se===null&&Te<L;Te++)se=this.getBlackPointOnSegment(i,c+Te,i-Te,c);if(se==null)throw new re;let Ce=null;for(let Te=1;Ce===null&&Te<L;Te++)Ce=this.getBlackPointOnSegment(i,o-Te,i-Te,o);if(Ce==null)throw new re;return this.centerEdges(Ce,W,se,te)}else throw new re}getBlackPointOnSegment(a,i,c,o){const l=nt.round(nt.distance(a,i,c,o)),h=(c-a)/l,d=(o-i)/l,g=this.image;for(let w=0;w<l;w++){const _=nt.round(a+w*h),C=nt.round(i+w*d);if(g.get(_,C))return new We(_,C)}return null}centerEdges(a,i,c,o){const l=a.getX(),h=a.getY(),d=i.getX(),g=i.getY(),w=c.getX(),_=c.getY(),C=o.getX(),T=o.getY(),R=Zt.CORR;return l<this.width/2?[new We(C-R,T+R),new We(d+R,g+R),new We(w-R,_-R),new We(l+R,h-R)]:[new We(C+R,T+R),new We(d+R,g-R),new We(w-R,_+R),new We(l-R,h-R)]}containsBlackPoint(a,i,c,o){const l=this.image;if(o){for(let h=a;h<=i;h++)if(l.get(h,c))return!0}else for(let h=a;h<=i;h++)if(l.get(c,h))return!0;return!1}}Zt.INIT_SIZE=10,Zt.CORR=1;class zr{static checkAndNudgePoints(a,i){const c=a.getWidth(),o=a.getHeight();let l=!0;for(let h=0;h<i.length&&l;h+=2){const d=Math.floor(i[h]),g=Math.floor(i[h+1]);if(d<-1||d>c||g<-1||g>o)throw new re;l=!1,d===-1?(i[h]=0,l=!0):d===c&&(i[h]=c-1,l=!0),g===-1?(i[h+1]=0,l=!0):g===o&&(i[h+1]=o-1,l=!0)}l=!0;for(let h=i.length-2;h>=0&&l;h-=2){const d=Math.floor(i[h]),g=Math.floor(i[h+1]);if(d<-1||d>c||g<-1||g>o)throw new re;l=!1,d===-1?(i[h]=0,l=!0):d===c&&(i[h]=c-1,l=!0),g===-1?(i[h+1]=0,l=!0):g===o&&(i[h+1]=o-1,l=!0)}}}class xr{constructor(a,i,c,o,l,h,d,g,w){this.a11=a,this.a21=i,this.a31=c,this.a12=o,this.a22=l,this.a32=h,this.a13=d,this.a23=g,this.a33=w}static quadrilateralToQuadrilateral(a,i,c,o,l,h,d,g,w,_,C,T,R,L,W,te){const se=xr.quadrilateralToSquare(a,i,c,o,l,h,d,g);return xr.squareToQuadrilateral(w,_,C,T,R,L,W,te).times(se)}transformPoints(a){const i=a.length,c=this.a11,o=this.a12,l=this.a13,h=this.a21,d=this.a22,g=this.a23,w=this.a31,_=this.a32,C=this.a33;for(let T=0;T<i;T+=2){const R=a[T],L=a[T+1],W=l*R+g*L+C;a[T]=(c*R+h*L+w)/W,a[T+1]=(o*R+d*L+_)/W}}transformPointsWithValues(a,i){const c=this.a11,o=this.a12,l=this.a13,h=this.a21,d=this.a22,g=this.a23,w=this.a31,_=this.a32,C=this.a33,T=a.length;for(let R=0;R<T;R++){const L=a[R],W=i[R],te=l*L+g*W+C;a[R]=(c*L+h*W+w)/te,i[R]=(o*L+d*W+_)/te}}static squareToQuadrilateral(a,i,c,o,l,h,d,g){const w=a-c+l-d,_=i-o+h-g;if(w===0&&_===0)return new xr(c-a,l-c,a,o-i,h-o,i,0,0,1);{const C=c-l,T=d-l,R=o-h,L=g-h,W=C*L-T*R,te=(w*L-T*_)/W,se=(C*_-w*R)/W;return new xr(c-a+te*c,d-a+se*d,a,o-i+te*o,g-i+se*g,i,te,se,1)}}static quadrilateralToSquare(a,i,c,o,l,h,d,g){return xr.squareToQuadrilateral(a,i,c,o,l,h,d,g).buildAdjoint()}buildAdjoint(){return new xr(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(a){return new xr(this.a11*a.a11+this.a21*a.a12+this.a31*a.a13,this.a11*a.a21+this.a21*a.a22+this.a31*a.a23,this.a11*a.a31+this.a21*a.a32+this.a31*a.a33,this.a12*a.a11+this.a22*a.a12+this.a32*a.a13,this.a12*a.a21+this.a22*a.a22+this.a32*a.a23,this.a12*a.a31+this.a22*a.a32+this.a32*a.a33,this.a13*a.a11+this.a23*a.a12+this.a33*a.a13,this.a13*a.a21+this.a23*a.a22+this.a33*a.a23,this.a13*a.a31+this.a23*a.a32+this.a33*a.a33)}}class cn extends zr{sampleGrid(a,i,c,o,l,h,d,g,w,_,C,T,R,L,W,te,se,Ce,Te){const ce=xr.quadrilateralToQuadrilateral(o,l,h,d,g,w,_,C,T,R,L,W,te,se,Ce,Te);return this.sampleGridWithTransform(a,i,c,ce)}sampleGridWithTransform(a,i,c,o){if(i<=0||c<=0)throw new re;const l=new Pe(i,c),h=new Float32Array(2*i);for(let d=0;d<c;d++){const g=h.length,w=d+.5;for(let _=0;_<g;_+=2)h[_]=_/2+.5,h[_+1]=w;o.transformPoints(h),zr.checkAndNudgePoints(a,h);try{for(let _=0;_<g;_+=2)a.get(Math.floor(h[_]),Math.floor(h[_+1]))&&l.set(_/2,d)}catch{throw new re}}return l}}class Jt{static setGridSampler(a){Jt.gridSampler=a}static getInstance(){return Jt.gridSampler}}Jt.gridSampler=new cn;class zt{constructor(a,i){this.x=a,this.y=i}toResultPoint(){return new We(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class lt{constructor(a){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=a}detect(){return this.detectMirror(!1)}detectMirror(a){let i=this.getMatrixCenter(),c=this.getBullsEyeCorners(i);if(a){let h=c[0];c[0]=c[2],c[2]=h}this.extractParameters(c);let o=this.sampleGrid(this.image,c[this.shift%4],c[(this.shift+1)%4],c[(this.shift+2)%4],c[(this.shift+3)%4]),l=this.getMatrixCornerPoints(c);return new Br(o,l,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(a){if(!this.isValidPoint(a[0])||!this.isValidPoint(a[1])||!this.isValidPoint(a[2])||!this.isValidPoint(a[3]))throw new re;let i=2*this.nbCenterLayers,c=new Int32Array([this.sampleLine(a[0],a[1],i),this.sampleLine(a[1],a[2],i),this.sampleLine(a[2],a[3],i),this.sampleLine(a[3],a[0],i)]);this.shift=this.getRotation(c,i);let o=0;for(let h=0;h<4;h++){let d=c[(this.shift+h)%4];this.compact?(o<<=7,o+=d>>1&127):(o<<=10,o+=(d>>2&992)+(d>>1&31))}let l=this.getCorrectedParameterData(o,this.compact);this.compact?(this.nbLayers=(l>>6)+1,this.nbDataBlocks=(l&63)+1):(this.nbLayers=(l>>11)+1,this.nbDataBlocks=(l&2047)+1)}getRotation(a,i){let c=0;a.forEach((o,l,h)=>{let d=(o>>i-2<<1)+(o&1);c=(c<<3)+d}),c=((c&1)<<11)+(c>>1);for(let o=0;o<4;o++)if(D.bitCount(c^this.EXPECTED_CORNER_BITS[o])<=2)return o;throw new re}getCorrectedParameterData(a,i){let c,o;i?(c=7,o=2):(c=10,o=4);let l=c-o,h=new Int32Array(c);for(let g=c-1;g>=0;--g)h[g]=a&15,a>>=4;try{new ct(Ke.AZTEC_PARAM).decode(h,l)}catch{throw new re}let d=0;for(let g=0;g<o;g++)d=(d<<4)+h[g];return d}getBullsEyeCorners(a){let i=a,c=a,o=a,l=a,h=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let C=this.getFirstDifferent(i,h,1,-1),T=this.getFirstDifferent(c,h,1,1),R=this.getFirstDifferent(o,h,-1,1),L=this.getFirstDifferent(l,h,-1,-1);if(this.nbCenterLayers>2){let W=this.distancePoint(L,C)*this.nbCenterLayers/(this.distancePoint(l,i)*(this.nbCenterLayers+2));if(W<.75||W>1.25||!this.isWhiteOrBlackRectangle(C,T,R,L))break}i=C,c=T,o=R,l=L,h=!h}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new re;this.compact=this.nbCenterLayers===5;let d=new We(i.getX()+.5,i.getY()-.5),g=new We(c.getX()+.5,c.getY()+.5),w=new We(o.getX()-.5,o.getY()+.5),_=new We(l.getX()-.5,l.getY()-.5);return this.expandSquare([d,g,w,_],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let a,i,c,o;try{let d=new Zt(this.image).detect();a=d[0],i=d[1],c=d[2],o=d[3]}catch{let g=this.image.getWidth()/2,w=this.image.getHeight()/2;a=this.getFirstDifferent(new zt(g+7,w-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new zt(g+7,w+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new zt(g-7,w+7),!1,-1,1).toResultPoint(),o=this.getFirstDifferent(new zt(g-7,w-7),!1,-1,-1).toResultPoint()}let l=nt.round((a.getX()+o.getX()+i.getX()+c.getX())/4),h=nt.round((a.getY()+o.getY()+i.getY()+c.getY())/4);try{let d=new Zt(this.image,15,l,h).detect();a=d[0],i=d[1],c=d[2],o=d[3]}catch{a=this.getFirstDifferent(new zt(l+7,h-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new zt(l+7,h+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new zt(l-7,h+7),!1,-1,1).toResultPoint(),o=this.getFirstDifferent(new zt(l-7,h-7),!1,-1,-1).toResultPoint()}return l=nt.round((a.getX()+o.getX()+i.getX()+c.getX())/4),h=nt.round((a.getY()+o.getY()+i.getY()+c.getY())/4),new zt(l,h)}getMatrixCornerPoints(a){return this.expandSquare(a,2*this.nbCenterLayers,this.getDimension())}sampleGrid(a,i,c,o,l){let h=Jt.getInstance(),d=this.getDimension(),g=d/2-this.nbCenterLayers,w=d/2+this.nbCenterLayers;return h.sampleGrid(a,d,d,g,g,w,g,w,w,g,w,i.getX(),i.getY(),c.getX(),c.getY(),o.getX(),o.getY(),l.getX(),l.getY())}sampleLine(a,i,c){let o=0,l=this.distanceResultPoint(a,i),h=l/c,d=a.getX(),g=a.getY(),w=h*(i.getX()-a.getX())/l,_=h*(i.getY()-a.getY())/l;for(let C=0;C<c;C++)this.image.get(nt.round(d+C*w),nt.round(g+C*_))&&(o|=1<<c-C-1);return o}isWhiteOrBlackRectangle(a,i,c,o){let l=3;a=new zt(a.getX()-l,a.getY()+l),i=new zt(i.getX()-l,i.getY()-l),c=new zt(c.getX()+l,c.getY()-l),o=new zt(o.getX()+l,o.getY()+l);let h=this.getColor(o,a);if(h===0)return!1;let d=this.getColor(a,i);return d!==h||(d=this.getColor(i,c),d!==h)?!1:(d=this.getColor(c,o),d===h)}getColor(a,i){let c=this.distancePoint(a,i),o=(i.getX()-a.getX())/c,l=(i.getY()-a.getY())/c,h=0,d=a.getX(),g=a.getY(),w=this.image.get(a.getX(),a.getY()),_=Math.ceil(c);for(let T=0;T<_;T++)d+=o,g+=l,this.image.get(nt.round(d),nt.round(g))!==w&&h++;let C=h/c;return C>.1&&C<.9?0:C<=.1===w?1:-1}getFirstDifferent(a,i,c,o){let l=a.getX()+c,h=a.getY()+o;for(;this.isValid(l,h)&&this.image.get(l,h)===i;)l+=c,h+=o;for(l-=c,h-=o;this.isValid(l,h)&&this.image.get(l,h)===i;)l+=c;for(l-=c;this.isValid(l,h)&&this.image.get(l,h)===i;)h+=o;return h-=o,new zt(l,h)}expandSquare(a,i,c){let o=c/(2*i),l=a[0].getX()-a[2].getX(),h=a[0].getY()-a[2].getY(),d=(a[0].getX()+a[2].getX())/2,g=(a[0].getY()+a[2].getY())/2,w=new We(d+o*l,g+o*h),_=new We(d-o*l,g-o*h);l=a[1].getX()-a[3].getX(),h=a[1].getY()-a[3].getY(),d=(a[1].getX()+a[3].getX())/2,g=(a[1].getY()+a[3].getY())/2;let C=new We(d+o*l,g+o*h),T=new We(d-o*l,g-o*h);return[w,C,_,T]}isValid(a,i){return a>=0&&a<this.image.getWidth()&&i>0&&i<this.image.getHeight()}isValidPoint(a){let i=nt.round(a.getX()),c=nt.round(a.getY());return this.isValid(i,c)}distancePoint(a,i){return nt.distance(a.getX(),a.getY(),i.getX(),i.getY())}distanceResultPoint(a,i){return nt.distance(a.getX(),a.getY(),i.getX(),i.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(D.truncDivision(this.nbLayers-4,8)+1)+15}}class Yt{decode(a,i=null){let c=null,o=new lt(a.getBlackMatrix()),l=null,h=null;try{let _=o.detectMirror(!1);l=_.getPoints(),this.reportFoundResultPoints(i,l),h=new tt().decode(_)}catch(_){c=_}if(h==null)try{let _=o.detectMirror(!0);l=_.getPoints(),this.reportFoundResultPoints(i,l),h=new tt().decode(_)}catch(_){throw c??_}let d=new z(h.getText(),h.getRawBytes(),h.getNumBits(),l,B.AZTEC,A.currentTimeMillis()),g=h.getByteSegments();g!=null&&d.putMetadata(we.BYTE_SEGMENTS,g);let w=h.getECLevel();return w!=null&&d.putMetadata(we.ERROR_CORRECTION_LEVEL,w),d}reportFoundResultPoints(a,i){if(a!=null){let c=a.get(Q.NEED_RESULT_POINT_CALLBACK);c!=null&&i.forEach((o,l,h)=>{c.foundPossibleResultPoint(o)})}}reset(){}}class kr extends ae{constructor(a=500){super(new Yt,a)}}class ft{decode(a,i){try{return this.doDecode(a,i)}catch{if(i&&i.get(Q.TRY_HARDER)===!0&&a.isRotateSupported()){const l=a.rotateCounterClockwise(),h=this.doDecode(l,i),d=h.getResultMetadata();let g=270;d!==null&&d.get(we.ORIENTATION)===!0&&(g=g+d.get(we.ORIENTATION)%360),h.putMetadata(we.ORIENTATION,g);const w=h.getResultPoints();if(w!==null){const _=l.getHeight();for(let C=0;C<w.length;C++)w[C]=new We(_-w[C].getY()-1,w[C].getX())}return h}else throw new re}}reset(){}doDecode(a,i){const c=a.getWidth(),o=a.getHeight();let l=new J(c);const h=i&&i.get(Q.TRY_HARDER)===!0,d=Math.max(1,o>>(h?8:5));let g;h?g=o:g=15;const w=Math.trunc(o/2);for(let _=0;_<g;_++){const C=Math.trunc((_+1)/2),T=(_&1)===0,R=w+d*(T?C:-C);if(R<0||R>=o)break;try{l=a.getBlackRow(R,l)}catch{continue}for(let L=0;L<2;L++){if(L===1&&(l.reverse(),i&&i.get(Q.NEED_RESULT_POINT_CALLBACK)===!0)){const W=new Map;i.forEach((te,se)=>W.set(se,te)),W.delete(Q.NEED_RESULT_POINT_CALLBACK),i=W}try{const W=this.decodeRow(R,l,i);if(L===1){W.putMetadata(we.ORIENTATION,180);const te=W.getResultPoints();te!==null&&(te[0]=new We(c-te[0].getX()-1,te[0].getY()),te[1]=new We(c-te[1].getX()-1,te[1].getY()))}return W}catch{}}}throw new re}static recordPattern(a,i,c){const o=c.length;for(let w=0;w<o;w++)c[w]=0;const l=a.getSize();if(i>=l)throw new re;let h=!a.get(i),d=0,g=i;for(;g<l;){if(a.get(g)!==h)c[d]++;else{if(++d===o)break;c[d]=1,h=!h}g++}if(!(d===o||d===o-1&&g===l))throw new re}static recordPatternInReverse(a,i,c){let o=c.length,l=a.get(i);for(;i>0&&o>=0;)a.get(--i)!==l&&(o--,l=!l);if(o>=0)throw new re;ft.recordPattern(a,i+1,c)}static patternMatchVariance(a,i,c){const o=a.length;let l=0,h=0;for(let w=0;w<o;w++)l+=a[w],h+=i[w];if(l<h)return Number.POSITIVE_INFINITY;const d=l/h;c*=d;let g=0;for(let w=0;w<o;w++){const _=a[w],C=i[w]*d,T=_>C?_-C:C-_;if(T>c)return Number.POSITIVE_INFINITY;g+=T}return g/l}}class De extends ft{static findStartPattern(a){const i=a.getSize(),c=a.getNextSet(0);let o=0,l=Int32Array.from([0,0,0,0,0,0]),h=c,d=!1;const g=6;for(let w=c;w<i;w++)if(a.get(w)!==d)l[o]++;else{if(o===g-1){let _=De.MAX_AVG_VARIANCE,C=-1;for(let T=De.CODE_START_A;T<=De.CODE_START_C;T++){const R=ft.patternMatchVariance(l,De.CODE_PATTERNS[T],De.MAX_INDIVIDUAL_VARIANCE);R<_&&(_=R,C=T)}if(C>=0&&a.isRange(Math.max(0,h-(w-h)/2),h,!1))return Int32Array.from([h,w,C]);h+=l[0]+l[1],l=l.slice(2,l.length-1),l[o-1]=0,l[o]=0,o--}else o++;l[o]=1,d=!d}throw new re}static decodeCode(a,i,c){ft.recordPattern(a,c,i);let o=De.MAX_AVG_VARIANCE,l=-1;for(let h=0;h<De.CODE_PATTERNS.length;h++){const d=De.CODE_PATTERNS[h],g=this.patternMatchVariance(i,d,De.MAX_INDIVIDUAL_VARIANCE);g<o&&(o=g,l=h)}if(l>=0)return l;throw new re}decodeRow(a,i,c){const o=c&&c.get(Q.ASSUME_GS1)===!0,l=De.findStartPattern(i),h=l[2];let d=0;const g=new Uint8Array(20);g[d++]=h;let w;switch(h){case De.CODE_START_A:w=De.CODE_CODE_A;break;case De.CODE_START_B:w=De.CODE_CODE_B;break;case De.CODE_START_C:w=De.CODE_CODE_C;break;default:throw new M}let _=!1,C=!1,T="",R=l[0],L=l[1];const W=Int32Array.from([0,0,0,0,0,0]);let te=0,se=0,Ce=h,Te=0,ce=!0,Ve=!1,ze=!1;for(;!_;){const kn=C;switch(C=!1,te=se,se=De.decodeCode(i,W,L),g[d++]=se,se!==De.CODE_STOP&&(ce=!0),se!==De.CODE_STOP&&(Te++,Ce+=Te*se),R=L,L+=W.reduce((S0,N0)=>S0+N0,0),se){case De.CODE_START_A:case De.CODE_START_B:case De.CODE_START_C:throw new M}switch(w){case De.CODE_CODE_A:if(se<64)ze===Ve?T+=String.fromCharCode(32+se):T+=String.fromCharCode(32+se+128),ze=!1;else if(se<96)ze===Ve?T+=String.fromCharCode(se-64):T+=String.fromCharCode(se+64),ze=!1;else switch(se!==De.CODE_STOP&&(ce=!1),se){case De.CODE_FNC_1:o&&(T.length===0?T+="]C1":T+="");break;case De.CODE_FNC_2:case De.CODE_FNC_3:break;case De.CODE_FNC_4_A:!Ve&&ze?(Ve=!0,ze=!1):Ve&&ze?(Ve=!1,ze=!1):ze=!0;break;case De.CODE_SHIFT:C=!0,w=De.CODE_CODE_B;break;case De.CODE_CODE_B:w=De.CODE_CODE_B;break;case De.CODE_CODE_C:w=De.CODE_CODE_C;break;case De.CODE_STOP:_=!0;break}break;case De.CODE_CODE_B:if(se<96)ze===Ve?T+=String.fromCharCode(32+se):T+=String.fromCharCode(32+se+128),ze=!1;else switch(se!==De.CODE_STOP&&(ce=!1),se){case De.CODE_FNC_1:o&&(T.length===0?T+="]C1":T+="");break;case De.CODE_FNC_2:case De.CODE_FNC_3:break;case De.CODE_FNC_4_B:!Ve&&ze?(Ve=!0,ze=!1):Ve&&ze?(Ve=!1,ze=!1):ze=!0;break;case De.CODE_SHIFT:C=!0,w=De.CODE_CODE_A;break;case De.CODE_CODE_A:w=De.CODE_CODE_A;break;case De.CODE_CODE_C:w=De.CODE_CODE_C;break;case De.CODE_STOP:_=!0;break}break;case De.CODE_CODE_C:if(se<100)se<10&&(T+="0"),T+=se;else switch(se!==De.CODE_STOP&&(ce=!1),se){case De.CODE_FNC_1:o&&(T.length===0?T+="]C1":T+="");break;case De.CODE_CODE_A:w=De.CODE_CODE_A;break;case De.CODE_CODE_B:w=De.CODE_CODE_B;break;case De.CODE_STOP:_=!0;break}break}kn&&(w=w===De.CODE_CODE_A?De.CODE_CODE_B:De.CODE_CODE_A)}const kt=L-R;if(L=i.getNextUnset(L),!i.isRange(L,Math.min(i.getSize(),L+(L-R)/2),!1))throw new re;if(Ce-=Te*te,Ce%103!==te)throw new S;const Ot=T.length;if(Ot===0)throw new re;Ot>0&&ce&&(w===De.CODE_CODE_C?T=T.substring(0,Ot-2):T=T.substring(0,Ot-1));const It=(l[1]+l[0])/2,bt=R+kt/2,er=g.length,Or=new Uint8Array(er);for(let kn=0;kn<er;kn++)Or[kn]=g[kn];const Kn=[new We(It,a),new We(bt,a)];return new z(T,Or,0,Kn,B.CODE_128,new Date().getTime())}}De.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],De.MAX_AVG_VARIANCE=.25,De.MAX_INDIVIDUAL_VARIANCE=.7,De.CODE_SHIFT=98,De.CODE_CODE_C=99,De.CODE_CODE_B=100,De.CODE_CODE_A=101,De.CODE_FNC_1=102,De.CODE_FNC_2=97,De.CODE_FNC_3=96,De.CODE_FNC_4_A=101,De.CODE_FNC_4_B=100,De.CODE_START_A=103,De.CODE_START_B=104,De.CODE_START_C=105,De.CODE_STOP=106;class tr extends ft{constructor(a=!1,i=!1){super(),this.usingCheckDigit=a,this.extendedMode=i,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(a,i,c){let o=this.counters;o.fill(0),this.decodeRowResult="";let l=tr.findAsteriskPattern(i,o),h=i.getNextSet(l[1]),d=i.getSize(),g,w;do{tr.recordPattern(i,h,o);let W=tr.toNarrowWidePattern(o);if(W<0)throw new re;g=tr.patternToChar(W),this.decodeRowResult+=g,w=h;for(let te of o)h+=te;h=i.getNextSet(h)}while(g!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let _=0;for(let W of o)_+=W;let C=h-w-_;if(h!==d&&C*2<_)throw new re;if(this.usingCheckDigit){let W=this.decodeRowResult.length-1,te=0;for(let se=0;se<W;se++)te+=tr.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(se));if(this.decodeRowResult.charAt(W)!==tr.ALPHABET_STRING.charAt(te%43))throw new S;this.decodeRowResult=this.decodeRowResult.substring(0,W)}if(this.decodeRowResult.length===0)throw new re;let T;this.extendedMode?T=tr.decodeExtended(this.decodeRowResult):T=this.decodeRowResult;let R=(l[1]+l[0])/2,L=w+_/2;return new z(T,null,0,[new We(R,a),new We(L,a)],B.CODE_39,new Date().getTime())}static findAsteriskPattern(a,i){let c=a.getSize(),o=a.getNextSet(0),l=0,h=o,d=!1,g=i.length;for(let w=o;w<c;w++)if(a.get(w)!==d)i[l]++;else{if(l===g-1){if(this.toNarrowWidePattern(i)===tr.ASTERISK_ENCODING&&a.isRange(Math.max(0,h-Math.floor((w-h)/2)),h,!1))return[h,w];h+=i[0]+i[1],i.copyWithin(0,2,2+l-1),i[l-1]=0,i[l]=0,l--}else l++;i[l]=1,d=!d}throw new re}static toNarrowWidePattern(a){let i=a.length,c=0,o;do{let l=2147483647;for(let g of a)g<l&&g>c&&(l=g);c=l,o=0;let h=0,d=0;for(let g=0;g<i;g++){let w=a[g];w>c&&(d|=1<<i-1-g,o++,h+=w)}if(o===3){for(let g=0;g<i&&o>0;g++){let w=a[g];if(w>c&&(o--,w*2>=h))return-1}return d}}while(o>3);return-1}static patternToChar(a){for(let i=0;i<tr.CHARACTER_ENCODINGS.length;i++)if(tr.CHARACTER_ENCODINGS[i]===a)return tr.ALPHABET_STRING.charAt(i);if(a===tr.ASTERISK_ENCODING)return"*";throw new re}static decodeExtended(a){let i=a.length,c="";for(let o=0;o<i;o++){let l=a.charAt(o);if(l==="+"||l==="$"||l==="%"||l==="/"){let h=a.charAt(o+1),d="\0";switch(l){case"+":if(h>="A"&&h<="Z")d=String.fromCharCode(h.charCodeAt(0)+32);else throw new M;break;case"$":if(h>="A"&&h<="Z")d=String.fromCharCode(h.charCodeAt(0)-64);else throw new M;break;case"%":if(h>="A"&&h<="E")d=String.fromCharCode(h.charCodeAt(0)-38);else if(h>="F"&&h<="J")d=String.fromCharCode(h.charCodeAt(0)-11);else if(h>="K"&&h<="O")d=String.fromCharCode(h.charCodeAt(0)+16);else if(h>="P"&&h<="T")d=String.fromCharCode(h.charCodeAt(0)+43);else if(h==="U")d="\0";else if(h==="V")d="@";else if(h==="W")d="`";else if(h==="X"||h==="Y"||h==="Z")d="";else throw new M;break;case"/":if(h>="A"&&h<="O")d=String.fromCharCode(h.charCodeAt(0)-32);else if(h==="Z")d=":";else throw new M;break}c+=d,o++}else c+=l}return c}}tr.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",tr.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],tr.ASTERISK_ENCODING=148;class Nt extends ft{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(a,i,c){let o=this.decodeStart(i),l=this.decodeEnd(i),h=new pe;Nt.decodeMiddle(i,o[1],l[0],h);let d=h.toString(),g=null;c!=null&&(g=c.get(Q.ALLOWED_LENGTHS)),g==null&&(g=Nt.DEFAULT_ALLOWED_LENGTHS);let w=d.length,_=!1,C=0;for(let L of g){if(w===L){_=!0;break}L>C&&(C=L)}if(!_&&w>C&&(_=!0),!_)throw new M;const T=[new We(o[1],a),new We(l[0],a)];return new z(d,null,0,T,B.ITF,new Date().getTime())}static decodeMiddle(a,i,c,o){let l=new Int32Array(10),h=new Int32Array(5),d=new Int32Array(5);for(l.fill(0),h.fill(0),d.fill(0);i<c;){ft.recordPattern(a,i,l);for(let w=0;w<5;w++){let _=2*w;h[w]=l[_],d[w]=l[_+1]}let g=Nt.decodeDigit(h);o.append(g.toString()),g=this.decodeDigit(d),o.append(g.toString()),l.forEach(function(w){i+=w})}}decodeStart(a){let i=Nt.skipWhiteSpace(a),c=Nt.findGuardPattern(a,i,Nt.START_PATTERN);return this.narrowLineWidth=(c[1]-c[0])/4,this.validateQuietZone(a,c[0]),c}validateQuietZone(a,i){let c=this.narrowLineWidth*10;c=c<i?c:i;for(let o=i-1;c>0&&o>=0&&!a.get(o);o--)c--;if(c!==0)throw new re}static skipWhiteSpace(a){const i=a.getSize(),c=a.getNextSet(0);if(c===i)throw new re;return c}decodeEnd(a){a.reverse();try{let i=Nt.skipWhiteSpace(a),c;try{c=Nt.findGuardPattern(a,i,Nt.END_PATTERN_REVERSED[0])}catch(l){l instanceof re&&(c=Nt.findGuardPattern(a,i,Nt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(a,c[0]);let o=c[0];return c[0]=a.getSize()-c[1],c[1]=a.getSize()-o,c}finally{a.reverse()}}static findGuardPattern(a,i,c){let o=c.length,l=new Int32Array(o),h=a.getSize(),d=!1,g=0,w=i;l.fill(0);for(let _=i;_<h;_++)if(a.get(_)!==d)l[g]++;else{if(g===o-1){if(ft.patternMatchVariance(l,c,Nt.MAX_INDIVIDUAL_VARIANCE)<Nt.MAX_AVG_VARIANCE)return[w,_];w+=l[0]+l[1],A.arraycopy(l,2,l,0,g-1),l[g-1]=0,l[g]=0,g--}else g++;l[g]=1,d=!d}throw new re}static decodeDigit(a){let i=Nt.MAX_AVG_VARIANCE,c=-1,o=Nt.PATTERNS.length;for(let l=0;l<o;l++){let h=Nt.PATTERNS[l],d=ft.patternMatchVariance(a,h,Nt.MAX_INDIVIDUAL_VARIANCE);d<i?(i=d,c=l):d===i&&(c=-1)}if(c>=0)return c%10;throw new re}}Nt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Nt.MAX_AVG_VARIANCE=.38,Nt.MAX_INDIVIDUAL_VARIANCE=.5,Nt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Nt.START_PATTERN=Int32Array.from([1,1,1,1]),Nt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Qt extends ft{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(a){let i=!1,c,o=0,l=Int32Array.from([0,0,0]);for(;!i;){l=Int32Array.from([0,0,0]),c=Qt.findGuardPattern(a,o,!1,this.START_END_PATTERN,l);let h=c[0];o=c[1];let d=h-(o-h);d>=0&&(i=a.isRange(d,h,!1))}return c}static checkChecksum(a){return Qt.checkStandardUPCEANChecksum(a)}static checkStandardUPCEANChecksum(a){let i=a.length;if(i===0)return!1;let c=parseInt(a.charAt(i-1),10);return Qt.getStandardUPCEANChecksum(a.substring(0,i-1))===c}static getStandardUPCEANChecksum(a){let i=a.length,c=0;for(let o=i-1;o>=0;o-=2){let l=a.charAt(o).charCodeAt(0)-48;if(l<0||l>9)throw new M;c+=l}c*=3;for(let o=i-2;o>=0;o-=2){let l=a.charAt(o).charCodeAt(0)-48;if(l<0||l>9)throw new M;c+=l}return(1e3-c)%10}static decodeEnd(a,i){return Qt.findGuardPattern(a,i,!1,Qt.START_END_PATTERN,new Int32Array(Qt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(a,i,c,o){return this.findGuardPattern(a,i,c,o,new Int32Array(o.length))}static findGuardPattern(a,i,c,o,l){let h=a.getSize();i=c?a.getNextUnset(i):a.getNextSet(i);let d=0,g=i,w=o.length,_=c;for(let C=i;C<h;C++)if(a.get(C)!==_)l[d]++;else{if(d===w-1){if(ft.patternMatchVariance(l,o,Qt.MAX_INDIVIDUAL_VARIANCE)<Qt.MAX_AVG_VARIANCE)return Int32Array.from([g,C]);g+=l[0]+l[1];let T=l.slice(2,l.length-1);for(let R=0;R<d-1;R++)l[R]=T[R];l[d-1]=0,l[d]=0,d--}else d++;l[d]=1,_=!_}throw new re}static decodeDigit(a,i,c,o){this.recordPattern(a,c,i);let l=this.MAX_AVG_VARIANCE,h=-1,d=o.length;for(let g=0;g<d;g++){let w=o[g],_=ft.patternMatchVariance(i,w,Qt.MAX_INDIVIDUAL_VARIANCE);_<l&&(l=_,h=g)}if(h>=0)return h;throw new re}}Qt.MAX_AVG_VARIANCE=.48,Qt.MAX_INDIVIDUAL_VARIANCE=.7,Qt.START_END_PATTERN=Int32Array.from([1,1,1]),Qt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Qt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Qt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class pa{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(a,i,c){let o=this.decodeRowStringBuffer,l=this.decodeMiddle(i,c,o),h=o.toString(),d=pa.parseExtensionString(h),g=[new We((c[0]+c[1])/2,a),new We(l,a)],w=new z(h,null,0,g,B.UPC_EAN_EXTENSION,new Date().getTime());return d!=null&&w.putAllMetadata(d),w}decodeMiddle(a,i,c){let o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;let l=a.getSize(),h=i[1],d=0;for(let w=0;w<5&&h<l;w++){let _=Qt.decodeDigit(a,o,h,Qt.L_AND_G_PATTERNS);c+=String.fromCharCode(48+_%10);for(let C of o)h+=C;_>=10&&(d|=1<<4-w),w!==4&&(h=a.getNextSet(h),h=a.getNextUnset(h))}if(c.length!==5)throw new re;let g=this.determineCheckDigit(d);if(pa.extensionChecksum(c.toString())!==g)throw new re;return h}static extensionChecksum(a){let i=a.length,c=0;for(let o=i-2;o>=0;o-=2)c+=a.charAt(o).charCodeAt(0)-48;c*=3;for(let o=i-1;o>=0;o-=2)c+=a.charAt(o).charCodeAt(0)-48;return c*=3,c%10}determineCheckDigit(a){for(let i=0;i<10;i++)if(a===this.CHECK_DIGIT_ENCODINGS[i])return i;throw new re}static parseExtensionString(a){if(a.length!==5)return null;let i=pa.parseExtension5String(a);return i==null?null:new Map([[we.SUGGESTED_PRICE,i]])}static parseExtension5String(a){let i;switch(a.charAt(0)){case"0":i="£";break;case"5":i="$";break;case"9":switch(a){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}i="";break;default:i="";break}let c=parseInt(a.substring(1)),o=(c/100).toString(),l=c%100,h=l<10?"0"+l:l.toString();return i+o+"."+h}}class En{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(a,i,c){let o=this.decodeRowStringBuffer,l=this.decodeMiddle(i,c,o),h=o.toString(),d=En.parseExtensionString(h),g=[new We((c[0]+c[1])/2,a),new We(l,a)],w=new z(h,null,0,g,B.UPC_EAN_EXTENSION,new Date().getTime());return d!=null&&w.putAllMetadata(d),w}decodeMiddle(a,i,c){let o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;let l=a.getSize(),h=i[1],d=0;for(let g=0;g<2&&h<l;g++){let w=Qt.decodeDigit(a,o,h,Qt.L_AND_G_PATTERNS);c+=String.fromCharCode(48+w%10);for(let _ of o)h+=_;w>=10&&(d|=1<<1-g),g!==1&&(h=a.getNextSet(h),h=a.getNextUnset(h))}if(c.length!==2)throw new re;if(parseInt(c.toString())%4!==d)throw new re;return h}static parseExtensionString(a){return a.length!==2?null:new Map([[we.ISSUE_NUMBER,parseInt(a)]])}}class _n{static decodeRow(a,i,c){let o=Qt.findGuardPattern(i,c,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new pa().decodeRow(a,i,o)}catch{return new En().decodeRow(a,i,o)}}}_n.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Ft extends Qt{constructor(){super(),this.decodeRowStringBuffer="",Ft.L_AND_G_PATTERNS=Ft.L_PATTERNS.map(a=>Int32Array.from(a));for(let a=10;a<20;a++){let i=Ft.L_PATTERNS[a-10],c=new Int32Array(i.length);for(let o=0;o<i.length;o++)c[o]=i[i.length-o-1];Ft.L_AND_G_PATTERNS[a]=c}}decodeRow(a,i,c){let o=Ft.findStartGuardPattern(i),l=c==null?null:c.get(Q.NEED_RESULT_POINT_CALLBACK);if(l!=null){const ce=new We((o[0]+o[1])/2,a);l.foundPossibleResultPoint(ce)}let h=this.decodeMiddle(i,o,this.decodeRowStringBuffer),d=h.rowOffset,g=h.resultString;if(l!=null){const ce=new We(d,a);l.foundPossibleResultPoint(ce)}let w=this.decodeEnd(i,d);if(l!=null){const ce=new We((w[0]+w[1])/2,a);l.foundPossibleResultPoint(ce)}let _=w[1],C=_+(_-w[0]);if(C>=i.getSize()||!i.isRange(_,C,!1))throw new re;let T=g.toString();if(T.length<8)throw new M;if(!Ft.checkChecksum(T))throw new S;let R=(o[1]+o[0])/2,L=(w[1]+w[0])/2,W=this.getBarcodeFormat(),te=[new We(R,a),new We(L,a)],se=new z(T,null,0,te,W,new Date().getTime()),Ce=0;try{let ce=_n.decodeRow(a,i,w[1]);se.putMetadata(we.UPC_EAN_EXTENSION,ce.getText()),se.putAllMetadata(ce.getResultMetadata()),se.addResultPoints(ce.getResultPoints()),Ce=ce.getText().length}catch{}let Te=c==null?null:c.get(Q.ALLOWED_EAN_EXTENSIONS);if(Te!=null){let ce=!1;for(let Ve in Te)if(Ce.toString()===Ve){ce=!0;break}if(!ce)throw new re}return se}decodeEnd(a,i){return Ft.findGuardPattern(a,i,!1,Ft.START_END_PATTERN,new Int32Array(Ft.START_END_PATTERN.length).fill(0))}static checkChecksum(a){return Ft.checkStandardUPCEANChecksum(a)}static checkStandardUPCEANChecksum(a){let i=a.length;if(i===0)return!1;let c=parseInt(a.charAt(i-1),10);return Ft.getStandardUPCEANChecksum(a.substring(0,i-1))===c}static getStandardUPCEANChecksum(a){let i=a.length,c=0;for(let o=i-1;o>=0;o-=2){let l=a.charAt(o).charCodeAt(0)-48;if(l<0||l>9)throw new M;c+=l}c*=3;for(let o=i-2;o>=0;o-=2){let l=a.charAt(o).charCodeAt(0)-48;if(l<0||l>9)throw new M;c+=l}return(1e3-c)%10}}class wr extends Ft{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(a,i,c){let o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;let l=a.getSize(),h=i[1],d=0;for(let w=0;w<6&&h<l;w++){let _=Ft.decodeDigit(a,o,h,Ft.L_AND_G_PATTERNS);c+=String.fromCharCode(48+_%10);for(let C of o)h+=C;_>=10&&(d|=1<<5-w)}c=wr.determineFirstDigit(c,d),h=Ft.findGuardPattern(a,h,!0,Ft.MIDDLE_PATTERN,new Int32Array(Ft.MIDDLE_PATTERN.length).fill(0))[1];for(let w=0;w<6&&h<l;w++){let _=Ft.decodeDigit(a,o,h,Ft.L_PATTERNS);c+=String.fromCharCode(48+_);for(let C of o)h+=C}return{rowOffset:h,resultString:c}}getBarcodeFormat(){return B.EAN_13}static determineFirstDigit(a,i){for(let c=0;c<10;c++)if(i===this.FIRST_DIGIT_ENCODINGS[c])return a=String.fromCharCode(48+c)+a,a;throw new re}}wr.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class la extends Ft{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(a,i,c){const o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;let l=a.getSize(),h=i[1];for(let g=0;g<4&&h<l;g++){let w=Ft.decodeDigit(a,o,h,Ft.L_PATTERNS);c+=String.fromCharCode(48+w);for(let _ of o)h+=_}h=Ft.findGuardPattern(a,h,!0,Ft.MIDDLE_PATTERN,new Int32Array(Ft.MIDDLE_PATTERN.length).fill(0))[1];for(let g=0;g<4&&h<l;g++){let w=Ft.decodeDigit(a,o,h,Ft.L_PATTERNS);c+=String.fromCharCode(48+w);for(let _ of o)h+=_}return{rowOffset:h,resultString:c}}getBarcodeFormat(){return B.EAN_8}}class ln extends Ft{constructor(){super(...arguments),this.ean13Reader=new wr}getBarcodeFormat(){return B.UPC_A}decode(a,i){return this.maybeReturnResult(this.ean13Reader.decode(a))}decodeRow(a,i,c){return this.maybeReturnResult(this.ean13Reader.decodeRow(a,i,c))}decodeMiddle(a,i,c){return this.ean13Reader.decodeMiddle(a,i,c)}maybeReturnResult(a){let i=a.getText();if(i.charAt(0)==="0"){let c=new z(i.substring(1),null,null,a.getResultPoints(),B.UPC_A);return a.getResultMetadata()!=null&&c.putAllMetadata(a.getResultMetadata()),c}else throw new re}reset(){this.ean13Reader.reset()}}class Yr extends Ft{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(a,i,c){const o=this.decodeMiddleCounters.map(w=>w);o[0]=0,o[1]=0,o[2]=0,o[3]=0;const l=a.getSize();let h=i[1],d=0;for(let w=0;w<6&&h<l;w++){const _=Yr.decodeDigit(a,o,h,Yr.L_AND_G_PATTERNS);c+=String.fromCharCode(48+_%10);for(let C of o)h+=C;_>=10&&(d|=1<<5-w)}let g=Yr.determineNumSysAndCheckDigit(c,d);return{rowOffset:h,resultString:g}}decodeEnd(a,i){return Yr.findGuardPatternWithoutCounters(a,i,!0,Yr.MIDDLE_END_PATTERN)}checkChecksum(a){return Ft.checkChecksum(Yr.convertUPCEtoUPCA(a))}static determineNumSysAndCheckDigit(a,i){for(let c=0;c<=1;c++)for(let o=0;o<10;o++)if(i===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[c][o]){let l=String.fromCharCode(48+c),h=String.fromCharCode(48+o);return l+a+h}throw re.getNotFoundInstance()}getBarcodeFormat(){return B.UPC_E}static convertUPCEtoUPCA(a){const i=a.slice(1,7).split("").map(l=>l.charCodeAt(0)),c=new pe;c.append(a.charAt(0));let o=i[5];switch(o){case 0:case 1:case 2:c.appendChars(i,0,2),c.append(o),c.append("0000"),c.appendChars(i,2,3);break;case 3:c.appendChars(i,0,3),c.append("00000"),c.appendChars(i,3,2);break;case 4:c.appendChars(i,0,4),c.append("00000"),c.append(i[4]);break;default:c.appendChars(i,0,5),c.append("0000"),c.append(o);break}return a.length>=8&&c.append(a.charAt(7)),c.toString()}}Yr.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Yr.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Ka extends ft{constructor(a){super();let i=a==null?null:a.get(Q.POSSIBLE_FORMATS),c=[];n(i)?(c.push(new wr),c.push(new ln),c.push(new la),c.push(new Yr)):(i.indexOf(B.EAN_13)>-1&&c.push(new wr),i.indexOf(B.UPC_A)>-1&&c.push(new ln),i.indexOf(B.EAN_8)>-1&&c.push(new la),i.indexOf(B.UPC_E)>-1&&c.push(new Yr)),this.readers=c}decodeRow(a,i,c){for(let o of this.readers)try{const l=o.decodeRow(a,i,c),h=l.getBarcodeFormat()===B.EAN_13&&l.getText().charAt(0)==="0",d=c==null?null:c.get(Q.POSSIBLE_FORMATS),g=d==null||d.includes(B.UPC_A);if(h&&g){const w=l.getRawBytes(),_=new z(l.getText().substring(1),w,w?w.length:null,l.getResultPoints(),B.UPC_A);return _.putAllMetadata(l.getResultMetadata()),_}return l}catch{}throw new re}reset(){for(let a of this.readers)a.reset()}}class gr extends ft{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(a,i){for(let c=0;c<i.length;c++)if(ft.patternMatchVariance(a,i[c],gr.MAX_INDIVIDUAL_VARIANCE)<gr.MAX_AVG_VARIANCE)return c;throw new re}static count(a){return nt.sum(new Int32Array(a))}static increment(a,i){let c=0,o=i[0];for(let l=1;l<a.length;l++)i[l]>o&&(o=i[l],c=l);a[c]++}static decrement(a,i){let c=0,o=i[0];for(let l=1;l<a.length;l++)i[l]<o&&(o=i[l],c=l);a[c]--}static isFinderPattern(a){let i=a[0]+a[1],c=i+a[2]+a[3],o=i/c;if(o>=gr.MIN_FINDER_PATTERN_RATIO&&o<=gr.MAX_FINDER_PATTERN_RATIO){let l=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER;for(let d of a)d>h&&(h=d),d<l&&(l=d);return h<10*l}return!1}}gr.MAX_AVG_VARIANCE=.2,gr.MAX_INDIVIDUAL_VARIANCE=.45,gr.MIN_FINDER_PATTERN_RATIO=9.5/12,gr.MAX_FINDER_PATTERN_RATIO=12.5/14;class qa{constructor(a,i){this.value=a,this.checksumPortion=i}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(a){if(!(a instanceof qa))return!1;const i=a;return this.value===i.value&&this.checksumPortion===i.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class An{constructor(a,i,c,o,l){this.value=a,this.startEnd=i,this.value=a,this.startEnd=i,this.resultPoints=new Array,this.resultPoints.push(new We(c,l)),this.resultPoints.push(new We(o,l))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(a){if(!(a instanceof An))return!1;const i=a;return this.value===i.value}hashCode(){return this.value}}class wa{constructor(){}static getRSSvalue(a,i,c){let o=0;for(let g of a)o+=g;let l=0,h=0,d=a.length;for(let g=0;g<d-1;g++){let w;for(w=1,h|=1<<g;w<a[g];w++,h&=~(1<<g)){let _=wa.combins(o-w-1,d-g-2);if(c&&h===0&&o-w-(d-g-1)>=d-g-1&&(_-=wa.combins(o-w-(d-g),d-g-2)),d-g-1>1){let C=0;for(let T=o-w-(d-g-2);T>i;T--)C+=wa.combins(o-w-T-1,d-g-3);_-=C*(d-1-g)}else o-w>i&&_--;l+=_}o-=w}return l}static combins(a,i){let c,o;a-i>i?(o=i,c=a-i):(o=a-i,c=i);let l=1,h=1;for(let d=a;d>c;d--)l*=d,h<=o&&(l/=h,h++);for(;h<=o;)l/=h,h++;return l}}class ms{static buildBitArray(a){let i=a.length*2-1;a[a.length-1].getRightChar()==null&&(i-=1);let c=12*i,o=new J(c),l=0,d=a[0].getRightChar().getValue();for(let g=11;g>=0;--g)d&1<<g&&o.set(l),l++;for(let g=1;g<a.length;++g){let w=a[g],_=w.getLeftChar().getValue();for(let C=11;C>=0;--C)_&1<<C&&o.set(l),l++;if(w.getRightChar()!=null){let C=w.getRightChar().getValue();for(let T=11;T>=0;--T)C&1<<T&&o.set(l),l++}}return o}}class ba{constructor(a,i){i?this.decodedInformation=null:(this.finished=a,this.decodedInformation=i)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class li{constructor(a){this.newPosition=a}getNewPosition(){return this.newPosition}}class Wr extends li{constructor(a,i){super(a),this.value=i}getValue(){return this.value}isFNC1(){return this.value===Wr.FNC1}}Wr.FNC1="$";class Za extends li{constructor(a,i,c){super(a),c?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=i}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class O extends li{constructor(a,i,c){if(super(a),i<0||i>10||c<0||c>10)throw new M;this.firstDigit=i,this.secondDigit=c}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===O.FNC1}isSecondDigitFNC1(){return this.secondDigit===O.FNC1}isAnyFNC1(){return this.firstDigit===O.FNC1||this.secondDigit===O.FNC1}}O.FNC1=10;class P{constructor(){}static parseFieldsInGeneralPurpose(a){if(!a)return null;if(a.length<2)throw new re;let i=a.substring(0,2);for(let l of P.TWO_DIGIT_DATA_LENGTH)if(l[0]===i)return l[1]===P.VARIABLE_LENGTH?P.processVariableAI(2,l[2],a):P.processFixedAI(2,l[1],a);if(a.length<3)throw new re;let c=a.substring(0,3);for(let l of P.THREE_DIGIT_DATA_LENGTH)if(l[0]===c)return l[1]===P.VARIABLE_LENGTH?P.processVariableAI(3,l[2],a):P.processFixedAI(3,l[1],a);for(let l of P.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(l[0]===c)return l[1]===P.VARIABLE_LENGTH?P.processVariableAI(4,l[2],a):P.processFixedAI(4,l[1],a);if(a.length<4)throw new re;let o=a.substring(0,4);for(let l of P.FOUR_DIGIT_DATA_LENGTH)if(l[0]===o)return l[1]===P.VARIABLE_LENGTH?P.processVariableAI(4,l[2],a):P.processFixedAI(4,l[1],a);throw new re}static processFixedAI(a,i,c){if(c.length<a)throw new re;let o=c.substring(0,a);if(c.length<a+i)throw new re;let l=c.substring(a,a+i),h=c.substring(a+i),d="("+o+")"+l,g=P.parseFieldsInGeneralPurpose(h);return g==null?d:d+g}static processVariableAI(a,i,c){let o=c.substring(0,a),l;c.length<a+i?l=c.length:l=a+i;let h=c.substring(a,l),d=c.substring(l),g="("+o+")"+h,w=P.parseFieldsInGeneralPurpose(d);return w==null?g:g+w}}P.VARIABLE_LENGTH=[],P.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",P.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",P.VARIABLE_LENGTH,20],["22",P.VARIABLE_LENGTH,29],["30",P.VARIABLE_LENGTH,8],["37",P.VARIABLE_LENGTH,8],["90",P.VARIABLE_LENGTH,30],["91",P.VARIABLE_LENGTH,30],["92",P.VARIABLE_LENGTH,30],["93",P.VARIABLE_LENGTH,30],["94",P.VARIABLE_LENGTH,30],["95",P.VARIABLE_LENGTH,30],["96",P.VARIABLE_LENGTH,30],["97",P.VARIABLE_LENGTH,3],["98",P.VARIABLE_LENGTH,30],["99",P.VARIABLE_LENGTH,30]],P.THREE_DIGIT_DATA_LENGTH=[["240",P.VARIABLE_LENGTH,30],["241",P.VARIABLE_LENGTH,30],["242",P.VARIABLE_LENGTH,6],["250",P.VARIABLE_LENGTH,30],["251",P.VARIABLE_LENGTH,30],["253",P.VARIABLE_LENGTH,17],["254",P.VARIABLE_LENGTH,20],["400",P.VARIABLE_LENGTH,30],["401",P.VARIABLE_LENGTH,30],["402",17],["403",P.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",P.VARIABLE_LENGTH,20],["421",P.VARIABLE_LENGTH,15],["422",3],["423",P.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],P.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",P.VARIABLE_LENGTH,15],["391",P.VARIABLE_LENGTH,18],["392",P.VARIABLE_LENGTH,15],["393",P.VARIABLE_LENGTH,18],["703",P.VARIABLE_LENGTH,30]],P.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",P.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",P.VARIABLE_LENGTH,20],["8003",P.VARIABLE_LENGTH,30],["8004",P.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",P.VARIABLE_LENGTH,30],["8008",P.VARIABLE_LENGTH,12],["8018",18],["8020",P.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",P.VARIABLE_LENGTH,70],["8200",P.VARIABLE_LENGTH,70]];class j{constructor(a){this.buffer=new pe,this.information=a}decodeAllCodes(a,i){let c=i,o=null;do{let l=this.decodeGeneralPurposeField(c,o),h=P.parseFieldsInGeneralPurpose(l.getNewString());if(h!=null&&a.append(h),l.isRemaining()?o=""+l.getRemainingValue():o=null,c===l.getNewPosition())break;c=l.getNewPosition()}while(!0);return a.toString()}isStillNumeric(a){if(a+7>this.information.getSize())return a+4<=this.information.getSize();for(let i=a;i<a+3;++i)if(this.information.get(i))return!0;return this.information.get(a+3)}decodeNumeric(a){if(a+7>this.information.getSize()){let l=this.extractNumericValueFromBitArray(a,4);return l===0?new O(this.information.getSize(),O.FNC1,O.FNC1):new O(this.information.getSize(),l-1,O.FNC1)}let i=this.extractNumericValueFromBitArray(a,7),c=(i-8)/11,o=(i-8)%11;return new O(a+7,c,o)}extractNumericValueFromBitArray(a,i){return j.extractNumericValueFromBitArray(this.information,a,i)}static extractNumericValueFromBitArray(a,i,c){let o=0;for(let l=0;l<c;++l)a.get(i+l)&&(o|=1<<c-l-1);return o}decodeGeneralPurposeField(a,i){this.buffer.setLengthToZero(),i!=null&&this.buffer.append(i),this.current.setPosition(a);let c=this.parseBlocks();return c!=null&&c.isRemaining()?new Za(this.current.getPosition(),this.buffer.toString(),c.getRemainingValue()):new Za(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let a,i;do{let c=this.current.getPosition();if(this.current.isAlpha()?(i=this.parseAlphaBlock(),a=i.isFinished()):this.current.isIsoIec646()?(i=this.parseIsoIec646Block(),a=i.isFinished()):(i=this.parseNumericBlock(),a=i.isFinished()),!(c!==this.current.getPosition())&&!a)break}while(!a);return i.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let a=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFirstDigitFNC1()){let i;return a.isSecondDigitFNC1()?i=new Za(this.current.getPosition(),this.buffer.toString()):i=new Za(this.current.getPosition(),this.buffer.toString(),a.getSecondDigit()),new ba(!0,i)}if(this.buffer.append(a.getFirstDigit()),a.isSecondDigitFNC1()){let i=new Za(this.current.getPosition(),this.buffer.toString());return new ba(!0,i)}this.buffer.append(a.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new ba(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let a=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFNC1()){let i=new Za(this.current.getPosition(),this.buffer.toString());return new ba(!0,i)}this.buffer.append(a.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new ba(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let a=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFNC1()){let i=new Za(this.current.getPosition(),this.buffer.toString());return new ba(!0,i)}this.buffer.append(a.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new ba(!1)}isStillIsoIec646(a){if(a+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(a,5);if(i>=5&&i<16)return!0;if(a+7>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(a,7);if(c>=64&&c<116)return!0;if(a+8>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(a,8);return o>=232&&o<253}decodeIsoIec646(a){let i=this.extractNumericValueFromBitArray(a,5);if(i===15)return new Wr(a+5,Wr.FNC1);if(i>=5&&i<15)return new Wr(a+5,"0"+(i-5));let c=this.extractNumericValueFromBitArray(a,7);if(c>=64&&c<90)return new Wr(a+7,""+(c+1));if(c>=90&&c<116)return new Wr(a+7,""+(c+7));let o=this.extractNumericValueFromBitArray(a,8),l;switch(o){case 232:l="!";break;case 233:l='"';break;case 234:l="%";break;case 235:l="&";break;case 236:l="'";break;case 237:l="(";break;case 238:l=")";break;case 239:l="*";break;case 240:l="+";break;case 241:l=",";break;case 242:l="-";break;case 243:l=".";break;case 244:l="/";break;case 245:l=":";break;case 246:l=";";break;case 247:l="<";break;case 248:l="=";break;case 249:l=">";break;case 250:l="?";break;case 251:l="_";break;case 252:l=" ";break;default:throw new M}return new Wr(a+8,l)}isStillAlpha(a){if(a+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(a,5);if(i>=5&&i<16)return!0;if(a+6>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(a,6);return c>=16&&c<63}decodeAlphanumeric(a){let i=this.extractNumericValueFromBitArray(a,5);if(i===15)return new Wr(a+5,Wr.FNC1);if(i>=5&&i<15)return new Wr(a+5,"0"+(i-5));let c=this.extractNumericValueFromBitArray(a,6);if(c>=32&&c<58)return new Wr(a+6,""+(c+33));let o;switch(c){case 58:o="*";break;case 59:o=",";break;case 60:o="-";break;case 61:o=".";break;case 62:o="/";break;default:throw new _t("Decoding invalid alphanumeric value: "+c)}return new Wr(a+6,o)}isAlphaTo646ToAlphaLatch(a){if(a+1>this.information.getSize())return!1;for(let i=0;i<5&&i+a<this.information.getSize();++i)if(i===2){if(!this.information.get(a+2))return!1}else if(this.information.get(a+i))return!1;return!0}isAlphaOr646ToNumericLatch(a){if(a+3>this.information.getSize())return!1;for(let i=a;i<a+3;++i)if(this.information.get(i))return!1;return!0}isNumericToAlphaNumericLatch(a){if(a+1>this.information.getSize())return!1;for(let i=0;i<4&&i+a<this.information.getSize();++i)if(this.information.get(a+i))return!1;return!0}}class U{constructor(a){this.information=a,this.generalDecoder=new j(a)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Y extends U{constructor(a){super(a)}encodeCompressedGtin(a,i){a.append("(01)");let c=a.length();a.append("9"),this.encodeCompressedGtinWithoutAI(a,i,c)}encodeCompressedGtinWithoutAI(a,i,c){for(let o=0;o<4;++o){let l=this.getGeneralDecoder().extractNumericValueFromBitArray(i+10*o,10);l/100===0&&a.append("0"),l/10===0&&a.append("0"),a.append(l)}Y.appendCheckDigit(a,c)}static appendCheckDigit(a,i){let c=0;for(let o=0;o<13;o++){let l=a.charAt(o+i).charCodeAt(0)-48;c+=o&1?l:3*l}c=10-c%10,c===10&&(c=0),a.append(c)}}Y.GTIN_SIZE=40;class q extends Y{constructor(a){super(a)}parseInformation(){let a=new pe;a.append("(01)");let i=a.length(),c=this.getGeneralDecoder().extractNumericValueFromBitArray(q.HEADER_SIZE,4);return a.append(c),this.encodeCompressedGtinWithoutAI(a,q.HEADER_SIZE+4,i),this.getGeneralDecoder().decodeAllCodes(a,q.HEADER_SIZE+44)}}q.HEADER_SIZE=4;class he extends U{constructor(a){super(a)}parseInformation(){let a=new pe;return this.getGeneralDecoder().decodeAllCodes(a,he.HEADER_SIZE)}}he.HEADER_SIZE=5;class ye extends Y{constructor(a){super(a)}encodeCompressedWeight(a,i,c){let o=this.getGeneralDecoder().extractNumericValueFromBitArray(i,c);this.addWeightCode(a,o);let l=this.checkWeight(o),h=1e5;for(let d=0;d<5;++d)l/h===0&&a.append("0"),h/=10;a.append(l)}}class oe extends ye{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()!=oe.HEADER_SIZE+ye.GTIN_SIZE+oe.WEIGHT_SIZE)throw new re;let a=new pe;return this.encodeCompressedGtin(a,oe.HEADER_SIZE),this.encodeCompressedWeight(a,oe.HEADER_SIZE+ye.GTIN_SIZE,oe.WEIGHT_SIZE),a.toString()}}oe.HEADER_SIZE=5,oe.WEIGHT_SIZE=15;class de extends oe{constructor(a){super(a)}addWeightCode(a,i){a.append("(3103)")}checkWeight(a){return a}}class xe extends oe{constructor(a){super(a)}addWeightCode(a,i){i<1e4?a.append("(3202)"):a.append("(3203)")}checkWeight(a){return a<1e4?a:a-1e4}}class Se extends Y{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()<Se.HEADER_SIZE+Y.GTIN_SIZE)throw new re;let a=new pe;this.encodeCompressedGtin(a,Se.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(Se.HEADER_SIZE+Y.GTIN_SIZE,Se.LAST_DIGIT_SIZE);a.append("(392"),a.append(i),a.append(")");let c=this.getGeneralDecoder().decodeGeneralPurposeField(Se.HEADER_SIZE+Y.GTIN_SIZE+Se.LAST_DIGIT_SIZE,null);return a.append(c.getNewString()),a.toString()}}Se.HEADER_SIZE=8,Se.LAST_DIGIT_SIZE=2;class Oe extends Y{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()<Oe.HEADER_SIZE+Y.GTIN_SIZE)throw new re;let a=new pe;this.encodeCompressedGtin(a,Oe.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(Oe.HEADER_SIZE+Y.GTIN_SIZE,Oe.LAST_DIGIT_SIZE);a.append("(393"),a.append(i),a.append(")");let c=this.getGeneralDecoder().extractNumericValueFromBitArray(Oe.HEADER_SIZE+Y.GTIN_SIZE+Oe.LAST_DIGIT_SIZE,Oe.FIRST_THREE_DIGITS_SIZE);c/100==0&&a.append("0"),c/10==0&&a.append("0"),a.append(c);let o=this.getGeneralDecoder().decodeGeneralPurposeField(Oe.HEADER_SIZE+Y.GTIN_SIZE+Oe.LAST_DIGIT_SIZE+Oe.FIRST_THREE_DIGITS_SIZE,null);return a.append(o.getNewString()),a.toString()}}Oe.HEADER_SIZE=8,Oe.LAST_DIGIT_SIZE=2,Oe.FIRST_THREE_DIGITS_SIZE=10;class Ie extends ye{constructor(a,i,c){super(a),this.dateCode=c,this.firstAIdigits=i}parseInformation(){if(this.getInformation().getSize()!=Ie.HEADER_SIZE+Ie.GTIN_SIZE+Ie.WEIGHT_SIZE+Ie.DATE_SIZE)throw new re;let a=new pe;return this.encodeCompressedGtin(a,Ie.HEADER_SIZE),this.encodeCompressedWeight(a,Ie.HEADER_SIZE+Ie.GTIN_SIZE,Ie.WEIGHT_SIZE),this.encodeCompressedDate(a,Ie.HEADER_SIZE+Ie.GTIN_SIZE+Ie.WEIGHT_SIZE),a.toString()}encodeCompressedDate(a,i){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(i,Ie.DATE_SIZE);if(c==38400)return;a.append("("),a.append(this.dateCode),a.append(")");let o=c%32;c/=32;let l=c%12+1;c/=12;let h=c;h/10==0&&a.append("0"),a.append(h),l/10==0&&a.append("0"),a.append(l),o/10==0&&a.append("0"),a.append(o)}addWeightCode(a,i){a.append("("),a.append(this.firstAIdigits),a.append(i/1e5),a.append(")")}checkWeight(a){return a%1e5}}Ie.HEADER_SIZE=8,Ie.WEIGHT_SIZE=20,Ie.DATE_SIZE=16;function Re(I){try{if(I.get(1))return new q(I);if(!I.get(2))return new he(I);switch(j.extractNumericValueFromBitArray(I,1,4)){case 4:return new de(I);case 5:return new xe(I)}switch(j.extractNumericValueFromBitArray(I,1,5)){case 12:return new Se(I);case 13:return new Oe(I)}switch(j.extractNumericValueFromBitArray(I,1,7)){case 56:return new Ie(I,"310","11");case 57:return new Ie(I,"320","11");case 58:return new Ie(I,"310","13");case 59:return new Ie(I,"320","13");case 60:return new Ie(I,"310","15");case 61:return new Ie(I,"320","15");case 62:return new Ie(I,"310","17");case 63:return new Ie(I,"320","17")}}catch(a){throw console.log(a),new _t("unknown decoder: "+I)}}class Be{constructor(a,i,c,o){this.leftchar=a,this.rightchar=i,this.finderpattern=c,this.maybeLast=o}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(a,i){return a instanceof Be?Be.equalsOrNull(a.leftchar,i.leftchar)&&Be.equalsOrNull(a.rightchar,i.rightchar)&&Be.equalsOrNull(a.finderpattern,i.finderpattern):!1}static equalsOrNull(a,i){return a===null?i===null:Be.equals(a,i)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class et{constructor(a,i,c){this.pairs=a,this.rowNumber=i,this.wasReversed=c}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(a){return this.checkEqualitity(this,a)}toString(){return"{ "+this.pairs+" }"}equals(a,i){return a instanceof et?this.checkEqualitity(a,i)&&a.wasReversed===i.wasReversed:!1}checkEqualitity(a,i){if(!a||!i)return;let c;return a.forEach((o,l)=>{i.forEach(h=>{o.getLeftChar().getValue()===h.getLeftChar().getValue()&&o.getRightChar().getValue()===h.getRightChar().getValue()&&o.getFinderPatter().getValue()===h.getFinderPatter().getValue()&&(c=!0)})}),c}}class Ee extends gr{constructor(a){super(...arguments),this.pairs=new Array(Ee.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=a===!0}decodeRow(a,i,c){this.pairs.length=0,this.startFromEven=!1;try{return Ee.constructResult(this.decodeRow2pairs(a,i))}catch(o){this.verbose&&console.log(o)}return this.pairs.length=0,this.startFromEven=!0,Ee.constructResult(this.decodeRow2pairs(a,i))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(a,i){let c=!1;for(;!c;)try{this.pairs.push(this.retrieveNextPair(i,this.pairs,a))}catch(l){if(l instanceof re){if(!this.pairs.length)throw new re;c=!0}}if(this.checkChecksum())return this.pairs;let o;if(this.rows.length?o=!0:o=!1,this.storeRow(a,!1),o){let l=this.checkRowsBoolean(!1);if(l!=null||(l=this.checkRowsBoolean(!0),l!=null))return l}throw new re}checkRowsBoolean(a){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,a&&(this.rows=this.rows.reverse());let i=null;try{i=this.checkRows(new Array,0)}catch(c){this.verbose&&console.log(c)}return a&&(this.rows=this.rows.reverse()),i}checkRows(a,i){for(let c=i;c<this.rows.length;c++){let o=this.rows[c];this.pairs.length=0;for(let h of a)this.pairs.push(h.getPairs());if(this.pairs.push(o.getPairs()),!Ee.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let l=new Array(a);l.push(o);try{return this.checkRows(l,c+1)}catch(h){this.verbose&&console.log(h)}}throw new re}static isValidSequence(a){for(let i of Ee.FINDER_PATTERN_SEQUENCES){if(a.length>i.length)continue;let c=!0;for(let o=0;o<a.length;o++)if(a[o].getFinderPattern().getValue()!=i[o]){c=!1;break}if(c)return!0}return!1}storeRow(a,i){let c=0,o=!1,l=!1;for(;c<this.rows.length;){let h=this.rows[c];if(h.getRowNumber()>a){l=h.isEquivalent(this.pairs);break}o=h.isEquivalent(this.pairs),c++}l||o||Ee.isPartialRow(this.pairs,this.rows)||(this.rows.push(c,new et(this.pairs,a,i)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(a,i){for(let c of i)if(c.getPairs().length!==a.length){for(let o of c.getPairs())for(let l of a)if(Be.equals(o,l))break}}static isPartialRow(a,i){for(let c of i){let o=!0;for(let l of a){let h=!1;for(let d of c.getPairs())if(l.equals(d)){h=!0;break}if(!h){o=!1;break}}if(o)return!0}return!1}getRows(){return this.rows}static constructResult(a){let i=ms.buildBitArray(a),o=Re(i).parseInformation(),l=a[0].getFinderPattern().getResultPoints(),h=a[a.length-1].getFinderPattern().getResultPoints(),d=[l[0],l[1],h[0],h[1]];return new z(o,null,null,d,B.RSS_EXPANDED,null)}checkChecksum(){let a=this.pairs.get(0),i=a.getLeftChar(),c=a.getRightChar();if(c==null)return!1;let o=c.getChecksumPortion(),l=2;for(let d=1;d<this.pairs.size();++d){let g=this.pairs.get(d);o+=g.getLeftChar().getChecksumPortion(),l++;let w=g.getRightChar();w!=null&&(o+=w.getChecksumPortion(),l++)}return o%=211,211*(l-4)+o==i.getValue()}static getNextSecondBar(a,i){let c;return a.get(i)?(c=a.getNextUnset(i),c=a.getNextSet(c)):(c=a.getNextSet(i),c=a.getNextUnset(c)),c}retrieveNextPair(a,i,c){let o=i.length%2==0;this.startFromEven&&(o=!o);let l,h=!0,d=-1;do this.findNextPair(a,i,d),l=this.parseFoundFinderPattern(a,c,o),l==null?d=Ee.getNextSecondBar(a,this.startEnd[0]):h=!1;while(h);let g=this.decodeDataCharacter(a,l,o,!0);if(!this.isEmptyPair(i)&&i[i.length-1].mustBeLast())throw new re;let w;try{w=this.decodeDataCharacter(a,l,o,!1)}catch(_){w=null,this.verbose&&console.log(_)}return new Be(g,w,l,!0)}isEmptyPair(a){return a.length===0}findNextPair(a,i,c){let o=this.getDecodeFinderCounters();o[0]=0,o[1]=0,o[2]=0,o[3]=0;let l=a.getSize(),h;c>=0?h=c:this.isEmptyPair(i)?h=0:h=i[i.length-1].getFinderPattern().getStartEnd()[1];let d=i.length%2!=0;this.startFromEven&&(d=!d);let g=!1;for(;h<l&&(g=!a.get(h),!!g);)h++;let w=0,_=h;for(let C=h;C<l;C++)if(a.get(C)!=g)o[w]++;else{if(w==3){if(d&&Ee.reverseCounters(o),Ee.isFinderPattern(o)){this.startEnd[0]=_,this.startEnd[1]=C;return}d&&Ee.reverseCounters(o),_+=o[0]+o[1],o[0]=o[2],o[1]=o[3],o[2]=0,o[3]=0,w--}else w++;o[w]=1,g=!g}throw new re}static reverseCounters(a){let i=a.length;for(let c=0;c<i/2;++c){let o=a[c];a[c]=a[i-c-1],a[i-c-1]=o}}parseFoundFinderPattern(a,i,c){let o,l,h;if(c){let w=this.startEnd[0]-1;for(;w>=0&&!a.get(w);)w--;w++,o=this.startEnd[0]-w,l=w,h=this.startEnd[1]}else l=this.startEnd[0],h=a.getNextUnset(this.startEnd[1]+1),o=h-this.startEnd[1];let d=this.getDecodeFinderCounters();A.arraycopy(d,0,d,1,d.length-1),d[0]=o;let g;try{g=this.parseFinderValue(d,Ee.FINDER_PATTERNS)}catch{return null}return new An(g,[l,h],l,h,i)}decodeDataCharacter(a,i,c,o){let l=this.getDataCharacterCounters();for(let bt=0;bt<l.length;bt++)l[bt]=0;if(o)Ee.recordPatternInReverse(a,i.getStartEnd()[0],l);else{Ee.recordPattern(a,i.getStartEnd()[1],l);for(let bt=0,er=l.length-1;bt<er;bt++,er--){let Or=l[bt];l[bt]=l[er],l[er]=Or}}let h=17,d=nt.sum(new Int32Array(l))/h,g=(i.getStartEnd()[1]-i.getStartEnd()[0])/15;if(Math.abs(d-g)/g>.3)throw new re;let w=this.getOddCounts(),_=this.getEvenCounts(),C=this.getOddRoundingErrors(),T=this.getEvenRoundingErrors();for(let bt=0;bt<l.length;bt++){let er=1*l[bt]/d,Or=er+.5;if(Or<1){if(er<.3)throw new re;Or=1}else if(Or>8){if(er>8.7)throw new re;Or=8}let Kn=bt/2;bt&1?(_[Kn]=Or,T[Kn]=er-Or):(w[Kn]=Or,C[Kn]=er-Or)}this.adjustOddEvenCounts(h);let R=4*i.getValue()+(c?0:2)+(o?0:1)-1,L=0,W=0;for(let bt=w.length-1;bt>=0;bt--){if(Ee.isNotA1left(i,c,o)){let er=Ee.WEIGHTS[R][2*bt];W+=w[bt]*er}L+=w[bt]}let te=0;for(let bt=_.length-1;bt>=0;bt--)if(Ee.isNotA1left(i,c,o)){let er=Ee.WEIGHTS[R][2*bt+1];te+=_[bt]*er}let se=W+te;if(L&1||L>13||L<4)throw new re;let Ce=(13-L)/2,Te=Ee.SYMBOL_WIDEST[Ce],ce=9-Te,Ve=wa.getRSSvalue(w,Te,!0),ze=wa.getRSSvalue(_,ce,!1),kt=Ee.EVEN_TOTAL_SUBSET[Ce],Ot=Ee.GSUM[Ce],It=Ve*kt+ze+Ot;return new qa(It,se)}static isNotA1left(a,i,c){return!(a.getValue()==0&&i&&c)}adjustOddEvenCounts(a){let i=nt.sum(new Int32Array(this.getOddCounts())),c=nt.sum(new Int32Array(this.getEvenCounts())),o=!1,l=!1;i>13?l=!0:i<4&&(o=!0);let h=!1,d=!1;c>13?d=!0:c<4&&(h=!0);let g=i+c-a,w=(i&1)==1,_=(c&1)==0;if(g==1)if(w){if(_)throw new re;l=!0}else{if(!_)throw new re;d=!0}else if(g==-1)if(w){if(_)throw new re;o=!0}else{if(!_)throw new re;h=!0}else if(g==0){if(w){if(!_)throw new re;i<c?(o=!0,d=!0):(l=!0,h=!0)}else if(_)throw new re}else throw new re;if(o){if(l)throw new re;Ee.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(l&&Ee.decrement(this.getOddCounts(),this.getOddRoundingErrors()),h){if(d)throw new re;Ee.increment(this.getEvenCounts(),this.getOddRoundingErrors())}d&&Ee.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ee.SYMBOL_WIDEST=[7,5,4,3,1],Ee.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Ee.GSUM=[0,348,1388,2948,3988],Ee.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Ee.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Ee.FINDER_PAT_A=0,Ee.FINDER_PAT_B=1,Ee.FINDER_PAT_C=2,Ee.FINDER_PAT_D=3,Ee.FINDER_PAT_E=4,Ee.FINDER_PAT_F=5,Ee.FINDER_PATTERN_SEQUENCES=[[Ee.FINDER_PAT_A,Ee.FINDER_PAT_A],[Ee.FINDER_PAT_A,Ee.FINDER_PAT_B,Ee.FINDER_PAT_B],[Ee.FINDER_PAT_A,Ee.FINDER_PAT_C,Ee.FINDER_PAT_B,Ee.FINDER_PAT_D],[Ee.FINDER_PAT_A,Ee.FINDER_PAT_E,Ee.FINDER_PAT_B,Ee.FINDER_PAT_D,Ee.FINDER_PAT_C],[Ee.FINDER_PAT_A,Ee.FINDER_PAT_E,Ee.FINDER_PAT_B,Ee.FINDER_PAT_D,Ee.FINDER_PAT_D,Ee.FINDER_PAT_F],[Ee.FINDER_PAT_A,Ee.FINDER_PAT_E,Ee.FINDER_PAT_B,Ee.FINDER_PAT_D,Ee.FINDER_PAT_E,Ee.FINDER_PAT_F,Ee.FINDER_PAT_F],[Ee.FINDER_PAT_A,Ee.FINDER_PAT_A,Ee.FINDER_PAT_B,Ee.FINDER_PAT_B,Ee.FINDER_PAT_C,Ee.FINDER_PAT_C,Ee.FINDER_PAT_D,Ee.FINDER_PAT_D],[Ee.FINDER_PAT_A,Ee.FINDER_PAT_A,Ee.FINDER_PAT_B,Ee.FINDER_PAT_B,Ee.FINDER_PAT_C,Ee.FINDER_PAT_C,Ee.FINDER_PAT_D,Ee.FINDER_PAT_E,Ee.FINDER_PAT_E],[Ee.FINDER_PAT_A,Ee.FINDER_PAT_A,Ee.FINDER_PAT_B,Ee.FINDER_PAT_B,Ee.FINDER_PAT_C,Ee.FINDER_PAT_C,Ee.FINDER_PAT_D,Ee.FINDER_PAT_E,Ee.FINDER_PAT_F,Ee.FINDER_PAT_F],[Ee.FINDER_PAT_A,Ee.FINDER_PAT_A,Ee.FINDER_PAT_B,Ee.FINDER_PAT_B,Ee.FINDER_PAT_C,Ee.FINDER_PAT_D,Ee.FINDER_PAT_D,Ee.FINDER_PAT_E,Ee.FINDER_PAT_E,Ee.FINDER_PAT_F,Ee.FINDER_PAT_F]],Ee.MAX_PAIRS=11;class Bt extends qa{constructor(a,i,c){super(a,i),this.count=0,this.finderPattern=c}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class ht extends gr{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(a,i,c){const o=this.decodePair(i,!1,a,c);ht.addOrTally(this.possibleLeftPairs,o),i.reverse();let l=this.decodePair(i,!0,a,c);ht.addOrTally(this.possibleRightPairs,l),i.reverse();for(let h of this.possibleLeftPairs)if(h.getCount()>1){for(let d of this.possibleRightPairs)if(d.getCount()>1&&ht.checkChecksum(h,d))return ht.constructResult(h,d)}throw new re}static addOrTally(a,i){if(i==null)return;let c=!1;for(let o of a)if(o.getValue()===i.getValue()){o.incrementCount(),c=!0;break}c||a.push(i)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(a,i){let c=4537077*a.getValue()+i.getValue(),o=new String(c).toString(),l=new pe;for(let w=13-o.length;w>0;w--)l.append("0");l.append(o);let h=0;for(let w=0;w<13;w++){let _=l.charAt(w).charCodeAt(0)-48;h+=w&1?_:3*_}h=10-h%10,h===10&&(h=0),l.append(h.toString());let d=a.getFinderPattern().getResultPoints(),g=i.getFinderPattern().getResultPoints();return new z(l.toString(),null,0,[d[0],d[1],g[0],g[1]],B.RSS_14,new Date().getTime())}static checkChecksum(a,i){let c=(a.getChecksumPortion()+16*i.getChecksumPortion())%79,o=9*a.getFinderPattern().getValue()+i.getFinderPattern().getValue();return o>72&&o--,o>8&&o--,c===o}decodePair(a,i,c,o){try{let l=this.findFinderPattern(a,i),h=this.parseFoundFinderPattern(a,c,i,l),d=o==null?null:o.get(Q.NEED_RESULT_POINT_CALLBACK);if(d!=null){let _=(l[0]+l[1])/2;i&&(_=a.getSize()-1-_),d.foundPossibleResultPoint(new We(_,c))}let g=this.decodeDataCharacter(a,h,!0),w=this.decodeDataCharacter(a,h,!1);return new Bt(1597*g.getValue()+w.getValue(),g.getChecksumPortion()+4*w.getChecksumPortion(),h)}catch{return null}}decodeDataCharacter(a,i,c){let o=this.getDataCharacterCounters();for(let te=0;te<o.length;te++)o[te]=0;if(c)ft.recordPatternInReverse(a,i.getStartEnd()[0],o);else{ft.recordPattern(a,i.getStartEnd()[1]+1,o);for(let te=0,se=o.length-1;te<se;te++,se--){let Ce=o[te];o[te]=o[se],o[se]=Ce}}let l=c?16:15,h=nt.sum(new Int32Array(o))/l,d=this.getOddCounts(),g=this.getEvenCounts(),w=this.getOddRoundingErrors(),_=this.getEvenRoundingErrors();for(let te=0;te<o.length;te++){let se=o[te]/h,Ce=Math.floor(se+.5);Ce<1?Ce=1:Ce>8&&(Ce=8);let Te=Math.floor(te/2);te&1?(g[Te]=Ce,_[Te]=se-Ce):(d[Te]=Ce,w[Te]=se-Ce)}this.adjustOddEvenCounts(c,l);let C=0,T=0;for(let te=d.length-1;te>=0;te--)T*=9,T+=d[te],C+=d[te];let R=0,L=0;for(let te=g.length-1;te>=0;te--)R*=9,R+=g[te],L+=g[te];let W=T+3*R;if(c){if(C&1||C>12||C<4)throw new re;let te=(12-C)/2,se=ht.OUTSIDE_ODD_WIDEST[te],Ce=9-se,Te=wa.getRSSvalue(d,se,!1),ce=wa.getRSSvalue(g,Ce,!0),Ve=ht.OUTSIDE_EVEN_TOTAL_SUBSET[te],ze=ht.OUTSIDE_GSUM[te];return new qa(Te*Ve+ce+ze,W)}else{if(L&1||L>10||L<4)throw new re;let te=(10-L)/2,se=ht.INSIDE_ODD_WIDEST[te],Ce=9-se,Te=wa.getRSSvalue(d,se,!0),ce=wa.getRSSvalue(g,Ce,!1),Ve=ht.INSIDE_ODD_TOTAL_SUBSET[te],ze=ht.INSIDE_GSUM[te];return new qa(ce*Ve+Te+ze,W)}}findFinderPattern(a,i){let c=this.getDecodeFinderCounters();c[0]=0,c[1]=0,c[2]=0,c[3]=0;let o=a.getSize(),l=!1,h=0;for(;h<o&&(l=!a.get(h),i!==l);)h++;let d=0,g=h;for(let w=h;w<o;w++)if(a.get(w)!==l)c[d]++;else{if(d===3){if(gr.isFinderPattern(c))return[g,w];g+=c[0]+c[1],c[0]=c[2],c[1]=c[3],c[2]=0,c[3]=0,d--}else d++;c[d]=1,l=!l}throw new re}parseFoundFinderPattern(a,i,c,o){let l=a.get(o[0]),h=o[0]-1;for(;h>=0&&l!==a.get(h);)h--;h++;const d=o[0]-h,g=this.getDecodeFinderCounters(),w=new Int32Array(g.length);A.arraycopy(g,0,w,1,g.length-1),w[0]=d;const _=this.parseFinderValue(w,ht.FINDER_PATTERNS);let C=h,T=o[1];return c&&(C=a.getSize()-1-C,T=a.getSize()-1-T),new An(_,[h,o[1]],C,T,i)}adjustOddEvenCounts(a,i){let c=nt.sum(new Int32Array(this.getOddCounts())),o=nt.sum(new Int32Array(this.getEvenCounts())),l=!1,h=!1,d=!1,g=!1;a?(c>12?h=!0:c<4&&(l=!0),o>12?g=!0:o<4&&(d=!0)):(c>11?h=!0:c<5&&(l=!0),o>10?g=!0:o<4&&(d=!0));let w=c+o-i,_=(c&1)===(a?1:0),C=(o&1)===1;if(w===1)if(_){if(C)throw new re;h=!0}else{if(!C)throw new re;g=!0}else if(w===-1)if(_){if(C)throw new re;l=!0}else{if(!C)throw new re;d=!0}else if(w===0){if(_){if(!C)throw new re;c<o?(l=!0,g=!0):(h=!0,d=!0)}else if(C)throw new re}else throw new re;if(l){if(h)throw new re;gr.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(h&&gr.decrement(this.getOddCounts(),this.getOddRoundingErrors()),d){if(g)throw new re;gr.increment(this.getEvenCounts(),this.getOddRoundingErrors())}g&&gr.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ht.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],ht.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],ht.OUTSIDE_GSUM=[0,161,961,2015,2715],ht.INSIDE_GSUM=[0,336,1036,1516],ht.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],ht.INSIDE_ODD_WIDEST=[2,4,6,8],ht.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Kr extends ft{constructor(a,i){super(),this.readers=[],this.verbose=i===!0;const c=a?a.get(Q.POSSIBLE_FORMATS):null,o=a&&a.get(Q.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;c?((c.includes(B.EAN_13)||c.includes(B.UPC_A)||c.includes(B.EAN_8)||c.includes(B.UPC_E))&&this.readers.push(new Ka(a)),c.includes(B.CODE_39)&&this.readers.push(new tr(o)),c.includes(B.CODE_128)&&this.readers.push(new De),c.includes(B.ITF)&&this.readers.push(new Nt),c.includes(B.RSS_14)&&this.readers.push(new ht),c.includes(B.RSS_EXPANDED)&&this.readers.push(new Ee(this.verbose))):(this.readers.push(new Ka(a)),this.readers.push(new tr),this.readers.push(new Ka(a)),this.readers.push(new De),this.readers.push(new Nt),this.readers.push(new ht),this.readers.push(new Ee(this.verbose)))}decodeRow(a,i,c){for(let o=0;o<this.readers.length;o++)try{return this.readers[o].decodeRow(a,i,c)}catch{}throw new re}reset(){this.readers.forEach(a=>a.reset())}}class ea extends ae{constructor(a=500,i){super(new Kr(i),a,i)}}class mt{constructor(a,i,c){this.ecCodewords=a,this.ecBlocks=[i],c&&this.ecBlocks.push(c)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class ut{constructor(a,i){this.count=a,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class pt{constructor(a,i,c,o,l,h){this.versionNumber=a,this.symbolSizeRows=i,this.symbolSizeColumns=c,this.dataRegionSizeRows=o,this.dataRegionSizeColumns=l,this.ecBlocks=h;let d=0;const g=h.getECCodewords(),w=h.getECBlocks();for(let _ of w)d+=_.getCount()*(_.getDataCodewords()+g);this.totalCodewords=d}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(a,i){if(a&1||i&1)throw new M;for(let c of pt.VERSIONS)if(c.symbolSizeRows===a&&c.symbolSizeColumns===i)return c;throw new M}toString(){return""+this.versionNumber}static buildVersions(){return[new pt(1,10,10,8,8,new mt(5,new ut(1,3))),new pt(2,12,12,10,10,new mt(7,new ut(1,5))),new pt(3,14,14,12,12,new mt(10,new ut(1,8))),new pt(4,16,16,14,14,new mt(12,new ut(1,12))),new pt(5,18,18,16,16,new mt(14,new ut(1,18))),new pt(6,20,20,18,18,new mt(18,new ut(1,22))),new pt(7,22,22,20,20,new mt(20,new ut(1,30))),new pt(8,24,24,22,22,new mt(24,new ut(1,36))),new pt(9,26,26,24,24,new mt(28,new ut(1,44))),new pt(10,32,32,14,14,new mt(36,new ut(1,62))),new pt(11,36,36,16,16,new mt(42,new ut(1,86))),new pt(12,40,40,18,18,new mt(48,new ut(1,114))),new pt(13,44,44,20,20,new mt(56,new ut(1,144))),new pt(14,48,48,22,22,new mt(68,new ut(1,174))),new pt(15,52,52,24,24,new mt(42,new ut(2,102))),new pt(16,64,64,14,14,new mt(56,new ut(2,140))),new pt(17,72,72,16,16,new mt(36,new ut(4,92))),new pt(18,80,80,18,18,new mt(48,new ut(4,114))),new pt(19,88,88,20,20,new mt(56,new ut(4,144))),new pt(20,96,96,22,22,new mt(68,new ut(4,174))),new pt(21,104,104,24,24,new mt(56,new ut(6,136))),new pt(22,120,120,18,18,new mt(68,new ut(6,175))),new pt(23,132,132,20,20,new mt(62,new ut(8,163))),new pt(24,144,144,22,22,new mt(62,new ut(8,156),new ut(2,155))),new pt(25,8,18,6,16,new mt(7,new ut(1,5))),new pt(26,8,32,6,14,new mt(11,new ut(1,10))),new pt(27,12,26,10,24,new mt(14,new ut(1,16))),new pt(28,12,36,10,16,new mt(18,new ut(1,22))),new pt(29,16,36,14,16,new mt(24,new ut(1,32))),new pt(30,16,48,14,22,new mt(28,new ut(1,49)))]}}pt.VERSIONS=pt.buildVersions();class fa{constructor(a){const i=a.getHeight();if(i<8||i>144||i&1)throw new M;this.version=fa.readVersion(a),this.mappingBitMatrix=this.extractDataRegion(a),this.readMappingMatrix=new Pe(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(a){const i=a.getHeight(),c=a.getWidth();return pt.getVersionForDimensions(i,c)}readCodewords(){const a=new Int8Array(this.version.getTotalCodewords());let i=0,c=4,o=0;const l=this.mappingBitMatrix.getHeight(),h=this.mappingBitMatrix.getWidth();let d=!1,g=!1,w=!1,_=!1;do if(c===l&&o===0&&!d)a[i++]=this.readCorner1(l,h)&255,c-=2,o+=2,d=!0;else if(c===l-2&&o===0&&h&3&&!g)a[i++]=this.readCorner2(l,h)&255,c-=2,o+=2,g=!0;else if(c===l+4&&o===2&&!(h&7)&&!w)a[i++]=this.readCorner3(l,h)&255,c-=2,o+=2,w=!0;else if(c===l-2&&o===0&&(h&7)===4&&!_)a[i++]=this.readCorner4(l,h)&255,c-=2,o+=2,_=!0;else{do c<l&&o>=0&&!this.readMappingMatrix.get(o,c)&&(a[i++]=this.readUtah(c,o,l,h)&255),c-=2,o+=2;while(c>=0&&o<h);c+=1,o+=3;do c>=0&&o<h&&!this.readMappingMatrix.get(o,c)&&(a[i++]=this.readUtah(c,o,l,h)&255),c+=2,o-=2;while(c<l&&o>=0);c+=3,o+=1}while(c<l||o<h);if(i!==this.version.getTotalCodewords())throw new M;return a}readModule(a,i,c,o){return a<0&&(a+=c,i+=4-(c+4&7)),i<0&&(i+=o,a+=4-(o+4&7)),this.readMappingMatrix.set(i,a),this.mappingBitMatrix.get(i,a)}readUtah(a,i,c,o){let l=0;return this.readModule(a-2,i-2,c,o)&&(l|=1),l<<=1,this.readModule(a-2,i-1,c,o)&&(l|=1),l<<=1,this.readModule(a-1,i-2,c,o)&&(l|=1),l<<=1,this.readModule(a-1,i-1,c,o)&&(l|=1),l<<=1,this.readModule(a-1,i,c,o)&&(l|=1),l<<=1,this.readModule(a,i-2,c,o)&&(l|=1),l<<=1,this.readModule(a,i-1,c,o)&&(l|=1),l<<=1,this.readModule(a,i,c,o)&&(l|=1),l}readCorner1(a,i){let c=0;return this.readModule(a-1,0,a,i)&&(c|=1),c<<=1,this.readModule(a-1,1,a,i)&&(c|=1),c<<=1,this.readModule(a-1,2,a,i)&&(c|=1),c<<=1,this.readModule(0,i-2,a,i)&&(c|=1),c<<=1,this.readModule(0,i-1,a,i)&&(c|=1),c<<=1,this.readModule(1,i-1,a,i)&&(c|=1),c<<=1,this.readModule(2,i-1,a,i)&&(c|=1),c<<=1,this.readModule(3,i-1,a,i)&&(c|=1),c}readCorner2(a,i){let c=0;return this.readModule(a-3,0,a,i)&&(c|=1),c<<=1,this.readModule(a-2,0,a,i)&&(c|=1),c<<=1,this.readModule(a-1,0,a,i)&&(c|=1),c<<=1,this.readModule(0,i-4,a,i)&&(c|=1),c<<=1,this.readModule(0,i-3,a,i)&&(c|=1),c<<=1,this.readModule(0,i-2,a,i)&&(c|=1),c<<=1,this.readModule(0,i-1,a,i)&&(c|=1),c<<=1,this.readModule(1,i-1,a,i)&&(c|=1),c}readCorner3(a,i){let c=0;return this.readModule(a-1,0,a,i)&&(c|=1),c<<=1,this.readModule(a-1,i-1,a,i)&&(c|=1),c<<=1,this.readModule(0,i-3,a,i)&&(c|=1),c<<=1,this.readModule(0,i-2,a,i)&&(c|=1),c<<=1,this.readModule(0,i-1,a,i)&&(c|=1),c<<=1,this.readModule(1,i-3,a,i)&&(c|=1),c<<=1,this.readModule(1,i-2,a,i)&&(c|=1),c<<=1,this.readModule(1,i-1,a,i)&&(c|=1),c}readCorner4(a,i){let c=0;return this.readModule(a-3,0,a,i)&&(c|=1),c<<=1,this.readModule(a-2,0,a,i)&&(c|=1),c<<=1,this.readModule(a-1,0,a,i)&&(c|=1),c<<=1,this.readModule(0,i-2,a,i)&&(c|=1),c<<=1,this.readModule(0,i-1,a,i)&&(c|=1),c<<=1,this.readModule(1,i-1,a,i)&&(c|=1),c<<=1,this.readModule(2,i-1,a,i)&&(c|=1),c<<=1,this.readModule(3,i-1,a,i)&&(c|=1),c}extractDataRegion(a){const i=this.version.getSymbolSizeRows(),c=this.version.getSymbolSizeColumns();if(a.getHeight()!==i)throw new E("Dimension of bitMatrix must match the version size");const o=this.version.getDataRegionSizeRows(),l=this.version.getDataRegionSizeColumns(),h=i/o|0,d=c/l|0,g=h*o,w=d*l,_=new Pe(w,g);for(let C=0;C<h;++C){const T=C*o;for(let R=0;R<d;++R){const L=R*l;for(let W=0;W<o;++W){const te=C*(o+2)+1+W,se=T+W;for(let Ce=0;Ce<l;++Ce){const Te=R*(l+2)+1+Ce;if(a.get(Te,te)){const ce=L+Ce;_.set(ce,se)}}}}}return _}}class fi{constructor(a,i){this.numDataCodewords=a,this.codewords=i}static getDataBlocks(a,i){const c=i.getECBlocks();let o=0;const l=c.getECBlocks();for(let W of l)o+=W.getCount();const h=new Array(o);let d=0;for(let W of l)for(let te=0;te<W.getCount();te++){const se=W.getDataCodewords(),Ce=c.getECCodewords()+se;h[d++]=new fi(se,new Uint8Array(Ce))}const w=h[0].codewords.length-c.getECCodewords(),_=w-1;let C=0;for(let W=0;W<_;W++)for(let te=0;te<d;te++)h[te].codewords[W]=a[C++];const T=i.getVersionNumber()===24,R=T?8:d;for(let W=0;W<R;W++)h[W].codewords[w-1]=a[C++];const L=h[0].codewords.length;for(let W=w;W<L;W++)for(let te=0;te<d;te++){const se=T?(te+8)%d:te,Ce=T&&se>7?W-1:W;h[se].codewords[Ce]=a[C++]}if(C!==a.length)throw new E;return h}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class g0{constructor(a){this.bytes=a,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(a){if(a<1||a>32||a>this.available())throw new E(""+a);let i=0,c=this.bitOffset,o=this.byteOffset;const l=this.bytes;if(c>0){const h=8-c,d=a<h?a:h,g=h-d,w=255>>8-d<<g;i=(l[o]&w)>>g,a-=d,c+=d,c===8&&(c=0,o++)}if(a>0){for(;a>=8;)i=i<<8|l[o]&255,o++,a-=8;if(a>0){const h=8-a,d=255>>h<<h;i=i<<a|(l[o]&d)>>h,c+=a}}return this.bitOffset=c,this.byteOffset=o,i}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Ir;(function(I){I[I.PAD_ENCODE=0]="PAD_ENCODE",I[I.ASCII_ENCODE=1]="ASCII_ENCODE",I[I.C40_ENCODE=2]="C40_ENCODE",I[I.TEXT_ENCODE=3]="TEXT_ENCODE",I[I.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",I[I.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",I[I.BASE256_ENCODE=6]="BASE256_ENCODE"})(Ir||(Ir={}));class bn{static decode(a){const i=new g0(a),c=new pe,o=new pe,l=new Array;let h=Ir.ASCII_ENCODE;do if(h===Ir.ASCII_ENCODE)h=this.decodeAsciiSegment(i,c,o);else{switch(h){case Ir.C40_ENCODE:this.decodeC40Segment(i,c);break;case Ir.TEXT_ENCODE:this.decodeTextSegment(i,c);break;case Ir.ANSIX12_ENCODE:this.decodeAnsiX12Segment(i,c);break;case Ir.EDIFACT_ENCODE:this.decodeEdifactSegment(i,c);break;case Ir.BASE256_ENCODE:this.decodeBase256Segment(i,c,l);break;default:throw new M}h=Ir.ASCII_ENCODE}while(h!==Ir.PAD_ENCODE&&i.available()>0);return o.length()>0&&c.append(o.toString()),new ve(a,c.toString(),l.length===0?null:l,null)}static decodeAsciiSegment(a,i,c){let o=!1;do{let l=a.readBits(8);if(l===0)throw new M;if(l<=128)return o&&(l+=128),i.append(String.fromCharCode(l-1)),Ir.ASCII_ENCODE;if(l===129)return Ir.PAD_ENCODE;if(l<=229){const h=l-130;h<10&&i.append("0"),i.append(""+h)}else switch(l){case 230:return Ir.C40_ENCODE;case 231:return Ir.BASE256_ENCODE;case 232:i.append("");break;case 233:case 234:break;case 235:o=!0;break;case 236:i.append("[)>05"),c.insert(0,"");break;case 237:i.append("[)>06"),c.insert(0,"");break;case 238:return Ir.ANSIX12_ENCODE;case 239:return Ir.TEXT_ENCODE;case 240:return Ir.EDIFACT_ENCODE;case 241:break;default:if(l!==254||a.available()!==0)throw new M;break}}while(a.available()>0);return Ir.ASCII_ENCODE}static decodeC40Segment(a,i){let c=!1;const o=[];let l=0;do{if(a.available()===8)return;const h=a.readBits(8);if(h===254)return;this.parseTwoBytes(h,a.readBits(8),o);for(let d=0;d<3;d++){const g=o[d];switch(l){case 0:if(g<3)l=g+1;else if(g<this.C40_BASIC_SET_CHARS.length){const w=this.C40_BASIC_SET_CHARS[g];c?(i.append(String.fromCharCode(w.charCodeAt(0)+128)),c=!1):i.append(w)}else throw new M;break;case 1:c?(i.append(String.fromCharCode(g+128)),c=!1):i.append(String.fromCharCode(g)),l=0;break;case 2:if(g<this.C40_SHIFT2_SET_CHARS.length){const w=this.C40_SHIFT2_SET_CHARS[g];c?(i.append(String.fromCharCode(w.charCodeAt(0)+128)),c=!1):i.append(w)}else switch(g){case 27:i.append("");break;case 30:c=!0;break;default:throw new M}l=0;break;case 3:c?(i.append(String.fromCharCode(g+224)),c=!1):i.append(String.fromCharCode(g+96)),l=0;break;default:throw new M}}}while(a.available()>0)}static decodeTextSegment(a,i){let c=!1,o=[],l=0;do{if(a.available()===8)return;const h=a.readBits(8);if(h===254)return;this.parseTwoBytes(h,a.readBits(8),o);for(let d=0;d<3;d++){const g=o[d];switch(l){case 0:if(g<3)l=g+1;else if(g<this.TEXT_BASIC_SET_CHARS.length){const w=this.TEXT_BASIC_SET_CHARS[g];c?(i.append(String.fromCharCode(w.charCodeAt(0)+128)),c=!1):i.append(w)}else throw new M;break;case 1:c?(i.append(String.fromCharCode(g+128)),c=!1):i.append(String.fromCharCode(g)),l=0;break;case 2:if(g<this.TEXT_SHIFT2_SET_CHARS.length){const w=this.TEXT_SHIFT2_SET_CHARS[g];c?(i.append(String.fromCharCode(w.charCodeAt(0)+128)),c=!1):i.append(w)}else switch(g){case 27:i.append("");break;case 30:c=!0;break;default:throw new M}l=0;break;case 3:if(g<this.TEXT_SHIFT3_SET_CHARS.length){const w=this.TEXT_SHIFT3_SET_CHARS[g];c?(i.append(String.fromCharCode(w.charCodeAt(0)+128)),c=!1):i.append(w),l=0}else throw new M;break;default:throw new M}}}while(a.available()>0)}static decodeAnsiX12Segment(a,i){const c=[];do{if(a.available()===8)return;const o=a.readBits(8);if(o===254)return;this.parseTwoBytes(o,a.readBits(8),c);for(let l=0;l<3;l++){const h=c[l];switch(h){case 0:i.append("\r");break;case 1:i.append("*");break;case 2:i.append(">");break;case 3:i.append(" ");break;default:if(h<14)i.append(String.fromCharCode(h+44));else if(h<40)i.append(String.fromCharCode(h+51));else throw new M;break}}}while(a.available()>0)}static parseTwoBytes(a,i,c){let o=(a<<8)+i-1,l=Math.floor(o/1600);c[0]=l,o-=l*1600,l=Math.floor(o/40),c[1]=l,c[2]=o-l*40}static decodeEdifactSegment(a,i){do{if(a.available()<=16)return;for(let c=0;c<4;c++){let o=a.readBits(6);if(o===31){const l=8-a.getBitOffset();l!==8&&a.readBits(l);return}o&32||(o|=64),i.append(String.fromCharCode(o))}}while(a.available()>0)}static decodeBase256Segment(a,i,c){let o=1+a.getByteOffset();const l=this.unrandomize255State(a.readBits(8),o++);let h;if(l===0?h=a.available()/8|0:l<250?h=l:h=250*(l-249)+this.unrandomize255State(a.readBits(8),o++),h<0)throw new M;const d=new Uint8Array(h);for(let g=0;g<h;g++){if(a.available()<8)throw new M;d[g]=this.unrandomize255State(a.readBits(8),o++)}c.push(d);try{i.append(le.decode(d,ee.ISO88591))}catch(g){throw new _t("Platform does not support required encoding: "+g.message)}}static unrandomize255State(a,i){const c=149*i%255+1,o=a-c;return o>=0?o:o+256}}bn.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],bn.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],bn.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],bn.TEXT_SHIFT2_SET_CHARS=bn.C40_SHIFT2_SET_CHARS,bn.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class sl{constructor(){this.rsDecoder=new ct(Ke.DATA_MATRIX_FIELD_256)}decode(a){const i=new fa(a),c=i.getVersion(),o=i.readCodewords(),l=fi.getDataBlocks(o,c);let h=0;for(let w of l)h+=w.getNumDataCodewords();const d=new Uint8Array(h),g=l.length;for(let w=0;w<g;w++){const _=l[w],C=_.getCodewords(),T=_.getNumDataCodewords();this.correctErrors(C,T);for(let R=0;R<T;R++)d[R*g+w]=C[R]}return bn.decode(d)}correctErrors(a,i){const c=new Int32Array(a);try{this.rsDecoder.decode(c,a.length-i)}catch{throw new S}for(let o=0;o<i;o++)a[o]=c[o]}}class ir{constructor(a){this.image=a,this.rectangleDetector=new Zt(this.image)}detect(){const a=this.rectangleDetector.detect();let i=this.detectSolid1(a);if(i=this.detectSolid2(i),i[3]=this.correctTopRight(i),!i[3])throw new re;i=this.shiftToModuleCenter(i);const c=i[0],o=i[1],l=i[2],h=i[3];let d=this.transitionsBetween(c,h)+1,g=this.transitionsBetween(l,h)+1;(d&1)===1&&(d+=1),(g&1)===1&&(g+=1),4*d<7*g&&4*g<7*d&&(d=g=Math.max(d,g));let w=ir.sampleGrid(this.image,c,o,l,h,d,g);return new br(w,[c,o,l,h])}static shiftPoint(a,i,c){let o=(i.getX()-a.getX())/(c+1),l=(i.getY()-a.getY())/(c+1);return new We(a.getX()+o,a.getY()+l)}static moveAway(a,i,c){let o=a.getX(),l=a.getY();return o<i?o-=1:o+=1,l<c?l-=1:l+=1,new We(o,l)}detectSolid1(a){let i=a[0],c=a[1],o=a[3],l=a[2],h=this.transitionsBetween(i,c),d=this.transitionsBetween(c,o),g=this.transitionsBetween(o,l),w=this.transitionsBetween(l,i),_=h,C=[l,i,c,o];return _>d&&(_=d,C[0]=i,C[1]=c,C[2]=o,C[3]=l),_>g&&(_=g,C[0]=c,C[1]=o,C[2]=l,C[3]=i),_>w&&(C[0]=o,C[1]=l,C[2]=i,C[3]=c),C}detectSolid2(a){let i=a[0],c=a[1],o=a[2],l=a[3],h=this.transitionsBetween(i,l),d=ir.shiftPoint(c,o,(h+1)*4),g=ir.shiftPoint(o,c,(h+1)*4),w=this.transitionsBetween(d,i),_=this.transitionsBetween(g,l);return w<_?(a[0]=i,a[1]=c,a[2]=o,a[3]=l):(a[0]=c,a[1]=o,a[2]=l,a[3]=i),a}correctTopRight(a){let i=a[0],c=a[1],o=a[2],l=a[3],h=this.transitionsBetween(i,l),d=this.transitionsBetween(c,l),g=ir.shiftPoint(i,c,(d+1)*4),w=ir.shiftPoint(o,c,(h+1)*4);h=this.transitionsBetween(g,l),d=this.transitionsBetween(w,l);let _=new We(l.getX()+(o.getX()-c.getX())/(h+1),l.getY()+(o.getY()-c.getY())/(h+1)),C=new We(l.getX()+(i.getX()-c.getX())/(d+1),l.getY()+(i.getY()-c.getY())/(d+1));if(!this.isValid(_))return this.isValid(C)?C:null;if(!this.isValid(C))return _;let T=this.transitionsBetween(g,_)+this.transitionsBetween(w,_),R=this.transitionsBetween(g,C)+this.transitionsBetween(w,C);return T>R?_:C}shiftToModuleCenter(a){let i=a[0],c=a[1],o=a[2],l=a[3],h=this.transitionsBetween(i,l)+1,d=this.transitionsBetween(o,l)+1,g=ir.shiftPoint(i,c,d*4),w=ir.shiftPoint(o,c,h*4);h=this.transitionsBetween(g,l)+1,d=this.transitionsBetween(w,l)+1,(h&1)===1&&(h+=1),(d&1)===1&&(d+=1);let _=(i.getX()+c.getX()+o.getX()+l.getX())/4,C=(i.getY()+c.getY()+o.getY()+l.getY())/4;i=ir.moveAway(i,_,C),c=ir.moveAway(c,_,C),o=ir.moveAway(o,_,C),l=ir.moveAway(l,_,C);let T,R;return g=ir.shiftPoint(i,c,d*4),g=ir.shiftPoint(g,l,h*4),T=ir.shiftPoint(c,i,d*4),T=ir.shiftPoint(T,o,h*4),w=ir.shiftPoint(o,l,d*4),w=ir.shiftPoint(w,c,h*4),R=ir.shiftPoint(l,o,d*4),R=ir.shiftPoint(R,i,h*4),[g,T,w,R]}isValid(a){return a.getX()>=0&&a.getX()<this.image.getWidth()&&a.getY()>0&&a.getY()<this.image.getHeight()}static sampleGrid(a,i,c,o,l,h,d){return Jt.getInstance().sampleGrid(a,h,d,.5,.5,h-.5,.5,h-.5,d-.5,.5,d-.5,i.getX(),i.getY(),l.getX(),l.getY(),o.getX(),o.getY(),c.getX(),c.getY())}transitionsBetween(a,i){let c=Math.trunc(a.getX()),o=Math.trunc(a.getY()),l=Math.trunc(i.getX()),h=Math.trunc(i.getY()),d=Math.abs(h-o)>Math.abs(l-c);if(d){let W=c;c=o,o=W,W=l,l=h,h=W}let g=Math.abs(l-c),w=Math.abs(h-o),_=-g/2,C=o<h?1:-1,T=c<l?1:-1,R=0,L=this.image.get(d?o:c,d?c:o);for(let W=c,te=o;W!==l;W+=T){let se=this.image.get(d?te:W,d?W:te);if(se!==L&&(R++,L=se),_+=w,_>0){if(te===h)break;te+=C,_-=g}}return R}}class Pa{constructor(){this.decoder=new sl}decode(a,i=null){let c,o;if(i!=null&&i.has(Q.PURE_BARCODE)){const w=Pa.extractPureBits(a.getBlackMatrix());c=this.decoder.decode(w),o=Pa.NO_POINTS}else{const w=new ir(a.getBlackMatrix()).detect();c=this.decoder.decode(w.getBits()),o=w.getPoints()}const l=c.getRawBytes(),h=new z(c.getText(),l,8*l.length,o,B.DATA_MATRIX,A.currentTimeMillis()),d=c.getByteSegments();d!=null&&h.putMetadata(we.BYTE_SEGMENTS,d);const g=c.getECLevel();return g!=null&&h.putMetadata(we.ERROR_CORRECTION_LEVEL,g),h}reset(){}static extractPureBits(a){const i=a.getTopLeftOnBit(),c=a.getBottomRightOnBit();if(i==null||c==null)throw new re;const o=this.moduleSize(i,a);let l=i[1];const h=c[1];let d=i[0];const w=(c[0]-d+1)/o,_=(h-l+1)/o;if(w<=0||_<=0)throw new re;const C=o/2;l+=C,d+=C;const T=new Pe(w,_);for(let R=0;R<_;R++){const L=l+R*o;for(let W=0;W<w;W++)a.get(d+W*o,L)&&T.set(W,R)}return T}static moduleSize(a,i){const c=i.getWidth();let o=a[0];const l=a[1];for(;o<c&&i.get(o,l);)o++;if(o===c)throw new re;const h=o-a[0];if(h===0)throw new re;return h}}Pa.NO_POINTS=[];class ps extends ae{constructor(a=500){super(new Pa,a)}}var fn;(function(I){I[I.L=0]="L",I[I.M=1]="M",I[I.Q=2]="Q",I[I.H=3]="H"})(fn||(fn={}));class Kt{constructor(a,i,c){this.value=a,this.stringValue=i,this.bits=c,Kt.FOR_BITS.set(c,this),Kt.FOR_VALUE.set(a,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(a){switch(a){case"L":return Kt.L;case"M":return Kt.M;case"Q":return Kt.Q;case"H":return Kt.H;default:throw new v(a+"not available")}}toString(){return this.stringValue}equals(a){if(!(a instanceof Kt))return!1;const i=a;return this.value===i.value}static forBits(a){if(a<0||a>=Kt.FOR_BITS.size)throw new E;return Kt.FOR_BITS.get(a)}}Kt.FOR_BITS=new Map,Kt.FOR_VALUE=new Map,Kt.L=new Kt(fn.L,"L",1),Kt.M=new Kt(fn.M,"M",0),Kt.Q=new Kt(fn.Q,"Q",3),Kt.H=new Kt(fn.H,"H",2);class Vr{constructor(a){this.errorCorrectionLevel=Kt.forBits(a>>3&3),this.dataMask=a&7}static numBitsDiffering(a,i){return D.bitCount(a^i)}static decodeFormatInformation(a,i){const c=Vr.doDecodeFormatInformation(a,i);return c!==null?c:Vr.doDecodeFormatInformation(a^Vr.FORMAT_INFO_MASK_QR,i^Vr.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(a,i){let c=Number.MAX_SAFE_INTEGER,o=0;for(const l of Vr.FORMAT_INFO_DECODE_LOOKUP){const h=l[0];if(h===a||h===i)return new Vr(l[1]);let d=Vr.numBitsDiffering(a,h);d<c&&(o=l[1],c=d),a!==i&&(d=Vr.numBitsDiffering(i,h),d<c&&(o=l[1],c=d))}return c<=3?new Vr(o):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(a){if(!(a instanceof Vr))return!1;const i=a;return this.errorCorrectionLevel===i.errorCorrectionLevel&&this.dataMask===i.dataMask}}Vr.FORMAT_INFO_MASK_QR=21522,Vr.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class fe{constructor(a,...i){this.ecCodewordsPerBlock=a,this.ecBlocks=i}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let a=0;const i=this.ecBlocks;for(const c of i)a+=c.getCount();return a}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class H{constructor(a,i){this.count=a,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class qe{constructor(a,i,...c){this.versionNumber=a,this.alignmentPatternCenters=i,this.ecBlocks=c;let o=0;const l=c[0].getECCodewordsPerBlock(),h=c[0].getECBlocks();for(const d of h)o+=d.getCount()*(d.getDataCodewords()+l);this.totalCodewords=o}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(a){return this.ecBlocks[a.getValue()]}static getProvisionalVersionForDimension(a){if(a%4!==1)throw new M;try{return this.getVersionForNumber((a-17)/4)}catch{throw new M}}static getVersionForNumber(a){if(a<1||a>40)throw new E;return qe.VERSIONS[a-1]}static decodeVersionInformation(a){let i=Number.MAX_SAFE_INTEGER,c=0;for(let o=0;o<qe.VERSION_DECODE_INFO.length;o++){const l=qe.VERSION_DECODE_INFO[o];if(l===a)return qe.getVersionForNumber(o+7);const h=Vr.numBitsDiffering(a,l);h<i&&(c=o+7,i=h)}return i<=3?qe.getVersionForNumber(c):null}buildFunctionPattern(){const a=this.getDimensionForVersion(),i=new Pe(a);i.setRegion(0,0,9,9),i.setRegion(a-8,0,8,9),i.setRegion(0,a-8,9,8);const c=this.alignmentPatternCenters.length;for(let o=0;o<c;o++){const l=this.alignmentPatternCenters[o]-2;for(let h=0;h<c;h++)o===0&&(h===0||h===c-1)||o===c-1&&h===0||i.setRegion(this.alignmentPatternCenters[h]-2,l,5,5)}return i.setRegion(6,9,1,a-17),i.setRegion(9,6,a-17,1),this.versionNumber>6&&(i.setRegion(a-11,0,3,6),i.setRegion(0,a-11,6,3)),i}toString(){return""+this.versionNumber}}qe.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),qe.VERSIONS=[new qe(1,new Int32Array(0),new fe(7,new H(1,19)),new fe(10,new H(1,16)),new fe(13,new H(1,13)),new fe(17,new H(1,9))),new qe(2,Int32Array.from([6,18]),new fe(10,new H(1,34)),new fe(16,new H(1,28)),new fe(22,new H(1,22)),new fe(28,new H(1,16))),new qe(3,Int32Array.from([6,22]),new fe(15,new H(1,55)),new fe(26,new H(1,44)),new fe(18,new H(2,17)),new fe(22,new H(2,13))),new qe(4,Int32Array.from([6,26]),new fe(20,new H(1,80)),new fe(18,new H(2,32)),new fe(26,new H(2,24)),new fe(16,new H(4,9))),new qe(5,Int32Array.from([6,30]),new fe(26,new H(1,108)),new fe(24,new H(2,43)),new fe(18,new H(2,15),new H(2,16)),new fe(22,new H(2,11),new H(2,12))),new qe(6,Int32Array.from([6,34]),new fe(18,new H(2,68)),new fe(16,new H(4,27)),new fe(24,new H(4,19)),new fe(28,new H(4,15))),new qe(7,Int32Array.from([6,22,38]),new fe(20,new H(2,78)),new fe(18,new H(4,31)),new fe(18,new H(2,14),new H(4,15)),new fe(26,new H(4,13),new H(1,14))),new qe(8,Int32Array.from([6,24,42]),new fe(24,new H(2,97)),new fe(22,new H(2,38),new H(2,39)),new fe(22,new H(4,18),new H(2,19)),new fe(26,new H(4,14),new H(2,15))),new qe(9,Int32Array.from([6,26,46]),new fe(30,new H(2,116)),new fe(22,new H(3,36),new H(2,37)),new fe(20,new H(4,16),new H(4,17)),new fe(24,new H(4,12),new H(4,13))),new qe(10,Int32Array.from([6,28,50]),new fe(18,new H(2,68),new H(2,69)),new fe(26,new H(4,43),new H(1,44)),new fe(24,new H(6,19),new H(2,20)),new fe(28,new H(6,15),new H(2,16))),new qe(11,Int32Array.from([6,30,54]),new fe(20,new H(4,81)),new fe(30,new H(1,50),new H(4,51)),new fe(28,new H(4,22),new H(4,23)),new fe(24,new H(3,12),new H(8,13))),new qe(12,Int32Array.from([6,32,58]),new fe(24,new H(2,92),new H(2,93)),new fe(22,new H(6,36),new H(2,37)),new fe(26,new H(4,20),new H(6,21)),new fe(28,new H(7,14),new H(4,15))),new qe(13,Int32Array.from([6,34,62]),new fe(26,new H(4,107)),new fe(22,new H(8,37),new H(1,38)),new fe(24,new H(8,20),new H(4,21)),new fe(22,new H(12,11),new H(4,12))),new qe(14,Int32Array.from([6,26,46,66]),new fe(30,new H(3,115),new H(1,116)),new fe(24,new H(4,40),new H(5,41)),new fe(20,new H(11,16),new H(5,17)),new fe(24,new H(11,12),new H(5,13))),new qe(15,Int32Array.from([6,26,48,70]),new fe(22,new H(5,87),new H(1,88)),new fe(24,new H(5,41),new H(5,42)),new fe(30,new H(5,24),new H(7,25)),new fe(24,new H(11,12),new H(7,13))),new qe(16,Int32Array.from([6,26,50,74]),new fe(24,new H(5,98),new H(1,99)),new fe(28,new H(7,45),new H(3,46)),new fe(24,new H(15,19),new H(2,20)),new fe(30,new H(3,15),new H(13,16))),new qe(17,Int32Array.from([6,30,54,78]),new fe(28,new H(1,107),new H(5,108)),new fe(28,new H(10,46),new H(1,47)),new fe(28,new H(1,22),new H(15,23)),new fe(28,new H(2,14),new H(17,15))),new qe(18,Int32Array.from([6,30,56,82]),new fe(30,new H(5,120),new H(1,121)),new fe(26,new H(9,43),new H(4,44)),new fe(28,new H(17,22),new H(1,23)),new fe(28,new H(2,14),new H(19,15))),new qe(19,Int32Array.from([6,30,58,86]),new fe(28,new H(3,113),new H(4,114)),new fe(26,new H(3,44),new H(11,45)),new fe(26,new H(17,21),new H(4,22)),new fe(26,new H(9,13),new H(16,14))),new qe(20,Int32Array.from([6,34,62,90]),new fe(28,new H(3,107),new H(5,108)),new fe(26,new H(3,41),new H(13,42)),new fe(30,new H(15,24),new H(5,25)),new fe(28,new H(15,15),new H(10,16))),new qe(21,Int32Array.from([6,28,50,72,94]),new fe(28,new H(4,116),new H(4,117)),new fe(26,new H(17,42)),new fe(28,new H(17,22),new H(6,23)),new fe(30,new H(19,16),new H(6,17))),new qe(22,Int32Array.from([6,26,50,74,98]),new fe(28,new H(2,111),new H(7,112)),new fe(28,new H(17,46)),new fe(30,new H(7,24),new H(16,25)),new fe(24,new H(34,13))),new qe(23,Int32Array.from([6,30,54,78,102]),new fe(30,new H(4,121),new H(5,122)),new fe(28,new H(4,47),new H(14,48)),new fe(30,new H(11,24),new H(14,25)),new fe(30,new H(16,15),new H(14,16))),new qe(24,Int32Array.from([6,28,54,80,106]),new fe(30,new H(6,117),new H(4,118)),new fe(28,new H(6,45),new H(14,46)),new fe(30,new H(11,24),new H(16,25)),new fe(30,new H(30,16),new H(2,17))),new qe(25,Int32Array.from([6,32,58,84,110]),new fe(26,new H(8,106),new H(4,107)),new fe(28,new H(8,47),new H(13,48)),new fe(30,new H(7,24),new H(22,25)),new fe(30,new H(22,15),new H(13,16))),new qe(26,Int32Array.from([6,30,58,86,114]),new fe(28,new H(10,114),new H(2,115)),new fe(28,new H(19,46),new H(4,47)),new fe(28,new H(28,22),new H(6,23)),new fe(30,new H(33,16),new H(4,17))),new qe(27,Int32Array.from([6,34,62,90,118]),new fe(30,new H(8,122),new H(4,123)),new fe(28,new H(22,45),new H(3,46)),new fe(30,new H(8,23),new H(26,24)),new fe(30,new H(12,15),new H(28,16))),new qe(28,Int32Array.from([6,26,50,74,98,122]),new fe(30,new H(3,117),new H(10,118)),new fe(28,new H(3,45),new H(23,46)),new fe(30,new H(4,24),new H(31,25)),new fe(30,new H(11,15),new H(31,16))),new qe(29,Int32Array.from([6,30,54,78,102,126]),new fe(30,new H(7,116),new H(7,117)),new fe(28,new H(21,45),new H(7,46)),new fe(30,new H(1,23),new H(37,24)),new fe(30,new H(19,15),new H(26,16))),new qe(30,Int32Array.from([6,26,52,78,104,130]),new fe(30,new H(5,115),new H(10,116)),new fe(28,new H(19,47),new H(10,48)),new fe(30,new H(15,24),new H(25,25)),new fe(30,new H(23,15),new H(25,16))),new qe(31,Int32Array.from([6,30,56,82,108,134]),new fe(30,new H(13,115),new H(3,116)),new fe(28,new H(2,46),new H(29,47)),new fe(30,new H(42,24),new H(1,25)),new fe(30,new H(23,15),new H(28,16))),new qe(32,Int32Array.from([6,34,60,86,112,138]),new fe(30,new H(17,115)),new fe(28,new H(10,46),new H(23,47)),new fe(30,new H(10,24),new H(35,25)),new fe(30,new H(19,15),new H(35,16))),new qe(33,Int32Array.from([6,30,58,86,114,142]),new fe(30,new H(17,115),new H(1,116)),new fe(28,new H(14,46),new H(21,47)),new fe(30,new H(29,24),new H(19,25)),new fe(30,new H(11,15),new H(46,16))),new qe(34,Int32Array.from([6,34,62,90,118,146]),new fe(30,new H(13,115),new H(6,116)),new fe(28,new H(14,46),new H(23,47)),new fe(30,new H(44,24),new H(7,25)),new fe(30,new H(59,16),new H(1,17))),new qe(35,Int32Array.from([6,30,54,78,102,126,150]),new fe(30,new H(12,121),new H(7,122)),new fe(28,new H(12,47),new H(26,48)),new fe(30,new H(39,24),new H(14,25)),new fe(30,new H(22,15),new H(41,16))),new qe(36,Int32Array.from([6,24,50,76,102,128,154]),new fe(30,new H(6,121),new H(14,122)),new fe(28,new H(6,47),new H(34,48)),new fe(30,new H(46,24),new H(10,25)),new fe(30,new H(2,15),new H(64,16))),new qe(37,Int32Array.from([6,28,54,80,106,132,158]),new fe(30,new H(17,122),new H(4,123)),new fe(28,new H(29,46),new H(14,47)),new fe(30,new H(49,24),new H(10,25)),new fe(30,new H(24,15),new H(46,16))),new qe(38,Int32Array.from([6,32,58,84,110,136,162]),new fe(30,new H(4,122),new H(18,123)),new fe(28,new H(13,46),new H(32,47)),new fe(30,new H(48,24),new H(14,25)),new fe(30,new H(42,15),new H(32,16))),new qe(39,Int32Array.from([6,26,54,82,110,138,166]),new fe(30,new H(20,117),new H(4,118)),new fe(28,new H(40,47),new H(7,48)),new fe(30,new H(43,24),new H(22,25)),new fe(30,new H(10,15),new H(67,16))),new qe(40,Int32Array.from([6,30,58,86,114,142,170]),new fe(30,new H(19,118),new H(6,119)),new fe(28,new H(18,47),new H(31,48)),new fe(30,new H(34,24),new H(34,25)),new fe(30,new H(20,15),new H(61,16)))];var Wt;(function(I){I[I.DATA_MASK_000=0]="DATA_MASK_000",I[I.DATA_MASK_001=1]="DATA_MASK_001",I[I.DATA_MASK_010=2]="DATA_MASK_010",I[I.DATA_MASK_011=3]="DATA_MASK_011",I[I.DATA_MASK_100=4]="DATA_MASK_100",I[I.DATA_MASK_101=5]="DATA_MASK_101",I[I.DATA_MASK_110=6]="DATA_MASK_110",I[I.DATA_MASK_111=7]="DATA_MASK_111"})(Wt||(Wt={}));class ha{constructor(a,i){this.value=a,this.isMasked=i}unmaskBitMatrix(a,i){for(let c=0;c<i;c++)for(let o=0;o<i;o++)this.isMasked(c,o)&&a.flip(o,c)}}ha.values=new Map([[Wt.DATA_MASK_000,new ha(Wt.DATA_MASK_000,(I,a)=>(I+a&1)===0)],[Wt.DATA_MASK_001,new ha(Wt.DATA_MASK_001,(I,a)=>(I&1)===0)],[Wt.DATA_MASK_010,new ha(Wt.DATA_MASK_010,(I,a)=>a%3===0)],[Wt.DATA_MASK_011,new ha(Wt.DATA_MASK_011,(I,a)=>(I+a)%3===0)],[Wt.DATA_MASK_100,new ha(Wt.DATA_MASK_100,(I,a)=>(Math.floor(I/2)+Math.floor(a/3)&1)===0)],[Wt.DATA_MASK_101,new ha(Wt.DATA_MASK_101,(I,a)=>I*a%6===0)],[Wt.DATA_MASK_110,new ha(Wt.DATA_MASK_110,(I,a)=>I*a%6<3)],[Wt.DATA_MASK_111,new ha(Wt.DATA_MASK_111,(I,a)=>(I+a+I*a%3&1)===0)]]);class No{constructor(a){const i=a.getHeight();if(i<21||(i&3)!==1)throw new M;this.bitMatrix=a}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let a=0;for(let l=0;l<6;l++)a=this.copyBit(l,8,a);a=this.copyBit(7,8,a),a=this.copyBit(8,8,a),a=this.copyBit(8,7,a);for(let l=5;l>=0;l--)a=this.copyBit(8,l,a);const i=this.bitMatrix.getHeight();let c=0;const o=i-7;for(let l=i-1;l>=o;l--)c=this.copyBit(8,l,c);for(let l=i-8;l<i;l++)c=this.copyBit(l,8,c);if(this.parsedFormatInfo=Vr.decodeFormatInformation(a,c),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new M}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const a=this.bitMatrix.getHeight(),i=Math.floor((a-17)/4);if(i<=6)return qe.getVersionForNumber(i);let c=0;const o=a-11;for(let h=5;h>=0;h--)for(let d=a-9;d>=o;d--)c=this.copyBit(d,h,c);let l=qe.decodeVersionInformation(c);if(l!==null&&l.getDimensionForVersion()===a)return this.parsedVersion=l,l;c=0;for(let h=5;h>=0;h--)for(let d=a-9;d>=o;d--)c=this.copyBit(h,d,c);if(l=qe.decodeVersionInformation(c),l!==null&&l.getDimensionForVersion()===a)return this.parsedVersion=l,l;throw new M}copyBit(a,i,c){return(this.isMirror?this.bitMatrix.get(i,a):this.bitMatrix.get(a,i))?c<<1|1:c<<1}readCodewords(){const a=this.readFormatInformation(),i=this.readVersion(),c=ha.values.get(a.getDataMask()),o=this.bitMatrix.getHeight();c.unmaskBitMatrix(this.bitMatrix,o);const l=i.buildFunctionPattern();let h=!0;const d=new Uint8Array(i.getTotalCodewords());let g=0,w=0,_=0;for(let C=o-1;C>0;C-=2){C===6&&C--;for(let T=0;T<o;T++){const R=h?o-1-T:T;for(let L=0;L<2;L++)l.get(C-L,R)||(_++,w<<=1,this.bitMatrix.get(C-L,R)&&(w|=1),_===8&&(d[g++]=w,_=0,w=0))}h=!h}if(g!==i.getTotalCodewords())throw new M;return d}remask(){if(this.parsedFormatInfo===null)return;const a=ha.values[this.parsedFormatInfo.getDataMask()],i=this.bitMatrix.getHeight();a.unmaskBitMatrix(this.bitMatrix,i)}setMirror(a){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=a}mirror(){const a=this.bitMatrix;for(let i=0,c=a.getWidth();i<c;i++)for(let o=i+1,l=a.getHeight();o<l;o++)a.get(i,o)!==a.get(o,i)&&(a.flip(o,i),a.flip(i,o))}}class hi{constructor(a,i){this.numDataCodewords=a,this.codewords=i}static getDataBlocks(a,i,c){if(a.length!==i.getTotalCodewords())throw new E;const o=i.getECBlocksForLevel(c);let l=0;const h=o.getECBlocks();for(const L of h)l+=L.getCount();const d=new Array(l);let g=0;for(const L of h)for(let W=0;W<L.getCount();W++){const te=L.getDataCodewords(),se=o.getECCodewordsPerBlock()+te;d[g++]=new hi(te,new Uint8Array(se))}const w=d[0].codewords.length;let _=d.length-1;for(;_>=0&&d[_].codewords.length!==w;)_--;_++;const C=w-o.getECCodewordsPerBlock();let T=0;for(let L=0;L<C;L++)for(let W=0;W<g;W++)d[W].codewords[L]=a[T++];for(let L=_;L<g;L++)d[L].codewords[C]=a[T++];const R=d[0].codewords.length;for(let L=C;L<R;L++)for(let W=0;W<g;W++){const te=W<_?L:L+1;d[W].codewords[te]=a[T++]}return d}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var va;(function(I){I[I.TERMINATOR=0]="TERMINATOR",I[I.NUMERIC=1]="NUMERIC",I[I.ALPHANUMERIC=2]="ALPHANUMERIC",I[I.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",I[I.BYTE=4]="BYTE",I[I.ECI=5]="ECI",I[I.KANJI=6]="KANJI",I[I.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",I[I.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",I[I.HANZI=9]="HANZI"})(va||(va={}));class Ze{constructor(a,i,c,o){this.value=a,this.stringValue=i,this.characterCountBitsForVersions=c,this.bits=o,Ze.FOR_BITS.set(o,this),Ze.FOR_VALUE.set(a,this)}static forBits(a){const i=Ze.FOR_BITS.get(a);if(i===void 0)throw new E;return i}getCharacterCountBits(a){const i=a.getVersionNumber();let c;return i<=9?c=0:i<=26?c=1:c=2,this.characterCountBitsForVersions[c]}getValue(){return this.value}getBits(){return this.bits}equals(a){if(!(a instanceof Ze))return!1;const i=a;return this.value===i.value}toString(){return this.stringValue}}Ze.FOR_BITS=new Map,Ze.FOR_VALUE=new Map,Ze.TERMINATOR=new Ze(va.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Ze.NUMERIC=new Ze(va.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Ze.ALPHANUMERIC=new Ze(va.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Ze.STRUCTURED_APPEND=new Ze(va.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Ze.BYTE=new Ze(va.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Ze.ECI=new Ze(va.ECI,"ECI",Int32Array.from([0,0,0]),7),Ze.KANJI=new Ze(va.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Ze.FNC1_FIRST_POSITION=new Ze(va.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Ze.FNC1_SECOND_POSITION=new Ze(va.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Ze.HANZI=new Ze(va.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class rr{static decode(a,i,c,o){const l=new g0(a);let h=new pe;const d=new Array;let g=-1,w=-1;try{let _=null,C=!1,T;do{if(l.available()<4)T=Ze.TERMINATOR;else{const R=l.readBits(4);T=Ze.forBits(R)}switch(T){case Ze.TERMINATOR:break;case Ze.FNC1_FIRST_POSITION:case Ze.FNC1_SECOND_POSITION:C=!0;break;case Ze.STRUCTURED_APPEND:if(l.available()<16)throw new M;g=l.readBits(8),w=l.readBits(8);break;case Ze.ECI:const R=rr.parseECIValue(l);if(_=X.getCharacterSetECIByValue(R),_===null)throw new M;break;case Ze.HANZI:const L=l.readBits(4),W=l.readBits(T.getCharacterCountBits(i));L===rr.GB2312_SUBSET&&rr.decodeHanziSegment(l,h,W);break;default:const te=l.readBits(T.getCharacterCountBits(i));switch(T){case Ze.NUMERIC:rr.decodeNumericSegment(l,h,te);break;case Ze.ALPHANUMERIC:rr.decodeAlphanumericSegment(l,h,te,C);break;case Ze.BYTE:rr.decodeByteSegment(l,h,te,_,d,o);break;case Ze.KANJI:rr.decodeKanjiSegment(l,h,te);break;default:throw new M}break}}while(T!==Ze.TERMINATOR)}catch{throw new M}return new ve(a,h.toString(),d.length===0?null:d,c===null?null:c.toString(),g,w)}static decodeHanziSegment(a,i,c){if(c*13>a.available())throw new M;const o=new Uint8Array(2*c);let l=0;for(;c>0;){const h=a.readBits(13);let d=h/96<<8&4294967295|h%96;d<959?d+=41377:d+=42657,o[l]=d>>8&255,o[l+1]=d&255,l+=2,c--}try{i.append(le.decode(o,ee.GB2312))}catch(h){throw new M(h)}}static decodeKanjiSegment(a,i,c){if(c*13>a.available())throw new M;const o=new Uint8Array(2*c);let l=0;for(;c>0;){const h=a.readBits(13);let d=h/192<<8&4294967295|h%192;d<7936?d+=33088:d+=49472,o[l]=d>>8,o[l+1]=d,l+=2,c--}try{i.append(le.decode(o,ee.SHIFT_JIS))}catch(h){throw new M(h)}}static decodeByteSegment(a,i,c,o,l,h){if(8*c>a.available())throw new M;const d=new Uint8Array(c);for(let w=0;w<c;w++)d[w]=a.readBits(8);let g;o===null?g=ee.guessEncoding(d,h):g=o.getName();try{i.append(le.decode(d,g))}catch(w){throw new M(w)}l.push(d)}static toAlphaNumericChar(a){if(a>=rr.ALPHANUMERIC_CHARS.length)throw new M;return rr.ALPHANUMERIC_CHARS[a]}static decodeAlphanumericSegment(a,i,c,o){const l=i.length();for(;c>1;){if(a.available()<11)throw new M;const h=a.readBits(11);i.append(rr.toAlphaNumericChar(Math.floor(h/45))),i.append(rr.toAlphaNumericChar(h%45)),c-=2}if(c===1){if(a.available()<6)throw new M;i.append(rr.toAlphaNumericChar(a.readBits(6)))}if(o)for(let h=l;h<i.length();h++)i.charAt(h)==="%"&&(h<i.length()-1&&i.charAt(h+1)==="%"?i.deleteCharAt(h+1):i.setCharAt(h,""))}static decodeNumericSegment(a,i,c){for(;c>=3;){if(a.available()<10)throw new M;const o=a.readBits(10);if(o>=1e3)throw new M;i.append(rr.toAlphaNumericChar(Math.floor(o/100))),i.append(rr.toAlphaNumericChar(Math.floor(o/10)%10)),i.append(rr.toAlphaNumericChar(o%10)),c-=3}if(c===2){if(a.available()<7)throw new M;const o=a.readBits(7);if(o>=100)throw new M;i.append(rr.toAlphaNumericChar(Math.floor(o/10))),i.append(rr.toAlphaNumericChar(o%10))}else if(c===1){if(a.available()<4)throw new M;const o=a.readBits(4);if(o>=10)throw new M;i.append(rr.toAlphaNumericChar(o))}}static parseECIValue(a){const i=a.readBits(8);if(!(i&128))return i&127;if((i&192)===128){const c=a.readBits(8);return(i&63)<<8&4294967295|c}if((i&224)===192){const c=a.readBits(16);return(i&31)<<16&4294967295|c}throw new M}}rr.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",rr.GB2312_SUBSET=1;class m0{constructor(a){this.mirrored=a}isMirrored(){return this.mirrored}applyMirroredCorrection(a){if(!this.mirrored||a===null||a.length<3)return;const i=a[0];a[0]=a[2],a[2]=i}}class ws{constructor(){this.rsDecoder=new ct(Ke.QR_CODE_FIELD_256)}decodeBooleanArray(a,i){return this.decodeBitMatrix(Pe.parseFromBooleanArray(a),i)}decodeBitMatrix(a,i){const c=new No(a);let o=null;try{return this.decodeBitMatrixParser(c,i)}catch(l){o=l}try{c.remask(),c.setMirror(!0),c.readVersion(),c.readFormatInformation(),c.mirror();const l=this.decodeBitMatrixParser(c,i);return l.setOther(new m0(!0)),l}catch(l){throw o!==null?o:l}}decodeBitMatrixParser(a,i){const c=a.readVersion(),o=a.readFormatInformation().getErrorCorrectionLevel(),l=a.readCodewords(),h=hi.getDataBlocks(l,c,o);let d=0;for(const _ of h)d+=_.getNumDataCodewords();const g=new Uint8Array(d);let w=0;for(const _ of h){const C=_.getCodewords(),T=_.getNumDataCodewords();this.correctErrors(C,T);for(let R=0;R<T;R++)g[w++]=C[R]}return rr.decode(g,c,o,i)}correctErrors(a,i){const c=new Int32Array(a);try{this.rsDecoder.decode(c,a.length-i)}catch{throw new S}for(let o=0;o<i;o++)a[o]=c[o]}}class ui extends We{constructor(a,i,c){super(a,i),this.estimatedModuleSize=c}aboutEquals(a,i,c){if(Math.abs(i-this.getY())<=a&&Math.abs(c-this.getX())<=a){const o=Math.abs(a-this.estimatedModuleSize);return o<=1||o<=this.estimatedModuleSize}return!1}combineEstimate(a,i,c){const o=(this.getX()+i)/2,l=(this.getY()+a)/2,h=(this.estimatedModuleSize+c)/2;return new ui(o,l,h)}}class di{constructor(a,i,c,o,l,h,d){this.image=a,this.startX=i,this.startY=c,this.width=o,this.height=l,this.moduleSize=h,this.resultPointCallback=d,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const a=this.startX,i=this.height,c=this.width,o=a+c,l=this.startY+i/2,h=new Int32Array(3),d=this.image;for(let g=0;g<i;g++){const w=l+(g&1?-Math.floor((g+1)/2):Math.floor((g+1)/2));h[0]=0,h[1]=0,h[2]=0;let _=a;for(;_<o&&!d.get(_,w);)_++;let C=0;for(;_<o;){if(d.get(_,w))if(C===1)h[1]++;else if(C===2){if(this.foundPatternCross(h)){const T=this.handlePossibleCenter(h,w,_);if(T!==null)return T}h[0]=h[2],h[1]=1,h[2]=0,C=1}else h[++C]++;else C===1&&C++,h[C]++;_++}if(this.foundPatternCross(h)){const T=this.handlePossibleCenter(h,w,o);if(T!==null)return T}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new re}static centerFromEnd(a,i){return i-a[2]-a[1]/2}foundPatternCross(a){const i=this.moduleSize,c=i/2;for(let o=0;o<3;o++)if(Math.abs(i-a[o])>=c)return!1;return!0}crossCheckVertical(a,i,c,o){const l=this.image,h=l.getHeight(),d=this.crossCheckStateCount;d[0]=0,d[1]=0,d[2]=0;let g=a;for(;g>=0&&l.get(i,g)&&d[1]<=c;)d[1]++,g--;if(g<0||d[1]>c)return NaN;for(;g>=0&&!l.get(i,g)&&d[0]<=c;)d[0]++,g--;if(d[0]>c)return NaN;for(g=a+1;g<h&&l.get(i,g)&&d[1]<=c;)d[1]++,g++;if(g===h||d[1]>c)return NaN;for(;g<h&&!l.get(i,g)&&d[2]<=c;)d[2]++,g++;if(d[2]>c)return NaN;const w=d[0]+d[1]+d[2];return 5*Math.abs(w-o)>=2*o?NaN:this.foundPatternCross(d)?di.centerFromEnd(d,g):NaN}handlePossibleCenter(a,i,c){const o=a[0]+a[1]+a[2],l=di.centerFromEnd(a,c),h=this.crossCheckVertical(i,l,2*a[1],o);if(!isNaN(h)){const d=(a[0]+a[1]+a[2])/3;for(const w of this.possibleCenters)if(w.aboutEquals(d,h,l))return w.combineEstimate(h,l,d);const g=new ui(l,h,d);this.possibleCenters.push(g),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(g)}return null}}class vs extends We{constructor(a,i,c,o){super(a,i),this.estimatedModuleSize=c,this.count=o,o===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(a,i,c){if(Math.abs(i-this.getY())<=a&&Math.abs(c-this.getX())<=a){const o=Math.abs(a-this.estimatedModuleSize);return o<=1||o<=this.estimatedModuleSize}return!1}combineEstimate(a,i,c){const o=this.count+1,l=(this.count*this.getX()+i)/o,h=(this.count*this.getY()+a)/o,d=(this.count*this.estimatedModuleSize+c)/o;return new vs(l,h,d,o)}}class ko{constructor(a){this.bottomLeft=a[0],this.topLeft=a[1],this.topRight=a[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Fr{constructor(a,i){this.image=a,this.resultPointCallback=i,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=i}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(a){const i=a!=null&&a.get(Q.TRY_HARDER)!==void 0,c=a!=null&&a.get(Q.PURE_BARCODE)!==void 0,o=this.image,l=o.getHeight(),h=o.getWidth();let d=Math.floor(3*l/(4*Fr.MAX_MODULES));(d<Fr.MIN_SKIP||i)&&(d=Fr.MIN_SKIP);let g=!1;const w=new Int32Array(5);for(let C=d-1;C<l&&!g;C+=d){w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0;let T=0;for(let R=0;R<h;R++)if(o.get(R,C))(T&1)===1&&T++,w[T]++;else if(T&1)w[T]++;else if(T===4)if(Fr.foundPatternCross(w)){if(this.handlePossibleCenter(w,C,R,c)===!0)if(d=2,this.hasSkipped===!0)g=this.haveMultiplyConfirmedCenters();else{const W=this.findRowSkip();W>w[2]&&(C+=W-w[2]-d,R=h-1)}else{w[0]=w[2],w[1]=w[3],w[2]=w[4],w[3]=1,w[4]=0,T=3;continue}T=0,w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0}else w[0]=w[2],w[1]=w[3],w[2]=w[4],w[3]=1,w[4]=0,T=3;else w[++T]++;Fr.foundPatternCross(w)&&this.handlePossibleCenter(w,C,h,c)===!0&&(d=w[0],this.hasSkipped&&(g=this.haveMultiplyConfirmedCenters()))}const _=this.selectBestPatterns();return We.orderBestPatterns(_),new ko(_)}static centerFromEnd(a,i){return i-a[4]-a[3]-a[2]/2}static foundPatternCross(a){let i=0;for(let l=0;l<5;l++){const h=a[l];if(h===0)return!1;i+=h}if(i<7)return!1;const c=i/7,o=c/2;return Math.abs(c-a[0])<o&&Math.abs(c-a[1])<o&&Math.abs(3*c-a[2])<3*o&&Math.abs(c-a[3])<o&&Math.abs(c-a[4])<o}getCrossCheckStateCount(){const a=this.crossCheckStateCount;return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a}crossCheckDiagonal(a,i,c,o){const l=this.getCrossCheckStateCount();let h=0;const d=this.image;for(;a>=h&&i>=h&&d.get(i-h,a-h);)l[2]++,h++;if(a<h||i<h)return!1;for(;a>=h&&i>=h&&!d.get(i-h,a-h)&&l[1]<=c;)l[1]++,h++;if(a<h||i<h||l[1]>c)return!1;for(;a>=h&&i>=h&&d.get(i-h,a-h)&&l[0]<=c;)l[0]++,h++;if(l[0]>c)return!1;const g=d.getHeight(),w=d.getWidth();for(h=1;a+h<g&&i+h<w&&d.get(i+h,a+h);)l[2]++,h++;if(a+h>=g||i+h>=w)return!1;for(;a+h<g&&i+h<w&&!d.get(i+h,a+h)&&l[3]<c;)l[3]++,h++;if(a+h>=g||i+h>=w||l[3]>=c)return!1;for(;a+h<g&&i+h<w&&d.get(i+h,a+h)&&l[4]<c;)l[4]++,h++;if(l[4]>=c)return!1;const _=l[0]+l[1]+l[2]+l[3]+l[4];return Math.abs(_-o)<2*o&&Fr.foundPatternCross(l)}crossCheckVertical(a,i,c,o){const l=this.image,h=l.getHeight(),d=this.getCrossCheckStateCount();let g=a;for(;g>=0&&l.get(i,g);)d[2]++,g--;if(g<0)return NaN;for(;g>=0&&!l.get(i,g)&&d[1]<=c;)d[1]++,g--;if(g<0||d[1]>c)return NaN;for(;g>=0&&l.get(i,g)&&d[0]<=c;)d[0]++,g--;if(d[0]>c)return NaN;for(g=a+1;g<h&&l.get(i,g);)d[2]++,g++;if(g===h)return NaN;for(;g<h&&!l.get(i,g)&&d[3]<c;)d[3]++,g++;if(g===h||d[3]>=c)return NaN;for(;g<h&&l.get(i,g)&&d[4]<c;)d[4]++,g++;if(d[4]>=c)return NaN;const w=d[0]+d[1]+d[2]+d[3]+d[4];return 5*Math.abs(w-o)>=2*o?NaN:Fr.foundPatternCross(d)?Fr.centerFromEnd(d,g):NaN}crossCheckHorizontal(a,i,c,o){const l=this.image,h=l.getWidth(),d=this.getCrossCheckStateCount();let g=a;for(;g>=0&&l.get(g,i);)d[2]++,g--;if(g<0)return NaN;for(;g>=0&&!l.get(g,i)&&d[1]<=c;)d[1]++,g--;if(g<0||d[1]>c)return NaN;for(;g>=0&&l.get(g,i)&&d[0]<=c;)d[0]++,g--;if(d[0]>c)return NaN;for(g=a+1;g<h&&l.get(g,i);)d[2]++,g++;if(g===h)return NaN;for(;g<h&&!l.get(g,i)&&d[3]<c;)d[3]++,g++;if(g===h||d[3]>=c)return NaN;for(;g<h&&l.get(g,i)&&d[4]<c;)d[4]++,g++;if(d[4]>=c)return NaN;const w=d[0]+d[1]+d[2]+d[3]+d[4];return 5*Math.abs(w-o)>=o?NaN:Fr.foundPatternCross(d)?Fr.centerFromEnd(d,g):NaN}handlePossibleCenter(a,i,c,o){const l=a[0]+a[1]+a[2]+a[3]+a[4];let h=Fr.centerFromEnd(a,c),d=this.crossCheckVertical(i,Math.floor(h),a[2],l);if(!isNaN(d)&&(h=this.crossCheckHorizontal(Math.floor(h),Math.floor(d),a[2],l),!isNaN(h)&&(!o||this.crossCheckDiagonal(Math.floor(d),Math.floor(h),a[2],l)))){const g=l/7;let w=!1;const _=this.possibleCenters;for(let C=0,T=_.length;C<T;C++){const R=_[C];if(R.aboutEquals(g,d,h)){_[C]=R.combineEstimate(d,h,g),w=!0;break}}if(!w){const C=new vs(h,d,g);_.push(C),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(C)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let i=null;for(const c of this.possibleCenters)if(c.getCount()>=Fr.CENTER_QUORUM)if(i==null)i=c;else return this.hasSkipped=!0,Math.floor((Math.abs(i.getX()-c.getX())-Math.abs(i.getY()-c.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let a=0,i=0;const c=this.possibleCenters.length;for(const h of this.possibleCenters)h.getCount()>=Fr.CENTER_QUORUM&&(a++,i+=h.getEstimatedModuleSize());if(a<3)return!1;const o=i/c;let l=0;for(const h of this.possibleCenters)l+=Math.abs(h.getEstimatedModuleSize()-o);return l<=.05*i}selectBestPatterns(){const a=this.possibleCenters.length;if(a<3)throw new re;const i=this.possibleCenters;let c;if(a>3){let o=0,l=0;for(const g of this.possibleCenters){const w=g.getEstimatedModuleSize();o+=w,l+=w*w}c=o/a;let h=Math.sqrt(l/a-c*c);i.sort((g,w)=>{const _=Math.abs(w.getEstimatedModuleSize()-c),C=Math.abs(g.getEstimatedModuleSize()-c);return _<C?-1:_>C?1:0});const d=Math.max(.2*c,h);for(let g=0;g<i.length&&i.length>3;g++){const w=i[g];Math.abs(w.getEstimatedModuleSize()-c)>d&&(i.splice(g,1),g--)}}if(i.length>3){let o=0;for(const l of i)o+=l.getEstimatedModuleSize();c=o/i.length,i.sort((l,h)=>{if(h.getCount()===l.getCount()){const d=Math.abs(h.getEstimatedModuleSize()-c),g=Math.abs(l.getEstimatedModuleSize()-c);return d<g?1:d>g?-1:0}else return h.getCount()-l.getCount()}),i.splice(3)}return[i[0],i[1],i[2]]}}Fr.CENTER_QUORUM=2,Fr.MIN_SKIP=3,Fr.MAX_MODULES=57;class xi{constructor(a){this.image=a}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(a){this.resultPointCallback=a==null?null:a.get(Q.NEED_RESULT_POINT_CALLBACK);const c=new Fr(this.image,this.resultPointCallback).find(a);return this.processFinderPatternInfo(c)}processFinderPatternInfo(a){const i=a.getTopLeft(),c=a.getTopRight(),o=a.getBottomLeft(),l=this.calculateModuleSize(i,c,o);if(l<1)throw new re("No pattern found in proccess finder.");const h=xi.computeDimension(i,c,o,l),d=qe.getProvisionalVersionForDimension(h),g=d.getDimensionForVersion()-7;let w=null;if(d.getAlignmentPatternCenters().length>0){const R=c.getX()-i.getX()+o.getX(),L=c.getY()-i.getY()+o.getY(),W=1-3/g,te=Math.floor(i.getX()+W*(R-i.getX())),se=Math.floor(i.getY()+W*(L-i.getY()));for(let Ce=4;Ce<=16;Ce<<=1)try{w=this.findAlignmentInRegion(l,te,se,Ce);break}catch(Te){if(!(Te instanceof re))throw Te}}const _=xi.createTransform(i,c,o,w,h),C=xi.sampleGrid(this.image,_,h);let T;return w===null?T=[o,i,c]:T=[o,i,c,w],new br(C,T)}static createTransform(a,i,c,o,l){const h=l-3.5;let d,g,w,_;return o!==null?(d=o.getX(),g=o.getY(),w=h-3,_=w):(d=i.getX()-a.getX()+c.getX(),g=i.getY()-a.getY()+c.getY(),w=h,_=h),xr.quadrilateralToQuadrilateral(3.5,3.5,h,3.5,w,_,3.5,h,a.getX(),a.getY(),i.getX(),i.getY(),d,g,c.getX(),c.getY())}static sampleGrid(a,i,c){return Jt.getInstance().sampleGridWithTransform(a,c,c,i)}static computeDimension(a,i,c,o){const l=nt.round(We.distance(a,i)/o),h=nt.round(We.distance(a,c)/o);let d=Math.floor((l+h)/2)+7;switch(d&3){case 0:d++;break;case 2:d--;break;case 3:throw new re("Dimensions could be not found.")}return d}calculateModuleSize(a,i,c){return(this.calculateModuleSizeOneWay(a,i)+this.calculateModuleSizeOneWay(a,c))/2}calculateModuleSizeOneWay(a,i){const c=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(a.getX()),Math.floor(a.getY()),Math.floor(i.getX()),Math.floor(i.getY())),o=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(i.getX()),Math.floor(i.getY()),Math.floor(a.getX()),Math.floor(a.getY()));return isNaN(c)?o/7:isNaN(o)?c/7:(c+o)/14}sizeOfBlackWhiteBlackRunBothWays(a,i,c,o){let l=this.sizeOfBlackWhiteBlackRun(a,i,c,o),h=1,d=a-(c-a);d<0?(h=a/(a-d),d=0):d>=this.image.getWidth()&&(h=(this.image.getWidth()-1-a)/(d-a),d=this.image.getWidth()-1);let g=Math.floor(i-(o-i)*h);return h=1,g<0?(h=i/(i-g),g=0):g>=this.image.getHeight()&&(h=(this.image.getHeight()-1-i)/(g-i),g=this.image.getHeight()-1),d=Math.floor(a+(d-a)*h),l+=this.sizeOfBlackWhiteBlackRun(a,i,d,g),l-1}sizeOfBlackWhiteBlackRun(a,i,c,o){const l=Math.abs(o-i)>Math.abs(c-a);if(l){let R=a;a=i,i=R,R=c,c=o,o=R}const h=Math.abs(c-a),d=Math.abs(o-i);let g=-h/2;const w=a<c?1:-1,_=i<o?1:-1;let C=0;const T=c+w;for(let R=a,L=i;R!==T;R+=w){const W=l?L:R,te=l?R:L;if(C===1===this.image.get(W,te)){if(C===2)return nt.distance(R,L,a,i);C++}if(g+=d,g>0){if(L===o)break;L+=_,g-=h}}return C===2?nt.distance(c+w,o,a,i):NaN}findAlignmentInRegion(a,i,c,o){const l=Math.floor(o*a),h=Math.max(0,i-l),d=Math.min(this.image.getWidth()-1,i+l);if(d-h<a*3)throw new re("Alignment top exceeds estimated module size.");const g=Math.max(0,c-l),w=Math.min(this.image.getHeight()-1,c+l);if(w-g<a*3)throw new re("Alignment bottom exceeds estimated module size.");return new di(this.image,h,g,d-h,w-g,a,this.resultPointCallback).find()}}class ua{constructor(){this.decoder=new ws}getDecoder(){return this.decoder}decode(a,i){let c,o;if(i!=null&&i.get(Q.PURE_BARCODE)!==void 0){const g=ua.extractPureBits(a.getBlackMatrix());c=this.decoder.decodeBitMatrix(g,i),o=ua.NO_POINTS}else{const g=new xi(a.getBlackMatrix()).detect(i);c=this.decoder.decodeBitMatrix(g.getBits(),i),o=g.getPoints()}c.getOther()instanceof m0&&c.getOther().applyMirroredCorrection(o);const l=new z(c.getText(),c.getRawBytes(),void 0,o,B.QR_CODE,void 0),h=c.getByteSegments();h!==null&&l.putMetadata(we.BYTE_SEGMENTS,h);const d=c.getECLevel();return d!==null&&l.putMetadata(we.ERROR_CORRECTION_LEVEL,d),c.hasStructuredAppend()&&(l.putMetadata(we.STRUCTURED_APPEND_SEQUENCE,c.getStructuredAppendSequenceNumber()),l.putMetadata(we.STRUCTURED_APPEND_PARITY,c.getStructuredAppendParity())),l}reset(){}static extractPureBits(a){const i=a.getTopLeftOnBit(),c=a.getBottomRightOnBit();if(i===null||c===null)throw new re;const o=this.moduleSize(i,a);let l=i[1],h=c[1],d=i[0],g=c[0];if(d>=g||l>=h)throw new re;if(h-l!==g-d&&(g=d+(h-l),g>=a.getWidth()))throw new re;const w=Math.round((g-d+1)/o),_=Math.round((h-l+1)/o);if(w<=0||_<=0)throw new re;if(_!==w)throw new re;const C=Math.floor(o/2);l+=C,d+=C;const T=d+Math.floor((w-1)*o)-g;if(T>0){if(T>C)throw new re;d-=T}const R=l+Math.floor((_-1)*o)-h;if(R>0){if(R>C)throw new re;l-=R}const L=new Pe(w,_);for(let W=0;W<_;W++){const te=l+Math.floor(W*o);for(let se=0;se<w;se++)a.get(d+Math.floor(se*o),te)&&L.set(se,W)}return L}static moduleSize(a,i){const c=i.getHeight(),o=i.getWidth();let l=a[0],h=a[1],d=!0,g=0;for(;l<o&&h<c;){if(d!==i.get(l,h)){if(++g===5)break;d=!d}l++,h++}if(l===o||h===c)throw new re;return(l-a[0])/7}}ua.NO_POINTS=new Array;class rt{PDF417Common(){}static getBitCountSum(a){return nt.sum(a)}static toIntArray(a){if(a==null||!a.length)return rt.EMPTY_INT_ARRAY;const i=new Int32Array(a.length);let c=0;for(const o of a)i[c++]=o;return i}static getCodeword(a){const i=G.binarySearch(rt.SYMBOL_TABLE,a&262143);return i<0?-1:(rt.CODEWORD_TABLE[i]-1)%rt.NUMBER_OF_CODEWORDS}}rt.NUMBER_OF_CODEWORDS=929,rt.MAX_CODEWORDS_IN_BARCODE=rt.NUMBER_OF_CODEWORDS-1,rt.MIN_ROWS_IN_BARCODE=3,rt.MAX_ROWS_IN_BARCODE=90,rt.MODULES_IN_CODEWORD=17,rt.MODULES_IN_STOP_PATTERN=18,rt.BARS_IN_MODULE=8,rt.EMPTY_INT_ARRAY=new Int32Array([]),rt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),rt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Io{constructor(a,i){this.bits=a,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class dt{static detectMultiple(a,i,c){let o=a.getBlackMatrix(),l=dt.detect(c,o);return l.length||(o=o.clone(),o.rotate180(),l=dt.detect(c,o)),new Io(o,l)}static detect(a,i){const c=new Array;let o=0,l=0,h=!1;for(;o<i.getHeight();){const d=dt.findVertices(i,o,l);if(d[0]==null&&d[3]==null){if(!h)break;h=!1,l=0;for(const g of c)g[1]!=null&&(o=Math.trunc(Math.max(o,g[1].getY()))),g[3]!=null&&(o=Math.max(o,Math.trunc(g[3].getY())));o+=dt.ROW_STEP;continue}if(h=!0,c.push(d),!a)break;d[2]!=null?(l=Math.trunc(d[2].getX()),o=Math.trunc(d[2].getY())):(l=Math.trunc(d[4].getX()),o=Math.trunc(d[4].getY()))}return c}static findVertices(a,i,c){const o=a.getHeight(),l=a.getWidth(),h=new Array(8);return dt.copyToResult(h,dt.findRowsWithPattern(a,o,l,i,c,dt.START_PATTERN),dt.INDEXES_START_PATTERN),h[4]!=null&&(c=Math.trunc(h[4].getX()),i=Math.trunc(h[4].getY())),dt.copyToResult(h,dt.findRowsWithPattern(a,o,l,i,c,dt.STOP_PATTERN),dt.INDEXES_STOP_PATTERN),h}static copyToResult(a,i,c){for(let o=0;o<c.length;o++)a[c[o]]=i[o]}static findRowsWithPattern(a,i,c,o,l,h){const d=new Array(4);let g=!1;const w=new Int32Array(h.length);for(;o<i;o+=dt.ROW_STEP){let C=dt.findGuardPattern(a,l,o,c,!1,h,w);if(C!=null){for(;o>0;){const T=dt.findGuardPattern(a,l,--o,c,!1,h,w);if(T!=null)C=T;else{o++;break}}d[0]=new We(C[0],o),d[1]=new We(C[1],o),g=!0;break}}let _=o+1;if(g){let C=0,T=Int32Array.from([Math.trunc(d[0].getX()),Math.trunc(d[1].getX())]);for(;_<i;_++){const R=dt.findGuardPattern(a,T[0],_,c,!1,h,w);if(R!=null&&Math.abs(T[0]-R[0])<dt.MAX_PATTERN_DRIFT&&Math.abs(T[1]-R[1])<dt.MAX_PATTERN_DRIFT)T=R,C=0;else{if(C>dt.SKIPPED_ROW_COUNT_MAX)break;C++}}_-=C+1,d[2]=new We(T[0],_),d[3]=new We(T[1],_)}return _-o<dt.BARCODE_MIN_HEIGHT&&G.fill(d,null),d}static findGuardPattern(a,i,c,o,l,h,d){G.fillWithin(d,0,d.length,0);let g=i,w=0;for(;a.get(g,c)&&g>0&&w++<dt.MAX_PIXEL_DRIFT;)g--;let _=g,C=0,T=h.length;for(let R=l;_<o;_++)if(a.get(_,c)!==R)d[C]++;else{if(C===T-1){if(dt.patternMatchVariance(d,h,dt.MAX_INDIVIDUAL_VARIANCE)<dt.MAX_AVG_VARIANCE)return new Int32Array([g,_]);g+=d[0]+d[1],A.arraycopy(d,2,d,0,C-1),d[C-1]=0,d[C]=0,C--}else C++;d[C]=1,R=!R}return C===T-1&&dt.patternMatchVariance(d,h,dt.MAX_INDIVIDUAL_VARIANCE)<dt.MAX_AVG_VARIANCE?new Int32Array([g,_-1]):null}static patternMatchVariance(a,i,c){let o=a.length,l=0,h=0;for(let w=0;w<o;w++)l+=a[w],h+=i[w];if(l<h)return 1/0;let d=l/h;c*=d;let g=0;for(let w=0;w<o;w++){let _=a[w],C=i[w]*d,T=_>C?_-C:C-_;if(T>c)return 1/0;g+=T}return g/l}}dt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),dt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),dt.MAX_AVG_VARIANCE=.42,dt.MAX_INDIVIDUAL_VARIANCE=.8,dt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),dt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),dt.MAX_PIXEL_DRIFT=3,dt.MAX_PATTERN_DRIFT=5,dt.SKIPPED_ROW_COUNT_MAX=25,dt.ROW_STEP=5,dt.BARCODE_MIN_HEIGHT=10;class Dr{constructor(a,i){if(i.length===0)throw new E;this.field=a;let c=i.length;if(c>1&&i[0]===0){let o=1;for(;o<c&&i[o]===0;)o++;o===c?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(c-o),A.arraycopy(i,o,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(a){return this.coefficients[this.coefficients.length-1-a]}evaluateAt(a){if(a===0)return this.getCoefficient(0);if(a===1){let o=0;for(let l of this.coefficients)o=this.field.add(o,l);return o}let i=this.coefficients[0],c=this.coefficients.length;for(let o=1;o<c;o++)i=this.field.add(this.field.multiply(a,i),this.coefficients[o]);return i}add(a){if(!this.field.equals(a.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero())return a;if(a.isZero())return this;let i=this.coefficients,c=a.coefficients;if(i.length>c.length){let h=i;i=c,c=h}let o=new Int32Array(c.length),l=c.length-i.length;A.arraycopy(c,0,o,0,l);for(let h=l;h<c.length;h++)o[h]=this.field.add(i[h-l],c[h]);return new Dr(this.field,o)}subtract(a){if(!this.field.equals(a.field))throw new E("ModulusPolys do not have same ModulusGF field");return a.isZero()?this:this.add(a.negative())}multiply(a){return a instanceof Dr?this.multiplyOther(a):this.multiplyScalar(a)}multiplyOther(a){if(!this.field.equals(a.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero()||a.isZero())return new Dr(this.field,new Int32Array([0]));let i=this.coefficients,c=i.length,o=a.coefficients,l=o.length,h=new Int32Array(c+l-1);for(let d=0;d<c;d++){let g=i[d];for(let w=0;w<l;w++)h[d+w]=this.field.add(h[d+w],this.field.multiply(g,o[w]))}return new Dr(this.field,h)}negative(){let a=this.coefficients.length,i=new Int32Array(a);for(let c=0;c<a;c++)i[c]=this.field.subtract(0,this.coefficients[c]);return new Dr(this.field,i)}multiplyScalar(a){if(a===0)return new Dr(this.field,new Int32Array([0]));if(a===1)return this;let i=this.coefficients.length,c=new Int32Array(i);for(let o=0;o<i;o++)c[o]=this.field.multiply(this.coefficients[o],a);return new Dr(this.field,c)}multiplyByMonomial(a,i){if(a<0)throw new E;if(i===0)return new Dr(this.field,new Int32Array([0]));let c=this.coefficients.length,o=new Int32Array(c+a);for(let l=0;l<c;l++)o[l]=this.field.multiply(this.coefficients[l],i);return new Dr(this.field,o)}toString(){let a=new pe;for(let i=this.getDegree();i>=0;i--){let c=this.getCoefficient(i);c!==0&&(c<0?(a.append(" - "),c=-c):a.length()>0&&a.append(" + "),(i===0||c!==1)&&a.append(c),i!==0&&(i===1?a.append("x"):(a.append("x^"),a.append(i))))}return a.toString()}}class p0{add(a,i){return(a+i)%this.modulus}subtract(a,i){return(this.modulus+a-i)%this.modulus}exp(a){return this.expTable[a]}log(a){if(a===0)throw new E;return this.logTable[a]}inverse(a){if(a===0)throw new Z;return this.expTable[this.modulus-this.logTable[a]-1]}multiply(a,i){return a===0||i===0?0:this.expTable[(this.logTable[a]+this.logTable[i])%(this.modulus-1)]}getSize(){return this.modulus}equals(a){return a===this}}class ji extends p0{constructor(a,i){super(),this.modulus=a,this.expTable=new Int32Array(a),this.logTable=new Int32Array(a);let c=1;for(let o=0;o<a;o++)this.expTable[o]=c,c=c*i%a;for(let o=0;o<a-1;o++)this.logTable[this.expTable[o]]=o;this.zero=new Dr(this,new Int32Array([0])),this.one=new Dr(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(a,i){if(a<0)throw new E;if(i===0)return this.zero;let c=new Int32Array(a+1);return c[0]=i,new Dr(this,c)}}ji.PDF417_GF=new ji(rt.NUMBER_OF_CODEWORDS,3);class w0{constructor(){this.field=ji.PDF417_GF}decode(a,i,c){let o=new Dr(this.field,a),l=new Int32Array(i),h=!1;for(let L=i;L>0;L--){let W=o.evaluateAt(this.field.exp(L));l[i-L]=W,W!==0&&(h=!0)}if(!h)return 0;let d=this.field.getOne();if(c!=null)for(const L of c){let W=this.field.exp(a.length-1-L),te=new Dr(this.field,new Int32Array([this.field.subtract(0,W),1]));d=d.multiply(te)}let g=new Dr(this.field,l),w=this.runEuclideanAlgorithm(this.field.buildMonomial(i,1),g,i),_=w[0],C=w[1],T=this.findErrorLocations(_),R=this.findErrorMagnitudes(C,_,T);for(let L=0;L<T.length;L++){let W=a.length-1-this.field.log(T[L]);if(W<0)throw S.getChecksumInstance();a[W]=this.field.subtract(a[W],R[L])}return T.length}runEuclideanAlgorithm(a,i,c){if(a.getDegree()<i.getDegree()){let T=a;a=i,i=T}let o=a,l=i,h=this.field.getZero(),d=this.field.getOne();for(;l.getDegree()>=Math.round(c/2);){let T=o,R=h;if(o=l,h=d,o.isZero())throw S.getChecksumInstance();l=T;let L=this.field.getZero(),W=o.getCoefficient(o.getDegree()),te=this.field.inverse(W);for(;l.getDegree()>=o.getDegree()&&!l.isZero();){let se=l.getDegree()-o.getDegree(),Ce=this.field.multiply(l.getCoefficient(l.getDegree()),te);L=L.add(this.field.buildMonomial(se,Ce)),l=l.subtract(o.multiplyByMonomial(se,Ce))}d=L.multiply(h).subtract(R).negative()}let g=d.getCoefficient(0);if(g===0)throw S.getChecksumInstance();let w=this.field.inverse(g),_=d.multiply(w),C=l.multiply(w);return[_,C]}findErrorLocations(a){let i=a.getDegree(),c=new Int32Array(i),o=0;for(let l=1;l<this.field.getSize()&&o<i;l++)a.evaluateAt(l)===0&&(c[o]=this.field.inverse(l),o++);if(o!==i)throw S.getChecksumInstance();return c}findErrorMagnitudes(a,i,c){let o=i.getDegree(),l=new Int32Array(o);for(let w=1;w<=o;w++)l[o-w]=this.field.multiply(w,i.getCoefficient(w));let h=new Dr(this.field,l),d=c.length,g=new Int32Array(d);for(let w=0;w<d;w++){let _=this.field.inverse(c[w]),C=this.field.subtract(0,a.evaluateAt(_)),T=this.field.inverse(h.evaluateAt(_));g[w]=this.field.multiply(C,T)}return g}}class Ja{constructor(a,i,c,o,l){a instanceof Ja?this.constructor_2(a):this.constructor_1(a,i,c,o,l)}constructor_1(a,i,c,o,l){const h=i==null||c==null,d=o==null||l==null;if(h&&d)throw new re;h?(i=new We(0,o.getY()),c=new We(0,l.getY())):d&&(o=new We(a.getWidth()-1,i.getY()),l=new We(a.getWidth()-1,c.getY())),this.image=a,this.topLeft=i,this.bottomLeft=c,this.topRight=o,this.bottomRight=l,this.minX=Math.trunc(Math.min(i.getX(),c.getX())),this.maxX=Math.trunc(Math.max(o.getX(),l.getX())),this.minY=Math.trunc(Math.min(i.getY(),o.getY())),this.maxY=Math.trunc(Math.max(c.getY(),l.getY()))}constructor_2(a){this.image=a.image,this.topLeft=a.getTopLeft(),this.bottomLeft=a.getBottomLeft(),this.topRight=a.getTopRight(),this.bottomRight=a.getBottomRight(),this.minX=a.getMinX(),this.maxX=a.getMaxX(),this.minY=a.getMinY(),this.maxY=a.getMaxY()}static merge(a,i){return a==null?i:i==null?a:new Ja(a.image,a.topLeft,a.bottomLeft,i.topRight,i.bottomRight)}addMissingRows(a,i,c){let o=this.topLeft,l=this.bottomLeft,h=this.topRight,d=this.bottomRight;if(a>0){let g=c?this.topLeft:this.topRight,w=Math.trunc(g.getY()-a);w<0&&(w=0);let _=new We(g.getX(),w);c?o=_:h=_}if(i>0){let g=c?this.bottomLeft:this.bottomRight,w=Math.trunc(g.getY()+i);w>=this.image.getHeight()&&(w=this.image.getHeight()-1);let _=new We(g.getX(),w);c?l=_:d=_}return new Ja(this.image,o,l,h,d)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Fo{constructor(a,i,c,o){this.columnCount=a,this.errorCorrectionLevel=o,this.rowCountUpperPart=i,this.rowCountLowerPart=c,this.rowCount=i+c}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class hn{constructor(){this.buffer=""}static form(a,i){let c=-1;function o(h,d,g,w,_,C){if(h==="%%")return"%";if(i[++c]===void 0)return;h=w?parseInt(w.substr(1)):void 0;let T=_?parseInt(_.substr(1)):void 0,R;switch(C){case"s":R=i[c];break;case"c":R=i[c][0];break;case"f":R=parseFloat(i[c]).toFixed(h);break;case"p":R=parseFloat(i[c]).toPrecision(h);break;case"e":R=parseFloat(i[c]).toExponential(h);break;case"x":R=parseInt(i[c]).toString(T||16);break;case"d":R=parseFloat(parseInt(i[c],T||10).toPrecision(h)).toFixed(0);break}R=typeof R=="object"?JSON.stringify(R):(+R).toString(T);let L=parseInt(g),W=g&&g[0]+""=="0"?"0":" ";for(;R.length<L;)R=d!==void 0?R+W:W+R;return R}let l=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return a.replace(l,o)}format(a,...i){this.buffer+=hn.form(a,i)}toString(){return this.buffer}}class Ca{constructor(a){this.boundingBox=new Ja(a),this.codewords=new Array(a.getMaxY()-a.getMinY()+1)}getCodewordNearby(a){let i=this.getCodeword(a);if(i!=null)return i;for(let c=1;c<Ca.MAX_NEARBY_DISTANCE;c++){let o=this.imageRowToCodewordIndex(a)-c;if(o>=0&&(i=this.codewords[o],i!=null)||(o=this.imageRowToCodewordIndex(a)+c,o<this.codewords.length&&(i=this.codewords[o],i!=null)))return i}return null}imageRowToCodewordIndex(a){return a-this.boundingBox.getMinY()}setCodeword(a,i){this.codewords[this.imageRowToCodewordIndex(a)]=i}getCodeword(a){return this.codewords[this.imageRowToCodewordIndex(a)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const a=new hn;let i=0;for(const c of this.codewords){if(c==null){a.format("%3d:    |   %n",i++);continue}a.format("%3d: %3d|%3d%n",i++,c.getRowNumber(),c.getValue())}return a.toString()}}Ca.MAX_NEARBY_DISTANCE=5;class gi{constructor(){this.values=new Map}setValue(a){a=Math.trunc(a);let i=this.values.get(a);i==null&&(i=0),i++,this.values.set(a,i)}getValue(){let a=-1,i=new Array;for(const[c,o]of this.values.entries()){const l={getKey:()=>c,getValue:()=>o};l.getValue()>a?(a=l.getValue(),i=[],i.push(l.getKey())):l.getValue()===a&&i.push(l.getKey())}return rt.toIntArray(i)}getConfidence(a){return this.values.get(a)}}class Cn extends Ca{constructor(a,i){super(a),this._isLeft=i}setRowNumbers(){for(let a of this.getCodewords())a!=null&&a.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(a){let i=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(i,a);let c=this.getBoundingBox(),o=this._isLeft?c.getTopLeft():c.getTopRight(),l=this._isLeft?c.getBottomLeft():c.getBottomRight(),h=this.imageRowToCodewordIndex(Math.trunc(o.getY())),d=this.imageRowToCodewordIndex(Math.trunc(l.getY())),g=-1,w=1,_=0;for(let C=h;C<d;C++){if(i[C]==null)continue;let T=i[C],R=T.getRowNumber()-g;if(R===0)_++;else if(R===1)w=Math.max(w,_),_=1,g=T.getRowNumber();else if(R<0||T.getRowNumber()>=a.getRowCount()||R>C)i[C]=null;else{let L;w>2?L=(w-2)*R:L=R;let W=L>=C;for(let te=1;te<=L&&!W;te++)W=i[C-te]!=null;W?i[C]=null:(g=T.getRowNumber(),_=1)}}}getRowHeights(){let a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);let i=new Int32Array(a.getRowCount());for(let c of this.getCodewords())if(c!=null){let o=c.getRowNumber();if(o>=i.length)continue;i[o]++}return i}adjustIncompleteIndicatorColumnRowNumbers(a){let i=this.getBoundingBox(),c=this._isLeft?i.getTopLeft():i.getTopRight(),o=this._isLeft?i.getBottomLeft():i.getBottomRight(),l=this.imageRowToCodewordIndex(Math.trunc(c.getY())),h=this.imageRowToCodewordIndex(Math.trunc(o.getY())),d=this.getCodewords(),g=-1;for(let w=l;w<h;w++){if(d[w]==null)continue;let _=d[w];_.setRowNumberAsRowIndicatorColumn();let C=_.getRowNumber()-g;C===0||(C===1?g=_.getRowNumber():_.getRowNumber()>=a.getRowCount()?d[w]=null:g=_.getRowNumber())}}getBarcodeMetadata(){let a=this.getCodewords(),i=new gi,c=new gi,o=new gi,l=new gi;for(let d of a){if(d==null)continue;d.setRowNumberAsRowIndicatorColumn();let g=d.getValue()%30,w=d.getRowNumber();switch(this._isLeft||(w+=2),w%3){case 0:c.setValue(g*3+1);break;case 1:l.setValue(g/3),o.setValue(g%3);break;case 2:i.setValue(g+1);break}}if(i.getValue().length===0||c.getValue().length===0||o.getValue().length===0||l.getValue().length===0||i.getValue()[0]<1||c.getValue()[0]+o.getValue()[0]<rt.MIN_ROWS_IN_BARCODE||c.getValue()[0]+o.getValue()[0]>rt.MAX_ROWS_IN_BARCODE)return null;let h=new Fo(i.getValue()[0],c.getValue()[0],o.getValue()[0],l.getValue()[0]);return this.removeIncorrectCodewords(a,h),h}removeIncorrectCodewords(a,i){for(let c=0;c<a.length;c++){let o=a[c];if(a[c]==null)continue;let l=o.getValue()%30,h=o.getRowNumber();if(h>i.getRowCount()){a[c]=null;continue}switch(this._isLeft||(h+=2),h%3){case 0:l*3+1!==i.getRowCountUpperPart()&&(a[c]=null);break;case 1:(Math.trunc(l/3)!==i.getErrorCorrectionLevel()||l%3!==i.getRowCountLowerPart())&&(a[c]=null);break;case 2:l+1!==i.getColumnCount()&&(a[c]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class mi{constructor(a,i){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=a,this.barcodeColumnCount=a.getColumnCount(),this.boundingBox=i,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let a=rt.MAX_CODEWORDS_IN_BARCODE,i;do i=a,a=this.adjustRowNumbersAndGetCount();while(a>0&&a<i);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(a){a!=null&&a.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let a=this.adjustRowNumbersByRow();if(a===0)return 0;for(let i=1;i<this.barcodeColumnCount+1;i++){let c=this.detectionResultColumns[i].getCodewords();for(let o=0;o<c.length;o++)c[o]!=null&&(c[o].hasValidRowNumber()||this.adjustRowNumbers(i,o,c))}return a}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let a=this.detectionResultColumns[0].getCodewords(),i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<a.length;c++)if(a[c]!=null&&i[c]!=null&&a[c].getRowNumber()===i[c].getRowNumber())for(let o=1;o<=this.barcodeColumnCount;o++){let l=this.detectionResultColumns[o].getCodewords()[c];l!=null&&(l.setRowNumber(a[c].getRowNumber()),l.hasValidRowNumber()||(this.detectionResultColumns[o].getCodewords()[c]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let a=0,i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<i.length;c++){if(i[c]==null)continue;let o=i[c].getRowNumber(),l=0;for(let h=this.barcodeColumnCount+1;h>0&&l<this.ADJUST_ROW_NUMBER_SKIP;h--){let d=this.detectionResultColumns[h].getCodewords()[c];d!=null&&(l=mi.adjustRowNumberIfValid(o,l,d),d.hasValidRowNumber()||a++)}}return a}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let a=0,i=this.detectionResultColumns[0].getCodewords();for(let c=0;c<i.length;c++){if(i[c]==null)continue;let o=i[c].getRowNumber(),l=0;for(let h=1;h<this.barcodeColumnCount+1&&l<this.ADJUST_ROW_NUMBER_SKIP;h++){let d=this.detectionResultColumns[h].getCodewords()[c];d!=null&&(l=mi.adjustRowNumberIfValid(o,l,d),d.hasValidRowNumber()||a++)}}return a}static adjustRowNumberIfValid(a,i,c){return c==null||c.hasValidRowNumber()||(c.isValidRowNumber(a)?(c.setRowNumber(a),i=0):++i),i}adjustRowNumbers(a,i,c){if(!this.detectionResultColumns[a-1])return;let o=c[i],l=this.detectionResultColumns[a-1].getCodewords(),h=l;this.detectionResultColumns[a+1]!=null&&(h=this.detectionResultColumns[a+1].getCodewords());let d=new Array(14);d[2]=l[i],d[3]=h[i],i>0&&(d[0]=c[i-1],d[4]=l[i-1],d[5]=h[i-1]),i>1&&(d[8]=c[i-2],d[10]=l[i-2],d[11]=h[i-2]),i<c.length-1&&(d[1]=c[i+1],d[6]=l[i+1],d[7]=h[i+1]),i<c.length-2&&(d[9]=c[i+2],d[12]=l[i+2],d[13]=h[i+2]);for(let g of d)if(mi.adjustRowNumber(o,g))return}static adjustRowNumber(a,i){return i==null?!1:i.hasValidRowNumber()&&i.getBucket()===a.getBucket()?(a.setRowNumber(i.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(a){this.boundingBox=a}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(a,i){this.detectionResultColumns[a]=i}getDetectionResultColumn(a){return this.detectionResultColumns[a]}toString(){let a=this.detectionResultColumns[0];a==null&&(a=this.detectionResultColumns[this.barcodeColumnCount+1]);let i=new hn;for(let c=0;c<a.getCodewords().length;c++){i.format("CW %3d:",c);for(let o=0;o<this.barcodeColumnCount+2;o++){if(this.detectionResultColumns[o]==null){i.format("    |   ");continue}let l=this.detectionResultColumns[o].getCodewords()[c];if(l==null){i.format("    |   ");continue}i.format(" %3d|%3d",l.getRowNumber(),l.getValue())}i.format("%n")}return i.toString()}}class un{constructor(a,i,c,o){this.rowNumber=un.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(a),this.endX=Math.trunc(i),this.bucket=Math.trunc(c),this.value=Math.trunc(o)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(a){return a!==un.BARCODE_ROW_UNKNOWN&&this.bucket===a%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(a){this.rowNumber=a}toString(){return this.rowNumber+"|"+this.value}}un.BARCODE_ROW_UNKNOWN=-1;class vr{static initialize(){for(let a=0;a<rt.SYMBOL_TABLE.length;a++){let i=rt.SYMBOL_TABLE[a],c=i&1;for(let o=0;o<rt.BARS_IN_MODULE;o++){let l=0;for(;(i&1)===c;)l+=1,i>>=1;c=i&1,vr.RATIOS_TABLE[a]||(vr.RATIOS_TABLE[a]=new Array(rt.BARS_IN_MODULE)),vr.RATIOS_TABLE[a][rt.BARS_IN_MODULE-o-1]=Math.fround(l/rt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(a){let i=vr.getDecodedCodewordValue(vr.sampleBitCounts(a));return i!==-1?i:vr.getClosestDecodedValue(a)}static sampleBitCounts(a){let i=nt.sum(a),c=new Int32Array(rt.BARS_IN_MODULE),o=0,l=0;for(let h=0;h<rt.MODULES_IN_CODEWORD;h++){let d=i/(2*rt.MODULES_IN_CODEWORD)+h*i/rt.MODULES_IN_CODEWORD;l+a[o]<=d&&(l+=a[o],o++),c[o]++}return c}static getDecodedCodewordValue(a){let i=vr.getBitValue(a);return rt.getCodeword(i)===-1?-1:i}static getBitValue(a){let i=0;for(let c=0;c<a.length;c++)for(let o=0;o<a[c];o++)i=i<<1|(c%2===0?1:0);return Math.trunc(i)}static getClosestDecodedValue(a){let i=nt.sum(a),c=new Array(rt.BARS_IN_MODULE);if(i>1)for(let h=0;h<c.length;h++)c[h]=Math.fround(a[h]/i);let o=$r.MAX_VALUE,l=-1;this.bSymbolTableReady||vr.initialize();for(let h=0;h<vr.RATIOS_TABLE.length;h++){let d=0,g=vr.RATIOS_TABLE[h];for(let w=0;w<rt.BARS_IN_MODULE;w++){let _=Math.fround(g[w]-c[w]);if(d+=Math.fround(_*_),d>=o)break}d<o&&(o=d,l=rt.SYMBOL_TABLE[h])}return l}}vr.bSymbolTableReady=!1,vr.RATIOS_TABLE=new Array(rt.SYMBOL_TABLE.length).map(I=>new Array(rt.BARS_IN_MODULE));class Ui{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(a){this.segmentIndex=a}getFileId(){return this.fileId}setFileId(a){this.fileId=a}getOptionalData(){return this.optionalData}setOptionalData(a){this.optionalData=a}isLastSegment(){return this.lastSegment}setLastSegment(a){this.lastSegment=a}getSegmentCount(){return this.segmentCount}setSegmentCount(a){this.segmentCount=a}getSender(){return this.sender||null}setSender(a){this.sender=a}getAddressee(){return this.addressee||null}setAddressee(a){this.addressee=a}getFileName(){return this.fileName}setFileName(a){this.fileName=a}getFileSize(){return this.fileSize}setFileSize(a){this.fileSize=a}getChecksum(){return this.checksum}setChecksum(a){this.checksum=a}getTimestamp(){return this.timestamp}setTimestamp(a){this.timestamp=a}}class Wi{static parseLong(a,i=void 0){return parseInt(a,i)}}class v0 extends m{}v0.kind="NullPointerException";class ys{writeBytes(a){this.writeBytesOffset(a,0,a.length)}writeBytesOffset(a,i,c){if(a==null)throw new v0;if(i<0||i>a.length||c<0||i+c>a.length||i+c<0)throw new F;if(c===0)return;for(let o=0;o<c;o++)this.write(a[i+o])}flush(){}close(){}}class Do extends m{}class Vi extends ys{constructor(a=32){if(super(),this.count=0,a<0)throw new E("Negative initial size: "+a);this.buf=new Uint8Array(a)}ensureCapacity(a){a-this.buf.length>0&&this.grow(a)}grow(a){let c=this.buf.length<<1;if(c-a<0&&(c=a),c<0){if(a<0)throw new Do;c=D.MAX_VALUE}this.buf=G.copyOfUint8Array(this.buf,c)}write(a){this.ensureCapacity(this.count+1),this.buf[this.count]=a,this.count+=1}writeBytesOffset(a,i,c){if(i<0||i>a.length||c<0||i+c-a.length>0)throw new F;this.ensureCapacity(this.count+c),A.arraycopy(a,i,this.buf,this.count,c),this.count+=c}writeTo(a){a.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return G.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(a){return a?typeof a=="string"?this.toString_string(a):this.toString_number(a):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(a){return new String(this.buf).toString()}toString_number(a){return new String(this.buf).toString()}close(){}}var Tt;(function(I){I[I.ALPHA=0]="ALPHA",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.PUNCT=3]="PUNCT",I[I.ALPHA_SHIFT=4]="ALPHA_SHIFT",I[I.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Tt||(Tt={}));function y0(){if(typeof window<"u")return window.BigInt||null;if(typeof Cs<"u")return Cs.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let pi;function Ta(I){if(typeof pi>"u"&&(pi=y0()),pi===null)throw new Error("BigInt is not supported!");return pi(I)}function Es(){let I=[];I[0]=Ta(1);let a=Ta(900);I[1]=a;for(let i=2;i<16;i++)I[i]=I[i-1]*a;return I}class ge{static decode(a,i){let c=new pe(""),o=X.ISO8859_1;c.enableDecoding(o);let l=1,h=a[l++],d=new Ui;for(;l<a[0];){switch(h){case ge.TEXT_COMPACTION_MODE_LATCH:l=ge.textCompaction(a,l,c);break;case ge.BYTE_COMPACTION_MODE_LATCH:case ge.BYTE_COMPACTION_MODE_LATCH_6:l=ge.byteCompaction(h,a,o,l,c);break;case ge.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(a[l++]);break;case ge.NUMERIC_COMPACTION_MODE_LATCH:l=ge.numericCompaction(a,l,c);break;case ge.ECI_CHARSET:X.getCharacterSetECIByValue(a[l++]);break;case ge.ECI_GENERAL_PURPOSE:l+=2;break;case ge.ECI_USER_DEFINED:l++;break;case ge.BEGIN_MACRO_PDF417_CONTROL_BLOCK:l=ge.decodeMacroBlock(a,l,d);break;case ge.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ge.MACRO_PDF417_TERMINATOR:throw new M;default:l--,l=ge.textCompaction(a,l,c);break}if(l<a.length)h=a[l++];else throw M.getFormatInstance()}if(c.length()===0)throw M.getFormatInstance();let g=new ve(null,c.toString(),null,i);return g.setOther(d),g}static decodeMacroBlock(a,i,c){if(i+ge.NUMBER_OF_SEQUENCE_CODEWORDS>a[0])throw M.getFormatInstance();let o=new Int32Array(ge.NUMBER_OF_SEQUENCE_CODEWORDS);for(let d=0;d<ge.NUMBER_OF_SEQUENCE_CODEWORDS;d++,i++)o[d]=a[i];c.setSegmentIndex(D.parseInt(ge.decodeBase900toBase10(o,ge.NUMBER_OF_SEQUENCE_CODEWORDS)));let l=new pe;i=ge.textCompaction(a,i,l),c.setFileId(l.toString());let h=-1;for(a[i]===ge.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(h=i+1);i<a[0];)switch(a[i]){case ge.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(i++,a[i]){case ge.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let d=new pe;i=ge.textCompaction(a,i+1,d),c.setFileName(d.toString());break;case ge.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let g=new pe;i=ge.textCompaction(a,i+1,g),c.setSender(g.toString());break;case ge.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let w=new pe;i=ge.textCompaction(a,i+1,w),c.setAddressee(w.toString());break;case ge.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let _=new pe;i=ge.numericCompaction(a,i+1,_),c.setSegmentCount(D.parseInt(_.toString()));break;case ge.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let C=new pe;i=ge.numericCompaction(a,i+1,C),c.setTimestamp(Wi.parseLong(C.toString()));break;case ge.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let T=new pe;i=ge.numericCompaction(a,i+1,T),c.setChecksum(D.parseInt(T.toString()));break;case ge.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let R=new pe;i=ge.numericCompaction(a,i+1,R),c.setFileSize(Wi.parseLong(R.toString()));break;default:throw M.getFormatInstance()}break;case ge.MACRO_PDF417_TERMINATOR:i++,c.setLastSegment(!0);break;default:throw M.getFormatInstance()}if(h!==-1){let d=i-h;c.isLastSegment()&&d--,c.setOptionalData(G.copyOfRange(a,h,h+d))}return i}static textCompaction(a,i,c){let o=new Int32Array((a[0]-i)*2),l=new Int32Array((a[0]-i)*2),h=0,d=!1;for(;i<a[0]&&!d;){let g=a[i++];if(g<ge.TEXT_COMPACTION_MODE_LATCH)o[h]=g/30,o[h+1]=g%30,h+=2;else switch(g){case ge.TEXT_COMPACTION_MODE_LATCH:o[h++]=ge.TEXT_COMPACTION_MODE_LATCH;break;case ge.BYTE_COMPACTION_MODE_LATCH:case ge.BYTE_COMPACTION_MODE_LATCH_6:case ge.NUMERIC_COMPACTION_MODE_LATCH:case ge.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ge.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ge.MACRO_PDF417_TERMINATOR:i--,d=!0;break;case ge.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o[h]=ge.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,g=a[i++],l[h]=g,h++;break}}return ge.decodeTextCompaction(o,l,h,c),i}static decodeTextCompaction(a,i,c,o){let l=Tt.ALPHA,h=Tt.ALPHA,d=0;for(;d<c;){let g=a[d],w="";switch(l){case Tt.ALPHA:if(g<26)w=String.fromCharCode(65+g);else switch(g){case 26:w=" ";break;case ge.LL:l=Tt.LOWER;break;case ge.ML:l=Tt.MIXED;break;case ge.PS:h=l,l=Tt.PUNCT_SHIFT;break;case ge.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(i[d]);break;case ge.TEXT_COMPACTION_MODE_LATCH:l=Tt.ALPHA;break}break;case Tt.LOWER:if(g<26)w=String.fromCharCode(97+g);else switch(g){case 26:w=" ";break;case ge.AS:h=l,l=Tt.ALPHA_SHIFT;break;case ge.ML:l=Tt.MIXED;break;case ge.PS:h=l,l=Tt.PUNCT_SHIFT;break;case ge.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(i[d]);break;case ge.TEXT_COMPACTION_MODE_LATCH:l=Tt.ALPHA;break}break;case Tt.MIXED:if(g<ge.PL)w=ge.MIXED_CHARS[g];else switch(g){case ge.PL:l=Tt.PUNCT;break;case 26:w=" ";break;case ge.LL:l=Tt.LOWER;break;case ge.AL:l=Tt.ALPHA;break;case ge.PS:h=l,l=Tt.PUNCT_SHIFT;break;case ge.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(i[d]);break;case ge.TEXT_COMPACTION_MODE_LATCH:l=Tt.ALPHA;break}break;case Tt.PUNCT:if(g<ge.PAL)w=ge.PUNCT_CHARS[g];else switch(g){case ge.PAL:l=Tt.ALPHA;break;case ge.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(i[d]);break;case ge.TEXT_COMPACTION_MODE_LATCH:l=Tt.ALPHA;break}break;case Tt.ALPHA_SHIFT:if(l=h,g<26)w=String.fromCharCode(65+g);else switch(g){case 26:w=" ";break;case ge.TEXT_COMPACTION_MODE_LATCH:l=Tt.ALPHA;break}break;case Tt.PUNCT_SHIFT:if(l=h,g<ge.PAL)w=ge.PUNCT_CHARS[g];else switch(g){case ge.PAL:l=Tt.ALPHA;break;case ge.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(i[d]);break;case ge.TEXT_COMPACTION_MODE_LATCH:l=Tt.ALPHA;break}break}w!==""&&o.append(w),d++}}static byteCompaction(a,i,c,o,l){let h=new Vi,d=0,g=0,w=!1;switch(a){case ge.BYTE_COMPACTION_MODE_LATCH:let _=new Int32Array(6),C=i[o++];for(;o<i[0]&&!w;)switch(_[d++]=C,g=900*g+C,C=i[o++],C){case ge.TEXT_COMPACTION_MODE_LATCH:case ge.BYTE_COMPACTION_MODE_LATCH:case ge.NUMERIC_COMPACTION_MODE_LATCH:case ge.BYTE_COMPACTION_MODE_LATCH_6:case ge.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ge.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ge.MACRO_PDF417_TERMINATOR:o--,w=!0;break;default:if(d%5===0&&d>0){for(let T=0;T<6;++T)h.write(Number(Ta(g)>>Ta(8*(5-T))));g=0,d=0}break}o===i[0]&&C<ge.TEXT_COMPACTION_MODE_LATCH&&(_[d++]=C);for(let T=0;T<d;T++)h.write(_[T]);break;case ge.BYTE_COMPACTION_MODE_LATCH_6:for(;o<i[0]&&!w;){let T=i[o++];if(T<ge.TEXT_COMPACTION_MODE_LATCH)d++,g=900*g+T;else switch(T){case ge.TEXT_COMPACTION_MODE_LATCH:case ge.BYTE_COMPACTION_MODE_LATCH:case ge.NUMERIC_COMPACTION_MODE_LATCH:case ge.BYTE_COMPACTION_MODE_LATCH_6:case ge.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ge.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ge.MACRO_PDF417_TERMINATOR:o--,w=!0;break}if(d%5===0&&d>0){for(let R=0;R<6;++R)h.write(Number(Ta(g)>>Ta(8*(5-R))));g=0,d=0}}break}return l.append(le.decode(h.toByteArray(),c)),o}static numericCompaction(a,i,c){let o=0,l=!1,h=new Int32Array(ge.MAX_NUMERIC_CODEWORDS);for(;i<a[0]&&!l;){let d=a[i++];if(i===a[0]&&(l=!0),d<ge.TEXT_COMPACTION_MODE_LATCH)h[o]=d,o++;else switch(d){case ge.TEXT_COMPACTION_MODE_LATCH:case ge.BYTE_COMPACTION_MODE_LATCH:case ge.BYTE_COMPACTION_MODE_LATCH_6:case ge.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ge.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ge.MACRO_PDF417_TERMINATOR:i--,l=!0;break}(o%ge.MAX_NUMERIC_CODEWORDS===0||d===ge.NUMERIC_COMPACTION_MODE_LATCH||l)&&o>0&&(c.append(ge.decodeBase900toBase10(h,o)),o=0)}return i}static decodeBase900toBase10(a,i){let c=Ta(0);for(let l=0;l<i;l++)c+=ge.EXP900[i-l-1]*Ta(a[l]);let o=c.toString();if(o.charAt(0)!=="1")throw new M;return o.substring(1)}}ge.TEXT_COMPACTION_MODE_LATCH=900,ge.BYTE_COMPACTION_MODE_LATCH=901,ge.NUMERIC_COMPACTION_MODE_LATCH=902,ge.BYTE_COMPACTION_MODE_LATCH_6=924,ge.ECI_USER_DEFINED=925,ge.ECI_GENERAL_PURPOSE=926,ge.ECI_CHARSET=927,ge.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,ge.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,ge.MACRO_PDF417_TERMINATOR=922,ge.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,ge.MAX_NUMERIC_CODEWORDS=15,ge.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,ge.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,ge.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,ge.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,ge.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,ge.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,ge.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,ge.PL=25,ge.LL=27,ge.AS=27,ge.ML=28,ge.AL=28,ge.PS=29,ge.PAL=29,ge.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,ge.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",ge.EXP900=y0()?Es():[],ge.NUMBER_OF_SEQUENCE_CODEWORDS=2;class wt{constructor(){}static decode(a,i,c,o,l,h,d){let g=new Ja(a,i,c,o,l),w=null,_=null,C;for(let L=!0;;L=!1){if(i!=null&&(w=wt.getRowIndicatorColumn(a,g,i,!0,h,d)),o!=null&&(_=wt.getRowIndicatorColumn(a,g,o,!1,h,d)),C=wt.merge(w,_),C==null)throw re.getNotFoundInstance();let W=C.getBoundingBox();if(L&&W!=null&&(W.getMinY()<g.getMinY()||W.getMaxY()>g.getMaxY()))g=W;else break}C.setBoundingBox(g);let T=C.getBarcodeColumnCount()+1;C.setDetectionResultColumn(0,w),C.setDetectionResultColumn(T,_);let R=w!=null;for(let L=1;L<=T;L++){let W=R?L:T-L;if(C.getDetectionResultColumn(W)!==void 0)continue;let te;W===0||W===T?te=new Cn(g,W===0):te=new Ca(g),C.setDetectionResultColumn(W,te);let se=-1,Ce=se;for(let Te=g.getMinY();Te<=g.getMaxY();Te++){if(se=wt.getStartColumn(C,W,Te,R),se<0||se>g.getMaxX()){if(Ce===-1)continue;se=Ce}let ce=wt.detectCodeword(a,g.getMinX(),g.getMaxX(),R,se,Te,h,d);ce!=null&&(te.setCodeword(Te,ce),Ce=se,h=Math.min(h,ce.getWidth()),d=Math.max(d,ce.getWidth()))}}return wt.createDecoderResult(C)}static merge(a,i){if(a==null&&i==null)return null;let c=wt.getBarcodeMetadata(a,i);if(c==null)return null;let o=Ja.merge(wt.adjustBoundingBox(a),wt.adjustBoundingBox(i));return new mi(c,o)}static adjustBoundingBox(a){if(a==null)return null;let i=a.getRowHeights();if(i==null)return null;let c=wt.getMax(i),o=0;for(let d of i)if(o+=c-d,d>0)break;let l=a.getCodewords();for(let d=0;o>0&&l[d]==null;d++)o--;let h=0;for(let d=i.length-1;d>=0&&(h+=c-i[d],!(i[d]>0));d--);for(let d=l.length-1;h>0&&l[d]==null;d--)h--;return a.getBoundingBox().addMissingRows(o,h,a.isLeft())}static getMax(a){let i=-1;for(let c of a)i=Math.max(i,c);return i}static getBarcodeMetadata(a,i){let c;if(a==null||(c=a.getBarcodeMetadata())==null)return i==null?null:i.getBarcodeMetadata();let o;return i==null||(o=i.getBarcodeMetadata())==null?c:c.getColumnCount()!==o.getColumnCount()&&c.getErrorCorrectionLevel()!==o.getErrorCorrectionLevel()&&c.getRowCount()!==o.getRowCount()?null:c}static getRowIndicatorColumn(a,i,c,o,l,h){let d=new Cn(i,o);for(let g=0;g<2;g++){let w=g===0?1:-1,_=Math.trunc(Math.trunc(c.getX()));for(let C=Math.trunc(Math.trunc(c.getY()));C<=i.getMaxY()&&C>=i.getMinY();C+=w){let T=wt.detectCodeword(a,0,a.getWidth(),o,_,C,l,h);T!=null&&(d.setCodeword(C,T),o?_=T.getStartX():_=T.getEndX())}}return d}static adjustCodewordCount(a,i){let c=i[0][1],o=c.getValue(),l=a.getBarcodeColumnCount()*a.getBarcodeRowCount()-wt.getNumberOfECCodeWords(a.getBarcodeECLevel());if(o.length===0){if(l<1||l>rt.MAX_CODEWORDS_IN_BARCODE)throw re.getNotFoundInstance();c.setValue(l)}else o[0]!==l&&c.setValue(l)}static createDecoderResult(a){let i=wt.createBarcodeMatrix(a);wt.adjustCodewordCount(a,i);let c=new Array,o=new Int32Array(a.getBarcodeRowCount()*a.getBarcodeColumnCount()),l=[],h=new Array;for(let g=0;g<a.getBarcodeRowCount();g++)for(let w=0;w<a.getBarcodeColumnCount();w++){let _=i[g][w+1].getValue(),C=g*a.getBarcodeColumnCount()+w;_.length===0?c.push(C):_.length===1?o[C]=_[0]:(h.push(C),l.push(_))}let d=new Array(l.length);for(let g=0;g<d.length;g++)d[g]=l[g];return wt.createDecoderResultFromAmbiguousValues(a.getBarcodeECLevel(),o,rt.toIntArray(c),rt.toIntArray(h),d)}static createDecoderResultFromAmbiguousValues(a,i,c,o,l){let h=new Int32Array(o.length),d=100;for(;d-- >0;){for(let g=0;g<h.length;g++)i[o[g]]=l[g][h[g]];try{return wt.decodeCodewords(i,a,c)}catch(g){if(!(g instanceof S))throw g}if(h.length===0)throw S.getChecksumInstance();for(let g=0;g<h.length;g++)if(h[g]<l[g].length-1){h[g]++;break}else if(h[g]=0,g===h.length-1)throw S.getChecksumInstance()}throw S.getChecksumInstance()}static createBarcodeMatrix(a){let i=Array.from({length:a.getBarcodeRowCount()},()=>new Array(a.getBarcodeColumnCount()+2));for(let o=0;o<i.length;o++)for(let l=0;l<i[o].length;l++)i[o][l]=new gi;let c=0;for(let o of a.getDetectionResultColumns()){if(o!=null){for(let l of o.getCodewords())if(l!=null){let h=l.getRowNumber();if(h>=0){if(h>=i.length)continue;i[h][c].setValue(l.getValue())}}}c++}return i}static isValidBarcodeColumn(a,i){return i>=0&&i<=a.getBarcodeColumnCount()+1}static getStartColumn(a,i,c,o){let l=o?1:-1,h=null;if(wt.isValidBarcodeColumn(a,i-l)&&(h=a.getDetectionResultColumn(i-l).getCodeword(c)),h!=null)return o?h.getEndX():h.getStartX();if(h=a.getDetectionResultColumn(i).getCodewordNearby(c),h!=null)return o?h.getStartX():h.getEndX();if(wt.isValidBarcodeColumn(a,i-l)&&(h=a.getDetectionResultColumn(i-l).getCodewordNearby(c)),h!=null)return o?h.getEndX():h.getStartX();let d=0;for(;wt.isValidBarcodeColumn(a,i-l);){i-=l;for(let g of a.getDetectionResultColumn(i).getCodewords())if(g!=null)return(o?g.getEndX():g.getStartX())+l*d*(g.getEndX()-g.getStartX());d++}return o?a.getBoundingBox().getMinX():a.getBoundingBox().getMaxX()}static detectCodeword(a,i,c,o,l,h,d,g){l=wt.adjustCodewordStartColumn(a,i,c,o,l,h);let w=wt.getModuleBitCount(a,i,c,o,l,h);if(w==null)return null;let _,C=nt.sum(w);if(o)_=l+C;else{for(let L=0;L<w.length/2;L++){let W=w[L];w[L]=w[w.length-1-L],w[w.length-1-L]=W}_=l,l=_-C}if(!wt.checkCodewordSkew(C,d,g))return null;let T=vr.getDecodedValue(w),R=rt.getCodeword(T);return R===-1?null:new un(l,_,wt.getCodewordBucketNumber(T),R)}static getModuleBitCount(a,i,c,o,l,h){let d=l,g=new Int32Array(8),w=0,_=o?1:-1,C=o;for(;(o?d<c:d>=i)&&w<g.length;)a.get(d,h)===C?(g[w]++,d+=_):(w++,C=!C);return w===g.length||d===(o?c:i)&&w===g.length-1?g:null}static getNumberOfECCodeWords(a){return 2<<a}static adjustCodewordStartColumn(a,i,c,o,l,h){let d=l,g=o?-1:1;for(let w=0;w<2;w++){for(;(o?d>=i:d<c)&&o===a.get(d,h);){if(Math.abs(l-d)>wt.CODEWORD_SKEW_SIZE)return l;d+=g}g=-g,o=!o}return d}static checkCodewordSkew(a,i,c){return i-wt.CODEWORD_SKEW_SIZE<=a&&a<=c+wt.CODEWORD_SKEW_SIZE}static decodeCodewords(a,i,c){if(a.length===0)throw M.getFormatInstance();let o=1<<i+1,l=wt.correctErrors(a,c,o);wt.verifyCodewordCount(a,o);let h=ge.decode(a,""+i);return h.setErrorsCorrected(l),h.setErasures(c.length),h}static correctErrors(a,i,c){if(i!=null&&i.length>c/2+wt.MAX_ERRORS||c<0||c>wt.MAX_EC_CODEWORDS)throw S.getChecksumInstance();return wt.errorCorrection.decode(a,c,i)}static verifyCodewordCount(a,i){if(a.length<4)throw M.getFormatInstance();let c=a[0];if(c>a.length)throw M.getFormatInstance();if(c===0)if(i<a.length)a[0]=a.length-i;else throw M.getFormatInstance()}static getBitCountForCodeword(a){let i=new Int32Array(8),c=0,o=i.length-1;for(;!((a&1)!==c&&(c=a&1,o--,o<0));)i[o]++,a>>=1;return i}static getCodewordBucketNumber(a){return a instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(a):this.getCodewordBucketNumber_number(a)}static getCodewordBucketNumber_number(a){return wt.getCodewordBucketNumber(wt.getBitCountForCodeword(a))}static getCodewordBucketNumber_Int32Array(a){return(a[0]-a[2]+a[4]-a[6]+9)%9}static toString(a){let i=new hn;for(let c=0;c<a.length;c++){i.format("Row %2d: ",c);for(let o=0;o<a[c].length;o++){let l=a[c][o];l.getValue().length===0?i.format("        ",null):i.format("%4d(%2d)",l.getValue()[0],l.getConfidence(l.getValue()[0]))}i.format("%n")}return i.toString()}}wt.CODEWORD_SKEW_SIZE=2,wt.MAX_ERRORS=3,wt.MAX_EC_CODEWORDS=512,wt.errorCorrection=new w0;class sr{decode(a,i=null){let c=sr.decode(a,i,!1);if(c==null||c.length===0||c[0]==null)throw re.getNotFoundInstance();return c[0]}decodeMultiple(a,i=null){try{return sr.decode(a,i,!0)}catch(c){throw c instanceof M||c instanceof S?re.getNotFoundInstance():c}}static decode(a,i,c){const o=new Array,l=dt.detectMultiple(a,i,c);for(const h of l.getPoints()){const d=wt.decode(l.getBits(),h[4],h[5],h[6],h[7],sr.getMinCodewordWidth(h),sr.getMaxCodewordWidth(h)),g=new z(d.getText(),d.getRawBytes(),void 0,h,B.PDF_417);g.putMetadata(we.ERROR_CORRECTION_LEVEL,d.getECLevel());const w=d.getOther();w!=null&&g.putMetadata(we.PDF417_EXTRA_METADATA,w),o.push(g)}return o.map(h=>h)}static getMaxWidth(a,i){return a==null||i==null?0:Math.trunc(Math.abs(a.getX()-i.getX()))}static getMinWidth(a,i){return a==null||i==null?D.MAX_VALUE:Math.trunc(Math.abs(a.getX()-i.getX()))}static getMaxCodewordWidth(a){return Math.floor(Math.max(Math.max(sr.getMaxWidth(a[0],a[4]),sr.getMaxWidth(a[6],a[2])*rt.MODULES_IN_CODEWORD/rt.MODULES_IN_STOP_PATTERN),Math.max(sr.getMaxWidth(a[1],a[5]),sr.getMaxWidth(a[7],a[3])*rt.MODULES_IN_CODEWORD/rt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(a){return Math.floor(Math.min(Math.min(sr.getMinWidth(a[0],a[4]),sr.getMinWidth(a[6],a[2])*rt.MODULES_IN_CODEWORD/rt.MODULES_IN_STOP_PATTERN),Math.min(sr.getMinWidth(a[1],a[5]),sr.getMinWidth(a[7],a[3])*rt.MODULES_IN_CODEWORD/rt.MODULES_IN_STOP_PATTERN)))}reset(){}}class Ba extends m{}Ba.kind="ReaderException";class Hi{constructor(a,i){this.verbose=a===!0,i&&this.setHints(i)}decode(a,i){return i&&this.setHints(i),this.decodeInternal(a)}decodeWithState(a){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(a)}setHints(a){this.hints=a;const i=!n(a)&&a.get(Q.TRY_HARDER)===!0,c=n(a)?null:a.get(Q.POSSIBLE_FORMATS),o=new Array;if(!n(c)){const l=c.some(h=>h===B.UPC_A||h===B.UPC_E||h===B.EAN_13||h===B.EAN_8||h===B.CODABAR||h===B.CODE_39||h===B.CODE_93||h===B.CODE_128||h===B.ITF||h===B.RSS_14||h===B.RSS_EXPANDED);l&&!i&&o.push(new Kr(a,this.verbose)),c.includes(B.QR_CODE)&&o.push(new ua),c.includes(B.DATA_MATRIX)&&o.push(new Pa),c.includes(B.AZTEC)&&o.push(new Yt),c.includes(B.PDF_417)&&o.push(new sr),l&&i&&o.push(new Kr(a,this.verbose))}o.length===0&&(i||o.push(new Kr(a,this.verbose)),o.push(new ua),o.push(new Pa),o.push(new Yt),o.push(new sr),i&&o.push(new Kr(a,this.verbose))),this.readers=o}reset(){if(this.readers!==null)for(const a of this.readers)a.reset()}decodeInternal(a){if(this.readers===null)throw new Ba("No readers where selected, nothing can be read.");for(const i of this.readers)try{return i.decode(a,this.hints)}catch(c){if(c instanceof Ba)continue}throw new re("No MultiFormat Readers were able to detect the code.")}}class Gi extends ae{constructor(a=null,i=500){const c=new Hi;c.setHints(a),super(c,i)}decodeBitmap(a){return this.reader.decodeWithState(a)}}class Oo extends ae{constructor(a=500){super(new sr,a)}}class Ro extends ae{constructor(a=500){super(new ua,a)}}var Tn;(function(I){I[I.ERROR_CORRECTION=0]="ERROR_CORRECTION",I[I.CHARACTER_SET=1]="CHARACTER_SET",I[I.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",I[I.MIN_SIZE=3]="MIN_SIZE",I[I.MAX_SIZE=4]="MAX_SIZE",I[I.MARGIN=5]="MARGIN",I[I.PDF417_COMPACT=6]="PDF417_COMPACT",I[I.PDF417_COMPACTION=7]="PDF417_COMPACTION",I[I.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",I[I.AZTEC_LAYERS=9]="AZTEC_LAYERS",I[I.QR_VERSION=10]="QR_VERSION"})(Tn||(Tn={}));var hr=Tn;class Wn{constructor(a){this.field=a,this.cachedGenerators=[],this.cachedGenerators.push(new Xe(a,Int32Array.from([1])))}buildGenerator(a){const i=this.cachedGenerators;if(a>=i.length){let c=i[i.length-1];const o=this.field;for(let l=i.length;l<=a;l++){const h=c.multiply(new Xe(o,Int32Array.from([1,o.exp(l-1+o.getGeneratorBase())])));i.push(h),c=h}}return i[a]}encode(a,i){if(i===0)throw new E("No error correction bytes");const c=a.length-i;if(c<=0)throw new E("No data bytes provided");const o=this.buildGenerator(i),l=new Int32Array(c);A.arraycopy(a,0,l,0,c);let h=new Xe(this.field,l);h=h.multiplyByMonomial(i,1);const g=h.divide(o)[1].getCoefficients(),w=i-g.length;for(let _=0;_<w;_++)a[c+_]=0;A.arraycopy(g,0,a,c+w,g.length)}}class ur{constructor(){}static applyMaskPenaltyRule1(a){return ur.applyMaskPenaltyRule1Internal(a,!0)+ur.applyMaskPenaltyRule1Internal(a,!1)}static applyMaskPenaltyRule2(a){let i=0;const c=a.getArray(),o=a.getWidth(),l=a.getHeight();for(let h=0;h<l-1;h++){const d=c[h];for(let g=0;g<o-1;g++){const w=d[g];w===d[g+1]&&w===c[h+1][g]&&w===c[h+1][g+1]&&i++}}return ur.N2*i}static applyMaskPenaltyRule3(a){let i=0;const c=a.getArray(),o=a.getWidth(),l=a.getHeight();for(let h=0;h<l;h++)for(let d=0;d<o;d++){const g=c[h];d+6<o&&g[d]===1&&g[d+1]===0&&g[d+2]===1&&g[d+3]===1&&g[d+4]===1&&g[d+5]===0&&g[d+6]===1&&(ur.isWhiteHorizontal(g,d-4,d)||ur.isWhiteHorizontal(g,d+7,d+11))&&i++,h+6<l&&c[h][d]===1&&c[h+1][d]===0&&c[h+2][d]===1&&c[h+3][d]===1&&c[h+4][d]===1&&c[h+5][d]===0&&c[h+6][d]===1&&(ur.isWhiteVertical(c,d,h-4,h)||ur.isWhiteVertical(c,d,h+7,h+11))&&i++}return i*ur.N3}static isWhiteHorizontal(a,i,c){i=Math.max(i,0),c=Math.min(c,a.length);for(let o=i;o<c;o++)if(a[o]===1)return!1;return!0}static isWhiteVertical(a,i,c,o){c=Math.max(c,0),o=Math.min(o,a.length);for(let l=c;l<o;l++)if(a[l][i]===1)return!1;return!0}static applyMaskPenaltyRule4(a){let i=0;const c=a.getArray(),o=a.getWidth(),l=a.getHeight();for(let g=0;g<l;g++){const w=c[g];for(let _=0;_<o;_++)w[_]===1&&i++}const h=a.getHeight()*a.getWidth();return Math.floor(Math.abs(i*2-h)*10/h)*ur.N4}static getDataMaskBit(a,i,c){let o,l;switch(a){case 0:o=c+i&1;break;case 1:o=c&1;break;case 2:o=i%3;break;case 3:o=(c+i)%3;break;case 4:o=Math.floor(c/2)+Math.floor(i/3)&1;break;case 5:l=c*i,o=(l&1)+l%3;break;case 6:l=c*i,o=(l&1)+l%3&1;break;case 7:l=c*i,o=l%3+(c+i&1)&1;break;default:throw new E("Invalid mask pattern: "+a)}return o===0}static applyMaskPenaltyRule1Internal(a,i){let c=0;const o=i?a.getHeight():a.getWidth(),l=i?a.getWidth():a.getHeight(),h=a.getArray();for(let d=0;d<o;d++){let g=0,w=-1;for(let _=0;_<l;_++){const C=i?h[d][_]:h[_][d];C===w?g++:(g>=5&&(c+=ur.N1+(g-5)),g=1,w=C)}g>=5&&(c+=ur.N1+(g-5))}return c}}ur.N1=3,ur.N2=3,ur.N3=40,ur.N4=10;class wi{constructor(a,i){this.width=a,this.height=i;const c=new Array(i);for(let o=0;o!==i;o++)c[o]=new Uint8Array(a);this.bytes=c}getHeight(){return this.height}getWidth(){return this.width}get(a,i){return this.bytes[i][a]}getArray(){return this.bytes}setNumber(a,i,c){this.bytes[i][a]=c}setBoolean(a,i,c){this.bytes[i][a]=c?1:0}clear(a){for(const i of this.bytes)G.fill(i,a)}equals(a){if(!(a instanceof wi))return!1;const i=a;if(this.width!==i.width||this.height!==i.height)return!1;for(let c=0,o=this.height;c<o;++c){const l=this.bytes[c],h=i.bytes[c];for(let d=0,g=this.width;d<g;++d)if(l[d]!==h[d])return!1}return!0}toString(){const a=new pe;for(let i=0,c=this.height;i<c;++i){const o=this.bytes[i];for(let l=0,h=this.width;l<h;++l)switch(o[l]){case 0:a.append(" 0");break;case 1:a.append(" 1");break;default:a.append("  ");break}a.append(`
`)}return a.toString()}}class dn{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const a=new pe;return a.append(`<<
`),a.append(" mode: "),a.append(this.mode?this.mode.toString():"null"),a.append(`
 ecLevel: `),a.append(this.ecLevel?this.ecLevel.toString():"null"),a.append(`
 version: `),a.append(this.version?this.version.toString():"null"),a.append(`
 maskPattern: `),a.append(this.maskPattern.toString()),this.matrix?(a.append(`
 matrix:
`),a.append(this.matrix.toString())):a.append(`
 matrix: null
`),a.append(`>>
`),a.toString()}setMode(a){this.mode=a}setECLevel(a){this.ecLevel=a}setVersion(a){this.version=a}setMaskPattern(a){this.maskPattern=a}setMatrix(a){this.matrix=a}static isValidMaskPattern(a){return a>=0&&a<dn.NUM_MASK_PATTERNS}}dn.NUM_MASK_PATTERNS=8;class jt extends m{}jt.kind="WriterException";class $e{constructor(){}static clearMatrix(a){a.clear(255)}static buildMatrix(a,i,c,o,l){$e.clearMatrix(l),$e.embedBasicPatterns(c,l),$e.embedTypeInfo(i,o,l),$e.maybeEmbedVersionInfo(c,l),$e.embedDataBits(a,o,l)}static embedBasicPatterns(a,i){$e.embedPositionDetectionPatternsAndSeparators(i),$e.embedDarkDotAtLeftBottomCorner(i),$e.maybeEmbedPositionAdjustmentPatterns(a,i),$e.embedTimingPatterns(i)}static embedTypeInfo(a,i,c){const o=new J;$e.makeTypeInfoBits(a,i,o);for(let l=0,h=o.getSize();l<h;++l){const d=o.get(o.getSize()-1-l),g=$e.TYPE_INFO_COORDINATES[l],w=g[0],_=g[1];if(c.setBoolean(w,_,d),l<8){const C=c.getWidth()-l-1;c.setBoolean(C,8,d)}else{const T=c.getHeight()-7+(l-8);c.setBoolean(8,T,d)}}}static maybeEmbedVersionInfo(a,i){if(a.getVersionNumber()<7)return;const c=new J;$e.makeVersionInfoBits(a,c);let o=6*3-1;for(let l=0;l<6;++l)for(let h=0;h<3;++h){const d=c.get(o);o--,i.setBoolean(l,i.getHeight()-11+h,d),i.setBoolean(i.getHeight()-11+h,l,d)}}static embedDataBits(a,i,c){let o=0,l=-1,h=c.getWidth()-1,d=c.getHeight()-1;for(;h>0;){for(h===6&&(h-=1);d>=0&&d<c.getHeight();){for(let g=0;g<2;++g){const w=h-g;if(!$e.isEmpty(c.get(w,d)))continue;let _;o<a.getSize()?(_=a.get(o),++o):_=!1,i!==255&&ur.getDataMaskBit(i,w,d)&&(_=!_),c.setBoolean(w,d,_)}d+=l}l=-l,d+=l,h-=2}if(o!==a.getSize())throw new jt("Not all bits consumed: "+o+"/"+a.getSize())}static findMSBSet(a){return 32-D.numberOfLeadingZeros(a)}static calculateBCHCode(a,i){if(i===0)throw new E("0 polynomial");const c=$e.findMSBSet(i);for(a<<=c-1;$e.findMSBSet(a)>=c;)a^=i<<$e.findMSBSet(a)-c;return a}static makeTypeInfoBits(a,i,c){if(!dn.isValidMaskPattern(i))throw new jt("Invalid mask pattern");const o=a.getBits()<<3|i;c.appendBits(o,5);const l=$e.calculateBCHCode(o,$e.TYPE_INFO_POLY);c.appendBits(l,10);const h=new J;if(h.appendBits($e.TYPE_INFO_MASK_PATTERN,15),c.xor(h),c.getSize()!==15)throw new jt("should not happen but we got: "+c.getSize())}static makeVersionInfoBits(a,i){i.appendBits(a.getVersionNumber(),6);const c=$e.calculateBCHCode(a.getVersionNumber(),$e.VERSION_INFO_POLY);if(i.appendBits(c,12),i.getSize()!==18)throw new jt("should not happen but we got: "+i.getSize())}static isEmpty(a){return a===255}static embedTimingPatterns(a){for(let i=8;i<a.getWidth()-8;++i){const c=(i+1)%2;$e.isEmpty(a.get(i,6))&&a.setNumber(i,6,c),$e.isEmpty(a.get(6,i))&&a.setNumber(6,i,c)}}static embedDarkDotAtLeftBottomCorner(a){if(a.get(8,a.getHeight()-8)===0)throw new jt;a.setNumber(8,a.getHeight()-8,1)}static embedHorizontalSeparationPattern(a,i,c){for(let o=0;o<8;++o){if(!$e.isEmpty(c.get(a+o,i)))throw new jt;c.setNumber(a+o,i,0)}}static embedVerticalSeparationPattern(a,i,c){for(let o=0;o<7;++o){if(!$e.isEmpty(c.get(a,i+o)))throw new jt;c.setNumber(a,i+o,0)}}static embedPositionAdjustmentPattern(a,i,c){for(let o=0;o<5;++o){const l=$e.POSITION_ADJUSTMENT_PATTERN[o];for(let h=0;h<5;++h)c.setNumber(a+h,i+o,l[h])}}static embedPositionDetectionPattern(a,i,c){for(let o=0;o<7;++o){const l=$e.POSITION_DETECTION_PATTERN[o];for(let h=0;h<7;++h)c.setNumber(a+h,i+o,l[h])}}static embedPositionDetectionPatternsAndSeparators(a){const i=$e.POSITION_DETECTION_PATTERN[0].length;$e.embedPositionDetectionPattern(0,0,a),$e.embedPositionDetectionPattern(a.getWidth()-i,0,a),$e.embedPositionDetectionPattern(0,a.getWidth()-i,a);const c=8;$e.embedHorizontalSeparationPattern(0,c-1,a),$e.embedHorizontalSeparationPattern(a.getWidth()-c,c-1,a),$e.embedHorizontalSeparationPattern(0,a.getWidth()-c,a);const o=7;$e.embedVerticalSeparationPattern(o,0,a),$e.embedVerticalSeparationPattern(a.getHeight()-o-1,0,a),$e.embedVerticalSeparationPattern(o,a.getHeight()-o,a)}static maybeEmbedPositionAdjustmentPatterns(a,i){if(a.getVersionNumber()<2)return;const c=a.getVersionNumber()-1,o=$e.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[c];for(let l=0,h=o.length;l!==h;l++){const d=o[l];if(d>=0)for(let g=0;g!==h;g++){const w=o[g];w>=0&&$e.isEmpty(i.get(w,d))&&$e.embedPositionAdjustmentPattern(w-2,d-2,i)}}}}$e.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),$e.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),$e.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),$e.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),$e.VERSION_INFO_POLY=7973,$e.TYPE_INFO_POLY=1335,$e.TYPE_INFO_MASK_PATTERN=21522;class E0{constructor(a,i){this.dataBytes=a,this.errorCorrectionBytes=i}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class $t{constructor(){}static calculateMaskPenalty(a){return ur.applyMaskPenaltyRule1(a)+ur.applyMaskPenaltyRule2(a)+ur.applyMaskPenaltyRule3(a)+ur.applyMaskPenaltyRule4(a)}static encode(a,i,c=null){let o=$t.DEFAULT_BYTE_MODE_ENCODING;const l=c!==null&&c.get(hr.CHARACTER_SET)!==void 0;l&&(o=c.get(hr.CHARACTER_SET).toString());const h=this.chooseMode(a,o),d=new J;if(h===Ze.BYTE&&(l||$t.DEFAULT_BYTE_MODE_ENCODING!==o)){const Te=X.getCharacterSetECIByName(o);Te!==void 0&&this.appendECI(Te,d)}this.appendModeInfo(h,d);const g=new J;this.appendBytes(a,h,g,o);let w;if(c!==null&&c.get(hr.QR_VERSION)!==void 0){const Te=Number.parseInt(c.get(hr.QR_VERSION).toString(),10);w=qe.getVersionForNumber(Te);const ce=this.calculateBitsNeeded(h,d,g,w);if(!this.willFit(ce,w,i))throw new jt("Data too big for requested version")}else w=this.recommendVersion(i,h,d,g);const _=new J;_.appendBitArray(d);const C=h===Ze.BYTE?g.getSizeInBytes():a.length;this.appendLengthInfo(C,w,h,_),_.appendBitArray(g);const T=w.getECBlocksForLevel(i),R=w.getTotalCodewords()-T.getTotalECCodewords();this.terminateBits(R,_);const L=this.interleaveWithECBytes(_,w.getTotalCodewords(),R,T.getNumBlocks()),W=new dn;W.setECLevel(i),W.setMode(h),W.setVersion(w);const te=w.getDimensionForVersion(),se=new wi(te,te),Ce=this.chooseMaskPattern(L,i,w,se);return W.setMaskPattern(Ce),$e.buildMatrix(L,i,w,Ce,se),W.setMatrix(se),W}static recommendVersion(a,i,c,o){const l=this.calculateBitsNeeded(i,c,o,qe.getVersionForNumber(1)),h=this.chooseVersion(l,a),d=this.calculateBitsNeeded(i,c,o,h);return this.chooseVersion(d,a)}static calculateBitsNeeded(a,i,c,o){return i.getSize()+a.getCharacterCountBits(o)+c.getSize()}static getAlphanumericCode(a){return a<$t.ALPHANUMERIC_TABLE.length?$t.ALPHANUMERIC_TABLE[a]:-1}static chooseMode(a,i=null){if(X.SJIS.getName()===i&&this.isOnlyDoubleByteKanji(a))return Ze.KANJI;let c=!1,o=!1;for(let l=0,h=a.length;l<h;++l){const d=a.charAt(l);if($t.isDigit(d))c=!0;else if(this.getAlphanumericCode(d.charCodeAt(0))!==-1)o=!0;else return Ze.BYTE}return o?Ze.ALPHANUMERIC:c?Ze.NUMERIC:Ze.BYTE}static isOnlyDoubleByteKanji(a){let i;try{i=le.encode(a,X.SJIS)}catch{return!1}const c=i.length;if(c%2!==0)return!1;for(let o=0;o<c;o+=2){const l=i[o]&255;if((l<129||l>159)&&(l<224||l>235))return!1}return!0}static chooseMaskPattern(a,i,c,o){let l=Number.MAX_SAFE_INTEGER,h=-1;for(let d=0;d<dn.NUM_MASK_PATTERNS;d++){$e.buildMatrix(a,i,c,d,o);let g=this.calculateMaskPenalty(o);g<l&&(l=g,h=d)}return h}static chooseVersion(a,i){for(let c=1;c<=40;c++){const o=qe.getVersionForNumber(c);if($t.willFit(a,o,i))return o}throw new jt("Data too big")}static willFit(a,i,c){const o=i.getTotalCodewords(),h=i.getECBlocksForLevel(c).getTotalECCodewords(),d=o-h,g=(a+7)/8;return d>=g}static terminateBits(a,i){const c=a*8;if(i.getSize()>c)throw new jt("data bits cannot fit in the QR Code"+i.getSize()+" > "+c);for(let h=0;h<4&&i.getSize()<c;++h)i.appendBit(!1);const o=i.getSize()&7;if(o>0)for(let h=o;h<8;h++)i.appendBit(!1);const l=a-i.getSizeInBytes();for(let h=0;h<l;++h)i.appendBits(h&1?17:236,8);if(i.getSize()!==c)throw new jt("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(a,i,c,o,l,h){if(o>=c)throw new jt("Block ID too large");const d=a%c,g=c-d,w=Math.floor(a/c),_=w+1,C=Math.floor(i/c),T=C+1,R=w-C,L=_-T;if(R!==L)throw new jt("EC bytes mismatch");if(c!==g+d)throw new jt("RS blocks mismatch");if(a!==(C+R)*g+(T+L)*d)throw new jt("Total bytes mismatch");o<g?(l[0]=C,h[0]=R):(l[0]=T,h[0]=L)}static interleaveWithECBytes(a,i,c,o){if(a.getSizeInBytes()!==c)throw new jt("Number of bits and data bytes does not match");let l=0,h=0,d=0;const g=new Array;for(let _=0;_<o;++_){const C=new Int32Array(1),T=new Int32Array(1);$t.getNumDataBytesAndNumECBytesForBlockID(i,c,o,_,C,T);const R=C[0],L=new Uint8Array(R);a.toBytes(8*l,L,0,R);const W=$t.generateECBytes(L,T[0]);g.push(new E0(L,W)),h=Math.max(h,R),d=Math.max(d,W.length),l+=C[0]}if(c!==l)throw new jt("Data bytes does not match offset");const w=new J;for(let _=0;_<h;++_)for(const C of g){const T=C.getDataBytes();_<T.length&&w.appendBits(T[_],8)}for(let _=0;_<d;++_)for(const C of g){const T=C.getErrorCorrectionBytes();_<T.length&&w.appendBits(T[_],8)}if(i!==w.getSizeInBytes())throw new jt("Interleaving error: "+i+" and "+w.getSizeInBytes()+" differ.");return w}static generateECBytes(a,i){const c=a.length,o=new Int32Array(c+i);for(let h=0;h<c;h++)o[h]=a[h]&255;new Wn(Ke.QR_CODE_FIELD_256).encode(o,i);const l=new Uint8Array(i);for(let h=0;h<i;h++)l[h]=o[c+h];return l}static appendModeInfo(a,i){i.appendBits(a.getBits(),4)}static appendLengthInfo(a,i,c,o){const l=c.getCharacterCountBits(i);if(a>=1<<l)throw new jt(a+" is bigger than "+((1<<l)-1));o.appendBits(a,l)}static appendBytes(a,i,c,o){switch(i){case Ze.NUMERIC:$t.appendNumericBytes(a,c);break;case Ze.ALPHANUMERIC:$t.appendAlphanumericBytes(a,c);break;case Ze.BYTE:$t.append8BitBytes(a,c,o);break;case Ze.KANJI:$t.appendKanjiBytes(a,c);break;default:throw new jt("Invalid mode: "+i)}}static getDigit(a){return a.charCodeAt(0)-48}static isDigit(a){const i=$t.getDigit(a);return i>=0&&i<=9}static appendNumericBytes(a,i){const c=a.length;let o=0;for(;o<c;){const l=$t.getDigit(a.charAt(o));if(o+2<c){const h=$t.getDigit(a.charAt(o+1)),d=$t.getDigit(a.charAt(o+2));i.appendBits(l*100+h*10+d,10),o+=3}else if(o+1<c){const h=$t.getDigit(a.charAt(o+1));i.appendBits(l*10+h,7),o+=2}else i.appendBits(l,4),o++}}static appendAlphanumericBytes(a,i){const c=a.length;let o=0;for(;o<c;){const l=$t.getAlphanumericCode(a.charCodeAt(o));if(l===-1)throw new jt;if(o+1<c){const h=$t.getAlphanumericCode(a.charCodeAt(o+1));if(h===-1)throw new jt;i.appendBits(l*45+h,11),o+=2}else i.appendBits(l,6),o++}}static append8BitBytes(a,i,c){let o;try{o=le.encode(a,c)}catch(l){throw new jt(l)}for(let l=0,h=o.length;l!==h;l++){const d=o[l];i.appendBits(d,8)}}static appendKanjiBytes(a,i){let c;try{c=le.encode(a,X.SJIS)}catch(l){throw new jt(l)}const o=c.length;for(let l=0;l<o;l+=2){const h=c[l]&255,d=c[l+1]&255,g=h<<8&4294967295|d;let w=-1;if(g>=33088&&g<=40956?w=g-33088:g>=57408&&g<=60351&&(w=g-49472),w===-1)throw new jt("Invalid byte sequence");const _=(w>>8)*192+(w&255);i.appendBits(_,13)}}static appendECI(a,i){i.appendBits(Ze.ECI.getBits(),4),i.appendBits(a.getValue(),8)}}$t.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),$t.DEFAULT_BYTE_MODE_ENCODING=X.UTF8.getName();class La{write(a,i,c,o=null){if(a.length===0)throw new E("Found empty contents");if(i<0||c<0)throw new E("Requested dimensions are too small: "+i+"x"+c);let l=Kt.L,h=La.QUIET_ZONE_SIZE;o!==null&&(o.get(hr.ERROR_CORRECTION)!==void 0&&(l=Kt.fromString(o.get(hr.ERROR_CORRECTION).toString())),o.get(hr.MARGIN)!==void 0&&(h=Number.parseInt(o.get(hr.MARGIN).toString(),10)));const d=$t.encode(a,l,o);return this.renderResult(d,i,c,h)}writeToDom(a,i,c,o,l=null){typeof a=="string"&&(a=document.querySelector(a));const h=this.write(i,c,o,l);a&&a.appendChild(h)}renderResult(a,i,c,o){const l=a.getMatrix();if(l===null)throw new _t;const h=l.getWidth(),d=l.getHeight(),g=h+o*2,w=d+o*2,_=Math.max(i,g),C=Math.max(c,w),T=Math.min(Math.floor(_/g),Math.floor(C/w)),R=Math.floor((_-h*T)/2),L=Math.floor((C-d*T)/2),W=this.createSVGElement(_,C);for(let te=0,se=L;te<d;te++,se+=T)for(let Ce=0,Te=R;Ce<h;Ce++,Te+=T)if(l.get(Ce,te)===1){const ce=this.createSvgRectElement(Te,se,T,T);W.appendChild(ce)}return W}createSVGElement(a,i){const c=document.createElementNS(La.SVG_NS,"svg");return c.setAttributeNS(null,"height",a.toString()),c.setAttributeNS(null,"width",i.toString()),c}createSvgRectElement(a,i,c,o){const l=document.createElementNS(La.SVG_NS,"rect");return l.setAttributeNS(null,"x",a.toString()),l.setAttributeNS(null,"y",i.toString()),l.setAttributeNS(null,"height",c.toString()),l.setAttributeNS(null,"width",o.toString()),l.setAttributeNS(null,"fill","#000000"),l}}La.QUIET_ZONE_SIZE=4,La.SVG_NS="http://www.w3.org/2000/svg";class Vn{encode(a,i,c,o,l){if(a.length===0)throw new E("Found empty contents");if(i!==B.QR_CODE)throw new E("Can only encode QR_CODE, but got "+i);if(c<0||o<0)throw new E(`Requested dimensions are too small: ${c}x${o}`);let h=Kt.L,d=Vn.QUIET_ZONE_SIZE;l!==null&&(l.get(hr.ERROR_CORRECTION)!==void 0&&(h=Kt.fromString(l.get(hr.ERROR_CORRECTION).toString())),l.get(hr.MARGIN)!==void 0&&(d=Number.parseInt(l.get(hr.MARGIN).toString(),10)));const g=$t.encode(a,h,l);return Vn.renderResult(g,c,o,d)}static renderResult(a,i,c,o){const l=a.getMatrix();if(l===null)throw new _t;const h=l.getWidth(),d=l.getHeight(),g=h+o*2,w=d+o*2,_=Math.max(i,g),C=Math.max(c,w),T=Math.min(Math.floor(_/g),Math.floor(C/w)),R=Math.floor((_-h*T)/2),L=Math.floor((C-d*T)/2),W=new Pe(_,C);for(let te=0,se=L;te<d;te++,se+=T)for(let Ce=0,Te=R;Ce<h;Ce++,Te+=T)l.get(Ce,te)===1&&W.setRegion(Te,se,T,T);return W}}Vn.QUIET_ZONE_SIZE=4;class Mo{encode(a,i,c,o,l){let h;switch(i){case B.QR_CODE:h=new Vn;break;default:throw new E("No encoder available for format "+i)}return h.encode(a,i,c,o,l)}}class Sa extends St{constructor(a,i,c,o,l,h,d,g){if(super(h,d),this.yuvData=a,this.dataWidth=i,this.dataHeight=c,this.left=o,this.top=l,o+h>i||l+d>c)throw new E("Crop rectangle does not fit within image data.");g&&this.reverseHorizontal(h,d)}getRow(a,i){if(a<0||a>=this.getHeight())throw new E("Requested row is outside the image: "+a);const c=this.getWidth();(i==null||i.length<c)&&(i=new Uint8ClampedArray(c));const o=(a+this.top)*this.dataWidth+this.left;return A.arraycopy(this.yuvData,o,i,0,c),i}getMatrix(){const a=this.getWidth(),i=this.getHeight();if(a===this.dataWidth&&i===this.dataHeight)return this.yuvData;const c=a*i,o=new Uint8ClampedArray(c);let l=this.top*this.dataWidth+this.left;if(a===this.dataWidth)return A.arraycopy(this.yuvData,l,o,0,c),o;for(let h=0;h<i;h++){const d=h*a;A.arraycopy(this.yuvData,l,o,d,a),l+=this.dataWidth}return o}isCropSupported(){return!0}crop(a,i,c,o){return new Sa(this.yuvData,this.dataWidth,this.dataHeight,this.left+a,this.top+i,c,o,!1)}renderThumbnail(){const a=this.getWidth()/Sa.THUMBNAIL_SCALE_FACTOR,i=this.getHeight()/Sa.THUMBNAIL_SCALE_FACTOR,c=new Int32Array(a*i),o=this.yuvData;let l=this.top*this.dataWidth+this.left;for(let h=0;h<i;h++){const d=h*a;for(let g=0;g<a;g++){const w=o[l+g*Sa.THUMBNAIL_SCALE_FACTOR]&255;c[d+g]=4278190080|w*65793}l+=this.dataWidth*Sa.THUMBNAIL_SCALE_FACTOR}return c}getThumbnailWidth(){return this.getWidth()/Sa.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Sa.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(a,i){const c=this.yuvData;for(let o=0,l=this.top*this.dataWidth+this.left;o<i;o++,l+=this.dataWidth){const h=l+a/2;for(let d=l,g=l+a-1;d<h;d++,g--){const w=c[d];c[d]=c[g],c[g]=w}}}invert(){return new ue(this)}}Sa.THUMBNAIL_SCALE_FACTOR=2;class _s extends St{constructor(a,i,c,o,l,h,d){if(super(i,c),this.dataWidth=o,this.dataHeight=l,this.left=h,this.top=d,a.BYTES_PER_ELEMENT===4){const g=i*c,w=new Uint8ClampedArray(g);for(let _=0;_<g;_++){const C=a[_],T=C>>16&255,R=C>>7&510,L=C&255;w[_]=(T+R+L)/4&255}this.luminances=w}else this.luminances=a;if(o===void 0&&(this.dataWidth=i),l===void 0&&(this.dataHeight=c),h===void 0&&(this.left=0),d===void 0&&(this.top=0),this.left+i>this.dataWidth||this.top+c>this.dataHeight)throw new E("Crop rectangle does not fit within image data.")}getRow(a,i){if(a<0||a>=this.getHeight())throw new E("Requested row is outside the image: "+a);const c=this.getWidth();(i==null||i.length<c)&&(i=new Uint8ClampedArray(c));const o=(a+this.top)*this.dataWidth+this.left;return A.arraycopy(this.luminances,o,i,0,c),i}getMatrix(){const a=this.getWidth(),i=this.getHeight();if(a===this.dataWidth&&i===this.dataHeight)return this.luminances;const c=a*i,o=new Uint8ClampedArray(c);let l=this.top*this.dataWidth+this.left;if(a===this.dataWidth)return A.arraycopy(this.luminances,l,o,0,c),o;for(let h=0;h<i;h++){const d=h*a;A.arraycopy(this.luminances,l,o,d,a),l+=this.dataWidth}return o}isCropSupported(){return!0}crop(a,i,c,o){return new _s(this.luminances,c,o,this.dataWidth,this.dataHeight,this.left+a,this.top+i)}invert(){return new ue(this)}}class _0 extends X{static forName(a){return this.getCharacterSetECIByName(a)}}class Xi{}Xi.ISO_8859_1=X.ISO8859_1;class A0{isCompact(){return this.compact}setCompact(a){this.compact=a}getSize(){return this.size}setSize(a){this.size=a}getLayers(){return this.layers}setLayers(a){this.layers=a}getCodeWords(){return this.codeWords}setCodeWords(a){this.codeWords=a}getMatrix(){return this.matrix}setMatrix(a){this.matrix=a}}class zi{static singletonList(a){return[a]}static min(a,i){return a.sort(i)[0]}}class b0{constructor(a){this.previous=a}getPrevious(){return this.previous}}class Hn extends b0{constructor(a,i,c){super(a),this.value=i,this.bitCount=c}appendTo(a,i){a.appendBits(this.value,this.bitCount)}add(a,i){return new Hn(this,a,i)}addBinaryShift(a,i){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Hn(this,a,i)}toString(){let a=this.value&(1<<this.bitCount)-1;return a|=1<<this.bitCount,"<"+D.toBinaryString(a|1<<this.bitCount).substring(1)+">"}}class Gn extends Hn{constructor(a,i,c){super(a,0,0),this.binaryShiftStart=i,this.binaryShiftByteCount=c}appendTo(a,i){for(let c=0;c<this.binaryShiftByteCount;c++)(c===0||c===31&&this.binaryShiftByteCount<=62)&&(a.appendBits(31,5),this.binaryShiftByteCount>62?a.appendBits(this.binaryShiftByteCount-31,16):c===0?a.appendBits(Math.min(this.binaryShiftByteCount,31),5):a.appendBits(this.binaryShiftByteCount-31,5)),a.appendBits(i[this.binaryShiftStart+c],8)}addBinaryShift(a,i){return new Gn(this,a,i)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Po(I,a,i){return new Gn(I,a,i)}function Xn(I,a,i){return new Hn(I,a,i)}const Yi=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Sn=0,Nn=1,da=2,Ki=3,Na=4,As=new Hn(null,0,0),qi=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function C0(I){for(let a of I)G.fill(a,-1);return I[Sn][Na]=0,I[Nn][Na]=0,I[Nn][Sn]=28,I[Ki][Na]=0,I[da][Na]=0,I[da][Sn]=15,I}const bs=C0(G.createInt32Array(6,6));class ka{constructor(a,i,c,o){this.token=a,this.mode=i,this.binaryShiftByteCount=c,this.bitCount=o}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(a,i){let c=this.bitCount,o=this.token;if(a!==this.mode){let h=qi[this.mode][a];o=Xn(o,h&65535,h>>16),c+=h>>16}let l=a===da?4:5;return o=Xn(o,i,l),new ka(o,a,0,c+l)}shiftAndAppend(a,i){let c=this.token,o=this.mode===da?4:5;return c=Xn(c,bs[this.mode][a],o),c=Xn(c,i,5),new ka(c,this.mode,0,this.bitCount+o+5)}addBinaryShiftChar(a){let i=this.token,c=this.mode,o=this.bitCount;if(this.mode===Na||this.mode===da){let d=qi[c][Sn];i=Xn(i,d&65535,d>>16),o+=d>>16,c=Sn}let l=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,h=new ka(i,c,this.binaryShiftByteCount+1,o+l);return h.binaryShiftByteCount===2078&&(h=h.endBinaryShift(a+1)),h}endBinaryShift(a){if(this.binaryShiftByteCount===0)return this;let i=this.token;return i=Po(i,a-this.binaryShiftByteCount,this.binaryShiftByteCount),new ka(i,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(a){let i=this.bitCount+(qi[this.mode][a.mode]>>16);return this.binaryShiftByteCount<a.binaryShiftByteCount?i+=ka.calculateBinaryShiftCost(a)-ka.calculateBinaryShiftCost(this):this.binaryShiftByteCount>a.binaryShiftByteCount&&a.binaryShiftByteCount>0&&(i+=10),i<=a.bitCount}toBitArray(a){let i=[];for(let o=this.endBinaryShift(a.length).token;o!==null;o=o.getPrevious())i.unshift(o);let c=new J;for(const o of i)o.appendTo(c,a);return c}toString(){return ee.format("%s bits=%d bytes=%d",Yi[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(a){return a.binaryShiftByteCount>62?21:a.binaryShiftByteCount>31?20:a.binaryShiftByteCount>0?10:0}}ka.INITIAL_STATE=new ka(As,Sn,0,0);function T0(I){const a=ee.getCharCode(" "),i=ee.getCharCode("."),c=ee.getCharCode(",");I[Sn][a]=1;const o=ee.getCharCode("Z"),l=ee.getCharCode("A");for(let T=l;T<=o;T++)I[Sn][T]=T-l+2;I[Nn][a]=1;const h=ee.getCharCode("z"),d=ee.getCharCode("a");for(let T=d;T<=h;T++)I[Nn][T]=T-d+2;I[da][a]=1;const g=ee.getCharCode("9"),w=ee.getCharCode("0");for(let T=w;T<=g;T++)I[da][T]=T-w+2;I[da][c]=12,I[da][i]=13;const _=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let T=0;T<_.length;T++)I[Ki][ee.getCharCode(_[T])]=T;const C=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let T=0;T<C.length;T++)ee.getCharCode(C[T])>0&&(I[Na][ee.getCharCode(C[T])]=T);return I}const zn=T0(G.createInt32Array(5,256));class vi{constructor(a){this.text=a}encode(){const a=ee.getCharCode(" "),i=ee.getCharCode(`
`);let c=zi.singletonList(ka.INITIAL_STATE);for(let l=0;l<this.text.length;l++){let h,d=l+1<this.text.length?this.text[l+1]:0;switch(this.text[l]){case ee.getCharCode("\r"):h=d===i?2:0;break;case ee.getCharCode("."):h=d===a?3:0;break;case ee.getCharCode(","):h=d===a?4:0;break;case ee.getCharCode(":"):h=d===a?5:0;break;default:h=0}h>0?(c=vi.updateStateListForPair(c,l,h),l++):c=this.updateStateListForChar(c,l)}return zi.min(c,(l,h)=>l.getBitCount()-h.getBitCount()).toBitArray(this.text)}updateStateListForChar(a,i){const c=[];for(let o of a)this.updateStateForChar(o,i,c);return vi.simplifyStates(c)}updateStateForChar(a,i,c){let o=this.text[i]&255,l=zn[a.getMode()][o]>0,h=null;for(let d=0;d<=Na;d++){let g=zn[d][o];if(g>0){if(h==null&&(h=a.endBinaryShift(i)),!l||d===a.getMode()||d===da){const w=h.latchAndAppend(d,g);c.push(w)}if(!l&&bs[a.getMode()][d]>=0){const w=h.shiftAndAppend(d,g);c.push(w)}}}if(a.getBinaryShiftByteCount()>0||zn[a.getMode()][o]===0){let d=a.addBinaryShiftChar(i);c.push(d)}}static updateStateListForPair(a,i,c){const o=[];for(let l of a)this.updateStateForPair(l,i,c,o);return this.simplifyStates(o)}static updateStateForPair(a,i,c,o){let l=a.endBinaryShift(i);if(o.push(l.latchAndAppend(Na,c)),a.getMode()!==Na&&o.push(l.shiftAndAppend(Na,c)),c===3||c===4){let h=l.latchAndAppend(da,16-c).latchAndAppend(da,1);o.push(h)}if(a.getBinaryShiftByteCount()>0){let h=a.addBinaryShiftChar(i).addBinaryShiftChar(i+1);o.push(h)}}static simplifyStates(a){let i=[];for(const c of a){let o=!0;for(const l of i){if(l.isBetterThanOrEqualTo(c)){o=!1;break}c.isBetterThanOrEqualTo(l)&&(i=i.filter(h=>h!==l))}o&&i.push(c)}return i}}class Dt{constructor(){}static encodeBytes(a){return Dt.encode(a,Dt.DEFAULT_EC_PERCENT,Dt.DEFAULT_AZTEC_LAYERS)}static encode(a,i,c){let o=new vi(a).encode(),l=D.truncDivision(o.getSize()*i,100)+11,h=o.getSize()+l,d,g,w,_,C;if(c!==Dt.DEFAULT_AZTEC_LAYERS){if(d=c<0,g=Math.abs(c),g>(d?Dt.MAX_NB_BITS_COMPACT:Dt.MAX_NB_BITS))throw new E(ee.format("Illegal value %s for layers",c));w=Dt.totalBitsInLayer(g,d),_=Dt.WORD_SIZE[g];let ce=w-w%_;if(C=Dt.stuffBits(o,_),C.getSize()+l>ce)throw new E("Data to large for user specified layer");if(d&&C.getSize()>_*64)throw new E("Data to large for user specified layer")}else{_=0,C=null;for(let ce=0;;ce++){if(ce>Dt.MAX_NB_BITS)throw new E("Data too large for an Aztec code");if(d=ce<=3,g=d?ce+1:ce,w=Dt.totalBitsInLayer(g,d),h>w)continue;(C==null||_!==Dt.WORD_SIZE[g])&&(_=Dt.WORD_SIZE[g],C=Dt.stuffBits(o,_));let Ve=w-w%_;if(!(d&&C.getSize()>_*64)&&C.getSize()+l<=Ve)break}}let T=Dt.generateCheckWords(C,w,_),R=C.getSize()/_,L=Dt.generateModeMessage(d,g,R),W=(d?11:14)+g*4,te=new Int32Array(W),se;if(d){se=W;for(let ce=0;ce<te.length;ce++)te[ce]=ce}else{se=W+1+2*D.truncDivision(D.truncDivision(W,2)-1,15);let ce=D.truncDivision(W,2),Ve=D.truncDivision(se,2);for(let ze=0;ze<ce;ze++){let kt=ze+D.truncDivision(ze,15);te[ce-ze-1]=Ve-kt-1,te[ce+ze]=Ve+kt+1}}let Ce=new Pe(se);for(let ce=0,Ve=0;ce<g;ce++){let ze=(g-ce)*4+(d?9:12);for(let kt=0;kt<ze;kt++){let Ot=kt*2;for(let It=0;It<2;It++)T.get(Ve+Ot+It)&&Ce.set(te[ce*2+It],te[ce*2+kt]),T.get(Ve+ze*2+Ot+It)&&Ce.set(te[ce*2+kt],te[W-1-ce*2-It]),T.get(Ve+ze*4+Ot+It)&&Ce.set(te[W-1-ce*2-It],te[W-1-ce*2-kt]),T.get(Ve+ze*6+Ot+It)&&Ce.set(te[W-1-ce*2-kt],te[ce*2+It])}Ve+=ze*8}if(Dt.drawModeMessage(Ce,d,se,L),d)Dt.drawBullsEye(Ce,D.truncDivision(se,2),5);else{Dt.drawBullsEye(Ce,D.truncDivision(se,2),7);for(let ce=0,Ve=0;ce<D.truncDivision(W,2)-1;ce+=15,Ve+=16)for(let ze=D.truncDivision(se,2)&1;ze<se;ze+=2)Ce.set(D.truncDivision(se,2)-Ve,ze),Ce.set(D.truncDivision(se,2)+Ve,ze),Ce.set(ze,D.truncDivision(se,2)-Ve),Ce.set(ze,D.truncDivision(se,2)+Ve)}let Te=new A0;return Te.setCompact(d),Te.setSize(se),Te.setLayers(g),Te.setCodeWords(R),Te.setMatrix(Ce),Te}static drawBullsEye(a,i,c){for(let o=0;o<c;o+=2)for(let l=i-o;l<=i+o;l++)a.set(l,i-o),a.set(l,i+o),a.set(i-o,l),a.set(i+o,l);a.set(i-c,i-c),a.set(i-c+1,i-c),a.set(i-c,i-c+1),a.set(i+c,i-c),a.set(i+c,i-c+1),a.set(i+c,i+c-1)}static generateModeMessage(a,i,c){let o=new J;return a?(o.appendBits(i-1,2),o.appendBits(c-1,6),o=Dt.generateCheckWords(o,28,4)):(o.appendBits(i-1,5),o.appendBits(c-1,11),o=Dt.generateCheckWords(o,40,4)),o}static drawModeMessage(a,i,c,o){let l=D.truncDivision(c,2);if(i)for(let h=0;h<7;h++){let d=l-3+h;o.get(h)&&a.set(d,l-5),o.get(h+7)&&a.set(l+5,d),o.get(20-h)&&a.set(d,l+5),o.get(27-h)&&a.set(l-5,d)}else for(let h=0;h<10;h++){let d=l-5+h+D.truncDivision(h,5);o.get(h)&&a.set(d,l-7),o.get(h+10)&&a.set(l+7,d),o.get(29-h)&&a.set(d,l+7),o.get(39-h)&&a.set(l-7,d)}}static generateCheckWords(a,i,c){let o=a.getSize()/c,l=new Wn(Dt.getGF(c)),h=D.truncDivision(i,c),d=Dt.bitsToWords(a,c,h);l.encode(d,h-o);let g=i%c,w=new J;w.appendBits(0,g);for(const _ of Array.from(d))w.appendBits(_,c);return w}static bitsToWords(a,i,c){let o=new Int32Array(c),l,h;for(l=0,h=a.getSize()/i;l<h;l++){let d=0;for(let g=0;g<i;g++)d|=a.get(l*i+g)?1<<i-g-1:0;o[l]=d}return o}static getGF(a){switch(a){case 4:return Ke.AZTEC_PARAM;case 6:return Ke.AZTEC_DATA_6;case 8:return Ke.AZTEC_DATA_8;case 10:return Ke.AZTEC_DATA_10;case 12:return Ke.AZTEC_DATA_12;default:throw new E("Unsupported word size "+a)}}static stuffBits(a,i){let c=new J,o=a.getSize(),l=(1<<i)-2;for(let h=0;h<o;h+=i){let d=0;for(let g=0;g<i;g++)(h+g>=o||a.get(h+g))&&(d|=1<<i-1-g);(d&l)===l?(c.appendBits(d&l,i),h--):d&l?c.appendBits(d,i):(c.appendBits(d|1,i),h--)}return c}static totalBitsInLayer(a,i){return((i?88:112)+16*a)*a}}Dt.DEFAULT_EC_PERCENT=33,Dt.DEFAULT_AZTEC_LAYERS=0,Dt.MAX_NB_BITS=32,Dt.MAX_NB_BITS_COMPACT=4,Dt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Yn{encode(a,i,c,o){return this.encodeWithHints(a,i,c,o,null)}encodeWithHints(a,i,c,o,l){let h=Xi.ISO_8859_1,d=Dt.DEFAULT_EC_PERCENT,g=Dt.DEFAULT_AZTEC_LAYERS;return l!=null&&(l.has(hr.CHARACTER_SET)&&(h=_0.forName(l.get(hr.CHARACTER_SET).toString())),l.has(hr.ERROR_CORRECTION)&&(d=D.parseInt(l.get(hr.ERROR_CORRECTION).toString())),l.has(hr.AZTEC_LAYERS)&&(g=D.parseInt(l.get(hr.AZTEC_LAYERS).toString()))),Yn.encodeLayers(a,i,c,o,h,d,g)}static encodeLayers(a,i,c,o,l,h,d){if(i!==B.AZTEC)throw new E("Can only encode AZTEC, but got "+i);let g=Dt.encode(ee.getBytes(a,l),h,d);return Yn.renderResult(g,c,o)}static renderResult(a,i,c){let o=a.getMatrix();if(o==null)throw new _t;let l=o.getWidth(),h=o.getHeight(),d=Math.max(i,l),g=Math.max(c,h),w=Math.min(d/l,g/h),_=(d-l*w)/2,C=(g-h*w)/2,T=new Pe(d,g);for(let R=0,L=C;R<h;R++,L+=w)for(let W=0,te=_;W<l;W++,te+=w)o.get(W,R)&&T.setRegion(te,L,w,w);return T}}t.AbstractExpandedDecoder=U,t.ArgumentException=v,t.ArithmeticException=Z,t.AztecCode=A0,t.AztecCodeReader=Yt,t.AztecCodeWriter=Yn,t.AztecDecoder=tt,t.AztecDetector=lt,t.AztecDetectorResult=Br,t.AztecEncoder=Dt,t.AztecHighLevelEncoder=vi,t.AztecPoint=zt,t.BarcodeFormat=B,t.Binarizer=k,t.BinaryBitmap=b,t.BitArray=J,t.BitMatrix=Pe,t.BitSource=g0,t.BrowserAztecCodeReader=kr,t.BrowserBarcodeReader=ea,t.BrowserCodeReader=ae,t.BrowserDatamatrixCodeReader=ps,t.BrowserMultiFormatReader=Gi,t.BrowserPDF417Reader=Oo,t.BrowserQRCodeReader=Ro,t.BrowserQRCodeSvgWriter=La,t.CharacterSetECI=X,t.ChecksumException=S,t.Code128Reader=De,t.Code39Reader=tr,t.DataMatrixDecodedBitStreamParser=bn,t.DataMatrixReader=Pa,t.DecodeHintType=Q,t.DecoderResult=ve,t.DefaultGridSampler=cn,t.DetectorResult=br,t.EAN13Reader=wr,t.EncodeHintType=hr,t.Exception=m,t.FormatException=M,t.GenericGF=Ke,t.GenericGFPoly=Xe,t.GlobalHistogramBinarizer=Le,t.GridSampler=zr,t.GridSamplerInstance=Jt,t.HTMLCanvasElementLuminanceSource=Ye,t.HybridBinarizer=be,t.ITFReader=Nt,t.IllegalArgumentException=E,t.IllegalStateException=_t,t.InvertedLuminanceSource=ue,t.LuminanceSource=St,t.MathUtils=nt,t.MultiFormatOneDReader=Kr,t.MultiFormatReader=Hi,t.MultiFormatWriter=Mo,t.NotFoundException=re,t.OneDReader=ft,t.PDF417DecodedBitStreamParser=ge,t.PDF417DecoderErrorCorrection=w0,t.PDF417Reader=sr,t.PDF417ResultMetadata=Ui,t.PerspectiveTransform=xr,t.PlanarYUVLuminanceSource=Sa,t.QRCodeByteMatrix=wi,t.QRCodeDataMask=ha,t.QRCodeDecodedBitStreamParser=rr,t.QRCodeDecoderErrorCorrectionLevel=Kt,t.QRCodeDecoderFormatInformation=Vr,t.QRCodeEncoder=$t,t.QRCodeEncoderQRCode=dn,t.QRCodeMaskUtil=ur,t.QRCodeMatrixUtil=$e,t.QRCodeMode=Ze,t.QRCodeReader=ua,t.QRCodeVersion=qe,t.QRCodeWriter=Vn,t.RGBLuminanceSource=_s,t.RSS14Reader=ht,t.RSSExpandedReader=Ee,t.ReaderException=Ba,t.ReedSolomonDecoder=ct,t.ReedSolomonEncoder=Wn,t.ReedSolomonException=xt,t.Result=z,t.ResultMetadataType=we,t.ResultPoint=We,t.StringUtils=ee,t.UnsupportedOperationException=me,t.VideoInputDevice=Qe,t.WhiteRectangleDetector=Zt,t.WriterException=jt,t.ZXingArrays=G,t.ZXingCharset=_0,t.ZXingInteger=D,t.ZXingStandardCharsets=Xi,t.ZXingStringBuilder=pe,t.ZXingStringEncoding=le,t.ZXingSystem=A,t.createAbstractExpandedDecoder=Re,Object.defineProperty(t,"__esModule",{value:!0})})})(pc,pc.exports);var or=pc.exports;const T_=xu(or),S_=Lu({__proto__:null,default:T_},[or]);var Kf=function(){function e(r,t,n){if(this.formatMap=new Map([[Ge.QR_CODE,or.BarcodeFormat.QR_CODE],[Ge.AZTEC,or.BarcodeFormat.AZTEC],[Ge.CODABAR,or.BarcodeFormat.CODABAR],[Ge.CODE_39,or.BarcodeFormat.CODE_39],[Ge.CODE_93,or.BarcodeFormat.CODE_93],[Ge.CODE_128,or.BarcodeFormat.CODE_128],[Ge.DATA_MATRIX,or.BarcodeFormat.DATA_MATRIX],[Ge.MAXICODE,or.BarcodeFormat.MAXICODE],[Ge.ITF,or.BarcodeFormat.ITF],[Ge.EAN_13,or.BarcodeFormat.EAN_13],[Ge.EAN_8,or.BarcodeFormat.EAN_8],[Ge.PDF_417,or.BarcodeFormat.PDF_417],[Ge.RSS_14,or.BarcodeFormat.RSS_14],[Ge.RSS_EXPANDED,or.BarcodeFormat.RSS_EXPANDED],[Ge.UPC_A,or.BarcodeFormat.UPC_A],[Ge.UPC_E,or.BarcodeFormat.UPC_E],[Ge.UPC_EAN_EXTENSION,or.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!S_)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=n;var s=this.createZXingFormats(r),f=new Map;f.set(or.DecodeHintType.POSSIBLE_FORMATS,s),f.set(or.DecodeHintType.TRY_HARDER,!1),this.hints=f}return e.prototype.decodeAsync=function(r){var t=this;return new Promise(function(n,s){try{n(t.decode(r))}catch(f){s(f)}})},e.prototype.decode=function(r){var t=new or.MultiFormatReader(this.verbose,this.hints),n=new or.HTMLCanvasElementLuminanceSource(r),s=new or.BinaryBitmap(new or.HybridBinarizer(n)),f=t.decode(s);return{text:f.text,format:hu.create(this.toHtml5QrcodeSupportedFormats(f.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(t,n,s){r.set(t,n)}),r},e.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},e.prototype.createZXingFormats=function(r){for(var t=[],n=0,s=r;n<s.length;n++){var f=s[n];this.formatMap.has(f)?t.push(this.formatMap.get(f)):this.logger.logError("".concat(f," is not supported by")+"ZXingHtml5QrcodeShim")}return t},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),N_=function(e,r,t,n){function s(f){return f instanceof t?f:new t(function(u){u(f)})}return new(t||(t=Promise))(function(f,u){function x(v){try{m(n.next(v))}catch(E){u(E)}}function p(v){try{m(n.throw(v))}catch(E){u(E)}}function m(v){v.done?f(v.value):s(v.value).then(x,p)}m((n=n.apply(e,r||[])).next())})},k_=function(e,r){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},n,s,f,u;return u={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function x(m){return function(v){return p([m,v])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,m[0]&&(t=0)),t;)try{if(n=1,s&&(f=m[0]&2?s.return:m[0]?s.throw||((f=s.return)&&f.call(s),0):s.next)&&!(f=f.call(s,m[1])).done)return f;switch(s=0,f&&(m=[m[0]&2,f.value]),m[0]){case 0:case 1:f=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,s=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!f||m[1]>f[0]&&m[1]<f[3])){t.label=m[1];break}if(m[0]===6&&t.label<f[1]){t.label=f[1],f=m;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(m);break}f[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(v){m=[6,v],s=0}finally{n=f=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},qf=function(){function e(r,t,n){if(this.formatMap=new Map([[Ge.QR_CODE,"qr_code"],[Ge.AZTEC,"aztec"],[Ge.CODABAR,"codabar"],[Ge.CODE_39,"code_39"],[Ge.CODE_93,"code_93"],[Ge.CODE_128,"code_128"],[Ge.DATA_MATRIX,"data_matrix"],[Ge.ITF,"itf"],[Ge.EAN_13,"ean_13"],[Ge.EAN_8,"ean_8"],[Ge.PDF_417,"pdf417"],[Ge.UPC_A,"upc_a"],[Ge.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t,this.logger=n;var s=this.createBarcodeDetectorFormats(r);if(this.detector=new BarcodeDetector(s),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var r=new BarcodeDetector({formats:["qr_code"]});return typeof r<"u"},e.prototype.decodeAsync=function(r){return N_(this,void 0,void 0,function(){var t,n;return k_(this,function(s){switch(s.label){case 0:return[4,this.detector.detect(r)];case 1:if(t=s.sent(),!t||t.length===0)throw"No barcode or QR code detected.";return n=this.selectLargestBarcode(t),[2,{text:n.rawValue,format:hu.create(this.toHtml5QrcodeSupportedFormats(n.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(r){for(var t=null,n=0,s=0,f=r;s<f.length;s++){var u=f[s],x=u.boundingBox.width*u.boundingBox.height;x>n&&(n=x,t=u)}if(!t)throw"No largest barcode found";return t},e.prototype.createBarcodeDetectorFormats=function(r){for(var t=[],n=0,s=r;n<s.length;n++){var f=s[n];this.formatMap.has(f)?t.push(this.formatMap.get(f)):this.logger.warn("".concat(f," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},e.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},e.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(t,n,s){r.set(t,n)}),r},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),Zf=function(e,r,t,n){function s(f){return f instanceof t?f:new t(function(u){u(f)})}return new(t||(t=Promise))(function(f,u){function x(v){try{m(n.next(v))}catch(E){u(E)}}function p(v){try{m(n.throw(v))}catch(E){u(E)}}function m(v){v.done?f(v.value):s(v.value).then(x,p)}m((n=n.apply(e,r||[])).next())})},Jf=function(e,r){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},n,s,f,u;return u={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function x(m){return function(v){return p([m,v])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,m[0]&&(t=0)),t;)try{if(n=1,s&&(f=m[0]&2?s.return:m[0]?s.throw||((f=s.return)&&f.call(s),0):s.next)&&!(f=f.call(s,m[1])).done)return f;switch(s=0,f&&(m=[m[0]&2,f.value]),m[0]){case 0:case 1:f=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,s=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!f||m[1]>f[0]&&m[1]<f[3])){t.label=m[1];break}if(m[0]===6&&t.label<f[1]){t.label=f[1],f=m;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(m);break}f[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(v){m=[6,v],s=0}finally{n=f=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},I_=function(){function e(r,t,n,s){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=n,t&&qf.isSupported()?(this.primaryDecoder=new qf(r,n,s),this.secondaryDecoder=new Kf(r,n,s)):this.primaryDecoder=new Kf(r,n,s)}return e.prototype.decodeAsync=function(r){return Zf(this,void 0,void 0,function(){var t;return Jf(this,function(n){switch(n.label){case 0:t=performance.now(),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(r)];case 2:return[2,n.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(r){return Zf(this,void 0,void 0,function(){var t,n;return Jf(this,function(s){switch(s.label){case 0:t=performance.now(),s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(r)];case 2:return[2,s.sent()];case 3:if(n=s.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(r)];throw n;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(r){if(this.verbose){var t=performance.now()-r;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var r=0,t=0,n=this.executionResults;t<n.length;t++){var s=n[t];r+=s}var f=r/this.executionResults.length;console.log("".concat(f," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e}(),il=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var f in s)Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),po=function(e,r,t,n){function s(f){return f instanceof t?f:new t(function(u){u(f)})}return new(t||(t=Promise))(function(f,u){function x(v){try{m(n.next(v))}catch(E){u(E)}}function p(v){try{m(n.throw(v))}catch(E){u(E)}}function m(v){v.done?f(v.value):s(v.value).then(x,p)}m((n=n.apply(e,r||[])).next())})},wo=function(e,r){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},n,s,f,u;return u={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function x(m){return function(v){return p([m,v])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,m[0]&&(t=0)),t;)try{if(n=1,s&&(f=m[0]&2?s.return:m[0]?s.throw||((f=s.return)&&f.call(s),0):s.next)&&!(f=f.call(s,m[1])).done)return f;switch(s=0,f&&(m=[m[0]&2,f.value]),m[0]){case 0:case 1:f=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,s=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!f||m[1]>f[0]&&m[1]<f[3])){t.label=m[1];break}if(m[0]===6&&t.label<f[1]){t.label=f[1],f=m;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(m);break}f[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(v){m=[6,v],s=0}finally{n=f=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},du=function(){function e(r,t){this.name=r,this.track=t}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(r){var t={};t[this.name]=r;var n={advanced:[t]};return this.track.applyConstraints(n)},e.prototype.value=function(){var r=this.track.getSettings();if(this.name in r){var t=r[this.name];return t}return null},e}(),F_=function(e){il(r,e);function r(t,n){return e.call(this,t,n)||this}return r.prototype.min=function(){return this.getCapabilities().min},r.prototype.max=function(){return this.getCapabilities().max},r.prototype.step=function(){return this.getCapabilities().step},r.prototype.apply=function(t){var n={};n[this.name]=t;var s={advanced:[n]};return this.track.applyConstraints(s)},r.prototype.getCapabilities=function(){this.failIfNotSupported();var t=this.track.getCapabilities(),n=t[this.name];return{min:n.min,max:n.max,step:n.step}},r.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},r}(du),D_=function(e){il(r,e);function r(t){return e.call(this,"zoom",t)||this}return r}(F_),O_=function(e){il(r,e);function r(t){return e.call(this,"torch",t)||this}return r}(du),R_=function(){function e(r){this.track=r}return e.prototype.zoomFeature=function(){return new D_(this.track)},e.prototype.torchFeature=function(){return new O_(this.track)},e}(),M_=function(){function e(r,t,n){this.isClosed=!1,this.parentElement=r,this.mediaStream=t,this.callbacks=n,this.surface=this.createVideoElement(this.parentElement.clientWidth),r.append(this.surface)}return e.prototype.createVideoElement=function(r){var t=document.createElement("video");return t.style.width="".concat(r,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},e.prototype.setupSurface=function(){var r=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var n=r.surface.clientWidth,s=r.surface.clientHeight;r.callbacks.onRenderSurfaceReady(n,s),r.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(r,t,n,s){return po(this,void 0,void 0,function(){var f,u;return wo(this,function(x){switch(x.label){case 0:return f=new e(r,t,s),n.aspectRatio?(u={aspectRatio:n.aspectRatio},[4,f.getFirstTrackOrFail().applyConstraints(u)]):[3,2];case 1:x.sent(),x.label=2;case 2:return f.setupSurface(),[2,f]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(r){this.failIfClosed();var t=this,n=function(){setTimeout(r,200),t.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(r){return po(this,void 0,void 0,function(){return wo(this,function(t){if("aspectRatio"in r)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(r)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var r=this;return new Promise(function(t,n){var s=r.mediaStream.getVideoTracks(),f=s.length,u=0;r.mediaStream.getVideoTracks().forEach(function(x){r.mediaStream.removeTrack(x),x.stop(),++u,u>=f&&(r.isClosed=!0,r.parentElement.removeChild(r.surface),t())})})},e.prototype.getCapabilities=function(){return new R_(this.getFirstTrackOrFail())},e}(),P_=function(){function e(r){this.mediaStream=r}return e.prototype.render=function(r,t,n){return po(this,void 0,void 0,function(){return wo(this,function(s){return[2,M_.create(r,this.mediaStream,t,n)]})})},e.create=function(r){return po(this,void 0,void 0,function(){var t,n;return wo(this,function(s){switch(s.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return t={audio:!1,video:r},[4,navigator.mediaDevices.getUserMedia(t)];case 1:return n=s.sent(),[2,new e(n)]}})})},e}(),Qf=function(e,r,t,n){function s(f){return f instanceof t?f:new t(function(u){u(f)})}return new(t||(t=Promise))(function(f,u){function x(v){try{m(n.next(v))}catch(E){u(E)}}function p(v){try{m(n.throw(v))}catch(E){u(E)}}function m(v){v.done?f(v.value):s(v.value).then(x,p)}m((n=n.apply(e,r||[])).next())})},$f=function(e,r){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},n,s,f,u;return u={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function x(m){return function(v){return p([m,v])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,m[0]&&(t=0)),t;)try{if(n=1,s&&(f=m[0]&2?s.return:m[0]?s.throw||((f=s.return)&&f.call(s),0):s.next)&&!(f=f.call(s,m[1])).done)return f;switch(s=0,f&&(m=[m[0]&2,f.value]),m[0]){case 0:case 1:f=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,s=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!f||m[1]>f[0]&&m[1]<f[3])){t.label=m[1];break}if(m[0]===6&&t.label<f[1]){t.label=f[1],f=m;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(m);break}f[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(v){m=[6,v],s=0}finally{n=f=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},B_=function(){function e(){}return e.failIfNotSupported=function(){return Qf(this,void 0,void 0,function(){return $f(this,function(r){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(r){return Qf(this,void 0,void 0,function(){return $f(this,function(t){return[2,P_.create(r)]})})},e}(),L_=function(e,r,t,n){function s(f){return f instanceof t?f:new t(function(u){u(f)})}return new(t||(t=Promise))(function(f,u){function x(v){try{m(n.next(v))}catch(E){u(E)}}function p(v){try{m(n.throw(v))}catch(E){u(E)}}function m(v){v.done?f(v.value):s(v.value).then(x,p)}m((n=n.apply(e,r||[])).next())})},j_=function(e,r){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},n,s,f,u;return u={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function x(m){return function(v){return p([m,v])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,m[0]&&(t=0)),t;)try{if(n=1,s&&(f=m[0]&2?s.return:m[0]?s.throw||((f=s.return)&&f.call(s),0):s.next)&&!(f=f.call(s,m[1])).done)return f;switch(s=0,f&&(m=[m[0]&2,f.value]),m[0]){case 0:case 1:f=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,s=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!f||m[1]>f[0]&&m[1]<f[3])){t.label=m[1];break}if(m[0]===6&&t.label<f[1]){t.label=f[1],f=m;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(m);break}f[2]&&t.ops.pop(),t.trys.pop();continue}m=r.call(e,t)}catch(v){m=[6,v],s=0}finally{n=f=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},U_=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var r=MediaStreamTrack;return MediaStreamTrack&&r.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var r=as.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(r=as.insecureContextCameraQueryError()),Promise.reject(r)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var r=location.host.split(":")[0];return r==="127.0.0.1"||r==="localhost"},e.getCamerasFromMediaDevices=function(){return L_(this,void 0,void 0,function(){var r,t,n,s,f,u,x;return j_(this,function(p){switch(p.label){case 0:return r=function(m){for(var v=m.getVideoTracks(),E=0,b=v;E<b.length;E++){var S=b[E];S.enabled=!1,S.stop(),m.removeTrack(S)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=p.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(n=p.sent(),s=[],f=0,u=n;f<u.length;f++)x=u[f],x.kind==="videoinput"&&s.push({id:x.deviceId,label:x.label});return r(t),[2,s]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(r,t){var n=function(f){for(var u=[],x=0,p=f;x<p.length;x++){var m=p[x];m.kind==="video"&&u.push({id:m.id,label:m.label})}r(u)},s=MediaStreamTrack;s.getSources(n)})},e}(),yr;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(yr||(yr={}));var W_=function(){function e(){this.state=yr.NOT_STARTED,this.onGoingTransactionNewState=yr.UNKNOWN}return e.prototype.directTransition=function(r){this.failIfTransitionOngoing(),this.validateTransition(r),this.state=r},e.prototype.startTransition=function(r){return this.failIfTransitionOngoing(),this.validateTransition(r),this.onGoingTransactionNewState=r,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===yr.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var r=this.onGoingTransactionNewState;this.onGoingTransactionNewState=yr.UNKNOWN,this.directTransition(r)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===yr.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=yr.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==yr.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(r){switch(this.state){case yr.UNKNOWN:throw"Transition from unknown is not allowed";case yr.NOT_STARTED:this.failIfNewStateIs(r,[yr.PAUSED]);break;case yr.SCANNING:break;case yr.PAUSED:break}},e.prototype.failIfNewStateIs=function(r,t){for(var n=0,s=t;n<s.length;n++){var f=s[n];if(r===f)throw"Cannot transition from ".concat(this.state," to ").concat(r)}},e}(),V_=function(){function e(r){this.stateManager=r}return e.prototype.startTransition=function(r){return this.stateManager.startTransition(r)},e.prototype.directTransition=function(r){this.stateManager.directTransition(r)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===yr.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==yr.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===yr.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===yr.PAUSED},e}(),H_=function(){function e(){}return e.create=function(){return new V_(new W_)},e}(),G_=function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var f in s)Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function n(){this.constructor=r}r.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ia=function(e){G_(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.DEFAULT_WIDTH=300,r.DEFAULT_WIDTH_OFFSET=2,r.FILE_SCAN_MIN_HEIGHT=300,r.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,r.MIN_QR_BOX_SIZE=50,r.SHADED_LEFT=1,r.SHADED_RIGHT=2,r.SHADED_TOP=3,r.SHADED_BOTTOM=4,r.SHADED_REGION_ELEMENT_ID="qr-shaded-region",r.VERBOSE=!1,r.BORDER_SHADER_DEFAULT_COLOR="#ffffff",r.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",r}(A_),X_=function(){function e(r,t){this.logger=t,this.fps=Ia.SCAN_DEFAULT_FPS,r?(r.fps&&(this.fps=r.fps),this.disableFlip=r.disableFlip===!0,this.qrbox=r.qrbox,this.aspectRatio=r.aspectRatio,this.videoConstraints=r.videoConstraints):this.disableFlip=Ia.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?uu.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!Dn(this.qrbox)},e.create=function(r,t){return new e(r,t)},e}(),eo=function(){function e(r,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(r))throw"HTML Element with id=".concat(r," not found");this.elementId=r,this.verbose=!1;var n;typeof t=="boolean"?this.verbose=t===!0:t&&(n=t,this.verbose=n.verbose===!0,n.experimentalFeatures),this.logger=new C_(this.verbose),this.qrcode=new I_(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(n),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=H_.create()}return e.prototype.start=function(r,t,n,s){var f=this;if(!r)throw"cameraIdOrConfig is required";if(!n||typeof n!="function")throw"qrCodeSuccessCallback is required and should be a function.";var u;s?u=s:u=this.verbose?this.logger.log:function(){};var x=X_.create(t,this.logger);this.clearElement();var p=!1;x.videoConstraints&&(x.isMediaStreamConstraintsValid()?p=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var m=p,v=document.getElementById(this.elementId);v.clientWidth?v.clientWidth:Ia.DEFAULT_WIDTH,v.style.position="relative",this.shouldScan=!0,this.element=v;var E=this,b=this.stateManagerProxy.startTransition(yr.SCANNING);return new Promise(function(S,k){var A=m?x.videoConstraints:E.createVideoConstraints(r);if(!A){b.cancel(),k("videoConstraints should be defined");return}var F={};(!m||x.aspectRatio)&&(F.aspectRatio=x.aspectRatio);var V={onRenderSurfaceReady:function(G,D){E.setupUi(G,D,x),E.isScanning=!0,E.foreverScan(x,n,u)}};B_.failIfNotSupported().then(function(G){G.create(A).then(function(D){return D.render(f.element,F,V).then(function(J){E.renderedCamera=J,b.execute(),S(null)}).catch(function(J){b.cancel(),k(J)})}).catch(function(D){b.cancel(),k(as.errorGettingUserMedia(D))})}).catch(function(G){b.cancel(),k(as.cameraStreamingNotSupported())})})},e.prototype.pause=function(r){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(yr.PAUSED),this.showPausedState(),(Dn(r)||r!==!0)&&(r=!1),r&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var r=this,t=function(){r.stateManagerProxy.directTransition(yr.SCANNING),r.hidePausedState()};if(!this.renderedCamera.isPaused()){t();return}this.renderedCamera.resume(function(){t()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var r=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(yr.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var n=function(){if(r.element){var f=document.getElementById(Ia.SHADED_REGION_ELEMENT_ID);f&&r.element.removeChild(f)}},s=this;return this.renderedCamera.close().then(function(){return s.renderedCamera=null,s.element&&(s.element.removeChild(s.canvasElement),s.canvasElement=null),n(),s.qrRegion&&(s.qrRegion=null),s.context&&(s.context=null),t.execute(),s.hidePausedState(),s.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(r,t){return this.scanFileV2(r,t).then(function(n){return n.decodedText})},e.prototype.scanFileV2=function(r,t){var n=this;if(!r||!(r instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Dn(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(s,f){n.possiblyCloseLastScanImageFile(),n.clearElement(),n.lastScanImageFile=URL.createObjectURL(r);var u=new Image;u.onload=function(){var x=u.width,p=u.height,m=document.getElementById(n.elementId),v=m.clientWidth?m.clientWidth:Ia.DEFAULT_WIDTH,E=Math.max(m.clientHeight?m.clientHeight:p,Ia.FILE_SCAN_MIN_HEIGHT),b=n.computeCanvasDrawConfig(x,p,v,E);if(t){var S=n.createCanvasElement(v,E,"qr-canvas-visible");S.style.display="inline-block",m.appendChild(S);var k=S.getContext("2d");if(!k)throw"Unable to get 2d context from canvas";k.canvas.width=v,k.canvas.height=E,k.drawImage(u,0,0,x,p,b.x,b.y,b.width,b.height)}var A=Ia.FILE_SCAN_HIDDEN_CANVAS_PADDING,F=Math.max(u.width,b.width),V=Math.max(u.height,b.height),G=F+2*A,D=V+2*A,J=n.createCanvasElement(G,D);m.appendChild(J);var ie=J.getContext("2d");if(!ie)throw"Unable to get 2d context from canvas";ie.canvas.width=G,ie.canvas.height=D,ie.drawImage(u,0,0,x,p,A,A,F,V);try{n.qrcode.decodeRobustlyAsync(J).then(function(Q){s(Yf.createFromQrcodeResult(Q))}).catch(f)}catch(Q){f("QR code parse error, error = ".concat(Q))}},u.onerror=f,u.onabort=f,u.onstalled=f,u.onsuspend=f,u.src=URL.createObjectURL(r)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return U_.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(r){if(r){if(!uu.isMediaStreamConstraintsValid(r,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(r)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(r){var t=[Ge.QR_CODE,Ge.AZTEC,Ge.CODABAR,Ge.CODE_39,Ge.CODE_93,Ge.CODE_128,Ge.DATA_MATRIX,Ge.MAXICODE,Ge.ITF,Ge.EAN_13,Ge.EAN_8,Ge.PDF_417,Ge.RSS_14,Ge.RSS_EXPANDED,Ge.UPC_A,Ge.UPC_E,Ge.UPC_EAN_EXTENSION];if(!r||typeof r=="boolean"||!r.formatsToSupport)return t;if(!Array.isArray(r.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(r.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var n=[],s=0,f=r.formatsToSupport;s<f.length;s++){var u=f[s];__(u)?n.push(u):this.logger.warn("Invalid format: ".concat(u," passed in config, ignoring."))}if(n.length===0)throw"None of formatsToSupport match supported values.";return n},e.prototype.getUseBarCodeDetectorIfSupported=function(r){if(Dn(r))return!0;if(!Dn(r.useBarCodeDetectorIfSupported))return r.useBarCodeDetectorIfSupported!==!1;if(Dn(r.experimentalFeatures))return!0;var t=r.experimentalFeatures;return Dn(t.useBarCodeDetectorIfSupported)?!0:t.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(r,t,n){var s=this,f=n.qrbox;this.validateQrboxConfig(f);var u=this.toQrdimensions(r,t,f),x=function(m){if(m<Ia.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Ia.MIN_QR_BOX_SIZE,"px.")},p=function(m){return m>r&&(s.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),m=r),m};x(u.width),x(u.height),u.width=p(u.width)},e.prototype.validateQrboxConfig=function(r){if(typeof r!="number"&&typeof r!="function"&&(r.width===void 0||r.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(r,t,n){if(typeof n=="number")return{width:n,height:n};if(typeof n=="function")try{return n(r,t)}catch(s){throw new Error("qrbox config was passed as a function but it failed with unknown error"+s)}return n},e.prototype.setupUi=function(r,t,n){n.isShadedBoxEnabled()&&this.validateQrboxSize(r,t,n);var s=Dn(n.qrbox)?{width:r,height:t}:n.qrbox;this.validateQrboxConfig(s);var f=this.toQrdimensions(r,t,s);f.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var u=n.isShadedBoxEnabled()&&f.height<=t,x={x:0,y:0,width:r,height:t},p=u?this.getShadedRegionBounds(r,t,f):x,m=this.createCanvasElement(p.width,p.height),v={willReadFrequently:!0},E=m.getContext("2d",v);E.canvas.width=p.width,E.canvas.height=p.height,this.element.append(m),u&&this.possiblyInsertShadingElement(this.element,r,t,f),this.createScannerPausedUiElement(this.element),this.qrRegion=p,this.context=E,this.canvasElement=m},e.prototype.createScannerPausedUiElement=function(r){var t=document.createElement("div");t.innerText=as.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",r.appendChild(t),this.scannerPausedUiElement=t},e.prototype.scanContext=function(r,t){var n=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(s){return r(s.text,Yf.createFromQrcodeResult(s)),n.possiblyUpdateShaders(!0),!0}).catch(function(s){n.possiblyUpdateShaders(!1);var f=as.codeParseError(s);return t(f,b_.createFrom(f)),!1})},e.prototype.foreverScan=function(r,t,n){var s=this;if(this.shouldScan&&this.renderedCamera){var f=this.renderedCamera.getSurface(),u=f.videoWidth/f.clientWidth,x=f.videoHeight/f.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var p=this.qrRegion.width*u,m=this.qrRegion.height*x,v=this.qrRegion.x*u,E=this.qrRegion.y*x;this.context.drawImage(f,v,E,p,m,0,0,this.qrRegion.width,this.qrRegion.height);var b=function(){s.foreverScanTimeout=setTimeout(function(){s.foreverScan(r,t,n)},s.getTimeoutFps(r.fps))};this.scanContext(t,n).then(function(S){!S&&r.disableFlip!==!0?(s.context.translate(s.context.canvas.width,0),s.context.scale(-1,1),s.scanContext(t,n).finally(function(){b()})):b()}).catch(function(S){s.logger.logError("Error happend while scanning context",S),b()})}},e.prototype.createVideoConstraints=function(r){if(typeof r=="string")return{deviceId:{exact:r}};if(typeof r=="object"){var t="facingMode",n="deviceId",s={user:!0,environment:!0},f="exact",u=function(k){if(k in s)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(k,"'")},x=Object.keys(r);if(x.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(x.length," keys");var p=Object.keys(r)[0];if(p!==t&&p!==n)throw"Only '".concat(t,"' and '").concat(n,"' ")+" are supported for 'cameraIdOrConfig'";if(p===t){var m=r.facingMode;if(typeof m=="string"){if(u(m))return{facingMode:m}}else if(typeof m=="object")if(f in m){if(u(m["".concat(f)]))return{facingMode:{exact:m["".concat(f)]}}}else throw"'facingMode' should be string or object with"+" ".concat(f," as key.");else{var v=typeof m;throw"Invalid type of 'facingMode' = ".concat(v)}}else{var E=r.deviceId;if(typeof E=="string")return{deviceId:E};if(typeof E=="object"){if(f in E)return{deviceId:{exact:E["".concat(f)]}};throw"'deviceId' should be string or object with"+" ".concat(f," as key.")}else{var b=typeof E;throw"Invalid type of 'deviceId' = ".concat(b)}}}var S=typeof r;throw"Invalid type of 'cameraIdOrConfig' = ".concat(S)},e.prototype.computeCanvasDrawConfig=function(r,t,n,s){if(r<=n&&t<=s){var f=(n-r)/2,u=(s-t)/2;return{x:f,y:u,width:r,height:t}}else{var x=r,p=t;return r>n&&(t=n/r*t,r=n),t>s&&(r=s/t*r,t=s),this.logger.log("Image downsampled from "+"".concat(x,"X").concat(p)+" to ".concat(r,"X").concat(t,".")),this.computeCanvasDrawConfig(r,t,n,s)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var r=document.getElementById(this.elementId);r&&(r.innerHTML="")},e.prototype.possiblyUpdateShaders=function(r){this.qrMatch!==r&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=r?Ia.BORDER_SHADER_MATCH_COLOR:Ia.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=r)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(r,t,n){var s=r,f=t,u=document.createElement("canvas");return u.style.width="".concat(s,"px"),u.style.height="".concat(f,"px"),u.style.display="none",u.id=Dn(n)?"qr-canvas":n,u},e.prototype.getShadedRegionBounds=function(r,t,n){if(n.width>r||n.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(r-n.width)/2,y:(t-n.height)/2,width:n.width,height:n.height}},e.prototype.possiblyInsertShadingElement=function(r,t,n,s){if(!(t-s.width<1||n-s.height<1)){var f=document.createElement("div");f.style.position="absolute";var u=(t-s.width)/2,x=(n-s.height)/2;if(f.style.borderLeft="".concat(u,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderRight="".concat(u,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderTop="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderBottom="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),f.style.boxSizing="border-box",f.style.top="0px",f.style.bottom="0px",f.style.left="0px",f.style.right="0px",f.id="".concat(Ia.SHADED_REGION_ELEMENT_ID),t-s.width<11||n-s.height<11)this.hasBorderShaders=!1;else{var p=5,m=40;this.insertShaderBorders(f,m,p,-p,null,0,!0),this.insertShaderBorders(f,m,p,-p,null,0,!1),this.insertShaderBorders(f,m,p,null,-p,0,!0),this.insertShaderBorders(f,m,p,null,-p,0,!1),this.insertShaderBorders(f,p,m+p,-p,null,-p,!0),this.insertShaderBorders(f,p,m+p,null,-p,-p,!0),this.insertShaderBorders(f,p,m+p,-p,null,-p,!1),this.insertShaderBorders(f,p,m+p,null,-p,-p,!1),this.hasBorderShaders=!0}r.append(f)}},e.prototype.insertShaderBorders=function(r,t,n,s,f,u,x){var p=document.createElement("div");p.style.position="absolute",p.style.backgroundColor=Ia.BORDER_SHADER_DEFAULT_COLOR,p.style.width="".concat(t,"px"),p.style.height="".concat(n,"px"),s!==null&&(p.style.top="".concat(s,"px")),f!==null&&(p.style.bottom="".concat(f,"px")),x?p.style.left="".concat(u,"px"):p.style.right="".concat(u,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(p),r.appendChild(p)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(r){return 1e3/r},e}(),e1;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(e1||(e1={}));function N8({isOpen:e,onClose:r,initialBarcode:t}){var c;const[n,s]=Fe.useState(new Date);Fe.useEffect(()=>{const o=setInterval(()=>{const l=new Date;(l.getDate()!==n.getDate()||l.getMonth()!==n.getMonth())&&s(l)},1e4);return()=>clearInterval(o)},[n]);const f=Fe.useMemo(()=>{const o=n,l=o.getFullYear(),h=String(o.getMonth()+1).padStart(2,"0"),d=String(o.getDate()).padStart(2,"0");return`${l}-${h}-${d}`},[n]),u=Fe.useMemo(()=>{const o=n,l=o.getFullYear(),h=String(o.getMonth()+1).padStart(2,"0");return`${l}-${h}`},[n]),[x,p]=Fe.useState(!1),[m,v]=Fe.useState(null),[E,b]=Fe.useState(""),[S,k]=Fe.useState(null),[A,F]=Fe.useState(!1),V=async o=>{if(!(!(N!=null&&N.uid)||!o)){F(!0),k(null);try{const l=Vt(st,"users",N.uid,"dailySales"),h=dr(l,vt("date","==",o)),d=await Cr(h);let g=0,w=0,_=0,C=0;d.forEach(T=>{const R=T.data(),L=Number(R.quantity||1);g++,w+=Number(R.sellingPrice||0)*L,_+=Number(R.wholesalePrice||0)*L,C+=Number(R.profit||0)}),k({count:g,sales:w,cost:_,profit:C})}catch(l){console.error(l),z({title:"خطأ",description:"فشل جلب التقارير",variant:"destructive"})}finally{F(!1)}}},[G,D]=Fe.useState([]),[J,ie]=Fe.useState(""),[Q,M]=Fe.useState(""),ne=async()=>{if(N!=null&&N.uid){if(!J&&!Q){z({title:"تنبيه",description:"يرجى اختيار تاريخ للبحث",variant:"destructive"});return}try{const o=ve||(B==null?void 0:B.shopId)||null,l=dr(Vt(st,"users",N.uid,"dailySales"),...o?[vt("shopId","==",o)]:[],...J?[vt("date",">=",J)]:[],...Q?[vt("date","<=",Q)]:[]);let h=dr(Vt(st,"dailySales"),vt("userId","==",N.uid),...o?[vt("shopId","==",o)]:[]);J&&(h=dr(h,vt("date",">=",J))),Q&&(h=dr(h,vt("date","<=",Q)));let d=[],g=[];try{g=(await Cr(l)).docs}catch(T){console.warn("Sub-collection query failed",T)}try{d=(await Cr(h)).docs}catch(T){console.warn("Root collection indexed query failed (likely missing index). Falling back to basic fetch.",T);try{const R=dr(Vt(st,"dailySales"),vt("userId","==",N.uid),...o?[vt("shopId","==",o)]:[],ol("date","desc"),Ss(1e3)),L=dr(Vt(st,"dailySales"),vt("userId","==",N.uid),...o?[vt("shopId","==",o)]:[],Ss(2e3));d=(await Cr(L)).docs.filter(te=>{const se=te.data();return!(J&&se.date<J||Q&&se.date>Q)})}catch(R){console.error("Fallback query also failed",R)}}const w=[...d,...g];if(w.length===0){D([]),z({title:"بحث",description:"لم يتم العثور على نتائج"});return}const _=new Map;w.forEach(T=>{const R=T.data(),L=R.clientId||T.id;_.has(L)||_.set(L,{...R,firestoreId:T.id})});const C=Array.from(_.values()).map(T=>{var R,L;return{id:T.clientId||T.firestoreId,productName:T.productName,price:Number(T.sellingPrice||0),wholesalePrice:Number(T.wholesalePrice||0),quantity:Number(T.quantity||0),date:T.date,time:T.time,serialNumber:T.serialNumber,barcode:T.barcode,performedByType:T.performedByType,performedByName:T.performedByName,performedByUsername:T.performedByUsername,isDeferred:!!T.isDeferred,customerName:T.customerName,customerMobile:T.customerMobile,customerId:T.customerId,firestoreId:T.firestoreId,cartItems:T.cartItems,createdAtMs:(L=(R=T.createdAt)==null?void 0:R.toDate)!=null&&L.call(R)?T.createdAt.toDate().getTime():0,transactionReference:T.reference}});C.sort((T,R)=>T.date!==R.date?R.date.localeCompare(T.date):(R.time||"").localeCompare(T.time||"")),D(C),z({title:"تم البحث",description:`تم العثور على ${C.length} عملية بيع`})}catch(o){console.error("Search error:",o),z({title:"خطأ",description:"حدث خطأ أثناء البحث",variant:"destructive"})}}},X=()=>{ie(""),M(""),Hi()},[me,le]=Fe.useState(null),[ee,pe]=Fe.useState({productName:"",price:"",wholesalePrice:"",quantity:"",barcode:"",serialNumber:""}),[Pe,re]=Fe.useState(!1),[Le,be]=Fe.useState(null),[St,ue]=Fe.useState(!1),[Ye,Qe]=Fe.useState(null),[K,ae]=Fe.useState({productName:"",price:"",wholesalePrice:"",quantity:"",barcode:"",serialNumber:""}),{toast:z}=gu(),{user:N,profile:B}=mu(),{isShiftActive:Ne,shiftUser:we}=pu(),{shopId:ve}=wu(),[Ae,Xe]=Fe.useState([]),[Z,Ke]=Fe.useState({}),[xt,_t]=Fe.useState({}),[ct,Me]=Fe.useState({}),[tt,nt]=Fe.useState(""),[$r,We]=Fe.useState(!1),[br,Br]=Fe.useState({}),[Zt,zr]=Fe.useState(!1),[xr,cn]=Fe.useState(""),[Jt,zt]=Fe.useState(""),[lt,Yt]=Fe.useState(""),[kr,ft]=Fe.useState(!1),[De,tr]=Fe.useState(""),Nt=Ts.useRef(null),Qt=Object.values(br).reduce((o,l)=>o+(Number(l)||0),0),[pa,En]=Fe.useState(!1),[_n,Ft]=Fe.useState(!1),[wr,la]=Fe.useState({productName:"",price:"",wholesalePrice:"",quantity:"1",barcode:"",serialNumber:""}),[ln,Yr]=Fe.useState(""),[Ka,gr]=Fe.useState(""),[qa,An]=Fe.useState(!1),wa=()=>{const l=(Date.now().toString().slice(-9)+Math.floor(Math.random()*1e3).toString().padStart(3,"0")).slice(0,12);pe(h=>({...h,barcode:l}))},ms=async()=>{window.JsBarcode||await new Promise((o,l)=>{const h=document.createElement("script");h.src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js",h.onload=()=>o(),h.onerror=()=>l(new Error("Failed to load JsBarcode")),document.head.appendChild(h)})},ba=async o=>{const l=`https://bwipjs-api.metafloor.com/?bcid=code128&text=${encodeURIComponent(o)}&scale=3&height=10&includetext=1`,d=await(await fetch(l,{cache:"no-store"})).blob();return await new Promise((g,w)=>{const _=new FileReader;_.onloadend=()=>g(_.result||""),_.onerror=C=>w(C),_.readAsDataURL(d)})};Fe.useEffect(()=>{const o=(ee.barcode||"").trim();if(!o){gr(""),Yr("");return}An(!0),(async()=>{try{if(await ms(),!window.JsBarcode)throw new Error("JsBarcode unavailable");const l=document.createElementNS("http://www.w3.org/2000/svg","svg");window.JsBarcode(l,o,{format:"CODE128",displayValue:!0,fontSize:12,height:70,margin:0});const h=new XMLSerializer().serializeToString(l),d="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(h)));gr(d),Yr("")}catch(l){console.warn("JsBarcode failed, using bwip fallback",l);try{const h=await ba(o);gr(h),Yr("")}catch(h){console.error("barcode fallback error",h),gr("")}}finally{An(!1)}})()},[ee.barcode]);const li=o=>(o||"").replace(/[&<>]/g,l=>({"&":"&amp;","<":"&lt;",">":"&gt;"})[l]),Wr=()=>{if(!(ee.barcode||"").trim()||!(Ka||ln)){z({title:"الباركود مطلوب",description:"أنشئ باركود أو أدخله قبل الطباعة",variant:"destructive"});return}try{const l=Ka||ln,h=window.open("","PRINT","width=600,height=400");h==null||h.document.write(`
      <html dir="rtl">
        <head>
          <meta charset="utf-8" />
          <title>طباعة باركود</title>
          <style>
            @page { size: 50mm 30mm; margin: 4mm; }
            body { margin: 0; padding: 0; font-family: system-ui, sans-serif; }
            .label { width: 100%; height: 100%; display:flex; flex-direction:column; align-items:center; justify-content:center; }
            .name { font-size: 12px; margin-bottom: 6px; }
            img { width: 100%; height: auto; }
          </style>
        </head>
        <body>
          <div class="label">
            <div class="name">${li(ee.productName||"")}</div>
            <img src="${l}" alt="barcode" />
          </div>
          <script>setTimeout(() => window.print(), 150);<\/script>
        </body>
      </html>
    `),h==null||h.document.close()}catch(l){console.error(l),z({title:"فشل الطباعة",description:"تعذّر فتح نافذة الطباعة",variant:"destructive"})}},[Za,O]=Fe.useState(!1),[P,j]=Fe.useState(""),U=Ts.useRef(null),Y="barcode-scanner-container",q=async()=>{try{const o=Ge,l=await eo.getCameras();if(!l||l.length===0)throw new Error("لا توجد كاميرات متاحة");const d=(l.find(g=>/back|rear|خلف/i.test(g.label))||l[l.length-1]).id;U.current=new eo(Y),await U.current.start(d,{fps:10,qrbox:{width:250,height:120},formatsToSupport:[o.CODE_128,o.EAN_13,o.EAN_8,o.CODE_39]},g=>{pe(w=>({...w,barcode:g})),he()},()=>{})}catch(o){console.error("scanner start error",o),j((o==null?void 0:o.message)||"تعذّر بدء الكاميرا")}},he=async()=>{try{U.current&&(await U.current.stop(),await U.current.clear(),U.current=null)}catch(o){console.warn("scanner stop warn",o)}O(!1)};Fe.useEffect(()=>()=>{U.current&&(U.current.stop().catch(()=>{}),U.current.clear().catch(()=>{}),U.current=null)},[]);const[ye,oe]=Fe.useState(!0);Fe.useEffect(()=>{e&&oe(!0)},[e]);const[de,xe]=Fe.useState(!1),Se=Ts.useRef(""),Oe=Ts.useRef(0),[Ie,Re]=Fe.useState(0),[Be,et]=Fe.useState(0),[Ee,Bt]=Fe.useState(!1),[ht,Kr]=Fe.useState(!1),[ea,mt]=Fe.useState(()=>{try{const o=N!=null&&N.uid?`monthlyReportsLock_v3_${N==null?void 0:N.uid}`:"monthlyReportsLock_v3";return(localStorage.getItem(o)??localStorage.getItem("monthlyReportsLock_v3"))!=="false"}catch{return!0}});Fe.useEffect(()=>{if(e)try{const o=N!=null&&N.uid?`monthlyReportsLock_v3_${N==null?void 0:N.uid}`:"monthlyReportsLock_v3";(localStorage.getItem(o)??localStorage.getItem("monthlyReportsLock_v3"))!=="false"&&mt(!0)}catch{}},[e,N==null?void 0:N.uid]);const[ut,pt]=Fe.useState(!1),[fa,fi]=Fe.useState(!1),[g0,Ir]=Fe.useState(!0),[bn,sl]=Fe.useState(!0),[ir,Pa]=Fe.useState({}),[ps,fn]=Fe.useState(!1),[Kt,Vr]=Fe.useState("التحقق قبل العملية"),[fe,H]=Fe.useState("أدخل الرقم السري الرئيسي للمتابعة"),qe=Ts.useRef(null),Wt=(o,l,h)=>{Vr(o),H(l),qe.current=h,fn(!0)},[ha,No]=Fe.useState([]),[hi,va]=Fe.useState([]),[Ze,rr]=Fe.useState(null),[m0,ws]=Fe.useState(!1),[ui,di]=Fe.useState("");Fe.useEffect(()=>{if(!(N!=null&&N.uid))return;const o=dr(Vt(st,"categories"),ol("createdAt","desc")),l=vu(o,h=>{const g=h.docs.map(w=>({id:w.id,...w.data()})).filter(w=>!w.shopId||w.shopId===((B==null?void 0:B.shopId)||N.uid));va(g)});return()=>l()},[N==null?void 0:N.uid,B==null?void 0:B.shopId]);const vs=async()=>{if(ui.trim())try{await Zi(Vt(st,"categories"),{name:ui.trim(),shopId:(B==null?void 0:B.shopId)||(N==null?void 0:N.uid),createdAt:qr()}),di(""),ws(!1),z({title:"تمت الإضافة",description:"تم إضافة القسم بنجاح"})}catch(o){console.error(o),z({title:"خطأ",description:"فشل إضافة القسم",variant:"destructive"})}},ko=async(o,l)=>{l.stopPropagation(),Wt("حذف القسم","أدخل الرقم السري الرئيسي لحذف هذا القسم",()=>{v(o)})},Fr=async()=>{if(m)try{await Jn(Lr(st,"categories",m)),z({title:"تم الحذف",description:"تم حذف القسم بنجاح"})}catch(o){console.error(o),z({title:"خطأ",description:"فشل حذف القسم",variant:"destructive"})}finally{v(null)}},[xi,ua]=Fe.useState(!1),[rt,Io]=Fe.useState(""),[dt,Dr]=Fe.useState(""),[p0,ji]=Fe.useState(""),[w0,Ja]=Fe.useState(null);Fe.useEffect(()=>{(async()=>{try{if(!e||!(N!=null&&N.uid))return;const o=await xn.getUserData(N.uid),l=Array.isArray(o==null?void 0:o.customers)?o.customers.map(h=>({id:String(h.id||""),name:String(h.name||""),mobile:h.mobile||void 0})):[];No(l)}catch{}})()},[e,N==null?void 0:N.uid]);const[Fo,hn]=Fe.useState(!1),[Ca,gi]=Fe.useState(null),[Cn,mi]=Fe.useState(null),un=(o,l)=>{gi(o),mi(l),hn(!0)},[vr,Ui]=Fe.useState(null),[Wi,v0]=Fe.useState(""),ys=Fe.useMemo(()=>{const o=Wi.trim().toLowerCase();return o?Ae.filter(l=>l.name.toLowerCase().includes(o)):Ae},[Ae,Wi]),[Do,Vi]=Fe.useState(!1),[Tt,y0]=Fe.useState(null),[pi,Ta]=Fe.useState("1"),Es=o=>{y0(o),Ta("1"),Vi(!0)},ge=()=>{if(!Tt)return;const o=parseInt(pi);o>0&&(Vi(!1),Wt("إضافة مخزون",`إضافة ${o} قطع للمنتج ${Tt.name}`,async()=>{try{const l=Tt.quantity+o;await ya(Lr(st,"products",Tt.id),{quantity:l,updatedAt:qr()}),Xe(h=>h.map(d=>d.id===Tt.id?{...d,quantity:l}:d)),z({title:"تمت الإضافة",description:`تمت إضافة ${o} قطعة`})}catch(l){console.error(l)}}))};Fe.useEffect(()=>{e&&(N!=null&&N.uid)&&(Hi(),ea||Tn())},[e,N==null?void 0:N.uid,ea]),Fe.useEffect(()=>{try{const o=N!=null&&N.uid?`monthlyReportsLock_v3_${N==null?void 0:N.uid}`:"monthlyReportsLock_v3",l=localStorage.getItem(o)??localStorage.getItem("monthlyReportsLock_v3");mt(l!=="false")}catch{}},[N==null?void 0:N.uid,e]),Fe.useEffect(()=>{const o=l=>{var h;try{const d=!!((h=l==null?void 0:l.detail)!=null&&h.enabled);mt(d)}catch{}};return window.addEventListener("monthlyReportsLockChanged",o),()=>window.removeEventListener("monthlyReportsLockChanged",o)},[]),Fe.useEffect(()=>{if(!e)return;const o=l=>{var _;const h=l.target,d=(_=h==null?void 0:h.tagName)==null?void 0:_.toLowerCase();if(d==="input"||d==="textarea"||!!(h&&h.isContentEditable)||ps||ht||de)return;const w=Date.now();if(l.key==="Enter"){const C=(Se.current||"").trim();Se.current="",C&&zi(C);return}l.key.length===1&&(w-(Oe.current||0)>100&&(Se.current=""),Se.current+=l.key,Oe.current=w)};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[e,Ae,ps,ht,de]),Fe.useEffect(()=>{e&&t&&zi(t)},[e,t]);const wt=async()=>{if(!(N!=null&&N.uid))return;const o=(B==null?void 0:B.shopId)||ve||"main",l=`shopProducts_${N.uid}_${o}`;try{const h=localStorage.getItem(l);if(h){const d=JSON.parse(h);Array.isArray(d)&&d.length>0&&Xe(d)}}catch(h){console.warn("Failed to load products from cache",h)}try{let h,d=[];if(B!=null&&B.shopId){const g=dr(Vt(st,"products"),vt("shopId","==",B.shopId),vt("userId","==",N.uid));if(h=await Cr(g),d=h.docs.map(w=>({id:w.id,name:String(w.data().name??""),sellingPrice:Number(w.data().sellingPrice??0),wholesalePrice:Number(w.data().wholesalePrice??0),quantity:Number(w.data().quantity??0),barcode:String(w.data().barcode??""),serialNumber:String(w.data().serialNumber??""),categoryId:w.data().categoryId||void 0,supplierName:w.data().supplierName||void 0})),d.length===0){const w=dr(Vt(st,"products"),vt("userId","==",N.uid)),C=(await Cr(w)).docs.map(T=>({id:T.id,name:String(T.data().name??""),sellingPrice:Number(T.data().sellingPrice??0),wholesalePrice:Number(T.data().wholesalePrice??0),quantity:Number(T.data().quantity??0),barcode:String(T.data().barcode??""),serialNumber:String(T.data().serialNumber??""),categoryId:T.data().categoryId||void 0,supplierName:T.data().supplierName||void 0}));C.length>0&&(d=C,z({title:"تم استرجاع المنتجات",description:"عثرنا على منتجات محفوظة لك خارج المتجر الحالي وقمنا بعرضها."}))}}else{const g=dr(Vt(st,"products"),vt("userId","==",N.uid));h=await Cr(g),d=h.docs.map(w=>({id:w.id,name:String(w.data().name??""),sellingPrice:Number(w.data().sellingPrice??0),wholesalePrice:Number(w.data().wholesalePrice??0),quantity:Number(w.data().quantity??0),barcode:String(w.data().barcode??""),serialNumber:String(w.data().serialNumber??""),categoryId:w.data().categoryId||void 0,supplierName:w.data().supplierName||void 0}))}Xe(d);try{localStorage.setItem(l,JSON.stringify(d))}catch{}if(B!=null&&B.shopId&&d.length>0){const g=d.filter(w=>{const _=((h==null?void 0:h.docs)||[]).find(T=>T.id===w.id);return!(!!_&&!!_.data().shopId)});if(g.length>0)try{await Promise.all(g.map(w=>ya(Lr(st,"products",w.id),{shopId:B.shopId,updatedAt:qr()}))),z({title:"تم ترتيب المنتجات",description:"تم ربط بعض المنتجات غير المربوطة بمتجرك الحالي تلقائياً."})}catch(w){console.warn("تعذّر ترحيل shopId لبعض المنتجات:",w)}}}catch(h){console.error("Error loading shop products:",h)}};Fe.useEffect(()=>{e&&(N!=null&&N.uid)&&(wt(),Tn(),Hi(),dn())},[e,N==null?void 0:N.uid,B==null?void 0:B.shopId,u]);const sr=()=>{const o=new Date,l=o.getFullYear(),h=String(o.getMonth()+1).padStart(2,"0"),d=String(o.getDate()).padStart(2,"0");return`${l}-${h}-${d}`},Ba=o=>{const l=h=>{if(typeof h.createdAtMs=="number")return h.createdAtMs;const d=parseInt(h.id,10);if(!isNaN(d))return d;const g=new Date(h.date);return isNaN(g.getTime())?0:g.getTime()};return[...o].sort((h,d)=>l(d)-l(h))},Hi=()=>{if(!(N!=null&&N.uid)){console.log("No user authenticated, cannot load sales data");return}let o=[];try{const W=`deletedSaleIds_${N.uid}`,te=localStorage.getItem(W);te&&(o=JSON.parse(te))}catch{}const l=W=>Array.isArray(W)?W.filter(te=>!o.includes(te.id)&&!o.includes(te.firestoreId||"")):[],h=ve||(B==null?void 0:B.shopId)||"main",d=`salesData_all_${N.uid}_${h}`,g=localStorage.getItem(d);if(g)try{const W=JSON.parse(g),te=l(W);D(Ba(te)),te.length!==W.length&&localStorage.setItem(d,JSON.stringify(te));return}catch{}const w=sr(),_=`salesData_${N.uid}_${h}_${w}`,C=localStorage.getItem(_);if(C){const W=JSON.parse(C),te=l(W),se=Ba(te);D(se);try{localStorage.setItem(d,JSON.stringify(se))}catch{}return}const T=new Date().toISOString().split("T")[0],R=`salesData_${N.uid}_${h}_${T}`,L=localStorage.getItem(R);if(L){const W=JSON.parse(L),te=l(W),se=Ba(te);D(se);try{localStorage.setItem(_,JSON.stringify(se)),localStorage.setItem(d,JSON.stringify(se))}catch{}return}Ro()},Gi=o=>{if(!(N!=null&&N.uid)){console.log("No user authenticated, cannot save sales data");return}const l=ve||(B==null?void 0:B.shopId)||"main",h=sr(),d=`salesData_${N.uid}_${l}_${h}`,g=`salesData_all_${N.uid}_${l}`,w=Ba(o);localStorage.setItem(d,JSON.stringify(w));try{const _=localStorage.getItem(g),C=_?JSON.parse(_):[],T={};[...Array.isArray(C)?C:[],...w].forEach(W=>{T[W.id]=W});const R=Object.values(T),L=Ba(R);localStorage.setItem(g,JSON.stringify(L))}catch{}D(w)},Oo=o=>{if(!(N!=null&&N.uid)){console.log("No user authenticated, cannot save sales data");return}const l=ve||(B==null?void 0:B.shopId)||"main",h=`salesData_all_${N.uid}_${l}`;try{const g=localStorage.getItem(h),w=g?JSON.parse(g):[],_={};[...Array.isArray(w)?w:[],...o].forEach(R=>{_[R.id]=R});const C=Object.values(_),T=Ba(C);localStorage.setItem(h,JSON.stringify(T))}catch{}const d=Ba(o);D(d)},Ro=async()=>{if(N!=null&&N.uid)try{const o=ve||(B==null?void 0:B.shopId)||null,l=new Date().toISOString().split("T")[0],h=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(new Date);let d,g;try{const L=dr(Vt(st,"dailySales"),vt("userId","==",N.uid),...o?[vt("shopId","==",o)]:[]);d=await Cr(L)}catch{}try{const L=dr(Vt(st,"users",N.uid,"dailySales"),...o?[vt("shopId","==",o)]:[]);g=await Cr(L)}catch{}const w=[...d?d.docs:[],...g?g.docs:[]];let _=[];try{const L=`deletedSaleIds_${N.uid}`,W=localStorage.getItem(L);W&&(_=JSON.parse(W))}catch{}const C=w.map(L=>{var te,se;const W=L.data();return{id:String(W.clientId||L.id),firestoreId:L.id,productName:String(W.productName||""),price:Number(W.sellingPrice||0),wholesalePrice:W.wholesalePrice!==void 0?Number(W.wholesalePrice):null,quantity:Number(W.quantity||0),date:String(W.date||l),time:String(W.time||""),serialNumber:W.serialNumber||void 0,barcode:W.barcode||void 0,performedByType:W.performedByType||void 0,performedByName:W.performedByName||void 0,performedByUsername:W.performedByUsername||void 0,isDeferred:!!W.isDeferred,customerName:W.customerName||void 0,customerMobile:W.customerMobile||void 0,customerId:W.customerId||void 0,createdAtMs:(se=(te=W==null?void 0:W.createdAt)==null?void 0:te.toDate)!=null&&se.call(te)?W.createdAt.toDate().getTime():new Date(String(W.date||l)).getTime()}}).filter(L=>!_.includes(L.id)&&!_.includes(L.firestoreId||"")),T={};[...G,...C].forEach(L=>{T[L.id]=L});const R=Object.values(T);Oo(R)}catch{}},Tn=async()=>{if(N!=null&&N.uid)try{const o=new Date,l=new Date(o.getFullYear(),o.getMonth(),1),h=new Date(o.getFullYear(),o.getMonth()+1,0),d=L=>L.toISOString().split("T")[0],g=d(l),w=d(h),_=ve||(B==null?void 0:B.shopId)||null;let C;try{const L=dr(Vt(st,"dailySales"),vt("userId","==",N.uid),..._?[vt("shopId","==",_)]:[]);C=await Cr(L)}catch{const L=dr(Vt(st,"users",N.uid,"dailySales"),..._?[vt("shopId","==",_)]:[]);C=await Cr(L)}let T=0,R=0;C.forEach(L=>{const W=L.data(),te=String(W.date??"").slice(0,10);if(!W.isDeferred&&te>=g&&te<=w){const se=Number(W.sellingPrice??0),Ce=Number(W.quantity??0),Te=Number(W.profit??(Number(W.sellingPrice??0)-Number(W.wholesalePrice??0))*Ce);T+=se*Ce,R+=Te}}),Re(T),et(R)}catch(o){console.error("Error loading monthly stats:",o)}},hr=async o=>{if(!(N!=null&&N.uid))return null;try{const l=((o.price??0)-(o.wholesalePrice??0))*(o.quantity??0),h=Ne&&we?"cashier":"admin",d=h==="cashier"?(we==null?void 0:we.name)||"كاشير":(B==null?void 0:B.fullName)||(N==null?void 0:N.displayName)||"الحساب الرئيسي",g=h==="cashier"&&(we==null?void 0:we.username)||null,w=await Zi(Vt(st,"dailySales"),{userId:N.uid,clientId:o.id,productName:o.productName,quantity:o.quantity,wholesalePrice:o.wholesalePrice??null,sellingPrice:o.price,profit:l,date:o.date,time:o.time,performedByType:h,performedByName:d,performedByUsername:g,serialNumber:o.serialNumber??null,barcode:o.barcode??null,isDeferred:!!o.isDeferred,customerName:o.customerName||null,customerMobile:o.customerMobile||null,customerId:o.customerId||null,...B!=null&&B.shopId?{shopId:B.shopId}:ve?{shopId:ve}:{},...o.cartItems?{cartItems:o.cartItems}:{},createdAt:qr()});try{await fl(Lr(st,"users",N.uid,"dailySales",w.id),{userId:N.uid,clientId:o.id,productName:o.productName,quantity:o.quantity,wholesalePrice:o.wholesalePrice??null,sellingPrice:o.price,profit:l,date:o.date,time:o.time,performedByType:h,performedByName:d,performedByUsername:g,serialNumber:o.serialNumber??null,barcode:o.barcode??null,isDeferred:!!o.isDeferred,customerName:o.customerName||null,customerMobile:o.customerMobile||null,customerId:o.customerId||null,...B!=null&&B.shopId?{shopId:B.shopId}:ve?{shopId:ve}:{},...o.cartItems?{cartItems:o.cartItems}:{},createdAt:qr()})}catch{}return w.id}catch{try{const l=await Zi(Vt(st,"users",N.uid,"dailySales"),{userId:N.uid,clientId:o.id,productName:o.productName,quantity:o.quantity,wholesalePrice:o.wholesalePrice??null,sellingPrice:o.price,profit,date:o.date,time:o.time,performedByType,performedByName,performedByUsername,serialNumber:o.serialNumber??null,barcode:o.barcode??null,isDeferred:!!o.isDeferred,customerName:o.customerName||null,customerMobile:o.customerMobile||null,customerId:o.customerId||null,...B!=null&&B.shopId?{shopId:B.shopId}:ve?{shopId:ve}:{},...o.cartItems?{cartItems:o.cartItems}:{},createdAt:qr()});try{await fl(Lr(st,"dailySales",l.id),{userId:N.uid,clientId:o.id,productName:o.productName,quantity:o.quantity,wholesalePrice:o.wholesalePrice??null,sellingPrice:o.price,profit,date:o.date,time:o.time,performedByType,performedByName,performedByUsername,serialNumber:o.serialNumber??null,barcode:o.barcode??null,isDeferred:!!o.isDeferred,customerName:o.customerName||null,customerMobile:o.customerMobile||null,customerId:o.customerId||null,...B!=null&&B.shopId?{shopId:B.shopId}:ve?{shopId:ve}:{},...o.cartItems?{cartItems:o.cartItems}:{},createdAt:qr()})}catch{}return l.id}catch(l){return console.error("Error saving sale:",l),null}}},Wn=()=>{const o=ve||(B==null?void 0:B.shopId)||"main";return`cashBalance_${(N==null?void 0:N.uid)||"default"}_${o}`},ur=async(o,l)=>{if(N!=null&&N.uid)try{const h=Lr(st,"dailySales",o);await ya(h,l)}catch{try{const h=Lr(st,"users",N.uid,"dailySales",o);await ya(h,l)}catch(h){console.error("Error updating sale:",h)}}},wi=async o=>{try{const l=o.firestoreId;if(l)await ur(l,{isDeferred:!1});else try{const h=dr(Vt(st,"dailySales"),vt("userId","==",(N==null?void 0:N.uid)||""),vt("date","==",o.date),vt("productName","==",o.productName),Ss(5)),g=(await Cr(h)).docs[0];g&&await ya(g.ref,{isDeferred:!1})}catch{}D(h=>h.map(d=>d.id===o.id?{...d,isDeferred:!1}:d));try{await Tn()}catch{}z({title:"تم التسديد",description:`تم تسديد أجل ${o.productName}`})}catch(l){console.error("Error marking deferred sale as paid:",l),z({title:"فشل التسديد",description:"تعذّر تحديث حالة البيع المؤجّل",variant:"destructive"})}},dn=async()=>{if(!(N!=null&&N.uid))return;const o=G.filter(l=>!l.firestoreId);if(o.length!==0)for(const l of o)try{let h;try{const g=dr(Vt(st,"dailySales"),vt("userId","==",N.uid),vt("clientId","==",l.id),Ss(1));h=await Cr(g)}catch{const g=dr(Vt(st,"users",N.uid,"dailySales"),vt("clientId","==",l.id),Ss(1));h=await Cr(g)}if(!h.empty){const g=h.docs[0].id,w=G.map(_=>_.id===l.id?{..._,firestoreId:g}:_);Gi(w);continue}const d=await hr(l);if(d){const g=G.map(w=>w.id===l.id?{...w,firestoreId:d}:w);Gi(g)}}catch{}},jt=async o=>{try{if(N!=null&&N.uid)try{const T=Vt(st,"deficiencies"),R=await Zi(T,{shopId:(B==null?void 0:B.shopId)||N.uid||"default-shop",name:o,quantity:1,status:"pending",createdAt:qr()});try{const L=`deficiencies_${(B==null?void 0:B.shopId)||(N==null?void 0:N.uid)||"default-shop"}`,W=localStorage.getItem(L),te=W?JSON.parse(W):[],se=Array.isArray(te)?te:[],Ce=se.some(Ve=>String((Ve==null?void 0:Ve.id)||"")===R.id),Te={id:R.id,name:o,quantity:1,status:"pending",createdAt:new Date().toISOString()},ce=Ce?se:[...se,Te];localStorage.setItem(L,JSON.stringify(ce))}catch{}z({title:"تمت الإضافة للنواقص",description:`المنتج ${o} نفد من المخزون وتمت إضافته للنواقص`});return}catch(T){console.warn("Failed to add deficiency to Firestore, falling back to local storage:",T)}const l=`deficiencies_${(B==null?void 0:B.shopId)||(N==null?void 0:N.uid)||"default-shop"}`,h=localStorage.getItem(l),d=h?JSON.parse(h):[],g=Array.isArray(d)?d:[];if(g.some(T=>String((T==null?void 0:T.name)||"").trim()===o&&String((T==null?void 0:T.status)||"pending")==="pending"))return;const _={id:Date.now().toString(),name:o,quantity:1,status:"pending",createdAt:new Date().toISOString()},C=[...g,_];localStorage.setItem(l,JSON.stringify(C)),z({title:"تمت الإضافة للنواقص",description:`المنتج ${o} نفد من المخزون وتمت إضافته للنواقص`})}catch(l){console.error("Error adding deficiency for out-of-stock:",l)}},$e=()=>{try{if(Ae.length===0){z({title:"لا توجد بيانات",description:"لا توجد منتجات لتصديرها",variant:"destructive"});return}const o=Ae.map(d=>({"اسم المنتج":d.name,"سعر البيع":d.sellingPrice,"سعر الجملة":d.wholesalePrice||0,الكمية:d.quantity,الباركود:d.barcode||"","الرقم التسلسلي":d.serialNumber||""})),l=$0.json_to_sheet(o),h=$0.book_new();$0.book_append_sheet(h,l,"المنتجات"),h_(h,"المنتجات.xlsx"),z({title:"تم التصدير",description:"تم تصدير المنتجات بنجاح"})}catch(o){console.error("Error exporting excel:",o),z({title:"خطأ",description:"حدث خطأ أثناء تصدير البيانات",variant:"destructive"})}},E0=o=>{var h;const l=(h=o.target.files)==null?void 0:h[0];if(l){if(Ne){z({title:"غير مسموح",description:"لا يمكن استيراد منتجات أثناء الوردية",variant:"destructive"}),o.target.value="";return}Wt("استيراد منتجات","أدخل الرقم السري للمتابعة",async()=>{const d=new FileReader;d.onload=async g=>{var w;try{const _=(w=g.target)==null?void 0:w.result,C=gc(_,{type:"binary"}),T=C.SheetNames[0],R=C.Sheets[T],L=$0.sheet_to_json(R);if(!L||L.length===0){z({title:"خطأ",description:"الملف فارغ أو التنسيق غير صحيح",variant:"destructive"});return}let W=0,te=0;for(const ce of L)try{const Ve=ce["اسم المنتج"]||ce.name,ze=Number(ce["سعر البيع"]||ce.sellingPrice),kt=Number(ce.الكمية||ce.quantity),Ot=Number(ce["سعر الجملة"]||ce.wholesalePrice||0),It=ce.الباركود||ce.barcode||"",bt=ce["الرقم التسلسلي"]||ce.serialNumber||"";if(Ve&&!isNaN(ze)&&!isNaN(kt)){const er={name:String(Ve).trim(),sellingPrice:ze,wholesalePrice:Ot,quantity:kt,userId:N==null?void 0:N.uid,createdAt:qr(),updatedAt:qr()};It&&(er.barcode=String(It).trim()),bt&&(er.serialNumber=String(bt).trim()),B!=null&&B.shopId?er.shopId=B.shopId:ve&&(er.shopId=ve),await Zi(Vt(st,"products"),er),W++}}catch{te++}const se=dr(Vt(st,"products"),vt("userId","==",N==null?void 0:N.uid),...B!=null&&B.shopId?[vt("shopId","==",B.shopId)]:[]),Te=(await Cr(se)).docs.map(ce=>({id:ce.id,...ce.data()}));Xe(Te),z({title:"تم الاستيراد",description:`تم إضافة ${W} منتج بنجاح.${te>0?` فشل ${te} منتج.`:""}`})}catch(_){console.error("Error importing excel:",_),z({title:"خطأ",description:"حدث خطأ أثناء قراءة الملف",variant:"destructive"})}o.target&&(o.target.value="")},d.readAsBinaryString(l)})}},$t=async()=>{const o=String(wr.productName||"").trim(),l=parseFloat(String(wr.price||"")),h=parseFloat(String(wr.wholesalePrice||"")),d=parseInt(String(wr.quantity||"1"));if(!o||isNaN(l)||l<=0||isNaN(d)||d<=0){z({title:"بيانات غير صالحة",description:"أدخل اسم المنتج وسعر بيع صحيح والكمية",variant:"destructive"});return}const g=new Date,w=Ne&&we?"cashier":"admin",_=w==="cashier"?(we==null?void 0:we.name)||"كاشير":(B==null?void 0:B.fullName)||(N==null?void 0:N.displayName)||"الحساب الرئيسي",C=w==="cashier"&&(we==null?void 0:we.username)||null,T=N!=null&&N.uid?`SALECASH-${N.uid}-${Date.now()}`:void 0,R={id:Date.now().toString(),productName:o,price:l,wholesalePrice:isNaN(h)?0:h,quantity:d,date:g.toISOString().split("T")[0],time:g.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),createdAtMs:g.getTime(),performedByType:w,performedByName:_,performedByUsername:C,serialNumber:String(wr.serialNumber||"").trim()||void 0,barcode:String(wr.barcode||"").trim()||void 0,isDeferred:!1,transactionReference:T};try{const L=await hr(R),W=L?{...R,firestoreId:L}:R;Gi([...G,W]);const te=l*d;try{const se=Wn(),Ce=localStorage.getItem(se),ce=(Ce?parseFloat(Ce):0)+te;localStorage.setItem(se,ce.toString());const Ve=`userData_${N==null?void 0:N.uid}`,ze={cashBalance:ce,lastUpdated:new Date().toISOString()};localStorage.setItem(Ve,JSON.stringify(ze)),N!=null&&N.uid&&xn.updateUserData(N.uid,ze).catch(()=>{});const kt=(B==null?void 0:B.shopId)||ve;if(kt)try{await ya(Lr(st,"dashboardData",kt),{cashBalance:ce})}catch{}try{window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:ce}}))}catch{}try{if(N!=null&&N.uid&&T){const It={txnType:"sales",type:"sales",amount:te,status:"confirmed",senderMsisdn:"مبيعات",receiverMsisdn:"",reference:T,title:"إيصال مبيعات",merchantUserId:N.uid,createdBy:N.uid,shopId:(B==null?void 0:B.shopId)||ve||void 0,cashierName:_,performedByType:w,performedByUsername:C,saleProductName:o,saleQuantity:d,createdAt:new Date};await xn.saveUserTransaction(N.uid,It)}}catch{}Re(It=>It+te);const Ot=(l-(isNaN(h)?0:h))*d;et(It=>It+Ot)}catch(se){console.warn("تعذر تحديث رصيد الدرج النقدي بعد البيع الفوري:",se)}la({productName:"",price:"",wholesalePrice:"",quantity:"1",barcode:"",serialNumber:""}),z({title:"تم البيع",description:`تم بيع ${d} قطعة من ${o} (بدون تسجيل بالمخزون)`})}catch(L){console.error("Error quick selling ad-hoc product:",L),z({title:"فشل البيع",description:"تعذّر تنفيذ عملية البيع الفوري",variant:"destructive"})}},La=async(o,l=!1,h,d)=>{const g=Z[o.id]||"",w=parseInt(g);if(isNaN(w)||w<=0){z({title:"كمية غير صالحة",description:"أدخل كمية صحيحة للبيـع",variant:"destructive"});return}if(w>o.quantity){z({title:"كمية أكبر من المتاح",description:"الكمية المطلوب بيعها تتجاوز المخزون المتاح",variant:"destructive"});return}const _=new Date,C=sr(),T=Ne&&we?"cashier":"admin",R=T==="cashier"?(we==null?void 0:we.name)||"كاشير":(B==null?void 0:B.fullName)||(N==null?void 0:N.displayName)||"الحساب الرئيسي",L=T==="cashier"&&(we==null?void 0:we.username)||null,W=N!=null&&N.uid?`SALECASH-${N.uid}-${Date.now()}`:void 0,te=(o.serialNumber||"").trim(),se=ir[o.id]||"",Ce=parseFloat(se),Te=!isNaN(Ce)&&Ce>0?Ce:o.sellingPrice,ce={id:Date.now().toString(),productName:o.name,price:Te,wholesalePrice:o.wholesalePrice,quantity:w,date:C,time:_.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),createdAtMs:_.getTime(),performedByType:T,performedByName:R,performedByUsername:L,serialNumber:te||void 0,barcode:o.barcode,isDeferred:l,customerName:h==null?void 0:h.name,customerMobile:h==null?void 0:h.mobile,customerId:h==null?void 0:h.id,transactionReference:W};try{const Ve=await hr(ce),ze=Ve?{...ce,firestoreId:Ve}:ce;Gi([ze,...G]);const kt=o.quantity-w;if(await ya(Lr(st,"products",o.id),{quantity:kt,updatedAt:qr()}),Xe(Ot=>Ot.map(It=>It.id===o.id?{...It,quantity:kt}:It)),Ke(Ot=>({...Ot,[o.id]:""})),Pa(Ot=>({...Ot,[o.id]:""})),kt===0&&jt(o.name),!l)try{const Ot=Te*w,It=Wn(),bt=localStorage.getItem(It),Or=(bt?parseFloat(bt):0)+Ot;localStorage.setItem(It,Or.toString());const Kn=`userData_${N==null?void 0:N.uid}`,kn={cashBalance:Or,lastUpdated:new Date().toISOString()};localStorage.setItem(Kn,JSON.stringify(kn)),N!=null&&N.uid&&xn.updateUserData(N.uid,kn).catch(()=>{});const S0=(B==null?void 0:B.shopId)||ve;if(S0)try{await ya(Lr(st,"dashboardData",S0),{cashBalance:Or})}catch{}try{window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:Or}}))}catch{}try{if(N!=null&&N.uid&&W){const yi={txnType:"sales",type:"sales",amount:Ot,status:"confirmed",senderMsisdn:"مبيعات",receiverMsisdn:"",reference:W,title:"إيصال مبيعات",merchantUserId:N.uid,createdBy:N.uid,shopId:(B==null?void 0:B.shopId)||ve||void 0,cashierName:R,performedByType:T,performedByUsername:L,saleProductName:o.name,saleQuantity:w,createdAt:new Date};await xn.saveUserTransaction(N.uid,yi)}}catch{}Re(yi=>yi+Ot);const N0=(Te-(o.wholesalePrice||0))*w;et(yi=>yi+N0),zn(yi=>yi+N0)}catch(Ot){console.warn("تعذر تحديث رصيد الدرج النقدي بعد البيع:",Ot)}z({title:"تم البيع",description:`تم بيع ${w} قطعة من ${o.name}`})}catch(Ve){console.error("Error selling product:",Ve),z({title:"فشل البيع",description:"تعذّر تنفيذ عملية البيع",variant:"destructive"})}},Vn=async o=>{if(N!=null&&N.uid){if(Ne){z({title:"غير مسموح في وضع الكاشير",description:"لا يمكن حذف إيصالات البيع أثناء الورديه",variant:"destructive"});return}Wt("تأكيد حذف إيصال بيع","أدخل الرقم السري الرئيسي لحذف الإيصال وعكس الآثار",async()=>{try{try{const C=`deletedSaleIds_${N.uid}`,T=localStorage.getItem(C),L=[...T?JSON.parse(T):[],o.id,o.firestoreId].filter(Boolean);localStorage.setItem(C,JSON.stringify(L))}catch{}const l=ve||(B==null?void 0:B.shopId)||"main",h=sr(),d=`salesData_${N.uid}_${l}_${h}`,g=`salesData_all_${N.uid}_${l}`,w=G.filter(C=>C.id!==o.id);try{localStorage.setItem(d,JSON.stringify(w));const C=localStorage.getItem(g),T=C?JSON.parse(C):[],R=(Array.isArray(T)?T:[]).filter(L=>(L==null?void 0:L.id)!==o.id);localStorage.setItem(g,JSON.stringify(R))}catch{}D(w);const _=[];if(!o.isDeferred)try{const C=(o.price??0)*(o.quantity??0),T=Wn(),R=localStorage.getItem(T),W=(R?parseFloat(R):0)-C;localStorage.setItem(T,W.toString());const te=`userData_${N==null?void 0:N.uid}`,se={cashBalance:W,lastUpdated:new Date().toISOString()};try{localStorage.setItem(te,JSON.stringify(se))}catch{}N!=null&&N.uid&&_.push(xn.updateUserData(N.uid,se));const Ce=(B==null?void 0:B.shopId)||ve;Ce&&_.push(ya(Lr(st,"dashboardData",Ce),{cashBalance:W}).catch(()=>{}));try{window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:W}}))}catch{}const Te=((o.price??0)-(o.wholesalePrice??0))*(o.quantity??0);Re(ce=>ce-C),et(ce=>ce-Te),zn(ce=>ce-Te)}catch(C){console.warn("تعذر عكس رصيد الدرج النقدي عند حذف الإيصال:",C)}try{if(o.cartItems&&o.cartItems.length>0){const C=[];for(const T of o.cartItems){const R=Ae.find(L=>L.id===T.productId||L.name===T.productName);if(R){const L=(R.quantity||0)+(T.quantity||0);C.push({id:R.id,qty:L}),_.push(ya(Lr(st,"products",R.id),{quantity:L,updatedAt:qr()}))}}Xe(T=>T.map(R=>{const L=C.find(W=>W.id===R.id);return L?{...R,quantity:L.qty}:R}))}else{const C=Ae.find(T=>o.barcode&&T.barcode===o.barcode||T.name===o.productName);if(C){const T=(C.quantity||0)+(o.quantity||0);Xe(R=>R.map(L=>L.id===C.id?{...L,quantity:T}:L)),_.push(ya(Lr(st,"products",C.id),{quantity:T,updatedAt:qr()}))}}}catch(C){console.warn("تعذر عكس المخزون عند حذف الإيصال:",C)}try{_.push((async()=>{try{if(o.transactionReference){const T=dr(Vt(st,"userTransactions"),vt("userId","==",N.uid),vt("reference","==",o.transactionReference)),R=await Cr(T);await Promise.all(R.docs.map(L=>Jn(L.ref)))}else{const T=(o.price??0)*(o.quantity??0),R=o.createdAtMs||new Date(o.date+"T"+(o.time||"00:00")).getTime(),L=R-6e4*2,W=R+6e4*2,te=dr(Vt(st,"userTransactions"),vt("userId","==",N.uid),vt("type","==","sales"),vt("saleProductName","==",o.productName),vt("amount","==",T)),Ce=(await Cr(te)).docs.filter(Te=>{var ze,kt,Ot;const ce=Te.data(),Ve=((Ot=(kt=(ze=ce.createdAt)==null?void 0:ze.toDate)==null?void 0:kt.call(ze))==null?void 0:Ot.getTime())||new Date(ce.createdAt).getTime();return Ve>=L&&Ve<=W});await Promise.all(Ce.map(Te=>Jn(Te.ref)))}}catch(T){console.warn("Failed to delete from userTransactions",T)}})());const C=async()=>{try{const T=dr(Vt(st,"dailySales"),vt("userId","==",N.uid),vt("clientId","==",o.id)),R=await Cr(T);await Promise.all(R.docs.map(te=>Jn(te.ref)));const L=dr(Vt(st,"users",N.uid,"dailySales"),vt("clientId","==",o.id)),W=await Cr(L);await Promise.all(W.docs.map(te=>Jn(te.ref)))}catch(T){console.warn("تعذر حذف سجل البيع عبر الاستعلام:",T)}};o.firestoreId?(_.push((async()=>{try{await Jn(Lr(st,"dailySales",o.firestoreId))}catch(T){console.warn("Failed to delete from root dailySales by ID, trying fallback...",T),await C()}})()),_.push(Jn(Lr(st,"users",N.uid,"dailySales",o.firestoreId)).catch(()=>{}))):_.push(C())}catch(C){console.warn("تعذر جدولة حذف سجل البيع من Firestore:",C)}try{ea||setTimeout(()=>{try{Tn()}catch{}},0)}catch{}try{await Promise.allSettled(_)}catch{}z({title:"تم حذف الإيصال",description:`تم حذف إيصال بيع للمنتج ${o.productName} وتم عكس الآثار`})}catch(l){console.error("Error deleting sale:",l),z({title:"فشل حذف الإيصال",description:"تعذّر حذف إيصال البيع",variant:"destructive"})}})}},Mo=async o=>{try{Ke(l=>({...l,[o.id]:"1"})),await La(o)}catch(l){console.error("Error selling by barcode:",l)}},Sa=o=>{if(N!=null&&N.uid){if(Ne){z({title:"غير مسموح في وضع الكاشير",description:"لا يمكن حذف المنتجات أثناء الورديه",variant:"destructive"});return}Wt("تأكيد حذف منتج","لا يمكن حذف المنتجات إلا بإدخال الرقم السري الرئيسي",()=>{Ui(o)})}},_s=async()=>{if(!(!vr||!(N!=null&&N.uid)))try{await Jn(Lr(st,"products",vr.id)),Xe(o=>o.filter(l=>l.id!==vr.id)),z({title:"تم الحذف",description:`تم حذف المنتج ${vr.name}`})}catch(o){console.error("Error deleting product:",o),z({title:"فشل الحذف",description:"تعذّر حذف المنتج",variant:"destructive"})}finally{Ui(null)}},_0=async()=>{try{if(!(N!=null&&N.uid)){z({title:"خطأ",description:"غير مسجّل دخول",variant:"destructive"});return}if(Ne){z({title:"غير مسموح في وضع الكاشير",description:"لا يمكن إضافة منتجات أثناء الورديه",variant:"destructive"});return}const o=ee.productName.trim(),l=parseFloat(ee.price),h=parseFloat(ee.wholesalePrice||"0"),d=parseInt(ee.quantity);if(!o||isNaN(l)||isNaN(d)){z({title:"بيانات غير مكتملة",description:"أدخل اسم المنتج والسعر والكمية",variant:"destructive"});return}const g={name:o,sellingPrice:l,wholesalePrice:isNaN(h)?0:h,quantity:isNaN(d)?0:d,userId:N.uid,createdAt:qr(),updatedAt:qr()},w=(ee.barcode||"").trim();w&&(g.barcode=w);const _=(ee.serialNumber||"").trim();_&&(g.serialNumber=_);const C=(ee.supplierName||"").trim();C&&(g.supplierName=C),ee.categoryId&&(g.categoryId=ee.categoryId),B!=null&&B.shopId&&(g.shopId=B.shopId);const T=await Zi(Vt(st,"products"),g);Xe(R=>[{id:T.id,name:o,sellingPrice:l,wholesalePrice:isNaN(h)?0:h,quantity:isNaN(d)?0:d,barcode:(ee.barcode||"").trim()||"",serialNumber:(ee.serialNumber||"").trim()||"",supplierName:(ee.supplierName||"").trim()||"",categoryId:ee.categoryId},...R]),pe({productName:"",price:"",wholesalePrice:"",quantity:"",barcode:"",serialNumber:"",supplierName:"",categoryId:void 0}),z({title:"تمت الإضافة",description:`تم إضافة المنتج ${o} بنجاح`})}catch(o){console.error("createProduct error",o),z({title:"فشل الإضافة",description:"تعذّر إضافة المنتج. حاول مجددًا",variant:"destructive"})}},Xi=o=>{Qe(o),ae({productName:o.name,price:String(o.sellingPrice??""),wholesalePrice:String(o.wholesalePrice??""),quantity:String(o.quantity??""),barcode:o.barcode||"",serialNumber:o.serialNumber||"",supplierName:o.supplierName||"",categoryId:o.categoryId||""}),ue(!0)},A0=async()=>{try{if(!(N!=null&&N.uid)||!Ye){z({title:"خطأ",description:"لا يوجد مستخدم أو منتج محدد",variant:"destructive"});return}if(Ne){z({title:"غير مسموح في وضع الكاشير",description:"لا يمكن تعديل المنتجات أثناء الورديه",variant:"destructive"});return}const o=(K.productName||"").trim(),l=parseFloat(K.price||""),h=parseFloat(K.wholesalePrice||"0"),d=parseInt(K.quantity||"");if(!o||isNaN(l)){z({title:"بيانات غير مكتملة",description:"أدخل اسم المنتج وسعر البيع",variant:"destructive"});return}const g={name:o,sellingPrice:l,wholesalePrice:isNaN(h)?0:h,updatedAt:qr()};isNaN(d)||(g.quantity=d);const w=(K.barcode||"").trim();w?g.barcode=w:g.barcode="";const _=(K.serialNumber||"").trim();_?g.serialNumber=_:g.serialNumber="";const C=(K.supplierName||"").trim();C?g.supplierName=C:g.supplierName="",K.categoryId?g.categoryId=K.categoryId:g.categoryId=null,await ya(Lr(st,"products",Ye.id),g),Xe(T=>T.map(R=>R.id===Ye.id?{...R,name:o,sellingPrice:l,wholesalePrice:isNaN(h)?0:h,quantity:isNaN(d)?R.quantity:d,barcode:w,serialNumber:_,supplierName:C,categoryId:K.categoryId}:R)),ue(!1),Qe(null),z({title:"تم الحفظ",description:`تم تعديل المنتج ${o} بنجاح`})}catch(o){console.error("updateProduct error",o),z({title:"فشل التعديل",description:"تعذّر تعديل المنتج. حاول مجددًا",variant:"destructive"})}},zi=async o=>{const l=(o||"").trim();if(!l)return;const h=Ae.find(d=>(d.barcode||"")===l);if(!h){z({title:"باركود غير معروف",description:"لم يتم العثور على منتج بهذا الباركود"});return}await Mo(h)},b0=o=>{const l=Ae.find(h=>h.barcode===o);l?(Br(h=>({...h,[l.id]:Number(h[l.id]||0)+1})),z({title:"تمت الإضافة",description:`تم إضافة ${l.name} للعربة`}),tr("")):z({title:"غير موجود",description:"المنتج غير موجود",variant:"destructive"})},Hn=async()=>{try{const o=Ge,l=await eo.getCameras();if(!l||l.length===0)throw new Error("لا توجد كاميرات متاحة");const d=(l.find(g=>/back|rear|خلف/i.test(g.label))||l[l.length-1]).id;Nt.current=new eo("cart-scanner-container"),await Nt.current.start(d,{fps:10,qrbox:{width:250,height:120},formatsToSupport:[o.CODE_128,o.EAN_13,o.EAN_8,o.CODE_39]},g=>{b0(g),Gn()},()=>{}),ft(!0)}catch(o){console.error("cart scanner start error",o),z({title:"خطأ",description:"تعذّر تشغيل الكاميرا",variant:"destructive"})}},Gn=async()=>{try{Nt.current&&(await Nt.current.stop(),await Nt.current.clear(),Nt.current=null)}catch(o){console.warn(o)}ft(!1)};Fe.useEffect(()=>{Zt||Gn()},[Zt]);const Po=()=>{const o=Object.entries(br).map(([R,L])=>{const W=Number(L),te=Ae.find(se=>se.id===R);return!te||!W||W<=0?null:{name:te.name,qty:W,price:te.sellingPrice,total:W*te.sellingPrice}}).filter(Boolean);if(o.length===0){z({title:"لم يتم اختيار منتجات",description:"اختر منتجات عبر زر + لإضافتها للفاتورة"});return}const l=xr||(B==null?void 0:B.shopName)||(N==null?void 0:N.displayName)||"المحل",h=Jt||(B==null?void 0:B.phone)||(N==null?void 0:N.phoneNumber)||"",d=lt||(B==null?void 0:B.address)||"",g=o.reduce((R,L)=>R+L.total,0),w=new Date().toLocaleString("ar-EG"),_=o.map(R=>`
        <tr>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;font-size:12px">${R.name}</td>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;text-align:center;font-size:12px">${R.qty}</td>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;text-align:center;font-size:12px">${yt(R.price)}</td>
          <td style="border-bottom:1px dashed #ddd;padding:4px 2px;text-align:center;font-weight:bold;font-size:12px">${yt(R.total)}</td>
        </tr>
      `).join(""),C=`
      <html>
        <head>
          <meta charset="utf-8" />
          <title>فاتورة</title>
          <style>
            @media print {
                @page { size: 80mm auto; margin: 0; }
                body { width: 80mm; margin: 0; padding: 5px; }
            }
            body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; direction: rtl; padding: 10px; margin: 0; width: 80mm; box-sizing: border-box; }
            .header { text-align: center; margin-bottom: 10px; border-bottom: 2px solid #000; padding-bottom: 5px; }
            .header h2 { margin: 0; font-size: 18px; font-weight: bold; }
            .meta { text-align: center; font-size: 11px; margin-bottom: 3px; color: #333; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
            th { border-bottom: 2px solid #000; font-size: 12px; padding: 4px 2px; text-align: center; }
            .total-section { border-top: 2px solid #000; padding-top: 5px; margin-top: 5px; }
            .total-row { display: flex; justify-content: space-between; font-weight: bold; font-size: 14px; margin-top: 5px; }
            .footer { text-align: center; font-size: 10px; margin-top: 15px; border-top: 1px dotted #ccc; padding-top: 5px; }
          </style>
        </head>
        <body>
          <div class="header">
            <h2>${l}</h2>
            ${d?`<div class="meta">${d}</div>`:""}
            ${h?`<div class="meta">ت: ${h}</div>`:""}
            <div class="meta">${w}</div>
          </div>
          <table>
            <thead>
              <tr>
                <th style="text-align:right">الصنف</th>
                <th>العدد</th>
                <th>سعر</th>
                <th>الإجمالي</th>
              </tr>
            </thead>
            <tbody>
              ${_}
            </tbody>
          </table>
          <div class="total-section">
            <div class="total-row">
                <span>الإجمالي:</span>
                <span>${yt(g)}</span>
            </div>
          </div>
          <div class="footer">شكراً لتعاملكم معنا</div>
        </body>
      </html>
    `,T=window.open("","_blank");T&&(T.document.write(C),T.document.close(),T.focus(),setTimeout(()=>{T.print(),T.close()},500))},[Xn,Yi]=Fe.useState(0),[Sn,Nn]=Fe.useState(0),[da,Ki]=Fe.useState(0),[Na,As]=Fe.useState(0),[qi,C0]=Fe.useState(!1),[bs,ka]=Fe.useState(!1),[T0,zn]=Fe.useState(0),vi=()=>new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(new Date),Dt=async()=>{if(!(N!=null&&N.uid))return 0;const o=vi(),l=new Date().toISOString().split("T")[0],h=sr(),d=ve||(B==null?void 0:B.shopId)||null;let g=0;try{const w=dr(Vt(st,"dailySales"),vt("userId","==",N.uid),...d?[vt("shopId","==",d)]:[]),_=await Cr(w),C=[];_.forEach(L=>{C.push({id:L.id,data:L.data()})}),(await Cr(Vt(st,"users",N.uid,"dailySales"))).forEach(L=>{const W=L.data();d&&W.shopId&&W.shopId!==d||C.push({id:L.id,data:W})});const R=new Map;C.forEach(L=>{const W=String(L.data.clientId||L.id);R.has(W)||R.set(W,L)}),R.forEach(({data:L})=>{const W=String(L.date||"").slice(0,10);if(!L.isDeferred&&(W===o||W===l||W===h)){const te=Number(L.quantity||1),se=Number(L.profit??(Number(L.sellingPrice||0)-Number(L.wholesalePrice||0))*te);g+=se}})}catch(w){console.warn("تعذر جلب أرباح المبيعات اليومية للملخص:",w)}return Math.round(g*100)/100};Fe.useEffect(()=>{!e||!(N!=null&&N.uid)||(async()=>{try{zn(await Dt())}catch{}})()},[e,N==null?void 0:N.uid,ve,f]);const Yn=()=>{const o=ve||(B==null?void 0:B.shopId)||"main",l=(N==null?void 0:N.uid)||"guest";return{daily:`dailyOffset_${l}_${o}_${f}`,monthly:`monthlyOffset_${l}_${o}_${u}`}};Fe.useEffect(()=>{if(!(N!=null&&N.uid))return;const o=Yn(),l=ve||(B==null?void 0:B.shopId)||"main",h=(N==null?void 0:N.uid)||"guest";try{let d=localStorage.getItem(o.daily);if(!d&&l!=="main"&&(d=localStorage.getItem(`dailyOffset_${h}_main_${f}`)),d){const{sales:w,profit:_}=JSON.parse(d);Yi(Number(w)||0),Nn(Number(_)||0)}else C0(!0),Yi(0),Nn(0);let g=localStorage.getItem(o.monthly);if(!g&&l!=="main"&&(g=localStorage.getItem(`monthlyOffset_${h}_main_${u}`)),g){const{sales:w,profit:_}=JSON.parse(g);Ki(Number(w)||0),As(Number(_)||0)}else ka(!0),Ki(0),As(0)}catch(d){console.error("Failed to load offsets",d)}},[N==null?void 0:N.uid,ve,B==null?void 0:B.shopId,e,f,u]);const I=(o,l)=>{const h=Yn();localStorage.setItem(h.daily,JSON.stringify({sales:o,profit:l}))},a=(o,l)=>{const h=Yn();localStorage.setItem(h.monthly,JSON.stringify({sales:o,profit:l}))};Fe.useEffect(()=>{if(e&&qi){const o=G.filter(h=>!h.isDeferred&&h.date===f).reduce((h,d)=>h+d.price*d.quantity,0),l=G.filter(h=>!h.isDeferred&&h.date===f).reduce((h,d)=>h+(d.price-(d.wholesalePrice??0))*d.quantity,0);Yi(o),Nn(l),I(o,l),C0(!1)}},[e,qi,G]),Fe.useEffect(()=>{e&&bs&&(Ki(Ie),As(Be),a(Ie,Be),ka(!1))},[e,bs,Ie,Be]);const i=()=>{Wt("بدء وردية جديدة (تصفير العرض)","هل تريد تصفير عدادات اليوم وبدء جلسة جديدة؟ (لن يتم حذف البيانات من السجل)",async()=>{try{const o=G.filter(h=>!h.isDeferred&&h.date===f).reduce((h,d)=>h+d.price*d.quantity,0),l=G.filter(h=>!h.isDeferred&&h.date===f).reduce((h,d)=>h+(d.price-(d.wholesalePrice??0))*d.quantity,0);Yi(o),Nn(l),I(o,l),z({title:"تم التصفير",description:"تم تصفير عدادات اليوم بنجاح (بياناتك آمنة في السجل)"})}catch(o){console.error(o),z({title:"خطأ",description:"حدث خطأ أثناء التصفير",variant:"destructive"})}})};return y.jsxs(Qa,{open:e,onOpenChange:r,children:[y.jsxs($a,{className:"max-w-none w-[100vw] h-[100dvh] p-0 overflow-hidden bg-background",children:[y.jsxs("div",{className:"flex flex-col h-full",dir:"rtl",children:[y.jsxs("div",{className:"bg-background dark:bg-card border-b border-border px-3 py-2 flex items-center justify-between shrink-0 z-10 h-14 sm:h-auto",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"bg-primary/10 p-1.5 rounded-full",children:y.jsx(Ru,{className:"h-4 w-4 text-primary"})}),y.jsxs("div",{className:"flex flex-col justify-center",children:[y.jsx(en,{className:"text-sm font-bold leading-tight text-foreground",children:"المبيعات والمنتجات"}),y.jsx("p",{className:"text-[10px] text-muted-foreground hidden sm:block leading-none mt-0.5",children:"إدارة عمليات البيع والمخزون"})]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsxs(He,{variant:"outline",size:"sm",onClick:()=>dn(),className:"hidden sm:flex h-7 text-[10px] px-2 dark:border-gray-700 dark:text-gray-300",children:[y.jsx(Nl,{className:"h-3 w-3 ml-1.5"}),"مزامنة"]}),y.jsx(He,{variant:"ghost",size:"icon",onClick:r,className:"rounded-full h-8 w-8 hover:bg-muted",children:y.jsx(Ns,{className:"h-4 w-4"})})]})]}),y.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row",children:[y.jsx("div",{className:"w-full md:w-80 bg-muted/30 dark:bg-card/50 border-l dark:border-border flex flex-col shrink-0 order-2 md:order-1",children:y.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin",children:y.jsxs("div",{className:"p-4 space-y-4",children:[y.jsxs(tn,{className:"hidden md:block dark:bg-card dark:border-border",children:[y.jsxs(yu,{className:"p-4 pb-2 flex flex-row items-center justify-between space-y-0",children:[y.jsxs(Eu,{className:"text-sm font-medium flex items-center gap-2 text-foreground",children:[y.jsx(Ji,{className:"h-4 w-4 text-primary"}),"ملخص اليوم"]}),y.jsx(He,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-red-600 dark:hover:text-red-400",onClick:i,title:"تصفير اليوم",children:y.jsx(Ol,{className:"h-3.5 w-3.5"})})]}),y.jsxs(k0,{className:"p-4 pt-2 space-y-3",children:[y.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border dark:border-gray-700",children:[y.jsx("span",{className:"text-sm text-muted-foreground",children:"المبيعات"}),y.jsx("span",{className:"text-lg font-bold text-primary",children:yt(Math.max(0,G.filter(o=>!o.isDeferred&&o.date===f).reduce((o,l)=>o+l.price*l.quantity,0)-Xn))})]}),y.jsxs("div",{className:"relative overflow-hidden p-3 bg-emerald-50/50 dark:bg-emerald-950/20 rounded-lg border border-emerald-100 dark:border-emerald-900/50",children:[y.jsxs("div",{className:`flex justify-between items-center ${ye?"blur-sm":""}`,children:[y.jsx("span",{className:"text-sm text-emerald-700 dark:text-emerald-400",children:"الأرباح"}),y.jsx("span",{className:"text-lg font-bold text-emerald-700 dark:text-emerald-400",children:yt(T0)})]}),ye&&y.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 dark:bg-black/50",children:y.jsxs(He,{size:"sm",variant:"outline",onClick:()=>xe(!0),className:"h-7 text-xs bg-white dark:bg-gray-800 dark:border-gray-700",children:[y.jsx(cl,{className:"h-3 w-3 ml-1"}),"عرض"]})})]})]})]}),y.jsxs(tn,{className:"shadow-none border-none bg-transparent hidden md:block",children:[y.jsx("div",{className:"flex items-center justify-between w-full p-2",children:y.jsxs("button",{onClick:()=>pt(!ut),className:"flex items-center gap-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-primary transition-colors flex-1 text-right",children:[y.jsx(j0,{className:"h-4 w-4"}),"تقارير الشهر",ut?y.jsx(P0,{className:"h-4 w-4"}):y.jsx(Du,{className:"h-4 w-4"})]})}),!ut&&y.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 animate-in slide-in-from-top-2",children:y.jsxs("div",{className:"col-span-2 relative",children:[y.jsxs("div",{className:`grid grid-cols-2 gap-2 ${ea?"blur-sm select-none":""}`,children:[y.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-950/20 p-3 rounded-xl border border-indigo-100 dark:border-indigo-900/50 text-center",children:[y.jsx("span",{className:"text-[10px] text-indigo-600 dark:text-indigo-400 block mb-1",children:"المبيعات"}),y.jsx("span",{className:"text-sm font-bold text-indigo-700 dark:text-indigo-300",children:yt(Math.max(0,Ie-da))})]}),y.jsxs("div",{className:"bg-pink-50 dark:bg-pink-950/20 p-3 rounded-xl border border-pink-100 dark:border-pink-900/50 text-center",children:[y.jsx("span",{className:"text-[10px] text-pink-600 dark:text-pink-400 block mb-1",children:"الأرباح"}),y.jsx("span",{className:"text-sm font-bold text-pink-700 dark:text-pink-300",children:yt(Math.max(0,Be-Na))})]})]}),ea&&y.jsx("div",{className:"absolute inset-0 z-10 pointer-events-none",children:y.jsx("div",{className:"flex justify-center pt-2 pointer-events-auto",children:y.jsx(He,{"aria-label":"عرض",variant:"ghost",size:"icon",onClick:()=>Kr(!0),className:"rounded-full h-8 w-8 bg-white/80 dark:bg-black/50 backdrop-blur-sm shadow",children:y.jsx(ks,{className:"h-4 w-4 text-indigo-700 dark:text-indigo-400"})})})})]})})]}),y.jsx(tn,{className:"shadow-none border-none bg-transparent hidden md:block mt-2",children:y.jsxs("div",{className:"bg-amber-50 dark:bg-amber-950/20 p-3 rounded-xl border border-amber-100 dark:border-amber-900/50 text-center relative overflow-hidden",children:[y.jsx("span",{className:"text-[10px] text-amber-600 dark:text-amber-400 block mb-1",children:"إجمالي المخزون (جملة)"}),y.jsx("span",{className:"text-sm font-bold text-amber-700 dark:text-amber-300",children:yt(Ae.reduce((o,l)=>o+(Number(l.wholesalePrice)||0)*(Number(l.quantity)||0),0))})]})}),y.jsx(M0,{className:"hidden md:block"})]})})}),y.jsx("div",{className:"flex-1 overflow-hidden flex flex-col order-1 md:order-2 bg-background dark:bg-background",children:y.jsxs(Su,{defaultValue:"products",className:"flex-1 flex flex-col overflow-hidden",children:[y.jsxs("div",{className:"px-2 py-1.5 bg-gray-50 dark:bg-card border-b border-dashed border-gray-300/60 dark:border-gray-700 flex items-center justify-between shrink-0",children:[y.jsxs(Nu,{className:"h-8 dark:bg-gray-800",children:[y.jsx(Uo,{value:"products",className:"text-xs px-2 sm:px-3 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 dark:text-gray-300 dark:data-[state=active]:text-white",children:"المنتجات والبيع"}),y.jsx(Uo,{value:"categories",className:"text-xs px-2 sm:px-3 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 dark:text-gray-300 dark:data-[state=active]:text-white",children:"الاقسام"}),y.jsxs(Uo,{value:"sales-log",className:"text-xs px-2 sm:px-3 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700 dark:text-gray-300 dark:data-[state=active]:text-white",children:["سجل المبيعات",y.jsx(Fn,{variant:"secondary",className:"mr-2 h-5 px-1.5 text-[10px] hidden sm:inline-flex dark:bg-gray-600 dark:text-white",children:G.filter(o=>!o.isDeferred).length})]})]}),y.jsxs(He,{variant:"ghost",size:"sm",className:"md:hidden text-xs h-8 px-2 bg-white/50 dark:bg-gray-800/50 border dark:border-gray-700 mr-1 text-primary dark:text-primary-foreground",onClick:()=>Bt(!0),children:[y.jsx(Bo,{className:"h-3 w-3 ml-1"}),"تفاصيل اليوم"]}),y.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 font-mono",dir:"ltr",children:[y.jsx("span",{className:"hidden sm:inline",children:new Date().toLocaleDateString("ar-EG")}),y.jsx(I0,{className:"h-3.5 w-3.5 text-gray-400"})]})]}),y.jsx(Wo,{value:"products",className:"flex-1 p-0 m-0 overflow-hidden h-full relative",children:y.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-thin",children:y.jsxs("div",{className:"p-4 space-y-4",children:[y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs(tn,{className:"border-dashed border-2 border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 transition-all bg-gray-50/30 dark:bg-gray-900/30 overflow-hidden",children:[y.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",onClick:()=>re(!Pe),children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"bg-emerald-100 dark:bg-emerald-900/30 p-2 rounded-full",children:y.jsx(In,{className:"h-5 w-5 text-emerald-600 dark:text-emerald-400"})}),y.jsxs("div",{className:"text-right",children:[y.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:"إضافة منتج جديد"}),y.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"تسجيل منتج جديد في المخزون"})]})]}),y.jsx(He,{variant:"ghost",size:"sm",className:"rounded-full h-8 w-8 p-0",children:y.jsx(P0,{className:`h-5 w-5 text-gray-400 transition-transform duration-200 ${Pe?"rotate-180":""}`})})]}),Pe&&y.jsxs("div",{className:"px-4 pb-4 pt-0 animate-in slide-in-from-top-2",children:[y.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent mb-4 opacity-50"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{className:"space-y-1.5",children:[y.jsxs(Ut,{className:"text-xs font-medium text-gray-700",children:["اسم المنتج ",y.jsx("span",{className:"text-red-500",children:"*"})]}),y.jsx(Rt,{value:ee.productName,onChange:o=>pe(l=>({...l,productName:o.target.value})),className:"h-9 bg-white",placeholder:"مثال: شاحن آيفون أصلي"})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{className:"space-y-1.5",children:[y.jsxs(Ut,{className:"text-xs font-medium text-gray-700",children:["سعر البيع ",y.jsx("span",{className:"text-red-500",children:"*"})]}),y.jsx(Rt,{type:"number",value:ee.price,onChange:o=>pe(l=>({...l,price:o.target.value})),className:"h-9 bg-white",placeholder:"0.00"})]}),y.jsxs("div",{className:"space-y-1.5",children:[y.jsx(Ut,{className:"text-xs font-medium text-gray-700",children:"سعر الجملة"}),y.jsx(Rt,{type:"number",value:ee.wholesalePrice||"",onChange:o=>pe(l=>({...l,wholesalePrice:o.target.value})),className:"h-9 bg-white",placeholder:"0.00"})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{className:"space-y-1.5",children:[y.jsxs(Ut,{className:"text-xs font-medium text-gray-700",children:["الكمية ",y.jsx("span",{className:"text-red-500",children:"*"})]}),y.jsx(Rt,{type:"number",value:ee.quantity,onChange:o=>pe(l=>({...l,quantity:o.target.value})),className:"h-9 bg-white",placeholder:"1"})]}),y.jsxs("div",{className:"space-y-1.5",children:[y.jsx(Ut,{className:"text-xs font-medium text-gray-700",children:"الباركود (اختياري)"}),y.jsxs("div",{className:"relative",children:[y.jsx(Rt,{value:ee.barcode||"",onChange:o=>pe(l=>({...l,barcode:o.target.value})),className:"h-9 bg-white pl-8",placeholder:"Scan..."}),y.jsx("button",{type:"button",onClick:()=>{O(!0),j(""),q()},title:"مسح الباركود بالكاميرا",className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-7 w-7 rounded hover:bg-gray-100 flex items-center justify-center",children:y.jsx(Rs,{className:"h-4 w-4 text-gray-600"})})]}),y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mt-2",children:[y.jsxs(He,{variant:"outline",size:"sm",onClick:wa,title:"إنشاء باركود","aria-label":"إنشاء باركود",className:"h-9 w-full bg-white flex items-center justify-center",children:[y.jsx(Mu,{className:"h-4 w-4"}),y.jsx("span",{className:"sr-only",children:"إنشاء باركود"})]}),y.jsxs(He,{variant:"secondary",size:"sm",onClick:Wr,title:"طباعة الباركود","aria-label":"طباعة الباركود",className:"h-9 w-full bg-white flex items-center justify-center",disabled:qa||!(Ka||ln),children:[y.jsx(Pu,{className:"h-4 w-4"}),y.jsx("span",{className:"sr-only",children:"طباعة الباركود"})]})]}),y.jsx("div",{className:"mt-2",children:Za?y.jsxs("div",{className:"bg-white border rounded p-2",children:[y.jsx("div",{id:Y,className:"w-full h-[220px]"}),P&&y.jsx("div",{className:"text-[11px] text-red-600 text-center mt-1",children:P}),y.jsx("div",{className:"flex justify-end gap-2 mt-2",children:y.jsxs(He,{size:"sm",variant:"outline",onClick:he,title:"إيقاف الماسح","aria-label":"إيقاف الماسح",children:[y.jsx(Ns,{className:"h-4 w-4"}),y.jsx("span",{className:"sr-only",children:"إيقاف الماسح"})]})})]}):qa?y.jsx("div",{className:"text-[11px] text-gray-500 text-center",children:"جاري إنشاء المعاينة..."}):Ka||ln?y.jsx("img",{src:Ka||ln,alt:"barcode",className:"w-full max-w-xs h-[70px] mx-auto bg-white rounded border"}):y.jsx("div",{className:"text-[11px] text-gray-500 text-center",children:"لا توجد معاينة بعد"})})]})]}),y.jsxs("div",{className:"space-y-1.5",children:[y.jsx(Ut,{className:"text-xs font-medium text-gray-700",children:"القسم (اختياري)"}),y.jsxs(hl,{value:ee.categoryId||"none",onValueChange:o=>pe(l=>({...l,categoryId:o==="none"?void 0:o})),children:[y.jsx(ul,{className:"h-9 bg-white text-right",dir:"rtl",children:y.jsx(dl,{placeholder:"اختر القسم"})}),y.jsxs(xl,{children:[y.jsx(B0,{value:"none",children:"بدون قسم"}),hi.map(o=>y.jsx(B0,{value:o.id,children:o.name},o.id))]})]})]}),y.jsxs("div",{className:"space-y-1.5",children:[y.jsx(Ut,{className:"text-xs font-medium text-gray-700",children:"اسم المورد (اختياري)"}),y.jsx(Rt,{value:ee.supplierName||"",onChange:o=>pe(l=>({...l,supplierName:o.target.value})),className:"h-9 bg-white",placeholder:"مثال: شركة إلكترونيات"})]}),y.jsx("div",{className:"col-span-1 md:col-span-2 flex items-end",children:y.jsxs(He,{className:"w-full h-9 bg-emerald-600 hover:bg-emerald-700 text-white shadow-sm",onClick:()=>{if(Ne){z({title:"غير مسموح",description:"لا يمكن إضافة منتج أثناء الوردية",variant:"destructive"});return}Wt("إضافة منتج","أدخل الرقم السري للمتابعة",_0)},children:[y.jsx(In,{className:"h-4 w-4 ml-2"}),"حفظ المنتج الجديد"]})})]})]})]}),y.jsxs(tn,{className:"border-dashed border-2 border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 transition-all bg-gray-50/30 dark:bg-gray-900/30 overflow-hidden",children:[y.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",onClick:()=>Ft(!_n),children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"bg-indigo-100 dark:bg-indigo-900/30 p-2 rounded-full",children:y.jsx(Ji,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),y.jsxs("div",{className:"text-right",children:[y.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:"بيع منتج فوري (غير مسجل)"}),y.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"أدخل بيانات المنتج الآن وسيتم البيع بدون إضافته للمخزون"})]})]}),y.jsx(He,{variant:"ghost",size:"sm",className:"rounded-full h-8 w-8 p-0",children:y.jsx(P0,{className:`h-5 w-5 text-gray-400 transition-transform duration-200 ${_n?"rotate-180":""}`})})]}),_n&&y.jsxs("div",{className:"px-4 pb-4 pt-0 animate-in slide-in-from-top-2",children:[y.jsx("div",{className:"h-px bg-gray-200 mb-4"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{className:"space-y-1.5",children:[y.jsxs(Ut,{className:"text-xs font-medium text-gray-700",children:["اسم المنتج ",y.jsx("span",{className:"text-red-500",children:"*"})]}),y.jsx(Rt,{value:wr.productName,onChange:o=>la(l=>({...l,productName:o.target.value})),className:"h-9 bg-white",placeholder:"مثال: منتج خاص"})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{className:"space-y-1.5",children:[y.jsxs(Ut,{className:"text-xs font-medium text-gray-700",children:["سعر البيع ",y.jsx("span",{className:"text-red-500",children:"*"})]}),y.jsx(Rt,{type:"number",value:wr.price,onChange:o=>la(l=>({...l,price:o.target.value})),className:"h-9 bg-white dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100",placeholder:"0.00"})]}),y.jsxs("div",{className:"space-y-1.5",children:[y.jsx(Ut,{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"سعر الجملة (اختياري)"}),y.jsx(Rt,{type:"number",value:wr.wholesalePrice||"",onChange:o=>la(l=>({...l,wholesalePrice:o.target.value})),className:"h-9 bg-white dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100",placeholder:"0.00"})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{className:"space-y-1.5",children:[y.jsxs(Ut,{className:"text-xs font-medium text-gray-700",children:["الكمية ",y.jsx("span",{className:"text-red-500",children:"*"})]}),y.jsx(Rt,{type:"number",value:wr.quantity,onChange:o=>la(l=>({...l,quantity:o.target.value})),className:"h-9 bg-white",placeholder:"1"})]}),y.jsxs("div",{className:"space-y-1.5",children:[y.jsx(Ut,{className:"text-xs font-medium text-gray-700",children:"الباركود (اختياري)"}),y.jsxs("div",{className:"relative",children:[y.jsx(Rt,{value:wr.barcode||"",onChange:o=>la(l=>({...l,barcode:o.target.value})),className:"h-9 bg-white pl-8",placeholder:"Scan..."}),y.jsx(Rs,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400"})]})]})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[y.jsxs("div",{className:"space-y-1.5",children:[y.jsx(Ut,{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"الرقم التسلسلي (اختياري)"}),y.jsx(Rt,{value:wr.serialNumber||"",onChange:o=>la(l=>({...l,serialNumber:o.target.value})),className:"h-9 bg-white dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100",placeholder:"SN..."})]}),y.jsx("div",{className:"flex items-end",children:y.jsxs(He,{className:"w-full h-9 bg-indigo-600 hover:bg-indigo-700 text-white shadow-sm",onClick:$t,children:[y.jsx(Ji,{className:"h-4 w-4 ml-2"}),"بيع الآن"]})})]})]})]})]})]}),y.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-stretch sm:items-center justify-between bg-white p-2 rounded-xl border border-gray-100 shadow-sm",children:[y.jsxs("div",{className:"relative flex-1 w-full sm:max-w-md group",children:[y.jsx(Vo,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-primary transition-colors"}),y.jsx(Rt,{value:Wi,onChange:o=>v0(o.target.value),placeholder:"بحث عن منتج بالاسم...",className:"pl-3 pr-9 h-10 border-0 bg-transparent focus-visible:ring-0 placeholder:text-gray-400"})]}),y.jsx("div",{className:"h-8 w-px bg-gray-200 hidden sm:block"}),y.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx(He,{variant:"outline",size:"sm",onClick:$e,title:"تصدير اكسيل",className:"h-9 w-9 p-0",children:y.jsx(Fl,{className:"h-4 w-4 text-gray-600"})}),y.jsxs("div",{className:"relative",children:[y.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:E0,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",title:"استيراد اكسيل"}),y.jsx(He,{variant:"outline",size:"sm",className:"h-9 w-9 p-0",children:y.jsx(Dl,{className:"h-4 w-4 text-gray-600"})})]})]}),y.jsxs("div",{className:"relative flex-1 sm:w-48 group",children:[y.jsx(Rs,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-primary transition-colors"}),y.jsx(Rt,{value:tt,onChange:o=>nt(o.target.value),onKeyDown:async o=>{o.key==="Enter"&&tt.trim()&&(await zi(tt.trim()),nt(""))},placeholder:"ماسح الباركود...",className:"pr-9 h-9 bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 focus:bg-white dark:focus:bg-gray-950 transition-all text-sm dark:text-gray-100"})]}),y.jsxs("div",{className:"flex items-center gap-1 border-r dark:border-gray-700 pr-2 mr-1",children:[y.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:E0,className:"hidden",id:"excel-upload",disabled:Ne}),y.jsx("label",{htmlFor:"excel-upload",children:y.jsx(He,{variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-full cursor-pointer",asChild:!0,disabled:Ne,children:y.jsx("span",{children:y.jsx(Dl,{className:"h-4 w-4"})})})}),y.jsx(He,{variant:"ghost",size:"icon",onClick:$e,className:"h-9 w-9 shrink-0 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-full",title:"تصدير لملف Excel",children:y.jsx(Fl,{className:"h-4 w-4"})}),y.jsxs(He,{variant:"ghost",size:"icon",onClick:()=>zr(!0),className:"h-9 w-9 shrink-0 transition-all rounded-full text-gray-500 hover:text-primary hover:bg-primary/10 relative",title:"عربة المبيعات",children:[y.jsx(Rl,{className:"h-4 w-4"}),Qt>0&&y.jsx("span",{className:"absolute -top-2 -right-2 bg-red-600 text-white text-[10px] font-bold rounded-full h-5 w-5 flex items-center justify-center border-2 border-white shadow-sm",children:Qt})]})]})]})]}),y.jsx("div",{className:"space-y-4",children:ys.length===0?y.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 bg-white rounded-xl border border-dashed border-gray-200 text-center shadow-sm",children:[y.jsx("div",{className:"bg-gray-50 p-4 rounded-full mb-4",children:y.jsx(Al,{className:"h-10 w-10 text-gray-300"})}),y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"لا توجد منتجات"}),y.jsx("p",{className:"text-gray-500 text-sm max-w-xs mx-auto mb-4",children:"لم يتم العثور على منتجات تطابق بحثك."}),y.jsxs(He,{variant:"outline",onClick:()=>re(!0),className:"gap-2",children:[y.jsx(In,{className:"h-4 w-4"}),"إضافة منتج جديد"]})]}):y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"hidden md:block bg-[#fcf9f2] dark:bg-card rounded-xl border border-gray-100 dark:border-border shadow-sm overflow-hidden",children:y.jsxs(F0,{children:[y.jsx(D0,{className:"bg-gray-50/80 dark:bg-gray-900/80",children:y.jsxs(Qn,{className:"hover:bg-transparent border-gray-100 dark:border-gray-800",children:[y.jsx(ar,{className:"text-right h-11 font-semibold text-gray-700 dark:text-gray-300",children:"المنتج"}),y.jsx(ar,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-28",children:"السعر"}),y.jsx(ar,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-28",children:y.jsxs("div",{className:"flex items-center justify-center gap-1.5 cursor-pointer hover:text-primary transition-colors select-none",onClick:()=>{pa?En(!1):Wt("عرض سعر الجملة","أدخل الرقم السري الرئيسي لعرض سعر الجملة",()=>En(!0))},children:[y.jsx("span",{children:"الجملة"}),pa?y.jsx(_u,{className:"h-3.5 w-3.5"}):y.jsx(ks,{className:"h-3.5 w-3.5"})]})}),y.jsx(ar,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-24",children:"الكمية"}),y.jsx(ar,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300 w-[360px]",children:"إجراءات البيع"})]})}),y.jsx(O0,{children:ys.map(o=>y.jsxs(Qn,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 transition-colors border-gray-100 dark:border-gray-800",children:[y.jsxs(nr,{className:"font-medium py-3",children:[y.jsx("div",{className:"text-gray-900 dark:text-gray-100 font-bold",children:o.name}),o.barcode&&y.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-gray-500 dark:text-gray-400 font-mono mt-0.5",children:[y.jsx(Rs,{className:"h-3 w-3"}),o.barcode]})]}),y.jsx(nr,{className:"text-center py-3",children:y.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-950/30 px-2 py-1 rounded-md",children:yt(o.sellingPrice)})}),y.jsx(nr,{className:"text-center py-3",children:y.jsx("span",{className:`font-medium text-xs ${pa?"text-gray-600 dark:text-gray-400":"blur-sm select-none text-gray-300 dark:text-gray-600"}`,children:yt(o.wholesalePrice)})}),y.jsx(nr,{className:"text-center py-3",children:y.jsxs("div",{className:"flex items-center justify-center gap-1",children:[y.jsx(Fn,{variant:o.quantity>0?"outline":"destructive",className:`font-mono ${o.quantity>0?"bg-gray-50 dark:bg-gray-900 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700":""}`,children:o.quantity}),y.jsx(He,{size:"icon",variant:"ghost",className:"h-5 w-5 rounded-full text-emerald-600 hover:bg-emerald-50 hover:text-emerald-700",onClick:()=>Es(o),title:"إضافة مخزون",children:y.jsx(In,{className:"h-3 w-3"})})]})}),y.jsx(nr,{className:"py-3",children:y.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[y.jsxs("div",{className:"relative group",children:[y.jsx(Rt,{type:"number",className:"h-8 w-14 text-center px-1 text-sm bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 focus:border-primary/50 dark:text-gray-100",placeholder:"1",value:Z[o.id]||"",onChange:l=>Ke(h=>({...h,[o.id]:l.target.value}))}),y.jsx("span",{className:"absolute -top-2 -right-1 text-[9px] bg-white dark:bg-gray-800 px-0.5 text-gray-400 rounded",children:"العدد"})]}),y.jsxs("div",{className:"relative group",children:[y.jsx(Rt,{type:"number",className:"h-8 w-16 text-center px-1 bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 focus:border-primary/50 text-sm focus:bg-white dark:focus:bg-gray-950 transition-colors dark:text-gray-100",placeholder:"سعر",value:ir[o.id]||"",onChange:l=>Pa(h=>({...h,[o.id]:l.target.value})),title:"سعر بيع مخصص"}),y.jsx("span",{className:"absolute -top-2 -right-1 text-[9px] bg-white dark:bg-gray-800 px-0.5 text-gray-400 rounded",children:"مخصص"})]}),y.jsx(He,{size:"sm",className:"h-8 bg-indigo-600 hover:bg-indigo-700 text-white shadow-sm px-3 font-medium",onClick:()=>La(o),children:"بيع"}),y.jsx(He,{size:"icon",variant:"outline",className:"h-8 w-8 rounded-full border-indigo-200 text-indigo-600 hover:bg-indigo-50",onClick:()=>Br(l=>({...l,[o.id]:Number(l[o.id]||0)+1})),title:"إضافة للفاتورة",children:y.jsx(In,{className:"h-4 w-4"})}),(br[o.id]||0)>0&&y.jsx(Fn,{variant:"outline",className:"font-mono bg-indigo-50 text-indigo-700 border-indigo-200",children:br[o.id]}),y.jsxs(ku,{children:[y.jsx(Iu,{asChild:!0,children:y.jsx(He,{size:"icon",variant:"ghost",className:"h-8 w-8 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full",children:y.jsx(Uu,{className:"h-4 w-4"})})}),y.jsxs(Fu,{align:"end",className:"w-40",children:[y.jsxs(R0,{onClick:()=>Xi(o),disabled:Ne,children:[y.jsx(kl,{className:"h-3.5 w-3.5 ml-2 text-blue-600"}),"تعديل المنتج"]}),y.jsxs(R0,{onClick:()=>Es(o),children:[y.jsx(In,{className:"h-3.5 w-3.5 ml-2 text-emerald-600"}),"إضافة مخزون"]}),y.jsxs(R0,{onClick:()=>{Ja(o),ua(!0)},children:[y.jsx(I0,{className:"h-3.5 w-3.5 ml-2 text-amber-600"}),"بيع مؤجل"]}),y.jsxs(R0,{onClick:()=>Sa(o),disabled:Ne,className:"text-red-600 focus:text-red-700",children:[y.jsx(Is,{className:"h-3.5 w-3.5 ml-2"}),"حذف المنتج"]})]})]})]})})]},o.id))})]})}),y.jsx("div",{className:"md:hidden grid grid-cols-1 gap-3",children:ys.map(o=>y.jsx(tn,{className:"overflow-hidden border-gray-100 dark:border-gray-800 shadow-sm hover:shadow-md transition-shadow bg-[#fcf9f2] dark:bg-card",children:y.jsxs(k0,{className:"p-4 space-y-4",children:[y.jsxs("div",{className:"flex justify-between items-start",children:[y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100 text-base",children:o.name}),y.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[y.jsx(Fn,{variant:"secondary",className:"bg-emerald-50 dark:bg-emerald-950/30 text-emerald-700 dark:text-emerald-400 border-emerald-100 dark:border-emerald-900/50",children:yt(o.sellingPrice)}),y.jsxs("span",{className:`text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1 ${!pa&&"blur-sm select-none"}`,children:[y.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"جملة:"}),yt(o.wholesalePrice)]}),y.jsx("span",{className:"text-gray-300 dark:text-gray-700",children:"|"}),y.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300 font-medium flex items-center gap-1",children:["متاح: ",o.quantity,y.jsx(He,{size:"icon",variant:"ghost",className:"h-5 w-5 rounded-full text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-950/30",onClick:()=>Es(o),children:y.jsx(In,{className:"h-3 w-3"})})]})]})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx(He,{size:"icon",variant:"ghost",className:"h-8 w-8 -mt-1 -ml-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-950/30 rounded-full",onClick:()=>Xi(o),disabled:Ne,children:y.jsx(kl,{className:"h-4 w-4"})}),y.jsx(He,{size:"icon",variant:"ghost",className:"h-8 w-8 -mt-1 -ml-2 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>Sa(o),disabled:Ne,children:y.jsx(Is,{className:"h-4 w-4"})})]})]}),y.jsxs("div",{className:"flex items-center gap-2 bg-gray-50/50 dark:bg-gray-800/50 p-2 rounded-lg border border-gray-100 dark:border-gray-700",children:[y.jsxs("div",{className:"relative flex-1",children:[y.jsx(Rt,{type:"number",className:"h-9 w-full bg-white dark:bg-gray-900 text-center border-gray-200 dark:border-gray-700 focus:border-indigo-300 dark:text-gray-100",placeholder:"الكمية",value:Z[o.id]||"",onChange:l=>Ke(h=>({...h,[o.id]:l.target.value}))}),y.jsx("span",{className:"absolute inset-y-0 right-2 flex items-center text-[10px] text-gray-400 pointer-events-none",children:"عدد"})]}),y.jsxs("div",{className:"relative w-28",children:[y.jsx(Rt,{type:"number",className:"h-9 w-full bg-white dark:bg-gray-900 text-center border-gray-200 dark:border-gray-700 focus:border-indigo-300 dark:text-gray-100",placeholder:"سعر مخصص",value:ir[o.id]||"",onChange:l=>Pa(h=>({...h,[o.id]:l.target.value}))}),y.jsx("span",{className:"absolute inset-y-0 right-2 flex items-center text-[10px] text-gray-400 pointer-events-none",children:"سعر"})]})]}),y.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[y.jsxs(He,{className:"h-10 bg-indigo-600 text-white hover:bg-indigo-700 shadow-sm font-bold",onClick:()=>La(o),children:[y.jsx(Ji,{className:"h-4 w-4 ml-2"}),"بيع فوري"]}),y.jsxs(He,{variant:"outline",className:"h-10 border-amber-200 text-amber-700 bg-amber-50 hover:bg-amber-100 dark:bg-amber-950/30 dark:border-amber-900/50 dark:text-amber-400 font-bold",onClick:()=>{Ja(o),ua(!0)},children:[y.jsx(I0,{className:"h-4 w-4 ml-2"}),"بيع أجل"]}),y.jsxs(He,{variant:"outline",className:"h-10 border-indigo-200 text-indigo-700 bg-indigo-50 hover:bg-indigo-100 dark:bg-indigo-950/30 dark:border-indigo-900/50 dark:text-indigo-400 font-bold",onClick:()=>Br(l=>({...l,[o.id]:Number(l[o.id]||0)+1})),title:"إضافة للفاتورة",children:[y.jsx(In,{className:"h-4 w-4 ml-2"}),"إضافة +"]})]}),(br[o.id]||0)>0&&y.jsx("div",{className:"pt-3 border-t border-dashed border-gray-200 dark:border-gray-700",children:y.jsxs("div",{className:"text-xs text-indigo-700 dark:text-indigo-400",children:["مضاف للفاتورة: ",br[o.id]]})})]})},o.id))})]})})]})})}),y.jsx(Wo,{value:"categories",className:"flex-1 p-0 m-0 overflow-hidden h-full relative",children:y.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-thin bg-gray-50/50 dark:bg-gray-950/50",children:y.jsx("div",{className:"p-4",children:Ze?y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"flex flex-col gap-4",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsxs(He,{variant:"ghost",size:"sm",onClick:()=>rr(null),className:"hover:bg-gray-100 dark:hover:bg-gray-800 dark:text-gray-200",children:[y.jsx(Il,{className:"h-4 w-4 ml-1"}),"رجوع"]}),y.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:Ze.name})]}),y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[y.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-border rounded-xl p-3 shadow-sm flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"bg-indigo-50 dark:bg-indigo-950/30 p-2 rounded-lg",children:y.jsx(Al,{className:"h-4 w-4 text-indigo-600 dark:text-indigo-400"})}),y.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:"عدد المنتجات"})]}),y.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:Ae.filter(o=>o.categoryId===Ze.id).length})]}),y.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-border rounded-xl p-3 shadow-sm flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"bg-amber-50 dark:bg-amber-950/30 p-2 rounded-lg",children:y.jsx(Ji,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),y.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:"إجمالي الجملة (لهذا القسم)"})]}),y.jsx("span",{className:"text-lg font-bold text-amber-700 dark:text-amber-400",children:yt(Ae.filter(o=>o.categoryId===Ze.id).reduce((o,l)=>o+(Number(l.wholesalePrice)||0)*(Number(l.quantity)||0),0))})]})]})]}),y.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:Ae.filter(o=>o.categoryId===Ze.id).length===0?y.jsx("div",{className:"col-span-full text-center py-10 text-gray-500 dark:text-gray-400 bg-white dark:bg-card rounded-lg border border-dashed border-gray-300 dark:border-gray-700",children:"لا توجد منتجات في هذا القسم"}):Ae.filter(o=>o.categoryId===Ze.id).map(o=>y.jsx(tn,{className:"overflow-hidden hover:shadow-md transition-all group relative bg-white dark:bg-card border-gray-200 dark:border-gray-700 cursor-pointer",onClick:()=>handleAddProductToInvoice(o),children:y.jsxs("div",{className:"p-3",children:[y.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate text-right",title:o.name,children:o.name}),y.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[y.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400",children:yt(o.sellingPrice)}),y.jsx(Fn,{variant:"outline",className:"text-xs dark:text-gray-300 dark:border-gray-600",children:o.quantity})]})]})},o.id))})]}):y.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[y.jsxs(tn,{className:"border-dashed border-2 border-emerald-200 dark:border-emerald-800/50 hover:border-emerald-400 dark:hover:border-emerald-700 hover:bg-emerald-50/50 dark:hover:bg-emerald-950/20 transition-all cursor-pointer flex flex-col items-center justify-center p-6 h-32 group dark:bg-card/50",onClick:()=>ws(!0),children:[y.jsx("div",{className:"bg-emerald-100 dark:bg-emerald-900/30 p-3 rounded-full mb-2 group-hover:scale-110 transition-transform",children:y.jsx(In,{className:"h-6 w-6 text-emerald-600 dark:text-emerald-400"})}),y.jsx("span",{className:"font-semibold text-emerald-700 dark:text-emerald-400",children:"إضافة قسم جديد"})]}),hi.map(o=>y.jsxs(tn,{className:"overflow-hidden hover:shadow-md transition-all h-32 flex flex-col items-center justify-center relative group bg-white dark:bg-card border-gray-100 dark:border-gray-700 cursor-pointer",onClick:()=>rr(o),children:[y.jsx("div",{className:"absolute top-2 left-2 z-10",children:y.jsx(He,{variant:"ghost",size:"icon",className:"h-6 w-6 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",onClick:l=>ko(o.id,l),title:"حذف القسم",children:y.jsx(Is,{className:"h-4 w-4"})})}),y.jsx("h3",{className:"font-bold text-lg text-gray-800 dark:text-gray-100 text-center px-2",children:o.name}),y.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[Ae.filter(l=>l.categoryId===o.id).length," منتج"]})]},o.id))]})})})}),y.jsx(Wo,{value:"sales-log",className:"flex-1 p-0 m-0 overflow-hidden h-full relative",children:y.jsx("div",{className:"absolute inset-0 overflow-y-auto scrollbar-thin",children:y.jsxs("div",{className:"p-4 space-y-4 min-h-full",children:[y.jsx("div",{className:"md:hidden",children:y.jsxs(He,{variant:"outline",className:"w-full justify-between bg-white dark:bg-card border-dashed border-2 border-gray-200 dark:border-gray-700 h-12 text-gray-700 dark:text-gray-200 hover:text-primary hover:border-primary/50 hover:bg-primary/5 shadow-sm",onClick:()=>Bt(!0),children:[y.jsxs("span",{className:"flex items-center gap-2 font-semibold",children:[y.jsx(Bo,{className:"h-4 w-4 text-primary"}),"تفاصيل اليوم"]}),y.jsx("span",{className:"text-xs text-muted-foreground font-normal bg-gray-50 dark:bg-gray-800 px-2 py-1 rounded-full border dark:border-gray-700",children:"اضغط لعرض التقارير"})]})}),y.jsxs("div",{className:"flex flex-wrap items-end gap-2 bg-white dark:bg-card p-3 rounded-lg border border-gray-100 dark:border-gray-700 shadow-sm",children:[y.jsxs("div",{className:"grid gap-1",children:[y.jsx(Ut,{className:"text-[10px] text-gray-500 dark:text-gray-400",children:"من تاريخ"}),y.jsxs(bl,{children:[y.jsx(Cl,{asChild:!0,children:y.jsxs(He,{variant:"outline",className:ll("h-8 w-[140px] justify-start text-right font-normal text-xs dark:bg-gray-900 dark:border-gray-700 dark:text-gray-200",!J&&"text-muted-foreground"),children:[y.jsx(j0,{className:"ml-2 h-3.5 w-3.5"}),J?L0(new Date(J),"P",{locale:W0}):y.jsx("span",{children:"اختر تاريخ"})]})}),y.jsx(Tl,{className:"w-auto p-0",align:"start",children:y.jsx(Sl,{mode:"single",selected:J?new Date(J):void 0,onSelect:o=>ie(o?L0(o,"yyyy-MM-dd"):""),initialFocus:!0,locale:W0})})]})]}),y.jsxs("div",{className:"grid gap-1",children:[y.jsx(Ut,{className:"text-[10px] text-gray-500 dark:text-gray-400",children:"إلى تاريخ"}),y.jsxs(bl,{children:[y.jsx(Cl,{asChild:!0,children:y.jsxs(He,{variant:"outline",className:ll("h-8 w-[140px] justify-start text-right font-normal text-xs dark:bg-gray-900 dark:border-gray-700 dark:text-gray-200",!Q&&"text-muted-foreground"),children:[y.jsx(j0,{className:"ml-2 h-3.5 w-3.5"}),Q?L0(new Date(Q),"P",{locale:W0}):y.jsx("span",{children:"اختر تاريخ"})]})}),y.jsx(Tl,{className:"w-auto p-0",align:"start",children:y.jsx(Sl,{mode:"single",selected:Q?new Date(Q):void 0,onSelect:o=>M(o?L0(o,"yyyy-MM-dd"):""),initialFocus:!0,locale:W0})})]})]}),y.jsxs(He,{size:"sm",onClick:ne,className:"h-8 gap-1 bg-indigo-600 hover:bg-indigo-700 text-white",children:[y.jsx(Vo,{className:"h-3.5 w-3.5"}),y.jsx("span",{className:"hidden sm:inline",children:"بحث"})]}),(J||Q)&&y.jsx(He,{size:"sm",variant:"ghost",onClick:X,className:"h-8 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/30",children:"إلغاء"})]}),G.length===0?y.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-12 px-4 bg-[#fcf9f2]/50 dark:bg-card/50 rounded-xl border border-dashed border-gray-200 dark:border-gray-700 text-center",children:[y.jsx("div",{className:"bg-[#fcf9f2] dark:bg-gray-800 p-4 rounded-full shadow-sm mb-4",children:y.jsx(Lo,{className:"h-8 w-8 text-gray-400"})}),y.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-1",children:"لا توجد مبيعات"}),y.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:J||Q?"لم يتم العثور على مبيعات في الفترة المحددة.":"لم يتم تسجيل أي عمليات بيع اليوم."})]}):y.jsxs("div",{className:"space-y-4",children:[y.jsx("div",{className:"hidden md:block bg-[#fcf9f2] dark:bg-card rounded-xl border border-gray-100 dark:border-gray-700 shadow-sm overflow-hidden",children:y.jsxs(F0,{children:[y.jsx(D0,{className:"bg-gray-50/80 dark:bg-gray-800",children:y.jsxs(Qn,{className:"hover:bg-transparent",children:[y.jsx(ar,{className:"text-right h-11 font-semibold text-gray-700 dark:text-gray-300",children:"المنتج"}),y.jsx(ar,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"السعر"}),y.jsx(ar,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"الكمية"}),y.jsx(ar,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"الإجمالي"}),y.jsx(ar,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"الربح"}),y.jsx(ar,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"التاريخ"}),y.jsx(ar,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"الوقت"}),y.jsx(ar,{className:"text-center h-11 font-semibold text-gray-700 dark:text-gray-300",children:"إجراءات"})]})}),y.jsx(O0,{children:G.map(o=>y.jsxs(Qn,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 transition-colors dark:border-gray-800",children:[y.jsxs(nr,{className:"py-3",children:[y.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[y.jsx("span",{className:o.cartItems&&o.cartItems.length>0?"cursor-pointer hover:text-indigo-600 dark:hover:text-indigo-400 underline-offset-4 hover:underline":"",onClick:()=>o.cartItems&&o.cartItems.length>0&&le(o),children:o.productName}),o.cartItems&&o.cartItems.length>0&&y.jsx(He,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 rounded-full hover:bg-indigo-100 dark:hover:bg-indigo-950/30 text-indigo-600 dark:text-indigo-400",onClick:()=>le(o),title:"عرض التفاصيل",children:y.jsx(ks,{className:"h-3.5 w-3.5"})})]}),o.isDeferred&&y.jsx(Fn,{variant:"secondary",className:"mt-1 text-[10px] bg-amber-100 dark:bg-amber-950/30 text-amber-700 dark:text-amber-400 border-amber-200 dark:border-amber-900/50",children:"مؤجل"})]}),y.jsx(nr,{className:"text-center py-3 text-gray-700 dark:text-gray-300",children:yt(o.price)}),y.jsx(nr,{className:"text-center py-3",children:y.jsx(Fn,{variant:"outline",className:"font-mono bg-gray-50 dark:bg-gray-900 dark:text-gray-300 dark:border-gray-700",children:o.quantity})}),y.jsx(nr,{className:"text-center font-bold text-green-600 dark:text-green-400 py-3",children:yt(o.price*o.quantity)}),y.jsx(nr,{className:"text-center text-indigo-600 dark:text-indigo-400 py-3",children:y.jsx("span",{className:pa?"":"blur-sm select-none text-gray-300 dark:text-gray-700",children:yt(((o.price??0)-(o.wholesalePrice??0))*o.quantity)})}),y.jsx(nr,{className:"text-center text-gray-500 dark:text-gray-400 text-xs py-3 font-mono",children:to(o.date)}),y.jsx(nr,{className:"text-center text-gray-500 dark:text-gray-400 text-xs py-3 font-mono",children:o.time}),y.jsx(nr,{className:"py-3",children:y.jsxs("div",{className:"flex justify-center gap-2",children:[o.isDeferred&&y.jsx(He,{size:"sm",variant:"outline",className:"h-8 text-xs border-amber-200 text-amber-700 bg-amber-50 hover:bg-amber-100 dark:bg-amber-950/30 dark:border-amber-900/50 dark:text-amber-400",onClick:()=>Wt("تأكيد سداد بيع مؤجل","أدخل الرقم السري الرئيسي لتأكيد السداد",()=>wi(o)),children:"سداد"}),y.jsx(He,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>un(o,"return"),title:"مرتجع",children:y.jsx(U0,{className:"h-4 w-4"})}),y.jsx(He,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>un(o,"delete"),title:"حذف نهائي",children:y.jsx(Bu,{className:"h-4 w-4"})})]})})]},o.id))})]})}),y.jsx("div",{className:"md:hidden space-y-3",children:G.map(o=>y.jsx(tn,{className:"overflow-hidden border-gray-100 dark:border-gray-700 shadow-sm bg-[#fcf9f2] dark:bg-card",children:y.jsxs(k0,{className:"p-4",children:[y.jsxs("div",{className:"flex justify-between items-start mb-3",children:[y.jsxs("div",{children:[y.jsxs("h4",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm flex items-center gap-2",children:[y.jsx("span",{className:o.cartItems&&o.cartItems.length>0?"cursor-pointer hover:text-indigo-600 dark:hover:text-indigo-400 underline-offset-4 hover:underline":"",onClick:()=>o.cartItems&&o.cartItems.length>0&&le(o),children:o.productName}),o.cartItems&&o.cartItems.length>0&&y.jsx(He,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 rounded-full hover:bg-indigo-100 dark:hover:bg-indigo-950/30 text-indigo-600 dark:text-indigo-400",onClick:()=>le(o),children:y.jsx(ks,{className:"h-3.5 w-3.5"})})]}),y.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 flex items-center gap-2",children:[y.jsx("span",{className:"bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded text-gray-600 dark:text-gray-300 font-mono",children:o.time}),y.jsx("span",{className:"text-gray-400 dark:text-gray-600",children:"|"}),y.jsx("span",{children:to(o.date)}),o.isDeferred&&y.jsx(Fn,{variant:"outline",className:"text-[10px] bg-amber-50 dark:bg-amber-950/30 text-amber-700 dark:text-amber-400 border-amber-100 dark:border-amber-900/50 px-1.5 py-0 h-5",children:"مؤجل"})]})]}),y.jsxs("div",{className:"text-left",children:[y.jsx("div",{className:"font-bold text-green-600 dark:text-green-400 text-sm",children:yt(o.price*o.quantity)}),y.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-0.5",children:[o.quantity," × ",yt(o.price)]})]})]}),y.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-50 dark:border-gray-800",children:[o.isDeferred&&y.jsx(He,{size:"sm",variant:"ghost",className:"h-8 text-xs text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-950/30 hover:bg-amber-100 dark:hover:bg-amber-900/50",onClick:()=>Wt("تأكيد سداد بيع مؤجل","أدخل الرقم السري الرئيسي لتأكيد السداد",()=>wi(o)),children:"تسديد"}),y.jsxs(He,{size:"sm",variant:"ghost",className:"h-8 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-950/30",onClick:()=>un(o,"return"),children:[y.jsx(U0,{className:"h-3.5 w-3.5 ml-1.5"}),"مرتجع"]}),y.jsx(He,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-gray-400 dark:text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-full",onClick:()=>un(o,"delete"),children:y.jsx(Is,{className:"h-4 w-4"})})]})]})},o.id))})]})]})})})]})})]})]}),y.jsx(He,{variant:"ghost",size:"icon",className:"fixed bottom-6 right-6 h-14 w-14 rounded-full bg-red-600 text-white shadow-lg hover:bg-red-700 hover:scale-105 transition-all duration-300 z-[60] animate-in fade-in zoom-in",onClick:o=>{o.preventDefault(),o.stopPropagation(),r()},children:y.jsx(Il,{className:"h-6 w-6"})})]}),y.jsx(Qa,{open:Zt,onOpenChange:zr,children:y.jsxs($a,{className:"sm:max-w-md",dir:"rtl",children:[y.jsxs(qn,{children:[y.jsxs(en,{className:"flex items-center gap-2",children:[y.jsx(Rl,{className:"h-5 w-5 text-primary"}),"عربة المبيعات"]}),y.jsx(Zn,{className:"text-xs",children:"راجع المنتجات المختارة، عدّل اسم المحل، ثم بع أو اطبع الفاتورة"})]}),y.jsxs("div",{className:"space-y-3",children:[y.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-3 rounded-lg space-y-2 border border-dashed border-gray-200 dark:border-gray-700",children:[y.jsx(Ut,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"بيانات الفاتورة (اختياري)"}),y.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[y.jsx(Rt,{value:xr,onChange:o=>cn(o.target.value),placeholder:(B==null?void 0:B.shopName)||(N==null?void 0:N.displayName)||"اسم المحل",className:"h-8 text-xs bg-white dark:bg-gray-900"}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsx(Rt,{value:Jt,onChange:o=>zt(o.target.value),placeholder:(B==null?void 0:B.phone)||"رقم التليفون",className:"h-8 text-xs bg-white dark:bg-gray-900"}),y.jsx(Rt,{value:lt,onChange:o=>Yt(o.target.value),placeholder:(B==null?void 0:B.address)||"العنوان",className:"h-8 text-xs bg-white dark:bg-gray-900"})]})]})]}),y.jsx(M0,{}),y.jsxs("div",{className:"space-y-2 relative",children:[y.jsx(Ut,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"إضافة منتج للفاتورة"}),y.jsxs("div",{className:"flex gap-2 relative",children:[y.jsxs("div",{className:"relative flex-1",children:[y.jsx(Vo,{className:"absolute right-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400"}),y.jsx(Rt,{value:De,onChange:o=>tr(o.target.value),onKeyDown:o=>{o.key==="Enter"&&b0(De)},placeholder:"بحث بالاسم أو الباركود...",className:"h-9 pr-8 text-xs",autoComplete:"off"})]}),y.jsx(He,{size:"icon",variant:"outline",className:"h-9 w-9 shrink-0",onClick:()=>{kr?Gn():Hn()},title:kr?"إغلاق الكاميرا":"فتح الكاميرا",children:kr?y.jsx(Ns,{className:"h-4 w-4 text-red-500"}):y.jsx(Rs,{className:"h-4 w-4"})})]}),kr&&y.jsxs("div",{className:"relative bg-black rounded-lg overflow-hidden border border-gray-200 shadow-sm mt-2",children:[y.jsx("div",{id:"cart-scanner-container",className:"w-full h-[200px]"}),y.jsx(He,{size:"sm",variant:"ghost",className:"absolute top-2 right-2 text-white bg-black/50 hover:bg-black/70 h-6 w-6 p-0 rounded-full",onClick:Gn,children:y.jsx(Ns,{className:"h-3 w-3"})})]}),De&&De.length>1&&!kr&&y.jsxs("div",{className:"border rounded-md max-h-40 overflow-y-auto bg-white dark:bg-gray-800 shadow-lg absolute z-50 w-full top-full mt-1",children:[Ae.filter(o=>{var l;return o.name.toLowerCase().includes(De.toLowerCase())||((l=o.barcode)==null?void 0:l.includes(De))}).slice(0,10).map(o=>y.jsxs("div",{className:"p-2 text-xs border-b last:border-0 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer flex justify-between items-center",onClick:()=>{Br(l=>({...l,[o.id]:Number(l[o.id]||0)+1})),tr(""),z({title:"تمت الإضافة",description:`تم إضافة ${o.name}`})},children:[y.jsx("span",{className:"font-medium",children:o.name}),y.jsx("span",{className:"text-emerald-600",children:yt(o.sellingPrice)})]},o.id)),Ae.filter(o=>{var l;return o.name.toLowerCase().includes(De.toLowerCase())||((l=o.barcode)==null?void 0:l.includes(De))}).length===0&&y.jsx("div",{className:"p-2 text-xs text-center text-gray-500",children:"لا توجد نتائج"})]})]}),y.jsxs("div",{className:"text-xs text-gray-500",children:["التاريخ والوقت: ",new Date().toLocaleString("ar-EG")]}),y.jsx(M0,{}),y.jsxs("div",{className:"space-y-2 max-h-64 overflow-auto",children:[Object.entries(br).filter(([o,l])=>Number(l)>0).map(([o,l])=>{const h=Ae.find(w=>w.id===o),d=Number(l);if(!h||!d)return null;const g=d*h.sellingPrice;return y.jsxs("div",{className:"flex items-center justify-between gap-2",children:[y.jsxs("div",{className:"flex-1",children:[y.jsx("div",{className:"font-medium text-gray-900 text-sm",children:h.name}),y.jsxs("div",{className:"text-xs text-gray-500",children:["سعر: ",yt(h.sellingPrice)]})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx(He,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:()=>Br(w=>({...w,[o]:Math.max(0,Number(w[o]||0)-1)})),children:"-"}),y.jsx(Fn,{variant:"outline",className:"font-mono bg-indigo-50 text-indigo-700 border-indigo-200",children:d}),y.jsx(He,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:()=>Br(w=>({...w,[o]:Number(w[o]||0)+1})),children:"+"})]}),y.jsx("div",{className:"w-24 text-left font-semibold text-emerald-700",children:yt(g)})]},o)}),Object.entries(br).filter(([o,l])=>Number(l)>0).length===0&&y.jsx("div",{className:"text-center text-sm text-gray-500",children:"لا توجد منتجات مضافة. استخدم زر + بجوار المنتجات."})]}),y.jsx(M0,{}),y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("span",{className:"font-bold",children:"الإجمالي:"}),y.jsx("span",{className:"font-bold text-emerald-700",children:yt(Object.entries(br).reduce((o,[l,h])=>{const d=Ae.find(w=>w.id===l),g=Number(h)||0;return o+(d?g*d.sellingPrice:0)},0))})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsx(He,{className:"bg-indigo-600 text-white hover:bg-indigo-700",onClick:async()=>{const o=Object.entries(br).filter(([h,d])=>Number(d)>0);if(o.length===0){z({title:"لا توجد منتجات",description:"أضف منتجات للعربة أولاً"});return}const l=[];for(const[h,d]of o){const g=Ae.find(_=>_.id===h),w=Number(d);if(!(!g||!w)){if(w>g.quantity){z({title:"كمية غير كافية",description:`الكمية المطلوبة للمنتج ${g.name} غير متوفرة (المتاح: ${g.quantity})`,variant:"destructive"});return}l.push({prod:g,qty:w})}}zr(!1),Br({}),z({title:"جاري التنفيذ",description:"يتم الآن معالجة عملية البيع..."});try{const h=new Date,d=sr(),g=Ne&&we?"cashier":"admin",w=g==="cashier"?(we==null?void 0:we.name)||"كاشير":(B==null?void 0:B.fullName)||(N==null?void 0:N.displayName)||"الحساب الرئيسي",_=g==="cashier"&&(we==null?void 0:we.username)||null,C=N!=null&&N.uid?`CART-${N.uid}-${Date.now()}`:void 0;if(l.length>0){let T=0,R=0;const L=[],W=[];for(const{prod:ce,qty:Ve}of l){T+=ce.sellingPrice*Ve,R+=(ce.wholesalePrice||0)*Ve;const ze=ce.quantity-Ve;L.push({id:ce.id,qty:ze}),W.push({productId:ce.id,productName:ce.name,quantity:Ve,price:ce.sellingPrice,wholesalePrice:ce.wholesalePrice,barcode:ce.barcode})}const te={id:Date.now().toString(),productName:`فاتورة مجمعة (${l.length} منتج)`,price:T,wholesalePrice:R,quantity:1,date:d,time:h.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),createdAtMs:h.getTime(),performedByType:g,performedByName:w,performedByUsername:_,isDeferred:!1,transactionReference:C,cartItems:W},se=await hr(te),Ce=se?{...te,firestoreId:se}:te;for(const{prod:ce,qty:Ve}of l){const ze=ce.quantity-Ve;await ya(Lr(st,"products",ce.id),{quantity:ze,updatedAt:qr()}),ze===0&&jt(ce.name)}if(N!=null&&N.uid&&C){const ce={txnType:"sales",type:"sales",amount:T,status:"confirmed",senderMsisdn:"مبيعات",receiverMsisdn:"",reference:C,title:"فاتورة مبيعات مجمعة",merchantUserId:N.uid,createdBy:N.uid,shopId:(B==null?void 0:B.shopId)||ve||void 0,cashierName:w,performedByType:g,performedByUsername:_,saleProductName:`فاتورة مجمعة (${l.length} منتج)`,saleQuantity:1,createdAt:new Date};await xn.saveUserTransaction(N.uid,ce)}Xe(ce=>ce.map(Ve=>{const ze=L.find(kt=>kt.id===Ve.id);return ze?{...Ve,quantity:ze.qty}:Ve})),D(ce=>{const Ve=[Ce,...ce],ze=ve||(B==null?void 0:B.shopId)||"main",kt=sr(),Ot=`salesData_${N==null?void 0:N.uid}_${ze}_${kt}`,It=`salesData_all_${N==null?void 0:N.uid}_${ze}`;localStorage.setItem(Ot,JSON.stringify(Ve));try{const bt=localStorage.getItem(It),er=bt?JSON.parse(bt):[],Or=[Ce,...Array.isArray(er)?er:[]];localStorage.setItem(It,JSON.stringify(Or))}catch(bt){console.warn("Failed to update all sales storage:",bt)}return Ve}),Re(ce=>ce+T);const Te=T-R;et(ce=>ce+Te),zn(ce=>ce+Te),z({title:"تم البيع بنجاح",description:"تم حفظ الفاتورة المجمعة وخصم الكميات"});try{const ce=Wn(),Ve=localStorage.getItem(ce),kt=(Ve?parseFloat(Ve):0)+T;if(localStorage.setItem(ce,kt.toString()),N!=null&&N.uid){const Ot={cashBalance:kt,lastUpdated:new Date().toISOString()};await xn.updateUserData(N.uid,Ot);const It=(B==null?void 0:B.shopId)||ve;It&&await ya(Lr(st,"dashboardData",It),{cashBalance:kt})}window.dispatchEvent(new CustomEvent("cashBalanceChanged",{detail:{value:kt}}))}catch(ce){console.warn("Error updating cash balance batch:",ce)}z({title:"تم البيع بنجاح",description:`تم بيع الفاتورة بإجمالي ${yt(T)}`})}}catch(h){console.error("Batch sell error:",h),z({title:"خطأ",description:"حدث خطأ أثناء معالجة البيع",variant:"destructive"})}},children:"بيع"}),y.jsx(He,{variant:"outline",onClick:()=>Po(),className:"border-indigo-200 text-indigo-700 hover:bg-indigo-50",children:"طباعة فاتورة"})]})]})}),y.jsx(Qa,{open:xi,onOpenChange:ua,children:y.jsxs($a,{className:"max-w-sm mx-auto bg-white dark:bg-card border border-gray-100 dark:border-border shadow-xl rounded-2xl sm:max-w-md p-6 gap-5",children:[y.jsxs(qn,{className:"text-center space-y-2",children:[y.jsx("div",{className:"mx-auto bg-amber-100 dark:bg-amber-900/30 p-3 rounded-full w-fit",children:y.jsx(I0,{className:"h-6 w-6 text-amber-600 dark:text-amber-500"})}),y.jsx(en,{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"تسجيل بيع أجل"}),y.jsx(Zn,{className:"text-gray-500 dark:text-gray-400 text-sm",children:"أدخل بيانات العميل لتسجيل عملية البيع الآجل"})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[y.jsx(Ut,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"اختيار عميل (اختياري)"}),y.jsxs("div",{className:"relative",children:[y.jsxs("select",{className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background dark:bg-gray-900 px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 appearance-none dark:text-gray-100",value:rt,onChange:o=>{const l=o.target.value;Io(l);const h=ha.find(d=>d.id===l);h&&(Dr(h.name),ji(h.mobile||""))},children:[y.jsx("option",{value:"",children:"-- اختر عميل مسجل --"}),ha.map(o=>y.jsxs("option",{value:o.id,children:[o.name,o.mobile?` - ${o.mobile}`:""]},o.id))]}),y.jsx(P0,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]})]}),y.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[y.jsxs(Ut,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["اسم العميل ",y.jsx("span",{className:"text-red-500",children:"*"})]}),y.jsx(Rt,{value:dt,onChange:o=>Dr(o.target.value),placeholder:"أدخل اسم العميل...",className:"h-10 dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100"})]}),y.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[y.jsx(Ut,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"رقم التليفون (اختياري)"}),y.jsx(Rt,{value:p0,onChange:o=>ji(o.target.value),placeholder:"أدخل رقم التليفون...",className:"h-10 dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100"})]})]}),y.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[y.jsx(He,{variant:"outline",className:"flex-1 h-10 border-gray-200 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",onClick:()=>ua(!1),children:"إلغاء"}),y.jsx(He,{className:"flex-1 h-10 bg-amber-600 hover:bg-amber-700 text-white shadow-sm",onClick:async()=>{try{const o=w0;if(!o){ua(!1);return}const l=dt.trim(),h=p0.trim()||void 0,d=rt||void 0;if(!l){z({title:"بيانات مطلوبة",description:"أدخل اسم العميل",variant:"destructive"});return}await La(o,!0,{id:d,name:l,mobile:h});try{if(N!=null&&N.uid){const g=o.sellingPrice*(parseInt(Z[o.id]||"0")||0),w=await xn.getUserData(N.uid),_=Array.isArray(w==null?void 0:w.debts)?w.debts:[],C={id:Date.now().toString(),debtorName:l,customerId:d||null,mobile:h||null,amount:g,reason:`بيع أجل للمنتج ${o.name}`,status:"pending",createdAt:new Date,partialPayments:[]},T=[C,..._];xn.updateUserData(N.uid,{debts:T}).catch(()=>{});try{const R=ve||(B==null?void 0:B.shopId)||"main";localStorage.setItem(`debts_${N.uid}_${R}`,JSON.stringify(T)),localStorage.setItem(`debts_default_${R}`,JSON.stringify(T)),localStorage.setItem(`debts_last_write_${N.uid}_${R}`,Date.now().toString())}catch{}try{window.dispatchEvent(new CustomEvent("debtsUpdated",{detail:{count:T.length}}))}catch{}try{Au.send(N.uid,`تم إضافة دين على ${C.debtorName} بمبلغ ${C.amount} جنيه`).catch(()=>{})}catch{}}}catch{}ua(!1),Ja(null)}catch{}},children:"تأكيد البيع"})]})]})}),y.jsx(Qa,{open:fa,onOpenChange:fi,children:y.jsxs($a,{className:"sm:max-w-4xl max-h-[85vh] flex flex-col p-0 overflow-hidden gap-0 bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",children:[y.jsxs("div",{className:"p-4 border-b dark:border-gray-800 flex items-center justify-between bg-gray-50/50 dark:bg-gray-800/50",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"bg-white dark:bg-gray-700 p-2 rounded-full border dark:border-gray-600 shadow-sm",children:y.jsx(Lo,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),y.jsxs("div",{children:[y.jsx(en,{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:"سجل الإيصالات"}),y.jsx(Zn,{className:"text-xs text-gray-500 dark:text-gray-400",children:"عرض تفاصيل عمليات البيع الفورية"})]})]}),y.jsx(He,{variant:"ghost",size:"icon",onClick:()=>fi(!1),className:"rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800",children:y.jsx(Ns,{className:"h-5 w-5"})})]}),y.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:G.filter(o=>!o.isDeferred).length===0?y.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[y.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-full mb-3",children:y.jsx(Lo,{className:"h-8 w-8 text-gray-300 dark:text-gray-600"})}),y.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"لا توجد إيصالات بيع حتى الآن"})]}):y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"hidden md:block border dark:border-gray-800 rounded-xl overflow-hidden shadow-sm",children:y.jsxs(F0,{children:[y.jsx(D0,{className:"bg-gray-50/80 dark:bg-gray-800",children:y.jsxs(Qn,{className:"hover:bg-transparent dark:border-gray-800",children:[y.jsx(ar,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"المنتج"}),y.jsx(ar,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"سعر البيع"}),y.jsx(ar,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"سعر الجملة"}),y.jsx(ar,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"الكمية"}),y.jsx(ar,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"الإجمالي"}),y.jsx(ar,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"الربح"}),y.jsx(ar,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"التاريخ"}),y.jsx(ar,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"الوقت"}),y.jsx(ar,{className:"text-right h-10 font-semibold text-gray-700 dark:text-gray-300",children:"المنفذ"})]})}),y.jsx(O0,{children:G.filter(o=>!o.isDeferred).map(o=>y.jsxs(Qn,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 dark:border-gray-800",children:[y.jsx(nr,{className:"font-medium text-gray-900 dark:text-gray-100 py-3",children:o.productName}),y.jsx(nr,{className:"text-gray-700 dark:text-gray-300 py-3",children:yt(o.price)}),y.jsx(nr,{className:"text-gray-700 dark:text-gray-300 py-3",children:yt(o.wholesalePrice??0)}),y.jsx(nr,{className:"text-gray-700 dark:text-gray-300 py-3 font-mono",children:t1(o.quantity)}),y.jsx(nr,{className:"text-gray-700 dark:text-gray-300 py-3 font-bold text-emerald-600 dark:text-emerald-400",children:yt((o.price??0)*(o.quantity??0))}),y.jsx(nr,{className:"text-gray-700 dark:text-gray-300 py-3 text-indigo-600 dark:text-indigo-400",children:yt(((o.price??0)-(o.wholesalePrice??0))*(o.quantity??0))}),y.jsx(nr,{className:"text-gray-500 dark:text-gray-400 py-3 text-xs",children:to(o.date)}),y.jsx(nr,{className:"text-gray-500 dark:text-gray-400 py-3 text-xs font-mono",children:o.time}),y.jsx(nr,{className:"text-gray-700 dark:text-gray-300 py-3 text-xs",children:o.executedBy||"-"})]},o.id))})]})}),y.jsx("div",{className:"md:hidden space-y-3",children:G.filter(o=>!o.isDeferred).map(o=>y.jsx(tn,{className:"overflow-hidden border-gray-100 dark:border-gray-800 shadow-sm bg-white dark:bg-card",children:y.jsxs(k0,{className:"p-4 space-y-3",children:[y.jsxs("div",{className:"flex justify-between items-start",children:[y.jsxs("div",{children:[y.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:o.productName}),y.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 flex items-center gap-2",children:[y.jsx("span",{className:"bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded text-gray-600 dark:text-gray-300 font-mono",children:o.time}),y.jsx("span",{className:"text-gray-400",children:"|"}),y.jsx("span",{children:to(o.date)})]})]}),y.jsxs("div",{className:"text-left",children:[y.jsx("div",{className:"font-bold text-emerald-600 dark:text-emerald-400 text-sm",children:yt((o.price??0)*(o.quantity??0))}),y.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:[o.quantity," × ",yt(o.price)]})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-3 border-t border-dashed border-gray-100 dark:border-gray-800 text-xs",children:[y.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-2 rounded flex flex-col items-center justify-center",children:[y.jsx("span",{className:"text-gray-400 mb-1",children:"الربح"}),y.jsx("span",{className:"font-bold text-indigo-600 dark:text-indigo-400",children:yt(((o.price??0)-(o.wholesalePrice??0))*(o.quantity??0))})]}),y.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-2 rounded flex flex-col items-center justify-center",children:[y.jsx("span",{className:"text-gray-400 mb-1",children:"المنفذ"}),y.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300 truncate max-w-full px-1",children:o.executedBy||"-"})]})]})]})},o.id))})]})}),y.jsx("div",{className:"p-4 border-t dark:border-border bg-gray-50/30 dark:bg-gray-900/30 flex justify-end",children:y.jsx(He,{variant:"outline",onClick:()=>fi(!1),className:"px-6 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",children:"إغلاق"})})]})}),y.jsx(Qa,{open:Fo,onOpenChange:hn,children:y.jsxs($a,{className:"max-w-sm mx-auto bg-white border border-gray-100 shadow-xl rounded-2xl sm:max-w-md p-6 gap-6",children:[y.jsxs("div",{className:"flex flex-col items-center text-center gap-2",children:[y.jsx("div",{className:`p-3 rounded-full ${Cn==="return"?"bg-amber-100 text-amber-600":"bg-red-100 text-red-600"}`,children:Cn==="return"?y.jsx(U0,{className:"h-6 w-6"}):y.jsx(Is,{className:"h-6 w-6"})}),y.jsx(en,{className:"text-xl font-bold text-gray-900 mt-2",children:Cn==="return"?"تأكيد المرتجع":"تأكيد الحذف"}),y.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[y.jsxs("p",{children:["هل أنت متأكد من ",Cn==="return"?"إرجاع":"حذف"," المنتج",y.jsx("span",{className:"font-bold text-gray-900 mx-1",children:Ca==null?void 0:Ca.productName}),"بكمية",y.jsx("span",{className:"font-bold text-gray-900 mx-1 font-mono",children:t1((Ca==null?void 0:Ca.quantity)||0)}),"؟"]}),y.jsx("p",{className:"text-xs text-gray-400",children:"سيتم تحديث المخزون والرصيد تلقائياً."})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsx(He,{variant:"outline",className:"h-10 border-gray-200",onClick:()=>hn(!1),children:"إلغاء"}),y.jsx(He,{className:`h-10 ${Cn==="return"?"bg-amber-600 hover:bg-amber-700":"bg-red-600 hover:bg-red-700"} text-white shadow-sm`,onClick:()=>{const o=Ca;hn(!1),o&&Vn(o)},children:Cn==="return"?"تأكيد المرتجع":"تأكيد الحذف"})]})]})}),y.jsx(Qa,{open:x,onOpenChange:p,children:y.jsxs($a,{className:"sm:max-w-md bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",dir:"rtl",children:[y.jsxs(qn,{children:[y.jsxs(en,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[y.jsx(Bo,{className:"h-5 w-5 text-primary"}),"تقارير يومية"]}),y.jsx(Zn,{className:"text-gray-500 dark:text-gray-400",children:"اختر تاريخاً لعرض تفاصيل العمليات لذلك اليوم"})]}),y.jsxs("div",{className:"space-y-4 py-4",children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx(Ut,{className:"text-gray-700 dark:text-gray-300",children:"اختر التاريخ"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx(Rt,{type:"date",value:E,onChange:o=>b(o.target.value),className:"flex-1 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100"}),y.jsx(He,{onClick:()=>V(E),disabled:!E||A,className:"bg-indigo-600 hover:bg-indigo-700 text-white",children:A?y.jsx(Nl,{className:"h-4 w-4 animate-spin"}):"عرض التقرير"})]})]}),S&&y.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-4 border-t border-gray-100 dark:border-gray-800",children:[y.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg text-center border border-blue-100 dark:border-blue-800/50",children:[y.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 block mb-1",children:"عدد المعاملات"}),y.jsx("span",{className:"font-bold text-blue-700 dark:text-blue-300 text-lg",children:S.count})]}),y.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 p-3 rounded-lg text-center border border-emerald-100 dark:border-emerald-800/50",children:[y.jsx("span",{className:"text-xs text-emerald-600 dark:text-emerald-400 block mb-1",children:"إجمالي المسحوب"}),y.jsx("span",{className:"font-bold text-emerald-700 dark:text-emerald-300 text-lg",children:yt(S.sales)})]}),y.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-3 rounded-lg text-center border border-amber-100 dark:border-amber-800/50",children:[y.jsx("span",{className:"text-xs text-amber-600 dark:text-amber-400 block mb-1",children:"إجمالي المرسل"}),y.jsx("span",{className:"font-bold text-amber-700 dark:text-amber-300 text-lg",children:yt(S.cost)})]}),y.jsxs("div",{className:"bg-pink-50 dark:bg-pink-900/20 p-3 rounded-lg text-center border border-pink-100 dark:border-pink-800/50",children:[y.jsx("span",{className:"text-xs text-pink-600 dark:text-pink-400 block mb-1",children:"الأرباح"}),y.jsx("span",{className:"font-bold text-pink-700 dark:text-pink-300 text-lg",children:yt(S.profit)})]})]})]})]})}),y.jsx(jo,{open:de,onOpenChange:xe,mode:"verify",title:"قفل إجمالي الأرباح",description:"أدخل الرقم السري الرئيسي لعرض إجمالي الأرباح",onSuccess:()=>{oe(!1),xe(!1)}}),y.jsx(jo,{open:ht,onOpenChange:Kr,mode:"verify",title:"قفل إحصائيات الشهر",description:"لا يمكن الاطلاع على تقارير الشهر إلا بإدخال الرقم السري الرئيسي",onSuccess:async()=>{try{const o=N==null?void 0:N.uid;if(o){const l=await bu(o),h=(l==null?void 0:l.planType)??(l==null?void 0:l.plan)??null,d=typeof h=="string"?h.toLowerCase():null;if(h===Cu.ZERO||d==="zero"){z({title:"الخطة زيرو",description:"التقارير الشهرية غير متاحة في خطة زيرو. قم بالترقية للوصول إلى التقارير.",variant:"destructive"});return}}}catch{}mt(!1),Kr(!1),Tn()}}),y.jsx(jo,{open:ps,onOpenChange:fn,mode:"verify",title:Kt,description:fe,onSuccess:()=>{const o=qe.current;qe.current=null,fn(!1),o&&setTimeout(()=>{o()},100)}}),y.jsx(Qa,{open:Do,onOpenChange:Vi,children:y.jsxs($a,{className:"sm:max-w-[400px]",children:[y.jsxs(qn,{children:[y.jsx(en,{className:"text-center",children:"إضافة مخزون"}),y.jsxs(Zn,{className:"text-center",children:["إضافة كمية للمنتج: ",y.jsx("span",{className:"font-bold text-black",children:Tt==null?void 0:Tt.name})]})]}),y.jsx("div",{className:"py-6 flex flex-col items-center gap-4",children:y.jsxs("div",{className:"flex items-center gap-4 w-full justify-center",children:[y.jsx(He,{variant:"outline",size:"icon",onClick:()=>Ta(o=>String(Math.max(1,parseInt(o||"0")-1))),children:y.jsx(U0,{className:"h-4 w-4"})}),y.jsx(Rt,{id:"qty",type:"number",value:pi,onChange:o=>Ta(o.target.value),className:"w-32 text-center text-2xl font-bold h-12",autoFocus:!0,onKeyDown:o=>{o.key==="Enter"&&ge()}}),y.jsx(He,{variant:"outline",size:"icon",onClick:()=>Ta(o=>String(parseInt(o||"0")+1)),children:y.jsx(Tu,{className:"h-4 w-4"})})]})}),y.jsxs(Fs,{className:"flex gap-2 sm:justify-center",children:[y.jsx(He,{variant:"outline",onClick:()=>Vi(!1),className:"flex-1",children:"إلغاء"}),y.jsx(He,{onClick:ge,className:"flex-1 bg-emerald-600 hover:bg-emerald-700",children:"تأكيد الإضافة"})]})]})}),y.jsx(Qa,{open:St,onOpenChange:ue,children:y.jsxs($a,{className:"sm:max-w-[500px] bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",dir:"rtl",children:[y.jsxs(qn,{children:[y.jsx(en,{className:"text-center text-gray-900 dark:text-gray-100",children:"تعديل المنتج"}),y.jsx(Zn,{className:"text-center text-gray-500 dark:text-gray-400",children:"عدّل بيانات المنتج ثم اضغط حفظ"})]}),y.jsxs("div",{className:"grid gap-4 py-4",children:[y.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[y.jsx(Ut,{htmlFor:"ep_name",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"المنتج"}),y.jsx(Rt,{id:"ep_name",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:K.productName,onChange:o=>ae(l=>({...l,productName:o.target.value}))})]}),y.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[y.jsx(Ut,{htmlFor:"ep_price",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"سعر البيع"}),y.jsx(Rt,{id:"ep_price",type:"number",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:K.price,onChange:o=>ae(l=>({...l,price:o.target.value}))})]}),y.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[y.jsx(Ut,{htmlFor:"ep_wholesale",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"سعر الجملة"}),y.jsx(Rt,{id:"ep_wholesale",type:"number",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:K.wholesalePrice??"",onChange:o=>ae(l=>({...l,wholesalePrice:o.target.value}))})]}),y.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[y.jsx(Ut,{htmlFor:"ep_qty",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"الكمية"}),y.jsx(Rt,{id:"ep_qty",type:"number",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:K.quantity,onChange:o=>ae(l=>({...l,quantity:o.target.value}))})]}),y.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[y.jsx(Ut,{htmlFor:"ep_barcode",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"باركود"}),y.jsx(Rt,{id:"ep_barcode",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:K.barcode??"",onChange:o=>ae(l=>({...l,barcode:o.target.value}))})]}),y.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[y.jsx(Ut,{htmlFor:"ep_serial",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"سيريال"}),y.jsx(Rt,{id:"ep_serial",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:K.serialNumber??"",onChange:o=>ae(l=>({...l,serialNumber:o.target.value}))})]}),y.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[y.jsx(Ut,{htmlFor:"ep_category",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"القسم"}),y.jsx("div",{className:"col-span-3",children:y.jsxs(hl,{value:K.categoryId||"none",onValueChange:o=>ae(l=>({...l,categoryId:o==="none"?void 0:o})),children:[y.jsx(ul,{id:"ep_category",className:"bg-white dark:bg-gray-800 text-right dark:text-gray-100 border-gray-200 dark:border-gray-700",dir:"rtl",children:y.jsx(dl,{placeholder:"اختر القسم"})}),y.jsxs(xl,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[y.jsx(B0,{value:"none",className:"dark:text-gray-100 dark:focus:bg-gray-700",children:"بدون قسم"}),hi.map(o=>y.jsx(B0,{value:o.id,className:"dark:text-gray-100 dark:focus:bg-gray-700",children:o.name},o.id))]})]})})]}),y.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[y.jsx(Ut,{htmlFor:"ep_supplier",className:"text-right col-span-1 text-gray-700 dark:text-gray-300",children:"المورد"}),y.jsx(Rt,{id:"ep_supplier",className:"col-span-3 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",value:K.supplierName??"",onChange:o=>ae(l=>({...l,supplierName:o.target.value})),placeholder:"اسم المورد (اختياري)"})]})]}),y.jsxs(Fs,{className:"flex gap-2 sm:justify-center",children:[y.jsx(He,{variant:"outline",onClick:()=>{ue(!1),Qe(null)},className:"flex-1 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800",children:"إلغاء"}),y.jsx(He,{onClick:A0,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white shadow-sm dark:shadow-none",disabled:Ne,children:"حفظ"})]})]})}),y.jsx(Qa,{open:Ee,onOpenChange:Bt,children:y.jsxs($a,{className:"sm:max-w-md",dir:"rtl",children:[y.jsx(qn,{children:y.jsx(en,{children:"تقرير اليوم والشهر"})}),y.jsxs("div",{className:"space-y-4 py-4",children:[y.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[y.jsxs("div",{className:"flex items-center justify-between mb-3",children:[y.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[y.jsx(Ji,{className:"h-4 w-4 text-primary"}),"ملخص اليوم"]}),y.jsx(He,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-red-600",onClick:i,title:"تصفير اليوم",children:y.jsx(Ol,{className:"h-3.5 w-3.5"})})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{className:"text-center p-2 bg-white rounded border",children:[y.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"المبيعات"}),y.jsx("div",{className:"font-bold text-primary",children:yt(Math.max(0,G.filter(o=>!o.isDeferred).reduce((o,l)=>o+l.price*l.quantity,0)-Xn))})]}),y.jsxs("div",{className:"text-center p-2 bg-white rounded border relative overflow-hidden",children:[y.jsx("div",{className:"text-xs text-emerald-700 mb-1",children:"الأرباح"}),y.jsx("div",{className:`font-bold text-emerald-700 ${ye?"blur-sm":""}`,children:yt(T0)}),ye&&y.jsxs("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50",children:[y.jsx(He,{size:"sm",variant:"ghost",onClick:()=>{Bt(!1),xe(!0)},className:"h-full w-full opacity-0 absolute inset-0"}),y.jsx(cl,{className:"h-3 w-3 text-muted-foreground"})]})]})]})]}),y.jsxs("div",{className:"bg-indigo-50/50 p-4 rounded-lg border border-indigo-100",children:[y.jsx("div",{className:"flex items-center justify-between mb-3",children:y.jsxs("h3",{className:"font-semibold flex items-center gap-2 text-indigo-900",children:[y.jsx(j0,{className:"h-4 w-4 text-indigo-600"}),"ملخص الشهر"]})}),y.jsxs("div",{className:"grid grid-cols-2 gap-4 relative",children:[y.jsxs("div",{className:`text-center p-2 bg-white rounded border border-indigo-100 ${ea?"blur-sm":""}`,children:[y.jsx("div",{className:"text-xs text-indigo-600 mb-1",children:"المبيعات"}),y.jsx("div",{className:"font-bold text-indigo-700",children:yt(Math.max(0,Ie-da))})]}),y.jsxs("div",{className:`text-center p-2 bg-white rounded border border-indigo-100 ${ea?"blur-sm":""}`,children:[y.jsx("div",{className:"text-xs text-pink-600 mb-1",children:"الأرباح"}),y.jsx("div",{className:"font-bold text-pink-700",children:yt(Math.max(0,Be-Na))})]}),ea&&y.jsx("div",{className:"absolute inset-0 z-10 pointer-events-none",children:y.jsx("div",{className:"flex justify-center pt-1 pointer-events-auto",children:y.jsx(He,{"aria-label":"عرض",variant:"ghost",size:"icon",onClick:()=>{Bt(!1),Kr(!0)},className:"rounded-full h-8 w-8 bg-white/80 backdrop-blur-sm shadow",children:y.jsx(ks,{className:"h-4 w-4 text-indigo-700"})})})})]})]})]}),y.jsx(Fs,{children:y.jsx(He,{onClick:()=>Bt(!1),children:"إغلاق"})})]})}),y.jsx(Qa,{open:m0,onOpenChange:ws,children:y.jsxs($a,{className:"sm:max-w-[425px]",children:[y.jsxs(qn,{children:[y.jsx(en,{children:"إضافة قسم جديد"}),y.jsx(Zn,{children:"أدخل اسم القسم الجديد لإضافته إلى قائمة الأقسام."})]}),y.jsx("div",{className:"grid gap-4 py-4",children:y.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[y.jsx(Ut,{htmlFor:"categoryName",className:"text-right",children:"اسم القسم"}),y.jsx(Rt,{id:"categoryName",value:ui,onChange:o=>di(o.target.value),className:"col-span-3",placeholder:"مثال: إلكترونيات"})]})}),y.jsx(Fs,{children:y.jsx(He,{onClick:vs,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:"إضافة"})})]})}),y.jsx(gl,{open:!!vr,onOpenChange:o=>!o&&Ui(null),children:y.jsxs(ml,{children:[y.jsxs(pl,{children:[y.jsx(wl,{className:"text-right",children:"حذف المنتج"}),y.jsxs(vl,{className:"text-right",children:[vr?`هل أنت متأكد من حذف المنتج "${vr.name}" من قائمة المنتجات؟`:"هل أنت متأكد من حذف هذا المنتج من قائمة المنتجات؟",y.jsx("br",{}),"سيتم حذفه من المخزون ولن يظهر في شاشة البيع."]})]}),y.jsxs(yl,{className:"flex-row-reverse sm:justify-start",children:[y.jsx(El,{children:"إلغاء"}),y.jsx(_l,{onClick:_s,className:"bg-red-600 hover:bg-red-700",children:"حذف"})]})]})}),y.jsx(gl,{open:!!m,onOpenChange:o=>!o&&v(null),children:y.jsxs(ml,{children:[y.jsxs(pl,{children:[y.jsx(wl,{className:"text-right",children:"حذف القسم"}),y.jsxs(vl,{className:"text-right",children:["هل أنت متأكد من حذف هذا القسم؟",y.jsx("br",{}),"سيتم حذف القسم ولكن ستبقى المنتجات المرتبطة به بدون قسم."]})]}),y.jsxs(yl,{className:"flex-row-reverse sm:justify-start",children:[y.jsx(El,{children:"إلغاء"}),y.jsx(_l,{onClick:Fr,className:"bg-red-600 hover:bg-red-700",children:"حذف"})]})]})}),y.jsx(Qa,{open:!!me,onOpenChange:o=>!o&&le(null),children:y.jsxs($a,{className:"sm:max-w-lg bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",dir:"rtl",children:[y.jsxs(qn,{children:[y.jsx(en,{className:"text-gray-900 dark:text-gray-100",children:"تفاصيل الفاتورة المجمعة"}),y.jsx(Zn,{className:"text-gray-500 dark:text-gray-400",children:"قائمة المنتجات المدرجة في هذه الفاتورة"})]}),y.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[y.jsxs(F0,{children:[y.jsx(D0,{className:"bg-gray-50/80 dark:bg-gray-800",children:y.jsxs(Qn,{className:"hover:bg-transparent dark:border-gray-800",children:[y.jsx(ar,{className:"text-right text-gray-700 dark:text-gray-300",children:"المنتج"}),y.jsx(ar,{className:"text-center text-gray-700 dark:text-gray-300",children:"الكمية"}),y.jsx(ar,{className:"text-center text-gray-700 dark:text-gray-300",children:"السعر"}),y.jsx(ar,{className:"text-center text-gray-700 dark:text-gray-300",children:"الإجمالي"})]})}),y.jsx(O0,{children:(c=me==null?void 0:me.cartItems)==null?void 0:c.map((o,l)=>y.jsxs(Qn,{className:"hover:bg-gray-50/60 dark:hover:bg-gray-800/60 dark:border-gray-800",children:[y.jsx(nr,{className:"font-medium text-gray-900 dark:text-gray-100",children:o.productName}),y.jsx(nr,{className:"text-center text-gray-700 dark:text-gray-300",children:o.quantity}),y.jsx(nr,{className:"text-center text-gray-700 dark:text-gray-300",children:yt(o.price)}),y.jsx(nr,{className:"text-center font-bold text-emerald-600 dark:text-emerald-400",children:yt(o.price*o.quantity)})]},l))})]}),y.jsxs("div",{className:"mt-4 flex justify-between items-center bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border border-gray-100 dark:border-gray-700",children:[y.jsx("span",{className:"font-bold text-gray-900 dark:text-gray-100",children:"الإجمالي الكلي:"}),y.jsx("span",{className:"font-bold text-lg text-emerald-700 dark:text-emerald-400",children:yt((me==null?void 0:me.price)||0)})]})]}),y.jsx(Fs,{children:y.jsx(He,{onClick:()=>le(null),className:"dark:bg-gray-800 dark:text-gray-100 dark:hover:bg-gray-700",children:"إغلاق"})})]})})]})}const t1=e=>new Intl.NumberFormat("ar-EG").format(Number(e||0)),yt=e=>`${new Intl.NumberFormat("ar-EG",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Number(e||0))} ج.م`,to=e=>{try{const r=new Date(e);return isNaN(r.getTime())?new Date(`${e}T00:00:00`).toLocaleDateString("ar-EG"):r.toLocaleDateString("ar-EG")}catch{return e}};export{N8 as SalesDataDialog};
//# sourceMappingURL=SalesDataDialog-e3zvXpQc.js.map
