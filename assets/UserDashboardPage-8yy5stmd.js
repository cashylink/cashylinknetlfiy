const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CHyvkdwe.js","./index-CF_cwj-9.css","./WalletManagement-DnS17WSi.js","./badge-C_UcFznF.js","./select-VBB5jzA0.js","./wallet-C8MuVqXX.js","./star-qDE6mYRi.js","./square-pen-Cud2vy-2.js","./arrow-left-4i_BaYCY.js","./progress-DNU0vi5d.js","./separator-DRRInuxb.js","./calendar-CvcoBvx3.js","./chart-column-DEHYSFp2.js","./trending-down-BGC9gqL4.js","./dollar-sign-_wKHiNUd.js","./activity-CFRzuke8.js","./users-Qcw8yGaM.js","./circle-check-big-uv2lkbPR.js","./TransactionDetailsModal-BEx2wWWH.js","./SimCardsAccessDialog-D6WUUhMa.js","./printer-tQRybv7D.js","./ReceiptModal-Cv59yGsV.js","./html2canvas.esm-BfYXEYrK.js","./download-CSyWgRqg.js","./EditBalanceDialog-CWJbBUwz.js","./ChangePinDialog-DIA_5Kll.js","./ChangeCashPinDialog-CnO4S8x1.js","./ChangeWalletTotalPinDialog-DScXkFGR.js","./AddToWalletDialog-B5cjGWRN.js","./CalculatorDialog-C1bdo3cJ.js","./SalesDataDialog-W89CFsC-.js","./table-SHLQOguK.js","./tabs-B0OQD0l8.js","./index-BZ_s4N2Q.js","./dropdown-menu-CZzBeEST.js","./alert-dialog-BzHqNmTn.js","./VideoModal-ChGRvXmu.js","./refresh-cw-Do-H4KwK.js","./save-C1HQozbU.js","./pen-line-ChKy8rIm.js","./ProfileSettingsPage-fL_qYmdn.js","./switch-Ng20LGJl.js","./textarea-ymmQWf49.js","./crown-DiWo4O6v.js","./ProfileIcon-DR9RBlJs.js","./freeTrialService-CSbqfZaj.js","./broadcastService-CIt5XDVt.js","./bell-BuLjh4AU.js","./profitService-Bwtuj4RF.js","./arrow-down-left-C-H_qrrL.js","./CashSummaryDialog-ZI2dq4YM.js","./battery-charging-CblJ8SLu.js","./CreditCardsDialog-DuviBG5V.js","./InstallmentModal-BEepqRmF.js","./SimCardsDialog-BAp5aKA4.js","./wifi-DhK9ymJV.js","./AdslCardsDialog-BeX0azv8.js","./MaintenanceDialog-CQtvIvHG.js","./MachineDailyDialog-CfIjGWKt.js","./WalletsManagement-DpgCwtuT.js","./WalletPrinterDialog-CaAQ48-4.js","./WalletsListDialog-BZJ2fJb2.js","./building-2-DRK-_mAR.js","./PendingOperationsDialog-3CfpWcOs.js","./CashierShiftModal-B0DIX9ef.js","./functions-C8GAR9cn.js","./ShiftProfileDialog-CSLP-xED.js","./ChangeLogDialog-PC7tTAXu.js","./sparkles-DuPBq8dZ.js","./dailyOperationCountService-B8RFl0oW.js"])))=>i.map(i=>d[i]);
import{$ as Ds,R as G,j as e,r as d,B as I,bv as Pg,bw as Cm,ap as Im,bx as Og,aj as ec,al as Eg,ao as gn,am as dr,an as ns,by as _m,bc as tc,bz as Mg,bA as Rg,bD as Wg,bC as Lg,bE as Fg,bF as Bg,bG as $g,bH as Ug,a9 as Da,bo as zu,a1 as _i,V as Pe,t as $,_ as sa,E as ft,p as sr,cg as bs,a0 as la,q as Ee,s as ce,aI as Y,x as ke,u as ac,ab as Am,bK as Vg,aX as Mi,ac as Ot,K as or,af as ue,ag as me,ah as be,ai as pe,aH as qg,aD as Yu,av as Bt,a5 as ta,a6 as Tm,m as Fi,H as Ku,y as Q,I as X,J as Ju,a4 as zg,ae as Pm,br as Yg,bs as Kg,aJ as at,aS as Fe,O as Jg,a7 as Ua,aM as Hl,ch as El,a as Hg,ci as Qg,aN as Gg,cj as Xg,aW as Zg,W as Hu,T as Qu,n as ep,ba as vs,ad as oe,aO as re,ck as tn,aL as Gu,cl as an,b0 as tp,c as Za,d as ws,e as Ns,at as Na,aU as Si,aZ as sn,g as es,a2 as Pt,cm as ap,C as Ml,S as sp,b5 as rp,F as rn,a3 as np,bL as ip,U as nn,b6 as Xu,aP as op,as as on,bN as Rl,P as Di,au as ln,aT as ki,M as Wl,aG as Ci,bO as lp,bP as cp,bQ as dp,bR as up,bS as mp,D as cn,bT as hp,bU as Zu,ar as ea,X as em,v as Ll,w as fp,b4 as dn,bt as gp,cn as pp,c1 as Fl,co as tm,cp as xp}from"./index-CHyvkdwe.js";import{A as yp,m as bp,a as Om,u as un,f as Ft,B as am,C as vp,b as Bl,S as sm,c as rm}from"./SimCardsAccessDialog-D6WUUhMa.js";import{C as Ai,V as Em}from"./VideoModal-ChGRvXmu.js";import{C as wp,S as Np,P as jp,a as Sp,w as Dp}from"./ProfileSettingsPage-fL_qYmdn.js";import{B as Ma}from"./badge-C_UcFznF.js";import{S as nm,T as kp,a as Cp,b as im,c as om}from"./tabs-B0OQD0l8.js";import{u as Ip,S as Wa,a as La,b as Fa,c as Ba,d as oa,C as _p,f as Ap}from"./select-VBB5jzA0.js";import{C as Tp,D as Pp,a as Op,b as Ep,f as Mp}from"./dropdown-menu-CZzBeEST.js";import{L as rs,S as Rp}from"./switch-Ng20LGJl.js";import{P as Wp}from"./ProfileIcon-DR9RBlJs.js";import{E as Lp,a as Fp}from"./broadcastService-CIt5XDVt.js";import{B as Ii}from"./bell-BuLjh4AU.js";import{C as Ri}from"./circle-check-big-uv2lkbPR.js";import{ProfitService as fa}from"./profitService-Bwtuj4RF.js";import{C as Ti}from"./calendar-CvcoBvx3.js";import{A as rr}from"./arrow-down-left-C-H_qrrL.js";import{D as $a}from"./dollar-sign-_wKHiNUd.js";import{c as Mm,R as Bp,I as $p}from"./index-BZ_s4N2Q.js";import{FreeTrialService as lm}from"./freeTrialService-CSbqfZaj.js";import{W as tr}from"./wallet-C8MuVqXX.js";import{C as Up}from"./crown-DiWo4O6v.js";import{R as $l}from"./refresh-cw-Do-H4KwK.js";import{S as cm}from"./square-pen-Cud2vy-2.js";import{P as Vp}from"./printer-tQRybv7D.js";import{S as qp}from"./star-qDE6mYRi.js";import{C as zp}from"./users-Qcw8yGaM.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yp=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],dm=Ds("calendar-days",Yp);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kp=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Jp=Ds("chevron-left",Kp);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hp=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Qp=Ds("circle-plus",Hp);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gp=[["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M16 2v20",key:"rotuqe"}]],um=Ds("notebook",Gp);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xp=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Rm=Ds("package",Xp);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],ex=Ds("party-popper",Zp);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tx=[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]],ax=Ds("youtube",tx);var Pi={linear:function(s,t,r,i){var l=r-t;return l*s/i+t},easeInQuad:function(s,t,r,i){var l=r-t;return l*(s/=i)*s+t},easeOutQuad:function(s,t,r,i){var l=r-t;return-l*(s/=i)*(s-2)+t},easeInOutQuad:function(s,t,r,i){var l=r-t;return(s/=i/2)<1?l/2*s*s+t:-l/2*(--s*(s-2)-1)+t},easeInCubic:function(s,t,r,i){var l=r-t;return l*(s/=i)*s*s+t},easeOutCubic:function(s,t,r,i){var l=r-t;return l*((s=s/i-1)*s*s+1)+t},easeInOutCubic:function(s,t,r,i){var l=r-t;return(s/=i/2)<1?l/2*s*s*s+t:l/2*((s-=2)*s*s+2)+t},easeInQuart:function(s,t,r,i){var l=r-t;return l*(s/=i)*s*s*s+t},easeOutQuart:function(s,t,r,i){var l=r-t;return-l*((s=s/i-1)*s*s*s-1)+t},easeInOutQuart:function(s,t,r,i){var l=r-t;return(s/=i/2)<1?l/2*s*s*s*s+t:-l/2*((s-=2)*s*s*s-2)+t},easeInQuint:function(s,t,r,i){var l=r-t;return l*(s/=i)*s*s*s*s+t},easeOutQuint:function(s,t,r,i){var l=r-t;return l*((s=s/i-1)*s*s*s*s+1)+t},easeInOutQuint:function(s,t,r,i){var l=r-t;return(s/=i/2)<1?l/2*s*s*s*s*s+t:l/2*((s-=2)*s*s*s*s+2)+t},easeInSine:function(s,t,r,i){var l=r-t;return-l*Math.cos(s/i*(Math.PI/2))+l+t},easeOutSine:function(s,t,r,i){var l=r-t;return l*Math.sin(s/i*(Math.PI/2))+t},easeInOutSine:function(s,t,r,i){var l=r-t;return-l/2*(Math.cos(Math.PI*s/i)-1)+t},easeInExpo:function(s,t,r,i){var l=r-t;return s==0?t:l*Math.pow(2,10*(s/i-1))+t},easeOutExpo:function(s,t,r,i){var l=r-t;return s==i?t+l:l*(-Math.pow(2,-10*s/i)+1)+t},easeInOutExpo:function(s,t,r,i){var l=r-t;return s===0?t:s===i?t+l:(s/=i/2)<1?l/2*Math.pow(2,10*(s-1))+t:l/2*(-Math.pow(2,-10*--s)+2)+t},easeInCirc:function(s,t,r,i){var l=r-t;return-l*(Math.sqrt(1-(s/=i)*s)-1)+t},easeOutCirc:function(s,t,r,i){var l=r-t;return l*Math.sqrt(1-(s=s/i-1)*s)+t},easeInOutCirc:function(s,t,r,i){var l=r-t;return(s/=i/2)<1?-l/2*(Math.sqrt(1-s*s)-1)+t:l/2*(Math.sqrt(1-(s-=2)*s)+1)+t},easeInElastic:function(s,t,r,i){var l=r-t,m,g,v;return v=1.70158,g=0,m=l,s===0?t:(s/=i)===1?t+l:(g||(g=i*.3),m<Math.abs(l)?(m=l,v=g/4):v=g/(2*Math.PI)*Math.asin(l/m),-(m*Math.pow(2,10*(s-=1))*Math.sin((s*i-v)*(2*Math.PI)/g))+t)},easeOutElastic:function(s,t,r,i){var l=r-t,m,g,v;return v=1.70158,g=0,m=l,s===0?t:(s/=i)===1?t+l:(g||(g=i*.3),m<Math.abs(l)?(m=l,v=g/4):v=g/(2*Math.PI)*Math.asin(l/m),m*Math.pow(2,-10*s)*Math.sin((s*i-v)*(2*Math.PI)/g)+l+t)},easeInOutElastic:function(s,t,r,i){var l=r-t,m,g,v;return v=1.70158,g=0,m=l,s===0?t:(s/=i/2)===2?t+l:(g||(g=i*(.3*1.5)),m<Math.abs(l)?(m=l,v=g/4):v=g/(2*Math.PI)*Math.asin(l/m),s<1?-.5*(m*Math.pow(2,10*(s-=1))*Math.sin((s*i-v)*(2*Math.PI)/g))+t:m*Math.pow(2,-10*(s-=1))*Math.sin((s*i-v)*(2*Math.PI)/g)*.5+l+t)},easeInBack:function(s,t,r,i,l){var m=r-t;return l===void 0&&(l=1.70158),m*(s/=i)*s*((l+1)*s-l)+t},easeOutBack:function(s,t,r,i,l){var m=r-t;return l===void 0&&(l=1.70158),m*((s=s/i-1)*s*((l+1)*s+l)+1)+t},easeInOutBack:function(s,t,r,i,l){var m=r-t;return l===void 0&&(l=1.70158),(s/=i/2)<1?m/2*(s*s*(((l*=1.525)+1)*s-l))+t:m/2*((s-=2)*s*(((l*=1.525)+1)*s+l)+2)+t},easeInBounce:function(s,t,r,i){var l=r-t,m;return m=Pi.easeOutBounce(i-s,0,l,i),l-m+t},easeOutBounce:function(s,t,r,i){var l=r-t;return(s/=i)<1/2.75?l*(7.5625*s*s)+t:s<2/2.75?l*(7.5625*(s-=1.5/2.75)*s+.75)+t:s<2.5/2.75?l*(7.5625*(s-=2.25/2.75)*s+.9375)+t:l*(7.5625*(s-=2.625/2.75)*s+.984375)+t},easeInOutBounce:function(s,t,r,i){var l=r-t,m;return s<i/2?(m=Pi.easeInBounce(s*2,0,l,i),m*.5+t):(m=Pi.easeOutBounce(s*2-i,0,l,i),m*.5+l*.5+t)}},sx=Pi;function rx(s){return s*Math.PI/180}function aa(s,t){return s+Math.random()*(t-s)}function nx(s,t){return Math.floor(s+Math.random()*(t-s+1))}var hn;(function(s){s[s.Circle=0]="Circle",s[s.Square=1]="Square",s[s.Strip=2]="Strip"})(hn||(hn={}));var ss;(function(s){s[s.Positive=1]="Positive",s[s.Negative=-1]="Negative"})(ss||(ss={}));const ix=1e3/60;class ox{constructor(t,r,i,l){this.getOptions=r;const{colors:m,initialVelocityX:g,initialVelocityY:v}=this.getOptions();this.context=t,this.x=i,this.y=l,this.w=aa(5,20),this.h=aa(5,20),this.radius=aa(5,10),this.vx=typeof g=="number"?aa(-g,g):aa(g.min,g.max),this.vy=typeof v=="number"?aa(-v,0):aa(v.min,v.max),this.shape=nx(0,2),this.angle=rx(aa(0,360)),this.angularSpin=aa(-.2,.2),this.color=m[Math.floor(Math.random()*m.length)],this.rotateY=aa(0,1),this.rotationDirection=aa(0,1)?ss.Positive:ss.Negative}update(t){const{gravity:r,wind:i,friction:l,opacity:m,drawShape:g}=this.getOptions(),v=t/ix;this.x+=this.vx*v,this.y+=this.vy*v,this.vy+=r*v,this.vx+=i*v,this.vx*=l**v,this.vy*=l**v,this.rotateY>=1&&this.rotationDirection===ss.Positive?this.rotationDirection=ss.Negative:this.rotateY<=-1&&this.rotationDirection===ss.Negative&&(this.rotationDirection=ss.Positive);const D=.1*this.rotationDirection*v;if(this.rotateY+=D,this.angle+=this.angularSpin,this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(this.angle),this.context.scale(1,this.rotateY),this.context.rotate(this.angle),this.context.beginPath(),this.context.fillStyle=this.color,this.context.strokeStyle=this.color,this.context.globalAlpha=m,this.context.lineCap="round",this.context.lineWidth=2,g&&typeof g=="function")g.call(this,this.context);else switch(this.shape){case hn.Circle:{this.context.beginPath(),this.context.arc(0,0,this.radius,0,2*Math.PI),this.context.fill();break}case hn.Square:{this.context.fillRect(-this.w/2,-this.h/2,this.w,this.h);break}case hn.Strip:{this.context.fillRect(-this.w/6,-this.h/2,this.w/3,this.h);break}}this.context.closePath(),this.context.restore()}}class lx{constructor(t,r){this.x=0,this.y=0,this.w=0,this.h=0,this.lastNumberOfPieces=0,this.tweenProgress=0,this.tweenFrom=0,this.particles=[],this.particlesGenerated=0,this.removeParticleAt=l=>{this.particles.splice(l,1)},this.getParticle=()=>{const l=aa(this.x,this.w+this.x),m=aa(this.y,this.h+this.y);return new ox(this.context,this.getOptions,l,m)},this.animate=l=>{const{canvas:m,context:g,particlesGenerated:v,lastNumberOfPieces:D}=this,{run:S,recycle:j,numberOfPieces:A,debug:E,tweenFunction:P,tweenDuration:x}=this.getOptions();if(!S)return!1;const q=this.particles.length,F=j?q:v;if(F<A){D!==A&&(this.tweenProgress=0,this.tweenFrom=F,this.lastNumberOfPieces=A),this.tweenProgress=Math.min(x,Math.max(0,this.tweenProgress+l));const ne=P(this.tweenProgress,this.tweenFrom,A,x),K=Math.round(ne-F);for(let U=0;U<K;U++)this.particles.push(this.getParticle());this.particlesGenerated+=K}E&&(g.font="12px sans-serif",g.fillStyle="#333",g.textAlign="right",g.fillText(`Particles: ${q}`,m.width-10,m.height-20));for(let ne=this.particles.length-1;ne>=0;ne--){const K=this.particles[ne];K.update(l),(K.y>m.height||K.y<-100||K.x>m.width+100||K.x<-100)&&(j&&F<=A?this.particles[ne]=this.getParticle():this.removeParticleAt(ne))}return q>0||F<A},this.canvas=t;const i=this.canvas.getContext("2d");if(!i)throw new Error("Could not get canvas context");this.context=i,this.getOptions=r}}const sc={width:typeof window<"u"?window.innerWidth:300,height:typeof window<"u"?window.innerHeight:200,numberOfPieces:200,friction:.99,wind:0,gravity:.1,initialVelocityX:4,initialVelocityY:10,colors:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"],opacity:1,debug:!1,tweenFunction:sx.easeInOutQuad,tweenDuration:5e3,recycle:!0,run:!0};class cx{constructor(t,r){this.lastFrameTime=0,this.setOptionsWithDefaults=l=>{const m={confettiSource:{x:0,y:0,w:this.canvas.width,h:0}};this._options={...m,...sc,...l},Object.assign(this,l.confettiSource)},this.update=(l=0)=>{const{options:{run:m,onConfettiComplete:g,frameRate:v},canvas:D,context:S}=this,j=Math.min(l-this.lastFrameTime,50);if(v&&j<1e3/v){this.rafId=requestAnimationFrame(this.update);return}this.lastFrameTime=l-(v?j%v:0),m&&(S.fillStyle="white",S.clearRect(0,0,D.width,D.height)),this.generator.animate(j)?this.rafId=requestAnimationFrame(this.update):(g&&typeof g=="function"&&this.generator.particlesGenerated>0&&g.call(this,this),this._options.run=!1)},this.reset=()=>{this.generator&&this.generator.particlesGenerated>0&&(this.generator.particlesGenerated=0,this.generator.particles=[],this.generator.lastNumberOfPieces=0)},this.stop=()=>{this.options={run:!1},this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0)},this.canvas=t;const i=this.canvas.getContext("2d");if(!i)throw new Error("Could not get canvas context");this.context=i,this.generator=new lx(this.canvas,()=>this.options),this.options=r,this.update()}get options(){return this._options}set options(t){var l,m;const r=(l=this._options)==null?void 0:l.run,i=(m=this._options)==null?void 0:m.recycle;this.setOptionsWithDefaults(t),this.generator&&(Object.assign(this.generator,this.options.confettiSource),typeof t.recycle=="boolean"&&t.recycle&&i===!1&&(this.generator.lastNumberOfPieces=this.generator.particles.length)),typeof t.run=="boolean"&&t.run&&r===!1&&this.update()}}const dx=G.createRef();class rc extends G.Component{constructor(t){super(t),this.canvas=G.createRef(),this.canvas=t.canvasRef||dx}componentDidMount(){if(this.canvas.current){const t=Ul(this.props)[0];this.confetti=new cx(this.canvas.current,t)}}componentDidUpdate(){const t=Ul(this.props)[0];this.confetti&&(this.confetti.options=t)}componentWillUnmount(){this.confetti&&this.confetti.stop(),this.confetti=void 0}render(){const[t,r]=Ul(this.props),i={zIndex:2,position:"absolute",pointerEvents:"none",top:0,left:0,bottom:0,right:0,...r.style};return e.jsx("canvas",{width:t.width,height:t.height,ref:this.canvas,...r,style:i})}}rc.defaultProps={...sc};rc.displayName="ReactConfetti";function Ul(s){const t={},r={},i={},l=[...Object.keys(sc),"confettiSource","drawShape","onConfettiComplete","frameRate"],m=["canvasRef"];for(const g in s){const v=s[g];l.includes(g)?t[g]=v:m.includes(g)?m[g]=v:i[g]=v}return[t,i,r]}const ux=G.forwardRef((s,t)=>e.jsx(rc,{canvasRef:t,...s})),mx=({isOpen:s,onClose:t,userName:r})=>{const[i,l]=d.useState({width:window.innerWidth,height:window.innerHeight});return d.useEffect(()=>{const m=()=>{l({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]),e.jsx(yp,{children:s&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:[e.jsx(ux,{width:i.width,height:i.height,recycle:!0,numberOfPieces:200,gravity:.15}),e.jsxs(bp.div,{initial:{scale:.5,opacity:0,y:50},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0},transition:{type:"spring",duration:.8,bounce:.5},className:"relative w-full max-w-lg bg-white dark:bg-slate-900 rounded-3xl shadow-2xl overflow-hidden border-4 border-indigo-100 dark:border-indigo-900",children:[e.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-purple-200 dark:bg-purple-900/30 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-32 h-32 bg-blue-200 dark:bg-blue-900/30 rounded-full blur-3xl translate-x-1/2 translate-y-1/2"}),e.jsxs("div",{className:"relative p-8 text-center space-y-6",children:[e.jsx("div",{className:"mx-auto w-24 h-24 bg-gradient-to-tr from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-4 ring-4 ring-white dark:ring-slate-800",children:e.jsx(ex,{className:"w-12 h-12 text-white animate-bounce"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-3xl font-extrabold leading-tight bg-clip-text text-transparent bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 dark:from-indigo-400 dark:via-purple-400 dark:to-pink-400",children:["Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¹Ø§Ø¦Ù„Ø©",e.jsx("br",{}),e.jsx("span",{className:"text-4xl",children:"Cashy Link! ðŸš€"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xl text-gray-800 dark:text-gray-200 font-bold",children:r?`Ø£Ù‡Ù„Ø§Ù‹ ${r}ØŒ`:""}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 font-medium",children:"Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ ØªØ¬Ø±Ø¨Ø© Ø³Ø¹ÙŠØ¯Ø© ÙˆÙ…Ù…ÙŠØ²Ø© Ù…Ø¹Ù†Ø§."})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-slate-800/50 p-4 rounded-xl border border-gray-100 dark:border-slate-800",children:"Ù„Ù‚Ø¯ Ø£ØµØ¨Ø­Øª Ø§Ù„Ø¢Ù† Ø¬Ø²Ø¡Ø§Ù‹ Ù…Ù† Ù…Ø¬ØªÙ…Ø¹Ù†Ø§ Ø§Ù„Ù…Ù…ÙŠØ². Ø§Ø³ØªÙ…ØªØ¹ Ø¨ÙƒÙ„ Ø§Ù„Ù…Ø²Ø§ÙŠØ§ Ø§Ù„Ø­ØµØ±ÙŠØ© Ø§Ù„ØªÙŠ Ù†Ù‚Ø¯Ù…Ù‡Ø§ Ù„Ùƒ!"})]}),e.jsx("div",{className:"pt-2",children:e.jsx(I,{onClick:t,size:"lg",className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-6 rounded-xl text-lg shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 active:translate-y-0",children:"Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø¢Ù† âœ¨"})})]})]})]})})};function hx(s){const t=fx(s),r=d.forwardRef((i,l)=>{const{children:m,...g}=i,v=d.Children.toArray(m),D=v.find(px);if(D){const S=D.props.children,j=v.map(A=>A===D?d.Children.count(S)>1?d.Children.only(null):d.isValidElement(S)?S.props.children:null:A);return e.jsx(t,{...g,ref:l,children:d.isValidElement(S)?d.cloneElement(S,void 0,j):null})}return e.jsx(t,{...g,ref:l,children:m})});return r.displayName=`${s}.Slot`,r}function fx(s){const t=d.forwardRef((r,i)=>{const{children:l,...m}=r;if(d.isValidElement(l)){const g=yx(l),v=xx(m,l.props);return l.type!==d.Fragment&&(v.ref=i?Pg(i,g):g),d.cloneElement(l,v)}return d.Children.count(l)>1?d.Children.only(null):null});return t.displayName=`${s}.SlotClone`,t}var gx=Symbol("radix.slottable");function px(s){return d.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===gx}function xx(s,t){const r={...t};for(const i in t){const l=s[i],m=t[i];/^on[A-Z]/.test(i)?l&&m?r[i]=(...v)=>{const D=m(...v);return l(...v),D}:l&&(r[i]=l):i==="style"?r[i]={...l,...m}:i==="className"&&(r[i]=[l,m].filter(Boolean).join(" "))}return{...s,...r}}function yx(s){var i,l;let t=(i=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(l=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:l.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var Bi="Popover",[Wm]=ec(Bi,[Cm]),pn=Cm(),[bx,is]=Wm(Bi),Lm=s=>{const{__scopePopover:t,children:r,open:i,defaultOpen:l,onOpenChange:m,modal:g=!1}=s,v=pn(t),D=d.useRef(null),[S,j]=d.useState(!1),[A,E]=Im({prop:i,defaultProp:l??!1,onChange:m,caller:Bi});return e.jsx(Og,{...v,children:e.jsx(bx,{scope:t,contentId:Eg(),triggerRef:D,open:A,onOpenChange:E,onOpenToggle:d.useCallback(()=>E(P=>!P),[E]),hasCustomAnchor:S,onCustomAnchorAdd:d.useCallback(()=>j(!0),[]),onCustomAnchorRemove:d.useCallback(()=>j(!1),[]),modal:g,children:r})})};Lm.displayName=Bi;var Fm="PopoverAnchor",vx=d.forwardRef((s,t)=>{const{__scopePopover:r,...i}=s,l=is(Fm,r),m=pn(r),{onCustomAnchorAdd:g,onCustomAnchorRemove:v}=l;return d.useEffect(()=>(g(),()=>v()),[g,v]),e.jsx(_m,{...m,...i,ref:t})});vx.displayName=Fm;var Bm="PopoverTrigger",$m=d.forwardRef((s,t)=>{const{__scopePopover:r,...i}=s,l=is(Bm,r),m=pn(r),g=gn(t,l.triggerRef),v=e.jsx(dr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":l.open,"aria-controls":l.contentId,"data-state":Ym(l.open),...i,ref:g,onClick:ns(s.onClick,l.onOpenToggle)});return l.hasCustomAnchor?v:e.jsx(_m,{asChild:!0,...m,children:v})});$m.displayName=Bm;var nc="PopoverPortal",[wx,Nx]=Wm(nc,{forceMount:void 0}),Um=s=>{const{__scopePopover:t,forceMount:r,children:i,container:l}=s,m=is(nc,t);return e.jsx(wx,{scope:t,forceMount:r,children:e.jsx(tc,{present:r||m.open,children:e.jsx(Mg,{asChild:!0,container:l,children:i})})})};Um.displayName=nc;var lr="PopoverContent",Vm=d.forwardRef((s,t)=>{const r=Nx(lr,s.__scopePopover),{forceMount:i=r.forceMount,...l}=s,m=is(lr,s.__scopePopover);return e.jsx(tc,{present:i||m.open,children:m.modal?e.jsx(Sx,{...l,ref:t}):e.jsx(Dx,{...l,ref:t})})});Vm.displayName=lr;var jx=hx("PopoverContent.RemoveScroll"),Sx=d.forwardRef((s,t)=>{const r=is(lr,s.__scopePopover),i=d.useRef(null),l=gn(t,i),m=d.useRef(!1);return d.useEffect(()=>{const g=i.current;if(g)return Rg(g)},[]),e.jsx(Wg,{as:jx,allowPinchZoom:!0,children:e.jsx(qm,{...s,ref:l,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ns(s.onCloseAutoFocus,g=>{var v;g.preventDefault(),m.current||(v=r.triggerRef.current)==null||v.focus()}),onPointerDownOutside:ns(s.onPointerDownOutside,g=>{const v=g.detail.originalEvent,D=v.button===0&&v.ctrlKey===!0,S=v.button===2||D;m.current=S},{checkForDefaultPrevented:!1}),onFocusOutside:ns(s.onFocusOutside,g=>g.preventDefault(),{checkForDefaultPrevented:!1})})})}),Dx=d.forwardRef((s,t)=>{const r=is(lr,s.__scopePopover),i=d.useRef(!1),l=d.useRef(!1);return e.jsx(qm,{...s,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:m=>{var g,v;(g=s.onCloseAutoFocus)==null||g.call(s,m),m.defaultPrevented||(i.current||(v=r.triggerRef.current)==null||v.focus(),m.preventDefault()),i.current=!1,l.current=!1},onInteractOutside:m=>{var D,S;(D=s.onInteractOutside)==null||D.call(s,m),m.defaultPrevented||(i.current=!0,m.detail.originalEvent.type==="pointerdown"&&(l.current=!0));const g=m.target;((S=r.triggerRef.current)==null?void 0:S.contains(g))&&m.preventDefault(),m.detail.originalEvent.type==="focusin"&&l.current&&m.preventDefault()}})}),qm=d.forwardRef((s,t)=>{const{__scopePopover:r,trapFocus:i,onOpenAutoFocus:l,onCloseAutoFocus:m,disableOutsidePointerEvents:g,onEscapeKeyDown:v,onPointerDownOutside:D,onFocusOutside:S,onInteractOutside:j,...A}=s,E=is(lr,r),P=pn(r);return Lg(),e.jsx(Fg,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:l,onUnmountAutoFocus:m,children:e.jsx(Bg,{asChild:!0,disableOutsidePointerEvents:g,onInteractOutside:j,onEscapeKeyDown:v,onPointerDownOutside:D,onFocusOutside:S,onDismiss:()=>E.onOpenChange(!1),children:e.jsx($g,{"data-state":Ym(E.open),role:"dialog",id:E.contentId,...P,...A,ref:t,style:{...A.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),zm="PopoverClose",kx=d.forwardRef((s,t)=>{const{__scopePopover:r,...i}=s,l=is(zm,r);return e.jsx(dr.button,{type:"button",...i,ref:t,onClick:ns(s.onClick,()=>l.onOpenChange(!1))})});kx.displayName=zm;var Cx="PopoverArrow",Ix=d.forwardRef((s,t)=>{const{__scopePopover:r,...i}=s,l=pn(r);return e.jsx(Ug,{...l,...i,ref:t})});Ix.displayName=Cx;function Ym(s){return s?"open":"closed"}var _x=Lm,Ax=$m,Tx=Um,Km=Vm;const mm=_x,hm=Ax,Ql=d.forwardRef(({className:s,align:t="center",sideOffset:r=4,...i},l)=>e.jsx(Tx,{children:e.jsx(Km,{ref:l,align:t,sideOffset:r,className:Da("z-[9999] w-72 rounded-xl border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})}));Ql.displayName=Km.displayName;function We(s){const t=Object.prototype.toString.call(s);return s instanceof Date||typeof s=="object"&&t==="[object Date]"?new s.constructor(+s):typeof s=="number"||t==="[object Number]"||typeof s=="string"||t==="[object String]"?new Date(s):new Date(NaN)}function ra(s,t){return s instanceof Date?new s.constructor(t):new Date(t)}function $t(s,t){const r=We(s);return isNaN(t)?ra(s,NaN):(t&&r.setDate(r.getDate()+t),r)}function pa(s,t){const r=We(s);if(isNaN(t))return ra(s,NaN);if(!t)return r;const i=r.getDate(),l=ra(s,r.getTime());l.setMonth(r.getMonth()+t+1,0);const m=l.getDate();return i>=m?l:(r.setFullYear(l.getFullYear(),l.getMonth(),i),r)}const ic=6048e5,Px=864e5;let Ox={};function xn(){return Ox}function Ca(s,t){var v,D,S,j;const r=xn(),i=(t==null?void 0:t.weekStartsOn)??((D=(v=t==null?void 0:t.locale)==null?void 0:v.options)==null?void 0:D.weekStartsOn)??r.weekStartsOn??((j=(S=r.locale)==null?void 0:S.options)==null?void 0:j.weekStartsOn)??0,l=We(s),m=l.getDay(),g=(m<i?7:0)+m-i;return l.setDate(l.getDate()-g),l.setHours(0,0,0,0),l}function Ss(s){return Ca(s,{weekStartsOn:1})}function Jm(s){const t=We(s),r=t.getFullYear(),i=ra(s,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);const l=Ss(i),m=ra(s,0);m.setFullYear(r,0,4),m.setHours(0,0,0,0);const g=Ss(m);return t.getTime()>=l.getTime()?r+1:t.getTime()>=g.getTime()?r:r-1}function cr(s){const t=We(s);return t.setHours(0,0,0,0),t}function Wi(s){const t=We(s),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+s-+r}function ka(s,t){const r=cr(s),i=cr(t),l=+r-Wi(r),m=+i-Wi(i);return Math.round((l-m)/Px)}function Ex(s){const t=Jm(s),r=ra(s,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Ss(r)}function Gl(s,t){const r=t*7;return $t(s,r)}function Mx(s,t){return pa(s,t*12)}function Rx(s){let t;return s.forEach(function(r){const i=We(r);(t===void 0||t<i||isNaN(Number(i)))&&(t=i)}),t||new Date(NaN)}function Wx(s){let t;return s.forEach(r=>{const i=We(r);(!t||t>i||isNaN(+i))&&(t=i)}),t||new Date(NaN)}function Kt(s,t){const r=cr(s),i=cr(t);return+r==+i}function oc(s){return s instanceof Date||typeof s=="object"&&Object.prototype.toString.call(s)==="[object Date]"}function Lx(s){if(!oc(s)&&typeof s!="number")return!1;const t=We(s);return!isNaN(Number(t))}function fn(s,t){const r=We(s),i=We(t),l=r.getFullYear()-i.getFullYear(),m=r.getMonth()-i.getMonth();return l*12+m}function Fx(s,t,r){const i=Ca(s,r),l=Ca(t,r),m=+i-Wi(i),g=+l-Wi(l);return Math.round((m-g)/ic)}function lc(s){const t=We(s),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Jt(s){const t=We(s);return t.setDate(1),t.setHours(0,0,0,0),t}function Hm(s){const t=We(s),r=ra(s,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function cc(s,t){var v,D,S,j;const r=xn(),i=(t==null?void 0:t.weekStartsOn)??((D=(v=t==null?void 0:t.locale)==null?void 0:v.options)==null?void 0:D.weekStartsOn)??r.weekStartsOn??((j=(S=r.locale)==null?void 0:S.options)==null?void 0:j.weekStartsOn)??0,l=We(s),m=l.getDay(),g=(m<i?-7:0)+6-(m-i);return l.setDate(l.getDate()+g),l.setHours(23,59,59,999),l}function Qm(s){return cc(s,{weekStartsOn:1})}const Bx={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},$x=(s,t,r)=>{let i;const l=Bx[s];return typeof l=="string"?i=l:t===1?i=l.one:i=l.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};function ir(s){return(t={})=>{const r=t.width?String(t.width):s.defaultWidth;return s.formats[r]||s.formats[s.defaultWidth]}}const Ux={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Vx={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},qx={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},zx={date:ir({formats:Ux,defaultWidth:"full"}),time:ir({formats:Vx,defaultWidth:"full"}),dateTime:ir({formats:qx,defaultWidth:"full"})},Yx={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Kx=(s,t,r,i)=>Yx[s];function ja(s){return(t,r)=>{const i=r!=null&&r.context?String(r.context):"standalone";let l;if(i==="formatting"&&s.formattingValues){const g=s.defaultFormattingWidth||s.defaultWidth,v=r!=null&&r.width?String(r.width):g;l=s.formattingValues[v]||s.formattingValues[g]}else{const g=s.defaultWidth,v=r!=null&&r.width?String(r.width):s.defaultWidth;l=s.values[v]||s.values[g]}const m=s.argumentCallback?s.argumentCallback(t):t;return l[m]}}const Jx={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Hx={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Qx={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Gx={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Xx={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Zx={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ey=(s,t)=>{const r=Number(s),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},ty={ordinalNumber:ey,era:ja({values:Jx,defaultWidth:"wide"}),quarter:ja({values:Hx,defaultWidth:"wide",argumentCallback:s=>s-1}),month:ja({values:Qx,defaultWidth:"wide"}),day:ja({values:Gx,defaultWidth:"wide"}),dayPeriod:ja({values:Xx,defaultWidth:"wide",formattingValues:Zx,defaultFormattingWidth:"wide"})};function Sa(s){return(t,r={})=>{const i=r.width,l=i&&s.matchPatterns[i]||s.matchPatterns[s.defaultMatchWidth],m=t.match(l);if(!m)return null;const g=m[0],v=i&&s.parsePatterns[i]||s.parsePatterns[s.defaultParseWidth],D=Array.isArray(v)?sy(v,A=>A.test(g)):ay(v,A=>A.test(g));let S;S=s.valueCallback?s.valueCallback(D):D,S=r.valueCallback?r.valueCallback(S):S;const j=t.slice(g.length);return{value:S,rest:j}}}function ay(s,t){for(const r in s)if(Object.prototype.hasOwnProperty.call(s,r)&&t(s[r]))return r}function sy(s,t){for(let r=0;r<s.length;r++)if(t(s[r]))return r}function Gm(s){return(t,r={})=>{const i=t.match(s.matchPattern);if(!i)return null;const l=i[0],m=t.match(s.parsePattern);if(!m)return null;let g=s.valueCallback?s.valueCallback(m[0]):m[0];g=r.valueCallback?r.valueCallback(g):g;const v=t.slice(l.length);return{value:g,rest:v}}}const ry=/^(\d+)(th|st|nd|rd)?/i,ny=/\d+/i,iy={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},oy={any:[/^b/i,/^(a|c)/i]},ly={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},cy={any:[/1/i,/2/i,/3/i,/4/i]},dy={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},uy={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},my={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},hy={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},fy={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},gy={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},py={ordinalNumber:Gm({matchPattern:ry,parsePattern:ny,valueCallback:s=>parseInt(s,10)}),era:Sa({matchPatterns:iy,defaultMatchWidth:"wide",parsePatterns:oy,defaultParseWidth:"any"}),quarter:Sa({matchPatterns:ly,defaultMatchWidth:"wide",parsePatterns:cy,defaultParseWidth:"any",valueCallback:s=>s+1}),month:Sa({matchPatterns:dy,defaultMatchWidth:"wide",parsePatterns:uy,defaultParseWidth:"any"}),day:Sa({matchPatterns:my,defaultMatchWidth:"wide",parsePatterns:hy,defaultParseWidth:"any"}),dayPeriod:Sa({matchPatterns:fy,defaultMatchWidth:"any",parsePatterns:gy,defaultParseWidth:"any"})},Xm={code:"en-US",formatDistance:$x,formatLong:zx,formatRelative:Kx,localize:ty,match:py,options:{weekStartsOn:0,firstWeekContainsDate:1}};function xy(s){const t=We(s);return ka(t,Hm(t))+1}function Zm(s){const t=We(s),r=+Ss(t)-+Ex(t);return Math.round(r/ic)+1}function eh(s,t){var j,A,E,P;const r=We(s),i=r.getFullYear(),l=xn(),m=(t==null?void 0:t.firstWeekContainsDate)??((A=(j=t==null?void 0:t.locale)==null?void 0:j.options)==null?void 0:A.firstWeekContainsDate)??l.firstWeekContainsDate??((P=(E=l.locale)==null?void 0:E.options)==null?void 0:P.firstWeekContainsDate)??1,g=ra(s,0);g.setFullYear(i+1,0,m),g.setHours(0,0,0,0);const v=Ca(g,t),D=ra(s,0);D.setFullYear(i,0,m),D.setHours(0,0,0,0);const S=Ca(D,t);return r.getTime()>=v.getTime()?i+1:r.getTime()>=S.getTime()?i:i-1}function yy(s,t){var v,D,S,j;const r=xn(),i=(t==null?void 0:t.firstWeekContainsDate)??((D=(v=t==null?void 0:t.locale)==null?void 0:v.options)==null?void 0:D.firstWeekContainsDate)??r.firstWeekContainsDate??((j=(S=r.locale)==null?void 0:S.options)==null?void 0:j.firstWeekContainsDate)??1,l=eh(s,t),m=ra(s,0);return m.setFullYear(l,0,i),m.setHours(0,0,0,0),Ca(m,t)}function th(s,t){const r=We(s),i=+Ca(r,t)-+yy(r,t);return Math.round(i/ic)+1}function Ue(s,t){const r=s<0?"-":"",i=Math.abs(s).toString().padStart(t,"0");return r+i}const ts={y(s,t){const r=s.getFullYear(),i=r>0?r:1-r;return Ue(t==="yy"?i%100:i,t.length)},M(s,t){const r=s.getMonth();return t==="M"?String(r+1):Ue(r+1,2)},d(s,t){return Ue(s.getDate(),t.length)},a(s,t){const r=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(s,t){return Ue(s.getHours()%12||12,t.length)},H(s,t){return Ue(s.getHours(),t.length)},m(s,t){return Ue(s.getMinutes(),t.length)},s(s,t){return Ue(s.getSeconds(),t.length)},S(s,t){const r=t.length,i=s.getMilliseconds(),l=Math.trunc(i*Math.pow(10,r-3));return Ue(l,t.length)}},ar={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},fm={G:function(s,t,r){const i=s.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(s,t,r){if(t==="yo"){const i=s.getFullYear(),l=i>0?i:1-i;return r.ordinalNumber(l,{unit:"year"})}return ts.y(s,t)},Y:function(s,t,r,i){const l=eh(s,i),m=l>0?l:1-l;if(t==="YY"){const g=m%100;return Ue(g,2)}return t==="Yo"?r.ordinalNumber(m,{unit:"year"}):Ue(m,t.length)},R:function(s,t){const r=Jm(s);return Ue(r,t.length)},u:function(s,t){const r=s.getFullYear();return Ue(r,t.length)},Q:function(s,t,r){const i=Math.ceil((s.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Ue(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(s,t,r){const i=Math.ceil((s.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Ue(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(s,t,r){const i=s.getMonth();switch(t){case"M":case"MM":return ts.M(s,t);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(s,t,r){const i=s.getMonth();switch(t){case"L":return String(i+1);case"LL":return Ue(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(s,t,r,i){const l=th(s,i);return t==="wo"?r.ordinalNumber(l,{unit:"week"}):Ue(l,t.length)},I:function(s,t,r){const i=Zm(s);return t==="Io"?r.ordinalNumber(i,{unit:"week"}):Ue(i,t.length)},d:function(s,t,r){return t==="do"?r.ordinalNumber(s.getDate(),{unit:"date"}):ts.d(s,t)},D:function(s,t,r){const i=xy(s);return t==="Do"?r.ordinalNumber(i,{unit:"dayOfYear"}):Ue(i,t.length)},E:function(s,t,r){const i=s.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(s,t,r,i){const l=s.getDay(),m=(l-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(m);case"ee":return Ue(m,2);case"eo":return r.ordinalNumber(m,{unit:"day"});case"eee":return r.day(l,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(l,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(l,{width:"short",context:"formatting"});case"eeee":default:return r.day(l,{width:"wide",context:"formatting"})}},c:function(s,t,r,i){const l=s.getDay(),m=(l-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(m);case"cc":return Ue(m,t.length);case"co":return r.ordinalNumber(m,{unit:"day"});case"ccc":return r.day(l,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(l,{width:"narrow",context:"standalone"});case"cccccc":return r.day(l,{width:"short",context:"standalone"});case"cccc":default:return r.day(l,{width:"wide",context:"standalone"})}},i:function(s,t,r){const i=s.getDay(),l=i===0?7:i;switch(t){case"i":return String(l);case"ii":return Ue(l,t.length);case"io":return r.ordinalNumber(l,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(s,t,r){const l=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(l,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(l,{width:"wide",context:"formatting"})}},b:function(s,t,r){const i=s.getHours();let l;switch(i===12?l=ar.noon:i===0?l=ar.midnight:l=i/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(l,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(l,{width:"wide",context:"formatting"})}},B:function(s,t,r){const i=s.getHours();let l;switch(i>=17?l=ar.evening:i>=12?l=ar.afternoon:i>=4?l=ar.morning:l=ar.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(l,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(l,{width:"wide",context:"formatting"})}},h:function(s,t,r){if(t==="ho"){let i=s.getHours()%12;return i===0&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return ts.h(s,t)},H:function(s,t,r){return t==="Ho"?r.ordinalNumber(s.getHours(),{unit:"hour"}):ts.H(s,t)},K:function(s,t,r){const i=s.getHours()%12;return t==="Ko"?r.ordinalNumber(i,{unit:"hour"}):Ue(i,t.length)},k:function(s,t,r){let i=s.getHours();return i===0&&(i=24),t==="ko"?r.ordinalNumber(i,{unit:"hour"}):Ue(i,t.length)},m:function(s,t,r){return t==="mo"?r.ordinalNumber(s.getMinutes(),{unit:"minute"}):ts.m(s,t)},s:function(s,t,r){return t==="so"?r.ordinalNumber(s.getSeconds(),{unit:"second"}):ts.s(s,t)},S:function(s,t){return ts.S(s,t)},X:function(s,t,r){const i=s.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return pm(i);case"XXXX":case"XX":return js(i);case"XXXXX":case"XXX":default:return js(i,":")}},x:function(s,t,r){const i=s.getTimezoneOffset();switch(t){case"x":return pm(i);case"xxxx":case"xx":return js(i);case"xxxxx":case"xxx":default:return js(i,":")}},O:function(s,t,r){const i=s.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+gm(i,":");case"OOOO":default:return"GMT"+js(i,":")}},z:function(s,t,r){const i=s.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+gm(i,":");case"zzzz":default:return"GMT"+js(i,":")}},t:function(s,t,r){const i=Math.trunc(s.getTime()/1e3);return Ue(i,t.length)},T:function(s,t,r){const i=s.getTime();return Ue(i,t.length)}};function gm(s,t=""){const r=s>0?"-":"+",i=Math.abs(s),l=Math.trunc(i/60),m=i%60;return m===0?r+String(l):r+String(l)+t+Ue(m,2)}function pm(s,t){return s%60===0?(s>0?"-":"+")+Ue(Math.abs(s)/60,2):js(s,t)}function js(s,t=""){const r=s>0?"-":"+",i=Math.abs(s),l=Ue(Math.trunc(i/60),2),m=Ue(i%60,2);return r+l+t+m}const xm=(s,t)=>{switch(s){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},ah=(s,t)=>{switch(s){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},by=(s,t)=>{const r=s.match(/(P+)(p+)?/)||[],i=r[1],l=r[2];if(!l)return xm(s,t);let m;switch(i){case"P":m=t.dateTime({width:"short"});break;case"PP":m=t.dateTime({width:"medium"});break;case"PPP":m=t.dateTime({width:"long"});break;case"PPPP":default:m=t.dateTime({width:"full"});break}return m.replace("{{date}}",xm(i,t)).replace("{{time}}",ah(l,t))},vy={p:ah,P:by},wy=/^D+$/,Ny=/^Y+$/,jy=["D","DD","YY","YYYY"];function Sy(s){return wy.test(s)}function Dy(s){return Ny.test(s)}function ky(s,t,r){const i=Cy(s,t,r);if(console.warn(i),jy.includes(s))throw new RangeError(i)}function Cy(s,t,r){const i=s[0]==="Y"?"years":"days of the month";return`Use \`${s.toLowerCase()}\` instead of \`${s}\` (in \`${t}\`) for formatting ${i} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Iy=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,_y=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ay=/^'([^]*?)'?$/,Ty=/''/g,Py=/[a-zA-Z]/;function ga(s,t,r){var j,A,E,P,x,q,F,ne;const i=xn(),l=(r==null?void 0:r.locale)??i.locale??Xm,m=(r==null?void 0:r.firstWeekContainsDate)??((A=(j=r==null?void 0:r.locale)==null?void 0:j.options)==null?void 0:A.firstWeekContainsDate)??i.firstWeekContainsDate??((P=(E=i.locale)==null?void 0:E.options)==null?void 0:P.firstWeekContainsDate)??1,g=(r==null?void 0:r.weekStartsOn)??((q=(x=r==null?void 0:r.locale)==null?void 0:x.options)==null?void 0:q.weekStartsOn)??i.weekStartsOn??((ne=(F=i.locale)==null?void 0:F.options)==null?void 0:ne.weekStartsOn)??0,v=We(s);if(!Lx(v))throw new RangeError("Invalid time value");let D=t.match(_y).map(K=>{const U=K[0];if(U==="p"||U==="P"){const ee=vy[U];return ee(K,l.formatLong)}return K}).join("").match(Iy).map(K=>{if(K==="''")return{isToken:!1,value:"'"};const U=K[0];if(U==="'")return{isToken:!1,value:Oy(K)};if(fm[U])return{isToken:!0,value:K};if(U.match(Py))throw new RangeError("Format string contains an unescaped latin alphabet character `"+U+"`");return{isToken:!1,value:K}});l.localize.preprocessor&&(D=l.localize.preprocessor(v,D));const S={firstWeekContainsDate:m,weekStartsOn:g,locale:l};return D.map(K=>{if(!K.isToken)return K.value;const U=K.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&Dy(U)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Sy(U))&&ky(U,t,String(s));const ee=fm[U[0]];return ee(v,U,l.localize,S)}).join("")}function Oy(s){const t=s.match(Ay);return t?t[1].replace(Ty,"'"):s}function Ey(s){const t=We(s),r=t.getFullYear(),i=t.getMonth(),l=ra(s,0);return l.setFullYear(r,i+1,0),l.setHours(0,0,0,0),l.getDate()}function My(s){return Math.trunc(+We(s)/1e3)}function Ry(s){const t=We(s),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function Wy(s,t){return Fx(Ry(s),Jt(s),t)+1}function Xl(s,t){const r=We(s),i=We(t);return r.getTime()>i.getTime()}function sh(s,t){const r=We(s),i=We(t);return+r<+i}function dc(s,t){const r=We(s),i=We(t);return r.getFullYear()===i.getFullYear()&&r.getMonth()===i.getMonth()}function Ly(s,t){const r=We(s),i=We(t);return r.getFullYear()===i.getFullYear()}function Vl(s,t){return $t(s,-t)}function ql(s,t){const r=We(s),i=r.getFullYear(),l=r.getDate(),m=ra(s,0);m.setFullYear(i,t,15),m.setHours(0,0,0,0);const g=Ey(m);return r.setMonth(t,Math.min(l,g)),r}function ym(s,t){const r=We(s);return isNaN(+r)?ra(s,NaN):(r.setFullYear(t),r)}const Fy={lessThanXSeconds:{one:"Ø£Ù‚Ù„ Ù…Ù† Ø«Ø§Ù†ÙŠØ©",two:"Ø£Ù‚Ù„ Ù…Ù† Ø«Ø§Ù†ÙŠØªÙŠÙ†",threeToTen:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø«ÙˆØ§Ù†ÙŠ",other:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø«Ø§Ù†ÙŠØ©"},xSeconds:{one:"Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø©",two:"Ø«Ø§Ù†ÙŠØªØ§Ù†",threeToTen:"{{count}} Ø«ÙˆØ§Ù†ÙŠ",other:"{{count}} Ø«Ø§Ù†ÙŠØ©"},halfAMinute:"Ù†ØµÙ Ø¯Ù‚ÙŠÙ‚Ø©",lessThanXMinutes:{one:"Ø£Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚Ø©",two:"Ø£Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†",threeToTen:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø¯Ù‚Ø§Ø¦Ù‚",other:"Ø£Ù‚Ù„ Ù…Ù† {{count}} Ø¯Ù‚ÙŠÙ‚Ø©"},xMinutes:{one:"Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©",two:"Ø¯Ù‚ÙŠÙ‚ØªØ§Ù†",threeToTen:"{{count}} Ø¯Ù‚Ø§Ø¦Ù‚",other:"{{count}} Ø¯Ù‚ÙŠÙ‚Ø©"},aboutXHours:{one:"Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",two:"Ø³Ø§Ø¹ØªÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø³Ø§Ø¹Ø§Øª ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",other:"{{count}} Ø³Ø§Ø¹Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹"},xHours:{one:"Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©",two:"Ø³Ø§Ø¹ØªØ§Ù†",threeToTen:"{{count}} Ø³Ø§Ø¹Ø§Øª",other:"{{count}} Ø³Ø§Ø¹Ø©"},xDays:{one:"ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯",two:"ÙŠÙˆÙ…Ø§Ù†",threeToTen:"{{count}} Ø£ÙŠØ§Ù…",other:"{{count}} ÙŠÙˆÙ…"},aboutXWeeks:{one:"Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯ ØªÙ‚Ø±ÙŠØ¨Ø§",two:"Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø£Ø³Ø§Ø¨ÙŠØ¹ ØªÙ‚Ø±ÙŠØ¨Ø§",other:"{{count}} Ø£Ø³Ø¨ÙˆØ¹Ø§ ØªÙ‚Ø±ÙŠØ¨Ø§"},xWeeks:{one:"Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø­Ø¯",two:"Ø£Ø³Ø¨ÙˆØ¹Ø§Ù†",threeToTen:"{{count}} Ø£Ø³Ø§Ø¨ÙŠØ¹",other:"{{count}} Ø£Ø³Ø¨ÙˆØ¹Ø§"},aboutXMonths:{one:"Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",two:"Ø´Ù‡Ø±ÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø£Ø´Ù‡Ø± ØªÙ‚Ø±ÙŠØ¨Ø§",other:"{{count}} Ø´Ù‡Ø±Ø§ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹"},xMonths:{one:"Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯",two:"Ø´Ù‡Ø±Ø§Ù†",threeToTen:"{{count}} Ø£Ø´Ù‡Ø±",other:"{{count}} Ø´Ù‡Ø±Ø§"},aboutXYears:{one:"Ø³Ù†Ø© ÙˆØ§Ø­Ø¯Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",two:"Ø³Ù†ØªÙŠÙ† ØªÙ‚Ø±ÙŠØ¨Ø§",threeToTen:"{{count}} Ø³Ù†ÙˆØ§Øª ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹",other:"{{count}} Ø³Ù†Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹"},xYears:{one:"Ø³Ù†Ø© ÙˆØ§Ø­Ø¯",two:"Ø³Ù†ØªØ§Ù†",threeToTen:"{{count}} Ø³Ù†ÙˆØ§Øª",other:"{{count}} Ø³Ù†Ø©"},overXYears:{one:"Ø£ÙƒØ«Ø± Ù…Ù† Ø³Ù†Ø©",two:"Ø£ÙƒØ«Ø± Ù…Ù† Ø³Ù†ØªÙŠÙ†",threeToTen:"Ø£ÙƒØ«Ø± Ù…Ù† {{count}} Ø³Ù†ÙˆØ§Øª",other:"Ø£ÙƒØ«Ø± Ù…Ù† {{count}} Ø³Ù†Ø©"},almostXYears:{one:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ Ø³Ù†Ø© ÙˆØ§Ø­Ø¯Ø©",two:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ Ø³Ù†ØªÙŠÙ†",threeToTen:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ {{count}} Ø³Ù†ÙˆØ§Øª",other:"Ù…Ø§ ÙŠÙ‚Ø§Ø±Ø¨ {{count}} Ø³Ù†Ø©"}},By=(s,t,r)=>{const i=Fy[s];let l;return typeof i=="string"?l=i:t===1?l=i.one:t===2?l=i.two:t<=10?l=i.threeToTen.replace("{{count}}",String(t)):l=i.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"Ø®Ù„Ø§Ù„ "+l:"Ù…Ù†Ø° "+l:l},$y={full:"EEEEØŒ do MMMM y",long:"do MMMM y",medium:"d MMM y",short:"dd/MM/yyyy"},Uy={full:"HH:mm:ss",long:"HH:mm:ss",medium:"HH:mm:ss",short:"HH:mm"},Vy={full:"{{date}} 'Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' {{time}}",long:"{{date}} 'Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},qy={date:ir({formats:$y,defaultWidth:"full"}),time:ir({formats:Uy,defaultWidth:"full"}),dateTime:ir({formats:Vy,defaultWidth:"full"})},zy={lastWeek:"eeee 'Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",yesterday:"'Ø§Ù„Ø£Ù…Ø³ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",today:"'Ø§Ù„ÙŠÙˆÙ… Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",tomorrow:"'ØºØ¯Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",nextWeek:"eeee 'Ø§Ù„Ù‚Ø§Ø¯Ù… Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø©' p",other:"P"},Yy=s=>zy[s],Ky={narrow:["Ù‚","Ø¨"],abbreviated:["Ù‚.Ù….","Ø¨.Ù…."],wide:["Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯","Ø¨Ø¹Ø¯ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯"]},Jy={narrow:["1","2","3","4"],abbreviated:["Ø±1","Ø±2","Ø±3","Ø±4"],wide:["Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø£ÙˆÙ„","Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ","Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù„Ø«","Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø¹"]},Hy={narrow:["ÙŠ","Ù","Ù…","Ø£","Ù…","ÙŠ","ÙŠ","Ø£","Ø³","Ø£","Ù†","Ø¯"],abbreviated:["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"],wide:["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"]},Qy={narrow:["Ø­","Ù†","Ø«","Ø±","Ø®","Ø¬","Ø³"],short:["Ø£Ø­Ø¯","Ø§Ø«Ù†ÙŠÙ†","Ø«Ù„Ø§Ø«Ø§Ø¡","Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø®Ù…ÙŠØ³","Ø¬Ù…Ø¹Ø©","Ø³Ø¨Øª"],abbreviated:["Ø£Ø­Ø¯","Ø§Ø«Ù†ÙŠÙ†","Ø«Ù„Ø§Ø«Ø§Ø¡","Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø®Ù…ÙŠØ³","Ø¬Ù…Ø¹Ø©","Ø³Ø¨Øª"],wide:["Ø§Ù„Ø£Ø­Ø¯","Ø§Ù„Ø§Ø«Ù†ÙŠÙ†","Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡","Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø§Ù„Ø®Ù…ÙŠØ³","Ø§Ù„Ø¬Ù…Ø¹Ø©","Ø§Ù„Ø³Ø¨Øª"]},Gy={narrow:{am:"Øµ",pm:"Ù…",morning:"Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"Ø§Ù„Ù…Ø³Ø§Ø¡",night:"Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},abbreviated:{am:"Øµ",pm:"Ù…",morning:"Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"Ø§Ù„Ù…Ø³Ø§Ø¡",night:"Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},wide:{am:"Øµ",pm:"Ù…",morning:"Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"Ø§Ù„Ù…Ø³Ø§Ø¡",night:"Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"}},Xy={narrow:{am:"Øµ",pm:"Ù…",morning:"ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡",night:"ÙÙŠ Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},abbreviated:{am:"Øµ",pm:"Ù…",morning:"ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡",night:"ÙÙŠ Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"},wide:{am:"Øµ",pm:"Ù…",morning:"ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­",noon:"Ø§Ù„Ø¸Ù‡Ø±",afternoon:"Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±",evening:"ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡",night:"ÙÙŠ Ø§Ù„Ù„ÙŠÙ„",midnight:"Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„"}},Zy=s=>String(s),eb={ordinalNumber:Zy,era:ja({values:Ky,defaultWidth:"wide"}),quarter:ja({values:Jy,defaultWidth:"wide",argumentCallback:s=>s-1}),month:ja({values:Hy,defaultWidth:"wide"}),day:ja({values:Qy,defaultWidth:"wide"}),dayPeriod:ja({values:Gy,defaultWidth:"wide",formattingValues:Xy,defaultFormattingWidth:"wide"})},tb=/^(\d+)(th|st|nd|rd)?/i,ab=/\d+/i,sb={narrow:/[Ù‚Ø¨]/,abbreviated:/[Ù‚Ø¨]\.Ù…\./,wide:/(Ù‚Ø¨Ù„|Ø¨Ø¹Ø¯) Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯/},rb={any:[/Ù‚Ø¨Ù„/,/Ø¨Ø¹Ø¯/]},nb={narrow:/^[1234]/i,abbreviated:/Ø±[1234]/,wide:/Ø§Ù„Ø±Ø¨Ø¹ (Ø§Ù„Ø£ÙˆÙ„|Ø§Ù„Ø«Ø§Ù†ÙŠ|Ø§Ù„Ø«Ø§Ù„Ø«|Ø§Ù„Ø±Ø§Ø¨Ø¹)/},ib={any:[/1/i,/2/i,/3/i,/4/i]},ob={narrow:/^[Ø£ÙŠÙÙ…Ø³Ù†Ø¯]/,abbreviated:/^(ÙŠÙ†Ø§ÙŠØ±|ÙØ¨Ø±Ø§ÙŠØ±|Ù…Ø§Ø±Ø³|Ø£Ø¨Ø±ÙŠÙ„|Ù…Ø§ÙŠÙˆ|ÙŠÙˆÙ†ÙŠÙˆ|ÙŠÙˆÙ„ÙŠÙˆ|Ø£ØºØ³Ø·Ø³|Ø³Ø¨ØªÙ…Ø¨Ø±|Ø£ÙƒØªÙˆØ¨Ø±|Ù†ÙˆÙÙ…Ø¨Ø±|Ø¯ÙŠØ³Ù…Ø¨Ø±)/,wide:/^(ÙŠÙ†Ø§ÙŠØ±|ÙØ¨Ø±Ø§ÙŠØ±|Ù…Ø§Ø±Ø³|Ø£Ø¨Ø±ÙŠÙ„|Ù…Ø§ÙŠÙˆ|ÙŠÙˆÙ†ÙŠÙˆ|ÙŠÙˆÙ„ÙŠÙˆ|Ø£ØºØ³Ø·Ø³|Ø³Ø¨ØªÙ…Ø¨Ø±|Ø£ÙƒØªÙˆØ¨Ø±|Ù†ÙˆÙÙ…Ø¨Ø±|Ø¯ÙŠØ³Ù…Ø¨Ø±)/},lb={narrow:[/^ÙŠ/i,/^Ù/i,/^Ù…/i,/^Ø£/i,/^Ù…/i,/^ÙŠ/i,/^ÙŠ/i,/^Ø£/i,/^Ø³/i,/^Ø£/i,/^Ù†/i,/^Ø¯/i],any:[/^ÙŠÙ†Ø§ÙŠØ±/i,/^ÙØ¨Ø±Ø§ÙŠØ±/i,/^Ù…Ø§Ø±Ø³/i,/^Ø£Ø¨Ø±ÙŠÙ„/i,/^Ù…Ø§ÙŠÙˆ/i,/^ÙŠÙˆÙ†ÙŠÙˆ/i,/^ÙŠÙˆÙ„ÙŠÙˆ/i,/^Ø£ØºØ³Ø·Ø³/i,/^Ø³Ø¨ØªÙ…Ø¨Ø±/i,/^Ø£ÙƒØªÙˆØ¨Ø±/i,/^Ù†ÙˆÙÙ…Ø¨Ø±/i,/^Ø¯ÙŠØ³Ù…Ø¨Ø±/i]},cb={narrow:/^[Ø­Ù†Ø«Ø±Ø®Ø¬Ø³]/i,short:/^(Ø£Ø­Ø¯|Ø§Ø«Ù†ÙŠÙ†|Ø«Ù„Ø§Ø«Ø§Ø¡|Ø£Ø±Ø¨Ø¹Ø§Ø¡|Ø®Ù…ÙŠØ³|Ø¬Ù…Ø¹Ø©|Ø³Ø¨Øª)/i,abbreviated:/^(Ø£Ø­Ø¯|Ø§Ø«Ù†ÙŠÙ†|Ø«Ù„Ø§Ø«Ø§Ø¡|Ø£Ø±Ø¨Ø¹Ø§Ø¡|Ø®Ù…ÙŠØ³|Ø¬Ù…Ø¹Ø©|Ø³Ø¨Øª)/i,wide:/^(Ø§Ù„Ø£Ø­Ø¯|Ø§Ù„Ø§Ø«Ù†ÙŠÙ†|Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡|Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡|Ø§Ù„Ø®Ù…ÙŠØ³|Ø§Ù„Ø¬Ù…Ø¹Ø©|Ø§Ù„Ø³Ø¨Øª)/i},db={narrow:[/^Ø­/i,/^Ù†/i,/^Ø«/i,/^Ø±/i,/^Ø®/i,/^Ø¬/i,/^Ø³/i],wide:[/^Ø§Ù„Ø£Ø­Ø¯/i,/^Ø§Ù„Ø§Ø«Ù†ÙŠÙ†/i,/^Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡/i,/^Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡/i,/^Ø§Ù„Ø®Ù…ÙŠØ³/i,/^Ø§Ù„Ø¬Ù…Ø¹Ø©/i,/^Ø§Ù„Ø³Ø¨Øª/i],any:[/^Ø£Ø­/i,/^Ø§Ø«/i,/^Ø«/i,/^Ø£Ø±/i,/^Ø®/i,/^Ø¬/i,/^Ø³/i]},ub={narrow:/^(Øµ|Ù…|Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„|Ø§Ù„Ø¸Ù‡Ø±|Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±|ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­|ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡|ÙÙŠ Ø§Ù„Ù„ÙŠÙ„)/,any:/^(Øµ|Ù…|Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„|Ø§Ù„Ø¸Ù‡Ø±|Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±|ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­|ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡|ÙÙŠ Ø§Ù„Ù„ÙŠÙ„)/},mb={any:{am:/^Øµ/,pm:/^Ù…/,midnight:/Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„/,noon:/Ø§Ù„Ø¸Ù‡Ø±/,afternoon:/Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø±/,morning:/ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­/,evening:/ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¡/,night:/ÙÙŠ Ø§Ù„Ù„ÙŠÙ„/}},hb={ordinalNumber:Gm({matchPattern:tb,parsePattern:ab,valueCallback:s=>parseInt(s,10)}),era:Sa({matchPatterns:sb,defaultMatchWidth:"wide",parsePatterns:rb,defaultParseWidth:"any"}),quarter:Sa({matchPatterns:nb,defaultMatchWidth:"wide",parsePatterns:ib,defaultParseWidth:"any",valueCallback:s=>s+1}),month:Sa({matchPatterns:ob,defaultMatchWidth:"wide",parsePatterns:lb,defaultParseWidth:"any"}),day:Sa({matchPatterns:cb,defaultMatchWidth:"wide",parsePatterns:db,defaultParseWidth:"any"}),dayPeriod:Sa({matchPatterns:ub,defaultMatchWidth:"any",parsePatterns:mb,defaultParseWidth:"any"})},bm={code:"ar",formatDistance:By,formatLong:qy,formatRelative:Yy,localize:eb,match:hb,options:{weekStartsOn:6,firstWeekContainsDate:1}};var fe=function(){return fe=Object.assign||function(t){for(var r,i=1,l=arguments.length;i<l;i++){r=arguments[i];for(var m in r)Object.prototype.hasOwnProperty.call(r,m)&&(t[m]=r[m])}return t},fe.apply(this,arguments)};function fb(s,t){var r={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&t.indexOf(i)<0&&(r[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,i=Object.getOwnPropertySymbols(s);l<i.length;l++)t.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(s,i[l])&&(r[i[l]]=s[i[l]]);return r}function rh(s,t,r){for(var i=0,l=t.length,m;i<l;i++)(m||!(i in t))&&(m||(m=Array.prototype.slice.call(t,0,i)),m[i]=t[i]);return s.concat(m||Array.prototype.slice.call(t))}function yn(s){return s.mode==="multiple"}function bn(s){return s.mode==="range"}function $i(s){return s.mode==="single"}var gb={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function pb(s,t){return ga(s,"LLLL y",t)}function xb(s,t){return ga(s,"d",t)}function yb(s,t){return ga(s,"LLLL",t)}function bb(s){return"".concat(s)}function vb(s,t){return ga(s,"cccccc",t)}function wb(s,t){return ga(s,"yyyy",t)}var Nb=Object.freeze({__proto__:null,formatCaption:pb,formatDay:xb,formatMonthCaption:yb,formatWeekNumber:bb,formatWeekdayName:vb,formatYearCaption:wb}),jb=function(s,t,r){return ga(s,"do MMMM (EEEE)",r)},Sb=function(){return"Month: "},Db=function(){return"Go to next month"},kb=function(){return"Go to previous month"},Cb=function(s,t){return ga(s,"cccc",t)},Ib=function(s){return"Week n. ".concat(s)},_b=function(){return"Year: "},Ab=Object.freeze({__proto__:null,labelDay:jb,labelMonthDropdown:Sb,labelNext:Db,labelPrevious:kb,labelWeekNumber:Ib,labelWeekday:Cb,labelYearDropdown:_b});function Tb(){var s="buttons",t=gb,r=Xm,i={},l={},m=1,g={},v=new Date;return{captionLayout:s,classNames:t,formatters:Nb,labels:Ab,locale:r,modifiersClassNames:i,modifiers:l,numberOfMonths:m,styles:g,today:v,mode:"default"}}function Pb(s){var t=s.fromYear,r=s.toYear,i=s.fromMonth,l=s.toMonth,m=s.fromDate,g=s.toDate;return i?m=Jt(i):t&&(m=new Date(t,0,1)),l?g=lc(l):r&&(g=new Date(r,11,31)),{fromDate:m?cr(m):void 0,toDate:g?cr(g):void 0}}var nh=d.createContext(void 0);function Ob(s){var t,r=s.initialProps,i=Tb(),l=Pb(r),m=l.fromDate,g=l.toDate,v=(t=r.captionLayout)!==null&&t!==void 0?t:i.captionLayout;v!=="buttons"&&(!m||!g)&&(v="buttons");var D;($i(r)||yn(r)||bn(r))&&(D=r.onSelect);var S=fe(fe(fe({},i),r),{captionLayout:v,classNames:fe(fe({},i.classNames),r.classNames),components:fe({},r.components),formatters:fe(fe({},i.formatters),r.formatters),fromDate:m,labels:fe(fe({},i.labels),r.labels),mode:r.mode||i.mode,modifiers:fe(fe({},i.modifiers),r.modifiers),modifiersClassNames:fe(fe({},i.modifiersClassNames),r.modifiersClassNames),onSelect:D,styles:fe(fe({},i.styles),r.styles),toDate:g});return e.jsx(nh.Provider,{value:S,children:s.children})}function Ke(){var s=d.useContext(nh);if(!s)throw new Error("useDayPicker must be used within a DayPickerProvider.");return s}function ih(s){var t=Ke(),r=t.locale,i=t.classNames,l=t.styles,m=t.formatters.formatCaption;return e.jsx("div",{className:i.caption_label,style:l.caption_label,"aria-live":"polite",role:"presentation",id:s.id,children:m(s.displayMonth,{locale:r})})}function Eb(s){return e.jsx("svg",fe({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},s,{children:e.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function oh(s){var t,r,i=s.onChange,l=s.value,m=s.children,g=s.caption,v=s.className,D=s.style,S=Ke(),j=(r=(t=S.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:Eb;return e.jsxs("div",{className:v,style:D,children:[e.jsx("span",{className:S.classNames.vhidden,children:s["aria-label"]}),e.jsx("select",{name:s.name,"aria-label":s["aria-label"],className:S.classNames.dropdown,style:S.styles.dropdown,value:l,onChange:i,children:m}),e.jsxs("div",{className:S.classNames.caption_label,style:S.styles.caption_label,"aria-hidden":"true",children:[g,e.jsx(j,{className:S.classNames.dropdown_icon,style:S.styles.dropdown_icon})]})]})}function Mb(s){var t,r=Ke(),i=r.fromDate,l=r.toDate,m=r.styles,g=r.locale,v=r.formatters.formatMonthCaption,D=r.classNames,S=r.components,j=r.labels.labelMonthDropdown;if(!i)return e.jsx(e.Fragment,{});if(!l)return e.jsx(e.Fragment,{});var A=[];if(Ly(i,l))for(var E=Jt(i),P=i.getMonth();P<=l.getMonth();P++)A.push(ql(E,P));else for(var E=Jt(new Date),P=0;P<=11;P++)A.push(ql(E,P));var x=function(F){var ne=Number(F.target.value),K=ql(Jt(s.displayMonth),ne);s.onChange(K)},q=(t=S==null?void 0:S.Dropdown)!==null&&t!==void 0?t:oh;return e.jsx(q,{name:"months","aria-label":j(),className:D.dropdown_month,style:m.dropdown_month,onChange:x,value:s.displayMonth.getMonth(),caption:v(s.displayMonth,{locale:g}),children:A.map(function(F){return e.jsx("option",{value:F.getMonth(),children:v(F,{locale:g})},F.getMonth())})})}function Rb(s){var t,r=s.displayMonth,i=Ke(),l=i.fromDate,m=i.toDate,g=i.locale,v=i.styles,D=i.classNames,S=i.components,j=i.formatters.formatYearCaption,A=i.labels.labelYearDropdown,E=[];if(!l)return e.jsx(e.Fragment,{});if(!m)return e.jsx(e.Fragment,{});for(var P=l.getFullYear(),x=m.getFullYear(),q=P;q<=x;q++)E.push(ym(Hm(new Date),q));var F=function(K){var U=ym(Jt(r),Number(K.target.value));s.onChange(U)},ne=(t=S==null?void 0:S.Dropdown)!==null&&t!==void 0?t:oh;return e.jsx(ne,{name:"years","aria-label":A(),className:D.dropdown_year,style:v.dropdown_year,onChange:F,value:r.getFullYear(),caption:j(r,{locale:g}),children:E.map(function(K){return e.jsx("option",{value:K.getFullYear(),children:j(K,{locale:g})},K.getFullYear())})})}function Wb(s,t){var r=d.useState(s),i=r[0],l=r[1],m=t===void 0?i:t;return[m,l]}function Lb(s){var t=s.month,r=s.defaultMonth,i=s.today,l=t||r||i||new Date,m=s.toDate,g=s.fromDate,v=s.numberOfMonths,D=v===void 0?1:v;if(m&&fn(m,l)<0){var S=-1*(D-1);l=pa(m,S)}return g&&fn(l,g)<0&&(l=g),Jt(l)}function Fb(){var s=Ke(),t=Lb(s),r=Wb(t,s.month),i=r[0],l=r[1],m=function(g){var v;if(!s.disableNavigation){var D=Jt(g);l(D),(v=s.onMonthChange)===null||v===void 0||v.call(s,D)}};return[i,m]}function Bb(s,t){for(var r=t.reverseMonths,i=t.numberOfMonths,l=Jt(s),m=Jt(pa(l,i)),g=fn(m,l),v=[],D=0;D<g;D++){var S=pa(l,D);v.push(S)}return r&&(v=v.reverse()),v}function $b(s,t){if(!t.disableNavigation){var r=t.toDate,i=t.pagedNavigation,l=t.numberOfMonths,m=l===void 0?1:l,g=i?m:1,v=Jt(s);if(!r)return pa(v,g);var D=fn(r,s);if(!(D<m))return pa(v,g)}}function Ub(s,t){if(!t.disableNavigation){var r=t.fromDate,i=t.pagedNavigation,l=t.numberOfMonths,m=l===void 0?1:l,g=i?m:1,v=Jt(s);if(!r)return pa(v,-g);var D=fn(v,r);if(!(D<=0))return pa(v,-g)}}var lh=d.createContext(void 0);function Vb(s){var t=Ke(),r=Fb(),i=r[0],l=r[1],m=Bb(i,t),g=$b(i,t),v=Ub(i,t),D=function(A){return m.some(function(E){return dc(A,E)})},S=function(A,E){D(A)||(E&&sh(A,E)?l(pa(A,1+t.numberOfMonths*-1)):l(A))},j={currentMonth:i,displayMonths:m,goToMonth:l,goToDate:S,previousMonth:v,nextMonth:g,isDateDisplayed:D};return e.jsx(lh.Provider,{value:j,children:s.children})}function vn(){var s=d.useContext(lh);if(!s)throw new Error("useNavigation must be used within a NavigationProvider");return s}function vm(s){var t,r=Ke(),i=r.classNames,l=r.styles,m=r.components,g=vn().goToMonth,v=function(j){g(pa(j,s.displayIndex?-s.displayIndex:0))},D=(t=m==null?void 0:m.CaptionLabel)!==null&&t!==void 0?t:ih,S=e.jsx(D,{id:s.id,displayMonth:s.displayMonth});return e.jsxs("div",{className:i.caption_dropdowns,style:l.caption_dropdowns,children:[e.jsx("div",{className:i.vhidden,children:S}),e.jsx(Mb,{onChange:v,displayMonth:s.displayMonth}),e.jsx(Rb,{onChange:v,displayMonth:s.displayMonth})]})}function qb(s){return e.jsx("svg",fe({width:"16px",height:"16px",viewBox:"0 0 120 120"},s,{children:e.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function zb(s){return e.jsx("svg",fe({width:"16px",height:"16px",viewBox:"0 0 120 120"},s,{children:e.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Li=d.forwardRef(function(s,t){var r=Ke(),i=r.classNames,l=r.styles,m=[i.button_reset,i.button];s.className&&m.push(s.className);var g=m.join(" "),v=fe(fe({},l.button_reset),l.button);return s.style&&Object.assign(v,s.style),e.jsx("button",fe({},s,{ref:t,type:"button",className:g,style:v}))});function Yb(s){var t,r,i=Ke(),l=i.dir,m=i.locale,g=i.classNames,v=i.styles,D=i.labels,S=D.labelPrevious,j=D.labelNext,A=i.components;if(!s.nextMonth&&!s.previousMonth)return e.jsx(e.Fragment,{});var E=S(s.previousMonth,{locale:m}),P=[g.nav_button,g.nav_button_previous].join(" "),x=j(s.nextMonth,{locale:m}),q=[g.nav_button,g.nav_button_next].join(" "),F=(t=A==null?void 0:A.IconRight)!==null&&t!==void 0?t:zb,ne=(r=A==null?void 0:A.IconLeft)!==null&&r!==void 0?r:qb;return e.jsxs("div",{className:g.nav,style:v.nav,children:[!s.hidePrevious&&e.jsx(Li,{name:"previous-month","aria-label":E,className:P,style:v.nav_button_previous,disabled:!s.previousMonth,onClick:s.onPreviousClick,children:l==="rtl"?e.jsx(F,{className:g.nav_icon,style:v.nav_icon}):e.jsx(ne,{className:g.nav_icon,style:v.nav_icon})}),!s.hideNext&&e.jsx(Li,{name:"next-month","aria-label":x,className:q,style:v.nav_button_next,disabled:!s.nextMonth,onClick:s.onNextClick,children:l==="rtl"?e.jsx(ne,{className:g.nav_icon,style:v.nav_icon}):e.jsx(F,{className:g.nav_icon,style:v.nav_icon})})]})}function wm(s){var t=Ke().numberOfMonths,r=vn(),i=r.previousMonth,l=r.nextMonth,m=r.goToMonth,g=r.displayMonths,v=g.findIndex(function(x){return dc(s.displayMonth,x)}),D=v===0,S=v===g.length-1,j=t>1&&(D||!S),A=t>1&&(S||!D),E=function(){i&&m(i)},P=function(){l&&m(l)};return e.jsx(Yb,{displayMonth:s.displayMonth,hideNext:j,hidePrevious:A,nextMonth:l,previousMonth:i,onPreviousClick:E,onNextClick:P})}function Kb(s){var t,r=Ke(),i=r.classNames,l=r.disableNavigation,m=r.styles,g=r.captionLayout,v=r.components,D=(t=v==null?void 0:v.CaptionLabel)!==null&&t!==void 0?t:ih,S;return l?S=e.jsx(D,{id:s.id,displayMonth:s.displayMonth}):g==="dropdown"?S=e.jsx(vm,{displayMonth:s.displayMonth,id:s.id}):g==="dropdown-buttons"?S=e.jsxs(e.Fragment,{children:[e.jsx(vm,{displayMonth:s.displayMonth,displayIndex:s.displayIndex,id:s.id}),e.jsx(wm,{displayMonth:s.displayMonth,displayIndex:s.displayIndex,id:s.id})]}):S=e.jsxs(e.Fragment,{children:[e.jsx(D,{id:s.id,displayMonth:s.displayMonth,displayIndex:s.displayIndex}),e.jsx(wm,{displayMonth:s.displayMonth,id:s.id})]}),e.jsx("div",{className:i.caption,style:m.caption,children:S})}function Jb(s){var t=Ke(),r=t.footer,i=t.styles,l=t.classNames.tfoot;return r?e.jsx("tfoot",{className:l,style:i.tfoot,children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:r})})}):e.jsx(e.Fragment,{})}function Hb(s,t,r){for(var i=r?Ss(new Date):Ca(new Date,{locale:s,weekStartsOn:t}),l=[],m=0;m<7;m++){var g=$t(i,m);l.push(g)}return l}function Qb(){var s=Ke(),t=s.classNames,r=s.styles,i=s.showWeekNumber,l=s.locale,m=s.weekStartsOn,g=s.ISOWeek,v=s.formatters.formatWeekdayName,D=s.labels.labelWeekday,S=Hb(l,m,g);return e.jsxs("tr",{style:r.head_row,className:t.head_row,children:[i&&e.jsx("td",{style:r.head_cell,className:t.head_cell}),S.map(function(j,A){return e.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":D(j,{locale:l}),children:v(j,{locale:l})},A)})]})}function Gb(){var s,t=Ke(),r=t.classNames,i=t.styles,l=t.components,m=(s=l==null?void 0:l.HeadRow)!==null&&s!==void 0?s:Qb;return e.jsx("thead",{style:i.head,className:r.head,children:e.jsx(m,{})})}function Xb(s){var t=Ke(),r=t.locale,i=t.formatters.formatDay;return e.jsx(e.Fragment,{children:i(s.date,{locale:r})})}var uc=d.createContext(void 0);function Zb(s){if(!yn(s.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return e.jsx(uc.Provider,{value:t,children:s.children})}return e.jsx(ev,{initialProps:s.initialProps,children:s.children})}function ev(s){var t=s.initialProps,r=s.children,i=t.selected,l=t.min,m=t.max,g=function(S,j,A){var E,P;(E=t.onDayClick)===null||E===void 0||E.call(t,S,j,A);var x=!!(j.selected&&l&&(i==null?void 0:i.length)===l);if(!x){var q=!!(!j.selected&&m&&(i==null?void 0:i.length)===m);if(!q){var F=i?rh([],i):[];if(j.selected){var ne=F.findIndex(function(K){return Kt(S,K)});F.splice(ne,1)}else F.push(S);(P=t.onSelect)===null||P===void 0||P.call(t,F,S,j,A)}}},v={disabled:[]};i&&v.disabled.push(function(S){var j=m&&i.length>m-1,A=i.some(function(E){return Kt(E,S)});return!!(j&&!A)});var D={selected:i,onDayClick:g,modifiers:v};return e.jsx(uc.Provider,{value:D,children:r})}function mc(){var s=d.useContext(uc);if(!s)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return s}function tv(s,t){var r=t||{},i=r.from,l=r.to;return i&&l?Kt(l,s)&&Kt(i,s)?void 0:Kt(l,s)?{from:l,to:void 0}:Kt(i,s)?void 0:Xl(i,s)?{from:s,to:l}:{from:i,to:s}:l?Xl(s,l)?{from:l,to:s}:{from:s,to:l}:i?sh(s,i)?{from:s,to:i}:{from:i,to:s}:{from:s,to:void 0}}var hc=d.createContext(void 0);function av(s){if(!bn(s.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return e.jsx(hc.Provider,{value:t,children:s.children})}return e.jsx(sv,{initialProps:s.initialProps,children:s.children})}function sv(s){var t=s.initialProps,r=s.children,i=t.selected,l=i||{},m=l.from,g=l.to,v=t.min,D=t.max,S=function(P,x,q){var F,ne;(F=t.onDayClick)===null||F===void 0||F.call(t,P,x,q);var K=tv(P,i);(ne=t.onSelect)===null||ne===void 0||ne.call(t,K,P,x,q)},j={range_start:[],range_end:[],range_middle:[],disabled:[]};if(m?(j.range_start=[m],g?(j.range_end=[g],Kt(m,g)||(j.range_middle=[{after:m,before:g}])):j.range_end=[m]):g&&(j.range_start=[g],j.range_end=[g]),v&&(m&&!g&&j.disabled.push({after:Vl(m,v-1),before:$t(m,v-1)}),m&&g&&j.disabled.push({after:m,before:$t(m,v-1)}),!m&&g&&j.disabled.push({after:Vl(g,v-1),before:$t(g,v-1)})),D){if(m&&!g&&(j.disabled.push({before:$t(m,-D+1)}),j.disabled.push({after:$t(m,D-1)})),m&&g){var A=ka(g,m)+1,E=D-A;j.disabled.push({before:Vl(m,E)}),j.disabled.push({after:$t(g,E)})}!m&&g&&(j.disabled.push({before:$t(g,-D+1)}),j.disabled.push({after:$t(g,D-1)}))}return e.jsx(hc.Provider,{value:{selected:i,onDayClick:S,modifiers:j},children:r})}function fc(){var s=d.useContext(hc);if(!s)throw new Error("useSelectRange must be used within a SelectRangeProvider");return s}function Oi(s){return Array.isArray(s)?rh([],s):s!==void 0?[s]:[]}function rv(s){var t={};return Object.entries(s).forEach(function(r){var i=r[0],l=r[1];t[i]=Oi(l)}),t}var xa;(function(s){s.Outside="outside",s.Disabled="disabled",s.Selected="selected",s.Hidden="hidden",s.Today="today",s.RangeStart="range_start",s.RangeEnd="range_end",s.RangeMiddle="range_middle"})(xa||(xa={}));var nv=xa.Selected,Ra=xa.Disabled,iv=xa.Hidden,ov=xa.Today,zl=xa.RangeEnd,Yl=xa.RangeMiddle,Kl=xa.RangeStart,lv=xa.Outside;function cv(s,t,r){var i,l=(i={},i[nv]=Oi(s.selected),i[Ra]=Oi(s.disabled),i[iv]=Oi(s.hidden),i[ov]=[s.today],i[zl]=[],i[Yl]=[],i[Kl]=[],i[lv]=[],i);return s.fromDate&&l[Ra].push({before:s.fromDate}),s.toDate&&l[Ra].push({after:s.toDate}),yn(s)?l[Ra]=l[Ra].concat(t.modifiers[Ra]):bn(s)&&(l[Ra]=l[Ra].concat(r.modifiers[Ra]),l[Kl]=r.modifiers[Kl],l[Yl]=r.modifiers[Yl],l[zl]=r.modifiers[zl]),l}var ch=d.createContext(void 0);function dv(s){var t=Ke(),r=mc(),i=fc(),l=cv(t,r,i),m=rv(t.modifiers),g=fe(fe({},l),m);return e.jsx(ch.Provider,{value:g,children:s.children})}function dh(){var s=d.useContext(ch);if(!s)throw new Error("useModifiers must be used within a ModifiersProvider");return s}function uv(s){return!!(s&&typeof s=="object"&&"before"in s&&"after"in s)}function mv(s){return!!(s&&typeof s=="object"&&"from"in s)}function hv(s){return!!(s&&typeof s=="object"&&"after"in s)}function fv(s){return!!(s&&typeof s=="object"&&"before"in s)}function gv(s){return!!(s&&typeof s=="object"&&"dayOfWeek"in s)}function pv(s,t){var r,i=t.from,l=t.to;if(i&&l){var m=ka(l,i)<0;m&&(r=[l,i],i=r[0],l=r[1]);var g=ka(s,i)>=0&&ka(l,s)>=0;return g}return l?Kt(l,s):i?Kt(i,s):!1}function xv(s){return oc(s)}function yv(s){return Array.isArray(s)&&s.every(oc)}function bv(s,t){return t.some(function(r){if(typeof r=="boolean")return r;if(xv(r))return Kt(s,r);if(yv(r))return r.includes(s);if(mv(r))return pv(s,r);if(gv(r))return r.dayOfWeek.includes(s.getDay());if(uv(r)){var i=ka(r.before,s),l=ka(r.after,s),m=i>0,g=l<0,v=Xl(r.before,r.after);return v?g&&m:m||g}return hv(r)?ka(s,r.after)>0:fv(r)?ka(r.before,s)>0:typeof r=="function"?r(s):!1})}function gc(s,t,r){var i=Object.keys(t).reduce(function(m,g){var v=t[g];return bv(s,v)&&m.push(g),m},[]),l={};return i.forEach(function(m){return l[m]=!0}),r&&!dc(s,r)&&(l.outside=!0),l}function vv(s,t){for(var r=Jt(s[0]),i=lc(s[s.length-1]),l,m,g=r;g<=i;){var v=gc(g,t),D=!v.disabled&&!v.hidden;if(!D){g=$t(g,1);continue}if(v.selected)return g;v.today&&!m&&(m=g),l||(l=g),g=$t(g,1)}return m||l}var wv=365;function uh(s,t){var r=t.moveBy,i=t.direction,l=t.context,m=t.modifiers,g=t.retry,v=g===void 0?{count:0,lastFocused:s}:g,D=l.weekStartsOn,S=l.fromDate,j=l.toDate,A=l.locale,E={day:$t,week:Gl,month:pa,year:Mx,startOfWeek:function(F){return l.ISOWeek?Ss(F):Ca(F,{locale:A,weekStartsOn:D})},endOfWeek:function(F){return l.ISOWeek?Qm(F):cc(F,{locale:A,weekStartsOn:D})}},P=E[r](s,i==="after"?1:-1);i==="before"&&S?P=Rx([S,P]):i==="after"&&j&&(P=Wx([j,P]));var x=!0;if(m){var q=gc(P,m);x=!q.disabled&&!q.hidden}return x?P:v.count>wv?v.lastFocused:uh(P,{moveBy:r,direction:i,context:l,modifiers:m,retry:fe(fe({},v),{count:v.count+1})})}var mh=d.createContext(void 0);function Nv(s){var t=vn(),r=dh(),i=d.useState(),l=i[0],m=i[1],g=d.useState(),v=g[0],D=g[1],S=vv(t.displayMonths,r),j=l??(v&&t.isDateDisplayed(v))?v:S,A=function(){D(l),m(void 0)},E=function(F){m(F)},P=Ke(),x=function(F,ne){if(l){var K=uh(l,{moveBy:F,direction:ne,context:P,modifiers:r});Kt(l,K)||(t.goToDate(K,l),E(K))}},q={focusedDay:l,focusTarget:j,blur:A,focus:E,focusDayAfter:function(){return x("day","after")},focusDayBefore:function(){return x("day","before")},focusWeekAfter:function(){return x("week","after")},focusWeekBefore:function(){return x("week","before")},focusMonthBefore:function(){return x("month","before")},focusMonthAfter:function(){return x("month","after")},focusYearBefore:function(){return x("year","before")},focusYearAfter:function(){return x("year","after")},focusStartOfWeek:function(){return x("startOfWeek","before")},focusEndOfWeek:function(){return x("endOfWeek","after")}};return e.jsx(mh.Provider,{value:q,children:s.children})}function pc(){var s=d.useContext(mh);if(!s)throw new Error("useFocusContext must be used within a FocusProvider");return s}function jv(s,t){var r=dh(),i=gc(s,r,t);return i}var xc=d.createContext(void 0);function Sv(s){if(!$i(s.initialProps)){var t={selected:void 0};return e.jsx(xc.Provider,{value:t,children:s.children})}return e.jsx(Dv,{initialProps:s.initialProps,children:s.children})}function Dv(s){var t=s.initialProps,r=s.children,i=function(m,g,v){var D,S,j;if((D=t.onDayClick)===null||D===void 0||D.call(t,m,g,v),g.selected&&!t.required){(S=t.onSelect)===null||S===void 0||S.call(t,void 0,m,g,v);return}(j=t.onSelect)===null||j===void 0||j.call(t,m,m,g,v)},l={selected:t.selected,onDayClick:i};return e.jsx(xc.Provider,{value:l,children:r})}function hh(){var s=d.useContext(xc);if(!s)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return s}function kv(s,t){var r=Ke(),i=hh(),l=mc(),m=fc(),g=pc(),v=g.focusDayAfter,D=g.focusDayBefore,S=g.focusWeekAfter,j=g.focusWeekBefore,A=g.blur,E=g.focus,P=g.focusMonthBefore,x=g.focusMonthAfter,q=g.focusYearBefore,F=g.focusYearAfter,ne=g.focusStartOfWeek,K=g.focusEndOfWeek,U=function(H){var Z,yt,bt,gt;$i(r)?(Z=i.onDayClick)===null||Z===void 0||Z.call(i,s,t,H):yn(r)?(yt=l.onDayClick)===null||yt===void 0||yt.call(l,s,t,H):bn(r)?(bt=m.onDayClick)===null||bt===void 0||bt.call(m,s,t,H):(gt=r.onDayClick)===null||gt===void 0||gt.call(r,s,t,H)},ee=function(H){var Z;E(s),(Z=r.onDayFocus)===null||Z===void 0||Z.call(r,s,t,H)},Ie=function(H){var Z;A(),(Z=r.onDayBlur)===null||Z===void 0||Z.call(r,s,t,H)},we=function(H){var Z;(Z=r.onDayMouseEnter)===null||Z===void 0||Z.call(r,s,t,H)},Ne=function(H){var Z;(Z=r.onDayMouseLeave)===null||Z===void 0||Z.call(r,s,t,H)},xe=function(H){var Z;(Z=r.onDayPointerEnter)===null||Z===void 0||Z.call(r,s,t,H)},ae=function(H){var Z;(Z=r.onDayPointerLeave)===null||Z===void 0||Z.call(r,s,t,H)},Le=function(H){var Z;(Z=r.onDayTouchCancel)===null||Z===void 0||Z.call(r,s,t,H)},Be=function(H){var Z;(Z=r.onDayTouchEnd)===null||Z===void 0||Z.call(r,s,t,H)},Ve=function(H){var Z;(Z=r.onDayTouchMove)===null||Z===void 0||Z.call(r,s,t,H)},ct=function(H){var Z;(Z=r.onDayTouchStart)===null||Z===void 0||Z.call(r,s,t,H)},Ut=function(H){var Z;(Z=r.onDayKeyUp)===null||Z===void 0||Z.call(r,s,t,H)},Me=function(H){var Z;switch(H.key){case"ArrowLeft":H.preventDefault(),H.stopPropagation(),r.dir==="rtl"?v():D();break;case"ArrowRight":H.preventDefault(),H.stopPropagation(),r.dir==="rtl"?D():v();break;case"ArrowDown":H.preventDefault(),H.stopPropagation(),S();break;case"ArrowUp":H.preventDefault(),H.stopPropagation(),j();break;case"PageUp":H.preventDefault(),H.stopPropagation(),H.shiftKey?q():P();break;case"PageDown":H.preventDefault(),H.stopPropagation(),H.shiftKey?F():x();break;case"Home":H.preventDefault(),H.stopPropagation(),ne();break;case"End":H.preventDefault(),H.stopPropagation(),K();break}(Z=r.onDayKeyDown)===null||Z===void 0||Z.call(r,s,t,H)},st={onClick:U,onFocus:ee,onBlur:Ie,onKeyDown:Me,onKeyUp:Ut,onMouseEnter:we,onMouseLeave:Ne,onPointerEnter:xe,onPointerLeave:ae,onTouchCancel:Le,onTouchEnd:Be,onTouchMove:Ve,onTouchStart:ct};return st}function Cv(){var s=Ke(),t=hh(),r=mc(),i=fc(),l=$i(s)?t.selected:yn(s)?r.selected:bn(s)?i.selected:void 0;return l}function Iv(s){return Object.values(xa).includes(s)}function _v(s,t){var r=[s.classNames.day];return Object.keys(t).forEach(function(i){var l=s.modifiersClassNames[i];if(l)r.push(l);else if(Iv(i)){var m=s.classNames["day_".concat(i)];m&&r.push(m)}}),r}function Av(s,t){var r=fe({},s.styles.day);return Object.keys(t).forEach(function(i){var l;r=fe(fe({},r),(l=s.modifiersStyles)===null||l===void 0?void 0:l[i])}),r}function Tv(s,t,r){var i,l,m,g=Ke(),v=pc(),D=jv(s,t),S=kv(s,D),j=Cv(),A=!!(g.onDayClick||g.mode!=="default");d.useEffect(function(){var we;D.outside||v.focusedDay&&A&&Kt(v.focusedDay,s)&&((we=r.current)===null||we===void 0||we.focus())},[v.focusedDay,s,r,A,D.outside]);var E=_v(g,D).join(" "),P=Av(g,D),x=!!(D.outside&&!g.showOutsideDays||D.hidden),q=(m=(l=g.components)===null||l===void 0?void 0:l.DayContent)!==null&&m!==void 0?m:Xb,F=e.jsx(q,{date:s,displayMonth:t,activeModifiers:D}),ne={style:P,className:E,children:F,role:"gridcell"},K=v.focusTarget&&Kt(v.focusTarget,s)&&!D.outside,U=v.focusedDay&&Kt(v.focusedDay,s),ee=fe(fe(fe({},ne),(i={disabled:D.disabled,role:"gridcell"},i["aria-selected"]=D.selected,i.tabIndex=U||K?0:-1,i)),S),Ie={isButton:A,isHidden:x,activeModifiers:D,selectedDays:j,buttonProps:ee,divProps:ne};return Ie}function Pv(s){var t=d.useRef(null),r=Tv(s.date,s.displayMonth,t);return r.isHidden?e.jsx("div",{role:"gridcell"}):r.isButton?e.jsx(Li,fe({name:"day",ref:t},r.buttonProps)):e.jsx("div",fe({},r.divProps))}function Ov(s){var t=s.number,r=s.dates,i=Ke(),l=i.onWeekNumberClick,m=i.styles,g=i.classNames,v=i.locale,D=i.labels.labelWeekNumber,S=i.formatters.formatWeekNumber,j=S(Number(t),{locale:v});if(!l)return e.jsx("span",{className:g.weeknumber,style:m.weeknumber,children:j});var A=D(Number(t),{locale:v}),E=function(P){l(t,r,P)};return e.jsx(Li,{name:"week-number","aria-label":A,className:g.weeknumber,style:m.weeknumber,onClick:E,children:j})}function Ev(s){var t,r,i=Ke(),l=i.styles,m=i.classNames,g=i.showWeekNumber,v=i.components,D=(t=v==null?void 0:v.Day)!==null&&t!==void 0?t:Pv,S=(r=v==null?void 0:v.WeekNumber)!==null&&r!==void 0?r:Ov,j;return g&&(j=e.jsx("td",{className:m.cell,style:l.cell,children:e.jsx(S,{number:s.weekNumber,dates:s.dates})})),e.jsxs("tr",{className:m.row,style:l.row,children:[j,s.dates.map(function(A){return e.jsx("td",{className:m.cell,style:l.cell,role:"presentation",children:e.jsx(D,{displayMonth:s.displayMonth,date:A})},My(A))})]})}function Nm(s,t,r){for(var i=r!=null&&r.ISOWeek?Qm(t):cc(t,r),l=r!=null&&r.ISOWeek?Ss(s):Ca(s,r),m=ka(i,l),g=[],v=0;v<=m;v++)g.push($t(l,v));var D=g.reduce(function(S,j){var A=r!=null&&r.ISOWeek?Zm(j):th(j,r),E=S.find(function(P){return P.weekNumber===A});return E?(E.dates.push(j),S):(S.push({weekNumber:A,dates:[j]}),S)},[]);return D}function Mv(s,t){var r=Nm(Jt(s),lc(s),t);if(t!=null&&t.useFixedWeeks){var i=Wy(s,t);if(i<6){var l=r[r.length-1],m=l.dates[l.dates.length-1],g=Gl(m,6-i),v=Nm(Gl(m,1),g,t);r.push.apply(r,v)}}return r}function Rv(s){var t,r,i,l=Ke(),m=l.locale,g=l.classNames,v=l.styles,D=l.hideHead,S=l.fixedWeeks,j=l.components,A=l.weekStartsOn,E=l.firstWeekContainsDate,P=l.ISOWeek,x=Mv(s.displayMonth,{useFixedWeeks:!!S,ISOWeek:P,locale:m,weekStartsOn:A,firstWeekContainsDate:E}),q=(t=j==null?void 0:j.Head)!==null&&t!==void 0?t:Gb,F=(r=j==null?void 0:j.Row)!==null&&r!==void 0?r:Ev,ne=(i=j==null?void 0:j.Footer)!==null&&i!==void 0?i:Jb;return e.jsxs("table",{id:s.id,className:g.table,style:v.table,role:"grid","aria-labelledby":s["aria-labelledby"],children:[!D&&e.jsx(q,{}),e.jsx("tbody",{className:g.tbody,style:v.tbody,children:x.map(function(K){return e.jsx(F,{displayMonth:s.displayMonth,dates:K.dates,weekNumber:K.weekNumber},K.weekNumber)})}),e.jsx(ne,{displayMonth:s.displayMonth})]})}function Wv(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Lv=Wv()?d.useLayoutEffect:d.useEffect,Jl=!1,Fv=0;function jm(){return"react-day-picker-".concat(++Fv)}function Bv(s){var t,r=s??(Jl?jm():null),i=d.useState(r),l=i[0],m=i[1];return Lv(function(){l===null&&m(jm())},[]),d.useEffect(function(){Jl===!1&&(Jl=!0)},[]),(t=s??l)!==null&&t!==void 0?t:void 0}function $v(s){var t,r,i=Ke(),l=i.dir,m=i.classNames,g=i.styles,v=i.components,D=vn().displayMonths,S=Bv(i.id?"".concat(i.id,"-").concat(s.displayIndex):void 0),j=i.id?"".concat(i.id,"-grid-").concat(s.displayIndex):void 0,A=[m.month],E=g.month,P=s.displayIndex===0,x=s.displayIndex===D.length-1,q=!P&&!x;l==="rtl"&&(t=[P,x],x=t[0],P=t[1]),P&&(A.push(m.caption_start),E=fe(fe({},E),g.caption_start)),x&&(A.push(m.caption_end),E=fe(fe({},E),g.caption_end)),q&&(A.push(m.caption_between),E=fe(fe({},E),g.caption_between));var F=(r=v==null?void 0:v.Caption)!==null&&r!==void 0?r:Kb;return e.jsxs("div",{className:A.join(" "),style:E,children:[e.jsx(F,{id:S,displayMonth:s.displayMonth,displayIndex:s.displayIndex}),e.jsx(Rv,{id:j,"aria-labelledby":S,displayMonth:s.displayMonth})]},s.displayIndex)}function Uv(s){var t=Ke(),r=t.classNames,i=t.styles;return e.jsx("div",{className:r.months,style:i.months,children:s.children})}function Vv(s){var t,r,i=s.initialProps,l=Ke(),m=pc(),g=vn(),v=d.useState(!1),D=v[0],S=v[1];d.useEffect(function(){l.initialFocus&&m.focusTarget&&(D||(m.focus(m.focusTarget),S(!0)))},[l.initialFocus,D,m.focus,m.focusTarget,m]);var j=[l.classNames.root,l.className];l.numberOfMonths>1&&j.push(l.classNames.multiple_months),l.showWeekNumber&&j.push(l.classNames.with_weeknumber);var A=fe(fe({},l.styles.root),l.style),E=Object.keys(i).filter(function(x){return x.startsWith("data-")}).reduce(function(x,q){var F;return fe(fe({},x),(F={},F[q]=i[q],F))},{}),P=(r=(t=i.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:Uv;return e.jsx("div",fe({className:j.join(" "),style:A,dir:l.dir,id:l.id,nonce:i.nonce,title:i.title,lang:i.lang},E,{children:e.jsx(P,{children:g.displayMonths.map(function(x,q){return e.jsx($v,{displayIndex:q,displayMonth:x},q)})})}))}function qv(s){var t=s.children,r=fb(s,["children"]);return e.jsx(Ob,{initialProps:r,children:e.jsx(Vb,{children:e.jsx(Sv,{initialProps:r,children:e.jsx(Zb,{initialProps:r,children:e.jsx(av,{initialProps:r,children:e.jsx(dv,{children:e.jsx(Nv,{children:t})})})})})})})}function zv(s){return e.jsx(qv,fe({},s,{children:e.jsx(Vv,{initialProps:s})}))}function Zl({className:s,classNames:t,showOutsideDays:r=!0,...i}){return e.jsx(zv,{showOutsideDays:r,className:Da("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Da(zu({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Da(zu({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...l})=>e.jsx(Jp,{className:"h-4 w-4"}),IconRight:({...l})=>e.jsx(Tp,{className:"h-4 w-4"})},...i})}Zl.displayName="Calendar";const Sm={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"0.0.0",VITE_DEV_MODE:"true",VITE_ENABLE_OFFLINE_PERSISTENCE:"false",VITE_FIREBASE_API_KEY:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),VITE_FIREBASE_APP_ID:"1:483702062341:web:b1ff06ad175cb7ae428b6c",VITE_FIREBASE_AUTH_DOMAIN:"voda-c6abd.firebaseapp.com",VITE_FIREBASE_AUTH_EMULATOR_URL:"http://localhost:9099",VITE_FIREBASE_FIRESTORE_EMULATOR_HOST:"localhost:8080",VITE_FIREBASE_FUNCTIONS_EMULATOR_HOST:"localhost:5001",VITE_FIREBASE_MEASUREMENT_ID:"G-CV6QGH7G7P",VITE_FIREBASE_MESSAGING_SENDER_ID:"483702062341",VITE_FIREBASE_PROJECT_ID:"voda-c6abd",VITE_FIREBASE_STORAGE_BUCKET:"voda-c6abd.appspot.com",VITE_FORCE_HASH_ROUTER:"true",VITE_SHOP_ID:"demo-shop-001",VITE_SHOP_NAME:"Ù…Ø­Ù„ ÙƒØ§Ø´ÙŠ Ù„ÙŠÙ†Ùƒ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ",VITE_SHOW_ENV_BANNER:"true",VITE_USE_EMULATORS:"false",VITE_USE_FIREBASE_EMULATOR:"false"},as=s=>typeof s=="string"&&s.trim().length>0,Yv={getCurrentMonthId(){const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`},async getWalletUsage(s){var t;try{if(!as(s))return console.error("Error getting wallet usage: invalid walletId",s),null;const r=Pe($,"walletLimits",s),i=await la(r);if(i.exists()){const m=i.data();return{walletId:s,used_transfer:m.monthlyTransferUsed??m.used_transfer??0,used_withdraw:m.monthlyWithdrawUsed??m.used_withdraw??0,monthly_limit:m.monthlyLimit??m.monthlyTransferLimit??m.monthlyWithdrawLimit??2e5,last_reset:m.lastMonthlyReset??m.last_reset??null,updatedAt:m.updatedAt||bs.now()}}const l={walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:2e5,last_reset:null,updatedAt:bs.now()};return await sa(r,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,monthlyTransferLimit:2e5,monthlyWithdrawLimit:2e5,lastMonthlyReset:null,updatedAt:ft(),ownerId:(t=sr.currentUser)==null?void 0:t.uid}),l}catch(r){return console.error("Error getting wallet usage:",r),{walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:2e5,last_reset:null,updatedAt:bs.now()}}},shouldResetLimits(s){const t=new Date,r=t.getDate();if(!s)return r===1;if(r===1){const i=s.toDate(),l=t.getMonth(),m=t.getFullYear();return i.getMonth()!==l||i.getFullYear()!==m}return!1},async autoResetLimitsIfNeeded(s){try{if(!as(s))return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),!1;typeof import.meta<"u";const t=await this.getWalletUsage(s);return t&&this.shouldResetLimits(t.last_reset)?(console.log(`ðŸ”„ ØªØµÙÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯ Ù„Ù„Ù…Ø­ÙØ¸Ø© ${s} - Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø£ÙˆÙ„ Ù…Ù† Ø§Ù„Ø´Ù‡Ø±`),await this.resetWalletUsage(s)):!1}catch(t){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯:",t),!1}},async resetWalletUsage(s){try{if(!as(s))return console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),!1;const t=Pe($,"walletLimits",s);return await sa(t,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:ft(),updatedAt:ft()},{merge:!0}),console.log(`ðŸ”„ ØªÙ… ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${s} Ø¨Ù†Ø¬Ø§Ø­`),!0}catch(t){return console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©:",t),!1}},async calculateUsageFromTransactions(s){var t,r;try{if(!as(s))return console.error("Ø®Ø·Ø£ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),{used_transfer:0,used_withdraw:0};const i=Pe($,"walletLimits",s),l=new Date;let m=bs.fromDate(new Date(l.getFullYear(),l.getMonth(),1));try{const j=await la(i);m=j.exists()?((t=j.data())==null?void 0:t.lastMonthlyReset)??((r=j.data())==null?void 0:r.last_reset)??m:m}catch{}const g=Ee(ce($,"tx"),Y("uid","==",s),...m?[Y("createdAt",">=",m)]:[]),v=await ke(g);let D=0,S=0;return v.forEach(j=>{const A=j.data();A.status==="completed"&&(A.type==="transfer"?D+=A.amount:A.type==="withdraw"&&(S+=A.amount))}),{used_transfer:D,used_withdraw:S}}catch(i){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª:",i),{used_transfer:0,used_withdraw:0}}},async getWalletUsageWithRefresh(s){var t,r;try{if(!as(s))return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠØ«: walletId ØºÙŠØ± ØµØ§Ù„Ø­",s),null;typeof import.meta<"u";const i=await this.getWalletUsage(s);if(!i){const m=await this.calculateUsageFromTransactions(s),g=Pe($,"walletLimits",s);try{await sa(g,{monthlyTransferUsed:m.used_transfer,monthlyWithdrawUsed:m.used_withdraw,updatedAt:ft(),ownerId:(t=sr.currentUser)==null?void 0:t.uid},{merge:!0})}catch{}return{walletId:s,used_transfer:m.used_transfer,used_withdraw:m.used_withdraw,monthly_limit:2e5,last_reset:null,updatedAt:bs.now()}}const l=await this.calculateUsageFromTransactions(s);if(i.used_transfer!==l.used_transfer||i.used_withdraw!==l.used_withdraw){const m=Pe($,"walletLimits",s);try{await sa(m,{monthlyTransferUsed:l.used_transfer,monthlyWithdrawUsed:l.used_withdraw,updatedAt:ft(),ownerId:(r=sr.currentUser)==null?void 0:r.uid},{merge:!0})}catch{}return await this.getWalletUsage(s)}return i}catch(i){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠØ«:",i),{walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:2e5,last_reset:null,updatedAt:bs.now()}}},calculateRemaining(s){return{remainingTransfer:Math.max(0,s.monthly_limit-s.used_transfer),remainingWithdraw:Math.max(0,s.monthly_limit-s.used_withdraw)}},async canPerformOperation(s,t,r){try{if(!as(s))return console.error("Error checking operation limits: invalid walletId",s),{canPerform:!1,message:"walletId ØºÙŠØ± ØµØ§Ù„Ø­"};const i=await this.getWalletUsageWithRefresh(s);if(!i)return{canPerform:!1,message:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù…Ø­ÙØ¸Ø©"};const l=this.calculateRemaining(i);return r==="transfer"&&t>l.remainingTransfer?{canPerform:!1,message:`ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø³Ù…ÙˆØ­. Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${l.remainingTransfer.toLocaleString()} Ø¬.Ù… Ù…Ù† Ø£ØµÙ„ ${i.monthly_limit.toLocaleString()} Ø¬.Ù…`,remaining:l.remainingTransfer}:r==="withdraw"&&t>l.remainingWithdraw?{canPerform:!1,message:`ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…Ø³Ù…ÙˆØ­. Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${l.remainingWithdraw.toLocaleString()} Ø¬.Ù… Ù…Ù† Ø£ØµÙ„ ${i.monthly_limit.toLocaleString()} Ø¬.Ù…`,remaining:l.remainingWithdraw}:{canPerform:!0}}catch(i){return console.error("Error checking operation limits:",i),{canPerform:!1,message:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¯ÙˆØ¯"}}},async updateUsage(s,t,r){var i;try{if(!as(s))throw new Error("walletId ØºÙŠØ± ØµØ§Ù„Ø­");const l=await this.getWalletUsageWithRefresh(s);if(!l)throw new Error("Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù…Ø­ÙØ¸Ø©");const m=await this.canPerformOperation(s,t,r);if(!m.canPerform)throw new Error(m.message||"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©");const g=r==="transfer"?l.used_transfer+t:l.used_transfer,v=r==="withdraw"?l.used_withdraw+t:l.used_withdraw,D=Pe($,"walletLimits",l.walletId);try{await sa(D,{monthlyTransferUsed:g,monthlyWithdrawUsed:v,updatedAt:ft(),ownerId:(i=sr.currentUser)==null?void 0:i.uid},{merge:!0})}catch{}let S=await this.getWalletUsageWithRefresh(s);return S||(S={walletId:s,used_transfer:g,used_withdraw:v,monthly_limit:l.monthly_limit,last_reset:l.last_reset,updatedAt:bs.now()}),S}catch(l){throw console.error("Error updating wallet usage:",l),l}},async resetWalletUsageManually(s){try{if(!as(s))throw new Error("walletId ØºÙŠØ± ØµØ§Ù„Ø­");const t=Pe($,"walletLimits",s),r={walletId:s,used_transfer:0,used_withdraw:0,monthly_limit:0,last_reset:null,updatedAt:new Date};return sa(t,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:ft(),updatedAt:ft()},{merge:!0}).catch(i=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ ØªØµÙÙŠØ± Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Firebase:",i)}),console.log(`âœ… ØªÙ… ØªØµÙÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${s} Ø¨Ù†Ø¬Ø§Ø­`),r}catch(t){throw console.error("Error resetting wallet usage:",t),t}},async getAllWalletsUsage(s){try{const r=(await _i.getByMerchantId(s)).map(l=>this.getWalletUsageWithRefresh(l.id));return(await Promise.all(r)).filter(l=>l!==null)}catch(t){return console.error("Error getting all wallets usage:",t),[]}}};function Kv(s){return s?`readBroadcastIds_${s}`:"readBroadcastIds_guest"}function Jv({className:s}){const{user:t,profile:r,isSubscriptionActive:i}=ac(),l=Am(),[m,g]=d.useState([]),[v,D]=d.useState(new Set),[S,j]=d.useState(!1),[A,E]=d.useState(""),[P,x]=d.useState(!1),[q,F]=d.useState(null),[ne,K]=d.useState("none"),[U,ee]=d.useState(null),[Ie,we]=d.useState(!1),Ne=d.useRef(new Set);d.useRef(!1);const xe=d.useRef(!0),ae=d.useRef(null),Le=d.useRef(null),Be=d.useRef(null),[Ve,ct]=d.useState({position:"fixed",top:0,left:0,zIndex:1e4}),Ut=d.useMemo(()=>{const L=["global"];return t!=null&&t.uid&&L.push(`user:${t.uid}`),r!=null&&r.shopId&&L.push(`shop:${r.shopId}`),L},[t==null?void 0:t.uid,r==null?void 0:r.shopId]),Me=Kv(t==null?void 0:t.uid),st=d.useMemo(()=>{var se;const L=(se=l==null?void 0:l.pathname)==null?void 0:se.includes("/user/pending-approval");return!!(t!=null&&t.uid)&&!L},[t==null?void 0:t.uid,l==null?void 0:l.pathname]);d.useEffect(()=>{try{const L=localStorage.getItem(Me);if(L){const ie=JSON.parse(L);Array.isArray(ie)&&D(new Set(ie.filter(Boolean)))}else D(new Set)}catch(L){console.warn("Failed to load read ids",L),D(new Set)}},[Me]),d.useEffect(()=>{if(!st){g([]);return}xe.current=!0;const L=()=>{Fp(Ut,se=>{if(xe.current){const Ce=Date.now(),ye=60*1e3,vt=se.filter(rt=>{var Ia,_a;const At=(Ia=rt.createdAt)!=null&&Ia.toMillis?rt.createdAt.toMillis():(_a=rt.createdAt)!=null&&_a.seconds?rt.createdAt.seconds*1e3:0;return!(Ce-At<ye)}).map(rt=>rt.id).filter(Boolean);Ne.current=new Set(vt),xe.current=!1}g(se)})};L();const ie=se=>{console.log("ðŸ”” OneSignal Notification received",se);try{const Ce=se.notification||se;if(Ce&&(Ce.title||Ce.body)){const ye={id:`temp_${Date.now()}`,title:Ce.title||"Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯",message:Ce.body||Ce.message||"",audienceKey:"global",active:!0,createdAt:{toMillis:()=>Date.now(),seconds:Math.floor(Date.now()/1e3),nanoseconds:0}};ee(ye),we(!0),ae.current&&clearTimeout(ae.current),ae.current=window.setTimeout(()=>{we(!1),ee(null)},5e3)}}catch(Ce){console.error("Error parsing OneSignal event for instant alert",Ce)}L()};try{const se=window.OneSignal;se&&se.Notifications&&se.Notifications.addEventListener&&se.Notifications.addEventListener("foregroundWillDisplay",ie)}catch(se){console.error("Failed to add OneSignal listener",se)}return()=>{try{const se=window.OneSignal;se&&se.Notifications&&se.Notifications.removeEventListener&&se.Notifications.removeEventListener("foregroundWillDisplay",ie)}catch{}}},[Ut,st]),d.useEffect(()=>{const L=new Set(m.map(se=>se.id).filter(Boolean)),ie=m.filter(se=>se.id&&!Ne.current.has(se.id));ie.length>0&&(ee(ie[0]),we(!0),ae.current&&clearTimeout(ae.current),ae.current=window.setTimeout(()=>{we(!1),ee(null)},5e3)),Ne.current=L},[m]),d.useEffect(()=>()=>{ae.current&&clearTimeout(ae.current)},[]);const H=m.reduce((L,ie)=>L+(ie.id&&!v.has(ie.id)?1:0),0),Z=L=>{if(!L)return;let ie=new Set(v);try{const se=localStorage.getItem(Me);if(se){const Ce=JSON.parse(se);Array.isArray(Ce)&&Ce.forEach(ye=>ie.add(ye))}}catch{}if(!ie.has(L)){ie.add(L),D(ie);try{localStorage.setItem(Me,JSON.stringify(Array.from(ie)))}catch{}}},yt=()=>{const L=m.map(se=>se.id).filter(Boolean);if(L.length===0)return;let ie=new Set(v);try{const se=localStorage.getItem(Me);if(se){const Ce=JSON.parse(se);Array.isArray(Ce)&&Ce.forEach(ye=>ie.add(ye))}}catch{}L.forEach(se=>ie.add(se)),D(ie);try{localStorage.setItem(Me,JSON.stringify(Array.from(ie)))}catch{}},bt=(L,ie)=>{var se;if(L)try{const Ce=((se=Mi)==null?void 0:se.isNativePlatform)&&Mi.getPlatform()==="android",ye=/\.apk(\?|$)/i.test(L);if(Ce&&ye){const vt=`cashy://update?url=${encodeURIComponent(L)}`;window.location.href=vt}else window.open(L,"_blank")}catch{try{window.open(L,"_blank")}catch{}}ie&&Z(ie)},gt=()=>{if(!Le.current||!Be.current)return;const L=Le.current.getBoundingClientRect(),ie=8,se=Be.current.offsetWidth||320,Ce=L.bottom+ie;let ye=L.right-se;const vt=window.innerWidth;ye=Math.min(Math.max(ye,ie),vt-se-ie),ct(rt=>({...rt,top:Ce,left:ye}))};return d.useEffect(()=>{if(!Ie)return;gt();const L=()=>gt();return window.addEventListener("resize",L),window.addEventListener("scroll",L,!0),()=>{window.removeEventListener("resize",L),window.removeEventListener("scroll",L,!0)}},[Ie]),d.useEffect(()=>{if(!(t!=null&&t.uid)){K("none");return}(async()=>{try{const ie=Ee(ce($,"waiting_list"),Y("userId","==",t.uid)),Ce=(await ke(ie)).docs.map(rt=>({id:rt.id,...rt.data()})).sort((rt,At)=>{var _a,ks,ur,qa,os,J;const Va=((ks=(_a=rt==null?void 0:rt.createdAt)==null?void 0:_a.toMillis)==null?void 0:ks.call(_a))??((ur=rt==null?void 0:rt.createdAt)==null?void 0:ur.seconds)*1e3??0;return(((os=(qa=At==null?void 0:At.createdAt)==null?void 0:qa.toMillis)==null?void 0:os.call(qa))??((J=At==null?void 0:At.createdAt)==null?void 0:J.seconds)*1e3??0)-Va});if(Ce.length===0){K("none");return}const ye=Ce[0],vt=(ye==null?void 0:ye.contacted)===!0||(ye==null?void 0:ye.status)==="contacted";K(vt?"contacted":"pending")}catch(ie){console.warn("âš ï¸ ÙØ´Ù„ Ø¬Ù„Ø¨ Ø­Ø§Ù„Ø© waiting_list:",ie),K("none")}})()},[t==null?void 0:t.uid]),st?e.jsxs("div",{className:`relative inline-flex items-center gap-2 ${s||""}`,ref:Le,children:[e.jsxs(Pp,{onOpenChange:L=>{L&&H>0&&yt()},children:[e.jsx(Op,{asChild:!0,children:e.jsxs(I,{variant:"ghost",size:"icon",className:"relative h-10 w-10 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",children:[e.jsx(Ii,{className:`h-5 w-5 transition-colors ${H>0?"text-primary":"text-gray-600 dark:text-gray-300"}`}),H>0&&e.jsx("span",{className:"absolute top-2 right-2 h-4 min-w-[16px] px-0.5 bg-red-600 text-white text-[10px] font-bold flex items-center justify-center rounded-full ring-2 ring-white dark:ring-gray-950 shadow-sm animate-in zoom-in duration-200",children:H>99?"99+":H})]})}),e.jsxs(Ep,{className:"w-96 p-0 rounded-xl shadow-xl border-gray-100 dark:border-gray-800",align:"end",forceMount:!0,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 dark:border-gray-800 bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm",children:[e.jsx("span",{className:"font-bold text-base text-gray-900 dark:text-gray-100",children:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"}),m.length>0&&e.jsxs(I,{variant:"ghost",size:"sm",className:"h-8 text-xs text-primary hover:text-primary hover:bg-primary/5 transition-colors",onClick:yt,children:[e.jsx(Ri,{className:"h-3.5 w-3.5 ml-1.5"}),"ØªÙ…ÙŠÙŠØ² Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡"]})]}),m.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center space-y-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-50 dark:bg-gray-800 flex items-center justify-center",children:e.jsx(Ii,{className:"w-6 h-6 text-gray-300 dark:text-gray-600"})}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù‡Ù†Ø§ ÙÙˆØ± ÙˆØµÙˆÙ„Ù‡Ø§"})]}):e.jsx("div",{className:"max-h-[400px] overflow-y-auto overflow-x-hidden scrollbar-thin scrollbar-thumb-gray-200 dark:scrollbar-thumb-gray-700 scrollbar-track-transparent",children:m.map(L=>{var Ce,ye;const ie=L.id?!v.has(L.id):!1;let se="";try{const vt=(Ce=L.createdAt)!=null&&Ce.toMillis?L.createdAt.toMillis():(ye=L.createdAt)!=null&&ye.seconds?L.createdAt.seconds*1e3:null;if(vt){const rt=Date.now()-vt,At=Math.floor(rt/6e4),Va=Math.floor(At/60),Ia=Math.floor(Va/24);Ia>0?se=`Ù…Ù†Ø° ${Ia} ÙŠÙˆÙ…`:Va>0?se=`Ù…Ù†Ø° ${Va} Ø³Ø§Ø¹Ø©`:At>0?se=`Ù…Ù†Ø° ${At} Ø¯Ù‚ÙŠÙ‚Ø©`:se="Ø§Ù„Ø¢Ù†"}}catch{}return e.jsx("div",{className:`relative group px-4 py-3.5 border-b border-gray-50 dark:border-gray-800/50 last:border-0 transition-all duration-200 hover:bg-gray-50 dark:hover:bg-gray-800/50 ${ie?"bg-blue-50/40 dark:bg-blue-900/10":""}`,children:e.jsxs("div",{className:"flex items-start gap-3.5",children:[e.jsxs("div",{className:`relative shrink-0 w-10 h-10 rounded-full flex items-center justify-center transition-colors ${ie?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400"}`,children:[e.jsx(Ii,{className:"h-5 w-5"}),ie&&e.jsx("span",{className:"absolute top-0 right-0 w-2.5 h-2.5 bg-blue-600 rounded-full ring-2 ring-white dark:ring-gray-950 animate-pulse"})]}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:`text-sm leading-none ${ie?"font-bold text-gray-900 dark:text-gray-100":"font-medium text-gray-700 dark:text-gray-300"}`,children:L.title||"Ø¥Ø´Ø¹Ø§Ø±"}),se&&e.jsx("span",{className:"text-[10px] text-gray-400 whitespace-nowrap",children:se})]}),e.jsx("p",{className:`text-xs leading-relaxed ${ie?"text-gray-800 dark:text-gray-200":"text-gray-500 dark:text-gray-400"} whitespace-pre-line`,children:L.message}),L.linkUrl&&e.jsx("div",{className:"pt-2",children:e.jsxs(I,{variant:"outline",size:"sm",className:"h-7 text-xs gap-1.5 rounded-full hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200 dark:hover:bg-blue-900/20 dark:hover:border-blue-800 transition-all",onClick:()=>bt(L.linkUrl,L.id),children:[e.jsx(Lp,{className:"h-3 w-3"}),"ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·"]})})]}),e.jsx("div",{className:"shrink-0 self-center opacity-0 group-hover:opacity-100 transition-opacity focus-within:opacity-100",children:ie&&e.jsx(I,{variant:"ghost",size:"icon",className:"h-7 w-7 rounded-full text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",onClick:vt=>{vt.stopPropagation(),Z(L.id)},title:"ØªÙ…ÙŠÙŠØ² ÙƒÙ…Ù‚Ø±ÙˆØ¡",children:e.jsx(Ri,{className:"h-4 w-4"})})})]})},L.id)})})]})]}),U&&Vg.createPortal(e.jsx("div",{ref:Be,style:Ve,className:`pointer-events-auto transition-all duration-300 ${Ie?"opacity-100 translate-y-0":"opacity-0 -translate-y-3"}`,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl border border-gray-200 p-4 w-80 max-w-[calc(100vw-16px)] flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Ii,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-semibold",children:U.title||"Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯"}),e.jsx("div",{className:"text-xs text-muted-foreground whitespace-pre-line",children:U.message}),U.linkUrl&&e.jsx(I,{variant:"link",className:"px-0 h-6 text-xs",onClick:()=>bt(U.linkUrl,U.id),children:"ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·"})]})]})}),document.body)]}):null}function Hv(s,t=300){const[r,i]=G.useState(s);return G.useEffect(()=>{const l=setTimeout(()=>i(s),t);return()=>clearTimeout(l)},[s,t]),r}const Qv=({userId:s,transactions:t})=>{const[r,i]=d.useState(!1),[l,m]=d.useState(!1),[g,v]=d.useState(!1),[D,S]=d.useState({monthlyWithdrawalProfit:0,monthlyTransferProfit:0,monthlySalesProfit:0,lastUpdated:new Date}),{userSubscription:j,user:A,profile:E}=ac();d.useEffect(()=>{s&&r&&g&&x()},[s,r,g]),d.useEffect(()=>{if(!r||!g)return;const U=setInterval(()=>{const ee=new Date;(D.lastUpdated.getMonth()!==ee.getMonth()||D.lastUpdated.getFullYear()!==ee.getFullYear())&&x()},3e4);return()=>clearInterval(U)},[r,g,D.lastUpdated]);const P=async()=>{try{if(!s)return 0;const U=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),ee=new Date,Ie=U.format(ee),[we,Ne]=Ie.split("-"),xe=`${we}-${Ne}-01`,ae=parseInt(we),Le=parseInt(Ne),Be=new Date(ae,Le,0).getDate(),Ve=`${we}-${Ne}-${String(Be).padStart(2,"0")}`;let ct;try{const Me=Ee(ce($,"dailySales"),Y("userId","==",s));ct=await ke(Me)}catch{const Me=Ee(ce($,"users",s,"dailySales"));ct=await ke(Me)}let Ut=0;return ct.forEach(Me=>{const st=Me.data(),H=String(st.date??"").slice(0,10);if(H&&!st.isDeferred&&H>=xe&&H<=Ve){const Z=Number(st.sellingPrice??st.price??0),yt=Number(st.wholesalePrice??0),bt=Number(st.quantity??st.qty??0),gt=Number(st.profit??(Z-yt)*bt);Ut+=gt}}),Math.round(Ut*100)/100}catch(U){return console.warn("ØªØ¹Ø°Ø± Ø­Ø³Ø§Ø¨ Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©:",U),0}},x=async()=>{if(s)try{if(Array.isArray(t)&&t.length>0){const Ie=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),we=new Date,[Ne,xe]=Ie.format(we).split("-"),ae=parseInt(Ne),Le=parseInt(xe)-1,Be=Ot.filterVisibleTransactions(t,"monthly",s);let Ve=0,ct=0;Be.forEach(Me=>{var ie,se,Ce;let st;Me.createdAt instanceof Date?st=Me.createdAt:typeof((ie=Me.createdAt)==null?void 0:ie.toDate)=="function"?st=Me.createdAt.toDate():st=new Date(Me.createdAt||0);const H=Ie.formatToParts(st),Z=parseInt(((se=H.find(ye=>ye.type==="year"))==null?void 0:se.value)||"0"),yt=parseInt(((Ce=H.find(ye=>ye.type==="month"))==null?void 0:Ce.value)||"0")-1,bt=String(Me.status||"confirmed").toLowerCase();if(Z!==ae||yt!==Le||bt!=="completed"&&bt!=="confirmed")return;const gt=(Me.type||Me.txnType||"").toLowerCase(),L={type:gt==="withdrawal"||gt==="machine_withdrawal"?"withdraw":gt,amount:Number(Me.amount||0),commission:Me.commission};L.type==="withdraw"||L.type==="atm_withdraw"?Ve+=fa.calculateProfitFromTransaction(L):(L.type==="send"||L.type==="receive"||L.type==="transfer")&&(ct+=fa.calculateProfitFromTransaction(L))});const Ut=await P();S({monthlyWithdrawalProfit:Math.round(Ve*100)/100,monthlyTransferProfit:Math.round(ct*100)/100,monthlySalesProfit:Ut,lastUpdated:new Date});return}const U=fa.getWithdrawTransferProfits(s),ee=await P();S({monthlyWithdrawalProfit:U.monthlyWithdrawProfit||0,monthlyTransferProfit:U.monthlyTransferProfit||0,monthlySalesProfit:ee,lastUpdated:new Date})}catch(U){console.error("Error loading profit data:",U)}},q=U=>`${U.toFixed(2)} Ø¬.Ù…`,F=async()=>{try{const U=(j==null?void 0:j.subscription)||null,ee=(U==null?void 0:U.planType)??(U==null?void 0:U.plan)??null,Ie=typeof ee=="string"?ee.toLowerCase():null;if(ee===ta.ZERO||Ie==="zero"||Ie==="0"||ee===0)return!0}catch{}try{if(s){const U=await Tm(s),ee=(U==null?void 0:U.planType)??(U==null?void 0:U.plan)??null,Ie=typeof ee=="string"?ee.toLowerCase():null;if(ee===ta.ZERO||Ie==="zero"||Ie==="0"||ee===0)return!0}}catch{}return!1},ne=async()=>{try{if(await F()){Yu({title:"Ø§Ù„Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ",description:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±.",variant:"destructive"});return}}catch{}const U=s||(A==null?void 0:A.uid),ee=U?`monthlyReportsLock_v4_${U}`:"monthlyReportsLock_v4",Ie=(localStorage.getItem(ee)??localStorage.getItem("monthlyReportsLock_v4"))==="true",we=await Bt.hasMasterPin(U);Ie&&we?m(!0):(v(!0),i(!0))},K=async()=>{try{if(await F()){Yu({title:"Ø§Ù„Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ",description:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±.",variant:"destructive"}),m(!1);return}}catch{}v(!0),i(!0),m(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(I,{size:"sm",variant:"ghost",onClick:ne,className:"h-6 w-6 p-0 text-gray-400 hover:text-purple-600 hover:bg-purple-50 rounded-full transition-colors duration-200",title:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",children:e.jsx(or,{className:"h-4 w-4"})}),e.jsx(ue,{open:r,onOpenChange:i,children:e.jsxs(me,{className:"max-w-[280px] sm:max-w-[320px] mx-auto bg-white dark:bg-[#0f172a] border border-gray-200 dark:border-slate-800 shadow-xl rounded-xl p-0 overflow-hidden",children:[e.jsx(be,{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-b border-gray-100 dark:border-slate-800",children:e.jsxs(pe,{className:"text-sm font-bold text-gray-900 dark:text-slate-100 flex items-center justify-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-full border border-gray-200 dark:border-slate-700",children:e.jsx(Ti,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"})}),"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±"]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-red-50 dark:bg-red-900/20 rounded-md",children:e.jsx(rr,{className:"h-3.5 w-3.5 text-red-600 dark:text-red-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø³Ø­Ø¨"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:q(D.monthlyWithdrawalProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-green-50 dark:bg-green-900/20 rounded-md",children:e.jsx(Om,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"ØªØ­ÙˆÙŠÙ„"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:q(D.monthlyTransferProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-violet-50 dark:bg-violet-900/20 rounded-md",children:e.jsx(Rm,{className:"h-3.5 w-3.5 text-violet-600 dark:text-violet-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:q(D.monthlySalesProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-100 dark:border-purple-900/30 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-md shadow-sm",children:e.jsx($a,{className:"h-3.5 w-3.5 text-purple-600 dark:text-purple-400"})}),e.jsx("span",{className:"font-bold text-purple-900 dark:text-purple-100 text-sm",children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"})]}),e.jsx("span",{className:"font-bold text-base text-purple-700 dark:text-purple-300",children:q(D.monthlyWithdrawalProfit+D.monthlyTransferProfit+D.monthlySalesProfit)})]})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-t border-gray-100 dark:border-slate-800 flex justify-center",children:e.jsx(I,{onClick:()=>i(!1),className:"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 hover:text-gray-900 w-full sm:w-auto px-8 rounded-lg text-sm font-medium shadow-sm",children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(qg,{open:l,onOpenChange:m,mode:"verify",title:"Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",description:"Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",userId:s||(A==null?void 0:A.uid),userRole:E==null?void 0:E.role,onSuccess:K})]})},Gv=s=>e.jsx(Qv,{...s});function Xv({open:s,onOpenChange:t,onSuccess:r,userId:i}){const[l,m]=d.useState(""),[g,v]=d.useState(""),[D,S]=d.useState(!1),[j,A]=d.useState(!1),[E,P]=d.useState(""),[x,q]=d.useState(!1),[F,ne]=d.useState(!1),{toast:K}=Fi(),U=G.useRef(null);d.useEffect(()=>{let we=!0;return(async()=>{const Ne=await Bt.hasMasterPin(i);we&&ne(Ne)})(),()=>{we=!1}},[i,s]);const ee=()=>{m(""),v(""),P(""),S(!1),A(!1),t(!1)},Ie=async we=>{we.preventDefault(),P(""),q(!0);try{if(F){if(!await Bt.verifyMasterPin(l,i)){P("Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­"),q(!1);return}}else{if(l.length<4){P("ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ 4 Ø£Ø±Ù‚Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„"),q(!1);return}if(l!==g){P("Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚"),q(!1);return}if(!await Bt.createMasterPin(l,i)){P("ØªØ¹Ø°Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"),q(!1);return}}K({title:"Ù†Ø¬Ø­ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",description:F?"ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¨Ù†Ø¬Ø§Ø­":"ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¨Ù†Ø¬Ø§Ø­"}),r(),ee()}catch{P("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ")}finally{q(!1)}};return e.jsx(ue,{open:s,onOpenChange:t,children:e.jsxs(me,{className:"sm:max-w-md",dir:"rtl",children:[e.jsx(be,{children:e.jsxs(pe,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(Ku,{className:"h-5 w-5 text-green-600"}),F?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ":"Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"]})}),e.jsxs("form",{ref:U,onSubmit:Ie,className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600 bg-blue-50 p-3 rounded-lg",children:F?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø±Ø¨Ø§Ø­":"Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø±Ø¨Ø§Ø­. ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ±Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø±ÙˆÙÙŠÙ„."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"pin",children:F?"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ":"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{id:"pin",type:D?"text":"password",value:l,onChange:we=>m(we.target.value),onKeyDown:we=>{var Ne;we.key==="Enter"&&(we.preventDefault(),(Ne=U.current)==null||Ne.requestSubmit())},placeholder:F?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ":"Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø³Ø±ÙŠ Ø¬Ø¯ÙŠØ¯ (4 Ø£Ø±Ù‚Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)",className:"pr-10",dir:"ltr",autoComplete:"off",required:!0}),e.jsx(I,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>S(!D),children:D?e.jsx(Ju,{className:"h-4 w-4"}):e.jsx(or,{className:"h-4 w-4"})})]})]}),!F&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"confirmPin",children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{id:"confirmPin",type:j?"text":"password",value:g,onChange:we=>v(we.target.value),onKeyDown:we=>{var Ne;we.key==="Enter"&&(we.preventDefault(),(Ne=U.current)==null||Ne.requestSubmit())},placeholder:"Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",className:"pr-10",dir:"ltr",autoComplete:"off",required:!0}),e.jsx(I,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>A(!j),children:j?e.jsx(Ju,{className:"h-4 w-4"}):e.jsx(or,{className:"h-4 w-4"})})]})]}),E&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(zg,{className:"h-4 w-4"}),E]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(I,{type:"submit",disabled:x,className:"flex-1 bg-green-600 hover:bg-green-700",children:[e.jsx(Ku,{className:"h-4 w-4 mr-2"}),x?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...":F?"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­":"Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"]}),e.jsx(I,{type:"button",variant:"outline",onClick:ee,disabled:x,children:"Ø¥Ù„ØºØ§Ø¡"})]})]})]})})}const Zv=({userId:s,transactions:t})=>{const[r,i]=d.useState(!1),[l,m]=d.useState(!1),[g,v]=d.useState(!1),[D,S]=d.useState({dailyWithdrawalProfit:0,dailyTransferProfit:0,dailySalesProfit:0,lastUpdated:new Date}),{shopId:j}=Pm();d.useEffect(()=>{s&&r&&g&&E()},[s,r,g,t,j]),d.useEffect(()=>{if(!r||!g)return;const F=setInterval(()=>{const ne=new Date;D.lastUpdated.getDate()!==ne.getDate()&&E()},3e4);return()=>clearInterval(F)},[r,g,D.lastUpdated]);const A=async()=>{if(!s)return 0;const F=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}),ne=F.format(new Date);let K=0;try{const U=Ee(ce($,"dailySales"),Y("userId","==",s),...j?[Y("shopId","==",j)]:[]),ee=await ke(U),Ie=[];ee.forEach(xe=>{Ie.push({id:xe.id,data:xe.data()})}),(await ke(ce($,"users",s,"dailySales"))).forEach(xe=>{const ae=xe.data();j&&ae.shopId&&ae.shopId!==j||Ie.push({id:xe.id,data:ae})});const Ne=new Map;Ie.forEach(xe=>{const ae=String(xe.data.clientId||xe.id);Ne.has(ae)||Ne.set(ae,xe.data)}),Ne.forEach(xe=>{if(xe.isDeferred)return;let ae=null;if(xe.createdAt)typeof xe.createdAt.toDate=="function"?ae=xe.createdAt.toDate():xe.createdAt instanceof Date?ae=xe.createdAt:typeof xe.createdAt=="number"?ae=new Date(xe.createdAt):typeof xe.createdAt=="string"&&(ae=new Date(xe.createdAt));else if(xe.date){const Be=xe.time||"00:00";ae=new Date(`${xe.date}T${Be}:00`)}let Le=!1;if(ae&&!isNaN(ae.getTime())?F.format(ae)===ne&&(Le=!0):String(xe.date||"").slice(0,10)===ne&&(Le=!0),Le){const Be=Number(xe.quantity||1),Ve=Number(xe.profit??(Number(xe.sellingPrice||0)-Number(xe.wholesalePrice||0))*Be);K+=Ve}})}catch(U){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©:",U)}return Math.round(K*100)/100},E=async()=>{if(s)try{if(Array.isArray(t)&&t.length>0){const K=new Date,U=Ot.filterVisibleTransactions(t,"daily",s);let ee=0,Ie=0;U.forEach(Ne=>{const xe=new Date(Ne.createdAt),ae=String(Ne.status||"confirmed").toLowerCase();if(xe.toDateString()!==K.toDateString())return;const Le=(Ne.type||Ne.txnType||"").toLowerCase(),Be=String(Ne.title||"");if(Le==="cash_addition"||Be.includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"))return;const Ve={type:Le==="withdrawal"||Le==="machine_withdrawal"?"withdraw":Le,amount:Number(Ne.amount||0),commission:Ne.commission};Ve.type==="withdraw"||Ve.type==="atm_withdraw"?ee+=fa.calculateProfitFromTransaction(Ve):(Ve.type==="send"||Ve.type==="receive"||Ve.type==="transfer")&&(Ie+=fa.calculateProfitFromTransaction(Ve))});const we=await A();S({dailyWithdrawalProfit:Math.round(ee*100)/100,dailyTransferProfit:Math.round(Ie*100)/100,dailySalesProfit:we,lastUpdated:new Date});try{fa.updateProfitsFromTransactions(t,s)}catch{}return}const F=fa.getWithdrawTransferProfits(s),ne=await A();S({dailyWithdrawalProfit:F.dailyWithdrawProfit||0,dailyTransferProfit:F.dailyTransferProfit||0,dailySalesProfit:ne,lastUpdated:new Date})}catch(F){console.error("Error loading profit data:",F)}},P=F=>`${F.toFixed(2)} Ø¬.Ù…`,x=()=>{fa.hasProfitPin(s),m(!0)},q=()=>{v(!0),i(!0),m(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(I,{size:"sm",variant:"ghost",onClick:x,className:"h-6 w-6 p-0 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors duration-200",title:"Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©",children:e.jsx(or,{className:"h-4 w-4"})}),e.jsx(ue,{open:r,onOpenChange:i,children:e.jsxs(me,{className:"max-w-[280px] sm:max-w-[320px] mx-auto bg-white dark:bg-[#0f172a] border border-gray-200 dark:border-slate-800 shadow-xl rounded-xl p-0 overflow-hidden",children:[e.jsx(be,{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-b border-gray-100 dark:border-slate-800",children:e.jsxs(pe,{className:"text-sm font-bold text-gray-900 dark:text-slate-100 flex items-center justify-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-full border border-gray-200 dark:border-slate-700",children:e.jsx($a,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…"]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-red-50 dark:bg-red-900/20 rounded-md",children:e.jsx(rr,{className:"h-3.5 w-3.5 text-red-600 dark:text-red-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø³Ø­Ø¨"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:P(D.dailyWithdrawalProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-green-50 dark:bg-green-900/20 rounded-md",children:e.jsx(Om,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"ØªØ­ÙˆÙŠÙ„"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:P(D.dailyTransferProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-violet-50 dark:bg-violet-900/20 rounded-md",children:e.jsx(Rm,{className:"h-3.5 w-3.5 text-violet-600 dark:text-violet-400"})}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-slate-300 text-sm",children:"Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"})]}),e.jsx("span",{className:"font-bold text-sm text-gray-900 dark:text-slate-100",children:P(D.dailySalesProfit)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-900/30 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-white dark:bg-slate-800 rounded-md shadow-sm",children:e.jsx($a,{className:"h-3.5 w-3.5 text-blue-600 dark:text-blue-400"})}),e.jsx("span",{className:"font-bold text-blue-900 dark:text-blue-100 text-sm",children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"})]}),e.jsx("span",{className:"font-bold text-base text-blue-700 dark:text-blue-300",children:P(D.dailyWithdrawalProfit+D.dailyTransferProfit+D.dailySalesProfit)})]})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-slate-900/50 px-4 py-3 border-t border-gray-100 dark:border-slate-800 flex justify-center",children:e.jsx(I,{onClick:()=>i(!1),className:"bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-700 text-gray-700 dark:text-slate-200 hover:bg-gray-50 dark:hover:bg-slate-700 hover:text-gray-900 w-full sm:w-auto px-8 rounded-lg text-sm font-medium shadow-sm",children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(Xv,{open:l,onOpenChange:m,onSuccess:q,userId:s})]})},ew=s=>e.jsx(Zv,{...s});var yc="Radio",[tw,fh]=ec(yc),[aw,sw]=tw(yc),gh=d.forwardRef((s,t)=>{const{__scopeRadio:r,name:i,checked:l=!1,required:m,disabled:g,value:v="on",onCheck:D,form:S,...j}=s,[A,E]=d.useState(null),P=gn(t,F=>E(F)),x=d.useRef(!1),q=A?S||!!A.closest("form"):!0;return e.jsxs(aw,{scope:r,checked:l,disabled:g,children:[e.jsx(dr.button,{type:"button",role:"radio","aria-checked":l,"data-state":bh(l),"data-disabled":g?"":void 0,disabled:g,value:v,...j,ref:P,onClick:ns(s.onClick,F=>{l||D==null||D(),q&&(x.current=F.isPropagationStopped(),x.current||F.stopPropagation())})}),q&&e.jsx(yh,{control:A,bubbles:!x.current,name:i,value:v,checked:l,required:m,disabled:g,form:S,style:{transform:"translateX(-100%)"}})]})});gh.displayName=yc;var ph="RadioIndicator",xh=d.forwardRef((s,t)=>{const{__scopeRadio:r,forceMount:i,...l}=s,m=sw(ph,r);return e.jsx(tc,{present:i||m.checked,children:e.jsx(dr.span,{"data-state":bh(m.checked),"data-disabled":m.disabled?"":void 0,...l,ref:t})})});xh.displayName=ph;var rw="RadioBubbleInput",yh=d.forwardRef(({__scopeRadio:s,control:t,checked:r,bubbles:i=!0,...l},m)=>{const g=d.useRef(null),v=gn(g,m),D=Yg(r),S=Kg(t);return d.useEffect(()=>{const j=g.current;if(!j)return;const A=window.HTMLInputElement.prototype,P=Object.getOwnPropertyDescriptor(A,"checked").set;if(D!==r&&P){const x=new Event("click",{bubbles:i});P.call(j,r),j.dispatchEvent(x)}},[D,r,i]),e.jsx(dr.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...l,tabIndex:-1,ref:v,style:{...l.style,...S,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});yh.displayName=rw;function bh(s){return s?"checked":"unchecked"}var nw=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ui="RadioGroup",[iw]=ec(Ui,[Mm,fh]),vh=Mm(),wh=fh(),[ow,lw]=iw(Ui),Nh=d.forwardRef((s,t)=>{const{__scopeRadioGroup:r,name:i,defaultValue:l,value:m,required:g=!1,disabled:v=!1,orientation:D,dir:S,loop:j=!0,onValueChange:A,...E}=s,P=vh(r),x=Ip(S),[q,F]=Im({prop:m,defaultProp:l??null,onChange:A,caller:Ui});return e.jsx(ow,{scope:r,name:i,required:g,disabled:v,value:q,onValueChange:F,children:e.jsx(Bp,{asChild:!0,...P,orientation:D,dir:x,loop:j,children:e.jsx(dr.div,{role:"radiogroup","aria-required":g,"aria-orientation":D,"data-disabled":v?"":void 0,dir:x,...E,ref:t})})})});Nh.displayName=Ui;var jh="RadioGroupItem",Sh=d.forwardRef((s,t)=>{const{__scopeRadioGroup:r,disabled:i,...l}=s,m=lw(jh,r),g=m.disabled||i,v=vh(r),D=wh(r),S=d.useRef(null),j=gn(t,S),A=m.value===l.value,E=d.useRef(!1);return d.useEffect(()=>{const P=q=>{nw.includes(q.key)&&(E.current=!0)},x=()=>E.current=!1;return document.addEventListener("keydown",P),document.addEventListener("keyup",x),()=>{document.removeEventListener("keydown",P),document.removeEventListener("keyup",x)}},[]),e.jsx($p,{asChild:!0,...v,focusable:!g,active:A,children:e.jsx(gh,{disabled:g,required:m.required,checked:A,...D,...l,name:m.name,ref:j,onCheck:()=>m.onValueChange(l.value),onKeyDown:ns(P=>{P.key==="Enter"&&P.preventDefault()}),onFocus:ns(l.onFocus,()=>{var P;E.current&&((P=S.current)==null||P.click())})})})});Sh.displayName=jh;var cw="RadioGroupIndicator",Dh=d.forwardRef((s,t)=>{const{__scopeRadioGroup:r,...i}=s,l=wh(r);return e.jsx(xh,{...l,...i,ref:t})});Dh.displayName=cw;var kh=Nh,Ch=Sh,dw=Dh;const Ih=d.forwardRef(({className:s,...t},r)=>e.jsx(kh,{className:Da("grid gap-2",s),...t,ref:r}));Ih.displayName=kh.displayName;const Ei=d.forwardRef(({className:s,...t},r)=>e.jsx(Ch,{ref:r,className:Da("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:e.jsx(dw,{className:"flex items-center justify-center",children:e.jsx(Mp,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Ei.displayName=Ch.displayName;const uw=({isOpen:s,onClose:t,userId:r,wallets:i,walletBalances:l,onSuccess:m})=>{const{toast:g}=Fi(),[v,D]=d.useState(1),[S,j]=d.useState(""),[A,E]=d.useState(""),[P,x]=d.useState(""),[q,F]=d.useState("cash"),[ne,K]=d.useState(""),[U,ee]=d.useState(!1),[Ie,we]=d.useState(!1);d.useEffect(()=>{s&&(D(1),j(""),E(""),x(""),F("cash"),K(""))},[s]);const Ne=()=>{if(!S||parseFloat(S)<=0){g({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}if(!P){g({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}const ae=l[P]||0;if(parseFloat(S)>ae){g({title:"Ø®Ø·Ø£",description:"Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ØºÙŠØ± ÙƒØ§ÙÙ",variant:"destructive"});return}D(2)},xe=async()=>{var ae;if(q==="wallet"&&!ne){g({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ©",variant:"destructive"});return}ee(!0);try{const Le=parseFloat(S),Be=A?parseFloat(A):0,Ve=Le+Be,ct=Le,Ut=Pe($,"users",r),Me=await la(Ut);if(!Me.exists())throw"User document not found";const H=Me.data().walletBalances||{},Z=Number(H[P]||0);if(console.log("[AtmWithdrawDialog] Validation:",{sourceWalletId:P,currentSourceBalance:Z,numericAmount:Le,numericCommission:Be,totalDeductedFromWallet:Ve}),Z<Ve)throw`Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ØºÙŠØ± ÙƒØ§ÙÙ (Ø§Ù„Ù…ØªØ§Ø­: ${Z}, Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø®ØµÙ…Ù‡: ${Ve})`;const yt=await Ua.canPerformOperation(P,Le,"transfer");if(!yt.canPerform)throw yt.message||"ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø³Ù…ÙˆØ­";const bt=Hl($),gt={};gt[`walletBalances.${P}`]=El(-Ve);let L="";q==="wallet"&&ne?(gt[`walletBalances.${ne}`]=El(ct),L=`Wallet: ${(ae=i.find(ye=>ye.id===ne))==null?void 0:ae.name}`):q==="cash"?(gt.cashBalance=El(ct),L="Cash Drawer"):L="No Addition",bt.update(Ut,gt);const ie=i.find(ye=>ye.id===P),se=Pe(ce($,"userTransactions"));bt.set(se,{userId:r,type:"atm_withdraw",amount:Le,commission:Be,totalCharged:Ve,netAmount:ct,sourceWalletId:P,destinationType:q,destinationWalletId:q==="wallet"?ne:null,status:"completed",createdAt:ft(),note:`Ø³Ø­Ø¨ ATM Ù…Ù† ${ie==null?void 0:ie.name}`,walletId:P,sender_msisdn:(ie==null?void 0:ie.phone)||"",details:`ATM Withdraw from ${ie==null?void 0:ie.name} -> ${L}`}),await bt.commit();try{await Ua.updateUsage(P,Le,"transfer")}catch(ye){console.error("Failed to update wallet limits:",ye)}if(Be>0)try{fa.addProfit(-Be,r)}catch(ye){console.error("Failed to update profits:",ye)}let Ce={};if(q==="cash")Ce={delta:{amount:ct,commission:Be,totalDeducted:Ve,type:"atm_withdraw",walletId:P}};else{const ye={...l};ye[P]=(ye[P]||0)-Ve,q==="wallet"&&(ye[ne]=(ye[ne]||0)+ct),Ce={walletBalances:ye}}window.dispatchEvent(new CustomEvent("dashboard:external-update",{detail:Ce})),g({title:"Ù†Ø¬Ø§Ø­",description:"ØªÙ…Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­"}),m==null||m(),t()}catch(Le){console.error("ATM Withdraw Error:",Le),g({title:"Ø®Ø·Ø£",description:typeof Le=="string"?Le:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",variant:"destructive"})}finally{ee(!1)}};return e.jsxs(ue,{open:s,onOpenChange:t,children:[e.jsxs(me,{className:"sm:max-w-[425px]",dir:"rtl",children:[e.jsxs(be,{children:[e.jsxs(pe,{className:"flex items-center gap-2",children:["Ø³Ø­Ø¨ ATM",e.jsxs(I,{variant:"ghost",size:"sm",onClick:()=>we(!0),className:"gap-1 px-2 text-rose-600 hover:text-rose-700 hover:bg-rose-50 mx-2",children:[e.jsx(Ai,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Ø´Ø±Ø­ Ù‚Ø³Ù… atm"})]})]}),e.jsx(at,{children:v===1?"Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø³Ø­Ø¨":"Ø§Ø®ØªØ± Ù…ÙƒØ§Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"})]}),v===1?e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{children:"Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø­Ø¨"}),e.jsx(X,{type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:S,onChange:ae=>j(ae.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø®ØµÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx(X,{type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©",value:A,onChange:ae=>E(ae.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{children:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø³Ø­Ø¨ Ù…Ù†Ù‡Ø§"}),e.jsxs(Wa,{value:P,onValueChange:x,children:[e.jsx(La,{children:e.jsx(Fa,{placeholder:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})}),e.jsx(Ba,{children:i.map(ae=>e.jsx(oa,{value:ae.id,children:e.jsxs("div",{className:"flex justify-between w-full gap-4",children:[e.jsx("span",{children:ae.phone||ae.name}),e.jsx("span",{className:"text-muted-foreground text-xs",children:l[ae.id]?`${l[ae.id]} Ø¬.Ù…`:"0 Ø¬.Ù…"})]})},ae.id))})]})]})]}):e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-muted p-4 rounded-lg mb-4",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Ø§Ù„Ù…Ø¨Ù„Øº:"}),e.jsxs("span",{className:"font-bold",children:[S," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (Ø®ØµÙ… Ø¥Ø¶Ø§ÙÙŠ):"}),e.jsxs("span",{className:"font-bold text-red-500",children:[A||0," Ø¬.Ù…"]})]}),parseFloat(A)>0&&e.jsx("div",{className:"text-[10px] text-amber-600 mb-2 text-right",children:"* Ø³ÙŠØªÙ… Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ù…Ù† Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø´Ù‡Ø±"}),e.jsxs("div",{className:"flex justify-between mb-2 pt-2 border-t border-dashed",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©:"}),e.jsxs("span",{className:"font-bold text-red-600",children:[parseFloat(S)+(parseFloat(A)||0)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¶Ø§Ù Ù„Ù„ÙˆØ¬Ù‡Ø©:"}),e.jsxs("span",{className:"font-bold text-green-600",children:[S," Ø¬.Ù…"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Q,{children:"Ù…ÙƒØ§Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),e.jsxs(Ih,{value:q,onValueChange:ae=>F(ae),className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(Ei,{value:"cash",id:"r1"}),e.jsx(Q,{htmlFor:"r1",className:"cursor-pointer",children:"Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ (Cash Drawer)"})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(Ei,{value:"wallet",id:"r2"}),e.jsx(Q,{htmlFor:"r2",className:"cursor-pointer",children:"Ù…Ø­ÙØ¸Ø© Ø£Ø®Ø±Ù‰"})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(Ei,{value:"none",id:"r3"}),e.jsx(Q,{htmlFor:"r3",className:"cursor-pointer",children:"Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ© (Ø³Ø­Ø¨ ÙÙ‚Ø·)"})]})]})]}),q==="wallet"&&e.jsxs("div",{className:"space-y-2 mt-4 animate-in fade-in slide-in-from-top-2",children:[e.jsx(Q,{children:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ©"}),e.jsxs(Wa,{value:ne,onValueChange:K,children:[e.jsx(La,{children:e.jsx(Fa,{placeholder:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})}),e.jsx(Ba,{children:i.filter(ae=>ae.id!==P).map(ae=>e.jsx(oa,{value:ae.id,children:ae.phone||ae.name},ae.id))})]})]})]}),e.jsxs(Fe,{className:"flex-col sm:flex-row gap-2",children:[v===2&&e.jsx(I,{variant:"outline",onClick:()=>D(1),disabled:U,children:"Ø¹ÙˆØ¯Ø©"}),v===1?e.jsxs(I,{onClick:Ne,className:"w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white",children:["Ø§Ù„ØªØ§Ù„ÙŠ ",e.jsx(Jg,{className:"mr-2 h-4 w-4"})]}):e.jsxs(I,{onClick:xe,disabled:U,className:"w-full sm:w-auto bg-green-600 hover:bg-green-700",children:[U&&e.jsx(rs,{className:"mr-2 h-4 w-4 animate-spin"}),"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³Ø­Ø¨"]})]})]}),e.jsx(Em,{isOpen:Ie,onClose:()=>we(!1),videoUrl:"https://www.youtube.com/watch?v=V_wM36ICBck",title:"Ø´Ø±Ø­ Ù‚Ø³Ù… ATM",className:"z-[10002]"})]})};class nr{static async processTransfer(t){const{amount:r,currentCashBalance:i,currentWalletBalances:l,wallets:m,selectedWalletId:g}=t;if(r<=0)return{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};if(g&&!t.skipRemoteLimitsCheck)try{const j=await Ua.canPerformOperation(g,r,"transfer");if(!j.canPerform)return{success:!1,newCashBalance:i,newWalletBalances:l,message:j.message||"ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰",error:"LIMIT_EXCEEDED"}}catch(j){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„:",j),{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",error:"LIMIT_CHECK_ERROR"}}if(r<=0)return{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};if(g){const j=Math.max(l[g]||0,0);if(j<r){const A=m.find(E=>E.id===g);return{success:!1,newCashBalance:i,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©${A?` ${A.name}`:""}. Ø§Ù„Ù…ØªØ§Ø­: ${j} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${r} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_WALLET_BALANCE"}}}else{const j=nr.calculateTotalWalletBalance(l);if(j<r)return{success:!1,newCashBalance:i,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­: ${j} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${r} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_WALLET_BALANCE"}}const v={...l};if(g){const j=v[g]||0;v[g]=j-r}else{let j=r;for(const A of m){if(j<=0)break;const E=Math.max(v[A.id]||0,0),P=Math.min(E,j);P>0&&(v[A.id]=(v[A.id]||0)-P,j-=P)}}const D=i+r;let S="ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­";if(g){const j=v[g]||0;j<0&&(S=`ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­ Ù…Ø¹ ØªØ­Ø°ÙŠØ±: Ø±ØµÙŠØ¯ Ù…Ø­ÙØ¸Ø© ${g} Ø£ØµØ¨Ø­ ${j} Ø¬Ù†ÙŠÙ‡.`)}return{success:!0,newCashBalance:D,newWalletBalances:v,message:S}}static processDeposit(t){const{amount:r,currentCashBalance:i,currentWalletBalances:l,wallets:m}=t;if(r<=0)return{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};const g=this.calculateTotalWalletBalance(l);if(g<r)return{success:!1,newCashBalance:i,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­: ${g} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${r} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_WALLET_BALANCE"};const v=i+r,D={...l};let S=r;const j=m.find(E=>E.isDefault);if(j&&D[j.id]>=S)D[j.id]-=S,S=0;else for(const E of m){if(S<=0)break;const P=D[E.id]||0;if(P>0){const x=Math.min(P,S);D[E.id]=P-x,S-=x}}const A=S>0?`ØªÙ… Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ø¬Ø²Ø¦ÙŠØ§Ù‹. ØªÙ… Ø¥ÙŠØ¯Ø§Ø¹ ${r-S} Ø¬Ù†ÙŠÙ‡ ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©`:`ØªÙ… Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ø¨Ù†Ø¬Ø§Ø­. ØªÙ… Ø¥Ø¶Ø§ÙØ© ${r} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©`;return{success:!0,newCashBalance:v,newWalletBalances:D,message:A}}static async processWithdraw(t){const{amount:r,currentCashBalance:i,currentWalletBalances:l,wallets:m,selectedWalletId:g}=t;if(r<=0)return{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±",error:"INVALID_AMOUNT"};if(g&&!t.skipRemoteLimitsCheck)try{const j=await Ua.canPerformOperation(g,r,"withdraw");if(!j.canPerform)return{success:!1,newCashBalance:i,newWalletBalances:l,message:j.message||"ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰",error:"LIMIT_EXCEEDED"}}catch(j){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø³Ø­Ø¨:",j),{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø³Ø­Ø¨",error:"LIMIT_CHECK_ERROR"}}if(i<r)return{success:!1,newCashBalance:i,newWalletBalances:l,message:`Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­: ${i} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${r} Ø¬Ù†ÙŠÙ‡`,error:"INSUFFICIENT_CASH_BALANCE"};const v=i-r,D={...l},S=g?m.find(j=>j.id===g):m.find(j=>j.isDefault)||m[0];if(S){const j=D[S.id]||0;D[S.id]=j+r}else return{success:!1,newCashBalance:i,newWalletBalances:l,message:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…ØªØ§Ø­Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø¥Ù„ÙŠÙ‡Ø§",error:"NO_WALLETS_AVAILABLE"};return{success:!0,newCashBalance:v,newWalletBalances:D,message:`ØªÙ… Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­. ØªÙ… Ø¥Ø¶Ø§ÙØ© ${r} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ Ù…Ø­ÙØ¸Ø© ${(S==null?void 0:S.name)||""}`}}static validateOperation(t,r){return t<=0?{valid:!1,error:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±"}:!r||r.length===0?{valid:!1,error:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…ØªØ§Ø­Ø©"}:{valid:!0}}static calculateTotalWalletBalance(t){return Object.values(t).reduce((r,i)=>r+Math.max(i,0),0)}static deductFromWalletsAddToCash(t,r,i,l){return this.processTransfer({amount:t,currentCashBalance:r,currentWalletBalances:i,wallets:l})}static deductFromWalletsAddToCashDeposit(t,r,i,l){return this.processDeposit({amount:t,currentCashBalance:r,currentWalletBalances:i,wallets:l})}static deductFromCashAddToWallets(t,r,i,l){return this.processWithdraw({amount:t,currentCashBalance:r,currentWalletBalances:i,wallets:l})}static applyTransactionResult(t,r,i){t.success&&(r(t.newCashBalance),i(t.newWalletBalances))}static validateTransaction(t,r,i,l){if(t<=0)return{isValid:!1,error:"Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±"};if(r==="transfer"){const m=this.calculateTotalWalletBalance(l);if(m<t)return{isValid:!1,error:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸ (${m} Ø¬Ù†ÙŠÙ‡) ØºÙŠØ± ÙƒØ§ÙÙŠ Ù„Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (${t} Ø¬Ù†ÙŠÙ‡)`}}else if(r==="withdraw"){if(i<t)return{isValid:!1,error:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© (${i} Ø¬Ù†ÙŠÙ‡) ØºÙŠØ± ÙƒØ§ÙÙŠ Ù„Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (${t} Ø¬Ù†ÙŠÙ‡)`}}else if(r==="deposit"){const m=this.calculateTotalWalletBalance(l);if(m<t)return{isValid:!1,error:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸ (${m} Ø¬Ù†ÙŠÙ‡) ØºÙŠØ± ÙƒØ§ÙÙŠ Ù„Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (${t} Ø¬Ù†ÙŠÙ‡)`}}return{isValid:!0}}static getDeductionPreview(t,r,i){const l=[];let m=t;for(const g of i){if(m<=0)break;const v=r[g.id]||0,D=Math.min(Math.max(v,0),m);D>0&&(l.push({walletId:g.id,walletName:g.name,currentBalance:v,deductedAmount:D,newBalance:v-D}),m-=D)}return l}}let mn=null;function mw(){const s=window;if(!mn){const t=s.AudioContext||s.webkitAudioContext;mn=new t}return mn.state==="suspended"&&mn.resume(),mn}function hw(s,t,r){const i=r/1e3,l=Math.floor(s.sampleRate*i),m=s.createBuffer(1,l,s.sampleRate),g=m.getChannelData(0);for(let j=0;j<l;j++)g[j]=(Math.random()*2-1)*.6;const v=s.createBufferSource();v.buffer=m;const D=s.createBiquadFilter();D.type="highpass",D.frequency.value=1500,D.Q.value=.7;const S=s.createGain();S.gain.setValueAtTime(1e-4,t),S.gain.exponentialRampToValueAtTime(.4,t+.015),S.gain.exponentialRampToValueAtTime(1e-4,t+i),v.connect(D),D.connect(S),S.connect(s.destination),v.start(t),v.stop(t+i+.01)}function fw(s,t,r,i,l,m="triangle"){const g=s.createOscillator(),v=s.createGain();g.type=m;const D=l/1e3;g.frequency.setValueAtTime(r,t),g.frequency.linearRampToValueAtTime(i,t+D),v.gain.setValueAtTime(1e-4,t),v.gain.exponentialRampToValueAtTime(.25,t+.02),v.gain.exponentialRampToValueAtTime(1e-4,t+D),g.connect(v),v.connect(s.destination),g.start(t),g.stop(t+D+.02)}function gw(){try{const s=mw(),t=s.currentTime;hw(s,t,90),fw(s,t+.12,1900,1100,180,"sawtooth")}catch{}}function pw(s){if(!s)return!1;const r=s.replace(/[^0-9Ù -Ù©]/g,"").replace(/[Ù -Ù©]/g,i=>"0123456789"["Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©".indexOf(i)]);return/^(010|011|012|015)[0-9]{8}$/.test(r)}const xw=({isOpen:s,onClose:t,senderPhone:r,receiverPhone:i,amount:l,deviceId:m,api:g})=>{const{toast:v}=Fi(),[D,S]=d.useState(1),[j,A]=d.useState(!1),[E,P]=d.useState("");d.useEffect(()=>{s&&(S(1),P(""))},[s]);const x=async ee=>{try{return g&&typeof g.enterPin=="function"?(await g.enterPin(m,ee),!0):!1}catch(Ie){return console.error("ADB error:",Ie),v({title:"Ø®Ø·Ø£ ADB",description:Ie.message||"ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„",variant:"destructive"}),!1}},q=async()=>{if(!E){v({title:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}A(!0);const ee=await x(E);A(!1),ee&&S(2)},F=async()=>{A(!0);const ee=await x(String(l));A(!1),ee&&S(3)},ne=async()=>{A(!0);const ee=await x(i);A(!1),ee&&S(4)},K=async()=>{A(!0);const ee=await x(i);A(!1),ee&&S(5)},U=async()=>{A(!0);const ee=await x("1");A(!1),ee&&(v({title:"ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­",description:"ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©"}),t())};return e.jsx(ue,{open:s,onOpenChange:ee=>!ee&&t(),children:e.jsxs(me,{className:"sm:max-w-[400px]",children:[e.jsxs(be,{children:[e.jsx(pe,{children:"ØªØ­ÙˆÙŠÙ„ Ø§ØªØµØ§Ù„Ø§Øª ÙƒØ§Ø´ (USSD)"}),e.jsxs(at,{children:[D===1&&"Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©",D===2&&"Ø§Ù„Ø®Ø·ÙˆØ© 2: ØªØ£ÙƒÙŠØ¯ Ù…Ø¨Ù„Øº Ø§Ù„ØªØ­ÙˆÙŠÙ„",D===3&&"Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",D===4&&"Ø§Ù„Ø®Ø·ÙˆØ© 4: ØªØ£ÙƒÙŠØ¯ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",D===5&&"Ø§Ù„Ø®Ø·ÙˆØ© 5: ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©"]})]}),e.jsxs("div",{className:"py-4 space-y-4",children:[D===1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ (PIN)"}),e.jsx(X,{type:"password",value:E,onChange:ee=>P(ee.target.value),placeholder:"****",autoFocus:!0,className:"text-center text-lg tracking-widest",maxLength:6,onKeyDown:ee=>{ee.key==="Enter"&&E&&q()}})]}),D===2&&e.jsxs("div",{className:"text-center bg-gray-50 dark:bg-slate-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¨Ù„Øº:"}),e.jsx("p",{className:"text-2xl font-bold font-mono tracking-wider",children:l})]}),D===3&&e.jsxs("div",{className:"text-center bg-gray-50 dark:bg-slate-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„:"}),e.jsx("p",{className:"text-2xl font-bold font-mono tracking-wider",children:i})]}),D===4&&e.jsxs("div",{className:"text-center bg-gray-50 dark:bg-slate-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù‚Ù… Ù…Ø±Ø© Ø£Ø®Ø±Ù‰:"}),e.jsx("p",{className:"text-2xl font-bold font-mono tracking-wider",children:i})]}),D===5&&e.jsxs("div",{className:"text-center bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-100 dark:border-green-900",children:[e.jsx("p",{className:"text-lg font-bold text-green-700 dark:text-green-400 mb-2",children:"Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ£ÙƒÙŠØ¯"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù‚Ù… 1 Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„"})]})]}),e.jsxs(Fe,{children:[D===1&&e.jsx(I,{onClick:q,disabled:j||!E,className:"w-full bg-black hover:bg-neutral-800 text-white",children:j?e.jsx(rs,{className:"animate-spin h-4 w-4 mr-2"}):"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ"}),D===2&&e.jsx(I,{onClick:F,disabled:j,className:"w-full bg-black hover:bg-neutral-800 text-white",children:j?e.jsx(rs,{className:"animate-spin h-4 w-4 mr-2"}):"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¨Ù„Øº"}),D===3&&e.jsx(I,{onClick:ne,disabled:j,className:"w-full bg-black hover:bg-neutral-800 text-white",children:j?e.jsx(rs,{className:"animate-spin h-4 w-4 mr-2"}):"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù‚Ù…"}),D===4&&e.jsx(I,{onClick:K,disabled:j,className:"w-full bg-black hover:bg-neutral-800 text-white",children:j?e.jsx(rs,{className:"animate-spin h-4 w-4 mr-2"}):"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù‚Ù…"}),D===5&&e.jsx(I,{onClick:U,disabled:j,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:j?e.jsx(rs,{className:"animate-spin h-4 w-4 mr-2"}):"ØªØ£ÙƒÙŠØ¯ (1)"})]})]})})},yw=G.lazy(()=>re(()=>import("./index-CHyvkdwe.js").then(s=>s.cL),__vite__mapDeps([0,1]),import.meta.url).then(s=>({default:s.BranchRequestDialog}))),bw=G.lazy(()=>re(()=>import("./WalletManagement-DnS17WSi.js"),__vite__mapDeps([2,0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]),import.meta.url)),vw=G.lazy(()=>re(()=>import("./TransactionDetailsModal-BEx2wWWH.js"),__vite__mapDeps([18,0,1,19,4,3,14,11,20,16,17]),import.meta.url)),ww=G.lazy(()=>re(()=>import("./ReceiptModal-Cv59yGsV.js"),__vite__mapDeps([21,0,1,19,4,10,3,22,17,20,23]),import.meta.url)),Dm=G.lazy(()=>re(()=>import("./EditBalanceDialog-CWJbBUwz.js"),__vite__mapDeps([24,0,1,14]),import.meta.url).then(s=>({default:s.EditBalanceDialog}))),Nw=G.lazy(()=>re(()=>import("./ChangePinDialog-DIA_5Kll.js"),__vite__mapDeps([25,0,1]),import.meta.url).then(s=>({default:s.ChangePinDialog}))),jw=G.lazy(()=>re(()=>import("./ChangeCashPinDialog-CnO4S8x1.js"),__vite__mapDeps([26,0,1,14]),import.meta.url).then(s=>({default:s.ChangeCashPinDialog}))),Sw=G.lazy(()=>re(()=>import("./ChangeWalletTotalPinDialog-DScXkFGR.js"),__vite__mapDeps([27,0,1,5]),import.meta.url).then(s=>({default:s.ChangeWalletTotalPinDialog}))),Dw=G.lazy(()=>re(()=>import("./index-CHyvkdwe.js").then(s=>s.cJ),__vite__mapDeps([0,1]),import.meta.url)),ia=G.lazy(()=>re(()=>import("./index-CHyvkdwe.js").then(s=>s.cK),__vite__mapDeps([0,1]),import.meta.url)),kw=G.lazy(()=>re(()=>import("./AddToWalletDialog-B5cjGWRN.js"),__vite__mapDeps([28,0,1]),import.meta.url).then(s=>({default:s.AddToWalletDialog}))),Cw=G.lazy(()=>re(()=>import("./CalculatorDialog-C1bdo3cJ.js"),__vite__mapDeps([29,0,1,19,4]),import.meta.url).then(s=>({default:s.CalculatorDialog}))),Iw=G.lazy(()=>re(()=>import("./SalesDataDialog-W89CFsC-.js"),__vite__mapDeps([30,0,1,31,3,32,33,4,34,10,35,36,12,37,14,11,38,20,39,8,13,16,19,40,41,7,42,17,43,44,45,46,47,48,49,5,6]),import.meta.url).then(s=>({default:s.SalesDataDialog}))),_w=G.lazy(()=>re(()=>import("./CashSummaryDialog-ZI2dq4YM.js"),__vite__mapDeps([50,0,1,14,19,4,51,36,40,41,7,42,16,17,38,37,43,8,3,32,33,34,44,45,46,47,48,11,49,5,20,6]),import.meta.url).then(s=>({default:s.CashSummaryDialog}))),Aw=G.lazy(()=>re(()=>import("./CreditCardsDialog-DuviBG5V.js"),__vite__mapDeps([52,0,1,17,39,11,14]),import.meta.url)),Tw=G.lazy(()=>re(()=>import("./InstallmentModal-BEepqRmF.js"),__vite__mapDeps([53,0,1,3,36,19,4,11]),import.meta.url)),Pw=G.lazy(()=>re(()=>import("./SimCardsDialog-BAp5aKA4.js"),__vite__mapDeps([54,0,1,35,42,31,4,16,19,32,33,55,38]),import.meta.url).then(s=>({default:s.SimCardsDialog}))),Ow=G.lazy(()=>re(()=>import("./AdslCardsDialog-BeX0azv8.js"),__vite__mapDeps([56,0,1,42,31,55,19,4,32,33,38]),import.meta.url).then(s=>({default:s.AdslCardsDialog}))),Ew=G.lazy(()=>re(()=>import("./MaintenanceDialog-CQtvIvHG.js"),__vite__mapDeps([57,0,1,3,10,36,48,37,17]),import.meta.url).then(s=>({default:s.default}))),Mw=G.lazy(()=>re(()=>import("./MachineDailyDialog-CfIjGWKt.js"),__vite__mapDeps([58,0,1,3,10,35,4,36,11]),import.meta.url)),Rw=G.lazy(()=>re(()=>import("./WalletsManagement-DpgCwtuT.js"),__vite__mapDeps([59,0,1,3,9,4,60,42,22,20,5,8,38,23,7]),import.meta.url).then(s=>({default:s.WalletsManagement}))),Ww=G.lazy(()=>re(()=>import("./WalletsListDialog-BZJ2fJb2.js"),__vite__mapDeps([61,0,1,4,5,62]),import.meta.url).then(s=>({default:s.WalletsListDialog}))),km=G.lazy(()=>re(()=>import("./WalletPrinterDialog-CaAQ48-4.js"),__vite__mapDeps([60,0,1,42,22,20,5,8,38,23]),import.meta.url)),Lw=G.lazy(()=>re(()=>import("./PendingOperationsDialog-3CfpWcOs.js"),__vite__mapDeps([63,0,1,3,41]),import.meta.url).then(s=>({default:s.PendingOperationsDialog}))),Fw=G.lazy(()=>re(()=>import("./CashierShiftModal-B0DIX9ef.js"),__vite__mapDeps([64,0,1,4,36,65]),import.meta.url)),Bw=G.lazy(()=>re(()=>import("./ShiftProfileDialog-CSLP-xED.js"),__vite__mapDeps([66,0,1]),import.meta.url)),$w=G.lazy(()=>re(()=>import("./ChangeLogDialog-PC7tTAXu.js"),__vite__mapDeps([67,0,1,68]),import.meta.url));function Uw({userId:s}){const[t,r]=G.useState(null),[i,l]=G.useState("");return null}const Vw=()=>{var Wu,Lu,Fu,Bu,$u,Uu,Vu,qu;console.log("ðŸ”¥ UserDashboardPage component is loading...");const{signOut:s,user:t,profile:r,userData:i}=ac(),l=((t==null?void 0:t.email)||"").toLowerCase()==="vodafonecash00@gmail.com",m=Am(),g=Hg(),v=Qg(),{isShiftActive:D,shiftUser:S}=Gg(),{shopId:j,shopName:A}=Pm(),E=Xg(),P=Zg(),{toast:x}=Fi(),[q,F]=d.useState(!1),[ne,K]=d.useState(!1),[U,ee]=d.useState(""),[Ie,we]=d.useState(""),Ne=(a,n)=>{ee(a),we(n),K(!0)};d.useEffect(()=>{if(t&&i){const a=i.isActive,n=Hu(i.subscription),o=i.isOnFreeTrial||!1,c=i.hasSeenWelcomeModal===!0;if(a&&(n||o)&&!c){const u=setTimeout(()=>{F(!0)},1500);return()=>clearTimeout(u)}}},[t,i]);const xe=async()=>{if(F(!1),t!=null&&t.uid)try{await ea(Pe($,"users",t.uid),{hasSeenWelcomeModal:!0})}catch(a){console.error("Failed to update welcome modal status",a)}},ae=d.useRef(null),[Le,Be]=d.useState(0),[Ve,ct]=d.useState(!1),[Ut,Me]=d.useState(!1),[st,H]=d.useState(!1),[Z,yt]=d.useState(!1),[bt,gt]=d.useState(0);d.useEffect(()=>{if(!(t!=null&&t.uid))return;const a=Ee(ce($,"pendingOperations"),Y("userId","==",t.uid),Y("status","==","pending")),n=Qu(a,o=>{gt(o.size)});return()=>n()},[t==null?void 0:t.uid]);const L=(a,n)=>{if(D&&(S!=null&&S.permissions)&&S.permissions[a]===!1){Me(!0);return}n()},ie=()=>{const a=(i==null?void 0:i.simSubscription)||(t==null?void 0:t.simSubscription);let n=!1;a!=null&&a.active&&(a!=null&&a.endsAt)&&(a.endsAt.seconds?new Date(a.endsAt.seconds*1e3):new Date(a.endsAt))>new Date&&(n=!0),n?$n(!0):vt(!0)},[se,Ce]=d.useState(!1),[ye,vt]=d.useState(!1),[rt,At]=d.useState(!1),[Va,Ia]=d.useState(!1),[_a,ks]=d.useState(!1),[ur,qa]=d.useState(!1),os=d.useRef(!1),[J,Cs]=d.useState(()=>{try{const a=Object.keys(localStorage).find(o=>o.startsWith("wallets_")),n=a?localStorage.getItem(a):null;if(n){const o=JSON.parse(n);if(Array.isArray(o))return o}}catch{}return[]}),[Is,Vi]=d.useState([]);d.useEffect(()=>{var a;(a=m.state)!=null&&a.openProfileSettings&&(ct(!0),window.history.replaceState({},document.title))},[m.state]),d.useEffect(()=>{if(t!=null&&t.uid){const a=`linesPinEnabled_${t.uid}`;if((localStorage.getItem(a)??localStorage.getItem("linesPinEnabled"))==="true"&&Ia(!0),i&&i.linesPinEnabled!==void 0){const o=i.linesPinEnabled;Ia(o),localStorage.setItem(a,o?"true":"false")}}},[t==null?void 0:t.uid,i]);const _h=async()=>{var o,c,u;const a="alkaptin678678@gmail.com",n=(c=(o=sr.currentUser)==null?void 0:o.email)==null?void 0:c.toLowerCase();if(!n||n!==a){x({title:"Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹."});return}if(!ni||!ii||!oi){x({title:"Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©",description:"Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ØŒ Ø§Ù„Ø´Ø±ÙƒØ© ÙˆØ§Ù„Ù…Ø¨Ù„Øº",variant:"destructive"});return}try{du(!0);const h=await((u=sr.currentUser)==null?void 0:u.getIdToken()),f=await fetch("/api/topup",{method:"POST",headers:{"Content-Type":"application/json",...h?{Authorization:`Bearer ${h}`}:{}},body:JSON.stringify({phone:ni,countryCode:"EG",operator:ii,amount:Number(oi),useLocalAmount:!0})}),p=await f.json().catch(()=>({}));f.ok&&(p!=null&&p.success)?(x({title:"ØªÙ… Ø§Ù„Ø´Ø­Ù†",description:(p==null?void 0:p.message)||"ØªÙ… ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø­Ù† Ø¨Ù†Ø¬Ø§Ø­"}),ul(!1),iu(""),ou(""),lu("")):x({title:"ÙØ´Ù„ Ø§Ù„Ø´Ø­Ù†",description:(p==null?void 0:p.message)||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø­Ù†",variant:"destructive"})}catch(h){console.error("Topup request error:",h),x({title:"Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹",description:"ØªØ¹Ø°Ù‘Ø± ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø­Ù†. Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹.",variant:"destructive"})}finally{du(!1)}};(()=>{try{return!!window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron")||typeof window<"u"&&window.location&&window.location.protocol==="file:"}catch{return!1}})();const[Ah,mr]=d.useState(!1),[Th,Ph]=d.useState(!1),[Oh,Eh]=d.useState(!1),[Mh,qi]=d.useState(!1),[hr,fr]=d.useState(!1),[Rh,gr]=d.useState(!1),[pr,zi]=d.useState([]),[bc,Yi]=d.useState(""),[vc,Ki]=d.useState(""),[wc,Ji]=d.useState(""),[Nc,Hi]=d.useState(""),[Qi,wn]=d.useState(!1),[Wh,Gi]=d.useState(!1),[Lh,qw]=d.useState(null),[jc,Sc]=d.useState(""),[Dc,kc]=d.useState(""),[Fh,Cc]=d.useState(!1),[Bh,Nn]=d.useState(!1),[$h,Ic]=d.useState(!1),[Et,Uh]=d.useState(null),[_s,_c]=d.useState(!1),[Ac,Vh]=d.useState(!1),[pt,qh]=d.useState(null);d.useEffect(()=>{ep().then(qh).catch(()=>{})},[]);const[Tc,zh]=d.useState(void 0);d.useEffect(()=>{try{const a=window.electronAPI;a&&typeof a.appVersion=="function"&&a.appVersion().then(n=>{typeof n=="string"&&!n.startsWith("err:")&&zh(n)}).catch(()=>{})}catch{}},[]);const Pc=(()=>{var o,c;const a=(c=(o=import.meta)==null?void 0:o.env)==null?void 0:c.VITE_APP_VERSION,n=typeof window<"u"&&(window.electronAPI||window.location.protocol==="file:"||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"));if(n&&(r!=null&&r.desktopInstalledVersion))return r==null?void 0:r.desktopInstalledVersion;if(n&&Tc)return Tc;if(a)return a;if(!(!pt&&!r))return P?(r==null?void 0:r.androidInstalledVersion)||(r==null?void 0:r.lastAckAndroidVersion)||(pt==null?void 0:pt.androidVersion)||(pt==null?void 0:pt.pcVersion):(pt==null?void 0:pt.pcVersion)||(pt==null?void 0:pt.androidVersion)})();d.useEffect(()=>{hr&&(t!=null&&t.uid)&&!Ac&&(async()=>{wn(!0);try{let n=[],o=[];try{const f=ce($,"users",t.uid,"branches");n=(await ke(f)).docs.map(w=>({id:w.id,...w.data(),source:"sub"}))}catch(f){console.warn("Failed to fetch subcollection branches:",f)}try{const f=Ee(ce($,"branches"),Y("ownerId","==",t.uid));o=(await ke(f)).docs.map(w=>({id:w.id,...w.data(),source:"root"}))}catch(f){console.warn("Failed to fetch root branches:",f)}const c=[...n,...o],u=new Map;c.forEach(f=>{const p=f.branchUserId||f.id;(!u.has(p)||f.source==="sub")&&u.set(p,f)});const h=Array.from(u.values());console.log("Loaded branches:",h),zi(h),Vh(!0)}catch(n){console.error("Error in branch loading process:",n),x({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©",variant:"destructive"})}finally{wn(!1)}})()},[hr,t==null?void 0:t.uid,Ac]),d.useEffect(()=>{hr||_c(!1)},[hr]);const[Yh,jn]=d.useState(!1),[Oc,Ec]=d.useState(!1),[As,Kh]=d.useState(null),[Sn,Mc]=d.useState(""),[Dn,Rc]=d.useState(""),[Jh,Hh]=d.useState(""),[Wc,Lc]=d.useState(!1),Qh=a=>{Kh(a),Mc(a.branchName||""),Rc(a.managerName||""),Hh(a.loginUsername||a.email||a.username||""),jn(!0)},Gh=async()=>{if(!(!As||!Sn||!Dn)){Lc(!0);try{const a={branchName:Sn,managerName:Dn,updatedAt:new Date};if(As.branchUserId)try{await sa(Pe($,"users",(t==null?void 0:t.uid)||"","branches",String(As.branchUserId)),a,{merge:!0});try{await ea(Pe($,"users",As.branchUserId),{displayName:Sn,managerName:Dn})}catch(n){console.warn("Could not update branch root user doc",n)}}catch(n){console.warn("Sub branch update failed:",n)}try{await ea(Pe($,"branches",As.id),a)}catch{}zi(n=>n.map(o=>o.id===As.id?{...o,...a}:o)),x({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ Ø¨Ù†Ø¬Ø§Ø­"}),jn(!1)}catch(a){console.error("Error updating branch:",a),x({title:"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",description:a.message,variant:"destructive"})}finally{Lc(!1)}}},Xh=async a=>{if(!(a!=null&&a.branchUserId)){x({title:"Ø®Ø·Ø£",description:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",variant:"destructive"});return}Ic(!0),Nn(!0);try{const n=a.branchUserId;if(t!=null&&t.uid&&a.branchUserId&&a.source!=="sub")try{await sa(Pe($,"users",t.uid,"branches",a.branchUserId),{branchUserId:a.branchUserId,branchName:a.branchName||"Unknown Branch",managerName:a.managerName||"",active:!0,lastSynced:ft()},{merge:!0}),console.log("âœ… Branch link synced successfully"),await new Promise(Oe=>setTimeout(Oe,500))}catch(Oe){console.error("âŒ Failed to sync branch link:",Oe)}const[o,c,u,h]=await Promise.all([la(Pe($,"users",n)),(async()=>{try{const Oe=Ee(ce($,"merchantWallets"),Y("merchantUserId","==",n)),ge=await ke(Oe);if(!ge.empty)return ge;const et=await ke(ce($,"users",n,"wallets"));return et.empty?await ke(Ee(ce($,"wallets"),Y("userId","==",n))):et}catch(Oe){console.error("Error fetching wallets",Oe);try{return await ke(Ee(ce($,"wallets"),Y("userId","==",n)))}catch{return{docs:[]}}}})(),(async()=>{try{return await ke(Ee(ce($,"debts"),Y("userId","==",n)))}catch{return await ke(ce($,"users",n,"debts"))}})(),(async()=>{try{const Oe=Ee(ce($,"dailySales"),Y("userId","==",n)),ge=await ke(Oe);return ge.empty?await ke(ce($,"users",n,"dailySales")):ge}catch(Oe){return console.error("Error fetching sales",Oe),await ke(ce($,"users",n,"dailySales"))}})()]),f=o.exists()?o.data():{},p=Number(f.cashBalance||0),w=f.reportsData||{},b=Number(w.dailyProfit||0),y=Number(w.monthlyProfit||0),N=f.walletBalances||{},k=c.docs.filter(Oe=>Oe.data().isActive===!0),C=new Set(k.map(Oe=>Oe.id));let T=0;C.size>0&&(T=Object.entries(N).filter(([Oe])=>C.has(Oe)).reduce((Oe,[ge,et])=>Oe+Number(et||0),0)),T===0&&k.length>0&&(T=k.reduce((Oe,ge)=>Oe+Number(ge.data().balance||ge.data().amount||0),0));let R=0;u.forEach(Oe=>{const ge=Oe.data();if(ge.type!=="debtor"){const et=Number(ge.paidAmount||0),ht=Math.max(0,Number(ge.amount||0)-et);R+=ht}});const O=new Date().toISOString().split("T")[0],V=O.slice(0,7);let le=0,te=0,Ae=b,Xe=y,Ze=0;console.log(`Branch Details - UID: ${n}, Wallets: ${c.size}, Sales: ${h.size}, ReportsDaily: ${b}`),h.forEach(Oe=>{const ge=Oe.data(),et=String(ge.date||""),ht=Number(ge.sellingPrice||0)*Number(ge.quantity||1),lt=Number(ge.profit||0);Ze+=ht,et===O&&(le+=ht,Ae+=lt),et.startsWith(V)&&(te+=ht,Xe+=lt)}),Uh({branchName:a.branchName,managerName:a.managerName,todaySales:le,monthSales:te,todayProfit:Ae,monthProfit:Xe,walletsTotal:T,cashBalance:p,totalSalesSection:Ze,debtsTotal:R})}catch(n){console.error("Error fetching branch details:",n),x({title:"ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹",description:n.message,variant:"destructive"}),Nn(!1)}finally{Ic(!1)}},[M,xr]=d.useState("");d.useEffect(()=>{const a=v==null?void 0:v.shopId;if(a&&(t!=null&&t.uid))try{const n=`selectedShopId_${t.uid}`;localStorage.setItem(n,String(a)),window.dispatchEvent(new Event("selectedShopIdChanged"))}catch{}},[v==null?void 0:v.shopId,t==null?void 0:t.uid]);const[Xi,Zh]=d.useState([]),[ls,cs]=d.useState(()=>{try{return localStorage.getItem("cashySelectedDevice")||null}catch{return null}});d.useEffect(()=>{},[]),d.useEffect(()=>{(async()=>{if(M)try{await an.set({key:"selected_wallet_id",value:M}),console.log("ðŸ“± Synced selected_wallet_id to Native:",M)}catch(n){console.error("Failed to sync wallet to native:",n)}else await an.remove({key:"selected_wallet_id"})})()},[M]),d.useEffect(()=>{(async()=>{if(j)try{await an.set({key:"shopId",value:j}),console.log("ðŸ“± Synced shopId to Native:",j)}catch(n){console.error("Failed to sync shopId to native:",n)}})()},[j]);const Zi=a=>!!(a&&Xi.some(n=>n.id===a));async function eo(){const a=window.electronAPI,n=ls||"";if(!a||typeof a.sendUssd!="function")return null;if(!n)return x({title:"Ø§Ù„Ø¬Ù‡Ø§Ø² ØºÙŠØ± Ù…Ø­Ø¯Ø¯",description:"Ø§ØªØµÙ„ Ø¨Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù‡Ø§Ø² Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©",variant:"destructive"}),null;if(Zi(n))return n;try{const h=Xi.find(f=>f&&f.id&&!String(f.id).includes(":"));if(h&&h.id)return cs(h.id),h.id}catch{}const o=n.includes(":")?n.split(":").slice(0,2).join(":"):"";if(o&&typeof a.connectWifi=="function"){try{const h=await a.connectWifi(o);if(typeof h=="string"&&(h.includes("âœ…")||h.toLowerCase().includes("connected")))return n}catch{}if(typeof a.refreshAdbDevices=="function")try{await a.refreshAdbDevices()}catch{}await new Promise(h=>setTimeout(h,250))}const c=n.split(":")[0],u=Xi.find(h=>(h.id.startsWith(c)||h.id.includes(c))&&h.id.includes(":"));if(u!=null&&u.id){const h=u.id.split(":").slice(0,2).join(":");if(!Zi(u.id)&&typeof a.connectWifi=="function"){try{const f=await a.connectWifi(h);if(typeof f=="string"&&(f.includes("âœ…")||f.toLowerCase().includes("connected")))return cs(u.id),u.id}catch{}await new Promise(f=>setTimeout(f,250))}if(Zi(u.id))return cs(u.id),u.id}return n&&o?n:(x({title:"Ø§Ù„Ø¬Ù‡Ø§Ø² ØºÙŠØ± Ù…ØªØµÙ„",description:"ÙØ¹Ù‘Ù„ Wireless debugging Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø§ØªØµØ§Ù„ Wiâ€‘Fi Ø«Ù… Ø£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©",variant:"destructive"}),null)}d.useEffect(()=>{const a=window.electronAPI;a&&typeof a.onAdbDevices=="function"&&a.onAdbDevices(n=>{var h;const o=Array.isArray(n)?n:[];Zh(o);const c=(()=>{try{return localStorage.getItem("cashySelectedDevice")||""}catch{return""}})();if(c&&o.some(f=>f.id===c))cs(c);else{const f=c?String(c).split(":")[0]:"",p=f?o.find(w=>(w.id.startsWith(f)||w.id.includes(f))&&String(w.type||"").toLowerCase().includes("wifi")):void 0;p!=null&&p.id?cs(p.id):!c&&((h=o[0])!=null&&h.id)?cs(w=>w||o[0].id):o.length||cs(null)}})},[]);function e0(a,n){try{const o=nt==null?void 0:nt(),c=(o==null?void 0:o.phone)||"";if(!c){x({title:"ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø©",description:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…ÙØ±Ø³Ù„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}if(P&&c.startsWith("011")){Fl("*777*1#"),x({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… Ø·Ù„Ø¨ ÙƒÙˆØ¯ Ø§ØªØµØ§Ù„Ø§Øª *777*1#"}),ua(!1),Pa(!1);return}xp(c,a,n),x({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ"}),ua(!1),Pa(!1)}catch(o){const c=(o==null?void 0:o.message)||"ØªØ¹Ø°Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ â€” ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";throw x({title:"ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:c,variant:"destructive"}),o}}const[Vt,to]=d.useState(null),t0=async()=>{var f;if(!ut||!ut.receiver||!ut.amount){x({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",variant:"destructive"});return}const a=String(ut.receiver),n=Math.round(Number(ut.amount));ma(!0);const o=nt==null?void 0:nt(),c=(o==null?void 0:o.phone)||"",u=pp(c),h=window.electronAPI;if(u==="etisalat"&&c.startsWith("011")&&h&&typeof h.sendUssd=="function"&&ls){try{const p=await eo();if(!p){ma(!1);return}let w=p;Vt!==null&&(w=`${p}:sim${Vt}`),Wo(w),await h.sendUssd(w,"*777*1#"),Dd(!0),ua(!1)}catch(p){console.error("Etisalat flow init error",p),x({title:"Ø®Ø·Ø£",description:"ÙØ´Ù„ Ø¨Ø¯Ø¡ ØªØ­ÙˆÙŠÙ„ Ø§ØªØµØ§Ù„Ø§Øª: "+(p.message||""),variant:"destructive"})}finally{ma(!1)}return}if(u==="orange"&&c.startsWith("012")&&h&&typeof h.sendUssd=="function"&&ls){try{const p=await eo();if(!p){ma(!1);return}const w=`*7115*7*${a}*${n}#`;let b=p;Vt!==null&&(b=`${p}:sim${Vt}`),Wo(b),await h.sendUssd(b,w),Pa(!0),ua(!1)}catch(p){console.error("Orange flow init error",p),x({title:"Ø®Ø·Ø£",description:"ÙØ´Ù„ Ø¨Ø¯Ø¡ ØªØ­ÙˆÙŠÙ„ Ø£ÙˆØ±Ù†Ø¬: "+(p.message||""),variant:"destructive"})}finally{ma(!1)}return}try{if((f=Mi)!=null&&f.isNativePlatform&&Mi.getPlatform()==="android"){const w=nt==null?void 0:nt(),b=(w==null?void 0:w.phone)||"";if(!b){x({title:"ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø©",description:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…ÙØ±Ø³Ù„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"}),ma(!1);return}if(b.startsWith("011")){Fl("*777*1#",Vt===0?"sim1":Vt===1?"sim2":void 0),x({title:"ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„",description:"ØªÙ… Ø·Ù„Ø¨ ÙƒÙˆØ¯ Ø§ØªØµØ§Ù„Ø§Øª *777*1#"}),ua(!1),Pa(!1);return}const y=tm(b,a,n);if(!y){x({title:"Ø±Ù‚Ù… ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø±Ù‚Ù… 010/011/012/015",variant:"destructive"}),ma(!1);return}Fl(y,Vt===0?"sim1":Vt===1?"sim2":void 0),x({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ"}),ua(!1),Pa(!1);return}const p=window.electronAPI;if(p&&typeof p.sendUssd=="function"&&ls){const w=nt==null?void 0:nt(),b=(w==null?void 0:w.phone)||"";if(!b){x({title:"ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø©",description:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…ÙØ±Ø³Ù„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"}),ma(!1);return}const y=await eo();if(!y){ma(!1);return}const N=tm(b,a,n);if(!N){x({title:"Ø±Ù‚Ù… ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø±Ù‚Ù… 010/011/012/015",variant:"destructive"}),ma(!1);return}try{let k="";if(Vt!==null)k=`${y}:sim${Vt}`;else{const C=typeof p.pickSimAutomatically=="function"?await p.pickSimAutomatically(y,b):{deviceId:y,slot:0};k=`${C.deviceId}:sim${C.slot}`}Wo(k),await p.sendUssd(k,N)}catch{try{await p.sendUssd(y,N)}catch(C){const T=y.includes(":")?y.split(":").slice(0,2).join(":"):"";if(T&&typeof p.connectWifi=="function")await p.connectWifi(T),await p.sendUssd(y,N);else throw C}}if(x({title:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",description:"ØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ° Ø¨Ù†Ø¬Ø§Ø­"}),ua(!1),Sd(void 0),p&&typeof p.getRecipientName=="function"&&y){jd(!0);try{const k=await p.getRecipientName(y);k&&typeof k=="string"&&Sd(k)}catch(k){console.error("Name fetch error",k)}finally{jd(!1)}}Pa(!0)}else e0(a,n)}catch(p){const w=p&&p.message?p.message:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„";x({title:"Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:`Ø§Ù„Ø¬Ù‡Ø§Ø²: ${Ro||ls||"ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"} â€” ${w}`,variant:"destructive"})}finally{ma(!1)}},a0=async(a,n)=>{const o=window.electronAPI;try{if(o&&typeof o.enterPin=="function"&&a){await o.enterPin(a,n),Pa(!1),Gc(!0);try{const y=await o.getTransactionResult(a);y==="success"?(Aa("success"),Dr(null)):y==="limit_exceeded"?(Aa("limit_exceeded"),Ms&&(console.log("â†©ï¸ Reverting transaction due to limit exceeded:",Ms),await Pl(Ms),Dr(null))):y==="no_wallet"&&(Aa("no_wallet"),Ms&&(console.log("â†©ï¸ Reverting transaction due to no wallet:",Ms),await Pl(Ms),Dr(null)))}catch(y){console.error("Transaction check error",y)}finally{Gc(!1)}return}const c=String((r==null?void 0:r.bridgeLink)||"").trim(),u=String((r==null?void 0:r.bridgeDeviceId)||"").trim()||void 0;if(!c){x({title:"Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙØ¹Ø¯Ù‘",description:"Ø§Ø­ÙØ¸ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø³Ø± Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}const h=String((ut==null?void 0:ut.receiver)||kt||"").replace(/\D/g,""),f=Math.max(1,Math.round(Number((ut==null?void 0:ut.amount)||xt||0))||0),p=String(n||"").replace(/\D/g,""),b=(y=>{let N=(y||"").trim();return N=N.replace(/\/+$/,""),/^https?:\/\//i.test(N)||(N=`https://${N}`),N})(c);Pa(!1)}catch(c){const u=(c==null?void 0:c.message)||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ";x({title:"ÙØ´Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„",description:u,variant:"destructive"})}};console.log("ðŸ”¥ UserDashboardPage - user:",t?"exists":"null");const[yr,za]=d.useState(!0),[ao,br]=d.useState(!0),[s0,ds]=d.useState(!1),[r0,Ts]=d.useState(!1),[kn,Fc]=d.useState(""),[so,Bc]=d.useState(""),[ro,$c]=d.useState(""),[Cn,no]=d.useState([]),[n0,In]=d.useState(!1),[St,vr]=d.useState(null),[Ps,io]=d.useState(""),[zw,Yw]=d.useState(!1),[i0,oo]=d.useState(!1),[o0,Ya]=d.useState(!1),[l0,wr]=d.useState(!1),[Nr,lo]=d.useState(""),[Uc,co]=d.useState(""),[Vc,Os]=d.useState([]),[c0,_n]=d.useState(!1),[uo,Es]=d.useState({}),[An,Tn]=d.useState(null),[qc,jr]=d.useState(""),[zc,Sr]=d.useState(""),[Kw,Yc]=d.useState(!1),[Jw,Kc]=d.useState(0),[Hw,Jc]=d.useState(!1),[Mt,Hc]=d.useState(null),[Dt,d0]=d.useState(null),[Qw,Qc]=d.useState(!1),[mo,Aa]=d.useState(null),[u0,Gc]=d.useState(!1),[Ms,Dr]=d.useState(null),[Ht,Rs]=d.useState(""),[kt,kr]=d.useState(""),[xt,Ws]=d.useState(""),[us,Xc]=d.useState(""),[Cr,Zc]=d.useState(""),[ho,Ls]=d.useState(!1),[fo,go]=d.useState(""),[m0,ms]=d.useState(""),[ed,td]=d.useState(""),[po,h0]=d.useState(""),[ca,xo]=d.useState(null),[f0,ad]=d.useState(!1),[g0,sd]=d.useState(!1),[p0,Pn]=d.useState(!1),[x0,yo]=d.useState(!1),[rd,bo]=d.useState(null),[dt,On]=d.useState(""),[Ct,En]=d.useState(""),[nd,y0]=d.useState(""),[b0,id]=d.useState(!1),[Gw,Xw]=d.useState(null),[vo,od]=d.useState(null),[v0,wo]=d.useState(!1);d.useEffect(()=>{(async()=>{try{const n=t!=null&&t.uid?`withdrawSenderNameInputEnabled_${t==null?void 0:t.uid}`:"withdrawSenderNameInputEnabled";let o=null;try{o=localStorage.getItem(n)??localStorage.getItem("withdrawSenderNameInputEnabled")}catch{}if(t!=null&&t.uid)try{const c=await ys(()=>oe.getUserData(t.uid)),u=c==null?void 0:c.withdrawSenderNameInputEnabled;if(typeof u=="boolean"){wo(u);try{localStorage.setItem(n,u?"true":"false")}catch{}return}}catch{}wo(o==="true")}catch{wo(!1)}})()},[t==null?void 0:t.uid]),d.useEffect(()=>{try{const a=`clientNumberAssignments_${(t==null?void 0:t.uid)||"default"}`,n=localStorage.getItem(a);if(!n){Es({});return}const o=JSON.parse(n);if(o&&typeof o=="object"){const c={};Object.entries(o).forEach(([u,h])=>{if(typeof h=="string")c[u]={name:h,amount:""};else if(h&&typeof h=="object"){const f=h,p=typeof f.name=="string"?f.name:"",w=typeof f.amount=="string"||typeof f.amount=="number"?String(f.amount):"";(p||w)&&(c[u]={name:p,amount:w})}}),Es(c)}else Es({})}catch{Es({})}},[t==null?void 0:t.uid]);const Ir=a=>{const n="Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©",o="Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹";return(a||"").split("").map(c=>{const u=n.indexOf(c);if(u>-1)return String(u);const h=o.indexOf(c);return h>-1?String(h):c}).join("")},[Je,w0]=d.useState(!0),ld=G.useMemo(()=>{if((r==null?void 0:r.transferFeesEnabled)!==void 0)return r.transferFeesEnabled;try{const a=t!=null&&t.uid?`transferFeesEnabled_${t.uid}`:"transferFeesEnabled";return(localStorage.getItem(a)??localStorage.getItem("transferFeesEnabled"))!=="false"}catch{return!0}},[r,t==null?void 0:t.uid]),[B,No]=d.useState("transfer"),N0=G.useMemo(()=>{const a=Ir(Ht||"").replace(/\D/g,""),n=Ir(kt||"").replace(/\D/g,"");return!ld||B!=="transfer"?!1:a.startsWith("010")&&n.startsWith("010")||a.startsWith("010")&&(n.startsWith("011")||n.startsWith("012")||n.startsWith("015"))||a.startsWith("012")&&n.startsWith("010")||a.startsWith("011")&&n.startsWith("010")||a.startsWith("015")&&n.startsWith("010")},[Ht,kt,ld,B]),[he,qt]=d.useState([]),[Qt,_r]=d.useState("all"),[Re,zt]=d.useState([]),[jo,j0]=d.useState(!1),[So,S0]=d.useState([]),[Fs,D0]=d.useState(new Date().toISOString().split("T")[0]),[hs,cd]=d.useState("day");d.useEffect(()=>{if(!jo||!(t!=null&&t.uid))return;(async()=>{try{let n;if(hs==="day"){const u=new Date(Fs);u.setHours(0,0,0,0);const h=new Date(Fs);h.setHours(23,59,59,999),n=Ee(ce($,"debtReceipts"),Y("userId","==",t.uid),Y("createdAt",">=",u),Y("createdAt","<=",h),Ll("createdAt","desc"))}else{const[u,h]=Fs.split("-").map(Number),f=new Date(u,h-1,1),p=new Date(u,h,0,23,59,59,999);n=Ee(ce($,"debtReceipts"),Y("userId","==",t.uid),Y("createdAt",">=",f),Y("createdAt","<=",p),Ll("createdAt","desc"))}const c=(await ke(n)).docs.map(u=>({id:u.id,...u.data()}));S0(c)}catch(n){console.error("Error fetching debt receipts:",n),x({title:"Ø®Ø·Ø£",description:"ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„ Ø§Ù„Ø³Ø¯Ø§Ø¯",variant:"destructive"})}})()},[jo,t==null?void 0:t.uid,Fs,hs]);const Ta=d.useRef([]),[Do,ko]=d.useState(!1),[Ka,k0]=d.useState(""),[Mn,C0]=d.useState("daily"),[Ja,I0]=d.useState(""),[Bs,Ar]=d.useState(null),_0=a=>{if(!a){Ar(null);return}const n=new Date(a),o=new Date(n.setHours(0,0,0,0)),c=new Date(n.setHours(23,59,59,999)),u=he.filter(y=>{const N=new Date(y.createdAt);return N>=o&&N<=c});let h=0,f=0,p=0,w=0,b=0;u.forEach(y=>{h++,f+=Number(y.amount||0);const N=(y.type||y.txnType||"").toLowerCase(),k=N==="machine_withdrawal"||y.title==="Ø¥ÙŠØµØ§Ù„ Ø³Ø­Ø¨ ÙÙˆØ±ÙŠ";!k&&(N==="withdraw"||N==="withdrawal"||N==="receive")?p+=Number(y.amount||0):!k&&(N==="send"||N==="transfer")&&(w+=Number(y.amount||0)),b+=fa.calculateProfitFromTransaction(y)}),Ar({count:h,totalAmount:f,totalWithdrawn:p,totalSent:w,totalProfit:b})},A0=a=>{if(!a){Ar(null);return}const[n,o]=a.split("-"),c=Number(n),u=Number(o)-1,h=new Date(c,u,1,0,0,0,0),f=new Date(c,u+1,0,23,59,59,999),p=he.filter(C=>{const T=new Date(C.createdAt),R=String(C.status||C.status||"completed").toLowerCase();return T>=h&&T<=f&&(R==="completed"||R==="confirmed")});let w=0,b=0,y=0,N=0,k=0;p.forEach(C=>{w++,b+=Number(C.amount||0);const T=(C.type||C.txnType||"").toLowerCase(),R=T==="machine_withdrawal"||C.title==="Ø¥ÙŠØµØ§Ù„ Ø³Ø­Ø¨ ÙÙˆØ±ÙŠ";!R&&(T==="withdraw"||T==="withdrawal"||T==="receive")?y+=Number(C.amount||0):!R&&(T==="send"||T==="transfer")&&(N+=Number(C.amount||0)),k+=fa.calculateProfitFromTransaction(C)}),Ar({count:w,totalAmount:b,totalWithdrawn:y,totalSent:N,totalProfit:k})};d.useEffect(()=>{Do&&(Mn==="daily"&&Ka?_0(Ka):Mn==="monthly"&&Ja?A0(Ja):Ar(null))},[Ka,Ja,Mn,he,Do]);const Tr=un({enabled:!!(t!=null&&t.uid),queryKey:["recentTransactions",t==null?void 0:t.uid,j||"main"],queryFn:async()=>{const{collection:a,query:n,where:o,orderBy:c,limit:u,getDocs:h}=await re(async()=>{const{collection:_,query:O,where:V,orderBy:le,limit:te,getDocs:Ae}=await import("./index-CHyvkdwe.js").then(Xe=>Xe.cF);return{collection:_,query:O,where:V,orderBy:le,limit:te,getDocs:Ae}},__vite__mapDeps([0,1]),import.meta.url),{db:f}=await re(async()=>{const{db:_}=await import("./index-CHyvkdwe.js").then(O=>O.cG);return{db:_}},__vite__mapDeps([0,1]),import.meta.url),p=n(a(f,"userTransactions"),o("userId","==",String((t==null?void 0:t.uid)||"")),c("createdAt","desc"),u(100)),y=(await h(p)).docs.map(_=>{var ge;const O=_.data(),V=(ge=O.createdAt)!=null&&ge.toDate?O.createdAt.toDate():new Date(O.createdAt),le=String(O.transactionType||O.txnType||O.type||"").toLowerCase();let te="send";le==="withdraw"||le==="receive"?te="withdraw":le==="machine_withdrawal"?te="machine_withdrawal":le==="cash_addition"||le==="add"?te="cash_addition":te="send";const Ae=O.status==="confirmed"?"completed":O.status||"completed",Xe=O.senderMsisdn||O.senderPhone||"",Ze=O.receiverMsisdn||O.receiverPhone||"",Oe=Number(O.amount??O.transferredAmount??O.withdrawnAmount??0);return{id:_.id,...O,type:te,status:Ae,senderPhone:Xe,receiverPhone:Ze,amount:Oe,createdAt:V}}).filter(_=>!((_==null?void 0:_.type)==="report"||String((_==null?void 0:_.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"))),N=new Set((Or||[]).map(_=>String(_.id||_.originalTransactionId||""))),k=y.filter(_=>!N.has(String(_.id||""))),C=_=>{var O;return String(_.transactionId||_.id||_.reference||((O=_.receipt)==null?void 0:O.reference)||`${new Date(_.createdAt).getTime()}`)},T=new Set,R=[];for(const _ of k){const O=C(_);T.has(O)||(T.add(O),R.push(_))}return R},staleTime:6e4,gcTime:3e5,refetchOnWindowFocus:!1,refetchOnReconnect:!0});d.useEffect(()=>{const a=()=>{try{Tr.refetch()}catch{}};return window.addEventListener("transaction-created",a),()=>{window.removeEventListener("transaction-created",a)}},[Tr]),d.useEffect(()=>{const a=Tr.data;if(a&&Array.isArray(a)){const n=Ta.current,o=Date.now(),c=n.filter(p=>{const w=a.some(N=>N.id===p.id),b=p.reference?a.some(N=>N.reference===p.reference):!1,y=o-new Date(p.createdAt).getTime()>3e5;return!w&&!b&&!y});Ta.current=c;const u=[...c,...a].sort((p,w)=>new Date(w.createdAt).getTime()-new Date(p.createdAt).getTime()),h=new Set,f=[];for(const p of u)h.has(p.id)||(h.add(p.id),f.push(p));qt(f)}},[Tr.data]),d.useEffect(()=>{try{if(localStorage.setItem("commissionMode",Je?"add":"deduct"),t!=null&&t.uid){const a=`commissionMode_${t.uid}`;localStorage.setItem(a,Je?"add":"deduct")}}catch{}},[Je,t==null?void 0:t.uid]),d.useEffect(()=>{try{const a=new Set((he||[]).filter(c=>String((c==null?void 0:c.status)||"")==="completed"&&(c==null?void 0:c.linkedDebtId)).map(c=>String(c.linkedDebtId)));if(a.size===0||Re.length===0)return;const n=Re.map(c=>{if(!a.has(String(c.id)))return c;const u=Number(c.amount||0),h=Number(c.paidAmount||0);return h>=u&&c.status!=="paid"?{...c,amount:u,paidAmount:u,status:"paid"}:h>u?{...c,amount:u,paidAmount:u}:c});if(n.some((c,u)=>c!==Re[u])){zt(n),(async()=>await Oa(n))();try{t!=null&&t.uid&&n.filter((u,h)=>u!==Re[h]&&u.status==="paid").forEach(u=>{try{const h=Number(u.paidAmount||0),f=h>0?h:Number(u.amount||0);vs.send(t.uid,`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${u.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${f} Ø¬Ù†ÙŠÙ‡`).catch(()=>{})}catch{}})}catch{}}}catch{}},[he,Re,t==null?void 0:t.uid]),d.useEffect(()=>{try{const a=t!=null&&t.uid?localStorage.getItem(`commissionMode_${t.uid}`):null,n=localStorage.getItem("commissionMode"),o=localStorage.getItem("commissionMode_default"),c=a??n??o;c&&w0(c==="add")}catch{}},[t==null?void 0:t.uid]);const[Co,$s]=d.useState(!1),[T0,P0]=d.useState(null),Rn=G.useRef(""),dd=G.useRef(0);d.useEffect(()=>{const a=n=>{var c;if(Co)return;try{const u=document.activeElement;if(u){const h=(c=u.tagName)==null?void 0:c.toLowerCase();if(h==="input"||h==="textarea"||h==="select"||h==="button"||u.isContentEditable===!0)return}}catch{}const o=Date.now();if(n.key==="Enter"){const u=(Rn.current||"").trim();Rn.current="",u&&(P0(u),$s(!0));return}n.key.length===1&&(o-(dd.current||0)>100&&(Rn.current=""),Rn.current+=n.key,dd.current=o)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[Co]);const[O0,E0]=d.useState(!1),[M0,Io]=d.useState(!1),[R0,Zw]=d.useState(null);d.useEffect(()=>{if(!ho)return;const a=nt(),n=parseFloat(xt||"0")||0;let o=0;if(B==="transfer"){if((a==null?void 0:a.defaultTransferCommission)!=null){const u=Number(a.defaultTransferCommission)||0;o=Math.round(u*n/1e3*100)/100}else{const u=Ct&&Ct.trim()!==""?parseFloat(Ct):0;o=Math.max(0,u)}const c=n+o;ms((c||0).toString())}else{if((a==null?void 0:a.defaultWithdrawCommission)!=null){const u=Number(a.defaultWithdrawCommission)||0;o=Math.round(u*n/1e3*100)/100}else{const u=dt&&dt.trim()!==""?parseFloat(dt):Math.round(n*.01*100)/100;o=Math.max(0,u)}const c=Je?n:Math.max(0,Math.round((n-o)*100)/100);ms((c||0).toString())}},[ho,xt,Ct,dt,M,Je,B]);const nt=()=>{var n,o;let a=J.find(c=>c.id===M);if(!a)try{const c=localStorage.getItem(gu());if(c){const u=JSON.parse(c);if(Array.isArray(u)&&u.length>0){const f=localStorage.getItem(ps())||((n=u.find(p=>p.isDefault))==null?void 0:n.id)||((o=u[0])==null?void 0:o.id);a=u.find(p=>p.id===f)}}}catch{}return a};d.useLayoutEffect(()=>{try{const a=`wallets_${(t==null?void 0:t.uid)||"default"}`;let n=localStorage.getItem(a);if(!n){const o=Object.keys(localStorage).find(c=>c.startsWith("wallets_"));o&&(n=localStorage.getItem(o)||null)}if(n){const o=JSON.parse(n);if(Array.isArray(o)&&o.length>0){Cs(o);const c=localStorage.getItem(ps()),u=c&&o.find(h=>h.id===c)||o.find(h=>h.isDefault)||o[0];u&&(xr(u.id),Rs(u.phone))}}}catch(a){console.error("ØªÙ‡ÙŠØ¦Ø© ÙÙˆØ±ÙŠØ© Ù„Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ ÙØ´Ù„Øª:",a)}},[]),d.useEffect(()=>{console.log("ðŸ” selectedWallet state changed to:",M)},[M]),d.useEffect(()=>{hu()},[t==null?void 0:t.uid]),d.useEffect(()=>{Zf()},[]);const Wn=un({enabled:!!(t!=null&&t.uid),queryKey:["wallets",t==null?void 0:t.uid],queryFn:async()=>{const{merchantWalletService:a}=await re(async()=>{const{merchantWalletService:c}=await import("./index-CHyvkdwe.js").then(u=>u.cH);return{merchantWalletService:c}},__vite__mapDeps([0,1]),import.meta.url),n=await a.getByMerchantId(String((t==null?void 0:t.uid)||""));return(Array.isArray(n)?n:[]).filter(c=>c.isActive===!0).map(c=>({id:c.id,name:c.label||"Ù…Ø­ÙØ¸Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",phone:c.msisdn,isDefault:!!c.isDefault,monthlyWithdrawalLimit:c.monthlyWithdrawalLimit??c.withdrawLimit??2e5,monthlyTransferLimit:c.monthlyTransferLimit??c.transferLimit??2e5,defaultTransferCommission:c.defaultTransferCommission!=null?Number(c.defaultTransferCommission):null,defaultWithdrawCommission:c.defaultWithdrawCommission!=null?Number(c.defaultWithdrawCommission):null}))},staleTime:6e4,gcTime:3e5,refetchOnReconnect:!0});d.useEffect(()=>{var n;const a=Wn.data;if(a&&Array.isArray(a)){Cs(a);const o=localStorage.getItem(ps());if(!!!(M&&a.find(u=>u.id===M))){const u=o&&a.find(h=>h.id===o)?o:((n=a[0])==null?void 0:n.id)||"";if(u){xr(u);const h=a.find(f=>f.id===u);Rs(String((h==null?void 0:h.phone)||""))}}}},[Wn.data]),d.useEffect(()=>{const a=n=>{const{cashBalance:o,walletBalances:c,newTransaction:u,limitUpdate:h,delta:f}=n.detail||{};if(f){const{amount:p,type:w,walletId:b,commission:y,totalDeducted:N}=f,k=Number(p||0),C=Number(y||0),T=Number(N||k+C);ot(R=>{let _=0;w==="withdraw"?_=-k+C:w==="send"||w==="transfer"?_=k+C:w==="atm_withdraw"&&(_=k);const O=R+_;try{const V=Ye();localStorage.setItem(V,String(O));const le=new Date().toISOString();if(localStorage.setItem(V+"_lastUpdated",le),t!=null&&t.uid){const te=`userData_${t.uid}`,Ae=localStorage.getItem(te),Ze={...Ae?JSON.parse(Ae):{},cashBalance:O,lastUpdated:le};localStorage.setItem(te,JSON.stringify(Ze)),ve(!0)}}catch{}return O}),b&&mt(R=>{const _=Number(R[b]||0);let O=0;w==="withdraw"?O=k:w==="send"||w==="transfer"?O=-k:w==="atm_withdraw"&&(O=-T);const V=_+O,le={...R,[b]:V};try{const te=Ge();localStorage.setItem(te,JSON.stringify(le));const Ae=new Date().toISOString();if(localStorage.setItem(te+"_lastUpdated",Ae),t!=null&&t.uid){const Xe=`userData_${t.uid}`,Ze=localStorage.getItem(Xe),ge={...Ze?JSON.parse(Ze):{},walletBalances:le,lastUpdated:Ae};localStorage.setItem(Xe,JSON.stringify(ge)),ve(!0)}}catch{}return le})}if(typeof o=="number"){ot(o);try{const p=Ye();localStorage.setItem(p,String(o));const w=new Date().toISOString();if(localStorage.setItem(p+"_lastUpdated",w),t!=null&&t.uid){const b=`userData_${t.uid}`,y=localStorage.getItem(b),k={...y?JSON.parse(y):{},cashBalance:o,lastUpdated:w};localStorage.setItem(b,JSON.stringify(k)),ve(!0)}}catch{}}if(c&&typeof c=="object"){mt(c);try{const p=Ge();localStorage.setItem(p,JSON.stringify(c));const w=new Date().toISOString();if(localStorage.setItem(p+"_lastUpdated",w),t!=null&&t.uid){const b=`userData_${t.uid}`,y=localStorage.getItem(b),k={...y?JSON.parse(y):{},walletBalances:c,lastUpdated:w};localStorage.setItem(b,JSON.stringify(k)),ve(!0)}}catch{}}if(h&&h.walletId===M&&Hs(p=>{if(!p)return p;const w=Number(h.amount||0),b=h.type==="transfer",y={...p};return b?(y.dailyTransferUsed=(y.dailyTransferUsed||0)+w,y.monthlyTransferUsed=(y.monthlyTransferUsed||0)+w):(y.dailyWithdrawUsed=(y.dailyWithdrawUsed||0)+w,y.monthlyWithdrawUsed=(y.monthlyWithdrawUsed||0)+w),y}),u){const p=u.type==="machine_withdrawal"||u.txnType==="machine_withdrawal",w=pd.current||[];if(p&&w.find(y=>{if((y.type||y.txnType)!=="machine_withdrawal")return!1;const k=Number(y.amount)===Number(u.amount),C=y.senderName===u.senderName,T=new Date(y.createdAt).getTime(),R=new Date(u.createdAt||Date.now()).getTime(),_=Math.abs(R-T);return k&&C&&_<6e4})){console.log("Skipping duplicate machine withdrawal event (fuzzy match):",u);return}try{Ta.current&&(Ta.current.some(b=>b.id===u.id)||Ta.current.push(u))}catch{}qt(b=>b.some(y=>y.id===u.id)?b:[u,...b]),x({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ© Ø®Ø§Ø±Ø¬ÙŠØ©",description:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙˆØ§Ù„Ø³Ø¬Ù„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­"});try{Tr.refetch()}catch{}}};return window.addEventListener("dashboard:external-update",a),()=>window.removeEventListener("dashboard:external-update",a)},[M]);const[ud,W0]=d.useState(""),md=(()=>{const a=ud.replace(/\D/g,"");return a?J.filter(n=>(n.phone||"").replace(/\D/g,"").includes(a)):J})();d.useEffect(()=>{(async()=>{try{let n=[];if(t!=null&&t.uid)try{const o=await ys(()=>oe.getUserData(t.uid)),c=o==null?void 0:o.favoriteWalletIds;Array.isArray(c)&&(n=c.map(u=>String(u)))}catch{}if(!n.length)try{const o=t!=null&&t.uid?`favoriteWallets_${t.uid}`:"favoriteWallets",c=localStorage.getItem(o)??localStorage.getItem("favoriteWallets");if(c){const u=JSON.parse(c);Array.isArray(u)&&(n=u.filter(h=>typeof h=="string"))}}catch{}n.length&&Vi(n)}catch{Vi([])}})()},[t==null?void 0:t.uid]),d.useEffect(()=>{try{const a=t!=null&&t.uid?`favoriteWallets_${t.uid}`:"favoriteWallets";localStorage.setItem(a,JSON.stringify(Is)),t!=null&&t.uid&&oe.updateUserData(t.uid,{favoriteWalletIds:Is})}catch{}},[Is,t==null?void 0:t.uid]);const hd=G.useMemo(()=>{const a=new Set(Is);return[...md].sort((n,o)=>{const c=a.has(n.id),u=a.has(o.id);return c===u?0:c?-1:1})},[md,Is]),L0=a=>{Vi(n=>n.includes(a)?n.filter(o=>o!==a):[...n,a])},[F0,eN]=d.useState(null),[B0,fd]=d.useState(!1),[$0,Ln]=d.useState(!1),[U0,V0]=d.useState(null),[tN,q0]=d.useState([]),[aN,sN]=d.useState([]),[z0,Pr]=d.useState(!1),[_o,gd]=d.useState("daily"),[Or,Er]=d.useState([]),[Y0,rN]=d.useState(!1),ya=G.useRef(new Set);G.useRef(new Set);const pd=G.useRef([]);d.useEffect(()=>{pd.current=he},[he]);const Ao=async a=>{try{if(!t)return;const n=Ye(),o=Ge(),c=localStorage.getItem(n),u=localStorage.getItem(o);let h=c?parseFloat(c):qe,f=u?JSON.parse(u):{...Se};const p=Number(a.withdrawnAmount??a.sentAmount??a.transferredAmount??a.amount??0);if(a.type==="send"&&(a.fromWallet||M)){h-=p;const N=a.fromWallet||M;f[N]=(f[N]||0)+p}else if(a.type==="withdraw"&&(a.fromWallet||M)){h+=p;const N=a.fromWallet||M;f[N]=Math.max(0,(f[N]||0)-p)}ot(h),mt(f);const w=new Date().toISOString();localStorage.setItem(n,h.toString()),localStorage.setItem(n+"_lastUpdated",w),localStorage.setItem(o,JSON.stringify(f)),localStorage.setItem(o+"_lastUpdated",w);const b={cashBalance:h,walletBalances:f,lastUpdated:new Date().toISOString()},y=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(y,JSON.stringify(b));try{await oe.updateUserData(t.uid,b),localStorage.removeItem(y),ve(!1)}catch(N){console.warn("ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙÙŠ Firebase Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù (Ù…Ø²Ø§Ù…Ù†Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©):",N),ve(!0)}try{const N=a.fromWallet||M,k=a.type==="send"?"transfer":"withdraw";await Ua.rollbackUsage(N,p,k,a.createdAt)}catch(N){console.warn("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù (Ù…Ø²Ø§Ù…Ù†Ø©):",N)}try{Ot.removeTransactionEffects(a,t.uid)}catch(N){console.warn("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù (Ù…Ø²Ø§Ù…Ù†Ø©):",N)}}catch(n){console.warn("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø°Ù Ù…Ø­Ù„ÙŠÙ‹Ø§:",n)}},K0=async a=>{try{const n=he.find(f=>f.id===a);if(!n||!t)return;const o=String(a),c=String((n==null?void 0:n.transactionId)||(n==null?void 0:n.reference)||""),u=ya.current.has(o)||c&&ya.current.has(c),h=he.filter(f=>f.id!==a);qt(h);try{await oe.removeUserTransaction(t.uid,a),await dn.permanentlyDeleteTransaction(a,t.uid)}catch(f){console.warn("ØªØ¹Ø°Ø± Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù…Ù† Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„:",f)}if(!u){ya.current.add(o),c&&ya.current.add(c),await Ao(n);try{t!=null&&t.uid&&oe.removeLocalReceiptById(t.uid,a)}catch{}}x({title:"ØªÙ… Ø§Ù„Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ ÙˆØ¹ÙƒØ³ ØªØ£Ø«ÙŠØ±Ø§ØªÙ‡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙˆØ§Ù„Ø­Ø¯ÙˆØ¯ ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±."}),Ln(!1)}catch(n){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„:",n),x({title:"Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù.",variant:"destructive"})}},J0=async a=>{try{const n=he.find(o=>o.id===a);if(!n||!t)return;try{const o=Mt==null?void 0:Mt.planType;if(o===ta.ZERO){const{dailyOperationCountService:c}=await re(async()=>{const{dailyOperationCountService:f}=await import("./dailyOperationCountService-B8RFl0oW.js");return{dailyOperationCountService:f}},__vite__mapDeps([69,0,1]),import.meta.url),u=n.type==="send"?"transfer":"withdraw";if(!(await c.checkAndIncrement(t.uid,u,5)).allowed){x({title:"ØªÙ… Ø¨Ù„ÙˆØº Ø­Ø¯ Ø¨Ø§Ù‚Ø© Ø§Ù„Ø²ÙŠØ±Ùˆ",description:"Ù…Ø³Ù…ÙˆØ­ Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 5 ØªØ£ÙƒÙŠØ¯Ø§Øª ÙŠÙˆÙ…ÙŠÙ‹Ø§ Ù„Ù„ØªØ­ÙˆÙŠÙ„/Ø§Ù„Ø³Ø­Ø¨. Ø¬Ø±Ù‘Ø¨ ØºØ¯Ù‹Ø§ Ø£Ùˆ Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}}else if(o===ta.TAHWEELA){const{dailyOperationCountService:c}=await re(async()=>{const{dailyOperationCountService:f}=await import("./dailyOperationCountService-B8RFl0oW.js");return{dailyOperationCountService:f}},__vite__mapDeps([69,0,1]),import.meta.url),u=n.type==="send"?"transfer":"withdraw";if(!(await c.checkAndIncrementCombined(t.uid,u,40)).allowed){x({title:"ØªÙ… Ø¨Ù„ÙˆØº Ø­Ø¯ Ø¨Ø§Ù‚Ø© ØªØ­ÙˆÙŠÙ„Ù‡",description:"Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø§Ù‚Ø© ØªØ³Ù…Ø­ Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 40 Ø¹Ù…Ù„ÙŠØ© ØªØ­ÙˆÙŠÙ„/Ø³Ø­Ø¨ ÙŠÙˆÙ…ÙŠØ§Ù‹.",variant:"destructive"});return}}}catch(o){console.warn("ØªØ¹Ø°Ø± Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ:",o)}await ea(Pe($,"userTransactions",a),{status:"completed",confirmedAt:new Date}),qt(o=>o.map(c=>c.id===a?{...c,status:"completed"}:c)),x({title:"ØªÙ… Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„",description:"ØªÙ… ÙˆØ³Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙƒÙ…ÙƒØªÙ…Ù„Ø©."}),Ln(!1)}catch(n){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„:",n),x({title:"ÙØ´Ù„ Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©.",variant:"destructive"})}};d.useEffect(()=>{if(!t)return;(async()=>{try{const n=Ee(ce($,"deletedTransactions"),Y("userId","==",t.uid),Ll("createdAt","desc"),fp(50));(await ke(n)).docs.forEach(c=>{const u=c.data(),h=String((u==null?void 0:u.originalTransactionId)||""),f=String((u==null?void 0:u.transactionId)||""),p=String((u==null?void 0:u.reference)||""),w=h||f||p||String(c.id);w&&(ya.current.has(w)||(ya.current.add(w),qt(b=>{const y=b.find(N=>N.id===h);return y?((async()=>await Ao(y))(),b.filter(N=>N.id!==h)):b})))})}catch(n){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©:",n)}})()},[t==null?void 0:t.uid]),d.useEffect(()=>{if(!t)return;(async()=>{try{const n=Pe($,"users",t.uid),o=await la(n);if(!o.exists())return;const c=o.data();if(!(c!=null&&c.reportsData))return;try{await Ot.syncReportsDataFromFirebase(t.uid),q0(Ou())}catch(u){console.warn("ØªØ¹Ø°Ø± Ù…Ø²Ø§Ù…Ù†Ø© reportsData Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©:",u)}}catch(n){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ users.reportsData:",n)}})()},[t==null?void 0:t.uid]);const[To,xd]=d.useState(""),yd=Hv(To,300),[Fn,bd]=d.useState(""),[Bn,vd]=d.useState(""),[ba,nN]=d.useState(""),[Po,Us]=d.useState(!1),[Oo,Mr]=d.useState(!1),[H0,wd]=d.useState(null),[da,Eo]=d.useState(!1),[Q0,ua]=d.useState(!1),[He,Mo]=d.useState(null),[ut,G0]=d.useState(null),[Nd,ma]=d.useState(!1),[X0,Pa]=d.useState(!1),[Z0,jd]=d.useState(!1),[ef,Sd]=d.useState(void 0),[tf,Dd]=d.useState(!1),[Ro,Wo]=d.useState(""),[af,Lo]=d.useState(!1),[sf,Rr]=d.useState(!1),[rf,kd]=d.useState(!1),[nf,$n]=d.useState(!1),[of,Cd]=d.useState(!1),[lf,Wr]=d.useState(!1),[cf,Lr]=d.useState(!1),[df,Fr]=d.useState(!1),[Id,Un]=d.useState(()=>{try{const a=t!=null&&t.uid?`monthlyReportsLock_v4_${t==null?void 0:t.uid}`:"monthlyReportsLock_v4";return(localStorage.getItem(a)??localStorage.getItem("monthlyReportsLock_v4"))==="true"}catch{return!1}});d.useEffect(()=>{const a=()=>{try{const o=t!=null&&t.uid?`monthlyReportsLock_v4_${t==null?void 0:t.uid}`:"monthlyReportsLock_v4",c=localStorage.getItem(o)??localStorage.getItem("monthlyReportsLock_v4");Un(c==="true")}catch{}};a();const n=o=>{o.detail&&typeof o.detail.enabled=="boolean"?Un(o.detail.enabled):a()};return window.addEventListener("monthlyReportsLockChanged",n),()=>window.removeEventListener("monthlyReportsLockChanged",n)},[t==null?void 0:t.uid]);const[Br,uf]=d.useState(!1),[mf,Vn]=d.useState(!1),[hf,_d]=d.useState(!1),[qn,ff]=d.useState(""),[Ad,gf]=d.useState(!1),[pf,Fo]=d.useState(!1),[Gt,Td]=d.useState(()=>{try{const a=(t==null?void 0:t.uid)||"default",n=localStorage.getItem(`hiddenQuickActions_${a}`)??localStorage.getItem("hiddenQuickActions"),o=n?JSON.parse(n):[];return Array.isArray(o)?o.filter(c=>typeof c=="string"):[]}catch{return[]}}),[xf,Pd]=d.useState(()=>{try{const a=t!=null&&t.uid?`dailyReportsLockEnabled_${t==null?void 0:t.uid}`:"dailyReportsLockEnabled";return(localStorage.getItem(a)??localStorage.getItem("dailyReportsLockEnabled"))==="true"}catch{return!1}}),[yf,Bo]=d.useState(!1);d.useEffect(()=>{try{const a=t!=null&&t.uid?`dailyReportsLockEnabled_${t==null?void 0:t.uid}`:"dailyReportsLockEnabled",n=localStorage.getItem(a)??localStorage.getItem("dailyReportsLockEnabled");Pd(n==="true")}catch{}},[t==null?void 0:t.uid]);const[bf,Vs]=d.useState(!1),[vf,$o]=d.useState(!1),[wf,Od]=d.useState(()=>{try{const a=t==null?void 0:t.uid,n=a?`debtsPinRequired_${a}`:"debtsPinRequired";return(localStorage.getItem(n)??localStorage.getItem("debtsPinRequired"))==="true"}catch{return!1}}),[Nf,Ed]=d.useState(!1),[Md,jf]=d.useState(null),[Uo,Vo]=d.useState(""),[qo,Rd]=d.useState(""),[Wd,Ld]=d.useState(""),[va,Fd]=d.useState(null),[W,$r]=d.useState(null),[Sf,Ha]=d.useState(!1),[Df,zn]=d.useState(!1),[wa,kf]=d.useState(null),[Bd,$d]=d.useState(""),[Ud,Yn]=d.useState(""),[it,Vd]=d.useState(null),[iN,oN]=d.useState(!1),[Cf,Kn]=d.useState(!1),[qs,qd]=d.useState(()=>{try{return localStorage.getItem("eyeComfortMode")==="true"}catch{return!1}});d.useEffect(()=>{localStorage.setItem("eyeComfortMode",String(qs))},[qs]);const[zd,Ur]=d.useState(""),[zo,fs]=d.useState(!1),[Yd,Jn]=d.useState(1),[Vr,Kd]=d.useState(""),If=P?10:20,Hn=G.useMemo(()=>{if(!Vr)return Re;const a=Vr.toLowerCase();return Re.filter(n=>n.debtorName&&n.debtorName.toLowerCase().includes(a)||n.amount&&n.amount.toString().includes(a))},[Re,Vr]),Qn=G.useMemo(()=>Hn.slice(0,Yd*If),[Hn,Yd]);d.useEffect(()=>{Jn(1)},[Vr]),d.useEffect(()=>{zo&&(Jn(1),Kd(""))},[zo]),d.useEffect(()=>{try{const a=(t==null?void 0:t.uid)||"default",n=localStorage.getItem(`hiddenQuickActions_${a}`)??localStorage.getItem("hiddenQuickActions"),o=n?JSON.parse(n):[];Array.isArray(o)&&Td(o.filter(c=>typeof c=="string"))}catch{}},[t==null?void 0:t.uid]),d.useEffect(()=>{const a=n=>{var o;try{const c=(o=n==null?void 0:n.detail)==null?void 0:o.hiddenQuickActions;Array.isArray(c)&&Td(c.map(u=>String(u)))}catch{}};try{window.addEventListener("hiddenQuickActionsChanged",a)}catch{}return()=>{try{window.removeEventListener("hiddenQuickActionsChanged",a)}catch{}}},[]);const Gn=async()=>{if(De){x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†/Ø§Ù„Ø£Ø¬Ù„ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}try{const a=await Bt.hasMasterPin(t==null?void 0:t.uid);wf&&a?$o(!0):Vs(!0)}catch{Vs(!0)}};d.useEffect(()=>{try{const a=t==null?void 0:t.uid,n=a?`debtsPinRequired_${a}`:"debtsPinRequired",o=localStorage.getItem(n)??localStorage.getItem("debtsPinRequired");(o==="true"||o==="false")&&Od(o==="true")}catch{}},[t==null?void 0:t.uid]),d.useEffect(()=>{const a=()=>{try{il()}catch{}};try{window.addEventListener("debtsUpdated",a)}catch{}return()=>{try{window.removeEventListener("debtsUpdated",a)}catch{}}},[t==null?void 0:t.uid,j,r==null?void 0:r.shopId]);const[_f,Yo]=d.useState(!1),[zs,Ko]=d.useState("customers_list"),[wt,Jo]=d.useState([]),[Ho,Jd]=d.useState(""),[Qo,Hd]=d.useState(""),[Qa,Go]=d.useState(""),[Qd,Af]=d.useState(""),[Tf,Xn]=d.useState(!1),[Pf,Gd]=d.useState(""),[Xd,Xo]=d.useState(""),[Zd,Zo]=d.useState(""),[Of,Zn]=d.useState(!1),[Ef,el]=d.useState(""),[eu,tl]=d.useState(""),[Mf,al]=d.useState(!1),[sl,Rf]=d.useState(""),[Wf,Ys]=d.useState(!1),[gs,qr]=d.useState(null),[Nt,zr]=d.useState(null),[Ks,rl]=d.useState(""),[Lf,Js]=d.useState(!1),[tu,ei]=d.useState(0),[Rt,Ga]=d.useState(null),[Xa,nl]=d.useState(""),[je,Hs]=d.useState(null),[Ff,au]=d.useState(""),Oa=async a=>{try{const n=JSON.stringify(a);localStorage.setItem(Yr(),n);try{localStorage.setItem(fl(),n)}catch{}try{localStorage.setItem(gl(),Date.now().toString())}catch{}if(t!=null&&t.uid){try{localStorage.setItem(`debts_unsynced_${t.uid}`,"true")}catch{}const o=[];o.push(oe.updateUserData(t.uid,{debts:a,debtsDeletedAt:null})),Promise.all(o).then(()=>{try{localStorage.removeItem(`debts_unsynced_${t.uid}`)}catch{}}).catch(c=>{console.error("ÙØ´Ù„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†:",c),ve(!0)})}}catch(n){console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¯ÙŠÙˆÙ†:",n)}},il=async()=>{try{const a=Yr(),n=fl(),o=gl(),c=localStorage.getItem(a),u=localStorage.getItem(n),h=localStorage.getItem(o),f=h?Number(h):0,p=b=>{if(!b)return null;try{const y=JSON.parse(b);return Array.isArray(y)?y.map(N=>{var k;return{...N,createdAt:(k=N.createdAt)!=null&&k.toDate?N.createdAt.toDate():new Date(N.createdAt),partialPayments:Array.isArray(N.partialPayments)?N.partialPayments.map(C=>{var T;return{amount:Number(C.amount)||0,paidAt:(T=C.paidAt)!=null&&T.toDate?C.paidAt.toDate():new Date(C.paidAt)}}):[],additionReceipts:Array.isArray(N.additionReceipts)?N.additionReceipts.map(C=>{var T;return{amount:Number(C.amount)||0,note:typeof C.note=="string"?C.note:void 0,addedAt:(T=C.addedAt)!=null&&T.toDate?C.addedAt.toDate():new Date(C.addedAt)}}):[]}}):[]}catch(y){return console.warn("ÙØ´Ù„ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø¯ÙŠÙˆÙ† localStorage:",y),null}};let w=p(c);if(!w||w.length===0){const b=p(u);if(b&&b.length>0){w=b,zt(b);try{localStorage.setItem(Yr(),JSON.stringify(b)),localStorage.removeItem(n)}catch(y){console.warn("ØªØ¹Ø°Ø± ØªØ±Ø­ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙˆÙ† Ù…Ø­Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ:",y)}}}if(w&&w.length>0&&zt(w),t!=null&&t.uid)try{const b=`debts_unsynced_${t.uid}`,y=localStorage.getItem(b)==="true",N=await la(Pe($,"users",t.uid)),k=[];try{const C=query(ce($,"debts"),Y("userId","==",t.uid));(await ke(C)).forEach(R=>{var O;const _=R.data();k.push({id:R.id,..._,amount:Number(_.amount||0),paidAmount:Number(_.paidAmount||0),createdAt:(O=_.createdAt)!=null&&O.toDate?_.createdAt.toDate():new Date(_.createdAt||Date.now()),partialPayments:Array.isArray(_.partialPayments)?_.partialPayments:[],additionReceipts:Array.isArray(_.additionReceipts)?_.additionReceipts.map(V=>{var le;return{amount:Number(V.amount)||0,note:typeof V.note=="string"?V.note:void 0,addedAt:(le=V.addedAt)!=null&&le.toDate?V.addedAt.toDate():new Date(V.addedAt)}}):[]})})}catch(C){console.warn("Failed to fetch from debts collection:",C)}if(N.exists()){const C=N.data();let T=C.debts&&Array.isArray(C.debts)?C.debts.map(O=>{var V;return{...O,amount:Number(O.amount||0),paidAmount:Number(O.paidAmount||0),createdAt:(V=O.createdAt)!=null&&V.toDate?O.createdAt.toDate():new Date(O.createdAt),partialPayments:Array.isArray(O.partialPayments)?O.partialPayments.map(le=>{var te;return{amount:Number(le.amount)||0,paidAt:(te=le.paidAt)!=null&&te.toDate?le.paidAt.toDate():new Date(le.paidAt)}}):[],additionReceipts:Array.isArray(O.additionReceipts)?O.additionReceipts.map(le=>{var te;return{amount:Number(le.amount)||0,note:typeof le.note=="string"?le.note:void 0,addedAt:(te=le.addedAt)!=null&&te.toDate?le.addedAt.toDate():new Date(le.addedAt)}}):[]}}):[];if(!!C.debtsDeletedAt){zt([]);try{localStorage.setItem(a,JSON.stringify([])),localStorage.setItem(n,JSON.stringify([]))}catch{}return}if(((T==null?void 0:T.length)||0)>0)if(y)console.log("âš ï¸ ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø¯ÙŠÙˆÙ† ØºÙŠØ± Ù…ØªØ²Ø§Ù…Ù†Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… ØªØ¬Ø§Ù‡Ù„ Ù†Ø³Ø®Ø© Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ù…Ø¤Ù‚ØªØ§Ù‹ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©.");else{zt(T);try{localStorage.setItem(a,JSON.stringify(T))}catch{}}}else if(k.length>0){zt(k);try{localStorage.setItem(a,JSON.stringify(k))}catch{}}else w&&w.length>0}catch(b){console.warn("ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙˆÙ† Ù…Ù† FirebaseØŒ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ù„ÙŠ:",b)}}catch(a){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙˆÙ†:",a)}};d.useEffect(()=>{try{window.exportDebts=()=>{try{return JSON.stringify(Re||[])}catch{return"[]"}},window.importDebts=async a=>{try{const n=JSON.parse(a);if(!Array.isArray(n))throw new Error("ØµÙŠØºØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø© â€” ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù…ØµÙÙˆÙØ©");return await Oa(n),{ok:!0,count:n.length}}catch(n){return console.error("ÙØ´Ù„ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙˆÙ†:",n),{ok:!1,error:String(n)}}},window.fixWalletsForCurrentUser=async a=>{try{if(!(t!=null&&t.uid))throw new Error("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹");return await(await re(async()=>{const{merchantWalletService:o}=await import("./index-CHyvkdwe.js").then(c=>c.cH);return{merchantWalletService:o}},__vite__mapDeps([0,1]),import.meta.url)).merchantWalletService.reassignByMsisdns(a,t.uid)}catch(n){return console.error("ÙØ´Ù„ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:",n),{updated:0,failed:(a==null?void 0:a.length)||0,error:String(n)}}}}catch{}},[Re,t==null?void 0:t.uid]),d.useEffect(()=>{t!=null&&t.uid&&il()},[t==null?void 0:t.uid]),d.useEffect(()=>{if(!(t!=null&&t.uid))return;const a=Qu(Pe($,"users",t.uid),async n=>{var o;if(n.exists()){const c=n.data(),u=c.isActive===!0;c.subscription&&Hc(c.subscription),d0(c.branchPackage||null);const h=await lm.checkTrialValidity(t.uid),f=h.isValid&&!h.isExpired;za(u||f),Yc(f),Kc(h.hoursRemaining),Jc(h.hasUsedTrial);const p=!u&&!f;Ya(p),p&&(console.log("â›” User not active, redirecting to pending approval..."),g("/user/pending-approval",{replace:!0})),console.log("ðŸ”„ ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Real-time):",{isActive:u,isOnTrial:f,plan:(o=c.subscription)==null?void 0:o.planType,showModal:p})}});return()=>a()},[t==null?void 0:t.uid]);const Bf=async()=>{if(t!=null&&t.uid)try{Qc(!0);const a=await Tm(t.uid);Hc(a)}catch(a){console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:",a)}finally{Qc(!1)}},[lN,cN]=d.useState(!1),[$f,ol]=d.useState(!1),[qe,ot]=d.useState(0),[Se,mt]=d.useState({}),[Uf,su]=d.useState(!1),[Vf,ru]=d.useState(!1),[qf,ll]=d.useState(!1),[zf,ti]=d.useState(!1),[nu,cl]=d.useState(""),[Yf,ai]=d.useState(!1),[Kf,si]=d.useState(!1),[dl,ri]=d.useState(""),[Jf,ul]=d.useState(!1),[ni,iu]=d.useState(""),[ii,ou]=d.useState(""),[oi,lu]=d.useState(""),[cu,du]=d.useState(!1),[ml,hl]=d.useState(!1),[Hf,uu]=d.useState(!1),[mu,Qf]=d.useState([]);d.useEffect(()=>{(async()=>{try{if(!(t!=null&&t.uid)||!ml)return;try{await tn.trimToMaxCount(t.uid,30)}catch{}const a=await tn.getByUser(t.uid,30);Qf(a)}catch{}})()},[t==null?void 0:t.uid,ml]);const Ge=()=>{const a=j||(r==null?void 0:r.shopId)||"main";return`walletBalances_${(t==null?void 0:t.uid)||"default"}_${a}`},Ye=()=>{const a=j||(r==null?void 0:r.shopId)||"main";return`cashBalance_${(t==null?void 0:t.uid)||"default"}_${a}`},Yr=()=>{const a=j||(r==null?void 0:r.shopId)||"main";return`debts_${(t==null?void 0:t.uid)||"default"}_${a}`},Gf=()=>{const a=j||(r==null?void 0:r.shopId)||"main";return`customers_${(t==null?void 0:t.uid)||"default"}_${a}`},fl=()=>`debts_default_${j||(r==null?void 0:r.shopId)||"main"}`,gl=()=>{const a=j||(r==null?void 0:r.shopId)||"main";return`debts_last_write_${(t==null?void 0:t.uid)||"default"}_${a}`},pl=()=>`shopExpenses_${j||(r==null?void 0:r.shopId)||(t==null?void 0:t.uid)||"default"}`,hu=()=>{try{const a=localStorage.getItem(pl());if(a){const n=JSON.parse(a);no(n.map(o=>({...o,createdAt:new Date(o.createdAt)})))}}catch(a){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ†:",a)}},fu=async a=>{try{localStorage.setItem(pl(),JSON.stringify(a)),no(a)}catch(n){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ†:",n)}},Xf=async a=>{try{const n=Cn.filter(o=>o.id!==a);await fu(n);try{if(t!=null&&t.uid&&a){const{doc:o,deleteDoc:c}=await re(async()=>{const{doc:f,deleteDoc:p}=await import("./index-CHyvkdwe.js").then(w=>w.cF);return{doc:f,deleteDoc:p}},__vite__mapDeps([0,1]),import.meta.url),{db:u}=await re(async()=>{const{db:f}=await import("./index-CHyvkdwe.js").then(p=>p.cG);return{db:f}},__vite__mapDeps([0,1]),import.meta.url),h=o(u,"shop_expenses",a);await c(h)}}catch(o){console.warn("ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ù…ØµØ±ÙˆÙ Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ø§Ù„Ø¢Ù†ØŒ ØªÙ… Ø§Ù„Ø­Ø°Ù Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙˆØ³ÙŠØ¨Ù‚Ù‰ Ù…Ø®Ø²Ù‘Ù†Ù‹Ø§ Ø¯ÙˆÙ† Ù‡Ø°Ø§ Ø§Ù„Ø¥ÙŠØµØ§Ù„:",o)}x({title:"ØªÙ… Ø§Ù„Ø­Ø°Ù",description:"ØªÙ… Ø­Ø°Ù Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ù…ØµØ±ÙˆÙ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§."})}catch(n){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ù…ØµØ±ÙˆÙ:",n),x({title:"ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù",description:"ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"})}};G.useEffect(()=>{let a;return(async()=>{try{if(!(t!=null&&t.uid)){hu();return}const{collection:n,query:o,where:c,getDocs:u}=await re(async()=>{const{collection:N,query:k,where:C,getDocs:T}=await import("./index-CHyvkdwe.js").then(R=>R.cF);return{collection:N,query:k,where:C,getDocs:T}},__vite__mapDeps([0,1]),import.meta.url),{db:h}=await re(async()=>{const{db:N}=await import("./index-CHyvkdwe.js").then(k=>k.cG);return{db:N}},__vite__mapDeps([0,1]),import.meta.url),f=j||(r==null?void 0:r.shopId),p=f?o(n(h,"shop_expenses"),c("shopId","==",f)):o(n(h,"shop_expenses"),c("userId","==",t.uid)),y=(await u(p)).docs.map(N=>{var T;const k=N.data(),C=(T=k.createdAt)!=null&&T.toDate?k.createdAt.toDate():k.createdAt?new Date(k.createdAt):new Date;return{id:N.id,name:String(k.name||""),amount:Number(k.amount||0),notes:k.notes?String(k.notes):void 0,source:k.source==="wallet"?"wallet":"cash",walletId:k.walletId?String(k.walletId):void 0,createdAt:C}}).sort((N,k)=>{const C=N.createdAt instanceof Date?N.createdAt.getTime():0;return(k.createdAt instanceof Date?k.createdAt.getTime():0)-C});no(y);try{localStorage.setItem(pl(),JSON.stringify(y))}catch{}}catch(n){console.error("Ø®Ø·Ø£ ÙÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ Ù…Ù† Firestore:",n)}})(),()=>a==null?void 0:a()},[t==null?void 0:t.uid,r==null?void 0:r.shopId,j]);const li=()=>`deficiencies_${j||(r==null?void 0:r.shopId)||(t==null?void 0:t.uid)||"default-shop"}`,Zf=()=>{try{const a=li(),n=`deficiencies_${(t==null?void 0:t.uid)||"default"}`;if(n!==a){const c=localStorage.getItem(n),u=localStorage.getItem(a);if(c)try{const h=JSON.parse(c)||[],f=u?JSON.parse(u):[],p=Array.isArray(f)?[...f]:[],w=(b,y)=>b.some(N=>(N==null?void 0:N.id)&&(y==null?void 0:y.id)&&String(N.id)===String(y.id)||String((N==null?void 0:N.name)||"")===String((y==null?void 0:y.name)||"")&&String((N==null?void 0:N.status)||"pending")===String((y==null?void 0:y.status)||"pending"));if(Array.isArray(h))for(const b of h)w(p,b)||p.push(b);localStorage.setItem(a,JSON.stringify(p));try{localStorage.removeItem(n)}catch{}}catch{}}const o=localStorage.getItem(a);if(o){const c=JSON.parse(o);Os(c.map(u=>({...u,createdAt:new Date(u.createdAt)})))}}catch(a){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ†:",a)}},xl=async a=>{try{localStorage.setItem(li(),JSON.stringify(a)),Os(a)}catch(n){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ†:",n)}};G.useEffect(()=>{(async()=>{try{if(!(t!=null&&t.uid))return;const{collection:n,query:o,where:c,orderBy:u,getDocs:h}=await re(async()=>{const{collection:N,query:k,where:C,orderBy:T,getDocs:R}=await import("./index-CHyvkdwe.js").then(_=>_.cF);return{collection:N,query:k,where:C,orderBy:T,getDocs:R}},__vite__mapDeps([0,1]),import.meta.url),{db:f}=await re(async()=>{const{db:N}=await import("./index-CHyvkdwe.js").then(k=>k.cG);return{db:N}},__vite__mapDeps([0,1]),import.meta.url),p=j||(r==null?void 0:r.shopId)||t.uid||"default-shop",w=o(n(f,"deficiencies"),c("shopId","==",p),u("createdAt","desc")),y=(await h(w)).docs.map(N=>{var T;const k=N.data(),C=(T=k.createdAt)!=null&&T.toDate?k.createdAt.toDate():k.createdAt?new Date(k.createdAt):new Date;return{id:N.id,name:String(k.name||""),quantity:Number(k.quantity||1),status:k.status==="purchased"?"purchased":"pending",createdAt:C}});Os(y);try{localStorage.setItem(li(),JSON.stringify(y))}catch{}}catch(n){console.warn("ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ù…Ù† Firestore:",n)}})()},[t==null?void 0:t.uid,r==null?void 0:r.shopId,j]);const yl=async a=>{try{localStorage.setItem(Gf(),JSON.stringify(a)),Jo(a),t!=null&&t.uid&&await oe.updateUserData(t.uid,{customers:a})}catch(n){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ†:",n)}},eg=async()=>{try{if(t!=null&&t.uid){const a=await la(Pe($,"users",t.uid));if(a.exists()){const n=a.data();if(n.customers&&Array.isArray(n.customers)){const o=n.customers.map(c=>{var u;return{...c,createdAt:(u=c.createdAt)!=null&&u.toDate?c.createdAt.toDate():new Date(c.createdAt)}});Jo(o);return}}}Jo([])}catch(a){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù…Ù† Firestore:",a)}},bl=()=>{const a=j||(r==null?void 0:r.shopId)||"main";return`transactions_${(t==null?void 0:t.uid)||"default"}_${a}`},gu=()=>{const a=j||(r==null?void 0:r.shopId)||"main";return`wallets_${(t==null?void 0:t.uid)||"default"}_${a}`},ps=()=>{const a=j||(r==null?void 0:r.shopId)||"main";return`selectedWallet_${(t==null?void 0:t.uid)||"default"}_${a}`},vl=a=>{var u;const n=String((a==null?void 0:a.transactionId)||(a==null?void 0:a.id)||""),o=String((a==null?void 0:a.reference)||(a==null?void 0:a.transactionReference)||((u=a==null?void 0:a.receipt)==null?void 0:u.reference)||""),c=new Date((a==null?void 0:a.createdAt)||0).getTime();return n||o||`${o||"ref"}-${c}`},{data:wl,refetch:dN}=un({queryKey:["userTransactions",t==null?void 0:t.uid],queryFn:async()=>{if(!(t!=null&&t.uid))return[];const{collection:a,query:n,where:o,orderBy:c,limit:u,getDocs:h}=await re(async()=>{const{collection:b,query:y,where:N,orderBy:k,limit:C,getDocs:T}=await import("./index-CHyvkdwe.js").then(R=>R.cF);return{collection:b,query:y,where:N,orderBy:k,limit:C,getDocs:T}},__vite__mapDeps([0,1]),import.meta.url),{db:f}=await re(async()=>{const{db:b}=await import("./index-CHyvkdwe.js").then(y=>y.cG);return{db:b}},__vite__mapDeps([0,1]),import.meta.url),p=n(a(f,"userTransactions"),o("userId","==",t.uid),c("createdAt","desc"),u(100));return(await h(p)).docs.map(b=>{var V;const y=b.data(),N=(V=y.createdAt)!=null&&V.toDate?y.createdAt.toDate():new Date(y.createdAt),k=(y.txnType||"").toLowerCase(),C=k==="send"?"send":k==="receive"?"withdraw":y.type||"withdraw",T=y.status==="confirmed"?"completed":y.status||"completed",R=y.senderMsisdn||y.senderPhone||"",_=y.receiverMsisdn||y.receiverPhone||"",O=Number(y.amount??y.transferredAmount??y.withdrawnAmount??0);return{id:b.id,...y,type:C,status:T,senderPhone:R,receiverPhone:_,amount:O,createdAt:N,provider:y.provider||void 0}})},enabled:!!(t!=null&&t.uid),staleTime:1e3*60*5,gcTime:1e3*60*10});d.useEffect(()=>{if(wl){const n=wl.filter(f=>!((f==null?void 0:f.type)==="report"||String((f==null?void 0:f.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"))),o=new Set((Or||[]).map(f=>String(f.id||f.originalTransactionId||""))),c=n.filter(f=>!o.has(String(f.id||""))),u=new Set,h=[];for(const f of c){const p=vl(f);u.has(p)||(u.add(p),h.push(f))}qt(h)}},[wl,Or]),d.useEffect(()=>{if(!(t!=null&&t.uid))return;let a=!0;return(async()=>{try{const{collection:o,query:c,where:u,getDocs:h,orderBy:f,limit:p}=await re(async()=>{const{collection:N,query:k,where:C,getDocs:T,orderBy:R,limit:_}=await import("./index-CHyvkdwe.js").then(O=>O.cF);return{collection:N,query:k,where:C,getDocs:T,orderBy:R,limit:_}},__vite__mapDeps([0,1]),import.meta.url),{db:w}=await re(async()=>{const{db:N}=await import("./index-CHyvkdwe.js").then(k=>k.cG);return{db:N}},__vite__mapDeps([0,1]),import.meta.url),b=c(o(w,"deletedTransactions"),u("userId","==",t.uid),f("createdAt","desc"),p(50)),y=await h(b);if(!a)return;y.docs.forEach(N=>{const k=N.data(),C=String((k==null?void 0:k.originalTransactionId)||""),T=String((k==null?void 0:k.transactionId)||""),R=String((k==null?void 0:k.reference)||""),_=C||T||R||String(N.id);_&&(ya.current.has(_)||(ya.current.add(_),qt(O=>{const V=O.find(le=>le.id===C);return V?((async()=>await Ao(V))(),O.filter(le=>le.id!==C)):O})))})}catch(o){console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©:",o)}})(),()=>{a=!1}},[t==null?void 0:t.uid]);const[Nl,ci]=d.useState(""),[Yt,pu]=d.useState(""),Xt=G.useMemo(()=>{const a=Mt;if(!a)return!1;const n=Hu(a),o=a.planType??a.plan??null,c=typeof o=="string"?o.toLowerCase():null,u=c==="monthly"||c==="quarterly"||c==="half_yearly"||c==="yearly"||c==="lifetime"||o===ta.MONTHLY||o===ta.QUARTERLY||o===ta.HALF_YEARLY||o===ta.YEARLY||o===ta.LIFETIME;return n&&u},[Mt]),De=G.useMemo(()=>{var c,u;const a=Mt;if(!a)return!1;const n=((c=a.subscription)==null?void 0:c.planType)??((u=a.subscription)==null?void 0:u.plan)??a.planType??a.plan??null,o=typeof n=="string"?n.toLowerCase():null;return n===ta.ZERO||o==="zero"},[Mt]),_e=G.useMemo(()=>{var c,u;const a=Mt;if(!a)return!1;const n=((c=a.subscription)==null?void 0:c.planType)??((u=a.subscription)==null?void 0:u.plan)??a.planType??a.plan??null,o=typeof n=="string"?String(n).trim().toLowerCase():null;return n===ta.TAHWEELA||o==="tahweela"||o==="ØªØ­ÙˆÙŠÙ„Ù‡"},[Mt]),tg=()=>{if(!Xt){x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ù†ØµÙ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒÙƒ.",variant:"destructive"});return}mr(!0)},[uN,mN]=d.useState(!1),[ag,sg]=d.useState(!1),[rg,ng]=d.useState(!1),[ig,og]=d.useState(!1),[lg,Kr]=d.useState(!1),[xs,di]=d.useState(""),[Jr,ui]=d.useState(""),[xu,mi]=d.useState(!1),[Hr,Qr]=d.useState(null),[jl,hi]=d.useState(""),[cg,yu]=d.useState(!1),[hN,fN]=d.useState(!1),[dg,fi]=d.useState(!1),[bu,Sl]=d.useState(""),[vu,Dl]=d.useState(""),[wu,Nu]=d.useState(!1);d.useEffect(()=>{const a=n=>{var u,h;const o=(u=n.detail)==null?void 0:u.action,c=((h=n.detail)==null?void 0:h.payload)||{};if(console.log("ðŸ”” Dashboard Navigation Action:",o,c),o==="lines")L("lines",()=>{const f=(i==null?void 0:i.simSubscription)||(t==null?void 0:t.simSubscription);let p=!1;f!=null&&f.active&&(f!=null&&f.endsAt)&&(f.endsAt.seconds?new Date(f.endsAt.seconds*1e3):new Date(f.endsAt))>new Date&&(p=!0),p?$n(!0):vt(!0)});else if(o==="profile-settings")L("settings",()=>ct(!0));else if(o==="debts")L("debts",()=>Gn());else if(o==="sales")L("sales",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):$s(!0)});else if(o==="maintenance")L("maintenance",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„ØµÙŠØ§Ù†Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Lr(!0)});else if(o==="credit-cards")L("cards",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙƒØ±ÙˆØª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù† ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Wr(!0)});else if(o==="shop-expenses")L("expenses",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Bt.hasMasterPin()?Ts(!0):ds(!0)});else if(o==="deficiencies")L("deficiencies",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):wr(!0)});else if(o==="installment")L("installments",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ· ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Rr(!0)});else if(o==="cashier-shift")!Xt||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ÙƒØ§Ø´ÙŠØ± Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):mr(!0);else if(o==="machine-daily")L("machines",()=>{!Xt||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):Fr(!0)});else if(o==="atm-withdraw")L("withdrawals",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø³Ø­Ø¨ ATM ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ Ø£Ùˆ ØªØ­ÙˆÙŠÙ„Ù‡. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):H(!0)});else if(o==="pending-operations")yt(!0);else if(o==="branch-management")L("branches",()=>{(Dt==null?void 0:Dt.status)==="active"?fr(!0):gr(!0)});else if(o==="my-client-numbers")L("myNumbers",()=>_n(!0));else if(o==="transaction-section"){const f=()=>{const p=document.getElementById("transaction-section");if(p){const w=c.skipAnimation?"auto":"smooth";p.scrollIntoView({behavior:w})}c.transactionType&&No(c.transactionType),c.startNewTransaction&&(kr(""),Ws(""),On(""),En(""),console.log("ðŸ”’ Starting new transaction via event"))};c.transactionType==="transfer"?L("transfers",f):c.transactionType==="withdraw"?L("withdrawals",f):f()}};return window.addEventListener("dashboard-navigation-action",a),()=>window.removeEventListener("dashboard-navigation-action",a)},[J,_e,Dt,De,Xt]);const ju=async()=>{var a;if(t!=null&&t.uid)try{const n=`userData_${t.uid}`,o=localStorage.getItem(n),c=`debts_unsynced_${t.uid}`,u=localStorage.getItem(Yr()),h=localStorage.getItem(c)==="true";if(o){const f=JSON.parse(o);console.log("ðŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ù…Ø¹ Firebase...",f);const p={lastSynced:new Date().toISOString()};typeof f.cashBalance=="number"&&(p.cashBalance=f.cashBalance),f.walletBalances&&typeof f.walletBalances=="object"&&(p.walletBalances=f.walletBalances),await oe.updateUserData(t.uid,p),localStorage.removeItem(n),ve(!1),console.log("âœ… ØªÙ…Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©")}else console.log("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ© ØªØ­ØªØ§Ø¬ Ù„Ù„Ù…Ø²Ø§Ù…Ù†Ø©");if(h&&u)try{const f=JSON.parse(u)||[],p=_=>_ instanceof Date?_:typeof(_==null?void 0:_.toDate)=="function"?_.toDate():_?new Date(String(_)):new Date,w=_=>(Array.isArray(_)?_:[]).map(O=>({...O,amount:Number(O.amount||0),paidAmount:Number(O.paidAmount||0),createdAt:p(O.createdAt),partialPayments:Array.isArray(O.partialPayments)?O.partialPayments.map(V=>({amount:Number(V.amount||0),paidAt:p(V.paidAt)})):[]})),b=await la(Pe($,"users",t.uid)),y=b.exists()?((a=b.data())==null?void 0:a.debts)||[]:[],N=w(y),k=w(f),C={};for(const _ of N)C[String(_.id||"")]=_;const T=[],R=new Set;for(const _ of k){const O=String(_.id||""),V=C[O];if(V){const le=Number(V.paidAmount||0),te=Number(_.paidAmount||0),Ae=String(V.status||"pending"),Xe=String(_.status||"pending"),Ze=Ae==="paid"||le>=Number(V.amount||0)?V:Xe==="paid"?{...V,paidAmount:Number(_.paidAmount||0),partialPayments:_.partialPayments,status:"paid"}:te>le?{...V,paidAmount:Number(_.paidAmount||0),partialPayments:_.partialPayments,status:te>=Number(V.amount||0)?"paid":"pending"}:V;T.push(Ze),R.add(O)}else T.push(_),R.add(O)}for(const _ of N){const O=String(_.id||"");R.has(O)||T.push(_)}await oe.updateUserData(t.uid,{debts:T});try{localStorage.removeItem(c)}catch{}ve(!1)}catch{ve(!0)}}catch(n){console.error("âŒ ÙØ´Ù„ ÙÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:",n),x({title:"ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…",variant:"destructive"})}},[Su,gi]=d.useState({keepLastCount:30,intervalDays:7,lastResetAt:null});d.useEffect(()=>{(async()=>{if(t!=null&&t.uid)try{const n=await oe.getUserData(t.uid),o=(n==null?void 0:n.recentReset)||{},c=Number(o==null?void 0:o.keepLastCount)>0?Number(o.keepLastCount):30,u=Number(o==null?void 0:o.intervalDays)>0?Number(o.intervalDays):7,h=b=>b instanceof Date?b:typeof(b==null?void 0:b.toDate)=="function"?b.toDate():b?new Date(String(b)):null,f=o!=null&&o.lastResetAt?h(o.lastResetAt):null,p=new Date;!f||p.getTime()-f.getTime()>=u*24*60*60*1e3?(await oe.updateUserData(t.uid,{recentReset:{keepLastCount:c,intervalDays:u,lastResetAt:p}}),gi({keepLastCount:c,intervalDays:u,lastResetAt:p})):gi({keepLastCount:c,intervalDays:u,lastResetAt:f})}catch{gi({keepLastCount:30,intervalDays:7,lastResetAt:null})}})()},[t==null?void 0:t.uid]);const Du=G.useMemo(()=>{const a=he||[],n=f=>f instanceof Date?f:typeof(f==null?void 0:f.toDate)=="function"?f.toDate():new Date(String(f)),o=new Date,c=new Date(o.getFullYear(),o.getMonth(),1),u=new Date(o.getFullYear(),o.getMonth()+1,1);return[...a].sort((f,p)=>n(p.createdAt).getTime()-n(f.createdAt).getTime()).filter(f=>{const p=n(f.createdAt);return p>=c&&p<u})},[he]);G.useMemo(()=>{const a=he||[],n=f=>f instanceof Date?f:typeof(f==null?void 0:f.toDate)=="function"?f.toDate():new Date(String(f)),o=new Date,c=new Date(o.getFullYear(),o.getMonth(),1),u=new Date(o.getFullYear(),o.getMonth()+1,1),h=a.filter(f=>{const p=n(f.createdAt);return p>=c&&p<u}).length;return Math.max(0,((he==null?void 0:he.length)||0)-h)},[he==null?void 0:he.length]);const pi=G.useMemo(()=>{const a=new Date,n=new Date(a.getFullYear(),a.getMonth(),1),o=new Date(a.getFullYear(),a.getMonth()+1,1),c={};for(const h of he){const f=new Date(h.createdAt||0);if(!(f>=n&&f<o))continue;const p=String(h.type||h.txnType||"").toLowerCase();if(!(p==="send"||p==="withdraw"||p==="transfer"))continue;const w=String(h.receiverPhone||h.senderPhone||"").trim();if(!w)continue;const b=Ft(w),y=Number(h.amount||h.withdrawnAmount||h.sentAmount||0)||0;c[b]||(c[b]={phone:b,count:0,total:0}),c[b].count+=1,c[b].total+=y}return Object.values(c).sort((h,f)=>f.count!==h.count?f.count-h.count:f.total-h.total).slice(0,10)},[he]),ug=a=>{const n=Ft(String(a));return n.startsWith("+20")?"20"+n.slice(3):n.startsWith("0")?"20"+n.slice(1):n.replace(/[^0-9]/g,"")},mg=a=>{const n=ug(a.phone),o=`Ø¹Ù…ÙŠÙ„ VIP Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±
Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª: ${a.count}
Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${a.total} Ø¬Ù†ÙŠÙ‡`,c=`https://wa.me/${n}?text=${encodeURIComponent(o)}`;try{window.open(c,"_blank")}catch{}};d.useEffect(()=>{(async()=>{try{if(!(t!=null&&t.uid))return;const a=`${new Date().getFullYear()}-${new Date().getMonth()+1}`;await oe.updateUserData(t.uid,{vipTop10:pi,vipMonthTag:a})}catch{}})()},[t==null?void 0:t.uid,pi]);async function ku(){const a=new Date,n=new Intl.DateTimeFormat("ar-EG",{timeZone:"Africa/Cairo",year:"numeric",month:"2-digit",day:"2-digit"}).format(a),o=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999),u=(he||[]).filter(C=>{const T=new Date(C.createdAt||0);return T>=o&&T<=c}),h=u.length,f=u.filter(C=>String(C.type||C.txnType||"").toLowerCase()==="withdraw"||String(C.type||"").toLowerCase()==="receive").reduce((C,T)=>C+(T.withdrawnAmount!=null?Number(T.withdrawnAmount):Number(T.amount||0)),0),p=u.filter(C=>String(C.type||C.txnType||"").toLowerCase()==="send"||String(C.type||"").toLowerCase()==="transfer").reduce((C,T)=>C+(T.sentAmount!=null?Number(T.sentAmount):Number(T.amount||0)),0);let w=0;try{w=u.reduce((C,T)=>C+Ot.calculateTransactionProfit(T),0)}catch{}let b=0;try{const C=new Intl.DateTimeFormat("en-CA",{timeZone:"Africa/Cairo"}).format(a),T=Ee(ce($,"dailySales"),Y("userId","==",(t==null?void 0:t.uid)||""));b=(await ke(T)).docs.map(O=>O.data()).filter(O=>String(O.date||C)===C).reduce((O,V)=>O+Number(V.sellingPrice||V.price||0)*Number(V.quantity||1),0)}catch{}let y=0;try{y=(Re||[]).filter(T=>String(T.status||"")==="pending").reduce((T,R)=>{const _=Number(R.paidAmount||0);return T+Math.max(0,Number(R.amount||0)-_)},0)}catch{}let N="";try{const C=j||(r==null?void 0:r.shopId)||null,T=C?Ee(ce($,"deficiencies"),Y("shopId","==",C)):Ee(ce($,"deficiencies"),Y("userId","==",(t==null?void 0:t.uid)||""));N=(await ke(T)).docs.map(V=>V.data()).filter(V=>String(V.status||"pending")==="pending").slice(0,10).map((V,le)=>`${le+1}- ${String(V.name||V.productName||"Ø¹Ù†ØµØ±")} Ã— ${Number(V.quantity||V.qty||0)}`).join(`
`)}catch{}return[`ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ - ${n}`,`Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª: ${h}`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª: ${f} Ø¬Ù†ÙŠÙ‡`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ${p} Ø¬Ù†ÙŠÙ‡`,`Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: ${w} Ø¬Ù†ÙŠÙ‡`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±: ${b} Ø¬Ù†ÙŠÙ‡`,`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙŠÙˆÙ†: ${y} Ø¬Ù†ÙŠÙ‡`,"Ù†ÙˆØ§Ù‚Øµ Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±:",N||"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³Ø¬Ù„Ø©"].join(`
`)}const Cu=G.useCallback(()=>{let a=Du;const n=yd.trim();if(n&&(a=a.filter(o=>{const c=o;return String(c.type||"").toLowerCase()==="cash_addition"||String(c.txnType||"").toLowerCase()==="cash_addition"||String(c.title||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©")?!0:o.senderPhone&&o.senderPhone.includes(n)||o.receiverPhone&&o.receiverPhone.includes(n)})),Fn){const o=new Date(Fn);a=a.filter(c=>{const u=new Date(c.createdAt);if(Bn){const[h,f]=Bn.split(":"),p=new Date(o);p.setHours(parseInt(h),parseInt(f),0,0);const w=new Date(p);return w.setHours(w.getHours()+1),u>=p&&u<w}else return u.toDateString()===o.toDateString()})}try{a=[...a].sort((o,c)=>{const u=new Date(o.createdAt||0).getTime();return new Date(c.createdAt||0).getTime()-u})}catch{}return a},[Du,yd,Fn,Bn]),Iu=async()=>{if(De||_e){x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"});return}if(!(t!=null&&t.uid)){x({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©",description:"ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}try{const a=await ku(),n=t!=null&&t.uid?`tg_daily_report_last_${t.uid}`:"tg_daily_report_last",o=Date.now();let c=!0;try{const u=localStorage.getItem(n);if(u){const h=JSON.parse(u),f=Number((h==null?void 0:h.at)||0);o-f<3e4&&(c=!1)}}catch{}if(c){await vs.send(t.uid,a);try{localStorage.setItem(n,JSON.stringify({at:o}))}catch{}}x({title:"ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",variant:"default"})}catch{x({title:"ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:"ØªØ¹Ø°Ù‘Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",variant:"destructive"})}},[hg,xi]=d.useState(!1),[_u,yi]=d.useState(""),[fg,bi]=d.useState(!1),[kl,Cl]=d.useState(""),[gg,ve]=d.useState(!1),[pg,Il]=d.useState(!1),ys=async(a,n=2,o=700)=>{let c;for(let u=0;u<=n;u++)try{return await a()}catch(h){if(c=h,u===n)break;await new Promise(f=>setTimeout(f,o*Math.pow(2,u)))}throw c};J.reduce((a,n)=>a+(Se[n.id]||0),0);const xg=async a=>await Bt.verifyMasterPin(a,t==null?void 0:t.uid),vi=async a=>await Bt.verifyMasterPin(a,t==null?void 0:t.uid);d.useEffect(()=>{if(t!=null&&t.uid){try{const a=Ge(),n=`walletBalances_${t.uid}`,o=localStorage.getItem(a)??localStorage.getItem(n);if(o){const c=JSON.parse(o);mt(c&&typeof c=="object"?c:{});try{localStorage.setItem(a,JSON.stringify(c||{}))}catch{}}}catch{}try{const a=Ye(),n=`cashBalance_${t.uid}`,o=`userCashBalance_${t.uid}`;let c=localStorage.getItem(a)??localStorage.getItem(n)??localStorage.getItem(o);if(c!=null){const u=parseFloat(c);ot(Number.isFinite(u)?u:0);try{localStorage.setItem(a,String(Number.isFinite(u)?u:0)),localStorage.removeItem(n),localStorage.removeItem(o)}catch{}}}catch{}}},[t==null?void 0:t.uid,j,r==null?void 0:r.shopId]),d.useEffect(()=>{const a=n=>{var o;try{const c=Number((o=n==null?void 0:n.detail)==null?void 0:o.value);if(Number.isFinite(c))ot(c);else{const u=localStorage.getItem(Ye());u!=null&&ot(parseFloat(u)||0)}}catch{const c=localStorage.getItem(Ye());c!=null&&ot(parseFloat(c)||0)}};return window.addEventListener("cashBalanceChanged",a),()=>window.removeEventListener("cashBalanceChanged",a)},[t==null?void 0:t.uid,j,r==null?void 0:r.shopId]);const{data:_l}=un({queryKey:["dashboardData",j||(r==null?void 0:r.shopId)],queryFn:async()=>{const a=j||(r==null?void 0:r.shopId);if(!a)return null;const n=Pe($,"dashboardData",a),o=await la(n);return o.exists()?o.data():null},enabled:!!(t!=null&&t.uid&&(j||r!=null&&r.shopId)),staleTime:1e3*60*5,refetchInterval:1e3*60*5});d.useEffect(()=>{if(_l){const a=_l,n=Number((a==null?void 0:a.cashBalance)||0),o=a!=null&&a.walletBalances&&typeof a.walletBalances=="object"?a.walletBalances:{};try{const c=a!=null&&a.lastUpdated?new Date(a.lastUpdated).getTime():0,u=localStorage.getItem(Ye()+"_lastUpdated"),h=u?new Date(u).getTime():0;c>=h&&(ot(n),mt(o),localStorage.setItem(Ye(),String(n)),localStorage.setItem(Ge(),JSON.stringify(o)),a!=null&&a.lastUpdated&&(localStorage.setItem(Ye()+"_lastUpdated",a.lastUpdated),localStorage.setItem(Ge()+"_lastUpdated",a.lastUpdated)))}catch{}}},[_l]);const Au=a=>`walletLimits_${(t==null?void 0:t.uid)||"default"}_${a||"none"}`,{data:wi}=un({queryKey:["walletLimits",M],queryFn:async()=>{if(!M)return null;const a=Pe($,"walletLimits",String(M)),n=await la(a);return n.exists()?n.data():null},enabled:!!M,staleTime:1e3*60*5});d.useEffect(()=>{if(M)try{const a=Au(M),n=localStorage.getItem(a);if(n&&!wi){const o=JSON.parse(n);Hs(o)}if(wi){const o=wi,c={walletId:M,dailyTransferLimit:o.dailyTransferLimit??6e4,dailyWithdrawLimit:o.dailyWithdrawLimit??1e5,dailyTransferUsed:o.dailyTransferUsed??0,dailyWithdrawUsed:o.dailyWithdrawUsed??0,monthlyTransferLimit:o.monthlyTransferLimit??2e5,monthlyWithdrawLimit:o.monthlyWithdrawLimit??2e5,monthlyTransferUsed:o.monthlyTransferUsed??0,monthlyWithdrawUsed:o.monthlyWithdrawUsed??0};Hs(c);try{localStorage.setItem(Au(M),JSON.stringify(c))}catch{}}}catch{}},[M,wi]),d.useEffect(()=>{if(!M)return;const a=J.find(n=>n.id===M);if(a!=null&&a.name){au(String(a.name));try{localStorage.setItem(`walletName_${(t==null?void 0:t.uid)||"default"}_${M}`,String(a.name))}catch{}return}try{const n=localStorage.getItem(`walletName_${(t==null?void 0:t.uid)||"default"}_${M}`);n&&au(String(n))}catch{}},[M,J]);const Al=async()=>{try{if(!M)return;const a=await Ua.autoResetLimitsIfNeeded(M);Hs(a)}catch(a){console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:",a)}};d.useEffect(()=>{Al()},[M]),d.useEffect(()=>{const a=n=>{var o;(o=n==null?void 0:n.detail)!=null&&o.walletId&&n.detail.walletId===M&&Al()};return window.addEventListener("walletLimitsUpdated",a),()=>window.removeEventListener("walletLimitsUpdated",a)},[M]),d.useEffect(()=>{const a=n=>{var o;try{const c=String(((o=n==null?void 0:n.detail)==null?void 0:o.walletId)||"");c&&Gr(c,"sms:auto")}catch{}};return window.addEventListener("walletSelection:update",a),()=>window.removeEventListener("walletSelection:update",a)},[J]),d.useEffect(()=>{if(m.state){if(console.log("Location state:",m.state),m.state.openDebtDialog&&(Gn(),window.history.replaceState({},document.title)),m.state.openSalesDialog&&(De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):$s(!0),window.history.replaceState({},document.title)),m.state.openMaintenanceDialog&&(De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„ØµÙŠØ§Ù†Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Lr(!0),window.history.replaceState({},document.title)),m.state.openCreditCardsDialog&&(console.log("Opening credit cards dialog"),De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙƒØ±ÙˆØª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù† ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Wr(!0),window.history.replaceState({},document.title)),m.state.openShopExpensesDialog&&(De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Bt.hasMasterPin()?Ts(!0):ds(!0),window.history.replaceState({},document.title)),m.state.openDeficienciesDialog&&(De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):wr(!0),window.history.replaceState({},document.title)),m.state.openInstallment&&(De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ· ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Rr(!0),window.history.replaceState({},document.title)),m.state.openTransactionSection){const a=document.getElementById("transaction-section");a&&a.scrollIntoView({behavior:"smooth"}),m.state.transactionType&&No(m.state.transactionType),m.state.startNewTransaction&&(kr(""),Ws(""),On(""),En(""),console.log("ðŸ”’ Starting new transaction without changing wallet selection")),m.state.focusWalletSelection&&setTimeout(()=>{const n=document.querySelector('[data-testid="wallet-select"]');n&&n.focus()},500),window.history.replaceState({},document.title)}m.state.openCashierShiftModal&&(!Xt||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ÙƒØ§Ø´ÙŠØ± Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):mr(!0),window.history.replaceState({},document.title)),m.state.openMachineDailyDialog&&(!Xt||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"}):Fr(!0),window.history.replaceState({},document.title)),m.state.openBranchManagement&&((Dt==null?void 0:Dt.status)==="active"?fr(!0):gr(!0),window.history.replaceState({},document.title)),m.state.openMyClientNumbersDialog&&(_n(!0),window.history.replaceState({},document.title)),m.state.openPendingOperationsDialog&&(yt(!0),window.history.replaceState({},document.title))}},[m.state,J,_e,Dt]),d.useEffect(()=>{m.pathname==="/user/dashboard"&&sessionStorage.getItem("previousPath")==="/user/add-wallet"&&(console.log("ðŸ”„ Returned from wallet addition page - reloading wallets"),Tl(),sessionStorage.removeItem("previousPath")),sessionStorage.setItem("previousPath",m.pathname)},[m.pathname,t==null?void 0:t.uid]),d.useEffect(()=>{if(!(t!=null&&t.uid))return;(async()=>{try{const n=Pe($,"users",t.uid),o=await la(n);if(o.exists()){const u=o.data().isActive===!0;u&&!yr?(za(!0),Ya(!1),br(!1)):!u&&yr&&(za(!1),Ya(!0))}}catch(n){console.error("Check user status error",n)}})()},[t==null?void 0:t.uid]),d.useEffect(()=>{if(!(t!=null&&t.uid))return;const a=o=>{const{userId:c}=o.detail;c===t.uid&&(console.log("ðŸŽ‰ Subscription activation event received for current user!"),za(!0),Ya(!1),br(!1),setTimeout(()=>{console.log("âœ… User activation completed - data updated")},1e3))},n=o=>{const c=o.detail||{},{userId:u,isActive:h}=c;u&&u===t.uid&&(console.log("ðŸ”„ User subscription update event received:",{userId:u,isActive:h}),h&&!yr&&(za(!0),Ya(!1),br(!1),setTimeout(()=>{console.log("âœ… User subscription updated - data refreshed")},1e3)))};return window.addEventListener("subscriptionActivated",a),window.addEventListener("userSubscriptionUpdated",n),()=>{window.removeEventListener("subscriptionActivated",a),window.removeEventListener("userSubscriptionUpdated",n)}},[t==null?void 0:t.uid,yr]),d.useEffect(()=>{const a=n=>{var h;const o=n.target,c=(h=o==null?void 0:o.tagName)==null?void 0:h.toLowerCase();if(!(c==="input"||c==="textarea"||c==="select"||((o==null?void 0:o.isContentEditable)??!1))&&!(n.ctrlKey||n.altKey||n.metaKey)&&!n.repeat){if((De||_e)&&n.key>="1"&&n.key<="9"){n.preventDefault();return}switch(n.key){case"1":break;case"2":Lo(!0);break;case"3":De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙƒØ±ÙˆØª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù† ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Wr(!0);break;case"4":Xt?mr(!0):x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ÙƒØ§Ø´ÙŠØ± Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"});break;case"5":De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):$s(!0);break;case"6":Gn();break;case"7":De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„ØµÙŠØ§Ù†Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Lr(!0);break;case"8":Xt?Fr(!0):x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"});break;case"9":De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Bt.hasMasterPin()?Ts(!0):ds(!0);break}}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[De,_e,Xt]),d.useEffect(()=>{console.log("ðŸ”¥ useEffect loadUserData started",{user:t==null?void 0:t.uid,isCheckingActivation:ao}),(async()=>{try{if(!(t!=null&&t.uid)){console.log("ðŸ”¥ No user UID, setting isCheckingActivation to false"),br(!1);return}try{const h=await la(Pe($,"users",t.uid));if(h.exists()){const p=h.data().isActive===!0,w=await lm.checkTrialValidity(t.uid),b=w.isValid&&!w.isExpired;za(p||b),Yc(b),Kc(w.hoursRemaining),Jc(w.hasUsedTrial),Ya(!p&&!b),console.log("ðŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",{isActive:p,isOnTrial:b,hoursRemaining:w.hoursRemaining,hasUsedTrial:w.hasUsedTrial})}else za(!1),Ya(!0)}catch(h){console.error("Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø­Ø§Ù„Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",h),za(!1),Ya(!0)}finally{br(!1)}if(console.log("ðŸ”„ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firebase...",{userId:t==null?void 0:t.uid}),t!=null&&t.uid){const h=await ys(()=>oe.getUserData(t.uid)),f=`userData_${t==null?void 0:t.uid}`;let p=null;try{const w=localStorage.getItem(f);w&&(p=JSON.parse(w))}catch{}if(h){let w=(h==null?void 0:h.walletBalances)||{},b=h==null?void 0:h.cashBalance;const y=h.lastUpdated?new Date(h.lastUpdated).getTime():0;p&&(p.lastUpdated?new Date(p.lastUpdated).getTime():0)>=y&&(p.walletBalances&&(w=p.walletBalances),p.cashBalance!==void 0&&(b=p.cashBalance));try{const N=Ye(),k=Ge(),C=localStorage.getItem(N+"_lastUpdated"),T=localStorage.getItem(k+"_lastUpdated"),R=C?new Date(C).getTime():0,_=T?new Date(T).getTime():0;if(R>y){const O=localStorage.getItem(N);O!==null&&(b=parseFloat(O))}if(_>y){const O=localStorage.getItem(k);if(O!==null)try{w=JSON.parse(O)}catch{}}}catch(N){console.error("Error checking individual keys fallback:",N)}mt(w),b!==void 0&&ot(b);try{const N=t!=null&&t.uid?await ys(()=>dn.getDeletedTransactionsByUser(t.uid)):[];Er(N||[])}catch{Er([])}}else{mt({});try{const w=t!=null&&t.uid?await dn.getDeletedTransactionsByUser(t.uid):[];Er(w||[])}catch{Er([])}}}console.log("ðŸ”„ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase...");try{const h=await ys(()=>_i.getByMerchantId((t==null?void 0:t.uid)||""));if(h&&h.length>0){console.log("âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",h.length);const f=h.filter(N=>N.isActive===!0),p=f.map(N=>({id:N.id,name:N.label||"Ù…Ø­ÙØ¸Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",phone:N.msisdn,isDefault:!1,monthlyWithdrawalLimit:N.monthlyWithdrawalLimit??N.withdrawLimit??2e5,monthlyTransferLimit:N.monthlyTransferLimit??N.transferLimit??2e5,defaultTransferCommission:N.defaultTransferCommission!=null?Number(N.defaultTransferCommission):null,defaultWithdrawCommission:N.defaultWithdrawCommission!=null?Number(N.defaultWithdrawCommission):null,ownerName:N.ownerName,nationalId:N.nationalId,providerName:N.provider}));Cs(p);const w={};f.forEach(N=>{N.balance!==void 0&&(w[N.id]=Number(N.balance))}),Object.keys(w).length>0&&mt(N=>({...N,...w}));const b=localStorage.getItem(ps());let y=null;b&&p.find(N=>N.id===b)?y=p.find(N=>N.id===b):y=p[0],y&&(xr(y.id),Rs(y.phone)),console.log("ðŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase ÙˆØ­ÙØ¸Ù‡Ø§ ÙÙŠ localStorage")}else console.log("âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase. Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© ÙØ§Ø±ØºØ© Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ù…Ø­Ù„ÙŠ."),Cs([])}catch(h){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase:",h),Cs([])}const u=t!=null&&t.uid?await ys(()=>oe.getUserTransactions(t.uid)):[];if(u&&u.length>0){console.log("ðŸ“Š ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù…Ù† Firebase:",u.length);const h=u.map(y=>({...y,createdAt:new Date(y.createdAt),senderPhone:y.senderMsisdn||y.senderPhone||"",receiverPhone:y.receiverMsisdn||y.receiverPhone||"",type:y.txnType==="send"?"send":y.txnType==="receive"?"withdraw":y.type||"withdraw",status:y.status==="confirmed"?"completed":y.status||"completed"})),f=Or.map(y=>y.id||y.originalTransactionId);let p=[];try{const y=Ee(ce($,"deletedTransactions"),Y("userId","==",(t==null?void 0:t.uid)||""),Y("permanent","==",!0));p=(await ke(y)).docs.map(k=>{const C=k.data();return String(C.originalTransactionId||C.transactionId||k.id||"")}).filter(Boolean)}catch{}const w=new Set(p),b=h.filter(y=>{var _;const N=String(y.id||""),k=String(y.transactionId||""),C=String(y.reference||y.transactionReference||((_=y.receipt)==null?void 0:_.reference)||""),T=f.includes(N),R=w.has(N)||k&&w.has(k);return!T&&!R});console.log("âœ… ØªÙ… ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©:",{total:u.length,deleted:f.length,active:b.length});{const y=new Set,N=[];for(const k of b){const C=vl(k);y.has(C)||(y.add(C),N.push(k))}Y0||qt(N)}}await ju()}catch(u){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firebase:",u)}})().then(async()=>{await c(),await n(),await o()});const n=async()=>{try{if(!(t!=null&&t.uid))return;const u=await _i.getByMerchantId(t.uid);await Promise.all(u.map(h=>Yv.autoResetLimitsIfNeeded(h.id)))}catch(u){console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø­Ø¯ÙˆØ¯:",u)}},o=async()=>{try{await Ot.syncReportsDataFromFirebase(t==null?void 0:t.uid);const u=Ot.getReportsData(t==null?void 0:t.uid);if((u.lastDailyResetDate?Ot.shouldResetDailyReports(u.lastDailyResetDate):!1)&&(t!=null&&t.uid)&&u.lastDailyResetDate){const p=new Date(u.lastDailyResetDate),w=p.toDateString(),b=he.filter(_=>new Date(_.createdAt).toDateString()===w&&_.status==="completed"),y=b.length,N=b.reduce((_,O)=>_+O.amount,0),k=b.filter(Xr).reduce((_,O)=>{const V=O.withdrawnAmount!==void 0?O.withdrawnAmount:O.amount;return _+V},0),C=b.filter(Zr).reduce((_,O)=>{const V=O.sentAmount!==void 0?O.sentAmount:O.amount;return _+V},0),T=b.reduce((_,O)=>_+Ot.calculateTransactionProfit(O),0),R=new Date(p).toISOString().slice(0,10);await tn.add({userId:t.uid,reportDate:R,totalTransactions:y,totalAmount:Number(N.toFixed(2)),totalWithdrawn:Number(k.toFixed(2)),totalSent:Number(C.toFixed(2)),profit:Number(T.toFixed(2)),walletId:null})}const f=Ot.autoResetReportsIfNeeded(t==null?void 0:t.uid);(f.dailyReset||f.monthlyReset)&&console.log("ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ:",f)}catch(u){console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ØªÙ‚Ø§Ø±ÙŠØ±:",u)}},c=async()=>{try{if(!(t!=null&&t.uid))return;const u=new Date;if(u.getDate()!==1)return;const h=`${u.getFullYear()}-${u.getMonth()+1}`,f=`lastMonthlyDbCleanup:${t.uid}`;if(localStorage.getItem(f)===h)return;const w=new Date(u.getFullYear(),u.getMonth(),1,0,0,0,0),b=k=>k instanceof Date?k:typeof(k==null?void 0:k.toDate)=="function"?k.toDate():new Date(String(k));let y=[];try{const k=Ee(ce($,"userTransactions"),Y("userId","==",t.uid),Y("createdAt","<",w));y=(await ke(k)).docs}catch{const k=Ee(ce($,"userTransactions"),Y("userId","==",t.uid));y=(await ke(k)).docs.filter(T=>{var R;return b((R=T.data())==null?void 0:R.createdAt)<w})}await Promise.allSettled(y.map(k=>Gu(k.ref)));let N=[];try{const k=Ee(ce($,"transactions"),Y("userId","==",t.uid),Y("createdAt","<",w));N=(await ke(k)).docs}catch{const k=Ee(ce($,"transactions"),Y("userId","==",t.uid));N=(await ke(k)).docs.filter(T=>{var R;return b((R=T.data())==null?void 0:R.createdAt)<w})}await Promise.allSettled(N.map(k=>Gu(k.ref)));try{localStorage.setItem(f,h)}catch{}console.log("âœ… ØªÙ… ØªÙ†Ø¸ÙŠÙ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ù‡Ø±ÙŠÙ‹Ø§ (Firebase ÙÙ‚Ø·):",{userTransactionsDeleted:y.length,globalTransactionsDeleted:N.length,monthStart:w})}catch(u){console.error("ÙØ´Ù„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:",u)}};Bf(),il(),eg(),console.log("ðŸ”¥ useEffect loadUserData completed")},[t==null?void 0:t.uid]),d.useEffect(()=>{if(!(t!=null&&t.uid))return;const a=oe.subscribeToUserTransactions(t.uid,n=>{if(!n||n.length===0)return;const o=n.map(c=>({...c,createdAt:new Date(c.createdAt),senderPhone:c.senderMsisdn||c.senderPhone||"",receiverPhone:c.receiverMsisdn||c.receiverPhone||"",type:c.txnType==="send"?"send":c.txnType==="receive"?"withdraw":c.type||"withdraw",status:c.status==="confirmed"?"completed":c.status||"completed"}));qt(c=>{const u=[...o,...c],h=new Set,f=[];for(const p of u){const w=vl(p);h.has(w)||(h.add(w),f.push(p))}return f.sort((p,w)=>{const b=p.createdAt instanceof Date?p.createdAt.getTime():new Date(p.createdAt).getTime();return(w.createdAt instanceof Date?w.createdAt.getTime():new Date(w.createdAt).getTime())-b})})},30);return()=>a()},[t==null?void 0:t.uid]),d.useEffect(()=>{const a=j||(r==null?void 0:r.shopId);if(!a)return;const n=oe.subscribeToDashboardData(a,o=>{if(!o)return;const c=Number(o.cashBalance||0);ot(c);const u=o.walletBalances&&typeof o.walletBalances=="object"?o.walletBalances:{};mt(u);try{if(localStorage.setItem(Ye(),String(c)),localStorage.setItem(Ge(),JSON.stringify(u)),o.lastUpdated){const h=String(o.lastUpdated);localStorage.setItem(Ye()+"_lastUpdated",h),localStorage.setItem(Ge()+"_lastUpdated",h)}}catch(h){console.error("Error saving real-time dashboard data to local storage",h)}});return()=>n()},[j,r==null?void 0:r.shopId]);const Tl=async()=>{var a;if(t!=null&&t.uid)try{const n=await ys(()=>_i.getByMerchantId(t.uid));if(n&&n.length>0){const c=n.filter(u=>u.isActive===!0).map(u=>({id:u.id,name:u.label||"Ù…Ø­ÙØ¸Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…",phone:u.msisdn,isDefault:!1,monthlyWithdrawalLimit:u.monthlyWithdrawalLimit??u.withdrawLimit??2e5,monthlyTransferLimit:u.monthlyTransferLimit??u.transferLimit??2e5,defaultTransferCommission:u.defaultTransferCommission!=null?Number(u.defaultTransferCommission):void 0,defaultWithdrawCommission:u.defaultWithdrawCommission!=null?Number(u.defaultWithdrawCommission):void 0}));if(Cs(c),t!=null&&t.uid){const u=localStorage.getItem(ps());if(!!(M&&c.find(f=>f.id===M)))console.log("ðŸ”’ Preserving current wallet selection:",M);else{const p=(u&&c.find(w=>w.id===u)?u:null)||((a=c[0])==null?void 0:a.id);p&&(console.log("ðŸ”„ Fixing invalid wallet selection:",p),Gr(p))}}console.log("ðŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase:",c.length)}}catch(n){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ù…Ù† Firebase:",n)}};d.useEffect(()=>{const a=m.pathname;if(sessionStorage.getItem("previousPath")==="/user/add-wallet"&&a==="/user/dashboard"){E.invalidateQueries({queryKey:["wallets",t==null?void 0:t.uid]});try{Wn.refetch()}catch{}sessionStorage.removeItem("previousPath")}sessionStorage.setItem("previousPath",a)},[m.pathname,t==null?void 0:t.uid]),d.useEffect(()=>{const a=()=>{E.invalidateQueries({queryKey:["wallets",t==null?void 0:t.uid]});try{Wn.refetch()}catch{}};return window.addEventListener("focus",a),()=>{window.removeEventListener("focus",a)}},[t==null?void 0:t.uid,M,J]);const Gr=async(a,n="unknown")=>{console.log(`ðŸŽ¯ setWalletSelection called from ${n} with walletId:`,a),console.log("ðŸ” Previous selectedWallet:",M),xr(a);const o=J.find(c=>c.id===a);if(o&&(Rs(o.phone),console.log("âœ… Wallet set successfully:",a,"Phone:",o.phone)),t!=null&&t.uid){localStorage.setItem(ps(),a),console.log("ðŸ’¾ Saved wallet to localStorage:",a);try{await an.set({key:"selected_wallet_id",value:a}),await an.set({key:"current_user_id",value:t.uid}),console.log("ðŸ“± Saved wallet and user ID to Capacitor Preferences:",a,t.uid)}catch(c){console.error("âŒ Failed to save to Capacitor Preferences:",c)}}};d.useEffect(()=>{const a=()=>{Tl()};try{window.addEventListener("wallets:activation-updated",a)}catch{}return()=>{try{window.removeEventListener("wallets:activation-updated",a)}catch{}}},[t==null?void 0:t.uid]);const yg=a=>{if(a==="__add_wallet"){g("/user/add-wallet");return}if(a==="__view_wallets"){Pn(!0);return}Dp.isEnabled(t==null?void 0:t.uid)?(bo(a),yo(!0)):Gr(a,"walletSelectionNoPin")},Ni=a=>{console.log("ðŸ”„ handleTransactionTypeChange called with type:",a),console.log("ðŸ” Current selectedWallet before change:",M),console.log("ðŸ” Available wallets count:",J.length),No(a),kr(""),Ws(""),On(""),En(""),console.log("âœ… Transaction type changed to:",a,"- Wallet selection preserved:",M),setTimeout(()=>{const n=document.getElementById("transaction-section");n&&n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)};d.useEffect(()=>{const a=n=>{const o=n.target;if(!!o&&(o.tagName==="INPUT"||o.tagName==="TEXTAREA"||o.tagName==="SELECT"||o.isContentEditable)||(n.key==="ArrowLeft"?(n.preventDefault(),Ni("withdraw")):n.key==="ArrowRight"&&(n.preventDefault(),Ni("transfer"))),n.key==="Enter"){if(document.querySelector('[role="dialog"]'))return;const u=B==="transfer"?"transferSubmitButton":"withdrawSubmitButton",h=document.getElementById(u);h&&!h.disabled&&(n.preventDefault(),h.click())}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[B]);const Tu=a=>{V0((o=>{const c=String(o.description||""),u=String(o.title||""),h=c.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡")||c.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||c.includes("machine transfer")||u.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡")||u.includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡"),f=String((o==null?void 0:o.provider)||"").toLowerCase(),p=f.includes("vodafone")?"vf-cash":f.includes("instapay")?"instapay":"",w=o.type==="send"?"ØªØ­ÙˆÙŠÙ„":"Ø³Ø­Ø¨";let b=o.type==="withdraw"&&p?`${w} ${p}`:w;return h?b="ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡":o.title&&(b=o.title),{id:o.id,type:h||o.type==="send"||o.type==="transfer"?"transfer":"withdraw",sender_msisdn:o.senderPhone,receiver_msisdn:o.receiverPhone,amount:o.amount,commission:o.commission||0,fee:(o==null?void 0:o.fee)??0,status:o.status==="failed"?"failed":o.status==="completed"?"completed":"pending",createdAt:new Date(o.createdAt).toISOString(),updatedAt:new Date(o.createdAt).toISOString(),shopName:A??(r==null?void 0:r.shopName)??(t==null?void 0:t.displayName)??"Ø§Ù„Ù…Ø­Ù„",cashierName:(o==null?void 0:o.cashierName)??null,commissionMode:(o==null?void 0:o.commissionMode)??(o.type==="send"||Je?"add":"deduct"),totalCharged:(o==null?void 0:o.totalCharged)??(o.type==="send"?Number(o.amount||0)+Number(o.commission||0)+Number((o==null?void 0:o.fee)||0):Je?Number(o.amount||0)+Number(o.commission||0):Number(o.amount||0)),note:(o==null?void 0:o.note)??(o==null?void 0:o.notes)??void 0,senderName:(o==null?void 0:o.senderName)??void 0,provider:(o==null?void 0:o.provider)??void 0,title:b,description:(o==null?void 0:o.description)??void 0}})(a)),Ln(!0)},Pl=async a=>{var u;if(!(t!=null&&t.uid)){x({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©",description:"ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª",variant:"destructive"});return}const n=he.find(h=>h.id===a);if(!n){x({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù",description:"Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø­Ø°ÙÙ‡Ø§",variant:"destructive"});return}const o=String(a),c=String((n==null?void 0:n.transactionId)||(n==null?void 0:n.reference)||"");ya.current.add(o),c&&ya.current.add(c);try{console.log("ðŸ—‘ï¸ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©:",a),console.log("ðŸ”„ Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Firebase...",{transactionId:n.id,userId:t.uid,transactionData:n}),await oe.removeUserTransaction(t.uid,n.id),console.log("âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Firebase userTransactions");try{await dn.saveDeletedTransaction({...n,userId:t.uid,originalTransactionId:n.id,transactionId:n.transactionId||n.id,reference:n.reference||n.transactionReference||((u=n.receipt)==null?void 0:u.reference),deletedAt:new Date().toISOString(),permanent:!0}),console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§Øª Ù…Ø¹ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø°Ù")}catch(p){console.warn("âš ï¸ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§ØªØŒ Ù„ÙƒÙ† Ø§Ù„Ø­Ø°Ù Ù…Ù† Firebase Ù†Ø¬Ø­:",p)}try{await dn.permanentlyDeleteTransaction(n.id,t.uid)}catch(p){console.warn("âš ï¸ ÙØ´Ù„ ÙˆØ³Ù… Ø§Ù„Ø­Ø°Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø£Ùˆ Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ:",p)}const h=[...Or,n],f=he.filter(p=>p.id!==a);Er(h),qt(f),fd(!1),console.log("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù Ù…Ù† Firebase (Ø¨Ø¯ÙˆÙ† Ù†Ø³Ø® Ù…Ø­Ù„ÙŠØ©)");try{const p=n.walletId||n.fromWallet;try{const w=await oe.getUserData(t.uid),b={...(w==null?void 0:w.walletBalances)||{}},y=Number((w==null?void 0:w.cashBalance)||0);if(p&&b[p]!==void 0){const N=Number(n.amount||0),k=Number(n.commission||0),C=(n.type||"").toLowerCase(),T=C==="send"||C==="transfer";let R=y,_=Number(b[p]);console.log("ðŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø£Ø±ØµØ¯Ø©...",{type:C,amount:N,commission:k,currentCash:y,walletBalance:_}),T?(_+=N,R=R-N-k):(_-=N,R=R+N-k),b[p]=_,await oe.updateUserData(t.uid,{walletBalances:b,cashBalance:R,lastUpdated:new Date().toISOString()}),console.log("âœ… ØªÙ… Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ù„Ù…Ø­ÙØ¸Ø© ÙˆØ¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©",{newCash:R,newWalletBalance:_})}}catch(w){console.warn("âš ï¸ ÙØ´Ù„ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø£Ø±ØµØ¯Ø©:",w)}if(p){const{walletDailyLimitsService:w}=await re(async()=>{const{walletDailyLimitsService:y}=await import("./index-CHyvkdwe.js").then(N=>N.cO);return{walletDailyLimitsService:y}},__vite__mapDeps([0,1]),import.meta.url),b=await w.getWalletLimits(p);if(b){const y=n.type==="send",N={updatedAt:(await re(async()=>{const{serverTimestamp:_}=await import("./index-CHyvkdwe.js").then(O=>O.cF);return{serverTimestamp:_}},__vite__mapDeps([0,1]),import.meta.url)).serverTimestamp()};y?(N.dailyTransferUsed=Math.max(0,(b.dailyTransferUsed||0)-n.amount),N.monthlyTransferUsed=Math.max(0,(b.monthlyTransferUsed||0)-n.amount)):(N.dailyWithdrawUsed=Math.max(0,(b.dailyWithdrawUsed||0)-n.amount),N.monthlyWithdrawUsed=Math.max(0,(b.monthlyWithdrawUsed||0)-n.amount));const{doc:k,setDoc:C}=await re(async()=>{const{doc:_,setDoc:O}=await import("./index-CHyvkdwe.js").then(V=>V.cF);return{doc:_,setDoc:O}},__vite__mapDeps([0,1]),import.meta.url),{db:T}=await re(async()=>{const{db:_}=await import("./index-CHyvkdwe.js").then(O=>O.cG);return{db:_}},__vite__mapDeps([0,1]),import.meta.url),R=k(T,"walletLimits",p);await C(R,N,{merge:!0}),console.log("âœ… ØªÙ… Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©")}}}catch(p){console.warn("ÙØ´Ù„ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù:",p)}try{const{ReportsService:p}=await re(async()=>{const{ReportsService:w}=await import("./index-CHyvkdwe.js").then(b=>b.cN);return{ReportsService:w}},__vite__mapDeps([0,1]),import.meta.url);p.removeTransactionEffects(n,t.uid)}catch(p){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù:",p)}x({title:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„ÙŠÙ‡Ø§ ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§Øª"})}catch(h){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† Firebase:",h);let f="ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";h instanceof Error&&(h.message.includes("network")||h.message.includes("offline")?f="Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰":h.message.includes("permission")||h.message.includes("unauthorized")?f="Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©":h.message.includes("not-found")&&(f="Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© Ø£Ùˆ ØªÙ… Ø­Ø°ÙÙ‡Ø§ Ù…Ø³Ø¨Ù‚Ø§Ù‹")),x({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù",description:f,variant:"destructive"})}},Xr=a=>{const n=(a.type||"").toLowerCase(),o=(a.txnType||"").toLowerCase();return n==="withdraw"||n==="withdrawal"||n==="receive"||o==="receive"},Zr=a=>{const n=(a.type||"").toLowerCase(),o=(a.txnType||"").toLowerCase();return n==="send"||n==="transfer"||o==="send"},Pu=a=>a.title==="Ø¥ÙŠØµØ§Ù„ Ø³Ø­Ø¨ ÙÙˆØ±ÙŠ",Ou=(a,n)=>{const o=new Date().toDateString();let c=he.filter(b=>{const y=new Date(b.createdAt).toDateString()===o,N=String(b.status||"").toLowerCase();return y&&(N==="completed"||N==="confirmed"||N==="pending")});ba&&ba.trim()!==""&&(c=c.filter(b=>b.senderPhone&&b.senderPhone.includes(ba)||b.receiverPhone&&b.receiverPhone.includes(ba)));const u=Ot.filterVisibleTransactions(c,"daily",t==null?void 0:t.uid),h=u.length,f=u.reduce((b,y)=>b+y.amount,0),p=u.filter(Xr).reduce((b,y)=>{const N=y.withdrawnAmount!==void 0?y.withdrawnAmount:y.amount;return b+N},0),w=u.filter(b=>Zr(b)&&!Pu(b)).reduce((b,y)=>{const N=y.sentAmount!==void 0?y.sentAmount:y.amount;return b+N},0);return{totalTransactions:h,totalAmount:f,totalWithdrawn:p,totalSent:w}},bg=a=>{const n=new Date().getMonth(),o=new Date().getFullYear();let c=he.filter(b=>{const y=new Date(b.createdAt);return y.getMonth()===n&&y.getFullYear()===o&&b.status==="completed"});ba&&ba.trim()!==""&&(c=c.filter(b=>b.senderPhone&&b.senderPhone.includes(ba)||b.receiverPhone&&b.receiverPhone.includes(ba)));const u=Ot.filterVisibleTransactions(c,"monthly",t==null?void 0:t.uid),h=u.length,f=u.reduce((b,y)=>b+y.amount,0),p=u.filter(Xr).reduce((b,y)=>{const N=y.withdrawnAmount!==void 0?y.withdrawnAmount:y.amount;return b+N},0),w=u.filter(b=>Zr(b)&&!Pu(b)).reduce((b,y)=>{const N=y.sentAmount!==void 0?y.sentAmount:y.amount;return b+N},0);return{totalTransactions:h,totalAmount:f,totalWithdrawn:p,totalSent:w}},vg=a=>{const n=new Date().getMonth(),o=new Date().getFullYear(),c=he.filter(f=>{const p=new Date(f.createdAt);return p.getMonth()===n&&p.getFullYear()===o&&f.status==="completed"&&f.fromWallet===a}),u=c.filter(Xr).reduce((f,p)=>{const w=p.withdrawnAmount||p.amount;return f+w},0),h=c.filter(Zr).reduce((f,p)=>{const w=p.sentAmount||p.amount;return f+w},0);return{totalWithdrawn:u,totalTransferred:h}},wg=a=>{const n=new Date,o=n.getDate(),c=n.getMonth(),u=n.getFullYear(),h=he.filter(w=>{const b=new Date(w.createdAt);return b.getDate()===o&&b.getMonth()===c&&b.getFullYear()===u&&w.status==="completed"&&w.fromWallet===a}),f=h.filter(Xr).reduce((w,b)=>{const y=b.withdrawnAmount||b.amount;return w+y},0),p=h.filter(Zr).reduce((w,b)=>{const y=b.sentAmount||b.amount;return w+y},0);return{totalWithdrawn:f,totalTransferred:p}},Qs=G.useMemo(()=>bg(),[he,M,ba]),ji=G.useMemo(()=>Ou(),[he,M,ba,t==null?void 0:t.uid]);Qs.totalWithdrawn,Qs.totalSent;const Ea=G.useMemo(()=>vg(M),[he,M]),Ng=G.useMemo(()=>wg(M),[he,M]),Gs=G.useMemo(()=>{try{return JSON.parse(localStorage.getItem(gu())||"[]")}catch{return[]}},[t==null?void 0:t.uid]);d.useEffect(()=>{try{if(!M||J.length===0)return;const a=J.find(C=>C.id===M);if(!a)return;const n=(je==null?void 0:je.monthlyWithdrawLimit)??(a==null?void 0:a.monthlyWithdrawalLimit)??2e5,o=(je==null?void 0:je.monthlyTransferLimit)??(a==null?void 0:a.monthlyTransferLimit)??2e5,c=parseFloat(xt||"0")||0,u=(Ea==null?void 0:Ea.totalWithdrawn)??(je==null?void 0:je.monthlyWithdrawUsed)??0,h=(Ea==null?void 0:Ea.totalTransferred)??(je==null?void 0:je.monthlyTransferUsed)??0,f=u+(B==="withdraw"?c:0),p=h+(B==="transfer"?c:0),w=.85,b=Math.floor(Math.max(n,1)*w),y=Math.floor(Math.max(o,1)*w),N=(()=>{const C=new Date;return`${C.getFullYear()}-${String(C.getMonth()+1).padStart(2,"0")}`})(),k=`monthlyLimitWarnShown:${M}:${N}`;if(f>=b){const C=`${k}:withdraw`;if(!(localStorage.getItem(C)==="true")){od({type:"withdraw",used:f,limit:n,walletName:a.name}),id(!0);try{localStorage.setItem(C,"true")}catch{}return}}if(p>=y){const C=`${k}:transfer`;if(!(localStorage.getItem(C)==="true")){od({type:"transfer",used:p,limit:o,walletName:a.name}),id(!0);try{localStorage.setItem(C,"true")}catch{}return}}}catch{}},[M,J,je,Ea,B,xt]);const Eu=async(a,n=!1)=>{var u,h,f,p;if(os.current)return;if(D&&(S!=null&&S.permissions)){if(B==="transfer"&&S.permissions.transfers===!1){Me(!0);return}if(B==="withdraw"&&S.permissions.withdrawals===!1){Me(!0);return}}const o=B==="withdraw"&&(n||da||!Je);os.current=!0,qa(!0);const c=()=>{B==="transfer"?Us(!1):Mr(!1),os.current=!1,qa(!1)};try{if(gw(),console.log("ðŸ”„ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­ÙˆÙŠÙ„/Ø§Ù„Ø³Ø­Ø¨"),console.log("ðŸ“Š Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:",{senderPhone:Ht,receiverPhone:kt,amount:xt,transactionType:B}),(()=>{B==="transfer"?Us(!0):Mr(!0)})(),!Ht||!xt){console.log("âŒ Ø®Ø·Ø£: Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©"),x({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",description:"ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",variant:"destructive"}),c();return}if(B==="transfer"&&!kt&&!l){console.log("âŒ Ø®Ø·Ø£: Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ù…ÙÙ‚ÙˆØ¯"),x({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",variant:"destructive"}),c();return}if(B==="transfer"&&!l){const z=String(kt||"").replace(/[^0-9Ù -Ù©]/g,"");if(!/[^0-9Ù -Ù©\s]/.test(String(kt||""))&&!pw(kt)){x({title:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ØºÙŠØ± ØµØ§Ù„Ø­",description:"Ø§ÙƒØªØ¨ Ø±Ù‚Ù… ØµØ­ÙŠØ­ Ù…ÙƒÙˆÙ† Ù…Ù† 11 Ø±Ù‚Ù… ÙˆÙŠØ¨Ø¯Ø£ Ø¨Ù€ 015 Ø£Ùˆ 010 Ø£Ùˆ 012 Ø£Ùˆ 011",variant:"destructive"}),c();return}}const b=parseFloat(xt);if(console.log("ðŸ’° Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­ÙˆÙ„:",b),b<=0){console.log("âŒ Ø®Ø·Ø£: Ù…Ø¨Ù„Øº ØºÙŠØ± ØµØ­ÙŠØ­"),x({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø¨Ù„Øº",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"}),c();return}if(De)try{const z=new Date,de=z.getFullYear(),$e=String(z.getMonth()+1).padStart(2,"0"),Qe=String(z.getDate()).padStart(2,"0"),jt=`zeroPlanDailyConfirmCount:${(t==null?void 0:t.uid)||"default"}:${de}-${$e}-${Qe}`,Wt=localStorage.getItem(jt);if((Wt&&parseInt(Wt,10)||0)>=10){x({title:"Ø­Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ",description:"Ø¨Ø§Ù‚Ø© Ø²ÙŠØ±Ùˆ ØªØ³Ù…Ø­ Ø¨Ù€ 10 ØªØ£ÙƒÙŠØ¯Ø§Øª ØªØ­ÙˆÙŠÙ„/Ø³Ø­Ø¨ ÙŠÙˆÙ…ÙŠØ§Ù‹ ÙÙ‚Ø·.",variant:"destructive"}),c();return}}catch(z){console.warn("ÙØ´Ù„ Ù‚Ø±Ø§Ø¡Ø© Ø¹Ø¯Ø§Ø¯ ØªØ£ÙƒÙŠØ¯Ø§Øª Ø¨Ø§Ù‚Ø© Ø²ÙŠØ±Ùˆ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",z)}const y=J.find(z=>z.id===M);if(!y){x({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© ØµØ­ÙŠØ­Ø©",variant:"destructive"}),c();return}const N=Ea;if(console.log("ðŸ“ˆ ÙØ­Øµ Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ù„Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©"),console.log("ðŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ù„Ù„Ù…Ø­ÙØ¸Ø©:",{walletId:M,walletName:y.name,currentWithdrawn:N.totalWithdrawn,currentTransferred:N.totalTransferred,withdrawalLimit:y.monthlyWithdrawalLimit,transferLimit:y.monthlyTransferLimit}),B==="withdraw"){if(console.log("ðŸ§ ÙØ­Øµ Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),console.log(`ðŸ’¸ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨ Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${N.totalWithdrawn}, Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${b}, Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: ${y.monthlyWithdrawalLimit}`),N.totalWithdrawn+b>y.monthlyWithdrawalLimit){console.log("âŒ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),x({title:"ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ",description:`Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø³Ø­Ø¨ Ø£ÙƒØ«Ø± Ù…Ù† ${y.monthlyWithdrawalLimit} Ø¬Ù†ÙŠÙ‡ Ø´Ù‡Ø±ÙŠØ§Ù‹ Ù…Ù† Ù…Ø­ÙØ¸Ø© ${y.name}`,variant:"destructive"}),c();return}}else if(console.log("ðŸ’¸ ÙØ­Øµ Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),console.log(`ðŸ“¤ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${N.totalTransferred}, Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${b}, Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: ${y.monthlyTransferLimit}`),N.totalTransferred+b>y.monthlyTransferLimit){console.log("âŒ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø©"),x({title:"ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø´Ù‡Ø±ÙŠ",description:`Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ­ÙˆÙŠÙ„ Ø£ÙƒØ«Ø± Ù…Ù† ${y.monthlyTransferLimit} Ø¬Ù†ÙŠÙ‡ Ø´Ù‡Ø±ÙŠØ§Ù‹ Ù…Ù† Ù…Ø­ÙØ¸Ø© ${y.name}`,variant:"destructive"}),c();return}const k=(r==null?void 0:r.shopName)||(t==null?void 0:t.displayName)||"Ù…Ø­Ù„ ÙƒØ§Ø´ÙŠ Ù„ÙŠÙ†Ùƒ",C={id:Date.now().toString(),type:B==="transfer"?"send":B==="deposit"?"deposit":"withdraw",senderPhone:Ht,receiverPhone:B==="transfer"?kt:Ht,amount:b,status:"completed",createdAt:new Date,withdrawnAmount:B==="withdraw"?b:void 0,sentAmount:B==="transfer"?b:void 0,depositedAmount:void 0,fromWallet:M,senderNumber:Ht,senderName:B==="withdraw"&&Cr.trim()!==""?Cr.trim():void 0,shopName:(y==null?void 0:y.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",transferredAmount:B==="transfer"?b:void 0,receiverNumber:B==="transfer"?kt:void 0,withdrawnAmountDetailed:B==="withdraw"?b:void 0,depositedAmountDetailed:void 0,merchantShopName:k,transactionReference:`TXN-${Date.now()}`,commission:0,notes:B==="transfer"?void 0:us&&us.trim()!==""?us.trim():void 0};Dr(C.id),D&&(S!=null&&S.name||S!=null&&S.username)&&(C.cashierName=(S==null?void 0:S.name)||(S==null?void 0:S.username));const T=nr.validateTransaction(b,B,qe,Se);if(!T.isValid){x({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",description:T.error,variant:"destructive"}),c();return}T.warning&&x({title:"ØªØ­Ø°ÙŠØ±",description:T.warning,variant:"destructive"});let R;if(B==="transfer")if((y==null?void 0:y.defaultTransferCommission)!=null){const z=Number(y.defaultTransferCommission)||0;R=Math.round(z*b/1e3*100)/100}else Ct&&Ct.trim()!==""?R=Math.max(0,parseFloat(Ct)):R=0;else if((y==null?void 0:y.defaultWithdrawCommission)!=null){const z=Number(y.defaultWithdrawCommission)||0;R=Math.round(z*b/1e3*100)/100}else dt&&dt.trim()!==""?R=Math.max(0,parseFloat(dt)):R=Math.round(b*.01*100)/100;if(C.commission=R,B!=="transfer"&&!Je&&R>=b){x({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©",description:"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø£ÙƒØ¨Ø± Ù…Ù† Ø£Ùˆ ØªØ³Ø§ÙˆÙŠ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯Ø®Ù„",variant:"destructive"}),c();return}const _=B==="transfer"?b:o?Math.round((b-R)*100)/100:b;B==="withdraw"&&wd(o?`Ø³Ù„Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„: ${_} Ø¬Ù†ÙŠÙ‡`:null),C.amount=o?b:_,C.withdrawnAmount=B==="withdraw"?o?b:_:void 0,C.sentAmount=B==="transfer"?_:void 0,C.transferredAmount=B==="transfer"?_:void 0,C.withdrawnAmountDetailed=B==="withdraw"?o?b:_:void 0;let O;const V=B==="transfer"&&!!ca,le=B==="withdraw"&&!!ca,te=V||le;let Ae=null;const Xe=Ir(Ht||"").replace(/\D/g,""),Ze=Ir(kt||"").replace(/\D/g,""),Oe=B==="transfer"&&(Xe.startsWith("010")&&(Ze.startsWith("011")||Ze.startsWith("012")||Ze.startsWith("015"))||Xe.startsWith("012")&&Ze.startsWith("010")||Xe.startsWith("011")&&Ze.startsWith("010")||Xe.startsWith("015")&&Ze.startsWith("010")),ge=Math.max(0,parseFloat(nd||"0")),et=Math.round(R*100)/100;if(C.commission=et,C.fee=ge,C.totalCharged=B==="transfer"?Number(_)+Number(et)+Number(ge):Je?Number(_)+Number(et):Number(b),B==="transfer"&&!te){const z=Number(Se[M]||0),de=Number(_)+Number(ge);if(z<de){x({title:"Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ØºÙŠØ± ÙƒØ§ÙÙ",description:`Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ ${z} Ù„Ø§ ÙŠÙƒÙÙŠ Ù„Ø®ØµÙ… ${de}`,variant:"destructive"}),c();return}}if(te)if(V){const z=nr.validateTransaction(_,"transfer",qe,Se);if(!z.isValid)O={success:!1,newCashBalance:qe,newWalletBalances:Se,message:z.error||"Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙ Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¤Ø¬Ù„",error:"INSUFFICIENT_WALLET_BALANCE"};else{const de=M||((u=J.find(Te=>Te.isDefault))==null?void 0:u.id)||((h=J[0])==null?void 0:h.id),$e=je??await Ua.getWalletLimits(de),Qe=new Date().toDateString(),jt=he.filter(Te=>Te.type==="send"&&String(Te.status||"").toLowerCase()==="pending"&&Te.fromWallet===de&&new Date(Te.createdAt).toDateString()===Qe).reduce((Te,Tt)=>Te+Number(Tt.sentAmount??Tt.transferredAmount??Tt.amount??0),0),Wt=Number(($e==null?void 0:$e.dailyTransferLimit)??6e4),Zt=Number(($e==null?void 0:$e.dailyTransferUsed)??0);if(Zt+jt+Number(_)>Wt){x({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„ØªØ­ÙˆÙŠÙ„",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø§Ù„ÙŠÙˆÙ…: ${(Wt-Zt-jt).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}const tt=new Date,_t=he.filter(Te=>Te.type==="send"&&String(Te.status||"").toLowerCase()==="pending"&&Te.fromWallet===de&&new Date(Te.createdAt).getMonth()===tt.getMonth()&&new Date(Te.createdAt).getFullYear()===tt.getFullYear()).reduce((Te,Tt)=>Te+Number(Tt.sentAmount??Tt.transferredAmount??Tt.amount??0),0),Lt=Number(($e==null?void 0:$e.monthlyTransferLimit)??2e5),Xs=Number(($e==null?void 0:$e.monthlyTransferUsed)??0);if(Xs+_t+Number(_)>Lt){x({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„ØªØ­ÙˆÙŠÙ„",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±: ${(Lt-Xs-_t).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}O={success:!0,newCashBalance:qe,newWalletBalances:Se}}}else{const z=M||((f=J.find(Te=>Te.isDefault))==null?void 0:f.id)||((p=J[0])==null?void 0:p.id),de=je??await Ua.getWalletLimits(z),$e=new Date().toDateString(),Qe=he.filter(Te=>Te.type==="withdraw"&&String(Te.status||"").toLowerCase()==="pending"&&Te.fromWallet===z&&new Date(Te.createdAt).toDateString()===$e).reduce((Te,Tt)=>Te+Number(Tt.withdrawnAmount??Tt.amount??0),0),jt=Number((de==null?void 0:de.dailyWithdrawLimit)??1e5),Wt=Number((de==null?void 0:de.dailyWithdrawUsed)??0);if(Wt+Qe+Number(_)>jt){x({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø³Ø­Ø¨",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø§Ù„ÙŠÙˆÙ…: ${(jt-Wt-Qe).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}const Zt=new Date,tt=he.filter(Te=>Te.type==="withdraw"&&String(Te.status||"").toLowerCase()==="pending"&&Te.fromWallet===z&&new Date(Te.createdAt).getMonth()===Zt.getMonth()&&new Date(Te.createdAt).getFullYear()===Zt.getFullYear()).reduce((Te,Tt)=>Te+Number(Tt.withdrawnAmount??Tt.amount??0),0),_t=Number((de==null?void 0:de.monthlyWithdrawLimit)??2e5),Lt=Number((de==null?void 0:de.monthlyWithdrawUsed)??0);if(Lt+tt+Number(_)>_t){x({title:"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ø³Ø­Ø¨",description:`Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±: ${(_t-Lt-tt).toLocaleString()} Ø¬.Ù…`,variant:"destructive"}),c();return}O={success:!0,newCashBalance:Math.round((Number(qe)-Number(_))*100)/100,newWalletBalances:Se}}else B==="transfer"?O=await nr.processTransfer({amount:_,currentCashBalance:qe,currentWalletBalances:Se,wallets:J,selectedWalletId:M,skipRemoteLimitsCheck:!1,nonBlockingUsageUpdate:!0}):O=await nr.processWithdraw({amount:_,currentCashBalance:qe,currentWalletBalances:Se,wallets:J,selectedWalletId:M,skipRemoteLimitsCheck:!1,nonBlockingUsageUpdate:!0});if(!O.success){x({title:"ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",description:O.error||O.message,variant:"destructive"}),c();return}let ht=te?le?O.newCashBalance:qe:O.newCashBalance,lt=te?Se:O.newWalletBalances;if(!te&&o&&B==="withdraw"){const z=M,de=Number(lt[z]||0);lt={...lt,[z]:Math.round((de+R)*100)/100}}if(!te&&B==="transfer"&&ge>0){const z=Number(lt[M]||0);lt={...lt,[M]:Math.round((z-Number(ge))*100)/100}}if(te&&V){const z=J.find(Qe=>Qe.id===M)??J.find(Qe=>Qe.isDefault)??J[0],de=(z==null?void 0:z.id)||M;if(de!==M)try{Gr(de)}catch{}const $e=Number(Se[de]||0);lt={...Se,[de]:Math.round(($e-Number(_)-Number(ge))*100)/100}}if((V||le)&&ca&&!f0){const z={id:`DEBT-${Date.now()}`,debtorName:ca.debtorName,amount:ca.amount,reason:ca.notes||"",customerId:ca.customerId,mobile:ca.mobile,status:"pending",createdAt:new Date};Ae=z.id,C.linkedDebtId=Ae;const de=[z,...Re];zt(de);try{if(await Oa(de),t!=null&&t.uid){const $e=Pe($,"debts",z.id),Qe={...z,userId:t.uid,shopId:j||(r==null?void 0:r.shopId)||null,lastUpdated:new Date().toISOString()};Object.keys(Qe).forEach(jt=>Qe[jt]===void 0&&delete Qe[jt]),await sa($e,Qe,{merge:!0})}}catch($e){console.error("âš ï¸ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¯ÙŠÙ† Ø§Ù„Ù…Ø¤Ø¬Ù„ Ù…Ø­Ù„ÙŠØ§Ù‹ Ø£Ùˆ Ø³Ø­Ø§Ø¨ÙŠØ§Ù‹:",$e)}x({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙŠÙ†",description:"Ø£Ø¶ÙŠÙ Ø¥Ù„Ù‰ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ† Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ù„Ø³Ø¯Ø§Ø¯",variant:"default"})}if(!te&&!o){const z=Math.max(0,Number(R))+Math.max(0,Number(ge));z>0&&(ht=Math.round((ht+z)*100)/100,console.log(`ðŸ’° ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙˆÙ„Ø©/Ø±Ø³ÙˆÙ… ${z} Ø¬Ù†ÙŠÙ‡ Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©`))}console.log("âš¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙÙˆØ±Ø§Ù‹ Ø¨Ø¯ÙˆÙ† Ø­Ø¬Ø¨ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… startTransition...");const na="temp_"+Date.now()+"_"+Math.random().toString(36).substring(7),It={reference:na,shopId:j||(r==null?void 0:r.shopId)||(t==null?void 0:t.uid)||"default-shop",lineId:M||"default-line",walletId:M||void 0,merchantUserId:(t==null?void 0:t.uid)||null,provider:"vodafone_cash",txnType:B==="transfer"?"send":"receive",originType:B==="transfer"?"transfer":"withdraw",amount:o?b:_,commission:et,fee:ge,profit:0,senderMsisdn:Ht,receiverMsisdn:B==="transfer"?kt:Ht,note:B==="transfer"?void 0:us&&us.trim()!==""?us.trim():void 0,status:te?"pending":"confirmed",linkedDebtId:Ae||void 0,createdBy:(t==null?void 0:t.uid)||null,walletEffectAppliedOnCreation:!1,cashEffectAppliedOnCreation:!!(te&&le),limitsReservedOnCreation:!!te,limitReservedType:B==="transfer"?"transfer":"withdraw",profitAddedOnCreation:!1},ze={...It,id:na,status:te?"pending":"completed",commissionMode:B==="transfer"||Je?"add":"deduct",totalCharged:B==="transfer"?_+et+ge:Je?_+R:b,walletEffectAppliedOnCreation:!1,cashEffectAppliedOnCreation:!!(te&&le),limitsReservedOnCreation:!!te,limitReservedType:B==="transfer"?"transfer":"withdraw",sentAmount:B==="transfer"?_:void 0,transferredAmount:B==="transfer"?_:void 0,withdrawnAmount:B==="withdraw"?o?b:_:void 0,senderName:B==="withdraw"&&Cr.trim()!==""?Cr.trim():void 0,createdAt:new Date,type:B==="transfer"?"send":"withdraw",senderPhone:Ht||"",receiverPhone:kt||""};try{Ta.current=[ze,...Ta.current],E.setQueryData(["recentTransactions",t==null?void 0:t.uid,j||"main"],z=>!z||!Array.isArray(z)?[ze]:[ze,...z])}catch(z){console.error("Error in optimistic update:",z)}if(M&&je)try{const z=B==="transfer",de={...je};z?(de.dailyTransferUsed=(de.dailyTransferUsed||0)+_,de.monthlyTransferUsed=(de.monthlyTransferUsed||0)+_):(de.dailyWithdrawUsed=(de.dailyWithdrawUsed||0)+_,de.monthlyWithdrawUsed=(de.monthlyWithdrawUsed||0)+_),Hs(de)}catch(z){console.error("Error in optimistic limit update:",z)}const ha=[ze,...he];G.startTransition(()=>{ot(ht),mt(lt),te&&(C.status="pending"),qt(ha),o&&!te&&x({title:"ØªÙ… Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡",description:`Ø³Ù„Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„: ${_} Ø¬Ù†ÙŠÙ‡`,variant:"default",duration:5e3})});try{setTimeout(()=>{try{localStorage.setItem(bl(),JSON.stringify(ha))}catch{}},0)}catch{}if(De)try{const z=new Date,de=z.getFullYear(),$e=String(z.getMonth()+1).padStart(2,"0"),Qe=String(z.getDate()).padStart(2,"0"),jt=`zeroPlanDailyConfirmCount:${(t==null?void 0:t.uid)||"default"}:${de}-${$e}-${Qe}`,Wt=localStorage.getItem(jt),Zt=Wt&&parseInt(Wt,10)||0;localStorage.setItem(jt,String(Zt+1))}catch{}setTimeout(()=>{try{const z=new Date().toISOString();localStorage.setItem(Ye(),ht.toString()),localStorage.setItem(Ye()+"_lastUpdated",z),localStorage.setItem(Ge(),JSON.stringify(lt)),localStorage.setItem(Ge()+"_lastUpdated",z)}catch{}},0);try{if(t!=null&&t.uid){const z=J.find(Zs=>Zs.id===M)??J.find(Zs=>Zs.isDefault)??J[0],de=(z==null?void 0:z.id)||M,$e=Number(lt[de]||0),Qe=String((z==null?void 0:z.phone)||Ht||"").trim(),jt=String(kt||"").trim(),Wt=Number(ge)>0,Zt=B==="transfer"?"ðŸŸ¢":"ðŸ”´",tt=Number(et)>0?`${Number(et)} Ø¬Ù†ÙŠÙ‡`:"0 Ø¬Ù†ÙŠÙ‡",_t=Wt?` Ùˆ Ø±Ø³ÙˆÙ… ${Number(ge)} Ø¬Ù†ÙŠÙ‡`:"",Lt=B==="transfer"?`${Zt} ØªÙ… ØªØ­ÙˆÙŠÙ„ Ù…Ø¨Ù„Øº ${Number(_)} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${Qe} Ø¥Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${jt} ÙˆØªÙ… Ø£Ø®Ø° Ø¹Ù…ÙˆÙ„Ø© ${tt}${_t}. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${$e} Ø¬Ù†ÙŠÙ‡. Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${Number(ht)} Ø¬Ù†ÙŠÙ‡.`:`${Zt} ØªÙ… Ø§Ù„Ø³Ø­Ø¨ Ù…Ø¨Ù„Øº ${Number(_)} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø§Ù„Ø¯Ø±Ø¬ Ø¥Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© ${Qe} ÙˆØªÙ… Ø£Ø®Ø° Ø¹Ù…ÙˆÙ„Ø© ${tt}${_t}. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${$e} Ø¬Ù†ÙŠÙ‡. Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${Number(ht)} Ø¬Ù†ÙŠÙ‡.`,Xs=t!=null&&t.uid?`tg_last_msg_${t.uid}`:"tg_last_msg",Te=Date.now();let Tt=!0;try{const Zs=localStorage.getItem(Xs);if(Zs){const er=JSON.parse(Zs),Ag=String((er==null?void 0:er.text)||""),Tg=Number((er==null?void 0:er.at)||0);Ag===Lt&&Te-Tg<5e3&&(Tt=!1)}}catch{}if(Tt){Promise.resolve(vs.send(t.uid,Lt)).catch(()=>{});try{localStorage.setItem(Xs,JSON.stringify({text:Lt,at:Te}))}catch{}}}}catch{}if((async()=>{try{console.log("ðŸ”„ Ø¨Ø¯Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Firebase ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©...");const z={...It},de={...ze},{ProfitService:$e}=await re(async()=>{const{ProfitService:tt}=await import("./profitService-Bwtuj4RF.js");return{ProfitService:tt}},__vite__mapDeps([48,0,1]),import.meta.url),Qe=$e.calculateProfitFromTransaction({...de,status:"confirmed"});Qe>0&&($e.addProfit(Qe,t==null?void 0:t.uid),z.profitAddedOnCreation=!0,de.profitAddedOnCreation=!0,console.log("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø¨Ø­:",Qe,"Ø¬Ù†ÙŠÙ‡"));const jt=await gp.create(z);if(M)try{const tt=await Ua.updateUsage(M,_,B==="transfer"?"transfer":"withdraw");tt&&Hs(tt);try{window.dispatchEvent(new CustomEvent("walletLimitsUpdated",{detail:{walletId:M}}))}catch{}}catch{}await Promise.all([...t!=null&&t.uid?[oe.updateUserData(t.uid,{cashBalance:ht,walletBalances:lt,lastUpdated:new Date().toISOString()})]:[],...t!=null&&t.uid?[oe.saveUserTransaction(t.uid,{...de,transactionId:jt,transactionType:B,fromWallet:M,toWallet:B==="transfer"?V?null:"cash":null,cashierName:D&&((S==null?void 0:S.name)||(S==null?void 0:S.username))||"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",linkedDebtId:Ae||void 0,description:`${B==="transfer"?"ØªØ­ÙˆÙŠÙ„":"Ø³Ø­Ø¨"} ${_} Ù…Ù† ${M} ${B==="transfer"?V?"":"Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ":""} â€” Ø¹Ù…ÙˆÙ„Ø©: ${R} (${B==="transfer"||Je?"Ù…Ø¶Ø§ÙØ©":"Ù…Ø®ØµÙˆÙ…Ø©"})${ge>0?` â€” Ø±Ø³ÙˆÙ…: ${ge}`:""}${te?" â€” Ø¯ÙŠÙ† Ù…Ø¤Ø¬Ù„ (Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©)":""}`})]:[]]),console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­");try{const tt={...ze,id:jt};Ta.current=Ta.current.map(_t=>_t.id===na?tt:_t),E.setQueryData(["recentTransactions",t==null?void 0:t.uid,j||"main"],_t=>!_t||!Array.isArray(_t)?[tt]:_t.map(Lt=>Lt.id===na?tt:Lt)),G.startTransition(()=>{qt(_t=>_t.map(Lt=>Lt.id===na?tt:Lt))})}catch(tt){console.error("Error updating query cache with real ID:",tt)}setTimeout(()=>{try{console.log("ðŸ”„ ØªÙ†ÙÙŠØ° Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ø¬Ù„ (10 Ø«ÙˆØ§Ù†ÙŠ) Ù„Ø¶Ù…Ø§Ù† ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª..."),E.invalidateQueries({queryKey:["recentTransactions",t==null?void 0:t.uid,j||"main"]}),E.invalidateQueries({queryKey:["dashboardData",j||(r==null?void 0:r.shopId)]}),M&&(E.invalidateQueries({queryKey:["walletLimits",M]}),Al())}catch(tt){console.error("Error in delayed refresh:",tt)}},1e4);const Wt=`userData_${t==null?void 0:t.uid}`,Zt={cashBalance:ht,walletBalances:lt,lastUpdated:new Date().toISOString()};localStorage.setItem(Wt,JSON.stringify(Zt))}catch(z){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙÙŠ Firebase (ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©):",z);try{t!=null&&t.uid&&oe.saveLocalReceipt(t.uid,{...transactionDataForUser,transactionType:B,fromWallet:M,toWallet:B==="transfer"?V?null:"cash":null,cashierName:D&&((S==null?void 0:S.name)||(S==null?void 0:S.username))||"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",linkedDebtId:Ae||void 0,description:`${B==="transfer"?"ØªØ­ÙˆÙŠÙ„":"Ø³Ø­Ø¨"} ${_} Ù…Ù† ${M} ${B==="transfer"?V?"":"Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ":""} â€” Ø¹Ù…ÙˆÙ„Ø©: ${R} (${B==="transfer"||Je?"Ù…Ø¶Ø§ÙØ©":"Ù…Ø®ØµÙˆÙ…Ø©"})${ge>0?` â€” Ø±Ø³ÙˆÙ…: ${ge}`:""}${te?" â€” Ø¯ÙŠÙ† Ù…Ø¤Ø¬Ù„ (Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©)":""}`})}catch{}x({title:"ØªØ­Ø°ÙŠØ±",description:"ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ù„ÙƒÙ† ÙØ´Ù„Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…. Ø³ØªØªÙ… Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.",variant:"destructive"})}})(),B==="transfer"){Us(!0);const z=Number(b)+Number(R)+Math.max(0,Number(ge));Mo({type:"transfer",amount:Math.max(0,Math.round(z*100)/100)}),G0({receiver:kt,amount:b}),to(null),ua(!0),setTimeout(()=>{Us(!1)},2e3)}else Mr(!0),Mo({type:"withdraw",amount:_,isDeduct:o}),ua(!0),setTimeout(()=>{Mr(!1)},2e3);kr(""),Ws(""),Eo(!1),Xc(""),Zc(""),xo(null),go(""),ms(""),td(""),ad(!1),setTimeout(()=>{os.current=!1,qa(!1)},1500)}catch(w){console.error("CRITICAL ERROR IN TRANSACTION:",w),x({title:"Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"}),c()}},en=G.useMemo(()=>new Intl.DateTimeFormat("ar-EG"),[]),Mu=G.useMemo(()=>new Intl.DateTimeFormat("ar-EG",{hour:"2-digit",minute:"2-digit"}),[]),Ru=G.useMemo(()=>{try{return Re.reduce((a,n)=>{const o=Number(n.paidAmount||0),c=Math.max(0,Number(n.amount||0)-o);return n.type==="debtor"?a.debtor+=c:a.creditor+=c,a},{creditor:0,debtor:0})}catch{return{creditor:0,debtor:0}}},[Re]),Ol=G.useMemo(()=>{const a=Cu(),n=new Set;return a.filter(c=>!c||!c.id||n.has(c.id)?!1:(n.add(c.id),!0)).filter(c=>Qt==="all"?!0:Qt==="send"?c.type==="send":Qt==="receive"?c.type==="receive":Qt==="withdraw"?c.type==="withdraw":Qt==="deferred"?c.status==="pending":Qt==="wallet"?c.fromWallet===M:Qt!=="deleted")},[Cu,Qt,M]),jg=()=>{if(_o==="daily"){const a=Ot.resetReportsManually("daily",he,t==null?void 0:t.uid);Pr(!1),x({title:"ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©",description:`ØªÙ… Ø¥Ø®ÙØ§Ø¡ ${a.length} Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… (Ø§Ù„Ø­Ø¯ÙˆØ¯ Ù„Ù… ØªØªØ£Ø«Ø±)`})}else{const a=Ot.resetReportsManually("monthly",he,t==null?void 0:t.uid);Pr(!1),x({title:"ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",description:`ØªÙ… Ø¥Ø®ÙØ§Ø¡ ${a.length} Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ù† ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± (Ø§Ù„Ø­Ø¯ÙˆØ¯ Ù„Ù… ØªØªØ£Ø«Ø±)`})}},Sg=()=>_o==="daily"?"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©":"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",Dg=()=>_o==="daily"?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªØµÙÙŠØ± ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¥Ø®ÙØ§Ø¡ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ… Ù…Ù† Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±":"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªØµÙÙŠØ± ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¥Ø®ÙØ§Ø¡ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø± Ù…Ù† Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±",kg=a=>{pu(a),ll(!0)},Cg=a=>{const n=qe,o=Number(a)-Number(n);ot(a);const c=new Date().toISOString();localStorage.setItem(Ye(),a.toString()),localStorage.setItem(Ye()+"_lastUpdated",c),su(!1);const u={cashBalance:a,lastUpdated:c},h=`userData_${t==null?void 0:t.uid}`;try{localStorage.setItem(h,JSON.stringify(u))}catch{}const f=[];if(t!=null&&t.uid){f.push(oe.updateUserData(t.uid,u).then(()=>{try{localStorage.removeItem(h)}catch{}}).catch(()=>{}));const p=`${o>0?"CASHADD":"CASHDEDUCT"}-${(t==null?void 0:t.uid)||"anon"}-${Date.now()}`,w=o>0?{txnType:"cash_addition",type:"cash_addition",amount:o,status:"confirmed",senderMsisdn:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",receiverMsisdn:"",reference:p,title:"Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",merchantUserId:t.uid,createdBy:t.uid,shopId:(r==null?void 0:r.shopId)||void 0}:o<0?{amount:Math.abs(o),status:"completed",title:"Ø§ÙŠØµØ§Ù„ Ø®ØµÙ… Ù…Ù† Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠÙ‡",merchantUserId:t.uid,createdBy:t.uid,shopId:(r==null?void 0:r.shopId)||void 0}:null;w&&f.push(oe.saveUserTransaction(t.uid,w));const b=r==null?void 0:r.shopId;if(b){const y=Pe($,"dashboardData",b);f.push(ea(y,{cashBalance:a}))}}Promise.allSettled(f).then(()=>{}).catch(()=>{}),x({title:o>0?"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©":o<0?"ØªÙ… Ø®ØµÙ… Ù†Ù‚Ø¯ÙŠØ©":"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ",description:o!==0?`Ø§Ù„ØªØºÙŠÙŠØ±: ${Math.abs(o)} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${a} Ø¬Ù†ÙŠÙ‡`:`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø¥Ù„Ù‰ ${a} Ø¬Ù†ÙŠÙ‡`})},Ig=async a=>{var f;if(!Yt){console.warn("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù Ù…Ø­ÙØ¸Ø© Ù…Ø­Ø¯Ø¯ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±ØµÙŠØ¯");return}const n={...Se,[Yt]:a};mt(n);const o=new Date().toISOString(),c={walletBalances:n,lastUpdated:o},u=`userData_${t==null?void 0:t.uid}`;try{localStorage.setItem(u,JSON.stringify(c)),localStorage.setItem(Ge(),JSON.stringify(n)),localStorage.setItem(Ge()+"_lastUpdated",o),localStorage.setItem(`walletBalances_backup_${o}`,JSON.stringify(n))}catch{}try{t!=null&&t.uid&&await oe.updateUserData(t.uid,c)}catch(p){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙÙŠ Firebase:",p)}ru(!1);const h=((f=J.find(p=>p.id===Yt))==null?void 0:f.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©";x({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ ${h} Ø¥Ù„Ù‰ ${a.toLocaleString()} Ø¬Ù†ÙŠÙ‡`})},_g=async a=>{var n;if(console.log("ðŸ’° Ø¨Ø¯Ø¡ ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©"),console.log("ðŸ“Š Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø­Ø±Ø±Ø©:",Yt),console.log("ðŸ’µ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¶Ø§Ù/Ø§Ù„Ù…Ø®ØµÙˆÙ…:",a),Yt){const o=Se[Yt]||0;console.log("ðŸ’° Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ:",o);const c=o+a;console.log("ðŸ’° Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯:",c);const u={...Se,[Yt]:c};console.log("ðŸ“Š Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø©:",u),mt(u);const h=new Date().toISOString(),f={walletBalances:u,lastUpdated:h},p=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(p,JSON.stringify(f)),localStorage.setItem(Ge(),JSON.stringify(u)),localStorage.setItem(`walletBalances_backup_${h}`,JSON.stringify(u));try{if(t!=null&&t.uid){console.log("ðŸ”„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase...");try{await oe.updateUserData(t.uid,f),console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­"),setTimeout(()=>{localStorage.removeItem(p),console.log("ðŸ§¹ ØªÙ… Ø­Ø°Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ø§Ù„Ù…Ø¤Ù‚ØªØ© Ø¨Ø¹Ø¯ Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©")},6e4)}catch(N){console.error("âŒ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase:",N),ve(!0)}}else console.log("âš ï¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ØŒ Ø­ÙØ¸ ÙÙŠ localStorage"),localStorage.setItem(Ge(),JSON.stringify(u));const w=((n=J.find(N=>N.id===Yt))==null?void 0:n.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©",b=a>0?"Ø¥Ø¶Ø§ÙØ©":"Ø®ØµÙ…",y=Math.abs(a);x({title:`ØªÙ… ${b} Ù…Ø¨Ù„Øº ${b==="Ø¥Ø¶Ø§ÙØ©"?"Ø¥Ù„Ù‰":"Ù…Ù†"} Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©`,description:`ØªÙ… ${b} ${y} Ø¬Ù†ÙŠÙ‡ ${b==="Ø¥Ø¶Ø§ÙØ©"?"Ø¥Ù„Ù‰":"Ù…Ù†"} Ø±ØµÙŠØ¯ ${w}. Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${c.toLocaleString()} Ø¬Ù†ÙŠÙ‡`})}catch(w){if(console.error("âŒ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase:",w),localStorage.setItem(Ge(),JSON.stringify(u)),t!=null&&t.uid){const b=`userData_${t.uid}`,y={walletBalances:u,lastUpdated:new Date().toISOString()};localStorage.setItem(b,JSON.stringify(y)),ve(!0)}x({title:"ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹",description:"ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹ ÙˆØ³ÙŠØªÙ… Ù…Ø²Ø§Ù…Ù†ØªÙ‡Ø§ Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ø§Ø­Ù‚Ø§Ù‹",variant:"default"})}}else console.log("âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù Ù…Ø­ÙØ¸Ø© Ù„Ù„ØªØ­Ø±ÙŠØ±");setTimeout(()=>{const c=Object.keys(localStorage).filter(u=>u.startsWith("walletBalances_backup_")).sort();c.length>5&&c.slice(0,c.length-5).forEach(h=>{localStorage.removeItem(h),console.log("ðŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©:",h)})},5e3),ll(!1),pu("")};return console.log("ðŸ”¥ UserDashboardPage - Render conditions:",{isCheckingActivation:ao,isUserActive:yr,showActivationModal:o0}),ao?(console.log("ðŸ”¥ UserDashboardPage - Showing loading screen"),e.jsx(tp,{})):(console.log("ðŸ”¥ UserDashboardPage - Rendering main dashboard"),e.jsxs("div",{id:"dashboard-content-container",className:"user-dashboard h-[100dvh] overflow-y-auto px-2 sm:px-4 pt-2 sm:py-4 relative bg-gray-100 bg-[radial-gradient(140%_140%_at_10%_10%,#e5e7eb_0%,#d1d5db_45%,#9ca3af_100%)] no-scrollbar",children:[qs&&e.jsx("div",{className:"fixed inset-0 z-[99999] pointer-events-none bg-orange-300/30 mix-blend-multiply",style:{pointerEvents:"none"}}),e.jsx(Uw,{userId:t==null?void 0:t.uid}),e.jsxs("div",{className:"max-w-screen-2xl mx-auto grid grid-cols-1 xl:grid-cols-3 gap-4 xl:gap-6 relative z-10",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-2 sm:gap-3 fade-in-up",children:[!Br&&e.jsxs(Za,{className:"bg-gray-100 dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 relative overflow-hidden",children:[e.jsx(ws,{className:"pb-2 px-3 pt-3 relative z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ns,{className:"text-sm font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded-md bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700",children:e.jsx(dm,{className:"h-4 w-4 text-gray-700 dark:text-gray-300"})}),e.jsx("span",{className:"text-sm",children:"Ø§Ù„Ø´Ù‡Ø±"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>{gd("monthly"),Pr(!0)},className:"h-8 w-8 p-0 bg-transparent hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 rounded-full transition-colors duration-200",title:"ØªØµÙÙŠØ± Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø±",children:e.jsx(Na,{className:"h-3.5 w-3.5"})}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>ko(!0),className:"h-8 w-8 p-0 bg-transparent hover:bg-purple-50 dark:hover:bg-purple-900/20 text-purple-600 hover:text-purple-700 dark:text-purple-400 dark:hover:text-purple-300 rounded-full transition-colors duration-200",title:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± ÙŠÙˆÙ…/Ø´Ù‡Ø± Ù…Ø­Ø¯Ø¯",children:e.jsx(Ti,{className:"h-3.5 w-3.5"})}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>ko(!0),className:"h-8 w-8 p-0 bg-transparent hover:bg-blue-50 dark:hover:bg-blue-900/20 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 rounded-full transition-colors duration-200",title:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",children:e.jsx(Si,{className:"h-3.5 w-3.5"})}),e.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900/20 rounded-full border border-green-100 dark:border-green-900/30",children:e.jsx(sn,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})})]})]})}),!Br&&e.jsxs(es,{className:"pt-0 px-2 pb-2",children:[e.jsxs("div",{className:`grid grid-cols-2 gap-0 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-800 divide-x divide-y divide-gray-200 dark:divide-gray-800 bg-white dark:bg-gray-900 ${Id?"blur-sm select-none":""}`,children:[e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-blue-600 dark:text-blue-400",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-blue-800 dark:text-blue-300 mt-0.5 sm:mt-0",children:Qs.totalTransactions})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø§Ø¬Ù…Ø§Ù„ÙŠ"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-gray-900 dark:text-gray-100 mt-0.5 sm:mt-0",children:Qs.totalAmount.toFixed(2)})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-red-600 dark:text-red-400",children:"Ø§Ù„Ù…Ø³Ø­ÙˆØ¨"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-red-800 dark:text-red-300 mt-0.5 sm:mt-0",children:Qs.totalWithdrawn.toFixed(2)})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-green-600 dark:text-green-400",children:"Ø§Ù„Ù…Ø±Ø³Ù„"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-green-800 dark:text-green-300 mt-0.5 sm:mt-0",children:Qs.totalSent.toFixed(2)})]})]}),e.jsxs("div",{className:"mt-2 rounded-lg border border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900 px-2 py-1.5 flex items-center justify-between",children:[e.jsx("span",{className:"text-[12px] font-bold text-yellow-600 dark:text-yellow-400",children:"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),e.jsx(Gv,{userId:t==null?void 0:t.uid,transactions:he})]})]}),Id&&e.jsx("div",{className:"absolute inset-0 z-20 backdrop-blur-sm bg-white/60 dark:bg-black/60 flex items-center justify-center p-0 pointer-events-auto",children:e.jsxs(I,{size:"sm",variant:"ghost",onClick:async()=>{if(De){x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}Vn(!0)},className:"px-4 py-2 rounded-full bg-white dark:bg-card border border-gray-100 dark:border-gray-800 text-gray-900 dark:text-gray-100 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-800 hover:shadow-md transition-all duration-200 flex items-center gap-2 text-xs font-medium",title:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± (ÙŠØªØ·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ)",children:[e.jsx("span",{children:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±"}),e.jsx(or,{className:"h-3.5 w-3.5 text-gray-600 dark:text-gray-400"})]})})]}),e.jsx(ia,{open:mf,onOpenChange:Vn,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±",description:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø± Ø¥Ù„Ø§ Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",onSuccess:()=>{if(De){x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø± ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}),Vn(!1),Un(!0);return}Un(!1),Vn(!1)},userId:t==null?void 0:t.uid,userRole:r==null?void 0:r.role}),(Mt==null?void 0:Mt.planType)!==ta.TAHWEELA&&e.jsxs(Za,{className:"bg-gray-50 dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 relative overflow-hidden",children:[e.jsx(ws,{className:"pb-2 px-3 pt-3 relative z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ns,{className:"text-sm font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded-md bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700",children:e.jsx(dm,{className:"h-4 w-4 text-gray-700 dark:text-gray-300"})}),e.jsx("span",{className:"text-sm",children:"Ø§Ù„ÙŠÙˆÙ…"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>{gd("daily"),Pr(!0)},className:"h-8 w-8 p-0 bg-transparent hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 rounded-full transition-colors duration-200",title:"ØªØµÙÙŠØ± Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…",children:e.jsx(Na,{className:"h-3.5 w-3.5"})}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>Ne("https://www.youtube.com/watch?v=MjAFbvhgjYg","Ø´Ø±Ø­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…"),className:"h-8 w-8 p-0 bg-transparent hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 rounded-full transition-colors duration-200",title:"Ø´Ø±Ø­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…",children:e.jsx(ax,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>uf(a=>!a),className:"h-8 w-8 p-0 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 rounded-full transition-colors duration-200",title:Br?"ØªÙˆØ³ÙŠØ¹ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø´Ù‡Ø±":"Ø·ÙŠ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø´Ù‡Ø±",children:Br?e.jsx(_p,{className:"h-3.5 w-3.5"}):e.jsx(Ap,{className:"h-3.5 w-3.5"})}),e.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900/20 rounded-full border border-green-100 dark:border-green-900/30",children:e.jsx(sn,{className:"h-3.5 w-3.5 text-green-600 dark:text-green-400"})})]})]})}),!Br&&e.jsxs(es,{className:"pt-0 px-2 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-0 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-800 divide-x divide-y divide-gray-200 dark:divide-gray-800 bg-white dark:bg-gray-900",children:[e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-blue-600 dark:text-blue-400",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-blue-800 dark:text-blue-300 mt-0.5 sm:mt-0",children:ji.totalTransactions})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø§Ø¬Ù…Ø§Ù„ÙŠ"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-gray-900 dark:text-gray-100 mt-0.5 sm:mt-0",children:ji.totalAmount.toFixed(2)})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-red-600 dark:text-red-400",children:"Ø§Ù„Ù…Ø³Ø­ÙˆØ¨"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-red-800 dark:text-red-300 mt-0.5 sm:mt-0",children:ji.totalWithdrawn.toFixed(2)})]}),e.jsxs("div",{className:"px-2 py-1 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[e.jsx("span",{className:"text-[12px] font-bold text-green-600 dark:text-green-400",children:"Ø§Ù„Ù…Ø±Ø³Ù„"}),e.jsx("span",{className:"text-sm sm:text-lg font-bold text-green-800 dark:text-green-300 mt-0.5 sm:mt-0",children:ji.totalSent.toFixed(2)})]})]}),e.jsxs("div",{className:"mt-2 rounded-lg border border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900 px-2 py-1.5 flex items-center justify-between",children:[e.jsx("span",{className:"text-[12px] font-bold text-yellow-600 dark:text-yellow-400",children:"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),e.jsx(ew,{userId:t==null?void 0:t.uid,transactions:he})]})]}),xf&&e.jsx("div",{className:"absolute inset-0 z-20 backdrop-blur-sm bg-white/60 dark:bg-black/60 flex items-center justify-center p-0 pointer-events-auto",children:e.jsxs(I,{size:"sm",variant:"ghost",onClick:()=>Bo(!0),className:"px-4 py-2 rounded-full bg-white dark:bg-card border border-gray-100 dark:border-gray-800 text-gray-900 dark:text-gray-100 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-800 hover:shadow-md transition-all duration-200 flex items-center gap-2 text-xs font-medium",title:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… (ÙŠØªØ·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ)",children:[e.jsx("span",{children:"Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…"}),e.jsx(or,{className:"h-3.5 w-3.5 text-gray-600 dark:text-gray-400"})]})})]}),e.jsx(ia,{open:yf,onOpenChange:Bo,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…",description:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… Ø¥Ù„Ø§ Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",onSuccess:()=>{Pd(!1),Bo(!1)},userId:t==null?void 0:t.uid})]}),e.jsxs(Za,{className:"balance-bar bg-gray-200 border-2 border-gray-200/50 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 group relative overflow-hidden   transform fade-in-up mb-6",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-500/5 via-blue-500/5 to-emerald-500/5 opacity-0 group-hover:opacity-100 transition-opacity duration-200"}),e.jsx("div",{className:"absolute top-0 left-0 w-40 h-40 bg-gradient-to-br from-emerald-300/10 to-transparent rounded-full -translate-y-20 -translate-x-20 group-hover:scale-150 transition-transform duration-200"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-40 h-40 bg-gradient-to-br from-blue-300/10 to-transparent rounded-full translate-y-20 translate-x-20 group-hover:scale-150 transition-transform duration-200"}),e.jsx(es,{className:"p-2 relative z-10",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[e.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-gray-800 p-1 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 group/cash relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/10 to-transparent opacity-0 group-hover/cash:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"flex flex-col relative z-10 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx("div",{className:"p-0.5 bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/30 dark:to-emerald-800/30 rounded-lg shadow-sm",children:e.jsx($a,{className:"h-1.5 w-1.5 text-emerald-600 dark:text-emerald-400"})}),e.jsx("span",{className:"text-[11px] font-extrabold text-emerald-800 dark:text-emerald-300",children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",onClick:()=>Kr(!0),children:e.jsx(Pt,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-emerald-600 dark:text-emerald-400 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 transition-colors",onClick:()=>yu(!0),title:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©",children:e.jsx(am,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",onClick:()=>bi(!0),children:e.jsx(Na,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-0.5",children:e.jsxs("span",{className:"text-[14px] sm:text-xl font-bold text-emerald-800 dark:text-emerald-200 bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/30 dark:to-emerald-800/30 px-1 py-0.5 rounded-lg shadow-sm block w-fit",children:[qe.toLocaleString("en-US")," Ø¬Ù†ÙŠÙ‡"]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-card border border-gray-200 dark:border-gray-800 p-1 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 group/wallet relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/10 to-transparent opacity-0 group-hover/wallet:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"flex flex-col relative z-10 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx("div",{className:"p-0.5 bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/30 dark:to-blue-800/30 rounded-lg shadow-sm",children:e.jsx(tr,{className:"h-1.5 w-1.5 text-blue-600 dark:text-blue-400"})}),e.jsx("span",{className:"text-[11px] font-extrabold text-blue-800 dark:text-blue-300",children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",onClick:()=>fi(!0),title:"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„ Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©",children:e.jsx(Pt,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",onClick:()=>Io(!0),title:"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø§ÙØ¸",children:e.jsx(tr,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",onClick:()=>{xi(!0),yi("")},title:"ØªØµÙÙŠØ± Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©",children:e.jsx(Na,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-0.5",children:e.jsxs("span",{className:"text-[14px] sm:text-xl font-bold text-blue-800 dark:text-blue-200 bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/30 dark:to-blue-800/30 px-1 py-0.5 rounded-lg shadow-sm block w-fit",children:[J.reduce((a,n)=>a+(Number(Se[n.id])||0),0).toLocaleString("en-US")," Ø¬Ù†ÙŠÙ‡"]})})]})]}),e.jsxs("div",{className:"col-span-2 sm:col-span-1 bg-white dark:bg-card border border-gray-200 dark:border-gray-800 p-1 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 group/selwallet relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-transparent opacity-0 group-hover/selwallet:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"flex flex-col relative z-10 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx("div",{className:"p-0.5 bg-gradient-to-r from-indigo-100 to-indigo-200 dark:from-indigo-900/30 dark:to-indigo-800/30 rounded-lg shadow-sm",children:e.jsx(tr,{className:"h-1.5 w-1.5 text-indigo-600 dark:text-indigo-400"})}),e.jsx("span",{className:"text-[11px] font-extrabold text-indigo-800 dark:text-indigo-300",children:"Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ù‡"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",onClick:()=>{if(!M){x({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}kg(M)},title:"Ø¥Ø¶Ø§ÙØ©/Ø®ØµÙ… Ø¥Ù„Ù‰ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",children:e.jsx(Pt,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 rounded-full text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",onClick:()=>{if(!M){x({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„ØªØµÙÙŠØ± Ø±ØµÙŠØ¯Ù‡Ø§ ÙÙ‚Ø·",variant:"destructive"});return}ti(!0)},title:"ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",children:e.jsx(Na,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-0.5",children:e.jsxs("span",{className:"text-[14px] sm:text-xl font-bold text-indigo-800 dark:text-indigo-200 bg-gradient-to-r from-indigo-100 to-indigo-200 dark:from-indigo-900/30 dark:to-indigo-800/30 px-1 py-0.5 rounded-lg shadow-sm block w-fit",children:[(M&&Se[M]||0).toLocaleString("en-US")," Ø¬Ù†ÙŠÙ‡"]})})]})]})]})})]}),e.jsxs(Za,{className:"bg-gray-100 dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 group relative overflow-hidden fade-in-up",children:[e.jsxs(ws,{className:`pb-2 px-4 pt-4 relative z-10 ${P?"sticky top-0 z-20 bg-white/90 dark:bg-card/90 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-card/60":""}`,children:[e.jsxs("div",{className:`flex items-center ${P?"justify-between":"justify-end"}`,children:[P&&e.jsx(Ns,{className:"text-sm font-bold flex items-center gap-2 text-gray-900 dark:text-gray-100",children:e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©"})}),e.jsx("div",{className:"flex items-center gap-2",children:!P&&e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-green-600 mb-1 whitespace-nowrap",children:"Ø³Ø­Ø¨ ATM"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-green-100 text-green-600 hover:bg-green-200 border border-green-200 ring-3 ring-green-300 transition-all duration-200 hover:scale-105 active:bg-green-600 active:text-white active:border-green-600",onClick:()=>H(!0),title:"Ø³Ø­Ø¨ ATM",children:e.jsx(ap,{className:"h-5 w-5 text-green-600"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx("span",{className:"text-[10px] font-semibold text-orange-600 whitespace-nowrap",children:"Ù…Ø¹Ù„Ù‚Ø©"}),bt>0&&e.jsx("span",{className:"h-4 w-4 rounded-full bg-orange-600 text-white text-[10px] flex items-center justify-center ring-2 ring-white",children:bt})]}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-orange-100 text-orange-600 hover:bg-orange-200 border border-orange-200 ring-3 ring-orange-300 transition-all duration-200 hover:scale-105 active:bg-orange-600 active:text-white active:border-orange-600",onClick:()=>yt(!0),title:"Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ø¹Ù„Ù‚Ø©",children:e.jsx(Ml,{className:"h-5 w-5 text-orange-600"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"Ø®Ø·ÙˆØ·"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>L("lines",()=>{Va?At(!0):ie()}),title:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø·ÙˆØ·",children:e.jsx(sp,{className:"h-5 w-5 text-purple-600"})})]}),!Gt.includes("installment")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"ØªÙ‚Ø³ÙŠØ·"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>L("installments",()=>{if(De||_e){x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ· ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"});return}Rr(!0)}),title:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ·",children:e.jsx(rp,{className:"h-5 w-5 text-purple-600"})})]}),!Gt.includes("store")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-blue-600 mb-1",children:"Ù…ØªØ¬Ø±Ùƒ"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 border border-blue-200 ring-3 ring-blue-300 transition-all duration-200 hover:scale-105 active:bg-blue-600 active:text-white active:border-blue-600",onClick:()=>ks(!0),title:"Ù…ØªØ¬Ø±Ùƒ",children:e.jsx(rn,{className:"h-5 w-5 text-blue-600"})})]}),!Gt.includes("calculator")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"Ø­Ø§Ø³Ø¨Ø©"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>Lo(!0),title:"Ø¢Ù„Ø© Ø­Ø§Ø³Ø¨Ø©",children:e.jsx(vp,{className:"h-5 w-5 text-purple-600"})})]}),!Gt.includes("credit-cards")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"ÙƒØ±ÙˆØª"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>L("cards",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Wr(!0)}),title:"ÙƒØ±ÙˆØª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†",children:e.jsx(np,{className:"h-5 w-5 text-purple-600"})})]}),e.jsxs("div",{className:"hidden flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-blue-600 mb-1",children:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 border border-blue-200 ring-3 ring-blue-300 transition-all duration-200 hover:scale-105 active:bg-blue-600 active:text-white active:border-blue-600",onClick:()=>{if(De||_e){x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"});return}uu(!0)},title:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",children:e.jsx(um,{className:"h-5 w-5 text-blue-600"})})]}),!Gt.includes("telegram")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-sky-600 mb-1",children:"ØªÙ„Ø¬Ø±Ø§Ù…"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-sky-100 text-sky-600 hover:bg-sky-200 border border-sky-200 ring-3 ring-sky-300 transition-all duration-200 hover:scale-105 active:bg-sky-600 active:text-white active:border-sky-600",onClick:()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Bt.hasMasterPin()?Il(!0):Iu()},title:"Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",children:e.jsx(ip,{className:"h-5 w-5 text-sky-600"})})]}),!Gt.includes("cashier-shift")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-blue-600 mb-1",children:"Ø§Ù„ÙˆØ±Ø¯ÙŠØ©"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 border border-blue-200 ring-3 ring-blue-300 transition-all duration-200 hover:scale-105 active:bg-blue-600 active:text-white active:border-blue-600",onClick:tg,title:D&&(S!=null&&S.name||S!=null&&S.username)?`Ø¨Ø±ÙˆÙÙŠÙ„ Ø§Ù„ÙˆØ±Ø¯ÙŠØ©: ${(S==null?void 0:S.name)||(S==null?void 0:S.username)}`:"ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ÙƒØ§Ø´ÙŠØ±",children:e.jsx(nn,{className:"h-5 w-5 text-blue-600"})})]}),!Gt.includes("sales")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600 mb-1",children:"Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>L("sales",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):$s(!0)}),title:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª",children:e.jsx(Bl,{className:"h-5 w-5 text-purple-600"})})]}),!Gt.includes("debts")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-[10px] font-semibold text-purple-600",children:"Ø§Ù„Ø¯ÙŠÙˆÙ†"}),Re.filter(a=>a.status==="pending").length>0&&e.jsx("span",{className:"h-4 w-4 rounded-full bg-red-600 text-white text-[10px] flex items-center justify-center ring-2 ring-white",children:Re.filter(a=>a.status==="pending").length})]}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-purple-100 text-purple-600 hover:bg-purple-200 border border-purple-200 ring-3 ring-purple-300 transition-all duration-200 hover:scale-105 active:bg-purple-600 active:text-white active:border-purple-600",onClick:()=>L("debts",()=>{Gn()}),title:"Ø§Ù„Ø¯ÙŠÙˆÙ†",children:e.jsx(Si,{className:"h-5 w-5 text-purple-600"})})]}),!Gt.includes("maintenance")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-amber-700 mb-1",children:"Ø§Ù„ØµÙŠØ§Ù†Ø©"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-amber-100 text-amber-700 hover:bg-amber-200 border border-amber-200 ring-3 ring-amber-300 transition-all duration-200 hover:scale-105 active:bg-amber-600 active:text-white active:border-amber-600",onClick:()=>L("maintenance",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Lr(!0)}),title:"Ø§Ù„ØµÙŠØ§Ù†Ø©",children:e.jsx(Xu,{className:"h-5 w-5 text-amber-700"})})]}),!Gt.includes("machine")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-yellow-500 mb-1",children:"Ø§Ù„Ù…ÙƒÙ†Ø©"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-violet-100 text-violet-700 hover:bg-violet-200 border border-violet-200 ring-3 ring-violet-300 transition-all duration-200 hover:scale-105 active:bg-violet-700 active:text-white active:border-violet-700",onClick:()=>L("machines",()=>{!Xt||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Fr(!0)}),title:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø©",children:e.jsx(op,{className:"h-5 w-5 text-yellow-500"})})]}),!Gt.includes("shop-expenses")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-orange-600 mb-1",children:"Ù…ØµØ±ÙˆÙØ§Øª"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-orange-100 text-orange-600 hover:bg-orange-200 border border-orange-200 ring-3 ring-orange-300 transition-all duration-200 hover:scale-105 active:bg-orange-600 active:text-white active:border-orange-600",onClick:()=>L("expenses",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):Bt.hasMasterPin()?Ts(!0):ds(!0)}),title:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„",children:e.jsx(on,{className:"h-5 w-5 text-orange-600"})})]}),!Gt.includes("deficiencies")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-rose-600 mb-1",children:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-rose-100 text-rose-600 hover:bg-rose-200 border border-rose-200 ring-3 ring-rose-300 transition-all duration-200 hover:scale-105 active:bg-rose-600 active:text-white active:border-rose-600",onClick:()=>L("deficiencies",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):wr(!0)}),title:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ",children:e.jsx(Rl,{className:"h-5 w-5 text-rose-600"})})]}),!Gt.includes("my-client-numbers")&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-semibold text-emerald-600 mb-1",children:"Ø£Ø±Ù‚Ø§Ù…ÙŠ"}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 rounded-full bg-emerald-100 text-emerald-700 hover:bg-emerald-200 border border-emerald-200 ring-3 ring-emerald-300 transition-all duration-200 hover:scale-105 active:bg-emerald-600 active:text-white active:border-emerald-600",onClick:()=>L("myNumbers",()=>{De||_e?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©.",variant:"destructive"}):_n(!0)}),title:"Ø£Ø±Ù‚Ø§Ù…ÙŠ",children:e.jsx(Di,{className:"h-5 w-5 text-emerald-700"})})]})]})})]}),!P&&e.jsx("div",{className:"mt-2 w-full",children:e.jsxs("div",{className:"filters-bar flex items-center justify-center gap-3 bg-gray-100 rounded-md p-3 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:e.jsx(sn,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5 text-gray-700 dark:text-gray-300"})}),e.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-gray-100",children:"Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©"})]}),e.jsxs("div",{className:"relative flex items-center h-9 w-[200px] md:w-[240px] bg-white dark:bg-gray-900 rounded-full border border-gray-200 dark:border-gray-700 hover:border-blue-400 dark:hover:border-blue-500 focus-within:border-blue-500 focus-within:ring-4 focus-within:ring-blue-50 dark:focus-within:ring-blue-900/30 transition-all duration-300 shadow-sm hover:shadow-md group",children:[e.jsx(nm,{className:"absolute right-3 h-4 w-4 text-gray-400 group-hover:text-blue-500 transition-colors pointer-events-none"}),e.jsx(X,{placeholder:"Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ...",value:To,onChange:a=>xd(a.target.value),className:"h-full w-full pr-10 pl-8 py-0 text-xs font-medium border-0 bg-transparent focus:ring-0 focus-visible:ring-0 shadow-none placeholder:text-gray-400 text-gray-700 dark:text-gray-200 rounded-full"}),To&&e.jsx("button",{onClick:()=>xd(""),className:"absolute left-2 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-400 hover:text-red-500 transition-colors",title:"Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø«",children:e.jsx(ln,{className:"h-3.5 w-3.5"})})]}),e.jsx(I,{variant:"ghost",size:"sm",className:`btn-filter-send h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Qt==="send"?"bg-green-600 text-white border-green-600":"text-green-700 border-green-300 hover:bg-green-100"}`,onClick:()=>_r("send"),title:"ØªØµÙÙŠØ© Ø§Ù„ØªØ­ÙˆÙŠÙ„",children:"Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),e.jsx(I,{variant:"ghost",size:"sm",className:`btn-filter-withdraw h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Qt==="withdraw"?"bg-red-600 text-white border-red-600":"text-red-700 border-red-300 hover:bg-red-100"}`,onClick:()=>_r("withdraw"),title:"ØªØµÙÙŠØ© Ø§Ù„Ø³Ø­Ø¨",children:"Ø§Ù„Ø³Ø­Ø¨"}),e.jsx(I,{variant:"ghost",size:"sm",className:`btn-filter-deferred h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Qt==="deferred"?"bg-yellow-600 text-white border-yellow-600":"text-yellow-700 border-yellow-300 hover:bg-yellow-100"}`,onClick:()=>_r("deferred"),title:"ØªØµÙÙŠØ© Ø§Ù„Ù…Ø¤Ø¬Ù„",children:"Ù…Ø¤Ø¬Ù„"}),e.jsx(I,{variant:"ghost",size:"sm",className:`btn-filter-wallet h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Qt==="wallet"?"bg-blue-600 text-white border-blue-600":"text-blue-700 border-blue-300 hover:bg-blue-100"}`,onClick:()=>{M?_r("wallet"):x({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÙ‡Ø§",variant:"destructive"})},title:"Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­ÙØ¸Ù‡ Ø§Ù„Ù…Ø®ØªØ§Ø±Ù‡ ÙÙ‚Ø·",children:"Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø­ÙØ¸Ù‡"}),e.jsx(I,{variant:"ghost",size:"sm",className:`btn-filter-all h-8 px-4 text-[12px] min-w-[96px] rounded-full border ${Qt==="all"?"bg-green-600 text-white border-green-600":"text-green-700 border-green-300 hover:bg-green-100"}`,onClick:()=>_r("all"),title:"Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„",children:"Ø§Ù„ÙƒÙ„"})]})})]}),e.jsx(ia,{open:sf,onOpenChange:Rr,mode:"verify",title:"ÙØªØ­ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ·",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ø³ÙŠØ·",onSuccess:()=>{Rr(!1),kd(!0)}}),e.jsx(Tw,{open:rf,onOpenChange:kd}),e.jsx(ia,{open:rt,onOpenChange:At,mode:"verify",title:"ÙØªØ­ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø·ÙˆØ·",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø·ÙˆØ·",onSuccess:()=>{At(!1),ie()}}),e.jsx(Pw,{isOpen:nf,onClose:()=>$n(!1),shopId:j,onOpenAdsl:()=>{$n(!1),Cd(!0)}}),e.jsx(sm,{isOpen:ye,onClose:()=>vt(!1),userId:(t==null?void 0:t.uid)||"",userEmail:(t==null?void 0:t.email)||""}),e.jsx(Ow,{isOpen:of,onClose:()=>Cd(!1),shopId:j}),e.jsx(ia,{open:pg,onOpenChange:Il,mode:"verify",title:"Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…",onSuccess:()=>{Il(!1),Iu()},userId:t==null?void 0:t.uid,userRole:r==null?void 0:r.role}),e.jsxs(es,{className:"space-y-2 pt-0 px-4 pb-4 relative z-10",children:[Ol.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(sn,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†"})]}):P?e.jsx("div",{className:"overflow-y-auto overscroll-contain scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400 transition-colors max-h-[310px]",children:e.jsx("div",{className:"space-y-2 pr-2",children:Ol.map(a=>e.jsxs("div",{className:"relative flex items-center gap-4 p-4 rounded-xl bg-gray-50 border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>Tu(a),children:[e.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center shrink-0 ${a.type==="withdraw"?"bg-red-100":"bg-green-100"}`,children:(()=>{const n=a,o=(n==null?void 0:n.type)==="report"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((n==null?void 0:n.type)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.type)||"").toLowerCase()==="add"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),u=String((n==null?void 0:n.type)||"").toLowerCase()==="sales"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="sales"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((n==null?void 0:n.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª";return o?e.jsx(on,{className:"h-5 w-5 text-gray-600"}):c?e.jsx(Pt,{className:"h-5 w-5 text-green-600"}):u?e.jsx(on,{className:"h-5 w-5 text-green-600"}):a.type==="withdraw"?e.jsx(rr,{className:"h-5 w-5 text-red-600"}):e.jsx(rm,{className:"h-5 w-5 text-green-600"})})()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"text-base font-bold truncate",children:(()=>{const n=a,o=(n==null?void 0:n.type)==="report"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((n==null?void 0:n.type)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.type)||"").toLowerCase()==="add"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),u=String((n==null?void 0:n.type)||"").toLowerCase()==="sales"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="sales"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((n==null?void 0:n.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",h=String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((n==null?void 0:n.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡");return o?e.jsx("span",{className:"text-foreground",children:"ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"}):h?e.jsx("span",{className:"text-foreground",children:"Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡"}):c?e.jsx("span",{className:"text-foreground",children:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"}):u?e.jsx("span",{className:"text-foreground",children:"Ù…Ø¨ÙŠØ¹Ø§Øª"}):a.type==="atm_withdraw"?e.jsx("span",{className:"text-green-600",children:"Ø³Ø­Ø¨ atm"}):a.type==="send"?e.jsx("span",{className:"text-green-600",children:"ØªØ­ÙˆÙŠÙ„ Ø£Ù…ÙˆØ§Ù„"}):e.jsx("span",{className:"text-red-600",children:"Ø³Ø­Ø¨ Ù†Ù‚Ø¯ÙŠ"})})()}),e.jsxs("span",{className:`text-base font-bold whitespace-nowrap ${a.type==="withdraw"?"text-red-600":"text-green-600"}`,children:[a.type==="withdraw"||a.type==="cash_addition"||a.txnType==="cash_addition"||a.type==="sales"||a.txnType==="sales"?"+":"-"," ",Ft(a.amount)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:(()=>{const n=a,o=(n==null?void 0:n.type)==="report"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((n==null?void 0:n.type)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.type)||"").toLowerCase()==="add"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),u=String((n==null?void 0:n.type)||"").toLowerCase()==="sales"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="sales"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((n==null?void 0:n.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",h=String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((n==null?void 0:n.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡"),f=(n==null?void 0:n.note)||(n==null?void 0:n.notes)||"";if(o)return`Ø¥Ù„Ù‰: ${a.receiverPhone}`;if(c)return f||"Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠØ©";if(u){const p=((n==null?void 0:n.saleProductName)||"").trim(),w=((n==null?void 0:n.saleQuantity)??"").toString();return p&&w?`${p} Ã— ${w}`:p||"Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹"}return h?`Ù…Ù†: ${n.senderName||"Ù…Ø§ÙƒÙŠÙ†Ø©"}`:a.type==="send"?e.jsx("span",{dir:"ltr",children:a.receiverPhone}):e.jsx("span",{dir:"ltr",children:a.senderPhone})})()}),e.jsxs("p",{className:"text-sm font-medium text-gray-500 mt-0.5",children:[en.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))," - ",Mu.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))]})]}),e.jsxs("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium flex items-center gap-1 ${a.status==="completed"?a.type==="withdraw"?"bg-red-100 text-red-700":"bg-green-100 text-green-700":a.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[a.status==="completed"&&e.jsx(ki,{className:"h-3 w-3"}),a.status==="pending"&&e.jsx(Ml,{className:"h-3 w-3"}),a.status==="failed"&&e.jsx(ln,{className:"h-3 w-3"}),e.jsx("span",{children:a.status==="completed"?"Ù†Ø§Ø¬Ø­Ø©":a.status==="pending"?"Ù…Ø¹Ø§Ù„Ø¬Ø©":"ÙØ´Ù„Øª"})]})]})]})]},a.id))})}):e.jsx("div",{className:"overflow-y-auto overscroll-contain scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400 transition-colors max-h-[calc(100dvh-300px)]",children:e.jsx("div",{className:"space-y-2 pr-2",children:Ol.map(a=>e.jsxs("div",{className:"relative flex items-center gap-4 p-4 rounded-xl bg-gray-50 border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>Tu(a),children:[e.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center shrink-0 ${a.type==="withdraw"?"bg-red-100":"bg-green-100"}`,children:(()=>{const n=a,o=(n==null?void 0:n.type)==="report"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((n==null?void 0:n.type)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.type)||"").toLowerCase()==="add"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),u=String((n==null?void 0:n.type)||"").toLowerCase()==="sales"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="sales"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((n==null?void 0:n.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª";return o?e.jsx(on,{className:"h-5 w-5 text-gray-600"}):c?e.jsx(Pt,{className:"h-5 w-5 text-green-600"}):u?e.jsx(on,{className:"h-5 w-5 text-green-600"}):a.type==="withdraw"?e.jsx(rr,{className:"h-5 w-5 text-red-600"}):e.jsx(rm,{className:"h-5 w-5 text-green-600"})})()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"text-base font-bold truncate",children:(()=>{const n=a,o=(n==null?void 0:n.type)==="report"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((n==null?void 0:n.type)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.type)||"").toLowerCase()==="add"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),u=String((n==null?void 0:n.type)||"").toLowerCase()==="sales"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="sales"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((n==null?void 0:n.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",h=String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((n==null?void 0:n.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡");return o?e.jsx("span",{className:"text-foreground",children:"ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"}):c?e.jsx("span",{className:"text-foreground",children:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"}):u?e.jsx("span",{className:"text-foreground",children:"Ù…Ø¨ÙŠØ¹Ø§Øª"}):h?e.jsx("span",{className:"text-foreground",children:"Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡"}):a.type==="atm_withdraw"?e.jsx("span",{className:"text-green-600",children:"Ø³Ø­Ø¨ atm"}):a.type==="send"?e.jsx("span",{className:"text-green-600",children:"ØªØ­ÙˆÙŠÙ„ Ø£Ù…ÙˆØ§Ù„"}):e.jsx("span",{className:"text-red-600",children:"Ø³Ø­Ø¨ Ù†Ù‚Ø¯ÙŠ"})})()}),e.jsxs("span",{className:`text-base font-bold whitespace-nowrap ${a.type==="withdraw"?"text-red-600":"text-green-600"}`,children:[a.type==="withdraw"||a.type==="cash_addition"||a.txnType==="cash_addition"||a.type==="sales"||a.txnType==="sales"?"+":"-"," ",Ft(a.amount)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:(()=>{const n=a,o=(n==null?void 0:n.type)==="report"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ³Ù„ÙŠÙ… ÙˆØ±Ø¯ÙŠØ©"),c=String((n==null?void 0:n.type)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.type)||"").toLowerCase()==="add"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="cash_addition"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©"),u=String((n==null?void 0:n.type)||"").toLowerCase()==="sales"||String((n==null?void 0:n.txnType)||"").toLowerCase()==="sales"||String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ Ù…Ø¨ÙŠØ¹Ø§Øª")||String((n==null?void 0:n.senderMsisdn)||"")==="Ù…Ø¨ÙŠØ¹Ø§Øª",h=String((n==null?void 0:n.title)||"").includes("Ø¥ÙŠØµØ§Ù„ ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙŠÙ†Ù‡")||String((n==null?void 0:n.description)||"").includes("ØªØ­ÙˆÙŠÙ„ Ù…ÙƒÙ†Ù‡"),f=(n==null?void 0:n.note)||(n==null?void 0:n.notes)||"";if(o)return`Ø¥Ù„Ù‰: ${a.receiverPhone}`;if(c)return f||"Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠØ©";if(u){const p=((n==null?void 0:n.saleProductName)||"").trim(),w=((n==null?void 0:n.saleQuantity)??"").toString();return p&&w?`${p} Ã— ${w}`:p||"Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹"}return h?`Ù…Ù†: ${n.senderName||"Ù…Ø§ÙƒÙŠÙ†Ø©"}`:a.type==="send"?e.jsx("span",{dir:"ltr",children:a.receiverPhone}):e.jsx("span",{dir:"ltr",children:a.senderPhone})})()}),e.jsxs("p",{className:"text-sm font-medium text-gray-500 mt-0.5",children:[en.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))," - ",Mu.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))]})]}),e.jsxs("div",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium flex items-center gap-1 ${a.status==="completed"?a.type==="withdraw"?"bg-red-100 text-red-700":"bg-green-100 text-green-700":a.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[a.status==="completed"&&e.jsx(ki,{className:"h-3 w-3"}),a.status==="pending"&&e.jsx(Ml,{className:"h-3 w-3"}),a.status==="failed"&&e.jsx(ln,{className:"h-3 w-3"}),e.jsx("span",{children:a.status==="completed"?"Ù†Ø§Ø¬Ø­Ø©":a.status==="pending"?"Ù…Ø¹Ø§Ù„Ø¬Ø©":"ÙØ´Ù„Øª"})]})]})]})]},a.id))})}),P&&e.jsxs("div",{className:"mt-2 flex justify-end",children:[e.jsxs(I,{variant:"ghost",size:"sm",className:"h-7 px-2 text-[11px] rounded-full border bg-red-100 text-red-700 border-red-300 hover:bg-red-200",onClick:()=>ai(!0),title:"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©",children:[e.jsx(Na,{className:"h-3 w-3 mr-1"}),"ØªØµÙÙŠØ±"]}),(t==null?void 0:t.uid)&&localStorage.getItem(`recentTransactionsResetAt:${t.uid}`)&&e.jsx("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-red-500 ml-1 align-middle"})]})]})]})]}),e.jsx(ww,{isOpen:$0,onClose:()=>Ln(!1),transaction:U0,onPrint:()=>window.print(),onDelete:K0,onComplete:J0}),e.jsx(ue,{open:Mh,onOpenChange:qi,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(pe,{children:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø·ÙˆØ±"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4 bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-900/20 dark:to-blue-900/20 p-6 rounded-xl border border-blue-100 dark:border-blue-800 text-center",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400 shadow-sm",children:e.jsx(wp,{className:"h-8 w-8"})}),e.jsxs("div",{className:"space-y-3 w-full",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ·ÙˆÙŠØ±"}),e.jsx("p",{className:"text-lg font-bold bg-gradient-to-r from-blue-700 to-indigo-700 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent leading-relaxed",children:"ØªÙ… ØªØ·ÙˆÙŠØ± Ø§Ù„Ø§Ø¨Ù„ÙƒÙŠØ´Ù† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨ÙˆØ§Ø³Ø·Ø© Ù…/Ø£Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­ÙŠÙ… Ù…Ø­Ù…Ø¯"}),e.jsxs("div",{className:"flex flex-col items-center gap-1 mt-4",children:[e.jsx("p",{className:"text-base font-semibold text-gray-800 dark:text-gray-300",children:"Ø±Ù‚Ù… Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„ÙˆØ­ÙŠØ¯ Ù„Ù†Ø§"}),e.jsx("a",{href:"tel:01000392539",className:"text-2xl font-black text-blue-600 dark:text-blue-400 tracking-wider hover:underline",dir:"ltr",children:"01000392539"})]}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 font-bold bg-red-50 dark:bg-red-900/20 py-1 px-3 rounded-full inline-block mt-2",children:"Ù„ÙŠØ³ Ù„Ù†Ø§ Ø§ÙŠ Ø§Ø±Ù‚Ø§Ù… Ø§Ø®Ø±ÙŠ"})]})]}),e.jsx("div",{className:"text-center text-xs text-gray-400 mt-2",children:Pc?`v${Pc}`:"v1.0.0"})]}),e.jsx(Fe,{children:e.jsx(I,{onClick:()=>qi(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsxs("div",{className:"space-y-1 fade-in-right w-full",children:[e.jsxs(Za,{id:"transaction-section",className:"bg-gray-100 border border-blue-200/40 rounded-lg shadow-lg hover:shadow-lg transition-all duration-200 group relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 via-indigo-500/3 to-purple-500/5 opacity-0 group-hover:opacity-100 transition-opacity duration-200"}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 sm:w-28 sm:h-28 lg:w-20 lg:h-20 bg-gradient-to-bl from-blue-400/10 to-transparent rounded-full  "}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-indigo-400/10 to-transparent rounded-full  ",style:{animationDelay:"1s"}}),e.jsx(ws,{className:"sticky top-0 z-20 bg-white/80 dark:bg-gray-900/80 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-gray-900/60 pb-0.5 px-3 pt-1 lg:pt-0.5 lg:pb-0.5 lg:px-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ns,{className:"text-sm font-bold flex items-center gap-2 text-gray-800",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ri,{className:"h-1 w-1 text-emerald-500 "}),e.jsx("div",{className:"absolute inset-0 h-1 w-1 bg-emerald-400 rounded-full opacity-20 "})]}),e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Ø¥Ø¬Ø±Ø§Ø¡ Ù…Ø¹Ø§Ù…Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"top-icons-bar hidden md:flex items-center gap-2 bg-gradient-to-r from-gray-50 to-slate-50 hover:from-gray-100 hover:to-slate-100 border border-gray-200 transition-all duration-300 hover:scale-105 h-9 px-3 rounded-xl shadow-sm",children:[e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Ø±Ø§Ø­Ø© Ø§Ù„Ø¹ÙŠÙ†",onClick:()=>qd(!qs),children:e.jsx(Np,{className:`h-5 w-5 transition-colors duration-300 ${qs?"text-orange-500 fill-orange-500":"text-gray-600"}`})}),e.jsx(Jv,{}),e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"VIP",onClick:()=>Fo(!0),children:e.jsx(Up,{className:"h-5 w-5 text-yellow-500"})}),e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ±ÙˆØ¹",onClick:()=>(Dt==null?void 0:Dt.status)==="active"?fr(!0):gr(!0),children:e.jsx(rn,{className:"h-5 w-5"})}),e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø·ÙˆØ±",onClick:()=>qi(!0),children:e.jsx(Xu,{className:"h-5 w-5 text-gray-600"})}),e.jsx(Wp,{})]})}),gg&&e.jsxs(I,{variant:"outline",size:"sm",className:"hidden flex items-center gap-1.5 sm:gap-2 bg-gradient-to-r from-cyan-50 to-blue-50 hover:from-cyan-100 hover:to-blue-100 border-cyan-200 text-cyan-800 text-xs sm:text-sm transition-all duration-300 hover:scale-105 hover:shadow-lg h-10 sm:h-12 px-4 sm:px-5 rounded-xl min-w-[44px] touch-manipulation",onClick:ju,title:"Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…",children:[e.jsx($l,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 animate-spin"}),e.jsx("span",{className:"text-xs sm:text-sm font-semibold whitespace-nowrap",children:"Ù…Ø²Ø§Ù…Ù†Ø©"})]})]})}),e.jsx(ue,{open:pf,onOpenChange:Fo,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(pe,{children:"Ø£ÙØ¶Ù„ 10 Ø¹Ù…Ù„Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±"})}),e.jsx("div",{className:"space-y-2",children:pi.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±"}):pi.map((a,n)=>e.jsxs("div",{className:`flex items-center justify-between border rounded-md px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700 ${n===0?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-300 dark:border-yellow-700":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ma,{variant:"outline",className:`min-w-[28px] justify-center ${n===0?"border-yellow-300 text-yellow-700 dark:text-yellow-400 bg-yellow-50 dark:bg-yellow-900/20":""}`,children:n+1}),e.jsx("span",{className:`font-semibold ${n===0?"text-yellow-700":""}`,children:a.phone})]}),e.jsxs("div",{className:"text-sm text-gray-700 flex items-center gap-3",children:[e.jsxs("span",{children:["Ø¹Ø¯Ø¯: ",a.count]}),e.jsxs("span",{children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ",a.total]}),e.jsx(I,{variant:"outline",size:"sm",className:"h-8",onClick:()=>mg(a),title:"Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨",children:e.jsx(Wl,{className:"h-4 w-4"})})]})]},a.phone+n))}),e.jsx(Fe,{children:e.jsx(I,{onClick:()=>Fo(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(ue,{open:hf,onOpenChange:_d,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(pe,{children:"Ø±Ø¨Ø· Ø¨ÙˆØª Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù…"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{children:"Telegram Chat ID"}),e.jsx(X,{value:qn,onChange:a=>ff(a.target.value),placeholder:"Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Q,{children:"Ø¥Ø±Ø³Ø§Ù„ ÙŠÙˆÙ…ÙŠ 12 ØµØ¨Ø§Ø­Ø§Ù‹"}),e.jsx(Rp,{checked:Ad,onCheckedChange:a=>gf(!!a)})]})]}),e.jsxs(Fe,{children:[e.jsx(I,{variant:"outline",onClick:()=>_d(!1),children:"Ø¥ØºÙ„Ø§Ù‚"}),e.jsx(I,{onClick:async()=>{t!=null&&t.uid&&(await oe.updateUserData(t.uid,{telegramChatId:qn,telegramDailyEnabled:Ad}),x({title:"ØªÙ… Ø§Ù„Ø­ÙØ¸"}))},children:"Ø­ÙØ¸"}),e.jsx(I,{onClick:async()=>{if(!(t!=null&&t.uid)||!qn){x({title:"Ø£Ø¯Ø®Ù„ Chat ID"});return}const a=await ku();try{const{sendTelegramMessage:n}=await re(async()=>{const{sendTelegramMessage:o}=await import("./functions-C8GAR9cn.js");return{sendTelegramMessage:o}},__vite__mapDeps([65,0,1]),import.meta.url);await n({chatId:qn,text:a}),x({title:"ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„"})}catch{x({title:"ØªØ¹Ø°Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ø¨Ø· Ø§Ù„Ø¨ÙˆØª",variant:"destructive"})}},children:"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¢Ù†"})]})]})}),e.jsx(ue,{open:hr,onOpenChange:fr,children:e.jsxs(me,{className:"sm:max-w-2xl bg-gray-50/80 backdrop-blur-sm",children:[e.jsx(be,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:e.jsx(rn,{className:"w-6 h-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx(pe,{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ±ÙˆØ¹"}),e.jsx(at,{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Ø£Ø¶Ù ÙØ±ÙˆØ¹Ø§Ù‹ Ø¬Ø¯ÙŠØ¯Ø© ÙˆØªØ§Ø¨Ø¹ Ø£Ø¯Ø§Ø¡ ÙƒÙ„ ÙØ±Ø¹ Ø¨Ø³Ù‡ÙˆÙ„Ø©"})]})]}),e.jsx(I,{size:"icon",variant:_s?"destructive":"default",className:`rounded-full transition-all duration-300 ${_s?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200":"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg hover:shadow-indigo-200"}`,onClick:()=>_c(!_s),title:_s?"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¥Ø¶Ø§ÙØ©":"Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¹ Ø¬Ø¯ÙŠØ¯",children:_s?e.jsx(Ci,{className:"w-6 h-6"}):e.jsx(Pt,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"space-y-6",children:[_s&&e.jsxs("div",{className:"bg-white dark:bg-card p-5 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm space-y-4 animate-in slide-in-from-top-4 fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-indigo-700 dark:text-indigo-400 font-semibold",children:[e.jsx(Pt,{className:"w-5 h-5"}),e.jsx("h3",{children:"Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¹ Ø¬Ø¯ÙŠØ¯"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:()=>checkSubscriptionStatus(!0).then(()=>x({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"})),variant:"ghost",size:"icon",title:"ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ",children:e.jsx($l,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})}),e.jsxs(I,{onClick:()=>gr(!0),variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Qp,{className:"w-4 h-4"}),"Ø·Ù„Ø¨ Ø²ÙŠØ§Ø¯Ø© ÙØ±Ø¹"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{className:"text-gray-700 dark:text-gray-300",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±"}),e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400"}),e.jsx(X,{className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:bc,onChange:a=>Yi(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{className:"text-gray-700 dark:text-gray-300",children:"Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹"}),e.jsxs("div",{className:"relative",children:[e.jsx(rn,{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400"}),e.jsx(X,{className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:vc,onChange:a=>Ki(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: ÙØ±Ø¹ ÙˆØ³Ø· Ø§Ù„Ø¨Ù„Ø¯"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{className:"text-gray-700 dark:text-gray-300",children:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø¯Ø®ÙˆÙ„"}),e.jsxs("div",{className:"relative",children:[e.jsx(Wl,{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400"}),e.jsx(X,{className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:wc,onChange:a=>Ji(a.target.value),placeholder:"branch@example.com"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{className:"text-gray-700 dark:text-gray-300",children:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400",children:"ðŸ”’"}),e.jsx(X,{type:"password",className:"pr-9 bg-white dark:bg-gray-950 dark:border-gray-700 dark:text-gray-100",value:Nc,onChange:a=>Hi(a.target.value),onKeyDown:a=>{var n;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(n=document.getElementById("create-branch-btn"))==null||n.click())},placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx(I,{variant:"ghost",onClick:()=>{Yi(""),Ki(""),Ji(""),Hi("")},className:"text-gray-500 hover:text-gray-700",children:"Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„"}),e.jsx(I,{id:"create-branch-btn",className:"bg-indigo-600 hover:bg-indigo-700 text-white min-w-[120px]",disabled:Qi,onClick:async()=>{if(!(t!=null&&t.uid))return;const a=bc.trim(),n=vc.trim(),o=wc.trim(),c=Nc.trim();if(!a||!n||!o||!c){x({title:"ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)){x({title:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­",variant:"destructive"});return}if(c.length<6){x({title:"ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„",variant:"destructive"});return}const h=(Dt==null?void 0:Dt.limit)||0;if(pr.length>=h){x({title:"Ø¹ÙÙˆØ§Ù‹",description:`Ù„Ù‚Ø¯ ÙˆØµÙ„Øª Ù„Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù…Ù† Ø§Ù„ÙØ±ÙˆØ¹ (${h} ÙØ±ÙˆØ¹)`,variant:"destructive"});return}try{wn(!0);let f="",p="";const w=`tempApp_${Date.now()}`,b=lp(cp,w),y=dp(b),N=up(b);try{f=(await mp(y,o,c)).user.uid;try{await sa(Pe(N,"users",f),{email:o,isBranch:!0,ownerId:t.uid,createdAt:ft(),updatedAt:ft(),role:"branch",isActive:!1,subscription:{isActive:!1,planType:null,startDate:null,endDate:null}})}catch(T){console.error("Error creating branch user document:",T)}try{p=(await cn(ce(N,"shops"),{name:n,ownerId:f,managerName:a,createdAt:ft(),updatedAt:ft(),isActive:!0})).id}catch(T){console.error("Error creating shop as new user:",T);try{p=(await cn(ce(N,"users",f,"shops"),{name:n,ownerId:f,managerName:a,createdAt:ft(),updatedAt:ft(),isActive:!0})).id}catch(R){throw console.error("Error creating shop in subcollection:",R),T}}await hp(y)}catch(C){console.error("Registration/Shop Creation Error:",C);let T="ØªØ¹Ø°Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ù…ØªØ¬Ø±";C.code==="auth/email-already-in-use"&&(T="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„"),C.code==="auth/invalid-email"&&(T="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­"),C.code==="auth/weak-password"&&(T="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ©"),C.code==="permission-denied"&&(T="Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù…ØªØ¬Ø± Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"),x({title:T,description:C.message,variant:"destructive"});try{await Zu(b)}catch{}return}finally{try{await Zu(b)}catch(C){console.warn("Error deleting temp app:",C)}}if(!f||!p)return;const k=C=>{try{return btoa(unescape(encodeURIComponent(C)))}catch{return btoa(C)}};try{const C={ownerId:t.uid,shopId:p,branchUserId:f,branchName:n,managerName:a,loginUsername:o,passwordEncoded:k(c),createdAt:ft()};await sa(Pe($,"users",t.uid,"branches",f),C);try{await cn(ce($,"branches"),C)}catch(R){console.warn("Branch ref creation error in root collection (non-fatal):",R)}const T={id:f,branchUserId:f,branchName:n,managerName:a,source:"sub",...C};zi(R=>[...R,T])}catch(C){console.error("Branch ref creation error:",C),x({title:"Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹",description:"ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙ„ÙƒÙ† ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",variant:"destructive"})}Yi(""),Ki(""),Ji(""),Hi(""),x({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ±Ø¹ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­"})}catch(f){console.error("General Error adding branch:",f),x({title:"ØªØ¹Ø°Ù‘Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ±Ø¹",description:f.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹"})}finally{wn(!1)}},children:Qi?"Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø¶Ø§ÙØ©...":"Ø¥Ø¶Ø§ÙØ© ÙØ±Ø¹"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-6 bg-indigo-500 rounded-full"}),"Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠØ©",e.jsxs(Ma,{variant:"secondary",className:"mr-auto",children:[pr.length," / ",(Dt==null?void 0:Dt.limit)||0]})]}),Qi&&pr.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-gray-500",children:[e.jsx($l,{className:"w-8 h-8 animate-spin mb-2 text-indigo-400"}),e.jsx("p",{children:"Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ±ÙˆØ¹..."})]}):pr.length===0?e.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-200 dark:border-gray-800 rounded-xl bg-gray-50 dark:bg-gray-900/50",children:[e.jsx(rn,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙØ±ÙˆØ¹ Ù…Ø¶Ø§ÙØ© Ø­Ø§Ù„ÙŠØ§Ù‹"})]}):e.jsx("div",{className:"grid grid-cols-1 gap-3",children:pr.map(a=>{var n;return e.jsx("div",{className:"group relative bg-white dark:bg-card border border-gray-200 dark:border-gray-800 rounded-xl p-4 shadow-sm hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-700 dark:text-indigo-400 font-bold text-lg",children:((n=a.branchName)==null?void 0:n.charAt(0))||"B"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-gray-900 dark:text-gray-100 text-lg",children:a.branchName}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(nn,{className:"w-3 h-3"}),e.jsxs("span",{children:["Ø§Ù„Ù…Ø¯ÙŠØ±: ",a.managerName]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto mt-2 sm:mt-0",children:[e.jsxs(I,{className:"flex-1 sm:flex-none bg-indigo-50 text-indigo-700 hover:bg-indigo-100 border border-indigo-200 dark:bg-indigo-900/20 dark:text-indigo-300 dark:hover:bg-indigo-900/30 dark:border-indigo-800",onClick:()=>Xh(a),children:[e.jsx(Bl,{className:"w-4 h-4 ml-2"}),"Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"]}),e.jsx(I,{variant:"ghost",size:"icon",className:"text-blue-500 hover:text-blue-700 hover:bg-blue-50 dark:text-blue-400 dark:hover:text-blue-300 dark:hover:bg-blue-900/20",title:"ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹",onClick:()=>Qh(a),children:e.jsx(cm,{className:"w-4 h-4"})})]})]})},a.id)})})]})]})]})}),e.jsx(ue,{open:Wh,onOpenChange:Gi,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsxs(be,{children:[e.jsx(pe,{children:"Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ±Ø¹"}),e.jsx(at,{children:"Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙØ±Ø¹ Ø§Ù„Ù…Ø­Ø¯Ø¯"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(Q,{children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ)"}),e.jsx(X,{value:jc,onChange:a=>Sc(a.target.value),placeholder:"example@email.com"})]}),e.jsxs("div",{children:[e.jsx(Q,{children:"ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±"}),e.jsx(X,{type:"password",value:Dc,onChange:a=>kc(a.target.value),onKeyDown:a=>{var n;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(n=document.getElementById("branch-login-btn"))==null||n.click())},placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>{Sc(""),kc("")},children:"Ù…Ø³Ø­"}),e.jsx(I,{id:"branch-login-btn",className:"bg-blue-600 hover:bg-blue-700",disabled:Fh,onClick:async()=>{const a=Lh;if(!a){Gi(!1);return}const n=String(a.loginUsername||"");let o="";try{const h=String(a.passwordEncoded||"");o=h?decodeURIComponent(escape(atob(h))):""}catch{try{o=a.passwordEncoded?atob(String(a.passwordEncoded)):""}catch{o=""}}const c=jc.trim(),u=Dc.trim();if(!c||!u){x({title:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±"});return}if(c!==n||u!==o){x({title:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©",variant:"destructive"});return}try{Cc(!0);const h=t!=null&&t.uid?`selectedShopId_${t.uid}`:"selectedShopId";localStorage.setItem(h,String(a.shopId)),x({title:"ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙØ±Ø¹",description:String(a.branchName||"")}),Gi(!1),fr(!1),g("/user/dashboard")}catch{}Cc(!1)},children:"Ø¯Ø®ÙˆÙ„"})]})]})]})}),e.jsx(ue,{open:Bh,onOpenChange:Nn,children:e.jsxs(me,{className:"sm:max-w-2xl",children:[e.jsxs(be,{children:[e.jsxs(pe,{children:["Ø¨ÙŠØ§Ù†Ø§Øª ÙØ±Ø¹ ",Et==null?void 0:Et.branchName]}),e.jsxs(at,{children:["Ù…Ø¯ÙŠØ± Ø§Ù„ÙØ±Ø¹: ",Et==null?void 0:Et.managerName]})]}),$h?e.jsx("div",{className:"py-8 flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):Et?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 py-4",children:[e.jsxs("div",{className:"p-4 border rounded-xl bg-green-50 dark:bg-green-950/20 dark:border-green-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…"}),e.jsxs("div",{className:"text-xl font-bold text-green-700 dark:text-green-400",children:[Ft(Et.todaySales)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-blue-50 dark:bg-blue-950/20 dark:border-blue-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø´Ù‡Ø±"}),e.jsxs("div",{className:"text-xl font-bold text-blue-700 dark:text-blue-400",children:[Ft(Et.monthSales)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-emerald-50 dark:bg-emerald-950/20 dark:border-emerald-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ø§Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…"}),e.jsxs("div",{className:"text-xl font-bold text-emerald-700 dark:text-emerald-400",children:[Ft(Et.todayProfit)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-cyan-50 dark:bg-cyan-950/20 dark:border-cyan-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ø§Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ù‡Ø±"}),e.jsxs("div",{className:"text-xl font-bold text-cyan-700 dark:text-cyan-400",children:[Ft(Et.monthProfit)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-purple-50 dark:bg-purple-950/20 dark:border-purple-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),e.jsxs("div",{className:"text-xl font-bold text-purple-700 dark:text-purple-400",children:[Ft(Et.walletsTotal)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-yellow-50 dark:bg-yellow-950/20 dark:border-yellow-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù†Ù‚Ø¯ÙŠØ© Ø§Ù„Ø¯Ø±Ø¬"}),e.jsxs("div",{className:"text-xl font-bold text-yellow-700 dark:text-yellow-400",children:[Ft(Et.cashBalance)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-indigo-50 dark:bg-indigo-950/20 dark:border-indigo-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¨ÙŠØ¹Ø§Øª Ù‚Ø³Ù… Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"}),e.jsxs("div",{className:"text-xl font-bold text-indigo-700 dark:text-indigo-400",children:[Ft(Et.totalSalesSection)," Ø¬.Ù…"]})]}),e.jsxs("div",{className:"p-4 border rounded-xl bg-red-50 dark:bg-red-950/20 dark:border-red-900/30",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¯ÙŠÙˆÙ†"}),e.jsxs("div",{className:"text-xl font-bold text-red-700 dark:text-red-400",children:[Ft(Et.debtsTotal)," Ø¬.Ù…"]})]})]}):null,e.jsx(Fe,{children:e.jsx(I,{onClick:()=>Nn(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(ue,{open:Yh,onOpenChange:jn,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsxs(be,{children:[e.jsx(pe,{children:"ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹"}),e.jsx(at,{children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹ ÙˆØ§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±"})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{children:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)"}),e.jsx(X,{value:Jh,readOnly:!0,disabled:!0,placeholder:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø±ÙŠØ¯ Ù…Ø³Ø¬Ù„",className:"bg-gray-100 dark:bg-gray-800 text-black dark:text-gray-100 opacity-100 font-medium"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{children:"Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹"}),e.jsx(X,{value:Sn,onChange:a=>Mc(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: ÙØ±Ø¹ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±"}),e.jsx(X,{value:Dn,onChange:a=>Rc(a.target.value),placeholder:"Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯"})]})]}),e.jsxs(Fe,{children:[e.jsx(I,{variant:"outline",onClick:()=>jn(!1),children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{onClick:Gh,disabled:Wc,children:Wc?"Ø¬Ø§Ø±Ù Ø§Ù„Ø­ÙØ¸...":"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª"})]})]})}),e.jsxs(es,{ref:ae,className:"space-y-1 px-2 pb-2 relative z-10 transition-transform duration-200 ease-out will-change-transform",style:{transform:Le?`translateY(${Le}px)`:void 0},onFocusCapture:a=>{const n=a.target;if(!((n==null?void 0:n.id)==="transferExtraFeeInput")){Be(0);return}const c=document.getElementById("transferSubmitButton");if(c){const u=c.getBoundingClientRect(),h=window.innerHeight;if(u.bottom>h){const f=u.bottom-h,p=Math.min(f,220);Be(-p)}else Be(0)}else Be(0)},onBlurCapture:a=>{a.currentTarget.contains(a.relatedTarget)||Be(0)},children:[e.jsxs("div",{className:"transaction-type-tabs flex w-full rounded-full border border-gray-300 dark:border-gray-700 overflow-hidden bg-surface dark:bg-card",children:[e.jsxs("button",{type:"button",onClick:()=>Ni("transfer"),className:`flex-1 h-10 text-sm font-medium transition-colors duration-200 flex items-center justify-center gap-2 ${B==="transfer"?"bg-blue-100 text-blue-900 dark:bg-blue-900/40 dark:text-blue-100":"bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:[B==="transfer"&&e.jsx(ki,{className:"h-4 w-4"}),e.jsx(sn,{className:"h-4 w-4"}),"ØªØ­ÙˆÙŠÙ„"]}),e.jsx("div",{className:"w-[1px] bg-gray-300 dark:bg-gray-700"}),e.jsxs("button",{type:"button",onClick:()=>L("withdrawals",()=>Ni("withdraw")),className:`flex-1 h-10 text-sm font-medium transition-colors duration-200 flex items-center justify-center gap-2 ${B==="withdraw"?"bg-red-100 text-red-900 dark:bg-red-900/40 dark:text-red-100":"bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:[B==="withdraw"&&e.jsx(ki,{className:"h-4 w-4"}),e.jsx(rr,{className:"h-4 w-4"}),"Ø³Ø­Ø¨"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-3",children:[e.jsxs("label",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 whitespace-nowrap",children:[e.jsx(tr,{className:"h-4 w-4 text-blue-600"}),"Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø©"]}),e.jsxs("div",{className:"flex items-center gap-1 justify-end overflow-x-auto scrollbar-hide",children:[e.jsxs(I,{variant:"outline",size:"sm",className:"h-7 rounded-md px-2 text-[10px] font-medium bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border-emerald-200 shadow-sm whitespace-nowrap",onClick:()=>g("/user/add-wallet"),title:"Ø¥Ø¶Ø§ÙØ© Ù…Ø­ÙØ¸Ø©",children:[e.jsx(Pt,{className:"h-3 w-3 mr-1"}),"Ø¥Ø¶Ø§ÙØ© Ù…Ø­ÙØ¸Ø©"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"h-7 rounded-md px-2 text-[10px] font-medium bg-orange-50 text-orange-700 hover:bg-orange-100 border-orange-200 shadow-sm whitespace-nowrap",onClick:()=>Ce(!0),title:"Ø·Ø¨Ø§Ø¹Ø© Ù…Ø­ÙØ¸Ø©",children:[e.jsx(Vp,{className:"h-3 w-3 mr-1"}),"Ø·Ø¨Ø§Ø¹Ø©"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"h-7 rounded-md px-2 text-[10px] font-medium bg-indigo-50 text-indigo-700 hover:bg-indigo-100 border-indigo-200 shadow-sm whitespace-nowrap",onClick:()=>{Pn(!0)},title:"Ø§Ù„Ù…Ø­Ø§ÙØ¸",children:[e.jsx(tr,{className:"h-3 w-3 mr-1"}),"Ø§Ù„Ù…Ø­Ø§ÙØ¸"]})]})]}),J.length>0?e.jsxs(Wa,{value:M,onValueChange:yg,children:[e.jsx(La,{"data-testid":"wallet-select",className:"w-full h-14 text-base bg-surface border border-gray-400 hover:border-gray-800 focus:border-primary rounded-xl transition-colors duration-200 flex items-center",children:e.jsx(Fa,{placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ù…Ø¹Ø§Ù…Ù„Ø©",className:"text-gray-700"})}),e.jsxs(Ba,{className:"rounded-xl border border-gray-200 dark:border-gray-800 shadow-md z-[9999] bg-white dark:bg-gray-900",children:[e.jsx("div",{"data-fixed-header":"true",className:"sticky top-0 z-10 bg-white dark:bg-gray-900 p-2 border-b border-gray-100 dark:border-gray-800",children:e.jsx(X,{value:ud,onChange:a=>W0(a.target.value),placeholder:"Ø§Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©",className:"h-10 text-sm border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-950 text-gray-900 dark:text-gray-100 rounded-lg"})}),e.jsx("div",{className:"p-1",children:hd.length===0?e.jsx("div",{className:"text-sm text-gray-500 p-3 text-center",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©"}):hd.map(a=>{const n=Is.includes(a.id);return e.jsx(oa,{value:a.id,className:"rounded-lg my-1 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 focus:bg-blue-50 dark:focus:bg-blue-900/20 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center gap-3 py-2 w-full",children:[e.jsx(tr,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),e.jsxs("div",{className:"flex items-center gap-2 text-right",children:[e.jsx("span",{className:"text-base font-medium text-gray-900 dark:text-gray-100",children:a.name}),e.jsx("span",{className:"text-sm font-bold text-red-600 dark:text-red-400",children:a.phone})]}),a.isDefault&&e.jsx("span",{className:"mr-auto text-[10px] bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 px-2 py-0.5 rounded-full border border-gray-200 dark:border-gray-700",children:"Ø§ÙØªØ±Ø§Ø¶ÙŠ"}),e.jsx("button",{type:"button",onMouseDown:o=>{o.preventDefault(),o.stopPropagation(),L0(a.id)},className:"ml-2 mr-auto rounded-full p-1 hover:bg-yellow-50 dark:hover:bg-yellow-900/20 cursor-pointer",title:n?"Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©":"ØªØ¹ÙŠÙŠÙ† ÙƒÙ…Ø­ÙØ¸Ø© Ù…ÙØ¶Ù„Ø©",children:e.jsx(qp,{className:`h-4 w-4 ${n?"text-yellow-500 fill-yellow-400 drop-shadow-[0_0_4px_rgba(250,204,21,0.8)]":"text-gray-400"}`})})]})},a.id)})})]})]}):e.jsx("div",{className:"rounded-xl border-2 border-dashed border-gray-200 bg-gray-50 px-3 py-3 text-xs text-gray-600",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†. Ø§Ø¶ØºØ· â€œØ¥Ø¶Ø§ÙØ© Ù…Ø­ÙØ¸Ø©â€ Ù„Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ù…Ø­ÙØ¸Ø©."})]}),e.jsx(ue,{open:g0,onOpenChange:sd,children:e.jsxs(me,{className:"sm:max-w-3xl w-[95vw] sm:w-auto max-h-[80vh] overflow-y-auto",children:[e.jsx(be,{children:e.jsx(pe,{children:"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø§ÙØ¸"})}),e.jsx("div",{className:"mt-2",children:e.jsx(Rw,{showAddButton:!1,showUsageBars:!1,showLimitCards:!1,showEditButton:!0})})]})}),e.jsx(ia,{open:p0,onOpenChange:Pn,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ Ø§Ù„Ù…Ø­Ø§ÙØ¸",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸",onSuccess:()=>{Pn(!1),sd(!0)},userId:t==null?void 0:t.uid,userRole:r==null?void 0:r.role}),e.jsx(km,{isOpen:se,onClose:()=>Ce(!1),wallets:J}),e.jsx(ia,{open:x0,onOpenChange:a=>{yo(a),a||bo(null)},mode:"verify",title:"ØªØ£ÙƒÙŠØ¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",onSuccess:()=>{rd&&(Gr(rd,"walletSelectionPin"),bo(null)),yo(!1)},userId:t==null?void 0:t.uid,userRole:r==null?void 0:r.role}),M&&J.length>0&&(()=>{var O;const a=J.find(V=>V.id===M),n=Ea,o=Ng,c=(je==null?void 0:je.monthlyWithdrawLimit)??(a==null?void 0:a.monthlyWithdrawalLimit)??2e5,u=(je==null?void 0:je.monthlyTransferLimit)??(a==null?void 0:a.monthlyTransferLimit)??2e5,h=(je==null?void 0:je.monthlyWithdrawUsed)??n.totalWithdrawn??0,f=(je==null?void 0:je.monthlyTransferUsed)??n.totalTransferred??0,p=((O=Mt==null?void 0:Mt.subscription)==null?void 0:O.planType)===ta.TAHWEELA,w=p?0:(je==null?void 0:je.dailyWithdrawLimit)??1e5,b=p?0:(je==null?void 0:je.dailyTransferLimit)??6e4,y=p?0:(je==null?void 0:je.dailyWithdrawUsed)??o.totalWithdrawn??0,N=p?0:(je==null?void 0:je.dailyTransferUsed)??o.totalTransferred??0,k=parseFloat(xt||"0")||0,C=h+(B==="withdraw"?k:0),T=f+(B==="transfer"?k:0),R=y+(B==="withdraw"?k:0),_=N+(B==="transfer"?k:0);return a?e.jsxs("div",{className:"mb-2 space-y-2 p-2 bg-gray-50 dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 dark:border-gray-800 pb-1",children:[e.jsx("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-200",children:"Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©"}),e.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 px-2 py-0.5 rounded-full border border-gray-200 dark:border-gray-700",children:Ff||(a==null?void 0:a.name)})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[e.jsx("span",{className:"text-gray-700",children:"Ø³Ø­Ø¨ Ø´Ù‡Ø±ÙŠ"}),e.jsxs("span",{className:"text-gray-600 dir-ltr",children:[Math.max(c-C,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),e.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:e.jsx("div",{className:"h-full bg-gradient-to-l from-red-500 to-red-600 rounded-full transition-all duration-500 ease-out shadow-sm",style:{width:`${Math.min(C/Math.max(c,1)*100,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",C.toLocaleString("en-US",{maximumFractionDigits:0})]}),e.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ø­Ø¯: ",c.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]}),e.jsx("div",{className:"w-[1px] bg-gray-200 self-stretch"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"ØªØ­ÙˆÙŠÙ„ Ø´Ù‡Ø±ÙŠ"}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400 dir-ltr",children:[Math.max(u-T,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),e.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:e.jsx("div",{className:"h-full bg-gradient-to-l from-blue-500 to-blue-600 rounded-full transition-all duration-500 ease-out shadow-sm",style:{width:`${Math.min(T/Math.max(u,1)*100,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",T.toLocaleString("en-US",{maximumFractionDigits:0})]}),e.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ø­Ø¯: ",u.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]})]})]}),e.jsxs("div",{className:"space-y-1 pt-1.5 border-t border-gray-200 dark:border-gray-800",children:[e.jsx("div",{className:"flex items-center justify-between mb-0.5",children:e.jsx("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-200",children:"Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Ø³Ø­Ø¨ ÙŠÙˆÙ…ÙŠ"}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400 dir-ltr",children:[Math.max(w-R,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),e.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:e.jsx("div",{className:"h-full bg-gradient-to-l from-orange-400 to-orange-500 rounded-full transition-all duration-500 ease-out",style:{width:`${Math.min(R/Math.max(w,1)*100,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",R.toLocaleString("en-US",{maximumFractionDigits:0})]}),e.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ø­Ø¯: ",w.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]}),e.jsx("div",{className:"w-[1px] bg-gray-200 dark:bg-gray-800 self-stretch"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"ØªØ­ÙˆÙŠÙ„ ÙŠÙˆÙ…ÙŠ"}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400 dir-ltr",children:[Math.max(b-_,0).toLocaleString("en-US",{maximumFractionDigits:0})," Ù…ØªØ¨Ù‚ÙŠ"]})]}),e.jsx("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner ring-1 ring-gray-200/50 dark:ring-gray-700/50",children:e.jsx("div",{className:"h-full bg-gradient-to-l from-green-500 to-green-600 rounded-full transition-all duration-500 ease-out",style:{width:`${Math.min(_/Math.max(b,1)*100,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ",_.toLocaleString("en-US",{maximumFractionDigits:0})]}),e.jsxs("span",{className:"text-[10px] text-gray-900 dark:text-gray-300 font-medium",children:["Ø§Ù„Ø­Ø¯: ",b.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]})]})]})]}):null})(),B==="transfer"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø³Ù„"}),e.jsxs("div",{className:"relative group",children:[e.jsx(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-green-600 group-focus-within:text-green-700"}),e.jsx(X,{value:Ht,onChange:a=>Rs(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){const n=document.getElementById("receiverPhoneInput");if(n)n.focus();else{const o=document.getElementById("amountInput");o==null||o.focus()}}},placeholder:"01030302038",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-blue-600 focus:ring-1 focus:ring-blue-600 dark:text-gray-100"})]})]}),!l&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„"}),e.jsxs("div",{className:"relative group",children:[e.jsx(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-green-600 group-focus-within:text-green-700"}),e.jsx(X,{id:"receiverPhoneInput",value:kt,onChange:a=>{kr(a.target.value),Po&&Us(!1)},onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const n=document.getElementById("amountInput");n==null||n.focus()}},inputMode:"numeric",maxLength:11,placeholder:"Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-blue-600 focus:ring-1 focus:ring-blue-600 dark:text-gray-100"})]})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„"}),e.jsxs("div",{className:"relative",children:[e.jsx(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-gray-400"}),e.jsx(X,{value:M&&((Wu=J.find(a=>a.id===M))==null?void 0:Wu.phone)||"",readOnly:!0,placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹",className:"pl-10 h-10 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl dark:text-gray-100"})]})]}),B==="transfer"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬Ù†ÙŠÙ‡)"}),e.jsxs("div",{className:"relative flex items-center gap-2 group",children:[e.jsx($a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-yellow-600 group-focus-within:text-yellow-700"}),e.jsx(X,{id:"amountInput",value:xt,onChange:a=>{Ws(a.target.value),Po&&Us(!1)},onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const n=document.getElementById("transferCommissionInput");if(n)n.focus();else{const o=document.getElementById("quickDebtButton");o==null||o.focus()}}},placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",type:"number",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-blue-600 focus:ring-1 focus:ring-blue-600 dark:text-gray-100"})]}),ca?e.jsxs("div",{className:"mt-2 text-xs text-green-700 dark:text-green-400 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-900/30 rounded px-2 py-1 flex items-center gap-2",children:[e.jsxs("span",{children:["ØªÙ… Ø¥Ø¯Ø®Ø§Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø¬Ù„ Ù„Ù€ ",ca.debtorName," Ø¨Ù…Ø¨Ù„Øº ",ca.amount," Ø¬Ù†ÙŠÙ‡"]}),e.jsx(I,{type:"button",variant:"ghost",size:"sm",className:"h-6 px-2",onClick:()=>xo(null),children:"Ø¥Ù„ØºØ§Ø¡"})]}):null]}),(()=>{if(l)return null;const a=nt();return a&&a.defaultTransferCommission!=null?e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ (ØªÙ„Ù‚Ø§Ø¦ÙŠØ©)"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Ø³ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„ÙƒÙ„ Ø£Ù„Ù: ",a==null?void 0:a.defaultTransferCommission," Ø¬Ù†ÙŠÙ‡ Ù„ÙƒÙ„ Ø£Ù„Ù"]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(I,{id:"quickDebtButton",type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium",onClick:()=>{const o=nt(),c=(o==null?void 0:o.defaultTransferCommission)!=null?Number(o.defaultTransferCommission):0,u=parseFloat(xt||"0")||0,h=Math.round((c||0)*u/1e3*100)/100,f=u+h;ms((f||0).toString()),De?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Ls(!0)},children:"Ø£Ø¬Ù„"}),e.jsx(I,{type:"button",variant:"outline",size:"icon",className:"hidden",title:Je?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…",children:Je?e.jsx(Pt,{className:"h-4 w-4 text-green-600"}):e.jsx(Ci,{className:"h-4 w-4 text-red-600"})}),e.jsx("span",{className:"hidden",children:Je?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…"})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (Ø¬Ù†ÙŠÙ‡)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1 group",children:[e.jsx($a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-yellow-600 group-focus-within:text-yellow-700"}),e.jsx(X,{id:"transferCommissionInput",value:Ct,onChange:o=>En(o.target.value),onKeyDown:o=>{if(o.key==="Enter"){o.preventDefault(),o.stopPropagation();const c=document.getElementById("transferExtraFeeInput");if(c)c.focus();else{const u=document.getElementById("transferSubmitButton");u==null||u.click()}}},placeholder:"Ø£Ø¯Ø®Ù„ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„",type:"number",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-orange-500 focus:ring-1 focus:ring-orange-500 dark:text-gray-100"})]}),e.jsx(I,{type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium dark:bg-red-700 dark:hover:bg-red-800",onClick:()=>{const o=nt(),c=parseFloat(xt||"0")||0;let u=0;if((o==null?void 0:o.defaultTransferCommission)!=null){const f=Number(o.defaultTransferCommission)||0;u=Math.round(f*c/1e3*100)/100}else{const f=Ct&&Ct.trim()!==""?parseFloat(Ct):0;u=Math.max(0,f)}const h=c+u;ms((h||0).toString()),De?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Ls(!0)},children:"Ø£Ø¬Ù„"}),e.jsx(I,{type:"button",variant:"outline",size:"icon",className:"hidden",title:Je?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…",children:Je?e.jsx(Pt,{className:"h-4 w-4 text-green-600"}):e.jsx(Ci,{className:"h-4 w-4 text-red-600"})}),e.jsx("span",{className:"hidden",children:Je?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ¶Ø§Ù":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ØªÙØ®ØµÙ…"})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"})]})})(),N0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ø±Ø³ÙˆÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ (Ø¬Ù†ÙŠÙ‡)"}),e.jsxs("div",{className:"relative",children:[e.jsx($a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-yellow-600"}),e.jsx(X,{id:"transferExtraFeeInput",value:nd,onChange:a=>y0(a.target.value),placeholder:"Ø£Ø¯Ø®Ù„ Ø±Ø³ÙˆÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„",type:"number",className:"pl-10 h-10 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 hover:border-blue-400 focus:border-blue-500 dark:text-gray-100"})]}),e.jsx("div",{className:"hidden",children:"ØªÙØ®ØµÙ… Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙˆØªØ¶Ø§Ù Ù„Ù„Ø¯Ø±Ø¬ â€” Ù„Ø¹Ù…Ù„ÙŠØ§Øª 010 â†’ 011/012/015 Ø£Ùˆ 012 â†’ 010 Ø£Ùˆ 011 â†’ 010 Ø£Ùˆ 015 â†’ 010"})]}),e.jsxs("div",{className:"sticky bottom-0 z-20 pt-2 pb-2 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-800 backdrop-blur supports-[backdrop-filter]:bg-white/90 dark:supports-[backdrop-filter]:bg-gray-900/90",children:[e.jsx(I,{id:"transferSubmitButton",onClick:Eu,className:"w-full h-12 text-base font-medium rounded-full bg-blue-600 hover:bg-blue-700 text-white shadow-none hover:shadow-md",children:Po?"ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),b0&&e.jsxs("div",{className:"flex items-start gap-2 mt-2 px-1",children:[e.jsx(Rl,{className:"h-4 w-4 text-amber-500 shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-xs text-gray-500 leading-tight",children:["ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ 85% Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ù…Ø­ÙØ¸Ø© ",vo==null?void 0:vo.walletName]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø­Ø¨ (Ø¬Ù†ÙŠÙ‡)"}),e.jsxs("div",{className:"relative group",children:[e.jsx(rr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-primary"}),e.jsx(X,{id:"amountInput",value:xt,onChange:a=>{Ws(a.target.value),Oo&&Mr(!1)},onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const n=document.getElementById("manualWithdrawCommissionInput");if(n)n.focus();else{const o=document.getElementById("withdrawSubmitButton");o==null||o.focus()}}},placeholder:"Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø­Ø¨",type:"number",className:"pl-10 h-10 text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 focus:border-primary focus:ring-1 focus:ring-primary dark:text-gray-100"})]})]}),v0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø§Ø³Ù… Ø§Ù„Ø±Ø§Ø³Ù„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-gray-500"}),e.jsx(X,{id:"withdrawSenderNameInput",value:Cr,onChange:a=>Zc(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const n=document.getElementById("manualWithdrawCommissionInput");n==null||n.focus()}},placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø±Ø§Ø³Ù„ Ø¥Ù† ÙˆØ¬Ø¯",className:"pl-10 h-10 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 hover:border-blue-400 focus:border-blue-500 dark:text-gray-100",type:"text"})]})]}),(()=>{const a=nt();return a&&a.defaultWithdrawCommission!=null?e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø³Ø­Ø¨ (ØªÙ„Ù‚Ø§Ø¦ÙŠØ©)"}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Ø³ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„ÙƒÙ„ Ø£Ù„Ù: ",a==null?void 0:a.defaultWithdrawCommission," Ø¬Ù†ÙŠÙ‡ Ù„ÙƒÙ„ Ø£Ù„Ù"]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(I,{type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium",onClick:()=>{const o=nt(),c=parseFloat(xt||"0")||0,u=(o==null?void 0:o.defaultWithdrawCommission)!=null&&Number(o.defaultWithdrawCommission)||0,h=Math.round(u*c/1e3*100)/100,f=Je?c+h:c;ms((f||0).toString()),De?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Ls(!0)},children:"Ø£Ø¬Ù„"}),e.jsx(I,{type:"button",variant:da?"default":"outline",size:"sm",className:da?"bg-green-600 hover:bg-green-700 text-white font-medium ring-2 ring-green-400 ring-offset-2":"bg-blue-600 hover:bg-blue-700 text-white font-medium",onClick:()=>Eo(!da),children:da?"Ø¥Ù„ØºØ§Ø¡ Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡":"Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡"})]}),da&&e.jsxs("div",{className:"mt-2 text-sm font-semibold text-green-600 animate-in fade-in slide-in-from-top-1",children:["Ø³ÙŠØªÙ… ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø¹Ù…ÙŠÙ„: ",(()=>{const o=nt(),c=parseFloat(xt||"0")||0,u=(o==null?void 0:o.defaultWithdrawCommission)!=null&&Number(o.defaultWithdrawCommission)||0,h=Math.round(u*c/1e3*100)/100;return Math.round((c-h)*100)/100})()," Ø¬Ù†ÙŠÙ‡"]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø³Ø­Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (Ø¬Ù†ÙŠÙ‡)"}),e.jsxs("div",{className:"relative",children:[e.jsx($a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-1 w-1 text-yellow-600"}),e.jsx(X,{id:"manualWithdrawCommissionInput",value:dt,onChange:o=>On(o.target.value),onKeyDown:o=>{if(o.key==="Enter"){const c=document.getElementById("withdrawSubmitButton");c==null||c.focus()}},placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",type:"number",className:"pl-10 h-10 md:h-11 lg:h-12 text-sm lg:text-base bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-700 shadow-inner rounded-xl focus:bg-white dark:focus:bg-gray-800 hover:border-blue-400 focus:border-blue-500 dark:text-gray-100"})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø³Ø­Ø¨"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(I,{type:"button",variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white font-medium",onClick:()=>{const o=nt(),c=parseFloat(xt||"0")||0;let u=0;if((o==null?void 0:o.defaultWithdrawCommission)!=null){const f=Number(o.defaultWithdrawCommission)||0;u=Math.round(f*c/1e3*100)/100}else{const f=dt&&dt.trim()!==""?parseFloat(dt):Math.round(c*.01*100)/100;u=Math.max(0,f)}const h=Je?c+u:c;ms((h||0).toString()),De?x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ø£Ø¬Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"}):Ls(!0)},children:"Ø£Ø¬Ù„"}),e.jsx(I,{type:"button",variant:da?"default":"outline",size:"sm",className:da?"bg-green-600 hover:bg-green-700 text-white font-medium ring-2 ring-green-400 ring-offset-2":"bg-blue-600 hover:bg-blue-700 text-white font-medium",onClick:()=>Eo(!da),children:da?"Ø¥Ù„ØºØ§Ø¡ Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡":"Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ù‡"})]}),da&&e.jsxs("div",{className:"mt-2 text-sm font-semibold text-green-600 animate-in fade-in slide-in-from-top-1",children:["Ø³ÙŠØªÙ… ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø¹Ù…ÙŠÙ„: ",(()=>{const o=parseFloat(xt||"0")||0,c=dt&&dt.trim()!==""?parseFloat(dt):Math.round(o*.01*100)/100,u=Math.max(0,c);return Math.round((o-u)*100)/100})()," Ø¬Ù†ÙŠÙ‡"]})]})})(),(r==null?void 0:r.showWithdrawNote)&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø³Ø­Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsxs("div",{className:"relative group",children:[e.jsx(Wl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-primary"}),e.jsx(X,{id:"withdrawNoteInput",value:us,onChange:a=>Xc(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const n=document.getElementById("withdrawSubmitButton");n==null||n.focus()}},placeholder:"Ø£Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ø³Ø­Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",className:"pl-10 h-10 text-base border-gray-400 dark:border-gray-600 rounded-xl focus:border-primary focus:ring-1 focus:ring-primary bg-white dark:bg-gray-900 dark:text-gray-100 dark:placeholder:text-gray-400"})]})]}),e.jsx("div",{className:"sticky bottom-0 z-20 pt-2 pb-2 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-800 backdrop-blur supports-[backdrop-filter]:bg-white/90 dark:supports-[backdrop-filter]:bg-gray-900/90",children:e.jsx(I,{id:"withdrawSubmitButton",onClick:Eu,disabled:ur||Oo,className:"w-full font-medium h-11 lg:h-12 text-sm lg:text-base bg-green-600 hover:bg-green-700 text-white disabled:opacity-70 disabled:cursor-not-allowed",children:ur?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°...":Oo?H0||"ØªÙ… Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³Ø­Ø¨"})})]}),e.jsx(ue,{open:ho,onOpenChange:Ls,children:e.jsxs(me,{children:[e.jsxs(be,{children:[e.jsx(pe,{children:"ØªØ­ÙˆÙŠÙ„ Ù…Ø¤Ø¬Ù„"}),e.jsx(at,{children:"Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ø­Ø¨ Ø§Ù„Ø¯ÙŠÙ† ÙˆØ§Ù„Ù…Ø¨Ù„Øº ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø«Ù… Ø§Ø¶ØºØ· Ø­ÙØ¸"})]}),e.jsxs("div",{className:"space-y-3",children:[wt&&wt.length>0?e.jsxs("div",{children:[e.jsx(Q,{children:"Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù…ÙŠÙ„"}),e.jsxs(Wa,{value:po,onValueChange:a=>{h0(a);const n=wt.find(o=>o.id===a);n&&go(n.name)},children:[e.jsx(La,{className:"w-full",children:e.jsx(Fa,{placeholder:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„"})}),e.jsx(Ba,{children:wt.map(a=>e.jsxs(oa,{value:a.id,children:[a.name,a.mobile?` â€” ${a.mobile}`:""]},a.id))})]})]}):e.jsx("div",{className:"text-xs text-gray-500",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…ÙØ³Ø¬Ù„ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹. ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ù…Ù† Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†."}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"quickDebtName",children:"Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ø¯ÙŠÙ†"}),e.jsx(X,{id:"quickDebtName",value:fo,onChange:a=>go(a.target.value),placeholder:"Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù…"})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"quickDebtAmount",children:"Ø§Ù„Ù…Ø¨Ù„Øº (Ù…Ø­Ø³ÙˆØ¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)"}),e.jsx(X,{id:"quickDebtAmount",type:"number",value:m0,readOnly:!0,placeholder:"Ø§Ù„Ù…Ø¨Ù„Øº + Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„"})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"quickDebtCommission",children:"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (Ù…Ø­Ø³ÙˆØ¨Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)"}),e.jsx(X,{id:"quickDebtCommission",type:"number",value:function(){const a=nt(),n=parseFloat((xt||"0").toString())||0;let o=0;if(B==="transfer")if((a==null?void 0:a.defaultTransferCommission)!=null){const c=Number(a.defaultTransferCommission)||0;o=Math.round(c*n/1e3*100)/100}else{const c=Ct&&Ct.trim()!==""?parseFloat(Ct):0;o=Math.max(0,c)}else if((a==null?void 0:a.defaultWithdrawCommission)!=null){const c=Number(a.defaultWithdrawCommission)||0;o=Math.round(c*n/1e3*100)/100}else{const c=dt&&dt.trim()!==""?parseFloat(dt):Math.round(n*.01*100)/100;o=Math.max(0,c)}return String(o||0)}(),readOnly:!0,placeholder:"Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©",className:"dark:bg-gray-800 dark:border-gray-700 dark:text-gray-300"})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"quickDebtNotes",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª"}),e.jsx(X,{id:"quickDebtNotes",value:ed,onChange:a=>td(a.target.value),placeholder:"Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"})]})]}),e.jsx(Fe,{children:e.jsx(I,{type:"button",variant:"default",className:"bg-green-600 text-white hover:bg-green-700",onClick:()=>{const a=nt(),n=parseFloat((xt||"").toString())||0;let o=0;if(B==="transfer")if((a==null?void 0:a.defaultTransferCommission)!=null){const h=Number(a.defaultTransferCommission)||0;o=Math.round(h*n/1e3*100)/100}else{const h=Ct&&Ct.trim()!==""?parseFloat(Ct):0;o=Math.max(0,h)}else if((a==null?void 0:a.defaultWithdrawCommission)!=null){const h=Number(a.defaultWithdrawCommission)||0;o=Math.round(h*n/1e3*100)/100}else{const h=dt&&dt.trim()!==""?parseFloat(dt):Math.round(n*.01*100)/100;o=Math.max(0,h)}let c=0;if(B==="withdraw"?c=Je?n:Math.max(0,Math.round((n-o)*100)/100):c=Math.max(0,Math.round((n+o)*100)/100),!fo||isNaN(c)||c<=0){x({title:"Ø®Ø·Ø£ ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¬Ù„",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­",variant:"destructive"});return}const u=wt.find(h=>h.id===po);xo({debtorName:fo,amount:c,notes:ed,customerId:po||void 0,mobile:u==null?void 0:u.mobile}),ad(!1),Ls(!1),x({title:"ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¬Ù„",description:"Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙŠÙ† Ø¹Ù†Ø¯ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",variant:"default"})},children:"Ø­ÙØ¸"})})]})})]})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mt-8 fade-in-up w-full",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>Ne("https://www.youtube.com/watch?v=CRHOlK3LZas","Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙˆØ§Ù„Ø³Ø­Ø¨ Ø§Ù„ÙŠØ¯ÙˆÙŠ"),className:"flex-1 min-w-[200px] max-w-sm h-9 text-xs justify-center bg-white text-indigo-600 border-indigo-200 hover:bg-indigo-50 shadow-sm",children:[e.jsx(Ai,{className:"h-3.5 w-3.5 ml-1.5"}),"Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙˆØ§Ù„Ø³Ø­Ø¨ Ø§Ù„ÙŠØ¯ÙˆÙŠ"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>Ne("https://www.youtube.com/watch?v=1_h1iFLDBaY","Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±"),className:"flex-1 min-w-[200px] max-w-sm h-9 text-xs justify-center bg-white text-emerald-600 border-emerald-200 hover:bg-emerald-50 shadow-sm",children:[e.jsx(Ai,{className:"h-3.5 w-3.5 ml-1.5"}),"Ø´Ø±Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±"]})]})]})]}),e.jsx(bw,{isOpen:O0,onClose:()=>E0(!1),initialEditingWallet:R0,onWalletUpdate:async()=>{try{await Tl()}catch(a){console.error("Error reloading wallets after update:",a)}}}),e.jsx(vw,{isOpen:B0,onClose:()=>fd(!1),transaction:F0,onDelete:Pl}),e.jsx(ia,{open:z0,onOpenChange:Pr,onSuccess:jg,title:Sg(),description:Dg(),mode:"verify",userId:t==null?void 0:t.uid,userRole:r==null?void 0:r.role}),e.jsx(Dm,{open:Uf,onOpenChange:su,onSuccess:Cg,title:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬",currentBalance:qe,balanceLabel:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ",userId:t==null?void 0:t.uid}),e.jsx(Dm,{open:Vf,onOpenChange:ru,onSuccess:Ig,title:"ØªØ¹Ø¯ÙŠÙ„ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",currentBalance:Yt&&Se[Yt]||0,balanceLabel:`Ø±ØµÙŠØ¯ ${((Lu=J.find(a=>a.id===Yt))==null?void 0:Lu.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©"}`,userId:t==null?void 0:t.uid}),e.jsx(kw,{open:qf,onOpenChange:ll,onSuccess:_g,title:"Ø¥Ø¶Ø§ÙØ© Ø£Ùˆ Ø®ØµÙ… Ù…Ø¨Ù„Øº Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙˆØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡ Ø£Ùˆ Ø®ØµÙ…Ù‡ Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",currentBalance:Yt&&Se[Yt]||0,balanceLabel:`Ø±ØµÙŠØ¯ ${((Fu=J.find(a=>a.id===Yt))==null?void 0:Fu.name)||"Ø§Ù„Ù…Ø­ÙØ¸Ø©"}`,userId:t==null?void 0:t.uid}),e.jsx(Nw,{open:ag,onOpenChange:sg,userId:t==null?void 0:t.uid}),e.jsx(jw,{open:rg,onOpenChange:ng,userId:t==null?void 0:t.uid}),e.jsx(Sw,{open:ig,onOpenChange:og}),e.jsx(ue,{open:Kf,onOpenChange:si,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(pe,{className:"text-right",children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"})}),e.jsxs("div",{className:"space-y-1 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{htmlFor:"amount",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(X,{id:"amount",type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:dl,onChange:a=>ri(a.target.value),className:"text-right flex-1",dir:"rtl",min:"0"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(I,{type:"button",size:"sm",className:"bg-green-600 hover:bg-green-700 text-white px-3 py-2",onClick:async()=>{if(!await vi(Nl)){x({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}const a=parseFloat(dl);if(isNaN(a)||a<=0){x({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const n=qe+a;ot(n);const o={cashBalance:n,lastUpdated:new Date().toISOString()},c=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(c,JSON.stringify(o)),t!=null&&t.uid?oe.updateUserData(t.uid,o).then(()=>{console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø±ØµÙŠØ¯ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­"),localStorage.removeItem(c),ve(!1)}).catch(u=>{console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø±ØµÙŠØ¯ ÙÙŠ Firebase:",u),ve(!0)}):ve(!0),x({title:"ØªÙ… Ø¨Ù†Ø¬Ø§Ø­",description:`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${a} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙˆØ­ÙØ¸Ù‡ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©`}),si(!1),ri(""),ci("")},children:[e.jsx(Pt,{className:"h-1 w-1 mr-1"}),"Ø¥Ø¶Ø§ÙØ©"]}),e.jsxs(I,{id:"confirm-deduct-cash-btn",type:"button",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2",onClick:async()=>{if(!await vi(Nl)){x({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}const a=parseFloat(dl);if(isNaN(a)||a<=0){x({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const n=qe-a;ot(n);const o={cashBalance:n,lastUpdated:new Date().toISOString()},c=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(c,JSON.stringify(o)),t!=null&&t.uid?oe.updateUserData(t.uid,o).then(()=>{console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø±ØµÙŠØ¯ Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­"),localStorage.removeItem(c),ve(!1)}).catch(u=>{console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø±ØµÙŠØ¯ ÙÙŠ Firebase:",u),ve(!0)}):ve(!0),x({title:"ØªÙ… Ø¨Ù†Ø¬Ø§Ø­",description:`ØªÙ… Ø®ØµÙ… ${a} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø§Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙˆØ­ÙØ¸Ù‡ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©`}),si(!1),ri(""),ci("")},children:[e.jsx(Ci,{className:"h-1 w-1 mr-1"}),"Ø®ØµÙ…"]})]})]}),e.jsxs("p",{className:"text-[10px] text-gray-500 text-right",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",qe.toLocaleString()," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{htmlFor:"pin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ"}),e.jsx(X,{id:"pin",type:"password",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",value:Nl,onChange:a=>ci(a.target.value),onKeyDown:a=>{if(a.key==="Enter"){a.preventDefault(),a.stopPropagation();const n=document.getElementById("confirm-deduct-cash-btn");n&&n.click()}},className:"text-right",dir:"rtl"})]})]}),e.jsx(Fe,{className:"flex gap-2",children:e.jsx(I,{variant:"outline",onClick:()=>{si(!1),ri(""),ci("")},children:"Ø¥Ù„ØºØ§Ø¡"})})]})}),e.jsx(ue,{open:hg,onOpenChange:xi,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(pe,{className:"text-right text-red-600",children:"ØªØµÙÙŠØ± Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©"})}),e.jsxs("div",{className:"space-y-1 py-4",children:[e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-red-800 font-medium mb-2",children:"ØªØ­Ø°ÙŠØ±!"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Ø³ÙŠØªÙ… ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø¥Ù„Ù‰ ØµÙØ±. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."}),e.jsxs("p",{className:"text-red-600 text-sm mt-2",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",J.reduce((a,n)=>a+(Number(Se[n.id])||0),0).toLocaleString()," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{htmlFor:"resetWalletTotalPin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"}),e.jsx(X,{id:"resetWalletTotalPin",type:"password",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",value:_u,onChange:a=>yi(a.target.value),onKeyDown:a=>{var n;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(n=document.getElementById("confirm-reset-wallet-total-btn"))==null||n.click())},className:"text-right",dir:"rtl"})]})]}),e.jsxs(Fe,{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>{xi(!1),yi("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{id:"confirm-reset-wallet-total-btn",variant:"destructive",onClick:async()=>{if(!await Bt.verifyMasterPin(_u,t==null?void 0:t.uid)){x({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}try{const n={};Object.keys(Se).forEach(h=>{n[h]=0}),mt(n),localStorage.setItem(Ge(),JSON.stringify(n)),xi(!1),yi("");const o=new Date().toISOString(),c={walletBalances:n,lastUpdated:o},u=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(u,JSON.stringify(c)),t!=null&&t.uid?oe.updateUserData(t.uid,c).then(()=>{localStorage.removeItem(u),ve(!1)}).catch(h=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",h),ve(!0),x({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù‚Ø±ÙŠØ¨Ø§Ù‹",variant:"default"})}):ve(!0),setTimeout(()=>{mt({...n})},100)}catch(n){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸:",n),x({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸",variant:"destructive"})}},children:"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})]})]})}),e.jsx(ue,{open:zf,onOpenChange:ti,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(pe,{className:"text-right text-red-600",children:"ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©"})}),e.jsxs("div",{className:"space-y-1 py-4",children:[e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-red-800 font-medium mb-2",children:"ØªØ­Ø°ÙŠØ±!"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Ø³ÙŠØªÙ… ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ø¥Ù„Ù‰ ØµÙØ±. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."}),e.jsxs("p",{className:"text-red-600 text-sm mt-2",children:["Ø§Ù„Ù…Ø­ÙØ¸Ø©: ",((Bu=J.find(a=>a.id===M))==null?void 0:Bu.name)||M]}),e.jsxs("p",{className:"text-red-600 text-sm",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",(M&&Se[M]?Se[M]:0).toLocaleString()," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{htmlFor:"resetSelectedWalletPin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"}),e.jsx(X,{id:"resetSelectedWalletPin",type:"password",autoComplete:"off",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",value:nu,onChange:a=>cl(a.target.value),onKeyDown:a=>{var n;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(n=document.getElementById("confirm-reset-selected-wallet-btn"))==null||n.click())},className:"text-right",dir:"rtl"})]})]}),e.jsxs(Fe,{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>{ti(!1),cl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{id:"confirm-reset-selected-wallet-btn",variant:"destructive",onClick:async()=>{var n;if(!M){x({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}if(!await Bt.verifyMasterPin(nu,t==null?void 0:t.uid)){x({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}try{const o={...Se};o[M]=0,mt(o),localStorage.setItem(Ge(),JSON.stringify(o)),ti(!1),cl("");const c=new Date().toISOString(),u={walletBalances:o,lastUpdated:c},h=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(h,JSON.stringify(u)),t!=null&&t.uid?oe.updateUserData(t.uid,u).then(()=>{localStorage.removeItem(h),ve(!1)}).catch(f=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",f),ve(!0),x({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù‚Ø±ÙŠØ¨Ø§Ù‹",variant:"default"})}):ve(!0),x({title:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ø¨Ù†Ø¬Ø§Ø­",description:`ØªÙ… ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© ${((n=J.find(f=>f.id===M))==null?void 0:n.name)||M}`})}catch(o){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:",o),x({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµÙÙŠØ± Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©",variant:"destructive"})}},children:"ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©"})]})]})}),e.jsx(km,{isOpen:se,onClose:()=>Ce(!1),wallets:J}),e.jsx(ue,{open:dg,onOpenChange:fi,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsxs(pe,{className:"text-right text-green-600 flex items-center gap-2 justify-end",children:[e.jsx(Pt,{className:"h-4 w-4"}),"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„ Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø©"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("p",{className:"text-green-800 font-medium mb-2",children:"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„"}),e.jsx("p",{className:"text-green-700 text-sm",children:"Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø¥Ù„Ù‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø¨Ø´ÙƒÙ„ Ù…ØªÙ†Ø§Ø³Ø¨ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙØ¸."}),e.jsxs("p",{className:"text-green-600 text-sm mt-2",children:["Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: ",J.reduce((a,n)=>a+(Number(Se[n.id])||0),0).toLocaleString()," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"addWalletTotalAmount",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡"}),e.jsx(X,{id:"addWalletTotalAmount",type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:bu,onChange:a=>Sl(a.target.value),className:"text-right",dir:"rtl"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"addWalletTotalPin",className:"text-right block",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„ØªØ£ÙƒÙŠØ¯"}),e.jsx(X,{id:"addWalletTotalPin",type:"password",autoComplete:"off",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",value:vu,onChange:a=>Dl(a.target.value),onKeyDown:a=>{var n;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(n=document.getElementById("confirm-add-wallet-total-btn"))==null||n.click())},className:"text-right",dir:"rtl"})]})]})]}),e.jsxs(Fe,{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>{fi(!1),Sl(""),Dl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{id:"confirm-add-wallet-total-btn",variant:"default",className:"bg-green-600 hover:bg-green-700",disabled:wu,onClick:async()=>{const a=parseFloat(bu);if(!a||a<=0){x({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}if(!await xg(vu)){x({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}Nu(!0);try{const n=J.reduce((c,u)=>c+(Number(Se[u.id])||0),0),o={...Se};if(n===0){if(J.length>0){const c=a/J.length;J.forEach(u=>{o[u.id]=(Number(o[u.id])||0)+c})}}else J.forEach(c=>{const u=Number(Se[c.id])||0,h=u/n,f=a*h;o[c.id]=u+f});mt(o),localStorage.setItem(Ge(),JSON.stringify(o)),t!=null&&t.uid?await oe.updateUserData(t.uid,{walletBalances:o,lastUpdated:new Date().toISOString()}):ve(!0),setTimeout(()=>{mt(c=>({...c}))},100),fi(!1),Sl(""),Dl("")}catch(n){console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙÙŠ Firebase:",n),x({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",variant:"destructive"})}finally{Nu(!1)}},children:wu?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©...":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù…ÙˆØ§Ù„"})]})]})}),e.jsx(ue,{open:fg,onOpenChange:bi,children:e.jsxs(me,{className:"sm:max-w-[425px]",children:[e.jsx(be,{children:e.jsxs(pe,{className:"text-red-600 flex items-center gap-2",children:[e.jsx(Na,{className:"h-1 w-1"}),"ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ"]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-red-700",children:"âš ï¸ ØªØ­Ø°ÙŠØ±: Ø³ÙŠØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬ Ø¥Ù„Ù‰ ØµÙØ±. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{htmlFor:"resetCashPin",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"}),e.jsx(X,{id:"resetCashPin",type:"password",autoComplete:"off",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",value:kl,onChange:a=>Cl(a.target.value),onKeyDown:a=>{var n;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(n=document.getElementById("confirm-reset-cash-btn"))==null||n.click())}})]})]}),e.jsxs(Fe,{children:[e.jsx(I,{variant:"outline",onClick:()=>{bi(!1),Cl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{id:"confirm-reset-cash-btn",variant:"destructive",onClick:async()=>{if(!kl){x({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}if(!await Bt.verifyMasterPin(kl,t==null?void 0:t.uid)){x({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}try{ot(0),bi(!1),Cl("");const n={cashBalance:0,lastUpdated:new Date().toISOString()};localStorage.setItem(Ye(),"0"),localStorage.setItem(Ye()+"_lastUpdated",n.lastUpdated);const o=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(o,JSON.stringify(n)),t!=null&&t.uid?oe.updateUserData(t.uid,n).then(()=>{localStorage.removeItem(o),ve(!1)}).catch(c=>{console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø±ØµÙŠØ¯ ÙÙŠ Firebase:",c),ve(!0),x({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"ØªÙ… Ø§Ù„ØªØµÙÙŠØ± Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù‚Ø±ÙŠØ¨Ø§Ù‹",variant:"default"})}):ve(!0)}catch(n){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ:",n),x({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ",variant:"destructive"})}},children:"ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯"})]})]})}),e.jsx(_w,{open:cg,onOpenChange:yu,userId:t==null?void 0:t.uid,cashBalance:qe,walletBalances:Se,transactions:he}),e.jsx(ue,{open:lg,onOpenChange:Kr,children:e.jsxs(me,{className:"sm:max-w-[425px]",children:[e.jsx(be,{children:e.jsxs(pe,{className:"text-green-600 flex items-center gap-2",children:[e.jsx(Pt,{className:"h-4 w-4"}),"Ø¥Ø¶Ø§ÙØ© Ø£Ù…ÙˆØ§Ù„ Ù„Ù„Ø¯Ø±Ø¬"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-green-700",children:"ðŸ’° Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"addCashAmount",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡"}),e.jsx(X,{id:"addCashAmount",type:"number",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº",value:xs,onChange:a=>di(a.target.value),min:"0",step:"0.01"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{className:"text-right",children:"Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{type:"button",variant:Hr==="yes"?"default":"outline",onClick:()=>Qr("yes"),className:"flex-1",children:"Ù†Ø¹Ù…"}),e.jsx(I,{type:"button",variant:Hr==="no"?"default":"outline",onClick:async()=>{if(Qr("no"),!xs||parseFloat(xs)<=0){x({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±",variant:"destructive"});return}if(!Jr){x({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}if(!await vi(Jr)){x({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}mi(!0);try{const a=parseFloat(xs),n=qe+a;ot(n);const o=new Date().toISOString();localStorage.setItem(Ye(),n.toString()),localStorage.setItem(Ye()+"_lastUpdated",o);const c={cashBalance:n,lastUpdated:o},u=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(u,JSON.stringify(c));const h=`CASHADD-${(t==null?void 0:t.uid)||"anon"}-${Date.now()}`;Kr(!1),di(""),ui(""),Qr(null),hi("");const f=[];if(t!=null&&t.uid){f.push(oe.updateUserData(t.uid,c).then(()=>{localStorage.removeItem(u),ve(!1)}).catch(()=>{ve(!0)}));const p={txnType:"cash_addition",type:"cash_addition",amount:a,status:"confirmed",senderMsisdn:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",receiverMsisdn:"",reference:h,title:"Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",merchantUserId:t.uid,createdBy:t.uid,shopId:(r==null?void 0:r.shopId)||void 0};f.push(oe.saveUserTransaction(t.uid,p));const w=r==null?void 0:r.shopId;if(w){const b=Pe($,"dashboardData",w);f.push(ea(b,{cashBalance:n}))}}Promise.allSettled(f).then(()=>{}).catch(()=>{})}catch{ot(qe),localStorage.setItem("cashBalance",qe.toString()),x({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",variant:"destructive"})}finally{mi(!1)}},className:"flex-1",children:"Ù„Ø§"})]})]}),Hr==="yes"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"addCashNote",children:"Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©"}),e.jsx(X,{id:"addCashNote",type:"text",placeholder:"Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©",value:jl,onChange:a=>hi(a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"addCashPin",children:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ø¯Ø±Ø¬ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),e.jsx(X,{id:"addCashPin",type:"password",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",value:Jr,onChange:a=>ui(a.target.value),onKeyDown:a=>{var n;a.key==="Enter"&&(a.preventDefault(),a.stopPropagation(),(n=document.getElementById("confirm-add-cash-btn"))==null||n.click())}})]})]}),e.jsxs(Fe,{children:[e.jsx(I,{variant:"outline",onClick:()=>{Kr(!1),di(""),ui(""),Qr(null),hi("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{id:"confirm-add-cash-btn",variant:"default",className:"bg-green-600 hover:bg-green-700",disabled:xu,onClick:async()=>{if(!xs||parseFloat(xs)<=0){x({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±",variant:"destructive"});return}if(!Jr){x({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ",variant:"destructive"});return}if(!await vi(Jr)){x({title:"Ø®Ø·Ø£",description:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­",variant:"destructive"});return}if(Hr==="yes"&&jl.trim().length===0){x({title:"ØªÙ†Ø¨ÙŠÙ‡",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø£Ùˆ Ø§Ø®ØªØ± Ù„Ø§",variant:"destructive"});return}mi(!0);try{const a=parseFloat(xs),n=qe+a;ot(n);const o=new Date().toISOString();localStorage.setItem(Ye(),n.toString()),localStorage.setItem(Ye()+"_lastUpdated",o);const c={cashBalance:n,lastUpdated:o},u=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(u,JSON.stringify(c));const h=`CASHADD-${(t==null?void 0:t.uid)||"anon"}-${Date.now()}`;Kr(!1),di(""),ui(""),Qr(null),hi("");const f=[];if(t!=null&&t.uid){f.push(oe.updateUserData(t.uid,c).then(()=>{localStorage.removeItem(u),ve(!1)}).catch(()=>{ve(!0)}));const p={txnType:"cash_addition",type:"cash_addition",amount:a,status:"confirmed",senderMsisdn:"Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",receiverMsisdn:"",reference:h,note:Hr==="yes"?jl.trim():void 0,title:"Ø¥ÙŠØµØ§Ù„ Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø¯ÙŠØ©",merchantUserId:t.uid,createdBy:t.uid,shopId:(r==null?void 0:r.shopId)||void 0};f.push(oe.saveUserTransaction(t.uid,p));const w=r==null?void 0:r.shopId;if(w){const b=Pe($,"dashboardData",w);f.push(ea(b,{cashBalance:n}))}}Promise.allSettled(f).then(()=>{}).catch(()=>{})}catch{ot(qe),localStorage.setItem("cashBalance",qe.toString()),x({title:"Ø®Ø·Ø£",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",variant:"destructive"})}finally{mi(!1)}},children:xu?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©...":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ù…ÙˆØ§Ù„"})]})]})}),e.jsx(ue,{open:$f,onOpenChange:ol,children:e.jsxs(me,{className:"sm:max-w-md",children:[e.jsx(be,{children:e.jsx(pe,{className:"text-right",children:"Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª Ù„Ù„Ø¨Ø­Ø«"})}),e.jsxs("div",{className:"space-y-1 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{htmlFor:"search-date",className:"text-right block",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx(X,{id:"search-date",type:"date",value:Fn,onChange:a=>bd(a.target.value),className:"text-right"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{htmlFor:"search-time",className:"text-right block",children:"Ø§Ù„ÙˆÙ‚Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx(X,{id:"search-time",type:"time",value:Bn,onChange:a=>vd(a.target.value),className:"text-right",placeholder:"Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª Ù„Ù„Ø¨Ø­Ø« ÙÙŠ Ø³Ø§Ø¹Ø© Ù…Ø­Ø¯Ø¯Ø©"}),e.jsx("p",{className:"text-[10px] text-gray-500 text-right",children:"Ø¥Ø°Ø§ Ù„Ù… ØªØ®ØªØ± ÙˆÙ‚ØªØ§Ù‹ Ù…Ø­Ø¯Ø¯Ø§Ù‹ØŒ Ø³ÙŠØªÙ… Ø§Ù„Ø¨Ø­Ø« ÙÙŠ ÙƒØ§Ù…Ù„ Ø§Ù„ÙŠÙˆÙ…"})]})]}),e.jsxs(Fe,{className:"flex justify-between",children:[e.jsx(I,{variant:"outline",onClick:()=>{bd(""),vd(""),ol(!1)},children:"Ù…Ø³Ø­"}),e.jsx(I,{onClick:()=>ol(!1),children:"ØªØ·Ø¨ÙŠÙ‚"})]})]})}),e.jsx(Cw,{isOpen:af,onClose:()=>Lo(!1)}),e.jsx(sm,{isOpen:ye,onClose:()=>vt(!1),userId:(t==null?void 0:t.uid)||"",userEmail:(t==null?void 0:t.email)||""}),e.jsx(Iw,{isOpen:Co,onClose:()=>$s(!1),initialBarcode:T0}),e.jsx(Aw,{isOpen:lf,onClose:()=>Wr(!1)}),e.jsx(Ew,{open:cf,onOpenChange:Lr}),e.jsx(Mw,{open:df,onOpenChange:a=>{if(a&&!Xt){x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"ÙŠÙˆÙ…ÙŠØ© Ø§Ù„Ù…ÙƒÙ†Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.",variant:"destructive"});return}Fr(a)}}),e.jsx(Fw,{open:Ah,onOpenChange:a=>{if(a&&!Xt){x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒÙƒ.",variant:"destructive"});return}mr(a)}}),e.jsx(Bw,{open:Th,onOpenChange:a=>{if(a&&!Xt){x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª: Ø´Ù‡Ø±ÙŠØŒ Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØŒ Ø³Ù†ÙˆÙŠØŒ ÙˆÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒÙƒ.",variant:"destructive"});return}Ph(a)}}),e.jsx(ia,{open:Hf,onOpenChange:uu,onSuccess:()=>hl(!0),title:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ",mode:"verify",userId:t==null?void 0:t.uid,userRole:r==null?void 0:r.role}),e.jsx(ue,{open:ml,onOpenChange:hl,children:e.jsxs(me,{className:"sm:max-w-xl",children:[e.jsxs(be,{children:[e.jsxs(pe,{className:"flex items-center gap-2",children:[e.jsx(Bl,{className:"h-4 w-4 text-blue-600"}),"ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…"]}),e.jsx(at,{children:"Ù…Ù„Ø®Øµ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ… Ù…Ø­ÙÙˆØ¸ Ù„Ø¢Ø®Ø± 30 ÙŠÙˆÙ…Ù‹Ø§ Ù…Ø¹ Ø£Ø±Ø´ÙØ© ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©"})]}),e.jsxs("div",{className:"space-y-4",children:[(()=>{const a=new Date().toDateString(),n=he.filter(p=>{const w=new Date(p.createdAt).toDateString(),b=String(p.status||"completed").toLowerCase();return w===a&&(b==="completed"||b==="confirmed")}),o=n.length,c=n.reduce((p,w)=>p+Number(w.amount||0),0),u=n.filter(p=>p.type==="withdraw").reduce((p,w)=>p+Number(w.amount||0),0),h=n.filter(p=>p.type==="send").reduce((p,w)=>p+Number(w.amount||0),0),f=n.reduce((p,w)=>p+Number(Ot.calculateTransactionProfit(w)||0),0);return e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-blue-50 to-slate-100 border",children:[e.jsx("div",{className:"text-xs text-blue-700",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),e.jsx("div",{className:"text-lg font-bold text-blue-800",children:o})]}),e.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-indigo-50 to-slate-100 border",children:[e.jsx("div",{className:"text-xs text-indigo-700",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº"}),e.jsx("div",{className:"text-lg font-bold text-indigo-800",children:Number(c).toFixed(2)})]}),e.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-red-50 to-slate-100 border",children:[e.jsx("div",{className:"text-xs text-red-700",children:"Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø©"}),e.jsx("div",{className:"text-lg font-bold text-red-800",children:Number(u).toFixed(2)})]}),e.jsxs("div",{className:"rounded-lg p-3 bg-gradient-to-r from-green-50 to-slate-100 border",children:[e.jsx("div",{className:"text-xs text-green-700",children:"Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ù…Ø±Ø³Ù„Ø©"}),e.jsx("div",{className:"text-lg font-bold text-green-800",children:Number(h).toFixed(2)})]}),e.jsxs("div",{className:"col-span-2 rounded-lg p-3 bg-gradient-to-r from-amber-50 to-slate-100 border",children:[e.jsx("div",{className:"text-xs text-amber-700",children:"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),e.jsx("div",{className:"text-lg font-bold text-amber-800",children:Number(f).toFixed(2)})]})]})})(),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{variant:"default",onClick:async()=>{try{if(!(t!=null&&t.uid))return;const a=new Date,n=a.getFullYear(),o=String(a.getMonth()+1).padStart(2,"0"),c=String(a.getDate()).padStart(2,"0"),u=`${n}-${o}-${c}`,h=a.toDateString(),f=he.filter(k=>{const C=new Date(k.createdAt).toDateString(),T=String(k.status||"completed").toLowerCase();return C===h&&(T==="completed"||T==="confirmed")}),p=f.length,w=f.reduce((k,C)=>k+Number(C.amount||0),0),b=f.filter(k=>k.type==="withdraw").reduce((k,C)=>k+Number(C.amount||0),0),y=f.filter(k=>k.type==="send").reduce((k,C)=>k+Number(C.amount||0),0),N=f.reduce((k,C)=>k+Number(Ot.calculateTransactionProfit(C)||0),0);await tn.add({userId:t.uid,reportDate:u,totalTransactions:p,totalAmount:Number(w.toFixed(2)),totalWithdrawn:Number(b.toFixed(2)),totalSent:Number(y.toFixed(2)),profit:Number(N.toFixed(2)),walletId:null});try{await tn.trimToMaxCount(t.uid,30)}catch{}x({title:"ØªÙ… Ø§Ù„Ø£Ø±Ø´ÙØ©",description:`ØªÙ… Ø­ÙØ¸ ØªÙ‚Ø±ÙŠØ± ${u}`})}catch{x({title:"ÙØ´Ù„ Ø§Ù„Ø£Ø±Ø´ÙØ©",description:"ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ±",variant:"destructive"})}},children:"Ø£Ø±Ø´ÙØ© Ø§Ù„ÙŠÙˆÙ…"}),e.jsx(I,{variant:"outline",onClick:()=>hl(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})]}),e.jsx("div",{className:"mt-2 border-t pt-2",children:e.jsx("div",{className:"space-y-2 max-h-[40vh] overflow-auto",children:mu.length===0?e.jsx("div",{className:"text-xs text-muted-foreground",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø­ÙÙˆØ¸Ø©"}):mu.map(a=>e.jsxs("div",{className:"border rounded-md p-2 bg-gradient-to-r from-white/80 to-blue-50/70",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-bold text-blue-800",children:a.reportDate}),e.jsxs("div",{className:"text-xs text-blue-700",children:["Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª: ",a.totalTransactions]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-1",children:[e.jsxs("div",{className:"text-xs text-blue-800",children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº: ",e.jsx("span",{className:"font-semibold",children:Number(a.totalAmount).toFixed(2)})]}),e.jsxs("div",{className:"text-xs text-blue-800",children:["Ø§Ù„Ù…Ø³Ø­ÙˆØ¨: ",e.jsx("span",{className:"font-semibold",children:Number(a.totalWithdrawn).toFixed(2)})]}),e.jsxs("div",{className:"text-xs text-blue-800",children:["Ø§Ù„Ù…Ø±Ø³Ù„: ",e.jsx("span",{className:"font-semibold",children:Number(a.totalSent).toFixed(2)})]}),e.jsxs("div",{className:"text-xs text-blue-800",children:["Ø§Ù„Ø±Ø¨Ø­: ",e.jsx("span",{className:"font-semibold",children:Number(a.profit??0).toFixed(2)})]})]})]},a.id||`${a.userId}-${a.reportDate}`))})})]})]})}),e.jsx(ue,{open:Jf,onOpenChange:a=>{if(a){x({title:"Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±",description:"Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹."});return}ul(!1)},children:e.jsxs(me,{dir:"rtl",className:"sm:max-w-md w-[95vw] sm:w-auto rounded-2xl border border-emerald-200 shadow-xl bg-gradient-to-br from-white via-green-50 to-emerald-50 backdrop-blur-md data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-90 data-[state=open]:slide-in-from-bottom-8 duration-300",children:[e.jsxs(be,{children:[e.jsx(pe,{className:"text-right text-green-700",children:"Ø´Ø­Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),e.jsx(at,{className:"text-right text-gray-600",children:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø«Ù… Ø§Ø¶ØºØ· ØªØ£ÙƒÙŠØ¯"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"topupPhone",className:"text-right block",children:"Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),e.jsx(X,{id:"topupPhone",value:ni,onChange:a=>iu(a.target.value),placeholder:"010xxxxxxx",className:"text-right"})]}),e.jsxs("div",{children:[e.jsx(Q,{className:"text-right block",children:"Ø´Ø±ÙƒØ© Ø§Ù„ØªØ´ØºÙŠÙ„"}),e.jsxs(Wa,{value:ii,onValueChange:ou,children:[e.jsx(La,{className:"text-right",children:e.jsx(Fa,{placeholder:"Ø§Ø®ØªØ± Ø§Ù„Ø´Ø±ÙƒØ©"})}),e.jsxs(Ba,{children:[e.jsx(oa,{value:"vodafone",children:"ÙÙˆØ¯Ø§ÙÙˆÙ†"}),e.jsx(oa,{value:"orange",children:"Ø£ÙˆØ±Ù†Ø¬"}),e.jsx(oa,{value:"etisalat",children:"Ø§ØªØµØ§Ù„Ø§Øª"}),e.jsx(oa,{value:"we",children:"WE"})]})]})]}),e.jsxs("div",{children:[e.jsx(Q,{htmlFor:"topupAmount",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡"}),e.jsx(X,{id:"topupAmount",type:"number",value:oi,onChange:a=>lu(a.target.value?Number(a.target.value):""),placeholder:"50",className:"text-right"})]})]}),e.jsxs(Fe,{className:"flex gap-2 justify-between",children:[e.jsx(I,{variant:"outline",onClick:()=>ul(!1),className:"border-gray-300",children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{onClick:_h,disabled:cu||!ni||!ii||!oi,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:cu?"Ø¬Ø§Ø±Ù Ø§Ù„ØªÙ†ÙÙŠØ°...":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø´Ø­Ù†"})]})]})}),e.jsx(ia,{open:vf,onOpenChange:$o,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ÙØªØ­ Ø§Ù„Ø¯ÙŠÙˆÙ†",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†",className:"!bg-[#0f172a] !text-slate-100 border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",onSuccess:()=>{$o(!1),Vs(!0)},userId:t==null?void 0:t.uid,userRole:r==null?void 0:r.role}),e.jsx(ia,{open:Nf,onOpenChange:Ed,mode:"verify",title:"ØªØ£ÙƒÙŠØ¯ ØªØºÙŠÙŠØ± Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ø¯ÙŠÙˆÙ†",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ØªÙØ¹ÙŠÙ„ Ø£Ùˆ Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ø¯ÙŠÙˆÙ†",userId:t==null?void 0:t.uid,userRole:r==null?void 0:r.role,onSuccess:async()=>{if(Md!==null){const a=Md;Od(a);try{const n=t==null?void 0:t.uid,o=n?`debtsPinRequired_${n}`:"debtsPinRequired";localStorage.setItem(o,String(a)),n&&await oe.updateUserData(n,{debtsPinRequired:a})}catch{}x({title:a?"ØªÙ… ØªÙØ¹ÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ø¯ÙŠÙˆÙ†":"ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ø¯ÙŠÙˆÙ†",description:a?"Ø³ÙŠÙØ·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†.":"ÙŠÙ…ÙƒÙ† ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙŠÙˆÙ† Ø¨Ø¯ÙˆÙ† Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ."})}jf(null),Ed(!1)}}),e.jsx(Dw,{open:Yf,onOpenChange:ai,title:"ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶",description:"Ø³ÙŠØªÙ… Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù…Ù† Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙÙ‚Ø·ØŒ ÙˆÙ„Ù† ØªÙØ­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ Ù…Ù† Ø­Ø³Ø§Ø¨Ùƒ Ø£Ùˆ Ù…Ù† Firebase.",onSuccess:async()=>{try{if(!(t!=null&&t.uid)){ai(!1);return}const a=new Date,n=c=>c instanceof Date?c:typeof(c==null?void 0:c.toDate)=="function"?c.toDate():new Date(String(c)),o=he.filter(c=>n(c.createdAt)<a);await oe.updateUserData(t.uid,{recentReset:{keepLastCount:Su.keepLastCount??30,intervalDays:Su.intervalDays??7,lastResetAt:a}}),gi(c=>({...c,lastResetAt:a})),x({title:"ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©",description:"ØªÙ… Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø£Ù‚Ø¯Ù… Ù…Ù† ÙˆÙ‚Øª Ø§Ù„ØªØµÙÙŠØ± Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ø¯ÙˆÙ† Ø§Ù„ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…/Ø§Ù„Ø´Ù‡Ø± Ø£Ùˆ Ø§Ù„Ø­Ø¯ÙˆØ¯."})}catch(a){console.error("ÙØ´Ù„ ØªÙ†ÙÙŠØ° Ø§Ù„ØªØµÙÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:",a),x({title:"ÙØ´Ù„ Ø§Ù„ØªØµÙÙŠØ±",description:"ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø«Ù… Ø£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.",variant:"destructive"})}finally{ai(!1)}}}),e.jsx(ia,{open:r0,onOpenChange:Ts,mode:"verify",title:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù„ÙØªØ­ Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„ÙØªØ­ Ù†Ø§ÙØ°Ø© Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„",onSuccess:()=>{Ts(!1),ds(!0)},userId:t==null?void 0:t.uid,userRole:r==null?void 0:r.role}),e.jsx(ue,{open:_a,onOpenChange:ks,children:e.jsx(me,{className:"w-full h-full max-w-full max-h-full p-0 m-0 rounded-none border-none",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx(I,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 z-50 bg-white/50 dark:bg-black/50 hover:bg-white dark:hover:bg-black/80 rounded-full",onClick:()=>ks(!1),children:e.jsx(ln,{className:"h-6 w-6"})}),e.jsx("iframe",{src:"https://naweshop.com/login",className:"w-full h-full border-none",title:"NaweShop Login"})]})})}),e.jsx(ue,{open:bf,onOpenChange:Vs,children:e.jsxs(me,{className:"sm:max-w-[425px] border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[e.jsxs(be,{className:"flex items-center justify-between",children:[e.jsx(pe,{className:"text-right",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†"}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-emerald-700",children:[e.jsx("span",{className:"text-[10px] font-bold",children:"Ù„ÙŠÙ†Ø§:"}),e.jsxs("span",{className:"text-xs font-bold",children:[Ru.creditor," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-red-700",children:[e.jsx("span",{className:"text-[10px] font-bold",children:"Ø¹Ù„ÙŠÙ†Ø§:"}),e.jsxs("span",{className:"text-xs font-bold",children:[Ru.debtor," Ø¬Ù†ÙŠÙ‡"]})]})]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>Fd(va==="debtor"?null:"debtor"),className:Da("w-full transition-all duration-200",va==="debtor"?"bg-red-600 hover:bg-red-700 text-white border-red-600":"border-red-200 text-red-700 hover:bg-red-50 hover:text-red-800"),children:"Ø¹Ù„ÙŠÙ†Ø§"}),e.jsx(I,{variant:"outline",onClick:()=>Fd(va==="creditor"?null:"creditor"),className:Da("w-full transition-all duration-200",va==="creditor"?"bg-emerald-600 hover:bg-emerald-700 text-white border-emerald-600":"border-emerald-200 text-emerald-700 hover:bg-emerald-50 hover:text-emerald-800"),children:"Ù„ÙŠÙ†Ø§"})]}),(va==="creditor"||va==="debtor")&&e.jsxs(e.Fragment,{children:[va==="creditor"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Q,{htmlFor:"debtorName",className:"text-right col-span-1",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†"}),e.jsx(X,{id:"debtorName",value:Uo,onChange:a=>Vo(a.target.value),className:"col-span-3 text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Q,{htmlFor:"customerSelect",className:"text-right col-span-1",children:"Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù…ÙŠÙ„"}),e.jsxs(Wa,{value:Qa,onValueChange:a=>{Go(a);const n=wt.find(o=>o.id===a);n&&Vo(n.name)},children:[e.jsx(La,{className:"col-span-3 text-right",dir:"rtl",children:e.jsx(Fa,{placeholder:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†"})}),e.jsx(Ba,{className:"text-right",dir:"rtl",children:wt.length>0?wt.map(a=>e.jsxs(oa,{value:a.id,className:"text-right",children:[a.name," ",a.mobile?`(${a.mobile})`:""]},a.id)):e.jsx("div",{className:"p-2 text-center text-gray-500 text-sm",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ø³Ø¬Ù„ÙŠÙ†"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Q,{htmlFor:"debtAmount",className:"text-right col-span-1",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx(X,{id:"debtAmount",type:"text",inputMode:"decimal",value:qo,onChange:a=>Rd(Ir(a.target.value)),className:"col-span-3 text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Q,{htmlFor:"debtReason",className:"text-right col-span-1",children:"Ø³Ø¨Ø¨ Ø§Ù„Ø¯ÙŠÙ†"}),e.jsx(X,{id:"debtReason",value:Wd,onChange:a=>Ld(a.target.value),className:"col-span-3 text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø³Ø¨Ø¨ Ø§Ù„Ø¯ÙŠÙ†"})]})]})]}),e.jsx(Fe,{children:e.jsx(I,{onClick:()=>{const a=va==="debtor";if(!a&&!(va==="creditor")){x({title:"Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙŠÙ†",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¯ÙŠÙ† Ø£Ùˆ Ø¯Ø§Ø¦Ù† Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}const o=a?Uo||"Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…":Uo;if(!qo||!o){x({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù…Ø¨Ù„Øº",variant:"destructive"});return}const c={id:Date.now().toString(),debtorName:o,amount:parseFloat(qo),reason:Wd||"",status:"pending",createdAt:new Date,paidAmount:0,partialPayments:[],type:va||"creditor"};qr(c),Ys(!0)},className:"bg-orange-500 hover:bg-orange-600",children:"Ø­ÙØ¸"})}),e.jsx("div",{className:"mt-2",children:e.jsx(I,{variant:"outline",className:"w-full",onClick:()=>fs(!0),children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†"})}),e.jsx("div",{className:"mt-2",children:e.jsx(I,{variant:"outline",className:"w-full",onClick:()=>Yo(!0),children:"Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„"})}),e.jsx("div",{className:"mt-2",children:e.jsxs(I,{variant:"outline",className:"w-full text-rose-600 border-rose-200 hover:bg-rose-50 dark:border-rose-900/30 dark:text-rose-400 dark:hover:bg-rose-900/20",onClick:()=>Ne("https://www.youtube.com/watch?v=v55ziGGuCWc","Ø´Ø±Ø­ Ù‚Ø³Ù… Ø§Ù„Ø¯ÙŠÙˆÙ† ÙˆØ§Ù„Ø§Ø¬Ù„ (ÙÙŠØ¯ÙŠÙˆ)"),children:[e.jsx(Ai,{className:"h-4 w-4 ml-2"}),"Ø´Ø±Ø­ Ù‚Ø³Ù… Ø§Ù„Ø¯ÙŠÙˆÙ† ÙˆØ§Ù„Ø§Ø¬Ù„ (ÙÙŠØ¯ÙŠÙˆ)"]})})]})}),e.jsx(ue,{open:zo,onOpenChange:fs,children:e.jsxs(me,{className:"w-[95vw] sm:w-auto sm:max-w-[520px] rounded-2xl border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[e.jsxs(be,{children:[e.jsx(pe,{className:"text-right",children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†"}),e.jsx(at,{className:"text-right",children:"Ø§Ø®ØªØ± Ø¯ÙŠÙ†Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ø¥ÙŠØµØ§Ù„Ù‡ Ø¨Ø§Ù„ØªÙØµÙŠÙ„"})]}),e.jsx("div",{className:"px-1 mb-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(nm,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"}),e.jsx(X,{placeholder:"Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ø¨Ù„Øº...",value:Vr,onChange:a=>Kd(a.target.value),className:"pr-9 text-right"})]})}),Re.length>0?e.jsxs("div",{className:"max-h-[60vh] overflow-y-auto overscroll-contain scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400 space-y-2 px-1 -mx-1 sm:mx-0 sm:px-0",style:{contain:"layout paint"},onScroll:a=>{const n=a.currentTarget;Qn.length<Hn.length&&n.scrollTop+n.clientHeight>=n.scrollHeight-50&&Jn(o=>o+1)},children:[Qn.length>0?Qn.map(a=>e.jsx("div",{onClick:()=>{$r(a),Ha(!0),fs(!1),Vs(!1)},className:`p-4 sm:p-3 border rounded-xl cursor-pointer hover:bg-gray-50 transition-colors min-h-[64px] ${a.type==="debtor"?"border-r-4 border-r-red-500 bg-red-50/10":"border-r-4 border-r-emerald-500"}`,children:e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"text-right space-y-0.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium text-[14px] sm:text-sm",children:a.debtorName}),a.type==="debtor"&&e.jsx(Ma,{variant:"destructive",className:"h-5 text-[10px] px-1",children:"Ø¹Ù„ÙŠÙ†Ø§"}),(!a.type||a.type==="creditor")&&e.jsx(Ma,{variant:"outline",className:"h-5 text-[10px] px-1 text-emerald-700 border-emerald-200 bg-emerald-50",children:"Ù„Ù†Ø§"})]}),e.jsx("p",{className:"text-[13px] sm:text-sm text-gray-600",children:a.reason}),e.jsx("p",{className:"text-[12px] sm:text-sm text-gray-500",children:en.format(a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt))})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("p",{className:"font-bold text-xl sm:text-lg",children:[Number(Number(a.amount||0)-Number(a.paidAmount||0)).toFixed(2)," Ø¬Ù†ÙŠÙ‡"]}),e.jsx(Ma,{variant:a.status==="paid"?"default":"secondary",className:`${a.status==="paid"?"bg-green-500":"bg-yellow-500"} text-[12px] sm:text-xs`,children:a.status==="paid"?"Ù…Ø¯ÙÙˆØ¹":"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"})]})]})},a.id)):e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ø¨Ø­Ø«"})}),Qn.length<Hn.length&&e.jsx("div",{className:"flex justify-center pt-1",children:e.jsx(I,{variant:"outline",size:"sm",onClick:()=>Jn(a=>a+1),children:"ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯"})})]}):e.jsx("div",{className:"text-center text-sm text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙŠÙˆÙ† Ù…Ø³Ø¬Ù„Ø©"}),e.jsxs(Fe,{className:"flex justify-between mt-3",children:[e.jsx(I,{variant:"destructive",onClick:async()=>{try{if(!Re||Re.length===0){x({title:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙŠÙˆÙ†",description:"Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙØ§Ø±ØºØ© Ø¨Ø§Ù„ÙØ¹Ù„."});return}if(!window.confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù ÙƒÙ„ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†ØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡."))return;const n=[];if(zt(n),$r(null),await Oa(n),t!=null&&t.uid)try{await oe.updateUserData(t.uid,{debts:[],debtsDeletedAt:ft()});try{localStorage.removeItem(`debts_unsynced_${t.uid}`)}catch{}}catch(o){console.error("ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ø¯ÙŠÙˆÙ† Ù…Ù† Firebase:",o),x({title:"ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©",description:"ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª Ù…Ù† FirebaseØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"});return}x({title:"ØªÙ… Ø­Ø°Ù ÙƒÙ„ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†",description:"ØªÙ… ØªÙØ±ÙŠØº Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„."}),fs(!1)}catch(a){console.error("ØªØ¹Ø°Ø± Ø­Ø°Ù ÙƒÙ„ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙˆÙ†:",a),x({title:"ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù",description:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°ÙØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",variant:"destructive"})}},children:"Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª"}),e.jsx(I,{variant:"outline",onClick:()=>fs(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})]})]})}),e.jsx(ue,{open:jo,onOpenChange:j0,children:e.jsxs(me,{className:"max-w-2xl h-[80vh] flex flex-col p-0",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[e.jsxs(be,{className:"p-4 border-b",children:[e.jsx(pe,{children:"Ø³Ø¬Ù„ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙˆÙ†"}),e.jsx(at,{children:"Ø¹Ø±Ø¶ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®"})]}),e.jsxs("div",{className:"p-4 border-b bg-gray-50 dark:bg-gray-900 flex flex-col sm:flex-row gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(Q,{children:"Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø­Ø«"}),e.jsxs("div",{className:"flex bg-white dark:bg-gray-800 rounded-md border p-1",children:[e.jsx("button",{onClick:()=>cd("day"),className:`flex-1 px-3 py-1.5 text-sm rounded-sm transition-colors ${hs==="day"?"bg-purple-100 text-purple-700 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"ÙŠÙˆÙ…ÙŠ"}),e.jsx("button",{onClick:()=>cd("month"),className:`flex-1 px-3 py-1.5 text-sm rounded-sm transition-colors ${hs==="month"?"bg-purple-100 text-purple-700 font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Ø´Ù‡Ø±ÙŠ"})]})]}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(Q,{children:hs==="day"?"Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…":"Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±"}),e.jsx(X,{type:hs==="day"?"date":"month",value:hs==="day"?Fs:Fs.substring(0,7),onChange:a=>D0(a.target.value),className:"bg-white dark:bg-gray-800"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 mb-1",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØªØ±Ø©"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:Ft(So.reduce((a,n)=>a+(n.amount||0),0))})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-0",children:So.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-gray-500",children:[e.jsx(am,{className:"h-12 w-12 mb-2 opacity-20"}),e.jsx("p",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø³Ø¯Ø§Ø¯ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©"})]}):e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"grid grid-cols-3 bg-gray-50 dark:bg-gray-900 p-3 text-sm font-medium text-gray-500 border-b",children:[e.jsx("div",{className:"text-right",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx("div",{className:"text-right",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†"}),e.jsx("div",{className:"text-right",children:"Ø§Ù„Ù…Ø¨Ù„Øº"})]}),e.jsx("div",{className:"divide-y dark:divide-gray-800",children:So.map(a=>{var n;return e.jsxs("div",{className:"grid grid-cols-3 p-3 items-center hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx("div",{className:"text-sm text-gray-500 font-mono",children:(n=a.createdAt)!=null&&n.seconds?new Date(a.createdAt.seconds*1e3).toLocaleString("ar-EG"):"Ø§Ù„Ø¢Ù†"}),e.jsx("div",{className:"font-medium",children:a.debtorName}),e.jsx("div",{className:"font-bold text-green-600",children:Ft(a.amount)})]},a.id)})})]})})]})}),e.jsx(ue,{open:_f,onOpenChange:Yo,children:e.jsxs(me,{className:"sm:max-w-[500px] w-full max-h-[90vh] overflow-hidden flex flex-col p-0 gap-0 !bg-[#0f172a] !text-slate-100 border border-slate-800 shadow-2xl",overlayClassName:"backdrop-blur-[5px] bg-black/10 !dark:bg-black",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800 bg-[#0f172a]",children:[e.jsxs(be,{children:[e.jsx(pe,{className:"text-right flex items-center justify-end",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(nn,{className:"w-5 h-5 text-primary"}),"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ø¯ÙŠÙˆÙ†"]})}),e.jsx(at,{className:"text-right",children:"Ø³Ø¬Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ø¯ÙŠÙˆÙ† Ø¨Ø³Ù‡ÙˆÙ„Ø©"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",dir:"rtl",children:[e.jsx(I,{variant:zs==="customers_list"?"default":"outline",onClick:()=>Ko("customers_list"),size:"sm",className:"flex-1 text-xs h-8",children:"Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†"}),e.jsx(I,{variant:zs==="add_debt"?"default":"outline",onClick:()=>Ko("add_debt"),size:"sm",className:"flex-1 text-xs h-8",children:"ØªØ³Ø¬ÙŠÙ„ Ø¯ÙŠÙ†"}),e.jsx(I,{variant:zs==="add_customer"?"default":"outline",onClick:()=>Ko("add_customer"),size:"sm",className:"flex-1 text-xs h-8",children:"Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[zs==="add_customer"&&e.jsxs(Za,{className:"border shadow-sm bg-white dark:bg-card dark:border-gray-800",children:[e.jsx(ws,{className:"pb-2 pt-4 px-4",children:e.jsxs(Ns,{className:"text-sm font-medium text-right text-gray-700 dark:text-gray-200 flex items-center justify-end gap-2",children:[e.jsx(Pt,{className:"w-4 h-4"}),"Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯"]})}),e.jsxs(es,{className:"p-4 pt-2 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{className:"text-right block text-xs text-gray-500 dark:text-gray-400",children:"Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„"}),e.jsx(X,{value:Ho,onChange:a=>Jd(a.target.value),className:"text-right h-9 dark:bg-gray-900 dark:border-gray-700",placeholder:"Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{className:"text-right block text-xs text-gray-500 dark:text-gray-400",children:"Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),e.jsx(X,{value:Qo,onChange:a=>Hd(a.target.value),className:"text-right h-9 dark:bg-gray-900 dark:border-gray-700",placeholder:"Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"})]}),e.jsxs(I,{className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white h-9 mt-2",onClick:async()=>{if(!Ho||!Qo){x({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„",variant:"destructive"});return}const a={id:Date.now().toString(),name:Ho.trim(),mobile:Qo.trim(),createdAt:new Date},n=[a,...wt];await yl(n),Jd(""),Hd(""),x({title:"ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„",description:`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${a.name}`})},children:[e.jsx(Pt,{className:"w-4 h-4 mr-2"}),"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„"]})]})]}),zs==="add_debt"&&e.jsxs(Za,{className:"border shadow-sm bg-white dark:bg-card dark:border-gray-800",children:[e.jsx(ws,{className:"pb-2 pt-4 px-4",children:e.jsxs(Ns,{className:"text-sm font-medium text-right text-gray-700 dark:text-gray-200 flex items-center justify-end gap-2",children:[e.jsx($a,{className:"w-4 h-4 text-orange-600"}),"ØªØ³Ø¬ÙŠÙ„ Ù…Ø¨Ù„Øº Ø¯ÙŠÙ†"]})}),e.jsx(es,{className:"p-4 pt-2 space-y-3",children:wt.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{className:"text-right block text-xs text-gray-500 dark:text-gray-400",children:"Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…ÙŠÙ„"}),e.jsxs(Wa,{value:Qa,onValueChange:Go,children:[e.jsx(La,{className:"w-full h-9 text-right dark:bg-gray-900 dark:border-gray-700",dir:"rtl",children:e.jsx(Fa,{placeholder:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„"})}),e.jsx(Ba,{className:"dark:bg-gray-900 dark:border-gray-800",children:wt.map(a=>e.jsxs(oa,{value:a.id,className:"text-right justify-end",children:[a.name," â€” ",a.mobile]},a.id))})]}),Qa&&(()=>{const a=Re.filter(n=>n.customerId===Qa&&n.status==="pending").reduce((n,o)=>n+(o.amount-(o.paidAmount||0)),0);return e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx(I,{variant:"ghost",size:"sm",className:"h-6 text-xs text-blue-600 hover:text-blue-700 hover:bg-blue-50 px-2",onClick:()=>{Rf(Qa),al(!0)},children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø¯ÙŠÙˆÙ†Ù‡"}),a>0&&e.jsxs("div",{className:"text-xs text-red-600 font-semibold text-right",children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙŠÙˆÙ† Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ",a.toFixed(2)," Ø¬Ù†ÙŠÙ‡"]})]})})()]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Q,{className:"text-right block text-xs text-gray-500",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx(X,{type:"number",value:Qd,onChange:a=>Af(a.target.value),className:"text-right h-9",placeholder:"0.00"})]}),e.jsx(I,{className:"w-full bg-orange-600 hover:bg-orange-700 text-white h-9 mt-2",onClick:async()=>{const a=parseFloat(Qd);if(!Qa){x({title:"Ø§Ø®ØªØ± Ø¹Ù…ÙŠÙ„",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹",variant:"destructive"});return}if(isNaN(a)||a<=0){x({title:"Ù‚ÙŠÙ…Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const n=wt.find(c=>c.id===Qa);if(!n)return;const o={id:Date.now().toString(),debtorName:n.name,customerId:n.id,mobile:n.mobile,amount:Number(a.toFixed(2)),reason:"Ø¯ÙŠÙ† Ø¹Ù…ÙŠÙ„",status:"pending",createdAt:new Date,paidAmount:0,partialPayments:[]};qr(o),Ys(!0)},children:"Ù…ØªØ§Ø¨Ø¹Ø© ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº"})]}):e.jsx("div",{className:"text-center py-4 text-gray-500 text-sm bg-gray-50 rounded border border-dashed",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ø³Ø¬Ù„ÙŠÙ†. Ø£Ø¶Ù Ø¹Ù…ÙŠÙ„Ø§Ù‹ Ø£ÙˆÙ„Ø§Ù‹."})})]}),zs==="customers_list"&&e.jsxs(Za,{className:"border shadow-sm bg-white dark:bg-card dark:border-gray-800",children:[e.jsx(ws,{className:"pb-2 pt-4 px-4",children:e.jsxs(Ns,{className:"text-sm font-medium text-right text-gray-700 dark:text-gray-200 flex items-center justify-end gap-2",children:[e.jsx(um,{className:"w-4 h-4"}),"Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† (",wt.length,")"]})}),e.jsx(es,{className:"p-4 pt-2",children:wt.length>0?e.jsx("div",{className:"space-y-2",children:wt.map(a=>e.jsxs("div",{className:"p-3 border rounded-lg flex items-center justify-between bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors dark:border-gray-700",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8 text-blue-600 hover:text-blue-700 hover:bg-blue-50",onClick:()=>{Gd(a.id),Xo(a.name||""),Zo(a.mobile||""),Xn(!0)},children:e.jsx(cm,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>{el(a.id),tl(a.name||""),Zn(!0)},children:e.jsx(Na,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:a.name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono",children:a.mobile})]})]},a.id))}):e.jsx("div",{className:"text-center py-4 text-gray-400 text-sm",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§"})})]})]}),e.jsx(Fe,{className:"p-4 border-t bg-white dark:bg-card dark:border-gray-800",children:e.jsx(I,{variant:"outline",className:"w-full sm:w-auto dark:bg-gray-800 dark:text-white dark:border-gray-700 dark:hover:bg-gray-700",onClick:()=>Yo(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(ue,{open:Mf,onOpenChange:al,children:e.jsxs(me,{className:"sm:max-w-[500px] max-h-[80vh] overflow-hidden flex flex-col p-0 gap-0",children:[e.jsx("div",{className:"p-4 border-b bg-white dark:bg-card dark:border-gray-800",children:e.jsxs(be,{children:[e.jsxs(pe,{className:"text-right flex items-center justify-end gap-2 dark:text-gray-100",children:[e.jsx(Si,{className:"w-5 h-5 text-blue-600"}),"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„"]}),e.jsx(at,{className:"text-right dark:text-gray-400",children:($u=wt.find(a=>a.id===sl))==null?void 0:$u.name})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50/50 dark:bg-black/50",children:[Re.filter(a=>a.customerId===sl).sort((a,n)=>new Date(n.createdAt).getTime()-new Date(a.createdAt).getTime()).map(a=>e.jsxs("div",{className:"p-3 border rounded-lg bg-white dark:bg-card dark:border-gray-700 shadow-sm flex justify-between items-center",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-sm dark:text-gray-100",children:[Number(Number(a.amount||0)-Number(a.paidAmount||0)).toFixed(2)," Ø¬Ù†ÙŠÙ‡"]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:a.reason}),e.jsx(Ma,{variant:a.status==="paid"?"default":"secondary",className:`mt-1 h-5 text-[10px] ${a.status==="paid"?"bg-green-500":"bg-yellow-500 text-yellow-950"}`,children:a.status==="paid"?"Ù…Ø¯ÙÙˆØ¹":"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"})]}),e.jsxs("div",{className:"text-left text-xs text-gray-400 flex flex-col items-end gap-1",children:[e.jsx("div",{className:"font-mono",children:en.format(new Date(a.createdAt))}),e.jsx("div",{className:"font-mono",children:new Date(a.createdAt).toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit"})})]})]},a.id)),Re.filter(a=>a.customerId===sl).length===0&&e.jsxs("div",{className:"text-center text-gray-500 py-8 flex flex-col items-center gap-2",children:[e.jsx(Si,{className:"w-8 h-8 text-gray-300"}),e.jsx("span",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥ÙŠØµØ§Ù„Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„"})]})]}),e.jsx(Fe,{className:"p-4 border-t bg-white dark:bg-card dark:border-gray-800",children:e.jsx(I,{variant:"outline",className:"w-full dark:bg-gray-800 dark:text-white dark:border-gray-700 dark:hover:bg-gray-700",onClick:()=>al(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(ue,{open:Of,onOpenChange:Zn,children:e.jsxs(me,{hideClose:!0,className:"sm:max-w-[420px] rounded-2xl bg-gradient-to-br from-white via-rose-50 to-red-50 dark:from-gray-900 dark:via-red-950/30 dark:to-red-900/10 shadow-2xl border border-red-100 dark:border-red-900/50 text-center",children:[e.jsxs(be,{children:[e.jsx(pe,{className:"text-center text-xl font-bold text-red-700 dark:text-red-400",children:"ØªØ£ÙƒÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„"}),e.jsxs(at,{className:"text-center text-gray-600 dark:text-gray-300",children:["Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§: ",eu]})]}),e.jsx("div",{className:"py-2 text-sm text-gray-700 dark:text-gray-400",children:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡."}),e.jsxs(Fe,{className:"flex justify-center gap-3",children:[e.jsx(I,{variant:"outline",onClick:()=>{Zn(!1),el(""),tl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{variant:"destructive",className:"bg-red-600 hover:bg-red-700",onClick:async()=>{const a=Ef,n=wt.filter(o=>o.id!==a);await yl(n),Qa===a&&Go(""),Zn(!1),el(""),tl(""),x({title:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…ÙŠÙ„",description:eu})},children:"Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ"})]})]})}),e.jsx(ue,{open:Tf,onOpenChange:Xn,children:e.jsxs(me,{className:"sm:max-w-[420px]",children:[e.jsx(be,{children:e.jsx(pe,{className:"text-right",children:"ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Q,{htmlFor:"editCustomerName",className:"text-right col-span-1",children:"Ø§Ù„Ø§Ø³Ù…"}),e.jsx(X,{id:"editCustomerName",value:Xd,onChange:a=>Xo(a.target.value),className:"col-span-3 text-right"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Q,{htmlFor:"editCustomerMobile",className:"text-right col-span-1",children:"Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"}),e.jsx(X,{id:"editCustomerMobile",value:Zd,onChange:a=>Zo(a.target.value),className:"col-span-3 text-right"})]})]}),e.jsxs(Fe,{className:"flex justify-between",children:[e.jsx(I,{variant:"outline",onClick:()=>Xn(!1),children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{const a=Pf,n=Xd.trim(),o=Zd.trim();if(!a||!n||!o){x({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„",variant:"destructive"});return}const c=wt.map(h=>h.id===a?{...h,name:n,mobile:o}:h);await yl(c);const u=Re.map(h=>h.customerId===a?{...h,debtorName:n,mobile:o}:h);u!==Re&&(zt(u),await Oa(u)),Xn(!1),Gd(""),Xo(""),Zo(""),x({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù…ÙŠÙ„",description:n})},children:"Ø­ÙØ¸"})]})]})}),e.jsx(ue,{open:s0,onOpenChange:ds,children:e.jsxs(me,{className:"sm:max-w-[520px]",children:[e.jsxs(be,{children:[e.jsx(pe,{className:"text-right",children:"Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø­Ù„"}),e.jsx(at,{className:"text-right",children:"Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ØµØ±ÙˆÙ Ø«Ù… Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø®ØµÙ…."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Q,{htmlFor:"expenseName",className:"text-right col-span-1",children:"Ø§Ø³Ù… Ø§Ù„Ù…ØµØ±ÙˆÙ"}),e.jsx(X,{id:"expenseName",value:kn,onChange:a=>Fc(a.target.value),className:"col-span-3 text-right",placeholder:"Ù…Ø«Ø§Ù„: ÙƒÙ‡Ø±Ø¨Ø§Ø¡ØŒ ØµÙŠØ§Ù†Ø©ØŒ Ù…Ø´ØªØ±ÙŠØ§Øª"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Q,{htmlFor:"expenseAmount",className:"text-right col-span-1",children:"ØªÙ…Ù† Ø§Ù„Ù…ØµØ±ÙˆÙ"}),e.jsx(X,{id:"expenseAmount",type:"number",value:so,onChange:a=>Bc(a.target.value),className:"col-span-3 text-right",placeholder:"0.00"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Q,{htmlFor:"expenseNotes",className:"text-right col-span-1",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª"}),e.jsx(X,{id:"expenseNotes",value:ro,onChange:a=>$c(a.target.value),className:"col-span-3 text-right",placeholder:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¥Ù† ÙˆØ¬Ø¯Øª"})]})]}),e.jsxs(Fe,{className:"flex justify-between",children:[e.jsx(I,{className:"bg-orange-600 hover:bg-orange-700",onClick:()=>{if(!kn||!so){x({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ØµØ±ÙˆÙ ÙˆÙ‚ÙŠÙ…ØªÙ‡",variant:"destructive"});return}In(!0)},children:"Ø¥Ø¶Ø§ÙØ© Ù…ØµØ±ÙˆÙ"}),e.jsx(I,{variant:"outline",onClick:()=>oo(!0),children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ"})]})]})}),e.jsx(ue,{open:i0,onOpenChange:oo,children:e.jsxs(me,{className:"sm:max-w-[420px]",dir:"rtl",children:[e.jsxs(be,{children:[e.jsx(pe,{className:"text-right",children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ"}),e.jsx(at,{className:"text-right",children:"Ø¢Ø®Ø± Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©"})]}),Cn.length>0?e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Cn.map(a=>e.jsx("div",{className:"p-2 border rounded-lg bg-white dark:bg-card dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-sm dark:text-gray-200",children:a.name}),e.jsx("p",{className:"text-[11px] text-gray-600 dark:text-gray-400",children:a.notes||"Ø¨Ø¯ÙˆÙ† Ù…Ù„Ø§Ø­Ø¸Ø§Øª"}),e.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-500",children:new Date(a.createdAt).toLocaleString("ar-EG")})]}),e.jsxs("div",{className:"text-left flex items-start gap-2",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("p",{className:"font-bold text-sm dark:text-gray-200",children:[a.amount," Ø¬Ù†ÙŠÙ‡"]}),e.jsx(Ma,{variant:"secondary",className:a.source==="cash"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",children:a.source==="cash"?"Ù…Ù† Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©":`Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©${a.walletId?` (${a.walletId})`:""}`})]}),e.jsxs(I,{variant:"destructive",size:"sm",className:"shrink-0",onClick:()=>Xf(a.id),title:"Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ",children:[e.jsx(Na,{className:"w-4 h-4 ml-1"}),"Ø­Ø°Ù"]})]})]})},a.id))}):e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØµØ§Ø±ÙŠÙ Ù…Ø³Ø¬Ù„Ø© Ø¨Ø¹Ø¯"})]})}),e.jsx(ue,{open:n0,onOpenChange:In,children:e.jsxs(me,{className:"sm:max-w-[480px]",children:[e.jsx(be,{children:e.jsx(pe,{className:"text-right",children:"Ø§Ø®ØªÙŠØ§Ø± Ù…ØµØ¯Ø± Ø®ØµÙ… Ø§Ù„Ù…ØµØ±ÙˆÙ"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-right",children:"Ø§Ø®ØªØ± Ù‡Ù„ ØªØ±ÙŠØ¯ Ø®ØµÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØµØ±ÙˆÙ Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬ Ø£Ù… Ù…Ù† Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸."}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(I,{variant:St==="cash"?"default":"outline",className:St==="cash"?"bg-blue-600 hover:bg-blue-700 text-white":"",onClick:()=>vr("cash"),children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),e.jsx(I,{variant:St==="wallet"?"default":"outline",className:St==="wallet"?"bg-purple-600 hover:bg-purple-700 text-white":"",onClick:()=>vr("wallet"),children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),e.jsx(I,{variant:St==="fawry"?"default":"outline",className:St==="fawry"?"bg-amber-600 hover:bg-amber-700 text-white":"",onClick:()=>vr("fawry"),children:"ÙÙˆØ±ÙŠ"})]}),St==="wallet"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{className:"text-right block",children:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…"}),e.jsxs(Wa,{value:Ps,onValueChange:io,children:[e.jsx(La,{className:"w-full",children:e.jsx(Fa,{placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©"})}),e.jsx(Ba,{children:J.map(a=>e.jsx(oa,{value:a.id,children:a.phone||a.name||a.id},a.id))})]})]})]}),e.jsxs(Fe,{className:"flex justify-between",children:[e.jsx(I,{variant:"outline",onClick:()=>{In(!1),vr(null),io("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{const a=Number(so);if(isNaN(a)||a<=0){x({title:"Ù‚ÙŠÙ…Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}if(!St){x({title:"Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø®ØµÙ…",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}try{if(St==="cash"){const u=Number((qe-a).toFixed(2));ot(u),localStorage.setItem(Ye(),u.toString());const h={cashBalance:u,lastUpdated:new Date().toISOString()},f=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(f,JSON.stringify(h)),t!=null&&t.uid?(await oe.updateUserData(t.uid,h),localStorage.removeItem(f),ve(!1)):ve(!0)}else if(St==="wallet"){if(!Ps){x({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…",variant:"destructive"});return}const u=Se[Ps]||0,h=Number((u-a).toFixed(2)),f={...Se,[Ps]:h};mt(f);const p=new Date().toISOString(),w={walletBalances:f,lastUpdated:p},b=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(b,JSON.stringify(w)),localStorage.setItem(Ge(),JSON.stringify(f)),localStorage.setItem(`walletBalances_backup_${p}`,JSON.stringify(f)),t!=null&&t.uid&&oe.updateUserData(t.uid,w).catch(()=>{})}}catch(u){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø¹Ù†Ø¯ Ø­ÙØ¸ Ø§Ù„Ù…ØµØ±ÙˆÙ:",u)}let n=Date.now().toString();try{if(t!=null&&t.uid){const{addDoc:u,collection:h,serverTimestamp:f}=await re(async()=>{const{addDoc:b,collection:y,serverTimestamp:N}=await import("./index-CHyvkdwe.js").then(k=>k.cF);return{addDoc:b,collection:y,serverTimestamp:N}},__vite__mapDeps([0,1]),import.meta.url),{db:p}=await re(async()=>{const{db:b}=await import("./index-CHyvkdwe.js").then(y=>y.cG);return{db:b}},__vite__mapDeps([0,1]),import.meta.url);n=(await u(h(p,"shop_expenses"),{userId:t.uid,shopId:j||(r==null?void 0:r.shopId)||t.uid||"default-shop",name:kn,amount:a,notes:ro||"",source:St,walletId:St==="wallet"?Ps:null,createdAt:f()})).id}}catch(u){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…ØµØ±ÙˆÙ ÙÙŠ Firestore:",u)}const o={id:n,name:kn,amount:a,notes:ro,source:St,walletId:St==="wallet"?Ps:void 0,createdAt:new Date},c=[...Cn,o];await fu(c),Fc(""),Bc(""),$c(""),vr(null),io(""),In(!1),ds(!0),oo(!0),x({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ØµØ±ÙˆÙ",description:St==="cash"?"ØªÙ… Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©":St==="wallet"?"ØªÙ… Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸":"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± ÙÙˆØ±ÙŠ"})},children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø®ØµÙ…"})]})]})}),e.jsx(ue,{open:l0,onOpenChange:wr,children:e.jsxs(me,{className:"sm:max-w-[520px]",children:[e.jsxs(be,{children:[e.jsx(pe,{className:"text-right",children:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"}),e.jsx(at,{className:"text-right",children:"Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Ø§Ù‚ØµØ© Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ø´Ø±Ø§Ø¡ ÙˆØªØ§Ø¨Ø¹ Ø­Ø§Ù„ØªÙ‡Ø§."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Q,{htmlFor:"deficiencyName",className:"text-right col-span-1",children:"Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±"}),e.jsx(X,{id:"deficiencyName",value:Nr,onChange:a=>lo(a.target.value),className:"col-span-3 text-right",placeholder:"Ù…Ø«Ø§Ù„: Ø³ÙƒØ±ØŒ Ø²ÙŠØªØŒ Ù…Ù†Ø§Ø¯ÙŠÙ„"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(Q,{htmlFor:"deficiencyQuantity",className:"text-right col-span-1",children:"Ø§Ù„ÙƒÙ…ÙŠØ©"}),e.jsx(X,{id:"deficiencyQuantity",type:"number",value:Uc,onChange:a=>co(a.target.value),className:"col-span-3 text-right",placeholder:"1"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(I,{className:"bg-rose-600 hover:bg-rose-700",onClick:()=>{if(De){x({title:"ØºÙŠØ± Ù…ØªØ§Ø­",description:"Ø§Ù„Ù†ÙˆØ§Ù‚Øµ ØºÙŠØ± Ù…ØªØ§Ø­Ø© ÙÙŠ Ø®Ø·Ø© Ø²ÙŠØ±Ùˆ. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ©.",variant:"destructive"});return}const a=parseInt(Uc||"1",10);if(!Nr){x({title:"Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±",variant:"destructive"});return}if(isNaN(a)||a<=0){x({title:"ÙƒÙ…ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ…ÙŠØ© ØµØ­ÙŠØ­Ø©",variant:"destructive"});return}(async()=>{if(t!=null&&t.uid)try{const{collection:o,addDoc:c,serverTimestamp:u}=await re(async()=>{const{collection:p,addDoc:w,serverTimestamp:b}=await import("./index-CHyvkdwe.js").then(y=>y.cF);return{collection:p,addDoc:w,serverTimestamp:b}},__vite__mapDeps([0,1]),import.meta.url),{db:h}=await re(async()=>{const{db:p}=await import("./index-CHyvkdwe.js").then(w=>w.cG);return{db:p}},__vite__mapDeps([0,1]),import.meta.url),f=await c(o(h,"deficiencies"),{userId:t.uid,shopId:j||(r==null?void 0:r.shopId)||t.uid||"default-shop",name:Nr,quantity:a,status:"pending",createdAt:u()});try{const p=li(),w=localStorage.getItem(p),b=w?JSON.parse(w):[],y=Array.isArray(b)?b:[],N=y.some(T=>String((T==null?void 0:T.id)||"")===f.id),k={id:f.id,name:Nr,quantity:a,status:"pending",createdAt:new Date().toISOString()},C=N?y:[...y,k];localStorage.setItem(p,JSON.stringify(C))}catch{}lo(""),co(""),x({title:"ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©",description:"ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†ØµØ± Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"});return}catch(o){console.warn("ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ø¥Ù„Ù‰ FirestoreØŒ Ø³ÙŠÙØ³ØªØ®Ø¯Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",o)}const n={id:Date.now().toString(),name:Nr,quantity:a,status:"pending",createdAt:new Date};Os(o=>{const c=[...o,n];return xl(c),c}),lo(""),co(""),x({title:"ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©",description:"ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†ØµØ± Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"})})()},children:"Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù†ÙˆØ§Ù‚Øµ"})}),Vc.length>0?e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Vc.map(a=>e.jsx("div",{className:"p-2 border rounded-lg bg-white dark:bg-card dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-sm dark:text-gray-200",children:a.name}),e.jsxs("p",{className:"text-[11px] text-gray-600 dark:text-gray-400",children:["Ø§Ù„ÙƒÙ…ÙŠØ©: ",a.quantity]}),e.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-500",children:new Date(a.createdAt).toLocaleString("ar-EG")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ma,{variant:"secondary",className:a.status==="pending"?"bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-300":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:a.status==="pending"?"Ù‚ÙŠØ¯ Ø§Ù„Ø´Ø±Ø§Ø¡":"ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡"}),e.jsx(I,{variant:"outline",className:a.status==="pending"?"text-green-700 border-green-300 hover:bg-green-50":"text-rose-700 border-rose-300 hover:bg-rose-50",onClick:()=>{(async()=>{const n=a.status==="pending"?"purchased":"pending";if(t!=null&&t.uid)try{const{doc:o,updateDoc:c,serverTimestamp:u}=await re(async()=>{const{doc:f,updateDoc:p,serverTimestamp:w}=await import("./index-CHyvkdwe.js").then(b=>b.cF);return{doc:f,updateDoc:p,serverTimestamp:w}},__vite__mapDeps([0,1]),import.meta.url),{db:h}=await re(async()=>{const{db:f}=await import("./index-CHyvkdwe.js").then(p=>p.cG);return{db:f}},__vite__mapDeps([0,1]),import.meta.url);await c(o(h,"deficiencies",a.id),{status:n,updatedAt:u()});return}catch(o){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ø¹Ù„Ù‰ FirestoreØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",o)}Os(o=>{const c=o.map(u=>u.id===a.id?{...u,status:n}:u);return xl(c),c})})()},title:a.status==="pending"?"ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡":"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø´Ø±Ø§Ø¡",children:a.status==="pending"?"ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡":"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø´Ø±Ø§Ø¡"}),e.jsx(I,{variant:"outline",className:"text-red-700 border-red-300 hover:bg-red-50",onClick:()=>{(async()=>{if(t!=null&&t.uid)try{const{doc:n,deleteDoc:o}=await re(async()=>{const{doc:u,deleteDoc:h}=await import("./index-CHyvkdwe.js").then(f=>f.cF);return{doc:u,deleteDoc:h}},__vite__mapDeps([0,1]),import.meta.url),{db:c}=await re(async()=>{const{db:u}=await import("./index-CHyvkdwe.js").then(h=>h.cG);return{db:u}},__vite__mapDeps([0,1]),import.meta.url);await o(n(c,"deficiencies",a.id));return}catch(n){console.warn("ÙØ´Ù„ Ø­Ø°Ù Ø¹Ù†ØµØ± Ø§Ù„Ù†ÙˆØ§Ù‚Øµ Ù…Ù† FirestoreØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:",n)}Os(n=>{const o=n.filter(c=>c.id!==a.id);return xl(o),o})})()},title:"Ø­Ø°Ù",children:"Ø­Ø°Ù"})]})]})},a.id))}):e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³Ø¬Ù„Ø© ÙÙŠ Ø§Ù„Ù†ÙˆØ§Ù‚Øµ"})]}),e.jsx(Fe,{className:"flex justify-end",children:e.jsx(I,{variant:"outline",onClick:()=>wr(!1),children:"Ø¥ØºÙ„Ø§Ù‚"})})]})}),e.jsx(ue,{open:c0,onOpenChange:a=>{_n(a),a||(Tn(null),jr(""),Sr(""))},children:e.jsxs(me,{className:"sm:max-w-[520px]",children:[e.jsxs(be,{children:[e.jsx(pe,{className:"text-right",children:"Ø£Ø±Ù‚Ø§Ù…ÙŠ Ù…Ø¹ Ø¹Ù…Ù„Ø§Ø¦ÙŠ"}),e.jsx(at,{className:"text-right",children:"Ø§Ø³ØªØ¹Ø±Ø¶ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø­Ø§ÙØ¸ ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø²Ø§Ø¦Ø¯ Ù„ØªØ³Ù„ÙŠÙ… Ø±Ù‚Ù… Ù„Ø¹Ù…ÙŠÙ„. Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù…Ø®ØµØµØ© Ù„Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØªÙŠ ØªØ¹Ø·ÙŠÙ‡Ø§ Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø­Ù„ Ù„ÙŠØ­ÙˆÙ‘Ù„ÙˆØ§ Ø¹Ù„ÙŠÙ‡Ø§ØŒ Ø­ØªÙ‰ ØªÙƒÙˆÙ† Ø¹Ø§Ø±Ù Ø£Ù† Ø§Ù„Ø®Ø·ÙˆØ· Ø¯ÙŠ Ù…Ø®ØµØµØ© Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù‡ÙŠØ­ÙˆÙ„Ùˆ Ø¹Ù„ÙŠÙ‡Ø§ Ù…Ù† Ø¨Ø±Ø§ Ø§Ù„Ù…Ø­Ù„ Ø¹Ù„Ø´Ø§Ù† Ù…ØªØ³ØªÙ„Ù…Ø´ Ø¹Ù„ÙŠÙ‡Ø§ ÙˆØªÙˆÙ‚Ù Ù„ÙŠÙ…ÙŠØªÙƒ"})]}),e.jsx("div",{className:"grid gap-3 py-2",children:J.length===0?e.jsx("div",{className:"text-center text-sm text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…Ø¶Ø§ÙØ© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†."}):J.map(a=>{const n=uo[a.id],o=!!n;return e.jsxs("div",{className:`p-3 rounded-lg border flex flex-col gap-2 ${o?"border-red-500 bg-red-50 text-red-700":"border-emerald-500 bg-emerald-50 text-emerald-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-semibold text-base",children:a.phone||"Ø¨Ø¯ÙˆÙ† Ø±Ù‚Ù…"}),a.name?e.jsx("span",{className:"text-xs text-gray-600",children:a.name}):null,o&&e.jsxs("span",{className:"text-xs mt-1",children:["Ù„Ø¹Ù…ÙŠÙ„: ",n.name,n.amount&&n.amount.trim()!==""?` - Ù…Ø¨Ù„Øº: ${n.amount}`:""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{type:"button",size:"icon",className:"h-9 w-9 rounded-full bg-emerald-600 hover:bg-emerald-700 text-white",onClick:()=>{Tn(a.id),jr((n==null?void 0:n.name)||""),Sr((n==null?void 0:n.amount)||"")},children:e.jsx(Pt,{className:"h-4 w-4"})}),o&&e.jsx(I,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 rounded-full border-red-300 text-red-600 hover:bg-red-50",onClick:()=>{const c=`clientNumberAssignments_${(t==null?void 0:t.uid)||"default"}`,u={...uo};delete u[a.id],Es(u);try{localStorage.setItem(c,JSON.stringify(u))}catch{}An===a.id&&(Tn(null),jr(""),Sr(""))},children:e.jsx(Na,{className:"h-4 w-4"})})]})]}),An===a.id&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[e.jsx(X,{placeholder:"Ø§Ø³Ù… Ù…Ø³ØªÙ„Ù… Ø§Ù„Ø±Ù‚Ù…",className:"text-right",value:qc,onChange:c=>jr(c.target.value)}),e.jsx(X,{placeholder:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ ØªØ­ÙˆÙŠÙ„Ù‡",className:"text-right sm:max-w-[160px]",value:zc,onChange:c=>Sr(c.target.value),inputMode:"decimal"}),e.jsx(I,{className:"bg-red-600 hover:bg-red-700 text-white px-4",onClick:()=>{const c=qc.trim();if(!c){x({title:"Ø§Ø³Ù… ØºÙŠØ± ØµØ­ÙŠØ­",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ù…Ø³ØªÙ„Ù… Ø§Ù„Ø±Ù‚Ù…",variant:"destructive"});return}if(!An)return;const u=zc.trim(),h=`clientNumberAssignments_${(t==null?void 0:t.uid)||"default"}`,f={...uo,[An]:{name:c,amount:u}};Es(f);try{localStorage.setItem(h,JSON.stringify(f))}catch{}Tn(null),jr(""),Sr("")},children:"ØªØ³Ù„ÙŠÙ…"})]})]},a.id)})})]})}),e.jsx(ue,{open:Wf,onOpenChange:Ys,children:e.jsxs(me,{className:"sm:max-w-[480px]",children:[e.jsx(be,{children:e.jsx(pe,{className:"text-right",children:(it==null?void 0:it.type)==="decrease"?"Ø§Ø®ØªÙŠØ§Ø± Ù…ÙƒØ§Ù† Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯":"Ø§Ø®ØªÙŠØ§Ø± Ù…ØµØ¯Ø± Ø®ØµÙ… Ø§Ù„Ø¯ÙŠÙ†"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 text-right",children:(it==null?void 0:it.type)==="decrease"?"Ø§Ø®ØªØ± Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ø£Ù… Ø¥Ù„Ù‰ Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø£Ùˆ ØªØ³Ø¬ÙŠÙ„Ù‡ Ø¨Ø¯ÙˆÙ† Ø®ØµÙ….":"Ø§Ø®ØªØ± Ù‡Ù„ ØªØ±ÙŠØ¯ Ø®ØµÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ† Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø±Ø¬ Ø£Ù… Ù…Ù† Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø£Ùˆ ØªØ³Ø¬ÙŠÙ„Ù‡ Ø¨Ø¯ÙˆÙ† Ø®ØµÙ…."}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(I,{variant:Nt==="cash"?"default":"outline",className:Nt==="cash"?"bg-blue-600 hover:bg-blue-700 text-white":"",onClick:()=>zr("cash"),children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),e.jsx(I,{variant:Nt==="wallet"?"default":"outline",className:Nt==="wallet"?"bg-purple-600 hover:bg-purple-700 text-white":"",onClick:()=>zr("wallet"),children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),e.jsx(I,{variant:Nt==="none"?"default":"outline",className:Nt==="none"?"bg-gray-600 hover:bg-gray-700 text-white":"",onClick:()=>zr("none"),children:(it==null?void 0:it.type)==="decrease"?"Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ©":"Ø¨Ø¯ÙˆÙ† Ø®ØµÙ…"})]}),Nt==="wallet"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{className:"text-right block",children:(it==null?void 0:it.type)==="decrease"?"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø¥Ø¶Ø§ÙØ©":"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…"}),e.jsxs(Wa,{value:Ks,onValueChange:rl,children:[e.jsx(La,{className:"w-full",children:e.jsx(Fa,{placeholder:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©"})}),e.jsx(Ba,{children:J.map(a=>e.jsx(oa,{value:a.id,children:a.phone||a.name||a.id},a.id))})]})]})]}),e.jsxs(Fe,{className:"flex justify-between",children:[e.jsx(I,{variant:"outline",onClick:()=>{Ys(!1),qr(null),zr(null),rl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{className:"bg-green-600 hover:bg-green-700",onClick:async()=>{const a=!!it,n=a&&(it==null?void 0:it.type)==="decrease",o=Number(a?it.delta:(gs==null?void 0:gs.amount)||0);if(!Nt){x({title:n?"Ø§Ø®ØªØ± Ù…ÙƒØ§Ù† Ø§Ù„Ø¥Ø¶Ø§ÙØ©":"Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø®ØµÙ…",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}const c=new Date().toISOString();let u=qe,h=Se,f=!1,p=!1;try{if(Nt==="cash")u=Number(n?(qe+o).toFixed(2):(qe-o).toFixed(2)),f=!0;else if(Nt==="wallet"){if(!Ks){x({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø©",description:n?"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø¥Ø¶Ø§ÙØ©":"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø®ØµÙ…",variant:"destructive"});return}const C=Se[Ks]||0,T=Number(n?(C+o).toFixed(2):(C-o).toFixed(2));h={...Se,[Ks]:T},p=!0}}catch(C){console.error("Error calculating balances:",C);return}let w=[...Re],b=W,y=!1;if(a){if(!W)return;const C=Number(W.amount||0),T=Number(W.paidAmount||0),R=Number(it.delta||0);if(it.type==="decrease"){const _=W.type==="debtor",O=C-R;if(_&&O<0){const V=Number(Math.abs(O).toFixed(2)),le={...W,amount:V,type:"creditor",paidAmount:0,status:"pending"};if(w=Re.map(te=>te.id===W.id?le:te),b=le,y=!0,t!=null&&t.uid&&(async()=>{try{const[te,Ae,Xe]=[Ee(ce($,"userTransactions"),Y("userId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending")),Ee(ce($,"transactions"),Y("userId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending")),Ee(ce($,"transactions"),Y("merchantUserId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending"))],[Ze,Oe,ge]=await Promise.all([ke(te),ke(Ae),ke(Xe)]),et=Hl($);let ht=0;const lt=na=>{na.docs.forEach(It=>{et.update(It.ref,{status:"completed",confirmedAt:new Date}),ht++})};lt(Ze),lt(Oe),lt(ge),ht>0&&await et.commit(),t!=null&&t.uid&&[...Ze.docs.map(It=>{var ze;return String(((ze=It.data())==null?void 0:ze.transactionId)||"")}),...Oe.docs.map(It=>{var ze;return String(It.id||((ze=It.data())==null?void 0:ze.transactionId)||"")}),...ge.docs.map(It=>{var ze;return String(It.id||((ze=It.data())==null?void 0:ze.transactionId)||"")})].filter(Boolean).forEach(It=>oe.removeLocalReceiptById(t.uid,It))}catch(te){console.error("Batch update failed for linked transactions (Flip):",te)}})().catch(te=>console.error("Transaction update error (Flip):",te)),t!=null&&t.uid&&Nt!=="none")try{await cn(ce($,"debtReceipts"),{debtId:W.id,debtorName:W.debtorName,amount:R,userId:t.uid,createdAt:ft(),type:"payment"});const Ae={transactionId:Pe(ce($,"dummy_collection")).id,amount:R,transactionType:"cash_addition",type:"cash_addition",status:"completed",createdAt:new Date,senderName:W.debtorName,receiverName:"Ø§Ù„Ù…Ø­Ù„",description:`Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ† ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø±ØµÙŠØ¯ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${W.debtorName}`,paymentMethod:Nt,walletId:Nt==="wallet"?Ks:null,linkedDebtId:W.id,isDebtRepayment:!0};await oe.saveUserTransaction(t.uid,Ae);try{E.invalidateQueries({queryKey:["recentTransactions",t==null?void 0:t.uid]})}catch{}}catch(te){console.error("Failed to create repayment receipt (Flip):",te)}x({title:"ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ†",description:`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (${V} Ø¬Ù†ÙŠÙ‡) Ø¥Ù„Ù‰ "Ù„ÙŠÙ†Ø§"`})}else{const V=Number(O.toFixed(2)),le=T>=V,te={...W,amount:V,status:le?"paid":"pending"};if(w=Re.map(Ae=>Ae.id===W.id?te:Ae),b=te,y=!0,le&&(t!=null&&t.uid)&&(async()=>{try{const[Ae,Xe,Ze]=[Ee(ce($,"userTransactions"),Y("userId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending")),Ee(ce($,"transactions"),Y("userId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending")),Ee(ce($,"transactions"),Y("merchantUserId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending"))],[Oe,ge,et]=await Promise.all([ke(Ae),ke(Xe),ke(Ze)]),ht=Hl($);let lt=0;const na=It=>{It.docs.forEach(ze=>{ht.update(ze.ref,{status:"completed",confirmedAt:new Date}),lt++})};na(Oe),na(ge),na(et),lt>0&&await ht.commit(),t!=null&&t.uid&&[...Oe.docs.map(ze=>{var ha;return String(((ha=ze.data())==null?void 0:ha.transactionId)||"")}),...ge.docs.map(ze=>{var ha;return String(ze.id||((ha=ze.data())==null?void 0:ha.transactionId)||"")}),...et.docs.map(ze=>{var ha;return String(ze.id||((ha=ze.data())==null?void 0:ha.transactionId)||"")})].filter(Boolean).forEach(ze=>oe.removeLocalReceiptById(t.uid,ze))}catch(Ae){console.error("Batch update failed for linked transactions:",Ae)}})().catch(Ae=>{console.error("Transaction update error:",Ae)}),t!=null&&t.uid&&Nt!=="none")try{await cn(ce($,"debtReceipts"),{debtId:W.id,debtorName:W.debtorName,amount:R,userId:t.uid,createdAt:ft(),type:"payment"});const Xe={transactionId:Pe(ce($,"dummy_collection")).id,amount:R,transactionType:"cash_addition",type:"cash_addition",status:"completed",createdAt:new Date,senderName:W.debtorName,receiverName:"Ø§Ù„Ù…Ø­Ù„",description:`Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ† Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ ${W.debtorName}`,paymentMethod:Nt,walletId:Nt==="wallet"?Ks:null,linkedDebtId:W.id,isDebtRepayment:!0};await oe.saveUserTransaction(t.uid,Xe);try{E.invalidateQueries({queryKey:["recentTransactions",t==null?void 0:t.uid]})}catch{}}catch(Ae){console.error("Failed to create repayment receipt:",Ae)}x({title:"ØªÙ… Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„Ù…Ø¨Ù„Øº",description:`Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${V} Ø¬Ù†ÙŠÙ‡`})}}else{const _=C+R,O=T>=_,V={amount:R,note:Ud||void 0,addedAt:new Date},le={...W,amount:Number(_.toFixed(2)),status:O?"paid":"pending",additionReceipts:[...W.additionReceipts||[],V]};w=Re.map(te=>te.id===W.id?le:te),b=le,y=!0,x({title:"ØªÙ… Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø¨Ù„Øº",description:`Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${_} Ø¬Ù†ÙŠÙ‡`})}}else if(gs){w=[{...gs,userId:t==null?void 0:t.uid,shopId:j||(r==null?void 0:r.shopId)||null},...Re],y=!0;try{t!=null&&t.uid&&vs.send(t.uid,`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¯ÙŠÙ† Ø¹Ù„Ù‰ ${gs.debtorName} Ø¨Ù…Ø¨Ù„Øº ${gs.amount} Ø¬Ù†ÙŠÙ‡`).catch(()=>{})}catch{}}f&&ot(u),p&&mt(h),y&&(zt(w),a&&$r(b)),Vo(""),Rd(""),Ld(""),Vs(!1),Ys(!1),!a&&y&&fs(!0),qr(null),Vd(null),zr(null),rl(""),Yn(""),x({title:a?"ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ†":"ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¯ÙŠÙ†",description:Nt==="none"?"Ù„Ù… ÙŠØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø©":Nt==="cash"?n?`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${o} Ø¥Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ`:`ØªÙ… Ø®ØµÙ… ${o} Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø¯ÙŠ`:n?`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${o} Ø¥Ù„Ù‰ Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©`:`ØªÙ… Ø®ØµÙ… ${o} Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©`});const N={lastUpdated:c};if(f&&(N.cashBalance=u),p&&(N.walletBalances=h),y&&(N.debts=w,N.debtsDeletedAt=null),f&&(localStorage.setItem(Ye(),u.toString()),localStorage.setItem(Ye()+"_lastUpdated",c)),p&&(localStorage.setItem(Ge(),JSON.stringify(h)),localStorage.setItem(Ge()+"_lastUpdated",c)),y){localStorage.setItem(Yr(),JSON.stringify(w));try{localStorage.setItem(fl(),JSON.stringify(w))}catch{}try{localStorage.setItem(gl(),Date.now().toString())}catch{}}const k=`userData_${t==null?void 0:t.uid}`;if(localStorage.setItem(k,JSON.stringify(N)),t!=null&&t.uid){if(y)try{localStorage.setItem(`debts_unsynced_${t.uid}`,"true")}catch{}const C=[];C.push(oe.updateUserData(t.uid,N).then(()=>{(f||p)&&(localStorage.removeItem(k),ve(!1))}));const T=j||(r==null?void 0:r.shopId);if(T&&(f||p)){const R={lastUpdated:c};f&&(R.cashBalance=u),p&&(R.walletBalances=h),C.push(sa(Pe($,"dashboardData",T),R,{merge:!0}).catch(_=>console.error("Failed to sync to dashboardData",_)))}Promise.all(C).then(()=>{if(y)try{localStorage.removeItem(`debts_unsynced_${t.uid}`)}catch{}}).catch(R=>{console.error("Sync error:",R),ve(!0)})}},children:(it==null?void 0:it.type)==="decrease"?"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©":"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø®ØµÙ…"})]})]})}),e.jsx(ue,{open:Sf,onOpenChange:Ha,children:e.jsxs(me,{className:"w-[95vw] sm:w-auto sm:max-w-[425px] max-h-[90vh] overflow-y-auto rounded-2xl",hideClose:!0,children:[e.jsx("div",{className:"absolute left-4 top-4 z-50",children:e.jsxs(I,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full opacity-70 hover:opacity-100",onClick:()=>Ha(!1),children:[e.jsx(ln,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Ø¥ØºÙ„Ø§Ù‚"})]})}),e.jsx(be,{children:e.jsx(pe,{className:"text-right",children:"Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙŠÙ†"})}),W&&e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"text-center border-b pb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Ø¥ÙŠØµØ§Ù„ Ø¯ÙŠÙ†"}),e.jsx("p",{className:"text-sm text-gray-500",children:en.format(W.createdAt instanceof Date?W.createdAt:new Date(W.createdAt))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†:"}),e.jsx("span",{children:W.debtorName})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:justify-between sm:items-center",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"outline",className:"h-10 w-10 sm:h-8 sm:w-8 p-0","aria-label":"Ø¯ÙØ¹ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø¯ÙŠÙ†",onClick:()=>{Ur(""),Kn(!0)},children:"âˆ’"}),e.jsxs("span",{className:"font-bold text-xl sm:text-lg",children:[W.amount," Ø¬Ù†ÙŠÙ‡"]}),e.jsx(I,{variant:"outline",className:"h-10 w-10 sm:h-8 sm:w-8 p-0","aria-label":"Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¯ÙŠÙ†",onClick:()=>{kf("increase"),$d(""),Yn(""),Ha(!1),zn(!0)},children:"+"})]})]}),(()=>{try{const a=(he||[]).filter(n=>String((n==null?void 0:n.linkedDebtId)||"")===String(W.id)).reduce((n,o)=>n+Math.max(0,Number((o==null?void 0:o.commission)||0)),0);return a>0?e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ø±Ø¨Ø­:"}),e.jsxs("span",{className:"text-green-700 font-semibold",children:[a," Ø¬Ù†ÙŠÙ‡"]})]}):null}catch{return null}})(),e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø³Ø¨Ø¨ Ø§Ù„Ø¯ÙŠÙ†:"}),e.jsx("span",{children:W.reason})]}),e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ø­Ø§Ù„Ø©:"}),e.jsx(Ma,{variant:W.status==="paid"?"default":"secondary",className:`${W.status==="paid"?"bg-green-500":"bg-yellow-500"} w-fit text-[12px] sm:text-xs`,children:W.status==="paid"?"Ù…Ø¯ÙÙˆØ¹":"Ù…Ø¤Ø¬Ù„"})]}),(()=>{const a=Number(W.amount||0),n=Number(W.paidAmount||0),o=Math.max(0,a-n);return e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:"}),e.jsxs("span",{className:"font-bold text-xl sm:text-lg",children:[o," Ø¬Ù†ÙŠÙ‡"]})]})})(),W.paidAmount?e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹:"}),e.jsxs("span",{className:"text-green-700",children:[W.paidAmount," Ø¬Ù†ÙŠÙ‡"]})]}):null,W.partialPayments&&W.partialPayments.length>0&&e.jsxs("div",{className:"mt-3 text-[12px] sm:text-xs text-gray-600",children:[e.jsx("p",{className:"font-medium mb-1",children:"Ø³Ø¬Ù„ Ø§Ù„Ø¯ÙØ¹Ø§Øª Ø§Ù„Ø¬Ø²Ø¦ÙŠØ©:"}),e.jsx("div",{className:"space-y-1 max-h-[30vh] sm:max-h-24 overflow-y-auto",children:W.partialPayments.map((a,n)=>e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsxs("span",{children:["Ø¯ÙØ¹: ",a.amount," Ø¬Ù†ÙŠÙ‡"]}),e.jsx("span",{children:new Date(a.paidAt).toLocaleString("ar-EG")})]},n))})]}),W.additionReceipts&&W.additionReceipts.length>0&&e.jsxs("div",{className:"mt-3 text-[12px] sm:text-xs text-gray-600",children:[e.jsx("p",{className:"font-medium mb-1",children:"Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬Ø²Ø¦ÙŠØ©:"}),e.jsx("div",{className:"space-y-1 max-h-[20vh] sm:max-h-32 overflow-y-auto",children:W.additionReceipts.map((a,n)=>e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsxs("span",{children:["Ø¥Ø¶Ø§ÙØ©: ",a.amount," Ø¬Ù†ÙŠÙ‡"]}),e.jsx("span",{children:new Date(a.addedAt).toLocaleString("ar-EG")}),a.note&&e.jsxs("span",{className:"sm:col-span-2 text-right text-[11px] text-gray-500",children:["Ù…Ù„Ø§Ø­Ø¸Ø©: ",a.note]})]},n))})]})]})]}),e.jsxs(Fe,{className:"flex gap-2 justify-center",children:[e.jsx(I,{onClick:async()=>{if(W){const a=Re.map(n=>n.id===W.id?{...n,status:"pending"}:n);zt(a),await Oa(a);try{if(t!=null&&t.uid){const n=computedRemaining;await vs.send(t.uid,`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${W.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${n} Ø¬Ù†ÙŠÙ‡`)}}catch{}Ha(!1),x({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙŠÙ†",description:"ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¯ÙŠÙ† ÙƒÙ…Ø¤Ø¬Ù„"})}},variant:"outline",className:"bg-yellow-500 hover:bg-yellow-600 text-white",children:"Ù…Ø¤Ø¬Ù„"}),e.jsx(I,{onClick:async()=>{if(W){const a=Number(W.amount||0),n=Number(W.paidAmount||0);let o=Math.max(0,a-n);try{const h=(he||[]).filter(y=>String((y==null?void 0:y.linkedDebtId)||"")===String(W.id)),f=h.reduce((y,N)=>y+Math.max(0,Number((N==null?void 0:N.commission)||0)),0),p=h.reduce((y,N)=>y+Math.max(0,Number(((N==null?void 0:N.sentAmount)??(N==null?void 0:N.transferredAmount)??(N==null?void 0:N.withdrawnAmount)??(N==null?void 0:N.amount))||0)),0),b=a<p+f?a+f:a;o=Math.max(0,Number(b)-n)}catch{}const c=o,u=Re.map(h=>{if(h.id!==W.id)return h;const f=Number(h.amount||0),p=Number(h.paidAmount||0),w=Number((p+c).toFixed(2)),b=w>=f;return{...h,amount:f,paidAmount:b?f:w,status:"paid",partialPayments:[...h.partialPayments||[],...c>0?[{amount:c,paidAt:new Date}]:[]]}});zt(u);try{$r(u.find(h=>h.id===W.id)||null)}catch{}ei(c),Ga("none"),Js(!0),await Oa(u);try{const h=u.find(f=>f.id===W.id);if(t!=null&&t.uid&&(h!=null&&h.id)){const f=Pe($,"debts",h.id),p={...h,userId:t.uid,shopId:j||(r==null?void 0:r.shopId)||null,lastUpdated:new Date().toISOString()};Object.keys(p).forEach(w=>p[w]===void 0&&delete p[w]),await sa(f,p,{merge:!0})}}catch(h){console.error("Failed to sync debt payment to collection:",h)}try{t!=null&&t.uid&&(W!=null&&W.id)&&(async()=>{const h=Ee(ce($,"userTransactions"),Y("userId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending")),f=await ke(h);await Promise.allSettled(f.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=f.docs.map(k=>{var C;return String(((C=k.data())==null?void 0:C.transactionId)||"")});t!=null&&t.uid&&N.forEach(k=>k&&oe.removeLocalReceiptById(t.uid,k))}catch{}const p=Ee(ce($,"transactions"),Y("userId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending")),w=await ke(p);await Promise.allSettled(w.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=w.docs.map(k=>{var C;return String(k.id||((C=k.data())==null?void 0:C.transactionId)||"")});t!=null&&t.uid&&N.forEach(k=>k&&oe.removeLocalReceiptById(t.uid,k))}catch{}const b=Ee(ce($,"transactions"),Y("merchantUserId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending")),y=await ke(b);await Promise.allSettled(y.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=y.docs.map(k=>{var C;return String(k.id||((C=k.data())==null?void 0:C.transactionId)||"")});t!=null&&t.uid&&N.forEach(k=>k&&oe.removeLocalReceiptById(t.uid,k))}catch{}})().catch(h=>{console.error("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†:",h),x({title:"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©",description:"ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†",variant:"destructive"})})}catch(h){console.error("ØªØ¹Ø°Ø± ØªØ¬Ù‡ÙŠØ² ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©:",h)}try{const h=bl(),f=localStorage.getItem(h);if(f){const w=(JSON.parse(f)||[]).map(b=>(b==null?void 0:b.linkedDebtId)===W.id&&(b==null?void 0:b.status)==="pending"?{...b,status:"completed",confirmedAt:new Date}:b);localStorage.setItem(h,JSON.stringify(w)),qt(b=>b.map(y=>(y==null?void 0:y.linkedDebtId)===W.id&&(y==null?void 0:y.status)==="pending"?{...y,status:"completed",confirmedAt:new Date}:y))}}catch(h){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ†:",h)}Ha(!1),x({title:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙŠÙ†",description:"ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¯ÙŠÙ† ÙƒÙ…Ø¯ÙÙˆØ¹"})}},className:"bg-green-500 hover:bg-green-600",children:"Ù…Ø¯ÙÙˆØ¹"}),e.jsx(I,{onClick:async()=>{if(W){const a=Re.filter(n=>n.id!==W.id);zt(a),await Oa(a),Ha(!1),x({title:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¯ÙŠÙ†",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¯ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­"})}},variant:"destructive",children:"Ø­Ø°Ù"})]})]})}),e.jsx(ue,{open:Cf,onOpenChange:a=>{Kn(a),a||Ur("")},children:e.jsxs(me,{className:"w-[95vw] sm:max-w-[425px] rounded-2xl",children:[e.jsxs(be,{children:[e.jsx(pe,{className:"text-right",children:"Ø¯ÙØ¹ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø¯ÙŠÙ†"}),e.jsx(at,{className:"text-right",children:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø¯ÙØ¹Ù‡ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙŠÙ† Ø«Ù… Ø§Ø¶ØºØ· Ø¯ÙØ¹."})]}),W&&e.jsxs("div",{className:"grid gap-4 py-2",children:[e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†:"}),e.jsx("span",{children:W.debtorName})]}),e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙƒÙ„ÙŠ:"}),e.jsxs("span",{children:[W.amount," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹:"}),e.jsxs("span",{className:"text-green-700",children:[Number(W.paidAmount||0)," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:justify-between",children:[e.jsx("span",{className:"font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:"}),e.jsxs("span",{className:"font-semibold",children:[Math.max(0,Number(W.amount||0)-Number(W.paidAmount||0))," ","Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"partialAmountDialog",className:"text-right block",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¯ÙØ¹Ù‡"}),e.jsx(X,{id:"partialAmountDialog",type:"number",value:zd,onChange:a=>Ur(a.target.value),className:"text-right",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº"})]})]}),e.jsxs(Fe,{className:"flex gap-2 justify-between",children:[e.jsx(I,{variant:"outline",onClick:()=>{Kn(!1),Ur("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{className:"bg-blue-600 hover:bg-blue-700",onClick:async()=>{const a=parseFloat(zd);if(!W||isNaN(a)||a<=0){x({title:"Ø®Ø·Ø£",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­",variant:"destructive"});return}const n=Math.max(0,Number(W.amount||0)-Number(W.paidAmount||0)),o=a>n;let c;if(o){const h=Number((a-n).toFixed(2)),p=(W.type||"creditor")==="debtor"?"creditor":"debtor";c={...W,type:p,amount:h,paidAmount:0,status:"pending",partialPayments:[]},x({title:"ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ†",description:`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (${h} Ø¬Ù†ÙŠÙ‡) Ø¥Ù„Ù‰ ${p==="debtor"?'"Ø¹Ù„ÙŠÙ†Ø§"':'"Ù„ÙŠÙ†Ø§"'}`})}else{const h=Number(((W.paidAmount||0)+a).toFixed(2)),p=Number(W.amount||0)-h<.01;c={...W,amount:Number(W.amount||0),paidAmount:h,status:p?"paid":"pending",partialPayments:[...W.partialPayments||[],{amount:a,paidAt:new Date}]}}const u=Re.map(h=>h.id===W.id?c:h);zt(u),$r(c),await Oa(u);try{if(t!=null&&t.uid){const h=Math.max(0,Number(c.amount||0)-Number(c.paidAmount||0)),f=o?`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${c.debtorName} ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (${c.amount} Ø¬Ù†ÙŠÙ‡) Ø¥Ù„Ù‰ ${c.type==="debtor"?'"Ø¹Ù„ÙŠÙ†Ø§"':'"Ù„ÙŠÙ†Ø§"'}`:`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø¬Ø²Ø¡ Ù…Ù† Ø¯ÙŠÙ† ${c.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${a} Ø¬Ù†ÙŠÙ‡ØŒ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ ${h} Ø¬Ù†ÙŠÙ‡`;await vs.send(t.uid,f)}}catch{}try{(c.status==="paid"||o)&&(t!=null&&t.uid)&&(async()=>{const h=Ee(ce($,"userTransactions"),Y("userId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending")),f=await ke(h);await Promise.allSettled(f.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=f.docs.map(k=>{var C;return String(((C=k.data())==null?void 0:C.transactionId)||"")});t!=null&&t.uid&&N.forEach(k=>k&&oe.removeLocalReceiptById(t.uid,k))}catch{}const p=Ee(ce($,"transactions"),Y("userId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending")),w=await ke(p);await Promise.allSettled(w.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=w.docs.map(k=>{var C;return String(k.id||((C=k.data())==null?void 0:C.transactionId)||"")});t!=null&&t.uid&&N.forEach(k=>k&&oe.removeLocalReceiptById(t.uid,k))}catch{}const b=Ee(ce($,"transactions"),Y("merchantUserId","==",t.uid),Y("linkedDebtId","==",W.id),Y("status","==","pending")),y=await ke(b);await Promise.allSettled(y.docs.map(N=>ea(N.ref,{status:"completed",confirmedAt:new Date})));try{const N=y.docs.map(k=>{var C;return String(k.id||((C=k.data())==null?void 0:C.transactionId)||"")});t!=null&&t.uid&&N.forEach(k=>k&&oe.removeLocalReceiptById(t.uid,k))}catch{}})().catch(h=>{console.error("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†:",h),x({title:"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©",description:"ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙŠÙ†",variant:"destructive"})})}catch(h){console.error("ØªØ¹Ø°Ø± ØªØ¬Ù‡ÙŠØ² ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©:",h)}if(c.status==="paid")try{const h=bl(),f=localStorage.getItem(h);if(f){const w=(JSON.parse(f)||[]).map(b=>(b==null?void 0:b.linkedDebtId)===W.id&&(b==null?void 0:b.status)==="pending"?{...b,status:"completed",confirmedAt:new Date}:b);localStorage.setItem(h,JSON.stringify(w)),qt(b=>b.map(y=>(y==null?void 0:y.linkedDebtId)===W.id&&(y==null?void 0:y.status)==="pending"?{...y,status:"completed",confirmedAt:new Date}:y))}}catch(h){console.warn("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ†:",h)}ei(a),Ga("none"),Js(!0),Kn(!1),Ur(""),x({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹ Ø¬Ø²Ø¡",description:`ØªÙ… Ø¯ÙØ¹ ${a} Ø¬Ù†ÙŠÙ‡ Ø¨ØªØ§Ø±ÙŠØ® ${new Date().toLocaleString("ar-EG")}`})},children:"Ø¯ÙØ¹"})]})]})}),e.jsx(ue,{open:Df,onOpenChange:zn,children:e.jsxs(me,{className:"sm:max-w-md rounded-2xl shadow-elegant border border-gray-200",children:[e.jsxs(be,{children:[e.jsx(pe,{className:`text-right ${wa==="decrease"?"text-red-600":"text-green-600"}`,children:wa==="increase"?"ÙƒØªØ§Ø¨Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¶Ø§ÙØ©":wa==="decrease"?"Ø¥Ù†Ù‚Ø§Øµ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†":"ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†"}),e.jsx(at,{className:"text-right",children:wa==="increase"?"Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¶Ø§ÙØ© ÙˆÙ…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø§Ø¶Ø§ÙØ© Ø«Ù… Ø§Ø¶ØºØ· ØªØ£ÙƒÙŠØ¯.":`Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø«Ù… Ø§Ø¶ØºØ· ØªØ£ÙƒÙŠØ¯ Ù„Ø¥ØªÙ…Ø§Ù… ${wa==="decrease"?"Ø§Ù„Ø¥Ù†Ù‚Ø§Øµ":"Ø§Ù„ØªØ¹Ø¯ÙŠÙ„"}.`})]}),e.jsxs("div",{className:"grid gap-4 py-2",children:[e.jsx(Q,{htmlFor:"debtAdjustAmount",className:"text-right",children:wa==="increase"?"Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¶Ø§ÙØ© (Ø¬Ù†ÙŠÙ‡)":"Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬Ù†ÙŠÙ‡)"}),e.jsx(X,{id:"debtAdjustAmount",type:"number",placeholder:"0.00",value:Bd,onChange:a=>$d(a.target.value)}),wa==="increase"&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{htmlFor:"debtAdditionNote",className:"text-right",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx(X,{id:"debtAdditionNote",placeholder:"Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù† Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø¶Ø§ÙØ©",value:Ud,onChange:a=>Yn(a.target.value)})]}),W&&e.jsxs("div",{className:"text-right text-sm text-muted-foreground",children:["Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø­Ø§Ù„ÙŠ: ",e.jsx("span",{className:"font-semibold",children:Number(W.amount||0).toFixed(2)})," Ø¬Ù†ÙŠÙ‡"]})]}),e.jsxs(Fe,{className:"flex gap-2",children:[e.jsx(I,{variant:"secondary",onClick:()=>{zn(!1),Ha(!0),Yn("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{className:wa==="decrease"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700",onClick:async()=>{try{if(!W||!wa)return;const a=Number(parseFloat(Bd||"0").toFixed(2));if(!a||isNaN(a)||a<=0){x({title:"Ù‚ÙŠÙ…Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©",description:"ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±",variant:"destructive"});return}qr(null),Vd({debtId:W.id,delta:a,type:wa}),zn(!1),Ys(!0)}catch(a){console.error("ÙØ´Ù„ ØªØ¬Ù‡ÙŠØ² ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†:",a),x({title:"Ø®Ø·Ø£",description:"ØªØ¹Ø°Ù‘Ø± ØªØ¬Ù‡ÙŠØ² ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙŠÙ†",variant:"destructive"})}},children:"ØªØ£ÙƒÙŠØ¯"})]})]})}),e.jsx(ue,{open:Lf,onOpenChange:Js,children:e.jsxs(me,{className:"sm:max-w-[480px]",children:[e.jsxs(be,{children:[e.jsx(pe,{className:"text-right",children:"Ø§Ø®ØªÙŠØ§Ø± Ù…ÙƒØ§Ù† Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯"}),e.jsx(at,{className:"text-right",children:"Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¥Ù„Ù‰ Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø£Ù… Ø¥Ù„Ù‰ Ø¥Ø­Ø¯Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸ØŸ"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsx(I,{variant:Rt==="cash"?"default":"outline",className:Rt==="cash"?"bg-blue-600 text-white":"",size:"sm",onClick:()=>Ga("cash"),children:"Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©"}),e.jsx(I,{variant:Rt==="wallet"?"default":"outline",className:Rt==="wallet"?"bg-blue-600 text-white":"",size:"sm",onClick:()=>Ga("wallet"),children:"Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"}),e.jsx(I,{variant:Rt==="fawry"?"default":"outline",className:Rt==="fawry"?"bg-amber-600 text-white":"",size:"sm",onClick:()=>Ga("fawry"),children:"ÙÙˆØ±ÙŠ"}),e.jsx(I,{variant:Rt==="none"?"default":"outline",className:Rt==="none"?"bg-gray-600 text-white":"",size:"sm",onClick:()=>Ga("none"),children:"Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ©"})]}),Rt==="wallet"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-right",children:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ù„Ø¥Ø¶Ø§ÙØ©"}),e.jsxs("select",{className:"w-full border rounded p-2 text-right",value:Xa,onChange:a=>nl(a.target.value),children:[e.jsx("option",{value:"",children:"â€” Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© â€”"}),J&&J.length>0?J.map(a=>e.jsx("option",{value:a.id,children:a.phone||a.name||a.id},a.id)):Object.keys(Se||{}).map(a=>{var n,o,c,u;return e.jsx("option",{value:a,children:((n=J.find(h=>h.id===a))==null?void 0:n.phone)||((o=Gs==null?void 0:Gs.find(h=>h.id===a))==null?void 0:o.phone)||((c=Gs==null?void 0:Gs.find(h=>h.id===a))==null?void 0:c.name)||((u=J.find(h=>h.id===a))==null?void 0:u.name)||a},a)})]})]}),e.jsxs("div",{className:"text-right text-sm text-gray-600",children:["Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ø¯ Ø¥Ø¶Ø§ÙØªÙ‡: ",e.jsxs("span",{className:"font-bold",children:[tu," Ø¬Ù†ÙŠÙ‡"]})]})]}),e.jsxs(Fe,{className:"flex flex-wrap justify-between gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>{Js(!1),ei(0),Ga(null),nl("")},children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(I,{disabled:Oc,onClick:async()=>{var n,o;if(Oc)return;const a=tu;if(!a||a<=0){Js(!1);return}if(!Rt){x({title:"Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ©",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø¥Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ù…Ø­ÙØ¸Ø©",variant:"destructive"});return}if(Rt==="wallet"&&!Xa){x({title:"Ø§Ø®ØªØ± Ù…Ø­ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹",description:"ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø¥Ù„ÙŠÙ‡Ø§",variant:"destructive"});return}Ec(!0),Js(!1);try{const c=async(u,h)=>{if(t!=null&&t.uid&&W)try{const p={transactionId:Pe(ce($,"dummy_collection")).id,amount:a,transactionType:"cash_addition",type:"cash_addition",status:"completed",createdAt:new Date,senderName:W.debtorName,receiverName:"Ø§Ù„Ù…Ø­Ù„",description:`Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ† Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ ${W.debtorName}`,paymentMethod:u,walletId:h||null,linkedDebtId:W.id,isDebtRepayment:!0};await oe.saveUserTransaction(t.uid,p);try{E.invalidateQueries({queryKey:["recentTransactions",t==null?void 0:t.uid]})}catch{}}catch(f){console.error("Failed to create repayment receipt:",f)}};if(Rt==="cash"){const u=qe+a;ot(u),localStorage.setItem(Ye(),u.toString());const h={cashBalance:u,lastUpdated:new Date().toISOString()},f=`userData_${t==null?void 0:t.uid}`;localStorage.setItem(f,JSON.stringify(h)),t!=null&&t.uid?(oe.updateUserData(t.uid,h).catch(()=>ve(!0)),localStorage.removeItem(f),ve(!1)):ve(!0),x({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯",description:`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${a} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ Ø§Ù„ÙÙ„ÙˆØ³ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©`}),await c("cash")}else if(Rt==="wallet"){const u={...Se,[Xa]:(Se[Xa]||0)+a};mt(u);const h=new Date().toISOString(),f={walletBalances:u,lastUpdated:h},p=`userData_${t==null?void 0:t.uid}`;if(localStorage.setItem(p,JSON.stringify(f)),localStorage.setItem(Ge(),JSON.stringify(u)),localStorage.setItem(`walletBalances_backup_${h}`,JSON.stringify(u)),t!=null&&t.uid){oe.updateUserData(t.uid,f).catch(()=>ve(!0));try{localStorage.removeItem(p)}catch{}ve(!1)}else ve(!0);x({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯",description:`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${a} Ø¬Ù†ÙŠÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø­ÙØ¸Ø© ${((n=J.find(w=>w.id===Xa))==null?void 0:n.phone)||((o=J.find(w=>w.id===Xa))==null?void 0:o.name)||Xa}`}),await c("wallet",Xa)}else Rt==="none"?x({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø³Ø¯Ø§Ø¯",description:`ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${a} Ø¬Ù†ÙŠÙ‡ Ø¨Ø¯ÙˆÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø©`}):Rt==="fawry"&&(x({title:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø³Ø¯Ø§Ø¯ Ø¹Ø¨Ø± ÙÙˆØ±ÙŠ",description:`ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${a} Ø¬Ù†ÙŠÙ‡ ÙƒØ³Ø¯Ø§Ø¯ Ø¹Ø¨Ø± ÙÙˆØ±ÙŠ Ø¨Ø¯ÙˆÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø©`}),await c("fawry"));try{if(t!=null&&t.uid&&W){const u=Number(W.amount||0),h=Number(W.paidAmount||0),f=W.status==="paid"||h>=u,p=a>0?a:h||u,w=f?`ØªÙ… Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„ ${W.debtorName}: Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ${h||p} Ø¬Ù†ÙŠÙ‡`:`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø³Ø¯Ø§Ø¯ ${p} Ø¬Ù†ÙŠÙ‡ Ù…Ù† Ø¯ÙŠÙ† Ø§Ù„Ø¹Ù…ÙŠÙ„ ${W.debtorName}`;await vs.send(t.uid,w)}}catch{}}catch(c){console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯:",c),x({title:"Ø­Ø¯Ø« Ø®Ø·Ø£",description:"ØªØ¹Ø°Ø± Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø¯Ø§Ø¯ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",variant:"destructive"})}finally{Ec(!1),ei(0),Ga(null),nl("");try{fs(!0)}catch{}}},className:"bg-green-600 hover:bg-green-700",children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©"})]})]})}),e.jsx(ue,{open:Q0,onOpenChange:ua,children:e.jsxs(me,{hideClose:!0,className:"post-confirm-card sm:max-w-[420px] w-[90vw] rounded-2xl bg-gradient-to-br from-white via-indigo-50 to-blue-50 shadow-2xl border border-indigo-100",children:[e.jsxs(be,{children:[e.jsx(pe,{className:"text-right text-2xl font-bold",children:(He==null?void 0:He.type)==="transfer"?"Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø§Ø³ØªÙ„Ø§Ù…Ù‡":"Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ ØªØ³Ù„ÙŠÙ…Ù‡"}),e.jsx(at,{className:"text-right text-gray-600",children:(He==null?void 0:He.type)==="transfer"?"Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø§Ø³ØªÙ„Ø§Ù…Ù‡ Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯.":"Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙˆØ§Ø¬Ø¨ ØªØ³Ù„ÙŠÙ…Ù‡ Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯."})]}),e.jsxs("div",{className:"py-3 flex flex-col items-center gap-1.5",children:[e.jsxs("div",{className:"text-xl sm:text-2xl font-bold text-blue-700 tracking-wide",children:[Ft((He==null?void 0:He.amount)||0)," Ø¬Ù†ÙŠÙ‡"]}),e.jsx("div",{className:"text-sm text-gray-500 text-right w-full",children:(He==null?void 0:He.type)==="transfer"?"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶ Ø´Ø§Ù…Ù„ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„.":He!=null&&He.isDeduct||!Je?"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ù…Ø®ØµÙˆÙ…Ø© Ù…Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³Ù„Ù‘Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„.":"Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ù…Ø¶Ø§ÙØ© ÙˆÙ„Ø§ ØªØ¤Ø«Ø± Ø¹Ù„Ù‰ Ù‚ÙŠÙ…Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ…."})]}),e.jsxs(Fe,{className:"flex justify-end gap-2",children:[(He==null?void 0:He.type)==="transfer"&&e.jsx(I,{variant:"default",id:"sendCodeBtn",onClick:t0,disabled:Nd,className:"btn-transfer-confirm bg-blue-600 hover:bg-blue-700 text-white border-0",children:Nd?"Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...":"Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),e.jsx(I,{onClick:()=>{ua(!1),Mo(null),Dr(null)},className:"bg-green-600 hover:bg-green-700 text-white",children:(He==null?void 0:He.type)==="transfer"?"ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…":"ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…"})]}),(He==null?void 0:He.type)==="transfer"&&e.jsx("div",{className:"mt-4 border-t pt-4 w-full",children:e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(I,{variant:Vt===0?"default":"outline",size:"sm",onClick:()=>to(0),className:`flex-1 h-10 ${Vt===0?"bg-blue-600 hover:bg-blue-700 text-white":"border-blue-200 text-blue-700 hover:bg-blue-50"}`,children:"SIM 1"}),e.jsx(I,{variant:Vt===1?"default":"outline",size:"sm",onClick:()=>to(1),className:`flex-1 h-10 ${Vt===1?"bg-blue-600 hover:bg-blue-700 text-white":"border-blue-200 text-blue-700 hover:bg-blue-50"}`,children:"SIM 2"})]})})]})}),e.jsx(jp,{open:X0,onClose:()=>Pa(!1),onSubmit:a0,deviceId:Ro||ls||"",recipientName:ef,recipientMsisdn:String(B==="transfer"?(ut==null?void 0:ut.receiver)||kt||"":((Uu=J.find(a=>a.id===M))==null?void 0:Uu.phone)||"").replace(/\D/g,"")}),e.jsx(ue,{open:Z0,onOpenChange:()=>{},children:e.jsxs(me,{className:"w-fit p-8 flex flex-col items-center justify-center gap-6",hideClose:!0,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-blue-100 rounded-full animate-ping opacity-75"}),e.jsx("div",{className:"relative bg-white p-4 rounded-full shadow-md border border-blue-100",children:e.jsx(rs,{className:"h-10 w-10 animate-spin text-blue-600"})})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-lg font-bold text-gray-800",children:"Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§..."}),e.jsx("p",{className:"text-sm text-gray-500",children:"ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ Ø¸Ù‡ÙˆØ± Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"})]})]})}),e.jsx(xw,{isOpen:tf,onClose:()=>Dd(!1),senderPhone:((Vu=J.find(a=>a.id===M))==null?void 0:Vu.phone)||"",receiverPhone:(ut==null?void 0:ut.receiver)||"",amount:Number((ut==null?void 0:ut.amount)||0),deviceId:Ro||ls||"",api:window.electronAPI}),e.jsx(ue,{open:mo==="success",onOpenChange:()=>Aa(null),children:e.jsx(me,{className:"sm:max-w-[425px]",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 gap-4",children:[e.jsx(Ri,{className:"h-16 w-16 text-green-500"}),e.jsx(pe,{className:"text-xl text-green-700",children:"ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­"}),e.jsx(I,{onClick:()=>Aa(null),className:"bg-green-600 hover:bg-green-700 w-full",children:"ØªÙ…"})]})})}),e.jsx(ue,{open:mo==="limit_exceeded",onOpenChange:()=>Aa(null),children:e.jsx(me,{className:"sm:max-w-[425px]",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 gap-4",children:[e.jsx(zp,{className:"h-16 w-16 text-red-500"}),e.jsx(pe,{className:"text-xl text-red-700",children:"ÙØ´Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„"}),e.jsx("p",{className:"text-center text-gray-600",children:"ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø§Ù‚ØµÙŠ"}),e.jsx(I,{onClick:()=>Aa(null),variant:"destructive",className:"w-full",children:"Ø¥ØºÙ„Ø§Ù‚"})]})})}),e.jsx(ue,{open:mo==="no_wallet",onOpenChange:()=>Aa(null),children:e.jsx(me,{className:"sm:max-w-[425px]",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 gap-4",children:[e.jsx(Rl,{className:"h-16 w-16 text-yellow-500"}),e.jsx(pe,{className:"text-xl text-yellow-700",children:"ØªÙ†Ø¨ÙŠÙ‡"}),e.jsxs("p",{className:"text-center text-gray-600",children:["Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ÙØ¸Ù‡ Ù…Ø³Ø¬Ù„Ù‡ Ø¹Ù„ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…",e.jsx("br",{}),"ØªØ§ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ù‡ Ø§Ø®Ø±ÙŠ"]}),e.jsx(I,{onClick:()=>Aa(null),className:"bg-yellow-600 hover:bg-yellow-700 w-full",children:"Ø­Ø³Ù†Ø§Ù‹"})]})})}),e.jsx(ue,{open:u0,onOpenChange:()=>{},children:e.jsxs(me,{className:"w-fit p-8 flex flex-col items-center justify-center gap-6",hideClose:!0,children:[e.jsx(rs,{className:"h-10 w-10 animate-spin text-blue-600"}),e.jsx("p",{className:"text-lg font-bold text-gray-800",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ©..."})]})}),e.jsx(Ww,{isOpen:M0,onClose:()=>Io(!1),wallets:J,walletBalances:Se,userId:t==null?void 0:t.uid,onSelectWallet:a=>{xr(a);const n=J.find(o=>o.id===a);if(n){Rs(n.phone);try{localStorage.setItem(ps(),a)}catch{}}Io(!1)},selectedWalletId:M||void 0}),e.jsx($w,{open:Oh,onOpenChange:Eh}),e.jsx(yw,{open:Rh,onOpenChange:gr}),!1,Ve&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-white dark:bg-slate-950 overflow-y-auto",children:e.jsx(Sp,{onBack:()=>ct(!1),eyeComfortMode:qs,setEyeComfortMode:qd})}),e.jsx(ue,{open:Do,onOpenChange:ko,children:e.jsxs(me,{className:"sm:max-w-md",dir:"rtl",children:[e.jsxs(be,{children:[e.jsx(pe,{children:"ØªÙ‚Ø§Ø±ÙŠØ±Ùƒ"}),e.jsx(at,{children:"Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø«Ù… Ø­Ø¯Ù‘Ø¯ Ø§Ù„Ø´Ù‡Ø± Ø£Ùˆ Ø§Ù„ÙŠÙˆÙ…"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs(kp,{value:Mn,onValueChange:a=>C0(a),children:[e.jsxs(Cp,{className:"grid grid-cols-2 w-full",children:[e.jsx(im,{value:"monthly",children:"ØªÙ‚Ø§Ø±ÙŠØ± Ø´Ù‡Ø±"}),e.jsx(im,{value:"daily",children:"ØªÙ‚Ø§Ø±ÙŠØ± ÙŠÙˆÙ…"})]}),e.jsx(om,{value:"monthly",className:"mt-3",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(Q,{className:"text-right",children:"Ø§Ù„Ø´Ù‡Ø±"}),e.jsxs(mm,{children:[e.jsx(hm,{asChild:!0,children:e.jsxs(I,{variant:"outline",className:Da("w-full justify-start text-left font-normal",!Ja&&"text-muted-foreground"),children:[e.jsx(Ti,{className:"mr-2 h-4 w-4"}),Ja?ga(new Date(`${Ja}-01`),"LLLL yyyy",{locale:bm}):e.jsx("span",{children:"Ø§Ø®ØªØ± Ø´Ù‡Ø±"})]})}),e.jsx(Ql,{className:"w-auto p-0",align:"start",children:e.jsx(Zl,{mode:"single",selected:Ja?new Date(`${Ja}-01`):void 0,onSelect:a=>I0(a?ga(a,"yyyy-MM"):""),initialFocus:!0})})]})]})}),e.jsx(om,{value:"daily",className:"mt-3",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(Q,{className:"text-right",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsxs(mm,{children:[e.jsx(hm,{asChild:!0,children:e.jsxs(I,{variant:"outline",className:Da("w-full justify-start text-left font-normal",!Ka&&"text-muted-foreground"),children:[e.jsx(Ti,{className:"mr-2 h-4 w-4"}),Ka?ga(new Date(Ka),"PPP",{locale:bm}):e.jsx("span",{children:"Ø§Ø®ØªØ± ØªØ§Ø±ÙŠØ®"})]})}),e.jsx(Ql,{className:"w-auto p-0",align:"start",children:e.jsx(Zl,{mode:"single",selected:Ka?new Date(Ka):void 0,onSelect:a=>k0(a?ga(a,"yyyy-MM-dd"):""),initialFocus:!0})})]})]})})]}),Bs&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 p-3 rounded-lg border border-blue-100 dark:border-blue-900/30",children:[e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 mb-1",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"}),e.jsx("div",{className:"text-lg font-bold text-blue-800 dark:text-blue-200",children:Bs.count})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-3 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº"}),e.jsx("div",{className:"text-lg font-bold text-gray-800 dark:text-gray-200",children:Bs.totalAmount.toFixed(2)})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-950/20 p-3 rounded-lg border border-red-100 dark:border-red-900/30",children:[e.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 mb-1",children:"Ø§Ù„Ù…Ø³Ø­ÙˆØ¨"}),e.jsx("div",{className:"text-lg font-bold text-red-800 dark:text-red-200",children:Bs.totalWithdrawn.toFixed(2)})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-950/20 p-3 rounded-lg border border-green-100 dark:border-green-900/30",children:[e.jsx("div",{className:"text-xs text-green-600 dark:text-green-400 mb-1",children:"Ø§Ù„Ù…Ø±Ø³Ù„"}),e.jsx("div",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:Bs.totalSent.toFixed(2)})]}),e.jsx("div",{className:"col-span-2 bg-yellow-50 dark:bg-yellow-950/20 p-3 rounded-lg border border-yellow-100 dark:border-yellow-900/30",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),e.jsx("div",{className:"text-lg font-bold text-yellow-800 dark:text-yellow-200",children:Bs.totalProfit.toFixed(2)})]})})]})]})]})}),e.jsx(uw,{isOpen:st,onClose:()=>H(!1),userId:(t==null?void 0:t.uid)||"",wallets:J,walletBalances:Se}),e.jsx(Lw,{isOpen:Z,onClose:()=>yt(!1)}),e.jsx(ue,{open:Ut,onOpenChange:Me,children:e.jsxs(me,{className:"sm:max-w-md",dir:"rtl",children:[e.jsx(be,{children:e.jsxs(pe,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(em,{className:"h-5 w-5"}),"ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„"]})}),e.jsxs("div",{className:"flex flex-col items-center justify-center py-4 space-y-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(em,{className:"h-6 w-6 text-red-600"})}),e.jsxs("p",{className:"text-center text-gray-600",children:["Ø¹ÙÙˆØ§Ù‹ØŒ Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù….",e.jsx("br",{}),"ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ù…Ù† Ù‚Ø¨Ù„ Ù…Ø§Ù„Ùƒ Ø§Ù„Ø­Ø³Ø§Ø¨."]})]}),e.jsx(Fe,{className:"sm:justify-center",children:e.jsx(I,{variant:"outline",onClick:()=>Me(!1),className:"w-full sm:w-auto",children:"Ø­Ø³Ù†Ø§Ù‹"})})]})}),e.jsx(mx,{isOpen:q,onClose:xe,userName:(i==null?void 0:i.name)||((qu=t==null?void 0:t.displayName)==null?void 0:qu.split(" ")[0])||""}),e.jsx(Em,{isOpen:ne,onClose:()=>K(!1),videoUrl:U,title:Ie})]}))},$N=Object.freeze(Object.defineProperty({__proto__:null,default:Vw},Symbol.toStringTag,{value:"Module"}));export{Zl as C,Rm as P,$N as U,ja as a,ir as b,Sa as c,Gm as d,mm as e,hm as f,ga as g,Ql as h};
//# sourceMappingURL=UserDashboardPage-8yy5stmd.js.map
