const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./LandingPage-DVTyL0Q1.js","./smartphone-C8aaHuOt.js","./whatsappService-ayZ9AmBf.js","./star-BUl7nXNo.js","./chart-column-BOEFQMCG.js","./zap-tW6qZxBc.js","./circle-check-big-C85Ma9-W.js","./crown-eH9728mc.js","./SubscriptionsPage-wgWSpbRi.js","./contentService-Dc2_xffk.js","./calendar-B6wCJ-48.js","./arrow-left-BnhAVXv5.js","./sparkles-C4gW8V6b.js","./AuthPage-C2hVCyqS.js","./download-HXBKTopl.js","./TopUpPage-_OcaxJsU.js","./select-CQoGb_cR.js","./AdminTopupsPage-DfYFQ7LF.js","./AdminNotificationsPage-DkwwwvJV.js","./textarea-Iv9lg92g.js","./bell-9FJpIPx_.js","./link-Byxj5llr.js","./UserRegisterPage-NTjUFk9l.js","./alert-C0xbMQWb.js","./wallet-CXLK-p8Q.js","./user-plus-EXSV2D9y.js","./phone-CsW_Skzd.js","./UserAccountSetupPage-VcbTq3Yn.js","./ProtectedDashboard-CyOIfrl1.js","./MasterPinDialog-BwapmE19.js","./circle-alert-NzwhoXxt.js","./profitService-oNUfz-Yd.js","./dollar-sign-DFJExlvM.js","./arrow-down-left-CCb1RSBR.js","./ProtectedUserDashboard-Bw0jIEWh.js","./broadcastService-DNYztVcb.js","./MerchantDashboard-hXK39CCT.js","./dropdown-menu-CwogjdTa.js","./index-3bJ5wXi7.js","./badge-Dkne3qZK.js","./WalletsManagement-BnuXLgGs.js","./progress-CPYwaj7F.js","./WalletPrinterDialog-B_XVffl4.js","./html2canvas.esm-BfYXEYrK.js","./printer-B9qPCfB-.js","./square-pen-DcDaycsB.js","./trash-2-BKuXmImO.js","./PendingApprovalPage-BjLJ_DJk.js","./freeTrialService-Bh07mM2p.js","./ProtectedAdminDashboard-DQVforqD.js","./ProfileIcon-BlwDaKTr.js","./switch-P5M31eDV.js","./separator-B89kj3pz.js","./refresh-cw-C3jRi4Z9.js","./gift-DnIxJM9P.js","./table-CqhRXNHR.js","./tabs-DJqmAibK.js","./search-hg-NjxH6.js","./users-DTFR_sXy.js","./activity-CXWcyp0b.js","./circle-x-Cc6eogP3.js","./pen-line-CxQ8AYSB.js","./ProfileSettingsPage-JYQlk0op.js","./TransactionsPage-CbJ7dIg_.js","./ReceiptModal-DeXWkBTO.js","./formatters-Bxe0AUcL.js","./InstallmentModal-DaR2ryhG.js","./CreditCardsDialog-DqI3ZvJY.js","./MaintenanceDialog-Dy_IYtNd.js","./WalletAdditionPage-CPGGosBb.js","./ReferralsPage-C-HZF4Rl.js","./UserDashboardPage-C8E2BvSp.js"])))=>i.map(i=>d[i]);
var IV=Object.defineProperty;var JT=t=>{throw TypeError(t)};var TV=(t,e,n)=>e in t?IV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var pd=(t,e,n)=>TV(t,typeof e!="symbol"?e+"":e,n),By=(t,e,n)=>e.has(t)||JT("Cannot "+n);var Y=(t,e,n)=>(By(t,e,"read from private field"),n?n.call(t):e.get(t)),pt=(t,e,n)=>e.has(t)?JT("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),qe=(t,e,n,r)=>(By(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),ur=(t,e,n)=>(By(t,e,"access private method"),n);var $f=(t,e,n,r)=>({set _(s){qe(t,e,s,n)},get _(){return Y(t,e,r)}});function SV(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function bP(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var AP={exports:{}},Tg={},xP={exports:{}},ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rf=Symbol.for("react.element"),bV=Symbol.for("react.portal"),AV=Symbol.for("react.fragment"),xV=Symbol.for("react.strict_mode"),RV=Symbol.for("react.profiler"),PV=Symbol.for("react.provider"),CV=Symbol.for("react.context"),kV=Symbol.for("react.forward_ref"),NV=Symbol.for("react.suspense"),DV=Symbol.for("react.memo"),OV=Symbol.for("react.lazy"),XT=Symbol.iterator;function LV(t){return t===null||typeof t!="object"?null:(t=XT&&t[XT]||t["@@iterator"],typeof t=="function"?t:null)}var RP={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},PP=Object.assign,CP={};function Fu(t,e,n){this.props=t,this.context=e,this.refs=CP,this.updater=n||RP}Fu.prototype.isReactComponent={};Fu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Fu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kP(){}kP.prototype=Fu.prototype;function f0(t,e,n){this.props=t,this.context=e,this.refs=CP,this.updater=n||RP}var m0=f0.prototype=new kP;m0.constructor=f0;PP(m0,Fu.prototype);m0.isPureReactComponent=!0;var ZT=Array.isArray,NP=Object.prototype.hasOwnProperty,p0={current:null},DP={key:!0,ref:!0,__self:!0,__source:!0};function OP(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)NP.call(e,r)&&!DP.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:rf,type:t,key:i,ref:o,props:s,_owner:p0.current}}function MV(t,e){return{$$typeof:rf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function g0(t){return typeof t=="object"&&t!==null&&t.$$typeof===rf}function VV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var eS=/\/+/g;function zy(t,e){return typeof t=="object"&&t!==null&&t.key!=null?VV(""+t.key):e.toString(36)}function Pm(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case rf:case bV:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+zy(o,0):r,ZT(s)?(n="",t!=null&&(n=t.replace(eS,"$&/")+"/"),Pm(s,e,n,"",function(c){return c})):s!=null&&(g0(s)&&(s=MV(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(eS,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",ZT(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+zy(i,a);o+=Pm(i,e,n,l,s)}else if(l=LV(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+zy(i,a++),o+=Pm(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Bf(t,e,n){if(t==null)return t;var r=[],s=0;return Pm(t,r,"","",function(i){return e.call(n,i,s++)}),r}function FV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var xr={current:null},Cm={transition:null},UV={ReactCurrentDispatcher:xr,ReactCurrentBatchConfig:Cm,ReactCurrentOwner:p0};function LP(){throw Error("act(...) is not supported in production builds of React.")}ct.Children={map:Bf,forEach:function(t,e,n){Bf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Bf(t,function(){e++}),e},toArray:function(t){return Bf(t,function(e){return e})||[]},only:function(t){if(!g0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ct.Component=Fu;ct.Fragment=AV;ct.Profiler=RV;ct.PureComponent=f0;ct.StrictMode=xV;ct.Suspense=NV;ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UV;ct.act=LP;ct.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=PP({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=p0.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)NP.call(e,l)&&!DP.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:rf,type:t.type,key:s,ref:i,props:r,_owner:o}};ct.createContext=function(t){return t={$$typeof:CV,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:PV,_context:t},t.Consumer=t};ct.createElement=OP;ct.createFactory=function(t){var e=OP.bind(null,t);return e.type=t,e};ct.createRef=function(){return{current:null}};ct.forwardRef=function(t){return{$$typeof:kV,render:t}};ct.isValidElement=g0;ct.lazy=function(t){return{$$typeof:OV,_payload:{_status:-1,_result:t},_init:FV}};ct.memo=function(t,e){return{$$typeof:DV,type:t,compare:e===void 0?null:e}};ct.startTransition=function(t){var e=Cm.transition;Cm.transition={};try{t()}finally{Cm.transition=e}};ct.unstable_act=LP;ct.useCallback=function(t,e){return xr.current.useCallback(t,e)};ct.useContext=function(t){return xr.current.useContext(t)};ct.useDebugValue=function(){};ct.useDeferredValue=function(t){return xr.current.useDeferredValue(t)};ct.useEffect=function(t,e){return xr.current.useEffect(t,e)};ct.useId=function(){return xr.current.useId()};ct.useImperativeHandle=function(t,e,n){return xr.current.useImperativeHandle(t,e,n)};ct.useInsertionEffect=function(t,e){return xr.current.useInsertionEffect(t,e)};ct.useLayoutEffect=function(t,e){return xr.current.useLayoutEffect(t,e)};ct.useMemo=function(t,e){return xr.current.useMemo(t,e)};ct.useReducer=function(t,e,n){return xr.current.useReducer(t,e,n)};ct.useRef=function(t){return xr.current.useRef(t)};ct.useState=function(t){return xr.current.useState(t)};ct.useSyncExternalStore=function(t,e,n){return xr.current.useSyncExternalStore(t,e,n)};ct.useTransition=function(){return xr.current.useTransition()};ct.version="18.3.1";xP.exports=ct;var S=xP.exports;const F=bP(S),y0=SV({__proto__:null,default:F},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jV=S,$V=Symbol.for("react.element"),BV=Symbol.for("react.fragment"),zV=Object.prototype.hasOwnProperty,WV=jV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qV={key:!0,ref:!0,__self:!0,__source:!0};function MP(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)zV.call(e,r)&&!qV.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:$V,type:t,key:i,ref:o,props:s,_owner:WV.current}}Tg.Fragment=BV;Tg.jsx=MP;Tg.jsxs=MP;AP.exports=Tg;var v=AP.exports,VP={exports:{}},as={},FP={exports:{}},UP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,q){var X=$.length;$.push(q);e:for(;0<X;){var we=X-1>>>1,Ie=$[we];if(0<s(Ie,q))$[we]=q,$[X]=Ie,X=we;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var q=$[0],X=$.pop();if(X!==q){$[0]=X;e:for(var we=0,Ie=$.length,re=Ie>>>1;we<re;){var ve=2*(we+1)-1,j=$[ve],Ge=ve+1,Fe=$[Ge];if(0>s(j,X))Ge<Ie&&0>s(Fe,j)?($[we]=Fe,$[Ge]=X,we=Ge):($[we]=j,$[ve]=X,we=ve);else if(Ge<Ie&&0>s(Fe,X))$[we]=Fe,$[Ge]=X,we=Ge;else break e}}return q}function s($,q){var X=$.sortIndex-q.sortIndex;return X!==0?X:$.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,f=3,m=!1,E=!1,p=!1,I=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w($){for(var q=n(c);q!==null;){if(q.callback===null)r(c);else if(q.startTime<=$)r(c),q.sortIndex=q.expirationTime,e(l,q);else break;q=n(c)}}function A($){if(p=!1,w($),!E)if(n(l)!==null)E=!0,he(P);else{var q=n(c);q!==null&&Se(A,q.startTime-$)}}function P($,q){E=!1,p&&(p=!1,g(T),T=-1),m=!0;var X=f;try{for(w(q),h=n(l);h!==null&&(!(h.expirationTime>q)||$&&!D());){var we=h.callback;if(typeof we=="function"){h.callback=null,f=h.priorityLevel;var Ie=we(h.expirationTime<=q);q=t.unstable_now(),typeof Ie=="function"?h.callback=Ie:h===n(l)&&r(l),w(q)}else r(l);h=n(l)}if(h!==null)var re=!0;else{var ve=n(c);ve!==null&&Se(A,ve.startTime-q),re=!1}return re}finally{h=null,f=X,m=!1}}var L=!1,x=null,T=-1,R=5,C=-1;function D(){return!(t.unstable_now()-C<R)}function O(){if(x!==null){var $=t.unstable_now();C=$;var q=!0;try{q=x(!0,$)}finally{q?k():(L=!1,x=null)}}else L=!1}var k;if(typeof _=="function")k=function(){_(O)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,ce=B.port2;B.port1.onmessage=O,k=function(){ce.postMessage(null)}}else k=function(){I(O,0)};function he($){x=$,L||(L=!0,k())}function Se($,q){T=I(function(){$(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){E||m||(E=!0,he(P))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function($){switch(f){case 1:case 2:case 3:var q=3;break;default:q=f}var X=f;f=q;try{return $()}finally{f=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,q){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var X=f;f=$;try{return q()}finally{f=X}},t.unstable_scheduleCallback=function($,q,X){var we=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?we+X:we):X=we,$){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=X+Ie,$={id:u++,callback:q,priorityLevel:$,startTime:X,expirationTime:Ie,sortIndex:-1},X>we?($.sortIndex=X,e(c,$),n(l)===null&&$===n(c)&&(p?(g(T),T=-1):p=!0,Se(A,X-we))):($.sortIndex=Ie,e(l,$),E||m||(E=!0,he(P))),$},t.unstable_shouldYield=D,t.unstable_wrapCallback=function($){var q=f;return function(){var X=f;f=q;try{return $.apply(this,arguments)}finally{f=X}}}})(UP);FP.exports=UP;var HV=FP.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KV=S,ss=HV;function le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jP=new Set,mh={};function Ml(t,e){ru(t,e),ru(t+"Capture",e)}function ru(t,e){for(mh[t]=e,t=0;t<e.length;t++)jP.add(e[t])}var Ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),o_=Object.prototype.hasOwnProperty,GV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,tS={},nS={};function QV(t){return o_.call(nS,t)?!0:o_.call(tS,t)?!1:GV.test(t)?nS[t]=!0:(tS[t]=!0,!1)}function YV(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function JV(t,e,n,r){if(e===null||typeof e>"u"||YV(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Rr(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ar={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ar[t]=new Rr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ar[e]=new Rr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ar[t]=new Rr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ar[t]=new Rr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ar[t]=new Rr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ar[t]=new Rr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ar[t]=new Rr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ar[t]=new Rr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ar[t]=new Rr(t,5,!1,t.toLowerCase(),null,!1,!1)});var v0=/[\-:]([a-z])/g;function _0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(v0,_0);ar[e]=new Rr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(v0,_0);ar[e]=new Rr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(v0,_0);ar[e]=new Rr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ar[t]=new Rr(t,1,!1,t.toLowerCase(),null,!1,!1)});ar.xlinkHref=new Rr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ar[t]=new Rr(t,1,!1,t.toLowerCase(),null,!0,!0)});function w0(t,e,n,r){var s=ar.hasOwnProperty(e)?ar[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(JV(e,n,s,r)&&(n=null),r||s===null?QV(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Yi=KV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zf=Symbol.for("react.element"),fc=Symbol.for("react.portal"),mc=Symbol.for("react.fragment"),E0=Symbol.for("react.strict_mode"),a_=Symbol.for("react.profiler"),$P=Symbol.for("react.provider"),BP=Symbol.for("react.context"),I0=Symbol.for("react.forward_ref"),l_=Symbol.for("react.suspense"),c_=Symbol.for("react.suspense_list"),T0=Symbol.for("react.memo"),wo=Symbol.for("react.lazy"),zP=Symbol.for("react.offscreen"),rS=Symbol.iterator;function gd(t){return t===null||typeof t!="object"?null:(t=rS&&t[rS]||t["@@iterator"],typeof t=="function"?t:null)}var ln=Object.assign,Wy;function Nd(t){if(Wy===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wy=e&&e[1]||""}return`
`+Wy+t}var qy=!1;function Hy(t,e){if(!t||qy)return"";qy=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{qy=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Nd(t):""}function XV(t){switch(t.tag){case 5:return Nd(t.type);case 16:return Nd("Lazy");case 13:return Nd("Suspense");case 19:return Nd("SuspenseList");case 0:case 2:case 15:return t=Hy(t.type,!1),t;case 11:return t=Hy(t.type.render,!1),t;case 1:return t=Hy(t.type,!0),t;default:return""}}function u_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case mc:return"Fragment";case fc:return"Portal";case a_:return"Profiler";case E0:return"StrictMode";case l_:return"Suspense";case c_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case BP:return(t.displayName||"Context")+".Consumer";case $P:return(t._context.displayName||"Context")+".Provider";case I0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case T0:return e=t.displayName||null,e!==null?e:u_(t.type)||"Memo";case wo:e=t._payload,t=t._init;try{return u_(t(e))}catch{}}return null}function ZV(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return u_(e);case 8:return e===E0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ia(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function WP(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function eF(t){var e=WP(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Wf(t){t._valueTracker||(t._valueTracker=eF(t))}function qP(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=WP(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function up(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function d_(t,e){var n=e.checked;return ln({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function sS(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ia(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function HP(t,e){e=e.checked,e!=null&&w0(t,"checked",e,!1)}function h_(t,e){HP(t,e);var n=ia(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?f_(t,e.type,n):e.hasOwnProperty("defaultValue")&&f_(t,e.type,ia(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function iS(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function f_(t,e,n){(e!=="number"||up(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Dd=Array.isArray;function Nc(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ia(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function m_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(le(91));return ln({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function oS(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(le(92));if(Dd(n)){if(1<n.length)throw Error(le(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ia(n)}}function KP(t,e){var n=ia(e.value),r=ia(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function aS(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function GP(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function p_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?GP(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var qf,QP=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(qf=qf||document.createElement("div"),qf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=qf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ph(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Wd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tF=["Webkit","ms","Moz","O"];Object.keys(Wd).forEach(function(t){tF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Wd[e]=Wd[t]})});function YP(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Wd.hasOwnProperty(t)&&Wd[t]?(""+e).trim():e+"px"}function JP(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=YP(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var nF=ln({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function g_(t,e){if(e){if(nF[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(le(62))}}function y_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var v_=null;function S0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var __=null,Dc=null,Oc=null;function lS(t){if(t=af(t)){if(typeof __!="function")throw Error(le(280));var e=t.stateNode;e&&(e=Rg(e),__(t.stateNode,t.type,e))}}function XP(t){Dc?Oc?Oc.push(t):Oc=[t]:Dc=t}function ZP(){if(Dc){var t=Dc,e=Oc;if(Oc=Dc=null,lS(t),e)for(t=0;t<e.length;t++)lS(e[t])}}function e1(t,e){return t(e)}function t1(){}var Ky=!1;function n1(t,e,n){if(Ky)return t(e,n);Ky=!0;try{return e1(t,e,n)}finally{Ky=!1,(Dc!==null||Oc!==null)&&(t1(),ZP())}}function gh(t,e){var n=t.stateNode;if(n===null)return null;var r=Rg(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(le(231,e,typeof n));return n}var w_=!1;if(Ui)try{var yd={};Object.defineProperty(yd,"passive",{get:function(){w_=!0}}),window.addEventListener("test",yd,yd),window.removeEventListener("test",yd,yd)}catch{w_=!1}function rF(t,e,n,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var qd=!1,dp=null,hp=!1,E_=null,sF={onError:function(t){qd=!0,dp=t}};function iF(t,e,n,r,s,i,o,a,l){qd=!1,dp=null,rF.apply(sF,arguments)}function oF(t,e,n,r,s,i,o,a,l){if(iF.apply(this,arguments),qd){if(qd){var c=dp;qd=!1,dp=null}else throw Error(le(198));hp||(hp=!0,E_=c)}}function Vl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function r1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function cS(t){if(Vl(t)!==t)throw Error(le(188))}function aF(t){var e=t.alternate;if(!e){if(e=Vl(t),e===null)throw Error(le(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return cS(s),t;if(i===r)return cS(s),e;i=i.sibling}throw Error(le(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(le(189))}}if(n.alternate!==r)throw Error(le(190))}if(n.tag!==3)throw Error(le(188));return n.stateNode.current===n?t:e}function s1(t){return t=aF(t),t!==null?i1(t):null}function i1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=i1(t);if(e!==null)return e;t=t.sibling}return null}var o1=ss.unstable_scheduleCallback,uS=ss.unstable_cancelCallback,lF=ss.unstable_shouldYield,cF=ss.unstable_requestPaint,gn=ss.unstable_now,uF=ss.unstable_getCurrentPriorityLevel,b0=ss.unstable_ImmediatePriority,a1=ss.unstable_UserBlockingPriority,fp=ss.unstable_NormalPriority,dF=ss.unstable_LowPriority,l1=ss.unstable_IdlePriority,Sg=null,ai=null;function hF(t){if(ai&&typeof ai.onCommitFiberRoot=="function")try{ai.onCommitFiberRoot(Sg,t,void 0,(t.current.flags&128)===128)}catch{}}var Cs=Math.clz32?Math.clz32:pF,fF=Math.log,mF=Math.LN2;function pF(t){return t>>>=0,t===0?32:31-(fF(t)/mF|0)|0}var Hf=64,Kf=4194304;function Od(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function mp(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Od(a):(i&=o,i!==0&&(r=Od(i)))}else o=n&~s,o!==0?r=Od(o):i!==0&&(r=Od(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Cs(e),s=1<<n,r|=t[n],e&=~s;return r}function gF(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yF(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Cs(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=gF(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function I_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function c1(){var t=Hf;return Hf<<=1,!(Hf&4194240)&&(Hf=64),t}function Gy(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function sf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Cs(e),t[e]=n}function vF(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Cs(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function A0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Cs(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var At=0;function u1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var d1,x0,h1,f1,m1,T_=!1,Gf=[],Wo=null,qo=null,Ho=null,yh=new Map,vh=new Map,To=[],_F="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dS(t,e){switch(t){case"focusin":case"focusout":Wo=null;break;case"dragenter":case"dragleave":qo=null;break;case"mouseover":case"mouseout":Ho=null;break;case"pointerover":case"pointerout":yh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":vh.delete(e.pointerId)}}function vd(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=af(e),e!==null&&x0(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function wF(t,e,n,r,s){switch(e){case"focusin":return Wo=vd(Wo,t,e,n,r,s),!0;case"dragenter":return qo=vd(qo,t,e,n,r,s),!0;case"mouseover":return Ho=vd(Ho,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return yh.set(i,vd(yh.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,vh.set(i,vd(vh.get(i)||null,t,e,n,r,s)),!0}return!1}function p1(t){var e=Xa(t.target);if(e!==null){var n=Vl(e);if(n!==null){if(e=n.tag,e===13){if(e=r1(n),e!==null){t.blockedOn=e,m1(t.priority,function(){h1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function km(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=S_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);v_=r,n.target.dispatchEvent(r),v_=null}else return e=af(n),e!==null&&x0(e),t.blockedOn=n,!1;e.shift()}return!0}function hS(t,e,n){km(t)&&n.delete(e)}function EF(){T_=!1,Wo!==null&&km(Wo)&&(Wo=null),qo!==null&&km(qo)&&(qo=null),Ho!==null&&km(Ho)&&(Ho=null),yh.forEach(hS),vh.forEach(hS)}function _d(t,e){t.blockedOn===e&&(t.blockedOn=null,T_||(T_=!0,ss.unstable_scheduleCallback(ss.unstable_NormalPriority,EF)))}function _h(t){function e(s){return _d(s,t)}if(0<Gf.length){_d(Gf[0],t);for(var n=1;n<Gf.length;n++){var r=Gf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Wo!==null&&_d(Wo,t),qo!==null&&_d(qo,t),Ho!==null&&_d(Ho,t),yh.forEach(e),vh.forEach(e),n=0;n<To.length;n++)r=To[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<To.length&&(n=To[0],n.blockedOn===null);)p1(n),n.blockedOn===null&&To.shift()}var Lc=Yi.ReactCurrentBatchConfig,pp=!0;function IF(t,e,n,r){var s=At,i=Lc.transition;Lc.transition=null;try{At=1,R0(t,e,n,r)}finally{At=s,Lc.transition=i}}function TF(t,e,n,r){var s=At,i=Lc.transition;Lc.transition=null;try{At=4,R0(t,e,n,r)}finally{At=s,Lc.transition=i}}function R0(t,e,n,r){if(pp){var s=S_(t,e,n,r);if(s===null)sv(t,e,r,gp,n),dS(t,r);else if(wF(s,t,e,n,r))r.stopPropagation();else if(dS(t,r),e&4&&-1<_F.indexOf(t)){for(;s!==null;){var i=af(s);if(i!==null&&d1(i),i=S_(t,e,n,r),i===null&&sv(t,e,r,gp,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else sv(t,e,r,null,n)}}var gp=null;function S_(t,e,n,r){if(gp=null,t=S0(r),t=Xa(t),t!==null)if(e=Vl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=r1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return gp=t,null}function g1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(uF()){case b0:return 1;case a1:return 4;case fp:case dF:return 16;case l1:return 536870912;default:return 16}default:return 16}}var Vo=null,P0=null,Nm=null;function y1(){if(Nm)return Nm;var t,e=P0,n=e.length,r,s="value"in Vo?Vo.value:Vo.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Nm=s.slice(t,1<r?1-r:void 0)}function Dm(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Qf(){return!0}function fS(){return!1}function ls(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Qf:fS,this.isPropagationStopped=fS,this}return ln(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Qf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Qf)},persist:function(){},isPersistent:Qf}),e}var Uu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},C0=ls(Uu),of=ln({},Uu,{view:0,detail:0}),SF=ls(of),Qy,Yy,wd,bg=ln({},of,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:k0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wd&&(wd&&t.type==="mousemove"?(Qy=t.screenX-wd.screenX,Yy=t.screenY-wd.screenY):Yy=Qy=0,wd=t),Qy)},movementY:function(t){return"movementY"in t?t.movementY:Yy}}),mS=ls(bg),bF=ln({},bg,{dataTransfer:0}),AF=ls(bF),xF=ln({},of,{relatedTarget:0}),Jy=ls(xF),RF=ln({},Uu,{animationName:0,elapsedTime:0,pseudoElement:0}),PF=ls(RF),CF=ln({},Uu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),kF=ls(CF),NF=ln({},Uu,{data:0}),pS=ls(NF),DF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},OF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function MF(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=LF[t])?!!e[t]:!1}function k0(){return MF}var VF=ln({},of,{key:function(t){if(t.key){var e=DF[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Dm(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?OF[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:k0,charCode:function(t){return t.type==="keypress"?Dm(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Dm(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),FF=ls(VF),UF=ln({},bg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gS=ls(UF),jF=ln({},of,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:k0}),$F=ls(jF),BF=ln({},Uu,{propertyName:0,elapsedTime:0,pseudoElement:0}),zF=ls(BF),WF=ln({},bg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),qF=ls(WF),HF=[9,13,27,32],N0=Ui&&"CompositionEvent"in window,Hd=null;Ui&&"documentMode"in document&&(Hd=document.documentMode);var KF=Ui&&"TextEvent"in window&&!Hd,v1=Ui&&(!N0||Hd&&8<Hd&&11>=Hd),yS=" ",vS=!1;function _1(t,e){switch(t){case"keyup":return HF.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function w1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var pc=!1;function GF(t,e){switch(t){case"compositionend":return w1(e);case"keypress":return e.which!==32?null:(vS=!0,yS);case"textInput":return t=e.data,t===yS&&vS?null:t;default:return null}}function QF(t,e){if(pc)return t==="compositionend"||!N0&&_1(t,e)?(t=y1(),Nm=P0=Vo=null,pc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return v1&&e.locale!=="ko"?null:e.data;default:return null}}var YF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _S(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!YF[t.type]:e==="textarea"}function E1(t,e,n,r){XP(r),e=yp(e,"onChange"),0<e.length&&(n=new C0("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Kd=null,wh=null;function JF(t){N1(t,0)}function Ag(t){var e=vc(t);if(qP(e))return t}function XF(t,e){if(t==="change")return e}var I1=!1;if(Ui){var Xy;if(Ui){var Zy="oninput"in document;if(!Zy){var wS=document.createElement("div");wS.setAttribute("oninput","return;"),Zy=typeof wS.oninput=="function"}Xy=Zy}else Xy=!1;I1=Xy&&(!document.documentMode||9<document.documentMode)}function ES(){Kd&&(Kd.detachEvent("onpropertychange",T1),wh=Kd=null)}function T1(t){if(t.propertyName==="value"&&Ag(wh)){var e=[];E1(e,wh,t,S0(t)),n1(JF,e)}}function ZF(t,e,n){t==="focusin"?(ES(),Kd=e,wh=n,Kd.attachEvent("onpropertychange",T1)):t==="focusout"&&ES()}function eU(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ag(wh)}function tU(t,e){if(t==="click")return Ag(e)}function nU(t,e){if(t==="input"||t==="change")return Ag(e)}function rU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Os=typeof Object.is=="function"?Object.is:rU;function Eh(t,e){if(Os(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!o_.call(e,s)||!Os(t[s],e[s]))return!1}return!0}function IS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function TS(t,e){var n=IS(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=IS(n)}}function S1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?S1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function b1(){for(var t=window,e=up();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=up(t.document)}return e}function D0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function sU(t){var e=b1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&S1(n.ownerDocument.documentElement,n)){if(r!==null&&D0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=TS(n,i);var o=TS(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var iU=Ui&&"documentMode"in document&&11>=document.documentMode,gc=null,b_=null,Gd=null,A_=!1;function SS(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;A_||gc==null||gc!==up(r)||(r=gc,"selectionStart"in r&&D0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Gd&&Eh(Gd,r)||(Gd=r,r=yp(b_,"onSelect"),0<r.length&&(e=new C0("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=gc)))}function Yf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var yc={animationend:Yf("Animation","AnimationEnd"),animationiteration:Yf("Animation","AnimationIteration"),animationstart:Yf("Animation","AnimationStart"),transitionend:Yf("Transition","TransitionEnd")},ev={},A1={};Ui&&(A1=document.createElement("div").style,"AnimationEvent"in window||(delete yc.animationend.animation,delete yc.animationiteration.animation,delete yc.animationstart.animation),"TransitionEvent"in window||delete yc.transitionend.transition);function xg(t){if(ev[t])return ev[t];if(!yc[t])return t;var e=yc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in A1)return ev[t]=e[n];return t}var x1=xg("animationend"),R1=xg("animationiteration"),P1=xg("animationstart"),C1=xg("transitionend"),k1=new Map,bS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ya(t,e){k1.set(t,e),Ml(e,[t])}for(var tv=0;tv<bS.length;tv++){var nv=bS[tv],oU=nv.toLowerCase(),aU=nv[0].toUpperCase()+nv.slice(1);ya(oU,"on"+aU)}ya(x1,"onAnimationEnd");ya(R1,"onAnimationIteration");ya(P1,"onAnimationStart");ya("dblclick","onDoubleClick");ya("focusin","onFocus");ya("focusout","onBlur");ya(C1,"onTransitionEnd");ru("onMouseEnter",["mouseout","mouseover"]);ru("onMouseLeave",["mouseout","mouseover"]);ru("onPointerEnter",["pointerout","pointerover"]);ru("onPointerLeave",["pointerout","pointerover"]);Ml("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ml("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ml("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ml("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ml("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ml("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ld="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lU=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ld));function AS(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,oF(r,e,void 0,t),t.currentTarget=null}function N1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;AS(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;AS(s,a,c),i=l}}}if(hp)throw t=E_,hp=!1,E_=null,t}function Ut(t,e){var n=e[k_];n===void 0&&(n=e[k_]=new Set);var r=t+"__bubble";n.has(r)||(D1(e,t,2,!1),n.add(r))}function rv(t,e,n){var r=0;e&&(r|=4),D1(n,t,r,e)}var Jf="_reactListening"+Math.random().toString(36).slice(2);function Ih(t){if(!t[Jf]){t[Jf]=!0,jP.forEach(function(n){n!=="selectionchange"&&(lU.has(n)||rv(n,!1,t),rv(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Jf]||(e[Jf]=!0,rv("selectionchange",!1,e))}}function D1(t,e,n,r){switch(g1(e)){case 1:var s=IF;break;case 4:s=TF;break;default:s=R0}n=s.bind(null,e,n,t),s=void 0,!w_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function sv(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Xa(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}n1(function(){var c=i,u=S0(n),h=[];e:{var f=k1.get(t);if(f!==void 0){var m=C0,E=t;switch(t){case"keypress":if(Dm(n)===0)break e;case"keydown":case"keyup":m=FF;break;case"focusin":E="focus",m=Jy;break;case"focusout":E="blur",m=Jy;break;case"beforeblur":case"afterblur":m=Jy;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=mS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=AF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=$F;break;case x1:case R1:case P1:m=PF;break;case C1:m=zF;break;case"scroll":m=SF;break;case"wheel":m=qF;break;case"copy":case"cut":case"paste":m=kF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=gS}var p=(e&4)!==0,I=!p&&t==="scroll",g=p?f!==null?f+"Capture":null:f;p=[];for(var _=c,w;_!==null;){w=_;var A=w.stateNode;if(w.tag===5&&A!==null&&(w=A,g!==null&&(A=gh(_,g),A!=null&&p.push(Th(_,A,w)))),I)break;_=_.return}0<p.length&&(f=new m(f,E,null,n,u),h.push({event:f,listeners:p}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==v_&&(E=n.relatedTarget||n.fromElement)&&(Xa(E)||E[ji]))break e;if((m||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,m?(E=n.relatedTarget||n.toElement,m=c,E=E?Xa(E):null,E!==null&&(I=Vl(E),E!==I||E.tag!==5&&E.tag!==6)&&(E=null)):(m=null,E=c),m!==E)){if(p=mS,A="onMouseLeave",g="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(p=gS,A="onPointerLeave",g="onPointerEnter",_="pointer"),I=m==null?f:vc(m),w=E==null?f:vc(E),f=new p(A,_+"leave",m,n,u),f.target=I,f.relatedTarget=w,A=null,Xa(u)===c&&(p=new p(g,_+"enter",E,n,u),p.target=w,p.relatedTarget=I,A=p),I=A,m&&E)t:{for(p=m,g=E,_=0,w=p;w;w=Yl(w))_++;for(w=0,A=g;A;A=Yl(A))w++;for(;0<_-w;)p=Yl(p),_--;for(;0<w-_;)g=Yl(g),w--;for(;_--;){if(p===g||g!==null&&p===g.alternate)break t;p=Yl(p),g=Yl(g)}p=null}else p=null;m!==null&&xS(h,f,m,p,!1),E!==null&&I!==null&&xS(h,I,E,p,!0)}}e:{if(f=c?vc(c):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var P=XF;else if(_S(f))if(I1)P=nU;else{P=eU;var L=ZF}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(P=tU);if(P&&(P=P(t,c))){E1(h,P,n,u);break e}L&&L(t,f,c),t==="focusout"&&(L=f._wrapperState)&&L.controlled&&f.type==="number"&&f_(f,"number",f.value)}switch(L=c?vc(c):window,t){case"focusin":(_S(L)||L.contentEditable==="true")&&(gc=L,b_=c,Gd=null);break;case"focusout":Gd=b_=gc=null;break;case"mousedown":A_=!0;break;case"contextmenu":case"mouseup":case"dragend":A_=!1,SS(h,n,u);break;case"selectionchange":if(iU)break;case"keydown":case"keyup":SS(h,n,u)}var x;if(N0)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else pc?_1(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(v1&&n.locale!=="ko"&&(pc||T!=="onCompositionStart"?T==="onCompositionEnd"&&pc&&(x=y1()):(Vo=u,P0="value"in Vo?Vo.value:Vo.textContent,pc=!0)),L=yp(c,T),0<L.length&&(T=new pS(T,t,null,n,u),h.push({event:T,listeners:L}),x?T.data=x:(x=w1(n),x!==null&&(T.data=x)))),(x=KF?GF(t,n):QF(t,n))&&(c=yp(c,"onBeforeInput"),0<c.length&&(u=new pS("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:c}),u.data=x))}N1(h,e)})}function Th(t,e,n){return{instance:t,listener:e,currentTarget:n}}function yp(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=gh(t,n),i!=null&&r.unshift(Th(t,i,s)),i=gh(t,e),i!=null&&r.push(Th(t,i,s))),t=t.return}return r}function Yl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function xS(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=gh(n,i),l!=null&&o.unshift(Th(n,l,a))):s||(l=gh(n,i),l!=null&&o.push(Th(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var cU=/\r\n?/g,uU=/\u0000|\uFFFD/g;function RS(t){return(typeof t=="string"?t:""+t).replace(cU,`
`).replace(uU,"")}function Xf(t,e,n){if(e=RS(e),RS(t)!==e&&n)throw Error(le(425))}function vp(){}var x_=null,R_=null;function P_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var C_=typeof setTimeout=="function"?setTimeout:void 0,dU=typeof clearTimeout=="function"?clearTimeout:void 0,PS=typeof Promise=="function"?Promise:void 0,hU=typeof queueMicrotask=="function"?queueMicrotask:typeof PS<"u"?function(t){return PS.resolve(null).then(t).catch(fU)}:C_;function fU(t){setTimeout(function(){throw t})}function iv(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),_h(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);_h(e)}function Ko(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function CS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ju=Math.random().toString(36).slice(2),ei="__reactFiber$"+ju,Sh="__reactProps$"+ju,ji="__reactContainer$"+ju,k_="__reactEvents$"+ju,mU="__reactListeners$"+ju,pU="__reactHandles$"+ju;function Xa(t){var e=t[ei];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ji]||n[ei]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=CS(t);t!==null;){if(n=t[ei])return n;t=CS(t)}return e}t=n,n=t.parentNode}return null}function af(t){return t=t[ei]||t[ji],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function vc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(le(33))}function Rg(t){return t[Sh]||null}var N_=[],_c=-1;function va(t){return{current:t}}function Bt(t){0>_c||(t.current=N_[_c],N_[_c]=null,_c--)}function Mt(t,e){_c++,N_[_c]=t.current,t.current=e}var oa={},vr=va(oa),zr=va(!1),gl=oa;function su(t,e){var n=t.type.contextTypes;if(!n)return oa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Wr(t){return t=t.childContextTypes,t!=null}function _p(){Bt(zr),Bt(vr)}function kS(t,e,n){if(vr.current!==oa)throw Error(le(168));Mt(vr,e),Mt(zr,n)}function O1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(le(108,ZV(t)||"Unknown",s));return ln({},n,r)}function wp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||oa,gl=vr.current,Mt(vr,t),Mt(zr,zr.current),!0}function NS(t,e,n){var r=t.stateNode;if(!r)throw Error(le(169));n?(t=O1(t,e,gl),r.__reactInternalMemoizedMergedChildContext=t,Bt(zr),Bt(vr),Mt(vr,t)):Bt(zr),Mt(zr,n)}var Ai=null,Pg=!1,ov=!1;function L1(t){Ai===null?Ai=[t]:Ai.push(t)}function gU(t){Pg=!0,L1(t)}function _a(){if(!ov&&Ai!==null){ov=!0;var t=0,e=At;try{var n=Ai;for(At=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ai=null,Pg=!1}catch(s){throw Ai!==null&&(Ai=Ai.slice(t+1)),o1(b0,_a),s}finally{At=e,ov=!1}}return null}var wc=[],Ec=0,Ep=null,Ip=0,hs=[],fs=0,yl=null,Pi=1,Ci="";function Va(t,e){wc[Ec++]=Ip,wc[Ec++]=Ep,Ep=t,Ip=e}function M1(t,e,n){hs[fs++]=Pi,hs[fs++]=Ci,hs[fs++]=yl,yl=t;var r=Pi;t=Ci;var s=32-Cs(r)-1;r&=~(1<<s),n+=1;var i=32-Cs(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Pi=1<<32-Cs(e)+s|n<<s|r,Ci=i+t}else Pi=1<<i|n<<s|r,Ci=t}function O0(t){t.return!==null&&(Va(t,1),M1(t,1,0))}function L0(t){for(;t===Ep;)Ep=wc[--Ec],wc[Ec]=null,Ip=wc[--Ec],wc[Ec]=null;for(;t===yl;)yl=hs[--fs],hs[fs]=null,Ci=hs[--fs],hs[fs]=null,Pi=hs[--fs],hs[fs]=null}var ts=null,Zr=null,Kt=!1,Rs=null;function V1(t,e){var n=ps(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function DS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ts=t,Zr=Ko(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ts=t,Zr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=yl!==null?{id:Pi,overflow:Ci}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ps(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ts=t,Zr=null,!0):!1;default:return!1}}function D_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function O_(t){if(Kt){var e=Zr;if(e){var n=e;if(!DS(t,e)){if(D_(t))throw Error(le(418));e=Ko(n.nextSibling);var r=ts;e&&DS(t,e)?V1(r,n):(t.flags=t.flags&-4097|2,Kt=!1,ts=t)}}else{if(D_(t))throw Error(le(418));t.flags=t.flags&-4097|2,Kt=!1,ts=t}}}function OS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ts=t}function Zf(t){if(t!==ts)return!1;if(!Kt)return OS(t),Kt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!P_(t.type,t.memoizedProps)),e&&(e=Zr)){if(D_(t))throw F1(),Error(le(418));for(;e;)V1(t,e),e=Ko(e.nextSibling)}if(OS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Zr=Ko(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Zr=null}}else Zr=ts?Ko(t.stateNode.nextSibling):null;return!0}function F1(){for(var t=Zr;t;)t=Ko(t.nextSibling)}function iu(){Zr=ts=null,Kt=!1}function M0(t){Rs===null?Rs=[t]:Rs.push(t)}var yU=Yi.ReactCurrentBatchConfig;function Ed(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(le(309));var r=n.stateNode}if(!r)throw Error(le(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(le(284));if(!n._owner)throw Error(le(290,t))}return t}function em(t,e){throw t=Object.prototype.toString.call(e),Error(le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function LS(t){var e=t._init;return e(t._payload)}function U1(t){function e(g,_){if(t){var w=g.deletions;w===null?(g.deletions=[_],g.flags|=16):w.push(_)}}function n(g,_){if(!t)return null;for(;_!==null;)e(g,_),_=_.sibling;return null}function r(g,_){for(g=new Map;_!==null;)_.key!==null?g.set(_.key,_):g.set(_.index,_),_=_.sibling;return g}function s(g,_){return g=Jo(g,_),g.index=0,g.sibling=null,g}function i(g,_,w){return g.index=w,t?(w=g.alternate,w!==null?(w=w.index,w<_?(g.flags|=2,_):w):(g.flags|=2,_)):(g.flags|=1048576,_)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,_,w,A){return _===null||_.tag!==6?(_=fv(w,g.mode,A),_.return=g,_):(_=s(_,w),_.return=g,_)}function l(g,_,w,A){var P=w.type;return P===mc?u(g,_,w.props.children,A,w.key):_!==null&&(_.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===wo&&LS(P)===_.type)?(A=s(_,w.props),A.ref=Ed(g,_,w),A.return=g,A):(A=jm(w.type,w.key,w.props,null,g.mode,A),A.ref=Ed(g,_,w),A.return=g,A)}function c(g,_,w,A){return _===null||_.tag!==4||_.stateNode.containerInfo!==w.containerInfo||_.stateNode.implementation!==w.implementation?(_=mv(w,g.mode,A),_.return=g,_):(_=s(_,w.children||[]),_.return=g,_)}function u(g,_,w,A,P){return _===null||_.tag!==7?(_=ul(w,g.mode,A,P),_.return=g,_):(_=s(_,w),_.return=g,_)}function h(g,_,w){if(typeof _=="string"&&_!==""||typeof _=="number")return _=fv(""+_,g.mode,w),_.return=g,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case zf:return w=jm(_.type,_.key,_.props,null,g.mode,w),w.ref=Ed(g,null,_),w.return=g,w;case fc:return _=mv(_,g.mode,w),_.return=g,_;case wo:var A=_._init;return h(g,A(_._payload),w)}if(Dd(_)||gd(_))return _=ul(_,g.mode,w,null),_.return=g,_;em(g,_)}return null}function f(g,_,w,A){var P=_!==null?_.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return P!==null?null:a(g,_,""+w,A);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case zf:return w.key===P?l(g,_,w,A):null;case fc:return w.key===P?c(g,_,w,A):null;case wo:return P=w._init,f(g,_,P(w._payload),A)}if(Dd(w)||gd(w))return P!==null?null:u(g,_,w,A,null);em(g,w)}return null}function m(g,_,w,A,P){if(typeof A=="string"&&A!==""||typeof A=="number")return g=g.get(w)||null,a(_,g,""+A,P);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case zf:return g=g.get(A.key===null?w:A.key)||null,l(_,g,A,P);case fc:return g=g.get(A.key===null?w:A.key)||null,c(_,g,A,P);case wo:var L=A._init;return m(g,_,w,L(A._payload),P)}if(Dd(A)||gd(A))return g=g.get(w)||null,u(_,g,A,P,null);em(_,A)}return null}function E(g,_,w,A){for(var P=null,L=null,x=_,T=_=0,R=null;x!==null&&T<w.length;T++){x.index>T?(R=x,x=null):R=x.sibling;var C=f(g,x,w[T],A);if(C===null){x===null&&(x=R);break}t&&x&&C.alternate===null&&e(g,x),_=i(C,_,T),L===null?P=C:L.sibling=C,L=C,x=R}if(T===w.length)return n(g,x),Kt&&Va(g,T),P;if(x===null){for(;T<w.length;T++)x=h(g,w[T],A),x!==null&&(_=i(x,_,T),L===null?P=x:L.sibling=x,L=x);return Kt&&Va(g,T),P}for(x=r(g,x);T<w.length;T++)R=m(x,g,T,w[T],A),R!==null&&(t&&R.alternate!==null&&x.delete(R.key===null?T:R.key),_=i(R,_,T),L===null?P=R:L.sibling=R,L=R);return t&&x.forEach(function(D){return e(g,D)}),Kt&&Va(g,T),P}function p(g,_,w,A){var P=gd(w);if(typeof P!="function")throw Error(le(150));if(w=P.call(w),w==null)throw Error(le(151));for(var L=P=null,x=_,T=_=0,R=null,C=w.next();x!==null&&!C.done;T++,C=w.next()){x.index>T?(R=x,x=null):R=x.sibling;var D=f(g,x,C.value,A);if(D===null){x===null&&(x=R);break}t&&x&&D.alternate===null&&e(g,x),_=i(D,_,T),L===null?P=D:L.sibling=D,L=D,x=R}if(C.done)return n(g,x),Kt&&Va(g,T),P;if(x===null){for(;!C.done;T++,C=w.next())C=h(g,C.value,A),C!==null&&(_=i(C,_,T),L===null?P=C:L.sibling=C,L=C);return Kt&&Va(g,T),P}for(x=r(g,x);!C.done;T++,C=w.next())C=m(x,g,T,C.value,A),C!==null&&(t&&C.alternate!==null&&x.delete(C.key===null?T:C.key),_=i(C,_,T),L===null?P=C:L.sibling=C,L=C);return t&&x.forEach(function(O){return e(g,O)}),Kt&&Va(g,T),P}function I(g,_,w,A){if(typeof w=="object"&&w!==null&&w.type===mc&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case zf:e:{for(var P=w.key,L=_;L!==null;){if(L.key===P){if(P=w.type,P===mc){if(L.tag===7){n(g,L.sibling),_=s(L,w.props.children),_.return=g,g=_;break e}}else if(L.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===wo&&LS(P)===L.type){n(g,L.sibling),_=s(L,w.props),_.ref=Ed(g,L,w),_.return=g,g=_;break e}n(g,L);break}else e(g,L);L=L.sibling}w.type===mc?(_=ul(w.props.children,g.mode,A,w.key),_.return=g,g=_):(A=jm(w.type,w.key,w.props,null,g.mode,A),A.ref=Ed(g,_,w),A.return=g,g=A)}return o(g);case fc:e:{for(L=w.key;_!==null;){if(_.key===L)if(_.tag===4&&_.stateNode.containerInfo===w.containerInfo&&_.stateNode.implementation===w.implementation){n(g,_.sibling),_=s(_,w.children||[]),_.return=g,g=_;break e}else{n(g,_);break}else e(g,_);_=_.sibling}_=mv(w,g.mode,A),_.return=g,g=_}return o(g);case wo:return L=w._init,I(g,_,L(w._payload),A)}if(Dd(w))return E(g,_,w,A);if(gd(w))return p(g,_,w,A);em(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,_!==null&&_.tag===6?(n(g,_.sibling),_=s(_,w),_.return=g,g=_):(n(g,_),_=fv(w,g.mode,A),_.return=g,g=_),o(g)):n(g,_)}return I}var ou=U1(!0),j1=U1(!1),Tp=va(null),Sp=null,Ic=null,V0=null;function F0(){V0=Ic=Sp=null}function U0(t){var e=Tp.current;Bt(Tp),t._currentValue=e}function L_(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Mc(t,e){Sp=t,V0=Ic=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Fr=!0),t.firstContext=null)}function vs(t){var e=t._currentValue;if(V0!==t)if(t={context:t,memoizedValue:e,next:null},Ic===null){if(Sp===null)throw Error(le(308));Ic=t,Sp.dependencies={lanes:0,firstContext:t}}else Ic=Ic.next=t;return e}var Za=null;function j0(t){Za===null?Za=[t]:Za.push(t)}function $1(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,j0(e)):(n.next=s.next,s.next=n),e.interleaved=n,$i(t,r)}function $i(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Eo=!1;function $0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function B1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Go(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,vt&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,$i(t,n)}return s=r.interleaved,s===null?(e.next=e,j0(r)):(e.next=s.next,s.next=e),r.interleaved=e,$i(t,n)}function Om(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,A0(t,n)}}function MS(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function bp(t,e,n,r){var s=t.updateQueue;Eo=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,u=c=l=null,a=i;do{var f=a.lane,m=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,p=a;switch(f=e,m=n,p.tag){case 1:if(E=p.payload,typeof E=="function"){h=E.call(m,h,f);break e}h=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=p.payload,f=typeof E=="function"?E.call(m,h,f):E,f==null)break e;h=ln({},h,f);break e;case 2:Eo=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else m={eventTime:m,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=m,l=h):u=u.next=m,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);_l|=o,t.lanes=o,t.memoizedState=h}}function VS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(le(191,s));s.call(r)}}}var lf={},li=va(lf),bh=va(lf),Ah=va(lf);function el(t){if(t===lf)throw Error(le(174));return t}function B0(t,e){switch(Mt(Ah,e),Mt(bh,t),Mt(li,lf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:p_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=p_(e,t)}Bt(li),Mt(li,e)}function au(){Bt(li),Bt(bh),Bt(Ah)}function z1(t){el(Ah.current);var e=el(li.current),n=p_(e,t.type);e!==n&&(Mt(bh,t),Mt(li,n))}function z0(t){bh.current===t&&(Bt(li),Bt(bh))}var sn=va(0);function Ap(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var av=[];function W0(){for(var t=0;t<av.length;t++)av[t]._workInProgressVersionPrimary=null;av.length=0}var Lm=Yi.ReactCurrentDispatcher,lv=Yi.ReactCurrentBatchConfig,vl=0,an=null,Fn=null,Yn=null,xp=!1,Qd=!1,xh=0,vU=0;function dr(){throw Error(le(321))}function q0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Os(t[n],e[n]))return!1;return!0}function H0(t,e,n,r,s,i){if(vl=i,an=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Lm.current=t===null||t.memoizedState===null?IU:TU,t=n(r,s),Qd){i=0;do{if(Qd=!1,xh=0,25<=i)throw Error(le(301));i+=1,Yn=Fn=null,e.updateQueue=null,Lm.current=SU,t=n(r,s)}while(Qd)}if(Lm.current=Rp,e=Fn!==null&&Fn.next!==null,vl=0,Yn=Fn=an=null,xp=!1,e)throw Error(le(300));return t}function K0(){var t=xh!==0;return xh=0,t}function Gs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?an.memoizedState=Yn=t:Yn=Yn.next=t,Yn}function _s(){if(Fn===null){var t=an.alternate;t=t!==null?t.memoizedState:null}else t=Fn.next;var e=Yn===null?an.memoizedState:Yn.next;if(e!==null)Yn=e,Fn=t;else{if(t===null)throw Error(le(310));Fn=t,t={memoizedState:Fn.memoizedState,baseState:Fn.baseState,baseQueue:Fn.baseQueue,queue:Fn.queue,next:null},Yn===null?an.memoizedState=Yn=t:Yn=Yn.next=t}return Yn}function Rh(t,e){return typeof e=="function"?e(t):e}function cv(t){var e=_s(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var r=Fn,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((vl&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,an.lanes|=u,_l|=u}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,Os(r,e.memoizedState)||(Fr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,an.lanes|=i,_l|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function uv(t){var e=_s(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Os(i,e.memoizedState)||(Fr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function W1(){}function q1(t,e){var n=an,r=_s(),s=e(),i=!Os(r.memoizedState,s);if(i&&(r.memoizedState=s,Fr=!0),r=r.queue,G0(G1.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Yn!==null&&Yn.memoizedState.tag&1){if(n.flags|=2048,Ph(9,K1.bind(null,n,r,s,e),void 0,null),Zn===null)throw Error(le(349));vl&30||H1(n,e,s)}return s}function H1(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=an.updateQueue,e===null?(e={lastEffect:null,stores:null},an.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function K1(t,e,n,r){e.value=n,e.getSnapshot=r,Q1(e)&&Y1(t)}function G1(t,e,n){return n(function(){Q1(e)&&Y1(t)})}function Q1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Os(t,n)}catch{return!0}}function Y1(t){var e=$i(t,1);e!==null&&ks(e,t,1,-1)}function FS(t){var e=Gs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rh,lastRenderedState:t},e.queue=t,t=t.dispatch=EU.bind(null,an,t),[e.memoizedState,t]}function Ph(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=an.updateQueue,e===null?(e={lastEffect:null,stores:null},an.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function J1(){return _s().memoizedState}function Mm(t,e,n,r){var s=Gs();an.flags|=t,s.memoizedState=Ph(1|e,n,void 0,r===void 0?null:r)}function Cg(t,e,n,r){var s=_s();r=r===void 0?null:r;var i=void 0;if(Fn!==null){var o=Fn.memoizedState;if(i=o.destroy,r!==null&&q0(r,o.deps)){s.memoizedState=Ph(e,n,i,r);return}}an.flags|=t,s.memoizedState=Ph(1|e,n,i,r)}function US(t,e){return Mm(8390656,8,t,e)}function G0(t,e){return Cg(2048,8,t,e)}function X1(t,e){return Cg(4,2,t,e)}function Z1(t,e){return Cg(4,4,t,e)}function eC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function tC(t,e,n){return n=n!=null?n.concat([t]):null,Cg(4,4,eC.bind(null,e,t),n)}function Q0(){}function nC(t,e){var n=_s();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&q0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function rC(t,e){var n=_s();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&q0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function sC(t,e,n){return vl&21?(Os(n,e)||(n=c1(),an.lanes|=n,_l|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Fr=!0),t.memoizedState=n)}function _U(t,e){var n=At;At=n!==0&&4>n?n:4,t(!0);var r=lv.transition;lv.transition={};try{t(!1),e()}finally{At=n,lv.transition=r}}function iC(){return _s().memoizedState}function wU(t,e,n){var r=Yo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},oC(t))aC(e,n);else if(n=$1(t,e,n,r),n!==null){var s=Ar();ks(n,t,r,s),lC(n,e,r)}}function EU(t,e,n){var r=Yo(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(oC(t))aC(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Os(a,o)){var l=e.interleaved;l===null?(s.next=s,j0(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=$1(t,e,s,r),n!==null&&(s=Ar(),ks(n,t,r,s),lC(n,e,r))}}function oC(t){var e=t.alternate;return t===an||e!==null&&e===an}function aC(t,e){Qd=xp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function lC(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,A0(t,n)}}var Rp={readContext:vs,useCallback:dr,useContext:dr,useEffect:dr,useImperativeHandle:dr,useInsertionEffect:dr,useLayoutEffect:dr,useMemo:dr,useReducer:dr,useRef:dr,useState:dr,useDebugValue:dr,useDeferredValue:dr,useTransition:dr,useMutableSource:dr,useSyncExternalStore:dr,useId:dr,unstable_isNewReconciler:!1},IU={readContext:vs,useCallback:function(t,e){return Gs().memoizedState=[t,e===void 0?null:e],t},useContext:vs,useEffect:US,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Mm(4194308,4,eC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Mm(4194308,4,t,e)},useInsertionEffect:function(t,e){return Mm(4,2,t,e)},useMemo:function(t,e){var n=Gs();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Gs();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=wU.bind(null,an,t),[r.memoizedState,t]},useRef:function(t){var e=Gs();return t={current:t},e.memoizedState=t},useState:FS,useDebugValue:Q0,useDeferredValue:function(t){return Gs().memoizedState=t},useTransition:function(){var t=FS(!1),e=t[0];return t=_U.bind(null,t[1]),Gs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=an,s=Gs();if(Kt){if(n===void 0)throw Error(le(407));n=n()}else{if(n=e(),Zn===null)throw Error(le(349));vl&30||H1(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,US(G1.bind(null,r,i,t),[t]),r.flags|=2048,Ph(9,K1.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Gs(),e=Zn.identifierPrefix;if(Kt){var n=Ci,r=Pi;n=(r&~(1<<32-Cs(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=xh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=vU++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},TU={readContext:vs,useCallback:nC,useContext:vs,useEffect:G0,useImperativeHandle:tC,useInsertionEffect:X1,useLayoutEffect:Z1,useMemo:rC,useReducer:cv,useRef:J1,useState:function(){return cv(Rh)},useDebugValue:Q0,useDeferredValue:function(t){var e=_s();return sC(e,Fn.memoizedState,t)},useTransition:function(){var t=cv(Rh)[0],e=_s().memoizedState;return[t,e]},useMutableSource:W1,useSyncExternalStore:q1,useId:iC,unstable_isNewReconciler:!1},SU={readContext:vs,useCallback:nC,useContext:vs,useEffect:G0,useImperativeHandle:tC,useInsertionEffect:X1,useLayoutEffect:Z1,useMemo:rC,useReducer:uv,useRef:J1,useState:function(){return uv(Rh)},useDebugValue:Q0,useDeferredValue:function(t){var e=_s();return Fn===null?e.memoizedState=t:sC(e,Fn.memoizedState,t)},useTransition:function(){var t=uv(Rh)[0],e=_s().memoizedState;return[t,e]},useMutableSource:W1,useSyncExternalStore:q1,useId:iC,unstable_isNewReconciler:!1};function Ts(t,e){if(t&&t.defaultProps){e=ln({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function M_(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ln({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var kg={isMounted:function(t){return(t=t._reactInternals)?Vl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ar(),s=Yo(t),i=Mi(r,s);i.payload=e,n!=null&&(i.callback=n),e=Go(t,i,s),e!==null&&(ks(e,t,s,r),Om(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ar(),s=Yo(t),i=Mi(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Go(t,i,s),e!==null&&(ks(e,t,s,r),Om(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ar(),r=Yo(t),s=Mi(n,r);s.tag=2,e!=null&&(s.callback=e),e=Go(t,s,r),e!==null&&(ks(e,t,r,n),Om(e,t,r))}};function jS(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Eh(n,r)||!Eh(s,i):!0}function cC(t,e,n){var r=!1,s=oa,i=e.contextType;return typeof i=="object"&&i!==null?i=vs(i):(s=Wr(e)?gl:vr.current,r=e.contextTypes,i=(r=r!=null)?su(t,s):oa),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=kg,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function $S(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&kg.enqueueReplaceState(e,e.state,null)}function V_(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},$0(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=vs(i):(i=Wr(e)?gl:vr.current,s.context=su(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(M_(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&kg.enqueueReplaceState(s,s.state,null),bp(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function lu(t,e){try{var n="",r=e;do n+=XV(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function dv(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function F_(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var bU=typeof WeakMap=="function"?WeakMap:Map;function uC(t,e,n){n=Mi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Cp||(Cp=!0,G_=r),F_(t,e)},n}function dC(t,e,n){n=Mi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){F_(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){F_(t,e),typeof r!="function"&&(Qo===null?Qo=new Set([this]):Qo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function BS(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new bU;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=UU.bind(null,t,e,n),e.then(t,t))}function zS(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function WS(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Mi(-1,1),e.tag=2,Go(n,e,1))),n.lanes|=1),t)}var AU=Yi.ReactCurrentOwner,Fr=!1;function Tr(t,e,n,r){e.child=t===null?j1(e,null,n,r):ou(e,t.child,n,r)}function qS(t,e,n,r,s){n=n.render;var i=e.ref;return Mc(e,s),r=H0(t,e,n,r,i,s),n=K0(),t!==null&&!Fr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Bi(t,e,s)):(Kt&&n&&O0(e),e.flags|=1,Tr(t,e,r,s),e.child)}function HS(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!rE(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,hC(t,e,i,r,s)):(t=jm(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Eh,n(o,r)&&t.ref===e.ref)return Bi(t,e,s)}return e.flags|=1,t=Jo(i,r),t.ref=e.ref,t.return=e,e.child=t}function hC(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Eh(i,r)&&t.ref===e.ref)if(Fr=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Fr=!0);else return e.lanes=t.lanes,Bi(t,e,s)}return U_(t,e,n,r,s)}function fC(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mt(Sc,Qr),Qr|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Mt(Sc,Qr),Qr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Mt(Sc,Qr),Qr|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Mt(Sc,Qr),Qr|=r;return Tr(t,e,s,n),e.child}function mC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function U_(t,e,n,r,s){var i=Wr(n)?gl:vr.current;return i=su(e,i),Mc(e,s),n=H0(t,e,n,r,i,s),r=K0(),t!==null&&!Fr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Bi(t,e,s)):(Kt&&r&&O0(e),e.flags|=1,Tr(t,e,n,s),e.child)}function KS(t,e,n,r,s){if(Wr(n)){var i=!0;wp(e)}else i=!1;if(Mc(e,s),e.stateNode===null)Vm(t,e),cC(e,n,r),V_(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=vs(c):(c=Wr(n)?gl:vr.current,c=su(e,c));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&$S(e,o,r,c),Eo=!1;var f=e.memoizedState;o.state=f,bp(e,r,o,s),l=e.memoizedState,a!==r||f!==l||zr.current||Eo?(typeof u=="function"&&(M_(e,n,u,r),l=e.memoizedState),(a=Eo||jS(e,n,a,r,f,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,B1(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Ts(e.type,a),o.props=c,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=vs(l):(l=Wr(n)?gl:vr.current,l=su(e,l));var m=n.getDerivedStateFromProps;(u=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&$S(e,o,r,l),Eo=!1,f=e.memoizedState,o.state=f,bp(e,r,o,s);var E=e.memoizedState;a!==h||f!==E||zr.current||Eo?(typeof m=="function"&&(M_(e,n,m,r),E=e.memoizedState),(c=Eo||jS(e,n,c,r,f,E,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return j_(t,e,n,r,i,s)}function j_(t,e,n,r,s,i){mC(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&NS(e,n,!1),Bi(t,e,i);r=e.stateNode,AU.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ou(e,t.child,null,i),e.child=ou(e,null,a,i)):Tr(t,e,a,i),e.memoizedState=r.state,s&&NS(e,n,!0),e.child}function pC(t){var e=t.stateNode;e.pendingContext?kS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&kS(t,e.context,!1),B0(t,e.containerInfo)}function GS(t,e,n,r,s){return iu(),M0(s),e.flags|=256,Tr(t,e,n,r),e.child}var $_={dehydrated:null,treeContext:null,retryLane:0};function B_(t){return{baseLanes:t,cachePool:null,transitions:null}}function gC(t,e,n){var r=e.pendingProps,s=sn.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Mt(sn,s&1),t===null)return O_(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Og(o,r,0,null),t=ul(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=B_(n),e.memoizedState=$_,t):Y0(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return xU(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Jo(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Jo(a,i):(i=ul(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?B_(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=$_,r}return i=t.child,t=i.sibling,r=Jo(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Y0(t,e){return e=Og({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function tm(t,e,n,r){return r!==null&&M0(r),ou(e,t.child,null,n),t=Y0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function xU(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=dv(Error(le(422))),tm(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Og({mode:"visible",children:r.children},s,0,null),i=ul(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ou(e,t.child,null,o),e.child.memoizedState=B_(o),e.memoizedState=$_,i);if(!(e.mode&1))return tm(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(le(419)),r=dv(i,r,void 0),tm(t,e,o,r)}if(a=(o&t.childLanes)!==0,Fr||a){if(r=Zn,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,$i(t,s),ks(r,t,s,-1))}return nE(),r=dv(Error(le(421))),tm(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=jU.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Zr=Ko(s.nextSibling),ts=e,Kt=!0,Rs=null,t!==null&&(hs[fs++]=Pi,hs[fs++]=Ci,hs[fs++]=yl,Pi=t.id,Ci=t.overflow,yl=e),e=Y0(e,r.children),e.flags|=4096,e)}function QS(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),L_(t.return,e,n)}function hv(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function yC(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Tr(t,e,r.children,n),r=sn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&QS(t,n,e);else if(t.tag===19)QS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Mt(sn,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ap(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),hv(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ap(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}hv(e,!0,n,null,i);break;case"together":hv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Vm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Bi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),_l|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(le(153));if(e.child!==null){for(t=e.child,n=Jo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Jo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function RU(t,e,n){switch(e.tag){case 3:pC(e),iu();break;case 5:z1(e);break;case 1:Wr(e.type)&&wp(e);break;case 4:B0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Mt(Tp,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Mt(sn,sn.current&1),e.flags|=128,null):n&e.child.childLanes?gC(t,e,n):(Mt(sn,sn.current&1),t=Bi(t,e,n),t!==null?t.sibling:null);Mt(sn,sn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return yC(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Mt(sn,sn.current),r)break;return null;case 22:case 23:return e.lanes=0,fC(t,e,n)}return Bi(t,e,n)}var vC,z_,_C,wC;vC=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};z_=function(){};_C=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,el(li.current);var i=null;switch(n){case"input":s=d_(t,s),r=d_(t,r),i=[];break;case"select":s=ln({},s,{value:void 0}),r=ln({},r,{value:void 0}),i=[];break;case"textarea":s=m_(t,s),r=m_(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=vp)}g_(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(mh.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(mh.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ut("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};wC=function(t,e,n,r){n!==r&&(e.flags|=4)};function Id(t,e){if(!Kt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function hr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function PU(t,e,n){var r=e.pendingProps;switch(L0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hr(e),null;case 1:return Wr(e.type)&&_p(),hr(e),null;case 3:return r=e.stateNode,au(),Bt(zr),Bt(vr),W0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Zf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Rs!==null&&(J_(Rs),Rs=null))),z_(t,e),hr(e),null;case 5:z0(e);var s=el(Ah.current);if(n=e.type,t!==null&&e.stateNode!=null)_C(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(le(166));return hr(e),null}if(t=el(li.current),Zf(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[ei]=e,r[Sh]=i,t=(e.mode&1)!==0,n){case"dialog":Ut("cancel",r),Ut("close",r);break;case"iframe":case"object":case"embed":Ut("load",r);break;case"video":case"audio":for(s=0;s<Ld.length;s++)Ut(Ld[s],r);break;case"source":Ut("error",r);break;case"img":case"image":case"link":Ut("error",r),Ut("load",r);break;case"details":Ut("toggle",r);break;case"input":sS(r,i),Ut("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ut("invalid",r);break;case"textarea":oS(r,i),Ut("invalid",r)}g_(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Xf(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Xf(r.textContent,a,t),s=["children",""+a]):mh.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ut("scroll",r)}switch(n){case"input":Wf(r),iS(r,i,!0);break;case"textarea":Wf(r),aS(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=vp)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=GP(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ei]=e,t[Sh]=r,vC(t,e,!1,!1),e.stateNode=t;e:{switch(o=y_(n,r),n){case"dialog":Ut("cancel",t),Ut("close",t),s=r;break;case"iframe":case"object":case"embed":Ut("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ld.length;s++)Ut(Ld[s],t);s=r;break;case"source":Ut("error",t),s=r;break;case"img":case"image":case"link":Ut("error",t),Ut("load",t),s=r;break;case"details":Ut("toggle",t),s=r;break;case"input":sS(t,r),s=d_(t,r),Ut("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=ln({},r,{value:void 0}),Ut("invalid",t);break;case"textarea":oS(t,r),s=m_(t,r),Ut("invalid",t);break;default:s=r}g_(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?JP(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&QP(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&ph(t,l):typeof l=="number"&&ph(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(mh.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ut("scroll",t):l!=null&&w0(t,i,l,o))}switch(n){case"input":Wf(t),iS(t,r,!1);break;case"textarea":Wf(t),aS(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ia(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Nc(t,!!r.multiple,i,!1):r.defaultValue!=null&&Nc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=vp)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return hr(e),null;case 6:if(t&&e.stateNode!=null)wC(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(le(166));if(n=el(Ah.current),el(li.current),Zf(e)){if(r=e.stateNode,n=e.memoizedProps,r[ei]=e,(i=r.nodeValue!==n)&&(t=ts,t!==null))switch(t.tag){case 3:Xf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Xf(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ei]=e,e.stateNode=r}return hr(e),null;case 13:if(Bt(sn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Kt&&Zr!==null&&e.mode&1&&!(e.flags&128))F1(),iu(),e.flags|=98560,i=!1;else if(i=Zf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(le(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(le(317));i[ei]=e}else iu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;hr(e),i=!1}else Rs!==null&&(J_(Rs),Rs=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||sn.current&1?Un===0&&(Un=3):nE())),e.updateQueue!==null&&(e.flags|=4),hr(e),null);case 4:return au(),z_(t,e),t===null&&Ih(e.stateNode.containerInfo),hr(e),null;case 10:return U0(e.type._context),hr(e),null;case 17:return Wr(e.type)&&_p(),hr(e),null;case 19:if(Bt(sn),i=e.memoizedState,i===null)return hr(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Id(i,!1);else{if(Un!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ap(t),o!==null){for(e.flags|=128,Id(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Mt(sn,sn.current&1|2),e.child}t=t.sibling}i.tail!==null&&gn()>cu&&(e.flags|=128,r=!0,Id(i,!1),e.lanes=4194304)}else{if(!r)if(t=Ap(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Id(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Kt)return hr(e),null}else 2*gn()-i.renderingStartTime>cu&&n!==1073741824&&(e.flags|=128,r=!0,Id(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=gn(),e.sibling=null,n=sn.current,Mt(sn,r?n&1|2:n&1),e):(hr(e),null);case 22:case 23:return tE(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Qr&1073741824&&(hr(e),e.subtreeFlags&6&&(e.flags|=8192)):hr(e),null;case 24:return null;case 25:return null}throw Error(le(156,e.tag))}function CU(t,e){switch(L0(e),e.tag){case 1:return Wr(e.type)&&_p(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return au(),Bt(zr),Bt(vr),W0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return z0(e),null;case 13:if(Bt(sn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(le(340));iu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Bt(sn),null;case 4:return au(),null;case 10:return U0(e.type._context),null;case 22:case 23:return tE(),null;case 24:return null;default:return null}}var nm=!1,pr=!1,kU=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function Tc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){pn(t,e,r)}else n.current=null}function W_(t,e,n){try{n()}catch(r){pn(t,e,r)}}var YS=!1;function NU(t,e){if(x_=pp,t=b1(),D0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=t,f=null;t:for(;;){for(var m;h!==n||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++c===s&&(a=o),f===i&&++u===r&&(l=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(R_={focusedElem:t,selectionRange:n},pp=!1,Ae=e;Ae!==null;)if(e=Ae,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ae=t;else for(;Ae!==null;){e=Ae;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var p=E.memoizedProps,I=E.memoizedState,g=e.stateNode,_=g.getSnapshotBeforeUpdate(e.elementType===e.type?p:Ts(e.type,p),I);g.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(A){pn(e,e.return,A)}if(t=e.sibling,t!==null){t.return=e.return,Ae=t;break}Ae=e.return}return E=YS,YS=!1,E}function Yd(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&W_(e,n,i)}s=s.next}while(s!==r)}}function Ng(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function q_(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function EC(t){var e=t.alternate;e!==null&&(t.alternate=null,EC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ei],delete e[Sh],delete e[k_],delete e[mU],delete e[pU])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function IC(t){return t.tag===5||t.tag===3||t.tag===4}function JS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||IC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function H_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=vp));else if(r!==4&&(t=t.child,t!==null))for(H_(t,e,n),t=t.sibling;t!==null;)H_(t,e,n),t=t.sibling}function K_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(K_(t,e,n),t=t.sibling;t!==null;)K_(t,e,n),t=t.sibling}var rr=null,As=!1;function co(t,e,n){for(n=n.child;n!==null;)TC(t,e,n),n=n.sibling}function TC(t,e,n){if(ai&&typeof ai.onCommitFiberUnmount=="function")try{ai.onCommitFiberUnmount(Sg,n)}catch{}switch(n.tag){case 5:pr||Tc(n,e);case 6:var r=rr,s=As;rr=null,co(t,e,n),rr=r,As=s,rr!==null&&(As?(t=rr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):rr.removeChild(n.stateNode));break;case 18:rr!==null&&(As?(t=rr,n=n.stateNode,t.nodeType===8?iv(t.parentNode,n):t.nodeType===1&&iv(t,n),_h(t)):iv(rr,n.stateNode));break;case 4:r=rr,s=As,rr=n.stateNode.containerInfo,As=!0,co(t,e,n),rr=r,As=s;break;case 0:case 11:case 14:case 15:if(!pr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&W_(n,e,o),s=s.next}while(s!==r)}co(t,e,n);break;case 1:if(!pr&&(Tc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){pn(n,e,a)}co(t,e,n);break;case 21:co(t,e,n);break;case 22:n.mode&1?(pr=(r=pr)||n.memoizedState!==null,co(t,e,n),pr=r):co(t,e,n);break;default:co(t,e,n)}}function XS(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new kU),e.forEach(function(r){var s=$U.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Es(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:rr=a.stateNode,As=!1;break e;case 3:rr=a.stateNode.containerInfo,As=!0;break e;case 4:rr=a.stateNode.containerInfo,As=!0;break e}a=a.return}if(rr===null)throw Error(le(160));TC(i,o,s),rr=null,As=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){pn(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)SC(e,t),e=e.sibling}function SC(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Es(e,t),Ks(t),r&4){try{Yd(3,t,t.return),Ng(3,t)}catch(p){pn(t,t.return,p)}try{Yd(5,t,t.return)}catch(p){pn(t,t.return,p)}}break;case 1:Es(e,t),Ks(t),r&512&&n!==null&&Tc(n,n.return);break;case 5:if(Es(e,t),Ks(t),r&512&&n!==null&&Tc(n,n.return),t.flags&32){var s=t.stateNode;try{ph(s,"")}catch(p){pn(t,t.return,p)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&HP(s,i),y_(a,o);var c=y_(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?JP(s,h):u==="dangerouslySetInnerHTML"?QP(s,h):u==="children"?ph(s,h):w0(s,u,h,c)}switch(a){case"input":h_(s,i);break;case"textarea":KP(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Nc(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?Nc(s,!!i.multiple,i.defaultValue,!0):Nc(s,!!i.multiple,i.multiple?[]:"",!1))}s[Sh]=i}catch(p){pn(t,t.return,p)}}break;case 6:if(Es(e,t),Ks(t),r&4){if(t.stateNode===null)throw Error(le(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(p){pn(t,t.return,p)}}break;case 3:if(Es(e,t),Ks(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{_h(e.containerInfo)}catch(p){pn(t,t.return,p)}break;case 4:Es(e,t),Ks(t);break;case 13:Es(e,t),Ks(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Z0=gn())),r&4&&XS(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(pr=(c=pr)||u,Es(e,t),pr=c):Es(e,t),Ks(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Ae=t,u=t.child;u!==null;){for(h=Ae=u;Ae!==null;){switch(f=Ae,m=f.child,f.tag){case 0:case 11:case 14:case 15:Yd(4,f,f.return);break;case 1:Tc(f,f.return);var E=f.stateNode;if(typeof E.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(p){pn(r,n,p)}}break;case 5:Tc(f,f.return);break;case 22:if(f.memoizedState!==null){eb(h);continue}}m!==null?(m.return=f,Ae=m):eb(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=YP("display",o))}catch(p){pn(t,t.return,p)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(p){pn(t,t.return,p)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Es(e,t),Ks(t),r&4&&XS(t);break;case 21:break;default:Es(e,t),Ks(t)}}function Ks(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(IC(n)){var r=n;break e}n=n.return}throw Error(le(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ph(s,""),r.flags&=-33);var i=JS(t);K_(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=JS(t);H_(t,a,o);break;default:throw Error(le(161))}}catch(l){pn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function DU(t,e,n){Ae=t,bC(t)}function bC(t,e,n){for(var r=(t.mode&1)!==0;Ae!==null;){var s=Ae,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||nm;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||pr;a=nm;var c=pr;if(nm=o,(pr=l)&&!c)for(Ae=s;Ae!==null;)o=Ae,l=o.child,o.tag===22&&o.memoizedState!==null?tb(s):l!==null?(l.return=o,Ae=l):tb(s);for(;i!==null;)Ae=i,bC(i),i=i.sibling;Ae=s,nm=a,pr=c}ZS(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ae=i):ZS(t)}}function ZS(t){for(;Ae!==null;){var e=Ae;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:pr||Ng(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!pr)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Ts(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&VS(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}VS(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&_h(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}pr||e.flags&512&&q_(e)}catch(f){pn(e,e.return,f)}}if(e===t){Ae=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ae=n;break}Ae=e.return}}function eb(t){for(;Ae!==null;){var e=Ae;if(e===t){Ae=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ae=n;break}Ae=e.return}}function tb(t){for(;Ae!==null;){var e=Ae;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ng(4,e)}catch(l){pn(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){pn(e,s,l)}}var i=e.return;try{q_(e)}catch(l){pn(e,i,l)}break;case 5:var o=e.return;try{q_(e)}catch(l){pn(e,o,l)}}}catch(l){pn(e,e.return,l)}if(e===t){Ae=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ae=a;break}Ae=e.return}}var OU=Math.ceil,Pp=Yi.ReactCurrentDispatcher,J0=Yi.ReactCurrentOwner,gs=Yi.ReactCurrentBatchConfig,vt=0,Zn=null,xn=null,or=0,Qr=0,Sc=va(0),Un=0,Ch=null,_l=0,Dg=0,X0=0,Jd=null,Lr=null,Z0=0,cu=1/0,bi=null,Cp=!1,G_=null,Qo=null,rm=!1,Fo=null,kp=0,Xd=0,Q_=null,Fm=-1,Um=0;function Ar(){return vt&6?gn():Fm!==-1?Fm:Fm=gn()}function Yo(t){return t.mode&1?vt&2&&or!==0?or&-or:yU.transition!==null?(Um===0&&(Um=c1()),Um):(t=At,t!==0||(t=window.event,t=t===void 0?16:g1(t.type)),t):1}function ks(t,e,n,r){if(50<Xd)throw Xd=0,Q_=null,Error(le(185));sf(t,n,r),(!(vt&2)||t!==Zn)&&(t===Zn&&(!(vt&2)&&(Dg|=n),Un===4&&So(t,or)),qr(t,r),n===1&&vt===0&&!(e.mode&1)&&(cu=gn()+500,Pg&&_a()))}function qr(t,e){var n=t.callbackNode;yF(t,e);var r=mp(t,t===Zn?or:0);if(r===0)n!==null&&uS(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&uS(n),e===1)t.tag===0?gU(nb.bind(null,t)):L1(nb.bind(null,t)),hU(function(){!(vt&6)&&_a()}),n=null;else{switch(u1(r)){case 1:n=b0;break;case 4:n=a1;break;case 16:n=fp;break;case 536870912:n=l1;break;default:n=fp}n=DC(n,AC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function AC(t,e){if(Fm=-1,Um=0,vt&6)throw Error(le(327));var n=t.callbackNode;if(Vc()&&t.callbackNode!==n)return null;var r=mp(t,t===Zn?or:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Np(t,r);else{e=r;var s=vt;vt|=2;var i=RC();(Zn!==t||or!==e)&&(bi=null,cu=gn()+500,cl(t,e));do try{VU();break}catch(a){xC(t,a)}while(!0);F0(),Pp.current=i,vt=s,xn!==null?e=0:(Zn=null,or=0,e=Un)}if(e!==0){if(e===2&&(s=I_(t),s!==0&&(r=s,e=Y_(t,s))),e===1)throw n=Ch,cl(t,0),So(t,r),qr(t,gn()),n;if(e===6)So(t,r);else{if(s=t.current.alternate,!(r&30)&&!LU(s)&&(e=Np(t,r),e===2&&(i=I_(t),i!==0&&(r=i,e=Y_(t,i))),e===1))throw n=Ch,cl(t,0),So(t,r),qr(t,gn()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(le(345));case 2:Fa(t,Lr,bi);break;case 3:if(So(t,r),(r&130023424)===r&&(e=Z0+500-gn(),10<e)){if(mp(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Ar(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=C_(Fa.bind(null,t,Lr,bi),e);break}Fa(t,Lr,bi);break;case 4:if(So(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Cs(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=gn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*OU(r/1960))-r,10<r){t.timeoutHandle=C_(Fa.bind(null,t,Lr,bi),r);break}Fa(t,Lr,bi);break;case 5:Fa(t,Lr,bi);break;default:throw Error(le(329))}}}return qr(t,gn()),t.callbackNode===n?AC.bind(null,t):null}function Y_(t,e){var n=Jd;return t.current.memoizedState.isDehydrated&&(cl(t,e).flags|=256),t=Np(t,e),t!==2&&(e=Lr,Lr=n,e!==null&&J_(e)),t}function J_(t){Lr===null?Lr=t:Lr.push.apply(Lr,t)}function LU(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Os(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function So(t,e){for(e&=~X0,e&=~Dg,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Cs(e),r=1<<n;t[n]=-1,e&=~r}}function nb(t){if(vt&6)throw Error(le(327));Vc();var e=mp(t,0);if(!(e&1))return qr(t,gn()),null;var n=Np(t,e);if(t.tag!==0&&n===2){var r=I_(t);r!==0&&(e=r,n=Y_(t,r))}if(n===1)throw n=Ch,cl(t,0),So(t,e),qr(t,gn()),n;if(n===6)throw Error(le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Fa(t,Lr,bi),qr(t,gn()),null}function eE(t,e){var n=vt;vt|=1;try{return t(e)}finally{vt=n,vt===0&&(cu=gn()+500,Pg&&_a())}}function wl(t){Fo!==null&&Fo.tag===0&&!(vt&6)&&Vc();var e=vt;vt|=1;var n=gs.transition,r=At;try{if(gs.transition=null,At=1,t)return t()}finally{At=r,gs.transition=n,vt=e,!(vt&6)&&_a()}}function tE(){Qr=Sc.current,Bt(Sc)}function cl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,dU(n)),xn!==null)for(n=xn.return;n!==null;){var r=n;switch(L0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&_p();break;case 3:au(),Bt(zr),Bt(vr),W0();break;case 5:z0(r);break;case 4:au();break;case 13:Bt(sn);break;case 19:Bt(sn);break;case 10:U0(r.type._context);break;case 22:case 23:tE()}n=n.return}if(Zn=t,xn=t=Jo(t.current,null),or=Qr=e,Un=0,Ch=null,X0=Dg=_l=0,Lr=Jd=null,Za!==null){for(e=0;e<Za.length;e++)if(n=Za[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Za=null}return t}function xC(t,e){do{var n=xn;try{if(F0(),Lm.current=Rp,xp){for(var r=an.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}xp=!1}if(vl=0,Yn=Fn=an=null,Qd=!1,xh=0,J0.current=null,n===null||n.return===null){Un=1,Ch=e,xn=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=or,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=zS(o);if(m!==null){m.flags&=-257,WS(m,o,a,i,e),m.mode&1&&BS(i,c,e),e=m,l=c;var E=e.updateQueue;if(E===null){var p=new Set;p.add(l),e.updateQueue=p}else E.add(l);break e}else{if(!(e&1)){BS(i,c,e),nE();break e}l=Error(le(426))}}else if(Kt&&a.mode&1){var I=zS(o);if(I!==null){!(I.flags&65536)&&(I.flags|=256),WS(I,o,a,i,e),M0(lu(l,a));break e}}i=l=lu(l,a),Un!==4&&(Un=2),Jd===null?Jd=[i]:Jd.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=uC(i,l,e);MS(i,g);break e;case 1:a=l;var _=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Qo===null||!Qo.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var A=dC(i,a,e);MS(i,A);break e}}i=i.return}while(i!==null)}CC(n)}catch(P){e=P,xn===n&&n!==null&&(xn=n=n.return);continue}break}while(!0)}function RC(){var t=Pp.current;return Pp.current=Rp,t===null?Rp:t}function nE(){(Un===0||Un===3||Un===2)&&(Un=4),Zn===null||!(_l&268435455)&&!(Dg&268435455)||So(Zn,or)}function Np(t,e){var n=vt;vt|=2;var r=RC();(Zn!==t||or!==e)&&(bi=null,cl(t,e));do try{MU();break}catch(s){xC(t,s)}while(!0);if(F0(),vt=n,Pp.current=r,xn!==null)throw Error(le(261));return Zn=null,or=0,Un}function MU(){for(;xn!==null;)PC(xn)}function VU(){for(;xn!==null&&!lF();)PC(xn)}function PC(t){var e=NC(t.alternate,t,Qr);t.memoizedProps=t.pendingProps,e===null?CC(t):xn=e,J0.current=null}function CC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=CU(n,e),n!==null){n.flags&=32767,xn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Un=6,xn=null;return}}else if(n=PU(n,e,Qr),n!==null){xn=n;return}if(e=e.sibling,e!==null){xn=e;return}xn=e=t}while(e!==null);Un===0&&(Un=5)}function Fa(t,e,n){var r=At,s=gs.transition;try{gs.transition=null,At=1,FU(t,e,n,r)}finally{gs.transition=s,At=r}return null}function FU(t,e,n,r){do Vc();while(Fo!==null);if(vt&6)throw Error(le(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(le(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(vF(t,i),t===Zn&&(xn=Zn=null,or=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||rm||(rm=!0,DC(fp,function(){return Vc(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=gs.transition,gs.transition=null;var o=At;At=1;var a=vt;vt|=4,J0.current=null,NU(t,n),SC(n,t),sU(R_),pp=!!x_,R_=x_=null,t.current=n,DU(n),cF(),vt=a,At=o,gs.transition=i}else t.current=n;if(rm&&(rm=!1,Fo=t,kp=s),i=t.pendingLanes,i===0&&(Qo=null),hF(n.stateNode),qr(t,gn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Cp)throw Cp=!1,t=G_,G_=null,t;return kp&1&&t.tag!==0&&Vc(),i=t.pendingLanes,i&1?t===Q_?Xd++:(Xd=0,Q_=t):Xd=0,_a(),null}function Vc(){if(Fo!==null){var t=u1(kp),e=gs.transition,n=At;try{if(gs.transition=null,At=16>t?16:t,Fo===null)var r=!1;else{if(t=Fo,Fo=null,kp=0,vt&6)throw Error(le(331));var s=vt;for(vt|=4,Ae=t.current;Ae!==null;){var i=Ae,o=i.child;if(Ae.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Ae=c;Ae!==null;){var u=Ae;switch(u.tag){case 0:case 11:case 15:Yd(8,u,i)}var h=u.child;if(h!==null)h.return=u,Ae=h;else for(;Ae!==null;){u=Ae;var f=u.sibling,m=u.return;if(EC(u),u===c){Ae=null;break}if(f!==null){f.return=m,Ae=f;break}Ae=m}}}var E=i.alternate;if(E!==null){var p=E.child;if(p!==null){E.child=null;do{var I=p.sibling;p.sibling=null,p=I}while(p!==null)}}Ae=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ae=o;else e:for(;Ae!==null;){if(i=Ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Yd(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,Ae=g;break e}Ae=i.return}}var _=t.current;for(Ae=_;Ae!==null;){o=Ae;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Ae=w;else e:for(o=_;Ae!==null;){if(a=Ae,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ng(9,a)}}catch(P){pn(a,a.return,P)}if(a===o){Ae=null;break e}var A=a.sibling;if(A!==null){A.return=a.return,Ae=A;break e}Ae=a.return}}if(vt=s,_a(),ai&&typeof ai.onPostCommitFiberRoot=="function")try{ai.onPostCommitFiberRoot(Sg,t)}catch{}r=!0}return r}finally{At=n,gs.transition=e}}return!1}function rb(t,e,n){e=lu(n,e),e=uC(t,e,1),t=Go(t,e,1),e=Ar(),t!==null&&(sf(t,1,e),qr(t,e))}function pn(t,e,n){if(t.tag===3)rb(t,t,n);else for(;e!==null;){if(e.tag===3){rb(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Qo===null||!Qo.has(r))){t=lu(n,t),t=dC(e,t,1),e=Go(e,t,1),t=Ar(),e!==null&&(sf(e,1,t),qr(e,t));break}}e=e.return}}function UU(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ar(),t.pingedLanes|=t.suspendedLanes&n,Zn===t&&(or&n)===n&&(Un===4||Un===3&&(or&130023424)===or&&500>gn()-Z0?cl(t,0):X0|=n),qr(t,e)}function kC(t,e){e===0&&(t.mode&1?(e=Kf,Kf<<=1,!(Kf&130023424)&&(Kf=4194304)):e=1);var n=Ar();t=$i(t,e),t!==null&&(sf(t,e,n),qr(t,n))}function jU(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),kC(t,n)}function $U(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(le(314))}r!==null&&r.delete(e),kC(t,n)}var NC;NC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||zr.current)Fr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Fr=!1,RU(t,e,n);Fr=!!(t.flags&131072)}else Fr=!1,Kt&&e.flags&1048576&&M1(e,Ip,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Vm(t,e),t=e.pendingProps;var s=su(e,vr.current);Mc(e,n),s=H0(null,e,r,t,s,n);var i=K0();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Wr(r)?(i=!0,wp(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,$0(e),s.updater=kg,e.stateNode=s,s._reactInternals=e,V_(e,r,t,n),e=j_(null,e,r,!0,i,n)):(e.tag=0,Kt&&i&&O0(e),Tr(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Vm(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=zU(r),t=Ts(r,t),s){case 0:e=U_(null,e,r,t,n);break e;case 1:e=KS(null,e,r,t,n);break e;case 11:e=qS(null,e,r,t,n);break e;case 14:e=HS(null,e,r,Ts(r.type,t),n);break e}throw Error(le(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ts(r,s),U_(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ts(r,s),KS(t,e,r,s,n);case 3:e:{if(pC(e),t===null)throw Error(le(387));r=e.pendingProps,i=e.memoizedState,s=i.element,B1(t,e),bp(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=lu(Error(le(423)),e),e=GS(t,e,r,n,s);break e}else if(r!==s){s=lu(Error(le(424)),e),e=GS(t,e,r,n,s);break e}else for(Zr=Ko(e.stateNode.containerInfo.firstChild),ts=e,Kt=!0,Rs=null,n=j1(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(iu(),r===s){e=Bi(t,e,n);break e}Tr(t,e,r,n)}e=e.child}return e;case 5:return z1(e),t===null&&O_(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,P_(r,s)?o=null:i!==null&&P_(r,i)&&(e.flags|=32),mC(t,e),Tr(t,e,o,n),e.child;case 6:return t===null&&O_(e),null;case 13:return gC(t,e,n);case 4:return B0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ou(e,null,r,n):Tr(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ts(r,s),qS(t,e,r,s,n);case 7:return Tr(t,e,e.pendingProps,n),e.child;case 8:return Tr(t,e,e.pendingProps.children,n),e.child;case 12:return Tr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Mt(Tp,r._currentValue),r._currentValue=o,i!==null)if(Os(i.value,o)){if(i.children===s.children&&!zr.current){e=Bi(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Mi(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),L_(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(le(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),L_(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Tr(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Mc(e,n),s=vs(s),r=r(s),e.flags|=1,Tr(t,e,r,n),e.child;case 14:return r=e.type,s=Ts(r,e.pendingProps),s=Ts(r.type,s),HS(t,e,r,s,n);case 15:return hC(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ts(r,s),Vm(t,e),e.tag=1,Wr(r)?(t=!0,wp(e)):t=!1,Mc(e,n),cC(e,r,s),V_(e,r,s,n),j_(null,e,r,!0,t,n);case 19:return yC(t,e,n);case 22:return fC(t,e,n)}throw Error(le(156,e.tag))};function DC(t,e){return o1(t,e)}function BU(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ps(t,e,n,r){return new BU(t,e,n,r)}function rE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function zU(t){if(typeof t=="function")return rE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===I0)return 11;if(t===T0)return 14}return 2}function Jo(t,e){var n=t.alternate;return n===null?(n=ps(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function jm(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")rE(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case mc:return ul(n.children,s,i,e);case E0:o=8,s|=8;break;case a_:return t=ps(12,n,e,s|2),t.elementType=a_,t.lanes=i,t;case l_:return t=ps(13,n,e,s),t.elementType=l_,t.lanes=i,t;case c_:return t=ps(19,n,e,s),t.elementType=c_,t.lanes=i,t;case zP:return Og(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $P:o=10;break e;case BP:o=9;break e;case I0:o=11;break e;case T0:o=14;break e;case wo:o=16,r=null;break e}throw Error(le(130,t==null?t:typeof t,""))}return e=ps(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ul(t,e,n,r){return t=ps(7,t,r,e),t.lanes=n,t}function Og(t,e,n,r){return t=ps(22,t,r,e),t.elementType=zP,t.lanes=n,t.stateNode={isHidden:!1},t}function fv(t,e,n){return t=ps(6,t,null,e),t.lanes=n,t}function mv(t,e,n){return e=ps(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function WU(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gy(0),this.expirationTimes=Gy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gy(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function sE(t,e,n,r,s,i,o,a,l){return t=new WU(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ps(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$0(i),t}function qU(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function OC(t){if(!t)return oa;t=t._reactInternals;e:{if(Vl(t)!==t||t.tag!==1)throw Error(le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Wr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(le(171))}if(t.tag===1){var n=t.type;if(Wr(n))return O1(t,n,e)}return e}function LC(t,e,n,r,s,i,o,a,l){return t=sE(n,r,!0,t,s,i,o,a,l),t.context=OC(null),n=t.current,r=Ar(),s=Yo(n),i=Mi(r,s),i.callback=e??null,Go(n,i,s),t.current.lanes=s,sf(t,s,r),qr(t,r),t}function Lg(t,e,n,r){var s=e.current,i=Ar(),o=Yo(s);return n=OC(n),e.context===null?e.context=n:e.pendingContext=n,e=Mi(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Go(s,e,o),t!==null&&(ks(t,s,o,i),Om(t,s,o)),o}function Dp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function sb(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function iE(t,e){sb(t,e),(t=t.alternate)&&sb(t,e)}function HU(){return null}var MC=typeof reportError=="function"?reportError:function(t){console.error(t)};function oE(t){this._internalRoot=t}Mg.prototype.render=oE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(le(409));Lg(t,e,null,null)};Mg.prototype.unmount=oE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wl(function(){Lg(null,t,null,null)}),e[ji]=null}};function Mg(t){this._internalRoot=t}Mg.prototype.unstable_scheduleHydration=function(t){if(t){var e=f1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<To.length&&e!==0&&e<To[n].priority;n++);To.splice(n,0,t),n===0&&p1(t)}};function aE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Vg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ib(){}function KU(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Dp(o);i.call(c)}}var o=LC(e,r,t,0,null,!1,!1,"",ib);return t._reactRootContainer=o,t[ji]=o.current,Ih(t.nodeType===8?t.parentNode:t),wl(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Dp(l);a.call(c)}}var l=sE(t,0,!1,null,null,!1,!1,"",ib);return t._reactRootContainer=l,t[ji]=l.current,Ih(t.nodeType===8?t.parentNode:t),wl(function(){Lg(e,l,n,r)}),l}function Fg(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Dp(o);a.call(l)}}Lg(e,o,t,s)}else o=KU(n,e,t,s,r);return Dp(o)}d1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Od(e.pendingLanes);n!==0&&(A0(e,n|1),qr(e,gn()),!(vt&6)&&(cu=gn()+500,_a()))}break;case 13:wl(function(){var r=$i(t,1);if(r!==null){var s=Ar();ks(r,t,1,s)}}),iE(t,1)}};x0=function(t){if(t.tag===13){var e=$i(t,134217728);if(e!==null){var n=Ar();ks(e,t,134217728,n)}iE(t,134217728)}};h1=function(t){if(t.tag===13){var e=Yo(t),n=$i(t,e);if(n!==null){var r=Ar();ks(n,t,e,r)}iE(t,e)}};f1=function(){return At};m1=function(t,e){var n=At;try{return At=t,e()}finally{At=n}};__=function(t,e,n){switch(e){case"input":if(h_(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Rg(r);if(!s)throw Error(le(90));qP(r),h_(r,s)}}}break;case"textarea":KP(t,n);break;case"select":e=n.value,e!=null&&Nc(t,!!n.multiple,e,!1)}};e1=eE;t1=wl;var GU={usingClientEntryPoint:!1,Events:[af,vc,Rg,XP,ZP,eE]},Td={findFiberByHostInstance:Xa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QU={bundleType:Td.bundleType,version:Td.version,rendererPackageName:Td.rendererPackageName,rendererConfig:Td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Yi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=s1(t),t===null?null:t.stateNode},findFiberByHostInstance:Td.findFiberByHostInstance||HU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sm.isDisabled&&sm.supportsFiber)try{Sg=sm.inject(QU),ai=sm}catch{}}as.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GU;as.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!aE(e))throw Error(le(200));return qU(t,e,null,n)};as.createRoot=function(t,e){if(!aE(t))throw Error(le(299));var n=!1,r="",s=MC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=sE(t,1,!1,null,null,n,!1,r,s),t[ji]=e.current,Ih(t.nodeType===8?t.parentNode:t),new oE(e)};as.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(le(188)):(t=Object.keys(t).join(","),Error(le(268,t)));return t=s1(e),t=t===null?null:t.stateNode,t};as.flushSync=function(t){return wl(t)};as.hydrate=function(t,e,n){if(!Vg(e))throw Error(le(200));return Fg(null,t,e,!0,n)};as.hydrateRoot=function(t,e,n){if(!aE(t))throw Error(le(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=MC;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=LC(e,null,t,1,n??null,s,!1,i,o),t[ji]=e.current,Ih(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Mg(e)};as.render=function(t,e,n){if(!Vg(e))throw Error(le(200));return Fg(null,t,e,!1,n)};as.unmountComponentAtNode=function(t){if(!Vg(t))throw Error(le(40));return t._reactRootContainer?(wl(function(){Fg(null,null,t,!1,function(){t._reactRootContainer=null,t[ji]=null})}),!0):!1};as.unstable_batchedUpdates=eE;as.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Vg(n))throw Error(le(200));if(t==null||t._reactInternals===void 0)throw Error(le(38));return Fg(t,e,n,!1,r)};as.version="18.3.1-next-f1338f8080-20240426";function VC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(VC)}catch(t){console.error(t)}}VC(),VP.exports=as;var cf=VP.exports;const FC=bP(cf);var UC,ob=cf;UC=ob.createRoot,ob.hydrateRoot;const YU="modulepreload",JU=function(t,e){return new URL(t,e).href},ab={},ne=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=JU(c,r),c in ab)return;ab[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(!!r)for(let E=o.length-1;E>=0;E--){const p=o[E];if(p.href===c&&(!u||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${h}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":YU,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((E,p)=>{m.addEventListener("load",E),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},XU=1,ZU=1e6;let pv=0;function e4(){return pv=(pv+1)%Number.MAX_SAFE_INTEGER,pv.toString()}const gv=new Map,lb=t=>{if(gv.has(t))return;const e=setTimeout(()=>{gv.delete(t),Zd({type:"REMOVE_TOAST",toastId:t})},ZU);gv.set(t,e)},t4=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,XU)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?lb(n):t.toasts.forEach(r=>{lb(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},$m=[];let Bm={toasts:[]};function Zd(t){Bm=t4(Bm,t),$m.forEach(e=>{e(Bm)})}function n4({...t}){const e=e4(),n=s=>Zd({type:"UPDATE_TOAST",toast:{...s,id:e}}),r=()=>Zd({type:"DISMISS_TOAST",toastId:e});return Zd({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:s=>{s||r()}}}),{id:e,dismiss:r,update:n}}function lE(){const[t,e]=S.useState(Bm);return S.useEffect(()=>($m.push(e),()=>{const n=$m.indexOf(e);n>-1&&$m.splice(n,1)}),[t]),{...t,toast:n4,dismiss:n=>Zd({type:"DISMISS_TOAST",toastId:n})}}function Lt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function cb(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function jC(...t){return e=>{let n=!1;const r=t.map(s=>{const i=cb(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():cb(t[s],null)}}}}function lr(...t){return S.useCallback(jC(...t),t)}function r4(t,e){const n=S.createContext(e),r=i=>{const{children:o,...a}=i,l=S.useMemo(()=>a,Object.values(a));return v.jsx(n.Provider,{value:l,children:o})};r.displayName=t+"Provider";function s(i){const o=S.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,s]}function $u(t,e=[]){let n=[];function r(i,o){const a=S.createContext(o),l=n.length;n=[...n,o];const c=h=>{var g;const{scope:f,children:m,...E}=h,p=((g=f==null?void 0:f[t])==null?void 0:g[l])||a,I=S.useMemo(()=>E,Object.values(E));return v.jsx(p.Provider,{value:I,children:m})};c.displayName=i+"Provider";function u(h,f){var p;const m=((p=f==null?void 0:f[t])==null?void 0:p[l])||a,E=S.useContext(m);if(E)return E;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(o=>S.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return S.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,s4(s,...e)]}function s4(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return S.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function kh(t){const e=o4(t),n=S.forwardRef((r,s)=>{const{children:i,...o}=r,a=S.Children.toArray(i),l=a.find(l4);if(l){const c=l.props.children,u=a.map(h=>h===l?S.Children.count(c)>1?S.Children.only(null):S.isValidElement(c)?c.props.children:null:h);return v.jsx(e,{...o,ref:s,children:S.isValidElement(c)?S.cloneElement(c,void 0,u):null})}return v.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var i4=kh("Slot");function o4(t){const e=S.forwardRef((n,r)=>{const{children:s,...i}=n;if(S.isValidElement(s)){const o=u4(s),a=c4(i,s.props);return s.type!==S.Fragment&&(a.ref=r?jC(r,o):o),S.cloneElement(s,a)}return S.Children.count(s)>1?S.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var $C=Symbol("radix.slottable");function a4(t){const e=({children:n})=>v.jsx(v.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=$C,e}function l4(t){return S.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===$C}function c4(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function u4(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function d4(t){const e=t+"CollectionProvider",[n,r]=$u(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=p=>{const{scope:I,children:g}=p,_=F.useRef(null),w=F.useRef(new Map).current;return v.jsx(s,{scope:I,itemMap:w,collectionRef:_,children:g})};o.displayName=e;const a=t+"CollectionSlot",l=kh(a),c=F.forwardRef((p,I)=>{const{scope:g,children:_}=p,w=i(a,g),A=lr(I,w.collectionRef);return v.jsx(l,{ref:A,children:_})});c.displayName=a;const u=t+"CollectionItemSlot",h="data-radix-collection-item",f=kh(u),m=F.forwardRef((p,I)=>{const{scope:g,children:_,...w}=p,A=F.useRef(null),P=lr(I,A),L=i(u,g);return F.useEffect(()=>(L.itemMap.set(A,{ref:A,...w}),()=>void L.itemMap.delete(A))),v.jsx(f,{[h]:"",ref:P,children:_})});m.displayName=u;function E(p){const I=i(t+"CollectionConsumer",p);return F.useCallback(()=>{const _=I.collectionRef.current;if(!_)return[];const w=Array.from(_.querySelectorAll(`[${h}]`));return Array.from(I.itemMap.values()).sort((L,x)=>w.indexOf(L.ref.current)-w.indexOf(x.ref.current))},[I.collectionRef,I.itemMap])}return[{Provider:o,Slot:c,ItemSlot:m},E,r]}var h4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Jt=h4.reduce((t,e)=>{const n=kh(`Primitive.${e}`),r=S.forwardRef((s,i)=>{const{asChild:o,...a}=s,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),v.jsx(l,{...a,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function BC(t,e){t&&cf.flushSync(()=>t.dispatchEvent(e))}function pi(t){const e=S.useRef(t);return S.useEffect(()=>{e.current=t}),S.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function f4(t,e=globalThis==null?void 0:globalThis.document){const n=pi(t);S.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var m4="DismissableLayer",X_="dismissableLayer.update",p4="dismissableLayer.pointerDownOutside",g4="dismissableLayer.focusOutside",ub,zC=S.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ug=S.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=S.useContext(zC),[u,h]=S.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=S.useState({}),E=lr(e,x=>h(x)),p=Array.from(c.layers),[I]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),g=p.indexOf(I),_=u?p.indexOf(u):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,A=_>=g,P=v4(x=>{const T=x.target,R=[...c.branches].some(C=>C.contains(T));!A||R||(s==null||s(x),o==null||o(x),x.defaultPrevented||a==null||a())},f),L=_4(x=>{const T=x.target;[...c.branches].some(C=>C.contains(T))||(i==null||i(x),o==null||o(x),x.defaultPrevented||a==null||a())},f);return f4(x=>{_===c.layers.size-1&&(r==null||r(x),!x.defaultPrevented&&a&&(x.preventDefault(),a()))},f),S.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(ub=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),db(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=ub)}},[u,f,n,c]),S.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),db())},[u,c]),S.useEffect(()=>{const x=()=>m({});return document.addEventListener(X_,x),()=>document.removeEventListener(X_,x)},[]),v.jsx(Jt.div,{...l,ref:E,style:{pointerEvents:w?A?"auto":"none":void 0,...t.style},onFocusCapture:Lt(t.onFocusCapture,L.onFocusCapture),onBlurCapture:Lt(t.onBlurCapture,L.onBlurCapture),onPointerDownCapture:Lt(t.onPointerDownCapture,P.onPointerDownCapture)})});Ug.displayName=m4;var y4="DismissableLayerBranch",WC=S.forwardRef((t,e)=>{const n=S.useContext(zC),r=S.useRef(null),s=lr(e,r);return S.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),v.jsx(Jt.div,{...t,ref:s})});WC.displayName=y4;function v4(t,e=globalThis==null?void 0:globalThis.document){const n=pi(t),r=S.useRef(!1),s=S.useRef(()=>{});return S.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){qC(p4,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function _4(t,e=globalThis==null?void 0:globalThis.document){const n=pi(t),r=S.useRef(!1);return S.useEffect(()=>{const s=i=>{i.target&&!r.current&&qC(g4,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function db(){const t=new CustomEvent(X_);document.dispatchEvent(t)}function qC(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?BC(s,i):s.dispatchEvent(i)}var w4=Ug,E4=WC,zi=globalThis!=null&&globalThis.document?S.useLayoutEffect:()=>{},I4="Portal",cE=S.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[s,i]=S.useState(!1);zi(()=>i(!0),[]);const o=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?FC.createPortal(v.jsx(Jt.div,{...r,ref:e}),o):null});cE.displayName=I4;function T4(t,e){return S.useReducer((n,r)=>e[n][r]??n,t)}var Fl=t=>{const{present:e,children:n}=t,r=S4(e),s=typeof n=="function"?n({present:r.isPresent}):S.Children.only(n),i=lr(r.ref,b4(s));return typeof n=="function"||r.isPresent?S.cloneElement(s,{ref:i}):null};Fl.displayName="Presence";function S4(t){const[e,n]=S.useState(),r=S.useRef(null),s=S.useRef(t),i=S.useRef("none"),o=t?"mounted":"unmounted",[a,l]=T4(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return S.useEffect(()=>{const c=im(r.current);i.current=a==="mounted"?c:"none"},[a]),zi(()=>{const c=r.current,u=s.current;if(u!==t){const f=i.current,m=im(c);t?l("MOUNT"):m==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),zi(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=m=>{const p=im(r.current).includes(CSS.escape(m.animationName));if(m.target===e&&p&&(l("ANIMATION_END"),!s.current)){const I=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=I)})}},f=m=>{m.target===e&&(i.current=im(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:S.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function im(t){return(t==null?void 0:t.animationName)||"none"}function b4(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var A4=y0[" useInsertionEffect ".trim().toString()]||zi;function uE({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,o]=x4({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:s;{const u=S.useRef(t!==void 0);S.useEffect(()=>{const h=u.current;h!==a&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,r])}const c=S.useCallback(u=>{var h;if(a){const f=R4(u)?u(t):u;f!==t&&((h=o.current)==null||h.call(o,f))}else i(u)},[a,t,i,o]);return[l,c]}function x4({defaultProp:t,onChange:e}){const[n,r]=S.useState(t),s=S.useRef(n),i=S.useRef(e);return A4(()=>{i.current=e},[e]),S.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function R4(t){return typeof t=="function"}var P4=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),C4="VisuallyHidden",jg=S.forwardRef((t,e)=>v.jsx(Jt.span,{...t,ref:e,style:{...P4,...t.style}}));jg.displayName=C4;var k4=jg,dE="ToastProvider",[hE,N4,D4]=d4("Toast"),[HC]=$u("Toast",[D4]),[O4,$g]=HC(dE),KC=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[a,l]=S.useState(null),[c,u]=S.useState(0),h=S.useRef(!1),f=S.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${dE}\`. Expected non-empty \`string\`.`),v.jsx(hE.Provider,{scope:e,children:v.jsx(O4,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:S.useCallback(()=>u(m=>m+1),[]),onToastRemove:S.useCallback(()=>u(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};KC.displayName=dE;var GC="ToastViewport",L4=["F8"],Z_="toast.viewportPause",ew="toast.viewportResume",QC=S.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=L4,label:s="Notifications ({hotkey})",...i}=t,o=$g(GC,n),a=N4(n),l=S.useRef(null),c=S.useRef(null),u=S.useRef(null),h=S.useRef(null),f=lr(e,h,o.onViewportChange),m=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),E=o.toastCount>0;S.useEffect(()=>{const I=g=>{var w;r.length!==0&&r.every(A=>g[A]||g.code===A)&&((w=h.current)==null||w.focus())};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[r]),S.useEffect(()=>{const I=l.current,g=h.current;if(E&&I&&g){const _=()=>{if(!o.isClosePausedRef.current){const L=new CustomEvent(Z_);g.dispatchEvent(L),o.isClosePausedRef.current=!0}},w=()=>{if(o.isClosePausedRef.current){const L=new CustomEvent(ew);g.dispatchEvent(L),o.isClosePausedRef.current=!1}},A=L=>{!I.contains(L.relatedTarget)&&w()},P=()=>{I.contains(document.activeElement)||w()};return I.addEventListener("focusin",_),I.addEventListener("focusout",A),I.addEventListener("pointermove",_),I.addEventListener("pointerleave",P),window.addEventListener("blur",_),window.addEventListener("focus",w),()=>{I.removeEventListener("focusin",_),I.removeEventListener("focusout",A),I.removeEventListener("pointermove",_),I.removeEventListener("pointerleave",P),window.removeEventListener("blur",_),window.removeEventListener("focus",w)}}},[E,o.isClosePausedRef]);const p=S.useCallback(({tabbingDirection:I})=>{const _=a().map(w=>{const A=w.ref.current,P=[A,...G4(A)];return I==="forwards"?P:P.reverse()});return(I==="forwards"?_.reverse():_).flat()},[a]);return S.useEffect(()=>{const I=h.current;if(I){const g=_=>{var P,L,x;const w=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!w){const T=document.activeElement,R=_.shiftKey;if(_.target===I&&R){(P=c.current)==null||P.focus();return}const O=p({tabbingDirection:R?"backwards":"forwards"}),k=O.findIndex(B=>B===T);yv(O.slice(k+1))?_.preventDefault():R?(L=c.current)==null||L.focus():(x=u.current)==null||x.focus()}};return I.addEventListener("keydown",g),()=>I.removeEventListener("keydown",g)}},[a,p]),v.jsxs(E4,{ref:l,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:E?void 0:"none"},children:[E&&v.jsx(tw,{ref:c,onFocusFromOutsideViewport:()=>{const I=p({tabbingDirection:"forwards"});yv(I)}}),v.jsx(hE.Slot,{scope:n,children:v.jsx(Jt.ol,{tabIndex:-1,...i,ref:f})}),E&&v.jsx(tw,{ref:u,onFocusFromOutsideViewport:()=>{const I=p({tabbingDirection:"backwards"});yv(I)}})]})});QC.displayName=GC;var YC="ToastFocusProxy",tw=S.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=$g(YC,n);return v.jsx(jg,{tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=i.viewport)!=null&&c.contains(a))&&r()}})});tw.displayName=YC;var uf="Toast",M4="toast.swipeStart",V4="toast.swipeMove",F4="toast.swipeCancel",U4="toast.swipeEnd",JC=S.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[a,l]=uE({prop:r,defaultProp:s??!0,onChange:i,caller:uf});return v.jsx(Fl,{present:n||a,children:v.jsx(B4,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:pi(t.onPause),onResume:pi(t.onResume),onSwipeStart:Lt(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Lt(t.onSwipeMove,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:Lt(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Lt(t.onSwipeEnd,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),l(!1)})})})});JC.displayName=uf;var[j4,$4]=HC(uf,{onClose(){}}),B4=S.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...E}=t,p=$g(uf,n),[I,g]=S.useState(null),_=lr(e,B=>g(B)),w=S.useRef(null),A=S.useRef(null),P=s||p.duration,L=S.useRef(0),x=S.useRef(P),T=S.useRef(0),{onToastAdd:R,onToastRemove:C}=p,D=pi(()=>{var ce;(I==null?void 0:I.contains(document.activeElement))&&((ce=p.viewport)==null||ce.focus()),o()}),O=S.useCallback(B=>{!B||B===1/0||(window.clearTimeout(T.current),L.current=new Date().getTime(),T.current=window.setTimeout(D,B))},[D]);S.useEffect(()=>{const B=p.viewport;if(B){const ce=()=>{O(x.current),c==null||c()},he=()=>{const Se=new Date().getTime()-L.current;x.current=x.current-Se,window.clearTimeout(T.current),l==null||l()};return B.addEventListener(Z_,he),B.addEventListener(ew,ce),()=>{B.removeEventListener(Z_,he),B.removeEventListener(ew,ce)}}},[p.viewport,P,l,c,O]),S.useEffect(()=>{i&&!p.isClosePausedRef.current&&O(P)},[i,P,p.isClosePausedRef,O]),S.useEffect(()=>(R(),()=>C()),[R,C]);const k=S.useMemo(()=>I?sk(I):null,[I]);return p.viewport?v.jsxs(v.Fragment,{children:[k&&v.jsx(z4,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite",children:k}),v.jsx(j4,{scope:n,onClose:D,children:cf.createPortal(v.jsx(hE.ItemSlot,{scope:n,children:v.jsx(w4,{asChild:!0,onEscapeKeyDown:Lt(a,()=>{p.isFocusedToastEscapeKeyDownRef.current||D(),p.isFocusedToastEscapeKeyDownRef.current=!1}),children:v.jsx(Jt.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":p.swipeDirection,...E,ref:_,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Lt(t.onKeyDown,B=>{B.key==="Escape"&&(a==null||a(B.nativeEvent),B.nativeEvent.defaultPrevented||(p.isFocusedToastEscapeKeyDownRef.current=!0,D()))}),onPointerDown:Lt(t.onPointerDown,B=>{B.button===0&&(w.current={x:B.clientX,y:B.clientY})}),onPointerMove:Lt(t.onPointerMove,B=>{if(!w.current)return;const ce=B.clientX-w.current.x,he=B.clientY-w.current.y,Se=!!A.current,$=["left","right"].includes(p.swipeDirection),q=["left","up"].includes(p.swipeDirection)?Math.min:Math.max,X=$?q(0,ce):0,we=$?0:q(0,he),Ie=B.pointerType==="touch"?10:2,re={x:X,y:we},ve={originalEvent:B,delta:re};Se?(A.current=re,om(V4,h,ve,{discrete:!1})):hb(re,p.swipeDirection,Ie)?(A.current=re,om(M4,u,ve,{discrete:!1}),B.target.setPointerCapture(B.pointerId)):(Math.abs(ce)>Ie||Math.abs(he)>Ie)&&(w.current=null)}),onPointerUp:Lt(t.onPointerUp,B=>{const ce=A.current,he=B.target;if(he.hasPointerCapture(B.pointerId)&&he.releasePointerCapture(B.pointerId),A.current=null,w.current=null,ce){const Se=B.currentTarget,$={originalEvent:B,delta:ce};hb(ce,p.swipeDirection,p.swipeThreshold)?om(U4,m,$,{discrete:!0}):om(F4,f,$,{discrete:!0}),Se.addEventListener("click",q=>q.preventDefault(),{once:!0})}})})})}),p.viewport)})]}):null}),z4=t=>{const{__scopeToast:e,children:n,...r}=t,s=$g(uf,e),[i,o]=S.useState(!1),[a,l]=S.useState(!1);return H4(()=>o(!0)),S.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:v.jsx(cE,{asChild:!0,children:v.jsx(jg,{...r,children:i&&v.jsxs(v.Fragment,{children:[s.label," ",n]})})})},W4="ToastTitle",XC=S.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return v.jsx(Jt.div,{...r,ref:e})});XC.displayName=W4;var q4="ToastDescription",ZC=S.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return v.jsx(Jt.div,{...r,ref:e})});ZC.displayName=q4;var ek="ToastAction",tk=S.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?v.jsx(rk,{altText:n,asChild:!0,children:v.jsx(fE,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${ek}\`. Expected non-empty \`string\`.`),null)});tk.displayName=ek;var nk="ToastClose",fE=S.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=$4(nk,n);return v.jsx(rk,{asChild:!0,children:v.jsx(Jt.button,{type:"button",...r,ref:e,onClick:Lt(t.onClick,s.onClose)})})});fE.displayName=nk;var rk=S.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return v.jsx(Jt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function sk(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),K4(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...sk(r))}}),e}function om(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?BC(s,i):s.dispatchEvent(i)}var hb=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function H4(t=()=>{}){const e=pi(t);zi(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function K4(t){return t.nodeType===t.ELEMENT_NODE}function G4(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function yv(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var Q4=KC,ik=QC,ok=JC,ak=XC,lk=ZC,ck=tk,uk=fE;function dk(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=dk(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function hk(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=dk(t))&&(r&&(r+=" "),r+=e);return r}const fb=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,mb=hk,mE=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return mb(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],h=i==null?void 0:i[c];if(u===null)return null;const f=fb(u)||fb(h);return s[c][f]}),a=n&&Object.entries(n).reduce((c,u)=>{let[h,f]=u;return f===void 0||(c[h]=f),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:h,className:f,...m}=u;return Object.entries(m).every(E=>{let[p,I]=E;return Array.isArray(I)?I.includes({...i,...a}[p]):{...i,...a}[p]===I})?[...c,h,f]:c},[]);return mb(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y4=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),J4=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),pb=t=>{const e=J4(t);return e.charAt(0).toUpperCase()+e.slice(1)},fk=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),X4=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Z4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ej=S.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},l)=>S.createElement("svg",{ref:l,...Z4,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:fk("lucide",s),...!i&&!X4(a)&&{"aria-hidden":"true"},...a},[...o.map(([c,u])=>S.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=(t,e)=>{const n=S.forwardRef(({className:r,...s},i)=>S.createElement(ej,{ref:i,iconNode:e,className:fk(`lucide-${Y4(pb(t))}`,`lucide-${t}`,r),...s}));return n.displayName=pb(t),n};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tj=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],nj=Ct("arrow-down",tj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rj=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],mk=Ct("arrow-right",rj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sj=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ij=Ct("arrow-up-down",sj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oj=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"M9 9h.01",key:"1q5me6"}],["path",{d:"M15 15h.01",key:"lqbp3k"}]],aj=Ct("badge-percent",oj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lj=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],cj=Ct("check",lj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uj=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],dj=Ct("clock",uj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hj=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],fj=Ct("credit-card",hj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mj=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],pk=Ct("eye-off",mj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pj=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],gk=Ct("eye",pj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gj=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],yj=Ct("file-text",gj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vj=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],_j=Ct("house",vj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wj=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],yk=Ct("lock",wj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ej=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],gb=Ct("log-out",Ej);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ij=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],nw=Ct("mail",Ij);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tj=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Sj=Ct("message-circle",Tj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bj=[["path",{d:"M5 12h14",key:"1ays0h"}]],Aj=Ct("minus",bj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xj=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],yb=Ct("plus",xj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rj=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],vb=Ct("receipt",Rj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pj=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],pE=Ct("refresh-ccw",Pj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cj=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_b=Ct("settings",Cj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kj=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],vk=Ct("shield",kj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nj=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Dj=Ct("square",Nj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oj=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],Lj=Ct("store",Oj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mj=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],wb=Ct("trending-up",Mj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vj=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],_k=Ct("triangle-alert",Vj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fj=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Uj=Ct("user",Fj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jj=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],$j=Ct("wrench",jj);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bj=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],gE=Ct("x",Bj),yE="-",zj=t=>{const e=qj(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const a=o.split(yE);return a[0]===""&&a.length!==1&&a.shift(),wk(a,e)||Wj(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&r[o]?[...l,...r[o]]:l}}},wk=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),s=r?wk(t.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=t.join(yE);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},Eb=/^\[(.+)\]$/,Wj=t=>{if(Eb.test(t)){const e=Eb.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},qj=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return Kj(Object.entries(t.classGroups),n).forEach(([i,o])=>{rw(o,r,i,e)}),r},rw=(t,e,n,r)=>{t.forEach(s=>{if(typeof s=="string"){const i=s===""?e:Ib(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(Hj(s)){rw(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,o])=>{rw(o,Ib(e,i),n,r)})})},Ib=(t,e)=>{let n=t;return e.split(yE).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Hj=t=>t.isThemeGetter,Kj=(t,e)=>e?t.map(([n,r])=>{const s=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[n,s]}):t,Gj=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const s=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return s(i,o),o},set(i,o){n.has(i)?n.set(i,o):s(i,o)}}},Ek="!",Qj=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,s=e[0],i=e.length,o=a=>{const l=[];let c=0,u=0,h;for(let I=0;I<a.length;I++){let g=a[I];if(c===0){if(g===s&&(r||a.slice(I,I+i)===e)){l.push(a.slice(u,I)),u=I+i;continue}if(g==="/"){h=I;continue}}g==="["?c++:g==="]"&&c--}const f=l.length===0?a:a.substring(u),m=f.startsWith(Ek),E=m?f.substring(1):f,p=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:m,baseClassName:E,maybePostfixModifierPosition:p}};return n?a=>n({className:a,parseClassName:o}):o},Yj=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},Jj=t=>({cache:Gj(t.cacheSize),parseClassName:Qj(t),...zj(t)}),Xj=/\s+/,Zj=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=e,i=[],o=t.trim().split(Xj);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:m}=n(c);let E=!!m,p=r(E?f.substring(0,m):f);if(!p){if(!E){a=c+(a.length>0?" "+a:a);continue}if(p=r(f),!p){a=c+(a.length>0?" "+a:a);continue}E=!1}const I=Yj(u).join(":"),g=h?I+Ek:I,_=g+p;if(i.includes(_))continue;i.push(_);const w=s(p,E);for(let A=0;A<w.length;++A){const P=w[A];i.push(g+P)}a=c+(a.length>0?" "+a:a)}return a};function e$(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=Ik(e))&&(r&&(r+=" "),r+=n);return r}const Ik=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=Ik(t[r]))&&(n&&(n+=" "),n+=e);return n};function t$(t,...e){let n,r,s,i=o;function o(l){const c=e.reduce((u,h)=>h(u),t());return n=Jj(c),r=n.cache.get,s=n.cache.set,i=a,a(l)}function a(l){const c=r(l);if(c)return c;const u=Zj(l,n);return s(l,u),u}return function(){return i(e$.apply(null,arguments))}}const Ft=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},Tk=/^\[(?:([a-z-]+):)?(.+)\]$/i,n$=/^\d+\/\d+$/,r$=new Set(["px","full","screen"]),s$=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,i$=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,o$=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,a$=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,l$=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ti=t=>Fc(t)||r$.has(t)||n$.test(t),uo=t=>Bu(t,"length",g$),Fc=t=>!!t&&!Number.isNaN(Number(t)),vv=t=>Bu(t,"number",Fc),Sd=t=>!!t&&Number.isInteger(Number(t)),c$=t=>t.endsWith("%")&&Fc(t.slice(0,-1)),Xe=t=>Tk.test(t),ho=t=>s$.test(t),u$=new Set(["length","size","percentage"]),d$=t=>Bu(t,u$,Sk),h$=t=>Bu(t,"position",Sk),f$=new Set(["image","url"]),m$=t=>Bu(t,f$,v$),p$=t=>Bu(t,"",y$),bd=()=>!0,Bu=(t,e,n)=>{const r=Tk.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},g$=t=>i$.test(t)&&!o$.test(t),Sk=()=>!1,y$=t=>a$.test(t),v$=t=>l$.test(t),_$=()=>{const t=Ft("colors"),e=Ft("spacing"),n=Ft("blur"),r=Ft("brightness"),s=Ft("borderColor"),i=Ft("borderRadius"),o=Ft("borderSpacing"),a=Ft("borderWidth"),l=Ft("contrast"),c=Ft("grayscale"),u=Ft("hueRotate"),h=Ft("invert"),f=Ft("gap"),m=Ft("gradientColorStops"),E=Ft("gradientColorStopPositions"),p=Ft("inset"),I=Ft("margin"),g=Ft("opacity"),_=Ft("padding"),w=Ft("saturate"),A=Ft("scale"),P=Ft("sepia"),L=Ft("skew"),x=Ft("space"),T=Ft("translate"),R=()=>["auto","contain","none"],C=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto",Xe,e],O=()=>[Xe,e],k=()=>["",Ti,uo],B=()=>["auto",Fc,Xe],ce=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],he=()=>["solid","dashed","dotted","double","none"],Se=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],$=()=>["start","end","center","between","around","evenly","stretch"],q=()=>["","0",Xe],X=()=>["auto","avoid","all","avoid-page","page","left","right","column"],we=()=>[Fc,Xe];return{cacheSize:500,separator:":",theme:{colors:[bd],spacing:[Ti,uo],blur:["none","",ho,Xe],brightness:we(),borderColor:[t],borderRadius:["none","","full",ho,Xe],borderSpacing:O(),borderWidth:k(),contrast:we(),grayscale:q(),hueRotate:we(),invert:q(),gap:O(),gradientColorStops:[t],gradientColorStopPositions:[c$,uo],inset:D(),margin:D(),opacity:we(),padding:O(),saturate:we(),scale:we(),sepia:q(),skew:we(),space:O(),translate:O()},classGroups:{aspect:[{aspect:["auto","square","video",Xe]}],container:["container"],columns:[{columns:[ho]}],"break-after":[{"break-after":X()}],"break-before":[{"break-before":X()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ce(),Xe]}],overflow:[{overflow:C()}],"overflow-x":[{"overflow-x":C()}],"overflow-y":[{"overflow-y":C()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Sd,Xe]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Xe]}],grow:[{grow:q()}],shrink:[{shrink:q()}],order:[{order:["first","last","none",Sd,Xe]}],"grid-cols":[{"grid-cols":[bd]}],"col-start-end":[{col:["auto",{span:["full",Sd,Xe]},Xe]}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":[bd]}],"row-start-end":[{row:["auto",{span:[Sd,Xe]},Xe]}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Xe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Xe]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...$()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...$(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...$(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[I]}],mx:[{mx:[I]}],my:[{my:[I]}],ms:[{ms:[I]}],me:[{me:[I]}],mt:[{mt:[I]}],mr:[{mr:[I]}],mb:[{mb:[I]}],ml:[{ml:[I]}],"space-x":[{"space-x":[x]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[x]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Xe,e]}],"min-w":[{"min-w":[Xe,e,"min","max","fit"]}],"max-w":[{"max-w":[Xe,e,"none","full","min","max","fit","prose",{screen:[ho]},ho]}],h:[{h:[Xe,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Xe,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Xe,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Xe,e,"auto","min","max","fit"]}],"font-size":[{text:["base",ho,uo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",vv]}],"font-family":[{font:[bd]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Xe]}],"line-clamp":[{"line-clamp":["none",Fc,vv]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ti,Xe]}],"list-image":[{"list-image":["none",Xe]}],"list-style-type":[{list:["none","disc","decimal",Xe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...he(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ti,uo]}],"underline-offset":[{"underline-offset":["auto",Ti,Xe]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Xe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Xe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ce(),h$]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",d$]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},m$]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[E]}],"gradient-via-pos":[{via:[E]}],"gradient-to-pos":[{to:[E]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[...he(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:he()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...he()]}],"outline-offset":[{"outline-offset":[Ti,Xe]}],"outline-w":[{outline:[Ti,uo]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:k()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[Ti,uo]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",ho,p$]}],"shadow-color":[{shadow:[bd]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":[...Se(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Se()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",ho,Xe]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[w]}],sepia:[{sepia:[P]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[P]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Xe]}],duration:[{duration:we()}],ease:[{ease:["linear","in","out","in-out",Xe]}],delay:[{delay:we()}],animate:[{animate:["none","spin","ping","pulse","bounce",Xe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[A]}],"scale-x":[{"scale-x":[A]}],"scale-y":[{"scale-y":[A]}],rotate:[{rotate:[Sd,Xe]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[L]}],"skew-y":[{"skew-y":[L]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Xe]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Xe]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Xe]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ti,uo,vv]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},w$=t$(_$);function Yt(...t){return w$(hk(t))}const E$=Q4,bk=S.forwardRef(({className:t,...e},n)=>v.jsx(ik,{ref:n,className:Yt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));bk.displayName=ik.displayName;const I$=mE("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ak=S.forwardRef(({className:t,variant:e,...n},r)=>v.jsx(ok,{ref:r,className:Yt(I$({variant:e}),t),...n}));Ak.displayName=ok.displayName;const T$=S.forwardRef(({className:t,...e},n)=>v.jsx(ck,{ref:n,className:Yt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));T$.displayName=ck.displayName;const xk=S.forwardRef(({className:t,...e},n)=>v.jsx(uk,{ref:n,className:Yt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:v.jsx(gE,{className:"h-4 w-4"})}));xk.displayName=uk.displayName;const Rk=S.forwardRef(({className:t,...e},n)=>v.jsx(ak,{ref:n,className:Yt("text-sm font-semibold",t),...e}));Rk.displayName=ak.displayName;const Pk=S.forwardRef(({className:t,...e},n)=>v.jsx(lk,{ref:n,className:Yt("text-sm opacity-90",t),...e}));Pk.displayName=lk.displayName;function S$(){const{toasts:t}=lE();return v.jsxs(E$,{children:[t.map(function({id:e,title:n,description:r,action:s,...i}){return v.jsxs(Ak,{...i,children:[v.jsxs("div",{className:"grid gap-1",children:[n&&v.jsx(Rk,{children:n}),r&&v.jsx(Pk,{children:r})]}),s,v.jsx(xk,{})]},e)}),v.jsx(bk,{})]})}var Op=["light","dark"],vE="(prefers-color-scheme: dark)",b$=typeof window>"u",_E=S.createContext(void 0),A$={setTheme:t=>{},themes:[]},Ck=()=>{var t;return(t=S.useContext(_E))!=null?t:A$},x$=t=>S.useContext(_E)?t.children:S.createElement(P$,{...t}),R$=["light","dark"],P$=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:n=!0,enableColorScheme:r=!0,storageKey:s="theme",themes:i=R$,defaultTheme:o=n?"system":"light",attribute:a="data-theme",value:l,children:c,nonce:u})=>{let[h,f]=S.useState(()=>Tb(s,o)),[m,E]=S.useState(()=>Tb(s)),p=l?Object.values(l):i,I=S.useCallback(A=>{let P=A;if(!P)return;A==="system"&&n&&(P=Sb());let L=l?l[P]:P,x=e?k$():null,T=document.documentElement;if(a==="class"?(T.classList.remove(...p),L&&T.classList.add(L)):L?T.setAttribute(a,L):T.removeAttribute(a),r){let R=Op.includes(o)?o:null,C=Op.includes(P)?P:R;T.style.colorScheme=C}x==null||x()},[]),g=S.useCallback(A=>{let P=typeof A=="function"?A(A):A;f(P);try{localStorage.setItem(s,P)}catch{}},[t]),_=S.useCallback(A=>{let P=Sb(A);E(P),h==="system"&&n&&!t&&I("system")},[h,t]);S.useEffect(()=>{let A=window.matchMedia(vE);return A.addListener(_),_(A),()=>A.removeListener(_)},[_]),S.useEffect(()=>{let A=P=>{if(P.key!==s)return;let L=P.newValue||o;g(L)};return window.addEventListener("storage",A),()=>window.removeEventListener("storage",A)},[g]),S.useEffect(()=>{I(t??h)},[t,h]);let w=S.useMemo(()=>({theme:h,setTheme:g,forcedTheme:t,resolvedTheme:h==="system"?m:h,themes:n?[...i,"system"]:i,systemTheme:n?m:void 0}),[h,g,t,m,n,i]);return S.createElement(_E.Provider,{value:w},S.createElement(C$,{forcedTheme:t,disableTransitionOnChange:e,enableSystem:n,enableColorScheme:r,storageKey:s,themes:i,defaultTheme:o,attribute:a,value:l,children:c,attrs:p,nonce:u}),c)},C$=S.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:o,attrs:a,nonce:l})=>{let c=i==="system",u=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(E=>`'${E}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,h=s?Op.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(E,p=!1,I=!0)=>{let g=o?o[E]:E,_=p?E+"|| ''":`'${g}'`,w="";return s&&I&&!p&&Op.includes(E)&&(w+=`d.style.colorScheme = '${E}';`),n==="class"?p||g?w+=`c.add(${_})`:w+="null":g&&(w+=`d[s](n,${_})`),w},m=t?`!function(){${u}${f(t)}}()`:r?`!function(){try{${u}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${c})){var t='${vE}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${c?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return S.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:m}})}),Tb=(t,e)=>{if(b$)return;let n;try{n=localStorage.getItem(t)||void 0}catch{}return n||e},k$=()=>{let t=document.createElement("style");return t.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},Sb=t=>(t||(t=window.matchMedia(vE)),t.matches?"dark":"light"),N$=t=>{switch(t){case"success":return L$;case"info":return V$;case"warning":return M$;case"error":return F$;default:return null}},D$=Array(12).fill(0),O$=({visible:t,className:e})=>F.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},F.createElement("div",{className:"sonner-spinner"},D$.map((n,r)=>F.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),L$=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),M$=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),V$=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),F$=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),U$=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},F.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),F.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),j$=()=>{let[t,e]=F.useState(document.hidden);return F.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},sw=1,$$=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let n=this.subscribers.indexOf(e);this.subscribers.splice(n,1)}),this.publish=e=>{this.subscribers.forEach(n=>n(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var n;let{message:r,...s}=e,i=typeof(e==null?void 0:e.id)=="number"||((n=e.id)==null?void 0:n.length)>0?e.id:sw++,o=this.toasts.find(l=>l.id===i),a=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),o?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...e,id:i,title:r}),{...l,...e,id:i,dismissible:a,title:r}):l):this.addToast({title:r,...s,dismissible:a,id:i}),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:e,dismiss:!0})),e),this.message=(e,n)=>this.create({...n,message:e}),this.error=(e,n)=>this.create({...n,message:e,type:"error"}),this.success=(e,n)=>this.create({...n,type:"success",message:e}),this.info=(e,n)=>this.create({...n,type:"info",message:e}),this.warning=(e,n)=>this.create({...n,type:"warning",message:e}),this.loading=(e,n)=>this.create({...n,type:"loading",message:e}),this.promise=(e,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:e,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let s=e instanceof Promise?e:e(),i=r!==void 0,o,a=s.then(async c=>{if(o=["resolve",c],F.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(z$(c)&&!c.ok){i=!1;let u=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,h=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description;this.create({id:r,type:"error",message:u,description:h})}else if(n.success!==void 0){i=!1;let u=typeof n.success=="function"?await n.success(c):n.success,h=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"success",message:u,description:h})}}).catch(async c=>{if(o=["reject",c],n.error!==void 0){i=!1;let u=typeof n.error=="function"?await n.error(c):n.error,h=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"error",message:u,description:h})}}).finally(()=>{var c;i&&(this.dismiss(r),r=void 0),(c=n.finally)==null||c.call(n)}),l=()=>new Promise((c,u)=>a.then(()=>o[0]==="reject"?u(o[1]):c(o[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(e,n)=>{let r=(n==null?void 0:n.id)||sw++;return this.create({jsx:e(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Dr=new $$,B$=(t,e)=>{let n=(e==null?void 0:e.id)||sw++;return Dr.addToast({title:t,...e,id:n}),n},z$=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",W$=B$,q$=()=>Dr.toasts,H$=()=>Dr.getActiveToasts(),Et=Object.assign(W$,{success:Dr.success,info:Dr.info,warning:Dr.warning,error:Dr.error,custom:Dr.custom,message:Dr.message,promise:Dr.promise,dismiss:Dr.dismiss,loading:Dr.loading},{getHistory:q$,getToasts:H$});function K$(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}K$(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function am(t){return t.label!==void 0}var G$=3,Q$="32px",Y$="16px",bb=4e3,J$=356,X$=14,Z$=20,e3=200;function Is(...t){return t.filter(Boolean).join(" ")}function t3(t){let[e,n]=t.split("-"),r=[];return e&&r.push(e),n&&r.push(n),r}var n3=t=>{var e,n,r,s,i,o,a,l,c,u,h;let{invert:f,toast:m,unstyled:E,interacting:p,setHeights:I,visibleToasts:g,heights:_,index:w,toasts:A,expanded:P,removeToast:L,defaultRichColors:x,closeButton:T,style:R,cancelButtonStyle:C,actionButtonStyle:D,className:O="",descriptionClassName:k="",duration:B,position:ce,gap:he,loadingIcon:Se,expandByDefault:$,classNames:q,icons:X,closeButtonAriaLabel:we="Close toast",pauseWhenPageIsHidden:Ie}=t,[re,ve]=F.useState(null),[j,Ge]=F.useState(null),[Fe,Pn]=F.useState(!1),[zn,En]=F.useState(!1),[In,Cn]=F.useState(!1),[kt,ft]=F.useState(!1),[at,cr]=F.useState(!1),[_r,Wn]=F.useState(0),[mt,Zt]=F.useState(0),wr=F.useRef(m.duration||B||bb),no=F.useRef(null),Pr=F.useRef(null),Ca=w===0,ws=w+1<=g,kn=m.type,cs=m.dismissible!==!1,ka=m.className||"",ro=m.descriptionClassName||"",en=F.useMemo(()=>_.findIndex(Q=>Q.toastId===m.id)||0,[_,m.id]),Na=F.useMemo(()=>{var Q;return(Q=m.closeButton)!=null?Q:T},[m.closeButton,T]),so=F.useMemo(()=>m.duration||B||bb,[m.duration,B]),Cr=F.useRef(0),us=F.useRef(0),Ii=F.useRef(0),tr=F.useRef(null),[K,z]=ce.split("-"),H=F.useMemo(()=>_.reduce((Q,oe,se)=>se>=en?Q:Q+oe.height,0),[_,en]),ie=j$(),Z=m.invert||f,te=kn==="loading";us.current=F.useMemo(()=>en*he+H,[en,H]),F.useEffect(()=>{wr.current=so},[so]),F.useEffect(()=>{Pn(!0)},[]),F.useEffect(()=>{let Q=Pr.current;if(Q){let oe=Q.getBoundingClientRect().height;return Zt(oe),I(se=>[{toastId:m.id,height:oe,position:m.position},...se]),()=>I(se=>se.filter(ae=>ae.toastId!==m.id))}},[I,m.id]),F.useLayoutEffect(()=>{if(!Fe)return;let Q=Pr.current,oe=Q.style.height;Q.style.height="auto";let se=Q.getBoundingClientRect().height;Q.style.height=oe,Zt(se),I(ae=>ae.find(ue=>ue.toastId===m.id)?ae.map(ue=>ue.toastId===m.id?{...ue,height:se}:ue):[{toastId:m.id,height:se,position:m.position},...ae])},[Fe,m.title,m.description,I,m.id]);let de=F.useCallback(()=>{En(!0),Wn(us.current),I(Q=>Q.filter(oe=>oe.toastId!==m.id)),setTimeout(()=>{L(m)},e3)},[m,L,I,us]);F.useEffect(()=>{if(m.promise&&kn==="loading"||m.duration===1/0||m.type==="loading")return;let Q;return P||p||Ie&&ie?(()=>{if(Ii.current<Cr.current){let oe=new Date().getTime()-Cr.current;wr.current=wr.current-oe}Ii.current=new Date().getTime()})():wr.current!==1/0&&(Cr.current=new Date().getTime(),Q=setTimeout(()=>{var oe;(oe=m.onAutoClose)==null||oe.call(m,m),de()},wr.current)),()=>clearTimeout(Q)},[P,p,m,kn,Ie,ie,de]),F.useEffect(()=>{m.delete&&de()},[de,m.delete]);function ye(){var Q,oe,se;return X!=null&&X.loading?F.createElement("div",{className:Is(q==null?void 0:q.loader,(Q=m==null?void 0:m.classNames)==null?void 0:Q.loader,"sonner-loader"),"data-visible":kn==="loading"},X.loading):Se?F.createElement("div",{className:Is(q==null?void 0:q.loader,(oe=m==null?void 0:m.classNames)==null?void 0:oe.loader,"sonner-loader"),"data-visible":kn==="loading"},Se):F.createElement(O$,{className:Is(q==null?void 0:q.loader,(se=m==null?void 0:m.classNames)==null?void 0:se.loader),visible:kn==="loading"})}return F.createElement("li",{tabIndex:0,ref:Pr,className:Is(O,ka,q==null?void 0:q.toast,(e=m==null?void 0:m.classNames)==null?void 0:e.toast,q==null?void 0:q.default,q==null?void 0:q[kn],(n=m==null?void 0:m.classNames)==null?void 0:n[kn]),"data-sonner-toast":"","data-rich-colors":(r=m.richColors)!=null?r:x,"data-styled":!(m.jsx||m.unstyled||E),"data-mounted":Fe,"data-promise":!!m.promise,"data-swiped":at,"data-removed":zn,"data-visible":ws,"data-y-position":K,"data-x-position":z,"data-index":w,"data-front":Ca,"data-swiping":In,"data-dismissible":cs,"data-type":kn,"data-invert":Z,"data-swipe-out":kt,"data-swipe-direction":j,"data-expanded":!!(P||$&&Fe),style:{"--index":w,"--toasts-before":w,"--z-index":A.length-w,"--offset":`${zn?_r:us.current}px`,"--initial-height":$?"auto":`${mt}px`,...R,...m.style},onDragEnd:()=>{Cn(!1),ve(null),tr.current=null},onPointerDown:Q=>{te||!cs||(no.current=new Date,Wn(us.current),Q.target.setPointerCapture(Q.pointerId),Q.target.tagName!=="BUTTON"&&(Cn(!0),tr.current={x:Q.clientX,y:Q.clientY}))},onPointerUp:()=>{var Q,oe,se,ae;if(kt||!cs)return;tr.current=null;let ue=Number(((Q=Pr.current)==null?void 0:Q.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),_e=Number(((oe=Pr.current)==null?void 0:oe.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),me=new Date().getTime()-((se=no.current)==null?void 0:se.getTime()),Me=re==="x"?ue:_e,ze=Math.abs(Me)/me;if(Math.abs(Me)>=Z$||ze>.11){Wn(us.current),(ae=m.onDismiss)==null||ae.call(m,m),Ge(re==="x"?ue>0?"right":"left":_e>0?"down":"up"),de(),ft(!0),cr(!1);return}Cn(!1),ve(null)},onPointerMove:Q=>{var oe,se,ae,ue;if(!tr.current||!cs||((oe=window.getSelection())==null?void 0:oe.toString().length)>0)return;let _e=Q.clientY-tr.current.y,me=Q.clientX-tr.current.x,Me=(se=t.swipeDirections)!=null?se:t3(ce);!re&&(Math.abs(me)>1||Math.abs(_e)>1)&&ve(Math.abs(me)>Math.abs(_e)?"x":"y");let ze={x:0,y:0};re==="y"?(Me.includes("top")||Me.includes("bottom"))&&(Me.includes("top")&&_e<0||Me.includes("bottom")&&_e>0)&&(ze.y=_e):re==="x"&&(Me.includes("left")||Me.includes("right"))&&(Me.includes("left")&&me<0||Me.includes("right")&&me>0)&&(ze.x=me),(Math.abs(ze.x)>0||Math.abs(ze.y)>0)&&cr(!0),(ae=Pr.current)==null||ae.style.setProperty("--swipe-amount-x",`${ze.x}px`),(ue=Pr.current)==null||ue.style.setProperty("--swipe-amount-y",`${ze.y}px`)}},Na&&!m.jsx?F.createElement("button",{"aria-label":we,"data-disabled":te,"data-close-button":!0,onClick:te||!cs?()=>{}:()=>{var Q;de(),(Q=m.onDismiss)==null||Q.call(m,m)},className:Is(q==null?void 0:q.closeButton,(s=m==null?void 0:m.classNames)==null?void 0:s.closeButton)},(i=X==null?void 0:X.close)!=null?i:U$):null,m.jsx||S.isValidElement(m.title)?m.jsx?m.jsx:typeof m.title=="function"?m.title():m.title:F.createElement(F.Fragment,null,kn||m.icon||m.promise?F.createElement("div",{"data-icon":"",className:Is(q==null?void 0:q.icon,(o=m==null?void 0:m.classNames)==null?void 0:o.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||ye():null,m.type!=="loading"?m.icon||(X==null?void 0:X[kn])||N$(kn):null):null,F.createElement("div",{"data-content":"",className:Is(q==null?void 0:q.content,(a=m==null?void 0:m.classNames)==null?void 0:a.content)},F.createElement("div",{"data-title":"",className:Is(q==null?void 0:q.title,(l=m==null?void 0:m.classNames)==null?void 0:l.title)},typeof m.title=="function"?m.title():m.title),m.description?F.createElement("div",{"data-description":"",className:Is(k,ro,q==null?void 0:q.description,(c=m==null?void 0:m.classNames)==null?void 0:c.description)},typeof m.description=="function"?m.description():m.description):null),S.isValidElement(m.cancel)?m.cancel:m.cancel&&am(m.cancel)?F.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||C,onClick:Q=>{var oe,se;am(m.cancel)&&cs&&((se=(oe=m.cancel).onClick)==null||se.call(oe,Q),de())},className:Is(q==null?void 0:q.cancelButton,(u=m==null?void 0:m.classNames)==null?void 0:u.cancelButton)},m.cancel.label):null,S.isValidElement(m.action)?m.action:m.action&&am(m.action)?F.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||D,onClick:Q=>{var oe,se;am(m.action)&&((se=(oe=m.action).onClick)==null||se.call(oe,Q),!Q.defaultPrevented&&de())},className:Is(q==null?void 0:q.actionButton,(h=m==null?void 0:m.classNames)==null?void 0:h.actionButton)},m.action.label):null))};function Ab(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function r3(t,e){let n={};return[t,e].forEach((r,s)=>{let i=s===1,o=i?"--mobile-offset":"--offset",a=i?Y$:Q$;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${o}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${o}-${c}`]=a:n[`${o}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(a)}),n}var s3=S.forwardRef(function(t,e){let{invert:n,position:r="bottom-right",hotkey:s=["altKey","KeyT"],expand:i,closeButton:o,className:a,offset:l,mobileOffset:c,theme:u="light",richColors:h,duration:f,style:m,visibleToasts:E=G$,toastOptions:p,dir:I=Ab(),gap:g=X$,loadingIcon:_,icons:w,containerAriaLabel:A="Notifications",pauseWhenPageIsHidden:P}=t,[L,x]=F.useState([]),T=F.useMemo(()=>Array.from(new Set([r].concat(L.filter(Ie=>Ie.position).map(Ie=>Ie.position)))),[L,r]),[R,C]=F.useState([]),[D,O]=F.useState(!1),[k,B]=F.useState(!1),[ce,he]=F.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Se=F.useRef(null),$=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),q=F.useRef(null),X=F.useRef(!1),we=F.useCallback(Ie=>{x(re=>{var ve;return(ve=re.find(j=>j.id===Ie.id))!=null&&ve.delete||Dr.dismiss(Ie.id),re.filter(({id:j})=>j!==Ie.id)})},[]);return F.useEffect(()=>Dr.subscribe(Ie=>{if(Ie.dismiss){x(re=>re.map(ve=>ve.id===Ie.id?{...ve,delete:!0}:ve));return}setTimeout(()=>{FC.flushSync(()=>{x(re=>{let ve=re.findIndex(j=>j.id===Ie.id);return ve!==-1?[...re.slice(0,ve),{...re[ve],...Ie},...re.slice(ve+1)]:[Ie,...re]})})})}),[]),F.useEffect(()=>{if(u!=="system"){he(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?he("dark"):he("light")),typeof window>"u")return;let Ie=window.matchMedia("(prefers-color-scheme: dark)");try{Ie.addEventListener("change",({matches:re})=>{he(re?"dark":"light")})}catch{Ie.addListener(({matches:ve})=>{try{he(ve?"dark":"light")}catch(j){console.error(j)}})}},[u]),F.useEffect(()=>{L.length<=1&&O(!1)},[L]),F.useEffect(()=>{let Ie=re=>{var ve,j;s.every(Ge=>re[Ge]||re.code===Ge)&&(O(!0),(ve=Se.current)==null||ve.focus()),re.code==="Escape"&&(document.activeElement===Se.current||(j=Se.current)!=null&&j.contains(document.activeElement))&&O(!1)};return document.addEventListener("keydown",Ie),()=>document.removeEventListener("keydown",Ie)},[s]),F.useEffect(()=>{if(Se.current)return()=>{q.current&&(q.current.focus({preventScroll:!0}),q.current=null,X.current=!1)}},[Se.current]),F.createElement("section",{ref:e,"aria-label":`${A} ${$}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},T.map((Ie,re)=>{var ve;let[j,Ge]=Ie.split("-");return L.length?F.createElement("ol",{key:Ie,dir:I==="auto"?Ab():I,tabIndex:-1,ref:Se,className:a,"data-sonner-toaster":!0,"data-theme":ce,"data-y-position":j,"data-lifted":D&&L.length>1&&!i,"data-x-position":Ge,style:{"--front-toast-height":`${((ve=R[0])==null?void 0:ve.height)||0}px`,"--width":`${J$}px`,"--gap":`${g}px`,...m,...r3(l,c)},onBlur:Fe=>{X.current&&!Fe.currentTarget.contains(Fe.relatedTarget)&&(X.current=!1,q.current&&(q.current.focus({preventScroll:!0}),q.current=null))},onFocus:Fe=>{Fe.target instanceof HTMLElement&&Fe.target.dataset.dismissible==="false"||X.current||(X.current=!0,q.current=Fe.relatedTarget)},onMouseEnter:()=>O(!0),onMouseMove:()=>O(!0),onMouseLeave:()=>{k||O(!1)},onDragEnd:()=>O(!1),onPointerDown:Fe=>{Fe.target instanceof HTMLElement&&Fe.target.dataset.dismissible==="false"||B(!0)},onPointerUp:()=>B(!1)},L.filter(Fe=>!Fe.position&&re===0||Fe.position===Ie).map((Fe,Pn)=>{var zn,En;return F.createElement(n3,{key:Fe.id,icons:w,index:Pn,toast:Fe,defaultRichColors:h,duration:(zn=p==null?void 0:p.duration)!=null?zn:f,className:p==null?void 0:p.className,descriptionClassName:p==null?void 0:p.descriptionClassName,invert:n,visibleToasts:E,closeButton:(En=p==null?void 0:p.closeButton)!=null?En:o,interacting:k,position:Ie,style:p==null?void 0:p.style,unstyled:p==null?void 0:p.unstyled,classNames:p==null?void 0:p.classNames,cancelButtonStyle:p==null?void 0:p.cancelButtonStyle,actionButtonStyle:p==null?void 0:p.actionButtonStyle,removeToast:we,toasts:L.filter(In=>In.position==Fe.position),heights:R.filter(In=>In.position==Fe.position),setHeights:C,expandByDefault:i,gap:g,loadingIcon:_,expanded:D,pauseWhenPageIsHidden:P,swipeDirections:t.swipeDirections})})):null}))});const i3=({...t})=>{const{theme:e="system"}=Ck();return v.jsx(s3,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var o3=y0[" useId ".trim().toString()]||(()=>{}),a3=0;function _v(t){const[e,n]=S.useState(o3());return zi(()=>{n(r=>r??String(a3++))},[t]),t||(e?`radix-${e}`:"")}const l3=["top","right","bottom","left"],aa=Math.min,Jr=Math.max,Lp=Math.round,lm=Math.floor,ci=t=>({x:t,y:t}),c3={left:"right",right:"left",bottom:"top",top:"bottom"},u3={start:"end",end:"start"};function iw(t,e,n){return Jr(t,aa(e,n))}function Wi(t,e){return typeof t=="function"?t(e):t}function qi(t){return t.split("-")[0]}function zu(t){return t.split("-")[1]}function wE(t){return t==="x"?"y":"x"}function EE(t){return t==="y"?"height":"width"}const d3=new Set(["top","bottom"]);function ni(t){return d3.has(qi(t))?"y":"x"}function IE(t){return wE(ni(t))}function h3(t,e,n){n===void 0&&(n=!1);const r=zu(t),s=IE(t),i=EE(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Mp(o)),[o,Mp(o)]}function f3(t){const e=Mp(t);return[ow(t),e,ow(e)]}function ow(t){return t.replace(/start|end/g,e=>u3[e])}const xb=["left","right"],Rb=["right","left"],m3=["top","bottom"],p3=["bottom","top"];function g3(t,e,n){switch(t){case"top":case"bottom":return n?e?Rb:xb:e?xb:Rb;case"left":case"right":return e?m3:p3;default:return[]}}function y3(t,e,n,r){const s=zu(t);let i=g3(qi(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(ow)))),i}function Mp(t){return t.replace(/left|right|bottom|top/g,e=>c3[e])}function v3(t){return{top:0,right:0,bottom:0,left:0,...t}}function kk(t){return typeof t!="number"?v3(t):{top:t,right:t,bottom:t,left:t}}function Vp(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function Pb(t,e,n){let{reference:r,floating:s}=t;const i=ni(e),o=IE(e),a=EE(o),l=qi(e),c=i==="y",u=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,f=r[a]/2-s[a]/2;let m;switch(l){case"top":m={x:u,y:r.y-s.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:h};break;case"left":m={x:r.x-s.width,y:h};break;default:m={x:r.x,y:r.y}}switch(zu(e)){case"start":m[o]-=f*(n&&c?-1:1);break;case"end":m[o]+=f*(n&&c?-1:1);break}return m}const _3=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:u,y:h}=Pb(c,r,l),f=r,m={},E=0;for(let p=0;p<a.length;p++){const{name:I,fn:g}=a[p],{x:_,y:w,data:A,reset:P}=await g({x:u,y:h,initialPlacement:r,placement:f,strategy:s,middlewareData:m,rects:c,platform:o,elements:{reference:t,floating:e}});u=_??u,h=w??h,m={...m,[I]:{...m[I],...A}},P&&E<=50&&(E++,typeof P=="object"&&(P.placement&&(f=P.placement),P.rects&&(c=P.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):P.rects),{x:u,y:h}=Pb(c,f,l)),p=-1)}return{x:u,y:h,placement:f,strategy:s,middlewareData:m}};async function Nh(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=Wi(e,t),E=kk(m),I=a[f?h==="floating"?"reference":"floating":h],g=Vp(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(I)))==null||n?I:I.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),_=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),A=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},P=Vp(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:_,offsetParent:w,strategy:l}):_);return{top:(g.top-P.top+E.top)/A.y,bottom:(P.bottom-g.bottom+E.bottom)/A.y,left:(g.left-P.left+E.left)/A.x,right:(P.right-g.right+E.right)/A.x}}const w3=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=Wi(t,e)||{};if(c==null)return{};const h=kk(u),f={x:n,y:r},m=IE(s),E=EE(m),p=await o.getDimensions(c),I=m==="y",g=I?"top":"left",_=I?"bottom":"right",w=I?"clientHeight":"clientWidth",A=i.reference[E]+i.reference[m]-f[m]-i.floating[E],P=f[m]-i.reference[m],L=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let x=L?L[w]:0;(!x||!await(o.isElement==null?void 0:o.isElement(L)))&&(x=a.floating[w]||i.floating[E]);const T=A/2-P/2,R=x/2-p[E]/2-1,C=aa(h[g],R),D=aa(h[_],R),O=C,k=x-p[E]-D,B=x/2-p[E]/2+T,ce=iw(O,B,k),he=!l.arrow&&zu(s)!=null&&B!==ce&&i.reference[E]/2-(B<O?C:D)-p[E]/2<0,Se=he?B<O?B-O:B-k:0;return{[m]:f[m]+Se,data:{[m]:ce,centerOffset:B-ce-Se,...he&&{alignmentOffset:Se}},reset:he}}}),E3=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:E="none",flipAlignment:p=!0,...I}=Wi(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const g=qi(s),_=ni(a),w=qi(a)===a,A=await(l.isRTL==null?void 0:l.isRTL(c.floating)),P=f||(w||!p?[Mp(a)]:f3(a)),L=E!=="none";!f&&L&&P.push(...y3(a,p,E,A));const x=[a,...P],T=await Nh(e,I),R=[];let C=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&R.push(T[g]),h){const B=h3(s,o,A);R.push(T[B[0]],T[B[1]])}if(C=[...C,{placement:s,overflows:R}],!R.every(B=>B<=0)){var D,O;const B=(((D=i.flip)==null?void 0:D.index)||0)+1,ce=x[B];if(ce&&(!(h==="alignment"?_!==ni(ce):!1)||C.every($=>ni($.placement)===_?$.overflows[0]>0:!0)))return{data:{index:B,overflows:C},reset:{placement:ce}};let he=(O=C.filter(Se=>Se.overflows[0]<=0).sort((Se,$)=>Se.overflows[1]-$.overflows[1])[0])==null?void 0:O.placement;if(!he)switch(m){case"bestFit":{var k;const Se=(k=C.filter($=>{if(L){const q=ni($.placement);return q===_||q==="y"}return!0}).map($=>[$.placement,$.overflows.filter(q=>q>0).reduce((q,X)=>q+X,0)]).sort(($,q)=>$[1]-q[1])[0])==null?void 0:k[0];Se&&(he=Se);break}case"initialPlacement":he=a;break}if(s!==he)return{reset:{placement:he}}}return{}}}};function Cb(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function kb(t){return l3.some(e=>t[e]>=0)}const I3=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=Wi(t,e);switch(r){case"referenceHidden":{const i=await Nh(e,{...s,elementContext:"reference"}),o=Cb(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:kb(o)}}}case"escaped":{const i=await Nh(e,{...s,altBoundary:!0}),o=Cb(i,n.floating);return{data:{escapedOffsets:o,escaped:kb(o)}}}default:return{}}}}},Nk=new Set(["left","top"]);async function T3(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=qi(n),a=zu(n),l=ni(n)==="y",c=Nk.has(o)?-1:1,u=i&&l?-1:1,h=Wi(e,t);let{mainAxis:f,crossAxis:m,alignmentAxis:E}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof E=="number"&&(m=a==="end"?E*-1:E),l?{x:m*u,y:f*c}:{x:f*c,y:m*u}}const S3=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await T3(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},b3=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:I=>{let{x:g,y:_}=I;return{x:g,y:_}}},...l}=Wi(t,e),c={x:n,y:r},u=await Nh(e,l),h=ni(qi(s)),f=wE(h);let m=c[f],E=c[h];if(i){const I=f==="y"?"top":"left",g=f==="y"?"bottom":"right",_=m+u[I],w=m-u[g];m=iw(_,m,w)}if(o){const I=h==="y"?"top":"left",g=h==="y"?"bottom":"right",_=E+u[I],w=E-u[g];E=iw(_,E,w)}const p=a.fn({...e,[f]:m,[h]:E});return{...p,data:{x:p.x-n,y:p.y-r,enabled:{[f]:i,[h]:o}}}}}},A3=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Wi(t,e),u={x:n,y:r},h=ni(s),f=wE(h);let m=u[f],E=u[h];const p=Wi(a,e),I=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(l){const w=f==="y"?"height":"width",A=i.reference[f]-i.floating[w]+I.mainAxis,P=i.reference[f]+i.reference[w]-I.mainAxis;m<A?m=A:m>P&&(m=P)}if(c){var g,_;const w=f==="y"?"width":"height",A=Nk.has(qi(s)),P=i.reference[h]-i.floating[w]+(A&&((g=o.offset)==null?void 0:g[h])||0)+(A?0:I.crossAxis),L=i.reference[h]+i.reference[w]+(A?0:((_=o.offset)==null?void 0:_[h])||0)-(A?I.crossAxis:0);E<P?E=P:E>L&&(E=L)}return{[f]:m,[h]:E}}}},x3=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=Wi(t,e),u=await Nh(e,c),h=qi(s),f=zu(s),m=ni(s)==="y",{width:E,height:p}=i.floating;let I,g;h==="top"||h==="bottom"?(I=h,g=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(g=h,I=f==="end"?"top":"bottom");const _=p-u.top-u.bottom,w=E-u.left-u.right,A=aa(p-u[I],_),P=aa(E-u[g],w),L=!e.middlewareData.shift;let x=A,T=P;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(T=w),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(x=_),L&&!f){const C=Jr(u.left,0),D=Jr(u.right,0),O=Jr(u.top,0),k=Jr(u.bottom,0);m?T=E-2*(C!==0||D!==0?C+D:Jr(u.left,u.right)):x=p-2*(O!==0||k!==0?O+k:Jr(u.top,u.bottom))}await l({...e,availableWidth:T,availableHeight:x});const R=await o.getDimensions(a.floating);return E!==R.width||p!==R.height?{reset:{rects:!0}}:{}}}};function Bg(){return typeof window<"u"}function Wu(t){return Dk(t)?(t.nodeName||"").toLowerCase():"#document"}function ns(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function _i(t){var e;return(e=(Dk(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Dk(t){return Bg()?t instanceof Node||t instanceof ns(t).Node:!1}function Ls(t){return Bg()?t instanceof Element||t instanceof ns(t).Element:!1}function gi(t){return Bg()?t instanceof HTMLElement||t instanceof ns(t).HTMLElement:!1}function Nb(t){return!Bg()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof ns(t).ShadowRoot}const R3=new Set(["inline","contents"]);function df(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=Ms(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!R3.has(s)}const P3=new Set(["table","td","th"]);function C3(t){return P3.has(Wu(t))}const k3=[":popover-open",":modal"];function zg(t){return k3.some(e=>{try{return t.matches(e)}catch{return!1}})}const N3=["transform","translate","scale","rotate","perspective"],D3=["transform","translate","scale","rotate","perspective","filter"],O3=["paint","layout","strict","content"];function TE(t){const e=SE(),n=Ls(t)?Ms(t):t;return N3.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||D3.some(r=>(n.willChange||"").includes(r))||O3.some(r=>(n.contain||"").includes(r))}function L3(t){let e=la(t);for(;gi(e)&&!uu(e);){if(TE(e))return e;if(zg(e))return null;e=la(e)}return null}function SE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const M3=new Set(["html","body","#document"]);function uu(t){return M3.has(Wu(t))}function Ms(t){return ns(t).getComputedStyle(t)}function Wg(t){return Ls(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function la(t){if(Wu(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Nb(t)&&t.host||_i(t);return Nb(e)?e.host:e}function Ok(t){const e=la(t);return uu(e)?t.ownerDocument?t.ownerDocument.body:t.body:gi(e)&&df(e)?e:Ok(e)}function Dh(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=Ok(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=ns(s);if(i){const a=aw(o);return e.concat(o,o.visualViewport||[],df(s)?s:[],a&&n?Dh(a):[])}return e.concat(s,Dh(s,[],n))}function aw(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Lk(t){const e=Ms(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=gi(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,a=Lp(n)!==i||Lp(r)!==o;return a&&(n=i,r=o),{width:n,height:r,$:a}}function bE(t){return Ls(t)?t:t.contextElement}function Uc(t){const e=bE(t);if(!gi(e))return ci(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=Lk(e);let o=(i?Lp(n.width):n.width)/r,a=(i?Lp(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const V3=ci(0);function Mk(t){const e=ns(t);return!SE()||!e.visualViewport?V3:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function F3(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==ns(t)?!1:e}function El(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=bE(t);let o=ci(1);e&&(r?Ls(r)&&(o=Uc(r)):o=Uc(t));const a=F3(i,n,r)?Mk(i):ci(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,h=s.height/o.y;if(i){const f=ns(i),m=r&&Ls(r)?ns(r):r;let E=f,p=aw(E);for(;p&&r&&m!==E;){const I=Uc(p),g=p.getBoundingClientRect(),_=Ms(p),w=g.left+(p.clientLeft+parseFloat(_.paddingLeft))*I.x,A=g.top+(p.clientTop+parseFloat(_.paddingTop))*I.y;l*=I.x,c*=I.y,u*=I.x,h*=I.y,l+=w,c+=A,E=ns(p),p=aw(E)}}return Vp({width:u,height:h,x:l,y:c})}function qg(t,e){const n=Wg(t).scrollLeft;return e?e.left+n:El(_i(t)).left+n}function Vk(t,e){const n=t.getBoundingClientRect(),r=n.left+e.scrollLeft-qg(t,n),s=n.top+e.scrollTop;return{x:r,y:s}}function U3(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=_i(r),a=e?zg(e.floating):!1;if(r===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},c=ci(1);const u=ci(0),h=gi(r);if((h||!h&&!i)&&((Wu(r)!=="body"||df(o))&&(l=Wg(r)),gi(r))){const m=El(r);c=Uc(r),u.x=m.x+r.clientLeft,u.y=m.y+r.clientTop}const f=o&&!h&&!i?Vk(o,l):ci(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:n.y*c.y-l.scrollTop*c.y+u.y+f.y}}function j3(t){return Array.from(t.getClientRects())}function $3(t){const e=_i(t),n=Wg(t),r=t.ownerDocument.body,s=Jr(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Jr(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+qg(t);const a=-n.scrollTop;return Ms(r).direction==="rtl"&&(o+=Jr(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:a}}const Db=25;function B3(t,e){const n=ns(t),r=_i(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const u=SE();(!u||u&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}const c=qg(r);if(c<=0){const u=r.ownerDocument,h=u.body,f=getComputedStyle(h),m=u.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,E=Math.abs(r.clientWidth-h.clientWidth-m);E<=Db&&(i-=E)}else c<=Db&&(i+=c);return{width:i,height:o,x:a,y:l}}const z3=new Set(["absolute","fixed"]);function W3(t,e){const n=El(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=gi(t)?Uc(t):ci(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:o,height:a,x:l,y:c}}function Ob(t,e,n){let r;if(e==="viewport")r=B3(t,n);else if(e==="document")r=$3(_i(t));else if(Ls(e))r=W3(e,n);else{const s=Mk(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Vp(r)}function Fk(t,e){const n=la(t);return n===e||!Ls(n)||uu(n)?!1:Ms(n).position==="fixed"||Fk(n,e)}function q3(t,e){const n=e.get(t);if(n)return n;let r=Dh(t,[],!1).filter(a=>Ls(a)&&Wu(a)!=="body"),s=null;const i=Ms(t).position==="fixed";let o=i?la(t):t;for(;Ls(o)&&!uu(o);){const a=Ms(o),l=TE(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&z3.has(s.position)||df(o)&&!l&&Fk(t,o))?r=r.filter(u=>u!==o):s=a,o=la(o)}return e.set(t,r),r}function H3(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?zg(e)?[]:q3(e,this._c):[].concat(n),r],a=o[0],l=o.reduce((c,u)=>{const h=Ob(e,u,s);return c.top=Jr(h.top,c.top),c.right=aa(h.right,c.right),c.bottom=aa(h.bottom,c.bottom),c.left=Jr(h.left,c.left),c},Ob(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function K3(t){const{width:e,height:n}=Lk(t);return{width:e,height:n}}function G3(t,e,n){const r=gi(e),s=_i(e),i=n==="fixed",o=El(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=ci(0);function c(){l.x=qg(s)}if(r||!r&&!i)if((Wu(e)!=="body"||df(s))&&(a=Wg(e)),r){const m=El(e,!0,i,e);l.x=m.x+e.clientLeft,l.y=m.y+e.clientTop}else s&&c();i&&!r&&s&&c();const u=s&&!r&&!i?Vk(s,a):ci(0),h=o.left+a.scrollLeft-l.x-u.x,f=o.top+a.scrollTop-l.y-u.y;return{x:h,y:f,width:o.width,height:o.height}}function wv(t){return Ms(t).position==="static"}function Lb(t,e){if(!gi(t)||Ms(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return _i(t)===n&&(n=n.ownerDocument.body),n}function Uk(t,e){const n=ns(t);if(zg(t))return n;if(!gi(t)){let s=la(t);for(;s&&!uu(s);){if(Ls(s)&&!wv(s))return s;s=la(s)}return n}let r=Lb(t,e);for(;r&&C3(r)&&wv(r);)r=Lb(r,e);return r&&uu(r)&&wv(r)&&!TE(r)?n:r||L3(t)||n}const Q3=async function(t){const e=this.getOffsetParent||Uk,n=this.getDimensions,r=await n(t.floating);return{reference:G3(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Y3(t){return Ms(t).direction==="rtl"}const J3={convertOffsetParentRelativeRectToViewportRelativeRect:U3,getDocumentElement:_i,getClippingRect:H3,getOffsetParent:Uk,getElementRects:Q3,getClientRects:j3,getDimensions:K3,getScale:Uc,isElement:Ls,isRTL:Y3};function jk(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function X3(t,e){let n=null,r;const s=_i(t);function i(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=t.getBoundingClientRect(),{left:u,top:h,width:f,height:m}=c;if(a||e(),!f||!m)return;const E=lm(h),p=lm(s.clientWidth-(u+f)),I=lm(s.clientHeight-(h+m)),g=lm(u),w={rootMargin:-E+"px "+-p+"px "+-I+"px "+-g+"px",threshold:Jr(0,aa(1,l))||1};let A=!0;function P(L){const x=L[0].intersectionRatio;if(x!==l){if(!A)return o();x?o(!1,x):r=setTimeout(()=>{o(!1,1e-7)},1e3)}x===1&&!jk(c,t.getBoundingClientRect())&&o(),A=!1}try{n=new IntersectionObserver(P,{...w,root:s.ownerDocument})}catch{n=new IntersectionObserver(P,w)}n.observe(t)}return o(!0),i}function Z3(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=bE(t),u=s||i?[...c?Dh(c):[],...Dh(e)]:[];u.forEach(g=>{s&&g.addEventListener("scroll",n,{passive:!0}),i&&g.addEventListener("resize",n)});const h=c&&a?X3(c,n):null;let f=-1,m=null;o&&(m=new ResizeObserver(g=>{let[_]=g;_&&_.target===c&&m&&(m.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var w;(w=m)==null||w.observe(e)})),n()}),c&&!l&&m.observe(c),m.observe(e));let E,p=l?El(t):null;l&&I();function I(){const g=El(t);p&&!jk(p,g)&&n(),p=g,E=requestAnimationFrame(I)}return n(),()=>{var g;u.forEach(_=>{s&&_.removeEventListener("scroll",n),i&&_.removeEventListener("resize",n)}),h==null||h(),(g=m)==null||g.disconnect(),m=null,l&&cancelAnimationFrame(E)}}const eB=S3,tB=b3,nB=E3,rB=x3,sB=I3,Mb=w3,iB=A3,oB=(t,e,n)=>{const r=new Map,s={platform:J3,...n},i={...s.platform,_c:r};return _3(t,e,{...s,platform:i})};var aB=typeof document<"u",lB=function(){},zm=aB?S.useLayoutEffect:lB;function Fp(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Fp(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!Fp(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function $k(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Vb(t,e){const n=$k(t);return Math.round(e*n)/n}function Ev(t){const e=S.useRef(t);return zm(()=>{e.current=t}),e}function cB(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=S.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,m]=S.useState(r);Fp(f,r)||m(r);const[E,p]=S.useState(null),[I,g]=S.useState(null),_=S.useCallback($=>{$!==L.current&&(L.current=$,p($))},[]),w=S.useCallback($=>{$!==x.current&&(x.current=$,g($))},[]),A=i||E,P=o||I,L=S.useRef(null),x=S.useRef(null),T=S.useRef(u),R=l!=null,C=Ev(l),D=Ev(s),O=Ev(c),k=S.useCallback(()=>{if(!L.current||!x.current)return;const $={placement:e,strategy:n,middleware:f};D.current&&($.platform=D.current),oB(L.current,x.current,$).then(q=>{const X={...q,isPositioned:O.current!==!1};B.current&&!Fp(T.current,X)&&(T.current=X,cf.flushSync(()=>{h(X)}))})},[f,e,n,D,O]);zm(()=>{c===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,h($=>({...$,isPositioned:!1})))},[c]);const B=S.useRef(!1);zm(()=>(B.current=!0,()=>{B.current=!1}),[]),zm(()=>{if(A&&(L.current=A),P&&(x.current=P),A&&P){if(C.current)return C.current(A,P,k);k()}},[A,P,k,C,R]);const ce=S.useMemo(()=>({reference:L,floating:x,setReference:_,setFloating:w}),[_,w]),he=S.useMemo(()=>({reference:A,floating:P}),[A,P]),Se=S.useMemo(()=>{const $={position:n,left:0,top:0};if(!he.floating)return $;const q=Vb(he.floating,u.x),X=Vb(he.floating,u.y);return a?{...$,transform:"translate("+q+"px, "+X+"px)",...$k(he.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:q,top:X}},[n,a,he.floating,u.x,u.y]);return S.useMemo(()=>({...u,update:k,refs:ce,elements:he,floatingStyles:Se}),[u,k,ce,he,Se])}const uB=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?Mb({element:r.current,padding:s}).fn(n):{}:r?Mb({element:r,padding:s}).fn(n):{}}}},dB=(t,e)=>({...eB(t),options:[t,e]}),hB=(t,e)=>({...tB(t),options:[t,e]}),fB=(t,e)=>({...iB(t),options:[t,e]}),mB=(t,e)=>({...nB(t),options:[t,e]}),pB=(t,e)=>({...rB(t),options:[t,e]}),gB=(t,e)=>({...sB(t),options:[t,e]}),yB=(t,e)=>({...uB(t),options:[t,e]});var vB="Arrow",Bk=S.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return v.jsx(Jt.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:v.jsx("polygon",{points:"0,0 30,0 15,10"})})});Bk.displayName=vB;var _B=Bk;function zk(t){const[e,n]=S.useState(void 0);return zi(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var AE="Popper",[Wk,qk]=$u(AE),[wB,Hk]=Wk(AE),Kk=t=>{const{__scopePopper:e,children:n}=t,[r,s]=S.useState(null);return v.jsx(wB,{scope:e,anchor:r,onAnchorChange:s,children:n})};Kk.displayName=AE;var Gk="PopperAnchor",Qk=S.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=Hk(Gk,n),o=S.useRef(null),a=lr(e,o),l=S.useRef(null);return S.useEffect(()=>{const c=l.current;l.current=(r==null?void 0:r.current)||o.current,c!==l.current&&i.onAnchorChange(l.current)}),r?null:v.jsx(Jt.div,{...s,ref:a})});Qk.displayName=Gk;var xE="PopperContent",[EB,IB]=Wk(xE),Yk=S.forwardRef((t,e)=>{var Fe,Pn,zn,En,In,Cn;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:E,...p}=t,I=Hk(xE,n),[g,_]=S.useState(null),w=lr(e,kt=>_(kt)),[A,P]=S.useState(null),L=zk(A),x=(L==null?void 0:L.width)??0,T=(L==null?void 0:L.height)??0,R=r+(i!=="center"?"-"+i:""),C=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},D=Array.isArray(c)?c:[c],O=D.length>0,k={padding:C,boundary:D.filter(SB),altBoundary:O},{refs:B,floatingStyles:ce,placement:he,isPositioned:Se,middlewareData:$}=cB({strategy:"fixed",placement:R,whileElementsMounted:(...kt)=>Z3(...kt,{animationFrame:m==="always"}),elements:{reference:I.anchor},middleware:[dB({mainAxis:s+T,alignmentAxis:o}),l&&hB({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?fB():void 0,...k}),l&&mB({...k}),pB({...k,apply:({elements:kt,rects:ft,availableWidth:at,availableHeight:cr})=>{const{width:_r,height:Wn}=ft.reference,mt=kt.floating.style;mt.setProperty("--radix-popper-available-width",`${at}px`),mt.setProperty("--radix-popper-available-height",`${cr}px`),mt.setProperty("--radix-popper-anchor-width",`${_r}px`),mt.setProperty("--radix-popper-anchor-height",`${Wn}px`)}}),A&&yB({element:A,padding:a}),bB({arrowWidth:x,arrowHeight:T}),f&&gB({strategy:"referenceHidden",...k})]}),[q,X]=Zk(he),we=pi(E);zi(()=>{Se&&(we==null||we())},[Se,we]);const Ie=(Fe=$.arrow)==null?void 0:Fe.x,re=(Pn=$.arrow)==null?void 0:Pn.y,ve=((zn=$.arrow)==null?void 0:zn.centerOffset)!==0,[j,Ge]=S.useState();return zi(()=>{g&&Ge(window.getComputedStyle(g).zIndex)},[g]),v.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:{...ce,transform:Se?ce.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:j,"--radix-popper-transform-origin":[(En=$.transformOrigin)==null?void 0:En.x,(In=$.transformOrigin)==null?void 0:In.y].join(" "),...((Cn=$.hide)==null?void 0:Cn.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:v.jsx(EB,{scope:n,placedSide:q,onArrowChange:P,arrowX:Ie,arrowY:re,shouldHideArrow:ve,children:v.jsx(Jt.div,{"data-side":q,"data-align":X,...p,ref:w,style:{...p.style,animation:Se?void 0:"none"}})})})});Yk.displayName=xE;var Jk="PopperArrow",TB={top:"bottom",right:"left",bottom:"top",left:"right"},Xk=S.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=IB(Jk,r),o=TB[i.placedSide];return v.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:v.jsx(_B,{...s,ref:n,style:{...s.style,display:"block"}})})});Xk.displayName=Jk;function SB(t){return t!==null}var bB=t=>({name:"transformOrigin",options:t,fn(e){var I,g,_;const{placement:n,rects:r,middlewareData:s}=e,o=((I=s.arrow)==null?void 0:I.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=Zk(n),h={start:"0%",center:"50%",end:"100%"}[u],f=(((g=s.arrow)==null?void 0:g.x)??0)+a/2,m=(((_=s.arrow)==null?void 0:_.y)??0)+l/2;let E="",p="";return c==="bottom"?(E=o?h:`${f}px`,p=`${-l}px`):c==="top"?(E=o?h:`${f}px`,p=`${r.floating.height+l}px`):c==="right"?(E=`${-l}px`,p=o?h:`${m}px`):c==="left"&&(E=`${r.floating.width+l}px`,p=o?h:`${m}px`),{data:{x:E,y:p}}}});function Zk(t){const[e,n="center"]=t.split("-");return[e,n]}var YX=Kk,AB=Qk,xB=Yk,RB=Xk,[Hg]=$u("Tooltip",[qk]),RE=qk(),eN="TooltipProvider",PB=700,Fb="tooltip.open",[CB,tN]=Hg(eN),nN=t=>{const{__scopeTooltip:e,delayDuration:n=PB,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=t,o=S.useRef(!0),a=S.useRef(!1),l=S.useRef(0);return S.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),v.jsx(CB,{scope:e,isOpenDelayedRef:o,delayDuration:n,onOpen:S.useCallback(()=>{window.clearTimeout(l.current),o.current=!1},[]),onClose:S.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.current=!0,r)},[r]),isPointerInTransitRef:a,onPointerInTransitChange:S.useCallback(c=>{a.current=c},[]),disableHoverableContent:s,children:i})};nN.displayName=eN;var rN="Tooltip",[JX,Kg]=Hg(rN),lw="TooltipTrigger",kB=S.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=Kg(lw,n),i=tN(lw,n),o=RE(n),a=S.useRef(null),l=lr(e,a,s.onTriggerChange),c=S.useRef(!1),u=S.useRef(!1),h=S.useCallback(()=>c.current=!1,[]);return S.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),v.jsx(AB,{asChild:!0,...o,children:v.jsx(Jt.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:Lt(t.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Lt(t.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Lt(t.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Lt(t.onFocus,()=>{c.current||s.onOpen()}),onBlur:Lt(t.onBlur,s.onClose),onClick:Lt(t.onClick,s.onClose)})})});kB.displayName=lw;var NB="TooltipPortal",[XX,DB]=Hg(NB,{forceMount:void 0}),du="TooltipContent",sN=S.forwardRef((t,e)=>{const n=DB(du,t.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=t,o=Kg(du,t.__scopeTooltip);return v.jsx(Fl,{present:r||o.open,children:o.disableHoverableContent?v.jsx(iN,{side:s,...i,ref:e}):v.jsx(OB,{side:s,...i,ref:e})})}),OB=S.forwardRef((t,e)=>{const n=Kg(du,t.__scopeTooltip),r=tN(du,t.__scopeTooltip),s=S.useRef(null),i=lr(e,s),[o,a]=S.useState(null),{trigger:l,onClose:c}=n,u=s.current,{onPointerInTransitChange:h}=r,f=S.useCallback(()=>{a(null),h(!1)},[h]),m=S.useCallback((E,p)=>{const I=E.currentTarget,g={x:E.clientX,y:E.clientY},_=UB(g,I.getBoundingClientRect()),w=jB(g,_),A=$B(p.getBoundingClientRect()),P=zB([...w,...A]);a(P),h(!0)},[h]);return S.useEffect(()=>()=>f(),[f]),S.useEffect(()=>{if(l&&u){const E=I=>m(I,u),p=I=>m(I,l);return l.addEventListener("pointerleave",E),u.addEventListener("pointerleave",p),()=>{l.removeEventListener("pointerleave",E),u.removeEventListener("pointerleave",p)}}},[l,u,m,f]),S.useEffect(()=>{if(o){const E=p=>{const I=p.target,g={x:p.clientX,y:p.clientY},_=(l==null?void 0:l.contains(I))||(u==null?void 0:u.contains(I)),w=!BB(g,o);_?f():w&&(f(),c())};return document.addEventListener("pointermove",E),()=>document.removeEventListener("pointermove",E)}},[l,u,o,c,f]),v.jsx(iN,{...t,ref:i})}),[LB,MB]=Hg(rN,{isInside:!1}),VB=a4("TooltipContent"),iN=S.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=Kg(du,n),c=RE(n),{onClose:u}=l;return S.useEffect(()=>(document.addEventListener(Fb,u),()=>document.removeEventListener(Fb,u)),[u]),S.useEffect(()=>{if(l.trigger){const h=f=>{const m=f.target;m!=null&&m.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),v.jsx(Ug,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:v.jsxs(xB,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[v.jsx(VB,{children:r}),v.jsx(LB,{scope:n,isInside:!0,children:v.jsx(k4,{id:l.contentId,role:"tooltip",children:s||r})})]})})});sN.displayName=du;var oN="TooltipArrow",FB=S.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=RE(n);return MB(oN,n).isInside?null:v.jsx(RB,{...s,...r,ref:e})});FB.displayName=oN;function UB(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function jB(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function $B(t){const{top:e,right:n,bottom:r,left:s}=t;return[{x:s,y:e},{x:n,y:e},{x:n,y:r},{x:s,y:r}]}function BB(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,h=l.x,f=l.y;u>r!=f>r&&n<(h-c)*(r-u)/(f-u)+c&&(s=!s)}return s}function zB(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),WB(e)}function WB(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const s=t[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const s=t[r];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))n.pop();else break}n.push(s)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var qB=nN,aN=sN;const HB=qB,KB=S.forwardRef(({className:t,sideOffset:e=4,...n},r)=>v.jsx(aN,{ref:r,sideOffset:e,className:Yt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));KB.displayName=aN.displayName;var Gg=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},GB={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},ko,h0,sP,QB=(sP=class{constructor(){pt(this,ko,GB);pt(this,h0,!1)}setTimeoutProvider(t){qe(this,ko,t)}setTimeout(t,e){return Y(this,ko).setTimeout(t,e)}clearTimeout(t){Y(this,ko).clearTimeout(t)}setInterval(t,e){return Y(this,ko).setInterval(t,e)}clearInterval(t){Y(this,ko).clearInterval(t)}},ko=new WeakMap,h0=new WeakMap,sP),Up=new QB;function YB(t){setTimeout(t,0)}var Qg=typeof window>"u"||"Deno"in globalThis;function Sr(){}function JB(t,e){return typeof t=="function"?t(e):t}function XB(t){return typeof t=="number"&&t>=0&&t!==1/0}function ZB(t,e){return Math.max(t+(e||0)-Date.now(),0)}function cw(t,e){return typeof t=="function"?t(e):t}function e6(t,e){return typeof t=="function"?t(e):t}function Ub(t,e){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:a}=t;if(o){if(r){if(e.queryHash!==PE(o,e.options))return!1}else if(!Lh(e.queryKey,o))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||s&&s!==e.state.fetchStatus||i&&!i(e))}function jb(t,e){const{exact:n,status:r,predicate:s,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(Oh(e.options.mutationKey)!==Oh(i))return!1}else if(!Lh(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function PE(t,e){return((e==null?void 0:e.queryKeyHashFn)||Oh)(t)}function Oh(t){return JSON.stringify(t,(e,n)=>uw(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Lh(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Lh(t[n],e[n])):!1}var t6=Object.prototype.hasOwnProperty;function lN(t,e){if(t===e)return t;const n=$b(t)&&$b(e);if(!n&&!(uw(t)&&uw(e)))return e;const s=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),o=i.length,a=n?new Array(o):{};let l=0;for(let c=0;c<o;c++){const u=n?c:i[c],h=t[u],f=e[u];if(h===f){a[u]=h,(n?c<s:t6.call(t,u))&&l++;continue}if(h===null||f===null||typeof h!="object"||typeof f!="object"){a[u]=f;continue}const m=lN(h,f);a[u]=m,m===h&&l++}return s===o&&l===s?t:a}function ZX(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function $b(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function uw(t){if(!Bb(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Bb(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Bb(t){return Object.prototype.toString.call(t)==="[object Object]"}function n6(t){return new Promise(e=>{Up.setTimeout(e,t)})}function r6(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?lN(t,e):e}function s6(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function i6(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var CE=Symbol();function cN(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===CE?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function eZ(t,e){return typeof t=="function"?t(...e):!!t}var rl,No,Qc,iP,o6=(iP=class extends Gg{constructor(){super();pt(this,rl);pt(this,No);pt(this,Qc);qe(this,Qc,e=>{if(!Qg&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){Y(this,No)||this.setEventListener(Y(this,Qc))}onUnsubscribe(){var e;this.hasListeners()||((e=Y(this,No))==null||e.call(this),qe(this,No,void 0))}setEventListener(e){var n;qe(this,Qc,e),(n=Y(this,No))==null||n.call(this),qe(this,No,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){Y(this,rl)!==e&&(qe(this,rl,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof Y(this,rl)=="boolean"?Y(this,rl):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},rl=new WeakMap,No=new WeakMap,Qc=new WeakMap,iP),uN=new o6;function a6(){let t,e;const n=new Promise((s,i)=>{t=s,e=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),t(s)},n.reject=s=>{r({status:"rejected",reason:s}),e(s)},n}function l6(t){var n;let e;if((n=t.then(r=>(e=r,r),Sr))==null||n.catch(Sr),e!==void 0)return{data:e}}function dN(t){return t}function c6(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function u6(t,e,n){const r=()=>{var i;const s=(i=t.promise)==null?void 0:i.then(e).catch(o=>n(o)?Promise.reject(new Error("redacted")):Promise.reject(o));return s==null||s.catch(Sr),s};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:r()},...t.meta&&{meta:t.meta}}}function d6(t){return t.state.isPaused}function h6(t){return t.state.status==="success"}function f6(t){return!0}function m6(t,e={}){var l,c,u,h;const n=e.shouldDehydrateMutation??((l=t.getDefaultOptions().dehydrate)==null?void 0:l.shouldDehydrateMutation)??d6,r=t.getMutationCache().getAll().flatMap(f=>n(f)?[c6(f)]:[]),s=e.shouldDehydrateQuery??((c=t.getDefaultOptions().dehydrate)==null?void 0:c.shouldDehydrateQuery)??h6,i=e.shouldRedactErrors??((u=t.getDefaultOptions().dehydrate)==null?void 0:u.shouldRedactErrors)??f6,o=e.serializeData??((h=t.getDefaultOptions().dehydrate)==null?void 0:h.serializeData)??dN,a=t.getQueryCache().getAll().flatMap(f=>s(f)?[u6(f,o,i)]:[]);return{mutations:r,queries:a}}function p6(t,e,n){var l,c;if(typeof e!="object"||e===null)return;const r=t.getMutationCache(),s=t.getQueryCache(),i=((l=n==null?void 0:n.defaultOptions)==null?void 0:l.deserializeData)??((c=t.getDefaultOptions().hydrate)==null?void 0:c.deserializeData)??dN,o=e.mutations||[],a=e.queries||[];o.forEach(({state:u,...h})=>{var f,m;r.build(t,{...(f=t.getDefaultOptions().hydrate)==null?void 0:f.mutations,...(m=n==null?void 0:n.defaultOptions)==null?void 0:m.mutations,...h},u)}),a.forEach(({queryKey:u,state:h,queryHash:f,meta:m,promise:E,dehydratedAt:p})=>{var L,x;const I=E?l6(E):void 0,g=h.data===void 0?I==null?void 0:I.data:h.data,_=g===void 0?g:i(g);let w=s.get(f);const A=(w==null?void 0:w.state.status)==="pending",P=(w==null?void 0:w.state.fetchStatus)==="fetching";if(w){const T=I&&p!==void 0&&p>w.state.dataUpdatedAt;if(h.dataUpdatedAt>w.state.dataUpdatedAt||T){const{fetchStatus:R,...C}=h;w.setState({...C,data:_})}}else w=s.build(t,{...(L=t.getDefaultOptions().hydrate)==null?void 0:L.queries,...(x=n==null?void 0:n.defaultOptions)==null?void 0:x.queries,queryKey:u,queryHash:f,meta:m},{...h,data:_,fetchStatus:"idle",status:_!==void 0?"success":h.status});E&&!A&&!P&&(p===void 0||p>w.state.dataUpdatedAt)&&w.fetch(void 0,{initialPromise:Promise.resolve(E).then(i)}).catch(Sr)})}var g6=YB;function y6(){let t=[],e=0,n=a=>{a()},r=a=>{a()},s=g6;const i=a=>{e?t.push(a):s(()=>{n(a)})},o=()=>{const a=t;t=[],a.length&&s(()=>{r(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{s=a}}}var br=y6(),Yc,Do,Jc,oP,v6=(oP=class extends Gg{constructor(){super();pt(this,Yc,!0);pt(this,Do);pt(this,Jc);qe(this,Jc,e=>{if(!Qg&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){Y(this,Do)||this.setEventListener(Y(this,Jc))}onUnsubscribe(){var e;this.hasListeners()||((e=Y(this,Do))==null||e.call(this),qe(this,Do,void 0))}setEventListener(e){var n;qe(this,Jc,e),(n=Y(this,Do))==null||n.call(this),qe(this,Do,e(this.setOnline.bind(this)))}setOnline(e){Y(this,Yc)!==e&&(qe(this,Yc,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return Y(this,Yc)}},Yc=new WeakMap,Do=new WeakMap,Jc=new WeakMap,oP),jp=new v6;function _6(t){return Math.min(1e3*2**t,3e4)}function hN(t){return(t??"online")==="online"?jp.isOnline():!0}var dw=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function fN(t){let e=!1,n=0,r;const s=a6(),i=()=>s.status!=="pending",o=p=>{var I;if(!i()){const g=new dw(p);f(g),(I=t.onCancel)==null||I.call(t,g)}},a=()=>{e=!0},l=()=>{e=!1},c=()=>uN.isFocused()&&(t.networkMode==="always"||jp.isOnline())&&t.canRun(),u=()=>hN(t.networkMode)&&t.canRun(),h=p=>{i()||(r==null||r(),s.resolve(p))},f=p=>{i()||(r==null||r(),s.reject(p))},m=()=>new Promise(p=>{var I;r=g=>{(i()||c())&&p(g)},(I=t.onPause)==null||I.call(t)}).then(()=>{var p;r=void 0,i()||(p=t.onContinue)==null||p.call(t)}),E=()=>{if(i())return;let p;const I=n===0?t.initialPromise:void 0;try{p=I??t.fn()}catch(g){p=Promise.reject(g)}Promise.resolve(p).then(h).catch(g=>{var L;if(i())return;const _=t.retry??(Qg?0:3),w=t.retryDelay??_6,A=typeof w=="function"?w(n,g):w,P=_===!0||typeof _=="number"&&n<_||typeof _=="function"&&_(n,g);if(e||!P){f(g);return}n++,(L=t.onFail)==null||L.call(t,n,g),n6(A).then(()=>c()?void 0:m()).then(()=>{e?f(g):E()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?E():m().then(E),s)}}var sl,aP,mN=(aP=class{constructor(){pt(this,sl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),XB(this.gcTime)&&qe(this,sl,Up.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Qg?1/0:5*60*1e3))}clearGcTimeout(){Y(this,sl)&&(Up.clearTimeout(Y(this,sl)),qe(this,sl,void 0))}},sl=new WeakMap,aP),il,Xc,ds,ol,Kn,ef,al,Ss,Si,lP,w6=(lP=class extends mN{constructor(n){super();pt(this,Ss);pt(this,il);pt(this,Xc);pt(this,ds);pt(this,ol);pt(this,Kn);pt(this,ef);pt(this,al);qe(this,al,!1),qe(this,ef,n.defaultOptions),this.setOptions(n.options),this.observers=[],qe(this,ol,n.client),qe(this,ds,Y(this,ol).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,qe(this,il,Wb(this.options)),this.state=n.state??Y(this,il),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=Y(this,Kn))==null?void 0:n.promise}setOptions(n){if(this.options={...Y(this,ef),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Wb(this.options);r.data!==void 0&&(this.setState(zb(r.data,r.dataUpdatedAt)),qe(this,il,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Y(this,ds).remove(this)}setData(n,r){const s=r6(this.state.data,n,this.options);return ur(this,Ss,Si).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(n,r){ur(this,Ss,Si).call(this,{type:"setState",state:n,setStateOptions:r})}cancel(n){var s,i;const r=(s=Y(this,Kn))==null?void 0:s.promise;return(i=Y(this,Kn))==null||i.cancel(n),r?r.then(Sr).catch(Sr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Y(this,il))}isActive(){return this.observers.some(n=>e6(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===CE||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>cw(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!ZB(this.state.dataUpdatedAt,n)}onFocus(){var r;const n=this.observers.find(s=>s.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(r=Y(this,Kn))==null||r.continue()}onOnline(){var r;const n=this.observers.find(s=>s.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(r=Y(this,Kn))==null||r.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),Y(this,ds).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(r=>r!==n),this.observers.length||(Y(this,Kn)&&(Y(this,al)?Y(this,Kn).cancel({revert:!0}):Y(this,Kn).cancelRetry()),this.scheduleGc()),Y(this,ds).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ur(this,Ss,Si).call(this,{type:"invalidate"})}async fetch(n,r){var c,u,h,f,m,E,p,I,g,_,w,A;if(this.state.fetchStatus!=="idle"&&((c=Y(this,Kn))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Y(this,Kn))return Y(this,Kn).continueRetry(),Y(this,Kn).promise}if(n&&this.setOptions(n),!this.options.queryFn){const P=this.observers.find(L=>L.options.queryFn);P&&this.setOptions(P.options)}const s=new AbortController,i=P=>{Object.defineProperty(P,"signal",{enumerable:!0,get:()=>(qe(this,al,!0),s.signal)})},o=()=>{const P=cN(this.options,r),x=(()=>{const T={client:Y(this,ol),queryKey:this.queryKey,meta:this.meta};return i(T),T})();return qe(this,al,!1),this.options.persister?this.options.persister(P,x,this):P(x)},l=(()=>{const P={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Y(this,ol),state:this.state,fetchFn:o};return i(P),P})();(u=this.options.behavior)==null||u.onFetch(l,this),qe(this,Xc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=l.fetchOptions)==null?void 0:h.meta))&&ur(this,Ss,Si).call(this,{type:"fetch",meta:(f=l.fetchOptions)==null?void 0:f.meta}),qe(this,Kn,fN({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,onCancel:P=>{P instanceof dw&&P.revert&&this.setState({...Y(this,Xc),fetchStatus:"idle"}),s.abort()},onFail:(P,L)=>{ur(this,Ss,Si).call(this,{type:"failed",failureCount:P,error:L})},onPause:()=>{ur(this,Ss,Si).call(this,{type:"pause"})},onContinue:()=>{ur(this,Ss,Si).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const P=await Y(this,Kn).start();if(P===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(P),(E=(m=Y(this,ds).config).onSuccess)==null||E.call(m,P,this),(I=(p=Y(this,ds).config).onSettled)==null||I.call(p,P,this.state.error,this),P}catch(P){if(P instanceof dw){if(P.silent)return Y(this,Kn).promise;if(P.revert){if(this.state.data===void 0)throw P;return this.state.data}}throw ur(this,Ss,Si).call(this,{type:"error",error:P}),(_=(g=Y(this,ds).config).onError)==null||_.call(g,P,this),(A=(w=Y(this,ds).config).onSettled)==null||A.call(w,this.state.data,P,this),P}finally{this.scheduleGc()}}},il=new WeakMap,Xc=new WeakMap,ds=new WeakMap,ol=new WeakMap,Kn=new WeakMap,ef=new WeakMap,al=new WeakMap,Ss=new WeakSet,Si=function(n){const r=s=>{switch(n.type){case"failed":return{...s,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...E6(s.data,this.options),fetchMeta:n.meta??null};case"success":const i={...s,...zb(n.data,n.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return qe(this,Xc,n.manual?i:void 0),i;case"error":const o=n.error;return{...s,error:o,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...n.state}}};this.state=r(this.state),br.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),Y(this,ds).notify({query:this,type:"updated",action:n})})},lP);function E6(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:hN(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function zb(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Wb(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}function qb(t){return{onFetch:(e,n)=>{var u,h,f,m,E;const r=e.options,s=(f=(h=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((m=e.state.data)==null?void 0:m.pages)||[],o=((E=e.state.data)==null?void 0:E.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let p=!1;const I=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(e.signal.aborted?p=!0:e.signal.addEventListener("abort",()=>{p=!0}),e.signal)})},g=cN(e.options,e.fetchOptions),_=async(w,A,P)=>{if(p)return Promise.reject();if(A==null&&w.pages.length)return Promise.resolve(w);const x=(()=>{const D={client:e.client,queryKey:e.queryKey,pageParam:A,direction:P?"backward":"forward",meta:e.options.meta};return I(D),D})(),T=await g(x),{maxPages:R}=e.options,C=P?i6:s6;return{pages:C(w.pages,T,R),pageParams:C(w.pageParams,A,R)}};if(s&&i.length){const w=s==="backward",A=w?I6:Hb,P={pages:i,pageParams:o},L=A(r,P);a=await _(P,L,w)}else{const w=t??i.length;do{const A=l===0?o[0]??r.initialPageParam:Hb(r,a);if(l>0&&A==null)break;a=await _(a,A),l++}while(l<w)}return a};e.options.persister?e.fetchFn=()=>{var p,I;return(I=(p=e.options).persister)==null?void 0:I.call(p,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function Hb(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function I6(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var tf,Ys,Ir,ll,Js,vo,cP,T6=(cP=class extends mN{constructor(n){super();pt(this,Js);pt(this,tf);pt(this,Ys);pt(this,Ir);pt(this,ll);qe(this,tf,n.client),this.mutationId=n.mutationId,qe(this,Ir,n.mutationCache),qe(this,Ys,[]),this.state=n.state||S6(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){Y(this,Ys).includes(n)||(Y(this,Ys).push(n),this.clearGcTimeout(),Y(this,Ir).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){qe(this,Ys,Y(this,Ys).filter(r=>r!==n)),this.scheduleGc(),Y(this,Ir).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){Y(this,Ys).length||(this.state.status==="pending"?this.scheduleGc():Y(this,Ir).remove(this))}continue(){var n;return((n=Y(this,ll))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var a,l,c,u,h,f,m,E,p,I,g,_,w,A,P,L,x,T,R,C;const r=()=>{ur(this,Js,vo).call(this,{type:"continue"})},s={client:Y(this,tf),meta:this.options.meta,mutationKey:this.options.mutationKey};qe(this,ll,fN({fn:()=>this.options.mutationFn?this.options.mutationFn(n,s):Promise.reject(new Error("No mutationFn found")),onFail:(D,O)=>{ur(this,Js,vo).call(this,{type:"failed",failureCount:D,error:O})},onPause:()=>{ur(this,Js,vo).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Y(this,Ir).canRun(this)}));const i=this.state.status==="pending",o=!Y(this,ll).canStart();try{if(i)r();else{ur(this,Js,vo).call(this,{type:"pending",variables:n,isPaused:o}),await((l=(a=Y(this,Ir).config).onMutate)==null?void 0:l.call(a,n,this,s));const O=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,n,s));O!==this.state.context&&ur(this,Js,vo).call(this,{type:"pending",context:O,variables:n,isPaused:o})}const D=await Y(this,ll).start();return await((f=(h=Y(this,Ir).config).onSuccess)==null?void 0:f.call(h,D,n,this.state.context,this,s)),await((E=(m=this.options).onSuccess)==null?void 0:E.call(m,D,n,this.state.context,s)),await((I=(p=Y(this,Ir).config).onSettled)==null?void 0:I.call(p,D,null,this.state.variables,this.state.context,this,s)),await((_=(g=this.options).onSettled)==null?void 0:_.call(g,D,null,n,this.state.context,s)),ur(this,Js,vo).call(this,{type:"success",data:D}),D}catch(D){try{throw await((A=(w=Y(this,Ir).config).onError)==null?void 0:A.call(w,D,n,this.state.context,this,s)),await((L=(P=this.options).onError)==null?void 0:L.call(P,D,n,this.state.context,s)),await((T=(x=Y(this,Ir).config).onSettled)==null?void 0:T.call(x,void 0,D,this.state.variables,this.state.context,this,s)),await((C=(R=this.options).onSettled)==null?void 0:C.call(R,void 0,D,n,this.state.context,s)),D}finally{ur(this,Js,vo).call(this,{type:"error",error:D})}}finally{Y(this,Ir).runNext(this)}}},tf=new WeakMap,Ys=new WeakMap,Ir=new WeakMap,ll=new WeakMap,Js=new WeakSet,vo=function(n){const r=s=>{switch(n.type){case"failed":return{...s,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...s,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:n.error,failureCount:s.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=r(this.state),br.batch(()=>{Y(this,Ys).forEach(s=>{s.onMutationUpdate(n)}),Y(this,Ir).notify({mutation:this,type:"updated",action:n})})},cP);function S6(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var xi,bs,nf,uP,b6=(uP=class extends Gg{constructor(e={}){super();pt(this,xi);pt(this,bs);pt(this,nf);this.config=e,qe(this,xi,new Set),qe(this,bs,new Map),qe(this,nf,0)}build(e,n,r){const s=new T6({client:e,mutationCache:this,mutationId:++$f(this,nf)._,options:e.defaultMutationOptions(n),state:r});return this.add(s),s}add(e){Y(this,xi).add(e);const n=cm(e);if(typeof n=="string"){const r=Y(this,bs).get(n);r?r.push(e):Y(this,bs).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(Y(this,xi).delete(e)){const n=cm(e);if(typeof n=="string"){const r=Y(this,bs).get(n);if(r)if(r.length>1){const s=r.indexOf(e);s!==-1&&r.splice(s,1)}else r[0]===e&&Y(this,bs).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=cm(e);if(typeof n=="string"){const r=Y(this,bs).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===e}else return!0}runNext(e){var r;const n=cm(e);if(typeof n=="string"){const s=(r=Y(this,bs).get(n))==null?void 0:r.find(i=>i!==e&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){br.batch(()=>{Y(this,xi).forEach(e=>{this.notify({type:"removed",mutation:e})}),Y(this,xi).clear(),Y(this,bs).clear()})}getAll(){return Array.from(Y(this,xi))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>jb(n,r))}findAll(e={}){return this.getAll().filter(n=>jb(e,n))}notify(e){br.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return br.batch(()=>Promise.all(e.map(n=>n.continue().catch(Sr))))}},xi=new WeakMap,bs=new WeakMap,nf=new WeakMap,uP);function cm(t){var e;return(e=t.options.scope)==null?void 0:e.id}var Xs,dP,A6=(dP=class extends Gg{constructor(e={}){super();pt(this,Xs);this.config=e,qe(this,Xs,new Map)}build(e,n,r){const s=n.queryKey,i=n.queryHash??PE(s,n);let o=this.get(i);return o||(o=new w6({client:e,queryKey:s,queryHash:i,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(s)}),this.add(o)),o}add(e){Y(this,Xs).has(e.queryHash)||(Y(this,Xs).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=Y(this,Xs).get(e.queryHash);n&&(e.destroy(),n===e&&Y(this,Xs).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){br.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return Y(this,Xs).get(e)}getAll(){return[...Y(this,Xs).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Ub(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>Ub(e,r)):n}notify(e){br.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){br.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){br.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Xs=new WeakMap,dP),mn,Oo,Lo,Zc,eu,Mo,tu,nu,hP,x6=(hP=class{constructor(t={}){pt(this,mn);pt(this,Oo);pt(this,Lo);pt(this,Zc);pt(this,eu);pt(this,Mo);pt(this,tu);pt(this,nu);qe(this,mn,t.queryCache||new A6),qe(this,Oo,t.mutationCache||new b6),qe(this,Lo,t.defaultOptions||{}),qe(this,Zc,new Map),qe(this,eu,new Map),qe(this,Mo,0)}mount(){$f(this,Mo)._++,Y(this,Mo)===1&&(qe(this,tu,uN.subscribe(async t=>{t&&(await this.resumePausedMutations(),Y(this,mn).onFocus())})),qe(this,nu,jp.subscribe(async t=>{t&&(await this.resumePausedMutations(),Y(this,mn).onOnline())})))}unmount(){var t,e;$f(this,Mo)._--,Y(this,Mo)===0&&((t=Y(this,tu))==null||t.call(this),qe(this,tu,void 0),(e=Y(this,nu))==null||e.call(this),qe(this,nu,void 0))}isFetching(t){return Y(this,mn).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return Y(this,Oo).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=Y(this,mn).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=Y(this,mn).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(cw(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return Y(this,mn).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),s=Y(this,mn).get(r.queryHash),i=s==null?void 0:s.state.data,o=JB(e,i);if(o!==void 0)return Y(this,mn).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return br.batch(()=>Y(this,mn).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=Y(this,mn).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=Y(this,mn);br.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=Y(this,mn);return br.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=br.batch(()=>Y(this,mn).findAll(t).map(s=>s.cancel(n)));return Promise.all(r).then(Sr).catch(Sr)}invalidateQueries(t,e={}){return br.batch(()=>(Y(this,mn).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=br.batch(()=>Y(this,mn).findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Sr)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Sr)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=Y(this,mn).build(this,e);return n.isStaleByTime(cw(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Sr).catch(Sr)}fetchInfiniteQuery(t){return t.behavior=qb(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Sr).catch(Sr)}ensureInfiniteQueryData(t){return t.behavior=qb(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return jp.isOnline()?Y(this,Oo).resumePausedMutations():Promise.resolve()}getQueryCache(){return Y(this,mn)}getMutationCache(){return Y(this,Oo)}getDefaultOptions(){return Y(this,Lo)}setDefaultOptions(t){qe(this,Lo,t)}setQueryDefaults(t,e){Y(this,Zc).set(Oh(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...Y(this,Zc).values()],n={};return e.forEach(r=>{Lh(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){Y(this,eu).set(Oh(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...Y(this,eu).values()],n={};return e.forEach(r=>{Lh(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...Y(this,Lo).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=PE(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===CE&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...Y(this,Lo).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){Y(this,mn).clear(),Y(this,Oo).clear()}},mn=new WeakMap,Oo=new WeakMap,Lo=new WeakMap,Zc=new WeakMap,eu=new WeakMap,Mo=new WeakMap,tu=new WeakMap,nu=new WeakMap,hP),pN=S.createContext(void 0),rZ=t=>{const e=S.useContext(pN);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},R6=({client:t,children:e})=>(S.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),v.jsx(pN.Provider,{value:t,children:e})),P6=["added","removed","updated"];function Kb(t){return P6.includes(t)}async function C6({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:r="",hydrateOptions:s}){try{const i=await e.restoreClient();if(i)if(i.timestamp){const o=Date.now()-i.timestamp>n,a=i.buster!==r;if(o||a)return e.removeClient();p6(t,i.clientState,s)}else return e.removeClient()}catch(i){throw await e.removeClient(),i}}async function Gb({queryClient:t,persister:e,buster:n="",dehydrateOptions:r}){const s={buster:n,timestamp:Date.now(),clientState:m6(t,r)};await e.persistClient(s)}function k6(t){const e=t.queryClient.getQueryCache().subscribe(r=>{Kb(r.type)&&Gb(t)}),n=t.queryClient.getMutationCache().subscribe(r=>{Kb(r.type)&&Gb(t)});return()=>{e(),n()}}function N6(t){let e=!1,n;const r=()=>{e=!0,n==null||n()},s=C6(t).then(()=>{e||(n=k6(t))});return[r,s]}function Iv(){}function D6({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:r=JSON.stringify,deserialize:s=JSON.parse,retry:i}){if(t){const o=a=>{try{t.setItem(e,r(a));return}catch(l){return l}};return{persistClient:O6(a=>{let l=a,c=o(l),u=0;for(;c&&l;)u++,l=i==null?void 0:i({persistedClient:l,error:c,errorCount:u}),l&&(c=o(l))},n),restoreClient:()=>{const a=t.getItem(e);if(a)return s(a)},removeClient:()=>{t.removeItem(e)}}}return{persistClient:Iv,restoreClient:Iv,removeClient:Iv}}function O6(t,e=100){let n=null,r;return function(...s){r=s,n===null&&(n=Up.setTimeout(()=>{t(...r),n=null},e))}}/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mh(){return Mh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Mh.apply(this,arguments)}var Uo;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Uo||(Uo={}));const Qb="popstate";function L6(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return $p("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Vh(s)}return gN(e,n,null,t)}function M6(t){t===void 0&&(t={});function e(s,i){let{pathname:o="/",search:a="",hash:l=""}=Ul(s.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),$p("",{pathname:o,search:a,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let o=s.document.querySelector("base"),a="";if(o&&o.getAttribute("href")){let l=s.location.href,c=l.indexOf("#");a=c===-1?l:l.slice(0,c)}return a+"#"+(typeof i=="string"?i:Vh(i))}function r(s,i){kE(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return gN(e,n,r,t)}function vn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function kE(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function V6(){return Math.random().toString(36).substr(2,8)}function Yb(t,e){return{usr:t.state,key:t.key,idx:e}}function $p(t,e,n,r){return n===void 0&&(n=null),Mh({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ul(e):e,{state:n,key:e&&e.key||r||V6()})}function Vh(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ul(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function gN(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=Uo.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(Mh({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=Uo.Pop;let I=u(),g=I==null?null:I-c;c=I,l&&l({action:a,location:p.location,delta:g})}function f(I,g){a=Uo.Push;let _=$p(p.location,I,g);n&&n(_,I),c=u()+1;let w=Yb(_,c),A=p.createHref(_);try{o.pushState(w,"",A)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;s.location.assign(A)}i&&l&&l({action:a,location:p.location,delta:1})}function m(I,g){a=Uo.Replace;let _=$p(p.location,I,g);n&&n(_,I),c=u();let w=Yb(_,c),A=p.createHref(_);o.replaceState(w,"",A),i&&l&&l({action:a,location:p.location,delta:0})}function E(I){let g=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof I=="string"?I:Vh(I);return _=_.replace(/ $/,"%20"),vn(g,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,g)}let p={get action(){return a},get location(){return t(s,o)},listen(I){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Qb,h),l=I,()=>{s.removeEventListener(Qb,h),l=null}},createHref(I){return e(s,I)},createURL:E,encodeLocation(I){let g=E(I);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:m,go(I){return o.go(I)}};return p}var Jb;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Jb||(Jb={}));function F6(t,e,n){return n===void 0&&(n="/"),U6(t,e,n)}function U6(t,e,n,r){let s=typeof e=="string"?Ul(e):e,i=NE(s.pathname||"/",n);if(i==null)return null;let o=yN(t);j6(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=X6(i);a=Q6(o[l],c)}return a}function yN(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(vn(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Xo([r,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(vn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),yN(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:K6(c,i.index),routesMeta:u})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of vN(i.path))s(i,o,l)}),e}function vN(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=vN(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function j6(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:G6(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const $6=/^:[\w-]+$/,B6=3,z6=2,W6=1,q6=10,H6=-2,Xb=t=>t==="*";function K6(t,e){let n=t.split("/"),r=n.length;return n.some(Xb)&&(r+=H6),e&&(r+=z6),n.filter(s=>!Xb(s)).reduce((s,i)=>s+($6.test(i)?B6:i===""?W6:q6),r)}function G6(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function Q6(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=Y6({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Xo([i,h.pathname]),pathnameBase:n5(Xo([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Xo([i,h.pathnameBase]))}return o}function Y6(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=J6(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,u,h)=>{let{paramName:f,isOptional:m}=u;if(f==="*"){let p=a[h]||"";o=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}const E=a[h];return m&&!E?c[f]=void 0:c[f]=(E||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function J6(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),kE(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function X6(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return kE(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function NE(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Z6(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ul(t):t;return{pathname:n?n.startsWith("/")?n:e5(n,e):e,search:r5(r),hash:s5(s)}}function e5(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Tv(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function t5(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function DE(t,e){let n=t5(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function OE(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Ul(t):(s=Mh({},t),vn(!s.pathname||!s.pathname.includes("?"),Tv("?","pathname","search",s)),vn(!s.pathname||!s.pathname.includes("#"),Tv("#","pathname","hash",s)),vn(!s.search||!s.search.includes("#"),Tv("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}a=h>=0?e[h]:"/"}let l=Z6(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Xo=t=>t.join("/").replace(/\/\/+/g,"/"),n5=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),r5=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,s5=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function i5(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _N=["post","put","patch","delete"];new Set(_N);const o5=["get",..._N];new Set(o5);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fh(){return Fh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Fh.apply(this,arguments)}const LE=S.createContext(null),a5=S.createContext(null),wa=S.createContext(null),Yg=S.createContext(null),Ji=S.createContext({outlet:null,matches:[],isDataRoute:!1}),wN=S.createContext(null);function l5(t,e){let{relative:n}=e===void 0?{}:e;qu()||vn(!1);let{basename:r,navigator:s}=S.useContext(wa),{hash:i,pathname:o,search:a}=IN(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:Xo([r,o])),s.createHref({pathname:l,search:a,hash:i})}function qu(){return S.useContext(Yg)!=null}function wi(){return qu()||vn(!1),S.useContext(Yg).location}function EN(t){S.useContext(wa).static||S.useLayoutEffect(t)}function jl(){let{isDataRoute:t}=S.useContext(Ji);return t?E5():c5()}function c5(){qu()||vn(!1);let t=S.useContext(LE),{basename:e,future:n,navigator:r}=S.useContext(wa),{matches:s}=S.useContext(Ji),{pathname:i}=wi(),o=JSON.stringify(DE(s,n.v7_relativeSplatPath)),a=S.useRef(!1);return EN(()=>{a.current=!0}),S.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let h=OE(c,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Xo([e,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[e,r,o,i,t])}function sZ(){let{matches:t}=S.useContext(Ji),e=t[t.length-1];return e?e.params:{}}function IN(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=S.useContext(wa),{matches:s}=S.useContext(Ji),{pathname:i}=wi(),o=JSON.stringify(DE(s,r.v7_relativeSplatPath));return S.useMemo(()=>OE(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function u5(t,e){return d5(t,e)}function d5(t,e,n,r){qu()||vn(!1);let{navigator:s}=S.useContext(wa),{matches:i}=S.useContext(Ji),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=wi(),u;if(e){var h;let I=typeof e=="string"?Ul(e):e;l==="/"||(h=I.pathname)!=null&&h.startsWith(l)||vn(!1),u=I}else u=c;let f=u.pathname||"/",m=f;if(l!=="/"){let I=l.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(I.length).join("/")}let E=F6(t,{pathname:m}),p=g5(E&&E.map(I=>Object.assign({},I,{params:Object.assign({},a,I.params),pathname:Xo([l,s.encodeLocation?s.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?l:Xo([l,s.encodeLocation?s.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),i,n,r);return e&&p?S.createElement(Yg.Provider,{value:{location:Fh({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Uo.Pop}},p):p}function h5(){let t=w5(),e=i5(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),n?S.createElement("pre",{style:s},n):null,null)}const f5=S.createElement(h5,null);class m5 extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?S.createElement(Ji.Provider,{value:this.props.routeContext},S.createElement(wN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function p5(t){let{routeContext:e,match:n,children:r}=t,s=S.useContext(LE);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),S.createElement(Ji.Provider,{value:e},r)}function g5(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||vn(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:f,errors:m}=n,E=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||E){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,f)=>{let m,E=!1,p=null,I=null;n&&(m=a&&h.route.id?a[h.route.id]:void 0,p=h.route.errorElement||f5,l&&(c<0&&f===0?(I5("route-fallback"),E=!0,I=null):c===f&&(E=!0,I=h.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,f+1)),_=()=>{let w;return m?w=p:E?w=I:h.route.Component?w=S.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=u,S.createElement(p5,{match:h,routeContext:{outlet:u,matches:g,isDataRoute:n!=null},children:w})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?S.createElement(m5,{location:n.location,revalidation:n.revalidation,component:p,error:m,children:_(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):_()},null)}var TN=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(TN||{}),SN=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(SN||{});function y5(t){let e=S.useContext(LE);return e||vn(!1),e}function v5(t){let e=S.useContext(a5);return e||vn(!1),e}function _5(t){let e=S.useContext(Ji);return e||vn(!1),e}function bN(t){let e=_5(),n=e.matches[e.matches.length-1];return n.route.id||vn(!1),n.route.id}function w5(){var t;let e=S.useContext(wN),n=v5(),r=bN();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function E5(){let{router:t}=y5(TN.UseNavigateStable),e=bN(SN.UseNavigateStable),n=S.useRef(!1);return EN(()=>{n.current=!0}),S.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Fh({fromRouteId:e},i)))},[t,e])}const Zb={};function I5(t,e,n){Zb[t]||(Zb[t]=!0)}function AN(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function iZ(t){let{to:e,replace:n,state:r,relative:s}=t;qu()||vn(!1);let{future:i,static:o}=S.useContext(wa),{matches:a}=S.useContext(Ji),{pathname:l}=wi(),c=jl(),u=OE(e,DE(a,i.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(u);return S.useEffect(()=>c(JSON.parse(h),{replace:n,state:r,relative:s}),[c,h,s,n,r]),null}function Pe(t){vn(!1)}function xN(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Uo.Pop,navigator:i,static:o=!1,future:a}=t;qu()&&vn(!1);let l=e.replace(/^\/*/,"/"),c=S.useMemo(()=>({basename:l,navigator:i,static:o,future:Fh({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=Ul(r));let{pathname:u="/",search:h="",hash:f="",state:m=null,key:E="default"}=r,p=S.useMemo(()=>{let I=NE(u,l);return I==null?null:{location:{pathname:I,search:h,hash:f,state:m,key:E},navigationType:s}},[l,u,h,f,m,E,s]);return p==null?null:S.createElement(wa.Provider,{value:c},S.createElement(Yg.Provider,{children:n,value:p}))}function eA(t){let{children:e,location:n}=t;return u5(hw(e),n)}new Promise(()=>{});function hw(t,e){e===void 0&&(e=[]);let n=[];return S.Children.forEach(t,(r,s)=>{if(!S.isValidElement(r))return;let i=[...e,s];if(r.type===S.Fragment){n.push.apply(n,hw(r.props.children,i));return}r.type!==Pe&&vn(!1),!r.props.index||!r.props.children||vn(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=hw(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fw(){return fw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fw.apply(this,arguments)}function T5(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function S5(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function b5(t,e){return t.button===0&&(!e||e==="_self")&&!S5(t)}function mw(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function A5(t,e){let n=mw(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const x5=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],R5="6";try{window.__reactRouterVersion=R5}catch{}const P5="startTransition",Bp=y0[P5];function C5(t){let{basename:e,children:n,future:r,window:s}=t,i=S.useRef();i.current==null&&(i.current=L6({window:s,v5Compat:!0}));let o=i.current,[a,l]=S.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=S.useCallback(h=>{c&&Bp?Bp(()=>l(h)):l(h)},[l,c]);return S.useLayoutEffect(()=>o.listen(u),[o,u]),S.useEffect(()=>AN(r),[r]),S.createElement(xN,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}function k5(t){let{basename:e,children:n,future:r,window:s}=t,i=S.useRef();i.current==null&&(i.current=M6({window:s,v5Compat:!0}));let o=i.current,[a,l]=S.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=S.useCallback(h=>{c&&Bp?Bp(()=>l(h)):l(h)},[l,c]);return S.useLayoutEffect(()=>o.listen(u),[o,u]),S.useEffect(()=>AN(r),[r]),S.createElement(xN,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const N5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",D5=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pw=S.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,f=T5(e,x5),{basename:m}=S.useContext(wa),E,p=!1;if(typeof c=="string"&&D5.test(c)&&(E=c,N5))try{let w=new URL(window.location.href),A=c.startsWith("//")?new URL(w.protocol+c):new URL(c),P=NE(A.pathname,m);A.origin===w.origin&&P!=null?c=P+A.search+A.hash:p=!0}catch{}let I=l5(c,{relative:s}),g=O5(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:h});function _(w){r&&r(w),w.defaultPrevented||g(w)}return S.createElement("a",fw({},f,{href:E||I,onClick:p||i?r:_,ref:n,target:l}))});var tA;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(tA||(tA={}));var nA;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(nA||(nA={}));function O5(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=jl(),c=wi(),u=IN(t,{relative:o});return S.useCallback(h=>{if(b5(h,n)){h.preventDefault();let f=r!==void 0?r:Vh(c)===Vh(u);l(t,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,r,s,n,t,i,o,a])}function oZ(t){let e=S.useRef(mw(t)),n=S.useRef(!1),r=wi(),s=S.useMemo(()=>A5(r.search,n.current?null:e.current),[r.search]),i=jl(),o=S.useCallback((a,l)=>{const c=mw(typeof a=="function"?a(s):a);n.current=!0,i("?"+c,l)},[i,s]);return[s,o]}const RN=S.createContext(void 0),L5=({children:t})=>{const[e,n]=S.useState("medium"),[r,s]=S.useState(!1),[i,o]=S.useState(!1);S.useEffect(()=>{const l=()=>{const c=window.innerWidth<=768;s(c)};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),S.useEffect(()=>{try{const l=!!window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron")||typeof window<"u"&&window.location&&window.location.protocol==="file:";o(l)}catch{o(!1)}},[]),S.useEffect(()=>{const l=["appFontSize","desktopFontSize","mobileFontSize"];for(const c of l){const u=localStorage.getItem(c);if(u&&["small","medium","large"].includes(u)){n(u);break}}},[]),S.useEffect(()=>{const l=document.documentElement;l.classList.remove("font-size-small","font-size-medium","font-size-large"),l.classList.add(`font-size-${e}`)},[e]);const a=l=>{n(l),localStorage.setItem("appFontSize",l),i&&localStorage.setItem("desktopFontSize",l)};return v.jsx(RN.Provider,{value:{fontSize:e,setFontSize:a,isMobile:r,isDesktopApp:i},children:t})},aZ=()=>{const t=S.useContext(RN);if(t===void 0)throw new Error("useFontSize must be used within a FontSizeProvider");return t},M5=mE("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full text-sm font-medium ring-offset-background transition-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-none hover:bg-primary",destructive:"bg-destructive text-destructive-foreground shadow-none hover:bg-destructive",outline:"border border-input bg-background shadow-none hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-none hover:bg-secondary",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-12 px-6 py-2",sm:"h-10 rounded-full px-4",lg:"h-14 rounded-full px-8",icon:"h-12 w-12"}},defaultVariants:{variant:"default",size:"default"}}),Vn=S.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const o=r?i4:"button";return v.jsx(o,{className:Yt(M5({variant:e,size:n,className:t})),ref:i,...s})});Vn.displayName="Button";const ri=S.forwardRef(({className:t,type:e,...n},r)=>{const s={...n};return Object.prototype.hasOwnProperty.call(s,"value")&&s.value===void 0&&(s.value=""),v.jsx("input",{type:e,className:Yt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...s})});ri.displayName="Input";const V5=()=>{};var rA={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},F5=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},ME={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let f=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(f=64)),r.push(n[u],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(PN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):F5(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||h==null)throw new U5;const f=i<<2|a>>4;if(r.push(f),c!==64){const m=a<<4&240|c>>2;if(r.push(m),h!==64){const E=c<<6&192|h;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class U5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const j5=function(t){const e=PN(t);return ME.encodeByteArray(e,!0)},zp=function(t){return j5(t).replace(/\./g,"")},CN=function(t){try{return ME.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $5=()=>kN().__FIREBASE_DEFAULTS__,B5=()=>{if(typeof process>"u"||typeof rA>"u")return;const t=rA.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},z5=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&CN(t[1]);return e&&JSON.parse(e)},Jg=()=>{try{return V5()||$5()||B5()||z5()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},NN=t=>{var e,n;return(n=(e=Jg())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},VE=t=>{const e=NN(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},DN=()=>{var t;return(t=Jg())==null?void 0:t.config},ON=t=>{var e;return(e=Jg())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $s(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hf(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[zp(JSON.stringify(n)),zp(JSON.stringify(o)),""].join(".")}const eh={};function W5(){const t={prod:[],emulator:[]};for(const e of Object.keys(eh))eh[e]?t.emulator.push(e):t.prod.push(e);return t}function q5(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let sA=!1;function Xg(t,e){if(typeof window>"u"||typeof document>"u"||!$s(window.location.host)||eh[t]===e||eh[t]||sA)return;eh[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=W5().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{sA=!0,o()},f}function u(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=q5(r),m=n("text"),E=document.getElementById(m)||document.createElement("span"),p=n("learnmore"),I=document.getElementById(p)||document.createElement("a"),g=n("preprendIcon"),_=document.getElementById(g)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const w=f.element;a(w),u(I,p);const A=c();l(_,g),w.append(_,E,I,A),document.body.appendChild(w)}i?(E.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function H5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(jn())}function MN(){var e;const t=(e=Jg())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function K5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function G5(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Q5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Y5(){const t=jn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function VN(){return!MN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function FN(){return!MN()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function FE(){try{return typeof indexedDB=="object"}catch{return!1}}function J5(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X5="FirebaseError";class Bs extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=X5,Object.setPrototypeOf(this,Bs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hu.prototype.create)}}class Hu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Z5(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Bs(s,a,r)}}function Z5(t,e){return t.replace(e9,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const e9=/\{\$([^}]+)}/g;function t9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Vs(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(iA(i)&&iA(o)){if(!Vs(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function iA(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Md(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Vd(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function n9(t,e){const n=new r9(t,e);return n.subscribe.bind(n)}class r9{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");s9(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Sv),s.error===void 0&&(s.error=Sv),s.complete===void 0&&(s.complete=Sv);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function s9(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Sv(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lZ=4*60*60*1e3;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t){return t&&t._delegate?t._delegate:t}class Fs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i9{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new gw;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(a9(e))try{this.getOrInitializeService({instanceIdentifier:Ua})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ua){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ua){return this.instances.has(e)}getOptions(e=Ua){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:o9(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ua){return this.component?this.component.multipleInstances?e:Ua:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function o9(t){return t===Ua?void 0:t}function a9(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new i9(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(dt||(dt={}));const c9={debug:dt.DEBUG,verbose:dt.VERBOSE,info:dt.INFO,warn:dt.WARN,error:dt.ERROR,silent:dt.SILENT},u9=dt.INFO,d9={[dt.DEBUG]:"log",[dt.VERBOSE]:"log",[dt.INFO]:"info",[dt.WARN]:"warn",[dt.ERROR]:"error"},h9=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=d9[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zg{constructor(e){this.name=e,this._logLevel=u9,this._logHandler=h9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?c9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dt.DEBUG,...e),this._logHandler(this,dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dt.VERBOSE,...e),this._logHandler(this,dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dt.INFO,...e),this._logHandler(this,dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dt.WARN,...e),this._logHandler(this,dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dt.ERROR,...e),this._logHandler(this,dt.ERROR,...e)}}const f9=(t,e)=>e.some(n=>t instanceof n);let oA,aA;function m9(){return oA||(oA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function p9(){return aA||(aA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const UN=new WeakMap,yw=new WeakMap,jN=new WeakMap,bv=new WeakMap,UE=new WeakMap;function g9(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Zo(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&UN.set(n,t)}).catch(()=>{}),UE.set(e,t),e}function y9(t){if(yw.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});yw.set(t,e)}let vw={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return yw.get(t);if(e==="objectStoreNames")return t.objectStoreNames||jN.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Zo(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function v9(t){vw=t(vw)}function _9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Av(this),e,...n);return jN.set(r,e.sort?e.sort():[e]),Zo(r)}:p9().includes(t)?function(...e){return t.apply(Av(this),e),Zo(UN.get(this))}:function(...e){return Zo(t.apply(Av(this),e))}}function w9(t){return typeof t=="function"?_9(t):(t instanceof IDBTransaction&&y9(t),f9(t,m9())?new Proxy(t,vw):t)}function Zo(t){if(t instanceof IDBRequest)return g9(t);if(bv.has(t))return bv.get(t);const e=w9(t);return e!==t&&(bv.set(t,e),UE.set(e,t)),e}const Av=t=>UE.get(t);function E9(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Zo(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Zo(o.result),l.oldVersion,l.newVersion,Zo(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const I9=["get","getKey","getAll","getAllKeys","count"],T9=["put","add","delete","clear"],xv=new Map;function lA(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xv.get(e))return xv.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=T9.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||I9.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return xv.set(e,i),i}v9(t=>({...t,get:(e,n,r)=>lA(e,n)||t.get(e,n,r),has:(e,n)=>!!lA(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(b9(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function b9(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const _w="@firebase/app",cA="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi=new Zg("@firebase/app"),A9="@firebase/app-compat",x9="@firebase/analytics-compat",R9="@firebase/analytics",P9="@firebase/app-check-compat",C9="@firebase/app-check",k9="@firebase/auth",N9="@firebase/auth-compat",D9="@firebase/database",O9="@firebase/data-connect",L9="@firebase/database-compat",M9="@firebase/functions",V9="@firebase/functions-compat",F9="@firebase/installations",U9="@firebase/installations-compat",j9="@firebase/messaging",$9="@firebase/messaging-compat",B9="@firebase/performance",z9="@firebase/performance-compat",W9="@firebase/remote-config",q9="@firebase/remote-config-compat",H9="@firebase/storage",K9="@firebase/storage-compat",G9="@firebase/firestore",Q9="@firebase/ai",Y9="@firebase/firestore-compat",J9="firebase",X9="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp="[DEFAULT]",Z9={[_w]:"fire-core",[A9]:"fire-core-compat",[R9]:"fire-analytics",[x9]:"fire-analytics-compat",[C9]:"fire-app-check",[P9]:"fire-app-check-compat",[k9]:"fire-auth",[N9]:"fire-auth-compat",[D9]:"fire-rtdb",[O9]:"fire-data-connect",[L9]:"fire-rtdb-compat",[M9]:"fire-fn",[V9]:"fire-fn-compat",[F9]:"fire-iid",[U9]:"fire-iid-compat",[j9]:"fire-fcm",[$9]:"fire-fcm-compat",[B9]:"fire-perf",[z9]:"fire-perf-compat",[W9]:"fire-rc",[q9]:"fire-rc-compat",[H9]:"fire-gcs",[K9]:"fire-gcs-compat",[G9]:"fire-fst",[Y9]:"fire-fst-compat",[Q9]:"fire-vertex","fire-js":"fire-js",[J9]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu=new Map,ww=new Map,Ew=new Map;function uA(t,e){try{t.container.addComponent(e)}catch(n){Hi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function yi(t){const e=t.name;if(Ew.has(e))return Hi.debug(`There were multiple attempts to register component ${e}.`),!1;Ew.set(e,t);for(const n of hu.values())uA(n,t);for(const n of ww.values())uA(n,t);return!0}function $l(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ez(t,e,n=Wp){$l(t,e).clearInstance(n)}function Mr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tz={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ea=new Hu("app","Firebase",tz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nz{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Fs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ea.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bl=X9;function $N(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Wp,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ea.create("bad-app-name",{appName:String(s)});if(n||(n=DN()),!n)throw ea.create("no-options");const i=hu.get(s);if(i){if(Vs(n,i.options)&&Vs(r,i.config))return i;throw ea.create("duplicate-app",{appName:s})}const o=new l9(s);for(const l of Ew.values())o.addComponent(l);const a=new nz(n,r,o);return hu.set(s,a),a}function ey(t=Wp){const e=hu.get(t);if(!e&&t===Wp&&DN())return $N();if(!e)throw ea.create("no-app",{appName:t});return e}async function cZ(t){let e=!1;const n=t.name;hu.has(n)?(e=!0,hu.delete(n)):ww.has(n)&&t.decRefCount()<=0&&(ww.delete(n),e=!0),e&&(await Promise.all(t.container.getProviders().map(r=>r.delete())),t.isDeleted=!0)}function rs(t,e,n){let r=Z9[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hi.warn(o.join(" "));return}yi(new Fs(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rz="firebase-heartbeat-database",sz=1,Uh="firebase-heartbeat-store";let Rv=null;function BN(){return Rv||(Rv=E9(rz,sz,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Uh)}catch(n){console.warn(n)}}}}).catch(t=>{throw ea.create("idb-open",{originalErrorMessage:t.message})})),Rv}async function iz(t){try{const n=(await BN()).transaction(Uh),r=await n.objectStore(Uh).get(zN(t));return await n.done,r}catch(e){if(e instanceof Bs)Hi.warn(e.message);else{const n=ea.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Hi.warn(n.message)}}}async function dA(t,e){try{const r=(await BN()).transaction(Uh,"readwrite");await r.objectStore(Uh).put(e,zN(t)),await r.done}catch(n){if(n instanceof Bs)Hi.warn(n.message);else{const r=ea.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Hi.warn(r.message)}}}function zN(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oz=1024,az=30;class lz{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new uz(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=hA();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>az){const o=dz(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Hi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=hA(),{heartbeatsToSend:r,unsentEntries:s}=cz(this._heartbeatsCache.heartbeats),i=zp(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Hi.warn(n),""}}}function hA(){return new Date().toISOString().substring(0,10)}function cz(t,e=oz){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),fA(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),fA(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class uz{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return FE()?J5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await iz(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return dA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return dA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function fA(t){return zp(JSON.stringify({version:2,heartbeats:t})).length}function dz(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hz(t){yi(new Fs("platform-logger",e=>new S9(e),"PRIVATE")),yi(new Fs("heartbeat",e=>new lz(e),"PRIVATE")),rs(_w,cA,t),rs(_w,cA,"esm2020"),rs("fire-js","")}hz("");function WN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const fz=WN,qN=new Hu("auth","Firebase",WN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qp=new Zg("@firebase/auth");function mz(t,...e){qp.logLevel<=dt.WARN&&qp.warn(`Auth (${Bl}): ${t}`,...e)}function Wm(t,...e){qp.logLevel<=dt.ERROR&&qp.error(`Auth (${Bl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Us(t,...e){throw jE(t,...e)}function ui(t,...e){return jE(t,...e)}function HN(t,e,n){const r={...fz(),[e]:n};return new Hu("auth","Firebase",r).create(e,{appName:t.name})}function Vi(t){return HN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jE(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return qN.create(t,...e)}function Ue(t,e,...n){if(!t)throw jE(e,...n)}function ki(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Wm(e),new Error(e)}function Ki(t,e){t||ki(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hp(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function KN(){return mA()==="http:"||mA()==="https:"}function mA(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(KN()||G5()||"connection"in navigator)?navigator.onLine:!0}function gz(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ki(n>e,"Short delay should be less than long delay!"),this.isMobile=H5()||Q5()}get(){return pz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(t,e){Ki(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ki("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ki("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ki("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vz=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],_z=new mf(3e4,6e4);function Ei(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function zs(t,e,n,r,s={}){return QN(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=ff({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...i};return K5()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&$s(t.emulatorConfig.host)&&(c.credentials="include"),GN.fetch()(await YN(t,t.config.apiHost,n,a),c)})}async function QN(t,e,n){t._canInitEmulator=!1;const r={...yz,...e};try{const s=new Ez(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw um(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw um(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw um(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw um(t,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw HN(t,u,c);Us(t,u)}}catch(s){if(s instanceof Bs)throw s;Us(t,"network-request-failed",{message:String(s)})}}async function pf(t,e,n,r,s={}){const i=await zs(t,e,n,r,s);return"mfaPendingCredential"in i&&Us(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function YN(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?$E(t.config,s):`${t.config.apiScheme}://${s}`;return vz.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function wz(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ez{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(ui(this.auth,"network-request-failed")),_z.get())})}}function um(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=ui(t,e,r);return s.customData._tokenResponse=n,s}function pA(t){return t!==void 0&&t.enterprise!==void 0}class Iz{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return wz(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Tz(t,e){return zs(t,"GET","/v2/recaptchaConfig",Ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sz(t,e){return zs(t,"POST","/v1/accounts:delete",e)}async function Kp(t,e){return zs(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bz(t,e=!1){const n=tt(t),r=await n.getIdToken(e),s=BE(r);Ue(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:th(Pv(s.auth_time)),issuedAtTime:th(Pv(s.iat)),expirationTime:th(Pv(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Pv(t){return Number(t)*1e3}function BE(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Wm("JWT malformed, contained fewer than 3 sections"),null;try{const s=CN(n);return s?JSON.parse(s):(Wm("Failed to decode base64 JWT payload"),null)}catch(s){return Wm("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function gA(t){const e=BE(t);return Ue(e,"internal-error"),Ue(typeof e.exp<"u","internal-error"),Ue(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fu(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Bs&&Az(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Az({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=th(this.lastLoginAt),this.creationTime=th(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gp(t){var h;const e=t.auth,n=await t.getIdToken(),r=await fu(t,Kp(e,{idToken:n}));Ue(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(h=s.providerUserInfo)!=null&&h.length?JN(s.providerUserInfo):[],o=Pz(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),c=a?l:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Iw(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function Rz(t){const e=tt(t);await Gp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Pz(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function JN(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cz(t,e){const n=await QN(t,{},async()=>{const r=ff({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await YN(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&$s(t.emulatorConfig.host)&&(l.credentials="include"),GN.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function kz(t,e){return zs(t,"POST","/v2/accounts:revokeToken",Ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ue(e.idToken,"internal-error"),Ue(typeof e.idToken<"u","internal-error"),Ue(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):gA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ue(e.length!==0,"internal-error");const n=gA(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ue(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await Cz(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new jc;return r&&(Ue(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(Ue(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Ue(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jc,this.toJSON())}_performRefresh(){return ki("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fo(t,e){Ue(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ps{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new xz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Iw(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await fu(this,this.stsTokenManager.getToken(this.auth,e));return Ue(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return bz(this,e)}reload(){return Rz(this)}_assign(e){this!==e&&(Ue(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ps({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ue(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Gp(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mr(this.auth.app))return Promise.reject(Vi(this.auth));const e=await this.getIdToken();return await fu(this,Sz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,c=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:m,providerData:E,stsTokenManager:p}=n;Ue(h&&p,e,"internal-error");const I=jc.fromJSON(this.name,p);Ue(typeof h=="string",e,"internal-error"),fo(r,e.name),fo(s,e.name),Ue(typeof f=="boolean",e,"internal-error"),Ue(typeof m=="boolean",e,"internal-error"),fo(i,e.name),fo(o,e.name),fo(a,e.name),fo(l,e.name),fo(c,e.name),fo(u,e.name);const g=new Ps({uid:h,auth:e,email:s,emailVerified:f,displayName:r,isAnonymous:m,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:I,createdAt:c,lastLoginAt:u});return E&&Array.isArray(E)&&(g.providerData=E.map(_=>({..._}))),l&&(g._redirectEventId=l),g}static async _fromIdTokenResponse(e,n,r=!1){const s=new jc;s.updateFromServerResponse(n);const i=new Ps({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Gp(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Ue(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?JN(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new jc;a.updateFromIdToken(r);const l=new Ps({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Iw(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA=new Map;function Ni(t){Ki(t instanceof Function,"Expected a class definition");let e=yA.get(t);return e?(Ki(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,yA.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}XN.type="NONE";const Tw=XN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(t,e,n){return`firebase:${t}:${e}:${n}`}class $c{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=qm(this.userKey,s.apiKey,i),this.fullPersistenceKey=qm("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Kp(this.auth,{idToken:e}).catch(()=>{});return n?Ps._fromGetAccountInfoResponse(this.auth,n,e):null}return Ps._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new $c(Ni(Tw),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Ni(Tw);const o=qm(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){let h;if(typeof u=="string"){const f=await Kp(e,{idToken:u}).catch(()=>{});if(!f)break;h=await Ps._fromGetAccountInfoResponse(e,f,u)}else h=Ps._fromJSON(e,u);c!==i&&(a=h),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new $c(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new $c(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vA(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nD(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ZN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sD(e))return"Blackberry";if(iD(e))return"Webos";if(eD(e))return"Safari";if((e.includes("chrome/")||tD(e))&&!e.includes("edge/"))return"Chrome";if(rD(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function ZN(t=jn()){return/firefox\//i.test(t)}function eD(t=jn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tD(t=jn()){return/crios\//i.test(t)}function nD(t=jn()){return/iemobile/i.test(t)}function rD(t=jn()){return/android/i.test(t)}function sD(t=jn()){return/blackberry/i.test(t)}function iD(t=jn()){return/webos/i.test(t)}function zE(t=jn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Nz(t=jn()){var e;return zE(t)&&!!((e=window.navigator)!=null&&e.standalone)}function Dz(){return Y5()&&document.documentMode===10}function oD(t=jn()){return zE(t)||rD(t)||iD(t)||sD(t)||/windows phone/i.test(t)||nD(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aD(t,e=[]){let n;switch(t){case"Browser":n=vA(jn());break;case"Worker":n=`${vA(jn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Bl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lz(t,e={}){return zs(t,"GET","/v2/passwordPolicy",Ei(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mz=6;class Vz{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Mz,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fz{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _A(this),this.idTokenSubscription=new _A(this),this.beforeStateQueue=new Oz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ni(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await $c.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Kp(this,{idToken:e}),r=await Ps._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Mr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ue(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Gp(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=gz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mr(this.app))return Promise.reject(Vi(this));const n=e?tt(e):null;return n&&Ue(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ue(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mr(this.app)?Promise.reject(Vi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mr(this.app)?Promise.reject(Vi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ni(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Lz(this),n=new Vz(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Hu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await kz(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ni(e)||this._popupRedirectResolver;Ue(n,this,"argument-error"),this.redirectPersistenceManager=await $c.create(this,[Ni(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ue(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ue(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=aD(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&mz(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ea(t){return tt(t)}class _A{constructor(e){this.auth=e,this.observer=null,this.addObserver=n9(n=>this.observer=n)}get next(){return Ue(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ty={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Uz(t){ty=t}function lD(t){return ty.loadJS(t)}function jz(){return ty.recaptchaEnterpriseScript}function $z(){return ty.gapiScript}function Bz(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class zz{constructor(){this.enterprise=new Wz}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Wz{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const qz="recaptcha-enterprise",cD="NO_RECAPTCHA";class Hz{constructor(e){this.type=qz,this.auth=Ea(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{Tz(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new Iz(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;pA(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(cD)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new zz().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&pA(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=jz();l.length!==0&&(l+=a),lD(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function wA(t,e,n,r=!1,s=!1){const i=new Hz(t);let o;if(s)o=cD;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Qp(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await wA(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await wA(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uD(t,e){const n=$l(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Vs(i,e??{}))return s;Us(s,"already-initialized")}return n.initialize({options:e})}function Kz(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ni);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Gz(t,e,n){const r=Ea(t);Ue(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=dD(e),{host:o,port:a}=Qz(e),l=a===null?"":`:${a}`,c={url:`${i}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Ue(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ue(Vs(c,r.config.emulator)&&Vs(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,$s(o)?(hf(`${i}//${o}${l}`),Xg("Auth",!0)):Yz()}function dD(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Qz(t){const e=dD(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:EA(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:EA(o)}}}function EA(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Yz(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ki("not implemented")}_getIdTokenResponse(e){return ki("not implemented")}_linkToIdToken(e,n){return ki("not implemented")}_getReauthenticationResolver(e){return ki("not implemented")}}async function Jz(t,e){return zs(t,"POST","/v1/accounts:update",e)}async function Xz(t,e){return zs(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zz(t,e){return pf(t,"POST","/v1/accounts:signInWithPassword",Ei(t,e))}async function eW(t,e){return zs(t,"POST","/v1/accounts:sendOobCode",Ei(t,e))}async function tW(t,e){return eW(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nW(t,e){return pf(t,"POST","/v1/accounts:signInWithEmailLink",Ei(t,e))}async function rW(t,e){return pf(t,"POST","/v1/accounts:signInWithEmailLink",Ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh extends WE{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new jh(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new jh(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qp(e,n,"signInWithPassword",Zz);case"emailLink":return nW(e,{email:this._email,oobCode:this._password});default:Us(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qp(e,r,"signUpPassword",Xz);case"emailLink":return rW(e,{idToken:n,email:this._email,oobCode:this._password});default:Us(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bc(t,e){return pf(t,"POST","/v1/accounts:signInWithIdp",Ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sW="http://localhost";class Il extends WE{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Il(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Us("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Il(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Bc(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Bc(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Bc(e,n)}buildRequest(){const e={requestUri:sW,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ff(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iW(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function oW(t){const e=Md(Vd(t)).link,n=e?Md(Vd(e)).deep_link_id:null,r=Md(Vd(t)).deep_link_id;return(r?Md(Vd(r)).link:null)||r||n||e||t}class qE{constructor(e){const n=Md(Vd(e)),r=n.apiKey??null,s=n.oobCode??null,i=iW(n.mode??null);Ue(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=oW(e);try{return new qE(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(){this.providerId=Ku.PROVIDER_ID}static credential(e,n){return jh._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=qE.parseLink(n);return Ue(r,"argument-error"),jh._fromEmailAndCode(e,r.code,r.tenantId)}}Ku.PROVIDER_ID="password";Ku.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ku.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf extends hD{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo extends gf{constructor(){super("facebook.com")}static credential(e){return Il._fromParams({providerId:bo.PROVIDER_ID,signInMethod:bo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bo.credentialFromTaggedObject(e)}static credentialFromError(e){return bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bo.credential(e.oauthAccessToken)}catch{return null}}}bo.FACEBOOK_SIGN_IN_METHOD="facebook.com";bo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao extends gf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Il._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Ao.credential(n,r)}catch{return null}}}Ao.GOOGLE_SIGN_IN_METHOD="google.com";Ao.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo extends gf{constructor(){super("github.com")}static credential(e){return Il._fromParams({providerId:xo.PROVIDER_ID,signInMethod:xo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xo.credentialFromTaggedObject(e)}static credentialFromError(e){return xo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xo.credential(e.oauthAccessToken)}catch{return null}}}xo.GITHUB_SIGN_IN_METHOD="github.com";xo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro extends gf{constructor(){super("twitter.com")}static credential(e,n){return Il._fromParams({providerId:Ro.PROVIDER_ID,signInMethod:Ro.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ro.credentialFromTaggedObject(e)}static credentialFromError(e){return Ro.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ro.credential(n,r)}catch{return null}}}Ro.TWITTER_SIGN_IN_METHOD="twitter.com";Ro.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aW(t,e){return pf(t,"POST","/v1/accounts:signUp",Ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Ps._fromIdTokenResponse(e,r,s),o=IA(r);return new Tl({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=IA(r);return new Tl({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function IA(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp extends Bs{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Yp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Yp(e,n,r,s)}}function fD(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Yp._fromErrorAndOperation(t,i,e,r):i})}async function lW(t,e,n=!1){const r=await fu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Tl._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mD(t,e,n=!1){const{auth:r}=t;if(Mr(r.app))return Promise.reject(Vi(r));const s="reauthenticate";try{const i=await fu(t,fD(r,s,e,t),n);Ue(i.idToken,r,"internal-error");const o=BE(i.idToken);Ue(o,r,"internal-error");const{sub:a}=o;return Ue(t.uid===a,r,"user-mismatch"),Tl._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Us(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pD(t,e,n=!1){if(Mr(t.app))return Promise.reject(Vi(t));const r="signIn",s=await fD(t,r,e),i=await Tl._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function cW(t,e){return pD(Ea(t),e)}async function uZ(t,e){return mD(tt(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gD(t){const e=Ea(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function uW(t,e,n){const r=Ea(t);await Qp(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",tW)}async function TA(t,e,n){if(Mr(t.app))return Promise.reject(Vi(t));const r=Ea(t),o=await Qp(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",aW).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&gD(t),l}),a=await Tl._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function dW(t,e,n){return Mr(t.app)?Promise.reject(Vi(t)):cW(tt(t),Ku.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&gD(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hW(t,e){return zs(t,"POST","/v1/accounts:createAuthUri",Ei(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fW(t,e){const n=KN()?Hp():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:s}=await hW(tt(t),r);return s||[]}function dZ(t,e){return mW(tt(t),null,e)}async function mW(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(i.password=n);const o=await fu(t,Jz(r,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pW(t,e){return tt(t).setPersistence(e)}function gW(t,e,n,r){return tt(t).onIdTokenChanged(e,n,r)}function yW(t,e,n){return tt(t).beforeAuthStateChanged(e,n)}function vW(t,e,n,r){return tt(t).onAuthStateChanged(e,n,r)}function SA(t){return tt(t).signOut()}const Jp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Jp,"1"),this.storage.removeItem(Jp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _W=1e3,wW=10;class vD extends yD{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=oD(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Dz()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,wW):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},_W)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}vD.type="LOCAL";const HE=vD;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D extends yD{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}_D.type="SESSION";const KE=_D;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EW(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new ny(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(n.origin,i)),l=await EW(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ny.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IW{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=GE("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(f.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function di(){return window}function TW(t){di().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wD(){return typeof di().WorkerGlobalScope<"u"&&typeof di().importScripts=="function"}async function SW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function bW(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function AW(){return wD()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED="firebaseLocalStorageDb",xW=1,Xp="firebaseLocalStorage",ID="fbase_key";class yf{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function ry(t,e){return t.transaction([Xp],e?"readwrite":"readonly").objectStore(Xp)}function RW(){const t=indexedDB.deleteDatabase(ED);return new yf(t).toPromise()}function Sw(){const t=indexedDB.open(ED,xW);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Xp,{keyPath:ID})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Xp)?e(r):(r.close(),await RW(),e(await Sw()))})})}async function bA(t,e,n){const r=ry(t,!0).put({[ID]:e,value:n});return new yf(r).toPromise()}async function PW(t,e){const n=ry(t,!1).get(e),r=await new yf(n).toPromise();return r===void 0?null:r.value}function AA(t,e){const n=ry(t,!0).delete(e);return new yf(n).toPromise()}const CW=800,kW=3;class TD{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sw(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>kW)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wD()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ny._getInstance(AW()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await SW(),!this.activeServiceWorker)return;this.sender=new IW(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||bW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sw();return await bA(e,Jp,"1"),await AA(e,Jp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>bA(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>PW(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>AA(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=ry(s,!1).getAll();return new yf(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),CW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}TD.type="LOCAL";const NW=TD;new mf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DW(t,e){return e?Ni(e):(Ue(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE extends WE{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Bc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Bc(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function OW(t){return pD(t.auth,new QE(t),t.bypassAuthState)}function LW(t){const{auth:e,user:n}=t;return Ue(n,e,"internal-error"),mD(n,new QE(t),t.bypassAuthState)}async function MW(t){const{auth:e,user:n}=t;return Ue(n,e,"internal-error"),lW(n,new QE(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OW;case"linkViaPopup":case"linkViaRedirect":return MW;case"reauthViaPopup":case"reauthViaRedirect":return LW;default:Us(this.auth,"internal-error")}}resolve(e){Ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VW=new mf(2e3,1e4);class bc extends SD{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,bc.currentPopupAction&&bc.currentPopupAction.cancel(),bc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ue(e,this.auth,"internal-error"),e}async onExecution(){Ki(this.filter.length===1,"Popup operations only handle one event");const e=GE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(ui(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(ui(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,bc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ui(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,VW.get())};e()}}bc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FW="pendingRedirect",Hm=new Map;class UW extends SD{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Hm.get(this.auth._key());if(!e){try{const r=await jW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Hm.set(this.auth._key(),e)}return this.bypassAuthState||Hm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function jW(t,e){const n=zW(e),r=BW(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function $W(t,e){Hm.set(t._key(),e)}function BW(t){return Ni(t._redirectPersistence)}function zW(t){return qm(FW,t.config.apiKey,t.name)}async function WW(t,e,n=!1){if(Mr(t.app))return Promise.reject(Vi(t));const r=Ea(t),s=DW(r,e),o=await new UW(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qW=10*60*1e3;class HW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KW(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!bD(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(ui(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qW&&this.cachedEventUids.clear(),this.cachedEventUids.has(xA(e))}saveEventToCache(e){this.cachedEventUids.add(xA(e)),this.lastProcessedEventTime=Date.now()}}function xA(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function bD({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function KW(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bD(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GW(t,e={}){return zs(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,YW=/^https?/;async function JW(t){if(t.config.emulator)return;const{authorizedDomains:e}=await GW(t);for(const n of e)try{if(XW(n))return}catch{}Us(t,"unauthorized-domain")}function XW(t){const e=Hp(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!YW.test(n))return!1;if(QW.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZW=new mf(3e4,6e4);function RA(){const t=di().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function eq(t){return new Promise((e,n)=>{var s,i,o;function r(){RA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{RA(),n(ui(t,"network-request-failed"))},timeout:ZW.get()})}if((i=(s=di().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=di().gapi)!=null&&o.load)r();else{const a=Bz("iframefcb");return di()[a]=()=>{gapi.load?r():n(ui(t,"network-request-failed"))},lD(`${$z()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Km=null,e})}let Km=null;function tq(t){return Km=Km||eq(t),Km}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nq=new mf(5e3,15e3),rq="__/auth/iframe",sq="emulator/auth/iframe",iq={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oq=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function aq(t){const e=t.config;Ue(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?$E(e,sq):`https://${t.config.authDomain}/${rq}`,r={apiKey:e.apiKey,appName:t.name,v:Bl},s=oq.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ff(r).slice(1)}`}async function lq(t){const e=await tq(t),n=di().gapi;return Ue(n,t,"internal-error"),e.open({where:document.body,url:aq(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:iq,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=ui(t,"network-request-failed"),a=di().setTimeout(()=>{i(o)},nq.get());function l(){di().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cq={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},uq=500,dq=600,hq="_blank",fq="http://localhost";class PA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mq(t,e,n,r=uq,s=dq){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...cq,width:r.toString(),height:s.toString(),top:i,left:o},c=jn().toLowerCase();n&&(a=tD(c)?hq:n),ZN(c)&&(e=e||fq,l.scrollbars="yes");const u=Object.entries(l).reduce((f,[m,E])=>`${f}${m}=${E},`,"");if(Nz(c)&&a!=="_self")return pq(e||"",a),new PA(null);const h=window.open(e||"",a,u);Ue(h,t,"popup-blocked");try{h.focus()}catch{}return new PA(h)}function pq(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gq="__/auth/handler",yq="emulator/auth/handler",vq=encodeURIComponent("fac");async function CA(t,e,n,r,s,i){Ue(t.config.authDomain,t,"auth-domain-config-required"),Ue(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Bl,eventId:s};if(e instanceof hD){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",t9(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof gf){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${vq}=${encodeURIComponent(l)}`:"";return`${_q(t)}?${ff(a).slice(1)}${c}`}function _q({config:t}){return t.emulator?$E(t,yq):`https://${t.authDomain}/${gq}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cv="webStorageSupport";class wq{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=KE,this._completeRedirectFn=WW,this._overrideRedirectResult=$W}async _openPopup(e,n,r,s){var o;Ki((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await CA(e,n,r,Hp(),s);return mq(e,i,GE())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await CA(e,n,r,Hp(),s);return TW(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Ki(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await lq(e),r=new HW(e);return n.register("authEvent",s=>(Ue(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Cv,{type:Cv},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Cv];i!==void 0&&n(!!i),Us(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=JW(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return oD()||eD()||zE()}}const Eq=wq;var kA="@firebase/auth",NA="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iq{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ue(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tq(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Sq(t){yi(new Fs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Ue(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:aD(t)},c=new Fz(r,s,i,l);return Kz(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),yi(new Fs("auth-internal",e=>{const n=Ea(e.getProvider("auth").getImmediate());return(r=>new Iq(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),rs(kA,NA,Tq(t)),rs(kA,NA,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bq=5*60,Aq=ON("authIdTokenMaxAge")||bq;let DA=null;const xq=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Aq)return;const s=n==null?void 0:n.token;DA!==s&&(DA=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function hZ(t=ey()){const e=$l(t,"auth");if(e.isInitialized())return e.getImmediate();const n=uD(t,{popupRedirectResolver:Eq,persistence:[NW,HE,KE]}),r=ON("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=xq(i.toString());yW(n,o,()=>o(n.currentUser)),gW(n,a=>o(a))}}const s=NN("auth");return s&&Gz(n,`http://${s}`),n}function Rq(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}Uz({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=ui("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Rq().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Sq("Browser");var Pq="firebase",Cq="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rs(Pq,Cq,"app");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kq=new Map,Nq={activated:!1,tokenObservers:[]},Dq={initialized:!1,enabled:!1};function js(t){return kq.get(t)||{...Nq}}function AD(){return Dq}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oq="https://content-firebaseappcheck.googleapis.com/v1";const Lq="exchangeDebugToken",OA={RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},fZ=24*60*60*1e3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mq{constructor(e,n,r,s,i){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new gw,this.pending.promise.catch(n=>{}),await Vq(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new gw,this.pending.promise.catch(n=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function Vq(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fq={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},jo=new Hu("appCheck","AppCheck",Fq);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xD(t){if(!js(t).activated)throw jo.create("use-before-activation",{appName:t.name})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RD({url:t,body:e},n){const r={"Content-Type":"application/json"},s=n.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&(r["X-Firebase-Client"]=h)}const i={method:"POST",body:JSON.stringify(e),headers:r};let o;try{o=await fetch(t,i)}catch(h){throw jo.create("fetch-network-error",{originalErrorMessage:h==null?void 0:h.message})}if(o.status!==200)throw jo.create("fetch-status-error",{httpStatus:o.status});let a;try{a=await o.json()}catch(h){throw jo.create("fetch-parse-error",{originalErrorMessage:h==null?void 0:h.message})}const l=a.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw jo.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const c=Number(l[1])*1e3,u=Date.now();return{token:a.token,expireTimeMillis:u+c,issuedAtTimeMillis:u}}function PD(t,e){const{projectId:n,appId:r,apiKey:s}=t.options;return{url:`${Oq}/projects/${n}/apps/${r}:${Lq}?key=${s}`,body:{debug_token:e}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uq="firebase-app-check-database",jq=1,bw="firebase-app-check-store";let dm=null;function $q(){return dm||(dm=new Promise((t,e)=>{try{const n=indexedDB.open(Uq,jq);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var s;e(jo.create("storage-open",{originalErrorMessage:(s=r.target.error)==null?void 0:s.message}))},n.onupgradeneeded=r=>{const s=r.target.result;switch(r.oldVersion){case 0:s.createObjectStore(bw,{keyPath:"compositeKey"})}}}catch(n){e(jo.create("storage-open",{originalErrorMessage:n==null?void 0:n.message}))}}),dm)}function Bq(t,e){return zq(Wq(t),e)}async function zq(t,e){const r=(await $q()).transaction(bw,"readwrite"),i=r.objectStore(bw).put({compositeKey:t,value:e});return new Promise((o,a)=>{i.onsuccess=l=>{o()},r.onerror=l=>{var c;a(jo.create("storage-set",{originalErrorMessage:(c=l.target.error)==null?void 0:c.message}))}})}function Wq(t){return`${t.options.appId}-${t.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd=new Zg("@firebase/app-check");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(t,e){return FE()?Bq(t,e).catch(n=>{Fd.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(){return AD().enabled}async function kD(){const t=AD();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qq={error:"UNKNOWN_ERROR"};function Hq(t){return ME.encodeString(JSON.stringify(t),!1)}async function Aw(t,e=!1,n=!1){const r=t.app;xD(r);const s=js(r);let i=s.token,o;if(i&&!Ud(i)&&(s.token=void 0,i=void 0),!i){const c=await s.cachedTokenPromise;c&&(Ud(c)?i=c:await kv(r,void 0))}if(!e&&i&&Ud(i))return{token:i.token};let a=!1;if(CD())try{s.exchangeTokenPromise||(s.exchangeTokenPromise=RD(PD(r,await kD()),t.heartbeatServiceProvider).finally(()=>{s.exchangeTokenPromise=void 0}),a=!0);const c=await s.exchangeTokenPromise;return await kv(r,c),s.token=c,{token:c.token}}catch(c){return c.code==="appCheck/throttled"||c.code==="appCheck/initial-throttle"?Fd.warn(c.message):n&&Fd.error(c),Nv(c)}try{s.exchangeTokenPromise||(s.exchangeTokenPromise=s.provider.getToken().finally(()=>{s.exchangeTokenPromise=void 0}),a=!0),i=await js(r).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"||c.code==="appCheck/initial-throttle"?Fd.warn(c.message):n&&Fd.error(c),o=c}let l;return i?o?Ud(i)?l={token:i.token,internalError:o}:l=Nv(o):(l={token:i.token},s.token=i,await kv(r,i)):l=Nv(o),a&&Yq(r,l),l}async function Kq(t){const e=t.app;xD(e);const{provider:n}=js(e);if(CD()){const r=await kD(),{token:s}=await RD(PD(e,r),t.heartbeatServiceProvider);return{token:s}}else{const{token:r}=await n.getToken();return{token:r}}}function Gq(t,e,n,r){const{app:s}=t,i=js(s),o={next:n,error:r,type:e};if(i.tokenObservers=[...i.tokenObservers,o],i.token&&Ud(i.token)){const a=i.token;Promise.resolve().then(()=>{n({token:a.token}),LA(t)}).catch(()=>{})}i.cachedTokenPromise.then(()=>LA(t))}function ND(t,e){const n=js(t),r=n.tokenObservers.filter(s=>s.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function LA(t){const{app:e}=t,n=js(e);let r=n.tokenRefresher;r||(r=Qq(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function Qq(t){const{app:e}=t;return new Mq(async()=>{const n=js(e);let r;if(n.token?r=await Aw(t,!0):r=await Aw(t),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{const n=js(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const s=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,s),Math.max(0,r-Date.now())}else return 0},OA.RETRIAL_MIN_WAIT,OA.RETRIAL_MAX_WAIT)}function Yq(t,e){const n=js(t).tokenObservers;for(const r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Ud(t){return t.expireTimeMillis-Date.now()>0}function Nv(t){return{token:Hq(qq),error:t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jq{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=js(this.app);for(const n of e)ND(this.app,n.next);return Promise.resolve()}}function Xq(t,e){return new Jq(t,e)}function Zq(t){return{getToken:e=>Aw(t,e),getLimitedUseToken:()=>Kq(t),addTokenListener:e=>Gq(t,"INTERNAL",e),removeTokenListener:e=>ND(t.app,e)}}const e8="@firebase/app-check",t8="0.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n8="app-check",MA="app-check-internal";function r8(){yi(new Fs(n8,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return Xq(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(MA).initialize()})),yi(new Fs(MA,t=>{const e=t.getProvider("app-check").getImmediate();return Zq(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),rs(e8,t8)}r8();var VA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ta,DD;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,T){function R(){}R.prototype=T.prototype,x.F=T.prototype,x.prototype=new R,x.prototype.constructor=x,x.D=function(C,D,O){for(var k=Array(arguments.length-2),B=2;B<arguments.length;B++)k[B-2]=arguments[B];return T.prototype[D].apply(C,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,T,R){R||(R=0);const C=Array(16);if(typeof T=="string")for(var D=0;D<16;++D)C[D]=T.charCodeAt(R++)|T.charCodeAt(R++)<<8|T.charCodeAt(R++)<<16|T.charCodeAt(R++)<<24;else for(D=0;D<16;++D)C[D]=T[R++]|T[R++]<<8|T[R++]<<16|T[R++]<<24;T=x.g[0],R=x.g[1],D=x.g[2];let O=x.g[3],k;k=T+(O^R&(D^O))+C[0]+3614090360&4294967295,T=R+(k<<7&4294967295|k>>>25),k=O+(D^T&(R^D))+C[1]+3905402710&4294967295,O=T+(k<<12&4294967295|k>>>20),k=D+(R^O&(T^R))+C[2]+606105819&4294967295,D=O+(k<<17&4294967295|k>>>15),k=R+(T^D&(O^T))+C[3]+3250441966&4294967295,R=D+(k<<22&4294967295|k>>>10),k=T+(O^R&(D^O))+C[4]+4118548399&4294967295,T=R+(k<<7&4294967295|k>>>25),k=O+(D^T&(R^D))+C[5]+1200080426&4294967295,O=T+(k<<12&4294967295|k>>>20),k=D+(R^O&(T^R))+C[6]+2821735955&4294967295,D=O+(k<<17&4294967295|k>>>15),k=R+(T^D&(O^T))+C[7]+4249261313&4294967295,R=D+(k<<22&4294967295|k>>>10),k=T+(O^R&(D^O))+C[8]+1770035416&4294967295,T=R+(k<<7&4294967295|k>>>25),k=O+(D^T&(R^D))+C[9]+2336552879&4294967295,O=T+(k<<12&4294967295|k>>>20),k=D+(R^O&(T^R))+C[10]+4294925233&4294967295,D=O+(k<<17&4294967295|k>>>15),k=R+(T^D&(O^T))+C[11]+2304563134&4294967295,R=D+(k<<22&4294967295|k>>>10),k=T+(O^R&(D^O))+C[12]+1804603682&4294967295,T=R+(k<<7&4294967295|k>>>25),k=O+(D^T&(R^D))+C[13]+4254626195&4294967295,O=T+(k<<12&4294967295|k>>>20),k=D+(R^O&(T^R))+C[14]+2792965006&4294967295,D=O+(k<<17&4294967295|k>>>15),k=R+(T^D&(O^T))+C[15]+1236535329&4294967295,R=D+(k<<22&4294967295|k>>>10),k=T+(D^O&(R^D))+C[1]+4129170786&4294967295,T=R+(k<<5&4294967295|k>>>27),k=O+(R^D&(T^R))+C[6]+3225465664&4294967295,O=T+(k<<9&4294967295|k>>>23),k=D+(T^R&(O^T))+C[11]+643717713&4294967295,D=O+(k<<14&4294967295|k>>>18),k=R+(O^T&(D^O))+C[0]+3921069994&4294967295,R=D+(k<<20&4294967295|k>>>12),k=T+(D^O&(R^D))+C[5]+3593408605&4294967295,T=R+(k<<5&4294967295|k>>>27),k=O+(R^D&(T^R))+C[10]+38016083&4294967295,O=T+(k<<9&4294967295|k>>>23),k=D+(T^R&(O^T))+C[15]+3634488961&4294967295,D=O+(k<<14&4294967295|k>>>18),k=R+(O^T&(D^O))+C[4]+3889429448&4294967295,R=D+(k<<20&4294967295|k>>>12),k=T+(D^O&(R^D))+C[9]+568446438&4294967295,T=R+(k<<5&4294967295|k>>>27),k=O+(R^D&(T^R))+C[14]+3275163606&4294967295,O=T+(k<<9&4294967295|k>>>23),k=D+(T^R&(O^T))+C[3]+4107603335&4294967295,D=O+(k<<14&4294967295|k>>>18),k=R+(O^T&(D^O))+C[8]+1163531501&4294967295,R=D+(k<<20&4294967295|k>>>12),k=T+(D^O&(R^D))+C[13]+2850285829&4294967295,T=R+(k<<5&4294967295|k>>>27),k=O+(R^D&(T^R))+C[2]+4243563512&4294967295,O=T+(k<<9&4294967295|k>>>23),k=D+(T^R&(O^T))+C[7]+1735328473&4294967295,D=O+(k<<14&4294967295|k>>>18),k=R+(O^T&(D^O))+C[12]+2368359562&4294967295,R=D+(k<<20&4294967295|k>>>12),k=T+(R^D^O)+C[5]+4294588738&4294967295,T=R+(k<<4&4294967295|k>>>28),k=O+(T^R^D)+C[8]+2272392833&4294967295,O=T+(k<<11&4294967295|k>>>21),k=D+(O^T^R)+C[11]+1839030562&4294967295,D=O+(k<<16&4294967295|k>>>16),k=R+(D^O^T)+C[14]+4259657740&4294967295,R=D+(k<<23&4294967295|k>>>9),k=T+(R^D^O)+C[1]+2763975236&4294967295,T=R+(k<<4&4294967295|k>>>28),k=O+(T^R^D)+C[4]+1272893353&4294967295,O=T+(k<<11&4294967295|k>>>21),k=D+(O^T^R)+C[7]+4139469664&4294967295,D=O+(k<<16&4294967295|k>>>16),k=R+(D^O^T)+C[10]+3200236656&4294967295,R=D+(k<<23&4294967295|k>>>9),k=T+(R^D^O)+C[13]+681279174&4294967295,T=R+(k<<4&4294967295|k>>>28),k=O+(T^R^D)+C[0]+3936430074&4294967295,O=T+(k<<11&4294967295|k>>>21),k=D+(O^T^R)+C[3]+3572445317&4294967295,D=O+(k<<16&4294967295|k>>>16),k=R+(D^O^T)+C[6]+76029189&4294967295,R=D+(k<<23&4294967295|k>>>9),k=T+(R^D^O)+C[9]+3654602809&4294967295,T=R+(k<<4&4294967295|k>>>28),k=O+(T^R^D)+C[12]+3873151461&4294967295,O=T+(k<<11&4294967295|k>>>21),k=D+(O^T^R)+C[15]+530742520&4294967295,D=O+(k<<16&4294967295|k>>>16),k=R+(D^O^T)+C[2]+3299628645&4294967295,R=D+(k<<23&4294967295|k>>>9),k=T+(D^(R|~O))+C[0]+4096336452&4294967295,T=R+(k<<6&4294967295|k>>>26),k=O+(R^(T|~D))+C[7]+1126891415&4294967295,O=T+(k<<10&4294967295|k>>>22),k=D+(T^(O|~R))+C[14]+2878612391&4294967295,D=O+(k<<15&4294967295|k>>>17),k=R+(O^(D|~T))+C[5]+4237533241&4294967295,R=D+(k<<21&4294967295|k>>>11),k=T+(D^(R|~O))+C[12]+1700485571&4294967295,T=R+(k<<6&4294967295|k>>>26),k=O+(R^(T|~D))+C[3]+2399980690&4294967295,O=T+(k<<10&4294967295|k>>>22),k=D+(T^(O|~R))+C[10]+4293915773&4294967295,D=O+(k<<15&4294967295|k>>>17),k=R+(O^(D|~T))+C[1]+2240044497&4294967295,R=D+(k<<21&4294967295|k>>>11),k=T+(D^(R|~O))+C[8]+1873313359&4294967295,T=R+(k<<6&4294967295|k>>>26),k=O+(R^(T|~D))+C[15]+4264355552&4294967295,O=T+(k<<10&4294967295|k>>>22),k=D+(T^(O|~R))+C[6]+2734768916&4294967295,D=O+(k<<15&4294967295|k>>>17),k=R+(O^(D|~T))+C[13]+1309151649&4294967295,R=D+(k<<21&4294967295|k>>>11),k=T+(D^(R|~O))+C[4]+4149444226&4294967295,T=R+(k<<6&4294967295|k>>>26),k=O+(R^(T|~D))+C[11]+3174756917&4294967295,O=T+(k<<10&4294967295|k>>>22),k=D+(T^(O|~R))+C[2]+718787259&4294967295,D=O+(k<<15&4294967295|k>>>17),k=R+(O^(D|~T))+C[9]+3951481745&4294967295,x.g[0]=x.g[0]+T&4294967295,x.g[1]=x.g[1]+(D+(k<<21&4294967295|k>>>11))&4294967295,x.g[2]=x.g[2]+D&4294967295,x.g[3]=x.g[3]+O&4294967295}r.prototype.v=function(x,T){T===void 0&&(T=x.length);const R=T-this.blockSize,C=this.C;let D=this.h,O=0;for(;O<T;){if(D==0)for(;O<=R;)s(this,x,O),O+=this.blockSize;if(typeof x=="string"){for(;O<T;)if(C[D++]=x.charCodeAt(O++),D==this.blockSize){s(this,C),D=0;break}}else for(;O<T;)if(C[D++]=x[O++],D==this.blockSize){s(this,C),D=0;break}}this.h=D,this.o+=T},r.prototype.A=function(){var x=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);x[0]=128;for(var T=1;T<x.length-8;++T)x[T]=0;T=this.o*8;for(var R=x.length-8;R<x.length;++R)x[R]=T&255,T/=256;for(this.v(x),x=Array(16),T=0,R=0;R<4;++R)for(let C=0;C<32;C+=8)x[T++]=this.g[R]>>>C&255;return x};function i(x,T){var R=a;return Object.prototype.hasOwnProperty.call(R,x)?R[x]:R[x]=T(x)}function o(x,T){this.h=T;const R=[];let C=!0;for(let D=x.length-1;D>=0;D--){const O=x[D]|0;C&&O==T||(R[D]=O,C=!1)}this.g=R}var a={};function l(x){return-128<=x&&x<128?i(x,function(T){return new o([T|0],T<0?-1:0)}):new o([x|0],x<0?-1:0)}function c(x){if(isNaN(x)||!isFinite(x))return h;if(x<0)return I(c(-x));const T=[];let R=1;for(let C=0;x>=R;C++)T[C]=x/R|0,R*=4294967296;return new o(T,0)}function u(x,T){if(x.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(x.charAt(0)=="-")return I(u(x.substring(1),T));if(x.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=c(Math.pow(T,8));let C=h;for(let O=0;O<x.length;O+=8){var D=Math.min(8,x.length-O);const k=parseInt(x.substring(O,O+D),T);D<8?(D=c(Math.pow(T,D)),C=C.j(D).add(c(k))):(C=C.j(R),C=C.add(c(k)))}return C}var h=l(0),f=l(1),m=l(16777216);t=o.prototype,t.m=function(){if(p(this))return-I(this).m();let x=0,T=1;for(let R=0;R<this.g.length;R++){const C=this.i(R);x+=(C>=0?C:4294967296+C)*T,T*=4294967296}return x},t.toString=function(x){if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(E(this))return"0";if(p(this))return"-"+I(this).toString(x);const T=c(Math.pow(x,6));var R=this;let C="";for(;;){const D=A(R,T).g;R=g(R,D.j(T));let O=((R.g.length>0?R.g[0]:R.h)>>>0).toString(x);if(R=D,E(R))return O+C;for(;O.length<6;)O="0"+O;C=O+C}},t.i=function(x){return x<0?0:x<this.g.length?this.g[x]:this.h};function E(x){if(x.h!=0)return!1;for(let T=0;T<x.g.length;T++)if(x.g[T]!=0)return!1;return!0}function p(x){return x.h==-1}t.l=function(x){return x=g(this,x),p(x)?-1:E(x)?0:1};function I(x){const T=x.g.length,R=[];for(let C=0;C<T;C++)R[C]=~x.g[C];return new o(R,~x.h).add(f)}t.abs=function(){return p(this)?I(this):this},t.add=function(x){const T=Math.max(this.g.length,x.g.length),R=[];let C=0;for(let D=0;D<=T;D++){let O=C+(this.i(D)&65535)+(x.i(D)&65535),k=(O>>>16)+(this.i(D)>>>16)+(x.i(D)>>>16);C=k>>>16,O&=65535,k&=65535,R[D]=k<<16|O}return new o(R,R[R.length-1]&-2147483648?-1:0)};function g(x,T){return x.add(I(T))}t.j=function(x){if(E(this)||E(x))return h;if(p(this))return p(x)?I(this).j(I(x)):I(I(this).j(x));if(p(x))return I(this.j(I(x)));if(this.l(m)<0&&x.l(m)<0)return c(this.m()*x.m());const T=this.g.length+x.g.length,R=[];for(var C=0;C<2*T;C++)R[C]=0;for(C=0;C<this.g.length;C++)for(let D=0;D<x.g.length;D++){const O=this.i(C)>>>16,k=this.i(C)&65535,B=x.i(D)>>>16,ce=x.i(D)&65535;R[2*C+2*D]+=k*ce,_(R,2*C+2*D),R[2*C+2*D+1]+=O*ce,_(R,2*C+2*D+1),R[2*C+2*D+1]+=k*B,_(R,2*C+2*D+1),R[2*C+2*D+2]+=O*B,_(R,2*C+2*D+2)}for(x=0;x<T;x++)R[x]=R[2*x+1]<<16|R[2*x];for(x=T;x<2*T;x++)R[x]=0;return new o(R,0)};function _(x,T){for(;(x[T]&65535)!=x[T];)x[T+1]+=x[T]>>>16,x[T]&=65535,T++}function w(x,T){this.g=x,this.h=T}function A(x,T){if(E(T))throw Error("division by zero");if(E(x))return new w(h,h);if(p(x))return T=A(I(x),T),new w(I(T.g),I(T.h));if(p(T))return T=A(x,I(T)),new w(I(T.g),T.h);if(x.g.length>30){if(p(x)||p(T))throw Error("slowDivide_ only works with positive integers.");for(var R=f,C=T;C.l(x)<=0;)R=P(R),C=P(C);var D=L(R,1),O=L(C,1);for(C=L(C,2),R=L(R,2);!E(C);){var k=O.add(C);k.l(x)<=0&&(D=D.add(R),O=k),C=L(C,1),R=L(R,1)}return T=g(x,D.j(T)),new w(D,T)}for(D=h;x.l(T)>=0;){for(R=Math.max(1,Math.floor(x.m()/T.m())),C=Math.ceil(Math.log(R)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),O=c(R),k=O.j(T);p(k)||k.l(x)>0;)R-=C,O=c(R),k=O.j(T);E(O)&&(O=f),D=D.add(O),x=g(x,k)}return new w(D,x)}t.B=function(x){return A(this,x).h},t.and=function(x){const T=Math.max(this.g.length,x.g.length),R=[];for(let C=0;C<T;C++)R[C]=this.i(C)&x.i(C);return new o(R,this.h&x.h)},t.or=function(x){const T=Math.max(this.g.length,x.g.length),R=[];for(let C=0;C<T;C++)R[C]=this.i(C)|x.i(C);return new o(R,this.h|x.h)},t.xor=function(x){const T=Math.max(this.g.length,x.g.length),R=[];for(let C=0;C<T;C++)R[C]=this.i(C)^x.i(C);return new o(R,this.h^x.h)};function P(x){const T=x.g.length+1,R=[];for(let C=0;C<T;C++)R[C]=x.i(C)<<1|x.i(C-1)>>>31;return new o(R,x.h)}function L(x,T){const R=T>>5;T%=32;const C=x.g.length-R,D=[];for(let O=0;O<C;O++)D[O]=T>0?x.i(O+R)>>>T|x.i(O+R+1)<<32-T:x.i(O+R);return new o(D,x.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,DD=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,ta=o}).apply(typeof VA<"u"?VA:typeof self<"u"?self:typeof window<"u"?window:{});var hm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var OD,jd,LD,Gm,xw,MD,VD,FD;(function(){var t,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof hm=="object"&&hm];for(var y=0;y<d.length;++y){var b=d[y];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var r=n(this);function s(d,y){if(y)e:{var b=r;d=d.split(".");for(var N=0;N<d.length-1;N++){var V=d[N];if(!(V in b))break e;b=b[V]}d=d[d.length-1],N=b[d],y=y(N),y!=N&&y!=null&&e(b,d,{configurable:!0,writable:!0,value:y})}}s("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(d){return d||function(y){var b=[],N;for(N in y)Object.prototype.hasOwnProperty.call(y,N)&&b.push([N,y[N]]);return b}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(d){var y=typeof d;return y=="object"&&d!=null||y=="function"}function l(d,y,b){return d.call.apply(d.bind,arguments)}function c(d,y,b){return c=l,c.apply(null,arguments)}function u(d,y){var b=Array.prototype.slice.call(arguments,1);return function(){var N=b.slice();return N.push.apply(N,arguments),d.apply(this,N)}}function h(d,y){function b(){}b.prototype=y.prototype,d.Z=y.prototype,d.prototype=new b,d.prototype.constructor=d,d.Ob=function(N,V,W){for(var ge=Array(arguments.length-2),et=2;et<arguments.length;et++)ge[et-2]=arguments[et];return y.prototype[V].apply(N,ge)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function m(d){const y=d.length;if(y>0){const b=Array(y);for(let N=0;N<y;N++)b[N]=d[N];return b}return[]}function E(d,y){for(let N=1;N<arguments.length;N++){const V=arguments[N];var b=typeof V;if(b=b!="object"?b:V?Array.isArray(V)?"array":b:"null",b=="array"||b=="object"&&typeof V.length=="number"){b=d.length||0;const W=V.length||0;d.length=b+W;for(let ge=0;ge<W;ge++)d[b+ge]=V[ge]}else d.push(V)}}class p{constructor(y,b){this.i=y,this.j=b,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function I(d){o.setTimeout(()=>{throw d},0)}function g(){var d=x;let y=null;return d.g&&(y=d.g,d.g=d.g.next,d.g||(d.h=null),y.next=null),y}class _{constructor(){this.h=this.g=null}add(y,b){const N=w.get();N.set(y,b),this.h?this.h.next=N:this.g=N,this.h=N}}var w=new p(()=>new A,d=>d.reset());class A{constructor(){this.next=this.g=this.h=null}set(y,b){this.h=y,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let P,L=!1,x=new _,T=()=>{const d=Promise.resolve(void 0);P=()=>{d.then(R)}};function R(){for(var d;d=g();){try{d.h.call(d.g)}catch(b){I(b)}var y=w;y.j(d),y.h<100&&(y.h++,d.next=y.g,y.g=d)}L=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(d,y){this.type=d,this.g=this.target=y,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var O=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,y=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const b=()=>{};o.addEventListener("test",b,y),o.removeEventListener("test",b,y)}catch{}return d}();function k(d){return/^[\s\xa0]*$/.test(d)}function B(d,y){D.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,y)}h(B,D),B.prototype.init=function(d,y){const b=this.type=d.type,N=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=y,y=d.relatedTarget,y||(b=="mouseover"?y=d.fromElement:b=="mouseout"&&(y=d.toElement)),this.relatedTarget=y,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&B.Z.h.call(this)},B.prototype.h=function(){B.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var ce="closure_listenable_"+(Math.random()*1e6|0),he=0;function Se(d,y,b,N,V){this.listener=d,this.proxy=null,this.src=y,this.type=b,this.capture=!!N,this.ha=V,this.key=++he,this.da=this.fa=!1}function $(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function q(d,y,b){for(const N in d)y.call(b,d[N],N,d)}function X(d,y){for(const b in d)y.call(void 0,d[b],b,d)}function we(d){const y={};for(const b in d)y[b]=d[b];return y}const Ie="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function re(d,y){let b,N;for(let V=1;V<arguments.length;V++){N=arguments[V];for(b in N)d[b]=N[b];for(let W=0;W<Ie.length;W++)b=Ie[W],Object.prototype.hasOwnProperty.call(N,b)&&(d[b]=N[b])}}function ve(d){this.src=d,this.g={},this.h=0}ve.prototype.add=function(d,y,b,N,V){const W=d.toString();d=this.g[W],d||(d=this.g[W]=[],this.h++);const ge=Ge(d,y,N,V);return ge>-1?(y=d[ge],b||(y.fa=!1)):(y=new Se(y,this.src,W,!!N,V),y.fa=b,d.push(y)),y};function j(d,y){const b=y.type;if(b in d.g){var N=d.g[b],V=Array.prototype.indexOf.call(N,y,void 0),W;(W=V>=0)&&Array.prototype.splice.call(N,V,1),W&&($(y),d.g[b].length==0&&(delete d.g[b],d.h--))}}function Ge(d,y,b,N){for(let V=0;V<d.length;++V){const W=d[V];if(!W.da&&W.listener==y&&W.capture==!!b&&W.ha==N)return V}return-1}var Fe="closure_lm_"+(Math.random()*1e6|0),Pn={};function zn(d,y,b,N,V){if(Array.isArray(y)){for(let W=0;W<y.length;W++)zn(d,y[W],b,N,V);return null}return b=Wn(b),d&&d[ce]?d.J(y,b,a(N)?!!N.capture:!1,V):En(d,y,b,!1,N,V)}function En(d,y,b,N,V,W){if(!y)throw Error("Invalid event type");const ge=a(V)?!!V.capture:!!V;let et=cr(d);if(et||(d[Fe]=et=new ve(d)),b=et.add(y,b,N,ge,W),b.proxy)return b;if(N=In(),b.proxy=N,N.src=d,N.listener=b,d.addEventListener)O||(V=ge),V===void 0&&(V=!1),d.addEventListener(y.toString(),N,V);else if(d.attachEvent)d.attachEvent(ft(y.toString()),N);else if(d.addListener&&d.removeListener)d.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return b}function In(){function d(b){return y.call(d.src,d.listener,b)}const y=at;return d}function Cn(d,y,b,N,V){if(Array.isArray(y))for(var W=0;W<y.length;W++)Cn(d,y[W],b,N,V);else N=a(N)?!!N.capture:!!N,b=Wn(b),d&&d[ce]?(d=d.i,W=String(y).toString(),W in d.g&&(y=d.g[W],b=Ge(y,b,N,V),b>-1&&($(y[b]),Array.prototype.splice.call(y,b,1),y.length==0&&(delete d.g[W],d.h--)))):d&&(d=cr(d))&&(y=d.g[y.toString()],d=-1,y&&(d=Ge(y,b,N,V)),(b=d>-1?y[d]:null)&&kt(b))}function kt(d){if(typeof d!="number"&&d&&!d.da){var y=d.src;if(y&&y[ce])j(y.i,d);else{var b=d.type,N=d.proxy;y.removeEventListener?y.removeEventListener(b,N,d.capture):y.detachEvent?y.detachEvent(ft(b),N):y.addListener&&y.removeListener&&y.removeListener(N),(b=cr(y))?(j(b,d),b.h==0&&(b.src=null,y[Fe]=null)):$(d)}}}function ft(d){return d in Pn?Pn[d]:Pn[d]="on"+d}function at(d,y){if(d.da)d=!0;else{y=new B(y,this);const b=d.listener,N=d.ha||d.src;d.fa&&kt(d),d=b.call(N,y)}return d}function cr(d){return d=d[Fe],d instanceof ve?d:null}var _r="__closure_events_fn_"+(Math.random()*1e9>>>0);function Wn(d){return typeof d=="function"?d:(d[_r]||(d[_r]=function(y){return d.handleEvent(y)}),d[_r])}function mt(){C.call(this),this.i=new ve(this),this.M=this,this.G=null}h(mt,C),mt.prototype[ce]=!0,mt.prototype.removeEventListener=function(d,y,b,N){Cn(this,d,y,b,N)};function Zt(d,y){var b,N=d.G;if(N)for(b=[];N;N=N.G)b.push(N);if(d=d.M,N=y.type||y,typeof y=="string")y=new D(y,d);else if(y instanceof D)y.target=y.target||d;else{var V=y;y=new D(N,d),re(y,V)}V=!0;let W,ge;if(b)for(ge=b.length-1;ge>=0;ge--)W=y.g=b[ge],V=wr(W,N,!0,y)&&V;if(W=y.g=d,V=wr(W,N,!0,y)&&V,V=wr(W,N,!1,y)&&V,b)for(ge=0;ge<b.length;ge++)W=y.g=b[ge],V=wr(W,N,!1,y)&&V}mt.prototype.N=function(){if(mt.Z.N.call(this),this.i){var d=this.i;for(const y in d.g){const b=d.g[y];for(let N=0;N<b.length;N++)$(b[N]);delete d.g[y],d.h--}}this.G=null},mt.prototype.J=function(d,y,b,N){return this.i.add(String(d),y,!1,b,N)},mt.prototype.K=function(d,y,b,N){return this.i.add(String(d),y,!0,b,N)};function wr(d,y,b,N){if(y=d.i.g[String(y)],!y)return!0;y=y.concat();let V=!0;for(let W=0;W<y.length;++W){const ge=y[W];if(ge&&!ge.da&&ge.capture==b){const et=ge.listener,Ln=ge.ha||ge.src;ge.fa&&j(d.i,ge),V=et.call(Ln,N)!==!1&&V}}return V&&!N.defaultPrevented}function no(d,y){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=c(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:o.setTimeout(d,y||0)}function Pr(d){d.g=no(()=>{d.g=null,d.i&&(d.i=!1,Pr(d))},d.l);const y=d.h;d.h=null,d.m.apply(null,y)}class Ca extends C{constructor(y,b){super(),this.m=y,this.l=b,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Pr(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ws(d){C.call(this),this.h=d,this.g={}}h(ws,C);var kn=[];function cs(d){q(d.g,function(y,b){this.g.hasOwnProperty(b)&&kt(y)},d),d.g={}}ws.prototype.N=function(){ws.Z.N.call(this),cs(this)},ws.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ka=o.JSON.stringify,ro=o.JSON.parse,en=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function Na(){}function so(){}var Cr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function us(){D.call(this,"d")}h(us,D);function Ii(){D.call(this,"c")}h(Ii,D);var tr={},K=null;function z(){return K=K||new mt}tr.Ia="serverreachability";function H(d){D.call(this,tr.Ia,d)}h(H,D);function ie(d){const y=z();Zt(y,new H(y))}tr.STAT_EVENT="statevent";function Z(d,y){D.call(this,tr.STAT_EVENT,d),this.stat=y}h(Z,D);function te(d){const y=z();Zt(y,new Z(y,d))}tr.Ja="timingevent";function de(d,y){D.call(this,tr.Ja,d),this.size=y}h(de,D);function ye(d,y){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},y)}function Q(){this.g=!0}Q.prototype.ua=function(){this.g=!1};function oe(d,y,b,N,V,W){d.info(function(){if(d.g)if(W){var ge="",et=W.split("&");for(let Dt=0;Dt<et.length;Dt++){var Ln=et[Dt].split("=");if(Ln.length>1){const Hn=Ln[0];Ln=Ln[1];const Hs=Hn.split("_");ge=Hs.length>=2&&Hs[1]=="type"?ge+(Hn+"="+Ln+"&"):ge+(Hn+"=redacted&")}}}else ge=null;else ge=W;return"XMLHTTP REQ ("+N+") [attempt "+V+"]: "+y+`
`+b+`
`+ge})}function se(d,y,b,N,V,W,ge){d.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+V+"]: "+y+`
`+b+`
`+W+" "+ge})}function ae(d,y,b,N){d.info(function(){return"XMLHTTP TEXT ("+y+"): "+_e(d,b)+(N?" "+N:"")})}function ue(d,y){d.info(function(){return"TIMEOUT: "+y})}Q.prototype.info=function(){};function _e(d,y){if(!d.g)return y;if(!y)return null;try{const W=JSON.parse(y);if(W){for(d=0;d<W.length;d++)if(Array.isArray(W[d])){var b=W[d];if(!(b.length<2)){var N=b[1];if(Array.isArray(N)&&!(N.length<1)){var V=N[0];if(V!="noop"&&V!="stop"&&V!="close")for(let ge=1;ge<N.length;ge++)N[ge]=""}}}}return ka(W)}catch{return y}}var me={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Me={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ze;function Tn(){}h(Tn,Na),Tn.prototype.g=function(){return new XMLHttpRequest},ze=new Tn;function Nn(d){return encodeURIComponent(String(d))}function nt(d){var y=1;d=d.split(":");const b=[];for(;y>0&&d.length;)b.push(d.shift()),y--;return d.length&&b.push(d.join(":")),b}function $e(d,y,b,N){this.j=d,this.i=y,this.l=b,this.S=N||1,this.V=new ws(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ne}function Ne(){this.i=null,this.g="",this.h=!1}var nr={},yt={};function Rt(d,y,b){d.M=1,d.A=Ze(hn(y)),d.u=b,d.R=!0,Tt(d,null)}function Tt(d,y){d.F=Date.now(),lt(d),d.B=hn(d.A);var b=d.B,N=d.S;Array.isArray(N)||(N=[String(N)]),PT(b.i,"t",N),d.C=0,b=d.j.L,d.h=new Ne,d.g=KT(d.j,b?y:null,!d.u),d.P>0&&(d.O=new Ca(c(d.Y,d,d.g),d.P)),y=d.V,b=d.g,N=d.ba;var V="readystatechange";Array.isArray(V)||(V&&(kn[0]=V.toString()),V=kn);for(let W=0;W<V.length;W++){const ge=zn(b,V[W],N||y.handleEvent,!1,y.h||y);if(!ge)break;y.g[ge.key]=ge}y=d.J?we(d.J):{},d.u?(d.v||(d.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,y)):(d.v="GET",d.g.ea(d.B,d.v,null,y)),ie(),oe(d.i,d.v,d.B,d.l,d.S,d.u)}$e.prototype.ba=function(d){d=d.target;const y=this.O;y&&oo(d)==3?y.j():this.Y(d)},$e.prototype.Y=function(d){try{if(d==this.g)e:{const et=oo(this.g),Ln=this.g.ya(),Dt=this.g.ca();if(!(et<3)&&(et!=3||this.g&&(this.h.h||this.g.la()||MT(this.g)))){this.K||et!=4||Ln==7||(Ln==8||Dt<=0?ie(3):ie(2)),Wt(this);var y=this.g.ca();this.X=y;var b=He(this);if(this.o=y==200,se(this.i,this.v,this.B,this.l,this.S,et,y),this.o){if(this.U&&!this.L){t:{if(this.g){var N,V=this.g;if((N=V.g?V.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(N)){var W=N;break t}}W=null}if(d=W)ae(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,be(this,d);else{this.o=!1,this.m=3,te(12),Sn(this),Nt(this);break e}}if(this.R){d=!0;let Hn;for(;!this.K&&this.C<b.length;)if(Hn=xe(this,b),Hn==yt){et==4&&(this.m=4,te(14),d=!1),ae(this.i,this.l,null,"[Incomplete Response]");break}else if(Hn==nr){this.m=4,te(15),ae(this.i,this.l,b,"[Invalid Chunk]"),d=!1;break}else ae(this.i,this.l,Hn,null),be(this,Hn);if(rt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),et!=4||b.length!=0||this.h.h||(this.m=1,te(16),d=!1),this.o=this.o&&d,!d)ae(this.i,this.l,b,"[Invalid Chunked Response]"),Sn(this),Nt(this);else if(b.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+b.length),jy(ge),ge.P=!0,te(11))}}else ae(this.i,this.l,b,null),be(this,b);et==4&&Sn(this),this.o&&!this.K&&(et==4?zT(this.j,this):(this.o=!1,lt(this)))}else wV(this.g),y==400&&b.indexOf("Unknown SID")>0?(this.m=3,te(12)):(this.m=0,te(13)),Sn(this),Nt(this)}}}catch{}finally{}};function He(d){if(!rt(d))return d.g.la();const y=MT(d.g);if(y==="")return"";let b="";const N=y.length,V=oo(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Sn(d),Nt(d),"";d.h.i=new o.TextDecoder}for(let W=0;W<N;W++)d.h.h=!0,b+=d.h.i.decode(y[W],{stream:!(V&&W==N-1)});return y.length=0,d.h.g+=b,d.C=0,d.h.g}function rt(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function xe(d,y){var b=d.C,N=y.indexOf(`
`,b);return N==-1?yt:(b=Number(y.substring(b,N)),isNaN(b)?nr:(N+=1,N+b>y.length?yt:(y=y.slice(N,N+b),d.C=N+b,y)))}$e.prototype.cancel=function(){this.K=!0,Sn(this)};function lt(d){d.T=Date.now()+d.H,tn(d,d.H)}function tn(d,y){if(d.D!=null)throw Error("WatchDog timer not null");d.D=ye(c(d.aa,d),y)}function Wt(d){d.D&&(o.clearTimeout(d.D),d.D=null)}$e.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(ue(this.i,this.B),this.M!=2&&(ie(),te(17)),Sn(this),this.m=2,Nt(this)):tn(this,this.T-d)};function Nt(d){d.j.I==0||d.K||zT(d.j,d)}function Sn(d){Wt(d);var y=d.O;y&&typeof y.dispose=="function"&&y.dispose(),d.O=null,cs(d.V),d.g&&(y=d.g,d.g=null,y.abort(),y.dispose())}function be(d,y){try{var b=d.j;if(b.I!=0&&(b.g==d||We(b.h,d))){if(!d.L&&We(b.h,d)&&b.I==3){try{var N=b.Ba.g.parse(y)}catch{N=null}if(Array.isArray(N)&&N.length==3){var V=N;if(V[0]==0){e:if(!b.v){if(b.g)if(b.g.F+3e3<d.F)Ff(b),Mf(b);else break e;Uy(b),te(18)}}else b.xa=V[1],0<b.xa-b.K&&V[2]<37500&&b.F&&b.A==0&&!b.C&&(b.C=ye(c(b.Va,b),6e3));wt(b.h)<=1&&b.ta&&(b.ta=void 0)}else Oa(b,11)}else if((d.L||b.g==d)&&Ff(b),!k(y))for(V=b.Ba.g.parse(y),y=0;y<V.length;y++){let Dt=V[y];const Hn=Dt[0];if(!(Hn<=b.K))if(b.K=Hn,Dt=Dt[1],b.I==2)if(Dt[0]=="c"){b.M=Dt[1],b.ba=Dt[2];const Hs=Dt[3];Hs!=null&&(b.ka=Hs,b.j.info("VER="+b.ka));const La=Dt[4];La!=null&&(b.za=La,b.j.info("SVER="+b.za));const ao=Dt[5];ao!=null&&typeof ao=="number"&&ao>0&&(N=1.5*ao,b.O=N,b.j.info("backChannelRequestTimeoutMs_="+N)),N=b;const lo=d.g;if(lo){const jf=lo.g?lo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(jf){var W=N.h;W.g||jf.indexOf("spdy")==-1&&jf.indexOf("quic")==-1&&jf.indexOf("h2")==-1||(W.j=W.l,W.g=new Set,W.h&&(dn(W,W.h),W.h=null))}if(N.G){const $y=lo.g?lo.g.getResponseHeader("X-HTTP-Session-Id"):null;$y&&(N.wa=$y,ut(N.J,N.G,$y))}}b.I=3,b.l&&b.l.ra(),b.aa&&(b.T=Date.now()-d.F,b.j.info("Handshake RTT: "+b.T+"ms")),N=b;var ge=d;if(N.na=HT(N,N.L?N.ba:null,N.W),ge.L){Dn(N.h,ge);var et=ge,Ln=N.O;Ln&&(et.H=Ln),et.D&&(Wt(et),lt(et)),N.g=ge}else $T(N);b.i.length>0&&Vf(b)}else Dt[0]!="stop"&&Dt[0]!="close"||Oa(b,7);else b.I==3&&(Dt[0]=="stop"||Dt[0]=="close"?Dt[0]=="stop"?Oa(b,7):Fy(b):Dt[0]!="noop"&&b.l&&b.l.qa(Dt),b.A=0)}}ie(4)}catch{}}var Qe=class{constructor(d,y){this.g=d,this.map=y}};function Ye(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function It(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function wt(d){return d.h?1:d.g?d.g.size:0}function We(d,y){return d.h?d.h==y:d.g?d.g.has(y):!1}function dn(d,y){d.g?d.g.add(y):d.h=y}function Dn(d,y){d.h&&d.h==y?d.h=null:d.g&&d.g.has(y)&&d.g.delete(y)}Ye.prototype.cancel=function(){if(this.i=qn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function qn(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let y=d.i;for(const b of d.g.values())y=y.concat(b.G);return y}return m(d.i)}var Je=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nn(d,y){if(d){d=d.split("&");for(let b=0;b<d.length;b++){const N=d[b].indexOf("=");let V,W=null;N>=0?(V=d[b].substring(0,N),W=d[b].substring(N+1)):V=d[b],y(V,W?decodeURIComponent(W.replace(/\+/g," ")):"")}}}function rn(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;d instanceof rn?(this.l=d.l,kr(this,d.j),this.o=d.o,this.g=d.g,On(this,d.u),this.h=d.h,bn(this,CT(d.i)),this.m=d.m):d&&(y=String(d).match(Je))?(this.l=!1,kr(this,y[1]||"",!0),this.o=Nr(y[2]||""),this.g=Nr(y[3]||"",!0),On(this,y[4]),this.h=Nr(y[5]||"",!0),bn(this,y[6]||"",!0),this.m=Nr(y[7]||"")):(this.l=!1,this.i=new ud(null,this.l))}rn.prototype.toString=function(){const d=[];var y=this.j;y&&d.push(cd(y,bT,!0),":");var b=this.g;return(b||y=="file")&&(d.push("//"),(y=this.o)&&d.push(cd(y,bT,!0),"@"),d.push(Nn(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.u,b!=null&&d.push(":",String(b))),(b=this.h)&&(this.g&&b.charAt(0)!="/"&&d.push("/"),d.push(cd(b,b.charAt(0)=="/"?dV:uV,!0))),(b=this.i.toString())&&d.push("?",b),(b=this.m)&&d.push("#",cd(b,fV)),d.join("")},rn.prototype.resolve=function(d){const y=hn(this);let b=!!d.j;b?kr(y,d.j):b=!!d.o,b?y.o=d.o:b=!!d.g,b?y.g=d.g:b=d.u!=null;var N=d.h;if(b)On(y,d.u);else if(b=!!d.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var V=y.h.lastIndexOf("/");V!=-1&&(N=y.h.slice(0,V+1)+N)}if(V=N,V==".."||V==".")N="";else if(V.indexOf("./")!=-1||V.indexOf("/.")!=-1){N=V.lastIndexOf("/",0)==0,V=V.split("/");const W=[];for(let ge=0;ge<V.length;){const et=V[ge++];et=="."?N&&ge==V.length&&W.push(""):et==".."?((W.length>1||W.length==1&&W[0]!="")&&W.pop(),N&&ge==V.length&&W.push("")):(W.push(et),N=!0)}N=W.join("/")}else N=V}return b?y.h=N:b=d.i.toString()!=="",b?bn(y,CT(d.i)):b=!!d.m,b&&(y.m=d.m),y};function hn(d){return new rn(d)}function kr(d,y,b){d.j=b?Nr(y,!0):y,d.j&&(d.j=d.j.replace(/:$/,""))}function On(d,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);d.u=y}else d.u=null}function bn(d,y,b){y instanceof ud?(d.i=y,mV(d.i,d.l)):(b||(y=cd(y,hV)),d.i=new ud(y,d.l))}function ut(d,y,b){d.i.set(y,b)}function Ze(d){return ut(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Nr(d,y){return d?y?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function cd(d,y,b){return typeof d=="string"?(d=encodeURI(d).replace(y,cV),b&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function cV(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var bT=/[#\/\?@]/g,uV=/[#\?:]/g,dV=/[#\?]/g,hV=/[#\?@]/g,fV=/#/g;function ud(d,y){this.h=this.g=null,this.i=d||null,this.j=!!y}function Da(d){d.g||(d.g=new Map,d.h=0,d.i&&nn(d.i,function(y,b){d.add(decodeURIComponent(y.replace(/\+/g," ")),b)}))}t=ud.prototype,t.add=function(d,y){Da(this),this.i=null,d=Gl(this,d);let b=this.g.get(d);return b||this.g.set(d,b=[]),b.push(y),this.h+=1,this};function AT(d,y){Da(d),y=Gl(d,y),d.g.has(y)&&(d.i=null,d.h-=d.g.get(y).length,d.g.delete(y))}function xT(d,y){return Da(d),y=Gl(d,y),d.g.has(y)}t.forEach=function(d,y){Da(this),this.g.forEach(function(b,N){b.forEach(function(V){d.call(y,V,N,this)},this)},this)};function RT(d,y){Da(d);let b=[];if(typeof y=="string")xT(d,y)&&(b=b.concat(d.g.get(Gl(d,y))));else for(d=Array.from(d.g.values()),y=0;y<d.length;y++)b=b.concat(d[y]);return b}t.set=function(d,y){return Da(this),this.i=null,d=Gl(this,d),xT(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[y]),this.h+=1,this},t.get=function(d,y){return d?(d=RT(this,d),d.length>0?String(d[0]):y):y};function PT(d,y,b){AT(d,y),b.length>0&&(d.i=null,d.g.set(Gl(d,y),m(b)),d.h+=b.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],y=Array.from(this.g.keys());for(let N=0;N<y.length;N++){var b=y[N];const V=Nn(b);b=RT(this,b);for(let W=0;W<b.length;W++){let ge=V;b[W]!==""&&(ge+="="+Nn(b[W])),d.push(ge)}}return this.i=d.join("&")};function CT(d){const y=new ud;return y.i=d.i,d.g&&(y.g=new Map(d.g),y.h=d.h),y}function Gl(d,y){return y=String(y),d.j&&(y=y.toLowerCase()),y}function mV(d,y){y&&!d.j&&(Da(d),d.i=null,d.g.forEach(function(b,N){const V=N.toLowerCase();N!=V&&(AT(this,N),PT(this,V,b))},d)),d.j=y}function pV(d,y){const b=new Q;if(o.Image){const N=new Image;N.onload=u(io,b,"TestLoadImage: loaded",!0,y,N),N.onerror=u(io,b,"TestLoadImage: error",!1,y,N),N.onabort=u(io,b,"TestLoadImage: abort",!1,y,N),N.ontimeout=u(io,b,"TestLoadImage: timeout",!1,y,N),o.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=d}else y(!1)}function gV(d,y){const b=new Q,N=new AbortController,V=setTimeout(()=>{N.abort(),io(b,"TestPingServer: timeout",!1,y)},1e4);fetch(d,{signal:N.signal}).then(W=>{clearTimeout(V),W.ok?io(b,"TestPingServer: ok",!0,y):io(b,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(V),io(b,"TestPingServer: error",!1,y)})}function io(d,y,b,N,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),N(b)}catch{}}function yV(){this.g=new en}function My(d){this.i=d.Sb||null,this.h=d.ab||!1}h(My,Na),My.prototype.g=function(){return new Of(this.i,this.h)};function Of(d,y){mt.call(this),this.H=d,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(Of,mt),t=Of.prototype,t.open=function(d,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=y,this.readyState=1,hd(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(y.body=d),(this.H||o).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,dd(this)),this.readyState=0},t.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,hd(this)),this.g&&(this.readyState=3,hd(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;kT(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function kT(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}t.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var y=d.value?d.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!d.done}))&&(this.response=this.responseText+=y)}d.done?dd(this):hd(this),this.readyState==3&&kT(this)}},t.Oa=function(d){this.g&&(this.response=this.responseText=d,dd(this))},t.Na=function(d){this.g&&(this.response=d,dd(this))},t.ga=function(){this.g&&dd(this)};function dd(d){d.readyState=4,d.l=null,d.j=null,d.B=null,hd(d)}t.setRequestHeader=function(d,y){this.A.append(d,y)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],y=this.h.entries();for(var b=y.next();!b.done;)b=b.value,d.push(b[0]+": "+b[1]),b=y.next();return d.join(`\r
`)};function hd(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Of.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function NT(d){let y="";return q(d,function(b,N){y+=N,y+=":",y+=b,y+=`\r
`}),y}function Vy(d,y,b){e:{for(N in b){var N=!1;break e}N=!0}N||(b=NT(b),typeof d=="string"?b!=null&&Nn(b):ut(d,y,b))}function fn(d){mt.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(fn,mt);var vV=/^https?$/i,_V=["POST","PUT"];t=fn.prototype,t.Fa=function(d){this.H=d},t.ea=function(d,y,b,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);y=y?y.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ze.g(),this.g.onreadystatechange=f(c(this.Ca,this));try{this.B=!0,this.g.open(y,String(d),!0),this.B=!1}catch(W){DT(this,W);return}if(d=b||"",b=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var V in N)b.set(V,N[V]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const W of N.keys())b.set(W,N.get(W));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(b.keys()).find(W=>W.toLowerCase()=="content-type"),V=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(_V,y,void 0)>=0)||N||V||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[W,ge]of b)this.g.setRequestHeader(W,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(W){DT(this,W)}};function DT(d,y){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=y,d.o=5,OT(d),Lf(d)}function OT(d){d.A||(d.A=!0,Zt(d,"complete"),Zt(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Zt(this,"complete"),Zt(this,"abort"),Lf(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Lf(this,!0)),fn.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?LT(this):this.Xa())},t.Xa=function(){LT(this)};function LT(d){if(d.h&&typeof i<"u"){if(d.v&&oo(d)==4)setTimeout(d.Ca.bind(d),0);else if(Zt(d,"readystatechange"),oo(d)==4){d.h=!1;try{const W=d.ca();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var b;if(!(b=y)){var N;if(N=W===0){let ge=String(d.D).match(Je)[1]||null;!ge&&o.self&&o.self.location&&(ge=o.self.location.protocol.slice(0,-1)),N=!vV.test(ge?ge.toLowerCase():"")}b=N}if(b)Zt(d,"complete"),Zt(d,"success");else{d.o=6;try{var V=oo(d)>2?d.g.statusText:""}catch{V=""}d.l=V+" ["+d.ca()+"]",OT(d)}}finally{Lf(d)}}}}function Lf(d,y){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const b=d.g;d.g=null,y||Zt(d,"ready");try{b.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function oo(d){return d.g?d.g.readyState:0}t.ca=function(){try{return oo(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(d){if(this.g){var y=this.g.responseText;return d&&y.indexOf(d)==0&&(y=y.substring(d.length)),ro(y)}};function MT(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function wV(d){const y={};d=(d.g&&oo(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<d.length;N++){if(k(d[N]))continue;var b=nt(d[N]);const V=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const W=y[V]||[];y[V]=W,W.push(b)}X(y,function(N){return N.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function fd(d,y,b){return b&&b.internalChannelParams&&b.internalChannelParams[d]||y}function VT(d){this.za=0,this.i=[],this.j=new Q,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=fd("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=fd("baseRetryDelayMs",5e3,d),this.Za=fd("retryDelaySeedMs",1e4,d),this.Ta=fd("forwardChannelMaxRetries",2,d),this.va=fd("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new Ye(d&&d.concurrentRequestLimit),this.Ba=new yV,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=VT.prototype,t.ka=8,t.I=1,t.connect=function(d,y,b,N){te(0),this.W=d,this.H=y||{},b&&N!==void 0&&(this.H.OSID=b,this.H.OAID=N),this.F=this.X,this.J=HT(this,null,this.W),Vf(this)};function Fy(d){if(FT(d),d.I==3){var y=d.V++,b=hn(d.J);if(ut(b,"SID",d.M),ut(b,"RID",y),ut(b,"TYPE","terminate"),md(d,b),y=new $e(d,d.j,y),y.M=2,y.A=Ze(hn(b)),b=!1,o.navigator&&o.navigator.sendBeacon)try{b=o.navigator.sendBeacon(y.A.toString(),"")}catch{}!b&&o.Image&&(new Image().src=y.A,b=!0),b||(y.g=KT(y.j,null),y.g.ea(y.A)),y.F=Date.now(),lt(y)}qT(d)}function Mf(d){d.g&&(jy(d),d.g.cancel(),d.g=null)}function FT(d){Mf(d),d.v&&(o.clearTimeout(d.v),d.v=null),Ff(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function Vf(d){if(!It(d.h)&&!d.m){d.m=!0;var y=d.Ea;P||T(),L||(P(),L=!0),x.add(y,d),d.D=0}}function EV(d,y){return wt(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=y.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=ye(c(d.Ea,d,y),WT(d,d.D)),d.D++,!0)}t.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const V=new $e(this,this.j,d);let W=this.o;if(this.U&&(W?(W=we(W),re(W,this.U)):W=this.U),this.u!==null||this.R||(V.J=W,W=null),this.S)e:{for(var y=0,b=0;b<this.i.length;b++){t:{var N=this.i[b];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(y+=N,y>4096){y=b;break e}if(y===4096||b===this.i.length-1){y=b+1;break e}}y=1e3}else y=1e3;y=jT(this,V,y),b=hn(this.J),ut(b,"RID",d),ut(b,"CVER",22),this.G&&ut(b,"X-HTTP-Session-Id",this.G),md(this,b),W&&(this.R?y="headers="+Nn(NT(W))+"&"+y:this.u&&Vy(b,this.u,W)),dn(this.h,V),this.Ra&&ut(b,"TYPE","init"),this.S?(ut(b,"$req",y),ut(b,"SID","null"),V.U=!0,Rt(V,b,null)):Rt(V,b,y),this.I=2}}else this.I==3&&(d?UT(this,d):this.i.length==0||It(this.h)||UT(this))};function UT(d,y){var b;y?b=y.l:b=d.V++;const N=hn(d.J);ut(N,"SID",d.M),ut(N,"RID",b),ut(N,"AID",d.K),md(d,N),d.u&&d.o&&Vy(N,d.u,d.o),b=new $e(d,d.j,b,d.D+1),d.u===null&&(b.J=d.o),y&&(d.i=y.G.concat(d.i)),y=jT(d,b,1e3),b.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),dn(d.h,b),Rt(b,N,y)}function md(d,y){d.H&&q(d.H,function(b,N){ut(y,N,b)}),d.l&&q({},function(b,N){ut(y,N,b)})}function jT(d,y,b){b=Math.min(d.i.length,b);const N=d.l?c(d.l.Ka,d.l,d):null;e:{var V=d.i;let et=-1;for(;;){const Ln=["count="+b];et==-1?b>0?(et=V[0].g,Ln.push("ofs="+et)):et=0:Ln.push("ofs="+et);let Dt=!0;for(let Hn=0;Hn<b;Hn++){var W=V[Hn].g;const Hs=V[Hn].map;if(W-=et,W<0)et=Math.max(0,V[Hn].g-100),Dt=!1;else try{W="req"+W+"_"||"";try{var ge=Hs instanceof Map?Hs:Object.entries(Hs);for(const[La,ao]of ge){let lo=ao;a(ao)&&(lo=ka(ao)),Ln.push(W+La+"="+encodeURIComponent(lo))}}catch(La){throw Ln.push(W+"type="+encodeURIComponent("_badmap")),La}}catch{N&&N(Hs)}}if(Dt){ge=Ln.join("&");break e}}ge=void 0}return d=d.i.splice(0,b),y.G=d,ge}function $T(d){if(!d.g&&!d.v){d.Y=1;var y=d.Da;P||T(),L||(P(),L=!0),x.add(y,d),d.A=0}}function Uy(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=ye(c(d.Da,d),WT(d,d.A)),d.A++,!0)}t.Da=function(){if(this.v=null,BT(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=ye(c(this.Wa,this),d)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,te(10),Mf(this),BT(this))};function jy(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function BT(d){d.g=new $e(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var y=hn(d.na);ut(y,"RID","rpc"),ut(y,"SID",d.M),ut(y,"AID",d.K),ut(y,"CI",d.F?"0":"1"),!d.F&&d.ia&&ut(y,"TO",d.ia),ut(y,"TYPE","xmlhttp"),md(d,y),d.u&&d.o&&Vy(y,d.u,d.o),d.O&&(d.g.H=d.O);var b=d.g;d=d.ba,b.M=1,b.A=Ze(hn(y)),b.u=null,b.R=!0,Tt(b,d)}t.Va=function(){this.C!=null&&(this.C=null,Mf(this),Uy(this),te(19))};function Ff(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function zT(d,y){var b=null;if(d.g==y){Ff(d),jy(d),d.g=null;var N=2}else if(We(d.h,y))b=y.G,Dn(d.h,y),N=1;else return;if(d.I!=0){if(y.o)if(N==1){b=y.u?y.u.length:0,y=Date.now()-y.F;var V=d.D;N=z(),Zt(N,new de(N,b)),Vf(d)}else $T(d);else if(V=y.m,V==3||V==0&&y.X>0||!(N==1&&EV(d,y)||N==2&&Uy(d)))switch(b&&b.length>0&&(y=d.h,y.i=y.i.concat(b)),V){case 1:Oa(d,5);break;case 4:Oa(d,10);break;case 3:Oa(d,6);break;default:Oa(d,2)}}}function WT(d,y){let b=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(b*=2),b*y}function Oa(d,y){if(d.j.info("Error code "+y),y==2){var b=c(d.bb,d),N=d.Ua;const V=!N;N=new rn(N||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||kr(N,"https"),Ze(N),V?pV(N.toString(),b):gV(N.toString(),b)}else te(2);d.I=0,d.l&&d.l.pa(y),qT(d),FT(d)}t.bb=function(d){d?(this.j.info("Successfully pinged google.com"),te(2)):(this.j.info("Failed to ping google.com"),te(1))};function qT(d){if(d.I=0,d.ja=[],d.l){const y=qn(d.h);(y.length!=0||d.i.length!=0)&&(E(d.ja,y),E(d.ja,d.i),d.h.i.length=0,m(d.i),d.i.length=0),d.l.oa()}}function HT(d,y,b){var N=b instanceof rn?hn(b):new rn(b);if(N.g!="")y&&(N.g=y+"."+N.g),On(N,N.u);else{var V=o.location;N=V.protocol,y=y?y+"."+V.hostname:V.hostname,V=+V.port;const W=new rn(null);N&&kr(W,N),y&&(W.g=y),V&&On(W,V),b&&(W.h=b),N=W}return b=d.G,y=d.wa,b&&y&&ut(N,b,y),ut(N,"VER",d.ka),md(d,N),N}function KT(d,y,b){if(y&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=d.Aa&&!d.ma?new fn(new My({ab:b})):new fn(d.ma),y.Fa(d.L),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function GT(){}t=GT.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Uf(){}Uf.prototype.g=function(d,y){return new Gr(d,y)};function Gr(d,y){mt.call(this),this.g=new VT(y),this.l=d,this.h=y&&y.messageUrlParams||null,d=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(d?d["X-WebChannel-Content-Type"]=y.messageContentType:d={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(d?d["X-WebChannel-Client-Profile"]=y.sa:d={"X-WebChannel-Client-Profile":y.sa}),this.g.U=d,(d=y&&y.Qb)&&!k(d)&&(this.g.u=d),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!k(y)&&(this.g.G=y,d=this.h,d!==null&&y in d&&(d=this.h,y in d&&delete d[y])),this.j=new Ql(this)}h(Gr,mt),Gr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Gr.prototype.close=function(){Fy(this.g)},Gr.prototype.o=function(d){var y=this.g;if(typeof d=="string"){var b={};b.__data__=d,d=b}else this.v&&(b={},b.__data__=ka(d),d=b);y.i.push(new Qe(y.Ya++,d)),y.I==3&&Vf(y)},Gr.prototype.N=function(){this.g.l=null,delete this.j,Fy(this.g),delete this.g,Gr.Z.N.call(this)};function QT(d){us.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var y=d.__sm__;if(y){e:{for(const b in y){d=b;break e}d=void 0}(this.i=d)&&(d=this.i,y=y!==null&&d in y?y[d]:void 0),this.data=y}else this.data=d}h(QT,us);function YT(){Ii.call(this),this.status=1}h(YT,Ii);function Ql(d){this.g=d}h(Ql,GT),Ql.prototype.ra=function(){Zt(this.g,"a")},Ql.prototype.qa=function(d){Zt(this.g,new QT(d))},Ql.prototype.pa=function(d){Zt(this.g,new YT)},Ql.prototype.oa=function(){Zt(this.g,"b")},Uf.prototype.createWebChannel=Uf.prototype.g,Gr.prototype.send=Gr.prototype.o,Gr.prototype.open=Gr.prototype.m,Gr.prototype.close=Gr.prototype.close,FD=function(){return new Uf},VD=function(){return z()},MD=tr,xw={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},me.NO_ERROR=0,me.TIMEOUT=8,me.HTTP_ERROR=6,Gm=me,Me.COMPLETE="complete",LD=Me,so.EventType=Cr,Cr.OPEN="a",Cr.CLOSE="b",Cr.ERROR="c",Cr.MESSAGE="d",mt.prototype.listen=mt.prototype.J,jd=so,fn.prototype.listenOnce=fn.prototype.K,fn.prototype.getLastError=fn.prototype.Ha,fn.prototype.getLastErrorCode=fn.prototype.ya,fn.prototype.getStatus=fn.prototype.ca,fn.prototype.getResponseJson=fn.prototype.La,fn.prototype.getResponseText=fn.prototype.la,fn.prototype.send=fn.prototype.ea,fn.prototype.setWithCredentials=fn.prototype.Fa,OD=fn}).apply(typeof hm<"u"?hm:typeof self<"u"?self:typeof window<"u"?window:{});const FA="@firebase/firestore",UA="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Jn.UNAUTHENTICATED=new Jn(null),Jn.GOOGLE_CREDENTIALS=new Jn("google-credentials-uid"),Jn.FIRST_PARTY=new Jn("first-party-uid"),Jn.MOCK_USER=new Jn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gu="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ca=new Zg("@firebase/firestore");function lc(){return ca.logLevel}function UD(t){ca.setLogLevel(t)}function ee(t,...e){if(ca.logLevel<=dt.DEBUG){const n=e.map(YE);ca.debug(`Firestore (${Gu}): ${t}`,...n)}}function yn(t,...e){if(ca.logLevel<=dt.ERROR){const n=e.map(YE);ca.error(`Firestore (${Gu}): ${t}`,...n)}}function is(t,...e){if(ca.logLevel<=dt.WARN){const n=e.map(YE);ca.warn(`Firestore (${Gu}): ${t}`,...n)}}function YE(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,jD(t,r,n)}function jD(t,e,n){let r=`FIRESTORE (${Gu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw yn(r),new Error(r)}function Re(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||jD(e,s,r)}function s8(t,e){t||Te(57014,e)}function pe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class J extends Bs{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class BD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Jn.UNAUTHENTICATED))}shutdown(){}}class i8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class o8{constructor(e){this.t=e,this.currentUser=Jn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Re(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new er,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new er)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Re(typeof r.accessToken=="string",31837,{l:r}),new $D(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Re(e===null||typeof e=="string",2055,{h:e}),new Jn(e)}}class a8{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Jn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class l8{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new a8(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Jn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Rw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class c8{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Re(this.o===void 0,3512);const r=i=>{i.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Rw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Re(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Rw(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class u8{getToken(){return Promise.resolve(new Rw(""))}invalidateToken(){}start(e,n){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d8(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=d8(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function je(t,e){return t<e?-1:t>e?1:0}function Pw(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Dv(s)===Dv(i)?je(s,i):Dv(s)?1:-1}return je(t.length,e.length)}const h8=55296,f8=57343;function Dv(t){const e=t.charCodeAt(0);return e>=h8&&e<=f8}function mu(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function zD(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cw="__name__";class Qs{constructor(e,n,r){n===void 0?n=0:n>e.length&&Te(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Te(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Qs.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Qs?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Qs.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return je(e.length,n.length)}static compareSegments(e,n){const r=Qs.isNumericId(e),s=Qs.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Qs.extractNumericId(e).compare(Qs.extractNumericId(n)):Pw(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ta.fromString(e.substring(4,e.length-2))}}class it extends Qs{construct(e,n,r){return new it(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new J(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new it(n)}static emptyPath(){return new it([])}}const m8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $t extends Qs{construct(e,n,r){return new $t(e,n,r)}static isValidIdentifier(e){return m8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Cw}static keyField(){return new $t([Cw])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new J(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new J(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new J(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new J(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $t(n)}static emptyPath(){return new $t([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.path=e}static fromPath(e){return new fe(it.fromString(e))}static fromName(e){return new fe(it.fromString(e).popFirst(5))}static empty(){return new fe(it.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&it.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return it.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new fe(new it(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(t,e,n){if(!n)throw new J(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function WD(t,e,n,r){if(e===!0&&r===!0)throw new J(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function jA(t){if(!fe.isDocumentKey(t))throw new J(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $A(t){if(fe.isDocumentKey(t))throw new J(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function qD(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function iy(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Te(12329,{type:typeof t})}function ot(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new J(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=iy(t);throw new J(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function HD(t,e){if(e<=0)throw new J(U.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rn(t,e){const n={typeString:t};return e&&(n.value=e),n}function zl(t,e){if(!qD(t))throw new J(U.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new J(U.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BA=-62135596800,zA=1e6;class _t{static now(){return _t.fromMillis(Date.now())}static fromDate(e){return _t.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*zA);return new _t(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new J(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new J(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<BA)throw new J(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new J(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/zA}_compareTo(e){return this.seconds===e.seconds?je(this.nanoseconds,e.nanoseconds):je(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(zl(e,_t._jsonSchema))return new _t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-BA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_t._jsonSchemaVersion="firestore/timestamp/1.0",_t._jsonSchema={type:Rn("string",_t._jsonSchemaVersion),seconds:Rn("number"),nanoseconds:Rn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{static fromTimestamp(e){return new De(e)}static min(){return new De(new _t(0,0))}static max(){return new De(new _t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pu=-1;class gu{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function kw(t){return t.fields.find(e=>e.kind===2)}function ja(t){return t.fields.filter(e=>e.kind!==2)}function p8(t,e){let n=je(t.collectionGroup,e.collectionGroup);if(n!==0)return n;for(let r=0;r<Math.min(t.fields.length,e.fields.length);++r)if(n=g8(t.fields[r],e.fields[r]),n!==0)return n;return je(t.fields.length,e.fields.length)}gu.UNKNOWN_ID=-1;class dl{constructor(e,n){this.fieldPath=e,this.kind=n}}function g8(t,e){const n=$t.comparator(t.fieldPath,e.fieldPath);return n!==0?n:je(t.kind,e.kind)}class yu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new yu(0,os.min())}}function KD(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=De.fromTimestamp(r===1e9?new _t(n+1,0):new _t(n,r));return new os(s,fe.empty(),e)}function GD(t){return new os(t.readTime,t.key,pu)}class os{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new os(De.min(),fe.empty(),pu)}static max(){return new os(De.max(),fe.empty(),pu)}}function XE(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=fe.comparator(t.documentKey,e.documentKey),n!==0?n:je(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class YD{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ia(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==QD)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new M((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof M?n:M.resolve(n)}catch(n){return M.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):M.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):M.reject(n)}static resolve(e){return new M((n,r)=>{n(e)})}static reject(e){return new M((n,r)=>{r(e)})}static waitFor(e){return new M((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=M.resolve(!1);for(const r of e)n=n.next(s=>s?M.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new M((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(e[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,n){return new M((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr="SimpleDb";class oy{static open(e,n,r,s){try{return new oy(n,e.transaction(s,r))}catch(i){throw new nh(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new er,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new nh(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=ZE(r.target.error);this.S.reject(new nh(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ee(Yr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new v8(n)}}class hi{static delete(e){return ee(Yr,"Removing database:",e),za(kN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!FE())return!1;if(hi.F())return!0;const e=jn(),n=hi.M(e),r=0<n&&n<10,s=JD(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,hi.M(jn())===12.2&&yn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ee(Yr,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new nh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new J(U.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new J(U.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new nh(e,o))},s.onupgradeneeded=i=>{ee(Yr,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{ee(Yr,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=oy.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(c=>(a.C(),c)).catch(c=>(a.abort(c),M.reject(c))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(ee(Yr,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function JD(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class y8{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return za(this.U.delete())}}class nh extends J{constructor(e,n){super(U.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ta(t){return t.name==="IndexedDbTransactionError"}class v8{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ee(Yr,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(ee(Yr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),za(r)}add(e){return ee(Yr,"ADD",this.store.name,e,e),za(this.store.add(e))}get(e){return za(this.store.get(e)).next(n=>(n===void 0&&(n=null),ee(Yr,"GET",this.store.name,e,n),n))}delete(e){return ee(Yr,"DELETE",this.store.name,e),za(this.store.delete(e))}count(){return ee(Yr,"COUNT",this.store.name),za(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new M((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new M((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){ee(Yr,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new M((r,s)=>{n.onerror=i=>{const o=ZE(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new M((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new y8(a),c=n(a.primaryKey,a.value,l);if(c instanceof M){const u=c.catch(h=>(l.done(),M.reject(h)));r.push(u)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}}).next(()=>M.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function za(t){return new M((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=ZE(r.target.error);n(s)}})}let WA=!1;function ZE(t){const e=hi.M(jn());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new J("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return WA||(WA=!0,setTimeout(()=>{throw r},0)),r}}return t}const rh="IndexBackfiller";class _8{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ee(rh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();ee(rh,`Documents written: ${n}`)}catch(n){Ta(n)?ee(rh,"Ignoring IndexedDB error during index backfill: ",n):await Ia(n)}await this.re(6e4)})}}class w8{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return M.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return ee(rh,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(ee(rh,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=GD(i);XE(o,r)>0&&(r=o)}),new os(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ur.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=-1;function vf(t){return t==null}function $h(t){return t===0&&1/t==-1/0}function XD(t){return typeof t=="number"&&Number.isInteger(t)&&!$h(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zp="";function gr(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=qA(e)),e=E8(t.get(n),e);return qA(e)}function E8(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Zp:n+="";break;default:n+=i}}return n}function qA(t){return t+Zp+""}function si(t){const e=t.length;if(Re(e>=2,64408,{path:t}),e===2)return Re(t.charAt(0)===Zp&&t.charAt(1)==="",56145,{path:t}),it.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Zp,i);switch((o<0||o>n)&&Te(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:Te(61167,{path:t})}i=o+2}return new it(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a="remoteDocuments",_f="owner",Jl="owner",Bh="mutationQueues",I8="userId",xs="mutations",HA="batchId",tl="userMutationsIndex",KA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qm(t,e){return[t,gr(e)]}function ZD(t,e,n){return[t,gr(e),n]}const T8={},vu="documentMutations",eg="remoteDocumentsV14",S8=["prefixPath","collectionGroup","readTime","documentId"],Ym="documentKeyIndex",b8=["prefixPath","collectionGroup","documentId"],eO="collectionGroupIndex",A8=["collectionGroup","readTime","prefixPath","documentId"],zh="remoteDocumentGlobal",Nw="remoteDocumentGlobalKey",_u="targets",tO="queryTargetsIndex",x8=["canonicalId","targetId"],wu="targetDocuments",R8=["targetId","path"],eI="documentTargetsIndex",P8=["path","targetId"],tg="targetGlobalKey",hl="targetGlobal",Wh="collectionParents",C8=["collectionId","parent"],Eu="clientMetadata",k8="clientId",ay="bundles",N8="bundleId",ly="namedQueries",D8="name",tI="indexConfiguration",O8="indexId",Dw="collectionGroupIndex",L8="collectionGroup",sh="indexState",M8=["indexId","uid"],nO="sequenceNumberIndex",V8=["uid","sequenceNumber"],ih="indexEntries",F8=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],rO="documentKeyIndex",U8=["indexId","uid","orderedDocumentKey"],cy="documentOverlays",j8=["userId","collectionPath","documentId"],Ow="collectionPathOverlayIndex",$8=["userId","collectionPath","largestBatchId"],sO="collectionGroupOverlayIndex",B8=["userId","collectionGroup","largestBatchId"],nI="globals",z8="name",iO=[Bh,xs,vu,$a,_u,_f,hl,wu,Eu,zh,Wh,ay,ly],W8=[...iO,cy],oO=[Bh,xs,vu,eg,_u,_f,hl,wu,Eu,zh,Wh,ay,ly,cy],aO=oO,rI=[...aO,tI,sh,ih],q8=rI,lO=[...rI,nI],H8=lO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw extends YD{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Bn(t,e){const n=pe(t);return hi.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Sa(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function cO(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function uO(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,n){this.comparator=e,this.root=n||sr.EMPTY}insert(e,n){return new Vt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,sr.BLACK,null,null))}remove(e){return new Vt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fm(this.root,e,this.comparator,!1)}getReverseIterator(){return new fm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fm(this.root,e,this.comparator,!0)}}class fm{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sr{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??sr.RED,this.left=s??sr.EMPTY,this.right=i??sr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new sr(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return sr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return sr.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,sr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,sr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Te(27949);return e+(this.isRed()?0:1)}}sr.EMPTY=null,sr.RED=!0,sr.BLACK=!1;sr.EMPTY=new class{constructor(){this.size=0}get key(){throw Te(57766)}get value(){throw Te(16141)}get color(){throw Te(16727)}get left(){throw Te(29726)}get right(){throw Te(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new sr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.comparator=e,this.data=new Vt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new QA(this.data.getIterator())}getIteratorFrom(e){return new QA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof xt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new xt(this.comparator);return n.data=e,n}}class QA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Xl(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this.fields=e,e.sort($t.comparator)}static empty(){return new jr([])}unionWith(e){let n=new xt($t.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new jr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return mu(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K8(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new dO("Invalid base64 string: "+i):i}}(e);return new cn(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new cn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return je(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}cn.EMPTY_BYTE_STRING=new cn("");const G8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gi(t){if(Re(!!t,39018),typeof t=="string"){let e=0;const n=G8.exec(t);if(Re(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ht(t.seconds),nanos:Ht(t.nanos)}}function Ht(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Qi(t){return typeof t=="string"?cn.fromBase64String(t):cn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hO="server_timestamp",fO="__type__",mO="__previous_value__",pO="__local_write_time__";function uy(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[fO])==null?void 0:r.stringValue)===hO}function dy(t){const e=t.mapValue.fields[mO];return uy(e)?dy(e):e}function qh(t){const e=Gi(t.mapValue.fields[pO].timestampValue);return new _t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(e,n,r,s,i,o,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const Hh="(default)";class ua{constructor(e,n){this.projectId=e,this.database=n||Hh}static empty(){return new ua("","")}get isDefaultDatabase(){return this.database===Hh}isEqual(e){return e instanceof ua&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI="__type__",gO="__max__",$o={mapValue:{fields:{__type__:{stringValue:gO}}}},iI="__vector__",Iu="value",Jm={nullValue:"NULL_VALUE"};function da(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?uy(t)?4:yO(t)?9007199254740991:hy(t)?10:11:Te(28295,{value:t})}function vi(t,e){if(t===e)return!0;const n=da(t);if(n!==da(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return qh(t).isEqual(qh(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Gi(s.timestampValue),a=Gi(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Qi(s.bytesValue).isEqual(Qi(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ht(s.geoPointValue.latitude)===Ht(i.geoPointValue.latitude)&&Ht(s.geoPointValue.longitude)===Ht(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ht(s.integerValue)===Ht(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ht(s.doubleValue),a=Ht(i.doubleValue);return o===a?$h(o)===$h(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return mu(t.arrayValue.values||[],e.arrayValue.values||[],vi);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(GA(o)!==GA(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!vi(o[l],a[l])))return!1;return!0}(t,e);default:return Te(52216,{left:t})}}function Kh(t,e){return(t.values||[]).find(n=>vi(n,e))!==void 0}function ha(t,e){if(t===e)return 0;const n=da(t),r=da(e);if(n!==r)return je(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return je(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Ht(i.integerValue||i.doubleValue),l=Ht(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return YA(t.timestampValue,e.timestampValue);case 4:return YA(qh(t),qh(e));case 5:return Pw(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Qi(i),l=Qi(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=je(a[c],l[c]);if(u!==0)return u}return je(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=je(Ht(i.latitude),Ht(o.latitude));return a!==0?a:je(Ht(i.longitude),Ht(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return JA(t.arrayValue,e.arrayValue);case 10:return function(i,o){var f,m,E,p;const a=i.fields||{},l=o.fields||{},c=(f=a[Iu])==null?void 0:f.arrayValue,u=(m=l[Iu])==null?void 0:m.arrayValue,h=je(((E=c==null?void 0:c.values)==null?void 0:E.length)||0,((p=u==null?void 0:u.values)==null?void 0:p.length)||0);return h!==0?h:JA(c,u)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===$o.mapValue&&o===$o.mapValue)return 0;if(i===$o.mapValue)return 1;if(o===$o.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const f=Pw(l[h],u[h]);if(f!==0)return f;const m=ha(a[l[h]],c[u[h]]);if(m!==0)return m}return je(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Te(23264,{he:n})}}function YA(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return je(t,e);const n=Gi(t),r=Gi(e),s=je(n.seconds,r.seconds);return s!==0?s:je(n.nanos,r.nanos)}function JA(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=ha(n[s],r[s]);if(i)return i}return je(n.length,r.length)}function Tu(t){return Mw(t)}function Mw(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Gi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Qi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return fe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Mw(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Mw(n.fields[o])}`;return s+"}"}(t.mapValue):Te(61005,{value:t})}function Xm(t){switch(da(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dy(t);return e?16+Xm(e):16;case 5:return 2*t.stringValue.length;case 6:return Qi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Xm(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Sa(r.fields,(i,o)=>{s+=i.length+Xm(o)}),s}(t.mapValue);default:throw Te(13486,{value:t})}}function Sl(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Vw(t){return!!t&&"integerValue"in t}function Gh(t){return!!t&&"arrayValue"in t}function XA(t){return!!t&&"nullValue"in t}function ZA(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Zm(t){return!!t&&"mapValue"in t}function hy(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[sI])==null?void 0:r.stringValue)===iI}function oh(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Sa(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=oh(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=oh(t.arrayValue.values[n]);return e}return{...t}}function yO(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===gO}const vO={mapValue:{fields:{[sI]:{stringValue:iI},[Iu]:{arrayValue:{}}}}};function Y8(t){return"nullValue"in t?Jm:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Sl(ua.empty(),fe.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?hy(t)?vO:{mapValue:{}}:Te(35942,{value:t})}function J8(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Sl(ua.empty(),fe.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?vO:"mapValue"in t?hy(t)?{mapValue:{}}:$o:Te(61959,{value:t})}function ex(t,e){const n=ha(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function tx(t,e){const n=ha(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this.value=e}static empty(){return new ir({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Zm(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=oh(n)}setAll(e){let n=$t.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=oh(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Zm(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return vi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Zm(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Sa(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new ir(oh(this.value))}}function _O(t){const e=[];return Sa(t.fields,(n,r)=>{const s=new $t([n]);if(Zm(r)){const i=_O(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new jr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new jt(e,0,De.min(),De.min(),De.min(),ir.empty(),0)}static newFoundDocument(e,n,r,s){return new jt(e,1,n,De.min(),r,s,0)}static newNoDocument(e,n){return new jt(e,2,n,De.min(),De.min(),ir.empty(),0)}static newUnknownDocument(e,n){return new jt(e,3,n,De.min(),De.min(),ir.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(De.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ir.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ir.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=De.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof jt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new jt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e,n){this.position=e,this.inclusive=n}}function nx(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=fe.comparator(fe.fromName(o.referenceValue),n.key):r=ha(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function rx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!vi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n="asc"){this.field=e,this.dir=n}}function X8(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{}class ht extends wO{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Z8(e,n,r):n==="array-contains"?new n7(e,r):n==="in"?new AO(e,r):n==="not-in"?new r7(e,r):n==="array-contains-any"?new s7(e,r):new ht(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new e7(e,r):new t7(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(ha(n,this.value)):n!==null&&da(this.value)===da(n)&&this.matchesComparison(ha(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class St extends wO{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new St(e,n)}matches(e){return Su(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Su(t){return t.op==="and"}function Fw(t){return t.op==="or"}function oI(t){return EO(t)&&Su(t)}function EO(t){for(const e of t.filters)if(e instanceof St)return!1;return!0}function Uw(t){if(t instanceof ht)return t.field.canonicalString()+t.op.toString()+Tu(t.value);if(oI(t))return t.filters.map(e=>Uw(e)).join(",");{const e=t.filters.map(n=>Uw(n)).join(",");return`${t.op}(${e})`}}function IO(t,e){return t instanceof ht?function(r,s){return s instanceof ht&&r.op===s.op&&r.field.isEqual(s.field)&&vi(r.value,s.value)}(t,e):t instanceof St?function(r,s){return s instanceof St&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&IO(o,s.filters[a]),!0):!1}(t,e):void Te(19439)}function TO(t,e){const n=t.filters.concat(e);return St.create(n,t.op)}function SO(t){return t instanceof ht?function(n){return`${n.field.canonicalString()} ${n.op} ${Tu(n.value)}`}(t):t instanceof St?function(n){return n.op.toString()+" {"+n.getFilters().map(SO).join(" ,")+"}"}(t):"Filter"}class Z8 extends ht{constructor(e,n,r){super(e,n,r),this.key=fe.fromName(r.referenceValue)}matches(e){const n=fe.comparator(e.key,this.key);return this.matchesComparison(n)}}class e7 extends ht{constructor(e,n){super(e,"in",n),this.keys=bO("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class t7 extends ht{constructor(e,n){super(e,"not-in",n),this.keys=bO("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function bO(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>fe.fromName(r.referenceValue))}class n7 extends ht{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Gh(n)&&Kh(n.arrayValue,this.value)}}class AO extends ht{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Kh(this.value.arrayValue,n)}}class r7 extends ht{constructor(e,n){super(e,"not-in",n)}matches(e){if(Kh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Kh(this.value.arrayValue,n)}}class s7 extends ht{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Gh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Kh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i7{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function jw(t,e=null,n=[],r=[],s=null,i=null,o=null){return new i7(t,e,n,r,s,i,o)}function bl(t){const e=pe(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Uw(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),vf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Tu(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Tu(r)).join(",")),e.Te=n}return e.Te}function wf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!X8(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!IO(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!rx(t.startAt,e.startAt)&&rx(t.endAt,e.endAt)}function ng(t){return fe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function rg(t,e){return t.filters.filter(n=>n instanceof ht&&n.field.isEqual(e))}function sx(t,e,n){let r=Jm,s=!0;for(const i of rg(t,e)){let o=Jm,a=!0;switch(i.op){case"<":case"<=":o=Y8(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Jm}ex({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];ex({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function ix(t,e,n){let r=$o,s=!0;for(const i of rg(t,e)){let o=$o,a=!0;switch(i.op){case">=":case">":o=J8(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=$o}tx({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];tx({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function xO(t,e,n,r,s,i,o,a){return new Xi(t,e,n,r,s,i,o,a)}function Qu(t){return new Xi(t)}function ox(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function aI(t){return t.collectionGroup!==null}function zc(t){const e=pe(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new xt($t.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Qh(i,r))}),n.has($t.keyField().canonicalString())||e.Ie.push(new Qh($t.keyField(),r))}return e.Ie}function yr(t){const e=pe(t);return e.Ee||(e.Ee=PO(e,zc(t))),e.Ee}function RO(t){const e=pe(t);return e.de||(e.de=PO(e,t.explicitOrderBy)),e.de}function PO(t,e){if(t.limitType==="F")return jw(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Qh(s.field,i)});const n=t.endAt?new fa(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new fa(t.startAt.position,t.startAt.inclusive):null;return jw(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function $w(t,e){const n=t.filters.concat([e]);return new Xi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function sg(t,e,n){return new Xi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ef(t,e){return wf(yr(t),yr(e))&&t.limitType===e.limitType}function CO(t){return`${bl(yr(t))}|lt:${t.limitType}`}function cc(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>SO(s)).join(", ")}]`),vf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Tu(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Tu(s)).join(",")),`Target(${r})`}(yr(t))}; limitType=${t.limitType})`}function If(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):fe.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of zc(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=nx(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,zc(r),s)||r.endAt&&!function(o,a,l){const c=nx(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,zc(r),s))}(t,e)}function kO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function NO(t){return(e,n)=>{let r=!1;for(const s of zc(t)){const i=o7(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function o7(t,e,n){const r=t.field.isKeyField()?fe.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?ha(l,c):Te(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Te(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Sa(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return uO(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a7=new Vt(fe.comparator);function $r(){return a7}const DO=new Vt(fe.comparator);function $d(...t){let e=DO;for(const n of t)e=e.insert(n.key,n);return e}function OO(t){let e=DO;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ii(){return ah()}function LO(){return ah()}function ah(){return new Zi(t=>t.toString(),(t,e)=>t.isEqual(e))}const l7=new Vt(fe.comparator),c7=new xt(fe.comparator);function Ke(...t){let e=c7;for(const n of t)e=e.add(n);return e}const u7=new xt(je);function lI(){return u7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$h(e)?"-0":e}}function MO(t){return{integerValue:""+t}}function VO(t,e){return XD(e)?MO(e):cI(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(){this._=void 0}}function d7(t,e,n){return t instanceof bu?function(s,i){const o={fields:{[fO]:{stringValue:hO},[pO]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&uy(i)&&(i=dy(i)),i&&(o.fields[mO]=i),{mapValue:o}}(n,e):t instanceof Al?UO(t,e):t instanceof xl?jO(t,e):function(s,i){const o=FO(s,i),a=ax(o)+ax(s.Ae);return Vw(o)&&Vw(s.Ae)?MO(a):cI(s.serializer,a)}(t,e)}function h7(t,e,n){return t instanceof Al?UO(t,e):t instanceof xl?jO(t,e):n}function FO(t,e){return t instanceof Au?function(r){return Vw(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class bu extends fy{}class Al extends fy{constructor(e){super(),this.elements=e}}function UO(t,e){const n=$O(e);for(const r of t.elements)n.some(s=>vi(s,r))||n.push(r);return{arrayValue:{values:n}}}class xl extends fy{constructor(e){super(),this.elements=e}}function jO(t,e){let n=$O(e);for(const r of t.elements)n=n.filter(s=>!vi(s,r));return{arrayValue:{values:n}}}class Au extends fy{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function ax(t){return Ht(t.integerValue||t.doubleValue)}function $O(t){return Gh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,n){this.field=e,this.transform=n}}function f7(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Al&&s instanceof Al||r instanceof xl&&s instanceof xl?mu(r.elements,s.elements,vi):r instanceof Au&&s instanceof Au?vi(r.Ae,s.Ae):r instanceof bu&&s instanceof bu}(t.transform,e.transform)}class m7{constructor(e,n){this.version=e,this.transformResults=n}}class Gt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Gt}static exists(e){return new Gt(void 0,e)}static updateTime(e){return new Gt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ep(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class my{}function BO(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ju(t.key,Gt.none()):new Yu(t.key,t.data,Gt.none());{const n=t.data,r=ir.empty();let s=new xt($t.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new eo(t.key,r,new jr(s.toArray()),Gt.none())}}function p7(t,e,n){t instanceof Yu?function(s,i,o){const a=s.value.clone(),l=cx(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof eo?function(s,i,o){if(!ep(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=cx(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(zO(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function lh(t,e,n,r){return t instanceof Yu?function(i,o,a,l){if(!ep(i.precondition,o))return a;const c=i.value.clone(),u=ux(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof eo?function(i,o,a,l){if(!ep(i.precondition,o))return a;const c=ux(i.fieldTransforms,l,o),u=o.data;return u.setAll(zO(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,o,a){return ep(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function g7(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=FO(r.transform,s||null);i!=null&&(n===null&&(n=ir.empty()),n.set(r.field,i))}return n||null}function lx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&mu(r,s,(i,o)=>f7(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Yu extends my{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class eo extends my{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function zO(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function cx(t,e,n){const r=new Map;Re(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,h7(o,a,n[s]))}return r}function ux(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,d7(i,o,e))}return r}class Ju extends my{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class uI extends my{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&p7(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=lh(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=lh(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=LO();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=BO(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(De.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ke())}isEqual(e){return this.batchId===e.batchId&&mu(this.mutations,e.mutations,(n,r)=>lx(n,r))&&mu(this.baseMutations,e.baseMutations,(n,r)=>lx(n,r))}}class hI{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Re(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return l7}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new hI(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fI=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y7{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var An,gt;function qO(t){switch(t){case U.OK:return Te(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return Te(15467,{code:t})}}function HO(t){if(t===void 0)return yn("GRPC error has no .code"),U.UNKNOWN;switch(t){case An.OK:return U.OK;case An.CANCELLED:return U.CANCELLED;case An.UNKNOWN:return U.UNKNOWN;case An.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case An.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case An.INTERNAL:return U.INTERNAL;case An.UNAVAILABLE:return U.UNAVAILABLE;case An.UNAUTHENTICATED:return U.UNAUTHENTICATED;case An.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case An.NOT_FOUND:return U.NOT_FOUND;case An.ALREADY_EXISTS:return U.ALREADY_EXISTS;case An.PERMISSION_DENIED:return U.PERMISSION_DENIED;case An.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case An.ABORTED:return U.ABORTED;case An.OUT_OF_RANGE:return U.OUT_OF_RANGE;case An.UNIMPLEMENTED:return U.UNIMPLEMENTED;case An.DATA_LOSS:return U.DATA_LOSS;default:return Te(39323,{code:t})}}(gt=An||(An={}))[gt.OK=0]="OK",gt[gt.CANCELLED=1]="CANCELLED",gt[gt.UNKNOWN=2]="UNKNOWN",gt[gt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gt[gt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gt[gt.NOT_FOUND=5]="NOT_FOUND",gt[gt.ALREADY_EXISTS=6]="ALREADY_EXISTS",gt[gt.PERMISSION_DENIED=7]="PERMISSION_DENIED",gt[gt.UNAUTHENTICATED=16]="UNAUTHENTICATED",gt[gt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gt[gt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gt[gt.ABORTED=10]="ABORTED",gt[gt.OUT_OF_RANGE=11]="OUT_OF_RANGE",gt[gt.UNIMPLEMENTED=12]="UNIMPLEMENTED",gt[gt.INTERNAL=13]="INTERNAL",gt[gt.UNAVAILABLE=14]="UNAVAILABLE",gt[gt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ch=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v7=new ta([4294967295,4294967295],0);function dx(t){const e=KO().encode(t),n=new DD;return n.update(e),new Uint8Array(n.digest())}function hx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ta([n,r],0),new ta([s,i],0)]}class mI{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Bd(`Invalid padding: ${n}`);if(r<0)throw new Bd(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Bd(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Bd(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ta.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(ta.fromNumber(r)));return s.compare(v7)===1&&(s=new ta([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=dx(e),[r,s]=hx(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new mI(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=dx(e),[r,s]=hx(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Bd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,bf.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Sf(De.min(),s,new Vt(je),$r(),Ke())}}class bf{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new bf(r,n,Ke(),Ke(),Ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class GO{constructor(e,n){this.targetId=e,this.Ce=n}}class QO{constructor(e,n,r=cn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class fx{constructor(){this.ve=0,this.Fe=mx(),this.Me=cn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ke(),n=Ke(),r=Ke();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Te(38017,{changeType:i})}}),new bf(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=mx()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Re(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class _7{constructor(e){this.Ge=e,this.ze=new Map,this.je=$r(),this.Je=mm(),this.He=mm(),this.Ye=new Vt(je)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Te(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(ng(i))if(r===0){const o=new fe(i.path);this.et(n,o,jt.newNoDocument(o,De.min()))}else Re(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,c)}ch==null||ch.lt(function(u,h,f,m,E){var g,_,w;const p={localCacheCount:u,existenceFilterCount:h.count,databaseId:f.database,projectId:f.projectId},I=h.unchangedNames;return I&&(p.bloomFilter={applied:E===0,hashCount:(I==null?void 0:I.hashCount)??0,bitmapLength:((_=(g=I==null?void 0:I.bits)==null?void 0:g.bitmap)==null?void 0:_.length)??0,padding:((w=I==null?void 0:I.bits)==null?void 0:w.padding)??0,mightContain:A=>(m==null?void 0:m.mightContain(A))??!1}),p}(o,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Qi(r).toUint8Array()}catch(l){if(l instanceof dO)return is("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new mI(o,s,i)}catch(l){return is(l instanceof Bd?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&ng(a.target)){const l=new fe(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,jt.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=Ke();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Sf(e,n,this.Ye,this.je,r);return this.je=$r(),this.Je=mm(),this.He=mm(),this.Ye=new Vt(je),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new fx,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new xt(je),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new xt(je),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new fx),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function mm(){return new Vt(fe.comparator)}function mx(){return new Vt(fe.comparator)}const w7={asc:"ASCENDING",desc:"DESCENDING"},E7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},I7={and:"AND",or:"OR"};class T7{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Bw(t,e){return t.useProto3Json||vf(e)?e:{value:e}}function xu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function YO(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function S7(t,e){return xu(t,e.toTimestamp())}function _n(t){return Re(!!t,49232),De.fromTimestamp(function(n){const r=Gi(n);return new _t(r.seconds,r.nanos)}(t))}function pI(t,e){return zw(t,e).canonicalString()}function zw(t,e){const n=function(s){return new it(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function JO(t){const e=it.fromString(t);return Re(o2(e),10190,{key:e.toString()}),e}function Yh(t,e){return pI(t.databaseId,e.path)}function fi(t,e){const n=JO(e);if(n.get(1)!==t.databaseId.projectId)throw new J(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new J(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new fe(e2(n))}function XO(t,e){return pI(t.databaseId,e)}function ZO(t){const e=JO(t);return e.length===4?it.emptyPath():e2(e)}function Ww(t){return new it(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function e2(t){return Re(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function px(t,e,n){return{name:Yh(t,e),fields:n.value.mapValue.fields}}function py(t,e,n){const r=fi(t,e.name),s=_n(e.updateTime),i=e.createTime?_n(e.createTime):De.min(),o=new ir({mapValue:{fields:e.fields}}),a=jt.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function b7(t,e){return"found"in e?function(r,s){Re(!!s.found,43571),s.found.name,s.found.updateTime;const i=fi(r,s.found.name),o=_n(s.found.updateTime),a=s.found.createTime?_n(s.found.createTime):De.min(),l=new ir({mapValue:{fields:s.found.fields}});return jt.newFoundDocument(i,o,a,l)}(t,e):"missing"in e?function(r,s){Re(!!s.missing,3894),Re(!!s.readTime,22933);const i=fi(r,s.missing),o=_n(s.readTime);return jt.newNoDocument(i,o)}(t,e):Te(7234,{result:e})}function A7(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Te(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(Re(u===void 0||typeof u=="string",58123),cn.fromBase64String(u||"")):(Re(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),cn.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?U.UNKNOWN:HO(c.code);return new J(u,c.message||"")}(o);n=new QO(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=fi(t,r.document.name),i=_n(r.document.updateTime),o=r.document.createTime?_n(r.document.createTime):De.min(),a=new ir({mapValue:{fields:r.document.fields}}),l=jt.newFoundDocument(s,i,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new tp(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=fi(t,r.document),i=r.readTime?_n(r.readTime):De.min(),o=jt.newNoDocument(s,i),a=r.removedTargetIds||[];n=new tp([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=fi(t,r.document),i=r.removedTargetIds||[];n=new tp([],i,s,null)}else{if(!("filter"in e))return Te(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new y7(s,i),a=r.targetId;n=new GO(a,o)}}return n}function Jh(t,e){let n;if(e instanceof Yu)n={update:px(t,e.key,e.value)};else if(e instanceof Ju)n={delete:Yh(t,e.key)};else if(e instanceof eo)n={update:px(t,e.key,e.data),updateMask:N7(e.fieldMask)};else{if(!(e instanceof uI))return Te(16599,{Vt:e.type});n={verify:Yh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof bu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Al)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof xl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Au)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Te(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:S7(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Te(27497)}(t,e.precondition)),n}function qw(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Gt.updateTime(_n(i.updateTime)):i.exists!==void 0?Gt.exists(i.exists):Gt.none()}(e.currentDocument):Gt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)Re(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new bu;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];l=new Al(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];l=new xl(u)}else"increment"in a?l=new Au(o,a.increment):Te(16584,{proto:a});const c=$t.fromServerFormat(a.fieldPath);return new Tf(c,l)}(t,s)):[];if(e.update){e.update.name;const s=fi(t,e.update.name),i=new ir({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new jr(c.map(u=>$t.fromServerFormat(u)))}(e.updateMask);return new eo(s,i,o,n,r)}return new Yu(s,i,n,r)}if(e.delete){const s=fi(t,e.delete);return new Ju(s,n)}if(e.verify){const s=fi(t,e.verify);return new uI(s,n)}return Te(1463,{proto:e})}function x7(t,e){return t&&t.length>0?(Re(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?_n(s.updateTime):_n(i);return o.isEqual(De.min())&&(o=_n(i)),new m7(o,s.transformResults||[])}(n,e))):[]}function t2(t,e){return{documents:[XO(t,e.path)]}}function gy(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=XO(t,s);const i=function(c){if(c.length!==0)return i2(St.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(u=>function(f){return{field:Po(f.field),direction:P7(f.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Bw(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:n,parent:s}}function n2(t,e,n,r){const{ft:s,parent:i}=gy(t,e),o={},a=[];let l=0;return n.forEach(c=>{const u=r?c.alias:"aggregate_"+l++;o[u]=c.alias,c.aggregateType==="count"?a.push({alias:u,count:{}}):c.aggregateType==="avg"?a.push({alias:u,avg:{field:Po(c.fieldPath)}}):c.aggregateType==="sum"&&a.push({alias:u,sum:{field:Po(c.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function r2(t){let e=ZO(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Re(r===1,65062);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=function(h){const f=s2(h);return f instanceof St&&oI(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(E){return new Qh(uc(E.field),function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,vf(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(h){const f=!!h.before,m=h.values||[];return new fa(m,f)}(n.startAt));let c=null;return n.endAt&&(c=function(h){const f=!h.before,m=h.values||[];return new fa(m,f)}(n.endAt)),xO(e,s,o,i,a,"F",l,c)}function R7(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Te(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function s2(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=uc(n.unaryFilter.field);return ht.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=uc(n.unaryFilter.field);return ht.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=uc(n.unaryFilter.field);return ht.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=uc(n.unaryFilter.field);return ht.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Te(61313);default:return Te(60726)}}(t):t.fieldFilter!==void 0?function(n){return ht.create(uc(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Te(58110);default:return Te(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return St.create(n.compositeFilter.filters.map(r=>s2(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Te(1026)}}(n.compositeFilter.op))}(t):Te(30097,{filter:t})}function P7(t){return w7[t]}function C7(t){return E7[t]}function k7(t){return I7[t]}function Po(t){return{fieldPath:t.canonicalString()}}function uc(t){return $t.fromServerFormat(t.fieldPath)}function i2(t){return t instanceof ht?function(n){if(n.op==="=="){if(ZA(n.value))return{unaryFilter:{field:Po(n.field),op:"IS_NAN"}};if(XA(n.value))return{unaryFilter:{field:Po(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ZA(n.value))return{unaryFilter:{field:Po(n.field),op:"IS_NOT_NAN"}};if(XA(n.value))return{unaryFilter:{field:Po(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Po(n.field),op:C7(n.op),value:n.value}}}(t):t instanceof St?function(n){const r=n.getFilters().map(s=>i2(s));return r.length===1?r[0]:{compositeFilter:{op:k7(n.op),filters:r}}}(t):Te(54877,{filter:t})}function N7(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function o2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e,n,r,s,i=De.min(),o=De.min(),a=cn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Di(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(e){this.yt=e}}function D7(t,e){let n;if(e.document)n=py(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=fe.fromSegments(e.noDocument.path),s=Pl(e.noDocument.readTime);n=jt.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Te(56709);{const r=fe.fromSegments(e.unknownDocument.path),s=Pl(e.unknownDocument.version);n=jt.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new _t(s[0],s[1]);return De.fromTimestamp(i)}(e.readTime)),n}function gx(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ig(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Yh(i,o.key),fields:o.data.value.mapValue.fields,updateTime:xu(i,o.version.toTimestamp()),createTime:xu(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Rl(e.version)};else{if(!e.isUnknownDocument())return Te(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Rl(e.version)}}return r}function ig(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Rl(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Pl(t){const e=new _t(t.seconds,t.nanoseconds);return De.fromTimestamp(e)}function Wa(t,e){const n=(e.baseMutations||[]).map(i=>qw(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>qw(t.yt,i)),s=_t.fromMillis(e.localWriteTimeMs);return new dI(e.batchId,s,n,r)}function zd(t){const e=Pl(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Pl(t.lastLimboFreeSnapshotVersion):De.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return Re(o===1,1966,{count:o}),yr(Qu(ZO(i.documents[0])))}(t.query):function(i){return yr(r2(i))}(t.query),new Di(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,cn.fromBase64String(t.resumeToken))}function l2(t,e){const n=Rl(e.snapshotVersion),r=Rl(e.lastLimboFreeSnapshotVersion);let s;s=ng(e.target)?t2(t.yt,e.target):gy(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:bl(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function yy(t){const e=r2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?sg(e,e.limit,"L"):e}function Ov(t,e){return new fI(e.largestBatchId,qw(t.yt,e.overlayMutation))}function yx(t,e){const n=e.path.lastSegment();return[t,gr(e.path.popLast()),n]}function vx(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Rl(r.readTime),documentKey:gr(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O7{getBundleMetadata(e,n){return _x(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Pl(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return _x(e).put(function(s){return{bundleId:s.id,createTime:Rl(_n(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return wx(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:yy(i.bundledQuery),readTime:Pl(i.readTime)}}(r)})}saveNamedQuery(e,n){return wx(e).put(function(s){return{name:s.name,readTime:Rl(_n(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function _x(t){return Bn(t,ay)}function wx(t){return Bn(t,ly)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new vy(e,r)}getOverlay(e,n){return Ad(e).get(yx(this.userId,n)).next(r=>r?Ov(this.serializer,r):null)}getOverlays(e,n){const r=ii();return M.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new fI(n,o);s.push(this.St(e,a))}),M.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(gr(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Ad(e).Z(Ow,a))}),M.waitFor(i)}getOverlaysForCollection(e,n,r){const s=ii(),i=gr(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Ad(e).J(Ow,o).next(a=>{for(const l of a){const c=Ov(this.serializer,l);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=ii();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Ad(e).ee({index:sO,range:a},(l,c,u)=>{const h=Ov(this.serializer,c);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>i)}St(e,n){return Ad(e).put(function(s,i,o){const[a,l,c]=yx(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Jh(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Ad(t){return Bn(t,cy)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{bt(e){return Bn(e,nI)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?cn.fromUint8Array(r):cn.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(Ht(e.integerValue));else if("doubleValue"in e){const r=Ht(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),$h(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Gi(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Qi(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?yO(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):hy(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):Te(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=Iu,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(Ht(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),fe.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}qa.Kt=new qa;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl=255;function M7(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function Ex(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=M7(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class V7{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=Ex(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=Ex(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(Zl),this.sn(255)}_n(){this.an(Zl),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Zl?(this.sn(Zl),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Zl?(this.an(Zl),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class F7{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class U7{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class xd{constructor(){this.cn=new V7,this.ln=new F7(this.cn),this.hn=new U7(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Ha(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:np(this.En),directionalValue:np(this.dn),orderedDocumentKey:np(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function mo(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=Ix(t.En,e.En),n!==0?n:(n=Ix(t.dn,e.dn),n!==0?n:fe.comparator(t.In,e.In)))}function Ix(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function np(t){return FN()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function Tx(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class Sx{constructor(e){this.mn=new xt((n,r)=>$t.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Re(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=kw(e);if(n!==void 0&&!this.wn(n))return!1;const r=ja(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new xt($t.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new dl(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new dl(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new dl(r.field,r.dir==="asc"?0:1)));return new gu(gu.UNKNOWN_ID,this.collectionId,n,yu.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c2(t){var n,r;if(Re(t instanceof ht||t instanceof St,20012),t instanceof ht){if(t instanceof AO){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>ht.create(t.field,"==",i)))||[];return St.create(s,"or")}return t}const e=t.filters.map(s=>c2(s));return St.create(e,t.op)}function j7(t){if(t.getFilters().length===0)return[];const e=Gw(c2(t));return Re(u2(e),7391),Hw(e)||Kw(e)?[e]:e.getFilters()}function Hw(t){return t instanceof ht}function Kw(t){return t instanceof St&&oI(t)}function u2(t){return Hw(t)||Kw(t)||function(n){if(n instanceof St&&Fw(n)){for(const r of n.getFilters())if(!Hw(r)&&!Kw(r))return!1;return!0}return!1}(t)}function Gw(t){if(Re(t instanceof ht||t instanceof St,34018),t instanceof ht)return t;if(t.filters.length===1)return Gw(t.filters[0]);const e=t.filters.map(r=>Gw(r));let n=St.create(e,t.op);return n=og(n),u2(n)?n:(Re(n instanceof St,64498),Re(Su(n),40251),Re(n.filters.length>1,57927),n.filters.reduce((r,s)=>gI(r,s)))}function gI(t,e){let n;return Re(t instanceof ht||t instanceof St,38388),Re(e instanceof ht||e instanceof St,25473),n=t instanceof ht?e instanceof ht?function(s,i){return St.create([s,i],"and")}(t,e):bx(t,e):e instanceof ht?bx(e,t):function(s,i){if(Re(s.filters.length>0&&i.filters.length>0,48005),Su(s)&&Su(i))return TO(s,i.getFilters());const o=Fw(s)?s:i,a=Fw(s)?i:s,l=o.filters.map(c=>gI(c,a));return St.create(l,"or")}(t,e),og(n)}function bx(t,e){if(Su(e))return TO(e,t.getFilters());{const n=e.filters.map(r=>gI(t,r));return St.create(n,"or")}}function og(t){if(Re(t instanceof ht||t instanceof St,11850),t instanceof ht)return t;const e=t.getFilters();if(e.length===1)return og(e[0]);if(EO(t))return t;const n=e.map(s=>og(s)),r=[];return n.forEach(s=>{s instanceof ht?r.push(s):s instanceof St&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:St.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $7{constructor(){this.Cn=new yI}addToCollectionParentIndex(e,n){return this.Cn.add(n),M.resolve()}getCollectionParents(e,n){return M.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return M.resolve()}deleteFieldIndex(e,n){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,n){return M.resolve()}getDocumentsMatchingTarget(e,n){return M.resolve(null)}getIndexType(e,n){return M.resolve(0)}getFieldIndexes(e,n){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,n){return M.resolve(os.min())}getMinOffsetFromCollectionGroup(e,n){return M.resolve(os.min())}updateCollectionGroup(e,n,r){return M.resolve()}updateIndexEntries(e,n){return M.resolve()}}class yI{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new xt(it.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new xt(it.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ax="IndexedDbIndexManager",pm=new Uint8Array(0);class B7{constructor(e,n){this.databaseId=n,this.vn=new yI,this.Fn=new Zi(r=>bl(r),(r,s)=>wf(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:gr(s)};return xx(e).put(i)}return M.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[zD(n),""],!1,!0);return xx(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(si(o.parent))}return r})}addFieldIndex(e,n){const r=Rd(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=tc(e);return i.next(a=>{o.put(vx(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Rd(e),s=tc(e),i=ec(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Rd(e),r=ec(e),s=tc(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return M.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new Sx(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=ec(e);let s=!0;const i=new Map;return M.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=Ke();const a=[];return M.forEach(i,(l,c)=>{ee(Ax,`Using index ${function(w){return`id=${w.indexId}|cg=${w.collectionGroup}|f=${w.fields.map(A=>`${A.fieldPath}:${A.kind}`).join(",")}`}(l)} to execute ${bl(n)}`);const u=function(w,A){const P=kw(A);if(P===void 0)return null;for(const L of rg(w,P.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null}(c,l),h=function(w,A){const P=new Map;for(const L of ja(A))for(const x of rg(w,L.fieldPath))switch(x.op){case"==":case"in":P.set(L.fieldPath.canonicalString(),x.value);break;case"not-in":case"!=":return P.set(L.fieldPath.canonicalString(),x.value),Array.from(P.values())}return null}(c,l),f=function(w,A){const P=[];let L=!0;for(const x of ja(A)){const T=x.kind===0?sx(w,x.fieldPath,w.startAt):ix(w,x.fieldPath,w.startAt);P.push(T.value),L&&(L=T.inclusive)}return new fa(P,L)}(c,l),m=function(w,A){const P=[];let L=!0;for(const x of ja(A)){const T=x.kind===0?ix(w,x.fieldPath,w.endAt):sx(w,x.fieldPath,w.endAt);P.push(T.value),L&&(L=T.inclusive)}return new fa(P,L)}(c,l),E=this.On(l,c,f),p=this.On(l,c,m),I=this.Nn(l,c,h),g=this.Bn(l.indexId,u,E,f.inclusive,p,m.inclusive,I);return M.forEach(g,_=>r.Y(_,n.limit).next(w=>{w.forEach(A=>{const P=fe.fromSegments(A.documentKey);o.has(P)||(o=o.add(P),a.push(P))})}))}).next(()=>a)}return M.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=j7(St.create(e.filters,"and")).map(r=>jw(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,i.length),c=l/(n!=null?n.length:1),u=[];for(let h=0;h<l;++h){const f=n?this.Ln(n[h/c]):pm,m=this.kn(e,f,r[h%c],s),E=this.qn(e,f,i[h%c],o),p=a.map(I=>this.kn(e,f,I,!0));u.push(...this.createRange(m,E,p))}return u}kn(e,n,r,s){const i=new Ha(e,fe.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new Ha(e,fe.empty(),n,r);return s?i.An():i}xn(e,n){const r=new Sx(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return M.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new xt($t.comparator),u=!1;for(const h of l.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?u=!0:c=c.add(f.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(u?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new xd;for(const s of ja(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);qa.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new xd;return qa.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new xd;return qa.Kt.Dt(Sl(this.databaseId,n),r.Pn(function(i){const o=ja(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new xd);let i=0;for(const o of ja(e)){const a=r[i++];for(const l of s)if(this.Un(n,o.fieldPath)&&Gh(a))s=this.Kn(s,o,a);else{const c=l.Pn(o.kind);qa.Kt.Dt(a,c)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new xd;l.seed(a.un()),qa.Kt.Dt(o,l.Pn(n.kind)),i.push(l)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof ht&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Rd(e),s=tc(e);return(n?r.J(Dw,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return M.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(u,h){const f=h?new yu(h.sequenceNumber,new os(Pl(h.readTime),new fe(si(h.documentKey)),h.largestBatchId)):yu.empty(),m=u.fields.map(([E,p])=>new dl($t.fromServerFormat(E),p));return new gu(u.indexId,u.collectionGroup,m,f)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:je(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Rd(e),i=tc(e);return this.Gn(e).next(o=>s.J(Dw,IDBKeyRange.bound(n,n)).next(a=>M.forEach(a,l=>i.put(vx(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return M.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?M.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),M.forEach(a,l=>this.zn(e,s,l).next(c=>{const u=this.jn(i,l);return c.isEqual(u)?M.resolve():this.Jn(e,i,l,c,u)}))))})}Hn(e,n,r,s){return ec(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return ec(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=ec(e);let i=new xt(mo);return s.ee({index:rO,range:IDBKeyRange.only([r.indexId,this.uid,np(this.$n(r,n))])},(o,a)=>{i=i.add(new Ha(r.indexId,n,Tx(a.arrayValue),Tx(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new xt(mo);const s=this.Qn(n,e);if(s==null)return r;const i=kw(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Gh(o))for(const a of o.arrayValue.values||[])r=r.add(new Ha(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new Ha(n.indexId,e.key,pm,s));return r}Jn(e,n,r,s,i){ee(Ax,"Updating index entries for document '%s'",n.key);const o=[];return function(l,c,u,h,f){const m=l.getIterator(),E=c.getIterator();let p=Xl(m),I=Xl(E);for(;p||I;){let g=!1,_=!1;if(p&&I){const w=u(p,I);w<0?_=!0:w>0&&(g=!0)}else p!=null?_=!0:g=!0;g?(h(I),I=Xl(E)):_?(f(p),p=Xl(m)):(p=Xl(m),I=Xl(E))}}(s,i,mo,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),M.waitFor(o)}Gn(e){let n=1;return tc(e).ee({index:nO,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>mo(o,a)).filter((o,a,l)=>!a||mo(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=mo(o,e),l=mo(o,n);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(o),s.push(o.An());else if(l>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,pm,fe.empty()),l=s[o+1].Vn(this.uid,pm,fe.empty());i.push(IDBKeyRange.bound(a,l))}return i}Zn(e,n){return mo(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Rx)}getMinOffset(e,n){return M.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||Te(44426))).next(Rx)}}function xx(t){return Bn(t,Wh)}function ec(t){return Bn(t,ih)}function Rd(t){return Bn(t,tI)}function tc(t){return Bn(t,sh)}function Rx(t){Re(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;XE(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new os(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Px={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},d2=41943040;class mr{static withCacheSize(e){return new mr(e,mr.DEFAULT_COLLECTION_PERCENTILE,mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h2(t,e,n){const r=t.store(xs),s=t.store(vu),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(u,h,f)=>(a++,f.delete()));i.push(l.next(()=>{Re(a===1,47070,{batchId:n.batchId})}));const c=[];for(const u of n.mutations){const h=ZD(e,u.key.path,n.batchId);i.push(s.delete(h)),c.push(u.key)}return M.waitFor(i).next(()=>c)}function ag(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Te(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mr.DEFAULT_COLLECTION_PERCENTILE=10,mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mr.DEFAULT=new mr(d2,mr.DEFAULT_COLLECTION_PERCENTILE,mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mr.DISABLED=new mr(-1,0,0);class _y{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){Re(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new _y(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return po(e).ee({index:tl,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=dc(e),o=po(e);return o.add({}).next(a=>{Re(typeof a=="number",49019);const l=new dI(a,n,r,s),c=function(m,E,p){const I=p.baseMutations.map(_=>Jh(m.yt,_)),g=p.mutations.map(_=>Jh(m.yt,_));return{userId:E,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:I,mutations:g}}(this.serializer,this.userId,l),u=[];let h=new xt((f,m)=>je(f.canonicalString(),m.canonicalString()));for(const f of s){const m=ZD(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),u.push(o.put(c)),u.push(i.put(m,T8))}return h.forEach(f=>{u.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),M.waitFor(u).next(()=>l)})}lookupMutationBatch(e,n){return po(e).get(n).next(r=>r?(Re(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Wa(this.serializer,r)):null)}er(e,n){return this.Xn[n]?M.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return po(e).ee({index:tl,range:s},(o,a,l)=>{a.userId===this.userId&&(Re(a.batchId>=r,47524,{tr:r}),i=Wa(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=na;return po(e).ee({index:tl,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,na],[this.userId,Number.POSITIVE_INFINITY]);return po(e).J(tl,n).next(r=>r.map(s=>Wa(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Qm(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return dc(e).ee({range:s},(o,a,l)=>{const[c,u,h]=o,f=si(u);if(c===this.userId&&n.path.isEqual(f))return po(e).get(h).next(m=>{if(!m)throw Te(61480,{nr:o,batchId:h});Re(m.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:m.userId,batchId:h}),i.push(Wa(this.serializer,m))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xt(je);const s=[];return n.forEach(i=>{const o=Qm(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=dc(e).ee({range:a},(c,u,h)=>{const[f,m,E]=c,p=si(m);f===this.userId&&i.path.isEqual(p)?r=r.add(E):h.done()});s.push(l)}),M.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Qm(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new xt(je);return dc(e).ee({range:o},(l,c,u)=>{const[h,f,m]=l,E=si(f);h===this.userId&&r.isPrefixOf(E)?E.length===s&&(a=a.add(m)):u.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(po(e).get(i).next(o=>{if(o===null)throw Te(35274,{batchId:i});Re(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(Wa(this.serializer,o))}))}),M.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return h2(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),M.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return M.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return dc(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=si(i[1]);s.push(l)}else a.done()}).next(()=>{Re(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return f2(e,this.userId,n)}_r(e){return m2(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:na,lastStreamToken:""})}}function f2(t,e,n){const r=Qm(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return dc(t).ee({range:i,X:!0},(a,l,c)=>{const[u,h,f]=a;u===e&&h===s&&(o=!0),c.done()}).next(()=>o)}function po(t){return Bn(t,xs)}function dc(t){return Bn(t,vu)}function m2(t){return Bn(t,Bh)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Cl(0)}static cr(){return new Cl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z7{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new Cl(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>De.fromTimestamp(new _t(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>nc(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(Re(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return nc(e).ee((o,a)=>{const l=zd(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>M.waitFor(i)).next(()=>s)}forEachTarget(e,n){return nc(e).ee((r,s)=>{const i=zd(s);n(i)})}lr(e){return Cx(e).get(tg).next(n=>(Re(n!==null,2888),n))}hr(e,n){return Cx(e).put(tg,n)}Pr(e,n){return nc(e).put(l2(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=bl(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return nc(e).ee({range:s,index:tO},(o,a,l)=>{const c=zd(a);wf(n,c.target)&&(i=c,l.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Co(e);return n.forEach(o=>{const a=gr(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),M.waitFor(s)}removeMatchingKeys(e,n,r){const s=Co(e);return M.forEach(n,i=>{const o=gr(i.path);return M.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Co(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Co(e);let i=Ke();return s.ee({range:r,X:!0},(o,a,l)=>{const c=si(o[1]),u=new fe(c);i=i.add(u)}).next(()=>i)}containsKey(e,n){const r=gr(n.path),s=IDBKeyRange.bound([r],[zD(r)],!1,!0);let i=0;return Co(e).ee({index:eI,X:!0,range:s},([o,a],l,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}At(e,n){return nc(e).get(n).next(r=>r?zd(r):null)}}function nc(t){return Bn(t,_u)}function Cx(t){return Bn(t,hl)}function Co(t){return Bn(t,wu)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx="LruGarbageCollector",p2=1048576;function Nx([t,e],[n,r]){const s=je(t,n);return s===0?je(e,r):s}class W7{constructor(e){this.Ir=e,this.buffer=new xt(Nx),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Nx(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class g2{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(kx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ta(n)?ee(kx,"Ignoring IndexedDB error during garbage collection: ",n):await Ia(n)}await this.Vr(3e5)})}}class q7{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return M.resolve(Ur.ce);const r=new W7(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(Px)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Px):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),lc()<=dt.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function y2(t,e){return new q7(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H7{constructor(e,n){this.db=e,this.garbageCollector=y2(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return gm(e,r)}removeReference(e,n,r){return gm(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return gm(e,n)}br(e,n){return function(s,i){let o=!1;return m2(s).te(a=>f2(s,a,i).next(l=>(l&&(o=!0),M.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,De.min()),Co(e).delete(function(h){return[0,gr(h.path)]}(o))))});s.push(l)}}).next(()=>M.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return gm(e,n)}Sr(e,n){const r=Co(e);let s,i=Ur.ce;return r.ee({index:eI},([o,a],{path:l,sequenceNumber:c})=>{o===0?(i!==Ur.ce&&n(new fe(si(s)),i),i=c,s=l):i=Ur.ce}).next(()=>{i!==Ur.ce&&n(new fe(si(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function gm(t,e){return Co(t).put(function(r,s){return{targetId:0,path:gr(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(){this.changes=new Zi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,jt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?M.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K7{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ma(e).put(r)}removeEntry(e,n,r){return Ma(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],ig(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=jt.newInvalidDocument(n);return Ma(e).ee({index:Ym,range:IDBKeyRange.only(Pd(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:jt.newInvalidDocument(n)};return Ma(e).ee({index:Ym,range:IDBKeyRange.only(Pd(n))},(s,i)=>{r={document:this.Cr(n,i),size:ag(i)}}).next(()=>r)}getEntries(e,n){let r=$r();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=$r(),s=new Vt(fe.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,ag(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return M.resolve();let s=new xt(Lx);n.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Pd(s.first()),Pd(s.last())),o=s.getIterator();let a=o.getNext();return Ma(e).ee({index:Ym,range:i},(l,c,u)=>{const h=fe.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&Lx(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?u.j(Pd(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),ig(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ma(e).J(IDBKeyRange.bound(a,l,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let u=$r();for(const h of c){const f=this.Cr(fe.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(If(n,f)||s.has(f.key))&&(u=u.insert(f.key,f))}return u})}getAllFromCollectionGroup(e,n,r,s){let i=$r();const o=Ox(n,r),a=Ox(n,os.max());return Ma(e).ee({index:eO,range:IDBKeyRange.bound(o,a,!0)},(l,c,u)=>{const h=this.Cr(fe.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(h.key,h),i.size===s&&u.done()}).next(()=>i)}newChangeBuffer(e){return new G7(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Dx(e).get(Nw).next(n=>(Re(!!n,20021),n))}Dr(e,n){return Dx(e).put(Nw,n)}Cr(e,n){if(n){const r=D7(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(De.min())))return r}return jt.newInvalidDocument(e)}}function _2(t){return new K7(t)}class G7 extends v2{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new Zi(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new xt((i,o)=>je(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=gx(this.Nr.serializer,o);s=s.add(i.path.popLast());const c=ag(l);r+=c-a.size,n.push(this.Nr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=gx(this.Nr.serializer,o.convertToNoDocument(De.min()));n.push(this.Nr.addEntry(e,i,l))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),M.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function Dx(t){return Bn(t,zh)}function Ma(t){return Bn(t,eg)}function Pd(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Ox(t,e){const n=e.documentKey.path.toArray();return[t,ig(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Lx(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=je(n[i],r[i]),s)return s;return s=je(n.length,r.length),s||(s=je(n[n.length-2],r[r.length-2]),s||je(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&lh(r.mutation,s,jr.empty(),_t.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ke()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ke()){const s=ii();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=$d();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ii();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ke()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=$r();const o=ah(),a=function(){return ah()}();return n.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof eo)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),lh(u.mutation,c,u.mutation.getFieldMask(),_t.now())):o.set(c.key,jr.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>a.set(c,new Q7(u,o.get(c)??null))),a))}recalculateAndSaveOverlays(e,n){const r=ah();let s=new Vt((o,a)=>o-a),i=Ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||jr.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(s.get(a.batchId)||Ke()).add(l);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=LO();u.forEach(f=>{if(!i.has(f)){const m=BO(n.get(f),r.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return M.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return fe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):aI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):M.resolve(ii());let a=pu,l=i;return o.next(c=>M.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?M.resolve():this.remoteDocumentCache.getEntry(e,u).next(f=>{l=l.insert(u,f)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Ke())).next(u=>({batchId:a,changes:OO(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new fe(n)).next(r=>{let s=$d();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=$d();return this.indexManager.getCollectionParents(e,i).next(a=>M.forEach(a,l=>{const c=function(h,f){return new Xi(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(u=>{u.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,jt.newInvalidDocument(u)))});let a=$d();return o.forEach((l,c)=>{const u=i.get(l);u!==void 0&&lh(u.mutation,c,jr.empty(),_t.now()),If(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return M.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:_n(s.createTime)}}(n)),M.resolve()}getNamedQuery(e,n){return M.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:yy(s.bundledQuery),readTime:_n(s.readTime)}}(n)),M.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J7{constructor(){this.overlays=new Vt(fe.comparator),this.qr=new Map}getOverlay(e,n){return M.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ii();return M.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),M.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),M.resolve()}getOverlaysForCollection(e,n,r){const s=ii(),i=n.length+1,o=new fe(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return M.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Vt((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=ii(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=ii(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return M.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new fI(n,r));let i=this.qr.get(n);i===void 0&&(i=Ke(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(){this.sessionToken=cn.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,M.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{constructor(){this.Qr=new xt(Qn.$r),this.Ur=new xt(Qn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Qn(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Qn(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new fe(new it([])),r=new Qn(n,e),s=new Qn(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new fe(new it([])),r=new Qn(n,e),s=new Qn(n,e+1);let i=Ke();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Qn(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Qn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return fe.comparator(e.key,n.key)||je(e.Yr,n.Yr)}static Kr(e,n){return je(e.Yr,n.Yr)||fe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new xt(Qn.$r)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new dI(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new Qn(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return M.resolve(o)}lookupMutationBatch(e,n){return M.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return M.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?na:this.tr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Qn(n,0),s=new Qn(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),M.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xt(je);return n.forEach(s=>{const i=new Qn(s,0),o=new Qn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),M.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;fe.isDocumentKey(i)||(i=i.child(""));const o=new Qn(new fe(i),0);let a=new xt(je);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Yr)),!0)},o),M.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Re(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return M.forEach(n.mutations,s=>{const i=new Qn(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Qn(n,0),s=this.Zr.firstAfterOrEqual(r);return M.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eH{constructor(e){this.ri=e,this.docs=function(){return new Vt(fe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return M.resolve(r?r.document.mutableCopy():jt.newInvalidDocument(n))}getEntries(e,n){let r=$r();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():jt.newInvalidDocument(s))}),M.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=$r();const o=n.path,a=new fe(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||XE(GD(u),r)<=0||(s.has(u.key)||If(n,u))&&(i=i.insert(u.key,u.mutableCopy()))}return M.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Te(9500)}ii(e,n){return M.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new tH(this)}getSize(e){return M.resolve(this.size)}}class tH extends v2{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),M.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nH{constructor(e){this.persistence=e,this.si=new Zi(n=>bl(n),wf),this.lastRemoteSnapshotVersion=De.min(),this.highestTargetId=0,this.oi=0,this._i=new vI,this.targetCount=0,this.ai=Cl.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),M.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Cl(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,M.resolve()}updateTargetData(e,n){return this.Pr(n),M.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),M.waitFor(i).next(()=>s)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return M.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),M.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),M.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),M.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return M.resolve(r)}containsKey(e,n){return M.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{constructor(e,n){this.ui={},this.overlays={},this.ci=new Ur(0),this.li=!1,this.li=!0,this.hi=new X7,this.referenceDelegate=e(this),this.Pi=new nH(this),this.indexManager=new $7,this.remoteDocumentCache=function(s){return new eH(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new a2(n),this.Ii=new Y7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new J7,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new Z7(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const s=new rH(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return M.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class rH extends YD{constructor(e){super(),this.currentSequenceNumber=e}}class wy{constructor(e){this.persistence=e,this.Ri=new vI,this.Vi=null}static mi(e){return new wy(e)}get fi(){if(this.Vi)return this.Vi;throw Te(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),M.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),M.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),M.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.fi,r=>{const s=fe.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,De.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return M.or([()=>M.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class lg{constructor(e,n){this.persistence=e,this.pi=new Zi(r=>gr(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=y2(this,n)}static mi(e,n){return new lg(e,n)}Ei(){}di(e){return M.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return M.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?M.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,De.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),M.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),M.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Xm(e.data.value)),n}br(e,n,r){return M.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return M.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sH{constructor(e){this.serializer=e}k(e,n,r,s){const i=new oy("createOrUpgrade",n);r<1&&s>=1&&(function(l){l.createObjectStore(_f)}(e),function(l){l.createObjectStore(Bh,{keyPath:I8}),l.createObjectStore(xs,{keyPath:HA,autoIncrement:!0}).createIndex(tl,KA,{unique:!0}),l.createObjectStore(vu)}(e),Mx(e),function(l){l.createObjectStore($a)}(e));let o=M.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore(wu),l.deleteObjectStore(_u),l.deleteObjectStore(hl)}(e),Mx(e)),o=o.next(()=>function(l){const c=l.store(hl),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:De.min().toTimestamp(),targetCount:0};return c.put(tg,u)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store(xs).J().next(h=>{l.deleteObjectStore(xs),l.createObjectStore(xs,{keyPath:HA,autoIncrement:!0}).createIndex(tl,KA,{unique:!0});const f=c.store(xs),m=h.map(E=>f.put(E));return M.waitFor(m)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore(Eu,{keyPath:k8})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(zh)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(ay,{keyPath:N8})})(e),function(l){l.createObjectStore(ly,{keyPath:D8})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore(cy,{keyPath:j8});c.createIndex(Ow,$8,{unique:!1}),c.createIndex(sO,B8,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore(eg,{keyPath:S8});c.createIndex(Ym,b8),c.createIndex(eO,A8)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore($a))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore(tI,{keyPath:O8,autoIncrement:!0}).createIndex(Dw,L8,{unique:!1}),l.createObjectStore(sh,{keyPath:M8}).createIndex(nO,V8,{unique:!1}),l.createObjectStore(ih,{keyPath:F8}).createIndex(rO,U8,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(sh).clear()}).next(()=>{n.objectStore(ih).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(nI,{keyPath:z8})})(e)})),r<18&&s>=18&&FN()&&(o=o.next(()=>{n.objectStore(sh).clear()}).next(()=>{n.objectStore(ih).clear()})),o}wi(e){let n=0;return e.store($a).ee((r,s)=>{n+=ag(s)}).next(()=>{const r={byteSize:n};return e.store(zh).put(Nw,r)})}yi(e){const n=e.store(Bh),r=e.store(xs);return n.J().next(s=>M.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,na],[i.userId,i.lastAcknowledgedBatchId]);return r.J(tl,o).next(a=>M.forEach(a,l=>{Re(l.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=Wa(this.serializer,l);return h2(e,i.userId,c).next(()=>{})}))}))}Si(e){const n=e.store(wu),r=e.store($a);return e.store(hl).get(tg).next(s=>{const i=[];return r.ee((o,a)=>{const l=new it(o),c=function(h){return[0,gr(h)]}(l);i.push(n.get(c).next(u=>u?M.resolve():(h=>n.put({targetId:0,path:gr(h),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>M.waitFor(i))})}bi(e,n){e.createObjectStore(Wh,{keyPath:C8});const r=n.store(Wh),s=new yI,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:gr(l)})}};return n.store($a).ee({X:!0},(o,a)=>{const l=new it(o);return i(l.popLast())}).next(()=>n.store(vu).ee({X:!0},([o,a,l],c)=>{const u=si(a);return i(u.popLast())}))}Di(e){const n=e.store(_u);return n.ee((r,s)=>{const i=zd(s),o=l2(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store($a),s=[];return r.ee((i,o)=>{const a=n.store(eg),l=function(h){return h.document?new fe(it.fromString(h.document.name).popFirst(5)):h.noDocument?fe.fromSegments(h.noDocument.path):h.unknownDocument?fe.fromSegments(h.unknownDocument.path):Te(36783)}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>M.waitFor(s))}Fi(e,n){const r=n.store(xs),s=_2(this.serializer),i=new _I(wy.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let c=a.get(l.userId)??Ke();Wa(this.serializer,l).keys().forEach(u=>c=c.add(u)),a.set(l.userId,c)}),M.forEach(a,(l,c)=>{const u=new Jn(c),h=vy.wt(this.serializer,u),f=i.getIndexManager(u),m=_y.wt(u,this.serializer,f,i.referenceDelegate);return new w2(s,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new Lw(n,Ur.ce),l).next()})})}}function Mx(t){t.createObjectStore(wu,{keyPath:R8}).createIndex(eI,P8,{unique:!0}),t.createObjectStore(_u,{keyPath:"targetId"}).createIndex(tO,x8,{unique:!0}),t.createObjectStore(hl)}const go="IndexedDbPersistence",Lv=18e5,Mv=5e3,Vv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",E2="main";class wI{constructor(e,n,r,s,i,o,a,l,c,u,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=c,this.Oi=u,this.Ni=h,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=f=>Promise.resolve(),!wI.v())throw new J(U.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new H7(this,s),this.$i=n+E2,this.serializer=new a2(l),this.Ui=new hi(this.$i,this.Ni,new sH(this.serializer)),this.hi=new L7,this.Pi=new z7(this.referenceDelegate,this.serializer),this.remoteDocumentCache=_2(this.serializer),this.Ii=new O7,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,u===!1&&yn(go,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new J(U.FAILED_PRECONDITION,Vv);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new Ur(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ym(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(Ta(e))return ee(go,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ee(go,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Cd(e).get(Jl).next(n=>M.resolve(this.es(n)))}ts(e){return ym(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Lv)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Bn(n,Eu);return r.J().next(s=>{const i=this.ss(s,Lv),o=s.filter(a=>i.indexOf(a)===-1);return M.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?M.resolve(!0):Cd(e).get(Jl).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Mv)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new J(U.FAILED_PRECONDITION,Vv);return!1}}return!(!this.networkEnabled||!this.inForeground)||ym(e).J().next(r=>this.ss(r,Mv).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&ee(go,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[_f,Eu],e=>{const n=new Lw(e,Ur.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>ym(e).J().next(n=>this.ss(n,Lv).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return _y.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new B7(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vy.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee(go,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(l){return l===18?H8:l===17?lO:l===16?q8:l===15?rI:l===14?aO:l===13?oO:l===12?W8:l===11?iO:void Te(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new Lw(a,this.ci?this.ci.next():Ur.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw yn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new J(U.FAILED_PRECONDITION,QD);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return Cd(e).get(Jl).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Mv)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new J(U.FAILED_PRECONDITION,Vv)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Cd(e).put(Jl,n)}static v(){return hi.v()}Zi(e){const n=Cd(e);return n.get(Jl).next(r=>this.es(r)?(ee(go,"Releasing primary lease."),n.delete(Jl)):M.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(yn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;VN()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return ee(go,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return yn(go,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){yn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Cd(t){return Bn(t,_f)}function ym(t){return Bn(t,Eu)}function EI(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=Ke(),s=Ke();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new II(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iH{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return VN()?8:JD(jn())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new iH;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(lc()<=dt.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",cc(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),M.resolve()):(lc()<=dt.DEBUG&&ee("QueryEngine","Query:",cc(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(lc()<=dt.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",cc(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yr(n))):M.resolve())}ys(e,n){if(ox(n))return M.resolve(null);let r=yr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=sg(n,null,"F"),r=yr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ke(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.Ds(n,a);return this.Cs(n,c,o,l.readTime)?this.ys(e,sg(n,null,"F")):this.vs(e,c,n,l)}))})))}ws(e,n,r,s){return ox(n)||s.isEqual(De.min())?M.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?M.resolve(null):(lc()<=dt.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),cc(n)),this.vs(e,o,n,KD(s,pu)).next(a=>a))})}Ds(e,n){let r=new xt(NO(e));return n.forEach((s,i)=>{If(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return lc()<=dt.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",cc(n)),this.ps.getDocumentsMatchingQuery(e,n,os.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI="LocalStore",oH=3e8;class aH{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new Vt(je),this.xs=new Zi(i=>bl(i),wf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new w2(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function T2(t,e,n,r){return new aH(t,e,n,r)}async function S2(t,e){const n=pe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Ke();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Ls:c,removedBatchIds:o,addedBatchIds:a}))})})}function lH(t,e){const n=pe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const h=c.batch,f=h.keys();let m=M.resolve();return f.forEach(E=>{m=m.next(()=>u.getEntry(l,E)).next(p=>{const I=c.docVersions.get(E);Re(I!==null,48541),p.version.compareTo(I)<0&&(h.applyToRemoteDocument(p,c),p.isValidDocument()&&(p.setReadTime(c.commitVersion),u.addEntry(p)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ke();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function b2(t){const e=pe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function cH(t,e){const n=pe(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((u,h)=>{const f=s.get(h);if(!f)return;a.push(n.Pi.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.Pi.addMatchingKeys(i,u.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(cn.EMPTY_BYTE_STRING,De.min()).withLastLimboFreeSnapshotVersion(De.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,r)),s=s.insert(h,m),function(p,I,g){return p.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=oH?!0:g.addedDocuments.size+g.modifiedDocuments.size+g.removedDocuments.size>0}(f,m,u)&&a.push(n.Pi.updateTargetData(i,m))});let l=$r(),c=Ke();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(A2(i,o,e.documentUpdates).next(u=>{l=u.ks,c=u.qs})),!r.isEqual(De.min())){const u=n.Pi.getLastRemoteSnapshotVersion(i).next(h=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return M.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.Ms=s,i))}function A2(t,e,n){let r=Ke(),s=Ke();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=$r();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(De.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ee(TI,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{ks:o,qs:s}})}function uH(t,e){const n=pe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=na),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ru(t,e){const n=pe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,M.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new Di(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Pu(t,e,n){const r=pe(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ta(o))throw o;ee(TI,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function cg(t,e,n){const r=pe(t);let s=De.min(),i=Ke();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const h=pe(l),f=h.xs.get(u);return f!==void 0?M.resolve(h.Ms.get(f)):h.Pi.getTargetData(c,u)}(r,o,yr(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:De.min(),n?i:Ke())).next(a=>(P2(r,kO(e),a),{documents:a,Qs:i})))}function x2(t,e){const n=pe(t),r=pe(n.Pi),s=n.Ms.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.At(i,e).next(o=>o?o.target:null))}function R2(t,e){const n=pe(t),r=n.Os.get(e)||De.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.Ns.getAllFromCollectionGroup(s,e,KD(r,pu),Number.MAX_SAFE_INTEGER)).then(s=>(P2(n,e,s),s))}function P2(t,e,n){let r=t.Os.get(e)||De.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}async function dH(t,e,n,r){const s=pe(t);let i=Ke(),o=$r();for(const c of n){const u=e.$s(c.metadata.name);c.document&&(i=i.add(u));const h=e.Us(c);h.setReadTime(e.Ks(c.metadata.readTime)),o=o.insert(u,h)}const a=s.Ns.newChangeBuffer({trackRemovals:!0}),l=await Ru(s,function(u){return yr(Qu(it.fromString(`__bundle__/docs/${u}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",c=>A2(c,a,o).next(u=>(a.apply(c),u)).next(u=>s.Pi.removeMatchingKeysForTargetId(c,l.targetId).next(()=>s.Pi.addMatchingKeys(c,i,l.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(c,u.ks,u.qs)).next(()=>u.ks)))}async function hH(t,e,n=Ke()){const r=await Ru(t,yr(yy(e.bundledQuery))),s=pe(t);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=_n(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Ii.saveNamedQuery(i,e);const a=r.withResumeToken(cn.EMPTY_BYTE_STRING,o);return s.Ms=s.Ms.insert(a.targetId,a),s.Pi.updateTargetData(i,a).next(()=>s.Pi.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Pi.addMatchingKeys(i,n,r.targetId)).next(()=>s.Ii.saveNamedQuery(i,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2="firestore_clients";function Vx(t,e){return`${C2}_${t}_${e}`}const k2="firestore_mutations";function Fx(t,e,n){let r=`${k2}_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const N2="firestore_targets";function Fv(t,e){return`${N2}_${t}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs="SharedClientState";class ug{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Ws(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new J(s.error.code,s.error.message))),o?new ug(e,n,s.state,i):(yn(Zs,`Failed to parse mutation state for ID '${n}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class uh{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ws(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new J(r.error.code,r.error.message))),i?new uh(e,r.state,s):(yn(Zs,`Failed to parse target state for ID '${e}': ${n}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class dg{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ws(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=lI();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=XD(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new dg(e,i):(yn(Zs,`Failed to parse client data for instance '${e}': ${n}`),null)}}class SI{constructor(e,n){this.clientId=e,this.onlineState=n}static Ws(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new SI(n.clientId,n.onlineState):(yn(Zs,`Failed to parse online state: ${e}`),null)}}class Qw{constructor(){this.activeTargetIds=lI()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Uv{constructor(e,n,r,s,i){this.window=e,this.Mi=n,this.persistenceKey=r,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new Vt(je),this.started=!1,this.Xs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.eo=Vx(this.persistenceKey,this.Js),this.no=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Qw),this.ro=new RegExp(`^${C2}_${o}_([^_]*)$`),this.io=new RegExp(`^${k2}_${o}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${N2}_${o}_(\\d+)$`),this.oo=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this._o=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const s=this.getItem(Vx(this.persistenceKey,r));if(s){const i=dg.Ws(r,s);i&&(this.Zs=this.Zs.insert(i.clientId,i))}}this.ao();const n=this.storage.getItem(this.oo);if(n){const r=this.uo(n);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let n=!1;return this.Zs.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,n,r){this.ho(e,n,r),this.Po(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Fv(this.persistenceKey,e));if(s){const i=uh.Ws(e,s);i&&(r=i.state)}}return n&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Fv(this.persistenceKey,e))}updateQueryState(e,n,r){this.Io(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Po(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return ee(Zs,"READ",e,n),n}setItem(e,n){ee(Zs,"SET",e,n),this.storage.setItem(e,n)}removeItem(e){ee(Zs,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const n=e;if(n.storageArea===this.storage){if(ee(Zs,"EVENT",n.key,n.newValue),n.key===this.eo)return void yn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.ro.test(n.key)){if(n.newValue==null){const r=this.Ro(n.key);return this.Vo(r,null)}{const r=this.mo(n.key,n.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(n.key)){if(n.newValue!==null){const r=this.fo(n.key,n.newValue);if(r)return this.po(r)}}else if(this.so.test(n.key)){if(n.newValue!==null){const r=this.yo(n.key,n.newValue);if(r)return this.wo(r)}}else if(n.key===this.oo){if(n.newValue!==null){const r=this.uo(n.newValue);if(r)return this.co(r)}}else if(n.key===this.no){const r=function(i){let o=Ur.ce;if(i!=null)try{const a=JSON.parse(i);Re(typeof a=="number",30636,{So:i}),o=a}catch(a){yn(Zs,"Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Ur.ce&&this.sequenceNumberHandler(r)}else if(n.key===this._o){const r=this.bo(n.newValue);await Promise.all(r.map(s=>this.syncEngine.Do(s)))}}}else this.Xs.push(n)})}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,n,r){const s=new ug(this.currentUser,e,n,r),i=Fx(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Gs())}Po(e){const n=Fx(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Eo(e){const n={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(n))}Io(e,n,r){const s=Fv(this.persistenceKey,e),i=new uh(e,n,r);this.setItem(s,i.Gs())}Ao(e){const n=JSON.stringify(Array.from(e));this.setItem(this._o,n)}Ro(e){const n=this.ro.exec(e);return n?n[1]:null}mo(e,n){const r=this.Ro(e);return dg.Ws(r,n)}fo(e,n){const r=this.io.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return ug.Ws(new Jn(i),s,n)}yo(e,n){const r=this.so.exec(e),s=Number(r[1]);return uh.Ws(s,n)}uo(e){return SI.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ee(Zs,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,n){const r=n?this.Zs.insert(e,n):this.Zs.remove(e),s=this.lo(this.Zs),i=this.lo(r),o=[],a=[];return i.forEach(l=>{s.has(l)||o.push(l)}),s.forEach(l=>{i.has(l)||a.push(l)}),this.syncEngine.Fo(o,a).then(()=>{this.Zs=r})}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let n=lI();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class D2{constructor(){this.Mo=new Qw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Qw,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fH{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux="ConnectivityMonitor";class jx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee(Ux,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee(Ux,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vm=null;function Yw(){return vm===null?vm=function(){return 268435456+Math.round(2147483648*Math.random())}():vm++,"0x"+vm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv="RestConnection",mH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pH{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Hh?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=Yw(),a=this.zo(e,n.toUriEncodedString());ee(jv,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:c}=new URL(a),u=$s(c);return this.Jo(e,a,l,r,u).then(h=>(ee(jv,`Received RPC '${e}' ${o}: `,h),h),h=>{throw is(jv,`RPC '${e}' ${o} failed with error: `,h,"url: ",a,"request:",r),h})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Gu}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=mH[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gH{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr="WebChannelConnection";class yH extends pH{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=Yw();return new Promise((a,l)=>{const c=new OD;c.setWithCredentials(!0),c.listenOnce(LD.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Gm.NO_ERROR:const h=c.getResponseJson();ee(fr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),a(h);break;case Gm.TIMEOUT:ee(fr,`RPC '${e}' ${o} timed out`),l(new J(U.DEADLINE_EXCEEDED,"Request time out"));break;case Gm.HTTP_ERROR:const f=c.getStatus();if(ee(fr,`RPC '${e}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const E=m==null?void 0:m.error;if(E&&E.status&&E.message){const p=function(g){const _=g.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(_)>=0?_:U.UNKNOWN}(E.status);l(new J(p,E.message))}else l(new J(U.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new J(U.UNAVAILABLE,"Connection failed."));break;default:Te(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{ee(fr,`RPC '${e}' ${o} completed.`)}});const u=JSON.stringify(s);ee(fr,`RPC '${e}' ${o} sending request:`,s),c.send(n,"POST",u,r,15)})}T_(e,n,r){const s=Yw(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=FD(),a=VD(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const u=i.join("");ee(fr,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=o.createWebChannel(u,l);this.I_(h);let f=!1,m=!1;const E=new gH({Yo:I=>{m?ee(fr,`Not sending because RPC '${e}' stream ${s} is closed:`,I):(f||(ee(fr,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),ee(fr,`RPC '${e}' stream ${s} sending:`,I),h.send(I))},Zo:()=>h.close()}),p=(I,g,_)=>{I.listen(g,w=>{try{_(w)}catch(A){setTimeout(()=>{throw A},0)}})};return p(h,jd.EventType.OPEN,()=>{m||(ee(fr,`RPC '${e}' stream ${s} transport opened.`),E.o_())}),p(h,jd.EventType.CLOSE,()=>{m||(m=!0,ee(fr,`RPC '${e}' stream ${s} transport closed`),E.a_(),this.E_(h))}),p(h,jd.EventType.ERROR,I=>{m||(m=!0,is(fr,`RPC '${e}' stream ${s} transport errored. Name:`,I.name,"Message:",I.message),E.a_(new J(U.UNAVAILABLE,"The operation could not be completed")))}),p(h,jd.EventType.MESSAGE,I=>{var g;if(!m){const _=I.data[0];Re(!!_,16349);const w=_,A=(w==null?void 0:w.error)||((g=w[0])==null?void 0:g.error);if(A){ee(fr,`RPC '${e}' stream ${s} received error:`,A);const P=A.status;let L=function(R){const C=An[R];if(C!==void 0)return HO(C)}(P),x=A.message;L===void 0&&(L=U.INTERNAL,x="Unknown error status: "+P+" with message "+A.message),m=!0,E.a_(new J(L,x)),h.close()}else ee(fr,`RPC '${e}' stream ${s} received:`,_),E.u_(_)}}),p(a,MD.STAT_EVENT,I=>{I.stat===xw.PROXY?ee(fr,`RPC '${e}' stream ${s} detected buffering proxy`):I.stat===xw.NOPROXY&&ee(fr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{E.__()},0),E}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(){return typeof window<"u"?window:null}function rp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wl(t){return new T7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&ee("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x="PersistentStream";class L2{constructor(e,n,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new bI(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(yn(n.toString()),yn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new J(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee($x,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee($x,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class vH extends L2{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=A7(this.serializer,e),r=function(i){if(!("targetChange"in i))return De.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?De.min():o.readTime?_n(o.readTime):De.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Ww(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=ng(l)?{documents:t2(i,l)}:{query:gy(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=YO(i,o.resumeToken);const c=Bw(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(De.min())>0){a.readTime=xu(i,o.snapshotVersion.toTimestamp());const c=Bw(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=R7(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Ww(this.serializer),n.removeTarget=e,this.q_(n)}}class _H extends L2{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Re(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Re(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Re(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=x7(e.writeResults,e.commitTime),r=_n(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Ww(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Jh(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wH{}class EH extends wH{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new J(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,zw(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new J(U.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,zw(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new J(U.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class IH{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(yn(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kl="RemoteStore";class TH{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ba(this)&&(ee(kl,"Restarting streams for network reachability change."),await async function(l){const c=pe(l);c.Ea.add(4),await Xu(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Af(c)}(this))})}),this.Ra=new IH(r,s)}}async function Af(t){if(ba(t))for(const e of t.da)await e(!0)}async function Xu(t){for(const e of t.da)await e(!1)}function Ey(t,e){const n=pe(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),RI(n)?xI(n):ed(n).O_()&&AI(n,e))}function Cu(t,e){const n=pe(t),r=ed(n);n.Ia.delete(e),r.O_()&&M2(n,e),n.Ia.size===0&&(r.O_()?r.L_():ba(n)&&n.Ra.set("Unknown"))}function AI(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(De.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ed(t).Y_(e)}function M2(t,e){t.Va.Ue(e),ed(t).Z_(e)}function xI(t){t.Va=new _7({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ed(t).start(),t.Ra.ua()}function RI(t){return ba(t)&&!ed(t).x_()&&t.Ia.size>0}function ba(t){return pe(t).Ea.size===0}function V2(t){t.Va=void 0}async function SH(t){t.Ra.set("Online")}async function bH(t){t.Ia.forEach((e,n)=>{AI(t,e)})}async function AH(t,e){V2(t),RI(t)?(t.Ra.ha(e),xI(t)):t.Ra.set("Unknown")}async function xH(t,e,n){if(t.Ra.set("Online"),e instanceof QO&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){ee(kl,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await hg(t,r)}else if(e instanceof tp?t.Va.Ze(e):e instanceof GO?t.Va.st(e):t.Va.tt(e),!n.isEqual(De.min()))try{const r=await b2(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.Ia.get(c);u&&i.Ia.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=i.Ia.get(l);if(!u)return;i.Ia.set(l,u.withResumeToken(cn.EMPTY_BYTE_STRING,u.snapshotVersion)),M2(i,l);const h=new Di(u.target,l,c,u.sequenceNumber);AI(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ee(kl,"Failed to raise snapshot:",r),await hg(t,r)}}async function hg(t,e,n){if(!Ta(e))throw e;t.Ea.add(1),await Xu(t),t.Ra.set("Offline"),n||(n=()=>b2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(kl,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Af(t)})}function F2(t,e){return e().catch(n=>hg(t,n,e))}async function Zu(t){const e=pe(t),n=ma(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:na;for(;RH(e);)try{const s=await uH(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,PH(e,s)}catch(s){await hg(e,s)}U2(e)&&j2(e)}function RH(t){return ba(t)&&t.Ta.length<10}function PH(t,e){t.Ta.push(e);const n=ma(t);n.O_()&&n.X_&&n.ea(e.mutations)}function U2(t){return ba(t)&&!ma(t).x_()&&t.Ta.length>0}function j2(t){ma(t).start()}async function CH(t){ma(t).ra()}async function kH(t){const e=ma(t);for(const n of t.Ta)e.ea(n.mutations)}async function NH(t,e,n){const r=t.Ta.shift(),s=hI.from(r,e,n);await F2(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Zu(t)}async function DH(t,e){e&&ma(t).X_&&await async function(r,s){if(function(o){return qO(o)&&o!==U.ABORTED}(s.code)){const i=r.Ta.shift();ma(r).B_(),await F2(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Zu(r)}}(t,e),U2(t)&&j2(t)}async function Bx(t,e){const n=pe(t);n.asyncQueue.verifyOperationInProgress(),ee(kl,"RemoteStore received new credentials");const r=ba(n);n.Ea.add(3),await Xu(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Af(n)}async function Jw(t,e){const n=pe(t);e?(n.Ea.delete(2),await Af(n)):e||(n.Ea.add(2),await Xu(n),n.Ra.set("Unknown"))}function ed(t){return t.ma||(t.ma=function(n,r,s){const i=pe(n);return i.sa(),new vH(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:SH.bind(null,t),t_:bH.bind(null,t),r_:AH.bind(null,t),H_:xH.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),RI(t)?xI(t):t.Ra.set("Unknown")):(await t.ma.stop(),V2(t))})),t.ma}function ma(t){return t.fa||(t.fa=function(n,r,s){const i=pe(n);return i.sa(),new _H(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:CH.bind(null,t),r_:DH.bind(null,t),ta:kH.bind(null,t),na:NH.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Zu(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(kl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new PI(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new J(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function td(t,e){if(yn("AsyncQueue",`${e}: ${t}`),Ta(t))return new J(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{static emptySet(e){return new fl(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||fe.comparator(n.key,r.key):(n,r)=>fe.comparator(n.key,r.key),this.keyedMap=$d(),this.sortedSet=new Vt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof fl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new fl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(){this.ga=new Vt(fe.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Te(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Nl{constructor(e,n,r,s,i,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Nl(e,n,fl.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ef(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OH{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class LH{constructor(){this.queries=Wx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=pe(n),i=s.queries;s.queries=Wx(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new J(U.ABORTED,"Firestore shutting down"))}}function Wx(){return new Zi(t=>CO(t),Ef)}async function CI(t,e){const n=pe(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new OH,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=td(o,`Initialization of query '${cc(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&NI(n)}async function kI(t,e){const n=pe(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function MH(t,e){const n=pe(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&NI(n)}function VH(t,e,n){const r=pe(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function NI(t){t.Ca.forEach(e=>{e.next()})}var Xw,qx;(qx=Xw||(Xw={})).Ma="default",qx.Cache="cache";class DI{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Nl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Nl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Xw.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,n){this.Qa=e,this.byteLength=n}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(e){this.serializer=e}$s(e){return fi(this.serializer,e)}Us(e){return e.metadata.exists?py(this.serializer,e.document,!1):jt.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return _n(e)}}class OI{constructor(e,n){this.Ua=e,this.serializer=n,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=B2(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++n;const r=it.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,{...this.progress}):null}za(e){const n=new Map,r=new Hx(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.$s(s.metadata.name);for(const o of s.metadata.queries){const a=(n.get(o)||Ke()).add(i);n.set(o,a)}}return n}async ja(e){const n=await dH(e,new Hx(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const s of this.Ka)await hH(e,s,r.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:n}}}function B2(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e){this.key=e}}class W2{constructor(e){this.key=e}}class q2{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ke(),this.mutatedKeys=Ke(),this.eu=NO(e),this.tu=new fl(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new zx,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const f=s.get(u),m=If(this.query,h)?h:null,E=!!f&&this.mutatedKeys.has(f.key),p=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let I=!1;f&&m?f.data.isEqual(m.data)?E!==p&&(r.track({type:3,doc:m}),I=!0):this.su(f,m)||(r.track({type:2,doc:m}),I=!0,(l&&this.eu(m,l)>0||c&&this.eu(m,c)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),I=!0):f&&!m&&(r.track({type:1,doc:f}),I=!0,(l||c)&&(a=!0)),I&&(m?(o=o.add(m),i=p?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((u,h)=>function(m,E){const p=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Te(20277,{Rt:I})}};return p(m)-p(E)}(u.type,h.type)||this.eu(u.doc,h.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new Nl(this.query,e.tu,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new zx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ke(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new W2(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new z2(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ke();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Nl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Aa="SyncEngine";class FH{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class UH{constructor(e){this.key=e,this.hu=!1}}class jH{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Zi(a=>CO(a),Ef),this.Iu=new Map,this.Eu=new Set,this.du=new Vt(fe.comparator),this.Au=new Map,this.Ru=new vI,this.Vu={},this.mu=new Map,this.fu=Cl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function $H(t,e,n=!0){const r=Iy(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await H2(r,e,n,!0),s}async function BH(t,e){const n=Iy(t);await H2(n,e,!0,!1)}async function H2(t,e,n,r){const s=await Ru(t.localStore,yr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await LI(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Ey(t.remoteStore,s),a}async function LI(t,e,n,r,s){t.pu=(h,f,m)=>async function(p,I,g,_){let w=I.view.ru(g);w.Cs&&(w=await cg(p.localStore,I.query,!1).then(({documents:x})=>I.view.ru(x,w)));const A=_&&_.targetChanges.get(I.targetId),P=_&&_.targetMismatches.get(I.targetId)!=null,L=I.view.applyChanges(w,p.isPrimaryClient,A,P);return Zw(p,I.targetId,L.au),L.snapshot}(t,h,f,m);const i=await cg(t.localStore,e,!0),o=new q2(e,i.Qs),a=o.ru(i.documents),l=bf.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=o.applyChanges(a,t.isPrimaryClient,l);Zw(t,n,c.au);const u=new FH(e,n,o);return t.Tu.set(e,u),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),c.snapshot}async function zH(t,e,n){const r=pe(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Ef(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Pu(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Cu(r.remoteStore,s.targetId),ku(r,s.targetId)}).catch(Ia)):(ku(r,s.targetId),await Pu(r.localStore,s.targetId,!0))}async function WH(t,e){const n=pe(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Cu(n.remoteStore,r.targetId))}async function qH(t,e,n){const r=UI(t);try{const s=await function(o,a){const l=pe(o),c=_t.now(),u=a.reduce((m,E)=>m.add(E.key),Ke());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let E=$r(),p=Ke();return l.Ns.getEntries(m,u).next(I=>{E=I,E.forEach((g,_)=>{_.isValidDocument()||(p=p.add(g))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,E)).next(I=>{h=I;const g=[];for(const _ of a){const w=g7(_,h.get(_.key).overlayedDocument);w!=null&&g.push(new eo(_.key,w,_O(w.value.mapValue),Gt.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,g,a)}).next(I=>{f=I;const g=I.applyToLocalDocumentSet(h,p);return l.documentOverlayCache.saveOverlays(m,I.batchId,g)})}).then(()=>({batchId:f.batchId,changes:OO(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new Vt(je)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c}(r,s.batchId,n),await to(r,s.changes),await Zu(r.remoteStore)}catch(s){const i=td(s,"Failed to persist write");n.reject(i)}}async function K2(t,e){const n=pe(t);try{const r=await cH(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(Re(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Re(o.hu,14607):s.removedDocuments.size>0&&(Re(o.hu,42227),o.hu=!1))}),await to(n,r,e)}catch(r){await Ia(r)}}function Kx(t,e,n){const r=pe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=pe(o);l.onlineState=a;let c=!1;l.queries.forEach((u,h)=>{for(const f of h.Sa)f.va(a)&&(c=!0)}),c&&NI(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function HH(t,e,n){const r=pe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Vt(fe.comparator);o=o.insert(i,jt.newNoDocument(i,De.min()));const a=Ke().add(i),l=new Sf(De.min(),new Map,new Vt(je),o,a);await K2(r,l),r.du=r.du.remove(i),r.Au.delete(e),FI(r)}else await Pu(r.localStore,e,!1).then(()=>ku(r,e,n)).catch(Ia)}async function KH(t,e){const n=pe(t),r=e.batch.batchId;try{const s=await lH(n.localStore,e);VI(n,r,null),MI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await to(n,s)}catch(s){await Ia(s)}}async function GH(t,e,n){const r=pe(t);try{const s=await function(o,a){const l=pe(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(Re(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);VI(r,e,n),MI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await to(r,s)}catch(s){await Ia(s)}}async function QH(t,e){const n=pe(t);ba(n.remoteStore)||ee(Aa,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=pe(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(n.localStore);if(r===na)return void e.resolve();const s=n.mu.get(r)||[];s.push(e),n.mu.set(r,s)}catch(r){const s=td(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function MI(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function VI(t,e,n){const r=pe(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function ku(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||G2(t,r)})}function G2(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Cu(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),FI(t))}function Zw(t,e,n){for(const r of n)r instanceof z2?(t.Ru.addReference(r.key,e),YH(t,r)):r instanceof W2?(ee(Aa,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||G2(t,r.key)):Te(19791,{wu:r})}function YH(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ee(Aa,"New document in limbo: "+n),t.Eu.add(r),FI(t))}function FI(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new fe(it.fromString(e)),r=t.fu.next();t.Au.set(r,new UH(n)),t.du=t.du.insert(n,r),Ey(t.remoteStore,new Di(yr(Qu(n.path)),r,"TargetPurposeLimboResolution",Ur.ce))}}async function to(t,e,n){const r=pe(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(c=>{var u;if((c||n)&&r.isPrimaryClient){const h=c?!c.fromCache:(u=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:u.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=II.As(l.targetId,c);i.push(h)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,c){const u=pe(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>M.forEach(c,f=>M.forEach(f.Es,m=>u.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>M.forEach(f.ds,m=>u.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!Ta(h))throw h;ee(TI,"Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const m=u.Ms.get(f),E=m.snapshotVersion,p=m.withLastLimboFreeSnapshotVersion(E);u.Ms=u.Ms.insert(f,p)}}}(r.localStore,i))}async function JH(t,e){const n=pe(t);if(!n.currentUser.isEqual(e)){ee(Aa,"User change. New user:",e.toKey());const r=await S2(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new J(U.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await to(n,r.Ls)}}function XH(t,e){const n=pe(t),r=n.Au.get(e);if(r&&r.hu)return Ke().add(r.key);{let s=Ke();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}async function ZH(t,e){const n=pe(t),r=await cg(n.localStore,e.query,!0),s=e.view.cu(r);return n.isPrimaryClient&&Zw(n,e.targetId,s.au),s}async function eK(t,e){const n=pe(t);return R2(n.localStore,e).then(r=>to(n,r))}async function tK(t,e,n,r){const s=pe(t),i=await function(a,l){const c=pe(a),u=pe(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",h=>u.er(h,l).next(f=>f?c.localDocuments.getDocuments(h,f):M.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await Zu(s.remoteStore):n==="acknowledged"||n==="rejected"?(VI(s,e,r||null),MI(s,e),function(a,l){pe(pe(a).mutationQueue).ir(l)}(s.localStore,e)):Te(6720,"Unknown batchState",{Su:n}),await to(s,i)):ee(Aa,"Cannot apply mutation batch with id: "+e)}async function nK(t,e){const n=pe(t);if(Iy(n),UI(n),e===!0&&n.gu!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await Gx(n,r.toArray());n.gu=!0,await Jw(n.remoteStore,!0);for(const i of s)Ey(n.remoteStore,i)}else if(e===!1&&n.gu!==!1){const r=[];let s=Promise.resolve();n.Iu.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(ku(n,o),Pu(n.localStore,o,!0))),Cu(n.remoteStore,o)}),await s,await Gx(n,r),function(o){const a=pe(o);a.Au.forEach((l,c)=>{Cu(a.remoteStore,c)}),a.Ru.Jr(),a.Au=new Map,a.du=new Vt(fe.comparator)}(n),n.gu=!1,await Jw(n.remoteStore,!1)}}async function Gx(t,e,n){const r=pe(t),s=[],i=[];for(const o of e){let a;const l=r.Iu.get(o);if(l&&l.length!==0){a=await Ru(r.localStore,yr(l[0]));for(const c of l){const u=r.Tu.get(c),h=await ZH(r,u);h.snapshot&&i.push(h.snapshot)}}else{const c=await x2(r.localStore,o);a=await Ru(r.localStore,c),await LI(r,Q2(c),o,!1,a.resumeToken)}s.push(a)}return r.Pu.H_(i),s}function Q2(t){return xO(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function rK(t){return function(n){return pe(pe(n).persistence).Ts()}(pe(t).localStore)}async function sK(t,e,n,r){const s=pe(t);if(s.gu)return void ee(Aa,"Ignoring unexpected query state notification.");const i=s.Iu.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await R2(s.localStore,kO(i[0])),a=Sf.createSynthesizedRemoteEventForCurrentChange(e,n==="current",cn.EMPTY_BYTE_STRING);await to(s,o,a);break}case"rejected":await Pu(s.localStore,e,!0),ku(s,e,r);break;default:Te(64155,n)}}async function iK(t,e,n){const r=Iy(t);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){ee(Aa,"Adding an already active target "+s);continue}const i=await x2(r.localStore,s),o=await Ru(r.localStore,i);await LI(r,Q2(i),o.targetId,!1,o.resumeToken),Ey(r.remoteStore,o)}for(const s of n)r.Iu.has(s)&&await Pu(r.localStore,s,!1).then(()=>{Cu(r.remoteStore,s),ku(r,s)}).catch(Ia)}}function Iy(t){const e=pe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=K2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=XH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=HH.bind(null,e),e.Pu.H_=MH.bind(null,e.eventManager),e.Pu.yu=VH.bind(null,e.eventManager),e}function UI(t){const e=pe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=KH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=GH.bind(null,e),e}function oK(t,e,n){const r=pe(t);(async function(i,o,a){try{const l=await o.getMetadata();if(await function(m,E){const p=pe(m),I=_n(E.createTime);return p.persistence.runTransaction("hasNewerBundle","readonly",g=>p.Ii.getBundleMetadata(g,E.id)).then(g=>!!g&&g.createTime.compareTo(I)>=0)}(i.localStore,l))return await o.close(),a._completeWith(function(m){return{taskState:"Success",documentsLoaded:m.totalDocuments,bytesLoaded:m.totalBytes,totalDocuments:m.totalDocuments,totalBytes:m.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(B2(l));const c=new OI(l,o.serializer);let u=await o.bu();for(;u;){const f=await c.Ga(u);f&&a._updateProgress(f),u=await o.bu()}const h=await c.ja(i.localStore);return await to(i,h.Ha,void 0),await function(m,E){const p=pe(m);return p.persistence.runTransaction("Save bundle","readwrite",I=>p.Ii.saveBundleMetadata(I,E))}(i.localStore,l),a._completeWith(h.progress),Promise.resolve(h.Ja)}catch(l){return is(Aa,`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,n).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class Nu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Wl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return T2(this.persistence,new I2,e.initialUser,this.serializer)}Cu(e){return new _I(wy.mi,this.serializer)}Du(e){return new D2}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Nu.provider={build:()=>new Nu};class jI extends Nu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Re(this.persistence.referenceDelegate instanceof lg,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new g2(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?mr.withCacheSize(this.cacheSizeBytes):mr.DEFAULT;return new _I(r=>lg.mi(r,n),this.serializer)}}class $I extends Nu{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await UI(this.xu.syncEngine),await Zu(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return T2(this.persistence,new I2,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new g2(r,e.asyncQueue,n)}Mu(e,n){const r=new w8(n,this.persistence);return new _8(e.asyncQueue,r)}Cu(e){const n=EI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?mr.withCacheSize(this.cacheSizeBytes):mr.DEFAULT;return new wI(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,O2(),rp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new D2}}class Y2 extends $I{constructor(e,n){super(e,n,!1),this.xu=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xu.syncEngine;this.sharedClientState instanceof Uv&&(this.sharedClientState.syncEngine={Co:tK.bind(null,n),vo:sK.bind(null,n),Fo:iK.bind(null,n),Ts:rK.bind(null,n),Do:eK.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Ji(async r=>{await nK(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Du(e){const n=O2();if(!Uv.v(n))throw new J(U.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=EI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Uv(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class pa{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Kx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=JH.bind(null,this.syncEngine),await Jw(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new LH}()}createDatastore(e){const n=Wl(e.databaseInfo.databaseId),r=function(i){return new yH(i)}(e.databaseInfo);return function(i,o,a,l){return new EH(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new TH(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Kx(this.syncEngine,n,0),function(){return jx.v()?new jx:new fH}())}createSyncEngine(e,n){return function(s,i,o,a,l,c,u){const h=new jH(s,i,o,a,l,c);return u&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=pe(s);ee(kl,"RemoteStore shutting down."),i.Ea.add(5),await Xu(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}pa.provider={build:()=>new pa};function Qx(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):yn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aK{constructor(e,n){this.Bu=e,this.serializer=n,this.metadata=new er,this.buffer=new Uint8Array,this.Lu=function(){return new TextDecoder("utf-8")}(),this.ku().then(r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Qa)}`))},r=>this.metadata.reject(r))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const n=this.Lu.decode(e),r=Number(n);isNaN(r)&&this.Qu(`length string (${n}) is not valid number`);const s=await this.$u(r);return new $2(JSON.parse(s),e.length+r)}Uu(){return this.buffer.findIndex(e=>e===123)}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const n=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lK{constructor(e,n){this.bundleData=e,this.serializer=n,this.cursor=0,this.elements=[];let r=this.bu();if(!r||!r.$a())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r==null?void 0:r.Qa)}`);this.metadata=r;do r=this.bu(),r!==null&&this.elements.push(r);while(r!==null)}getMetadata(){return this.metadata}Wu(){return this.elements}bu(){if(this.cursor===this.bundleData.length)return null;const e=this.qu(),n=this.$u(e);return new $2(JSON.parse(n),e)}$u(e){if(this.cursor+e>this.bundleData.length)throw new J(U.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}qu(){const e=this.cursor;let n=this.cursor;for(;n<this.bundleData.length;){if(this.bundleData[n]==="{"){if(n===e)throw new Error("First character is a bracket and not a number");return this.cursor=n,Number(this.bundleData.slice(e,n))}n++}throw new Error("Reached the end of bundle when more is expected.")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cK{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new J(U.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,i){const o=pe(s),a={documents:i.map(h=>Yh(o.serializer,h))},l=await o.Ho("BatchGetDocuments",o.serializer.databaseId,it.emptyPath(),a,i.length),c=new Map;l.forEach(h=>{const f=b7(o.serializer,h);c.set(f.key.toString(),f)});const u=[];return i.forEach(h=>{const f=c.get(h.toString());Re(!!f,55234,{key:h}),u.push(f)}),u}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ju(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=fe.fromPath(r);this.mutations.push(new uI(s,this.precondition(s)))}),await async function(r,s){const i=pe(r),o={writes:s.map(a=>Jh(i.serializer,a))};await i.Go("Commit",i.serializer.databaseId,it.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Te(50498,{Gu:e.constructor.name});n=De.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new J(U.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(De.min())?Gt.exists(!1):Gt.updateTime(n):Gt.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(De.min()))throw new J(U.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Gt.updateTime(n)}return Gt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uK{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.zu=r.maxAttempts,this.M_=new bI(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new cK(this.datastore),n=this.Hu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Yu(s)}))}).catch(r=>{this.Yu(r)})})}Hu(e){try{const n=this.updateFunction(e);return!vf(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!qO(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga="FirestoreClient";class dK{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Jn.UNAUTHENTICATED,this.clientId=sy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ee(ga,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee(ga,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=td(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function $v(t,e){t.asyncQueue.verifyOperationInProgress(),ee(ga,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await S2(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Yx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await BI(t);ee(ga,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Bx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Bx(e.remoteStore,s)),t._onlineComponents=e}async function BI(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(ga,"Using user provided OfflineComponentProvider");try{await $v(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===U.FAILED_PRECONDITION||s.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;is("Error using user provided cache. Falling back to memory cache: "+n),await $v(t,new Nu)}}else ee(ga,"Using default OfflineComponentProvider"),await $v(t,new jI(void 0));return t._offlineComponents}async function Sy(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(ga,"Using user provided OnlineComponentProvider"),await Yx(t,t._uninitializedComponentsProvider._online)):(ee(ga,"Using default OnlineComponentProvider"),await Yx(t,new pa))),t._onlineComponents}function J2(t){return BI(t).then(e=>e.persistence)}function nd(t){return BI(t).then(e=>e.localStore)}function X2(t){return Sy(t).then(e=>e.remoteStore)}function zI(t){return Sy(t).then(e=>e.syncEngine)}function Z2(t){return Sy(t).then(e=>e.datastore)}async function Du(t){const e=await Sy(t),n=e.eventManager;return n.onListen=$H.bind(null,e.syncEngine),n.onUnlisten=zH.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=BH.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=WH.bind(null,e.syncEngine),n}function hK(t){return t.asyncQueue.enqueue(async()=>{const e=await J2(t),n=await X2(t);return e.setNetworkEnabled(!0),function(s){const i=pe(s);return i.Ea.delete(0),Af(i)}(n)})}function fK(t){return t.asyncQueue.enqueue(async()=>{const e=await J2(t),n=await X2(t);return e.setNetworkEnabled(!1),async function(s){const i=pe(s);i.Ea.add(0),await Xu(i),i.Ra.set("Offline")}(n)})}function mK(t,e){const n=new er;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(c,u){const h=pe(c);return h.persistence.runTransaction("read document","readonly",f=>h.localDocuments.getDocument(f,u))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new J(U.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=td(a,`Failed to get document '${i} from cache`);o.reject(l)}}(await nd(t),e,n)),n.promise}function eL(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new Ty({next:f=>{u.Nu(),o.enqueueAndForget(()=>kI(i,h));const m=f.docs.has(a);!m&&f.fromCache?c.reject(new J(U.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&l&&l.source==="server"?c.reject(new J(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new DI(Qu(a.path),u,{includeMetadataChanges:!0,qa:!0});return CI(i,h)}(await Du(t),t.asyncQueue,e,n,r)),r.promise}function pK(t,e){const n=new er;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await cg(s,i,!0),l=new q2(i,a.Qs),c=l.ru(a.documents),u=l.applyChanges(c,!1);o.resolve(u.snapshot)}catch(a){const l=td(a,`Failed to execute query '${i} against cache`);o.reject(l)}}(await nd(t),e,n)),n.promise}function tL(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new Ty({next:f=>{u.Nu(),o.enqueueAndForget(()=>kI(i,h)),f.fromCache&&l.source==="server"?c.reject(new J(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new DI(a,u,{includeMetadataChanges:!0,qa:!0});return CI(i,h)}(await Du(t),t.asyncQueue,e,n,r)),r.promise}function gK(t,e,n){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await Z2(t);r.resolve(async function(o,a,l){var p;const c=pe(o),{request:u,gt:h,parent:f}=n2(c.serializer,RO(a),l);c.connection.$o||delete u.parent;const m=(await c.Ho("RunAggregationQuery",c.serializer.databaseId,f,u,1)).filter(I=>!!I.result);Re(m.length===1,64727);const E=(p=m[0].result)==null?void 0:p.aggregateFields;return Object.keys(E).reduce((I,g)=>(I[h[g]]=E[g],I),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}function yK(t,e){const n=new Ty(e);return t.asyncQueue.enqueueAndForget(async()=>function(s,i){pe(s).Ca.add(i),i.next()}(await Du(t),n)),()=>{n.Nu(),t.asyncQueue.enqueueAndForget(async()=>function(s,i){pe(s).Ca.delete(i)}(await Du(t),n))}}function vK(t,e,n,r){const s=function(o,a){let l;return l=typeof o=="string"?KO().encode(o):o,function(u,h){return new aK(u,h)}(function(u,h){if(u instanceof Uint8Array)return Qx(u,h);if(u instanceof ArrayBuffer)return Qx(new Uint8Array(u),h);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(n,Wl(e));t.asyncQueue.enqueueAndForget(async()=>{oK(await zI(t),s,r)})}function _K(t,e){return t.asyncQueue.enqueue(async()=>function(r,s){const i=pe(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Ii.getNamedQuery(o,s))}(await nd(t),e))}function nL(t,e){return function(r,s){return new lK(r,s)}(t,e)}function wK(t,e){return t.asyncQueue.enqueue(async()=>async function(r,s){const i=pe(r),o=i.indexManager,a=[];return i.persistence.runTransaction("Configure indexes","readwrite",l=>o.getFieldIndexes(l).next(c=>function(h,f,m,E,p){h=[...h],f=[...f],h.sort(m),f.sort(m);const I=h.length,g=f.length;let _=0,w=0;for(;_<g&&w<I;){const A=m(h[w],f[_]);A<0?p(h[w++]):A>0?E(f[_++]):(_++,w++)}for(;_<g;)E(f[_++]);for(;w<I;)p(h[w++])}(c,s,p8,u=>{a.push(o.addFieldIndex(l,u))},u=>{a.push(o.deleteFieldIndex(l,u))})).next(()=>M.waitFor(a)))}(await nd(t),e))}function EK(t,e){return t.asyncQueue.enqueue(async()=>function(r,s){pe(r).Fs.Vs=s}(await nd(t),e))}function IK(t){return t.asyncQueue.enqueue(async()=>function(n){const r=pe(n),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",i=>s.deleteAllFieldIndexes(i))}(await nd(t)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL="firestore.googleapis.com",Xx=!0;class Zx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new J(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=sL,this.ssl=Xx}else this.host=e.host,this.ssl=e.ssl??Xx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=d2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<p2)throw new J(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}WD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rL(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new J(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new J(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new J(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xf{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Zx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new J(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new J(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Zx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new BD;switch(r.type){case"firstParty":return new l8(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new J(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Jx.get(n);r&&(ee("ComponentProvider","Removing Datastore"),Jx.delete(n),r.terminate())}(this),Promise.resolve()}}function iL(t,e,n,r={}){var c;t=ot(t,xf);const s=$s(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(hf(`https://${a}`),Xg("Firestore",!0)),i.host!==sL&&i.host!==a&&is("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!Vs(l,o)&&(t._setSettings(l),r.mockUserToken)){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=Jn.MOCK_USER;else{u=LN(r.mockUserToken,(c=t._app)==null?void 0:c.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new J(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Jn(f)}t._authCredentials=new i8(new $D(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new $n(this.firestore,e,this._query)}}class bt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ns(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bt(this.firestore,e,this._key)}toJSON(){return{type:bt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(zl(n,bt._jsonSchema))return new bt(e,r||null,new fe(it.fromString(n.referencePath)))}}bt._jsonSchemaVersion="firestore/documentReference/1.0",bt._jsonSchema={type:Rn("string",bt._jsonSchemaVersion),referencePath:Rn("string")};class Ns extends $n{constructor(e,n,r){super(e,n,Qu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bt(this.firestore,null,new fe(e))}withConverter(e){return new Ns(this.firestore,e,this._path)}}function ke(t,e,...n){if(t=tt(t),JE("collection","path",e),t instanceof xf){const r=it.fromString(e,...n);return $A(r),new Ns(t,null,r)}{if(!(t instanceof bt||t instanceof Ns))throw new J(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(it.fromString(e,...n));return $A(r),new Ns(t.firestore,null,r)}}function TK(t,e){if(t=ot(t,xf),JE("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new J(U.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new $n(t,null,function(r){return new Xi(it.emptyPath(),r)}(e))}function Ce(t,e,...n){if(t=tt(t),arguments.length===1&&(e=sy.newId()),JE("doc","path",e),t instanceof xf){const r=it.fromString(e,...n);return jA(r),new bt(t,null,new fe(r))}{if(!(t instanceof bt||t instanceof Ns))throw new J(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(it.fromString(e,...n));return jA(r),new bt(t.firestore,t instanceof Ns?t.converter:null,new fe(r))}}function SK(t,e){return t=tt(t),e=tt(e),(t instanceof bt||t instanceof Ns)&&(e instanceof bt||e instanceof Ns)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function WI(t,e){return t=tt(t),e=tt(e),t instanceof $n&&e instanceof $n&&t.firestore===e.firestore&&Ef(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eR="AsyncQueue";class tR{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new bI(this,"async_queue_retry"),this._c=()=>{const r=rp();r&&ee(eR,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=rp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=rp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new er;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ta(e))throw e;ee(eR,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,yn("INTERNAL UNHANDLED ERROR: ",nR(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=PI.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&Te(47125,{Pc:nR(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function nR(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wc(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class oL{constructor(){this._progressObserver={},this._taskCompletionResolver=new er,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bK=-1;class Pt extends xf{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new tR,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new tR(e),this._firestoreClient=void 0,await e}}}function aL(t,e,n){n||(n=Hh);const r=$l(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Vs(i,e))return s;throw new J(U.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new J(U.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<p2)throw new J(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&$s(e.host)&&hf(e.host),r.initialize({options:e,instanceIdentifier:n})}function AK(t,e){const n=typeof t=="object"?t:ey(),r=typeof t=="string"?t:e||Hh,s=$l(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=VE("firestore");i&&iL(s,...i)}return s}function Xt(t){if(t._terminated)throw new J(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||lL(t),t._firestoreClient}function lL(t){var r,s,i;const e=t._freezeSettings(),n=function(a,l,c,u){return new Q8(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,rL(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new dK(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function xK(t,e){is("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return cL(t,pa.provider,{build:r=>new $I(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function RK(t){is("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();cL(t,pa.provider,{build:n=>new Y2(n,e.cacheSizeBytes)})}function cL(t,e,n){if((t=ot(t,Pt))._firestoreClient||t._terminated)throw new J(U.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new J(U.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},lL(t)}function PK(t){if(t._initialized&&!t._terminated)throw new J(U.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new er;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!hi.v())return Promise.resolve();const s=r+E2;await hi.delete(s)}(EI(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function CK(t){return function(n){const r=new er;return n.asyncQueue.enqueueAndForget(async()=>QH(await zI(n),r)),r.promise}(Xt(t=ot(t,Pt)))}function qI(t){return hK(Xt(t=ot(t,Pt)))}function HI(t){return fK(Xt(t=ot(t,Pt)))}function kK(t){return ez(t.app,"firestore",t._databaseId.database),t._delete()}function e0(t,e){const n=Xt(t=ot(t,Pt)),r=new oL;return vK(n,t._databaseId,e,r),r}function uL(t,e){return _K(Xt(t=ot(t,Pt)),e).then(n=>n?new $n(t,null,n.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class dL{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vr(cn.fromBase64String(e))}catch(n){throw new J(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Vr(cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(zl(e,Vr._jsonSchema))return Vr.fromBase64String(e.bytes)}}Vr._jsonSchemaVersion="firestore/bytes/1.0",Vr._jsonSchema={type:Rn("string",Vr._jsonSchemaVersion),bytes:Rn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new J(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $t(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function NK(){return new xa(Cw)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new J(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new J(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return je(this._lat,e._lat)||je(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ds._jsonSchemaVersion}}static fromJSON(e){if(zl(e,Ds._jsonSchema))return new Ds(e.latitude,e.longitude)}}Ds._jsonSchemaVersion="firestore/geoPoint/1.0",Ds._jsonSchema={type:Rn("string",Ds._jsonSchemaVersion),latitude:Rn("number"),longitude:Rn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ys._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(zl(e,ys._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new ys(e.vectorValues);throw new J(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ys._jsonSchemaVersion="firestore/vectorValue/1.0",ys._jsonSchema={type:Rn("string",ys._jsonSchemaVersion),vectorValues:Rn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DK=/^__.*__$/;class OK{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new eo(e,this.data,this.fieldMask,n,this.fieldTransforms):new Yu(e,this.data,n,this.fieldTransforms)}}class hL{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new eo(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function fL(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Te(40011,{Ac:t})}}class by{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new by({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return fg(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fL(this.Ac)&&DK.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class LK{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Wl(e)}Cc(e,n,r,s=!1){return new by({Ac:e,methodName:n,Dc:r,path:$t.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ql(t){const e=t._freezeSettings(),n=Wl(t._databaseId);return new LK(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ay(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);ZI("Data must be an object, but it was:",o,r);const a=gL(r,o);let l,c;if(i.merge)l=new jr(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const f=Xh(e,h,n);if(!o.contains(f))throw new J(U.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);vL(u,f)||u.push(f)}l=new jr(u),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new OK(new ir(a),l,c)}class Rf extends Ra{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rf}}function mL(t,e,n){return new by({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class KI extends Ra{_toFieldTransform(e){return new Tf(e.path,new bu)}isEqual(e){return e instanceof KI}}class GI extends Ra{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=mL(this,e,!0),r=this.vc.map(i=>Hl(i,n)),s=new Al(r);return new Tf(e.path,s)}isEqual(e){return e instanceof GI&&Vs(this.vc,e.vc)}}class QI extends Ra{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=mL(this,e,!0),r=this.vc.map(i=>Hl(i,n)),s=new xl(r);return new Tf(e.path,s)}isEqual(e){return e instanceof QI&&Vs(this.vc,e.vc)}}class YI extends Ra{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new Au(e.serializer,VO(e.serializer,this.Fc));return new Tf(e.path,n)}isEqual(e){return e instanceof YI&&this.Fc===e.Fc}}function JI(t,e,n,r){const s=t.Cc(1,e,n);ZI("Data must be an object, but it was:",s,r);const i=[],o=ir.empty();Sa(r,(l,c)=>{const u=xy(e,l,n);c=tt(c);const h=s.yc(u);if(c instanceof Rf)i.push(u);else{const f=Hl(c,h);f!=null&&(i.push(u),o.set(u,f))}});const a=new jr(i);return new hL(o,a,s.fieldTransforms)}function XI(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[Xh(e,r,n)],l=[s];if(i.length%2!=0)throw new J(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(Xh(e,i[f])),l.push(i[f+1]);const c=[],u=ir.empty();for(let f=a.length-1;f>=0;--f)if(!vL(c,a[f])){const m=a[f];let E=l[f];E=tt(E);const p=o.yc(m);if(E instanceof Rf)c.push(m);else{const I=Hl(E,p);I!=null&&(c.push(m),u.set(m,I))}}const h=new jr(c);return new hL(u,h,o.fieldTransforms)}function pL(t,e,n,r=!1){return Hl(n,t.Cc(r?4:3,e))}function Hl(t,e){if(yL(t=tt(t)))return ZI("Unsupported field value:",e,t),gL(t,e);if(t instanceof Ra)return function(r,s){if(!fL(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Hl(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=tt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return VO(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=_t.fromDate(r);return{timestampValue:xu(s.serializer,i)}}if(r instanceof _t){const i=new _t(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xu(s.serializer,i)}}if(r instanceof Ds)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Vr)return{bytesValue:YO(s.serializer,r._byteString)};if(r instanceof bt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:pI(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ys)return function(o,a){return{mapValue:{fields:{[sI]:{stringValue:iI},[Iu]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return cI(a.serializer,c)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${iy(r)}`)}(t,e)}function gL(t,e){const n={};return uO(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Sa(t,(r,s)=>{const i=Hl(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function yL(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof _t||t instanceof Ds||t instanceof Vr||t instanceof bt||t instanceof Ra||t instanceof ys)}function ZI(t,e,n){if(!yL(n)||!qD(n)){const r=iy(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Xh(t,e,n){if((e=tt(e))instanceof xa)return e._internalPath;if(typeof e=="string")return xy(t,e);throw fg("Field path arguments must be of type string or ",t,!1,void 0,n)}const MK=new RegExp("[~\\*/\\[\\]]");function xy(t,e,n){if(e.search(MK)>=0)throw fg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new xa(...e.split("."))._internalPath}catch{throw fg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function fg(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new J(U.INVALID_ARGUMENT,a+t+l)}function vL(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new bt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new VK(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ry("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class VK extends Zh{data(){return super.data()}}function Ry(t,e){return typeof e=="string"?xy(t,e):e instanceof xa?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _L(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new J(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class eT{}class rd extends eT{}function Ve(t,e,...n){let r=[];e instanceof eT&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof Kl).length,a=i.filter(l=>l instanceof sd).length;if(o>1||o>0&&a>0)throw new J(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class sd extends rd{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new sd(e,n,r)}_apply(e){const n=this._parse(e);return EL(e._query,n),new $n(e.firestore,e.converter,$w(e._query,n))}_parse(e){const n=ql(e.firestore);return function(i,o,a,l,c,u,h){let f;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new J(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){sR(h,u);const E=[];for(const p of h)E.push(rR(l,i,p));f={arrayValue:{values:E}}}else f=rR(l,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||sR(h,u),f=pL(a,o,h,u==="in"||u==="not-in");return ht.create(c,u,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Oe(t,e,n){const r=e,s=Ry("where",t);return sd._create(s,r,n)}class Kl extends eT{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Kl(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:St.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)EL(o,l),o=$w(o,l)}(e._query,n),new $n(e.firestore,e.converter,$w(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function FK(...t){return t.forEach(e=>IL("or",e)),Kl._create("or",t)}function UK(...t){return t.forEach(e=>IL("and",e)),Kl._create("and",t)}class Py extends rd{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Py(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new J(U.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new J(U.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Qh(i,o)}(e._query,this._field,this._direction);return new $n(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Xi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function ra(t,e="asc"){const n=e,r=Ry("orderBy",t);return Py._create(r,n)}class Pf extends rd{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Pf(e,n,r)}_apply(e){return new $n(e.firestore,e.converter,sg(e._query,this._limit,this._limitType))}}function id(t){return HD("limit",t),Pf._create("limit",t,"F")}function jK(t){return HD("limitToLast",t),Pf._create("limitToLast",t,"L")}class Cf extends rd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Cf(e,n,r)}_apply(e){const n=wL(e,this.type,this._docOrFields,this._inclusive);return new $n(e.firestore,e.converter,function(s,i){return new Xi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function $K(...t){return Cf._create("startAt",t,!0)}function BK(...t){return Cf._create("startAfter",t,!1)}class kf extends rd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new kf(e,n,r)}_apply(e){const n=wL(e,this.type,this._docOrFields,this._inclusive);return new $n(e.firestore,e.converter,function(s,i){return new Xi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function zK(...t){return kf._create("endBefore",t,!1)}function WK(...t){return kf._create("endAt",t,!0)}function wL(t,e,n,r){if(n[0]=tt(n[0]),n[0]instanceof Zh)return function(i,o,a,l,c){if(!l)throw new J(U.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const u=[];for(const h of zc(i))if(h.field.isKeyField())u.push(Sl(o,l.key));else{const f=l.data.field(h.field);if(uy(f))throw new J(U.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(f===null){const m=h.field.canonicalString();throw new J(U.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}u.push(f)}return new fa(u,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=ql(t.firestore);return function(o,a,l,c,u,h){const f=o.explicitOrderBy;if(u.length>f.length)throw new J(U.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const m=[];for(let E=0;E<u.length;E++){const p=u[E];if(f[E].field.isKeyField()){if(typeof p!="string")throw new J(U.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof p}`);if(!aI(o)&&p.indexOf("/")!==-1)throw new J(U.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${p}' contains a slash.`);const I=o.path.child(it.fromString(p));if(!fe.isDocumentKey(I))throw new J(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${I}' is not because it contains an odd number of segments.`);const g=new fe(I);m.push(Sl(a,g))}else{const I=pL(l,c,p);m.push(I)}}return new fa(m,h)}(t._query,t.firestore._databaseId,s,e,n,r)}}function rR(t,e,n){if(typeof(n=tt(n))=="string"){if(n==="")throw new J(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!aI(e)&&n.indexOf("/")!==-1)throw new J(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(it.fromString(n));if(!fe.isDocumentKey(r))throw new J(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Sl(t,new fe(r))}if(n instanceof bt)return Sl(t,n._key);throw new J(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${iy(n)}.`)}function sR(t,e){if(!Array.isArray(t)||t.length===0)throw new J(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function EL(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new J(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new J(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function IL(t,e){if(!(e instanceof sd||e instanceof Kl))throw new J(U.INVALID_ARGUMENT,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class tT{convertValue(e,n="none"){switch(da(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ht(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Qi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Te(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Sa(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Iu].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Ht(o.doubleValue));return new ys(n)}convertGeoPoint(e){return new Ds(Ht(e.latitude),Ht(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=dy(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(qh(e));default:return null}}convertTimestamp(e){const n=Gi(e);return new _t(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=it.fromString(e);Re(o2(r),9688,{name:e});const s=new ua(r.get(1),r.get(3)),i=new fe(r.popFirst(5));return s.isEqual(n)||yn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class nT extends tT{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new bt(this.firestore,null,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qK(t){return new Ou("sum",Xh("sum",t))}function HK(t){return new Ou("avg",Xh("average",t))}function TL(){return new Ou("count")}function KK(t,e){var n,r;return t instanceof Ou&&e instanceof Ou&&t.aggregateType===e.aggregateType&&((n=t._internalFieldPath)==null?void 0:n.canonicalString())===((r=e._internalFieldPath)==null?void 0:r.canonicalString())}function GK(t,e){return WI(t.query,e.query)&&Vs(t.data(),e.data())}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SL="NOT SUPPORTED";class Oi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Hr extends Zh{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new dh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Ry("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new J(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Hr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}function QK(t,e,n){if(zl(e,Hr._jsonSchema)){if(e.bundle===SL)throw new J(U.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=Wl(t._databaseId),s=nL(e.bundle,r),i=s.Wu(),o=new OI(s.getMetadata(),r);for(const u of i)o.Ga(u);const a=o.documents;if(a.length!==1)throw new J(U.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${a.length} documents.`);const l=py(r,a[0].document),c=new fe(it.fromString(e.bundleName));return new Hr(t,new nT(t),c,l,new Oi(!1,!1),n||null)}}Hr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Hr._jsonSchema={type:Rn("string",Hr._jsonSchemaVersion),bundleSource:Rn("string","DocumentSnapshot"),bundleName:Rn("string"),bundle:Rn("string")};class dh extends Hr{data(e={}){return super.data(e)}}class Kr{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Oi(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new dh(this._firestore,this._userDataWriter,r.key,r,new Oi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new J(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new dh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Oi(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new dh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Oi(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:JK(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new J(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Kr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=sy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function YK(t,e,n){if(zl(e,Kr._jsonSchema)){if(e.bundle===SL)throw new J(U.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=Wl(t._databaseId),s=nL(e.bundle,r),i=s.Wu(),o=new OI(s.getMetadata(),r);for(const f of i)o.Ga(f);if(o.queries.length!==1)throw new J(U.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);const a=yy(o.queries[0].bundledQuery),l=o.documents;let c=new fl;l.map(f=>{const m=py(r,f.document);c=c.add(m)});const u=Nl.fromInitialDocuments(a,c,Ke(),!1,!1),h=new $n(t,n||null,a);return new Kr(t,new nT(t),h,u)}}function JK(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Te(61501,{type:t})}}function XK(t,e){return t instanceof Hr&&e instanceof Hr?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Kr&&e instanceof Kr&&t._firestore===e._firestore&&WI(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(t){t=ot(t,bt);const e=ot(t.firestore,Pt);return eL(Xt(e),t._key).then(n=>rT(e,t,n))}Kr._jsonSchemaVersion="firestore/querySnapshot/1.0",Kr._jsonSchema={type:Rn("string",Kr._jsonSchemaVersion),bundleSource:Rn("string","QuerySnapshot"),bundleName:Rn("string"),bundle:Rn("string")};class Pa extends tT{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new bt(this.firestore,null,n)}}function ZK(t){t=ot(t,bt);const e=ot(t.firestore,Pt),n=Xt(e),r=new Pa(e);return mK(n,t._key).then(s=>new Hr(e,r,t._key,s,new Oi(s!==null&&s.hasLocalMutations,!0),t.converter))}function eG(t){t=ot(t,bt);const e=ot(t.firestore,Pt);return eL(Xt(e),t._key,{source:"server"}).then(n=>rT(e,t,n))}function Be(t){t=ot(t,$n);const e=ot(t.firestore,Pt),n=Xt(e),r=new Pa(e);return _L(t._query),tL(n,t._query).then(s=>new Kr(e,r,t,s))}function tG(t){t=ot(t,$n);const e=ot(t.firestore,Pt),n=Xt(e),r=new Pa(e);return pK(n,t._query).then(s=>new Kr(e,r,t,s))}function nG(t){t=ot(t,$n);const e=ot(t.firestore,Pt),n=Xt(e),r=new Pa(e);return tL(n,t._query,{source:"server"}).then(s=>new Kr(e,r,t,s))}function on(t,e,n){t=ot(t,bt);const r=ot(t.firestore,Pt),s=Cy(t.converter,e,n);return od(r,[Ay(ql(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Gt.none())])}function wn(t,e,n,...r){t=ot(t,bt);const s=ot(t.firestore,Pt),i=ql(s);let o;return o=typeof(e=tt(e))=="string"||e instanceof xa?XI(i,"updateDoc",t._key,e,n,r):JI(i,"updateDoc",t._key,e),od(s,[o.toMutation(t._key,Gt.exists(!0))])}function Xn(t){return od(ot(t.firestore,Pt),[new Ju(t._key,Gt.none())])}function mi(t,e){const n=ot(t.firestore,Pt),r=Ce(t),s=Cy(t.converter,e);return od(n,[Ay(ql(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Gt.exists(!1))]).then(()=>r)}function t0(t,...e){var l,c,u;t=tt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Wc(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Wc(e[r])){const h=e[r];e[r]=(l=h.next)==null?void 0:l.bind(h),e[r+1]=(c=h.error)==null?void 0:c.bind(h),e[r+2]=(u=h.complete)==null?void 0:u.bind(h)}let i,o,a;if(t instanceof bt)o=ot(t.firestore,Pt),a=Qu(t._key.path),i={next:h=>{e[r]&&e[r](rT(o,t,h))},error:e[r+1],complete:e[r+2]};else{const h=ot(t,$n);o=ot(h.firestore,Pt),a=h._query;const f=new Pa(o);i={next:m=>{e[r]&&e[r](new Kr(o,f,h,m))},error:e[r+1],complete:e[r+2]},_L(t._query)}return function(f,m,E,p){const I=new Ty(p),g=new DI(m,I,E);return f.asyncQueue.enqueueAndForget(async()=>CI(await Du(f),g)),()=>{I.Nu(),f.asyncQueue.enqueueAndForget(async()=>kI(await Du(f),g))}}(Xt(o),a,s,i)}function rG(t,e,...n){const r=tt(t),s=function(l){const c={bundle:"",bundleName:"",bundleSource:""},u=["bundle","bundleName","bundleSource"];for(const h of u){if(!(h in l)){c.error=`snapshotJson missing required field: ${h}`;break}const f=l[h];if(typeof f!="string"){c.error=`snapshotJson field '${h}' must be a string.`;break}if(f.length===0){c.error=`snapshotJson field '${h}' cannot be an empty string.`;break}h==="bundle"?c.bundle=f:h==="bundleName"?c.bundleName=f:h==="bundleSource"&&(c.bundleSource=f)}return c}(e);if(s.error)throw new J(U.INVALID_ARGUMENT,s.error);let i,o=0;if(typeof n[o]!="object"||Wc(n[o])||(i=n[o++]),s.bundleSource==="QuerySnapshot"){let a=null;if(typeof n[o]=="object"&&Wc(n[o])){const l=n[o++];a={next:l.next,error:l.error,complete:l.complete}}else a={next:n[o++],error:n[o++],complete:n[o++]};return function(c,u,h,f,m){let E,p=!1;return e0(c,u.bundle).then(()=>uL(c,u.bundleName)).then(g=>{g&&!p&&(m&&g.withConverter(m),E=t0(g,h||{},f))}).catch(g=>(f.error&&f.error(g),()=>{})),()=>{p||(p=!0,E&&E())}}(r,s,i,a,n[o])}if(s.bundleSource==="DocumentSnapshot"){let a=null;if(typeof n[o]=="object"&&Wc(n[o])){const l=n[o++];a={next:l.next,error:l.error,complete:l.complete}}else a={next:n[o++],error:n[o++],complete:n[o++]};return function(c,u,h,f,m){let E,p=!1;return e0(c,u.bundle).then(()=>{if(!p){const g=new bt(c,m||null,fe.fromPath(u.bundleName));E=t0(g,h||{},f)}}).catch(g=>(f.error&&f.error(g),()=>{})),()=>{p||(p=!0,E&&E())}}(r,s,i,a,n[o])}throw new J(U.INVALID_ARGUMENT,`unsupported bundle source: ${s.bundleSource}`)}function sG(t,e){return yK(Xt(t=ot(t,Pt)),Wc(e)?e:{next:e})}function od(t,e){return function(r,s){const i=new er;return r.asyncQueue.enqueueAndForget(async()=>qH(await zI(r),s,i)),i.promise}(Xt(t),e)}function rT(t,e,n){const r=n.docs.get(e._key),s=new Pa(t);return new Hr(t,s,e._key,r,new Oi(n.hasPendingWrites,n.fromCache),e.converter)}function bL(t){return AL(t,{count:TL()})}function AL(t,e){const n=ot(t.firestore,Pt),r=Xt(n),s=cO(e,(i,o)=>new WO(o,i.aggregateType,i._internalFieldPath));return gK(r,t._query,s).then(i=>function(a,l,c){const u=new Pa(a);return new dL(l,u,c)}(n,t,i))}class iG{constructor(e){this.kind="memory",this._onlineComponentProvider=pa.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new jI(void 0)}}toJSON(){return{kind:this.kind}}}class oG{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=xL(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class aG{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Nu.provider}toJSON(){return{kind:this.kind}}}class lG{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new jI(e)}}toJSON(){return{kind:this.kind}}}function cG(){return new aG}function uG(t){return new lG(t==null?void 0:t.cacheSizeBytes)}function dG(t){return new iG(t)}function hG(t){return new oG(t)}class fG{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=pa.provider,this._offlineComponentProvider={build:n=>new $I(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class mG{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=pa.provider,this._offlineComponentProvider={build:n=>new Y2(n,e==null?void 0:e.cacheSizeBytes)}}}function xL(t){return new fG(t==null?void 0:t.forceOwnership)}function pG(){return new mG}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gG={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ql(e)}set(e,n,r){this._verifyNotCommitted();const s=Bo(e,this._firestore),i=Cy(s.converter,n,r),o=Ay(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Gt.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Bo(e,this._firestore);let o;return o=typeof(n=tt(n))=="string"||n instanceof xa?XI(this._dataReader,"WriteBatch.update",i._key,n,r,s):JI(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Gt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Bo(e,this._firestore);return this._mutations=this._mutations.concat(new Ju(n._key,Gt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new J(U.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Bo(t,e){if((t=tt(t)).firestore!==e)throw new J(U.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yG{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=ql(e)}get(e){const n=Bo(e,this._firestore),r=new nT(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return Te(24041);const i=s[0];if(i.isFoundDocument())return new Zh(this._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Zh(this._firestore,r,n._key,null,n.converter);throw Te(18433,{doc:i})})}set(e,n,r){const s=Bo(e,this._firestore),i=Cy(s.converter,n,r),o=Ay(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,n,r,...s){const i=Bo(e,this._firestore);let o;return o=typeof(n=tt(n))=="string"||n instanceof xa?XI(this._dataReader,"Transaction.update",i._key,n,r,s):JI(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=Bo(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL extends yG{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Bo(e,this._firestore),r=new Pa(this._firestore);return super.get(e).then(s=>new Hr(this._firestore,r,n._key,s._document,new Oi(!1,!1),n.converter))}}function vG(t,e,n){t=ot(t,Pt);const r={...gG,...n};return function(i){if(i.maxAttempts<1)throw new J(U.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const l=new er;return i.asyncQueue.enqueueAndForget(async()=>{const c=await Z2(i);new uK(i.asyncQueue,c,a,o,l).ju()}),l.promise}(Xt(t),s=>e(new PL(t,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _G(){return new Rf("deleteField")}function Le(){return new KI("serverTimestamp")}function wG(...t){return new GI("arrayUnion",t)}function EG(...t){return new QI("arrayRemove",t)}function IG(t){return new YI("increment",t)}function TG(t){return new ys(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sT(t){return Xt(t=ot(t,Pt)),new RL(t,e=>od(t,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SG(t,e){const n=Xt(t=ot(t,Pt));if(!n._uninitializedComponentsProvider||n._uninitializedComponentsProvider._offline.kind==="memory")return is("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(i){const o=typeof i=="string"?function(c){try{return JSON.parse(c)}catch(u){throw new J(U.INVALID_ARGUMENT,"Failed to parse JSON: "+(u==null?void 0:u.message))}}(i):i,a=[];if(Array.isArray(o.indexes))for(const l of o.indexes){const c=iR(l,"collectionGroup"),u=[];if(Array.isArray(l.fields))for(const h of l.fields){const f=xy("setIndexConfiguration",iR(h,"fieldPath"));h.arrayConfig==="CONTAINS"?u.push(new dl(f,2)):h.order==="ASCENDING"?u.push(new dl(f,0)):h.order==="DESCENDING"&&u.push(new dl(f,1))}a.push(new gu(gu.UNKNOWN_ID,c,u,yu.empty()))}return a}(e);return wK(n,r)}function iR(t,e){if(typeof t[e]!="string")throw new J(U.INVALID_ARGUMENT,"Missing string value for: "+e);return t[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function bG(t){var s;t=ot(t,Pt);const e=oR.get(t);if(e)return e;if(((s=Xt(t)._uninitializedComponentsProvider)==null?void 0:s._offline.kind)!=="persistent")return null;const r=new CL(t);return oR.set(t,r),r}function AG(t){kL(t,!0)}function xG(t){kL(t,!1)}function RG(t){IK(Xt(t._firestore)).then(e=>ee("deleting all persistent cache indexes succeeded")).catch(e=>is("deleting all persistent cache indexes failed",e))}function kL(t,e){EK(Xt(t._firestore),e).then(n=>ee(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(n=>is(`setting persistent cache index auto creation isEnabled=${e} failed`,n))}const oR=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PG(t){var r;const e=Xt(ot(t.firestore,Pt)),n=(r=e._onlineComponents)==null?void 0:r.datastore.serializer;return n===void 0?null:gy(n,yr(t._query)).ft}function CG(t,e){var i;const n=cO(e,(o,a)=>new WO(a,o.aggregateType,o._internalFieldPath)),r=Xt(ot(t.firestore,Pt)),s=(i=r._onlineComponents)==null?void 0:i.datastore.serializer;return s===void 0?null:n2(s,RO(t._query),n,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kG{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return iT.instance.onExistenceFilterMismatch(e)}}class iT{constructor(){this.Mc=new Map}static get instance(){return _m||(_m=new iT,function(n){if(ch)throw new Error("a TestingHooksSpi instance is already set");ch=n}(_m)),_m}lt(e){this.Mc.forEach(n=>n(e))}onExistenceFilterMismatch(e){const n=Symbol(),r=this.Mc;return r.set(n,e),()=>r.delete(n)}}let _m=null;(function(e,n=!0){(function(s){Gu=s})(Bl),yi(new Fs("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Pt(new o8(r.getProvider("auth-internal")),new c8(o,r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new J(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ua(c.options.projectId,u)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),rs(FA,UA,e),rs(FA,UA,"esm2020")})();const Mn=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:tT,AggregateField:Ou,AggregateQuerySnapshot:dL,Bytes:Vr,CACHE_SIZE_UNLIMITED:bK,CollectionReference:Ns,DocumentReference:bt,DocumentSnapshot:Hr,FieldPath:xa,FieldValue:Ra,Firestore:Pt,FirestoreError:J,GeoPoint:Ds,LoadBundleTask:oL,PersistentCacheIndexManager:CL,Query:$n,QueryCompositeFilterConstraint:Kl,QueryConstraint:rd,QueryDocumentSnapshot:dh,QueryEndAtConstraint:kf,QueryFieldFilterConstraint:sd,QueryLimitConstraint:Pf,QueryOrderByConstraint:Py,QuerySnapshot:Kr,QueryStartAtConstraint:Cf,SnapshotMetadata:Oi,Timestamp:_t,Transaction:PL,VectorValue:ys,WriteBatch:RL,_AutoId:sy,_ByteString:cn,_DatabaseId:ua,_DocumentKey:fe,_EmptyAppCheckTokenProvider:u8,_EmptyAuthCredentialsProvider:BD,_FieldPath:$t,_TestingHooks:kG,_cast:ot,_debugAssert:s8,_internalAggregationQueryToProtoRunAggregationQueryRequest:CG,_internalQueryToProtoQueryTarget:PG,_isBase64Available:K8,_logWarn:is,_validateIsNotUsedTogether:WD,addDoc:mi,aggregateFieldEqual:KK,aggregateQuerySnapshotEqual:GK,and:UK,arrayRemove:EG,arrayUnion:wG,average:HK,clearIndexedDbPersistence:PK,collection:ke,collectionGroup:TK,connectFirestoreEmulator:iL,count:TL,deleteAllPersistentCacheIndexes:RG,deleteDoc:Xn,deleteField:_G,disableNetwork:HI,disablePersistentCacheIndexAutoCreation:xG,doc:Ce,documentId:NK,documentSnapshotFromJSON:QK,enableIndexedDbPersistence:xK,enableMultiTabIndexedDbPersistence:RK,enableNetwork:qI,enablePersistentCacheIndexAutoCreation:AG,endAt:WK,endBefore:zK,ensureFirestoreConfigured:Xt,executeWrite:od,getAggregateFromServer:AL,getCountFromServer:bL,getDoc:Qt,getDocFromCache:ZK,getDocFromServer:eG,getDocs:Be,getDocsFromCache:tG,getDocsFromServer:nG,getFirestore:AK,getPersistentCacheIndexManager:bG,increment:IG,initializeFirestore:aL,limit:id,limitToLast:jK,loadBundle:e0,memoryEagerGarbageCollector:cG,memoryLocalCache:dG,memoryLruGarbageCollector:uG,namedQuery:uL,onSnapshot:t0,onSnapshotResume:rG,onSnapshotsInSync:sG,or:FK,orderBy:ra,persistentLocalCache:hG,persistentMultipleTabManager:pG,persistentSingleTabManager:xL,query:Ve,queryEqual:WI,querySnapshotFromJSON:YK,refEqual:SK,runTransaction:vG,serverTimestamp:Le,setDoc:on,setIndexConfiguration:SG,setLogLevel:UD,snapshotEqual:XK,startAfter:BK,startAt:$K,sum:qK,terminate:kK,updateDoc:wn,vector:TG,waitForPendingWrites:CK,where:Oe,writeBatch:sT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NG="type.googleapis.com/google.protobuf.Int64Value",DG="type.googleapis.com/google.protobuf.UInt64Value";function NL(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function mg(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>mg(e));if(typeof t=="function"||typeof t=="object")return NL(t,e=>mg(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Lu(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case NG:case DG:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Lu(e)):typeof t=="function"||typeof t=="object"?NL(t,e=>Lu(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Br extends Bs{constructor(e,n,r){super(`${oT}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,Br.prototype)}}function OG(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function pg(t,e){let n=OG(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!aR[o])return new Br("internal","internal");n=aR[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=Lu(s))}}catch{}return n==="ok"?null:new Br(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LG{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Mr(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0="us-central1",MG=/^data: (.*?)(?:\n|$)/;function VG(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new Br("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class FG{constructor(e,n,r,s,i=n0,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new LG(e,n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=n0}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function UG(t,e,n){const r=$s(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(hf(t.emulatorOrigin+"/backends"),Xg("Functions",!0))}function jG(t,e,n){const r=s=>BG(t,e,s,{});return r.stream=(s,i)=>WG(t,e,s,i),r}function DL(t){return t.emulatorOrigin&&$s(t.emulatorOrigin)?"include":void 0}async function $G(t,e,n,r,s){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:DL(s)})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}async function OL(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function BG(t,e,n,r){const s=t._url(e);return zG(t,s,n,r)}async function zG(t,e,n,r){n=mg(n);const s={data:n},i=await OL(t,r),o=r.timeout||7e4,a=VG(o),l=await Promise.race([$G(e,s,i,t.fetchImpl,t),a.promise,t.cancelAllRequests]);if(a.cancel(),!l)throw new Br("cancelled","Firebase Functions instance was deleted.");const c=pg(l.status,l.json);if(c)throw c;if(!l.json)throw new Br("internal","Response is not valid JSON object.");let u=l.json.data;if(typeof u>"u"&&(u=l.json.result),typeof u>"u")throw new Br("internal","Response is missing data field.");return{data:Lu(u)}}function WG(t,e,n,r){const s=t._url(e);return qG(t,s,n,r||{})}async function qG(t,e,n,r){var f;n=mg(n);const s={data:n},i=await OL(t,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r==null?void 0:r.signal,credentials:DL(t)})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const p=new Br("cancelled","Request was cancelled.");return{data:Promise.reject(p),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(p)}}}}}}const E=pg(0,null);return{data:Promise.reject(E),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(E)}}}}}}let a,l;const c=new Promise((m,E)=>{a=m,l=E});(f=r==null?void 0:r.signal)==null||f.addEventListener("abort",()=>{const m=new Br("cancelled","Request was cancelled.");l(m)});const u=o.body.getReader(),h=HG(u,a,l,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const m=h.getReader();return{async next(){const{value:E,done:p}=await m.read();return{value:E,done:p}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:c}}function HG(t,e,n,r){const s=(o,a)=>{const l=o.match(MG);if(!l)return;const c=l[1];try{const u=JSON.parse(c);if("result"in u){e(Lu(u.result));return}if("message"in u){a.enqueue(Lu(u.message));return}if("error"in u){const h=pg(0,u);a.error(h),n(h);return}}catch(u){if(u instanceof Br){a.error(u),n(u);return}}},i=new TextDecoder;return new ReadableStream({start(o){let a="";return l();async function l(){if(r!=null&&r.aborted){const c=new Br("cancelled","Request was cancelled");return o.error(c),n(c),Promise.resolve()}try{const{value:c,done:u}=await t.read();if(u){a.trim()&&s(a.trim(),o),o.close();return}if(r!=null&&r.aborted){const f=new Br("cancelled","Request was cancelled");o.error(f),n(f),await t.cancel();return}a+=i.decode(c,{stream:!0});const h=a.split(`
`);a=h.pop()||"";for(const f of h)f.trim()&&s(f.trim(),o);return l()}catch(c){const u=c instanceof Br?c:pg(0,null);o.error(u),n(u)}}},cancel(){return t.cancel()}})}const lR="@firebase/functions",cR="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KG="auth-internal",GG="app-check-internal",QG="messaging-internal";function YG(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(KG),o=n.getProvider(QG),a=n.getProvider(GG);return new FG(s,i,o,a,r)};yi(new Fs(oT,e,"PUBLIC").setMultipleInstances(!0)),rs(lR,cR,t),rs(lR,cR,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JG(t=ey(),e=n0){const r=$l(tt(t),oT).getImmediate({identifier:e}),s=VE("functions");return s&&XG(r,...s),r}function XG(t,e,n){UG(tt(t),e,n)}function ZG(t,e,n){return jG(tt(t),e)}YG();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LL="firebasestorage.googleapis.com",ML="storageBucket",eQ=2*60*1e3,tQ=10*60*1e3,nQ=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un extends Bs{constructor(e,n,r=0){super(Bv(e),`Firebase Storage: ${n} (${Bv(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,un.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Bv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var zt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(zt||(zt={}));function Bv(t){return"storage/"+t}function aT(){const t="An unknown error occurred, please check the error payload for server response.";return new un(zt.UNKNOWN,t)}function rQ(t){return new un(zt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function sQ(t){return new un(zt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function iQ(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new un(zt.UNAUTHENTICATED,t)}function oQ(){return new un(zt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function aQ(t){return new un(zt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function VL(){return new un(zt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function FL(){return new un(zt.CANCELED,"User canceled the upload/download.")}function lQ(t){return new un(zt.INVALID_URL,"Invalid URL '"+t+"'.")}function cQ(t){return new un(zt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function uQ(){return new un(zt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+ML+"' property when initializing the app?")}function UL(){return new un(zt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function dQ(){return new un(zt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function hQ(){return new un(zt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function fQ(t){return new un(zt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function r0(t){return new un(zt.INVALID_ARGUMENT,t)}function jL(){return new un(zt.APP_DELETED,"The Firebase app was deleted.")}function mQ(t){return new un(zt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function hh(t,e){return new un(zt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function kd(t){throw new un(zt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=es.makeFromUrl(e,n)}catch{return new es(e,"")}if(r.path==="")return r;throw cQ(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(A){A.path.charAt(A.path.length-1)==="/"&&(A.path_=A.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(A){A.path_=decodeURIComponent(A.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${u}/b/${s}/o${f}`,"i"),E={bucket:1,path:3},p=n===LL?"(?:storage.googleapis.com|storage.cloud.google.com)":n,I="([^?#]*)",g=new RegExp(`^https?://${p}/${s}/${I}`,"i"),w=[{regex:a,indices:l,postModify:i},{regex:m,indices:E,postModify:c},{regex:g,indices:{bucket:1,path:2},postModify:c}];for(let A=0;A<w.length;A++){const P=w[A],L=P.regex.exec(e);if(L){const x=L[P.indices.bucket];let T=L[P.indices.path];T||(T=""),r=new es(x,T),P.postModify(r);break}}if(r==null)throw lQ(e);return r}}class pQ{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gQ(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...I){c||(c=!0,e.apply(null,I))}function h(I){s=setTimeout(()=>{s=null,t(m,l())},I)}function f(){i&&clearTimeout(i)}function m(I,...g){if(c){f();return}if(I){f(),u.call(null,I,...g);return}if(l()||o){f(),u.call(null,I,...g);return}r<64&&(r*=2);let w;a===1?(a=2,w=0):w=(r+Math.random())*1e3,h(w)}let E=!1;function p(I){E||(E=!0,f(),!c&&(s!==null?(I||(a=2),clearTimeout(s),h(0)):I||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,p(!0)},n),p}function yQ(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vQ(t){return t!==void 0}function _Q(t){return typeof t=="function"}function wQ(t){return typeof t=="object"&&!Array.isArray(t)}function ky(t){return typeof t=="string"||t instanceof String}function uR(t){return lT()&&t instanceof Blob}function lT(){return typeof Blob<"u"}function dR(t,e,n,r){if(r<e)throw r0(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw r0(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nf(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function $L(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var ml;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ml||(ml={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BL(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EQ{constructor(e,n,r,s,i,o,a,l,c,u,h,f=!0,m=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((E,p)=>{this.resolve_=E,this.reject_=p,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new wm(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===ml.NO_ERROR,l=i.getStatus();if(!a||BL(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===ml.ABORT;r(!1,new wm(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new wm(c,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());vQ(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=aT();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?jL():FL();o(l)}else{const l=VL();o(l)}};this.canceled_?n(!1,new wm(!1,null,!0)):this.backoffId_=gQ(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&yQ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class wm{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function IQ(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function TQ(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function SQ(t,e){e&&(t["X-Firebase-GMPID"]=e)}function bQ(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function AQ(t,e,n,r,s,i,o=!0,a=!1){const l=$L(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return SQ(u,e),IQ(u,n),TQ(u,i),bQ(u,r),new EQ(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xQ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function RQ(...t){const e=xQ();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(lT())return new Blob(t);throw new un(zt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function PQ(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CQ(t){if(typeof atob>"u")throw fQ("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class zv{constructor(e,n){this.data=e,this.contentType=n||null}}function kQ(t,e){switch(t){case oi.RAW:return new zv(zL(e));case oi.BASE64:case oi.BASE64URL:return new zv(WL(t,e));case oi.DATA_URL:return new zv(DQ(e),OQ(e))}throw aT()}function zL(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function NQ(t){let e;try{e=decodeURIComponent(t)}catch{throw hh(oi.DATA_URL,"Malformed data URL.")}return zL(e)}function WL(t,e){switch(t){case oi.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw hh(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case oi.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw hh(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=CQ(e)}catch(s){throw s.message.includes("polyfill")?s:hh(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class qL{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw hh(oi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=LQ(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function DQ(t){const e=new qL(t);return e.base64?WL(oi.BASE64,e.rest):NQ(e.rest)}function OQ(t){return new qL(t).contentType}function LQ(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,n){let r=0,s="";uR(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(uR(this.data_)){const r=this.data_,s=PQ(r,e,n);return s===null?null:new Ri(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Ri(r,!0)}}static getBlob(...e){if(lT()){const n=e.map(r=>r instanceof Ri?r.data_:r);return new Ri(RQ.apply(null,n))}else{const n=e.map(o=>ky(o)?kQ(oi.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new Ri(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HL(t){let e;try{e=JSON.parse(t)}catch{return null}return wQ(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MQ(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function VQ(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function KL(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FQ(t,e){return e}class Er{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||FQ}}let Em=null;function UQ(t){return!ky(t)||t.length<2?t:KL(t)}function cT(){if(Em)return Em;const t=[];t.push(new Er("bucket")),t.push(new Er("generation")),t.push(new Er("metageneration")),t.push(new Er("name","fullPath",!0));function e(i,o){return UQ(o)}const n=new Er("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Er("size");return s.xform=r,t.push(s),t.push(new Er("timeCreated")),t.push(new Er("updated")),t.push(new Er("md5Hash",null,!0)),t.push(new Er("cacheControl",null,!0)),t.push(new Er("contentDisposition",null,!0)),t.push(new Er("contentEncoding",null,!0)),t.push(new Er("contentLanguage",null,!0)),t.push(new Er("contentType",null,!0)),t.push(new Er("metadata","customMetadata",!0)),Em=t,Em}function jQ(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new es(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function $Q(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return jQ(r,t),r}function GL(t,e,n){const r=HL(e);return r===null?null:$Q(t,r,n)}function BQ(t,e,n,r){const s=HL(e);if(s===null||!ky(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(c=>{const u=t.bucket,h=t.fullPath,f="/b/"+o(u)+"/o/"+o(h),m=Nf(f,n,r),E=$L({alt:"media",token:c});return m+E})[0]}function QL(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class ad{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(t){if(!t)throw aT()}function uT(t,e){function n(r,s){const i=GL(t,s,e);return Fi(i!==null),i}return n}function zQ(t,e){function n(r,s){const i=GL(t,s,e);return Fi(i!==null),BQ(i,s,t.host,t._protocol)}return n}function Df(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=oQ():s=iQ():n.getStatus()===402?s=sQ(t.bucket):n.getStatus()===403?s=aQ(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function YL(t){const e=Df(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=rQ(t.path)),i.serverResponse=s.serverResponse,i}return n}function WQ(t,e,n){const r=e.fullServerUrl(),s=Nf(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new ad(s,i,uT(t,n),o);return a.errorHandler=YL(e),a}function qQ(t,e,n){const r=e.fullServerUrl(),s=Nf(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new ad(s,i,zQ(t,n),o);return a.errorHandler=YL(e),a}function HQ(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function JL(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=HQ(null,e)),r}function XL(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let A=0;A<2;A++)w=w+Math.random().toString().slice(2);return w}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=JL(e,r,s),u=QL(c,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",m=Ri.getBlob(h,r,f);if(m===null)throw UL();const E={name:c.fullPath},p=Nf(i,t.host,t._protocol),I="POST",g=t.maxUploadRetryTime,_=new ad(p,I,uT(t,n),g);return _.urlParams=E,_.headers=o,_.body=m.uploadData(),_.errorHandler=Df(e),_}class gg{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}}function dT(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Fi(!1)}return Fi(!!n&&(e||["active"]).indexOf(n)!==-1),n}function KQ(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o=JL(e,r,s),a={name:o.fullPath},l=Nf(i,t.host,t._protocol),c="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=QL(o,n),f=t.maxUploadRetryTime;function m(p){dT(p);let I;try{I=p.getResponseHeader("X-Goog-Upload-URL")}catch{Fi(!1)}return Fi(ky(I)),I}const E=new ad(l,c,m,f);return E.urlParams=a,E.headers=u,E.body=h,E.errorHandler=Df(e),E}function GQ(t,e,n,r){const s={"X-Goog-Upload-Command":"query"};function i(c){const u=dT(c,["active","final"]);let h=null;try{h=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Fi(!1)}h||Fi(!1);const f=Number(h);return Fi(!isNaN(f)),new gg(f,r.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,l=new ad(n,o,i,a);return l.headers=s,l.errorHandler=Df(e),l}const hR=256*1024;function QQ(t,e,n,r,s,i,o,a){const l=new gg(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=r.size()),r.size()!==l.total)throw dQ();const c=l.total-l.current;let u=c;s>0&&(u=Math.min(u,s));const h=l.current,f=h+u;let m="";u===0?m="finalize":c===u?m="upload, finalize":m="upload";const E={"X-Goog-Upload-Command":m,"X-Goog-Upload-Offset":`${l.current}`},p=r.slice(h,f);if(p===null)throw UL();function I(A,P){const L=dT(A,["active","final"]),x=l.current+u,T=r.size();let R;return L==="final"?R=uT(e,i)(A,P):R=null,new gg(x,T,L==="final",R)}const g="POST",_=e.maxUploadRetryTime,w=new ad(n,g,I,_);return w.headers=E,w.body=p.uploadData(),w.progressCallback=a||null,w.errorHandler=Df(t),w}const Or={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Wv(t){switch(t){case"running":case"pausing":case"canceling":return Or.RUNNING;case"paused":return Or.PAUSED;case"success":return Or.SUCCESS;case"canceled":return Or.CANCELED;case"error":return Or.ERROR;default:return Or.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YQ{constructor(e,n,r){if(_Q(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rc(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class JQ{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ml.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ml.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ml.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw kd("cannot .send() more than once");if($s(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw kd("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw kd("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw kd("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw kd("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class XQ extends JQ{initXhr(){this.xhr_.responseType="text"}}function Ka(){return new XQ}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZQ{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=cT(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(zt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const i=this.isExponentialBackoffExpired();if(BL(s.status,[]))if(i)s=VL();else{this.sleepTime=Math.max(this.sleepTime*2,nQ),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(zt.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=KQ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Ka,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const s=GQ(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,Ka,n,r);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=hR*this._chunkMultiplier,n=new gg(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,i)=>{let o;try{o=QQ(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(o,Ka,s,i,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){hR*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=WQ(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,Ka,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=XL(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Ka,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=FL(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Wv(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){const i=new YQ(n||void 0,r||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Wv(this._state)){case Or.SUCCESS:rc(this._resolve.bind(null,this.snapshot))();break;case Or.CANCELED:case Or.ERROR:const n=this._reject;rc(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Wv(this._state)){case Or.RUNNING:case Or.PAUSED:e.next&&rc(e.next.bind(e,this.snapshot))();break;case Or.SUCCESS:e.complete&&rc(e.complete.bind(e))();break;case Or.CANCELED:case Or.ERROR:e.error&&rc(e.error.bind(e,this._error))();break;default:e.error&&rc(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,n){this._service=e,n instanceof es?this._location=n:this._location=es.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Dl(e,n)}get root(){const e=new es(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return KL(this._location.path)}get storage(){return this._service}get parent(){const e=MQ(this._location.path);if(e===null)return null;const n=new es(this._location.bucket,e);return new Dl(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw mQ(e)}}function eY(t,e,n){t._throwIfRoot("uploadBytes");const r=XL(t.storage,t._location,cT(),new Ri(e,!0),n);return t.storage.makeRequestWithTokens(r,Ka).then(s=>({metadata:s,ref:t}))}function tY(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new ZQ(t,new Ri(e),n)}function nY(t){t._throwIfRoot("getDownloadURL");const e=qQ(t.storage,t._location,cT());return t.storage.makeRequestWithTokens(e,Ka).then(n=>{if(n===null)throw hQ();return n})}function rY(t,e){const n=VQ(t._location.path,e),r=new es(t._location.bucket,n);return new Dl(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sY(t){return/^[A-Za-z]+:\/\//.test(t)}function iY(t,e){return new Dl(t,e)}function ZL(t,e){if(t instanceof hT){const n=t;if(n._bucket==null)throw uQ();const r=new Dl(n,n._bucket);return e!=null?ZL(r,e):r}else return e!==void 0?rY(t,e):t}function oY(t,e){if(e&&sY(e)){if(t instanceof hT)return iY(t,e);throw r0("To use ref(service, url), the first argument must be a Storage instance.")}else return ZL(t,e)}function fR(t,e){const n=e==null?void 0:e[ML];return n==null?null:es.makeFromBucketSpec(n,t)}function aY(t,e,n,r={}){t.host=`${e}:${n}`;const s=$s(e);s&&(hf(`https://${t.host}/b`),Xg("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:LN(i,t.app.options.projectId))}class hT{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=LL,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=eQ,this._maxUploadRetryTime=tQ,this._requests=new Set,s!=null?this._bucket=es.makeFromBucketSpec(s,this._host):this._bucket=fR(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=es.makeFromBucketSpec(this._url,e):this._bucket=fR(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){dR("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){dR("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Dl(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new pQ(jL());{const o=AQ(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const mR="@firebase/storage",pR="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eM="storage";function gZ(t,e,n){return t=tt(t),eY(t,e,n)}function lY(t,e,n){return t=tt(t),tY(t,e,n)}function cY(t){return t=tt(t),nY(t)}function uY(t,e){return t=tt(t),oY(t,e)}function tM(t=ey(),e){t=tt(t);const r=$l(t,eM).getImmediate({identifier:e}),s=VE("storage");return s&&dY(r,...s),r}function dY(t,e,n,r={}){aY(t,e,n,r)}function hY(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new hT(n,r,s,e,Bl)}function fY(){yi(new Fs(eM,hY,"PUBLIC").setMultipleInstances(!0)),rs(mR,pR,""),rs(mR,pR,"esm2020")}fY();const mY={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"0.0.0",VITE_DEV_MODE:"true",VITE_ENABLE_OFFLINE_PERSISTENCE:"false",VITE_FIREBASE_API_KEY:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),VITE_FIREBASE_APP_ID:"1:483702062341:web:b1ff06ad175cb7ae428b6c",VITE_FIREBASE_AUTH_DOMAIN:"voda-c6abd.firebaseapp.com",VITE_FIREBASE_AUTH_EMULATOR_URL:"http://localhost:9099",VITE_FIREBASE_FIRESTORE_EMULATOR_HOST:"localhost:8080",VITE_FIREBASE_FUNCTIONS_EMULATOR_HOST:"localhost:5001",VITE_FIREBASE_MEASUREMENT_ID:"G-CV6QGH7G7P",VITE_FIREBASE_MESSAGING_SENDER_ID:"483702062341",VITE_FIREBASE_PROJECT_ID:"voda-c6abd",VITE_FIREBASE_STORAGE_BUCKET:"voda-c6abd.appspot.com",VITE_FORCE_HASH_ROUTER:"true",VITE_SHOP_ID:"demo-shop-001",VITE_SHOP_NAME:"   ",VITE_SHOW_ENV_BANNER:"true",VITE_USE_EMULATORS:"false",VITE_USE_FIREBASE_EMULATOR:"false"},yg={apiKey:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),authDomain:"voda-c6abd.firebaseapp.com",projectId:"voda-c6abd",storageBucket:"voda-c6abd.appspot.com",messagingSenderId:"483702062341",appId:"1:483702062341:web:b1ff06ad175cb7ae428b6c"};console.log(" Initializing Firebase with config:",{projectId:yg.projectId,authDomain:yg.authDomain,emulatorMode:!1});const Ny=$N(yg);try{typeof window<"u",void 0||console.log(" App Check not initialized: missing VITE_FIREBASE_RECAPTCHA_KEY")}catch(t){console.log(" Failed to initialize App Check (will proceed without it):",t)}const Ot=uD(Ny,{persistence:[HE,Tw]});console.log(" Firebase Auth initialized with browserLocalPersistence (fallback to inMemory)");const G=aL(Ny,{experimentalForceLongPolling:!0,useFetchStreams:!1});try{UD("error")}catch{}const nM=JG(Ny,"us-central1");tM(Ny);console.log(" Firebase initialized successfully");const pY=async()=>{try{console.log(" Offline persistence disabled (env flag or emulator mode)"),console.log(" Firestore features configured successfully")}catch(t){console.error(" Error configuring Firestore features:",t)}};setTimeout(pY,100);let Ba=0;const qv=3,gY=1e3,rM=async t=>{var e,n;if(console.error(" Firestore connection error:",t),(t.code==="unavailable"||t.code==="failed-precondition"||(e=t.message)!=null&&e.includes("ERR_ABORTED")||(n=t.message)!=null&&n.includes("UNAVAILABLE"))&&Ba<qv){Ba++;const r=Math.min(gY*Math.pow(2,Ba-1),1e4);console.log(` Attempting to reconnect (${Ba}/${qv}) in ${r}ms...`);try{await HI(G),await new Promise(s=>setTimeout(s,r)),await qI(G),console.log(" Firestore reconnected successfully"),Ba=0}catch(s){console.error(" Failed to reconnect:",s),Ba>=qv&&(console.error(" Maximum reconnection attempts reached."),yY())}}},yY=()=>{const t=document.createElement("div");t.style.cssText=`
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #f8d7da;
    color: #721c24;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #f5c6cb;
    z-index: 10000;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    max-width: 400px;
  `,t.innerHTML=`
    <h3 style="margin: 0 0 10px 0;">  </h3>
    <p style="margin: 0 0 15px 0;">   .     .</p>
    <button onclick="window.location.reload()" style="
      background: #dc3545;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
    ">  </button>
  `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},1e4)};window.addEventListener("online",async()=>{console.log(" Network back online, enabling Firestore...");try{await qI(G),Ba=0,console.log(" Firestore network enabled")}catch(t){console.error(" Failed to enable Firestore network:",t)}});window.addEventListener("offline",async()=>{console.log(" Network offline, disabling Firestore network...");try{await HI(G),console.log(" Firestore network disabled")}catch(t){console.error(" Failed to disable Firestore network:",t)}});window.addEventListener("unhandledrejection",t=>{var e,n,r,s,i,o;(((e=t.reason)==null?void 0:e.code)==="unavailable"||((n=t.reason)==null?void 0:n.code)==="failed-precondition"||(s=(r=t.reason)==null?void 0:r.message)!=null&&s.includes("ERR_ABORTED")||(o=(i=t.reason)==null?void 0:i.message)!=null&&o.includes("UNAVAILABLE"))&&(rM(t.reason),t.preventDefault())});console.log("Using Firebase Production Environment");const qt=Object.freeze(Object.defineProperty({__proto__:null,auth:Ot,db:G,firebaseConfig:yg,functions:nM,handleFirestoreError:rM},Symbol.toStringTag,{value:"Module"})),st=t=>{if(t&&typeof t=="object"&&typeof t.toDate=="function")return t.toDate();if(t instanceof Date)return t;if(typeof t=="number")return new Date(t);if(typeof t=="string"){const e=new Date(t);return isNaN(e.getTime())?new Date:e}return new Date},vY=t=>{if(t===null)return!1;const e=Object.getPrototypeOf(t);return e===Object.prototype||e===null},Ol=t=>{if(t===void 0)return;if(t===null)return null;if(Array.isArray(t))return t.map(n=>Ol(n)).filter(n=>n!==void 0);if(t instanceof Date||!vY(t))return t;const e={};for(const[n,r]of Object.entries(t)){const s=Ol(r);s!==void 0&&(e[n]=s)}return e},sp={async create(t){await on(Ce(G,"profiles",t.userId),{userId:t.userId,shopId:t.shopId,role:t.role,fullName:t.fullName,phone:t.phone,createdAt:Le()})},async getById(t){const e=Ce(G,"profiles",t),n=await Qt(e);if(n.exists()){const r=n.data();return{userId:n.id,...r,createdAt:st(r.createdAt)}}return null},async update(t,e){const n=Ce(G,"profiles",t);await wn(n,{...e,updatedAt:Le()})},async getByShopId(t){const e=Ve(ke(G,"profiles"),Oe("shopId","==",t));return(await Be(e)).docs.map(r=>{const s=r.data();return{userId:r.id,...s,createdAt:st(s.createdAt)}})}},s0={async create(t){return(await mi(ke(G,"referrals"),{...t,createdAt:Le(),updatedAt:Le()})).id},async getByReferrerId(t){try{const e=Ve(ke(G,"referrals"),Oe("referrerId","==",t),ra("createdAt","desc"));return(await Be(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:st(r.data().createdAt),updatedAt:st(r.data().updatedAt)}))}catch(e){if(String((e==null?void 0:e.message)||"").includes("requires an index")){const r=Ve(ke(G,"referrals"),Oe("referrerId","==",t));return(await Be(r)).docs.map(i=>({id:i.id,...i.data(),createdAt:st(i.data().createdAt),updatedAt:st(i.data().updatedAt)})).sort((i,o)=>{var a,l,c,u;return(((l=(a=o.createdAt)==null?void 0:a.getTime)==null?void 0:l.call(a))||0)-(((u=(c=i.createdAt)==null?void 0:c.getTime)==null?void 0:u.call(c))||0)})}throw e}},async getByReferralCode(t){const e=Ve(ke(G,"referrals"),Oe("referralCode","==",t),id(1)),n=await Be(e);if(n.empty)return null;const r=n.docs[0];return{id:r.id,...r.data(),createdAt:st(r.data().createdAt),updatedAt:st(r.data().updatedAt)}},async updateStatus(t,e){await wn(Ce(G,"referrals",t),{status:e,updatedAt:Le()})},generateReferralCode(t){const e=Date.now().toString(36);return`REF_${t.slice(-6)}_${e}`.toUpperCase()}},sM={async getByUserId(t){const e=Ve(ke(G,"profiles"),Oe("userId","==",t)),n=await Be(e);if(!n.empty){const r=n.docs[0],s=r.data();return{userId:r.id,...s,createdAt:st(s.createdAt),updatedAt:st(s.updatedAt)}}return null},async update(t,e){const n=Ve(ke(G,"profiles"),Oe("userId","==",t)),r=await Be(n);if(!r.empty){const s=Ce(G,"profiles",r.docs[0].id);await wn(s,{...e,updatedAt:Le()})}}},zo={async create(t){return(await mi(ke(G,"merchantWallets"),{...t,transferLimit:t.transferLimit||2e5,withdrawLimit:t.withdrawLimit||2e5,transferUsage:t.transferUsage||0,withdrawUsage:t.withdrawUsage||0,createdAt:Le(),updatedAt:Le()})).id},async getByMerchantId(t){const e=Ve(ke(G,"merchantWallets"),Oe("merchantUserId","==",t)),r=(await Be(e)).docs.map(a=>{const l=a.data();return{id:a.id,...l,transferLimit:l.transferLimit||2e5,withdrawLimit:l.withdrawLimit||2e5,transferUsage:l.transferUsage||0,withdrawUsage:l.withdrawUsage||0,createdAt:st(l.createdAt),updatedAt:st(l.updatedAt)}});if(r.length>0)return r.sort((a,l)=>{const c=a.createdAt,u=l.createdAt;return c&&u?u.getTime()-c.getTime():c&&!u?-1:!c&&u?1:0});const s=Ve(ke(G,"wallets"),Oe("userId","==",t));return(await Be(s)).docs.map(a=>{const l=a.data();return{id:a.id,merchantUserId:l.userId||t,provider:l.provider||"instapay",msisdn:l.msisdn||"",label:l.name||l.label||"",isActive:l.isActive!==!1,dailyLimit:l.dailyLimit||2e5,monthlyLimit:l.monthlyLimit||2e5,transferLimit:l.transferLimit||l.monthlyTransferLimit||2e5,withdrawLimit:l.withdrawLimit||l.monthlyWithdrawLimit||2e5,transferUsage:l.transferUsage||l.monthlyTransferUsage||0,withdrawUsage:l.withdrawUsage||l.monthlyWithdrawUsage||0,dailyTransferLimit:l.dailyTransferLimit,dailyWithdrawLimit:l.dailyWithdrawLimit,createdAt:st(l.createdAt),updatedAt:st(l.updatedAt)}}).sort((a,l)=>{const c=a.createdAt,u=l.createdAt;return c&&u?u.getTime()-c.getTime():c&&!u?-1:!c&&u?1:0})},async getById(t){const e=Ce(G,"merchantWallets",t),n=await Qt(e);if(n.exists()){const r=n.data();return{id:n.id,...r,transferLimit:r.transferLimit||2e5,withdrawLimit:r.withdrawLimit||2e5,transferUsage:r.transferUsage||0,withdrawUsage:r.withdrawUsage||0,createdAt:st(r.createdAt),updatedAt:st(r.updatedAt)}}return null},async getByIccid(t){try{if(!t)return null;const e=Ve(ke(G,"merchantWallets"),Oe("iccid","==",t)),n=await Be(e);if(!n.empty){const r=n.docs[0],s=r.data();return{id:r.id,...s,transferLimit:s.transferLimit||2e5,withdrawLimit:s.withdrawLimit||2e5,transferUsage:s.transferUsage||0,withdrawUsage:s.withdrawUsage||0,createdAt:st(s.createdAt),updatedAt:st(s.updatedAt)}}return null}catch(e){return console.warn("getByIccid failed:",e),null}},async getByMsisdn(t){try{const e=String(t||"").replace(/\D/g,"");if(!e)return null;let n=Ve(ke(G,"merchantWallets"),Oe("msisdn","==",t)),r=await Be(n);if(!r.empty){const a=r.docs[0],l=a.data();return{id:a.id,...l,transferLimit:l.transferLimit||2e5,withdrawLimit:l.withdrawLimit||2e5,transferUsage:l.transferUsage||0,withdrawUsage:l.withdrawUsage||0,createdAt:st(l.createdAt),updatedAt:st(l.updatedAt)}}const s=Ve(ke(G,"merchantWallets")),i=await Be(s),o=e.slice(-7);for(const a of i.docs){const l=a.data();if(String(l.msisdn||"").replace(/\D/g,"").slice(-7)===o)return{id:a.id,...l,transferLimit:l.transferLimit||2e5,withdrawLimit:l.withdrawLimit||2e5,transferUsage:l.transferUsage||0,withdrawUsage:l.withdrawUsage||0,createdAt:st(l.createdAt),updatedAt:st(l.updatedAt)}}return null}catch(e){return console.warn("getByMsisdn failed:",e),null}},async update(t,e){const n=Ce(G,"merchantWallets",t);await wn(n,{...e,updatedAt:Le()})},async updateUsage(t,e,n){const r=Ce(G,"merchantWallets",t),s={updatedAt:Le()};e!==void 0&&(s.transferUsage=e),n!==void 0&&(s.withdrawUsage=n),await wn(r,s)},async resetDailyUsage(t){const n=(await this.getByMerchantId(t)).map(r=>this.updateUsage(r.id,0,0));await Promise.all(n)},async reassignByMsisdns(t,e){try{if(!e)throw new Error("merchantUserId   ");if(!Array.isArray(t)||t.length===0)return{updated:0,failed:0};const r=((o,a)=>o.reduce((l,c,u)=>(u%a===0&&l.push(o.slice(u,u+a)),l),[]))(t.map(o=>o.trim()).filter(Boolean),10);let s=0,i=0;for(const o of r){const a=Ve(ke(G,"merchantWallets"),Oe("msisdn","in",o)),c=(await Be(a)).docs.map(async u=>{try{const h=u.data();if(h.merchantUserId&&h.merchantUserId!==e)return;await wn(u.ref,{merchantUserId:e,updatedAt:Le()}),s+=1}catch(h){console.error("Failed to reassign wallet",u.id,h),i+=1}});await Promise.allSettled(c)}return{updated:s,failed:i}}catch(n){return console.error("Error reassigning wallets by msisdns:",n),{updated:0,failed:t.length}}},async delete(t){const e=Ce(G,"merchantWallets",t);await Xn(e)}},fT={async create(t){try{console.log("Creating transaction:",t);const{calculateCommission:e,calculateProfit:n}=await ne(async()=>{const{calculateCommission:c,calculateProfit:u}=await Promise.resolve().then(()=>nl);return{calculateCommission:c,calculateProfit:u}},void 0,import.meta.url),r=t.commission!==void 0?t.commission:e(t.amount,t.txnType),s=n(t.amount,t.txnType),i=t.merchantUserId||t.createdBy;i||console.warn("   merchantUserId  createdBy         .");const o=Object.fromEntries(Object.entries(t).filter(([c,u])=>u!==void 0)),a={...o,merchantUserId:i,commission:r,profit:s,createdAt:o.createdAt?o.createdAt instanceof Date?o.createdAt:new Date(String(o.createdAt)):new Date,uploadedAt:Le(),confirmedAt:o.confirmedAt?o.confirmedAt instanceof Date?o.confirmedAt:new Date(String(o.confirmedAt)):null},l=await mi(ke(G,"transactions"),a);if(console.log("Transaction created with ID:",l.id,"Profit:",s),s>0){const{ProfitService:c}=await ne(async()=>{const{ProfitService:u}=await import("./profitService-oNUfz-Yd.js");return{ProfitService:u}},[],import.meta.url);try{c.addProfit(s,i)}catch{c.addProfit(s)}console.log("     :",s,"")}await this.updateLineUsage(t.lineId,t.amount);try{const c=String((t==null?void 0:t.walletId)||"").trim();if(c){const u=await zo.getById(c),h=Number((u==null?void 0:u.transferUsage)||0),f=Number((u==null?void 0:u.withdrawUsage)||0),m=Number(t.amount||0),E=String((t==null?void 0:t.originType)||"").trim()==="withdraw",p=String(t.txnType||"")==="receive";E||p?await zo.updateUsage(c,void 0,f+m):await zo.updateUsage(c,h+m,void 0)}}catch{}try{const c=Number(t.amount||0),u=String((t==null?void 0:t.receiverMsisdn)||"").trim(),h=String((t==null?void 0:t.walletId)||"").trim(),f=String((t==null?void 0:t.originType)||"").trim();let m="";if(h)try{const p=await zo.getById(h);m=String((p==null?void 0:p.msisdn)||(p==null?void 0:p.label)||h).trim()}catch{}let E="";f==="withdraw"?E=m?`   ${c}   ${m}    ${r}`:`   ${c}    ${r}`:f==="transfer"||t.txnType==="send"?E=`   ${c}   ${m||" "}   ${u||""}    ${r}`:E=m?`  ${c}   ${m}`:`  ${c}`}catch{}return l.id}catch(e){throw console.error("Error creating transaction:",e),e}},async updateLineUsage(t,e){try{console.log("Updating line usage:",{lineId:t,amount:e})}catch(n){console.error("Error updating line usage:",n)}},async getByShopId(t){const e=Ve(ke(G,"transactions"),Oe("shopId","==",t),ra("createdAt","desc"));return(await Be(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:st(r.data().createdAt),confirmedAt:r.data().confirmedAt?st(r.data().confirmedAt):void 0}))},async getByMerchantId(t){const e=Ve(ke(G,"transactions"),Oe("merchantUserId","==",t),ra("createdAt","desc"));return(await Be(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:st(r.data().createdAt),confirmedAt:r.data().confirmedAt?st(r.data().confirmedAt):void 0}))},async getByUserId(t){const e=Ve(ke(G,"transactions"),Oe("merchantUserId","==",t)),n=Ve(ke(G,"transactions"),Oe("userId","==",t)),[r,s]=await Promise.all([Be(e),Be(n)]),i=[...r.docs,...s.docs],o=new Set,a=[];for(const l of i){if(o.has(l.id))continue;o.add(l.id);const c=l.data();a.push({id:l.id,...c,createdAt:st(c.createdAt),confirmedAt:c.confirmedAt?st(c.confirmedAt):void 0})}return a.sort((l,c)=>{const u=l.createdAt,h=c.createdAt;return u&&h?h.getTime()-u.getTime():u&&!h?-1:!u&&h?1:0})},async updateStatus(t,e,n){const r=Ce(G,"transactions",t);await wn(r,{status:e,confirmedAt:n?n instanceof Date?n:new Date(String(n)):null})}};async function _Y(t){const e={shopId:t.shopId,lineId:t.lineId,merchantUserId:t.createdBy,walletId:t.walletId,provider:t.provider||"vodafone_cash",txnType:"receive",originType:"withdraw",amount:t.amount,receiverMsisdn:t.lineId,senderMsisdn:t.senderMsisdn,senderName:t.senderName,reference:t.reference,rawText:t.text,note:t.note,createdBy:t.createdBy,createdAt:new Date,confirmedAt:new Date,status:"confirmed"},n=await fT.create(e);try{const{calculateCommission:r}=await ne(async()=>{const{calculateCommission:o}=await Promise.resolve().then(()=>nl);return{calculateCommission:o}},void 0,import.meta.url),s=r(Number(t.amount||0),"receive"),i={transactionId:n,userId:t.createdBy,transactionType:"withdraw",txnType:"receive",status:"confirmed",amount:Number(t.amount||0),commission:s,senderMsisdn:t.senderMsisdn,receiverMsisdn:t.lineId,fromWallet:t.walletId,note:t.note||"SMS-VF",reference:t.reference,createdAt:new Date,cashierName:" "};await Xr.saveUserTransaction(t.createdBy,i)}catch{}return(async()=>{try{const{calculateCommission:r}=await ne(async()=>{const{calculateCommission:h}=await Promise.resolve().then(()=>nl);return{calculateCommission:h}},void 0,import.meta.url),s=r(Number(t.amount||0),"receive"),i=await Xr.getUserData(t.createdBy),o={...(i==null?void 0:i.walletBalances)||{}},a=Math.max(0,Number(o[t.walletId]||0)),l=Math.max(0,Number(t.amount||0));o[t.walletId]=a+l;const u=Number((i==null?void 0:i.cashBalance)||0)-l+Math.max(0,s);await Xr.updateUserData(t.createdBy,{walletBalances:o,cashBalance:u,lastUpdated:new Date().toISOString()})}catch{}})(),(async()=>{try{const{walletDailyLimitsService:r}=await ne(async()=>{const{walletDailyLimitsService:i}=await Promise.resolve().then(()=>d0);return{walletDailyLimitsService:i}},void 0,import.meta.url),s=Math.max(0,Number(t.amount||0));await r.updateUsage(String(t.walletId),s,"withdraw")}catch(r){console.warn("      SMS:",r)}})(),n}const wY="https://summer-cake-5149.alkaptin2030.workers.dev",iM={async getTelegramWorkerUrl(){var t;try{const e=Ce(G,"systemSettings","core"),n=await Qt(e);return n.exists()&&String(((t=n.data())==null?void 0:t.telegramWorkerUrl)||"").trim()||null}catch{return null}},async setTelegramWorkerUrl(t){const e=Ce(G,"systemSettings","core");await on(e,{telegramWorkerUrl:t,updatedAt:Le()},{merge:!0})}},EY={async send(t,e){try{const n=await Xr.getUserData(t),r=String((n==null?void 0:n.telegramChatId)||(n==null?void 0:n.chat_id)||"").trim();if(!r)throw new Error("Telegram Chat ID   ");const i=(await iM.getTelegramWorkerUrl()||wY).replace(/\/$/,""),o=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:r,text:e})});if(!o.ok){const a=await o.text().catch(()=>"");throw new Error(a||"     ")}}catch{}}},IY={async log(t,e,n,r,s){await mi(ke(G,"auditLogs"),{actor:s,action:t,entity:e,entityId:n,meta:r,createdAt:Le()})},async getLogs(t=100){const e=Ve(ke(G,"auditLogs"),ra("createdAt","desc"),id(t));return(await Be(e)).docs.map(r=>({id:r.id,...r.data(),createdAt:st(r.data().createdAt)}))},async getDeletedTransactions(){try{const t=Ve(ke(G,"deletedTransactions"),ra("deletedAt","desc"));return(await Be(t)).docs.map(n=>({id:n.id,...n.data(),deletedAt:st(n.data().deletedAt)}))}catch(t){return console.error("Error getting deleted transactions:",t),[]}},async getDeletedTransactionsByUser(t){try{const e=Ve(ke(G,"deletedTransactions"),Oe("userId","==",t),ra("deletedAt","desc"));return(await Be(e)).docs.map(r=>({id:r.id,...r.data(),deletedAt:st(r.data().deletedAt)})).filter(r=>(r==null?void 0:r.permanent)!==!0)}catch(e){if(String((e==null?void 0:e.message)||"").includes("requires an index"))try{const r=Ve(ke(G,"deletedTransactions"),Oe("userId","==",t));return(await Be(r)).docs.map(o=>({id:o.id,...o.data(),deletedAt:st(o.data().deletedAt)})).filter(o=>(o==null?void 0:o.permanent)!==!0).sort((o,a)=>{const l=(o.deletedAt instanceof Date?o.deletedAt:new Date(o.deletedAt)).getTime();return(a.deletedAt instanceof Date?a.deletedAt:new Date(a.deletedAt)).getTime()-l})}catch(r){return console.error("Fallback error getting deleted transactions by user:",r),[]}return console.error("Error getting deleted transactions by user:",e),[]}},async saveDeletedTransaction(t){var e;try{if(console.log("      Firebase:",t.id),!t.userId)throw new Error("     ");if(!t.originalTransactionId)throw new Error("   ");const n=t.reference??t.transactionReference??((e=t.receipt)==null?void 0:e.reference),r={...t,deletedAt:Le(),userId:t.userId,originalTransactionId:t.originalTransactionId,type:t.type||"unknown",amount:t.amount||0,status:t.status||"deleted",...n?{reference:n}:{}};console.log("    :",r);let s=3,i;for(;s>0;)try{const o=await mi(ke(G,"deletedTransactions"),r);console.log("       :",o.id);return}catch(o){i=o,s--,console.warn(`       : ${s}`,o),s>0&&await new Promise(a=>setTimeout(a,1e3))}throw console.error("        "),i}catch(n){throw console.error("     :",n),n instanceof Error&&(n.message.includes("network")?console.error("    -    "):n.message.includes("permission")?console.error("    -    Firestore"):n.message.includes("quota")&&console.error("     -    Firebase")),n}},async permanentlyDeleteTransaction(t,e){try{const n=Ve(ke(G,"deletedTransactions"),Oe("originalTransactionId","==",t),Oe("userId","==",e)),r=await Be(n);r.empty?await mi(ke(G,"deletedTransactions"),{userId:e,originalTransactionId:t,permanent:!0,deletedAt:Le()}):await Promise.all(r.docs.map(s=>wn(s.ref,{permanent:!0,deletedAt:Le()}))),console.log("    :",t);try{const s=Ve(ke(G,"userTransactions"),Oe("userId","==",e)),o=(await Be(s)).docs.filter(a=>{var c,u;const l=a.data();return a.id===t||l.id===t||l.transactionId===t||l.originalTransactionId===t||((c=l.receipt)==null?void 0:c.id)===t||((u=l.receipt)==null?void 0:u.transactionId)===t});o.length>0&&(console.log(`  ${o.length}   userTransactions`),await Promise.all(o.map(a=>Xn(a.ref))))}catch(s){console.warn("   userTransactions   :",s)}try{const s=Ce(G,"transactions",t);(await Qt(s)).exists()&&(console.log("     transactions  "),await Xn(s));const o=Ve(ke(G,"transactions"),Oe("transactionId","==",t)),a=await Be(o);a.empty||(console.log(`  ${a.size}   transactions  transactionId`),await Promise.all(a.docs.map(u=>Xn(u.ref))));const l=Ve(ke(G,"transactions"),Oe("originalTransactionId","==",t)),c=await Be(l);c.empty||(console.log(`  ${c.size}   transactions  originalTransactionId`),await Promise.all(c.docs.map(u=>Xn(u.ref))));try{const u=Ve(ke(G,"deletedTransactions"),Oe("userId","==",e),Oe("originalTransactionId","==",t)),h=await Be(u),f=h.docs.map(E=>{var p;return String(((p=E.data())==null?void 0:p.reference)||"")}).filter(Boolean),m=h.docs.map(E=>{var p;return String(((p=E.data())==null?void 0:p.transactionId)||"")}).filter(Boolean);for(const E of f){const p=Ve(ke(G,"transactions"),Oe("reference","==",E)),I=await Be(p);I.empty||(console.log(`  ${I.size}   transactions  reference=${E}`),await Promise.all(I.docs.map(g=>Xn(g.ref))))}for(const E of m){try{const g=Ce(G,"transactions",E);(await Qt(g)).exists()&&(console.log("     transactions  :",E),await Xn(g))}catch{}const p=Ve(ke(G,"transactions"),Oe("transactionId","==",E)),I=await Be(p);I.empty||(console.log(`  ${I.size}   transactions  transactionId=${E}`),await Promise.all(I.docs.map(g=>Xn(g.ref))))}}catch{}}catch(s){console.warn("    transactions   :",s)}}catch(n){throw console.error("Error permanently deleting transaction:",n),n}}},oM={async add(t){const e=`${String(t.userId)}_${String(t.reportDate)}`,n=Ce(G,"daily_reports_archive",e);return await on(n,{userId:t.userId,reportDate:t.reportDate,totalTransactions:t.totalTransactions,totalAmount:t.totalAmount,totalWithdrawn:t.totalWithdrawn,totalSent:t.totalSent,profit:t.profit??null,walletId:t.walletId??null,updatedAt:Le()},{merge:!0}),e},async getByUser(t,e=50){var n,r,s,i;try{const o=Ve(ke(G,"daily_reports_archive"),Oe("userId","==",t),id(e)),a=await Be(o);let l=[];try{l=(await Be(Ve(ke(G,"deletedDailyArchives"),Oe("userId","==",t)))).docs.map(E=>{var p,I;return{id:E.id,reportDate:String(((p=E.data())==null?void 0:p.reportDate)||""),archiveId:String(((I=E.data())==null?void 0:I.archiveId)||"")}})}catch{}const c=(m,E)=>l.some(p=>p.archiveId&&p.archiveId===m||p.reportDate&&p.reportDate===E),u=a.docs.map(m=>({id:m.id,userId:String(m.data().userId),reportDate:String(m.data().reportDate),totalTransactions:Number(m.data().totalTransactions||0),totalAmount:Number(m.data().totalAmount||0),totalWithdrawn:Number(m.data().totalWithdrawn||0),totalSent:Number(m.data().totalSent||0),profit:m.data().profit!==void 0?Number(m.data().profit):void 0,walletId:m.data().walletId??null,createdAt:st(m.data().createdAt||m.data().updatedAt)})).filter(m=>!c(m.id,m.reportDate)),h=new Map;for(const m of u){const E=h.get(m.reportDate);(!E||(((r=(n=m.createdAt)==null?void 0:n.getTime)==null?void 0:r.call(n))||0)>(((i=(s=E.createdAt)==null?void 0:s.getTime)==null?void 0:i.call(s))||0))&&h.set(m.reportDate,m)}const f=Array.from(h.values());return f.sort((m,E)=>m.reportDate<E.reportDate?1:-1),f}catch(o){throw console.error("Error loading daily reports archive:",o),o}},async deleteOlderThan(t,e=10){try{const n=new Date;n.setDate(n.getDate()-e);const r=Ve(ke(G,"daily_reports_archive"),Oe("userId","==",t)),s=await Be(r);let i=0;for(const o of s.docs){const a=st(o.data().createdAt);a&&a.getTime()<n.getTime()&&(await Xn(o.ref),i++)}return i>0&&console.log(`   ${i}      ${e}   ${t}`),i}catch(n){throw console.error("Error deleting old daily reports archive:",n),n}},async trimToMaxCount(t,e=10){try{const n=Ve(ke(G,"daily_reports_archive"),Oe("userId","==",t)),s=(await Be(n)).docs.map(o=>({ref:o.ref,reportDate:String(o.data().reportDate||""),createdAt:st(o.data().createdAt)}));if(s.sort((o,a)=>{var u,h;if(o.reportDate&&a.reportDate)return o.reportDate<a.reportDate?1:-1;const l=((u=o.createdAt)==null?void 0:u.getTime())??0;return(((h=a.createdAt)==null?void 0:h.getTime())??0)-l}),s.length<=e)return 0;const i=s.slice(e);for(const o of i)await Xn(o.ref);return console.log(`     ${t}  ${e}   ${i.length}`),i.length}catch(n){throw console.error("Error trimming daily reports archive to max count:",n),n}},async deleteAllByUser(t){try{const e=Ve(ke(G,"daily_reports_archive"),Oe("userId","==",t)),n=await Be(e);let r=0;for(const s of n.docs)try{await Xn(s.ref),r++}catch{const o=s.data();try{await mi(ke(G,"deletedDailyArchives"),{userId:t,archiveId:s.id,reportDate:String((o==null?void 0:o.reportDate)||""),createdAt:Le()})}catch{}}return r}catch(e){throw console.error("Error deleting all daily reports archive for user:",e),e}}},Xr={async getUserData(t){try{console.log("     :",{userId:t});const e=Ce(G,"users",t),n=await Qt(e);if(n.exists()){const r=n.data();return console.log("     :",r),{...r,createdAt:st(r.createdAt),updatedAt:st(r.updatedAt)}}else{console.log("       ");const r={walletBalances:{},createdAt:new Date,updatedAt:new Date};return await this.saveUserData(t,r),console.log("     "),r}}catch(e){return console.error("      :",e),{walletBalances:{},createdAt:new Date,updatedAt:new Date}}},getLocalReceipts(t){try{const e=localStorage.getItem(`localReceipts_${t}`);if(!e)return[];const n=JSON.parse(e);return Array.isArray(n)?n:[]}catch{return[]}},saveLocalReceipt(t,e){try{const n=this.getLocalReceipts(t),r=200,s=l=>{var c;return String((l==null?void 0:l.id)||(l==null?void 0:l.transactionId)||(l==null?void 0:l.originalTransactionId)||(l==null?void 0:l.reference)||(l==null?void 0:l.transactionReference)||((c=l==null?void 0:l.receipt)==null?void 0:c.reference)||`${(l==null?void 0:l.type)||"tx"}-${new Date((l==null?void 0:l.createdAt)||Date.now()).getTime()}`)},i=s(e),o=n.filter(l=>s(l)!==i),a=[e,...o].slice(0,r);localStorage.setItem(`localReceipts_${t}`,JSON.stringify(a))}catch{}},removeLocalReceiptById(t,e){try{const r=this.getLocalReceipts(t).filter(s=>{var o,a;return![s==null?void 0:s.id,s==null?void 0:s.transactionId,s==null?void 0:s.originalTransactionId,(o=s==null?void 0:s.receipt)==null?void 0:o.transactionId,(a=s==null?void 0:s.receipt)==null?void 0:a.id].map(l=>String(l||"")).includes(String(e))});localStorage.setItem(`localReceipts_${t}`,JSON.stringify(r))}catch{}},removeLocalReceiptByRef(t,e){try{if(!e)return;const r=this.getLocalReceipts(t).filter(s=>{var o;return![s==null?void 0:s.reference,s==null?void 0:s.transactionReference,(o=s==null?void 0:s.receipt)==null?void 0:o.reference].map(a=>String(a||"")).includes(String(e))});localStorage.setItem(`localReceipts_${t}`,JSON.stringify(r))}catch{}},async syncDeletedTransactionsLocal(t){try{const e=Ve(ke(G,"deletedTransactions"),Oe("userId","==",t));(await Be(e)).docs.forEach(r=>{const s=r.data();if(!((s==null?void 0:s.permanent)===!0))return;const o=String((s==null?void 0:s.originalTransactionId)||""),a=String((s==null?void 0:s.transactionId)||""),l=String((s==null?void 0:s.reference)||"");o&&this.removeLocalReceiptById(t,o),a&&this.removeLocalReceiptById(t,a),l&&this.removeLocalReceiptByRef(t,l)})}catch(e){console.warn("syncDeletedTransactionsLocal failed:",e)}},async saveUserData(t,e){try{const n=Ce(G,"users",t),r=Ol(e);await on(n,{...r||{},updatedAt:Le()},{merge:!0})}catch(n){throw console.error("Error saving user data:",n),n}},async updateUserData(t,e){try{console.log("      Firebase:",{userId:t,data:e});const n=Ce(G,"users",t),r=Object.fromEntries(Object.entries(e).filter(([l,c])=>c!==void 0)),s=Ol(r);let i={};try{const l=await Qt(n);i=l.exists()?l.data():{},console.log("  :",i)}catch(l){console.warn("         :",l)}const o={...i,...s,updatedAt:Le()};console.log("   :",o);let a=3;for(;a>0;)try{await on(n,o,{merge:!0}),console.log("     ");return}catch(l){if(a--,console.warn(`     : ${a}`,l),a===0)throw l;await new Promise(c=>setTimeout(c,1e3))}}catch(n){throw console.error("     :",n),n instanceof Error&&(n.message.includes("network")?console.error("    -    "):n.message.includes("permission")?console.error("    -    Firestore"):n.message.includes("quota")&&console.error("     -    Firebase")),n}},async getUserWallets(t){try{const e=await this.getUserData(t);return(e==null?void 0:e.wallets)||[]}catch(e){return console.error("Error getting user wallets:",e),[]}},async getUserTransactions(t){try{let e;try{const l=Ve(ke(G,"userTransactions"),Oe("userId","==",t),ra("createdAt","desc"),id(200));e=await Be(l)}catch(l){const c=String((l==null?void 0:l.message)||""),u=Ve(ke(G,"userTransactions"),Oe("userId","==",t));e=await Be(u)}const n=e.docs.map(l=>({id:l.id,...l.data(),createdAt:st(l.data().createdAt)})),r=this.getLocalReceipts(t),s=[...n,...r],i=l=>{var c;return String((l==null?void 0:l.id)||(l==null?void 0:l.transactionId)||(l==null?void 0:l.originalTransactionId)||(l==null?void 0:l.reference)||(l==null?void 0:l.transactionReference)||((c=l==null?void 0:l.receipt)==null?void 0:c.reference)||`${(l==null?void 0:l.type)||"tx"}-${new Date((l==null?void 0:l.createdAt)||0).getTime()}`)},o=new Set;return s.filter(l=>{const c=i(l);return o.has(c)?!1:(o.add(c),!0)}).filter(l=>(l==null?void 0:l.status)!=="cancelled"&&!(l!=null&&l.isDeleted)).sort((l,c)=>{const u=l.createdAt?new Date(l.createdAt).getTime():0;return(c.createdAt?new Date(c.createdAt).getTime():0)-u})}catch(e){console.error("Error getting user transactions:",e);const n=(e==null?void 0:e.code)||"";if(n==="permission-denied"||n==="unauthenticated")throw e;return[]}},async saveUserTransaction(t,e){var n,r;try{const s=Object.fromEntries(Object.entries(e??{}).filter(([o,a])=>a!==void 0));try{const o=s.reference;if(o){const a=Ve(ke(G,"deletedTransactions"),Oe("userId","==",t),Oe("reference","==",o));if(!(await Be(a)).empty)return console.log("          ."),"skip-deleted"}{const a=Ve(ke(G,"deletedTransactions"),Oe("userId","==",t),Oe("permanent","==",!0)),l=await Be(a);if(!l.empty){const c=[s.id,s.transactionId,s.originalTransactionId,(n=s.receipt)==null?void 0:n.id,(r=s.receipt)==null?void 0:r.transactionId,s.reference,s.transactionReference].filter(h=>!!h).map(h=>String(h));if(l.docs.find(h=>{const f=h.data(),m=String(f.originalTransactionId||f.transactionId||h.id||""),E=String(f.reference||"");return m&&c.includes(m)||E&&c.includes(E)}))return console.log("        /   ."),"skip-deleted"}}}catch(o){console.warn("           :",o)}try{const o=Ve(ke(G,"userTransactions"),Oe("userId","==",t));if(s.transactionId){const a=Ve(ke(G,"userTransactions"),Oe("userId","==",t),Oe("transactionId","==",s.transactionId)),l=await Be(a);if(!l.empty){const c=l.docs[0];return await wn(Ce(G,"userTransactions",c.id),{...s,uploadedAt:Le()}),c.id}}if(s.reference){const a=Ve(ke(G,"userTransactions"),Oe("userId","==",t),Oe("reference","==",s.reference)),l=await Be(a);if(!l.empty){const c=l.docs[0];return await wn(Ce(G,"userTransactions",c.id),{...s,uploadedAt:Le()}),c.id}}}catch(o){console.warn("      saveUserTransaction  :",o)}return(await mi(ke(G,"userTransactions"),{...s,userId:t,createdAt:s.createdAt?s.createdAt instanceof Date?s.createdAt:new Date(String(s.createdAt)):Le(),uploadedAt:Le()})).id}catch(s){throw console.error("Error saving user transaction:",s),s}},async removeUserTransaction(t,e){try{console.log("     userTransactions:",{userId:t,transactionId:e});try{const o=Ce(G,"userTransactions",e),a=await Qt(o);if(a.exists()){const l=a.data();if([l==null?void 0:l.userId,l==null?void 0:l.merchantUserId,l==null?void 0:l.createdBy].map(u=>String(u||"")).includes(String(t))){console.log("    userTransactions  ( ):",e),await Xn(o),console.log("     userTransactions");try{this.removeLocalReceiptById(t,e)}catch{}return}else console.log("           ")}}catch(o){console.warn("     userTransactions   :",o)}const n=Ve(ke(G,"userTransactions"),Oe("userId","==",t)),r=await Be(n);console.log(`    ${r.docs.length}  `);const s=r.docs.filter(o=>{var h,f;const a=o.data(),l=o.id,u=[a.id===e,a.transactionId===e,l===e,a.originalTransactionId===e,((h=a.receipt)==null?void 0:h.transactionId)===e,((f=a.receipt)==null?void 0:f.id)===e].some(m=>m===!0);return u&&console.log("     :",{docId:l,dataId:a.id,transactionId:a.transactionId,originalTransactionId:a.originalTransactionId,searchingFor:e}),u}),i=[Ve(ke(G,"userTransactions"),Oe("merchantUserId","==",t)),Ve(ke(G,"userTransactions"),Oe("createdBy","==",t))];for(const o of i)try{const l=(await Be(o)).docs.filter(c=>{var f,m;const u=c.data(),h=c.id;return u.id===e||u.transactionId===e||h===e||u.originalTransactionId===e||((f=u.receipt)==null?void 0:f.transactionId)===e||((m=u.receipt)==null?void 0:m.id)===e});l.length&&(console.log(`   ${l.length}       `),s.push(...l))}catch{}if(s.length>0){console.log(`   ${s.length}    `);const o=s.map(async a=>{try{console.log("   :",a.id),await Xn(a.ref)}catch(l){console.warn("     userTransactions ():",{id:a.id,error:l})}});await Promise.allSettled(o);try{this.removeLocalReceiptById(t,e)}catch{}console.log("        userTransactions:",e);try{const a=Ce(G,"transactions",e);if((await Qt(a)).exists())console.log("     transactions   "),await Xn(a);else{const c=Ve(ke(G,"transactions"),Oe("transactionId","==",e)),u=await Be(c);u.empty||(console.log(`   ${u.size}   transactions  transactionId `),await Promise.all(u.docs.map(m=>Xn(m.ref))));const h=Ve(ke(G,"transactions"),Oe("originalTransactionId","==",e)),f=await Be(h);f.empty||(console.log(`   ${f.size}   transactions  originalTransactionId `),await Promise.all(f.docs.map(m=>Xn(m.ref))))}}catch(a){console.warn("      transactions   :",a)}return}console.log("       userTransactions (   ):",e)}catch(n){console.error("      userTransactions ():",n);return}}},i0={async getToday(t){const e=Ce(G,"dailyStats",t,"today","data"),n=await Qt(e);return n.exists()?n.data():{}},async setToday(t,e){const n=Ce(G,"dailyStats",t,"today","data");await on(n,{...Ol(e),updatedAt:new Date},{merge:!0})},async saveToHistory(t,e,n){const r=Ce(G,"dailyStats",t,"history",e);await on(r,Ol(n),{merge:!0})},async archiveTodayToHistory(t,e){const n=await this.getToday(t);await this.saveToHistory(t,e,n||{})}},TY={async create(t,e){const n={...e,userId:t,status:"active",createdAt:Le()};return(await mi(ke(G,"installments"),n)).id},async getByUser(t){try{const e=Ve(ke(G,"installments"),Oe("userId","==",t));return(await Be(e)).docs.map(r=>({id:r.id,...r.data()}))}catch(e){return console.error("installments fetch error",e),[]}},async markMonthPaid(t,e){const n=e.every(r=>r.paid);return await wn(Ce(G,"installments",t),{paidMonths:e,status:n?"completed":"active"}),!0},async remove(t){return await Xn(Ce(G,"installments",t)),!0}},sc=Object.freeze(Object.defineProperty({__proto__:null,InstallmentsService:TY,auditLogService:IY,dailyReportsArchiveService:oM,dailyStatsService:i0,merchantWalletService:zo,profileService:sp,profileServiceExtra:sM,recordAutoTransaction:_Y,referralService:s0,sanitizeFirestoreData:Ol,systemSettingsService:iM,telegramNotifier:EY,transactionService:fT,userDataService:Xr},Symbol.toStringTag,{value:"Module"}));var Ga=(t=>(t.MONTHLY="monthly",t.QUARTERLY="quarterly",t.YEARLY="yearly",t.LIFETIME="lifetime",t.ZERO="zero",t.TAHWEELA="tahweela",t.FIVE_MINUTES="five_minutes",t.BRANCH="branch",t))(Ga||{});const pl=t=>{if(!t)return null;if(t instanceof Date)return isNaN(t.getTime())?null:t;if(t.toDate&&typeof t.toDate=="function")return t.toDate();if(t.seconds!==void 0&&typeof t.seconds=="number")return new Date(t.seconds*1e3);const e=new Date(t);return isNaN(e.getTime())?null:e},SY=(t,e=new Date)=>{const n=pl(e)||new Date;switch(t){case"monthly":{const r=new Date(n);return r.setDate(r.getDate()+30),r}case"five_minutes":{const r=new Date(n);return r.setMinutes(r.getMinutes()+5),r}case"tahweela":{const r=new Date(n);return r.setDate(r.getDate()+30),r}case"quarterly":{const r=new Date(n);return r.setDate(r.getDate()+90),r}case"yearly":{const r=new Date(n);return r.setDate(r.getDate()+365),r}case"lifetime":return null;case"zero":return null;default:return null}},gR=t=>{if(!t||!t.isActive)return!1;if(t.planType==="lifetime")return!0;if(!t.endDate){const r=new Date,s=pl(t.activatedAt);return s&&r.getTime()-s.getTime()<4*60*60*1e3,!0}const e=new Date,n=pl(t.endDate);if(!n){const r=pl(t.activatedAt);return r&&e.getTime()-r.getTime()<4*60*60*1e3,!0}return e<=n},bY=t=>{if(!t||!t.isActive)return null;if(t.planType==="lifetime")return-1;if(!t.endDate)return null;const e=new Date,n=pl(t.endDate);if(!n)return null;const r=n.getTime()-e.getTime(),s=Math.ceil(r/(1e3*60*60*24));return s>0?s:0},yZ=async(t,e,n,r)=>{try{const s=new Date,i=SY(e,s),o={planType:e,startDate:s,endDate:i,isActive:!0,activatedBy:n,activatedAt:s};console.log(" Activating subscription for user:",{userId:t,planType:e,adminId:n,subscriptionData:o});const a=Ce(G,"users",t);await wn(a,{subscription:o,isActive:!0,approved:!0,isOnFreeTrial:!1,freeTrialStartDate:null,freeTrialEndDate:null,updatedAt:new Date});try{const l=await Qt(a);if(l.exists()){const c=l.data();if(c.ownerId){const u=c.ownerId;try{const h=Ce(G,"users",u,"branches",t);await wn(h,{isActive:!0,updatedAt:new Date})}catch(h){console.warn("Could not update branch reference in parent subcollection",h)}}}}catch(l){console.warn("Error syncing branch status to parent:",l)}if(console.log(" Subscription data updated in Firestore"),typeof window<"u"){const l=new CustomEvent("subscriptionActivated",{detail:{userId:t,planType:e,timestamp:new Date().toISOString()}});window.dispatchEvent(l),console.log(" Subscription activation event dispatched:",{userId:t,planType:e});const c=new CustomEvent("userSubscriptionUpdated",{detail:{userId:t,planType:e,isActive:!0,timestamp:new Date().toISOString()}});window.dispatchEvent(c),console.log(" Global subscription update event dispatched")}console.log(`    ${e}  ${t}`)}catch(s){throw console.error("    :",s),new Error("   ")}},vZ=async t=>{try{const e=sT(G),n=Ce(G,"users",t);e.update(n,{"subscription.isActive":!1,isActive:!1,"branchPackage.status":"canceled","branchPackage.canceledAt":new Date,isOnFreeTrial:!1,freeTrialStartDate:null,freeTrialEndDate:null,updatedAt:new Date});const r=Ve(ke(G,"users"),Oe("ownerId","==",t)),s=await Be(r);s.forEach(i=>{e.update(i.ref,{isActive:!1,"subscription.isActive":!1,updatedAt:new Date})}),await e.commit(),console.log(`      ${t}   (${s.size})`)}catch(e){throw console.error("     :",e),new Error("    ")}},AY=async t=>{try{const e=sT(G),n=Ce(G,"users",t);e.update(n,{"branchPackage.status":"expired","branchPackage.expiredAt":new Date,updatedAt:new Date});const r=Ve(ke(G,"users"),Oe("ownerId","==",t));(await Be(r)).forEach(i=>{e.update(i.ref,{isActive:!1,updatedAt:new Date})}),await e.commit(),console.log(` Branch package expired for user ${t}`)}catch(e){console.error("Failed to expire branch package:",e)}},xY=async(t,e)=>{if((e==null?void 0:e.status)!=="active"||!e.endDate)return;const n=pl(e.endDate);n&&new Date>n&&(console.log(`Branch package expired for user ${t}. Deactivating...`),await AY(t))},RY=async t=>{try{const e=Ce(G,"users",t),n=await Qt(e);return n.exists()&&n.data().subscription||null}catch(e){return console.error("      :",e),null}},_Z=t=>{switch(t){case"monthly":return"";case"quarterly":return" ";case"yearly":return"";case"lifetime":return" ";case"zero":return"";case"tahweela":return"";case"five_minutes":return"5 ";case"branch":return" ";default:return" "}},wZ=t=>{if(!t)return"text-gray-500";if(!t.isActive)return"text-red-500";if(t.planType==="lifetime")return"text-green-600";const e=bY(t);return e===null||e<=0?"text-red-500":e<=7?"text-yellow-500":"text-green-500"},EZ=t=>{const e=pl(t);return e?e.toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"}):" "};/*! Capacitor: https://capacitorjs.com/ - MIT License */var Mu;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Mu||(Mu={}));class Hv extends Error{constructor(e,n,r){super(e),this.message=e,this.code=n,this.data=r}}const PY=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},CY=t=>{const e=t.CapacitorCustomPlatform||null,n=t.Capacitor||{},r=n.Plugins=n.Plugins||{},s=()=>e!==null?e.name:PY(t),i=()=>s()!=="web",o=h=>{const f=c.get(h);return!!(f!=null&&f.platforms.has(s())||a(h))},a=h=>{var f;return(f=n.PluginHeaders)===null||f===void 0?void 0:f.find(m=>m.name===h)},l=h=>t.console.error(h),c=new Map,u=(h,f={})=>{const m=c.get(h);if(m)return console.warn(`Capacitor plugin "${h}" already registered. Cannot register plugins twice.`),m.proxy;const E=s(),p=a(h);let I;const g=async()=>(!I&&E in f?I=typeof f[E]=="function"?I=await f[E]():I=f[E]:e!==null&&!I&&"web"in f&&(I=typeof f.web=="function"?I=await f.web():I=f.web),I),_=(T,R)=>{var C,D;if(p){const O=p==null?void 0:p.methods.find(k=>R===k.name);if(O)return O.rtype==="promise"?k=>n.nativePromise(h,R.toString(),k):(k,B)=>n.nativeCallback(h,R.toString(),k,B);if(T)return(C=T[R])===null||C===void 0?void 0:C.bind(T)}else{if(T)return(D=T[R])===null||D===void 0?void 0:D.bind(T);throw new Hv(`"${h}" plugin is not implemented on ${E}`,Mu.Unimplemented)}},w=T=>{let R;const C=(...D)=>{const O=g().then(k=>{const B=_(k,T);if(B){const ce=B(...D);return R=ce==null?void 0:ce.remove,ce}else throw new Hv(`"${h}.${T}()" is not implemented on ${E}`,Mu.Unimplemented)});return T==="addListener"&&(O.remove=async()=>R()),O};return C.toString=()=>`${T.toString()}() { [capacitor code] }`,Object.defineProperty(C,"name",{value:T,writable:!1,configurable:!1}),C},A=w("addListener"),P=w("removeListener"),L=(T,R)=>{const C=A({eventName:T},R),D=async()=>{const k=await C;P({eventName:T,callbackId:k},R)},O=new Promise(k=>C.then(()=>k({remove:D})));return O.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await D()},O},x=new Proxy({},{get(T,R){switch(R){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return p?L:A;case"removeListener":return P;default:return w(R)}}});return r[h]=x,c.set(h,{name:h,proxy:x,platforms:new Set([...Object.keys(f),...p?[E]:[]])}),x};return n.convertFileSrc||(n.convertFileSrc=h=>h),n.getPlatform=s,n.handleError=l,n.isNativePlatform=i,n.isPluginAvailable=o,n.registerPlugin=u,n.Exception=Hv,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},kY=t=>t.Capacitor=CY(t),Ee=kY(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),ld=Ee.registerPlugin;class aM{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(n);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,n);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,r){const s=this.listeners[e];if(!s){if(r){let i=this.retainedEventArguments[e];i||(i=[]),i.push(n),this.retainedEventArguments[e]=i}return}s.forEach(i=>i(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(e="not implemented"){return new Ee.Exception(e,Mu.Unimplemented)}unavailable(e="not available"){return new Ee.Exception(e,Mu.Unavailable)}async removeListener(e,n){const r=this.listeners[e];if(!r)return;const s=r.indexOf(n);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(r=>{this.notifyListeners(e,r)}))}}const yR=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),vR=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class NY extends aM{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=vR(s).trim(),i=vR(i).trim(),n[s]=i}),n}async setCookie(e){try{const n=yR(e.key),r=yR(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${s}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}ld("CapacitorCookies",{web:()=>new NY});const DY=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>n(s),r.readAsDataURL(t)}),OY=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(s=>s.toLocaleLowerCase()).reduce((s,i,o)=>(s[i]=t[e[o]],s),{})},LY=(t,e=!0)=>t?Object.entries(t).reduce((r,s)=>{const[i,o]=s;let a,l;return Array.isArray(o)?(l="",o.forEach(c=>{a=e?encodeURIComponent(c):c,l+=`${i}=${a}&`}),l.slice(0,-1)):(a=e?encodeURIComponent(o):o,l=`${i}=${a}`),`${r}&${l}`},"").substr(1):null,MY=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),s=OY(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(s.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,a]of Object.entries(t.data||{}))i.set(o,a);n.body=i.toString()}else if(s.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((a,l)=>{i.append(l,a)});else for(const a of Object.keys(t.data))i.append(a,t.data[a]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(s.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class VY extends aM{async request(e){const n=MY(e,e.webFetchExtra),r=LY(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,i=await fetch(s,n),o=i.headers.get("content-type")||"";let{responseType:a="text"}=i.ok?e:{};o.includes("application/json")&&(a="json");let l,c;switch(a){case"arraybuffer":case"blob":c=await i.blob(),l=await DY(c);break;case"json":l=await i.json();break;case"document":case"text":default:l=await i.text()}const u={};return i.headers.forEach((h,f)=>{u[f]=h}),{data:l,headers:u,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}ld("CapacitorHttp",{web:()=>new VY});const Qa=ld("Preferences",{web:()=>ne(()=>import("./web-GQFSOvNO.js"),[],import.meta.url).then(t=>new t.PreferencesWeb)}),Kv=Object.freeze(Object.defineProperty({__proto__:null,Preferences:Qa},Symbol.toStringTag,{value:"Module"})),FY={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"0.0.0",VITE_DEV_MODE:"true",VITE_ENABLE_OFFLINE_PERSISTENCE:"false",VITE_FIREBASE_API_KEY:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),VITE_FIREBASE_APP_ID:"1:483702062341:web:b1ff06ad175cb7ae428b6c",VITE_FIREBASE_AUTH_DOMAIN:"voda-c6abd.firebaseapp.com",VITE_FIREBASE_AUTH_EMULATOR_URL:"http://localhost:9099",VITE_FIREBASE_FIRESTORE_EMULATOR_HOST:"localhost:8080",VITE_FIREBASE_FUNCTIONS_EMULATOR_HOST:"localhost:5001",VITE_FIREBASE_MEASUREMENT_ID:"G-CV6QGH7G7P",VITE_FIREBASE_MESSAGING_SENDER_ID:"483702062341",VITE_FIREBASE_PROJECT_ID:"voda-c6abd",VITE_FIREBASE_STORAGE_BUCKET:"voda-c6abd.appspot.com",VITE_FORCE_HASH_ROUTER:"true",VITE_SHOP_ID:"demo-shop-001",VITE_SHOP_NAME:"   ",VITE_SHOW_ENV_BANNER:"true",VITE_USE_EMULATORS:"false",VITE_USE_FIREBASE_EMULATOR:"false"},lM=S.createContext(void 0);function Ws(){const t=S.useContext(lM);if(t===void 0)throw new Error("useFirebaseAuth must be used within a FirebaseAuthProvider");return t}const UY=({children:t})=>{const[e,n]=S.useState(null),[r,s]=S.useState(null),[i,o]=S.useState(null),[a,l]=S.useState(!1),[c,u]=S.useState(!0),h=S.useRef(null);S.useEffect(()=>{const T=()=>{console.log(" Received userSubscriptionUpdated event - Refreshing profile..."),e&&(f(e.uid,!0),w())};return window.addEventListener("userSubscriptionUpdated",T),()=>{window.removeEventListener("userSubscriptionUpdated",T)}},[e]);const f=async(T,R=!1)=>{var C,D,O,k,B,ce,he,Se;try{const $=Ce(G,"profiles",T),q=`profile_cache_v2_${T}`,X=Date.now(),we=1e3*60*60*24;if(!R)try{const re=localStorage.getItem(q);if(re){const{data:ve,timestamp:j}=JSON.parse(re);if(X-j<we&&(s(ve),u(!1),console.log(" Profile loaded from cache (valid)"),!(X-j>1e3*60*60)))return}}catch(re){console.warn("Cache parse error:",re)}const Ie=await Qt($);if(Ie.exists()){const re=Ie.data(),ve={userId:Ie.id,shopId:re.shopId,role:re.role,fullName:re.fullName,phone:re.phone,sim1Number:re.sim1Number||null,sim2Number:re.sim2Number||null,shopName:re.shopName||null,approved:re.approved,avatarId:re.avatarId,bridgeLink:re.bridgeLink||null,bridgeDeviceId:re.bridgeDeviceId||null,showWithdrawNote:re.showWithdrawNote!==void 0?!!re.showWithdrawNote:!0,isReceiptNoteEnabled:re.isReceiptNoteEnabled!==void 0?!!re.isReceiptNoteEnabled:!0,smsReadingEnabled:re.smsReadingEnabled!==void 0?!!re.smsReadingEnabled:!1,smsAutoRegisterEnabled:re.smsAutoRegisterEnabled!==void 0?!!re.smsAutoRegisterEnabled:!1,createdAt:((D=(C=re.createdAt)==null?void 0:C.toDate)==null?void 0:D.call(C))||new Date,updatedAt:((k=(O=re.updatedAt)==null?void 0:O.toDate)==null?void 0:k.call(O))||new Date,trialStarted:re.trialStarted||!1,trialStartDate:(ce=(B=re.trialStartDate)==null?void 0:B.toDate)==null?void 0:ce.call(B),trialEndDate:(Se=(he=re.trialEndDate)==null?void 0:he.toDate)==null?void 0:Se.call(he),trialExpired:re.trialExpired||!1,referralCode:re.referralCode||null,referredBy:re.referredBy||null};s(ve);try{localStorage.setItem(q,JSON.stringify({data:ve,timestamp:X})),ve.shopId&&localStorage.setItem("shopId",ve.shopId)}catch{}}else try{const re=await sM.getByUserId(T);if(re){const ve={userId:T,shopId:re.shopId,role:re.role||"user",fullName:re.fullName||null,phone:re.phone||null,shopName:re.shopName||null,approved:re.approved??!1,avatarId:re.avatarId||void 0,bridgeLink:re.bridgeLink||null,bridgeDeviceId:re.bridgeDeviceId||null,createdAt:Le(),updatedAt:Le()};await on(Ce(G,"profiles",T),ve,{merge:!0}),s({...re,userId:T})}else await E(T)}catch(re){console.error("Profile migration error:",re)}u(!1)}catch($){console.error("Error fetching profile:",$),u(!1)}},m=async T=>{try{const R=Ce(G,"users",T.uid);(await Qt(R)).exists()?(await wn(R,{lastLogin:Le(),updatedAt:Le()}),console.log(" ensureAdminUserDoc: Updated lastLogin for",T.uid)):(await on(R,{email:T.email||"",displayName:T.displayName||" ",phone:null,shopName:null,isActive:!1,createdAt:Le(),updatedAt:Le(),lastLogin:Le()},{merge:!0}),console.log(" ensureAdminUserDoc: Created users doc for",T.uid))}catch(R){console.error(" ensureAdminUserDoc error:",R)}},E=async(T,R,C,D,O)=>{var k,B;try{console.log("Creating default profile for user:",T);const ce=s0.generateReferralCode(T);let he=null;const Se={userId:T,shopId:"default-shop",role:"user",fullName:R||" ",phone:C||null,shopName:D||null,approved:!1,referralCode:ce,referredBy:O||null,bridgeLink:null,bridgeDeviceId:null,showWithdrawNote:!0,isReceiptNoteEnabled:!0,smsReadingEnabled:!1,smsAutoRegisterEnabled:!1,createdAt:new Date,updatedAt:new Date};s(Se),console.log("Created temporary profile:",Se);try{const{doc:$,setDoc:q,serverTimestamp:X}=await ne(async()=>{const{doc:ve,setDoc:j,serverTimestamp:Ge}=await Promise.resolve().then(()=>Mn);return{doc:ve,setDoc:j,serverTimestamp:Ge}},void 0,import.meta.url),{db:we}=await ne(async()=>{const{db:ve}=await Promise.resolve().then(()=>qt);return{db:ve}},void 0,import.meta.url),Ie={email:((k=Ot.currentUser)==null?void 0:k.email)||"",displayName:R||" ",phone:C||null,shopName:D||null,isActive:!1,referralCode:ce,referredBy:O||null,createdAt:X(),lastLogin:null,updatedAt:X()};if(console.log("Attempting to add user to admin collection with data:",Ie),await q($(we,"users",T),Ie,{merge:!0}),console.log(" User successfully added to admin collection:",Ie),O)try{const{query:ve,collection:j,where:Ge,limit:Fe,getDocs:Pn}=await ne(async()=>{const{query:Cn,collection:kt,where:ft,limit:at,getDocs:cr}=await Promise.resolve().then(()=>Mn);return{query:Cn,collection:kt,where:ft,limit:at,getDocs:cr}},void 0,import.meta.url),{db:zn}=await ne(async()=>{const{db:Cn}=await Promise.resolve().then(()=>qt);return{db:Cn}},void 0,import.meta.url),En=ve(j(zn,"users"),Ge("referralCode","==",O),Fe(1)),In=await Pn(En);In.empty?console.log(" Referral code not found in users collection:",O):(he=In.docs[0].id,await s0.create({referrerId:he,referredUserId:T,referredUserEmail:((B=Ot.currentUser)==null?void 0:B.email)||"",referralCode:O,status:"completed"}),console.log(" Referral record created successfully for referrer:",he))}catch(ve){console.error(" Error creating referral record:",ve)}const re=await Qt($(we,"users",T));re.exists()?console.log(" User document verified in Firestore:",re.data()):console.log(" User document not found after creation")}catch($){console.error(" Error adding user to admin collection:",$)}try{const{addDoc:$,collection:q,serverTimestamp:X}=await ne(async()=>{const{addDoc:j,collection:Ge,serverTimestamp:Fe}=await Promise.resolve().then(()=>Mn);return{addDoc:j,collection:Ge,serverTimestamp:Fe}},void 0,import.meta.url),{db:we}=await ne(async()=>{const{db:j}=await Promise.resolve().then(()=>qt);return{db:j}},void 0,import.meta.url),re=(await $(q(we,"shops"),{name:D||" ",ownerId:T,createdAt:X(),updatedAt:X(),isActive:!0})).id;await sp.create({userId:T,shopId:re,role:"user",fullName:" ",phone:null});try{await sp.update(T,{referralCode:ce,referredBy:he||null,showWithdrawNote:!0,isReceiptNoteEnabled:!0})}catch(j){console.warn(" Failed to update profile with referral fields:",j)}const ve=await sp.getById(T);ve&&(s(ve),console.log("Updated with Firebase profile:",ve))}catch($){console.error("Error creating profile:",$),console.log("Using local profile - Firebase unavailable")}}catch(ce){console.error("Error creating default profile:",ce)}};S.useEffect(()=>{console.log(" Setting up auth state listener"),u(!0);const T=setTimeout(()=>{console.warn(" Global auth timeout reached, forcing loading to false"),u(!1)},2e4);localStorage.getItem("demoProfile")&&(console.log(" Cleaning up demo profile from localStorage"),localStorage.removeItem("demoProfile"));const R=localStorage.getItem("demoUser"),C=localStorage.getItem("demoProfile");if(R&&C){console.log(" Found demo user in localStorage");try{const O=JSON.parse(R),k=JSON.parse(C);n(O),s(k),clearTimeout(T),u(!1);return}catch(O){console.error("Error parsing demo user data:",O),localStorage.removeItem("demoUser"),localStorage.removeItem("demoProfile")}}const D=vW(Ot,async O=>{if(console.log(" Auth state changed:",{uid:O==null?void 0:O.uid,email:O==null?void 0:O.email,emailVerified:O==null?void 0:O.emailVerified,timestamp:new Date().toISOString()}),n(O),O){console.log(" User authenticated, starting profile hydration for:",O.uid);try{await Qa.set({key:"current_user_id",value:O.uid}),console.log(" Synced current_user_id to Native:",O.uid)}catch(k){console.error("Failed to sync user ID to native:",k)}try{if(!localStorage.getItem("theme")){localStorage.setItem("theme","light");try{document.documentElement.classList.remove("dark"),document.documentElement.setAttribute("data-theme","light")}catch{}}}catch{}f(O.uid),w(),m(O)}else{console.log(" User not authenticated, clearing profile"),s(null),o(null),l(!1),u(!1);try{await Qa.remove({key:"current_user_id"}),await Qa.remove({key:"selected_wallet_id"})}catch{}}clearTimeout(T)});return()=>{clearTimeout(T),D()}},[]),S.useEffect(()=>{const T=async()=>{try{await A(),await w(!0)}catch{}};try{window.addEventListener("app:softRefresh",T)}catch{}return()=>{try{window.removeEventListener("app:softRefresh",T)}catch{}}},[e==null?void 0:e.uid]),S.useEffect(()=>{const T=()=>{try{w(!0)}catch{}};try{window.addEventListener("userSubscriptionUpdated",T),window.addEventListener("subscriptionActivated",T)}catch{}return()=>{try{window.removeEventListener("userSubscriptionUpdated",T),window.removeEventListener("subscriptionActivated",T)}catch{}}},[e==null?void 0:e.uid]),S.useEffect(()=>{e!=null&&e.uid&&Xr.syncDeletedTransactionsLocal(e.uid)},[e==null?void 0:e.uid]);const p=async(T,R,C,D,O,k)=>{try{const B=(T||"").trim().toLowerCase(),ce=(R||"").trim();console.log(" Attempting to sign up user:",B);const he=await TA(Ot,B,ce);console.log(" Sign up successful:",he.user.uid),await E(he.user.uid,C,D,O,k),await m(he.user);try{await f(he.user.uid),await w()}catch{}try{if(!localStorage.getItem("theme")){localStorage.setItem("theme","light");try{document.documentElement.classList.remove("dark"),document.documentElement.setAttribute("data-theme","light")}catch{}}}catch{}return{error:null}}catch(B){console.error(" Sign up error:",B);let ce="    ";return B.code==="auth/email-already-in-use"?ce="    ":B.code==="auth/weak-password"?ce="   ":B.code==="auth/invalid-email"&&(ce="   "),{error:{...B,message:ce}}}},I=async(T,R)=>{var O;const C=(T||"").trim().toLowerCase(),D=(R||"").trim();try{const k=X=>X.replace(/[\u200B\u200C\u200D\u200E\u200F\u061C]/g,""),B=X=>X.replace(/[-]/g,we=>String("0123456789"["".indexOf(we)])).replace(/[-]/g,we=>String("0123456789"["".indexOf(we)])),ce=X=>X.replace(/[0-9]/g,we=>""[Number(we)]),he=X=>B(k(X));if(console.log(" Attempting to sign in user:",C),C==="test@example.com"&&D==="123456"){console.log(" Demo user login detected");const X={uid:"demo-user-123",email:"test@example.com",displayName:" ",emailVerified:!0},we={userId:"demo-user-123",shopId:"demo-shop",role:"user",fullName:" ",phone:"01000000000",approved:!0,createdAt:new Date,updatedAt:new Date};return localStorage.setItem("demoUser",JSON.stringify(X)),localStorage.setItem("demoProfile",JSON.stringify(we)),n(X),s(we),u(!1),console.log(" Demo user signed in successfully"),{error:null}}let Se;const $=[he(D),k(D),ce(k(D))];let q=null;for(const X of $)try{X!==D&&console.log(" Trying password variant"),Se=await dW(Ot,C,X);break}catch(we){if(q=we,(we==null?void 0:we.code)!=="auth/wrong-password"&&(we==null?void 0:we.code)!=="auth/invalid-credential")throw we}if(!Se)throw q||new Error("auth/invalid-credential");console.log(" Sign in successful:",Se.user.uid);try{if((await Qt(Ce(G,"deletedUsers",Se.user.uid))).exists())return console.log(" User is deleted, signing out"),await SA(Ot),{error:{code:"auth/user-deleted",message:"      .    ."}}}catch(X){console.error("Error checking deleted users:",X)}await m(Se.user);try{await f(Se.user.uid),await w()}catch{}return{error:null}}catch(k){if(console.error(" Sign in error:",k),C==="test@example.com"&&k.code==="auth/user-not-found"){console.log(" Creating test user...");try{const he=await TA(Ot,C,D);return console.log(" Test user created:",he.user.uid),await E(he.user.uid," ","01000000000"," "),{error:null}}catch(he){return console.error(" Error creating test user:",he),{error:he}}}let B="    ",ce=k==null?void 0:k.code;if(ce==="auth/invalid-credential")try{const he=await fW(Ot,((O=k==null?void 0:k.customData)==null?void 0:O.email)||"");Array.isArray(he)&&he.length===0?(ce="auth/user-not-found",B="     "):(ce="auth/wrong-password",B="   ")}catch{B="      "}else ce==="auth/invalid-email"?B="    ":ce==="auth/user-not-found"?B="     ":ce==="auth/wrong-password"?B="   ":ce==="auth/too-many-requests"&&(B="      ");return{error:{...k,code:ce,message:B}}}},g=async()=>{try{const T=e==null?void 0:e.uid;localStorage.getItem("demoUser")?(console.log(" Signing out demo user"),localStorage.removeItem("demoUser"),localStorage.removeItem("demoProfile"),n(null),s(null),u(!1)):await SA(Ot),T&&(localStorage.removeItem(`sub_cache_${T}`),localStorage.removeItem(`profile_cache_v2_${T}`),console.log(" Cleared user caches for:",T));try{await Qa.remove({key:"selected_wallet_id"}),await Qa.remove({key:"current_user_id"}),console.log(" Cleared selected_wallet_id and current_user_id from Capacitor Preferences")}catch(O){console.error(" Failed to clear Preferences:",O)}const D=(()=>{try{const O=typeof window<"u"?window:null,k=!!(O&&O.electronAPI)||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"),B=typeof window<"u"&&window.location.protocol==="file:",ce=typeof window<"u"&&typeof window.location.hash=="string"&&window.location.hash.startsWith("#/");return k||B||ce||typeof import.meta<"u"&&FY&&!0}catch{return!1}})()?"#/user/login":"/user/login";try{window.location.replace(D)}catch{window.location.href=D}}catch(T){console.error("Sign out error:",T)}},_=async T=>{try{return await uW(Ot,T),{error:null}}catch(R){console.error("Reset password error:",R);let C="        ";return R.code==="auth/user-not-found"?C="     ":R.code==="auth/invalid-email"&&(C="   "),{error:{...R,message:C}}}},w=async(T=!1)=>{var O,k,B,ce,he,Se,$,q,X,we,Ie,re,ve,j,Ge,Fe,Pn,zn,En,In,Cn;if(!e){console.log("No user found for subscription check"),o(null),l(!1);return}h.current&&(h.current(),h.current=null),console.log("Checking subscription status for user:",e.uid,{force:T});const R=`sub_cache_${e.uid}`,C=Date.now(),D=1e3*60*60*24;if(!T)try{const kt=localStorage.getItem(R);if(kt){const{data:ft,timestamp:at}=JSON.parse(kt);if(C-at<D){const cr={...ft,subscription:ft.subscription?{...ft.subscription,activatedAt:ft.subscription.activatedAt?{toDate:()=>new Date(ft.subscription.activatedAt)}:null,endDate:ft.subscription.endDate?{toDate:()=>new Date(ft.subscription.endDate)}:null}:null,branchPackage:ft.branchPackage?{...ft.branchPackage,activatedAt:ft.branchPackage.activatedAt?{toDate:()=>new Date(ft.branchPackage.activatedAt)}:null,endDate:ft.branchPackage.endDate?{toDate:()=>new Date(ft.branchPackage.endDate)}:null}:null,freeTrialStartDate:ft.freeTrialStartDate?{toDate:()=>new Date(ft.freeTrialStartDate)}:null,freeTrialEndDate:ft.freeTrialEndDate?{toDate:()=>new Date(ft.freeTrialEndDate)}:null};o(cr);const _r=((O=ft==null?void 0:ft.branchPackage)==null?void 0:O.status)==="active";let Wn=!1;if(_r)Wn=!0;else{const mt=cr.subscription;Wn=gR(mt)}l(Wn),console.log(" Subscription loaded from cache (Client-side validity check applied)");return}}}catch(kt){console.warn("Subscription Cache parse error:",kt)}try{const kt=Ce(G,"users",e.uid),ft=await Qt(kt);if(ft.exists()){const at=ft.data();o(at);try{const mt={...at,subscription:at.subscription?{...at.subscription,activatedAt:((ce=(B=(k=at.subscription.activatedAt)==null?void 0:k.toDate)==null?void 0:B.call(k))==null?void 0:ce.toISOString())||at.subscription.activatedAt,endDate:(($=(Se=(he=at.subscription.endDate)==null?void 0:he.toDate)==null?void 0:Se.call(he))==null?void 0:$.toISOString())||at.subscription.endDate}:null,branchPackage:at.branchPackage?{...at.branchPackage,activatedAt:((we=(X=(q=at.branchPackage.activatedAt)==null?void 0:q.toDate)==null?void 0:X.call(q))==null?void 0:we.toISOString())||at.branchPackage.activatedAt,endDate:((ve=(re=(Ie=at.branchPackage.endDate)==null?void 0:Ie.toDate)==null?void 0:re.call(Ie))==null?void 0:ve.toISOString())||at.branchPackage.endDate}:null,freeTrialStartDate:((Fe=(Ge=(j=at.freeTrialStartDate)==null?void 0:j.toDate)==null?void 0:Ge.call(j))==null?void 0:Fe.toISOString())||at.freeTrialStartDate,freeTrialEndDate:((En=(zn=(Pn=at.freeTrialEndDate)==null?void 0:Pn.toDate)==null?void 0:zn.call(Pn))==null?void 0:En.toISOString())||at.freeTrialEndDate};localStorage.setItem(R,JSON.stringify({data:mt,timestamp:C}))}catch{}console.log(" Subscription Data Details (Fetched):",{userId:e.uid,isActive:(In=at.subscription)==null?void 0:In.isActive});const cr=((Cn=at==null?void 0:at.branchPackage)==null?void 0:Cn.status)==="active";let _r=!1;if(cr){const mt=at.branchPackage;let Zt=!1;if(mt.endDate){const wr=mt.endDate.toDate?mt.endDate.toDate():new Date(mt.endDate);!isNaN(wr.getTime())&&new Date>wr&&(Zt=!0,xY(e.uid,mt).catch(console.error))}_r=!Zt}const Wn=_r||gR(at.subscription);l(Wn)}}catch(kt){console.error("Error checking subscription status:",kt)}},A=async()=>{if(e)try{console.log("Refreshing profile for user:",e.uid),await f(e.uid,!0),await w(!0)}catch(T){console.error("Error refreshing profile:",T)}},x={user:e,profile:r,userSubscription:i,isSubscriptionActive:a,loading:c,signUp:p,signIn:I,signOut:g,resetPassword:_,updateUserProfile:async T=>{if(e)try{const R={updatedAt:Le()};if(T.fullName!==void 0&&(R.fullName=T.fullName),T.phone!==void 0&&(R.phone=T.phone),T.sim1Number!==void 0){const C=(T.sim1Number||"").trim();R.sim1Number=C.length?C:null}if(T.sim2Number!==void 0){const C=(T.sim2Number||"").trim();R.sim2Number=C.length?C:null}if(T.bridgeLink!==void 0){const C=(T.bridgeLink||"").trim();R.bridgeLink=C.length?C:null}if(T.bridgeDeviceId!==void 0){const C=(T.bridgeDeviceId||"").trim();R.bridgeDeviceId=C.length?C:null}T.showWithdrawNote!==void 0&&(R.showWithdrawNote=!!T.showWithdrawNote),T.isReceiptNoteEnabled!==void 0&&(R.isReceiptNoteEnabled=!!T.isReceiptNoteEnabled),T.smsReadingEnabled!==void 0&&(R.smsReadingEnabled=!!T.smsReadingEnabled),T.smsAutoRegisterEnabled!==void 0&&(R.smsAutoRegisterEnabled=!!T.smsAutoRegisterEnabled),await wn(Ce(G,"profiles",e.uid),R),await f(e.uid,!0)}catch(R){console.error("Error updating user profile:",R)}},updateAvatarId:async T=>{if(e)try{await wn(Ce(G,"profiles",e.uid),{avatarId:T,updatedAt:Le()}),await f(e.uid)}catch(R){console.error("Error updating avatarId:",R)}},refreshProfile:A,checkSubscriptionStatus:w};return v.jsx(lM.Provider,{value:x,children:t})};function jY(t){const e=S.useRef({value:t,previous:t});return S.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var Dy="Checkbox",[$Y]=$u(Dy),[BY,mT]=$Y(Dy);function zY(t){const{__scopeCheckbox:e,checked:n,children:r,defaultChecked:s,disabled:i,form:o,name:a,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:h}=t,[f,m]=uE({prop:n,defaultProp:s??!1,onChange:l,caller:Dy}),[E,p]=S.useState(null),[I,g]=S.useState(null),_=S.useRef(!1),w=E?!!o||!!E.closest("form"):!0,A={checked:f,disabled:i,setChecked:m,control:E,setControl:p,name:a,form:o,value:u,hasConsumerStoppedPropagationRef:_,required:c,defaultChecked:sa(s)?!1:s,isFormControl:w,bubbleInput:I,setBubbleInput:g};return v.jsx(BY,{scope:e,...A,children:WY(h)?h(A):r})}var cM="CheckboxTrigger",uM=S.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...r},s)=>{const{control:i,value:o,disabled:a,checked:l,required:c,setControl:u,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:E}=mT(cM,t),p=lr(s,u),I=S.useRef(l);return S.useEffect(()=>{const g=i==null?void 0:i.form;if(g){const _=()=>h(I.current);return g.addEventListener("reset",_),()=>g.removeEventListener("reset",_)}},[i,h]),v.jsx(Jt.button,{type:"button",role:"checkbox","aria-checked":sa(l)?"mixed":l,"aria-required":c,"data-state":pM(l),"data-disabled":a?"":void 0,disabled:a,value:o,...r,ref:p,onKeyDown:Lt(e,g=>{g.key==="Enter"&&g.preventDefault()}),onClick:Lt(n,g=>{h(_=>sa(_)?!0:!_),E&&m&&(f.current=g.isPropagationStopped(),f.current||g.stopPropagation())})})});uM.displayName=cM;var pT=S.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:a,value:l,onCheckedChange:c,form:u,...h}=t;return v.jsx(zY,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:a,required:o,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:f})=>v.jsxs(v.Fragment,{children:[v.jsx(uM,{...h,ref:e,__scopeCheckbox:n}),f&&v.jsx(mM,{__scopeCheckbox:n})]})})});pT.displayName=Dy;var dM="CheckboxIndicator",hM=S.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...s}=t,i=mT(dM,n);return v.jsx(Fl,{present:r||sa(i.checked)||i.checked===!0,children:v.jsx(Jt.span,{"data-state":pM(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});hM.displayName=dM;var fM="CheckboxBubbleInput",mM=S.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:a,disabled:l,name:c,value:u,form:h,bubbleInput:f,setBubbleInput:m}=mT(fM,t),E=lr(n,m),p=jY(i),I=zk(r);S.useEffect(()=>{const _=f;if(!_)return;const w=window.HTMLInputElement.prototype,P=Object.getOwnPropertyDescriptor(w,"checked").set,L=!s.current;if(p!==i&&P){const x=new Event("click",{bubbles:L});_.indeterminate=sa(i),P.call(_,sa(i)?!1:i),_.dispatchEvent(x)}},[f,p,i,s]);const g=S.useRef(sa(i)?!1:i);return v.jsx(Jt.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??g.current,required:a,disabled:l,name:c,value:u,form:h,...e,tabIndex:-1,ref:E,style:{...e.style,...I,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});mM.displayName=fM;function WY(t){return typeof t=="function"}function sa(t){return t==="indeterminate"}function pM(t){return sa(t)?"indeterminate":t?"checked":"unchecked"}const gM=S.forwardRef(({className:t,...e},n)=>v.jsx(pT,{ref:n,className:Yt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:v.jsx(hM,{className:Yt("flex items-center justify-center text-current"),children:v.jsx(cj,{className:"h-4 w-4"})})}));gM.displayName=pT.displayName;const vg=()=>{const[t,e]=S.useState(""),[n,r]=S.useState(""),[s,i]=S.useState(!1),[o,a]=S.useState(!1),[l,c]=S.useState(typeof navigator<"u"?!navigator.onLine:!1);S.useEffect(()=>{const A=()=>c(!navigator.onLine);return window.addEventListener("online",A),window.addEventListener("offline",A),()=>{window.removeEventListener("online",A),window.removeEventListener("offline",A)}},[]);const[u,h]=S.useState(!0),{signIn:f,user:m,checkSubscriptionStatus:E,loading:p}=Ws(),I=jl();S.useEffect(()=>{try{m&&!p&&I("/user/dashboard")}catch{}},[m,p,I]),S.useEffect(()=>{try{const A=typeof window<"u"?window.localStorage.getItem("cashy:lastEmail"):null;A&&e(A)}catch{}try{const A=typeof window<"u"?window.localStorage.getItem("cashy:rememberLogin"):null;A==="true"?h(!0):A==="false"&&h(!1)}catch{}(async()=>{var A,P;try{if(typeof navigator<"u"&&navigator.credentials&&window.localStorage.getItem("cashy:rememberLogin")==="true"){const L=await((P=(A=navigator.credentials).get)==null?void 0:P.call(A,{password:!0,mediation:"optional"}));L&&L.type==="password"&&(L.id&&e(L.id),L.password&&r(L.password))}if(window.localStorage.getItem("cashy:rememberLogin")==="true")try{const L=sessionStorage.getItem("cashy:rememberedPassword");L&&!n&&r(L)}catch{}}catch{}})()},[]);const g=async A=>{if(A.preventDefault(),o){Et.info("     ...");return}if(typeof navigator<"u"&&navigator.onLine===!1){Et.error("   .      .");return}const P=(t||"").trim().toLowerCase(),L=(n||"").trim();if(console.log("    :",{email:P,password:"***"}),!t||!n){Et.error("   ");return}if(!/^\S+@\S+\.\S+$/.test(P)){Et.error("    ");return}a(!0);try{try{await pW(Ot,u?HE:KE);try{window.localStorage.setItem("cashy:rememberLogin",u?"true":"false")}catch{}}catch{}console.log("  signIn...");const{error:x}=await f(P,L);if(console.log(" SignIn result:",{error:x}),x){console.error("    :",x);const T=x==null?void 0:x.code;T==="auth/user-not-found"?Et.error("     "):T==="auth/wrong-password"?Et.error("   "):T==="auth/invalid-credential"?Et.error("      "):T==="auth/too-many-requests"?Et.error("      "):Et.error((x==null?void 0:x.message)||"    ")}else{console.log("    !"),Et.success("   !");try{if(u&&navigator.credentials&&window.PasswordCredential){const T=new window.PasswordCredential({id:P,name:P,password:L});await navigator.credentials.store(T)}if(u)try{sessionStorage.setItem("cashy:rememberedPassword",L)}catch{}else try{sessionStorage.removeItem("cashy:rememberedPassword")}catch{}}catch{}setTimeout(()=>{try{window.location.reload()}catch{}},800)}}catch(x){console.error("   :",x),Et.error("   ")}finally{a(!1)}},_=A=>{if(o){A.preventDefault(),A.stopPropagation(),Et.info("     ...");return}if(typeof navigator<"u"&&navigator.onLine===!1){A.preventDefault(),A.stopPropagation(),Et.error("   .      .");return}t||Et.error("   "),n||Et.error("   ");const P=(t||"").trim().toLowerCase();P&&!/^\S+@\S+\.\S+$/.test(P)&&Et.error("    ")},w=()=>{I("/user/forgot-password")};return S.useEffect(()=>{if(!(typeof window<"u"&&window.matchMedia&&window.matchMedia("(pointer: coarse)").matches))return;const A=document.documentElement,P=document.body,L=A.style.overflow,x=P.style.overflow,T=A.style.overscrollBehaviorY,R=P.style.overscrollBehaviorY;return A.style.overflow="hidden",P.style.overflow="hidden",A.style.overscrollBehaviorY="none",P.style.overscrollBehaviorY="none",()=>{A.style.overflow=L||"",P.style.overflow=x||"",A.style.overscrollBehaviorY=T||"",P.style.overscrollBehaviorY=R||""}},[]),v.jsxs("div",{className:"relative min-h-[100dvh] w-full overflow-hidden flex items-center justify-center p-4 bg-no-repeat bg-cover",style:{backgroundImage:"var(--bg-purple-gradient)",backgroundAttachment:"fixed"},children:[l&&v.jsx("div",{className:"absolute top-0 left-0 right-0 bg-red-600 text-white text-center py-2 z-50 animate-in fade-in slide-in-from-top-2",children:v.jsx("p",{className:"text-sm font-medium",children:"   .        ."})}),v.jsx("div",{className:"absolute inset-0 bg-black/40"}),v.jsxs("div",{className:"w-full max-w-md mt-16 md:mt-12 lg:mt-10",children:[v.jsxs("div",{className:"text-center mb-8",children:[v.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-green-600 to-blue-600 rounded-full mb-4 shadow-2xl",children:v.jsx(Uj,{className:"w-10 h-10 text-white"})}),v.jsx("div",{className:"flex items-center justify-center mb-2",children:v.jsx("span",{className:"text-2xl font-extrabold text-white tracking-wider uppercase",dir:"ltr",style:{fontFamily:"Inter, sans-serif"},children:"cashy link"})}),v.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"  "}),v.jsx("p",{className:"text-white/80",children:"    "})]}),v.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-2xl p-8 shadow-2xl border border-white/20",children:[v.jsxs("form",{onSubmit:g,className:"space-y-6",autoComplete:"on",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-white",children:" "}),v.jsxs("div",{className:"relative",children:[v.jsx(nw,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/70 w-5 h-5"}),v.jsx(ri,{id:"username",type:"email",placeholder:"  ",value:t,onChange:A=>{const P=A.target.value;e(P);try{window.localStorage.setItem("cashy:lastEmail",P)}catch{}},name:"username",autoComplete:"username",className:"pl-10 pr-4 py-3 rounded-lg bg-white/20 border-white/30 text-white placeholder:text-white/70 focus:ring-2 focus:ring-green-400",dir:"rtl",required:!0})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-white",children:" "}),v.jsxs("div",{className:"relative",children:[v.jsx(yk,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/70 w-5 h-5"}),v.jsx(ri,{id:"password",type:s?"text":"password",placeholder:"  ",value:n,onChange:A=>r(A.target.value),className:"pl-10 pr-10 py-3 rounded-lg bg-white/20 border-white/30 text-white placeholder:text-white/70 focus:ring-2 focus:ring-green-400",name:"password",autoComplete:"current-password",dir:"rtl",required:!0}),v.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-white/70 hover:text-white transition-colors",children:s?v.jsx(pk,{className:"w-5 h-5"}):v.jsx(gk,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[v.jsx(gM,{id:"rememberLogin",checked:u,onCheckedChange:A=>h(!!A)}),v.jsx("label",{htmlFor:"rememberLogin",className:"text-sm text-white",children:"  "})]})]}),v.jsx("div",{className:"flex justify-end",children:v.jsxs(Vn,{type:"button",variant:"ghost",size:"sm",onClick:w,className:"text-green-200 hover:text-green-100 p-0 h-auto font-normal hover:bg-transparent",children:[v.jsx(nw,{className:"w-4 h-4 ml-1"}),"  "]})}),v.jsx("button",{type:"submit",onClick:_,className:"w-full bg-gradient-to-r from-green-600 to-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:from-green-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-green-400 transition-all duration-200",children:o?v.jsxs("div",{className:"flex items-center justify-center",children:[v.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white ml-2"}),"  ..."]}):v.jsxs("div",{className:"flex items-center justify-center",children:[v.jsx(mk,{className:"w-5 h-5 ml-2"})," "]})})]}),v.jsxs("div",{className:"mt-6 text-center space-y-3",children:[v.jsxs("p",{className:"text-sm text-white/80",children:["  "," ",v.jsx(pw,{to:"/user/register",className:"text-green-200 hover:text-green-100 font-medium transition-colors hover:underline",children:"  "})]}),v.jsxs("p",{className:"text-sm text-white/80",children:["        "," ",v.jsx("a",{href:"https://wa.me/201000392539",target:"_blank",rel:"noreferrer",className:"text-green-200 hover:text-green-100 font-medium hover:underline",children:"01000392539"})," ","   "," ",v.jsx("a",{href:"mailto:info@cashy-link.com",className:"text-blue-200 hover:text-blue-100 font-medium hover:underline",children:"info@cashy-link.com"})]})]})]}),v.jsx("div",{className:"mt-6 text-center",children:v.jsx("p",{className:"text-xs text-white/70",children:"   "})})]})]})},qY=Object.freeze(Object.defineProperty({__proto__:null,default:vg},Symbol.toStringTag,{value:"Module"})),gT=S.forwardRef(({className:t,...e},n)=>v.jsx("div",{ref:n,className:Yt("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));gT.displayName="Card";const yT=S.forwardRef(({className:t,...e},n)=>v.jsx("div",{ref:n,className:Yt("flex flex-col space-y-1.5 p-6",t),...e}));yT.displayName="CardHeader";const vT=S.forwardRef(({className:t,...e},n)=>v.jsx("h3",{ref:n,className:Yt("text-2xl font-semibold leading-none tracking-tight",t),...e}));vT.displayName="CardTitle";const yM=S.forwardRef(({className:t,...e},n)=>v.jsx("p",{ref:n,className:Yt("text-sm text-muted-foreground",t),...e}));yM.displayName="CardDescription";const _T=S.forwardRef(({className:t,...e},n)=>v.jsx("div",{ref:n,className:Yt("p-6 pt-0",t),...e}));_T.displayName="CardContent";const HY=S.forwardRef(({className:t,...e},n)=>v.jsx("div",{ref:n,className:Yt("flex items-center p-6 pt-0",t),...e}));HY.displayName="CardFooter";var KY="Label",vM=S.forwardRef((t,e)=>v.jsx(Jt.label,{...t,ref:e,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));vM.displayName=KY;var _M=vM;const GY=mE("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Li=S.forwardRef(({className:t,...e},n)=>v.jsx(_M,{ref:n,className:Yt(GY(),t),...e}));Li.displayName=_M.displayName;var Gv="focusScope.autoFocusOnMount",Qv="focusScope.autoFocusOnUnmount",_R={bubbles:!1,cancelable:!0},QY="FocusScope",wM=S.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[a,l]=S.useState(null),c=pi(s),u=pi(i),h=S.useRef(null),f=lr(e,p=>l(p)),m=S.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;S.useEffect(()=>{if(r){let p=function(w){if(m.paused||!a)return;const A=w.target;a.contains(A)?h.current=A:_o(h.current,{select:!0})},I=function(w){if(m.paused||!a)return;const A=w.relatedTarget;A!==null&&(a.contains(A)||_o(h.current,{select:!0}))},g=function(w){if(document.activeElement===document.body)for(const P of w)P.removedNodes.length>0&&_o(a)};document.addEventListener("focusin",p),document.addEventListener("focusout",I);const _=new MutationObserver(g);return a&&_.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",I),_.disconnect()}}},[r,a,m.paused]),S.useEffect(()=>{if(a){ER.add(m);const p=document.activeElement;if(!a.contains(p)){const g=new CustomEvent(Gv,_R);a.addEventListener(Gv,c),a.dispatchEvent(g),g.defaultPrevented||(YY(tJ(EM(a)),{select:!0}),document.activeElement===p&&_o(a))}return()=>{a.removeEventListener(Gv,c),setTimeout(()=>{const g=new CustomEvent(Qv,_R);a.addEventListener(Qv,u),a.dispatchEvent(g),g.defaultPrevented||_o(p??document.body,{select:!0}),a.removeEventListener(Qv,u),ER.remove(m)},0)}}},[a,c,u,m]);const E=S.useCallback(p=>{if(!n&&!r||m.paused)return;const I=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,g=document.activeElement;if(I&&g){const _=p.currentTarget,[w,A]=JY(_);w&&A?!p.shiftKey&&g===A?(p.preventDefault(),n&&_o(w,{select:!0})):p.shiftKey&&g===w&&(p.preventDefault(),n&&_o(A,{select:!0})):g===_&&p.preventDefault()}},[n,r,m.paused]);return v.jsx(Jt.div,{tabIndex:-1,...o,ref:f,onKeyDown:E})});wM.displayName=QY;function YY(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(_o(r,{select:e}),document.activeElement!==n)return}function JY(t){const e=EM(t),n=wR(e,t),r=wR(e.reverse(),t);return[n,r]}function EM(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function wR(t,e){for(const n of t)if(!XY(n,{upTo:e}))return n}function XY(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function ZY(t){return t instanceof HTMLInputElement&&"select"in t}function _o(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&ZY(t)&&e&&t.select()}}var ER=eJ();function eJ(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=IR(t,e),t.unshift(e)},remove(e){var n;t=IR(t,e),(n=t[0])==null||n.resume()}}}function IR(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function tJ(t){return t.filter(e=>e.tagName!=="A")}var Yv=0;function nJ(){S.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??TR()),document.body.insertAdjacentElement("beforeend",t[1]??TR()),Yv++,()=>{Yv===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Yv--}},[])}function TR(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var ti=function(){return ti=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ti.apply(this,arguments)};function IM(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function rJ(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var ip="right-scroll-bar-position",op="width-before-scroll-bar",sJ="with-scroll-bars-hidden",iJ="--removed-body-scroll-bar-size";function Jv(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function oJ(t,e){var n=S.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var aJ=typeof window<"u"?S.useLayoutEffect:S.useEffect,SR=new WeakMap;function lJ(t,e){var n=oJ(null,function(r){return t.forEach(function(s){return Jv(s,r)})});return aJ(function(){var r=SR.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(a){i.has(a)||Jv(a,null)}),i.forEach(function(a){s.has(a)||Jv(a,o)})}SR.set(n,t)},[t]),n}function cJ(t){return t}function uJ(t,e){e===void 0&&(e=cJ);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return s}function dJ(t){t===void 0&&(t={});var e=uJ(null);return e.options=ti({async:!0,ssr:!1},t),e}var TM=function(t){var e=t.sideCar,n=IM(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return S.createElement(r,ti({},n))};TM.isSideCarExport=!0;function hJ(t,e){return t.useMedium(e),TM}var SM=dJ(),Xv=function(){},Oy=S.forwardRef(function(t,e){var n=S.useRef(null),r=S.useState({onScrollCapture:Xv,onWheelCapture:Xv,onTouchMoveCapture:Xv}),s=r[0],i=r[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,h=t.shards,f=t.sideCar,m=t.noRelative,E=t.noIsolation,p=t.inert,I=t.allowPinchZoom,g=t.as,_=g===void 0?"div":g,w=t.gapMode,A=IM(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),P=f,L=lJ([n,e]),x=ti(ti({},A),s);return S.createElement(S.Fragment,null,u&&S.createElement(P,{sideCar:SM,removeScrollBar:c,shards:h,noRelative:m,noIsolation:E,inert:p,setCallbacks:i,allowPinchZoom:!!I,lockRef:n,gapMode:w}),o?S.cloneElement(S.Children.only(a),ti(ti({},x),{ref:L})):S.createElement(_,ti({},x,{className:l,ref:L}),a))});Oy.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Oy.classNames={fullWidth:op,zeroRight:ip};var fJ=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function mJ(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=fJ();return e&&t.setAttribute("nonce",e),t}function pJ(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function gJ(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var yJ=function(){var t=0,e=null;return{add:function(n){t==0&&(e=mJ())&&(pJ(e,n),gJ(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},vJ=function(){var t=yJ();return function(e,n){S.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},bM=function(){var t=vJ(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},_J={left:0,top:0,right:0,gap:0},Zv=function(t){return parseInt(t||"",10)||0},wJ=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[Zv(n),Zv(r),Zv(s)]},EJ=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return _J;var e=wJ(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},IJ=bM(),qc="data-scroll-locked",TJ=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(sJ,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(qc,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(ip,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(op,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(ip," .").concat(ip,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(op," .").concat(op,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(qc,`] {
    `).concat(iJ,": ").concat(a,`px;
  }
`)},bR=function(){var t=parseInt(document.body.getAttribute(qc)||"0",10);return isFinite(t)?t:0},SJ=function(){S.useEffect(function(){return document.body.setAttribute(qc,(bR()+1).toString()),function(){var t=bR()-1;t<=0?document.body.removeAttribute(qc):document.body.setAttribute(qc,t.toString())}},[])},bJ=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;SJ();var i=S.useMemo(function(){return EJ(s)},[s]);return S.createElement(IJ,{styles:TJ(i,!e,s,n?"":"!important")})},o0=!1;if(typeof window<"u")try{var Im=Object.defineProperty({},"passive",{get:function(){return o0=!0,!0}});window.addEventListener("test",Im,Im),window.removeEventListener("test",Im,Im)}catch{o0=!1}var ic=o0?{passive:!1}:!1,AJ=function(t){return t.tagName==="TEXTAREA"},AM=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!AJ(t)&&n[e]==="visible")},xJ=function(t){return AM(t,"overflowY")},RJ=function(t){return AM(t,"overflowX")},AR=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=xM(t,r);if(s){var i=RM(t,r),o=i[1],a=i[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},PJ=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},CJ=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},xM=function(t,e){return t==="v"?xJ(e):RJ(e)},RM=function(t,e){return t==="v"?PJ(e):CJ(e)},kJ=function(t,e){return t==="h"&&e==="rtl"?-1:1},NJ=function(t,e,n,r,s){var i=kJ(t,window.getComputedStyle(e).direction),o=i*r,a=n.target,l=e.contains(a),c=!1,u=o>0,h=0,f=0;do{if(!a)break;var m=RM(t,a),E=m[0],p=m[1],I=m[2],g=p-I-i*E;(E||g)&&xM(t,a)&&(h+=g,f+=E);var _=a.parentNode;a=_&&_.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_.host:_}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&Math.abs(h)<1||!u&&Math.abs(f)<1)&&(c=!0),c},Tm=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},xR=function(t){return[t.deltaX,t.deltaY]},RR=function(t){return t&&"current"in t?t.current:t},DJ=function(t,e){return t[0]===e[0]&&t[1]===e[1]},OJ=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},LJ=0,oc=[];function MJ(t){var e=S.useRef([]),n=S.useRef([0,0]),r=S.useRef(),s=S.useState(LJ++)[0],i=S.useState(bM)[0],o=S.useRef(t);S.useEffect(function(){o.current=t},[t]),S.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var p=rJ([t.lockRef.current],(t.shards||[]).map(RR),!0).filter(Boolean);return p.forEach(function(I){return I.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),p.forEach(function(I){return I.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var a=S.useCallback(function(p,I){if("touches"in p&&p.touches.length===2||p.type==="wheel"&&p.ctrlKey)return!o.current.allowPinchZoom;var g=Tm(p),_=n.current,w="deltaX"in p?p.deltaX:_[0]-g[0],A="deltaY"in p?p.deltaY:_[1]-g[1],P,L=p.target,x=Math.abs(w)>Math.abs(A)?"h":"v";if("touches"in p&&x==="h"&&L.type==="range")return!1;var T=AR(x,L);if(!T)return!0;if(T?P=x:(P=x==="v"?"h":"v",T=AR(x,L)),!T)return!1;if(!r.current&&"changedTouches"in p&&(w||A)&&(r.current=P),!P)return!0;var R=r.current||P;return NJ(R,I,p,R==="h"?w:A)},[]),l=S.useCallback(function(p){var I=p;if(!(!oc.length||oc[oc.length-1]!==i)){var g="deltaY"in I?xR(I):Tm(I),_=e.current.filter(function(P){return P.name===I.type&&(P.target===I.target||I.target===P.shadowParent)&&DJ(P.delta,g)})[0];if(_&&_.should){I.cancelable&&I.preventDefault();return}if(!_){var w=(o.current.shards||[]).map(RR).filter(Boolean).filter(function(P){return P.contains(I.target)}),A=w.length>0?a(I,w[0]):!o.current.noIsolation;A&&I.cancelable&&I.preventDefault()}}},[]),c=S.useCallback(function(p,I,g,_){var w={name:p,delta:I,target:g,should:_,shadowParent:VJ(g)};e.current.push(w),setTimeout(function(){e.current=e.current.filter(function(A){return A!==w})},1)},[]),u=S.useCallback(function(p){n.current=Tm(p),r.current=void 0},[]),h=S.useCallback(function(p){c(p.type,xR(p),p.target,a(p,t.lockRef.current))},[]),f=S.useCallback(function(p){c(p.type,Tm(p),p.target,a(p,t.lockRef.current))},[]);S.useEffect(function(){return oc.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",l,ic),document.addEventListener("touchmove",l,ic),document.addEventListener("touchstart",u,ic),function(){oc=oc.filter(function(p){return p!==i}),document.removeEventListener("wheel",l,ic),document.removeEventListener("touchmove",l,ic),document.removeEventListener("touchstart",u,ic)}},[]);var m=t.removeScrollBar,E=t.inert;return S.createElement(S.Fragment,null,E?S.createElement(i,{styles:OJ(s)}):null,m?S.createElement(bJ,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function VJ(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const FJ=hJ(SM,MJ);var PM=S.forwardRef(function(t,e){return S.createElement(Oy,ti({},t,{ref:e,sideCar:FJ}))});PM.classNames=Oy.classNames;var UJ=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},ac=new WeakMap,Sm=new WeakMap,bm={},e_=0,CM=function(t){return t&&(t.host||CM(t.parentNode))},jJ=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=CM(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},$J=function(t,e,n,r){var s=jJ(e,Array.isArray(t)?t:[t]);bm[n]||(bm[n]=new WeakMap);var i=bm[n],o=[],a=new Set,l=new Set(s),c=function(h){!h||a.has(h)||(a.add(h),c(h.parentNode))};s.forEach(c);var u=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(f){if(a.has(f))u(f);else try{var m=f.getAttribute(r),E=m!==null&&m!=="false",p=(ac.get(f)||0)+1,I=(i.get(f)||0)+1;ac.set(f,p),i.set(f,I),o.push(f),p===1&&E&&Sm.set(f,!0),I===1&&f.setAttribute(n,"true"),E||f.setAttribute(r,"true")}catch(g){console.error("aria-hidden: cannot operate on ",f,g)}})};return u(e),a.clear(),e_++,function(){o.forEach(function(h){var f=ac.get(h)-1,m=i.get(h)-1;ac.set(h,f),i.set(h,m),f||(Sm.has(h)||h.removeAttribute(r),Sm.delete(h)),m||h.removeAttribute(n)}),e_--,e_||(ac=new WeakMap,ac=new WeakMap,Sm=new WeakMap,bm={})}},BJ=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=UJ(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),$J(r,s,n,"aria-hidden")):function(){return null}},Ly="Dialog",[kM,IZ]=$u(Ly),[zJ,qs]=kM(Ly),NM=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,a=S.useRef(null),l=S.useRef(null),[c,u]=uE({prop:r,defaultProp:s??!1,onChange:i,caller:Ly});return v.jsx(zJ,{scope:e,triggerRef:a,contentRef:l,contentId:_v(),titleId:_v(),descriptionId:_v(),open:c,onOpenChange:u,onOpenToggle:S.useCallback(()=>u(h=>!h),[u]),modal:o,children:n})};NM.displayName=Ly;var DM="DialogTrigger",OM=S.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=qs(DM,n),i=lr(e,s.triggerRef);return v.jsx(Jt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":IT(s.open),...r,ref:i,onClick:Lt(t.onClick,s.onOpenToggle)})});OM.displayName=DM;var wT="DialogPortal",[WJ,LM]=kM(wT,{forceMount:void 0}),MM=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=qs(wT,e);return v.jsx(WJ,{scope:e,forceMount:n,children:S.Children.map(r,o=>v.jsx(Fl,{present:n||i.open,children:v.jsx(cE,{asChild:!0,container:s,children:o})}))})};MM.displayName=wT;var _g="DialogOverlay",VM=S.forwardRef((t,e)=>{const n=LM(_g,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=qs(_g,t.__scopeDialog);return i.modal?v.jsx(Fl,{present:r||i.open,children:v.jsx(HJ,{...s,ref:e})}):null});VM.displayName=_g;var qJ=kh("DialogOverlay.RemoveScroll"),HJ=S.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=qs(_g,n);return v.jsx(PM,{as:qJ,allowPinchZoom:!0,shards:[s.contentRef],children:v.jsx(Jt.div,{"data-state":IT(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Ll="DialogContent",FM=S.forwardRef((t,e)=>{const n=LM(Ll,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=qs(Ll,t.__scopeDialog);return v.jsx(Fl,{present:r||i.open,children:i.modal?v.jsx(KJ,{...s,ref:e}):v.jsx(GJ,{...s,ref:e})})});FM.displayName=Ll;var KJ=S.forwardRef((t,e)=>{const n=qs(Ll,t.__scopeDialog),r=S.useRef(null),s=lr(e,n.contentRef,r);return S.useEffect(()=>{const i=r.current;if(i)return BJ(i)},[]),v.jsx(UM,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Lt(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Lt(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:Lt(t.onFocusOutside,i=>i.preventDefault())})}),GJ=S.forwardRef((t,e)=>{const n=qs(Ll,t.__scopeDialog),r=S.useRef(!1),s=S.useRef(!1);return v.jsx(UM,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),UM=S.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,a=qs(Ll,n),l=S.useRef(null),c=lr(e,l);return nJ(),v.jsxs(v.Fragment,{children:[v.jsx(wM,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:v.jsx(Ug,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":IT(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),v.jsxs(v.Fragment,{children:[v.jsx(QJ,{titleId:a.titleId}),v.jsx(JJ,{contentRef:l,descriptionId:a.descriptionId})]})]})}),ET="DialogTitle",jM=S.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=qs(ET,n);return v.jsx(Jt.h2,{id:s.titleId,...r,ref:e})});jM.displayName=ET;var $M="DialogDescription",BM=S.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=qs($M,n);return v.jsx(Jt.p,{id:s.descriptionId,...r,ref:e})});BM.displayName=$M;var zM="DialogClose",WM=S.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=qs(zM,n);return v.jsx(Jt.button,{type:"button",...r,ref:e,onClick:Lt(t.onClick,()=>s.onOpenChange(!1))})});WM.displayName=zM;function IT(t){return t?"open":"closed"}var qM="DialogTitleWarning",[TZ,HM]=r4(qM,{contentName:Ll,titleName:ET,docsSlug:"dialog"}),QJ=({titleId:t})=>{const e=HM(qM),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return S.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},YJ="DialogDescriptionWarning",JJ=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${HM(YJ).contentName}}.`;return S.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},XJ=NM,ZJ=OM,eX=MM,KM=VM,GM=FM,QM=jM,YM=BM,tX=WM;const fh=XJ,SZ=ZJ,nX=eX,JM=S.forwardRef(({className:t,...e},n)=>v.jsx(KM,{ref:n,className:Yt("fixed inset-0 z-50 bg-black/30 dark:bg-black/20 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 radix-dialog-overlay",t),...e}));JM.displayName=KM.displayName;const Hc=S.forwardRef(({className:t,children:e,hideClose:n,disableOutsideClose:r,disableEscClose:s,...i},o)=>v.jsxs(nX,{children:[v.jsx(JM,{}),v.jsxs(GM,{ref:o,className:Yt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 bg-background p-6 shadow-md rounded-2xl duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] radix-dialog-content",t),onInteractOutside:a=>{r&&a.preventDefault()},onEscapeKeyDown:a=>{s&&a.preventDefault()},...i,children:[e,!n&&v.jsxs(tX,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[v.jsx(gE,{className:"h-4 w-4"}),v.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Hc.displayName=GM.displayName;const Kc=({className:t,...e})=>v.jsx("div",{className:Yt("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Kc.displayName="DialogHeader";const TT=({className:t,...e})=>v.jsx("div",{className:Yt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});TT.displayName="DialogFooter";const Gc=S.forwardRef(({className:t,...e},n)=>v.jsx(QM,{ref:n,className:Yt("text-lg font-semibold leading-none tracking-tight",t),...e}));Gc.displayName=QM.displayName;const a0=S.forwardRef(({className:t,...e},n)=>v.jsx(YM,{ref:n,className:Yt("text-sm text-muted-foreground",t),...e}));a0.displayName=YM.displayName;function XM({open:t,onOpenChange:e,onSuccess:n}){const{user:r,userSubscription:s}=Ws(),[i,o]=S.useState("1"),[a,l]=S.useState("basic"),[c,u]=S.useState(!1),[h,f]=S.useState(null),m=async()=>{var E;if(r){u(!0),f(null);try{const p=((E=s==null?void 0:s.branchPackage)==null?void 0:E.limit)||0;await wn(Ce(G,"users",r.uid),{branchPackage:{status:"pending",requested:!0,limit:p+parseInt(i),packageType:a,requestedAt:new Date().toISOString()}}),f("       ."),window.dispatchEvent(new Event("userSubscriptionUpdated")),setTimeout(()=>{e(!1),n&&n()},1500)}catch(p){f("  : "+p.message)}finally{u(!1)}}};return v.jsx(fh,{open:t,onOpenChange:e,children:v.jsxs(Hc,{children:[v.jsx(Kc,{children:v.jsx(Gc,{children:" "})}),v.jsxs("div",{className:"grid gap-4 py-2",children:[v.jsxs("div",{className:"grid gap-2",children:[v.jsx(Li,{children:"   "}),v.jsx(ri,{type:"number",min:"1",value:i,onChange:E=>o(E.target.value),placeholder:"   "})]}),v.jsxs("div",{className:"grid gap-2",children:[v.jsx(Li,{children:" "}),v.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:a,onChange:E=>l(E.target.value),children:[v.jsx("option",{value:"basic",children:"  ()"}),v.jsx("option",{value:"quarterly",children:"   (3 )"}),v.jsx("option",{value:"pro",children:"  ()"}),v.jsx("option",{value:"enterprise",children:"  ( )"})]})]}),h&&v.jsx("p",{className:`text-sm ${h.includes("")?"text-green-600":"text-red-600"}`,children:h})]}),v.jsxs(TT,{children:[v.jsx(Vn,{variant:"outline",onClick:()=>e(!1),children:""}),v.jsx(Vn,{onClick:m,disabled:c,className:"bg-black text-white hover:bg-gray-800 dark:bg-white dark:text-black dark:hover:bg-gray-200",children:c?" ...":" "})]})]})})}const bZ=Object.freeze(Object.defineProperty({__proto__:null,BranchRequestDialog:XM},Symbol.toStringTag,{value:"Module"}));function PR(){var C,D,O,k;const{user:t,profile:e,isSubscriptionActive:n,userSubscription:r}=Ws(),[s,i]=S.useState(!1),[o,a]=S.useState(!1),[l,c]=S.useState(""),[u,h]=S.useState(""),[f,m]=S.useState(""),[E,p]=S.useState(""),[I,g]=S.useState(!1),[_,w]=S.useState(null),[A,P]=S.useState(0),L=((C=r==null?void 0:r.branchPackage)==null?void 0:C.status)==="active",x=((D=r==null?void 0:r.branchPackage)==null?void 0:D.limit)||0;F.useEffect(()=>{t&&(async()=>{try{const ce=Ve(ke(G,"shops"),Oe("ownerId","==",t.uid)),he=await bL(ce);P(he.data().count)}catch(ce){console.error("Error fetching shops count:",ce)}})()},[t]),(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="merchant"||n||L&&A<x;const T=()=>{c(""),h(""),m(""),p("")},R=async()=>{w(null);const B=l.trim(),ce=u.trim(),he=f.trim(),Se=E;if(L&&A>=x&&(e==null?void 0:e.role)!=="admin"&&(e==null?void 0:e.role)!=="merchant"){w(`        (${x}).   .`);return}if(!B||!ce||!he||!Se){w("    .");return}try{g(!0);const q=await ZG(nM,"createShopAndManager")({shopName:B,managerName:ce,email:he,password:Se,branchCode:null}),X=q==null?void 0:q.data;X!=null&&X.success?(w(`   (${X.shopId})   .`),T(),i(!1)):w("     .")}catch($){const q=($==null?void 0:$.message)||"     ";w(q)}finally{g(!1)}};return v.jsxs("div",{className:"container mx-auto p-4",children:[v.jsxs(gT,{children:[v.jsx(yT,{children:v.jsx(vT,{children:"  (CPanel)"})}),v.jsxs(_T,{children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("div",{children:v.jsx("p",{className:"text-sm text-muted-foreground",children:"           ."})}),v.jsxs("div",{className:"flex gap-2",children:[!L&&((O=r==null?void 0:r.branchPackage)==null?void 0:O.status)!=="pending"&&v.jsx(Vn,{onClick:()=>a(!0),variant:"outline",children:"  "}),((k=r==null?void 0:r.branchPackage)==null?void 0:k.status)==="pending"&&v.jsx(Vn,{disabled:!0,variant:"outline",className:"text-yellow-600 border-yellow-200 bg-yellow-50",children:"  "}),v.jsx(Vn,{onClick:()=>i(!0),disabled:!1,children:" "})]})]}),!t&&v.jsx("p",{className:"mt-3 text-sm text-red-600",children:"      ."}),L&&v.jsxs("p",{className:"mt-3 text-sm text-green-600 font-medium",children:["  :  ",A,"   ",x," ."]}),t&&!1]})]}),v.jsx(fh,{open:s,onOpenChange:i,children:v.jsxs(Hc,{children:[v.jsx(Kc,{children:v.jsx(Gc,{children:"  "})}),v.jsxs("div",{className:"grid gap-4 py-2",children:[v.jsxs("div",{className:"grid gap-2",children:[v.jsx(Li,{htmlFor:"shopName",children:" "}),v.jsx(ri,{id:"shopName",value:l,onChange:B=>c(B.target.value),placeholder:":  "})]}),v.jsxs("div",{className:"grid gap-2",children:[v.jsx(Li,{htmlFor:"managerName",children:" "}),v.jsx(ri,{id:"managerName",value:u,onChange:B=>h(B.target.value),placeholder:":  "})]}),v.jsxs("div",{className:"grid gap-2",children:[v.jsx(Li,{htmlFor:"email",children:""}),v.jsx(ri,{id:"email",type:"email",value:f,onChange:B=>m(B.target.value),placeholder:"example@mail.com"})]}),v.jsxs("div",{className:"grid gap-2",children:[v.jsx(Li,{htmlFor:"password",children:""}),v.jsx(ri,{id:"password",type:"password",value:E,onChange:B=>p(B.target.value),placeholder:""})]}),_&&v.jsx("p",{className:"text-sm text-muted-foreground",children:_})]}),v.jsxs(TT,{children:[v.jsx(Vn,{variant:"outline",onClick:()=>i(!1),disabled:I,children:""}),v.jsx(Vn,{onClick:R,disabled:I||!1,children:I?" ...":" "})]})]})}),v.jsx(XM,{open:o,onOpenChange:a})]})}const CR=()=>{const[t,e]=S.useState(""),[n,r]=S.useState(""),[s,i]=S.useState(!1),[o,a]=S.useState(!1),{signIn:l}=Ws(),c=jl();S.useEffect(()=>{try{const h=typeof window<"u"?window.localStorage.getItem("cashy:lastEmail"):null;h&&e(h)}catch{}},[]);const u=async h=>{var f;if(h.preventDefault(),o){Et.info("     ...");return}if(typeof navigator<"u"&&navigator.onLine===!1){Et.error("   .      .");return}if(!t||!n){Et.error("     ");return}a(!0);try{const{error:m}=await l(t,n);if(m){const E=m==null?void 0:m.code;E==="auth/invalid-email"?Et.error("    "):E==="auth/user-not-found"?Et.error("     "):E==="auth/wrong-password"?Et.error("   "):E==="auth/invalid-credential"?Et.error("      "):E==="auth/too-many-requests"?Et.error("      "):Et.error((m==null?void 0:m.message)||"    ");return}try{const E=(f=Ot.currentUser)==null?void 0:f.uid;E&&await on(Ce(G,"users",E),{branchPackage:{requested:!0,status:"pending",requestedAt:Le()},updatedAt:Le()},{merge:!0})}catch(E){console.warn("    :",E)}Et.success("   "),c("/cpanel")}catch(m){Et.error((m==null?void 0:m.message)||"     ")}finally{a(!1)}};return v.jsx("div",{className:"min-h-screen bg-background px-4 py-8 flex items-center justify-center",children:v.jsxs(gT,{className:"w-full max-w-md",children:[v.jsxs(yT,{children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(vk,{className:"w-6 h-6"}),v.jsx(vT,{children:"   "})]}),v.jsx(yM,{children:"     "})]}),v.jsx(_T,{children:v.jsxs("form",{onSubmit:u,className:"space-y-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx(Li,{htmlFor:"email",children:" "}),v.jsxs("div",{className:"relative",children:[v.jsx(nw,{className:"absolute right-3 top-2.5 w-5 h-5 text-muted-foreground"}),v.jsx(ri,{id:"email",type:"email",value:t,onChange:h=>{const f=h.target.value;e(f);try{window.localStorage.setItem("cashy:lastEmail",f)}catch{}},placeholder:"example@mail.com",className:"pr-10"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Li,{htmlFor:"password",children:" "}),v.jsxs("div",{className:"relative",children:[v.jsx(yk,{className:"absolute right-3 top-2.5 w-5 h-5 text-muted-foreground"}),v.jsx(ri,{id:"password",type:s?"text":"password",value:n,onChange:h=>r(h.target.value),placeholder:"",className:"pr-10"}),v.jsx("button",{type:"button",onClick:()=>i(h=>!h),className:"absolute left-3 top-2.5 text-muted-foreground","aria-label":s?"  ":"  ",children:s?v.jsx(pk,{className:"w-5 h-5"}):v.jsx(gk,{className:"w-5 h-5"})})]})]}),v.jsx("button",{type:"submit",onClick:h=>{o?(h.preventDefault(),h.stopPropagation(),Et.info("     ...")):typeof navigator<"u"&&navigator.onLine===!1?(h.preventDefault(),h.stopPropagation(),Et.error("   .      .")):(t||Et.error("   "),n||Et.error("   "))},className:"w-full inline-flex items-center justify-center gap-2 rounded-md bg-primary px-4 py-2 text-white hover:opacity-90",children:o?v.jsxs("div",{className:"flex items-center",children:[v.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white ml-2"}),"  ..."]}):v.jsxs("div",{className:"flex items-center justify-center",children:[v.jsx(mk,{className:"w-5 h-5 ml-2"})," "]})}),v.jsxs("div",{className:"mt-4 text-center space-y-3",children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"  "}),v.jsxs("div",{className:"flex items-center justify-center gap-2",children:[v.jsx(pw,{to:"/user/forgot-password",className:"text-primary text-sm",children:"   "}),v.jsx("span",{className:"text-muted-foreground",children:""}),v.jsx(pw,{to:"/auth?mode=signup",className:"text-primary text-sm",children:"  "})]})]})]})})]})})},rX=()=>{const t=jl(),e=wi(),{signOut:n,user:r,userSubscription:s}=Ws(),{toast:i}=lE(),[o,a]=S.useState(!1),[l,c]=S.useState(!1),u=(g,_,w={},A={})=>{if(e.pathname.startsWith("/user/dashboard"))window.dispatchEvent(new CustomEvent("dashboard-navigation-action",{detail:{action:g,payload:A}}));else{const P=_?{[_]:!0,...w}:{...w};t("/user/dashboard",{state:P})}},h=[{id:"home",label:"",icon:_j,path:"/user/dashboard",action:()=>{const g=()=>{const _=document.getElementById("dashboard-content-container");_&&(_.scrollTop=0,_.scrollTo(0,0));const w=document.querySelector(".user-dashboard");w&&(w.scrollTop=0,w.scrollTo(0,0)),window.scrollTo(0,0),document.body.scrollTop=0,document.documentElement.scrollTop=0};e.pathname==="/user/dashboard"?(e.state&&Object.keys(e.state).length>0&&t("/user/dashboard",{replace:!0,state:{}}),g()):t("/user/dashboard"),setTimeout(g,10),setTimeout(g,50),setTimeout(g,150),setTimeout(g,300)}},{id:"debts",label:"",icon:yj,path:"/debts",action:()=>{var g;(g=e.state)!=null&&g.openDebtDialog||u("debts","openDebtDialog")}},{id:"transfer",label:"",icon:ij,path:"/transfer",action:()=>{u("transaction-section","openTransactionSection",{transactionType:"transfer",startNewTransaction:!0},{transactionType:"transfer",startNewTransaction:!0,skipAnimation:!0})}},{id:"add",label:"",icon:yb,path:"/add",isSpecial:!0},{id:"withdraw",label:"",icon:nj,path:"/withdraw",action:()=>{u("transaction-section","openTransactionSection",{transactionType:"withdraw",startNewTransaction:!0},{transactionType:"withdraw",startNewTransaction:!0,skipAnimation:!0})}},{id:"sales",label:"",icon:wb,path:"/user/dashboard",action:()=>{var g;(g=e.state)!=null&&g.openSalesDialog||u("sales","openSalesDialog")}},{id:"settings",label:"",icon:_b,path:"/user/dashboard",action:()=>{u("profile-settings","openProfileSettings")}}],m=[{id:"installment",label:"",icon:aj,action:()=>{var _,w;a(!1);const g=(_=s==null?void 0:s.subscription)==null?void 0:_.planType;if(g===Ga.TAHWEELA||g===Ga.ZERO){i({title:"  ",description:"      .",variant:"destructive"});return}(w=e.state)!=null&&w.openInstallment||u("installment","openInstallment")},color:"#7C3AED"},{id:"maintenance",label:"",icon:$j,action:()=>{var g;a(!1),!((g=e.state)!=null&&g.openMaintenanceDialog)&&u("maintenance","openMaintenanceDialog")},color:"#0EA5E9"},{id:"credit-cards",label:" ",icon:fj,action:()=>{var g;a(!1),!((g=e.state)!=null&&g.openCreditCardsDialog)&&u("credit-cards","openCreditCardsDialog")},color:"#8B5CF6"},{id:"sales",label:"",icon:wb,action:()=>{var g;a(!1),!((g=e.state)!=null&&g.openSalesDialog)&&u("sales","openSalesDialog")},color:"#F59E0B"},{id:"shop-expenses",label:" ",icon:vb,action:()=>{var g;a(!1),!((g=e.state)!=null&&g.openShopExpensesDialog)&&u("shop-expenses","openShopExpensesDialog")},color:"#F97316"},{id:"deficiencies",label:"",icon:_k,action:()=>{var g;a(!1),!((g=e.state)!=null&&g.openDeficienciesDialog)&&u("deficiencies","openDeficienciesDialog")},color:"#DB2777"},{id:"branch-management",label:" ",icon:Lj,action:()=>{var g;a(!1),!((g=e.state)!=null&&g.openBranchManagement)&&u("branch-management","openBranchManagement")},color:"#14b8a6"},{id:"add-wallet",label:" ",icon:yb,action:()=>{a(!1),e.pathname!=="/user/add-wallet"&&t("/user/add-wallet")},color:"#EF4444"},{id:"cashier-shift",label:" ",icon:dj,action:()=>{var g;a(!1),!((g=e.state)!=null&&g.openCashierShiftModal)&&u("cashier-shift","openCashierShiftModal")},color:"#3B82F6"},{id:"contact",label:" ",icon:Sj,action:()=>{a(!1);const _=`   
  : ${(r==null?void 0:r.email)||" "}`,w=encodeURIComponent(_);window.open(`https://wa.me/201000392539?text=${w}`,"_blank")},color:"#10B981"},{id:"logout",label:" ",icon:gb,action:async()=>{a(!1);try{await n()}catch(g){console.error("Logout error:",g)}},color:"#EF4444"}],E=[{id:"shop-expenses-settings",label:" ",icon:vb,action:()=>{var g;c(!1),!((g=e.state)!=null&&g.openShopExpensesDialog)&&t("/user/dashboard",{state:{openShopExpensesDialog:!0}})},color:"#F97316"},{id:"profile-settings",label:"  ",icon:_b,action:()=>{c(!1),e.pathname.startsWith("/user/dashboard")?window.dispatchEvent(new CustomEvent("dashboard-navigation-action",{detail:{action:"profile-settings"}})):t("/user/dashboard",{state:{openProfileSettings:!0}})},color:"#6366F1"},{id:"logout",label:" ",icon:gb,action:async()=>{c(!1);try{await n()}catch(g){console.error("Logout error:",g)}},color:"#EF4444"}],p=(g,_,w,A)=>{var R;const L=((R=s==null?void 0:s.subscription)==null?void 0:R.planType)===Ga.TAHWEELA,x=C=>["/user/dashboard","/profile-settings"].includes(C),T=C=>C==="debts";if(w){if(L&&!T(A)&&!x(g)){i({title:"  ",description:"      .",variant:"destructive"});return}w()}else if(_&&g==="/add"){if(L){i({title:"  ",description:"      .",variant:"destructive"});return}a(!o)}else if(!_){if(L&&!x(g)){i({title:"  ",description:"      .",variant:"destructive"});return}if(e.pathname===g&&!w)return;t(g)}},I=g=>e.pathname===g;return v.jsxs("div",{className:"mobile-bottom-nav",children:[o&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"quick-actions-overlay",onClick:()=>a(!1)}),v.jsx("div",{className:"quick-actions-bottomsheet",children:v.jsx("div",{className:"quick-actions-grid",children:m.map((g,_)=>v.jsxs("button",{type:"button",className:"quick-action-tile",onClick:()=>{var A;if(((A=s==null?void 0:s.subscription)==null?void 0:A.planType)===Ga.TAHWEELA){i({title:"  ",description:"      .",variant:"destructive"});return}a(!1),g.action()},style:{"--action-color":g.color,"--animation-delay":"0s"},children:[v.jsx("div",{className:"quick-action-icon",children:v.jsx(g.icon,{className:"action-icon"})}),v.jsx("span",{className:"quick-action-label",children:g.label})]},g.id))})})]}),l&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"quick-actions-overlay",onClick:()=>c(!1)}),v.jsx("div",{className:"quick-actions-bottomsheet",children:v.jsx("div",{className:"quick-actions-grid",children:E.map((g,_)=>v.jsxs("button",{type:"button",className:"quick-action-tile",onClick:()=>{var P;const w=(P=s==null?void 0:s.subscription)==null?void 0:P.planType,A=new Set(["logout","profile-settings"]);if(w===Ga.TAHWEELA&&!A.has(g.id)){i({title:"  ",description:"      .",variant:"destructive"});return}c(!1),g.action()},style:{"--action-color":g.color,"--animation-delay":`${_*.06}s`},children:[v.jsx("div",{className:"quick-action-icon",children:v.jsx(g.icon,{className:"action-icon"})}),v.jsx("span",{className:"quick-action-label",children:g.label})]},g.id))})})]}),v.jsx("nav",{className:"mobile-bottom-nav-container",children:h.map(g=>{const _=g.icon,w=I(g.path);return v.jsxs("button",{onClick:()=>p(g.path,g.isSpecial,g.action,g.id),className:`mobile-nav-item ${w?"active":""} ${g.isSpecial?"special":""}`,type:"button","aria-label":g.label,style:{backgroundColor:"transparent"},children:[v.jsx("div",{className:`nav-icon-container ${g.isSpecial?"special-icon":""} ${g.isSpecial&&g.id==="add"&&o?"special-open":""}`,children:v.jsx(_,{className:`nav-icon ${w?"active-icon":""} ${g.isSpecial?"special-icon-svg":""} ${g.isSpecial&&g.id==="settings"&&l?"rotated":""}`})}),!g.isSpecial&&v.jsx("span",{className:`nav-label ${w?"active-label":""}`,children:g.label})]},g.id)})})]})};var fP,mP;const Ac=(mP=(fP=import.meta)==null?void 0:fP.env)==null?void 0:mP.VITE_ANDROID_DOWNLOAD_URL;var pP,gP;const xc=(gP=(pP=import.meta)==null?void 0:pP.env)==null?void 0:gP.VITE_PC_DOWNLOAD_URL;var yP,vP;const Rc=(vP=(yP=import.meta)==null?void 0:yP.env)==null?void 0:vP.VITE_PC32_DOWNLOAD_URL;var _P,wP;const Pc=(wP=(_P=import.meta)==null?void 0:_P.env)==null?void 0:wP.VITE_ANDROID_VERSION;var EP,IP;const Cc=(IP=(EP=import.meta)==null?void 0:EP.env)==null?void 0:IP.VITE_PC_VERSION;var TP,SP;const kc=(SP=(TP=import.meta)==null?void 0:TP.env)==null?void 0:SP.VITE_PC32_VERSION;function Gn(t){if(t)try{const n=(t.split("?")[0].split("#")[0].split("/").pop()||"").match(/v?(\d+\.\d+(?:\.\d+)?)/i);return n==null?void 0:n[1]}catch{return}}function sX(t){if(t&&ap(t)!==void 0)try{const e=t.match(/drive\.google\.com\/file\/d\/([^/]+)\//),n=t.match(/drive\.google\.com\/open\?id=([^&]+)/),r=(e==null?void 0:e[1])||(n==null?void 0:n[1]);return r?`https://drive.google.com/uc?export=download&id=${r}`:(/drive\.google\.com\/uc\?/.test(t),t)}catch{return t}}const Vu=["siteContent","appDownloads"],wg=["siteContent","desktop_updates"],Eg=["siteContent","android_updates"],hc="appDownloadsCache",iX=6*60*60*1e3,oX=["1LMXQdSVB3-gIW-89fwWoq113IIEelhxR"];function ap(t){if(t){for(const e of oX)if(t.includes(e))return;return t}}function Ya(t){return{...t,androidUrl:ap(t.androidUrl),pcUrl:ap(t.pcUrl),pc32Url:ap(t.pc32Url)}}function aX(){try{const e=localStorage.getItem(hc);if(e){const n=JSON.parse(e),r={androidUrl:(n==null?void 0:n.androidUrl)||Ac,pcUrl:(n==null?void 0:n.pcUrl)||xc,pc32Url:(n==null?void 0:n.pc32Url)||Rc,androidVersion:(n==null?void 0:n.androidVersion)||Pc,pcVersion:(n==null?void 0:n.pcVersion)||Cc,pc32Version:(n==null?void 0:n.pc32Version)||kc,updatedAt:n==null?void 0:n.updatedAt,updatedBy:n==null?void 0:n.updatedBy};return r.pcVersion||(r.pcVersion=Gn(r.pcUrl)),r.androidVersion||(r.androidVersion=Gn(r.androidUrl)),r.pc32Version||(r.pc32Version=Gn(r.pc32Url)),Ya(r)}}catch{}const t={androidUrl:Ac,pcUrl:xc,pc32Url:Rc,androidVersion:Pc,pcVersion:Cc,pc32Version:kc};return t.pcVersion||(t.pcVersion=Gn(t.pcUrl)),t.androidVersion||(t.androidVersion=Gn(t.androidUrl)),t.pc32Version||(t.pc32Version=Gn(t.pc32Url)),Ya(t)}async function ZM(t=!1){try{if(!t)try{const r=localStorage.getItem(hc),s=localStorage.getItem(hc+"_ts");if(r&&s&&Date.now()-Number(s)<iX){const o=JSON.parse(r);return Ya(o)}}catch{}const e=await Qt(Ce(G,Vu[0],Vu[1]));if(e.exists()){const r=e.data();try{localStorage.setItem(hc,JSON.stringify(r)),localStorage.setItem(hc+"_ts",String(Date.now()))}catch{}const s={androidUrl:(r==null?void 0:r.androidUrl)||Ac,pcUrl:(r==null?void 0:r.pcUrl)||xc,pc32Url:(r==null?void 0:r.pc32Url)||Rc,androidVersion:(r==null?void 0:r.androidVersion)||Pc,pcVersion:(r==null?void 0:r.pcVersion)||Cc,pc32Version:(r==null?void 0:r.pc32Version)||kc,updatedAt:r==null?void 0:r.updatedAt,updatedBy:r==null?void 0:r.updatedBy};return s.pcVersion||(s.pcVersion=Gn(s.pcUrl)),s.androidVersion||(s.androidVersion=Gn(s.androidUrl)),s.pc32Version||(s.pc32Version=Gn(s.pc32Url)),Ya(s)}const n={androidUrl:Ac,pcUrl:xc,pc32Url:Rc,androidVersion:Pc,pcVersion:Cc,pc32Version:kc};return n.pcVersion||(n.pcVersion=Gn(n.pcUrl)),n.androidVersion||(n.androidVersion=Gn(n.androidUrl)),n.pc32Version||(n.pc32Version=Gn(n.pc32Url)),Ya(n)}catch(e){const n=(e==null?void 0:e.message)||"";((e==null?void 0:e.code)||"")==="permission-denied"||n.includes("Missing or insufficient permissions")?console.warn(" Cannot read app downloads (unauth/public). Using cached or empty.",e):console.error(" Error loading app downloads:",e);try{const i=localStorage.getItem(hc);if(i){const o=JSON.parse(i),a={androidUrl:(o==null?void 0:o.androidUrl)||Ac,pcUrl:(o==null?void 0:o.pcUrl)||xc,pc32Url:(o==null?void 0:o.pc32Url)||Rc,androidVersion:(o==null?void 0:o.androidVersion)||Pc,pcVersion:(o==null?void 0:o.pcVersion)||Cc,pc32Version:(o==null?void 0:o.pc32Version)||kc,updatedAt:o==null?void 0:o.updatedAt,updatedBy:o==null?void 0:o.updatedBy};return a.pcVersion||(a.pcVersion=Gn(a.pcUrl)),a.androidVersion||(a.androidVersion=Gn(a.androidUrl)),a.pc32Version||(a.pc32Version=Gn(a.pc32Url)),Ya(a)}}catch{}const s={androidUrl:Ac,pcUrl:xc,pc32Url:Rc,androidVersion:Pc,pcVersion:Cc,pc32Version:kc};return s.pcVersion||(s.pcVersion=Gn(s.pcUrl)),s.androidVersion||(s.androidVersion=Gn(s.androidUrl)),s.pc32Version||(s.pc32Version=Gn(s.pc32Url)),Ya(s)}}function lX(t){return ZM().then(t),()=>{}}async function cX(t,e,n,r,s,i=12e4){const o=tM(),a=t.name.replace(/[^a-zA-Z0-9_.-]/g,"_"),l=`public/apps/${e}/${Date.now()}_${a}`,c=uY(o,l);return new Promise((u,h)=>{const f=lY(c,t);let m=!1;const E=setTimeout(()=>{m=!0;try{f.cancel()}catch{}h(new Error("Upload timed out"))},i);f.on("state_changed",p=>{const I=Math.round(p.bytesTransferred/p.totalBytes*100);s&&s(I)},p=>{clearTimeout(E),h(p)},async()=>{try{if(clearTimeout(E),m)return;const p=await cY(c),I={updatedAt:Le(),updatedBy:n||"admin"};e==="android"?(I.androidUrl=p,r&&(I.androidVersion=r)):e==="pc"?(I.pcUrl=p,r&&(I.pcVersion=r)):(I.pc32Url=p,r&&(I.pc32Version=r));const g=Math.min(Math.max(2e4,Math.floor(i/10)),6e4),_=on(Ce(G,Vu[0],Vu[1]),I,{merge:!0});let w=!1;const A=new Promise(P=>setTimeout(()=>{w=!0,P()},g));try{await Promise.race([_,A])}catch(P){console.warn(" Firestore write error, proceeding with URL only:",P)}w&&console.warn(" Firestore update timed out;             ."),u(p)}catch(p){h(p)}})})}async function uX(t,e){const n={};Object.entries(t||{}).forEach(([s,i])=>{i!==void 0&&(n[s]=i)});const r={...n,updatedAt:Le(),updatedBy:e||"admin"};await on(Ce(G,Vu[0],Vu[1]),r,{merge:!0})}async function dX(t,e){const n={};Object.entries(t||{}).forEach(([s,i])=>{i!==void 0&&(n[s]=i)});const r={...n,updatedAt:Le(),updatedBy:e||"admin"};await on(Ce(G,wg[0],wg[1]),r,{merge:!0})}async function eV(){try{try{const s=localStorage.getItem("desktop_update_cache");if(s){const i=JSON.parse(s)}}catch{}const t=Ce(G,wg[0],wg[1]),e=await Qt(t),n=(e.exists()?e.data():{})||{},r={version:n!=null&&n.version?String(n.version):void 0,downloadURL_64:n!=null&&n.downloadURL_64?String(n.downloadURL_64):void 0,downloadURL_32:n!=null&&n.downloadURL_32?String(n.downloadURL_32):void 0,notes:n!=null&&n.notes?String(n.notes):void 0};try{localStorage.setItem("desktop_update_cache",JSON.stringify(r))}catch{}return r}catch(t){console.warn("Error fetching desktop updates:",t);try{const e=localStorage.getItem("desktop_update_cache");if(e)return JSON.parse(e)}catch{}return{}}}function tV(t){return eV().then(t),()=>{}}function nV(t){try{const e=(typeof navigator<"u"?navigator.userAgent.toLowerCase():"")||"",n=e.includes("win64")||e.includes("x64")||e.includes("wow64")||e.includes("amd64"),r=e.includes("arm64");return String(n||r?(t==null?void 0:t.downloadURL_64)||(t==null?void 0:t.downloadURL_32)||"":(t==null?void 0:t.downloadURL_32)||(t==null?void 0:t.downloadURL_64)||"")}catch{return(t==null?void 0:t.downloadURL_64)||(t==null?void 0:t.downloadURL_32)}}async function hX(t,e){const n={};Object.entries(t||{}).forEach(([s,i])=>{i!==void 0&&(n[s]=i)});const r={...n,updatedAt:Le(),updatedBy:e||"admin"};await on(Ce(G,Eg[0],Eg[1]),r,{merge:!0})}async function rV(){try{const t=Ce(G,Eg[0],Eg[1]),e=await Qt(t),n=(e.exists()?e.data():{})||{},r={version:n!=null&&n.version?String(n.version):void 0,url:n!=null&&n.url?String(n.url):void 0,notes:n!=null&&n.notes?String(n.notes):void 0,force:!!(n!=null&&n.force),code:typeof(n==null?void 0:n.code)=="number"?n.code:typeof(n==null?void 0:n.versionCode)=="number"?n.versionCode:void 0};try{localStorage.setItem("android_update_cache",JSON.stringify(r))}catch{}return r}catch(t){console.warn("Error fetching android updates:",t);try{const e=localStorage.getItem("android_update_cache");if(e)return JSON.parse(e)}catch{}return{}}}function fX(t){return rV().then(t),()=>{}}const mX=Object.freeze(Object.defineProperty({__proto__:null,fetchAndroidUpdates:rV,fetchDesktopUpdates:eV,getAppDownloads:ZM,getCachedOrEnvAppDownloads:aX,listenAndroidUpdates:fX,listenAppDownloads:lX,listenDesktopUpdates:tV,resolveDownloadUrl:sX,selectDesktopUrl:nV,setAndroidUpdateInfo:hX,setAppDownloadLinks:uX,setDesktopUpdateInfo:dX,uploadAppBinaryResumable:cX},Symbol.toStringTag,{value:"Module"})),pX=()=>{const t=typeof window<"u"?window.electronAPI:void 0,e=!!t,[n,r]=F.useState(!1),[s,i]=F.useState(!1),[o,a]=F.useState(!1),[l,c]=F.useState(0),[u,h]=F.useState(""),[f,m]=F.useState(!1),E=async()=>{try{e&&t?await t.windowMinimize():console.info("windowMinimize (dev preview)")}catch(P){console.warn("failed to minimize",P)}},p=async()=>{try{e&&t?await t.windowClose():console.info("windowClose (dev preview)")}catch(P){console.warn("failed to close",P)}},I=async()=>{if(!f){m(!0);try{try{window.dispatchEvent(new CustomEvent("app:softRefresh"))}catch{}if(e&&t&&typeof t.windowReload=="function"){setTimeout(()=>{try{t.windowReload()}catch{}},50),setTimeout(()=>m(!1),600);return}try{window.location.reload()}catch{}}catch(P){console.warn("failed to soft refresh",P),m(!1)}}};if(F.useEffect(()=>{if(!(!e||!t))try{t.onUpdateAvailable(()=>r(!0)),t.onUpdateDownloaded(()=>r(!0)),typeof t.onUpdateError=="function"&&t.onUpdateError(()=>{a(!1)}),typeof t.onUpdateProgress=="function"&&t.onUpdateProgress(P=>{const L=(P==null?void 0:P.percent)==null?0:Number(P.percent);a(!0),c(Math.max(0,Math.min(100,isNaN(L)?0:L)))}),t.checkUpdate()}catch(P){console.warn("update init failed",P)}},[e,t]),F.useEffect(()=>{const P=tV(L=>{if(String((L==null?void 0:L.version)||"")){r(!0);const T=nV({downloadURL_64:L==null?void 0:L.downloadURL_64,downloadURL_32:L==null?void 0:L.downloadURL_32})||"";h(T)}});return()=>{try{P()}catch{}}},[]),!e)return null;const[_,w]=F.useState(!1),A=async()=>{try{if(!t)return;_?(typeof t.windowFullscreen=="function"&&await t.windowFullscreen(),w(!1)):(typeof t.windowWindowed=="function"&&await t.windowWindowed(),w(!0))}catch(P){console.warn("window toggle failed",P)}};return v.jsxs("div",{className:"fixed top-2 right-2 z-[2000] flex flex-col items-center gap-2",style:{pointerEvents:"auto"},children:[v.jsx("button",{type:"button","aria-label":"",title:"",onClick:p,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-red-600 hover:bg-red-500/10 focus:outline-none dark:text-red-400 dark:hover:bg-red-400/10",children:v.jsx(gE,{className:"w-5 h-5"})}),v.jsx("button",{type:"button","aria-label":"",title:" ",onClick:I,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-blue-600 hover:bg-blue-500/10 focus:outline-none dark:text-blue-400 dark:hover:bg-blue-400/10",children:v.jsx(pE,{className:`w-5 h-5 ${f?"animate-spin":""}`})}),v.jsx("button",{type:"button","aria-label":"",title:"",onClick:E,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-gray-800 hover:bg-black/10 focus:outline-none dark:text-white/80 dark:hover:bg-white/10",children:v.jsx(Aj,{className:"w-5 h-5"})}),v.jsx("button",{type:"button","aria-label":"/",title:_?"  ":"   ",onClick:A,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-gray-700 hover:bg-black/10 focus:outline-none dark:text-white/80 dark:hover:bg-white/10",children:v.jsx(Dj,{className:"w-5 h-5"})})]})},l0=({className:t=""})=>{var l,c;const n=typeof window<"u"&&window.location&&window.location.protocol==="file:"?"./":`${((c=(l=import.meta)==null?void 0:l.env)==null?void 0:c.BASE_URL)||"/"}`,[r,s]=S.useState(`${n}logo.svg`),[i,o]=S.useState(0),a=S.useCallback(()=>{o(u=>{const h=u+1;return h===1?s(`${n}logo.png`):h===2&&s(`${n}placeholder.svg`),h})},[]);return v.jsx("div",{className:`min-h-screen bg-background flex items-center justify-center ${t}`,children:v.jsxs("div",{className:"flex flex-col items-center justify-center",children:[v.jsx("img",{src:r,alt:"logo",onError:a,className:"w-16 h-16 animate-spin",style:{animationDuration:"0.6s"}}),v.jsx("p",{className:"mt-3 text-base font-extrabold text-primary tracking-wide animate-pulse",style:{fontFamily:"'Tajawal','Cairo',sans-serif"},children:"  "})]})})},gX=ld("SplashScreen",{web:()=>ne(()=>import("./web-BxVerx-G.js"),[],import.meta.url).then(t=>new t.SplashScreenWeb)});var c0;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(c0||(c0={}));var kR;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(kR||(kR={}));const t_=ld("StatusBar"),NR=ld("AppLauncher",{web:()=>ne(()=>import("./web-Dv7ckV1-.js"),[],import.meta.url).then(t=>new t.AppLauncherWeb)});function yX(t,e){if(!t||!t.trim())throw new Error("USSD code is required");const n=`tel:${t.replace(/#/g,"%23")}`,s=`cashy://ussd?code=${t.replace(/#/g,"%23")}${e?`&sim=${e}`:""}`;let i=!1;try{Ee&&Ee.getPlatform()!=="web"&&(NR.openUrl({url:s}),i=!0)}catch{}if(!i)try{window.location.href=s,i=!0}catch{}if(!i){try{window.location.href=n}catch{}try{Ee&&Ee.getPlatform()!=="web"&&NR.openUrl({url:n})}catch{}}}function sV(t,e){const n=String(t||"").replace(/\D/g,""),r=Math.round(Number(e||0));return!n||n.length!==11||!n.startsWith("01")||!r||r<=0?null:n.startsWith("010")?`*9*7*${n}*${r}#`:n.startsWith("011")?`*323*${n}*${r}#`:n.startsWith("012")?`*115*1*${n}*${r}#`:n.startsWith("015")?`*322*${n}*${r}#`:null}function vX(t,e,n){const r=String(t||"").replace(/\D/g,""),s=String(e||"").replace(/\D/g,""),i=Math.round(Number(n||0));return!s||s.length!==11||!s.startsWith("01")||!i||i<=0?null:!r||!r.startsWith("01")?sV(s,i):r.startsWith("010")?`*9*7*${s}*${i}#`:r.startsWith("011")?`*323*${s}*${i}#`:r.startsWith("012")?`*115*1*${s}*${i}#`:r.startsWith("015")?`*322*${s}*${i}#`:null}function AZ(t,e,n){const r=sV(t,e),s=String(n||"").replace(/\D/g,"");return!r||!s?r:`${r.endsWith("#")?r.slice(0,-1):r}*${s}#`}function _X(t){const e=String(t||"").replace(/\D/g,"");return e.startsWith("010")?"vodafone":e.startsWith("011")?"etisalat":e.startsWith("012")?"orange":e.startsWith("015")?"we":null}function wX(t){const e=_X(t),n=e?`simSlot_${e}`:"simSlot_default";try{if(localStorage.getItem(n)==="sim2")return"sim2"}catch{}return"sim1"}function xZ(t,e,n){const r=vX(t,e,n);if(!r)throw new Error("Unsupported network or invalid sender/receiver/amount");const s=wX(t||e);yX(r,s)}async function EX(t,e="Cashy"){if(!t||!t.trim())throw new Error("Notification message is required");try{if(typeof Notification<"u"&&(Notification.permission==="granted"?"granted":await Notification.requestPermission())==="granted"){new Notification(e||"Cashy",{body:t});return}typeof window<"u"&&typeof alert=="function"?alert(`${e||"Cashy"}
${t}`):console.log(`[${e||"Cashy"}] ${t}`)}catch(n){console.warn("Notification not available:",n)}}function ST(t,e){return e==="send"?0:Math.round(t*.01*100)/100}function IX(t,e,n=0){const r=ST(t,e),s=Math.max(0,r-n);return Math.round(s*100)/100}const nl=Object.freeze(Object.defineProperty({__proto__:null,calculateCommission:ST,calculateProfit:IX},Symbol.toStringTag,{value:"Module"})),TX=t=>t==="withdraw"||t==="receive"?"receive":"send",SX=async t=>{if(!t)return null;const e=Ve(ke(G,"transactions"),Oe("reference","==",t),id(1)),n=await Be(e);return n.empty?null:n.docs[0].id},bX=async t=>{var e;try{const n=await Qa.get({key:"selected_wallet_id"}),r=String((n==null?void 0:n.value)||"").trim();if(r)return r}catch{}return PX(t||((e=Ot.currentUser)==null?void 0:e.uid)||"")||null},n_=async t=>{try{const e=String(t||"").trim();if(!e)return null;const n=await zo.getByMsisdn(e);return(n==null?void 0:n.id)||null}catch{return null}},iV=async t=>{if(!t||!t.shopId||!t.lineId||!t.provider)throw new Error("   :   shopId  lineId  provider");if(!t.amount||t.amount<=0)throw new Error("     ");const e=await SX(t.reference);if(e)return{id:e,duplicate:!0};const n=TX(t.type);let r=t.walletId&&String(t.walletId).trim()?String(t.walletId).trim():"";if(!r){let o=await n_(t.receiverMsisdn);if(o||(o=await n_(t.senderMsisdn)),!o){const a=String(t.lineId||"").replace(/\D/g,"");a.length>=10&&(o=await n_(a))}r=o||await bX(t.createdBy)||""}if(!r)throw new Error("     ");const s={shopId:t.shopId,lineId:t.lineId,merchantUserId:t.merchantUserId||t.createdBy,walletId:r,provider:t.provider,txnType:n,originType:t.type,amount:t.amount,fee:void 0,commission:void 0,profit:0,reference:t.reference,senderMsisdn:t.senderMsisdn,receiverMsisdn:t.receiverMsisdn,note:t.note,status:"confirmed",createdBy:t.createdBy,createdAt:t.createdAt||new Date,confirmedAt:new Date},i=await fT.create(s);try{const o="  ",a=`: ${t.type} | : ${t.amount} | : ${t.provider}`;await EX(a,o)}catch(o){console.warn("   :",o)}try{const o=t.merchantUserId||t.createdBy;if(o){const a=n==="receive"?"withdraw":"send",l=ST(t.amount,n);await Xr.saveUserTransaction(o,{type:a,amount:t.amount,commission:l,status:"completed",createdAt:new Date,senderMsisdn:t.senderMsisdn,receiverMsisdn:t.receiverMsisdn,senderName:t.senderName,walletId:r,lineId:t.lineId,provider:t.provider,note:t.note,transactionId:i})}else console.warn("    :   userId (merchantUserId  createdBy)  .")}catch(o){console.warn("      userTransactions   :",o)}return{id:i,duplicate:!1}},lp=t=>{try{const e=String(t||"").replace(/[^0-9+]/g,"");if(!e)return"";if(e.startsWith("+20")){const n=e.slice(3);return n.startsWith("1")?"0"+n:n}if(e.startsWith("20")){const n=e.slice(2);return n.startsWith("1")?"0"+n:n}return e.startsWith("0")?e:/^(10|11|12|15)/.test(e)?"0"+e:e}catch{return""}},u0=async(t=[],e)=>{var n;try{try{console.log("identifyWalletBySim  input",t)}catch{}const r=e||((n=Ot.currentUser)==null?void 0:n.uid)||"default",s=Array.isArray(t)?t.map(p=>lp(p)).filter(p=>!!p):[],i=`wallets_${r}`,o=typeof localStorage<"u"?localStorage.getItem(i):null,a=o?JSON.parse(o):[],l=p=>String(p||"").replace(/\D/g,""),c=Array.isArray(a)?a.map(p=>({walletId:String((p==null?void 0:p.id)||""),msisdn:lp(String((p==null?void 0:p.phone)||(p==null?void 0:p.msisdn)||"")),isDefault:!!(p!=null&&p.isDefault)})).filter(p=>p.walletId&&p.msisdn):[],u=new Map;for(const p of s){const I=l(p);for(const g of c){const _=l(g.msisdn);if(g.msisdn===p){u.set(g.walletId,g.msisdn);continue}if(_.slice(-5)===I.slice(-5)){u.set(g.walletId,g.msisdn);continue}}}if(u.size===1){const[p,I]=Array.from(u.entries())[0];return{walletId:p,msisdn:I}}const f=(await zo.getByMerchantId(r)||[]).map(p=>({walletId:String((p==null?void 0:p.id)||""),msisdn:lp(String((p==null?void 0:p.msisdn)||"")),isDefault:!!(p!=null&&p.isDefault)})).filter(p=>p.walletId&&p.msisdn),m=[...c,...f],E=new Map;for(const p of s){const I=l(p);for(const g of m){const _=l(g.msisdn);if(g.msisdn===p){E.set(g.walletId,g.msisdn);continue}if(_.slice(-5)===I.slice(-5)){E.set(g.walletId,g.msisdn);continue}}}try{console.log("identifyWalletBySim  matched size",E.size)}catch{}if(E.size===1){const[p,I]=Array.from(E.entries())[0];try{console.log("identifyWalletBySim  unique match",{walletId:p,msisdn:I})}catch{}return{walletId:p,msisdn:I}}try{console.warn("identifyWalletBySim  no unique match")}catch{}return null}catch{return null}};async function AX(t,e){try{const n=i=>lp(String(i||"")),r=(e||[]).map(i=>({walletId:String(i.id||""),msisdn:n(String(i.msisdn||i.phone||"")),isDefault:!!i.isDefault})).filter(i=>i.walletId&&i.msisdn),s=i=>String(i||"").replace(/\D/g,"");for(const i of t||[]){const o=n(i),a=s(o),l=r.find(u=>u.msisdn===o);if(l)return{walletId:l.walletId,msisdn:l.msisdn};const c=r.find(u=>s(u.msisdn).slice(-5)===a.slice(-5));if(c)return{walletId:c.walletId,msisdn:c.msisdn}}return null}catch{return null}}async function xX(t){var e;try{const n=t.userId||((e=Ot.currentUser)==null?void 0:e.uid)||"default",r=Array.isArray(t.simNumbers)?t.simNumbers:[],s=await u0(r,n);if(s)return s;const i=`simWalletBindings_${n}`;let o={};try{const c=typeof localStorage<"u"?localStorage.getItem(i):null;o=c?JSON.parse(c):{}}catch{}const a=String(t.subId??""),l=String(t.slotIndex??"");if(a&&o[a]&&o[a].walletId)return{walletId:o[a].walletId,msisdn:String(o[a].msisdn||"")};if(l&&o[`slot_${l}`]&&o[`slot_${l}`].walletId)return{walletId:o[`slot_${l}`].walletId,msisdn:String(o[`slot_${l}`].msisdn||"")};if(t.slotIndex!==void 0&&t.slotIndex!==null&&t.slotIndex>=0){let c="";if(t.slotIndex===0?c=localStorage.getItem(`sim1Number_${n}`)||localStorage.getItem("sim1Number")||"":t.slotIndex===1&&(c=localStorage.getItem(`sim2Number_${n}`)||localStorage.getItem("sim2Number")||""),c){const u=await u0([c],n);if(u)return u}}return null}catch{return null}}function RX(t){var e;try{const r=`simWalletBindings_${t.userId||((e=Ot.currentUser)==null?void 0:e.uid)||"default"}`;let s={};try{const i=typeof localStorage<"u"?localStorage.getItem(r):null;s=i?JSON.parse(i):{}}catch{}t.subId!=null&&(s[String(t.subId)]={walletId:t.walletId,msisdn:t.msisdn||""}),t.slotIndex!=null&&(s[`slot_${String(t.slotIndex)}`]={walletId:t.walletId,msisdn:t.msisdn||""});try{typeof localStorage<"u"&&localStorage.setItem(r,JSON.stringify(s))}catch{}}catch{}}const PX=t=>{var e,n;try{const r=t||((e=Ot.currentUser)==null?void 0:e.uid)||"",s=Object.keys(localStorage),i=`selectedWallet_${r}`,o=`wallets_${r}`,a=s.find(c=>c.startsWith(i));if(a){const c=localStorage.getItem(a)||"";if(c)return c}const l=s.find(c=>c.startsWith(o));if(l){const c=localStorage.getItem(l)||"";if(c){const u=JSON.parse(c);if(Array.isArray(u)&&u.length>0){const h=u.find(f=>f==null?void 0:f.isDefault);return(h==null?void 0:h.id)||((n=u[0])==null?void 0:n.id)||null}}}}catch{}return null};function oV(){return typeof window>"u"?()=>{}:()=>{}}const Io=Object.freeze(Object.defineProperty({__proto__:null,bindSlotWalletMapping:RX,detectWalletFromSim:AX,identifyWalletBySim:u0,initMobileSmsBridge:oV,processMobileTransactionNotification:iV,resolveWalletBySimOrSlot:xX},Symbol.toStringTag,{value:"Module"})),CX=t=>{try{const e=t.match(/([0-9]+[.,]?[0-9]*)\s*(?:|EGP)?/);if(!e)return null;const n=e[1].replace(",",""),r=Number(n);return isNaN(r)?null:r}catch{return null}},kX=t=>{try{const e=t.match(/(01[0-9]{9})/);return e?e[1]:void 0}catch{return}},NX=()=>{var t,e;try{const n=((t=Ot.currentUser)==null?void 0:t.uid)||"default",r=Object.keys(localStorage).find(i=>i.startsWith(`selectedWallet_${n}`));if(r){const i=localStorage.getItem(r)||"";if(i)return i}const s=Object.keys(localStorage).find(i=>i.startsWith(`wallets_${n}`));if(s){const i=localStorage.getItem(s)||"";if(i){const o=JSON.parse(i);if(Array.isArray(o)&&o.length>0){const a=o.find(l=>l==null?void 0:l.isDefault);return(a==null?void 0:a.id)||((e=o[0])==null?void 0:e.id)||null}}}}catch{}return null},DX=()=>{var t;try{const e=((t=Ot.currentUser)==null?void 0:t.uid)||"",n=e?`selectedShopId_${e}`:"selectedShopId";return localStorage.getItem(n)||""||null}catch{return null}},r_=async(t,e)=>{var w;const n=String((t==null?void 0:t.text)||"").trim(),r=String((t==null?void 0:t.title)||"").trim(),s=String((t==null?void 0:t.packageName)||"").toLowerCase(),i=String((t==null?void 0:t.appName)||"").toLowerCase();if(!n||!(/vodafone|emeint|myservices/.test(s)||/vodafone|vf\-?cash||/.test(i)||/\s*\s*|\s*|\s*|ana\s*vodafone/i.test(n)))return;try{console.log("VF NOTIFICATION RECEIVED",t)}catch{}const a=/||/.test(n),l=/|/.test(n),c=CX(n),u=kX(n);if(!c||c<=0)return;const h=((w=Ot.currentUser)==null?void 0:w.uid)||"",f=NX()||void 0,m=DX()||"",E=f||"default-line";if(!h||!f||!m)return;try{const A=await RY(h);if((A==null?void 0:A.planType)===Ga.ZERO){console.log("Ignoring VF Notification for Zero Plan user");return}}catch{}const p=`${r}|${n}|${(t==null?void 0:t.postedAt)||Date.now()}`,I=`VF-${btoa(unescape(encodeURIComponent(p))).slice(0,24)}`,g=a?"withdraw":l?"transfer":"withdraw",_={type:g,amount:c,provider:"vodafone_cash",shopId:m,lineId:E,walletId:f,senderMsisdn:g==="transfer"&&u||void 0,receiverMsisdn:g==="withdraw"&&u||void 0,reference:I,createdBy:h,merchantUserId:h,note:"  "};try{await iV(_)}catch{}};let yo={};const ms={invalidateCache:t=>{const e=t||"default";delete yo[e]},async syncReportsDataFromFirebase(t){try{if(!t)return null;const e=await Xr.getUserData(t),n=e==null?void 0:e.reportsData;if(!n)return null;const r=`reportsData_${t}`,s=o=>{if(!o)return null;try{return o!=null&&o.toDate?o.toDate():new Date(o)}catch{return null}},i={lastDailyResetDate:s(n.lastDailyResetDate),lastMonthlyResetDate:s(n.lastMonthlyResetDate),hiddenDailyTransactionIds:Array.isArray(n.hiddenDailyTransactionIds)?n.hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:Array.isArray(n.hiddenMonthlyTransactionIds)?n.hiddenMonthlyTransactionIds:[],dailyProfit:Number(n.dailyProfit??0),monthlyProfit:Number(n.monthlyProfit??0),lastDailyProfitResetDate:s(n.lastDailyProfitResetDate),lastMonthlyProfitResetDate:s(n.lastMonthlyProfitResetDate)};try{localStorage.setItem(r,JSON.stringify(i))}catch{}return i}catch(e){return console.warn("     Firebase:",e),null}},shouldResetDailyReports:t=>{if(!t)return!0;const e=new Date,n=new Date(t);return e.toDateString()!==n.toDateString()},shouldResetMonthlyReports:t=>{if(!t)return!0;const e=new Date,n=new Date(t),r=e.getDate()===1,s=e.getMonth()!==n.getMonth()||e.getFullYear()!==n.getFullYear();return r&&s},autoResetReportsIfNeeded:t=>{try{const e=t?`reportsData_${t}`:"reportsData";let n=ms.getReportsData(t);const r=!1,s=!1;if(n.lastDailyResetDate||(n.lastDailyResetDate=new Date),n.lastDailyProfitResetDate||(n.lastDailyProfitResetDate=new Date),n.lastMonthlyResetDate||(n.lastMonthlyResetDate=new Date),n.lastMonthlyProfitResetDate||(n.lastMonthlyProfitResetDate=new Date),localStorage.setItem(e,JSON.stringify(n)),yo[t||"default"]=n,t)try{Xr.updateUserData(t,{reportsData:{...n}})}catch(i){console.warn("     Firebase   :",i)}return{dailyReset:r,monthlyReset:s}}catch(e){return console.error("    :",e),{dailyReset:!1,monthlyReset:!1}}},resetReportsManually:(t,e,n)=>{try{const r=n?`reportsData_${n}`:"reportsData",s=localStorage.getItem(r);let i={lastDailyResetDate:null,lastMonthlyResetDate:null,hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:[],dailyProfit:0,monthlyProfit:0,lastDailyProfitResetDate:null,lastMonthlyProfitResetDate:null};if(s){const a=JSON.parse(s);i={lastDailyResetDate:a.lastDailyResetDate?new Date(a.lastDailyResetDate):null,lastMonthlyResetDate:a.lastMonthlyResetDate?new Date(a.lastMonthlyResetDate):null,hiddenDailyTransactionIds:a.hiddenDailyTransactionIds||[],hiddenMonthlyTransactionIds:a.hiddenMonthlyTransactionIds||[],dailyProfit:a.dailyProfit||0,monthlyProfit:a.monthlyProfit||0,lastDailyProfitResetDate:a.lastDailyProfitResetDate?new Date(a.lastDailyProfitResetDate):null,lastMonthlyProfitResetDate:a.lastMonthlyProfitResetDate?new Date(a.lastMonthlyProfitResetDate):null}}let o=[];if(t==="daily"){const a=new Date().toDateString();o=e.filter(l=>new Date(l.createdAt).toDateString()===a).map(l=>l.id),i.hiddenDailyTransactionIds=[...new Set([...i.hiddenDailyTransactionIds,...o])],i.lastDailyResetDate=new Date,i.dailyProfit=0,i.lastDailyProfitResetDate=new Date}else{const a=new Date().getMonth(),l=new Date().getFullYear();o=e.filter(c=>{const u=new Date(c.createdAt);return u.getMonth()===a&&u.getFullYear()===l}).map(c=>c.id),i.hiddenMonthlyTransactionIds=[...new Set([...i.hiddenMonthlyTransactionIds,...o])],i.lastMonthlyResetDate=new Date,i.monthlyProfit=0,i.lastMonthlyProfitResetDate=new Date}if(localStorage.setItem(r,JSON.stringify(i)),yo[n||"default"]=i,n)try{Xr.updateUserData(n,{reportsData:{...i}})}catch(a){console.warn("     Firebase   :",a)}return console.log(`   ${t==="daily"?"":""} `),o}catch(r){return console.error("    :",r),[]}},getReportsData:t=>{try{const e=t||"default";if(yo[e])return{...yo[e]};const n=t?`reportsData_${t}`:"reportsData",r=localStorage.getItem(n);let s={lastDailyResetDate:null,lastMonthlyResetDate:null,hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:[],dailyProfit:0,monthlyProfit:0,lastDailyProfitResetDate:null,lastMonthlyProfitResetDate:null};if(r){const i=JSON.parse(r);s={lastDailyResetDate:i.lastDailyResetDate?new Date(i.lastDailyResetDate):null,lastMonthlyResetDate:i.lastMonthlyResetDate?new Date(i.lastMonthlyResetDate):null,hiddenDailyTransactionIds:i.hiddenDailyTransactionIds||[],hiddenMonthlyTransactionIds:i.hiddenMonthlyTransactionIds||[],dailyProfit:i.dailyProfit||0,monthlyProfit:i.monthlyProfit||0,lastDailyProfitResetDate:i.lastDailyProfitResetDate?new Date(i.lastDailyProfitResetDate):null,lastMonthlyProfitResetDate:i.lastMonthlyProfitResetDate?new Date(i.lastMonthlyProfitResetDate):null}}else if(t){const i=localStorage.getItem("reportsData");if(i)try{const o=JSON.parse(i);s={lastDailyResetDate:o.lastDailyResetDate?new Date(o.lastDailyResetDate):null,lastMonthlyResetDate:o.lastMonthlyResetDate?new Date(o.lastMonthlyResetDate):null,hiddenDailyTransactionIds:o.hiddenDailyTransactionIds||[],hiddenMonthlyTransactionIds:o.hiddenMonthlyTransactionIds||[],dailyProfit:o.dailyProfit||0,monthlyProfit:o.monthlyProfit||0,lastDailyProfitResetDate:o.lastDailyProfitResetDate?new Date(o.lastDailyProfitResetDate):null,lastMonthlyProfitResetDate:o.lastMonthlyProfitResetDate?new Date(o.lastMonthlyProfitResetDate):null},localStorage.setItem(n,JSON.stringify(s))}catch{}}return yo[e]=s,{...s}}catch(e){return console.error("    :",e),{lastDailyResetDate:null,lastMonthlyResetDate:null,hiddenDailyTransactionIds:[],hiddenMonthlyTransactionIds:[],dailyProfit:0,monthlyProfit:0,lastDailyProfitResetDate:null,lastMonthlyProfitResetDate:null}}},filterVisibleTransactions:(t,e,n)=>{try{const r=ms.getReportsData(n),s=e==="daily"?r.hiddenDailyTransactionIds:r.hiddenMonthlyTransactionIds;return t.filter(o=>!s.includes(o.id))}catch(r){return console.error("   :",r),t}},addProfit:(t,e,n)=>{try{const r=n?`reportsData_${n}`:"reportsData",s=ms.getReportsData(n);if(e==="daily"?s.dailyProfit+=t:s.monthlyProfit+=t,localStorage.setItem(r,JSON.stringify(s)),yo[n||"default"]=s,n)try{Xr.updateUserData(n,{reportsData:{...s}})}catch(i){console.warn("     Firebase:",i)}try{window.dispatchEvent(new CustomEvent("reportsUpdated",{detail:{userId:n,type:e,amount:t}}))}catch{}}catch(r){console.error("   :",r)}},getProfits:t=>{try{const e=ms.getReportsData(t);return{dailyProfit:e.dailyProfit,monthlyProfit:e.monthlyProfit}}catch(e){return console.error("   :",e),{dailyProfit:0,monthlyProfit:0}}},removeTransactionEffects:(t,e)=>{try{const n=e?`reportsData_${e}`:"reportsData",r=ms.getReportsData(e),s=new Date(t.createdAt),i=new Date,o=i.getMonth(),a=i.getFullYear(),l=ms.calculateTransactionProfit(t);if(s.toDateString()===i.toDateString()&&((r.hiddenDailyTransactionIds||[]).includes(t.id)||(r.dailyProfit=Math.round((r.dailyProfit-l)*100)/100,r.dailyProfit<0&&(r.dailyProfit=0))),s.getMonth()===o&&s.getFullYear()===a&&((r.hiddenMonthlyTransactionIds||[]).includes(t.id)||(r.monthlyProfit=Math.round((r.monthlyProfit-l)*100)/100,r.monthlyProfit<0&&(r.monthlyProfit=0))),localStorage.setItem(n,JSON.stringify(r)),yo[e||"default"]=r,e)try{Xr.updateUserData(e,{reportsData:{...r}})}catch(c){console.warn("      Firebase:",c)}}catch(n){console.error("      :",n)}},calculateTransactionProfit:t=>{const e=String((t==null?void 0:t.status)||"").toLowerCase();if(e&&e!=="completed"&&e!=="confirmed")return 0;const n=Number((t==null?void 0:t.fee)??0);if(t.commission!==void 0){const i=Math.max(0,Number(t.commission||0));return Math.round((i+Math.max(0,n))*100)/100}const r=String(t.type||"").toLowerCase(),s=r==="withdrawal"?"withdraw":r;if(s==="withdraw"||s==="receive"||s==="send"||s==="transfer"){const i=Math.round(Number(t.amount||0)*.01*100)/100;return Math.round((i+Math.max(0,n))*100)/100}return 0}},OX=ms,RZ=Object.freeze(Object.defineProperty({__proto__:null,ReportsService:OX,reportsService:ms},Symbol.toStringTag,{value:"Module"})),Ig={parseNum(t,e){if(typeof t=="number"&&Number.isFinite(t))return t;if(typeof t=="string"){const n=t.replace(/[^0-9.-]/g,""),r=parseFloat(n);return Number.isFinite(r)?r:e}return e},getCurrentDayId(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},async setLimits(t,e){var n;try{const r=Ce(G,"walletLimits",t),s={updatedAt:Le(),ownerId:(n=Ot.currentUser)==null?void 0:n.uid};return e.dailyTransferLimit!==void 0&&(s.dailyTransferLimit=e.dailyTransferLimit),e.dailyWithdrawLimit!==void 0&&(s.dailyWithdrawLimit=e.dailyWithdrawLimit),e.monthlyTransferLimit!==void 0&&(s.monthlyTransferLimit=e.monthlyTransferLimit),e.monthlyWithdrawLimit!==void 0&&(s.monthlyWithdrawLimit=e.monthlyWithdrawLimit),await on(r,s,{merge:!0}),await this.getWalletLimits(t)}catch(r){return console.error("    :",r),null}},getCurrentMonthId(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`},shouldResetDailyLimits(t){if(!t)return!0;const e=new Date,n=t.toDate();return e.getDate()!==n.getDate()||e.getMonth()!==n.getMonth()||e.getFullYear()!==n.getFullYear()},shouldResetMonthlyLimits(t){const e=new Date,n=e.getDate()===1;if(!t)return n;const r=t.toDate();return n&&(e.getMonth()!==r.getMonth()||e.getFullYear()!==r.getFullYear())},async getWalletLimits(t){var e;try{const n=Ce(G,"walletLimits",t);let r;try{r=await Qt(n)}catch(i){return console.error("     (     ):",i),null}if(r.exists()){const i=r.data();return{walletId:t,dailyTransferLimit:this.parseNum(i.dailyTransferLimit,6e4),dailyWithdrawLimit:this.parseNum(i.dailyWithdrawLimit,1e5),dailyTransferUsed:this.parseNum(i.dailyTransferUsed,0),dailyWithdrawUsed:this.parseNum(i.dailyWithdrawUsed,0),lastDailyReset:i.lastDailyReset||null,monthlyTransferLimit:this.parseNum(i.monthlyTransferLimit,2e5),monthlyWithdrawLimit:this.parseNum(i.monthlyWithdrawLimit,2e5),monthlyTransferUsed:this.parseNum(i.monthlyTransferUsed,0),monthlyWithdrawUsed:this.parseNum(i.monthlyWithdrawUsed,0),lastMonthlyReset:i.lastMonthlyReset||null,updatedAt:i.updatedAt||_t.now()}}const s={walletId:t,dailyTransferLimit:6e4,dailyWithdrawLimit:1e5,dailyTransferUsed:0,dailyWithdrawUsed:0,lastDailyReset:null,monthlyTransferLimit:2e5,monthlyWithdrawLimit:2e5,monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:null,updatedAt:_t.now()};return await on(n,{dailyTransferLimit:6e4,dailyWithdrawLimit:1e5,dailyTransferUsed:0,dailyWithdrawUsed:0,lastDailyReset:null,monthlyTransferLimit:2e5,monthlyWithdrawLimit:2e5,monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:null,updatedAt:Le(),ownerId:(e=Ot.currentUser)==null?void 0:e.uid}),s}catch(n){return console.error("     :",n),null}},async resetDailyLimits(t){var e;try{const n=Ce(G,"walletLimits",t);return await on(n,{dailyTransferUsed:0,dailyWithdrawUsed:0,lastDailyReset:Le(),updatedAt:Le(),ownerId:(e=Ot.currentUser)==null?void 0:e.uid},{merge:!0}),console.log(`       ${t}`),!0}catch(n){return console.error("     :",n),!1}},async resetMonthlyLimits(t){var e;try{const n=Ce(G,"walletLimits",t);return await on(n,{monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastMonthlyReset:Le(),updatedAt:Le(),ownerId:(e=Ot.currentUser)==null?void 0:e.uid},{merge:!0}),console.log(`       ${t}`),!0}catch(n){return console.error("     :",n),!1}},async autoResetLimitsIfNeeded(t){try{const e=await this.getWalletLimits(t);if(!e)return null;let n=!1;return this.shouldResetDailyLimits(e.lastDailyReset)&&(await this.resetDailyLimits(t),n=!0),this.shouldResetMonthlyLimits(e.lastMonthlyReset)&&(await this.resetMonthlyLimits(t),n=!0),n?await this.getWalletLimits(t):e}catch(e){return console.error("     :",e),null}},async canPerformOperation(t,e,n){try{const r=await this.autoResetLimitsIfNeeded(t);if(!r)return{canPerform:!1,message:"      "};if(n==="transfer"){const s=Math.max(0,this.parseNum(r.dailyTransferLimit,6e4)-this.parseNum(r.dailyTransferUsed,0));if(e>s)return{canPerform:!1,message:`   . : ${s.toLocaleString()} .   ${r.dailyTransferLimit.toLocaleString()} .`,dailyRemaining:s,limitType:"daily"};const i=Math.max(0,this.parseNum(r.monthlyTransferLimit,2e5)-this.parseNum(r.monthlyTransferUsed,0));return e>i?{canPerform:!1,message:`   . : ${i.toLocaleString()} .   ${r.monthlyTransferLimit.toLocaleString()} .`,monthlyRemaining:i,limitType:"monthly"}:{canPerform:!0,dailyRemaining:Math.max(0,s-e),monthlyRemaining:Math.max(0,i-e)}}if(n==="withdraw"){const s=Math.max(0,this.parseNum(r.dailyWithdrawLimit,1e5)-this.parseNum(r.dailyWithdrawUsed,0));if(e>s)return{canPerform:!1,message:`   . : ${s.toLocaleString()} .   ${r.dailyWithdrawLimit.toLocaleString()} .`,dailyRemaining:s,limitType:"daily"};const i=Math.max(0,this.parseNum(r.monthlyWithdrawLimit,2e5)-this.parseNum(r.monthlyWithdrawUsed,0));return e>i?{canPerform:!1,message:`   . : ${i.toLocaleString()} .   ${r.monthlyWithdrawLimit.toLocaleString()} .`,monthlyRemaining:i,limitType:"monthly"}:{canPerform:!0,dailyRemaining:Math.max(0,s-e),monthlyRemaining:Math.max(0,i-e)}}return{canPerform:!1,message:"   "}}catch(r){return console.error("      :",r),{canPerform:!1,message:"    "}}},async updateUsage(t,e,n){try{const r=await this.canPerformOperation(t,e,n);if(!r.canPerform)throw new Error(r.message||"   ");const s=Ce(G,"walletLimits",t),i=await this.getWalletLimits(t);if(!i)throw new Error("      ");const o={updatedAt:Le()};return n==="transfer"?(o.dailyTransferUsed=i.dailyTransferUsed+e,o.monthlyTransferUsed=i.monthlyTransferUsed+e):n==="withdraw"&&(o.dailyWithdrawUsed=i.dailyWithdrawUsed+e,o.monthlyWithdrawUsed=i.monthlyWithdrawUsed+e),await on(s,{...o},{merge:!0}),await this.getWalletLimits(t)}catch(r){throw console.error("    :",r),r}},async rollbackUsage(t,e,n,r){try{const s=Ce(G,"walletLimits",t),i=await this.getWalletLimits(t);if(!i)throw new Error("      ");const o={updatedAt:Le()},a=new Date,l=r?new Date(r):a,c=l.getDate()===a.getDate()&&l.getMonth()===a.getMonth()&&l.getFullYear()===a.getFullYear(),u=l.getMonth()===a.getMonth()&&l.getFullYear()===a.getFullYear();return n==="transfer"?(c&&(o.dailyTransferUsed=Math.max(0,(i.dailyTransferUsed||0)-e)),u&&(o.monthlyTransferUsed=Math.max(0,(i.monthlyTransferUsed||0)-e))):(c&&(o.dailyWithdrawUsed=Math.max(0,(i.dailyWithdrawUsed||0)-e)),u&&(o.monthlyWithdrawUsed=Math.max(0,(i.monthlyWithdrawUsed||0)-e))),Object.keys(o).length<=1?i:(await on(s,{...o},{merge:!0}),await this.getWalletLimits(t))}catch(s){throw console.error("      :",s),s}},calculateRemaining(t){return{dailyTransferRemaining:Math.max(0,t.dailyTransferLimit-t.dailyTransferUsed),dailyWithdrawRemaining:Math.max(0,t.dailyWithdrawLimit-t.dailyWithdrawUsed),monthlyTransferRemaining:Math.max(0,t.monthlyTransferLimit-t.monthlyTransferUsed),monthlyWithdrawRemaining:Math.max(0,t.monthlyWithdrawLimit-t.monthlyWithdrawUsed)}},async resetAllLimits(t){var e;try{const n=Ce(G,"walletLimits",t);return await on(n,{dailyTransferUsed:0,dailyWithdrawUsed:0,monthlyTransferUsed:0,monthlyWithdrawUsed:0,lastDailyReset:Le(),lastMonthlyReset:Le(),updatedAt:Le(),ownerId:(e=Ot.currentUser)==null?void 0:e.uid},{merge:!0}),console.log(`       ${t}`),await this.getWalletLimits(t)}catch(n){return console.error("     :",n),null}}},d0=Object.freeze(Object.defineProperty({__proto__:null,default:Ig,walletDailyLimitsService:Ig},Symbol.toStringTag,{value:"Module"}));class LX{constructor(){pd(this,"intervalId",null);pd(this,"isRunning",!1)}start(){if(this.isRunning){console.log(" ReportsResetScheduler  ");return}this.isRunning=!0;try{const e=()=>{const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1,0,0,0,0),s=Math.max(1e3,r.getTime()-n.getTime());this.intervalId=setTimeout(async()=>{await this.runResetSafely(),e()},s)};e(),console.log("        ")}catch{console.log("   ")}}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.isRunning=!1,console.log("     ")}async runResetSafely(){var e;try{const n=(e=Ot.currentUser)==null?void 0:e.uid;if(!n){console.log("          ");return}const s=new Date().toISOString().slice(0,10),i=await i0.getToday(n);await i0.saveToHistory(n,s,i||{}),console.log("      :",s),await this.archivePreviousDayIfNeeded(n),await this.resetUserWalletLimits(n)}catch(n){console.error("     :",n)}}async archivePreviousDayIfNeeded(e){try{await ms.syncReportsDataFromFirebase(e);const n=ms.getReportsData(e);if(!n.lastDailyResetDate||!ms.shouldResetDailyReports(n.lastDailyResetDate))return;const s=new Date,i=new Date(s.getFullYear(),s.getMonth(),s.getDate()-1),o=i.toDateString(),a=await Xr.getUserTransactions(e),l=_=>{const w=String(_||"").toLowerCase();return["completed","confirmed","success"].includes(w)?"completed":["failed","error"].includes(w)?"failed":["cancelled","canceled"].includes(w)?"cancelled":"pending"},c=(a||[]).filter(_=>{var A,P;const w=(A=_==null?void 0:_.createdAt)!=null&&A.toDate?_.createdAt.toDate():(_==null?void 0:_.createdAt)instanceof Date?_.createdAt:new Date(_==null?void 0:_.createdAt);return((P=w==null?void 0:w.toDateString)==null?void 0:P.call(w))===o&&l(_==null?void 0:_.status)==="completed"}),u=c.length,h=c.reduce((_,w)=>_+Number(w.amount||0),0),f=_=>{const w=String(((_==null?void 0:_.type)??(_==null?void 0:_.txnType))||"").toLowerCase();return w==="withdraw"||w==="withdrawal"||w==="receive"},m=_=>{const w=String(((_==null?void 0:_.type)??(_==null?void 0:_.txnType))||"").toLowerCase();return w==="send"||w==="transfer"},E=c.filter(f).reduce((_,w)=>{const A=w.withdrawnAmount!==void 0?Number(w.withdrawnAmount):Number(w.amount||0);return _+A},0),p=c.filter(m).reduce((_,w)=>{const A=w.sentAmount!==void 0?Number(w.sentAmount):Number(w.amount||0);return _+A},0),I=c.reduce((_,w)=>_+Number(ms.calculateTransactionProfit(w)||0),0),g=new Date(i).toISOString().slice(0,10);await oM.add({userId:e,reportDate:g,totalTransactions:u,totalAmount:Number(h.toFixed(2)),totalWithdrawn:Number(E.toFixed(2)),totalSent:Number(p.toFixed(2)),profit:Number(I.toFixed(2)),walletId:null}),console.log("    :",g)}catch(n){console.warn("      :",n)}}async resetUserWalletLimits(e){try{const n=await zo.getByMerchantId(e),r=new Date().getDate()===1;for(const s of n){const i=String((s==null?void 0:s.id)||"");if(i){try{await Ig.resetDailyLimits(i)}catch{}if(r)try{await Ig.resetMonthlyLimits(i)}catch{}}}console.log("     "+(r?" ":""))}catch(n){console.warn("    :",n)}}}const DR=new LX,s_=768;function MX(){const[t,e]=S.useState(void 0);return S.useEffect(()=>{const n=window.matchMedia(`(max-width: ${s_-1}px)`),r=()=>{e(window.innerWidth<s_)};return n.addEventListener("change",r),e(window.innerWidth<s_),()=>n.removeEventListener("change",r)},[]),!!t}function VX(){const[t,e]=S.useState("default"),[n,r]=S.useState(!1);return S.useEffect(()=>{try{const i=localStorage.getItem("notificationPermission");(i==="granted"||i==="denied"||i==="default")&&e(i);const o=localStorage.getItem("notificationConsentRequested")==="true";r(o)}catch{}},[]),{permission:t,hasRequested:n,requestConsent:async()=>{if(typeof window<"u"&&"Notification"in window){const i=await Notification.requestPermission();e(i);try{localStorage.setItem("notificationPermission",i),localStorage.setItem("notificationConsentRequested","true"),r(!0)}catch{}return i}return"unsupported"}}}const aV=S.createContext(void 0);function FX({children:t}){const{profile:e,user:n,loading:r}=Ws(),[s,i]=S.useState(null),[o,a]=S.useState(null),[l,c]=S.useState(!0);S.useEffect(()=>{if(!r&&e){const h=e!=null&&e.userId?`selectedShopId_${e.userId}`:n!=null&&n.uid?`selectedShopId_${n==null?void 0:n.uid}`:"selectedShopId";let f=null;try{f=localStorage.getItem(h)||null}catch{}i(f||e.shopId),a((e==null?void 0:e.shopName)||(n==null?void 0:n.displayName)||""),c(!1)}else r||c(!1)},[e,r]),S.useEffect(()=>{const h=()=>{const m=e!=null&&e.userId?`selectedShopId_${e.userId}`:n!=null&&n.uid?`selectedShopId_${n==null?void 0:n.uid}`:"selectedShopId";try{const E=localStorage.getItem(m);i(E||((e==null?void 0:e.shopId)??null))}catch{}};window.addEventListener("selectedShopIdChanged",h);const f=m=>{const E=e!=null&&e.userId?`selectedShopId_${e.userId}`:n!=null&&n.uid?`selectedShopId_${n==null?void 0:n.uid}`:"selectedShopId";if(!(!m.key||m.key!==E))try{const p=localStorage.getItem(E);i(p||((e==null?void 0:e.shopId)??null))}catch{}};return window.addEventListener("storage",f),()=>{window.removeEventListener("selectedShopIdChanged",h),window.removeEventListener("storage",f)}},[e==null?void 0:e.userId,n==null?void 0:n.uid,e==null?void 0:e.shopId]);const u={shopId:s,shopName:o,loading:l};return v.jsx(aV.Provider,{value:u,children:t})}function UX(){const t=S.useContext(aV);return t===void 0?{shopId:null,shopName:null,loading:!1}:t}const jX={},OR=F.lazy(()=>ne(()=>import("./Index-CSkM_e6U.js"),[],import.meta.url)),Am=F.lazy(()=>ne(()=>import("./LandingPage-DVTyL0Q1.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),LR=F.lazy(()=>ne(()=>import("./SubscriptionsPage-wgWSpbRi.js"),__vite__mapDeps([8,2,9,10,3,11,12,6]),import.meta.url)),MR=F.lazy(()=>ne(()=>import("./AuthPage-C2hVCyqS.js"),__vite__mapDeps([13,1,14]),import.meta.url)),xm=F.lazy(()=>ne(()=>import("./TopUpPage-_OcaxJsU.js"),__vite__mapDeps([15,16]),import.meta.url)),VR=F.lazy(()=>ne(()=>import("./AdminTopupsPage-DfYFQ7LF.js"),__vite__mapDeps([17,16]),import.meta.url)),FR=F.lazy(()=>ne(()=>import("./AdminNotificationsPage-DkwwwvJV.js"),__vite__mapDeps([18,19,20,21]),import.meta.url)),Rm=F.lazy(()=>ne(()=>import("./UserRegisterPage-NTjUFk9l.js"),__vite__mapDeps([22,23,24,25,26]),import.meta.url)),UR=F.lazy(()=>ne(()=>import("./UserAccountSetupPage-VcbTq3Yn.js"),__vite__mapDeps([27,23,26,6]),import.meta.url)),jR=F.lazy(()=>ne(()=>import("./ForgotPasswordCodePage-CmIRdCUT.js"),[],import.meta.url)),$R=F.lazy(()=>ne(()=>import("./DashboardLoginPage-DnIYfChc.js"),[],import.meta.url)),BR=F.lazy(()=>ne(()=>import("./ProtectedDashboard-CyOIfrl1.js"),__vite__mapDeps([28,16,29,30,31,32,24,33]),import.meta.url)),cp=F.lazy(()=>ne(()=>import("./ProtectedUserDashboard-Bw0jIEWh.js"),__vite__mapDeps([34,35,21,29,30]),import.meta.url)),zR=F.lazy(()=>ne(()=>import("./MerchantDashboard-hXK39CCT.js"),__vite__mapDeps([36,37,16,38,39,40,41,42,19,43,44,24,11,45,14,46]),import.meta.url)),WR=F.lazy(()=>ne(()=>import("./PendingApprovalPage-BjLJ_DJk.js"),__vite__mapDeps([47,48]),import.meta.url)),qR=F.lazy(()=>ne(()=>import("./AdminLogin-DJpQ8_bQ.js"),[],import.meta.url)),HR=F.lazy(()=>ne(()=>import("./ProtectedAdminDashboard-DQVforqD.js"),__vite__mapDeps([49,9,50,37,16,38,29,30,51,48,19,23,39,52,2,53,26,45,54,35,20,10,5,7,6,55,56,57,46,58,1,59,14,60,61]),import.meta.url)),KR=F.lazy(()=>ne(()=>import("./AuthTestPage-BezjdZu6.js"),[],import.meta.url)),GR=F.lazy(()=>ne(()=>import("./ProfileSettingsPage-JYQlk0op.js").then(t=>t.b),__vite__mapDeps([62,51,29,30,45,19,16,32,58,60,46,6,7,53,11]),import.meta.url)),QR=F.lazy(()=>ne(()=>import("./TransactionsPage-CbJ7dIg_.js"),__vite__mapDeps([63,16,39,56,38,64,65,52,29,30,2,43,46,6,44,14,66,10,67,41,61,68,31,53,32,33,11,57,60]),import.meta.url)),YR=F.lazy(()=>ne(()=>import("./WalletAdditionPage-CPGGosBb.js"),__vite__mapDeps([69,16,11,24,26,30]),import.meta.url)),JR=F.lazy(()=>ne(()=>import("./ReferralsPage-C-HZF4Rl.js"),__vite__mapDeps([70,39,23,25,21,6,54,58,60]),import.meta.url)),XR=F.lazy(()=>ne(()=>import("./NotFound-CAi-BKNa.js"),[],import.meta.url)),ZR=F.lazy(()=>ne(()=>import("./PrivacyPolicyPage-bNwK29Sz.js"),[],import.meta.url)),Ja=new x6({defaultOptions:{queries:{gcTime:3e5}}});if(typeof window<"u")try{const t=D6({storage:window.localStorage,key:"cashylink:rq-cache",throttleTime:1e3});N6({queryClient:Ja,persister:t,maxAge:24*60*60*1e3})}catch{}const $X=()=>{if(!((Ee==null?void 0:Ee.isNativePlatform)&&Ee.getPlatform()==="android"))return null;const e=()=>{try{window.location.reload()}catch{}};return v.jsx("div",{className:"fixed top-2 right-2 z-[2000] flex items-center gap-2",style:{pointerEvents:"auto"},children:v.jsx("button",{type:"button","aria-label":"",title:" ",onClick:e,className:"inline-flex items-center justify-center w-9 h-9 rounded-md bg-transparent text-blue-600 hover:bg-blue-500/10 focus:outline-none dark:text-blue-400 dark:hover:bg-blue-400/10",children:v.jsx(pE,{className:"w-5 h-5"})})})},eP=()=>{const t=wi(),{user:e,loading:n}=Ws(),r=(Ee==null?void 0:Ee.isNativePlatform)&&Ee.getPlatform()==="android",s=t.pathname.startsWith("/user/dashboard"),i=r&&t.pathname==="/",o=!!e&&(s||i);return n?null:o?v.jsx(rX,{}):null},BX=(t,e)=>{try{const n=String(e||"").toLowerCase(),r=String(t||"").toLowerCase();return!!(n.includes("vf-cash")||n.includes("vodafone")||n.includes("vfcash")||/\s*/i.test(t)||r.includes("vodafone cash"))}catch{return!1}},i_=async t=>{try{const e=String(localStorage.getItem(`selectedWallet_${t}`)||"").trim();if(!e)return"";const{merchantWalletService:n}=await ne(async()=>{const{merchantWalletService:c}=await Promise.resolve().then(()=>Io);return{merchantWalletService:c}},void 0,import.meta.url),r=await n.getByMerchantId(t),s=localStorage.getItem(`wallets_${t}`),i=s?JSON.parse(s):[],a=[...Array.isArray(i)?i:[],...Array.isArray(r)?r:[]].find(c=>String((c==null?void 0:c.id)||"")===e);return String((a==null?void 0:a.msisdn)||(a==null?void 0:a.phone)||"")}catch{return""}},zX=async t=>{var e;try{const n=Object.keys(localStorage),r=`selectedWallet_${t}`,s=`wallets_${t}`,i=n.find(h=>h.startsWith(r));if(i){const h=localStorage.getItem(i)||"";if(h)return h}const{merchantWalletService:o}=await ne(async()=>{const{merchantWalletService:h}=await Promise.resolve().then(()=>Io);return{merchantWalletService:h}},void 0,import.meta.url),a=await o.getByMerchantId(t),l=localStorage.getItem(s),c=l?JSON.parse(l):[],u=[...Array.isArray(c)?c:[],...Array.isArray(a)?a:[]];if(u.length>0){const h=u.find(m=>!!(m!=null&&m.isDefault)),f=String(((h==null?void 0:h.id)??((e=u[0])==null?void 0:e.id))||"").trim();if(f)return f}}catch{}return""},tP=()=>{var tr;const t=MX(),e=(Ee==null?void 0:Ee.isNativePlatform)&&Ee.getPlatform()==="android",{profile:n,user:r}=Ws(),{shopId:s}=UX(),i=wi(),o=(Ee==null?void 0:Ee.isNativePlatform)&&Ee.getPlatform()==="android"&&i.pathname==="/"&&!!r;F.useEffect(()=>{(async()=>{if(Ee.isNativePlatform())try{await t_.setOverlaysWebView({overlay:!1}),await t_.setStyle({style:c0.Dark}),Ee.getPlatform()==="android"&&await t_.setBackgroundColor({color:"#000000"})}catch(z){console.warn("StatusBar config failed",z)}})()},[]),F.useEffect(()=>{const K=window.electronAPI;if(K){try{const z=localStorage.getItem("adbSmsReadingEnabled")==="true";K.toggleAdbSms&&K.toggleAdbSms(z)}catch{}K.onAdbSmsReceived&&K.onAdbSmsReceived(z=>{console.log("[App] ADB SMS Received:",z);const H={text:z.text,sender:z.sender,msisdn:z.sender,receivedAt:Date.now()};window.dispatchEvent(new CustomEvent("mobileSmsReceived",{detail:H}))})}},[]);const a=i.pathname.startsWith("/user/login")||i.pathname.startsWith("/auth")||i.pathname.startsWith("/landing")||i.pathname==="/"&&!o&&!r,l=!!r&&!a||i.pathname.startsWith("/user/dashboard")||o;F.useEffect(()=>{r&&console.log("Dashboard State Check:",{path:i.pathname,isUserDashboard:l,isAuthOrLanding:a,userUid:r.uid})},[i.pathname,l,r]);const c=jl(),{toast:u}=lE(),[h,f]=F.useState(!1),[m,E]=F.useState(null),[p,I]=F.useState(!1),[g,_]=F.useState(null),[w,A]=F.useState(!1),[P,L]=F.useState(""),[x,T]=F.useState(""),[R,C]=F.useState(null),[D,O]=F.useState(null),k=F.useRef(null),B=F.useRef(null),ce=F.useRef(!1),he=F.useRef(null),Se=F.useRef(""),$=F.useRef(""),q=F.useRef(new Set);F.useEffect(()=>{try{const K=localStorage.getItem("sms_suppressed_ids")||"[]",z=Array.isArray(JSON.parse(K))?JSON.parse(K):[];q.current=new Set(z.map(H=>String(H||"")))}catch{}},[]);const[X,we]=F.useState(!1),Ie=F.useRef(n);F.useEffect(()=>{Ie.current=n},[n]),VX(),F.useEffect(()=>{(async()=>{if(e)try{localStorage.getItem("hasCheckedNotificationPermission_v1")||localStorage.setItem("hasCheckedNotificationPermission_v1","true")}catch{}})();const z=H=>{};return window.addEventListener("notificationListenerStatus",z),()=>window.removeEventListener("notificationListenerStatus",z)},[u,e]),F.useEffect(()=>{if(!r)return;let K;return(async()=>{try{const{collection:H,query:ie,where:Z,onSnapshot:te}=await ne(async()=>{const{collection:Q,query:oe,where:se,onSnapshot:ae}=await Promise.resolve().then(()=>Mn);return{collection:Q,query:oe,where:se,onSnapshot:ae}},void 0,import.meta.url),{db:de}=await ne(async()=>{const{db:Q}=await Promise.resolve().then(()=>qt);return{db:Q}},void 0,import.meta.url),ye=ie(H(de,"pendingSmsPopups"),Z("userId","==",r.uid),Z("status","==","pending"));K=te(ye,Q=>{Q.docChanges().forEach(oe=>{var se,ae;if(oe.type==="added"){if(oe.doc.metadata.hasPendingWrites)return;const ue=oe.doc.data(),_e=((ae=(se=ue.createdAt)==null?void 0:se.toMillis)==null?void 0:ae.call(se))||Date.now();if(Date.now()-_e>5*60*1e3)return;const me=ue.payload;if(me){if(me.popupId&&q.current.has(me.popupId))return;Ge({...me,popupId:oe.doc.id}),ve(!0);try{ro()}catch{}}}else oe.type==="modified"?oe.doc.data().status!=="pending"&&Ge(_e=>(_e==null?void 0:_e.popupId)===oe.doc.id?(ve(!1),null):_e):oe.type==="removed"&&Ge(ue=>(ue==null?void 0:ue.popupId)===oe.doc.id?(ve(!1),null):ue)})})}catch(H){console.error("Error setting up popup listener:",H)}})(),()=>{K&&K()}},[r]);const[re,ve]=F.useState(!1),[j,Ge]=F.useState(null),[Fe,Pn]=F.useState(""),[zn,En]=F.useState(!1),[In,Cn]=F.useState(!1),[kt,ft]=F.useState(""),[at,cr]=F.useState(""),[_r,Wn]=F.useState(!1),[mt,Zt]=F.useState(0),[wr,no]=F.useState(!1),[Pr,Ca]=F.useState(""),[ws,kn]=F.useState("");F.useEffect(()=>{try{const K=(r==null?void 0:r.uid)||"default",z=localStorage.getItem(`sim1Number_${K}`)??localStorage.getItem("sim1Number")??"",H=localStorage.getItem(`sim2Number_${K}`)??localStorage.getItem("sim2Number")??"";Ca(z),kn(H),Se.current=z,$.current=H}catch{}},[r==null?void 0:r.uid]);const cs=async(K,z)=>{if(!(!K||!j))try{const{resolveWalletBySimOrSlot:H,merchantWalletService:ie,detectWalletFromSim:Z}=await ne(async()=>{const{resolveWalletBySimOrSlot:ye,merchantWalletService:Q,detectWalletFromSim:oe}=await Promise.resolve().then(()=>Io);return{resolveWalletBySimOrSlot:ye,merchantWalletService:Q,detectWalletFromSim:oe}},void 0,import.meta.url),te=(r==null?void 0:r.uid)||"";Ge(ye=>ye?{...ye,simNumber:K,simLabel:z}:null);let de=await H({simNumbers:[K],userId:te});if(!de||!de.walletId)try{const ye=await ie.getByMerchantId(te),Q=localStorage.getItem(`wallets_${te}`),oe=Q?JSON.parse(Q):[],se=(Array.isArray(oe)?oe:[]).map(me=>({id:String((me==null?void 0:me.id)||""),phone:String((me==null?void 0:me.phone)||(me==null?void 0:me.msisdn)||""),isDefault:!!(me!=null&&me.isDefault)})),ae=(Array.isArray(ye)?ye:[]).map(me=>({id:String((me==null?void 0:me.id)||""),msisdn:String((me==null?void 0:me.msisdn)||""),isDefault:!!(me!=null&&me.isDefault)})),ue=[...se,...ae],_e=await Z([K],ue);_e&&_e.walletId&&(de={walletId:_e.walletId,msisdn:_e.msisdn})}catch{}if(de&&de.walletId){Ge(ye=>ye?{...ye,walletMsisdn:de.msisdn}:null),localStorage.setItem(`selectedWallet_${te}`,de.walletId);try{localStorage.setItem(`selectedWallet_${te}_${s||""}`,de.walletId)}catch{}try{window.dispatchEvent(new CustomEvent("walletSelection:update",{detail:{walletId:de.walletId}}))}catch{}try{const{Preferences:ye}=await ne(async()=>{const{Preferences:Q}=await Promise.resolve().then(()=>Kv);return{Preferences:Q}},void 0,import.meta.url);await ye.set({key:"selected_wallet_id",value:de.walletId})}catch{}}}catch{}},ka=F.useCallback(()=>{try{localStorage.setItem("privacyPolicyAccepted","true")}catch{}no(!1);try{c("/user/login")}catch{}},[c]);F.useEffect(()=>{try{!(localStorage.getItem("privacyPolicyAccepted")==="true")&&!r&&e&&no(!0)}catch{!r&&e&&no(!0)}},[r,e]);const ro=F.useCallback(()=>{try{const K=window.AudioContext||window.webkitAudioContext;if(!K)return;const z=new K,H=z.createOscillator(),ie=z.createGain();H.type="sine",ie.gain.setValueAtTime(0,z.currentTime),H.connect(ie),ie.connect(z.destination);const Z=z.currentTime;H.frequency.setValueAtTime(800,Z),ie.gain.linearRampToValueAtTime(.15,Z+.02),H.start(Z),H.frequency.exponentialRampToValueAtTime(1200,Z+.08),ie.gain.exponentialRampToValueAtTime(1e-5,Z+.32),H.stop(Z+.35)}catch{}},[]),en=K=>{try{const z=String(K||"").replace(/[^0-9+]/g,"");if(!z)return"";if(z.startsWith("+20")){const H=z.slice(3);return H.startsWith("1")?"0"+H:H}if(z.startsWith("0020")){const H=z.slice(4);return H.startsWith("1")?"0"+H:H}if(z.startsWith("20")){const H=z.slice(2);return H.startsWith("1")?"0"+H:H}return z.startsWith("0")?z:/^(10|11|12|15)/.test(z)?"0"+z:z}catch{return""}},Na=K=>{try{const z=String(K||""),H=z.match(/(?:\s*\s*|\s*)\s*([0-9]+(?:[\.,][0-9]{1,2})?)/i);let ie=H?parseFloat(String(H[1]).replace(",",".")):0;const Z=z.match(/(?:\s*|(?:\s*)?|)\s*[:\-\s]*([\+\d]{10,14})/i);let te=Z?en(Z[1]):void 0;const de=z.match(/(?:\s*(?:|)|\s*(?:|)|(?:|)|(?:\s*)?|)\s*[:\-\s]*([^\n:]+?)(?=\s*(?:||||transaction|ref|reference|$))/i),ye=z.match(/(?:registered\s*(?:name|as)|from|sender|name)\s*[:\-]?\s*([A-Za-z][A-Za-z\s]+?)(?=\s*(?:balance|mobile|number|account|ref|transaction|$))/i),Q=de?String(de[1]).trim():ye?String(ye[1]).trim():void 0,oe=z.match(/\s*(?:|||)\s*[:\-\s]*([0-9]{6,})/i),se=z.match(/(?:ref(?:\.|erence)?\s*no\.?|reference)\s*[:\-\s]*([A-Za-z0-9\-]{6,})/i),ae=z.match(/Ref:\s*([A-Za-z0-9\-]+)/i);if(!ie||ie<=0){const _e=z.match(/Received\s*EGP\s*([0-9.,]+)/i)||z.match(/Received\s*EGP([0-9.,]+)/i);_e&&(ie=parseFloat(String(_e[1]).replace(/,/g,"")))}if(!te){const _e=z.match(/from\s+([0-9+]+)/i);_e&&(te=en(_e[1]))}const ue=oe?String(oe[1]).trim():se?String(se[1]).trim():ae?String(ae[1]).trim():void 0;return{amount:ie,sender:te,senderName:Q,reference:ue}}catch{return{amount:0}}};F.useEffect(()=>{(async()=>{var K;try{if(!re||!j){En(!1);return}const{auth:z}=await ne(async()=>{const{auth:te}=await Promise.resolve().then(()=>qt);return{auth:te}},void 0,import.meta.url),H=((K=z.currentUser)==null?void 0:K.uid)||"",ie=H?`selectedWallet_${H}`:"selectedWallet_default",Z=localStorage.getItem(ie)||"";if(!Z){En(!0);return}try{const{merchantWalletService:te}=await ne(async()=>{const{merchantWalletService:Q}=await Promise.resolve().then(()=>sc);return{merchantWalletService:Q}},void 0,import.meta.url),de=await te.getById(Z),ye=de&&de.defaultWithdrawCommission!=null;En(!ye)}catch{En(!0)}}catch{En(!0)}})()},[re,j]);const so=async K=>{try{const{merchantWalletService:z,detectWalletFromSim:H}=await ne(async()=>{const{merchantWalletService:se,detectWalletFromSim:ae}=await Promise.resolve().then(()=>Io);return{merchantWalletService:se,detectWalletFromSim:ae}},void 0,import.meta.url),ie=(r==null?void 0:r.uid)||"";if(!ie)return;const Z=`wallets_${ie}`,te=typeof localStorage<"u"?localStorage.getItem(Z):null,de=te?JSON.parse(te):[],ye=await z.getByMerchantId(ie),Q=[...(Array.isArray(de)?de:[]).map(se=>({id:String((se==null?void 0:se.id)||""),phone:String((se==null?void 0:se.phone)||(se==null?void 0:se.msisdn)||""),isDefault:!!(se!=null&&se.isDefault)})),...(Array.isArray(ye)?ye:[]).map(se=>({id:String((se==null?void 0:se.id)||""),msisdn:String((se==null?void 0:se.msisdn)||""),isDefault:!!(se!=null&&se.isDefault)}))],oe=await H(K||[],Q);if(oe&&oe.walletId)try{localStorage.setItem(`selectedWallet_${ie}`,oe.walletId)}catch{}}catch{}};S.useEffect(()=>{const K=async z=>{var H;try{const ie=(z==null?void 0:z.detail)||{},Z=String(ie.text||"").trim(),te=String(ie.title||"").trim();if(!Z)return;if(!/vodafone|vf\-?cash|||\s*\s*|\s*|instapay|received\s*egp|transaction/i.test(`${te} ${Z}`)){try{r_(ie,{toast:u})}catch{}return}const{auth:ye}=await ne(async()=>{const{auth:He}=await Promise.resolve().then(()=>qt);return{auth:He}},void 0,import.meta.url),Q=((H=ye.currentUser)==null?void 0:H.uid)||"";let oe=s||"";if(!Q){try{u({title:"  ",description:"   "})}catch{}return}if(!oe)try{const{doc:He,getDoc:rt}=await ne(async()=>{const{doc:tn,getDoc:Wt}=await Promise.resolve().then(()=>Mn);return{doc:tn,getDoc:Wt}},void 0,import.meta.url),{db:xe}=await ne(async()=>{const{db:tn}=await Promise.resolve().then(()=>qt);return{db:tn}},void 0,import.meta.url),lt=await rt(He(xe,"profiles",Q));if(lt.exists()){const tn=lt.data(),Wt=String((tn==null?void 0:tn.shopId)||"").trim();Wt&&(oe=Wt)}}catch{}let se="",ae="",ue=!1;try{const He=Q||"default";se=(localStorage.getItem(`sim1Number_${He}`)??localStorage.getItem("sim1Number")??"").trim(),ae=(localStorage.getItem(`sim2Number_${He}`)??localStorage.getItem("sim2Number")??"").trim(),ue=(localStorage.getItem(`smsAutoRegisterEnabled_${He}`)??localStorage.getItem("smsAutoRegisterEnabled"))==="true"}catch{}try{const{Preferences:He}=await ne(async()=>{const{Preferences:lt}=await Promise.resolve().then(()=>Kv);return{Preferences:lt}},void 0,import.meta.url),rt=await He.get({key:"sim1_number"}),xe=await He.get({key:"sim2_number"});!se&&(rt!=null&&rt.value)&&(se=String(rt.value).trim()),!ae&&(xe!=null&&xe.value)&&(ae=String(xe.value).trim()),!se&&Se.current&&(se=Se.current),!ae&&$.current&&(ae=$.current)}catch{}let _e=[];const me=Array.isArray(((z==null?void 0:z.detail)||{}).activeSimMsisdns)?z.detail.activeSimMsisdns.map(He=>String(He||"")):[];me.length>0?_e=me:_e=[se,ae].filter(Boolean);try{localStorage.setItem("lastActiveSimMsisdns",JSON.stringify(_e))}catch{}let Me="";try{const He=localStorage.getItem("lastSmsSimMsisdn")||"";He&&_e.includes(He)&&(Me=He)}catch{}if(Me||(Me=_e[0]||""),Me)try{localStorage.setItem("lastSmsSimMsisdn",Me)}catch{}const{resolveWalletBySimOrSlot:ze,bindSlotWalletMapping:Tn,merchantWalletService:Nn}=await ne(async()=>{const{resolveWalletBySimOrSlot:He,bindSlotWalletMapping:rt,merchantWalletService:xe}=await Promise.resolve().then(()=>Io);return{resolveWalletBySimOrSlot:He,bindSlotWalletMapping:rt,merchantWalletService:xe}},void 0,import.meta.url),nt=Q;let $e=await ze({simNumbers:_e,userId:nt});if(!$e&&_e.length>0){try{await so(_e)}catch{}const He=localStorage.getItem(`selectedWallet_${nt}`)||"";if(He)try{const rt=await Nn.getById(He);$e={walletId:He,msisdn:String((rt==null?void 0:rt.msisdn)||"")}}catch{}}if($e&&$e.walletId){try{localStorage.setItem(`selectedWallet_${nt}`,$e.walletId)}catch{}try{Tn({userId:nt,walletId:$e.walletId,msisdn:$e.msisdn})}catch{}try{window.dispatchEvent(new CustomEvent("walletSelection:update",{detail:{walletId:$e.walletId}}))}catch{}try{const He=String($e.msisdn||"").trim();He&&(Me=He,localStorage.setItem("lastSmsSimMsisdn",He))}catch{}}const Ne=Na(Z),nr=Number(Ne.amount||0);if(!nr||nr<=0){try{r_(ie,{toast:u})}catch{}return}const yt=($e==null?void 0:$e.msisdn)||await i_(Q),Rt=Ne.reference||`VF-${Date.now()}`,Tt={amount:nr,sender:String(Ne.sender||""),senderName:Ne.senderName,text:Z,simNumber:Me};if(ue)try{await Cr({...Tt,reference:Rt,walletMsisdn:yt})}catch{}else{try{const{addDoc:He,collection:rt,serverTimestamp:xe}=await ne(async()=>{const{addDoc:Nt,collection:Sn,serverTimestamp:be}=await Promise.resolve().then(()=>Mn);return{addDoc:Nt,collection:Sn,serverTimestamp:be}},void 0,import.meta.url),{db:lt}=await ne(async()=>{const{db:Nt}=await Promise.resolve().then(()=>qt);return{db:Nt}},void 0,import.meta.url),tn=await He(rt(lt,"pendingSmsPopups"),{userId:Q,shopId:oe,payload:{...Tt,reference:Rt,walletMsisdn:yt,sim1Number:se,sim2Number:ae},status:"pending",createdAt:xe()}),Wt=/Received\s*EGP/i.test(String(Z))?"InstaPay":"VF-Cash";Ge({...Tt,reference:Rt,providerLabel:Wt,walletMsisdn:yt,popupId:tn.id})}catch{const He=/Received\s*EGP/i.test(String(Z))?"InstaPay":"VF-Cash";Ge({...Tt,reference:Rt,providerLabel:He,walletMsisdn:yt})}ve(!0);try{ro()}catch{}}}catch{try{r_((z==null?void 0:z.detail)||{},{toast:u})}catch{}}};try{window.addEventListener("vfNotificationReceived",K)}catch{}return()=>{try{window.removeEventListener("vfNotificationReceived",K)}catch{}}},[u,s]),S.useEffect(()=>{const K=window.electronAPI;K&&typeof K.onAdbSmsReceived=="function"&&K.onAdbSmsReceived(z=>{const H={sender:z.sender,text:z.text,msisdn:z.sender,deviceId:z.deviceId,timestamp:Date.now()};window.dispatchEvent(new CustomEvent("mobileSmsReceived",{detail:H}))})},[]),S.useEffect(()=>{const K=async z=>{try{const H=(z==null?void 0:z.detail)||{},ie=String(H.text||"");if(!ie)return;const Z=(n==null?void 0:n.smsReadingEnabled)!==void 0?!!n.smsReadingEnabled:localStorage.getItem("smsReadingEnabled")==="true",te=localStorage.getItem("adbSmsReadingEnabled")==="true";if(!Z&&!te)return;const de=/Received\s*EGP/i.test(ie),ye=BX(ie,String(H.sender||H.msisdn||""));if(!de&&!ye)return;const Q=(r==null?void 0:r.uid)||"";if(!Q)return;let oe=s||(n==null?void 0:n.shopId)||localStorage.getItem("shopId")||"";const se=Ie.current;let ae=(se==null?void 0:se.sim1Number)||"",ue=(se==null?void 0:se.sim2Number)||"";ae||(ae=localStorage.getItem(`sim1Number_${Q}`)||localStorage.getItem("sim1Number")||""),ue||(ue=localStorage.getItem(`sim2Number_${Q}`)||localStorage.getItem("sim2Number")||""),!ae&&Se.current&&(ae=Se.current),!ue&&$.current&&(ue=$.current),ae=String(ae).trim(),ue=String(ue).trim();const _e=String(H.msisdn||H.sender||""),me=en(_e),Me=Na(ie);let ze=Number(Me.amount||0),Tn=Me.sender||me||String(H.sender||""),Nn=Me.senderName,nt=Me.reference||"";if(de){const xe=String(ie).match(/Received\s*EGP\s*([0-9.,]+)/i);xe&&(ze=parseFloat(String(xe[1]).replace(/,/g,"")));const lt=String(ie).match(/from\s+([0-9+]+)/i);lt&&(Tn=en(lt[1]));const tn=String(ie).match(/Ref:\s*([A-Za-z0-9\-]+)/i);tn&&(nt=String(tn[1]).trim())}if(!ze||ze<=0)return;let $e="",Ne="";const nr=[ae,ue].filter(Boolean).map(xe=>en(xe));if(me&&nr.includes(me)&&($e=me,$e===en(ae)?Ne="SIM 1":$e===en(ue)&&(Ne="SIM 2")),!Ne){const xe=H==null?void 0:H.slot,lt=xe!=null?Number(xe):-1;lt===0?(Ne="SIM 1",$e=ae?en(ae):""):lt===1&&(Ne="SIM 2",$e=ue?en(ue):"")}!Ne&&$e&&($e===en(ae)?Ne="SIM 1":$e===en(ue)&&(Ne="SIM 2"));const yt=de?"InstaPay":"VF-Cash",Rt={amount:ze,sender:Tn,senderName:Nn,text:ie,simNumber:$e,simLabel:Ne},Tt=Q?`smsAutoRegisterEnabled_${Q}`:"smsAutoRegisterEnabled",rt=(localStorage.getItem(Tt)??localStorage.getItem("smsAutoRegisterEnabled"))==="true"||(n==null?void 0:n.smsAutoRegisterEnabled)===!0;if(!rt){Ge({...Rt,reference:nt,providerLabel:yt,walletMsisdn:""}),ve(!0);try{ro()}catch{}}(async()=>{try{const{resolveWalletBySimOrSlot:xe,bindSlotWalletMapping:lt,merchantWalletService:tn}=await ne(async()=>{const{resolveWalletBySimOrSlot:be,bindSlotWalletMapping:Qe,merchantWalletService:Ye}=await Promise.resolve().then(()=>Io);return{resolveWalletBySimOrSlot:be,bindSlotWalletMapping:Qe,merchantWalletService:Ye}},void 0,import.meta.url);let Wt=Array.isArray(H.activeSimMsisdns)&&H.activeSimMsisdns.length>0?H.activeSimMsisdns.map(be=>en(String(be||""))):me?[me]:[];Wt.length===0&&(Wt=[en(ae),en(ue)].filter(Boolean));let Nt=await xe({simNumbers:Wt,subId:Number((H==null?void 0:H.subId)||-1),slotIndex:Number((H==null?void 0:H.slot)||-1),userId:Q});if(!Nt&&Wt.length>0){try{await so(Wt)}catch{}const be=localStorage.getItem(`selectedWallet_${Q}`)||"";if(be)try{const Qe=await tn.getById(be);Nt={walletId:be,msisdn:String((Qe==null?void 0:Qe.msisdn)||"")}}catch{}}if(Nt&&Nt.walletId){try{localStorage.setItem(`selectedWallet_${Q}`,Nt.walletId)}catch{}try{lt({userId:Q,subId:Number((H==null?void 0:H.subId)||-1),slotIndex:Number((H==null?void 0:H.slot)||-1),walletId:Nt.walletId,msisdn:Nt.msisdn})}catch{}}const Sn=(Nt==null?void 0:Nt.msisdn)||(Q?await i_(Q):"");if(Ge(be=>be?{...be,walletMsisdn:Sn}:null),rt)try{await Cr({...Rt,reference:nt,walletMsisdn:Sn})}catch{}else try{const{addDoc:be,collection:Qe,serverTimestamp:Ye}=await ne(async()=>{const{addDoc:We,collection:dn,serverTimestamp:Dn}=await Promise.resolve().then(()=>Mn);return{addDoc:We,collection:dn,serverTimestamp:Dn}},void 0,import.meta.url),{db:It}=await ne(async()=>{const{db:We}=await Promise.resolve().then(()=>qt);return{db:We}},void 0,import.meta.url),wt=await be(Qe(It,"pendingSmsPopups"),{userId:Q,shopId:oe,payload:{...Rt,reference:nt,walletMsisdn:Sn,sim1Number:ae,sim2Number:ue},status:"pending",createdAt:Ye()});Ge(We=>We?{...We,popupId:wt.id}:null)}catch{}}catch(xe){console.error("Background SMS processing error",xe)}})()}catch(H){console.error("SMS Handler Error",H)}};try{window.addEventListener("mobileSmsReceived",K)}catch{}return()=>{try{window.removeEventListener("mobileSmsReceived",K)}catch{}}},[u,s,n,r]),S.useEffect(()=>{},[u,s]),S.useEffect(()=>{},[u,s]);const Cr=async K=>{var z,H,ie;try{const Z=K||j;if(!Z)return;const{amount:te,sender:de,text:ye,simNumber:Q,senderName:oe}=Z,se=String(ye||"");let ae=Number(te||0);const ue=typeof(K==null?void 0:K.deferredMode)=="boolean"?K.deferredMode:In,_e=(K==null?void 0:K.debtorName)??kt,me=(K==null?void 0:K.debtorNote)??at;try{ve(!1)}catch{}try{}catch{}const Me=/Received\s*EGP/i.test(se)?"instapay":"vodafone_cash";if(!ae||ae<=0){const be=se.match(/\s+(\d+(?:[\.,]\d+)?)\s*/i);if(be&&(ae=parseFloat(String(be[1]).replace(",","."))),!ae||ae<=0){const Qe=se.match(/Received\s*EGP\s*([0-9.,]+)/i)||se.match(/Received\s*EGP([0-9.,]+)/i);Qe&&(ae=parseFloat(String(Qe[1]).replace(/,/g,"")))}}let ze=String(de||"").trim();if(!ze){const be=se.match(/\s+\s+(\d+)/i);ze=be?en(be[1]):""}let Tn=String((Z==null?void 0:Z.reference)||"").trim();if(!Tn){const be=se.match(/\s*\s*([\d\.]+)/i);Tn=be?String(be[1]).trim():String(Date.now())}if(!ae||ae<=0){try{u({title:"      ",variant:"destructive"})}catch{}return}const{auth:Nn}=await ne(async()=>{const{auth:be}=await Promise.resolve().then(()=>qt);return{auth:be}},void 0,import.meta.url),nt=((z=Nn.currentUser)==null?void 0:z.uid)||"";let $e=s||"";if(!nt){try{u({title:"  ",description:"   "})}catch{}return}if(!$e)try{const{doc:be,getDoc:Qe}=await ne(async()=>{const{doc:wt,getDoc:We}=await Promise.resolve().then(()=>Mn);return{doc:wt,getDoc:We}},void 0,import.meta.url),{db:Ye}=await ne(async()=>{const{db:wt}=await Promise.resolve().then(()=>qt);return{db:wt}},void 0,import.meta.url),It=await Qe(be(Ye,"profiles",nt));if(It.exists()){const wt=It.data(),We=String((wt==null?void 0:wt.shopId)||"").trim();We&&($e=We)}}catch{}if(!$e){try{u({title:"  ",description:"   "})}catch{}return}let Ne="";if(Q)try{const{detectWalletFromSim:be}=await ne(async()=>{const{detectWalletFromSim:Je}=await Promise.resolve().then(()=>Io);return{detectWalletFromSim:Je}},void 0,import.meta.url),{merchantWalletService:Qe}=await ne(async()=>{const{merchantWalletService:Je}=await Promise.resolve().then(()=>sc);return{merchantWalletService:Je}},void 0,import.meta.url),Ye=await Qe.getByMerchantId(nt),It=localStorage.getItem(`wallets_${nt}`),wt=It?JSON.parse(It):[],We=(Array.isArray(wt)?wt:[]).map(Je=>({id:String((Je==null?void 0:Je.id)||""),phone:String((Je==null?void 0:Je.phone)||(Je==null?void 0:Je.msisdn)||""),isDefault:!!(Je!=null&&Je.isDefault)})),dn=(Array.isArray(Ye)?Ye:[]).map(Je=>({id:String((Je==null?void 0:Je.id)||""),msisdn:String((Je==null?void 0:Je.msisdn)||""),isDefault:!!(Je!=null&&Je.isDefault)})),Dn=[...We,...dn],qn=await be([Q],Dn);qn&&qn.walletId&&(Ne=qn.walletId)}catch{}if(Ne||(Ne=await zX(nt)),!Ne)try{const{doc:be,getDoc:Qe}=await ne(async()=>{const{doc:Ze,getDoc:Nr}=await Promise.resolve().then(()=>Mn);return{doc:Ze,getDoc:Nr}},void 0,import.meta.url),{db:Ye}=await ne(async()=>{const{db:Ze}=await Promise.resolve().then(()=>qt);return{db:Ze}},void 0,import.meta.url);let It="",wt="";try{const Ze=await Qe(be(Ye,"profiles",nt));if(Ze.exists()){const Nr=Ze.data();It=String((Nr==null?void 0:Nr.sim1Number)||"").trim(),wt=String((Nr==null?void 0:Nr.sim2Number)||"").trim()}}catch{}const{detectWalletFromSim:We}=await ne(async()=>{const{detectWalletFromSim:Ze}=await Promise.resolve().then(()=>Io);return{detectWalletFromSim:Ze}},void 0,import.meta.url),{merchantWalletService:dn}=await ne(async()=>{const{merchantWalletService:Ze}=await Promise.resolve().then(()=>sc);return{merchantWalletService:Ze}},void 0,import.meta.url),Dn=`wallets_${nt}`,qn=localStorage.getItem(Dn),Je=qn?JSON.parse(qn):[],nn=await dn.getByMerchantId(nt),rn=(Array.isArray(Je)?Je:[]).map(Ze=>({id:String((Ze==null?void 0:Ze.id)||""),phone:String((Ze==null?void 0:Ze.phone)||(Ze==null?void 0:Ze.msisdn)||""),isDefault:!!(Ze!=null&&Ze.isDefault)})),hn=(Array.isArray(nn)?nn:[]).map(Ze=>({id:String((Ze==null?void 0:Ze.id)||""),msisdn:String((Ze==null?void 0:Ze.msisdn)||""),isDefault:!!(Ze!=null&&Ze.isDefault)})),kr=[...rn,...hn],On=Q||String(localStorage.getItem("lastSmsSimMsisdn")||"");let bn=(On?[On]:[]).filter(Boolean);bn.length===0&&(bn=[It,wt].filter(Boolean));const ut=await We(bn,kr);if(ut&&ut.walletId){Ne=ut.walletId;try{localStorage.setItem(`selectedWallet_${nt}`,Ne)}catch{}}}catch{}if(!Ne){try{u({title:"   ",description:"       "})}catch{}return}try{const be=nt;try{localStorage.setItem(`selectedWallet_${be}`,Ne)}catch{}try{localStorage.setItem(`selectedWallet_${be}_${$e}`,Ne)}catch{}try{window.dispatchEvent(new CustomEvent("walletSelection:update",{detail:{walletId:Ne}}))}catch{}try{const{Preferences:Qe}=await ne(async()=>{const{Preferences:Ye}=await Promise.resolve().then(()=>Kv);return{Preferences:Ye}},void 0,import.meta.url);await Qe.set({key:"selected_wallet_id",value:Ne}),await Qe.set({key:"current_user_id",value:be})}catch{}}catch{}const{recordAutoTransaction:nr,userDataService:yt}=await ne(async()=>{const{recordAutoTransaction:be,userDataService:Qe}=await Promise.resolve().then(()=>sc);return{recordAutoTransaction:be,userDataService:Qe}},void 0,import.meta.url),Rt=Fe&&Fe.trim()!==""?Math.max(0,parseFloat(Fe)):null;let Tt=0;if(Rt!=null)Tt=Rt;else try{const{merchantWalletService:be}=await ne(async()=>{const{merchantWalletService:It}=await Promise.resolve().then(()=>sc);return{merchantWalletService:It}},void 0,import.meta.url),Qe=await be.getById(String(Ne)),Ye=Qe&&Qe.defaultWithdrawCommission;if(Ye!=null)Tt=Math.round((Number(Ye)||0)*Number(ae)/1e3*100)/100;else{const{calculateCommission:It}=await ne(async()=>{const{calculateCommission:wt}=await Promise.resolve().then(()=>nl);return{calculateCommission:wt}},void 0,import.meta.url);Tt=It(Number(ae),"receive")}}catch{const{calculateCommission:be}=await ne(async()=>{const{calculateCommission:Qe}=await Promise.resolve().then(()=>nl);return{calculateCommission:Qe}},void 0,import.meta.url);Tt=be(Number(ae),"receive")}try{const{walletDailyLimitsService:be}=await ne(async()=>{const{walletDailyLimitsService:Ye}=await Promise.resolve().then(()=>d0);return{walletDailyLimitsService:Ye}},void 0,import.meta.url),Qe=await be.canPerformOperation(String(Ne),Math.max(0,Number(ae||0)),"withdraw");if(!Qe.canPerform)try{u({title:"  ",description:String(Qe.message||"      "),variant:"destructive"})}catch{}}catch{}const He=Tn||`${se}|${Date.now()}`,rt=Q||String(localStorage.getItem("lastSmsSimMsisdn")||""),lt=String((Z==null?void 0:Z.walletMsisdn)||"").trim()||rt||await i_(nt)||"",tn=(localStorage.getItem("commissionMode")||"").toLowerCase()==="add"?"add":"deduct";if(ue)try{const be=await yt.getUserData(nt),Qe=Array.isArray(be==null?void 0:be.debts)?be.debts:[],Ye=tn==="add"?Number(ae)+Number(Tt):Number(ae),It={id:`DEBT-${Date.now()}`,debtorName:_e||oe||ze||"",amount:Math.round(Number(Ye)*100)/100,reason:me||"  VodafoneCash",customerId:void 0,mobile:ze,status:"pending",createdAt:new Date},wt=[It,...Qe];await yt.updateUserData(nt,{debts:wt});try{const We=Tt;await yt.saveUserTransaction(nt,{type:"withdraw",amount:ae,withdrawnAmount:ae,commission:We,status:"pending",createdAt:new Date,senderMsisdn:ze,receiverMsisdn:lt,senderName:oe,walletId:Ne,fromWallet:Ne,lineId:lt,provider:Me,reference:He,transactionId:`DEFER-${Date.now()}`,linkedDebtId:It.id})}catch{}try{const We=(K==null?void 0:K.popupId)||(j==null?void 0:j.popupId)||"";if(We){const{doc:dn,updateDoc:Dn,serverTimestamp:qn}=await ne(async()=>{const{doc:nn,updateDoc:rn,serverTimestamp:hn}=await Promise.resolve().then(()=>Mn);return{doc:nn,updateDoc:rn,serverTimestamp:hn}},void 0,import.meta.url),{db:Je}=await ne(async()=>{const{db:nn}=await Promise.resolve().then(()=>qt);return{db:nn}},void 0,import.meta.url);try{await Dn(dn(Je,"pendingSmsPopups",We),{status:"confirmed",confirmedAt:qn()})}catch{}try{(ie=(H=q.current)==null?void 0:H.add)==null||ie.call(H,We);const nn=Array.from(q.current||[]);localStorage.setItem("sms_suppressed_ids",JSON.stringify(nn))}catch{}}}catch{}try{u({title:"  ",description:"      "})}catch{}return}catch{}ve(!1),Ge(null);try{u({title:"  ..."})}catch{}const Wt=`TX-${Date.now()}`,Nt=Math.max(0,Number(ae||0)),Sn=Math.max(0,Tt);try{const be=`cashBalance_${nt}_${$e||"main"}`,Qe=`walletBalances_${nt}_${$e||"main"}`,Ye=localStorage.getItem(be),It=localStorage.getItem(Qe);let wt=Ye?parseFloat(Ye):0,We=It?JSON.parse(It):{};We[Ne]=(Number(We[Ne])||0)+Nt,wt=wt-Nt+Sn;const dn={id:Wt,type:"withdraw",senderPhone:ze,receiverPhone:lt,amount:ae,status:"completed",createdAt:new Date,withdrawnAmount:ae,commission:Sn,fromWallet:Ne,senderName:oe,provider:Me,reference:He,shopName:"  ()"};window.dispatchEvent(new CustomEvent("dashboard:external-update",{detail:{delta:{amount:Nt,commission:Sn,walletId:Ne,type:"withdraw"},limitUpdate:{walletId:Ne,amount:Nt,type:"withdraw"}}}))}catch(be){console.error("Optimistic update failed",be)}(async()=>{var Qe,Ye,It,wt;let be="";try{be=await nr({shopId:$e,lineId:lt,walletId:Ne,amount:ae,note:"SMS-ManualConfirm",provider:Me,createdBy:nt,senderMsisdn:ze,senderName:oe,reference:He,text:se});try{const We=(K==null?void 0:K.popupId)||(j==null?void 0:j.popupId)||"";if(We){const{doc:dn,updateDoc:Dn,serverTimestamp:qn}=await ne(async()=>{const{doc:nn,updateDoc:rn,serverTimestamp:hn}=await Promise.resolve().then(()=>Mn);return{doc:nn,updateDoc:rn,serverTimestamp:hn}},void 0,import.meta.url),{db:Je}=await ne(async()=>{const{db:nn}=await Promise.resolve().then(()=>qt);return{db:nn}},void 0,import.meta.url);try{await Dn(dn(Je,"pendingSmsPopups",We),{status:"confirmed",confirmedAt:qn()})}catch{}try{(Ye=(Qe=q.current)==null?void 0:Qe.add)==null||Ye.call(Qe,We);const nn=Array.from(q.current||[]);localStorage.setItem("sms_suppressed_ids",JSON.stringify(nn))}catch{}}}catch{}}catch(We){console.error(We)}try{const We=Math.max(0,Number(ae||0)),{doc:dn,getDoc:Dn,updateDoc:qn}=await ne(async()=>{const{doc:bn,getDoc:ut,updateDoc:Ze}=await Promise.resolve().then(()=>Mn);return{doc:bn,getDoc:ut,updateDoc:Ze}},void 0,import.meta.url),{db:Je}=await ne(async()=>{const{db:bn}=await Promise.resolve().then(()=>qt);return{db:bn}},void 0,import.meta.url),nn=dn(Je,"dashboardData",$e),rn=await Dn(nn);let hn=rn.exists()?Number(((It=rn.data())==null?void 0:It.cashBalance)||0):0;const kr=rn.exists()?((wt=rn.data())==null?void 0:wt.walletBalances)||{}:{},On=Number(kr[Ne]||0);kr[Ne]=On+We,hn=hn-We+Math.max(0,Tt),await qn(nn,{cashBalance:hn,walletBalances:kr,lastUpdated:new Date().toISOString()});try{const bn={id:be||`TX-${Date.now()}`,type:"withdraw",senderPhone:ze,receiverPhone:lt,amount:ae,status:"completed",createdAt:new Date,withdrawnAmount:ae,commission:Tt,fromWallet:Ne,senderName:oe,provider:Me,reference:He,shopName:" "};window.dispatchEvent(new CustomEvent("dashboard:external-update",{detail:{}}))}catch{}try{const{walletDailyLimitsService:bn}=await ne(async()=>{const{walletDailyLimitsService:ut}=await Promise.resolve().then(()=>d0);return{walletDailyLimitsService:ut}},void 0,import.meta.url);await bn.updateUsage(String(Ne),We,"withdraw");try{window.dispatchEvent(new CustomEvent("walletLimitsUpdated",{detail:{walletId:String(Ne)}}))}catch{}}catch{}}catch{}(async()=>{try{const We=Tt;await yt.saveUserTransaction(nt,{type:"withdraw",amount:ae,withdrawnAmount:ae,commission:We,status:"completed",createdAt:new Date,senderMsisdn:ze,receiverMsisdn:lt,senderName:oe,walletId:Ne,fromWallet:Ne,lineId:lt,provider:Me,reference:He,transactionId:be||Wt});try{window.dispatchEvent(new CustomEvent("transaction-created"))}catch{}}catch{}})(),Ja.invalidateQueries({queryKey:["dashboardData"]}),Ja.invalidateQueries({queryKey:["transactions"]}),Ja.invalidateQueries({queryKey:["walletDailyLimits"]}),Ja.invalidateQueries({queryKey:["wallets"]}),Ja.invalidateQueries({queryKey:["user-stats"]});try{u({title:`     ${be||Wt}`})}catch{}})()}catch(Z){try{u({title:String((Z==null?void 0:Z.message)||"  "),variant:"destructive"})}catch{}}};S.useEffect(()=>{try{DR.start()}catch{}return()=>{try{DR.stop()}catch{}}},[]),S.useEffect(()=>{(async()=>{try{if(!(r!=null&&r.uid))return;const K=String(localStorage.getItem("android_last_ack_version_id")||"").trim(),z=String(localStorage.getItem("android_installed_version")||"").trim(),H=localStorage.getItem("android_last_ack_code"),ie=localStorage.getItem("android_installed_code"),Z=H?Number(H):null,te=ie?Number(ie):null,de=K||z,ye=Z??te??null;de&&L(de),ye&&O(ye);const{doc:Q,getDoc:oe}=await ne(async()=>{const{doc:ue,getDoc:_e}=await Promise.resolve().then(()=>Mn);return{doc:ue,getDoc:_e}},void 0,import.meta.url),{db:se}=await ne(async()=>{const{db:ue}=await Promise.resolve().then(()=>qt);return{db:ue}},void 0,import.meta.url),ae=await oe(Q(se,"profiles",r.uid));if(ae.exists()){const ue=ae.data(),_e=String((ue==null?void 0:ue.lastAckAndroidVersion)||(ue==null?void 0:ue.androidInstalledVersion)||(ue==null?void 0:ue.lastAckUpdateId)||"").trim(),me=typeof(ue==null?void 0:ue.lastAckAndroidCode)=="number"?ue.lastAckAndroidCode:typeof(ue==null?void 0:ue.androidInstalledCode)=="number"?ue.androidInstalledCode:null,Me=(Tn,Nn)=>{const nt=String(Tn||"").replace(/^v/i,"").split(".").map(Ne=>parseInt(Ne,10)||0),$e=String(Nn||"").replace(/^v/i,"").split(".").map(Ne=>parseInt(Ne,10)||0);for(let Ne=0;Ne<Math.max(nt.length,$e.length);Ne++){const nr=nt[Ne]||0,yt=$e[Ne]||0;if(nr>yt)return 1;if(nr<yt)return-1}return 0};let ze=!1;if(typeof me=="number"&&typeof ye=="number"?ze=me>ye:typeof me=="number"&&ye==null?ze=!0:_e&&de?ze=Me(_e,de)>0:_e&&!de&&(ze=!0),ze){if(_e){try{localStorage.setItem("android_installed_version",_e)}catch{}L(_e)}if(typeof me=="number"){try{localStorage.setItem("android_installed_code",String(me))}catch{}O(me)}}else if(typeof me=="number"&&ye==null){try{localStorage.setItem("android_installed_code",String(me))}catch{}O(me)}}}catch{}})()},[r==null?void 0:r.uid]),S.useEffect(()=>{try{const z=String((window==null?void 0:window.__nativeAppVersion)||"").trim();z&&T(z);const H=window==null?void 0:window.__nativeAppVersionCode;if(typeof H=="number"){C(H);try{localStorage.setItem("android_installed_code",String(H))}catch{}}try{z&&localStorage.setItem("android_installed_version",z)}catch{}}catch{}const K=z=>{var H,ie;try{const Z=String((((H=z==null?void 0:z.detail)==null?void 0:H.version)??"")||"").trim(),te=(ie=z==null?void 0:z.detail)==null?void 0:ie.code;Z&&T(Z);try{Z&&localStorage.setItem("android_installed_version",Z)}catch{}typeof te=="number"&&C(te)}catch{}};try{window.addEventListener("native-app-version",K)}catch{}return()=>{try{window.removeEventListener("native-app-version",K)}catch{}}},[]),S.useEffect(()=>{try{const K=(Ee==null?void 0:Ee.isNativePlatform)&&Ee.getPlatform()==="android",z=String(x||"").trim();if(!K||!z||!(r!=null&&r.uid))return;(async()=>{try{const{doc:H,setDoc:ie,serverTimestamp:Z}=await ne(async()=>{const{doc:de,setDoc:ye,serverTimestamp:Q}=await Promise.resolve().then(()=>Mn);return{doc:de,setDoc:ye,serverTimestamp:Q}},void 0,import.meta.url),{db:te}=await ne(async()=>{const{db:de}=await Promise.resolve().then(()=>qt);return{db:de}},void 0,import.meta.url);await ie(H(te,"profiles",r.uid),{androidInstalledVersion:z,androidInstalledAt:Z()},{merge:!0});try{localStorage.setItem("android_installed_version",z)}catch{}}catch{}})()}catch{}},[x,r==null?void 0:r.uid]),S.useEffect(()=>{Ee!=null&&Ee.isNativePlatform&&Ee.getPlatform()==="android"&&(async()=>{try{await ne(()=>import("./ProtectedUserDashboard-Bw0jIEWh.js"),__vite__mapDeps([34,35,21,29,30]),import.meta.url),await ne(()=>import("./UserDashboardPage-C8E2BvSp.js").then(z=>z.U),__vite__mapDeps([71,62,51,29,30,45,19,16,32,58,60,46,6,7,53,11,39,50,37,38,48,35,20,31,10,33,65,24,57,44,26]),import.meta.url),await ne(()=>Promise.resolve().then(()=>qY),void 0,import.meta.url),await ne(()=>import("./ProfileSettingsPage-JYQlk0op.js").then(z=>z.b),__vite__mapDeps([62,51,29,30,45,19,16,32,58,60,46,6,7,53,11]),import.meta.url),await ne(()=>import("./TransactionsPage-CbJ7dIg_.js"),__vite__mapDeps([63,16,39,56,38,64,65,52,29,30,2,43,46,6,44,14,66,10,67,41,61,68,31,53,32,33,11,57,60]),import.meta.url)}catch{}})()},[]),S.useEffect(()=>{if(!t)return;const K=document.createElement("style");K.setAttribute("data-disable-pull-to-refresh","true"),K.textContent="html, body { overscroll-behavior-y: contain; touch-action: pan-y; }",document.head.appendChild(K);let z=0,H=null;const ie=te=>{var de,ye;z=((ye=(de=te.touches)==null?void 0:de[0])==null?void 0:ye.clientY)||0,H=te.target},Z=te=>{var ue,_e;const de=((_e=(ue=te.touches)==null?void 0:ue[0])==null?void 0:_e.clientY)||0,ye=document.scrollingElement||document.documentElement,Q=ye.scrollTop||window.scrollY||0,oe=ye.scrollHeight-ye.clientHeight||0,se=H||null,ae=(()=>{let me=se;for(;me&&me!==document.body;){const ze=window.getComputedStyle(me).overflowY;if((ze==="auto"||ze==="scroll")&&me.scrollHeight>me.clientHeight)return!0;me=me.parentElement}return!1})();!ae&&Q<=0&&de>z&&te.cancelable&&te.preventDefault(),!ae&&Q>=oe&&de<z&&te.cancelable&&te.preventDefault()};return document.addEventListener("touchstart",ie,{passive:!0}),document.addEventListener("touchmove",Z,{passive:!1}),()=>{document.removeEventListener("touchstart",ie),document.removeEventListener("touchmove",Z);try{document.head.removeChild(K)}catch{}}},[t]),S.useEffect(()=>{if(!((Ee==null?void 0:Ee.isNativePlatform)&&Ee.getPlatform()==="android"))return;try{const ie=(window.location.reload||(()=>{})).bind(window.location);window.__originalReload=ie,window.location.reload=()=>{try{window.dispatchEvent(new CustomEvent("app:softRefresh"))}catch{}}}catch{}try{const ie=(window.location.assign||(Z=>{})).bind(window.location);window.__originalAssign=ie,window.location.assign=Z=>{try{if(String(Z||"").startsWith("/user/dashboard")){c("/user/dashboard");return}}catch{}try{ie(Z)}catch{}}}catch{}let z=null,H=!1;return(async()=>{try{const{listenAndroidUpdates:ie}=await ne(async()=>{const{listenAndroidUpdates:Z}=await Promise.resolve().then(()=>mX);return{listenAndroidUpdates:Z}},void 0,import.meta.url);z=ie(Z=>{if(H)return;const te=String((Z==null?void 0:Z.version)||"").trim(),de=String((Z==null?void 0:Z.url)||"").trim(),ye=String((Z==null?void 0:Z.notes)||"").trim(),Q=!!(Z!=null&&Z.force),oe=typeof(Z==null?void 0:Z.code)=="number"?Z.code:void 0,se=String(localStorage.getItem("android_last_ack_version_id")||"").trim(),ae=String(P||se||"").trim(),ue=(yt,Rt)=>{const Tt=String(yt||"").replace(/^v/i,"").split(".").map(rt=>parseInt(rt,10)||0),He=String(Rt||"").replace(/^v/i,"").split(".").map(rt=>parseInt(rt,10)||0);for(let rt=0;rt<Math.max(Tt.length,He.length);rt++){const xe=Tt[rt]||0,lt=He[rt]||0;if(xe>lt)return 1;if(xe<lt)return-1}return 0},_e=String(x||"").trim(),me=String(localStorage.getItem("android_installed_version")||"").trim(),Me=localStorage.getItem("android_installed_code"),ze=Me?Number(Me):null,Tn=[R,D,ze].filter(yt=>typeof yt=="number").reduce((yt,Rt)=>yt===void 0?Rt:Math.max(yt,Rt),void 0),Nn=typeof oe=="number"&&typeof Tn=="number"?oe>Tn:void 0,nt=(()=>{const yt=[_e,ae,me].filter(Boolean);return yt.length===0?"":yt.reduce((Rt,Tt)=>ue(Tt,Rt)>0?Tt:Rt)})(),$e=ue(te,nt)>0;if(!!de&&(!!te||typeof oe=="number")&&(Nn!==void 0?Nn:$e)){const yt="   ",Rt=`${ye?ye+`
`:""} : ${te}`;E({title:yt,message:Rt,apkUrl:de,force:Q,versionId:te,versionCode:oe}),f(!0)}else try{f(!1)}catch{}})}catch{}})(),()=>{H=!0;try{typeof z=="function"&&z()}catch{}}},[P,x]),S.useEffect(()=>{const K=H=>{const ie=(H==null?void 0:H.detail)||{};try{k.current&&(clearTimeout(k.current),k.current=null)}catch{}try{B.current&&(clearInterval(B.current),B.current=null)}catch{}I(!0),_({percent:ie.percent??null,downloaded:ie.downloaded??0,total:ie.total??0})},z=()=>{try{k.current&&(clearTimeout(k.current),k.current=null)}catch{}try{B.current&&(clearInterval(B.current),B.current=null)}catch{}I(!1),A(!0),_({percent:100,downloaded:((g==null?void 0:g.total)??(g==null?void 0:g.downloaded)??0)||0,total:(g==null?void 0:g.total)??0});try{const H=String((m==null?void 0:m.versionId)||"").trim();if(H){try{localStorage.setItem("android_last_ack_version_id",H)}catch{}try{localStorage.setItem("android_installed_version",H)}catch{}(async()=>{try{if(r!=null&&r.uid){const{doc:ie,setDoc:Z,serverTimestamp:te}=await ne(async()=>{const{doc:ye,setDoc:Q,serverTimestamp:oe}=await Promise.resolve().then(()=>Mn);return{doc:ye,setDoc:Q,serverTimestamp:oe}},void 0,import.meta.url),{db:de}=await ne(async()=>{const{db:ye}=await Promise.resolve().then(()=>qt);return{db:ye}},void 0,import.meta.url);await Z(ie(de,"profiles",r.uid),{lastAckAndroidVersion:H,androidInstalledVersion:H,lastAckAt:te(),androidInstalledAt:te()},{merge:!0})}}catch{}})()}}catch{}};return window.addEventListener("androidUpdateProgress",K),window.addEventListener("androidUpdateDownloaded",z),()=>{window.removeEventListener("androidUpdateProgress",K),window.removeEventListener("androidUpdateDownloaded",z)}},[]),S.useEffect(()=>{let K=!0;return(async()=>{var z;try{const{auth:H}=await ne(async()=>{const{auth:ue}=await Promise.resolve().then(()=>qt);return{auth:ue}},void 0,import.meta.url),ie=((z=H.currentUser)==null?void 0:z.uid)||"";if(!ie)return;const{db:Z}=await ne(async()=>{const{db:ue}=await Promise.resolve().then(()=>qt);return{db:ue}},void 0,import.meta.url),{collection:te,query:de,where:ye,onSnapshot:Q,deleteDoc:oe}=await ne(async()=>{const{collection:ue,query:_e,where:me,onSnapshot:Me,deleteDoc:ze}=await Promise.resolve().then(()=>Mn);return{collection:ue,query:_e,where:me,onSnapshot:Me,deleteDoc:ze}},void 0,import.meta.url),se=de(te(Z,"pendingSmsPopups"),ye("userId","==",ie),ye("status","==","pending"),limit(20)),ae=Q(se,ue=>{var _e,me,Me,ze,Tn,Nn,nt,$e,Ne,nr,yt,Rt,Tt;if(K)try{const He=typeof ue.docChanges=="function"?ue.docChanges():[];console.log("Web Popup: Snapshot received",He.length,"changes");for(const rt of He){if(rt.type==="added"){const xe=rt.doc.data()||{},lt=rt.doc.id;console.log("Web Popup: Received document",lt,xe),(me=(_e=q.current)==null?void 0:_e.has)!=null&&me.call(_e,lt)&&console.log("Web Popup: ID is in suppressed list",lt);try{const On=xe.createdAt||xe.timestamp||(xe.payload||{}).createdAt||(xe.payload||{}).timestamp,bn=On&&typeof On.toMillis=="function"?On.toMillis():typeof xe.createdAtMs=="number"?xe.createdAtMs:typeof(xe.payload||{}).createdAtMs=="number"?(xe.payload||{}).createdAtMs:null;if(typeof bn=="number"&&bn<Date.now()-36e5){console.log("Web Popup: Cleaning up old popup",lt),oe(rt.doc.ref).catch(()=>{});continue}}catch{}let tn=xe.amount??((Me=xe.payload)==null?void 0:Me.amount)??null,Wt=xe.sender??((ze=xe.payload)==null?void 0:ze.sender)??"";const Nt=xe.senderName??((Tn=xe.payload)==null?void 0:Tn.senderName)??"";let Sn=xe.reference??((Nn=xe.payload)==null?void 0:Nn.reference)??"";const be=xe.text??((nt=xe.payload)==null?void 0:nt.text)??"";let Qe=xe.simNumber??(($e=xe.payload)==null?void 0:$e.simNumber)??"",Ye=xe.simSlot??((Ne=xe.payload)==null?void 0:Ne.simSlot);Ye==null&&(Ye=xe.slot??((nr=xe.payload)==null?void 0:nr.slot)),Ye==null&&(Ye=xe.sim_slot??((yt=xe.payload)==null?void 0:yt.sim_slot)),Ye==null&&(Ye=xe.lineId??((Rt=xe.payload)==null?void 0:Rt.lineId));const It=Ye!=null?String(Ye):"",wt=(r==null?void 0:r.uid)||"default";let We=localStorage.getItem(`sim1Number_${wt}`)??localStorage.getItem("sim1Number")??"",dn=localStorage.getItem(`sim2Number_${wt}`)??localStorage.getItem("sim2Number")??"";const Dn=xe.payload||{},qn=Dn.sim1Number||Dn.sim1||xe.sim1Number||"",Je=Dn.sim2Number||Dn.sim2||xe.sim2Number||"";qn&&(We=String(qn).trim(),Ca(We)),Je&&(dn=String(Je).trim(),kn(dn));let nn=Qe,rn="";It==="1"?(rn="SIM 2",dn&&(nn=dn)):(It==="0"||!It)&&(rn="SIM 1",We&&(nn=We));const hn=xe.walletMsisdn??((Tt=xe.payload)==null?void 0:Tt.walletMsisdn)??"";let kr="VF-Cash";if(/Received\s*EGP/i.test(String(be))){kr="InstaPay";const On=String(be).match(/Received\s*EGP\s*([0-9.,]+)/i);On&&(tn=parseFloat(String(On[1]).replace(/,/g,"")));const bn=String(be).match(/from\s+([0-9+]+)/i);bn&&(Wt=en(bn[1]));const ut=String(be).match(/Ref:\s*([A-Za-z0-9\-]+)/i);ut&&(Sn=String(ut[1]).trim())}if(K){console.log("Web Popup: Opening modal for",lt),Ge({amount:Number(tn||0),sender:String(Wt||""),senderName:Nt,reference:String(Sn||""),text:be,simNumber:nn,simLabel:rn,walletMsisdn:hn,providerLabel:kr,popupId:lt,sim1Number:We,sim2Number:dn}),ve(!0);try{u({title:" ",description:`   ${tn}  ${Wt}`})}catch{}try{ro()}catch(On){console.error("PlayBell failed",On)}}}rt.type}}catch{}});he.current=ae}catch{}})(),()=>{K=!1;try{const z=he.current;typeof z=="function"&&z()}catch{}}},[r==null?void 0:r.uid]),S.useEffect(()=>{const K=(Ee==null?void 0:Ee.isNativePlatform)&&Ee.getPlatform()==="android"||/android/i.test(navigator.userAgent.toLowerCase()),z=typeof window<"u"&&(window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"));if(K||z)return;let H=!1;return(async()=>{try{const ie="0.0.0",Z=await fetch("https://cashy-link.com/desktop_version.json",{cache:"no-store"});if(!Z.ok)return;const te=await Z.json(),de=String((te==null?void 0:te.version)||"0.0.0"),ye=!!(te!=null&&te.force);if(!H&&((oe,se)=>{const ae=String(oe).split(".").map(_e=>parseInt(_e,10)||0),ue=String(se).split(".").map(_e=>parseInt(_e,10)||0);for(let _e=0;_e<Math.max(ae.length,ue.length);_e++){const me=ae[_e]||0,Me=ue[_e]||0;if(me>Me)return 1;if(me<Me)return-1}return 0})(de,ie)>0){if(ye){try{window.location.reload()}catch{}return}try{u({title:"  ",description:` ${de}      `})}catch{}}}catch{}})(),()=>{H=!0}},[]),S.useEffect(()=>{if(re)try{const K=(r==null?void 0:r.uid)||"default",z=localStorage.getItem(`sim1Number_${K}`)??localStorage.getItem("sim1Number")??"",H=localStorage.getItem(`sim2Number_${K}`)??localStorage.getItem("sim2Number")??"";Ca(z),kn(H)}catch{}},[re,r==null?void 0:r.uid]);const us=(()=>{try{return String(localStorage.getItem("android_installed_version")||"").trim()}catch{return""}})(),Ii=(()=>{const K=(H,ie)=>{const Z=String(H||"").replace(/^v/i,"").split(".").map(de=>parseInt(de,10)||0),te=String(ie||"").replace(/^v/i,"").split(".").map(de=>parseInt(de,10)||0);for(let de=0;de<Math.max(Z.length,te.length);de++){const ye=Z[de]||0,Q=te[de]||0;if(ye>Q)return 1;if(ye<Q)return-1}return 0},z=[x,P,us].filter(Boolean);return z.length===0?"":z.reduce((H,ie)=>K(ie,H)>0?ie:H)})();return v.jsxs(v.Fragment,{children:[v.jsx(fh,{open:wr,onOpenChange:()=>{},children:v.jsxs(Hc,{hideClose:!0,disableOutsideClose:!0,disableEscClose:!0,className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[92vw] max-w-md max-h-[86vh] overflow-y-auto rounded-2xl bg-white/95 backdrop-blur border border-gray-200 shadow-[0_10px_40px_rgba(16,24,40,0.12)] p-5",onInteractOutside:K=>{try{K.preventDefault()}catch{}},onEscapeKeyDown:K=>{try{K.preventDefault()}catch{}},style:{paddingBottom:"env(safe-area-inset-bottom, 16px)"},children:[v.jsx("div",{className:"absolute inset-x-0 -top-1 mx-auto h-1 w-24 rounded-full bg-gradient-to-r from-blue-600 via-emerald-500 to-purple-600"}),v.jsx(Kc,{className:"text-center",children:v.jsxs("div",{className:"flex items-center justify-center gap-3",children:[v.jsx("div",{className:"inline-flex items-center justify-center w-11 h-11 rounded-xl bg-gradient-to-br from-blue-600 to-emerald-500 text-white",children:v.jsx(vk,{className:"w-6 h-6"})}),v.jsx(Gc,{className:"text-lg font-extrabold tracking-tight text-gray-900",children:" "})]})}),v.jsx("div",{className:"mt-2 space-y-4 text-[0.95rem] leading-relaxed text-gray-800",children:v.jsxs("div",{className:"mt-4 text-center text-gray-700 leading-relaxed",children:[v.jsx("p",{children:"   .                    ."}),v.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"        ."})]})}),v.jsx("div",{className:"mt-4",children:v.jsx(Vn,{className:"w-full h-10 rounded-xl bg-gradient-to-r from-blue-600 via-emerald-500 to-purple-600 hover:from-blue-700 hover:via-emerald-600 hover:to-purple-700 text-white font-semibold",onClick:ka,children:"  "})})]})}),(()=>{try{const K=(Ee==null?void 0:Ee.isNativePlatform)&&Ee.getPlatform()==="android",z=(typeof window<"u"?window.__uid:"")||""}catch{}return null})(),X&&(Ee==null?void 0:Ee.isNativePlatform)&&Ee.getPlatform()==="android"&&v.jsx("div",{className:"fixed inset-0 z-[3000] flex items-center justify-center p-4",style:{background:"linear-gradient(135deg, #0f172a, #111827)"},children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 max-w-sm w-full p-5 text-center",children:[v.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 rounded-full bg-red-100 text-red-600 mx-auto",children:v.jsx("span",{className:"text-2xl",children:"!"})}),v.jsx("h2",{className:"mt-3 text-base md:text-lg font-bold text-gray-900",children:"   "}),v.jsx("p",{className:"mt-1 text-sm text-gray-700",children:"        "}),v.jsx("div",{className:"mt-3 flex items-center justify-center gap-3",children:v.jsx(Vn,{variant:"outline",className:"h-8 min-w-[100px]",onClick:retryConnectivity,children:"  "})})]})}),h&&m&&v.jsx(fh,{open:h,onOpenChange:K=>{m!=null&&m.force||f(K)},children:v.jsxs(Hc,{className:"max-w-sm mx-auto bg-white border border-gray-200 shadow-2xl rounded-2xl sm:max-w-md",children:[v.jsxs(Kc,{className:"text-center",children:[v.jsx(Gc,{className:"text-base md:text-lg font-bold text-gray-900",children:m.title}),v.jsx(a0,{className:"text-sm text-gray-700 whitespace-pre-line",children:m.message}),v.jsx("div",{className:"mt-2 text-xs text-muted-foreground",children:Ii?`  : v${Ii}`:""})]}),v.jsxs("div",{className:"flex items-center justify-center gap-3 mt-3",children:[!m.force&&!p&&!w&&v.jsx(Vn,{variant:"outline",className:"h-8 min-w-[80px]",onClick:()=>f(!1),children:""}),!w&&v.jsx(Vn,{className:"h-8 min-w-[120px] bg-emerald-600 hover:bg-emerald-700 text-white",onClick:()=>{try{const K=String((m==null?void 0:m.versionId)||"").trim(),z=m==null?void 0:m.versionCode;if(K)try{localStorage.setItem("android_last_ack_version_id",K)}catch{}if(typeof z=="number")try{localStorage.setItem("android_last_ack_code",String(z))}catch{}if((async()=>{try{if(r!=null&&r.uid&&K){const{doc:ie,setDoc:Z,serverTimestamp:te}=await ne(async()=>{const{doc:Q,setDoc:oe,serverTimestamp:se}=await Promise.resolve().then(()=>Mn);return{doc:Q,setDoc:oe,serverTimestamp:se}},void 0,import.meta.url),{db:de}=await ne(async()=>{const{db:Q}=await Promise.resolve().then(()=>qt);return{db:Q}},void 0,import.meta.url),ye={lastAckAndroidVersion:K,lastAckAt:te()};typeof z=="number"&&(ye.lastAckAndroidCode=z),await Z(ie(de,"profiles",r.uid),ye,{merge:!0})}}catch{}})(),(Ee==null?void 0:Ee.isNativePlatform)&&Ee.getPlatform()==="android"){const ie=m.apkUrl,Z=`cashy://update?url=${encodeURIComponent(ie)}`;I(!0),_({percent:0,downloaded:0,total:0});try{B.current&&clearInterval(B.current),B.current=setInterval(()=>{_(te=>{const de=typeof(te==null?void 0:te.percent)=="number"?te.percent:0,ye=ce.current?2:1;return{percent:Math.min(99,Math.max(0,Math.round(de+ye))),downloaded:(te==null?void 0:te.downloaded)??0,total:(te==null?void 0:te.total)??0}})},600)}catch{}window.location.href=Z;try{k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{try{ce.current=!1}catch{}try{k.current=null}catch{}},8e3)}catch{}}else{const ie=m.apkUrl;try{window.open(ie,"_blank")}catch{}}}catch{}},children:p?" ...":" "}),w&&v.jsx(Vn,{className:"h-8 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>{try{if((Ee==null?void 0:Ee.isNativePlatform)&&Ee.getPlatform()==="android"){f(!1);try{const z=String((m==null?void 0:m.versionId)||"").trim();if(z){try{localStorage.setItem("android_last_ack_version_id",z)}catch{}(async()=>{try{if(r!=null&&r.uid){const{doc:H,setDoc:ie,serverTimestamp:Z}=await ne(async()=>{const{doc:Q,setDoc:oe,serverTimestamp:se}=await Promise.resolve().then(()=>Mn);return{doc:Q,setDoc:oe,serverTimestamp:se}},void 0,import.meta.url),{db:te}=await ne(async()=>{const{db:Q}=await Promise.resolve().then(()=>qt);return{db:Q}},void 0,import.meta.url),de={lastAckAndroidVersion:z,androidInstalledVersion:z,lastAckAt:Z(),androidInstalledAt:Z()},ye=m==null?void 0:m.versionCode;if(typeof ye=="number"){de.lastAckAndroidCode=ye,de.androidInstalledCode=ye;try{localStorage.setItem("android_installed_code",String(ye)),localStorage.setItem("android_last_ack_code",String(ye))}catch{}}await ie(H(te,"profiles",r.uid),de,{merge:!0})}}catch{}})()}}catch{}window.location.href="cashy://applyUpdate"}}catch{}},children:" "})]}),p&&v.jsxs("div",{className:"mt-3 text-center",children:[v.jsx("div",{className:"w-full h-2 bg-gray-200 rounded",children:v.jsx("div",{className:"h-2 bg-emerald-600 rounded",style:{width:`${Math.max(0,Math.min(100,Math.round((g==null?void 0:g.percent)||0)))}%`}})}),v.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[Math.round((g==null?void 0:g.percent)||0),"%"]})]})]})}),!!r&&re&&v.jsx(fh,{open:re,onOpenChange:async K=>{K&&ve(!0)},children:v.jsxs(Hc,{className:"sm:max-w-[420px] rounded-2xl shadow-xl z-[9999]",onInteractOutside:K=>{K.preventDefault()},onEscapeKeyDown:K=>{K.preventDefault()},hideClose:!0,children:[v.jsxs("div",{className:"absolute left-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground cursor-pointer z-50",onClick:async()=>{if(ve(!1),j!=null&&j.popupId)try{const{db:K}=await ne(async()=>{const{db:Z}=await Promise.resolve().then(()=>qt);return{db:Z}},void 0,import.meta.url),{doc:z,updateDoc:H,serverTimestamp:ie}=await ne(async()=>{const{doc:Z,updateDoc:te,serverTimestamp:de}=await Promise.resolve().then(()=>Mn);return{doc:Z,updateDoc:te,serverTimestamp:de}},void 0,import.meta.url);await H(z(K,"pendingSmsPopups",j.popupId),{status:"dismissed",dismissedAt:ie()})}catch{}},children:[v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-6 w-6",children:[v.jsx("path",{d:"M18 6 6 18"}),v.jsx("path",{d:"m6 6 12 12"})]}),v.jsx("span",{className:"sr-only",children:"Close"})]}),v.jsxs(Kc,{children:[v.jsx(Gc,{children:j!=null&&j.providerLabel?v.jsxs(v.Fragment,{children:["   ",v.jsx("span",{className:"text-red-600",children:j.providerLabel})]}):"   "}),v.jsx(a0,{})]}),v.jsxs("div",{className:"text-sm",children:[v.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[v.jsx(Vn,{variant:(j==null?void 0:j.simLabel)==="SIM 1"?"default":"outline",className:`w-full h-9 ${(j==null?void 0:j.simLabel)==="SIM 1"?"bg-blue-600 hover:bg-blue-700 text-white":"border-blue-200 text-blue-700 hover:bg-blue-50"}`,onClick:()=>cs((j==null?void 0:j.sim1Number)||Pr,"SIM 1"),disabled:!(j!=null&&j.sim1Number||Pr),children:(j==null?void 0:j.sim1Number)||Pr||" "}),v.jsx(Vn,{variant:(j==null?void 0:j.simLabel)==="SIM 2"?"default":"outline",className:`w-full h-9 ${(j==null?void 0:j.simLabel)==="SIM 2"?"bg-blue-600 hover:bg-blue-700 text-white":"border-blue-200 text-blue-700 hover:bg-blue-50"}`,onClick:()=>cs((j==null?void 0:j.sim2Number)||ws,"SIM 2"),disabled:!(j!=null&&j.sim2Number||ws),children:(j==null?void 0:j.sim2Number)||ws||" "})]}),v.jsx("div",{className:"border rounded-lg p-3",children:v.jsxs("div",{className:"grid grid-cols-2 gap-3 items-start",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"font-bold",children:[" ",(tr=j==null?void 0:j.amount)==null?void 0:tr.toLocaleString()]}),v.jsx("div",{className:"font-mono",children:(j==null?void 0:j.sender)||""}),v.jsxs("div",{className:"font-mono",children:[(j==null?void 0:j.simLabel)&&v.jsx("span",{className:`inline-flex items-center justify-center rounded-md px-1.5 py-0.5 text-xs font-bold mr-2 ${j.simLabel==="SIM 1"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:j.simLabel}),(j==null?void 0:j.simNumber)||"-"]}),(j==null?void 0:j.senderName)&&v.jsx("div",{children:j==null?void 0:j.senderName}),(j==null?void 0:j.reference)&&v.jsx("div",{className:"font-mono",children:j==null?void 0:j.reference}),(j==null?void 0:j.walletMsisdn)&&v.jsx("div",{className:"font-mono",children:j==null?void 0:j.walletMsisdn})]}),v.jsxs("div",{className:"space-y-2 text-right",children:[v.jsx("div",{children:"  "}),v.jsx("div",{children:" "}),v.jsx("div",{children:" "}),(j==null?void 0:j.senderName)&&v.jsx("div",{children:"  "}),(j==null?void 0:j.reference)&&v.jsx("div",{children:"  "}),(j==null?void 0:j.walletMsisdn)&&v.jsx("div",{children:"  "})]})]})}),zn&&v.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[v.jsx("span",{className:"flex-1",children:"  ()"}),v.jsx("input",{type:"number",step:"0.01",min:"0",value:Fe,onChange:K=>Pn(K.target.value),className:"w-32 text-right border rounded px-2 py-1",placeholder:"0.00"})]}),_r&&v.jsxs("div",{className:"mt-2 border rounded-lg p-3 bg-amber-50",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("div",{className:"text-sm",children:" "}),v.jsxs("div",{className:"font-bold",children:[" ",mt.toLocaleString()]})]}),v.jsx("div",{className:"mt-3",children:v.jsx("input",{type:"text",value:kt,onChange:K=>ft(K.target.value),className:"w-full border rounded px-3 py-2 text-sm",placeholder:" "})}),v.jsx("div",{className:"mt-3",children:v.jsx(Vn,{className:"w-full bg-amber-600 hover:bg-amber-700 text-white",onClick:()=>{Cn(!0),Wn(!1)},children:""})})]}),In&&!_r&&v.jsx("div",{className:"mt-2 text-xs bg-amber-50 border border-amber-200 text-amber-800 rounded p-2",children:'   .  \\" \\"   .'}),v.jsx("div",{className:"pt-2",children:v.jsx("button",{type:"button",className:"w-full rounded-md px-3 py-2 text-sm font-medium bg-yellow-100 text-yellow-800 hover:bg-yellow-200",onClick:async()=>{var K;try{const H=String((j==null?void 0:j.text)||"").match(/\s+(\d+(?:[\.,]\d+)?)\s*/i),ie=H?parseFloat(String(H[1]).replace(",",".")):Number((j==null?void 0:j.amount)||0),{auth:Z}=await ne(async()=>{const{auth:ue}=await Promise.resolve().then(()=>qt);return{auth:ue}},void 0,import.meta.url),te=((K=Z.currentUser)==null?void 0:K.uid)||"",de=te?`selectedWallet_${te}`:"selectedWallet_default",ye=localStorage.getItem(de)||"",Q=Fe&&Fe.trim()!==""?Math.max(0,parseFloat(Fe)):null;let oe=0;if(Q!=null)oe=Q;else try{const{merchantWalletService:ue}=await ne(async()=>{const{merchantWalletService:Me}=await Promise.resolve().then(()=>sc);return{merchantWalletService:Me}},void 0,import.meta.url),_e=await ue.getById(String(ye)),me=_e&&_e.defaultWithdrawCommission;if(me!=null)oe=Math.round((Number(me)||0)*Number(ie)/1e3*100)/100;else{const{calculateCommission:Me}=await ne(async()=>{const{calculateCommission:ze}=await Promise.resolve().then(()=>nl);return{calculateCommission:ze}},void 0,import.meta.url);oe=Me(Number(ie),"receive")}}catch{const{calculateCommission:ue}=await ne(async()=>{const{calculateCommission:_e}=await Promise.resolve().then(()=>nl);return{calculateCommission:_e}},void 0,import.meta.url);oe=ue(Number(ie),"receive")}const ae=((localStorage.getItem("commissionMode")||"").toLowerCase()==="add"?"add":"deduct")==="add"?Number(ie)+Number(oe):Number(ie);Zt(Math.round(ae*100)/100),Wn(!0)}catch{Wn(!0)}},children:""})})]}),v.jsx("div",{className:"pt-3",children:v.jsx(Vn,{className:"w-full bg-green-600 hover:bg-green-700",onClick:()=>{try{const K=String((j==null?void 0:j.text)||""),z=K.match(/\s+(\d+(?:[\.,]\d+)?)\s*/i),H=z?parseFloat(String(z[1]).replace(",",".")):Number((j==null?void 0:j.amount)||0),ie=K.match(/\s+\s+(\d+)/i),Z=String((j==null?void 0:j.sender)||(ie?ie[1]:"")||""),te=K.match(/\s*\s*([\d\.]+)/i),de=String((j==null?void 0:j.reference)||(te?te[1]:String(Date.now())));Cr({...j,amount:H,sender:Z,reference:de,deferredMode:In,debtorName:kt,debtorNote:at})}catch{Cr()}},children:" "})})]})})]})},nP=()=>{const t=wi(),{user:e}=Ws(),n=t.pathname.startsWith("/user/login")||t.pathname.startsWith("/auth")||t.pathname.startsWith("/admin/login")||t.pathname.startsWith("/cpanel/login")||t.pathname.startsWith("/dashboard/login")||t.pathname==="/"||t.pathname.startsWith("/landing");return e&&!n?v.jsxs(v.Fragment,{children:[v.jsx(S$,{}),v.jsx(i3,{})]}):null},rP=()=>{const{user:t,loading:e}=Ws();return e?v.jsx(l0,{}):t?v.jsx(cp,{}):v.jsx(vg,{})},WX=()=>(S.useEffect(()=>{const t=async()=>{try{await gX.hide()}catch(n){console.warn("Error hiding splash screen:",n)}},e=document.getElementById("app-loading-screen");e&&(e.style.opacity="0",e.style.transition="opacity 0.2s ease",setTimeout(()=>e.remove(),200)),t()},[]),v.jsx(R6,{client:Ja,children:v.jsx(L5,{children:v.jsxs(HB,{children:[typeof window<"u"&&(window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"))&&!(Ee!=null&&Ee.isNativePlatform&&Ee.getPlatform()==="android")&&v.jsx(pX,{}),v.jsx($X,{}),typeof window<"u"&&(window.electronAPI||window.location.protocol==="file:"||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron")||typeof window.location.hash=="string"&&window.location.hash.startsWith("#/")||typeof import.meta<"u"&&jX||Ee!=null&&Ee.isNativePlatform&&Ee.getPlatform()==="android")?v.jsxs(k5,{children:[v.jsx(tP,{}),v.jsx(nP,{}),v.jsx(S.Suspense,{fallback:v.jsx(l0,{}),children:v.jsxs(eA,{children:[v.jsx(Pe,{path:"/",element:Ee!=null&&Ee.isNativePlatform&&Ee.getPlatform()==="android"?v.jsx(rP,{}):v.jsx(Am,{})}),v.jsx(Pe,{path:"/dashboard-redirect",element:v.jsx(OR,{})}),v.jsx(Pe,{path:"/landing",element:v.jsx(Am,{})}),v.jsx(Pe,{path:"/subscriptions",element:v.jsx(LR,{})}),v.jsx(Pe,{path:"/auth",element:v.jsx(MR,{})}),v.jsx(Pe,{path:"/user/login",element:v.jsx(vg,{})}),v.jsx(Pe,{path:"/user/forgot-password",element:v.jsx(jR,{})}),v.jsx(Pe,{path:"/user/register",element:v.jsx(Rm,{})}),v.jsx(Pe,{path:"/register",element:v.jsx(Rm,{})}),v.jsx(Pe,{path:"/user/account-setup",element:v.jsx(UR,{})}),v.jsx(Pe,{path:"/user/pending-approval",element:v.jsx(WR,{})}),v.jsx(Pe,{path:"/user/dashboard",element:v.jsx(cp,{})}),v.jsx(Pe,{path:"/branch/:shopId/dashboard",element:v.jsx(cp,{})}),v.jsx(Pe,{path:"/user/add-wallet",element:v.jsx(YR,{})}),v.jsx(Pe,{path:"/admin/login",element:v.jsx(qR,{})}),v.jsx(Pe,{path:"/admin/dashboard",element:v.jsx(HR,{})}),v.jsx(Pe,{path:"/admin/topups",element:v.jsx(VR,{})}),v.jsx(Pe,{path:"/admin/notifications",element:v.jsx(FR,{})}),v.jsx(Pe,{path:"/profile-settings",element:v.jsx(GR,{})}),v.jsx(Pe,{path:"/transactions",element:v.jsx(QR,{})}),v.jsx(Pe,{path:"/referrals",element:v.jsx(JR,{})}),v.jsx(Pe,{path:"/privacy-policy",element:v.jsx(ZR,{})}),v.jsx(Pe,{path:"/cpanel",element:v.jsx(PR,{})}),v.jsx(Pe,{path:"/cpanel/login",element:v.jsx(CR,{})}),v.jsx(Pe,{path:"/auth-test",element:v.jsx(KR,{})}),v.jsx(Pe,{path:"/topup",element:v.jsx(xm,{})}),v.jsx(Pe,{path:"/recharge",element:v.jsx(xm,{})}),v.jsx(Pe,{path:"/merchant/*",element:v.jsx(zR,{})}),v.jsx(Pe,{path:"/dashboard/login",element:v.jsx($R,{})}),v.jsx(Pe,{path:"/dashboard",element:v.jsx(BR,{})}),v.jsx(Pe,{path:"*",element:v.jsx(XR,{})})]})}),v.jsx(eP,{})]}):v.jsxs(C5,{children:[v.jsx(tP,{}),v.jsx(nP,{}),v.jsx(S.Suspense,{fallback:v.jsx(l0,{}),children:v.jsxs(eA,{children:[v.jsx(Pe,{path:"/",element:Ee!=null&&Ee.isNativePlatform&&Ee.getPlatform()==="android"?v.jsx(rP,{}):v.jsx(Am,{})}),v.jsx(Pe,{path:"/dashboard-redirect",element:v.jsx(OR,{})}),v.jsx(Pe,{path:"/landing",element:v.jsx(Am,{})}),v.jsx(Pe,{path:"/subscriptions",element:v.jsx(LR,{})}),v.jsx(Pe,{path:"/auth",element:v.jsx(MR,{})}),v.jsx(Pe,{path:"/user/login",element:v.jsx(vg,{})}),v.jsx(Pe,{path:"/user/forgot-password",element:v.jsx(jR,{})}),v.jsx(Pe,{path:"/user/register",element:v.jsx(Rm,{})}),v.jsx(Pe,{path:"/register",element:v.jsx(Rm,{})}),v.jsx(Pe,{path:"/user/account-setup",element:v.jsx(UR,{})}),v.jsx(Pe,{path:"/user/pending-approval",element:v.jsx(WR,{})}),v.jsx(Pe,{path:"/user/dashboard",element:v.jsx(cp,{})}),v.jsx(Pe,{path:"/user/add-wallet",element:v.jsx(YR,{})}),v.jsx(Pe,{path:"/admin/login",element:v.jsx(qR,{})}),v.jsx(Pe,{path:"/admin/dashboard",element:v.jsx(HR,{})}),v.jsx(Pe,{path:"/admin/topups",element:v.jsx(VR,{})}),v.jsx(Pe,{path:"/admin/notifications",element:v.jsx(FR,{})}),v.jsx(Pe,{path:"/profile-settings",element:v.jsx(GR,{})}),v.jsx(Pe,{path:"/transactions",element:v.jsx(QR,{})}),v.jsx(Pe,{path:"/referrals",element:v.jsx(JR,{})}),v.jsx(Pe,{path:"/privacy-policy",element:v.jsx(ZR,{})}),v.jsx(Pe,{path:"/cpanel",element:v.jsx(PR,{})}),v.jsx(Pe,{path:"/cpanel/login",element:v.jsx(CR,{})}),v.jsx(Pe,{path:"/auth-test",element:v.jsx(KR,{})}),v.jsx(Pe,{path:"/topup",element:v.jsx(xm,{})}),v.jsx(Pe,{path:"/recharge",element:v.jsx(xm,{})}),v.jsx(Pe,{path:"/merchant/*",element:v.jsx(zR,{})}),v.jsx(Pe,{path:"/dashboard/login",element:v.jsx($R,{})}),v.jsx(Pe,{path:"/dashboard",element:v.jsx(BR,{})}),v.jsx(Pe,{path:"*",element:v.jsx(XR,{})})]})}),v.jsx(eP,{})]})]})})})),lV=S.createContext(void 0),qX=({children:t})=>{const[e,n]=S.useState(null),[r,s]=S.useState(!1),[i,o]=S.useState(null),{profile:a,user:l}=Ws();S.useEffect(()=>{try{const m=localStorage.getItem("cashier_shift_user"),E=localStorage.getItem("cashier_shift_active"),p=localStorage.getItem("cashier_shift_start_at");m&&n(JSON.parse(m)),E&&s(E==="true"),p&&o(Number(p))}catch{}},[]);const c=async()=>{if(a!=null&&a.shopId)try{const m=Ce(G,"cashierShift",a.shopId),E=await Qt(m);if(E.exists()){const p=E.data(),I=(p==null?void 0:p.shiftUser)||null,g=!!(p!=null&&p.isShiftActive),_=(p==null?void 0:p.shiftStartAt)??null;let w=I;if(!w)try{const A=localStorage.getItem("cashier_shift_user"),P=A?JSON.parse(A):null;P&&(w=P)}catch{}n(w),s(g),o(typeof _=="number"?_:_?Number(_):null);try{w?localStorage.setItem("cashier_shift_user",JSON.stringify(w)):localStorage.removeItem("cashier_shift_user"),localStorage.setItem("cashier_shift_active",g?"true":"false"),_!=null&&localStorage.setItem("cashier_shift_start_at",String(_))}catch{}}else await on(m,{isShiftActive:!1,shiftStartAt:null,shiftUser:null})}catch(m){console.warn("Failed to refresh shift status:",m)}};S.useEffect(()=>{c()},[a==null?void 0:a.shopId]);const u=m=>{n(m);try{m?localStorage.setItem("cashier_shift_user",JSON.stringify(m)):localStorage.removeItem("cashier_shift_user")}catch{}try{if(a!=null&&a.shopId){const E=Ce(G,"cashierShift",a.shopId);wn(E,{shiftUser:m||null})}}catch{}},h=()=>{s(!0);try{localStorage.setItem("cashier_shift_active","true")}catch{}const m=Date.now();o(m);try{localStorage.setItem("cashier_shift_start_at",String(m))}catch{}try{if(a!=null&&a.shopId){const E=Ce(G,"cashierShift",a.shopId);wn(E,{isShiftActive:!0,shiftStartAt:m})}}catch{}try{const p=`cashBalance_${(l==null?void 0:l.uid)||"default"}`,I=`userCashBalance_${(l==null?void 0:l.uid)||"default"}`,g=`walletBalances_${(l==null?void 0:l.uid)||"default"}`;let _=localStorage.getItem(p);if(_==null){const A=localStorage.getItem(I);if(A!=null){_=A;try{localStorage.setItem(p,A),localStorage.removeItem(I)}catch{}}}if(_==null&&(l!=null&&l.uid)){const A=localStorage.getItem("cashBalance"),P=localStorage.getItem("userCashBalance");if(A!=null){try{localStorage.setItem(p,A),localStorage.removeItem("cashBalance")}catch{}_=A}else if(P!=null){try{localStorage.setItem(p,P),localStorage.removeItem("userCashBalance")}catch{}_=P}}const w=localStorage.getItem(g);_?localStorage.setItem("shiftStartDrawerFunds",_):localStorage.setItem("shiftStartDrawerFunds","0"),w?localStorage.setItem("shiftStartWalletBalances",w):localStorage.setItem("shiftStartWalletBalances","{}")}catch{}try{a!=null&&a.shopId&&(async()=>{try{const E=Ce(G,"dashboardData",a.shopId),p=await Qt(E);if(p.exists()){const I=p.data(),g=Number((I==null?void 0:I.cashBalance)??0),_=(I==null?void 0:I.walletBalances)??{};try{const w=localStorage.getItem("shiftStartDrawerFunds"),A=localStorage.getItem("shiftStartWalletBalances"),P=w?parseFloat(w):0,L=A?JSON.parse(A):{},x=!w||!Number.isFinite(P)||P===0,T=!A||Object.keys(L||{}).length===0;x&&localStorage.setItem("shiftStartDrawerFunds",String(Number.isFinite(g)?g:0)),T&&localStorage.setItem("shiftStartWalletBalances",JSON.stringify(_||{}))}catch{}}}catch(E){console.warn("Shift start Firebase read failed:",E)}})()}catch{}},f=()=>{s(!1);try{localStorage.setItem("cashier_shift_active","false")}catch{}try{if(a!=null&&a.shopId){const m=Ce(G,"cashierShift",a.shopId);wn(m,{isShiftActive:!1})}}catch{}};return v.jsx(lV.Provider,{value:{shiftUser:e,isShiftActive:r,shiftStartAt:i,setShiftUser:u,startShift:h,endShift:f,refreshShiftStatus:c},children:t})},PZ=()=>{const t=S.useContext(lV);if(!t)throw new Error("useShift must be used within ShiftProvider");return t};class HX extends S.Component{constructor(){super(...arguments);pd(this,"state",{hasError:!1,error:null});pd(this,"handleReload",()=>{window.location.reload()})}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("Uncaught error:",n,r)}render(){var n,r,s,i;if(this.state.hasError){const o=((r=(n=this.state.error)==null?void 0:n.message)==null?void 0:r.includes("removeChild"))||((i=(s=this.state.error)==null?void 0:s.message)==null?void 0:i.includes("NotFoundError"));return v.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50 p-4 text-center dark:bg-gray-900",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 space-y-4",children:[v.jsx("div",{className:"flex justify-center",children:v.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 rounded-full",children:v.jsx(_k,{className:"w-8 h-8 text-red-600 dark:text-red-400"})})}),v.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"    "}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:o?"         .   .":"    .    ."}),!1,v.jsxs(Vn,{onClick:this.handleReload,className:"w-full gap-2",children:[v.jsx(pE,{className:"w-4 h-4"})," "]})]})})}return this.props.children}}try{const t=navigator.userAgent||navigator.vendor||"",e=/iPad|iPhone|iPod/.test(t),n=document.documentElement;n&&(n.classList.toggle("ios",e),n.classList.toggle("android",!e))}catch{}try{oV()}catch{}const KX=()=>{const{theme:t="system"}=Ck();return S.useEffect(()=>{try{const e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,n=t==="system"?e?"dark":"light":t;document.documentElement.setAttribute("data-theme",n||"light"),document.documentElement.classList.toggle("dark",n==="dark")}catch{}},[t]),null};UC(document.getElementById("root")).render(v.jsx(HX,{children:v.jsx(x$,{attribute:"class",defaultTheme:"system",enableSystem:!0,storageKey:"theme",children:v.jsx(UY,{children:v.jsx(qX,{children:v.jsxs(FX,{children:[v.jsx(WX,{}),v.jsx(KX,{})]})})})})}));export{Yt as $,nw as A,Vn as B,gT as C,yk as D,pk as E,gk as F,mk as G,uW as H,ri as I,t0 as J,Ce as K,pw as L,Sj as M,iZ as N,gR as O,vk as P,SA as Q,F as R,Lj as S,Et as T,Uj as U,dW as V,on as W,Ct as X,Qt as Y,s0 as Z,dj as _,jl as a,a4 as a$,mE as a0,wi as a1,ms as a2,Xr as a3,UX as a4,fh as a5,Hc as a6,Kc as a7,Gc as a8,$u as a9,ne as aA,sp as aB,MX as aC,Ee as aD,gb as aE,ij as aF,ZK as aG,ST as aH,l0 as aI,_b as aJ,XM as aK,eA as aL,Pe as aM,zo as aN,Ga as aO,RY as aP,Ig as aQ,Fl as aR,a0 as aS,wG as aT,Ku as aU,uZ as aV,IZ as aW,XJ as aX,eX as aY,TZ as aZ,GM as a_,d4 as aa,_v as ab,Jt as ac,Lt as ad,lr as ae,uE as af,pi as ag,wn as ah,vb as ai,gE as aj,tM as ak,uY as al,gZ as am,cY as an,fj as ao,yb as ap,nj as aq,$j as ar,Oe as as,EY as at,Xn as au,aM as av,Aj as aw,cj as ax,PZ as ay,TT as az,yT as b,uN as b$,QM as b0,YM as b1,tX as b2,KM as b3,ZJ as b4,M5 as b5,lX as b6,wb as b7,n4 as b8,IY as b9,SZ as bA,_k as bB,$N as bC,yg as bD,hZ as bE,AK as bF,TA as bG,cZ as bH,aZ as bI,Ck as bJ,sV as bK,_Z as bL,wZ as bM,EZ as bN,bY as bO,AZ as bP,yX as bQ,Gg as bR,a6 as bS,e6 as bT,ZX as bU,cw as bV,Sr as bW,Qg as bX,XB as bY,ZB as bZ,Up as b_,aj as ba,yj as bb,jY as bc,zk as bd,qk as be,YX as bf,AB as bg,cE as bh,BJ as bi,BC as bj,nJ as bk,PM as bl,kh as bm,wM as bn,Ug as bo,xB as bp,RB as bq,jC as br,fT as bs,IX as bt,zi as bu,P4 as bv,cf as bw,dZ as bx,tV as by,nV as bz,vT as c,E6 as c0,r6 as c1,br as c2,eZ as c3,rZ as c4,_t as c5,sZ as c6,oM as c7,Qa as c8,sT as c9,vX as ca,xZ as cb,pl as cc,SY as cd,fX as ce,yZ as cf,hX as cg,vZ as ch,dX as ci,TY as cj,Mn as ck,qt as cl,sc as cm,Kv as cn,bZ as co,mX as cp,RZ as cq,d0 as cr,yM as d,_T as e,HY as f,oZ as g,aX as h,lE as i,v as j,ZM as k,sX as l,Ot as m,ke as n,G as o,ra as p,Ve as q,S as r,id as s,Be as t,Ws as u,Li as v,ZG as w,nM as x,mi as y,Le as z};
//# sourceMappingURL=index-CWTdLx7E.js.map
