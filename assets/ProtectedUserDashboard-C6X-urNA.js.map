{"version":3,"mappings":"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","names":["LEGACY_STORAGE_KEY","UserBroadcastModal","user","profile","isSubscriptionActive","userSubscription","useFirebaseAuth","broadcast","setBroadcast","useState","open","setOpen","mounted","setMounted","remoteDismissed","setRemoteDismissed","location","useLocation","navigate","useNavigate","storageKey","useMemo","audienceKeys","keys","isAdminRoute","useEffect","ref","doc","db","snap","n","m","data","arr","raw","localArr","union","err","unsubscribe","subscribeToActiveBroadcasts","b","rawNew","rawLegacy","arrNew","arrLegacy","dismissed","id","alreadyDismissed","handleClose","dismissedRaw","updateDoc","arrayUnion","e","jsxs","jsx","X","url","ExternalLink","LinkIcon","KEY_BASE","SESSION_KEY_BASE","getKey","userId","getSessionKey","quickLoginService","enabled","UserDashboardPageLazy","React","__vitePreload","ProtectedUserDashboard","loading","refreshProfile","checkSubscriptionStatus","isAuthenticated","setIsAuthenticated","isQuickLoginDialogOpen","setIsQuickLoginDialogOpen","useToast","hydrationReady","setHydrationReady","interval","subData","isTrial","endDate","_a","rawEnd","_b","branchActive","trialActive","quickEnabled","sessionVerified","timer","accountActive","active","generateStateSignature","u","sub","activatedAt","plan","isActive","subActive","branchActivatedAt","isElectronEnv","Capacitor","LogoLoader","MasterPinDialog","Fragment"],"ignoreList":[],"sources":["../../src/components/UserBroadcastModal.tsx","../../src/utils/quickLoginService.ts","../../src/components/ProtectedUserDashboard.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { X } from 'lucide-react';\r\nimport { Link as LinkIcon, ExternalLink } from 'lucide-react';\r\nimport { subscribeToActiveBroadcasts, type Broadcast } from '@/utils/broadcastService';\r\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport { db } from '@/firebase';\r\nimport { doc, updateDoc, arrayUnion } from 'firebase/firestore';\r\n\r\n// Ù…ÙØªØ§Ø­ ØªØ®Ø²ÙŠÙ† Ù…Ø­Ù„ÙŠ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¶Ù…Ø§Ù† Ø«Ø¨Ø§Øª Ø§Ù„Ø¥Ø®ÙØ§Ø¡ Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù…\r\n// ÙŠØªÙ… Ø£ÙŠØ¶Ø§Ù‹ Ø¯Ø¹Ù… Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ±Ø­ÙŠÙ„ Ø¨Ø³Ù„Ø§Ø³Ø©\r\nconst LEGACY_STORAGE_KEY = 'dismissedBroadcastIds';\r\n\r\nexport const UserBroadcastModal: React.FC = () => {\r\n  const { user, profile, isSubscriptionActive, userSubscription } = useFirebaseAuth();\r\n  const [broadcast, setBroadcast] = useState<Broadcast | null>(null);\r\n  const [open, setOpen] = useState(false);\r\n  const [mounted, setMounted] = useState(false); // Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„Ø³Ù„Ø³\r\n  const [remoteDismissed, setRemoteDismissed] = useState<string[]>([]);\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n\r\n  const storageKey = useMemo(() => `dismissedBroadcastIds:${user?.uid || 'global'}`,[user?.uid]);\r\n\r\n  const audienceKeys = useMemo(() => {\r\n    const keys = ['global'];\r\n    if (profile?.shopId) keys.push(`shop:${profile.shopId}`);\r\n    if (user?.uid) keys.push(`user:${user.uid}`);\r\n    return keys;\r\n  }, [profile?.shopId, user?.uid]);\r\n\r\n  const isAdminRoute = location.pathname.startsWith('/admin');\r\n\r\n  // Ø¬Ù„Ø¨ Ù…Ù„Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ù„Ø¬Ù„Ø¨ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© ÙÙŠ Firestore\r\n  useEffect(() => {\r\n    if (!user?.uid) return;\r\n    const fetchUserDismissals = async () => {\r\n      try {\r\n        const ref = doc(db, 'users', user.uid);\r\n        const snap = await import('firebase/firestore').then(m => m.getDoc(ref));\r\n        if (snap.exists()) {\r\n          const data = snap.data() as any;\r\n          const arr = Array.isArray(data?.dismissedBroadcastIds) ? data.dismissedBroadcastIds : [];\r\n          setRemoteDismissed(arr);\r\n          // Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ\r\n          try {\r\n            const raw = localStorage.getItem(storageKey);\r\n            const localArr = raw ? JSON.parse(raw) : [];\r\n            const union = Array.from(new Set([...(Array.isArray(localArr) ? localArr : []), ...arr]));\r\n            localStorage.setItem(storageKey, JSON.stringify(union));\r\n            localStorage.setItem(LEGACY_STORAGE_KEY, JSON.stringify(union));\r\n          } catch {}\r\n        }\r\n      } catch (err) {\r\n        console.error('UserBroadcastModal: fetch user error', err);\r\n      }\r\n    };\r\n    fetchUserDismissals();\r\n  }, [user?.uid, storageKey]);\r\n\r\n  useEffect(() => {\r\n    if (!user || isAdminRoute) return; // Ù†Ø´Ø· ÙÙ‚Ø· Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙˆØºÙŠØ± Ø§Ù„Ø£Ø¯Ù…Ù†\r\n\r\n    // Ø§Ù„Ø³Ù…Ø§Ø­ ÙÙ‚Ø· Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ÙØ¹Ù„ÙŠÙ† Ø£Ùˆ Ø¹Ù„Ù‰ ØªØ¬Ø±Ø¨Ø© Ù…Ø¬Ø§Ù†ÙŠØ© Ù†Ø´Ø·Ø©\r\n    const isEligible = (profile?.approved === true) || isSubscriptionActive || (userSubscription as any)?.isOnFreeTrial === true;\r\n    if (!isEligible) return;\r\n\r\n    const unsubscribe = subscribeToActiveBroadcasts(audienceKeys, (b) => {\r\n      // Ù„Ø§ Ù†ØºÙ„Ù‚ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ØºÙŠØ§Ø¨ Ø¨Ø« Ù†Ø´Ø·Ø› Ù†Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©\r\n      if (!b) {\r\n        return;\r\n      }\r\n      setBroadcast(b);\r\n      try {\r\n        const rawNew = localStorage.getItem(storageKey);\r\n        const rawLegacy = localStorage.getItem(LEGACY_STORAGE_KEY);\r\n        const arrNew = rawNew ? JSON.parse(rawNew) as any : [];\r\n        const arrLegacy = rawLegacy ? JSON.parse(rawLegacy) as any : [];\r\n        const dismissed: string[] = Array.isArray(arrNew) ? [...arrNew] : [];\r\n        if (Array.isArray(arrLegacy)) {\r\n          for (const id of arrLegacy) {\r\n            if (!dismissed.includes(id)) dismissed.push(id);\r\n          }\r\n        }\r\n        // Ø¯Ù…Ø¬ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© Ù…Ù† Firestore\r\n        if (Array.isArray(remoteDismissed)) {\r\n          for (const id of remoteDismissed) {\r\n            if (!dismissed.includes(id)) dismissed.push(id);\r\n          }\r\n        }\r\n        const alreadyDismissed = b.id && dismissed.includes(b.id);\r\n        setOpen(!alreadyDismissed);\r\n        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø¨Ø« Ø¬Ø¯ÙŠØ¯\r\n        setMounted(false);\r\n        requestAnimationFrame(() => setMounted(true));\r\n      } catch {\r\n        setOpen(true);\r\n        setMounted(true);\r\n      }\r\n    });\r\n    return () => unsubscribe();\r\n  }, [user, audienceKeys, isAdminRoute, profile?.approved, isSubscriptionActive, userSubscription, remoteDismissed]);\r\n\r\n  const handleClose = async () => {\r\n    setOpen(false);\r\n    try {\r\n      const dismissedRaw = localStorage.getItem(storageKey);\r\n      const dismissed = dismissedRaw ? JSON.parse(dismissedRaw) as string[] : [];\r\n      const id = broadcast?.id;\r\n      if (id && !dismissed.includes(id)) {\r\n        dismissed.push(id);\r\n        localStorage.setItem(storageKey, JSON.stringify(dismissed));\r\n        // ÙƒØªØ§Ø¨Ø© Ù„Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø£ÙŠØ¶Ø§Ù‹ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø£ÙŠ Ù‚Ø±Ø§Ø¡Ø§Øª Ø³Ø§Ø¨Ù‚Ø©\r\n        try {\r\n          localStorage.setItem(LEGACY_STORAGE_KEY, JSON.stringify(dismissed));\r\n        } catch {}\r\n        // ØªØ­Ø¯ÙŠØ« Firestore Ù„ÙŠØµØ¨Ø­ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ù…Ø´ØªØ±ÙƒÙ‹Ø§ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©\r\n        try {\r\n          if (user?.uid) {\r\n            await updateDoc(doc(db, 'users', user.uid), { dismissedBroadcastIds: arrayUnion(id) });\r\n          }\r\n        } catch (e) {\r\n          console.warn('UserBroadcastModal: failed to update dismissedBroadcastIds in Firestore', e);\r\n        }\r\n      }\r\n    } catch {}\r\n  };\r\n\r\n  if (!open || !broadcast) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[9999]\">\r\n      <div\r\n        className={`absolute inset-0 transition-opacity duration-300 ease-out ${mounted ? 'opacity-100' : 'opacity-0'} bg-black/20 dark:bg-black/20`}\r\n      />\r\n\r\n      {/* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù…Ø¹ Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø£Ù†ÙŠÙ‚ */}\r\n      <div\r\n        className={`absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[92%] sm:w-auto sm:min-w-[380px] sm:max-w-md md:max-w-lg bg-white shadow-2xl rounded-2xl border border-gray-100 ring-1 ring-black/5 transition-all duration-300 ease-out ${mounted ? 'opacity-100 scale-100' : 'opacity-0 scale-95'}`}\r\n      >\r\n        {/* Ø±Ø£Ø³ Ø¨ØªØ¯Ø±Ø¬ Ù„ÙˆÙ†ÙŠ Ø¬Ø°Ø§Ø¨ */}\r\n        <div className=\"relative overflow-hidden rounded-t-2xl\">\r\n          <div className=\"bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 relative\">\r\n            <button\r\n              aria-label=\"Ø¥ØºÙ„Ø§Ù‚\"\r\n              onClick={handleClose}\r\n              className=\"absolute top-3 right-3 p-2 rounded-full bg-white/10 hover:bg-white/20\"\r\n            >\r\n              <X className=\"w-5 h-5 text-white\" />\r\n            </button>\r\n            <div className=\"p-4\">\r\n              <h3 className=\"text-base sm:text-lg font-semibold text-white tracking-wide text-center\">\r\n                {broadcast.title || 'Ø¥Ø´Ø¹Ø§Ø±'}\r\n              </h3>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */}\r\n        <div className=\"p-5\">\r\n          <div className=\"flex items-start justify-between gap-3\">\r\n            <p className=\"text-gray-700 leading-relaxed text-sm sm:text-base\">\r\n              {broadcast.message}\r\n            </p>\r\n            {/* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù† ÙˆÙØ¬Ø¯ */}\r\n            {broadcast.linkUrl && (\r\n              <button\r\n                aria-label=\"ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·\"\r\n                title=\"ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·\"\r\n                onClick={() => {\r\n                  const url = broadcast.linkUrl as string;\r\n                  if (/^https?:\\/\\//i.test(url)) {\r\n                    window.open(url, '_blank', 'noopener');\r\n                  } else {\r\n                    navigate(url);\r\n                  }\r\n                }}\r\n                className=\"shrink-0 inline-flex items-center gap-2 px-3 py-2 rounded-md bg-indigo-600 text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-400 whitespace-nowrap\"\r\n              >\r\n                {/^https?:\\/\\//i.test(broadcast.linkUrl) ? (\r\n                  <ExternalLink className=\"w-6 h-6\" />\r\n                ) : (\r\n                  <LinkIcon className=\"w-6 h-6\" />\r\n                )}\r\n                <span className=\"text-xs sm:text-sm font-semibold\">ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·</span>\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserBroadcastModal;","// Ø®Ø¯Ù…Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹: Ø­ÙØ¸ ØªÙØ¶ÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙÙ‚Ø· Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚\r\n// ØªØ®Ø²ÙŠÙ† Ø§Ù„ØªÙØ¹ÙŠÙ„ ÙÙŠ localStorageØŒ ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙŠ sessionStorage\r\n\r\nconst KEY_BASE = 'quick_login_enabled';\r\nconst SESSION_KEY_BASE = 'quick_login_session_verified';\r\n\r\nfunction getKey(userId?: string) {\r\n  return userId ? `${KEY_BASE}_${userId}` : KEY_BASE;\r\n}\r\n\r\nfunction getSessionKey(userId?: string) {\r\n  return userId ? `${SESSION_KEY_BASE}_${userId}` : SESSION_KEY_BASE;\r\n}\r\n\r\nexport const quickLoginService = {\r\n  isEnabled(userId?: string): boolean {\r\n    try {\r\n      const val = localStorage.getItem(getKey(userId));\r\n      return val === 'true';\r\n    } catch {\r\n      return false;\r\n    }\r\n  },\r\n\r\n  setEnabled(enabled: boolean, userId?: string): void {\r\n    try {\r\n      localStorage.setItem(getKey(userId), enabled ? 'true' : 'false');\r\n      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ØªØ­Ù‚Ù‚ Ø§Ù„Ø¬Ù„Ø³Ø© Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯\r\n      sessionStorage.removeItem(getSessionKey(userId));\r\n    } catch {}\r\n  },\r\n\r\n  isSessionVerified(userId?: string): boolean {\r\n    try {\r\n      return sessionStorage.getItem(getSessionKey(userId)) === 'true';\r\n    } catch {\r\n      return false;\r\n    }\r\n  },\r\n\r\n  markSessionVerified(userId?: string): void {\r\n    try {\r\n      sessionStorage.setItem(getSessionKey(userId), 'true');\r\n    } catch {}\r\n  }\r\n};","import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\r\nimport UserBroadcastModal from './UserBroadcastModal';\r\n// ØªÙ… Ø¥Ø²Ø§Ù„Ø© TrialOfferModal\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport LogoLoader from '@/components/LogoLoader';\r\nimport { MasterPinDialog } from '@/components/MasterPinDialog';\r\nimport { quickLoginService } from '@/utils/quickLoginService';\r\nimport { Capacitor } from '@capacitor/core';\r\n// ØµÙØ­Ø© Ø·Ù„Ø¨ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø³ÙŠØªÙ… ÙØªØ­Ù‡Ø§ Ø¹Ø¨Ø± Ø§Ù„ØªÙˆØ¬ÙŠÙ‡\r\n\r\nconst UserDashboardPageLazy = React.lazy(() => import('../pages/UserDashboardPage'));\r\n\r\nconst ProtectedUserDashboard = () => {\r\n  const navigate = useNavigate();\r\n  const { user, profile, loading, refreshProfile, isSubscriptionActive, userSubscription, checkSubscriptionStatus } = useFirebaseAuth();\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [isQuickLoginDialogOpen, setIsQuickLoginDialogOpen] = useState(false);\r\n  const { toast } = useToast();\r\n  const [hydrationReady, setHydrationReady] = useState(false);\r\n  \r\n  // Check trial or subscription validity periodically (CLIENT-SIDE ONLY)\r\n  useEffect(() => {\r\n    if (!user?.uid || !userSubscription) return;\r\n    \r\n    // We only use client-side interval to update UI state if expired locally.\r\n    // We do NOT call Firestore.\r\n    const checkValidityClientSide = () => {\r\n      const subData = userSubscription as any;\r\n      const isTrial = subData?.isOnFreeTrial === true;\r\n      let endDate: Date | null = null;\r\n\r\n      if (isTrial) {\r\n         endDate = subData.freeTrialEndDate?.toDate ? subData.freeTrialEndDate.toDate() : (subData.freeTrialEndDate ? new Date(subData.freeTrialEndDate) : null);\r\n      } else {\r\n         const rawEnd = subData?.subscription?.endDate;\r\n         endDate = rawEnd?.toDate ? rawEnd.toDate() : (rawEnd ? new Date(rawEnd) : null);\r\n      }\r\n      \r\n      if (endDate) {\r\n        const now = new Date();\r\n        if (now.getTime() > endDate.getTime()) {\r\n           console.log('ProtectedUserDashboard: Subscription/Trial expired client-side.');\r\n           // We could force a state update here if needed, but since we rely on \r\n           // isSubscriptionActive from context which is already set, \r\n           // we might just need to trigger a re-render or navigation.\r\n           // However, avoiding a loop is key.\r\n           // If we navigate to PendingApproval, that page handles the \"locked\" state.\r\n           navigate('/user/pending-approval');\r\n        }\r\n      }\r\n    };\r\n    \r\n    // Check every minute (Client Side Only)\r\n    const interval = setInterval(checkValidityClientSide, 60 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [user?.uid, userSubscription, navigate]);\r\n\r\n\r\n  // Removed real-time listener logic as requested to strictly limit reads.\r\n  // Updates are now manual only.\r\n  useEffect(() => {\r\n    return () => {};\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log('ProtectedUserDashboard - useEffect triggered', { \r\n      loading, \r\n      user: user ? 'exists' : 'null', \r\n      profile: profile ? { role: profile.role, approved: profile.approved } : 'null',\r\n      isSubscriptionActive,\r\n      userSubscription: userSubscription ? 'exists' : 'null'\r\n    });\r\n    \r\n    if (!loading) {\r\n      if (!user) {\r\n        console.log('ProtectedUserDashboard - No user, redirecting to login');\r\n        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…\r\n        navigate('/user/login');\r\n      } else if (profile) {\r\n        console.log('ProtectedUserDashboard - Profile found:', { \r\n          role: profile.role, \r\n          approved: profile.approved,\r\n          isSubscriptionActive,\r\n          hasSubscription: !!userSubscription?.subscription\r\n        });\r\n        \r\n        if (userSubscription) {\r\n          const branchActive = userSubscription?.branchPackage?.status === 'active';\r\n          const trialActive = (userSubscription as any)?.isOnFreeTrial === true;\r\n          const active = !!isSubscriptionActive || !!(userSubscription?.subscription?.isActive === true) || trialActive;\r\n          const shouldGoPending = !active && !branchActive;\r\n          if (shouldGoPending) {\r\n            try { navigate('/user/pending-approval', { replace: true }); } catch {}\r\n            return;\r\n          }\r\n          if (profile.role === \"user\") {\r\n            setIsAuthenticated(true);\r\n          }\r\n          const quickEnabled = quickLoginService.isEnabled(user?.uid);\r\n          const sessionVerified = quickLoginService.isSessionVerified(user?.uid);\r\n          if (quickEnabled && !sessionVerified) {\r\n            try { quickLoginService.markSessionVerified(user?.uid); } catch {}\r\n            setIsQuickLoginDialogOpen(false);\r\n            setIsAuthenticated(true);\r\n          } else {\r\n            setIsAuthenticated(true);\r\n          }\r\n        } else {\r\n          try { checkSubscriptionStatus(); } catch {}\r\n          return;\r\n        }\r\n      }\r\n    }\r\n  }, [user, profile, loading, navigate, isSubscriptionActive, userSubscription]);\r\n\r\n  useEffect(() => {\r\n    let timer: any = null;\r\n    if (!loading && !!user) {\r\n      setHydrationReady(true);\r\n    } else if (user) {\r\n      timer = setTimeout(() => setHydrationReady(true), 3000);\r\n    }\r\n    return () => { try { clearTimeout(timer); } catch {} };\r\n  }, [loading, user]);\r\n\r\n  useEffect(() => {\r\n    if (loading) return;\r\n    if (!user) return;\r\n    if (!hydrationReady) return;\r\n    if (!userSubscription) return;\r\n    const accountActive = (userSubscription as any)?.isActive !== false;\r\n    const branchActive = userSubscription?.branchPackage?.status === 'active';\r\n    const trialActive = (userSubscription as any)?.isOnFreeTrial === true;\r\n    const active = !!isSubscriptionActive || !!(userSubscription?.subscription?.isActive === true) || trialActive;\r\n    \r\n    // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ØªÙˆÙ„ÙŠØ¯ ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø©\r\n    const generateStateSignature = (u: any) => {\r\n      if (!u) return 'null';\r\n      const sub = u.subscription;\r\n      const activatedAt = sub?.activatedAt ? (sub.activatedAt.toDate ? sub.activatedAt.toDate().toISOString() : new Date(sub.activatedAt).toISOString()) : 'null';\r\n      const plan = sub?.planType || 'null';\r\n      const isActive = u.isActive !== false;\r\n      const subActive = sub?.isActive === true;\r\n      const branchActive = u.branchPackage?.status === 'active';\r\n      const branchActivatedAt = u.branchPackage?.activatedAt ? (u.branchPackage.activatedAt.toDate ? u.branchPackage.activatedAt.toDate().toISOString() : new Date(u.branchPackage.activatedAt).toISOString()) : 'null';\r\n      return `${isActive}|${subActive}|${plan}|${activatedAt}|${branchActive}|${branchActivatedAt}`;\r\n    };\r\n\r\n    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…Ø¹Ø·Ù„Ø§Ù‹ (isActive=false)ØŒ ÙŠØ¬Ø¨ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± ÙÙˆØ±Ø§Ù‹ Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ\r\n    if (!accountActive) {\r\n      console.log('â›” ProtectedUserDashboard: Account is deactivated, redirecting to pending approval');\r\n      try { \r\n        sessionStorage.setItem('dashboard_kick_signature', generateStateSignature(userSubscription));\r\n        navigate('/user/pending-approval', { replace: true }); \r\n      } catch {}\r\n      return;\r\n    }\r\n\r\n    if (!active && !branchActive) {\r\n      try { \r\n        sessionStorage.setItem('dashboard_kick_signature', generateStateSignature(userSubscription));\r\n        navigate('/user/pending-approval'); \r\n      } catch {}\r\n    }\r\n  }, [loading, user, userSubscription, isSubscriptionActive, navigate, hydrationReady]);\r\n\r\n  useEffect(() => {\r\n    if (loading) return;\r\n    if (!user) return;\r\n    if (!hydrationReady) return;\r\n    return;\r\n  }, [loading, user, userSubscription, isSubscriptionActive, checkSubscriptionStatus, navigate, hydrationReady]);\r\n\r\n  const isElectronEnv = (typeof window !== 'undefined' && (((window as any).electronAPI) || (typeof navigator !== 'undefined' && navigator.userAgent.toLowerCase().includes('electron')) || (typeof window !== 'undefined' && window.location && window.location.protocol === 'file:')));\r\n  const isAndroidNative = Capacitor?.isNativePlatform && Capacitor.getPlatform() === 'android';\r\n\r\n  // Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø­Ù…Ù‘Ù„ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ØŒ ÙˆØ¹Ù„Ù‰ Ø§Ù„Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯ ÙÙ‚Ø· Ø¥Ø°Ø§ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…\r\n  if (loading && (isElectronEnv || !user)) {\r\n    return <LogoLoader />;\r\n  }\r\n\r\n  if (!hydrationReady) {\r\n    return <LogoLoader />;\r\n  }\r\n\r\n  // ÙÙŠ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø¨Ø³Ø¨Ø¨ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹ØŒ Ø§Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙÙˆÙ‚ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„\r\n  if (!isAuthenticated) {\r\n    return (\r\n      <>\r\n        <LogoLoader />\r\n        <MasterPinDialog\r\n          open={isQuickLoginDialogOpen}\r\n          onOpenChange={(open) => setIsQuickLoginDialogOpen(open)}\r\n          mode=\"verify\"\r\n          title=\"Ø§Ù„ØªØ­Ù‚Ù‚ Ù„Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹\"\r\n          description=\"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…\"\r\n          onSuccess={() => {\r\n            // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¬Ù„Ø³Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø© ÙÙ‚Ø·\r\n            quickLoginService.markSessionVerified(user?.uid);\r\n            setIsQuickLoginDialogOpen(false);\r\n            setIsAuthenticated(true);\r\n          }}\r\n        />\r\n      </>\r\n    );\r\n  }\r\n\r\n  console.log('ProtectedUserDashboard - Render state:', { \r\n    isAuthenticated, \r\n    profileRole: profile?.role,\r\n    profileApproved: profile?.approved,\r\n    isSubscriptionActive,\r\n    hasSubscription: !!userSubscription?.subscription\r\n  });\r\n\r\n  console.log('ğŸ”¥ ProtectedUserDashboard - user:', user ? { uid: user.uid, email: user.email } : 'null');\r\n  console.log('ğŸ”¥ ProtectedUserDashboard - profile:', profile ? { userId: profile.userId, role: profile.role } : 'null');\r\n  console.log('ğŸ”¥ ProtectedUserDashboard - loading:', loading);\r\n  console.log('ğŸ”¥ ProtectedUserDashboard - About to render UserDashboardPage');\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <React.Suspense fallback={<LogoLoader /> }>\r\n        <UserDashboardPageLazy />\r\n      </React.Suspense>\r\n      <UserBroadcastModal />\r\n      <MasterPinDialog\r\n        open={isQuickLoginDialogOpen}\r\n        onOpenChange={(open) => setIsQuickLoginDialogOpen(open)}\r\n        mode=\"verify\"\r\n        title=\"Ø§Ù„ØªØ­Ù‚Ù‚ Ù„Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹\"\r\n        description=\"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…\"\r\n        onSuccess={() => {\r\n          quickLoginService.markSessionVerified(user?.uid);\r\n          setIsQuickLoginDialogOpen(false);\r\n          setIsAuthenticated(true);\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProtectedUserDashboard;\r\n"],"file":"assets/ProtectedUserDashboard-C6X-urNA.js"}