const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./web-BIhoFa7_.js","./index-DhbnydJl.js","./index-DLaPizfT.css","./contentService-Co2zXytx.js","./ProfileIcon-IxzO755X.js","./switch-klIFyYmY.js","./freeTrialService-u-lJSTVe.js","./alert-DViuKvlp.js","./separator-Cn84CDdZ.js","./save-DZuHrrpv.js","./gift-DSYL8rJL.js","./broadcastService-BQWgcmoe.js","./bell-C-d1sJAh.js","./calendar-4dCWv1Gk.js","./select-Bn8RCTk-.js","./zap-CVW2mOxW.js","./crown-D1WD830B.js","./star-BSPZIAqJ.js","./circle-check-big-Dtvck6_a.js","./table-B1_nzBiE.js","./tabs-VyDQ-WsJ.js","./index-xL9tDy8r.js","./square-pen-CSLFtBCt.js","./progress-QxZkw5ok.js","./download-CAzB5lkL.js","./users-D9PlfCO2.js","./activity-NKT3hJFE.js","./monitor-B97Iq5Zs.js","./pen-line-DHrJReBO.js"])))=>i.map(i=>d[i]);
import{a0 as et,W as je,t as he,an as Fe,E as pt,q as He,aH as ut,s as Se,x as qe,D as $i,b as Vi,m as Vn,r as M,j as e,c as At,d as $t,e as Vt,M as Sr,g as kt,b8 as dr,f as qn,aD as qi,y as Zt,P as Zn,I as Yt,T as Zi,B as Ae,J as Yi,K as Gi,a3 as dt,i as Yn,at as Gn,aT as de,aq as mt,U as Ps,C as it,b$ as qt,R as hr,bd as Ki,G as Xi,cb as Dt,S as ar,H as Hs,be as $a,aE as Qi,cr as Ji,v as e0,V as Va,ap as qa,aa as nr,ab as ir,ac as or,ad as lr,aR as Dr,aK as xt,w as t0,cs as r0,cg as Kn,ch as fe,ct as s0,cu as a0,aN as ke,ci as Xn,b5 as Za,p as Vs,$ as qs,a1 as Ir,aL as n0,bc as i0,aI as o0,bb as l0,Z as nt,bE as c0,cv as d0,cw as Qn,Y as x0,b1 as u0,aW as h0,ay as ss,o as Pt,cx as as,aP as Jn,z as f0,A as m0,cy as ei,cz as p0,a as g0,u as v0,bh as b0}from"./index-DhbnydJl.js";import{I as y0,u as w0,g as Ya,s as _0,l as j0}from"./contentService-Co2zXytx.js";import{P as N0}from"./ProfileIcon-IxzO755X.js";import{S as ti}from"./switch-klIFyYmY.js";import{A as ri,a as si,b as C0}from"./alert-DViuKvlp.js";import{S as E0}from"./separator-Cn84CDdZ.js";import{S as Ht}from"./save-DZuHrrpv.js";import{C as ai,G as ft}from"./gift-DSYL8rJL.js";import{E as A0,p as k0}from"./broadcastService-BQWgcmoe.js";import{B as Mt}from"./bell-C-d1sJAh.js";import{C as Je}from"./calendar-4dCWv1Gk.js";import{S as Rr,a as Tr,b as zr,c as Ur,d as Ve}from"./select-Bn8RCTk-.js";import{Z as fr}from"./zap-CVW2mOxW.js";import{C as xr}from"./crown-D1WD830B.js";import{S as D0}from"./star-BSPZIAqJ.js";import{C as ur}from"./circle-check-big-Dtvck6_a.js";import{T as Ga,a as Ka,b as Ct,c as Xe,d as Xa,e as Pe}from"./table-B1_nzBiE.js";import{T as B0,a as F0,b as Qa,c as Ja,S as Et}from"./tabs-VyDQ-WsJ.js";import{S as S0}from"./square-pen-CSLFtBCt.js";import{P as I0}from"./progress-QxZkw5ok.js";import{D as Br}from"./download-CAzB5lkL.js";import{U as sr,C as R0}from"./users-D9PlfCO2.js";import{A as en}from"./activity-NKT3hJFE.js";import{M as tn}from"./monitor-B97Iq5Zs.js";import{P as T0}from"./pen-line-DHrJReBO.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z0=[["path",{d:"M13.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v11.5",key:"4pqfef"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 12v-1",key:"1ej8lb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M8 7V6",key:"1nbb54"}],["circle",{cx:"8",cy:"20",r:"2",key:"ckkr5m"}]],U0=et("file-archive",z0);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],O0=et("funnel",L0);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],rn=et("git-branch",P0);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],sn=et("hard-drive",H0);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M0=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],W0=et("menu",M0);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $0=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ms=et("shield-check",$0);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Fr=et("upload",V0);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ws=et("user-check",q0);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Y0=et("user-x",Z0);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],K0=et("volume-2",G0);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],Q0=et("volume-x",X0),an={generateCode:async R=>{const U="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let v="";for(let _=0;_<8;_++)v+=U.charAt(Math.floor(Math.random()*U.length));const w=`${v.substring(0,4)}-${v.substring(4)}`;return await $i(Se(he,"branchActivationCodes"),{code:w,isUsed:!1,createdAt:pt(),createdBy:R}),w},getAllCodes:async()=>{const R=He(Se(he,"branchActivationCodes"));return(await qe(R)).docs.map(v=>({id:v.id,...v.data()})).sort((v,w)=>{var b,l;const _=(b=v.createdAt)!=null&&b.toMillis?v.createdAt.toMillis():0;return((l=w.createdAt)!=null&&l.toMillis?w.createdAt.toMillis():0)-_})},validateCode:async R=>{const U=He(Se(he,"branchActivationCodes"),ut("code","==",R)),v=await qe(U);if(v.empty)throw new Error("كود التفعيل غير صحيح");const w=v.docs[0].data(),_=v.docs[0].id;if(w.isUsed)throw new Error("تم استخدام هذا الكود مسبقاً");return{...w,docId:_}},markCodeAsUsed:async(R,U,v)=>{const w=je(he,"branchActivationCodes",R);await Fe(w,{isUsed:!0,usedAt:pt(),usedBy:U,createdShopId:v})}},J0=()=>{const{settings:R,loading:U,error:v,updateSettings:w,refreshSettings:_}=Vi(),{toast:m}=Vn(),[b,l]=M.useState({phoneNumber:"",defaultMessage:"",isEnabled:!0}),[u,s]=M.useState(!1),[d,x]=M.useState(!1),[i,r]=M.useState(""),[a,t]=M.useState({});M.useEffect(()=>{R&&l({phoneNumber:R.phoneNumber,defaultMessage:R.defaultMessage,isEnabled:R.isEnabled})},[R]);const o=()=>{var A,D;const j={};return(A=b.phoneNumber)!=null&&A.trim()?Gn(b.phoneNumber)||(j.phoneNumber="رقم الواتساب غير صحيح (يجب أن يحتوي على 10-15 رقم)"):j.phoneNumber="رقم الواتساب مطلوب",(D=b.defaultMessage)!=null&&D.trim()?b.defaultMessage.length<10&&(j.defaultMessage="الرسالة يجب أن تحتوي على 10 أحرف على الأقل"):j.defaultMessage="الرسالة الافتراضية مطلوبة",t(j),Object.keys(j).length===0},c=async()=>{if(!o()){m({title:"خطأ في البيانات",description:"يرجى تصحيح الأخطاء قبل الحفظ",variant:"destructive"});return}s(!0);try{if(await w(b))m({title:"تم الحفظ بنجاح",description:"تم تحديث إعدادات الواتساب بنجاح",variant:"default"});else throw new Error("فشل في الحفظ")}catch{m({title:"خطأ في الحفظ",description:"حدث خطأ أثناء حفظ الإعدادات",variant:"destructive"})}finally{s(!1)}},n=()=>{if(b.phoneNumber&&b.defaultMessage)try{const j=Yn(b.phoneNumber,b.defaultMessage);r(j),x(!0)}catch{m({title:"خطأ في المعاينة",description:"تأكد من صحة رقم الواتساب",variant:"destructive"})}},h=async()=>{try{await navigator.clipboard.writeText(i),m({title:"تم النسخ",description:"تم نسخ الرابط إلى الحافظة",variant:"default"})}catch{m({title:"خطأ في النسخ",description:"فشل في نسخ الرابط",variant:"destructive"})}},y=j=>{const A=j.replace(/[^\d+]/g,"");l(D=>({...D,phoneNumber:A})),a.phoneNumber&&t(D=>({...D,phoneNumber:""}))};return U?e.jsxs(At,{children:[e.jsx($t,{children:e.jsxs(Vt,{className:"flex items-center gap-2",children:[e.jsx(Sr,{className:"h-5 w-5"}),"إدارة الواتساب"]})}),e.jsx(kt,{children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(dr,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{className:"mr-2",children:"جاري التحميل..."})]})})]}):e.jsx("div",{className:"space-y-6",children:e.jsxs(At,{children:[e.jsxs($t,{children:[e.jsxs(Vt,{className:"flex items-center gap-2",children:[e.jsx(Sr,{className:"h-5 w-5"}),"إدارة الواتساب"]}),e.jsx(qn,{children:"إدارة رقم الواتساب والرسائل الافتراضية المعروضة في جميع أنحاء الموقع"})]}),e.jsxs(kt,{className:"space-y-6",children:[v&&e.jsxs(ri,{variant:"destructive",children:[e.jsx(qi,{className:"h-4 w-4"}),e.jsx(si,{children:v})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${b.isEnabled?"bg-green-500":"bg-red-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"حالة خدمة الواتساب"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:b.isEnabled?"مفعلة":"معطلة"})]})]}),e.jsx(ti,{checked:b.isEnabled,onCheckedChange:j=>l(A=>({...A,isEnabled:j}))})]}),e.jsx(E0,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Zt,{htmlFor:"phoneNumber",className:"flex items-center gap-2",children:[e.jsx(Zn,{className:"h-4 w-4"}),"رقم الواتساب"]}),e.jsx(Yt,{id:"phoneNumber",type:"tel",placeholder:"مثال: 201000392539",value:b.phoneNumber,onChange:j=>y(j.target.value),className:a.phoneNumber?"border-red-500":"",dir:"ltr"}),a.phoneNumber&&e.jsx("p",{className:"text-sm text-red-500",children:a.phoneNumber}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"أدخل رقم الواتساب مع رمز الدولة (مثال: 201000392539 لمصر)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Zt,{htmlFor:"defaultMessage",children:"الرسالة الافتراضية"}),e.jsx(Zi,{id:"defaultMessage",placeholder:"مرحباً، أريد الاستفسار عن خدماتكم",value:b.defaultMessage,onChange:j=>{l(A=>({...A,defaultMessage:j.target.value})),a.defaultMessage&&t(A=>({...A,defaultMessage:""}))},className:a.defaultMessage?"border-red-500":"",rows:4}),a.defaultMessage&&e.jsx("p",{className:"text-sm text-red-500",children:a.defaultMessage}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"هذه الرسالة ستظهر افتراضياً عند النقر على أزرار الواتساب"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs(Ae,{onClick:c,disabled:u,className:"flex items-center gap-2",children:[u?e.jsx(dr,{className:"h-4 w-4 animate-spin"}):e.jsx(Ht,{className:"h-4 w-4"}),u?"جاري الحفظ...":"حفظ التغييرات"]}),e.jsxs(Ae,{variant:"outline",onClick:n,disabled:!b.phoneNumber||!b.defaultMessage,className:"flex items-center gap-2",children:[d?e.jsx(Yi,{className:"h-4 w-4"}):e.jsx(Gi,{className:"h-4 w-4"}),"معاينة الرابط"]}),e.jsxs(Ae,{variant:"outline",onClick:_,className:"flex items-center gap-2",children:[e.jsx(dr,{className:"h-4 w-4"}),"تحديث"]})]}),d&&i&&e.jsxs(At,{className:"bg-muted/50",children:[e.jsx($t,{children:e.jsx(Vt,{className:"text-lg",children:"معاينة رابط الواتساب"})}),e.jsxs(kt,{className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-background rounded border font-mono text-sm break-all",children:i}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ae,{variant:"outline",size:"sm",onClick:h,className:"flex items-center gap-2",children:[e.jsx(ai,{className:"h-4 w-4"}),"نسخ الرابط"]}),e.jsxs(Ae,{variant:"outline",size:"sm",onClick:()=>window.open(i,"_blank"),className:"flex items-center gap-2",children:[e.jsx(A0,{className:"h-4 w-4"}),"فتح في الواتساب"]})]})]})]}),R&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-medium mb-3",children:"معلومات الإعدادات"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"آخر تحديث:"}),e.jsxs(dt,{variant:"outline",className:"mr-2",children:[R.lastUpdated.toLocaleDateString("ar-EG")," - ",R.lastUpdated.toLocaleTimeString("ar-EG")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"الحالة:"}),e.jsx(dt,{variant:R.isEnabled?"default":"secondary",className:"mr-2",children:R.isEnabled?"مفعل":"معطل"})]})]})]})]})]})})},Lr={enableVisualAlerts:!0,enableAudioAlerts:!0,criticalDays:1,warningDays:3,infoDays:7},eo=R=>{const U=new Date,w=new Date(R).getTime()-U.getTime();return Math.ceil(w/(1e3*60*60*24))},to=(R,U=Lr)=>R<0?"expired":R<=U.criticalDays?"critical":R<=U.warningDays?"warning":(R<=U.infoDays,"info"),ro=(R,U,v)=>{const w=so(v);return U<0?`انتهت صلاحية اشتراك ${w} للمستخدم ${R}`:U===0?`ينتهي اشتراك ${w} للمستخدم ${R} اليوم!`:U===1?`ينتهي اشتراك ${w} للمستخدم ${R} غداً`:`ينتهي اشتراك ${w} للمستخدم ${R} خلال ${U} أيام`},so=R=>{switch(R){case de.MONTHLY:return"الشهري";case de.YEARLY:return"السنوي";case de.LIFETIME:return"مدى الحياة";default:return"غير محدد"}},ao=async()=>{try{const R=Se(he,"users"),U=He(R,ut("subscription","!=",null)),v=await qe(U),w=[];return v.forEach(_=>{var b,l,u,s;const m=_.data();m.subscription&&(m.subscription.planType||m.subscription.plan)&&w.push({id:_.id,...m,subscription:{...m.subscription,startDate:((l=(b=m.subscription.startDate)==null?void 0:b.toDate)==null?void 0:l.call(b))||new Date(m.subscription.startDate),endDate:((s=(u=m.subscription.endDate)==null?void 0:u.toDate)==null?void 0:s.call(u))||new Date(m.subscription.endDate),planType:m.subscription.planType||m.subscription.plan}})}),w}catch(R){return console.error("خطأ في جلب الاشتراكات النشطة:",R),[]}},no=async(R=Lr)=>{try{const U=await ao(),v=[];return U.forEach(w=>{if(!w.subscription||!w.subscription.endDate)return;const _=eo(w.subscription.endDate),m=to(_,R);if(_<=R.infoDays||_<0){const b={id:`${w.id}_${Date.now()}`,userId:w.id,userName:w.displayName||w.email||"مستخدم غير معروف",userEmail:w.email||"",subscriptionPlan:w.subscription.planType,expiryDate:w.subscription.endDate,daysRemaining:_,type:m,message:ro(w.displayName||w.email||"مستخدم غير معروف",_,w.subscription.planType),isRead:!1,createdAt:new Date};v.push(b)}}),v.sort((w,_)=>{const m={expired:0,critical:1,warning:2,info:3};return m[w.type]!==m[_.type]?m[w.type]-m[_.type]:w.daysRemaining-_.daysRemaining}),v}catch(U){return console.error("خطأ في إنشاء إشعارات الاشتراك:",U),[]}},io=(R,U)=>U?R.filter(v=>v.type===U):R,oo=R=>{localStorage.setItem("notificationSettings",JSON.stringify(R))},lo=()=>{try{const R=localStorage.getItem("notificationSettings");if(R)return{...Lr,...JSON.parse(R)}}catch(R){console.error("خطأ في تحميل إعدادات الإشعارات:",R)}return Lr},co=({isOpen:R,onClose:U})=>{const[v,w]=M.useState([]),[_,m]=M.useState([]),[b,l]=M.useState("all"),[u,s]=M.useState(!0),[d,x]=M.useState(lo());M.useEffect(()=>{R&&i()},[R]),M.useEffect(()=>{m(b==="all"?v:io(v,b))},[v,b]);const i=async()=>{s(!0);try{const n=await no(d);w(n)}catch(n){console.error("خطأ في تحميل الإشعارات:",n)}finally{s(!1)}},r=n=>{switch(n){case"urgent":return e.jsx(qt,{className:"w-5 h-5 text-red-500"});case"warning":return e.jsx(it,{className:"w-5 h-5 text-yellow-500"});case"info":return e.jsx(Mt,{className:"w-5 h-5 text-blue-500"});default:return e.jsx(Mt,{className:"w-5 h-5 text-gray-500"})}},a=n=>{switch(n){case"urgent":return"bg-red-50 border-red-200";case"warning":return"bg-yellow-50 border-yellow-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}},t=n=>new Intl.DateTimeFormat("ar-SA",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(n),o=n=>{switch(n){case"all":return"جميع الإشعارات";case"urgent":return"عاجل (يوم واحد)";case"warning":return"تحذير (3 أيام)";case"info":return"معلومات (7 أيام)";default:return"غير محدد"}},c=n=>{const h={...d,[n]:!d[n]};x(h),oo(h)};return R?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Mt,{className:"w-6 h-6"}),e.jsx("h2",{className:"text-xl font-bold",children:"مركز الإشعارات"}),v.length>0&&e.jsx("span",{className:"bg-white text-blue-600 px-2 py-1 rounded-full text-sm font-medium",children:v.length})]}),e.jsx("button",{onClick:U,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",children:e.jsx(mt,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O0,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"تصفية حسب:"})]}),["all","urgent","warning","info"].map(n=>e.jsx("button",{onClick:()=>l(n),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${b===n?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:o(n)},n))]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"الإعدادات:"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.visualAlerts,onChange:()=>c("visualAlerts"),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"التنبيهات المرئية"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.soundAlerts,onChange:()=>c("soundAlerts"),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"التنبيهات الصوتية"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.autoRefresh,onChange:()=>c("autoRefresh"),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"التحديث التلقائي"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto max-h-96",children:u?e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"mr-3 text-gray-600",children:"جاري تحميل الإشعارات..."})]}):_.length===0?e.jsxs("div",{className:"text-center p-8",children:[e.jsx(Mt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"لا توجد إشعارات"}),e.jsx("p",{className:"text-gray-500",children:b==="all"?"لا توجد إشعارات حاليًا":`لا توجد إشعارات من نوع "${o(b)}"`})]}):e.jsx("div",{className:"p-4 space-y-3",children:_.map(n=>e.jsx("div",{className:`p-4 rounded-lg border-r-4 ${a(n.type)}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[r(n.type),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:n.message}),e.jsx("span",{className:"text-xs text-gray-500",children:t(n.createdAt)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-700",children:[e.jsx("strong",{children:"المستخدم:"})," ",n.userName]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-700",children:[e.jsx("strong",{children:"تاريخ الانتهاء:"})," ",t(n.expiryDate)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-700",children:[e.jsx("strong",{children:"الأيام المتبقية:"})," ",n.daysRemaining]})]})]})]})]})},n.id))})}),e.jsx("div",{className:"p-4 border-t bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["آخر تحديث: ",t(new Date)]}),e.jsx("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"تحديث الإشعارات"})]})})]})}):null},xo=({notification:R,onClose:U,soundEnabled:v,onToggleSound:w})=>{const[_,m]=M.useState(!1),[b,l]=M.useState(null);M.useEffect(()=>{if(R&&(m(!0),v&&u(R.type),R.type!=="urgent")){const r=setTimeout(()=>{s()},1e4);return()=>clearTimeout(r)}},[R,v]),M.useEffect(()=>{typeof window<"u"&&window.AudioContext&&l(new AudioContext)},[]);const u=r=>{if(!(!b||!v))try{const a=b.createOscillator(),t=b.createGain();switch(a.connect(t),t.connect(b.destination),r){case"urgent":a.frequency.setValueAtTime(800,b.currentTime),a.frequency.setValueAtTime(1e3,b.currentTime+.1),a.frequency.setValueAtTime(800,b.currentTime+.2),t.gain.setValueAtTime(.3,b.currentTime),t.gain.exponentialRampToValueAtTime(.01,b.currentTime+.5),a.start(b.currentTime),a.stop(b.currentTime+.5);break;case"warning":a.frequency.setValueAtTime(600,b.currentTime),a.frequency.setValueAtTime(700,b.currentTime+.15),t.gain.setValueAtTime(.2,b.currentTime),t.gain.exponentialRampToValueAtTime(.01,b.currentTime+.3),a.start(b.currentTime),a.stop(b.currentTime+.3);break;case"info":a.frequency.setValueAtTime(400,b.currentTime),t.gain.setValueAtTime(.1,b.currentTime),t.gain.exponentialRampToValueAtTime(.01,b.currentTime+.2),a.start(b.currentTime),a.stop(b.currentTime+.2);break}}catch(a){console.error("خطأ في تشغيل الصوت:",a)}},s=()=>{m(!1),setTimeout(()=>{U()},300)},d=r=>{switch(r){case"urgent":return{bg:"bg-red-500",border:"border-red-600",text:"text-white",icon:e.jsx(qt,{className:"w-6 h-6"}),pulse:"animate-pulse"};case"warning":return{bg:"bg-yellow-500",border:"border-yellow-600",text:"text-white",icon:e.jsx(it,{className:"w-6 h-6"}),pulse:""};case"info":return{bg:"bg-blue-500",border:"border-blue-600",text:"text-white",icon:e.jsx(Mt,{className:"w-6 h-6"}),pulse:""};default:return{bg:"bg-gray-500",border:"border-gray-600",text:"text-white",icon:e.jsx(Mt,{className:"w-6 h-6"}),pulse:""}}},x=r=>new Intl.DateTimeFormat("ar-SA",{year:"numeric",month:"long",day:"numeric"}).format(r);if(!R)return null;const i=d(R.type);return e.jsxs("div",{className:"fixed top-4 right-4 z-[9999]",children:[e.jsxs("div",{className:`
          transform transition-all duration-300 ease-in-out
          ${_?"translate-x-0 opacity-100":"translate-x-full opacity-0"}
          ${i.bg} ${i.border} ${i.text} ${i.pulse}
          border-2 rounded-lg shadow-2xl max-w-md min-w-80
          backdrop-blur-sm
        `,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white border-opacity-20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[i.icon,e.jsxs("h3",{className:"font-bold text-lg",children:[R.type==="urgent"&&"تنبيه عاجل!",R.type==="warning"&&"تحذير",R.type==="info"&&"إشعار"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:w,className:"p-1 hover:bg-white hover:bg-opacity-20 rounded transition-colors",title:v?"إيقاف الصوت":"تشغيل الصوت",children:v?e.jsx(K0,{className:"w-4 h-4"}):e.jsx(Q0,{className:"w-4 h-4"})}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-white hover:bg-opacity-20 rounded transition-colors",children:e.jsx(mt,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"text-lg font-medium mb-3",children:R.message}),e.jsxs("div",{className:"space-y-2 text-sm opacity-90",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"المستخدم:"})," ",R.userName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"تاريخ انتهاء الاشتراك:"})," ",x(R.expiryDate)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"الأيام المتبقية:"})," ",R.daysRemaining," يوم"]})]})]}),R.type==="urgent"&&e.jsx("div",{className:"h-1 bg-white bg-opacity-20",children:e.jsx("div",{className:"h-full bg-white animate-pulse",style:{animation:"progress 10s linear forwards"}})})]}),e.jsx("style",{jsx:!0,children:`
        @keyframes progress {
          from { width: 100%; }
          to { width: 0%; }
        }
      `})]})},uo=({user:R,onActivateSubscription:U,onRequestActivation:v,onDeactivateSubscription:w,onDeleteUser:_,onUpdateSessionLimit:m})=>{var z;const[b,l]=M.useState(de.MONTHLY),[u,s]=M.useState(!1),[d,x]=M.useState(""),[i,r]=M.useState(""),a=Ki(),t=R.sessionLimit,o=R.sessionLimitDisabled===!0,[c,n]=M.useState(()=>o?"2":typeof t=="number"&&t>0?String(t):"2"),[h,y]=M.useState(o);M.useEffect(()=>{const E=R.sessionLimit,C=R.sessionLimitDisabled===!0;y(C),C?n("2"):typeof E=="number"&&E>0?n(String(E)):n("2")},[R]);const j=E=>{const C=E==null?void 0:E.displayName;if(typeof C=="string"&&C.trim())return C.trim();if(C&&typeof C=="object"){const L=C.full_name||C.name||C.ar||C.en;if(typeof L=="string"&&L.trim())return L.trim()}return typeof(E==null?void 0:E.email)=="string"&&E.email.includes("@")?E.email.split("@")[0]:"غير محدد"},A=E=>{switch(E){case de.LIFETIME:return e.jsx(xr,{className:"w-4 h-4 text-yellow-500"});case de.YEARLY:return e.jsx(ft,{className:"w-4 h-4 text-blue-500"});case de.QUARTERLY:return e.jsx(Je,{className:"w-4 h-4 text-purple-500"});case de.MONTHLY:return e.jsx(fr,{className:"w-4 h-4 text-green-500"});case de.FIVE_MINUTES:return e.jsx(it,{className:"w-4 h-4 text-orange-500"});case de.ZERO:return e.jsx(Hs,{className:"w-4 h-4 text-gray-500"});case de.TAHWEELA:return e.jsx($a,{className:"w-4 h-4 text-blue-600"});case de.BRANCH:return e.jsx(Ps,{className:"w-4 h-4 text-indigo-500"});default:return null}},D=E=>{if(!E)return"غير محدد";const C=Ji(E);return C?C.toLocaleDateString("ar-EG"):"تاريخ غير صالح"};return e.jsx(At,{className:"hover:shadow-lg transition-shadow",children:e.jsxs(kt,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Ps,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:j(R)}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Xi,{className:"w-3 h-3 ml-1"}),R.email]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mt-1",children:[e.jsx(Zn,{className:"w-3 h-3 ml-1"}),R.phone||"غير محدد"]})]})]}),e.jsx("div",{className:`px-2 py-0.5 rounded-[8px] text-xs font-medium border ${R.isActive?"bg-green-50 text-green-700 border-green-200":"bg-secondary/10 text-secondary border-secondary/20"}`,children:R.isActive?"نشط":"غير نشط"})]}),R.subscription&&e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[A(R.subscription.planType),e.jsx("span",{className:"text-sm font-medium",children:Dt(R.subscription.planType)})]}),e.jsx(dt,{variant:R.subscription.isActive?"default":"destructive",children:R.subscription.isActive?"مفعل":"منتهي"})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(Je,{className:"w-3 h-3 ml-1"}),"البداية: ",D(R.subscription.startDate)]}),R.subscription.endDate&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(Je,{className:"w-3 h-3 ml-1"}),"النهاية: ",D(R.subscription.endDate)]})]})]}),e.jsxs("div",{className:"space-y-3",children:[m&&e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-dashed border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ar,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-800",children:"حد عدد الأجهزة"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-center",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:E=>y(E.target.checked)}),e.jsx("span",{children:"سماح بعدد غير محدود من الأجهزة"})]}),!h&&e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx("input",{type:"number",min:1,value:c,onChange:E=>n(E.target.value),className:"w-20 rounded-md border border-gray-300 px-2 py-1 text-xs text-center"}),e.jsx("span",{className:"text-xs text-gray-600",children:"أجهزة كحد أقصى"})]}),e.jsx(Ae,{size:"sm",className:"w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>{const E=parseInt(c,10),C=isNaN(E)||E<1?1:E,L=h?null:C;m(R.id,{sessionLimit:L,sessionLimitDisabled:h})},children:"حفظ"})]})]}),U&&u&&e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"اختر نوع الباقة:"}),a?e.jsxs("select",{className:"w-full h-10 border border-input bg-background rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-ring",value:b,onChange:E=>l(E.target.value),children:[e.jsx("option",{value:de.MONTHLY,children:"شهرية"}),e.jsx("option",{value:de.QUARTERLY,children:"ربع سنوية"}),e.jsx("option",{value:de.HALF_YEARLY,children:"نصف سنوية"}),e.jsx("option",{value:de.YEARLY,children:"سنوية"}),e.jsx("option",{value:de.LIFETIME,children:"مدى الحياة"}),e.jsx("option",{value:de.FIVE_MINUTES,children:"5 دقايق"}),e.jsx("option",{value:de.ZERO,children:"زيرو"}),e.jsx("option",{value:de.TAHWEELA,children:"تحويله"})]}):e.jsxs(Rr,{value:b,onValueChange:E=>l(E),children:[e.jsx(Tr,{className:"w-full",children:e.jsx(zr,{placeholder:"اختر نوع الباقة"})}),e.jsxs(Ur,{children:[e.jsx(Ve,{value:de.MONTHLY,children:e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(it,{className:"w-4 h-4"}),e.jsx("span",{children:"شهرية"})]})}),e.jsx(Ve,{value:de.QUARTERLY,children:e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(Je,{className:"w-4 h-4"}),e.jsx("span",{children:"ربع سنوية"})]})}),e.jsx(Ve,{value:de.YEARLY,children:e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(Je,{className:"w-4 h-4"}),e.jsx("span",{children:"سنوية"})]})}),e.jsx(Ve,{value:de.LIFETIME,children:e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(y0,{className:"w-4 h-4"}),e.jsx("span",{children:"مدى الحياة"})]})}),e.jsx(Ve,{value:de.FIVE_MINUTES,children:e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(it,{className:"w-4 h-4"}),e.jsx("span",{children:"5 دقايق"})]})}),e.jsx(Ve,{value:de.ZERO,children:e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(Hs,{className:"w-4 h-4"}),e.jsx("span",{children:"زيرو"})]})}),e.jsx(Ve,{value:de.TAHWEELA,children:e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx($a,{className:"w-4 h-4"}),e.jsx("span",{children:"تحويله"})]})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[e.jsxs("div",{children:[e.jsx(Zt,{className:"text-xs mb-1 block",children:"تاريخ البدء (اختياري)"}),e.jsx(Yt,{type:"date",value:d,onChange:E=>x(E.target.value),className:"h-8 text-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx(Zt,{className:"text-xs mb-1 block",children:"تاريخ الانتهاء (اختياري)"}),e.jsx(Yt,{type:"date",value:i,onChange:E=>r(E.target.value),className:"h-8 text-sm bg-white"})]})]}),e.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[e.jsx(Ae,{size:"sm",onClick:()=>{const E=d?new Date(d):void 0,C=i?new Date(i):void 0;U(R.id,b,E,C),s(!1),x(""),r("")},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:"تأكيد التفعيل"}),e.jsx(Ae,{size:"sm",variant:"outline",onClick:()=>s(!1),className:"flex-1",children:"إلغاء"})]})]}),e.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[(U||v)&&!u&&e.jsx(Ae,{size:"sm",variant:"outline",onClick:()=>v?v(R):s(!0),className:"flex-1",children:(z=R.subscription)!=null&&z.isActive?"تعديل الاشتراك":"تفعيل الاشتراك"}),w&&e.jsx(Ae,{size:"sm",variant:"outline",onClick:()=>w(R.id),className:"flex-1",children:"إلغاء الاشتراك"}),_&&e.jsx(Ae,{size:"sm",variant:"destructive",onClick:()=>_(R.id),children:e.jsx(Qi,{className:"w-4 h-4"})})]})]})]})})},ho=hr.memo(uo),fo=[{id:de.MONTHLY,name:"شهرية",icon:fr,color:"text-green-600",bg:"bg-green-50",border:"border-green-200"},{id:de.QUARTERLY,name:"ربع سنوية",icon:Je,color:"text-purple-600",bg:"bg-purple-50",border:"border-purple-200"},{id:de.HALF_YEARLY,name:"نصف سنوية",icon:D0,color:"text-rose-600",bg:"bg-rose-50",border:"border-rose-200"},{id:de.YEARLY,name:"سنوية",icon:ft,color:"text-blue-600",bg:"bg-blue-50",border:"border-blue-200"},{id:de.LIFETIME,name:"مدى الحياة",icon:xr,color:"text-yellow-600",bg:"bg-yellow-50",border:"border-yellow-200"},{id:de.FIVE_MINUTES,name:"5 دقايق",icon:it,color:"text-orange-600",bg:"bg-orange-50",border:"border-orange-200"},{id:de.ZERO,name:"زيرو",icon:Hs,color:"text-gray-600",bg:"bg-gray-50",border:"border-gray-200"},{id:de.TAHWEELA,name:"تحويله",icon:dr,color:"text-indigo-600",bg:"bg-indigo-50",border:"border-indigo-200"}],mo={[de.MONTHLY]:{from:"from-blue-50",to:"to-indigo-50",ring:"ring-blue-300"},[de.QUARTERLY]:{from:"from-purple-50",to:"to-pink-50",ring:"ring-purple-300"},[de.HALF_YEARLY]:{from:"from-rose-50",to:"to-pink-50",ring:"ring-rose-300"},[de.YEARLY]:{from:"from-sky-50",to:"to-blue-50",ring:"ring-blue-300"},[de.LIFETIME]:{from:"from-yellow-50",to:"to-amber-50",ring:"ring-amber-300"},[de.FIVE_MINUTES]:{from:"from-orange-50",to:"to-red-50",ring:"ring-orange-300"},[de.ZERO]:{from:"from-gray-50",to:"to-slate-100",ring:"ring-gray-300"},[de.TAHWEELA]:{from:"from-indigo-50",to:"to-violet-50",ring:"ring-indigo-300"}},po=R=>{const U=R==null?void 0:R.displayName;if(typeof U=="string"&&U.trim())return U.trim();if(U&&typeof U=="object"){const v=U.full_name||U.name||U.ar||U.en;if(typeof v=="string"&&v.trim())return v.trim()}return typeof(R==null?void 0:R.email)=="string"&&R.email.includes("@")?R.email.split("@")[0]:"مستخدم"},go=({isOpen:R,onClose:U,user:v,onActivate:w})=>{var r,a;const[_,m]=M.useState(de.MONTHLY),[b,l]=M.useState(""),[u,s]=M.useState(""),[d,x]=M.useState(!1);hr.useEffect(()=>{R&&(m(de.MONTHLY),l(""),s(""),x(!1))},[R,v]);const i=async()=>{if(!d){x(!0);try{const t=b?new Date(b):void 0,o=u?new Date(u):void 0;await w(v.id,_,t,o)}catch(t){console.error("Activation failed",t),x(!1)}}};return!R||!v?null:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 transition-opacity duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-xl shadow-xl transform transition-all flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(fr,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-gray-800",children:(r=v==null?void 0:v.subscription)!=null&&r.isActive?"تعديل اشتراك المستخدم":"تفعيل اشتراك جديد"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["للمستخدم: ",po(v)]})]})]}),e.jsx("button",{onClick:U,className:"text-gray-400 hover:text-gray-600 transition-colors rounded-lg hover:bg-gray-100 p-1",children:e.jsx(mt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:fo.map(t=>{const o=mo[t.id],c=_===t.id;return e.jsxs("div",{onClick:()=>m(t.id),className:`rounded-xl p-4 border shadow-sm bg-gradient-to-br ${o.from} ${o.to} cursor-pointer transition-all ${c?`ring-2 ${o.ring}`:"hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/70 flex items-center justify-center",children:e.jsx(t.icon,{className:`w-5 h-5 ${t.color}`})}),c&&e.jsx(ur,{className:`w-5 h-5 ${t.color}`})]}),e.jsx("div",{className:"font-bold text-gray-800",children:t.name}),c&&e.jsx("div",{className:`text-xs font-medium ${t.color}`,children:"تم الاختيار"})]},t.id)})}),e.jsxs("div",{className:"mt-6 border-t border-gray-100 pt-4",children:[e.jsxs("h5",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4 text-gray-500"}),"تخصيص مدة الاشتراك (اختياري)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1.5",children:"تاريخ البدء"}),e.jsx("input",{type:"date",value:b,onChange:t=>l(t.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-300 text-sm focus:ring-2 focus:ring-blue-100 focus:border-blue-400 outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1.5",children:"تاريخ الانتهاء"}),e.jsx("input",{type:"date",value:u,onChange:t=>s(t.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-300 text-sm focus:ring-2 focus:ring-blue-100 focus:border-blue-400 outline-none transition-all"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 bg-gray-50 rounded-b-xl border-t border-gray-100 flex-shrink-0",children:[e.jsx("button",{onClick:U,disabled:d,className:"px-5 py-2.5 rounded-lg border border-gray-300 bg-white text-gray-700 font-medium hover:bg-gray-50 focus:ring-2 focus:ring-gray-200 transition-all disabled:opacity-50",children:"إلغاء"}),e.jsxs("button",{onClick:i,disabled:d,className:"px-5 py-2.5 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700 shadow-lg shadow-blue-600/20 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[d?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(ur,{className:"w-5 h-5"}),d?"جاري الحفظ...":(a=v==null?void 0:v.subscription)!=null&&a.isActive?"حفظ التعديلات":"تفعيل الاشتراك"]})]})]})})},nn=[{value:de.MONTHLY,label:"باقة شهرية"},{value:de.QUARTERLY,label:"باقة ربع سنوية"},{value:de.HALF_YEARLY,label:"باقة نصف سنوية"},{value:de.YEARLY,label:"باقة سنوية"},{value:de.LIFETIME,label:"باقة مدى الحياة"}],vo=()=>{const[R,U]=M.useState([]),[v,w]=M.useState(!0),[_,m]=M.useState(""),[b,l]=M.useState(null),[u,s]=M.useState(!1),[d,x]=M.useState({status:"",packageName:""}),[i,r]=M.useState(!1),[a,t]=M.useState(null),[o,c]=M.useState(!1),[n,h]=M.useState(null),[y,j]=M.useState("requests"),[A,D]=M.useState([]),[z,E]=M.useState(!1),[C,L]=M.useState(""),[N,T]=M.useState(!1),{toast:p}=Vn();M.useEffect(()=>{const q=He(Se(he,"reseller_requests"),e0("createdAt","desc")),ce=Va(q,Ee=>{const Ne=Ee.docs.map(g=>({id:g.id,...g.data()}));U(Ne),w(!1)},Ee=>{console.error("Error fetching reseller requests:",Ee),w(!1)}),ve=He(Se(he,"users"),ut("isResellerEnabled","==",!0)),pe=Va(ve,Ee=>{const Ne=Ee.docs.map(g=>({id:g.id,...g.data()}));D(Ne)});return()=>{ce(),pe()}},[]);const W=async()=>{if(!C.trim()){p({title:"خطأ",description:"يرجى إدخال البريد الإلكتروني",variant:"destructive"});return}T(!0);try{const q=Se(he,"users"),ce=He(q,ut("email","==",C.trim()),t0(1)),ve=await qe(ce);if(ve.empty){p({title:"خطأ",description:"لم يتم العثور على مستخدم بهذا البريد الإلكتروني",variant:"destructive"}),T(!1);return}const pe=ve.docs[0];await Fe(je(he,"users",pe.id),{isResellerEnabled:!0}),p({title:"تم التفعيل",description:"تم تفعيل نظام الريسيلر لهذا الحساب بنجاح"}),E(!1),L("")}catch(q){console.error("Error activating reseller:",q),p({title:"خطأ",description:"حدث خطأ أثناء التفعيل",variant:"destructive"})}finally{T(!1)}},X=async q=>{if(window.confirm("هل أنت متأكد من تعطيل نظام الريسيلر لهذا الحساب؟"))try{await Fe(je(he,"users",q),{isResellerEnabled:!1}),p({title:"تم التعطيل",description:"تم تعطيل نظام الريسيلر للحساب"})}catch(ce){console.error("Error deactivating reseller:",ce),p({title:"خطأ",description:"حدث خطأ أثناء التعطيل",variant:"destructive"})}},Y=q=>{l(q),x({status:q.status,packageName:q.packageName||""}),s(!0)},oe=async()=>{if(b)try{const q={status:d.status,packageName:d.packageName};let ce=null,ve=!1;if(d.status==="active"&&d.packageName){const pe=new Date,Ee=r0(d.packageName,pe);q.startDate=pe,q.endDate=Ee,ve=!0,ce={planType:d.packageName,startDate:pe,endDate:Ee,isActive:!0,activatedAt:pe}}else d.status!=="active"&&(ve=!1,ce={isActive:!1});if(await Fe(je(he,"reseller_requests",b.id),q),b.uid){const pe={isActive:ve,updatedAt:new Date};ce&&(pe.subscription=ce),await Fe(je(he,"users",b.uid),pe)}p({title:"تم التحديث",description:"تم تحديث حالة الحساب وتفعيل الباقة بنجاح"}),s(!1)}catch(q){console.error("Error updating request:",q),p({title:"خطأ",description:"حدث خطأ أثناء التحديث",variant:"destructive"})}},K=async q=>{if(window.confirm("هل أنت متأكد من حذف هذا الطلب؟"))try{await xt(je(he,"reseller_requests",q)),p({title:"تم الحذف",description:"تم حذف الطلب بنجاح"})}catch{p({title:"خطأ",description:"حدث خطأ أثناء الحذف",variant:"destructive"})}},ie=q=>{t(q),r(!0)},F=async()=>{if(a)try{await xt(je(he,"reseller_requests",a.id)),a.uid&&await Fe(je(he,"users",a.uid),{isActive:!1,role:"user"}),p({title:"تم القبول",description:"تم قبول طلب الحذف وإزالة الحساب من القائمة"}),r(!1)}catch(q){console.error("Error accepting delete:",q),p({title:"خطأ",description:"حدث خطأ أثناء تنفيذ الحذف",variant:"destructive"})}},S=async()=>{if(a)try{await Fe(je(he,"reseller_requests",a.id),{deletionRequested:!1,deletionStatus:"rejected"}),p({title:"تم الرفض",description:"تم رفض طلب الحذف وإشعار المستخدم"}),r(!1)}catch(q){console.error("Error rejecting delete:",q),p({title:"خطأ",description:"حدث خطأ أثناء رفض الطلب",variant:"destructive"})}},V=q=>{h(q),c(!0)},H=async()=>{if(n)try{await Fe(je(he,"reseller_requests",n.id),{status:"inactive",packageName:null,startDate:null,endDate:null,cancelRequested:!1,cancelStatus:null}),n.uid&&await Fe(je(he,"users",n.uid),{isActive:!1,"subscription.isActive":!1,"subscription.planId":null,"subscription.endDate":null}),p({title:"تم القبول",description:"تم قبول طلب إلغاء الباقة وإلغاء تفعيل الحساب"}),c(!1)}catch(q){console.error("Error accepting cancel:",q),p({title:"خطأ",description:"حدث خطأ أثناء تنفيذ الإلغاء",variant:"destructive"})}},ee=async()=>{if(n)try{await Fe(je(he,"reseller_requests",n.id),{cancelRequested:!1,cancelStatus:"rejected"}),p({title:"تم الرفض",description:"تم رفض طلب إلغاء الباقة وإشعار المستخدم"}),c(!1)}catch(q){console.error("Error rejecting cancel:",q),p({title:"خطأ",description:"حدث خطأ أثناء رفض الطلب",variant:"destructive"})}},ue=q=>{var ce;return((ce=nn.find(ve=>ve.value===q))==null?void 0:ce.label)||q||"-"},ge=R.filter(q=>{var ce;return q.email.toLowerCase().includes(_.toLowerCase())||((ce=q.packageName)==null?void 0:ce.toLowerCase().includes(_.toLowerCase()))});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B0,{defaultValue:"requests",value:y,onValueChange:j,className:"w-full",children:[e.jsxs(F0,{className:"grid w-full grid-cols-2 mb-4",children:[e.jsx(Qa,{value:"requests",children:"طلبات الحسابات الفرعية"}),e.jsx(Qa,{value:"main_resellers",children:"حسابات الريسيلر الرئيسية (المفعلة)"})]}),e.jsx(Ja,{value:"requests",children:e.jsxs(At,{children:[e.jsxs($t,{className:"flex flex-row items-center justify-between",children:[e.jsx(Vt,{children:"إدارة حسابات الريسيلر الفرعية"}),e.jsxs("div",{className:"relative w-64",children:[e.jsx(Et,{className:"absolute right-2 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(Yt,{placeholder:"بحث بالبريد الإلكتروني...",className:"pr-8",value:_,onChange:q=>m(q.target.value)})]})]}),e.jsx(kt,{children:e.jsxs(Ga,{children:[e.jsx(Ka,{children:e.jsxs(Ct,{children:[e.jsx(Xe,{className:"text-right",children:"البريد الإلكتروني"}),e.jsx(Xe,{className:"text-right",children:"كلمة المرور"}),e.jsx(Xe,{className:"text-right",children:"رقم الهاتف"}),e.jsx(Xe,{className:"text-right",children:"الحالة"}),e.jsx(Xe,{className:"text-right",children:"الباقة"}),e.jsx(Xe,{className:"text-right",children:"الصلاحية"}),e.jsx(Xe,{className:"text-right",children:"إجراءات"})]})}),e.jsx(Xa,{children:v?e.jsx(Ct,{children:e.jsx(Pe,{colSpan:7,className:"text-center",children:"جاري التحميل..."})}):ge.length===0?e.jsx(Ct,{children:e.jsx(Pe,{colSpan:7,className:"text-center",children:"لا توجد طلبات"})}):ge.map(q=>{var ce;return e.jsxs(Ct,{children:[e.jsx(Pe,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[q.email,q.deletionRequested&&e.jsx(dt,{variant:"destructive",className:"cursor-pointer hover:bg-red-700 animate-pulse",onClick:()=>ie(q),children:"طلب حذف"}),q.cancelRequested&&e.jsx(dt,{className:"bg-orange-500 hover:bg-orange-600 cursor-pointer animate-pulse",onClick:()=>V(q),children:"طلب إلغاء باقة"})]})}),e.jsx(Pe,{className:"font-mono text-xs",children:q.password}),e.jsx(Pe,{children:q.phone||"-"}),e.jsx(Pe,{children:q.status==="active"?e.jsx(dt,{className:"bg-green-100 text-green-800 hover:bg-green-100",children:"نشط"}):q.status==="pending"?e.jsx(dt,{className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-100",children:"قيد الانتظار"}):e.jsx(dt,{className:"bg-red-100 text-red-800 hover:bg-red-100",children:"غير نشط"})}),e.jsx(Pe,{children:ue(q.packageName)}),e.jsx(Pe,{children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["الطلب: ",(ce=q.createdAt)!=null&&ce.seconds?new Date(q.createdAt.seconds*1e3).toLocaleDateString("ar-SA"):"-"]}),q.status==="active"&&q.endDate&&e.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["ينتهي: ",q.endDate.seconds?new Date(q.endDate.seconds*1e3).toLocaleDateString("ar-SA"):"-"]})]})}),e.jsx(Pe,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{variant:"outline",size:"sm",onClick:()=>Y(q),children:e.jsx(S0,{className:"h-4 w-4"})}),e.jsx(Ae,{variant:"ghost",size:"sm",className:"text-red-600",onClick:()=>K(q.id),children:e.jsx(qa,{className:"h-4 w-4"})})]})})]},q.id)})})]})})]})}),e.jsx(Ja,{value:"main_resellers",children:e.jsxs(At,{children:[e.jsxs($t,{className:"flex flex-row items-center justify-between",children:[e.jsxs(Vt,{className:"flex items-center gap-2",children:[e.jsx(Ms,{className:"h-5 w-5 text-blue-600"}),"حسابات الريسيلر الرئيسية المفعلة"]}),e.jsxs(nr,{open:z,onOpenChange:E,children:[e.jsxs(ir,{children:[e.jsx(or,{children:e.jsx(lr,{children:"تفعيل نظام الريسيلر لمستخدم"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"البريد الإلكتروني للمستخدم الرئيسي"}),e.jsx(Yt,{placeholder:"email@example.com",value:C,onChange:q=>L(q.target.value)})]}),e.jsx(Ae,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:W,disabled:N,children:N?"جاري التفعيل...":"تفعيل النظام"})]})]}),e.jsxs(Ae,{onClick:()=>E(!0),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Ws,{className:"mr-2 h-4 w-4"}),"تفعيل حساب جديد"]})]})]}),e.jsx(kt,{children:e.jsxs(Ga,{children:[e.jsx(Ka,{children:e.jsxs(Ct,{children:[e.jsx(Xe,{className:"text-right",children:"البريد الإلكتروني"}),e.jsx(Xe,{className:"text-right",children:"الاسم"}),e.jsx(Xe,{className:"text-right",children:"تاريخ الانضمام"}),e.jsx(Xe,{className:"text-right",children:"الحالة"}),e.jsx(Xe,{className:"text-right",children:"إجراءات"})]})}),e.jsx(Xa,{children:A.length===0?e.jsx(Ct,{children:e.jsx(Pe,{colSpan:5,className:"text-center py-8 text-gray-500",children:"لا توجد حسابات رئيسية مفعلة حالياً"})}):A.map(q=>{var ce;return e.jsxs(Ct,{children:[e.jsx(Pe,{className:"font-medium",children:q.email}),e.jsx(Pe,{children:q.displayName||"-"}),e.jsx(Pe,{children:(ce=q.createdAt)!=null&&ce.seconds?new Date(q.createdAt.seconds*1e3).toLocaleDateString("ar-SA"):"-"}),e.jsx(Pe,{children:e.jsxs(dt,{className:"bg-blue-100 text-blue-800 hover:bg-blue-100 flex w-fit items-center gap-1",children:[e.jsx(Ms,{className:"h-3 w-3"}),"مفعل كريسيلر"]})}),e.jsx(Pe,{children:e.jsxs(Ae,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>X(q.id),children:[e.jsx(qa,{className:"h-4 w-4 mr-1"}),"تعطيل"]})})]},q.id)})})]})})]})})]}),e.jsx(nr,{open:u,onOpenChange:s,children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsx(lr,{children:"تعديل حالة الحساب"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"الحالة"}),e.jsxs(Rr,{value:d.status,onValueChange:q=>x(ce=>({...ce,status:q})),children:[e.jsx(Tr,{children:e.jsx(zr,{placeholder:"اختر الحالة"})}),e.jsxs(Ur,{children:[e.jsx(Ve,{value:"pending",children:"قيد الانتظار"}),e.jsx(Ve,{value:"active",children:"نشط"}),e.jsx(Ve,{value:"inactive",children:"غير نشط"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"اسم الباقة"}),e.jsxs(Rr,{value:d.packageName,onValueChange:q=>x(ce=>({...ce,packageName:q})),children:[e.jsx(Tr,{children:e.jsx(zr,{placeholder:"اختر الباقة"})}),e.jsx(Ur,{children:nn.map(q=>e.jsx(Ve,{value:q.value,children:q.label},q.value))})]})]})]}),e.jsxs(Dr,{children:[e.jsx(Ae,{variant:"outline",onClick:()=>s(!1),children:"إلغاء"}),e.jsx(Ae,{onClick:oe,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"حفظ التغييرات"})]})]})}),e.jsx(nr,{open:i,onOpenChange:r,children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsx(lr,{className:"text-red-600",children:"مراجعة طلب حذف حساب"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100",children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"سبب الحذف المقدم من المستخدم:"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:(a==null?void 0:a.deletionReason)||"لا يوجد سبب محدد"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsxs("p",{children:["البريد الإلكتروني: ",a==null?void 0:a.email]}),e.jsxs("p",{children:["تاريخ الطلب: ",new Date().toLocaleDateString("ar-SA")]})]}),e.jsx("div",{className:"bg-yellow-50 p-3 rounded text-sm text-yellow-800 border border-yellow-200",children:"تنبيه: قبول الطلب سيؤدي إلى حذف هذا السجل من قائمة الريسيلر وتعطيل حساب المستخدم المرتبط به."})]}),e.jsxs(Dr,{className:"gap-2 sm:gap-0",children:[e.jsx(Ae,{variant:"outline",onClick:S,className:"text-red-600 border-red-200 hover:bg-red-50",children:"رفض الطلب"}),e.jsx(Ae,{onClick:F,className:"bg-red-600 hover:bg-red-700 text-white",children:"قبول الحذف"})]})]})}),e.jsx(nr,{open:o,onOpenChange:c,children:e.jsxs(ir,{children:[e.jsx(or,{children:e.jsx(lr,{className:"text-orange-600",children:"مراجعة طلب إلغاء باقة"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-100",children:[e.jsx("h4",{className:"font-semibold text-orange-800 mb-2",children:"سبب الإلغاء المقدم من المستخدم:"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:(n==null?void 0:n.cancelReason)||"لا يوجد سبب محدد"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsxs("p",{children:["البريد الإلكتروني: ",n==null?void 0:n.email]}),e.jsxs("p",{children:["تاريخ الطلب: ",new Date().toLocaleDateString("ar-SA")]})]}),e.jsx("div",{className:"bg-yellow-50 p-3 rounded text-sm text-yellow-800 border border-yellow-200",children:"تنبيه: قبول الطلب سيؤدي إلى إيقاف تفعيل الباقة والحساب فوراً."})]}),e.jsxs(Dr,{className:"gap-2 sm:gap-0",children:[e.jsx(Ae,{variant:"outline",onClick:ee,className:"text-red-600 border-red-200 hover:bg-red-50",children:"رفض الطلب"}),e.jsx(Ae,{onClick:H,className:"bg-orange-600 hover:bg-orange-700 text-white",children:"قبول الإلغاء"})]})]})})]})};function cr(R){throw new Error('Could not dynamically require "'+R+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ni={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(R,U){(function(v){R.exports=v()})(function(){return function v(w,_,m){function b(s,d){if(!_[s]){if(!w[s]){var x=typeof cr=="function"&&cr;if(!d&&x)return x(s,!0);if(l)return l(s,!0);var i=new Error("Cannot find module '"+s+"'");throw i.code="MODULE_NOT_FOUND",i}var r=_[s]={exports:{}};w[s][0].call(r.exports,function(a){var t=w[s][1][a];return b(t||a)},r,r.exports,v,w,_,m)}return _[s].exports}for(var l=typeof cr=="function"&&cr,u=0;u<m.length;u++)b(m[u]);return b}({1:[function(v,w,_){var m=v("./utils"),b=v("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";_.encode=function(u){for(var s,d,x,i,r,a,t,o=[],c=0,n=u.length,h=n,y=m.getTypeOf(u)!=="string";c<u.length;)h=n-c,x=y?(s=u[c++],d=c<n?u[c++]:0,c<n?u[c++]:0):(s=u.charCodeAt(c++),d=c<n?u.charCodeAt(c++):0,c<n?u.charCodeAt(c++):0),i=s>>2,r=(3&s)<<4|d>>4,a=1<h?(15&d)<<2|x>>6:64,t=2<h?63&x:64,o.push(l.charAt(i)+l.charAt(r)+l.charAt(a)+l.charAt(t));return o.join("")},_.decode=function(u){var s,d,x,i,r,a,t=0,o=0,c="data:";if(u.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");var n,h=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===l.charAt(64)&&h--,u.charAt(u.length-2)===l.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(n=b.uint8array?new Uint8Array(0|h):new Array(0|h);t<u.length;)s=l.indexOf(u.charAt(t++))<<2|(i=l.indexOf(u.charAt(t++)))>>4,d=(15&i)<<4|(r=l.indexOf(u.charAt(t++)))>>2,x=(3&r)<<6|(a=l.indexOf(u.charAt(t++))),n[o++]=s,r!==64&&(n[o++]=d),a!==64&&(n[o++]=x);return n}},{"./support":30,"./utils":32}],2:[function(v,w,_){var m=v("./external"),b=v("./stream/DataWorker"),l=v("./stream/Crc32Probe"),u=v("./stream/DataLengthProbe");function s(d,x,i,r,a){this.compressedSize=d,this.uncompressedSize=x,this.crc32=i,this.compression=r,this.compressedContent=a}s.prototype={getContentWorker:function(){var d=new b(m.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),x=this;return d.on("end",function(){if(this.streamInfo.data_length!==x.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new b(m.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(d,x,i){return d.pipe(new l).pipe(new u("uncompressedSize")).pipe(x.compressWorker(i)).pipe(new u("compressedSize")).withStreamInfo("compression",x)},w.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(v,w,_){var m=v("./stream/GenericWorker");_.STORE={magic:"\0\0",compressWorker:function(){return new m("STORE compression")},uncompressWorker:function(){return new m("STORE decompression")}},_.DEFLATE=v("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(v,w,_){var m=v("./utils"),b=function(){for(var l,u=[],s=0;s<256;s++){l=s;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;u[s]=l}return u}();w.exports=function(l,u){return l!==void 0&&l.length?m.getTypeOf(l)!=="string"?function(s,d,x,i){var r=b,a=i+x;s^=-1;for(var t=i;t<a;t++)s=s>>>8^r[255&(s^d[t])];return-1^s}(0|u,l,l.length,0):function(s,d,x,i){var r=b,a=i+x;s^=-1;for(var t=i;t<a;t++)s=s>>>8^r[255&(s^d.charCodeAt(t))];return-1^s}(0|u,l,l.length,0):0}},{"./utils":32}],5:[function(v,w,_){_.base64=!1,_.binary=!1,_.dir=!1,_.createFolders=!0,_.date=null,_.compression=null,_.compressionOptions=null,_.comment=null,_.unixPermissions=null,_.dosPermissions=null},{}],6:[function(v,w,_){var m=null;m=typeof Promise<"u"?Promise:v("lie"),w.exports={Promise:m}},{lie:37}],7:[function(v,w,_){var m=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",b=v("pako"),l=v("./utils"),u=v("./stream/GenericWorker"),s=m?"uint8array":"array";function d(x,i){u.call(this,"FlateWorker/"+x),this._pako=null,this._pakoAction=x,this._pakoOptions=i,this.meta={}}_.magic="\b\0",l.inherits(d,u),d.prototype.processChunk=function(x){this.meta=x.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(s,x.data),!1)},d.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new b[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var x=this;this._pako.onData=function(i){x.push({data:i,meta:x.meta})}},_.compressWorker=function(x){return new d("Deflate",x)},_.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(v,w,_){function m(r,a){var t,o="";for(t=0;t<a;t++)o+=String.fromCharCode(255&r),r>>>=8;return o}function b(r,a,t,o,c,n){var h,y,j=r.file,A=r.compression,D=n!==s.utf8encode,z=l.transformTo("string",n(j.name)),E=l.transformTo("string",s.utf8encode(j.name)),C=j.comment,L=l.transformTo("string",n(C)),N=l.transformTo("string",s.utf8encode(C)),T=E.length!==j.name.length,p=N.length!==C.length,W="",X="",Y="",oe=j.dir,K=j.date,ie={crc32:0,compressedSize:0,uncompressedSize:0};a&&!t||(ie.crc32=r.crc32,ie.compressedSize=r.compressedSize,ie.uncompressedSize=r.uncompressedSize);var F=0;a&&(F|=8),D||!T&&!p||(F|=2048);var S=0,V=0;oe&&(S|=16),c==="UNIX"?(V=798,S|=function(ee,ue){var ge=ee;return ee||(ge=ue?16893:33204),(65535&ge)<<16}(j.unixPermissions,oe)):(V=20,S|=function(ee){return 63&(ee||0)}(j.dosPermissions)),h=K.getUTCHours(),h<<=6,h|=K.getUTCMinutes(),h<<=5,h|=K.getUTCSeconds()/2,y=K.getUTCFullYear()-1980,y<<=4,y|=K.getUTCMonth()+1,y<<=5,y|=K.getUTCDate(),T&&(X=m(1,1)+m(d(z),4)+E,W+="up"+m(X.length,2)+X),p&&(Y=m(1,1)+m(d(L),4)+N,W+="uc"+m(Y.length,2)+Y);var H="";return H+=`
\0`,H+=m(F,2),H+=A.magic,H+=m(h,2),H+=m(y,2),H+=m(ie.crc32,4),H+=m(ie.compressedSize,4),H+=m(ie.uncompressedSize,4),H+=m(z.length,2),H+=m(W.length,2),{fileRecord:x.LOCAL_FILE_HEADER+H+z+W,dirRecord:x.CENTRAL_FILE_HEADER+m(V,2)+H+m(L.length,2)+"\0\0\0\0"+m(S,4)+m(o,4)+z+W+L}}var l=v("../utils"),u=v("../stream/GenericWorker"),s=v("../utf8"),d=v("../crc32"),x=v("../signature");function i(r,a,t,o){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=a,this.zipPlatform=t,this.encodeFileName=o,this.streamFiles=r,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(i,u),i.prototype.push=function(r){var a=r.meta.percent||0,t=this.entriesCount,o=this._sources.length;this.accumulate?this.contentBuffer.push(r):(this.bytesWritten+=r.data.length,u.prototype.push.call(this,{data:r.data,meta:{currentFile:this.currentFile,percent:t?(a+100*(t-o-1))/t:100}}))},i.prototype.openedSource=function(r){this.currentSourceOffset=this.bytesWritten,this.currentFile=r.file.name;var a=this.streamFiles&&!r.file.dir;if(a){var t=b(r,a,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:t.fileRecord,meta:{percent:0}})}else this.accumulate=!0},i.prototype.closedSource=function(r){this.accumulate=!1;var a=this.streamFiles&&!r.file.dir,t=b(r,a,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(t.dirRecord),a)this.push({data:function(o){return x.DATA_DESCRIPTOR+m(o.crc32,4)+m(o.compressedSize,4)+m(o.uncompressedSize,4)}(r),meta:{percent:100}});else for(this.push({data:t.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},i.prototype.flush=function(){for(var r=this.bytesWritten,a=0;a<this.dirRecords.length;a++)this.push({data:this.dirRecords[a],meta:{percent:100}});var t=this.bytesWritten-r,o=function(c,n,h,y,j){var A=l.transformTo("string",j(y));return x.CENTRAL_DIRECTORY_END+"\0\0\0\0"+m(c,2)+m(c,2)+m(n,4)+m(h,4)+m(A.length,2)+A}(this.dirRecords.length,t,r,this.zipComment,this.encodeFileName);this.push({data:o,meta:{percent:100}})},i.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},i.prototype.registerPrevious=function(r){this._sources.push(r);var a=this;return r.on("data",function(t){a.processChunk(t)}),r.on("end",function(){a.closedSource(a.previous.streamInfo),a._sources.length?a.prepareNextSource():a.end()}),r.on("error",function(t){a.error(t)}),this},i.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},i.prototype.error=function(r){var a=this._sources;if(!u.prototype.error.call(this,r))return!1;for(var t=0;t<a.length;t++)try{a[t].error(r)}catch{}return!0},i.prototype.lock=function(){u.prototype.lock.call(this);for(var r=this._sources,a=0;a<r.length;a++)r[a].lock()},w.exports=i},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(v,w,_){var m=v("../compressions"),b=v("./ZipFileWorker");_.generateWorker=function(l,u,s){var d=new b(u.streamFiles,s,u.platform,u.encodeFileName),x=0;try{l.forEach(function(i,r){x++;var a=function(n,h){var y=n||h,j=m[y];if(!j)throw new Error(y+" is not a valid compression method !");return j}(r.options.compression,u.compression),t=r.options.compressionOptions||u.compressionOptions||{},o=r.dir,c=r.date;r._compressWorker(a,t).withStreamInfo("file",{name:i,dir:o,date:c,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(d)}),d.entriesCount=x}catch(i){d.error(i)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(v,w,_){function m(){if(!(this instanceof m))return new m;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var b=new m;for(var l in this)typeof this[l]!="function"&&(b[l]=this[l]);return b}}(m.prototype=v("./object")).loadAsync=v("./load"),m.support=v("./support"),m.defaults=v("./defaults"),m.version="3.10.1",m.loadAsync=function(b,l){return new m().loadAsync(b,l)},m.external=v("./external"),w.exports=m},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(v,w,_){var m=v("./utils"),b=v("./external"),l=v("./utf8"),u=v("./zipEntries"),s=v("./stream/Crc32Probe"),d=v("./nodejsUtils");function x(i){return new b.Promise(function(r,a){var t=i.decompressed.getContentWorker().pipe(new s);t.on("error",function(o){a(o)}).on("end",function(){t.streamInfo.crc32!==i.decompressed.crc32?a(new Error("Corrupted zip : CRC32 mismatch")):r()}).resume()})}w.exports=function(i,r){var a=this;return r=m.extend(r||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(i)?b.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):m.prepareContent("the loaded zip file",i,!0,r.optimizedBinaryString,r.base64).then(function(t){var o=new u(r);return o.load(t),o}).then(function(t){var o=[b.Promise.resolve(t)],c=t.files;if(r.checkCRC32)for(var n=0;n<c.length;n++)o.push(x(c[n]));return b.Promise.all(o)}).then(function(t){for(var o=t.shift(),c=o.files,n=0;n<c.length;n++){var h=c[n],y=h.fileNameStr,j=m.resolve(h.fileNameStr);a.file(j,h.decompressed,{binary:!0,optimizedBinaryString:!0,date:h.date,dir:h.dir,comment:h.fileCommentStr.length?h.fileCommentStr:null,unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions,createFolders:r.createFolders}),h.dir||(a.file(j).unsafeOriginalName=y)}return o.zipComment.length&&(a.comment=o.zipComment),a})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(v,w,_){var m=v("../utils"),b=v("../stream/GenericWorker");function l(u,s){b.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(s)}m.inherits(l,b),l.prototype._bindStream=function(u){var s=this;(this._stream=u).pause(),u.on("data",function(d){s.push({data:d,meta:{percent:0}})}).on("error",function(d){s.isPaused?this.generatedError=d:s.error(d)}).on("end",function(){s.isPaused?s._upstreamEnded=!0:s.end()})},l.prototype.pause=function(){return!!b.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!b.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},w.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(v,w,_){var m=v("readable-stream").Readable;function b(l,u,s){m.call(this,u),this._helper=l;var d=this;l.on("data",function(x,i){d.push(x)||d._helper.pause(),s&&s(i)}).on("error",function(x){d.emit("error",x)}).on("end",function(){d.push(null)})}v("../utils").inherits(b,m),b.prototype._read=function(){this._helper.resume()},w.exports=b},{"../utils":32,"readable-stream":16}],14:[function(v,w,_){w.exports={isNode:typeof Buffer<"u",newBufferFrom:function(m,b){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(m,b);if(typeof m=="number")throw new Error('The "data" argument must not be a number');return new Buffer(m,b)},allocBuffer:function(m){if(Buffer.alloc)return Buffer.alloc(m);var b=new Buffer(m);return b.fill(0),b},isBuffer:function(m){return Buffer.isBuffer(m)},isStream:function(m){return m&&typeof m.on=="function"&&typeof m.pause=="function"&&typeof m.resume=="function"}}},{}],15:[function(v,w,_){function m(j,A,D){var z,E=l.getTypeOf(A),C=l.extend(D||{},d);C.date=C.date||new Date,C.compression!==null&&(C.compression=C.compression.toUpperCase()),typeof C.unixPermissions=="string"&&(C.unixPermissions=parseInt(C.unixPermissions,8)),C.unixPermissions&&16384&C.unixPermissions&&(C.dir=!0),C.dosPermissions&&16&C.dosPermissions&&(C.dir=!0),C.dir&&(j=c(j)),C.createFolders&&(z=o(j))&&n.call(this,z,!0);var L=E==="string"&&C.binary===!1&&C.base64===!1;D&&D.binary!==void 0||(C.binary=!L),(A instanceof x&&A.uncompressedSize===0||C.dir||!A||A.length===0)&&(C.base64=!1,C.binary=!0,A="",C.compression="STORE",E="string");var N=null;N=A instanceof x||A instanceof u?A:a.isNode&&a.isStream(A)?new t(j,A):l.prepareContent(j,A,C.binary,C.optimizedBinaryString,C.base64);var T=new i(j,N,C);this.files[j]=T}var b=v("./utf8"),l=v("./utils"),u=v("./stream/GenericWorker"),s=v("./stream/StreamHelper"),d=v("./defaults"),x=v("./compressedObject"),i=v("./zipObject"),r=v("./generate"),a=v("./nodejsUtils"),t=v("./nodejs/NodejsStreamInputAdapter"),o=function(j){j.slice(-1)==="/"&&(j=j.substring(0,j.length-1));var A=j.lastIndexOf("/");return 0<A?j.substring(0,A):""},c=function(j){return j.slice(-1)!=="/"&&(j+="/"),j},n=function(j,A){return A=A!==void 0?A:d.createFolders,j=c(j),this.files[j]||m.call(this,j,null,{dir:!0,createFolders:A}),this.files[j]};function h(j){return Object.prototype.toString.call(j)==="[object RegExp]"}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(j){var A,D,z;for(A in this.files)z=this.files[A],(D=A.slice(this.root.length,A.length))&&A.slice(0,this.root.length)===this.root&&j(D,z)},filter:function(j){var A=[];return this.forEach(function(D,z){j(D,z)&&A.push(z)}),A},file:function(j,A,D){if(arguments.length!==1)return j=this.root+j,m.call(this,j,A,D),this;if(h(j)){var z=j;return this.filter(function(C,L){return!L.dir&&z.test(C)})}var E=this.files[this.root+j];return E&&!E.dir?E:null},folder:function(j){if(!j)return this;if(h(j))return this.filter(function(E,C){return C.dir&&j.test(E)});var A=this.root+j,D=n.call(this,A),z=this.clone();return z.root=D.name,z},remove:function(j){j=this.root+j;var A=this.files[j];if(A||(j.slice(-1)!=="/"&&(j+="/"),A=this.files[j]),A&&!A.dir)delete this.files[j];else for(var D=this.filter(function(E,C){return C.name.slice(0,j.length)===j}),z=0;z<D.length;z++)delete this.files[D[z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(j){var A,D={};try{if((D=l.extend(j||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:b.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),D.type==="binarystring"&&(D.type="string"),!D.type)throw new Error("No output type specified.");l.checkSupport(D.type),D.platform!=="darwin"&&D.platform!=="freebsd"&&D.platform!=="linux"&&D.platform!=="sunos"||(D.platform="UNIX"),D.platform==="win32"&&(D.platform="DOS");var z=D.comment||this.comment||"";A=r.generateWorker(this,D,z)}catch(E){(A=new u("error")).error(E)}return new s(A,D.type||"string",D.mimeType)},generateAsync:function(j,A){return this.generateInternalStream(j).accumulate(A)},generateNodeStream:function(j,A){return(j=j||{}).type||(j.type="nodebuffer"),this.generateInternalStream(j).toNodejsStream(A)}};w.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(v,w,_){w.exports=v("stream")},{stream:void 0}],17:[function(v,w,_){var m=v("./DataReader");function b(l){m.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=255&l[u]}v("../utils").inherits(b,m),b.prototype.byteAt=function(l){return this.data[this.zero+l]},b.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),s=l.charCodeAt(1),d=l.charCodeAt(2),x=l.charCodeAt(3),i=this.length-4;0<=i;--i)if(this.data[i]===u&&this.data[i+1]===s&&this.data[i+2]===d&&this.data[i+3]===x)return i-this.zero;return-1},b.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),s=l.charCodeAt(1),d=l.charCodeAt(2),x=l.charCodeAt(3),i=this.readData(4);return u===i[0]&&s===i[1]&&d===i[2]&&x===i[3]},b.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},w.exports=b},{"../utils":32,"./DataReader":18}],18:[function(v,w,_){var m=v("../utils");function b(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}b.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var u,s=0;for(this.checkOffset(l),u=this.index+l-1;u>=this.index;u--)s=(s<<8)+this.byteAt(u);return this.index+=l,s},readString:function(l){return m.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},w.exports=b},{"../utils":32}],19:[function(v,w,_){var m=v("./Uint8ArrayReader");function b(l){m.call(this,l)}v("../utils").inherits(b,m),b.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},w.exports=b},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(v,w,_){var m=v("./DataReader");function b(l){m.call(this,l)}v("../utils").inherits(b,m),b.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},b.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},b.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},b.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},w.exports=b},{"../utils":32,"./DataReader":18}],21:[function(v,w,_){var m=v("./ArrayReader");function b(l){m.call(this,l)}v("../utils").inherits(b,m),b.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},w.exports=b},{"../utils":32,"./ArrayReader":17}],22:[function(v,w,_){var m=v("../utils"),b=v("../support"),l=v("./ArrayReader"),u=v("./StringReader"),s=v("./NodeBufferReader"),d=v("./Uint8ArrayReader");w.exports=function(x){var i=m.getTypeOf(x);return m.checkSupport(i),i!=="string"||b.uint8array?i==="nodebuffer"?new s(x):b.uint8array?new d(m.transformTo("uint8array",x)):new l(m.transformTo("array",x)):new u(x)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(v,w,_){_.LOCAL_FILE_HEADER="PK",_.CENTRAL_FILE_HEADER="PK",_.CENTRAL_DIRECTORY_END="PK",_.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",_.ZIP64_CENTRAL_DIRECTORY_END="PK",_.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(v,w,_){var m=v("./GenericWorker"),b=v("../utils");function l(u){m.call(this,"ConvertWorker to "+u),this.destType=u}b.inherits(l,m),l.prototype.processChunk=function(u){this.push({data:b.transformTo(this.destType,u.data),meta:u.meta})},w.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(v,w,_){var m=v("./GenericWorker"),b=v("../crc32");function l(){m.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}v("../utils").inherits(l,m),l.prototype.processChunk=function(u){this.streamInfo.crc32=b(u.data,this.streamInfo.crc32||0),this.push(u)},w.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(v,w,_){var m=v("../utils"),b=v("./GenericWorker");function l(u){b.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}m.inherits(l,b),l.prototype.processChunk=function(u){if(u){var s=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=s+u.data.length}b.prototype.processChunk.call(this,u)},w.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(v,w,_){var m=v("../utils"),b=v("./GenericWorker");function l(u){b.call(this,"DataWorker");var s=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(d){s.dataIsReady=!0,s.data=d,s.max=d&&d.length||0,s.type=m.getTypeOf(d),s.isPaused||s._tickAndRepeat()},function(d){s.error(d)})}m.inherits(l,b),l.prototype.cleanUp=function(){b.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!b.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,m.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(m.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,s=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,s);break;case"uint8array":u=this.data.subarray(this.index,s);break;case"array":case"nodebuffer":u=this.data.slice(this.index,s)}return this.index=s,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},w.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(v,w,_){function m(b){this.name=b||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}m.prototype={push:function(b){this.emit("data",b)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(b){this.emit("error",b)}return!0},error:function(b){return!this.isFinished&&(this.isPaused?this.generatedError=b:(this.isFinished=!0,this.emit("error",b),this.previous&&this.previous.error(b),this.cleanUp()),!0)},on:function(b,l){return this._listeners[b].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(b,l){if(this._listeners[b])for(var u=0;u<this._listeners[b].length;u++)this._listeners[b][u].call(this,l)},pipe:function(b){return b.registerPrevious(this)},registerPrevious:function(b){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=b.streamInfo,this.mergeStreamInfo(),this.previous=b;var l=this;return b.on("data",function(u){l.processChunk(u)}),b.on("end",function(){l.end()}),b.on("error",function(u){l.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var b=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),b=!0),this.previous&&this.previous.resume(),!b},flush:function(){},processChunk:function(b){this.push(b)},withStreamInfo:function(b,l){return this.extraStreamInfo[b]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var b in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,b)&&(this.streamInfo[b]=this.extraStreamInfo[b])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var b="Worker "+this.name;return this.previous?this.previous+" -> "+b:b}},w.exports=m},{}],29:[function(v,w,_){var m=v("../utils"),b=v("./ConvertWorker"),l=v("./GenericWorker"),u=v("../base64"),s=v("../support"),d=v("../external"),x=null;if(s.nodestream)try{x=v("../nodejs/NodejsStreamOutputAdapter")}catch{}function i(a,t){return new d.Promise(function(o,c){var n=[],h=a._internalType,y=a._outputType,j=a._mimeType;a.on("data",function(A,D){n.push(A),t&&t(D)}).on("error",function(A){n=[],c(A)}).on("end",function(){try{var A=function(D,z,E){switch(D){case"blob":return m.newBlob(m.transformTo("arraybuffer",z),E);case"base64":return u.encode(z);default:return m.transformTo(D,z)}}(y,function(D,z){var E,C=0,L=null,N=0;for(E=0;E<z.length;E++)N+=z[E].length;switch(D){case"string":return z.join("");case"array":return Array.prototype.concat.apply([],z);case"uint8array":for(L=new Uint8Array(N),E=0;E<z.length;E++)L.set(z[E],C),C+=z[E].length;return L;case"nodebuffer":return Buffer.concat(z);default:throw new Error("concat : unsupported type '"+D+"'")}}(h,n),j);o(A)}catch(D){c(D)}n=[]}).resume()})}function r(a,t,o){var c=t;switch(t){case"blob":case"arraybuffer":c="uint8array";break;case"base64":c="string"}try{this._internalType=c,this._outputType=t,this._mimeType=o,m.checkSupport(c),this._worker=a.pipe(new b(c)),a.lock()}catch(n){this._worker=new l("error"),this._worker.error(n)}}r.prototype={accumulate:function(a){return i(this,a)},on:function(a,t){var o=this;return a==="data"?this._worker.on(a,function(c){t.call(o,c.data,c.meta)}):this._worker.on(a,function(){m.delay(t,arguments,o)}),this},resume:function(){return m.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(a){if(m.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new x(this,{objectMode:this._outputType!=="nodebuffer"},a)}},w.exports=r},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(v,w,_){if(_.base64=!0,_.array=!0,_.string=!0,_.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",_.nodebuffer=typeof Buffer<"u",_.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")_.blob=!1;else{var m=new ArrayBuffer(0);try{_.blob=new Blob([m],{type:"application/zip"}).size===0}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);b.append(m),_.blob=b.getBlob("application/zip").size===0}catch{_.blob=!1}}}try{_.nodestream=!!v("readable-stream").Readable}catch{_.nodestream=!1}},{"readable-stream":16}],31:[function(v,w,_){for(var m=v("./utils"),b=v("./support"),l=v("./nodejsUtils"),u=v("./stream/GenericWorker"),s=new Array(256),d=0;d<256;d++)s[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;s[254]=s[254]=1;function x(){u.call(this,"utf-8 decode"),this.leftOver=null}function i(){u.call(this,"utf-8 encode")}_.utf8encode=function(r){return b.nodebuffer?l.newBufferFrom(r,"utf-8"):function(a){var t,o,c,n,h,y=a.length,j=0;for(n=0;n<y;n++)(64512&(o=a.charCodeAt(n)))==55296&&n+1<y&&(64512&(c=a.charCodeAt(n+1)))==56320&&(o=65536+(o-55296<<10)+(c-56320),n++),j+=o<128?1:o<2048?2:o<65536?3:4;for(t=b.uint8array?new Uint8Array(j):new Array(j),n=h=0;h<j;n++)(64512&(o=a.charCodeAt(n)))==55296&&n+1<y&&(64512&(c=a.charCodeAt(n+1)))==56320&&(o=65536+(o-55296<<10)+(c-56320),n++),o<128?t[h++]=o:(o<2048?t[h++]=192|o>>>6:(o<65536?t[h++]=224|o>>>12:(t[h++]=240|o>>>18,t[h++]=128|o>>>12&63),t[h++]=128|o>>>6&63),t[h++]=128|63&o);return t}(r)},_.utf8decode=function(r){return b.nodebuffer?m.transformTo("nodebuffer",r).toString("utf-8"):function(a){var t,o,c,n,h=a.length,y=new Array(2*h);for(t=o=0;t<h;)if((c=a[t++])<128)y[o++]=c;else if(4<(n=s[c]))y[o++]=65533,t+=n-1;else{for(c&=n===2?31:n===3?15:7;1<n&&t<h;)c=c<<6|63&a[t++],n--;1<n?y[o++]=65533:c<65536?y[o++]=c:(c-=65536,y[o++]=55296|c>>10&1023,y[o++]=56320|1023&c)}return y.length!==o&&(y.subarray?y=y.subarray(0,o):y.length=o),m.applyFromCharCode(y)}(r=m.transformTo(b.uint8array?"uint8array":"array",r))},m.inherits(x,u),x.prototype.processChunk=function(r){var a=m.transformTo(b.uint8array?"uint8array":"array",r.data);if(this.leftOver&&this.leftOver.length){if(b.uint8array){var t=a;(a=new Uint8Array(t.length+this.leftOver.length)).set(this.leftOver,0),a.set(t,this.leftOver.length)}else a=this.leftOver.concat(a);this.leftOver=null}var o=function(n,h){var y;for((h=h||n.length)>n.length&&(h=n.length),y=h-1;0<=y&&(192&n[y])==128;)y--;return y<0||y===0?h:y+s[n[y]]>h?y:h}(a),c=a;o!==a.length&&(b.uint8array?(c=a.subarray(0,o),this.leftOver=a.subarray(o,a.length)):(c=a.slice(0,o),this.leftOver=a.slice(o,a.length))),this.push({data:_.utf8decode(c),meta:r.meta})},x.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:_.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},_.Utf8DecodeWorker=x,m.inherits(i,u),i.prototype.processChunk=function(r){this.push({data:_.utf8encode(r.data),meta:r.meta})},_.Utf8EncodeWorker=i},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(v,w,_){var m=v("./support"),b=v("./base64"),l=v("./nodejsUtils"),u=v("./external");function s(t){return t}function d(t,o){for(var c=0;c<t.length;++c)o[c]=255&t.charCodeAt(c);return o}v("setimmediate"),_.newBlob=function(t,o){_.checkSupport("blob");try{return new Blob([t],{type:o})}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return c.append(t),c.getBlob(o)}catch{throw new Error("Bug : can't construct the Blob.")}}};var x={stringifyByChunk:function(t,o,c){var n=[],h=0,y=t.length;if(y<=c)return String.fromCharCode.apply(null,t);for(;h<y;)o==="array"||o==="nodebuffer"?n.push(String.fromCharCode.apply(null,t.slice(h,Math.min(h+c,y)))):n.push(String.fromCharCode.apply(null,t.subarray(h,Math.min(h+c,y)))),h+=c;return n.join("")},stringifyByChar:function(t){for(var o="",c=0;c<t.length;c++)o+=String.fromCharCode(t[c]);return o},applyCanBeUsed:{uint8array:function(){try{return m.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return m.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function i(t){var o=65536,c=_.getTypeOf(t),n=!0;if(c==="uint8array"?n=x.applyCanBeUsed.uint8array:c==="nodebuffer"&&(n=x.applyCanBeUsed.nodebuffer),n)for(;1<o;)try{return x.stringifyByChunk(t,c,o)}catch{o=Math.floor(o/2)}return x.stringifyByChar(t)}function r(t,o){for(var c=0;c<t.length;c++)o[c]=t[c];return o}_.applyFromCharCode=i;var a={};a.string={string:s,array:function(t){return d(t,new Array(t.length))},arraybuffer:function(t){return a.string.uint8array(t).buffer},uint8array:function(t){return d(t,new Uint8Array(t.length))},nodebuffer:function(t){return d(t,l.allocBuffer(t.length))}},a.array={string:i,array:s,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return l.newBufferFrom(t)}},a.arraybuffer={string:function(t){return i(new Uint8Array(t))},array:function(t){return r(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:s,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return l.newBufferFrom(new Uint8Array(t))}},a.uint8array={string:i,array:function(t){return r(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:s,nodebuffer:function(t){return l.newBufferFrom(t)}},a.nodebuffer={string:i,array:function(t){return r(t,new Array(t.length))},arraybuffer:function(t){return a.nodebuffer.uint8array(t).buffer},uint8array:function(t){return r(t,new Uint8Array(t.length))},nodebuffer:s},_.transformTo=function(t,o){if(o=o||"",!t)return o;_.checkSupport(t);var c=_.getTypeOf(o);return a[c][t](o)},_.resolve=function(t){for(var o=t.split("/"),c=[],n=0;n<o.length;n++){var h=o[n];h==="."||h===""&&n!==0&&n!==o.length-1||(h===".."?c.pop():c.push(h))}return c.join("/")},_.getTypeOf=function(t){return typeof t=="string"?"string":Object.prototype.toString.call(t)==="[object Array]"?"array":m.nodebuffer&&l.isBuffer(t)?"nodebuffer":m.uint8array&&t instanceof Uint8Array?"uint8array":m.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},_.checkSupport=function(t){if(!m[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},_.MAX_VALUE_16BITS=65535,_.MAX_VALUE_32BITS=-1,_.pretty=function(t){var o,c,n="";for(c=0;c<(t||"").length;c++)n+="\\x"+((o=t.charCodeAt(c))<16?"0":"")+o.toString(16).toUpperCase();return n},_.delay=function(t,o,c){setImmediate(function(){t.apply(c||null,o||[])})},_.inherits=function(t,o){function c(){}c.prototype=o.prototype,t.prototype=new c},_.extend=function(){var t,o,c={};for(t=0;t<arguments.length;t++)for(o in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],o)&&c[o]===void 0&&(c[o]=arguments[t][o]);return c},_.prepareContent=function(t,o,c,n,h){return u.Promise.resolve(o).then(function(y){return m.blob&&(y instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(y))!==-1)&&typeof FileReader<"u"?new u.Promise(function(j,A){var D=new FileReader;D.onload=function(z){j(z.target.result)},D.onerror=function(z){A(z.target.error)},D.readAsArrayBuffer(y)}):y}).then(function(y){var j=_.getTypeOf(y);return j?(j==="arraybuffer"?y=_.transformTo("uint8array",y):j==="string"&&(h?y=b.decode(y):c&&n!==!0&&(y=function(A){return d(A,m.uint8array?new Uint8Array(A.length):new Array(A.length))}(y))),y):u.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(v,w,_){var m=v("./reader/readerFor"),b=v("./utils"),l=v("./signature"),u=v("./zipEntry"),s=v("./support");function d(x){this.files=[],this.loadOptions=x}d.prototype={checkSignature:function(x){if(!this.reader.readAndCheckSignature(x)){this.reader.index-=4;var i=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+b.pretty(i)+", expected "+b.pretty(x)+")")}},isSignature:function(x,i){var r=this.reader.index;this.reader.setIndex(x);var a=this.reader.readString(4)===i;return this.reader.setIndex(r),a},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var x=this.reader.readData(this.zipCommentLength),i=s.uint8array?"uint8array":"array",r=b.transformTo(i,x);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var x,i,r,a=this.zip64EndOfCentralSize-44;0<a;)x=this.reader.readInt(2),i=this.reader.readInt(4),r=this.reader.readData(i),this.zip64ExtensibleData[x]={id:x,length:i,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var x,i;for(x=0;x<this.files.length;x++)i=this.files[x],this.reader.setIndex(i.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),i.readLocalPart(this.reader),i.handleUTF8(),i.processAttributes()},readCentralDir:function(){var x;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(x=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(x);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var x=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(x<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(x);var i=x;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===b.MAX_VALUE_16BITS||this.diskWithCentralDirStart===b.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===b.MAX_VALUE_16BITS||this.centralDirRecords===b.MAX_VALUE_16BITS||this.centralDirSize===b.MAX_VALUE_32BITS||this.centralDirOffset===b.MAX_VALUE_32BITS){if(this.zip64=!0,(x=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(x),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var a=i-r;if(0<a)this.isSignature(i,l.CENTRAL_FILE_HEADER)||(this.reader.zero=a);else if(a<0)throw new Error("Corrupted zip: missing "+Math.abs(a)+" bytes.")},prepareReader:function(x){this.reader=m(x)},load:function(x){this.prepareReader(x),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},w.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(v,w,_){var m=v("./reader/readerFor"),b=v("./utils"),l=v("./compressedObject"),u=v("./crc32"),s=v("./utf8"),d=v("./compressions"),x=v("./support");function i(r,a){this.options=r,this.loadOptions=a}i.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(r){var a,t;if(r.skip(22),this.fileNameLength=r.readInt(2),t=r.readInt(2),this.fileName=r.readData(this.fileNameLength),r.skip(t),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((a=function(o){for(var c in d)if(Object.prototype.hasOwnProperty.call(d,c)&&d[c].magic===o)return d[c];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+b.pretty(this.compressionMethod)+" unknown (inner file : "+b.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,a,r.readData(this.compressedSize))},readCentralPart:function(r){this.versionMadeBy=r.readInt(2),r.skip(2),this.bitFlag=r.readInt(2),this.compressionMethod=r.readString(2),this.date=r.readDate(),this.crc32=r.readInt(4),this.compressedSize=r.readInt(4),this.uncompressedSize=r.readInt(4);var a=r.readInt(2);if(this.extraFieldsLength=r.readInt(2),this.fileCommentLength=r.readInt(2),this.diskNumberStart=r.readInt(2),this.internalFileAttributes=r.readInt(2),this.externalFileAttributes=r.readInt(4),this.localHeaderOffset=r.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");r.skip(a),this.readExtraFields(r),this.parseZIP64ExtraField(r),this.fileComment=r.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var r=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),r==0&&(this.dosPermissions=63&this.externalFileAttributes),r==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var r=m(this.extraFields[1].value);this.uncompressedSize===b.MAX_VALUE_32BITS&&(this.uncompressedSize=r.readInt(8)),this.compressedSize===b.MAX_VALUE_32BITS&&(this.compressedSize=r.readInt(8)),this.localHeaderOffset===b.MAX_VALUE_32BITS&&(this.localHeaderOffset=r.readInt(8)),this.diskNumberStart===b.MAX_VALUE_32BITS&&(this.diskNumberStart=r.readInt(4))}},readExtraFields:function(r){var a,t,o,c=r.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});r.index+4<c;)a=r.readInt(2),t=r.readInt(2),o=r.readData(t),this.extraFields[a]={id:a,length:t,value:o};r.setIndex(c)},handleUTF8:function(){var r=x.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var a=this.findExtraFieldUnicodePath();if(a!==null)this.fileNameStr=a;else{var t=b.transformTo(r,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(t)}var o=this.findExtraFieldUnicodeComment();if(o!==null)this.fileCommentStr=o;else{var c=b.transformTo(r,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(c)}}},findExtraFieldUnicodePath:function(){var r=this.extraFields[28789];if(r){var a=m(r.value);return a.readInt(1)!==1||u(this.fileName)!==a.readInt(4)?null:s.utf8decode(a.readData(r.length-5))}return null},findExtraFieldUnicodeComment:function(){var r=this.extraFields[25461];if(r){var a=m(r.value);return a.readInt(1)!==1||u(this.fileComment)!==a.readInt(4)?null:s.utf8decode(a.readData(r.length-5))}return null}},w.exports=i},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(v,w,_){function m(a,t,o){this.name=a,this.dir=o.dir,this.date=o.date,this.comment=o.comment,this.unixPermissions=o.unixPermissions,this.dosPermissions=o.dosPermissions,this._data=t,this._dataBinary=o.binary,this.options={compression:o.compression,compressionOptions:o.compressionOptions}}var b=v("./stream/StreamHelper"),l=v("./stream/DataWorker"),u=v("./utf8"),s=v("./compressedObject"),d=v("./stream/GenericWorker");m.prototype={internalStream:function(a){var t=null,o="string";try{if(!a)throw new Error("No output type specified.");var c=(o=a.toLowerCase())==="string"||o==="text";o!=="binarystring"&&o!=="text"||(o="string"),t=this._decompressWorker();var n=!this._dataBinary;n&&!c&&(t=t.pipe(new u.Utf8EncodeWorker)),!n&&c&&(t=t.pipe(new u.Utf8DecodeWorker))}catch(h){(t=new d("error")).error(h)}return new b(t,o,"")},async:function(a,t){return this.internalStream(a).accumulate(t)},nodeStream:function(a,t){return this.internalStream(a||"nodebuffer").toNodejsStream(t)},_compressWorker:function(a,t){if(this._data instanceof s&&this._data.compression.magic===a.magic)return this._data.getCompressedWorker();var o=this._decompressWorker();return this._dataBinary||(o=o.pipe(new u.Utf8EncodeWorker)),s.createWorkerFrom(o,a,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var x=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],i=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},r=0;r<x.length;r++)m.prototype[x[r]]=i;w.exports=m},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(v,w,_){(function(m){var b,l,u=m.MutationObserver||m.WebKitMutationObserver;if(u){var s=0,d=new u(a),x=m.document.createTextNode("");d.observe(x,{characterData:!0}),b=function(){x.data=s=++s%2}}else if(m.setImmediate||m.MessageChannel===void 0)b="document"in m&&"onreadystatechange"in m.document.createElement("script")?function(){var t=m.document.createElement("script");t.onreadystatechange=function(){a(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},m.document.documentElement.appendChild(t)}:function(){setTimeout(a,0)};else{var i=new m.MessageChannel;i.port1.onmessage=a,b=function(){i.port2.postMessage(0)}}var r=[];function a(){var t,o;l=!0;for(var c=r.length;c;){for(o=r,r=[],t=-1;++t<c;)o[t]();c=r.length}l=!1}w.exports=function(t){r.push(t)!==1||l||b()}}).call(this,typeof fe<"u"?fe:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(v,w,_){var m=v("immediate");function b(){}var l={},u=["REJECTED"],s=["FULFILLED"],d=["PENDING"];function x(c){if(typeof c!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,c!==b&&t(this,c)}function i(c,n,h){this.promise=c,typeof n=="function"&&(this.onFulfilled=n,this.callFulfilled=this.otherCallFulfilled),typeof h=="function"&&(this.onRejected=h,this.callRejected=this.otherCallRejected)}function r(c,n,h){m(function(){var y;try{y=n(h)}catch(j){return l.reject(c,j)}y===c?l.reject(c,new TypeError("Cannot resolve promise with itself")):l.resolve(c,y)})}function a(c){var n=c&&c.then;if(c&&(typeof c=="object"||typeof c=="function")&&typeof n=="function")return function(){n.apply(c,arguments)}}function t(c,n){var h=!1;function y(D){h||(h=!0,l.reject(c,D))}function j(D){h||(h=!0,l.resolve(c,D))}var A=o(function(){n(j,y)});A.status==="error"&&y(A.value)}function o(c,n){var h={};try{h.value=c(n),h.status="success"}catch(y){h.status="error",h.value=y}return h}(w.exports=x).prototype.finally=function(c){if(typeof c!="function")return this;var n=this.constructor;return this.then(function(h){return n.resolve(c()).then(function(){return h})},function(h){return n.resolve(c()).then(function(){throw h})})},x.prototype.catch=function(c){return this.then(null,c)},x.prototype.then=function(c,n){if(typeof c!="function"&&this.state===s||typeof n!="function"&&this.state===u)return this;var h=new this.constructor(b);return this.state!==d?r(h,this.state===s?c:n,this.outcome):this.queue.push(new i(h,c,n)),h},i.prototype.callFulfilled=function(c){l.resolve(this.promise,c)},i.prototype.otherCallFulfilled=function(c){r(this.promise,this.onFulfilled,c)},i.prototype.callRejected=function(c){l.reject(this.promise,c)},i.prototype.otherCallRejected=function(c){r(this.promise,this.onRejected,c)},l.resolve=function(c,n){var h=o(a,n);if(h.status==="error")return l.reject(c,h.value);var y=h.value;if(y)t(c,y);else{c.state=s,c.outcome=n;for(var j=-1,A=c.queue.length;++j<A;)c.queue[j].callFulfilled(n)}return c},l.reject=function(c,n){c.state=u,c.outcome=n;for(var h=-1,y=c.queue.length;++h<y;)c.queue[h].callRejected(n);return c},x.resolve=function(c){return c instanceof this?c:l.resolve(new this(b),c)},x.reject=function(c){var n=new this(b);return l.reject(n,c)},x.all=function(c){var n=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var h=c.length,y=!1;if(!h)return this.resolve([]);for(var j=new Array(h),A=0,D=-1,z=new this(b);++D<h;)E(c[D],D);return z;function E(C,L){n.resolve(C).then(function(N){j[L]=N,++A!==h||y||(y=!0,l.resolve(z,j))},function(N){y||(y=!0,l.reject(z,N))})}},x.race=function(c){var n=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var h=c.length,y=!1;if(!h)return this.resolve([]);for(var j=-1,A=new this(b);++j<h;)D=c[j],n.resolve(D).then(function(z){y||(y=!0,l.resolve(A,z))},function(z){y||(y=!0,l.reject(A,z))});var D;return A}},{immediate:36}],38:[function(v,w,_){var m={};(0,v("./lib/utils/common").assign)(m,v("./lib/deflate"),v("./lib/inflate"),v("./lib/zlib/constants")),w.exports=m},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(v,w,_){var m=v("./zlib/deflate"),b=v("./utils/common"),l=v("./utils/strings"),u=v("./zlib/messages"),s=v("./zlib/zstream"),d=Object.prototype.toString,x=0,i=-1,r=0,a=8;function t(c){if(!(this instanceof t))return new t(c);this.options=b.assign({level:i,method:a,chunkSize:16384,windowBits:15,memLevel:8,strategy:r,to:""},c||{});var n=this.options;n.raw&&0<n.windowBits?n.windowBits=-n.windowBits:n.gzip&&0<n.windowBits&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var h=m.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(h!==x)throw new Error(u[h]);if(n.header&&m.deflateSetHeader(this.strm,n.header),n.dictionary){var y;if(y=typeof n.dictionary=="string"?l.string2buf(n.dictionary):d.call(n.dictionary)==="[object ArrayBuffer]"?new Uint8Array(n.dictionary):n.dictionary,(h=m.deflateSetDictionary(this.strm,y))!==x)throw new Error(u[h]);this._dict_set=!0}}function o(c,n){var h=new t(n);if(h.push(c,!0),h.err)throw h.msg||u[h.err];return h.result}t.prototype.push=function(c,n){var h,y,j=this.strm,A=this.options.chunkSize;if(this.ended)return!1;y=n===~~n?n:n===!0?4:0,typeof c=="string"?j.input=l.string2buf(c):d.call(c)==="[object ArrayBuffer]"?j.input=new Uint8Array(c):j.input=c,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new b.Buf8(A),j.next_out=0,j.avail_out=A),(h=m.deflate(j,y))!==1&&h!==x)return this.onEnd(h),!(this.ended=!0);j.avail_out!==0&&(j.avail_in!==0||y!==4&&y!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(b.shrinkBuf(j.output,j.next_out))):this.onData(b.shrinkBuf(j.output,j.next_out)))}while((0<j.avail_in||j.avail_out===0)&&h!==1);return y===4?(h=m.deflateEnd(this.strm),this.onEnd(h),this.ended=!0,h===x):y!==2||(this.onEnd(x),!(j.avail_out=0))},t.prototype.onData=function(c){this.chunks.push(c)},t.prototype.onEnd=function(c){c===x&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=b.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},_.Deflate=t,_.deflate=o,_.deflateRaw=function(c,n){return(n=n||{}).raw=!0,o(c,n)},_.gzip=function(c,n){return(n=n||{}).gzip=!0,o(c,n)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(v,w,_){var m=v("./zlib/inflate"),b=v("./utils/common"),l=v("./utils/strings"),u=v("./zlib/constants"),s=v("./zlib/messages"),d=v("./zlib/zstream"),x=v("./zlib/gzheader"),i=Object.prototype.toString;function r(t){if(!(this instanceof r))return new r(t);this.options=b.assign({chunkSize:16384,windowBits:0,to:""},t||{});var o=this.options;o.raw&&0<=o.windowBits&&o.windowBits<16&&(o.windowBits=-o.windowBits,o.windowBits===0&&(o.windowBits=-15)),!(0<=o.windowBits&&o.windowBits<16)||t&&t.windowBits||(o.windowBits+=32),15<o.windowBits&&o.windowBits<48&&!(15&o.windowBits)&&(o.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var c=m.inflateInit2(this.strm,o.windowBits);if(c!==u.Z_OK)throw new Error(s[c]);this.header=new x,m.inflateGetHeader(this.strm,this.header)}function a(t,o){var c=new r(o);if(c.push(t,!0),c.err)throw c.msg||s[c.err];return c.result}r.prototype.push=function(t,o){var c,n,h,y,j,A,D=this.strm,z=this.options.chunkSize,E=this.options.dictionary,C=!1;if(this.ended)return!1;n=o===~~o?o:o===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof t=="string"?D.input=l.binstring2buf(t):i.call(t)==="[object ArrayBuffer]"?D.input=new Uint8Array(t):D.input=t,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new b.Buf8(z),D.next_out=0,D.avail_out=z),(c=m.inflate(D,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&E&&(A=typeof E=="string"?l.string2buf(E):i.call(E)==="[object ArrayBuffer]"?new Uint8Array(E):E,c=m.inflateSetDictionary(this.strm,A)),c===u.Z_BUF_ERROR&&C===!0&&(c=u.Z_OK,C=!1),c!==u.Z_STREAM_END&&c!==u.Z_OK)return this.onEnd(c),!(this.ended=!0);D.next_out&&(D.avail_out!==0&&c!==u.Z_STREAM_END&&(D.avail_in!==0||n!==u.Z_FINISH&&n!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(h=l.utf8border(D.output,D.next_out),y=D.next_out-h,j=l.buf2string(D.output,h),D.next_out=y,D.avail_out=z-y,y&&b.arraySet(D.output,D.output,h,y,0),this.onData(j)):this.onData(b.shrinkBuf(D.output,D.next_out)))),D.avail_in===0&&D.avail_out===0&&(C=!0)}while((0<D.avail_in||D.avail_out===0)&&c!==u.Z_STREAM_END);return c===u.Z_STREAM_END&&(n=u.Z_FINISH),n===u.Z_FINISH?(c=m.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===u.Z_OK):n!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(D.avail_out=0))},r.prototype.onData=function(t){this.chunks.push(t)},r.prototype.onEnd=function(t){t===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=b.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},_.Inflate=r,_.inflate=a,_.inflateRaw=function(t,o){return(o=o||{}).raw=!0,a(t,o)},_.ungzip=a},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(v,w,_){var m=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";_.assign=function(u){for(var s=Array.prototype.slice.call(arguments,1);s.length;){var d=s.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var x in d)d.hasOwnProperty(x)&&(u[x]=d[x])}}return u},_.shrinkBuf=function(u,s){return u.length===s?u:u.subarray?u.subarray(0,s):(u.length=s,u)};var b={arraySet:function(u,s,d,x,i){if(s.subarray&&u.subarray)u.set(s.subarray(d,d+x),i);else for(var r=0;r<x;r++)u[i+r]=s[d+r]},flattenChunks:function(u){var s,d,x,i,r,a;for(s=x=0,d=u.length;s<d;s++)x+=u[s].length;for(a=new Uint8Array(x),s=i=0,d=u.length;s<d;s++)r=u[s],a.set(r,i),i+=r.length;return a}},l={arraySet:function(u,s,d,x,i){for(var r=0;r<x;r++)u[i+r]=s[d+r]},flattenChunks:function(u){return[].concat.apply([],u)}};_.setTyped=function(u){u?(_.Buf8=Uint8Array,_.Buf16=Uint16Array,_.Buf32=Int32Array,_.assign(_,b)):(_.Buf8=Array,_.Buf16=Array,_.Buf32=Array,_.assign(_,l))},_.setTyped(m)},{}],42:[function(v,w,_){var m=v("./common"),b=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{b=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var u=new m.Buf8(256),s=0;s<256;s++)u[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function d(x,i){if(i<65537&&(x.subarray&&l||!x.subarray&&b))return String.fromCharCode.apply(null,m.shrinkBuf(x,i));for(var r="",a=0;a<i;a++)r+=String.fromCharCode(x[a]);return r}u[254]=u[254]=1,_.string2buf=function(x){var i,r,a,t,o,c=x.length,n=0;for(t=0;t<c;t++)(64512&(r=x.charCodeAt(t)))==55296&&t+1<c&&(64512&(a=x.charCodeAt(t+1)))==56320&&(r=65536+(r-55296<<10)+(a-56320),t++),n+=r<128?1:r<2048?2:r<65536?3:4;for(i=new m.Buf8(n),t=o=0;o<n;t++)(64512&(r=x.charCodeAt(t)))==55296&&t+1<c&&(64512&(a=x.charCodeAt(t+1)))==56320&&(r=65536+(r-55296<<10)+(a-56320),t++),r<128?i[o++]=r:(r<2048?i[o++]=192|r>>>6:(r<65536?i[o++]=224|r>>>12:(i[o++]=240|r>>>18,i[o++]=128|r>>>12&63),i[o++]=128|r>>>6&63),i[o++]=128|63&r);return i},_.buf2binstring=function(x){return d(x,x.length)},_.binstring2buf=function(x){for(var i=new m.Buf8(x.length),r=0,a=i.length;r<a;r++)i[r]=x.charCodeAt(r);return i},_.buf2string=function(x,i){var r,a,t,o,c=i||x.length,n=new Array(2*c);for(r=a=0;r<c;)if((t=x[r++])<128)n[a++]=t;else if(4<(o=u[t]))n[a++]=65533,r+=o-1;else{for(t&=o===2?31:o===3?15:7;1<o&&r<c;)t=t<<6|63&x[r++],o--;1<o?n[a++]=65533:t<65536?n[a++]=t:(t-=65536,n[a++]=55296|t>>10&1023,n[a++]=56320|1023&t)}return d(n,a)},_.utf8border=function(x,i){var r;for((i=i||x.length)>x.length&&(i=x.length),r=i-1;0<=r&&(192&x[r])==128;)r--;return r<0||r===0?i:r+u[x[r]]>i?r:i}},{"./common":41}],43:[function(v,w,_){w.exports=function(m,b,l,u){for(var s=65535&m|0,d=m>>>16&65535|0,x=0;l!==0;){for(l-=x=2e3<l?2e3:l;d=d+(s=s+b[u++]|0)|0,--x;);s%=65521,d%=65521}return s|d<<16|0}},{}],44:[function(v,w,_){w.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(v,w,_){var m=function(){for(var b,l=[],u=0;u<256;u++){b=u;for(var s=0;s<8;s++)b=1&b?3988292384^b>>>1:b>>>1;l[u]=b}return l}();w.exports=function(b,l,u,s){var d=m,x=s+u;b^=-1;for(var i=s;i<x;i++)b=b>>>8^d[255&(b^l[i])];return-1^b}},{}],46:[function(v,w,_){var m,b=v("../utils/common"),l=v("./trees"),u=v("./adler32"),s=v("./crc32"),d=v("./messages"),x=0,i=4,r=0,a=-2,t=-1,o=4,c=2,n=8,h=9,y=286,j=30,A=19,D=2*y+1,z=15,E=3,C=258,L=C+E+1,N=42,T=113,p=1,W=2,X=3,Y=4;function oe(g,Q){return g.msg=d[Q],Q}function K(g){return(g<<1)-(4<g?9:0)}function ie(g){for(var Q=g.length;0<=--Q;)g[Q]=0}function F(g){var Q=g.state,Z=Q.pending;Z>g.avail_out&&(Z=g.avail_out),Z!==0&&(b.arraySet(g.output,Q.pending_buf,Q.pending_out,Z,g.next_out),g.next_out+=Z,Q.pending_out+=Z,g.total_out+=Z,g.avail_out-=Z,Q.pending-=Z,Q.pending===0&&(Q.pending_out=0))}function S(g,Q){l._tr_flush_block(g,0<=g.block_start?g.block_start:-1,g.strstart-g.block_start,Q),g.block_start=g.strstart,F(g.strm)}function V(g,Q){g.pending_buf[g.pending++]=Q}function H(g,Q){g.pending_buf[g.pending++]=Q>>>8&255,g.pending_buf[g.pending++]=255&Q}function ee(g,Q){var Z,I,B=g.max_chain_length,P=g.strstart,J=g.prev_length,te=g.nice_match,$=g.strstart>g.w_size-L?g.strstart-(g.w_size-L):0,ae=g.window,le=g.w_mask,ne=g.prev,xe=g.strstart+C,we=ae[P+J-1],be=ae[P+J];g.prev_length>=g.good_match&&(B>>=2),te>g.lookahead&&(te=g.lookahead);do if(ae[(Z=Q)+J]===be&&ae[Z+J-1]===we&&ae[Z]===ae[P]&&ae[++Z]===ae[P+1]){P+=2,Z++;do;while(ae[++P]===ae[++Z]&&ae[++P]===ae[++Z]&&ae[++P]===ae[++Z]&&ae[++P]===ae[++Z]&&ae[++P]===ae[++Z]&&ae[++P]===ae[++Z]&&ae[++P]===ae[++Z]&&ae[++P]===ae[++Z]&&P<xe);if(I=C-(xe-P),P=xe-C,J<I){if(g.match_start=Q,te<=(J=I))break;we=ae[P+J-1],be=ae[P+J]}}while((Q=ne[Q&le])>$&&--B!=0);return J<=g.lookahead?J:g.lookahead}function ue(g){var Q,Z,I,B,P,J,te,$,ae,le,ne=g.w_size;do{if(B=g.window_size-g.lookahead-g.strstart,g.strstart>=ne+(ne-L)){for(b.arraySet(g.window,g.window,ne,ne,0),g.match_start-=ne,g.strstart-=ne,g.block_start-=ne,Q=Z=g.hash_size;I=g.head[--Q],g.head[Q]=ne<=I?I-ne:0,--Z;);for(Q=Z=ne;I=g.prev[--Q],g.prev[Q]=ne<=I?I-ne:0,--Z;);B+=ne}if(g.strm.avail_in===0)break;if(J=g.strm,te=g.window,$=g.strstart+g.lookahead,ae=B,le=void 0,le=J.avail_in,ae<le&&(le=ae),Z=le===0?0:(J.avail_in-=le,b.arraySet(te,J.input,J.next_in,le,$),J.state.wrap===1?J.adler=u(J.adler,te,le,$):J.state.wrap===2&&(J.adler=s(J.adler,te,le,$)),J.next_in+=le,J.total_in+=le,le),g.lookahead+=Z,g.lookahead+g.insert>=E)for(P=g.strstart-g.insert,g.ins_h=g.window[P],g.ins_h=(g.ins_h<<g.hash_shift^g.window[P+1])&g.hash_mask;g.insert&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[P+E-1])&g.hash_mask,g.prev[P&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=P,P++,g.insert--,!(g.lookahead+g.insert<E)););}while(g.lookahead<L&&g.strm.avail_in!==0)}function ge(g,Q){for(var Z,I;;){if(g.lookahead<L){if(ue(g),g.lookahead<L&&Q===x)return p;if(g.lookahead===0)break}if(Z=0,g.lookahead>=E&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+E-1])&g.hash_mask,Z=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),Z!==0&&g.strstart-Z<=g.w_size-L&&(g.match_length=ee(g,Z)),g.match_length>=E)if(I=l._tr_tally(g,g.strstart-g.match_start,g.match_length-E),g.lookahead-=g.match_length,g.match_length<=g.max_lazy_match&&g.lookahead>=E){for(g.match_length--;g.strstart++,g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+E-1])&g.hash_mask,Z=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart,--g.match_length!=0;);g.strstart++}else g.strstart+=g.match_length,g.match_length=0,g.ins_h=g.window[g.strstart],g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+1])&g.hash_mask;else I=l._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++;if(I&&(S(g,!1),g.strm.avail_out===0))return p}return g.insert=g.strstart<E-1?g.strstart:E-1,Q===i?(S(g,!0),g.strm.avail_out===0?X:Y):g.last_lit&&(S(g,!1),g.strm.avail_out===0)?p:W}function q(g,Q){for(var Z,I,B;;){if(g.lookahead<L){if(ue(g),g.lookahead<L&&Q===x)return p;if(g.lookahead===0)break}if(Z=0,g.lookahead>=E&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+E-1])&g.hash_mask,Z=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),g.prev_length=g.match_length,g.prev_match=g.match_start,g.match_length=E-1,Z!==0&&g.prev_length<g.max_lazy_match&&g.strstart-Z<=g.w_size-L&&(g.match_length=ee(g,Z),g.match_length<=5&&(g.strategy===1||g.match_length===E&&4096<g.strstart-g.match_start)&&(g.match_length=E-1)),g.prev_length>=E&&g.match_length<=g.prev_length){for(B=g.strstart+g.lookahead-E,I=l._tr_tally(g,g.strstart-1-g.prev_match,g.prev_length-E),g.lookahead-=g.prev_length-1,g.prev_length-=2;++g.strstart<=B&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+E-1])&g.hash_mask,Z=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),--g.prev_length!=0;);if(g.match_available=0,g.match_length=E-1,g.strstart++,I&&(S(g,!1),g.strm.avail_out===0))return p}else if(g.match_available){if((I=l._tr_tally(g,0,g.window[g.strstart-1]))&&S(g,!1),g.strstart++,g.lookahead--,g.strm.avail_out===0)return p}else g.match_available=1,g.strstart++,g.lookahead--}return g.match_available&&(I=l._tr_tally(g,0,g.window[g.strstart-1]),g.match_available=0),g.insert=g.strstart<E-1?g.strstart:E-1,Q===i?(S(g,!0),g.strm.avail_out===0?X:Y):g.last_lit&&(S(g,!1),g.strm.avail_out===0)?p:W}function ce(g,Q,Z,I,B){this.good_length=g,this.max_lazy=Q,this.nice_length=Z,this.max_chain=I,this.func=B}function ve(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=n,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new b.Buf16(2*D),this.dyn_dtree=new b.Buf16(2*(2*j+1)),this.bl_tree=new b.Buf16(2*(2*A+1)),ie(this.dyn_ltree),ie(this.dyn_dtree),ie(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new b.Buf16(z+1),this.heap=new b.Buf16(2*y+1),ie(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new b.Buf16(2*y+1),ie(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pe(g){var Q;return g&&g.state?(g.total_in=g.total_out=0,g.data_type=c,(Q=g.state).pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap?N:T,g.adler=Q.wrap===2?0:1,Q.last_flush=x,l._tr_init(Q),r):oe(g,a)}function Ee(g){var Q=pe(g);return Q===r&&function(Z){Z.window_size=2*Z.w_size,ie(Z.head),Z.max_lazy_match=m[Z.level].max_lazy,Z.good_match=m[Z.level].good_length,Z.nice_match=m[Z.level].nice_length,Z.max_chain_length=m[Z.level].max_chain,Z.strstart=0,Z.block_start=0,Z.lookahead=0,Z.insert=0,Z.match_length=Z.prev_length=E-1,Z.match_available=0,Z.ins_h=0}(g.state),Q}function Ne(g,Q,Z,I,B,P){if(!g)return a;var J=1;if(Q===t&&(Q=6),I<0?(J=0,I=-I):15<I&&(J=2,I-=16),B<1||h<B||Z!==n||I<8||15<I||Q<0||9<Q||P<0||o<P)return oe(g,a);I===8&&(I=9);var te=new ve;return(g.state=te).strm=g,te.wrap=J,te.gzhead=null,te.w_bits=I,te.w_size=1<<te.w_bits,te.w_mask=te.w_size-1,te.hash_bits=B+7,te.hash_size=1<<te.hash_bits,te.hash_mask=te.hash_size-1,te.hash_shift=~~((te.hash_bits+E-1)/E),te.window=new b.Buf8(2*te.w_size),te.head=new b.Buf16(te.hash_size),te.prev=new b.Buf16(te.w_size),te.lit_bufsize=1<<B+6,te.pending_buf_size=4*te.lit_bufsize,te.pending_buf=new b.Buf8(te.pending_buf_size),te.d_buf=1*te.lit_bufsize,te.l_buf=3*te.lit_bufsize,te.level=Q,te.strategy=P,te.method=Z,Ee(g)}m=[new ce(0,0,0,0,function(g,Q){var Z=65535;for(Z>g.pending_buf_size-5&&(Z=g.pending_buf_size-5);;){if(g.lookahead<=1){if(ue(g),g.lookahead===0&&Q===x)return p;if(g.lookahead===0)break}g.strstart+=g.lookahead,g.lookahead=0;var I=g.block_start+Z;if((g.strstart===0||g.strstart>=I)&&(g.lookahead=g.strstart-I,g.strstart=I,S(g,!1),g.strm.avail_out===0)||g.strstart-g.block_start>=g.w_size-L&&(S(g,!1),g.strm.avail_out===0))return p}return g.insert=0,Q===i?(S(g,!0),g.strm.avail_out===0?X:Y):(g.strstart>g.block_start&&(S(g,!1),g.strm.avail_out),p)}),new ce(4,4,8,4,ge),new ce(4,5,16,8,ge),new ce(4,6,32,32,ge),new ce(4,4,16,16,q),new ce(8,16,32,32,q),new ce(8,16,128,128,q),new ce(8,32,128,256,q),new ce(32,128,258,1024,q),new ce(32,258,258,4096,q)],_.deflateInit=function(g,Q){return Ne(g,Q,n,15,8,0)},_.deflateInit2=Ne,_.deflateReset=Ee,_.deflateResetKeep=pe,_.deflateSetHeader=function(g,Q){return g&&g.state?g.state.wrap!==2?a:(g.state.gzhead=Q,r):a},_.deflate=function(g,Q){var Z,I,B,P;if(!g||!g.state||5<Q||Q<0)return g?oe(g,a):a;if(I=g.state,!g.output||!g.input&&g.avail_in!==0||I.status===666&&Q!==i)return oe(g,g.avail_out===0?-5:a);if(I.strm=g,Z=I.last_flush,I.last_flush=Q,I.status===N)if(I.wrap===2)g.adler=0,V(I,31),V(I,139),V(I,8),I.gzhead?(V(I,(I.gzhead.text?1:0)+(I.gzhead.hcrc?2:0)+(I.gzhead.extra?4:0)+(I.gzhead.name?8:0)+(I.gzhead.comment?16:0)),V(I,255&I.gzhead.time),V(I,I.gzhead.time>>8&255),V(I,I.gzhead.time>>16&255),V(I,I.gzhead.time>>24&255),V(I,I.level===9?2:2<=I.strategy||I.level<2?4:0),V(I,255&I.gzhead.os),I.gzhead.extra&&I.gzhead.extra.length&&(V(I,255&I.gzhead.extra.length),V(I,I.gzhead.extra.length>>8&255)),I.gzhead.hcrc&&(g.adler=s(g.adler,I.pending_buf,I.pending,0)),I.gzindex=0,I.status=69):(V(I,0),V(I,0),V(I,0),V(I,0),V(I,0),V(I,I.level===9?2:2<=I.strategy||I.level<2?4:0),V(I,3),I.status=T);else{var J=n+(I.w_bits-8<<4)<<8;J|=(2<=I.strategy||I.level<2?0:I.level<6?1:I.level===6?2:3)<<6,I.strstart!==0&&(J|=32),J+=31-J%31,I.status=T,H(I,J),I.strstart!==0&&(H(I,g.adler>>>16),H(I,65535&g.adler)),g.adler=1}if(I.status===69)if(I.gzhead.extra){for(B=I.pending;I.gzindex<(65535&I.gzhead.extra.length)&&(I.pending!==I.pending_buf_size||(I.gzhead.hcrc&&I.pending>B&&(g.adler=s(g.adler,I.pending_buf,I.pending-B,B)),F(g),B=I.pending,I.pending!==I.pending_buf_size));)V(I,255&I.gzhead.extra[I.gzindex]),I.gzindex++;I.gzhead.hcrc&&I.pending>B&&(g.adler=s(g.adler,I.pending_buf,I.pending-B,B)),I.gzindex===I.gzhead.extra.length&&(I.gzindex=0,I.status=73)}else I.status=73;if(I.status===73)if(I.gzhead.name){B=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>B&&(g.adler=s(g.adler,I.pending_buf,I.pending-B,B)),F(g),B=I.pending,I.pending===I.pending_buf_size)){P=1;break}P=I.gzindex<I.gzhead.name.length?255&I.gzhead.name.charCodeAt(I.gzindex++):0,V(I,P)}while(P!==0);I.gzhead.hcrc&&I.pending>B&&(g.adler=s(g.adler,I.pending_buf,I.pending-B,B)),P===0&&(I.gzindex=0,I.status=91)}else I.status=91;if(I.status===91)if(I.gzhead.comment){B=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>B&&(g.adler=s(g.adler,I.pending_buf,I.pending-B,B)),F(g),B=I.pending,I.pending===I.pending_buf_size)){P=1;break}P=I.gzindex<I.gzhead.comment.length?255&I.gzhead.comment.charCodeAt(I.gzindex++):0,V(I,P)}while(P!==0);I.gzhead.hcrc&&I.pending>B&&(g.adler=s(g.adler,I.pending_buf,I.pending-B,B)),P===0&&(I.status=103)}else I.status=103;if(I.status===103&&(I.gzhead.hcrc?(I.pending+2>I.pending_buf_size&&F(g),I.pending+2<=I.pending_buf_size&&(V(I,255&g.adler),V(I,g.adler>>8&255),g.adler=0,I.status=T)):I.status=T),I.pending!==0){if(F(g),g.avail_out===0)return I.last_flush=-1,r}else if(g.avail_in===0&&K(Q)<=K(Z)&&Q!==i)return oe(g,-5);if(I.status===666&&g.avail_in!==0)return oe(g,-5);if(g.avail_in!==0||I.lookahead!==0||Q!==x&&I.status!==666){var te=I.strategy===2?function($,ae){for(var le;;){if($.lookahead===0&&(ue($),$.lookahead===0)){if(ae===x)return p;break}if($.match_length=0,le=l._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++,le&&(S($,!1),$.strm.avail_out===0))return p}return $.insert=0,ae===i?(S($,!0),$.strm.avail_out===0?X:Y):$.last_lit&&(S($,!1),$.strm.avail_out===0)?p:W}(I,Q):I.strategy===3?function($,ae){for(var le,ne,xe,we,be=$.window;;){if($.lookahead<=C){if(ue($),$.lookahead<=C&&ae===x)return p;if($.lookahead===0)break}if($.match_length=0,$.lookahead>=E&&0<$.strstart&&(ne=be[xe=$.strstart-1])===be[++xe]&&ne===be[++xe]&&ne===be[++xe]){we=$.strstart+C;do;while(ne===be[++xe]&&ne===be[++xe]&&ne===be[++xe]&&ne===be[++xe]&&ne===be[++xe]&&ne===be[++xe]&&ne===be[++xe]&&ne===be[++xe]&&xe<we);$.match_length=C-(we-xe),$.match_length>$.lookahead&&($.match_length=$.lookahead)}if($.match_length>=E?(le=l._tr_tally($,1,$.match_length-E),$.lookahead-=$.match_length,$.strstart+=$.match_length,$.match_length=0):(le=l._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++),le&&(S($,!1),$.strm.avail_out===0))return p}return $.insert=0,ae===i?(S($,!0),$.strm.avail_out===0?X:Y):$.last_lit&&(S($,!1),$.strm.avail_out===0)?p:W}(I,Q):m[I.level].func(I,Q);if(te!==X&&te!==Y||(I.status=666),te===p||te===X)return g.avail_out===0&&(I.last_flush=-1),r;if(te===W&&(Q===1?l._tr_align(I):Q!==5&&(l._tr_stored_block(I,0,0,!1),Q===3&&(ie(I.head),I.lookahead===0&&(I.strstart=0,I.block_start=0,I.insert=0))),F(g),g.avail_out===0))return I.last_flush=-1,r}return Q!==i?r:I.wrap<=0?1:(I.wrap===2?(V(I,255&g.adler),V(I,g.adler>>8&255),V(I,g.adler>>16&255),V(I,g.adler>>24&255),V(I,255&g.total_in),V(I,g.total_in>>8&255),V(I,g.total_in>>16&255),V(I,g.total_in>>24&255)):(H(I,g.adler>>>16),H(I,65535&g.adler)),F(g),0<I.wrap&&(I.wrap=-I.wrap),I.pending!==0?r:1)},_.deflateEnd=function(g){var Q;return g&&g.state?(Q=g.state.status)!==N&&Q!==69&&Q!==73&&Q!==91&&Q!==103&&Q!==T&&Q!==666?oe(g,a):(g.state=null,Q===T?oe(g,-3):r):a},_.deflateSetDictionary=function(g,Q){var Z,I,B,P,J,te,$,ae,le=Q.length;if(!g||!g.state||(P=(Z=g.state).wrap)===2||P===1&&Z.status!==N||Z.lookahead)return a;for(P===1&&(g.adler=u(g.adler,Q,le,0)),Z.wrap=0,le>=Z.w_size&&(P===0&&(ie(Z.head),Z.strstart=0,Z.block_start=0,Z.insert=0),ae=new b.Buf8(Z.w_size),b.arraySet(ae,Q,le-Z.w_size,Z.w_size,0),Q=ae,le=Z.w_size),J=g.avail_in,te=g.next_in,$=g.input,g.avail_in=le,g.next_in=0,g.input=Q,ue(Z);Z.lookahead>=E;){for(I=Z.strstart,B=Z.lookahead-(E-1);Z.ins_h=(Z.ins_h<<Z.hash_shift^Z.window[I+E-1])&Z.hash_mask,Z.prev[I&Z.w_mask]=Z.head[Z.ins_h],Z.head[Z.ins_h]=I,I++,--B;);Z.strstart=I,Z.lookahead=E-1,ue(Z)}return Z.strstart+=Z.lookahead,Z.block_start=Z.strstart,Z.insert=Z.lookahead,Z.lookahead=0,Z.match_length=Z.prev_length=E-1,Z.match_available=0,g.next_in=te,g.input=$,g.avail_in=J,Z.wrap=P,r},_.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(v,w,_){w.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(v,w,_){w.exports=function(m,b){var l,u,s,d,x,i,r,a,t,o,c,n,h,y,j,A,D,z,E,C,L,N,T,p,W;l=m.state,u=m.next_in,p=m.input,s=u+(m.avail_in-5),d=m.next_out,W=m.output,x=d-(b-m.avail_out),i=d+(m.avail_out-257),r=l.dmax,a=l.wsize,t=l.whave,o=l.wnext,c=l.window,n=l.hold,h=l.bits,y=l.lencode,j=l.distcode,A=(1<<l.lenbits)-1,D=(1<<l.distbits)-1;e:do{h<15&&(n+=p[u++]<<h,h+=8,n+=p[u++]<<h,h+=8),z=y[n&A];t:for(;;){if(n>>>=E=z>>>24,h-=E,(E=z>>>16&255)===0)W[d++]=65535&z;else{if(!(16&E)){if(!(64&E)){z=y[(65535&z)+(n&(1<<E)-1)];continue t}if(32&E){l.mode=12;break e}m.msg="invalid literal/length code",l.mode=30;break e}C=65535&z,(E&=15)&&(h<E&&(n+=p[u++]<<h,h+=8),C+=n&(1<<E)-1,n>>>=E,h-=E),h<15&&(n+=p[u++]<<h,h+=8,n+=p[u++]<<h,h+=8),z=j[n&D];r:for(;;){if(n>>>=E=z>>>24,h-=E,!(16&(E=z>>>16&255))){if(!(64&E)){z=j[(65535&z)+(n&(1<<E)-1)];continue r}m.msg="invalid distance code",l.mode=30;break e}if(L=65535&z,h<(E&=15)&&(n+=p[u++]<<h,(h+=8)<E&&(n+=p[u++]<<h,h+=8)),r<(L+=n&(1<<E)-1)){m.msg="invalid distance too far back",l.mode=30;break e}if(n>>>=E,h-=E,(E=d-x)<L){if(t<(E=L-E)&&l.sane){m.msg="invalid distance too far back",l.mode=30;break e}if(T=c,(N=0)===o){if(N+=a-E,E<C){for(C-=E;W[d++]=c[N++],--E;);N=d-L,T=W}}else if(o<E){if(N+=a+o-E,(E-=o)<C){for(C-=E;W[d++]=c[N++],--E;);if(N=0,o<C){for(C-=E=o;W[d++]=c[N++],--E;);N=d-L,T=W}}}else if(N+=o-E,E<C){for(C-=E;W[d++]=c[N++],--E;);N=d-L,T=W}for(;2<C;)W[d++]=T[N++],W[d++]=T[N++],W[d++]=T[N++],C-=3;C&&(W[d++]=T[N++],1<C&&(W[d++]=T[N++]))}else{for(N=d-L;W[d++]=W[N++],W[d++]=W[N++],W[d++]=W[N++],2<(C-=3););C&&(W[d++]=W[N++],1<C&&(W[d++]=W[N++]))}break}}break}}while(u<s&&d<i);u-=C=h>>3,n&=(1<<(h-=C<<3))-1,m.next_in=u,m.next_out=d,m.avail_in=u<s?s-u+5:5-(u-s),m.avail_out=d<i?i-d+257:257-(d-i),l.hold=n,l.bits=h}},{}],49:[function(v,w,_){var m=v("../utils/common"),b=v("./adler32"),l=v("./crc32"),u=v("./inffast"),s=v("./inftrees"),d=1,x=2,i=0,r=-2,a=1,t=852,o=592;function c(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function n(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new m.Buf16(320),this.work=new m.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(N){var T;return N&&N.state?(T=N.state,N.total_in=N.total_out=T.total=0,N.msg="",T.wrap&&(N.adler=1&T.wrap),T.mode=a,T.last=0,T.havedict=0,T.dmax=32768,T.head=null,T.hold=0,T.bits=0,T.lencode=T.lendyn=new m.Buf32(t),T.distcode=T.distdyn=new m.Buf32(o),T.sane=1,T.back=-1,i):r}function y(N){var T;return N&&N.state?((T=N.state).wsize=0,T.whave=0,T.wnext=0,h(N)):r}function j(N,T){var p,W;return N&&N.state?(W=N.state,T<0?(p=0,T=-T):(p=1+(T>>4),T<48&&(T&=15)),T&&(T<8||15<T)?r:(W.window!==null&&W.wbits!==T&&(W.window=null),W.wrap=p,W.wbits=T,y(N))):r}function A(N,T){var p,W;return N?(W=new n,(N.state=W).window=null,(p=j(N,T))!==i&&(N.state=null),p):r}var D,z,E=!0;function C(N){if(E){var T;for(D=new m.Buf32(512),z=new m.Buf32(32),T=0;T<144;)N.lens[T++]=8;for(;T<256;)N.lens[T++]=9;for(;T<280;)N.lens[T++]=7;for(;T<288;)N.lens[T++]=8;for(s(d,N.lens,0,288,D,0,N.work,{bits:9}),T=0;T<32;)N.lens[T++]=5;s(x,N.lens,0,32,z,0,N.work,{bits:5}),E=!1}N.lencode=D,N.lenbits=9,N.distcode=z,N.distbits=5}function L(N,T,p,W){var X,Y=N.state;return Y.window===null&&(Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new m.Buf8(Y.wsize)),W>=Y.wsize?(m.arraySet(Y.window,T,p-Y.wsize,Y.wsize,0),Y.wnext=0,Y.whave=Y.wsize):(W<(X=Y.wsize-Y.wnext)&&(X=W),m.arraySet(Y.window,T,p-W,X,Y.wnext),(W-=X)?(m.arraySet(Y.window,T,p-W,W,0),Y.wnext=W,Y.whave=Y.wsize):(Y.wnext+=X,Y.wnext===Y.wsize&&(Y.wnext=0),Y.whave<Y.wsize&&(Y.whave+=X))),0}_.inflateReset=y,_.inflateReset2=j,_.inflateResetKeep=h,_.inflateInit=function(N){return A(N,15)},_.inflateInit2=A,_.inflate=function(N,T){var p,W,X,Y,oe,K,ie,F,S,V,H,ee,ue,ge,q,ce,ve,pe,Ee,Ne,g,Q,Z,I,B=0,P=new m.Buf8(4),J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&N.avail_in!==0)return r;(p=N.state).mode===12&&(p.mode=13),oe=N.next_out,X=N.output,ie=N.avail_out,Y=N.next_in,W=N.input,K=N.avail_in,F=p.hold,S=p.bits,V=K,H=ie,Q=i;e:for(;;)switch(p.mode){case a:if(p.wrap===0){p.mode=13;break}for(;S<16;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}if(2&p.wrap&&F===35615){P[p.check=0]=255&F,P[1]=F>>>8&255,p.check=l(p.check,P,2,0),S=F=0,p.mode=2;break}if(p.flags=0,p.head&&(p.head.done=!1),!(1&p.wrap)||(((255&F)<<8)+(F>>8))%31){N.msg="incorrect header check",p.mode=30;break}if((15&F)!=8){N.msg="unknown compression method",p.mode=30;break}if(S-=4,g=8+(15&(F>>>=4)),p.wbits===0)p.wbits=g;else if(g>p.wbits){N.msg="invalid window size",p.mode=30;break}p.dmax=1<<g,N.adler=p.check=1,p.mode=512&F?10:12,S=F=0;break;case 2:for(;S<16;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}if(p.flags=F,(255&p.flags)!=8){N.msg="unknown compression method",p.mode=30;break}if(57344&p.flags){N.msg="unknown header flags set",p.mode=30;break}p.head&&(p.head.text=F>>8&1),512&p.flags&&(P[0]=255&F,P[1]=F>>>8&255,p.check=l(p.check,P,2,0)),S=F=0,p.mode=3;case 3:for(;S<32;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}p.head&&(p.head.time=F),512&p.flags&&(P[0]=255&F,P[1]=F>>>8&255,P[2]=F>>>16&255,P[3]=F>>>24&255,p.check=l(p.check,P,4,0)),S=F=0,p.mode=4;case 4:for(;S<16;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}p.head&&(p.head.xflags=255&F,p.head.os=F>>8),512&p.flags&&(P[0]=255&F,P[1]=F>>>8&255,p.check=l(p.check,P,2,0)),S=F=0,p.mode=5;case 5:if(1024&p.flags){for(;S<16;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}p.length=F,p.head&&(p.head.extra_len=F),512&p.flags&&(P[0]=255&F,P[1]=F>>>8&255,p.check=l(p.check,P,2,0)),S=F=0}else p.head&&(p.head.extra=null);p.mode=6;case 6:if(1024&p.flags&&(K<(ee=p.length)&&(ee=K),ee&&(p.head&&(g=p.head.extra_len-p.length,p.head.extra||(p.head.extra=new Array(p.head.extra_len)),m.arraySet(p.head.extra,W,Y,ee,g)),512&p.flags&&(p.check=l(p.check,W,ee,Y)),K-=ee,Y+=ee,p.length-=ee),p.length))break e;p.length=0,p.mode=7;case 7:if(2048&p.flags){if(K===0)break e;for(ee=0;g=W[Y+ee++],p.head&&g&&p.length<65536&&(p.head.name+=String.fromCharCode(g)),g&&ee<K;);if(512&p.flags&&(p.check=l(p.check,W,ee,Y)),K-=ee,Y+=ee,g)break e}else p.head&&(p.head.name=null);p.length=0,p.mode=8;case 8:if(4096&p.flags){if(K===0)break e;for(ee=0;g=W[Y+ee++],p.head&&g&&p.length<65536&&(p.head.comment+=String.fromCharCode(g)),g&&ee<K;);if(512&p.flags&&(p.check=l(p.check,W,ee,Y)),K-=ee,Y+=ee,g)break e}else p.head&&(p.head.comment=null);p.mode=9;case 9:if(512&p.flags){for(;S<16;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}if(F!==(65535&p.check)){N.msg="header crc mismatch",p.mode=30;break}S=F=0}p.head&&(p.head.hcrc=p.flags>>9&1,p.head.done=!0),N.adler=p.check=0,p.mode=12;break;case 10:for(;S<32;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}N.adler=p.check=c(F),S=F=0,p.mode=11;case 11:if(p.havedict===0)return N.next_out=oe,N.avail_out=ie,N.next_in=Y,N.avail_in=K,p.hold=F,p.bits=S,2;N.adler=p.check=1,p.mode=12;case 12:if(T===5||T===6)break e;case 13:if(p.last){F>>>=7&S,S-=7&S,p.mode=27;break}for(;S<3;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}switch(p.last=1&F,S-=1,3&(F>>>=1)){case 0:p.mode=14;break;case 1:if(C(p),p.mode=20,T!==6)break;F>>>=2,S-=2;break e;case 2:p.mode=17;break;case 3:N.msg="invalid block type",p.mode=30}F>>>=2,S-=2;break;case 14:for(F>>>=7&S,S-=7&S;S<32;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}if((65535&F)!=(F>>>16^65535)){N.msg="invalid stored block lengths",p.mode=30;break}if(p.length=65535&F,S=F=0,p.mode=15,T===6)break e;case 15:p.mode=16;case 16:if(ee=p.length){if(K<ee&&(ee=K),ie<ee&&(ee=ie),ee===0)break e;m.arraySet(X,W,Y,ee,oe),K-=ee,Y+=ee,ie-=ee,oe+=ee,p.length-=ee;break}p.mode=12;break;case 17:for(;S<14;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}if(p.nlen=257+(31&F),F>>>=5,S-=5,p.ndist=1+(31&F),F>>>=5,S-=5,p.ncode=4+(15&F),F>>>=4,S-=4,286<p.nlen||30<p.ndist){N.msg="too many length or distance symbols",p.mode=30;break}p.have=0,p.mode=18;case 18:for(;p.have<p.ncode;){for(;S<3;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}p.lens[J[p.have++]]=7&F,F>>>=3,S-=3}for(;p.have<19;)p.lens[J[p.have++]]=0;if(p.lencode=p.lendyn,p.lenbits=7,Z={bits:p.lenbits},Q=s(0,p.lens,0,19,p.lencode,0,p.work,Z),p.lenbits=Z.bits,Q){N.msg="invalid code lengths set",p.mode=30;break}p.have=0,p.mode=19;case 19:for(;p.have<p.nlen+p.ndist;){for(;ce=(B=p.lencode[F&(1<<p.lenbits)-1])>>>16&255,ve=65535&B,!((q=B>>>24)<=S);){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}if(ve<16)F>>>=q,S-=q,p.lens[p.have++]=ve;else{if(ve===16){for(I=q+2;S<I;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}if(F>>>=q,S-=q,p.have===0){N.msg="invalid bit length repeat",p.mode=30;break}g=p.lens[p.have-1],ee=3+(3&F),F>>>=2,S-=2}else if(ve===17){for(I=q+3;S<I;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}S-=q,g=0,ee=3+(7&(F>>>=q)),F>>>=3,S-=3}else{for(I=q+7;S<I;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}S-=q,g=0,ee=11+(127&(F>>>=q)),F>>>=7,S-=7}if(p.have+ee>p.nlen+p.ndist){N.msg="invalid bit length repeat",p.mode=30;break}for(;ee--;)p.lens[p.have++]=g}}if(p.mode===30)break;if(p.lens[256]===0){N.msg="invalid code -- missing end-of-block",p.mode=30;break}if(p.lenbits=9,Z={bits:p.lenbits},Q=s(d,p.lens,0,p.nlen,p.lencode,0,p.work,Z),p.lenbits=Z.bits,Q){N.msg="invalid literal/lengths set",p.mode=30;break}if(p.distbits=6,p.distcode=p.distdyn,Z={bits:p.distbits},Q=s(x,p.lens,p.nlen,p.ndist,p.distcode,0,p.work,Z),p.distbits=Z.bits,Q){N.msg="invalid distances set",p.mode=30;break}if(p.mode=20,T===6)break e;case 20:p.mode=21;case 21:if(6<=K&&258<=ie){N.next_out=oe,N.avail_out=ie,N.next_in=Y,N.avail_in=K,p.hold=F,p.bits=S,u(N,H),oe=N.next_out,X=N.output,ie=N.avail_out,Y=N.next_in,W=N.input,K=N.avail_in,F=p.hold,S=p.bits,p.mode===12&&(p.back=-1);break}for(p.back=0;ce=(B=p.lencode[F&(1<<p.lenbits)-1])>>>16&255,ve=65535&B,!((q=B>>>24)<=S);){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}if(ce&&!(240&ce)){for(pe=q,Ee=ce,Ne=ve;ce=(B=p.lencode[Ne+((F&(1<<pe+Ee)-1)>>pe)])>>>16&255,ve=65535&B,!(pe+(q=B>>>24)<=S);){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}F>>>=pe,S-=pe,p.back+=pe}if(F>>>=q,S-=q,p.back+=q,p.length=ve,ce===0){p.mode=26;break}if(32&ce){p.back=-1,p.mode=12;break}if(64&ce){N.msg="invalid literal/length code",p.mode=30;break}p.extra=15&ce,p.mode=22;case 22:if(p.extra){for(I=p.extra;S<I;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}p.length+=F&(1<<p.extra)-1,F>>>=p.extra,S-=p.extra,p.back+=p.extra}p.was=p.length,p.mode=23;case 23:for(;ce=(B=p.distcode[F&(1<<p.distbits)-1])>>>16&255,ve=65535&B,!((q=B>>>24)<=S);){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}if(!(240&ce)){for(pe=q,Ee=ce,Ne=ve;ce=(B=p.distcode[Ne+((F&(1<<pe+Ee)-1)>>pe)])>>>16&255,ve=65535&B,!(pe+(q=B>>>24)<=S);){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}F>>>=pe,S-=pe,p.back+=pe}if(F>>>=q,S-=q,p.back+=q,64&ce){N.msg="invalid distance code",p.mode=30;break}p.offset=ve,p.extra=15&ce,p.mode=24;case 24:if(p.extra){for(I=p.extra;S<I;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}p.offset+=F&(1<<p.extra)-1,F>>>=p.extra,S-=p.extra,p.back+=p.extra}if(p.offset>p.dmax){N.msg="invalid distance too far back",p.mode=30;break}p.mode=25;case 25:if(ie===0)break e;if(ee=H-ie,p.offset>ee){if((ee=p.offset-ee)>p.whave&&p.sane){N.msg="invalid distance too far back",p.mode=30;break}ue=ee>p.wnext?(ee-=p.wnext,p.wsize-ee):p.wnext-ee,ee>p.length&&(ee=p.length),ge=p.window}else ge=X,ue=oe-p.offset,ee=p.length;for(ie<ee&&(ee=ie),ie-=ee,p.length-=ee;X[oe++]=ge[ue++],--ee;);p.length===0&&(p.mode=21);break;case 26:if(ie===0)break e;X[oe++]=p.length,ie--,p.mode=21;break;case 27:if(p.wrap){for(;S<32;){if(K===0)break e;K--,F|=W[Y++]<<S,S+=8}if(H-=ie,N.total_out+=H,p.total+=H,H&&(N.adler=p.check=p.flags?l(p.check,X,H,oe-H):b(p.check,X,H,oe-H)),H=ie,(p.flags?F:c(F))!==p.check){N.msg="incorrect data check",p.mode=30;break}S=F=0}p.mode=28;case 28:if(p.wrap&&p.flags){for(;S<32;){if(K===0)break e;K--,F+=W[Y++]<<S,S+=8}if(F!==(4294967295&p.total)){N.msg="incorrect length check",p.mode=30;break}S=F=0}p.mode=29;case 29:Q=1;break e;case 30:Q=-3;break e;case 31:return-4;case 32:default:return r}return N.next_out=oe,N.avail_out=ie,N.next_in=Y,N.avail_in=K,p.hold=F,p.bits=S,(p.wsize||H!==N.avail_out&&p.mode<30&&(p.mode<27||T!==4))&&L(N,N.output,N.next_out,H-N.avail_out)?(p.mode=31,-4):(V-=N.avail_in,H-=N.avail_out,N.total_in+=V,N.total_out+=H,p.total+=H,p.wrap&&H&&(N.adler=p.check=p.flags?l(p.check,X,H,N.next_out-H):b(p.check,X,H,N.next_out-H)),N.data_type=p.bits+(p.last?64:0)+(p.mode===12?128:0)+(p.mode===20||p.mode===15?256:0),(V==0&&H===0||T===4)&&Q===i&&(Q=-5),Q)},_.inflateEnd=function(N){if(!N||!N.state)return r;var T=N.state;return T.window&&(T.window=null),N.state=null,i},_.inflateGetHeader=function(N,T){var p;return N&&N.state&&2&(p=N.state).wrap?((p.head=T).done=!1,i):r},_.inflateSetDictionary=function(N,T){var p,W=T.length;return N&&N.state?(p=N.state).wrap!==0&&p.mode!==11?r:p.mode===11&&b(1,T,W,0)!==p.check?-3:L(N,T,W,W)?(p.mode=31,-4):(p.havedict=1,i):r},_.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(v,w,_){var m=v("../utils/common"),b=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];w.exports=function(d,x,i,r,a,t,o,c){var n,h,y,j,A,D,z,E,C,L=c.bits,N=0,T=0,p=0,W=0,X=0,Y=0,oe=0,K=0,ie=0,F=0,S=null,V=0,H=new m.Buf16(16),ee=new m.Buf16(16),ue=null,ge=0;for(N=0;N<=15;N++)H[N]=0;for(T=0;T<r;T++)H[x[i+T]]++;for(X=L,W=15;1<=W&&H[W]===0;W--);if(W<X&&(X=W),W===0)return a[t++]=20971520,a[t++]=20971520,c.bits=1,0;for(p=1;p<W&&H[p]===0;p++);for(X<p&&(X=p),N=K=1;N<=15;N++)if(K<<=1,(K-=H[N])<0)return-1;if(0<K&&(d===0||W!==1))return-1;for(ee[1]=0,N=1;N<15;N++)ee[N+1]=ee[N]+H[N];for(T=0;T<r;T++)x[i+T]!==0&&(o[ee[x[i+T]]++]=T);if(D=d===0?(S=ue=o,19):d===1?(S=b,V-=257,ue=l,ge-=257,256):(S=u,ue=s,-1),N=p,A=t,oe=T=F=0,y=-1,j=(ie=1<<(Y=X))-1,d===1&&852<ie||d===2&&592<ie)return 1;for(;;){for(z=N-oe,C=o[T]<D?(E=0,o[T]):o[T]>D?(E=ue[ge+o[T]],S[V+o[T]]):(E=96,0),n=1<<N-oe,p=h=1<<Y;a[A+(F>>oe)+(h-=n)]=z<<24|E<<16|C|0,h!==0;);for(n=1<<N-1;F&n;)n>>=1;if(n!==0?(F&=n-1,F+=n):F=0,T++,--H[N]==0){if(N===W)break;N=x[i+o[T]]}if(X<N&&(F&j)!==y){for(oe===0&&(oe=X),A+=p,K=1<<(Y=N-oe);Y+oe<W&&!((K-=H[Y+oe])<=0);)Y++,K<<=1;if(ie+=1<<Y,d===1&&852<ie||d===2&&592<ie)return 1;a[y=F&j]=X<<24|Y<<16|A-t|0}}return F!==0&&(a[A+F]=N-oe<<24|64<<16|0),c.bits=X,0}},{"../utils/common":41}],51:[function(v,w,_){w.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(v,w,_){var m=v("../utils/common"),b=0,l=1;function u(B){for(var P=B.length;0<=--P;)B[P]=0}var s=0,d=29,x=256,i=x+1+d,r=30,a=19,t=2*i+1,o=15,c=16,n=7,h=256,y=16,j=17,A=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=new Array(2*(i+2));u(L);var N=new Array(2*r);u(N);var T=new Array(512);u(T);var p=new Array(256);u(p);var W=new Array(d);u(W);var X,Y,oe,K=new Array(r);function ie(B,P,J,te,$){this.static_tree=B,this.extra_bits=P,this.extra_base=J,this.elems=te,this.max_length=$,this.has_stree=B&&B.length}function F(B,P){this.dyn_tree=B,this.max_code=0,this.stat_desc=P}function S(B){return B<256?T[B]:T[256+(B>>>7)]}function V(B,P){B.pending_buf[B.pending++]=255&P,B.pending_buf[B.pending++]=P>>>8&255}function H(B,P,J){B.bi_valid>c-J?(B.bi_buf|=P<<B.bi_valid&65535,V(B,B.bi_buf),B.bi_buf=P>>c-B.bi_valid,B.bi_valid+=J-c):(B.bi_buf|=P<<B.bi_valid&65535,B.bi_valid+=J)}function ee(B,P,J){H(B,J[2*P],J[2*P+1])}function ue(B,P){for(var J=0;J|=1&B,B>>>=1,J<<=1,0<--P;);return J>>>1}function ge(B,P,J){var te,$,ae=new Array(o+1),le=0;for(te=1;te<=o;te++)ae[te]=le=le+J[te-1]<<1;for($=0;$<=P;$++){var ne=B[2*$+1];ne!==0&&(B[2*$]=ue(ae[ne]++,ne))}}function q(B){var P;for(P=0;P<i;P++)B.dyn_ltree[2*P]=0;for(P=0;P<r;P++)B.dyn_dtree[2*P]=0;for(P=0;P<a;P++)B.bl_tree[2*P]=0;B.dyn_ltree[2*h]=1,B.opt_len=B.static_len=0,B.last_lit=B.matches=0}function ce(B){8<B.bi_valid?V(B,B.bi_buf):0<B.bi_valid&&(B.pending_buf[B.pending++]=B.bi_buf),B.bi_buf=0,B.bi_valid=0}function ve(B,P,J,te){var $=2*P,ae=2*J;return B[$]<B[ae]||B[$]===B[ae]&&te[P]<=te[J]}function pe(B,P,J){for(var te=B.heap[J],$=J<<1;$<=B.heap_len&&($<B.heap_len&&ve(P,B.heap[$+1],B.heap[$],B.depth)&&$++,!ve(P,te,B.heap[$],B.depth));)B.heap[J]=B.heap[$],J=$,$<<=1;B.heap[J]=te}function Ee(B,P,J){var te,$,ae,le,ne=0;if(B.last_lit!==0)for(;te=B.pending_buf[B.d_buf+2*ne]<<8|B.pending_buf[B.d_buf+2*ne+1],$=B.pending_buf[B.l_buf+ne],ne++,te===0?ee(B,$,P):(ee(B,(ae=p[$])+x+1,P),(le=D[ae])!==0&&H(B,$-=W[ae],le),ee(B,ae=S(--te),J),(le=z[ae])!==0&&H(B,te-=K[ae],le)),ne<B.last_lit;);ee(B,h,P)}function Ne(B,P){var J,te,$,ae=P.dyn_tree,le=P.stat_desc.static_tree,ne=P.stat_desc.has_stree,xe=P.stat_desc.elems,we=-1;for(B.heap_len=0,B.heap_max=t,J=0;J<xe;J++)ae[2*J]!==0?(B.heap[++B.heap_len]=we=J,B.depth[J]=0):ae[2*J+1]=0;for(;B.heap_len<2;)ae[2*($=B.heap[++B.heap_len]=we<2?++we:0)]=1,B.depth[$]=0,B.opt_len--,ne&&(B.static_len-=le[2*$+1]);for(P.max_code=we,J=B.heap_len>>1;1<=J;J--)pe(B,ae,J);for($=xe;J=B.heap[1],B.heap[1]=B.heap[B.heap_len--],pe(B,ae,1),te=B.heap[1],B.heap[--B.heap_max]=J,B.heap[--B.heap_max]=te,ae[2*$]=ae[2*J]+ae[2*te],B.depth[$]=(B.depth[J]>=B.depth[te]?B.depth[J]:B.depth[te])+1,ae[2*J+1]=ae[2*te+1]=$,B.heap[1]=$++,pe(B,ae,1),2<=B.heap_len;);B.heap[--B.heap_max]=B.heap[1],function(be,Ue){var ot,Ie,Me,Ce,We,lt,Ze=Ue.dyn_tree,Gt=Ue.max_code,Kt=Ue.stat_desc.static_tree,mr=Ue.stat_desc.has_stree,Xt=Ue.stat_desc.extra_bits,Qt=Ue.stat_desc.extra_base,ct=Ue.stat_desc.max_length,vt=0;for(Ce=0;Ce<=o;Ce++)be.bl_count[Ce]=0;for(Ze[2*be.heap[be.heap_max]+1]=0,ot=be.heap_max+1;ot<t;ot++)ct<(Ce=Ze[2*Ze[2*(Ie=be.heap[ot])+1]+1]+1)&&(Ce=ct,vt++),Ze[2*Ie+1]=Ce,Gt<Ie||(be.bl_count[Ce]++,We=0,Qt<=Ie&&(We=Xt[Ie-Qt]),lt=Ze[2*Ie],be.opt_len+=lt*(Ce+We),mr&&(be.static_len+=lt*(Kt[2*Ie+1]+We)));if(vt!==0){do{for(Ce=ct-1;be.bl_count[Ce]===0;)Ce--;be.bl_count[Ce]--,be.bl_count[Ce+1]+=2,be.bl_count[ct]--,vt-=2}while(0<vt);for(Ce=ct;Ce!==0;Ce--)for(Ie=be.bl_count[Ce];Ie!==0;)Gt<(Me=be.heap[--ot])||(Ze[2*Me+1]!==Ce&&(be.opt_len+=(Ce-Ze[2*Me+1])*Ze[2*Me],Ze[2*Me+1]=Ce),Ie--)}}(B,P),ge(ae,we,B.bl_count)}function g(B,P,J){var te,$,ae=-1,le=P[1],ne=0,xe=7,we=4;for(le===0&&(xe=138,we=3),P[2*(J+1)+1]=65535,te=0;te<=J;te++)$=le,le=P[2*(te+1)+1],++ne<xe&&$===le||(ne<we?B.bl_tree[2*$]+=ne:$!==0?($!==ae&&B.bl_tree[2*$]++,B.bl_tree[2*y]++):ne<=10?B.bl_tree[2*j]++:B.bl_tree[2*A]++,ae=$,we=(ne=0)===le?(xe=138,3):$===le?(xe=6,3):(xe=7,4))}function Q(B,P,J){var te,$,ae=-1,le=P[1],ne=0,xe=7,we=4;for(le===0&&(xe=138,we=3),te=0;te<=J;te++)if($=le,le=P[2*(te+1)+1],!(++ne<xe&&$===le)){if(ne<we)for(;ee(B,$,B.bl_tree),--ne!=0;);else $!==0?($!==ae&&(ee(B,$,B.bl_tree),ne--),ee(B,y,B.bl_tree),H(B,ne-3,2)):ne<=10?(ee(B,j,B.bl_tree),H(B,ne-3,3)):(ee(B,A,B.bl_tree),H(B,ne-11,7));ae=$,we=(ne=0)===le?(xe=138,3):$===le?(xe=6,3):(xe=7,4)}}u(K);var Z=!1;function I(B,P,J,te){H(B,(s<<1)+(te?1:0),3),function($,ae,le,ne){ce($),V($,le),V($,~le),m.arraySet($.pending_buf,$.window,ae,le,$.pending),$.pending+=le}(B,P,J)}_._tr_init=function(B){Z||(function(){var P,J,te,$,ae,le=new Array(o+1);for($=te=0;$<d-1;$++)for(W[$]=te,P=0;P<1<<D[$];P++)p[te++]=$;for(p[te-1]=$,$=ae=0;$<16;$++)for(K[$]=ae,P=0;P<1<<z[$];P++)T[ae++]=$;for(ae>>=7;$<r;$++)for(K[$]=ae<<7,P=0;P<1<<z[$]-7;P++)T[256+ae++]=$;for(J=0;J<=o;J++)le[J]=0;for(P=0;P<=143;)L[2*P+1]=8,P++,le[8]++;for(;P<=255;)L[2*P+1]=9,P++,le[9]++;for(;P<=279;)L[2*P+1]=7,P++,le[7]++;for(;P<=287;)L[2*P+1]=8,P++,le[8]++;for(ge(L,i+1,le),P=0;P<r;P++)N[2*P+1]=5,N[2*P]=ue(P,5);X=new ie(L,D,x+1,i,o),Y=new ie(N,z,0,r,o),oe=new ie(new Array(0),E,0,a,n)}(),Z=!0),B.l_desc=new F(B.dyn_ltree,X),B.d_desc=new F(B.dyn_dtree,Y),B.bl_desc=new F(B.bl_tree,oe),B.bi_buf=0,B.bi_valid=0,q(B)},_._tr_stored_block=I,_._tr_flush_block=function(B,P,J,te){var $,ae,le=0;0<B.level?(B.strm.data_type===2&&(B.strm.data_type=function(ne){var xe,we=4093624447;for(xe=0;xe<=31;xe++,we>>>=1)if(1&we&&ne.dyn_ltree[2*xe]!==0)return b;if(ne.dyn_ltree[18]!==0||ne.dyn_ltree[20]!==0||ne.dyn_ltree[26]!==0)return l;for(xe=32;xe<x;xe++)if(ne.dyn_ltree[2*xe]!==0)return l;return b}(B)),Ne(B,B.l_desc),Ne(B,B.d_desc),le=function(ne){var xe;for(g(ne,ne.dyn_ltree,ne.l_desc.max_code),g(ne,ne.dyn_dtree,ne.d_desc.max_code),Ne(ne,ne.bl_desc),xe=a-1;3<=xe&&ne.bl_tree[2*C[xe]+1]===0;xe--);return ne.opt_len+=3*(xe+1)+5+5+4,xe}(B),$=B.opt_len+3+7>>>3,(ae=B.static_len+3+7>>>3)<=$&&($=ae)):$=ae=J+5,J+4<=$&&P!==-1?I(B,P,J,te):B.strategy===4||ae===$?(H(B,2+(te?1:0),3),Ee(B,L,N)):(H(B,4+(te?1:0),3),function(ne,xe,we,be){var Ue;for(H(ne,xe-257,5),H(ne,we-1,5),H(ne,be-4,4),Ue=0;Ue<be;Ue++)H(ne,ne.bl_tree[2*C[Ue]+1],3);Q(ne,ne.dyn_ltree,xe-1),Q(ne,ne.dyn_dtree,we-1)}(B,B.l_desc.max_code+1,B.d_desc.max_code+1,le+1),Ee(B,B.dyn_ltree,B.dyn_dtree)),q(B),te&&ce(B)},_._tr_tally=function(B,P,J){return B.pending_buf[B.d_buf+2*B.last_lit]=P>>>8&255,B.pending_buf[B.d_buf+2*B.last_lit+1]=255&P,B.pending_buf[B.l_buf+B.last_lit]=255&J,B.last_lit++,P===0?B.dyn_ltree[2*J]++:(B.matches++,P--,B.dyn_ltree[2*(p[J]+x+1)]++,B.dyn_dtree[2*S(P)]++),B.last_lit===B.lit_bufsize-1},_._tr_align=function(B){H(B,2,3),ee(B,h,L),function(P){P.bi_valid===16?(V(P,P.bi_buf),P.bi_buf=0,P.bi_valid=0):8<=P.bi_valid&&(P.pending_buf[P.pending++]=255&P.bi_buf,P.bi_buf>>=8,P.bi_valid-=8)}(B)}},{"../utils/common":41}],53:[function(v,w,_){w.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(v,w,_){(function(m){(function(b,l){if(!b.setImmediate){var u,s,d,x,i=1,r={},a=!1,t=b.document,o=Object.getPrototypeOf&&Object.getPrototypeOf(b);o=o&&o.setTimeout?o:b,u={}.toString.call(b.process)==="[object process]"?function(y){process.nextTick(function(){n(y)})}:function(){if(b.postMessage&&!b.importScripts){var y=!0,j=b.onmessage;return b.onmessage=function(){y=!1},b.postMessage("","*"),b.onmessage=j,y}}()?(x="setImmediate$"+Math.random()+"$",b.addEventListener?b.addEventListener("message",h,!1):b.attachEvent("onmessage",h),function(y){b.postMessage(x+y,"*")}):b.MessageChannel?((d=new MessageChannel).port1.onmessage=function(y){n(y.data)},function(y){d.port2.postMessage(y)}):t&&"onreadystatechange"in t.createElement("script")?(s=t.documentElement,function(y){var j=t.createElement("script");j.onreadystatechange=function(){n(y),j.onreadystatechange=null,s.removeChild(j),j=null},s.appendChild(j)}):function(y){setTimeout(n,0,y)},o.setImmediate=function(y){typeof y!="function"&&(y=new Function(""+y));for(var j=new Array(arguments.length-1),A=0;A<j.length;A++)j[A]=arguments[A+1];var D={callback:y,args:j};return r[i]=D,u(i),i++},o.clearImmediate=c}function c(y){delete r[y]}function n(y){if(a)setTimeout(n,0,y);else{var j=r[y];if(j){a=!0;try{(function(A){var D=A.callback,z=A.args;switch(z.length){case 0:D();break;case 1:D(z[0]);break;case 2:D(z[0],z[1]);break;case 3:D(z[0],z[1],z[2]);break;default:D.apply(l,z)}})(j)}finally{c(y),a=!1}}}}function h(y){y.source===b&&typeof y.data=="string"&&y.data.indexOf(x)===0&&n(+y.data.slice(x.length))}})(typeof self>"u"?m===void 0?this:m:self)}).call(this,typeof fe<"u"?fe:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(ni);var bo=ni.exports;const ii=Kn(bo);var oi={exports:{}};(function(R,U){(function(v,w){w()})(fe,function(){function v(s,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function w(s,d,x){var i=new XMLHttpRequest;i.open("GET",s),i.responseType="blob",i.onload=function(){u(i.response,d,x)},i.onerror=function(){console.error("could not download file")},i.send()}function _(s){var d=new XMLHttpRequest;d.open("HEAD",s,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function m(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(d)}}var b=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof fe=="object"&&fe.global===fe?fe:void 0,l=b.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=b.saveAs||(typeof window!="object"||window!==b?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(s,d,x){var i=b.URL||b.webkitURL,r=document.createElement("a");d=d||s.name||"download",r.download=d,r.rel="noopener",typeof s=="string"?(r.href=s,r.origin===location.origin?m(r):_(r.href)?w(s,d,x):m(r,r.target="_blank")):(r.href=i.createObjectURL(s),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),setTimeout(function(){m(r)},0))}:"msSaveOrOpenBlob"in navigator?function(s,d,x){if(d=d||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(v(s,x),d);else if(_(s))w(s,d,x);else{var i=document.createElement("a");i.href=s,i.target="_blank",setTimeout(function(){m(i)})}}:function(s,d,x,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),typeof s=="string")return w(s,d,x);var r=s.type==="application/octet-stream",a=/constructor/i.test(b.HTMLElement)||b.safari,t=/CriOS\/[\d]+/.test(navigator.userAgent);if((t||r&&a||l)&&typeof FileReader<"u"){var o=new FileReader;o.onloadend=function(){var h=o.result;h=t?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=h:location=h,i=null},o.readAsDataURL(s)}else{var c=b.URL||b.webkitURL,n=c.createObjectURL(s);i?i.location=n:location.href=n,i=null,setTimeout(function(){c.revokeObjectURL(n)},4e4)}});b.saveAs=u.saveAs=u,R.exports=u})})(oi);var yo=oi.exports,li={exports:{}},ns={exports:{}};const wo={},_o=Object.freeze(Object.defineProperty({__proto__:null,default:wo},Symbol.toStringTag,{value:"Module"})),jo=s0(_o);var on;function ye(){return on||(on=1,function(R,U){(function(v,w){R.exports=w()})(fe,function(){var v=v||function(w,_){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),typeof self<"u"&&self.crypto&&(m=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(m=globalThis.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof fe<"u"&&fe.crypto&&(m=fe.crypto),!m&&typeof cr=="function")try{m=jo}catch{}var b=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},l=Object.create||function(){function n(){}return function(h){var y;return n.prototype=h,y=new n,n.prototype=null,y}}(),u={},s=u.lib={},d=s.Base=function(){return{extend:function(n){var h=l(this);return n&&h.mixIn(n),(!h.hasOwnProperty("init")||this.init===h.init)&&(h.init=function(){h.$super.init.apply(this,arguments)}),h.init.prototype=h,h.$super=this,h},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var h in n)n.hasOwnProperty(h)&&(this[h]=n[h]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),x=s.WordArray=d.extend({init:function(n,h){n=this.words=n||[],h!=_?this.sigBytes=h:this.sigBytes=n.length*4},toString:function(n){return(n||r).stringify(this)},concat:function(n){var h=this.words,y=n.words,j=this.sigBytes,A=n.sigBytes;if(this.clamp(),j%4)for(var D=0;D<A;D++){var z=y[D>>>2]>>>24-D%4*8&255;h[j+D>>>2]|=z<<24-(j+D)%4*8}else for(var E=0;E<A;E+=4)h[j+E>>>2]=y[E>>>2];return this.sigBytes+=A,this},clamp:function(){var n=this.words,h=this.sigBytes;n[h>>>2]&=4294967295<<32-h%4*8,n.length=w.ceil(h/4)},clone:function(){var n=d.clone.call(this);return n.words=this.words.slice(0),n},random:function(n){for(var h=[],y=0;y<n;y+=4)h.push(b());return new x.init(h,n)}}),i=u.enc={},r=i.Hex={stringify:function(n){for(var h=n.words,y=n.sigBytes,j=[],A=0;A<y;A++){var D=h[A>>>2]>>>24-A%4*8&255;j.push((D>>>4).toString(16)),j.push((D&15).toString(16))}return j.join("")},parse:function(n){for(var h=n.length,y=[],j=0;j<h;j+=2)y[j>>>3]|=parseInt(n.substr(j,2),16)<<24-j%8*4;return new x.init(y,h/2)}},a=i.Latin1={stringify:function(n){for(var h=n.words,y=n.sigBytes,j=[],A=0;A<y;A++){var D=h[A>>>2]>>>24-A%4*8&255;j.push(String.fromCharCode(D))}return j.join("")},parse:function(n){for(var h=n.length,y=[],j=0;j<h;j++)y[j>>>2]|=(n.charCodeAt(j)&255)<<24-j%4*8;return new x.init(y,h)}},t=i.Utf8={stringify:function(n){try{return decodeURIComponent(escape(a.stringify(n)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(n){return a.parse(unescape(encodeURIComponent(n)))}},o=s.BufferedBlockAlgorithm=d.extend({reset:function(){this._data=new x.init,this._nDataBytes=0},_append:function(n){typeof n=="string"&&(n=t.parse(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes},_process:function(n){var h,y=this._data,j=y.words,A=y.sigBytes,D=this.blockSize,z=D*4,E=A/z;n?E=w.ceil(E):E=w.max((E|0)-this._minBufferSize,0);var C=E*D,L=w.min(C*4,A);if(C){for(var N=0;N<C;N+=D)this._doProcessBlock(j,N);h=j.splice(0,C),y.sigBytes-=L}return new x.init(h,L)},clone:function(){var n=d.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0});s.Hasher=o.extend({cfg:d.extend(),init:function(n){this.cfg=this.cfg.extend(n),this.reset()},reset:function(){o.reset.call(this),this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){n&&this._append(n);var h=this._doFinalize();return h},blockSize:16,_createHelper:function(n){return function(h,y){return new n.init(y).finalize(h)}},_createHmacHelper:function(n){return function(h,y){return new c.HMAC.init(n,y).finalize(h)}}});var c=u.algo={};return u}(Math);return v})}(ns)),ns.exports}var is={exports:{}},ln;function Pr(){return ln||(ln=1,function(R,U){(function(v,w){R.exports=w(ye())})(fe,function(v){return function(w){var _=v,m=_.lib,b=m.Base,l=m.WordArray,u=_.x64={};u.Word=b.extend({init:function(s,d){this.high=s,this.low=d}}),u.WordArray=b.extend({init:function(s,d){s=this.words=s||[],d!=w?this.sigBytes=d:this.sigBytes=s.length*8},toX32:function(){for(var s=this.words,d=s.length,x=[],i=0;i<d;i++){var r=s[i];x.push(r.high),x.push(r.low)}return l.create(x,this.sigBytes)},clone:function(){for(var s=b.clone.call(this),d=s.words=this.words.slice(0),x=d.length,i=0;i<x;i++)d[i]=d[i].clone();return s}})}(),v})}(is)),is.exports}var os={exports:{}},cn;function No(){return cn||(cn=1,function(R,U){(function(v,w){R.exports=w(ye())})(fe,function(v){return function(){if(typeof ArrayBuffer=="function"){var w=v,_=w.lib,m=_.WordArray,b=m.init,l=m.init=function(u){if(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),(u instanceof Int8Array||typeof Uint8ClampedArray<"u"&&u instanceof Uint8ClampedArray||u instanceof Int16Array||u instanceof Uint16Array||u instanceof Int32Array||u instanceof Uint32Array||u instanceof Float32Array||u instanceof Float64Array)&&(u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength)),u instanceof Uint8Array){for(var s=u.byteLength,d=[],x=0;x<s;x++)d[x>>>2]|=u[x]<<24-x%4*8;b.call(this,d,s)}else b.apply(this,arguments)};l.prototype=m}}(),v.lib.WordArray})}(os)),os.exports}var ls={exports:{}},dn;function Co(){return dn||(dn=1,function(R,U){(function(v,w){R.exports=w(ye())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.WordArray,b=w.enc;b.Utf16=b.Utf16BE={stringify:function(u){for(var s=u.words,d=u.sigBytes,x=[],i=0;i<d;i+=2){var r=s[i>>>2]>>>16-i%4*8&65535;x.push(String.fromCharCode(r))}return x.join("")},parse:function(u){for(var s=u.length,d=[],x=0;x<s;x++)d[x>>>1]|=u.charCodeAt(x)<<16-x%2*16;return m.create(d,s*2)}},b.Utf16LE={stringify:function(u){for(var s=u.words,d=u.sigBytes,x=[],i=0;i<d;i+=2){var r=l(s[i>>>2]>>>16-i%4*8&65535);x.push(String.fromCharCode(r))}return x.join("")},parse:function(u){for(var s=u.length,d=[],x=0;x<s;x++)d[x>>>1]|=l(u.charCodeAt(x)<<16-x%2*16);return m.create(d,s*2)}};function l(u){return u<<8&4278255360|u>>>8&16711935}}(),v.enc.Utf16})}(ls)),ls.exports}var cs={exports:{}},xn;function Bt(){return xn||(xn=1,function(R,U){(function(v,w){R.exports=w(ye())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.WordArray,b=w.enc;b.Base64={stringify:function(u){var s=u.words,d=u.sigBytes,x=this._map;u.clamp();for(var i=[],r=0;r<d;r+=3)for(var a=s[r>>>2]>>>24-r%4*8&255,t=s[r+1>>>2]>>>24-(r+1)%4*8&255,o=s[r+2>>>2]>>>24-(r+2)%4*8&255,c=a<<16|t<<8|o,n=0;n<4&&r+n*.75<d;n++)i.push(x.charAt(c>>>6*(3-n)&63));var h=x.charAt(64);if(h)for(;i.length%4;)i.push(h);return i.join("")},parse:function(u){var s=u.length,d=this._map,x=this._reverseMap;if(!x){x=this._reverseMap=[];for(var i=0;i<d.length;i++)x[d.charCodeAt(i)]=i}var r=d.charAt(64);if(r){var a=u.indexOf(r);a!==-1&&(s=a)}return l(u,s,x)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function l(u,s,d){for(var x=[],i=0,r=0;r<s;r++)if(r%4){var a=d[u.charCodeAt(r-1)]<<r%4*2,t=d[u.charCodeAt(r)]>>>6-r%4*2,o=a|t;x[i>>>2]|=o<<24-i%4*8,i++}return m.create(x,i)}}(),v.enc.Base64})}(cs)),cs.exports}var ds={exports:{}},un;function Eo(){return un||(un=1,function(R,U){(function(v,w){R.exports=w(ye())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.WordArray,b=w.enc;b.Base64url={stringify:function(u,s){s===void 0&&(s=!0);var d=u.words,x=u.sigBytes,i=s?this._safe_map:this._map;u.clamp();for(var r=[],a=0;a<x;a+=3)for(var t=d[a>>>2]>>>24-a%4*8&255,o=d[a+1>>>2]>>>24-(a+1)%4*8&255,c=d[a+2>>>2]>>>24-(a+2)%4*8&255,n=t<<16|o<<8|c,h=0;h<4&&a+h*.75<x;h++)r.push(i.charAt(n>>>6*(3-h)&63));var y=i.charAt(64);if(y)for(;r.length%4;)r.push(y);return r.join("")},parse:function(u,s){s===void 0&&(s=!0);var d=u.length,x=s?this._safe_map:this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var r=0;r<x.length;r++)i[x.charCodeAt(r)]=r}var a=x.charAt(64);if(a){var t=u.indexOf(a);t!==-1&&(d=t)}return l(u,d,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function l(u,s,d){for(var x=[],i=0,r=0;r<s;r++)if(r%4){var a=d[u.charCodeAt(r-1)]<<r%4*2,t=d[u.charCodeAt(r)]>>>6-r%4*2,o=a|t;x[i>>>2]|=o<<24-i%4*8,i++}return m.create(x,i)}}(),v.enc.Base64url})}(ds)),ds.exports}var xs={exports:{}},hn;function Ft(){return hn||(hn=1,function(R,U){(function(v,w){R.exports=w(ye())})(fe,function(v){return function(w){var _=v,m=_.lib,b=m.WordArray,l=m.Hasher,u=_.algo,s=[];(function(){for(var t=0;t<64;t++)s[t]=w.abs(w.sin(t+1))*4294967296|0})();var d=u.MD5=l.extend({_doReset:function(){this._hash=new b.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,o){for(var c=0;c<16;c++){var n=o+c,h=t[n];t[n]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360}var y=this._hash.words,j=t[o+0],A=t[o+1],D=t[o+2],z=t[o+3],E=t[o+4],C=t[o+5],L=t[o+6],N=t[o+7],T=t[o+8],p=t[o+9],W=t[o+10],X=t[o+11],Y=t[o+12],oe=t[o+13],K=t[o+14],ie=t[o+15],F=y[0],S=y[1],V=y[2],H=y[3];F=x(F,S,V,H,j,7,s[0]),H=x(H,F,S,V,A,12,s[1]),V=x(V,H,F,S,D,17,s[2]),S=x(S,V,H,F,z,22,s[3]),F=x(F,S,V,H,E,7,s[4]),H=x(H,F,S,V,C,12,s[5]),V=x(V,H,F,S,L,17,s[6]),S=x(S,V,H,F,N,22,s[7]),F=x(F,S,V,H,T,7,s[8]),H=x(H,F,S,V,p,12,s[9]),V=x(V,H,F,S,W,17,s[10]),S=x(S,V,H,F,X,22,s[11]),F=x(F,S,V,H,Y,7,s[12]),H=x(H,F,S,V,oe,12,s[13]),V=x(V,H,F,S,K,17,s[14]),S=x(S,V,H,F,ie,22,s[15]),F=i(F,S,V,H,A,5,s[16]),H=i(H,F,S,V,L,9,s[17]),V=i(V,H,F,S,X,14,s[18]),S=i(S,V,H,F,j,20,s[19]),F=i(F,S,V,H,C,5,s[20]),H=i(H,F,S,V,W,9,s[21]),V=i(V,H,F,S,ie,14,s[22]),S=i(S,V,H,F,E,20,s[23]),F=i(F,S,V,H,p,5,s[24]),H=i(H,F,S,V,K,9,s[25]),V=i(V,H,F,S,z,14,s[26]),S=i(S,V,H,F,T,20,s[27]),F=i(F,S,V,H,oe,5,s[28]),H=i(H,F,S,V,D,9,s[29]),V=i(V,H,F,S,N,14,s[30]),S=i(S,V,H,F,Y,20,s[31]),F=r(F,S,V,H,C,4,s[32]),H=r(H,F,S,V,T,11,s[33]),V=r(V,H,F,S,X,16,s[34]),S=r(S,V,H,F,K,23,s[35]),F=r(F,S,V,H,A,4,s[36]),H=r(H,F,S,V,E,11,s[37]),V=r(V,H,F,S,N,16,s[38]),S=r(S,V,H,F,W,23,s[39]),F=r(F,S,V,H,oe,4,s[40]),H=r(H,F,S,V,j,11,s[41]),V=r(V,H,F,S,z,16,s[42]),S=r(S,V,H,F,L,23,s[43]),F=r(F,S,V,H,p,4,s[44]),H=r(H,F,S,V,Y,11,s[45]),V=r(V,H,F,S,ie,16,s[46]),S=r(S,V,H,F,D,23,s[47]),F=a(F,S,V,H,j,6,s[48]),H=a(H,F,S,V,N,10,s[49]),V=a(V,H,F,S,K,15,s[50]),S=a(S,V,H,F,C,21,s[51]),F=a(F,S,V,H,Y,6,s[52]),H=a(H,F,S,V,z,10,s[53]),V=a(V,H,F,S,W,15,s[54]),S=a(S,V,H,F,A,21,s[55]),F=a(F,S,V,H,T,6,s[56]),H=a(H,F,S,V,ie,10,s[57]),V=a(V,H,F,S,L,15,s[58]),S=a(S,V,H,F,oe,21,s[59]),F=a(F,S,V,H,E,6,s[60]),H=a(H,F,S,V,X,10,s[61]),V=a(V,H,F,S,D,15,s[62]),S=a(S,V,H,F,p,21,s[63]),y[0]=y[0]+F|0,y[1]=y[1]+S|0,y[2]=y[2]+V|0,y[3]=y[3]+H|0},_doFinalize:function(){var t=this._data,o=t.words,c=this._nDataBytes*8,n=t.sigBytes*8;o[n>>>5]|=128<<24-n%32;var h=w.floor(c/4294967296),y=c;o[(n+64>>>9<<4)+15]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360,o[(n+64>>>9<<4)+14]=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,t.sigBytes=(o.length+1)*4,this._process();for(var j=this._hash,A=j.words,D=0;D<4;D++){var z=A[D];A[D]=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360}return j},clone:function(){var t=l.clone.call(this);return t._hash=this._hash.clone(),t}});function x(t,o,c,n,h,y,j){var A=t+(o&c|~o&n)+h+j;return(A<<y|A>>>32-y)+o}function i(t,o,c,n,h,y,j){var A=t+(o&n|c&~n)+h+j;return(A<<y|A>>>32-y)+o}function r(t,o,c,n,h,y,j){var A=t+(o^c^n)+h+j;return(A<<y|A>>>32-y)+o}function a(t,o,c,n,h,y,j){var A=t+(c^(o|~n))+h+j;return(A<<y|A>>>32-y)+o}_.MD5=l._createHelper(d),_.HmacMD5=l._createHmacHelper(d)}(Math),v.MD5})}(xs)),xs.exports}var us={exports:{}},fn;function ci(){return fn||(fn=1,function(R,U){(function(v,w){R.exports=w(ye())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.WordArray,b=_.Hasher,l=w.algo,u=[],s=l.SHA1=b.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,x){for(var i=this._hash.words,r=i[0],a=i[1],t=i[2],o=i[3],c=i[4],n=0;n<80;n++){if(n<16)u[n]=d[x+n]|0;else{var h=u[n-3]^u[n-8]^u[n-14]^u[n-16];u[n]=h<<1|h>>>31}var y=(r<<5|r>>>27)+c+u[n];n<20?y+=(a&t|~a&o)+1518500249:n<40?y+=(a^t^o)+1859775393:n<60?y+=(a&t|a&o|t&o)-1894007588:y+=(a^t^o)-899497514,c=o,o=t,t=a<<30|a>>>2,a=r,r=y}i[0]=i[0]+r|0,i[1]=i[1]+a|0,i[2]=i[2]+t|0,i[3]=i[3]+o|0,i[4]=i[4]+c|0},_doFinalize:function(){var d=this._data,x=d.words,i=this._nDataBytes*8,r=d.sigBytes*8;return x[r>>>5]|=128<<24-r%32,x[(r+64>>>9<<4)+14]=Math.floor(i/4294967296),x[(r+64>>>9<<4)+15]=i,d.sigBytes=x.length*4,this._process(),this._hash},clone:function(){var d=b.clone.call(this);return d._hash=this._hash.clone(),d}});w.SHA1=b._createHelper(s),w.HmacSHA1=b._createHmacHelper(s)}(),v.SHA1})}(us)),us.exports}var hs={exports:{}},mn;function Zs(){return mn||(mn=1,function(R,U){(function(v,w){R.exports=w(ye())})(fe,function(v){return function(w){var _=v,m=_.lib,b=m.WordArray,l=m.Hasher,u=_.algo,s=[],d=[];(function(){function r(c){for(var n=w.sqrt(c),h=2;h<=n;h++)if(!(c%h))return!1;return!0}function a(c){return(c-(c|0))*4294967296|0}for(var t=2,o=0;o<64;)r(t)&&(o<8&&(s[o]=a(w.pow(t,1/2))),d[o]=a(w.pow(t,1/3)),o++),t++})();var x=[],i=u.SHA256=l.extend({_doReset:function(){this._hash=new b.init(s.slice(0))},_doProcessBlock:function(r,a){for(var t=this._hash.words,o=t[0],c=t[1],n=t[2],h=t[3],y=t[4],j=t[5],A=t[6],D=t[7],z=0;z<64;z++){if(z<16)x[z]=r[a+z]|0;else{var E=x[z-15],C=(E<<25|E>>>7)^(E<<14|E>>>18)^E>>>3,L=x[z-2],N=(L<<15|L>>>17)^(L<<13|L>>>19)^L>>>10;x[z]=C+x[z-7]+N+x[z-16]}var T=y&j^~y&A,p=o&c^o&n^c&n,W=(o<<30|o>>>2)^(o<<19|o>>>13)^(o<<10|o>>>22),X=(y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25),Y=D+X+T+d[z]+x[z],oe=W+p;D=A,A=j,j=y,y=h+Y|0,h=n,n=c,c=o,o=Y+oe|0}t[0]=t[0]+o|0,t[1]=t[1]+c|0,t[2]=t[2]+n|0,t[3]=t[3]+h|0,t[4]=t[4]+y|0,t[5]=t[5]+j|0,t[6]=t[6]+A|0,t[7]=t[7]+D|0},_doFinalize:function(){var r=this._data,a=r.words,t=this._nDataBytes*8,o=r.sigBytes*8;return a[o>>>5]|=128<<24-o%32,a[(o+64>>>9<<4)+14]=w.floor(t/4294967296),a[(o+64>>>9<<4)+15]=t,r.sigBytes=a.length*4,this._process(),this._hash},clone:function(){var r=l.clone.call(this);return r._hash=this._hash.clone(),r}});_.SHA256=l._createHelper(i),_.HmacSHA256=l._createHmacHelper(i)}(Math),v.SHA256})}(hs)),hs.exports}var fs={exports:{}},pn;function Ao(){return pn||(pn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Zs())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.WordArray,b=w.algo,l=b.SHA256,u=b.SHA224=l.extend({_doReset:function(){this._hash=new m.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var s=l._doFinalize.call(this);return s.sigBytes-=4,s}});w.SHA224=l._createHelper(u),w.HmacSHA224=l._createHmacHelper(u)}(),v.SHA224})}(fs)),fs.exports}var ms={exports:{}},gn;function di(){return gn||(gn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Pr())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.Hasher,b=w.x64,l=b.Word,u=b.WordArray,s=w.algo;function d(){return l.create.apply(l,arguments)}var x=[d(1116352408,3609767458),d(1899447441,602891725),d(3049323471,3964484399),d(3921009573,2173295548),d(961987163,4081628472),d(1508970993,3053834265),d(2453635748,2937671579),d(2870763221,3664609560),d(3624381080,2734883394),d(310598401,1164996542),d(607225278,1323610764),d(1426881987,3590304994),d(1925078388,4068182383),d(2162078206,991336113),d(2614888103,633803317),d(3248222580,3479774868),d(3835390401,2666613458),d(4022224774,944711139),d(264347078,2341262773),d(604807628,2007800933),d(770255983,1495990901),d(1249150122,1856431235),d(1555081692,3175218132),d(1996064986,2198950837),d(2554220882,3999719339),d(2821834349,766784016),d(2952996808,2566594879),d(3210313671,3203337956),d(3336571891,1034457026),d(3584528711,2466948901),d(113926993,3758326383),d(338241895,168717936),d(666307205,1188179964),d(773529912,1546045734),d(1294757372,1522805485),d(1396182291,2643833823),d(1695183700,2343527390),d(1986661051,1014477480),d(2177026350,1206759142),d(2456956037,344077627),d(2730485921,1290863460),d(2820302411,3158454273),d(3259730800,3505952657),d(3345764771,106217008),d(3516065817,3606008344),d(3600352804,1432725776),d(4094571909,1467031594),d(275423344,851169720),d(430227734,3100823752),d(506948616,1363258195),d(659060556,3750685593),d(883997877,3785050280),d(958139571,3318307427),d(1322822218,3812723403),d(1537002063,2003034995),d(1747873779,3602036899),d(1955562222,1575990012),d(2024104815,1125592928),d(2227730452,2716904306),d(2361852424,442776044),d(2428436474,593698344),d(2756734187,3733110249),d(3204031479,2999351573),d(3329325298,3815920427),d(3391569614,3928383900),d(3515267271,566280711),d(3940187606,3454069534),d(4118630271,4000239992),d(116418474,1914138554),d(174292421,2731055270),d(289380356,3203993006),d(460393269,320620315),d(685471733,587496836),d(852142971,1086792851),d(1017036298,365543100),d(1126000580,2618297676),d(1288033470,3409855158),d(1501505948,4234509866),d(1607167915,987167468),d(1816402316,1246189591)],i=[];(function(){for(var a=0;a<80;a++)i[a]=d()})();var r=s.SHA512=m.extend({_doReset:function(){this._hash=new u.init([new l.init(1779033703,4089235720),new l.init(3144134277,2227873595),new l.init(1013904242,4271175723),new l.init(2773480762,1595750129),new l.init(1359893119,2917565137),new l.init(2600822924,725511199),new l.init(528734635,4215389547),new l.init(1541459225,327033209)])},_doProcessBlock:function(a,t){for(var o=this._hash.words,c=o[0],n=o[1],h=o[2],y=o[3],j=o[4],A=o[5],D=o[6],z=o[7],E=c.high,C=c.low,L=n.high,N=n.low,T=h.high,p=h.low,W=y.high,X=y.low,Y=j.high,oe=j.low,K=A.high,ie=A.low,F=D.high,S=D.low,V=z.high,H=z.low,ee=E,ue=C,ge=L,q=N,ce=T,ve=p,pe=W,Ee=X,Ne=Y,g=oe,Q=K,Z=ie,I=F,B=S,P=V,J=H,te=0;te<80;te++){var $,ae,le=i[te];if(te<16)ae=le.high=a[t+te*2]|0,$=le.low=a[t+te*2+1]|0;else{var ne=i[te-15],xe=ne.high,we=ne.low,be=(xe>>>1|we<<31)^(xe>>>8|we<<24)^xe>>>7,Ue=(we>>>1|xe<<31)^(we>>>8|xe<<24)^(we>>>7|xe<<25),ot=i[te-2],Ie=ot.high,Me=ot.low,Ce=(Ie>>>19|Me<<13)^(Ie<<3|Me>>>29)^Ie>>>6,We=(Me>>>19|Ie<<13)^(Me<<3|Ie>>>29)^(Me>>>6|Ie<<26),lt=i[te-7],Ze=lt.high,Gt=lt.low,Kt=i[te-16],mr=Kt.high,Xt=Kt.low;$=Ue+Gt,ae=be+Ze+($>>>0<Ue>>>0?1:0),$=$+We,ae=ae+Ce+($>>>0<We>>>0?1:0),$=$+Xt,ae=ae+mr+($>>>0<Xt>>>0?1:0),le.high=ae,le.low=$}var Qt=Ne&Q^~Ne&I,ct=g&Z^~g&B,vt=ee&ge^ee&ce^ge&ce,Gs=ue&q^ue&ve^q&ve,Ks=(ee>>>28|ue<<4)^(ee<<30|ue>>>2)^(ee<<25|ue>>>7),pr=(ue>>>28|ee<<4)^(ue<<30|ee>>>2)^(ue<<25|ee>>>7),_e=(Ne>>>14|g<<18)^(Ne>>>18|g<<14)^(Ne<<23|g>>>9),tt=(g>>>14|Ne<<18)^(g>>>18|Ne<<14)^(g<<23|Ne>>>9),St=x[te],Hr=St.high,It=St.low,Oe=J+tt,Ye=P+_e+(Oe>>>0<J>>>0?1:0),Oe=Oe+ct,Ye=Ye+Qt+(Oe>>>0<ct>>>0?1:0),Oe=Oe+It,Ye=Ye+Hr+(Oe>>>0<It>>>0?1:0),Oe=Oe+$,Ye=Ye+ae+(Oe>>>0<$>>>0?1:0),gr=pr+Gs,vr=Ks+vt+(gr>>>0<pr>>>0?1:0);P=I,J=B,I=Q,B=Z,Q=Ne,Z=g,g=Ee+Oe|0,Ne=pe+Ye+(g>>>0<Ee>>>0?1:0)|0,pe=ce,Ee=ve,ce=ge,ve=q,ge=ee,q=ue,ue=Oe+gr|0,ee=Ye+vr+(ue>>>0<Oe>>>0?1:0)|0}C=c.low=C+ue,c.high=E+ee+(C>>>0<ue>>>0?1:0),N=n.low=N+q,n.high=L+ge+(N>>>0<q>>>0?1:0),p=h.low=p+ve,h.high=T+ce+(p>>>0<ve>>>0?1:0),X=y.low=X+Ee,y.high=W+pe+(X>>>0<Ee>>>0?1:0),oe=j.low=oe+g,j.high=Y+Ne+(oe>>>0<g>>>0?1:0),ie=A.low=ie+Z,A.high=K+Q+(ie>>>0<Z>>>0?1:0),S=D.low=S+B,D.high=F+I+(S>>>0<B>>>0?1:0),H=z.low=H+J,z.high=V+P+(H>>>0<J>>>0?1:0)},_doFinalize:function(){var a=this._data,t=a.words,o=this._nDataBytes*8,c=a.sigBytes*8;t[c>>>5]|=128<<24-c%32,t[(c+128>>>10<<5)+30]=Math.floor(o/4294967296),t[(c+128>>>10<<5)+31]=o,a.sigBytes=t.length*4,this._process();var n=this._hash.toX32();return n},clone:function(){var a=m.clone.call(this);return a._hash=this._hash.clone(),a},blockSize:1024/32});w.SHA512=m._createHelper(r),w.HmacSHA512=m._createHmacHelper(r)}(),v.SHA512})}(ms)),ms.exports}var ps={exports:{}},vn;function ko(){return vn||(vn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Pr(),di())})(fe,function(v){return function(){var w=v,_=w.x64,m=_.Word,b=_.WordArray,l=w.algo,u=l.SHA512,s=l.SHA384=u.extend({_doReset:function(){this._hash=new b.init([new m.init(3418070365,3238371032),new m.init(1654270250,914150663),new m.init(2438529370,812702999),new m.init(355462360,4144912697),new m.init(1731405415,4290775857),new m.init(2394180231,1750603025),new m.init(3675008525,1694076839),new m.init(1203062813,3204075428)])},_doFinalize:function(){var d=u._doFinalize.call(this);return d.sigBytes-=16,d}});w.SHA384=u._createHelper(s),w.HmacSHA384=u._createHmacHelper(s)}(),v.SHA384})}(ps)),ps.exports}var gs={exports:{}},bn;function Do(){return bn||(bn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Pr())})(fe,function(v){return function(w){var _=v,m=_.lib,b=m.WordArray,l=m.Hasher,u=_.x64,s=u.Word,d=_.algo,x=[],i=[],r=[];(function(){for(var o=1,c=0,n=0;n<24;n++){x[o+5*c]=(n+1)*(n+2)/2%64;var h=c%5,y=(2*o+3*c)%5;o=h,c=y}for(var o=0;o<5;o++)for(var c=0;c<5;c++)i[o+5*c]=c+(2*o+3*c)%5*5;for(var j=1,A=0;A<24;A++){for(var D=0,z=0,E=0;E<7;E++){if(j&1){var C=(1<<E)-1;C<32?z^=1<<C:D^=1<<C-32}j&128?j=j<<1^113:j<<=1}r[A]=s.create(D,z)}})();var a=[];(function(){for(var o=0;o<25;o++)a[o]=s.create()})();var t=d.SHA3=l.extend({cfg:l.cfg.extend({outputLength:512}),_doReset:function(){for(var o=this._state=[],c=0;c<25;c++)o[c]=new s.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(o,c){for(var n=this._state,h=this.blockSize/2,y=0;y<h;y++){var j=o[c+2*y],A=o[c+2*y+1];j=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360;var D=n[y];D.high^=A,D.low^=j}for(var z=0;z<24;z++){for(var E=0;E<5;E++){for(var C=0,L=0,N=0;N<5;N++){var D=n[E+5*N];C^=D.high,L^=D.low}var T=a[E];T.high=C,T.low=L}for(var E=0;E<5;E++)for(var p=a[(E+4)%5],W=a[(E+1)%5],X=W.high,Y=W.low,C=p.high^(X<<1|Y>>>31),L=p.low^(Y<<1|X>>>31),N=0;N<5;N++){var D=n[E+5*N];D.high^=C,D.low^=L}for(var oe=1;oe<25;oe++){var C,L,D=n[oe],K=D.high,ie=D.low,F=x[oe];F<32?(C=K<<F|ie>>>32-F,L=ie<<F|K>>>32-F):(C=ie<<F-32|K>>>64-F,L=K<<F-32|ie>>>64-F);var S=a[i[oe]];S.high=C,S.low=L}var V=a[0],H=n[0];V.high=H.high,V.low=H.low;for(var E=0;E<5;E++)for(var N=0;N<5;N++){var oe=E+5*N,D=n[oe],ee=a[oe],ue=a[(E+1)%5+5*N],ge=a[(E+2)%5+5*N];D.high=ee.high^~ue.high&ge.high,D.low=ee.low^~ue.low&ge.low}var D=n[0],q=r[z];D.high^=q.high,D.low^=q.low}},_doFinalize:function(){var o=this._data,c=o.words;this._nDataBytes*8;var n=o.sigBytes*8,h=this.blockSize*32;c[n>>>5]|=1<<24-n%32,c[(w.ceil((n+1)/h)*h>>>5)-1]|=128,o.sigBytes=c.length*4,this._process();for(var y=this._state,j=this.cfg.outputLength/8,A=j/8,D=[],z=0;z<A;z++){var E=y[z],C=E.high,L=E.low;C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,L=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,D.push(L),D.push(C)}return new b.init(D,j)},clone:function(){for(var o=l.clone.call(this),c=o._state=this._state.slice(0),n=0;n<25;n++)c[n]=c[n].clone();return o}});_.SHA3=l._createHelper(t),_.HmacSHA3=l._createHmacHelper(t)}(Math),v.SHA3})}(gs)),gs.exports}var vs={exports:{}},yn;function Bo(){return yn||(yn=1,function(R,U){(function(v,w){R.exports=w(ye())})(fe,function(v){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(w){var _=v,m=_.lib,b=m.WordArray,l=m.Hasher,u=_.algo,s=b.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),d=b.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),x=b.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),i=b.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),r=b.create([0,1518500249,1859775393,2400959708,2840853838]),a=b.create([1352829926,1548603684,1836072691,2053994217,0]),t=u.RIPEMD160=l.extend({_doReset:function(){this._hash=b.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(A,D){for(var z=0;z<16;z++){var E=D+z,C=A[E];A[E]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360}var L=this._hash.words,N=r.words,T=a.words,p=s.words,W=d.words,X=x.words,Y=i.words,oe,K,ie,F,S,V,H,ee,ue,ge;V=oe=L[0],H=K=L[1],ee=ie=L[2],ue=F=L[3],ge=S=L[4];for(var q,z=0;z<80;z+=1)q=oe+A[D+p[z]]|0,z<16?q+=o(K,ie,F)+N[0]:z<32?q+=c(K,ie,F)+N[1]:z<48?q+=n(K,ie,F)+N[2]:z<64?q+=h(K,ie,F)+N[3]:q+=y(K,ie,F)+N[4],q=q|0,q=j(q,X[z]),q=q+S|0,oe=S,S=F,F=j(ie,10),ie=K,K=q,q=V+A[D+W[z]]|0,z<16?q+=y(H,ee,ue)+T[0]:z<32?q+=h(H,ee,ue)+T[1]:z<48?q+=n(H,ee,ue)+T[2]:z<64?q+=c(H,ee,ue)+T[3]:q+=o(H,ee,ue)+T[4],q=q|0,q=j(q,Y[z]),q=q+ge|0,V=ge,ge=ue,ue=j(ee,10),ee=H,H=q;q=L[1]+ie+ue|0,L[1]=L[2]+F+ge|0,L[2]=L[3]+S+V|0,L[3]=L[4]+oe+H|0,L[4]=L[0]+K+ee|0,L[0]=q},_doFinalize:function(){var A=this._data,D=A.words,z=this._nDataBytes*8,E=A.sigBytes*8;D[E>>>5]|=128<<24-E%32,D[(E+64>>>9<<4)+14]=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360,A.sigBytes=(D.length+1)*4,this._process();for(var C=this._hash,L=C.words,N=0;N<5;N++){var T=L[N];L[N]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}return C},clone:function(){var A=l.clone.call(this);return A._hash=this._hash.clone(),A}});function o(A,D,z){return A^D^z}function c(A,D,z){return A&D|~A&z}function n(A,D,z){return(A|~D)^z}function h(A,D,z){return A&z|D&~z}function y(A,D,z){return A^(D|~z)}function j(A,D){return A<<D|A>>>32-D}_.RIPEMD160=l._createHelper(t),_.HmacRIPEMD160=l._createHmacHelper(t)}(),v.RIPEMD160})}(vs)),vs.exports}var bs={exports:{}},wn;function Ys(){return wn||(wn=1,function(R,U){(function(v,w){R.exports=w(ye())})(fe,function(v){(function(){var w=v,_=w.lib,m=_.Base,b=w.enc,l=b.Utf8,u=w.algo;u.HMAC=m.extend({init:function(s,d){s=this._hasher=new s.init,typeof d=="string"&&(d=l.parse(d));var x=s.blockSize,i=x*4;d.sigBytes>i&&(d=s.finalize(d)),d.clamp();for(var r=this._oKey=d.clone(),a=this._iKey=d.clone(),t=r.words,o=a.words,c=0;c<x;c++)t[c]^=1549556828,o[c]^=909522486;r.sigBytes=a.sigBytes=i,this.reset()},reset:function(){var s=this._hasher;s.reset(),s.update(this._iKey)},update:function(s){return this._hasher.update(s),this},finalize:function(s){var d=this._hasher,x=d.finalize(s);d.reset();var i=d.finalize(this._oKey.clone().concat(x));return i}})})()})}(bs)),bs.exports}var ys={exports:{}},_n;function Fo(){return _n||(_n=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Zs(),Ys())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.Base,b=_.WordArray,l=w.algo,u=l.SHA256,s=l.HMAC,d=l.PBKDF2=m.extend({cfg:m.extend({keySize:128/32,hasher:u,iterations:25e4}),init:function(x){this.cfg=this.cfg.extend(x)},compute:function(x,i){for(var r=this.cfg,a=s.create(r.hasher,x),t=b.create(),o=b.create([1]),c=t.words,n=o.words,h=r.keySize,y=r.iterations;c.length<h;){var j=a.update(i).finalize(o);a.reset();for(var A=j.words,D=A.length,z=j,E=1;E<y;E++){z=a.finalize(z),a.reset();for(var C=z.words,L=0;L<D;L++)A[L]^=C[L]}t.concat(j),n[0]++}return t.sigBytes=h*4,t}});w.PBKDF2=function(x,i,r){return d.create(r).compute(x,i)}}(),v.PBKDF2})}(ys)),ys.exports}var ws={exports:{}},jn;function gt(){return jn||(jn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),ci(),Ys())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.Base,b=_.WordArray,l=w.algo,u=l.MD5,s=l.EvpKDF=m.extend({cfg:m.extend({keySize:128/32,hasher:u,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,x){for(var i,r=this.cfg,a=r.hasher.create(),t=b.create(),o=t.words,c=r.keySize,n=r.iterations;o.length<c;){i&&a.update(i),i=a.update(d).finalize(x),a.reset();for(var h=1;h<n;h++)i=a.finalize(i),a.reset();t.concat(i)}return t.sigBytes=c*4,t}});w.EvpKDF=function(d,x,i){return s.create(i).compute(d,x)}}(),v.EvpKDF})}(ws)),ws.exports}var _s={exports:{}},Nn;function Te(){return Nn||(Nn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),gt())})(fe,function(v){v.lib.Cipher||function(w){var _=v,m=_.lib,b=m.Base,l=m.WordArray,u=m.BufferedBlockAlgorithm,s=_.enc;s.Utf8;var d=s.Base64,x=_.algo,i=x.EvpKDF,r=m.Cipher=u.extend({cfg:b.extend(),createEncryptor:function(C,L){return this.create(this._ENC_XFORM_MODE,C,L)},createDecryptor:function(C,L){return this.create(this._DEC_XFORM_MODE,C,L)},init:function(C,L,N){this.cfg=this.cfg.extend(N),this._xformMode=C,this._key=L,this.reset()},reset:function(){u.reset.call(this),this._doReset()},process:function(C){return this._append(C),this._process()},finalize:function(C){C&&this._append(C);var L=this._doFinalize();return L},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function C(L){return typeof L=="string"?E:A}return function(L){return{encrypt:function(N,T,p){return C(T).encrypt(L,N,T,p)},decrypt:function(N,T,p){return C(T).decrypt(L,N,T,p)}}}}()});m.StreamCipher=r.extend({_doFinalize:function(){var C=this._process(!0);return C},blockSize:1});var a=_.mode={},t=m.BlockCipherMode=b.extend({createEncryptor:function(C,L){return this.Encryptor.create(C,L)},createDecryptor:function(C,L){return this.Decryptor.create(C,L)},init:function(C,L){this._cipher=C,this._iv=L}}),o=a.CBC=function(){var C=t.extend();C.Encryptor=C.extend({processBlock:function(N,T){var p=this._cipher,W=p.blockSize;L.call(this,N,T,W),p.encryptBlock(N,T),this._prevBlock=N.slice(T,T+W)}}),C.Decryptor=C.extend({processBlock:function(N,T){var p=this._cipher,W=p.blockSize,X=N.slice(T,T+W);p.decryptBlock(N,T),L.call(this,N,T,W),this._prevBlock=X}});function L(N,T,p){var W,X=this._iv;X?(W=X,this._iv=w):W=this._prevBlock;for(var Y=0;Y<p;Y++)N[T+Y]^=W[Y]}return C}(),c=_.pad={},n=c.Pkcs7={pad:function(C,L){for(var N=L*4,T=N-C.sigBytes%N,p=T<<24|T<<16|T<<8|T,W=[],X=0;X<T;X+=4)W.push(p);var Y=l.create(W,T);C.concat(Y)},unpad:function(C){var L=C.words[C.sigBytes-1>>>2]&255;C.sigBytes-=L}};m.BlockCipher=r.extend({cfg:r.cfg.extend({mode:o,padding:n}),reset:function(){var C;r.reset.call(this);var L=this.cfg,N=L.iv,T=L.mode;this._xformMode==this._ENC_XFORM_MODE?C=T.createEncryptor:(C=T.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==C?this._mode.init(this,N&&N.words):(this._mode=C.call(T,this,N&&N.words),this._mode.__creator=C)},_doProcessBlock:function(C,L){this._mode.processBlock(C,L)},_doFinalize:function(){var C,L=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(L.pad(this._data,this.blockSize),C=this._process(!0)):(C=this._process(!0),L.unpad(C)),C},blockSize:128/32});var h=m.CipherParams=b.extend({init:function(C){this.mixIn(C)},toString:function(C){return(C||this.formatter).stringify(this)}}),y=_.format={},j=y.OpenSSL={stringify:function(C){var L,N=C.ciphertext,T=C.salt;return T?L=l.create([1398893684,1701076831]).concat(T).concat(N):L=N,L.toString(d)},parse:function(C){var L,N=d.parse(C),T=N.words;return T[0]==1398893684&&T[1]==1701076831&&(L=l.create(T.slice(2,4)),T.splice(0,4),N.sigBytes-=16),h.create({ciphertext:N,salt:L})}},A=m.SerializableCipher=b.extend({cfg:b.extend({format:j}),encrypt:function(C,L,N,T){T=this.cfg.extend(T);var p=C.createEncryptor(N,T),W=p.finalize(L),X=p.cfg;return h.create({ciphertext:W,key:N,iv:X.iv,algorithm:C,mode:X.mode,padding:X.padding,blockSize:C.blockSize,formatter:T.format})},decrypt:function(C,L,N,T){T=this.cfg.extend(T),L=this._parse(L,T.format);var p=C.createDecryptor(N,T).finalize(L.ciphertext);return p},_parse:function(C,L){return typeof C=="string"?L.parse(C,this):C}}),D=_.kdf={},z=D.OpenSSL={execute:function(C,L,N,T,p){if(T||(T=l.random(64/8)),p)var W=i.create({keySize:L+N,hasher:p}).compute(C,T);else var W=i.create({keySize:L+N}).compute(C,T);var X=l.create(W.words.slice(L),N*4);return W.sigBytes=L*4,h.create({key:W,iv:X,salt:T})}},E=m.PasswordBasedCipher=A.extend({cfg:A.cfg.extend({kdf:z}),encrypt:function(C,L,N,T){T=this.cfg.extend(T);var p=T.kdf.execute(N,C.keySize,C.ivSize,T.salt,T.hasher);T.iv=p.iv;var W=A.encrypt.call(this,C,L,p.key,T);return W.mixIn(p),W},decrypt:function(C,L,N,T){T=this.cfg.extend(T),L=this._parse(L,T.format);var p=T.kdf.execute(N,C.keySize,C.ivSize,L.salt,T.hasher);T.iv=p.iv;var W=A.decrypt.call(this,C,L,p.key,T);return W}})}()})}(_s)),_s.exports}var js={exports:{}},Cn;function So(){return Cn||(Cn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Te())})(fe,function(v){return v.mode.CFB=function(){var w=v.lib.BlockCipherMode.extend();w.Encryptor=w.extend({processBlock:function(m,b){var l=this._cipher,u=l.blockSize;_.call(this,m,b,u,l),this._prevBlock=m.slice(b,b+u)}}),w.Decryptor=w.extend({processBlock:function(m,b){var l=this._cipher,u=l.blockSize,s=m.slice(b,b+u);_.call(this,m,b,u,l),this._prevBlock=s}});function _(m,b,l,u){var s,d=this._iv;d?(s=d.slice(0),this._iv=void 0):s=this._prevBlock,u.encryptBlock(s,0);for(var x=0;x<l;x++)m[b+x]^=s[x]}return w}(),v.mode.CFB})}(js)),js.exports}var Ns={exports:{}},En;function Io(){return En||(En=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Te())})(fe,function(v){return v.mode.CTR=function(){var w=v.lib.BlockCipherMode.extend(),_=w.Encryptor=w.extend({processBlock:function(m,b){var l=this._cipher,u=l.blockSize,s=this._iv,d=this._counter;s&&(d=this._counter=s.slice(0),this._iv=void 0);var x=d.slice(0);l.encryptBlock(x,0),d[u-1]=d[u-1]+1|0;for(var i=0;i<u;i++)m[b+i]^=x[i]}});return w.Decryptor=_,w}(),v.mode.CTR})}(Ns)),Ns.exports}var Cs={exports:{}},An;function Ro(){return An||(An=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Te())})(fe,function(v){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return v.mode.CTRGladman=function(){var w=v.lib.BlockCipherMode.extend();function _(l){if((l>>24&255)===255){var u=l>>16&255,s=l>>8&255,d=l&255;u===255?(u=0,s===255?(s=0,d===255?d=0:++d):++s):++u,l=0,l+=u<<16,l+=s<<8,l+=d}else l+=1<<24;return l}function m(l){return(l[0]=_(l[0]))===0&&(l[1]=_(l[1])),l}var b=w.Encryptor=w.extend({processBlock:function(l,u){var s=this._cipher,d=s.blockSize,x=this._iv,i=this._counter;x&&(i=this._counter=x.slice(0),this._iv=void 0),m(i);var r=i.slice(0);s.encryptBlock(r,0);for(var a=0;a<d;a++)l[u+a]^=r[a]}});return w.Decryptor=b,w}(),v.mode.CTRGladman})}(Cs)),Cs.exports}var Es={exports:{}},kn;function To(){return kn||(kn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Te())})(fe,function(v){return v.mode.OFB=function(){var w=v.lib.BlockCipherMode.extend(),_=w.Encryptor=w.extend({processBlock:function(m,b){var l=this._cipher,u=l.blockSize,s=this._iv,d=this._keystream;s&&(d=this._keystream=s.slice(0),this._iv=void 0),l.encryptBlock(d,0);for(var x=0;x<u;x++)m[b+x]^=d[x]}});return w.Decryptor=_,w}(),v.mode.OFB})}(Es)),Es.exports}var As={exports:{}},Dn;function zo(){return Dn||(Dn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Te())})(fe,function(v){return v.mode.ECB=function(){var w=v.lib.BlockCipherMode.extend();return w.Encryptor=w.extend({processBlock:function(_,m){this._cipher.encryptBlock(_,m)}}),w.Decryptor=w.extend({processBlock:function(_,m){this._cipher.decryptBlock(_,m)}}),w}(),v.mode.ECB})}(As)),As.exports}var ks={exports:{}},Bn;function Uo(){return Bn||(Bn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Te())})(fe,function(v){return v.pad.AnsiX923={pad:function(w,_){var m=w.sigBytes,b=_*4,l=b-m%b,u=m+l-1;w.clamp(),w.words[u>>>2]|=l<<24-u%4*8,w.sigBytes+=l},unpad:function(w){var _=w.words[w.sigBytes-1>>>2]&255;w.sigBytes-=_}},v.pad.Ansix923})}(ks)),ks.exports}var Ds={exports:{}},Fn;function Lo(){return Fn||(Fn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Te())})(fe,function(v){return v.pad.Iso10126={pad:function(w,_){var m=_*4,b=m-w.sigBytes%m;w.concat(v.lib.WordArray.random(b-1)).concat(v.lib.WordArray.create([b<<24],1))},unpad:function(w){var _=w.words[w.sigBytes-1>>>2]&255;w.sigBytes-=_}},v.pad.Iso10126})}(Ds)),Ds.exports}var Bs={exports:{}},Sn;function Oo(){return Sn||(Sn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Te())})(fe,function(v){return v.pad.Iso97971={pad:function(w,_){w.concat(v.lib.WordArray.create([2147483648],1)),v.pad.ZeroPadding.pad(w,_)},unpad:function(w){v.pad.ZeroPadding.unpad(w),w.sigBytes--}},v.pad.Iso97971})}(Bs)),Bs.exports}var Fs={exports:{}},In;function Po(){return In||(In=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Te())})(fe,function(v){return v.pad.ZeroPadding={pad:function(w,_){var m=_*4;w.clamp(),w.sigBytes+=m-(w.sigBytes%m||m)},unpad:function(w){for(var _=w.words,m=w.sigBytes-1,m=w.sigBytes-1;m>=0;m--)if(_[m>>>2]>>>24-m%4*8&255){w.sigBytes=m+1;break}}},v.pad.ZeroPadding})}(Fs)),Fs.exports}var Ss={exports:{}},Rn;function Ho(){return Rn||(Rn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Te())})(fe,function(v){return v.pad.NoPadding={pad:function(){},unpad:function(){}},v.pad.NoPadding})}(Ss)),Ss.exports}var Is={exports:{}},Tn;function Mo(){return Tn||(Tn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Te())})(fe,function(v){return function(w){var _=v,m=_.lib,b=m.CipherParams,l=_.enc,u=l.Hex,s=_.format;s.Hex={stringify:function(d){return d.ciphertext.toString(u)},parse:function(d){var x=u.parse(d);return b.create({ciphertext:x})}}}(),v.format.Hex})}(Is)),Is.exports}var Rs={exports:{}},zn;function Wo(){return zn||(zn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Bt(),Ft(),gt(),Te())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.BlockCipher,b=w.algo,l=[],u=[],s=[],d=[],x=[],i=[],r=[],a=[],t=[],o=[];(function(){for(var h=[],y=0;y<256;y++)y<128?h[y]=y<<1:h[y]=y<<1^283;for(var j=0,A=0,y=0;y<256;y++){var D=A^A<<1^A<<2^A<<3^A<<4;D=D>>>8^D&255^99,l[j]=D,u[D]=j;var z=h[j],E=h[z],C=h[E],L=h[D]*257^D*16843008;s[j]=L<<24|L>>>8,d[j]=L<<16|L>>>16,x[j]=L<<8|L>>>24,i[j]=L;var L=C*16843009^E*65537^z*257^j*16843008;r[D]=L<<24|L>>>8,a[D]=L<<16|L>>>16,t[D]=L<<8|L>>>24,o[D]=L,j?(j=z^h[h[h[C^z]]],A^=h[h[A]]):j=A=1}})();var c=[0,1,2,4,8,16,32,64,128,27,54],n=b.AES=m.extend({_doReset:function(){var h;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var y=this._keyPriorReset=this._key,j=y.words,A=y.sigBytes/4,D=this._nRounds=A+6,z=(D+1)*4,E=this._keySchedule=[],C=0;C<z;C++)C<A?E[C]=j[C]:(h=E[C-1],C%A?A>6&&C%A==4&&(h=l[h>>>24]<<24|l[h>>>16&255]<<16|l[h>>>8&255]<<8|l[h&255]):(h=h<<8|h>>>24,h=l[h>>>24]<<24|l[h>>>16&255]<<16|l[h>>>8&255]<<8|l[h&255],h^=c[C/A|0]<<24),E[C]=E[C-A]^h);for(var L=this._invKeySchedule=[],N=0;N<z;N++){var C=z-N;if(N%4)var h=E[C];else var h=E[C-4];N<4||C<=4?L[N]=h:L[N]=r[l[h>>>24]]^a[l[h>>>16&255]]^t[l[h>>>8&255]]^o[l[h&255]]}}},encryptBlock:function(h,y){this._doCryptBlock(h,y,this._keySchedule,s,d,x,i,l)},decryptBlock:function(h,y){var j=h[y+1];h[y+1]=h[y+3],h[y+3]=j,this._doCryptBlock(h,y,this._invKeySchedule,r,a,t,o,u);var j=h[y+1];h[y+1]=h[y+3],h[y+3]=j},_doCryptBlock:function(h,y,j,A,D,z,E,C){for(var L=this._nRounds,N=h[y]^j[0],T=h[y+1]^j[1],p=h[y+2]^j[2],W=h[y+3]^j[3],X=4,Y=1;Y<L;Y++){var oe=A[N>>>24]^D[T>>>16&255]^z[p>>>8&255]^E[W&255]^j[X++],K=A[T>>>24]^D[p>>>16&255]^z[W>>>8&255]^E[N&255]^j[X++],ie=A[p>>>24]^D[W>>>16&255]^z[N>>>8&255]^E[T&255]^j[X++],F=A[W>>>24]^D[N>>>16&255]^z[T>>>8&255]^E[p&255]^j[X++];N=oe,T=K,p=ie,W=F}var oe=(C[N>>>24]<<24|C[T>>>16&255]<<16|C[p>>>8&255]<<8|C[W&255])^j[X++],K=(C[T>>>24]<<24|C[p>>>16&255]<<16|C[W>>>8&255]<<8|C[N&255])^j[X++],ie=(C[p>>>24]<<24|C[W>>>16&255]<<16|C[N>>>8&255]<<8|C[T&255])^j[X++],F=(C[W>>>24]<<24|C[N>>>16&255]<<16|C[T>>>8&255]<<8|C[p&255])^j[X++];h[y]=oe,h[y+1]=K,h[y+2]=ie,h[y+3]=F},keySize:256/32});w.AES=m._createHelper(n)}(),v.AES})}(Rs)),Rs.exports}var Ts={exports:{}},Un;function $o(){return Un||(Un=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Bt(),Ft(),gt(),Te())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.WordArray,b=_.BlockCipher,l=w.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],d=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],x=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],i=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],r=l.DES=b.extend({_doReset:function(){for(var c=this._key,n=c.words,h=[],y=0;y<56;y++){var j=u[y]-1;h[y]=n[j>>>5]>>>31-j%32&1}for(var A=this._subKeys=[],D=0;D<16;D++){for(var z=A[D]=[],E=d[D],y=0;y<24;y++)z[y/6|0]|=h[(s[y]-1+E)%28]<<31-y%6,z[4+(y/6|0)]|=h[28+(s[y+24]-1+E)%28]<<31-y%6;z[0]=z[0]<<1|z[0]>>>31;for(var y=1;y<7;y++)z[y]=z[y]>>>(y-1)*4+3;z[7]=z[7]<<5|z[7]>>>27}for(var C=this._invSubKeys=[],y=0;y<16;y++)C[y]=A[15-y]},encryptBlock:function(c,n){this._doCryptBlock(c,n,this._subKeys)},decryptBlock:function(c,n){this._doCryptBlock(c,n,this._invSubKeys)},_doCryptBlock:function(c,n,h){this._lBlock=c[n],this._rBlock=c[n+1],a.call(this,4,252645135),a.call(this,16,65535),t.call(this,2,858993459),t.call(this,8,16711935),a.call(this,1,1431655765);for(var y=0;y<16;y++){for(var j=h[y],A=this._lBlock,D=this._rBlock,z=0,E=0;E<8;E++)z|=x[E][((D^j[E])&i[E])>>>0];this._lBlock=D,this._rBlock=A^z}var C=this._lBlock;this._lBlock=this._rBlock,this._rBlock=C,a.call(this,1,1431655765),t.call(this,8,16711935),t.call(this,2,858993459),a.call(this,16,65535),a.call(this,4,252645135),c[n]=this._lBlock,c[n+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function a(c,n){var h=(this._lBlock>>>c^this._rBlock)&n;this._rBlock^=h,this._lBlock^=h<<c}function t(c,n){var h=(this._rBlock>>>c^this._lBlock)&n;this._lBlock^=h,this._rBlock^=h<<c}w.DES=b._createHelper(r);var o=l.TripleDES=b.extend({_doReset:function(){var c=this._key,n=c.words;if(n.length!==2&&n.length!==4&&n.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var h=n.slice(0,2),y=n.length<4?n.slice(0,2):n.slice(2,4),j=n.length<6?n.slice(0,2):n.slice(4,6);this._des1=r.createEncryptor(m.create(h)),this._des2=r.createEncryptor(m.create(y)),this._des3=r.createEncryptor(m.create(j))},encryptBlock:function(c,n){this._des1.encryptBlock(c,n),this._des2.decryptBlock(c,n),this._des3.encryptBlock(c,n)},decryptBlock:function(c,n){this._des3.decryptBlock(c,n),this._des2.encryptBlock(c,n),this._des1.decryptBlock(c,n)},keySize:192/32,ivSize:64/32,blockSize:64/32});w.TripleDES=b._createHelper(o)}(),v.TripleDES})}(Ts)),Ts.exports}var zs={exports:{}},Ln;function Vo(){return Ln||(Ln=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Bt(),Ft(),gt(),Te())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.StreamCipher,b=w.algo,l=b.RC4=m.extend({_doReset:function(){for(var d=this._key,x=d.words,i=d.sigBytes,r=this._S=[],a=0;a<256;a++)r[a]=a;for(var a=0,t=0;a<256;a++){var o=a%i,c=x[o>>>2]>>>24-o%4*8&255;t=(t+r[a]+c)%256;var n=r[a];r[a]=r[t],r[t]=n}this._i=this._j=0},_doProcessBlock:function(d,x){d[x]^=u.call(this)},keySize:256/32,ivSize:0});function u(){for(var d=this._S,x=this._i,i=this._j,r=0,a=0;a<4;a++){x=(x+1)%256,i=(i+d[x])%256;var t=d[x];d[x]=d[i],d[i]=t,r|=d[(d[x]+d[i])%256]<<24-a*8}return this._i=x,this._j=i,r}w.RC4=m._createHelper(l);var s=b.RC4Drop=l.extend({cfg:l.cfg.extend({drop:192}),_doReset:function(){l._doReset.call(this);for(var d=this.cfg.drop;d>0;d--)u.call(this)}});w.RC4Drop=m._createHelper(s)}(),v.RC4})}(zs)),zs.exports}var Us={exports:{}},On;function qo(){return On||(On=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Bt(),Ft(),gt(),Te())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.StreamCipher,b=w.algo,l=[],u=[],s=[],d=b.Rabbit=m.extend({_doReset:function(){for(var i=this._key.words,r=this.cfg.iv,a=0;a<4;a++)i[a]=(i[a]<<8|i[a]>>>24)&16711935|(i[a]<<24|i[a]>>>8)&4278255360;var t=this._X=[i[0],i[3]<<16|i[2]>>>16,i[1],i[0]<<16|i[3]>>>16,i[2],i[1]<<16|i[0]>>>16,i[3],i[2]<<16|i[1]>>>16],o=this._C=[i[2]<<16|i[2]>>>16,i[0]&4294901760|i[1]&65535,i[3]<<16|i[3]>>>16,i[1]&4294901760|i[2]&65535,i[0]<<16|i[0]>>>16,i[2]&4294901760|i[3]&65535,i[1]<<16|i[1]>>>16,i[3]&4294901760|i[0]&65535];this._b=0;for(var a=0;a<4;a++)x.call(this);for(var a=0;a<8;a++)o[a]^=t[a+4&7];if(r){var c=r.words,n=c[0],h=c[1],y=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360,j=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360,A=y>>>16|j&4294901760,D=j<<16|y&65535;o[0]^=y,o[1]^=A,o[2]^=j,o[3]^=D,o[4]^=y,o[5]^=A,o[6]^=j,o[7]^=D;for(var a=0;a<4;a++)x.call(this)}},_doProcessBlock:function(i,r){var a=this._X;x.call(this),l[0]=a[0]^a[5]>>>16^a[3]<<16,l[1]=a[2]^a[7]>>>16^a[5]<<16,l[2]=a[4]^a[1]>>>16^a[7]<<16,l[3]=a[6]^a[3]>>>16^a[1]<<16;for(var t=0;t<4;t++)l[t]=(l[t]<<8|l[t]>>>24)&16711935|(l[t]<<24|l[t]>>>8)&4278255360,i[r+t]^=l[t]},blockSize:128/32,ivSize:64/32});function x(){for(var i=this._X,r=this._C,a=0;a<8;a++)u[a]=r[a];r[0]=r[0]+1295307597+this._b|0,r[1]=r[1]+3545052371+(r[0]>>>0<u[0]>>>0?1:0)|0,r[2]=r[2]+886263092+(r[1]>>>0<u[1]>>>0?1:0)|0,r[3]=r[3]+1295307597+(r[2]>>>0<u[2]>>>0?1:0)|0,r[4]=r[4]+3545052371+(r[3]>>>0<u[3]>>>0?1:0)|0,r[5]=r[5]+886263092+(r[4]>>>0<u[4]>>>0?1:0)|0,r[6]=r[6]+1295307597+(r[5]>>>0<u[5]>>>0?1:0)|0,r[7]=r[7]+3545052371+(r[6]>>>0<u[6]>>>0?1:0)|0,this._b=r[7]>>>0<u[7]>>>0?1:0;for(var a=0;a<8;a++){var t=i[a]+r[a],o=t&65535,c=t>>>16,n=((o*o>>>17)+o*c>>>15)+c*c,h=((t&4294901760)*t|0)+((t&65535)*t|0);s[a]=n^h}i[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,i[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,i[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,i[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,i[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,i[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,i[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,i[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}w.Rabbit=m._createHelper(d)}(),v.Rabbit})}(Us)),Us.exports}var Ls={exports:{}},Pn;function Zo(){return Pn||(Pn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Bt(),Ft(),gt(),Te())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.StreamCipher,b=w.algo,l=[],u=[],s=[],d=b.RabbitLegacy=m.extend({_doReset:function(){var i=this._key.words,r=this.cfg.iv,a=this._X=[i[0],i[3]<<16|i[2]>>>16,i[1],i[0]<<16|i[3]>>>16,i[2],i[1]<<16|i[0]>>>16,i[3],i[2]<<16|i[1]>>>16],t=this._C=[i[2]<<16|i[2]>>>16,i[0]&4294901760|i[1]&65535,i[3]<<16|i[3]>>>16,i[1]&4294901760|i[2]&65535,i[0]<<16|i[0]>>>16,i[2]&4294901760|i[3]&65535,i[1]<<16|i[1]>>>16,i[3]&4294901760|i[0]&65535];this._b=0;for(var o=0;o<4;o++)x.call(this);for(var o=0;o<8;o++)t[o]^=a[o+4&7];if(r){var c=r.words,n=c[0],h=c[1],y=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360,j=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360,A=y>>>16|j&4294901760,D=j<<16|y&65535;t[0]^=y,t[1]^=A,t[2]^=j,t[3]^=D,t[4]^=y,t[5]^=A,t[6]^=j,t[7]^=D;for(var o=0;o<4;o++)x.call(this)}},_doProcessBlock:function(i,r){var a=this._X;x.call(this),l[0]=a[0]^a[5]>>>16^a[3]<<16,l[1]=a[2]^a[7]>>>16^a[5]<<16,l[2]=a[4]^a[1]>>>16^a[7]<<16,l[3]=a[6]^a[3]>>>16^a[1]<<16;for(var t=0;t<4;t++)l[t]=(l[t]<<8|l[t]>>>24)&16711935|(l[t]<<24|l[t]>>>8)&4278255360,i[r+t]^=l[t]},blockSize:128/32,ivSize:64/32});function x(){for(var i=this._X,r=this._C,a=0;a<8;a++)u[a]=r[a];r[0]=r[0]+1295307597+this._b|0,r[1]=r[1]+3545052371+(r[0]>>>0<u[0]>>>0?1:0)|0,r[2]=r[2]+886263092+(r[1]>>>0<u[1]>>>0?1:0)|0,r[3]=r[3]+1295307597+(r[2]>>>0<u[2]>>>0?1:0)|0,r[4]=r[4]+3545052371+(r[3]>>>0<u[3]>>>0?1:0)|0,r[5]=r[5]+886263092+(r[4]>>>0<u[4]>>>0?1:0)|0,r[6]=r[6]+1295307597+(r[5]>>>0<u[5]>>>0?1:0)|0,r[7]=r[7]+3545052371+(r[6]>>>0<u[6]>>>0?1:0)|0,this._b=r[7]>>>0<u[7]>>>0?1:0;for(var a=0;a<8;a++){var t=i[a]+r[a],o=t&65535,c=t>>>16,n=((o*o>>>17)+o*c>>>15)+c*c,h=((t&4294901760)*t|0)+((t&65535)*t|0);s[a]=n^h}i[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,i[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,i[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,i[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,i[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,i[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,i[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,i[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}w.RabbitLegacy=m._createHelper(d)}(),v.RabbitLegacy})}(Ls)),Ls.exports}var Os={exports:{}},Hn;function Yo(){return Hn||(Hn=1,function(R,U){(function(v,w,_){R.exports=w(ye(),Bt(),Ft(),gt(),Te())})(fe,function(v){return function(){var w=v,_=w.lib,m=_.BlockCipher,b=w.algo;const l=16,u=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],s=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var d={pbox:[],sbox:[]};function x(o,c){let n=c>>24&255,h=c>>16&255,y=c>>8&255,j=c&255,A=o.sbox[0][n]+o.sbox[1][h];return A=A^o.sbox[2][y],A=A+o.sbox[3][j],A}function i(o,c,n){let h=c,y=n,j;for(let A=0;A<l;++A)h=h^o.pbox[A],y=x(o,h)^y,j=h,h=y,y=j;return j=h,h=y,y=j,y=y^o.pbox[l],h=h^o.pbox[l+1],{left:h,right:y}}function r(o,c,n){let h=c,y=n,j;for(let A=l+1;A>1;--A)h=h^o.pbox[A],y=x(o,h)^y,j=h,h=y,y=j;return j=h,h=y,y=j,y=y^o.pbox[1],h=h^o.pbox[0],{left:h,right:y}}function a(o,c,n){for(let D=0;D<4;D++){o.sbox[D]=[];for(let z=0;z<256;z++)o.sbox[D][z]=s[D][z]}let h=0;for(let D=0;D<l+2;D++)o.pbox[D]=u[D]^c[h],h++,h>=n&&(h=0);let y=0,j=0,A=0;for(let D=0;D<l+2;D+=2)A=i(o,y,j),y=A.left,j=A.right,o.pbox[D]=y,o.pbox[D+1]=j;for(let D=0;D<4;D++)for(let z=0;z<256;z+=2)A=i(o,y,j),y=A.left,j=A.right,o.sbox[D][z]=y,o.sbox[D][z+1]=j;return!0}var t=b.Blowfish=m.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var o=this._keyPriorReset=this._key,c=o.words,n=o.sigBytes/4;a(d,c,n)}},encryptBlock:function(o,c){var n=i(d,o[c],o[c+1]);o[c]=n.left,o[c+1]=n.right},decryptBlock:function(o,c){var n=r(d,o[c],o[c+1]);o[c]=n.left,o[c+1]=n.right},blockSize:64/32,keySize:128/32,ivSize:64/32});w.Blowfish=m._createHelper(t)}(),v.Blowfish})}(Os)),Os.exports}(function(R,U){(function(v,w,_){R.exports=w(ye(),Pr(),No(),Co(),Bt(),Eo(),Ft(),ci(),Zs(),Ao(),di(),ko(),Do(),Bo(),Ys(),Fo(),gt(),Te(),So(),Io(),Ro(),To(),zo(),Uo(),Lo(),Oo(),Po(),Ho(),Mo(),Wo(),$o(),Vo(),qo(),Zo(),Yo())})(fe,function(v){return v})})(li);var Go=li.exports;const $s=Kn(Go);var Or;(function(R){R.Documents="DOCUMENTS",R.Data="DATA",R.Library="LIBRARY",R.Cache="CACHE",R.External="EXTERNAL",R.ExternalStorage="EXTERNAL_STORAGE"})(Or||(Or={}));var Mn;(function(R){R.UTF8="utf8",R.ASCII="ascii",R.UTF16="utf16"})(Mn||(Mn={}));const Wn=a0("Filesystem",{web:()=>ke(()=>import("./web-BIhoFa7_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]),import.meta.url).then(R=>new R.FilesystemWeb)}),$n=["profiles","shops","lines","merchantWallets","transactions","daily_reports_archive","debts","installments","categories","shop_expenses","products","purchases","dailySales","clients","maintenance_items","maintenance_pending","maintenance_done","fawry_terminals","userTransactions","audit_logs","expenses","sales","maintenance","user_transactions"],xi=async(R,U)=>{try{const v={},w={};let _=0;const m=$n.length;for(let r=0;r<m;r++){const a=$n[r];U&&U(`جارٍ جلب ${a}...`,Math.round(r/m*50));try{const o=(await qe(Se(he,a))).docs.map(c=>{const n=c.data(),h=Object.entries(n).reduce((y,[j,A])=>(A instanceof Xn?y[j]={__type:"Timestamp",value:A.toDate().toISOString()}:A instanceof Date?y[j]={__type:"Date",value:A.toISOString()}:y[j]=A,y),{});return{id:c.id,...h}});v[a]=o,w[a]=o.length,_+=o.length}catch(t){console.warn(`Failed to fetch collection ${a}:`,t),v[a]=[],w[a]=0}}const l={metadata:{version:"1.0.0",timestamp:new Date().toISOString(),device:Za.getPlatform(),totalRecords:_,collections:w,encrypted:!!R},data:v};U&&U("جارٍ معالجة البيانات...",60);let u=JSON.stringify(l);R&&(U&&U("جارٍ تشفير البيانات...",70),u=$s.AES.encrypt(u,R).toString()),U&&U("جارٍ الضغط...",80);const s=new ii,d=`backup_${new Date().toISOString().replace(/[:.]/g,"-")}.json${R?".enc":""}`;s.file(d,u);const x=await s.generateAsync({type:"base64"});U&&U("جارٍ حفظ الملف...",90);const i=`backup_${new Date().toISOString().replace(/[:.]/g,"-")}.zip`;if(Za.isNativePlatform())try{const r=await Wn.writeFile({path:`Download/${i}`,data:x,directory:Or.ExternalStorage,recursive:!0});return await Wt("export","success",`Backup saved to Download/${i}`),U&&U("اكتمل",100),{success:!0,message:`تم حفظ النسخة في مجلد التنزيلات: ${i}`,filePath:r.uri,stats:{size:x.length,records:_}}}catch{const a=await Wn.writeFile({path:i,data:x,directory:Or.Documents});return await Wt("export","success",`Backup saved to Documents/${i}`),U&&U("اكتمل",100),{success:!0,message:`تم حفظ النسخة في مجلد المستندات: ${i}`,filePath:a.uri,stats:{size:x.length,records:_}}}else{const r=await s.generateAsync({type:"blob"});return yo.saveAs(r,i),await Wt("export","success","Backup downloaded via browser"),U&&U("اكتمل",100),{success:!0,message:"تم تنزيل النسخة بنجاح",stats:{size:r.size,records:_}}}}catch(v){return console.error("Export backup failed:",v),await Wt("export","failed",v.message),{success:!1,message:v.message||"فشل التصدير"}}},Ko=async(R,U,v)=>{try{v&&v("جارٍ قراءة الملف...",10);const _=await new ii().loadAsync(R),m=Object.keys(_.files).find(t=>t.endsWith(".json")||t.endsWith(".json.enc"));if(!m)throw new Error("ملف نسخ احتياطي غير صالح: لم يتم العثور على ملف بيانات داخل ZIP");const b=await _.files[m].async("string");let l=b;if(m.endsWith(".enc")){if(!U)throw new Error("كلمة المرور مطلوبة للنسخة المشفرة");v&&v("جارٍ فك التشفير...",20);try{if(l=$s.AES.decrypt(b,U).toString($s.enc.Utf8),!l)throw new Error("فشل فك التشفير: كلمة مرور غير صحيحة")}catch{throw new Error("فشل فك التشفير: كلمة مرور غير صحيحة أو ملف تالف")}}v&&v("جارٍ تحليل البيانات...",30);const u=JSON.parse(l);if(!u.metadata||!u.data)throw new Error("تنسيق النسخة الاحتياطية غير صالح");let s=0;const d=["profiles","shops","lines","merchantWallets","clients","categories","products"],x=Object.keys(u.data).sort((t,o)=>{const c=d.indexOf(t),n=d.indexOf(o);return c!==-1&&n!==-1?c-n:c!==-1?-1:n!==-1?1:0}),i=x.length;let r=null;const a=Vs.currentUser;if(a)try{const t=await Ir(je(he,"profiles",a.uid));t.exists()&&(r=t.data().shopId)}catch(t){console.warn("Failed to fetch user profile for shopId:",t)}for(let t=0;t<i;t++){let o=x[t],c=o;o==="user_transactions"&&(c="userTransactions");const n=u.data[o];if(!n||n.length===0)continue;v&&v(`جارٍ استعادة ${o} (إلى ${c})...`,30+Math.round(t/i*60));const h=10,y=[];for(let A=0;A<n.length;A+=h)y.push(n.slice(A,A+h));let j=0;for(const A of y){if(j++,y.length>1&&v){const E=30+Math.round(t/i*60),C=Math.round(j/y.length*(60/i));v(`جارٍ استعادة ${o} (${j}/${y.length})...`,Math.min(99,E+C))}j%10===0&&await new Promise(E=>setTimeout(E,2e3));const D=n0(he),z=[];for(const E of A){const{id:C,...L}=E,N=Object.entries(L).reduce((p,[W,X])=>(X&&typeof X=="object"&&X.__type==="Timestamp"?p[W]=Xn.fromDate(new Date(X.value)):X&&typeof X=="object"&&X.__type==="Date"?p[W]=new Date(X.value):p[W]=X,p),{});a&&(["categories","products","clients","sales","dailySales","purchases","expenses","shop_expenses","maintenance","maintenance_items","maintenance_pending","maintenance_done","fawry_terminals","user_transactions","userTransactions","debts","installments","daily_reports_archive"].includes(c)&&(N.userId=a.uid,r&&(N.shopId=r)),c==="shops"&&(N.ownerId=a.uid),c==="merchantWallets"&&(N.merchantUserId=a.uid),c==="transactions"&&(N.merchantUserId=a.uid,N.userId&&(N.userId=a.uid),r&&(N.shopId=r)),c==="lines"&&r&&(N.shopId=r));let T=je(he,c,C);c==="profiles"&&a&&(T=je(he,"profiles",a.uid),N.userId=a.uid,N.id=a.uid),D.set(T,N,{merge:!0}),z.push({ref:T,data:N})}try{await D.commit(),s+=A.length,await new Promise(E=>setTimeout(E,500))}catch(E){console.error(`Failed to restore batch for collection ${o}, attempting sequential restore...`,E),await new Promise(L=>setTimeout(L,2e3));let C=0;for(const L of z)try{await qs(L.ref,L.data,{merge:!0}),C++,await new Promise(N=>setTimeout(N,100))}catch(N){console.error(`Failed to restore document ${L.ref.id} in ${o}:`,N)}s+=C,C===0&&(console.error(`Skipping batch in ${o} after total failure.`),await new Promise(L=>setTimeout(L,2e3)))}}}return await Wt("import","success",`Restored ${s} records from backup`),v&&v("اكتمل",100),{success:!0,message:"تمت الاستعادة بنجاح",stats:{records:s}}}catch(w){return console.error("Import backup failed:",w),await Wt("import","failed",w.message),{success:!1,message:w.message||"فشلت الاستعادة"}}},Wt=async(R,U,v)=>{try{const w=Vs.currentUser;if(!w){console.warn("Backup logging skipped: No authenticated user");return}await qs(je(Se(he,"audit_logs")),{type:`backup_${R}`,status:U,details:v,timestamp:pt(),userId:w.uid,user:w.email||"unknown"})}catch(w){console.error("Failed to log backup operation:",w)}},Xo=()=>{const[R,U]=M.useState(!1),[v,w]=M.useState(0),[_,m]=M.useState(""),[b,l]=M.useState(""),[u,s]=M.useState(!1),[d,x]=M.useState(null),[i,r]=M.useState(null),[a,t]=M.useState(!1),[o,c]=M.useState("daily");hr.useEffect(()=>{const E=localStorage.getItem("autoBackupEnabled")==="true",C=localStorage.getItem("backupFrequency")||"daily";t(E),c(C)},[]);const n=E=>{t(E),localStorage.setItem("autoBackupEnabled",String(E)),E?nt.success("تم تفعيل النسخ الاحتياطي التلقائي",{description:`سيتم تشغيل النسخ الاحتياطي ${o==="daily"?"يومياً":"أسبوعياً"}`}):nt.info("تم تعطيل النسخ الاحتياطي التلقائي")},h=E=>{c(E),localStorage.setItem("backupFrequency",E)},y=M.useRef(null),j=async()=>{var E;try{U(!0),s(!1),m("جارٍ بدء النسخ الاحتياطي..."),w(0);const C=await xi(b||void 0,(L,N)=>{m(L),w(N)});C.success?(nt.success("تم اكتمال النسخ الاحتياطي بنجاح",{description:C.message}),m(`تم حفظ النسخة: ${((E=C.stats)==null?void 0:E.records)||0} سجل`)):(nt.error("فشل النسخ الاحتياطي",{description:C.message}),m("فشل النسخ الاحتياطي"))}catch(C){nt.error("خطأ",{description:C.message})}finally{U(!1),l("")}},A=async()=>{var E;if(i)try{U(!0),s(!1),m("جارٍ بدء الاستعادة..."),w(0);const C=await Ko(i,b||void 0,(L,N)=>{m(L),w(N)});C.success?(nt.success("تمت الاستعادة بنجاح",{description:`تم استعادة ${((E=C.stats)==null?void 0:E.records)||0} سجل.`}),m("اكتملت الاستعادة"),setTimeout(()=>window.location.reload(),2e3)):(nt.error("فشلت الاستعادة",{description:C.message}),m("فشلت الاستعادة"))}catch(C){nt.error("خطأ",{description:C.message})}finally{U(!1),l(""),r(null)}},D=E=>{var C;x(E),l(""),m(""),w(0),E==="import"?(C=y.current)==null||C.click():s(!0)},z=E=>{E.target.files&&E.target.files.length>0&&(r(E.target.files[0]),s(!0))};return e.jsxs(At,{className:"w-full",dir:"rtl",children:[e.jsxs($t,{children:[e.jsxs(Vt,{className:"flex items-center gap-2",children:[e.jsx(Ms,{className:"h-5 w-5 text-primary"}),"النسخ الاحتياطي والاستعادة"]}),e.jsx(qn,{children:"قم بإدارة نسخك الاحتياطية بأمان. يمكنك تنزيل نسخة كاملة أو استعادتها من ملف سابق."})]}),e.jsxs(kt,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs(Ae,{variant:"outline",className:"flex-1 h-24 flex-col gap-2",onClick:()=>D("export"),disabled:R,children:[e.jsx(Br,{className:"h-8 w-8 mb-1"}),e.jsx("span",{className:"font-semibold",children:"تنزيل نسخة احتياطية"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"حفظ البيانات على الجهاز"})]}),e.jsxs(Ae,{variant:"outline",className:"flex-1 h-24 flex-col gap-2",onClick:()=>D("import"),disabled:R,children:[e.jsx(Fr,{className:"h-8 w-8 mb-1"}),e.jsx("span",{className:"font-semibold",children:"رفع نسخة احتياطية"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"استعادة من ملف"})]})]}),e.jsx("input",{type:"file",ref:y,className:"hidden",accept:".zip,.json,.enc",onChange:z}),R&&e.jsxs("div",{className:"space-y-2 py-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:_}),e.jsxs("span",{children:[v,"%"]})]}),e.jsx(I0,{value:v,className:"h-2"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-muted/20",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Zt,{className:"text-base",children:"النسخ الاحتياطي المجدول"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"نسخ البيانات احتياطياً بشكل دوري وتلقائي."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Rr,{value:o,onValueChange:h,disabled:!a,children:[e.jsx(Tr,{className:"w-[120px]",children:e.jsx(zr,{placeholder:"التكرار"})}),e.jsxs(Ur,{children:[e.jsx(Ve,{value:"daily",children:"يومي"}),e.jsx(Ve,{value:"weekly",children:"أسبوعي"})]})]}),e.jsx(ti,{checked:a,onCheckedChange:n})]})]}),!R&&_&&e.jsxs(ri,{variant:_.includes("فشل")||_.includes("failed")?"destructive":"default",children:[_.includes("فشل")||_.includes("failed")?e.jsx(qt,{className:"h-4 w-4"}):e.jsx(i0,{className:"h-4 w-4"}),e.jsx(C0,{children:_.includes("فشل")||_.includes("failed")?"خطأ":"نجاح"}),e.jsx(si,{children:_})]})]}),e.jsx(nr,{open:u,onOpenChange:s,children:e.jsxs(ir,{children:[e.jsxs(or,{children:[e.jsx(lr,{children:d==="export"?"نسخ احتياطي آمن":"فتح النسخة الاحتياطية"}),e.jsx(o0,{children:d==="export"?"يمكنك اختيارياً إدخال كلمة مرور لتشفير ملف النسخة الاحتياطية. اتركها فارغة لعدم التشفير.":"أدخل كلمة المرور لفك تشفير هذا الملف. إذا لم يكن مشفراً، اترك الحقل فارغاً."})]}),d==="import"&&i&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded-md text-sm",children:[e.jsx(U0,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:i.name}),e.jsxs("span",{className:"mr-auto text-xs text-muted-foreground",children:[(i.size/1024/1024).toFixed(2)," MB"]})]}),e.jsxs("div",{className:"space-y-2 py-2",children:[e.jsx(Zt,{htmlFor:"backup-password",children:"كلمة المرور (اختياري)"}),e.jsx(Yt,{id:"backup-password",type:"password",placeholder:"أدخل كلمة المرور...",value:b,onChange:E=>l(E.target.value)})]}),e.jsxs(Dr,{className:"flex gap-2 justify-end sm:justify-start",children:[e.jsx(Ae,{variant:"ghost",onClick:()=>s(!1),children:"إلغاء"}),e.jsxs(Ae,{onClick:d==="export"?j:A,disabled:R,className:d==="import"?"bg-green-600 hover:bg-green-700":"",children:[R?e.jsx(l0,{className:"ml-2 h-4 w-4 animate-spin"}):null,d==="export"?"بدء النسخ":"بدء الاستعادة"]})]})]})})]})},Qo={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"0.0.0",VITE_DEV_MODE:"true",VITE_ENABLE_OFFLINE_PERSISTENCE:"false",VITE_FIREBASE_API_KEY:["AI","za","SyA33RTf43u2QE2OsK1RepQHSKrSet9ZI0s"].join(""),VITE_FIREBASE_APP_ID:"1:483702062341:web:b1ff06ad175cb7ae428b6c",VITE_FIREBASE_AUTH_DOMAIN:"voda-c6abd.firebaseapp.com",VITE_FIREBASE_AUTH_EMULATOR_URL:"http://localhost:9099",VITE_FIREBASE_FIRESTORE_EMULATOR_HOST:"localhost:8080",VITE_FIREBASE_FUNCTIONS_EMULATOR_HOST:"localhost:5001",VITE_FIREBASE_MEASUREMENT_ID:"G-CV6QGH7G7P",VITE_FIREBASE_MESSAGING_SENDER_ID:"483702062341",VITE_FIREBASE_PROJECT_ID:"voda-c6abd",VITE_FIREBASE_STORAGE_BUCKET:"voda-c6abd.appspot.com",VITE_FORCE_HASH_ROUTER:"true",VITE_SHOP_ID:"demo-shop-001",VITE_SHOP_NAME:"محل كاشي لينك التجريبي",VITE_SHOW_ENV_BANNER:"true",VITE_USE_EMULATORS:"false",VITE_USE_FIREBASE_EMULATOR:"false"},Jo=({userId:R,adminId:U})=>{const[v,w]=M.useState([]),[_,m]=M.useState(!0),[b,l]=M.useState(null),[u,s]=M.useState(null),d=async()=>{try{m(!0);let r=[],a=[];try{const h=He(Se(he,"users",R,"branches"));r=(await qe(h)).docs.map(j=>({id:j.id,...j.data(),source:"sub"}))}catch(h){console.warn("Subcollection fetch warning:",h)}try{const h=He(Se(he,"branches"),ut("ownerId","==",R));a=(await qe(h)).docs.map(j=>({id:j.id,...j.data(),source:"root"}))}catch(h){console.warn("Root collection fetch warning:",h)}const t=[...r,...a],o=new Map;(await Promise.all(t.map(async h=>{const y=h.branchUserId||h.id;if(y)try{const j=await Ir(je(he,"users",y));if(j.exists())return{...h,userData:j.data(),realUserId:y}}catch{}return{...h,realUserId:y}}))).forEach(h=>{const y=h.realUserId||h.id;if(!o.has(y))o.set(y,h);else{const j=o.get(y);(h.source==="sub"||!j.loginUsername&&h.loginUsername)&&o.set(y,h)}});const n=Array.from(o.values());w(n)}catch(r){console.error("Error fetching branches:",r)}finally{m(!1)}};M.useEffect(()=>{R&&d()},[R]);const x=async(r,a)=>{if(r.realUserId){s(r.realUserId);try{await Qn(r.realUserId,a,U),await d(),alert(`تم تفعيل اشتراك ${Dt(a)} للفرع بنجاح`)}catch(t){console.error(t),alert("حدث خطأ أثناء تفعيل اشتراك الفرع")}finally{s(null),l(null)}}},i=async r=>{if(r.realUserId&&window.confirm("هل أنت متأكد من إلغاء اشتراك هذا الفرع؟ سيتم تعطيل الدخول.")){s(r.realUserId);try{await ei(r.realUserId),await d(),alert("تم إلغاء اشتراك الفرع بنجاح")}catch(a){console.error(a),alert("حدث خطأ أثناء إلغاء الاشتراك")}finally{s(null)}}};return _?e.jsx("div",{className:"mt-2 text-xs text-gray-400",children:"جاري تحميل الفروع..."}):v.length===0?e.jsx("div",{className:"mt-2 text-xs text-red-400 bg-red-50 p-2 rounded",children:"لا توجد فروع مضافة لهذا الحساب"}):e.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-100",children:[e.jsxs("p",{className:"text-xs font-semibold text-gray-600 mb-2",children:["حسابات الفروع (",v.length,"):"]}),e.jsx("div",{className:"space-y-2",children:v.map((r,a)=>{var c,n,h,y;const t=((n=(c=r.userData)==null?void 0:c.subscription)==null?void 0:n.isActive)||!1,o=(y=(h=r.userData)==null?void 0:h.subscription)==null?void 0:y.planType;return e.jsxs("div",{className:"bg-gray-50 p-2 rounded text-xs flex justify-between items-center flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-800 block",children:r.branchName||"بدون اسم"}),e.jsx("span",{className:"text-gray-500 font-mono select-all block",children:r.loginUsername||r.email||"لا يوجد بريد"}),t&&e.jsxs("span",{className:"text-green-600 text-[10px] font-bold",children:["مشترك: ",Dt(o)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r.managerName&&e.jsx("span",{className:"text-gray-400 hidden sm:inline",children:r.managerName}),u===r.realUserId?e.jsx("span",{className:"text-gray-400 text-[10px]",children:"جاري التنفيذ..."}):e.jsx(e.Fragment,{children:t?e.jsx("button",{onClick:()=>i(r),className:"bg-red-100 text-red-600 px-2 py-1 rounded hover:bg-red-200 transition-colors",children:"إلغاء"}):e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>l(b===r.realUserId?null:r.realUserId),className:"bg-green-100 text-green-600 px-2 py-1 rounded hover:bg-green-200 transition-colors",children:"تفعيل"}),b===r.realUserId&&e.jsx("div",{className:"absolute left-0 mt-1 w-40 bg-white border rounded shadow-lg z-10 p-1 flex flex-col gap-1",children:[de.MONTHLY,de.QUARTERLY,de.HALF_YEARLY,de.YEARLY].map(j=>e.jsx("button",{onClick:()=>x(r,j),className:"text-right px-2 py-1 hover:bg-gray-100 rounded text-gray-700 w-full",children:Dt(j)},j))})]})})]})]},a)})})]})},el=({adminId:R})=>{const[U,v]=M.useState([]),[w,_]=M.useState(!0),[m,b]=M.useState("pending"),l=async()=>{_(!0);try{const x=m==="pending"?"pending":"approved",i=He(Se(he,"cashierRequests"),ut("status","==",x)),a=(await qe(i)).docs.map(t=>({id:t.id,...t.data()}));a.sort((t,o)=>{var h,y;const c=((h=t.createdAt)==null?void 0:h.seconds)||0;return(((y=o.createdAt)==null?void 0:y.seconds)||0)-c}),v(a)}catch(x){console.error(x)}finally{_(!1)}};M.useEffect(()=>{l()},[m]);const u=async x=>{var i,r,a,t,o;if(window.confirm(`هل أنت متأكد من الموافقة على طلب ${x.userName} لإضافة ${x.requestedCount} كاشير؟`))try{const c=je(he,"users",x.userId),n=await Ir(c),h=n.exists()?n.data():null,y=new Date,j=((a=(r=(i=h==null?void 0:h.subscription)==null?void 0:i.extraCashiersEndsAt)==null?void 0:r.toDate)==null?void 0:a.call(r))||((t=h==null?void 0:h.subscription)!=null&&t.extraCashiersEndsAt?new Date(h.subscription.extraCashiersEndsAt):null),A=j&&j>y,z=(A&&((o=h==null?void 0:h.subscription)==null?void 0:o.extraCashiers)||0)+(Number(x.requestedCount)||0);let E=new Date;x.planType==="monthly"?E.setMonth(y.getMonth()+1):x.planType==="quarterly"?E.setMonth(y.getMonth()+3):x.planType==="half_yearly"?E.setMonth(y.getMonth()+6):x.planType==="yearly"?E.setFullYear(y.getFullYear()+1):x.planType==="lifetime"&&E.setFullYear(y.getFullYear()+100);const C=A&&j>E?j:E;await Fe(c,{"subscription.extraCashiers":z,"subscription.extraCashiersStartsAt":y,"subscription.extraCashiersEndsAt":C,"subscription.extraCashiersPlan":x.planType}),await Fe(je(he,"cashierRequests",x.id),{status:"approved",approvedBy:R,approvedAt:pt(),startsAt:y,endsAt:C}),alert("تم الموافقة على الطلب وتفعيل الكاشير الإضافي"),l()}catch(c){console.error(c),alert("حدث خطأ أثناء الموافقة")}},s=async x=>{var i;if(window.confirm("هل أنت متأكد من حذف هذا الطلب؟ سيتم إزالته نهائياً"+(x.status==="approved"?" وسيتم خصم عدد الكاشير من المستخدم.":".")))try{if(x.status==="approved"){const r=je(he,"users",x.userId),a=await Ir(r);if(a.exists()){const t=a.data(),o=((i=t==null?void 0:t.subscription)==null?void 0:i.extraCashiers)||0,c=Number(x.requestedCount)||0,n=Math.max(0,o-c);await Fe(r,{"subscription.extraCashiers":n})}}await xt(je(he,"cashierRequests",x.id)),alert("تم حذف الطلب بنجاح"),l()}catch(r){console.error(r),alert("حدث خطأ أثناء الحذف")}},d=async x=>{if(window.confirm("هل أنت متأكد من رفض الطلب؟"))try{await Fe(je(he,"cashierRequests",x.id),{status:"rejected",rejectedBy:R,rejectedAt:pt()}),l()}catch(i){console.error(i),alert("حدث خطأ أثناء الرفض")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4 border-b border-gray-200 pb-2",children:[e.jsx("button",{onClick:()=>b("pending"),className:`px-4 py-2 font-medium text-sm rounded-lg transition-colors ${m==="pending"?"bg-blue-100 text-blue-700":"text-gray-500 hover:bg-gray-100"}`,children:"الحسابات غير المفعله"}),e.jsx("button",{onClick:()=>b("approved"),className:`px-4 py-2 font-medium text-sm rounded-lg transition-colors ${m==="approved"?"bg-green-100 text-green-700":"text-gray-500 hover:bg-gray-100"}`,children:"الحسابات المفعله"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:m==="pending"?"طلبات بانتظار الموافقة":"الطلبات المفعله"}),e.jsx("button",{onClick:l,className:"p-1.5 text-gray-500 hover:bg-gray-100 rounded-full",children:e.jsx(Jn,{className:`w-4 h-4 ${w?"animate-spin":""}`})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"المستخدم"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"العدد المطلوب"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"الباقة"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"تاريخ البدء"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"تاريخ الانتهاء"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"تاريخ الطلب"}),m==="pending"&&e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"الإجراء"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[U.map(x=>{var a,t,o;const i=(a=x.startsAt)!=null&&a.toDate?x.startsAt.toDate():new Date,r=(t=x.endsAt)!=null&&t.toDate?x.endsAt.toDate():(()=>{const c=new Date;return x.planType==="monthly"?c.setMonth(c.getMonth()+1):x.planType==="quarterly"?c.setMonth(c.getMonth()+3):x.planType==="half_yearly"?c.setMonth(c.getMonth()+6):x.planType==="yearly"?c.setFullYear(c.getFullYear()+1):x.planType==="lifetime"&&c.setFullYear(c.getFullYear()+100),c})();return e.jsxs("tr",{children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.userName}),e.jsx("div",{className:"text-xs text-gray-500",children:x.userEmail})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:x.requestedCount}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Dt(x.planType)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:i.toLocaleDateString("ar-EG")}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:r.toLocaleDateString("ar-EG")}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:(o=x.createdAt)!=null&&o.toDate?x.createdAt.toDate().toLocaleString("ar-EG"):"الآن"}),e.jsxs("td",{className:"px-4 py-3 flex gap-2",children:[m==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>u(x),className:"bg-green-100 text-green-700 px-3 py-1 rounded text-xs font-medium hover:bg-green-200",children:"موافقة"}),e.jsx("button",{onClick:()=>d(x),className:"bg-red-100 text-red-700 px-3 py-1 rounded text-xs font-medium hover:bg-red-200",children:"رفض"})]}),e.jsx("button",{onClick:()=>s(x),className:"bg-gray-100 text-gray-700 px-3 py-1 rounded text-xs font-medium hover:bg-gray-200",children:"حذف"})]})]},x.id)}),U.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:["لا توجد طلبات ",m==="pending"?"معلقة":"مفعلة"]})})]})]})})]})]})},tl=({adminId:R})=>{const[U,v]=M.useState([]),[w,_]=M.useState(!0),[m,b]=M.useState("pending"),l=async()=>{_(!0);try{const x=m==="pending"?"pending":"approved",i=He(Se(he,"simCardRequests"),ut("status","==",x)),a=(await qe(i)).docs.map(t=>({id:t.id,...t.data()}));a.sort((t,o)=>{var h,y;const c=((h=t.createdAt)==null?void 0:h.seconds)||0;return(((y=o.createdAt)==null?void 0:y.seconds)||0)-c}),v(a)}catch(x){console.error(x)}finally{_(!1)}};M.useEffect(()=>{l()},[m]);const u=async x=>{if(window.confirm(`هل أنت متأكد من الموافقة على طلب ${x.email} لباقة ${x.plan}؟`))try{const i=je(he,"users",x.userId),r=new Date;let a=new Date;x.plan==="monthly"?a.setMonth(r.getMonth()+1):x.plan==="quarterly"?a.setMonth(r.getMonth()+3):x.plan==="yearly"?a.setFullYear(r.getFullYear()+1):x.plan==="lifetime"&&a.setFullYear(r.getFullYear()+100),await Fe(i,{simSubscription:{active:!0,plan:x.plan,startsAt:r,endsAt:a}}),await Fe(je(he,"simCardRequests",x.id),{status:"approved",approvedBy:R,approvedAt:pt(),startsAt:r,endsAt:a}),alert("تم الموافقة على الطلب وتفعيل اشتراك الخطوط"),l()}catch(i){console.error(i),alert("حدث خطأ أثناء الموافقة")}},s=async x=>{if(window.confirm("هل أنت متأكد من حذف هذا الطلب؟ "+(x.status==="approved"?"سيتم إلغاء تفعيل الباقة للمستخدم.":"")))try{if(x.status==="approved"){const i=je(he,"users",x.userId);await Fe(i,{"simSubscription.active":!1})}await xt(je(he,"simCardRequests",x.id)),alert("تم حذف الطلب وإلغاء التفعيل إن وجد"),l()}catch(i){console.error(i),alert("حدث خطأ أثناء الحذف")}},d=async x=>{if(window.confirm("هل أنت متأكد من رفض الطلب؟"))try{await Fe(je(he,"simCardRequests",x.id),{status:"rejected",rejectedBy:R,rejectedAt:pt()}),l()}catch(i){console.error(i),alert("حدث خطأ أثناء الرفض")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4 border-b border-gray-200 pb-2",children:[e.jsx("button",{onClick:()=>b("pending"),className:`px-4 py-2 font-medium text-sm rounded-lg transition-colors ${m==="pending"?"bg-blue-100 text-blue-700":"text-gray-500 hover:bg-gray-100"}`,children:"الحسابات غير المفعله"}),e.jsx("button",{onClick:()=>b("approved"),className:`px-4 py-2 font-medium text-sm rounded-lg transition-colors ${m==="approved"?"bg-green-100 text-green-700":"text-gray-500 hover:bg-gray-100"}`,children:"الحسابات المفعله"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:m==="pending"?"طلبات خطوط بانتظار الموافقة":"طلبات الخطوط المفعله"}),e.jsx("button",{onClick:l,className:"p-1.5 text-gray-500 hover:bg-gray-100 rounded-full",children:e.jsx(Jn,{className:`w-4 h-4 ${w?"animate-spin":""}`})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"المستخدم"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"الباقة"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"تاريخ البدء"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"تاريخ الانتهاء"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"تاريخ الطلب"}),m==="pending"&&e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"الإجراء"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[U.map(x=>{var a,t,o;const i=(a=x.startsAt)!=null&&a.toDate?x.startsAt.toDate():new Date,r=(t=x.endsAt)!=null&&t.toDate?x.endsAt.toDate():(()=>{const c=new Date;return x.plan==="monthly"?c.setMonth(c.getMonth()+1):x.plan==="quarterly"?c.setMonth(c.getMonth()+3):x.plan==="yearly"?c.setFullYear(c.getFullYear()+1):x.plan==="lifetime"&&c.setFullYear(c.getFullYear()+100),c})();return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"text-xs text-gray-500",children:x.email})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:Dt(x.plan)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:i.toLocaleDateString("ar-EG")}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:r.toLocaleDateString("ar-EG")}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:(o=x.createdAt)!=null&&o.toDate?x.createdAt.toDate().toLocaleString("ar-EG"):"الآن"}),e.jsxs("td",{className:"px-4 py-3 flex gap-2",children:[m==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>u(x),className:"bg-green-100 text-green-700 px-3 py-1 rounded text-xs font-medium hover:bg-green-200",children:"موافقة"}),e.jsx("button",{onClick:()=>d(x),className:"bg-red-100 text-red-700 px-3 py-1 rounded text-xs font-medium hover:bg-red-200",children:"رفض"})]}),e.jsx("button",{onClick:()=>s(x),className:"bg-gray-100 text-gray-700 px-3 py-1 rounded text-xs font-medium hover:bg-gray-200",children:"إلغاء/حذف"})]})]},x.id)}),U.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:["لا توجد طلبات ",m==="pending"?"معلقة":"مفعلة"]})})]})]})})]})]})},rl=({navigate:R,auth:U,devMode:v,setDevMode:w,error:_,setError:m,authLoading:b,setAuthLoading:l,activeTab:u,setActiveTab:s,setNotificationCenterOpen:d,setNotificationSettings:x,setNotifications:i,notificationCount:r,setNotificationCount:a,users:t,setUsers:o,loading:c,setLoading:n,setEditingPlan:h,isSavingContent:y,setIsSavingContent:j,lastUpdateInfo:A,loadContentFromFirebase:D,saveContentToFirebase:z,refreshData:E})=>{var Ha,Ma,Wa;const[C,L]=M.useState(!0),[N,T]=M.useState(t||[]),[p,W]=M.useState(""),[X,Y]=M.useState(null),[oe,K]=M.useState({}),[ie,F]=M.useState(!1),[S,V]=M.useState(null),[H,ee]=M.useState({name:"",price:"",period:"",description:"",features:[]}),[ue,ge]=M.useState(!1),[q,ce]=M.useState(!1),[ve,pe]=M.useState(null),[Ee,Ne]=M.useState(!1),[g,Q]=M.useState({sound:!0}),[Z,I]=M.useState(!1),[B,P]=M.useState(null),[J,te]=M.useState([]),[$,ae]=M.useState(!1),[le,ne]=M.useState(void 0),[xe,we]=M.useState(""),[be,Ue]=M.useState(null),[ot,Ie]=M.useState(!1),Me=J.filter(f=>!((f==null?void 0:f.contacted)===!0||(f==null?void 0:f.status)==="contacted")),Ce=J.filter(f=>(f==null?void 0:f.contacted)===!0||(f==null?void 0:f.status)==="contacted"),[We,lt]=M.useState(""),[Ze,Gt]=M.useState(""),[Kt,mr]=M.useState(""),[Xt,Qt]=M.useState(""),[ct,vt]=M.useState(!1),[Gs,Ks]=M.useState(!1),pr=async f=>{try{await Fe(je(he,"waiting_list",f),{contacted:!0,status:"contacted",contactedAt:pt()})}catch(k){console.error("Failed to mark waiting item as contacted",k),alert("حدث خطأ أثناء تحديث الحالة إلى تم التواصل.")}},[_e,tt]=M.useState({}),[St,Hr]=M.useState(null),[It,Oe]=M.useState(null),[Ye,gr]=M.useState(null),[vr,Xs]=M.useState(!1),[Qs,Js]=M.useState(!1),[ea,ta]=M.useState(!1),[rt,Mr]=M.useState(""),[Rt,ui]=M.useState(""),[bt,hi]=M.useState(""),[fi,Wr]=M.useState(0),[mi,$r]=M.useState(0),[pi,Vr]=M.useState(0),[yt,br]=M.useState(""),[yr,ra]=M.useState(""),[wr,sa]=M.useState(""),[aa,na]=M.useState(""),[ia,oa]=M.useState(""),[la,ca]=M.useState(""),[_r,da]=M.useState(""),[xa,ua]=M.useState(""),[ha,fa]=M.useState(!1);M.useEffect(()=>{(async()=>{try{const{systemSettingsService:f}=await ke(async()=>{const{systemSettingsService:O}=await import("./index-DhbnydJl.js").then(G=>G.cR);return{systemSettingsService:O}},__vite__mapDeps([1,2]),import.meta.url),k=await f.getTelegramWorkerUrl();k&&ua(k)}catch{}})()},[]);const[jr,gi]=M.useState(!1),[Nr,wt]=M.useState("idle"),[ma,Tt]=M.useState(""),[Jt,qr]=M.useState(""),[er,Zr]=M.useState(!1),[pa,vi]=M.useState(!1),[zt,Ge]=M.useState("idle"),[ga,st]=M.useState(""),[nl,il]=M.useState(!1),[ol,ll]=M.useState(null),[cl,dl]=M.useState("monthly"),[bi,Yr]=M.useState(!1),[yi,wi]=M.useState(null),[xl,_i]=M.useState(de.MONTHLY),[ji,Cr]=M.useState(!1),[Er,Ni]=M.useState(null),[Gr,Ci]=M.useState(""),[va,Ei]=M.useState([]),[ba,ya]=M.useState(!1);M.useEffect(()=>{const f=c0(k=>{na(String((k==null?void 0:k.version)||"")),oa(String((k==null?void 0:k.downloadURL_64)||"")),ca(String((k==null?void 0:k.downloadURL_32)||"")),da(String((k==null?void 0:k.notes)||""))});return()=>{try{f()}catch{}}},[]),M.useEffect(()=>{const f=d0(k=>{Mr(String((k==null?void 0:k.version)||"")),br(String((k==null?void 0:k.url)||"")),qr(String((k==null?void 0:k.notes)||"")),Zr(!!(k!=null&&k.force))});return()=>{try{f()}catch{}}},[]),M.useEffect(()=>{ke(async()=>{const{getAppDownloads:f}=await import("./index-DhbnydJl.js").then(k=>k.cW);return{getAppDownloads:f}},__vite__mapDeps([1,2]),import.meta.url).then(({getAppDownloads:f})=>{f(!0).then(tt)})},[]);const Ai=async()=>{var G;if(Tt(""),!(U!=null&&U.currentUser)){wt("error"),Tt("يرجى تسجيل الدخول كأدمن قبل النشر");try{alert("يرجى تسجيل الدخول كأدمن قبل النشر")}catch{}return}const f=aa.trim(),k=ia.trim(),O=la.trim();if(!f){wt("error"),Tt("رقم الإصدار مطلوب");return}try{new URL(k)}catch{wt("error"),Tt("رابط 64-بت غير صالح (يجب أن يكون https://)");return}try{new URL(O)}catch{wt("error"),Tt("رابط 32-بت غير صالح (يجب أن يكون https://)");return}try{wt("publishing");const re=typeof window<"u"&&(window.electronAPI||typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("electron"));let se="";if(await p0({version:f,downloadURL_64:k,downloadURL_32:O,notes:_r.trim(),force:!!jr},U.currentUser.uid),re&&((G=window.electronAPI)!=null&&G.publishDesktopVersion)){const me=await U.currentUser.getIdToken(),Be={version:f,updateUrl64:k,updateUrli32:O,notes:_r.trim(),force:!!jr};se=await window.electronAPI.publishDesktopVersion(me,Be)}else se="";wt("done");try{localStorage.setItem("desktop_update_cache",JSON.stringify({version:f,downloadURL_64:k,downloadURL_32:O,notes:_r.trim(),force:!!jr}))}catch{}}catch(re){wt("error");const se=(re==null?void 0:re.message)||"فشل النشر: تأكد من الصلاحيات وحالة الاتصال";Tt(se);try{alert(se)}catch{}}},tr=f=>{const k=f==null?void 0:f.displayName;let O="";typeof k=="string"?O=k:k&&typeof k=="object"&&(O=(k.ar||k.en||"").toString()),!O&&typeof(f==null?void 0:f.email)=="string"&&(O=f.email);const G=String(O).trim().charAt(0);return G?G.toUpperCase():"؟"},Qe=f=>{const k=f==null?void 0:f.displayName;if(typeof k=="string"&&k.trim())return k.trim();if(k&&typeof k=="object"){const O=k.full_name||k.name||k.ar||k.en;if(typeof O=="string"&&O.trim())return O.trim()}return typeof(f==null?void 0:f.email)=="string"&&f.email.includes("@")?f.email.split("@")[0]:"غير محدد"},[Kr,wa]=M.useState(""),[Xr,_a]=M.useState(""),[ja,Na]=M.useState(""),[Ca,Ea]=M.useState(""),[Qr,Aa]=M.useState(""),[ka,Da]=M.useState(!1),[Ut,Jr]=M.useState(""),[Ke,Ba]=M.useState(24),[Fa,Sa]=M.useState("24"),[Ia,Ra]=M.useState(!1),[ul,Ta]=M.useState(!1),[Lt,es]=M.useState("active");M.useEffect(()=>{if(p){const f=p.toLowerCase(),k=t.filter(O=>(O.displayName||"").toLowerCase().includes(f)||(O.email||"").toLowerCase().includes(f)||(O.phone||"").includes(f));T(k)}else T(t)},[t,p]),M.useEffect(()=>{u==="trials"&&(async()=>{try{Ta(!0);const{FreeTrialService:f}=await ke(async()=>{const{FreeTrialService:O}=await import("./freeTrialService-u-lJSTVe.js");return{FreeTrialService:O}},__vite__mapDeps([6,1,2]),import.meta.url),k=await f.getTrialDurationHours();Ba(k),Sa(String(k))}catch(f){console.error("Failed to load trial duration",f)}finally{Ta(!1)}})()},[u]),M.useEffect(()=>{u==="application"&&(async()=>{try{const{getAppDownloads:f}=await ke(async()=>{const{getAppDownloads:O}=await import("./index-DhbnydJl.js").then(G=>G.cW);return{getAppDownloads:O}},__vite__mapDeps([1,2]),import.meta.url),k=await f();tt(k||{}),br((k==null?void 0:k.androidUrl)||""),ra((k==null?void 0:k.pcUrl)||""),sa((k==null?void 0:k.pc32Url)||"")}catch(f){console.error("Failed to load app downloads",f)}})()},[u]);const za=async()=>{ae(!0);try{const f=He(Se(he,"waiting_list")),O=(await qe(f)).docs.map(G=>({id:G.id,...G.data()})).sort((G,re)=>{var Be,Re,ze,De,$e,at;const se=((Re=(Be=G==null?void 0:G.createdAt)==null?void 0:Be.toMillis)==null?void 0:Re.call(Be))??((ze=G==null?void 0:G.createdAt)==null?void 0:ze.seconds)*1e3??0;return((($e=(De=re==null?void 0:re.createdAt)==null?void 0:De.toMillis)==null?void 0:$e.call(De))??((at=re==null?void 0:re.createdAt)==null?void 0:at.seconds)*1e3??0)-se});te(O)}catch(f){console.error("Failed to fetch waiting_list:",f)}finally{ae(!1)}};M.useEffect(()=>{u==="waitingList"&&za(),u==="branches"&&Ua()},[u]);const Ua=async()=>{try{const f=await an.getAllCodes();Ei(f)}catch(f){console.error("Error loading branch codes:",f)}},ki=async()=>{if(U.currentUser){ya(!0);try{await an.generateCode(U.currentUser.uid),await Ua(),alert("تم توليد كود تفعيل الفرع بنجاح")}catch(f){console.error("Error generating code:",f),alert("حدث خطأ أثناء توليد الكود")}finally{ya(!1)}}};M.useEffect(()=>{},[u]);const Di=async()=>{var f;if(!Kr.trim()||!Xr.trim()){alert("يرجى كتابة عنوان ورسالة الإشعار");return}try{Da(!0);const k=Qr.trim()?`user:${Qr.trim()}`:"global";await k0({title:Kr.trim(),message:Xr.trim(),audienceKey:k,createdBy:(f=U==null?void 0:U.currentUser)==null?void 0:f.uid,linkUrl:ja.trim()||void 0,actionText:Ca.trim()||void 0}),wa(""),_a(""),Na(""),Ea(""),Aa(""),alert("تم إرسال الإشعار بنجاح!")}catch(k){console.error("خطأ في إرسال الإشعار:",k),alert("حدث خطأ أثناء إرسال الإشعار")}finally{Da(!1)}},Bi=()=>{U!=null&&U.signOut&&U.signOut(),R("/admin/login")},Fi=hr.useCallback(f=>{wi(f),_i(de.MONTHLY),Yr(!0)},[]),La=hr.useCallback(async(f,k,O=null,G=null,re=null)=>{var se;try{console.log("Activating subscription for user:",f,"with plan:",k,"variant:",O,"dates:",{customStartDate:G,customEndDate:re});const me=((se=U==null?void 0:U.currentUser)==null?void 0:se.uid)||"admin-user-id";await Qn(f,k,me,O,G,re),console.log("✅ تم تفعيل الاشتراك بنجاح"),E&&E(!0)}catch(me){console.error("❌ خطأ في تفعيل الاشتراك:",me),alert("حدث خطأ في تفعيل الاشتراك. يرجى المحاولة مرة أخرى.")}},[U]),Oa=async f=>{try{console.log("Deactivating subscription for user:",f),await ei(f),console.log("✅ تم إلغاء تفعيل الاشتراك بنجاح"),E&&E(!0)}catch(k){console.error("❌ خطأ في إلغاء تفعيل الاشتراك:",k),alert("حدث خطأ في إلغاء تفعيل الاشتراك. يرجى المحاولة مرة أخرى.")}},Si=async f=>{var k;try{if(!window.confirm(`هل أنت متأكد من حذف هذا المستخدم نهائياً؟

سيتم حذف:
- حساب المستخدم
- جميع بياناته
- اشتراكه
- معاملاته
- محادثاته

هذا الإجراء لا يمكن التراجع عنه!`))return;console.log("بدء حذف المستخدم:",f);const G=((k=U==null?void 0:U.currentUser)==null?void 0:k.uid)||"unknown-admin";try{const se=await f0(m0,"deleteUserPermanently")({userId:f});console.log("استجابة دالة الحذف النهائي:",se),o(me=>me.filter(Be=>Be.id!==f)),T(me=>me.filter(Be=>Be.id!==f)),alert("تم حذف المستخدم نهائياً مع جميع بياناته وحساب المصادقة.");return}catch(re){console.warn("تعذر تنفيذ الحذف النهائي عبر Cloud Functions، سيتم استخدام الحذف المحلي المؤقت:",(re==null?void 0:re.message)||re)}{const re=[];try{await xt(je(he,"profiles",f)),console.log("تم حذف الملف الشخصي")}catch(se){console.error("خطأ في حذف الملف الشخصي:",se),re.push(`الملف الشخصي: ${(se==null?void 0:se.message)||se}`)}try{await xt(je(he,"users",f)),console.log("تم حذف وثيقة المستخدم من مجموعة users")}catch(se){console.error("خطأ في حذف وثيقة المستخدم من مجموعة users:",se),re.push(`users: ${(se==null?void 0:se.message)||se}`)}try{const se=He(Se(he,"transactions"),ut("userId","==",f)),me=await qe(se),Be=me.docs.map(De=>xt(De.ref)),Re=await Promise.allSettled(Be),ze=Re.filter(De=>De.status==="rejected");ze.length?(console.warn("فشل حذف بعض المعاملات:",ze.length),re.push(`المعاملات: فشل حذف ${ze.length} من أصل ${Re.length}`)):console.log(`تم حذف ${me.size} معاملة`)}catch(se){console.error("خطأ في جلب/حذف المعاملات:",se),re.push(`المعاملات: ${(se==null?void 0:se.message)||se}`)}try{const se=He(Se(he,"chatRooms"),ut("participants","array-contains",f)),me=await qe(se),Be=me.docs.map(async Re=>{try{const De=(await qe(Se(Re.ref,"messages"))).docs.map($e=>xt($e.ref));await Promise.allSettled(De),await xt(Re.ref)}catch(ze){console.error("فشل حذف محادثة/رسائل:",ze),re.push(`المحادثات: ${Re.id}`)}});await Promise.all(Be),console.log(`تم إنهاء معالجة ${me.size} محادثة`)}catch(se){console.error("خطأ في جلب/حذف المحادثات:",se),re.push(`المحادثات: ${(se==null?void 0:se.message)||se}`)}try{await qs(je(he,"deletedUsers",f),{deletedAt:new Date,deletedBy:G,reason:"حذف نهائي من لوحة الإدارة"})}catch(se){console.error("خطأ في تسجيل المستخدم كمحذوف:",se),re.push(`deletedUsers: ${(se==null?void 0:se.message)||se}`)}o(se=>se.filter(me=>me.id!==f)),T(se=>se.filter(me=>me.id!==f)),re.length===0?alert("تم حذف بيانات المستخدم محلياً بنجاح. ملاحظة: حساب المصادقة لم يُحذف."):alert(`تم حذف المستخدم مع ملاحظات:
- ${re.join(`
- `)}

بعض الموارد قد لم تُحذف بالكامل. يمكنك إعادة المحاولة لاحقًا.`)}}catch(O){console.error("❌ خطأ في حذف المستخدم:",O),alert(`حدث خطأ في حذف المستخدم: ${O.message||"خطأ غير معروف"}`)}};M.useEffect(()=>{(async()=>{try{if(typeof D=="function"){const k=await D();k&&(k.monthly||k.yearly||k.lifetime)&&K(k)}}catch(k){console.warn("Failed to load content data:",k)}})()},[]);const Ii=async()=>{var f;try{if(typeof z!="function")return;j(!0);const k=((f=U==null?void 0:U.currentUser)==null?void 0:f.uid)||"admin-user-id";await z(oe,k),alert("تم حفظ جميع التغييرات بنجاح")}catch(k){console.error("❌ خطأ في حفظ المحتوى:",k),alert(`فشل في حفظ المحتوى: ${(k==null?void 0:k.message)||"خطأ غير معروف"}`)}finally{j(!1)}},Ar=(f,k,O)=>{K(G=>({...G,[f]:{...(G==null?void 0:G[f])||{},[k]:O}}))},Ri=f=>{K(k=>{var O;return{...k,[f]:{...(k==null?void 0:k[f])||{},features:[...((O=k==null?void 0:k[f])==null?void 0:O.features)||[],""]}}})},Ti=(f,k,O)=>{K(G=>{var se;const re=[...((se=G==null?void 0:G[f])==null?void 0:se.features)||[]];return re[k]=O,{...G,[f]:{...(G==null?void 0:G[f])||{},features:re}}})},zi=(f,k)=>{K(O=>{var re;const G=[...((re=O==null?void 0:O[f])==null?void 0:re.features)||[]];return G.splice(k,1),{...O,[f]:{...(O==null?void 0:O[f])||{},features:G}}})},Ui=()=>{Q(f=>({...f,sound:!f.sound}))},Li=()=>{P(null)},Oi=async()=>{try{const f=Number(Fa);if(isNaN(f)||f<1){alert("يرجى إدخال مدة صحيحة بالساعات");return}Ra(!0);const{FreeTrialService:k}=await ke(async()=>{const{FreeTrialService:G}=await import("./freeTrialService-u-lJSTVe.js");return{FreeTrialService:G}},__vite__mapDeps([6,1,2]),import.meta.url),O=await k.updateTrialDurationHours(f);O.success?(Ba(f),alert(O.message)):alert(O.message||"فشل تحديث مدة التجربة")}catch(f){console.error("Error updating trial duration:",f),alert("حدث خطأ أثناء تحديث مدة التجربة")}finally{Ra(!1)}},Pa=async f=>{try{const{FreeTrialService:k}=await ke(async()=>{const{FreeTrialService:G}=await import("./freeTrialService-u-lJSTVe.js");return{FreeTrialService:G}},__vite__mapDeps([6,1,2]),import.meta.url),O=await k.startFreeTrialFromAdmin(f);alert(O.message||`تم تفعيل التجربة المجانية لمدة ${Ke} ${Ke>=3&&Ke<=10?"ساعات":Ke===2?"ساعتين":"ساعة"}`),E&&E()}catch(k){console.error("Error activating free trial:",k),alert("حدث خطأ أثناء تفعيل التجربة المجانية. يرجى المحاولة مرة أخرى.")}},Pi=async f=>{try{const{FreeTrialService:k}=await ke(async()=>{const{FreeTrialService:G}=await import("./freeTrialService-u-lJSTVe.js");return{FreeTrialService:G}},__vite__mapDeps([6,1,2]),import.meta.url),O=await k.cancelActiveFreeTrial(f);E&&E(!0)}catch(k){console.error("Error cancelling free trial:",k)}},Hi=async f=>{try{const{FreeTrialService:k}=await ke(async()=>{const{FreeTrialService:G}=await import("./freeTrialService-u-lJSTVe.js");return{FreeTrialService:G}},__vite__mapDeps([6,1,2]),import.meta.url),O=await k.resetActiveTrialToCurrentDuration(f);alert(O.message)}catch(k){console.error("Error resetting user trial end:",k),alert("حدث خطأ أثناء تحديث نهاية التجربة.")}},Mi=(f,k)=>{console.log("Toggling user status:",f,k)},ts=f=>f?(f.toDate?f.toDate():new Date(f)).toLocaleDateString("ar-EG",{year:"numeric",month:"2-digit",day:"2-digit"}):"غير محدد",Wi=[{id:"users",label:"المستخدمين",icon:sr},{id:"reseller",label:"الريسيلر",icon:sr},{id:"subscriptions",label:"مواعيد الاشتراكات",icon:Je},{id:"trials",label:"إدارة التجارب المجانية",icon:ft},{id:"content",label:"إدارة المحتوى",icon:u0},{id:"application",label:"التطبيق",icon:ar},{id:"whatsapp",label:"إدارة الواتساب",icon:Sr},{id:"branches",label:"باقات الفروع",icon:rn},{id:"cashierRequests",label:"طلبات الكاشير",icon:sr},{id:"simCardRequests",label:"طلبات الخطوط",icon:ar},{id:"analytics",label:"الإحصائيات",icon:en}];return b?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"جاري التحقق من المصادقة..."}),!1]})}):_?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center bg-white p-8 rounded-lg shadow-lg max-w-md w-full",children:[e.jsx("div",{className:"text-red-600 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"حدث خطأ في لوحة التحكم"}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-700 text-sm font-medium",children:_})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>{m(null),R("/admin/login")},className:"w-full bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"🔑 العودة لتسجيل الدخول"}),!1,e.jsx("button",{onClick:()=>{console.log("🔍 Current error details:",_),console.log("🔍 Auth state:",U.currentUser),console.log("🔍 Dev mode:",v),console.log("🔍 Environment:",Qo)},className:"w-full bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors text-sm",children:"🐛 طباعة تفاصيل الخطأ في وحدة التحكم"})]})]})}):!v&&!U.currentUser?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center bg-white p-8 rounded-lg shadow-lg max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"لوحة تحكم المدير"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"يجب تسجيل الدخول للوصول إلى لوحة التحكم"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>R("/admin/login"),className:"w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"🔑 تسجيل الدخول"}),!1]})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col md:flex-row overflow-x-hidden",children:[e.jsxs("div",{className:`bg-white shadow-lg transition-all duration-300 flex flex-col z-40 ${C?"translate-x-0 w-64 md:w-64":"translate-x-full w-64 md:w-16 md:translate-x-0"} fixed inset-y-0 right-0 md:static md:inset-auto`,children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[C&&e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(x0,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"لوحة الإدارة"}),e.jsx("p",{className:"text-sm text-gray-500",children:"نظام التحكم"})]})]}),e.jsx("button",{onClick:()=>L(!C),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:C?e.jsx(mt,{className:"w-5 h-5"}):e.jsx(W0,{className:"w-5 h-5"})})]})}),e.jsx("nav",{className:"flex-1 p-4 overflow-y-auto",children:e.jsx("ul",{className:"space-y-2",children:Wi.map(f=>{const k=f.icon;return e.jsx("li",{children:e.jsxs("button",{onClick:()=>{if(f.id==="externalNotifications"){R("/admin/notifications");return}s(f.id)},className:`w-full flex items-center space-x-3 space-x-reverse p-3 rounded-lg transition-colors ${u===f.id?"bg-gradient-to-r from-purple-600 to-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(k,{className:"w-5 h-5"}),C&&e.jsx("span",{className:"font-medium",children:f.label})]})},f.id)})})}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs("button",{onClick:Bi,className:"w-full flex items-center space-x-3 space-x-reverse p-3 rounded-lg text-red-600 hover:bg-red-50 transition-colors",children:[e.jsx(h0,{className:"w-5 h-5"}),C&&e.jsx("span",{className:"font-medium",children:"تسجيل الخروج"})]})})]}),C&&e.jsx("div",{className:"fixed inset-0 bg-black/30 md:hidden",onClick:()=>L(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[!C&&e.jsx("button",{className:"md:hidden p-2 rounded-lg hover:bg-gray-100",onClick:()=>L(!0),"aria-label":"فتح القائمة",children:e.jsx(ss,{className:"w-5 h-5"})}),e.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:[u==="users"&&"إدارة المستخدمين",u==="reseller"&&"إدارة الريسيلر",u==="waitingList"&&"قائمة الانتظار",u==="subscriptions"&&"مواعيد الاشتراكات",u==="trials"&&"إدارة التجارب المجانية",u==="application"&&"إدارة التطبيق",u==="analytics"&&"الإحصائيات",u==="branches"&&"باقات الفروع",u==="cashierRequests"&&"طلبات الكاشير",u==="backup"&&"النسخ الاحتياطي والاستعادة"]}),v&&e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full",children:"🔧 وضع التطوير"})]}),e.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["مرحباً، ",v?"المطور":"المدير"]}),e.jsx(N0,{})]})]})}),e.jsxs("main",{className:"flex-1 p-3 sm:p-4 md:p-6 max-w-full overflow-x-hidden",children:[u==="reseller"&&e.jsx(vo,{}),u==="cashierRequests"&&e.jsx(el,{adminId:((Ha=U==null?void 0:U.currentUser)==null?void 0:Ha.uid)||"admin"}),u==="simCardRequests"&&e.jsx(tl,{adminId:((Ma=U==null?void 0:U.currentUser)==null?void 0:Ma.uid)||"admin"}),u==="backup"&&e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(Xo,{})}),u==="waitingList"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"طلبات قائمة الانتظار"}),e.jsx("button",{onClick:za,className:"p-1.5 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",title:"تحديث القائمة",disabled:$,children:e.jsx(dr,{className:`w-4 h-4 ${$?"animate-spin":""}`})})]}),e.jsx("div",{className:"text-sm text-gray-500 flex items-center gap-3",children:$?"جاري التحميل...":e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["إجمالي: ",J.length]}),e.jsxs("span",{className:"text-red-600",children:["قيد الانتظار: ",Me.length]}),e.jsxs("span",{className:"text-green-600",children:["تم التواصل: ",Ce.length]})]})})]}),e.jsx("div",{className:"overflow-x-auto",children:$?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"جاري تحميل الطلبات..."})]}):J.length===0?e.jsx("div",{className:"p-8 text-center text-gray-600",children:"لا توجد طلبات في قائمة الانتظار حالياً"}):e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"الاسم"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"المعرف"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"سبب الطلب"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"رقم الواتساب"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"الإجراء"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"تاريخ الإنشاء"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Me.map(f=>{var me;const k=(f.phone||"").toString(),O=k.replace(/\D/g,"");let G=null;const re="مرحباً، طلبت التحدث معنا. كيف نساعدك؟";try{Gn(k)&&(G=Yn(k,re))}catch{G=null}const se=(me=f.createdAt)!=null&&me.toDate?f.createdAt.toDate():f.createdAt?new Date(f.createdAt):null;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-800",children:f.name||"غير محدد"}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-500",children:f.userId||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:f.reason||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:O||"—"}),e.jsxs("td",{className:"px-4 py-3 flex items-center gap-2",children:[G?e.jsx("a",{href:G,target:"_blank",rel:"noopener noreferrer",children:e.jsx("button",{className:"px-3 py-1.5 rounded-md bg-green-600 text-white text-sm hover:bg-green-700",children:"واتساب"})}):e.jsx("span",{className:"text-xs text-gray-400",children:"لا يوجد رقم"}),e.jsx("button",{className:"px-3 py-1.5 rounded-md bg-indigo-600 text-white text-sm hover:bg-indigo-700",onClick:()=>pr(f.id),title:"تمييز كتم التواصل",children:"تم التواصل"})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:se?se.toLocaleString("ar-EG"):"غير محدد"})]},f.id)})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"تم التواصل"}),e.jsx("div",{className:"text-sm text-gray-500",children:Ce.length})]}),e.jsx("div",{className:"overflow-x-auto",children:Ce.length===0?e.jsx("div",{className:"p-8 text-center text-gray-600",children:"لا يوجد عناصر في قسم تم التواصل"}):e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"الاسم"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"المعرف"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"سبب الطلب"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"رقم الواتساب"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"الحالة"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500",children:"تاريخ التواصل"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ce.map(f=>{var re;const O=(f.phone||"").toString().replace(/\D/g,""),G=(re=f.contactedAt)!=null&&re.toDate?f.contactedAt.toDate():f.contactedAt?new Date(f.contactedAt):null;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-800",children:f.name||"غير محدد"}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-500",children:f.userId||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:f.reason||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:O||"—"}),e.jsx("td",{className:"px-4 py-3 text-xs",children:e.jsx("span",{className:"px-2 py-1 rounded-full bg-green-100 text-green-700",children:"تم التواصل"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:G?G.toLocaleString("ar-EG"):"غير محدد"})]},f.id)})})]})})]})]}),u==="users"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"إجمالي المستخدمين"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:t.length})]}),e.jsx(sr,{className:"w-8 h-8 text-blue-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"معرف المستخدم (اختياري)"}),e.jsx("input",{type:"text",value:Qr,onChange:f=>Aa(f.target.value),placeholder:"ضع uid الخاص بالمستخدم لاستهداف إشعار شخصي",className:"w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"اتركه فارغًا للإرسال العام؛ إن وضعته سيتم إرسال الإشعار لهذا المستخدم فقط."})]})]}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"المستخدمين النشطين"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(f=>f.isActive).length})]}),e.jsx(Ws,{className:"w-8 h-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"المستخدمين المعطلين"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:t.filter(f=>!f.isActive).length})]}),e.jsx(Y0,{className:"w-8 h-8 text-red-600"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"قائمة المستخدمين"}),e.jsxs("div",{className:"relative",children:[e.jsx(Et,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"البحث عن مستخدم...",value:p,onChange:f=>W(f.target.value),className:"pr-10 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm"})]})]}),p&&e.jsxs("div",{className:"text-sm text-gray-600",children:["عرض ",N.length," من أصل ",t.length," مستخدم",p&&e.jsx("button",{onClick:()=>W(""),className:"mr-2 text-purple-600 hover:text-purple-800 underline",children:"مسح البحث"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:c?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"جاري تحميل البيانات..."})]}):N.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:p?"لا توجد نتائج للبحث":"لا توجد بيانات مستخدمين"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(f=>e.jsx(ho,{user:f,onActivateSubscription:(k,O,G,re)=>La(k,O,null,G,re),onRequestActivation:Fi,onToggleUserStatus:Mi,onDeactivateSubscription:Oa,onDeleteUser:Si,onUpdateSessionLimit:async(k,O)=>{try{const G=je(he,"users",k),re={sessionLimitDisabled:O.sessionLimitDisabled,updatedAt:new Date};O.sessionLimit===null?re.sessionLimit=null:re.sessionLimit=O.sessionLimit,await Fe(G,re),o(se=>se.map(me=>me.id===k?{...me,...re}:me)),alert("تم تحديث حد الأجهزة للمستخدم")}catch(G){console.error("update session limit error:",G),alert("حدث خطأ أثناء تحديث حد الأجهزة")}}},f.id))})})]})]}),u==="application"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(ar,{className:"w-5 h-5 text-green-600"})," إدارة تطبيق الأندرويد"]}),(_e==null?void 0:_e.androidUrl)&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["الرابط الحالي: ",e.jsx("a",{href:Pt(_e.androidUrl),className:"text-blue-600 underline",target:"_blank",rel:"noopener noreferrer",children:"تنزيل"}),_e.androidVersion?` | الإصدار: ${_e.androidVersion}`:""]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-6 items-start lg:items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ملف APK"}),e.jsx("input",{type:"file",accept:".apk",onChange:f=>{var k;return Hr(((k=f.target.files)==null?void 0:k[0])||null)},className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الإصدار (اختياري)"}),e.jsx("input",{type:"text",value:rt,onChange:f=>Mr(f.target.value),placeholder:"مثال: 1.0.3",className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{onClick:async()=>{var f,k;if(St)try{Xs(!0),Wr(0);const{uploadAppBinaryResumable:O}=await ke(async()=>{const{uploadAppBinaryResumable:re}=await import("./index-DhbnydJl.js").then(se=>se.cW);return{uploadAppBinaryResumable:re}},__vite__mapDeps([1,2]),import.meta.url),G=await O(St,"android",((f=U==null?void 0:U.currentUser)==null?void 0:f.uid)||"admin",rt||void 0,re=>Wr(re),3e5);tt(re=>({...re,androidUrl:G,androidVersion:rt||re.androidVersion})),await as({url:G,version:rt||void 0},((k=U==null?void 0:U.currentUser)==null?void 0:k.uid)||"admin")}catch(O){console.error("Android upload failed",O),alert(O!=null&&O.message?`فشل رفع تطبيق الأندرويد: ${O.message}`:"فشل رفع تطبيق الأندرويد")}finally{Xs(!1),Wr(0)}},disabled:vr||!St,className:"w-full sm:w-auto flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50",children:[e.jsx(Fr,{className:"w-4 h-4"}),vr?`جاري الرفع... ${fi}%`:"رفع تطبيق الأندرويد"]}),(_e==null?void 0:_e.androidUrl)&&e.jsxs("a",{href:Pt(_e.androidUrl),className:"w-full sm:w-auto text-center flex items-center justify-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Br,{className:"w-4 h-4"})," تنزيل الحالي"]})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-3 gap-3 lg:gap-4 items-start lg:items-end",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رابط مباشر لتطبيق الأندرويد (APK)"}),e.jsx("input",{type:"url",value:yt,onChange:f=>br(f.target.value),placeholder:"https://example.com/app-release.apk",className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:e.jsxs("button",{onClick:async()=>{var f,k;try{const{setAppDownloadLinks:O}=await ke(async()=>{const{setAppDownloadLinks:G}=await import("./index-DhbnydJl.js").then(re=>re.cW);return{setAppDownloadLinks:G}},__vite__mapDeps([1,2]),import.meta.url);await O({androidUrl:yt||void 0,androidVersion:rt||void 0},((f=U==null?void 0:U.currentUser)==null?void 0:f.uid)||"admin"),await as({url:yt||void 0,version:rt||void 0},((k=U==null?void 0:U.currentUser)==null?void 0:k.uid)||"admin"),tt(G=>({...G,androidUrl:yt||void 0,androidVersion:rt||(G==null?void 0:G.androidVersion)})),alert("تم حفظ رابط الأندرويد بنجاح")}catch(O){console.error("Failed to save android link",O),alert(O!=null&&O.message?`فشل حفظ الرابط: ${O.message}`:"فشل حفظ الرابط")}},className:"w-full sm:w-auto flex items-center gap-2 bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700",children:[e.jsx(Ht,{className:"w-4 h-4"})," حفظ الرابط"]})})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-3 gap-3 lg:gap-4 items-start lg:items-end",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ملاحظات الإصدار (اختياري)"}),e.jsx("input",{type:"text",value:Jt,onChange:f=>qr(f.target.value),placeholder:"مثال: إصلاحات وتحسينات",className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"كود الإصدار (Version Code)"}),e.jsx("input",{type:"number",value:We,onChange:f=>lt(f.target.value),placeholder:"رقم صحيح (مثال: 5)",className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:er,onChange:f=>Zr(f.target.checked)}),"تحديث إجباري"]})})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[e.jsx("button",{onClick:async()=>{if(st(""),!(U!=null&&U.currentUser)){Ge("error"),st("يرجى تسجيل الدخول كأدمن قبل النشر");try{alert("يرجى تسجيل الدخول كأدمن قبل النشر")}catch{}return}const f=rt.trim(),k=yt.trim();if(!f){Ge("error"),st("رقم الإصدار مطلوب");return}try{new URL(k)}catch{Ge("error"),st("رابط APK غير صالح (يجب أن يكون https://)");return}try{Ge("publishing");const O=We?parseInt(We,10):void 0;await as({version:f,url:k,notes:Jt.trim(),force:!!er,code:O},U.currentUser.uid),Ge("done");try{localStorage.setItem("android_update_cache",JSON.stringify({version:f,url:k,notes:Jt.trim(),force:!!er,code:O}))}catch{}alert("تم حفظ تحديث الأندرويد في قاعدة البيانات")}catch(O){Ge("error");const G=(O==null?void 0:O.message)||"فشل النشر: تأكد من الصلاحيات وحالة الاتصال";st(G);try{alert(G)}catch{}}},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"نشر تحديث الأندرويد"}),zt==="publishing"&&e.jsx("span",{className:"text-sm text-gray-600",children:"جاري النشر..."}),zt==="error"&&e.jsx("span",{className:"text-sm text-red-600",children:ga}),zt==="done"&&e.jsx("span",{className:"text-sm text-green-600",children:"تم النشر"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(tn,{className:"w-5 h-5 text-indigo-600"})," إدارة تطبيق الكمبيوتر (Windows) — 64 بت"]}),(_e==null?void 0:_e.pcUrl)&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["الرابط الحالي: ",e.jsx("a",{href:Pt(_e.pcUrl),className:"text-blue-600 underline",target:"_blank",rel:"noopener noreferrer",children:"تنزيل"}),_e.pcVersion?` | الإصدار: ${_e.pcVersion}`:""]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-6 items-start lg:items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ملف التطبيق (EXE/ZIP)"}),e.jsx("input",{type:"file",accept:".exe,.zip",onChange:f=>{var k;return Oe(((k=f.target.files)==null?void 0:k[0])||null)},className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الإصدار (اختياري)"}),e.jsx("input",{type:"text",value:Rt,onChange:f=>ui(f.target.value),placeholder:"مثال: 2.1.0",className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{onClick:async()=>{var f;if(It)try{Js(!0),$r(0);const{uploadAppBinaryResumable:k}=await ke(async()=>{const{uploadAppBinaryResumable:G}=await import("./index-DhbnydJl.js").then(re=>re.cW);return{uploadAppBinaryResumable:G}},__vite__mapDeps([1,2]),import.meta.url),O=await k(It,"pc",((f=U==null?void 0:U.currentUser)==null?void 0:f.uid)||"admin",Rt||void 0,G=>$r(G),3e5);tt(G=>({...G,pcUrl:O,pcVersion:Rt||G.pcVersion}))}catch(k){console.error("PC upload failed",k),alert(k!=null&&k.message?`فشل رفع تطبيق الكمبيوتر: ${k.message}`:"فشل رفع تطبيق الكمبيوتر")}finally{Js(!1),$r(0)}},disabled:Qs||!It,className:"w-full sm:w-auto flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[e.jsx(Fr,{className:"w-4 h-4"}),Qs?`جاري الرفع... ${mi}%`:"رفع تطبيق الكمبيوتر"]}),(_e==null?void 0:_e.pcUrl)&&e.jsxs("a",{href:Pt(_e.pcUrl),className:"w-full sm:w-auto text-center flex items-center justify-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Br,{className:"w-4 h-4"})," تنزيل نسخة 64 بت"]})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-3 gap-3 lg:gap-4 items-start lg:items-end",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رابط مباشر لتطبيق الكمبيوتر (EXE/ZIP)"}),e.jsx("input",{type:"url",value:yr,onChange:f=>ra(f.target.value),placeholder:"https://example.com/cashy-setup.exe",className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:async()=>{var f,k;try{const{setAppDownloadLinks:O,setDesktopUpdateInfo:G}=await ke(async()=>{const{setAppDownloadLinks:re,setDesktopUpdateInfo:se}=await import("./index-DhbnydJl.js").then(me=>me.cW);return{setAppDownloadLinks:re,setDesktopUpdateInfo:se}},__vite__mapDeps([1,2]),import.meta.url);await O({pcUrl:yr||void 0,pcVersion:Rt||void 0},((f=U==null?void 0:U.currentUser)==null?void 0:f.uid)||"admin"),await G({downloadURL_64:yr||void 0,version:Rt||void 0},((k=U==null?void 0:U.currentUser)==null?void 0:k.uid)||"admin"),tt(re=>({...re,pcUrl:yr||void 0,pcVersion:Rt||(re==null?void 0:re.pcVersion)})),alert("تم حفظ رابط الكمبيوتر بنجاح")}catch(O){console.error("Failed to save pc link",O),alert(O!=null&&O.message?`فشل حفظ الرابط: ${O.message}`:"فشل حفظ الرابط")}},className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700",children:[e.jsx(Ht,{className:"w-4 h-4"})," حفظ الرابط"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(tn,{className:"w-5 h-5 text-sky-600"})," إدارة تطبيق الكمبيوتر (Windows) — 32 بت"]}),(_e==null?void 0:_e.pc32Url)&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["الرابط الحالي: ",e.jsx("a",{href:Pt(_e.pc32Url),className:"text-blue-600 underline",target:"_blank",rel:"noopener noreferrer",children:"تنزيل"}),_e.pc32Version?` | الإصدار: ${_e.pc32Version}`:""]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-6 items-start lg:items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ملف التطبيق (EXE/ZIP)"}),e.jsx("input",{type:"file",accept:".exe,.zip",onChange:f=>{var k;return gr(((k=f.target.files)==null?void 0:k[0])||null)},className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الإصدار (اختياري)"}),e.jsx("input",{type:"text",value:bt,onChange:f=>hi(f.target.value),placeholder:"مثال: 2.1.0",className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{onClick:async()=>{var f,k;if(Ye)try{ta(!0),Vr(0);const{uploadAppBinaryResumable:O,setDesktopUpdateInfo:G}=await ke(async()=>{const{uploadAppBinaryResumable:se,setDesktopUpdateInfo:me}=await import("./index-DhbnydJl.js").then(Be=>Be.cW);return{uploadAppBinaryResumable:se,setDesktopUpdateInfo:me}},__vite__mapDeps([1,2]),import.meta.url),re=await O(Ye,"pc32",((f=U==null?void 0:U.currentUser)==null?void 0:f.uid)||"admin",bt||void 0,se=>Vr(se),3e5);await G({downloadURL_32:re,version:bt||void 0},((k=U==null?void 0:U.currentUser)==null?void 0:k.uid)||"admin"),tt(se=>({...se,pc32Url:re,pc32Version:bt||se.pc32Version}))}catch(O){console.error("PC32 upload failed",O),alert(O!=null&&O.message?`فشل رفع تطبيق 32 بت: ${O.message}`:"فشل رفع تطبيق 32 بت")}finally{ta(!1),Vr(0)}},disabled:ea||!Ye,className:"w-full sm:w-auto flex items-center gap-2 bg-sky-600 text-white px-4 py-2 rounded-lg hover:bg-sky-700 disabled:opacity-50",children:[e.jsx(Fr,{className:"w-4 h-4"}),ea?`جاري الرفع... ${pi}%`:"رفع تطبيق 32 بت"]}),(_e==null?void 0:_e.pc32Url)&&e.jsxs("a",{href:Pt(_e.pc32Url),className:"w-full sm:w-auto text-center flex items-center justify-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Br,{className:"w-4 h-4"})," تنزيل نسخة 32 بت"]})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-3 gap-3 lg:gap-4 items-start lg:items-end",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رابط مباشر لتطبيق الكمبيوتر نسخة 32 بت (EXE/ZIP)"}),e.jsx("input",{type:"url",value:wr,onChange:f=>sa(f.target.value),placeholder:"https://example.com/cashy-setup-ia32.exe",className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:async()=>{var f,k;try{const{setAppDownloadLinks:O,setDesktopUpdateInfo:G}=await ke(async()=>{const{setAppDownloadLinks:re,setDesktopUpdateInfo:se}=await import("./index-DhbnydJl.js").then(me=>me.cW);return{setAppDownloadLinks:re,setDesktopUpdateInfo:se}},__vite__mapDeps([1,2]),import.meta.url);await O({pc32Url:wr||void 0,pc32Version:bt||void 0},((f=U==null?void 0:U.currentUser)==null?void 0:f.uid)||"admin"),await G({downloadURL_32:wr||void 0,version:bt||void 0},((k=U==null?void 0:U.currentUser)==null?void 0:k.uid)||"admin"),tt(re=>({...re,pc32Url:wr||void 0,pc32Version:bt||(re==null?void 0:re.pc32Version)})),alert("تم حفظ رابط 32 بت بنجاح")}catch(O){console.error("Failed to save pc32 link",O),alert(O!=null&&O.message?`فشل حفظ الرابط: ${O.message}`:"فشل حفظ الرابط")}},className:"flex items-center gap-2 bg-sky-600 text-white px-4 py-2 rounded-lg hover:bg-sky-700",children:[e.jsx(Ht,{className:"w-4 h-4"})," حفظ الرابط"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(sn,{className:"w-5 h-5 text-indigo-600"})," إدارة تحديثات برنامج الكمبيوتر"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"إصدار موحّد مع روابط 64-بت و32-بت، وملاحظات وخيار التحديث الإجباري."})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الإصدار"}),e.jsx("input",{type:"text",value:aa,onChange:f=>na(f.target.value),className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"مثال: 1.4.0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رابط نسخة 64-بت"}),e.jsx("input",{type:"text",value:ia,onChange:f=>oa(f.target.value),className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"رابط المثبّت x64"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رابط نسخة 32-بت"}),e.jsx("input",{type:"text",value:la,onChange:f=>ca(f.target.value),className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"رابط المثبّت ia32"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ملاحظات التحديث"}),e.jsx("textarea",{value:_r,onChange:f=>da(f.target.value),className:"w-full p-2 border border-gray-300 rounded-md",rows:4,placeholder:"نص الملاحظات"})]}),e.jsx("div",{children:e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:jr,onChange:f=>gi(f.target.checked)}),"تحديث إجباري (لن يفتح التطبيق إلا بعد التحديث)"]})})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[e.jsx("button",{onClick:Ai,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-60",disabled:Nr==="publishing",children:"نشر التحديث"}),Nr==="publishing"&&e.jsx("span",{className:"text-sm text-gray-600",children:"جاري النشر..."}),Nr==="done"&&e.jsx("span",{className:"text-sm text-green-600",children:"تم النشر بنجاح"}),Nr==="error"&&e.jsx("span",{className:"text-sm text-red-600",children:"فشل النشر"}),ma&&e.jsx("span",{className:"text-sm text-red-600",children:ma})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(ar,{className:"w-5 h-5 text-emerald-600"})," إعداد إشعار تحديث تطبيق SMS Agent (Firestore)"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"يقرأه تطبيق SMS Agent عند الفتح ويعرض نافذة داخلية للتنزيل."})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الإصدار (Version Name)"}),e.jsx("input",{type:"text",value:rt,onChange:f=>Mr(f.target.value),className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"مثال: 1.0.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"كود الإصدار (Version Code)"}),e.jsx("input",{type:"number",value:We,onChange:f=>lt(f.target.value),className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"مثال: 5"})]}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رابط ملف APK المباشر"}),e.jsx("input",{type:"url",value:yt,onChange:f=>br(f.target.value),className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"https://example.com/sms-agent.apk"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ملاحظات التحديث"}),e.jsx("textarea",{value:Jt,onChange:f=>qr(f.target.value),className:"w-full p-2 border border-gray-300 rounded-md",rows:3,placeholder:"ما الجديد في هذا التحديث..."})]}),e.jsx("div",{children:e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:er,onChange:f=>Zr(f.target.checked)}),"تحديث إجباري"]})}),e.jsx("div",{children:e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:pa,onChange:f=>vi(f.target.checked)}),"إلغاء هذا التحديث (إخفاء النافذة للجميع)"]})})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[e.jsx("button",{onClick:async()=>{if(st(""),!(U!=null&&U.currentUser)){Ge("error"),st("يرجى تسجيل الدخول كأدمن قبل النشر");try{alert("يرجى تسجيل الدخول كأدمن قبل النشر")}catch{}return}const f=rt.trim(),k=yt.trim();if(!f){Ge("error"),st("رقم الإصدار مطلوب");return}try{new URL(k)}catch{Ge("error"),st("رابط APK غير صالح");return}try{Ge("publishing");const{setSmsAgentUpdateInfo:O}=await ke(async()=>{const{setSmsAgentUpdateInfo:re}=await import("./index-DhbnydJl.js").then(se=>se.cW);return{setSmsAgentUpdateInfo:re}},__vite__mapDeps([1,2]),import.meta.url),G=We?parseInt(We,10):void 0;await O({version:f,url:k,notes:Jt.trim(),force:!!er,code:G,cancelled:!!pa},U.currentUser.uid),Ge("done"),alert("تم نشر تحديث SMS Agent بنجاح")}catch(O){Ge("error");const G=(O==null?void 0:O.message)||"فشل النشر";st(G);try{alert(G)}catch{}}},className:"px-4 py-2 bg-emerald-600 text-white rounded-md hover:bg-emerald-700",children:"نشر تحديث SMS Agent"}),zt==="publishing"&&e.jsx("span",{className:"text-sm text-gray-600",children:"جاري النشر..."}),zt==="error"&&e.jsx("span",{className:"text-sm text-red-600",children:ga}),zt==="done"&&e.jsx("span",{className:"text-sm text-green-600",children:"تم النشر"})]})]})]}),u==="branches"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"أكواد تفعيل الفروع"}),e.jsx("p",{className:"text-sm text-gray-500",children:"توليد أكواد تستخدم لمرة واحدة لإضافة فروع جديدة"})]}),e.jsxs("button",{onClick:ki,disabled:ba,className:"flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 disabled:opacity-50",children:[e.jsx(ss,{className:"w-4 h-4"}),ba?"جاري التوليد...":"توليد كود جديد"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الكود"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المستخدم"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ التوليد"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الاستخدام"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"إجراءات"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[va.map(f=>{var k,O;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 font-mono",children:f.code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.isUsed?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:f.isUsed?"مستخدم":"نشط"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:f.isUsed&&f.usedBy?(()=>{const G=t.find(re=>re.id===f.usedBy);return G?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-900 font-medium",children:Qe(G)}),e.jsx("span",{className:"text-xs text-gray-500",children:G.email})]}):e.jsx("span",{className:"text-xs font-mono",children:f.usedBy})})():"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(k=f.createdAt)!=null&&k.toDate?f.createdAt.toDate().toLocaleString("ar-EG"):"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(O=f.usedAt)!=null&&O.toDate?f.usedAt.toDate().toLocaleString("ar-EG"):"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(f.code),alert("تم نسخ الكود")},className:"text-gray-400 hover:text-gray-600",title:"نسخ الكود",children:e.jsx(ai,{className:"w-4 h-4"})})})]},f.id||f.code)}),va.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:"لا توجد أكواد مولدة حالياً"})})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"طلبات باقات الفروع (بانتظار التفعيل)"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:t.filter(f=>{var k,O;return((k=f.branchPackage)==null?void 0:k.status)==="pending"||((O=f.branchPackage)==null?void 0:O.requested)}).length})]}),e.jsx(rn,{className:"w-8 h-8 text-purple-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"باقات الفروع المفعّلة"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(f=>{var k;return((k=f.branchPackage)==null?void 0:k.status)==="active"}).length})]}),e.jsx(ur,{className:"w-8 h-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"إجمالي حسابات باقات الفروع"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.filter(f=>{var k,O;return((k=f.branchPackage)==null?void 0:k.requested)||((O=f.branchPackage)==null?void 0:O.status)}).length})]}),e.jsx(sr,{className:"w-8 h-8 text-blue-600"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"قسم باقات الفروع"}),e.jsxs("div",{className:"relative",children:[e.jsx(Et,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"البحث عن حساب باقات الفروع...",value:p,onChange:f=>W(f.target.value),className:"pr-10 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm"})]})]}),p&&e.jsxs("div",{className:"text-sm text-gray-600",children:["عرض ",N.filter(f=>{var k,O;return((k=f.branchPackage)==null?void 0:k.requested)||((O=f.branchPackage)==null?void 0:O.status)}).length," من أصل ",t.filter(f=>{var k,O;return((k=f.branchPackage)==null?void 0:k.requested)||((O=f.branchPackage)==null?void 0:O.status)}).length," حساب",p&&e.jsx("button",{onClick:()=>W(""),className:"mr-2 text-purple-600 hover:text-purple-800 underline",children:"مسح البحث"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:c?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"جاري تحميل البيانات..."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4",children:(p?N:t).filter(f=>{var k,O;return((k=f.branchPackage)==null?void 0:k.requested)||((O=f.branchPackage)==null?void 0:O.status)}).map(f=>{var O,G,re,se,me,Be;const k=((O=f.branchPackage)==null?void 0:O.status)||((G=f.branchPackage)!=null&&G.requested?"pending":"none");return e.jsxs("div",{className:"border rounded-lg p-4 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-purple-600 font-semibold",children:tr(f)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800",children:Qe(f)}),e.jsx("p",{className:"text-sm text-gray-500",children:f.email}),((re=f.branchPackage)==null?void 0:re.requestedAt)&&e.jsxs("p",{className:"text-xs text-gray-400",children:["تاريخ الطلب: ",ts(f.branchPackage.requestedAt)]}),((se=f.branchPackage)==null?void 0:se.limit)&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["العدد المطلوب: ",e.jsx("span",{className:"font-bold",children:f.branchPackage.limit})]}),((me=f.branchPackage)==null?void 0:me.packageType)&&e.jsxs("p",{className:"text-sm text-gray-600",children:["نوع الباقة: ",e.jsx("span",{className:"font-bold",children:f.branchPackage.packageType==="basic"?"باقة أساسية":f.branchPackage.packageType==="quarterly"?"باقة ربع سنوية":f.branchPackage.packageType==="pro"?"باقة متقدمة":f.branchPackage.packageType==="enterprise"?"باقة شركات":f.branchPackage.packageType})]})]})]}),e.jsx(Jo,{userId:f.id,adminId:((Be=U==null?void 0:U.currentUser)==null?void 0:Be.uid)||"admin"}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${k==="active"?"bg-green-100 text-green-700":k==="pending"?"bg-yellow-100 text-yellow-700":k==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"}`,children:k==="active"?"مفعّل":k==="pending"?"بانتظار التفعيل":k==="rejected"?"مرفوض":"غير محدد"}),k==="active"&&e.jsx("button",{title:"إلغاء باقة الفروع",onClick:async()=>{var ze;if(window.confirm("هل تريد إلغاء تفعيل باقة الفروع لهذا الحساب؟ سيتم إيقاف جميع الفروع المرتبطة."))try{const{doc:De,updateDoc:$e,collection:at,getDocs:Ot}=await ke(async()=>{const{doc:Le,updateDoc:ht,collection:_t,getDocs:jt}=await import("./index-DhbnydJl.js").then(Nt=>Nt.cP);return{doc:Le,updateDoc:ht,collection:_t,getDocs:jt}},__vite__mapDeps([1,2]),import.meta.url),{db:rr}=await ke(async()=>{const{db:Le}=await import("./index-DhbnydJl.js").then(ht=>ht.cQ);return{db:Le}},__vite__mapDeps([1,2]),import.meta.url),kr=((ze=U==null?void 0:U.currentUser)==null?void 0:ze.uid)||"admin-user-id";await $e(De(rr,"users",f.id),{"branchPackage.status":"canceled","branchPackage.canceledAt":new Date,"branchPackage.canceledBy":kr,updatedAt:new Date});try{const Le=at(rr,"users",f.id,"branches"),_t=(await Ot(Le)).docs.map(async jt=>{const Nt=jt.data();if(Nt.branchUserId)try{await $e(De(rr,"users",Nt.branchUserId),{isActive:!1,"branchPackage.status":"canceled",updatedAt:new Date})}catch(rs){console.warn(`Failed to deactivate branch user ${Nt.branchUserId}`,rs)}});await Promise.all(_t)}catch(Le){console.error("Error fetching/deactivating branches:",Le)}alert("تم إلغاء باقة الفروع وتعطيل الفروع المرتبطة بنجاح")}catch(De){console.error("فشل في إلغاء باقة الفروع:",De),alert("حدث خطأ أثناء الإلغاء، حاول مرة أخرى")}},className:"p-1 rounded-md text-red-600 hover:bg-red-50",children:e.jsx(R0,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[k==="pending"&&e.jsx("button",{onClick:async()=>{if(window.confirm("هل أنت متأكد من رفض هذا الطلب؟"))try{const{doc:Re,updateDoc:ze}=await ke(async()=>{const{doc:$e,updateDoc:at}=await import("./index-DhbnydJl.js").then(Ot=>Ot.cP);return{doc:$e,updateDoc:at}},__vite__mapDeps([1,2]),import.meta.url),{db:De}=await ke(async()=>{const{db:$e}=await import("./index-DhbnydJl.js").then(at=>at.cQ);return{db:$e}},__vite__mapDeps([1,2]),import.meta.url);await ze(Re(De,"users",f.id),{"branchPackage.status":"rejected",updatedAt:new Date}),alert("تم رفض الطلب")}catch{alert("حدث خطأ")}},className:"px-3 py-1 text-sm rounded-md bg-red-100 text-red-600 hover:bg-red-200",children:"رفض"}),k!=="active"&&e.jsx("button",{onClick:async()=>{var Re,ze;try{const{doc:De,updateDoc:$e,setDoc:at}=await ke(async()=>{const{doc:_t,updateDoc:jt,setDoc:Nt}=await import("./index-DhbnydJl.js").then(rs=>rs.cP);return{doc:_t,updateDoc:jt,setDoc:Nt}},__vite__mapDeps([1,2]),import.meta.url),{db:Ot}=await ke(async()=>{const{db:_t}=await import("./index-DhbnydJl.js").then(jt=>jt.cQ);return{db:_t}},__vite__mapDeps([1,2]),import.meta.url),rr=((Re=U==null?void 0:U.currentUser)==null?void 0:Re.uid)||"admin-user-id",kr=new Date;let Le=new Date(kr);const ht=((ze=f.branchPackage)==null?void 0:ze.packageType)||"basic";ht==="quarterly"?Le.setMonth(Le.getMonth()+3):ht==="pro"?Le.setFullYear(Le.getFullYear()+1):ht==="enterprise"?Le=null:Le.setMonth(Le.getMonth()+1),await $e(De(Ot,"users",f.id),{"branchPackage.status":"active","branchPackage.activatedAt":kr,"branchPackage.endDate":Le,"branchPackage.activatedBy":rr,isActive:!0,approved:!0,role:"merchant",updatedAt:new Date}),await at(De(Ot,"profiles",f.id),{role:"merchant",approved:!0,updatedAt:new Date},{merge:!0}),alert("تم تفعيل باقة الفروع لهذا الحساب")}catch(De){console.error("فشل في تفعيل باقة الفروع:",De),alert("حدث خطأ أثناء التفعيل، حاول مرة أخرى")}},className:"px-3 py-1 text-sm rounded-md bg-purple-600 text-white hover:bg-purple-700",children:k==="rejected"?"إعادة تفعيل":"تفعيل الطلب"})]})]})]},f.id)})})})]})]}),u==="subscriptions"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"إجمالي الاشتراكات النشطة"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(f=>{var k;return(k=f.subscription)==null?void 0:k.isActive}).length})]}),e.jsx(ur,{className:"w-8 h-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"تنتهي خلال 7 أيام"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:t.filter(f=>{var se,me;if(!((se=f.subscription)!=null&&se.endDate)||!((me=f.subscription)!=null&&me.isActive))return!1;const k=f.subscription.endDate.toDate?f.subscription.endDate.toDate():new Date(f.subscription.endDate),O=new Date,G=k.getTime()-O.getTime(),re=Math.ceil(G/(1e3*60*60*24));return re<=7&&re>0}).length})]}),e.jsx(qt,{className:"w-8 h-8 text-orange-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"منتهية الصلاحية"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:t.filter(f=>{var O;return(O=f.subscription)!=null&&O.endDate?(f.subscription.endDate.toDate?f.subscription.endDate.toDate():new Date(f.subscription.endDate))<new Date:!1}).length})]}),e.jsx(it,{className:"w-8 h-8 text-red-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"اشتراكات مدى الحياة"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:t.filter(f=>{var k;return((k=f.subscription)==null?void 0:k.planType)===de.LIFETIME}).length})]}),e.jsx(xr,{className:"w-8 h-8 text-yellow-600"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"جدول مواعيد الاشتراكات"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"عرض جميع الاشتراكات النشطة مع تواريخ البداية والانتهاء"})]}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(Et,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"بحث في الاشتراكات...",value:Gr,onChange:f=>Ci(f.target.value),className:"w-full pr-10 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:c?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"جاري تحميل البيانات..."})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المستخدم"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"نوع الاشتراك"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ البداية"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الانتهاء"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الأيام المتبقية"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"إجراء"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.filter(f=>{var O,G;if(!((O=f.subscription)!=null&&O.planType))return!1;const k=((G=f.subscription)==null?void 0:G.isActive)===!1||(f==null?void 0:f.isActive)===!1;if(Gr){const re=Gr.trim().toLowerCase();if(re){const se=Qe(f).toLowerCase(),me=(f.email||"").toLowerCase();if(!se.includes(re)&&!me.includes(re))return!1}}return!k}).sort((f,k)=>{var re,se;if(!((re=f.subscription)!=null&&re.endDate)||!((se=k.subscription)!=null&&se.endDate))return 0;const O=f.subscription.endDate.toDate?f.subscription.endDate.toDate():new Date(f.subscription.endDate),G=k.subscription.endDate.toDate?k.subscription.endDate.toDate():new Date(k.subscription.endDate);return O.getTime()-G.getTime()}).map(f=>{const k=f.subscription;if(!k)return null;const O=k.startDate?k.startDate.toDate?k.startDate.toDate():new Date(k.startDate):null,G=k.endDate?k.endDate.toDate?k.endDate.toDate():new Date(k.endDate):null;let re=null,se="غير محدد";const me=(k==null?void 0:k.isActive)===!1||(f==null?void 0:f.isActive)===!1;if(me)se="ملغي";else if(k.planType===de.LIFETIME)se="مدى الحياة";else if(G){const Be=new Date,Re=G.getTime()-Be.getTime();re=Math.ceil(Re/(1e3*60*60*24)),re<0?se="منتهي":re<=7?se="ينتهي قريباً":se="نشط"}return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white font-medium text-sm",children:tr(f)})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:Qe(f)}),e.jsx("div",{className:"text-sm text-gray-500",children:f.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[k.planType===de.LIFETIME&&e.jsx(xr,{className:"w-4 h-4 text-yellow-500 ml-2"}),k.planType===de.YEARLY&&e.jsx(ft,{className:"w-4 h-4 text-blue-500 ml-2"}),k.planType===de.QUARTERLY&&e.jsx(Je,{className:"w-4 h-4 text-purple-500 ml-2"}),k.planType===de.MONTHLY&&e.jsx(fr,{className:"w-4 h-4 text-green-500 ml-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Dt(k.planType)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O?O.toLocaleDateString("ar-EG"):"غير محدد"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.planType===de.LIFETIME?"مدى الحياة":G?G.toLocaleDateString("ar-EG"):"غير محدد"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${se==="نشط"?"bg-green-100 text-green-800":se==="ينتهي قريباً"?"bg-orange-100 text-orange-800":se==="منتهي"||se==="ملغي"?"bg-red-100 text-red-800":se==="مدى الحياة"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:se})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:me?"ملغي":k.planType===de.LIFETIME?"∞":re!==null?re<0?"منتهي":`${re} يوم`:"غير محدد"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>{Ni(f),Cr(!0)},className:"px-3 py-1 text-sm rounded-md bg-red-600 text-white hover:bg-red-700",children:"الغاء"})})]},f.id)}).filter(Boolean)})]})})]})]}),u==="content"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"إدارة محتوى خطط الاشتراك"}),A&&A.lastUpdated&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["آخر تحديث: ",new Date(A.lastUpdated).toLocaleString("ar-SA"),A.updatedBy&&` بواسطة: ${A.updatedBy}`]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>{ge(!0),ee({name:"الباقة الربع سنوية",price:"250 جنيه",period:"كل 3 أشهر",description:"حل وسط بين الشهرية والسنوية",features:["إدارة محافظ متعددة","تقارير ربع سنوية"]}),V("quarterly"),F(!0)},className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:[e.jsx(ss,{className:"w-4 h-4"}),"إضافة باقة جديدة"]}),e.jsxs("button",{onClick:Ii,disabled:y,className:"flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 disabled:opacity-50",children:[e.jsx(Ht,{className:"w-4 h-4"}),y?"جاري الحفظ...":"حفظ جميع التغييرات"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:Object.entries(oe).map(([f,k])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[f==="monthly"&&e.jsx(fr,{className:"w-4 h-4 text-green-500"}),f==="quarterly"&&e.jsx(Je,{className:"w-4 h-4 text-purple-500"}),f==="yearly"&&e.jsx(ft,{className:"w-4 h-4 text-blue-500"}),f==="lifetime"&&e.jsx(xr,{className:"w-4 h-4 text-yellow-500"}),k.name]}),e.jsx("button",{onClick:()=>{Y(X===f?null:f),ge(!1),V(f),ee({...k,features:[...k.features||[]]}),F(!0)},className:"text-purple-600 hover:text-purple-800",children:e.jsx(T0,{className:"w-4 h-4"})})]}),X===f?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم الباقة"}),e.jsx("input",{type:"text",value:k.name,onChange:O=>Ar(f,"name",O.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"السعر"}),e.jsx("input",{type:"text",value:k.price,onChange:O=>Ar(f,"price",O.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"المدة"}),e.jsx("input",{type:"text",value:k.period,onChange:O=>Ar(f,"period",O.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الوصف"}),e.jsx("textarea",{value:k.description,onChange:O=>Ar(f,"description",O.target.value),rows:3,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"المميزات"}),e.jsx("button",{onClick:()=>Ri(f),className:"text-sm text-purple-600 hover:text-purple-800",children:"+ إضافة ميزة"})]}),e.jsx("div",{className:"space-y-2",children:k.features.map((O,G)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:O,onChange:re=>Ti(f,G,re.target.value),className:"flex-1 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm"}),e.jsx("button",{onClick:()=>zi(f,G),className:"text-red-500 hover:text-red-700",children:e.jsx(mt,{className:"w-4 h-4"})})]},G))})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:k.price}),e.jsx("div",{className:"text-sm text-gray-600",children:k.period}),e.jsx("div",{className:"text-sm text-gray-700",children:k.description}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"المميزات:"}),k.features.map((O,G)=>e.jsxs("div",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(ur,{className:"w-3 h-3 text-green-500"}),O]},G))]})]})]},f))})]}),ie&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold",children:ue?"إضافة باقة جديدة":`تعديل ${S==="monthly"?"الباقة الشهرية":S==="yearly"?"الباقة السنوية":S==="lifetime"?"باقة مدى الحياة":"باقة ربع سنوية"}`}),e.jsx("button",{onClick:()=>F(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(mt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم الباقة"}),e.jsx("input",{type:"text",value:H.name,onChange:f=>ee(k=>({...k,name:f.target.value})),className:"w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"السعر"}),e.jsx("input",{type:"text",value:H.price,onChange:f=>ee(k=>({...k,price:f.target.value})),className:"w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"المدة"}),e.jsx("input",{type:"text",value:H.period,onChange:f=>ee(k=>({...k,period:f.target.value})),className:"w-full p-2 border rounded-md"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الوصف"}),e.jsx("textarea",{rows:3,value:H.description,onChange:f=>ee(k=>({...k,description:f.target.value})),className:"w-full p-2 border rounded-md"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"المميزات"}),e.jsx("button",{onClick:()=>ee(f=>({...f,features:[...f.features||[],""]})),className:"text-sm text-purple-600 hover:text-purple-800",children:"+ إضافة ميزة"})]}),e.jsx("div",{className:"space-y-2",children:(H.features||[]).map((f,k)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:f,onChange:O=>{const G=O.target.value;ee(re=>{const se=[...re.features||[]];return se[k]=G,{...re,features:se}})},className:"flex-1 p-2 border rounded-md text-sm"}),e.jsx("button",{onClick:()=>{ee(O=>{const G=[...O.features||[]];return G.splice(k,1),{...O,features:G}})},className:"text-red-500 hover:text-red-700",children:e.jsx(mt,{className:"w-4 h-4"})})]},k))})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200",children:"إلغاء"}),e.jsx("button",{onClick:()=>{S&&(K(f=>({...f,[S]:{...H}})),F(!1))},className:"px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700",children:"حفظ داخل الصفحة"}),e.jsx("button",{onClick:async()=>{var f;if(S)try{const k=((f=U==null?void 0:U.currentUser)==null?void 0:f.uid)||"admin";await w0(S,H,k),K(O=>({...O,[S]:{...H}})),F(!1)}catch(k){console.error("Immediate save failed",k),alert("حدث خطأ أثناء الحفظ الفوري. حاول لاحقًا أو استخدم حفظ جميع التغييرات.")}},className:"px-4 py-2 rounded-md bg-purple-600 text-white hover:bg-purple-700",children:"حفظ فوري"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"إرسال إشعار للمستخدمين"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"سيظهر الإشعار كمودال صغير في منتصف الشاشة مع ضباب خفيف."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الإشعار"}),e.jsx("input",{type:"text",value:Kr,onChange:f=>wa(f.target.value),placeholder:"أدخل عنوانًا قصيرًا وجذابًا",className:"w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نص الإشعار"}),e.jsx("textarea",{value:Xr,onChange:f=>_a(f.target.value),placeholder:"اكتب محتوى الإشعار الذي سيظهر للمستخدمين",rows:4,className:"w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط اختياري"}),e.jsx("input",{type:"text",value:ja,onChange:f=>Na(f.target.value),placeholder:"مثال: /user/dashboard أو https://example.com",className:"w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"إذا كان الرابط خارجيًا سيفتح في نافذة جديدة، وإذا كان داخليًا سيتم التوجيه داخل الموقع."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نص زر الإجراء (اختياري)"}),e.jsx("input",{type:"text",value:Ca,onChange:f=>Ea(f.target.value),placeholder:"افتراضي: فتح الرابط",className:"w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsx("div",{className:"flex items-center justify-end gap-3",children:e.jsx("button",{onClick:Di,disabled:ka,className:"px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:ka?"جاري الإرسال...":"إرسال إشعار"})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(sn,{className:"w-5 h-5 text-slate-600"})," إعدادات النظام — Telegram/Cloudflare Worker"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"أدخل رابط الـ Worker المركزي. التوكن يبقى سر داخل Cloudflare Secrets."})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3 lg:gap-4 items-start lg:items-end",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رابط Cloudflare Worker"}),e.jsx("input",{type:"url",value:xa,onChange:f=>ua(f.target.value),placeholder:"https://summer-cake-5149.alkaptin2030.workers.dev",className:"w-full p-2 border border-gray-300 rounded-md"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:'تأكد أن المسار يدعم POST عند "/notify" أو الجذر حسب إعدادك.'})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:async()=>{try{fa(!0);const{systemSettingsService:f}=await ke(async()=>{const{systemSettingsService:O}=await import("./index-DhbnydJl.js").then(G=>G.cR);return{systemSettingsService:O}},__vite__mapDeps([1,2]),import.meta.url),k=(xa||"").trim();if(!k){alert("أدخل رابط صحيح");return}await f.setTelegramWorkerUrl(k),alert("تم حفظ رابط Cloudflare Worker بنجاح")}catch(f){console.error("Failed to save worker url",f),alert(f!=null&&f.message?`فشل حفظ الرابط: ${f.message}`:"فشل حفظ الرابط")}finally{fa(!1)}},className:"flex items-center gap-2 bg-slate-600 text-white px-4 py-2 rounded-lg hover:bg-slate-700 disabled:opacity-50",disabled:ha,children:[e.jsx(Ht,{className:"w-4 h-4"})," ",ha?"جاري الحفظ...":"حفظ الرابط"]})})]})]})]})]})]}),u==="trials"&&e.jsxs("div",{className:"space-y-6",children:[console.log("🔍 Trials tab rendering - users data:",t),console.log("🔍 Users count:",(t==null?void 0:t.length)||0),console.log("🔍 Users on trial:",((Wa=t==null?void 0:t.filter(f=>f.isOnFreeTrial))==null?void 0:Wa.length)||0),c&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"جاري تحميل بيانات المستخدمين..."})]})}),_&&!c&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[e.jsx(qt,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"خطأ في تحميل البيانات"}),e.jsx("p",{className:"text-red-600 mb-4",children:_}),e.jsx("p",{className:"text-sm text-red-500",children:"تأكد من اتصال الإنترنت وإعدادات Firebase"})]}),!c&&!_&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"المستخدمين في التجربة"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.filter(f=>f.isOnFreeTrial).length})]}),e.jsx(ft,{className:"w-8 h-8 text-blue-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"التجارب المنتهية"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:t.filter(f=>f.hasUsedFreeTrial&&!f.isOnFreeTrial).length})]}),e.jsx(it,{className:"w-8 h-8 text-red-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"المستخدمين المؤهلين"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(f=>!f.hasUsedFreeTrial&&!f.isOnFreeTrial&&!f.approved).length})]}),e.jsx(Ws,{className:"w-8 h-8 text-green-600"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"إعداد مدة التجربة المجانية"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"يتم تطبيق التغيير فورياً على أي تفعيل جديد."})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدة بالساعات"}),e.jsx("input",{type:"number",min:1,max:336,value:Fa,onChange:f=>Sa(f.target.value),className:"w-full px-4 py-2 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-blue-500 text-sm",placeholder:"اكتب عدد الساعات"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["المدة الحالية: ",Ke," ",Ke>=3&&Ke<=10?"ساعات":Ke===2?"ساعتين":"ساعة"]})]}),e.jsx("div",{className:"flex items-center md:justify-end",children:e.jsx("button",{onClick:Oi,disabled:Ia,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium disabled:opacity-50",children:Ia?"جاري التحديث...":"تحديث المدة"})})]})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 sm:gap-4 border-b border-gray-200 mb-6",children:[e.jsxs("button",{onClick:()=>es("eligible"),className:`pb-2 px-4 text-sm font-medium transition-colors relative whitespace-nowrap ${Lt==="eligible"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["المؤهلين للتجربة",e.jsx("span",{className:"mr-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs",children:t.filter(f=>!f.hasUsedFreeTrial&&!f.isOnFreeTrial&&!f.approved).length})]}),e.jsxs("button",{onClick:()=>es("active"),className:`pb-2 px-4 text-sm font-medium transition-colors relative whitespace-nowrap ${Lt==="active"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["التجارب النشطة",e.jsx("span",{className:"mr-2 bg-blue-100 text-blue-600 py-0.5 px-2 rounded-full text-xs",children:t.filter(f=>f.isOnFreeTrial).length})]}),e.jsxs("button",{onClick:()=>es("expired"),className:`pb-2 px-4 text-sm font-medium transition-colors relative whitespace-nowrap ${Lt==="expired"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["التجارب المنتهية",e.jsx("span",{className:"mr-2 bg-red-100 text-red-600 py-0.5 px-2 rounded-full text-xs",children:t.filter(f=>f.hasUsedFreeTrial&&!f.isOnFreeTrial).length})]})]}),Lt==="eligible"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"المستخدمين المؤهلين للتجربة المجانية"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"المستخدمين الذين لم يستخدموا التجربة المجانية من قبل"}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:Ut,onChange:f=>Jr(f.target.value),placeholder:"ابحث بالاسم أو البريد في المؤهلين للتجربة",className:"w-full px-4 py-2 pl-10 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-blue-500 text-sm"}),e.jsx(Et,{className:"w-4 h-4 text-gray-400 absolute left-3 top-2.5"})]})})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[t.filter(f=>!f.hasUsedFreeTrial&&!f.isOnFreeTrial&&!f.approved).filter(f=>{const k=Ut.trim().toLowerCase();if(!k)return!0;const O=Qe(f).toLowerCase(),G=(f.email||"").toLowerCase();return O.includes(k)||G.includes(k)}).map(f=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold",children:tr(f)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800",children:Qe(f)}),e.jsx("p",{className:"text-sm text-gray-500",children:f.email}),e.jsxs("p",{className:"text-xs text-gray-400",children:["تاريخ التسجيل: ",ts(f.createdAt)]})]})]}),e.jsx("div",{className:"flex items-center space-x-3 space-x-reverse",children:e.jsx("button",{onClick:()=>Pa(f.id),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:`تفعيل التجربة ${Ke} ${Ke>=3&&Ke<=10?"ساعات":Ke===2?"ساعتين":"ساعة"}`})})]},f.id)),t.filter(f=>!f.hasUsedFreeTrial&&!f.isOnFreeTrial&&!f.approved).length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ft,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"لا يوجد مستخدمين مؤهلين للتجربة المجانية حالياً"})]})]})})]}),Lt==="active"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"المستخدمين في التجربة المجانية"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"المستخدمين الذين يستخدمون التجربة المجانية حالياً"}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:Ut,onChange:f=>Jr(f.target.value),placeholder:"ابحث بالاسم أو البريد في التجارب المجانية",className:"w-full px-4 py-2 pl-10 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-blue-500 text-sm"}),e.jsx(Et,{className:"w-4 h-4 text-gray-400 absolute left-3 top-2.5"})]})})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[t.filter(f=>f.isOnFreeTrial).filter(f=>{const k=Ut.trim().toLowerCase();if(!k)return!0;const O=Qe(f).toLowerCase(),G=(f.email||"").toLowerCase();return O.includes(k)||G.includes(k)}).map(f=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-blue-200 rounded-lg bg-blue-50",children:[e.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold",children:tr(f)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800",children:Qe(f)}),e.jsx("p",{className:"text-sm text-gray-500",children:f.email}),e.jsxs("p",{className:"text-xs text-blue-600",children:["تنتهي في: ",f.freeTrialEndDate?ts(f.freeTrialEndDate):"غير محدد"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:"نشط"}),e.jsx("button",{onClick:()=>Hi(f.id),className:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-xs",children:"ضبط نهاية التجربة"}),e.jsx("button",{onClick:()=>Pi(f.id),className:"px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 text-xs",children:"إلغاء التجربة"})]})]},f.id)),t.filter(f=>f.isOnFreeTrial).length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ft,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"لا يوجد تجارب نشطة حالياً"})]})]})})]}),Lt==="expired"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"المستخدمين المنتهين من التجربة"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"المستخدمين الذين انتهت تجربتهم المجانية"}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:Ut,onChange:f=>Jr(f.target.value),placeholder:"ابحث بالاسم أو البريد في التجارب المنتهية",className:"w-full px-4 py-2 pl-10 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-blue-500 text-sm"}),e.jsx(Et,{className:"w-4 h-4 text-gray-400 absolute left-3 top-2.5"})]})})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[t.filter(f=>f.hasUsedFreeTrial&&!f.isOnFreeTrial).filter(f=>{const k=Ut.trim().toLowerCase();if(!k)return!0;const O=Qe(f).toLowerCase(),G=(f.email||"").toLowerCase();return O.includes(k)||G.includes(k)}).map(f=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-gray-600 font-semibold",children:tr(f)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800",children:Qe(f)}),e.jsx("p",{className:"text-sm text-gray-500",children:f.email}),e.jsx("p",{className:"text-xs text-red-500",children:"انتهت التجربة"})]})]}),e.jsx("div",{className:"flex items-center space-x-3 space-x-reverse",children:e.jsx("button",{onClick:()=>Pa(f.id),className:"px-3 py-1 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-xs",children:"تفعيل مرة أخرى"})})]},f.id)),t.filter(f=>f.hasUsedFreeTrial&&!f.isOnFreeTrial).length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(it,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"لا يوجد تجارب منتهية حالياً"})]})]})})]})]})]}),u==="whatsapp"&&e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Sr,{className:"w-6 h-6 text-green-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"إدارة الواتساب"})]}),e.jsx(J0,{})]}),u==="analytics"&&e.jsxs("div",{className:"bg-white rounded-lg p-8 shadow-sm border border-gray-200 text-center",children:[e.jsx(en,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"الإحصائيات"}),e.jsx("p",{className:"text-gray-500",children:"سيتم إضافة الإحصائيات قريباً"})]})]})]}),ji&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"تأكيد إلغاء الاشتراك"}),e.jsx("button",{onClick:()=>Cr(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(mt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-600",children:["هل أنت متأكد من رغبتك في إلغاء اشتراك المستخدم",e.jsx("span",{className:"font-semibold text-gray-800 mx-1",children:Er?Qe(Er):""}),"؟"]}),e.jsxs("p",{className:"text-red-500 text-sm mt-2 font-medium bg-red-50 p-2 rounded border border-red-100",children:[e.jsx(qt,{className:"w-4 h-4 inline-block ml-1"}),"سيتم إيقاف صلاحيات الاشتراك فوراً."]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>Cr(!1),className:"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium",children:"تراجع"}),e.jsx("button",{onClick:async()=>{Er&&(await Oa(Er.id),Cr(!1))},className:"px-4 py-2 rounded-md bg-red-600 text-white hover:bg-red-700 font-medium shadow-sm",children:"نعم، إلغاء الاشتراك"})]})]})}),e.jsx(go,{isOpen:bi,onClose:()=>Yr(!1),user:yi,onActivate:async(f,k,O,G)=>{try{await La(f,k,null,O,G),alert("تم تفعيل الاشتراك بنجاح"),Yr(!1)}catch(re){console.error("فشل في تفعيل الاشتراك:",re),alert("حدث خطأ أثناء تفعيل الاشتراك")}}}),e.jsx(co,{isOpen:Z,onClose:()=>d(!1)}),e.jsx(xo,{notification:B,onClose:Li,soundEnabled:g.soundAlerts,onToggleSound:Ui})]})},sl=()=>{M.useEffect(()=>{const R=async()=>{try{if(!(localStorage.getItem("autoBackupEnabled")==="true"))return;const w=localStorage.getItem("backupFrequency")||"daily",_=localStorage.getItem("lastAutoBackupTime"),m=_?new Date(_).getTime():0,b=Date.now(),l=24*60*60*1e3,u=w==="weekly"?7*l:l;if(b-m>u){console.log("Running scheduled backup...");const s=await xi(void 0,(d,x)=>{console.log(`Auto Backup: ${d} ${x}%`)});s.success?(localStorage.setItem("lastAutoBackupTime",new Date().toISOString()),nt.success("تم اكتمال النسخ الاحتياطي المجدول",{description:s.message})):(console.error("Scheduled backup failed:",s.message),nt.error("فشل النسخ الاحتياطي المجدول",{description:s.message}))}}catch(v){console.error("Error in scheduled backup:",v)}};R();const U=setInterval(R,60*60*1e3);return()=>clearInterval(U)},[])},al=()=>{sl();const R=g0(),{user:U,loading:v}=v0(),[w,_]=M.useState(!1),[m,b]=M.useState(null),[l,u]=M.useState(!0),[s,d]=M.useState("users"),[x,i]=M.useState(0),[r,a]=M.useState([]),[t,o]=M.useState({}),[c,n]=M.useState([]),[h,y]=M.useState([]),[j,A]=M.useState(!1),[D,z]=M.useState(null);M.useEffect(()=>{const X=localStorage.getItem("admin_dev_mode")==="true";_(X)},[]);const E=async(X=!1)=>{if(!(!w&&!U)){X||u(!0),b(null);try{const Y=He(Se(he,"users")),K=(await ke(()=>import("./index-DhbnydJl.js").then(V=>V.cP),__vite__mapDeps([1,2]),import.meta.url).then(V=>V.getDocs(Y))).docs.map(V=>({id:V.id,...V.data()}));a(K);const ie=He(Se(he,"profiles")),F=await ke(()=>import("./index-DhbnydJl.js").then(V=>V.cP),__vite__mapDeps([1,2]),import.meta.url).then(V=>V.getDocs(ie)),S={};F.forEach(V=>{S[V.id]=V.data()}),o(S),X||u(!1)}catch(Y){console.error("Error refreshing data:",Y),!w&&r.length===0&&b("فشل في تحميل البيانات"),X||u(!1)}}};M.useEffect(()=>{E()},[U,w]),M.useEffect(()=>{const X=r.map(Y=>{const oe=t[Y.id]||{},K=typeof oe.fullName=="string"?oe.fullName:void 0,ie=typeof oe.phone=="string"?oe.phone:void 0,F=typeof Y.displayName=="string"&&Y.displayName.trim()?Y.displayName:K||Y.displayName||void 0;return{...Y,displayName:F,phone:Y.phone??ie??null}});n(X)},[r,t]);const C=X=>{console.log("Notification center:",X)},L=X=>{console.log("Notification settings:",X)},N=X=>{console.log("Notifications:",X)},T=X=>{console.log("Editing plan:",X)};M.useEffect(()=>{U&&(async()=>{try{const X=await Ya();z(X)}catch(X){console.warn("Failed to load last update info:",X),z(null)}})()},[U]);const p=async()=>{try{return await j0()}catch(X){return console.error("Error loading content:",X),{}}},W=async X=>{try{A(!0),await _0(X,(U==null?void 0:U.uid)||"admin");const Y=await Ya();return z(Y),!0}catch(Y){return console.error("Error saving content:",Y),!1}finally{A(!1)}};return v?e.jsx(b0,{}):e.jsx(rl,{navigate:R,auth:Vs,devMode:w,setDevMode:_,error:m,setError:b,authLoading:v,setAuthLoading:()=>{},activeTab:s,setActiveTab:d,setNotificationCenterOpen:C,setNotificationSettings:L,setNotifications:N,notificationCount:x,setNotificationCount:i,users:c,setUsers:n,loading:l,setLoading:u,setEditingPlan:T,isSavingContent:j,setIsSavingContent:A,lastUpdateInfo:D,loadContentFromFirebase:p,saveContentToFirebase:W,refreshData:E})},Ll=Object.freeze(Object.defineProperty({__proto__:null,default:al},Symbol.toStringTag,{value:"Module"}));export{Mn as E,Ll as P};
//# sourceMappingURL=ProtectedAdminDashboard-BS6A8Uip.js.map
