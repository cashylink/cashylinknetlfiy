{"version":3,"file":"ProtectedDashboard-ALLbIFwq.js","sources":["../../src/pages/DashboardPage.tsx","../../src/components/ProtectedDashboard.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { ArrowUpDown, Plus, CheckCircle, Clock, XCircle, Phone, DollarSign, Wallet, ArrowDownLeft, Trash2, Edit, LogOut, Settings, Eye } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\nimport WalletManagement from '@/components/WalletManagement';\nimport TransactionDetailsModal from '@/components/TransactionDetailsModal';\nimport { SecretPinDialog } from '@/components/SecretPinDialog';\nimport { EditBalanceDialog } from '@/components/EditBalanceDialog';\nimport { ChangePinDialog } from '@/components/ChangePinDialog';\nimport { AddToWalletDialog } from '@/components/AddToWalletDialog';\nimport { transactionService, profileService } from '@/integrations/firebase/services';\nimport { doc, updateDoc, getDoc, setDoc, getDocFromCache, collection, query, where, orderBy, limit } from 'firebase/firestore';\nimport { db } from '@/firebase';\nimport { useShift } from '@/contexts/ShiftContext';\nimport { MasterPinDialog } from '@/components/MasterPinDialog';\nimport { useIsMobile } from '@/hooks/use-mobile';\nimport { Capacitor } from '@capacitor/core';\nimport { calculateCommission } from '@/utils/commissionCalculator';\nimport { ProfitService } from '@/utils/profitService';\n\ninterface Transaction {\n  id: string;\n  type: 'send' | 'receive' | 'withdraw';\n  senderPhone: string;\n  receiverPhone: string;\n  amount: number;\n  status: 'pending' | 'completed' | 'failed';\n  createdAt: Date;\n  withdrawnAmount?: number;\n  sentAmount?: number;\n  merchantShopName?: string;\n  shopName?: string;\n  commission?: number;\n  fee?: number;\n  fromWallet?: string;\n  senderName?: string;\n  cashierName?: string;\n}\n\ninterface DailyStats {\n  date: string;\n  totalTransactions: number;\n  totalAmount: number;\n  totalWithdrawn: number;\n  totalSent: number;\n}\n\ninterface MonthlyStats {\n  month: string;\n  totalTransactions: number;\n  totalAmount: number;\n  totalWithdrawn: number;\n  totalSent: number;\n}\n\nconst DashboardPage = () => {\n  const location = useLocation();\n  const { toast } = useToast();\n  const { signOut, user, profile } = useFirebaseAuth();\n  const { isShiftActive, shiftUser } = useShift();\n  const isMobile = useIsMobile();\n  const platform = (typeof Capacitor !== 'undefined' && typeof Capacitor.getPlatform === 'function') ? Capacitor.getPlatform() : 'web';\n  const isAndroid = platform === 'android' || /Android/i.test(typeof navigator !== 'undefined' ? navigator.userAgent : '');\n  // تفعيل تخطيط الموبايل/الأندرويد: عرض آخر 3 فقط والباقي في قسم قابل للتمرير\n  const showAndroidMobileLayout = isAndroid || isMobile;\n  const [senderPhone, setSenderPhone] = useState('01030302038');\n  const [senderName, setSenderName] = useState('');\n  const [receiverPhone, setReceiverPhone] = useState('');\n  const [amount, setAmount] = useState('');\n  const [transactionType, setTransactionType] = useState<'transfer' | 'withdraw'>('transfer');\n  const [senderProvider, setSenderProvider] = useState<'vodafone_cash' | 'etisalat_cash' | 'orange_cash' | 'instapay'>('vodafone_cash');\n  const [receiverProvider, setReceiverProvider] = useState<'vodafone_cash' | 'etisalat_cash' | 'orange_cash' | 'instapay'>('vodafone_cash');\n  const [transferFee, setTransferFee] = useState('');\n  const [transactions, setTransactions] = useState<Transaction[]>([]);\n  const [activeTab, setActiveTab] = useState('all');\n  const [isWalletManagementOpen, setIsWalletManagementOpen] = useState(false);\n  const [selectedWallet, setSelectedWallet] = useState<string>('');\n  const [wallets, setWallets] = useState<Array<{id: string, name: string, phone: string, isDefault: boolean}>>([]);\n  const [selectedTransaction, setSelectedTransaction] = useState<Transaction | null>(null);\n  const [isTransactionDetailsOpen, setIsTransactionDetailsOpen] = useState(false);\n  const [dailyStats, setDailyStats] = useState<DailyStats[]>([]);\n  const [monthlyStats, setMonthlyStats] = useState<MonthlyStats[]>([]);\n  const [isResetDialogOpen, setIsResetDialogOpen] = useState(false);\n  const [resetType, setResetType] = useState<'daily' | 'monthly'>('daily');\n  const [deletedTransactions, setDeletedTransactions] = useState<Transaction[]>([]);\n  const MONTHLY_WITHDRAWAL_LIMIT = 200000;\n  const MONTHLY_TRANSFER_LIMIT = 200000;\n  const [cashBalance, setCashBalance] = useState(0);\n  const [walletBalances, setWalletBalances] = useState<{[key: string]: number}>({});\n  const [isEditCashDialogOpen, setIsEditCashDialogOpen] = useState(false);\n  const [isEditWalletDialogOpen, setIsEditWalletDialogOpen] = useState(false);\n  const [isAddToWalletDialogOpen, setIsAddToWalletDialogOpen] = useState(false);\n  const [isAddToWalletTotalDialogOpen, setIsAddToWalletTotalDialogOpen] = useState(false);\n  const [isEditWalletTotalDialogOpen, setIsEditWalletTotalDialogOpen] = useState(false);\n  const [editingWalletId, setEditingWalletId] = useState<string>('');\n  const [isChangePinDialogOpen, setIsChangePinDialogOpen] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isDailyLocked, setIsDailyLocked] = useState<boolean>(() => {\n    try {\n      const key = user?.uid ? `dailyReportsLockEnabled_${user?.uid}` : 'dailyReportsLockEnabled';\n      const v = localStorage.getItem(key) ?? localStorage.getItem('dailyReportsLockEnabled');\n      return v === 'true';\n    } catch {\n      return false;\n    }\n  });\n  const [isDailyPinDialogOpen, setIsDailyPinDialogOpen] = useState<boolean>(false);\n  const [isTransactionPinned, setIsTransactionPinned] = useState(false);\n\n  // كشف الشركة تلقائيًا من مقدمة الرقم\n  // Helper: normalize Arabic/Persian digits to ASCII\n  const normalizeDigits = (s: string) => {\n    const arabicIndic = '٠١٢٣٤٥٦٧٨٩';\n    const easternIndic = '۰۱۲۳۴۵۶۷۸۹';\n    return (s || '').split('').map(ch => {\n      const ai = arabicIndic.indexOf(ch);\n      if (ai > -1) return String(ai);\n      const ei = easternIndic.indexOf(ch);\n      if (ei > -1) return String(ei);\n      return ch;\n    }).join('');\n  };\n\n  const detectProvider = (phone: string): 'vodafone_cash' | 'etisalat_cash' | 'orange_cash' | 'instapay' | null => {\n    const digits = normalizeDigits(phone).replace(/\\D/g, '');\n    if (digits.startsWith('010')) return 'vodafone_cash';\n    if (digits.startsWith('011')) return 'etisalat_cash';\n    if (digits.startsWith('012')) return 'orange_cash';\n    // مبدئيًا لا ندعم 015 (WE) هنا؛ تظل القيمة كما هي أو يُستخدم الاختيار اليدوي\n    return null;\n  };\n\n  useEffect(() => {\n    const p = detectProvider(senderPhone);\n    if (p && p !== senderProvider) setSenderProvider(p);\n  }, [senderPhone]);\n\n  useEffect(() => {\n    const p = detectProvider(receiverPhone);\n    if (p && p !== receiverProvider) setReceiverProvider(p);\n  }, [receiverPhone]);\n\n  useEffect(() => {\n    try {\n      const key = user?.uid ? `dailyReportsLockEnabled_${user?.uid}` : 'dailyReportsLockEnabled';\n      const v = localStorage.getItem(key) ?? localStorage.getItem('dailyReportsLockEnabled');\n      setIsDailyLocked(v === 'true');\n    } catch {}\n  }, [user?.uid]);\n\n  // تفعيل نموذج المعاملة ووضع التثبيت عند القدوم من أزرار أسفل الموبايل\n  useEffect(() => {\n    const state: any = location.state || {};\n    if (state?.openTransactionSection) {\n      if (state?.transactionType === 'withdraw' || state?.transactionType === 'transfer') {\n        setTransactionType(state.transactionType);\n      }\n      setIsTransactionPinned(true);\n      if (state?.startNewTransaction) {\n        setSenderPhone('01030302038');\n        setReceiverPhone('');\n        setAmount('');\n        setTransferFee('');\n      }\n      // تأكد من ظهور النموذج أعلى الصفحة في الموبايل\n      setTimeout(() => {\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n      }, 50);\n    }\n  }, [location.state]);\n\n  // دالة لحفظ البيانات في Firebase\n  const saveDataToFirebase = async (data: any) => {\n    if (!user) return;\n    \n    try {\n      const userProfile = await profileService.getById(user.uid);\n      if (userProfile?.shopId) {\n        const dataRef = doc(db, 'dashboardData', userProfile.shopId);\n        await updateDoc(dataRef, data);\n      }\n    } catch (error) {\n      console.error('Error saving to Firebase:', error);\n      toast({\n        title: \"خطأ في الحفظ\",\n        description: \"حدث خطأ أثناء حفظ البيانات في Firebase\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  useEffect(() => {\n    if (!user) return;\n    \n    const loadDataFromFirebase = async () => {\n      setIsLoading(true);\n      try {\n        const userProfile = await profileService.getById(user.uid);\n        if (userProfile?.shopId) {\n          // تحميل الأرصدة من Firebase\n          const dataRef = doc(db, 'dashboardData', userProfile.shopId);\n          // أولاً: محاولة قراءة سريعة من الكاش لعرض البيانات فورًا\n          try {\n            const cachedSnap = await getDocFromCache(dataRef);\n            if (cachedSnap.exists()) {\n              const cached = cachedSnap.data() as any;\n              setCashBalance(cached.cashBalance || 0);\n              setWalletBalances(cached.walletBalances || {});\n              setDeletedTransactions(cached.deletedTransactions || []);\n              // بما أن لدينا بيانات معروضة من الكاش، ننهي حالة التحميل مبكرًا\n              setIsLoading(false);\n            }\n          } catch {\n            // الكاش غير متوفر أو غير مفعّل، نتابع لجلب الشبكة\n          }\n          const dataSnap = await getDoc(dataRef);\n          \n          if (dataSnap.exists()) {\n            const data = dataSnap.data();\n            setCashBalance(data.cashBalance || 0);\n            setWalletBalances(data.walletBalances || {});\n            setDeletedTransactions(data.deletedTransactions || []);\n          } else {\n            const defaultData = {\n              walletBalances: {},\n              deletedTransactions: []\n            };\n            await setDoc(dataRef, defaultData);\n            setCashBalance(0);\n            setWalletBalances(defaultData.walletBalances);\n            setDeletedTransactions(defaultData.deletedTransactions);\n          }\n        }\n      } catch (error) {\n        console.error('Error loading data from Firebase:', error);\n        // لا يتم استخدام أي استرجاع من التخزين المحلي؛ اعرض قيمًا افتراضية وآمن اتصالك\n        setCashBalance(0);\n        setWalletBalances({});\n        setDeletedTransactions([]);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadDataFromFirebase();\n  }, [user]);\n\n  useEffect(() => {\n    const handleExternalUpdate = (event: any) => {\n      const { cashBalance: newCash, walletBalances: newWallets, newTransaction, delta } = event.detail || {};\n      \n      // Handle Delta Update (Optimistic)\n      if (delta) {\n          const { amount, type, walletId, commission, totalDeducted } = delta;\n          const amt = Number(amount || 0);\n          const comm = Number(commission || 0);\n          const totalDed = Number(totalDeducted || (amt + comm));\n          \n          setCashBalance(prev => {\n              let change = 0;\n              if (type === 'withdraw') {\n                  change = -amt + comm;\n              } else if (type === 'send' || type === 'transfer') {\n                  change = amt + comm;\n              } else if (type === 'atm_withdraw') {\n                  change = amt;\n              }\n              return prev + change;\n          });\n          \n          if (walletId) {\n              setWalletBalances(prev => {\n                  const currentVal = Number(prev[walletId] || 0);\n                  let change = 0;\n                  if (type === 'withdraw') {\n                      change = amt;\n                  } else if (type === 'send' || type === 'transfer') {\n                      change = -amt;\n                  } else if (type === 'atm_withdraw') {\n                      change = -totalDed;\n                  }\n                  return { ...prev, [walletId]: currentVal + change };\n              });\n          }\n      }\n\n      if (typeof newCash === 'number') {\n        setCashBalance(newCash);\n      }\n      \n      if (newWallets && typeof newWallets === 'object') {\n        setWalletBalances(newWallets);\n      }\n      \n      if (newTransaction) {\n        setTransactions(prev => {\n          // Check if transaction already exists to avoid duplicates\n          if (prev.some(t => t.id === newTransaction.id)) {\n            return prev;\n          }\n          return [newTransaction, ...prev];\n        });\n        \n        // Also update daily stats if needed, but primarily transactions list\n        toast({\n          title: \"تم تسجيل عملية خارجية\",\n          description: \"تم تحديث الأرصدة والسجلات بنجاح\",\n        });\n      }\n    };\n\n    window.addEventListener('dashboard:external-update', handleExternalUpdate);\n    return () => window.removeEventListener('dashboard:external-update', handleExternalUpdate);\n  }, []);\n\n  // استبدال الاشتراك اللحظي بآلية التحديث اليدوي لتقليل القراءات\n  const refreshDashboardData = async () => {\n    if (!user) return;\n    setIsLoading(true);\n    try {\n      const userProfile = await profileService.getById(user.uid);\n      if (userProfile?.shopId) {\n        const dataRef = doc(db, 'dashboardData', userProfile.shopId);\n        // تجاهل الكاش هنا لضمان الحصول على أحدث البيانات عند الطلب اليدوي\n        const dataSnap = await getDoc(dataRef);\n        \n        if (dataSnap.exists()) {\n          const data: any = dataSnap.data();\n          setCashBalance(data.cashBalance || 0);\n          setWalletBalances(data.walletBalances || {});\n          setDeletedTransactions(data.deletedTransactions || []);\n          toast({\n            title: \"تم تحديث البيانات\",\n            description: \"تم تحميل أحدث البيانات من السيرفر بنجاح\",\n          });\n        }\n      }\n    } catch (e) {\n      console.error('Error refreshing dashboard data:', e);\n      toast({\n        title: \"فشل التحديث\",\n        description: \"حدث خطأ أثناء تحديث البيانات\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // تمت إزالة الاشتراك اللحظي (onSnapshot) لتقليل تكاليف Firebase Reads\n  // الاعتماد الآن على:\n  // 1. التحميل الأولي (loadDataFromFirebase)\n  // 2. التحديث المحلي المتفائل عند إجراء عمليات (optimistic UI updates)\n  // 3. التحديث اليدوي عند الحاجة\n\n\n  // تمت إزالة مزامنة التخزين المحلي: العرض والعمليات تعتمد على Firestore فقط\n\n  // باقي الكود يبقى كما هو...\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (transactionType === 'transfer') {\n      // Transfer logic\n      if (!senderPhone || !receiverPhone || !amount) {\n        toast({\n          title: \"خطأ\",\n          description: \"يرجى ملء جميع الحقول المطلوبة\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n\n      // تحديد اسم المحل من بروفايل المستخدم، مع بدائل آمنة\n      const merchantShopName = profile?.shopName || user?.displayName || 'محل كاشي لينك';\n\n      // محاولة تحديد اسم المحفظة المختارة أو الافتراضية\n      const selectedWalletObj = wallets.find(w => w.id === selectedWallet) || wallets.find(w => w.isDefault);\n\n      // تحقق من الرسوم بناءً على بادئات الأرقام (شرط 010 → 011)\n      const fee = (transferFee && transferFee.trim() !== '') ? parseFloat(transferFee) : 0;\n\n      // تحقق من توفر المحفظة والرصيد الكافي\n      if (!selectedWalletObj) {\n        toast({ title: \"لا توجد محفظة\", description: \"يرجى اختيار محفظة لإتمام التحويل\", variant: \"destructive\" });\n        return;\n      }\n      const parsedAmount = parseFloat(amount);\n      const totalDebit = parsedAmount + fee;\n      const currentWalletBalance = walletBalances[selectedWalletObj.id] || 0;\n      if (currentWalletBalance < totalDebit) {\n        toast({ title: \"رصيد المحفظة غير كافٍ\", description: `الرصيد الحالي ${currentWalletBalance} لا يكفي لخصم ${totalDebit}`, variant: \"destructive\" });\n        return;\n      }\n\n      const transferCommission = calculateCommission(parsedAmount, 'send');\n      const newTransaction: Transaction = {\n        id: Date.now().toString(),\n        type: 'send',\n        senderPhone,\n        receiverPhone,\n        amount: parsedAmount,\n        status: 'pending',\n        createdAt: new Date(),\n        withdrawnAmount: 0,\n        sentAmount: parsedAmount,\n        merchantShopName,\n        shopName: selectedWalletObj?.name || 'المحفظة الرئيسية',\n        commission: transferCommission,\n        fee: fee,\n        fromWallet: selectedWalletObj.id,\n      };\n\n      // لا نضيف اسم الكاشير في معاملات الحساب الرئيسي حتى لو كانت وردية نشطة\n\n      const updatedTransactions = [newTransaction, ...transactions];\n      setTransactions(updatedTransactions);\n\n      // تحديث رصيد المحفظة (خصم مبلغ التحويل + الرسوم)\n      const totalDebit2 = parsedAmount + fee;\n      const walletId = selectedWalletObj?.id;\n      const currentWalletBalance2 = walletId ? (walletBalances[walletId] || 0) : 0;\n      const newWalletBalances = walletId ? { ...walletBalances, [walletId]: currentWalletBalance2 - totalDebit2 } : walletBalances;\n      setWalletBalances(newWalletBalances);\n\n      // لا نضيف الرسوم إلى الدرج عند الإنشاء — الإضافة تتم عند الإكمال فقط\n\n      // حفظ في Firebase بدون تعديل الدرج الآن\n      await saveDataToFirebase({ transactions: updatedTransactions, walletBalances: newWalletBalances });\n\n      toast({\n        title: \"تم إرسال التحويل\",\n        description: \"جاري معالجة التحويل...\",\n      });\n\n      setTimeout(async () => {\n        const completedTransaction = { ...newTransaction, status: 'completed' as const };\n        const finalTransactions = [completedTransaction, ...transactions];\n        setTransactions(finalTransactions);\n        \n        // عند الإكمال: إضافة الرسوم إلى الدرج ثم حفظ\n        const completedFee = fee;\n        const toAdd = Math.max(0, transferCommission) + (Number.isFinite(completedFee) ? completedFee : 0);\n        const newCashBalanceOnComplete = cashBalance + toAdd;\n        setCashBalance(newCashBalanceOnComplete);\n        await saveDataToFirebase({ transactions: finalTransactions, cashBalance: newCashBalanceOnComplete });\n\n        ProfitService.addProfit(toAdd);\n\n        // toast({\n        //   title: \"تم التحويل بنجاح\",\n        //   description: `تم تحويل ${amount} جنيه إلى ${receiverPhone} وخصم عمولة ${commission} جنيه من الدرج`,\n        // });\n      }, 2000);\n\n      setSenderPhone('01030302038');\n      setReceiverPhone('');\n      setAmount('');\n      setTransferFee('');\n    } else if (transactionType === 'withdraw') {\n      if (!senderPhone || !amount) {\n        toast({\n          title: \"خطأ\",\n          description: \"يرجى ملء جميع الحقول المطلوبة\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n\n      const merchantShopName = profile?.shopName || user?.displayName || 'محل كاشي لينك';\n      const selectedWalletObj = wallets.find(w => w.id === selectedWallet) || wallets.find(w => w.isDefault);\n      if (!selectedWalletObj) {\n        toast({ title: \"لا توجد محفظة\", description: \"يرجى اختيار محفظة لإتمام السحب\", variant: \"destructive\" });\n        return;\n      }\n\n      const parsedAmount = parseFloat(amount);\n      if (!Number.isFinite(parsedAmount) || parsedAmount <= 0) {\n        toast({ title: \"خطأ\", description: \"أدخل مبلغًا صحيحًا للسحب\", variant: \"destructive\" });\n        return;\n      }\n\n      const withdrawCommission = calculateCommission(parsedAmount, 'receive');\n      const newTransaction: Transaction = {\n        id: Date.now().toString(),\n        type: 'withdraw',\n        senderPhone,\n        receiverPhone: '',\n        amount: parsedAmount,\n        status: 'pending',\n        createdAt: new Date(),\n        withdrawnAmount: parsedAmount,\n        sentAmount: 0,\n        merchantShopName,\n        shopName: selectedWalletObj?.name || 'المحفظة الرئيسية',\n        commission: withdrawCommission,\n        fromWallet: selectedWalletObj.id,\n        senderName: senderName || undefined,\n      };\n\n      const updatedTransactions = [newTransaction, ...transactions];\n      setTransactions(updatedTransactions);\n\n      await saveDataToFirebase({ transactions: updatedTransactions });\n\n      toast({\n        title: \"تم إنشاء عملية السحب\",\n        description: \"جاري معالجة السحب...\",\n      });\n\n      setTimeout(async () => {\n        const completedTransaction = { ...newTransaction, status: 'completed' as const };\n        const finalTransactions = [completedTransaction, ...transactions];\n        setTransactions(finalTransactions);\n\n        const fromWalletId = selectedWalletObj.id;\n        const currentWalletBalance = walletBalances[fromWalletId] || 0;\n        const newWalletBalances = { ...walletBalances, [fromWalletId]: currentWalletBalance + parsedAmount };\n        setWalletBalances(newWalletBalances);\n\n        const newCashBalanceOnComplete = cashBalance - parsedAmount + Math.max(0, withdrawCommission);\n        setCashBalance(newCashBalanceOnComplete);\n\n        await saveDataToFirebase({ transactions: finalTransactions, walletBalances: newWalletBalances, cashBalance: newCashBalanceOnComplete });\n\n        ProfitService.addProfit(Math.max(0, withdrawCommission));\n      }, 2000);\n\n      setSenderPhone('01030302038');\n      setAmount('');\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background p-4\">\n      {isLoading && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white p-6 rounded-lg\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"></div>\n            <p className=\"mt-2 text-center\">جاري تحميل البيانات...</p>\n          </div>\n        </div>\n      )}\n      \n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <h1 className=\"text-3xl font-bold text-gray-900\">لوحة تحكم الإدارة</h1>\n          <div className=\"flex items-center gap-2\">\n            <Button onClick={refreshDashboardData} variant=\"outline\" className=\"flex items-center gap-2\">\n              <RefreshCcw className=\"h-4 w-4\" />\n              تحديث\n            </Button>\n            <Button onClick={signOut} variant=\"outline\" className=\"flex items-center gap-2\">\n              <LogOut className=\"h-4 w-4\" />\n              تسجيل الخروج\n            </Button>\n          </div>\n        </div>\n\n        {/* Stats Cards */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">الرصيد النقدي</CardTitle>\n              <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{cashBalance.toLocaleString()} جنيه</div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">أرصدة المحافظ</CardTitle>\n              <Wallet className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">\n                {Object.values(walletBalances).reduce((sum, balance) => sum + balance, 0).toLocaleString()} جنيه\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card className=\"relative\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">المعاملات اليوم</CardTitle>\n              <ArrowUpDown className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent className={isDailyLocked ? \"filter blur-sm pointer-events-none\" : \"\"}>\n              <div className=\"text-2xl font-bold\">{transactions.length}</div>\n            </CardContent>\n            {isDailyLocked && (\n              <div className=\"absolute inset-0 flex items-center justify-center rounded-lg bg-yellow-100/60\">\n                <Button\n                  size=\"sm\"\n                  variant=\"ghost\"\n                  onClick={() => setIsDailyPinDialogOpen(true)}\n                  className=\"flex items-center gap-2 bg-yellow-200/70 hover:bg-yellow-300 text-yellow-900 px-3 py-2 rounded-xl shadow-md hover:shadow-lg transition-all\"\n                  title=\"عرض تقارير اليوم\"\n                >\n                  <Eye className=\"h-5 w-5\" />\n                  <span className=\"text-xs\">عرض تقارير اليوم</span>\n                </Button>\n              </div>\n            )}\n          </Card>\n          \n          <Card className=\"relative\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">إجمالي اليوم</CardTitle>\n              <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent className={isDailyLocked ? \"filter blur-sm pointer-events-none\" : \"\"}>\n              <div className=\"text-2xl font-bold\">\n                {transactions.reduce((sum, t) => sum + t.amount, 0).toLocaleString()} جنيه\n              </div>\n            </CardContent>\n            {isDailyLocked && (\n              <div className=\"absolute inset-0 flex items-center justify-center rounded-lg bg-yellow-100/60\">\n                <Button\n                  size=\"sm\"\n                  variant=\"ghost\"\n                  onClick={() => setIsDailyPinDialogOpen(true)}\n                  className=\"flex items-center gap-2 bg-yellow-200/70 hover:bg-yellow-300 text-yellow-900 px-3 py-2 rounded-xl shadow-md hover:shadow-lg transition-all\"\n                  title=\"عرض تقارير اليوم\"\n                >\n                  <Eye className=\"h-5 w-5\" />\n                  <span className=\"text-xs\">عرض تقارير اليوم</span>\n                </Button>\n              </div>\n            )}\n          </Card>\n\n          {/* Dialog to verify master PIN and unlock daily reports */}\n          <MasterPinDialog\n            open={isDailyPinDialogOpen}\n            onOpenChange={setIsDailyPinDialogOpen}\n            mode=\"verify\"\n            title=\"قفل تقارير اليوم\"\n            description=\"لا يمكن الاطلاع على تقارير اليوم إلا بإدخال الرقم السري الرئيسي\"\n            userId={user?.uid}\n            userRole={profile?.role}\n            onSuccess={() => {\n              setIsDailyLocked(false);\n              setIsDailyPinDialogOpen(false);\n            }}\n          />\n        </div>\n\n        {/* Transaction Form */}\n        <Card className={isMobile && isTransactionPinned ? 'sticky top-0 z-40 shadow-lg bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/70' : ''}>\n          <CardHeader>\n            <CardTitle>إجراء معاملة جديدة</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">نوع المعاملة</label>\n                  <Select value={transactionType} onValueChange={(value: 'transfer' | 'withdraw') => setTransactionType(value)}>\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"transfer\">تحويل</SelectItem>\n                      <SelectItem value=\"withdraw\">سحب</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">رقم المرسل</label>\n                  <Input\n                    type=\"tel\"\n                    value={senderPhone}\n                    onChange={(e) => setSenderPhone(e.target.value)}\n                    onKeyDown={(e) => {\n                      if (e.key === 'Enter') {\n                        const dest = document.getElementById('receiverPhoneInput') as HTMLInputElement | null;\n                        if (dest) {\n                          dest.focus();\n                        } else {\n                          const amountEl = document.getElementById('amountInput') as HTMLInputElement | null;\n                          amountEl?.focus();\n                        }\n                      }\n                    }}\n                    placeholder=\"01xxxxxxxxx\"\n                  />\n                </div>\n                \n                {transactionType === 'transfer' && (\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">رقم المستقبل</label>\n                    <Input\n                      id=\"receiverPhoneInput\"\n                      type=\"tel\"\n                      value={receiverPhone}\n                      onChange={(e) => setReceiverPhone(e.target.value)}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter') {\n                          const next = document.getElementById('amountInput') as HTMLInputElement | null;\n                          next?.focus();\n                        }\n                      }}\n                      placeholder=\"01xxxxxxxxx\"\n                    />\n                  </div>\n                )}\n                {transactionType === 'withdraw' && (\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">اسم الراسل (اختياري)</label>\n                    <Input\n                      id=\"senderNameInput\"\n                      type=\"text\"\n                      value={senderName}\n                      onChange={(e) => setSenderName(e.target.value)}\n                      placeholder=\"مثال: أحمد عبد الرحمن\"\n                    />\n                  </div>\n                )}\n                \n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">شركة المرسل</label>\n                  <Select value={senderProvider} onValueChange={(v) => setSenderProvider(v as any)}>\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"vodafone_cash\">فودافون</SelectItem>\n                      <SelectItem value=\"etisalat_cash\">اتصالات</SelectItem>\n                      <SelectItem value=\"orange_cash\">أورانج</SelectItem>\n                      <SelectItem value=\"instapay\">إنستاباي</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">شركة المستقبل</label>\n                  <Select value={receiverProvider} onValueChange={(v) => setReceiverProvider(v as any)}>\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"vodafone_cash\">فودافون</SelectItem>\n                      <SelectItem value=\"etisalat_cash\">اتصالات</SelectItem>\n                      <SelectItem value=\"orange_cash\">أورانج</SelectItem>\n                      <SelectItem value=\"instapay\">إنستاباي</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">المبلغ</label>\n                  <Input\n                    id=\"amountInput\"\n                    type=\"number\"\n                    value={amount}\n                    onChange={(e) => setAmount(e.target.value)}\n                    onKeyDown={(e) => {\n                      if (e.key === 'Enter') {\n                        const submitBtn = document.getElementById('txSubmitButton') as HTMLButtonElement | null;\n                        submitBtn?.focus();\n                      }\n                    }}\n                    placeholder=\"0.00\"\n                  />\n                </div>\n                {transactionType === 'withdraw' && (\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">اسم الراسل (اختياري)</label>\n                    <Input\n                      id=\"senderNameInput\"\n                      type=\"text\"\n                      value={senderName}\n                      onChange={(e) => setSenderName(e.target.value)}\n                      placeholder=\"مثال: أحمد عبد الرحمن\"\n                    />\n                  </div>\n                )}\n                {transactionType === 'transfer' && ((normalizeDigits(senderPhone || '').replace(/\\D/g, '').startsWith('010') && normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('010')) || (normalizeDigits(senderPhone || '').replace(/\\D/g, '').startsWith('010') && (normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('011') || normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('012') || normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('015'))) || (normalizeDigits(senderPhone || '').replace(/\\D/g, '').startsWith('012') && normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('010')) || (normalizeDigits(senderPhone || '').replace(/\\D/g, '').startsWith('011') && normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('010')) || (normalizeDigits(senderPhone || '').replace(/\\D/g, '').startsWith('015') && normalizeDigits(receiverPhone || '').replace(/\\D/g, '').startsWith('010'))) && (\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">رسوم التحويل</label>\n                    <Input\n                      type=\"number\"\n                      value={transferFee}\n                      onChange={(e) => setTransferFee(e.target.value)}\n                      placeholder=\"0.00\"\n                    />\n                    <p className=\"text-xs text-gray-500 mt-1\">تُخصم من المحفظة وتضاف للدرج</p>\n                  </div>\n                )}\n              </div>\n              \n              <Button id=\"txSubmitButton\" type=\"submit\" className={`w-full ${transactionType === 'transfer' ? 'btn-transfer-confirm' : 'btn-withdraw-confirm'}`}>\n                {transactionType === 'transfer' ? 'إرسال التحويل' : 'تنفيذ السحب'}\n              </Button>\n            </form>\n          </CardContent>\n        </Card>\n\n        {/* Transactions List */}\n        <Card>\n          <CardHeader>\n            <CardTitle>المعاملات الأخيرة</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {transactions.length === 0 ? (\n              <p className=\"text-sm text-gray-500\">لا توجد معاملات حديثة.</p>\n            ) : (\n              <div className={(isMobile || isAndroid) ? \"receipts-list space-y-3 max-h-[310px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400\" : \"receipts-list space-y-3\"}>\n                {transactions.map((transaction) => (\n                  <div \n                    key={transaction.id} \n                    className=\"relative flex items-center gap-4 p-4 rounded-xl bg-card border border-gray-100 shadow-sm hover:shadow-md transition-all duration-200\"\n                  >\n                    {/* Icon Column */}\n                    <div className={`h-12 w-12 rounded-full flex items-center justify-center shrink-0 ${\n                       transaction.type === 'withdraw' ? 'bg-red-50' : 'bg-green-50'\n                    }`}>\n                       {transaction.type === 'withdraw' ? (\n                          <ArrowDownLeft className=\"h-6 w-6 text-red-600\" />\n                       ) : (\n                          <ArrowUpRight className=\"h-6 w-6 text-green-600\" />\n                       )}\n                    </div>\n\n                    {/* Content Column */}\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center justify-between mb-1\">\n                        <h4 className=\"text-base font-bold text-foreground truncate\">\n                          {transaction.type === 'send' ? 'تحويل أموال' : 'سحب نقدي'}\n                        </h4>\n                        <span className={`text-base font-bold whitespace-nowrap ${\n                          transaction.type === 'send' ? 'text-green-600' : 'text-red-600'\n                        }`}>\n                          {transaction.type === 'send' ? '-' : '+'} {transaction.amount.toLocaleString()} ج.م\n                        </span>\n                      </div>\n\n                      <div className=\"flex items-center justify-between\">\n                         <div className=\"flex flex-col gap-0.5\">\n                            <p className=\"text-sm text-muted-foreground truncate\">\n                               {transaction.type === 'send' ? (\n                                  <span dir=\"ltr\">{transaction.receiverPhone}</span>\n                               ) : (\n                                  <span dir=\"ltr\">{transaction.senderPhone}</span>\n                               )}\n                            </p>\n                            <p className=\"text-sm font-medium text-gray-500 mt-0.5\">\n                               {transaction.createdAt instanceof Date ? transaction.createdAt.toLocaleString('ar-EG', { day: 'numeric', month: 'short', hour: 'numeric', minute: 'numeric', hour12: true }) : new Date((transaction.createdAt as any).seconds * 1000).toLocaleString('ar-EG', { day: 'numeric', month: 'short', hour: 'numeric', minute: 'numeric', hour12: true })}\n                            </p>\n                         </div>\n\n                         <div className={`px-2.5 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${\n                            transaction.status === 'completed' \n                              ? 'bg-green-50 text-green-700' \n                              : transaction.status === 'pending'\n                              ? 'bg-yellow-50 text-yellow-700'\n                              : 'bg-red-50 text-red-700'\n                         }`}>\n                            {transaction.status === 'completed' && <Check className=\"h-3 w-3\" />}\n                            {transaction.status === 'pending' && <Clock className=\"h-3 w-3\" />}\n                            {transaction.status === 'failed' && <X className=\"h-3 w-3\" />}\n                            <span>\n                               {transaction.status === 'completed' ? 'ناجحة' : transaction.status === 'pending' ? 'معالجة' : 'فشلت'}\n                            </span>\n                         </div>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default DashboardPage;\n\n// كشف الشركة تلقائيًا من مقدمة الرقم\nconst detectProvider = (phone: string): 'vodafone_cash' | 'etisalat_cash' | 'orange_cash' | 'instapay' | null => {\n  const digits = normalizeDigits(phone).replace(/\\D/g, '');\n  if (digits.startsWith('010')) return 'vodafone_cash';\n  if (digits.startsWith('011')) return 'etisalat_cash';\n  if (digits.startsWith('012')) return 'orange_cash';\n  // مبدئيًا لا ندعم 015 (WE) هنا؛ تظل القيمة كما هي أو يُستخدم الاختيار اليدوي\n  return null;\n};\n","import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport DashboardPage from '../pages/DashboardPage';\r\nimport LogoLoader from '@/components/LogoLoader';\r\n\r\nconst ProtectedDashboard = () => {\r\n  const navigate = useNavigate();\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // التحقق من حالة تسجيل الدخول\r\n    const checkAuth = () => {\r\n      const authStatus = localStorage.getItem('dashboardAuth');\r\n      const userData = localStorage.getItem('dashboardUser');\r\n      \r\n      if (authStatus === 'true' && userData) {\r\n        try {\r\n          const user = JSON.parse(userData);\r\n          const loginTime = new Date(user.loginTime);\r\n          const now = new Date();\r\n          const hoursDiff = (now.getTime() - loginTime.getTime()) / (1000 * 60 * 60);\r\n          \r\n          // انتهاء صلاحية الجلسة بعد 24 ساعة\r\n          if (hoursDiff < 24) {\r\n            setIsAuthenticated(true);\r\n          } else {\r\n            // انتهت صلاحية الجلسة\r\n            localStorage.removeItem('dashboardAuth');\r\n            localStorage.removeItem('dashboardUser');\r\n            navigate('/dashboard/login');\r\n          }\r\n        } catch (error) {\r\n          console.error('Error parsing user data:', error);\r\n          navigate('/dashboard/login');\r\n        }\r\n      } else {\r\n        navigate('/dashboard/login');\r\n      }\r\n      \r\n      setIsLoading(false);\r\n    };\r\n\r\n    checkAuth();\r\n  }, [navigate]);\r\n\r\n  if (isLoading) {\r\n    return <LogoLoader />;\r\n  }\r\n\r\n  if (!isAuthenticated) {\r\n    return <LogoLoader />;\r\n  }\r\n\r\n  return <DashboardPage />;\r\n};\r\n\r\nexport default ProtectedDashboard;"],"names":["DashboardPage","location","useLocation","toast","useToast","signOut","user","profile","useFirebaseAuth","isShiftActive","shiftUser","useShift","isMobile","useIsMobile","isAndroid","Capacitor","senderPhone","setSenderPhone","useState","senderName","setSenderName","receiverPhone","setReceiverPhone","amount","setAmount","transactionType","setTransactionType","senderProvider","setSenderProvider","receiverProvider","setReceiverProvider","transferFee","setTransferFee","transactions","setTransactions","activeTab","setActiveTab","isWalletManagementOpen","setIsWalletManagementOpen","selectedWallet","setSelectedWallet","wallets","setWallets","selectedTransaction","setSelectedTransaction","isTransactionDetailsOpen","setIsTransactionDetailsOpen","dailyStats","setDailyStats","monthlyStats","setMonthlyStats","isResetDialogOpen","setIsResetDialogOpen","resetType","setResetType","deletedTransactions","setDeletedTransactions","cashBalance","setCashBalance","walletBalances","setWalletBalances","isEditCashDialogOpen","setIsEditCashDialogOpen","isEditWalletDialogOpen","setIsEditWalletDialogOpen","isAddToWalletDialogOpen","setIsAddToWalletDialogOpen","isAddToWalletTotalDialogOpen","setIsAddToWalletTotalDialogOpen","isEditWalletTotalDialogOpen","setIsEditWalletTotalDialogOpen","editingWalletId","setEditingWalletId","isChangePinDialogOpen","setIsChangePinDialogOpen","isLoading","setIsLoading","isDailyLocked","setIsDailyLocked","key","isDailyPinDialogOpen","setIsDailyPinDialogOpen","isTransactionPinned","setIsTransactionPinned","normalizeDigits","s","arabicIndic","easternIndic","ch","ai","ei","detectProvider","phone","digits","useEffect","p","v","state","saveDataToFirebase","data","userProfile","profileService","dataRef","doc","db","updateDoc","error","cachedSnap","getDocFromCache","cached","dataSnap","getDoc","defaultData","setDoc","handleExternalUpdate","event","newCash","newWallets","newTransaction","delta","type","walletId","commission","totalDeducted","amt","comm","totalDed","prev","change","currentVal","t","refreshDashboardData","e","handleSubmit","merchantShopName","selectedWalletObj","w","fee","parsedAmount","totalDebit","currentWalletBalance","transferCommission","calculateCommission","updatedTransactions","totalDebit2","currentWalletBalance2","newWalletBalances","finalTransactions","completedFee","toAdd","newCashBalanceOnComplete","ProfitService","withdrawCommission","fromWalletId","jsxs","jsx","Button","LogOut","Card","CardHeader","CardTitle","DollarSign","CardContent","Wallet","sum","balance","ArrowUpDown","Eye","MasterPinDialog","Select","value","SelectTrigger","SelectValue","SelectContent","SelectItem","Input","dest","amountEl","next","submitBtn","transaction","ArrowDownLeft","Clock","ProtectedDashboard","navigate","useNavigate","isAuthenticated","setIsAuthenticated","authStatus","userData","loginTime","LogoLoader"],"mappings":"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"}