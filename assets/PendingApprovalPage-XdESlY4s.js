import{u as L,a as J,r as c,J as K,K as Q,o as V,O as j,j as a,P as W,B as p,Q as q,m as G,T as x}from"./index-bCWIXU_s.js";import{FreeTrialService as y}from"./freeTrialService-CWJcN19o.js";function ae(){const{user:e,signOut:M,userSubscription:v,isSubscriptionActive:A,checkSubscriptionStatus:X}=L(),g=J(),[N,S]=c.useState(!1),[Y,Z]=c.useState(!1),[T,$]=c.useState(!1),[_,P]=c.useState(!1),[n,I]=c.useState(4),O=[{title:"Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",price:150,features:["Ø¯Ø¹Ù… Ù…Ø¬Ø§Ù†ÙŠ ÙƒØ§Ù…Ù„","ØªØ­Ø¯ÙŠØ«Ø§Øª Ù…Ø³ØªÙ…Ø±Ø©","Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚","20 Ù…Ø­ÙØ¸Ø©"],bg:"from-blue-50 to-indigo-50"},{title:"Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØ©",price:350,features:["Ø¯Ø¹Ù… Ù…Ù…ÙŠØ²","Ø­ØªÙ‰ 30 Ù…Ø­ÙØ¸Ø©","Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚","Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„ØªØ­ÙˆÙŠÙ„ Ø¹Ù„Ù‰ ØªÙ„Ø¬Ø±Ø§Ù…"],bg:"from-emerald-50 to-green-50"},{title:"Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ©",price:1e3,features:["Ø¯Ø¹Ù… Ù…Ù…ØªØ§Ø²","Ø¹Ø¯Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…ÙØªÙˆØ­","Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚","Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„ØªØ­ÙˆÙŠÙ„ Ø¹Ù„Ù‰ ØªÙ„Ø¬Ø±Ø§Ù…"],bg:"from-purple-50 to-pink-50"},{title:"Ø¨Ø§Ù‚Ø© Ù…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©",price:3e3,features:["Ø¯Ø¹Ù… Ù…Ù…ØªØ§Ø²","Ø¹Ø¯Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…ÙØªÙˆØ­","Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚","Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„ØªØ­ÙˆÙŠÙ„ Ø¹Ù„Ù‰ ØªÙ„Ø¬Ø±Ø§Ù…"],bg:"from-orange-50 to-amber-50"}];c.useEffect(()=>{if(!(e!=null&&e.uid))return;const t=K(Q(V,"users",e.uid),r=>{var l;if(r.exists()){const i=r.data(),m=i.isActive!==!1,d=i.subscription,u=(d==null?void 0:d.isActive)===!0&&j(d),b=((l=i.branchPackage)==null?void 0:l.status)==="active",f=i.isBranch===!0&&i.isActive===!0,h=i.isOnFreeTrial===!0;if(m&&(u||b||h||f)){console.log("âœ… PendingApprovalPage (Realtime): User activated, redirecting..."),sessionStorage.removeItem("dashboard_kick_signature");try{localStorage.removeItem(`sub_cache_${e==null?void 0:e.uid}`)}catch{}try{window.dispatchEvent(new Event("app:softRefresh"))}catch{}g("/user/dashboard",{replace:!0})}}});return()=>t()},[e==null?void 0:e.uid,g]),c.useEffect(()=>{var h;if(!(e!=null&&e.uid)||!v)return;console.log("ðŸ” PendingApprovalPage: Checking subscription via Context:",e.uid);const t=v;if(t.isActive===!1){console.log("â›” PendingApprovalPage: User account is deactivated (isActive=false), staying on page."),sessionStorage.removeItem("dashboard_kick_signature");return}const l=(o=>{var k,w;if(!o)return"null";const s=o.subscription,R=s!=null&&s.activatedAt?s.activatedAt.toDate?s.activatedAt.toDate().toISOString():new Date(s.activatedAt).toISOString():"null",U=(s==null?void 0:s.planType)||"null",C=o.isActive!==!1,B=(s==null?void 0:s.isActive)===!0,H=((k=o.branchPackage)==null?void 0:k.status)==="active",z=(w=o.branchPackage)!=null&&w.activatedAt?o.branchPackage.activatedAt.toDate?o.branchPackage.activatedAt.toDate().toISOString():new Date(o.branchPackage.activatedAt).toISOString():"null";return`${C}|${B}|${U}|${R}|${H}|${z}`})(t),i=sessionStorage.getItem("dashboard_kick_signature"),m=t.isActive!==!1,d=((h=t.branchPackage)==null?void 0:h.status)==="active",u=t.subscription,b=u&&u.isActive===!0&&j(u),f=t.isOnFreeTrial===!0;m&&(d||b||A||f)&&(i&&l===i||(sessionStorage.removeItem("dashboard_kick_signature"),g("/user/dashboard",{replace:!0})))},[e==null?void 0:e.uid,v,A,g]),c.useEffect(()=>{(async()=>{if(e!=null&&e.uid)try{const r=await y.getTrialData(e.uid);$(r.hasUsedFreeTrial),P(r.isOnFreeTrial)}catch(r){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©:",r)}})()},[e==null?void 0:e.uid]),c.useEffect(()=>{(async()=>{try{const t=await y.getTrialDurationHours();I(t)}catch(t){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø¯Ø© Ø§Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©:",t)}})()},[]);const D=async()=>{try{await q(G);try{localStorage.removeItem(`sub_cache_${e==null?void 0:e.uid}`),localStorage.removeItem(`profile_cache_v2_${e==null?void 0:e.uid}`)}catch{}window.location.href="/user/login"}catch(t){console.error("Logout error:",t),window.location.href="/user/login"}},E=async()=>{if(e!=null&&e.uid){S(!0);try{const t=await y.startFreeTrial(e.uid);if(t.success){x.success(t.message||`ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ù…Ø¯Ø© ${n} ${n>=3&&n<=10?"Ø³Ø§Ø¹Ø§Øª":n===2?"Ø³Ø§Ø¹ØªÙŠÙ†":"Ø³Ø§Ø¹Ø©"}! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡...`);try{localStorage.removeItem(`sub_cache_${e==null?void 0:e.uid}`)}catch{}try{window.dispatchEvent(new Event("app:softRefresh"))}catch{}g("/user/dashboard",{replace:!0})}else x.error(t.message)}catch(t){console.error("Error activating trial:",t),x.error("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©")}finally{S(!1)}}},F=(t,r,l)=>{try{const i=encodeURIComponent(`Ø£Ø±ØºØ¨ ÙÙŠ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ ${t} Ø¨Ø³Ø¹Ø± ${r} Ø¬
Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:
- ${l.join(`
- `)}`);window.open(`https://wa.me/201000392539?text=${i}`,"_blank")}catch{}};return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:a.jsxs("div",{className:"w-full max-w-5xl bg-white rounded-2xl shadow-lg border border-gray-200 dark:border-gray-800 p-4 sm:p-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-2",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:"linear-gradient(135deg, #f59e0b, #d97706)",filter:"blur(8px)",opacity:.3}}),a.jsx("div",{className:"relative bg-gradient-to-br from-orange-400 to-orange-600 p-2 rounded-full",children:a.jsx(W,{className:"h-10 w-10 text-white"})})]})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Ù…Ø·Ù„ÙˆØ¨ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨"}),a.jsx("p",{className:"text-gray-700 text-sm mt-1",children:"Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© ÙˆØ§Ø¶ØºØ· Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„ÙÙˆØ±ÙŠ."})]}),a.jsx("div",{className:"pt-4",children:a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-2 items-stretch",children:O.map(t=>a.jsxs("div",{className:`h-full rounded-lg p-2 border shadow-sm bg-gradient-to-br ${t.bg} dark:from-gray-800 dark:to-gray-700 dark:border-gray-700`,children:[a.jsx("div",{className:"font-bold text-sm text-gray-800 dark:text-gray-100 mb-1",children:t.title}),a.jsxs("div",{className:"text-lg font-extrabold text-gray-900 dark:text-gray-100 mb-2",children:[t.price," Ø¬"]}),a.jsx("ul",{className:"text-[11px] text-gray-700 dark:text-gray-200 text-right space-y-1 mb-2",children:t.features.map(r=>a.jsxs("li",{children:["â€¢ ",r]},r))}),a.jsx(p,{size:"sm",className:"w-full bg-green-600 hover:bg-green-700 text-xs py-1 h-8",onClick:()=>F(t.title,t.price,t.features),children:"ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨"})]},t.title))})}),a.jsxs("div",{className:"pt-3",children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-2",children:!T&&!_&&a.jsx(p,{size:"sm",className:"w-full bg-blue-600 hover:bg-blue-700",onClick:E,disabled:N,children:`Ø¬Ø±Ø¨ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ${n} ${n>=3&&n<=10?"Ø³Ø§Ø¹Ø§Øª":n===2?"Ø³Ø§Ø¹ØªÙŠÙ†":"Ø³Ø§Ø¹Ø©"}`})}),a.jsx(p,{variant:"outline",className:"border-2 border-gray-300 hover:border-gray-400 text-gray-700 hover:text-gray-800 px-5 py-2 rounded-lg font-semibold text-xs transition-all duration-300",onClick:D,children:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬"})]})]})})}export{ae as default};
//# sourceMappingURL=PendingApprovalPage-XdESlY4s.js.map
