{"version":3,"file":"contentService-CfBSjwCl.js","sources":["../../src/utils/contentService.ts"],"sourcesContent":["import { doc, setDoc, getDoc, updateDoc } from 'firebase/firestore';\r\nimport { db } from '../firebase';\r\n\r\n// واجهة بيانات الخطة\r\nexport interface PlanData {\r\n  name: string;\r\n  price: string;\r\n  period: string;\r\n  description: string;\r\n  features: string[];\r\n}\r\n\r\n// واجهة بيانات المحتوى\r\nexport interface ContentData {\r\n  monthly: PlanData;\r\n  yearly: PlanData;\r\n  lifetime: PlanData;\r\n}\r\n\r\n// البيانات الافتراضية للمحتوى\r\nexport const defaultContentData: ContentData = {\r\n  monthly: {\r\n    name: 'الباقة الشهرية',\r\n    price: '100 جنيه',\r\n    period: 'شهرياً',\r\n    description: 'مثالية للمبتدئين والتجار الصغار',\r\n    features: [\r\n      'إدارة محافظ متعددة',\r\n      'تتبع المعاملات اليومية',\r\n      'تقارير شهرية',\r\n      'دعم فني أساسي',\r\n      'واجهة سهلة الاستخدام'\r\n    ]\r\n  },\r\n  yearly: {\r\n    name: 'الباقة السنوية',\r\n    price: '700 جنيه',\r\n    period: 'سنوياً',\r\n    description: 'الأفضل للتجار المحترفين - وفر 42%',\r\n    features: [\r\n      'إدارة محافظ متعددة',\r\n      'تتبع المعاملات المتقدم',\r\n      'تقارير تفصيلية',\r\n      'دعم فني متقدم',\r\n      'تحليلات مالية',\r\n      'نسخ احتياطية تلقائية'\r\n    ]\r\n  },\r\n  lifetime: {\r\n    name: 'الباقة مدى الحياة',\r\n    price: '3500 جنيه',\r\n    period: 'دفعة واحدة',\r\n    description: 'استثمار واحد لحياة كاملة من الخدمات',\r\n    features: [\r\n      'جميع مميزات الباقة السنوية',\r\n      'محافظ غير محدودة',\r\n      'دعم فني مدى الحياة',\r\n      'تحديثات مجانية مدى الحياة',\r\n      'أولوية في الدعم الفني',\r\n      'مميزات حصرية جديدة'\r\n    ]\r\n  }\r\n};\r\n\r\n/**\r\n * حفظ محتوى الخطط في Firebase\r\n */\r\nexport const saveContentToFirebase = async (contentData: ContentData, adminId: string): Promise<void> => {\r\n  try {\r\n    const contentRef = doc(db, 'siteContent', 'plans');\r\n    await setDoc(contentRef, {\r\n      ...contentData,\r\n      lastUpdated: new Date(),\r\n      updatedBy: adminId\r\n    });\r\n    \r\n    console.log('✅ تم حفظ المحتوى في Firebase بنجاح');\r\n  } catch (error) {\r\n    console.error('❌ خطأ في حفظ المحتوى:', error);\r\n    throw new Error('فشل في حفظ المحتوى في قاعدة البيانات');\r\n  }\r\n};\r\n\r\n/**\r\n * تحميل محتوى الخطط من Firebase\r\n */\r\nexport const loadContentFromFirebase = async (): Promise<ContentData> => {\r\n  try {\r\n    const contentRef = doc(db, 'siteContent', 'plans');\r\n    const contentSnap = await getDoc(contentRef);\r\n    \r\n    if (contentSnap.exists()) {\r\n      const data = contentSnap.data();\r\n      // إزالة الحقول الإضافية والاحتفاظ بالمحتوى فقط\r\n      const { lastUpdated, updatedBy, ...contentData } = data;\r\n      return contentData as ContentData;\r\n    } else {\r\n      // إذا لم يوجد محتوى محفوظ، إرجاع البيانات الافتراضية\r\n      console.log('لا يوجد محتوى محفوظ، استخدام البيانات الافتراضية');\r\n      return defaultContentData;\r\n    }\r\n  } catch (error) {\r\n    console.error('❌ خطأ في تحميل المحتوى:', error);\r\n    // في حالة الخطأ، إرجاع البيانات الافتراضية\r\n    return defaultContentData;\r\n  }\r\n};\r\n\r\n/**\r\n * تحديث خطة واحدة فقط\r\n */\r\nexport const updateSinglePlan = async (\r\n  planType: keyof ContentData, \r\n  planData: PlanData, \r\n  adminId: string\r\n): Promise<void> => {\r\n  try {\r\n    const contentRef = doc(db, 'siteContent', 'plans');\r\n    await updateDoc(contentRef, {\r\n      [planType]: planData,\r\n      lastUpdated: new Date(),\r\n      updatedBy: adminId\r\n    });\r\n    \r\n    console.log(`✅ تم تحديث خطة ${planType} بنجاح`);\r\n  } catch (error) {\r\n    console.error(`❌ خطأ في تحديث خطة ${planType}:`, error);\r\n    throw new Error(`فشل في تحديث خطة ${planType}`);\r\n  }\r\n};\r\n\r\n/**\r\n * الحصول على معلومات آخر تحديث\r\n */\r\nexport const getLastUpdateInfo = async (): Promise<{lastUpdated: Date | null, updatedBy: string | null}> => {\r\n  try {\r\n    const contentRef = doc(db, 'siteContent', 'plans');\r\n    const contentSnap = await getDoc(contentRef);\r\n    \r\n    if (contentSnap.exists()) {\r\n      const data = contentSnap.data();\r\n      return {\r\n        lastUpdated: data.lastUpdated?.toDate() || null,\r\n        updatedBy: data.updatedBy || null\r\n      };\r\n    }\r\n    \r\n    return { lastUpdated: null, updatedBy: null };\r\n  } catch (error) {\r\n    console.error('❌ خطأ في الحصول على معلومات التحديث:', error);\r\n    return { lastUpdated: null, updatedBy: null };\r\n  }\r\n};\r\n"],"names":["defaultContentData","saveContentToFirebase","contentData","adminId","contentRef","doc","db","setDoc","error","loadContentFromFirebase","contentSnap","getDoc","data","lastUpdated","updatedBy","updateSinglePlan","planType","planData","updateDoc","getLastUpdateInfo","_a"],"mappings":"oEAoBO,MAAMA,EAAkC,CAC7C,QAAS,CACP,KAAM,iBACN,MAAO,WACP,OAAQ,SACR,YAAa,kCACb,SAAU,CACR,qBACA,yBACA,eACA,gBACA,sBAAA,CACF,EAEF,OAAQ,CACN,KAAM,iBACN,MAAO,WACP,OAAQ,SACR,YAAa,oCACb,SAAU,CACR,qBACA,yBACA,iBACA,gBACA,gBACA,sBAAA,CACF,EAEF,SAAU,CACR,KAAM,oBACN,MAAO,YACP,OAAQ,aACR,YAAa,sCACb,SAAU,CACR,6BACA,mBACA,qBACA,4BACA,wBACA,oBAAA,CACF,CAEJ,EAKaC,EAAwB,MAAOC,EAA0BC,IAAmC,CACvG,GAAI,CACF,MAAMC,EAAaC,EAAIC,EAAI,cAAe,OAAO,EACjD,MAAMC,EAAOH,EAAY,CACvB,GAAGF,EACH,gBAAiB,KACjB,UAAWC,CAAA,CACZ,EAED,QAAQ,IAAI,oCAAoC,CAClD,OAASK,EAAO,CACd,cAAQ,MAAM,wBAAyBA,CAAK,EACtC,IAAI,MAAM,sCAAsC,CACxD,CACF,EAKaC,EAA0B,SAAkC,CACvE,GAAI,CACF,MAAML,EAAaC,EAAIC,EAAI,cAAe,OAAO,EAC3CI,EAAc,MAAMC,EAAOP,CAAU,EAE3C,GAAIM,EAAY,SAAU,CACxB,MAAME,EAAOF,EAAY,KAAA,EAEnB,CAAE,YAAAG,EAAa,UAAAC,EAAW,GAAGZ,GAAgBU,EACnD,OAAOV,CACT,KAEE,gBAAQ,IAAI,kDAAkD,EACvDF,CAEX,OAASQ,EAAO,CACd,eAAQ,MAAM,0BAA2BA,CAAK,EAEvCR,CACT,CACF,EAKae,EAAmB,MAC9BC,EACAC,EACAd,IACkB,CAClB,GAAI,CACF,MAAMC,EAAaC,EAAIC,EAAI,cAAe,OAAO,EACjD,MAAMY,EAAUd,EAAY,CAC1B,CAACY,CAAQ,EAAGC,EACZ,gBAAiB,KACjB,UAAWd,CAAA,CACZ,EAED,QAAQ,IAAI,kBAAkBa,CAAQ,QAAQ,CAChD,OAASR,EAAO,CACd,cAAQ,MAAM,sBAAsBQ,CAAQ,IAAKR,CAAK,EAChD,IAAI,MAAM,oBAAoBQ,CAAQ,EAAE,CAChD,CACF,EAKaG,EAAoB,SAA2E,OAC1G,GAAI,CACF,MAAMf,EAAaC,EAAIC,EAAI,cAAe,OAAO,EAC3CI,EAAc,MAAMC,EAAOP,CAAU,EAE3C,GAAIM,EAAY,SAAU,CACxB,MAAME,EAAOF,EAAY,KAAA,EACzB,MAAO,CACL,cAAaU,EAAAR,EAAK,cAAL,YAAAQ,EAAkB,WAAY,KAC3C,UAAWR,EAAK,WAAa,IAAA,CAEjC,CAEA,MAAO,CAAE,YAAa,KAAM,UAAW,IAAA,CACzC,OAASJ,EAAO,CACd,eAAQ,MAAM,uCAAwCA,CAAK,EACpD,CAAE,YAAa,KAAM,UAAW,IAAA,CACzC,CACF"}