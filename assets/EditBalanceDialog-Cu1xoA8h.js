import{r,R as P,j as e,a5 as A,a6 as F,a7 as L,a8 as M,v as h,I as v,B as u,E as k,F as R,D as q}from"./index-bCWIXU_s.js";import{M as y}from"./MasterPinDialog-A5-_nbFS.js";import{D as I}from"./dollar-sign-Bao60D_X.js";import{C as V}from"./circle-alert-BxhCUO6U.js";function K({open:n,onOpenChange:g,onSuccess:w,title:b,description:S,currentBalance:t,balanceLabel:D,userId:p}){const[o,c]=r.useState(""),[m,i]=r.useState(t.toString()),[d,C]=r.useState(!1),[f,s]=r.useState(""),[j,x]=r.useState(!1),E=async a=>{a.preventDefault(),s(""),x(!0);try{const l=parseFloat(m);if(isNaN(l)||l<0){s("يرجى إدخال مبلغ صحيح"),x(!1);return}await y.hasMasterPin(p)?await y.verifyMasterPin(o,p)?(w(l),g(!1),c(""),i("")):s("الرقم السري غير صحيح"):s("لم يتم تعيين رقم سري رئيسي. يرجى تعيين رقم سري رئيسي أولاً من إعدادات التطبيق")}catch{s("حدث خطأ أثناء التحقق من الرقم السري")}finally{x(!1)}},N=()=>{c(""),i(t.toString()),s(""),g(!1)};return P.useEffect(()=>{n&&i(t.toString())},[t,n]),e.jsx(A,{open:n,onOpenChange:N,children:e.jsxs(F,{className:"sm:max-w-md",dir:"rtl",children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2 text-right",children:[e.jsx(I,{className:"h-5 w-5"}),b]})}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground text-right",children:S}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs(h,{className:"text-sm font-medium text-gray-700",children:[D," الحالي"]}),e.jsxs("div",{className:"text-lg font-bold text-gray-900 mt-1",children:[t.toLocaleString()," جنيه"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"newAmount",className:"text-right",children:"المبلغ الجديد"}),e.jsx(v,{id:"newAmount",type:"number",step:"0.01",min:"0",value:m,onChange:a=>i(a.target.value),placeholder:"أدخل المبلغ الجديد",className:"text-right",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"pin",className:"text-right",children:"الرقم السري"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{id:"pin",type:d?"text":"password",value:o,onChange:a=>c(a.target.value),placeholder:"أدخل الرقم السري",className:"text-right pr-10",required:!0}),e.jsx(u,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>C(!d),children:d?e.jsx(k,{className:"h-4 w-4"}):e.jsx(R,{className:"h-4 w-4"})})]})]}),f&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 bg-red-50 p-2 rounded",children:[e.jsx(V,{className:"h-4 w-4"}),f]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(u,{type:"button",variant:"outline",onClick:N,className:"flex-1",children:"إلغاء"}),e.jsx(u,{type:"submit",disabled:j||!o||!m,className:"flex-1",children:j?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"جاري التحديث..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"تحديث الرصيد"]})})]})]})]})})}export{K as EditBalanceDialog};
//# sourceMappingURL=EditBalanceDialog-Cu1xoA8h.js.map
