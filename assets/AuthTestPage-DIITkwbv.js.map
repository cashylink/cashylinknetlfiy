{"version":3,"file":"AuthTestPage-DIITkwbv.js","sources":["../../src/pages/AuthTestPage.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useFirebaseAuth } from '@/contexts/FirebaseAuthContext';\nimport { auth, db } from '@/firebase';\nimport { doc, getDoc, setDoc } from 'firebase/firestore';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\n\nexport default function AuthTestPage() {\n  const { user, profile, loading, signIn } = useFirebaseAuth();\n  const [authState, setAuthState] = useState<any>(null);\n  const [email, setEmail] = useState('alkaptin7878@mail.ru');\n  const [password, setPassword] = useState('01123456');\n\n  useEffect(() => {\n    const checkAuthState = () => {\n      setAuthState({\n        contextUser: user ? {\n          uid: user.uid,\n          email: user.email,\n          emailVerified: user.emailVerified\n        } : null,\n        contextProfile: profile,\n        contextLoading: loading,\n        firebaseCurrentUser: auth.currentUser ? {\n          uid: auth.currentUser.uid,\n          email: auth.currentUser.email,\n          emailVerified: auth.currentUser.emailVerified\n        } : null,\n        timestamp: new Date().toISOString()\n      });\n    };\n\n    checkAuthState();\n    const interval = setInterval(checkAuthState, 2000);\n    return () => clearInterval(interval);\n  }, [user, profile, loading]);\n\n  const handleTestLogin = async () => {\n    console.log('üß™ Testing login with:', { email, password: '***' });\n    try {\n      const result = await signIn(email, password);\n      console.log('üß™ Login result:', result);\n    } catch (error) {\n      console.error('üß™ Login error:', error);\n    }\n  };\n\n  const testFirestoreConnection = async () => {\n    console.log('üî• Testing Firestore connection...');\n    console.log('üîç Current auth state:', {\n      user: user ? { uid: user.uid, email: user.email } : null,\n      firebaseCurrentUser: auth.currentUser ? { uid: auth.currentUser.uid, email: auth.currentUser.email } : null\n    });\n    \n    try {\n      if (!user && !auth.currentUser) {\n        console.log('‚ùå No user logged in - please login first');\n        alert('Ÿäÿ±ÿ¨Ÿâ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ£ŸàŸÑÿßŸã ŸÑÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿßÿ™ÿµÿßŸÑ ŸÖÿπ Firestore');\n        return;\n      }\n\n      const currentUser = user || auth.currentUser;\n      console.log('‚úÖ Using user:', currentUser?.email);\n\n      // ÿßÿÆÿ™ÿ®ÿßÿ± ŸÇÿ±ÿßÿ°ÿ© ŸÖŸÑŸÅ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ\n      console.log('üìñ Testing user document read...');\n      const userDocRef = doc(db, 'users', currentUser!.uid);\n      const userDoc = await getDoc(userDocRef);\n      \n      if (userDoc.exists()) {\n        console.log('‚úÖ User document exists:', userDoc.data());\n      } else {\n        console.log('‚ö†Ô∏è User document does not exist, creating...');\n        await setDoc(userDocRef, {\n          email: currentUser!.email,\n          uid: currentUser!.uid,\n          createdAt: new Date(),\n          role: 'user',\n          isActive: true\n        });\n        console.log('‚úÖ User document created');\n      }\n\n      // ÿßÿÆÿ™ÿ®ÿßÿ± ŸÇÿ±ÿßÿ°ÿ© ŸÖÿ≠ÿßŸÅÿ∏ ÿßŸÑÿ™ÿßÿ¨ÿ±\n      console.log('üìñ Testing merchant wallet read...');\n      const walletDocRef = doc(db, 'merchantWallets', `test_${currentUser!.uid}`);\n      const walletDoc = await getDoc(walletDocRef);\n      \n      if (walletDoc.exists()) {\n        console.log('‚úÖ Wallet document exists:', walletDoc.data());\n      } else {\n        console.log('‚ö†Ô∏è Wallet document does not exist, creating test wallet...');\n        await setDoc(walletDocRef, {\n          merchantUserId: currentUser!.uid,\n          walletName: 'ŸÖÿ≠ŸÅÿ∏ÿ© ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©',\n          balance: 0,\n          createdAt: new Date()\n        });\n        console.log('‚úÖ Test wallet created');\n      }\n\n      console.log('üéâ Firestore connection test completed successfully!');\n      alert('ÿ™ŸÖ ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿßÿ™ÿµÿßŸÑ ŸÖÿπ Firestore ÿ®ŸÜÿ¨ÿßÿ≠! ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ Ÿàÿ≠ÿØÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ ŸÑŸÑÿ™ŸÅÿßÿµŸäŸÑ');\n\n    } catch (error) {\n      console.error('‚ùå Firestore connection error:', error);\n      alert(`ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ ŸÖÿπ Firestore: ${error.message}`);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background p-6\">\n      <div className=\"max-w-4xl mx-auto space-y-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle>üîê ÿßÿÆÿ™ÿ®ÿßÿ± ÿ≠ÿßŸÑÿ© ÿßŸÑŸÖÿµÿßÿØŸÇÿ©</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"email\">ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä</Label>\n              <Input\n                id=\"email\"\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                placeholder=\"ÿ£ÿØÿÆŸÑ ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä\"\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±</Label>\n              <Input\n                id=\"password\"\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder=\"ÿ£ÿØÿÆŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±\"\n              />\n            </div>\n            \n            <Button onClick={handleTestLogin} className=\"w-full\" disabled={loading}>\n              {loading ? 'ÿ¨ÿßÿ±Ÿä ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ...' : 'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä'}\n            </Button>\n            \n            {user && (\n              <Button onClick={testFirestoreConnection} className=\"w-full\" variant=\"outline\">\n                ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿßÿ™ÿµÿßŸÑ ŸÖÿπ Firestore\n              </Button>\n            )}\n\n            \n            \n            <div className=\"bg-gray-100 p-4 rounded-lg\">\n              <h3 className=\"font-bold mb-2\">ÿ≠ÿßŸÑÿ© ÿßŸÑŸÖÿµÿßÿØŸÇÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©:</h3>\n              <pre className=\"text-sm overflow-auto\">\n                {JSON.stringify(authState, null, 2)}\n              </pre>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n"],"names":["AuthTestPage","user","profile","loading","signIn","useFirebaseAuth","authState","setAuthState","useState","email","setEmail","password","setPassword","useEffect","checkAuthState","auth","interval","handleTestLogin","result","error","testFirestoreConnection","currentUser","userDocRef","doc","db","userDoc","getDoc","setDoc","walletDocRef","walletDoc","jsx","jsxs","Card","CardHeader","CardTitle","CardContent","Label","Input","Button"],"mappings":"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"}